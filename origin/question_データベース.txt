Left Joinで左側のテーブルをもとに右側のテーブルを連結したいのですが、右側のテーブルに重複データが存在します。そこで、重複してしいる右側のデータの任意の一つだけを結合したいのですが、どのようにしたらよいでしょうか？ 例えば以下の様な内容です。 テーブルA 商品　数量 ----------------------- 商品１　１０ 商品２　２０ 商品３　３０ テーブルB 商品　　単価　　日付 ----------------------- 商品１　１００　8/10 商品１　１１０　8/11 商品３　２００　8/12 これらのテーブルを結合して以下のようなデータを取得したいのですが、同のようなSQL文を作成したらよいのでしょうか？ 検索結果 商品　数量　単価　日付 ----------------------- 商品１　１０　１００　8/10 商品２　２０　NULL　NULL 商品３　３０　２００　8/12 商品１はテーブルBに重複したデータがありますが、いずれか一つを選択できればOKです。 商品２はテーブルBにデータがありませんので、単価と日付はNULLでOKです。
SQLの上達方法もしくはSQLドリル的なガリガリ書いて覚えらる本、サイトを教えていただけないでしょうか？ 私は最近中途入社したシステム開発の会社でプログラマとして働いています。 職場ではOracleのPL/SQLとSQLを書くこと多いですが、PL/SQLは大丈夫ですが、複雑なSQLをこれから先書けるようになるために勉強しています。 ミックさんのSQL入門は学習しましたが、SQLは覚えただけではなく実際に書いて書いて書きまくって覚えらるものと考えています。 おすすめの本、サイトをご存知でしたら是非教えていただけないでしょうか。 よろしくお願いします。
こんばんは。どうしてなのか、原因がみつけられません。 解決方法をご教示いただけないでしょうか？よろしくお願いいたします。 事象：メインフォームの伝票番号が11番以上は自動連番されない。 （伝票番号１０までは、新規追加すれば発番できていたのに、11以降、手入力で対応中。） 仕様： table:伝票テーブル（伝票番号フィールドはテキスト型） 明細テーブル（明細番号フィールドはオートナンバー型） ※明細テーブルに伝票番号フィールドがあって、伝票テーブルの伝票番号フィールドとリレーションシップがかかっています。 Query:伝票クエリ 明細クエリ Form:伝票フォーム （伝票番号のプロパティ\データ\規定値に、=Nz(DMax("[伝票番号]","伝票テーブル")+1,1)と設定） 　　　明細フォーム 伝票フォームに、明細フォームをサブフォームとして組み込んでいます。 新規追加をすれば、伝票番号が発番されて、サブフォームへ明細情報を入力する。 イメージ画像添付します。 どうすれば、１１以降も、自動連番されるのでしょうか？ 困っています。どうかよろしくお願いいたします。
3度目の質問となります。 生産台数により単価が変動（最大3種類）する商品が出てきて、商品マスターの単価を都度替えてしまうと、前月の売り上げ金額等が合わなくなってしまう現象が出てしまいました。 今現在、単価変動の際は商品コードを別途与えて新規商品という形で運用していますが、収拾がつかなくなってきています。 商品マスターの単価は1つですが、3つ（単価1、単価2、単価3）に増やし、予定表に代入する際（今は商品コードを参照して自動的にできている）に[単価1]が自動的に代入されるが、違う単価の場合他の2種類から選ぶようなことはできますでしょうか？
テーブルに保持している条件を満たすデータ抽出についてご教示ください。 フラグ① a フラグ② a フラグ③ b 金額① 100 金額② 100 金額③ 100 上記レコードのフラグと金額は紐付いており、フラグがaの場合、金額①と金額②を加算、フラグがbの金額③は加算しない。 仮にフラグ①〜③が全てaの場合は、金額①、金額②、金額③全てを加算するとしたいです。 case式等で対応できないかと考えましたが抽出方法がわからず。 わかりにくい説明かと思いますが、お知恵を拝借できればと思います。
varchar(1)で定義したフィールドにデフォルトで空文字列をセットしようと、''をデフォルトにしようとした。すると、エラーになった。一旦、デフォルトをNULLにし、updateで''を設定しようとした。すると、truncateされ、'が入った。ということは、''は’が２つと解釈されている。 どういうことか？　''が空文字列と思ってきたが.... なお、""でもやってみたが、"がひとつ登録された。
マインクラフトの　Ver 1.8.9です。 ワードル生成の時にデフォルトの、「カスタマイズ」とありますが、この設定で、海と草原バイオームだけを生成する方法は何かないのでしょうか。あったら教えてください。なかったら一応そのための配慮をしておきます。どなたでもいいので、よろしくお願いします！。
フォルダからのデータ集計するEXCEL VBAを教えて下さい。 1. 集計元に「アイスデータ」「ケーキデータ」「ラーメンデータ」「果物データ」「魚データ」の5つのフォルダがあります。 2. 「アイスデータ」フォルダには「アイス.xlsx」、「ケーキデータ」フォルダには「ケーキ.xlsx」、「ラーメンデータ」には「ラーメン.xlsx」、「果物データ」には「果物.xlsx」、「魚データ」には「魚.xlsx」のエクセルファイルがある。 3. 「集計プログラム」を立上げ、任意の「集計元データ」にチェックを入れ「データ抽出」ボタンを押すことで、「集計表」の指定のテキストボックスにエクセルから抽出したデータを書込んで保存する。 例えば） 　「集計プログラム」の「ケーキデータ」と「果物データ」にチェックを入れ「データ抽出」ボタンを押すと「集計表」の「ケーキ集計テキスト.txt」に「ケーキ.xlsx」データが書込まれる。「果物集計テキスト.txt」に「果物.xlsx」のデータが書込まれる。 というように抽出データを選んで書込むEXCEL VBAを教えて下さい。 ご教授宜しくお願い致します。
論理削除とは、boolean型のdeleted_atみたいなものをつけて、trueなら、存在する。falseなら、存在しない(物理的には、存在し、中身はNULL)みたいな事。と認識しているのですが、合っているでしょうか？ deleteではなく、trueの場合のデータを0か、NULLで上書き→falseにする。 という感じで良いでしょうか？また、not nullのフィールドが存在した場合、0を、それ以外はnullを突っ込むという感じですか？ そして、insertの場合、idが自動付番の場合で、10番まで存在し、5番までは、true。6以降はfalseの場合、新しい行を追加するとき、6番目に追加、(update)するのですか？それとも、11番目にcreateするのでしょうか？
ど素人の質問ですみません。 会社で添付資料を作成しています。各担当者の作業が完了次第、チェックボックスにチェックを入れてもらい、チェックが入ると、関数で作業完了日を表示する設定をしました。（各担当者の作業を本資料において管理し遅滞ないよう後続作業へ繋げたいのです。） ただ、ファイルを一旦閉じ、再度開くと日付が更新されてしまいます。レ点チェック＝作業日にする方法を教えてください。 また、Ｆ列の範囲（Ｆ５：１２）において、直近の日付（最終作業日）が入ると、同行Ｊ列に"最終作業者です"などと表示させたいのですが、どのような設定をすればよろしいでしょうか。 8項目中、8番手の作業＝最終作業日という考えです。 説明が下手で申し訳ありませんが、ご回答をよろしくお願いします。
アクセスのテーブルデータについて教えてください。 ・テーブル「会員住所氏名」のフィールドに[住所][氏名1][続柄1][氏名2][続柄2][氏名3][続柄3]とあったとします。データの内容はある会員名簿でその世帯の住所と世帯員（氏名1.2.3）で一人世帯から三人世帯がありえます。 ・このテーブルから最終的にレポート「会員名簿」としてテーブルに登録されている全員(氏名1、氏名2、氏名3)の「住所」、「氏名」が並ぶ表を作りたいのです。 ・SQLはわかりませんので、デザイングリット(?)でする作業で対応したいと思っています。クエリ(テーブル作成クエリや選択クエリなどを使うのかなと思いますが…）のことは多少分かります。アクセスの知識は中級の初級程度(?)のレベルです。 　よろしくお願いします。
質問の内容はタイトルの件なのですが、詳細に説明させて頂きます。 テーブル名：sample ---------- id,type ---------- 1,A 1,A 1,B 1,C ---------- 上記のような4件のレコードが入ったテーブルがあったとします。 このテーブルのidでグループ化し、 -------------------------- SELECT id FROM sample GROUP BY id HAVING count(type) = 3 -------------------------- のようにして、typeが3種類だけのレコード(A,B,Cのような)を取得したいのですが、 この方法だと、単純にレコード件数の4件が取れてしまいます。 どうにかAの重複を1つとして、うまく取得する方法は無いでしょうか。 よろしくお願い致します。 また、質問内容におかしな点などあればご指摘下さい。
サーバにOracle Cliannt12cをインストールし、PDBとユーザを作成しました。 クライアントに12cのクライアントをインストールしました。 tnsnames.otaを下記のように記述し、sqlplusで接続しようとしましたが、 「ora-12560」のエラーになり、接続できません。 ちなみにtnspingは通ります。 原因と対策をお教えください。 Oracle12cは初めてで、インストールから苦しんでいます。 よろしくお願いいたします。
お世話になります。 Accessでシステムを開発中でテーブルをSQLServer内に移行しました。 以前までDELETE文で同一条件のレコードを一括で削除できていたのですが、SQLServerにテーブルを移行して以来「1行の更新/削除により、1行以上のリンクテーブルに影響がありました。固有インデックスに重複する値が含まれます。」というエラーが出てしまいます。 こちらの解決法をご教示願います。 どなたか詳しい方、お力添えよろしくお願い致します。
ACCESS初心者です。 以下のような各商品を販売している商店名と販売されている商品の価格が反映されたテーブル「T_価格表」があります。 テーブル「T_価格表」 商品名｜A商店｜ B商店｜C商店 バナナ｜150円｜ 180円｜200円 みかん｜120円｜ 130円｜110円 イチゴ｜250円｜ 280円｜240円 メロン｜540円｜ 530円｜600円 現在、このテーブルから各商品の最安値を反映するクエリ「Q_最小値」があります。 クエリ「Q_最小値」 商品名｜最小値 バナナ｜150円 みかん｜110円 イチゴ｜240円 メロン｜530円 このクエリに最小値で販売している店舗名を反映するフィールドを追加し、以下のように表示させたいと考えております。 クエリ「Q_最小値」 商品名｜最小値｜最小値の商店名 バナナ｜150円｜A商店 みかん｜110円｜C商店 イチゴ｜240円｜C商店 メロン｜530円｜B商店 当方、デザインビューにてクエリ作成をしているのですが、このとき「最小値の商品名」フィールドにどのような数式を反映させればよろしいでしょうか？ ご助言いただければ幸いです。 何卒よろしくお願いいたします。
お世話になります。 Accessで売上管理システムを作成しテーブルをSQLServerに移行しました。 SQLServerからODBC接続でデータの取り込みを行いリンクテーブルを作成したのですが、 今まで正常に動作していたクエリが開かなくなってしまいました。 原因であるSQLServer内のデータ型は確認しましたが特に一致していないものはないかと思います、、 外部テーブルだとクエリは上手く動作しないなどあるのでしょうか？ 詳しい方お力添えよろしくお願い致します。
教えて下さい。 テーブル名(明細) 書籍コード　　明細金額 1001 　　　　23000 1102 　　　　 9500 1234 　 　　 25000 1115 　 　　　8000 1001 　 　　31000 とあります。 問題として [テーブルにある書籍で20000円を超えた書籍のコードを抜き出し、抜き出した合計を列名totalとともに表示しなさい。] SQLがわかりません。よろしくお願いします。
お世話になります。 最近AccessとVBAの学習を始めた者です。 Accessを用いて簡単な売上管理システムを作成しました。 システムを共有できるようにするためにSQLServerへの接続を試みています。 SQLServer内にAccessと同じデータ型のテーブルは作成済みです。 これにどのような方法でデータの追加などをするか調べても良く分かりません。 VBAでODBC接続を行うためのコードを記述するというところまで分かりました。 コードの例などあればすごく助かります。 私自身理解が不足しているため稚拙な文章ですがご了承ください。 よろしくお願い致します。
質問させて頂きます。 ▼テーブル名[sample] -------------- ID,type -------------- 1,A -------------- 1,B -------------- 2,A -------------- 3,C -------------- 上記のようなデータの入ったテーブルがあるとします。 この中から、下記のような条件のデータを取得する場合、どのようなクエリを作成すればよろしいでしょうか。 ①typeがAとBも持っているIDを取得 ※この場合だと、ID「1」が結果になります。 ※ID「1」は2行あるため、取得結果は1行でも2行でも構いません。 ②typeがAのみのIDを取得 ※この場合だと、ID「2」が結果となります。 グループ化を使用して？など考えてはいるのですが、そこから先の条件指定をどのようにすれば分からず悩んでいます。 何か良い方法をご存知の方は教えて頂けると幸いです。 また質問内容に不備な点などあれば、すぐに修正するのでご指摘下さい。 よろしくお願い致します。
MS-Accessにて作成したデータに複数のPCより入力・変更等をするようにしたいのですが、 以前作成したAccessVer2002の場合はできたのですが、２０１３では１台でのみの使用 しかできなくなってしまいました。なにかセキュリティ設定が必要なのでしょうか。 あまりにも変わり過ぎて・・・ すいませんどなたか教えていただけませんでしょうか。
Access2013で勉強中の超ビギナーです。 T_会社 key_会社ID、会社名 T_会社概要 key_会社ID、業種 T_支店名 key_支店ID、会社ID、支店名 上記３つのテーブルを利用し、会社ID、会社名、業種、支店ID、支店名を 一度に入力できるクエリを下記のように作成しましたが 「T_支店名の結合キーがレコードセットにありません」 というメッセージが出て入力できませんでした。 会社ID（T_会社） 会社名（T_会社） 業種（T_会社概要） 支店ID（T_支店名） 支店名（T_支店名） このような場合、どういったクエリを組めば良いでしょうか？
こんにちは。 現在アクセスにて、複数あるレポートを一つにまとめれないか挑戦中です。 現在の作業手順は以下になります。 1.見積書を選択する→見積書のフォームが表示される 2.見積書のフォームにある印刷ボタンをクリック→見積書の表紙がプレビューされる→表紙を印刷 3.見積書のフォームになり、各項目の「開」ボタンをクリック→各項目の明細のフォームに移行 4.明細のフォームにある印刷ボタンをクリック→該当項目の明細がプレビューされる→印刷 5.見積書に記載されている項目の数だけ3.～4.を繰り返す この作業を表紙のフォームのボタン一つで出来ないでしょうか？もちろんボタンは新規で作ります。 項目が少なければなんてことないのですが、項目が多くなると今どこまで印刷が終わったのかわからなくなって、同じ明細を2回印刷してしまったり、最悪なのは項目を一つ飛ばして印刷してしまったりと、効率悪い上に重大なミスに繋がります。 色々調べながら試してみましたが、また挫折しそうで、質問しました。 現在あるのは見積書の表紙のレポートと明細のレポートです。 新規に一括印刷用のレポートを作成し、その詳細部分に既存の表紙レポートと明細レポートをサブレポートとして組み込むということをやってみました。 かなり惜しかったのですが、以下の問題が発生しました。 ①表紙は問題なく反映されるのですが、明細が全然関係のない明細になってしまう。というより、明細として記録されているデータを全て反映してしまう。 ②明細レポート側のレポートヘッダーが明細の2ページ目以降消えてしまう。 現在の仕組みとしては、表紙は見積書のフォ－ムからIDを引っ張ってきており、明細は見積書のサブフォームからID(表紙とは別のID)を引っ張っています。なので、既存のクエリをコピペしていじれば行けそうな気がするのですが、②の問題に関してはどうしようもなさそうな気がしています。 だとすると、全く別の一括印刷用のレポートを作るしかありませんか？ そうであれば、表紙と明細という、デザインの異なる、しかも共にヘッダー･詳細･フッターを必要とする場合どのように作成したら良いのでしょうか？ どなたかご教授いただければ助かります。
お世話になります。 Oracle SQRの正式名称は何ですか？ Oracle SQRを使用するため調べているのですが、GOOGLEで「Oracle SQRインストール」で 検索すると、SQLの検索結果ばかり出てくるのですが。 まずは、Windows Server 2012とOracle12cの環境にインストールしたいので、 インストールの手順を調べたいのです。 どなたか、Oracle SQRの正式名称をお教えください。
多数の似て非なるテーブルが沢山あります。これを一つ一つ専用のデー タベースを作ると言うのも、管理の面で大変だと思うので。 ひとつの基本となるクラスを作ってから、その基本クラスを継承して専 用のデータベースを作らなくても対処が出来る様なデータベースを考え ているのですが。 それと言うのは、mysqlで対処出来るのでしょうか。
SQL初心者です。 ACCESSでSQL文を記述していますが、どうもうまくいきません。 まず、「顧客マスタ」と「問合せ履歴」というテーブルがあります。 「顧客マスタ」は１顧客１レコードの状態、「問合せ履歴」は１顧客に対してN個のレコードがあります。 「顧客マスタ」 顧客ID｜顧客名｜顧客住所｜・・・・ １　　｜田中　｜東京　　｜ ２　　｜石井　｜神奈川　｜ ３　　｜斉藤　｜千葉　　｜ ４　　｜藤井　｜東京　　｜ 「問合せ履歴」 顧客ID｜　　登録日　｜問い合わせ内容｜・・・・ １　　｜2000/11/04 ｜新規注文　　　｜ １　　｜2001/05/04 ｜追加注文　　　｜ ２　　｜2005/07/19 ｜事前打合せ　　｜ ２　　｜2005/07/30 ｜見積依頼　　　｜ ４　　｜2014/01/11 ｜現地調査依頼　｜ ４　　｜2014/06/04 ｜新規注文　　　｜ 両方のテーブルに「顧客ID」が存在するので、これをキーにLEFTJOINして、顧客マスタの全件と、問合せ履歴のある顧客については問い合わせ内容を結合したいと考えています。 出力結果を1顧客1レコードのユニークな状態にしたい、且つ問合せ履歴のある顧客は最も古い問合せのレコードを結合したいと考え、以下のSQL文を記述したのですがうまくいきません。 ＝＝＝＝＝ SELECT 顧客マスタ.*, 問合せ履歴.* FROM 顧客マスタ LEFT JOIN 問合せ履歴 ON 顧客マスタ.顧客ID = 問合せ履歴.顧客ID LEFT JOIN (SELECT MIN(問合せ履歴.登録日),問合せ履歴.顧客ID FROM 問合せ履歴 GROUP BY 問合せ履歴.顧客ID) AS T1 ON 顧客マスタ.顧客ID = T1.顧客ID; ＝＝＝＝＝ どうすればうまくいくでしょうか。分かりにくいかもしれませんが、よろしくお願いします。
Accessで作られた業務プログラムが稼働している現地の環境は、 クライアントでAccessの業務プログラムが動作しており、サーバにテーブルを持ったAccessデータベースが存在している状態です。 そのプログラムをメンテナンスする為に、サーバが存在しないクライアントだけのPCで動作させる ようにしました。 それは、サーバのAccessデータベースが存在しないので、そのサーバのデータベースをリンクする ようにAccessから指示され、リンクさせて動作させています。 そこで、メンテナンスも終了して、現地のサーバがある環境に戻したいのですが、 このファイルをリンクしたままで、戻すと何か不都合が発生しないでしょうか？ 発生するようであれば、このファイルのリンクを削除したいのですが、 それには、どのようにすればいいのでしょうか？
はじめまして。 問い合わせのインシデント管理をAccess 2010で行うこととなり、VBAが必要となりました。 下記のようなことができるのか教えていただけたら幸いです。 メインのテーブル 　┗受付ID（オートナンバー）、受付日時（日付/時刻型）、カテゴリ名（ルックアップ）、ほか カテゴリのテーブル 　┗カテゴリID（オートナンバー）、カテゴリ名、カテゴリ_略 　　サンプル 　　1　Excel　EX 　　2　Word　WD 　　3　PowerPoint　PP メインのテーブルを元に入力フォームを作成しました。 そこに配置している【受付日時】とフォームで選択した【カテゴリ名】を元に 日付ごとカテゴリごとの受付番号を取得し、フォームに表示すると共に メインのテーブルに蓄積したいのですが、可能でしょうか？ テーブルの主キーは受付ID／オートナンバーにしていますが、 それとは別に上記のような受付番号を取得したいのです。 その際に YYYYMMDD_0001_xxx という書式で取得できたらと思っています。 　YYYYMMDD：受付日時の年月日 　４桁の番号は日付が変わるとまた1からカウント 　xxx：カテゴリ_略（カテゴリのテーブルの3列目） 　サンプル：20160725_0001_EX どうぞよろしくお願いいたします。
2度目の質問となります。 フォーム内で作業シートを作成中ですが、デザイン内の四角形を使用しチェックBOXがオンの時 黒く塗りつぶして、OFFの時透明になってその四角枠がかぶっている部分を表示させることは 可能でしょうか？ 内容的には、生産工法（チェックbox）が2通りあり一方は作業項目（枠で囲んでいる部分）を使用し一方は作業なしで塗りつぶしておく必要があります。
データグリッドビューで条件を満たした内容のみを別のデータベースに書き込みたいです。 以前にも同じような書き込みを見つけたのですが、上手く出来ませんでした。 どなたか詳しく説明していただけないでしょうか？ Visual Basic 2008 データベースはaccessを使用してます。 やりたいことは、データグリッドビューで検索をかける、出て来た物のみを別のデータベースに書き込むというものです。 なぜ、やりたいのかと言うと、レポート出力を使いたいからです、初心者なもので レポート出力で条件のみが印刷出来れば言うこと無いのですが それが出来そうも無いので、読み込むデータをはじめから、それだけに出来ればいいのでは無いかと 、あさはかな考えからこの様な質問に至りました。 親切な方、どうか助けて下さい。お願いします。
ツール構築に手詰まりして、抱えている問題の２つ目です。 お手数をおかけしますが、何卒、ご指導ください。 結果として、次の内容を一枚のレポートに表示したいのですが、問題が解決できません。 ご指摘とアドバイス頂きたくよろしくお願いします。 ＜やりたいこと＞ レポート印刷ボタンを押下したら、パラメータが表示され、 「いつから？」「いつまで」と聞かれ、「2016/7/4」「2016/7/5」と入力したら、 「神奈川県、りんご　１個　みかん　２個」 「千葉県、　りんご　１個　みかん　１個」 というレポートが県名ごとにできあがる。 ＜詳細（サンプル）＞ 次のテーブルがあります。 【Ｔ０１売上データ】 フィールド①売上日 フィールド②商品ＣＤ フィールド③商品名 フィールド④県名 【Ｔ０２商品マスター】 フィールド①商品ＣＤ フィールド②商品名 サンプルデータ 【Ｔ０１売上データ】 ①　　　　　②　　　③　　　　④ 2016/7/4　 100 　　りんご　 神奈川県 2016/7/4　 100 　　りんご　 千葉県 2016/7/4　 200 　　みかん　 神奈川県 2016/7/5 200 　　みかん　 神奈川県 2016/7/5 　200 　　みかん　 千葉県 【T02商品マスター】 ① 100　りんご 200　みかん ＜経過＞ 私がしてみたのは、【Ｔ０１売上データ】からクエリを作成して、 売上日をBetweenで期間指定をし、県名、商品名と商品名のカウントを選択して表示させました。 すると、下記の結果が表示されます。 2016/7/4　神奈川県　りんご　１個 2016/7/4　神奈川県　みかん　１個 2016/7/4　千葉県　　りんご　１個 2016/7/５ 神奈川県　みかん　１個 2016/7/５ 千葉県　　みかん　１個 これを県名ごとに、下記の通り、レポート化するもくろみでした。 「神奈川県　りんご　１個　みかん２個」 「千葉県　　りんご　１個　みかん１個」 ところが、クエリでレポートの作成をした結果、 県名ごとには出力できるけれども、詳細フィールドに定型文を挿入すると、 ２つ目の商品が次のページに表示されてしまいます。 これは、やはり、私のクエリ作成ミスなのかなぁ、と思っているのですが、 問題点も、解決策も浮かびません。 経験不足丸出しで恐縮ですが、何卒、アドバイス、ご指導のほどよろしくお願いいたします。
ツール構築に手詰まりしています。教えてください。よろしくお願いします。 結果として、次の内容を一枚のレポートに表示したいのですが、問題が解決できません。 ご指摘とアドバイス頂きたくよろしくお願いします。 ＜やりたいこと＞ レポート印刷ボタンを押下したら、パラメータが表示され、 「いつの？」と聞かれ、「2016/7/4」と入力したら、 「2016/7/4、りんご　２個　みかん　１個」 というレポートができあがる。 ＜詳細（サンプル）＞ 次のテーブルがあります。 【Ｔ０１売上データ】 フィールド①売上日 フィールド②商品ＣＤ フィールド③商品名 【Ｔ０２商品マスター】 フィールド①商品ＣＤ フィールド②商品名 サンプルデータ 【Ｔ０１売上データ】 ①　　　　　②　　　③ 2016/7/4　 100 　　りんご 2016/7/4　 100 　　りんご 2016/7/4　 200 　　みかん 2016/7/5 200 　　みかん 2016/7/5 　200 　　みかん 【T02商品マスター】 ① 100　りんご 200　みかん ＜経過＞ 私は、りんごとみかん用の各テーブルを作成するアクションクエリを作成しました。 【Ｑ０１売上件数りんご】 フィールド 売上日 商品ＣＤ：抽出条件　"100" 商品名 商品名のカウント 【Ｑ０２売上件数みかん】 フィールド 売上日 商品ＣＤ：抽出条件　"200" 商品名 商品名のカウント そして、作成された各テーブルを合体させたクエリを作成してみました。 【Ｑ０３売上件数（りんご・みかん、売上日指定】 売上日 　パラメータ[いつの？]　　　　　 from 【Ｑ０１売上件数りんご】 商品名 　　　　　　　　　　　　　　　　from 【Ｑ０１売上件数りんご】 商品名のカウント 　　　　　　　　　　　 from 【Ｑ０１売上件数りんご】 商品名 　　　　　　　　　　　　　　　　 from 【Ｑ０２売上件数みかん】 商品名のカウント 　　　　　　　　　　　 from 【Ｑ０２売上件数みかん】 すると、7/5には、りんごの売上はないはずなのに、表示されているではないですか！？ どうやら前のデータが更新されないまま、残っているようです。 売上日をりんごテーブルからしか使っていないからなのはわかったのですが、 この先が、闇になりました・・。 もっと効率的な方法や、この私の間違いについて、どうかご指導頂ければと思います。
お世話になっております。 掲題のとおり mysqlで1レコード内にある1つのフィールド内で重複した値があった場合対象レコードを出力したいのですが良い方法はないでしょうか。 例えば nameというフィールドに 青木　青木　隆 とあった場合、青木が重複しているので対象のレコードを出力する といった感じです その他 nameの中身が全く同じ値で重複しているレコードを出力するsql文をお教え頂いてもよろしいでしょうか。 例えばnameの中身で ーーーー 青木　隆 ーーーー 青木　隆 ーーーー といった列が２つ存在した場合、２つのレコードを出力する といった感じです。 後者は調べれば分かりそうですが前者は調べるのに時間がかかりそうで お教え頂けると助かります。 どうぞよろしくお願いいたします。
教えてください。Access初心者です。 以下の内容をできるのであればやり方を教えて頂けますでしょうか。 ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー 《元テーブル》 主キー　　登録日　　　退会日　利用日 １２１２　　　　　　　　　　　2016/２/5　 １２１２　　　　　　　　　　　2016/7/10 ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー 《参照テーブル》 主キー　　登録日　　　退会日　 １２１２　2015/5/20　2016/3/2　　　　　　　 １２１２　2016/7/1　　　　　　 ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー ●参照後の元テーブル結果● 主キー　　登録日　　　 退会日　　　利用日 １２１２　2015/5/20　2016/3/2　 2016/２/5　 １２１２　2016/7/1　　　　　　　 2016/7/10 上記テーブルがある場合、参照テーブルの登録日・退会日を元テーブルに追記したいです。 しかし、同じ主キーで２つ以上の情報がある場合、元テーブルの「利用日」を参照して、 範囲内の期間を入れることは可能でしょうか？ ●参照後の元テーブル結果●の様に抽出がしたいです。 分かりづらい説明で申し訳ございません。 何卒、宜しくお願いいたします。
現在、以下のようなシステム構成をとった運用をしています。 (1) クライアントPCでAccessを使用した業務プログラムがあります。 (2) そのクライアントPCで構築データベースを公開する為に、レンタルサーバにmysqlのデータベース 　　を構築し、クライアントで作成したデータをレンタルサーバのmysqlにインポートしてます。 (3) サーバ側で、PHPのプログラムでmysqlのデータベースをアクセスして、データを公開しています。 このシステムを、クライアントで直接、レンタルサーバのmysqlのデータベースを更新するように 変更する事を計画しています。 Webで検索すると、SSH接続、ODBC接続で、Accessのプログラムのまま、レンタルサーバのmysqlへ アクセスできるような記述を見つけましたが、 パフォーマンス等の観点で、業務システムに使用するには、不適切との記述もあります。 やはり、本当にそうなのでしょうか？ 特に、Accessに拘る必要はないのですが、帳票等も出力したいので、Accessが楽かなとも 思っています。 そのようなプログラム構成が妥当なのか、ご教授頂けないでしょうか？
例えば以下のように、0.8秒で抽出できたと書いてあるのに、 Showing rows 50 - 74 (5568 total, Query took 0.8403 seconds.) 実際にphpmyadminで表示されるまでに、１分くらいかかりました。 同様にサーバー上においたphpプログラムから実行した時の時間と、ターミナルなどで実行した時にかかる時間が大きく違うときがあります。 上記の原因、改善策はあるのでしょうか？よろしくお願いします。
次のようなテーブルから期間を指定して下のような曜日ごとのカウント（count）とその平均（ave）と その期間内にその曜日が何回出現したか（week_count）を求めたいのですが DROP TABLE IF EXISTS t1; CREATE TABLE IF NOT EXISTS t1 ( id int(11) NOT NULL, created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO t1 (id, created) VALUES (1, '2016-07-10 00:00:00'); INSERT INTO t1 (id, created) VALUES (2, '2016-07-17 00:00:00'); INSERT INTO t1 (id, created) VALUES (3, '2016-07-17 00:01:00'); INSERT INTO t1 (id, created) VALUES (4, '2016-07-18 00:00:00'); week　count　　ave　week_count 0　　　　　3　　　1.5　　　　2 1　　　　　1　　　0.5　　　　2 2　　　　　0　　　0　　　　　1 3　　　　　0　　　0　　　　　1 4　　　　　0　　　0　　　　　1 5　　　　　0　　　0　　　　　1 6　　　　　0　　　0　　　　　1 どのようなSQL文にすれば良いのでしょうか？ 曜日ごとのカウントだけなら次のSQL文 select count(*) as count, DATE_FORMAT(created, '%w') as week, created from t1 where created between '2016-07-10 00:00:00' and '2016-07-18 23:59:59' group by DATE_FORMAT(created, '%w'); で取得できるのですが・・・
オブジェクト指向データベースを始めたいが、どう言うのが有るのでしょうか。
初心者です。よろしくお願いします。 そもそも、できるのかどうか、できたとして、どうするのかがわからないです。 次の２つのテーブルがあります。 テーブルマスタA　には、①市町村CD　②市町村名　③住所（番地なし） テーブル受付データB　には、①NO　②住所（番地まであり）③受付日　④⑤・・・ 具体的には、以下のとおり。（サンプル） テーブルマスタA ①　　　　②　　　　　　③ 10000　　松戸市　　　　千葉県松戸市 20000　　鎌ケ谷市本町　千葉県鎌ケ谷市本町 30000　　横須賀市　　　神奈川県横須賀市 テーブル受付データB ①　　　　② 1　　　　千葉県松戸市五香5-5-5　　　　 2　　　　千葉県鎌ケ谷市本町さくらがおか8-88-8　ひまわりアパート302 3　　　　神奈川県横須賀市横須賀8-7-8　　　 テーブル受付データBにおいて、②の部分（市町名まで）と、 テーブルマスタAの③をなんとか紐づけて、 クエリで合体させたい。 ＝テーブル受付データBに、テーブルマスタAの市町村CDを充てたい。 A①市町村CD　　A②市町村名　B②　B③　B④　B⑤ とすることを切望しています。 *********** たとえば、２つのテーブルに同じフィールドがあって、 それをリレーションシップで紐づけるのは容易ですが、 今回のようなパターンは、 もしかして、私は、ナンセンスなことをしようと苦闘している？と思ってきました。 フィールド名が同じじゃないのに、それを紐づけることができるのでしょうか？ できるとして、どのようにすればよいのでしょうか？ どうぞ、教えていただきたく、お願いいたします！！！
よろしくお願いします。 「印刷時に、印刷レコードに印刷年月日を自動入力したい。」 と考えて、今日も、一日中、アクセスと格闘してきましたが、もう知恵がでません。 クエリ作ってみたり、検索したコードを利用してみたり、いろいろしましたが、 どうすれば、よいのか、わからなくなってしまいました。 お知恵をおわけください。よろしくお願いします。 ************************************** (1)テーブルには、①受付日　②商品名　③件数　④印刷年月日　の４つのフィールドがあります。 (2)クエリで、①にパラメータを使い、日付指定して、テーブルデータを抽出できるようにしました。 (3)クエリからレポートを作成しました。 (4)フォームの印刷ボタンで、レポート印刷するマクロを設定しました。 結果、印刷ボタンを押すと、指定受付日のレコードをレポートとして印刷できます。 今回は、 印刷ボタンを押して、指定受付日レコードをレポート印刷すると同時に、 当該印刷レコードについて、テーブルの④に印刷日を自動記録するようにしたいのです。 ************************************** なにとぞ、ご指導、よろしくお願いいたします。
ＡＣＣＥＳＳ２０１０ 教えてgooでダイアログからテキストファイルを取り込む方法を教えて頂きました。 ダイアログが表示された後、「キャンセル」ボタンを押下すると「パス名が無効です」のメッセージが表示されてしまいます。 「キャンセル」ボタンを押下したら、元のフォーム画面（名前：F_main）に戻るようにしたいのですが、strPath = ""　にどのような追加をすればよろしいでしょうか。 Private Sub コマンド0_Click() Dim i As Integer Dim strSQL As String Dim dbs As DAO.Database Dim rst As DAO.Recordset Dim OutData As String Dim kind As String Dim strPath As String strSQL = "SELECT * from M159 ORDER BY 組店コード,行番号" Set dbs = CurrentDbjavascript:void 0; Set rst = dbs.OpenRecordset(strSQL, dbOpenForwardOnly) kind = "" OutData = "" With Application.FileDialog(msoFileDialogFolderPicker) If .Show = True Then strPath = .SelectedItems(1) Else strPath = "" 　←ここ End If End With Open strPath & "\M159(変換後）.csv" For Output As #1 With rst Do While Not .EOF If !組店コード <> kind Then If OutData <> "" Then Print #1, Mid(OutData, 2) End If kind = !組店コード OutData = "" End If For i = 0 To .Fields.Count - 1 OutData = OutData & "," & .Fields(i) Next .MoveNext Loop If OutData <> "" Then Print #1, Mid(OutData, 2) End If End With MsgBox "ファイル出力が終了しました。" Close #1 ' ファイルを閉じます。 End Sub
ACCESS2010 を使用しています。 先日、標題「ACCESS 同じ種類のレコードを１行に纏め、ＣＳＶファイルで出力したい」にて ＣＳＶファイルの書出し方法を下記のとおり教えて頂きました。 ファイルの出力先を、ダイアログで指定できるようにしたいのですが、どのように 直せばよろしいでしょうか。javascript:void 0; Private Sub コマンド0_Click() Dim i As Integer Dim strSQL As String Dim dbs As DAO.Database Dim rst As DAO.Recordset Dim OutData As String Dim kind As String strSQL = "SELECT * from M159 ORDER BY 組店コード,行番号" Set dbs = CurrentDb Set rst = dbs.OpenRecordset(strSQL, dbOpenForwardOnly) kind = "" OutData = "" Open "C:\Users\yukie\Desktop\test.csv" For Output As #1 ' 出力モードで開きます。 With rst Do While Not .EOF ' レコードが無くなるまで繰り返します。 If !組店コード <> kind Then If OutData <> "" Then Print #1, Mid(OutData, 2) End If kind = !組店コード OutData = "" End If For i = 0 To .Fields.Count - 1 OutData = OutData & "," & .Fields(i) Next .MoveNext Loop If OutData <> "" Then Print #1, Mid(OutData, 2) End If End With Close #1 '
ACCESS2010を使用しています。 フォーム名:F_メイン クエリ名：Q_00010_顧客基本 フォームに以下のテキストボックスを作成し、検索（抽出）できるようにしています。 　①顧客番号 　　　　※テキストボックスの名前⇒検索 　②担当者コード 　　　　※テキストボックスの名前⇒担当者コード検索 　③店舗コード 　　　　※テキストボックスの名前⇒店舗コード検索 クエリに以下の３つのフィールドを作成しています。 ３つのフィールドの抽出条件には、"True"を設定しています。 IIf(IsNull([Forms]![F_メイン]![検索]),True,[顧客番号]=[Forms]![F_メイン]![検索]) IIf(IsNull([Forms]![F_メイン]![担当者コード検索]),True,[担当者コード]=[Forms]![F_メイン]![担当者コード検索]) IIf(IsNull([Forms]![F_メイン]![店舗コード検索]),True,[店舗コードコード]=[Forms]![F_メイン]![店舗コード検索]) テーブルに存在する顧客番号や店舗コード、担当者コードを入力すると、問題なくレポートが表示されますが、 存在しない場合「実行時エラー"2427"　指定した式には値がありません」が 表示され、「デバック」「終了」のボタンが表示されてしまいます。 【やりたいこと】 上記のエラーではなく、「該当するデータはありません」のメッセージで「ＯＫ」ボタン を表示し、「ＯＫ」ボタンを押すと、元のフォーム画面に戻るようにしたい。 ご教授、お願いします。
ACCESS ２０１０を使用しています。 テーブルのレコードで、同じ種類のレコードを１行に纏め、最終的にＣＳＶに出力したいのですが、 マクロなどで自動的におこなうことはできないでしょうか？ 例． テーブル名：test 【テーブルのイメージ】 通番 種類 金額 1 Ａ 100 2 A 150 3 A 130 1 B 200 2 B 150 3 B 350 1 C 100 2 C 500 3 C 250 【ＣＳＶの出力イメージ】 　1,A,100,2,A,150,3,A,130 　1,B,200,2,B,150,3,B,350 　1,C,100,2,C,500,3,C,250 補足）◎通番についてですが、上記例だと１～30ですが、実際は１～30まであります。 　　　　なお、通番はどの種類も1～30まであります 　　　◎項目の数ですが、上記例だと３項目ですが、実際は３０項目ほどあります。　 　　　◎種類の数ですが、上記例だと３種類（Ａ～Ｃ）ですが、実際は１５０種類あります。 　　　◎ＣＳＶ保存場所は、できれば都度、指定できるといいのですが、固定でもかまいません。 VBAの知識はほとんどありませんが、VBAによる回答でも構いません。 よろしくお願いいたします。
ACCESS初心者です。 図のようなテーブルがあります。 このテーブルの右側にクエリで「各商品の平均値（空白セルは省く）」 ならびに「空白セルの個数」を反映したいと思っております。 過去に質問をさせていただいた案件（https://oshiete.goo.ne.jp/qa/9327298.html）の内容と類似することから、 恐らくモジュールならびにクエリ式を合わせ技にて両値を反映することになるかと想定しているのですが、調べてもなかなか当案件に類似した内容の記載を見出すことができません。 モジュール・クエリ両内容をどなたかご提案いただけないでしょうか？ 何卒よろしくお願いいたします。
オンプレにあるSQL ServerのデータをクラウドのAzure SQL Databaseからリアルタイムに参照したいのですが、リンクサーバーは使えないようです。うまい方法ありませんでしょうか？ 最悪、CSVかなんかでバッチ的に連携するしかないかなと思っていますが・・ よろしくお願いいたします。
SQLをパソコンでやりたいのですがどれダウンロードすればいいですか？
ACCESS初心者です。 ﾃｰﾌﾞﾙ1：販売表 商品名｜価格｜販売日 リンゴ｜$2｜6/23 バナナ｜$1.5｜6/5 メロン｜$10｜6/1 バナナ｜$1.7｜5/25 メロン｜$9｜5/23 ﾃｰﾌﾞﾙ2：決済日-レート 決済日｜レート 6/30｜105円 6/14｜103円 5/31｜102円 このように販売表と決済日-レートのテーブル2つがあります。 このとき、クエリにて販売表にその注文に該当するレートを反映したく考えております。 商品名｜ 価格｜販売日｜レート｜ リンゴ｜ $2｜ 6/23｜105円｜ バナナ｜$1.5｜ 6/5｜103円｜ メロン｜ $10｜ 6/1｜103円｜ バナナ｜$1.7｜ 5/25｜ 102円｜ メロン｜ $9｜ 5/23｜102円｜ パターンとしては、 日付が各販売日の直近（直後）のものを該当レートとして反映させたく存じます。 このとき、クエリのレートフィールドにどのような式を反映させればよいでしょうか？ どなたか、ご助言いただければ幸いです。 何卒よろしくお願いいたします。
アクセスを編集しています。 テーブルやクエリなどのオブジェクトが増えていく中で、過去に作成したオブジェクトの名前を変更したいと思うことがあるのですが、変更してしまうとそのオブジェクトが式の中に含まれているクエリがエラーを起こして実行できなくなってしまうので変更ができません。 オブジェクト名を変更した際、その名を含む式も同時に更新されるような設定はないものでしょうか？ 教えていただければ幸いです。
ACCESS初心者です。 各項目に重複を有するテーブルがあります。 ID｜販売日｜価格｜商品名｜ 1｜3/5｜150円｜バナナ｜ 2｜6/8｜350円｜メロン｜ 3｜4/7｜200円｜みかん｜ 4｜4/7｜250円｜みかん｜ 5｜7/8｜350円｜メロン｜ このうち、全項目において重複している行（ID3と5）のみを削除する削除クエリを作成したいのですがどのような数式になりますでしょうか？ 教えていただければ幸いです。 何卒よろしくお願いいたします。
古いオフコンのシステムで、富士通のASPというのを使っています。 EDTFILEという機能で、ファイルのレコードに直接アクセスができ、 RDBのレコードの書き換えができるのですが、 本日、HVTOKMF.HVFLLIBというファイルに直接アクセスし、 書き換えている途中、急な落雷に伴う停電が発生し、 オフコンの電源が落ちてしまいました。 どうやらファイルが開きっぱなしになっているらしく、 通常の業務を行おうとしても、EDTFILEで書き換えをしようとしても、すべて S2597 ファイルがアクセス禁止状態になっています というエラーメッセージが出てしまい、まったく操作ができません。 ソフトウェアを開発したソフトハウスもとうの昔に廃業しており、 オフコンに詳しい方も周りにおらず、たいへん困っています。 どなたか詳しい方がいらっしゃいましたら、対処法を教えてください。 お願いします。
ACCESS初心者です。 項目が複数あるテーブルがあるのですが、特定の項目においての重複を削除するのではなく、全項目において重複している行のみを削除するクエリの数式があれば教えていただけますでしょうか？ 何卒よろしくお願いいたします。
ACCESS初心者です。 ﾃｰﾌﾞﾙ1：販売表 商品名｜価格｜販売日 リンゴ｜$2｜6/23 バナナ｜$1.5｜6/5 メロン｜$10｜6/1 バナナ｜$1.7｜5/25 メロン｜$9｜5/23 ﾃｰﾌﾞﾙ2：決済日 決済日 6/30 6/14 5/31 このように販売表と決済日のテーブル2つがあります。 このとき、クエリにて販売表にその注文に該当する決済日を反映したく考えております。 商品名｜ 価格｜販売日｜決済日｜ リンゴ｜ $2｜ 6/23｜ 6/30｜ バナナ｜$1.5｜ 6/5｜ 6/14｜ メロン｜ $10｜ 6/1｜ 6/14｜ バナナ｜$1.7｜ 5/25｜ 5/31｜ メロン｜ $9｜ 5/23｜ 5/31｜ パターンとしては、 日付が各販売日の直近（直後）のものを該当決済日として反映させたく存じます。 このとき、クエリの販売日フィールドにどのような式を反映させればよいでしょうか？ どなたか、ご助言いただければ幸いです。 何卒よろしくお願いいたします。
こんにちは。Access（2013）で【案件ﾘｽﾄ】ﾃｰﾌﾞﾙをﾒｲﾝにして【人件費明細ﾘｽﾄ】ﾃｰﾌﾞﾙをｻﾌﾞとしたﾌｫｰﾑを作成し、ｻﾌﾞﾌｫｰﾑで[氏名]を選んだ時に[時間給]も自動に反映させるためにはどのような設定をしたらよいでしょうか。 他に【従業員ﾘｽﾄ】ﾃｰﾌﾞﾙを作成してまして、[従業員ID][氏名][所属][時間給][備考]の五つのﾌｨｰﾙﾄﾞからなってます。 【人件費明細ﾘｽﾄ】は[人件費ID][案件親ID][氏名][時間給][稼働日数]の五つです。 【人件費明細ﾘｽﾄ】の[氏名]はｺﾝﾎﾞﾎﾞｯｸｽで【従業員ﾘｽﾄ】の[氏名]を参照してます。 【人件費明細ﾘｽﾄ】で[氏名]を選んだ時にその人の時間給も自動的に[時間給]のﾌｨｰﾙﾄﾞに反映させたいです。 ちなみに、[時間給]*[稼働日数]を小計で出すために【人件費明細ﾘｽﾄ ｸｴﾘ】を作成しました。ﾌｫｰﾑにはこのｸｴﾘをｻﾌﾞﾌｫｰﾑとして使用しております。 稚拙な文章で分かりにくいかもしれませんが、どなたか教えていただけましたら幸いです。
CREATE TABLE IF NOT EXISTS t1 ( id int(11) NOT NULL, name, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO t1 (id, name) VALUES (1, 'a'); INSERT INTO t1 (id, name) VALUES (2, 'b'); CREATE TABLE IF NOT EXISTS t2 ( id int(11) NOT NULL, t1_id INT, price INT, PRIMARY KEY(id), FOREIGN KEY (t1_id) REFERENCES t1(id) on update cascade on delete cascade ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO t2 (id, t1_id, price) VALUES (1, 1, 1000); INSERT INTO t2 (id, t1_id, price) VALUES (2, 1, 800); INSERT INTO t2 (id, t1_id, price) VALUES (3, 1, 500); INSERT INTO t2 (id, t1_id, price) VALUES (4, 2, 2000); INSERT INTO t2 (id, t1_id, price) VALUES (5, 2, 100); このようなテーブル構造で、t2テーブル内の t1_id=1の最後、INSERT INTO t2 (id, t1_id, price) VALUES (3, 1, 500); t1_id=2の最後、INSERT INTO t2 (id, t1_id, price) VALUES (5, 2, 100); のpriceの合計 500+100=600 を得たいのですが、どのようなSQL文にすれば良いのでしょうか？
ACCESS初心者です。 　　　A商店価格｜B商店価格｜C商店価格 バナナ｜　120　｜　150　｜　130　｜ メロン｜　450　｜　410　｜　420　｜ すいか｜　340　｜　320　｜　370　｜ このようなﾃｰﾌﾞﾙがあります。 このテーブルの右側にクエリを使って各商品の最小値を反映したいと思っております。 　　　A商店価格｜B商店価格｜C商店価格 バナナ｜　120　｜　150　｜　130　｜　120　 メロン｜　450　｜　410　｜　420　｜　410　 すいか｜　340　｜　320　｜　370　｜　320　 調べたところ、過去に同条件で「最大値」を反映させたいと質問されていた方がおり、 以下のモジュールとクエリ式を記載するという解決法が提示されておりました。 （https://oshiete.goo.ne.jp/qa/958118.html） モジュール Function myMax(ParamArray a()) Dim i myMax = -9999 For i = 0 To UBound(a()) If a(i) > myMax Then myMax = a(i) Next End Function クエリ式 myMax([n01],[n02],[n03]) そこで、ここに記載されているとおりの内容を実施すると、 最大値を反映させることができました。 そこで、このモジュールならびにクエリ式に若干の変更を加え、 最小値を反映させられるようにしたいのですが、 どなたか、その内容をご教示いただけないでしょうか？ 何卒よろしくお願いいたします。
Access初心者です。 自分でいろいろと調べてみましたがわからないことばかりだったので教えていただきたいと思います。 ①Accessのテーブルからtxtに出力する際に(”A”)のようになるので(")を表示させないコード ②Excelからテーブルにセルごとにエクスポートできるコード(一気にエクスポートした際に文字化けしたため) ボタンを押した際の処理として上の二つを使用したいと思っているのでご協力お願いします
初心者です。 DBの同じカラム直下に複数のレコードをinsertさせるにはどうすればよいかどなたか教えて頂けますでしょうか。 以下は入力フォームで入力した複数の日付を確認画面で受け取ったものです。 <table> <th>休日年月日</th> <td>2016/9/12,2016/9/14,2016/9/20,2016/9/26,2016/9/28</td> </table> 日付が一つでしたらinsertは可能ですが、複数の場合はinsertできませんでした。 複数でinsertした場合のDBのイメージは以下の通りです。 holiday(カラム名) 2016/9/12（レコード1行目） 2016/9/14（レコード2行目） 2016/9/20（レコード3行目） 2016/9/26（レコード4行目） 2016/9/28（レコード5行目） どなたか教えて頂けたら幸いです。 よろしくお願い致します。
Ａ列で条件を判断し結果をＤ列に記入するにはどうすれば良いのですか。 A列が3000以上の場合Ｄ列にＡ A列が2000から3000の場合Ｄ列にＢ A列が1000から2000の場合Ｄ列にＣ でＡ列が増えていきます。 　　　Ａ列　　　　　　Ｄ列 １　　3500　　　　　　Ａ ２　　2500　　　　　　Ｂ ３　　1000　　　　　　Ｃ ・ ・ ・ 150　3400　　　　　　Ａ よろしくお願いします。
お世話になります。 表題のとおり、Access テキスト型に対する指定桁での0埋め方法を探しております。 対象とする値が数値である場合は、「Format」関数で処理が行えるのですが、先頭が文字列の場合ですと、0埋め処理がスルーされてしまいます。 以下のサンプルのデータに対し、指定桁での0埋め方法について、良い案がありましたらおしえてください。 ～～サンプル処理前～～ [項目1] 021 ｵ21 ﾇ2 320 ～～サンプル処理後～～（Format関数　6桁を0埋め） [項目1] 000021 ｵ21 ﾇ2 000320 ～～サンプル目指す形～～（6桁を0埋め） [項目1] 000021 000ｵ21 0000ﾇ2 000320
mysqlからSQLダンプしたテキストファイルを linuxのsplit -C 1024M ファイル名 で分割したのですが、（こうすると1024MB以下で行単位で区切ってくれる） 複数行にまたがっているSQL文の途中行で区切られている場合があり、 別マシンのデータベースにインポートするとエラーになってしまいます。 SQL文の末尾はセミコロンなのですが、 1024MB以下になるように、セミコロンが末尾にある行で区切ってもらう方法を探しております。 linuxのコマンドでもwindowsフリーソフトでもかまいません。 ご存じの方どうかご教示ください。
SQL初心者です。 下記のテーブルから結果を表示したいです。 ■数量テーブル 営業所区分 　センター区分　　数量 null 　　　　 91　　　　　　　1 null 　　　　 91　　　　　　　2 null 　　　　 92　　　　　　　3 null 　　　　 92　　　　　　　4 01 　　　　　91　　　　　　　1 01 　　　　　91　　　　　　　2 01 　　　　　92　　　　　　　3 01 　　　　　92　　　　　　　4 ■結果 営業所区分　 数量 01　　　　　　10 91　　　　　　3 92　　　　　　7 SELECT CASE WHEN 営業所区分 IS NULL THEN センタ-区分 ELSE 営業所区分 END, SUM(数量) AS 数量 FROM 数量テーブル GROUP BY 営業所区分 ORDER BY 営業所区分 上記の記述してみましたが取得できませんでした。 よろしくお願いします。
ローカルの環境（XAMPP)で動作していたPHPのプログラムを レンタルサーバにアップロードして動作させたところ、 日本語データが全て、"???????"と表示されしまいます。 mysqli_select_db($conn, "p13ns4_006_server_cans"); mysqli_set_charset('utf8'); と、mysqli_set_charset('utf8'); は、入れてあります。 何か、考えられる事あるでしょうか？
メイン／サブフォームで、メインには「顧客テーブル」を置き[更新繰越][繰越]フィールドがあり、サブには月別抽出で「入金クエリ」からの[入金合計]と日別抽出で「請求クエリ」から[請求合計]を基にメインに[現在繰越]を計算させます。[現在繰越]をマクロの「値の代入」で[更新繰越]に書き込みたいのです。※[繰越]に書き込みますと[繰越]から[入金合計]をマイナスし[請求合計]をプラスさせる計算をして[現在繰越]を出していますので[繰越]が更新されますと重複された計算がされてしまうことと印刷時に[繰越]の数字が計算されたものになってしまうため一旦[更新繰越]に入れておき後でUPDATEで[更新繰越]を[繰越]にするようにしています。 メイン／サブフォームを表示させ、マクロのアクションボタンをクリックし「値の代入」を実行させますと、フォームの[現在繰越]はカレントレコードの[更新繰越]に書き込まれます。しかし、「顧客テーブル」のレコードが複数ありますが全レコードには書き込まれていません。 「値の代入」の後「次のレコード」へ移動し「値の代入」をし「次のレコード」へ移動をレコード数分繰り返し記述しましたが全レコードに書き込まれはしますが、どこから引っ張ってきたか判らない各レコードの[繰越]データになってしまいます。 マクロの記述で適当なレコードの[現在繰越]を数字に変更してみますとそれに変更されますので、「値の代入」は機能しているようですが、[現在繰越]のデータが[繰越]になっているようです。 カレントレコード１件なら機能するのが、全レコード対象では上手く機能しないことが判りません。「オブジェクトの再描画」を挿入してみたりもしましたが駄目でした。 マクロまでは分かりますがＶＢＡは良く分かりません。マクロではこの処理は出来ないのでしょうか？
ACCESS初心者です。 時間外入力データベースを作ろうと考えているのですが例えば時間外の入力を開始時間17：00、終了時間23：00を入力した場合、22：00以降時給が変わるので通常時間外は17：00～22：00なので300分、深夜時間外は22：00～23：00なので60分と自動で抽出し表記できるようなVBAを教えていただけませんか？ すいませんが、お願いいたします。
選択クエリで条件にあったレコードを抽出した後、マクロでその内の必要なフィールドを複数「一時変数設定」で変数にしてから新規レコードを開いて、設定した各「一時変数」を各フィールドに入力していく記述が判りません。新規レコードでいちいち”Ctrl”+”７”で前レコードのフィールドを複写して来るのが面倒なのでよろしくお願い致します。VBAでは同じような事項の回答があるのですが、悲しいことにVBAが判りません。
MS-AccessのデータをMySQLデータベースに変更する為に、 MS-AccessのテーブルからODBCデータベースにエクスポートしようとすると 「データをエクスポートできませんでした」のダイアログが出て、エラーが発生してしまいます。 対象のテーブルは幾つかあって、他のテーブルは成功するのですが、 一つのテーブルだけが、このエラーになってしまいます。 バージョンは、 Connector/ODBC 5.3.6 を使用しています。 エラーの原因として考えられる事等、ご教授ください。
今、以下の仕様でバッチファイル作成を頼まれてますが、ツール作成の経験がないので教えて下さい。 以下、仕様です。 1.ＤＢから対象項目を抽出し、txtもしくはcsv出力 2.抽出した項目を1件づつ読み、その項目が別ファイルに存在するか検索する。 3.検索して存在しなかったら、マスターの項目をファイルに出力する。 以上がやりたい事ですが、1番のＤＢ抽出までは出来ました。 OS：windows2012 DB：RDB そもそもこの仕様が可能なのか分からないですが、実現する為のコマンドが何かでつまずいています。 すいませんが、宜しくお願いします。
太郎　サッカー 2 データベースから 名前と球技名でgroup化した結果 次郎 サッカー 2 左のようになったのですが 太郎 野球 1　　　　番号の小さい順に（野球、サッカー、ラグビーの順に）ならびかえたい 　 次郎 野球 1　　　　のですがorder by　番号 してもエラーがでます。 三郎 ラグビー 3　　良い方法はないものでしょうか。 三郎 ラグビー 3　　どうぞどなたかおねがいします！！
データベースを使用して、SQLのデータを上書きしたいのですが、 『m_control』テーブルの「controlid」にある同名データ（'PRIMARY'）があるため、エラーになります。 どうしたら、データベースを上書きできるのかを、教えてください。
超初心者ですが、試行錯誤でAccessデータベースを作成しています。 検索用フォーム（A）にテキストボックス（テキスト１）とコマンドボタン（コマンド１）を作成し。テキスト１に検索したい数字（EQP#）を入力しコマンド１をクリックすると、クエリテーブル（Q_ABC）のレコードを探しに行って、該当するEQP#のレコードがあればレコードのすべての項目を検索結果フォーム（B）で表示させるVBAを組んでいます。 ＜コマンドボタン（コマンド１）のイベントブローシャー＞ Private Sub コマンド1_Click() If IsNull(Me.テキスト１.Value) Then MsgBox "EQP番号を入力してくだい。" Else DoCmd.OpenForm "F_OOTUサマリ", acNormal, , "Forms![EQP検索Bd]![テキスト１]=[Q_ABC一覧]![EQP#]" End If End Sub 上記のVBAでは、テキスト１に該当するEQP#を入力してコマンドボタンをクリックすると期待するフォームが開きますが、該当しないEQP#を入力するとブランクのフォームが表示されます。 該当しないEQP#を入力した時は、フォームを表示せず「該当データが存在しません。」のようなメッセージのみ表示させるVBAがどうしてもうまくできません。 どのように記述すれば良いか教えて頂きたく質問させていただきました。 よろしくお願いします。
DBを作成するときに、誰かがセッションをつないでいて うまくいかないときがあり、他の人に頼んでセッションを 切ってもらってます。 セッションを確認することが出来るツールで扱いやすいのは 何がありますでしょうか？
Access初心者で、勉強中の身です。ご教示ください。 【テーブルA】には「計算条件」と「計算方法」のフィールドがあります。 計算条件:　　計算方法 　　X　　:　　[フィールド1]×[フィールド2]×1.　 　　Y　　:　　[フィールド1]×[フィールド2]×1.2 　　Z　　:　　([フィールド1]+100)×([フィールド2]+100) 【テーブルB】には下記のフィールドがあります。 ・フィールド1 ・フィールド2 ・計算条件（テーブルAの「計算条件」からルックアップ） 以上の2つのテーブルから、クエリで「計算結果」を算出したいです。 IIF関数を使えば指定した計算条件を基に計算結果を出せそうですが、テーブルAの計算方法を変更した時には、その関数もいちいち変えなければならないというデメリットがあります。 「計算方法」に入力した数式を、そのまま計算に使えるなんてことはできますでしょうか。 ご助言のほど、宜しくお願いいたします。
Access2010でのコンボボックスの連動（３コンボ）について質問します。 一覧表テーブルを元に作成したフォームに支店工場テーブルからコンボボックスでデータを取得したいのですが、支店（大分類）コンボにA支店と入れたら工場（中分類）コンボではa工場、b工場のみ表示（大分類でA支店となっているもの）され、工場（中分類）コンボにb工場と入れると都道府県（小分類）コンボには宮城県と表示されるようにしたいのですが、うまくいきません。 私が行った処理ですが、 コンボプロパティシートのデータ 支店（大分類）コンボ コントロールソース　　空白 値集合ソース　　　　　『SELECT DISTINCT 支店名 FROM 一覧表テーブル;』 工場（中分類）コンボ コントロールソース　　空白 値集合ソース　　　　　『SELECT DISTINCT 工場名 FROM 一覧表テーブル WHERE 支店名=[支店（大分類）コンボ]; 都道府県（小分類）コンボ コントロールソース　　空白 値集合ソース　　　　　『SELECT DISTINCT 所在地都道府県 一覧表テーブル WHERE 支店名=[支店（大分類）コンボ] AND 工場名=[工場（中分類）コンボ]; コンボプロパティシートのイベント（再抽出処理） 工場（中分類）コンボ フォーカス取得時イベントコード　 Private Sub 工場（中分類）コンボ_Enter() Me.工場（中分類）コンボ.Requery End Sub 都道府県（小分類）コンボ フォーカス取得時イベントコード Private Sub 都道府県（小分類）コンボ_Enter() Me.都道府県（小分類）コンボ.Requery End Sub 以上のように設定してみたのですが、フォームのコンボボックスには何も表示されず、真っ白（空白？）になってしまい、色々調べてみたのですが、どうしてもうまくいきません・・・ ◎一覧表テーブル：フォーム ID　支店名　工場名　所在地都道府県　所在地住所　・・・ 1 2 3 ◎支店工場テーブル 　 　【大分類】　【中分類】　　【小分類】 ID　 　 支店　　 　 工場　　　　 都道府県 1　　　A支店　　　a工場　　 　　北海道 2　　　A支店　　　b工場　　 　　宮城県 3　　　B支店　　　c工場　　 　　茨城県 4　　　B支店　　　d工場　　　　 東京都 5　　　B支店　　　e工場　　　　神奈川県 6　　　C支店　　　f工場　　 　　大阪府 7　　　C支店　　　g工場　　　　 兵庫県 ※支店名・工場名・所在地都道府県の３つはルックアップウィザードで以下の様にそれぞれ支店工場テーブルから取得しています。（リレーションシップもされています） 一覧表テーブル　　　　　支店工場テーブル 支店名　　　　　・・・　支店 工場名　　　　　・・・　工場 所在地都道府県　・・・　都道府県 分かる方がおりましたら、ご教授の程、お願い致します。
windows7でAccess2007を使っています。 どうしても、htmlをフォームとして扱いたいのですが。 出来るのでしょうか。 宜しくお願いします。
SQl勉強中の初心者です 結合したテーブルのSUMの値が思うように集計できません。 以下のような2つのテーブルがあったとします。 テーブルA Date,ConNo 2016-05-15,test001 2016-05-15,test001 2016-05-25,test002 2016-05-25,test002 2016-05-25,test002 テーブルB ConNo,line,Amt test002,1,1500 test002,2,1500 test002,3,1500 select A.Date,A.ConNo,Sum(B.RAmt) as B_sum from テーブルA A left outer join テーブルB B on A.ConNo= B.ConNo group by A.Date,A.ConNo into :arDate,:arConNo,:arAmt; テーブルAを主として、group byしたときに、対応するテーブルBをSUMしたいのですが、 SUMした値が以下のようにデータ数分倍になってしまいます。 2016-05-15,test001,0 2016-05-25,test002,13500 以下のような結果にする場合は、どう書けばいいのでしょうか? 2016-05-15,test001,0 2016-05-25,test002,4500 宜しくお願いします
添付のようなデータが月ごと12テーブルあります。 A,B,C,Dは月ごとに異なっています。 全て合成して、1月1日～12月31日までの合計値を出したいのですが どのように処理したらよろしいでしょうか。 よろしくお願いいたします。
「顧客管理方法」について大変困っています。 私はイベント会社をやっていて、イベント毎に顧客情報を管理しなければいけません。無料で良いソフト、方法などあれば教えて下さい(>︿<｡)パソコン初心者です。 必要な項目 ・参加日 ・名前 ・年齢 ・住所 ・電話番号 ・参加費 ・アドレス ・ダイレクトメール希望or希望しない ①上記をわかりやすく入力したい ②これまでに参加経験があるか検索できるようにしたい(名前or電話番号などで) ③「〇月〇日の参加者」と一発検索ができる これらが簡単にできる方法をご存知の方、知恵をお貸しください。お願いします。
ACCESS で　日付/時刻型のフィールド（日付 (標準)）に 日時を検索したいのですが、 日付を条件にして、最大値（時間が最も新しい）値を求める方法を教えてください。 DMAX関数で求められますか？条件はどのようにすればよいでしょう？
初心者ですが、あるテーブルにあるnullになっているレコードをを抽出してHTMLの検索画面に表示したいです。 仕様上、下記のように書けば、削除済のレコードを抽出することが可能となっております。 EX：<td><input type="radio" name="is_deleted" value="y" %%para:checked:is_deleted:y%% />削除済も表示</td> （paraで置き換えて、is_deletedというカラムの中に「y」の値になっているものを抽出する感じです） nullになっているレコードを抽出するのに下記のように書いてみたのですが、抽出できていません。 <td><input type="checkbox" name="goods_name" value="null" %%para:checked:goods_name:null%% />商品名が空欄のものを表示</td> <td><input type="checkbox" name="goods_no" value="null" %%para:checked:goods_no:null%% />商品NOが空欄のものを表示</td> どなたか教えて頂けますでしょうか。
下記はデータ関連の単語です。同意で意味でしょうか fixedDateRange timeOfDayStart [0..1] よろしｋ
phpmyadminの操作でエクスポートやインポートで、SQLファイルを毎回選択しなくては いけないのですが、これをあらかじめ決めたファイルに設定しておき、 操作として、ファイルを選択する事を省略する事はできないでしょうか？ ご教授下さい。
Access 2016を使用しています。 Accessでの以下の操作の簡略化を求められています。 1．「外部データ」タブを選択する。 2．「保存済みのエクスポート操作」を選択する。 3．保存済みのエクスポート操作には、2個の操作を登録してあるのですが 　 この2個の操作をそれぞれ実行する。 4．操作が完了したら、ダイアログを閉じる。 これだけの操作をもっと、簡単な操作で、できるようにしたいのですが、 どのようにすれば、それが実現できるでしょうか？ ご教授下さい。
下記の「受注」テーブルがあります。 受注番号、セット名、セット金額、行番号、品名、金額 5000-01、お盆セット、2000、1、みかん、1500 5000-01、お盆セット、2000、2、りんご、500 5000-02、正月セット、3000、1、鏡餅、1000 5000-02、正月セット、3000、2、伊達まき、700 5000-02、正月セット、3000、3、こんぶ、1300 これを集計して、 5000-01、お盆セット、2000、1、みかん、1500 空欄、空欄、空欄、2、りんご、500 5000-02、正月セット、3000、1、鏡餅、1000 空欄、空欄、空欄、2、伊達まき、700 空欄、空欄、空欄、3、こんぶ、1300 とするには、SQLをどう書けばいいでしょうか。 外部結合をつかって処理しようとしましたがうまくいきませんでした。 よろしくお願いいたします。
ローカルのPCに存在するmySQLをSQLファイルとしてエクスポートします。 このSQLファイルをインターネット上のサーバ（レンタルサーバ）のphpmyadminで インポートする時に、 ローカルのPCに存在しているSQLファイルを指定するには、どのようにすればいいのでしょうか？ SQLファイルもサーバにアップロードしておく必要があるのでしょうか？ ご教授ください。
MS-Accessで一連の操作手順をマクロに記録させたいのですが、 MS-Accessには「開発」タブが見つかりません。 どのようにすれば、一連の操作をマクロにする事ができるでしょうか？ ご教授下さい。
Access2002を使用しております。 日ごとの仕事の一覧を作成しており、テーブルに ・オートナンバーID ・日付 ・担当者 ・内容 （実際はもっと項目があります） がありまして、定期的な仕事なので入力済みのデータを 新規のレコードにコピーし省力化したいと思っています。 行いたい具体的な動作としては、 入力済みの5月24日のページを開く（カレンダーコントロールをクリック、 その日の一覧が帳票フォームで開きます。毎日およそ30件程度。） ↓ フォーム上の（例えば）コピーボタンをクリックする ↓ カレンダーコントロールが開く ↓ 5月24日と同じ内容をコピーしたい日「6月27日」をクリック ↓ 日付が6月27日となって、担当者と内容は5月24日と同じで 新規レコード（30件）を作成。 という感じです。 VBAで大丈夫です。 宜しくお願い致します。
お世話になります。 クロス集計クエリの列見出しが、商品名にできずにコードになってしまいます！ 先日こちらで、列見出しがコードの場合はクエリ列見出しに商品名で固定しようとしても空白になることを教えて頂きました。 ですが、列見出しがコードのままだと都合が悪い為、どうしても列見出しを商品名にしたくて考えているのですが、どうしてもできません・・ テーブル『販売実績』　フィールド[ID][販売日]・[店舗]・[担当者] テーブル　『販売明細』　フィールド[ID]・[販売実績ID]・[部門]・[商品名]・[商品カラー]・[販売金額]・[販売本数のカウント] という二つのテーブルから[販売明細]をサブフォームにするフォームを作ってそこから入力ができるようにしています。（クエリもこの２つのテーブルから作って、クロス集計にしています。） フォームの[部門]・[商品名]・[商品カラー]はコンボボックスから選択できるようにしており、まず部門を選択するとそれに伴って商品名が絞り込まれて、さらに商品名から商品カラーが絞り込まれるようなコンボボックスにしています。 ここで、コンボボックスの商品名を、商品IDではなく商品名でテーブルに取得したいと思い、（それができれば列見出しも商品名にできると思い）、連結列を２にしてみると、テーブルには商品名で入ったんですが、今度はフォームの絞り込みのコンボボックスが使えなくなりました。 部門から商品名の絞り込みはできるんですが、商品名から商品カラーの絞り込みができなくなりました。 多分連結列を２にしたので、コンボボックスの値がIDから商品名になった為にIDで抽出していたものができなくなった為だと思うんですが、どうにかできないものかと考えているんですがどうにもできません。 この列見出しに商品名を持ってくるということだけで、かなり時間を食ってしまいました。 何か解決策ありましたらご教授ください。 宜しくお願いします。 何分初心者なもので、説明が的外れでしたら申し訳ありません。
MySQLで、複数のカラム値の計算結果をASで新しいカラム名で出力し、新しいカラム名で抽出を行った時にレコード数をカウントする方法を知りたいです。 WHERE句ではエラーになるのでHAVING句を使うということまではわかったのですが、結果の総レコード数を出力することができません。 テーブル名:s id | a | b 1 | 100 | 200 2 | 200 | 80 3 | 300 | 20 4 | 400 | 90 5 | 500 | 40 下記のような手順を踏んでみました。 まず、WHERE句で全件を出力 SELECT count(id) FROM s WHERE 1 [結果] count(id) 5 ASを使わない aカラムで抽出 SELECT count(id) FROM s WHERE 1 AND a BETWEEN 200 AND 400 [結果] count(id) 3 AS を使って (a/b)*100 を計算したカラム c を作成 SELECT id,a,b,(a/b)*100 as c FROM s WHERE 1 AND a BETWEEN 200 AND 400 idが2,3,4の3件分のデータが表示される id | a | b | c 2 | 200 | 80 | 250.0000 3 | 300 | 20 |1500.0000 4 | 400 | 90 | 444.4444 cカラム（計算した結果）でBETWEENを実行 SELECT id,a,b,(a/b)*100 as c FROM s WHERE 1 AND c BETWEEN 200 AND 500 エラーになる #1054 - Unknown column 'c' in 'where clause' ASを使った時に Where句では c を指定できないのでHAVING句を使うということを知り、WHERE句をHAVING句に書き換える。 SELECT id,a,b,(a/b)*100 as c FROM s HAVING 1 AND c BETWEEN 200 AND 500 id | a | b 1 | 100 | 200 |333.3333 2 | 200 | 80 |250.0000 4 | 400 | 90 |444.4444 この結果のレコード数をcountで取得したいです。 SELECT count(*),id,a,b,(a/b)*100 as c FROM s HAVING 1 AND c BETWEEN 200 AND 500 SELECT count(id),id,a,b,(a/b)*100 as c FROM s HAVING 1 AND c BETWEEN 200 AND 500 これだと結果が5件になってしまいます。 idでグループ化すれば良いと思い SELECT count(id),id,a,b,(a/b)*100 as c FROM s GROUP BY id HAVING 1 AND c BETWEEN 200 AND 500 を実行 count(id) | id | a | b | c 1 | 1 | 100 | 30 | 333.333333300 1 | 2 | 200 | 80 | 250.000000000 1 | 4 | 300 | 90 | 444.444444400 HAVINGとGROUPを使っているので、このように3行の結果が出るのは当然だと思うのですが、この時の結果を「SELECT count(*) FROM WHERE 1」の時と同じように count(id) 3 という合計値だけ出力するようにしたいです。 ご回答よろしくお願い致します。 ~~~~~~~~~~~~~~~~~~ テストデータ ~~~~~~~~~~~~~~~~~~ CREATE TABLE `s` ( `id` int(11) NOT NULL, `a` int(3) NOT NULL, `b` int(3) NOT NULL ) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8; INSERT INTO `s` (`id`, `a`, `b`) VALUES (1, 100, 30), (2, 200, 80), (3, 300, 20), (4, 400, 90), (5, 500, 40); ALTER TABLE `s` ADD PRIMARY KEY (`id`); ALTER TABLE `s` MODIFY `id` int(11) NOT NULL AUTO_INCREMENT,AUTO_INCREMENT=6;
MySQLについてですが、ローカルとレンタルサーバー共にphpMyadminで作成データベースを観覧していますが、データ型がvarcharやtextが文字化けします。照合順序は utf8_general_ci になっております。原因がわかりません。こころあたりがありましたらアドバイスくたざい。よろしくお願いします。 一方で、ターミナルコマンドで接続した場合で データベースを確認した場合は、文字化けせずに、しっかりと保存されていますし、データーをセレクトして出力した場合も、しっかりと表示されますので、問題は、phpMyadminの設定にあるのではないかと思うのですが分かりませんでした。
次のようなテーブル構造で CREATE TABLE IF NOT EXISTS area ( id int(11) NOT NULL AUTO_INCREMENT, parent_id INT, name varchar(64), level int NOT NULL, PRIMARY KEY(id), FOREIGN KEY (parent_id) REFERENCES area(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO area (parent_id, name, level) VALUES (NULL, '地球', 1); INSERT INTO area (parent_id, name, level) VALUES (1, '日本', 2); INSERT INTO area (parent_id, name, level) VALUES (2, '東京都', 3); INSERT INTO area (parent_id, name, level) VALUES (3, '千代田区', 4); INSERT INTO area (parent_id, name, level) VALUES (2, '神奈川県', 3); INSERT INTO area (parent_id, name, level) VALUES (4, '大手町', 5); INSERT INTO area (parent_id, name, level) VALUES (7, '1', 6); これを普通に取得すると上から順番（挿入順）に表示されますが、 次のように 地球 　日本 　　東京都 　　　千代田区 　　　　大手町 　　　　　1 　　神奈川県 という順番で取得したいのです。 どのようなSQL文を書けば良いのでしょうか？
Accessについてです。 フォームの「年齢」のコントロールソースに、年齢が自動計算できるよう =DateDiff("yyyy",[生年月日],Date())+(Format([生年月日],"mmdd")>Format(Date(),"mmdd")) & "才" と入れましたが、フォームはきちんと自動計算されて年齢が表示されるのですが、テーブルには反映されません(コントロールソース「年齢」を選択しなければやはりなにも反映されないのでしょうか) テーブルに反映させるにはどうしたらよいのでしょうか。
社内で複数人でアクセス2010で作られた業務システムを使っています。 そのmdbファイルはサーバー内のシステム専用フォルダにあり、端末はハードディスクを内臓していないタイプです。 困っていることの概要ですが 大元のmdbファイルやそれが入っているフォルダのサブフォルダ内からのショートカット起動ではログイン出来るのに、ローカルドライブからのショートカット起動ではログイン出来ないことがどういう理由なのかまったく分かりません。 症状を列記しますと 1. サーバー内のシステム専用フォルダのmdbファイルからショートカットをデスクトップに作成してそこから起動、ログインは出来ます。 2. サーバー内のシステム専用フォルダ内に更に任意のフォルダを作り、そこに大元のmdbファイルをコピーしてそれのショートカットをデスクトップに作成してそこから起動、ログインは出来ます。 3. mdbファイルをネットワーク上のローカルドライブ（Cドライブ）にコピーしてそれのショートカットをデスクトップに作成してそこから起動、ログインしようとするとログイン画面は表示されますが、IDを入れパスワードを入れた後にエラーメッセージが表示されます。メッセージの内容は「他の人が排他的に使用しているか、データを表示したり書き込んだりする権限がない」と出ます。デバッグボタンを押してVBAのコードを見てみると、どうもログインのパスワードのあたりで引っ掛かっているようです。 ローカルドライブにコピーしたmdbファイルだけ何故にログインできないのか、、、途方に暮れております。 よろしくお願い致します。
アクセス初心者です。　現在ACCESS2016を使って受注入力を作成しようとしています。 テーブル：T_商品、T_受注明細（得意先、品名、数量などが登録されます） フォーム：F_受注入力 画像：T_商品の各レコード内に画像という項目名で、ｃ：￥photo￥商品というパスが登録されています。項目は短いテキストが定義されています。例えば100ABC.jpgがｃ：￥photo￥商品\100ABC（品コード+品名をファイル名にしている）が保存されています。 フォーム“F_受注入力”でフォームデザイン上部にある「イメージ」ボタンで枠（項目名　写真）を作りました。 フォーム上で商品コードを入力すると、更新後処理でマクロ「商品入力」が作動し、このマクロ内では「値の代入」で以下のように値入力をしようとしました。 [Forms]![F_受注入力]![写真]　　 DLookUp("[画像]","[M_商品]","[品Cd]=" & [Forms]![F_受注入力]![品Cd]) うまく画像が表示されませんが何か設定ミスか設定漏れもしくは勘違いをしているのでしょうか。 またこれがうまくいったらテーブル「T_受注明細」から、商品の写真付きで受注レポートを出力したいのですが表示印刷できますでしょうか？ 宜しくご指導ください。
インターネット上のホームページからデータベースをアクセス（検索のみ）して、 ホームページにその結果を表示する仕組みについて考えているのですが、 初心者ですので、分からないでいます。 どなたか、よい仕組みをお教え下さい。 前提を以下に示します。 (1) ある会社のホームページが外部のサーバに置かれています。 (2) その会社では、ローカルでMS Accessを使用して、Accessデータベースを作成しています。 (3) ホームページ上から検索するデータはこのAccessに格納されているデータです。 そこで、教えて頂きたいのが、サーバ上で検索する場合、サーバにはどのデータベース形式 （Access、MySql、PostgreSQL等）がよいのでしょうか？ （ローカルのAccessデータベースを妥当なデータベースに変換してアップロードする 　事を考えています） 又、アクセスの手段として、HTMLから直接アクセス、JAVAによるアクセス、PHPからのアクセス 等が考えられると思うのですが、どの仕組みが単純にできるでしょうか？ この時、考慮しなければいけないのが、ホームページは外部のサーバにあるため、 必要なドライバ等のインストールを行う事はできない。 という点です。 どのような仕組みが単純に実現できるのか、どなたかいいお知恵をご教授下さい。 よろしくお願い致します。
mysqlのselect文について質問があります。 idというカラムから下4桁と一致するデータを抽出したいと思っています。 下記のようなselect文を試したのですが「返り値が空でした(行数0)」と表示されてしまいます。 $idnumber = 0001; SELECT * from meibo where SUBSTR('id',-4,4) = '$idnumber'; idカラムには50001というデータがあるのは確認しているので、select文が間違っていると思うのですがどこが原因なのでしょうか。
エクセルで部署ごとの退職者数を出したいのですが、 途中で部署名の変更があった部署がうまく抽出できません。（財務部→財務経理部に変更など） 古い部署名はそのままの古い部署名で抽出をしたいと思っています。 その際、財務経理部を抽出しようとすると 財務部の人数も含まれてしまいます。 どのようにしたらいいのでしょうか？
Access runtimeの利用についてです。 Access runtimeをダウンロードし、Accessファイルを開こうとしても開けなかったため、ネットで調べオプション→カレントデータベースで ・ステータスバーを表示する ・ショートカットキーを有効にする ・ナビゲーションウィンドウを表示する ・すべてのメニューを表示する ・既定のショートカットメニュー のチェックを外し、フォーム1つのみ参照、入力が可能になりました。 Access runtimeではこれが限界なのでしょうか。 できればテーブル、クエリ、フォーム等全てが参照できるようにしたいのですが… 詳しい方、ご回答お待ちしております。
MySQLで作ったデータベースをローカルからレンタルサーバーに移動するとき、サーバーにあるphpAdminよりエクスポートしてインポートするまたは、TeraTermなどでサーバーのmysqlにログインしてデータベースやテーブルをいっこいっこ作っていく方法が思いあたりますが、プロの方はどのようにやっていますでしようか? 　この他にも方法はありますか?
ローカルで作成したMySQLのテーブルデータをサーバーに移したいのですが、スムーズにいかずにいます。(ローカルのphpMyAdminよりエクスポートした、sqlファイルを編集したものをサーバー側のphpMyAdminよりインポートしています。) 特に、登録日と更新日のカラムのCURRENT_TIMESTAMPに問題があるようで、下記のようなメッセージがでます。2つは無理とのことです。 #1293 - Incorrect table definition; there can be only one TIMESTAMP column with CURRENT_TIMESTAMP in DEFAULT or ON UPDATE clause 　 しかし、ローカルではちゃんと定義されているので、なぜサーバーになると無理なのかがわかりません。 このようなSQLの文章になっていますが、どのように書けば、2つのCURRENT_TIMESTAMPの存在が可能になりますでしょうか? よろしくお願いましす。 CREATE TABLE IF NOT EXISTS `comment` ( `comment_id` bigint(20) unsigned NOT NULL AUTO_INCREMENT PRIMARY KEY, `post_id` int(11) DEFAULT NULL, `content` text CHARACTER SET utf8, `reg_tim` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP, `upd_tim` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP ) ENGINE=InnoDB DEFAULT CHARACTER SET=utf8;
DB2 V10、 Linuxで環境構築を行っています。 どうしてもわからない事があり、質問します。 2台のサーバ（同一構成）があり、 それぞれに存在するDBの内容を同期したいと思っています。 マニュアルやWebサイトでの情報から、SQLレプリケーションが使用できそうな気がするのですが、 １点わかりません。 双方向でレプリケーションは可能でしょうか？（更新情報の重複は発生しない前提です。） データの更新頻度は常に行われるものではないので、 ある程度の間隔でレプリケーションを実行するようにすれば、 データ紛失リスクを許容しようと思っています。 もし参考URL等あれば、、それも教えて頂きたいです。 どなたかアドバイスを頂ければと思います。 よろしくお願いします。
ACCESS2016で名簿を作成しています。名簿のテーブルのフィールドは、ID,名前、住所、電話、メール、登録年月日、備考があります。ACCESSでは、容量が最大２Gとまでの制限があるようなので、これを超えないようにするため、古いレコードはExcelに出力して、出力したレコードはACCESSのテーブルから削除できるようにしたいと思っています。様々な本を調べましたがVBAではどのようにしたら良いのかわかりません。このようにすることは無理なのでしょうか？できれば出力先のExcelは、毎回新たにファイル名をしてして保存できるようにできないか？とも思っています。 　どなたかご存じな方、ご教授お願いします。
mySQLでselectした100万件近くをinsertしたいのですが insert selectは遅いので別の方法を考えています。 プロシージャを作成してselectした結果で バルクinsertをしようと思うのですがどう書けばいいか、よくわからず。 どなたか教えていただけないでしょうか。 mySQL初心者です。 よろしくお願いします。
MySQLでのことですが、MAX()とGROUP BYを使うの＋ ORDER BY を使いたいのですが、どうもいっしょ使えないようなのでよい方法はありますでしょうか?よろしくお願いします。　下記のクエリのように SELECT name, content, max(time) FROM message GROUP BY name messageテーブルより name の同じものをグループ化し、その中でも更新が新しいものをMAX()で出力しています。ただグループ化したそれぞれのnameの最新更新は出力できますが、これらの最後に ORDER BY time DESC　を加え　timeの新しいものから順に並ぶようにしたいのですが、これが上手く機能しません。
テーブル１ 販売店名　品名　　金額 Ａ販売店／いちご／５００円 Ａ販売店／みかん／３００円 Ａ販売店／りんご／８００円 Ｂ販売店／いちご／５００円 Ｂ販売店／みかん／３００円 Ｂ販売店／りんご／８００円 Ｂ販売店／ばなな／４００円 Ｃ販売店／いちご／５００円 Ｃ販売店／みかん／３００円 Ｃ販売店／りんご／８００円 テーブル２ 販売店名　品名１　品名２　品名３　品名４ Ａ販売店／いちご／みかん／りんご Ｂ販売店／いちご／みかん／りんご／ばなな Ｃ販売店／いちご／みかん／りんご これを下記のように結合したい 販売店名　品名１　金額　　　品名２　金額　　　品名３　金額　　　品名４　金額 Ａ販売店／いちご／５００円／みかん／３００円／りんご／８００円 Ｂ販売店／いちご／５００円／みかん／３００円／りんご／８００円／ばなな／４００円 Ｃ販売店／いちご／５００円／みかん／３００円／りんご／８００円 どのようにすればよいでしょうか？ クエリーだけでも可能ですかね？
下記のようMySQLを使い、Unionで結合していますが、出力する2つのカラムのうち、一列目のカラムの重複している部分がある行だけ省きたいと思います。そこで、group by を最後に追加したいと思うのですが、動きませんでした。もしかしたら結合したあとにGROUP BYは無理なのかもしれませんが、他のやり方でも可能なら教えてくださいるよろしくお願いします。 (SELECT other_id AS a,send_tim FROM message WHERE user_id =5 GROUP BY other_id)union (SELECT user_id AS a,send_tim FROM message WHERE other_id =5 GROUP BY user_id)order by send_tim desc GROUP BY a
今家計簿をＡｃｃｅｓｓ２０１６､ＶＢＡで作成しています。 財布から支払った金額を一ヶ月で、その摘要の種類毎に合計してクエリで出力したり、ＰＤＦファイル又はエクセルに出力したりしたいです。 ためしにクエリーでしてみると、一度に違う摘要の合計を出力することはできず、支払った金額のフィールドがゼロ円になってしまいました。 何か良い方法はありませんでしょうか。 初歩的な質問かと思いますが、誰かわかる方がいましたら、ご教授のほうよろしくお願いします。
Access runtimeではフォームに入力、その内容を保存することはできるのでしょうか。
DBは、Mysqlです。どうかアドバイスをいただきたいです。 宜しくお願いします。 以下のようなテーブル table1 があります。 ******************* table1 ******************* 銀行名, 出金, 入金, 月 ******************* A, 100, 0, 2月 B, 0, 100, 2月 A, 0, 100, 2月 A, 100, 0, 3月 B, 100, 0, 3月 B, 0, 100, 3月 A, 100, 0, 3月 B, 0, 100, 4月 ... ******************* 3月時点の各口座の出金合計、入金合計、前月残高、翌月繰越を求めたいです。 select (SUM(t.入金) - SUM(t.出金)) as 前月残高, SUM(t.入金) as 入金合計, SUM(t.出金) as 出金合計, (SUM(t.入金) - SUM(t.出金)) as 翌月繰越 from table1 as ｔ selectは、こんな感じでまとめたいのですが、それぞれの条件が3月、3月以前、3月以後と異なっているために、一つのselectにまとめられず、困っております。 自己結合なのか、サブクエリなのか、別の方法なのか。 アドバイス頂けたらと思います。 宜しくお願いします
100程の項目について、画像と情報付きでデータベースを作りたいのですが、なにかいいフリーソフトはないでしょうか。
SQL言語を基礎から勉強したいんですけれど、おすすめの勉強の仕方ないですか？
tableA ID name 1 りんご 2　もも 3　魚 tableB ID snama s_cate　code 1 ジャム　　｛１,2｝ 1111 ２　ちくわ　｛３｝ 1112 というあります。 私は、tableB のcode：1111でセレクトすると s_cate の配列にあるコードが若い１をtableAとジョインして 「ジャム」の値を返してほしいのですが、なかなかうまくいきません。 アドバイスをお願いします。 DBはPostgresです。
2つのテーブル内に［会社］と［金額］というフィールドがあり、［会社］毎に［金額］の合計を出力し、比較結果を出力するにはどうしたらよいでしょうか。 ■テーブル1 会社｜金額 A ｜50 B ｜100 C ｜200 A ｜300 ■テーブル2 会社｜金額 B ｜100 C ｜100 D ｜300 C ｜100 ■結果 会社｜テーブル1金額｜テーブル2金額｜比較結果 A ｜350 ｜0 ｜NG B ｜100 ｜100 ｜OK C ｜200 ｜200 ｜OK D ｜0 ｜300 ｜NG
初心者です。 phpファイルにおいて下記のように書きましたらDBにinsertできますが、 「 $sql = mysql_query("insert into table1 (item_code, addr) values('$mail[item_code]', '$mail[addr]')", $con); 」 下記のように書き加えたらうまくtable2からデータをとって、table1にinsertできません。 書き方が間違っていると思いますが、どなたか教えて頂けませんでしょうか。 「 $sql = mysql_query("insert all into table1 (item_code, addr) values('$mail[item_code]', '$mail[addr]') into t_table1 (maker, maker_name) select maker, maker_name from table2 order by goods_code limit 1", $con); 」 よろしくお願い致します。
ACCESSVBAで既存のクエリの日付フィールドの書式をyyyymmに変更したいですが、 コードをどう書けばいいですか？ クエリ：Q01_2_実績準備 フィールド：完了予定日（yyyy/mm/dd） 希望：完了予定日（yyyy/mm/dd）→完了予定日（yyyymm）にしたいです。 宜しくお願いします。
以下のようなテーブルがあります。 組織名/コード/備考 本社/000/ 経理部/000000/ 経理担当/000000000/ 人事総務部/000001/ 人事総務担当/000001000/ マーケティング部/000002/ マーケティング担当/000002000/ システムソリューション事業部/001/ 第一ソリューション部/001000/ 企画担当/001000000/ 営業担当/001000001/ 開発担当/001000002/ 第二ソリューション部/001001/ 企画担当/001001000/ 営業担当/001001001/ 開発担当/001001002/ 上記テーブルの「コード」は、３桁で階層を表すものとなります。 以下のような組織構造となります。 本社-経理部-経理担当 システムソリューション事業部-第一ソリューション部-企画担当 システムソリューション事業部-第一ソリューション部-営業担当 システムソリューション事業部-第一ソリューション部-開発担当 上記テーブルの「備考」欄に、「順番」を与えることによって、順番によって、「コード」を振り直したい場合、どのようにSQLを記載したらよいでしょうか？ 組織階層の親子関係は、そのまま保持したく、以下のように、「順番を指定」した結果が、「SQL実行結果」になる必要があります。 ＜順番を指定＞ 組織名/コード/備考 本社/000/1 経理部/000000/11 経理担当/000000000/12 人事総務部/000001/2 人事総務担当/000001000/3 マーケティング部/000002/9 マーケティング担当/000002000/10 システムソリューション事業部/001/4 第一ソリューション部/001000/5 企画担当/001000000/8 営業担当/001000001/6 開発担当/001000002/7 第二ソリューション部/001001/13 企画担当/001001000/16 営業担当/001001001/15 開発担当/001001002/14 ＜SQL実行結果＞ 組織名/コード/備考 本社/000/1 人事総務部/000000/2 人事総務担当/000000000/3 マーケティング部/000001/9 マーケティング担当/000001000/10 経理部/000002/11 経理担当/000002000/12 システムソリューション事業部/001/4 第一ソリューション部/001000/5 営業担当/001000000/6 開発担当/001000001/7 企画担当/001000002/8 第二ソリューション部/001001/13 開発担当/001001000/14 営業担当/001001001/15 企画担当/001001002/16
MySQL内の画像のタイトルを変更して、さらに圧縮したいです。MySQLにはパスしか載っていないのか、そしてそのパスを変更するのでしょうか？
データベースの利用者または詳しい方にアドバイスをお聞きしたいです。 ７０人前後の規模の会社で申請書類などのペーパーレス化を目的で サイボウズやファイルメーカーで開発したデータベースキットなど導入しようかと検討しています。 が、しかし 下記のチームスピリットというものは正直どうでしょうか？ https://www.teamspirit.co.jp 手元に全く情報がないため比較が出来ません。 参考になるチームスピリットの情報や比較、使用されている方の感想など教えて頂ければ幸いです。 よろしくお願い致します。
フィールドに数式セットをしようとして以下のように書きましたが 「データベースまたはオブジェクトは読み取り専用なので、更新できません」との エラーが出ます。アクセスは初心者なので宜しくお願いします。 Dim db As DAO.Database Dim rst As DAO.Recordset Set db = CurrentDb Set rst = db.OpenRecordset("Q02_5_見込み案件数") Q02_5_見込み案件数はクエリ With rst Do Until .EOF .Edit　　　　　→ここで上記のエラーが発生します。 !件数 = !件数 * Me.SP予測掛け率 .Update .MoveNext Loop .Close End With
Microsoft AccessはAndroidには対応していないようが、何らかの方法で、Accessで作成したデータベースに対して閲覧や更新等をすることは可能でしょうか。 家計等の個人的なデータを管理するのに、Access2016を導入しようと思っています。 最初の構築はWindowsで実施し、日々の更新や閲覧はAndroidからも出来るようだと理想的なのですが。 もし、不可能な場合、他に上記の用途に有用なソフト等がありましたら、ご紹介頂けると有り難いです。
Amazonが提供している Aurora ですが、読み方を教えてください （アウロラ、オーロラ、その他、）
タイトルと本文だけを投稿するブログのようなものを練習として作っています。そこで分からないことがあります。 投稿フォームよりタイトルと本文を投稿して、index.php に一覧(記事のタイトル)を表示させています。そして、一覧のそれぞれの記事タイトルより、個別記事にリンクしたいと思いますが、リンク先の個別記事のデータをSELECTする方法が分かりません。 ・記事のテーブル名: post ・カラム no / title / content index.php(一覧) から article.php(個別記事)へ urlに 記事のnoを加えてリンクさせています。そして、article.php のurlの記事noを where句に指定して、記事を表示したいと考えています。 しかし、where句をどのように書けばよいのかが分かりません。例えば、記事noが　12　である場合、　/article.php?no=12 とリンクされてきた時に、どのように 12 を取得してwhere句で指定するのかが分かりません。 ↓　この文の? の部分をどのようにすればよいのか教えてください。 $st = $dbh->query("SELECT * FROM post WHERE no=?");
下記の実行すると、エラーが表示され LIMIT 0,50を外すとエラーにはならず、結果が表示されます。 ただ、一度に全件が表示されるのでLIMITで表示させる件数を制御したいと思っていますが、 なぜかエラーになっています。どこが間違っているのでしょうか？ $query = "select * from tableA ta left join tableB tb on ta.id = tb.id left join tableC tc cf on tb.id = tc.id left join tableD td on tb.id = td.id where tb.aaa != ''"; $xdays = (isset($days) and $days !== "")?$days:null; $xmn =(isset($mn) and $mn !== "")?$mn:null; $xfp =(isset($fp) and $fp !== "")?$fp:null; $xre =(isset($re) and $re !== "")?$re:null; if(is_null($xdays) and is_null($xmn) and is_null($xfp) and is_null($xre)){ $query .= " and 0"; }else{ if(!is_null($xdays))$query .=" and tb.day='" .$xdays ."'"; if(!is_null($xmn))$query .=" and tb.mn = '" .$xmn ."'"; if(!is_null($xfp))$query .=" and tb.fp='" .$xfp ."'"; if(!is_null($xre))$query .=" and tb.re='" .$xre ."'"; } $query .=" order by tb.day DESC,tb.jikan limit 0,50; エラー： empty: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'and tb.fp='4'' at line 20 以前の質問 https://oshiete.goo.ne.jp/qa/9061230.html を参考に、修正している状況で、LIMITのエラー？になって困っています。
数量ごとに単価等が異なるものがあります。 発注する数量により、どの単価で発注するのか抽出したいのですが、どのようにすれば抽出出来るかわかりません。ご教授お願いします。 数量は～までの数量設定となっております。 【テーブル】 発注数量 1 2 7 【単価デーブル】 数量 単価 1 2000 5 1000 10 750 20 500 【抽出結果】 発注数量 単価 1 2000 2 1000 7 750 例えば、 1個発注するのであれば、2000を抽出 2個発注するのであれば、1000を抽出 7個発注するのであれば、750を抽出したい。
PHP5.5でMySQLに　PDOでデータベースに接続しています。 他にも、Zend_DB や　PEAR::MDB2 , などのライブラリがありますが、大規模なサイトになった場合での処理速度を重視すると、どの接続方法がベストでしょうか?
初心者です。一度似た質問をさせていただきましたが、再度整理しましたので、質問に答えて頂けたら幸いです。 下記のm_magazine（DBのテーブル名）の中にそれぞれの月のmagazine_id(1、2、3…と番号順に登録してあります。)と月刊のurl、タイトルであるmagazine_titleなどのカラムを収納させてあります。 生成させた今月号の月刊ページには来月号のリンクと先月号のリンクを自動的に取得させたいのですが、下記のように書くと、最新号は次のようになってしまします。 「 次の月刊へ：2016年2月号　○○○　　前の月刊へ：2016年1月号　○○○ 次の月刊へ：2016年3月号　○○○　　前の月刊へ：2016年2月号　○○○ 次の月刊へ：2016年4月号　○○○　　前の月刊へ：2016年3月号　○○○ 」 つまり、最新号には過去の全部の「次の月刊へ」と「前の月刊へ」が全部出てしまいます。 次に新しい号は「次の月刊へ：2016年4月号　○○○　　前の月刊へ：2016年3月号　○○○」は出ずに、あとは全部出てしまいます。最も古い号は逆に何も出ません。 どなたか教えて頂けませんでしょうか。よろしくお願い致します。 ◆DB仕様 「 -- Table "m_magazine" DDL CREATE TABLE `m_magazine` ( `magazine_id` int(11) NOT NULL COMMENT '月刊ID', `url` varchar(256) DEFAULT NULL COMMENT 'URL', ` magazine_datetitle` varchar(256) DEFAULT NULL COMMENT '月刊年月タイトル', `magazine_title` varchar(256) DEFAULT NULL COMMENT '月刊タイトル', `is_deleted` char(1) NOT NULL COMMENT '削除フラグ（y, n）', PRIMARY KEY (`magazine_id`), KEY `is_deleted` (`is_deleted`), KEY `create_staff_id` (`create_staff_id`), KEY `modify_staff_id` (`modify_staff_id`), CONSTRAINT `m_magazine_ibfk_1` FOREIGN KEY (`create_staff_id`) REFERENCES `m_staff` (`staff_id`), CONSTRAINT `m_magazine_ibfk_2` FOREIGN KEY (`modify_staff_id`) REFERENCES `m_staff` (`staff_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='月刊管理マスタ'; 」 ◆生成に使っているPHPファイル 「 $currentid = $h['magazine_id']; $sql2 = "select distinct url, magazine_datetitle, magazine_title from m_magazine where magazine_id = (select min(magazine_id) from m_magazine where magazine_id > '$currentid' order by magazine_id desc limit 1)"; $sql3 = "select distinct url, magazine_datetitle, magazine_title from m_magazine where magazine_id = (select max(magazine_id) from m_magazine where magazine_id < '$currentid' order by magazine_id desc limit 1)"; $ret2 = f_db_select($sql2, $h['url'], $h['magazine_datetitle'], $h['magazine_title']); $ret3 = f_db_select($sql3, $h['url'], $h['magazine_datetitle'], $h['magazine_title']); foreach ($ret2 as $h2) { $nexturl = f_db_select($h2['url']); $nextdatetitle = f_db_select($h2['magazine_datetitle']); $nexttitle = f_db_select($h2['magazine_title']); } foreach ($ret3 as $h3) { $prevurl = f_db_select($h3['url']); $prevdatetitle = f_db_select($h3['magazine_datetitle']); $prevtitle = f_db_select($h3['magazine_title']); $wkbuff .= <<<EOF <p> 次の月刊へ：<a href ="{$h2['url']}">{$h2['magazine_datetitle']}　{$h2['magazine_title']}</a><br/> 前の月刊へ：<a href ="{$h3['url']}">{$h3['magazine_datetitle']}　{$h3['magazine_title']}</a> </p> EOF; 」
Is Modded: Definitely; Client brand changed to 'fml,forge' Type: Client (map_client.txt) Resource Packs: [] Current Language: 日本語 (日本) Profiler Position: N/A (disabled) Vec3 Pool Size: 0 (0 bytes; 0 MB) allocated, 0 (0 bytes; 0 MB) used Anisotropic Filtering: Off (1) OptiFine Version: OptiFine_1.7.10_HD_D1 Render Distance Chunks: 12 Mipmaps: 4 Anisotropic Filtering: 1 Antialiasing: 0 Multitexture: false OpenGlVersion: 4.5.0 NVIDIA 361.43 OpenGlRenderer: GeForce GTX 960/PCIe/SSE2 OpenGlVendor: NVIDIA Corporation CpuCount: 4
1つのテーブル内に［種別］と［金額］というフィールドがあり、［種別］内Aの［金額］とBの［金額］を足した金額を出力するにはどうしたらよいでしょうか。 ■テーブル 種別｜金額 A ｜50 B ｜100 C ｜200 A ｜400 ■結果 550
SQLの処理速度があまりに遅い（最悪1分以上かかる）ので わかる方がいらっしゃいましたらアドバイスをお願いいたします MySQL４になります----------------------- -- 問題SQL SELECT COUNT(*) as count FROM ( SELECT id, word FROM ( SELECT distinct tbl.id, p.word FROM table01 tbl INNER JOIN table02 p ON p.id = tbl.id WHERE keyword LIKE 'a%' UNION SELECT distinct tbl.id, p.word FROM table11 tbl INNER JOIN table12 p ON p.id = tbl.id WHERE keyword LIKE 'a%' ) test1 UNION SELECT id, word FROM ( SELECT distinct tbl.id, p.word FROM table21 tbl INNER JOIN table22 p ON p.id = tbl.id WHERE keyword LIKE 'a%' UNION SELECT distinct tbl.id, p.word FROM table31 tbl INNER JOIN table32 p ON p.id = tbl.id WHERE keyword LIKE 'a%' UNION SELECT distinct tbl.id, p.word FROM table41 tbl INNER JOIN table42 p ON p.id = tbl.id WHERE keyword LIKE 'a%' UNION SELECT distinct tbl.id, p.word FROM table51 tbl INNER JOIN table52 p ON p.id = tbl.id WHERE keyword LIKE 'a%' ) test2 GROUP BY word ) A ---------------------- 既存のテーブルが、table01～table51（各テーブルに付随するサブテーブルでtable02～table52がある感じ）まであり その各テーブル内に存在しているカラムkeyword（varcharで NOT NULL、indexは張ってある）の一文字だけを指定し検索結果の件数を取得したいのですが 速度があまりに遅く、悩んでおります。 2文字以上だと若干重いかなという感じがするだけです (実際のSQLはもっとごちゃごちゃしており、見やすくするため不必要なカラム等削除しております) table01は51万レコード、table11は、175万レコードあります。 （その他は1万レコード程度です） そもそもこの件数をLIKE検索で行っていること自体、おかしいのですが もうどうしようもないので、このSQLをなんとか修正したいと考えております 目標としては、 この旧SQLと新SQLで取得した件数が同じになり、かつ速度が上がることにあります 「 ) test2 group by word 」については、table21～table51で重複するwordを削除したいという意向があり、ついております （table01とtable11と一緒にunionして、group byしたくないです） 私のほうで修正・実行した方法は、 １）SELECT count(*) as count from を SELECT count(id) as count from と*を止める指定する ２）test1とtest2内のSELECTで取得するカラムを最小限にする（上記のものはかなり少なくしてあり、もうこれ以上減らせません…） ３）test1内のSQLでtable01、table11をunionしているところを、分割する ↓こんな感じに分割 SELECT count(id) as count from ( select id, word from ( SELECT distinct tbl.id, p.word FROM table01 tbl INNER JOIN table02 p ON p.id = tbl.id WHERE keyword LIKE 'a%' ) test1 union select id, word from ( SELECT distinct tbl.id, p.word FROM table11 tbl INNER JOIN table12 p ON p.id = tbl.id WHERE keyword LIKE 'a%' ) test２ union select id, word from ( ・ ・ ・ となります。 一応、６０秒程度掛かっていたものが、5～20秒程度で帰ってくるようにはなりましたが まだまだ実用には耐えられない状況です もしまだ改善すべき箇所等ございましたらアドバイスをおねがいいたします よろしくお願いいたします
Access 2007 (+VB 2013) で動作させるプログラムを作っています。 []で囲んだ項目はNot Null制約 tableA [ID] [Name] 1 大野 2 池田 3 渡邊 … tableB [ID] [subID] [ImagePath] ※ 1 1 c:\Image001.jpg (日付Ａ) 1 2 c:\Image002.jpg (日付Ｂ) 1 3 c:\Image003.jpg (日付Ｃ) 3 1 c:\Image031.jpg {Null} 注 tableB に　池田さんのデータは無し 注 (日付Ａ)は仕様上でこの日より前の日付は指定できないこととする。(NULL でできるのであればNULL) のようなテーブルがあり、 tableA と tableB は IDで外部結合してるとします。 その時、 大野さんのある指定した日付のImagePathを取りたいとします。 (もちろん、最終的には3人とも。人が増えれば全員対象) それでその日付の対象を (1)　日付　が　日付A <= 日付 <日付B (2) 日付　が　日付B <= 日付 <日付C (3) 日付　が　日付C <= 日付 (4)　Null の値がセットされている場合は、日付に関係なく一律 (5) もともとない人に対してはかえってこない に対するImagePathを取得したいのですが、 ※の列を　期間の始点とするべきか終点とするべきかも含めて 良いSQLの組み方を教えていただければと思います。 Access2007という環境が維持できればもっと根本から変えた設計でもかまいません。 よろしくお願いします。
クエリで抽出したレコードの特定のフィールドの値が、1000以下ならAA.xlsを、1001以上ならAA.xlsとBB.xlsの両方をを印刷、クエリでの抽出数がゼロの場合は、何も印刷しないとする事はできるのでしょうか？ ご教示お願いします。
いつもお世話になります。 Ａｃｃｅｓｓ２０１０でＡ４両面印刷するレポートの設定方法のご教授 または同設定方法が記載されているＷｅｂサイトのご紹介をお願いします。
昨日、急にスマホのなかのアルバム写真が全消しされて、スクショも撮れなくなって、lineでは自分を含む全員のプロフィール画像、タイムライン画像がみれなくなりました、容量はあります カメラでは送り先をSDにすればできますが、本体だとエラーとなります 皆さんわかるひとお願いします
以下の内容の追加質問です。 http://oshiete.goo.ne.jp/qa/9224819.html ご回答いただいた内容でデータの抽出がうまくできましたが、実はもう一つの悩みがあります。 テーブルT1とT2の列は可変です。 ユーザーの操作によって、列の添削ができますので、列を変数にしてさらに前回の回答に列の代わりに変数を使ってデータの抽出ができないでしょうか。 どうぞご教授をお願いします。
SQLのクエリ、又はプロシージャで以下のことを実現したいです。 ●前提 　テーブルT1とテーブルT2に、変更前のレコードと変更後のレコードがあります。 　仮にT1に次の列があります。しかも、列はユーザーによって添削できますので、列は可変。 　BusinessName　Item1　Item2　Item3 　取引先A　　　　　A1　　　A2　　A3 　取引先B　　　　　B1　　　B2　　B3 　 　同じく、仮にT2に次の列があります。しかも、列はユーザーによって添削できますので、列は可変。 　BusinessName　Item1　Item2　Item3 　取引先A　　　　　A1　　　A4　　A3 　取引先B　　　　　B4　　　B2　　B5 ●以下の結果を抽出したいです。 　新しいテーブルT3を作成して結果をT3に格納。 　BusinessName　PreData　AfterData 　取引先A　　　　　A2　　　　A4　　 　取引先B　　　　　B1　　　　B4　　 　取引先B　　　　　B3　　　　B5 プロシージャの初心者なので、どうか助けてください。
SELECT SUM() AS FROM GROUP BYにて商品の合計個数と重量を集計しています。 賞味期限のデータがyyyy-mm-ddで登録されているのですが、これをyyyy-mmで集計するにはどうしたら良いでしょうか？ 下の画像のように左が現状の状態で、それを右のような状態(賞味期限をyyyy-mmにして商品の個数と重量と賞味期限のyyyy-mmの月ごとで集計したい。)にしたいです。 因みに左の方のSQL文は以下で集計しています。 SELECT syoumi, syouhin,SUM(kosu) AS gokei_kosu,SUM(jyuryo) AS gokei_jyuryo FROM storage GROUP BY syoumi どなたかご教示頂きますようお願い致します。
初めてOracle 11gを使用して以下の形の DBから値を取得したいと思っています。 ユーザを絞って１項目だけなら取得することはできたのですが、 複数項目になると取得する方法が思いつきませんでした。 DB(貸出テーブル)は以下の８カラムを持っています。 ユーザID、レンタル開始年月、レンタル終了年月、アクション、ドキュメント、アニメ、洋画、邦画 （アクション、ドキュメント、アニメ、洋画、邦画カラムはboolean型です） （ジャンルには優先順位があり（１洋画＞２邦画＞３アクション＞４ドキュメント＞５アニメ）） 複数のジャンルがtrueになっていても、優先順位の高いもののみ、取得をしたいです。 例えば以下の様なレコードがある場合、 A0001,201601,201602,true,false,false,false,false A0001,201510,201512,false,false,true,false,false A0002,201512,201601,true,true,false,false,false A0003,201512,201602,false,true,true,false,false A0003,201509,201510,false,true,false,true,false A0004,201512,201602,false,false,false,true,false 取得したい結果は、ユーザ毎の直近のレンタル終了日のもので、且つジャンルの優先順位が高いものを 以下の様に表示をしたいです。 A0001,アクション A0002,アクション A0003,ドキュメント A0004,洋画 色々とやってみたのですが、別のカラムにあるものを 最終的にどのように表示するかがわからず悩んでします。 わかりずらい説明で申し訳ございませんが、教えてください。 よろしくお願いいたします。
以下の表1、2の比較を考えております。 表１ 表2 A社 A社 A社 B社 B社 B社 B社 C社 C社 D社 C社 D社 E社 表2の中で表1に該当するレコードだけ出力したいと考えております。 Ｑ１、クエリの設定方法の流れを教えていただけますでしょうか。 また出力結果は以下を想定しています。 クエリ A社 B社 B社 C社 自分でやっているのですが、なかなかうまくいきません。 すみませんが、宜しくお願い致します。
同じMdbファイルをAccess2000の入ったPC・Access2010の入ったPC・Access2013の入ったPCで使用する必要があります。 オリジナルはAccess2000で作成したもので、通常であればAccess2010・Access2013でも使用できるはず・・・ しかし、Access2010・Access2013で開くとVBAのコンパイルエラーがでます。 そこで、Access2010でエラーのでたVBAの部分を削除して新たに書き直すとAccess2010では正常に動きます。 しかしながら、Access2000とAccess2013では同じようにエラーがでます。 Access2013で修正した場合はAccess2013でのみ正常に動き、Access2000とAccess2010ではエラーがでます。 つまり、作成したものと同じバージョンのAccessでないと正常に動かないということです。 次にエラーのでる部分に注目してみると、フォームのフィールド名がリンク元のテーブルのフィールド名（レコードソース）と異なっている部分に書いてあるVBAのところでした。 --------------------------------------------------------------------------------------------- テーブル（出荷予定） ID　入力日　製品名　得意先　出荷日　備考 フォーム（出荷予定入力） ID　入力日　製品名　得意先　出荷予定日　備考 ---------------------------------------------------------------------------------------------- このようにテーブルとそれに入力するためのフォームがあるのですが、フォームの”出荷予定日”に過去日付の場合エラーメッセージが出るようにVBAを書いています。 （厳密には、これはサブフォームで別のフォームに埋め込んであるのですが・・） ---------------------------------------------------------------------------------------------- Private Sub 出荷予定日_AfterUpdate() If CDate(出荷予定日) < CDate(Format(Now, "yyyy/MM/dd")) Then '過去日付 If MsgBox("過去日付です。よろしいですか？", vbOKCancel) = vbCancel Then 出荷予定日 = "" 出荷予定日.SetFocus Exit Sub End If End If End Sub ----------------------------------------------------------------------------------------------- こんな感じです。同様に”入力日”にも同じVBAを書いているのですが、こちらではエラーは起きません。 確認のためフォームのフィールド名、”出荷予定日”をテーブルと同じ”出荷日”に変えてみるとエラーは起きなくなりました。 しかし運用上、フォームのフィールド名は”出荷予定日”としたいです。また、フォームはフォームビューではなくデータシートビューを使用したいです。 従って、フォーム名がそのままフォーム上に表示されることになります。テーブルのフィールド名も他との関係があるので変更はできません。 どのようにVBAを書けばいいのか、解決法をご教授いただけませんでしょうか。 もしくはデーターシートビューにおいて、フォームのフィールド名ではなく任意の名前を表示せせる方法があればフォームのフィールド名をテーブルのフィールド名に合わせることができるので、こちらでも解決できそうなのですが・・ 何卒、よろしくお願いいたします。
Oracle DBに接続できなくなりました。 本日Oracle DBを問題なく利用していたのですが、 途中で勝手に落ちてしまい、再度ログインしようとすると ログインできなくなってしまいました。 接続ツールはCSEを利用しており、 ログインしようとすると以下エラーとなります。 エラー内容：データベース接続時にエラーが発生しました DBエラー詳細：エラーコード1017 ユーザ名/パスワードが無効です。ログオンは拒否されました。 こちらはパスワードもユーザ名も変更しておりません。 また、ODBCデータソースアドミニストレータにて接続テストを実施すると、 SQLState 2800エラーが出ます。 特にパスワード間違いを繰り返したわけでもなく、 それまで正常に利用できていたので、何故ログインできなくなったのか不明です。 どなたか解決策が分かる方がいらっしゃいましたら、 お手数ですが教えていただけると有難いです。 よろしくお願いいたします。
webサーバ（webサーバ1台、DBサーバ1台構成）をDMZに設置して外部からアクセスさせる場合、 通常DBサーバはDMZに置かずにLAN側に配置するべきなのでしょうか？
vpsでデータベースを利用する際、MYSQLとPostgresqlに分けたほうが性能が出るかどうか教えて下さい。 VPSでWEBサービスを構築しようと思っています。 言語はPHPです。 VPSにはMYSQLとPostgresqlが付いています。 通常用のデータをMYSQLに置いて、分析用の参照データをPostgresqlに置いたら、MYSQLだけにアクセスが偏らずVPSの性能を生かせるのではないかと考えました。 MYSQLのデータを割りと大量のデータをスクレイピングしようかと思っています。 Postgresqlのデータは、MYSQLのデータの中で必要な物だけコピーして、1日に一回集計クエリを実行して、参照します。 突っ込みどころが多いと思いますが教えて下さい。 どうぞよろしくお願いします。
Access初心者です。Access2010を使用しています。 既存の個人用に作られたAccessシステムをネットワークドライブに移し共有しようとしています。 それに伴いテーブル分割して、バックエンドDBにしました。 既存機能でVBAからExcel2010ブックをインポートしているのですが、DoCmd.TransferSpreadsheet の処理はエラーとはならないもののテーブルが更新されません。 msdnのTransferSpreadsheetの解説に「カレントデータベースに対すメッソッド」と書かれているので、バックエンドDBはカレント扱いされないのかも？っと思っています。 これってやっぱり出来ないものなのでしょうか？ TransferSpreadsheetの記述でデータベースをしていするなどで解決できるのでしたら書き方を教えて下さい。 宜しくお願いします。
terapadの折り返しを設定しました。今まで上手く行っていたのですが、 指定した文字数が反映されません。 オプション→表示→桁　35　OKにしたのですが35文字の約半分の17文字で 折り返されてしまいます。 表示→全角空白　にもチェックが入っています。 指定した文字の半分で改行されているので、 指定した文字できちっと折り返すにはどうしたらいいでしょうか？
リボンを非表示にするショートカットキーとかは無いのでしょうか。 有ったら教えて下さい。 宜しくお願いします。
今家計簿のデーターベースをAccess2013 vbaで作成中で Aテーブルに ・日付 ・入金元ID ・入金 ・出金 ・出金先ID ・摘要 ・備考 とあり、これを口座と財布の情報を全部入れようと思います。 そして、例えば、口座から10000円引き出した時 それをどうやって財布の中に入れるのか・・・そのやり方を教えてほしいです。 これだけで聞くのも申し訳ないのですが、まだ、イメージが湧いていませんので。
Windows7でAccess2007を使っています。テーブル内に日付が西暦と和暦 の二つが有り、通常は西暦で入力をします。然し、表示には西暦と和暦 を出したいのですが。変換が分かりません。 テーブル内には入力の西暦しか無く、表示の前に更新クエリーで西暦の フィールドを読んで和暦のフィールドを更新したいのですが。簡単に出 来る方法は無いのでしょうか。 宜しく、お願いします。
いつも大変参考にさせてもらっています。 いま添付画像のようなテーブルを結合し、その中で計算した結果を列追加して表示しています。 単純にこの方法だと端数が切り捨てられてしまうので赤字部分を合算しても 元の金額「121841」と一致しません。 そこで親フラグに「１」がたっているものにおいては端数分を含めた値にしたいと考えているのですが、どのようなクエリにすればよろしいのでしょうか。 （利率78.9%の行は「121841-（1827+23880）」で求めた値としたい） アドバイスのほどよろしくお願いいたします。
[] の記号の意味を教えてください。
create table table1 (漢字 text(2)); insert into table1 (漢字) values('あ'); insert into table1 (漢字) values('ア'); この状態で、 SELECT table1.漢字 FROM table1 WHERE (((table1.漢字)="あ")); 上記を実行すると、結果として あ ア 上記の二通りの回答が出る。 これを、「あ」のみにしたい。 どうすれば良いのでしょうか。 方法を教えて下さい。 宜しくお願いします。
久々データベースを触っているのですが、Primary KeyのようにAutoIncrementするフィールドにPrefixを付たいのですがどのようにすれば良いのでしょうか？ http://detail.chiebukuro.yahoo.co.jp/qa/question … このページで言っているように、プログラム側でPrefixを付け、それをTransactionを使って、CharFieldに入れるしかないのかなとも思いましたが。 もしMySQLやMariaDB、PostgreSQLなどにそのようなPrefixを付けて自動でインクリメント出来る機能があれば教えて欲しいと思います。 宜しくおねがいします。
テーブルのデータには小数点以下が第二位まで入力してあるのですが、なぜかフォームでは小数点以下が切り捨てられてしまいます（5.24 → 5.00など）。 現在、テーブルのデータ型は数値型、フィールドサイズは倍精度浮動小数点型、書式は固定、表示桁数は２、フォームの書式は標準となっています。 表示方法をご存知の方、よろしくお願いいたします。 win10、access2010
製品情報を管理するデータベースを作成する中での質問です。お願いします。 ・製品ID ・製品名 ・製品型番 ・製品色 等、製品に関する情報をデータベースに登録しています。 登録したデータ一覧から、1つの製品IDを選択すると、その製品IDの情報すべてがフォームに表示され、編集と削除ができます。 そのフォーム上にもう一つボタンを追加し、表示された製品情報の一部を編集して、上書き(更新)ではなく、新規製品として新しいIDで登録する機能をつけました。（似たような製品を登録する時に、すべて一から入力するのは手間なので、似たような製品の情報を利用して新規登録する、といった具体） 追加クエリを使用します。 その追加クエリは、問題なく動作しています。 ただ、追加クエリでデータを追加後、そのフォームを閉じようとすると、元の製品IDのデータが編集途中なのにフォームを閉じるの？とみなされてしまうようで、毎回「このレコードは保存できません」とエラーメッセージが出ます。 このエラーメッセージを出したくないのですが、どこを直せばよいでしょうか？ よろしくお願いいたします。
配列にデータが連続で入っている。飛び飛びにはなっていない。 データは配列に必ずに順番に入っている。 この時に最後のデータの要素の配列の番号を知りたい。 配列の要素に関しては、データの数が分からないので多めに取ってはある。 こう言うのは例えばperlの言語に於いては、簡単に$#配列の名前で分かりますが。 access2007のvbaではこれと似た様な事は出来るのでしょうか。 例えば、下記のコードでaの配列の要素の数を知りたい時に、 配列の数を100と返すのでは無く、きちんとここでは3を返す様な関数 と言うのはあるのでしょうか。 Dim a(100) As String a(0) = "4555" a(1) = "3333" a(2) = "eee" 宜しくお願いします。
請求書の管理をAccess2013でしようとしています。請求書をレポートで作成するところまでは出来たのですが、およそ100件の得意先に請求書をPDFで送付しなくてはなりません。 これを自動化したいと思い、様々なサイトを見たのですが、当方はずかしながらVBA知識がなく、自分のデータ用にコードを書き換えることができません。 今編集しようとしているコードは下記のとおりです。 Private Sub コマンド24_Click() Dim strReportName As String Dim strPath As String Dim strFileName As String '対象のレポート名 strReportName = "excelインポート" '出力先のフォルダ名 strPath = "D:\Users\08161\Desktop\請求書作成\PDF" '出力するPDFのファイル名 strFileName = strPath & "\" & Format(Date, "yyyy" & "mm" & "dd") DoCmd.OpenReport strReportName, acViewPreview If MsgBox("レポートをPDF化しますか？", vbYesNo) = vbYes Then If Dir(strFileName & ".pdf") = "" Then DoCmd.SetWarnings False DoCmd.OutputTo acOutputReport, strReportName, acFormatXLS, strFileName & ".pdf", True DoCmd.SetWarnings True Else If MsgBox("同じ名前のファイルがあります。上書きしますか", vbYesNo) = vbYes Then DoCmd.SetWarnings False DoCmd.OutputTo acOutputReport, strReportName, acFormatXLS, strFileName & ".pdf", True DoCmd.SetWarnings True Else DoCmd.Close acReport, strReportName Exit Sub End If End If End If DoCmd.Close acReport, strReportName End Sub 上記のコードだと、ファイル名が日付になってしまうのを、「excelインポート」という名前のテーブルにある「お名前」+"様_"と「特集」というフィールドの名前をつなげたファイル名にしたいです。 Ex)山田花子様_花特集 また、上記のままのコードを実行すると、確かにPDFファイルは任意の場所にできるのですが、 開こうとすると「サポートしてないか壊れているかデコードできてない」というエラーが表示されて開くことができません。 そしてPDFは1つしかできません。単票形式で100Pあるレポートを100個のPDFにしたいです。 どうか、どうか御教授お願いいたします…。
テーブルで、id,useid,date,extext という項目があり、idにプライマリーキー、userid、dateにインデックスとユニークキーを設定しています。 自宅のパソコンでやると、問題なくデータが追加できるのですが、今使っているパソコンからだと ユニークキーを設定すると、重複データが追加できなくなりました。 データのサンプル　は　id=1,userid=1,date=2014-1-1,extext="aaaaa"(一つ目は追加できます。） id=2,userid=1,date=2014-1-2,extext="bbbbb"（#1062 - Duplicate entry '1' for key 'userid_2'というエラーがでます。）
マイクロソフトのアクセス　データベース　エンジン　2010　を間違って、アンインストールしてしまいました。インストールキーがわからないのですが、再インストールする方法を教えてください。 インストールキーがわからなければ、再インストール不可能ならば、新たに、インストールする方法を教えてください。よろしくお願いします。
下記のsqlでテーブルとデータを用意する。 create table 収穫 (登録日 date,番号 int,容量 text(1)); insert into 収穫 values ('160201',1,'s'),('160201',2,'m'),('160202',3,'m'),('160203',4,'s'); 容量はs,m,lの3種類がある。然し、データとしては全てがそろうとは限らないとする。 前持ってデータを決め打ちが出来ないので出カのテーブルは全てを用意をすると create table クロス集計 as select 登録日 ,sum(case 容量 when 's' then 1 else 0 end) as s ,sum(case 容量 when 'm' then 1 else 0 end) as m ,sum(case 容量 when 'l' then 1 else 0 end) as l ,count(*) as 合計 from 収穫 group by 登録日 ; 上記を実行すると確かにクロス集計のテーブルは出来ますが。然し、今回の様に必ずしも列見出しが3個とは限りません。若しも、これが大量に増えた場合は非常にsqlを組み立てるのがめんどうになります。また、見た目にもデータが全く無いのにも関わらずに列見出しとしては存在をしますので。 非常に煩わしくなります。こう言う事が有る為に、この問題を避けるために別のプログラムで予めそのデータが有るのかをチェックしてsqlを作っていますが。 この様な方法(この場合は、プログラムでデータが有るのかをチェックしてsqlを組み立てると言う方法) 以外にmysqlでのsqlの記述が有るのでしょうか。 有ったら教えて欲しいのですが。若しも、無ければ従来の方法で出すだけですが。 宜しくお願いします。
create table table1(id int,合計 int,目標 int,実績 double); とした時に、実績を一発で出したい。 実績は、(過去の合計の累計/過去の目標の累計) * 100で求める。 例えば例として下記の様になります。 id 合計 合計の累計 目標 目標の累計 実績 1 2 2 3 3 66.67 2 1 3 3 6 50.00 3 1 4 3 9 44.44 4 2 6 3 12 50.00 5 1 7 3 15 46.67 6 1 8 3 18 44.44 7 2 10 3 21 47.62 現在は、一発では出来ないので個々に個別で求めています。 1. 合計の累計を出す 2. 目標の累計を出す 3. 実績を出す ここでは、実績だけあれば良いので合計の累計とか目標の累計も本来は 不要ですが。実績の出し方が分からないのでテーブルにフィールドを入 れています。 これをテーブルに一括してidと合計と目標だけで実績を保存をすると言 う事は出来るのでしょうか。 宜しく回答をお願いします。
教えてください。 Windows Server 2007 SP2 SQL Server 2008 R2 PHP 5.5.10 PHPからSQLServerに接続したいのですが、 設定してもうまく動きません。 UID、PWDは、どこの設定でいれたユーザー名・パスワードですか？ ユーザー名・パスワードに SQLServerのインストール時にいれたSQLServerシステム管理者を 入力すると CSEでODBC接続できました。 このSQLServerシステム管理者の ユーザー名・パスワードで動くはずなんでしょうか？ それとも別の設定が間違っているのでしょうか？ 【 sqlsrv_connect関数の場合】 $serverName = "srv01"; $connectionInfo = array("UID"=>"sa", "PWD"=>"testtest", "Database"=>"testdb"); $conn = sqlsrv_connect($serverName, $connectionInfo); 【PDOの場合】 $serverName = 'srv01'; $database = 'testdb'; $uid = 'sa'; $pwd = 'testtest'; $conn = new PDO( "sqlsrv:server=$serverName;Database=$database", $uid, $pwd); 教えてください。 よろしくお願いします。
$sql='INSERT INTO extra(id,userid,exid,date,extext) values(null,?,?,?,?)'; $stmt=$dbh->prepare($sql); $flag=$stmt->execute(array($placeholders[':userid'],$placeholders[':exid'],$placeholders[':date'],$placeholders[':extext'])); if($flag){ print('データの追加に成功しました。'); }else{ print('データの追加に失敗しました。'); } } 上記の文で、インサートを行うと初めの一つのデータだけはインサートできますが、その後は全く追加できません。idがプライマリーキーで、autoincrementをしているのですが、自動入力の際には 引数をnullにすると自動でインクリメントしてくれると書いてありました。
実は、perlでmysqlを起動してsourceコマンドを実行したかったのですが。エラーになります。 mysql単体では、sourceコマンドは正常に動きます。 その為に、perlは切り離してmysql単体で動かしたいのですが。ここではどうしても パスワードを聞いてきます。どうしても自動化をしたいので。ここでは、mysqlのログイン を自動化をしたいのですが。方法が分かりません。windows7でmysqlを使っています。 済みません。方法を教えて下さい。
例えば下A表とB表があるとします。 A表　　　　　　　　　　　　　　　　　　　表B No 住所　　　　　　　　　　　　　　　　　市区　　ランク １　神奈川県川崎市宮前１−１−１　　　　　　　川崎市　　A ２　神奈川県横浜市都筑区２−２−２　　　　　 横浜市　　B ３　東京都江東区門前仲町３−３−３　　　　　 江東区　　C 結果の表 No　住所　　　　　　　　　　　ランク １　神奈川県川崎市宮前１−１−１　　　A ２　神奈川県横浜市都筑区２−２−２　 B ３　東京都江東区門前仲町３−３−３　 C よろしくお願いします。
基本情報技術者試験教科書を読んでいて、DBMSの障害回復機能の記述について疑問が生じました。 教科書には、データベースの障害には記憶媒体などの物理障害とトランザクション処理中の障害とがあり、前者にはロールフォワード、後者にはロールバックを適用すると記述され、最初はそのように理解しました。しかしすぐ後に、トランザクション回復ではケースごとにロールバックやロールフォワードを使い分けるとも記述されています。 最終的にネットも併用しながら、ロールバックとは更新前ログを使ってトランザクション開始時の状態に復帰させる事、ロールフォワードとは更新後ログを使ってコミット時の状態に復帰させる事と理解しました。こう捉えるなら物理障害回復におけるロールフォワードとトランザクション回復におけるロールフォワードは同一の処理だと考える事が出来ます。この認識は正しいでしょうか。
既出の問題だと思うのですが、WindowsServer(2012)上で動作するphp+mysqlで全角ハイフン文字が「？」に化けてしまう現象で困っています。 全くの素人が試行錯誤の状態で作ったアプリなので、mysql(V5.5)のテーブルはsjis、php(5.4)スクリプト自体もsjisで書いています。また環境変数は下記の通りです。 mysql>show variables like 'chara%' character_set_client | cp932 character_set_connection | cp932 character_set_database | utf8 character_set_filesystem | binary character_set_results | cp932 character_set_server | cp932 character_set_system | utf8 テーブルAに入っている値を照会して、選択した結果を上書きするケースもあるため、別のテーブルBに書き込む処理を行っており、テーブルB上には、化けた文字とそれを画面上で修正した文字が混在する困った状態になっています。 まずは、テーブルAを照会する時点で、文字化けをしない状態にし、文字化けをしている状態のテーブルBの値を更新する必要があると思うのですが、まずは前者から対処したいと思います。 対処方法として、化けた文字を$strとすると、 $str=mb_convert_encoding(mb_convert_encoding($str, 'sjis-win', 'auto'), 'UTF-8', 'sjis-win'); とか、 $str=mb_convert_encoding($str, mb_internal_encoding(), 'SJIS-WIN'); とか試してみましたが、全ての文字が化けてしまう状態です。 対処方法がありましたらよろしくお願い申し上げます。
少々混乱してるので変なこと書いてるかもしれません SQLServer2008R2　にて 複数のデータ列があるデータベースが存在しています データの重複を除いてその件数を取得したいのですが 重複チェックしたいデータ列が1つだけではないため COUNT（DISTINCT データ列）　は使えません 以下の様なグループ化を行う事でデータそのものは取得できているのですが 求めたいのはデータではなくて対象になるデータ件数となります SELECT 列１、列２、列３ FROM データベース GROUP BY 列１、列２、列３ 上記の結果を　COUNT　関数に渡すような形になると思っています 　　（これがそもそも方向性が違うのかも） 調べてはいるのですがその書き方がわかりません どのようにすればいいのでしょうか
とあるテーブルに,CSV形式のデータを流し込もうとしたら,以下のようなエラーが出てきました。 mysql> LOAD DATA INFILE "c:/syokuji.csv" INTO TABLE syokuji FIELDS TERMINATED BY ',' -> ENCLOSED BY '"'; ERROR 1290 (HY000): The MySQL server is running with the --secure-file-priv option so it cannot execute this statement これはなぜ起こるのでしょうか？ ちなみに,使用しているOSはWindows10です。
table1のフィールドがsql1のみで内容はsqlのupdate文が格納されてい ます。そして、このtable1のsql1を読んでその内容で更新クエリーを実 行するとした場合は、どの様にmysqlでは処理を記述すれば良いのかと 言うのが分かりません。 例えば、table1が下記の場合はどう言う記述になるのでしょうか。 update result1 set target1=7 where id between 1 and 13; update result1 set target1=12 where id between 14 and 20; update result1 set target1=20 where id between 21 and 31; この場合は、table1を読んで、sql1の更新クエリーを実行したいのです が。個別にレコード単位に処理をする所がプロシージャをどの様に使う のかと言うのが良く分かりません。 済みません。sqlの例示をお願いします。
windows7のmysqlで今日の日付から、今月の日付をテーブルに格納した い。例えば、テーブルのtimecardで、 日付　出社時刻　退社時刻 と言うのが有って、事前に日付のフィールドを予め作りたい時にどの様 にして日付を作るのかと言う事です。 日付に関しては、curdate()で今日の日付が例えば、2016-02-10と出ま す。この値を使って日数は、day(last_day(curdate()))で29と出ます。 160201から、160229迄を日付としてinsert intoをしたいのですが。繰 り返しの数は、day(last_day(curdate()))で得られます。 問題は、160201から160229をどの様にしてデータを作って追加するのか と言う事ですが。その辺の処理が良く分かりません。 済みませんが、sqlの例示をお願いします。 宜しくお願いします。
ID SUB_ID STATUS 他のカラム省略 2 ｜ 1 ｜ 99 2 ｜ 2 ｜ 99 2 ｜ 3 ｜ 00 2 ｜ 4 ｜ 00 3 ｜ 1 ｜ 99 3 ｜ 2 ｜ 99 3 ｜ 3 ｜ 99 3 ｜ 1 ｜ 88 3 ｜ 2 ｜ 00 3 ｜ 3 ｜ 00 3 ｜ 4 ｜ 00 3 ｜ 5 ｜ 00 4 ｜ 1 ｜ 88 4 ｜ 2 ｜ 88 5 ｜ 1 ｜ 99 主キー：ID, SUB_ID, STATUS 抽出したいのは、同じIDのSTATUSが全て99か、または、全て88 の場合です。 上記の例の場合は、IDが3と4と5が抽出対象です。 データの量は多くて1万ですので、恐らくFULL SCANで アプリに読み込んでから抽出する場合、テーブルから最初に 読み取るときに時間がかかり過ぎると思ってしまいました。 以上、宜しくお願いします。
テーブル名は、収穫で下記のデータが入っている。 日付　id　size 160201　1　S 160201　2　S 160201　3　M 160202　4　L 160202　5　L 160203　6　L 160204　7　S これのクロス集計を下記の様に作りたい。 テーブル名は、crossとする。 日付　S　M　L　合計 160201　2　1　　3 160202　　　2　2 160203　　　1　1 160204　1　　　1 済みません、sqlの回答をお願いします。
例えば、テーブルがtable1で、データが下記の場合。 id money sum 1 12 2 20 3 22 上記のデータを下記の様に更新を掛けたい id money sum 1 12 12 2 20 32 3 22 54 この時のmysqlでのsqlを教えて下さい。
MySQLにmembers,subjects,colorsの３つのテーブルがあり、memberには名前データ、subjectsには好きな教科データ、colorsには好きな色のデータが入っています。membersのidとsubjectsのmember_id、membersのidとcolorsのmember_idが結合キーになっています。 ３つのテーブルを連結させてAND検索、OR検索を行いたいと思います。 ２つのテーブルのAND検索OR検索については以前ここで質問して回答を頂きました。（https://oshiete.goo.ne.jp/qa/9128029.html） これを応用して３つのテーブルで検索を行おうとしているのですがうまくいかないので、やり方を教えていただければと思います。 「求める結果」 以下の４パターンのSQL文を作成したいです。 1.指定する教科と色のどれか１つにでも該当 例）国語 英語 青 緑 のどれか１つに該当する名前を検索 2.教科はAND 色はOR 例）国語と英語の両方に該当し、かつ、青か緑のどれか１つにでも該当する名前を検索 3.教科はOR 色はAND 例）国語と英語のどれか１つにでも該当し、かつ、青と緑の両方に該当する名前を検索 4.指定する教科と色のすべてを満たす 例）国語 英語 青 緑 のすべてを満たす名前を検索 「作成したSQL」 （科目のAND) SELECT m.id,m.name FROM members as m INNER JOIN subjects as s on m.id = s.member_id AND s.subject in('国語','英語') Group By m.id Having count(distinct s.subject)=2 （科目のOR) SELECT m.id,m.name FROM members as m INNER JOIN subjects as s on m.id = s.member_id AND s.subject in('国語','英語') Group By m.id （色のAND) SELECT m.id,m.name FROM members as m INNER JOIN colors as c on m.id = c.member_id AND c.color in('青','緑') Group By m.id Having count(distinct c.color)=2 （色のOR） SELECT m.id,m.name FROM members as m INNER JOIN colors as c on m.id = c.member_id AND c.color in('青','緑') Group By m.id これらを組み合わせてSQLを作れば良いと思うのですが、うまくいきません。 「テーブル構成」 [membersテーブル]（名前） id (int) auto_increment name (varchar) [subjectsテーブル]（科目） id (int) auto_increment member_id(int) subject (varchar) [colorsテーブル]（色） id (int) auto_increment member_id color (varchar) 「入力されているデータ例」 [membersテーブル] id|name 1[山田 2|鈴木 3|田中 [subjectsテーブル] id|member_id|subject 1 |1| 国語 2 |1| 数学 3 |1| 英語 4 |2| 国語 5 |2| 英語 6 |3| 数学 [colorsテーブル] id|member_id|color 1 |1| 赤 2 |1| 青 3 |2| 赤 4 |2| 緑 5 |3| 赤
ボランティアの受入をしている施設にいる者です。 ボランティアさんが、ボランティアされる日の当該月に誕生月であった場合、 感謝のメッセージをお伝えする為の管理をAccessでできないかと考えています。 現在、Access2010でボランティアの日付を、下記のようなテーブルによって管理しています。 【T_個人】 ID 名前 生年月日 1 太郎 1981/2/3 2 花子 1970/9/21 【T_ボランティア日】 ID 日付 1 2016/2/20 2 2016/3/10 1 2016/2/25 ※同じ人が月に複数回ボランティアされることもあり ＜対応１：対象者の抽出＞ 上記データを活用して、「年」「月」等を指定することにより、 ①当該年月にボランティアされる方 ②当該年月が誕生月である方 の両方の条件を満たす人を抽出する為に、 Month(T_個人.生年月日) = 当該月 Year(T_ボランティア日.日付) = 当該年 Month(T_ボランティア日.日付) = 当該月 を抽出条件にして、選択クエリを作りました。 ＜対応２：メッセージを渡した人の管理＞ また、上記で抽出したクエリにより、フォームを作り、 メッセージを渡したボランティアさんのレコードを選択して ボタンを選択したり、処理日を入力する等の適当な操作をすること により、対応１のクエリに表示されなくする ということをやりたいのですが、対応２の解決策が私のスキルでは 思い浮かびません。 一応、追加クエリ、更新クエリ等は普通に作れ、初心者レベルですがＶＢＡも 作ったことはあります。 ADOやDAOを使った経験はありますが、どなたかが作ったサンプルをコピー して作った程度です。 解決策をご教授くださる方がいらっしゃれば幸いです。 よろしくお願いします<m(__)m>
以下のようなテーブルがあるとします。 user_id　email_address　type A　　　　a@b.com　　　　1 A　　　　a@b.com　　　　2 A　　　　b@b.com　　　　3 B　　　　c@b.com　　　　1 B　　　　d@b.com　　　　2 B　　　　e@b.com　　　　3 B　　　　e@b.com　　　　4 このテーブルから、同じuser_idでemail_addressがtype = 1のものを含まないレコードを抽出したいと考えています。 出力結果 user_id　email_address B　　　　c@b.com　　　　1 B　　　　d@b.com　　　　2 B　　　　e@b.com　　　　3 B　　　　e@b.com　　　　4 このような結果を得たい場合、どのようなSQL文を記述すればいいでしょうか？
アンインストールしたいアプリがあるんですけど、出来ません。Google Play Store でアプリ検索してアンインストールしようにも、検索できないのです。他にアンインストールする方法があれば教えてください。
ＳＱＬ文の課題なのですが全くわかりません... 全てじゃなくてよろしいので、どなたか助けてください。 TOSYO 表 CREATE TABLE TOSYO( TOSYONO CHAR(4) NOT NULL, SYOMEI TEXT NOT NULL, TYOSYA TEXT NOT NULL, INDEX(TOSYONO), PRIMARY KEY (TOSYONO)) TOSYONO SYOMEI TYOSYA A001 Ｓ大学の真相 専修太郎 A002 ＳＱＬ入門 朽木塔子 B002 神田明神 平将門 C003 無能の人 増相次郎 GAKUSEI表 CREATE TABLE GAKUSEI( GAKUSEINO CHAR(5) NOT NULL, SIMEI TEXT NOT NULL, INDEX(GAKUSEINO), PRIMARY KEY (GAKUSEINO)) GAKUSEINO SIMEI C9601 高石邦生 C9703 吉良上野 D8801 田中桂子 Q8515 大石蔵子 KASIDASI表 CREATE TABLE KASIDASI( KNO CHAR(3) NOT NULL, GAKUSEINO CHAR(5) NOT NULL, TOSYONO CHAR(5) NOT NULL, KIGEN DATE, HENKYAKU INT, INDEX(KNO,GAKUSEINO,TOSYONO), PRIMARY KEY (KNO), FOREIGN KEY (GAKUSEINO) REFERENCES GAKUSEI (GAKUSEINO), 7 FOREIGN KEY (TOSYONO) REFERENCES TOSYO (TOSYONO) ) KNO GAKUSEINO TOSYONO KIGEN HENKYAKU 001 D8801 C003 2014/12/30 1 002 Q8515 A001 2014/12/30 0 003 C9601 B002 2015/01/10 1 004 Q8515 C003 2015/01/12 0 005 Q8515 A002 2015/01/20 0 (HENKYAKU は，1が返却すみ，0が未返却) 次の照会をするSQL文を作成しなさい．回答は，課題1と同様に，テキストまたはワープロファイルに，転記して提出． (1) 大石蔵子さんの貸し出しの状況の一覧（KASIDASI表から作成） (2) まだ，未返却の貸し出しの一覧（KASIDASI表から作成） (3) 期限が12月の貸し出しの一覧（KASIDASI表から作成） (4) 未返却かつ期限が12月の貸し出しの一覧（KASIDASI表から作成） (5) 未返却貸し出しで，貸出期限が古い順に出力するSQL（KASIDASI表から作成） (6) KASIDASI表を基準に3つの表を内部結合し， VKASIDASIという仮想表を作成する． (7) 各図書の貸し出し回数の一覧を表示するSQL文 (8) 各学生の貸し出し回数と一番遅い貸し出し期限を表示するSQL文 （１回も貸し出していない学生は表示しなくてよい）
現在保育士をしております。 SＥに大変興味をもっております。 未経験26女ではもう足切りでしょうか……大金を稼ごうとは思っておりません。 一人暮らしが出来ればそれで満足です。 今から学びながら働かせて頂くことは甘い考えだとは承知ですが、可能なのでしょうか…… 専門学校に通うと更に実務経験なく歳を重ねて採用から遠のいてしまう気がして不安です……
このオプションが設定されていると任意のホルダーのファイルがload data infileでERROR1290 (HY000)のエラーが出る。 このオプションを変更して値をnullにしたい。その方法が分からな い。簡単に変更出来る方法を教えて下さい。 宜しく、お願いします。
C#のフォームから入力を行ったテーブルがあり、 [TBL1]nVARCHAR(8) 100000 ''　←入力値がない場合入力フォーム上でのベリチェックのため’’を初期値設定 18 101 といったデータが入っていますが、 このデータをＣＳＶで出力し報告するように言われました。 // ※指定　number型　（値がない場合ＮＵＬＬ） // この場合ＣＳＶ出力で「値なし」は　「…,,…」になるようにとのことで ＤＢのビュー定義、埋込関数で変換して対応したいと思いましたが convert(bigint,TBL1)　だと’’の部分が０になってしまいます convert(numeric(8,0),TBL1)ですと型変換時にエラーになってしまいます 上記のTBL1表示が数値型でＮＵＬＬ有の ビュー１[TBL1]（数値型） 100000 NULL 18 101 ビューの埋込SQLだけではむずかしいでしょうか？
レイアウトが全く同じテーブル（選択クエリ）が2つあります Aテーブルには全行データ Bテーブルには除外する分の行データが入っています 2つの行を比較し、Bテーブルに一致した１行を除き、表示するクエリを教えて下さい。 よろしくお願いします。
お世話になります。 MySQLで２つのテーブルを結合し検索を行ったところ、私のPCで検索結果が得られるまで136秒もかかってしまい、非常に困っています。 これを1～2秒程度に納めたいのですが、どこを改善していいのかご教示いただけないでしょうか。 検索でやりたいことは、 検索キーと一致するNAMEを検索し、これに対応するFILE_IDに対応づけられているすべてのCLASSとNAMEの組み合わせを検索し、 得られたCLASSとNAMEの組み合わせの検索数をその組み合わせごとに集計し、 検索数の多い順に、CLASSとNAMEの組み合わせを出力する、 というものです。 例えば、結合テーブルが次のような場合に検索キーを与えたときは、次のような結果を得るものです。 FILE_ID GOODS_ID CLASS NAME 1 1 1 商品A 1 2 1 商品B 2 1 1 商品A 2 2 1 商品B 2 3 2 商品C 3 1 1 商品A 3 3 2 商品C 検索キー「商品A」の場合の検索結果： CLASS NAME NUMBER 1 商品A 3 1 商品B 2 2 商品C 2 検索キー「商品B」の場合の検索結果： CLASS NAME NUMBER 1 商品A 2 1 商品B 2 1 商品C 1 検索キー「商品C」の場合の検索結果： CLASS NAME NUMBER 1 商品A 2 1 商品C 2 1 商品B 1 （１）RELATION_GOODSテーブルの構造 CREATE TABLE IF NOT EXISTS RELATION_GOODS( FILE_ID INT NOT NULL, GOODS_ID INT NOT NULL, PRIMARY KEY(FILE_ID, GOODS_ID), INDEX FILE_ID(FILE_ID) USING BTREE, INDEX GOODS_ID(GOODS_ID) USING BTREE) （２）GOODSのテーブルの構造 CREATE TABLE IF NOT EXISTS GOODS( GOODS_ID INT NOT NULL, CLASS INT NOT NULL, NAME VARCHAR(1000) NOT NULL, PRIMARY KEY(GOODS_ID), INDEX CLASS_GOODS(CLASS, NAME(255)) USING BTREE, INDEX GOODS(NAME(255)) USING BTREE, INDEX CLASS(CLASS) USING BTREE) （３）検索式 SELECT B.CLASS, B.NAME, COUNT(*) AS NUMBER FROM RELATION_GOODS AS A INNER JOIN GOODS AS B ON(A.GOODS_ID = B.GOODS_ID) WHERE A.FILE_ID IN( SELECT A.FILE_ID FROM RELATION_GOODS AS A INNER JOIN GOODS AS B ON(A.GOODS_ID = B.GOODS_ID) WHERE B.NAME LIKE 'DVD' ) GROUP BY B.CLASS, B.NAME ORDER BY NUMBER DESC （４）諸情報 テーブル名 レコード数 データ型 照合順序 サイズ オーバーヘッド GOODS 612,750 InnoDB utf8_general_ci 69.6 MiB -- RELATION_GOODS 12,352,490 InnoDB utf8_general_ci 485 MiB -- バージョン： MySQL5.6.24 （３）の実行時間：Showing rows 0 - 24 (30181 total, Query took 136.2325 seconds.)
以下のようなテーブルがあるとします。 user_id　email_address A　　　　a@b.com A　　　　a@b.com A　　　　b@b.com B　　　　c@b.com B　　　　d@b.com B　　　　e@b.com このテーブルから、同じuser_idでemail_addressの種類が3以上あるレコードを抽出したいと考えています。 出力結果 user_id　email_address B　　　　c@b.com B　　　　d@b.com B　　　　e@b.com このような結果を得たい場合、どのようなSQL文を記述すればいいでしょうか？
指定のカラムの最大値を出す方法はmax(カラム名）とやればいいのですが、１行の中の複数のカラムの中で最大値を出したい場合はどうしたらいいでしょうか？ 例えば、 id name score_a score_b score_c 1 hogehoge 1 3 2 2 hoge 5 1 3 とデータがあって、 指定のidで、score_a,score_b,score_cの最大値を出す。 id = 1 なら、　score_bの「３」が最大値 id = 2なら、　score_aの「５」が最大値 といった結果を出したいです。 よろしくお願いします。
下記のテーブルがある。idはintで、mailはtext +------+--------------------------------------+ | id | mail | +------+--------------------------------------+ | 1 | 最初のinsert into の実験 | | 2 | 上手く行ったが、こんなもんでは無い。 | | 3 | 途中からだが、上手く行くのか。 | | 4 | 今度はもうバッチリ見たいだ。 | | 5 | end_of_record | | 6 | これが最後のテストデータです。 | | 7 | 始めて、途中でエラーが出たが。 | | 8 | 何か知らんが、2回目でエラーになる。 | | 9 | ここで動かない理由は何なんだ。 | | 10 | ここは気にせずに前を向いて歩こう。 | | 11 | end_of_record | +------+--------------------------------------+ これは、 select * from work where id<= ( select min(id) from work where mail = "end_of_record" ) ; 上記を実行すると下記が得られる。 +------+--------------------------------------+ | id | mail | +------+--------------------------------------+ | 1 | 最初のinsert into の実験 | | 2 | 上手く行ったが、こんなもんでは無い。 | | 3 | 途中からだが、上手く行くのか。 | | 4 | 今度はもうバッチリ見たいだ。 | | 5 | end_of_record | +------+--------------------------------------+ では、これをdeleteで実行しようとすると、サブクエリーでは同一の テーブルが使えないと言うエラーが出る。 delete from work select * from work where id<= ( select min(id) from work where mail = "end_of_record" ) ; 別名を使った、deleteのsqlを教えて下さい。 宜しく、お願いします。
今は、実際にテーブルのカウントを取って確認を取っていますが。この 方法は件数が増えると遅くなります。 select count(id) from mail; 実際の処理は件数を取得するのが目的では無くて、テーブルにレコード が有るのかどうかの確認ですので件数を取得する必要は無いのですが。 他に方法を知らないのでこの方法を今は取っています。 簡単にレコードが有るのかの有無の確認と言うのは取れないのでしょう か。 宜しく、回答願います。
お世話になります。 oracleデータベースをインストールしてアンインストールしたいのですが。 RPMでしようとすると次の様にエラーがでます。 [root@centos7 Disk1]# rpm -i oracle-xe-11.2.0-1.0.x86_64.rpm パッケージ oracle-xe-11.2.0-1.0.x86_64 は既にインストールされています。 [root@centos7 Disk1]# rpm -e oracle-xe-11.2.0-1.0.x86_64.rpm エラー: パッケージ oracle-xe-11.2.0-1.0.x86_64.rpm はインストールされていません アンインストールする方法を教えてください。 RPMの --force --nodeps を指定しても上記と同じエラー がでます。 宜しくお願いします。
mailのテーブルは下記の様に定義をしています。 1. mail text 2. id int この状態でload data infileで、idに連番を付加したいのですが。 出来る方法は無いのでしょうか。
workのテーブルに下記のデータが入っている。 この時に、end_of_recordで分離されているので最初のidがここでは1か ら4迄をselect句を使って抽出をしたい。 mysqlのselect * from work where ... で、何とか抽出をしたいのですが。構文が分かりません。 sqlの回答をお願いします。 +------+--------------------------------------+ | id | mail | +------+--------------------------------------+ | 1 | 最初のinsert into の実験 | | 2 | 上手く行ったが、こんなもんでは無い。 | | 3 | 途中からだが、上手く行くのか。 | | 4 | 今度はもうバッチリ見たいだ。 | | 5 | end_of_record | | 6 | これが最後のテストデータです。 | | 7 | 始めて、途中でエラーが出たが。 | | 8 | 何か知らんが、2回目でエラーになる。 | | 9 | ここで動かない理由は何なんだ。 | | 10 | ここは気にせずに前を向いて歩こう。 | | 11 | end_of_record | +------+--------------------------------------+
現在、自作でアクセス解析を作成しております。 グラフ等の表示で必要なレコードの取得についてどうしてもわかりません。 ご教授頂ければと思います。 =========================================== ■レコード一覧 =========================================== id date 　　page_id session_key device 1 2016-1-1　　1 1 pc 2 2016-1-1　　2 1 pc 3 2016-1-1　　1 2 smart 4 2016-1-1　　2 2 smart 5 2016-1-1　　1 3 pc 6 2016-1-1　　2 3 pc 7 2016-1-2　　1 3 pc 8 2016-1-2　　1 4 smart 9 2016-1-3 　　1 5 pc =========================================== 日付ごとにアクセスした人数(uniqu数)取得したいです。(表示上デバイス毎) DISTINCTを使えば重複を取り除けるのでしょうが、どこにどういれれば良いかわかりません。 現状のsqlを記載します。この結果からsession_keyを取り除く為にはどのようなsqlにすればよいか。 SELECT `date` , COUNT(CASE WHEN device = 'pc' THEN 1 ELSE NULL END ) AS `pc` , COUNT(CASE WHEN device = 'smart' THEN 1 ELSE NULL END ) AS `smart` FROM `access_records` WHERE `date` >= '2016-01-01 00:00:00' AND `date` <= '2016-01-03 23:59:59' GROUP `date` ORDER `date` ASC =========================================== ■現状の結果 =========================================== date 　　pc smart 2016-1-1 　　4 2 2016-1-2 　　1 1 2016-1-3 　　1 0 =========================================== =========================================== ■取得したい結果 =========================================== date 　　pc smart 2016-1-1 　　2 1 2016-1-2 　　1 1 2016-1-3 　　1 0 ===========================================
以下のSELECT文をひとつにまとめる方法を知りたいです SELECT * FROM city,town WHERE city.id=town.city_id city.id; SELECT * FROM city,town WHERE city.id=?;
データベースのエクスポートですが、 ワードプレスで、データーベースを接頭辞に区切って その一部を使用しています。 wp19_　　というぐあいに。 エクスポートする場合、テーブルごとにやらなければならないのでしょうか？
単純にデータとして以下のようなのがあった時 data createdate 1 2016-01-01 01:01:22 1 2016-01-01 08:00:23 1 2016-01-03 09:00:22 みたいなデータがあって 結果として、 2016-01-01 → 2個 2016-01-02 → 0個 2016-01-03 → 1個 と取得した。この「０」個も取得できるようにしたいです。 上記の場合は、1/1から1/3の値の集計として出す。この日付の範囲も指定したい。 例えば、1/1~1/4の範囲で上記のデータを解析すると 2016-01-01 → 2個 2016-01-02 → 0個 2016-01-03 → 1個 2016-01-04 → 0個 となる。 よろしくお願いします。
以下のような２つのテーブルがあったとします。 顧客テーブルでユーザ名に"/"を含んだユーザのなかで、ユーザIDが住所テーブルに存在しないレコードを抽出するSQLを書くにはどうすればいいのでしょうか？ ＜顧客テーブル＞ ユーザID　ユーザ名 1 A/B 2 CD 3 E/F ＜住所テーブル＞ ユーザID 住所 1 GGG 2 HHH ＜抽出結果＞ ユーザID　ユーザ名 3 E/F
はじめまして DB2にTIME型というデータタイプがありますが、日付という概念はない認識です。 このTIME型オブジェクトをJavaScriptで取得して大小比較をしています。 比較する際にgetTime()を使っていますが、これは1970/1/1 00:00:00を基準日時とした 経過ミリ秒です。TIME型オブジェクトにgetTime()を使っても問題ないのでしょうか？ （1970/1/1は保証されるのでしょうか？） またTIME型は24:00:00を許容しています。 この24:00:00を設定したTIME型オブジェクトをtoString()すると 2016/1/24 00:00:00となります。（2016年1月現在） どのような理屈でこのような値になるかご教授頂けますか？ DB2のバージョンは9.7です。 以上、よろしくお願いいたします。
MySQLの最新バージョンをこちらのサイトで見ているのですが、 http://openstandia.jp/oss_info/mysql/version/ 10月26日に5.7.9になって 12月14日に5.5.47になっていますが、数字が減っていても 新しい日付でリリースされたものが最新バージョンになるのですよね？ 同じく、PHPはこちらを見ましたが http://news.php.net/group.php?group=php.announce 7.0.1が最新ということでしょうか？
adobeのPhotoshopCCの体験版をインストールしようとしても失敗しましたとしか出ません。何回も試しましたが、、、。 パソコンのことは全く詳しくなく、このようなソフトをダウンロードしようとするのも初めてで、なにもわかりません。 パソコンは Windows Dynabook/t350/46BR CORE i5 です。 不可能なんでしょうか、、、 だれか助けて下さい！！ 画像見にくくて申し訳ありません。汗
質問させていただきます。 win10(64bit)端末にOracleClient11gをインストールして OLEDBでOracle11gへの接続を行いたいと思っています。 端末にOracle11gをインストールしたところ 「OraOLEDBver.dll」などのdllはインストールされましたが プロバイダに「Oracle Provider for OLE DB」が出てきませんでした。 プロバイダの確認方法としては ***.udl というUDLファイルを作成してダブルクリックで起動し、 [プロバイダ]タブを確認しています。 別途テストで使用しているwin7(64bit)端末では 上記方法でプロバイダタブに「Oracle Provider for OLE DB」が表示されています。 （この端末は私が構築したものではないので、設定内容は不明です。） win10の端末のプロバイダに「Oracle Provider for OLE DB」を追加するためには 別途作業が必要なのでしょうか。 それとも私の確認方法が悪いのでしょうか。 お手数をおかけしますが、ご回答いただければ幸いです。 よろしくお願い致します。
初めまして、XAMPPのコントロールパネルv3.2.2を開いて、ＭｙＳＱＬのスタートボタンをクリックすると次のようなエラメッセージが表示されて開くことができません！。 Status change detected: stopped 18:19:31 [mysql] Error: MySQL shutdown unexpectedly. 18:19:31 [mysql] This may be due to a blocked port, missing dependencies, 18:19:31 [mysql] improper privileges, a crash, or a shutdown by another method. 18:19:31 [mysql] Press the Logs button to view error logs and check 18:19:31 [mysql] the Windows Event Viewer for more clues 18:19:31 [mysql] If you need more help, copy and post this 18:19:31 [mysql] entire log window on the forums さらに、ブラウザを立ち上げて「http://localhost/」への接続もできません！。 何方か　解決方法を教えてください、よろしくお願いします。 尚、OSはWindows10をダウンロードして使っています。
MySQLのレプリケーションをしたいと思っています。 ローカルのコンピュータ（linux mint）をMaster、NASをSlaveにしてレプリケーションしたいのです。 いろんなサイトを参考にやってみたのですが、どうにもうまくいきません。 原因は、データベースコピーの際のパーミッションにあるのではないかと思っているのですが、解決方法がよくわかりません。 そこで1点だけに絞って質問します。 データベースを、Masterからtar圧縮してSlaveにコピーし解凍するとSlave側ではphpMyAdminでもコマンドラインでもデータベースが見え、そしてテーブル名は表示されるのですが、その内容を表示させようとすると「Table 'sampledb.table1' doesn't exist」というようなメッセージが出ます。 パーミッションを777にしても、所有者や所有グループを他のデータベースと同じに変更してもダメです。 データベースをコピーした場合、エクスポート/インポートした時と同じようにテーブル内容もすべて表示されないといけないんですよね？ 何が間違っているんでしょうか？
mysqlの勉強でworkbenchをインストールしようと思っていますが。ユー ザー登録をしないとインストールが出来ない見たいです。 私はもう定年退職をしていて勤務をしていないのですが。この場合はイ ンストールは出来ないのでしょうか。適当に前の職場の内容でも良いの でしょうか。 回答の程宜しくお願いします。
例えば、sqlと言うテーブルに下記のsqlの内容が入っている。 クエリー1として、 SELECT TOP 5 Mail.* FROM Mail; 次に、そのクエリー1を使って DELETE クエリ1.* FROM クエリ1; 上記の行が入っている。 ここでは最終的には2行目の削除クエリを実行させたい。また、ここで はこの削除クエリーの後に有る処理を実行して、その後に再度この削除 処理を繰り返す。最終的にはこの削除対象のテーブルのデータが空にな る迄この処理を実行させたい。 然し、先ずはこのテーブルに格納されているsqlをmysqlで実行させる方 法が分かりません。 mysqlにevalの機能は有るのでしょうか。 宜しく、お願いします。
統計の方法について教えてください。 名義尺度（はい・いいえ）のデータを15の群間で比較します。 （この時点では、全体的に差があるかないか、を見ます。） それぞれの群に含まれる度数は8から80までと不ぞろいです。 最初にカイ2乗検定をすると、期待値が5以下というのが複数あり、 カイ2乗検定は無理なようです。 ほかにも、ノンパラメトリック、群数が多い、など、条件が悪く、 どうやって比較すればよいのかわかりません･･･。 （最初は、カイ2乗で差を見る→残差分析で差のある箇所を特定、と 考えていたのですが。） どのようにすればよいか、ご教授いただけますでしょうか。 よろしくお願いいたします。
初めまして。 ご教示頂けると幸いです。よろしくお願い致します。 ただいま、sqlを学んでいる最中なのですが、 以下の問題の書き方がわからず手が止まっています。。。 【処理内容 : Aテーブル内のbカラムに’　　　　　’または ｃカラムに’　　　　　’がある時、メールで通知する処理 （空欄はスペース５個分です）】 以下のような書いていくのだろうというイメージはあります。。 select ~ from A where if スペース b has スペース5個分 or if スペース c has スペース5個分 -- "大枠"単位でLOOP -- "小枠"単位でLOOP -- エラーメッセージ作成 このような構成となっています。 ⬇︎ CREATE OR REPLACE PACKAGE BODY XXXXXXXXXX IS ******************************************************************************* */ --～ /*********************** * function 定義 *********************/ /****************************************************************************** 処理名 : abcdef 処理内容 : Aテーブル内のbカラムに’　　　　　’または ｃカラムに’　　　　　’がある時、メールで通知する処理 （空欄はスペース５個分です） *********************この内部が知りたいです。*************************************************/ -- カーソル変数の定義 -- リターンする文字列 -- 初期化 -- "大枠"単位でLOOP -- "小枠"単位でLOOP -- エラーメッセージ作成 -- エラー全件 /***********************この内部が知りたいです。************************************ 処理名 : main ******************************************************************************/ --カーソル変数の定義 -- メール本文 -- メール件名 -- 抽出結果全件 -- ************************************************************************* -- * -- ************************************************************************* -- 本文 -- チェック処理 -- 件名 -- メール送信処理 質問の仕方が上手くなく、申し訳ありません。 よろしくお願い致します。
ＳＱＬサーバのエクセル連携について ＯＤＢＣ経由で　テーブル単位でリンクができることは通常、よくされているかと思います。 あるＴＥＳＴ１テーブルに　１から４０までの番号フィールド付の情報があり ＤＡＴＡ１、ＤＡＴＡ２の付帯情報が存在します。 この場合　エクセルで　左側に　１から２０までの番号フィールドに相当するＤＡＴＡ１、ＤＡＴＡ２の付帯情報を表示 右側に　２１から４０までの番号フィールドに相当するＤＡＴＡ１、ＤＡＴＡ２の付帯情報を表示を 分けて表示できないものでしょうか。 ＳＱＬサーバは無償版　エクセルは２００７で使用 ご教示いただけると助かります。 よろしくお願いいたします。
■データベース os：linux mysql バージョン：5.1.73 ストレージエンジン：myisam Ａテーブル：indexあり　レコード件数：10,000,000件 ■webサーバー os：linux 開発システム:php ＜概要＞ linux環境で集計phpにてＡテーブルを作成します。 windows環境でAテーブルの内容を閲覧phpにて表示させます。 現象を下記に記述します。 ・linux環境 １．ＤＢ上のＡテーブルが毎朝の更新処理で作成(更新)されます。(9時３０分頃完了) 　　※作成処理はこれで完了です。翌朝まで処理は起動しません。 ・windows環境 ２．9時30分から11時59分59秒の間にAテーブルでselect文を発行 ３．3秒程でselectされた内容が表示されます。(この内容はキャッシュされます。） ４．この後、未キャッシュのselect文を9時30分から11時59分59秒の間に何度発行しても 　　3秒程でselectされた内容が表示されます。(この内容もキャッシュされます。） ５．この後、12時00分00秒にAテーブルで同じselect文を発行 ６．3秒程で表示されていたものが、5分程の時間を要して表示されます。 　　※index使用せず、テーブルフルスキャンしていると思われます。 　　(この内容もキャッシュされます。） ７．この後は、未キャッシュのselect文を12時00分00秒から14時59分59秒の間に何度発行しても 　　3秒程でselectされた内容が表示されます。(この内容もキャッシュされます。） ８．この後、15時00分00秒にAテーブルで同じselect文を発行 ９．3秒程で表示されていたものが、又5分程の時間を要して表示されます。 　　※これもindex使用せず、テーブルフルスキャンしている。(この内容もキャッシュされます。） １０．その後は、18時00分00秒、21時00分00秒と３時間間隔で同現象となります。 要望としまして 上記の３時間間隔でフルスキャンしてしまう現象を止めたいと思っています。 my.cnfの内容、phpに組み込まれている内容など調べてみたのですが、 時間によってフルスキャンしてしまう(index使用しない)設定がみつかりませんでした。 オプティマイザの挙動（統計情報も関わっている？）についても調べたのですが 上記現象に繋がる情報を取得出来ませんでした。 この現象を解決していただける方、どうかご教示お願いいたします。
以前から使っているPro5から乗り換えるために、Pro11→Pro14の試用版を使っています。 正式にソフトを購入しようと思っているのですが、ヨドバシカメラのサイトにFileMaker Pro 14 Single User License up grade hybridとFileMaker Pro 14 Single User License hybridとあるのですが、どちらを購入したらよいのでしょうか？
Macパソコン初心者です。 宛名職人バージョン18を使っています。 先月、使っていたプリンターが故障してしまい、宛名職人の住所録一覧の印刷ができなくなりました。 ネットプリントなどやってみましたが、いずれもファイル形式が違うため印刷できないようです。 他のプリンター(実家かコンビニ等)で印刷出来る方法があれば教えてください。
Windows7のAccess2007を使っています。 Accessのクロス集計クエリから、追加クエリをvbaで記述したいが記述 が分からない。 vbaを使わなければ、データベースウインドウで最初にクロス集計のク エリを作って、そのクエリを使って追加クエリを作れば終わりですが。 これと同じ事をvbaで記述をしたいのですが。 出来るのでしょうか。 例として、収穫テーブルとサイズテーブルのクロス集計を作ると仮定し て下記の構造で作る物とします。 収穫テーブルは下記の構造です。 1. idと言う名前でオートナンバーの型 2. サイズと言う名前で数値の型 サイズテーブルは下記の構造とします。 1. idと言う名前でオートナンバーの型 2. 名前と言うフィールドの名前でテキストの型 収穫のテーブルは下記のデータが入っています。 ID サイズ 1 1 2 2 3 2 4 2 5 1 6 2 7 3 サイズのテーブルは下記のデータが入っています。 ID 名前 1 大 2 中 3 小 リレーションシップは、一側のテーブルがサイズのテーブルで、idを主 キーとします。多側のテーブルは、収穫のテーブルで多側のキーはサイ ズです。 ここで、クエリ1の名前で TRANSFORM Count(収穫.ID) AS IDのカウント SELECT 収穫.ID FROM サイズ INNER JOIN 収穫 ON サイズ.ID = 収穫.サイズ GROUP BY 収穫.ID PIVOT サイズ.名前; を実行すると、下記が得られます。 ID 小 大 中 1 1 2 1 3 1 4 1 5 1 6 1 7 1 ここで、クエリ1を使って下記のクエリ2を作ります。 INSERT INTO table1 SELECT クエリ1.* FROM クエリ1; 上記の操作でクエリ1のクロス集計クエリを使って クエリ2の追加クエリと言う二つの手段で クロス集計からデータを作る事が出来ます。 この操作をvbaの手法で作る方法は無いのでしょうか。 この例でのコードの記述を宜しくお願いします。
mysqlで２つのテーブルをINNER JOINしてデータを抽出したいのですが、うまくデータが抽出できないのでSQL文の書き方を教えてください。 「テーブルの構成」 [postテーブル] id (int) auto_increment name (varchar) [categoryテーブル] id (int) auto_increment post_id(int) name (varchar) 「入力されているデータ」 [postテーブル] id| name 1 | 自由課題 2 | 夏休みの宿題 3 | 研究 [categoryテーブル] id| post_id|name 1 | 1 |国語 2 | 1 |算数 3 | 1 |理科 4 | 2 |国語 5 | 2 |英語 6 | 2 |社会 7 | 3 |理科 8 | 3 |英語 9 | 3 |国語 「抽出したいデータ」 postテーブルとカテゴリーテーブルを SELECT * FROM post INNER JOIN category ON post.id = category.post_id のようにINNER JOINして、categoryテーブルのnameに国語と理科の両方が含まれるpostテーブルのidとnameを抽出したいです。 上記のデータだとpostテーブルの「id=1,name=自由課題」と「id=3,name=研究」という結果が得られれば良いです。 SELECT * FROM post INNER JOIN category ON post.id = category.post_id where category.name='理科' というcategoryのnameを１つだけ指定した場合は抽出できるのですが、 SELECT * FROM post INNER JOIN category ON post.id = category.post_id where category.name='理科' and category.name='国語' と指定した場合 データが抽出できず空の結果が返ってきてしまいます。 ２つのテーブルのINNER JOINという問題以前に 一つのカラムで「国語」かつ「理科」というand検索の方法がわかっていないのが問題のような気がしています。 ご回答よろしくお願い致します。
うん十の手習いでphpを使い始めた者です。 phpでmysql(5.5)のデータに対し、照会画面を作っています。 並び順は、降順と昇順の組合せになっており、 select ymd , soshi, shain from mytbl order by ymd desc, sos, shain の結果で表示される一覧表で、各行をクリックすると、 そのレコードの明細を表示する画面があります。 その明細画面で、次レコードに移動するボタンを設け、 元の一覧表の次の順のレコードを表示したいのです。 明細画面で表示した、ymd,sos,shain の値を別プログラムで、 $ymd, $sos, $shain　として受け取り、 元のクエリの頭出しをするために、 select ymd , soshi, shain from mytbl where ymd <= {$ymd} and concat(sos,sycd) >= {$sos}{sycd} order by ymd desc, sos, shain としても、次レコードの値は正しい値にすることはできません。 並び順が全て昇順であれば、 where concat(ymd,sos,sycd) >= {$ymd}{$sos}{sycd} とすれば可能なのですが、要件的に降順にする必要があるので困っています。 私のつたない知識の範囲からすると、 where ymd <= {$ymd} とだけ、指定して、読み飛ばしすれば出来るのでしょうが、次レコード移動の 度に空読みが発生してしまうので、非現実的です。 カーソルを使ったりしてこんな処理は出来るのでしょうか？
スーパーPDF変換ソフトのお試し版をダウンロードしました。 RDFの書類を添付して送ると、相手にPDFの書類だけが送られるのではなく、 その形のまま（変換できるツールバーなど）も一緒に送られてしまうので、 スーパーPDF変換ソフトをアンインストールしようと思ったら、 間違って違うソフトまでアンインストールしてしまった。 そしたらPDFの書類が見れなくなってしまった。 間違ってアンインストールしたソフトが「Foxit　Corporation」 これが本当に影響したのかも分からない。 それで焦ってシステムの復元をしてしまった・・・。 元に戻ったと思い、直ぐスーパーPDF変換ソフトをアンインストールしようとしたら、 「ファイルが見つかりません」と出てくるのですが、デスクトップにアイコンがあるのと、 やはりPDFの書類はそのままついてくる。今度は色だけがない状態で。 スーパー変換ソフトをアンインストールすること、PDFが見れるようにもとの状態にしたいこと、 アクロバットリーダーがダウンロードが出来ないこと、 その他、復元が原因で今まで閲覧していたものやID、PWが全て消えてしまった。 残しておく方法を教えてください。 この4つを教えて頂きたいので、どうぞ宜しくお願いいたします。
SQLの作り方について教えてください。 たとえば添付画像のようなテーブル「クラス」と「生徒」が与えられたとき、 生徒テーブル内で「クラス内に女生徒がひとりもいない」ことを条件にレコードを取得したいです。 この例だと赤枠部分が該当します。 よろしくおねがいします。
すいません。本当にDBに関しては素人でトンチンカンな質問かもしれませんが、今、MovableTypeのVer4.3のDBからdumpしたデータが手元にあります。 これを自前のサーバーで復元してとりあえず中身が見たいのですが、phpmyAdminでインポートしようとすると、エラーが出てしまって困っています。 エラー SQL query: DROP TABLE IF EXISTS `mt_as_ua_cache` MySQL のメッセージ: ドキュメント #1046 - No database selected これは、mt_as_ua_cacheという名前のテーブルを作ってからインポートをすればいいんでしょうか。 （mt_as_ua_cacheを作ろうとするとエラーが出て作れません） おそらく元のDBはmySQL4.0系、インポート先は5.5です。 やりたいのはとりあえずDBに入れて中身を確認さえできればいいので、エラーがある状態でも入れられればいいです。 不足情報があれば追記しますのでご指摘お願い致します。
バージョンは10ｇです 急にシステム管理者が退職し、担当になってしまい困っています。 超初心者なので皆様よろしくお願い致します。 表に売上明細があり下記のように西暦で数値型としてあるのですが これを”月”でgroup化したいのです。 ただし売上明細表には列の追加はできません （別システムからのインポートデータの為） 　 date SH_CD SURYO 　　20151120　　 111 15000 20151121 222 10000 色々調べた中でsubstrで月の部分を抽出できたのですが。。。 　　 CREATE OR REPLACE VIEW V_TEST1 　　 SELECT substr(DATE,5,2) AS MOUTH,SH_CD,SUM(SURYO) FROM MEISAI GROUP BY(substr(DATE,5,2),DATE,SH_CD と作ってみたのですが、”日”の部分でしか集計されません 元の表を変更せずビューで”月”の集計を取る方法はありませんでしょうか？ よろしくお願い致します。
postgres SQL select文の書き方について 「半角カナ＋英＋数」　以外の文字が含まれているレコードを抽出するにはどのように記述したらいいでしょうか？ 例：ｱｲｳｴｵabc123 　　ｱｲｳｴｵ123 　　ｱｲｳｴｵ@123（※抽出したい） 　　ｱｲｳｴｵab+c123（※抽出したい) 　　アイウエｵabc123（※抽出したい） よろしくお願いいたします。
サービスにmysqlの登録が成功した後に起動すると 「システム エラー 1067 が発生しました」と表示されてしまいました。 解決策を見ているとアインストールしてインストールし直す意見が一番多かったのですが それ以外に解決方法はないでしょうか？（以前もアインストールしてインストールし直しても上手くいかなったためです）
javaでwebアプリケーション開発をしています。 mysqlに直接ひらがな・全角・半角・英数を打ち込むと受け付けてくれるのですが、servlet→jsp→mysqlの流れ（Java）で、情報を入力すると全角と平仮名が文字化けしてしまいます。 そのためmy.iniの変更を [mysql] default-character-set=utf8 ↓↓↓ [mysql] default-character-set=cp932 に変えましたが今だに文字化けしています。原因は何でしょうか・・・？ ご教示お願い致します。
商品の入出庫記録簿を作成しようとしています。 データベース内の「1.入庫のテーブル」と「2.出庫のテーブル」から、SUM関数で指定項目の合計値を出力しましたが、1の入庫テーブルから出庫テーブルの在庫を減算する方法を教えて下さい。 要約すると、SUM関数で各テーブル(入庫のテーブル,出庫のテーブル)の指定項目の合計値を求めた後に、「1.入庫のテーブル」‐「2.出庫のテーブル」の結果を出力させたいです。 ※1.添付画像を参照していただくと分かりやすいかもです。 ※2.PDO方式でSQL文を記載しています。 1.入庫テーブルの合計値を求めるSQL文 $sql1 = "SELECT syouhin, SUM(kosu) AS 個数合計,SUM(jyuryo) AS 重量合計 FROM shipping GROUP BY syouhin"; 2.出庫テーブルの合計値を求めるSQL文 $sql = "SELECT syouhin1, SUM(kosu1) AS 個数合計,SUM(jyuryo1) AS 重量合計 FROM storage GROUP BY syouhin1";
Javaの勉強をしながらeclipseとmysqlで管理ソフトを作っています。 DAOパッケージで String sql = "select （カラム値） from card_data where card_id = ? order by company_name"; と記述すると、うまくselectされません。（where card_id = ?を外すと値を取ってきます） これは記述の仕方が悪いのでしょうか？それとも、WHEREとORDER BYを同時使えないのでしょうか 詳しい方いらっしゃいましたらご教示お願いします。 ＊環境 eclipse4.5 All in one windows7 　　　 mysql
最近まで数年放置してたvista、どう対処したらいいのでしょうか？(´Д` ) iPhoneのデータを保存出来るようにしたいです。 iTunesを更新する事が出来ず、バックアップもとれません。 ブログを始めようにも、vistaではちゃんと見れない場合が出てきて、どうにかしたいです(>_<)
+-------------------------------+ | SHOP_CD | +-------------------------------+ | 11230 | | 11230,21002,28003,28005,99309 | | 11230,23003 | | 11230,23003,23003 | | 11230,28003 | | 11230,28003,28005 | | 11230,28005,21002,28003 | | 11302 | | 11302,11230 | | 11302,11230,11332 | +-------------------------------+ カンマ区切りの文字列を 重複を省いて取得したいと考えておりますが 実現方法が思いつきません 結果としては、 11230 11302 11332 21002 23003 28003 28005 　・ 　・ とSQLのみを使って配列で取得したいと考えております splitのようなSQL系関数を探したがないので 実現方法またはヒントをいただけると幸いです 宜しく御願いいたします 環境は PHP5、MySQL5.6 になります
Access2007のクエリーでdcountを使って連番を作りたい。下記に概要を 示す。 1. テーブル名は、comment フィールドは下記。 1. id オートナンバー 2. comment テキスト型 これは、dcount([id],"comment","条件式")で連番を作れる様ですが。 やりたい事は、条件を付けずに全てのレコードで連番を最初の一から作 り直したいのですが。idは主キーとして重複を許したく無いのでオート ナンバーとして設定しています。 この条件式で全てと言うのを何回かやりましたが。上手く行きません。 dcountでどの様な式を書いたら良いのでしょうか。 式の回答をお願いします。
知識ゼロの初心者です。 勉強がてらSQLServerの構築をしたいと思っていますが、 どうすれば下記の構想が実現するための具体的な手段がわからずにいます。。。 　①動員数100名程度の小規模イベントの参加人数、氏名、性別等を管理したい 　②SQLServerは無償で利用できる「SQL Server 2008 R2 Express Edition」を利用したい 　③自PCではなくクラウド上でサーバをレンタルし、クラウドのサーバ上でDB構築したい 　④DBを構築するクラウドサーバのレンタルなども含めて、全て無償でできる範囲で行いたい ③、④について、 ・DBをインストールするクラウドサーバはどのサイトからレンタルすればいいのか ・そもそも可能なのか をなんにも理解できていない馬鹿にもわかるように教えて頂けたらと思います。 以下余談ですが、 最終的にはWEB上でDB更新用サイトを限定公開したり、 アプリを開発してANDROID端末上でDBを更新したりしたい、 という大それた野望があり、まずはDBの構築から頑張りたいのでよろしくお願いします。
ＣＰＵを換装しました。 しかし、ＢＩＯＳでは確認できますが、システムのプロパティ、デバイスが元のＣＰＵのままです。 ＣＰＵ－Ｚなどで確認しても新しいＣＰＵが確認できます。 システムのプロパティ、デバイス表示を変更する方法はありますか？ それとも、ＣＰＵが換装前の状態で起動しているのでしょうか？
こんにちは。 ＡＣＣＥＳＳで、テーブルを分割し、一台の端末にテーブルを置き、他の数台の端末からリンクで、 入力や検索等を行うようにフロントエンドを作りました。 しかし、テーブルの入っている端末が席外し等で待ち受け状態になりロックがかかってしまうので、 他の端末からもつかえなくなってしまうようです。 情報漏洩のこともありますから、席を外しているときは、ロックをかけておきたいのです。 良い方法はありますでしょうか？ アドバイスいただけたら、有りがたいです。よろしくお願いいたします。
SQLite3をバックエンドにAccessを使用しています。 数台のPCで同時に使用したいため、SQLite3のファイルをクラウドに保存し、 各PCでリンクテーブルの参照を変えて使用します。 これを毎回手動でやるのは手間なので、VBAでやりたいのですが、 参考書の通りやっても、SQLiteだからか、できませんでした。 以下コードですが、丸写しなのでさっぱりです。 一応、Typeプロパティの値を"LINK"としているところが怪しいと思っているのですが・・・。 分かる方がいらっしゃったら助かります。 Public Function RefreshLinks(ByVal strFilePath As String) As Boolean Dim cat As New ADOX.Catalog cat.ActiveConnection = CurrentProject.Connection Dim tbl As ADOX.Table On Error GoTo eh For Each tbl In cat.Tables If tbl.Type = "LINK" Then Debug.Print tbl.Name tbl.Properties("Jet OLEDB:Link Datasource").Value = strFilePath End If Next Set cat = Nothing RefreshLinks = True Exit Function eh: RefreshLinks = False End Function
おはようございます。 　今日も朝早くから何かとがんばっております。 　約２年をかけて基礎のC言語の参考書があと1ページで終了です。 　さて プログラム言語を使い掲示板を作るのが目標ですが 　何か作りやすい言語など、おすすめの言語はございませんでしょうか 　va PHP C C++ C＃ Visual Basic Visual Basic .NET Perl COBOL PL/SQL JavaScript ActionScript Ruby Objective-C Python Delphi Go 　以上ネットで検索したところ以上の言語があるみたいです。　 C++とC＃に現在興味があります。 　PHPも２６０ページやりましたが、何か”しっくりしない”プログラム言語と言う！ 　印象を受けました。 C言語は基礎的な言語で登竜門的な印象を受けました。 　最終的にはデータベースが作るのが夢です。 　おすすめの言語がございましたら馬鹿な私でございますが、ご教授をよろしくお願いいたします。
こんにちは。 WindowsServer2003上で、MYSQL+phpで動作しているアプリがあります。 これを2008サーバーに移転作業を行っているのですが、非常に困った事態に陥っています。 事前に並行のテスト稼働をしており、旧サーバー上で動作しながら、新サーバーを動かしており、動作確認を1ヶ月以上していました。 移転自体は問題なく終わっており、新サーバーでの動作も確認できるのですが、 旧サーバー上でMysqlサーバーを停止すると、新サーバーが動かなくなる不思議な現象が起きています。 phpスクリプトは、グループウェアの中から、グループウェアの持っているログイン情報を取得し、パラメタで与えて呼び出しています(言語はColdfusion)。その時に取得された変数の値を手入力して同じブラウザで呼び出すと、同じ状況でも正常に動作するのです。ブラウザをCtrl+F5でクリアしても同じです。 グループウェアの仕様と言っても、その中では、MYSQLを使っている訳ではないので、移行によって何か条件が変わるということは考えにくく、何が問題なのか、私の知識ではお手上げな状態です。 何かヒントになる情報でも構いませんので、頂けたら有難いです。 よろしくお願いします。
MySQL5.7.9.0 を windows web server 2008　にインストールしたいのですが、セットアップウィザードが起動しません。 OSが古いせいでしょうか？それとも、ほかに考えられる理由があるのでしょうか？ インストーラーは、mysql-installer-community-5.7.9.0を使っています。 ご教授いただければ幸いです。
はじめまして。 VBA超初心者です。 エクセル一覧で15/01と文字にて表記されている文を1501と変換したいのですがうまくいきません。 月 品番 品名 内容 担当者 結果 15/01 あ い う え お 15/02 あ い う え お 15/03 あ い う え お 15/04 あ い う え お 15/05 あ い う え お 15/06 あ い う え お 15/07 あ い う え お 15/08 あ い う え お 15/09 あ い う え お 15/10 あ い う え お 表としては上記のような感じです。 いろいろ調べて Dim i As Long For i = 2 To xlDown If Cells(i, 1) = "@@" & "/" & "@@" Then Cells(i, 1) = Replace(Cells(i, 1), "/", "") End If Next i とやってみたのですが全く無反応でした。 すみませんが教えてください。
何から質問していいかも分からないような状況なので申し訳ないのですが、 access（2000）からデータをエクセル（2003）に引っ張ってきたいのです。 今まで、oracleのデータをエクセルに取り込んで マクロを組むという流れで業務システムを作成することはしてきたのですが、 このたび、accessからデータを取り込んで同様のことをすることになりました。 accessは殆ど触った事がなく、何やら一般的なDBMSとは異なる感じがしています。 mdbファイル（調べてみると、このファイルにデータベースもフォームもマクロも全部含まれているそうですね。びっくりしました。）をエクセルで開けばいいのかと思ったのですが、 一度試しにやってみたときは、テーブルの選択画面などが出てきたのですが、 次に再度やってみると全く無反応な状況です。 何となく排他制御が掛かってしまったようなのですが、それすらもよく分かりません。 ちなみに、作成されているmdbを開くと、accessが起動し、ログイン的なフォームが開き、 まず最初にパスワード（これもVBAで作成されているパスワードなのかもしれないのかな）を たずねるフォームが開いてきます。 そのパスワードは分かっているので、すぐにエクセルに取り込めると思っていたのですが、 全然できません。 oracle等だとDBはDBだけで存在していると認識しているので、 なんだかaccessはとっつき難いです。 取りとめもない質問で申し訳ないのですが、 聞きたいことを集約します。 まず、mdbを立ち上げてからフォーム画面で確認されるパスワードは何なのか？ また、そのパスワードとmdbをエクセルから開いたときに尋ねられるパスワードとは何か関係があるのか？ 最終的には、mdbからデータベースだけ取り込むことができればいいのですが、 どなたかアドバイスお願いします。
SQLでテーブルの値を更新するのに他のフィールドの値を 条件にするにはどうしたらよいのでしょうか。 具体例を挙げると次のようなマスタとテーブルがあった場合、 テーブルAの「ID2」フィールドに同テーブルのF1とF2をキーに マスタMから検索した「ID1」の値を入れたいですが。 ■マスタM ID1 / F1 / F2 1 / A / 10 2 / A / 20 3 / B / 10 ■テーブルA ID1 / ID2 / F1 / F2 1 / / A / 20 2 / / B / 10 3 / / A / 10 ■試したSQL update A set ID2=(select ID1 from M where M.F1=F1 and M.F2=F2) よろしくお願いします
こんにちは。 ACCESSについての質問です。 基本的にマクロを中心に使っています。VBAは現在勉強中ですから、 VBA初心者でも分かりやすく説明していただけると助かります。 会員の情報の一覧表をフォームで表示しております。 ほとんどの情報は、ACCESSで作ってますが、一部会員から送ってもらうEXCELがあります。 会員情報フォームの中にボタンを作り、そのボタンを押せば、その会員の作ったEXCELを 開けるようにしたいのです。 会員ID毎に会員IDの名前のフォルダを作り,そこにEXCELを入れています。 例えば、 会員IDが"1"の人のEXCELが”Ｃ”の中の"1"というフォルダの中にある"業務内容.xls" 会員IDは"2"の人のEXCELが”Ｃ”の中の"２"というフォルダの中にある"業務内容.xls" ・・・ という感じです。 会員情報の一覧フォームのあるフィールドにEXCELの場所と名前を入れています。 そのフィールドに入った値を使って、EXCELを開くことはできないでしょうか? 会員IDが１の場合、フィールドには、"c:\1\業務内容.XLS" 会員IDが2の場合、フィールドには、"c:\2\業務内容.XLS" という値が入れています。 EXCELの場所と名前が固定であれば、マクロのアプリケーションの実行のコマンドラインを使って、 簡単に開けることはできますし、会員が少人数であれば、IFを使って作ることが出来ますが、 VBAならEXCELのファイル名にフォームのフィールドの値を使って開けれるのではないかと。 VBAの本で調べたり、ネットで調べましたが、分かりませんでした。 初めて質問させていただくので、説明がうまくできず、申し訳ありません。 どうぞ、よろしくお願いいたします。
postgresqlにて 「delete a from aa as a left outer join bb as b on a.id = b.id where b.sd = 2 and a.dd = b.dd and a.fd = 1」 こういったクエリでDB_errorが出ます 「delete a」を「select *」にすると 欲しい結果が出ます usingも試しましたが駄目でした inとサブクエリならいけました join句では無理なのでしょうか？ 調べた限りではいけるはずなのですが…
日付の月と区分でグループ化して 月の最終日データの値を取得したいのですが どうすればいいのでしょうか？ 値は必ずしもMAXとは限らないのです。 よくわかっていないのですが サブクエリとかを使用すればできるんでしょうか？ 日付,区分,値 2015-01-01,1,2500 2015-01-02,1,2700 2015-02-01,1,3200 2015-02-02,1,700 2015-01-01,2,750 2015-01-03,2,800 2015-02-01,2,1100 2015-02-02,2,1300 データが上記なら 2015-01,1,2700 2015-02,1,700 2015-01,2,800 2015-02,2,1300 と取得する方法です。 よろしくお願いします。
SQLについて教えてください。 あるテーブルから条件を指定して出したい時に例えば、除外したい場合に、 条件句で 「終了日が今日より前」としたい時は、 どのようなSQL文をたたけば良いのでしょうか。 また、終了日（END_DATE）が無期限の場合はNULLも設定されているため、 「NULLの場合は9999/12/31とする」 といった感じで置換処理した上で除外条件を適用して下さい。と助言して頂いたのですが、どのようなSQL文にすれば良いのかよくわかりません。。。 置換処理して除外条件を適用？こちらはどのようなSQL文で出す事ができますか？教えてください(´・c_・`) SQLは勉強中で初心者なので、誰か詳しい方がおりましたら教えて頂けないでしょうか。宜しくお願い致します。
この問題はどのようにして考えたら良いのでしょうか？ SQL文に関しては無知ですので、わかりやすく解説していただけるとありがたいです... ちなみに解答は④でした。 よろしくお願いいたします。
13歳のハローワークという本に風俗嬢はのっていないのですが、務めるにあたり必要な人間性と能力があれば教えてください。
初めて質問をしますので、質問の仕方が悪ければ指摘してください。 共通の項目を持つ複数行のデータを1列のデータに横展開をする方法を教えてください。 wordの差し込み印刷に使うデータを生成したいのです。 例 H1　D1 H1　D2 H1　D3 H2　D1 H3　D1 H3　D2 を H1　D1　D2　D3 H2　D1 H3　D1　D2 に変換 Hn、Dn共複数セルで構成されています excelの操作又はVBAでも結構です 但しVBAは初心者です
教則本のブログ作成より応用してSNSを作るために自分でデータベースを作成していましたが、素人なので、気づけば汚いデータ構造で、非効率なテーブルになっています。正規化に関する参考書籍を読みましたが、概要は理解できるものの、それを実際に使うとなると、どう応用すればベストな状態になるのかが分かりません。そこで、成り行きできなく、あらかじめ SNSを作成するにあたって必要なテーブルをあらかじめ作成しようと思いますが、一般的に、どのような構造にすることが望ましいでしょうか。 参考となるような、必須テーブル(内部のカラムの詳細等)と、テーブル同士の関連がわかるような内部設計がわかるような解説サイトがありましたら教えてください。(書籍等も) または、テクニックなど豆知識てきなものでもありましたら教えてください。
phpMyAdmin にログインできません。 ユーザー名 : root パスワード : password でログインしようとすると、 #1045 MySQL サーバにログインできません とでます。 MySql 5.6 phpMyAdmin 4.4.14.1-all-languages よろしくお願いします。
３つのテーブルを結合（INNDR JOIN）している状態で重複するデータを無くしたいです。 [テーブルの種類とカラム内容] posts(id,name) categories_posts(id,post_id,category_id) categories(id,name) [現在作成しているSQL文] SELECT * FROM categories_posts INNER JOIN potsts ON categories_posts.post_id = posts.id INNER JOIN categories ON categories_posts.category_id = categories.id; 1つのpostsに複数のcategoryが登録されている場合、postsのデータが重複して取り出されるので、重複するpostsを１つにまとめたい。 GROUP BY を使うというのはいろいろと調べてみてわかりました。自分で実験してみましたが、エラーになってしまいます。 1.postsとcategoriesの関連をcategories_postsというテーブルで管理しています。これらのテーブルをつなげるには上記に記載したSQL文で良いか？（データは取得できていますが記載するテーブルの順番など、これで良いのか？） 2.GROUP BYを使うときに GROUP BY posts.id か　GROUP BY categories_posts.post.idのどちらを使えば良いか？また、上記のSQL文のどこに記載したら良いか？ ご回答よろしくお願い致します。
Windows8.1 を使っています。microsoft認証でログオンしていますが、サーバー接続で「ログインできませんでした。このログインは信頼されていないドメインからのログインなので、Windows 認証では使用できません。」が状態が続いています。コントロールパネルから資格認証しているのですがうまくつながりません。 調べてみると「http://blogs.technet.com/b/jpntsblog/archive/201 …」のサイトがあり、「回避策」の前に 「Active Directory ドメイン環境では、Microsoft アカウントでログオンするように構成できませんので、特に心配する必要はありません。」 とありますが、これは、Active Directory 使用下のサーバーでは接続不可？という意味なのでしょうか？ 他のWindows7やWindows8.1(マイクロソフトアカウントでなくウインドウスアカウントで構成)のパソコンからは問題なく接続できています。 よろしくお願いします。
下記のようなテーブルがある場合にSQL文を書くとき、 id | aaa | bbb | ccc 1 AAA BBB CCC 2 AAB BBB CCD 項目aaaとbbbを検索対象とした場合 Where aaa=AAA and bbb=BBB となると思いますが、 この項目aaa,bbb,cccの中から、ユーザが入力した項目のみ検索対象としたい場合にどのように記述すればよいのでしょうか？ 現状では、下記のようにphpでaaa,bbb,ccc項目のどこに条件が入力されているかで、ifで分けして複数のＳＱＬ文を書いていますが、どうにか１つのＳＱＬでスマートにできませんか？ if aaa !="" and bbb = "" and ccc ="" then select * from table where aaa = *** elseif aaa !="" and bbb !="" and ccc="" then select * from table where aaa = *** and bbb=*** end
Accessの更新クエリを使って以下のことをやりたいです。 実現できる方法を教えてください。 ＜クエリでやりたいこと＞ ・ある行の中で、1つでも同じ文字があった場合、判定列にフラグ（1）が立つ。 ・そうでない場合にはブランクのまま。 ・イメージ図を添付致しましたので、あわせてご覧ください。
Xamppをインストールして、MySQLの文字コードをシフトJISにする為、my.iniファイルを開いて、次の様に設定しました。 [mysqld] #bind-address="127.0.0.1" character-set-server=cp932←追加した skip-character-set-client-handshake←追加した 二箇所追加してMySQLを再起動させたら、エラーが表示されて再起動がされなかった。 どうすればいい？ なお、この設定は「基礎からのMySQL」の本に記されたものです XAMPP1.8.3（MySQL5.6）を使っています。
まずは実行したいddl insert into tb_A (col_a,col_b,col_c,col_d,col_e,col_f,col_g,col_h) values ((select col_a from tb_B),col_b,col_c,col_d,col_e,col_f,col_g,col_h) col_aは複数あります。col_b〜hは値を直接指定でinsertしたいのですが、 エラー: Subquery returns more than 1 row 一件しか返せない？となります。 複数行一括でinsertするにはどうすればいいでしょうか。
まったくの初心者ですが、どうしてもWPを使いたいので対処法を教えて頂けると助かります。どうぞよろしくお願いします！勉強する気はあるので、書籍等おすすめがあったら教えてもらえると嬉しいです。 【環境】 WordPress のバージョン: 4.2.4 使用しているプラグインとテーマの情報(名称、入手先 URL、バージョン)　Twenty Fourteen. PHP、MySQL のバージョン: 5.5 サーバー環境: Xserver ブラウザとそのバージョン：　Safari バージョン 6.2.3、Firefox40.0.2 【問題】 Xserverを使用しています。自動インストールでWordPressをインストール後、WPで投稿をかきあげ公開したのですが、サイトでは「このウェブスペースへは、まだホームページがアップロードされていません」と出てしまいます。 超初心者用などのサイトを見て、インストールしました。SQLは自動生成しました。（ただ不安なのは、xserverで自動インストールをしましたが、「wp-config.php」については自動インストールの場合は必要ないのかと思い、行っていません。一応、miをダウンロードして、WordPressのフォルダーに入っていたwp-config.phpのサンプル等を読んだのですが、どうすれば良いのか分からず挫折しています。 【行った事】 ・http://itwebkatu.com/xserver_no_upload/　等の記事を見たので、index.htmlを消そうとしましたが… 1)public.htmlの直ぐ中に入っているindex.htmlを消したところ、403が出るようになりました。 2)public.html＞wpの中には、index.phpのみなので、どこを消せば良いのか分かりません。 ・ドメインを初期化、WordPressをアンインストールし、さらにインストールしましたが、変わりません。 ・SQLももう一度設定し直したり、再度自動生成したりしましたが、うまくいきません。
mysql> select * from rellist; +-----------------+------------+---------------------+---------------------+ | peerId | roomId | modified | created | +-----------------+------------+---------------------+---------------------+ | 3EQBWrqHnikWkTo | TNhIxdEKn | 2015-08-13 21:07:02 | 2015-08-13 21:07:02 | | 7hQ6qGmjh3TEiBd | pOJGAaVWzr | 2015-08-13 20:57:55 | 2015-08-13 20:57:55 | | 9cykwLPXvobT2zi | TNhIxdEKn | 2015-08-13 21:07:48 | 2015-08-13 21:07:48 | | DTYr97cO6dNW7CB | pOJGAaVWzr | 2015-08-13 20:55:34 | 2015-08-13 20:55:34 | | lBzkYuPMjnXoUq2 | 7fXXpUreG1 | 2015-08-13 21:06:13 | 2015-08-13 21:06:13 | | li0NspvzwnkRDRs | pOJGAaVWzr | 2015-08-13 20:55:26 | 2015-08-13 20:55:26 | | UNEFHZvKpgRnBt4 | TNhIxdEKn | 2015-08-13 21:07:10 | 2015-08-13 21:07:10 | | Vfzwwx653bEoVUw | 7fXXpUreG1 | 2015-08-13 21:06:20 | 2015-08-13 21:06:20 | +-----------------+------------+---------------------+---------------------+ 8 rows in set (0.00 sec) mysql> select * from peerslist; +-----------------+-----------------------+---------------------+---------------------+ | peerId | email | modified | created | +-----------------+-----------------------+---------------------+---------------------+ | 3EQBWrqHnikWkTo | main@gmail.com | 2015-08-13 21:07:02 | 2015-08-13 21:07:02 | | 7hQ6qGmjh3TEiBd | aaa@gmail.com | 2015-08-13 20:57:55 | 2015-08-13 20:57:55 | | 9cykwLPXvobT2zi | aaa@gmail.com | 2015-08-13 21:07:48 | 2015-08-13 21:07:48 | | DTYr97cO6dNW7CB | bbb@gmail.com | 2015-08-13 20:55:34 | 2015-08-13 20:55:34 | | lBzkYuPMjnXoUq2 | main@gmail.com | 2015-08-13 21:06:13 | 2015-08-13 21:06:13 | | li0NspvzwnkRDRs | main@gmail.com | 2015-08-13 20:55:26 | 2015-08-13 20:55:26 | | UNEFHZvKpgRnBt4 | bbb@gmail.com | 2015-08-13 21:07:10 | 2015-08-13 21:07:10 | | Vfzwwx653bEoVUw | bbb@gmail.com | 2015-08-13 21:06:20 | 2015-08-13 21:06:20 | +-----------------+-----------------------+---------------------+---------------------+ のようなテーブルがあります。 bbb@gmail.comが存在するRoomIDのメンバ一覧を全て取得したいのですが、どのように実施すればよいかご教授願います。 ちなみに以下でやりましたが、当然うまくいきませんでした。。。 (原因はわかりますが、どのように修正すべきかがわかりません。よろしくお願いします。) SELECT b.peerId,b.email,a.roomId FROM rellist a INNER JOIN peerslist b ON a.peerId = b.peerId WHERE b.email="bbb@gmail.com" ORDER BY a.CREATED DESC; SELECT b.peerId,b.email,a.roomId FROM rellist a INNER JOIN peerslist b ON a.peerId = b.peerId WHERE a.roomId =(SELECT b.roomId FROM peerslist a, rellist b WHERE a.email="bbb@gmail.com" AND a.peerId = b.peerId ORDER BY b.CREATED DESC);
[親テーブル] create table example( number int unsigned auto_increment not null primary key, ： ); [親テーブルに紐づくチェックボックス用テーブル] create table example_checkbox( example_number int unsigned not null, ： ); numberとexample_numberで繋がっているのですが、チェックボックス用テーブルには、 チェックボックスにチェックされたIDが累積して格納されております。 本来ならばexampleテーブルに正規化して持たせたかったのですが、チェックボックス の数は可変するため、別テーブルにしております。 exampleテーブルの一覧を出す際に、example_checkboxで指定されたIDがあるか（チェック されているか否か）の条件を入れたいのですが、exampleとexample_checkboxは1対多で あるため、joinを使うとexample_checkboxの数分結果が返ってきてしまうものと想定して おりますが、何かうまいやり方はないものでしょうか。 アドバイスいただければ幸いです。
xamppのmysqlのパスワードを設定するにはどうすればいいのですか? Apacheの横のadminをおしてもwelcome to xamppと表示されるだけです。
お世話になります。 フォーム(Main)から、レポートのラベルを非表示させる時についてご指導下さい。 フォームから、DoCmd.OpenReport "印刷レポート"　を起動します。 印刷レポートの中にある承認ラベルを非表示にしたいのですが、どのように指定 すれば可能でしょうか レポート自身からなら、Me!承認.Visible = False で良いのですが、 フォームからの指定方法が不明で困っております。 下記で試したのですが、だめでした。構文を教えて頂けないでしょうか Reports("印刷レポート").承認.Visible = false Reports![印刷レポート].承認..Visible = false お忙しいとは思いますが宜しくお願い致します。
お世話になります。 MySQLで　テーブル名：table_abc 内に　カラム名：member_no　で数字が10桁と11桁の番号としてデータが格納されているのですが カラム名：member_no　の11桁の値の　先頭数字に 0 が付いて始まっているので その11桁の先頭数字０をとり、10桁にしたいのですがどのようにSQL文を書けばよろしいでしょうか？ ちなみにもとからある10桁の値の方は、0以外の数字から始まっています。 （データベースへはphpMYadminからアクセスしています。） 猛暑の中、恐縮ですが　御教示頂ければ幸いです。
職場でCDS-630Rという装置を使用しています。 フロアが違う場所に何台ずつかあります。 異常や加工終了した際に、どうしてもフロアが違うということで、解除が遅れたりして困っています。 そこで質問なんですが、装置に何かしらのユニットを追加し、無線で信号を飛ばしお互いのフロアにタッチパネルみたいな集中制御盤みたいなのを用意し、アラームを鳴らしてどっちのフロアにいてもわかるようなアラートシステムを作成することは可能でしょうか？可能でしたらどんなものが良いか教えてください。 何度か質問するかもしれないので返信も確認していただけると幸いです。
こちらに届いたかどうか確認できなかったメールを再送信してもらいました。 メール本文にある日時は相手の方の言う通りなのですが誤魔化せることなので、 ヘッダーで探したいのですが、どこに元々送信された日時があるのか分かりません。 いくつかある自分のメールでも試してみたのですが、サーバーによって表示の仕方が違うのか 良く分かりませんでした。どうにか分かる方法ありませんか？
MySQL のJavaです。 パラメータに、iPara_food_idとiPara_kind_idを与え、 １）comment_textが、null か、空っぽで、 ２）limit_date が最大、 ３）のレコードを１件抽出したいのですが、 String strSQL = "SELECT record_id, color_id FROM foods" + " WHERE" + " (food_id = " + 123455/*iPara_food_id*/ + ")" + " AND (kind_id = " + 1545334/*iPara_kind_id*/ + ")" + " AND (comment_text IS NULL) OR (LENGTH(comment_text) = 0)" + " AND (delete_flag = false)" + " ORDER BY limit_date DESC" + " LIMIT 1"; テーブルとソースを何度も見直したり、 値を変更してみたり、 パラメータの値を変更してみたり、 したのですが、 パラメータに、iPara_food_idとiPara_kind_id。 何を与えても、同じレコードを抽出してきます。 それは、３０件ほどのレコードの中で、 日付が途中くらいのもので、comment_text が空の ものです。 comment_textが空のレコードは、 ２件あるのですが、 固定で抽出してくるレコードは、 日付の大きいほうです。 なぜ、パラメータが聞かないのでしょうか？ ※上記、思い切って、むちゃくちゃな、数値を 　指定していますが、それでも、同じレコードを 　抽出してきます。
MySQLをJAVAで使っています。 指定キーの中で、一番日付の大きなレコード項目全てを 取り出したいのですが、 下記SQLだと、何も抽出されません。 何が間違っているのでしょうか？ さらに、もっと簡単なSQL文はないでしょうか？ SELECT * FROM food WHERE (food_id = 1) AND (food_name = 'みかん') AND (food_id = (SELECT MAX(date) FROM food WHERE (food_id = 1) AND (food_name = 'みかん'))) 与える検索キー項目は、food_id=1, food_name=みかん foodテーブル例 food_id　　food_name　　　date --------------------------------- 1　　　　　みかん　　　　2015-01-01 1　　　　　みかん　　　　2015-02-01 1　　　　　みかん　　　　null 1　　　　　みかん　　　　2015-04-01 2　　　　　きんめだい　　2015-01-01 2　　　　　じんたん　　　2015-02-01 2　　　　　コロッケ　　　2015-02-01
MySQLのON DUPLICATE KEY UPでエラーもでずに、 更新や新規作成もされない。 MySQLで、ON DUPLICATE KEY UPDATE を初めて使っています。 ところが、レコードが更新や作成されなくて困っています。 具体的には、下記のようなSQL文ですが、 どこがわるいのでしょうか？ String strSQL = "INSERT INTO interview_patient_modoule (" + "aaa"　・・・複合キー +",bbb"　・・・複合キー +",ccc" +",ddd" 　・・・複合キー +",eee" + ")" + " VALUES (" + "1" + ",2" + ",3" + ",4" + ",5" + ")" + "ON DUPLICATE KEY UPDATE" + "aaa = 1"　・・・複合キー +",bbb = 2"　・・・複合キー +",ddd = 3"; 　・・・複合キー // SQLの実行 dbStatement.execute(strSQL);
MySQLのON DUPLICATE KEY UPでエラーもでずに、 更新や新規作成もされない。 MySQLで、ON DUPLICATE KEY UPDATE を初めて使っています。 ところが、レコードが更新や作成されなくて困っています。 具体的には、下記のようなSQL文ですが、 どこがわるいのでしょうか？ String strSQL = "INSERT INTO interview_patient_modoule (" + "aaa"　・・・複合キー +",bbb"　・・・複合キー +",ccc" +",ddd" 　・・・複合キー +",eee" + ")" + " VALUES (" + "1" + "2" + "3" + "4" + "5" + ")" + "ON DUPLICATE KEY UPDATE" + "aaa = 1"　・・・複合キー +",bbb = 2"　・・・複合キー +",ddd = 3"; 　・・・複合キー // SQLの実行 dbStatement.execute(strSQL);
MySQLです。 既にレコードがあるか、ないか、不明な状態で、 同じキーのレコードを書き込みたいのですが、 事前にレコードの有無を確認せずに、UPDATE or INSERTする方法は、 ありますか？ レコードをユニークにするキーは、３つあります。
MySQLです。 商品IDと販売先、管理番号が、判明しているとき、 最大商品IDとそのレコードを取得するには、 どのようなSQLを書けば、よろしいでしょうか？ select *, ？ from SYOUHIN WHERE ???? テーブル例） ↓ユニーク 商品ID　販売先　管理番号　 販売日 1　　　A社　　　1　　　　　2015-07-10 2　　　A社　　　2　　　　　2015-07-12 3　　　B社　　　1　　　　　2015-06-30 4　　　B社　　　2　　　　　2015-07-06 5　　　C社　　　1　　　　　2015-04-21
MySQLを使っています。 同じ商品のレコードが複数あります。 その多数のレコード中に、日付項目があります。そこから、 １）指定日に、２）一番近い過去の日の１件の、３）全商品のレコード、を抽出するには、 どのようなSQL文を書けばよいでしょうか？ １．過去に複数ある日付の中から、指定日に、一番近いレコード。 レコードの例） 指定日＝2015-07-01 商品ID 日付 1 2015-10-11 ・・・未来 ⇒ 抽出せず 1 2015-08-02 ・・・未来 ⇒ 抽出せず 1 2015-07-01 ・・・指定日 ⇒ 抽出せず 1 2015-07-01 ・・・指定日 ⇒ 抽出せず 1 2014-01-01 ・・・過去 ⇒ 抽出せず 1 2015-06-03 ・・・過去 ⇒ 抽出したい★★ 2 2015-10-11 ・・・未来 ⇒ 抽出せず 2 2015-08-02 ・・・未来 ⇒ 抽出せず 2 2015-07-01 ・・・指定日 ⇒ 抽出せず 2 2014-01-01 ・・・過去 ⇒ 抽出せず 2 2015-06-03 ・・・過去 ⇒ 抽出したい ★★
商品テーブルの中で、 同じ商品のレコードが複数あります。 その多数のレコード中に、日付項目があります。 そこから、 １）指定日に、２）一番近い過去の日の１件、３）指定日を含めて、複数ある指定日及び未来の全レコード、を抽出するには、 どのようなSQL文を書けばよいでしょうか？ １．過去に複数ある日付の中から、指定日に、一番近いレコード。 ２．指定日と未来に複数ある日付の中の、全ての未来の、レコード。 レコードの例） 指定日＝2015-07-01 商品ID 日付 1 2015-10-11 ・・・未来 ⇒ 抽出したい 1 2015-08-02 ・・・未来 ⇒ 抽出したい 1 2015-07-01 ・・・指定日 ⇒ 抽出したい 1 2015-07-01 ・・・指定日 ⇒ 抽出したい 1 2014-01-01 ・・・過去 ⇒ 抽出しない★ 1 2015-06-03 ・・・過去 ⇒ 抽出したい 2 2015-10-11 ・・・未来 ⇒ 抽出したい 2 2015-08-02 ・・・未来 ⇒ 抽出したい 2 2015-07-01 ・・・指定日 ⇒ 抽出したい 2 2015-07-01 ・・・指定日 ⇒ 抽出したい 2 2014-01-01 ・・・過去 ⇒ 抽出しない★ 2 2015-06-03 ・・・過去 ⇒ 抽出したい
単純復旧モデルでは、データベースのバックアップを取得するとトランザクションログが切り捨てられるという認識で合っていますでしょうか？ また、ランザクションログが切り捨て方法は下のコマンドで合っていますでしょうか？ 　・dbcc shrinkfile(X,TRUNCATEONLY) or 　・BACKUP DATABASE (DB) TO DISK = 'NUL' トランザクションログの増大で、ディスク圧迫しているので対策を検討しています。
Access2013です。 レポートにて、最終集計ではなく、8行ごとに（8レコードごと）に集計を出したいのですが、どうしたら実現できますか？ 8行ごとに8行分の集計を繰り返し、最後は8行で割り切れない場合は、8行に満たない行数での集計になる事もあります。 実現方法を教えてください。 宜しくお願いします。
ACCESSでシステムを作成(簡単な画面は依頼者が作成しました。)しているのですが、全ての動作をVBAで作成するように依頼されました。 そこで、会員番号(テキストボックス)に数値が入力されたら、テーブルレコードを呼び出し、 それぞれのテキストボックスに入れるVBAプログラムを教えてください。 なお、クエリ、マクロの使用は禁止です。 使用パソコン：Windows8.1 使用ソフト：ACCESS2010
SQL Server 2005 Express Editionを使用しています。 データベースは単純復旧モデルなのですが、トランザクション ログがすぐ満杯になり、9002 エラーが発行され、困っています。データベース、トランザクション ログ共にバックアップは取っていません。自動拡張もしていません。 ネットで調べると、単純復旧モデルは自動的にトランザクション ログを切り捨てるので、ログの肥大化を心配する必要はないと書いてあります。なぜ満杯になるのか不明。 （圧縮される量よりも、ログが貯まる量のほうが多い？） トランザクションログは、ログ領域を5GBにしているのに1時間程度で満杯になり、9002 エラーが発行され困っています。 対策としては、ジョブでDBCC SHRINKFILEを定期的に発行して、トランザクション ログを削除する 案を考えていますが、イレギュラーな気がしています。他にもっといい対策案（簡単、確実）はないでしょうか？
ACCESS2013 VBA REPORTを出力するとき、文字列がテキストボックスに入りきらない時自動拡張する設定にしているテキストボックスがあります。その時、他のテキストボックスも一緒の高さにしたいのですが、これはどうすれば良いでしょうか？ ご教授お願いしますだ
テキストボックスに有効期限年月日が入っていますが、今日の日付からその有効期限までの日数が30を切ると背景色を赤くしたいです。どのような仕方がありますでしょうか。
VBでADOを使用してMDBに接続しています。 FILTERプロパティで絞り込みの際、対象の文字列を変数hogeにセットして以下のように記述しています。 rs.Filter="名称 ='" & hoge & "'" この時、変数hogeにシングルクォート「'」が含まれているとエラーとなってしまいます。 FILTERプロパティでシングルクォートを含む文字列を検索したい場合、どのように記述すれば良いでしょうか？
Access2013のデータベースに、エクセル2013から数万件のデータを取り込みました。 主キーの重複エラーになりましたが、この修復数が結構多く、どのようにして解決しようかと考えています。数が多くて、そのデータの詳細をみて修正するのも時間がかかります。 枝番をつけることも考えていますが、基本的にこの主キーで重複しては良くないと考えています。なぜなら、全ての収益関係の金額が入っていますから。修正した場合の履歴を残すという意味では有りかと思いますが・・・ 枝番をつけても、2項目で主キーにするとアクセスは速度が遅くなると思いますし、インポートする場合に、やりにくいのではないかとも思います。 良い解決策をご存知の方、アドバイスをよろしくお願いします。
MySQLの容量の削減の仕方 Media Wikiをしていたら気付かないうちに 数日間で大量のスパムが来て、 MySQLデータベースが肥大化しました。 またそのためサイト全体にもパフォーマンスが 落ちてきました。 サイト上から直接のログは消したものの DBの容量の削減手順や方法が調べても はっきりと理解できたか不安です。 知っている方いたらわかりやすく 教えて頂けると助かります。 よろしくお願いします。
下記を満たすSQLを教えていただけますでしょうか。 データベースタイプはオラクルとなっております。 今入力値として、入力１：SY番号 , 入力2 : 出力数 があるものとします。 ここでは説明のため、仮にSY番号が"sy1" 出力数が"1"とします。 ロジック１：テーブルAから入力１にヒットするSE番号を取得 (例：se1取得) 【テーブルA】 SY番号、SE番号 　sy1 、se1 sy2 、se2 sy3 、se3 ロジック２：テーブルBからロジック1で取得したSE番号に対応したZU番号を取得 (例：zu1取得) 【テーブルB】 SE番号、ZU番号 se1 、zu1 se2 、zu1 se3 、zu1 se4 、zu2 se5 、zu2 se6 、zu2 ロジック３：テーブルCからロジック１で取得したSE番号に対応したDTを取得 (例：1/3 10:10:12) 【テーブルC】 SE番号、DT se3 、1/1 10:10:10 se2 、1/2 10:10:11 se1 、1/3 10:10:12 se5 、1/4 10:10:13 se4 、1/5 10:10:14 se6 、1/6 10:10:15 ロジック4：テーブルBからロジック２で取得したZU番号に対応した全SE番号を取得 (例：se1,se2,se3を取得) 【テーブルB】 SE番号、ZU番号 se1 、zu1 se2 、zu1 se3 、zu1 se4 、zu2 se5 、zu2 se6 、zu2 ロジック５：テーブルCからロジック４で取得した各SE番号に対応したDTを取得 (例：1/1 10:10:10,1/2 10:10:11,1/3 10:10:12を取得) 【テーブルC】 SE番号、DT se3 、1/1 10:10:10 se2 、1/2 10:10:11 se1 、1/3 10:10:12 se5 、1/4 10:10:13 se4 、1/5 10:10:14 se6 、1/6 10:10:15 ロジック6：ロジック５で取得した各DTをロジック３で取得したDTを基準にしてそれよりも 　　　　　 前の日時の各DTを取得する。 (例：1/1 10:10:10,1/2 10:10:11取得) ロジック７：ロジック６で取得した各DTを昇順でソートする。 (例：1/1 10:10:10,1/2 10:10:11) ロジック８：ロジック７でソートした各DTの中から、ロジック３で取得したDTから近い順に 　　　　　　見て、入力２の出力数の数だけ選択及び取得する (例：1/2 10:10:11を取得) ロジック９：ロジック８で取得した各DTに紐付いたSE番号をテーブルCより取得 (例：SE2を取得) かなり丁寧にロジックを書いておりますが、効率よくまとめてSQLを記述するとなると、 おそらくですがどこかのロジックは短縮又は不要になったりするかとおもいます。 その辺りを含めまして最も効率よく一度のSQL文だけでSELECTできるSELECT文を記述して 教えていただけますでしょうか。 おそらくサブクエリを使用すると思いますが、サブクエリ数も最低限の数だけ使用するなど工夫を いただけると幸いです。 以上、宜しくお願い致します。
システムの改修で今まで物理消去する挙動をしていた項目を 論理消去として消去フラグを立てて実際のデータは残すという変更を したいです データベースはSQLserverです つまり今までdaleatしていたところをupdateで消去フラグを立てるのだと 思いますが プログラミングを学び始めたばかりで 具体的にどの文をどう変更すればいいのかイメージがわきません 消去フラグを立てるということは データの受け取り側にもそのための処理を加えないといけませんよね？ VS2005でASP.net、C#を使ってWebアプリをSQLと連携させています 現在はTransaction-SQLについて調べながらという感じです 抽象的な質問になってしまっているかと思いますが システム開発関係者の方にご意見伺いたいと思いますので よろしくお願いします。
データベースについて、できるのかどうかも含めて全く見当がつかないので教えてください。Accessみたいにと書きましたが、現在はFileMakerを使っています。AccessやFMの場合、レコードを移動した瞬間にそれまで入力していた内容がUPDATEされると思います。Windows Form に SQLSERVERという環境で、そういうことはできるのでしょうか？
社内システムをPHP＆MYSQLで構築しています。 現在、MYSQLの文字列削除に頭を悩まされており、ここで質問させていただきました。 テーブル名：sampleTbl ID　rlist 45　6,455,121,898,742,45 46　556,55,11,189,72,325 47　46,45,1321,2,742,33 48　46,455,121,32,742,4788 49　476,423,111,828,106,46 50　556,433,141,888,211,45 現在、このようなテーブルがあり、レコード数は1万を超えます。 例えば「rlist」に含まれる「72、6、45、106、211、2」を削除したいと考えています。 replaceを検討しましたが、削除する文字列が動的に変わるため、replaceだと削除する文字列が多くなるほどSQL発行が多くなってしまいます。 何か良い方法はないでしょうか。よろしくお願いいたします。
文字列長を調べる関数として、Web上で“char_length”という関数を見つけ、早速使ってみました。 紹介ページでは、全角も半角も1文字は1という結果が返って来ると書かれています。 しかし私の場合、そんな結果が返って来ません。 名簿テーブル（UTF-8）の姓カラム（UTF-8）に漢字名（UTF-8）が入っており、ここにchar_length関数を使うと、漢字2文字なら6、3文字なら9という結果が返って来ます。 Web上で説明されているような、2や3という結果は一つも返って来ません。 半角1文字（UTF-8）ならちゃんと1で返って来るのですが、全角1文字（UTF-8）は3と返って来るようです。 使用環境やバージョンによるものかな、と思って調べてみたのですが、そういった情報は発見できませんでした（むしろ、自分より古いバージョンのMySQLでも正常結果が返って来ている例も発見したりして・・・） どこか設定の問題でしょうか？ 対処法があれば教えてください。 宜しくお願いします。 Windows XP Pro SP3 MｙSQL 5.1.30
大変恐縮ながら質問させていただきます。 ストアド(postgresSQL)にて、シーケンス名(SEQ_NO_XXXXXXX)がなければその名前のシーケンスを作成するという機能を実装しております。 ここで、『シーケンス名(SEQ_NO_XXXXXXX)がなければ』の条件がうまく設定できておりません。 googleなどを活用して数日間考えておりましたが、分からず…。 申し訳ありませんが、教えてはいただけないでしょうか。
プログラムに無知の者で言っている事が通じてなかったらすみません。dBXL dBASEIII？のプログラムを使用しているのですが、お詳しい方を探しています。今迄使用していたプログラムがエラーで動かなくなってしまいました。おそらくdbfファイルの読み込みで引っかかっている様ですが、是非とも相談に乗っていただきたいのです。ネットで調べてみたのですが古いプログラムのせいなのか、どちらのサイトも古く、連絡が取れそうな人が見つかりません。身近にいたプログラムを組んだ人間が亡くなってしまいお手上げです。マニュアルも見つかりません。お詳しい方を探すアイディアがあればご教授願います。
環境はMySQL5.5です。 学習問題ソフトを2つのテーブルで作っています。 1つ目のテーブル名はquestionsで id, mondai, kotaeで 問題文と答えが入ってます。 2つ目のテーブル名はquestion_historiesで id, questions_id, is_correctで 1つ問題を解くごとにquestionsのidと正解・不正解のbool値をいれていきます。 やりたいことは 「questions.id, questions.mondai, 正解率(この問題の正解数/この問題と解いた回数*100)」 を出したいと思います。 どんなSQLを書けばいいか教えてくださいｍ（＊＿＿）ｍ
MT_受付一覧と、MT_キャンセルがあります。お互いに主キーはお客様IDです。 お客様IDで、リレーションを組んでいます。 そのMT_成績の欄に結果というフィールドがあります。 クエリで、Q_キャンセルを作成しました。 Q_キャンセルの結果をMT_受付一覧に反映させたいのですが、追加クエリを使うのか、更新クエリを使うのか そもそも、やり方が違うのか分かりません。 ACCESSは2010を利用してます。 追加クエリを使うと、型が一致しません。 更新クエリを使うと、1つ以上のフィールドが必要です。 上記のようなエラーがでます。 書籍に記載されている、アクションクエリに関しては、一応できるのですが、 たぶん、応用ができていないと思うのです。 ユニオンクエリかなと思って、チャレンジしましたが、できませんでした。 お手数ですが、ご教授お願いします。
課題でSQLServerに対するSQLを作成しています。 例えば次のようなテーブルがあるとします。 NO | NAME | ------------- 1 | AAA | 2 | BBB | 3 | CCC | 例えば条件でNoが「1,3,5」というものが与えられたとき、 該当するレコードが１つもない「5」という条件だけを絞り出したい時はどうすればいいのでしょうか。 上記の例だと目視でもわかりますが レコード数が多い時に調べたいので困っています。
以下の様な3カラム（room,reservation,daytime）のデータがあったときの解析方法を教えていただきたいです。 room reservation daytime 1 空き 2015-05-01 1 空き 2015-05-02 2 予約 2015-05-01 2 予約 2015-05-02 1 予約 2015-06-01 1 空き 2015-06-02 2 予約 2015-06-01 2 予約 2015-06-02 ホテルの予約状況を想定して、各月の部屋毎の合計予約数を出したいです。 上記の例であれば、以下の様な結果 2015年５月　room1の予約数 0 2015年５月　room2の予約数 2 2015年６月　room1の予約数 1 2015年６月　room2の予約数 2 よろしくお願いします。
ACCESS初心者です。 ACCESSのVBAでCSV取込をしようとしていますが、 うまくいきません。 CSVとテーブルの項目の場所が違ったりオートナンバーが設定されていたりしているので、 そこのところが全くわかりません。 いろいろ調べて試しましたが、うまくいがず行き詰っています。 VBAでなくてもクエリやマクロといったやり方でもいいので、 教えてください。 ------------------------------------------------------------------- VBAプログラム '処理実行確認画面 rc = MsgBox("処理を実行しますか？", vbOKCancel, "注文データ処理") If rc = vbCancel Then Exit Sub End If '[ファイルを開く]ダイアログボックスを作成 Set dlgOpen = Application.FileDialog(msoFileDialogOpen) 'ダイアログボックスの初期値をセット dlgOpen.AllowMultiSelect = False dlgOpen.Filters.Clear dlgOpen.Filters.Add "CSVファイル", "*.csv" dlgOpen.InitialFileName = CurrentProject.Path 'ダイアログボックス表示 retDialog = dlgOpen.Show '[キャンセル]ボタン If retDialog = 0 Then Exit Sub '[開く]ボタン Else '選択したファイル名を表示 Me!txtファイル名IN = dlgOpen.SelectedItems(1) End If Const ForRading = 1 strFilePath = txtファイル名IN Set Con = CurrentProject.Connection Rec.Open "order_list", Con, adOpenDynamic, adLockOptimistic Open strFilePath For Input As #FNo 'ファイルの1行目の項目名部分を読み込む(何も処理しない) Line Input #FNo, txtData On Error GoTo ErrHndl 'エラーが発生した場合にデータのインポートをなかったこと(ロールバック) 'にするためにトランザクション処理として実行 Con.BeginTrans '実際のデータ部分(2行目)からの処理 Do While Not EOF(FNo) Line Input #FNo, txtData Debug.Print txtData Loop Con.CommitTrans Close #FNo MsgBox ("処理が完了しました。") Exit Sub ErrHndl: Close #FNo Con.RollbackTrans MsgBox "以下のエラーが発生したためロールバックしました。" & vbCrLf & _ Err.Description, vbCritical ----------------------------------------------------------------------------------------
会社でＡＣＣＥＳＳ2000（まだまだ現役！！です）を使ってデータベースの作業をしているのですが、ＰＣが最近、起動しないというトラブルがあり、とうとう寿命が来たのかもしれません。 新しい、ＰＣの購入を検討しているのですが、今、購入できるＰＣはＡＣＣＥＳＳ2013しかないらしく、マイクロソフトにきいてみたら、ファイル形式の変換をしたらいい。。。とか言われたのですが、そのファイル形式という言葉さえ、ちんぷんかんぷんで、困っています。 どなたか、ＡＣＣＥＳＳ2000をWINDOWS8に入れたＡＣＣＥＳＳ2013で動くか教えてください、お願いいたします。
mysqlで下記のAAAというテーブルからuniqueキー設定されている BBBという列名をuniqueキーから解除することを考えています。 CCCもuniqueキーですが、CCCはuniqueのまま残します。 テーブル構造は下記の通りです。 CREATE TABLE `AAA` ( `id` char(5) NOT NULL COMMENT 'ID', `BBB` char(3) NOT NULL COMMENT 'コード', `CCC` varchar(50) NOT NULL COMMENT '名前', PRIMARY KEY (`id`), UNIQUE KEY `UK_AAA` (`BBB`,`CCC`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='AAA用' まずは、下記sqlでindexを削除しました。 alter table `AAA` drop index UK_AAA ; その後のテーブル構造は下記のようにUNIQUE KEY `UK_AAA`が消えました。 CREATE TABLE `AAA` ( `id` char(5) NOT NULL COMMENT 'ID', `BBB` char(3) NOT NULL COMMENT 'コード', `CCC` varchar(50) NOT NULL COMMENT '名前', PRIMARY KEY (`id`), ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='AAA用' そして次のsqlでBBBをuniqueに再び設定しようと試みました。 alter table `AAA` add unique (BBB); しかし、ここで警告メッセージが出現しうまく反映されません。 [Err] 1062 - Duplicate entry '0' for key 'BBB' 自分でこの警告を調べてもわかりませんでした。 結果的にBBBがunique解除されればいいので、私が実施したsql手順 でなくても他に効率のいいやり方があればその方法をご教授ください。 よろしくお願いします。
table1とtable2を結合した上で、areaのフィールドをまとめたtable3を作るにはどうすれば良いでしょうか。 table1 id | area | ----+----------- 1 | 東京　　 | 2 | 神奈川 | 3 | 神奈川 | 4 | 千葉 | table2 id | area | ----+----------- 1 | 青森　　 | 2 | 東京 　| 3 | 神奈川 | 4 | 埼玉 | table3 id | area | ----+----------- 1 | 青森　　 | 2 | 東京 　| 3 | 神奈川 | 4 | 埼玉 | 5 | 千葉 |
access初心者で、初歩的なことだと思うのですが教えていただけますでしょうか。 顧客情報テーブルを全件表示・入力・変更するフォームAがあります。 日付期間内検索、名前検索などいくつか条件絞込みのためのフォームBがあります。 やりたいこと フォームBで指定した期間などで、検索結果をフォームAに表示させたいです。 ←→現在はフォームBの検索クエリーごとに、実際は検索条件ごとにフォームAをコピーし、フォームのプロパティのレコードソースにて制御しています。 よろしくおねがいします。
MYSQLでマトリックスの内容を管理することはできるでしょうか？ 例えば 　　　肩幅　　身幅　　着丈 XS　　40　　　45　　　59 S　　　44　　　52　　　65 M　　　48　　　56　　　70 L　　　50　　　60　　　75 これを管理するには2つのテーブルで分けて管理するしかないですか？
VB2010 expressでデータベースを使ったアプリを作成しようとしています。(作り方が図書に書かれているアプリです) ですが、サンプルデータベースをネットからダウンロードして、サーバエクスプローラーでデータ接続を試みようとした所、次のようなエラーが出ました。 「ユーザーインスタンスのプロセスを起動中のエラーによりsql serverのユーザーインスタンスを生成できませんでした」 エラー内容をネットで調べたところ、 C:\Users\ユーザ名\AppData\Local\Microsoft\Microsoft SQL Server Data\SQLEXPRESS の「SQLEXPRESS」を消して実行すれば解決すると書いてあったのですが、解決できません。 ほかに、接続の追加画面の詳細設定を押して、「User Instance」を「False」にすれば、いいとも 書いてあったりしたのですが、だめでした。VB2010 ExpressとSQL Server2012 Management Studioが入っているからダメなのでしょうか？ 誰かわかる方、ご教授お願いいたします。 【開発環境】 Windows 8.1 Microsoft Visual Basic Express 2010（データベース作成編集はVBでやっている） SQL Server2012 Management Studio（いろいろやっていてインストールした）
こんにちは。 添付した画像の左のデータテーブルと真ん中のデータテーブルがあります。 伝票Noでマッチングさせて右の様なデータを出したいのですが当方あまり詳しくなくアドバイスをお願いします。 左のデータテーブルが必ずしも伝票Noが主キーにならないので自分の能力を超えてしまいました。 左のデータテーブルのリストごとに伝票Noが同一のアイテムを作る？ かなりデータ量の多いリストが出来るはずなんですが。。 説明まで難しいです。。よろしくお願いします！
MySQL5逆引き大全460の極意という本を参考に勉強しているんですが ALTER TABLE <テーブル名> ADD (<カラム名> <型情報>, <カラム名> <型情報>, ....); という形式で列定義を複数追加するときに後ろに[FIRST|AFTER 列名]という風に書いてあります。 しかしそれで実行するとエラーになります。 私が何か書き方を間違えているのか、本が間違っているのかわかりません。 一応本に書いてある通りにはやったつもりなんですが。 ちなみにADD id INT AFTER name,ADD score INT FIRSTのような形式で複数追加する場合は AFTERもFIRSTも問題なく実行できます。 ～ADD (<カラム名> <型情報>, <カラム名> <型情報>, ....);のときのAFTER等の使い方 もしくは使用可能か不可能かについて教えていただきたいです。 よろしくお願い致します。
MySQLで複数テーブルを作成することはできますか？ 試しにCREATE TABLE tb1(c1 int), tb2(c1 int);のようにしたらダメでした。 また、MySQLでできなかったとしたとき他のRDBMSならできるというものが あれば教えていただきたいです。 よろしくお願い致します。
条件付き書式に関する質問でございます。 以下のように色分けしたいと思っております。 2015/04/29　えがわ・東京都＿ピンク 2015/04/30　えがわ・東京都＿水色 2015/05/01　えがわ・東京都＿水色 2015/05/02　えがわ・東京都＿水色 2015/05/03　さいとう・東京都＿ピンク 2015/05/04　さいとう・東京都＿水色 2015/05/05 ＿灰色 2015/05/06　さいとう・東京都＿ピンク 2015/05/07　さいとう・東京都＿水色 2015/05/08　さいとう・東京都＿水色 2015/05/09 ＿灰色 2015/05/10　すずき・大阪府＿ピンク 2015/05/11　すずき・大阪府＿黄色 「えがわ・東京都」といった具合に氏名の後に、 東京都がきた場合、氏名が連続する一番目だけ 色をピンクに変えることはできないでしょうか？ また何もデーターが入っていない場合は灰色に 何かデーターが入っていた場合は、黄色にしたいと思っております。 式：[氏名住所] Like "*東京都"＿水色 式：[氏名住所] Like "*東京都"＿ピンク 式：[氏名住所] Is Null＿＿＿＿＿黄色 式：[氏名住所] Is Not Null＿＿＿灰色 までは分かりましたが、 氏名が連続した場合にその最初の１つめだけ色を変えて 上記の日付のように、色分けをすることは式にはなっておりません。 こうした設定は具体的に可能でしょうか？ お手数かとは存じますが、 ご指南をよろしくお願い致します。
Access初心者です。 このたび、社内のシステムが使えなくなってしまったため、急遽accessでシステムを作ることになりました。 データは各市町村から各市町村の距離(キロ数)で検索のみ使えればOKです。 例えば、大田区から水戸市までの距離とか、 千代田区からさいたま市までの距離とか、そういうデータが恐らく1万件近くあります。 都道府県、市区町村のコード化するテーブルと 各市町村から各市町村までの距離を格納するテーブル そういう構造しかないでしょうか？ そうすると各市町村毎テーブル作らなくてはならないと思うのでテーブル数が膨大になってしまいます。 フォームの構造としては、 例えばテキストボックスに千代田区と入力すると 千代田区から各市町村のキロ数一覧が出るようにしたいのですが テーブル構造としてはどういうテーブル構造がいいでしょうか？ よろしくお願いします。
mySQLのストアドプロシージャにて、以下のようなコードを用いています。 SELECT * from `db`.`table` where `criteria` = criteria; この時、期待と異って`db`.`table`の全レコードが返されます。 しかし、where句にて条件を`table`.`criteria`のようにテーブル名を含めて 指定すると期待通りに抽出された結果が得られます。 なぜ、カラム名と変数名が同一だと、このような結果になるのでしょうか。 バッククオートにより`criteria`がカラム名だと明示されている筈です。 また、テーブル名を含めた指定だと期待通りの結果になる理由も分かりません。 仕組みをしっかり理解したいので、ご教示頂けますと幸いです。 ところで、対象をテーブル名やデータベース名を含めて記載すること(パスで言うところのフルパス)は何というのでしょうか？ こちらもご存知でしたら、ご教示願います。
MySQL5.1（サーバCentOS）に他のＰＣ（windows7)から接続できません。他の質問などを見て以下の４点を確認し ​ました。 ・MySQLの接続可能なユーザとＰＣをＳＱＬで確認　select ​user,host ​from ​ mysql.user; ・CentOSのネット設定確認　netstat ​で0.0.0.0:3306 ​0.0.0.0:* ​LISTENが表示 ​ される。 ・CentOSのファイヤウォール確認iptables -nL ・windows7からtelnetでcentOSにログインし、mysqlコマンドで接続 ですが、windows7にmysqlをインストールして、コマンドラインからmysql -h CentOSのIP で接続しようとすると、接続できません。 ERROR 2003 (HY000): Can't connect to MySQL server on ''(10061)が表示されます。 質問 ・クライアントwindows7での設定は何か必要ですか？ ・my.cnfのbind-addressをコメントアウトする書き込みがありましたが、mysql --helpで表示されるパスにmy.cnfがありません。作成する必要はありますか？ よろしくお願いします。
MySQLでデータ挿入時にid としてauto_increment値を設定するのですが、 同時にp_codeというカラムで3ケタのゼロフィルしたコード値を入れたいのですが、 可能でしょうか？
Mysqlの文字コードがlatin1のサーバーAと、Mysqlの文字コードがutf8のサーバーBがあります。 サーバーA内でデータを取得し表示する際は、そのまま表示するだけで文字化けせず表示できますが、サーバーBからサーバーAのMySQLに接続し、表示した場合は文字化けします。 サーバーBはMysqlの文字コードの文字コードがutf8なのですが、サーバーAからデータを取得して表示するだけなのに文字化けってするのでしょうか？ どなたか原因が分かる方、よろしくお願いいたします。
現在、 11g SQL基礎I（1Z0-051）と Bronze DBA11g（1Z0-018）に合格し、11gのOracle Bronzeを取得しました。 次はシルバー取得を考えていますが、そこで質問です。 今ですと、11gと12c、どちらの取得を目指した方が良いでしょうか？ ①このまま11gのシルバーを取得し、12cシルバーにアップグレードする ②ブロンズを12cにアップグレードし、12cシルバーを目指す ③11gも12cも大して変わらないから、11gのままでよい 職業はSE（主にDB系）、スキルアップ、会社評価の為に資格取得を目指しています。
Notesで編集中メールの文字列置換(大量)を行いたい 会社PCに、IBM Lotus Notes Rel.7.0.2 が入ってます 初心者です 社内ルールに、メールに数字や括弧は全角使うな！などがあり 置換したいのです。詳しくないのですが、@関数で出来ないでしょうか？ メニューバーのボタンに以下を設定。以下では置換されず @ReplaceSubstring(@ThisValue; "（"; "("); @ThisValueでは、編集中メールの全文が拾えない模様 どなたか助けてください！ そもそも@関数でできるのでしょうか？
こんにちは。あまり頭がよろしくないのでパンクしそうです。。 よろしくお願いします。 あるレジシステムから出てくる実績情報から出したいデータがあります。power pivotというエクセルのアドオンを利用しているんですが中々うまくいきません。powerpivotを必ず利用しないといけない訳ではないので今ある実績データから希望するデータを取る為に必要なステップを是非是非教えて貰いたいです。どうぞお付き合いください。 レストランレジなんですが、伝票ごとにカテゴリを付ける事ができます。「20代」「30代」「40代」「カップル」「ビジネス用途」「WEB広告」など最大18項目あって、どれか1つではなく複数立てる事ができます。 その日が終わってエクスポートされるゲストカテゴリデータと言うのがあって、簡単に言うと ２０代　　伝票番号３１　4500円 カップル　伝票番号３１　4500円 ３０代　　伝票番号３２　2300円 ２０代　　伝票番号３３　3100円 夫婦　　　伝票番号３４　3100円 こういう感じなんです。 なので２０代というフラグが立っている伝票の総計を出すことができる感じです。 もう一つ一番大事なPOSデータと言うのがあって、 伝票番号３１　りんご　　　　３　　　３００ 伝票番号３２　メロン　　　　２　　　４００ 伝票番号３２　りんご　　　　３　　　３００ 伝票番号３２　すいか　　　　１　　　５００ 伝票番号３３　なし　　　　　２　　　２００ 伝票番号３３　りんご　　　　３　　　３００ 伝票番号３４　みかん　　　　５　　　５００ 伝票番号３４　すいか　　　　１　　　５００ 伝票番号３４　なし　　　　　３　　　３００ こんな感じです。 自分が出したいのはカテゴリーごとのABC（アイテムランキング）です。 ２０代はどの様なアイテムが一番出ているのか。 もし、もし可能なら２０代で、しかもカップルという２つのフラグが立っている場合はどの様なアイテムが出ているか、これが知りたいです。 とにかくカテゴリデータとPOSデータのテーブルをつなぎたいんですが、つなぐ事になるカラムは伝票番号だと思うのですがこれがどちらのテーブルデータにも複数出てきてしまうのでエラーが出てしまいます。当然ですよね。そうなんですがここまで来て頭がパンクし始めてここに質問する事にしました。 自分が希望するデータを出すためにはどのような作業が必要でしょうか。 学があまりないのですみませんが皆様のお力をお貸し下さい！ よろしくおねがいします。
いつもお世話になります。また躓いてしまいましたのでご教授お願いいたします。 Access2010において、フォームの中に５つのページを設定しました。 フォームをマクロで開くところまでは良いのですが、 表示されるページを１ページ目ではなく、２ページ目としたいのですが SetForcu等で設定しようにもうまく動かず困っております。 ページ位置は変更ができないので、２ページ目の位置を１ページ目にしないということが前提になっております。 以上、よろしくお願いいたします。 環境：Access2010　windows7
SQL文について教えて頂ければとおもいます。 売上テーブルには下記のレコードが入っています。 売上日、商品、数量 4/10　　商品A　　2 4/10　　商品B　　3 4/10　　商品A　　2 4/10　　商品C　　1 4/10　　商品B　　1 4/11　　商品A　　1 4/11　　商品B　　2 4/11　　商品C　　3 4/11　　商品C　　2 4/11　　商品A　　2 4/11　　商品B　　4 商品は3種類しかなく、日付ごとの3種類の売り上げ数量1行に表示する方法を COUNT やGROUP BYを組み合わせていろいろ試行錯誤していますが、 うまくいきません。 イメージは下記になります。 日付　商品A　商品B　商品C 4/10　　4　　　　　4　　　　1 4/11　　3　　　　　6　　　　5 そもそもSQLでは上記のイメージにできないのでしょうか？
買った後にわかりました。 どうにか使える方法はあるのでしょうか？ よろしくお願い致します。
はじめまして。 SQLの構文について、アドバイスいただきたく投稿しました。 下記のようなテーブルがあり、 id| month | limit | price --+-------+------------+------ 1 | 1月 | 2015/01/01 | 100 1 | 1月 | 2015/02/01 | 100 1 | 2月 | 2015/03/01 | 200 1 | 2月 | 2015/04/01 | 200 1 | 3月 | 2015/05/01 | 300 1 | 4月 | 2015/06/01 | 300 1 | 5月 | 2015/07/01 | 300 1 | 6月 | 2015/08/01 | 300 このテーブルから、下記のような結果を取得したいです。 id| month | limit | price --+---------+------------+------ 1 | 1月 | 2015/02/01 | 200 1 | 2月 | 2015/04/01 | 400 1 | 3月以降 | 2015/08/01 | 300 条件1.同一id,同一monthでグループ化 条件2.priceは各グループの合計金額 条件3.limitは、各グループで最も新しい日付 条件1について、1月または2月以外の月は、同一月とみなしてグループ化したい、という希望です。 必死で考えましたが、思うような結果が得られず、アドバイスいただけないでしょうか。
以下のような機能を実装するためのデータベースを作成したのですが、どのようにテーブルを作ればいいのかわかりません。 ・いろいろなブログからRSS経由で記事名・更新日時・url等々取得する（それをDBにほうりこむ） ・取得したものの中でクリック率が高いものを順に表示する ・取得したものの中でカテゴリ別に分けて表示する この場合、１つのテーブルの中に、記事名・更新日時・url・クリックカウント数等々、全部放り込めば良いと素人考えで思ってしまうのですが、あまりよろしくないのでしょうか？（正規化とかそういう考え？） テーブルは２つくらいに分けたほうがいいのでしょうか？ ご回答宜しくお願いいたします。
wifiなどネットワークに関する分かりやすいホームページや本を教えてください。
現在Windows　XP上で動いているソフトなのですが、 このソフトが、MySQL　Server＆ Cliants 4.0.13 （Winmysqladmin1.4及び Mysql ODBC 3.51） を使用しています。 このPCが壊れてしまったため、新しいパソコン　windows 7 pro　32bit (ハードウェアでHDD2個のミラーリング仕様)を購入し このソフトをインストールしたのですが、うまく動きません。 具体的には、ソフトはインストールでき、Winmysqladmin1.4が起動するのですが、 赤信号になってしまい、緑信号表示になりません。 ためしに、別のPC（元windows xp　を　7　アルティメットにバージョンupしたもの） に同じソフトをインストールし、うまく動いたので、 my.iniのセットアップやpathの設定は間違っていないと思うのですが。 データーベースは、詳しくないので、助けていただけるとうれしいです。 中途半端な知識で挑んだのが失敗でした･･･。 ちなみに、DBの用語等もわからないので、これからMYSQLの勉強をしようと思うのですが、 お勧めの本がありましたら教えてください。
テーブルAはid、名前、住所、電話番号のカラムがあり、データが入っております。 テーブルBもid、名前、住所、電話番号のカラムがあり、データが入っております。 これまでは二つのテーブルを利用しておりましが、二つのテーブルの構成が同じで、二つのテーブルに分けておく必要がない為、今後は二つのテーブルを1つにまとめて、テーブルCを作成して利用したいと思いました。 この場合はどのような方法で作成出来ますでしょうか。 また、今回は1つのテーブルにまとまればいいので、テーブルCを作成するまでもなく、テーブルＡの中にテーブルＢの内容をそのまま入れる方法もあるかと思うのですが、そちらの方法も教えていただけますでしょうか。 よろしくお願いします。
どうもお世話になります。 Accessのクエリの設定でのご質問をさせてください。 発送日と在庫管理ID、２つの値を基準にした 累計を取りたいと思っております。 それで以下の式を書いたのですけれど、 -------------------------------------------- 累計: DSum("商品の数","Q2f2_受注記録_詳細_集計の集計","発送日<=" & [Q2f2_受注記録_詳細_集計の集計].[発送日] & "AND 在庫管理ID =" & [Q2f2_受注記録_詳細_集計の集計].[在庫管理ID]) -------------------------------------------- このように記載したところ、 累計を集計できるはずが、真白になってしまいます。 それならばと、 ２つあったテーブルとクエリを１つにまとめて シンプルなクエリにして、 -------------------------------------------- 累計: DSum("商品の数","Q2f2_受注記録_累計","発送日 <=" & [発送日] & "AND 在庫管理ID =" & [在庫管理ID]) -------------------------------------------- にしても、やっぱり真白になってしまいます。 ちなみに、 -------------------------------------------- 累計: DSum("商品の数","Q2f2_受注記録_詳細_集計の集計","発送日<=" & [Q2f2_受注記録_詳細_集計の集計]![発送日] & "AND 在庫管理ID =" & [Q2f2_受注記録_詳細_集計の集計]![在庫管理ID]) -------------------------------------------- こんな記載も試してみました。 が、やはり真白になります。 どこかバグがありますでしょうか？ お手数かとは存じますが、どうぞ御指南のほどを 宜しくお願い致します。
昨日から、なにかのブラウザを開くたびに 画像のような広告が、左下、中央の下、右下から飛び出してきて、そのまま他のブラウザに勝手に移動してしまい、ものすごく困ってます。 ウイルスをスキャンしても調べて出てくる Advanced System Protector」「Advanced File Optimizer」 「Advanced Driver Updater」「Advanced System Optimizer」 「regclean pro」「Yontooなんとか」「Uniblueなんとか」 「QuickShare」「AddLyrics」「WebCake」 「MixiDJ chrome Toolbar」「MyPC Backup」 「lucky leap」「MixiDJ dToolbar」「DefaultTab」 「pricemeter」「mobogenie」 というものをアンインストールすればいいとあるのですが、 コントロールパネルを開いても何一つありません。 どうしたら広告が消えるのでしょうか。 パソコンはWindows7です。 お願いします！
環境 oracle 11g いつも大変助かっており、お世話になっております。 【テーブル1】 No、ID、大分類、中分類、小分類 1、001、10、0、0 2、001、10、10、0 3、001、10、20、0 4、002、20、30、40 【テーブル2】 No、ID、大分類、中分類、小分類、値 1、001、10、0、0、50 2、001、10、10、0、55 3、002、20、0、0、100 4、002、20、30、0、100 上記のデータあるとします。 select テーブル2.値 from テーブル1 テーブル2 leftjoin on テーブル1.ID = テーブル2.ID where テーブル1.大分類 = テーブル2.大分類 and テーブル1.中分類 = テーブル2.中分類 and テーブル1.小分類 = テーブル2.小分類 上記SQLでは、テーブル2.値は、No1の50とNo2の55が取得されます。 これを、 テーブル1のNo3で、 テーブル2のどれにも当て嵌まらない場合、 テーブル1.大分類を10として、テーブル2のNo1の値を取得したいのです。 また、テーブル1のNo4に関しては、 テーブル2のNo4を取得したいのです。 PL/SQL等、プログラムを組まないと取得出来ないものでしょうか？ SQLで取得できるテクニックをご享受頂きたいです。 どうぞ宜しくお願い致します。
Microsoft Access 2010の初心者です。 商品台帳というテーブルを作り、 商品コード（主キー）　商品名　単価 のフィールドを作りました。 一方で、販売伝票というテーブルを作り、 ID（オートナンバー）　顧客名　商品コード　商品名　数量　単価 のフィールドを作りました。 そこで、商品台帳にいくつかのレコードを作成したのちに、 販売伝票のレコードを作成しようとしてみますが、 商品コードを入力しても、商品名や数量を参照表示できません。 どこがまちがっているのでしょうか。
Access2010についてわからないことがあります。 あるテーブルで、A,B,C,D,Eの5つの数値フィールドが設定されており、Fの集計フィールドにはA〜Eの合計を求めるために[A]+[B]+[C]+[D]+[E]という計算式を設定しました。 新規レコードを作成して、AからEまでそれぞれ1,2,3,4,5と数値を入力するとFには合計の15が表示されますが、AからEのいずれかに数値が入力されていないと、Fには合計が表示されません。 たとえばDが未入力でも、Fに1+2+3+5の11が表示されるようにしたいのですがどうすればよいでしょうか。 お教えいただければうれしいです。 どうぞよろしくお願い致します。
数字の場合は、&quot;exit(select 3);&quot;を実行するとerrorlevelに入ってきます。 文字の場合はどのようにしてバッチの環境変数に入れるのでしょうか？
「テーブル1」に [会員No] [入金日1] [入金日2] --- [入金日n] [入金額1] [入金額2] --- [入金額n] というフィールドがあります。このデータから、 [入金日別]-[会員No]-[入金額計]のレポートを作成したいのですが、 まずは、どのようなクエリをつくるのかわかりません。 集計クエリを作りにしても、テーブルデータをそのまま 使うことができるのでしょうか？ よろしくお願いします。
少し訂正があるので、再度質問させて下さい。 oracleでは出来るけど、access2010では出来ない、２つのテーブルから情報を取得するselect文について教えて下さい。 テーブルは以下の通りです。 ・atbl 　　処理日 　　納品番号（主キー） 　　商品コード 　　数量 ・btbl 　　連番（主キー） 　　納品番号 　　得意先コード 　　・ 　　・ 　　・ 行いたい事は、atblに無い得意先コードをbtblから取得することです。 btblには同一納品番号が複数存在します。もちろん納品番号が同じなら得意先コードも同じです。 oracleでは正しく実行されるselect文は　　　 select atbl.納品番号, atbl.商品コード, atbl.数量, (select btbl.得意先コード from btbl where atbl.納品番号=btbl.納品番号 AND ROWNUM=1) from atbl where atbl.処理日='20150322' これをaccess2010で行うにはどのように記述すればよろしいでしょうか。 ご教授の程、宜しくお願いいたします。
お世話になります。 以下、お伺いさせてください。 OS＝Windows8.1のパソコンに、ACCESS2010をインストールしています。 OS＝Windows2012Serverのサーバーに、SQLServer2014Standardをインストールしています。 SQLServerデータベースには、テーブル「A」と、ビュー（ACCESSで言うクエリ）の「B」があります。 パソコンにACCESS2010のファイルを作り、ODBC接続で、「A」と「B」にリンクを張ります。 この結果、テーブル「A」は正常に参照、編修、デザインビュー参照が出来ます。 ビュー「B」に関しては、実質的にこれがビューではなくテーブルになってしまいます。 ビュー「B」を開きますと、あらかじめ設定されているビューの内容が表示されますが、 ビュー「B」のデザインビューを参照しますと、ビューのそれではなく、 テーブルとしてのそれが表示されてしまいます。 ビューの条件設定内容も表示されません。 ビューのデザインビューの編集（対象テーブルの追加、削除、データ抽出条件の指定、変更等）を、 パソコンから行いたいと思うのですが、これは可能でしょうか。 ACCESS2008以前のADP（AccessDataProject）ではこれが出来るのですが、 ODBCリンクでは、これが出来ない仕様なのでしょうか。 これが出来ない場合、サーバーのデータベースの編集は、サーバーで直接行うか、 ビューではなくテーブルの全行を開いて行うか、専用ソフトを作成して行うか、 等が対処方法としては考えられると思いますが、 可能であればビューで行いたいです。 他に何か方法があれば、ご教示頂きたいと思います。 どうぞよろしくお願い致します。
ACCESS2013にて、売り上げ管理のデータベースを作成しています。 業種は水産小売業です。 商品が同じでも、客先別に単価設定が違う為、”売上入力テーブル”と”商品テーブル”,”単価テーブル”を用意して、リレーションシップにて連結し、クエリで売り上げ管理をしています。 2015年5月より、商品を値上げすることが決まっており、現在準備を進めています。 単価更新をしたいのですが、今までのﾃﾞｰﾀは、単価を変更したくないのですが、 どうすればいいかわからず困っています。 他の知恵袋を見ると、単価適用時期（適用開始日など）のフィールドを”単価テーブル”に追加すればできると書いてありますが、どのように、連結させるのか わかりません。 だれか教えていただけませんでしょうか？
こんにちは VBSでADODBを使ってmdbファイルを扱っています。 2つのテーブルから、共通するID(2つのテーブル全体で一意で連番になっている)を使ってデータを取り出そうとしているのですが、うまくいきません。 Select ID, ContentA from A UNION SELECT ID, ContentB from B order by ID レコードは取得できるのですが、テーブルAから取得するレコード(こちらの方がデータが長い)は255文字までしか取得できません。 これを、SELECT UNIONを使わないと255文字以上取得できるのです。 どうすればよいのでしょうか。
Windows2003上で稼働していたMysql5.1を Windows2008R2上の5.5に移行中です。 試行錯誤のうえ、mysqldumpで日次行っているバックアップデータをレストアするまではなんとかできたようですが、phpのプログラムで日本語を表示すると文字化けが発生してしまいます。 文字コードの設定は旧マシンと同じ状態になっていることは確認しました。 元の設定も少しいびつな状態になっているとは思いますが、Command Line Clientで見ると、正常に日本語は表示されています。 ▼my.iniの内容 [mysql] default-character-set=cp932 [mysqld] default-character-set=cp932 ▼mysqlの環境変数 mysql>show variables like 'chara%' character_set_client　cp932 character_set_connection　cp932 character_set_database　utf8 character_set_filesystem　binary character_set_results　cp932 character_set_server　cp932 character_set_system　utf8 ▼データ文字セット 対象データベースの文字コード：utf8 テーブルのdefault-charaset：cp932 十分に理解していないうえでデータベースを構築しているのでいびつな状態になっている状態ですが、移行後も、phpのソース(文字コードsjis)上に記載してある日本語の表示文字は正確に出ています。 2008になってunicode化された影響なのでしょうが、プログラムの変更をせずに文字化けを解消する方法はあるのでしょうか？ テーブルの文字列を直接変更すればいいのかもしれませんが、 テーブル内のカラムも個別に文字コード設定してあったりして、どう直せばよいのかも判らない状態です。 create table `mytbl` ( `row1` char(20) character set sjis , (中略) ) default charaset cp932; よろしくお願い申し上げます。
データーベース分割ツールを使って Accessのシステムを分割しようとすると 「インデックスが有効範囲内にありません。」 というエラーが出てしまいます。 どこをどうすればエラーが消えますでしょうか？ お手数かとは存じますが、 ご指南よろしくお願い致します。 【追記】 もう一度シンプルなソフトを作ったところ あっさり分割できました。 だけど、今作っているソフトを分割したいと思っております。 けっこうややこしいソフトになってます。 そのせいかなとも思うのですが、新たに作ったソフトが分割できるので、 どこかが間違っているのかなー？と感じました。 それではどうぞよろしくお願い致します。
どうもお世話になります。 Accessに関しましての質問でございます。 以下のVBAでコンパイルエラーが出るのですが、 どのように致したらエラーが出なくなるでしょうか？ こちらのプログラムは、 チェックインから宿泊最終日を入力すると 日付を１日ずつ増やして、ほかのデータは 固定したままフォームに入力するプログラムです。 ただし、請求書_詳細IDもオートナンバー型です。 -------------------------------------------- Option Compare Database Private Sub レコードの追加_Click() Dim strWHERE As String Dim D As Date strWHERE = "" strWHERE = strWHERE & " AND 宿泊日 >=#" & Me.チェックイン & "#" strWHERE = strWHERE & " AND 宿泊日 <=#" & Me.宿泊最終日 & "#" If DCount("*", "Qh2f_請求書_詳細", strWHERE) = 0 Then '条件に当て嵌まるデータ件数を取得 Me.Fh2f_請求書_詳細_sub.Requery With Me.Fh2f_請求書_詳細_sub.Form.RecordsetClone For D = Me.チェックイン To Me.宿泊最終日 .FindFirst "宿泊日=#" & D & "#AND 請求書_詳細ID ='" & Me.請求書_詳細ID & "'" If .NoMatch Then .AddNew !宿泊日 = D !請求書_詳細ID = Me.請求書_詳細ID !部屋番 = Me.部屋番 !氏名2 = Me.氏名2 !商品名 = Me.商品名 !単価 = Me.単価 !人数 = Me.人数 !宿泊数 = Me.宿泊数 !備考 = Me.備考 .Update End If Next End With Else MsgBox ("すでに同じ日付が入っています") End If End Sub -------------------------------------------- こちらの設定にしたところ 「コンパイルエラー」 「メソッドまたはデータメンバが見つかりません。」という エラーが出てしまいます。 そうして、「.請求書_詳細ID」だけが ブルーになります。 どうしたら、エラーを消して 連投できるようになるでしょうか？ 大変お手数とはぞんじますが、 ご返信お待ち致しております。 【補足】 実は他の方に教えてもらった プログラムを応用して作ったものです。 ＶＢＡ初心者です。 どうぞよろしくお願い致します。
はじめて質問します。 顧客情報のテーブルにN件のメールアドレス、電話番号を保持している構造のテーブルがある場合 以下のような状態でデータを取得したい場合、どのようなSQLを書けば良いでしょうか。 電話番号・メールアドレスは、可変でN件は難しそうなので最大2件固定。 ■取得対象 【顧客テーブル】 |顧客ID　|顧客名 |1　　　|太郎 |2　　　|二郎 【メールアドレス】 |メールアドレス　|顧客ID |a@goo.ne.jp　　|1 |b@goo.ne.jp　　|1 |c@goo.ne.jp　　|2 |d@goo.ne.jp　　|2 【電話番号】 |電話番号　　　|顧客ID |0311112222　|1 |08011112222 |1 |0399999999　|2 |09088889999 |2 ■取得したい内容 |顧客ID|顧客名　　|・・・|電話番号1 　　| 電話番号2　　 |メールアドレス1　|メールアドレス2 |1　　　|太郎　　　|・・・ |0311112222 |08011112222 |a@goo.ne.jp　　|b@goo.ne.jp |2　　　|二郎　　　| ・・・|0399999999 |09088889999 |c@goo.ne.jp　　|d@goo.ne.jp　 ■テーブル構造 【顧客テーブル】 ・顧客ID(PK) ・顧客名 ・生年月日 　etc 【電話番号】 ・電話番号ID(PK) ・電話番号 ・顧客ID(FK) 　etc ※顧客IDで顧客テーブルと紐づく 【メールアドレス】 ・メールアドレスID(PK) ・メールアドレス ・顧客ID(FK) 　etc ※顧客IDで顧客テーブルと紐づく ご回答頂ければ助かります。よろしくお願い致します。
お世話になります。 Accessに関して質問させてください。 テーブルとテーブルをクエリでつないだ場合、 レコードの入力を行えるはずだと思うのですが、 入力できません。 一番下のデータの新規のところが出てきません。 もしかしたら、IDが４つあるせいだろうか？ とも思うのですけれど、必ず４つ必要なんです。 どうしたら入力できるようになりますでしょうか？ お手数かとは存じますが、 ご返信をよろしくお願い致します。
お世話になります。　 Accessの集計の仕方に関しまして質問をさせてください。 IDでくくって、縦に一行ずつ足していく関数は ございますでしょうか？　関数じゃないかもしれませんが。 どうぞよろしくご指南ください。 今クエリでやっておりますが、 IDではくくれるのですが、IDごとに総合計をしてしまったりして 思うような計算ができません。 お手数をお掛かけ致しますが よろしくお願い致します。
videopadの無料体験版を使って動画編集をしていたのですが、何度か保存をしたら無料体験期間終了になってしまい、それ以降有料版を買え。みたいな趣旨のことしか出なくなってソフトが使えなくなってしまいました。PC本体に保存していなかったのでせっかく作った動画が全部なくなりました。有料版を買わなくても今まで作った動画が戻る方法があれば教えてください。ちなみに無料版をもう一度アンインストールしたら前回までのデータはきれいさっぱりなくなってしまうのでしょうか？
知識不足ですみませんが、 以下の場合の◎の内容が出力できるSQL文を教えてください。 同一のコードが複数あり、有効日時が異なる場合、更新日時に近いレコードを取得したいです。 テーブルの例を記述します。 --------------------------------------- tableA --------------------------------------- コード | 名称 | 開始日時 | 終了日時 A01 | あ | 2012-04-01 |2014-03-01 A01 | 亜 | 2015-04-01 |2018-03-01 A02 | い | 2012-04-01 |2014-03-01 A02 | 位 | 2015-04-01 |2018-03-01 --------------------------------------- --------------------------------------- tableB --------------------------------------- コード | 名称 | 開始日時 | 終了日時 B01 | う | 2012-04-01 |2014-03-01 B01 | 宇 | 2015-04-01 |2018-03-01 B02 | え | 2012-04-01 |2014-03-01 B02 | 絵 | 2015-04-01 |2018-03-01 --------------------------------------- --------------------------------------- tableC --------------------------------------- Aコード | Bコード | 更新日時 A01 | B01 |2012-04-01 A02 | B02 |2013-04-01 A01 | B01 |2014-04-01 A02 | B02 |2015-04-01 --------------------------------------- --------------------------------------- ◎SQLで出力したい内容◎ --------------------------------------- Aコード | A名称 | Bコード | B名称 | 更新日時 A01 | あ | B01 |　う　 | 2013-04-01 A02 | い | B02 |　え　 | 2014-04-01 A01 | 亜 | B01 |　宇　 | 2015-04-01 A02 | 位 | B02 |　絵　 | 2016-04-01 --------------------------------------- ※DBはoracleです。プログラムに実装ではないので、sql文が知りたいです。 よろしくお願い致します。
以下の移動データから転入、転出、部移動入、部移動出の情報を抽出したいのですが いい方法をご教授下さい。 よろしくお願い致します。 データのイメージ 日付　　　　　　社員番号　　　部室名 やりたいこと 20130104　　　A0001　　　　第一部　　　←転入とみたい 　　・　　　　　　　・　　　　　　・ 20130331　　　A0001　　　　第一部　　　←部移動出とみたい（データ取得できず） 20130401　　　A0001　　　　第三部　　　←部移動入とみたい 　　・　　　　　　　・　　　　　　・ 20140228　　　A0001　　　　第三部　　　←部移動出とみたい 20140301　　　A0001　　　　第一部　　　←部移動入とみたい（データ取得できず） 　　・　　　　　　　・　　　　　　・ 20140731　　　A0001　　　　第一部　　　←部移動出とみたい 20140801　　　A0001　　　　第四部　　　←部移動入とみたい 　　・　　　　　　　・　　　　　　・ 20141230　　　A0001　　　　第四部　　　←転出とみたい 転入＝group by 社員番号　min（日付） 転出＝group by 社員番号　max（日付） 部移動入＝group by （社員番号,部室名）　min（日付） 部移動出＝group by （社員番号,部室名）　max（日付） と考えてみたのでですが、「第一部」に2回配属になっているために 上記の「データ取得できず」の状態になりました。 データ件数は60万件強あります。 何かいい方法があればご教授下さい。
ファイルメーカープロ11についての質問です。 日付を昇順で並び替えしたいのですが、入力していない空白フィールドが先頭にきてしまいます。 入力してある日付のみを昇順で並び替えを行い、空白フィールドはその下に並び替える方法はありますか？ 教えていただける方いらっしゃいましたら、お願いします。
外部端末を利用したいので、 my.cnfを [mysql] default-character-set=utf8 user = mysql pid-file = /var/run/mysqld/mysqld.pid socket = /var/run/mysqld/mysqld.sock port = 3306 basedir = /usr datadir = /var/lib/mysql tmpdir = /tmp language = /usr/share/mysql/English bind-address = ***.***.***.*** としました。 mysqlを起動したところ mysql: unknown variable 'pid-file=/var/run/mysqld/mysqld.pid' とエラーが出ます。 解決方法が分からず困っています。どのように対処すれば良いでしょうか？ 教えてください。 宜しくお願いいたします。
どうもよろしくお願い致します。 Accessでシステムを製作しているのですが、 クエリを使ったところ、途中まではちゃんとした数値が出るのですが、 突然、値が、２倍、３倍、４倍になってしまいます。 クエリかなー？　リレーションかなー？　と感じるのですけれど、 色々試してみても、わかりません。 大変お手数かとは存じますが、 本来の数値が出るための方法をご指南ください。 どうぞよろしくお願い致します。
運用中にWEBアプリの改修できるシステム設計(DB層)のお話です。 開発環境でDB改修後その内容をを(運用中)本番DBへ反映(デプロイ)したい場合、 どのような(設計)方法がありますでしょうか。 ご存知の方、宜しくお願いします。
どうもお世話になります。 テーブルのIDともう一つのテーブルの値を（一応IDです） リレーションシップをしたいのですが、 「主テーブルで参照されているフィールド用の固有のインデックスが見つかりません。」 とエラーが出てきます。 もしかしたら、片方のテーブルに主キーが２つ あるのが原因かもしれないと思うのですが、 一度過去に成功しています。（ただいろいろ試していたためなぜ成功したのか覚えていません） データーに問題があるのかな？　と思い、 データを消したのですが、やはり同じエラーが出るので関係ないようです。 どのようにしたらリレーションシップを はかれるでしょうか？ どうぞご指南ください。
３つのテーブルのデーターを クエリにまとめると読み取り専用となり入力できなくなるのですが、 これを解除して入力できるようにすることは出来ないでしょうか？ 方法がございましたら、 お教えください。 お手数かとは存じますが、どうぞよろしくお願い致します。
標題の実行結果の見方について調べたのですが、結果の各行の内容を説明しているものが見つかりませんでした。 もし、標題の実行結果について説明しているサイトや書籍があれば、お教え頂けないでしょうか。 ※参考にしたサイト http://dev.mysql.com/doc/refman/5.6/en/show-engi … http://staffblog.yumemi.jp/mysql-show-engine-inn … 出力結果 ===================================== 150304 8:24:35 INNODB MONITOR OUTPUT ===================================== Per second averages calculated from the last 11 seconds ----------------- BACKGROUND THREAD ----------------- srv_master_thread loops: 15253 1_second, 15253 sleeps, 1392 10_second, 1358 background, 1358 flush srv_master_thread log flush and writes: 15272 ---------- SEMAPHORES ---------- OS WAIT ARRAY INFO: reservation count 2751, signal count 2750 Mutex spin waits 1332, rounds 39960, OS waits 1332 RW-shared spins 1419, rounds 42570, OS waits 1419 RW-excl spins 0, rounds 0, OS waits 0 Spin rounds per wait: 30.00 mutex, 30.00 RW-shared, 0.00 RW-excl ------------ TRANSACTIONS ------------ Trx id counter 23F0EA Purge done for trx's n:o < 23F0E3 undo n:o < 0 History list length 1513 LIST OF TRANSACTIONS FOR EACH SESSION: ---TRANSACTION 0, not started MySQL thread id 3022, OS thread handle 0x7f1d46b9f700, query id 218103 localhost root show engine innodb status -------- FILE I/O -------- I/O thread 0 state: waiting for completed aio requests (insert buffer thread) I/O thread 1 state: waiting for completed aio requests (log thread) I/O thread 2 state: waiting for completed aio requests (read thread) I/O thread 3 state: waiting for completed aio requests (read thread) I/O thread 4 state: waiting for completed aio requests (read thread) I/O thread 5 state: waiting for completed aio requests (read thread) I/O thread 6 state: waiting for completed aio requests (write thread) I/O thread 7 state: waiting for completed aio requests (write thread) I/O thread 8 state: waiting for completed aio requests (write thread) I/O thread 9 state: waiting for completed aio requests (write thread) Pending normal aio reads: 0 [0, 0, 0, 0] , aio writes: 0 [0, 0, 0, 0] , ibuf aio reads: 0, log i/o's: 0, sync i/o's: 0 Pending flushes (fsync) log: 0; buffer pool: 0 731 OS file reads, 28619 OS file writes, 11544 OS fsyncs 0.00 reads/s, 0 avg bytes/read, 0.00 writes/s, 0.00 fsyncs/s ------------------------------------- INSERT BUFFER AND ADAPTIVE HASH INDEX ------------------------------------- Ibuf: size 1, free list len 0, seg size 2, 0 merges merged operations: insert 0, delete mark 0, delete 0 discarded operations: insert 0, delete mark 0, delete 0 Hash table size 276707, node heap has 5 buffer(s) 0.00 hash searches/s, 0.00 non-hash searches/s --- LOG --- Log sequence number 118470215 Log flushed up to 118470215 Last checkpoint at 118470215 0 pending log writes, 0 pending chkp writes 8358 log i/o's done, 0.00 log i/o's/second ---------------------- BUFFER POOL AND MEMORY ---------------------- Total memory allocated 137363456; in additional pool allocated 0 Dictionary memory allocated 161090 Buffer pool size 8192 Free buffers 7224 Database pages 963 Old database pages 375 Modified db pages 0 Pending reads 0 Pending writes: LRU 0, flush list 0, single page 0 Pages made young 0, not young 0 0.00 youngs/s, 0.00 non-youngs/s Pages read 720, created 243, written 18604 0.00 reads/s, 0.00 creates/s, 0.00 writes/s No buffer pool page gets since the last printout Pages read ahead 0.00/s, evicted without access 0.00/s, Random read ahead 0.00/s LRU len: 963, unzip_LRU len: 0 I/O sum[0]:cur[0], unzip sum[0]:cur[0] -------------- ROW OPERATIONS -------------- 0 queries inside InnoDB, 0 queries in queue 1 read views open inside InnoDB Main thread process no. 8696, id 139763711444736, state: waiting for server activity Number of rows inserted 31935, updated 4850, deleted 834, read 1867566 0.00 inserts/s, 0.00 updates/s, 0.00 deletes/s, 0.00 reads/s ----------------------------
MySQLでの、ランキング表示について質問です。 select u1.s_id , s.s_name , sum(quantity) 売上数, (select count(*) 1 from (select sum(quantity) kei from u_data group by s_id) u2 where sum(u1.quantity) < u2.kei) ランキング from u_data u1 inner join syouhin_m s on u1.s_id = s.s_id group by u1.s_id , s.s_name order by 4; 上記のSQL文で　(where sum(u1.quantity) < u2.kei)　の部分が 良く分からないので、解説できる人はよろしくお願いします。 （実行もできるし、答えも合っています。）
MySQLでインサートするときに、ユニークキーを設定せずに重複データを避ける方法ってありますか？ 複数データを一気にインサートしているので、ユニークキーを設定するとその中の１個でも重複があると全部はじかれてしまいます。 現在は、 select cn from テーブル名 where cn in ('aaa,'bbb','ccc') ※cn：重複ないデータにしたいカラム名　 ※('aaa,'bbb','ccc')　実際に入れたいデータ といったんセレクトして、セレクトできなかったデータだけにして、 インサート(複数一気に）するといった流れでやっています。 これを１つの文とかで書けないのでしょうか？ not existというのを聞いたことがあるのですが、 色々検索しましたがよくわからなかったです。。。 よろしくおねがいします。
お世話になります。 MicrosoftAccess2000（9.0.2812）がインストールされている、WindowsXPPro（5.1.2600）SP3を複数台使用し、WindowsServer2012のデータベースサーバー（MicrosoftSQLServer2014Standardインストール）に接続しております。 Access2000のadp（AccessDataProject）を使って、パソコンから、サーバーデータベースの中身を見ています。 あるパソコンではデータベースのビューのデザイン指定、参照、編修を問題なく使用出来ているのですが、ある別のパソコンからは、ビューのデザインの保存が出来ません。「接続されているSQLサーバーはSQLServer2000よりも新しいバージョンです。保存は無効になります。」とメッセージが出ます。 またこの場合、ビューには、all_columns(sys)～xml_schema_wildcards(sys)という、多数のテーブルが出現します。ビューのデザインが保存出来るパソコンでは、これらが出現しません。 以前は、SQLServer2000StandardをインストールしたWindowsServer2003に接続していました。 パソコンは両者とも全く同じOSのバージョン、Accessのバージョン、なのですが、サーバーのデータベースのビューが保存出来るものと出来ないものとが分かれてしまい、その違いが分かりません。 この原因に関しまして、何かお分かりになられる方がいらっしゃいましたら、ぜひご教示くださいませ。 どうぞよろしくお願い致します。
SQL Serverで以下のようなテーブルからデータを取得しようと思っているのですが、うまく取得できません。 テーブル１　NEWS_TABLE 　ニュースID(NEWS_ID)と都道府県ID(PREF_ID)が100件格納されています。 テーブル２　PREF_TABLE 　都道府県ID(PREF_ID)と都道府県名(PREF_NAME)が格納されています。 ニュースの頻発するベスト４の都道府県をリストアップしたいのですが、以下のSQLだと問題なく取得できます。 SELECT TOP 4 COUNT(A.NEWS_ID) AS COUNT , A.PREF_ID ,(SELECT PREF_NAME FROM PREF_TABLE WHERE ID = A.PREF_ID) AS PREF_NAME FROM NEWS_TABLE AS A (NOLOCK) WHERE A.NEWS_ID IN (1,2,3,4,5,6,7,8,9,10.....) GROUP BY A.PREF_ID ORDER BY COUNT DESC ところが、以下だとエラーになってしまいます。 SELECT TOP 4 COUNT(A.NEWS_ID) AS COUNT , A.PREF_ID ,(SELECT PREF_NAME FROM PREF_TABLE WHERE ID = A.PREF_ID) AS PREF_NAME FROM NEWS_TABLE AS A (NOLOCK) LEFT JOIN PREF_TABLE AS B (NOLOCK) ON A.PREF_ID = B.PREF_ID WHERE A.NEWS_ID IN (1,2,3,4,5,6,7,8,9,10.....) GROUP BY A.PREF_ID ORDER BY COUNT DESC メッセージは以下 メッセージ 8120、レベル 16、状態 1、行 5 列 ＊＊＊＊' は選択リスト内では無効です。この列は集計関数または GROUP BY 句に含まれていません。 2つ目の方が一般的のような気がするのですが、なぜエラーになるのか、2つ目の方法で解決策があるのか、教えて頂けないでしょうか？
サーバーアプリケーションの使用無しにローカルに接続されているサーバーの特定ディレクトリにファイルを保存する事は可能でしょうか。 可能であれば、手法の概要を教えてください。
なかなかうまくいきません。 dataの平均を出してから順位を取得したいです。 アドバイスお願いします。 select 　　　id, 　　　avg(data1) avg, 　　　(select count(avg(data1)) avg 　　　 from score b where a.avg<b.avg)+1 as rank from score a group by id order by avg desc; ERROR 1111(HY000):Invalid use of group function
MSDOS 時代に　使用していた　ソート用ソフト　sortf ですが 久しぶりに　必要となり　ソフトは有るのですが　使用方法が　見つかりません WEBでも　見つかりませんでした どなたか　分かる方おりましたら　教えて下さい
0 件 . Access2000のデータからExcel2013にデータを抽出する方法を教えて下さい。 C:\JRA\Accessに 「2014.mdb」と「出馬表当日.xls」が保存されています。 　　　　　　　　　　　↓ 　　　　　　　SheetDBのC列、D列、E列、F列を抽出項目とします。 「出馬表当日.xls」のSheetDBのC列に騎手名、D列には0か1、E列には4桁の数字、F列には漢字2文字が並んでいます。これを抽出項目にしたいのです。 行番号,C列,D列,E列、F列 ↓, ↓, ↓, ↓　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 01柴山雄一,1,1200,東京 02伊藤工真,1,1200,東京 03松岡正海,1,1200,東京 04黛弘人,1,1200,東京 05 06吉田豊,0,1800,阪神 07北村宏司,0,1800,阪神 08浜中俊,0,1800,阪神 09 10大野拓弥,0,2200,京都 11赤岡修次,0,2200,京都 12岩田康誠,0,2200,京都 13 14石川裕紀人,1,2000,小倉 ・・・・・・・・・ 上の場合、01～04の条件でAccess2000のデータから抽出したものをひとつのシート（1R）に、06～08の条件で抽出したものを別のシートに(2R)、.....と空白行ごとに抽出して、その結果を「出馬表当日.xls」にシートを変えて貼り付けたいのです。 空白行から空白行までは最大18名分入っています。 名前とD列(0か1)、E列(4桁の数字)の数字、F列（漢字2文字）をAccessの抽出項目とします（Access2000のフィールドは13あってその6番目に名前、3番目に「0か1」5番目に「4桁の数字」13番目に「漢字2文字」が入っています）。 この（最大）18名の名前と2種類の数字をAccessの抽出項目として、Excel2013に抽出したいのです。 以前、名前のみでの抽出を教えていただいたのですが、2種類の数字を条件として追加すべく頑張りましたが、さっぱり分からず、再度投稿させていただきました。 http://oshiete.goo.ne.jp/qa/8838454.html よろしくお願いします。
win7：access2010 フォーム上にテキストが5つあり、4つに検索条件を入力し、その条件に従いクエリで、検索した結果を フォームの5つ目のテキストボックスに表示させていのですが、今現在クエリ検索まで、できており5つ目のボックスをコンボボックスなら表示できていますが、コンボボックスは、下矢印を押さないと検索結果が、出てきませんので、それをテキストボックに表示させたいのですが、・・・・ いろいろ検索しているのですが、それらしいのが見つけられません。どなたかご教授いただけないでしょうか？ 請求先、施工者、工事、コードを入力して、その条件で金額のテキストボックスに検索結果の金額を表示させたい（金額の横のボックスがテキストボックスで、その右横がコンボボックスです。） コンボボックスの右の下矢印を押すと結果が出てきます。 おおざっぱな説明で申し訳ありませんがよろしくお願いいたします。
MysqlでWaiting for table lock　というエラーがでて困っています。 上記のエラーがでて特定のテーブルにアクセスする事ができません。 該当のエラーのIDをKILLしても、そのTableにアクセスが出来ません。 こちらのWaiting for table lockを解除する方法ご存知でしょうか？ よろしくお願い致します。
SQL Server Configuration ManagerからSQL Serverを開始したら、「要求が失敗したか、サービスが適切な時間内に応答しませんでした。詳細については、イベントログまたは他の適切なエラーログを参照してください。」というメッセージが表示されて、開始できません。 コマンドラインからは開始できます。何が原因でしょうか。
Access2013をバックエンドとフロントエンドに分割したいのですが、それを実行すると、ファイルの拡張子が「accdb」ではなく、「accdc」となります。この時、アクセスからメッセージで著名付のバックエンドを作成する等表示されますが、実際に出来たこのファイルを開こうとすると、「セキュリティに影響を及ぼす可能性のある問題点が検知されました。 警告：このコンテンツはデジタル著名がありません。このコンテンツの発行元を確認出来ません。」 というエラーになり、ファイルが開けずテーブルの構成の変更などが出来ず、大変困っています。 この対処の仕方を誰かご存知の方がおられましたら、ご教授お願いします。
CentOS 5.11でwordpress4.0.1を動かす為にPHPバージョン5.5.20、MySQLサーバーバージョン5.5.41を入れましたが、wordpressの設定画面が開かず「お使いのサーバーの PHP では WordPress に必要な MySQL 拡張を利用できないようです。」と表示されて、どうしたら良いか判りません。 詳しい方、この様な場合はどの様に対処したら良いか教えて下さい。 宜しくお願い致します。
次のSQL文を実行します。 create table1 (id, english) insert table1 (1,"foo") insert table1 (2,"bar") create table2 (id, japanese) insert table2 (1, "ふー") insert table2 (2, "ばー") SQL文法としては誤ってますが、成功したとします。 いま、select id from table1 where english = 'foo'; で1が得られます。 いま、select japanese from table2 where id = 1; で"ふー"が得られます。 これを一つのSQLite3のselect文で実現できないでしょうか。 select japanese from table2 where id = (select id from table1 where english = 'foo'); で良いですか？ カテゴリ選択にSQLiteが無いのは、人気が無いからですかね。
Excel2013 vba-> Access2013 mdbファイル 問題点：以下のソースを実行すると、エラーが発生します。このエラーをなくしてアクセスデータベースのテーブルの情報の更新、新規追加、削除を行いたいです。 エラー内容：実行時エラー'3251'　現在のRecordsetは更新をサポートしていません。プロバイダーか、選択されたロックタイプの限界の可能性があります。 ソース： Sub 登録処理() 　　Dim Rst As adodb.Recordset 　　Dim SQL As String 　　Dim Rg As Range 　　Dim RgData As Range 　　Dim lngLastRow As Long 　　Dim RgDel As Range 　　 　　On Error GoTo errH 　　 　　Set RgData = mySh.Range("B2") 　　lngLastRow = RgData.End(xlDown).Row 　　Set RgData = mySh.Range(RgData, mySh.Range("AB" & lngLastRow)) 　　 　　SQL = "Select * from [会社管理テーブル]" 　　Call DBconection2 　　Set Rst = New adodb.Recordset 　　With Rst 　　　　.ActiveConnection = Cn 　　　　'SQL文でテーブル名と抽出条件を指定する 　　　　.Source = SQL 　　　　.CursorLocation = 3 ' クライアントサイドカーソルに変更 　　　　.Open 　　　　 　　End With 　　 　　Dim y As Long 　　 　　Sheets("会社管理").Select 　　 　　If Rst.EOF = False And Rst.BOF = False Then 　　　　 　　　　For i = 1 To RgData.Rows.Count 　　　　　　 　　　　　　If Cells(i + 1, 1).Value = "変更" Then 　　　　　　　　Rst.MoveFirst 　　　　　　　　Rst.Find "[施工会社ID]=" & RgData(i, 1).Value 　　　　　　　　If Rst.EOF Then 　　　　　　　　　　 　　　　　　　　Else 　　　　　　　　　　Rst.Fields("会社ID").Value = RgData(i, 2).Value 　　　　　　　　　　Rst.Fields("会社名").Value = RgData(i, 3).Value 　　　　　　　　　　Rst.Fields("フリガナ").Value = RgData(i, 4).Value 　　 　　　　　　　　　　Rst.Update 　　　　　　　　End If 　　　　　　　　Cells(i + 1, 1).Value = "" 　　　　　　ElseIf Range(i, 1).Value = "削除" Then 　　　　　　　　Rst.MoveFirst 　　　　　　　　 　　　　　　　　Rst.Find "[会社ID]=" & RgData.Cells(i, 1).Value 　　　　　　　　If Rst.EOF Then 　　　　　　　　　　 　　　　　　　　Else 　　　　　　　　　　Rst.Delete 　　　　　　　　End If 　　　　　　　　Set RgDel = Rows(i + 1 & ":" & i + 1) 　　　　　　　　RgDel.Select 　　　　　　　　RgDel.Delete 　　　　　　　　 　　　　　　ElseIf Range(i, 1).Value = "新規" Then 　　　　　　　　Rst.AddNew 　　　　　　　　Rst.Fields("会社ID").Value = RgData(i, 2).Value 　　　　　　　　Rst.Fields("会社名").Value = RgData(i, 3).Value 　　　　　　　　Rst.Fields("フリガナ").Value = RgData(i, 4).Value 　　　　　　　　Rst.Update 　　　　　　　　Cells(i + 1, 1).Value = "" 　　　　　　End If 　　　　　　 　　　　Next i 　　　　 　　End If exitH: 　　 　　Rst.Close: Set Rst = Nothing 　　Call DBclose2 　　Exit Sub 　　 　　　　 errH: 　　MsgBox Err.Number & "(" & Err.Description & ")" 　　GoTo exitH 　　 End Sub Sub DBconection2() 　　Set Cn = New adodb.Connection 　　Cn.Provider = "Microsoft.Jet.OLEDB.4.0" 　　Cn.Open modPublic.DBPATH 　　 End Sub Function MakeDBconection() As adodb.Connection 　　Set Cn = New adodb.Connection 　　Cn.Provider = "Microsoft.Jet.OLEDB.4.0" 　　Cn.Open modPublic.DBPATH 　　 　　Set MakeDBconection = Cn 　　 End Function Sub DBclose2() 　　Cn.Close 　　Set Cn = Nothing End Sub Sub EraseContents(s_Rg As Range) 　　s_Rg.ClearContents 　　 End Sub 誰か、解決方法がおわかりの方がいましたら、アドバイスをよろしくお願いします。
access2010ですが、ナビゲーションウインドを左側に寄せて最少幅にしたところ、元に戻そうとしても、⇔マークが出なくなり困ってます。 データベースの最適化をしてもうまくいかず、ネットで類似のトラブル対策でF11キーを押す方法も全く効果ありません。再起動しても、幅の狭いままで、これではオブジェクトが見えず、使えません。 やむなく、２００３で読み、ここの幅を広げて保管して、２０１０で再度読んでも同じ状態です。 これは、２０１０の欠陥でしょうか？ どなたか、解決策のわかる方、大至急ご教授下さい。
お忙しい中、閲覧頂き、感謝いたします、私は現在ウインドウズ７にて、エクセル2007を使用してあらゆる表計算書並びに、書類を作成致して居りますが、先日ある知り合いのお宅にお伺いいたした折に、外付けUSBにエクセル2007で作成した書類を先方のパソコンで閲覧しようと思い先方のエクセル2013を使用して、こちらから持参した外付けUSB（エクセル2007で作成した表計算及び書類等）の内容が閲覧できない状態でした、既に、エクセル2007を使用して約7年ほどが経過しており、また、外付けHDD等にも保存しており、かなりの量になっております、質問ですが、私のエクセル2007が古くて対応しないのか？若しくは操作ミスなのか？これらの書類をエクセル2013でも閲覧できる方法が在ればご指導のほど、よろしくお願い申し上げます。
アンケート結果を集計する効率の良いシンプルなSQLを教えて下さい。 MySQLで、以下の状態です。 テーブル名：hoge カラム：id,kbn id...auto kbn...1～5 欲しい結果は、以下の状態です。 順位,kbn,count 1位,5,60ポイント 2位,3,45ポイント 2位,1,45ポイント 4位,4,30ポイント 5位,2,10ポイント ※位やポイントはプログラム側で付与するので不要です。 2位の様に同点の場合は同じ順位を表示し、3位を飛ばし順位を表示させたく思います。 どうぞ、よろしくお願い致します。
Access2013 vba メインフォームのサブフォームコントロールの中にあるサブフォームA（帳票）のフィールド「金額」の合計値をメインフォームで表示したいのですが、その関数の式を以下のようにして入れましたが、何も表示されません。 「=Sum(Nz([SubForm01].[Form]![発注合計金額],0))」 どこが間違っているか教えて頂けないでしょうか・・・ よろしくお願いします。
締め日が21～翌20日なのですが、ある実績表を月度毎で集計したい場合みなさんならどういうクエリにしますか？ できたらクロス集計で、横軸が○/21～翌/20でならぶようにしたいです。 1～月末なら、月毎に集計させればいいのですが。 よいお知恵をおかしください。 Excelでもいいです。
MySQLを使って管理画面を作っております。 $sql='INSERT INTO players(name,price,position_id) VALUES(?,?,?)'; という文で使ったidをコピーしてから次のINSERTの文でそのidの番号を使って別テーブルのカラムにその番号をINSERTするしくみを作りたいのですがなかなか上手くいきません。 var_dump($last_id);では番号がコピーされているのですが、INSERTができません。 いつもお世話になってしまい大変恐縮なのですが、どなたかご教授いただけないでしょうか？よろしくお願い致します。 <!DOCTYPE html> <html> <head> <meta charset="UTF-8"> <link rel="stylesheet" type="text/css" href="../../xxxxx/team.css"/> <title>選手追加完了</title> </head> <body> <div id="main"> <?php $pro_name=$_POST['name']; $pro_price=$_POST['price']; $pro_position_id=$_POST['position_id']; $pro_team=$_POST['team_name']; $pro_name=htmlspecialchars($pro_name); $pro_price=htmlspecialchars($pro_price); $pro_position_id=htmlspecialchars($pro_position_id); $pro_team=htmlspecialchars($pro_team); $dns = "mysql:host=localhost; dbname=player;charset=utf8"; $dns_id = "xxxxx"; $dns_pw = "xxxxxxx"; try { $conn = new PDO($dns, $dns_id, $dns_pw, array(PDO::ATTR_EMULATE_PREPARES => false)); } catch (Exception $e) { echo 'ERROR: ' . $e->getMessage(); die(); } try { //トランザクションを開始する。オートコミットがオフになる $conn->beginTransaction(); //処理その(1) $sql='INSERT INTO players(name,price,position_id) VALUES(?,?,?)'; $stmt=$conn->prepare($sql); $data[]=$pro_name; $data[]=$pro_price; $data[]=$pro_position_id; $stmt->execute($data); //直近id取得 $last_id_sql = "SELECT LAST_INSERT_ID() as id"; $stmt = $conn->prepare($last_id_sql); $stmt->execute(); $last_id = $stmt->fetch(PDO::FETCH_ASSOC); $stmt->closeCursor(); //確認var_dump($last_id); //処理その(2) $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); $sql2='INSERT INTO team(team_id,team_name) VALUES(?,?)'; $stmt=$conn->prepare($sql2); $data2[]=$pro_team; $data2[]=$last_id; $stmt->execute(array($last_id,$pro_team)); $stmt->closeCursor(); //確認var_dump($last_id); //変更をコミットする $conn->commit(); } catch(PDOException $e){ //変更をロールバックする $conn->rollBack(); echo 'ERROR:' . $e->getMessage(); } // 切断 $conn = null; print $pro_name; print'を追加しました。<br />'; ?> <a href="xxxxx">戻る</a> </div><!--main--> </body> </html>
Access2013 vba 今工事関係のシステムを作っています。 ・工事受注の情報を入力する画面A ・工事部材の注文明細を入力する画面B（帳票・サブフォーム） ・工事の管理情報を入力する画面C（単票・メインフォーム） ・工事の発注明細を入力する画面C2（帳票・サブフォーム） ・受注明細画面D（帳票フォーム） とあるとして 【A】受注情報管理 ・受注ID(main key) ・受注日 ・依頼内容 ・部材注文合計金額 ・発注合計金額 【B】部材注文明細 ・部材明細ID2 (main key) ・受注ID(foreign key) ・品番 ・商品名 ・単価 ・数 ・摘要 【C】工事管理情報→依頼先会社毎に、受注IDに紐づく ・工事管理ID (main key) ・受注ID (foreign key) ・依頼先会社ID(foreign key) ・工事開始日 ・工事終了日 【C2】工事管理─仮発注明細 ・明細ID4(main) ・工事管理ID ・項目名 ・単価 ・数量 ・摘要 受注明細を、部材注文明細と仮発注明細から作成するやり方を考えました。 BとC2のレコードから、受注IDをキーにして、全てのレコードを以下のDの受注明細テーブルに格納する・・・。この時、B, C2と、Dは非同期→すると、もし、部材明細や仮発注明細が変更されると、Dが連動してその変更内容が反映出来ません。このやり方が良いのかとうか、いまいちわかりません。ご助言をお願いします・・・。 【D】受注明細 ・受注明細ID5(main) ・受注ID ・項目名 ・単価 ・数量 ・摘要 ・請求ID
f1、id、name、price の株価データがhistoryテーブルに入っています。 f1は発注番号です。「id,name=株券」は複数あるため、ひとつの株券だけを見ると発注番号はランダムになります。 SELECT * FROM (SELECT f1,id,name,price FROM history WHERE id = 2001 ORDER BY f1 DESC limit 0,10) as AA ORDER BY f1 ASC 上記のSQL文により、株ID=2001番の直近10回の売買価格(推移)を取得することが可能です。 f1 　　id 　　name 　　price 14585 2001 日本製粉　521 14595 2001 日本製粉　523 14607 2001 日本製粉　527 14684 2001 日本製粉　524 14705 2001 日本製粉　520 14771 2001 日本製粉　519 14795 2001 日本製粉　518 14800 2001 日本製粉　516 14804 2001 日本製粉　517 14882 2001 日本製粉　519 やりたいこと この直近の取引10回に関し、若い順に必ず0から9の番号を振る関数(下記の仮想カラムzeroを追加する)を作りたいと思っています。 f1 　　id 　　name 　　price　zero 14585 2001 日本製粉　521 　　0 14595 2001 日本製粉　523 　　1 14607 2001 日本製粉　527 　　2 14684 2001 日本製粉　524 　　3 14705 2001 日本製粉　520 　　4 14771 2001 日本製粉　519 　　5 14795 2001 日本製粉　518 　　6 14800 2001 日本製粉　516 　　7 14804 2001 日本製粉　517 　　8 14882 2001 日本製粉　519 　　9 株によっては10回未満の取引のものもあり、その場合はたとえば4回しか取引のない株の場合はzeroの値は0から3を振ることになります。 SELECT * FROM (SELECT f1,id,name,price FROM history WHERE id = 2001 ORDER BY f1 DESC limit 0,10) as AA ORDER BY f1 ASC を改良して作ろうとしましたがいいアイデアが浮かびません。 どなたか助けて頂けませんでしょうか? よろしくお願いいたします。
Access 2013 VBA 帳票フォームの行の順番を簡単に変えたいのですが、何か方法はありますでしょうか。 よろしくお願いします。
Access 2000で作成したmdbファイルを Access 2013環境で使用しています。 ・テーブルのみのmdbファイル(1)があります。 　mdbファイル(1)の中には、テーブルオブジェクトが1つあり、フィールドが1つ、 　フィールドサイズは255です。レコード件数は、36万5000件程度あります。 ・フォームやクエリ、マクロ、mdbファイル(1)と 　リンクテーブルでつないでいるmdbファイル(2)があります。 mdbファイル(1)のファイルサイズが、90MBに達しており mdbファイル(2)を開いたり、何か処理させるのを遅くしているのではないか と思っています。 他の方の質問をチェックしましたが、結果は 最適化について 　オプション→現在のデータベース→閉じるときに最適化する→チェックON済み 　手動で最適化する→変化なし。 MDBをMDEに変換する 　Access 2013では、バージョンが違うので変換できないようです。 　accdb形式に変換→accde形式に変換しましたが、変化なし 　(そもそも、ファイル(1)はテーブルのみで、マクロやプロシージャは無いので、 　意味が無かったかも) となっており、対処法が見つからなくて困っています。 何か良い案はないでしょうか。
access初心者です。現在以下のようなテーブルがあります。 　　　　　　　　　　入所日　　　退所日 宿泊者ID（A1）　2015/01/01　2015/01/10　 この場合新規テーブルに　 　　　　　　　　　滞在期間 宿泊者ID（A1）　2015/01/01 宿泊者ID（A1）　2015/01/02 宿泊者ID（A1）　2015/01/03 　　　　　　　　： 宿泊者ID（A1）　2015/01/10 という具合に新規追加するには、どのような手法が考えられますでしょうか？ 提示情報が足りないと思うのですが、その点のご教授もお願い申し上げま。
Access 2013 vba 1つの受注された案件で、その売上の請求先が複数になる場合があります。 しかも、その請求先に何を請求するのかは、その場、その場で変わり、決まっていないらしいです。 このような場合に、どのように請求先を1つの受注した工事案件に引き当てれば良いのか、良くわからず、困っています。テーブル構造は恐らく 【受注テーブル】 ・受注ID(Main key) ・受注日 ・依頼元 ・依頼内容 ・受注総合計金額 などなど 【請求引当テーブル】 ・請求引当ID(Main key) ・受注ID (Ex.Key) ・請求金額 ・摘要 ・支払期日（依頼元が当社に支払う期日） ・支払方法 しかし、その明細については、受注テーブルの項目の依頼内容の何になるのかは、その時にならなければわからないのです。それに、請求先が1つしかない場合もあるし、複数に成るのが最後にならないと分からない場合もあります。 この場合、請求書をPGでデータベースからデータを選択して作成する場合、何を選択すれば良いのかわかりません。 このような説明の仕方では、ご回答が難しいかとも思いますが、私も説明に苦慮しています。 実際に、このようなケースを扱ったシステムでは、どんな解決策をとっているのか知りたいです。
Access 2013 vba 消費税率を変数に入れる場合、その変数のデータ型は何にすればよいでしょうか? Doubleで良いのでしょうか?
すみません、MySQLのSQL文で教えてください。 以下のSQL文を実行すると UPDATE overflag c, asinprice d SET d.priceCheckUS = TRUE WHERE c.asin=d.asin AND c.priceOverUS=0 LIMIT 1; ERROR 1221 (HY000): Incorrect usage of UPDATE and LIMIT というエラーが出力されます。 UPDATE asinprice d SET d.priceCheckUS = TRUE WHERE d.asin='111' OR d.asin='000' LIMIT 1; は実行できました。 複数テーブルだと実行できないように理解しましたが、何が問題か教えてください。 よろしくお願いします。
ご覧頂き誠にありがとうございます。 当方アクセスの初心者ですが会社の顧客リスト作成を頼まれており、アクセスにて、複数に分かれたエクセルファイル同士を繋ぎ合せてエクセルで顧客リストを作成したいと考えております。 エクセルファイルなのですが、1つ目は住所リスト(顧客番号、名前、住所)でもう一つは売上データ(顧客番号、名前、売上高)です。住所データは全顧客記載、売上データは該当の顧客のみ記載されております。(売上0の顧客は記載せず) 上記ファイルをアクセスに取り込み選択ウィザードで顧客番号を主力キーにして合体をさせたのですが、売上データに記載の顧客のみが抽出され住所リストの一部顧客が消えてしまいます。(売上のある顧客の顧客番号、名前、住所、売上高は記載できました。) 2つのファイルを合体させて全顧客の顧客番号、名前、売上(売上がない場合は空欄)と抽出をしたいです。 お力添え頂けると幸いです。
Access 2013 vba メイン画面に、2つのサブフォーム（共に帳票）があり 親→子→孫 となっています。 この時、親、子、孫のレコードを取得して ある書類を作成しエクセルに出力しようとしています。 この場合、親のデータは普通に変数Aに入れて 子のデータは一次元配列B()に入れ 孫のデータは一次元配列C(0)～C(3)に入れたものを、更に子用の一次元配列B1()～B4()に入れるように作りにしようと考えています。 この場合、 子の画面で次の2レコード目に進んだ時、子画面用のB1...B4の配列変数に入れている孫のC(0)～C(3)の配列の中身は、子画面の一レコードと二レコード目では同じものになるのでしょうか。 もし、同じものになるのであれば、この方法は使えないと思っていますが。。。 他に何か良い方法はありますでしょうか。 Accessで、クラスを作って、それを配列変数に入れるとか・・・ よろしくお願いします。
Access 2013 VBA フォームの帳票タイプで あるレコードのチェックボックスにチェックを入れた時だけ、そのレコードにある特定のフィールドのテキストボックスを入力可能にしたいです。 どのようにしたら良いでしょうか? 誰かお分かりの方おられましたら、よろしくお願いします （お正月でまだ誰も見る暇がないようですが・・・）
Access 2013 vba 今工事のための材料の注文履歴を保存するテーブルと画面を作っています。 この商品名や、単価、仕入れ値などのデータは、管理テーブルを作成してそこで管理し、そこから商品IDを選択すると、注文履歴の画面にIDだけがセットされるような作りにしようと考えています。 【注文内容の入力画面A】 ・注文日 ・受注ID ・商品ID ・注文先ID ・単価 ・数量 ・単位 【商品管理テーブル】 ・商品ID ・メーカーID ・単価 ・品番 このようにすると、商品管理のテーブルのレコードを勝手に削除されたりした場合に、大変な事になることを考えると躊躇してしまいます。 商品管理のテーブルはあくまでも参照にとどめて、その商品名や品番などは、注文履歴を保存する画面のフィールドに保存したほうが良いか、迷っています。 この点で良いアドバイスがあれば、よろしくお願いします。
環境は WindowsXP SP2 Python 2.7, sqlite3 です。 次のSQL文は成功します。 SELECT head, body FROM dic WHERE body MATCH 'foo bar' しかし、次がエラーになります。 SELECT head, body FROM dic WHERE body MATCH 'foo bar' AND head MATCH 'bar' 解決方法はありますか。
今、ある単票フォームに、2つのサブフォームを配置し、そのサブフォーム間で金額の連携をしたいと考えています。 【親フォームA】 ・ID1、長整数型(主きー) ・受付日時 ・発注金額総合計 <== ※Bが更新されたら、ここを更新したい 【サブフォームB】 ・ID2、長整数型(主キー) ・ID1(外部キー) ・発注日 ・発注合計金額 <===　※Cが更新されたら、ここを更新したい ==> Aの更新へ↑ 【サブフォームC】 ・ID3、長整数型(主キー) ・ID2(外部キー) ・発注項目名 ・単価 ・数量 ==>ここを更新する→Bへ↑ ・単位 ==>ここを行進する→Bへ↑ ・摘要 サブフォームB、Cは、いずれも帳票型です。 それぞれ、テーブルA, B, Cがレコードソースで テーブル構成は、上の項目の構成と同じです。 A-ID1: B-ID1 = 1：多 B-ID2: C-ID2 = 1：多 この時、Cで単価と数量を入力したら、Bの発注合計金額の値を更新したいです。 それと同時に、親Form Aの「発注金額総合計」の値を、Bの全てのレコードの「発注合計金額」のSumで更新したいです。 よろしくお願いします。
【Access 2013 VBA / SQL】 [親Table] *ID1 *日付 *受注元会社名 {子Table ] *ID2(主キー) *ID1(親テーブルのID) *ID3(外部キー) [Table B] *ID3 *会社名 ------------------------------ ID2　　ID1　　　　会社ID ------------------------------ 1　　　　1　　　　　A 2　　　　1　　　　　B 3　　　　1　　　　　B 4　　　　1　　　　　C 5　　　　2　　　　　B 6　　　　2　　　　　A 7　　　　2　　　　　A ------------------------------ ID1=1のもので、会社IDを一意にして選択した会社名を表示したい この時、SQLでどのように書けばよいでしょうか
【Access2013 VBA】 日付のフィールドをフォームから入力スル場合に そのフィールドにカーソルを移動した時、普通は、右端に四角い日付入力用のマークが出て、それをクリックするとカレンダーが表示され、そこから選択することが可能ですが、 このマークが出るフィールドと出ないフィールドがあります。 何故なのかよく分かりません。 その設定方法などがあるのであれば、教えて頂きたいです。 画面の設定方法、そして、VBAでもやり方があるのであれば・・・ よろしくお願いします。
c.execute('''CREATE TABLE stocks (date text, trans text, symbol text, qty real, price real)''') すると、date, trans, symbol, qty, price等のフィールドが用意されます。 c.execute("SELECT * FROM stocks") すると、その登録内容を得ることが出来ます。 ところで、登録内容を得る前に、選ばれる対象となる"date","trans", ...等のフィールド名を得る方法はありませんか。 環境はWindows、Python 2.7です。
売上トランと商品マスタがあるとします。 商品マスタは廃止フラグをVARCHAR2(1)で保持していて、 1なら廃止、0なら今販売中で、 商品マスタは全件で100万件あり、そのうち95万件は既に廃止になっているとします。 このとき、 SELECT 売上トラン.* , 商品マスタ.商品名称 FROM 売上トラン INNER JOIN 商品マスタ ON 売上トラン.商品コード = 商品マスタ.商品名称 WHERE 商品マスタ.削除フラグ = '0' と書くのと、 SELECT 売上トラン.* , 商品マスタ.商品名称 FROM 売上トラン INNER JOIN (SELECT * FROM 商品マスタ WHERE 商品マスタ.削除フラグ = '0') 商品マスタ ON 売上トラン.商品コード = 商品マスタ.商品名称 と書くのだと、検索は下の方が速くなったりしますか？ イメージですが、 上だと全件同士でくっつけた後で削るのに対して、 下だと削って5万件だけになったものをっつけていて、下の書き方の方が良いのかな？ と思ったものの、どこかの本などでこういう書き方が良いと読んだわけではないので、 イメージであっているのか、それとも変わらないのか質問しました。 また、削除フラグのように1か0の2値しかとらない項目については、 INDEXを張る効果はあるでしょうか？ ちなみにverで挙動が変わるかわかりませんが、環境はoracle11gを想定した場合となります。
こんばんは ＰＨＰ+ＭｙＳＱＬで１月～12月までのテーブルがあるのですが 1行目から12月のデータを1行目から1月のデータを取得して 並べて表示したいのですが、どういうコードを書けばいいか すみませんが、教えてください。 お願いします。
Access2013 vba 単票フォームFormAがあり、そこにタブTabBを配置します。 そのタブの中に、サブフォームフレームSubFmFrameを配置 このフレームの中に、サブフォーム SubFormがあるとします。 その時、サブフォームのイベントで何かの処理をスル場合に、自分のフォームのフィールドの値を取得するのには、親フォームから参照したやり方をしなくてはいけないのでしょうか。 その場合の書き方がわかりません。 サブフォームから、Set objP = Me.Parent としても、エラーになります。 親フォーム：FormA タブ：TabB サブフォームフレーム：SubFmFrame サブフォーム名：SubForm 宜しくお願いします。
結論だけでいいです。 Python 2.7で、SQLite3のFTSを使える　□YES/□NO 当然使えると思って前準備まで全部行ったのに、実際に登録しようとしたら出来ず調べると、ソースからコンパイルとか何かを介するとか何かをダウンローダするとか... これでは私的にはNOです。
今までの経緯は以下です： http://oshiete.goo.ne.jp/qa/8863196.html http://oshiete.goo.ne.jp/qa/8863915.html 実は、当該問題が消えました。 特段、対処はしていません。 その後、問題発生前と同様に使っていました。 そして先ほど、同問題が発生しました。 前回までの助言を参照し、データベース本体を発見しました。 C:>dir "C:\Program Files\MySQL\MySQL Server 5.0\data\XXX" /B db.opt dic.frm dic.MYD dic.MYI list.txt dic.MYDとdic.MYIの２つだと思われます。 そして、その両方が読み込み専用で無いことが分かりました。 もう殆ど諦めていますが、何か対処方法があってら教えて下さい。
select文の記述について質問させていただきます。 下記のデータベースのテーブルの先頭からnumberを条件として ２名分のデータをselect文にて抽出したいと思っております。 (numberが重複し、重複数も異なるデータとなります。） select文の記述をどのようにするか教えていただければと思っております。 よろしくお願いいたします。 データベースのテーブル +——+—————+—————+————+ | id | name | number | score | +——+—————+—————+————+ | 1 | tanaka | 358 | 98 | | 3 | tanaka | 358 | 23 | | 4 | tanaka | 358 | 45 | | 11 | yamada | 126 | 63 | | 17 | yamada | 126 | 77 | | 23 | suzuki | 274 | 36 | | 45 | suzuki | 274 | 16 | | 59 | suzuki | 274 | 89 | | 73 | suzuki | 274 | 75 | | 80 | hanako | 89 | 24 | | (以下続く) | +——+—————+—————+————+ 抽出結果 +——+—————+—————+————+ | id | name | number | score | +——+—————+—————+————+ | 1 | tanaka | 358 | 98 | | 3 | tanaka | 358 | 23 | | 4 | tanaka | 358 | 45 | | 11 | yamada | 126 | 63 | | 17 | yamada | 126 | 77 | +——+—————+—————+————+
【Access2013/VBA】 ■テーブル構成 【分析テーブル】 ・分析ID（主キー） ・依頼ID（外部キー） ・会社ID 【会社管理テーブル】 ・会社ID（主キー） ・会社名 ■コード 　　Dim Rst As DAO.Recordset 　　Dim Db As DAO.Database 　　Dim SQL As String 　　Dim lngID As Long 　　Dim FlgWinLoad As Boolean 　　 　　Me.FlgWinLoad = modPub.FlgWindowLoading 　　 　　lngID = modPub.Selected依頼ID 　　 　　'コンボボックスの設定 　　SQL = "SELECT DISTINCT [分析テーブル].[会社ID] as [会社ID1], " 　　SQL = SQL & "　[分析テーブル].[依頼ID], " 　　SQL = SQL & "　[会社管理テーブル].[会社ID] AS [会社ID2], " 　　SQL = SQL & "　[分析テーブル].[会社ID] AS [会社ID3], " 　　SQL = SQL & "　[会社管理テーブル].[会社名] " 　　SQL = SQL & "FROM [分析テーブル] LEFT JOIN [会社管理テーブル] ON " 　　SQL = SQL & "　[分析テーブル].[会社ID] = [会社管理テーブル].[会社ID] " 　　SQL = SQL & "where [依頼ID]=" & lngID & " " 　　SQL = SQL & "ORDER BY [分析テーブル].[依頼ID] " 　　Set Db = CurrentDb 　　Set Rst = Db.OpenRecordset(SQL, dbOpenDynaset) 　　If Rst.EOF = True And Rst.EOF = True Then 　　　　GoTo errH 　　　　 　　End If 　　 　　Me.cmbo会社ID.ColumnCount = 5 　　Me.cmbo会社ID.ColumnWidth = "1cm;1cm;1cm;3cm;3cm" 　　Me.cmbo会社ID.RowSource = "会社ID1;依頼ID;会社ID2;会社ID3;会社名" 　　Me.cmbo施工会社ID.RowSourceType = "テーブル/クエリ" 　　 　　Set Me.cmbo施工会社ID.Recordset = Rst.Clone 　　 ■コード　の終わり エラーになりませんが、画面でコンボボックスのリストが空になります。 解決方法を教えて頂きたいと思います。 よろしくお願いします。
地域計: DCount("市区町村","テーブル名") 今上記の状態で止まっています。 下記のようなテーブルがあるとします。 都道府県　市区町村 東京都　　新宿区 東京都　　豊島区 東京都　　葛飾区 東京都　　新宿区 東京都　　新宿区 東京都　　葛飾区 東京都　　豊島区 東京都　　豊島区 東京都　　豊島区 この中で新宿区は何件、豊島区は何件、葛飾区は何件、と出したいです。 しかし、都道府県市区町村は変動します。 毎回変わるのです。 なので特定の文字列を検索するというよりは その時にそのテーブルに貼った市区町村別に何件ずつ入ってるか、を求めたいです。 地域計をだしたいのです。 只今集計クエリで○○: Sum(IIf([フィールド名]="○○",1,0)) で○○の件数は何件かを出しているのですが この○○はどの地域でも変わらないため、指定できるのですが 地域は変わってしまう為指定できません。 ○○の隣に地域計を出したいのですが どうすればいいでしょうか。
下記の式で実行するとクエリ式’Format((NZ([フロントNG]))/(NZ([後確NG])+NZ([エントリー後NG])+NZ([アンテナ後確NG])+(NZ([フロントNG])+NZ([決裁者NG])+NZ([アンテナNG])+NZ([検討NG])+NZ([対象回線済NG])+NZ([NG])),"0%") AS フロントNG率 FROM t_エクセル貼り付け;　の構文エラー：演算子がありません。 というエラーが出ます。 SELECT t_エクセル貼り付け.地域, Format((NZ([フロントNG]))/(NZ([後確NG])+NZ([エントリー後NG])+NZ([アンテナ後確NG])+(NZ([フロントNG])+NZ([決裁者NG])+NZ([アンテナNG])+NZ([検討NG])+NZ([対象回線済NG])+NZ([NG])),"0%") AS フロントNG率 FROM t_エクセル貼り付け; アラビア数字使ってないですし、フィールド名も[]ついています。 なにかおかしいところありますか？？
はじめて投稿いたします。 なにか不手際がございましたら申し訳ありません。 Access作成についてご指南をいただけますでしょうか。 初心者なので当たり前のことをお伺いしていたら申し訳ありません。 ネットで色々調べたのですが、全く解決しなかったのでお願いします。 今回作るAccessはおそらく集計クエリを使うのだろうとうっすらと思っているのですが… なお、当方コールセンター勤務です。 まず、Accessとは全く関係のないシステムがあり、 そのシステムを使って電話をかけた数(コール数)や フラグ立て(大まかに言うと留守だったのか在宅だったのかなど)をします。 そのシステムからエクセルをエクスポートすると 東京都新宿区 大阪府大阪市 愛知県名古屋市 京都府京都市 ・・・ のようにA列に地域名が縦に並びます。 1行目は見出しとして例えばですがB1に「在宅」C1に「留守」D1に「OK」E1に「NG」F1に「改め」G1に「計」とあります。(これが立てたフラグです。) その地域の電話結果のフラグが何件か、というのが分かるエクセルです。 例えば東京都新宿区は「在宅」５、「留守」８、「OK」0(エクセル上では空白)、「NG」2、「改め」4、「計」19 といった形です。 現在そのエクセルデータを貼り付けるテーブルを作りました。 今回このデータを使って在宅している率を出したいです。 式は、（「在宅」+「OK」+「NG」+「改め」）/「計」＝在宅率(％) クエリを実行した際、地域フィールドに地域名がレコードごとにでて、 隣の在宅率フィールドにそれぞれの地域の在宅率が出るようにしたいのです。 エクセルだと思いつくのですが これをAccessでやろうとするとどのようにすればよいのでしょうか。 ご教授いただけますようお願いします。
Ruby on RailsのデータベースとしてMy SQLを使いたいと思っています。 ですが、現在持っている本ではインタフェースが変わっているのか上手くいかないので御教示をお願いします。 特にConnectorとかがよく分かりません。 そこで一からMySQLをインストールし直そうと思っています。 環境は、 ・Windows7　32ビット ・Rails 3.2.19 ・ruby 1.9.3p545 (2014-02-24) [i386-mingw32] となっております。 宜しくお願い致します！
メインフォームとサブフォームの画面゛て レコードソースは、ワークテーブルを参照し メインフォームの保存ボタンの処理で、 Private Sub 保存ボタン_Click() 　Set mySubFm = Me![テーブル子].Form 　Set myParFm = Forms(Me.name) '<== 親フォーム 　Set Rec1 = myParFm.RecordsetClone 　Set Rec2 = mySubFm.RecordsetClone 　Lng受注ID = Rec1.Fields("受注ID").Value 　Dim Rtn As Integer 　・レコードセットのデータを、本テーブルに更新する処理 　・自動採番した番号を、レコードセットのIDのフィールドにセット 　　Rec1.Edit 　　Rec1.Fields("ID").value = newID 　　Rec1.Update 　・Me.Requery '<== メインフォームの画面を更新 　・mySubFm.Requery '<==サブフォームの画面を更新 　Set Rec1 = Nothing 　 Set Rec2 = nothing End Sub この処理を一度行い、更に、画面のサブレコードの値を変更して、保存ボタンを再度押すと、 Lng受注ID = Rec1.Fields("受注ID").Value の行で、 「オブジェクトが正しくないか、現在設定されていません」というエラーになります。 この原因はどうしたら解決出来ますでしょうか？ よろしくお願いします。
Access2013 VBAで ■テーブルa ・id ・名前 ・id2 とあり このテーブルのレコードセットを以下のように作ります。 dim Rec = dao.Recordset Set Db = CurrentDB set Rec = Db.OpenRecordset("Select * from [テーブルa] where id2 = " & 2, dbOpenDynaset) この時、このテーブルにid2=2のレコードが何もない場合、この生成したRecで、 Rec.AddNew Rec.Fields("名前").value = "名前" Rec.Update と出来ますでしょうか？ よろしくお願いします。
windows７上のphpmyadmin(xamppについてくるもの）で、行を挿入しようとしたら、 Warning: #1366 Incorrect string value: '\xE3\x81\xAF\xE3\x81\x98...' for column 'note' at row 1 と言われてしまいまして、行を表示させてみると、マルチバイトのところが、?????と表示されてます。 これは、どうすれば対応できるのでしょうか？ よろしくお願い申し上げます。
Access2013 VBA 今、アクセスのシステムを作っていますが、おおまかに書きますと ・フロントエンドとバックエンド ・ワークテーブルを使用してデータの編集をして、元テーブルに反映する処理 ・4人ぐらいの利用者を想定 この場合に、 ・レコードロックのようなやり方が可能か ・DAOを使用する場合に、今変更をしようとしているレコードにロックをかける方法はあるのか ・既に他の画面で開いている画面のレコードソースのテーブルを、後から開いた別画面の処理でOpenRecordsetでレコードセットを取得し、そのレコードを編集・新規追加したいのですが、この場合には、Optionには何を使用すれば良いでしょうか？ ※先に開いている人には読み取りは可能 ※後から開いた人は、データの編集が可能にする ※先に開いた人が、後から開いた人がデータの編集をしている時に該当レコードの変更は出来ないようにしたい よろしくお願いします。 よろしくお願いします。
質問した内容は以下にあります。 http://oshiete.goo.ne.jp/qa/8863196.html 先ほど、指示されたホームページに行ったら、以下の内容が表示されるようになっていました。 「Table '○○○' is read only」 4.パーミッションを660に chmod 5.オーナーをmysqldに chown 6.グループ権限をmysqldに 7.再起動 残念ながら、上記の4,5,6とも具体的な作業内容が分かりません。 詳しい方、解説をお願いします。
ローカルに作られたMySQLのデータベースがあります。それは英語辞書をデータベース化したものです。 構造は head,body = 'computer', 'コンピューター' head,body = 'person', '人' ... という、単純なものです。 突然、使えなくなりました。 次の状態です。 mysql> SELECT body FROM dic WHERE head='computer'; ERROR 1194 (HY000): Table 'dic' is marked as crashed and should be repaired そこで、ネット情報を参考にして、 mysql> REPAIR TABLE dic; +--------------+--------+----------+-----------------------------------+ | Table | Op | Msg_type | Msg_text | +--------------+--------+----------+-----------------------------------+ | xxx.dic | repair | error | Table 'xxx.dic' is read only | +--------------+--------+----------+-----------------------------------+ 1 row in set, 1 warning (0.00 sec) としましたが、問題は解決されません。 どうすれば良いのでしょうか。
ユーザ環境の制限により、ミストが多い環境にFANレスPCを設置して、別の場所にNASを設置することになりました。 NASにSQL Server2008R2のインスタンスを作成したいのですが、FANレスPCでインストール時にNASドライブを認識できず困ってます。 NASをネットワークドライブに割り当てても、コンピュータ名「\\NAS\MSSQLSERVER」で指定しても認識できません。 また、いったんSQL Serverをローカルドライブ（C:\）にインストールして、 SQL Server Management StudioでMDFをデダッチして NASドライブ（ネットワークドライブ）にアタッチしようとすると 「特殊なセキュリティ権限・・・」でエラーとなります。 SQL Serverのサービスのログインは 　・Network Service 　・Local System 　・Windowsログインユーザ（Admini権限） で試しましたが症状は変わりませんでした。 NASはバッファロー製の TS-X2.0TL/R5 を使ってます。 なお、USB外付けHDDにはSQL Serverのインスタンスをインストールできることは確認してます。 対策方法の助言いただけると幸いです。
【Access 2013 vba】 テーブルのあるレコードを削除しても、そのIDを使用している別テーブルには影響を与えたくない場合、つまり、別テーブルのIDの値は消したくない場合には、どのようなリレーションシップにしたらよいでしょうか。 因みに、このテーブルの編集画面フォームAでは、3つのクエリーを作成しその最後のクエリーQ3をレコードセットとして参照しています。 以下参照 【Table1】 　・受注ID（主キー） 　・日時 　・部屋ID（Ex.Key) 【Table2】 　・部屋ID（主キー） 　・建物ID（Ex.Key) 　・部屋の情報 【Table3】 　・建物ID（主キー） 　・建物の情報 　・所有者ID（Ex.Key) 【Table4】 　・所有者ID（主キー） 　・所有者の名前 <<Q1>>→Table1+Table2 　<Table1> 　　・受注ID 　　・部屋ID2（外部キー）→Table2部屋の部屋ID　⇐　※　ここが、問題のリレーションシップです。 　<Table2> 　　・部屋ID...主キー <<Q2>>→Q1+Table3 　<Q1> 　　・Q1のTable2の建物ID（外部キー）→Table3の建物ID 　<Table3> 　　・建物ID <<Q3>>→Q2+Table4 　<Q2> 　　・Q2のTable3の所有者ID（外部キー）→Table4の所有者ID 　<Table4> 　　・所有者ID このようにクエリーを作成し、Q3をフォームのレコードソースとしたフォームAを使用しています。 このフォームで、<<Q1>>の※印の行のTable2から取得するIDをTable1の項目「部屋ID2」に保存していますがTable2の方にあるレコードを削除しそのIDがなくなっても、Table1には影響しないようにしたいのです。 よろしくお願いします。
【Access 2013 VBA】 今、Workテーブルメイン、Workテーブルサブがあり、それをレコードソースにしたメインフォームとそのサブフォームがあります。 この画面で、サブの帳票のレコードを編集し、また、新規入力したものから 本になるテーブルのメインとサブに更新をする処理を作っています。 その更新先のレコードセットのSQLは以下のとおりです。 SQL = "SELECT " SQL = SQL & "[SubTable].*, " SQL = SQL & "[MainTable].* " SQL = SQL & "FROM [SubTable] " SQL = SQL & "LEFT JOIN [MainTable] ON " SQL = SQL & "[SubTable].[ID] = [MainTable].[ID]" この時、Recのフィールドの値を行進する時はいいのですが、 SubTableに新規レコードを追加する場合、 どのようにすれば良いのかわかりません。 普通にRec.AddNewとすると 上のMainTableにも新規レコードができるのでしょうか？ よろしくお願いします。
“ERROR 1206 (HY000): The total number of locks exceeds the lock table size”エラーが発生する場合の対処方法について教えてください。 /etc/my.cnfの“innodb_buffer_pool_size”を大きくするのが解決策ですので innodb_buffer_pool_size = 2G のように最大値に変更してみましたが、解決しませんでした。 一応、 max_connections も減らしてみましたが、解決しません。 PHPからMySQLにコネクションを接続し続けて切断するような処理はしていませんが、問題ありますでしょうか？（最初にmysql_connectで接続し、プログラムが終了するまで、何回もmysql_queryでSQL文(SELECTやUPDATE等)を実行しています。） 一概に言えませんが、データベースをバックアップでテキストで出力しても、300Mbyteくらいのデータですが、２Gのメモリを使うのでしょうか？ 物理メモリを増やして innodb_buffer_pool_size を増やすしか解決方法がないのかご教授頂きたいです。 （ロックするテーブルは同時に1個しかしていないです。） 詳細な内容は提示していないので、わかりにくいですが、ご指摘頂ければ提示します。 設定や状態確認や見ておくべき点などが提案ベースでも教えて頂ければ幸いです。 すいませんがよろしくお願いします。
このジャンルでお願いします。 例えば次のようなアカウント情報を格納するテーブルがあったとして CREATE TABLE user ( 　id int(11) NOT NULL AUTO_INCREMENT, 　name varchar(64), 　email varchar(64), 　password varchar(64), 　PRIMARY KEY(id) ); idカラム名を「id」か「user_id」にするか悩んでいます。 自分としては「id」のままで良いと思っているのですが、 参考書や他の方のやり方を見てると「user_id」のようにしてる方もいます。 「user_id」にすることによってSQL文を見た時にも何のidかすぐ分かるし、 USING句を使えるなどのメリットがあるのでたしかにこちらの方が良いかなぁとは思うのですが、 「user_id」にするなら統一性をもたせるために「name」も「user_name」にするのか、 「email」も「user_email」にするのか、などキリがないというか・・・ そういう理由もあって自分としては「id」のままなのですが、 みなさんはどちらのやり方をされているのでしょうか？
エクセルにて、 一列で１００行、２００行もあるデーターを Shift＋↓かドラックして選択をしています。 選択する時間が結構かかります。 Ctrl＋↓をすると最後に飛ぶだけでした。 瞬時に選択したい列の行を選択する方法を教えてください。 すみませんが教えてください。
ここに、親フォームと子フォーム（サブフォーム）があって 子フォームのレコードソースは、Workテーブルとします。 子フォームを編集・新規レコード追加すると、 親フォームの保存ボタン処理で、子フォームのレコード内容をWorkから、元テーブルに更新をかける知りをつくろうと考えています。 この時、 子側の帳票のレコードを編集したり、新規レコードを追加している時には ■『親側で、別のレコードに移動出来ないようにし、親側にある「保存」ボタンを押して、上記の処理をしたあとに、親側で別レコードに移動できる』　ような作りにしたいです。 これを実現するために、上の■『・・・』を実現できるようにするのには、どのようにしたら良いでしょうか？ よろしくお願いします。
SQLiteのREAL型についてC#プログラミングでfloat型として扱う場合に、 Insert文でREAL型に「9999999.999999」と値を入れた場合に Select文で値を取得すると、「1E+07」で返ってきました。 「9999999.999999」という値で取得する方法がわからないためご教授いただきたいです。 申し訳ございませんが、よろしくお願いします。
[Access2013 vba] ■したいこと サブフォームのレコードの中から、一レコードだけをチェックボックスなどで選択したいのですが、どのようにしたら出来ますでしょうか。 複数行選択は出来ないようにしたいです。 選択したのち、メインフォームの選択ボタンを押すと、そのレコードのID番号を取得して、呼出元のフォームのIDフィールドに代入したいです。 ■画面の流れ・・・ Aフォーム　→　帳票型Bフォームで、レコードを選び「開く」ボタンを押す→ B 'メインフォームとCサブフォーム）が開く Cサブフォームのレコードをチェックボックスにチェックを入れて選択する B ' メインフォームの「選択」ボタンを押すと B ' メインフォームと、その前のBフォームが閉じて Aフォームに戻り、AフォームのIDフィールドに選択したIDが格納される。 よろしくお願いします。
当方Macユーザです。 ターミナル（≒コマンドプロンプト）でスーパーユーザで作ったデータベースが、phpMyAdmin（以下Admin）で見られません。 Adminでは、pmaというユーザにすべての権限を与え、このユーザでデータベースを閲覧しています。 ターミナルにおいて、pmaでログインしてshow databases;をすると、該当のデータベース名が表示されているので、ターミナルでは見られるのですが…。 OpenPNEのメンバー管理をしたいので、ターミナル上では操作したくありません。どうかAdminでデータベースが見られるよう、お知恵をお貸しください。
お世話になります。 　当方、SQL server expressを使用しており、以下の２テーブルをフローIDで内部結合しています。 test1　　　　　　　　　test2 順番、フローID　　　通番、フローID、タイトル　更新日時 1　　　　1　　　　　　　1　　　　1　　　　てすと　　　12/1 2　　　　2　 　　　　　 2　　　　1　　　　 テスト２　　12/2 3 　　　 3　　　　　　　3　　　　2　　　　テスト３　　　12/3 　　　　　　　　　 　　　4　　　　3　　　　テスト４　　　12/4 SELECT * FROM test1 INNER JOIN test2 ON (test1.フローID=test2.フローID) 結果 順番　フローID　　　通番　フローID　タイトル　更新日時 1　　　　1　　　　　　　1　　　1　　　てすと　　　12/1 1　　　　1　 　　　　　 2　　　1　　　 テスト２　　12/2 2 　　　 2　　　　　　　3　　　2　　　テスト３　　　12/3 3　　　 3　　　　　　　 4　　　3　　　テスト４　　　12/4 　ここで、順番＝１の行で指定されているフローIDがテーブルtest2に二行存在するため、結合した結果も順番＝１に対して二行になっています。 　これを、test2のフローIDが重複する場合はtest2の更新日時が新しいほうだけを表示するようにしたいと考えています。 　ご教授頂けますと幸いです。 　感覚としては、test2テーブルをgroup by句でまとめたものをテーブルとして定義して、内部結合できればよさそうなのですが、上手い資料が見つかりませんでした。 　クエリでも、ストアドプロシージャとしての実行でも構いません。
このジャンルでお願いします。 次のようなテーブルで CREATE TABLE IF NOT EXISTS item ( id int(11) NOT NULL AUTO_INCREMENT, name varchar(32) NOT NULL, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO item (name) VALUES ('item1'); INSERT INTO item (name) VALUES ('item2'); INSERT INTO item (name) VALUES ('item3'); INSERT INTO item (name) VALUES ('item4'); INSERT INTO item (name) VALUES ('item5'); INSERT INTO item (name) VALUES ('item6'); CREATE TABLE IF NOT EXISTS treepath ( ancestor_id int(11) NOT NULL, descendant_id int(11) NOT NULL, FOREIGN KEY (ancestor_id) REFERENCES item(id) ON DELETE CASCADE ON UPDATE CASCADE, FOREIGN KEY (descendant_id) REFERENCES item(id) ON DELETE CASCADE ON UPDATE CASCADE, PRIMARY KEY(ancestor_id, descendant_id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO treepath (ancestor_id, descendant_id) VALUES (1, 1); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (1, 2); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (1, 3); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (1, 4); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (1, 5); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (1, 6); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (2, 2); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (2, 4); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (2, 5); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (2, 6); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (3, 3); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (4, 4); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (4, 6); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (5, 5); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (6, 6); item1┬item2 　　　│　├item4 　　　│　│　　└item6 　　　│　└item5 　　　│ 　　　└item3 を item1┬item2 　　　│　│　　 　　　│　└item5 　　　│ 　　　└item3 　　　　　└item4 　　　　　　　└item6 のようにitem4以下のノードをitem3の下に移したいのですが、 その場合のtreepathテーブルの更新はどのようなSQL文にすれば良いのでしょうか？
フォームを以下の手順で作成し、 1. 4つぐらいのテーブル間でリレーションを設定 2. その中の1つのテーブルから、フォームの自動作成 3. 出来たフォームのレコードソースの「・・・」ボタンをクリックして、1で設定した3つのテーブルを追加し、必要な項目を追加して、その設定内容を保存 　→最初のテーブルは「テーブル名.*」として一覧に追加、その他のテーブルは、必要な項目だけを追加 4. デザインモードで、フォームの項目を追加してフォームを作成 再度、フォームのレコードソースを開くと、中身が消えてしまい、何もありません。 そして、エラーがおき、「「*」を有効なフィールド名、式として認識出来ません」というようなエラーになり、表示できません。 複数のテーブルを連結してレコードソースにスル場合、このようなエラーが起きるのでしょうか。また、解決方法なども教えていただけると助かります。 よろしくお願いします。
Windows7/FileMaker13v2使用です。 以下の手順で、外部保存したPDFファイルを開くスクリプトを作成したいのですが、思ったように動作しません。 １）オブジェクトフィールド：tbl::obj 　　[オブジェクトフィールドを外部に保存]にて 　　・保存先：[データベースの場所]/test/ 　　・オープン格納："tbl/obj/" 　　→フィールドに、「ファイル名.PDF」を登録し、上記保存先に格納されることを確認しました。 2)スクリプト 　　・変数を設定[$wk; GetValue ( tbl::obj ; 2 )] 　　・Event送信[「aevt」; 「odoc」; 「$wk」] 　　※$wkの値は「FILE:tbl/obj/ファイル名.PDF」になっていました。 →2)のスクリプトを実行すると、、「ファイル[ファイル名.PDF]が見つからなかったため、処理を完了できません。」と出てきます。 フィールド参照にせず固定パスにしたところPDFファイルは開きました。 GetValueの取り方が間違っているのかと予想するのですが、どのように取得するとEvent送信で有効になるのでしょうか？
AWSにあるデータベースをまるごと移行する場合、ローカルにエクスポートしないで移行できる方法があれば教えてください。 AWSは別アカウント、別インスタンスとなります。 よろしくお願いします。
Bツリーのインデックスで、階層数が増えるとパフォーマンスが悪化するとありますが、なぜでしょうか。 データ量が膨大な場合は、むしろパフォーマンスが上がるような気がしてならないのですが・・・ 例えば階層が3から4に増えた場合、検索時に単にIOが1回増えるだけのように思えますが、その1回のコストを問題にしているということなのでしょうか？ 基本的な質問ですみませんが、よろしくお願いします。 （削除リーフ数はゼロという前提で）
一つのページから別々のテーブルにデータをINSERTしたいのですが、"id"と"number"は同じ値でそれぞれのテーブルにいれたいのですが、どうやってやるのでしょうか？ 下のPHPのコード(一部)でデータを流してみたのですが、このままやると、もしデータに不具合があって片方だけ登録されないことがあると、一方は登録されて、一方は登録されないという事態が発生してしまい、"id"が違う番号で登録されてしまう可能性があります。 id int(8) NOT NULL AUTO_INCREMENT で"id"は作りました！ $insertSQL1 = sprintf("INSERT INTO tbl1 (id, number, name, price) VALUES (%s, %s, %s, %s)", GetSQLValueString($_POST['id'], "int"), GetSQLValueString($_POST['number'], "text"), GetSQLValueString($_POST['name'], "text"), GetSQLValueString($_POST['price'], "int")); $insertSQL2 = sprintf("INSERT INTO tbl2 (id, number, ename, eprice, extra) VALUES (%s, %s, %s, %s, %s)", GetSQLValueString($_POST['id'], "int"), GetSQLValueString($_POST['number'], "text"), GetSQLValueString($_POST['ename'], "text"), GetSQLValueString($_POST['eprice'], "int"), GetSQLValueString($_POST['extra'], "text")); 別々のテーブルで共通のidを使う方法はないでしょうか？ phpMyAdminのSQLを使ってます。 回答よろしくおねがいします！
現在、数種のデータを格納したファイルが会社のサーバーに保管されています。 各フォルダのデータを閲覧するためルートを作ってあげて目的のフォルダをひらけるようにしたいと考えております。 シートごとに検索項目を設定し、マクロ記録モードでファイルを開く手前まで作成できたのですが、フォルダを開くのがうまくいきません。 フォルダを開くマクロがあれば、教えていただけないでしょうか。 よろしくお願いします。
Access2013 vba あるテーブルの構成が以下のようになっていますが □テーブル構成 ・ID(Long) ・建物NO(外部キー/Long) ・部屋番号（文字列） この時、建物NOと部屋番号の組み合わせで、一意の値にしたい場合、どのようにしたら良いでしょうか。 よろしくお願いします。
sqlite3をVC++2013で扱っています。 もしかしたら、単純な方法があるのかもしれないので質問させてください。 DBに渡す文字が'ABC'でDB内のデータ'AB'にHITさせたいと思っています。 現状思いつく方法は select * from テーブル where キー like 'A%'; select * from テーブル where キー like 'AB%'; select * from テーブル where キー like 'ABC%'; と渡す文字を一文字ずつ増やして検索して row数が0以上の一番小さい数のデータを取得するという方法しか思いつかないのですが。 何か良い方法はありますでしょうか？
Access2013 で、現在システムを開発しているところですが、 フォーム上の帳票のボタンを押した時の処理が、複数の画面で共通なので共通処理として使用したいと考えていますが、その時に、画面のフィールドの名前を変数に変えてどのように画面のフィールドに値をセットすればよいでしょうか。 よろしくお願いします。
PHPMyAdminのSQLのコマンドで、 もしdata001がNullだったら、data001に"1"というデータをいれる。 もしdata001がNullじゃないかつdata002がNullだったら、data002に"1"というデータをいれる。 このようなSQLのコマンドはどうやって打つのでしょうか。 回答よろしくおねがいします！
マクロのコードについて質問させていただきます。 シート1のA1の値をシート2のA1に自動で反映させるマクロを教えていただけないでしょうか。
Access ADOでフォームのコントロールを参照するパラメータークエリーを開こうとすると、どうしても「SQLステートメントが正しくありません・・・」のエラーが発生してしまいます。 もちろん、クエリー単体では正常に動作しますが、クエリーのパラメーターに参照するコントロールを登録してもADOでは開けません。 現在はパラメータークエリーの抽出結果を一時テーブルに書き込んで、これをADOで開くという非効率極まりない方法で凌いでいますが、どうすれば良いのでしょうか。
Access2013で、フロントエンドとバックエンドにファイルを分割し、ネットワーク上にバックを配置して、最高三人ぐらいの人数で使用するような形をとろうかと考えています。 この場合、アクセスはこわれたりすることはありうるのでしょうか？ また、普段のアクセスのメンテナンスの仕方について ACCESSは、データの最大許容量が2GBとありますが、これに対する対応として、どのようなやり方があるか知りたいです。（レコードを削除したりするのではなく違う方法で） 私が考えているのに、MS SQL Serverに移行するという手段があります。 その他の対応方法を知りたいです。 よろしくお願いします。
1000件データがあって、ソートして20件にしたとします。その20件に連番を１から振って、その数字をエクスポートしたいです。ソート後のレコード番号を取得できる関数があるならそれでもかまいませんし、エクスポートで直接連番が書き出せるならその方がもっと助かります。 方法をご存知でしたら、ぜひご回答よろしくお願いいたします。
列区切なし、改行コードなしの固定長データをSQLにコンバートしたいのですが、上手く行かず困っています。 （ファイル形式：テキストファイルバイナリ固定長） 　・試した方法 　　BULK INSERT　 　　 添付画像のようなデータをSQLサーバに取り込みたいのですが 　上手く読み込みができません。 　添付画像のようなデータは取り出せないのでしょうか？　 　宜しくお願いします。。
Access2013で、自前で採番処理をスル場合 以下のどちらが正しいでしょうか？ 1) フォームの保存ボタンで、採番管理テーブルを参照して、現在の主キーのID番号を取得して、それに+1したものを採番管理テーブルに保存し、エラーがなければ、画面にセットして保存。 2) フォームのレコードソースのID番号の最大値を取得して、それに+1加算したものを採番管理テーブルに保存し、エラーがなければ、画面にセットし保存。 1) 2)どちらも、採番管理テーブルに+1した番号を保存する時にエラーが起きたら、画面は Me.Undoする。 よろしくお願いします。
今日は。 データベースは(One to many)データベースです。 私書いたコードは myDataContext obj = new myDataContext(); Language Lang = (from p in myDataContext .Language s where p.Id == 2 select p).Single(); if (Lang != null) { Lang .Language = "India"; db.SubmitChanges(); } 困っているから、宜しくお願い致します。
テーブルに例えば、県名の文字列が入っているフィールドがあってrecord数が何千県とあるとします。 この文字列を簡単に、数値に変えて、それをマスター管理したいとすると、一番簡単に変えられる方法って何でしょうか？手間かけずに。こういう値の変更が簡単にできる方法があると、管理しやすいのですが・・・
ただいま、フォーム上のあるテキストボックスのコントロールソースに以下のような式を入れています。 「=DLookUp("[M00マスター]![個人名]","[M00マスター]","[M00マスター]![個人ID]=[K00オーナーテーブル]![個人ID]")」 このフォームは、K00オーナーテーブルがコントロールソースとなっています。 しかし、このテキストボックスには、エラーと出て、しかも、ずっと点滅し続けています。 この原因がお分かりになるかた、いませんでしょうか。 よろしくお願いします。
ある、スクリプト内にスナップショット取得するコマンドを加えたいです。 引数を7つ指定します。 書き方を教えてください。 スペース、記号等に注意して色々試しましたが上手くいきません。。 指定したい引数は以下です。 i_snap_level= i_execution_th= i_disk_reads_th= i_parce_calls_th= i_buffer_gets_th= i_sharable_mem_th= i_version_count_th= どうぞ、宜しくお願いします。
Access2000のクエリの抽出項目をExcel2013の内容を抽出項目として指定するにはどうすればよいでしょうか。 Excelには、 佐藤 田中 鈴木 ......... のように縦に名前が最大18名分入っています。 この（最大）18名の名前をAccessの抽出項目とします（フィールドは10あってその6番目に抽出項目を18名分入力したいのです）。 18名を一人一人コピペしていたのですが、何とか簡素化できないものかな？と思っています。 できれば、マクロで一発で抽出項目を貼り付けたいのですが。 よろしくお願いします。
こんばんは 次のような2つのテーブルを参照して条件を指定するUPDATE文はどのように書けばよいのでしょうか? Parentsテーブル ID, Name, HasChild, AGE 1, Tanaka, True, 20 2, Yamamoto, False, 25 3, Suzuki, True, 30 4, Kobayashi, True, 20 5, Sato, True, 25 Children ID, Name, ParentID, Male, Flag 1, Taro, 1, True, 0 2, Hanako, 1, False, 0 3, Ichiro, 3, True, 0 4, Jiro, 4, True, 0 5, Subroh, 5, True, 0 やりたいこと：20歳の親を持つ男の子のみにフラグを付ける Parentテーブルで、親が子持ち（HasChild = True）で、年齢が20歳の人だけを対象に Childrenテーブルでその親の子（Parents.ID = Children.ParentID）が男の子（Male = True)だった場合、 Flag を 0 から 1 に変更する 実行結果 Children ID, Name, ParentID, Male, Flag 1, Taro, 1, True, 1 2, Hanako, 1, False, 0 3, Ichiro, 3, True, 0 4, Jiro, 4, True, 1 5, Subroh, 5, True, 0 結果は、Tanaka TaroくんとKobayashi Jiroくんのフラグが1になります。 複数テーブルのSELECTについては勉強してきましたが、こういうパターンは初めてでわかりません。エクセルVBAから.mdbファイルを扱う時に使います。Microsoft.Jet.OLEDB.4.0のADODB.Connectionを使っています。 よろしくお願いします。
自前の採番処理を作成するのが初めてなので質問したいのですが 自前の採番処理をしてオートナンバー型を主キーで使用しないようにすると、リレーションが、参照整合性のところが設定出来ません。自動連鎖更新など。 これは、普通のことでしょうか？ あと、MainとSubのFormがある場合、Subフォームでの自動採番処理はどのようにすれば良いでしょうか？ よろしくお願いします。
同じレコードソースを持つ帳票フォームAとポップアップ画面Bがあり 新規作成ボタンイベントで、Aからで新規入力用のB画面を acAddNew, acDialogで開き 新規レーコドを追加する作業をして B画面の保存ボタンを押すことでしてレコードを保存しています。 ◆B画面の保存ボタンの処理 Private Sub cmd保存_Click() 　　'保存処理 　　Dim i As Long 　　Dim NewKey As Long 　　Dim SQL As String 　　Dim lngCurrentRec As Long 　　 　　If Me.Dirty = True Then 　　　　Ret = MsgBox("入力したデータを保存しますか。", vbQuestion + vbOKCancel) 　　　　If Ret = vbCancel Then 　　　　　　cmd取消_Click 　　　　　　GoTo exitH 　　　　End If 　　　　Set Me.ClsDao_ = New ClsDao 　　　　SQL = "Select final_value, [更新日時] from T95ID管理表 " 　　　　SQL = SQL & "where " 　　　　SQL = SQL & " ID_Name = '作業記録ID';" 　　　　 　　　　NewKey = Me.ClsDao_.SelectID(SQL) 　　　　Me.作業記録ID.Value = NewKey 　　　　 　　　　Me.BeforeUpdate = "" 　　　　DoCmd.RunCommand acCmdSaveRecord 　　　　 　　　　'採番テーブルに新しいNoで更新をする 　　　　ClsDao.UpdateID NewKey 　　　　modPub.lngNewRecID = NewKey　'Global変数に新しいID NOをセット（親画面で取得するため） 　　　　Set ClsDao = Nothing 　　　　 　　　　BeforeUpdate = "[イベント プロシージャ]" 　　'　　Me.Visible = False 　　　　DoCmd.Close 　　End If End Sub ◆B画面の保存ボタンの処理終わり 　　 その後、呼出元のB画面を開くイベントの処理を継続し A画面を更新し、新規入力されたレコードを選択する処理をしています。 問題は、まず１回目には、新規作成ボタンを押して新規データを登録し A画面でその新規レコードを選択することが１回目は可能で 同じ事を２回目すると、 ※実行時エラー'7951': 　RecordSetCloneプロパティに対する不適切な参照を含む式を入力しました。 というエラーが出ます。 その時の画面は、複数行あったのが一レコードだけになってしまい、 各項目のTextboxは、「#Name?」が表示されています。 デバッグボタンを押すと 以下のソースの「Set Rec = Me.RecordsetClone」で止まります。 この解決方法を教えて下さい。 ◆A画面の新規作成ボタンのソースの内容開始 Private Sub cmdNewRec_Click() 　　Dim ClsDao As ClsDao 　　Dim SQL As String 　　Dim NewFm As Form 　　Dim Rec As Recordset 　　Dim NewNo As Long 　　Dim MyFm As Form 　　Dim StrRecSource As String 　　 　　Set MyFm = Me.Form 　　 StrRecSource = Me.RecordSource 　　 　　DoCmd.OpenForm "FXX作業記録(NewEntry_連結版)", acNormal, , , acFormAdd, acDialog 　　 　　If modPub.lngNewRecID > 0 Then 　　　　NewNo = modPub.lngNewRecID 　　　　Me.RecordSource = StrRecSource 　　　　Me.Requery 　　　　Set Rec = Me.RecordsetClone　<===ここでエラー 　　　　Rec.FindFirst "作業記録ID = " & NewNo 　　　　If Rec.NoMatch = False Then '　　　　　　Me.CurrentRecord = Rec.AbsolutePosition 　　　　　　DoCmd.GoToRecord acDataForm, Me.Name, acGoTo, Rec.AbsolutePosition + 1 　　　　　　Rec.Close 　　　　　　Set Rec = Nothing 　　　　End If 　　End If End Sub ◆A画面の新規作成ボタンのソースの内容終了
SELECT (`総額` / `個数`) FROM tb_item で`総額`を`個数`で割った単価（のような）値が取得できるものとします。 このとき、この「計算で出た単価」と「10,000という値」を比較して大きいほうの値を返すクエリはどのように書くのでしょうか？ なんとなく、 SELECT MAX(`総額` / `個数`, 10000) FROM tb_item のような感じで取得できるような関数を探していますが、MAXだと列の中で最大値を取得してしまうので渡しが使いたい内容と違います。 サブクエリを使わずになるべく簡潔に書く方法を知りたいです。 どうぞよろしくお願い致します。
下記の質問をさせていただき、解決いたしましたが、それに関連して新たなご質問です。 http://oshiete.goo.ne.jp/qa/8830319.html 上記質問内容は、 以下のようなデータから、「結果」のような形でデータを取り出したいというもので、「いただいたご回答」の形で一旦解決しました。 usr テーブル +--------+------+ | usr_id | name | +--------+------+ | 1 | 太郎 | | 2 | 二郎 | | 3 | 花子 | +--------+------+ usr_trm テーブル +--------+--------+ | usr_id | trm_id | +--------+--------+ | 1 | 1 | | 1 | 3 | | 1 | 4 | | 2 | 1 | | 2 | 2 | | 2 | 3 | | 3 | 2 | +--------+--------+ cat テーブル +--------+------+ | cat_id | name | +--------+------+ | 1 | 性別 | | 2 | 部署 | +--------+------+ trm テーブル +--------+--------+------+ | trm_id | cat_id | name | +--------+--------+------+ | 1 | 1 | 男性 | | 2 | 1 | 女性 | | 3 | 2 | 総務 | | 4 | 2 | 経理 | +--------+--------+------+ 結果 +--------+------+------+------+ | usr_id | name | cat1 | cat2 | +--------+------+------+------+ | 1 | 太郎 | 1 | 3,4 | | 2 | 二郎 | 1,2 | 3 | | 3 | 花子 | 2 | 　 | +--------+------+----- +------+ いただいたご回答 select t1.usr_id,t3.name ,group_concat(if(cat_id=1,t1.trm_id,null)) as cat1 ,group_concat(if(cat_id=2,t1.trm_id,null)) as cat2 from usr_trm as t1 inner join trm as t2 on t1.trm_id=t2.trm_id inner join usr as t3 on t1.usr_id=t3.usr_id group by usr_id さらにそこから、例えば「総務に所属する人をランダムにn件」という形で絞り込もうと思い、 WHERE t2.trm_id=3 と ORDER BY RAND() LIMIT 10 を追加したところ、条件通り抽出はされるのですが、結果の「cat1」「cat2」に他のカテゴリーの値が入らなくなりました。 WHERE t2.trm_id=3 を消すと「cat1」と「cat2」に値が入ってきます。 「cat1」と「cat2」に全ての値が入った状態で絞込をするために、どのようにすればよいかわかりません。 アドバイスをいただけると幸いです。
MySQLを使用したホームページを運用しているのですが、このたびホスティングサーバーを変更する予定で、新しい移行先のホスティング側に、サイトデータ・SQLデータを移行しましたが、データベースを読み込む部分だけ文字化けして表示されてしまいました。 ※日本語だけすべて???で表示されてしまいます。 phpMyAdmin上で見ると、正常にデータベース内容の日本語は表示されています。 照合順序の文字コード変更などをぐぐって作業してみましたが、解決できません。 よろしくお願い致します。
データベース初心者です。 SQLiteを使って多くのデータを作りました。 インデックスを使っているので WHERE A = '...' はとても早いのですが、 WHERE A like '%...' は、とても遅いです。 速くする方法は無いでしょうか。
下記のような２つのテーブルがあり、 仕入れテーブルから、2014/1/2にBさんが仕入れたデータを 削除したいのですが、SQLが分かりません。 どのようなSQLにすると実現することができるでしょうか。
以下のようなデータがあります。 このデータから最後の「結果」のような形でデータを取り出したい場合、どのようにすればよいでしょうか？ cat1とcat2を分けない形はgroup_concatを使ってできたのですが、カテゴリーごとに分けて取得したいです。 usr テーブル +--------+------+ | usr_id | name | +--------+------+ | 1 | 太郎 | | 2 | 二郎 | | 3 | 花子 | +--------+------+ usr_trm テーブル +--------+--------+ | usr_id | trm_id | +--------+--------+ | 1 | 1 | | 1 | 3 | | 1 | 4 | | 2 | 1 | | 2 | 2 | | 2 | 3 | | 3 | 2 | +--------+--------+ cat テーブル +--------+------+ | cat_id | name | +--------+------+ | 1 | 性別 | | 2 | 部署 | +--------+------+ trm テーブル +--------+--------+------+ | trm_id | cat_id | name | +--------+--------+------+ | 1 | 1 | 男性 | | 2 | 1 | 女性 | | 3 | 2 | 総務 | | 4 | 2 | 経理 | +--------+--------+------+ 結果 +--------+------+------+------+ | usr_id | name | cat1 | cat2 | +--------+------+------+------+ | 1 | 太郎 | 1 | 3,4 | | 2 | 二郎 | 1,2 | 3 | | 3 | 花子 | 2 | 　 | +--------+------+----- +------+
MySQL、PostgreSQLの必要要件が載っている サイトやページがあれば教えて頂けないでしょうか。 サポートＯＳ（Win、Linux）、インストールするために必要な容量が少なくとも欲しいです。 （その他の情報もあることにこしたことはありません。） また、最新のみではなく、これまでのバージョンもあれば良いのですが・・・。 もちろんここ最近の数バージョン程度で良いです。
Access2013、有り無しなどのフラグのデータ型を何にしたら良いのか、悩んでいます。 しょうもない質問かと思われる方もおられるかもしれませんが、 Yes/No型か 数値のバイト型か 整数型か もしかすると、先でMS SQL Serverに移行するかもしれない可能性がありますが、今のところ未定です。 よろしくお願いします
Accessで自前の自動採番処理で採番テーブルを作り、その採番テーブルに格納してある最後の主キーのNO.を取得して、それに1加算したものを、新規レコードの主キーの自動採番処理結果として設定するやり方を考えていますが、その場合に 1) 複数レコードにエクセルなどから複数行データをコピーして貼り付けた場合には、採番がうまくいくのでしょうか？行かない場合には、その対処策はありますでしょうか。 2) 一行、または、複数行を削除した場合には、採番は既に登録済みの最後のNo.から自動採番するようになると思いますが、通常のアクセスのシステムでは、このような挙動で宜しいのでしょうか？ ご回答のほうよろしくお願いします。
アクセス2013で自前の自動採番をする時の主キーのデータ型を現在、十進型の18桁にしています。 他の人達は、自前の自動採番をする場合、テキスト型でするという質問を他のサイトで見かけた事がありますが、数字で自動採番処理を自前で作成する場合は、どのデータ型が宜しいのでしょうか? よろしくお願いします。
コマンドプロンプトで「SELECT * FROM testtable」などとやったときに、列数が多いと結果が行単位に改行されて見にくい。 改行させない方法ってありませんか？ あるいはコマンドプロンプト自体の幅を広げる方法とかありませんか？ この質問ここではマズかったかな？
Access2013でデータベースを作成しましたが、中身をいじれないようにする為にコンパイルして「.accde」形式で保存をしました ところが、そのファイルを開くたびに添付画像のようなセキュリティのアラートが出てしまいます これを出さないで開く方法はないのでしょうか・・・ レジストリをいじるなど、このファイルをいじる方法は基本的に出来ません 何か良い方法はないでしょうか？ またコンパイルをした目的は「レイアウトやモジュール等をいじられないようにする為」ですので、コンパイル以外の方法で上記の目的を達成し、かつアラートが出ない方法があればそれでも構いません 何か良い方法があれば教えて頂けませんでしょうか 宜しくお願い致します
SQL Server 2012 Express LocalDBを常時起動しておくにはどのようにすればよいでしょうか。 タスクマネージャで見ていると、起動してしばらくすると、sqlserver.exeが終了してしまいます。 SQL Server 2012 ExpressであればSQL Server Management Studioで設定できると思いますが、LocalDBではどうすればよいのでしょうか。
お世話になります。 my ｓｑｌのテキスト欄ですが、以下のような文字化けになってしまいました。 ¤¦¤´¤¶¤¤¤Þ¤¹¡￡<br />¤è¤¤¤È¤³¤í... このような文字化けはどうやったら直るのでしょうか？ 日本語データーがすべてこのようになってしまいました。 ヒントのような事でも良いのでどうか回答の程よろしくお願い致します。
基本的な質問です。 postgresql9であるレコードをdrop後にバキュームを行ないましたが データファイル({postgres_homedir}/data/base/oid/テーブルNo)でdropしたレコードの文字列が残っています。 ここからも消したいのですがどうしたら消えますか？
セットコード、商品コード、金額を持つテーブルがあります。 セット商品コード（Ｘ）は商品コード（Ｍ，Ｎ）を持っています。商品コードＮはセット商品コードとしても登録されており、商品コード（Ｏ，Ｐ）を持っています。Ｐはセット商品コードとしても登録されており、子に商品コードＸを持ちます。ただＸはセット商品コードとして登録されているので、子に商品コードして登場するのは問題があります。 このようなチェック末端まで行う処理を作りたいのですがどのような方法がありますでしょうか？
Mysqlのデータベースの中にhisotryテーブルを作成しています。 その中にはヒストリーIDと顧客IDとログの内容とタイムスタンプが入っています。 このテーブルから顧客ID毎の一番古いタイムスタンプを取得したいのですが、 どうすればよいのかわかりません。 よろしくお願いします。
phpMyAdminでテーブルをエクスポートして、違うテーブルにインポートしていれたいのですが、sqlファイルでエクスポートしようとすると、自動でWHEREの中身がid = "1234"とかになってしまって、勝手にidがひも付けされてしまいます。おそらくその原因はプライマリーキーだからなのでしょうが、WHEREの中身をdata1 = "23456"みたいにidではない違うカラムにひも付けすることはできるのでしょうか？　data1をプライマリーキーにしようとしてもできませんでした（重複してないはず。） 回答よろしくお願いします！
postgresqlで、「WARNING　 進行中のトランザクションがありません」のエラーが出てしまいました。 これはそのままの意味だと思うのですが 直す方法がわかりません。 ワーニングなので、、、といいたいところですが、そうもいかず。 apのログで、トランザクション関係の辺りを見ましたところ、 トランザクションを開始し、 TABLEをDROPしようとしましたが、存在しなかった（ようだ）。 （PQexecがエラーでリターン） 存在しないけれど、commit　してトランザクションを終わらせている。 のが原因かなと思いました。 なので、PQexec()がエラーの場合はcommitしなければいいのかと はずしましたが結果は同じでした。 トランザクションが無いのだからrollbackもいらないですよね。 そこで質問ですが drop文、１ステップのSQL実行も明示的にトランザクションの処理をしたほうがいいのでしょうか？ このワーニングは通常のトランザクションの処理の中で、どういう時にでるのでしょうか？ oracleとpostgresqlの明示的・暗黙的な制御に戸惑っています。 （oracleからpostgresqlに移行することになりました） 叱咤でも何でもかまいませんので、アドバイスよろしくお願いいたします。
TableName = key_table ID, GroupID, Key(文字列型), Value(文字列型) 1, 1, 'start_date', '2014-11-05' 2, 1, 'end_date', '' 3, 2, 'start_date', '2014-11-05' 4, 2, 'end_date', '2014-12-05' 5, 3, 'start_date', '2014-4-05' 6, 3, 'end_date', '' start_dateが2014-11-05で、end_dateが''か未来にセットされているGroupID1とGroupID2を検索するSQLはどういう方法がありますでしょうか？ SELECT GroupID from key_table where (Name='start_date' AND Value = '2014-11-05') AND (Name='end_date' AND (Value = '' OR end_date > '2014-11-05') な感じでやってみようと思ったのですが、動作しません。 このテーブル構造でどうしても検索しないといけません。 以上、よろしくお願いします。
お世話になります。 現在Accessにてツールを作成しておりますが、読み取り専用で 開かれた場合は、処理をさせないようにしたいとところです。 処理が実行されると削除クエリの箇所で、削除できない旨のエラーが 出てしまい処理が中断します。 なお、中断される前にローカルにテンポラリテーブルを作成したり している為、中途半端な状態で止まってしまいます。 ※ツールはRuntime環境で利用する為、ユーザーが中途半端に 　作成されたテーブル等を削除できません。 なので、フォームを開く際に読み取り専用で開かれたかどうか チェックし、読み取り専用の場合は、処理させないようにボタンを 使用不可にしたいと考えております。 ご教示の程、宜しくお願い致します。
ACCESSベースで生徒提出物をバーコード管理し、受付票のレシートや各種統計、帳票を印刷するVBAによるPOSを組んで4月から勤務校等で使用しているのですが… 先日、導入している関連校で”ブックマークが参照できません”というメッセージが複数回現れた後に、フリーズ、その後強制終了により、データベースが破損するという事象が起きました。 一応、世代管理で過去5日分、就業時間前に自動バックアップする仕様にしているのですが、1日分のデータの事もあり、壊れた状態から復元すると、40件ほど全て”*”が表示された行ができていました。これはどうやら、登録済みのレコードが破損したもののようです。さらに、生徒提出物を採点者に渡す際の現物仕訳の段階で、一度、登録したレコードの内、”*”を残さずに完全に消滅したと思しきものが43件ありました。 その問題の起きた関連校のみ、学園本部ネットワークにBD本体を置き、インターフェイスを職員室のネットワークに置いていました。(私は経路が迂遠になり、レスポンスが下がるので推奨しませんでしたが) 最近、学園本部でDNSを入れ替えた後、様々なトラブルが発生していました事も追記します。 上記の状況を総合的にみた場合、どのような原因で、83件のデータの消失が起きたのか、今後のためにも是非、知りたく思います。 お手数をおかけしますが、お知恵をお貸しください。
毎回お世話になっています。 今回も知恵を頂けたらありがたいです。よろしくお願い致します。 下記のようなプログラムを組んだところ、ページを開いたらすぐ全データがが出てくる状態になっています。ページを開いても何もデータが出てこない状態にして検索してからデータが出てくるようにするにはどのように書き換えれば良いのでしょうか？ <!DOCTYPE html> <html> <head> <meta charset="UTF-8"> <title>リーグデータ</title> <link rel="stylesheet" type="text/css" href="../common/style.css"/> </head> <?php error_reporting( E_ALL ^ E_NOTICE ); ?> <body id="list"> <div id="main"> <form name="search_form" action="player_list.php" method="post"> <input type="hidden" name="cmd" value="search" /> <table> <tr> <th class="th_top">選手名</th> <td class="td_top"> <input type="text" name="name" size="30" value="<?php echo $_POST['name'] ?>"> </td> </tr> <tr> <th>チーム名</th> <td> <input type="checkbox" name="team_id[]" value="1" <?php if (isset($_REQUEST['team_id']) and in_array('1',$_REQUEST['team_id'])) print 'checked'; ?>/> 名古屋 <input type="checkbox" name="team_id[]" value="2" <?php if (isset($_REQUEST['team_id']) and in_array('2',$_REQUEST['team_id'])) print 'checked'; ?>/> 徳島 <input type="checkbox" name="team_id[]" value="3" <?php if (isset($_REQUEST['team_id']) and in_array('3',$_REQUEST['team_id'])) print 'checked'; ?>/> 千葉 <input type="checkbox" name="team_id[]" value="4" <?php if (isset($_REQUEST['team_id']) and in_array('4',$_REQUEST['team_id'])) print 'checked'; ?>/> 浦和 <input type="checkbox" name="team_id[]" value="5" <?php if (isset($_REQUEST['team_id']) and in_array('5',$_REQUEST['team_id'])) print 'checked'; ?>/> 磐田<br /> </td> </tr> <tr> <th class="th_middle"> ポジション </th> <td class="td_middle"> FW MF DF GK </td> </tr> </table> <p> <input type="submit" value="検索"> <input type="reset" value="リセット"> </p> </form> <?php try { $dsn = 'mysql:dbname=xxxxx;host=localhost'; $user = 'xxxxx'; $password = 'xxxxxx'; $dbh = new PDO($dsn,$user,$password); $dbh->query('SET NAMES utf8'); $sql = 'SELECT code,name,team_name,price,position,gazou FROM mst_player_market WHERE 1'; $stmt = $dbh->prepare($sql); $stmt->execute(); $dbh = null; if(isset($_POST['name'])) { $name = htmlspecialchars($_POST['name']); print($name); } if(isset($_POST['name'])) { if(!$_POST['name']==true){print ''; }else{ $sqlN ='code IN (SELECT code FROM mst_player_market where name LIKE ("%'.$_POST['name'].'%"))'; $sql.=' and ('.$sqlN.')'; } } if(isset($_POST['team_id'])and is_array($_POST['team_id'])){ $ary = array_filter($_POST['team_id'], function($v) {return is_numeric($v);}); $sqlA = 'code IN (SELECT playerid FROM team WHERE team_id IN ('.implode(',', $ary).'))'; }else{ print ''; $sqlA = ' 1 '; $flag=false; } $sql.=' and ('.$sqlA.')'; if($flag) $sql.="AND 0 ";; //参考 print $sql."<br>"; //実行 $pdo = new PDO($dsn,$user,$password); $stmt = $pdo->prepare($sql); $stmt->execute(); //画像処理 $rows=array(); while($row = $stmt->fetch(PDO::FETCH_ASSOC)){ $rows[]=$row; }; //参考SQL文表示 print_r($rows); print'選手一覧<br /><br />'; print'</form>'; } catch(Exception $e) { print'ただいま障害により大変ご迷惑をお掛けしております。'; exit(); } ?> <?php foreach((array) $rows as $row ){ ?> <tr> <td><img src="../player/<?php print( htmlspecialchars( $row["gazou"], ENT_QUOTES )); ?>" /></td> <td><?php print( htmlspecialchars( $row["team_name"], ENT_QUOTES )); ?></td> <td>\<?php print( htmlspecialchars( number_format( $row["price"] ),ENT_QUOTES ) ); ?></td> <td> <?php print( htmlspecialchars( $row["name"], ENT_QUOTES ) ); ?> </td> <td> <?php print( htmlspecialchars( $row["position"], ENT_QUOTES ) ); ?> </td> </tr> <?php } ?> </table> </div> <!------------mainのdiv--------------> </body> </html>
phpMyAdminを使ってます。一つのデータベースに入ってる二つのテーブルを統合するため、機能でいうとFULL OUTER的なのがやりたいのですがphpMyAdminがそれをサポートしていないので、代わりにUNIONを使ってやろうと思ったら、二つのテーブルのカラムの数と型が同じでないとできないらしく、そこで止まってしまってるのですが、どうにかできるコードはないでしょうか？ もともとは日本語のデータベース（１）と英語のデータベース（２）で分けていたのですが、英語（２）では入れなくてもいいデータがたくさんあり、カラムの数が２倍くらい変わってしまっているので、今から英語（２）の方を無理矢理日本語（１）に合わせるとなるとなんかデータが変になりそうなのでそれはまだやってないんですが。←無理矢理合わせるのはどうにも方法がなくて最終手段としてやりたいです。 回答よろしくおねがいします。 何か抜けている点があったら言ってください！
お世話になります。 クロス集計クエリの結果が以下の内容になっているとします。 項目　　　2013年10月　　2014年07月　　2014年08月　　2014年09月 商品数　　100　　　　　　　　150　　　　　　　120　　　　　　　　130 顧客数　　2000　　　　　　　2200　　　　　　2100　　　　　　　2200 ※2013年11月～2014年6月までのデータ無し 上記クエリで、データの無い期間の商品数及び顧客数を0とし、また見出しも 埋めたいところです。 項目　　　2013年10月　　2013年11月　・・・2014年08月　　2014年09月 商品数　　100　　　　　　　　0　　　　　　　　　120　　　　　　　　130 顧客数　　2000　　　　　　　0　　　　　　　　　2100　　　　　　　2200 このように表示したい場合、やはり元データにレコードを作成し各数量は0で 登録しなければなりませんでしょうか。 それとも、実際にレコードが無くても、上記表示は可能でしょうか。 ************ 当該クエリの内容は最終的にExcelファイルに貼り付けします。 現状、左詰めで貼り付けられてしまう為、可能であれば1年分の 体裁を整えた状態で貼り付けしたいところです。 ご教示の程、宜しくお願い致します。
VPSで色々とためしてみているのですが、どうもユーザーとか権限とかよく分かりません。 「Linux自体のユーザー」と「MySQLのユーザー」との間には何か関係はあるのでしょうか？ うまく言えませんが、例えば「MySQLのユーザー」は「Linux自体のユーザー」になってなければならない---なんてことです
オラクルの単一ビューには関数を含まない、データのグループを含まないという記載が参考書にあったのですが、具体的にどういう状況をいっているのか教えて下さい。 すいません。追加で聞きたいことがありました。 同一データベースの異なるスキーマで、同じ表名を使用できる。 同一スキーマ内で、同じ表名と同義語名を使用できる。 この文言の意味合いもいまいち解せないでいます。 ご教授お願いいたします。
工事管理データベースのデータベースを今設計しております。 工事の受注から、工事の見積作成、進捗管理、請求書、入金、出金の管理など考えています。 請求書の部分ですが、私の会社では月末に締めて、その月の請求する工事物件のすべての出勤、入金関係のデータを集計し、請求書を起こしていますが、過去、未収金の分なども当月の請求書に入れています。 請求に対する入金があった場合に、工事物件の依頼テーブルか、見積テーブルなどに入金された日付、クローズなどの処理をしたりしているのでしょうか。それとも、そういうことは全くしなくても良いのでしょうか？ 集計処理で当月分の見積の金額などを全部集計するだけでは、その月以前の未収金分は含まれないのですが、このような未収金分は、全部手作業で請求書に入れ込むのか、システムで何かやり方があるのか、このへんの事をわかる方、教えていただきたいです。 よろしくお願いします。m(_ _)m
初めてのＡｃｃｅｓｓで分からない事があり質問させてください。 ＜会社テーブル＞ 会社ID 会社名 住所 ＜社員テーブル＞ 会社ＩＤ 社員名 ソート番号 ＊1社に対し複数の社員レコードが存在 以上のようなテーブルがあるとします 現在「会社テーブル」を表形式で一覧表示しています 会社ＩＤ，会社名、住所とフィールドが並んでいるのですが、その後ろに「社員テーブル」のソート番号が一番若い社員名を表示したいと考えています（現状は番号関係なく表示させる方法すら分かりません） 色々いじくりまわしたのですが、初めてＡｃｃｅｓｓをさわる事もあってよくわかりません リレーション等でひっぱってくる事ができるのでしょうか？ どなたか教えて頂けませんでしょうか 何卒よろしくお願い致します ＰＳ．Ａｃｃｅｓｓ2013で作成中です
PCに数年前に導入したMySQLのrootのパスワードを忘れてしまいました。 どこかに書いておいたはずなのですが、思い出せません。 rootのパスワードを調べる方法、または不明のまま新しいパイワードに変更する方法はあるでしょうか。
オラクルＳＱＬ試験をこれから頑張ろうと思っているのですが、クラムメディアという問題集サイトを最近知りました。 このサイトを利用された方に聞きたいのですが、ここでの感想が非常に的中率が高いといわれていることをたくさん拝見したのですが、これは練習問題の内容がということなのでしょうか。それともテストという時間を計った問題が最後にありますがそのテストの的中率ということなのでしょうか。 感想を読んだ限りでは、５５問中９５％がクラムメディアからでてきたものと書かれていました。 もしくはこのクラムメディアのテスト問題というのは、練習問題のページからランダムに出題されているものなのでしょうか。それとも予想的中問題として別個に用意されている問題なのでしょうか。 よろしくお願いします。
Filemaker Pro 12　で住所録を作りレイアウト画面を作って、プレビューに切り替えると、 「表形式で印刷するには、ボディが用紙内に収まっていなければなりません。印刷する場合には、ボディの高さを小さくするか、大きい用紙に変更するか、または、表形式を解除してください。」とのメッセージが出ました。 レイアウトは１０cmX１４．８cmのハガキ大で、プリンタ用紙設定も「ハガキ」です。郵便番号とヘッダーが重なりますが、ヘッダーとボディの設定をおしえてください。
オラクルＳＱＬの問題でＤＥＣＯＤＥ関数について教えて下さい。 SELECT employee_id, DECODE(department_id,80, DECODE(commission_pct,NULL,'NO COMMISSION', salary * commission_pct), 'NOT SALES'} "COMMISSION" FROM employees; 上記のは 『ＤＥＰＡＴＭＥＮＴ＿ＩＤ列が80の場合でかつＣＯＭＭＩＳＳＩＯＮ＿ＰＣＴ列がＮＵＬＬ値の場合は「ＮＯ　ＣＯＭＭＩＳＳＩＯＮ」、ＮＵＬＬ値でない場合は「ＳＡＬＡＲＹ＊ＣＯＭＭＩＳＳＩＯＮ＿ＰＣＴ」が文字列に変換されて戻されます。また、ＤＥＰＡＲＴＭＥＮＴ＿ＩＤ列が80以外の場合は「ＮＯＴ　ＳＡＬＥＳ」が戻されます。』と解説があり、 次に SELECT employee_id, DECODE( NULL IF(commission_pct,NULL), 0,salary * commission_pct, 'NO COMMISSION') "COMMISSION" FROM employees; このコードについては 『ＤＥＣＯＤＥ関数が最初に戻す「ＳＡＬＡＲＹ＊ＣＯＭＭＩＳＳＩＯＮ＿ＰＣＴ」が数値型なので、「ＮＯ　ＣＯＭＭＩＳＳＩＯＮ」が数値に変換できないためエラーになります。』 と解説がありました。 正常に実行できるのは前段のもので後段はできないとのことなのですがどうしてかわかりません。 なぜ後段では数値型に変換する必要があるのか、前段では同じsalary*commission_pctが文字列として扱っているのかわかりません。 ＤＥＣＯＤＥ関数の ＤＥＣＯＤＥ（α、 　　　　　　　　β、γ 　　　　　　　　　δ） αがβのときはγを戻し、それ以外のときはδを戻すという公式があると思いますが、 もしかしてγとδは同じ型でなければいけないというルールがあるのでしょうか。でもたとえそうだとしてもまだ解せない部分があるのですが・・・。ご教授どうかよろしくお願いいたします。これはオラクルブロンズＳＱＬの参考書の模擬試験にあった問題になります。
選択クエリにて日付で抽出しています。 選択クエリを実行すると、パラメーターの入力画面が表示され、日付を入力すると抽出されます。 その選択クエリをそのままレポートとしてあります。 そのレポートを印刷するにあたり、現在の流れは、フォームの印刷ボタンを押す→パラメーターの入力→レポート表示→ファイルタブから印刷を選択→印刷をクリック→プリンター選択等のプロパティー画面→印刷となっていますが、この手順を、フォームの印刷ボタンを押す→パラメーターの入力→プリンター選択等のプロパティー画面→印刷としたいのですが。 分かる方、是非教えて下さい。 宜しくお願いします。
現在本稼働しているDBを開発環境構築の為、テーブルを複製したいと考えております。 本環境:Oracle Database 11g 開発環境:Oracle Database 11g Express Edition 全てのテーブルを複製する必要はありません。 SQLのテストのため、Userテーブルを複製したいと考えてます。 必要なテーブルが、３０テーブルほどあり内１０テーブルは、２００万件程度のレコード数があります。 安全かつ、本サーバーに負担の少ない方法はどうしたらよろしいでしょうか？ 本環境のSQL sql developerのエクスポート機能で、テーブルを１個づつ出力し、開発環境のSQL developerでインポートを実行すれば、正常に稼働するのでしょうか？ MS SQL Serverなら、上記の方法で問題無いのですが、Oracleは初心者の為、全く分かりませんので、ご教授頂けましたら幸いです。
お世話になります。 下記にてローカルクエリの抽出結果をExcelへ出力しております。 　Dim obj As Object 　Dim MyDB As DAO.Database 　Dim MyRs As DAO.Recordset 　Dim qdf As DAO.QueryDef 　Dim out_path as String 　Dim sheet_name as String 　out_path = "出力先ファイルのフルパス（ファイル名含む）" 　sheet_name = "出力先シート名" Set MyDB = CurrentDb Set obj = GetObject(out_path, "Excel.Sheet") obj.Application.Visible = False obj.Parent.Windows(1).Visible = True Set qdf = MyDB.QueryDefs("ローカルクエリ名") With qdf .Parameters("[forms]![test]![id]") = Forms!test!id Set MyRs = .OpenRecordset .Close End With obj.Worksheets(sheet_name).Select　　　←　（注） obj.Application.Cells(24, 1).CopyFromRecordset MyRs ※ローカルクエリの抽出条件としてフォーム上のテキストボックスを 　参照しているため、Parametersを使ってます。 とりえあず上記で抽出結果は出力されます。 但し、適当なExcelファイルを開いた状態で実行すると、（注）の箇所で 「実行時エラー1004　WorksheetクラスのSelectメソッドが失敗 しました」となってしまいます。 なお、Selectの箇所をActiveにすると「実行時エラー438　オブジェクトは このプロパティまたはメソッドをサポートしていません。」と表示されます。 また、obj.Application.Visible = False の箇所で開いていた Excelファイルが閉じてしまうのですが、そういうものなのでしょうか。 勉強不足で大変恐縮ですが、ご教授の程、宜しくお願い足します。
AccessアプリでSQL Serverデータベースを更新しています。 データベースをODBCデータソースとして登録して、AccessdeそのODBCデータソースへのリンクテーブルを作っています。 データベースが何回か壊れたのですが、AccessVBAから発行したリンクテーブルへのSQLクエリでデータベースが壊れるようなことはあるんでしょうか？ あるとしたら、そのクエリを発行すると必ず壊れると思うんですが・・・。 同じAccessアプリを使っても、データベースが壊れない環境もありますし・・・。 データベースが壊れた原因がわからなくて困っています。 Windows 7、SQL Server 2008 R2 Express です。
現在、レンタルしているサーバのPHPmyAdminにて、データベースを作成しました。 データベースのエンジンはMyISAMになっており、InnoDB型がいいため、 テーブルの作成時にInnoDB型に設定をしました。 すると、構造タブでみるとデータベース：MyISAM テーブル：InnoDB となっておりますが、テーブルはInnoDBとして扱われているという認識でいいのでしょうか。 勉強中のため、詳しい方がおりましたら、教えていただけると助かります。
SELECT ～ FOR UPDATEやSELECT ～ LOCK IN SHARE MODEという行ロックがあり、この件について解説しているサイトをいろいろ見ているのですが、振る舞いが複雑だということはわかりました。 しかしそもそもなぜSELECTで行ロックするのか、運用上でどんなときに使うのかを解説しているサイトは見当たりませんでした。 私は、SELECTするときは単に SELECT * FROM tb_a WHERE id = 1; としか記述していません。 質問1. なぜSELECTするのにトランザクションが必要なのでしょうか？運用上でどんなときにSELECTでトランザクションを使うのでしょうか？よく解説サイトには、 BEGIN; SELECT * FROM tb_a WHERE id = 1 FOR UPDATE; COMMIT; と書いています。SELECTするのに行をロックする必要性がいまいちわからないです。 質問2. トランザクションを開始したときにロックがかかるのではないのでしょうか？つまりBEGIN;でロックがかかるわけではないのですか？SELECTのクエリーにFOR UPDATEと書くということはこのSELECTのコードが実行された時点でロックがかかるのでしょうか？ 質問3. FOR UPDATEやLOCK IN SHARE MODEというのはSELECTにしか使えないのか、もしくはSELECTだから意味があるのでしょうか？UPDATEやDELETEは単にBEGINE;とCOMMIT;で囲えばいいだけですよね？ 質問4. 以下のようなコードを解説しているサイトがあります。 BEGIN; SELECT * FROM tb_a WHERE id = 1; COMMIT; SELECT文にはFOR UPDATEも書いていないのですが、これは何を意味するのでしょうか？つまり、SELECTするのになぜトランザクションを実行するのでしょうか？ 一番知りたいのは運用上どのような場合にSELECTでトランザクションを使って行ロックするのか、ということです。 どうぞよろしくお願い致します。
値の入力されたフィールド数の合計をクエリで求める方法はありますか？ レコードのフィールドに入力されているのは、色々なデータ型がありますが、その中に日付/時刻型で指定しているフィールドが14あります。 その内の10フィールドが対象で、その10フィールドには、年月日が入力されているフィールドと、入力されていないフィールドが混在しています。入力されているフィールドを1カウントとして、入力されているフィールド数の合計を求めたいのですが。 分かる方、是非教えて下さい。 宜しくお願いします。
会社コード、品目コード、月度、出荷数の入った明細テーブルがあります これを過去３ヶ月で出荷数を移動平均したいのです 例 元データ 会社コード、品目コード、月度、出荷数 A00000001,AAAAAAA,201410,10 A00000001,AAAAAAA,201410,10 A00000001,AAAAAAA,201408,10 B00000002,BBBBBBB,201408,10 出力したい値 会社コード、品目コード、月度、出荷数 A00000001,AAAAAAA,201410,10←出荷数は同じ会社コード、品目コードの（１０月＋９月＋８月）÷３） A00000001,AAAAAAA,201409,3.33←出荷数は同じ会社コード、品目コードの（９月＋８月＋７月）÷３） A00000001,AAAAAAA,201408,3.33←出荷数は同じ会社コード、品目コードの（８月＋７月＋６月）÷３） B00000002,BBBBBBB,201408,3.33←出荷数は同じ会社コード、品目コードの（８月＋７月＋６月）÷３） このような事がしたいのですがどのようにしたら実現できるでしょうか 月度で移動平均なんて良く使いそうな気がしますが・・簡単なようで難しく悩んでおります どうかよろしくお願い致します
１番小さい番号の中で、１番高い物を選ぶ場合、どのようなSQL文を書けばいいのか教えていただけないでしょうか 番号　値段 　1　　 30 　2　　 100 　1　　 500 　3　　 400 　2　　 40 この場合だと１番小さい数字1の中で１番高い物なので1　500を検索できるようにしたいです。 よろしくお願いします。
お世話になります。 VBAより抽出結果をExcelへ出力したいと思います。 とりあえず、抽出結果をExcelの特定の箇所へ出力することは 出来たのですが、今回は見出し（フィールド名）もあわせて出力 したいところです。 見出しの部分を出力するにはどうすればよいのでしょうか。 恐らく見出し部分と抽出結果部分はそれぞれ別々に出力 しなければならないとは思うのですが。。 なお、見出し部分は固定の文字列ではないため、毎回フィールド名を 取得し、それを見出しとして出力する必要があります。 抽出結果（集計クエリ）は、 項目　yyyy年mm月　・・・・　yyyy年mm月 数量A　　　　　　500　　 ・・・・　　　　1200　　　　　　　 数量B　　　　　　200　　 ・・・・　　　　　800 というような感じで、現在は 数量A　　　　　　500　　 ・・・・　　　　1200　　　　　　　 数量B　　　　　　200　　 ・・・・　　　　　800 の部分だけ出力できている状況です。 Dim obj As Object Dim MyDB As DAO.Database Dim MyRs As DAO.Recordset MySQL = SQL文（集計クエリ） Set MyRs = MyDB.OpenRecordset(MySQL) obj.Worksheets(シート名).Select obj.Application.Cells(23, 1).CopyFormRecordset MyRs 上記でExcelへ出力してます。 ご教授の程、宜しくお願い致します。
お世話になります。 現在、Accessにてツールを作成しておりますが、VBAより 特定のパスにあるExcelファイルのシート名を取得する必要が あります。 ※当該ツールはRuntime環境にて利用するため、CreateObject 　が利用できません。 取得はDAO.Tabledefs を使って取得できましたが、GetObjectを 使って取得する方法をご教授頂けると幸いです。 シート名を取得するExcelファイルが、　C:\test\テスト.xlsxの場合 どのような記述になりますでしょうか。 勉強不足で大変恐縮ですが、ご教授のほど宜しくお願い致します。
yahooショッピングでお店を運営しています。 ストアクリエイターProで、access2007からCSVファイルにエクスポートして、それをストアクリエイターの商品データアップロード画面にて、商品を一括登録しようと思っているのですが、 CSVファイルにエクスポートした段階で、文字列が途中でカットされてしまいます。 数千文字ほどの文字数が入力された項目がすべて途中までしかCSVになりません。 どうやったらaccess2007からCSVにエクスポートできるのでしょうか？ ちなみに、windows７のパソコンで作業しており、 yahooにアップロードする際のCSVの形式は、 "あああ","いいい","ううう" といった、ダブルクォーテーションで括って、カンマで区切る、という形式となっています。 その形式のCSVに、数千文字のHTML文を放り込みたい、と、いうわけなのですが・・・ どうにもうまくいきません。 どうすればよいのか、わかる方いらっしゃいましたら、ぜひご教授いただけたら幸いです。 よろしくおねがいします。
PHPで、以下のようなソースで、存在しているデータベースtestに接続し、もしない場合、name_listというテーブルを作り、1カラム目をカラム名がnoで、int型でnot null auto_incrementにして、2カラム目をカラム名がnameで、not nullで作りたいのですが、うまくテーブルが作られません。 どうすればうまく作られるか教えてください。 <?php try{ $pdo = new PDO('mysql:dbname=test; host=localhost; charset=utf8', 'root'); $st = $pdo->prepare("create table if not exists name_list (no int(100) not null auto_increment, name varchar(100) not null);"); $st->execute(); }catch(PDOException $e){ print('Error:'.$e->getMessage()); die(); }
独自ドメインを取得し、Wordpressサイトを開こうと考えておりますが、分からないことがたくさんある上、自分が何を知らないのかも知らないので難儀しております。 1. ドメインをGodaddyなどの会社から取得し、それをdreamhostなどのレンタルサーバーにアップロードしたWordpressに使うにはどうしたらいいのか？ 2. htaccessやアパッチなどの設定（gzipやキャッシュなど）など、HTMLやCSSなどのプログラミング言語ではない、重要なウェブサイト運営の知識 3. ページの表示速度を早くするために、gzipをOnにすべきか、bpsは十分かなどの設定可能なオプションと測定方法など 4. その他ここに挙がっていないけれど、wordpressサイトを運営する上で重要なこと を知識の漏れが内容に、体系的に学べられるサイトを探しております。 英語ができるので海外サイトでも結構です。 どなたかご助力ください。よろしくお願い申し上げます。
お世話になります。 ローカルのクエリの抽出結果をExcelファイルに出力しようとしてます。 クエリの条件としてはフォーム上にあるテキストボックスの文字列を参照する ようにしてます。 ※当該クエリを開くと問題なく抽出されてます。 このクエリの抽出結果を出力しようとすると、「実行時エラー3061　パラメータ が少なすぎます。1を指定してください。」と表示されます。 なお、出力は以下のようにしてます。 　Set MyRs = CurrentDb.OpenRecordset("クエリ名") ローカルクエリの条件をフォーム上のテキストボックスではなく、固定で 文字列を指定してやると、当該エラーは出なくなります。 なので、フォーム上のテキストボックスを参照できないのか、そもそも 上記のOpenRecordsetで何か(パラメタ)足りないのか。。よくわかりません。 勉強不足で大変恐縮ですが、ご教授の程、宜しくお願い致します。
ただいま、物件毎の修理の依頼を受けて、その修理工事をしたあと、依頼先に請求する処理のためのテーブルを作っています。 まず、見積テーブル・見積明細テーブルというのを作り、 次に、入金テーブル・入金明細テーブルというのを作りました。 【見積テーブル】 ・見積ID（主Key) ・物件ID *（ExKey) ・工事費用合計（←工事費用テーブルより取得） ・材料仕入れ費用合計（←材料知り入れ費用テーブルより取得） ・会社利益 ・支払方法 ・1回目支払開始日 ・2回目以降の支払日 ・支払回数 【見積明細テーブル】 ・見積明細ID（主Key) ・見積ID（ExKey) ・請求先名 ・請求先毎の請求額 【入金テーブル】 ・入金ID（主Key) ・物件ID * （ExKey) ・請求金額合計 ・入金金額合計 ・差額 ・入金完了日付 【入金明細テーブル】 ・入金明細ID（主Key) ・入金ID（ExKey) ・請求先名 ・入金額 ・入金日 *物件IDとは、工事物件の依頼内容を格納しているテーブルの主キーです。 　物件ID : 見積ID = 1: 1 物件ID : 入金ID = 1: 1 の関係です。 このような感じで作りましたが、見積明細テーブルの各請求先毎の支払状況を見る上では、その下の入金明細テーブルでは不十分です。 これをうまく改善するテーブル設計の方法を教えてくだい。 よろしくお願いいたします。
以下のようなPHPのソースとMySQLのテーブルで、numberが0の行をhtmlで取得しようとしているのですが、検索窓に0を入れて検索しても取得できません。ちなみに、numberが1や2の行は取得することができます。 なぜnumberが0の行を取得できないかと、どうすればnumberが0の行を取得することができるか教えてください。 <PHPのソース> <?php $url = "localhost"; $user = "root"; $pass = ""; $db = "test"; $html = ""; // MySQLへ接続する $link = mysql_connect($url,$user,$pass) or die("MySQLへの接続に失敗しました。"); // データベースを選択する $sdb = mysql_select_db($db,$link) or die("データベースの選択に失敗しました。"); // クエリを送信する $sql = "SELECT * FROM test"; $result = mysql_query($sql, $link) or die("クエリの送信に失敗しました。<br />SQL:".$sql); //結果セットの行数を取得する $rows = mysql_num_rows($result); ?> <form action="" method="post"> <input type="text" name="numberSearch" value=""> <input type="submit" value="検索"> </form> <?php //表示するデータを作成 if($rows && !empty($_POST['numberSearch'])){ while($row = mysql_fetch_array($result)) { if ($row["number"] == $_POST['numberSearch']) { $html .= "<tr>"; $html .= "<td>".$row["alphabet"]."</td><td>".$row["number"]."</td>"; $html .= "</tr>\n"; } } }else{ $msg = "データがありません。"; } // MySQLへの接続を閉じる mysql_close($link) or die("MySQL切断に失敗しました。"); ?> <html> <head> <meta charset="utf-8"> <title>numberSearch</title> </head> <body> <table width = "200" border = "0"> <tr bgcolor="##ccffcc"><td>alphabet</td><td>number</td></tr> <?= $html ?> </table> </body> </html> <データベースのテーブル> alphabet number A 0 B 1 C 2 D 1 E 1 F 0 G 1
下記のスクリプトで、MySQLサーバーのテーブルの中身を見ようとしたら、 返り値が空でした(行数0) ( クエリの実行時間 0.0010 秒 )　と表示されます。 どこが間違ってるのでしょうか。 ////////////////////// // データベース登録 // ////////////////////// $con = mysql_connect("mysql020.******", "*****", "*****"); // リモートのMySQLデータベースサーバーに接続する mysql_select_db("LAA0471050-ideamemo"); // データベースサーバーに存在する（myPHPAdminで作成済みの）データベースを選択する $sql = "SET NAMES utf8"; mysql_query($sql, $con); $sql = "INSERT INTO ideamemo_table (color, title, contents, create) VALUES ('$color', '$title', '$contents', '$create');"; mysql_query($sql, $con); mysql_close($con); ?>
現在、ブランドサイズをインターナショナルサイズに変換するデータベース設計をしていて悩んでいることがあります。どうか知恵をお貸しください。 参考にしています書籍は、ミック著「達人に学ぶDB設計徹底指南書」です。 書籍には、正規化の次数が低いほど検索SQLのパフォーマンスは良いですが、データ整合性は低く、正規化していくほどパフォーマンスが低下する代わりにデータ整合性が高くなります。と書いています。 ですので、正規化した結果、５つのテーブルが出来上がりました。 これらを正規化したテーブルを中間テーブルで扱うには、どのように設計すればよろしいでしょうか？ 以上、よろしくお願いします。 下記は、正規化したテーブルです。 テーブル名 ：： ブランド 扱うデータ ：： （仮）A、その他ブランド.... テーブル名 ：： 性別 扱うデータ ：： メンズ、レディース、ユニセックス テーブル名 ：： カテゴリー 扱うデータ ：： ウェアー、ボトム、シューズ、その他カテゴリー.... テーブル名 ：： ブランドサイズ 扱うデータ ：： 1、2、3、その他ブランドサイズ.... テーブル名 ：： インターナショナル・サイズ 扱うデータ ：： S、M、L、その他サイズ....
お世話になっております。 MySQLに保存している顧客データの処理について質問させてください。（MySQLとPHPでブラウザ経由でデータ管理をしています） 以下のようなテーブルがあり、顧客に対して配送するダイレクトメールの印刷をする流れのことです。 no　　name　　dm 1　　佐藤　　no 2　　吉田 3　　谷口 4　　伊藤 まず最初にこのテーブルにある顧客を一覧で表示させますが、名前と共にチェックボックスを設け、 noという値が入っているレコードはチェックを入れて一覧表示します。 一覧表示の後、印刷表示というボタンを押すと、印刷用レイアウトの画面に移動し、印刷を実行という流れです。 dmというカラムは印刷をするか否かのフラグであり、noと代入されているか顧客は印刷しないことを意味しますが、 印刷前の確認が出来るようにするためであり、また印刷対象の変更を同時に行えるようにしたいと、このような流れになってます。 そこで質問なのですが、単純に一覧から印刷用ページに移動させるだけなら問題はないのですが、このチェックボックスのチェック、チェックを外したり、チェックを入れたりと、服すのチェックを一度に行い、印刷用ページに移動(ポスト）したとき、チェックの入ったデータだけ印刷一覧に表示したいと考えてます。 このとき、変更があった顧客のdmカラムをアップデートしたいのですが、どのような仕組みが一番負荷が少なくて住むのでしょうか？ 現在の顧客数は1万5千件程度ですが、印刷用ページに移動した際、１つずつチェックをするのは非常に非効率ですし、かといって、元々チェックの入っていたデータと、印刷ページにポストしたとときのデータを共に違う配列に代入して・・・とも考えているのですが、効率のよい流れというものがなかなかイメージすることが出来ません。 お忙しいとは思いますが、お知恵を頂戴できれば幸いです。 宜しくお願いいたします。
「←追加」と追加したのですが、Warning: Invalid argument supplied for foreach()とエラーがでました。 調べたり、試行錯誤してみましたがダメでした。 何が間違っているのでしょうか？ try{ $dbh = new PDO($dsn, $user, $password); print('接続に成功しました。<br>'); $dbh->query('SET NAMES utf8'); $sql = ('SELECT song.number, song.song_title, artist.artist, ka2.artist as artist_2, ka3.artist as artist_3, ka4.artist as artist_4, ka5.artist as artist_5, ka6.artist as artist_6, ka7.artist as artist_7, ka8.artist as artist_8, ka9.artist as artist_9, ka10.artist as artist_10, ka11.artist as artist_11, ka12.artist as artist_12, sakushi.sakushi, ss2.sakushi as sakushi_2, ss3.sakushi as sakushi_3, ss4.sakushi as sakushi_4, sakkyoku.sakkyoku, sk2.sakkyoku as sakkyoku_2, sk3.sakkyoku as sakkyoku_3, sk4.sakkyoku as sakkyoku_4, hennkyoku.hennkyoku, hk2.hennkyoku as hennkyoku_2, hk3.hennkyoku as hennkyoku_3, hk4.hennkyoku as hennkyoku_4, genre, gr2.genre as genre_2,←追加 tie_up, part FROM (((((((((((((((((((((((((((( song LEFT JOIN artist ON song.artist_1 = artist.artist_ID) LEFT JOIN artist ka2 ON song.artist_2 = ka2.artist_ID) LEFT JOIN artist ka3 ON song.artist_3 = ka3.artist_ID) LEFT JOIN artist ka4 ON song.artist_4 = ka4.artist_ID) LEFT JOIN artist ka5 ON song.artist_5 = ka5.artist_ID) LEFT JOIN artist ka6 ON song.artist_6 = ka6.artist_ID) LEFT JOIN artist ka7 ON song.artist_7 = ka7.artist_ID) LEFT JOIN artist ka8 ON song.artist_8 = ka8.artist_ID) LEFT JOIN artist ka9 ON song.artist_9 = ka9.artist_ID) LEFT JOIN artist ka10 ON song.artist_10 = ka10.artist_ID) LEFT JOIN artist ka11 ON song.artist_11 = ka11.artist_ID) LEFT JOIN artist ka12 ON song.artist_12 = ka12.artist_ID) LEFT JOIN sakushi ON song.sakushi_1 = sakushi.sakushi_ID) LEFT JOIN sakushi ss2 ON song.sakushi_2 = ss2.sakushi_ID) LEFT JOIN sakushi ss3 ON song.sakushi_3 = ss3.sakushi_ID) LEFT JOIN sakushi ss4 ON song.sakushi_4 = ss4.sakushi_ID) LEFT JOIN sakkyoku ON song.sakkyoku_1 = sakkyoku.sakkyoku_ID) LEFT JOIN sakkyoku sk2 ON song.sakkyoku_2 = sk2.sakkyoku_ID) LEFT JOIN sakkyoku sk3 ON song.sakkyoku_3 = sk3.sakkyoku_ID) LEFT JOIN sakkyoku sk4 ON song.sakkyoku_4 = sk4.sakkyoku_ID) LEFT JOIN hennkyoku ON song.hennkyoku_1 = hennkyoku.hennkyoku_ID) LEFT JOIN hennkyoku hk2 ON song.hennkyoku_2 = hk2.hennkyoku_ID) LEFT JOIN hennkyoku hk3 ON song.hennkyoku_3 = hk3.hennkyoku_ID) LEFT JOIN hennkyoku hk4 ON song.hennkyoku_4 = hk4.hennkyoku_ID) LEFT JOIN genre ON song.genre_1 = genre.genre_ID) LEFT JOIN genre gr2 ON song.genre_2 = gr2.genre_ID)←追加 LEFT JOIN tie_up ON song.tie_up_1 = tie_up.tie_up_ID) LEFT JOIN part ON song.part_1 = part.part_ID) ;');
いつもお世話になっています。 Accessでクエリを作成するにあたり、リレーションシップを設定したいのですが、 一致させるフィールドが「123456/S1234とS1234」，「S001234とS1501234E」，「5678と5678」など、 完全一致するものと一部一致するものが混在しています。 一部一致のものでも、どれと一致させるかを判断することはできるのですが、 この状態では通常のリレーションシップは設定できませんか？ 設定できないならば、一度加工して完全一致したテーブルを作成し、 それとリレーションシップをVBAで設定するしかないでしょうか？
ユーザーと商品のテーブル（省略）、 商品ジャンルテーブル、 genre id　　 name 1　　　家電 2　　　3万円台 3　　　テレビ 4　　　黒 5　　　SONY 6　　　三菱 商品とジャンルのリレーションテーブル、 item_genre item_id genre_id 1　　　　1 1　　　　2 1　　　　3 2　　　　1 2　　　　3 2　　　　4 2　　　　6 ユーザーが希望する商品ジャンルのテーブル（ユーザーとジャンルのリレーションテーブル）、 user_genre user_id genre_id 1　　　　1 1　　　　3 2　　　　1 2　　　　3 2　　　　4 3　　　　1 3　　　　3 3　　　　4 3　　　　5 以上があるとします。 この時に商品側から（商品IDを元に）、その商品を希望しているユーザーIDを取得する場合の SQL文の作成方法のご教示をお願いいたします。 上記のテーブルの例ですと、アイテム1から取得したいユーザーIDは1、アイテム2からは ユーザーID 1と2を取得できればOKです。 商品が持つジャンルIDが1,2,3に対してユーザーが希望するジャンルIDが1,3のように少ない 場合は対象にふくまれますが、商品が持つジャンルIDが1,3に対してユーザーが希望する ジャンルIDが1,3,4のように多くなる場合は対象に含めません。 色々と考えてみたのですが、頭がこんがらがってしまい迷宮に迷い込んでしまいました。 すみませんがお知恵をお貸しください。よろしくお願いします。 ※DBサーバーがMySQLのため、MySQLで実現できる方法だとありがたいです。
最近、しょちゅうMYSQLが急に、停止しkillして再起動しておりますが、 その度に、以下のログが記載がありますが、具体的な対策などご存知でしたらご教示下さい。 現在、./ibdata1 は、./ibdata1 と./ibdata1.bak にしております。 InnoDB: Unable to lock ./ibdata1, error: 11 InnoDB: Check that you do not already have another mysqld process InnoDB: using the same InnoDB data or log files. InnoDB: Shutdown completed; log sequence number 0 100570041 [Note] /usr/libexec/mysqld: Shutdown complete mysqld ended InnoDB: Error in opening ./ibdata1 141007 22:41:19 InnoDB: Operating system error number 11 in a file operation. InnoDB: Error number 11 means 'Resource temporarily unavailable'. InnoDB: Some operating system error numbers are described at InnoDB: http://dev.mysql.com/doc/refman/5.0/en/operating … InnoDB: Could not open or create data files. InnoDB: If you tried to add new data files, and it failed here, InnoDB: you should now edit innodb_data_file_path in my.cnf back InnoDB: to what it was, and remove the new ibdata files InnoDB created InnoDB: in this failed attempt. InnoDB only wrote those files full of InnoDB: zeros, but did not yet use them in any way. But be careful: do not InnoDB: remove old data files which contain your precious data! 141007 22:41:19 [ERROR] Can't start server: Bind on TCP/IP port: Address already in use 141007 22:41:19 [ERROR] Do you already have another mysqld server running on por t: 3306 ? 141007 22:41:19 [ERROR] Aborting 141007 22:41:19 [Note] /usr/libexec/mysqld: Shutdown complete 141007 22:41:19 mysqld ended
SQLのご質問です（Oracle 11g）。 No 商品 1 A 1 B 1 C 2 A 3 A 3 D 4 E 【下記条件】 Aの商品が含まれている場合対象 また、BとCが混じっていても対象 その他の商品（AとBとC以外）が混じっていると非対象 結果 No 1,2が出力 とのSQLを作成したいのです。 条件が上手く浮かびません。 有識者の方ご享受宜しくお願い致します。
データベースに入っている値を見るとAUTO_INCREMENTされているIDなどが列の削除に空き（2の次が10のような）が存在しております。INT(10)に設定されているため、保管数の限界が存在します。こういうのを整頓（2の次は3）しなおすことはできるのでしょうか。 無知ですいませんが、教えていただけませんでしょうか。 組み合わせは、PHP＋Mysqlです。
お世話になっております。 添付画像にありますように、3月の単月テーブルにある数値を集計テーブルの 3月に反映させたいのですが、以下の点について教えてください。 1.更新クエリが最も効率的な方法なのか教えてください。 2.更新クエリを使う場合、デザインビューでどのように設定すればよいのか 　教えてください。 3.更新クエリ以外の方法があれば教えてください。 よろしくお願いします。
お世話になります。 前回の質問にて、説明不足でしたので、 改めて質問させていただきました。 ID,name,point 1.りんご.30 2.みかん.22 3.いちご.18 4.バナナ.13 5.すもも.4 6.マンゴー.1 上記のようなデータがある場合、pointが高いほど 選ばれ易くするような重みづけのある抽選のSQLを 記述したいのですが、その方法を お教えいただけないでしょうか。 データベースはSQLite3(必須)を使用しています。 使用する言語はJava、C#を検討していますが、 極力コードには依存せずに、SQLiteだけで 完結させたいと考えています。 サンプルなどを掲示していただけますと幸いです。 以上、よろしくお願いいたします。
お世話になります。 ID,name,point 1.りんご.30 2.みかん.22 3.いちご.18 4.バナナ.13 5.すもも.4 6.マンゴー.1 上記のようなデータがある場合、pointが高いほど 選ばれ易くするようなSQLを記述したいのですが、 その方法をお教えいただけないでしょうか。 ただのランダムであれば、『SELECT * FROM テーブル名 WHERE ID=abs(random()%全レコード数(この場合は6)+1』と すれば、均等にランダムで拾えますが、これを1のりんごのIDほど 取得しやすく、6のマンゴーほど発生しにくくするといった感じです。 以上、よろしくお願いいたします。
数字←フィールド名 1 2 3 4 5 6 7 上記のようなフィールドがあるとします。 クエリで 7を基点に4までの範囲を参照し合計する関数を教えて下さい。 初歩的な質問かも知れませんが2時間ほど彷徨っております。。 何卒よろしくお願いいたします。
WindowsServerでPHPとMySQLで作成したプログラムを動かしています。 PHPからINSERTでMySQLに登録すると環境依存文字（「(株)・(有)など）が「？」になってしまいます。 PHPからSELECTでブラウザ上に表示させると文字化けはしていませんが、phpMyAdminで確認すると「？」になっています。 このデータベースの内容を他のサーバーに移すときに、phpMyAdminからエクスポートまたはmysqldumpすると「？」のままエクスポートして、他のサーバーでインポートしても当然「？」になってしまいます。 環境依存文字が文字化けしない、あるいは他のサーバーでも環境依存文字をそのまま移行できるようにはできないでしょうか。 よろしくお願いします。 PHPはEUC-JP、データベースはujisで作成しています。 INSERTの直前でSET NAMES UJISを実行しています。
アクセスDB2013で、工事受注管理システムを作るところです。 現在、テーブルの仕様の作成をしております。 住所テーブルや、マスターを設計するところですが、工事受注時の工事する物件建物の住所登録や、協力会社登録などで登録する住所登録に使う住所の部分の設計でどのうようにしたら良いのか試行錯誤しています。 希望としては、データベースをクラウドに以降する事を想定して、データ容量を節約できるような設計にしようかと考えています。 例えば、 ◆顧客テーブル ・顧客ID ・顧客名 ・郵便番号 ・住所1 ・住所2 ・番地 ・建物名 などとするのと ◆顧客テーブル ・顧客ID ・顧客名 ・郵便番号 ・都道府県ID ・番地 ・建物名 ◆都道府県テーブル ・都道府県ID ・住所2 どちらが良いのか、または、その他の設計方法でもっと良いものがあれば、教えて頂きたいのですが。 よろしくお願いいたします。
MySQL5.6のストアドプロシージャが返すSELECT結果のフェッチ方法について教えてください。 delimiter $ create procedure sample_proc() begin select * from TEST_TBL; end$ の様なストアドプロシージャがあり、これを他のストアドプロシージャから呼び出して、 ループしながらフェッチしたいのですが、どうすればよいでしょうか。
お世話になります。 以下のようなテーブルがあります。 ID　年月　　　　商品数　利用者数 1　2013年9月　　10　　　　　　5 2　2013年10月　15　　　　　　3 3　2013年11月　20　　　　　　10 4　2013年12月　13　　　　　　5 　・ 　・ 　・ 12　2014年9月　10　　　　　3 このテーブルをクエリで以下のように表示したいところです。 　　　　　　　10月　11月　12月・　・　・　9月　←2014年の9月 商品数　　　　15　　　20　　13　　　　　　10 利用者数　　　3　　　10　　　5　　　　　　3 ※右端を先月とし過去1年分を表示したい。 クエリで上記のように表現することは可能でしょうか。 ご教授の程、宜しくお願い致します。
現在　技術評論社の「SQL書き方ドリル」で勉強中のものです。 答え合わせをしていて疑問に思った点があったので質問させていただきます。 第3章　その４　「外部結合を使う」 第５問(P168)の答えでGROUP BYを使わなくてもよい理由はなんでしょうか？ 問題文ではEmployeeごとと指定がありますので、サブクエリの中でEmployeeIDをグループ化しなくてはいけないような気がするのですが・・・。 どなたか回答よろしくお願いします。
Visual Studio Express 2013 for Webでデータベースアプリを作成しています。 例えば、 Person表 IdS_IdC_IdZ 11212 2222 323NULL 444NULL 54444 6555 7111 8167 9777 10666 1115NULL 12455 13455 14678 のようなデータがあり、横軸S_Id、縦軸C_Idの数、の積み上げ棒グラフ（StackedColumn） （S_Id毎にC_Idの数の内訳を示したグラフ。カウント対象はZがNULLでないものだけ） を作成するには、どのようなSQL SELECT文を書けばよいでしょうか。 目的とする要素数は、 SELECT S_Id, C_Id, COUNT(Z) FROM Person GROUP BY S_Id, C_Id; で出るのですが、 積み上げ棒グラフのためには、 SELECT S_Id, C_Id=1の数(ZがNULLでない), C_Id=2の数(ZがNULLでない), C_Id=3の数(ZがNULLでない), ．．． FROM Person GROUP BY S_Id; のような形にする必要があるようで、うまく書けません。 COUNTで、ZがNULLでなくかつC_Id=1のものをカウントする、というようなことができればよいのですが。
分かりやすくするために、テーブル名などは日本語で書きます。 曲名テーブルのアーティストはアーティストテーブルの番号から参照していて、 さらに、アーティストテーブルのアーティストは名前テーブルの番号から参照しています。 この場合に、曲名テーブルのアーティストを検索(例えば：「大塚愛」と検索)したいのですが、 検索してみても、なかなかピンとくる答えがありませんでした。 JOINで結合いいかと思いますが、テーブルから参照、さらにそのテーブルは、また別のテーブルから参照。 この様な場合はどうクエリーを書いたらいいか全くわかりません。 詳しい方宜しくお願いします。 現在、検証出来る環境がありません。 where 曲名 like '%大塚愛%'" 曲名テーブル +---------------+---------------+---------------+ |................[番号]............|................[曲名]............|.......[アーティスト].....| +---------------+---------------+---------------+ アーティストテーブル +---------------+---------------+ |................[番号]............|.......[アーティスト].....| +---------------+---------------+ 名前テーブル +---------------+---------------+---------------+ |................[番号]............|...............[名前]............|................[読み]............| +---------------+---------------+---------------+
お世話になります。 Access2010 Windows7 Pro 以下のページを参考にしましたが、「実行時エラー3170 インストール可能なISAMドライバーが見つかりませんでした。」と表示されてしまいます。 http://www.accessclub.jp/bbs5/0005/vba1231.html Dim Db As DAO.Database Dim Tbl As DAO.TableDef Dim xlsFile As String xlsFile = "ファイルパス" Set Db = OpenDatabase(xlsFile, True, True, "Excel 14.0;")　←ここで止まる For Each Tbl In Db.TableDefs If Right$(Tbl.Name, 1) = "$" Or _ Right$(Tbl.Name, 2) = "$'" Then 'シート名の最後は必ず$が付きます Debug.Print Tbl.Name End If Next Tbl Db.Close Set Db = Nothing なお、参照設定にて「Microsoft DAO 3.6 Object Library」にチェックが入っていないことが原因かと思い、チェックを入れようとしましたが「この名前は既にあるモジュール、プロジェクト、オブジェクトライブラリで使われています。」というメッセージが表示され、チェックを入れることができません。 勉強不足で大変恐縮ですが、これらのメッセージからどういうことが分かりますでしょうか。 ご教授の程、宜しくお願い致します。
1,住所A,氏名,電話番号,備考 2,金額B,金額,注文番号,備考 2,金額C,金額,注文番号,備考 1,住所D,氏名,電話番号,備考 2,金額E,金額,注文番号,備考 2,金額F,金額,注文番号,備考 2,金額G,金額,注文番号,備考 1,住所H,氏名,電話番号,備考 2,金額I,金額,注文番号,備考 2,金額J,金額,注文番号,備考 2,金額K,金額,注文番号,備考 2,金額L,金額,注文番号,備考 2,金額M,金額,注文番号,備考 上記のようなデータを13レコード取り込んだ際に フィールド１の数値１もしくは２の判定により フィールド１の数値の2を含んだレコードの分だけ フィールド１の数値の1を含んだレコードを増やし 下記のように10レコードにするには アクセスのクエリで出来るのでしょうか？ それともＶＢで構築する方法が良いのでしょうか？ お手数ですがアドバイスお待ちしております。 1,住所A,氏名,電話番号,備考,2,金額B,金額,注文番号,備考 1,住所A,氏名,電話番号,備考,2,金額C,金額,注文番号,備考 1,住所D,氏名,電話番号,備考,2,金額E,金額,注文番号,備考 1,住所D,氏名,電話番号,備考,2,金額F,金額,注文番号,備考 1,住所D,氏名,電話番号,備考,2,金額G,金額,注文番号,備考 1,住所H,氏名,電話番号,備考,2,金額I,金額,注文番号,備考 1,住所H,氏名,電話番号,備考,2,金額J,金額,注文番号,備考 1,住所H,氏名,電話番号,備考,2,金額K,金額,注文番号,備考 1,住所H,氏名,電話番号,備考,2,金額L,金額,注文番号,備考 1,住所H,氏名,電話番号,備考,2,金額M,金額,注文番号,備考
mysql> mysql> show variables like 'character_set%'; +--------------------------+----------------------------+ | Variable_name | Value | +--------------------------+----------------------------+ | character_set_client | sjis | | character_set_connection | sjis | | character_set_database | sjis | | character_set_filesystem | binary | | character_set_results | sjis | | character_set_server | sjis | | character_set_system | utf8 | | character_sets_dir | /usr/share/mysql/charsets/ | +--------------------------+----------------------------+ 8 rows in set (0.00 sec) mysql> mysql> character_set_systemもsjisに変更したいと考えております。 どのようにすれば可能でしょうか？ やりたいことはmysqlworkbenchでselect文のクエリ内容を日本語表記することです。 ご存知の方、宜しくお願いします。
現在C言語で開発を行っている初級のIT技術者です。 pro*cでは、inner joinやexistsを使うとコンパイルエラーとなってしまいます。 泣く泣く、inを使ってしまいました。例えば以下テーブルがあります。 請求テーブル 識別ID 更新日付 201405 20140922 100177 20140204 258087 20140412 201497 20140711 258055 20140812 履歴テーブル 加入者ID 識別ID(主キー) 2014　　 201405 5800　　 587405 2014　　 258087　 8507　　 874575 以下をパッケージに記載しています。 EXEC SQL SELECT 色々 FROM 請求テーブル WHERE 識別ID IN (SELECT 識別ID FROM 請求テーブル WHERE 加入者ID = 変数) ORDER BY 更新日付 ASC 例えば、変数として2014が来た場合は、履歴テーブルより 2014　　 201405 2014　　 258087 が選択されて、請求テーブルの更新日付を見て古い方を取ってくるので 結局258087 20140412が取得されます。この代わりとなる、pro*cで記述できる SQLはどんなのがありますでしょうか?
お世話になります。 Access2010 VBAよりCSVファイルの2行目の文字列を取得したいのですが、とりあえず下記で取得することができました。 path = CurrentProject.path cnt = 1 Open path & "\test.csv" For Input As #1 Do Until cnt > 2 　　Line Input #1, buf 　　If cnt = 2 Then 　　　　MsgBox buf 　　End If 　　cnt = cnt + 1 Loop Close #1 例えば、 1行目　xxxxx 2行目　フィールド1,フィールド2,フィールド3,・・・ 3行目　データ1,データ2,データ3・・・ という内容のCSVがあり、上記のVBAを実行すると、2行目の『フィールド1,フィールド2,フィールド3,・・・』を表示できます。 で、実際のCSVファイルは数十万行あるのですが、そのファイルを指定し上記VBAを実行すると、Line Input #1, bufの箇所で「実行時エラー14　文字列領域が不足しています。」と表示されてしまいます。 何かよい方法はございますでしょうか。 なお、当該Accessはユーザーへ配布するものであり、Runtime環境で実行します。 よって、CreateObjectは使えない状況です。 勉強不足で申し訳ございませんが、ご教授の程よろしくお願い致します。
このジャンルでお願いします。 次のようなテーブルで DROP TABLE IF EXISTS item; CREATE TABLE IF NOT EXISTS item ( id int(11) NOT NULL AUTO_INCREMENT, parent_id INT, name varchar(32) NOT NULL, level int NOT NULL, FOREIGN KEY (parent_id) REFERENCES item(id) ON DELETE CASCADE ON UPDATE CASCADE, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO item (parent_id, name) VALUES (null, 'item1'); INSERT INTO item (parent_id, name) VALUES (1, 'item2'); INSERT INTO item (parent_id, name) VALUES (2, 'item3'); INSERT INTO item (parent_id, name) VALUES (3, 'item4'); INSERT INTO item (parent_id, name) VALUES (2, 'item5'); INSERT INTO item (parent_id, name) VALUES (null, 'item6'); INSERT INTO item (parent_id, name) VALUES (6, 'item7'); INSERT INTO item (parent_id, name) VALUES (null, 'item8'); DROP PROCEDURE IF EXISTS UPDATE_LEVEL; DELIMITER // CREATE PROCEDURE UPDATE_LEVEL() BEGIN DECLARE CNT INT; DECLARE LVL INT; SET LVL=1; UPDATE item SET level=0; UPDATE item SET level=LVL WHERE parent_id IS NULL; SELECT COUNT(*) INTO CNT FROM item WHERE level=LVL; WHILE CNT>0 DO UPDATE item INNER JOIN (SELECT id FROM item WHERE level=LVL) as temp ON parent_id=temp.id SET item.level=LVL+1; SET LVL=LVL+1; SELECT COUNT(*) INTO CNT FROM item WHERE level=LVL; END WHILE; END // DELIMITER ; DROP TRIGGER IF EXISTS TRG_INSERT_ITEM; DELIMITER // CREATE TRIGGER TRG_INSERT_ITEM AFTER INSERT ON item FOR EACH ROW BEGIN CALL UPDATE_LEVEL(); END; // DELIMITER ; itemテーブルにinsertした場合にトリガーでUPDATE_LEVEL()を実行するようにしているのですが、 実際に挿入すると、 ＞Can't update table 'item' in stored function/trigger because it is already used by statment which invoked this stored function/trigger . このようなエラーが出てしまいます・・・ UPDATE_LEVEL()にinsertらしき記述はないと思うのですが、 これはなぜこのようなエラーが出るのでしょうか？
PL/SQLで質問があります。 たとえば複数レコードがあり、フェッチで1件ずつ処理する場合、 1件目で値あり、2件目NULLの場合、2件目のフェッチでINTOした変数はNULLが保証されるでしょうか？　それとも1件目の値が残ってしまうでしょうか？ サンプルでフェッチのループ内で変数の初期化をしない場合でも、NULLで上書きされているようにみえますが、PL/SQLではありませんが以前ProCでNULLの場合は前のレコードの値が残ってしまったため、PL/SQLは上書きが保証されるのかが気になっています（どちらもオラクルなので似た仕様になるのではと懸念）。 グーグル先生に聞いてみましたが、明記されているサイトがみつからず・・・。 ProCはインディケータでNULLを判定するので値の変数にはNULLの場合、何もしないだけでPL/SQLでは特に初期化を気にすることはないのかもしれませんが、仕様として記述されている箇所が見つからないためご存知の方がいらっしゃいましたら教えて頂けると助かります。 具体的には仕事でそういうコーディングになっている箇所があり、直すべきかそのままで問題ないかを検討しています。 現段階ではあまり修正できる状況ではないため、問題にならなければそのままとしたいと考えています。 サンプルの実行結果上は問題なさそうなのですが、できればプラスアルファの情報が欲しく。
※連投すみません。削除も修正もできなかったので連投になってしまいました。 一番重要な説明をコピペミスしてしまいました。 明日になれば削除できるようなので古い方は明日削除致しますm(__)m ---ここから--- 今日は9/24という想定で各部署の10営業日前の日付を取得したいのですが良い方法が思いつきません。 （ここ↓を参考にしたらできそうな気がしましたが私の頭では無理でした。。。） http://oshiete.goo.ne.jp/qa/6677209.html 【休日テーブル】 部署コード,　休日 ----------------- busyo1,　　　9/13 busyo1,　　　9/14 busyo1,　　　9/20 busyo1,　　　9/21 busyo1,　　　9/23 busyo2,　　　9/7 busyo2,　　　9/14 busyo2,　　　9/21 busyo3,　　　9/20 【結果】(各部署の10営業日前の日付) 部署コード,　日付 ----------------- busyo1,　　　9/9 busyo2,　　　9/12 busyo3,　　　9/13 このような「発想の転換」が必要な感じのSQLが本当に苦手です。 全然思いつかずに今日も半日を浪費してしまいました。 何かコツのようなものがあるのでしょうか。 お礼は明日の夜になってしまいますが何卒よろしくお願いします。
お世話になっております。GROUP BY に関してつまずいています。 色々と調べているのですが、解決できないため質問させて下さい。 まず下記のような履歴テーブルがあります。 rireki_member_noとは投稿者のIDであり、title1、title2に登録された日付データ（date型）は その投稿者が投稿した日付が登録されています。（title1だけの場合もあればtitle2だけの場合もあり、両方の場合もあります） rirekiテーブル rireki_no　rireki_member_no　　title1　　　　　title2 　1　　　　　　　2　　　　　　　2014-09-12　 　2　　　　　　　1　　　　　　　　　　　　　　　　　2014-09-12 　3　　　　　　　3　　　　　　　2014-09-14 　　2014-09-14 　4　　　　　　　2　　　　　　　2014-09-18 　5　　　　　　　1　　　　　　　　　　　　　　　　　2014-09-19 また、下記は投稿者のテーブルであり、rireki_member_noと、member_noは紐付いたものとなります。 memberテーブル memner_no　　member_name 　1　　　　　　　佐藤 　2　　　　　　　吉田 　3　　　　　　　佐々木 そこで今回行いたいのは、タイトルを指定し、且つ日付を範囲指定した時、その会員の名前、そして投稿した日付を一覧で表示したいと考えていますが、その際のSQL文が分からず困っている状況です。 イメージ的には、 title2を指定し、2014-9-13から20149-19と範囲指定した場合 3　　佐々木　　2014-09-14 2　　吉田　　　2014-09-19 といった結果を求めたいと考えています。 お恥ずかしいとは思いますが、実は昨夜からずっと悩んでいたりして・・・ rirekiテーブル単体であれば、 http://norm-nois.com/blog/archives/1293 で似たような内容で紹介されているのですが、今回のようにJOINが絡むと難易度が高くなっている状況です。 お忙しいなか恐縮ですが、お知恵を頂戴出来れば幸いです。 宜しくお願い致します。
テーブルAへINSERTをした場合のIDENTITY列の値を 同じトランザクション内で テーブルBの別のフィールドへINSERTしたいのですが、 どのようにSQLを書けばよいのか、困っています。 どうか、ご教示お願い致します。 INSERT INTOTABLE_A (NAME_A) VALUES ('あいうえお') ↓ INSERT INTOTABLE_A (A_ID,NAME_B) VALUES (取得したA_ID, 'さしす') INSERT INTOTABLE_A (NAME_A) VALUES ('かきくけこ') ↓ INSERT INTOTABLE_A (A_ID,NAME_B) VALUES (取得したA_ID, 'たちつ') INSERT INTOTABLE_A (NAME_A) VALUES ('さしすせそ') ↓ INSERT INTOTABLE_A (A_ID,NAME_B) VALUES (取得したA_ID, 'なにぬ') TABLE_A ID NAME_A 5　　'あいうえお' 6　　'かきくけこ' 7　　'さしすせそ' TABLE_B ID A_ID NAME_B 1　　5　　'さしす' 2　　6　　'たちつ' 3　　7　　'なにぬ'
日本語でどう説明すればもわからないのでタイトルも意味不明ですが 以下のテーブルからプリウスとアクアだけを取り出したいのです。 ○自動車テーブル○ 車名(PK),　連番(PK),　装備,　　数量 --------------------------------- プリウス,　　　1,　　エアコン,　　2 プリウス,　　　2,　　ブレーキ,　　1 アクア　,　　　1,　　ブレーキ,　　1 アクア　,　　　2,　　エアコン,　　2 レクサス,　　　1,　　　テレビ,　　3 レクサス,　　　2,　　　ビデオ,　　2 ノア　　　,　　　1,　　ブレーキ,　　1 ノア　　　,　　　2,　　　　テレビ,　　1 ○取得したい結果○ 車名 -------- プリウス アクア エアコン2個、且つブレーキ1個が装備されている車名を取得したいのです。 ブレーキ1個が装備されているだけのノアはエアコン2個という条件が満たされていないので取得したくありません。 そもそもこのようなことが可能なのかもわからないのですがjava側で処理をするには件数があまりに膨大なので行き詰まっています。 明日、職場からチェックさせていただきます。 お礼は夜になってしまいますが何卒よろしくお願いします。
no type name ---------------------------- 1 1 peach 1 1 peach 2 5 tomato 4 6 apple 4 6 apple 1 1 peach 　上記のように、重複するレコード（行）が存在してしまっているテーブルで、重複をなくす処理を、SQLで簡単に行なうにはどうしたら良いでしょうか。MySQLです。上の例では、下のように更新したいのです。よろしくお願いします。 no type name ---------------------------- 1 1 peach 2 5 tomato 4 6 apple
応援しているサッカーチームの試合データをMySQLを利用しテーブルに格納したいと考えています。 そこでMySQLやPHPに詳しい方にお聞きしたいことがあります。 例えばA・Ｂ・Ｃと3チームあるとしたら、A対B、A対Cの試合データは格納しますが、B対Cのデータは不要です。あくまでもAチームに関するデータのみを格納し、私が開設しているサイトで閲覧者に検索フォームから自由な形でデータを参照できるようにしたいです。 参考までに格納したい試合のデータは下記のようなデータです。 http://www.j-league.or.jp/result/2014/j2/030201. … 現在、既に一定のデータはテーブルに格納しています。現在のテーブルの構造です。 https://www.dropbox.com/s/z2qc2zff2fn8m8f/gamedb … スタメンの選手やベンチの選手、交代選手、警告をもらった選手、得点者などはテーブルに格納していません。これらのデータは試合ごとに大きく数が異なるのでどのようにして格納すれば良いのか分からなかったので。 現在は格納していないこれらのデータを格納することで下記のような条件を指定しても対象データが羅列されるようにしたいです。 ・○○選手がイエローカードをもらった試合。 ・点を取られている選手ランキング。□□選手(※対戦相手の選手)には一番点を取られているなど。 ・○○選手がスタメンだった試合。 ・○○選手が途中出場した試合。 ・○○選手はこれまで△試合に▲分出場している。 ・□分～□分の間の得点は何点。逆に失点は何点など。 などなどです。 私が現在思いついている構造ですが、新しくテーブルを複数作成する。こういったケースではそれぞれのテーブルに共通のIDを振る必要があるとのことですが、これは日付（開催日）で代用しようと思っています。同じ日に2試合は絶対にないので。 作成するテーブルは下記のようにします。 ・ホームチームスタメンテーブル ・アウェーチームスタメンテーブル ・ホームチームの警告をもらった選手テーブル ・アウェーチームの警告をもらった選手テーブル ・ホームチーム得点者テーブル ・アウェーチーム得点者テーブル .....などなど。 こういったテーブルを作成し、それぞれID(開催日)と一定数のカラムを予め用意する。得点者のテーブルでしたら1試合で一方のチームが10点を取ることは限りなく0に近いのでとりあえず10用意する。同じように得点した時間も10用意。 datadating(開催日) | goal_1_min(得点時間) ｜goal_1（得点者） ｜ goal2_min(得点時間) | goal2(得点者) |.......... このように格納していけば思い通りの結果が得られるようになるのかな？と思っていますが、果たしてこのようなテーブルで作成していき、後々サイト側の検索フォームから指定した条件で無事に結果を得られるか不安です。 ちょっとしたことでも良いので、詳しい方の意見をお聞きしたいです。 どうぞよろしくお願いします。 長文失礼しました。
MySql初心者ですのでお手柔らかにお願いします。 最近MySqlにロックという機能があることを知りました。 同時にデータベースの操作がされると困る場合にロックするのだと思うのですが、そういうことって結構起こるのでしょうか? updateの場合、取得してから更新するまでラグがあるので問題が起こるのはイメージできるのですが、insertする時にも起こりえるのでしょうか? だとすればどんな操作でもロックはするに越したことはないように思えますが、オプションで用意されてるということは必要な場面とそうでない場面があるということなのでしょうか。 また、不具合が起こるのであれば自分で実際に試してみたいのですが、そもそも同時に操作を行うやり方がわかりません。 意図的に不具合を出しながらテストする方法があれば教えていただけないでしょうか。 よろしくお願いします。
Filemaker13 Proなのですが、 デスクトップにあるcsvファイルを、 存在するかしないかを判断するスクリプトを作成できますか？ ヒントだけでもいただければ。よろしくお願いします。 ファイルメーカー　プロ　13
下記のようなデータがあります。 ファイル番号　順番　カード番号　名前 -------------------------------------------- 1 　　　1 0010 山田 1 　　　1 0009 佐藤 1 　　　1 0008 鈴木 2 　　　1 1010 高橋 2 　　　1 1011 小林 2 　　　2 1012 北沢 2 　　　2 1013 竹田 3 　　　1 2001 小山 3 　　　1 2000 田中 ファイル番号と順番でグループ化し、カード番号の最小・最大、その最小・最大の名前を 取得したいです。 サブクエリを使用して出来ましたが、1つのクエリで出来ないかと思い、質問しました。 よろしくお願いします。
現在様々なデータベースを使用していて、プログラムか何かの方法で、 OracleからMySql等ほかのデータベースにデータを移動することは可能でしょうか。 SELECT A INTO Bではできなかったと思います。 100件くらいの名前データだけなので、いちいちCSVに変換して再ロードするのが面倒です。
hostingerというレンタルサーバーで MySQLデータベースを作成しphpMyAdminで接続したのですが 特権メニューが表示されておらず、ユーザーの追加が出来ませんでした。 rootでログインしようにも、 ログイン名[root] + データベース作成時設定したパスワードでは サーバーに接続できず ログイン名[root]　+パスワード無しでも接続出来ませんでした。
このジャンルでお願いします。 次のようなテーブルで CREATE TABLE IF NOT EXISTS user ( id int(11) NOT NULL AUTO_INCREMENT, name varchar(32) NOT NULL, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO user (name) VALUES ('user1'); INSERT INTO user (name) VALUES ('user2'); INSERT INTO user (name) VALUES ('user3'); CREATE TABLE IF NOT EXISTS item ( id int(11) NOT NULL AUTO_INCREMENT, parent_id INT, name varchar(32) NOT NULL, FOREIGN KEY (parent_id) REFERENCES item(id) ON DELETE CASCADE ON UPDATE CASCADE, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO item (parent_id, name) VALUES (null, 'item1'); INSERT INTO item (parent_id, name) VALUES (1, 'item2'); INSERT INTO item (parent_id, name) VALUES (2, 'item3'); INSERT INTO item (parent_id, name) VALUES (3, 'item4'); INSERT INTO item (parent_id, name) VALUES (2, 'item5'); INSERT INTO item (parent_id, name) VALUES (null, 'item6'); INSERT INTO item (parent_id, name) VALUES (6, 'item7'); INSERT INTO item (parent_id, name) VALUES (null, 'item8'); CREATE TABLE IF NOT EXISTS user_item ( id int(11) NOT NULL AUTO_INCREMENT, user_id INT, item_id INT, type varchar(16) NOT NULL, PRIMARY KEY(id), FOREIGN KEY (user_id) REFERENCES user(id) ON DELETE CASCADE ON UPDATE CASCADE, FOREIGN KEY (item_id) REFERENCES item(id) ON DELETE CASCADE ON UPDATE CASCADE ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO user_item (user_id, item_id, type) VALUES (1, 1, 'allow'); INSERT INTO user_item (user_id, item_id, type) VALUES (1, 3, 'deny'); INSERT INTO user_item (user_id, item_id, type) VALUES (1, 7, 'allow'); user_itemのuser_idが1のitemの行を取得したいのですが、 その条件として ・user_itemテーブルのtypeが'allow'のitem_id以下のitemの行 ・ただしtypeが'deny'のitem_id以下の行は除く この例だと、user_itemの INSERT INTO user_item (user_id, item_id, type) VALUES (1, 1, 'allow'); の行によってitemテーブルの INSERT INTO item (parent_id, name) VALUES (null, 'item1'); INSERT INTO item (parent_id, name) VALUES (1, 'item2'); INSERT INTO item (parent_id, name) VALUES (2, 'item3'); INSERT INTO item (parent_id, name) VALUES (3, 'item4'); INSERT INTO item (parent_id, name) VALUES (2, 'item5'); が取得候補になりますが、 INSERT INTO user_item (user_id, item_id, type) VALUES (1, 3, 'deny'); によって INSERT INTO item (parent_id, name) VALUES (2, 'item3'); INSERT INTO item (parent_id, name) VALUES (3, 'item4'); の行は除かれ、 INSERT INTO item (parent_id, name) VALUES (null, 'item1'); INSERT INTO item (parent_id, name) VALUES (1, 'item2'); INSERT INTO item (parent_id, name) VALUES (2, 'item5'); の行が取得されます。 つまりitemテーブルにおいて上の階層の直近の（user_itemと結合して取得した）typeが 'allow'である場合のみ取得したいのです。 INSERT INTO item (parent_id, name) VALUES (null, 'item1');←取得 INSERT INTO item (parent_id, name) VALUES (1, 'item2');←取得 INSERT INTO item (parent_id, name) VALUES (2, 'item3'); INSERT INTO item (parent_id, name) VALUES (3, 'item4'); INSERT INTO item (parent_id, name) VALUES (2, 'item5');←取得 INSERT INTO item (parent_id, name) VALUES (null, 'item6'); INSERT INTO item (parent_id, name) VALUES (6, 'item7');←取得 INSERT INTO item (parent_id, name) VALUES (null, 'item8'); 複雑ではありますが、これはどのようなSQL文にすれば良いのでしょうか？
ACCESS初心者です。 エクセルでの条件付き書式ならわかるのですが、 同じようなことがACCESSでもできないかと思い、相談しました。 access （2003) 2007　または　2010で 次のようなデータをフォームで表示する際 データ構造 ID　ロット　商品名　生産者 1　　A　　　みかん　　　佐藤 2　　A　　　りんご　　　武藤 3　　A　　　いちご　　　江藤 4　　A　　　りんご　　　武藤 5　　B　　　りんご　　　須藤 6　　B　　　みかん　　　津藤 7　　B　　　りんご　　　江藤 （IDは表示しません） このデータで　同じロットに同じ生産者の同じ商品が入らないように チェックをしたいのです。 ですから、このデータでは　 ロット「A」生産者「武藤」商品名「りんご」の行　あるいは一項目が 強調表示されるようにしたいのです。 なにか良い方法があればお教え下さい。よろしくお願いします。
以下のようにDBに登録されています。 id　date　cost 129　1404313200　6000 76　1404313200　5000 129　1404226800　4000 54　1404226800　75000 129　1404226800　55000 日付はUNIX TIMEです。 各IDの、最新日のcostを抽出したいのですが、どのようにすればいいでしょうか。 上記だと 76　1404313200　5000 54　14042268007　5000 129　1404313200　6000 が抽出される方法を知りたいです。 （ID129のdateが1404313200で一番大きい＝最新） よろしくお願い致します。
エックスサーバーを借りているのですが、FILE権限がありませんでした。 GRANTで権限を付与しようとしてもエラーとなり付与できませんでした。 OUTFILEでCSVファイルを出力できないのですが、レンタルサーバーでデータベースをファイルで入出力するには一般的にどのような方法でやるのでしょうか？ dumpではなく、Webサービスを利用するユーザーにデータベースのデータをcsvファイルとして出力したいのです。 どうぞよろしくお願い致します。
iTunesのCDの読み込みが出来ません 読み込んだ曲が表示される前にCDがPCから出てきてしまいます どうすれば良いでしょうか
お世話になります。 Access2010にてツールを作成し、データをExcelにてエクスポートしたいと考えております。 新規Excelファイルでエクスポートする分は問題無いのですが、既存のExcelファイルにエクスポートすることは可能なのでしょうか。 例えば、既存のExcelファイルの特定のセル(範囲)に出力するイメージです。 その範囲は表になっており、そこにデータが入ることによって、自動的にグラフを生成したいと考えております。 ご教授の程、宜しくお願い致します。
センサデータを記録し、高速に集計や検索ができるデータベースを探しています。 記録＝1秒ごと、データ量＝約1GB/日、保存期間＝約1年間 必要な要件 ・時系列にデータを書き込めること ・データを追加しながら、分析できること よろしくお願いいたします。
データベースの勉強のため、入門書を購入して、はじめたのですが、 最初からいきなりつまづきました（>_<）。 開発環境　windows 8 SQL Server 2012 Express Visual Studio 2010　SP1 です。 これで、データベースファイルを作成して、サーバーエクスプローラーで、”新しいテーブルの追加”を クリックしたところ、 ”このバージョンはサポートされていません。サポータされているサーバーはSQL Server 2008までです。” とのエラーメッセージが出ました。 そこで、質問ですが、この環境で、設定変更で使えないものでしょうか？ それとも、SQL Server 2008にするか、またはVS2012にするしかないのでしょうか？ 詳しい方が、おられれば教えて頂きたいです。よろしくお願いします。
こんにちは データベース(mdbファイル)で、次のような置き換えをしたいのですが、スマートなやり方をご存じでしたら教えてください。 Membersテーブル id, name, status 1, 田中, 200 2, 鈴木, 300 3, 高橋, 200 4, 中村, 400 Membersテーブルのうち、status が 200 のレコードになっている name の前後に「ABC」と「XYZ」を付加する、という操作です。 置き換え作業後は次のようになります。 Membersテーブル id, name, status 1, ABC田中XYZ, 200 2, 鈴木, 300 3, ABC高橋XYZ, 200 4, 中村, 400 Where status = 200 と指定して、帰ってきたレコードをループさせて、1件ずつUpdateすればできるのですが、そもそもSQLコマンドの時点でスマートにできるのではないかと思い質問した次第です。SQLは詳しくないのですが、意外に柔軟でスマートなことができるようですので。。。 対象のファイルはmdbで、スクリプトはまだ作っていませんが、vbsになるのではないかと思っています。 Windows 7 and 8 64bit MS Accessはありません
現在ファイルサーバーを用いて共有ストレージを持っているのですが、ネットワーク経由だとファイルサイズが大きい為、読み込み、保存にとても時間がかかってしまいます。 なのでUSB接続などネットワークを経由しない方法で共有ストレージを持つ方法を探しています。 容量としては20TB程度のストレージを検討しているのですが、このようなシステムは構築可能でしょうか？？ 詳しい方がいらっしゃいましたらアドバイスお願いします。
このジャンルでお願いします。 次のようなテーブルで CREATE TABLE IF NOT EXISTS user ( id int(11) NOT NULL AUTO_INCREMENT, name varchar(32) NOT NULL, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO user (name) VALUES ('user1'); INSERT INTO user (name) VALUES ('user2'); INSERT INTO user (name) VALUES ('user3'); CREATE TABLE IF NOT EXISTS item ( id int(11) NOT NULL AUTO_INCREMENT, name varchar(32) NOT NULL, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO item (name) VALUES ('item1'); INSERT INTO item (name) VALUES ('item2'); INSERT INTO item (name) VALUES ('item3'); CREATE TABLE IF NOT EXISTS user_item ( id int(11) NOT NULL AUTO_INCREMENT, user_id INT, item_id INT, PRIMARY KEY(id), FOREIGN KEY (item_id) REFERENCES user(id) ON DELETE CASCADE ON UPDATE CASCADE, FOREIGN KEY (user_id) REFERENCES item(id) ON DELETE CASCADE ON UPDATE CASCADE ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO user_item (user_id, item_id) VALUES (1, 1); INSERT INTO user_item (user_id, item_id) VALUES (2, 1); INSERT INTO user_item (user_id, item_id) VALUES (3, 2); INSERT INTO user_item (user_id, item_id) VALUES (1, 2); INSERT INTO user_item (user_id, item_id) VALUES (1, 3); INSERT INTO user_item (user_id, item_id) VALUES (3, 3); user_itemテーブルでのselectで、 user_idが1で一番最初に挿入された行だけ を取得したいのですが、どのようなSQL文にすれば良いのでしょうか？ この例なら INSERT INTO user_item (user_id, item_id) VALUES (1, 1);←取得 INSERT INTO user_item (user_id, item_id) VALUES (2, 1); INSERT INTO user_item (user_id, item_id) VALUES (3, 2); INSERT INTO user_item (user_id, item_id) VALUES (1, 2);←user_id=3が最初に挿入されているので取得しない INSERT INTO user_item (user_id, item_id) VALUES (1, 3);←取得 INSERT INTO user_item (user_id, item_id) VALUES (3, 3);
テーブルtb1が以下のようになっているとします id, region, station1, station2, station3, station4, station5 0, 東京, 池袋駅, 渋谷駅, null, 新宿駅, null 1, 横浜, null, 横浜駅, 戸塚駅, 菊名駅, 反町駅 2, 大阪, 梅田駅, 天満駅, 野田駅, null, null このようなテーブルを、以下のような結果として取得するSELECT文はどのようになるのでしょうか？ 0, 東京, 0, 東京, 池袋駅 0, 東京, 渋谷駅 0, 東京, 新宿駅 1, 横浜, 1, 横浜, 横浜駅 1, 横浜, 戸塚駅 1, 横浜, 菊名駅 1, 横浜, 反町駅 2, 大阪, 2, 大阪, 大阪駅 2, 大阪, 梅田駅 2, 大阪, 野田駅 複数の列を行にするのがわかりません。 そもそも、tb1の設計が良くないのですが、これは変えられないと先方に言われました。 どうぞよろしくお願い致します。
おせわになります。助けてください。 id | nendo | sdate | edate 0 | 2012 | 2012-04-01 | 2013-03-31 1 | 2013 | 2013-04-01 | 2014-03-31 2 | 2014 | 2014-04-01 | 2015-03-31 2 | 2015 | 2015-04-01 | 2016-03-31 といったデーターベースがあります。 2014/03/31 という日付がどの年度の日付なのかを 調べるＳＱＬをどう書けばいいのかわかりません。 SELECT * FROM m_nendo WHERE sdate <= '2014/03/31' and edate >'2014/03/31' といった書き方をしているのですが、思う結果を取れません。 ネットでどういう言葉で検索したらいいのかも・・・わかりません。 書き方をご存知の方、教えて頂けませんか？ よろしくお願いします。
オラクルのselect for updateでロックをするタイミングがいつですか？ こんなPL/SQLのコードがあったとします。 ---↓↓↓ソースコードここから↓↓↓------------------------- select * from テーブル1 where id = 1 for update;　・・・・・(a) ～ update テーブル1 set kingaku=100 where id = 1　・・・・・(b) ～ commit; ---↑↑↑ソースコードここまで↑↑↑------------------------- id = 1のレコードがロックされるのは(a)、(b)どちらのタイミングですか？ また、このロックは ・他トランザクションから読めるけど更新できない ・他トランザクションからは読むことすらできない のどちらでしょうか？ よろしくお願いします。
ORALCEのexpdpおよびimpdpの勉強のために自宅環境で操作していたところ、 impdpにてORA-39166（オブジェクトが見つからない）が発生してしまいした。 いろいろ調べてみたのですが、解決に至ってないためお力添えをお願いいたします。 【環境】 OS : linux ※CentOS（64bit） ORALCE11gXE 【やりたいこと】 studyスキーマのTEST1テーブルをexpdpでエクスポート（content=data_only）し、 同じスキーマ内のTEST2テーブルにimpdpにてデータを入れる。 【発生までの操作】 １．expdp system/パスワード@XE directory=test_dir tables=study.TEST1 log=test_exp.log content=data_only ２．impdp system/パスワード@XE directory=test_dir dumpfile=expdat.dmp log=test_imp.log tables=study.TEST2 content=data_only ２の操作をしたタイミングで以下のメッセージ。 ORA-39002: invalid operation ORA-39166: Object STUDY.TEST2 was not found. 【備考】 ・TEST1およびTEST2はまったく同じテーブル構造です。studyユーザで作成してます。 ・STUDY.TEST2は存在します。 （「sqlplus study/パスワード@XE」でログインしdesc TEST2で確認できるため） ・exdpは正常に終了しており、dumpファイルは「expdat.dmp」で作成されています。 以上です。 ご教授のほどよろしくお願いいたします。
お世話になります。 現在、表題につきまして以下の質問をさせて頂いておりますが、もう一つ質問させて頂きます。 http://questionbox.jp.msn.com/qa8724865.html インポートしようとしているCSVファイルはカンマ区切りですが、その中のデータにカンマが含まれている場合がございます。 項目1　　項目2　　項目3　・・・ 　1　　　　あ,あ　　　いい 　2　　　　うう　　　　ええ これをカンマ区切りでインポートすると、 項目1　　項目2　　項目3　　フィールド1　←自動的についたフィールド名 　1　　　　あ　　　　　あ　　　　いい 　2　　　　うう　　　　ええ となってしまいます。 これを回避する方法はございますでしょうか。 ※CSVファイルは変更したくないので、予めCSVから不要なカンマを削除しておく・・というのは無しでお願いします。 ご教授の程、宜しくお願い致します。
お世話になります。 あるCSVファイルをインポートしたいのですが、以下のようなフォーマットです。 XXXXXX 項目1　　項目2　　項目3　・・・ 　1　　　　ああ　　　いい 　2　　　　うう　　　　ええ 一覧？外にあるXXXXXの部分があるので、普通にインポートできません。 もちろんXXXXXXの部分を削除した状態でインポートすればよいのですが、当該CSVファイルは変更したくありません。 ※このインポート作業は日々行うことになりそうなので、都度、XXXXX部分を削除するのが面倒でもあります。 このようなフォーマットのものをインポートすることは可能なのでしょうか。 ご教授の程、宜しくお願い致します。
下記のようなデータを扱っております。 ID | Point 1 | 10 2 | 20 3 | 30 4 | 20 5 | 30 6 | 10 7 | 20 8 | 30 9 | 30 上記データにおいて、Pointが10,20,30と連続している時の Pointが30でのID値を取得するSQL文が分かりません。 上記データであれば、ID3と8が条件に合致しており、取得したいID値となります。 ID5や9はPointが30ですが、『Pointが10,20,30と連続している』という条件に合致していない為、取得したいID値ではありません。 これを叶えるSQL文を教えて頂けないでしょうか。 (SQLiteを使用しています。)
Mysqlの検索用のインデックスの書き方を調べているのですが、なかなか見つかりません。 テーブル、customersを作成して、その中に、項目として、 `email` varchar(100) default NULL を定義した場合、 インデックスの付与として、 KEY `idx_customers_email` (`email`) と書いた場合と、 FULLTEXTインデックスの付与として FULLTEXT KEY `email` (`email`) と書いた場合、何が違うのでしょうか？ また、このあたりの詳しい説明が載っているサイトとかあれば是非教えてください。
お世話になります。 DB初心者です。 現在とある中規模の掲示板システムを設計しています。 データベースを利用する事での利点をお聞きしたいです。 お恥ずかしながら、当方あまりデータベースを利用した事がなく これまで掲示板等のログは全てテキストファイル形式で利用してきました。 従って、データベースの技術的な知見も乏しい事から、今回データベースを 利用するにあたっては、そのメリットを最大限に活かせる事が 出来ないのではないかと不安に考えています。 （逆にシステム高負荷になったり…） そこで、データベースを利用する事で、何がどうメリットがあるのか もしくはデメリット等、教えて頂けませんでしょうか？ よろしくお願いします。
MySQL 5.5で、mysqlコマンドからSQLを流したときと、PHPから同じSQLを発行したときで結果が違うのです。 どうも日付のパースが関係しているようで、「2014-08-19」と書くとどちらも同じ結果になるのに、 「2014-8-19」と書くとPHPでは1行も返ってこなくなります。 再現例： ================== CREATE TABLE t (day date NOT NULL) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; INSERT INTO t (day) VALUES ('2014-08-19'); SELECT * FROM t WHERE day = '2014-8-19'; +------------+ | day | +------------+ | 2014-08-19 | +------------+ 1 row in set (0.00 sec) ↑同じSELECTをPHPから発行すると1行も返ってこない。 ================== mysqldとmysqlは5.5.30。 phpinfo()のmysqlのセクションでは Client API version 5.5.30 と出ています。 show variablesで見るとdate_formatはどちらも%Y-%m-%dになっています。 他にどこを確認すればいいでしょうか？
SQL Server 2008での話です。 製品テーブルと、その製品の売れ行きのランキングデータを格納するテーブルがあって、 売れ行きの良いものTOP10だけ取り出したいと思っています。 製品IDがキーになっています。 ランクテーブルから10位以内の製品IDをSELECTし、それをIN句に 入れるということをやっていたのですが、遅かったので、EXISTSに 書き変えました。 更に、INNER JOINにしてしまえば、WHERE句より実行されるので、 より速くなると聞き、試しているところです。 実際、速くはなったのですが、以下パターンだとそれほど差が出ません。 （データの件数のせいだとは思いますが…） どちらがベターなのでしょうか。 Bのほうが先に絞り込みをしてから結合されるから、速い…ような気が しているのですが、動き的には一緒だったりしますかね…。 もしより良い書き方がありましたらご教授ください。 ■Aパターン SELECT * FROM 製品テーブル INNER JOIN ランクテーブル ON 製品テーブル.製品ID = ランクテーブル.製品ID AND ランクテーブル.順位 <= 10 ■Bパターン SELECT * FROM 製品テーブル INNER JOIN ( SELECT ランクテーブル.製品ID FROM ランクテーブル WHERE ランクテーブル.順位 <= 10 ) TMP ON TMP.製品ID = 製品テーブル.製品ID
データベースに関する質問です。 現在、学校でデータベースを使用したシステムを開発しています。 データベースは主にPostgreSQLを使用しています。 データをINSERTする際に大文字小文字を区別せず、 同じ文字列であるかどうかチェックする方法はありますか？ たとえば、「abc123」と「aBc123」を同一とみなし INSERTできないようにしたいです。（主キーのため） システム側ではなく、できればデータベース側で判定を行いたいです。 宜しくお願い致します。
コンピューターを使うには、データ（電子データ）が必要です。CPU、メモリー、グラフィックボード、チップセット、電源、ディスプレーなどが充実していても、データが空なら単なる鉄の塊で、飾るだけです。 データを保存するにはデータベースが必要と聞いた事があります。本当でしょうか？確かに、データベースにデータを保存する事が多そうですが、データベース以外にもデータの保存スペースがある気がします。私の記憶が確かなら、、キャッシュメモリーはデータベースの構成要素の一であり、キャッシュメモリーにデータがあればデータベースにデータがあるという事と聞いた気がする。 色々と記憶が曖昧で、混乱して、このように質問してます。 データベースにも色々ありますが、その王様はリレーショナルデータベースだとよく聞きます。リレーショナルデータベースは、ありとあらゆるデータを保存できて、何にでも活用できるそうです。本当でしょうか？ 例えば、リレーショナルデータベースの操作にSQLが使われますが、このプログラム文をリレーショナルデータベースに保存しますでしょうか？私の認識だと、SQLはテキスト形式のSQLファイルで、マイドキュメントなどのフォルダーに保存します。 SQLの他、小説、写真、音声、ビデオ、３次元CADなども、リレーショナルデータベースに保存しますでしょうか？ 私の認識だと、リレーショナルデータベースは表（２次元マトリクス）の集合です。表はセルで作られていて、行×列に配置しています。セル１つには、１行文字列、実数（整数と有限少数）、時刻、NULLだけが保存できます。これだと自由度や用途が狭く限られそうですが、セルを膨大に用意できて、これで幅広い自由度を得ます。 リレーショナルデータベースにも小説を保存できる。その方法は、小説を３０字区切りで分割し、主キーを振ること。１つのセルに３０字の文を保存し、その下に次の３０字の文を保存し、これを終わりまで繰り返します。正しいでしょうか？ リレーショナルデータベースにも写真を保存できる。先ず、赤表、青表、緑表の３つを用意する。各表のマトリクスサイズは膨大で写真のピクセルがセルに対応し、行×列に配置します。各セルには画素３原色の強度数（0～255だとgif形式だっけ？）を保存する。その後、赤青緑の３表を合成し、ビットマップで出力します。正しいでしょうか？ リレーショナルデータベースは銀行でよく使われていて、お金の出入りや顧客管理でリレーショナルデータベースは大活躍しているそうです。だけど、本当はもっと用途が広い？ フォルダファイルシステムとデータベースは別物と聞いた事があります。一方で、フォルダファイルシステムの基本はデータベースで、データベースに何かアプリを組み合わせてフォルダファイルシステムが形成されているとも聞いた事があります。どっちが正しいでしょう？どっちも間違い？
いつもお世話になっております。いろいろSQL文の本を読んだのですがわからないので今回もよろしく お願い致します。 SELECT DISTINCT * FROM bukken WHERE (id IN (SELECT fid FROM fudou_kodawari WHERE kid IN (1,4))) というSQL文があるのですが、これだと1,4が1つでも含まれるリストが出てくるのですが1,4が完全に一致しないと出てこないようにするにはどのようにSQL文を変更すれば良いのでしょうか？ 何卒よろしくお願い致します。
いまサーバーで管理している情報をすべて英語に翻訳してデータベースに登録するにはどういう方法があるのでしょうか？ Google Translateを使ってすべてのデータを英語にすることはできたのですが、変換されたあとそのデータをどうやってデータベースにいれてあげればいいかで止まってます。 回答よろしくおねがいします！
データベースをほとんど知らない初心者です。 現在、会社の受注・経理処理等を複数のエクセルファイルで行っていますが、 いろいろなファイルを参照しあっているので、年度毎のファイル作成や、 レイアウト変更、フォマット変更、シート追加などをすると作業が面倒になってきています。 そのため業務を簡素化するために、 データベースを利用して管理を行いたいと思っているのですが、 いったい何のデータベースを、また何から勉強すればいのかがわかりません。 そこで ・下記の条件に合うデータベース ・それを勉強するためにおすすめの書籍やサイト ・ブラウザを介する場合は、phpを使用したほうが良いのか？ 　それとも別の方法を使用したほうが良いのか？ を教えて頂けますようにお願いします。 希望 ・Windowsベースのデスクトップに導入出来ること ・無償or低価で使用できること ・動作が安定していること ・処理スピードが早いこと ・フリーレイアウトで印刷できること (現在のエクセルのレイアウトと同様に印刷したいです。) ・ブラウザを介してデータベースを使用予定 他にどのような情報を提示しないといけないのかわからないので、 『このような情報が無いと回答出来ない』と言ったことが有りましたら、 教えて頂けると幸いです。 宜しくお願いします。
下記の様テーブルよりproduct_idごとに【結果】の様な形として 出力したいと考えております。 【TableA】 order_id｜product_id｜product_name | quantity 001　　product001　　商品名１　　2 002　　product001　　商品名１　　1 002　　product002　　商品名２　　2 003　　product002　　商品名２　　1 003　　product003　　商品名３　　1 【結果】 product_id｜product_name｜quantity｜order_id product001　　商品名１　　　　3　　　　　001, 002 product002　　商品名２　　　　3　　　　　002, 003 product003　　商品名３　　　　1　　　　　003 SELECT product_id, max(product_name), sum(quantity), order_id FROM TableA GROUP BY product_id, order_id としてみたのですが、 product_id｜product_name｜quantity｜order_id product001　　商品名１　　　　3　　　　　001 product001　　商品名１　　　　1　　　　　002 product002　　商品名２　　　　2　　　　　002 product002　　商品名２　　　　1　　　　　003 product003　　商品名３　　　　1　　　　　003 となってしまい、order_idを上記の様にセルにまとめて表示する方法をお教え頂けますと幸いです。 MySQLではGROUP_CONCAT関数を使う事で実現出来たのですが PostgreSQLでの実現方法が分かりかねています。 尚、PostgreSQLのバージョンはPostgreSQL 8.1.23です。 どなたかご教示頂けますと幸いです。
現在MySQLを学習しているんですが、ちょっとわからない問題が出てきまして質問させていただきます。 トリガーの問題なんですが、 各種テーブルに対して更新処理（追加、削除、更新）した場合、その処理を実施した時間、ユーザー名、テーブル名、処理内容を別のテーブルに自動保存する って内容なんですが、ここのテーブル名、処理内容の自動保存の構文がびっくりするくらい分かりません。。。。。 結構調べたのですが、なかなかヒットしないので質問させて下さい（涙） お願い致します（涙）
最近MySQLをちょこちょこ触っているものですが、ふとした疑問にぶち当たりました。 もし、ご存じの方がいらっしゃいましたらご教授頂けないでしょうか？ 質問 AというMySQLマスターServer BというMySQLスレーブServer があり、お互いにレプリケーションの関係を築いております。 ここに、突然 全く別のデータが入っている CというMySQLマスターServerの受け皿としてBをスレーブに出来ますでしょうか？ つまり、B(MySQLスレーブServer)はAのスレーブでもあり、Cのスレーブでもある。 ということが出来るのでしょうか？ （出来る、出来ないで結構です、やり方などのご教授はいりません。） MySQLにお詳しい方いらっしゃいましたらアドバイス頂けないでしょうか？ よろしくお願い致します。
お世話になります。 店舗販売、通販を始めて約7年程が経ちました。 少しずつではありますが固定客も増えつつあります。 しかし、弊社は現在のいくつかの問題を抱えています。 下記は、弊社が抱えている問題です。 店舗と通販の在庫が合わず棚卸しの際に、残業が続いてます。 店舗と通販の共通ポイント化がされていません。 顧客ランクの管理。 売上集計がデーターベースとの連携が取れていません。 解決策としてO2O（オーツーオー）を取り入れようと思い製品の説明会に何度も足を運びましたが弊社に合う製品がありませんでした。 結果、店舗と通販の製品を一元管理できるように自社開発することになりました。 ここからが本題なのです。データーベース設計する際、店舗と通販は別々のテーブルを作成する必要があるのでしょうか？ 以上、宜しくお願い致します。
mysqlのバックアップを検索したところ、データベースがオンライン(稼働中)の場合、mysqlhotcopyやmysqldumpを使ってのバックアップで、オフラインの場合は、/var/lib/mysql/*のディレクトリコピーをするといったサイトが多いのですが、オンライン中(稼働中)に/var/lib/mysql/*のディレクトリコピーをするのは問題があるのでしょうか。 単純にディレクトリコピーをしてしまえば、リストアの時も簡単な気がするのですが、オンライン中にディレクトリをコピーしたら、壊れるとかありますか。 よろしくお願いします。
入力するためのシート1からデータをためるためのシート2に入力するものをマクロのボタンでできるようにしたいのですがどのようにマクロのVBA打てばいいのか分からないので教えて下さい。 したいことは、データ４列でシート1の1行目は項目の行にして、 2行目にデータを入力する。 入力したデータを切り取って、シート２の２行目に張り付けて 次のデータをシート１の２行目に入力して 同じように切り取って次は３行目、４行目…というマクロ作りたいんです。 どなたかお願いします
Excelで以下のような表をデータベースにした場合についてお伺いします。 【Excel表】-------------------------------------- 購入日　, 店舗, 商品名１　, 商品名２, 商品名３ 2014/4/1, Ａ店, ボールペン, ノート　, えんぴつ 2014/4/2, Ｂ店, ハンカチ　, 洋服　　, くつした ------------------------------------------------- まず第一正規形は以下のようになると思います。 【第一正規形】----------------------------------- 購入日　, 店舗, 商品名 2014/4/1, Ａ店, ボールペン 2014/4/1, Ａ店, ノート 2014/4/1, Ａ店, えんぴつ 2014/4/2, Ｂ店, ハンカチ 2014/4/2, Ｂ店, 洋服 2014/4/2, Ｂ店, くつした ------------------------------------------------- 第二正規形は以下のように重複している部分を別のテーブルにします。 【第二正規形】----------------------------------- tb_purchase 購入日　, 店舗コード, 商品名 2014/4/1, 1 　　　　, ボールペン 2014/4/1, 1 　　　　, ノート 2014/4/1, 1 　　　　, えんぴつ 2014/4/2, 2 　　　　, ハンカチ 2014/4/2, 2 　　　　, 洋服 2014/4/2, 2 　　　　, くつした tb_shop 店舗コード, 店舗 1 　　　　, Ａ店 2 　　　　, Ｂ店 ------------------------------------------------- 質問１． ここで疑問に思ったのですが、このようにtb_shopの「店舗コード」は実際にはどのようにして作成するのでしょうか？ tb_shopには重複しない「店舗コード」が必要ですが、それにはAUTO_INCREMENTを使うのが一般的なのでしょうか？ 質問２． 実際の挿入時のクエリーは以下のような感じで良いのですか？ １．「2014/4/3にＡ店で消しゴムを買った」というデータを挿入する場合 　1. tb_shopで店舗カラムが「Ａ店」となる店舗コードを取得 　2. tb_purchaseに「2014/4/3, 1, 消しゴム」を挿入 　こんな感じでしょうか？ ２．「2014/4/3にＣ店で牛乳を買った」というデータを挿入する場合（1～4はそれぞれ一つのクエリーです）、 　1. tb_shopで店舗カラムが「Ｃ店」となる店舗コードを取得 　2. Ｃ店が存在しないのでtb_shopに挿入 　3. 挿入後に「Ｃ店」となる店舗コードを取得 　4. tb_purchaseに「2014/4/3, 3, 牛乳」を挿入 　なんか手間が増えますが、1～3はそれぞれ別々のクエリーでやらないとダメでしょうか？ 質問３． あと質問ですが、このままだとtb_purchaseは主キーがないので、購入idのようなカラムは必要ですよね？ 主に聞きたい内容は上記の「店舗コード」なる、テーブルとテーブルを繋ぐコードのようなものは どのように作るのが一般的で同時挿入でも重複しないコードを作れるか？という点です。 自前でたとえば「S001, S002, …」というようなコードを作ったら、同時挿入で問題が出ますよね？ 初心者的な質問ですみませんが、どうぞよろしくお願い致します。
AスキーマとBスキーマがあり AにはSというシーケンスが作成されて、GRANTでBに権限付与されています。 BのUSER_SEQUENCESにはもちろん存在しないため、 SELECT MAX_VALUE FROM USER_SEQUENCES WHERE SEQUENCE_NAME でMAX_VALUEの取得でエラーになります。 これを回避する方法ってありますでしょうか？？ もしくはBのUSER_SEQUENCES に追加する方法がありますでしょうか？ どなたかお願い致します。
Accessをフロントエンドとして、SQL Serverをバックエンドとしてデータベースを構築したいとします。 【質問1】 構築後、Accessのテーブルやフィールドを変更することはできるのでしょうか。 【質問2】 上記の仕組みをWindowsサーバではなく、UNIXサーバ上で実現できるでしょうか。
受注金額や発注金額をDBから読み込み、税抜および税込の金額を算出するプログラムを作成しています。 税込金額を算出する際は金額+floor(金額*税率)の式を用いているのですが、 消費税分が整数になる場合、floor計算後に金額が1足らなくなることがあります。 桁上がりしない程度の数を足せばいいと言われたのですが、税率8%計算でギリギリ繰り上がらない0.039を足しても、2500万前後で誤差が発生してしまいます。 扱う金額は現在DBにある中では最大で4000万を越えます。 どうにか誤差が発生しないようにできないでしょうか？
AUDIT TABLEは特定のテーブルに対する監査ではなく、全部のテーブルに対する特定の処理(DDL)を監査するものだという記述を見ました。 しかし、別のところで AUDIT TABLE ON ＜テーブル名＞ というSQL文の例を見ました。 これだと特定のテーブルに対する監査になると思うのですが、このSQLはそういう解釈で正しいのでしょうか？ また、特定のテーブルに対するすべての操作の監査をするには AUDIT SELECT,INSERT,UPDATE,DELETE,LOCK ON <Schema>.<Object> BY ACCESS; だけではDROPやCREATEが監査できないので不十分でAUDIT TABLEと組み合わせないと無理ということになるのでしょうか？ 出展が明記できてなくて申し訳ありません。個人的なblog等ではないので執筆者に問い合わせるなどはできないようです。
監査について調べています。 監査証跡への出力項目として上の用語が出てくるのですが、いまいち違いがはっきりしません。 具体的にこれらの違い、それぞれ何を指すのか、どのような値が入るのか教えていただけませんでしょうか。また自動的にはいるのか、何か設定していないと入らないのかなど。 差し支えなければ、実際のログの例などから教えていただければ理解しやすいかと思います。 よろしくお願いします。 なお関係するようでしたら、oracle11gサーバはsolaris 端末はwindowsで動作させた場合と想定していただいても結構です。
お世話になります。 このようなテーブルがあるとします。 Ｎｏ｜日時　　　　　｜　部門　 ｜　更新内容　 --＋------------＋--------＋---------- 1 ｜04/12 12:21:35｜　Ａ部門 ｜　更新Ｃ 2 ｜04/07 09:15:05｜　Ｂ部門 ｜　更新う 3 ｜04/19 08:23:45｜　Ａ部門 ｜　更新Ａ 4 ｜04/05 10:15:20｜　Ｂ部門 ｜　更新あ 5 ｜04/20 09:20:13｜　Ｂ部門 ｜　更新い 6　 ｜04/02 09:20:15｜　Ａ部門 ｜　更新Ｂ この中から部門毎にグループ化して 部門毎に日時の最新のデータ Ｎｏ｜日時　　　　　｜　部門　 ｜　更新内容　 --＋------------＋--------＋---------- 3 ｜04/19 08:23:45｜　Ａ部門 ｜　更新Ａ 5 ｜04/20 09:20:13｜　Ｂ部門 ｜　更新い を抜き出すクエリの作り方を教えてください。 ちなみに今困っているＤＢの更新内容に相当するフィールドは５０フィールドほどあります。 よろしくお願いします。 多分クエリの集計を使用すると思っています。 多少ですがＳＱＬわかります。 多少ですがＶＢＡわかります。
現在Accessで組まれているデータベースがあるのですが、複数人で入力をする必要が出てきたため、SQL Serverへ移行したいと思っています。 ただ、まだデータベースの内容が完全にFIXしておらず、項目に変更や追加が発生する可能性があります。 そこで、 ●Accessを管理画面として使い、 ●Access上で内容を変更したら、システム全体もその通り変わる ような仕組みを作りたいのですが、可能でしょうか。 （完全にSQL Serverへ移行するのではなく、AccessとSQL Serverを連携させる？） よき方法がありましたら教えて頂けましたら幸いです。 ちなみにコストはあまり大きくはかけられません・・。 どうぞよろしくお願いします。 （※私はシステムはど素人なので、なるべく簡単に教えて頂けたら嬉しいです。なお、説明がおかしなこともあるかと思いますがご容赦ください。）
auditのログが出力先されません。 パラメータは次の通りです。 SQL> show parameter audit audit_file_dest string C:\TEMP audit_sys_operations boolean FALSE audit_syslog_level string audit_trail string OS auditを設定しました。 SQL> audit select on TESTUSER.TESTTABLE; 監査が成功しました。 しかし、次のSQLを実行しても、ログが出力されません(C:\TEMPの中を探しましたが見つかりません)。 SELECT * FROM TESTUSER.TESTTABLE;
CentOS6.4にpdo_mysqlが入ってなかったので、ダウンロードして展開までしたのですが、 cd PDO_MYSQL-1.0.2 で展開先のディレクトリに入って、 $ ./configure --with-pdo-mysql=shared,/usr/local/mysql を実行しようとすると、configureがないと言われてしまいます。 configureを実行するには何がしかのソフトをインストールする必要があるのでしょうか？ 情報いただけたらと思います。
複数のテーブルをleft joinで繋いで、カラムをエクセルのようなシートとしてWebで表示しています。 各カラムは、VERCHAR、DECIMAL、INT（SMALLINT～MIDIUMINT）の型を持っています。 エクセルのシートのような感じなので、エクセルのオートフィルタのような機能を付けたいと考えています。 各カラムをAND条件で指定できるやつです。 ですが、そもそもカラムの数が30ほどあります。 このような場合でもANDやBETWEENを使ってひたすらWHERE条件やCASEなどで抽出するようにするのでしょうか？ DECIMALやINTの場合は条件を○○（最低値）～○○（最高値）のようにします。 VARCHARの場合は、選べる文字列が複数（数十程度）あり、そこから選べるようにします。 例えば、東京駅。渋谷駅、新宿駅、品川駅、横浜駅・・・などがあって、フィルターしたい文字列だけ選びます。 たぶんINを使った感じになります。 聞きたいのは、WHERE　○○　AND　○○　AND　○○　AND　・・・のようにひたすら条件を作っていくしかないのでしょうか？ どうぞよろしくお願い致します。
PHPでMySQLテーブルロックされている一覧を取得したいですがどのようにすれば良いかご教授願います。 Web検索で調べるとロック状態はmysql_list_processesや、show processlistでも試してみましたが、思うような結果は得られませんでした。正常には動作していますが、欲しいデータが取り出せないですす。。。 単純に、現在ロックしているテーブル名（レコードロックは不要です。）を一覧で出力させることはできないのでしょうか？ PHPから実施できるやり方をご教授頂けると幸いです。 -------Test Program()--------- <?php $link = mysql_connect('localhost', 'login_id', 'login_pass'); mysql_select_db('db_name'); mysql_query('LOCK TABLES table1 WRITE'); mysql_query('INSERT INTO table1 SET field1 = "test", field2 = "1"'); //$result = mysql_list_processes($link);　以下のSQL文とも入れ替えて試しました。 $result = mysql_query('show processlist'); while ($row = mysql_fetch_assoc($result)){ printf("%s %s %s %s %s %s %s %s\n", $row["Id"], $row["User"], $row["Host"], $row["db"], $row["Command"], $row["Time"] , $row["State"], $row["Info"]); } mysql_free_result($result); mysql_query('UNLOCK TABLES'); ?>
こんにちは、ちょっと複雑なSQLの結合で困っています。 次のような名簿テーブルがあります。 ID, Name, IsMarried 1, 田中, True 2, 鈴木, True 3, 高橋, False 4, 中村, True 「IsMarried」は結婚しているかどうかを示しています。 そして、次のような属性テーブルがあります。 ID, ParentID, Type, Value 1, 1, 1, 55kg 2, 1, 2, 170cm 3, 1, 3, AB型 4, 2, 1, 52kg 5, 2, 2, 165cm 6, 3, 3, B型 7, 4, 1, 45kg 8, 4, 2, 180cm ParentIDは、名簿テーブルのIDに対応しています。 Typeは、1が体重、2が身長、3が血液型です。 Valueに実際の値が入っています。 ここで、「既婚者」を全員抽出して、"登録されている場合は"その血液型を表示するSQLを書きたいのですが、うまく行きません。どうしたらよいでしょうか？ 結果は次のようになります。 ID, Name, BllodType 1, 田中, AB型 2, 鈴木, null 4, 中村, null Select 名簿.ID, 名簿.Name, 属性.Value from 名簿 [Inner/Left] Join 属性 on 名簿.ID = 属性.ParentID Where 名簿.IsMarried = True AND 属性.Type = 3 このようにすると、血液型が登録されている田中さんしか表示されません。 条件指定を外すと体重や身長も表示されます。 ExcelのVBAからADODBでAccessのmdbファイルにアクセスしています。 Windows 7 64bit、Office 2007です。
SQL文で２つのSELCT文の結果を繋げる方法はありますでしょうか。 Left Join でもと思ったのですが、片側にしかないのも、１レコードとして出力したいです。 テーブルの例と出力の理想は以下です。 また、上記の応用でこれを４テーブル(SELECT文)を繋げて、下記例で言うと、日付と商品コードがキーで、どのテーブルに存在しても、結果を１行で返せるでしょうか。 【テーブル１(SELECT文１)】 Ｆ_仕入 伝票日付　商品コード　仕入金額 2014/07/01　101　　　　　10,000 2014/07/02　102　　　　　15,000 2014/07/05 104 20,000 【テーブル2(SELECT文2)】 Ｆ_売上 伝票日付　商品コード　売上金額 2014/07/01　101　　　　　15,000 2014/07/02　102　　　　　25,000 2014/07/03 103 13,000 上記２つのSELECT結果 伝票日付　 商品コード　仕入金額　売上金額 2014/07/01 101 10,000 15,000 2014/07/02 102 15000 25,000 2014/07/03 103 13,000 2014/07/05 104 20,000 よろしくお願いします。
続けての質問で失礼します。 特定のカラムの前の行を加算していくということは可能でしょうか？ 【カラムA】を元に【カラムB】のような結果を取りたいと考えています。 回答、宜しくお願いします。 【カラムA】 0 1 3 6 7 【カラムB】 0 1 4 10 17
テーブルの結合についてお聞きしたいことがあります。 カラム「KEY」を結合条件に テーブルA、B、Cを結合して【取りたい結果】のようなデータを取りたいと思っています。 しかし、テーブルAにBとCをLEFT JOINを結合した所、 【取得された結果】のデータが取得されました。 どのような結合をしたら期待通りの結果が得られるのでしょうか？ 回答宜しくお願いします。 【取得された結果】 key dataA dataB dataC ------------------------------------------------- 1 A-1 B-1 C-1 A-1 B-1 C-2 A-1 B-1 C-3 2 A-2 3 A-3 【取りたい結果】 key dataA dataB dataC ------------------------------------------------- 1 A-1 B-1 C-1 A-1 C-2 A-1 C-3 2 A-2 3 A-3 【テーブルA】 key dataA --------------------- 1 A-1 2 A-2 3 A-3 【テーブルB】 key dataB --------------------- 1 B-1 【テーブルC】 key dataC --------------------- 1 C-1 1 C-2 1 C-3
phpMyAdminをロリポップで使っていて、データベースに入ってる３つの情報（140ほどの行があります）だけを３００列分それぞれ変えたいのですが、SQLから直接変えてたのでは日がくれてしまいます。↓こんな感じ UPDATE items SET data1='2014-07-17', data2='9800', data3='-2.9' WHERE data4=5663; ↑これを３００個それぞれ書く。 なのでExcelのファイルを直接読み込むことができるような機能があれば教えていただくて質問させていただきました！ よろしくおねがいします！
MySQLでSQLを書いている初心者です。 ある会社には卸売部門と小売部門があり、同一の商品を扱っています。 それぞれの売上明細は　tbl_sales と tbl_retailsales で別になっています。 商品別の2つの部門の売上数量を１行で表現したいと考えています。 下のような感じです。 商品ID　商品名　卸売　小売 ========================= 00001　　aaaa　　100　　10　　 00002　　bbbb　　200　　13　　 00003　　cccc　　300　　15　　 2つのSQLをUNIONでつなげてみましたが同一行に「卸売」「小売」が並んでくれません。 SELECT goodsId, goodsName, sum(quantity) FROM tbl_sales WHERE salesDate BETWEEN '2014-06-01' AND '2014-06-30' GROUP BY goodsId UNION SELECT goodsId, goodsName, sum(quantity) FROM tbl_retailsales WHERE retailSalesDate BETWEEN '2014-06-01' AND '2014-06-30' GROUP BY goodsId どのようにSQLを組み立てたらいいでしょうか。 教えて下さい。 よろしくお願いいたします。
お世話になります。 以前質問させていただいたのですがごちゃごちゃになってしまったので項目など見直してもっと単純な作りにしたいと思います。 MySQLを使ったWEBアプリを作っているのですが、特にこだわりのcheckboxと地域のcheckboxで分けてフォームからPHPのプログラムで受けて展開させる方法がわかりません。 どなたかご教授いただけたらと思っております。 テーブルに関しては賛否両論ですが、まずは３つでやってみたいと思います。 １つのほうが簡単そうなのですが、せっかく作ったので。 SQL文の間違いなのはわかっているのですがどうしてもわかりません。 何卒よろしくお願い致します。 下記のようなフォームにしたいと思っております。 <h1>マンション物件の条件検索</h1> <form name="search_form" action="mansion.php" method="post" > <input type="hidden" name="cmd" value="search" /> <table> <tr> <th>価格帯</th> <td> <select name="price_min"> <option value="1" selected="selected">下限なし</option> <option value="10000000">1000万</option> <option value="15000000">1500万</option> 略 </select> ～ <select name="price_max"> <option value="999999999999" selected="selected">上限なし</option> <option value="10000000">1000万</option> 略 </select> </td> </tr> <tr> <th>愛知県 - 名古屋市</th> <td> <td> <input type="checkbox" name="chiiki_id[]" value="1" <?php if( $_REQUEST["chiiki_id"] == "1" ){ print( 'checked' ); } ?>/> 中村区 <input type="checkbox" name="chiiki_id[]" value="2" <?php if( $_REQUEST["chiiki_id"] == "2" ){ print( 'checked' ); } ?>/> 西区 略 </tr> <tr> <th>愛知県 - その他の地域</th> <td> <input type="checkbox" name="chiiki_id[]" value="1" <?php if( $_REQUEST["chiiki_id"] == "1" ){ print( 'checked' ); } ?>/> 尾張 <input type="checkbox" name="chiiki_id[]" value="2" <?php if( $_REQUEST["chiiki_id"] == "2" ){ print( 'checked' ); } ?>/> 三河 </td> </tr> <th>こだわり条件</th> <td> <input type="checkbox" name="kid[]" value="1" <?php if( $_REQUEST["kid"] == "1" ){ print( 'checked' ); } ?>/> 新築 <input type="checkbox" name="kid[]" value="2" <?php if( $_REQUEST["kid"] == "2" ){ print( 'checked' ); } ?>/> 南向き <input type="checkbox" name="kid[]" value="3" <?php if( $_REQUEST["kid"] == "3" ){ print( 'checked' ); } ?>/> セキュリティ充実 </td> </tr> </table> <input type="submit" value="検索" class="Btn-gray button"> </form> <p></p> <?php //初期設定 //username,$password,$dbnameは適当に if( $_REQUEST["cmd"] == "search" ){ $dsn = 'mysql:host=localhost;dbname=fudousan'; $username = 'xxxxx'; $password = 'xxxxxxx'; $data=array(); $sql = "SELECT t1.* FROM bukken as t1 "; $flag=true; //kid絞り込み if(isset($_REQUEST["kid"]) and is_array($_REQUEST["kid"])){ $sql.="INNER JOIN (SELECT DISTINCT fid FROM fdou_kodawari WHERE kid in ("; $sql.=implode(",",array_fill(0,count($_REQUEST["kid"]), '?')); $sql.=")) as t2 ON t1.id=t2.fid "; $data=array_merge($data,$_REQUEST["kid"]); $flag=false; } //WHERE句作成 $sql.= "WHERE 1 "; //名古屋の地域checkbox $sql = "SELECT t1.* FROM bukken as t1 "; if(isset($_REQUEST["chiiki_id"]) and is_array($_REQUEST["chiiki_id"])){ $sql.="INNER JOIN (SELECT DISTINCT chiid FROM chiiki WHERE chiiki_id in ("; $sql.=implode(",",array_fill(0,count($_REQUEST["chiiki_id"]), '?')); $sql.=")) as t2 ON t1.id=t2.chiid "; $data=array_merge($data,$_REQUEST["chiiki_id"]); $flag=false; } //WHERE句作成 $sql.= "WHERE 1 "; //価格絞り込み if(isset($_REQUEST["price_min"]) and $_REQUEST["price_min"]!==""){ $price_min=str_replace(",","",$_REQUEST["price_min"]); }else{ $price_min=0; } if(isset($_REQUEST["price_max"]) and $_REQUEST["price_max"]!==""){ $price_max=str_replace(",","",$_REQUEST["price_max"]); }else{ $price_max=100000000; } if(isset($_REQUEST["price_min"]) or isset($_REQUEST["price_max"])){ $sql.="AND price_min BETWEEN ? AND ? "; array_push($data,$price_min,$price_max); $flag=false; } //実行 $pdo = new PDO($dsn,$username,$password); $stmt = $pdo->prepare($sql); $stmt->execute($data); $rows=array( 以下省略 使っている３つのテーブルです。 bukken id、 bukken_name、 address 、price_min、 price_max、 station 1 名駅MID 愛知県名古屋市中村区 40770000、 55100000 名古屋駅 2 プレサン浄心 愛知県名古屋市西区 30800000、 40001000 浄心駅 3 アネシア八事 愛知県名古屋市昭和区50000000、 62510000 八事日赤 4 アメニ港明 愛知県名古屋市港区 25000000、 35000000 港区役所駅 5 ユーハウ上飯田 愛知県名古屋市北区 32000000、 43330000 上飯田駅 6 ローレル葵 愛知県名古屋市東区 30000000、 46000000 高岳駅 7 ライオンズ上小田井 愛知県名古屋市西区 35000000、 55000000 上小田井駅 8 ポレスターセントラル名西 愛知県名古屋市西区 28000000、 38000000 浄心駅 chiikiテーブル chiid chiiki_id 1 1 2 2 3 3 4 4 5 15 6 6 7 2 fudou_kodawariテーブル fid kid 1 1 1 2 1 3
2台のPCでSQL Serverのデータベースを別のコンピュータのSQL Serverで 復元しています。 別のWindows Server上のSQLServer2012から別のWindows Server上の SQLServer2012へバックアップファイル（yyyymmdd.bak）でリストアを しようとしております。 作業内容としては、データベース→DB選択→タスク→復元→データベースとし、 デバイスからバックアップファイルを指定しています。 データベースの復元は問題なく行え、DBへのアクセス、参照なども行えるのですが、 復元時に使用したユーザとは別のユーザのデータベースロールのアクセス権が消え てしまうのです。 SQLServerへの接続はでき、エクスプローラーには、データベースの表示はされる のですが、表示されたDBを選択をするとアクセスエラーとなります。 Windows認証で接続しているユーザです。 ユーザは同じですがドメインが異なる。 何故、消えてしまうのか。 消えないようにするにはどうしたらよいのか。 教えて下さい。 また、このような事象の説明があるサイトなどがありましたら教えて下さい。 つたない文面でわかりづらいとは思いますが、宜しくお願い致します。
お世話になります。 SQL Serever 2008 Standard イントラにてブラウザを介してDBへアクセスしております。 日時を登録するときに、yyyy/mm/dd hh:mm形式で登録させたいのですが、テーブルの該当フィールドのデータ型がdatetimeだと秒まで登録されてしまいます。 上記フォーマットでの登録は無理なのでしょうか。 ※テーブルには文字列として登録するのではなく、ちゃんと日時で登録したいところです。 ご教授の程、宜しくお願い致します。
A1は手入力D4手入力、H2は=D2&C2 担当者と週で検索して抽出する式を教えて下さい。 上手く出来なくて１行しか抽出しないんです。 　A　　　B　　C　　　　　　D　　　E　　　F　　G　　　H １担当者　沼田　週　　　　1 ２ 番号 日付週担当企業名前住所検索用 ３　17月1日1沼田a高橋土浦沼田1 ４　27月2日1佐藤a山田阿見佐藤1 ５　37月2日1沼田r沖田水戸沼田1 ６ 4 7月7日　 1 沼田　c 斎藤 土浦 沼田1 ７　5　 7月9日2佐藤h鈴木牛久佐藤2 ８　67月14日3佐藤d河合土浦佐藤3 ９　77月15日3高橋e吉田阿見高橋3 10　87月20日4高橋e木田水戸高橋4 11 97月4日1沼田g飯田牛久沼田1 上記の表から１週目だったら、１週目の担当者のデータをシート２の表に抽出 週２だったら２週目の担当者データを抽出 A1・D1は手入力 A3は=IF(COUNTIF(Sheet1!D$2:D$1000,B$1)=0,"",MATCH($B$1&$D$1,Sheet1!$H$2:$H$1000,0)) シート２ 　　　 A 　　B　 　C 　D 　E 　F 　G １ 　担当 沼田 週 1 ２ 　番号 日付 　週 　担当　 企業 　名前 　　住所 ３　　1　 7月1日 　1 　沼田 　　a 　　 会田 　　牛久 ４　　4 　7月2日　 1　 沼田　　 r　　　沖田　　 水戸 ５　　6 　7月7日　 1　 沼田　　 c　　　斎藤　　土浦　 ６　　9　 7月4日　 1 　沼田 　　g　　　飯田　　牛久 上記の様にシート２に表示したいんです。 細かく教えて下さい。何度やっても１行目のデータしか抽出しないんです。 A3=IF(COUNTIF(Sheet1!D$2:D$1000,B$1)=0,"",MATCH($B$1&$D$1,Sheet1!$H$2:$H$1000,0)) B3=IF($A3="","",IF(VLOOKUP($A3,Sheet1!$A$2:$H$1000,COLUMN(B1),0)="","",VLOOKUP($A3,Sheet1!$A$2:$H$1000,COLUMN(B1),0))) A4の２行目以降1になってしまって同じ物しか出ないんです。 Aの番号の抽出方法の式を教えて下さい。
お世話になります。 以下のようなテーブルがあります。 区分　コード AA　　I001 AA　　I002 AA　　I003 BB　　I004 BB　　I005 　・　　　・ 　・　　　・ FF　　I012 例えば、フォーム上で数量「3」と入力され、「出力」ボタンが押されたときに、 上記のテーブルのレコードが3セットあるテーブルを作成したいと考えて おります。 区分　コード AA　　I001 AA　　I002 　・　　　・ 　・　　　・ FF　　I012 AA　　I001 AA　　I002 　・　　　・ 　・　　　・ FF　　I012 AA　　I001 AA　　I002 　・　　　・ 　・　　　・ FF　　I012 となるイメージです。 まっさらのテーブルを作成し、ループで回しつつレコードを追加していけば よいかと思うのですが、1回のテーブル作成クエリの実行で作成することは 可能でしょうか。 ※上記テーブルが出来たら、そのテーブルをソースとしたレポートでラベルを 　　印刷させます。 ご教授の程、宜しくお願い致します。
あるテーブルAがあり、そこにINT型の列bと列cがあるとします。 |b|c| |1|2| |1|3| とデータが格納されているとき、ここから[1,2,3]という風に、重複のない結合結果を出すにはどういったSQLを書けば良いでしょうか。 2列だとDISTINCTも使えず、簡単そうなのに自分ではできませんでした。出力後に結合するのでは色々と不都合なことがあったため、この出力が一発で出せれば便利だと思い質問させていただきました。ご回答よろしくお願いいたします。
いつも大変お世話になっております、ありがとうございます。 データベースについての質問です。 大変初歩的な質問ですが何卒よろしくお願い致します。 不動産物件の絞り込み検索システムを作成したいのですが、テーブルの作成方法がわかりません。 不動産の条件検索フォーム 物件種別　　チェックボックス　　３種類 価格帯　　　プルダウン 所在地　　　チェックボックス 最寄り駅　　テキスト 間取り　　　チェックボックス　　　　４種類 こだわり条件　　チェックボックス　　１６種類 とする場合、データベース内でいくつテーブルを作成すればしっくりくるのでしょうか？ どうかよろしくお願い致します。
お世話になります。 以下の問題に直面し困っております。 よろしくご教授願います。 元々MS SQL Server 2000 にて使用していたテーブル（4千数百万行）を ほぼ同じマシンスペックの筐体にインストールした SQL Server　2008R2 に移行したところ、単純なSELECT文を実行しただけでCPU使用率が100%近くまで上昇してしてしまいます。（2000では20～30%） インデックスが移行されていないのかと思い確認しましたが、全く同じ状態でした。 何かサーバ、OSの設定等で解決できるものでしょうか？
AS400(System i)で動作している基幹システムを管理している者です。 WindowsServer上のphpで動作するWebアプリを使って、AS400のデータを照会し、PCにDownloadする処理を作ろうと思っているのですが、AS400へのアクセスができずに困っています。 具体的には Fatal error: Call to undefined function db2_connect() in C:\Inetpub\wwwroot\........php on line 3 というようなエラーです。 JDBCドライバはjt400.jaｒを同じWindowsServer上に置き、環境変数に set CLASSPATH=%CLASSPATH%;(jt400.jarの置いてあるフォルダ） と設定してあります。 あるいはWindowsServerのphpではdb2関数は何等かの方法で追加インストールする必要があるのでしょうか？ IBMに問い合わせても、JDBCドライバに関しては自社製品でないせいもあり、全く教えてくれませんので、経験者の方のお知恵を拝借したくお願い致します。
こんにちは PHPからODBC経由で.mdbファイルを操作しようとして躓いています。 OSはWindows 7 64bitで、インストールしているMS Officeは32ビット (Office 2007)ですが、MS Accessはインストールしていません(先日、MS Accessを含むOffice 最新版の試用版をインストールしたのち削除しました)。 「C:\Windows\SysWOW64」以下の「odbcad32.exe」を管理者権限で開いてシステムDSNにドライバを設定してPHPから接続を試みたのですが、エラー「IM014」が返ってきました。調べると「指定されたDNSには、ドライバーとアプリケーションとのアーキテクチャの不一致が含まれています」ということだそうです。 「C:\Windows\System32」以下の「odbcad32.exe」でドライバを設定すればよいのかと思いましたが、管理者権限で開いても指定可能なドライバが表示されません。 どういった設定をすべきでしょうか？
sqlserver2008,2012を使用しています。 あるフィールドの値が、"999-999"の書式になっているかチェックを行いたいのですが、 SQLで簡単にチェックできますか？ 文字列（nvarchar）エリアで、３桁の数値＋'-'＋３桁の数値　以外のデータを抽出したいと思っております。 どなたかご教授お願いします。
SQL injectionに対する脆弱性発見方法について３つ質問をさせていただきます。 質問１　 SQL ' と入力した場合に、エラーとなると脆弱性ありと判断されるそうですが、理由は何でしょうか？ 質問２ 「検索キー」と「検索キー'and'a'='a 」を比較して、「検索キー」のみと同じ結果になれば、脆弱性ありと判断されるそうですが、理由は何でしょうか？ 質問３ 「検索キー（数値）」と「検索キー　and 1=1 」を比較して、「検索キー(数値）」のみと同じ結果になれば、脆弱性ありと判断されるそうですが、理由は何でしょうか？
ｍｙｓｑｌの参照の負荷の問題解決はスレーブが有効だがｍｙｓｑｌの登録・更新の負荷の問題解決は何が有効なのでしょうか
こんにちは VBAのADODB.Streamなのですが、SQLでテーブルをつなげる方法がわかりません。 どのようなSELECT文を書けば良いのか教えてください。 次のような2つのテーブルがあります。 Persons Relations Personsには、ID、人名、男性かどうか(夫かどうか)が並んでいます。 ID, pName, IsHusband 1, 鈴木太郎, True 2, 鈴木花子, False 3, 山田太郎, True 4, 斉藤花子, False 5, 斉藤太郎, True 6, 山田花子, False Relationsには、人物の婚姻関係が記されています。 ID, yourID, spouseID 1, 1, 2 2, 2, 1 3, 6, 3 4, 5, 4 5, 3, 6 6, 4, 5 (1つめのレコードは、yourID=1：鈴木太郎のspouseID(配偶者ID)=2：鈴木花子といった具合です。一番左のIDはこのテーブル以外で使っていません。) これを次のような表として取得したいと思っています。 1, 鈴木太郎, 2, 鈴木花子 3, 山田太郎, 6, 山田花子 5, 斉藤太郎, 4, 斉藤花子 今試行錯誤しているのですが、まずPersonsでIsHusbandがTrueの人を抜き出して、その人のIDを使ってRelationsからSouseIDを抜き出して・・・・で、それをやっぱりPersons内で検索・・・ とうかぜんぜんわかりません。できませんでした。 実際、Relationsの方は参照するだけで抽出しなくても良い(別にしても良いです)し、JOINするのが同じテーブル同士だし、よくわかりません。 どのように書けば良いか、教えてください。
こんにちわ カートを作っていてつまづいたのでお力かしていただきたいです。 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitio … <html xmlns="http://www.w3.org/1999/xhtml"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> <title></title> </head> <body> <?php try{ require_once('../common/common.php'); $post=sanitize($_POST); $pro_name=$post['name']; $pro_namecode=$post['namecode']; $pro_kg=$post['kg']; $pro_price=$post['price']; $pro_gazou_name=$_POST['gazou_name']; $pro_gazou_name2=$_POST['gazou_name2']; $dsn='mysql:dbname=LAA******-******;host=mysql***.phy.lolipop.lan'; $user='LAA******'; $password='********'; $dbh=new PDO($dsn,$user,$password); $pdo=new PDO("mysql:host=mysq***.phy.lolipop.lan;dbname=LAA*****-*******;charset=utf8",'LAA*****','********←パスワード'); $pdo->setAttribute(PDO::ATTR_ERRMODE,PDO::ERRMODE_EXCEPTION); 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 $sql='INSERT INTO mst_product(namecode,name,kg,price,gazou,gazou2) VALUES(?,?,?,?,?,?)'; $stmt=$dbh->prepare($sql); $data[]=$pro_namecode; $data[]=$pro_name; $data[]=$pro_kg; $data[]=$pro_price; $data[]=$pro_gazou_name; $data[]=$pro_gazou_name2; $stmt->execute($data); $dbh=null; print$pro_name; print'を追加しました。<br/>'; } catch(Exception $e) { print'ただいま障害により大変ご迷惑をおかけします。<br/>'; exit(); } ?> <a href="pro_list.php">戻る</a> </body> </html> 一応エラーもでないで最後のprint$pro_name;print'を追加しました。<br/>'; までいくんですがデータベースを見ても商品は追加されていません。 エラーもでないで最後まで行くということは一応接続は出来ているということ なんでしょうか？ どうしたらきちんと商品登録でしますか？ レンタルサーバーはロりポップです。 必要かは分からないんですが phpバージョンは５．３ データベースバージョン５．６ よろしくおねがいします。
独学でPHPを勉強しています。 一つ分からない事があったので詳しい方にお聞きしたいです。 DATE型同士で日数を算出し、日数が短い順番に並べたいと思っています。 テーブルは下記のようにしました。 テーブル名：office name(VARCHAR型)｜in(DATE型)｜out(DATE型) 佐藤｜2010-11-10｜2010-12-13 田中｜2010-10-30｜2012-01-30 水谷｜2009-09-20｜2011-03-20 上記のテーブルでいうと次のようなランキングにしたいです。 佐藤　33日 田中　1年92日 水谷　1年197日 このようにDATE型同士で日数を算出する場合、どのようなSQL文になるでしょうか？ ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
以下のような形でDBに登録されています。 iddatecost 12914043132006000 7614043132005000 12914042268004000 54140422680075000 129140431320055000 id 129のものをすべて抽出したいのですが、もしdateが同じだった場合は、同じdateの中でのcostの最大値の行だけ抽出したいです。 このようなことは可能でしょうか。 上記の例でいうと、 12914042268004000 129140431320055000 が取得できればOKです。 あまりmySQLは詳しくないのでselect文でそのまま頂けると嬉しいです。 よろしくお願い致します。
SQL Server 2008環境です。 文字列の末尾の空白を一括して削除したくて、以下のようなクエリを書きました。 UPDATE TEST_TABLE SET NAME = REPLACE(RTRIM(REPLACE(StoreBranchName, '　', ' ')), ' ', '　') 全角スペースを一度半角スペースにして、RTRIMをかけた後、最後に 半角スペースを全角に直すというものです。 しかし、これだと、元々半角スペースが入っていた場合、そっちまで全角スペースに なってしまうため悩んでおります。 うまいやり方を教えていただけないでしょうか。 宜しくお願いします。
3ヶ月の集計結果を、QWERTYのPKとかぶらないものだけインサートします。 ただし、PKとかぶったものの中でも、QWERTYのCNT1が0のレコードについては、 QWERTYのCNT1のみ集計結果をアップデートしようとしています。 しかし、「~」部分の「ON DUPLICATE KEY UPDATE・・・」を挿入した際に、 エラー(ERROR 1111 (HY000): Invalid use of group function)となってしまいます。 ＜SQL文＞ INSERT IGNORE INTO QWERTY( PHOGE, J, MHOGE, SHOGE, CNT1, CNT2, CNT3, NDATE, YMO ) select TEST.PHOGE, TEST.J, 'ABCD', TEST.SHOGE, sum(TEST.m1cnt) AS M1, sum(TEST.m2cnt) AS M2, sum(TEST.m3cnt) AS M3, '2014-07-01' , TEST.YMO from ( select PHOGE, J, SHOGE, SUM(OD_CNT) AS m1cnt, 0 AS m2cnt, 0 AS m3cnt, YMO from HUJIKO WHERE CARD = '1' AND (KHOGE = '1' OR KHOGE = '9') AND (ODATE LIKE'2014-07%') group by PHOGE, J, YMO UNION select PHOGE, J, SHOGE, 0 AS m1cnt, SUM(OD_CNT) AS m2cnt, 0 AS m3cnt, YMO from HUJIKO WHERE CARD = '1' AND (KHOGE = '1' OR KHOGE = '9') AND (ODATE LIKE'2014-08%') group by PHOGE, J, YMO UNION select PHOGE, J, SHOGE, 0 AS m1cnt, 0 AS m3cnt, SUM(OD_CNT) AS m3cnt, YMO from HUJIKO WHERE CARD = '1' AND (KHOGE = '1' OR KHOGE = '9') AND (ODATE LIKE'2014-09%') group by PHOGE, J, YMO ) AS TEST GROUP BY TEST.PHOGE, TEST.YMO, TEST.J ON DUPLICATE KEY UPDATE CNT1=if(CNT1=0, TEST.M1 , CNT1); ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 「ON DUPLICATE KEY UPDATE 」で実現不可能であれば、 他の方法を取りたいのですが、 なるべく一つのSQL文で実現可能な方法をとりたいと考えています。 ご教示の程よろしくお願いいたします。
MySQLのカラム名に日本語を使うか、英数字を使うかで迷っています。英数が無難だと思うのですが、日本語の方が簡潔で分かりやすい命名ができるので、もし大した問題が無ければ日本語を使おうと考えています。 そこで3点お伺いしたく存じます。 1. 日本の企業はMySQLのカラム名に日本語を使っているケースが多いのか、それとも英数字のみのケースが多いのか、最近の傾向をご教示頂けますか。統計は無いと思いますので、体感や自社ルールの場合等でも結構です。 2. 日本語を使うことでセキュリティホールができることは考えられますか。例えば、マルチバイト文字はSQLインジェクション対策をすり抜ける・・・等。 3. 自分なら日本語と英数字のどちらを使うか。理由も添えて頂けると幸いです。 当方の開発環境は、PHP(ver. 5.5.9) + MySQL(ver. 5.6.16)です。 お手数おかけしますが、ご教示お願い致します。
PHPとMySQLでデータサイトを作成しています。 詳しい方に二点ほどお聞きしたいのですが。 テーブルは下記の通りです。データベース名はgame。 フィールドについて「issue」は結果。「h_a」はホームかビジターか。「h_score」はホーム側スコア。「a_score」はビジター側スコア。「opponent」は対戦相手です。 テーブル名：game issue(VARCHAR型)｜h_a(VARCHAR型)｜h_score(INT型)｜a_score(INT型)｜opponent(VARCHAR型) ●｜H｜8｜9｜チームB ○｜A｜2｜8｜チームC ●｜H｜4｜9｜チームD ○｜Ａ｜3｜3｜チームB 一点目。 格納したデータから自分のチームのスコアが多い順に10ほど並べたいと思っています。 問題はホームゲーム時（H）の場合はホーム側スコア（h_score）、ビジター（Ａ）の時はビジター側スコア（a_score）を適用することです。 現在は下記のようなコードしか記述していません。 $stmt = $dbh -> query("SELECT * FROM game ORDER BY () DESC LIMIT 10"); 二点目。 対戦相手ごとに勝率を計算し、勝率が高い順から10ほど並べることは可能でしょうか？ 勝率は「勝った試合数÷（勝った試合数+負けた試合数）*100」で計算。 上のデータでいうと、下記の順番です。 1 勝率100％　チームC 2 勝率50％　チームB 3 勝率0％　チームD こちらは不可能でしたら構いません。 ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
申し訳ございませんが質問させてください。 風俗サイトのスケジュールを組み込んで欲しいとお客様に頼まれています。 当方PHP/Mysqlは初心者で、本やネットで勉強中ですが、お手上げ状態です。 本日日付｜明日の日付｜明後日の日付｜・・・ と1週間の、スケジュール表示をしたいので、テーブル(id,In_time,In_time1,In_time2,out_time,out_time1,out_time2...)values(:id, :In_time, :In_time1, :In_time2, :out_time, :out_time1, :out_time2... )で作成して…とここで思考が止まってしまいます。 例えば日付はphpで出力？　mysqlに格納して 出力? そもそも日付はSQL？PHP?どちらで取得するものなのか？ どうやって朝5時に日付と時間を自動で更新するのかが、まったくわかりません。 お手数ではありますが、誰かご教授いただける人がいたら教えてください。 皆様お忙しいとは思いますが宜しくお願い致します。
お世話になっております。 現在、oracleの11gの環境に対して object browser10を使用して環境構築を行っています。 DMPファイルをエクスポートし別環境に対して出力したデータを投入しているのですが この際にインポートの処理を中止したいとき、処理を中止するような方法等はあるのでしょうか？ object browser のプロセスを終了してもバックグラウンドで処理が続けられていますので 処理を中止する方法がありましたらご教授のほどお願いします。 なお、11gの環境にはそのほかにEnterprise Managerが導入されています。 以上、よろしくお願いします。
MysqlにURLを登録したあと、それをXMLで落として、使用したいと考えています。 MysqlにURLを登録する場合、テーブルに項目名を「hpurl」と設けたとして、データ型・照合順序はどうすればいいのでしょうか。 （入力はDBに直接、手入力、またはCSVからインポートする予定です） データ型は「varchar(255)」・照合順序は「ascii_general_ci」でいいのでしょうか。 また、そのほか留意することがあるでしょうか。 ご教示いただきたく宜しくお願い致します。
現在、アクセス2010を勉強中の超初心者です。 アクセスを用いて、前期と当期の商品売上数量比較表（得意先ごとの）を作成できないか考えております。 　■さっそくですが、以下の４つのテーブルがあったと仮定します。 テーブル(1)（商品マスター）　　　　　　　　　　　テーブル(2)（得意先マスター） 品コード　|　品名　　　　　　　　　　　　　　　　　　店コード　|　 店名 　　1　　　 |　○○　　　　　　　　　　　　　　　　　　 　　　　A　 |　　あか 　　2　　　 |　××　　　　　　　　　　　　　　　　　　 　　　　B　 |　　いき 　　3　　　 |　△△　　　　　　　　　　　　　　　　　　 　　　　C　 |　　うす テーブル(3)（前期売上データ）　　　　　　　　　　テーブル(4)（当期売上データ） 店コード　|　品コード　|　売上数量　　　　　　　　　店コード　|　品コード　|　売上数量 　A 　　　 | 　　1　　 　|　 10　　　　　　　　 　　 　　 A 　　　　 | 　　3 　　 　|　 20　　　 　A　 　　 | 　　 3 　　 　|　 15　　　　　　　　　 　　 A　　 　　 | 　　 4 　　 　|　 25　　　 　B　 　　 | 　　 1 　　 　|　 17　　　　　 　　　　 　　 B　　　　 | 　　 2　　 　|　 27　　　 　：　 　　 | 　　 ：　　 　|　 ：　　　　　 　　　　 　　　 ：　　　　 | 　　 ： 　　 　|　 ：　　　 　■以下のようなデータ抽出できないかを検討しています。 店コード　|　品コード　|　前期売上数量　|　当期売上数量 　　A　　　 | 　　 1　　 　 | 　　　 10 　　　 　 | 　　　 0 　　A　　　 | 　　 3 　　 　 | 　　　 15 　　　 　 | 　　　 20 　　A　　　 | 　　4 　　 　 | 　　　 0 　　　 　 | 　　　 25 　◆自身で検討してみましたが、「前期に売上実績があるが、当期に売上実績がないケース」、及び「その逆のケース」についてうまく抽出できません。（上記例で言いますと、A店に対する売上で品コード1　と　品コード３　の商品売上数量比較ができませんでした。） 　解決方法わかる方、ご教授のほどよろしくお願い致します。
COUNTによる集計と同時に、パーセンテージを求めたいのですが、どのようにSQLを書けばよいのでしょうか？(MySQL4.1) たとえば、 テーブル名：test、レコード数：100件、カラム数: 2 date product 2014-05-01 メガネ 2014-05-01 鉛筆 2014-05-02 メガネ 2014-05-03 メガネ 2014-05-05 鉛筆 ・・・ ・・ ・ 2014-06-30 鉛筆 ・ ・ という2014年5月1日～6月30日のデータを、 select DATE_FORMAT(date, '%Y-%m'), product, count(product) from test group by product, DATE_FORMAT(date, '%Y-%m'); とすると、以下のようにグループ（月、製品）毎に個数が表示されると思います。 2014-05　メガネ 30 2014-05　鉛筆　20 2014-06　メガネ 15 2014-06　鉛筆　35 それを次のように月別の割合（パーセント）を求めるにはどのようにSQLを書けばよいのでしょうか？ 2014-05　メガネ 30　60% 2014-05　鉛筆　20 40% 2014-06　メガネ 15 30% 2014-06　鉛筆　35 70% 一見、インラインビューでできそうだったのですが、月別にする段階でできなくなりました。 (月別にせずデータ全体に対してならインラインビューでパーセンテージが求められると思います。)
店舗の毎日の売り上げを、日付・販売員名・売り上げ額のテーブルで集計しています。 【テーブル例1】 date, name, price 2014-05-01,吉田,2400 2014-05-01,佐藤,1500 2014-05-02,佐藤,3000 ...(中略)... 2014-06-18,佐藤,3000 2014-06-30,吉田,1000 これを月別、販売員別の金額で次のように集計したいのですが、 【例2】 各販売員がその月に売り上げた金額の合計 2014-5 吉田　205000 2014-5 佐藤　120000 2014-6 吉田　75000 2014-6 佐藤　90000 SELECT文における"GROUP BY"の条件を、"GROUP BY date AND name"のように"AND"でつなげてもうまくいきませんでした。 もちろん、条件をひとつだけにした"GROUP BY date"　および　"GROUP BY name"では、それぞれ日付別の集計、あるいは販売員名別の集計が出ます。 【質問】 1.GROUP BYは複数の条件をつけることができないのでしょうか？ 2.どのようにすれば【例2】の集計ができますか？
Sql server 2008 r2 standard editionで、あるストアドプロシージャの実行してから一定時間処理が終わらなかった場合に自動的にそのストアドプロシージャの処理を終了させる方法はありますでしょうか。 もしご存知の方がいらっしゃいましたら教えていただければ幸いです、よろしくお願いいたします。
Visual Studio Express 2013 for Webでデータベースアプリを作成しようとしており、そのメインとなる部分として、データをエクセルのように表形式で扱いたいのですが、なかなかうまくいきません。ネットにサンプルプログラムがありそうなものですが、見つかりません。部分的なサンプルを駆使して、現在LinqDataSourceとGridViewを用いて途中までは作成しています。 欲しい機能としては、 １．データ検証ありで、データの追加、更新 ２．データの削除（確認ポップアップあり） ３．各データでフィルタリング表示（起動時は全データ表示。フィルタリングを外せば全データ表示できる） ４．データ読み込み後、他者が更新した１行（１レコード）を更新しようとしたら、その旨表示して更新しない。 ５．エクセルファイルにエクスポートもできれば嬉しい。 何かよいサンプルプログラムはないでしょうか。
データが多すぎるので書き込めなくてすみません。 ＳＱＬ文がよくわかりません。主にOracleでやってます。 表の名前　hyou1-社員のマスタ　社員コード、名前、職種、給与等級 hyou2-販売のマスタ　顧客コード、商品コード、販売数 「」は抽出例です。 （１）hyou１において給与等級が多い人の社員コードを検出　職種順に表示をする。「社員コード、職種」 （２）hyou１において給与等級平均より給与等級が多い人の職種を検索「職種」 （３）hyou１において給与等級平均より給与等級が多い人の職種毎の人数および平均給与等級の検索「職種、人数、平均給与等級」 （４）hyou１において給与等級が１または３または５である人を検索「全列」 （５）hyou2において、顧客コードが'1992’の人が購入したデータを検索「顧客コード、商品コード」 （６）hyou2において、顧客コードが’１９９２’である人が購入したデータを検索「顧客コード、氏名、商品コード」 （７）hyou２において、顧客名（氏名）’山田太郎’さんが購入したデータを検索「顧客コード、氏名、商品コード」 （８）hyou2において顧客コードが’１９９２’である人が購入した商品と同じ商品を購入した人を検索｛全列」 （９）hyou2において販売数の平均「販売数平均」 （１０）hyou2において販売数の平均以下の購入者を検索「全列」
accessというよりSQLについてなのかと思いますが、教えていただけないでしょうか。 重複するIDがあり、1件を除いて他のデータを削除してデータを抽出したいです。 抽出条件としては、[年月日]カラムがあるため、日付が一番直近のものを残したいです。 　※こちらも重複しております。 また、[フィルタ]カラムが「2」のレコードのみを対象としたいと思っています。 accessの場合、重複クエリを用いるのかと思い、クエリウィザードから作成しましたが 一意とはなりませんでした。 SELECT テーブル１.[共通ID], テーブル１.[連番], テーブル１.[郵便番号], テーブル１.[住所], テーブル１.[担当者名], テーブル１.[年月日], テーブル１.[フィルタ] FROM テーブル１ WHERE (((テーブル１.[共通ID]) In (SELECT [共通ID] FROM [テーブル１] As Tmp GROUP BY [共通ID] HAVING Count(*)>1 )) AND ((テーブル１.[フィルタ])=2)) ORDER BY テーブル１.[共通ID], テーブル１.[年月日] DESC; distinctも使ってみましたがうまくできませんでした。 何が原因でしょうか。 申し訳ありませんがご教示いただきたくお願いいたします。
<th>物件種別</th> <td> <input type="checkbox" name="kid[]" value="1" <?php if( $_REQUEST["kid"] == "1" ){ print( 'checked' ); } ?>/> 温泉 <input type="checkbox" name="kid[]" value="2" <?php if( $_REQUEST["kid"] == "2" ){ print( 'checked' ); } ?>/> キャンペーン <input type="checkbox" name="kid[]" value="3" <?php if( $_REQUEST["kid"] == "3" ){ print( 'checked' ); } ?>/> イベント <input type="checkbox" name="kid[]" value="4" <?php if( $_REQUEST["kid"] == "4" ){ print( 'checked' ); } ?>/> 特別室<br /> <input type="checkbox" name="kid[]" value="5" <?php if( $_REQUEST["kid"] == "5" ){ print( 'checked' ); } ?>/> 和室 <input type="checkbox" name="kid[]" value="6" <?php if( $_REQUEST["kid"] == "6" ){ print( 'checked' ); } ?>/> 喫煙室</td> </tr> <tr> //まずこのSQL文でt_hotelsのテーブルとt_hotel_kodawariを結合します $sql="SELECT t_hotels.id,t_hotels.hotel_name,t_hotels.price,t_hotels.address,t_hotel_kodawari.id,t_hotel_kodawari.kid FROM t_hotels JOIN t_hotel_kodawari USING(id) WHERE 1 "; テーブル t_hotel_kodawari id kid ------------ 1 1 1 2 1 4 2 1 2 5 3 2 4 3 4 6 5 2 5 3 6 1 7 2 テーブルt_hotels id hotel_name price address ----------------------------------------------------- 1 Aホテル 10000 栃木県・・・ 2 Bホテル 12000 栃木県・・・ 3 Cホテル 9000 千葉県・・・ 4 Dホテル 10000 千葉県・・・ 5 Eホテル 15000 愛知県・・・ 6 Fホテル 30000 東京都・・・ 7 Gホテル 40000 神奈川県・・・ テーブルt_hotels とt_hotel_kodawariをJOIN USINで結合して表示 id hotel_name price address id kid ------------------------------------------------------------------- 1 Aホテル 10000 栃木県・・・ 1 1 1 Aホテル 10000 栃木県・・・ 1 2 1 Aホテル 10000 栃木県・・・ 1 4 2 Bホテル12000 栃木県・・・ 2 1 2 Bホテル12000 栃木県・・・ 2 5 3 Cホテル 9000 千葉県・・・ 3 2 4 Dホテル 10000 千葉県・・・ 4 3 4 Dホテル 10000 千葉県・・・ 4 6 5 Eホテル 15000 愛知県・・・ 5 2 5 Eホテル 15000 愛知県・・・ 5 3 6 Fホテル 30000 東京都・・・ 6 1 7 Gホテル40000 神奈川県 7 2 $condition = array(); //仮にkid１が一つ選択されたら まず if( !empty( $_POST["kid"] )){ for($i=0; $i<count($_REQUEST["kid"]); $i++) { $tmpKey = "kid".$i; $sql .= " and kid = :".$tmpKey; $condition[$tmpKey] = $_REQUEST["kid"][$i]; var_dump($sql); } } で絞り込まれSQL文が作られ、 var_dump($sql);でSQL文を表示させると string(184) "SELECT t_hotels.id,t_hotels.hotel_name,t_hotels.price,t_hotels.address,t_hotel_kodawari.id,t_hotel_kodawari.kid FROM t_hotels JOIN t_hotel_kodawari USING(id) WHERE 1 and kid = :kid0" の結果によって、 kid１を選択するとホテルA,B,Fが表示されます。 でkidがまずandで絞り込まれます。 ですが、もう二つ目選択すると string(184) "SELECT t_hotels.id,t_hotels.hotel_name,t_hotels.price,t_hotels.address,t_hotel_kodawari.id,t_hotel_kodawari.kid FROM t_hotels JOIN t_hotel_kodawari USING(id) WHERE 1 and kid = :kid0" string(200) "SELECT t_hotels.id,t_hotels.hotel_name,t_hotels.price,t_hotels.address,t_hotel_kodawari.id,t_hotel_kodawari.kid FROM t_hotels JOIN t_hotel_kodawari USING(id)「 WHERE 1 and kid = :kid0 and kid = :kid1"」 で ------------------------------------------- 二重にand で絞られてしまい何も出てきません。希望としては二回目の選択からkidはor条件にすれば仮にkid1,kid2ホテルA,B,C,E,F,Gと両方を含む表示を実現したいのですが、 実際はSQLの表記の方法をネットや本で調べたのですが、分からない状態です。ご教授いただけたらと思います。 なお、私の希望通りの方法ではなくても実現できれば大丈夫です。 どうかよろしくお願い致します。
ＩＴパスポートの勉強をしているのですが、その中で関係データベースについて参考書やネットで検索をしてもまったく理解ができません。 下記の２点の問題についてですが、回答の解説を読んでも理解が全くできず、なぜこの答えが正しいのかがわかりません。 できるかぎり詳しく解説をして頂ければと存じます。 (1) 問）関係データベースにおいて主キーを指定する目的はどれか？ 答）主キーに指定した属性（列）で、レコード（行）を一意に識別できるようにする (2) 問）関係データベースを利用する際に、データの正規化を行う目的として、適切なものはどれか？ 答）データが重複したり、データの更新の際に矛盾が生じたりしないようにする。
こんにちは。SQLでNOT INが実行速度が遅いため、EXISTSで書き直したいのですが、思っている結果がでません。 SQLのどこが間違っているかお教え頂けませんでしょうか？ ■ ・テーブル名：R_TABLE ・フィールド:id データ： id(ユニークではない) 001 002 003 003 003 007 008 009 ■ ・テーブル名：P_Master ・フィールド:id データ： id(ユニーク) 001 002 003 ■やりたい事 R_TABLEのデータを条件によって削除したい。 条件はP_MASTERに無いR_TABLEの行を削除したいです。 ■欲しい結果 R_TABLE 001 002 003 003 003 ■書いたSQL DELETE FROM R_TABLE WHERE R_TABLE.id NOT IN (SELECT R_TABLE.id FROM R_TABLE INNER JOIN P_MASTER ON R_TABLE.id = P_MASTER.id) これは正しい結果がでました。 書きなおしたSQL DELETE FROM R_TABLE WHERE R_TABLE.id WHERE NOT EXISTS (SELECT R_TABLE.id FROM R_TABLE INNER JOIN P_MASTER ON R_TABLE.id = P_MASTER.id) 結果はR_TABLEから何も消されていませんでした。 どこを修正すれば正しい結果が得られるでしょうか？ 副問い合わせで、R_TABLEとP_MASTERのINNER JOINの結果が得られ、R_TABLEからINNER JOINに含まれないデータ削除しろという命令だと思っていたのですが違うみたいです。 どこを修正すればよろしいでしょうか？ よろしくお願いします。
SQLserver 2005 Expressを使用してます。 csvをBULKINSERTでインポートする際にcsvの最終行に終了コードのようなデータが 入っていてインポートに失敗します。 BULKINSERTのWITHオプションのLASTROWの引数に変数を使用して 日々行数の変化するcsvの最終行-1の値をセットしたいのですが構文エラーに なります。どのように記述したらいいのでしょうか？ 試した事は test.csv 1,あ,4200 2,い,5300 ．　←　何かのデータ CREATE PROCEDURE [dbo].[test1] AS bulk insert test_table from 'C:\test.csv' with (firstrow = 1,formatfile = 'C:\Import_Fmt.xml') で実行するとエラー「一括読み込み: データ ファイルで予期しないファイルの終了が検出されました。」になるので、最終行の「．」が原因かと思い。 ALTER PROCEDURE [dbo].[test1] AS bulk insert test_table from 'C:\test.csv' with (firstrow = 1,lastrow = 2,formatfile = 'C:\Import_Fmt.xml') で実行するとエラー無くインポートされました。 実際のcsvは行数10000件はあり日々増減しますので毎回手作業で数えることは難しいです。 そこで一度仮テーブルを作り改行コードまでを一つのカラムにインポートして 行数をカウントし、変数にセットしてLASTROWの引数に渡そうとして ALTER PROCEDURE [dbo].[test1] AS declare @maxseq as int drop table test2 create table test2(F1 varchar(max)) bulk insert test2 from 'C:\test.csv' with (firstrow = 1,formatfile = 'C:\ImportOrg_Fmt2.xml') set @maxseq = (select count([F1]) from test2) --ここにreturn @maxseqを記述して以降を削除して実行し、ストアドを実行したら 　　　　　 --取り込んだcsvの行数が表示されました。 bulk insert test_table from 'C:\data\test.csv' with (firstrow = 1,lastrow = @maxseq -1 ,formatfile = 'C:\ImportOrg_Fmt.xml') と記述して実行すると メッセージ 102、レベル 15、状態 1、プロシージャ test1、行 23 '@maxdeq' 付近に不適切な構文があります。 となりました。 どのように記述したら構文エラーにならずに実行できるかご回答をよろしくお願いします。
Access初心者です。 Access2010の学習をしています。 主キーと外部キーで関連付けられた フィールドをクエリで抽出する場合、 デザイングリッドにドラッグするフィールドは、 どちらのフィールドを選べばよいのでしょうか？ ---- 「T担当者マスタ」と「T得意先マスタ」をもとに 「Q得意先マスタ」を作成したい場合です・・・ 「T担当者マスタ」のフィールド 担当者コード（主キー） 担当者名 「T得意先マスタ」のフィールド 得意先コード（主キー） 得意先名 フリガナ 〒 住所 TEL 担当者コード（外部キー） 担当者名 デザイングリッドにドラッグするフィールド 得意先コード 得意先名 フリガナ 〒 住所 TEL 担当者コード（※主キーのフィールドを選ぶのは不正解ですか？） 担当者名 ----- 担当者コードは元となるテーブルの両方に存在する わけですが、どんな理由でどちらを選ぶのか 理解できません。 テキストの問題なのに情けないです・・ ご教授ください。
phpmyadminでデータベースを作成しているのですが、外部キーを相互に参照し合っているテーブルがあります。 一方のテーブルにデータを入れようとすると、参照先の外部キーにそのデータはありません、とエラーが出るし、もう一方のテーブルにデータを入れようとしても同じエラーが出ます。 調べたところ、遅延制約というのがあるようですが、それをphpmyadminで設定する方法が分かりません。 sql文を直接入力するしかないのでしょうか。 設定の方法や、他の方法をご存知の方はぜひご教授ください。
「WP+さくらインターネット」の組み合わせでホームページをすでに５年も展開していました。 Wordpressのバージョンが古く、そのためデータベースのバージョンアップを求められ様々なサイトを参考にしてMy SQLを4から5にバージョンアップを挑戦しました。 いろいろサイトを確認して慎重に作業を行い、UTF-8にてPHPMｙAdminへログイン。 「構造」欄の「DROP TABLEを追加」と「IF NOT EXISTSを追加」にチェックを入れデータベースのエクスポート。 terapadというテキストエディタにて上から20行目あたりにあるCREATE DATABASEの前に--を入れました。 その後、旧データベースを削除。 そして新しいデータベースを作成。 PHPMyAdminに再度ログインし、新しいデータベースを選択。「操作」タブにて「照合順序」をutf8_generalciに変更し、sqlファイルをインポートしたところ 「#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--CREATE DATABASE `sankei-kouki`' at line 4 」と出てきました。 なぜだ？なぜだ？と再度さまざまなサイトをみながら対応策を調べてみました。 再度テラパッドにてsqlファイルを確認すると下記のものです。ちなみに「〇〇〇〇」は私のＨＰにあった任意の文字列です。 -- phpMyAdmin SQL Dump -- version 2.11.11.3 -- http://www.phpmyadmin.net -- -- 繝帙せ繝・ mysql68.db.sakura.ne.jp -- 逕滓・譎る俣: 2014 蟷エ 6 譛・18 譌・ 10:58 -- 繧オ繝シ繝舌・繝舌・繧ク繝ァ繝ウ: 4.0.27 -- PHP 縺ョ繝舌・繧ク繝ァ繝ウ: 5.3.22 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */; /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */; /*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */; /*!40101 SET NAMES utf8 */; -- -- 繝・・繧ソ繝吶・繧ケ: `〇〇〇〇` -- --CREATE DATABASE `〇〇〇〇`; --USE 〇〇〇〇; いくつかの参考サイトにあった「文字化け」というのは、このことを言っていたのかもしれません。 注意していたのはインポート後の「文字化けをしないように」という事で、ここでは文字化けを気にせず「CREATE DATABASE」と「USE」の前に--を入れる事だけに集中していました。 すでに旧データベースは削除済み。もう私のホームページはすべてが終わってしまったのでしょうか？ 助けてください（大泣）。
SQLで条件によって加算するか、しないかを判定したいと思っています。 ■テーブル：test name,flag,number mike,4,1 mike,4,2 mike,5,3 mike,6,4 mike,7,5 mike,8,6 mike,9,7 ■書いたSQL SELECT test.name AS "name", (CASE WHEN flag = '4' THEN sum(number) ELSE NULL END) AS "4", (CASE WHEN flag = '5' THEN sum(number) ELSE NULL END) AS "5", (CASE WHEN flag = '6' THEN sum(number) ELSE NULL END) AS "6", (CASE WHEN flag = '7' THEN sum(number) ELSE NULL END) AS "7", (CASE WHEN flag = '8' THEN sum(number) ELSE NULL END) AS "8", (CASE WHEN flag = '9' THEN sum(number) ELSE NULL END) AS "9" FROM test GROUP BY test.name ■結果 4,5,6,7,8,9 null,null,null,null,null,28 欲しい結果は、フラグが4ののものの合計。flagが「4」の場合は、「3」という結果が返ってきてもらいたいです。 flagが5の場合は、3が返ってきてもらいたいです。 SQLが間違っているのですが、どこが間違っているのかわかりません。どのように修正すればよろしいでしょうか？よろしくお願いします。 環境はSQLiteを使用しています。
エクセルで作ったような単純な縦横型のリレーショナル構造だとして、各列の一番大きな値を赤文字にしたいと思っています。 このとき、 (1)1回のクエリで全体を取得し、連想配列などにいれて各列をソートして1番大きな値を探す (2)必要な回数分、適したクエリを投げて、結果を変数に格納し、IDなどで一致させる という二通りのやり方を考えたのですが、どちらが一般的でしょうか。 (1)の場合は、DBに負荷がかからなくていいのかなと思いますが、多彩なフィルタやソートを使わずに、DBを使う意味があるんだろうかと考えてしまいます。 (2)の場合、列数が多いと、たとえば今回は5列分の結果を取得しようと思っていますが、1ページを表示させるのに5回DBへのアクセスがあることになり、運用としてどうなんだろうと考えた次第です。 アクセス数などにもよるのかと思いますが、一般的にこうする、というのがありましたら教えていただければと思います。 もちろん(1)(2)以外の方法でも歓迎です。 よろしくお願いします。
まだ解決できないので、大変恐縮ですがご教授お願いします。 どうかよろしくお願いいたします。 数人にご教授いただいき、チェックボックスの選択には一つのkid（kodawari_keyの略）に対して２複数の値をもっているホテルを表示させるにはデータベースのtableを複数に分けて紐付けする必要があるとアドバイスをいただき、教えて頂いたとおりtableをホテル用とチェックボックス用とチェックボックスのid用とに分けて、SQL文で紐付けしたつもりだったのですが、チェックボックスをチェックしてから検索ボタンを押すと Fatal error: Call to a member function execute() on a non-object in C:\xampp\htdocs\koredake\xxxxx\ｘｘｘｘｘｘｘ.php on line 97 のようなエラーが出てしまいます。 このことから紐付けのSQL文が間違っているのではと思うのですが、正解がわかりません。 どなたか教えていただけたらと思っております。 //MySQLの部分　教えていただいた部分で大変恐縮です。 //ホテルの基本情報 CREATE TABLE t_hotels(id int not null primary key,name varchar(100) not null,price_min int not null,price_max int not null,address varchar(100) not null); INSERT INTO t_hotels VALUES(1,'HOTEL A',5000,10000,'栃木県・・・'), (2,'HOTEL B',5000,12000,'栃木県・・・'), //こだわり情報 CREATE TABLE t_kodawari_key(id int not null primary key,name varchar(20)); INSERT INTO t_kodawari_key VALUES(1,'温泉'),(2,'ランチ'),(3,' ディナー'); //ホテルごとのこだわり CREATE TABLE t_hotel_kodawari(hid int not null,kid int not null,unique key(hid,kid)); INSERT INTO t_hotel_kodawari VALUES(1,1),(1,2),(1,3),(2,1),(3,2),(3,3),(4,3); //温泉かランチにこだわりがあるところ SELECT hid,t3.name,t3.price_min,t3.price_max,GROUP_CONCAT(t2.name) as kodawari,t3.address //温泉かランチかディナーのうち２つ以上にこだわりがあるところ SELECT hid,t3.name,t3.price_min,t3.price_max,GROUP_CONCAT(t2.name) as kodawari,t3.address //PHP部分　前半省略 <h1>ビジネスホテルの条件検索</h1> <form name="search_form" action="zenzen16.php" method="post" > <input type="hidden" name="cmd" value="search" /> <table> <tr> <th>物件種別</th> <td> <input type="checkbox" name="kid[]" value="1" <?php if( $_REQUEST["kid"] == "1" ){ print( 'checked' ); } ?>/> 温泉 <input type="checkbox" name="kid[]" value="2" <?php if( $_REQUEST["kid"] == "2" ){ print( 'checked' ); } ?>/> ランチ<br /> <input type="checkbox" name="kid[]" value="3" <?php if( $_REQUEST["kid"] == "3" ){ print( 'checked' ); } ?>/> ディナー <input type="checkbox" name="kid[]" value="4" <?php if( $_REQUEST["kid"] == "4" ){ print( 'checked' ); } ?>/> 駐車場</td> </tr> <tr> <th>価格帯</th> <td> <input type="text" name="price_min" value="<?php print( htmlspecialchars( $_REQUEST["price_min"] ,ENT_QUOTES ) ) ?>" size="8"> ～ <input type="text" name="price_max" value="<?php print( htmlspecialchars( $_REQUEST["price_max"] ,ENT_QUOTES ) ) ?>" size="8"><br /> </td> </tr> <tr> <th>住所</th> <td><input type="text" name="address" value="<?php print( htmlspecialchars( $_REQUEST["address"] ,ENT_QUOTES ) ) ?>" size="20"></td> </tr> </table> <input type="submit" value="検索" class="Btn-gray button"> </form> <p></p> <?php if( $_REQUEST["cmd"] == "search" ){ $pdo = new PDO("mysql:host=localhost; dbname=hotel_reservation; charset=utf8", "koredake", "koredake123", array( PDO::ATTR_EMULATE_PREPARES => false ) ); $sql = "select * from t_hotels where 1 = 1 "; $condition = array(); //この部分が特に自信が無いです。 if( !empty( $_POST["kid"] )){ $sql = $sql . " left outer join kid on t_hotels.hid = kid.hid"; } if( !empty( $_REQUEST["price_min"] ) ){ $sql = $sql . " and price >= :price_min "; $condition[":price_min"] = $_REQUEST["price_min"]; } if( !empty( $_REQUEST["price_max"] ) ){ $sql = $sql . " and price <= :price_max "; $condition[":price_max"] = $_REQUEST["price_max"]; } if( !empty( $_REQUEST["address"] ) ){ $sql = $sql . " and ( address like :address ) "; $condition[":address"] = "%{$_REQUEST["address"]}%"; } $statement = $pdo->prepare( $sql ); $statement->execute( $condition ); $results = $statement->fetchAll(); ?> <table border="1"> <caption>検索結果</caption> <tr> <th></th> <th>ホテル名</th> <th>宿泊料金</th> <th>住所</th> </tr> <?php foreach( $results as $result ){ ?> <tr> <td><img src="hotel/<?php print( htmlspecialchars( $result["id"], ENT_QUOTES )); ?>.png" /></td> <td><?php print( htmlspecialchars( $result["hotel_name"], ENT_QUOTES )); ?></td> <td>\<?php print( htmlspecialchars( number_format( $result["price"] ),ENT_QUOTES ) ); ?></td> <td> <?php print( htmlspecialchars( $result["address"], ENT_QUOTES ) ); ?> </td> </tr> <?php } } ?> </table> </div>
こんにちは。SQLiteのソートについてお教え頂けませんでしょうか。 フィールドに曜日が入っています。その曜日をソートをかけると下記のようになります。 土　日　月　木　水　火　金 欲しい並び順は下記です。 日　月　火　水　木　金　土 Or 月　火　水　木　金　土　日 CSVに出力したり、色々したいので曜日順になっていてもらった方が色々助かるのですが、何か良い方法はないでしょうか？ 今考えているのは、C#のフォームからSQL文を発行してSQLiteに問い合わせ。結果をC#側で受け取って、CSVに出力という事を考えています。
「たったコレだけでPHPプログラミングが理解できる本」を参考にPHPでプログラムを書いていまして、 ビジネスホテルの検索機能をチェックボックス機能を余分につけて検索できないか試したのですが、 チェックボックスにチェックを入れると全く検索できず他のテキストボックスに入力するだけなら検索できます。 なんとかチェックボックスを有効にできないかいろいろなサイトを調べたり本を読んだりしましたが解決策が見つかりません。 いろいろな機能に対応できるようなプログラムを組みたいと思ったのでかなりの初心者で大変恐縮ですが、どなたかご教授お願いできないかと思っております。 あと参考になるサイトがございましたら、教えていただきたいと思っております。 何卒よろしくお願い致します。 前半省略 <form name="search_form" action="" method="post" > <input type="hidden" name="cmd" value="search" /> <table> <tr> <th>物件種別</th> <td> <input type="checkbox" name="kodawari_key[]" value="温泉" <?php if( $_REQUEST["kodawari_key"] == "温泉" ){ print( 'checked' ); } ?>/> 温泉 <input type="checkbox" name="kodawari_key[]" value="ランチ" <?php if( $_REQUEST["kodawari_key"] == "ランチ" ){ print( 'checked' ); } ?>/> ランチ<br /> <input type="checkbox" name="kodawari_key[]" value="ディナー" <?php if( $_REQUEST["kodawari_key"] == "ディナー" ){ print( 'checked' ); } ?>/> ディナー</td> </tr> <tr> <th>価格帯</th> <td> <input type="text" name="price_min" value="<?php print( htmlspecialchars( $_REQUEST["price_min"] ,ENT_QUOTES ) ) ?>" size="8"> ～ <input type="text" name="price_max" value="<?php print( htmlspecialchars( $_REQUEST["price_max"] ,ENT_QUOTES ) ) ?>" size="8"><br /> </td> </tr> <tr> <th>住所</th> <td><input type="text" name="address" value="<?php print( htmlspecialchars( $_REQUEST["address"] ,ENT_QUOTES ) ) ?>" size="20"></td> </tr> </table> <input type="submit" value="検索" class="Btn-gray button"> </form> <p></p> <?php if( $_REQUEST["cmd"] == "search" ){ $pdo = new PDO("mysql:host=localhost; dbname=hotel_reservation; charset=utf8", "koredake", "koredake123", array( PDO::ATTR_EMULATE_PREPARES => false ) ); $sql = "select * from hotels where 1 = 1 "; $condition = array(); if( !empty( $_POST["kodawari_key"] )){ $sql = $sql . " and kodawari_key = :kodawari_key"; $condition["kodawari_key"] = $_REQUEST["kodawari_key"]; } if( !empty( $_REQUEST["price_min"] ) ){ $sql = $sql . " and price >= :price_min "; $condition[":price_min"] = $_REQUEST["price_min"]; } if( !empty( $_REQUEST["price_max"] ) ){ $sql = $sql . " and price <= :price_max "; $condition[":price_max"] = $_REQUEST["price_max"]; } if( !empty( $_REQUEST["address"] ) ){ $sql = $sql . " and ( pref like :pref or city like :city or address like :address ) "; $condition[":pref"] = "%{$_REQUEST["address"]}%"; $condition[":city"] = "%{$_REQUEST["address"]}%"; $condition[":address"] = "%{$_REQUEST["address"]}%"; } $statement = $pdo->prepare( $sql ); $statement->execute( $condition ); $results = $statement->fetchAll(); ?> <table border="1"> <caption>検索結果</caption> <tr> <th></th> <th>ホテル名</th> <th>宿泊料金</th> <th>住所</th> </tr> <?php foreach( $results as $result ){ ?> <tr> <td><img src="hotel/<?php print( htmlspecialchars( $result["id"], ENT_QUOTES )); ?>.png" /></td> <td><?php print( htmlspecialchars( $result["hotel_name"], ENT_QUOTES )); ?></td> <td>\<?php print( htmlspecialchars( number_format( $result["price"] ),ENT_QUOTES ) ); ?></td> <td> <?php print( htmlspecialchars( $result["pref"], ENT_QUOTES ) ); ?> <?php print( htmlspecialchars( $result["city"], ENT_QUOTES ) ); ?> <?php print( htmlspecialchars( $result["address"], ENT_QUOTES ) ); ?> </td> </tr> <?php } } ?> </table> </div> </body> </html>
環境は次のようになっています Windows7 SP1 64bit VMware Player 5.0.3 for Windows 32-bit and 64-bit CentOS-5.2-i386 オラクルマスターBronze11gの資格を取りたいと思い最近勉強を始めました。 Oracle Database 11g R2 をインストールしようと思い↓のサイトに書かれているとおりに作業を進めました。 http://www.asami.asia/tech/oracle/11gR2-install. … 無事にOracleEnterpriseManagerにログインが成功したものの、エミュレータの電源を一度切り、再びエミュレータを立ち上げるとOracleEnterpriseManagerにはもう繋がらなくなっていました。「https://localhost.localdomain:1158/em/」と入力するとFireFoxには次のようなメッセージが表示されます。 「正常に接続できませんでした localhost.localdomain:1158 のサーバへの接続を確立できませんでした。 サイトアドレスは有効なようですが、接続を確立できませんでした。」 どうすれば再びログインすることができるのでしょうか？
先日、「アクセス2013でエクセルにデータを出力したい」で質問し、 回答をもらい、行いたいことができました。 http://okwave.jp/qa/q8634369.html 数行あけて出力できるようになったのですが、これを繰り返して、間にデータを 挿入していこうとすると、保存した値が消えて最後に関数を呼び出した結果しか表示されません 上書き保存で実施していくためにはどうしたらよいのでしょうか？ Accessは2013です ～テーブルイメージ～ テーブル１ メーカー名　　2014/6/1　　2014/6/2　　2014/6/3　　合計 ----------------------------------------------------- メーカーA　　　　　2　　　　1　　　　　　1　　　　　4 メーカーB　　　　　1　　　　1　　　　　　1　　　　　3 テーブル２ メーカー名　　2014/6/1　　2014/6/2　　2014/6/3　　合計 ----------------------------------------------------- メーカーA　　　　　5　　　　6　　　　　　7　　　　　18 メーカーB　　　　　2　　　　2　　　　　　2　　　　　6 ～出力エクセルイメージ～ A　　 　　B　 　C　　　　D・・・　H　　 1　メーカーA　　 2　　　　1　　　　1　　　　4 2 メーカーA　　 5　　　　6　　　　7　　　　18 3 4 5　メーカーB　 　1　　　　1　　　　1 　　 　3 6 メーカーB　 　2　　　　2　　　　2　　　　6 7
SQLServer 2008 です。 以下のツリーデータの場合に A ┬C │├D ┬H ││　├I ││　└J │└E B ┬F ┬I 　│　└L 　└G 次のようなデータを登録しています。 ┌──┬──┬──┐ │OYA │KO　│Data│ ├──┼──┼──┤ │A │C 　│"C" │ ├──┼──┼──┤ │A　 │D 　│"D" │ ├──┼──┼──┤ │A　 │E 　│"E" │ ├──┼──┼──┤ │B　 │F　 │"F" │ ├──┼──┼──┤ │B　 │G 　│"G" │ ├──┼──┼──┤ │D 　│H 　│"H" │ ├──┼──┼──┤ │D 　│I 　│"I" │ ├──┼──┼──┤ │D 　│J 　│"J" │ ├──┼──┼──┤ │F 　│I 　│"I" │ ├──┼──┼──┤ │F 　│L 　│"L" │ └──┴──┴──┘ 引数OYA＝"A"でSQLを実行した場合に 以下のような この引数を含むそれ以下のツリーに関する データを取得する方法を教えてください。 ┌──┬──┬──┐ │OYA │KO　│Data│ ├──┼──┼──┤ │A │C 　│"C" │ ├──┼──┼──┤ │A　 │D 　│"D" │ ├──┼──┼──┤ │A　 │E 　│"E" │ ├──┼──┼──┤ │D 　│H 　│"H" │ ├──┼──┼──┤ │D 　│I 　│"I" │ ├──┼──┼──┤ │D 　│J 　│"J" │ └──┴──┴──┘
mysql4.0.25でlike binaryを使って日本語検索をしていますが インデックスを使いたいので前方一致で条件を作ると検索されません。 文字コードはeuc-jpです。 部分一致でしか検索にひっかからないのですが 文字コードなど関係があるのでしょうか？
SQLを使って、「名前」（カラム名=name)と「コメント」（カラム名=comment)のテーブルを作りました。 このテーブルに対して、検索フォームを作りました。 このフォームに名前を入力すると、該当する行が検索されるようにしました。 ◆入力フォーム　form.php <form action = "kensaku.php" method="post"> 名前：<input type="text" name="name"> <input type="submit" name="submit" value="検索"> </form> ◆検索結果　search.php <?php function connect() { return new PDO("mysql:dbname=★;host=★","★","★", array( PDO::MYSQL_ATTR_INIT_COMMAND => "SET CHARACTER SET `utf8`")); } $pdo = connect(); $st = $pdo->query("SELECT * FROM table WHERE name='" . $_POST["name"] . "' "); $address = $st->fetchAll(); ?> <?php foreach ($table as $g) { ?> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="GENERATOR" content="IBM WebSphere Studio Homepage Builder Version 14.0.8.0 for Windows"> <p>名前<?php echo $g['name'] ?></p> <p>コメント<?php echo $g['comment'] ?></p> <?php } ?> ここで、該当する文言の一部でも検索できるようにしたいです。 ※例えば、「山田太郎」を検索する場合に「山」だけでも検索できるように。 LIKEを使えばよいかと思い、 $st = $pdo->query("SELECT * FROM table WHERE name='" . $_POST["name"] . "' ");を $st = $pdo->query("SELECT * FROM table WHERE name LIKE='%" . $_POST["name"] . "%' "); と、記述してみましたがだめでした。 どのように記述すればよいか教えていただけないでしょうか。 何卒お願いします。
クエリのパフォーマンスチューニングを勉強し始めたのですが、クエリの実行時間の良し悪しはどのように判断したらよいのでしょうか？　実行にかかった時間の目安などはあるのでしょうか？ ちなみに、MySQL5.5を使用しています。 以上、よろしくお願い致します。
自分のパソコンでは文字化けせず、正しく表示されているのですが、 niftyのデータサービスを使ってphpで表示すると文字化けします。 my.iniとmy.cnfの問題と思いniftyサーバーにftpで接続し探したがファイルが見つかりません。 mysqlとphpはutf8で設定しています。 niftyサーバーのmysqlは５、phpMyAdminは2,11,9です。
何十万件もあるリストを短時間に表区分をかえたいのですが、 １件ずつかえるととてつもなく時間がかかるんで、 なにかよい方法はないでしょうか？ たとえば、 以下のような３行の表を、 0001　|　犬　猫 0002　|　猿　狐 0003　|　犬　猿　狐 以下のような動物種ごとに行をわけたい。 0001　|　犬 0001　|　猫 0002　|　猿 0002　|　狐 0003　|　犬 0003　|　猿 0003　|　狐 エクセルはつかえますが、マクロはつかえません。 テキストエディターはサクラエディターをつかっています。
複数のテーブルを結合してレコードを取得するシステムを作成しています。 問題に関わってくるのが、プロジェクトIDや件名を保存するプロジェクトテーブルと、発注先や買掛日・発注金額などを保存する発注テーブルです。 1つのプロジェクトに対して複数の発注先があり、2つのテーブルはプロジェクトIDによって結合されています。 WHERE句によって各カラムの条件でレコードを絞り、プロジェクトIDや件名でグループ化を行い、最終的にプロジェクトID、件名、グループ内で最も遅い買掛日、グループ内の発注金額の総額etcを表示します。 現在起こっている問題の例を挙げます。 1つのプロジェクトに、発注先がA社・買掛日が2014年4月30日・発注金額が10万の発注と、発注先がB社・買掛日が2014年7月30日・発注金額が20万の発注があるとします。 これを発注先がB社・買掛日が4月1日から5月30日までの間という条件で検索をかけると、 本来ならこのプロジェクトは表示されないはずなのですが、最も遅い買掛日が7月30日(B社の買掛日)、発注金額が10万(A社の発注金額)で表示されてしまうのです。 どうすればこれを修正することができるのでしょうか？
単一レコード内において、 Bの値を条件により決定したいのですが可能でしょうか。 ＜構成＞ テーブル:hoge カラム:A,B ＜条件＞ Aにデータがあれば、Bは"●" Aにデータがなければ、Bは"×" よろしくお願いいたします。
MS SQL2005 の”SQL Server Management Studio”を使って下のクエリーを実行します。 例１は実行できますが、例２は実行できません。 なぜでしょうか？ 例１ select * from [test].[dbo].[test_table] 例２ select * from （'[test].[dbo]' + '.[test_table]'）
現在サーババージョンアップに伴うストアドの動作検証を行っています。 内容としては2000で動作していたものを2008R2に移行するだけです。 そこでひとつ問題が発生して作業がとまってしまいましたので、 お力を借りたく、質問させていただきます。 環境としては、クライアントはACCESSプログラム、DBはSQLServerとなっています。 ストアドの実行で下記のように記載していたプログラムが動作しなくなりました。 Set adoCN = New ADODB.Connection adoCN.Open CurrentProject.Connection adoCN.BeginTrans adoCN.Execute "exec dbo.実行ストアド" 'エラー判定 adoCN.CommitTrans 上記エラー判定で「リンク サーバー "(null)" の OLE DB プロバイダー "SQLNCLI10" から、 メッセージ "アクティブなトランザクションがありません。" が返されました。」 となってしまいます。 また、このストアド内では「SET XACT_ABORT ON ～ SET XACT_ABORT OFF」 としてあります。 ちなみに、上記「adoCN.BeginTrans」、「adoCN.CommitTrans」をコメントすると、 正常に動作しました。 「SET XACT_ABORT ON」としているので「adoCN.BeginTrans」はなくてもいいと思うのですが、 明確に『不要である』としている文献等、見つからなかったため、迷っています。 サーバはバージョンアップに伴い、分散トランザクションを使用するようになっていますが、 この変更が影響しているのかどうか、まったく別の原因なのか、わからない状態です。 うまく伝わっているか心配ですが、どうぞ宜しくお願い致します。
質問をお願いします。 現在、複数のネットショップを運営しています。 各ショッピングモールに出品するのが大変なので、自社で商品データベースを作って、それぞれのモール用（楽天、Yahoo、Dena、自社、ヤフオク、ポンパレ）のCSVデータと画像を吐き出すようにしています。 ただ、社員が勉強しながら作ったソフトなのでトラブルが多発し、困っています。 このような素人が作成したソフトのソースをプロに渡し、理想の形に仕上げていただきたいのですが、可能でしょうか？ 価格的にもどのくらいかかるのか心配です。 人の書いたソースは理解するだけでも大変そうです。ちなみに私自身は全く理解できていません。 開発環境は Windows Server 2008 R2 Visual Basic 2010 Express と聞いております。 よろしくお願いします
以下のようなテーブルがあります。 納品データ 注文番号　売上番号　連番　商品名 11111　　 　2　　　　　　1　　 さしすせそ 11111　　 　2　　　　　　2　　 たちつてと　 11111　　 　3　　　　　　1　　 なにぬねの 11111　　 　4　　　　　　1 　　はひふへほ 売上データ(既存データ) 注文番号　売上番号　連番　商品名 11111　 　 1　　　　　　 1　　 あいうえお 11111　 　 1　　　　　　 2　　 かきくけこ 注文番号は注文毎に付与される番号 売上番号は発送毎に付与される番号 連番は売上番号毎に付与される連番 毎回 納品データを売上データに取り込みます。 連番に関しては、 納品データと売上データで連番は連動しておらず、 売上データに納品データと同等の注文番号があれば、 注文番号の最大連番数を+1した番号で取り込みます。 更新後、売上データは、 注文番号　売上番号　連番　商品名 11111　　　 1　　　　　　 1　　 あいうえお(既存データ) 11111　　　 1　　　　　　 2　　 かきくけこ(既存データ) 11111　　　 2　　　　　　 3　　 さしすせそ 11111　　　 2　　　　　　 4　　 たちつてと 11111　　　 4　　　　　　 5　　 なにぬねの 11111　　　 5　　　　　　 6　　 はひふへほ としたいのです。 SELECT (SELECT 納品データ.連番+(SELECT NVL(MAX(売上データ.連番),0) FROM 売上データ WHERE 売上データ.注文番号 = 納品データ.注文番号) AS 連番) FROM 納品データ で売上データの連番+1はできたのですが、 売上番号が違う場合は、連番が1になるパターンとなり、 納品データ 注文番号　売上番号　連番　商品名 11111　　　 2　　　　　　 1　　 さしすせそ 11111　　　 2　　　　　　 2　　 たちつてと　 11111　　　 3　　　　　　 1　　 なにぬねの　← 11111　　 　4　　　　　　 1 　　はひふへほ ← 上記SQLですと、 更新後、売上データは、 注文番号　売上番号　連番　商品名 11111　　　 1　　　　　　 1　　 あいうえお(既存データ) 11111　　　 1　　　　　　 2　　 かきくけこ(既存データ) 11111　　　 2　　　　　　 3　　 さしすせそ 11111　　　 2　　　　　　 4　　 たちつてと 11111　　 　4　　　　　　 3　　 なにぬねの ← 5にしたい 11111　　　 5　　　　　　 3　　 はひふへほ ← 6にしたい となり、連番となりません。 どのようにSQLを書けばよいのか、困っています。 どうか、ご教示お願い致します。
どういう時に、排他モードで開くと便利なのか教えてください。 アクセスはローカルで自分一人で使っています。
お世話になります。 Access2010の伝票ウィザードで、ヤマト送り状の設定を行いました。 プレビュー上ではＡ4くらいの画面に上下2枚伝票が並んでいる様な感じですが、ドットプリンタで単票を挿入すると、ちゃんと1枚毎に排出し次の伝票を印刷排出します。 しかしながら、1枚目のレイアウトはちゃんと印刷されているのに2枚目はかなり用紙の上に印刷されます。3枚目はちゃんと印刷されるが4枚目は又上に印刷される・・・という様になります。 おそらくプレビュー上に表示されいる1枚目と2枚目の間隔が狭いのが原因なのだと思うのですが、どこをどう設定しなおしたらよいかわかりません。 ちなみにデザイン画面で用紙のレイアウトを下に伸ばしてみたりしてみたのですが、一向に印刷位置は改善されませんでした。
Oracle と Perl の接続で悩んでいます。 申し訳ありませんが何方かご教授下さい。 OS：Red Hat Enterprise Linux ES release 4 Perl：perl v5.8.5 DB：oracle-xe-univ-10.2.0.1-1.0.i386 ドライバーは以下をインストールしてあります。 perl-DBD-Pg-1.31-6 perl-DBD-MySQL-2.9004-3.1 perl-DBI-1.40-8 以下もインストールしてみましたが駄目でした # rpm -ivh oracle-instantclient12.1-basic-12.1.0.1.0-1.i386.rpm # rpm -ivh oracle-instantclient12.1-devel-12.1.0.1.0-1.i386.rpm # rpm -ivh oracle-instantclient12.1-sqlplus-12.1.0.1.0-1.i386.rpm 環境変数の設定（.bash_profileに以下を設定） . /usr/lib/oracle/xe/app/oracle/product/10.2.0/server/bin/oracle_env.sh Perlでサンプルプログラムを作成して、他の同等のサーバでは正常に動作確認した プログラムを、このサーバで実行すると以下の様なエラーが出ます。 [oracle@IJYOU]$ perl test_db.pl install_driver(Oracle) failed: Can't locate DBD/Oracle.pm in @INC (@INC contains: /usr/lib/perl5/5.8.5/i386-linux-thread-multi /usr/lib/perl5/5.8.5 /usr/lib/perl5/site_perl/5.8.5/i386-linux-thread-multi /usr/lib/perl5/site_perl/5.8.4/i386-linux-thread-multi /usr/lib/perl5/site_perl/5.8.3/i386-linux-thread-multi /usr/lib/perl5/site_perl/5.8.2/i386-linux-thread-multi /usr/lib/perl5/site_perl/5.8.1/i386-linux-thread-multi /usr/lib/perl5/site_perl/5.8.0/i386-linux-thread-multi /usr/lib/perl5/site_perl/5.8.5 /usr/lib/perl5/site_perl/5.8.4 /usr/lib/perl5/site_perl/5.8.3 /usr/lib/perl5/site_perl/5.8.2 /usr/lib/perl5/site_perl/5.8.1 /usr/lib/perl5/site_perl/5.8.0 /usr/lib/perl5/site_perl /usr/lib/perl5/vendor_perl/5.8.5/i386-linux-thread-multi /usr/lib/perl5/vendor_perl/5.8.4/i386-linux-thread-multi /usr/lib/perl5/vendor_perl/5.8.3/i386-linux-thread-multi /usr/lib/perl5/vendor_perl/5.8.2/i386-linux-thread-multi /usr/lib/perl5/vendor_perl/5.8.1/i386-linux-thread-multi /usr/lib/perl5/vendor_perl/5.8.0/i386-linux-thread-multi /usr/lib/perl5/vendor_perl/5.8.5 /usr/lib/perl5/vendor_perl/5.8.4 /usr/lib/perl5/vendor_perl/5.8.3 /usr/lib/perl5/vendor_perl/5.8.2 /usr/lib/perl5/vendor_perl/5.8.1 /usr/lib/perl5/vendor_perl/5.8.0 /usr/lib/perl5/vendor_perl .) at (eval 1) line 3. Perhaps the DBD::Oracle perl module hasn't been fully installed, or perhaps the capitalisation of 'Oracle' isn't right. Available drivers: ExampleP, Pg, Proxy, mysql. at /home/oracle/test2_setting.pl line 18 どうか何方かお願いします。
こんにちは。 my sql 初心者です。 データをcsv形式でエクスポートする際に問題があり質問です。 商品管理番号サイズカラー ASブルー AMイエロー BSブルー BMイエロー BLレッド CSブルー CMホワイト というデータがあったとします。 ※上記はデータの一部です。実際はもっと文字数もサイズカラーも多いです。 このデータを使ってビューを作成します。 -------------------------------------------------------------------------------- CREATE VIEW item_v_tab AS SELECT id, CONCAT('size:',サイズ,'#','color:',カラー,'=',商品管理番号,'&')AS subcode, 商品管理番号 FROM zaiko; -------------------------------------------------------------------------------- この時にデータ型はmediumtextとなります。 次に、 -------------------------------------------------------------------------------- SELECT id, 商品管理番号, group_concat(distinct subcode order by subcode ASC separator '\n') as subcode FROM item_v_tab group by 商品管理番号; -------------------------------------------------------------------------------- で商品管理番号をグループ化します。 そしてcsvでエクスポートすると subcodeの一部、サイズカラーが多いもので文字数が切れてしまいます。 データ型を変更すれば切れずにすべて出力できるのかな？ と考えて調べていたのですが、方法がわかりません。 お分かりになる方お教えいただけないでしょうか。 以上よろしくお願い致します。
SharePoint 2010にて、10個のサイトに一度でWordファイル1点を追加したいです。 こちらは可能でしょうか。もし可能でしたら、手順をご教示いただきたく存じます。 なにとぞ、よろしくお願いいたします。
既にデータベースをOracle 11gR2にて構築していて、初期化パラメータ「NLS_LENGTH_SEMANTICS」をデフォルトのByteベースからCharベースに変更しようとしています。この手順と影響範囲が知りたいです。 (1) 手順 私の理解では単純にSYSユーザにて以下を実行する。データベースの再起動は不要で有効になる。 SQL> ALTER SESSION SET NLS_LENGTH_SEMANTICS='CHAR'; 正しいでしょうか？ (2) 影響範囲 SID上に構築しているすべてのスキーマ上のテーブルに適用される、で正しいでしょうか？ また、既存テーブルと新規テーブルという意味では、既存テーブルには影響を与えない、らしいのですが、そうなのでしょうか？　新しくテーブルを作成した場合にのみCharベースになるということでしょうか。その場合、既存テーブルもCharベースに変更するにはどのような手順を踏めばよいのでしょうか？（例）テーブルのエクスポート→テーブルのドロップ→テーブル再作成→データのインポート？など、思いつきですがよい方法があれば教えてください） 以上、宜しくお願いします。
例えば、Twitterのようなシステムを作るとします。ユーザの情報に「名前」「ID」「フォロワー」があります（3つだけユーザー情報とします）。 id , name, follower_idsのようなフィールドが必要だと思います。ですが、この時follower_idsはいくらでも要素が増える可能性があります。このようなユーザー情報をSQL（特にMySQL）で管理することはできますか？ 今回の例のような構造をデータベースに保管したいのですが、どんな形式をとったらいいか迷っているので、質問しました。ちなみにSQLはやったことがありません。おすすめの方法があったらお願いします。XMLやJSON形式というキーワードにもたどり着きましたが、なるべく早いデータ操作をしたいです。
OracleをDBとして利用し、 Webアプリの開発を行うとしています。 フレームワークを利用して作成しようとしているのですが、 Oracle と CakePHP の情報が少なく困っています。 OracleをDBとして利用し、 Webアプリをフレームワークで作成する場合、 どの言語で、どのフレームワークを使用するのが一番お勧めでしょうか。 PHP？Ruby？java？ ご教授お願いします。
ご覧頂きありがとうございます。 今回の質問ですが、MySQLの表結合時の処理速度（負荷）についてお聞きします。 SELECT abcd.name, hoge.age FROM abdc, hoge WHERE abcd.id = hoge.id; SELECT abcd.name, hoge.age FROM abcd LEFT JOIN hoge ON abcd.id = hoge.id; 上記のいわゆるJOINとJOIN(省略)？になりますが、どちらが処理速度的に優秀なのでしょうか？ 可能であればどういった処理が走っているのかも御存じであれば教えて頂きたいです。 参考URLでも構いませんので、よろしくお願い致します。
ACCESS2010で　テーブル　入金、テーブル　出金　を作成して１年（毎月）の集計をしていますが、どちらかのテーブルにデータがないと、集計表にした時、データがない月が表示できません。いまはデータがない月に、（0）を入れています。（0）を入れなく出来ないものでしょうか。
いつも楽しく勉強させていただいております。 環境はSQLServer2012のExpressでOSはWindowsServer2008です。 Test1というデータベースのバックアップを取ってTest2という名前で復元しようとしましたが、なぜか失敗してしまいます。 どなたか原因を教えていただけませんか。 次の手順でバックアップを取り、復元をしています。 ○バックアップのフェーズ 1.データベースのバックアップのダイアログボックスを開く。 2.ソースにTest1、バックアップの種類に完全を指定する。 3.バックアップ先は以下のファイルに 　C:\Program Files\Microsoft SQL Server\MSSQL11.SQLEXPRESS\MSSQL\Backup\Test1.bak 4.OKをクリックし、「データベース'Test1'のバックアップが正常に完了しました」を確認。 ○復元のフェーズ 5.データベースの復元のダイアログボックスを開く。 6.ソースはデバイスにする。 7.ファイル名に上記3.のファイル名を指定 8.転送先データベースはTest2とする。 9.OKをクリック（ここでエラーとなる）。 エラーメッセージは以下の通りです。 ------------------------------------------ データベース'Test2'の復元に失敗しました。（Microsoft.SqlServer.Mangement.RelationalEngineTasks) 追加情報: System.Data.SqlClient.SQLError:ファイル'C:\Program Files\Microsoft SQL Server\MSSQL11.SQLEXPRESS\MSSQL\DATA\Test1.mdf'に上書きできません。 データベースTest1が使用中です。(Microsoft.SqlServer.SmoExtended) ------------------------------------------ メッセージの内容で引っかかるのはTest1.mdfに上書きできませんというところです。 上書きでなくTest2という新規データベースに書き込みたいのですが。 ためしにTest2というデータベースを作成しておいて「既存のデータベースに上書きする」をチェックしてやってみましたが、やはり失敗。 メッセージは上と同じです。 SQLServerを再起動して試してもやはり結果は同じです。 何が悪いのでしょう。
基本的な質問ですみません。Oracle 12cを初めて使うのですが、すごく単純に、ユーザを作成し、そのユーザでデータベースオブジェクト（テーブルなど）を作成する拡張子が.sqlのスクリプトを流したいです。 11gまでの場合、システムユーザでCREATE USERしたのちに、コマンドプロンプトを立ち上げて C:\Scripts> SQLPLUS <USER>/<PASSWORD> @createtables.sql とするだけで良かったと思います。 今回、12cではユーザの考え方が変わっており、CDBとPDBを作成しました。 > SQLPLUS /NOLOG SQL> CONN SYS AS SYSDBA （上記のようにローカル接続するとCDBに接続される） SQL> ALTER SESSION SET CONTAINER=PDB1; // PDBへ移動 SQL> SHOW CON_NAME // 念のため現在接続中のPDBの名前確認 SQL> STARTUP; （これでマウント状態だったPDB1がOPENしてREAD WRITEになる） この状態でCREATE USER文を実行してPDB1上でユーザを作成。 ここからなんですが、PDBやCDBへのログイン方法はわかたのですが、PDB上で作成したユーザにはどのようにしてログインするのでしょうか？　ログインしてテーブル作成をしたいです。また、テーブル作成のスクリプト文（.sql）があるのでそれを流したい場合は、コマンドプロンプトからどのように実行すればよいでしょうか？ 基本的な質問で恐縮ですが、宜しくお願いします。
以下のテーブルのレコードをもとに Ａ Ｂ Ｃ 1| あ | あ | １ | 2| あ | い | １ | 3| あ | う | １ | 4| う | あ | １ | 5| え | あ | １ | 6| あ | あ | ２ | 7| あ | い | ２ | 8| あ | う | ２ | 9| う | あ | ２ | 以下のテーブルを作成したいと考えています。 Ａ Ｂ Ｃ Ｄ Ｅ 1| あ | あ | １ | あ | － | 2| あ | い | １ | い | － | 3| あ | う | １ | う | あ | 4| え | あ | １ | － | え | 5| あ | あ | ２ | あ | － | 6| あ | い | ２ | い | － | 7| あ | う | ２ | う | あ | (1)カラムＣを１つのグループとします。 (2)その中でカラムＡの値が「あ」の場合は、カラムＢの値をカラムＤに設定する。 (3)カラムＡの値が「あ」ではない場合は、カラムＢの値をカラムＥに設定する。 (4)カラムＡの値とカラムＢの値を入替えると同じ場合は(例では上の表の3と4、8と9のレコード)、 カラムＡの値が「あ」でない方のレコード（4と9のレコード）のカラムＢの値をカラムＥに設定する。 (5)(4)で値を設定した方のレコードを削除する。 どのようなSQLを作成すればできるのでしょうか？ SQLに詳しい方がいらっしゃれば、ご教授をお願います
大学院生です。実証実験のためにデータベースの使用を考えています。 専門外でわからないことだらけなので、検索の糸口だけでも頂けると有難いです。 以下の要求に当てはまるデータベース（DBMS?）にはどのようなものがあるでしょうか ・いくつかの数値データを関連付けて管理したい ・数値データの中には、波形データもある（100サンプル程度の複素数値） ・高速に入出力が出来る方が良い ・複数アプリケーションからアクセス出来る方が良い それともう数点、 一般的なデータベースで複素数値は格納できますでしょうか。別のカラムを用意して、実部虚部別で管理する必要がありますか。 データベースは列（カラム）と行（レコード）でデータを管理するようですが、波形データをデータベースに格納する際には、以下のように各サンプル値を各カラムに収容するという考え方で良いのでしょうか。グルーピングして１つのカラムに収容する方法があったりするのでしょうか。 ＩＤ　カラム１　　　　カラム２　　　　カラム３　… １　サンプル値１　サンプル値２　サンプル値３　… ２　サンプル値１　サンプル値２　サンプル値３　… 　 データ量がさほど多くなければ、すべての値をデータベースでなくアプリケーション側の変数として格納しておくという形式もとれるのかなと思っていますが、このようにした場合に起きる問題点にはどのようなものがあるでしょうか。 回答をお願いします。
Oracle10gでデータ管理していますが、インターフェースを外注した為、自由なデータ加工ができません。この為、keySQLを用いて、データをExcelとして取出し、Access2003にインポートして解析する方法で対応しています。 しかし、Excelで一度に取り出せるレコード数が65500程度に限られ、効率的にデータ取出しが出来ません。そこで、keySQLで、集計してレコード数を減らして取り出したいと思います。 しかし、Accessのクエリーデザイン画面のような集計ボタンが見当たりません。GUI的には集計できないという事でしょうか？クロス集計はできるようなのですが、Accessのような集計は、SQL文を直接記述する方法しかないのでしょうか？ keySQLにお詳しい方がおられましたら、データ集計の仕方をご教示下さい。 当方、残念ながら、まだSQL文を直接記述できるレベルにはありません。
SQLについての質問です。 MySQLを使っています。 1か月間の得意先別の入金の集計を取りたいと思っています。 表としては以下のような感じです。 ID　　得意先名　　現金計　振込計　相殺計　手数料計　　合計 =========================================================== 001　aaaaaaa　　　30,000　　40,000　　25,000　　　　840　　95,840 002 bbbbbbb　　　10,000　　20,000　　30,000　　　　420　　60,420 SELECT * sum(nyukin) AS genkin FROM nyukin_meisai WHERE tokuisaki_id = '001' AND nyukin_kubun = '現金' AND uriage_bi BETWEEN '2014/05/01' AND '2014/05/31' SELECT * sum(nyukin) AS furikomi FROM nyukin_meisai WHERE tokuisaki_id = '001' AND nyukin_kubun = '振込' AND uriage_bi BETWEEN '2014/05/01' AND '2014/05/31' 以下続く と得意先毎/各区分ごとに一つひとつSQLを発行すればできるんでしょうけど、 これをひとつのSQLで実現したいと思っていますがSQLをどのように組み立て てよいものやら困っています。 case を組み込んだりしてもうまくいきませんでした。 どなたかご指導下さい。 よろしくお願いします。
よろしくお願いします。 【環境】 RHEL 5 Oracle 11g R2 【質問】 AUDIT_FILE_DESTパラメータ に　/opt/oracle/app/diag/AUDIT　を指定して ファイルとして出力しています。（必須監査も含めて）通常は正常に動作していますが、なぜか まれに以下のフォルダに監査ログが出力されてしまいます。 $ORACLE_BASE/admin/adump 出力されるログは今のところ以下の１種類の監査ログのみです。 ACTION:[7] 'CONNECT' DATABASE USER:[1] '/' PRIVILEGE:[6] 'SYSBA' CLIENT USER:[6] 'oracle' CLIENT TERMINAL][13] 'Not Available' 質問ですが、なぜこの監査ログのみ adump 以下の記録されるのでしょうか。
初めまして。 最近、SQLを学び始めました。 会社で掃除当番表を作成することになったのですが、どのようにしたらいいのかがわかりません。 条件としては、 １．人数は全部で３１人。 ２．１度にランダムに５人ずつ当番になる。 ３．１度当番になると、全員の当番が一巡するまで回ってこない。 ４．SQLServer2012を使用し、プログラミング後はAccessのフォームに出力してフォームで確認可能。 ５．ランダムに選ばれた当番表を履歴テーブルに残す。 の５点になります。 本やネットで調べてみたのですがうまくいきません。 ご教授をお願い致します。
＜環境＞ SQLSERVER 2012 入力フォームに、入力した後で、DBに登録した際に、 依頼Noに、既にあるデータのMAX+100の値を登録したいです。 依頼NoにMAX+100の連番をふることは以下の方法でできたのですが、 ＩNSERT INTO テーブル1(依頼No) SELECT MAX(依頼No)+100 AS NEW_ID FROM テーブル1 入力フォームのデータと登録と同時に、依頼Noを振りたいのですができません。 以下のように書いてみましたが、 根本的に間違っていると思うので、いい方法をご教授いただけたらと思います。 ※iraibi は入力フォームで、依頼日を入力した値です。 INSERT INTO テーブル1 (依頼No,依頼日) VALUES ('SELECT MAX(依頼書No)+100 AS NEW_ID FROM テーブル1','" & iraibi & "') 宜しくお願いいたします。
お世話になっております。 PHPとmysqlでサイトを作っておりまして、そのログを分析しようとしています。 あるテーブルにユーザー名とログイン日付が入ったテーブルが有ったとして、その中で連続○日ログインしていた人は○人という結果を取りたいと考えているのですがこれをSQLで処理する方法はありますでしょうか？ 今のところ、PHPで全データを取った後にPHP側で処理するしかないかと思っているのですが、件数が多いため可能であればmysql側で処理したいと思っています。 日付はUNIXTIMEに直すなどすればINTEGERに変換出来るとは思っているのですが、日付型（難しいようであればINT型の連続値でも問題ありません）でSQLで処理出来る方法はあるのでしょうか？ ○○結合をすれば良いなど手がかりなど教えていただけると助かります。 ■テーブル username　　　login_date ほげ　　　　　　2014/5/1 ほげ　　　　　　2014/5/2 ほげ　　　　　　2014/5/3 ほげ　　　　　　2014/5/4 ふーばー　　　2014/5/2 ふーばー　　　2014/5/3 あああ　　　　　2014/5/1 あああ　　　　　2014/5/3 あああ　　　　　2014/5/4 ■ほしい結果 4日連続　　　１名 ２日連続　　　２名
ORACLE初心者で索引について勉強しています。 そこでORACLEの索引（Bツリー）検索について２点程質問させていただきます。 (1)索引を用いるとI/O処理が少なくなりアクセスが高速になるということはわかったのですが、そのI/O処理とはプロセスとメモリ間のやりとりに関するI/O処理という認識で間違いないのでしょうか？ (2)索引付きと索引なしのカラムを抽出条件にして検索した場合、まず索引付きのカラムから検索を行い、そのROWIDを元に索引なしのカラムのデータを取得して対象データかどうかの判断を行うのでしょうか？
テーブルに事前に記載された数値を用い、べき乗の数値の挿入(アップデート)をしたいと考えています。 *********************************************** やりたいこと *********************************************** テーブル　baken umaban___bekijyo___name 1_______NULL____ HOTARUNOHIKARI 2_______NULL____ MADONOYUKI 3_______NULL____ OPPEKEPE 4_______NULL____ KOTARO これをUPDATEして、bekijyo欄に「2のumaban乗」の数値を挿入する。 umaban___bekijyo___name 1_________2_____ HOTARUNOHIKARI 2_________4_____ MADONOYUKI 3_________8_____ OPPEKEPE 4________16_____ KOTARO ************************************************ まずは、べき乗を求めるために下記のSELECT文を作成したところうまくいきました。 SELECT uma_code,umaban FROM (SELECT POW( 2, umaban ) AS uma_code,umaban FROM cbf_today_baken WHERE umaban<'11') AS temp1 umaban___uma_code___ 1_________2_____ 2_________4_____ 3_________8_____ 4________16_____ あとは、上記の2つをくっ付けるだけです。 UPDATE baken SET bekijyo=(SELECT uma_code FROM (SELECT uma_code,umaban FROM (SELECT POW( 2, umaban ) AS uma_code,umaban FROM cbf_today_baken WHERE umaban<'11') AS temp1) WHERE cbf_today_baken.umaban=temp1.umaban) 上記でアップデート可能と思われましたが、エラーになります。 #1248 - Every derived table must have its own alias どこに誤りがあるのかご教授頂けましたら幸いです。
いつもお世話になっております。 コマンドプロンプトにてMySQLに接続後、文字コードを変更まで行える batファイルを作成したのですが、うまくいかず困っております。 batファイル： c:\xampp\mysql\bin\mysql -u root -p1234 にて接続ができることは確認いたしました。 aaa.sqlファイル set character_set_client='sjis'; set character_set_connection='sjis'; set character_set_results='sjis'; c:\xampp\mysql\bin\mysql -u root -p1234　db1 < c:\（ファイルの場所）\aaa.sql とし、実行しましたが、ウィンドウが閉じ、うまくいきません。 いったいどのあたりが悪いのか見当がつかず、困っております。 お忙しいところすみませんが、お知恵を貸していただけませんでしょうか。 何卒宜しくお願いいたします。
標題の別サーバーのＤＢへテーブルをコピー（更新）したいと考えておりますが、やり方が全く分かりませんのでお教えください。 【更新元】 販売管理サーバー ＯＳ：Ｗｉｎｄｗｏｓ2008Ｒ２ SQL SERVER 2008R2 サーバー名：POS ＤＢ名：POSDATA テーブル名：POS売上伝票 【更新先】 社内開発用サーバー ＯＳ：Ｗｉｎｄｗｏｓ2008Ｒ２ SQL SERVER 2012Express サーバー名：AD ＤＢ名：ＰＯＳ テーブル名：POS売上伝票 ＰＯＳ上のSQL ManagementStudeoから、ＡＤ上のＳＱＬＳＥＲＶＥＲへのアクセスは可能な状態にしております。 ◎実装したい要件 ＰＯＳサーバー上のデータを、毎日定時にＡＤサーバー上のＤＢに追加更新 ※理想としては、バッチ等のスクリプトをタスクに登録し定時に実行 自分なりに調べてみたのですが、データを丸ごとコピーする場合は、"bcp"コマンドを実行すれば可能なようですが、bcpコマンドで、サーバー間のコピーの方法が良くわかりませんでした。 また、出来れば日々更新する為、データが変更されたレコードはUPDATE追加されたデータは、INSERTする事が理想です。 ※夜間のバッチ処理ですので、上記の方法が私の知識的に難しようであれば、テーブルを作り直ししてもよいと考えております。 効率的な方法をご存じの方がいらっしゃいましたらアドバイスをお願いいたします。
基本情報処理試験の勉強してます。 とはいえ日常的にDBをいじってるので、 一番ストリクトにDBを切ったものが第３正規形ということはわかります。 ですが、第１正規形と第２正規形の違いがいまいちぴんときません。 どこがポイントでしょうか？ よろしくお願いします。
Wordpressにあるusermetaというテーブルに、 別のDBのテーブルからデータをINSERTしたいのですが、 #1241 - Operand should contain 1 column(s)　というエラーが表示されてうまくいきませんでした。 具体的なSQL文は、 insert into ***_usermeta (umeta_id,user_id,meta_key,meta_value) select (null,tableBid,'first_name',''), (null,tableBid,'last_name',''), (null,tableBid,'nickname',tableBname), (null,tableBid,'***_capabilities','a:1:{s:10:\"subscriber\";b:1;}'), (null,tableBid,'***_user_level','0') from dbB.tableB where tableBname<> 'Admin' dbBのtableB にあるAdmin行以外を対象としています。 実際にはもう少しデータが多いのですが、select (null,uid,'first_name','') from ・・・ だけにしても同じエラーが出ましたので、構文の書き方が間違っていると感じています。 （別のDBではなく、同じDBの別のTableからのINSERTでも同じエラーが表示されました） 上記のようなケースの場合、どのようにSQL文を書けばよいのでしょうか？ お分かりになられる方がいらっしゃいましたら、ご教示頂けますと幸いです。 宜しくお願い致します。
Filemakerserver8から13に変更しましたが、基本的にルーターの開放ポート番号は変更しなくともよろしいでしょうか。admin consoleで共有ファィルを開いたのですが、現在クライアント(Fm13)の方で共有ファイルが見えません。どなたかご教示いただけませんでしょうか。
$sth = $dbh->prepare('SELECT name, colour, calories FROM fruit WHERE calories < :calories AND colour = :colour'); $sth->bindParam(':calories', $calories, PDO::PARAM_INT); $sth->bindParam(':colour', $colour, PDO::PARAM_STR, 12); $sth->execute(); 上記ではなく $sth = $dbh->prepare('SELECT name, colour, calories FROM fruit WHERE calories < ? AND colour = ?'); $sth->execute(array($calories,$colour)); のようにbindParamやbindValueを使わない場合は危険はあるのでしょうか？ ご教示頂けますと幸いです。 宜しくお願いいたします。
現在、サーバー内には、 ■wordpress ■メールマガジン の２つのシステムが入っております。 システム上から確認したときは文字化けが起こっていないのですが、 PHPadminの画面から確認すると、メールマガジンのデータのみ 日本語が文字化けしておりました。 文字化けの原因は、照合順序がlatin1_swedish_ciのためではないかと、 考えております。 エクスポートを試しても、文字化けしておりました。 照合順序をutf8_general_ciに変更したり、エンコードを変えてみたりも試してみましたが、うまくいきません。 文字化けを直す手段はあるのでしょうか。
一覧画面と検索画面を一緒にしています 一覧画面は10件表示にし、テキストになにも入力されてなかったらデータを全件表示したいです また、1 l　2 l 3 のようにページを表示し、また何件中何件目データですと表示したいです <!--一覧画面 index.php--> <html> <head> <title>一覧画面</title> </head> <body> <br><br> <blockquote> 一覧画面 <br><br> <?php if ($_GET) { // データがGETされていたら $event = isset($_GET['event']) ? $_GET['event'] : ''; // 取得 if (isset ($_GET['page'])==false) { $page=0; } else { //そうでなければpageパラメータの値をpage変数にセット $page = $_GET['page']; } } ?> <?php $pdo = new PDO("mysql:dbname=db_test;host=localhost", "root", "admin"); $name=isset($_GET['name'])?$_GET['name']:""; $sql ="select * from tbl_test where "; $sql.="`氏名` like concat('%',?,'%') "; $sql.="or `住所` like concat('%',?,'%') "; $sql.= " limit " . $page*10 . ", 10" ; $stmt = $pdo->prepare( $sql); $stmt->execute(array($name,$name)); $count = $stmt->rowCount(); if($count>0){ print "<table border=1>" ; print "<tr>"; print "<th>番号</th>"; print "<th>氏名</th>"; print "<th>住所</th>"; print "<th>操作</th>"; while($row = $stmt->fetch(PDO::FETCH_ASSOC)){ print "</tr>"; $ID = htmlspecialchars($row['番号']); $NAME = htmlspecialchars($row['氏名']); $ADDR = htmlspecialchars($row['住所']); echo "<tr> <td>$ID</td> <td>$NAME</td> <td>$ADDR</td> <td><a href='edit.php?番号=$ID'>修正</a> <a href='delete.php?番号=$ID'>削除</a></td></tr>"; }; print "</table>" ; }else{ print "該当するデータがありません"; } ?> <br><br><br> <form action = "index.php" method="GET"> <input type="hidden" name="event" value="find"> <input type="text" name="name"style ="font-size:20px;width: 400px; height: 40px"> <input type="submit" value="検索" style ="font-size:20px;width: 100px; height: 40px"> </form> <br><br> <form action = "regist.php" method="GET"> <input type="hidden" name="event" value="regist"> <input type = "submit" value = "新規登録" style ="font-size:20px;width: 100px; height: 40px"> </form> <input type="hidden" name="page" value="0"> </blockquote> </body> </html> 検索のテキストボックスが空だったら全件表示したいのですが今１０件しか出ません limitの書く場所が原因でしょうか？ またこのように一覧画面と検索結果画面が一緒じゃまずいですかね？ 検索結果を別ウインドウじゃなく自分に返したいと思いこのやり方にしたのですがよくないですか？
mysqlで検索フォームを作成しています 入力してデータに該当したら検索結果が出るのですが 該当者がいないときはテーブルの表のみ出力してしまう 該当者なしと入力フォーム側に表示したいです また　''''''を入力するとSQLになるのですが mysql_real_escapeを使えば出なくなります どうしたらいいですか <html> <body> <?php //データベースに接続 if (!$con = mysql_connect("localhost", "root", "admin")) { echo "接続エラー" ; exit ; } //データベースを選択 if (!mysql_select_db("db_test", $con)) { echo "データベース選択エラー" ; exit ; } //フォームで送られてきた条件を元にSELECT文を作成 $sql = "select * from tbl_test where (氏名 LIKE '%{$_GET['name']}%') or (住所 LIKE '%{$_GET['name']}%')"; //SELECT文を実行 if (!$res = mysql_query($sql)) { echo "SQLエラー<BR>" ; exit ; }else{ } //検索結果表示 echo "<table border=1>" ; echo "<tr> <th>番号</th> <th>氏名</th> <th>住所</th> <th>操作</th> </tr>" ; while($row = mysql_fetch_array($res)) { $ID = htmlspecialchars($row['番号']); $NAME = htmlspecialchars($row['氏名']); $ADDR = htmlspecialchars($row['住所']); echo "<tr> <td>$ID</td> <td>$NAME</td> <td>$ADDR</td> <td><a href='edit.php?番号=$ID'>修正</a> <a href='delete.php?番号=$ID'>削除</a></td></tr>"; if ($_GET) { // データがGETされていたら $event = isset($_GET['event']) ? $_GET['event'] : ''; // 取得 } } echo "</table>" ; //結果セットの開放 mysql_free_result ($res) ; //データベースから切断 mysql_close($con) ; ?> </body> </html>
mysqlのfulltextを使用した全文検索で引っかからないワードがあって困っています。 例えば、keywordsテーブルにwordsカラムに以下のレコードがあったとします。 -------------- ジェフ トム ram -------------- このとき、下記のsqlを発行してもジェフやramが引っかかりません。 SELECT * FROM `keywords` WHERE MATCH(words) AGAINST('ジェ*' IN BOOLEAN MODE); SELECT * FROM `keywords` WHERE MATCH(words) AGAINST('ram*' IN BOOLEAN MODE); （※以下は引っかかる SELECT * FROM `keywords` WHERE MATCH(words) AGAINST('トム*' IN BOOLEAN MODE);　） もちろん、カラム定義には、alter table keywords add fulltext(words)をしています。 またFull-Text Stopwordsもデフォルトのままです。 どんな原因があるか分かる方いらっしゃいますでしょうか？ 以上、よろしくお願い致します。
ACCESSのエクセルへのエクスポートについて お世話になりあます。 既存エクセルにACCESSのDoCmdを使用してエクスポートしようと考えています。 エクスポート先は既存エクセル(セルに数式あり)です。 DoCmd.TransferSpreadsheet acExport, SpreadsheetType, TableName, FileName , True,SheetName という分を作り実行しましたが、「ワークシートのセルが削除できません」と出てしまい エクスポートできません。 ヘルプを見ると数式が含まれていると出来ないと書いてありました。 数式を消さないと出来ないのでしょうか。 お手数ですが、分かる方おられましたら教えて下さい。
Windows server2012へSQL SERVER2008 R2 EXPRESSをインストールすると、「このプログラムには互換性の問題があります」（2008 and 2008）と表示されます。 色々調べて、Windows Server2012へ.NETFramework3.5はインストールしたのですが、まだ同じメッセージでSQL SERVER2008 R2がインストールできません。 対応策をご存じの方は、教えてください お願いします
MySQLでデータの表示を行っています 10件ずつ表示し、１１件からは２ページ目に表示したいです サイトや本を見ながらデータ表示と次の10件のリンクは表示されるよう自力で頑張ったのですが 次の１０件を押してもデータが変わらず１件目から１０件目のままです どこが違うか教えてもらえますか。 どうコードを入力するか教えてくれたらありがたいです 一覧　ta2.phpです <html> <body> <form action = "ta2.php" method="GET"> <input type="hidden" name="page" value="0"> </form> <?php //データベースに接続 if (!$con = mysql_connect("localhost", "root", "admin")) { echo "接続エラー" ; exit ; } //データベースを選択 if (!mysql_select_db("db_test", $con)) { echo "データベース選択エラー" ; exit ; } //LIMITを使ったSELECT文を作成 $sql = "select * from tbl_test" ; $sql.= " limit " . $page*10 . ", 10" ; //SQL実行 if (!$res = mysql_query($sql)) { echo "SQLエラー<BR>" ; exit ; } //検索結果表示 echo "<table border='1'> <tr> <th>番号</th> <th>氏名</th> <th>住所</th> <th>操作</th> </tr>"; while($row = mysql_fetch_array($res)) { $ID = htmlspecialchars($row['番号']); $NAME = htmlspecialchars($row['氏名']); $ADDR = htmlspecialchars($row['住所']); echo "<tr> <td>$ID</td> <td>$NAME</td> <td>$ADDR</td> <td><a href='edit.php?番号=$ID'>修正</a> <a href='delete.php?番号=$ID'>削除</a></td></tr>"; header('content-type: text/html; charset="utf-8"'); if ($_GET) { // データがGETされていたら $page = isset($_GET['page']) ? $_GET['page'] : ''; // 取得 } } $sql = "select count(*) from tbl_test " ; if (!$res = mysql_query($sql)) { echo "SQLエラー<BR>" ; exit ; } $row = mysql_fetch_array($res) ; $cnt = $row[0] ; //ページ表示 if(!$cnt > 10) echo ceil($cnt / 10), "ページの中の", $page + 1, "ページ目を表示<br>" ; //前の10件 if ($page != 0) { echo "<a href = ta2.php?page= $page>" ; echo "&lt 前の10件" ; } //次の10件 if (($page + 1)*10 < $cnt) { echo "<a href = ta2.php?page= $page>" ; echo " 次の10件 " ; } //結果セットの開放 mysql_free_result ($res) ; //データベースから切断 mysql_close($con) ; ?> </table> </body> </html>
お世話になります。 前回立てたトピック（http://oshiete.goo.ne.jp/qa/8565634.html）でサンプルデータにミスがあったため、立て直しです。 ※顧客＆商品ごとの本申込という文字列が含まれる最新データを取得したい ※商品名の長さは変動します（商品名には実際は番号はありません） ※MySQL5です。 どうぞお知恵をお貸しください。 ■テーブルデータ CREATE TABLE IF NOT EXISTS `TABLE1` ( `SEQ_ID` mediumint(8) NOT NULL AUTO_INCREMENT COMMENT 'シーケンスID', `TO_USER_NM` varchar(128) DEFAULT NULL COMMENT '顧客', `MAIL_TITLE` varchar(256) DEFAULT NULL COMMENT '商品', `SEND_TIME` datetime NOT NULL COMMENT '購入日時', PRIMARY KEY (`SEQ_ID`) ); INSERT INTO `TABLE1` (`SEQ_ID`, `TO_USER_NM`, `MAIL_TITLE`, `SEND_TIME`) VALUES (1 , '顧客A', '『商品1』仮申込', '2014-03-01 13:07:43'), (2 , '顧客C', '『商品1』仮申込 / 変更1', '2014-03-02 10:06:54'), (3 , '顧客E', '『商品1』仮申込', '2014-03-03 10:06:54'), (4 , '顧客E', '『商品1』本申込', '2014-03-04 13:33:51'), (5 , '顧客B', '『商品1』本申込', '2014-03-05 14:58:41'), (6 , '顧客A', '『商品1』本申込 / 変更1', '2014-03-06 16:42:56'), (7 , '顧客D', '『商品1』本申込 / 変更2', '2014-03-07 17:27:33'), (8 , '顧客C', '『商品1』本申込 / 変更1', '2014-03-08 13:56:29'), (9 , '顧客A', '『商品2』仮申込', '2014-03-09 18:44:05'), (10, '顧客A', '『商品2』仮申込 / 変更1', '2014-03-10 10:43:14'), (11, '顧客C', '『商品1』本申込 / 変更2', '2014-03-11 08:51:02'), (12, '顧客C', '『商品1』本申込 / 変更3', '2014-03-12 20:33:39'), (13, '顧客A', '『商品2』本申込', '2014-03-14 18:52:44'), (14, '顧客B', '『商品1』仮申込', '2014-03-15 16:13:47'), (15, '顧客B', '『商品1』本申込 / 変更3', '2014-03-16 21:07:35'), (16, '顧客B', '『商品1』本申込 / 変更4', '2014-03-18 21:07:34'), (17, '顧客B', '『商品3』仮申込', '2014-03-19 21:42:46'), (18, '顧客B', '『商品3』本申込', '2014-03-20 22:14:10'), (19, '顧客A', '『商品2』本申込 / 変更1', '2014-03-21 23:44:06'), (20, '顧客A', '『商品1』本申込 / 変更5', '2014-03-22 08:22:59'), (21, '顧客A', '『商品2』仮申込', '2014-04-01 13:07:43'), (22, '顧客A', '『商品2』本申込 / 変更2', '2014-04-02 10:06:54'), (23, '顧客B', '『商品2』仮申込', '2014-04-03 10:06:54'), (24, '顧客B', '『商品2』仮申込 / 変更1', '2014-04-04 13:33:51'), (25, '顧客B', '『商品2』本申込', '2014-04-05 14:58:41'), (26, '顧客F', '『商品1』仮申込', '2014-04-06 16:42:56'), (27, '顧客F', '『商品1』本申込', '2014-04-07 17:27:33'), (28, '顧客G', '『商品3』仮申込', '2014-04-08 13:56:29'), (29, '顧客F', '『商品1』本申込 / 変更1', '2014-04-09 18:44:05'), (30, '顧客G', '『商品3』本申込', '2014-04-10 10:43:14'), (31, '顧客A', '『商品1』本申込 / 変更6', '2014-04-11 08:51:02'), (32, '顧客A', '『商品2』本申込 / 変更3', '2014-04-12 20:33:39'), (33, '顧客F', '『商品1』本申込 / 変更2', '2014-04-14 18:52:44'), (34, '顧客C', '『商品3』仮申込', '2014-04-15 16:13:47'), (35, '顧客C', '『商品3』本申込', '2014-04-16 21:07:35'), (36, '顧客H', '『商品1』仮申込', '2014-04-18 21:07:34'), (37, '顧客H', '『商品1』本申込', '2014-04-19 21:42:46'), (38, '顧客H', '『商品1』本申込 / 変更1', '2014-04-20 22:14:10'), (39, '顧客E', '『商品2』仮申込', '2014-04-21 23:44:06'), (40, '顧客E', '『商品2』仮申込 / 変更1', '2014-04-22 08:22:59'); ■取得したいデータ 38, '顧客H', '『商品1』本申込 / 変更1', '2014-04-20 22:14:10' 35, '顧客C', '『商品3』本申込', '2014-04-16 21:07:35' 33, '顧客F', '『商品1』本申込 / 変更2', '2014-04-14 18:52:44' 32, '顧客A', '『商品2』本申込 / 変更3', '2014-04-12 20:33:39' 31, '顧客A', '『商品1』本申込 / 変更6', '2014-04-11 08:51:02' 30, '顧客G', '『商品3』本申込', '2014-04-10 10:43:14' 25, '顧客B', '『商品2』本申込', '2014-04-05 14:58:41' 18, '顧客B', '『商品3』本申込', '2014-03-20 22:14:10' 16, '顧客B', '『商品1』本申込 / 変更4' '2014-03-18 21:07:34' 12, '顧客C', '『商品1』本申込 / 変更3' '2014-03-12 20:33:39' 7 , '顧客D', '『商品1』本申込 / 変更2' '2014-03-07 17:27:33' 4 , '顧客E', '『商品1』本申込', '2014-03-04 13:33:51'
先ほども質問したのですが再度質問させていただきます mysql limitページ分割を行っていてエラーは消せたのですが今度 SQLエラーになり出来ません 前の人が質問したのを参考にしてつくったのですがうまくいかず困っています 検索結果を10件ずつ表示して googleみたいに 1l 2l 3 みたいな感じやりたいです <body> <?php error_reporting(E_ALL ^ E_NOTICE); //データベースに接続 if (!$con = mysql_connect("localhost", "root", "admin")) { echo "接続エラー" ; exit ; } //データベースを選択 if (!mysql_select_db("db_test", $con)) { echo "データベース選択エラー" ; exit ; } //LIMITを使ったSELECT文を作成 $sql = "select * from tbl_test where (氏名 LIKE '%{$_GET['name']}%') or (住所 LIKE '%{$_GET['name']}%')"; $sql = "limit" . $page * 10 . ", 10" ; //SQL実行 if (!$res = mysql_query($sql)) { echo "SQLエラー<BR>" ; exit ; } //検索結果表示 echo "<table border=1>" ; echo "<tr> <th>番号</th> <th>氏名</th> <th>住所</th> <th>操作</th> </tr>" ; while($row = mysql_fetch_array($res)){ $ID = htmlspecialchars($row['番号']); $NAME = htmlspecialchars($row['氏名']); $ADDR = htmlspecialchars($row['住所']); echo "<tr> <td>$ID</td> <td>$NAME</td> <td>$ADDR</td> <td><a href='edit.php?番号=$ID'>修正</a> <a href='delete.php?番号=$ID'>削除</a></td> </tr>"; //検索条件に該当する全データの件数取得 $sql = "select count(*) from tbl_test " ; $sql = "where (氏名 LIKE '%{$_POST['name']}%') or (住所 LIKE '%{$_POST['name']}%')"; if (!$res = mysql_query($sql)) { echo "SQLエラー<BR>" ; exit ; } $row = mysql_fetch_array($res) ; $cnt = $row[0] ; //ページ表示 if(!$cnt > 10) echo ceil($cnt / 10), "ページの中の", $page + 1, "ページ目を表示<br>" ; //前の10件 if ($page_num != 0) { echo "<a href = find.php?name=".$name. ". $page -1.>" ; echo "&lt 前の10件"; } //次の10件 if (($page_num + 1)*10 < $cnt) { echo "<a href = find.php?name=".$name. ". $page +1.>" ; echo " 次の10件 &g</a>t" ; } //結果セットの開放 mysql_free_result ($res) ; //データベースから切断 mysql_close($con) ; } ?> </body> </html>
前の人が質問したのを参考にしてつくったのですがうまくいかず困っています 検索結果を10件ずつ表示して googleみたいに 1l 2l 3 みたいな感じやりたいです <html> <body> <?php //データベースに接続 if (!$con = mysql_connect("localhost", "root", "admin")) { echo "接続エラー" ; exit ; } //データベースを選択 if (!mysql_select_db("db_test", $con)) { echo "データベース選択エラー" ; exit ; } //LIMITを使ったSELECT文を作成 $sql = "select * from tbl_test where (氏名 LIKE '%{$_POST['name']}%') or (住所 LIKE '%{$_POST['name']}%')"; $sql = "limit" . $page_num*10 . ", 10" ; //SQL実行 if (!$res = mysql_query($sql)) { echo "SQLエラー<BR>" ; exit ; } //検索結果表示 echo "<table border=1>" ; echo "<tr> <th>番号</th> <th>氏名</th> <th>住所</th> <th>操作</th> </tr>" ; while($row = mysql_fetch_array($res)){ $ID = htmlspecialchars($row['番号']); $NAME = htmlspecialchars($row['氏名']); $ADDR = htmlspecialchars($row['住所']); echo "<tr> <td>$ID</td> <td>$NAME</td> <td>$ADDR</td> <td><a href='edit.php?番号=$ID'>修正</a> <a href='delete.php?番号=$ID'>削除</a></td> </tr>"; //検索条件に該当する全データの件数取得 $sql = "select count(*) from tbl_test " ; $sql = "where (氏名 LIKE '%{$_POST['name']}%') or (住所 LIKE '%{$_POST['name']}%')"; if (!$res = mysql_query($sql)) { echo "SQLエラー<BR>" ; exit ; } $row = mysql_fetch_array($res) ; $cnt = $row[0] ; //ページ表示 if(!$cnt > 10) echo ceil($cnt / 10), "ページの中の", $page_num + 1, "ページ目を表示<br>" ; //前の10件 if ($page_num != 0) { echo "<a href = find.php?name=",$name, ", $page_num -1.">" ; echo "&lt 前の10件"; } //次の10件 if (($page_num + 1)*10 < $cnt) { echo "<a href = find.php?name=",$name, ", $page_num +1.">" ; echo " 次の10件 &g</a>t" ; } //結果セットの開放 mysql_free_result ($res) ; //データベースから切断 mysql_close($con) ; ?> </body> </html> Parse error: syntax error, unexpected '前の10件' (T_STRING), expecting ',' or ';' というエラーが出て自分なりにバグを消しているのですがまだエラーが消えずに困っています
■DBサーバ Windows Server 2003 Oracle 9i R2(9.2.0.1.0) ■アプリケーション動作環境(複数OS) Windows Server 2012 Std(64bit) Windows 7(64bit) Windows 7(32bit) Windows XP(32bit) VB.net(.Net Framework 4.0)(32bitアプリ) 上記のアプリケーション動作環境からOracle 9iR2へODP.NETを使って 接続したいのですが、利用可能なODP.NETのバージョン(何bit版)はど れでしょうか。
お世話になります。 DBからSQLでキーワードによる検索をかけるときですが、 二つ以上のワードがあるときに、一つのキーワードがほかのキーワードと かぶってしまう場合、例えば゛、『あいうえお』と『いうえ』等で絞り込むと、 結果的に『あいうえお』が含まれるものだけが該当しますが、これを、 『あいうえお』を含み、更にそれ以外にも『いうえ』が含まれるものを 絞り込むには、どうすればよいでしょうか。 つまり、『あいうえお』のみしか含まれないものは該当しないようにする方法です。 現在のSQLは、 (SELECT * FROM xxxx WHERE tablename LIKE '%あいうえお%' AND tablename LIKE '%いうえ%') のような感じです。 使用しているDBは、MySQL、SQLiteです。 何卒よろしくお願いいたします。
こんにちは質問させてください。 商品が登録されているテーブル A に以下のカラムがあるとします。 id(int),　　name(varcahr),　　dt(datetime) id　　　には 店を識別す固有の番号がふってあり、 name　には 商品名、　 dt　　　には商品を登録した日付が入っているものとします。 やりたいことは ”id が 「１」 である全商品数” と ”今月登録された商品の数” を出力したいのです。 id が 1 である商品の数は以下のSQLで取り出せます。 SELECT　COUNT(*)　FROM 　(　SELECT　*　FROM　A　WHERE　A.id='1'　)　AS tbl1 id が 1 で 今月登録された商品の数は以下のSQLで取り出せます。 SELECT　COUNT(*)　FROM 　(　SELECT　*　FROM　A　 　　 WHERE　A.dt　BETWEEN　DATE(　 　　　　　DATE_SUB(　NOW(),　INTERVAL　DAYOFMONTH(　NOW()　)-1　DAY)　) AND 　　　　　LAST_DAY(　NOW()　)　AND　A.id='1'　)　AS　tbl1 これをひとつのSQLにまとめるにはどうしたらいいのでしょうか…。 宜しくお願い致します。
お世話になります。 以下のテーブル1からサンプル1のようなデータを抽出したいのですが、SQLはどのように書いたらよいでしょうか。 ・顧客と商品ごとに購入日時が最新のデータを取得 ・商品は左側の番号が同じ場合は購入日が最新のデータのみ抽出したい データベースは　MySQL5　です。 よろしくお願いいたします。 ●テーブル1 顧客　　商品　　購入日時 --------------------------------- 　A　　2-2　　2014-04-23 08-00-00 　A　　2-1　　2014-04-21 08-00-00 　B　　2-3　　2014-04-20 09-00-00 　B　　2-2　　2014-04-18 06-00-00 　B　　2-1　　2014-04-15 05-00-00 　A　　1-3　　2014-04-12 08-00-00 　A　　1-2　　2014-04-10 04-00-00 　C　　2-2　　2014-04-09 05-00-00 　C　　2-1　　2014-04-08 06-00-00 　C　　1-2　　2014-04-07 08-00-00 　C　　1-1　　2014-04-06 05-00-00 　A　　1-1　　2014-04-05 02-00-00 　B　　1-2　　2014-04-04 02-00-00 　B　　1-1　　2014-04-03 01-00-00 ●サンプル1 顧客　　商品　　購入日時 --------------------------------- 　A　　2-2　　2014-04-23 08-00-00 　B　　2-3　　2014-04-20 09-00-00 　A　　1-3　　2014-04-12 08-00-00 　C　　2-2　　2014-04-09 05-00-00 　C　　1-2　　2014-04-07 08-00-00 　B　　1-2　　2014-04-04 02-00-00
PHPでデータの登録を行っています いろいろ調べながら試行錯誤しています 登録できる条件があります 1.番号が重複じゃない 2.番号、氏名、住所が空白でない場合です 現状 1.2両方できていてデータも追加されるのですが、 ２の条件、空白だった場合エラーメッセージを表示したいのですが表示されず困っています <?php $err = ""; if(empty($_POST['ID'])) $err.= "<br><br>番号入力してください。<br><br>"; if(empty($_POST['NAME'])) $err.= "<br><br>氏名入力してください。<br><br>"; if(empty($_POST['ADDR'])) $err.= "<br><br>住所を入力してください。<br><br>"; if(empty($err)) { $pdo = new PDO("mysql:dbname=db_test;host=localhost", "root", "****"); $st = $pdo->prepare("INSERT INTO tbl_test VALUES(?,?,?)"); $st->execute(array($_POST['ID'], $_POST['NAME'],$_POST['ADDR'])); if($st->rowCount()>0) { header('Location: http://localhost/top.php'); }else{ print "既に登録している番号です"; } echo $err; } ?> 重複したときは"既に登録している番号です"と表示されるのですが、空白だった場合$errが表示されません
以下のSQL文を実行すると CREATE TABLE if not exists table_A ( idint(11) not null auto_increment, company_idint(11) not null, created_atdatetime NOT NULL, updated_attimestamp NOT NULL, PRIMARY KEY (id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; CREATE TABLE if not exists table_B ( idint(11) not null auto_increment, from_idint(11) not null, company_idint(11) not null, created_atdatetime NOT NULL, updated_attimestamp NOT NULL, PRIMARY KEY (id) FOREIGN KEY (from_id) REFERENCES table_A(id) ON DELETE CASCADE ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; 上記を実行すると以下のエラーがでます。 #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FOREIGN KEY (from_id) REFERENCES table_A(id) ON DELETE CASCADE ) ENGINE=Inn' at line 8 解決方法をご存知の方はご教示頂けますと幸いです。 宜しくお願いいたします。
SQLサーバー2008を使用しています。 SQL文のwhere句で 直前のアイテムの1回以上の繰り返しを意味するメタ文字を教えてください。 Postgresqlであれば、0回以上だと「*」、1回以上だと「+」だと思うのですが、 SQLサーバーだと何にあたるのでしょうか？ ぐぐって検索してみたのですが、見つかりませんでした。 どうかよろしくお願いいたします。
データの新規登録を行っているのですが 番号が重複しないでまたデータがすべて入力されたらデータの追加を行いたいのですが エラーが出て対処できずに困っています 下記のエラーがでます Parse error: syntax error, unexpected end of file in C:\WWW\test\htdoes\insert.php on line 20 20行目は一番下の行です <html> <body> <?php $pdo = new PDO("mysql:dbname=db_test;host=localhost", "root", "admin"); if($st->rowCount()>0){ if ($_POST['ID'] != '' && $_POST['NAME'] != '' && $_POST['ADDR'] != ''){ $st = $pdo->prepare("insert ignore into tbl_test values(?,?,?)"); $st->execute(array($_POST['ID'], $_POST['NAME'],$_POST['ADDR'])); header('Location: http://localhost/top.php'); }else{ print データ未入力の場所があります; } }else{ print "既に登録している番号です"; ?> </body> </html>
tbl_aとtbl_bから、tbl_cを作りたいのですが どのようなsql文を書けば良いでしょうか？ アドバイス頂けると嬉しいです。よろしくお願い致します。 テーブル：tbl_a ----------------- code1,code2,name ----------------- 001,a,あ 002,a,あ 003,a,あ 004,a,あ 005,b,い 006,b,い 007,b,い 008,c,う 009,c,う 010,c,う 011,c,う 012,d,え 013,d,え 014,d,え テーブル：tbl_b ----------------- code1,point ----------------- 003,10 004,2 008,10 009,5 011,20 テーブル：tbl_c ----------------- code2,name,point ----------------- a,あ,2 b,い, c,う,5 d,え,
３つのテーブルを連携した並び替えのSELECT文について教えて下さい。 例えば次の3つのテーブルがあるとします。 COOK_TBL ---------------- COOK_NAME パスタ パスタ グラタン オムライス グラタン カレー ZAIRYO_TBL --------------- COOK_NAME ZAIRYO_NAME グラタン　 鶏肉 オムライス 卵 オムライス 玉ねぎ パスタ　　 卵 パスタ　　 麺 COOK_KIOKU_TBL --------------- COOK_NAME オムライス グラタン COOK_TBLのCOOK_NAMEでグルーピングしたものに対し、ZAIRYO_TBLのCOOK_NAMEに存在するものは全て抽出し、 COOK_KIOKU_TBLのCOOK_NAMEとCOOK_TBLのCOOK_NAMEと一致するレコードは頭の方（COOK_KIOKU_TBLのCOOK_NAMEのレコード順）に並び替えられるようにしたいです。 得たい結果は次の通りです。 COOK_TBL ------------- COOK_NAME オムライス グラタン パスタ どうしても分かりません。 助けて下さい。 os: windows 7 eclipse: Version: 4.2.0
業務システムを自社で構築、メンテをしていますが、ソースの中の条件文などに社内コードを直に書くのは間違いでしょうか?保守性を考え、そういったものは全てDBのフィールドを追加して管理すべきと言う人もいますが、個人的には頻繁に条件の変更があるのならば(例えば品目コード等)DBで管理すべきでしょうが、なんでもかんでもDBで管理するのは抵抗があります。 皆様はどのようにされているのでしょうか? また、DBで管理するデメリットがあれば教えていただけますでしょうか？
すいません1つ質問があります。 通常であれば、　mysql> とあってコマンドを入力するのですが、 たまに、"> となってしまい何も受け付けないときがあります。 \c　でキャンセルも出来ません。 どうしてこうなるのかもわからないです。 なぜこうなるのか？　そしてこの問題を解決するにはどうすればよいかご教授頂けると幸いです。 ネットで調べましたがこの件について触れているページがありませんでした。 よろしくお願いいたします。
よろしくお願いいたします。 PostgrSQLでPosGIS対応にし、テーブルにGeomカラムを作り、そこにPoint型で地理情報をインサートしました。 次に、特定の範囲に、何件Geomカラムの位置が入っているのかを調べようと思い、次のようなSQLを書きました。 SELECT * FROM hogetable WHERE ST_Within(geom, ST_GeomFromText('POLYGON((10 10, 10 20, 20 20, 20 10))',4326)); これを実行すると、POLYGONのところが、パースエラーになります。どこがおかしかったのでしょうか？ Postgresqlは、あまり触ったことがないので、変なことを書いてしまっていたらごめんなさい。 環境は、CentOS6.3 64bit Postgresql9.3 Postgis2.1です。 よろしくお願いいたします。
すいません1つ質問があります。 こちらのサイトでCSVのファイルのインポート方法を勉強していますが、下記の方法だとあらかじめ、データベースが格納されているフォルダにCSVを置いてある前提でこのやり方をやります。 LOAD DATA INFILE "T01Prefecture.csv" INTO TABLE T01Prefecture FIELDS TERMINATED BY "," LINES TERMINATED BY "\r\n"; 僕が知りたいのは、例えば、 C:\Users\Ken\Desktop\T01Prefecture.csv ここに置いてあるCSVを指定してインポートしたいと考えています。 そのやり方がどうもこのパスを書くだけでは出来ないです。 どなたかやり方を教えて頂けますか？ 僕が書いたのは下記の通りです。 LOAD DATA INFILE "C:\Users\Ken\Desktop\T01Prefecture.csv" INTO TABLE T01Prefecture FIELDS TERMINATED BY "," LINES TERMINATED BY "\r\n"; よろしくお願いいたします。
入力フォームに入力された番号が登録されてなかったら新規登録できるようにしたい INSEPT IGNORE INTOで主キーを無視するのではなく重複したらエラーメッセージを出しユーザにもう一度入力させるようにする 新規登録フォーム <html> <head><title>新規登録</title></head> <body> <blockquote> <form action = "insert.php" method = "POST"> <br><br>登録画面<br><br> すべての項目入力してください<br> 番号<input type="number" name = "ID"> (一覧画面にない番号を入力してください) <br> <br>氏名<input type="text" size = "50" name = "NAME"><br><br> 住所<input type="text" size = "130" name = "ADDR"><br><br> <a href="http://localhost/top.php"> <input type = "submit" value = "登録する" style ="font-size:20px; width: 100px; height: 40px"></A> <a href="http://localhost/top.php"> <input type = "button" value = "一覧に戻る" style ="font-size:20px; width: 100px; height: 40px"></A> </body> </blockquote> </form> </body> </html> 登録を実行するフォーム <?php $con=mysqli_connect("localhost","root","admin","db_test"); // Check connection if (mysqli_connect_errno()) { echo "Failed to connect to MySQL: " . mysqli_connect_error(); } if ($_POST['ID'] != '' && $_POST['NAME'] != '' && $_POST['ADDR'] != '') { $id = mysqli_real_escape_string($con, $_POST['ID']); $name = mysqli_real_escape_string($con, $_POST['NAME']); $addr = mysqli_real_escape_string($con, $_POST['ADDR']); $sql="INSERT INTO tbl_test (番号, 氏名, 住所) VALUES ('$id','$name','$addr')"; if (!mysqli_query($con,$sql)) { die('Error: ' . mysqli_error($con)); } header('Location: http://localhost/top.php'); exit(); } else { ?> <html> <body> <blockquote> <br><br>データが未入力の箇所があります。すべてデータを入力してください <br><br><br> <a href="http://localhost/regist.php"> <INPUT TYPE = "button" VALUE = "登録画面に戻る" style ="font-size:20px; width: 140px; height: 40px"></A> <br><br><br> <A HREF="http://localhost/top.php"> <INPUT TYPE = "button" VALUE = "一覧に戻る" style ="font-size:20px; width: 140px; height: 40px"></A> </blockquote> </body> </html> <?php } mysqli_close($con); ?> どういう風にselect文を書けばいですか？
「ストアドファンクションの再帰呼び出し」はできないのでしょうか。 hoge関数をhoge関数の中で呼び出しています。 hoge関数では、条件に当てはまらないと第三引数を、 編集して再帰呼出しをしています。 再帰呼出しする条件を引数に設定して実行すると、以下の実行結果(ERROR)が表示されます。 ＜実行結果＞ mysql> select hoge('7','1234','1234567891012'); ERROR 1424 (HY000): Recursive stored functions and triggers are not allowed. よろしくお願いします。
こんにちは。 現在 oracle11を使用しています。 作業時間 を　文字型で '01:45' として格納したデータを Date型の'1.75'というデータに変換したいのですが、どうしたらできるでしょうか。 ご教授ください。
番号　int プライマリーキ- 氏名　varchar 住所 varchar データベースで入力フォームから新規登録をしたいのですが Duplicate entry '11' for key 'PRIMARY' 11はすでに存在していると出ます オートナンバー型に変えずに"すでに登録されている番号です"というエラーメッセージを出し、もう一度登録画面に戻るしたいのですが、 try文で例外処理させれば出来ますか？ また出来るのであればどういう風に記述するか教えてもらえますか？
初めての質問になります。 以下のようなテーブルで、dataカラムにカンマ区切りのデータを保存しているのですが、こちらはgroup byやcount等を使ってSQL一発で集計結果を取得できるのでしょうか？ SELECT count(*) FROM TEST WHERE FIND_IN_SET('1', data)で1から順番に取得は出来るのですが、数が多いとちょっといかがなものかと思い、質問させていただきました。 環境：mysql5.5 ------------ ｜data ------------ ｜1,2,3 ------------ ｜1,2,10 ------------ ｜1,2,3,10 ------------ 期待する結果は以下のような感じです。 1｜3 --------- 2｜3 --------- 3｜2 --------- 10｜2
MySqlバージョン：5.1.61で、下記のSQLを実行すると、 １件しかデータが無いにも関わらず、EXPLAINの結果で 「Extra: Using where; Using filesort」が発生します。 ---------------- CREATE TABLE IF NOT EXISTS tbl ( user int(11) NOT NULL, item int(11) NOT NULL, prm1 int(11) NOT NULL, prm2 int(11) NOT NULL, prm3 int(11) NOT NULL, PRIMARY KEY (user,item) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO tbl (user,item,prm1,prm2,prm3) VALUES (1,1,10,10,10); EXPLAIN SELECT * FROM tbl WHERE user=1 ORDER BY prm1; EXPLAIN SELECT * FROM tbl WHERE user=1 ORDER BY prm2; EXPLAIN SELECT * FROM tbl WHERE user=1 ORDER BY prm3; ---------------- ORDER BY句で使用する項目(prm[n])は10項目以上になりますので 10件を超える複合インデックスを張る事は避けたいと考えております。 また、tbl全体のデータは1億件、1userあたり100～200件を想定しています。 複合インデックスを使用せず「Using filesort」を 発生させなくする事はできるのでしょうか？
下記のような＜検索対象データ＞から、＜取得したいデータ＞を取得するSQLがわからず困っています。 ご教授下さい。 【条件】 同一[ID]で[NO]が最大のレコードのみを取得する。 ＜検索対象データ＞ IDNODATA ---------------- AA1あいうえ AA2あいう AA3あい BB1かきく BB2かき CC1さしす CC2さし ＜取得したいデータ＞ IDNODATA ---------------- AA3あい BB2かき CC1さし よろしくお願いします。
一覧画面に更新ボタンを作成しました 更新ボタンを押すとkoushin_input.phpにデータを渡し入力フォームを表示され番号、氏名、住所が選択されたデータが表示されるようにしたいのでが更新ボタンを押しても下記のように出ます string(64) "SELECT `番号`,`氏名`,`住所` FROM tbl_test where `番号`=0" bool(false) データが削除されています ソースコードはtop.php 一覧画面です <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <title>一覧画面</title> </head> <body> <BLOCKQUOTE> <BR>一覧画面<BR><BR> <?php $con=mysqli_connect("localhost","root","admin","db_test"); if(isset($_GET["del"]) and isset($_GET["id"]) and $_GET["del"]==1){ $id=(int) $_GET["id"]; $result = mysqli_query($con,"DELETE FROM tbl_test where `番号`={$id}"); } // Check connection if (mysqli_connect_errno()) { echo "Failed to connect to MySQL: " . mysqli_connect_error(); } $result = mysqli_query($con,"SELECT * FROM tbl_test"); echo "<table border='1'> <tr> <th>番号</th> <th>氏名</th> <th>住所</th> </tr>"; while($row = mysqli_fetch_array($result)) { echo "<tr>"; echo "<td>" . $row['番号'] . "</td>"; echo "<td>" . $row['氏名'] . "</td>"; echo "<td>" . $row['住所'] . "</td>"; echo "<form action=koushin_input.php method=get>"; echo "<td><input type=submit value=更新></td>"; echo "</form>"; echo "<td><a href=\"".$_SERVER["SCRIPT_NAME"]."?del=1&amp;id=".$row['番号']."\">削除</a></td>"; echo "</tr>"; } echo "</table>"; mysqli_close($con); ?> <BR><BR><BR> <A HREF="http://localhost/regist.php"> <INPUT TYPE = "SUBMIT" VALUE = "新規登録"></A> </BLOCKQUOTE> </body> </html> 受け取る側 koushin_input.phpです <html> <body> <?php // データベースに接続 if(!$con=mysql_connect("localhost","root","admin")){ echo"接続エラー"; exit; } // データベースを選択 if(!mysql_select_db("db_test",$con)){ echo"データベース選択エラー"; exit; } // SELECT文を実行 $id=(isset($_GET["id"]))?((int) $_GET["id"]):0; $sql = "SELECT `番号`,`氏名`,`住所` FROM tbl_test where `番号`={$id}"; var_dump($sql); if(!$res=mysql_query($sql)){ echo "SQL実行時エラー"; exit; } // データの存在チェック if(!$row=mysql_fetch_array($res)){ $row=mysql_fetch_array($res); var_dump($row); echo "データが削除されています"; exit; } // 入力画面の出力 echo "<form action=koushin.php method=post>"; echo "名前：<input type=text name=NAME value=\"" . $row['氏名'] . "\"> "; echo "住所：<input type=text name=ADDR value=" . $row['住所'] . "> "; echo "<input type=submit value=更新>"; echo "</form>"; // 結果セットの解放 mysql_free_result($res); // データベースから切断 mysql_close($con); ?> </body> </html> どこが原因なんでしょうか?
一覧画面に更新、削除というボタンをつくり番号を受け取って削除したいのですが、削除ボタンを押しても画面は変わるのですが削除されません 助けてください 番号　int プライマリーキー 氏名 varchar 住所 varchar 一覧画面のソース <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <title>一覧画面</title> </head> <body> <BLOCKQUOTE> <BR>一覧画面<BR><BR> <?php $con=mysqli_connect("localhost","root","admin","db_test"); // Check connection if (mysqli_connect_errno()) { echo "Failed to connect to MySQL: " . mysqli_connect_error(); } $result = mysqli_query($con,"SELECT * FROM tbl_test"); echo "<table border='1'> <tr> <th>番号</th> <th>氏名</th> <th>住所</th> </tr>"; while($row = mysqli_fetch_array($result)) { echo "<tr>"; echo "<td>" . $row['番号'] . "</td>"; echo "<td>" . $row['氏名'] . "</td>"; echo "<td>" . $row['住所'] . "</td>"; echo "<form action=koushin_input.php method=post>"; echo "<td><input type=submit value=更新></td>"; echo "</form>"; echo "<form action=sakujo.php method=post>"; echo "<td><input type=submit value=削除></td>"; echo "</form>"; echo "</tr>"; } echo "</table>"; mysqli_close($con); ?> <BR><BR><BR> <A HREF="http://localhost/regist.php"> <INPUT TYPE = "SUBMIT" VALUE = "新規登録"></A> </BLOCKQUOTE> </body> </html> 削除ソース　 sakujo.php <html> <body> <? // データベースに接続 if(!$con=mysql_connect("localhost","root","admin")){ echo"接続エラー"; exit; } // データベースを選択 if(!mysql_select_db("db_test",$con)){ echo"データベース選択エラー"; exit; } // DELETE文を実行 $sql = "delete from tbl_test where '番号'= 番号; if(!$res=mysql_query($sql)){ echo "SQL実行時エラー"; exit; } // データベースから切断 mysql_close($con); // 登録完了メッセージの表示 echo "削除完了"; ?> </body> </html> どういう風にpostで渡せばいいですか？
すいません。1つ教えて頂きたいことがあります。 http://mysqlweb.net/category/4005373-1.html このファイルを参照してCSVを取り込もうとしていますが、何度やっても1行しか取り込まないです・・・。 Warningが出て、メッセージは Non-ASCII separator arguments are not fully supported 　です。 改行コードが悪い、というのはわかりましたが何をどうしたら修正出来るのかわからず 困り果てております。 どなたかこの原因を解消する方法をご教授下さい。。。 よろしくお願いいたします。
データベースのテーブル内容をサーバー上にcsv出力すると同時に出力した内容を配列で取得できないでしょうか？（PDOを利用しています） $sql= "SELECT id, name FROM tb INTO OUTFILE '/tmp.csv'"; $stmt = $dbh->query($sql); これでcsvは出力されるのですが、csv出力した内容を配列で取得したく、 $array = $stmt->fetchAll(PDO::FETCH_ASSOC); をするとGeneral Errorとなります。 先にSELECTで内容を配列で取得してから配列のループでcsvの内容を作成し、出力する方法もありますが、データ量が数十万件あるのでループ処理が遅い気がしています。 良い方法があればお教えください。 よろしくお願い致します。
MySQLの複合インデックスに関して質問させて頂きます。 現在検索条件に3つのカラムを使用して検索をかけているSELECT文があります。 データの件数は100万件ほどあるとします。 【例】 「SELECT * FROM test WHERE a = '1' AND b = 'xxxxx' AND c = '1';」 カラム「a」「c」は、0と1のみが格納されたカラムで、頻繁に更新されます。 カラム「b」は、同じ値が入ることがありますが、ほぼユニークな文字列が格納されます。 上記のような場合、インデックスは ・「a,b,c」の全てを設定した複合インデックスを作成するべきか。 ・cは頻繁に更新されるので、「a,b」のみの複合インデックスを作成するべきか。 ・aも同じく頻繁に更新されるので、WHERE句の検索順をbを先に持ってきて、「b」のみの単独インデックスを作成するべきか。 一概にこうだという答えは無いかもしれませんが、何か良い方法があれば教えて頂けると幸いです。 また、質問に不備な点がございましたら、ご指摘お願いいたします。
いま下記のソースで一覧画面が表示されます！ 氏名をクリックしたら別ウインドウで詳細画面を表示させたいのですがやり方がわかりません 参考までに教えてください <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <title>一覧画面</title> </head> <body> <BLOCKQUOTE> <BR>一覧画面<BR><BR> <?php $con=mysqli_connect("localhost","root","password","db_test"); // Check connection if (mysqli_connect_errno()) { echo "Failed to connect to MySQL: " . mysqli_connect_error(); } $result = mysqli_query($con,"SELECT * FROM tbl_test"); echo "<table border='1'> <tr> <th>番号</th> <th>氏名</th> <th>住所</th> </tr>"; while($row = mysqli_fetch_array($result)) { echo "<tr>"; echo "<td>" . $row['番号'] . "</td>"; echo "<td>" . $row['氏名'] . "</td>"; echo "<td>" . $row['住所'] . "</td>"; echo "</tr>"; } echo "</table>"; mysqli_close($con); ?> <BR><BR><BR> <A HREF="http://localhost/regist.php"> <INPUT TYPE = "SUBMIT" VALUE = "新規登録"></A> </BLOCKQUOTE> </body> </html>
実は、かなり悩んでいるため、助けて(教えて)いただけないでしょうか？ なおMysqlのバージョンは5.5.31です。 ・hoge_test.txtの中身 011010000000009　　　　　043.052927141.3446931 011000000000009　　　　　043.059576141.3581841 011010010000009　　　　　043.036466141.3242842 011010010010009　　　　　043.038999141.3229683 0110100A0020009　　　　　043.037663141.3252133 0110100E0030009　　　　　043.037048141.3238143 ※真ん中の　　　　　の部分は2バイトの空白5文字。。。 先頭の11桁分は、数字+A～Z、 test6とtest7にあたる部分には、43.059576や141.358184などといった 小数点(少数6桁)のデータがあります。 といったhoge_test.txtの固定長のデータ(改行コードCR/LF)があるとき、 CREATE TABLE `hoge_test`.`hogehoge` ( `test1` varchar(11) DEFAULT NULL, `test2` varchar(3) DEFAULT NULL, `test3` varchar(1) DEFAULT NULL, `test4` varchar(5) DEFAULT NULL, `test5` varchar(1) DEFAULT NULL, `test6` varchar(9) DEFAULT NULL, `test7` varchar(10) DEFAULT NULL, `test8` varchar(1) DEFAULT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC; 上記のように定義して、以下のような形で取り込んでみました。 ※小数点部分はDOUBLEを使うのもありですが・・・うまくいかなかったので文字列として取り込むことに set character_set_database=sjis; LOAD DATA LOCAL INFILE "hoge_test.txt" INTO TABLE hoge_test.hogehoge FIELDS TERMINATED BY '' OPTIONALLY ENCLOSED BY '' LINES TERMINATED BY '\r\n' ; 上記を実行すると、こんな感じのような形となります。 '01101000000', '271', '6', '1', '', '', '', '' これを以下のようにしたいのですが、 そももそLOAD DATA で、このような固定長データを読み込むは難しいのでしょうか？ オラクルでいうところのPOSITION句で各項目のレコード上の位置を指定はできないのでしょうか？ http://oracle.se-free.com/utl/C2_kotei_load.html それとも単純に私の定義や取り込む方法がマズイのでしょうか？(だから取り込めないんだと思っていますが。) 最終的に、どうしたいかというと、以下のような形で、各カラムにデータが入ればＯＫです。 '01101000000','000','9','　　　　　','0','43.052927','141.344693','1' そのままLOAD DATAで取り込みたいですが、この際元データをsedなどのlinux系標準のコマンドで カンマ区切りやタブ区切りに変換して、LOAD DATAで読み込んでも構わないです。 (ただエクセルで操作してというのは無しでお願いします。) ※データ量としては、200Ｍ単位です。 hoge_test.txtを　sedで○○○○○で置き換えて、定義とLOAD DATAで、○○○○○で こういう風に○○○○○書けば取り込めばできるよ みたいな形でコードを教えていただけると助かります。 お手数をおかけいたしますが、よろしくお願いいたします。
今のPC（ウィンドウズ7）にあるデータを新しいPC（ウィンドウズ8.1）に移動させたいのですが・・。 方法がわかりませんしサポートセンターには電話がつながらないし、困っています。
MySQLのストアド（プロシージャ/ファンクション）でテキストファイルを削除する方法を探しています。 テキストファイルは、他のファイルでも構いません。 テーブルにデータがINSERTされた時に実行されるストアドです。 system rm -f 'ファイル名'; によるファイルの削除を試みましたが、エラーが発生します。 可能であればストアドからファイルを削除したいですが、難しいようでしたら上記の条件を満たす限り、どのような方法でも構いませんので、教えて欲しいです。 各バージョンは最新バージョンとします。 大変困っていますので、どうかご協力を、宜しくお願い致します。
SQL Server関係初心者です。 教えてください。 今までWindowsXPにMICROSOFT SQL SERVER 2000 DESKTOP ENGINEがインストールが インストールできたのですが、Windows7ではインストールできませんでした。 Windows7は対応していないでしょうか？ それに代わる無償のものはありますでしょうか？ Microsoft SQL Server 2005 Express Edition Service Pack 3がその代わりと なりますでしょうか？ XPの時はいつもインストール後に以下のようなコマンドを実行していました。 setup.exe SECURITYMODE=SQL SQPWD=password MSDEとMicrosoft SQL Server 2005 Express Edition Service Pack 3では全く異なるのでしょうか？ よろしくお願い致します。
MySQLの文字コードをsetコマンドで変更した後、再度ログインし直すと 元の設定に戻ってしまいます。 他にやるべき作業があるのでしょうか？よろしくお願いします。 mysql -u root show variables like "chara%"; set character_set_server=utf8;　 show variables like "chara%";　←変更されている exit mysql -u root show variables like "chara%";　←元に戻っている version 5.1.73
はじめまして。 この質問に関連する内容につきまして、ご回答を頂けたのですが 以下の事項につきまして、追加で質問させて頂きたく存じます。 【過去の質問】 >SQLにて、”指定の文字「-」を検索し、先頭から「-」のひとつ前までを取得”を実現したいのですが、 >これは実現できますでしょうか。（substrやinstrなどでは無理そうなので、お知恵お借りしたいです。） > >例） >01234567-001 >0123456-001 >012345-001 >0123456789-001 > >上記に対して、期待する実行結果は次の通りです。 >01234567 >0123456 >012345 >0123456789 【ご回答】 >select substr(col, 1, instr(col, '-') - 1) >from tbl; >でいいのではないでしょうか。 >'-'が含まれていない場合はnullが返りますので、そのあたりの制御が必要であれば適宜修正してください。 ★追加質問内容 上記のcolがNULL（'-'が含まれない）場合に、colのそのままの値を出力という形にすることは可能でしょうか。 例） 01234567-001 0123456-001 012345-001 0123456789-001 0123456　　← 111345　 　← 上記に対して、期待する実行結果は次の通りです。 01234567 0123456 012345 0123456789 0123456　　← 111345　　 ← お手数ですが、ご教示のほど宜しくお願い致します。
「CONCAT」使ったLIKE検索はできるようになったのですが、まだできない事があり質問。 東京都新宿区大久保2-26 という住所があり、下記のようにカラム展開されているとします。 東京都 | 新宿区 | 大久保 | 2 | 26 | これを「新宿区大久保2-26」で検索する場合です。 東京都 | 新宿区 | 大久保 | 2 | -26 | としておけばCONCATでまとめて検索できますが、先にハイフンを入れておく事に不自然さを感じます。ハイフンなしだと東京都新宿区大久保226でもヒットしてしまうし。 なにか対処方はあるのでしょうか？
はじめまして。 SQLにて、”指定の文字「-」を検索し、先頭から「-」のひとつ前までを取得”を実現したいのですが、 これは実現できますでしょうか。（substrやinstrなどでは無理そうなので、お知恵お借りしたいです。） 例） 01234567-001 0123456-001 012345-001 0123456789-001 上記に対して、期待する実行結果は次の通りです。 01234567 0123456 012345 0123456789 こんなことは可能でしょうか。
新しく入った部署ではSQLServerでDB管理してるのですが、 困ったことに何でもかんでもSQLServerに取り込む傾向があります。 例えば、別途作成したAccessやExcelのデータをわざわざSQLServerへ移せと上司に指示されます。 多くの場合は個人利用しかしていませんし、アプリケーションともつないでいません。 一定期間保存したら削除するデータです。 理由を聞いたところ、時々データ分析が必要で、 Accessよりsql文を書くのに慣れているからとの回答でした。 「別にSQLServeに移さなくたってそのまま使えばいいじゃん」 と一言で済ますのは冷たいかと思いいったん引きさがりましたが、 やはりデータ移行にもそれなりに時間をとられますし、 何より無駄だと思いながらやる作業は耐えられません。 具体的に「こういうやり方をした方が便利ですよ」みたいな感じで提案してあげるといいのかなとは思うのですが、 どうもAccessは苦手意識があるようです。。。 相手はパソコンが不慣れではありませんが、システム屋さんではありませんし、若くもありません。 これはもう相手に合わせる方がいいんでしょうか？ AccessやExcelでのデータ分析を少しは勉強してもらった方がいい(？_？) 落とし所をを教えてください
Windows8.1上でSQL Server 2008 R2は起動しますか？ 弥生販売14　ネットワークを使用するのにSQL Server 2012ではSQL Server 2000形式のバックアップデータがコンバートできなくて困っているのです。 そこで、SQL Server 2008 R2を介してコンバートを考えています。よろしくお願いします。
くだらない質問で申し訳ありませんが宜しくお願いします。 下記のようなデータを格納するテーブルを構築しています。 ・ユーザーID ・名前 ・カタカナ ・パスワード ・年齢 ・郵便番号 ・住所１ ・住所２ ・住所３ ・電話番号 ・メールアドレス ・備考 ・削除フラグ ・登録者 ・登録日 ・更新者 ・更新日 上記の内容を下記のようなテーブルのフィールドのデータ型を考えました。 ・ユーザーIDのデータ型をVARCHAR(4) ・名前のデータ型をVARCHAR(32) ・カタカナのデータ型をVARCHAR(32) ・パスワードのデータ型をVARCHAR(255) ・年齢のデータ型をINTEGER ・郵便番号のデータ型をVARCHAR(8) ・住所１のデータ型をVARCHAR(255) ・住所２のデータ型をVARCHAR(255) ・住所３のデータ型をVARCHAR(255) ・電話番号のデータ型をVARCHAR(18) ・メールアドレスのデータ型をVARCHAR(255) ・備考のデータ型をTEXT ・削除フラグのデータ型をVARCHAR(1) ・登録者のデータ型をVARCHAR(4) ・登録日のデータ型をTIMESTAMP ・更新者のデータ型をVARCHAR(4) ・更新日のデータ型をTIMESTAMP そうしたら下記のような風にテーブルのフィールドのデータ型にしたら格納する文字列の桁エラーが起こらないからどうといわれました。 ・ユーザーIDのデータ型をVARCHAR(4) ・名前のデータ型をTEXT ・カタカナのデータ型をTEXT ・パスワードのデータ型をTEXT ・年齢のデータ型をTEXT ・郵便番号のデータ型をTEXT ・住所１のデータ型をTEXT ・住所２のデータ型をTEXT ・住所３のデータ型をTEXT ・電話番号のデータ型をTEXT ・メールアドレスのデータ型をTEXT ・備考のデータ型をTEXT ・削除フラグのデータ型をVARCHAR(1) ・登録者のデータ型をVARCHAR(4) ・登録日のデータ型をTIMESTAMP ・更新者のデータ型をVARCHAR(4) ・更新日のデータ型をTIMESTAMP ※現在、使用しているデータベースはPostgreSQLですが、Microsoft　SQL ServerやOracleやMySQL等の他のデータベースでもいいものなのかもご教授いただけると助かります。 私の知識不足でどちらがいいのかがわからず投稿させてもらいました。 申し訳ありませんが皆さんのお知恵をお貸し下さい。 宜しくお願いします。
ＳＱＬ文を分析している最中ですが、以下の構文の意味がわかりません。 where Aテーブル.Aフィールド = Bテーブル.Aフィールド and Aテーブル.Aフィールド = Cテーブル.Aフィールド(+) and Aテーブル.Aフィールド = Dテーブル.Aフィールド(+) この構文の「(+)」の意味を教えて下さい。 宜しくお願い致します。
SQLコマンドで、下記を実行すると「2014/04/03」などが取得できると思ったのですが、 「14/04/03」で取得してしまいます。 （aaa_dateは、DATE型で、「2014/04/03」などが入ってます） select TO_DATE(aaa_date,'YYYY/MM/DD') from AAA_TBL YYYYをYYにして、下記を実行すると、なぜか、「2014/04/03」と正常に取得します。 select TO_DATE(aaa_date,'YY/MM/DD') from AAA_TBL 逆の気がするのですが、なぜでしょうか。
こんにちは。 今phpとデータベースを勉強中でしてそれを使ったウェブサイトを作りました。 画像とその画像の説明文をいろんな条件で並び替えるサイトです。 プログラム自体はできあがったのですが、文章はデータベースに入れるとして、画像も できたらデータベースに入れたいと思い調べてみると入れる事はできるようです・・。 ただ画像の量が多く最終的には5000枚-10000枚くらいになりそうです。 複数の条件で並び替え→表示とする場合、データベースに画像を入れる場合と、サーバにそのまま置く場合では結果表示速度に差ってでるものなのでしょうか・・。（そのサイトを数十人が一度に並び替えをすると仮定して） どこかのサイトに画像をデータベースに入れるとかなり遅くなるというような事が書いてありました。 事実でしょうか？ 質問の意味が分かりにくいかもしれませんが詳しい方いましたらご回答いただけると助かります。
よろしくお願いいたします。 PostgreSQLの、 CREATE TABLE global_points ( id SERIAL PRIMARY KEY, name VARCHAR(64), location GEOGRAPHY(POINT,4326) ); というSQLの、最後の location GEOGRAPHY(POINT,4326) というところを、MySQLで、実装しようとしているのですが、MySQLにも、地理情報に関する命令はあるようですが、どうすればよいのか見当がつかなく困っています。 どなたか、MySQLでは、こういう風に書くなどのことをご存知の方おられましたら、どんなことでも構いませんので、ご教授願います。
mysql で　 ON DUPLICATE KEY UPDATE 　といれると、 すでに同じプライマリキーのデータが存在した場合アップデートとして 扱われますが、プライマリキーが同じであり、かつ　プラス条件を 課すことはできないのでしょうか？ たとえば、プライマリキーが　５のデータを更新すると すでに、5のデータが存在した場合はアップデートとして扱われるが ただし、ある条件（日付が◯◯日以下等）に反する場合は アップデートも行われない。 というような処理です。
商品名　　数量　　単価　　計 リンゴ　　　　１　　　100　　　 100 バナナ　　　-1　　　100　　　-100 リンゴ　　　　１　　　100　　　 100 バナナ　　　-1　　　100　　　-100 リンゴ　　　　１　　　100　　　 100 バナナ　　　-1　　　100　　　-100 初心者です。 このような表でマイナスの値だけを集計する計算式を教えてください。 ファイルメーカーpro12を使っています。 よろしくお願いします。
リアルタイムにデータが発生し、Sybase IQ(15.2)のテーブルに随時レコード追加する処理のパフォーマンス改善をしたいです。 Javaでプログラムを書いていて、１スレッドで処理をしていたのですが、レコード総数が多くなってきたせいか処理が重くなってきました。 ですので複数スレッド・コネクションでINSERT文を実行するように修正したところ、以下のエラーが発生しました。 「SQL Anywhere エラー -210 : テーブル名 のローは、ユーザ '別のユーザ' によってロックされています。」 INSERTしているだけなのですが、テーブル全体をロックしているのかエラーが発生してしまいます。 数十件くらいのINSERT文をバッチ処理(executeBatch)で実行するということを、各スレッドで数秒間隔で行っています。UPDATEは一切行いません。 Sybase IQで、複数のコネクションで並列してINSERT文を実行するということはできないのでしょうか？ また他に改善方法がありましたら教えてください。
この質問を記事投稿後　やっぱり消したいと思って、消すとします。 この時、サーバーに　「◯◯のアカウントで投稿された◯◯番の記事を削除する」　 というリクエストを送っているのであれば ログインIDはセッション等から読み込むことで書き換えれないでしょうけど 記事番号は POST値やGET値をツール等で書き換えてしまったら 本来消すことのできない記事も消えてしまわないのでしょうか。 つまり　SQLにして UPDATE 　質問テーブル SET 　表示 = 0 WHERE 　アカウントID = 私のID AND 　記事ID = この記事のID←この値を改ざん！ 　 のようなことがおこらないように一般的にどうやって防いでいるのでしょうか？
UPDATE、SELECTで共に同一のテーブルの同一の主キーを指定したWHERE検索をEXPLAINで行ったところ、 SELECTに関してはtype値がconstになり、 UPDATEに関してはtype値がrangeになりました。 その他の違いといえば、UPDATEの場合はExtra値がUsing whereになるだけで、他は特に差異がありません。 UPDATEで変更する列にインデックスを作成してみても（WHEREで指定する列も含め）、やはりconstにはなりませんでした。 なぜこのような違いが発生するのでしょうか？ また、UPDATEステートメントでもtype値をconstにするためにはどのようにすればよいでしょうか？ よろしくお願いいたします。
はじめまして 私は小さな会社をしていて自社の業務管理を以下の様な形で行っています。 Server : windows2003server データベースエンジン: MSDE クライアント: windows XP 12台 データベース: Access2003 で運用しています。 このシステムをAccessを勉強しながら組み立てて何とか問題なく管理できているのですが、 クライアントを全てWindows7に入れ換えるのを機に、サーバーもWindows2008に入れ換えることにしました。 クライアントのWindows7には、Access2003を入れるつもりでいます。 ここでわからないことが (1) Windows2008ServerにはMSDEは対応していないとのことですが、スムーズに移行できる無料のデータベースエンジンは何でしょうか？ (2) サーバーとクライアントの両方について、システムの移行をする手順を、初心者の私にご指導をお願い致します (3) Access2003で運用しているものを2013に移行した場合には互換性の問題が発生する可能性はあるのでようか？ 業者さんに依頼する予算もなく、全てを自分で移行して現在と同じようにトラブルなく業務管理ができるシステムの運用を行いたいと思いますので、皆様のお力をお借りしたく、何とぞシステム移行ができるよう、ご指導のほど宜しくお願い致します。
XamppでインストールしたphpMyAdminには インストールされた初期状態では rootユーザーが最初から３つ登録されています。 1.root ホスト 127.0.0.1 2.root ホスト ::1 3.root ホスト localhost ３つとも削除はできないようになっていますが rootユーザーが３つあるのは それぞれ何か特別な役割があるのでしょうか？ パスワードを設定する場合は それぞれ異なるパスワードを設定することになるのでしょうか？ よろしくお願いいたします。
以下のような2つのCSVファイルがあるとします。 【hoge1.csv】 aaa,bbb,ccc,ddd 1,2,3,4 【hoge2.csv】 aaa,bbb,ddd,eee,fff 1,2,4,5,6 Accessをあまり使用したことがないので教えていただきたいのですが、 hoge1.csv、hoge2.csvを、以下のような形で Accessの1つのテーブルにインポートする事はできるのでしょうか？ ---------------------------- | aaa | bbb | ccc | ddd | eee | fff | |　1　|　2　|　3　|　4　|　　|　　| |　1　|　2　|　　|　4　|　5　|　6　| ---------------------------- ※「aaa」「bbb」…をフィールド名としたいです vb等でプログラムを自作するしかないのでしょうか？ 何か良い方法がありましたら教えてください。お願いします。
以下のようなテーブルがあります name point date A　1　2014/1/1 B　2　2014/1/1 C　3　2014/1/1 A　1　2014/2/1 B　3　2014/2/1 C　2　2014/2/1 A　2　2014/3/1 B　4　2014/3/1 C　3　2014/3/1 上記のテーブルを name point(2014/1) point(2014/2) point(2014/3) A　1　1　2 B　2　3　4 C　3　2　3 というように並べるにはどのようなSQLを打てばよいでしょうか。 以下のようなSQLを打ってみたらデータ量が多いときになかなか応答が帰ってきません。 SELECT name, ifnull(sum(CASE WHEN date = '2014-01-01' THEN point END),'-') as point(2014/1),ifnull(sum(CASE WHEN date = '2014-02-01' THEN point END),'-') as point(2014/2),ifnull(sum(CASE WHEN date like '2014-03-01' THEN point END),'-') as point(2014/3) FROM tableA GROUP BY name
水平分割（パティショニング/シャーディング）されたテーブルが何十個もあり、それらのテーブルから一気に条件にあうデータを抽出したいです。 このような場合にどのようにSelect文を書けば良いでしょうか？ 自分で作ったものではなく、ただの利用者であるため、分割しないように作り直すなどの根本的な対策はできないです。 なお、使っているDBはMySQLです。
以下のようなテーブルがあるとします。 column1 a,b,c <- カンマの数は最大50 b,d c,x SQLを実行し以下のような結果を返したいです。 以下の３つのことをすればできそうなのですが複数列を複数行にする方法がわかりません。 1.strtokenで50カラムに分割（カンマ分割） 2.　50カラムを1カラムにする 3.DISTINCTで重複データの削除 結果 a b c d x カンマの数が50あるので、かなり長いSQLになるのですが SELECT文50個をUNIONしてやればできるかなとも考えているのですが 何か良い方法はないでしょうか。 よろしくお願いします。
業務用に10個以上作成したストアドプロシージャ/ファンクションをパッケージとしてまとめようとしています。保守性の観点から、PACKAGE BODY内の各ストアドを、以下のようなイメージで別々のファイルで管理したいと思っています。 が、PACKAGEとBODYの分割はできたものの、BODY内のストアドを別々にすると、エラーとなってしまいます。 そういうことはできないのでしょうか？ [xxx_pkg.SQL] CREATE OR REPLACE PACKAGE xxx_pkg IS PROCEDURE procedure_a; PROCEDURE procedure_b; PROCEDURE procedure_c; END xxx_pkg; [xxx_pkg.procedure_a.SQL] PROCEDURE procedure_a IS -- aの処理 END procedure_a; [xxx_pkg.procedure_b.SQL] PROCEDURE procedure_b IS -- aの処理 END procedure_a; [xxx_pkg.procedure_ｃ.SQL] PROCEDURE procedure_c IS -- aの処理 END procedure_ｃ;
まず、御覧頂きありがとうございます。 早速質問なのですが、 CREATE TABLE `hoge` ( `id` int(8) NOT NULL, `name` varchar(30) NOT NULL, PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO `hoge` (`id`, `name`) VALUES (1, 'hogeA'), (2, 'hogeB'), (3, 'hogeC'), (4, 'hogeD'); CREATE TABLE `test` ( `id` int(8) NOT NULL, `name` varchar(30) NOT NULL, PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO `test` (`id`, `name`) VALUES (1, 'testA'), (4, 'testD'); という値が入ってるテーブルがあるとします。(長くなってすみません) で、 hoge.id と test.id が重複した場合 test.name を表示させたいです。 期待値としては id,name 1.testA 2,hogeB 3,hogeC 4,testD になります。 業務でJoinを使うようなテーブル構造にそもそもしないというのもあり、クリティカルなSQLコードに不慣れで御知恵を借りたく質問させて頂きました。 よろしくお願いします。
FileMaker Server 10 の Admin Console が起動しなくて困っております。 javaはインストールされています。（Version 7 Update 51） 環境はwindows7 32bitです。 どなたかご教示いただけないでしょうか？ よろしくお願いいたします。
mysql初心者です。 3つのテーブルでスケジュールの仕組みを考えていますが Staff→スタッフデータ id　　name 1　　　田中 Sch1→日付出勤 id　　start_time　　end_time　　date　　flg 1　　　9:00　　　22:30　　　2014-03-17　　　1 Sch2→曜日出勤 id　　start_time　　end_time　　dateW 1　　　9:00　　　22:30　　　1 ※dateWは曜日(0～6) 日付出勤優先なので、なければ曜日出勤を出力します。 たとえば、 田中さん (1)日付登録：2014-03-17（月）　09:00-18:00 (2)曜日登録：1（月）　10:00-19:00 (3)曜日登録：2（火）　09:00-18:00 PHP側でやるなら、 for (一週間分回す) { if (Sch1[date]) { 日付設定出力 }else{ 曜日設定出力 } } 全出力した（日付、曜日）データを一個の配列に入れて、start_timeでソートするかで出力する。。 Mysqlのif文かcase文分でどう書いたらいいですか？ 説明が下手ですが、 どなたかご存知の方がいらっしゃれば是非、ご教授ください。
SQL　Server で　翌月10日を取得する方法を教えてください。 isnull(convert(char(10),dateadd(month,1,(dateadd(day,9,DATE))),111),'') as DATE ↑これだと、DATE(月末)の翌月の９日後で、翌月10日も可能なのですが、 当然ながら、DATEが月末とは限らないので。。。 常に10日を固定で表示するにはどうしたら、よいのでしょうか？ よろしくお願いいたします。
Excelマクロが部内に飛び交っていて、様々なデータがいろんなファイルに収められています。それをデータベースに集約したいと思っています。 部内といっても、数人しかいなし、アクセス数も物凄くあるわけではありません。 本当はPCを1台用意してSQLサーバーを動かしたいのですが、色々な制約がありNGです。外部のレンタルサーバーも個人情報の関係で使用できません。 そこで、社内のファイルサーバーにSQLITEを置いて、VBで開発を行おうと考えています。これ以外に何か良い方法がありましたら、お教え頂けませんでしょうか？ Windows ServerとSQL Serverの搭載されたサーバー機は用意できませんが、30万円以内くらいの予算があるので、NASみたいな機器は用意できます。どうか、よろしくお願いします。
MySQLで下記SELECTレコードを削除したいと思い、 DELETEへ変えたら文法エラーになります。 SELECT * FROM `piyo` AS a LEFT JOIN `hoge` AS c ON a.`hoge_id` = c.`hoge_id` WHERE c.`x_id` =13 DELETE * FROM `piyo` AS a LEFT JOIN `hoge` AS c ON a.`hoge_id` = c.`hoge_id` WHERE c.`x_id` =13 どう書けば良いでしょうか？
ランキングを作成する、効率の良いSQLを教えて下さい。 MySQLで、以下の状態です。 テーブル名： hoge カラム： id,kbn,name,score,flg,date id…自動 kbn…1～4 name…string score…int flg…bool date…年月日 (1)dateが1週間以内のデータのみ (2)flgがtrueのデータのみ (3)kbn毎に、5レコード取得 (4)順位は、点数が重複している場合は同一の順位をつけSQLで生成しn位のフォーマット (5)6レコード以降に同一スコアのデータがある場合は日付が古い順 (6)scoreは、n点のフォーマット (7)該当データが5レコード存在しなかった場合は、順位だけをセットし他をnull 欲しい結果は、以下の状態です。 kbn,順位,name,score 1 ,1位 ,ホゲ,100点 1 ,2位 ,あい, 85点 1 ,2位 ,かき, 85点 1 ,4位 ,くけ, 70点 1 ,5位 ,さし, 65点 2 ,1位 ,すせ, 99点 2 ,1位 ,たち, 99点 2 ,3位 ,つて, 80点 　　・ 　　・ 　　・ 4 ,4位 ,らり, 10点 null ,5位 ,null, null 以上、よろしくお願い致します。
いつも楽しく勉強させていただいております。 Access2013のVBAでADOを使ったシステムを作っています。 その中にある契約の月額料金に対して日割で控除額を計算する処理があります。 契約のテーブルには契約が何日～何日（From～To）まで有効であるかを格納し、 控除のテーブルには何日～何日（From～To）まで控除するかが入っています。 日割を行う前に控除のFrom～Toが契約のFrom～Toの範囲内であることのチェックをします。 If Deduction!To > Contract!To　Then 一連のエラー処理 Exit Function End If 上記のコードを実行してうまくいく時といかない時があります。 エラーでないはずなのにエラーになります。 うまくいかない時にイミディエイトウィンドウでみると、こうなっていました。 ?Contract!To 2014/02/14 ?Deduction!To 2014/02/13 ?Deduction!To > Contract!To True Deduction!Toは2014/02/13ですからContract!Toの2014/02/14より大きいはずはないのですが・・・。 どちらのテーブルのTo列も日付時刻型です。 ためしにCdate関数を使ってみましたが、これは意図したとおりに動きました。 If Cdate(Deduction!To) > Cdate(Contract!To)　Then ということで何とか回避する手段はあるのですが、気持ち悪いです。 (1)どうしてこういった現象がおきるのか。 (2)ADOのRecordsetを使った日付の比較は危険なのか。 (3)もっと根本的な解決法はありますか。 どなたかご存知の方教えてくださいませんか。
SQLでORDER BYをして、n番目からm番目を取得したい場合、 どのようにしたらいいのでしょうか？ TOP mで取得してnまでをスルーするしかないのでしょうか？
以下のようなテーブルがあります。 そのテーブルの内容と、そのテーブルのあるカラムの件数を条件にして抽出したいのですが、どのように指定すればよろしいでしょうか？ テーブルA id(int) AUTO_INCREMENT, user_id(varchar), price(int), date(datetime) 表示したい一覧 user_id | date | price A | 2014-03-10 10:00:00 | 2600 B | 2014-03-11 11:00:00 | 2720 A | 2014-03-13 12:00:00 | 2500 C | 2014-03-14 15:00:00 | 2860 B | 2014-03-18 13:00:00 | 2450 A | 2014-03-19 19:00:00 | 2550 ・・・ などのレコードがあった場合、 user_idが同じ場合のレコード数が2～5の場合等を抽出したいと思います。 うまく表現できませんが、このような場合の抽出の仕方をわかる方、よろしくお願いします。
初めて質問させていただきます。 よろしくお願いいたします。 Oracle 9i　から 11g　へバージョンアップしました。 9iでは動いていたPL/SQLコマンドが11gでは 以下のようなエラーが大量に発生します A_FLG Ａシノニム名.列名%type , 　　　　　* 行16でエラーが発生しました ORA-00201：行16、列13： PLS-00201：識別子（シノニム名）.（列名）を宣言してください。 PROCEDURE D_FLG_UPD ( a in varchar2 ) is type D_TYPE is record ( J シノニム名.列名.列名%type , 　　　ここでエラー　　　→A_FLG Ａシノニム名.列名%type , B_FLG Bシノニム名.列名%type , C_FLG Cシノニム名.列名%type ); G H; begin これはどういった場合に発生するエラーなのでしょうか？ またOracleのバージョンによってPL/SQLのコマンドが動かなくなったりすることは よくあることなのでしょうか？ よろしくお願いいたします。
エクセルの関数についてお尋ねします。 数値の４０を超えた場合は、超えた分だけ隣のセルに表示させたいです。 Ａ１に４８と打ち込んだ場合はＢ１に４０　Ｃ１に残りと８と表示させたいです。 Ａ１に３８と打ち込んだ場合は４０を超えていないのでＢ１には３８　Ｃ１には０もしくは空白を表示させたいです。 決められた数値以上の場合は決められた数値と超過分の数値を別々のセルで表示をしたいです。 わかりにくい説明で申し訳御座いません。
質問させて頂きます。 PHPとMySQLを使用して、ユニークな値(10桁ほどの英数文字列)を持ったデータを、DBに大量に登録したいと考えています。1度に1万件ほどを想定しています。 その場合、 先に大量のデータを作成して、1件ずつユニークかのチェック→DBに登録(insert)といった方法や、 1件データを作成→ユニークチェック→DBに登録(insert)を繰り返す方法などあると思うのですが、 どのような方法が比較的DBに負荷をかけずに短い時間で行なうことが出来るでしょうか。 質問が大雑把になってしまい申し訳ありません。 自分なりに調べてはみたのですが、確認したサイトなどによって方法がバラバラでしたので、こちらで質問させて頂きました。 処理以外の部分でも、テーブルやカラムにこういった設定を行なうと良いなど、どのような情報でもよろしいので、ご教授頂けると幸いです。 また、上記の質問内容に不備な点がございましたら、申し訳ございません。 ご存じの方がいらっしゃいましたら、よろしくお願いいたします。
WKテーブルにカラム ID(PK), POSTNO, DATA, FLAGがあります。 POSTID毎にIDで小さい順に並べて2件以上の行にFLAGを1に設定したいです。 以下のようなイメージです。 カンマは実際にはありません。 select * from WK; ID POSTID DATA FLAG 1 1 aaaa 0 2 1 bbbb 0 3 1 cccc 0 →これを1 4 1 dddd 0 →これを1 5 5 eeee 0 6 5 ffff 0 7 5 gggg 0 →これを1 8 4 hhhh 0 9 4 iiii 0 10 4 jjjj 0 →これを1 まず行単位にPOSTID毎の件数が必要と思い以下のselect文を書いてみました。 更にPOSTID毎に上位2件以外を抽出するにはどうすればいいでしょうか。 またはもっと上手いやり方があればご教示お願いします。 select a.ID, a.POSTID, b.CNT from WK a, (select POSTID, ID, count(POSTID) as CNT from WK group by POSTID) b where b.POSTID = a.POSTID order by a.POSTID, a.ID; ID POSTID CNT 1 1 4 2 1 4 3 1 4　この行を抽出したい 4 1 4　この行を抽出したい 8 4 3 9 4 3 10 4 3　この行を抽出したい 5 5 3 6 5 3 7 5 3　この行を抽出したい
MySQLを利用して点数の抽出をしたいと思います。 -------------------------------------- point | -------------------------------------- 9 1 1 5 6 6 3 2 1 9 2 3 8 9 9 4 3 -------------------------------------- というテーブルデータがあったとして、point の存在する順が欲しいのです。 PerlからMySQLを利用しています。その際のSQL文が知りたいです。 point 9 が4件で一番多いので　9 という数字が最初に返り、 point 3 が3件で二番めに多いので　3 という数字が次にかえってくる という風にしたいのですが、可能でしょうか？
LEFT OUTER JOIN と TOP10との組み合わせ テーブルAと LEFT OUTER JOIN するテーブルBがあり、 単にLEFT OUTER JOINすると、 レコードA01 レコードB01 レコードA01 レコードB02 レコードA01 レコードB03 のようにレコードBに対し、該当する同じレコードAが複数取得されます。 この状態でTOP10をかけると、テーブルAのTOP10が欲しいのに、 テーブルBも混じった数で取得されてしまいます。 （テーブルAは１０レコード取得できない） これをテーブルAのTOP10を取得して、それにJOINするテーブルBの数は問わない方法は可能でしょうか？
Mysqlの件で教えてください。 Mysqlのバージョンは5.6.14です。 +---------------------------------------------------+ |　　juchuu　　|　　keishiki　　|　　　starttime　　　|　　koutei 　　| +----------+-----------+---------------+------------+ | 8830 | 7745 | 2013-12-1 14:24 | 1010 | |　　8830 | 7745 | 2013-12-2　8：30 |　　　1020　 | |　　8835 |　　　7720　 | 2013-12-3　15：20 |　　　1010 ｜ | 8840 |　　 7745　　　| 2014-01-01 8：30 |　　　1010　 | |　　8840 |　　7745 | 2014-01-01 13：30 ｜　　1020 | 上記のテーブルで、 ・keishiki=7745　のデータ ・直近のjuchuuのグループのリスト（4行目と5行目のリスト） を取得する構文を教えてください。 juchuuグループは2行とは限りません。 よろしくお願いします。
WindowsServer2008R2(64bit) SQLServer2012 Express からリンクサーバーで WindowsServer2003(32bit) Oracle9i で稼働しているデータベースに接続したいのですが、必要なのは 1：OracleClient11gまたはOracleClient12c 2：Instant Client 3：他 のどれをインストールすればよろしいでしょうか。保持している OracleClient9iをインストールしたのですがインストール自体は 終わっても正常にインストールできないようでOSから入れなおし ました。 Oracleについては初心者なのでどなたかご教授いただけると 助かります。宜しくお願い致します。
・MySQLで一致条件に正規表現を使用することは出来ますか？ ・もし出来るとすればどのようにすれば良いでしょうか？ ■やりたいこと ・aテーブルのurlカラム内容が「/color/★★」だったら「/color/」以下の★★を抽出して、bテーブルのidと一致したレコードを抽出したい ・aテーブルの★★と、bテーブルのidカラムが一致しているレコードが欲しい ・aテーブルのurlカラムには「/color/58」「/color/26」「/hoge/■■」などが入っています SELECT ＊ 　 　 FROM a 　 　　 LEFT JOIN a.url = b.id 　　　 REGEXP '^(/color)'？ 　　　 where a.★★ = b.id
エクセルで4.90141E+12などのように表示される数字をちゃんとした数字になおしたいのですが方法が解りません！ただし、表示を数値にしたりして一時的に見れるようにしたり、文字列変換するのではなく　修復したら再度ファイルを開いても4.90141E+12ではなく4901411004730と表示されるようにしたいのです。どなたか方法をご存知の方はご教授をお願い致します。 エクセルのバージョンは2000又は2003を使用しております。
SQL初心者です。 よろしくお願い致します。 Oracle SQLのORDER BY句で日本語の別名と英字の別名とでは処理速度が変わるのでしょうか。 例えば、給与から控除額を引いて税抜き給与支給額の多い順に並べたい場合に 以下のようなSQLを検討しました。 ORDER BY句にはSELECT内の計算結果の別名を指定しました。 その結果、処理が遅くなる感じがしました。 代わりに、"税抜き給与支給額"をSIKYU_GAKと英字にすると早くなった気がしました。 日本語の別名と英字の別名とでは処理速度が異なるものでしょうか。 SELECT t1.ID AS "社員ID" ,t1.NAME AS "社員名" ,t1.KYUYO AS "給与" ,t1.ZEI AS "税金" ,t1.OTHER AS "その他" ,(t1.KYOYO - t1.ZEI - ｔ１.OTHER) AS "税抜き給与支給額" FROM 社員　t1 ORDER BY "税抜き給与支給額"
MySQL5に、以下のような月刊雑誌目次データがあります。 mysequenceが通巻第●号、のような数字を表しています。 最新の3号（あるいは6号、12号）だったら 仮想カラム myflg=1と印をつけるSELECT文をご教示 いただけないでしょうか。 データ例では138～236号と途中を省略しまくってますが 実際は1号から数百号まであり、最新の3冊（あるいは6冊、12冊） だったら、 if ($myflag = 1 ){ echo "<img src='./image/最新の3号.gif'>"; } みたいな使い方をしたい次第です、よろしくお願い致します。 select *, (if( select (max(mysequence) - 3),1,0 ) as myflg) from mymagazine みたいな雰囲気かと思いますが、left joinとか難しい照会が 必要でしょうか。よろしくお願い致します。 create table mymagazine ( mycode int(5) unsigned not null auto_increment comment '管理コード', mypubyear int(4) default null comment '発行年', mypubmonth int(2) default null comment '発行月', mysequence int(3) default null comment '号', mysortno int(2) default null comment '巻毎のソート番号', mycategorycode int(2) default null comment '分類コード', mytheme varchar(900) default null comment 'テーマ', primary key( mycode ) ) engine=InnoDB default charset=utf8 auto_increment =1; insert into mymagazine ( mypubyear , mypubmonth , mysequence , mysortno , mycategorycode , mytheme )values(2005,7,138,1,99,''),(2005,7,138,2,1,'サッカー'),(2005,7,138,3,1,'サッカー'),(2005,7,138,14,16,''),(2005,7,138,15,15,''),(2005,8,139,4,1,'野球'),(2005,8,139,5,1,'野球'),(2005,8,139,17,17,''),(2005,8,139,18,17,''),(2005,9,140,1,99,''),(2005,9,140,2,1,'テニス'),(2005,9,140,3,1,'バスケ'),(2005,9,140,4,1,'バスケ'),(2005,9,140,5,1,'バスケ'),(2005,9,140,6,1,'水泳'),(2005,9,140,7,2,''),(2005,9,140,8,14,''),(2005,9,140,9,13,''),(2005,11,142,2,1,'柔道'),(2005,11,142,3,1,'剣道'),(2005,11,142,4,1,'剣道'),(2005,11,142,5,8,''),(2005,11,142,6,2,''),(2006,1,144,2,1,'卓球'),(2006,1,144,3,1,'卓球'),(2006,1,144,4,1,'バレー'),(2007,9,236,2,1,'陸上'),(2007,9,236,3,1,'陸上'),(2007,9,236,4,1,'陸上'),(2007,9,236,5,4,'ソフト'),(2007,9,236,6,5,'');
MySQLのdatetime型カラムに「月」や「日」だけ不明なデータを格納したいのですが、どうすれば良いでしょうか？ ・具体的なパターンは、下記3フォーマットの何れかです ・2013-03-02 ・2013-03 ・2013 ※月日が不明なデータは全体の一部 ■案1 ・不明な日付を0に置き換え格納 ・2013-03-00 ・2013-00-00 ■案2 ・不明な日付を1に置き換え格納 ・2013-03-01 ・2013-01-01 ※本来の日付と見分けがつかなくなる ■質問 ・日付不明が後で判別できるよう、出来れば0で置き換えたい ・MySQL的に問題ないでしょうか？ ・一般的に日付が不明なデータはどのように処理するのでしょうか？ ■環境 ・MySQL ・PHP
こんにちは。 Microsoftが提供しているPower Povitについて質問です。 このツールを利用するにはMicrosoftSQL2008以上とExcel2010以上が必要なのはわかったのですが それ以外に何かライセンスは必要でしょうか。 勤めている会社でBIツールを提供する可能性が出てきており 何をベースとして使用するか選定しています。 少し調べている限りでは非常にこちらの条件とマッチしているのですが ライセンスなどに触れている記事に当たらなかったのでこちらに投稿させて頂きました。 よろしくお願いします！
同順位を考慮したランクの取得について(1～55位まで) 下記の2つのテーブルがあります。 rankingscoreinfo フィールド名 型 長さ missionid integer 4 NOT NULL name varchar 20 NOT NULL skill integer 4 NOT NULL score integer 4 NOT NULL rankinginfo フィールド名 型 長さ NOT NULL missionid integer 4 NOT NULL name varchar 20 NOT NULL kind integer 4 NOT NULL missionidとname２つのテーブルの共通フィールドです。 この二つを組み合わせて同順位を考慮したスコアランキングを作成したいです。 １位のscoreが３人同点の場合、３人のスコアランキングは１位で次の人は４位になるようにしたいです。 SQLを組んだのですがレコード数が増えるにつれてどんどんSQLが返ってくる速度が遅くなって困っています。 この二つのテーブルの最速のSQLを組みたいのですがどなたか教えて下さい。 とりあえずINDEXは考慮なしでお願いします。 参考までに私が組んだSQLは下記のものになります。 SELECT d.name FROM (SELECT *, (SELECT COUNT(a.score)+1 FROM rankingscoreinfo AS a , rankinginfo as b WHERE a.missionid=10 AND a.skill= 2 AND b.kind = 2 AND a.missionid = b.missionid AND a.name = b.name AND a.score > c.score ) AS score_rank FROM rankingscoreinfo AS c WHERE c.missionid = 10 AND c.score AND c.skill=2 ) AS d , rankinginfo as e WHERE e.missionid = 10 AND e.kind = 2 AND d.skill = 2 AND d.missionid = e.missionid AND d.name = e.name AND d.score_rank >=1 AND d.score_rank <= 55 ORDER BY score_rank
こんにちは質問です。 仕事でいきずまってます。エクセルのスペシャリスト様、ご教授願います。 3人の担当者のsheet（ああ、いい、うう）があり、工場名、工事名称、担当者が記入してあります。 １、集計シートに3人の担当者sheetにあるデータを取り纏め表示させたいです。 ２、集計シートに表示しているように、空白の行は削除したいです。 ３、担当者sheetのデータは別データとリンクされていて常に更新されている。多いときは200～300行位になります。 マクロは苦手です。関数でなんとかなりませんか？ ※毎回１、２の作業は面倒なのでデータを起動させると集計シートに自動でデータを取り纏めたいです。どうすればいいか、わかりません助けてください。
MySQL超初心者です。 現在いろいろストレージエンジンを試しているのですが、テーブル内に格納されているデータのストレージエンジンを調べる方法はないでしょうか？ いろいろ調べてみたのですが、テーブルのストレージエンジンを確認するコマンドにshow table status;がありました。しかしこれでは、データが本当にそのストレージエンジンを使って格納されているかどうかがわかりません。 一覧表示か検索でテーブル内に入っているデータのストレージエンジンを直接参照する方法はないでしょうか？
PHPとMySQLを利用した検索フォームを作成しています。 そこで質問なんですが、2重括弧があればそのカッコ内の単語はすべて検索結果に表れないようにしたいです たとえば、[[test]]というデータがあったとすると、testと検索しても表示されないようにする。 PHPでもMySQLでも構いません。個別に単語を登録する以外でこれを解決する方法はないでしょうか？ よろしくお願いします。
どうしても分からないので教えてください。 先人の書いたphpの記述を解析しています。 postgreSQLとやり取りしている部分に、次のようなselect文の記述があります。 select lpad(seq_no,shiyo_keta,'0'),seq_min,seq_max from seqno_info where seq_key='YAMATODENPYO'; 実行すると次のようなエラーがでます。 ERROR: 関数lpad(bigint, smallint, unknown)は存在しません 茵 1: select lpad(seq_no,shiyo_keta,'0'),seq_min,seq_max from seqn... （lpadのあたりに印が付いていましたが、ここではずれるので消してあります。） HINT: 指定名称、指定引数型に合う関数がありません。明示的な型キャストが必要かも しれません テーブルの型は次のようになっています。 \d seqno_info Table "public.seqno_info" Column | Type | Modifiers ------------+----------+----------- seq_key | text | not null seq_no | bigint | seq_min | bigint | seq_max | bigint | shiyo_keta | smallint | 以下がそれぞれに入っているデータです。 select seq_no from seqno_info; seq_no -------- 999 (1 row) select shiyo_keta from seqno_info; shiyo_keta ------------ 3 (1 row) 調べても有力な情報が見当たらず困っています。 どなたか、ご教示ください。
以下のようなテーブルがあったとします。 select * from T1; +------------+------+ | date | num | +------------+------+ | 2014-01-01 | 1 | | 2014-01-02 | 2 | | 2014-01-03 | 2 | | 2014-01-05 | 1 | | 2014-01-07 | 1 | +------------+------+ このとき、「各日付を起点として、その日を含む過去3日分の合計num数を出力」させるためにはどのようなSQLを書けばいいのでしょうか。 以下のような結果が返ってくることを期待しています。 | date | sum_num | +------------+------+ | 2014-01-01 | 1 | | 2014-01-02 | 3 | ※ 1+2 | 2014-01-03 | 5 |　　※ 1+2+2 | 2014-01-05 | 3 |　　※ 2+1 | 2014-01-07 | 2 |　　※ 1+1 +------------+------+ PostgreSQL 8系なのですが、環境の問題でwith recursive句を使うことができません。 相関サブクエリをうまく使って取得する方法は無いでしょうか。 よろしくお願いいたします。
社員の中で直近の1ヶ月に誕生日を迎える社員を抽出し近い日付から順番に表示したいと思っています。 以前ご教示頂いたコードで出来たのですが、少しおかしい点が見つかりました。 現在では下記のように正常に表示されます。 3月2日　　山田 3月15日　菊池 3月22日　田中 しかし、実際に山田の誕生日である当日（3月2日）になると、山田のデータは一番下に表示されてしまいます。 3月15日　菊池 3月22日　田中 3月2日　　山田 コードは下記のようになっています。 $stmd = date('m/d'); $endmd = date('m/d', strtotime('+1month')); $join = $stmd < $endmd ? 'and' : 'or'; $sql="SELECT office.*, (case when date_format(birth, '%m/%d') <= ? then 1 else 0 end) as sw FROM office where date_format(birth, '%m/%d') >= ? " . $join . " date_format(birth, '%m/%d') <= ? order by sw, date_format(birth, '%m/%d')"; これはどのようにすれば当日になっても順番どおりに表示させることが出来るでしょうか？ ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
社員のデータをテーブルに格納しました。 テーブルは下記のようになっています。inが入社年。outが退社年です。退社年が空白の社員は在籍中を表しています。 テーブル名：office nama(VARCHAR型)｜in(INT型)｜out(INT型) 田中｜2003｜2008 加藤｜1995｜2001 桐谷｜2009｜ やりたい事が二点あります。 (1)「2007年に在籍した社員」と指定した場合。上のテーブルでいうと田中のデータを抽出。 「in<2007 AND out>2007」このような指定をすればいいのかと思ったのですが、空白(現在も在籍中)の場合どうすればいいのか分かりません。 (2)「在籍年数が4年以上6年未満の社員」と期間を指定した場合。上のテーブルでいうと田中と桐谷のデータを抽出。 この場合SQL文はどのようにすれば良いでしょうか？ このテーブルのデータの書き方だと難しいでしょうか？難しければもっとこうした方が良いなどアドバイスを頂けると幸甚です。 ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
教えてください。 現在、ある人の書いたPHPを解析しています。 その中で、postgreSQLを使ってデータをアップデートしている以下の記述があります。 begin;update goods_belong_cat set belong_cat_1='10002', belong_cat_2='10025', belong_cat_3='10086', belong_cat_4='' ,goods_id='1000402' or goods_id='1000393' or goods_id='1000412' or goods_id='1000232' or goods_id='1000241' or goods_id='1000240' or goods_id='1000840' ;commit work; （一行です。） この記述を実行すると、以下のようなエラーが出ます。 BEGIN ERROR: boolean型への入力構文が無効です: "1000402" 茵 1: ..., belong_cat_3='10086', belong_cat_4='' ,goods_id='1000402' ... 　　　　　　　^ ROLLBACK どこに誤りがあるのか分かりません。 どなたかご教示願えませんでしょうか。 Postgreのバージョンは、psql (PostgreSQL) 8.4.13です。 古いバージョンのPostgreでは正常に動いていました。
SQLServer2012のインストールについての質問です。 SSDで起動しているCドライブにインストールし、DATAフォルダを HDDのDドライブにして運用していたところ、わずか3ヶ月でSSDが 壊れました。 原因はLogフォルダへの書き込み件数だと思われます。 日々、数１０万単位のInsert処理が行われていたため、その都度 Logファイルへの書き込みがあったと想定されます。 CドライブにインストールしたとしてLogファイルをDドライブへ 書き出すように設定変更は可能でしょうか？
PHPやMySQLの勉強を兼ねてサッカーチームの試合データをテーブルに格納しました。 テーブルは下記のようにしました。他にもフィールドはありますがとりあえず3つのみ。 左からホームゲーム(H)かアウェーゲーム（A）か。ホームチームの得点。アウェーチームの得点です。 table名：gamedata h_a(VARCHAR型)｜home_score（INT型）｜away_score(INT型) H｜5｜3 A｜2｜1 A｜3｜4 このようなテーブルから「2得点以上5得点未満の試合」を抽出したい場合はどのようなSQL文になるのでしょか？ 上記のテーブルだと「A｜3｜4」このデータだけ抽出されることになります。 問題点だと思うのは下記の二つ。 一つはホームゲームの場合は「home_score」に得点が格納されていますが、アウェーゲームの場合は「away_score」に得点が格納されていることになります。 二つ目はデータがまだ不十分で得点が何も入力されていないデータもあるという点です。こういうデータはスルーしたいです。 ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
SQLServer2012で selectで文字列の末尾から（右から）ある文字の位置までを取り出したいのですが どのようなSQLにすればよいのでしょうか。 やりたいことは、 例えば、文字列「abc 123 xyz」があるとします。 末尾から（右から）見て、最初に見つかった半角スペースから後ろ「xyzを取り出し たいです。 RIGHT を使えば取り出すことはできるのですが、取り出したい文字列の長さが同じ でないので使うことができません。 お願いします。
SQLServer初心者です。 社内で顧客情報を管理するためAccessを使っています。 フォームを使って検索，登録等できるようにしています。 データ量が増えてきたので， テーブルのみSQLServerに移行することになりました。 ただ単にテーブルをSQLServerに移行して クエリ等はそのままで使ってみたところまったく高速化されませんでした。 Accessで行っている動作は以下です。 フォーム上に設置した検索用テキストボックスに「ヤマダ」と入力して 「検索」ボタンをクリックすると リストボックスに「ヤマダ」とつく氏名一覧が出てきて， 該当する氏名をクリックすると，右側にその人の詳細情報が表示されます。 抽出はAccessクエリで行っています。 検索用テキストボックスを使って，Accessのクエリで絞り込みをしているのですが パススルークエリを利用してSQLServer上で絞り込みをすることができるようだと 調べていて知りました。 しかしそのやり方がうまくWEBで検索できずにいます。 パススルークエリの動的パラメータの指定方法をご教授いただきたいです。 よろしくお願いいたします！ 環境は以下です。 SQLServer：microsoft SQL SERVER 2008 R2 Access：Access2007 ODBCデータソースを作成してSQLServerに接続しています。
登録されているレコードが６カ月または１２ヶ月以内か判定し、TRUEならフラグに１を記すSELECT文をご教示お願いいたします。 MySQL5です。テーブル　mytableに、 (1) myName（氏名、varchar(600)、レコード例：加藤太郎） (2) RegistDate（INSERTした日付、timestamp、レコード例：2005-06-25 09:30:00） と２カラムがあります。 考え方としては照会時に、 「本日のサーバーの月度　マイナス　RegistDateの月度 ≧ 7ヶ月（または13ヶ月）」なら「myFlag=1」ということになるかと思いますが・・・ select case when to_days(now()) - to_days(RegistDate) >=7 then myFlag = '1' from mytable とか、 IF THENなどになろうかと思いますが、よろしくお願い致します。
SQL Server+Access.adpを使った、クライアントサーバー型のシステム はみたことがあるのですが、 それを　MYSQL + Accessでは実現できるのでしょうか？ 以前、AccessをインストールしたPCから、ODBCでMYSQL接続して使ったことは あるのですが、ACCESSで作成されたフォームアプリの接続先がMYSQL、という のは可能なのかな？と思い質問しています。 Access そのものは未搭載のマシンに、Accessで作ったアプリをインストールして、 そこから、MYSQLに接続するイメージのものが可能かどうかをお尋ねしているつもりです。 どなたかご教授願います。
Oracle9iでvarchar2(3)に半角スペースを含む′01 ′と′002′が存在する場合、MAXでは′01 ′が取れてくるのはなぜでしょう？
ワードプレスで作ったホームページをあるサーバーでアップしてましたが 突如エラーが出始めた為、サーバーの移転を考えていますが、その新たな サーバーのphpmyadminを起動して、以前のサーバーからエクスポートした mysqlのデータをインポートしようとしましたが、エラー１０４４というのが 出てきてしまい、困っています。 ホームページ制作に関しては素人中の素人な為、ネット上で解決方法を 模索してみるもののいまいち分からず今に至っています。 とりあえず、ネットで調べた方法の１つでmysqlのデータを見れるようにして CREATE DATABASEから始まる記述を削除してみたのですが、これでも 上手くいかず、、。 他にも調べた結果、Dosコマンドの事やルート権限の事も書かれていましたが、 私には難しく、分からずじまいでした。 どこをどうしたらいいのかさっぱり分からず途方にくれています。 このエラーを解消し、データを上手くインポートするにはどうしたらいいのかを 教えて頂けたらと思います。
以下にある二つのテーブル(coursemaster, opencourses)を結合して 月ごとに講義があるかをo,xで一覧にして[期待結果]の様な表を抽出したいです。 coursemaster テーブル course_id | course_name 1 | 経理講義 2 | 財務講義 3 |　 簿記講義 4 | 税理講義 opencoursesテーブル 　　month course_id 200706 | 1　　　 　 200706 | 3 200706 | 4 200707 | 4 200708 | 2 200708　| 4 [期待結果] 　　　　　経理講義　財務講義 　簿記講義 　税理講義 200706　　○　　　　　　×　　　　　○　　　　　　○ 200707　　×　　　　　　×　　　　　×　　　　　　○ 200708　　×　　　　　　○　　　　　×　　　　　　○ 以下の様なSQL文で表を結合してみたのですが 日付の値が重複されてしまい、期待通りの結果になりません。 誰かご教授いただけないでしょうか？ SELECT month AS 開講日 ,CASE WHEN course_name='経理講義' THEN '○' ELSE '×' END AS 経理講義 ,CASE WHEN course_name='財務講義' THEN '○' ELSE '×' END AS 財務講義 ,CASE WHEN course_name='簿記講義' THEN '○' ELSE '×' END AS 簿記講義 ,CASE WHEN course_name='税理講義' THEN '○' ELSE '×' END AS 税理講義 FROM OpenCourses AS OC INNER JOIN CourseMaster AS CM ON OC.course_id = CM.course_id ORDER BY 1 ;
助けてください……(T-T) oracleをつかっていますが、SQLが苦手すぎて、どうしたらいいか分かりません。。。 解決策をご存じの方、教えていただけないで しょうか？ テーブルは下記の2つがあります。 (1)Aテーブルの1カラムに、複数の商品IDを格 納している（カンマ区切り） (2)Bテーブルには、商品ID＆商品名の一覧が ある このAテーブルの商品ID列に番号から、Bテー ブルの商品名を取得したいです。 ■Aテーブル no | 商品ID 1001 | 1、2 1002 | 1、2、3 1003 | 3 ■Bテーブル 商品ID | 商品名 1 | 商品A 2 | 商品B 3 | 商品C ■とりたいデータの形 1001 | 商品A、商品B 1002 | 商品A、商品B、商品C 1003 | 商品C カンマ区切りで格納しているとin句は使えな いと知りました。。 テーブルにカンマ区切りで格納することは、 変えることはできませんし、 SQLで1回で取得しなきゃいけないのです。 そんなこと、可能なのでしょうか。。 明日の朝までに教えていただければ、 すごくすごく助かります。。 すみませんが、宜しくお願いします。
AccessからレポートのPDF出力を考えています。 DoCmd.OutputTo acOutputReport, Source, acFormatPDF, FileName Access2007以降なら上の文でPDF出力できますが、Access2003とExcel2010がインストール された環境で、Access2003からExcel2010の機能を使ってPDF出力させることは可能でしょうか。 AccessからExcelのワークシート関数を使ったり、Excelファイルを開いて編集することはできたので、 PDF出力もできるかもしれないと思い、質問しました。
こんにちは質問です。 仕事でいきずまってます。エクセルのスペシャリスト様、ご教授願います。 3人の担当者のsheet（ああ、いい、うう）があり、工場名、工事名称、担当者が記入してあります。 １、集計シートの検索欄に工場名を入力したら、 　　3人の担当者sheetにあるデータと一致する工場名の行を表示させたいです。 ２、担当者の名称を入力したら、その担当の工事をすべて表示したいです。 ３、工場名および担当者名を入力したら 　　3人の担当者sheetにあるデータと一致する工場名及び担当者の行を表示させたいです。 すべてを網羅できますでしょうか？ マクロは苦手です。関数でなんとかなりませんか？
先人の書いたPHPを解析しています。 PostgresSQLとのやり取りをしている記述で、どうしても分からないところがあるので、教えてください。 select count(*) from yamato_order_info yo where yo.maker_system_id in (select mbs.maker_system_id from maker_base_info mbs where mbs.maker_name like '%$_GET[txtSearch]%'); fromでyoとmbsと書かれた部分があります。このデータベースには、そのようなテーブルが無いのですが、これは、Postgresの構文でしょうか？ また、(　の直前のinについてもなんとなくは理解できますが、ネットを調べても出てきません。 古い記述なので、最近のものには対応していないのかもしれません。 どなたかご教示願えませんか。 また、このような場合どのように調べれば良いでしょうか。
すみません、SQLを教えてください。 ID, 名前の2つのフィールドを持つテーブルがあります。 中身は以下のように入っています。 1, AAA 2. AAA 2, BBB 3, CCC 3, AAA 4, DDD 5, EEE, 5, DDD これを、名前のダブリをスキップしながら、 IDの大きな順番に名前を取り出したいのです。 結果は、以下のようになればいいです。 DDD EEE AAA CCC BBB どのようなSQLを組んだら実現できますか？ よろしくお願いいたします。
環境)OS:Windows8.1・Access2013 Accessでフォームを作っています(初めてです)。簡単に言うと、 (1)イベントが発生し、メッセージボックス。 (2)「はい」をクリック。 (3)マクロを呼び出す。←ここで困っています！ ネットで調べたものを試してみても、うまく行きませんでした。 回答よろしくお願いします。
エックスサーバーを借りたのですが、phpMyAdminでトリガーが作れません。 そもそもトリガーのタブがなく、データベースを選んでSQLコマンドでトリガーを作成すると、 #1227 - Access denied; you need the SUPER privilege for this operation と出て「SUPER権限がないために実行できない」ようです。 phpMyAdminのトップ画面には「特権なし」と書いていますし、どうすればトリガーを作成できるのでしょうか？ そもそも作成できないのでしょうか？ エックスサーバーのマニュアルにも記載されておらず、ネットで検索しても出てきません。 何かおわかりでしたらお教えください。 どうぞよろしくお願い致します。
お世話になっております。データベースのテーブルの別け方について質問させて下さい。 例えば、会員制のブログサービスを公開するとして、各会員の個人情報を収めるmemberというテーブルを以下のような構成で用意したとします。 （idはURLの一部となるもの） no　　id　　　mail　　　pass　　name　　blog_title 1　　lala　***@***.com　1234　　佐藤　　私の日記帳 2　　tecno　**@***.com　5432　　石田　　明日は何処へ 3　　nonno　**@***.com　9812　　毛利　　音楽大好き 上記は、会員の個人情報と併せ、ブログのタイトルなども1レコードで済むことが出来るので、会員情報とブログの情報も登録したケースです。 対して、以下は会員情報とブログ情報を別けた場合です。 memberテーブル no　　mail　　　pass　　name 1　***@***.com　1234　　佐藤 2　**@***.com　 5432　　石田 3　**@***.com 　9812　　毛利 blog詳細テーブル(member_noとnoで紐付けている） no　member_no　id　　　blog_title 1　　1　　　　lala　　私の日記帳 2　　3　　　　nonno　音楽大好き 3　　2　　　　tecno　明日は何処へ 例えばhttp://blog.sample.com/lala/ というURLにアクセスされた場合、１つのテーブルに情報が収められている場合、個人情報が登録されたテーブルに接続しなければなりませんが、ブログ情報だけを別にしたテーブルを設けていると、個人情報が登録されたテーブルには接続しなくても済むかと思います。 ここで質問させて下さい。 以前、1つのレコードで収まるなら、複数のテーブルを用意する必要はないといった意見を聞いたことがあるのですが、上記のような2つのケースの場合、やはり貴重な情報を含まれたテーブルは、極力、接続機会を減らす方が良いのでしょうか？ 今日まで、1つのレコードで収まるなら複数のテーブルは用意することなく来ましたが、もしかして、 ・2つのテーブルに別けようが、１つが漏洩したら全て漏洩したと同じだ。だから1つにまとめて問題ない。 ・貴重なテーブルは接続機会を減らすべきだ。 というような意見があるのでは？と、意見を伺えればと思い、質問させて頂きました。 お忙しいとは思いますが、ご意見のほど宜しくお願い致します。
こんにちは。 改行を含む文字列「abc改行def」をVARCHAR型のカラムに登録した時に、文字列「改行def」が削除されてしまい困っております。解決方法をご存知の方がいらっしゃいましたら教えて頂きたいです。
PDOを利用してprepareとbindValueでPDO::PARAM_INTなどと型指定をしてINSERTしているのですが、ネットをいろいろ見てみると「型指定をしてもexecute()時に全ての型は文字列として扱われる」と書いています。 これはデータベースの各カラムの型は無視して全て文字列としてINSERTしているのでしょうか？ それともデータベースの型にMySQL側で勝手に変換して値を挿入してくれるのでしょうか？ INSERTした数値を含むデータをprepareでSELECTしてexecute()してみると数値を含めて全てのカラムがstringとして取得しています。 MySQL側ではカラムの型をINTやFROATとして定義しても数値を文字列として挿入するとMySQL側も文字列として扱うのですか？それとも数値に変換されて挿入されますか？ もし文字列として挿入されたらインデックスに影響しますか？ いまいちどうすればいいのかわかりません。 一応 $id = 1; $name = "hoge"; $float = 0.055; $stmt = $dbh->prepare("INSERT INTO REGISTRY (id, name, float) VALUES (:id, :name, :float)"); $stmt->bindValue(:id, $id, PDO::PARAM_INT); $stmt->bindValue(:name, $name, PDO::PARAM_STR); $stmt->bindValue(:float, (string)$float, PDO::PARAM_STR); としています。 あと、PDO::PARAM_FLOATはないみたいで、PDO::PARAM_STRにすべきと書いていますが、このように指定してもMySQL側で勝手にFLOAT型に変換して値をINSERTするのでしょうか？ どうぞよろしくお願い致します。
ご質問事項 文字列の真ん中くらいに"会員番号○○○○○○"があるのですが、SQL文でその部分だけ抽出したい場合、どのようにしたらよいでしょうか？ 状況 文字列の最初から"会員番号"の手前までの文字数が、データによって異なっているケースがあるので、substringで開始位置が定めることが出来ない状況です。 何卒よろしくお願いします。
以下の様なテーブルとフィールドがあります。 ============= テーブル：words //英単語と意味です フィールド：word(主キー),meaning テーブル：examples //例文です フィールド：word(主キー),example ============= 入っているデータは、 ============= [words] word, meaning -------------- woman,女性 big, 大きい shoes, 靴 [examples] word,example -------------- woman,This woman wears big shoes. ■ ■ ============= exampleテーブルのexampleフィールドの「This woman wears big shoes」に含まれるbigとshoesを 自動的にwordsテーブルから抜き出して■の位置に 【big,This woman wears big shoes.】　 【shoes,This woman wears big shoes.】 とexampleテーブルに付与したいのですがなにかいい方法はありますでしょうか。 すでに入っているwomanは抜きたいです。 もしかしてデータベースの構造がおかしいかもしれません。出来ればご享受願えればと思います。
環境 OS:windows8 XAMPP：ver1.7.3 ウィルスソフト：市販のものは使ってません。 状況： 同じPCで以前まで使えていたのですが、windows8の自動更新の影響かわかりませんが、 XAMPPを立ち上げて、Apacheはスタートボタンを押して「Running」のステータスに かわりますが、MySqlはスタートボタンを押して「Running」のステータスに 変わりません。。 MySqlはスタートボタンを押したその後の ステータスは 「MySql started busy...」 となります。 どなたか同様の問題で解決された経験の方がいらっしゃいましたら お知恵をいただければ幸いです。 よろしくお願い致します。
アクセスでケーキ店のスタンプカード管理を作成したいです。 3店舗あります。 購入されたお客様にスタンプカードを渡します。 （渡すだけなので、顧客情報は得られません） スタンプカードは、どの店舗でも使えます。 スタンプカードは500円毎に1回押します。 20個たまったら、300円に金券として使えます。 スタンプカードを回収した時点で、顧客情報が得られます。 （第1目的） 最近、カードを金券として使われたお客様に、お知らせハガキを送付 （第2目的) 誕生日の前月に、お祝いのハガキを送付 （第3目的） カードの利用回数が多い人に、ハガキを送付 （質問1） テーブル設計で悩んでいます。 カードを回収した時に、子供の名前と誕生日を記入してもらう時もあります。 カードは親だけれど、子供宛てにお祝いのハガキを送付したいからです。 下記4つのテーブル構成でよろしいでしょうか？ tbl顧客（テーブル名） 顧客NO（オートナンバー） 顧客名 誕生日 性別 住所 TEL email tblカード回収日（テーブル名） 顧客NO カード回収日付 回収店舗 tbl家族（テーブル名） 顧客NO 家族名 誕生日 性別 tblカード回収店舗（テーブル名） 顧客NO 店舗 （質問2） バースデイケーキを注文されたお客様の情報がペーパーであります。 注文者名 誕生日の方の名前 誕生日 TEL （住所は聞いていません） バースデー管理は、別に作成した方がよいでしょうか？
連続投稿で失礼いたします。 SQLServer初心者です。 microsoft SQL SERVER 2008 R2を使用しています。 SQLサーバーにデータベースを作成し， それをAccessにリンクして，フォームで見たいと思っています。 データーベースは社内サーバに置いてあります。 社内サーバにアクセスできる人であれば， SQLサーバにユーザー登録をせずにデータを閲覧することはできないでしょうか？ いちいち全員ユーザー登録して，ユーザーごとに権限を与えるのが面倒だと考えています。 初歩的な質問で大変恐縮です。 よろしくお願いいたします。
MS SQL server 2005 express edition をWindows７のパソコンにインストールをしたいです。 必要なインストール物、必要な環境条件など分からない素人です。 教えていただけないでしょうか。 以下の２つで宜しいのでしょうか？ Microsoft SQL Server 2005 Express Edition Service Pack 3 Microsoft SQL Server Management Studio Express Service Pack 3 .NETFrameworkのバージョンやWindow7の更新プログラムやサービスパックなどは どのような環境であれば宜しいのでしょうか？ すみません。よろしくお願い致します。
Oracleのストアドについて質問です。 32bit版ではコンパイルが通るのに、64bit版ではコンパイルが通りません。 Ora-00918列定義が未確定がでます。 列名ではなく、列番号で指定するとコンパイルが通るようになります。 ただし、きちんと値をとってきていない。 ・Oracle10.2.0.3 x32(windowsServer2003x32)でOK。 ・Oracle10.2.0.5 x64(windowsServer2008x64)ではコンパイルエラーになります。（Ora-00918） 列定義が未確定がでます。 同じくOracle11.0.1x64(windowsServer2008x64)でも同じエラーが出ます。 文字コードはS-JISです。 Oracle10.2.0.5にアップのパッチを当てています。 64bitでなにかあるのでしょうか？
ただいま以下の一つのテーブルを正規化しようとしています。 テーブル：英単語 フィールド：単語、意味1、意味2、意味3、品詞、分類1、分類2、分類3、例文、難易度、ID（主キー・オートインクリメント） これを以下のように分けました。（分類とは単語の分類です。例えば year なら意味は 年 で分類は 時間 とか 単位 とか属性を入れたいのです。） ＊＊＊＊＊＊ テーブル：英単語 フィールド：単語、意味1、意味2、意味3、分類ID、分類ID、分類ID、例文ID、難易度、ID（主キー・オートインクリメント） テーブル：分類 フィールド：分類名、ID（オートインクリメント　主キー） テーブル：品詞 フィールド：品詞名、ID（オートインクリメント　主キー） テーブル：例文 フィールド：例文、ID（オートインクリメント　主キー） ＊＊＊＊＊＊ (1)これで正規化できているでしょうか？ もしできていないなら、どうすればよいでしょうか？ (2)また、仮にこのままデータベースを作るとすると、INSERTの時に英単語テーブルの分類IDに、分類テーブルのIDをひもづけるにはどうしたら良いのでしょうか？ INSERT INTO 分類 (分類名) VALUES("時間") のあと、オートインクリメントされたIDを取り出して、英単語テーブルに入れるにはどうしたらいいでしょうか。
SELECT文で質問があります。 商品情報を格納したテーブルを作成し、「商品名を検索するとその商品番号を取得する」という単純なSELECTですがうまくいきません。 ■tb_items　→　商品情報を格納しています。 -------------------------------------------- 商品番号　サイズ　重さ 001　　　50　　　120 002　　　30　　　200 -------------------------------------------- ■tb_details　→　店舗毎の情報を格納しています。 -------------------------------------------- 商品番号　店舗番号　商品名　　　　　　　価格 001　　　shop_A　　シャープデジカメ　　50000 001　　　shop_B　　シャープcamera　　　56000 002　　　shop_A　　パナソニックスマホ　85000 002　　　shop_B　　Panasonicスマホ　　 79000 -------------------------------------------- ここで、「商品名を検索するとその商品番号を取得できる」としたいのですが、例えば「シャープ」で検索すると商品番号001を取得できますが、「sharp」で検索すると当然ですが商品番号001は取得できません。 そこでタグのようなものを登録するテーブルをさらに作成しました。 ■tb_tags -------------------------------------------- タグ　　　　　商品番号 sharp　　　　　001 カメラ　　　　 001 スマートフォン 002 携帯　　　　　 002 -------------------------------------------- 試しに「sharp カメラ」を検索してみました。SELECT文は以下のようにしました。 -------------------------------------------- SELECT 　tbI.`商品番号` FROM 　tb_items AS tbI LEFT JOIN 　tb_details AS tbD ON tbI.`商品番号` = tbD.`商品番号` LEFT JOIN 　tb_keywords AS tbK ON tbI.`商品番号` = tbK.`商品番号` WHERE 　( 　　((tbK.`タグ` = 'sharp') OR (tbK.`タグ` = 'カメラ')) OR 　　( 　　　(tbD.`商品名` LIKE '%sharp%') AND (tbD.`商品名` LIKE '%カメラ%') 　　) 　) -------------------------------------------- 取得した結果は、 001 001 というように同じ商品番号を重複して2つ取得してしまいます。 検索を「シャープ camera」にしても重複して2つ取得してしまいます。 やりたいことは、「検索文字列（空白区切りあり）で商品名とタグを検索してヒットした商品番号を重複なしに取得したい」です。 どのようなSELECT文にすれば良いのでしょうか？ お手数ですがアドバイスを頂けたらと思います。 どうぞよろしくお願い致します。
はじめまして Windows Server 2008 SQL SERVER 2008 R2 IIS7.0 Microsoft Visual Web Developer 2010VB の環境で動作させています。 一台のサーバーマシンに、SQL SERVER 2008R2,IIS7.0をインストールした状態なのですが、Webページ上のMicrosoft Visual Web Developer 2010VBのプログラム（新しいwebページのデフォルト）によりログインページにてデーターベースをアクセスすると CREATE DATABASE 権限がデータベース 'master' で拒否されました。 と、メッセージが出ます。 Microsoft Visual Web Developer 2010のデバッグでは実行できるのですが、 OS,データーベースの動作環境の設定がうまくできていないのでしょうか？ 当方サーバーの設定およびデータベースの知識がないため、今回のことに対して掲示する情報がわかっていません。 この情報がほしいなどありましたら教えてください。 また現在の目標はMicrosoft Visual Web Developer 2010のwebページ新規作成にて構築されるデフォルトのwebページを動作させることです。 お願いいたします。
現在、Access2010+PostgreSQLにて業務システムを構築しております。 Access内では、ODBC接続によるパススルークエリーを用いて、 直接データベース内のレコードの取得を行っています。 質問は、この操作を有線LANで行うと特に待つことも無くレコードの取得が 出来るのですが、無線LAN経由で同操作を行うと、 開くまでに以上に時間がかかり、取得する件数によってはタイムアウトしてしまう事もあります。 （例えば、レコードの取得件数を1件にすれば開きますが、100件にするとタイムアウトします） ただし、無線LAN自体の接続自体は電波強度も良好ですし、 ブラウザでのWebサイト閲覧などは特にストレスなく行う事が可能です。 また、同じデータベースをデータベース管理ツール（PgAdminなど）では 特にタイムアウトなどする事なく、テーブルの中身を閲覧することが可能です。 （レコード件数は数千件です） どうも「Access+PostgreSQL（ODBC接続）」と「無線LAN」を組み合わせた時だけ 接続が遅くなっているような状況です。 レコードの取得と言っても何万件・何十万件のレコードを取得するわけではありませんし データのやり取りと言っても基本はテキストデータのやり取りだと思いますので そこまで回線の太さ速度が関係しないような気もします。 これはAccess・PostgreSQL・ODBCの設定で解消するのか それとも無線LAN自体の問題でしょうか。 分かる方教えてください。
phpmyadminで日本語のデータだけ文字化けしてしまいます。 phpで作成された掲示板からデータをmysqlに投稿し、そのデータを再度掲示板で表示しています。 投稿・表示するphpファイルはutf8で、mysqlのmy.cnfは以下のようになっています。 --------------- [mysqld] datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock user=mysql # Disabling symbolic-links is recommended to prevent assorted security risks symbolic-links=0 character-set-server=utf8 [mysqld_safe] log-error=/var/log/mysqld.log pid-file=/var/run/mysqld/mysqld.pid [mysql] default-character-set=utf8 [mysqldump] default-character-set=utf8 --------------- phpmyadmin（2.11.11）側は、MySQ の接続照合順序:utf8_unicode_ci にしています。 phpmyadminで文字化けしているデータをphpで見ると問題なく表示されてるのが不思議です。 どこが問題なのでしょうか。
Access2013でフォームを作っています。コンボボックスを使ってレコードを検索するコードを作ったのですが、もし、コンボボックスの内容に対応するレコードがなかった場合、新しくレコードを作るコードは、どう書くのですか？情報不足でしたらすいません。 環境）Windows8.1 　　　 Access2013 回答よろしくお願いします。
oracleのシーケンスでdual表からselect文のnextvalで取得したものをインサート したいのですが、ループ内で上記処理を複数回行ったときに、値が一回目以降 更新されずに困っています。 例） for (i=0;i < 5){ (1)セレクト文発行しシーケンスを取得。 (2)取得したシーケンスを変数にセット (3)インサート実行（主キーに取得したシーケンスをセット） } こんな感じで実行したときに、はじめはシーケンスが+1されますが、 それ以降シーケンスが増加しません。そのため、重複エラーが発生してしまいます。。。 どのように対処したらよいのかまったく見当がつきません。 大変申し訳ないのですが、ご教示いただきたくよろしくお願い申し上げます。
プログラム初心者です 掲示板のレスを削除フラグを立てて後からメンテの時に削除するようにしました 将来行う削除する方法なんですが、daleteで行を削除するのではなく、カラムに入っている内容を削除しただけでもパフォーマンスはよくなりますか？残った行はid番号だけにする予定です 例えば100ＭＢの容量が70ＭBくらいになるイメージです それともメンテの時に行を削除したほうがいいでしょうか？ 大体の経験からの判断でいいのでよろしくおねがいします
プログラム初心者です phpとmysqlで簡単な掲示板を作りました 一つのテーブルでsure_idごとにスレッドをつくり、resu_idでレス番号をつくっています そこで削除フラグがある場合にはそのレスを表示しないようにしたいのです 素人なのでこんな方法しか思い浮かばないのですがこれで大丈夫でしょうか？ 5番のスレッドを全て取得し、削除フラグがない行を全て取得 SELECT * FROM bbs WHERE sure_id=5 and dll_flg=0 質問1 削除フラグはどのような立て方が良いでしょうか?0と1でしょうか？ 質問2 削除フラグのカラムにもインデックスを張ったほうが速いですか? 質問3 phpでいちいちif文で判定するよりsqlで表示判定したほうが早いですよね？ よろしくお願いします
こんばんは 何をどうやっても進まないのでここで質問させてください。 Windows 8にwamp (Apache 2.2.22, PHP 5.4.3) を入れています。 SQLite3を使いたいのですが、sqlite_open 関数に対して「undefined function」というエラーが出てしまいます。 php.ini の内容は次のようになっています。 ;ここから extension_dir = "c:/wamp/bin/php/php5.4.3/ext/" (中略) extension=php_pdo_sqlite.dll ;extension=php_sqlite.dll extension=php_sqlite3.dll (中略) [sqlite] ; http://php.net/sqlite.assoc-case ;sqlite.assoc_case = 0 [sqlite3] sqlite3.extension_dir = "c:/wamp/bin/php/php5.4.3/ext/" ;ここまで 実際、エクステンションディレクトリには php_pdo_sqlite.dll php_sqlite.dll php_sqlite3.dll があります。 phpinfo(); では PDO drivers：mysql, sqlite SQLite Library：3.7.7.1 [sqlite3] SQLite3 support：enabled SQLite3 module version：0.7 SQLite Library：3.7.7.1 sqlite3.extension_dir：c:/wamp/bin/php/php5.4.3/ext/ いったい何が行けないのでしょうか、iniの値を変えるとphpinfo()も変わるので誤った設定ファイルをいじっているのではないと思います。 バージョンなどは冒頭に記載しています。 よろしくお願いします。
こんにちは。 タイトルが上手くまとまっておらず、すみません。 以下のようなことを実現したいと思っております。 カラムc1(INT型)とカラムc2(INT型)をもつテーブルt1があるとします。 「INSERT INTO t1(c1) VALUES(1);」などと実行した場合、自動的にカラムc2が以下のように同一のカラムc1の値同士の中で連番されていくようにするテーブル定義はできないでしょうか。 ↓「SELECT c1, c2 FROM t1 ORDER BY 1 ASC, 2 ASC;」を実行した様子 1,1 1,2 2,1 3,1 3,2 ※ フォントの違いによる形崩れは免れないと思い、CSVのようにカラムの区切りをカンマで、レコードの区切りを改行で表現しています。 言うまでもなく、c1とc2の組は必然的にユニークになります。 ご教授、お願いします。
mysql初心者です 行数を取得したいです 処理をすこしでも軽くしたいです このように書くとテーブルの中身は見に行かないらしいのですが SELECT COUNT(*) AS cnt FROM bbs WHEREをつけると中身を見に行きますか? SELECT COUNT(*) AS cnt FROM bbs WHERE sure_id=5 中身を見に行く場合、カラムを指定したほうが早いでしょうか? SELECT COUNT(id) AS cnt FROM bbs WHERE sure_id=5 よろしくお願いします
今jspファイルでボタンを押すとサーバーにあるデータベースの結果をcsvファイルとして保存するファイルを作りました。 今、作業用のパソコンからテラタームを使い、リモート接続で作業をしています。 なので出力するcsvファイルをサーバーの方ではなく、作業用のパソコンに落としたいのですが、方法はないですかね？ 今はjspのほうでSELECT * FROM テーブル名 INTO OUTFILE のコマンドをmysqlに送っています。 phpmyadminで接続してそこからcsvファイルを落とすと閲覧しているパソコンに落ちるようになってるのでそ それができたらなと思います。 何かいい方法はないでしょうか？ よろしくお願いします。
こんにちは。 SQLite3で次のようなクエリを書けるかどうかご存じの方、教えてください。 文房具の商品レコードを格納したテーブルがあります。 えんぴつ50円、ノート100円、ホチキス150円といった具合です。このテーブルから無作為にレコードを取り出し続けたいのですが、取り出した複数レコードの金額の合計が1000円を超えたところでストップしたいです。1050円でも1200円でもいいのですが、超えたところで止めたいのです。 インターフェイスとしてPHPを予定していて、そこででごにょごにょすればできるのですが、そもそもSQLの時点でこうしたことができるのかご存じの方教えてください。
タイトルの件について、分かる方おりましたらどなたかご教授ください。 [DBサーバ] Linux CentOS 6.4 CPU Xeon core4 SSD 250GB RAM 32GB バージョン情報 MySQL 5.5 tomcat 6 JDK 6 会員データをCSVから大量にUSERテーブルへINSERTする処理を行っています。 また、それに関連するデータも同時にINSERTをします。 (USER_ID を持っている SERVICE_POINTテーブルやADDRESSテーブル) 処理の流れとしては以下となります。 (1) 会員情報の入ったCSVファイルをサーバへアップロード (2) 1でアップロードしたCSVファイルを○○○○件毎に一時ファイルに切り分ける ～～ ここからバックグラウンドで実行 ～～ (3) 2で切り分けたファイルをループで回しながら、メアドの重複やフォーマットエラーなどを判定する (4) 3でエラーがあれば即座にERRORSテーブルにエラー詳細をINSERTし、コミット＆continue; (5) 3でエラーがなければUSERテーブル・SERVICE_POINTテーブル・ADDRESSテーブルへINSERT処理 (6) その他関連するテーブルへUPDATE処理 (7) 3に戻る ストレージエンジンは全てInnoDBです。 my.cnfのInnoDBの設定は以下の通りです。 innodb-buffer-pool-size = 24G innodb-log-buffer-size = 8M innodb-log-file-size = 1024M innodb_log_files_in_group = 3 innodb_fast_shutdown = 0 innodb_data_file_path = ibdata1:10M:autoextend innodb_file_io_threads = 4 innodb_change_buffering = all innodb_thread_concurrency = 16 innodb_flush_log_at_trx_commit = 2 innodb_max_dirty_pages_pct = 90 innodb_flush_method = O_DIRECT innodb_lock_wait_timeout = 120 innodb_additional_mem_pool_size = 128M innodb_file_format = Barracuda innodb_file_per_table = 1 なお、ERRORSテーブルのINSERTは非常に速いです。 会員数が全くない状態だとスムーズに登録されていくのですが (1秒に15件程度) テーブルが肥大化して20万件を超えると１秒に１件ほどしかINSERTされません。 この速度を少しでも速くしたいなと思っています。 １件ずつコミットしているのには理由があります。 ただ、1000件ずつコミットしても速度はほぼ変わりませんでした。 こういう場合、やはりパーティショニングを検討しなければならないでしょうか。 よろしければどなたかご教授ください。 以上、よろしくお願いいたします。
WEB上でリッチテキストエディッタで入力した内容を そのままデーターベースに保管したいです。 最大文字列などが想像できませんが、かなり文字数が多くなる場合もあると 考えております。 その場合、保管先になるデーターベースの型と値は何を指定しておくと いいのでしょうか。 ご教授いただけると助かります。 よろしくお願いいたします。
たとえば銀行口座に2/4時点で100万円あったとします。 2/10に-10万円 2/25に+20万円 2/27に-1万円 というような感じで、日付と入出金額をDBに入れていきます。 このとき、ある日付時点での残高を表示するにはどうしたらいいでしょうか。 つまり、 2/4　100万円 2/10　90万円 2/25　110万円 2/27　109万円 という結果が得られるようにしたいです。 Excelを使えば簡単ですが、そのほかにもやることがあるのでDBを使っています。
以下のテーブルの様に時系列が抜けているテーブルから直近2年度連続で減少していない年度を 抽出しようとしています。 /* year|sale --------- 1990|50 1992|50 1993|52 1994|55 1997|55 */ /* CREATE TABLE sales2 (year INTEGER NOT NULL , sale INTEGER NOT NULL , PRIMARY KEY (year)); INSERT INTO sales2 VALUES (1990, 50); INSERT INTO sales2 VALUES (1992, 50); INSERT INTO sales2 VALUES (1993, 52); INSERT INTO sales2 VALUES (1994, 55); INSERT INTO sales2 VALUES (1997, 55); */ 以下の記述で直近の年度までなら表示できているとは思うのですが2年連続となると やり方が思いつきません。誰かご教授いただけないでしょうか？ select year,sale from sales2 s1 where sale >=(select sale from sales2 s2 where s2.year = (select max(year) from sales2 s3 where s1.year > s3.year)) order by year ;
下のようなデータベースがあります。 左側に識別の数字が、右側に大名家の名前があります。 私を困らせているのは識別する数字と大名家の名前が1対1のシリアルの関係になっていないことです。 データベース 101　島津 101　大友 102　毛利 103　三好 103　足利 103　斉藤 104　織田 105　徳川 105　武田 105　今川 105　上杉 105　北条 これを下の絵のように「入力場所」に任意の数字を入れることで、「表記場所」にその数字に紐付けられた大名家の名前を表記させるにはどうしたら良いでしょうか。「表記場所」は５箇所です。 VLOOKUPではうまくいきませんでした。 データが、たとえば103には三好、足利、斉藤の３件が紐付けされているため、1対1の対象になっていないのです。助けてください。 入力場所　　　表記場所 103　　　　　　　三好 　　　　　　　　　足利 　　　　　　　　　斉藤
ACCESSでデータを統合する方法に関して質問です。 Accessはユーザーレベルなのですが、現在仕事でAccessのシステムを使用しています。 上司から、データをAccessで統合してインポート用のファイルを作成してほしいとの依頼がありました。 ただ、私はAccessで開発したことはないので本をみながら確認してみないとと言ったのですがそれでもということで指示されました。たぶん、そんなに難しくないことなのかもしれませんが初心者なのでAccessの構造がいまいち理解できておらず、なかなか進みません。 現在やっている作業は Accessへインポート用のエクセルのフォームに必要な情報をExcelの二つのシートから抽出しようとしています。 Accessでインポート用のデータを作成しているのですが、下記の作業をしました。 インポート用のエクセルフォームをAccessのテーブルへインポート、必要な二つのシート（(1)と(2)）を一つずつインポートしてテーブルを3つ作成しました。 クエリで、(1)と(2)の必要な情報だけ抽出しましたが、そのクエリの情報をインポート用のテーブルに必要なセルだけ関連づけたいのです。空白のセルもありますが元のAccessで作成したシステムに最低限の情報を入れれば登録できます。現在は、必要な情報を手入力で入力しているので毎月一回の作業なのですが、ツールなどで一括で入力したいと思った為、作成しています。本なので確認しているのですが、初心者なのでうまくいきません。 よい方法があれば教えて下さい。 例＞インポート用のテーブル 氏名 所属 負担部門 購入品 シリアル番号 受付番号 機種名 レンタル番号 管理番号 設置場所コード 設置場所 必要なシート(1) 氏名 所属 負担部門 購入品番号 受付番号 レンタル番号 必要なシート(2) 購入品番号 機種名 シリアル番号 設置場所 (1)と(2)をクエリで 氏名 所属 負担部門 購入品 受付番号 レンタル番号 機種名 シリアル番号 設置場所を表示できるようにしました。 (1)と(2)のデータは同じ行数分で購入品番号で連携させています。 上記の情報をインポート用テーブルに落とし込む方法です。 リレーションとか？いろいろと調べているのですがなんとも理解できていないようでなかなかすすみません。宜しくお願いします。
PostgresSQLに詳しい方、教えてください。 現在、私はネットショッピングサイトのサーバ管理をしており、データベースにPostgresSQLを使ってます。 サーバのハードが老朽化してきたため、今までの自社サーバーをやめ、レンタルサーバをかりてそこへサイト移転することになりました。 PHPやHTMLといったソース類は、容易に移転できたのですが、データベースの移転がうまく行かず困っております。 どなたかご教示ください。 ■環境(移転元) サーバ：自社サーバ OS：Linux version 2.4.20-16.9 Postgresバージョン：psql (PostgreSQL) 7.3.4 ■環境(移転先) レンタルサーバ会社：さくらインターネット サービス名：さくらのVPS(v3) 1G OS：Linux version 2.6.32-279.1.1.el6.x86_64 Postgresバージョン：psql (PostgreSQL) 8.4.13 ■現象 移転元のサーバにて、pg_dump -i コマンドを実施。 生成されたダンプファイルをFFFTPにて自分のWindows7のマシンに保存。 Windows7上のエディター(DreamWeaver)でファイルを開くと文字化けしています。 エディターのエンコードをシフトJIS→EUCに変更するとデータベースに入力されている文字列をきちんと見ることができます(一部文字化けは残るのですが。)ので、ここまでは成功しているように思っています。 このダンプファイルをFileZillaにて移転先のサーバにアップロード。 psqlコマンドでリストア。 あらかじめ、移転先のPostgresには移転元のデータベース名と同じものを作成し、ユーザー名も同じものを作成してあります。 ところが、いざselectコマンドを使いデータを検索してもあるはずのデータが出てきません。 テーブルはきちんと作成されているようなのですが。 どうしたらデータをきちんと移転できるのでしょうか？ どなたか、ご教示頂けないでしょうか。
Accessでクエリに式を入れてあるのですが、 その式をSQLのwhere句で抽出できないものでしょうか？ クエリ（管理台帳クエリ）のフィールドの式は 次回検査日: DateAdd("yyyy",[検査周期],[最終検査日]) となっており、VBAで ｓｔｒSQL = "select 次回検査日 from 管理台帳クエリ where 次回検査日 <= #" & txtDate & "#" lstTbl.RowSource = strSQL を実行してもlstTblには何も表示されません。 ｔｘｔDateは日付の入っているテキストボックス、lstTblはリストボックスです。 検査周期と最終検査日は、管理台帳テーブルに定義されているフィールドで、 検査周期には、１～３の数字が入っています。 ちなみに最終検査日に変えてみると、問題なく抽出できます。 いろいろ調べてもよくわからず、煮詰まっています。 次回検査日をテーブルに定義するしかないのでしょうか？ よろしくお願いします。
アクセスを使ってシフト表を作ろうとしています。 予定を入力する際に定期的な予定 例えば　10:00-11:00の予定が毎週の月～金である場合に 1件ずつ入れるのではなく、チェックボックスなどでチェックを入れ 指定した曜日、日付でもいいので簡単に入力出来ないかと思っています。 そのような事は出来るでしょうか？ 出来るのであれば、どのようにしたらよいでしょうか？ よろしくお願いします。
お世話になります。 oracle11.2で とあるテーブルに select * from テーブル名（条件なし） としたらフリーズする現象が起きました。 元々のテーブル内には２５万行のデータがあったため 同じ構造で違う名前のテーブル（データは１行もなし）を新規作成して 同じようにselect文をなげたところこちらもフリーズしてしまいました。 構造は約５０の列があり 列数を指定して検索した場合、どちらのテーブルも結果が返ってきますが すべての列を指定しようとするとフリーズしてしまいます。 どのあたりを疑えば良いでしょうか？ よろしくお願いいたします。
ACCESS VBA を使って処理を行っております。 原因が分からず困っております。 結果テーブル 　フィールド名　monoＩＤ,monona,inkosuu,outkosuu,nowkosuu 取込テーブル 　フィールド名　物ID,物名,現在個数 今までフォームに表示させて一件づつ手入力にて処理しておりましたが、複数人で作業できるように修正している所です。 ○各々がExcelに収集したデータをCSVにて「取込テーブル」にインポート 　　↓ ○「取込テーブル」のレコードを集約しデータ整合（ここまでは出来ています） 　　↓　 ○「取込テーブル」の全レコードを「結果テーブル」にインポート DIM SQL001 AS String SQL001 = "INSERT INTO 結果テーブル (monoＩＤ,monona,nowkosuu) SELECT (取込テーブル.物ID,取込テーブル.物名,取込テーブル.現在個数) FROM 取込テーブル CurrentDb.Execute SQL001 これで動作させるとエラーになります。 ただ、実験で SQL001 = "INSERT INTO 結果テーブル (monoＩＤ) SELECT (取込テーブル.物ID) FROM 取込テーブル の様に一つのフィールドだけにすると全てのレコードをインポートすることが出来ます。 何か凡ミスの様な気もするのですが、取込テーブルをレコードセットとし１件ずつインポートする方法しか無いのでしょうか？
プログラム初心者です テーブルに途中からプライマリーキーを作成することはできますか？ idとゆうカラムを追加で作成して主キーにしようとしたのですがエラーがでます idはint型でテーブルには100行あるのですが全部0になっているのが原因かもしれません このidカラムに1～100まで数字を与える方法はありますか？ よろしくお願いします
商品情報が入ったテーブルが２つあります。 一つは商品のスペックが入ったテーブル　→　tb_spec 一つは商品の種類と価格が入ったテーブル　→　tb_variation tb_spec ---------------- 商品ID, 重量 item001, 100 item002, 150 ---------------- tb_variation ---------------- 色, 商品ID, 価格 赤, item001, 12000 青, item001, 15000 黒, item002, 21000 白, item002, 20000 赤, item002, 23000 ---------------- これを一致する商品IDで内部結合でのSELECTで抽出します。 　SELECT s.`商品ID`, s.`重量`, v.`色`, v.`価格` 　　FROM tb_spec AS s 　　INNER JOIN tb_variation AS v 　　ON s.`商品ID` = v.`商品ID` 結果は、 　Array( 　　[0] => Array ([商品ID] =>item001 [重量] =>100 [色] =>赤 [価格] =>12000) 　　[1] => Array ([商品ID] =>item001 [重量] =>100 [色] =>青 [価格] =>15000) 　　[2] => Array ([商品ID] =>item002 [重量] =>100 [色] =>黒 [価格] =>21000) 　　[3] => Array ([商品ID] =>item002 [重量] =>100 [色] =>白 [価格] =>20000) 　　[4] => Array ([商品ID] =>item002 [重量] =>100 [色] =>赤 [価格] =>23000) 　) というように結果が帰ってきます。 これを、 　Array( 　　[0] => Array ([商品ID] =>item001 [重量] =>100 [色] => Array( 　　　　　　[赤] => Array([価格] =>12000) 　　　　　　[青] => Array([価格] =>15000) 　　) 　　[1] => Array ([商品ID] =>item002 [重量] =>100 [色] => Array( 　　　　　　[黒] => Array([価格] =>21000) 　　　　　　[白] => Array([価格] =>20000) 　　　　　　[赤] => Array([価格] =>23000) 　　) 　) というように商品ID毎の配列で取得できるSQL文は書けるのでしょうか？ 上記と多少配列の構造が変わっても良いのですが、商品ID毎に取得できればと思っています。 どうぞよろしくお願い致します。
OS:Windows server2008 SQL:MySQL server Express(WevPlatformにて自動インストール） WebPlatform2.0を使用しWordpressをインストールする際 「手順2/2アプリケーション情報の入力」 から続行を押した時に Unabele to connect to any of the specified MySQL hosts. System.Exceptionの例外がスローされました データベースに接続できません と出てしまいます。 どこに問題があってこのエラーが出ているのでしょうか 解決方法をご教授ください よろしくお願いいたします、。
1対多で結合する場合に、多が絞り込み条件となった場合のSQLについての質問です。 たとえばカスタムテーブルを使ったSELECT文などで、このような絞り込み条件が必要になると思います。 まずカスタムテーブルの具体例として、たとえばユーザーテーブルがあったとします。 [user_table] id=INT //オートインクリメント user_id=VARCHAR //adminなどのユーザーID文字列 user_pass=VARCHAR //パスワードを保存※ハッシュ化した値 user_name=VARCHAR //山田太郎などのユーザー名 user_mail=VARCHAR //ユーザーのメールアドレス user_description=TEXT //ユーザーの自己紹介文 user_created=DATETIME //ユーザーの登録日 とりあえず、上記のようなデータをユーザーの基本データだとします。 このユーザーテーブルから、たとえば名前を元に検索するのは単純です。 たとえばこのような感じでしょうか。 SELECT * FROM user_table WHERE user_name = '山田太郎' このテーブル構造を変更することなくカスタムデータを追加したい(しかも柔軟に)という要望を実現するために、ユーザーカスタムテーブルを作ったとします。 [user_custom_table] id=INT //オートインクリメント relational_id=INT //user_table.idへの参照 custom_name=VARCHAR //カスタムフィールド名 custom_value=VARCHAR //カスタムフィールドの値 custom_name、custom_valueには、たとえばそれぞれ以下のような値が入るとします。 custom_name、custom_value Birthday 、1998/1/1 CompanyName 、○○株式会社 CompanyTel、000-0000-0000 CompanyAddress、東京都千代田区○○-○○ user_custom_table.relational_idはuser_table.idにリレーションしているとすると、INNER JOINして値を取得する方法は判ります。 ※カスタムテーブルに値がない場合という状況は無視できる仕様です。 たとえば、会社住所が東京都で始まるユーザのみを抽出すると、以下のような感じでしょうか。 SELECT user_table.* FROM user_table INNER JOIN user_custom_table ON user_table.id = user_custom_table.relational_id WHERE user_custom_table.custom_name = 'CompanyAddress' AND user_custom_table.custom_value LIKE '東京都%' ただ、この方法だと、誕生日が○月○日以前で、会社名に○○を含んで、会社住所が東京都で始まり…と検索条件が増えていった場合にINNER JOINがどんどん増えていって、いかにも効率が悪いと思えてなりません。 とりあえず適当に書いてみるとして、以下のような感じでしょうか。 SELECT user_table.* FROM user_table INNER JOIN user_custom_table AS custom_1 ON user_table.id = custom_1.relational_id INNER JOIN user_custom_table AS custom_2 ON user_table.id = custom_2.relational_id INNER JOIN user_custom_table AS custom_3 ON user_table.id = custom_3.relational_id WHERE custom_1.custom_name = 'CompanyAddress' AND custom_1.custom_value LIKE '東京都%' AND custom_2.custom_name = 'Birthday' AND custom_2.custom_value < '2001/1/1' AND custom_3.custom_name = 'CompanyName' AND custom_3.custom_value LIKE '%○○%' もっと効率の良い書き方、一般的にはこういう場面ではこんな書き方をするなど、識者の方から教えを請いたくて質問しました。 ※ちなみにDBはMySQLですが、とくにMySQLに限らない方法で答えを頂ける方がありがたいです。
添付の表よりSQLのcase文を使用して2年連続でsaleが上がったyearを求めようと しています。 前年より上がった場合は以下のSQLで表示できたのですが 2年連続に上がった年を表示させようとするとうまく表示できません。 誰かご教授いただけないでしょうか？ select year,sale from sales s1 where sale > (select sale from sales s2 where s2.year = s1.year -1) order by year
mysqlのデータを今csvファイルに保存しようとしているのですが、 データの中にcsvファイルに保存しなくてもいい情報と保存したい情報があります。 例えばデータが 姓 　　山田 名 　　太郎 年齢　　 20 住所 東京 学校 東京大学 だったとします。 そこで 姓と名と年齢だけの情報を保存したいとします select * from テーブル名 where 名前 and 名 and 年齢 INTO OUTFILE "ファイル名.csv" fields terminated by ',' これで保存されると思ったのですが、 保存されたcsvファイルは空白でした。 学校が東京大学の人がデータに5人中3人だとして　東京大学の人のデータを取り出したい場合にwhere 学校 = "東京大学"みたいに使うのだろうと思いました。 自分は全員分のデータの中のここでいう姓と名と年齢だけの情報を保存したいです。 なので姓と名と年齢だけの情報を保存したい場合にはどうしたらいいですか？
単純な質問ですみません。 idを例えばアルファベット5～10文字程度にしたVARCHAR(10)とする場合と、tinyintにする場合では検索スピードはどちらが速いのでしょうか？ idの種類は多くても10種類くらいです。 レコード数は50万件くらいあります。 アルファベットのidを数値にするとは、例えば apple → 0 orange → 1 banana → 2 というような感じです。 また、idをもしtinyintにした場合、phpMyAdminなどでレコード表を確認した場合、何のidかわかりにくいですが、これは仕方ないのでしょうか？
お世話になります。 マイクロソフトのSQL Server2005 Express、SQL Server2008 R2 についての質問です。 職場の私のＰＣ（Windows7 Pro 64bit版）には各種開発ツール、ＤＢがインストールされています。 VS2005をインストールした時にSQL Server2005 Express（？）もインストールされたようです。 社内のＤＢサーバー機のSQL Server2008 R2 に接続するために製品版のSQL Server2008 R2の クライアントツール（Management Studioなど）もインストール済みです。 私のPCにSQL Server2008 R2 Expressをインストールしたいのですがどうすればよいでしょうか？ （可能なのかどうか？　導入手順は？） すでにSQL Server2005 Express や 製品版のSQL Server2008 R2（クライアントツール）が インストール済みですのでそれらとバッティングしないかと気になっています。 やりたい事は、スタンドアロン環境でＤＢを動かしストアドプロシージャのテストなどの実施です。 ※SQL Server2008 R2 の環境からバックアップを取ったDBを復元する必要があるので 　SQL Server2008 R2 Express以降のバージョンが必要です。 ご教授よろしくお願いいたします。
mysqlで　SELECT文を作成しています。　 諸事情であるテーブルとテーブルを１対１の関係でプライマリーキー同士でつないでいます。 この時、Aというテーブル　と　Bというテーブルでつないでるとして Aテーブルにあるカラムのみを使ってでソートする場合パフォーマンスは問題なく Bテーブルにあるカラムのみでソートする場合もパフォーマンスに問題はありません。 しかし、Aテーブル　Bテーブルのカラムを組み合せてソートすると パフォーマンスが極端に落ちてしまいます。 これを改善する方法はないでしょうか？
暗黙的型変換で、 nvl2('aaa','iii',111) これは1を文字だと認識してくれますが upper(aiueo) これはエラーになる。 このように明らかに文字リテラルが入る箇所に ' 省略して入力しても暗黙的型変換が実行されないのはなぜ?
SQL Server 2008R2/2012でのVIEWのアクセス権限の付与について パケージのシステムを構築しており、ユーザにVIEWの読み取り権限だけを公開したいと考えています。 ユーザは、SQL Server Management StudioでそのVIEWに対してSELECTだけできるようにしたいのですが、やってみるとVIEWに対しての権限の他に元となるテーブルのアクセス権限も必要となり、見せたくないテーブルとそのテーブルの列が見えてしまいます。 なんとか、DBへの特定のログインユーザだけVIEWに対して読み取り（SELECT）ができようなユーザが作れないでしょうか？ アドバイスをお願いします。
以下のコードについてお教えいただければと思います。 フォーム上のテキストボックスに入力された6ケタの年月に基づき、 パススルークエリでデータ抽出を行うつもりです。 この後に、新たにテーブル作成をしようと思っています。 しかし、以下のコードでは (1)　書き込むTestテーブルを準備し、保存しておく必要があるかと思います。 （現在は、別に作ったクエリオブジェクトの形式を流用しています） (2)　繰り返し数が多く、相当な時間を使います。 (3)　Loopの代わりにと、SQLでINTO～を挿入したらエラーになってしまいます。 Testテーブルを都度削除し、一回で全件を追加する方法はないでしょうか。 Private Sub PassThru() Dim qd As QueryDef Dim rsSub As DAO.Recordset, rsMain As DAO.Recordset Dim str月初 As String, str月末 As String Dim i As Long Const strConnect As String = "ODBC;****" Set dbs = CurrentDb Set qd = dbs.CreateQueryDef("") qd.Connect = strConnect qd.ReturnsRecords = True str月初 = Format(DateSerial(Left(Me.txt年月, 4), Right(Me.txt年月, 2), 1), "yyyymmdd")) str月末 = Format(DateSerial(Left(Me.txt年月, 4), Right(Me.txt年月, 2) + 1, 0), "yyyymmdd") qd.SQL = "SELECT * FROM MAINDATA WHERE((DATE>=" & str月初 & ") And (DATE<=" & str月末 & "))" Set rsSub = qd.OpenRecordset() 　　'****テーブルへの書き込み。フィールド数(20)×レコード数(約1500)回まわる DoCmd.RunSQL "delete * from Test" 　　Set rsMain = dbs.OpenRecordset(Name:="Test", Type:=dbOpenTable) Do Until rsSub.EOF For i = 0 To rsSub.Fields.Count - 1 rsMain.AddNew rsMain.Fields(i)=rsSub.Fields(i) 　　 Next Loop End Sub
SQLiteにおいて、とある一意の数値nが全体のうちの何番目に位置するかどうかは以下のようなクエリで取得できます。 select *,(select count(*)+1 from card as c where c.n < card.n) as idx from card where... 今回は「項目Bに×をもち、かつ順位が○位以上である」や「項目Cに△が含まれる、もしくは順位が○位以下」といったように、順位が条件に含まれるクエリを考えているのですが、これを少ない手順で再現する方法があればお教えください。
プログラム初心者です mysqlのカラム、varchar(255)に実験で270文字HTMLフォームからmysqlに入れてみました そうしたら、255文字しか保存されていませんでした もしかしたら、PHPで文字数制限しなくてもmysql側のカラムの文字数設定だけでいいのではないかと思ってしまいましたがこれだと不具合とかでてきますか？ データ型のtextも文字数指定できるのでしょうか？ やっぱり、文字数制限はPHPなどでやったほうがいいのでしょうか？ よろしくお願いします
お世話になっております ・サーバ：Windows2008R2＋SQLServer2012 ・クライアント：Windows7 上記環境にて、クライアントのＳＳＭＳ上で、 あるストアドプロシジャを実行すると丁度２分程かかります。 （これをスピードアップさせるのが目的です） 　exec hoge para1,para2 同じく、SSMSで「新しいクエリ」を作成して、 そのストアドプロシジャの実行部分だけを 貼り付け、パラメタだけを指定して実行すると４秒で終わります。 　declare @para1 smallint 　declare @para2 smallint 　set @para1 = 1 　set @para2 = 2 　（以下ストアド内のＳＱＬを貼り付け） 「SET ARITHABORT ON」を付加しても 全く変化がありませんでした。 なぜこのような事が起こるのか、見当がつかず、困り果てています。 対応方法等ご存じの方がいらっしゃいましたら お知恵を拝借したく、よろしくお願いいたします。
お世話になります。 Btrieve から MS SQL Server 2008へデータの移行を行いたいと考えています。 現在、手元に xxxxxx.btr というファイル名のBtrieveのテーブルデータ（？）があります。 NetWere上（？）で動いている Btrieve 6.15 のデータです。 ※当方は Btrieve、Netwareともに知識がありません。 この .btr ファイルからCSV形式（テキスト形式）でデータを出力したいのですが どのような手順、ツールが必要になるでしょうか？ Btrieveは固定長でデータを管理（？）しているそうなので とりあえずは１レコード＝１行という形で文字化け等なしで テキストデータへ出力できればＯＫです。 手元にはSQL Server2000～2008 や MS Office製品はありますが Btrieveのデータに直接アクセスできるような専用ツール等はなく、 購入する予算もありません。。。 開発言語としてはVB6や VB.net を考えております。 ご教授よろしくお願いいたします。
SQLで重複を除去したいのですが、DISTINCTやGROUP BYも検討したのですが、どうしても良い方法が見つからなかったので質問させて頂きます。 テーブルの構成は以下のようになっています。 roomsテーブル id(INTEGER) public(BOOLEAN) updated_at(DATETIME) created_at(DATETIME) messagesテーブル id(INTEGER) sendfrom_list_id(INTEGER) sendto_list_id(INTEGER) room_id(INTEGER)※roomsテーブルへの外部キー body(STRING) updated_at(DATETIME) created_at(DATETIME) 更に条件は以下のようになっています。 ・アウトプットとして得たいのは rooms.updated_at rooms.id rooms.public messages.room_id messages.sendfrom_list_id messages.sendto_list_id messagess.body の7カラム。 ・rooms.publicがTRUEである ・messages.room_id = rooms.idであること ・updated_atでDESCにソート このような条件を満たすSQL文は以下のように書くことができました。 SELECT R.updated_at, R.id, R.public, M.room_id, M.sendfrom_list_id, M.sendto_list_id, M.body FROM messages AS M, rooms AS R WHERE R.public = "t" AND M.room_id = R.id ORDER BY R.updated_at DESC; しかし、ここに更に「rooms.idが重複しないもののみ抽出」という条件を加えたいのですが、どうしてもうまく行きません。 DISTINCTでは複数の中から一部のカラムだけをDISTINCTすることはできないようですし、GROUP BYも考えましたがどうやれば良いかわかりませんでした。 どなたか良い方法を教えて下さい。
ORACLE　sqlPlusでの話ですが　 例えば、 deptno, dname, loc この三つの属性を持つ、dept表、dept_copy表があったとして INSERT INTO dept_copy SELECT * FROM dept WHERE deptno = 10; このような文は通りますか？ CREATE TABLE文ではこのような * を利用してもエラーにはならないはずなのですが。
文字列変数の連結について質問いたします。 通常以下の場合、結果は望んだとおりになります。 ----------------------------------------------- SET @会社=N'A社' SET @別会社=N'B社' SET @結果=@会社+'、"+@別会社 SELECT @結果 ’A社、B社' ---------------------------------------------- 以下のように記述にして,複数会社名を連結させる目的で FETCHを使用して変数に値を格納しようとしていますが 結果NULLが返されるのはなぜでしょうか。 ---------------------------------------------- DECLARE myCursor CURSOR FOR SELECT 会社名　FROM 会社マスター OPEN myCursor FETCH NEXT FROM myCursor INTO @会社名 WHILE @@FETCH_STATUS=0 BEGIN 　　　　@結果＝@結果＋@会社名 　　　FETCH NEXT FROM myCursor 　　　INTO @会社名 END CLOSE　myCursor DEALLOCATE myCursor SELECT @結果
クエリの中で、他のテーブルと一致するデータを抽出したいのですが、結果が0件の結果しかかえって来ません。 何処が間違っているのかお教え頂けたら幸いです。 何がしたいかと言うと、「dbo_VIEW_CIJ用売上伝票」の下記項目の中の「T_得意先」の中の抽出フラグのTrueデータを抽出し新しい「T_税抜」テーブルを作成したいのですが、結果は０件しかかえって来ません。 ちなみに、得意先CDのIN句を抜くとちゃんとデータは抽出されます。 《テーブル》 【dbo_VIEW_CIJ用売上伝票】（SQL Serverリンクテーブル) ・納品日付 ・伝票NO ・得意先CD ・税抜金額 ・消費税区分 ・商品名 ・摘要 ・数量 ・単位名 ・単価 ・金額 {T_得意先】 得意先CD 抽出フラグ（YES・NO型) 《抽出条件》 納品日　： >=#（開始日変数）# And #(終了日変数)# 消費税区分　：　1 得意先CD　：　IN(SELECT [T_得意先]![得意先CD] FROM [T_得意先] WHERE[T_得意先]![抽出フラグ]='True') 《SQL》 SELECT dbo_VIEW_CIJ用売上伝票.納品日付, "" AS 部門コード, dbo_VIEW_CIJ用売上伝票.伝票NO, dbo_VIEW_CIJ用売上伝票.得意先CD, "" AS F, dbo_VIEW_CIJ用売上伝票.税抜金額, dbo_VIEW_CIJ用売上伝票.消費税区分, "" AS 商品CD, dbo_VIEW_CIJ用売上伝票.商品名, dbo_VIEW_CIJ用売上伝票.摘要, "" AS ケース数, "" AS 入数, dbo_VIEW_CIJ用売上伝票.数量, dbo_VIEW_CIJ用売上伝票.単位名, dbo_VIEW_CIJ用売上伝票.単価, [dbo_VIEW_CIJ用売上伝票]![消費税区分]*[dbo_VIEW_CIJ用売上伝票]![税抜金額] AS tmp小計, [dbo_VIEW_CIJ用売上伝票]![数量]*[dbo_VIEW_CIJ用売上伝票]![単価] AS tmp単価計 INTO Tmp税抜 FROM dbo_VIEW_CIJ用売上伝票 WHERE (((dbo_VIEW_CIJ用売上伝票.納品日付)>=#10/21/2013# And (dbo_VIEW_CIJ用売上伝票.納品日付)<=#11/20/2013#) AND ((dbo_VIEW_CIJ用売上伝票.得意先CD) In (select [T_得意先]![得意先CD] from [T_得意先] Where [T_得意先]![抽出フラグ] = True)) AND ((dbo_VIEW_CIJ用売上伝票.消費税区分)=1)) ORDER BY dbo_VIEW_CIJ用売上伝票.納品日付; ※上記SQL文は、SQLビューを記載してますが、デザインビューで作成し、得意先CDのIN句の部分は、得意先CDにビルドを使って入力しました。 参考にしたURL http://office.microsoft.com/ja-jp/access-help/HA … ・サブクエリをクエリ フィールドの抽出条件として使用する Access2010 Windows７
プログラムど素人です プライマリーキーはつけといたほうがいいでしょうか？ プライマリーキーがないとプライマリーキー以外のカラムをselectするとき遅くなるのでしょうか？ プライマリーキーのカラム名はid以外でもいいですか？ 質問2 phpmyadminからindexを他のカラムにつけた場合はそのカラムにindexつけた後に追加された行も自動的にindexがついていますか？ よろしくお願いします
フィールド1,フィールド2,フィールド3,フィールド4 フィールド1はＩＤ番号です。 フィールド4が条件に一致するレコードだけを、同じテーブル内に追加コピーするＳＱＬはどう記述したらよろしいでしょうか？ 1,長嶋,100,巨人 2,王,80,巨人 3,野村,90,ヤクルト フィールド4の条件　=巨人　として追加したい 1,長嶋,100,巨人 2,王,80,巨人 3,野村,90,ヤクルト 4,長嶋,100,巨人 5,王,80,巨人
Windows7でレジストリよりPostgreSQLのインストール先をバッチで取得しようとしたのですが取得できませんでした。 同じ階層で「文字列値」に空白がない「Version」は取得できるのですが 「Base Directory」になると取得できません。 文字列値に空白がある場合「”～”(ダブルコーテーション）」でくくればいいとあったのですが、駄目でした。 どなたかご存知の方教えてください。 @echo off FOR /F "TOKENS=1,2,*" %%A IN ('REG QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\PostgreSQL\Installations\postgresql-9.0" /v "Version"') DO IF "%%A"=="Version" SET GET_Version=%%C FOR /F "TOKENS=1,2,*" %%A IN ('REG QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\PostgreSQL\Installations\postgresql-9.0" /v "Base Directory"') DO IF "%%A"=="Base Directory" SET GET_DIR=%%C echo PostgreSQL Version cho %GET_Version% echo PostgreSQL Directory echo %GET_DIR% pause exit
こんにちは。よろしくお願い致します。 sqlの書き方がわからず質問いたします。 コード10020のaaaaさんについて 年月(ym）別に点数（score）を集計した値と 点数の総合計を一度にまとめて取得したいです。 データの内容は下記のとおりです。 アドバイス頂けますととても助かります。 よろしくお願い致します。 code,name,score,group,ym --------------------------- 10020,aaaa,10,1,201305 10020,aaaa,15,2,201305 10020,aaaa,20,7,201305 10020,aaaa,12,9,201305 10020,aaaa,10,1,201306 10020,aaaa,15,2,201306 10020,aaaa,20,7,201310 10020,aaaa,12,9,201310 10020,aaaa,10,1,201310 10021,bbbb,10,1,201305 10022,cccc,10,1,201305
Windows XP, MS Access 2007です。 レコード件数700件程度のテーブルTBLに以下のようなカラムがあります。 ID(主キー),NAME,REF_ID1, REF_ID2, REF_ID3,...., REF_ID10 NAMEは当該IDに紐づく名前であり、 REF_ID1～REF_ID10は、当該レコードと関連するレコードのIDを記載したものです。 これをレポート出力する際に、 関連レコードはIDではなく名前を出力したく 以下のようにクエリを作成しました。 SELECT TBL.ID, TBL.NAME, TBL1.NAME AS REF_NAME1, ...., TBL10.NAME AS REF_NAME10 FROM TBL, TBL AS TBL1, TBL AS TBL2, ..., TBL AS TBL10 WHERE TBL.REF_ID1 = TBL1.ID AND ... AND TBL.REF_ID10; しかし、この方法だと結合するテーブル数が多くなるためか、 レポートの表示が非常に遅く、かつ、レポートの最後のページを開こうとすると メモリ不足とのメッセージボックスが出力され、エラー終了してしまいました。 メモリはOSの限界4GBまで積んでいるため、 結合するテーブル数が多すぎるのが問題なのだと思いますが、 どのような方法がよいのでしょうか。
レストラン、不動産、求人などの検索サイトは多数のチェックボックス検索項目があり、 「OR検索」が多発するため、索引がうまく使用されず、件数が増えるとすぐに遅くなると 思います。 設計上の配慮はどのようなことがあるのでしょうか。 index_merge である程度、効果があるのでしょうか。 http://dev.mysql.com/doc/refman/5.1/ja/index-mer …
初めまして。 稼働中のシステム保守において問題が発生しています。 早急に解決したいのでお力をお借りしたいです。 稼働中サーバー（SQL-Server２００８）にてトランザクションログが肥大化しております。この手の問題はネットで検索すると解決方法が出ているので実行してみました。 まずは…ログファイルの圧縮。 ManagementStudioより操作をGUIで行いましたが、処理自体が一瞬で完了してしまいLDFファイルを見ても圧縮前と何も変わっておりません。 続いて…ログファイルのバックアップ バックアップすることでログファイルの切り捨てができるとの事で、同様にManagementStudioよりバックアップを実行してみました。かなり処理に時間が掛かるようでしたが、30分程待ったところ（進捗20％）でエラーが発生し、空き容量が足りないのでバックアップに失敗したようです。 160GB程残っていますが、これでも容量不足とは…。 上記のような事態に陥った場合にどうするのが賢明でしょうか？ ちなみに通常はメンテナンスプランにより、１日１回完全バックアップを取って保存しています。 ログファイル自体はバックアップを取っていませんでした。（必要性が理解できなかったもので…） 稼働中システムに問題が発生した場合は基本的には前日のデータに戻すような対応をする契約ですので、復元時点は厳密にN時間前等を指定する必要性がない為、ログファイル自体はあまり必要ではないという認識で良いのでしょうか？ また今後、定期的にログファイルのバックアップを取るにしても、ログファイルのバックアップ容量が大きい為、Nヶ月分残すような運用をする場合、従来のデータバックアップに加えてログファイルのバックアップが加算され200GB程度のHDDでは追いつかないのですが、ログファイルのバックアップは上書きしていき、データの完全バックアップのみNヶ月分残すというような運用でも問題なく復元できるのでしょうか？ 以上、３点質問してしまいましたが、どなたかご回答していただけると幸いです。 よろしくお願い致します。
プログラム初心者です シンプルな掲示板をつくりました ホームページのトップページに新しく書き込まれたスレッドを表示したいです bbsに書き込まれたらbbsテーブルに行番号を付けてどんどんインサートしていくようにしてます トップページはindex.phpです id （オートインクリメントでつけた行番号） sure_id （タイトルごとのid。これでタイトルごとにまとめています） mes 書き込まれた文章 name 書いた人の名前 time 型はdatetimeです（書き込まれた日付） bbs番号3番のスレ 2番目の書き込み　2013-09-12←これが新着で取得したい値 1番目の書き込み　2013-09-10←なぜかこちらを取得してしまう 下記のようにindex.phpで表示したいです bbs番号3番のスレが2013-09-12 しかしやってみたら新着順にはなるものの3番目のレスの古いほうから値を取得していました SELECT * FROM bbs GROUP BY sure_id ORDER BY MAX(time) DESC LIMIT 1,10 bbs番号3番のスレが2013-09-10 bbs番号5番のスレが2013-09-11 bbs番号6番のスレが2013-09-09 こうなるようにしたいです bbs番号3番のスレが2013-09-12　←最新の書き込まれたスレッドのなかから一番新しい日付を表示したい bbs番号5番のスレが2013-09-11 bbs番号6番のスレが2013-09-09 よろしくお願いします
このジャンルでお願いします。 tbl id　　starttime　endtime　val 1　　　　　0　　　　　　40　　3 2　　　　　160　　　　170　　1 3　　　　　160　　　　190　　2 starttimeとendtimeは「分（160なら60×2＋40で2時40分になります）」で保存してます。 このようなテーブルで、時間毎にvalの平均を出したいのですが、 id　　hour　avg(val) 1　　　　0　　　3　　←　0～1時まで 2　　　　1　　　0　　←　1～2時まで 3　　　　2　　　1.5　　←　2～3時まで 4　　　　3　　　2　　←　3～4時まで ・ ・ 24　　　23　　　0　　←　23～24時まで といった感じで24区間に分けてその区間毎のvalの平均を出したいです。 これはどのようなSQL文になるのでしょうか？ またこのようなSQL文で１度に取得するやり方と、 いったん全行取得してPHPなどでループして平均を計算するやり方とでは レコード数が増えてきた場合にどちらが速いとかはあるのでしょうか？
sqlserver（2008R2）についてクエリ文が上手く書けません。 お手数をおかけいたしますが、お分かりになる方はご教授いただければと 思います。 まず、元となるテーブルおよび作成したい完成系は添付ファイルをご確認下さい。 personal_id、personal_name、personal_address、personal_tel、personal_date列を 持つテーブル(personal_table)から 「select * into #table01 personal_table」に よって一時テーブル#table01を作成し、personal_name・address・telがnullの場合に、 personal_dateが直前時におけるnull以外の値をセットしたいと思っています。 （ただし、セットするのはpersonal_id毎で、最もpersonal_dateが若い者には 必ずpersonal_name・address・telが入っているものとします）。 なお、以下は私が作成したクエリになります。　項目1つずつっと思い、 とりあえずpersonal_nameをpersona_idおよびpersonal_dateを用いて updateしようと思ったのですが、personal_nameがすべてnullになってしまいました。 --------------------------- select * into #table01 from personal_table update #table01 set personal_name = (select personal_name from #table01 A where #table01.personal_id = A.personal_id AND #table01.personal_date = (select MAX(A.personal_date) from #table01 A where #table01.personal_date > A.personal_date AND #table01.personal_id = A.personal_id)) SELECT * from #table01 --------------------------- 完成系を作成するにあたってどのようなクエリを書けばよろしいのか、 ご教授いただければと思います。
以下の.net関数を使用して、Select文を作成し SqlServerからデータを抽出しています。 http://msdn.microsoft.com/ja-jp/library/zxkb3c3d(v=vs.110).aspx http://msdn.microsoft.com/ja-jp/library/system.d …(v=vs.110).aspx 条件を変え二つのSelect文を作成したところ、 後者だけが極端に遅延しタイムアウトしてしまいます。 (1)Select ID From TestView Where ID = 0　※ID列はint型 (2)Select ID From TestView Where ID = 1　※ID列はint型 Select対象となるデータ数（TestView）はかなりの量がありますが、 ID = 0、ID = 1 によって抽出されるデータ自体はどちらも10件程度です。 なぜID = 0ではすぐに抽出でき、ID = 1では遅延するのか全く原因がわかりません。 私自身も色々と確認をしているのですが、 過去の経験則や、ここを確認すると良いなど 調べるための情報がありましたらご提供頂けませんでしょうか？ 宜しくお願い致します。
超初心者で申し訳ありません。下のプログラムにおいてオペレータ名が一致する場合には 更新（ＵＰＤＡＴＥ）する。一致するデータが無い場合には新規登録を行いたいのですが どのように書いたらいいのかさっぱりでＮＥＴを相当探したのですが回答が見つかりません。 お手数ですがどなたか助けていただけませんでしょうか。なお、一致する場合には 更新（UPDATE）は動作するようになりました。 ＶＢを始めて２ケ月になります。Microsoftの文献を見ても難しくてまだ理解できるレベルに達していません。どなたか、よろしくお願い致します。 「データ構造」 ID　　　　　　　　　　integer オペレータ名　　　string ランク　　　　　　　integer パスワード　　　　string 補足　　　　　　　string Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click '■■■■■■■■■■■■■■■■■■■■■■■■ '■■■　　　オペレータの新規/更新登録 　　■■■　 '■■■■■■■■■■■■■■■■■■■■■■■■ '----------------------------------------------------------- 'コネクションを作成 Dim CurrentDir As String = System.IO.Directory.GetCurrentDirectory() Dim cn As New OleDbConnection( _ "Provider=Microsoft.Jet.OLEDB.4.0;" & "Data Source=" & CurrentDir & "\operator.mdb" '**************** コマンドを作成 **************** Dim OPE As String Dim PWORD As String Dim HOSOKU As String Dim RANK As Integer OPE = オペレータ名.Text RANK = ランク.Text HOSOKU = 補足.Text PWORD = パスワード.Text Dim cmd As New OleDbCommand( "UPDATE table1 " & "SET ランク = ? " & "," & "パスワード = ? " & "," & "補足 = ? " & " WHERE オペレータ名 = ? ", cn) '************** パラメータを作成 **************** cmd.Parameters.Add("ランク", OleDbType.Integer).Value = RANK cmd.Parameters.Add("パスワード", OleDbType.Char).Value = PWORD cmd.Parameters.Add("補足", OleDbType.Char).Value = HOSOKU cmd.Parameters.Add("オペレータ名", OleDbType.Char).Value = OPE '実行 cn.Open() cmd.ExecuteNonQuery() '-------------------------- Dim COUNTC As Integer COUNTC = cmd.ExecuteNonQuery() 　　'************************************　elseの中に簡単に記載すのって難？？？*** If COUNTC > 0 Then MessageBox.Show("更新　完了")　　　　 Else 'INSERTの手順 　　　　　　’★　ここにmdbの中に 項目値 OPE、RANK、HOSOKU、PWORDを挿入（追加） 　　　　　　 する命令を入れたい。 　 '実行 cmd.ExecuteNonQuery() End If ’********************************** '-------------------------- cn.Close() End Sub
プログラム初心者です phpとmysqliで簡単な掲示板を作りました。これをスレッド掲示板に変更したいと思っています 質問1 MyISAMの違うテーブルに同時アクセスできるのでしょうか？ bbs1とゆうテーブルに同時アクセスはできないのはわかりますがテーブルを二つに分けた場合どうなりますか？ 例えばbbs1とbbs2とゆうテーブルを作った場合、bbs1とbbs2に同時に書き込まれた場合でもテーブルが違うと書き込めるのでしょうか? 質問2 2chのようにスレッド掲示板にしたいのですが、テーブルは2つで作れると考えました（スレッドとレス）スレッド番号でレスをまとめるやり方です このような1つのテーブルでレスをまとめた場合、複数のカラムにindexをつけると将来100万行とかになっても軽快に動きますか? それとも、スレッドごとにテーブルを作ったほうがいいのでしょうか？ よろしくお願いします
Mysqlでわからないところがあります。 テーブル名はtestで下のようになるとします test clm1 | clm2 ----------- 3 | 1 2 | 1 4 | 1 3 | 2 4 | 2 1 | 2 2 | 2 6 | 2 このときにclm1に2.4.6を含むclm2を出力させたいです。 この場合2.4.6すべてを含んでいるclm2の2が期待する答え（1は2.4しか含んでいないため）です。 どなたかご教授願います。
仮登録から本登録の流れというのは、どの設計になるのでしょうか？仕組みは色々な方法があると思うのですがいまいちイメージがつかめないです。 以下は、私が設計したいと思っている流れです。 (1)お問い合わせフォームまたは電話にてお申込み連絡を承ります。サービスの利用が可能かを確認致します。 ここで基本的な会社の情報をいただきます。メールにて送信。 ↓ (2)メール確認後、ご訪問、電話にてご説明。 弊社担当よりサービスのご案内・利用方法についてご説明させて頂きます。 ↓ (3)クライアントがサービス利用と判断された場合は利用に必要な項目を確認、取得します。 最終的にはどのようなデータベース設計になるのでしょうか。 よろしくお願いします。
単純な質問ですみません。 現在、商品の名前や価格・在庫数を商品テーブルに記録しています。 この商品の価格や在庫数の1年分（365日分）の履歴をデータベースに記録したいのですが、通常はどのような設計になるのでしょうか？ 価格テーブルや在庫テーブルを作って356日分のカラムを作るのが普通ですか？ あと、商品データベースには商品テーブルが一つだけあります。 もし上記のように価格テーブル、在庫テーブルを作るとしたら商品データベースの中に作るのでしょうか？ それとも価格データベースの中に価格テーブル、在庫データベースの中に在庫テーブルを作るのでしょうか？ 長所・短所などがありましたら教えてください。 どうぞよろしくお願い致します。
VB.NET 2010でOracle11gに接続するプログラムを作っていますが、 接続方法がいまいちわからずに困っています。 プログラムを動かすサーバーはWindows Server 2008 R2の64bitだったので、 Oracle Clientも合わせた方がいいのかなと思い、64bit版をインストールしました。 ASP.NETのWEBアプリでは以下の接続文字列を用いてADO接続できました。 パラメータ値は例です。 （Web.configに記述） <connectionStrings> <add name="oracle" connectionString="Provider=OraOLEDB.Oracle;Data Source=db1;Password=pass1;User ID=user1" providerName="System.Data.OleDb" /> </connectionStrings> 次に、コンソールプログラムを作成し、同じサーバーで上記と同様の接続文字列で 接続しようとしましたが、エラーとなり接続できませんでした。 いろいろ記述を変えても接続できませんでしたが、最終的にOracle Clientの 32bit版を64bit版と違うフォルダにインストールし、以下の接続文字列で接続 できました。（INIファイルに記載） ConnectionString=Provider=OraOLEDB.Oracle;Data Source=db1;Password=pass1;User ID=user1 この状態でWEBアプリの方は何を使っているのかと思い、64bit版のインストールフォルダを リネームしたところ、WEBアプリの方は接続できなくなりました。 現状では32bitと64bitのOracle Clientが両方必要な状況ですが、本来ならどちらかだけで すむと思います。 32bitと64bitで接続文字列が変わるという情報は得られませんでした。 何がまずいのでしょうか？ 最初から32bit版をインストールすれば良かったのでしょうか。
データベースのテーブルのカラムのサイズを定義しようとしています。調べた限りでは、Oracle AL32UTF8においては、以下の容量を消費するとなっていました。 (1) ASCII -> 1 byte (2) 記号文字 -> 2 byte (3) 半角カナ、全角カナ、ひらがな、漢字 -> 3 byte これは、「1」や「a」などの英数字は1バイト、「%」や「#」などの記号は2バイト、「あ」「ア」「亜」などの全ての日本語は3バイトで保存されるということだと思いますが正しいでしょうか？ そうであれば、例えば氏名項目に２０文字を保証したい場合は、一番バイト消費の多い3バイトで見積もり、20 * 3 = 60バイトで定義すればよいでしょうか？ 第3水準文字、第4水準文字は4バイトで保存されるという記事もあったのですが、これらはとても稀なケースなので考慮せずに3バイトで考えておくのが一般的でしょうか？ あとは、バイトで考えずにNLS_LENGTH_SEMANTICSという初期化パラメータをCharにすることで文字数ベースにすることができるとも聞いたのですがこのアプローチは推奨されますか？全てのテーブルに影響があると思うので、大きな決断になると思うのですが普及したやり方なのでしょうか？ 以上、見解を教えて頂けると助かります。以上、宜しくお願いします。
こんにちは。現在データベースとphpを使ったサイトを作っています。サイト自体は出来上がりまして データベースに情報を登録しているのですが、少し疑問が出てきました。 私の作っているのは例えば情報をデータベースからPHPで出力させ、任意の順番に並べ替えるという サイトなのですが、 （例えば花でしたら「正式名称」や「育て方」などデータベースから出力させ表示させるといった風なものです） しかしこの場合、データベースに情報が全ての情報が入っているため検索にまったくひっかからず、 どうしてよいものか悩んでいます。 他の似たようなサイトを見ていたのですが、そちらもphpでデータベースから出力させているのですが 花の名前+育て方　などで検索すると検索に反映されているようです。 この部分がよくわかりません。データベースから全ての情報を出力させているのは間違いないと思うのですが ・・・。 そのサイトの全てのページのアドレスを見るとphp?というのが含まれています。私のサイトにはそういったものは含まれていませんし、これで何か推測できることってありますでしょうか？
Access2007のTransferTextでのエクスポート定義についての質問です。 エクスポートウィザードの「設定」からエクスポート定義を作成する方法は分かるのですが これだと保存先のパスをVBA内で任意に指定することが出来ません。 エクスポート定義のみを作成する方法をお教えいただけませんでしょうか。 以前、行ったことが有るのですが処理方法を忘れてしまいました。 行いたいことは、VBA内で出力先パス・出力先ファイル名を任意に指定し ダブルクォーテイション無しのCSVファイルを作成したいのです。 よろしくお願いいたします。
MySQLで改行を含む文を登録したいんですが、改行を改行コードに書き換えて登録したいです。 改行コードはどのように書けばいいですか？ 登録したい文： あいうえお かきくけこ さしすせそ
MySQLで改行を含んだ文を登録したいんですが、ネットを見ると改行を文字コードに変換して1行にしているようですが、これはどういう意味があるんですか？ そのまま改行した文を登録出来るようですが、文字コードにしたものとの違いがよくわかりません。 取り扱い方などの違いを詳しく説明してください。
大変申し訳ありません。本日も質問させてもらったのですが、一部情報（履歴）が不足していて追加で質問させてください。 以下のようなテーブルがあり、価格が異なるところを差額一覧を出したいと思っております。 （先ほどは2名の方に回答頂き、すみませんベスト１０の設定がわからず設定できなくて、すみませんでした。） 【テーブル構成】 商品ID、商店ID、価格（円）、履歴 というテーブルがあり、 商品A、商店１、1000、1 商品A、商店２、1500、1 商品A、商店３、800、1 商品A、商店１、2000、2 商品A、商店２、2500、5 商品A、商店３、1800、3 商品B、商店１、2000、1 商品B、商店２、1700、1 商品B、商店３、2600、1 商品B、商店１、2500、4 商品B、商店２、2000、6 商品B、商店３、2800、7 ・・・（多くの商品データがあります） というデータが格納されております。 商品と商店の区分ごとに履歴の最も大きいものを取り出し　（←追加） 商店１を基準に、商品毎に商店２、３の価格差を大きい順にソートして出したいと考えています。 SQL分ではどのように記載すれば良いでしょうか？ （実際に比較したデータは以下を抽出し）【履歴の古いのは無視】 商品A、商店１、2000、2 商品A、商店２、2500、5 商品A、商店３、1800、3 商品B、商店１、2500、4 商品B、商店２、2000、6 商品B、商店３、2800、7 ・・・（多くの商品データがあります） （今回の場合の希望出力が以下のような感じです。） 価格差、商品名、商店　（←綱目です。） 800、商品B、商店３ 500、商品A、商店２ -200、商品A、商店３ -500、商品B、商店２ ご教授頂けると幸いです。 ちなみに、教えて頂いたSQLをもとに以下のようにやってみましたが、うまくいきませんでした。。。 全くよくわかっていません。少し解説を入れて頂けると幸いです。 ------------------------------------ SELECT a.価格 - b.価格 AS 価格差, a.商品ID AS 商品名, a.商店ID AS 商店 FROM 対象テーブル a INNER JOIN 対象テーブル b ON (a.商品ID = b.商品ID AND b.商店ID = '商店１') WHERE a.商店ID <> '商店１' AND a.履歴 = (SELECT MAX(a.履歴)) AND b.履歴 = (SELECT MAX(b.履歴)) 【←追加】 ORDER BY a.価格 - b.価格 DESC; ---------------------------------------- select t2.価格-t1.価格 as 価格差 ,t1.商品名 ,t1.商店 from テーブル1 as t1 left join ( select 価格,商品 from テーブル1 where 商店=商店1 ) as t2 on t1.商品 = t2.商品 where t1.商店<>商店1 AND a.履歴 = (SELECT MAX(a.履歴)) AND b.履歴 = (SELECT MAX(b.履歴)) 【←追加】 ORDER BY t2.価格 - t1.価格 DESC;
大変申し訳ありません。ほかにも似たようなのがあるのですが、応用が利かずわかりませんので、ご教授頂けると幸いです。 以下のようなテーブルがあり、価格が異なるところを差額一覧を出したいと思っております。 【テーブル構成】 商品ID、商店ID、価格（円） というテーブルがあり、 商品A、商店１、1000 商品A、商店２、1500 商品A、商店３、800 商品B、商店１、2000 商品B、商店２、1700 商品B、商店３、2600 ・・・（多くの商品データがあります） というデータが格納されております。 商店１を基準に、商品毎に商店２、３の価格差を大きい順にソートして出したいと考えています。 SQL分ではどのように記載すれば良いでしょうか？ （今回の場合の希望出力が以下のような感じです。） 価格差、商品名、商店　（←これは当然、出力されない） 600、商品B、商店３ 500、商品A、商店２ -200、商品A、商店３ -300、商品B、商店２ ご教授頂けると幸いです。
このジャンルでお願いします。 t1テーブル id　name 1　　aaa 2　　bbb 3　　aaa t2テーブル id　t1_id　num 1　　1　　　10 2　　2　　　100 3　　1　　　1000 4　　3　　　1 このようなテーブル構成で、 t1のnameが「aaa」 かつ t2のidが最新の行だけnumを合計した数値を得たいのですが、 この例だと、 まずt2テーブルの id　t1_id　num 1　　1　　　10 3　　1　　　1000 4　　3　　　1 が該当して、t2のidが最新の行だけなので id　t1_id　num 3　　1　　　1000 4　　3　　　1 に絞られて、1000＋1で「1001」という結果が得たいのです。 どのようなSQL文にすれば良いのでしょうか？
Accessのレコード追加時に、特定のフィールドに値を追加する方法が分からずに、困っております。 ご存じの方がいらっしゃいましたら、ご教授頂けましたら幸いです。 参考にしたサイト http://www.happy2-island.com/access/gogo03/capte … バージョン Access2010 OS Windows7 Professional フォーム名：tmp税抜コンボ（テーブル名:tmp伝票No） サブフォーム：tmp税抜サブ（テーブル名:tmp税抜） 添付画像、tmp税抜コンビフォーム ◎目的 販売管理DB(SQLServer2008)からのリンクテーブルに、特定の得意先を抜出したデータに一部消費税が入っていないため消費税を入力し別のシステムへデータを渡す事が目的です。 ◎処理 可変値：納品日、伝票No、得意先CD、摘要、前のレコードからコピー 固定値：税区、商品名、数量は定数 消費税；手入力（InputBox） 上記のデータを新規で追加したいと考えており、下記のサイトを参考にしましたが、「オブジェクト変数または With ブロック変数が設定されていません」とのエラーが発生し追加出来ません。 【VBA】 Private Sub CmdB_copy_Click() 'レコードをコピーして、不要データ削除 '最後のレコードへ移動 DoCmd.GoToRecord , , acLast 'インプットボックスへ消費税額入力 Dim Tax As Long Tax = InputBox("消費税額を入力してください。") '現在のレコードから、伝票No、日付、得意先CDを取得 '変数定義 Dim rcDate As Date Dim rcDN_No As Long Dim rcTK_CD As Long '代入 rcDate = Me.納品日付 rcDN_No = Me.伝票NO rcTK_CD = Me.得意先CD Debug.Print rcDate Debug.Print rcDN_No Debug.Print rcTK_CD Debug.Print Tax 'レコードセットの定義 Dim oRS As DAO.Recordset With oRS .AddNew　←デバッグ画面では、ここでエラー表示 .Fields("納品日付").Value = rcDate .Fields("伝票No").Value = rcDN_No .Fields("得意先CD").Value = rcTK_CD .Fields("商品名").Value = "消費税" .Fields("数量").Value = 1 .Fields("単価") = Tax .Fields("税抜金額").Value = Tax oRS.Update End With Me.Requery MsgBox ("追加しました。") End Sub インティミディエイトウィンドを確認すると、納品日付、伝票No、得意先CD、消費税の値はちゃんと取得出来ているようですが、レコードセットの考え方、Withセクションの使い方、レコードの追加処理を全く理解できていないため、ご教授頂けたら幸いです。 もし、不足データがありましたら、お教え頂けたら出来る限りご提示いたします。 　
現在t検定で分析しているものです！ p=0.0000000000 t(52)=17.667, p<0.01 分析したら以下のようなものが出てきました。 pとか何を表しているのですか？またこの式は 成り立っていますか？有意かどうかわかりますか？
以下のようなテーブル table1 があります。 ******************* table1 ******************* Name, Kyouka, Score, ID ******************* 山田, 国語, 92, 10001 鈴木, 国語, 71, 10002 田中, 国語, 89, 10003 山田, 数学, 65, 10004 鈴木, 数学, 69, 10005 杉田, 英語, 96, 10006 山田, 英語, 63, 10007 田中, 英語, 76, 10008 ... ******************* カラムIDはPRIMARYを指定しています。 カラムScoreはインデックスを作成しています。 このテーブルで、「IDと教科」を指定したときに、以下の2つのデータを得たいと思っています。 (1) IDに対応する名前と、その教科中の順位 (2) その教科のレコード数 具体例としては、例えば「ID=10001、教科=国語」を指定したときに、「山田、3人中1位」というような情報が得たいです。 （「ID=10001、教科=英語」のようなおかしな組み合わせは指定しないようになっています。） (1) は、以下のようにして名前と順位を得る事が出来ました。 SELECT Name, (SELECT COUNT(*) + 1 FROM table1 b WHERE b.Score > a.Score and Kyouka='国語') AS rank FROM table1 a WHERE ID='10001' ORDER BY Score DESC; (2)は、以下のようにして特定の教科のレコード数を得る事が出来ました。 SELECT COUNT(*) FROM table1 WHERE Kyouka='国語'; しかし、実際にはレコード数が大量にあり、頻繁にこの検索を実行する予定なので、負荷が心配です。 出来るだけサーバーの負荷を減らすために、1回のSELECT文の実行で(1)と(2)をどちらも実現できるような方法はないでしょうか。 また、このテーブルでインデックスを作成しているのはIDとScoreのみですが、より負荷を減らすにはKyoukaにもインデックスを作成した方が良いでしょうか。 何卒、よろしくお願いいたします。
AccessでPablic変数を日付範囲指定、クエリの抽出条件に指定したのですが、「抽出条件でデータ型が一致しません。」とのエラーメッセージで抽出出来ません。 【処理フロー】 １．フォームで、開始日と終了日をPublic変数へ格納 ２．データ抽出クエリの日付条件に"GetData()"Public Functin VBAで変数を格納した値をクエリの抽出条件に返す。 《変数》 '開始日の宣言 Public sDate As Date '終了日の宣言 Public eDate As Date 《GetData()》 Public Function GetDate() MsgBox "開始日は、" & sDate & vbCrLf & "終了日は、" & eDate GetDate = ">=#" & sDate & "# And <=#" & eDate & "#" MsgBox ("Where文は、" & GetDate) End Function デバッグの為、"GetDate()"の戻り値を、メッセージボックスで表示してますが、戻り値は正常とおもわれますが、「抽出条件でデータ型が一致しません。」でクエリが実行できません。 ここを参考に、上記仕様にしました。 http://www.tsware.jp/tips/tips_369.htm どうすれば、日付範囲をPablic変数から指定出来るか、お教え頂けましたら幸いです。 ちなみに、Pablic変数にしているのは、他のクエリでもこの日付範囲を使いたい為です。 もし、ほかに良い処理方法が有れば、ご教授ください。
Canvasを使ってweb上にグラフを表示するサイトを作成したいです。 作りたいグラフのデータは項目が20あり、個数は1700以上あります。 外部であらかじめ作成したデータファイルを読み込む形式で作成したいと考えております。 CSV形式がよいのか、他の方法がよいのかご教授お願いいたします。
ACCESS初心者です。 VBAはEXCELで独学した程度の知識です。 フォームから受注納期を入力し、クエリを抽出。 クエリでレコード毎に製品票の印刷枚数を計算し レポートで各レコード毎に求められた印刷枚数分を 印刷させたいのですが・・・ クエリを開く段階でつまずいており困っています。 Private Sub コマンド23_Click() Dim db As DAO.database Dim rs As DAO.Recordset Dim qdf As DAO.QueryDef Set db = CurrentDb() Set qdf = db.QueryDefs("受注クエリ") With qdf .Parameters("納期") = Format(Forms![受注データ一覧]![納期], "yyyy/mm/dd") Set rs = .OpenRecordset .Close End With MsgBox rs![注文番号] rs.Close End Sub パラメータクエリの開き方、上記コードで問題ないでしょうか？ そしてこのコードを実行した際 実行時エラー3421 データ型の変換エラーが発生しましたと表示されます。 ローカルウィンドウで 変数rs = nothingとなっており クエリのレコードが読み込めていないようです。 (Msgbox rs!注文番号はデータが読み込めたかテストするために コードを書いています。) どうぞ宜しくお願いいたします。
macでsqlite3でcsvのインポートができません。 in.txt -------- 1,りんご,赤色 2,みかん,黄色 ターミナル上で sqlite> .separator , sqlite> .import in.txt tbl1 といった具合にやると、改行が認識されないのか、 expected 2 columns of data but found 4 といったエラーがでます。 対処法を教えてください(><)
SQL Sever 2005 を利用しております。５つのテーブルから値を取得するSQL文を作成したいと考えております。３つまでのテーブルのFULL OUTER JOIN は例がるのですがそれ以上となると調べても判りませんでした。ご教授お願い致します。 TABLE1～TABLE2は同じ構成で発生した５つのテーブルを１つのテーブルに合体して データどれか１つのテーブルで発生すれば表示したい。 出来れば現在作成中のSQL文がFULL OUTER JOINで作成しているのでこれを流用したいので FULL OUTER JOIN の方法で教えて頂ければ幸いです。 以上よろしくお願い致します。 (※IDが主キー) テーブル名：TABLE1 ID-----金額 ----------- 01-----1000 11-----2000 テーブル名：TABLE2 ID-----金額 ----------- 02-----2000 12-----3000 テーブル名：TABLE3 ID-----金額 ----------- 03-----3000 テーブル名：TABLE4 ID-----金額 ----------- 02-----1000 04-----4000 テーブル名：TABLE5 ID-----金額 ----------- 01-----1000 05-----5000 作成したいSQL文の結果 ID-----TABLE1金額---TABLE2金額---TABLE3金額---TABLE4金額---TABLE5金額 01-----------1000----------------------------------------------------1000 02-------------------------2000------------------------1000 03----------------------------------------3000 04-----------------------------------------------------4000 05-------------------------------------------------------------------5000 11-----------2000 12-------------------------3000
現在古いAccessで住所録の管理をやっていて、ハガキの印刷など帳票の出力にも使ってます。 近々PCを買い換えます、Accessは買い換えずにMySQLに移行しようと考えています。 データとしては問題ないのですが、入出力で困ってます。 特に帳票の出力は何で作ればいいものでしょうか。 というか、皆様何で作っているんでしょうか。 今までAccessだったので、そんなことを考えたこともありませんでした。 アドバイスをお願いいたします。
テーブル名：tb event | artist 23 | hamasaki 23 | hamasaki 23 | smap 24 | speed 24 | smap 上のデータは イベント23で浜崎が２曲歌ってSMAPが１曲歌い、 イベント24でスピードが１曲、SMAPが１曲歌ったようなことを考えます。 このようなデータが与えられたときに 浜崎が出演している回数をランキング形式で表示するのに SELECT artist, COUNT( artist ) FROM tb GROUP BY artist ORDER BY COUNT( artist ) DESC とすると同じイベント23で２曲歌っているので 浜崎は2回カウントされます。 これをイベントごとに１回分までしかカウントしない （参加したイベント数）のような意味でカウントするには どうしたらよいでしょうか？
macでsqlite3でcsvのインポートができません。 in.txt -------- 1,りんご,赤色 2,みかん,黄色 ターミナル上で sqlite> .separator , sqlite> .import in.txt tbl1 といった具合にやると、改行が認識されないのか、 expected 2 columns of data but found 4 といったエラーがでます。 対処法を教えてください(><)
MySQLでint(11)を良く見かけるのですが、int型最大値は「2147483647」なのに何故int(11)が成立するのでしょうか？ int(10)までだと思うのですが… 括弧内の数字に上限はないのでしょうか？ 単なる表示幅だから、例えば00002147483647でも良い？ それともマイナスを考慮してint(11)？
お世話になります。 MYSQLにて以下のようなtableがあるとします。 id ex_id name count flag time memo 1 1 山田 100 on 10:11 テスト 2 1 山田 80 on 10:12 テスト2 3 2 田中 50 on 10:13 テスト3 4 3 鈴木 30 on 10:14 テスト4 5 3 鈴木 110 on 10:14 テスト5 6 3 鈴木 10 on 10:14 テスト6 このうち、countの数字が高いものから表示したいのですが、 ex_idが重複する場合はその数字が最も高いもののみ表示したく考えています。 目的とした表示結果順は以下です。 id ex_id name count flag time memo 5 3 鈴木 110 on 10:14 テスト5 1 1 山田 100 on 10:11 テスト 3 2 田中 50 on 10:13 テスト3 distinctやgroup byなど色々考えてみたのですが、思ったような挙動になりませんでした。 以上、よろしくお願い致します。
WAMP初級者です。 とある情報を検索するサイトを運営していますが、その検索対象となる元データはCSVで作成し、MySQLへインポートして情報を更新しています。 環境は文字コードutf-8としているので、エクセルで編集したCSVそのままではだめなので、いったんKanjiTranslator（http://www.kashim.com/kanjitranslator/　）を使ってutf-8に変換し、それをインポートするやり方をとっています。 皆さんも、こんな感じでひと手間かけているのかと、ふと疑問に思いましたので、質問させていただきます。 １）CSVでutf-8で保存する方法がある？（調べていますが、なさそうでした。。） ２）KanjiTranslatorなどは使わずに、もとのSJISのCSVから直接utf-8でインポートする方法がある？ ３）エクセルではなくもっと良いのがある？ ちなみに環境はMySQL Server 5.6 Apache/2.2.4 (Win32) PHP/5.4.22です どなたかご存知の方ご教授いただけますと幸いです。
'SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry '2147483647' for key 'hoge' ・「Duplicate entry」と表示されたので重複エラーかと思ったのですが、コードを見ても良く分かりませんでした ・そこで再度検索したら、「'2147483647'」まで含む同じエラーが幾つかヒットしました https://www.google.co.jp/search?q=Fatal+error%3A … ■質問 ・エラーの意味を教えてください ・「'2147483647'」には何か特別な意味があるのでしょうか？ ※エラー見た時は、'hoge'カラムに「'2147483647'」があって、それが重複されていると思っていたのですが… ■環境 ・MySQL
ファイルを開くと下記のメッセージが出てきます。 現在、他のユーザーがこのコンピュータ上でFileMaker Proを使用してファイルを共有しているため、ファイルを共有することができません。 Webでの公開設定してましたが、解除できません。 どなたか分かりますでしょうか？
いつも楽しく勉強させていただいております。 Access2013を使っています。 やりたいことはこのAccessにPSV形式（","の代わりに"|"で区切られている）のファイルをインポートしたいのですが、うまくいきません。 [外部データ]-[テキストファイル]-[参照]で開くダイアログボックスで拡張子.psvのファイル名を指定すると下記のエラーとなります。 "次の拡張子がないテキストファイルはインポートできません。txt,csv,tab,asc,tmp,htm,html,log" つまり拡張子がいけないようです。 ファイルの拡張子を.csvに変更してインポートするとうまく取り込めるときと"インデックスが有効範囲にありません"のエラーになるときがあります。 うまくいったときにインポートの定義を保存しようとしましたが、できませんでした。 当面の逃げ道としては、"|"を","に変更し、拡張子を.csvにして保存したファイルを取り込んでいます。 それでもいいのですが、何かスマートな解決法はないものでしょうか。
エクセルで膨大な数値データを処理しています。 今のところ、特に問題はないのですが、リソース不足が不安なので、できれば、「元に戻す」の回数を５回程度に設定して、起こりうるかもしれないリソース不足に備えたいと思っています。 ついては、「元に戻す」の回数を自分で設定できないでしょうか？ 今は、或る程度、作業をしたら、一旦、ファイルを保存して閉じ、改めて、ファイルを開いています。 こうすれば、多分、「元に戻す」の回数が「ゼロ」になって、「リソース不足も起こらないだろう」との推測からです。 で質問は、二つです。 ◇1　膨大なデータ処理を延々と続けると、リソース不足が起きますか？ ◇2　「元に戻す」の回数は、任意に設定できますか？ 1について補足して言えば、僕の勝手な推測では、「膨大なデータ処理をすると、多くの容量を使う」「ゆえに、パソコンは、『元に戻す』時に備えて、それだけのデータを記憶しておかなければならない」「延々とそのような作業を続けていると、そのうち、リソース不足になるのではないか？」ということです。 この推測は、正しいですか。間違っていますか？ 「幾ら、膨大な数値処理作業を続けていても、『元に戻す』回数がパソコンの仕様で決められているので、リソース不足は起きない」ということでしょうか？ エクセルは、「2010」です。
SQLServer 2005にて文字列型に入っている日付データの変換を行いたいと思っています。 現状yyyy/M/d（2010/1/1）のようになっているのをyyyy/MM/dd(2010/01/01)に変換したい のですが方法が分かりません。 SELECT CONVERT(DATETIME,(CONVERT(VARCHAR(10),テーブルの値)),120) FROM テーブル名 とするとCHAR データ型から DATETIME データ型への変換の結果が日付/時刻の値の範囲外です。 というエラーになっていまいます。どういった方法なら実現できるのでしょうか。 すみませんがご教授ください。 宜しくお願い致します。
SQLServer2008R2を使用しています。 次のようなテーブルAがあります。 ID　Code1　Code2　Code3　Val1　Val2　Val3 -------------------------------------- １　　A1　　　　　　　　　　　　　１ ２　　A1　　　Z1　　　　　　　　 ２　　　１ ３　　B1　　　A1　　　　　　　　 １　　　１ この時、Code1～３にあるA1に該当するVal1～3の合計をそれぞれ取得したいのですが、SQL文の書き方がわかりません。 SELECT Sum(Val1), Sum(val2), Sum(Val3) FROM A WHERE Code1='A1' OR Code2='A1' OR Code3='A1' のようなSELECT文では、B1・Z1の数も合計してしまいます。 B1・Z1の数が含まれないようなSQL文は、どのように記述したらよいでしょうか？ どなたか有識者の方いらっしゃいましたら、宜しくお願い致します！
Access2000にて現在、各部署別の勤怠データベースを作成しています。 その中で特定部署名をコンボックスで選択してその部署の勤怠データだけ抽出し、エクセルファイルへ出力する様にしたいのです。この場合、コンボックスで指定した　部署名をファイル名にして出力する場合はどの様にすれば良いでしょうか？　例えば、コンボックスで　部署名　”東京営業部”　と 選択したら抽出後、出力するファイル名は　”東京営業部.xls”　として、並びにシート名は ”東京営業部”として　出力したいのです。　お手数ですが何卒よろしくお願い致します。
MySQLは「5.1」をCentOS5.8上で使っています。 - date,station 2013-11-01,urawa 2013-11-01,omiya 2013-11-01,omiya 2013-11-02,omiya 2013-11-02,akabane 2013-11-02,ikebukuro 2013-11-02,omiya - 日付ごとのdistinctなstationの個数について、 1ヶ月分の合計数を出すためのSQLを作りたいと思っています。 上の例で言うと、 2013-11-01はdistinctなstationは2個 2013-11-02はdistinctなstationは3個なので、 2013-11分の合計として、 「5」個という数を出したいと思っています。 - select count(distinct station) from table_name where date like '2013-11-%' - とすると日付の区別もなく、 固有のstationの個数として「4」個と出てきてしまい、 どうしていいか分からないでいます。 どんなSQLを作れば、 日付ごとの「distinctなstation数」の1ヶ月分の合計値を出すことが出来るでしょうか。 教えていただけますと幸いです。
数年前NoSQLは話題でしたが、今はどうなっているのでしょうか？ 一番基本的なmemcachedはやはり今でも多く使われているのでしょうか？ それともMongoDBやCassandraのような後発の方が多いのでしょうか？ 自分は以前TokyoTyrantが好きで使っていました。 Cassandraはfacebookやtwitterで使われていると以前聞いたのですが、このサイトを見ると、 http://d.hatena.ne.jp/cypher256/touch/20121013/p1 使用を断念、今はfacebookはHBASEにMySQL、twitterはmemcachedにMySQLらしいですが。 しかも（大規模サーバなどではなく小さな個人の検証ですが）速度もSQLiteにすら完璧に負けているとか書かれていると、NoSQLってなんだ？と。 何かこういうのを見てると、一時期勢いのあったNoSQLも完全に失速したのかなと思います。 http://gihyo.jp/dev/clip/01/orangenews/vol61/0003 他にこういうページもありましたが、今人気で運用実績が高いのはどれなのでしょうか？ アドバイス頂けたらと思います。
SQLSERVER2008にてフルテキストインデックス検索であるカラムを検索しています。 例 naiyouというカラムに関してレコードとして、 「始まり 私は人間です。 第二章 私はさるです。 終わり」 という文章が１レコード入っているとします。 この場合、仮にcontains (naiyou,'人間')と検索するともちろんこのレコードがHITします。 今回やりたいのは、 ・naiyou内の第二章以降の文章で「人間」と検索した場合、ノーヒットとなること ・naiyou内の始まり～第二章までの間で「人間」という検索をして、HITすること という、カラム内のある文字間でのCONTAINS　検索というのは可能でしょうか、そしてそのSQLはどのようにかけばいいのでしょうか？というご質問です。 NEARとかでできるのかと思い、いろいろやってみましたがうまくいきませんでした。 なぜこのようにしたいかというと、いま処理している文章の冒頭がすべて同じ文面になっており、文面内の単語で検索されてしまうと全件HITしてしまうからです。 本来なら、その冒頭を除いた文章で単語をHITさせたいため、範囲指定を考えました。 ご教授いただければ幸いです。
前提：ORACLE 「一番古いレコードを取得する。」というのが条件です。 これを満たすだけであればSEQENCE等で連番を振れば満たせます。 しかし、日付時刻＋連番であればカラム一つで時刻まで把握できます。 (日付時刻を利用することはありませんが、付加価値？として。) というわけで、日付時刻＋連番(桁固定のサイクリック)の主キーを使いたいのですが、 以下のように同時刻で連番が先頭に戻ると順番が守れません。 時刻A９９９９ 時刻A００００　← あとから挿入したのに同時刻の先頭になる プログラムであれば同時刻なら連番を先頭から使うことも簡単ですが、 このよなことをSQL側だけでできるのでしょうか？ よろしくお願いします。
皆様 いつもお世話になります。 早速ですがご質問させて頂きます。 Postgresqlを使ったシステム開発の勉強するため、最新版をインストールしようと思っています。 (利用しているPCは中古で購入したものなので)あらかじめ入っていたPostgresqlを アンインストールしようと思ったのですが、方法が分からず困っています。 PCにPostgresqlがあらかじめ入っているかどうかは以下のコマンドで確認しました。 #psql --version psql (PostgreSQL) 9.1.9 contains support for command-line editing とりいそぎGoogleで検索してみたところ、 /Library/PostgreSQL/(Postgresqlのバージョン)/uninstall-postgresql.app にてアンインストールできるらしいのですが、/Libraryディレクトリ以下にPostgreSQLディレクトリがありませんでした。 作業が進まずほとほと困っています。 どなたかお詳しい方ご教授のほど何卒宜しくお願い致します！ 環境： MacOSX 10.8.5 Postgresql9.1.9
いつもお世話になっております。 Accessの特定のデータを、ある特定のExcelの指定したシート及びセルにエクスポートする方法が分かりません。 例として、Accessのテーブル（T_売上）のフィールド（品名）をエクセルファイル（販売.xls）のsheet1のシート名（売上明細）のセル「D6」へ、同じくAccessのテーブル（T_売上）のフィールド（金額）をエクセルファイル（販売.xls）のsheet1のシート名（売上明細）のセル「F12」へエクスポートしたいのです。 これにより、Accessデータを利用して、請求書を作成したいのです。 もちろんAccess上では、請求書発行プログラムは作っていますが、今回、Excelで利用する必要が生じたための質問です。 Access及びExcelは2010（ＯＳはWindows7）です。Access、Excelは2003でも構いません。 また、Access、Excelは共にC:\にあります。 ネットでも色々と調べてみましたが、今一つ要領を得ません。 方法をご存知の方は是非アドバイスをお願い致します。
お世話になります。 よく他のサイトなどで見かけるカテゴリ分けの際にそのカテゴリに属する件数を表示する際、下記のどような方法が賢いのでしょうか？ 【例】 登録されている不動産データ（1万件前後とします）を県別でカテゴリ表示 ・東京都（1,234） ・神奈川県(987) というように表示をしたい。 【方法１：】 データを追加・変更をする時点で、変更前のカテゴリの個数から-1、変更後のカテゴリの個数に+1をしてUPDATEで変更する 【方法2：】 定期的にcronでカウントするプログラムを走らせる ⇒ただこの方法だと実際の件数とCronが走るまでの間に個数に差が発生してしまう問題がでてしまう。 【方法3：】 ページを読み込む際に、count(*)で数える 【方法1】で作っていましたあ２つのカテゴリにまたがる場合（東京都、神奈川県両方）もあり、このとき【方法1】での処理が難しく質問をさせて頂きました。 上記以外にも何か良いカテゴリ件数の表示方法がありましたらアドバイス頂けますと幸いです。
現在、各部署、各チーム、個人ごとの売り上げを管理するDBの製作を行っております。 Microsoft Accessです。 テーブルは、 T_取引先 ・取引先ID ・取引先情報 ・担当ID（個人） T_個人 ・担当ID ・個人名 ・チームID T_チーム ・チームID ・チーム名 ・部署ID T_部署 ・部署ID ・部署名 T_注文履歴 ・履歴ID ・日時 ・取引先ID ・商品番号 ・個数 個人が複数のチームや部署に所属することはありません。 部署 < チーム < 個人 のピラミッドとなっております。 これで月初に、先月の売り上げを以下のようにプリントアウトを したいと思っております。 ============================================= 部署名1　売り上げ額 件数 ============================================= チーム名1（上記部署に所属するチーム）　売り上げ金額 件数 --------------------------------------------- 個人名1（上記チームに所属する各個人）　売り上げ金額 件数 個人名2　売り上げ金額 件数 個人名3　売り上げ金額 件数 --------------------------------------------- チーム名2　売り上げ金額 件数 --------------------------------------------- 個人名4　売り上げ金額 件数 個人名5　売り上げ金額 件数 個人名6　売り上げ金額 件数 個人名7　売り上げ金額 件数 --------------------------------------------- チーム名3　売り上げ金額 件数 --------------------------------------------- 個人名8　売り上げ金額 件数 個人名9　売り上げ金額 件数 個人名10　売り上げ金額 件数 ============================================= 部署名2　売り上げ額 件数 ============================================= チーム名4　売り上げ金額 件数 --------------------------------------------- 個人名11　売り上げ金額 件数 個人名12　売り上げ金額 件数 個人名13　売り上げ金額 件数 　　　　・ 　　　　・ 　　　　・ こういうことは可能でしょうか？ できれば、売り上げの多い部署順や、部署の中でも売り上げの 多いチーム順など変更が出来ればベストです。 また、このようなものを作る際に気をつける点はありますでしょうか？ 今まで、顧客DBなどを作成し、様々な条件に対して絞込み などをしたリストを最終的に印字して郵送するなどのものは 作ってきましたが、このような複雑な出力をしたことがなく 迷っております。 まだ、漠然としているかもしれませんがよろしくお願いいたしします。
access2002でSQLで書いています。 とある文章のアタマとお尻をチョンぎって、真ん中だけ抜き出すようにしたいのですが UPDATE [A表] SET [A表].F1 = Mid([F1],32); UPDATE [A表] SET [A表].F1 = Left([F1],Len([F1])-20); と２クエリになっています。これを１つにすることは可能ですか？出来るはずだとは思うのですが・・・。 OracleSilver10g所有者なんですけど５年以上やってないと基礎的なところまで スッカリサッパリ忘れてしまっていて本当に歯がゆい感じで困ってます。 ちょっとやれば思い出せるだろうとナメていました。UPDATEすらgoogleに頼るまで忘れてました。
select * from xTABLE where EMP_ID = "P001" というSQLを実行すると SQL0206N "P001" is not valid in the context where it is used. SQLSTATE=42703 のエラーが出ます。 SQLSTATEで調べても「"P001"の列がテーブルにない」ということみたいですが 列名で捉えている時点でおかしい気がします select * from xTABLE where EMP_ID = null のSQLは正常にテーブルのSELECT結果が返ってきます。 どうすればよいでしょうか？
こんにちは！ Accessについて、質問です!! あるフォームの『修正』というボタンのクリック時プロパティに、以下のVBAが組み込まれています。 Private Sub 修正_Click() CopyRec End Sub ここに新たに、 『メッセージボックス』『ウインドウを閉じる』VBAを加えたいのです。 現状として…… (1)Private Sub 修正_Click() CopyRec MsgBox "修正が完了しました" End Sub (2)Option Compare Database （下線） Private Sub 修正_Click() CopyRec End Sub Option Compare Database （下線） MsgBox "修正が完了しました" End Sub 上記(1)(2)は、失敗しています。 質問は２つあります。 (1)１つのプロパティに、複数のVBAを設定するのは可能ですか？可能なら、どのようにVBAを入力すれば正常作動するのでしょうか？ (2)『ウインドウを閉じる』VBAの書き方が調べても分かりませんでした……。どのように入力するのですか？ どちらか１つが分かる方でもかまいません。 回答よろしくお願いします！
すいません。初めてデータベースを扱うのですが、今までローカル環境でしか動かしていないため どのように実際に動かすのか分からない部分があります。（サイトは完成していましてローカル環境ではちゃんと動きました） まずデータベース名やアカウント名なのですが、データベースのためにさくらのサーバーを借りました。 データベースの設定画面を見ると以下のようになっています。 ----------------------------------------------------- データベース バージョン: MySQL 5.5 データベース サーバ mysql9999.db.sakura.ne.jp データベース ユーザ名 (初期アカウント名) abcd777 接続パスワード変更 ************ データベース名 abcd777_data ------------------------------------------------------- 上記の場合以下で合っているのでしょうか？ $pdo = new PDO("mysql:dbname= _abcd777_data ; host=mysql9999.db.sakura.ne.jp", "abcd777", "************"); ポート番号なども設定があるような事も書いてあるサイトがあるのですが何をどうしてよいのか 全く分かりません。（とりあえず上記のような設定でデータベースからデータをphpで呼び出しましたが 上手く動きませんでした） もう一つ疑問があるのですが、私はトップページをindex.phpとしましたが、上記のような方法では アカウントやらパスワードが丸見えですよね？ そもそも私は全く違う事をしているのでしょうか？ できれば実際の運用の流れも簡単に書いてもらえると助かります。
Oracleで一時表領域(TempTbs)用のTEMPファイル(TEMP01.DBF)を新規に作成しようと思いましたが 誤ってTEMP01.DBFに対してインデックス表領域(IndexTbs)を割り当ててしまいました。 ※IndexTbsを割り当ててるDBFファイルはもうひとつ存在してます なので一度下記のコマンドでオフラインにしました。 ALTER DATABASE DATAFILE 'E:\ORADATA\DATABASE1\TEMP\TEMP01.DBF' OFFLINE その後でE:\ORADATA\DATABASE1\TEMP\TEMP01.DBFを誤って別の場所(デスクトップ)へ 移動してしまい、その後で上記所定の位置へ戻し ALTER TABLESPACE IndexTbs DROP DATAFILE 'E:\ORADATA\DATABASE\TEMP\TEMP01.DBF';で 削除しようと思いましたが「ORA-02142:ALTER TABLESPACEオプションがないかまたは無効です」の エラーが表示され削除できません。OracleEnterpriseManagerでTEMP01.DBFファイルの属性を 確認するとステータスが「オフライン(リカバリが必要)」となっています。 正常にオフラインできていないようです。 残っていても問題ないのかもしれませんが、あっても気持ち悪いのでTEMP01.DBFを 削除したいのですが、正しい手順で削除するにはどうすればいいでしょうか？ よろしくお願い致します。
SQLでSELECT文を使う場合、大抵 　SELECT ID, user FROM u_table のように、取得する項目を指定すると思います。 これを、 　SELECT ＊ FROM u_table としないのには、トラフィックの問題以外に何か理由があるのでしょうか？
お世話になります。 VB.NETでウェブアプリ開発をしようと、以下の環境に、(1)～(4)の手順で環境を作成しました。 作業環境：Win7 x64 Pro（仮想マシン） 使用ツール：Visual Web Developer2010 MySQL：5.6.15 Conector/NET：6.7.4 (1)Visual Web Developer2010　をインストール (2)SQLServerではなく、MySQLが使いたい為、別途MySQLをインストール (3)データベース：TEST_DB　と、テーブル：t_sample を作成 (4)mysql-connector-net-6.7.4.msi　　をダウンロードし、インストール。 　（Select Platform:Microsoft Windows) 環境作成後、 Visual Web Developer2010　を起動し、プロジェクトを新規作成し データベースエクスプローラーより、接続の追加を選択し、 データソースの選択　ダイアログを開くきましたが データソース一覧に、MySQLが表示されず、接続が出来ません。 .net、MySQLで検索をしますと、多くの参考資料が見つかります。 その殆どが、「Conector/NETのインストール」だったのですが、 他にも何か必要なもの、あるいは操作が必要なのでしょうか？ もしくは、手順上に誤りがあるのでしょうか？ ご教授くださいませ。
表題の通り、MySQLでカラムの論理名を取得する方法を探しています。 show full columns from table; でやってもダメでした、、、
いつもお世話になります。 SQL文で質問があります（環境はPHP＋SQLiteです）。 keywordというカラムがあって、そこにはキーワードとして使う文字列が入っています。 （データベースを検索するときに使うタグを集めたようなものです） 例えば、 "本 料理 ブック cooking book" という感じです。 UPDATEで、このカラムに別のキーワードを追加したい場合、どのようなSQL文にすれば良いのでしょうか？ 追加するキーワードは既存のキーワードと重複しないように追加したいです。 例えば、すでに"本 料理 ブック cooking book"というレコードがあるので、UPDATEで「レシピ」を追加したら"本 料理 ブック cooking book レシピ"となるように、「本」を追加する場合はすでに「本」という文字列があるので既存のままで変更なしにしたいです。 そもそもこのようなことはSQL文でできるのでしょうか？ できないとしたら一旦SELECTでkeywordのレコードを取得してPHPで改変したものをUPDATEで上書きするしかないでしょうか？ どうぞよろしくお願い致します。
タイトル通りですが、windowsで特にいじりません。 バックアップとして置いておきたいだけです。 置いてリストアなどでLinux側へ配置後実施の流れをとる場合、何か問題があるでしょうか。 [環境] Linux:CentOS6.3 windows:windows server 2003 mysql:mysql2 よろしくお願いします。
MySQL Version 5.1.41 このジャンルでお願いします。 例えば地名を格納する テーブル「area」 +------+-------+ |　id　|　name　| +------+-------+ |　1　|　渋谷１丁目| +------+-------+ |　2　|　渋谷２丁目| +------+-------+ があったとします。 次にその上位？（これらの丁目を包括する）データが必要なった場合に 新たにテーブルを作ってその外部キーをテーブル「area」に新たに追加する方法が良いのでしょうか？ テーブル「grouparea」 +------+-------+ |　id　|　name　| +------+-------+ |　1　|　渋谷区| +------+-------+ テーブル「area」←このテーブルの列構造をその都度変える +----+---------------+-----------+ |　id　　|　grouparea_id　　|　　　name　　| +-----+-------------+-----------+ |　1　　|　　　　　　1　　　　|　渋谷１丁目| +-----+-------------+-----------+ |　2　　|　　　　　　1　　　　|　渋谷２丁目| +-----+-------------+-----------+ でもこれだとさらにその上位概念のエリア「東京」や「東京」は 「関東」、あるいは「東日本」といった具合に追加したくなった場合に、 順番的に「grouparea」テーブルの先に「ken」テーブルを追加してて 後に「grouparea」テーブルを追加したくなったら テーブル「ken」 +------+-------+ |　id　|　name　| +------+-------+ |　1　|　東京都| +------+-------+ テーブル「area」 +----+---------------+-----------+ |　id　　|　　　　　ken_id　　|　　　name　　| +-----+-------------+-----------+ |　1　　|　　　　　　1　　　　|　渋谷１丁目| +-----+-------------+-----------+ |　2　　|　　　　　　1　　　　|　渋谷２丁目| +-----+-------------+-----------+ 次に「grouparea」テーブルを追加したくなったら テーブル「ken」 +------+-------+ |　id　|　name　| +------+-------+ |　1　|　東京都| +------+-------+ テーブル「grouparea」 +----+---------------+-----------+ |　id　　|　　　　　ken_id　　|　　　name　　| +-----+-------------+-----------+ |　1　　|　　　　　　1　　　　|　渋谷１丁目| +-----+-------------+-----------+ テーブル「area」 +----+---------------+-----------+ |　id　　|　grouparea_id　　|　　　name　　| +-----+-------------+-----------+ |　1　　|　　　　　　1　　　　|　渋谷１丁目| +-----+-------------+-----------+ |　2　　|　　　　　　1　　　　|　渋谷２丁目| +-----+-------------+-----------+ このような変更しなくてはいけないですよね？（このような変更が可能なのかは分かりませんが・・・） 自分的にはこのやり方は違うような気がするのですが、 なにか良いやり方や考え方があればアドバイス頂けないでしょうか？
UPDATE tableA, tableB SET tableA.name = tableB.name WHERE tableA.id = tableB.id; 上記のSQLが他のデータベースでは動きますが、SQLiteでは動きません。 同意味のSQLはどう書くのでしょうか。お願いします。
ACCESS2007 ＋　Win7Pro 選択クエリで[日付]フィールドを昇順でソートした場合￥の順位を [日付順位]フィールドに出るようにしたいのですが、 [日付]が重複している場合、例えばレコード数が30個で、 2013/1/1、2013/5/20、2013/11/6の３種類しか存在しないときは、 １、２、３のいずれかになるようにしたいです。 どうか教えてください。
お世話になります。 現在Web上で動作する商品管理のツールをPHP＋pdo＋MySQLでデータベースを構築しています。 MySQLでの構築は初めてで、いろいろ手間がかかっています。 今まではPHP＋pdo＋SQLiteでデータベースを構築していました。 しかし同時書き込みでデータベースがロックしてしまうSQLiteの仕様では複数人数での運用ができません。 そこでMySQLに変更しようと思ったのですが、いろいろ覚えることが多くて時間がかかってしまっています。 やはりSQLiteの構築のしやすさは魅力的です。 そこで、MySQLでの構築を一旦中止し、SQLiteで構築しようかと思っています。 PHP側で工夫してSQLiteのデータベースへの同時書き込みを無くせば運用的には問題なさそうでしょうか？ セキュリティ的に不安ですがデータベースはルートより上に置きます。 助言があればお願い致します。
CentOS5.3を使用し、PHPのバージョンを4系から5.3へバージョンアップしたらMySQLの挙動が変になりました。 これまでは、 # mysql -u -p [enter]でパスワードを要求され、パスワード入力後MySQLにログインできていて、 mysql>show databases;を実行するとこれまでのデータベース一覧が当然出てきました。 バージョンアップ後、 # mysql -u -p [enter]でパスワード要求もなくログインされ、 mysql>show databases;を実行すると、 +--------------------+ | Database +--------------------+ | information_schema | test +--------------------+ のみ表示されます。 どうしてこうなったのかわかりません。 PHPのバージョンアップは以下のとおりしました。 以前のPHPバージョンを削除 yum remove php php-* 5.3のインストール # yum install php53 php53-mbstring php53-mysql なお、WordPressをインストールした際にも以前は通常通りインストールできたのですが、 5.3にしてからは 「データベース接続確立エラー」と表示されDBへ接続できないようで困っています。 以前質問させていただいた時に 「MySqlの設定が初期化されたかMySqlも更新されたかです。」とご教授をいただいき、 # ls /etc/my.cnf* を実行したところ、すでに /etc/my.cnf my.cnfが存在しております。 当該サーバーに以前より現存していたDBを使ったサイトの閲覧も可能なので、どうなっているのかわかりません。 緊急性を要し、再度ご質問させていただきました。 大変申し訳ございませんが、ご教授よろしくお願いします。
wordpress目的でxamppを入れて、しばらく利用してたのですが 今日突然apacheのみ立ち上がらなくなりました。 mysqlとftpはOKです。 localhostはみれてます。 ☆環境 ・OS：mac 10.6.8 ・xampp：1.7.3 ・エラーメッセージ： httpd: Syntax error on line 120 of /Applications/XAMPP/xamppfiles/etc/httpd.conf: Cannot load /Applications/XAMPP/xamppfiles/modules/mod_apreq2.so into server: cannot create object file image or add library XAMPP内にmod_apreq2.soというのは無いようです。。。 ☆試したこと ・再起動 ・ポート80がかぶっていることが原因のケースがあるようなので確認しましたが特にスカイプなど利用しておらず無さそうです。 ・「システム環境設定」より「web共有」のon/off 再度インストールはまだしてないのですが、その前に改善方法があらばと、 ご質問させて頂きました。どなたかご教授いただけますと幸いです。
現在、とあるショッピングサイト（データベースはPostgreSQL、OSはLinux）を運営しておりまして、そのサイトの英語版を別のサーバで作ることになりました。 商品数が膨大にありますため、一つ一つの商品をショッピングサイトの管理画面からコピーペーストし翻訳することは、物理的にできません。 そこで、PostgreSQLのデータベースの中身を自分のPC(Windows7)にいったんコピーし、テキストエディターで開き、翻訳した後、CSVによって英語版サーバへアップロードする方法を思いつきました。 pg_dumpによってデータベースをコピーし、FTPによって自分のPCに持ってくることは、できました。 いざ拡張子に.txtと付けてメモ帳で開いてみたところ、添付画像のような文字化けとなってしまいました。 拡張子をhtmlに変更しブラウザのエンコードで、シフトJIS、EUC、UTF-8といろいろ試しましたが、ダメでした。DreamWeaverのような文字コードの変換ができるエディターで全ての文字コードを試しましたが、やはりできません。 添付画像のような文字化けを日本語に直す方法をご存知の方、いらっしゃいませんでしょうか？
COBOL上（NETExepress5.0）にSQL構文を埋め込んでプログラムを作っています。 DELETE文を発行して、そのDELETE件数を取得して、DISPLAY文に表示したいのですが、 どのようにすればよいでしょうか。 DELETE文（COBOL文中） 例） 　EXEC　SQL　DELETE　FROM　テーブル名 　END-EXEC 先にSELECT　COUNT（*)　FROM　テーブル名 とかしてもかまわないです。 よろしくお願いします。
PostgreSqlのテーブルをVBから更新 【テーブル】 tbl1 ( item1 integer not null, -- 数値：ユニークキー , item2 character varying, -- 文字 , item3 timestamp without time zone -- タイムスタンプ , CONSTRAINT tbl1pk PRIMARY KEY (item1) ) 【仕様】 １．テーブル内の特定の１レコードを取得 ２．取得したレコードをVBの画面に表示 ３．入力：VBの画面で　item2　の表示内容を変更 ４．ボタン入力 ４－１．レコードが存在しない場合 　メセージボックスに「誰かが消した」と表示 ４－２．タイムスタンプに変化がある場合 　メセージボックスに「誰かが変更した」と表示 ４－３．タイムスタンプに変化がない場合 　Updateする。 【前提】 普通にアップデートするだけなら、下記でできました。 Private DateTime1 As DateTime ' 画面表示の時に取得したitem3の値が入っているとする 　： 　： Dim NpgsqlConnection1 As NpgsqlConnection = New NpgsqlConnection Dim NpgsqlCommand1 As NpgsqlCommand = New NpgsqlCommand NpgsqlCommand1 = NpgsqlConnection1.CreateCommand NpgsqlCommand1.CommandText = "update tbl1 " _ & "set item2 = '" & Me.TextBox1.Text & "'" _ & ", item3 = current_timestamp " _ & "where item1 =" & キー値 NpgsqlConnection1.ConnectionString = 接続情報 NpgsqlConnection1.Open() NpgsqlCommand1.ExecuteNonQuery() NpgsqlConnection1.Close() 【考察】 変更された場合は、更新対象外にするのは、条件に入れればなんとかなります。 NpgsqlCommand1.CommandText = "update tbl1 " _ & "set item2 = '" & Me.TextBox1.Text & "'" _ & ", item3 = current_timestamp " _ & "where item1 =" & キー値 _ & "and date_trunc('second', item3) =" & "to_timestamp('" & Format(DateTime1, "yyyy-MM-dd HH:mm:ss") & "', 'YYYY-MM-DD HH24:MI:SS')" しかし、これではこのＳＱＬで更新されたのか、他で更新があったためにスキップしたのかが分かりません。 直前のＳＱＬで更新があったかどうか、もしくは何件更新対象になったかを得る事はできませんか？ もしくは、 一旦呼び出してロックし、その間にタイムスタンプを取り出し、 Ｖｂ内に持っていた前回のタイムスタンプと比較し、同じであれば更新する。 同じでなければステータスを返す。 というふうにしたいです。 【質問】 アップデート文で更新対象になった件数を取得する事はできませんか？ もしくは、フェッチの方法を教えて下さい。 上記の仕様のようにタイムスタンプを判断し、そのレコードを掴んだままアップデートしたいなら、フェッチするしかないのかと思っています。 でも、そのやり方が分かりません。 ・コネクト ・カーソル定義 ・カーソルオープン ・ネクストレコード ・レコードを取得し、VB側のタイムスタンプと比較←どうやって？ ・カーソル行に対しアップデート ・レコードの終わり ・０件なら「誰かが消した」と表示 ・カーソルクローズ ・コネクト解除 やりたい事は上記でSqlもVbも分かるのですが、インターフェイス込みでコマンドレベルの方法が分かりません。 フェッチでの方法が分からないので教えて下さい。 フェッチで以外の方法で同等の事が出来るもっと良いやり方があれば教えて下さい。 以上、よろしくお願いします。
お世話になります。 商品データとカテゴリテーブルをそれぞれ分けたデータベースを作っており、JOINで該当カテゴリ名を抽出しています。 しかし商品によって複数のカテゴリに属する（カンマ区切りで「1,2,3」というように現状格納しています）場合、それらのすべてを拾ってくることは可能でしょうか？ またカテゴリひとつひとつに対して商品データ内にカラムを用意するべきでしょうか？ select `shop`.no, left outer join list_category on `shop`.category=`list_category`.no （現状） どうぞよろしくお願い致します。
すいません。今phpなどを使いウェブサイトを作っているのですが、データベースがどうしても 必要となり、参考サイトなどを見ながら作りました。 ほとんどできたのですが、最後に一部データベースの関数などでわからない事があり困っています。 （正直私はプログラムはphp程度が少し分かる程度で、データベースも単純な使い方しかしない 予定なので参考サイトをざっと見ただけでmysqlの事がほとんど分かりません） ググってそれらしい物を探してはいるのですが、私がやりたい事はデータベースから 件数を取りたいだけです。 取った件数をphpで表示したいのですが、何時間やっても良くわかりません。 申し訳ないんですが取り出した後その件数をphpのechoで表示するまでをサンプルとして書いてもらえませんか？（可能であれば「ここでこのような処理が行われている」とコメントがもらえると助かります） データベース関係はphpと違って初心者用のサイトなども無く、書いてある事がほとんど分かりません。 （ここでSELECT COUNT(*)を使うと教えてもらったのですが、SELECT COUNT(*)でググっても サンプルなども出てきません） $pdo = new PDO("mysql:dbname=aaa", "root"); $pdo->query("set names utf8;"); // ------------------------------------------------ $sql = $pdo->query("SELECT COUNT(*) FROM bbb"); $stmt = $pdo->query($sql); $stmt->execute(); $count=$stmt->rowCount(); echo $count; ----------------------------------------------- $result = mysql_query("SELECT COUNT(*) FROM bbb"); $row = mysql_fetch_assoc( $result ); echo $row;
プログラム初心者です phpとmysqliの手続き型を使っています 簡単な掲示板を作りました MyISAM から InnoDBに変更したいです phpadminから InnoDBにテーブルは変更できました InnoDBを使うときのsqlはMyISAM で使っていたsqlをそのまま使っていいでしょうか?（特に変更するところはないでしょうか？） よろしくお願いします
すいません。今PHPとデータベースを勉強中なのですが、 $st = $pdo->query("SELECT * FROM udon WHERE not abc = '111' limit 5, 10 "); 例えば上記のような絞り込みをした後、絞り込んだ後の数を数えたいのですがそのような 事はできますでしょうか？ 絞り込み後の検索結果が５件以上の場合、残りを「次のページ」などのように分けて表示させたいのですがデータベースの絞り込み後の数を数える方法が分からないため先に進めません。 わかる方いましたら教えてください。
SQLServser2012で縦持ちになっているデータを横持ちにしたいのですが、どうしたらよいでしょうか？ 〇以下のように現在、テーブル設計されております。 請求TBL --------------------------------------------- 請求ID 請求先名 001 田中 太郎 002 鈴木 一郎 注文TBL ------------------------------------------------ 請求ID 注文ID 発送先 商品ID 個数 001 001 田中 太郎 A 10 001 002 佐藤 次郎 A 5 002 003 鈴木 一郎 B 3 商品TBL ----------------------------- 商品ID 商品名 A みかん B りんご このデータを以下のような結果として得たいのですが、どのようにしたらSQLを作成したらよろしいでしょうか？ 請求ID 請求先 商品内容 ------------------------------------------------- 001 田中 太郎 みかん*10、みかん*5 002 鈴木 一郎 りんご*3 ご教授の程、宜しくお願い致します。
以下のEx1,2のJOIN句の記述方法の違いはクエリのパフォーマンスに影響するのでしょうか？ 2万件程度のデータ量で試してみたのですが明確なパフォーマンスの違いを確認できませんでした。(1秒～2秒) 単純に書き方だけの違いであれば心置きなく自分ではわかりやすいと感じているEx1の記述方法で統一したいので。 よろしくお願いします。 -- /* SQL Server 2008 R2 */ -- /* 受注した全ての商品名を取得するクエリ(例) */ -- /* 登場テーブル・カラム */ -- // M_goods 商品マスタ -- // code 商品コード -- // name 商品名 -- // T_orders 受注テーブル -- // number 受注番号 -- // T_orderdetails 受注明細テーブル -- Ex.1 SELECT M_goods.name FROM T_orders LEFT JOIN T_orderdetails ON T_orders.number = T_orderdetails.number LEFT JOIN M_goods ON T_orderdetails.code = M_goods.code -- Ex.2 SELECT M_goods.name FROM T_orders LEFT JOIN T_orderdetails LEFT JOIN M_goods ON T_orderdetails.code = M_goods.code ON T_orders.number = T_orderdetails.number
以下のようなSQL文があった場合 SELECT table_a.* FROM table_a LEFT JOIN table_b ON (table_a.id = table_b.aid) これでtable_bを連結したtable_aができると思いますが、table_bのフィールドは id , aid, value となっていた場合、valueが「1」かつ「2」のデータを検索する場合は、どのようにWHERE句を書けばいいのでしょうか。 WHERE (table_b.value = '1' AND table_b.value = '2') ではうまく取得出来ませんでした。 お分かりの方、よろしくお願いします。
SQL Server2008でパフォーマンスの悪いSQLなどを調べようと思い、 以下のような説明を参考にしています。 http://msdn.microsoft.com/ja-jp/magazine/cc13597 … http://msdn.microsoft.com/ja-jp/library/ms189741 … しかし、エラーが出て実行できません。 SQL文から抜粋しますと、以下の様なエラーが発生ます。 　・THEN LEN(CONVERT(nvarchar(max), qt.text)) * 2 　　　→'max' の近くに無効な構文があります。 　・CROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) AS qt 　　　→'APPLY' の近くに無効な構文があります。 　・SELECT qs.execution_count 　　FROM sys.dm_exec_query_stats AS qs 　　　→'sys.dm_exec_query_stats' は無効です。 調べても何が悪いのかわからず困っています。 何がいけないのかご教授いただけませんでしょうか。 よろしくお願い致します。
ACCESS2000にて現在、元となる勤怠データから社員別日別に訪問時間や移動時間、業務時間等を算出していております。その中でテーブルからそれぞれ異なる条件で抽出したフィールドの合計値の表示させ方をお教え願います。 具体的には下記に元データと作成したいデータのレイアウト図を記載します。 （元データ） 社員コード| 日付 |区分|勤務時間|移動時間|合計時間|業務のカウント|訪問のカウント|開始時間 =============================================================================== |１111111 |2013/10/01　|業務|　400 | 120 | 520 | 1 | 0 | 08:00 |１111111 |2013/10/01　|訪問|　400 | 100 | 500 | 0 | 1 | 09:00 |１111111 |2013/10/02　|訪問|　300 | 200 | 500 | 0 | 1 | 09:00 |１111111 |2013/10/03　|業務|　200 | 200 | 400 | 1 | 0 | 08:00 （作成したいデータ） 社員コード| 日付 |勤務時間|移動時間|合計時間|業務のカウント|訪問のカウント|開始時間 =============================================================================== |１111111 |2013/10/01　|　800 | 220 | 1020 | 1 | 1 | 08:00 |１111111 |2013/10/02　|　300 | 200 | 500 | 0 | 1 | 09:00 |１111111 |2013/10/03　|　200 | 200 | 400 | 1 | 0 | 08:00 ちなみに　”開始時間”　は　「区分」フィールドの値が　”業務”の時の開始時間と　”訪問”の時の開始時間を比べて時間が早い方を表示させます。 上記でネックなのは　日によって　「区分」フィールドが　”訪問”　の場合のみも有り、尚且つ　”業務” の場合のみも有り、更に　”訪問”、”業務”両方が入っている場合もあり、ただ単純に ”業務”のみ　と　”訪問”のみのデータをクエリで分けて　結合させると言う訳には行かないところです。 お手数ですが何卒よろしくお願い致します。 |
初めてWEBアプリのDB設計を行っています。 あまり時間がなく教育期間がないため、基本的なことがよくわかりません。 疑問 ・WEBページに対してマスタはもつものなのでしょうか。 例） WEBコード　001 　　　WEB画面名称　新規登録 　　　WEBアドレス　HTTP:// など・・・ 最低限これを押さえとけなどの参考ページ等ございましたら ご教授願います。
FileMaker pro7をPDFにする方法がわからず、困っています。 現在winXPでFileMaker pro7を運用していますが、XPのサポート期限が切れることと、FileMakerを今後使用しない方針のため、過去のデータをFileMakerに依存しない方法で保存しようと考えています。 プリントアウトも考えたのですが膨大であります。見た目が崩れない、互換性があるのでＰＤＦ化したいのです（今後データベース的には使用しません。あくまで保存のみです、必要に従いプリントアウト、です）。 お知恵を拝借下さい！
Access2003を使用しています。初心者です。 現在モジュールに以下のようなプロシージャを書いて、クエリ内の数式で使用しています。 　Public Function Nendo() As Integer 　　Nendo = 25　’年度 　End Function このようなものが２0個程あり、年度が変わるごとに全ての値を入力し直しています。 （年度・西暦・配付率などその年の数値） これを、例えばメインフォームで”25”（年度）と入力したら、モジュールをその年のデータに全て書き換えるVBAを作りたいと思っています。 そこで”年度”を主キーにしたテーブルを作成し、そこに他の項目（西暦・配付率など）のフィールド（２０個）を設定し、そのデータを利用できないかと考えています。 そもそもモジュールの値を書き換えたりできますか？ どのようなVBAを書けばいいか、教えていただけると幸いです。
SQLiteにはREPLACE文がありますが、これを使うと、例えばn,c1,c2,c3フィールドがあるデータsampleに対して「replace into sample (n,c2) values (1,1)」を実行すると、c1とc3はnull値になってしまいます。 一部のSQLデータベースで用意されている「INSERT OR UPDATE」のように、行が存在すれば対象のフィールドのみを書き換え（それ以外のフィールドの内容は維持）、存在しなければ行を追加する構文を作ることは可能でしょうか。
こんにちは。 独学でPL/SQLを学んでいるのですが、パッケージの使用でうまく処理が走らないので、 アドバイスを頂けたらと思い書き込みさせて頂くことにしました。 パッケージtestは、オーバーロードプロシージャSHOW_BIZDAYS(日付, 数値)とSHOW_BIZDAYS(日付)を含んでいます。パッケージコードは質問の下に書いております。 ■質問１ オーバーロードプロシージャSHOW_BIZDAYSの日付のみパラメータとする２つ目のプロシージャを EXECUTE test.SHOW_BIZDAYS('20-NOV-13') コマンドで実行したところ、『PLS-00307: このコールに一致する'string'が複数宣言されています。』というエラーが表示されてしまいます。 ２つのオーバーロードプロシージャのパラメータ数が異なるよう指定しているので、このエラーに関する原因を見つけれておりません。 ■質問２： SHOW_BIZDAYS(日付)において、ユーザーに数値を入力するようプロンプトをしたいのですが、 PROCEDURE SHOW_BIZDAYS( v_start_date IN DATE := sysdate) IS ACCEPT tdays PROMPT 'Enter how many days are needed: ' v_bus_days NUMBER := &tdays; と記載するとACCEPT文が無効とのエラーが検出されます。パッケージ内ではACCEPTが使用できないということでしょうか。 ■パッケージ create or replace PACKAGE test IS PROCEDURE SHOW_BIZDAYS( v_start_date IN DATE := sysdate, v_bus_days IN NUMBER := 30); PROCEDURE SHOW_BIZDAYS( v_start_date IN DATE := sysdate); END test; ■パッケージ本体 create or replace PACKAGE BODY test IS PROCEDURE SHOW_BIZDAYS( v_start_date IN DATE := sysdate, v_bus_days IN NUMBER := 30) IS v_counter NUMBER(3) := 1; v_date DATE := v_start_date; BEGIN WHILE v_counter <= v_bus_days LOOP IF UPPER(TO_CHAR(v_date, 'D')) NOT IN (1, 7) THEN DBMS_OUTPUT.PUT_LINE('The index is : ' || v_counter || ' and the table value is: ' || v_date); v_counter := v_counter + 1; END IF; v_date := v_date + 1; END LOOP; END SHOW_BIZDAYS; PROCEDURE SHOW_BIZDAYS( v_start_date IN DATE := sysdate) IS ACCEPT tdays PROMPT 'Enter how many days are needed : '; v_bus_days NUMBER := &tdays; v_counter NUMBER(3) := 1; v_date DATE := v_start_date; BEGIN WHILE v_counter <= v_bus_days LOOP IF UPPER(TO_CHAR(v_date, 'D')) NOT IN (1, 7) THEN DBMS_OUTPUT.PUT_LINE('The index is : ' || v_counter || ' and the table value is: ' || v_date); v_counter := v_counter + 1; END IF; v_date := v_date + 1; END LOOP; END SHOW_BIZDAYS; END test; 初歩的な質問で申し訳ありませんが、下記につきアドバイスをお願いします。
表題にUNIQUE制約の値を「更新」する方法とありますが、 正確にはUNIQUE制約が設定された値を「入れ替える」方法について質問します。 あるテーブルに order という並び順（数値）を格納するカラムがあるとします。※このテーブルのプライマリーキーは id とします。 並び順ですので一意な値です。よって、order にUNIQUE制約を設定しています。 例えば 1～5 個のデータ（フィールド）があったとして、並び順も 1～5 あるわけですが、この並び順を入れ替える場合、並び順を格納しているカラム（ order ）にUNIQUE制約があるため、それぞれ UPDATE で上書きすることができません。 つまり、{ id: 1, order: 1 } というデータと { id: 2, order: 2 } というデータの並び順（ order ）を { id: 1, order: 2 } と { id: 2, order: 1 } というように入れ替えようとする場合、並び順（ order ）は一意であるため、UPDATE で上書きができないのです。 できればトランザクション内で処理したいのですが、これらの処理をスマートに更新する方法はないでしょうか。それとも、並び順（ order ）にUNIQUE制約を設定せず、アプリケーション側で並び順（ order ）を一意に保つよう実装するしかないでしょうか。
現在phpMyAdminを利用してデータを入力しています。 初めてで不安な点があるので詳しい方にお聞きしたいことがあります。 □数字の入力について 後から平均を出したり足し算したりする予定ですが、コンマを入れた状態でも演算できますか？入れない方が良いのでしたら、tableに出力するときにコンマを入れて出力できれば良いのですが。 「20,150」「20150」 □名前の入力について 現在は「山田　太郎」というように姓と名の間に全角スペースを入れて一つのフィールドに入れているのですが、これは姓と名で分けたほうが良いでしょうか？ 例えばスペースを入れた状態でサイトの閲覧者がテキストフィールドから「山田太郎」と入力し検索して引っかかりますか？ □改行について 一つのセル？内に改行してデータを入力することはできますか？ 以上の三点です。 ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
ACCESS2000にて現在、営業担当者の勤怠データを集計しております。 勤怠データから　”訪問時間”、”移動時間”、”業務時間”　を計算し (1)営業担当者別の日別の　”訪問時間”、”移動時間”、”業務時間”の合計値を出す。 (2)　上記(1)のデータ更に　”１件目の訪問時間”、”2件目の訪問時間”、・・・・・・・　と言う様に 　　　その日の各訪問時間も加える。 上記内容にて作業をしておりますが、上記(1)については　集計クエリ等を使用して作成出来ました。 しかし　(2)については ’１．各訪問時間のデータをどうやってフィールドとして作成するか’ ’２．集計クエリで作成した合計値と明細データ（各訪問時間）をどの様にして１レコードにするのか’ が解らず困っております。　上記２点お解りであれば教えて頂ければと思います。 尚、今回の元データと　求めれているデータのイメージを下記に記載します。 （元データ） 社員コード| 日付 |区分|開始時間|終了時間|連番|Ｇ連番※| ============================================================ |１111111 |2013/10/01　|業務|　08：00 | 09:00 | 1| 1 | |１111111 |2013/10/01　|訪問|　09：10 | 09:30 | 2| 2 | |１111111 |2013/10/01　|訪問|　10：00 | 14:00 | 3| 3 | |１111111 |2013/10/01　|業務|　15：00 | 17:00 | 4| 4 | |2222222　|2013/10/01　|業務|　08：00 | 09:00 | 5| 1 | |2222222 |2013/10/01　|訪問|　10：00 | 15:00 | 6| 2 | |2222222 |2013/10/01　|訪問|　15：30 | 16:00 | 7| 3 | |2222222 |2013/10/01　|業務|　16：30 | 17:00 | 8| 4 | ※Ｇ連番は　担当者の日別の勤怠明細に振られた連番 上記のようなテーブルのデータから （求められているデータ） 社員コード| 日付 |訪問時間合計|移動時間合計|業務時間合計|１件目訪問時間|2件目訪問時間 ================================================================================== |１111111 |2013/10/01| 　　　260| 　　 100| 　 180 | 　　 20 | 240 |2222222 |2013/10/01| 　　　330| 　　 120| 　 90 | 　　 300 | 30 上記の様データを求め様としております。 尚、上記の時間単位は”分”で、移動時間については"[開始時間]－１つ前のレコードの[終了時間]" で算出しております。 お手数ですがよろしくお願いします。
お世話になります。早乙女遙佳と申します。 Webサイト上から会員名や点数を入力し、 送信ボタンが押されると、 受け取ったCGI側でDBに書き込み、 今月成績の良かった方、上位3名は○○さんと○○さんと○○さんです というサイトを作りたいと思っています。 データベースは、MySQLを使って学習していますが、 教えていただけますでしょうか？ scoreテーブルとして、以下のテーブルを作っています。 会員の毎月の点数と、先月からの点数の増加分を格納するテーブルです。 ID name score month increment 1 taro 100 11 0 2 jiro 200 11 0 3 taro 50 10 0 4 jiro 250 10 0 /* 今月の点数を求める */ SELECT score AS thisMonthScore FROM `score` WHERE name = 'taro' AND MONTH = '11'; /* 先月の点数を求める */ SELECT score AS prevMonthScore FROM `score` WHERE name = 'taro' AND MONTH = '10'; /* 点数の増加分を書き込む */ UPDATE `score` SET `increment`= 50 WHERE name = 'taro' and month = '11'; 質問１ 上記のUPDATE文では、増分を書き込むために、 `increment`= 50 としていますが、 upScore = thisMonthScore - prevMonthScore `increment`= upScore のように書けたらと思うのですが、できないものでしょうか？ 質問２ WHERE name = 'taro' の様に各会員の氏名を書いていますが、 「すべての会員についてループさせる」 様にはできないでしょうか？ 擬似コードですが memberName = select name from `score`; //会員名の配列 memberCount = select count('name') as cnt from `score`; //会員数 for (i = 0; i < memberCount; i++){ 　thisMonthScore = SELECT score AS thisMonthScore FROM `score` WHERE name = 　memberName[i] AND MONTH = '11'; //今月の点数 　prevMonthScore = SELECT score AS prevMonthScore FROM `score` WHERE name = memberName[i] AND MONTH = '10'; //先月の点数 　upScore = thisMonthScore - prevMonthScore; //点数の増加分 　UPDATE `score` SET `increment`= upScore WHERE name = memberName[i] and month = '11'; //DBの更新 } のようなイメージです。 DBの呼び出し元であるCGIでループを書けばもちろんできるのですが、 SQL文で処理させた方が速いのかなとも思ったりもしたのですが、 通常、どのように書くものでしょうか？ 毎月100件、1年で1000件、10年分で10000件くらいのレコード数になりますが、このくらいであればあまり速度などは気にせずとも良いものでしょうか？ 質問３ 成績の良かった方、上位3名を抽出するにはどのようなSQL文になるでしょうか？ 第一位　taroさん 50点 第二位　jiroさん -50点 第三位　saburoさん -100点 のような感じです。 初歩的な質問で恐縮ですが、 どうぞ、よろしくお願いします。
ファイルメーカーでデザインの管理をしています。 ある特定のアイテムのデザインだけ、管理項目が増え、 また必要でない項目があるのでタブで表示する内容を切り替えています。 例として、AからIのフィールドがあり、タブ1とタブ2があるとして タブ1：A,B,C,D,E,Fのフィールドを表示（G,H,Iの項目が表示不要） タブ2：A,B,C,G,H,Iを表示（タブ1に対して,D,E,Fが不要となり、G,H,Iの項目が増えます） タブ2で作業を続けたいのですが、特定の作業（レイアウトモードに切り替える等）をすると、 タブ1の表示にもどってしまいます。 スクリプトでレコードの複製を行った時（一部の内容のみが複製されるようななっている）をした時も、新しく作られたレコードの表示がタブ1に戻ります。 入力点数が多いため、いちいちタブを切り替えるのが面倒となっております。 上記のような場合で、入力中タブが切り替わらないようにすることは可能でしょうか？ 私の使用環境は iMac Core i5 Mac OS 10.8 MountainLion ファイルメーカーVer10 となります。 ご回答のほど、よろしくお願いします。
こんにちは。 みなさま、教えてください。 サーバーにOracle　11gデータベースを使用しています。 今回クライアントに先日リリースされたWindows8.1を導入しようと思っているのですが 最新のOracle Cliant(Oracle Databese 12c Release 1(12.1.0.1.0)はWindows8までの動作確認しか していないようです。 サポートセンターて問い合わせすると、今までのリリース経緯からすると Windows8.1対応リリースは来年10月頃になるのでは・・・ と言っていました。 私としては、それまで待てず当惑しています。 みなさま、このような悩みはございませんか？、
こんにちは。 SQL初心者です。 皆様に本日たくさん助けて頂いてます。 本当に感謝です。今一度お助けお願いします！ あるテーブルをエクスポートしたいのですが データを日付で区切りたいと思っています。 エクスポートするマシーンにいつも特定のテキストがあります。 それをDATE.ｔｘｔとするとその中には20131115などと書かれています。 これはもちろん日付です。 where 以下の条件にこの日付を用いたいのですが それにはどのように設定すればいいのでしょうか？ where open_chk_date = <DATE.txtの中の日付> こんな感じです。 どうぞよろしくお願いします！
こんにちは。 自分はデータベースの初心者です。 先程質問した内容にすぐにレスを入れて頂きました。 そこからもう一つ質問があったので別にここに作ります。 あるデータベーステーブルの中に日付時刻が混じったカラムがあります。 伝票のデータなんですが、伝票が作成された情報が chk_open_date_time というカラムで、実データは '2013-11-15 12:19:31.000';　と言った形になってます。 伝票を任意の作成日付で表示できないといけないのですが、ネットで見てもそこがよく解りません。 where の条件句で、2013年11月15日の伝票を出す、と言った事がしたいです。 これにレストつけてくれた方が居て教えて貰ったのが以下の (1)SUBSTRで必要部分を取り出して検索する SELECT * FROM テーブル名 WHERE SUBSTR(chk_open_date_time,1,10) = '2013-11-15' です。 これを応用して「20131155」で検索する事は可能でしょうか？ WHERE SUBSTR(chk_open_date_time,1,10) となっている部分は左から1つ目から10文字という意味だと思うのですが、 左から1つ目から4文字、左から6つ目から2文字、左から9つ目から2文字　で　20131115で検索が出来るか　と言う事です。 解りにくいかと思いますがどうぞよろしくお願い致します！
こんにちは。 自分はデータベースの初心者です。 仕事で急きょ勉強しなければならなくなりました。 あるデータベーステーブルの中に日付時刻が混じったカラムがあります。 伝票のデータなんですが、伝票が作成された情報が chk_open_date_time というカラムで、実データは '2013-11-15 12:19:31.000';　と言った形になってます。 伝票を任意の作成日付で表示できないといけないのですが、ネットで見てもそこがよく解りません。 where の条件句で、2013年11月15日の伝票を出す、と言った事がしたいです。 どう言った形で行う事が出来ますか？ 他のカラムで日付だけと言うのはありませんでした。 どなたか教えてください！ よろしくお願いします！
no | food_id ---------- *1 | 2 *2 | 3 *4 | 1 ---------- food_id | food -------------- **** 1 | バナナ **** 2 | ラーメン **** 2 | いちご ------------ こんな風にIDの対応表みたいな テーブルを作ったとして 今までfood_idみたいなネーミングをしてたのですが 紛らわしいかなと思って名前を変えたいと思いました。 よくあるパターンだと思うのですが どんな一般的にネーミングが考えられますか？
Access2007を使用して台帳管理を行っています。 その際にレポートをPdf化して電子保存を行っていますが、いちいちメニューからレコード指定しでファイル出力するのが煩雑なのでVBAを勉強して自動化しようと思っています。 実装したい機能はフォーム上に配置されたボタンを押したら、そのIDのレポート（PDFファイル）が指定のフォルダに保存されるものです。 初心者なりにいろいろ調べて下記のコードに行きついたのですがうまくID選択されません（全レコード保存される）。 ご教授お願いします。 Sub Pdf作成() DoCmd.OpenReport "レポート名", acViewPreview, , "ID=" & Me!ID DoCmd.OutputTo acOutputReport, "レポート名", acFormatPDF, "保存path&ファイル名.pdf" End Sub
以下の様なデータが、データベースに入っています。 table 映画データ 映画館　　　　映画名　　　　 日付　　　 メモ ------------------------------------- バルト9 　「タイタニック」　　2013-10-16　　※2000円 バルト9 　「E.T」　　　　　　　2013-10-19　　※子ども向け 渋谷東急　「007」　　　　　　2013-10-17　　※R指定 バルト9 　「タイタニック」　　2013-10-17　　※2000円 渋谷東急　「007」　　　　　　2013-10-18　　※R指定 渋谷東急　「アメリ」　　　　 2013-10-20　　※女性向け バルト9 　「E.T」　　　　　　　2013-10-18　　※子ども向け バルト9 　「タイタニック」　　2013-10-15　　※2000円 渋谷東急　「007」　　　　　　2013-10-19　　※R指定 これを映画館 >映画名 > 日付（初めから終わりまでつなげる）の順番で抜き出したいです。 以下のように。 バルト9 　「タイタニック」　　2013-10-15 - 2013-10-17　　※2000円 バルト9 　「E.T」　　　　　　　2013-10-18 - 2013-10-19　　※子ども向け 渋谷東急　「007」　　　　　　2013-10-17 - 2013-10-19　　※R指定 渋谷東急　「アメリ」　　　　 2013-10-20　　　　　　　　　　　※女性向け このようなSELECT文はどう書けばよいでしょうか。 すみませんがよろしくお願いいたします
id place 5　上野 6　銀座 7　銀座 これに対して SELECT place,count(*) FROM tb GROUP BY place ORDER BY COUNT(*) DESC; でplaceのvalueごとのランキング的なものを作成することはできたのですが id place 5　上野 6　銀座,東京 7　銀座,上野 8　銀座 に対して place COUNT(*) 銀座 3 上野 2 東京 1 という表を表示したいのですが、可能ですか？
5年間くらいの期間で、毎年300万件くらいのデータを統合して管理しようとしております。 こういった時どんなソフトを使うのがいいか教えてください。 「Microsoft SQL Server 2008 Developer Edition」というのが出てきて検索してみましたが、アクセスに比べかなり敷居が高いように思いました。 （アクセスでは2Gは軽く超えます）
Oracleにおいて、三者の違いは何でしょうか。分かりやすく説明して頂けるとありがたいです。
初心者ではございますが、質問失礼いたします。 下記のようなＳＱＬ文を使っています。 例文： SELECT table1.no, table1.titile, table1.date FROM table1 WHERE ( table1.title REGEXP "りんご" || table1.title REGEXP "みかん" || table1.title REGEXP "ばなな" || ......... AND date > '2013-11-11' ORDER BY table1.date DESC table1.titleから、各単語を含むタイトルを全て表示させるもので、 検索する単語は無制限に増える予定です。 現在の文でも結果など特に問題ないのですが、 コードが長くてこれでいいものかと思い探したところ特になかったため、 良い方法をご存知の方がいらっしゃったら・・・という望みで 質問の方させていただきました。 お時間のある際にでもお教えいただければと思います。 もし、上記に変わる表現がない場合は、無いとお教えいただければ助かります。 何卒宜しくお願い致します。
MYSQLを使っています。 【売上テーブル】 ||　日付　||　金額　|| ----------------- ||　2011/01/01　||　100　|| ||　2011/01/01　||　200　|| ||　2011/01/02　||　600　|| 　　　　　　　　　　・ 　　　　　　　　　　・ 　　　　　　　　　　・ ||　2012/12/31　||　500　|| ||　2012/12/31　||　100　|| SELECT　SUM(金額) FROM　売上テーブル WHERE　日付 BETWEEN '2011-01-01' AND '2011-12-31' GROUP BY DATE_FORMAT(日付, '%Y/%m') で月初から月末のデータを表示させることはできますが、 2011/01/10～2011/02/09を一か月として 以降は 2011/02/10～2011/03/09 2011/03/10～2011/04/09 　　　　　　　・ 　　　　　　　・ 　　　　　　　・ 2011/12/10～2012/01/09 といった感じに1年間のデータを表示させる方法がわかりません。 どうぞ宜しくお願いします。
SQLServerでGROUP　BYを使用してデータをSELECTする場合について質問があります。 GROUP　BYを行う項目に’△△1’と’1△’というデータが入っていた場合、 　　※上記の△は半角スペースです。 ’△△1’と’1△’は同じグループとして、グルーピングされるのでしょうか。 Oracleにデータを移行して、GROUP　BYをかけると上記のケースはデータ件数が異なります。 これはSQLServerの仕様なのでしょうか。（バージョンは2000です。） お手数ですが、ご教示願います。　
私は今大学でWEBデータベースの講義を受け、その場で実習形式で学んでいるのですがなかなか理解が追いつかないです。やることはやりますが、理解ができていない状態です。なので、理解を深められるようなサイト、または書籍を探しております。 使用ソフトは、エクリプス、トムキャット、A5M2で使用言語はJAVAです。また、今はWEBデータベースということで、カレンダーを作成しながら学んでいるところです。しかし、一から作るのは時間的にも内容的にもということなのでしょうが、ある程度出来上がったものを使っています。まずは何から講義以外で勉強するべきでしょうか。 話がまとまらないので、まとめますと (1)WEBデータベースにあたって何をどの順番で学んでいくのがよいか (2)それにあたっておすすめの参考書またはサイト この2つを回答としてお願いしたいです。よろしくおねがいします
MySQLの設計について質問があります。 まずDBの設計ですが以下のような場合どのようにすればよいのでしょうか？ 1. 商品情報が数十万件あり、商品DBを作ってその中に全商品を登録するテーブルを作る 2. 各会員が上記の中から自分が扱いたい商品を登録するテーブルが必要 このとき、2.のテーブルは、 　A. 1.のDBの中に作る 　B. 各会員のDBを作ってその中に扱いたい商品のテーブルを作る 　C. 会員DBを作って会員ごとのテーブルを作る のどれが正しいのでしょうか？各会員が扱う商品数も数万～数十万件になります。 どうぞよろしくお願いいたします。
Access2003で作成したテーブルをExcelに出力し、そのファイルをAccessから開き、罫線や列幅等フォーマットを自動的に整え、表示します。表示中にデータ確認し、印刷等の処理を行い、閉じて、またAccessの操作に戻りたいと思います。 この際、アクセスで設定したエクセルのオブジェクト変数をCloseしてしまうと、エクセル画面が閉じられてしまう為、ＡｃｃｅｓｓモジュールでのClose処理を行わないままとなっています。この為か、引き続いて条件を変えてエクセルに出力して、同様の処理を行うと、ＡｃｃｅｓｓモジュールからのＥｘｃｅｌの自動フォーマット化が行われなくなってしまいます。Ａｃｃｅｓｓを再起動すれば、正常に処理できるので、オブジェクト変数のClose未処理が原因と考えています。 このような場合、一般にはどのように処理されているのでしょうか？Excel画面表示後、DoループDoEvents関数で待ち状態とし、ボタン操作でExcel操作の終了を知らせて、オブジェクト変数のClose処理を行えばいいのかと思いますが、一般にはどのように処理されているものなのかご教示下さい。
PCを再起動した際にOracleのサービスが正常に開始していない事があります。 [サービス]で確認するとサービスもリスナーも「開始」状態になっているのですが、DBソフト(ObjectBrowserなど)で接続しようとすると接続エラーになります。 普通のWindowsのパソコンにOracle10gを入れている状態です。 パソコン自体が6～7年ぐらい使っている古い物なので、物理的な不調かもしれませんが・・・ 何かわかる方が居ましたら教えて頂きたいです。
　小規模の会社で、Accessによるデータベースとフロントシステムを作っています。 この度、Access2003から2013へ変更するにあたり、システムを再構築するので、今よりも利用頻度が増えても、快適に動くようにしたいと考えています。 　そこで、データベースにしたAccessからのリンクの仕方と速度に関係があるかの質問です。 　前提条件として、データベースにするAccessはServer上にあり、フロントのAccessはクライアントPCにあります。フロントのPCから、ベースAccessにリンクを張って使用するのですが、多様な業務から、複数のベースAccessが存在し、１つのフロントから、主たるベースAccessのほかに他業務のベースAccessにもリンクを張るようになります。 　このケースで、ベースAccess側で、リンクテーブルを作り、フロントAccessからは、１つの主たるAccessにリンクを張るほうが、フロントの速度が上がるのか、それとも、現在と同じように複数のベースAccessにリンクを張るほうが速度が上がるのか、リンクの張り方が速度に関係することが無いのかを知りたいと思っています。 　ご存知の方いらっしゃいましたら、教えてください。 　よろしくお願いします。
必要に駆られたのでMySQLについて勉強しているのですが、 ファイル読み込みで問題が起こり、詰まってしまっています。 MySQL上で自作したsampledb内にテーブルprefectureを作成し、 そのテーブル内にPrefecture.csvファイル(文字コードshiftJIS)からデータを入力しようと しているのですが、最初の一件しかテーブルに格納されず、他のデータが入らないのです。 以下に入力したクエリ文を掲載します。 create database sampledb　default character set sjis create table Prefecture(PREF_CD INT(3),PREF_NAME VARCHAR(10),PRIMARY KEY(PREF_CD)) LOAD DATA INFILE "Prefecture.csv" -> INTO TABLE Prefecture FIELDS TERMINATED BY"," -> LINES TERMINATED BY"\r\n"; Query OK, 1 row affected, 1 warning (0.08 sec) Records: 1 Deleted: 0 Skipped: 0 Warnings: 1 select * from prefecture +---------+-----------+ | PREF_CD | PREF_NAME | +---------+-----------+ | 　　　　　 1 | 北海道 2 | +---------+-----------+ 1 row in set (0.00 sec) Prefecture.csvについてはこちらのサイト仕様上添付できませんでしたが、 1,北海道 2,青森県 3,岩手県 . . .（以下省略） のように、47都道府県の番号と地名を並べたものです。 独力では解決法を見出せません。 どうかご助力お願いします。
標記の件なのですが弊社ではデ－タ－ベ－スにＳＱＬを使用しております。 今は新しい販売管理システム構築に向けて複数のソフト開発会社様と話し をしておりだいたい概算の見積りが出揃いまして、基本的にはACCESS+SQLServer でとなっているのですが１社だけ極端に安い見積りがあるなって思ったら 無料版のexpressになっておりました。 零細企業でサ－バー１台にクライアントＰＣが８台だけの構成なのですが 無料版でも大丈夫な物でしょうか？勿論無料版には容量の制限等あるのは 存じております。また、販売管理システムですので大きなファイルは無いとは 思いますのでそれで無料版を使用しようとされているではないかと思っており ます。 是非、皆様にアドバイスをして頂きたく質問させて頂きました。 宜しくお願い致します。
初歩的な質問で申し訳ありません。 以下のような３つのテーブルを結合する際に、ある１つのテーブルの内容を全て 表示したまま、その他のテーブルの内容を付加するような出力をしたいと考えています。 考え方としては、内部結合という事で、INNER JOIN を使うというような事は想像できますが、 ３つのテーブルではそのような事が可能でしょうか？ 最終的には出力想定イメージのような形としたいと考えています。 [口座] 銀行No 顧客No 残高 ------------------- B001 C001 30000 B001 C003 10000 B002 C001 40000 B002 C002 10000 B002 C004 50000 B003 C004 60000 [銀行] 銀行No 銀行名 --------------- B001 foo銀行 B002 bar銀行 [顧客] 顧客No 顧客名 -------------- C001 阿部 C002 村上 C003 渡辺 C004 越智 【出力想定イメージ】 銀行No 銀行名 顧客No 顧客名 残高 ------------------- B001 foo銀行 C001 安部 30000 B001 foo銀行 C003 渡辺 10000 B002 bar銀行 C001 安部 40000 B002 bar銀行 C002 村上 10000 B002 bar銀行 C004 越智 50000 B003 C004 越智 60000 ※ 口座情報に対し、銀行情報や顧客情報がないケースも存在します。 教えて下さい。 よろしくお願いします。
すみません、教えてください(><) mac（ os X 10.7.5）でMAMP+Eclipse+PHPを使って以下のようにMySQLにデータ挿入 mysql_connect('localhost','root','root') or die(mysql_error()); mysql_select_db('mymy'); mysql_query('SET NAMES UTF-8'); mysql_query('INSERT INTO item SET id=1, name="あいうえお"'); をしたのですが、 phpMyadminからデータを確認してみると日本語が文字化けしてしまいます。 （phpMyadminからデータを挿入した場合はちゃんと表示されます。） 色々と調べ、 Eclipseの環境設定でワークスペースの文字コードやphpの文字コードをUTF-8にしたり、 MySQLのmy.cnfファイルの中に以下 [client] default-character-set = utf8 [mysqld] skip-character-set-client-handshake default-character-set = utf8 character-set-server = utf8 collation-server = utf8_unicode_ci init-connect = SET NAMES utf8 [mysqldump] default-character-set = utf8 [mysql] default-character-set = utf8 を追加して再起動し、DBを一旦削除して再度作り直して挿入してみたりとやったのですが、改善されません。 サーバ接続の照合順序 は「utf8_general_ci」として作成しています。 コンソールからMySQLへ接続してDBの文字コードを確認してみると character_set_client | utf8 | | character_set_connection | utf8 | | character_set_database | utf8 | | character_set_filesystem | binary | | character_set_results | utf8 | | character_set_server | latin1 | | character_set_system | utf8 | | character_sets_dir | /Applications/MAMP/Library/share/charsets/ | というかたちになっています。 他にどういった点を改善すればいいのでしょうか？ もうお手上げ状態でどうすることも出来ずにいます。。。
先日、バックアップが戻せないと質問させていただいたものです。 今回新たにデータベースを作って、試しにバックアップをやってみたのですが、何故か*.bakと*.trnのファイルが出来ません。その代り、拡張子無しのデータベース名ファイルが一つ出来ております。 手順は、オブジェクトエクスプローラーで当該データベースを右クリックして、「タスク」→「バックアップ」を選び、完全バックアップ、デフォルトのBackUpディレクトリの指定を削除して、デバイス→USBメモリのファイル名指定(新規)、有効期限0日、にて行いました。 何かを決定的に理解していないのだと思いますが、分かりません。 なぜ、うまくいかないのか、お教えいただけないでしょうか？ ひょっとして、EXPRESSではダメという事があるのでしょうか？
すいません。PHPを初めて勉強して実際にプログラムを作ってみたのですが、 その際データベースについて少し疑問があります。（初めてデータベースやPHPに触るので おかしな質問だったらすみません） 私は自分で撮った写真等を自分のウェブサイトに掲載したいと考えています。 データベースも同時に勉強し、とりあえずウェブサイトの形はできました。またデータベースに 入れるフィールドが8個あります（フィールドというのかカラム名というのかよくわかりませんが・・） さらに写真が2000枚くらいありますのでかなりの量となります。 （写真は今後もっと増えます） 例 写真のファイル名、カメラの種類、日付、季節、場所、カメラの設定、コメント、評価 これを季節や日付、場所など絞込、並び替えなどを訪問者が自由に できるようにしたいと考えています（フォームボタンを設置してラジオボタンなどで 並び替えをするサイトです。並び変えはデータベースで行いループで全てphpで表示します） ただそれに加え、画像の横に以下のような説明欄を設けデータベースから表示させるつもりです。 日付　2013-1-1 場所　海 カメラの種類　*** カメラの設定　*** コメント　********** 例えば　日付なら"日付$ggg"みたいな事になります。つまり以下のようにします。これが一番 更新が楽なのでそうしたいです。ただこの場合だと当たり前ですが5つのフィールドから5つの データを取り出す事になりますし、さらに何千枚もの写真の並び替えも同時に行う事になります。 （並び替えのプログラムなどは省略してあります） $pdo = new PDO("mysql:dbname=*****", "root"); $pdo->query("set names utf8;"); // $st = $pdo->query("SELECT * FROM ******************"); while ($row = $st->fetch()) { $ggg = ($row['日付']); 日付　$ggg 場所　$aaa カメラの種類　$bbb カメラの設定　$ccc コメント　$ddd 表示は1ページに200枚ぐらいと考えていますが、このような事はレンタルサーバーで可能なので しょうか？パソコンの事はあまり詳しくないのですが、普通に考えれば処理できそうにないような 気がしますがどうでしょうか・・。
お世話になります。 ユーザからの操作ではなく、一定時間(今回は1秒)ごとに値を 自動で加算していくようなシステムを作りたいと考えています。 単純に言いますと、一つのフィールドの数が、一秒ごとに 自動で1ずつカウントアップされていくような仕組みです。 このようなことは、可能なのでしょうか。できるとするならば、 詳細を教えてください。 また、SQLiteなどでも可能なら、その方法もお願いします。 現在の環境は、xampp1.7.4、Windows7,MySQLです。 よろしくお願いいたします。 初心者ですみません。
いつもお世話になっております。 datapumpの実行方法（expdp/impdp）について、ご存知の方がいらっしゃいましたら、ご教授の程お願い致します。 ------------------------------ ●環境 　Oracle 11g (11.2.0.3) 以下の手順で、エクスポート/インポート テストを行ったのですが、 expdpで"tables"を指定するとエラーとなり実行できませんでした。 full=y（データベース全体）は動きました。 tablesで指定するものは、"CREATE TABLE"で作成したテーブル名ではないのでしょうか。 また、テーブルスペースを削除"drop tablespace tbl01"したのですが、 expdpでデータベース全体をエクスポートしたものから、impdpしても 削除したものが戻せませんでした。 impdpのコマンドに誤りがあるのでしょうか。 ●expdp実行 ----- ・tablespace作成 $ sqlplus / as sysdba SQL> create tablespace tbl01 datafile '+data/testdb/datafile/tblsp1' size 10m autoextend off; ----- ・sequence作成 SQL> create sequence seq1; ----- ・TABLE作成 SQL> CREATE TABLE TEST_TBL(USER_ID VARCHAR2(8) NOT NULL, DEPT_NO VARCHAR2(8))　tablespace tbl01; ----- ・INSERT実行（5件分） begin for i in 1..5 loop INSERT INTO TEST_TBL (USER_ID, DEPT_NO) VALUES (seq1.nextval, '1234') ; commit; end loop; end; / ----- ・expdp使用する為の準備 ディレクトリの作成と read/write 権限の付与 $ sqlplus / as sysdba SQL> create directory expdp_dir as '/u01/tpump'; SQL> grant read,write on directory expdp_dir to system; ----- ・expdb実行 $ expdp system/pass dumpfile=TEST_DIR:expdp_all.dmp logfile= TEST_DIR:expdp_all.log full=y ＝＝＝＝＝ "SYSTEM"."SYS_EXPORT_FULL_01"を起動しています: system/******** dumpfile=TEST_DIR:expdp_all.dmp logfile= full=y BLOCKSメソッドを使用して見積り中です... オブジェクト型DATABASE_EXPORT/SCHEMA/TABLE/TABLE_DATAの処理中です -中略- SYSTEM.SYS_EXPORT_FULL_01に設定されたダンプ・ファイルは次のとおりです: /u01/tpump/expdp_all.dmp ジョブ"SYSTEM"."SYS_EXPORT_FULL_01"が11:31:19で正常に完了しました ＝＝＝＝＝ $ expdp system/pass tables=TEST_TBL dumpfile=TEST_DIR:expdp_tbl.dmp logfile= TEST_DIR:expdp_tbl.log ＝＝＝＝＝ "SYSTEM"."SYS_EXPORT_TABLE_01"を起動しています: system/******** tables=TEST_TBL dumpfile=TEST_DIR:expdp_tbl.dmp logfile= BLOCKSメソッドを使用して見積り中です... BLOCKSメソッドを使用した見積り合計: 0 KB ORA-39166: オブジェクトSYSTEM.TEST_TBLが見つかりません。 ORA-31655: ジョブに対してデータまたはメタデータ・オブジェクトが選択されていません ジョブ"SYSTEM"."SYS_EXPORT_TABLE_01"が完了しましたが、2エラーが11:33:54で発生しています ＝＝＝＝＝ ●impdp実行 $ impdp system/pass dumpfile=TEST_DIR:expdp_all.dmp logfile= TEST_DIR:impdp_all.log ＝＝＝＝＝ マスター表"SYSTEM"."SYS_IMPORT_FULL_01"は正常にロード/アンロードされました "SYSTEM"."SYS_IMPORT_FULL_01"を起動しています: system/******** dumpfile=expdp_dir:expdp_all.dmp logfile= full=y オブジェクト型DATABASE_EXPORT/TABLESPACEの処理中です ORA-31684: オブジェクト型TABLESPACE:"UNDOTBS1"はすでに存在します ORA-31684: オブジェクト型TABLESPACE:"TEMP"はすでに存在します ORA-31684: オブジェクト型TABLESPACE:"USERS"はすでに存在します ORA-39083: オブジェクト型TABLESPACEの作成が次のエラーで失敗しました: ORA-01119: データベース・ファイル'+DATA/testdb/datafile/tblsp1'の作成中にエラーが発生しました。 ORA-17502: ksfdcre:4 ファイル+DATA/testdb/datafile/tblsp1の作成に失敗しました ORA-15005: name "testdb/datafile/tblsp1" is already used by an existing alias -中略- ※以下のORAエラーが多数発生 例：ORA-31684: オブジェクト型TABLESPACE:"UNDOTBS1"はすでに存在します 例：ORA-39151: 表"SYSTEM"."REPCAT$_PRIORITY_GROUP"が存在します。スキップのtable_exists_actionのため、すべての依存メタデータおよびデータはスキップされます 例：ORA-39111: 依存オブジェクト型OBJECT_GRANT:"SYSTEM"はスキップされ、ベース・オブジェクト型VIEW:"SYSTEM"."SCHEDULER_PROGRAM_ARGS"はすでに存在します -中略- オブジェクト型DATABASE_EXPORT/SCHEMA/TABLE/CONSTRAINT/REF_CONSTRAINTの処理中です オブジェクト型DATABASE_EXPORT/SCHEMA/TABLE/STATISTICS/TABLE_STATISTICSの処理中です オブジェクト型DATABASE_EXPORT/SCHEMA/TABLE/POST_TABLE_ACTIONの処理中です オブジェクト型DATABASE_EXPORT/SCHEMA/TABLE/TRIGGERの処理中です オブジェクト型DATABASE_EXPORT/SCHEMA/POST_SCHEMA/PROCACT_SCHEMAの処理中です オブジェクト型DATABASE_EXPORT/AUDITの処理中です ジョブ"SYSTEM"."SYS_IMPORT_FULL_01"が完了しましたが、146エラーが20:14:48で発生しています ＝＝＝＝＝
http://okwave.jp/qa/q8328454.html にて解決済みとしてしまいましたが、問題がありました。 クロス結合になってしまい、重複した結果が出力されてしまいます。 1個の結果だと1個の出力ですが、2個の結果だと4個の出力となってしまい、2乗できいてきてしまいます。 ご教示のほど、よろしくお願いいたします。 ---------------------------------------------------------------- 下記SQL文と同一の結果を出力しつつ、高速化は可能ですか？ ARCHIVE_SAMPLEとARCHIVE_ORDERが大きくなると著しくパフォーマンスが下がります。 ARCHIVE_ORDERにて検索をかけた結果のArchiveIDとOrder_SampleIDが一致するARCHIVE_SAMPLEを出力したいです。 データサイズとしては、ARCHIVE_ORDER<<ARCHIVE_SAMPLEなので、ORDER側で検索しています。 SELECT * FROM ARCHIVE_SAMPLE M WHERE M.ArchiveID IN (SELECT ArchiveID FROM ARCHIVE_ORDER WHERE UPPER(Order_PatientID) LIKE UPPER('%234%')) AND M.Order_SampleID IN (SELECT Order_SampleID FROM ARCHIVE_ORDER WHERE UPPER(Order_PatientID) LIKE UPPER('%234%')) ----------------------------------------------------------------
リモートホストのpostgresqlにwindows7ホストからつなぐために、windowsホストにphpPgAdminをインストールしようとしています。 windowsホストにはpostgresql, phpなどをインストールしていません。 windows側でサーバーソフトを動かす予定はありません。 多くの解説サイトではpostgresqlサーバーにphpPgAdminを導入するのを前提としているようでよくわからないのですが、この場合、phpPgAdminのみを単独でインストールすればよいでしょうか、あるいは、先立ってphpなどインストールしておく必要があるのでしょうか？ 2013年11月1日
MySQLでデータベースを作成して、データベース認証させてコンテンツを表示するプログラムを書いているのですが、パスワードやユーザー名をルートディレクトリの外に置いてrequire_onceする意味が今ひとつわからないので教えて下さい。 require_once('../../../DBparameter.php');　//　DBparameter.phpの中にパスワードやユーザー名 として、ルートディレクトリの外にDBparameter.phpを置けば確かに、パスワードやユーザー名を見ることはできませんが、このプログラムが存在するフォルダ内をのぞけるぐらいの詳しい人であれば、このプログラムを見るのは簡単にできると思うんですが、そうすると、 $con = mysql_connect(host, username, password); などとしてデータベースを開き、結局はデータベース内の情報を抜かれてしまうような気がするのですが、どうなんでしょうか？ 確かに、データを抜き取るためのプログラムを他人のドメインにアップロードするのは簡単ではないので、ほとんど無理だとは思うんですが、それならばスクリプト内にパスワードやユーザー名をそのまま書いてもいいのではないかという気がするんです。
CDをFLAC形式でパソコンに保存してパソコンから音楽を再生して楽しんでいます。 そこで、 結構な量のFLACファイルが溜まってきたので、音楽のデータを アーティスト、アルバム、楽曲、年、という具合に、 データベースを作ろうと思っています。 具体的な方法は全然決まっていません。 EXCEL.で手打ちは面倒だなーくらいしか考えておりません。 なにか、FLACのタグデータを生かす方向で、 データベースを楽に作れないですかね？ 良い案お待ちしております。方法は問いません。
01234561 の中に 1 は何個ありますか？ 期待値 2 という文字列に対する関数があったはずなのですが、調べても出てきません。 ご存知の方いらっしゃいましたらお願いします。
SQLで、UPDATE文を使って行を交換したいのですが、例えばこのようなテーブルがあった時 No Name Qty -- ----- ----- 1 　皿 10 2　 串 20 3　 本 30 No1とNo2のQtyを入れ替えたいとき、Tmpのような所に一旦退避させて交換するような 方法以外で、入れ替える方法はありますか？
SQL Server2012 Expressで作成したデータベースをＵＳＢメモリにバックアップしました。 最近、マシントラブルでドライブが死んだので、ＳＱＬ Serverも入れ直し、データベースをリストアしようとしましたが、うまくできません。 具体的には、データベースを右クリックして「タスク」→「復元」→「データベース」として、デバイスを選ぼうとすると、バックアップファイルの拡張子がbakとtrnとなっており、USBメモリに記録されているmdfとｌｄｆではありません。 すべてのファイルを表示させ、それらを選択しても、データベースの復元ダイアログのOKボタンがグレーアウトのままです。 「タスク」→「復元」→「ファイルおよびファイルグループ」なのかな？と思って、やってみてもやはり、拡張子が違います。 同じようにmdfとldfを選択してみると、 「デバイス'データベース名.mdf'のメディアファミリが正しい形式ではありません」 「RESTORE HEADERONLYが異常終了しています。(エラー：3241)」 とのダイアログが出て復元できません。 私はバックアップを失敗したのでしょうか？ 何とか、一部のデータでも復元できないでしょうか？ よろしくお願いいたします。
現在オラクルマスターブロンズの勉強をしています。 SQLを効率よく理解するため実機で動かしたく、黒本に付属しているDVDROMをインストールしようとしたのですが、11ｇデータベースのインストールがうまくいきません。 警告を無視して無理やりインストールを開始するとデータベース構築の時に容量不足でフリーズしてしまいます。 問題はTempファイルの容量不足と警告がでます。 必要はディスク領域は400MBに対して私のPCは264MBしかありません。 現状試したこと↓↓ ・Tempファイルの余分なファイルを全て削除⇒効果なし ・Tempファイルの容量拡大⇒効果なし ・Cドライブの容量確保⇒30GBの容量があるため、特に問題ない気がする。 ネットでも調べましたが、これ以上の解決策が浮かびません… 完全に白旗を振っている状況です。 OSはWINDOWS　VISTAです。 オラクルに詳しい方、是非ご協力お願いします。 また最悪オラクルDBがインストールができない場合、SQLプラスを使用できる環境もしくは策は何かありますでしょうか？ 宜しくお願いします。
お世話になります。 Access2000で作成しています。 テーブル作成クエリと同じような形で、 ユニオンクエリの結果をテーブルに書き出したいのですが、 どのようにすればできるでしょうか？ SQLの形を直接いじるような方法でも結構ですので 宜しくお願い致します。
データベースについて詳しい方にお聞きしたい事があります。 初心者なので書いている内容におかしな点もあるかと思いますが、よろしくお願いします。 5年ほど前のJavaを習っていて、簡単なデータベースを作ったことはあります。 □現在、会社が違うレンタルサーバーを一つずつ借りています。 A社のサーバー上で作成したデータベースをB社のサーバー上に公開しているサイトから呼び出し、テーブルを一覧表示できるのでしょうか？ □初心者がデータベースを作成するにはphpMyAdminを使用するのが一番良いでしょうか？ 使い方を検索してみたらちょっと難しそうですね。 Javaでデータベースの勉強をしていた時はあらかじめ作ったフォームにデータを入力していくだけだったので、同じような感じのシステムはないかなと思いました。 □現在使用しているサーバーはMySQLが5つ使えると書いています。 既にWordPressでブログ開設していて4つ使用しています。残りは一つ。 野球チームのデータベースを作成しようと思っているのですが、これまでの試合の記録のデータ、これまでの選手のデータのデータベースを作成したいと思っています。 MySQLは残り一つですが、この二つのデータベースを作る事は可能なのでしょうか？二つ必要ですか？ □スマホのサイトも作成しているんですが、PCサイトと同様にデータベースに接続し、一覧表示できるのでしょうか？ スマホでPHPが使えるのかなと思ったので。 ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
よく質問や回答に画像が張り付けてありますが、 その画像のソースなどから、画像を取り込んだサイト を割り出す事は出来ますか？
データベースとしては基本的な話になると思いますが、ご返答よろしくお願いいたします。 例えば日本人の名前はどう考えてもせいぜい漢字10文字で収まるため、名前を入力するためのDB定義は、nvarchar(20)などと少し大きめに設定すると思います。私もこれまでは当たり前のようにそうしてきました。 しかし、nvarchar型の最大サイズは4000なので、全ての項目でnvarchar(4000)としてしまえばいいような気がするのですが……誰もしてないところを見るとやはり何か問題があるのでしょうか？それはどんな問題なのでしょうか？
お世話になります。 これまで、社内ネットワークで SQL Server + Access ADPでプログラムを作成していましたが、データだけをレンタルサーバなどに移行し、インターネット経由でデスクトップのPCとやり取りするにはどうしたらいいのでしょうか。（クライアントは、ASP.NETなどを経由してWEBブラウザを利用するのではなく、直接AccessやVBで通信して利用したいと考えています） サーバの設定や接続文字列の書き方など、必要な情報（必要な資料がのっているサイトなど）をご教示いただければ助かります。 よろしくお願いいたします。
プログラム初心者です phpとmysqlで簡単な掲示板を作りました カラムは sure、title、text、time、name selectで同じスレ名をselectします それで取得できたのがこんなかんじになります スレ名(sure) タイトル(title) テキスト(text) 書き込まれた時間(time) 書き込んだ人の名前(name) タイトル(title) テキスト(text) 書き込まれた時間(time) 書き込んだ人の名前(name) このレス一覧に番号を振る方法を教えてください こんな感じにしたいです NO2 タイトル(title) テキスト(text) 書き込まれた時間(time) 書き込んだ人の名前(name) NO1 タイトル(title) テキスト(text) 書き込まれた時間(time) 書き込んだ人の名前(name) よろしくお願いします
・MySQLのGREATESTで、引数のどれかが NULL である場合、NULLを戻さず、それ以外の残りから ( 最大値の ) 引数を戻すことは可能でしょうか？ ・また、GREATEST以外で、同じような処理をするにはどうすれば良いでしょうか？ ・後、MAXとは何が違うのでしょうか？ ■最終的にやりたいこと ・「aカラム」と「NULLを含むbカラム」の最大値基準で、降順表示したい
Excelファイルの１シートのデータをFilemakerの１レコードに入れ直したいのです。 OS：Windows7 アプリ：Excel2010→FilemakerPro8.5 目的： Excelデータはシート単位で今後も継続して増えていきます。これを都度ファイルメーカー（以後FMと略）にインポートしたいです。 ※都度都度のインポートになるのでもっと手間のかからない良い方法があればいいのですが。 状況： 請求書フォームの状態からCSV出力しているせいか、インポートしてもデータがバラバラに入ってしまいます。 常に増えていくExcelシートをいかに無駄なくFMにできるか悩んでおります。 どうぞお知恵をお貸しください。
■前提 ・MySQLの同じテーブル内に、datetime型の「aカラム」「bカラム」がある ■質問 ・この時、bカラムがNULLだったら、aカラムの値をbカラムへコピーするSQL文を教えてください
お世話になります。 Access2000で作成しております。 下記のテーブルAがあります。 名前1とタイム1,名前2とタイム2をセットにして、 Bの形で表示したいのですが、 どのようにすればできるでしょうか？ 表現が下手で申し訳ないのですが、 テーブルを作るのではなく、既に存在しているテーブルAの 情報を「参照」して、Bの形で表記したいのです。 可能でしたら、「クエリ」で、説明難しければ「SQL」で 教えていただければと思います。 ※SQLの場合は、クエリに変換して使用します。 ----テーブルA---- 番号　名前1 名前2　名前3 タイム1 タイム2　タイム3 1 山田　田中　　佐藤　10 8 9 2 鈴木　木村　　戸田　7　 8 9 ----B------ 名前　タイム 山田　10 田中 　8 佐藤　9 鈴木　7 ・ ・ -------------------- お手数ですがよろしくお願いいたします。
お世話になります。 Access2000で作成しております。 下記のテーブルAがあります。 名前1とタイム1,名前2とタイム2をセットにして、 テーブルBを作成したいのですが、 どのようにすれば作成できるでしょうか？ 可能でしたら、「クエリ」で、説明難しければ「SQL」で 教えていただければと思います。 ※SQLの場合は、クエリに変換して使用します。 ----テーブルA---- 番号　名前1 名前2　名前3 タイム1 タイム2　タイム3 1 山田　田中　　佐藤　10 8 9 2 鈴木　木村　　戸田　7　 8 9 ----テーブルB------ 名前　タイム 山田　10 田中 　8 佐藤　9 鈴木　7 ・ ・ -------------------- お手数ですがよろしくお願いいたします。
大学生の者です。 論文を書くにあたり、総務省の統計局が公表しているデータを下記サイト＜http://www.e-stat.go.jp/SG1/chiiki/ToukeiDataSel … よりダウンロードしようと思っているのですが、項目が多いうえ、 一度に25項目しか選択できないので すべてをダウンロードするのに時間がかかっていて困っています。 効率よくすべてのデータをダウンロードする方法はないでしょうか。 現在、「安全」分野の都道府県別データをダウンロードしているのですが、 この分野だけでも相当時間がかかっています。 効率の良い方法をご存知の方がいましたら、教えていただけると助かります。 よろしくお願いいたします。
以下のSQLにおいて、表Cに存在するすべてのレコードを表示したいのですが、 表Aと表Cに存在するものしか表示されません。 表Cをメインとし、表示させる方法はありますでしょうか？ select A.FITEMNO from A , B , B B2 , C where C.FCHILDITEMNO = A.FITEMNO(+) and C.FPARENTITEMNO = B2.FITEMNO and A.FITEMNO = B.FITEMNO and B.FITEMTYP = 'P' and (B2.FITEMNO = '123456789')
SQL初心者です 関連テーブルのレコード数を取得したいのですがうまくいきません テーブル名：user user_id,user_name 1,aaa 2,bbb 3,ccc テーブル名：user_agreements user_id,money 1,5000 2,3000 2,5000 1,8000 2,4500 3,10000 3,2500 上記のようなデータがあった場合に、ユーザーIDと契約件数という結果を得たいと思っています user_id,sum_agreements 1,2 2,3 3,2 このような結果を得る為のSQL文はどのように書けば宜しいでしょうか 宜しくお願い致します
ある条件に一致した部分だけ一括更新する、という処理をSQLで行いたいのですが、なにぶん初心者なもので要領をえません。どなたか知恵を授けていただけないでしょうか。 やりたいことなのですが、下のようにAテーブルがあって、その中に文字列型(8)のnumStrフィールドがあるとします。このフィールドに入っている値は「4桁の半角数字」か「6桁の半角数字」、あるいは「未記入状態」しかありません。もしこのnumStrフィールドが未記入ではないとき、値が6桁ならリーディング・ゼロ（桁合わせのための頭ゼロ）を2つ、値が4桁ならリーディング・ゼロを4つ追加したいというものです。 データベースはInterbaseを使用していますが、それ以外のデータベースのやり方でも構いません。ヒントだけでも結構です。 その他条件： (1) numStrとusrNameともに未記入状態が許可されていて、空欄である可能性があります (2) しかし運用上、numStrとusrNameの両方が空欄になることはありません (3) numStrとusrNameはユニークな値ではないため、二つのフィールド値がまったく同じレコードが存在する可能性があります (4)プライマリキーやIDのようなユニーク値のフィールドは設定されていません 説明が足りないところや不明な点はご指摘ください。 よろしくお願いします。 Table A構造: numStr文字列（最大8文字） usrName文字列（最大50文字） 現在numStrに格納されている値: 123456 0002 (未記入) 023493 000238 (未記入) 9876 更新によって書き直された値: （リーディング・ゼロ追加済） 00123456 00000002 (未記入) 00023493 00000238 (未記入) 00009876
顧客ごとにテーブルを作る香ばしいプログラムのSQL文を書くことになりました。 user_0001 user_0002 user_0003 user_0004 user_0005 といった具合にどんどん増えていきます。 カラムは仮に id, name, tel が入っているとします。 プログラムの修正は行えません。 通常JOIN句でテーブルの結合を行うと思うのですが、「user_」という文字列を含んでいるテーブルを全て結合せよ！みたいな命令文はSQLで書けるのでしょうか？ 無理、無駄、素直にプログラムで出せ、というアドバイスでも構いませんのでよろしくお願いします。
桐9-2012からODBC接続でサーバーにあるEXCELデータを読み込ませたいと考えていますが、うまくいかず、原因が分からずに困っております。 お手数をおかけしますがご教示頂けますようお願い致します。 【環境】 パソコン環境 Microsoft Windows 7(x64) 桐9-2012(http://www.kthree.co.jp/kiri/) Microsoft Office2010 Professional ウイルス対策ソフト未インストール、Windowsファイアウォール無効 IPアドレス：192.168.1.10/24 サーバー環境 Microsoft Windows Server2008R2 Microsoft Office2010 Professional ウイルス対策ソフト未インストール、Windowsファイアウォール無効 IPアドレス：192.168.1.20/24 【状況】 1.パソコンにインストールされている桐からサーバーの共有フォルダにあるEXCELデータをクロス・エクセル機能で読み込むことはできる。 2.パソコンにインストールされている桐の外部DBを使用してサーバーの共有フォルダにあるEXCELデータを読み込もうとすると下記のエラーが表示される。(ODBC64ビット版） ------------------------------------------------------------------------------------------------------------------------------- KD1672:ODBCエラー データソース固有エラーコード：0 SQLSTATE:IM014 [Microsoft][ODBC Driver Manager]指定されたDSNには、ドライバーとアプリケーションとのアーキーテクチャーの不一致が含まれています。 ------------------------------------------------------------------------------------------------------------------------------- 3.パソコンにインストールされている桐の外部DBを使用してサーバーの共有フォルダにあるEXCELデータを読み込もうとするとエラーは表示されないがEXCELが読み込めない。(ODBC32ビット版）
　ある教本でPHPを勉強中です。 私のパソコンは普通の現代版Wiedowsパソコンですがそのパソコンに、 　XAMPPをインストールして、MySQLを構築しました。 最初は手探り状態でスタートして、やっと教本の半ばを過ぎました。 　現在、６章を勉強中です。 その６章はMｙSQL（RDB）の、最初に「Webアプリケーションの標準構成」の図がありました。 　図を言葉で表すと 　「各端末 ⇒ Webサーバ ⇔ PHP ⇔ MySQL」 　となります。 　その図を、客観的に見た場合、 Webサーバ ⇔ PHP ⇔ MySQLと別々に書かれているので、 　　３台のパソコンで構築されているように見れます。 　たぶん間違いはないと思うのですが、XAMPPは、「Webサーバ ⇔ PHP ⇔ MySQL」を一台の パソコンで構築できるとの認識で間違いないでしょうか！？ 　教本は「基礎から学ぶ」とは書いてありますが、ページ制限も有るだろうから、詳しくは、解説がありません！？ 　以上よろしくお願いします。 　
お世話になります。 下のようなテーブルでデータのメンテナンスを行いたいのですが、update,deleteを効率良く行う方法はありますでしょうか？ No カラムA　カラムB　カラムC　カラムD　 ---------------------------------------- 1 aaa 111 あああ 2 aaa 222 いいい 123 3 aaa 333 ううう 4 aaa 444 えええ 5 aaa 555 おおお 456 6 bbb 222 いいい 7 bbb 333 ううう 8 bbb 555 おおお カラムAが「aaa」のレコードと「bbb」のレコードがあり、カラムB,Cは一部のレコードが重複しています。 この状態から、 ・No2のカラムDをNo6のカラムDにセット ・No5のカラムDをNo8のカラムDにセット ・No2,3,5のレコードを削除 したいのです。 ※カラムB,Cが重複している場合、カラムAが「bbb」のレコードにカラムDの値を反映し、カラムAが「AAA」のレコードは削除したいです。 update,delete共に効率良く行う方法があれば、助かります。 初歩的な質問かも知れませんが、御教示いただけますと幸いです。 よろしくお願い致します。
PHPとMySqlを勉強し始めたものです。 超初心者ですが、よろしくお願いします。 ＠PAGES（http://atpages.jp/）というサイトを使っています。 ネットで見つけたサンプルプログラムを使って、データベース（MySql）へのデータの入力と読み出しをやってみたのですが、半角英数字なら、読み込みや書き出しはできるのですが、日本語の文字であれば、空白になってしまいます。 プログラムを調べてみると、PHPでのデータベースへの書き込みのときは、ちゃんと日本語の文字を書き出そうとしているようなのですが、「phpMyAdmin」というサイトで書き込まれた情報を見てみると、空白なので、データベース側がデータの受け取りを拒絶したようにも思われます。 サイトで検索して、HTMLの<HEAD></HEAD>のところに下記のような行を入れたり、 <meta http-equiv="Content-Type" content="text/html; charset=euc-jp"> 『mysql_query("SET NAMES 'utf8'"); 』という行をデータの書き込み行の前に入れたりしても、変わりませんでした。 どのようにすれば、日本語もデータベースで扱えるようになるのか教えてください。 よろしくお願いします。
１、to_char関数は、insertのinto内でも使えますか？ ２、oracle、access2010で insert table into (to_char(sysdate, 'yymmdd'), ......); と実行しましたが、「未定義の関数to_charがあります」と出てしまいます… 解決方法について、教えてください。 よろしくお願いします。
お世話になります。 Access2000のマクロコマンドで データベース最適化をしたいのですが、 「マクロまたはVisual Basicコードの実行中に、開いているデータベースを最適化することはできません。」とういうエラーメッセージが出て最適化できませんでした。 マクロの一連の流れの「最後」で、データベース最適化をしたいと 思っていますが、具体的にどのようにすればよいのでしょうか？ 最適化をVBAなどでするのではなく、 　マクロのコマンド：データベースの最適化 でしたいと思っております。 過去の質問で、mdb自身が開いているので絶対に無理！！ と言われたのですが、いまいち信じられません。 ・私が求める回答は、VBA・プロシージャは使用しない ・マクロコマンドのデータベースの最適化を使用 ・マクロの流れの一部で実行 ・具体的手順を記載できる人のみ回答をお願いします。 何度か同様の投稿をしましたので、ユーザーから迷惑!と言われていますので 　もうこれ以上同様の投稿はしたくありません。 この質問が迷惑と思われている方は、回答しなければ 　これ以上質問はしませんので、無視お願いします。 ひつこいですが、 ・マクロコマンド：最適化を使用した具体的手順を記載できる人のみ回答をお願いします。 宜しくお願いします。
頭の整理ができないので技術的なこともさることながら、SQL構築の考え方もうかがいたいのですが、 以下のテーブルに対して、スペース区切りで複数キーワードをAND条件で結ぶとして ID　MyCol1　MyCol2 -------------------------- 1　いちご　みかんジュース 2　ぶどう　いちごみるく 3　みかん　すいかジュース 4　すいか　めろんソーダ 5　めろん　ぶどうガム 検索フォームに「いちご　ソーダ（※スペース区切り）」と入れたら、IDの1、2、4がマッチするようにしたいです。 スペース区切りで複数キーワードをAND条件で結ぶSQLは、以前教わりました。 http://oshiete.goo.ne.jp/qa/1212708.html $sql = 'select * from t_url'; if ($title != '') { $titles = array(); foreach (preg_split('/(\s|　)+/', $title) as $word) { array_push($titles, "MyCol1 like '%$word%'"); } $sql .= ' where (' . implode(' and ', $titles) . ')'; } 今回の質問は、受け取った$titleを「MyCol1」だけでなく「MyCol1かMyCol2」にも同じ照会する方法をうかがいたいです。 検索キーワードが「いちご　ソーダ」だったとき、MyCol1だけなら、 and (MyCol1 like '%いちご%' and MyCol2 like '%ソーダ%') でよいわけですが、MyCol2はどう熱かったらいいのでしょうか。 and (MyCol1 or MyCol2 like '%いちご%' and MyCol1 or MyCol2 like '%ソーダ%') みたいにできればよいのでしょうが。 PHPのコードも、上記のものだとMyCol1にしか照会がかかりませんが・・・
SQLのみで以下の様なことをしたいのですが、やり方が分かりません。 何かしら手法をお知りの方はご教授願いたく存じます。 ▼Postgresバージョン 8.1 ▼テーブル情報 id, numbers 1, '0,20,10,30,50' 2, '10,20,30,50,60' ↓ numbers の値をカンマ（ , ）で分解し、加算したい。 例） 　'0,20,10,30,50'　→　0 + 20 + 10 + 30 + 50 → INTEGERの 110 を取得 ※regexp_split_to_table の関数は、postgresのバージョンが古いために使用できませんでした。 postgresのバージョンを上げる事が出来ないため、8.1でも可能な対応方法を模索しています。
http://msdn.microsoft.com/ja-jp/library/office/g … 上記urlにある「カスタムカレンダーフォームを使用する」の方法でコントロール[frmCalendar]をクリックすると同時にtextbox[日報選択]の日付を変更することができるのですが、他のサブフォームのリクエリができません。これを１回のクリックでサブフォームをリクエリさせる方法はないですか？ 現状ではコントロールによって変更されたtextbox内をもう一度クリックすると他のサブフォームがリクエリされます。下記はVBですが変更または追加があれば教えてください。 Option Compare Database Private WithEvents calendarForm As Form_frmCalendar ------------------------------------------------- Private Sub calendarForm_DateChanged(newDate As Date) Me.[日報選択] = newDate End Sub ----------------------------------------------------- Private Sub Form_Open(Cancel As Integer) Set calendarForm = Me.Calendar.Form End Sub ---------------------------------------------------- Private Sub Form_Click() DoCmd.OpenForm "F_日報" DoCmd.Close End Sub ---------------------------------------------------- Private Sub Form_Load() Me![日報選択].Value = Date Me!F_日報扱い現金.Requery Me!F_日報扱いクレジット.Requery Me!F_日報商品売上.Requery End Sub ---------------------------------------------- Private Sub 日報選択_AfterUpdate() Me!F_日報商品売上.Requery Me!F_日報扱い現金.Requery Me!F_日報扱いクレジット.Requery End Sub ---------------------------------------- Private Sub 日報選択_Click() Me!F_日報商品売上.Requery Me!F_日報扱い現金.Requery Me!F_日報扱いクレジット.Requery End Sub
お世話になります。 Access2000のマクロコマンドで データベース最適化をしたいのですが、 「マクロまたはVisual Basicコードの実行中に、開いているデータベースを最適化することはできません。」とういうエラーメッセージが出て最適化できませんでした。 マクロの一連の流れの「最後」で、データベース最適化をしたいと 思っていますが、具体的にどのようにすればよいのでしょうか？ 最適化をVBAなどでするのではなく、 　マクロのコマンド：データベースの最適化 でしたいと思っております。 勝手で申し訳ございませんが Ａ.mdbファイルを「マクロコマンド：データベースの最適化」で 最適化する具体的手順を教えて頂けないでしょうか？ 過去の質問で、mdb自身が開いているので絶対に無理！！ と言われたのですが、自分自身を終了させて、最適化 などできないのでしょうか？ また、できないのであれば、「マクロコマンド：データベースの最適化」 は、使えないのに、なぜそのようなコマンドがあるのでしょうか？ 具体的手順以外の回答は、結構ですので、 宜しくお願いします。 具体的手順を記載できる人を待ちたいので、できない場合は、 この質問は無視して下さい。 宜しくお願いします。
お世話になります。 Accessのマクロのコマンドで データベースの最適化をしたいのですが、 「マクロまたはVisual Basicコードの実行中に、開いているデータベースを最適化することはできません。」とういうエラーメッセージが出て最適化されません。 マクロの一連の流れの「最後」で、データベースの最適化をしたいと 思っていますが、具体的にどのようにすれば、 データベースの最適化を実行できるのでしょうか？ 条件としては、最適化をVBAなどでするのではなく、 　マクロのコマンド：データベースの最適化 でしたいと思っております。 また、過去に何度か質問したのですが、 私の質問文が悪く、希望する回答を えれませんでした。 勝手で申し訳ございませんが Ａ.mdbファイルを「マクロコマンド：データベースの最適化」で 最適化する具体的手順を教えて頂けないでしょうか？ ※最適化の手前で、データベースを閉じたり等 具体的手順以外の回答は結構ですので、 宜しくお願いします。 ※具体的手順を記載できない場合は、この質問は 無視して下さい。 宜しくお願いします。
お早うございます。 有料のOracleやMSSQLなどと、MySQLやFirebirdなどでは一番の違いはどういったものでしょうか。 無料のDBソフトのホームページなどでは良い事しか書いてません。 決定的な違いは（金額以外）何でしょうか？ 例えば顧客管理ができる予約ソフトを作成したら データが大きくなって時に観たい顧客のデータを表示するスピードが違うのでしょうか？ 膨大なデータを表示しようとするとスピードに違いがでるのでしょうか。 データが大きくなった時の動き（安定した稼働など）に違いがでるのでしょうか。 仕事で少し関わってきそうだったのでこちらに投稿しました。 よろしくお願いいたします！
お世話になります。 Access2000で作成したファイルの中に VBAで作成したプロシージャがあります。 そのプロシージャに、ショートカットキーを 割り当てたいのですが、どのようにすれば、 割り当て可能でしょうか？ 何卒よろしくお願い致します。
お世話になります。 Accessのマクロのコマンドで データベースの最適化をしたいのですが、 「マクロまたはVisual Basicコードの実行中に、開いているデータベースを最適化することはできません。」とういうエラーメッセージが出て最適化されません。 マクロの一連の流れの「最後」で、データベースの最適化をしたいと 思っていますが、具体的にどのようにすれば、 データベースの最適化を実行できるのでしょうか？ 条件としては、最適化をVBAなどでするのではなく、 　マクロのコマンド：データベースの最適化 でしたいと思っております。 「マクロのコマンド：データベースの最適化」があるので、 必ずできるはずだとおもうのですが、 何卒宜しくお願いします。
FileMakePro 12をWindows7で使用しています。 通常はフィールドを二つまで値一覧として使用できますが、これを三つ以上で 使用する方法を探しています。 例えば、複数のフィールドを計算で組み合わせて 値一覧に登録するなど出来るといいのですが。 ご存知の方、ご教示頂ければと思います。 よろしくお願いいたします。
MySQL5　に年度、通し番号が　格納されており、 select year, number from mytable ・・・と抽出すると以下のようになります。 2005　1 2005　2 2005　3 2008　4 2008　5 2008　6 2008　7 2008　8 2010　9 2011　10 2011　11 2011　112 同じ年度グループ内で、最大となる通し番号の行に「myFlg =1」と付けるSQL文をご教示ください。if とか group by とか as myFlg =1 みたいな記述をするのかなと想像するんですが・・・ PHP5のWHILE文でmyFlg = 1となっている行だけを出力し、上記データ例では、 while ($col = mysql_fetch_array($rst)) { if ($col['myFlg']) == '1') { echo $col['year'] . "年の最大番号は、" . $col['myFlg']. "番"; } } を実行することで、以下のような結果を得ることを期待しています。 2005年の最大番号は、3番 2008年の最大番号は、8番 2010年の最大番号は、9番 2011年の最大番号は、112番 よろしくお願いします。
お世話になります。 Accessのマクロのコマンドで データベースの最適化をしたいのですが、 「マクロまたはVisual Basicコードの実行中に、開いているデータベースを最適化することはできません。」とういうエラーメッセージが出て最適化されません。 マクロの一連の流れの最後で、データベースの最適化をしたいと 思っていますが、具体的にどのようにすれば、 データベースの最適化を実行できるのでしょうか？ ※直前に「データベースを閉じる」的な物をいれられるのでしょうか？ 素人で大変申し訳ございませんが、具体的に教えて頂ければ助かります。
こんにちは。 あるテーブル"T_A"が有り、 そのテーブルにカラム"C1"、"C2"が有ります。 テーブル"T_A"にレコードが以下の用に登録されていると仮定します。 C1|C2 ----- AA|S AA|P BB|R BB|S CC|S ※C2に登録されている値は抽出する優先順位が有り、 R:1 P:2 S:3 Rが一番優先順位が高く、Sが優先順位が最も低いです。 この条件から、C1の値が同じレコードに対して、C2の優先順位が 最も高いレコードを抽出したいです。 欲しい結果↓ C1|C2 ----- AA|P BB|R CC|S
お世話になります。 Access2000で作成しています。 mdbフイルをAccessw2000で開いた時に、フォームが自動で 表示されるようにしたいのですが、具体的にどのようにすれば、 よいのでしょうか？ お手数で申し訳ございませんが、mdbファイルを開いてからの 具体的なステップを教えていただければと思います。 大変申し訳ございませんが宜しくお願いします。 お手数ですが宜しくお願いします。
多分データベースだと思うのですがエクセルなんかでもできるのでしょうか？ 顧客リストのようなものをつくりたいと思っています。 作りたいものは・・・ １・氏名、年齢などの情報、顔写真、地図などの画像データを登録しておきたい。 ２・できればデータにエクセルのような計算式も使いたい。 　　例えばエクセルのようにＡ１には"=A2+A3"の値を自動で入力(表示)してくれるなど ３・必要な情報だけを検索でリストアップできるような検索フォームが欲しい。 　　例えば年齢２０～３０才などで絞って対象のものだけをリストアップできる検索フォーム 　　バイト探しのＨＰなどで時給や最寄駅などのチェックボックスにチェック入れると対象物だけが一覧表示されるイメージです。 ４・リストを一件づつ名刺のように決まった場所に各情報を配置したい。 　　氏名は大きめの文字で真ん中に表示したり右下に住所を小文字で表示したりなど 以上のようなものを作るには何を勉強し、どんなソフトが必要でしょうか？ データベースだとアクセスかなと思ったのですがアクセスで上記のものすべて出来るでしょうか？ 又、無料ソフトのオープンオフィスのベースでもできるのでしょうか？解説サイトがあまりないようでいまいち分かりません。 上記を満たす為にはその他のプログラミング言語の習得も必要でしょうか？それなりのものを作るには難易度は高めですか？ 分かりにくい文章だったらすみません。よろしくお願い致します。
お世話になります。 Access2000で作成しています。 Access2000で作成したmdbファイルから、mdeを作成。 access2000のRuntimeが入っているパソコンで開いたところ、 フォームが表示されず、何も実行できないウィンドウが 開くような状態なのです。 mdbからの書き出し時に、どのように設定すれば、mdeのフォームなどが 開いた状態になるのでしょうか？ お手数ですが宜しくお願いします。
プログラム初心者です シンプルな掲示板をつくりました ホームページのトップページに新しく書き込まれたスレッドを表示したいです 状況を説明します bbsに書き込まれたらbbsテーブルに行番号を付けてどんどんインサートしていくようにしてます トップページはindex.phpです index.php(トップページ) mysqli（手続き型）のカラム　bbsテーブル id （オートインクリメントでつけた行番号） bbs_id （タイトルごとのid。これでタイトルごとにまとめています） title スレタイトル mes 書き込まれた文章 name 書いた人の名前 time 型はdatetimeです（書き込まれた日付） 例えば、下記のように書き込まれたら 新しい書き込みがbbs番号3番のスレが2013-09-10 12:10:00 新しい書き込みがbbs番号5番のスレが2013-09-10 12:00:00 だとしたら 3番のスレへのリンク 5番のスレへのリンク のようにトップにスレへのリンクを書き込みが新しい順に20くらい表示したいです よろしくお願いします
さくらインターネットや、カゴヤのデータベースサービスを利用しているのですが データをバックアップするにもいつも途中で止まってしまいます。 データは多いテーブルで100万データあります。 効率のよいバックアップ方法、もしくは別サービスのデータベースに移す方法とかありますでしょうか？ よろしくお願いします。
SQL SERVERの BULK INSERTについて。 TESTというテーブルにtest.csvをBULK INSERTによりデータをインポートしようとしているのですが変数を使わずに下記のように書くと正常に動くのですが、 BULK INSERT TEST FROM 'C:\data\test.csv' WITH ( FIELDTERMINATOR = ',', ROWTERMINATOR = '\n' ) 変数を使って下記のようにすると「不適切な構文があります。」とエラーとなってしまいます。 DECLARE @data varchar(100) SET @data = 'C:\data\test.csv' BULK INSERT TEST FROM @data WITH ( FIELDTERMINATOR = ',', ROWTERMINATOR = '\n' ) 解決策を教えてください。
sql初心者です。下記条件のsqlをお教えください。 テーブルには、名前、入社日の2つの列があり、 それぞれ、文字列で入力されています。 名前には、tanakahirishi Yamasaki 入社日には 19901201 20110121 (1000レコード) のように入力されています。 この時、名前がt以外、k以外で始まり 入社日が1990年01月01日から、2000年01月01日の データを抽出したいのですが、sqlをお教えください
SQLについてお教え頂けませんでしょうか？ 在庫テーブル ・ID ・数量 データ 001,1 001,3 002,3 002,2 002,4 003,2 商品テーブル ・ID データ 001 002 003 004 やりたいこと： 在庫テーブルには重複しているIDがあります。 商品テーブルには重複しているIDはありません。 在庫テーブルの重複を削除したIDと商品テーブルのIDをinner joinで結びたいと思います。 ・select distinct ID FROM 在庫テーブル ・select ID FROM 商品テーブル この2つのjoin方法がわかりません。 結果として、 001 002 003 を取得したいいです。宜しくお願いします。 ちなみに select ID from 商品テーブル inner join 在庫テーブル 商品テーブル.ID = exists(select distinct ID from 在庫テーブル) というコードを書きましたが、動きませんでした・・・抽出データが0件でした・・・
使用環境：mysql　5.1 内容：テーブルに格納されている最後の行数が知りたいです。 テーブル名：seito noname 1tanaka 2suzuki : : 100kato のように1つのレコードに番号を振って名前をつけているのですが、 「seito」テーブルに登録されている最後の番号を取得するSQL文 を教えていただけないでしょうか？ ちなみに、最後が必ず「kato」というわけではないので「seito」テーブルの noカラムにおける最後の番号を取得したいと考えてます。 上記の場合「100」番が取得できれば希望の結果となります。 よろしくお願い致します。
■環境 ・MySQL ■前提 ・テーブルA … idカラム ・テーブルB … A_idカラム ■やりたいこと ・テーブルAデータを取得する際、テーブルAレコードに応じて、テーブルB「A_idカラム」の数(レコード数)も取得したい ■取得イメージ例 ・テーブルA「全カラム」、「count」カラム ※「count」カラム … テーブルBにある「A_idカラム」の数 ■知りたいこと ・どこにも存在しないこの「count」カラムはどうやって作成したら良いでしょうか？ ・全体のSQL文
PostgreSQLのApplication Stack Builderを使用しNpgsql.dllをインストールしたところ バージョンが2.0.12になりました。2.0.11をインストールしたいのですが、 バージョン指定でインストールすることはできないのでしょうか？ ご回答のほど、よろしくお願いいたします。 【環境】 Windows7 Professional SP1 VB2010 PostgreSQL9.2.1
ACCESSでローカルに作成したデータベースを WEB上で使用できるようにすることはできますか?? （できれば、office365を利用して） どなたかご教授ください。 よろしくお願いいたします。
３つのテーブルを結合させたSQL文について作成方法を教えてください。 よろしくお願いいたします。 【テーブル構成】 テーブル名---項目名/項目名・・・です。 tblA---id/del_flg/name tblB---id/del_flg/add tblC---id/del_flg/family 各テーブルはidによりリンクされます。 tblAのdel_flgは在籍者＝0　退職者＝1で、一人１レコードです。 tblBでは住所管理をしています。 旧情報を残したいので、更新時には新たにdel_flg＝0でレコードを作成し、既存レコードはdel_flg＝1に更新します。 tblCは、既婚者のみ作成されるレコードです。 つまり、tblBとtblCは、レコードが存在しない、あるいはdel_flg＝0のみ、del_flg＝0とdel_flg＝1が混在　のどれかのパターンになります。 【やりたいこと】 いま、これらすべてのテーブルを全部つなげて、在籍している人の情報だけ集めたいのです。 tblAからはdel_flg=0のレコードをすべて取得したうえで、tblBとtblCにdel_flg＝0のレコードがあればその情報も取得したい。 【経過】 select * from (tblA inner join tblB on tblA.id = tblB.id ) inner join tblC on tblA.id = tblC.id とりあえずwhere条件をつけなくても、tblCに存在している人しか取得ができないのです。 where条件も含めて、上記条件のもと、希望するようなSQLの組み立て方をご教授ねがいたいのでよろしくお願いいたします。 できれば、早目の回答が希望です。
やりたいことは、db2であるカラムの中の最大値を取得したいのですが、 そのカラムのデータの中には整数以外も含まれています。 整数のデータ中での最大値を取得したいのですが、良い方法はありませんでしょうか？ where isnumeric(カラム名)=1 という感じで整数の中からの最大値のようなことはできませんか？
お世話になります。 下記のようなテーブルＡがあります。 テーブルAを元にテーブルＢを生成したいのですが、 どのようにVBAで作成すればよいかわかりません。 お手数ですが、テーブルＡを元にテーブルＢを 生成するコードを教えて頂けないでしょうか？ ※タイムA、Ｂ、Ｃの小さい順で1,2,3と順番をつける ※テーブルＢを生成する方法 何卒宜しくお願いします。 --------テーブルＡ-------------------- 組|タイムA|タイムB|タイムC| １|0.6　　|0.9　　|　0.5　| ２|0.2　　|0.7　　|　0.9　| ---------------------------- ---------テーブルＢ------------------- 組|Aの順位|Bの順位|Cの順位| １|２　　　|３　　　|　１　| ２|１　　　|２　　　|　３　| ----------------------------
初歩的なＳＱＬの質問で申し訳ありません。 以前にも同じような内容で投稿させて頂きましたが、教えて下さい。 下記のような、ある異なる名前の同項目を持つ２つのテーブルが存在します。 《テーブル》 Ａテーブル　 　社員番号、日付、内容、所属、時間、結果 Ｂテーブル 　社員番号、日付、内容、理由 　※ 内容に関しては、ＡテーブルとＢテーブルで全く違います。 これらの２つのテーブルをマージさせ、社員番号毎の内容毎、日付順に したいと考えています。 以前に以下のようなUNIONを教えてもらいましたが、所属、時間、結果、理由という 項目全てを出力するとした場合、どのように記載すれば良いでしょうか？ UNIONの場合、項目が異なるとエラーとなってしまうかと、、、 《UNIONのSQL》 SELECT * FROM ( SELECT 社員番号, 日付, 内容 FROM Aテーブル UNION SELECT 社員番号, 日付, 内容 FROM Bテーブル ) ORDER BY 日付, 社員番号, 内容 教えて下さい。 よろしくお願いします。
お世話になっております。 現在ACCESS2000を使用しております。 テキストボックスのコントロールソースにDLOOKUP関数を使用しております。 DLOOKUPで抽出して値(数値)を変数(Integer)に代入しております。 そこで何故か代入出来る値と出来ない値があり困っております。 デバックで確認するとDLOOKUPでは値を持ってこれておりますが 変数に代入する際に失敗しているようです。 何故そのような事象が起こるのか調べてもわからず質問させていただきます。 恐れ入りますが、心当たりあるかた、どうか教えて頂けませんでしょうか。 以上、よろしくお願い致します。
さくらのレンタルサーバを利用しています そのサーバにあるphpMyadminの利用での質問です さくらサーバのデータを1レコードCSVでエクスポートした時、テキストエディターで そのデータをみた時、本来、1行で表示されるべき所が複数行になってみえています。 よくみると、さくらサーバ側のあるフィールドで改行して表示させている所が エディター側で改行されているようです CSVにエクスポート時にどこか指定する所がありきちんとみえるようになるのでしょうか よろしくお願いします。
さくらのレンタルサーバを利用しています そのサーバにあるphpMyadminの利用での質問です phpMyadminの検索機能を利用して特定のレコードをcsvデータとして抽出したいと思います 例えば、テーブルaのid=1000の場合の画面表示は次のSQL文で表示されます ------------------- SELECT * FROM `tbl_a` WHERE `id` =1000 ------------------- パソコン側の保存先が C:\Documents and Settings\users\My Documents\SAKURA_DL" とした場合のSQL文はどのように記載すればいいか教えていただけませんか ちなみに 次のように記載してみたのですがエクスポートされません --------------------------------------------- SELECT * FROM `tbl_a` WHERE `id` =1000 INTO OUTFILE "C:\Documents and Settings\users\My Documents\SAKURA_DL" ---------------------------------------------- よろしくお願いします。
Oracleについて質問です。 sqlldrでデータをロードする際に、入力ファイルのレコードの終端文字を 指定できます。デフォルトは改行コードとなっていますが これを「＠改行コード」にしたいのですがどうすればよろしいでしょうか。 具体的には、 infile '入力ファイル名' "str 'XX'" XXの箇所を「@と改行コード」としたいのですがうまくいきません。 お手数ですがご教示願います。
受注T ---------------- 製品CD　　得意先CD　　数量　　単価　　受注日 0001　　2001　　500　　3000　　2013/7/5 0002　　2002　　1000　　NULL　　2013/9/25 0003　　2003　　1800　　NULL　　2013/9/25 単価M ---------------- 製品CD　　得意先CD　　数量FROM　　数量TO　　単価　　適用日 0001　　2001　　0　　99999　　3000　　2013/5/1 0002　　2002　　0　　　　500　　　800　　2013/5/1 0002　　2002　　501　　999999　　500　　2013/5/1 0003　　2003　　0　　　500　　　　2000　　2013/1/1 0003　　2003　　501　　999999　　1800　　　2013/1/1 0003　　2003　　0　　　500　　　　2500　　2013/9/20 というデータがあります。 受注Tの単価部分にデータがあるものとないものがあります。 受注時に単価Mから照合して単価を入れるのですが、受注時にまだ単価Mにない場合はNULLが 入っています。 そこで後日VIEWとして単価照合Vを作りたいです。 単価照合Vを作ったときにも単価MになければNULLのままでOKです。 て単価照合V ---------------- 製品CD　　得意先CD　　数量　　単価　　受注日 0001　　2001　　500　　3000　　2013/9/27 0002　　2002　　1000　　500　　2013/9/25 0003　　2003　　2000　　1800　　2013/9/25 ※2013/9/20に単価更新がありますが条件数量は0-500なので2013/1/1が適用 こんな感じです。 わからないのは受注数量、受注日と単価Mの照合です。 サブクエリを使えばSQLで１行に書けるのでしょうか？ お願いします。
先程、次のような質問をして、素晴らしい回答をいただきました。 http://questionbox.jp.msn.com/qa8279886.html しかし、ベストな回答でない事に気付きましたので、再び質問させていただきます。 ちなみに、データベースはMYSQLです。 下記が先程の質問の回答を踏まえて少し質問を変えたものです。 重要なのが☆の部分です。 ************************************************************************ 現在の日時を基準に下記テーブルより直近で空いている日付とその時間帯を求めるSQLを教えて下さい。 下記のjikan_tblは、未来の予定のレコードが登録されています。 １レコード目は、2013年9月27日10時から同日の10時15分までの予定のデータです。 ☆（先程の質問はこちら） 15分間隔で予定のレコードを登録していますが、現在の日時が2013年9月27日の10時の場合、 直近で予定を入れられる時間帯を知りたいのでSQLで同日の10時45分から11時が空いていると取得できればベストです。 ちなみに同日の11時15分から11時30分と取得されてしまうのは、NGです。 ☆（今回の質問ではこちら） 15分間隔で予定のレコードを登録していますが、直近で予定を入れられる15分間隔の時間帯を知りたいので 次のそれぞれのパターンで取得できればベストです。 現在日時：2013年9月27日の8時50分の場合　→　取得時間帯は9:00～9:15 現在日時：2013年9月27日の9時05分の場合　→　取得時間帯は9:15～9:30 現在日時：2013年9月27日の10時00分の場合　→　取得時間帯は10:45～11:00 現時点から直近の15分区切りの時点を求め、求めた時点から直近で空いている15分間の時間帯を求めたいです。 先程の回答では、27日10時現在では、素晴らしい結果がでましたが、現在時間を27日9時と設定しても 10時45分から11時が求められました。 私の質問の書き方が悪かったと思います。 回答していただいた方にお詫びします。 jikan_tbl start datetime, end datetime jikan_tblのレコード 2013-09-27 10:00| 2013-09-27 10:15 2013-09-27 10:15| 2013-09-27 10:30 2013-09-27 10:30| 2013-09-27 10:45 2013-09-27 11:00| 2013-09-27 11:15 2013-09-27 11:30| 2013-09-27 11:40 知恵を貸して下さい。 宜しくお願いします。 os: windows 7 eclipse: Version: 4.2.0 Build SDK: Android 4.3(API 18) PHP 5
PostgreSQLとPHPでサイトを作っています。 下の２つの表がある場合に、「表１」のid名に応じて、 表2のid_noの該当件数を取得したいと思っているのですが、 うまくいかないため質問させいてただきました。 【表1】 idtitle ----------------------- 1ほげ1 2ほげ2 3ほげ3 4ほげ4 【表2】 id_nocoment ----------------------- 1コメント 2コメント 2コメント 2コメント 3コメント 3コメント 3コメント 【ほしい結果】 idtitlecount ----------------------- 1ほげ11 2ほげ23 3ほげ33 4ほげ40 SELECT title,id, (SELECT COUNT(*) FROM comment WHERE id_no ='【ID番号】') FROM informations AS count こちらの様なSQL文で取得出来るのではと考えたのですが、 【ID番号】の部分に、「表１」のidを動的に入れる事が出来ずに困っています。 解法がありましたら教えて下さい。
現在の日時を基準に下記テーブルより直近で空いている日付とその時間帯を求めるSQLを教えて下さい。 下記のjikan_tblは、未来の予定のレコードが登録されています。 １レコード目は、2013年9月27日10時から同日の10時15分までの予定のデータです。 15分間隔で予定のレコードを登録していますが、現在の日時が2013年9月27日の10時の場合、 直近で予定を入れられる時間帯を知りたいのでSQLで同日の10時45分から11時が空いていると取得できればベストです。 ちなみに同日の11時15分から11時30分と取得されてしまうのは、NGです。 jikan_tbl date_start int(8), time_start int(4), date_end int(8), time_end int(4) jikan_tblのレコード 20130927 | 1000 | 20130927 | 1015 20130927 | 1015 | 20130927 | 1030 20130927 | 1030 | 20130927 | 1045 20130927 | 1100 | 20130927 | 1115 20130927 | 1130 | 20130927 | 1140 難しく調べても分かりません。 知恵を貸して下さい。 宜しくお願いします。 os: windows 7 eclipse: Version: 4.2.0 Build SDK: Android 4.3(API 18) PHP 5
教えてください。 SQL Server2005 Express EditionはWindows7に対応していますでしょうか？ ServicePackは？？以上ということはありますでしょうか？ 対応表等あれば教えていただけますでしょうか？ もし対応していたとしても新しいExpress Editionに変えた方が良いでしょうか？ (現在WindowsXP上で使用しています。) よろしくお願い致します。
いつもお世話になっております。 ACCESS2000を使用しております。 フォームでデータを入力して登録しております。 そこでフォームの必須入力項目が空白の場合は登録できないようにしたいです。 ※テキストボックスは商品No・商品・価格・・・・とあり価格が未入力の場合、登録ボタンを 教えても登録できないようにしたいです。 調べてもエラー対処方法等がヒットしてしまい、なかなかみつかりません。 お手数ですが、お力を貸して頂けないでしょうか。 以上、よろしくお願い致します。
EVENT --+-------------------------+----------------+ id| EVT| start_date | end_date --+-------------------------+-----------------+ 0 |AAAA| 2013-06-01　10:00 | 2013-06-01 14:00| --+-------------------------+-----------------+ 1 |BBBB| 2013-06-01 12:00 | 2013-04-01 18:00| --+-------------------------+-----------------+ 2 |CCCC| 2013-06-02 10:00 | 2013-06-05 12:00| --+-------------------------+-----------------+ 3 |DDDD| 2013-06-02 13:00 | 2013-06-05 18:00| --+-------------------------+-----------------+ 4 |EEEE| 2013-06-02 14:30 | 2013-06-05 17:00| ↑こんな感じでイベントを管理するテーブルがあります。 イベントの開催時間の重複を加味して何らかのイベントのある 連続した時間帯のみ取り出すSQLを書きたいのですが、 いい案はありますでしょうか？ 結果的には以下の様な情報が取り出したいです。 2013-06-01 10:00 - 18:00 2013-06-02 10:00 - 12:00 2013-06-02 13:00 - 18:00 ID 0と1は連続してるので　10:00 - 18:00 ID 2はどれとも連続してないので　10:00 - 12:00 ID 4はID3の中にあるので無視
SELECT id (price * 10) FROM table WHERE id IN (1, 2, 3) を、実行すると +--+-----+ | id | price | +--+-----+ | 1 | 100 | | 2 | 100 | | 3 | 100 | +--+-----+ に、なります。 この結果に対してid1には*10、id2には*20、id3には*30というような処理はMySQLで可能でしょうか？ 期待値としては +--+-----+ | id | price | +--+-----+ | 1 | 100 | | 2 | 200 | | 3 | 300 | +--+-----+ です。 よろしくお願いします。
説明下手ですがお付き合いください。 まず table には +----+---+ | id | num | +----+---+ | 1 | 10 | | 1 | 10 | | 2 | 10 | +----+---+ この様な値が格納されており、これに対して SELECT id, SUM(num) FROM teble GROUP BY id; を実行すると +----+---+ | id | num | +----+---+ | 1 | 20 | | 2 | 10 | +----+---+ この様になります。 では、本題です。 上のコマンドで出力した結果に対してさらに 20 <= num のような条件を付加させたいです。 その場合の期待値としては +----+---+ | id | num | +----+---+ | 1 | 20 | +----+---+ です。 書いてて泣きたくなる程説明が下手ですが、よろしくお願いします。
Oracle11gで、以下のようなテーブルから、 「IDごとに、DTが最大のレコードのBUMONを1件ずつ取得」　したいです。 ＜テーブルTB＞ ID DT BUMON ------------- 1 9/1 A 1 9/2 A 1 9/3 B ★Bを取得したい 2 9/4 C 2 9/5 C ★Cを取得したい 3 9/1 D 3 9/3 E 3 9/3 E ★Eを取得したい ＜取得したいデータ＞ BUMON ------- B C E ＜考えたSQL＞ select distinct A.BUMON from (select ID, DT, max(DT) over(partition by ID) as MAXDT, BUMON from TB) A, (select ID, DT, max(DT) over(partition by ID) as MAXDT, BUMON from TB) B where A.ID = B.ID and A.DT = B.MAXDT ; 上記のような方法を考えましたが、取得できますでしょうか？ 現在、SQL実行環境がない場所にいるのですが、急ぎで確認したく、 どなたかお知恵を拝借できませんでしょうか？？ また、可能であれば、★のレコード全体を取得するSQLもご教授いただきたく存じます。 ＜★のレコード全体を取得した結果＞ ID DT BUMON ------------- 1 9/3 B 2 9/5 C 3 9/3 E
さくらサーバを利用しています そのサーバにあるphpMyadminの利用で質問させてください テーブルAにレコードA1～A1000までの1000件のデータがあります そこに1001件目のレコードを追加したいのですが、フィールドが 700項目程度あり、そこに1項目ごと入力するのが大変なので、 A1～A1000のデータの中から、類似の1つのレコードをCSVでダウンロードして パソコン側でそのデータを修正してアップロードしたいと思います そこでphpMyadminを利用しての次のような手順でデータ操作しようと思っています phpMyadminのメニューにあるエクスポートで該当のレコードをPC側に抽出し そのデータをエクセルで必要な所を修整します そして、A1～A1000にないID番号を振り、そのデータをphpMyadminで インポートさせようと思います そこでお聞きしたいのは この1件のデータをインポートをさせた時、サーバ側にある1000件のデータにプラス されて1001件になるでしょうか それとも、1000件の上にインポートされたデータがかぶせられて、1000件の データがなくなり1件になってしまうのでしょうか 自分では前者のように1001件になると思うのですが万一後者になったら 大変なため質問させていただきました よろしくお願いします。
いつも参考にさせていただいております。 今回、自宅のPCに構築した開発環境のDBに、急に接続できなくなりました。 ==================================== 【開発環境】※ASP環境 OS ：windows 8 IIS：8.0 DB ：(1)MySQL 5.5.32 　　※「mysql-connector-odbc-5.2.5」もインストール済。 　(2)Access2013 ==================================== 先日まで、問題なくDBに接続できていましたが、寝ぼけて何かの設定を変えてしまいました。 ※恥ずかしながら、気づいたら設定変更後で何の設定を変えたのか不明です。。。 すると、今まで正常に接続できていたMySQLとAccessが、以下のエラーで接続できなくなりました。 ==================================== 【MySQL接続】 Microsoft OLE DB Provider for ODBC Drivers エラー '80004005' [Microsoft][ODBC Driver Manager] データ ソース名および指定された既定のドライバーが見つかりません。 【Access接続】 Microsoft OLE DB Provider for ODBC Drivers エラー '80004005' [Microsoft][ODBC Driver Manager] 指定された DSN には、ドライバーとアプリケーションとのアーキテクチャの不一致が含まれています ==================================== なお、接続箇所のロジックは以下となります。 ==================================== 【MySQL接続】 Set oCn = Server.CreateObject("ADODB.Connection") oCn.Open UDL_FILE(※1), "", "" ※1　上記「UDL_FILE」は、以下の内容を設定しているUDLファイルを読み込んでいます。 ------------------------ [oledb] ; Everything after this line is an OLE DB initstring PROVIDER=MSDASQL;DRIVER={MySQL ODBC 5.2 Unicode Driver};SERVER=localhost;USER=hogeU;PASSWORD=hogeP;DATABASE=hoge; ------------------------ 【Access接続】 Set poCnMdb = Server.CreateObject("ADODB.Connection") poCnMdb.Open DNS(※2), "", "" ※2　上記「DNS」は、ODBCデータソース アドミニストレーター(32bit版)で登録したシステムDSNです。 ------------------------ ドライバー：Microsoft Access Driver(*.mdb) ------------------------ ==================================== MySQLやODBCドライバーの再インストールを試みましたが、上記エラーが解消されません。 自業自得なのは重々承知しておりますが、復旧できなくて大変困っています。 お忙しいところ申し訳ありませんが、復旧方法のご教授をお願いいたします。 以上です。
SQL文のOrder by句で2つのバインド変数を用いて、ソートする項目・ソート順を決めたいと思い、以下のようなSQLを作成いたしました。 Select row_Number() Over(Order by Case ：ITEM When 'PJコード' then PJコード When '部署コード' then 部署コード end Case ：LINE When '1' then DESC When '2' then ASC end .... バインド変数を直接Order by句に入れますと、結果は帰ってくるのですが、バインド変数の値がすべて無視されてデータが出力されます。 以上の理由より、Case文にてバインド変数の値を参照し、ソートする項目と順番を決めております。 上記のソースで実行しますとORA-00907：右かっこがありませんというエラーが表示されます。 2つ目のCase文（：LINE）を消し、最初のCase文だけを残して、並び順（DESC・ASC）を埋め込むと、実行される状態になります。 Oracleのバージョンは11gです。 ご回答よろしくお願いいたします。
お世話様になります。 まだmdbファイルの時代のaccessのフォームを使って、期間の売り上げ集計をしています。 具体的には 開始日　**/**/** 終了日　**/**/** という二つのテキストボックスを設けて**部分に年月日を入力し、その期間の売り上げをサブフォーム上に表示するというものです。 これまでは、まったく問題なく動作していたのですが、 終了日のテキストボックスに、13/04/18、つまり、2013年4月18日以降の日付を入れると、 「エラー番号　3420」のマクロエラーが発生し、集計用のマクロに設定した再クエリが停止してしまいます。 2013年4月17日以前の日付ならば、まったく問題なく動くため、原因が突き止められません。 ここまで来て、いよいよ会社実務にも支障が出始め、困り果てて、質問させていただきました。 実は、accessでDBを作っていたのは既に何年も前で、今はただの利用者になっており、質問の仕方さえよくわからなくなっておりますが、ヒントになるようなことがありましたら教えていただければありがたいです。 どうぞ、よろしくお願いいたします。
mysql初心者です phpとmysqliを使っています テーブルhogeにid、gifとカラムがあります gifのカラムを空にしたいのですがこんな感じでいいでしょうか？ mysqli_query($link,sprintf('UPDATE hoge SET gif="%s" WHERE id=%d', "", mysqli_real_escape_string($link,$id) )); よろしくお願いします
タイトル通りです。 VirtualBoxの仮想環境のCentOS内に Apatch+PHP+Mysqlで開発環境を作っているのですが どうにもこうにも文字化けします 症状としては phpmyadminで確認した時、日本語のデータが正しく表示されるが 実際にphpでデータベースから取り出して表示すると???になります。 phpのフォームから日本語を入力してそのデータを表示すると正しく表示されるのですが 今度はデータベース内のデータが文字化けしています。 こちらのスクリプトでは文字化けしないのでPHPの設定ミスではないようです http://tsuttayo.jpn.org/php/char_trn/ phpinfoの情報 DirectiveLocal ValueMaster Value mbstring.detect_orderautoauto mbstring.encoding_translationOffOff mbstring.func_overload00 mbstring.http_inputautoauto mbstring.http_outputpasspass mbstring.http_output_conv_mimetypes^(text/|application/xhtml\+xml)^(text/|application/xhtml\+xml) mbstring.internal_encodingUTF-8UTF-8 mbstring.languageJapaneseJapanese mbstring.strict_detectionOffOff mbstring.substitute_characterno valueno value Mysqlの設定もご覧の通りです Variable_name Value character_set_client utf8 character_set_connection utf8 character_set_database utf8 character_set_filesystem binary character_set_results utf8 character_set_server utf8 character_set_system utf8 character_sets_dir /usr/share/mysql/charsets/ 以下my.cnf [mysqld] datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock user=mysql # Disabling symbolic-links is recommended to prevent assorted security risks symbolic-links=0 character_set_server=utf8 default-storage-engine=InnoDB innodb_file_per_table default-character-set=utf8 skip-character-set-client-handshake [client] default-character-set=utf8 [mysql] default-character-set=utf8 [mysqldump] default-character-set=utf8 [mysqld_safe] log-error=/var/log/mysqld.log pid-file=/var/run/mysqld/mysqld.pid スクリプトはちゃんとUTF-8BOMなしで作っています。 Mysqlのバージョンは 5.5.33です。 PHPのバージョンは 5.4.19です。 PDOのオプションも試しみましたがうまくいきませんでした。 非常に困っています。 回答いただけたら幸いです。
データベース・MySQLの初心者です。 もう一つ教えてください。 下のテーブルで、NO、数値、和算カラムがあります。 NOカラムの１、２の行の数値カラムを足し、 NOカラム２の和算カラムに、結果の３を入れます。 同じように、２行づつ和算を行なうには、どのようにSQL文を つくれば良いでしょうか？ テーブル NO　数値　和算　和算カラムの結果 １　　１　　　null　　null ２　　２　　　null　　３ ３　　５　　　null　　７ ４　　２　　　null　　７ ５　　２　　　null　　４ よろしくお願いします。
データベースの初心者です。MySQLを使用してSQL文を試しましたが、うまくいきません。 わかりやすく教えていただけますか？ 下のような２つのテーブルで、テーブル２の項目カラムに存在するデータが、 テーブル１の区分にあれば、一致する行（NOカラムの５～７）だけに、 フラグ”１”を付けたいのです。（区分カラムに、"*"で始まるデータは除きます） 区分に、データが全て埋まっていれば簡単に出来るのですが、 先頭行のみデータがあって、次の区分まで、Nullが入っています。 テーブル１ NO　区分 フラグ １　　aaaaa　　　null ２　　null　　　　 null ３　　null　　　　 null ４　　null　　　　 null ５　　bbbbb　　 null ６　　null　　　　 null ７　　*nozoku　 null ８　　ccccc null ９　　null null テーブル２ NO　項目 １　　bbbbb ２　　eeeee よろしくお願いします。
現在、Oracle11g Release2　11.2.0.3（ASM使用）　の環境で、オンラインREDOログファイルが全て消失した場合を想定して、以下の手順で復旧の方法をテストしています。 ----- 1.sqlコマンドでテーブルに1件データを挿入する。 2.フルバックアップ（バックアップセット）を取得する。 3.sqlコマンドでテーブルに1件データを挿入する。 4.累積増分バックアップを取得する。 5.sqlコマンドでテーブルに1件データを挿入する。 6.DBをシャットダウンする。 (RMAN> shutdown immediate;) 7.オンラインREDOログファイルを全て削除する。 8.DBをマウントする。 （RMAN> startup mount;） 9.リストアをする。 （RMAN> restore database;） 10.バックアップの際に除外している表領域をオフラインにする。 （SQL> Alter database datafile '+DATA/orcl/DATAFILE/hoge2' offline drop;） 11.リカバリをする。 （SQL> recover database using backup controlfile until cancel;） （ログの指定は AUTO） 12.DBをオープンする。 （RMAN> alter database open resetlogs;） 13.sqlコマンドでテーブルの中を確認する。 （SQL> select * from HOGEHOGE;） （データが1件） ----- 上記の手順でDBをオープンにするところまで上手くいったのですが、 私の考えでは、13でテーブルを確認するとデータが2件はいっていると思ったのですが、 結果は、1件だけでした。 累積増分バックアップを取得した時点（データが2件入った状態）まで戻したいのですが、 解決の手がかりになる情報などがございましたらご教示いただけますでしょうか。 よろしくお願いします。
XAMPP Version: 1.8.2　です。 　 Xamsのデータベースをデータベースから削除した後 　SQLから、以下2個プログラムを入力しました。 　すると、削除したにも関わらず、エラーが出て プログラムが反映されません。 　Xamsを削除後、再起動したらまたXamsのデータベースが 再構築されます。 　私は作成した記憶はありません。 　すでに存在しているので、作成しする必要は ないのか、よくわかりません！？ 　皆様どう思われますか！？ 　以下入力したプログラムです。 ---------------------------------------------------------------- CREATE DATABASE xmas; USE xmas; CREATE TABLE xmastran ( book_id int not null auto_increment, name varchar(30) not null default '' , org varchar(50) not null default '', addr varchar(80) not null default'', tel varchar(20) default '', mail varchar(40) default '', course varchar(30) default '', nums integer default 0, PRIMARY KEY (book_id) ) ENGINE=MyISAM DEFAULT CHARSET=utf8; エラー 実行したSQL： DATABASEクリスマスを作成します。 のMySQLのメッセージ：ドキュメント ＃1007 - データベース'クリスマス'を作成できません、データベースが存在している -------------------------------------------------- CREATE DATABASE if not exists xmas; USE xmas; CREATE TABLE xmastran ( book_id int not null auto_increment, name varchar(30) not null default '' , org varchar(50) not null default '', addr varchar(80) not null default'', tel varchar(20) default '', mail varchar(40) default '', course varchar(30) default '', nums integer default 0, PRIMARY KEY (book_id) ) ENGINE=MyISAM DEFAULT CHARSET=utf8; エラー 実行したSQL： TABLE xmastranを（CREATE book_idのINT NOT NULL AUTO_INCREMENT、 名VARCHAR（30）NOT NULL DEFAULT''を、 orgのVARCHAR（50）NOT NULL DEFAULT''を、 addrはVARCHAR（80）NOT NULL DEFAULT''を、 電話VARCHAR（20）DEFAULT''を、 メールVARCHAR（40）DEFAULT''を、 もちろんVARCHAR（30）DEFAULT''を、 numsはINTEGERのデフォルトは0、 PRIMARY KEY（book_id） ）ENGINE = MYISAM DEFAULT CHARSET= utf8を; のMySQLのメッセージ：ドキュメント ＃1050 - テーブル 'xmastran'は既に存在します。 ------------------------------------------------------------------- 以上よろしくお願いします。
MySQL 5.1 利用中です。 テーブルに登録されている文字列が以下のようになっている場合 右から1文字だけを削除するSQL文を教えてください 右から「部とか課や/」が削除されるイメージです。 →SQL実行前 name 経理課 営業部 開発部 部門開発部 RアンドD/ →SQL実行後 name 経理 営業 開発 部門開発 RアンドD よろしくお願い致します。
教えて下さい。 ある在庫システムを構築していますが、その中で、滞留在庫（６ヶ月動きがない在庫）を抽出 しようと考えています。 関係しそうなテーブルとしては、 　品目マスタ 　仕入データ 　発注データ 　在庫日次データ　※1 というテーブルが存在します。 ※1 在庫日次データというのは、仕入、発注、移動、出荷等のデータが、それらのアクションと 　　　同時にデータとしてそのテーブルに発生します。 イメージ的には、仕入データが発生した日から、在庫日次データにデータがないもをピックアップ すれば良いかと思われますが、どのようなＳＱＬを書けば良いでしょうか？ 初歩的な質問で申し訳ありませんが、教えて下さい。 よろしくお願いします。
Windows7＋Access2010のVBAで「JIS2004」の異体字168文字を記述していましたところ、不思議な事が起こりましたので質問です。 Ａ．「屢」だけ「？」となり、記述できない。 　　それ以外の異体字は正常に記述できる。 　　現在は ChrW(&H5C62) と記述して逃げている。 Ａ－１．なぜ記述できないのか、その原因は？ 　　　　バグなのか、環境変更、あるいはアップデートで回避できるか？ Ａ－２．Windows7＋Access2010で記述できるようにする方法はあるのか？ 　　　　無いのなら、Windows8＋Access2013などなら、問題ないのか？ Ｂ．漢字をunicodeで指定するとした場合、異体字などに含まれる「叱（U+20B9F）」などは5桁コードだが、5桁以上のunicodeをVBAで表現したい場合はどのように処理するのか？ 　　ChrWやAscWでは正しく処理できない。 ネット検索もしてみましたが、なかなかヒットせず、時間ばかりかかっています。 どなたかご存知の方がいらっしゃいましたらよろしくお願いします。
Accessで書かれたクエリをSqlサーバーのクエリに変換したいと考えているのですが そのクエリは膨大な行数ある上にIIF関数やSwitch関数がそこら中に含まれており、一つ一つ置換していられません。 もしどなたかIIF関数などのAccessのクエリをSqlサーバーのクエリへ変換してくれるソフトをご存知の方いらっしゃいましたら教えていただければ幸いです。 よろしくお願いいたします。 ◆バージョン SQL Server:SQL Server 2008 R2 ACCESS:ACCESS2000 OS:Windows7
phpを勉強始めたばかりで、データベースを使う必要がでてきたため、初心者サイトを 読んでいるのですが、一点質問があります。 行いたい事は、データベースに保存した画像パスをphpで出力するだけなのですが、パスが 文字列として扱われてしまっています。画像を出力するにはどうすれば良いでしょうか？ 例えば以下のようなphpプログラムで、nameには画像パスである 「abc.jpg」という文字が 入っていたとすると以下ではそのままabc.jpgという文字列が出力されてしまします・・・。 <?php $pdo = new PDO("mysql:dbname=aaa", "root"); $pdo->query("set names utf8;"); $st = $pdo->query("SELECT * FROM bbb"); while ($row = $st->fetch()) { $name = htmlspecialchars($row['name']); echo '<img src="$name">'; } ?>
お世話になります。 テーブルがA,Bと２つあり、Aの内容をBの内容と一致するようにUPDateしたい。 各テーブルには各々下記のフィールドがあります。 テーブルA　フィールド　DK、　　NUM　 テーブルB　フィールド　DKA、　DKB DK=DKAのときに 下記条件でデータセットしたいのですがUPDATE文がわかりませんご教授お願いします。 DKにDKBを NUMは20ケタのSTRINGで １から13桁目まで元のNUMの文字を 後ろ7桁にDKBと7桁に満たない場合は頭に０を付加した文字をセットしたい。 DK=DKB NUM=concat(substr(NUM,1,13),lpad(to_char(DKB),7,'0') 以上　宜しくお願いします。
ＳＱＬｉｔｅは、vb.netのようなアプリケーションを作成するツールですか？
http://php1st.com/435/ 　にある説明config.inc.phpファイルですが、 $cfg['Servers'][$i]['auth_type'] = 'config'; $cfg['Servers'][$i]['user'] = 'root'; $cfg['Servers'][$i]['password'] = '12345'; ---------------------------------------------- にすると 以下のエラーが出ます。 ＾＾＾＾＾＾＾＾＾＾ phpMyAdmin へようこそ エラー MySQL のメッセージ: ドキュメント #1045 - Access denied for user 'root'@'localhost' (using password: YES) MySQL サーバに接続しようとしましたが拒否されました。config.inc.php のホスト、ユーザ名、パスワードが MySQL サーバの管理者から与えられた情報と一致するか確認してください。 それで ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ $cfg['Servers'][$i]['auth_type'] = 'cookie'; $cfg['Servers'][$i]['user'] = 'root'; $cfg['Servers'][$i]['password'] = '12345';　 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 　にすると、 　phpMyAdmin phpMyAdmin へようこそ 言語 - Language ログインドキュメント ユーザ名:root パスワード：・・・・・ ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ それで 　http://php1st.com/435/ 　にある説明では 　$cfg['Servers'][$i]['auth_type'] = 'config'; 　にしなさいとあります。 しかし、私の場合は、この質問の冒頭にでた同じエラーが出たので、 $cfg['Servers'][$i]['auth_type'] = 'cookie'; 　としたら、 　ちゃんとログイン画面が出るうになりました。 　なぜでしょうか！？ 　宜しくお願いします。　
1日24回（約1時間毎に）米ドルの為替レートを記録したテーブル（米ドルtbl）があり、 内部に数年分のデータが蓄積されています。 取得日時(datetime)　　米ドル為替レート(usd) ----------------------------------- 2012-10-23 23:00:01　　79.45 2012-10-24 00:00:00　　79.38 2012-10-24 01:00:05　　79.40 2012-10-24 02:00:01　　79.41 　　　　・　　　　　　　　　　　・ 　　　　・　　　　　　　　　　　・ このテーブルを使って、各月の米ドルの最大値（最安値）を求めたければ、 select year(datetime) as 年, month(datetime) as 月, max(usd) as 最大値 from 米ドルtbl group by 年, 月; とすれば、 年　　　月　　最大値 ------------------------- 2012　9　　　79.21 2012　10　　80.36 2012　11　　82.76 2012　12　　84.94 2013　1　　　91.38 2013　2　　　94.71 2013　3　　　96.69 という結果が得られるのはわかるのですが、 この結果に更に、その最大値を取得した日時を加えて、 年　　　月　　最大値　　取得日時 --------------------------------------------- 2012　　9　　　79.21　　2012-09-06 15:00:01 2012　　9　　　79.21　　2012-09-13 04:00:00 2012　　9　　　79.21　　2012-09-22 22:00:02 2012　　10　　80.36　　2012-10-24 03:00:00 2012　　11　　82.76　　2012-11-18 22:00:03 2012　　12　　84.94　　2012-12-21 13:00:02 2013　　1　　　91.38　　2013-01-18 20:00:01 2013　　2　　　94.71　　2013-02-14 11:00:00 2013　　3　　　96.69　　2013-03-26 21:00:02 というようなデータを得たいと思うのですが、 どういう構文を書けばいいか、皆目見当がつきません。 その月に最大値の取得日時が何回もあるなら、 上記2012年9月のように、それらすべてが表示されるのが理想です。 どうぞ宜しくお願い致します。
MySQL 5.1 利用中です。 area | number /tokyo/01/ aa1 /tokyo/02/ bb2 /chiba/01/ aa1 上記のようにテーブルに情報が登録されているとします。 やりたいことは、areaフィールドに登録されている 「tokyo」がある場合はnumberフィールドを「東京」の名前を 追加したいと考えてます。 やりたい事の実行結果 area | number /tokyo/01/ 東京/aa1 /tokyo/02/ 東京/bb2 /chiba/01/ aa1 このように処理するには 　UPDATE テーブル名 SET WHERE area LIKE '%tokyo%' = REPLACE(number,'','東京/'); こんな感じかと実行してみたら、やっぱりだめでした、、 何かアドバイスをいただけないでしょうか？ よろしくお願い致します。
商品のデータベースがあるんですが、一つの商品テーブルに複数の店舗の商品をまとめて登録しています。在庫数は店舗別のテーブルで分けているのですが、これをＳＱＬで商品コードで結合ができません。 仮に商品がＡ、Ｂ、Ｃと登録されていたとして、店舗１にはＡとＢの商品があるため２つの在庫数を設定しており、店舗２にはＢとＣの商品があるため２つの在庫数を設定しています。 つまり片方のみの商品もあれば両方に存在する商品があります。 このときにＳＱＬで商品情報を取得する場合に、結合したいのですが結果が0件となり上手く結合ができません。 商品コードがＢのときにＳＥＬＥＣＴ文で両店舗の在庫数を同時に取得したいし、ＡやＣではそれぞれの店舗在庫を取得したいのですが、何か良い方法はないものでしょうか？
Access2010の使用者で＆初心者です。 クエリの抽出条件に別テーブルのフィールドを文字列検索させ、その文字列が含まれていた場合は、その文字列を別フィールドに抜き出すというクエリを作成したいのですが・・ ・検索したいテーブル(T商品情報) ・年月日 ・品目情報 ・検索する文字列が入ったテーブル(T品目) ・検索文字 検索したいテーブル(T商品情報)の「品目情報」から、検索する文字列が入ったテーブル(T品目)の「検索文字」を検索し、その検索文字列が含まれていた場合は別フィールにその検索文字列を抽出。という作業を行いたく思っております。 例 ---------------------------T商品情報 年月日｜品目情報 20010/8/10｜武田様より、口頭にてもも大を53個受け付けました 20010/8/10｜上坂様より、電話にてりんごを3個受け付けました 20010/8/10｜木村様より、電話にてももを3個受け付けました --------------------------- ---------------------------T品目 検索文字 もも大 りんご もも --------------------------- ↓ ---------------------------クエリ 年月日｜品目情報 | 検索文字 20010/8/10｜武田様より、口頭にてもも大を53個受け付けました｜もも大 20010/8/10｜上坂様より、電話にてりんごを3個受け付けました｜りんご 20010/8/10｜木村様より、電話にてももを3個受け付けました｜もも --------------------------- このようなクエリ結果を望んでおります。文章の中から商品名を抜き出し、その抜き出した商品に価格をひもづけたいのです。このようなことをクエリで行えますでしょうか？
お世話になります。 Where句のCase文でお尋ねしたいことがあります。 ----------------------------------------------------- WHERE (A = @A) AND (B = @B) AND (C = @C) AND CASE WHEN @D = 0 THEN (dbo.TEST.D = dbo.TEST.D) '全データを WHEN @D = 1 THEN (dbo.TEST.D = 1) '値が1のデータを WHEN @D = 2 THEN (dbo.TEST.D = Is Null) 'データがNull のものを END AND (E = @E) AND (F = @F) AND (G = @G) AND (H = @H) AND CASE WHEN @I = 0 THEN (dbo.TEST.I = dbo.TEST.I) WHEN @I = 1 THEN (dbo.TEST.I = 1) WHEN @I = 2 THEN (dbo.TEST.I = Is Null) END AND (J = @J) ........ ........ ----------------------------------------------------- 上記のように CASE 文で　パラメータの値により条件を変えたいのですが、なかなかうまくいきません。こんな記述の仕方ではダメということは薄々わかっているのですが、このようなCASE文をうまく動作させるにはどのように記述すればいいでしょうか？ よろしくお願いいたします。
http://okwave.jp/qa/q8247435.html 　以上のトラブルの経緯がありまして・・ 次に出たのが以下のエラーです。 XAMPP Control Panel v3.2.1ですが 　気になることがあります。 　以下[Apache]の項目のほとんどが赤文字です。 　これって何か”ヤバイ”ことなのでしょうか!!?? 　よろしくお願いします。 3:32:31 [main] Initializing Control Panel 3:32:31 [main] Windows Version: Windows 7 Ultimate SP1 64-bit 3:32:31 [main] XAMPP Version: 1.8.2 3:32:31 [main] Control Panel Version: 3.2.1 [ Compiled: May 7th 2013 ] 3:32:31 [main] Running with Administrator rights - good! 3:32:31 [main] XAMPP Installation Directory: "c:\xampp\" 3:32:31 [main] Checking for prerequisites 3:32:59 [main] All prerequisites found 3:32:59 [main] Initializing Modules 3:32:59 [Apache] Problem detected! 3:32:59 [Apache] Port 80 in use by ""c:\xampp\apache\bin\httpd.exe" -k runservice" with PID 1108! 3:32:59 [Apache] Apache WILL NOT start without the configured ports free! 3:32:59 [Apache] You need to uninstall/disable/reconfigure the blocking application 3:32:59 [Apache] or reconfigure Apache and the Control Panel to listen on a different port 3:32:59 [Apache] Problem detected! 3:32:59 [Apache] Port 443 in use by ""c:\xampp\apache\bin\httpd.exe" -k runservice" with PID 1108! 3:32:59 [Apache] Apache WILL NOT start without the configured ports free! 3:32:59 [Apache] You need to uninstall/disable/reconfigure the blocking application 3:32:59 [Apache] or reconfigure Apache and the Control Panel to listen on a different port 3:32:59 [mysql] XAMPP MySQL Service is already running on port 3306 3:32:59 [main] Starting Check-Timer 3:32:59 [main] Control Panel Ready 3:33:10 [Apache] Installing service... 3:33:14 [Apache] Problem detected! 3:33:14 [Apache] Port 80 in use by ""c:\xampp\apache\bin\httpd.exe" -k runservice" with PID 1108! 3:33:14 [Apache] Apache WILL NOT start without the configured ports free! 3:33:14 [Apache] You need to uninstall/disable/reconfigure the blocking application 3:33:14 [Apache] or reconfigure Apache and the Control Panel to listen on a different port 3:33:14 [Apache] Problem detected! 3:33:14 [Apache] Port 443 in use by ""c:\xampp\apache\bin\httpd.exe" -k runservice" with PID 1108! 3:33:14 [Apache] Apache WILL NOT start without the configured ports free! 3:33:14 [Apache] You need to uninstall/disable/reconfigure the blocking application 3:33:14 [Apache] or reconfigure Apache and the Control Panel to listen on a different port 3:33:14 [Apache] Attempting to start Apache app... 3:33:26 [Apache] Installing service... 3:33:27 [Apache] Successful! 3:33:27 [Apache] Successful! 3:33:28 [Apache] Status change detected: running
Windows7 環境で SQL Server 2008 Express を インストールしたのですが、saでログインできませんでした。 インストール時の認証モードには「混合モード」を選択しました。 自分なりに調べた結果、 『windows認証でログイン後、［オブジェクトエクスプローラ］の ［セキュリティ］－［ログイン］より「sa」アカウントを選択して［プロパティ］を開き、 「sa」のログインを「有効にする」』 とあったので試したところ、「エラー：15151」が発生し、変更できませんでした。 関係ないかもしれませんが、 「BUILTIN\Users」に「sysadmin」ロールを付与しようとしても、 「エラー：15247」でできませんでした。 どうすれば『「sa」のログインを「有効にする」』ことができるのでしょうか。 どなたか、ご教示宜しくお願いいたします。
現在IDを主キーとするデータが有り、複数のデータをまとめて書き換える際、 一時テーブルにIDと変更内容を用意しておいて、UPDATE と INNER JOIN を用いて 一気に書き換える予定です。 更新そのものはこれで問題ないのですが、その際に一時テーブルに無いレコードは削除したいのですがどうすればいいのでしょうか？ 参考： http://qiita.com/masuidrive/items/0671ea7efa91a9 …
ALTER TABLEの処理が全然終わらなくなってしまったので、質問させて下さい。 下記のような状態です。 ・テーブルの行数は962362 ・topコマンドで見たとき、普段mysqldのCPU使用率が50～100%なのですが、ALTER TABLE後に確認すると2%前後になる ・試した処理はdrop indexとadd column ・mysqlを再起動しようにもstopするのに数分かかる ・nginxを一度stopし、負荷の少ない状態でも同じことを試しましたが結果はかわりませんでした ・検索してみると、key_buffer_sizeが少なすぎることが原因という記事をみかけたので、試しにkey_buffer=512Mとして、設定を読み込み直してから試してみましたが結果はかわりませんでした このような場合の原因と対策を教えて頂ければ幸いです。 足りていない情報は随時補足させていただきます。 是非回答宜しくお願い致します。
4GBのSD系カードの購入を考えているのですが同じメーカー、同じ容量、同じ転送速度のSDカードとSDHCカードがありました。 この場合のSDカードとSDHCカードの違いって何なんでしょう？ 使用目的は主にデジカメラのです。 どちらにどのようなメリットがあるのでしょう？ また、4GBのSDカードはSDHCと同じFAT32だそうですがこれはSDHCに対応していないと結局使えないのでしょうか。そして、FAT16にフォーマットすることによってどちらも2GBのSDカードとして使うことも可能なのでしょうか？ 質問がたくさんになってしまいましたがどなたかご存知の方どうかよろしくお願いします。 http://www.amazon.co.jp/dp/B00A2IJPAG
アクセスの使い方で、スタンドアロン形式と、それに対するのは、何形式でしたっけ？
環境は PHP5.3.3 MySQL5.0.95 です。 現在TBL1にURL(address)と、そのURLのタイトルタグの中身(title)と、独自に数えてる数字(count)を入れています。 その1つのアドレスに対してcountの数は色々あるので、 そのcountをアドレスと対にして合計したもの(SUM)で並び替えています。 (分かりづらかったらすいません。addressは主キーではないということです。) タイトルに関しては最近取得し始めたところで入ってるところと入っていないところがあります。 その状況下で SELECT address, title, sum(count) as SUM FROM TBL1 where address LIKE "%hoge.com%" group by address order by sum DESC LIMIT 10; こういうSQL文を使ってSELECTした際に、 hoge.com以下の例えばhoge.com/1.html,　hoge.com/2.html, ... といった感じのURLごとにSUMの数で並び変わるのですが この場合titleはどのカラムを参照していることになるのですか？ (address) (title) (SUM) hoge.com/1.html | test1 | 500 | hoge.com/2.html | test2 | 400 | hoge.com/3.html |　　　　| 300 | hoge.com/4.html | test4 | 200 | hoge.com/5.html | test5 | 100 | hoge.com/6.html |　　　　| 40 | hoge.com/7.html | test7 | 20 | hoge.com/8.html |　　　　| 10 | hoge.com/9.html |　　　　| 6 | hoge.com/10.html |　　　 | 5 | こんな結果だったとして、titleが入っているものと入っていないものの区別がつきません。 入っていないURL(例えばhoge.com/3.html)のaddressカラムも全て空というわけではありません。 逆に入っているものに関しては、全ての行にtitleが入っているわけではありません。 主キーは今回のSELECTとは関係してない"ID"です。 ID | address | count | title 1 | hoge.com/1.html | 3 | test1 2 | hoge.com/1.html | 10 | 3 | hoge.com/1.html | 43 | test1 ID | address | count | title 1 | hoge.com/3.html | 4 | test3 2 | hoge.com/3.html | 3 | 3 | hoge.com/3.html | 42 | それぞれは主キーに応じてcountが個別にある状態です。 上記は正確ではありませんが、こんな感じです。 こうして共に入ったり入ってなかったりするのにSELECTした結果に 入ってるものと入ってないものが出てくるのが分かりません。 ちなみに、検証すると一番countが多い行にtitleが入っていたらSELECT文にも出てくるというわけではないようです。 なぜtitleが出るものと出ないものがあるのでしょう？ ご教授宜しく御願い致します。
パススルークエリーを使ってAccess 2007 から SQL Server 2008 上のデーターに追加したいのですが、パススルークエリーが読取り専用のため何もできません。パススルークエリーは、Microsoft のサポートにあるとおりに作成しました。SQL欄には Select * from T_Data　とのみ記述しただけですので、このクエリ (Q_Data)　はSQLServer にあるテーブルのすべてを表示しています。 以下のように記述しましたが、何ともなりません。 Private Sub cmd_追加_Click() Dim db As DAO.Database Dim rs As DAO.Recordset Set db = CurrentDb() Set rs = db.OpenRecordset("Q_Data", dbOpenDynaset) rs.AddNew rs!カテゴリー = Me!txt_カテゴリー rs!商品名 = Me!txt_商品名 rs.Update MsgBox ("追加しました") rs.Close: Set rs = Nothing cn.Close: Set cn = Nothing End Sub この場合のQ_Dataには加工ができないのでしょうか？　追加、更新ごとにパススルーを新たに作成する必要があるのでしょうか？　ご指導をお待ちしております。
SQLのSelect文である期間を日別に出力したいのですが、どのようにすればいいのでしょうか テーブルのデータは期間全部が入っているのではなく。 データが存在しない日もあります。 データが存在しない日は日にちをのぞいて空白になるようにしたいです。 例として、 テーブル上のデータ 2013-08-01　　ああああ 2013-08-03　　いいいい 2013-08-06　　うううう 出力したいデータ　期間2013-08-01～2013-08-10 2013-08-01　　ああああ 2013-08-02 2013-08-03　　いいいい 2013-08-04 2013-08-05 2013-08-06　　うううう 2013-08-07 2013-08-08 2013-08-09 2013-08-10 上記のような形で出力したいのですが、 どのようにすればいいのでしょうか http://bitstar.jp/blog/?p=2468 のように別のテーブルを用意する以外のやり方でお願いします。 よろしくお願いいたします。
宜しくお願い致します。 本社（大阪：50名）、拠点（兵庫：30名）、拠点（東京：20名）で ベストエフォート１００ＭのＩＰ－ＶＰＮを使用しております。 受注管理システムはSQL Server2005とVB.NETの構成で SQL Serverは本社（大阪）にあります。 パッケージではなく自社向けに委託開発したものです。 この状態で業務システムを利用するにあたり 各拠点（兵庫、東京）での受注管理システムのレスポンスが本社（大阪）とを比較するとかなり遅いという不具合報告が挙がりました。 処理によって違いはありますが 本社で数秒の処理が拠点では数十秒（倍以上）かかるとのことでした。 （顧客検索や受注登録に本社で処理するより時間がかかる） このため、対策としてネットワークを太く安定するようにしようという案が出ました。 ＶＰＮをベストエフォートではなくギャランティ（本社１００Ｍ、拠点５０Ｍ）に変更する改善案です。 しかしながら打合せが進むにつれ、 ＶＰＮの改善だけでは期待する効果（本社並のレスポンス）は約束できないという話になってきました。 効果は出ると思うがLANで使用するレスポンスは保障できない。 理由としてSQLがWAN越えに対応していないためとＶＰＮの業者さんは言っています。 （SQLは、WAN越えの場合に遅延し易いとのこと。やってみないとわからないとＶＰＮ業者さん） そんな中、現状のシステムのレスポンスを改善するにはＶＰＮの変更と併せて 下記1～4の改善候補が挙がっています。 1.業務システムをターミナルサーバーにより運用する （良いと思いますが費用が高そうです。また現状の業務システムをそのまま使用できるかが気になります。業務システムに手を加えなくても対応可能だとうれしい。効果が確実なら候補として検討したい） 2.Ｗｅｂ系のシステムに業務システムをリプレースする （良いと思いますが、VB.netのシステムをASP.net等で開発し直さないといけなくなる。効果が確実なら候補として検討したい） 3.メタフレーム 1と同じようなシステムでしょうか？ 4.SQL Serverを各拠点に立て、ミラーリングする （マスタや採番は一元化管理が必要です。データの整合性を保つのが困難な印象で、 4より1か2か3の方が良いシステム構成かと思います） 1～3はたくさんのデータにアクセスするよりも、 データを持っているサーバーで処理させて画面を飛ばした方が効果的という考え方かと思います。 大きな企業さんは1～3が多いと思いますが、お付き合いが無くわかりません。 （現状システムを２年前に開発してくれた委託開発先のベンダーさんも相談しましたが、今回のような課題解決の実績は無く、目標とするレスポンスを実現する提案をいただくことは難しいとのこと。 現状システム構築時はWAN越えでの拠点使用もできるようにはしていたがレスポンスまでは深く考えられていなかったようです。ＤＢ一元化の効果はあるので統合前に戻すことは考えていません） 長くなりすみません。 質問ですが、弊社のようなＶＰＮ越しの拠点間の運用で 各拠点のレスポンスを本社と同等に早くしたい場合には どのような課題解決が良いでしょうか？ 弊社にマッチする具体的な改善案とそれにかかるおおまかな費用感、難易度も併せて教えて頂けるとありがたいです。 宜しくお願い致します。
SQL初心者です。 教えてください。 A表とB表があります。 A表の伝票Noの列の値とB表の伝票Noの列の値はイコールです。 判定はB表のある別のカラム(sample)と変数Zに格納されている値がイコールという 条件で合致するA表のデータを抽出したいです。 LEFT JOINもしくはINNER JOINなどを使って書けば良いのでしょうか？ 例えば SELECT * from A表 INNERJOIN B表 on A表.伝票No = B表.伝票No where B表.sample = 変数Z などと書けば良いのでしょうか？
あるテーブルtable01にname列があったとします。 その列に ”様"　をつけたいと思い、concat文を使おうと思い、 以下のようにしたのですが、 mysql> Select concat(name,"様") from table01; +-------------------+ | concat(name,"様") | +-------------------+ | ito様 | | sato様 | | aikawa様 | | abe様 | | yamada様 | +-------------------+ 5 rows in set (0.00 sec) 列名もconcat(name,"様")となってしまっていますが、　As nameを使う以外に nameとだけ表示させる方法はありますか？
アクセスでテキストデータを取り込む際についてご質問がございます。 アクセス2010については、現在取り扱っている文字コードUTF8の テキストデータ及びCSVに関してはすべて取り込めるのですが アクセス2007に関してだけ取り込めないデータがあります。 その場合のエラーメッセージですが テキストインポートウィザード ExecuteTempImexSpec'メソッドは失敗しました'_WizHook'オブジェクト と表示され OKボタンを押すと インポートするときにエラーが発生しました。ファイルはインポートされませんでした と表示されます。 □□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□ そのデータをそのままアクセス2010で対応するとインポート出来ます。 □□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□ 話を整理させて頂きます アクセス2010 現在取り扱っている文字コードUTF8の テキストデータ及びCSVに関してはすべて取り込めます アクセス2007 現在取り扱っている文字コードUTF8の テキストデータ及びCSVに関して 取り込めないデータもあります ※因みにアクセス2007に関してはネット環境がありませんので ソフトやPCはアップデートはされません。 この現象についてなにか心当たりある方はいらっしゃいますか？ どうぞよろしくお願いいたします。
お世話になります。 Access2000で教えてください。 下記のようなテーブル1,2があります。 このテーブル1,2をひっつけて、 テーブル3を作成したいのですが、 どのように作成すればよいでしょうか？ 可能でしたら、クエリで、 説明しやすいのでしたら、SQLでも 結構ですので宜しくお願い致します。 ----------------------------------- テーブル1 名前　　1着数 やまだ　3 ----------------------------------- テーブル2 名前　2着数 やまだ　１ ----------------------------------- テーブル3 名前　1,2着数 やまだ　4
topコマンドで見た時にいつもmysqldのCPU使用率が300前後になっています 改善方法など全くといっていいほどわからないのですが、まずslow-logを覗いてみたところ SELECT `a_id`, `b_id`, `hoge` FROM `table1` WHERE `a_id` IN (10,27,37,38,46,47,51,69,73,82,86,90,103,110,125,129,134,135,136,137,139,142,148,150,161,168,181,184,187,191,192,198,200,206,215,222,230,231,249,264,266,270,271,302,315,338,342,349,360,361,366,376,383,385,399,405,406,410,412,424,427,432,438,444,454,456,457,462,480,483,484,487,488,492,493,494,506,509,517,549,559,573,574,578,579,586,587,594,597,599,609,612,617,619,625,629,632,633,637,642,646,679,681,684,687,688,689,691,692,696,698,699,700,708,716,738,739,740,742 ,755,758,764,767,768,772,774,778,780,782,783,786,787,792,793,795,796,799,802,807,808,810,811,815,816,817,819,821,823,826,827,828,829,831,833,834,839,840,841,846,849,854,855,856,857,858,859,860,861,864,872,879,881,882,884,888,890,892,893,894,896,899,907) ORDER BY `updatetime` DESC LIMIT 0, 100; このようなクエリが1秒以上かかっていました。 `table1`と`table2`は`a_id`で紐付いていて、事前に`table2`に入っているa_idの一覧を取得してから上記のクエリを作成しています。 `table1`のスキーマを確認したところ INDEX a_id(`a_id`) INDEX updatetime(`updatetime`) となっていました。 （素人ながらに INDEX idx1(`a_id`, `updatetime`) とするべきだったのでは…と思ったのですがALTER TABLEで追加してみたところ、結果は変わりませんでした。） EXPLAINしてみたところ 1 | SIMPLE | feed | range | a_id,i1 | a_id | 5 | NULL | 237900 | Using where; Using filesort と返ってきました。 このような状態では、どのように対策するのが良いのでしょうか。 決まった正解はないのかもしれないですが、考えられる可能性で試すべき項目を教えて頂ければ幸いです。 ・table2のidに紐付いたtable1の情報を取り出したい場合の適切な設計 ・適切なSQL文 ・適切なインデックスの貼り方 などをご教授いただけると嬉しいです。 21時～0時くらいの時間帯になるとアクセスが増えload averageが10前後になってしまい、いつサーバーが落ちるかとヒヤヒヤしています… 是非ご回答宜しくお願い致します。
access2010を使用していますがテーブル・クエリ共に日付/時刻型のフィールドでソートすると　指定した`|`は正しくありません。　と出てソートが出来ません。 テキスト型は問題なくできます。 新規にデータベースのファイルを作成しても同じエラーがでます。 何か原因があるのでしょうか？
いつもお世話になっております。 今回、お伺いしたいのは Access｀２００２を使用しているのですが、 データを落として保存されたエクセルファイルをインポート元にして AccessDBにインポートした際にエラーが発生しました。 インポート先はAccessのテーブルで全てテキスト型にしているのですが、 インポートした際に、同じ列の数字のものはインポートされているのですが、 アルファベットが入っている列のものがエラーとなって外に出されてしまいます。 私としましては、全てテキスト型で空文字受付状態であれば、 全てインポートされる物だと思っていたのですが、 エラーになってしまいます。 何か対処方法などご存知方、お教え頂きたくおもいます。 どうぞよろしくお願い致します。
はじめまして。 以下の環境で、インストールしてます。 物理マシン OS MS Windows 7 Home Premium 64-bit SP1 CPU Intel Processor @ 3.40GHz 8コア メモリー　16GB 仮想環境 VMware Workstation 9 仮想マシン Centos5.9(32bit) CPU 1コア メモリー 6GB データベース環境 Oracle10g Release 1 (10.1.0.2)　32bit 上記の環境で、仮想マシン上に行っています。 Oracle EnterPrise Manager Grid Contorol インストール途中で、RAM不足になります。 エラーメッセージは、下記のとおりです。 システムには現在5MBのRAMがあります。EnterpriseManager using an existing database インストールでは、少なくとも512MBの物理メモリーが必要です。 この環境では、インストールはできないでしょうか。 色々調べていたのですが、わからなかったので、アドバイスを頂けると幸いです。 よろしくお願いいたします。 vmstat -a procs -----------memory---------- ---swap-- -----io---- --system-- -----cpu------ r b swpd free inact active si so bi bo in cs us sy id wa st 0 0 0 5469796 454856 266152 0 0 136 50 1018 264 1 1 97 1 0 cat /proc/meminfo MemTotal: 6228356 kB MemFree: 5469672 kB Buffers: 36180 kB Cached: 510864 kB SwapCached: 0 kB Active: 266264 kB Inactive: 454808 kB HighTotal: 5373888 kB HighFree: 4675384 kB LowTotal: 854468 kB LowFree: 794288 kB SwapTotal: 6289436 kB SwapFree: 6289436 kB Dirty: 36 kB Writeback: 0 kB AnonPages: 173992 kB Mapped: 72576 kB Slab: 20932 kB PageTables: 5408 kB NFS_Unstable: 0 kB Bounce: 0 kB CommitLimit: 9403612 kB Committed_AS: 533940 kB VmallocTotal: 116728 kB VmallocUsed: 8396 kB VmallocChunk: 108172 kB HugePages_Total: 0 HugePages_Free: 0 HugePages_Rsvd: 0 Hugepagesize: 2048 kB sysctl -p net.ipv4.ip_forward = 0 net.ipv4.conf.default.rp_filter = 1 net.ipv4.conf.default.accept_source_route = 0 kernel.sysrq = 0 kernel.core_uses_pid = 1 net.ipv4.tcp_syncookies = 1 kernel.msgmnb = 65536 kernel.msgmax = 65536 kernel.shmmax = 4294967295 kernel.shmall = 268435456 net.ipv4.ip_local_port_range = 9000 65500 fs.file-max = 6815744 kernel.sem = 250 32000 100 128 kernel.shmmni = 4096 net.core.rmem_default = 262144 net.core.wmem_default = 262144 net.core.rmem_max = 4194304 net.core.wmem_max = 1048576 fs.aio-max-nr = 1048576 以上、よろしくお願いいたします。
下記クエリが一つあります。 [Q_商品] ID 商品名 価格 色 サイズ 重さ 送料 備考 [Q_商品]から、[T_テスト]をテーブルの作成から作りました。 [T_テスト]は、毎回利用する時に、すべてデリートして、[Q_商品]のデータを追加したいです。 [T_テスト]のデータの、すべてデリートは下記VBAでできました。 Private Sub コマンド40_Click() 'システムメッセージの非表示 DoCmd.SetWarnings False DoCmd.RunSQL "DELETE FROM T_テスト" 'システムメッセージの表示 DoCmd.SetWarnings True End Sub [Q_商品]のデータを追加するVBAを教えて下さい。 よろしくお願い致します。
Accessは全くの初心者です。 プログラマーさんのサイトや質問サイトを参考に、初めてデータベースを作っているのですが、 どうしても文字＋年ごとの自動採番がうまくいきません。 挿入前処理で「営250001」のように漢字1文字＋和暦2桁＋4桁連番にして、 年が変わるごとに4桁連番を0001に戻したいのです。 今入力してあるコードは以下の通りです。 ----------------------------------------------------------------------------- Private Sub Form_BeforeInsert(Cancel As Integer) 　Dim vDt As Variant 　vDt = DMax("番号", "営テーブル", "番号 Like '" & Format(Date, "ee") & "*'") 　If (IsNull(vDt)) Then 　　番号 = "営" & Format(Date, "ee") & "0001" 　Else 　　番号 = "営" & Left(vDt, 2) & Format(Val(Right(vDt, 4)) + 1, "0000") 　End If End Sub ----------------------------------------------------------------------------- この状態では、0001のまま採番が進まず、行き詰ってしまいました。 他の質問者さんが(Date,"ee")を(Now,"nn")に置き換えて、分ごとの採番を試していたのを参考に、 「"営"&」を取って、採番が進むところまでは確認できました。 使っているのはAccess2003です。 どうか、よろしくお願いします。
MySQLでWhere句の書き方で苦戦しています。 以下のuser_table（オーダー)が来たときに、スタッフが用意すべき数量を商品ごとに抽出するSQLを書いています。 Where句の書き方が思いつきません。ご指導をお願いいたします。 user_table (name) (product) (user_volume) takada | pro_001 | 500 | takada | pro_002 | 100 | matuda | pro_003 | 400 | kawase | pro_001 | 200 | yosida | pro_001 | 500 | tanaka | pro_001 | 300 | tanaka | pro_002 | 500 | tanaka | pro_003 | 300 | 作りたいテーブル(SQLの結果) total_table (id)(product_name)(total_volume) staff | pro_001 | 1500 | staff | pro_002 | 600 | staff | pro_003 | 700 | 途中まで作って断念したSQL INSERT INTO total_table (id ,product_name,total_volume) SELECT 'staff',product,SUM(user_volume) FROM user_table WHERE ・・・;
お世話になります。拙い文面ではありますがよろしくお願いいたします。 Vista ACCESS2010を使用しています。 下記SQLで2個のテーブルを外部結合していますが、テーブルの一方で結合で使用しているフィールドの桁が変更になり、テキスト型のフィールドを0埋めして外部結合しようとしています。フィールドを関数で桁揃えして結合キーとして使用することはできないものでしょうか。 ---売上金額---------- 対象月　テキスト型 商品ID　テキスト型 商品名　テキスト型 支店CD　テキスト型 金額　　通貨型 支店CD　3ケタ→5ケタへ変更 ---支店マスタ-------- 支店CD　テキスト型 支店名　テキスト型 支店ソート番号　数値型 支店CD　3ケタ・・・売上金額の支店CD変更に伴い、Format等で5ケタへ変更したい ---変更前----- SELECT a.商品ID,a.商品名,a.支店CD,b.支店名,b.支店ソート番号,a.金額 FROM　売上金額 a　LEFT　JOIN　支店マスタ b ON　a.支店CD　=　b.支店CD WHERE　a.対象月　>=#2013/04/01#　AND　a.対象月 <=#2013/07/31# GROUP BY a.商品ID,a.商品名,a.支店CD,b.支店名,b.支店ソート番号,a.金額 ---以下へ変更--- SELECT a.商品ID,a.商品名,Format([支店CD],"00000"),a.支店名,支店ソート番号,a.金額 FROM　売上金額 a　LEFT　JOIN　支店マスタ b ON　a.支店CD　=　b.支店CD　　　 WHERE　a.対象月　>=#2013/04/01#　AND　a.対象月<=#2013/07/31# GROUP BY a.商品ID,a.商品名,Format([支店CD],"00000"),a.支店名,b.支店ソート番号,a.金額 変更後の　ON以下を次のように変更するとJOINでサポートされていませんのエラーとなります。 ON　Format([a.支店CD],"00000")　=　b.支店名　 都合上フィールドとテーブル名は変更していますがそれ以外は変わりません。 よろしくお願いいたします。
お世話になっております。 WHERE文に関して、少々分からない事が出てきたため質問させて下さい。 id　mail　name　・・・・ 現在、上記のようなカラムを持つmemberというテーブルがあり、このテーブルにあるメンバー向けにメールマガジンを配信しております。 今回、メールマガジンの配信の停止を求められたのですが、色々なタイプのメールマガジンを配信しており、その１つだけを停止を求められたので配信停止依頼のあった者だけを no　no_id　no_mail といったようなテーブル（no_magazine)を設置し、配信の停止を求めてきた方のidと、mailを、上記テーブルに登録する流れを考えました。 そこで質問です。 配信停止を求めてきた方だけを、no_magazineテーブルに入れ、memberとno_magazineをLEFT JOINして問合わせを考えておりますが、このように、no_magazineにデータがない方だけに配信をしようとした場合、どのようなWHERE文になるのでしょうか？ no_magazineにデータがある方だけに送るのは簡単ですが、データがない方だけに送るケースが判らずに質問させて頂きました。 色々と試行錯誤しているのですが、どれも上手くいかなくて・・・ お忙しいなか恐縮ですが、アドバイスのほど頂戴出来れば幸いです。 宜しくお願い申し上げます。
mysqlで検索した結果に対して 同一テーブルの他のカラムに共通の文字列を書き込みたいです。 たとえば、 SQLで検索した結果に対して、対象レコードの「price」の項目に 「300」の文字列を登録するイメージです。 例： 元のレコード name　　　price りんご みかん なし 「ん」で対象レコードを検索した結果イメージ： name　　　price りんご みかん このとき、「ん」に該当する「price」のカラムに 「300」と値段を登録したいです。 理想の処理結果のイメージ： name　　　　price りんご300 みかん300 お手数ですが、アドバイスよろしくお願いします。
環境 PostgreSQL 9.2 下記のようなテーブル[TABLE_A]の行（text） を順繰り上から引用してセレクト文の変数として使用するような関数を作成したいです。 やりたいこととしては一つ一つセレクト文を書いて出力を確認するのが無理な量な場合に作業を軽減したいです。 [TABLE_A] hogehoge_a hogehoge_b hogehoge_c ... hogehoge_xx SELECT "hogehoge_a" FROM TABLE_A; ハマってしまいなかなかうまく行きません。お願いします。
こんにちは　shohei3728と申します。 会社にてoracleのシステムの一部を担当している者です。 現在、顧客先に導入しているシステムにて、エラーが発生し困っております。 知恵をお借りしたくこちらに相談させて頂きます。 具体的には下記の現象が発生しております。 ----------------------------------------------------------- バッチ処理にて下記のoracleのimportを行うと下記のエラーが発生しました。 imp user/password@sid file=filename full=y imp-00002:読み取り用のfilenameのopenに失敗しました。 インポート・ファイル：EXPDAT.DMP　> ----------------------------------------------------------- また、現状わかっている内容は以下になります。 ・ファイルはバッチと同じ階層にあり、パスが間違っている事はありませんでした。 ・oracle9i cl と　oracle 10g express　editionの同居 ・windows XP(32bit) 遠方の顧客なため、実際のコンソールを操作する事は難しいです。 （現状わかっている情報は顧客に電話にて操作して貰った内容になります。） 質問内容のレベルは低いかもしれませんが、顧客先にてトラブルが発生しているため、 藁をも掴む思いで書かせて頂いています。 当方の技術レベルもそこまで高くないので、噛み砕いてご助言いただければ幸いです。 ご教授の程、よろしくお願い致します。
access2003からaccess2010にアップグレードしたところaccessのイベントプロシージャの一部が発生しなくなりました。 例えば「フォーカス喪失時」 ボタンの「クリック時」は機能しますが、項目の「変更時」、「更新後処理」は使えなくなりました。 どなたか対処方法をご存知でしたら、教えてください。
こんにちは。データベースの勉強を始めて間もない者です。 例えば、ある中学校の１つのクラスの振る舞いを、ER図で表現することを考えます。各生徒をあらわす「生徒」テーブルを作ります。主キーは出席番号とします。 主キー以外には、名前、生年月日、得意科目、、、などを入れるのですが、「ライバル」という属性も入れたいと思います。自分（今、対象としている生徒）から見てライバルだと思うクラスメイトにあたるものです。 生徒によっては０人だったり多数だったりするので、「生徒」テーブルから出し、「ライバル」テーブルを作り、「生徒」：「ライバル」＝１：０以上のリレーションをはります。「ライバル」テーブルの主キーは親の生徒の出席番号（外部キー）とライバルだと思われた生徒の出席番号のペアでいいや、と思ったのですが、ここで問題に気づきました。 出席番号１さんがライバルだと思っているのが、出席番号３さん、５さんとします。３さんは１さんのことをライバルと思っていませんが、５さんは１さんのことをライバルだと思っています。この時の「ライバル」テーブルは、主キーに１と５のペアを持つレコードが２つできてしまって問題になるのでしょうか？それとも、外部キーが異なるので問題はないのでしょうか？ 問題があるとすると、どのようにテーブルを定義すればよいのでしょうか。さっきの例では「ライバル」テーブルに１と３のペアをキーとするレコードが１つできますが、これも「１から３へ」という意味が消えないような設計をしたいのですが、よくわからなくなりました。
帳票形式フォームの参照整合性設定された表形式サブフォームから全レコードを削除する為、下記のモジュールを作成しました。しかし、実行すると「28：スタック領域が不足しています。」のエラー表示でフリーズ状態となってしまいます。エラーとなるのは毎回ではありません。原因と回避方法をご教示下さい。 連鎖削除設定して主レコードを削除する方法しかないのでしょうか？ On Error GoTo Err_削除_Click Dim MyAnswer As Variant, MyRs As DAO.Recordset Set MyRs = Me.SubForm.Form.Recordset MyRs.MoveFirst Do Until MyRs.EOF MyRs.Delete MyRs.MoveNext　'ここでエラーとなります。 Loop Recovery_削除_Click: Set MyRs = Nothing Exit_削除_Click: Exit Sub Err_削除_Click: If Err.Number = 3021 Then Resume Recovery_削除_Click Else MsgBox Err.Number & ":" & Err.Description Resume Exit_削除_Click End If
お世話になります。 Access2000を使用しています。 フィールド：温度という項目があり、その 順にソートしたいと思っています。 しかしながら、下記の様に2.0℃が が一番下に並ばされてしまいます。 どのようにすれば、2.0℃が 一番上にくるようにソートできるでしょうか？ できれば、SQLではなく、クエリ画面で 設定したいので、ご存じの方 リンク先でも結構ですのでおしえてください。 宜しくお願い致します。 -------------------------------------------- 名前 2.0℃ 25.0℃ 23.0℃ 27.0℃ ソート結果 23.0℃ 25.0℃ 27.0℃ 2.0℃
ADODB6.1を使用し"smp2013*.xls"の"Sheet1"の列から"済"の数をカウントしたいのですが 列名に改行コード[ALT＋Enter]があり、うまく取得できません。お助け下さい。 下記コードでは"0"と表示されます。(※エラー処理等は記述しておりません。) PC:Win7pro 64bit、Excel2010 32bit Sub smp_1() Dim myCon As New ADODB.Connection, myRS As New ADODB.Recordset, FileName As String Dim j As String, i As Integer Dim val_day As String val_day = "\\share01\12345\" FileName = Dir$("\\share01\12345\smp2013*.xls") myCon.Open "Provider=Microsoft.ACE.OLEDB.12.0;Extended Properties=Excel 12.0;" & _ "Data Source=" & val_day & FileName j = "select count(*) from [Sheet1$] where ""H24"" & Chr(10) & ""決済"" = '済';" 　'←ここです。 myRS.Open j, myCon Worksheets(1).Range("A1").CopyFromRecordset myRS myRS.Close Set myRS = Nothing myCon.Close Set myCon = Nothing End Sub
Apache2.2をアンインストールしたいのですがどうしたらできますか！？ OSはWindpws7です。 　なぜか！”アプリケーションの追加と削除”には存在しません 　よろしくお願いします。
PHPのforeachでSQL文を処理しても良いか教えてください。 ・foreachループの中でSQLを書いているのですが、なるべくしない方がよいのでしょうか？ (一般的な書き方ではない？) ・MySQLで代替する書き方はあるでしょうか？ ・もし代替する書き方がなくてforeach文を使う場合、SQL文が長くてもクエリ数が少ない書き方の方がよいのでしょうか？
access97のdbをaccess2003のdbに変換したく、その方法を知りたいのですが... 但し、その手順をバッチファイルに記述し、そのバッチファイルを開くことによりその手順を自動実行したいと思っています。もう少し具体的に言いますとusb diskに格納されているaess97のｄｂの中のtableをacess2003のｄｂに移したいのですが、何か良い方法がありましたらご教授下さい。
　ｐｈｐMｙＡdminでSQLに 　以下の文を入力しました。 　CREATE DATABASE xmas; USE xmas; CREATE TABLE xmastran ( book_id int not null auto_increment, name varchar(30) not null default ' ' , org varchar(50) not null default ' ', addr varchar(80) not null default' ', tel varchar(20) default ' ', mail varchar(40) default ' ', course varchar(30) default ' ', nums integer default 0, PRIMARY KEY (book_id) ) ENGINE=MyISAM DEFAULT CHARSET=utf8; 　以上SQLに入力した文ですが！ 　以下のエラーが出て先に進みません。 　 エラー 実行した SQL: CREATE DATABASE xmas; →　(http://dev.mysql.com/doc/refman/5.5/en/create-da …にリンクされている) MySQL のメッセージ: ドキュメント #1007 - Can't create database 'xmas'; database exists サーバ "127.0.0.1" 上でクエリを実行する: CREATE DATABASE xmas; USE xmas; CREATE TABLE xmastran ( book_id int not null auto_increment, name varchar(30) not null default ' ' , org varchar(50) not null default ' ', addr varchar(80) not null default' ', tel varchar(20) default ' ', mail varchar(40) default ' ', course varchar(30) default ' ', nums integer default 0, PRIMARY KEY (book_id) ) ENGINE=MyISAM DEFAULT CHARSET=utf8; 　　以上ですが、何が原因で進めないか原因を追及中です。 　最近SQLを始めたので、全く見当がつきません。 皆様よろしくお願いします。 　
SQL文でダブルクォートかアポストロフィーか迷っています！？ 　以下のＳＱＬ文の 　name varchar(30) not null default " ,等の 　最後から２番目に　"　ダブルクォートがあります。 　教本を見ながら入力したのですが、' ' アポストロフィーが２個あるようにも見えます。 この場合、どちらが正規でしょうか！ 　 　以下問題のＳＱＬ文です。 　よろしくお願いします。 CREATE DATABASE xmas; USE xmas; book_id int not null auto_increment, name varchar(30) not null default " , org varchar(50) not null default ", addr varchar(80) not null default", tel varchar(20) default ", mail varchar(40) default ", course varchar(30) default ", nums integer default 0, PRIMARY KEY (book_id) ) ENGINE=MyISAM DEFAULT CHARSET=utf8;
SQLite3なんですが、日付データをカラムへ格納せず、日付毎にテーブル作成してデータを格納しているコードがあるのですが、これは一般的なやり方なのでしょうか？ ・一般的なやり方 ・一般的なやり方ではない ・一般的なやり方ではないが、アプリ内容(仕様)によっては普通に起こりうる ■質問背景 ・日付はカラムへ格納するものとばかり思っていました ・ちょっとびっくりしたので、質問してみました
RMANを使用してのバックアップとリカバリの検証 Oracleの知識があまりないので、変な事を聞いているかもしれませんが、 RMANのバックアップとリカバリについて以下の現象について、エラーが解決できずにいます。 ＝＝＝現象＝＝＝ Oracle11g Release2　11.2.0.3（ASM使用） 現在、指定の表領域以外のバックアップ（フルと累積増分）を取得し、累積増分を取得した時点までリカバリを行う検証を行っております。 ※バックアップコマンド ・フル 　backup incremental level = 0 format '+DATA/BACKUP/lv0backup_%U' database TAG 'dbbackup' plus archivelog TAG 'archivebackup' delete all input; ・累積増分 　BACKUP INCREMENTAL LEVEL 1 format '+DATA/BACKUP/lv1backup_%U' CUMULATIVE DATABASE TAG 'dbbackup' PLUS ARCHIVELOG TAG 'archivebackup' DELETE INPUT; RMANの環境構成に以下を設定 他はデフォルトです。 　CONFIGURE CONTROLFILE AUTOBACKUP ON; 　CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '+DATA/BACKUP/CF_%F'; 　CONFIGURE EXCLUDE FOR TABLESPACE 'TBLSP01';←データファイル6 　CONFIGURE EXCLUDE FOR TABLESPACE 'TBLSP02';←データファイル7 この設定で、以下のコマンドで累積増分バックアップを行った時点までリカバリしようとすると、エラーになります。 ～～～～～ RMAN> run{ set until scn = 1069044; restore database; recover database; alter database open; } 実行コマンド: SET until clause restoreが開始されました(開始時間: 13-08-14) チャネル: ORA_DISK_1が割り当てられました チャネルORA_DISK_1: SID=14 インスタンス=orcl_1 デバイス・タイプ=DISK ファイル6はデータベース全体のバックアップから除外されています。 ファイル7はデータベース全体のバックアップから除外されています。 チャネルORA_DISK_1: データファイル・バックアップ・セットのリストアを開始しています チャネルORA_DISK_1: バックアップ・セットからリストアするデータファイルを指定しています チャネルORA_DISK_1: データファイル00001を+DATA/orcl/datafile/system.313.823464749にリストアしています チャネルORA_DISK_1: データファイル00002を+DATA/orcl/datafile/sysaux.323.823464751にリストアしています チャネルORA_DISK_1: データファイル00003を+DATA/orcl/datafile/undotbs1.274.823464751にリストアしています チャネルORA_DISK_1: データファイル00004を+DATA/orcl/datafile/users.286.823464751にリストアしています チャネルORA_DISK_1: データファイル00005を+DATA/orcl/datafile/undotbs2.280.823464985にリストアしています チャネルORA_DISK_1: データファイル00008を+DATA/orcl/datafile/testspace3にリストアしています チャネルORA_DISK_1: バックアップ・ピース+DATA/backup/lv0backup_0ioha718_1_1から読取り中です チャネルORA_DISK_1: ピース・ハンドル=+DATA/backup/lv0backup_0ioha718_1_1 タグ=DBBACKUP チャネルORA_DISK_1: バックアップ・ピース1がリストアされました チャネルORA_DISK_1: リストアが完了しました。経過時間: 00:01:05 以前のバックアップへのフェイルオーバー restoreが完了しました(完了時間: 13-08-14) recoverが開始されました(開始時間: 13-08-14) チャネルORA_DISK_1の使用 RMAN-00571: =========================================================== RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS =============== RMAN-00571: =========================================================== RMAN-03002: recoverコマンドが08/14/2013 20:57:47で失敗しました RMAN-06556: データファイル6は、SCN 1069044より古いバックアップからリストアする必要があります ～～～～～ 私には、なぜバックアップから除外されているデータファイル6に対して「～古いバックアップからリストア～」といったメッセージが出てくるのか理解できていません。 おそらくリカバリで使用するコマンドが誤っているのだと思うのですが、このエラーの解決のヒントなどございましたらご教示ください。 よろしくお願いします。
テーブル：Aがあり、そこに列：甲がある。 CSVデータをテーブル:Bにインポートする。テーブル：Bにも列：甲と同じ規格の列：乙がある。 テーブル:Bのレコードをもとにエクスポート処理を行う際、列：乙の中に列：甲にはないレコードがあった場合、その旨アラートメッセージを表示させたい。 VBAでどのように記述すればいいでしょうか？ 環境：Microsoft Access 2003
教えてください。 MSSQLサーバーのテーブルで最新でInsertした直後に、そのレコードを削除して、 再度Insertした時のIDENTITY列の値はその前にInsertした時に使用された値が 再度使われるのでしょうか？ それとも、一度使われた値は次回以降使わないのでしょうか？ SQLサーバの管理画面にどちらかを選択できる設定があるのでしょうか？ よろしくお願いします。
現在 100万件程ある データから ・date( 作成日時 ) で縛り ・int( 0 から 5 ) の出現数を カウントする 命令を実行しているのですが、どうも下記では効率悪く思われてなりません。 SELECT 　　COUNT( int = 0 OR NULL ) AS r0, 　　COUNT( int = 1 OR NULL ) AS r1, 　　COUNT( int = 2 OR NULL ) AS r2, 　　COUNT( int = 3 OR NULL ) AS r3, 　　COUNT( int = 4 OR NULL ) AS r4 FROM 　　table WHERE 　　date BETWEEN '2013-08-13' AND '2013-08-13' 他に良い方法はないでしょうか。 また ゆくゆくは intの部分を 0 から 5 の固定ではなく 可変( '2013-08-13' にある 数字を調べて それぞれの出現数を 数える ) にしたいとも思っています。 しかし その方法は さっぱり見当もつかないので 合わせて 教えて貰えたら嬉しいです。 宜しくお願いします。
　現代版のXAMPP Control Panel v3.2.1 セットアップしました。 　教本の内容は古くて、xampp-win32-1.7.3.exeとの内容で書かれています。 　 　すると、php.iniのプログラムの中身と教本と書いてあることが違います。 　 　「php.ini」ファイルで795行目あたりですが 　 ; Windows: "\path1;\path2" include_path=".;C:\xampp\php\PEAR" C:\xampp\php\includes" 以上のプログラムで\PEAR"の最後に"ダブルクォーテーション(") で区切られています。 　 しかし、教本には \PEAR;の最後はセミコロン（;）にと印刷されています。 セットアップしたての(")か、教本の（;） どちらが正規でしょうか 　実際のphp.iniが以下で見れます。 最後のアドレスかは、php.iniをZIPで圧縮したファイルが取れます。 参考にされてください。 　http://homepage3.nifty.com/mtaiyo/php.ini http://homepage3.nifty.com/mtaiyo/php.zip
MYSQLで複数のユーザーと、複数のアイテムがあり、アイテムには表示順序を設定できるとします。 レコードの例は次のようになっています。 「ユーザーID / アイテムID /表示順序」 例： ユーザー1 / アイテムA / 1 ユーザー1 / アイテムB / 2 ユーザー1 / アイテムC / 3 表示順序は1から始まる連番で管理されていて、数字の大きなものから順に並びます。 各ユーザーが持つアイテムの種類はバラバラで、何も持っていないユーザーも存在します。 上の例の場合ユーザー1はアイテムABCを持ち、表示順序はCBAです。 そこで、あるユーザーのアイテムの順序を振り直す場合、一度そのユーザーのレコードを全て削除してから新規に振り直そうと思っていますがこのやりかたは正しいでしょうか？ それともUPDATEをうまく使って書き換えるほうがいいのでしょうか？
mysqlのデータの表示順番を変えたいのですが、 思うようにいかず悩んでいます。 例えば、顧客データで　東京在住で入会年月日順の出力をして、 その後に、名古屋在住でID順に出力させたいとします。 下記のように書けば、nagoyaのほうがid順になりません。 考え方が違うのでしょうか？ よろしくお願いします。 SELECT ～ FROM ～ WHERE ～ ORDER BY tokyo,nyukai ASC,nagoya,id ASC,
WordPressを使ってHP制作をしたく思っています。 FTPでうちの会社のサーバーへwordpressの解凍ファイル一式を送り、アクセスすると、データーベース情報を設定する画面になり、ここでつまずいています、 ユーザー名、パスワード等は分かるのですが、データベース名というのが分かりません、 調べてみますとMySQLというものの設定が必要との事ですが、知識等未熟な当方の頭ではどうアクションすればいいのか分かりません。 MyQSLはソフトと言うよりはサーバーの機能のようなものでしょうか、データベースというものがよく分かっておりませんしwebで調べても恥ずかしながらちんぷんかんぷんでありました、 お手数をおかけしますが、解決に向けて分かりやすい説明を頂ければ幸いです。 使ってるPCはMacOS10.6です、
My SQL バージョン5.5です。 学校で習っている時に 追加で、　not nullを設定しようと思い、 modify文を色々試して使いましたが Syntaxのエラーが出て、 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' c_pass not null' at line 1 （※c_pass　はカラム名です） change　型名（桁数）を使うと変更できました。 なぜmodifyなどでは追加変更出来なかったのか、原因がわかる方はいらっしゃいますか？ バージョンの問題ですか？
１年間の天気のデータベースがあるとします。 ７月のデータを抽出し日付でソート、ある日付から、その日と同じ天気が何日続いたかを、SQLで簡単に調べる方法はあるでしょうか？ データベースは、ACCESSのmdb、VBでJETデータベースエンジンを使用していますので、高度なSQL文は使用できないかもしれません。 よろしくお願いします。
アクセスで共有する際、LANケーブルよりクロスケーブルを使ってパソコンをつないだ方が通信速度が速いでしょうか？
Microsoft SQL Server 2012（64-bit）がアンインストールできない コンパネからMicrosoft SQL Server 2012（64-bit）をアンインストールしようとしてるのですが 削除の進行状況の段階で、 タイトル: Microsoft SQL Server 2012 Service Pack 1 セットアップ ------------------------------ 次のエラーが発生しました: A network error occurred while attempting to read from the file: c:\Windows\Installer\sql_bids.msi ヘルプを表示するには http://go.microsoft.com/fwlink?LinkID=20476&Prod … をクリック と言うエラーが発生します。 OKボタンを押してそのまま続けようとすると、 正常に終了しませんでした。となります。 どうすればきちんと削除できますか？ リンク先のヘルプサイトを見てみたのですが、 何を言ってるのかわかりませんでした。
win764bitです。 SQLサーバー２００８をインストールしようとすると、 **************************************************** アプリケーションのコンポーネントで、 ハンドルされていない例外が発生しました。 続行をクリックすると、アプリケーションはこのエラーを無視し、 続行しようとします。 終了をクリックすると、アプリケーションは直ちに終了します。 ************** 例外テキスト ************** System.Configuration.ConfigurationErrorsException: userSettings/Microsoft.SqlServer.Configuration.LandingPage.Properties.Settings のための構成セクション ハンドラを作成中にエラーが発生しました。: ファイルまたはアセンブリ 'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'、またはその依存関係の 1 つが読み込めませんでした。指定されたファイルが見つかりません。 (C:\Users\1\AppData\Local\Microsoft_Corporation\LandingPage.exe_StrongName_ryspccglaxmt4nhllj5z3thycltsvyyx\10.0.0.0\user.config line 5) ---> System.IO.FileNotFoundException: ファイルまたはアセンブリ 'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'、またはその依存関係の 1 つが読み込めませんでした。指定されたファイルが見つかりません。 ファイル名 'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' です。 場所 System.Configuration.TypeUtil.GetTypeWithReflectionPermission(IInternalConfigHost host, String typeString, Boolean throwOnError) 場所 System.Configuration.RuntimeConfigurationRecord.RuntimeConfigurationFactory.Init(RuntimeConfigurationRecord configRecord, FactoryRecord factoryRecord) 場所 System.Configuration.RuntimeConfigurationRecord.RuntimeConfigurationFactory.InitWithRestrictedPermissions(RuntimeConfigurationRecord configRecord, FactoryRecord factoryRecord) 場所 System.Configuration.RuntimeConfigurationRecord.CreateSectionFactory(FactoryRecord factoryRecord) 場所 System.Configuration.BaseConfigurationRecord.FindAndEnsureFactoryRecord(String configKey, Boolean& isRootDeclaredHere) 警告: アセンブリ バインドのログ記録がオフにされています。 アセンブリ バインドのエラー ログを有効にするには、レジストリ値 [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) を 1 に設定してください。 注意: アセンブリ バインドのエラー ログに関連するパフォーマンス ペナルティがあります。 この機能をオフにするには、レジストリ値 [HKLM\Software\Microsoft\Fusion!EnableLog] を削除します。 --- 内部例外スタック トレースの終わり --- 場所 System.Configuration.BaseConfigurationRecord.FindAndEnsureFactoryRecord(String configKey, Boolean& isRootDeclaredHere) 場所 System.Configuration.BaseConfigurationRecord.GetSectionRecursive(String configKey, Boolean getLkg, Boolean checkPermission, Boolean getRuntimeObject, Boolean requestIsHere, Object& result, Object& resultRuntimeObject) 場所 System.Configuration.BaseConfigurationRecord.GetSection(String configKey) 場所 System.Configuration.ClientConfigurationSystem.System.Configuration.Internal.IInternalConfigSystem.GetSection(String sectionName) 場所 System.Configuration.ConfigurationManager.GetSection(String sectionName) 場所 System.Configuration.ClientSettingsStore.ReadSettings(String sectionName, Boolean isUserScoped) 場所 System.Configuration.LocalFileSettingsProvider.GetPropertyValues(SettingsContext context, SettingsPropertyCollection properties) 場所 System.Configuration.SettingsBase.GetPropertiesFromProvider(SettingsProvider provider) 場所 System.Configuration.SettingsBase.GetPropertyValueByName(String propertyName) 場所 System.Configuration.SettingsBase.get_Item(String propertyName) 場所 System.Configuration.ApplicationSettingsBase.GetPropertyValue(String propertyName) 場所 System.Configuration.ApplicationSettingsBase.get_Item(String propertyName) 場所 Microsoft.SqlServer.Configuration.LandingPage.LandingPageForm.OnLoad(EventArgs e) 場所 System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible) 場所 System.Windows.Forms.Control.CreateControl() 場所 System.Windows.Forms.Control.WmShowWindow(Message& m) 場所 System.Windows.Forms.Control.WndProc(Message& m) 場所 System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) 場所 System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) **************************************************** と言うエラーが表示されます。 続行してインストールしようとすると、最終的にエラーになり インストールできません。 Microsoft.NET　Frameworkは4と4.5しかインストールされてない状態です。 SQLServer2008SP1-KB968369-IA64-JPN.exe SQLManagementStudio_x64_JPN.exe SQLEXPR_x64_JPN.exe これら全部同じエラーが出ます。
win764bitにMicrosoft SQL Server 2008をインストールしたいです。 現在は SQL Server インストール センター (64 ビット) がインストールされている状態です。 SQL Server インストール センター (64 ビット)をクリックし、 インストール センターを開き、 「SQL Server の新規スタンドアロン インストールまたは既存のインストールへの機能の追加」をクリックしたのですが 「SQL Server 2008インストールメディアの参照」と出て、 ローカルディスク（C）のまま、OKを押すと 無効なインストールフォルダです。 となってしまうのですが、 どのフォルダならインストールできるのでしょうか？ それとも何かＣＤ－Ｒが必要なのでしょうか？
アクセスで フロントエンド、バッグエンドという言葉が出てきますが こういうことであってますか？ テーブルとそれ以外を分割して フォームたちをフロントエンド、 テーブルのみをバッグエンド そういう言い方であってますか？
SELECT * FROM ( (select * from [table1]) union (select * from [table2]) ); なんでこれが「JOIN操作の構文エラーです。」ですか？
http://okwave.jp/qa/q8209284.html 　以上の質問で、まだ解決には至っていません！？ 　御回答をいただいたのですが、私にはその意味が分かりませんでしたので 再度質問しました。 　初めてすることは、手探り状態なので、苦労しています_ _! 　教本を読んでも、エラー対策などは 、何も書かれておらず、ネットで一生懸命、状況を説明して、解決するしか、方法 はないので、宜しくお願致します。 　 　それで、エー・っと　 　 　#1007 - Can't create database 'xmas'; database existsの ”エラーメッセージ”をGoogle翻訳で直訳したら 　 ”＃1007 - データベース'クリスマス'を作成できません、データベースが存在している” 　とでて、原因として、”データベースが存在している”からできない！？ 　 　うーん　よく分かりませせん どなたか、こうゆう場合の解決策として、代替でいいですので、手順を箇条書きにして、教えて もらっていいでしょうか！＾＾ 　１）・・・ 　２）・・・ 　３）・・・ 　以上宜しくお願いします。
SQLが上手く作れないためお知恵をお貸し頂ければ幸いです。 articleテーブルに存在するユーザの一覧に、記事の投稿件数、記事に含まれるsizeの最大値、最大値が投稿された記事の登録日時、記事のタイトルを加えたものを抽出したいです。 [ article ] article_id user_id size insert_unixtime title ---------------------------------------------------------- 1 100 18 20130101 aaaaaaaaaaaa 2 100 10 20130102 bbbbbbbbbbbb 3 100 18 20130103 cccccccccccc 4 200 11 20130201 dddddddddddd ↓↓希望する抽出結果↓↓ article_id user_id count max_size insert_unixtime title ---------------------------------------------------------- 3 100 3 18 20130103 cccccccccccc 4 200 1 11 20130201 dddddddddddd 自己結合等で、ユーザ毎の最大sizeを抽出してそれに該当するレコードを探すことであるていどはできたのですが 最大sizeが複数あった場合に、両方のレコードを取得してしまいます。（上記の例では、article_id 1と3を抽出してしまう。 ※最大sizeが複数会った場合はinsert_unixtimeが大きい方のタイトルを表示したい。 うまく1SQLで抽出できないでしょうか。
こんにちわ。PHPとMysqlで色々やろうとしている者です… すっごい初心者です。 こんな感じのテーブルがあって… tagsテーブル [int id(PK)(A_I)][varchar tag(index)][int u_id] 1、うどん、5 2、そば、5 3、うどん、2 4、ラーメン、2 5、そうめん、1 6、そば、3 ....（つづく） こんな文があります… SELECT u_id, count(CASE WHEN tag = "うどん" or tag = "そば" THEN 1 ELSE NULL END ) AS `agr` FROM tags GROUP BY u_id ORDER BY agr DESC 結果は [u_id][agr] 5、2 8、2 4、1 3、0 ....（つづく） tagが「うどん」or「そば」のu_idを集計して多い順にソートするんですが これの結果を「うどん」and「そば」の結果だけを出力したい（この場合agrの結果2のみ） …要するにtagをandで検索したいという事です… 回答よろしければお願いします…
ASP.NETからSQLServerにアクセスしようとすると、ログイン画面が表示されてしまいます。 今まで、問題なく運用出来ていましたが、新たにデータベースにテーブルを追加し、それにアクセスする処理を実行したところ、ログイン画面が表示されてしまいました。実施した手順は、以下の通りです。 ノートPC（開発機）のMicrosoft Visual Web Developer 2005でデータベースのテーブルを新規追加し、プログラムを検証したところ問題なかったので、プログラムを本番機(サーバ）にコピーし検証しようと思い、サーバ側でSQL Server Management Express 2005を用いてテーブルを新規追加して検証したところ、ログイン画面が表示されてしまいました。 実施した手順 １．ASP.NETのプログラム内で、新しいテーブルを参照する処理を追加。 ２．ノートPC（開発機）内のMicrosoft Visual Web Developer 2005でテーブルを新規追加し、プログラムを検証。問題なくアクセスできた。 ３．ノートPC（開発機）から本番機サーバにプログラムをコピー。 ４．本番機サーバのSQL Server Management Express 2005でテーブルを新規追加。 ５．本番機でプログラムを実行したところ、ログイン画面が表示されてしまった。 補足：従来のテーブルはsa認証なので、同様にsa認証でテーブルを追加。 データベース：SQLServer2005 OS：WindowsServer2003 SD SP2 このような場合は、どのように対応したら良いのでしょうか？ ご存知の方いらっしゃいましたら、ご教授願います。 よろしくお願いいたします。
PostgreSQLで検索をすると濁点や半濁点もヒットしてしまいます。 「%カルヒ」で、「カルビスープ」も「カルピス」もヒットしてしまいます。 データべースは下記の通り作成しました。 CREATE DATABASE testdb WITH OWNER = postgres ENCODING = 'UTF8' TABLESPACE = pg_default LC_COLLATE = 'Japanese_Japan.932' LC_CTYPE = 'Japanese_Japan.932' PostgreSQLにて検索で濁点や半濁点をヒットさせない方法はありますか？
MySQLで10,000を超えるデータが有り、その中から最大6件まで指定して表示するプログラムを作る予定です。 6つの枠が有りそれぞれの枠にデータを選んでセットしていく形式です。 この場合データのテーブル側に枠にセットされていることを示すフラグのようなものを付けてそれをもとに抽出するか、別のテーブルにデータIDの記入された data1～data6 のカラムを作ってそれをもとに抽出するかどちらが速度・構造的に良いのでしょうか？
ｂａtchInsert処理を行うと正常終了しますが、DBには追加されてiいません。 ConnectionMgr.commitConnection(conn);文が終了後実行されています。 ＳＱＬ文 public void batchInsertSgnbtuInfo(ArrayList list, String rysnoo, String pgmId, Connection conn) throws DBException, SQLException { if (list == null || list.size() < 1) { return; } PreparedStatement pstmt = null; int[] rst = null; //sql文 StringBuffer sql = new StringBuffer(); sql.append(" INSERT INTO sgnjsk_inf (" + " kjikminoo, " + " hnkrrkymd, " + " untbng, " + " sgnetyjyn, " + " sgncod ) " + " VALUES (?, to_timestamp(?, 'yyyy/MM/dd hh24:mi:ss'), ?, ?, ?); try { pstmt = conn.prepareStatement(sql.toString()); //SQL文のパーラメタを設置 for (Iterator it = list.iterator(); it.hasNext();) { SgnbtujskinfInfo info = (SgnbtujskinfInfo) it.next(); int i = 1; // VALUES pstmt.setString(i++, info.getKjikminoo()); pstmt.setString(i++, info.getHnkrrkymd()); // ユニット番号 pstmt.setInt(i++, info.getUntbng()); //資源登録順 pstmt.setInt(i++, info.getSgnetyjyn()); pstmt.setString(i++, info.getSgncod()); pstmt.addBatch(); } pstmt.executeBatch(); } finally { if (pstmt != null) { pstmt.close(); } } } よろしくご教授ください。
レポートで集計表を作っていますが、VBAでテキストボックスに入力した数字同士の計算方法がわかりません。 次の様に、月ごとに商品別の売り上げを表示しています。 ---------------------------- ＜1月＞　 商品A 　5個　　500円 商品B 3個　　900円 商品C 1個　　200円 　　　　＜合計○○円＞ ＜2月＞　 商品A 　1個　　100円 商品B 2個　　600円 商品C 2個　　400円 　　　　＜合計○○円＞ ---------------------------- 月・商品名・個数はテーブルの値で、月と商品名をグループにして、個数の合計を表示しています。 金額は、商品ごとの単価が違うので、グループヘッダーの印刷時のイベントプロシージャで設定しています。 select case "商品" case "商品A" 金額 = 個数 * 100 case "商品B" 金額 = 個数 * 300 case "商品C" 金額 = 個数 * 200 end select ここで、この金額の合計を月ごとに求めたいのですが、うまくできません。 Me.合計金額 = DSum("金額", "集計", "月 = '" & Reports!集計!月 & "'") などと入れてみるのですが、全く違う金額が表示されます。 ご指導、宜しくお願いします。
SQLite3でテーブル作成する際、カラムをテキスト型にして、NOT NULL制約をつけているのですが、NULLも普通にINSERTされてしまいます なんででしょうか？
現在、 FileMaker Go を iPad のローカルで使用し、 マスタデータ等の取得時のみ、 PC 上で開いている 別の FileMaker ファイルに接続して、レコードのインポートで マスタデータを取得しているのですが、 その PC 上のファイルが開いているかどうか確認するには どうすればいいか、ご教授ください。 今は PC の IP アドレスを固定して、 FileMaker の外部データソースで fmnet:/IPアドレス/ファイル名 と指定したものをスクリプトで 「ファイルを開く」で開き、エラーが起こらなければ開いている、 と言う風にしているのですが、 これでは、IP アドレスの固定がどうしてもできない、と言うことが出た場合、 IP アドレスが変わるたびにその外部データソースの設定を変更する必要が出てきます。 それ以外に、確認する方法はありますでしょうか？ なお、方法としては PC のファイルからレコードをインポートする際に エラーになったら開いていないということになるのではないか、と一度思ったのですが、 それだと確認のためにインポートして、エラーがなければ 指定テーブルのデータをすべて消してさらにインポートと、 処理に時間がかかってしまいます。 （削除されたデータがあることもあるため、既存のレコードの更新ではなく、 一度すべて削除して取得しなおしています） 上記方法以外に、PC 上のファイルが開いていることを 確認する方法はあるのでしょうか？ もしご存知の方、 こんな方法はどうか、と思われる方、 どうかご教授お願いいたします。 FM Pro 12 FM Go 12
お世話になります。 以下のSQL文のイメージでselectの結果をさらにselectしたいのですが”subquery has too many columns”というエラーを吐かれます。 Postgreに合った書き方がお分かりでしたら教えてください。 よろしくお願いします。 select * from [DB名] where [パスワード] = 'test' IN ( select * from [DB名] where [ユーザID]='1111' order by [更新日] desc limit 3) [やりたいこと] テストDBからユーザIDが1111の行を更新日をキーに降順で並べ、先頭から3行分を取り出す。 その3行からパスワードが"test"のものをselectしたい。
SELECT のWHEREに別のSELECTの結果を当てはめることは可能でしょうか？ ただし、引用テーブルは同じテーブルとします。（DDD） 例 SELECT * FROM DDD WHERE B = (SELECT B FROM DDD WHERE C=1) 再起SQLとはまた違うのでしょうか？
Windows8、Access2013で環境依存文字を検索する時、正しく表示されません。 どのようにしたら解決できるでしょうか？ 例えば、新規にテーブルを作り、次の3件を登録します。 「吉岡　雄一」、「吉岡　雄一」、「岡　雄一」 この時、1件目の「吉」は「土」＋「口」の環境依存文字です。 そして、クエリで、1件目の「吉岡　雄一」を検索しようとしますと、1件目と3件目の「岡　雄一」が表示されます。 ちなみにこの時のクエリをSQLビューで確認すると次のようになっています。 SELECT テーブル1.名前 FROM テーブル1 WHERE (((テーブル1.名前)='吉岡　雄一')); この「吉」はもちろん、「土」＋「口」の環境依存文字です。 Accessの誤動作なのか、それとも何かアップデートをすれば解決する問題なのか、 あるいは、特殊な方法（Access VBAなど）があるのか、 はたまた、Microsoftの修正を待たないと解決しない問題なのかが分かりません。 正しく、1件目の「吉岡　雄一」だけを表示する方法がありましたらお教えください。
こんにちは。 会社の各営業所からのデータ収集を目的にVPNを構築するとします。 以下が私の考えている形です。 ・データを管理する事務所のマシンをVPNサーバとする。 ・このVPNサーバにapacheやPHPやSQLなどを入れて「ローカルで」動かしておく。 ・こうして出来上がった「VPNサーバ 兼 ローカル稼働Webサーバ」（以下サーバ） の適当な場所に、PHPで作ったデータ入力のためのdatainput.phpというファイルを置いておく。 さて、このサーバマシン内において、 ブラウザでlocalhost/datainput.phpなどとアクセスすれば 目的の画面になると思います。 （phpのページを開発するときなどにローカル環境を作ってテスト動作させたりしますが それと同じ状態です） では、「各営業所のVPNクライアントマシン」から、サーバに置かれたdatainput.php にブラウザでアクセスし、データ入力などをすることというのはできるのでしょうか？ できるとしたら、どんなアドレスでアクセスしたら良いのでしょうか？ ”(VPNサーバのipアドレス)/datainput.php” みたいな感じでアクセスしてデータ入力できるでしょうか？ 今のところ、まだ上記のような環境構築もできていない状態なのですが、 上記のような構成で目的を達成することができるのかどうか、 あるいは理解が間違っておりそんなことは不可能なのか、 を教えていただきたいです。 また「そういう方法ではなくこうした方がいい」や「それじゃできないけどこうすればできる」 などのアドバイスなどもありましたらお願いします。
こんにちは。昔、yayoi会計というソフトウェア体験版をインストールしたことがあります。その時に、SQL Server 2008もインストールされました。 Windows XPのサービスを見ると、「SQL Server(YAYOI)」、「SQL Server Agent(YAYOI)」なるものが残っています。現在は弥生会計は削除されていてサービスも停止しています。 不要なので、サービル(ローカル)から削除したいと思っていますが、どのようにすればサービスが削除できるでしょうか？
お世話になります。 表題のとおり、MySQLの特定のカラムの全データを削除したいのですが、ググるとテーブル全削除やWHEREで「30以下を削除」などの条件付きはすぐに出てくるのですがカラムの一行だけを空にする方法が見つけられません。 phpmyadminのSQLタブから実行しています。 ご達人の諸先輩方、どうぞお知恵をお貸しください。 phpmyadminのSQLタブに記載するSQL文をお教え願えますでしょうか。 宜しくお願いします。 MySQL、Window7 64bit Apacheサーバ　phpmyadmin
お世話になります。 Excelシートを一つのデータベースとみなして利用するプログラムを作成しているのですが、 データベースのある項目に紐づいている３つの項目から登録件数の多いものを抽出したいと 考えています。 ＜データベース内容＞ ↓データベースの中身 区分｜理由１｜理由２｜理由３ 　１　｜　５　　｜　７　　｜　６ 　１　｜　５　　｜　７　　｜　５ 　２　｜　７　　｜　６　　｜　５ ・登録区分１つに対して登録理由を３つまで入力できるデータベースです。なぜデータベース なのに理由欄が複数あるのかと疑問だと思うのですが、訳あってこの形を崩すことはできません。 上記のデータベースを使用してやりたいことは以下のとおりです。 (1)データベースから区分を選出 (2)その区分に対して登録された理由の件数を抽出 (3)抽出した件数の多い順に並び替え （なんとなくこんな感じです。） ＜抽出結果（区分１の場合）＞　 理由｜件数 　５　｜　３ 　７　｜　２ 　６　｜　１ 私の方でも上記のような結果になるよう考えてみたのですが、どうしても３つの列のデータを 統合した上で件数を出す方法が分からず悪戦苦闘しております。 ちなみに、使用しているOSはWindowsで、Excel2010でADOを使用してデータベースアクセスを 行っています。ADOは旧バージョンで.Netではありません。 説明が大雑把で申し訳ありませんが、良い案が御座いましたらご教授ください。 よろしくお願いいたします。
アクセス２０１０です。「入金テーブル」を作成していて、普通にデータを入力していたら、主キーの入金IDナンバーの数が異常に大きくなったことに気が付きました。調べてみると１から４２０４までは正常だったのですが、急に７３２６になり、その次の数字は１０４４９になっていて、それからは順繰りに大きくなっていました。 どうしてそうなってしまったのか、又直すには、どうしたらいいのでしょうか？
SQLに関して質問させて頂きます(MySQLを使用しています)。 下記のようなデータを使用して、賞味期限に設定した日付が、24時間以内にせまったレコードの危険フラグを1にしたい場合、どのようなSQLを記述すれば良いでしょうか？ SQLの実行は1回でも2回に分けてもらってもよいので、効率的な方法があればよろしくお願いします。 ※必要であればPHPを使用して下さい。 ＜カラム＞ ｜商品名｜賞味期限｜危険フラグ｜ ＜例＞ | 魚　 | 2013-07-31 21:30:00 | 0 | | 肉　 | 2013-08-01 21:00:00 | 0 | | 野菜 | 2013-08-02 21:30:00 | 0 | SQLを実行した時の時刻が「2013-07-31 19:00:00」であれば、肉の賞味期限が24時間以内に迫っているので、危険フラグを1にしたいと考えています。 よろしくお願いします。
Oracleの動作の仕組みについてご教示ください。 1.初回、OracleクライアントがOracleサーバーのデータベースに接続するときは、接続要求をリスナーが受け付けるが、二回目以降、同じデータベースに接続する際、リスナーに接続要求を行わずに直接データベースとやり取りを行うという認識でいいでしょうか。 2.1の認識で間違いがない場合、Windows、Linuxとも同じでしょうか。また、バージョンによって違いがありますでしょうか。
こんにちは ２つのDBより新しい１つのDBにテータを移行することになりました。 VB.NETでプログラムを作成し移行しようと思っています。 今までは１つのDB内での移行は行った事があります。 今、悩んでいるのは他のDBのテーブルを参照したいのですが方法がわかりません。 よろしかったら教えていただけませんか？ オラクルバージョンは１１Gです。 VB.NET２００８でプログラムを作成するつもりです。 よろしくお願いいたします。
かなり初心者です。もしかしたら妙な事を訊いているのかもしれません。 php5.4.16とmysql5.5.32でSNSのフレンドリストのような機能を作ろうと思います。 フレンド最大数は1000とします。この場合、1000個もカラムを作るのでしょうか？ それとも、会員個別にテーブルを作ってそこで管理するのでしょうか。 もしくは、テーブルは一つとし、会員番号のカラムを二つ用意、関係性を示したテーブルを作るのでしょうか？ もしくは、カラムは一個で文字列で操作したりするのでしょうか？（カンマで区切る等） パフォーマンス的にどの設計が正しくて、どの設計が間違いなのでしょうか… 回答よろしくお願いします。
Ｗｅｂアプリを開発しておりまして、ＳＱＬに詳しい方にＤＢ回りをお願いしいますが、躓いてしまいました。 Ｗ３Ｃに則り作成のため、ＷｅｂＳＱＬを使って名簿のようなテーブルから、該当するデーターをループを組んで読みだそうとしていますが、最後のデーターしか返ってきません。 目的は、該当する名前を表示して、それぞれに付加（追加する：空のテーブルは用意しておいて）データーを入力して、ＤＢへ返そうと思っています。 しかしＳＱＬの超初心者のため、またＷｅｂＳＱＬやＳＱＬｉｔｅも始めたばかりで、簡単にループを掛けてインクリメントで読み出し、表示して　　が　巧く行きません。 なにやら「同期」とか「非同期」なる言葉があるようですが、そもそもこれもよくわかりません。 上記の目的を達成させることが可能なのか、不可能なのかを教えていただければ助かります。参考文献などを示唆していただければなお良いと思います。 まず、以下のようなテーブルを用意しています。 　　名前　　性別　　身長　　体重　　 　　山田　　男 　　高橋　　男 　　田中　　女 　　吉田　　男 　　佐藤　　女 　　などなど 以上から　女だけを順に取ってきて　　：入力ボックスとは　input type="text"の様なものです 　　田中　　女　　　入力ボックス　　入力ボックス 　　佐藤　　女　　　　　〃　　　　　　　　〃 　　以下該当者全て同じように表示 入力したデーターを　該当する空欄（あるいは上書き）でデーターを戻す これを　ループ処理でやりたいと思っています。 よろしくお願いします
MySQL ver.5.0.95です。 PHPからSQL文を作ってDBへインサートしているのですが 重複した値が合った場合はupdateするように書いています。 TBL1には |id　　　|string　　　|count 1　　　　aaa　　　　0 2　　　　bbb　　　　3 3　　　　ccc　　　　1 TBL2には |id2　　　　|string2　　　　|count2 1　　　　　 aaa　　　　　　0 2　　　　　 bbb　　　　　　2 3　　　　　 ccc　　　　　　1 実際はもう少し複雑ですが、こういう感じでデータが入ってるとします。 このとき、TBL1のそれぞれをインサート若しくはアップデートするのに TBL2の同一IDのものの、count2の状態によって場合分けしたく 同一IDのcount2が1以上なら変更しない、という風にするため以下のように書いたのですが insert into TBL1 values (1, "aaa", 3), (2, "bbb", 3), (3, "ccc", 3), (4, "ddd", 3) on duplicate key update count = CASE WHEN (select count2 from TBL2 where id2 = values(id)) >=1 THEN count ELSE count + values(count) END; #1064 - You have an error in your SQL syntax;というエラーになって出来ません。 WHENの中のサブクエリで、where id2 = values(id)　恐らくこの文がダメなようです。 例えば決め撃ちで1つ1つ書くと通ります。 insert into TBL1 values(1, "aaa", 3) on duplicate key update count = CASE WHEN (select count2 from TBL2 where id2 = 1) >=1 THEN count ELSE count + values(count) END; insert into TBL1 values(2, "bbb", 3) on duplicate key update count = CASE WHEN (select count2 from TBL2 where id2 = 2) >=1 THEN count ELSE count + values(count) END; insert into TBL1 values(3, "ccc", 3) on duplicate key update count = CASE WHEN (select count2 from TBL2 where id2 = 3) >=1 THEN count ELSE count + values(count) END; insert into TBL1 values(4, "ddd", 3) on duplicate key update count = CASE WHEN (select count2 from TBL2 where id2 = 4) >=1 THEN count ELSE count + values(count) END; これをエラーになったような文に変えて1文にまとめたいのですが、無理でしょうか？ あとそもそもこれをまとめたほうが速いと思ってそうしたいのですが、 変わらないのなら1文1文;でつなげて書くやり方でいこうと思っています。 まとめると速くなることはあるでしょうか？
MySQL　初心者です。 テーブルを作成して、いろいろとデータを入れ込もうと思うのですが、 CURRENT_TIMESTAMP を指定すれば、データを入れた瞬間にその時の日付が登録されると思うのですが、 それとは別に勝手に連番をつけていくような機能はないのでしょうか？
Oracleのトリガーについて質問です。 旧システムから新システムへデータ移行を行おうとしているのですが、 新システムではNEWテーブル（仮名）が新規で追加されています。 データ移行の方法として、旧システムのダンプファイルをエクスポートし、 新ステムにユーザを再作成後インポートしました。 その後、あらかじめ新システムでNEWテーブルのみテーブル指定のエク スポートを行っていたダンプファイルより、追加でインポートを行いました。 これでデータ移行完了と思っていたのですが、NEWテーブルのデータはトリガー により生成されるらしいのですが、どのタイミングで生成されるのでしょうか？ データ移行完了時はデータ0件です。 NEWテーブルをインポートする順番が逆なのでしょうか？ それともインポートではトリガーは起動しないのでしょうか？ または、トリガーの仕組みが消えている（？）のでしょうか？ （納入先に行かないと確認できない状態なので実際のデータベースが確認できません…） Oracleはあまり詳しくないため、わかりづらい質問かもしれませんが よろしくおねがいします。 【環境】 Oracle11g R2 Windows2008Server
例えばテーブル名test01にカラムhogeとstatがあるとします。 statにはaまたはbの値が入ってます。 XXXX a XXXX b XXXX a XXXX a YYYY a YYYY b test01のテーブルが上記の様な場合、以下の様に集計したいです。 hoge a b （ヘッダ） XXXX 3 1 YYYY 1 1 どのようにSQLを書いたら良いか教えて下さい。 以上、よろしくご指導の程お願い申し上げます。
SQLServer2000 を使用しています。 海外拠点のSQLServer(2000)とインターネットVPN経由でDTSでデータの交換をする ジョブを使っていました。 問題なく動作していましたが、ある日突然、失敗するようになり、 SQLServerのログインすら出来なくなってしまいました。 （PINGは通るし、名前解決も問題ありません。エクスプローラーでアクセス可能です） 不思議なことに私の端末からの接続は問題なく、動作も正常です。 そして、海外拠点のサーバーから本社のサーバーへの接続も正常です。 また、海外拠点の他のサーバーへの接続も正常です。 問題のサーバーのみ、一方通行です。（アクセスされるほうは正常） おかしくなったあと、サーバー名でなくIPアドレスでログインしたら 接続できたのですが、しばらくたつと、IPアドレスのログインすらできなくなり、 いったい何がなんだか訳がわかりません。 エラー内容ですが、EnterpriseManagerからサーバーに接続すると下記のエラーが でます。（その他、ジョブの実行、DTSの実行もすべてこれで失敗します） SQL Server が存在しないか、アクセスが拒否されました。 ConnectionOpen (Connect()).。 海外拠点とのやりとりで夜間バッチでデータ交換ができないと 運用的に厳しくなんとか復旧したいとおもいます。 同じような境遇にあるかたいらっしゃいましたら、 情報をいただけると幸いです。
例えば、テーブル名：test01のレコードhogeに、 XXXX XXXX YYYY ZZZZ XXXX YYYY XXXX とレコードに値が入っているとします。これを、 XXXX 3 YYYY 2 ZZZZ 1 の様に、各値毎の数を集計したいのですが、どうSQLを書いたら良いですか？ 以上、宜しくご指導の程、お願い申し上げます。
業務系のシステムを構築しております。 ある顧客で、フロントエンドをWEBシステムで構築し、業務システムへ連携してほしいとの依頼が来ました。 フロントエンドは別の会社が作っており、そこから出てきたインターフェースの仕様がテキスト項目はコード類も含めすべて２５５桁になっておりました。 テキスト項目をすべて２５５ケタにするメリットはなんなのでしょうか？ デメリットとしては、後々DB解析する際などに処理が非効率になるのではないかと思っているのですが、他にもあれば教えていただければと思います。
下記のクエリがあります。 氏名 番号（8桁あり2文字で抽出）　Like "80*" Or Like "81*" Or Like "90*" 負担金 金額 不足金 そして 式1: IIf((金額]-[不足金])>=0 Or IsNull([不足金]),True,False) 抽出条件　True としています。 式2で Like "81*"の人で、負担金が600以上の人を追加しようとしましたが出来ませんでした。 方法を教えて下さい。
MYSQLを勉強中です。 下記のようなテーブルがあります。 【クライアトテーブル】： クライアントID 1 | A社 2 | B社 3 | C社 4 | D社 【お問合せテーブル】： お問合せmail |お問合せ先のクライアントID|お問合せ日時 aaa@aaa.com |1 |2013-02-01-10:00:00 aaa@aaa.com |2 |2013-03-01-10:00:00 bbb@bbb.com |3 |2013-04-01-10:00:00 ccc@ccc.com |4 |2013-04-02-10:00:00 aaa@aaa.com |1 |2013-04-03-10:00:00 ここで、 クライアント毎に、4月分の問合せ数を表示したいのですが、 4月1日～4月末日に問合せのあったメールアドレスと、 2月1日～3月末日に問合せのあったメールアドレスを比較して、 下記のように重複分をクライアント毎にカウントしたいです。 問合せ数： A社：1件　重複1件 C社：1件　重複1件 D社：1件　重複0件 クライアントIDを個別で指定すれば正しく表示できるのですが、 クライアント一覧を取得するのはどのようなSQLを書けばよいのでしょうか。。。 もう１ヶ月悩んでおります。 すみませんが、教えて頂けますと幸いです。
MySQLで、「GROUP_CONCAT」を「複数列」に適用させ、それぞれ異なるレコードを1つにまとめようとしたのですが、 取得出来る結果が、多い方の数に引き連られてしまいます。 ざっくりとした質問でアレなのですが、これは結合の仕方が悪い、 と推測されるでしょうか？ そもそも「GROUP_CONCAT」を複数列に適用させる場合、それぞれ異なるレコード数をまとまることはできるのでしょうか？。 ■期待した取得結果 [テーブルAカラムc] => tokyo,osaka [テーブルAカラムd] => japan,japan [テーブルBカラムe] => windows [テーブルBカラムf] => man ■実際の取得結果 [テーブルAカラムc] => tokyo,osaka [テーブルAカラムd] => japan,japan [テーブルBカラムe] => windows,windows [テーブルBカラムf] => man,man 「テーブルB」の取得結果が、「テーブルA」取得結果数に引き連られてしまいます ■SQL(抜粋) SELECT 　GROUP_CONCAT(a.c) AS c, 　GROUP_CONCAT(a.d) AS d, 　GROUP_CONCAT(b.e) AS e, 　GROUP_CONCAT(b.f) AS f FROM hoge h LEFT JOIN テーブルA a ON (h.id = a.hoge_id) LEFT JOIN テーブルB b ON (h.id = b.hoge_id)
http://ponk.jp/php/basic/php_mysql すいません。データベースを初めて勉強中なのですが、上記のサイトに書いてあるように文字をphpで表示させた場合日本語が???に文字化けします。いろいろググってみたのですが解決できず先に進めません・・。 照合順序などはutf8_general_ciとなっていまして、phpの方も<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />とutf-8が指定してありますので問題ないと思います。 考えられる原因というのはどんなものがありますか？ テーブル表 CREATE DATABASE men; USE men; CREATE TABLE udon(name TEXT, price INT); INSERT INTO udon VALUES('たぬきうどん', 340); INSERT INTO udon VALUES('てんぷらうどん', 440); INSERT INTO udon VALUES('カレーうどん', 420); INSERT INTO udon VALUES('うどん定食', 520); 表示プログラム <table border="1"> <tr><th>名前</th><th>価格</th></tr> <?php $pdo = new PDO("mysql:dbname=men", "root"); $st = $pdo->query("SELECT * FROM udon"); while ($row = $st->fetch()) { $name = htmlspecialchars($row['name']); $price = htmlspecialchars($row['price']); echo "<tr><td>$name</td><td>$price 円</td></tr>"; } ?> </table>
PostgreSQLを使ったJavaシステムで、検索スピードが最も速い方法を教えていただきたいと思います。 ・検索するテーブル（tblS） 　scode　Varchar　6　主キー 　sname　Varchar　30 　stni　Varchar　2 　skmk　Varchar　2 　stnk　Int4 ・検索する項目 　入力されたnameがテーブルのsnameに存在した場合、他の４項目のデータを読み込む。 　これを連続して5回（nameが５件ある）行う。 現在考えているのが、tblSのデータをArrayListに読込み、ArrayListの検索を行う方法です。 現在、tblSの件数は1500件ですが、日々増加しています。 どうかよろしくご教授ください。
データベースにチェックボックスのON、OFF状態を 保存しようとしているのですが、 やり方が色々あり、どのやり方が一番いいのかわかりません。 調べたところ、大きく以下の４つがあることがわかりました。 ----------------------------------------- 方法１　チェックボックス分カラムを用意する ----------------------------------------- 例 id　name　flag4　flag3　flag2　flag1 15　なまえ　１　　　１　　　０　　０ ----------------------------------------- 方法２　ビット演算を使う ----------------------------------------- id　name　bit 15　なまえ 12 ----------------------------------------- 方法３　カンマで区切ってデータを入れる ----------------------------------------- id　name　check 15　なまえ 3,4 ----------------------------------------- 方法４　チェックボックス管理テーブルを作る ----------------------------------------- main_tb id　name 15　なまえ check_tb id　check 15　4 15　3　 それぞれ、一長一短があると思うのですが それぞれのメリット・デメリット、一般的にどの方法が好まれているのか等 アドバイス頂けると嬉しいです。
windows7 64bit sql server 2012 expressをつかっています。 select YEAR("日付") as yere,MONTH("日付") as month,収支名,sum("金額")as kin from 収支 group by YEAR("日付"),MONTH("日付"),収支名 を実行して、 yeremonth　収支名　ｋin 20136支出13011 20136収入33500 20137支出20000 20137収入70000 と、なりましたが、同じ年、月の収支と支出を求める表を得るにはどうしたらよいでしょうか？ yeremonth　差 2013 6 -24089 2013 7 50000 のような感じです。 （もとのテーブルはこれです） id日付収支名項目金額 12013-06-16収入給料15000 22013-06-16支出ガス代555 ．．．．．． 宜しくお願いします。
お世話になります。 現在、DB内のindividualというテーブルのname_enというフィールドにおいて、 日本人の名前が英語表記で登録されています。 ただし、一般的な表記でなく、「姓, 名」というようになっています。 例えば、玉木宏さんであれば、 Tamaki, Hiroshi となっています。 これを一般的な Hiroshi Tamaki に一発で置換するようなSQL命令文がありましたら教えていただきたいのですが、 如何でしょうか。 何卒よろしくお願いいたします。 バージョン情報などは下記の通り引用します。 MySQL Server: Localhost via UNIX socket Server version: 5.1.67 Protocol version: 10 MySQL charset: UTF-8 Unicode (utf8) Web server Apache/2.2.23 MySQL client version: 5.1.67 PHP extension: mysqli phpMyAdmin Version information: 3.3.10.5
SQLServer2008R2 Express を使用しております。 添付画像のように、MADBという名前のデータベースにバックアップファイルから復元を試みると、失敗してしまいます。どこに気をつければよいでしょうか。 (1) 「既存のデータベースを上書きする」にチェックは入れてあります。 (2) 復元先のパスは合っています。 (3) SQLServerのバックアップファイルのバージョンは、2008R2より上ではありません。
「去年の登録者」「今年の登録者」というテーブルがあるとします。 カラムは両方とも「名前」「性別」「年齢」があり、人物の情報が入ってます。 両方にデータが入ってる人もいれば、片方にしかデータが入ってない人もいます。 この2つのテーブルから男性のデータを引き出し 名前　去年の年齢　今年の年齢 太郎　21歳　　　　22歳 二郎　24歳　　　　データなし 三郎　データなし　20歳 このようにしたいのですがsql文が思いつきません。 アドバイスをください。
Oracle Database Express Editionを使って勉強中の者です。 商品TBL、予約TBL、明細TBLと3つのテーブルを使用して、商品に対して予約と受取の明細がきちんと出ているのか、件数を出すSQLを組みたいと思っています。 例えば、 【商品TBL：shohin】 shohin_no / shohin_nm / price ----------------------------- s001 / name1 / 1000 s002 / name2 / 1500 s003 / name3 / 2000 【予約TBL：yoyaku】 yoyaku_no / shohin_no / status(1:予約, 2:受取) ----------------------------- y001 / s001 / 1 y001 / s001 / 2 y002 / s001 / 1 y002 / s002 / 1 y002 / s002 / 2 【明細TBL：receipt】 shohin_no / status / receipt ----------------------------- s001 / 1 / abc.. s001 / 2 / def.. s002 / 1 / ghi.. 【想定結果】 商品NO / 予約数 / 予約明細数 / 受取数 / 受取明細数 ----------------------------- s001 / 2 / 1 / 1 / 1 s002 / 1 / 1 / 1 / 0 s003 / 0 / 0 / 0 / 0 としたいのですが、どうにも上手くいかず、下記のような結果が返ってきます。 【結果】 商品NO / 予約数 / 予約明細数 / 受取数 / 受取明細数 ----------------------------- s001 / 2 / 2 / 2 / 2 s002 / 1 / 1 / 1 / 0 s003 / 0 / 0 / 0 / 0 私が実行したSQLは下記です。 恐らく何か初歩的な所で間違っているような気がするのですが、自分では分からず…。 一体何がいけないのか、ご教授の程、よろしくお願い致します。 select shohin.shohin_no as "商品NO" ,count(yoyaku_1.shohin_no) as "予約数" ,count(receipt_1.shohin_no) as "予約明細数" ,count(yoyaku_2.shohin_no) as "受取数" ,count(receipt_2.shohin_no) as "受取明細数" from shohin ,(select * from yoyaku where yoyaku.status = '1') yoyaku_1 ,(select * from yoyaku where yoyaku.status = '2') yoyaku_2 ,receipt receipt_1 ,receipt receipt_2 where yoyaku_1.shohin_no(+) = shohin.shohin_no and yoyaku_2.shohin_no(+) = shohin.shohin_no and receipt_1.shohin_no(+) = yoyaku_1.shohin_no and receipt_1.status(+) = yoyaku_1.status and receipt_2.shohin_no(+) = yoyaku_2.shohin_no and receipt_2.status(+) = yoyaku_2.status group by shohin.shohin_no order by 1
1つのテーブルから重複したデータを取り除いて表示するときに使う 【select distinct カラム名 from テーブル名;】 がありますよね。 それと同じようなことを複数のテーブルをまたいで行いたいのですがうまくいきません。 ちなみに両方のテーブルのカラム名は同じです。 【select distinct カラム名 from テーブル1 union select distinct カラム名 from テーブル2;】 としても重複を取り除いた後にテーブルを結合してるので結果的に両テーブルの重複した値を取り除くことができず。 そこで 【select distinct T1.カラム名, T2.カラム名 from テーブル1 T1. テーブル2 T2;】 としてみたのですが、クエリを実行中のまま反応がないので悩んでます。 ちなみに2つのテーブルのデータはそれぞれ2万件ほどです。 こういう時どういうsql文を組むのが正しいのでしょうか？
Postgres初心者です。 教えてください。 pg_dumpコマンドでdump拡張しのバックアップファイルを生成し、 tarコマンドで****.tar.gzファイルに圧縮しました。 このtar.gzのファイルを直接リストアするコマンドがあれば 教えていただけないでしょうか？ -bash-3.2$pg_restore -U postgres -d (データベース名） < ****.tar.gz と実行すると、以下のエラーメッセージが表示されます。 →pg_restore: [アーカイバ] 入力ファイルが有効なアーカイブではないようです。 -bash-3.2$gunzip -C ****.tar.gz | pg_restore -d (データベース名） と実行すると、以下のエラーメッセージが表示されます。 →pg_restore: [tarアーカイバ] tarアーカイブ内でファイルtoc.dat用のファイルヘッダがありませんでした よろしくお願い致します。
Oracle 11gを使用しているSQL初心者です。 テーブルの列名を取得する方法についての質問です。 テーブルの列名を取得するときは以下のSQLで取れると思っています。 select column_name from user_tab_columns where table_name = 'テーブル名'; --実行結果-- COLUMN_NAME ------------------------------ NAME1 NAME2 しかし、テーブルにTIMESTAMP型が含まれていると 「レコードが選択されませんでした。」 と表示されます。 TIMESTAMP型が含まれるテーブルは上記のSQLでは取得できないのでしょうか。 TIMESTAMP型が含まれるテーブルの列名の取得方法をご存知の方がいらっしゃいましたら、 ご教示ください。よろしくお願い致します。
こんにちは。 Windows2008R2上に「SQL Server2012」を導入しようとしています。 しかしながら来月にはAD環境が出来上がることにより、「SQL Server2012」を導入したサーバも AD環境に加わります。 その場合は、「SQL Server2012」は再導入しないといけないのでしょうか？ 仮に、再導入が必要な場合は再導入しないでもよい方法はないでしょうか？ お教えください。
■やりたいこと フェッチして取得したデータを条件にカウントした結果を取得したい。 ■事象 フェッチして取得したデータにダブルクウォートで囲まれている為、EXECUTE時にORA-00904が発生する。 ■教えて欲しいこと カーソルおよびフェッチ時にダブルクウォートを削除、またはシングルクウォートに変換をすることが可能でしょうか。または、他の方法でカウントを取得する方法がございますでしょうか。 サンプルコードを記載しておりますのでご確認、ご教授のほどよろしくお願いします。 ※※※の箇所が本事象発生箇所となります。 ■サンプルコード DECLARE V_EXEC_STRING VARCHAR2(2000); V_EXEC_COUNT NUMBER; CURSOR TESTCUR IS SELECT TEST_NAME,TEST_ID,TEST_DATE FROM TARGET_TBL WHERE TEST_NAME IN (SELECT tb1.TEST_NAME FROM (SELECT TEST_NAME FROM TARGET_TBL WHERE STATUS = '2') tb1 INNER JOIN READ_TBL tb2 ON(tb1.TEST_NAME = tb2.TEST_NAME)); --取得レコードを格納する変数定義 TESTREC TESTCUR%ROWTYPE; --処理開始 BEGIN --カーソルオープン OPEN TESTCUR; --ループ開始 LOOP --フェッチ 1行ずつデータ取得 FETCH TESTCUR INTO TESTREC; --レコードの最後でループを終了 EXIT WHEN TESTCUR%NOTFOUND; V_EXEC_STRING := ''; V_EXEC_STRING := V_EXEC_STRING || 'SELECT COUNT(*) FROM READ_TBL WHERE TEST_NAME = '|| TESTREC.TEST_NAME; ※※※上記TESTREC.TEST_NAMEに"AAAA"の形でデータが入るため、下記実行時にORAエラーが発生する。 EXECUTE IMMEDIATE V_EXEC_STRING INTO V_EXEC_COUNT; IF V_EXEC_COUNT = '1' THEN UPDATE TARGET_TBL SET TEST_ID = ( SELECT TEST_ID FROM READ_TBL WHERE TEST_NAME = TESTREC.TEST_NAME), TEST_DATE = ( SELECT TEST_DATE FROM READ_TBL WHERE TEST_NAME = TESTREC.TEST_NAME), STATUS = 10 WHERE TEST_NAME = TESTREC.TEST_NAME; END IF; IF V_EXEC_COUNT != '1' THEN UPDATE TARGET_TBL SET STATUS = 20 WHERE TEST_NAME = TESTREC.TEST_NAME; END IF; END LOOP; CLOSE TESTCUR; COMMIT; END; /
初めて質問させていただきます。 タイトルはなんとつけたらよいか分からなかったので的外れだったらすみません。 PHP5とMySQL5でプログラムの練習を始めました。 しかしどうしても躓いて分からないところがあり、質問させていただきました。 従業員のデータの入ったテーブル、職種のテーブル、従業員と職種を結ぶテーブルがあるとします。 例えば以下のようなものです。 従業員テーブル +-----------+---------+-----+ | worker_id | name | age | +-----------+---------+-----+ | 1 | hiroshi | 20 | | 2 | seiya | 30 | | 3 | akane | 18 | | 4 | yukari | 18 | +-----------+---------+-----+ 従業員職種テーブル +-----------+--------+ | worker_id | job_id | +-----------+--------+ | 1 | 1 | | 1 | 2 | | 1 | 3 | | 1 | 4 | | 2 | 1 | | 2 | 2 | | 3 | 2 | | 3 | 3 | | 3 | 4 | | 4 | 1 | +-----------+--------+ 職種テーブル +--------+----------+ | job_id | job_name | +--------+----------+ | 1 | hole | | 2 | kitchen | | 3 | delivery | | 4 | cleaning | +--------+----------+ ここで職種cleaningに属する従業員を除いた従業員のデータ一覧を、表示するようなことがしたいと考えています。 このテーブルでいうとhiroshiとakaneはcleaningに属するので除いて、seiyaとyukariのデータが一覧で表示されるという感じです。 select 従業員職種テーブル.worker_id, 従業員テーブル.name, 従業員テーブル.age GROUP_CONCAT(職種テーブル.job_name order by 職種テーブル.job_id) from 従業員職種テーブル left join 従業員テーブル on 従業員職種テーブル.worker_id=従業員テーブル.worker_id left join ot_dow on 従業員職種テーブル.job_id=職種テーブル.job_id group by 従業員職種テーブル.worker_id order by 従業員職種テーブル.worker_id このようなSQLで従業員の職種まで含めたデータを一覧にすることは出来たのですが、対象を除外するような方法が分からずじまいです。 SQLでできるのではと思っていますが、もしかしてPHPでやらなければいけないとかのことも含め、教えていただければ助かります。 よろしくお願いいたします。
現在VB.NET 2008を用いて、システムを作成しています。 Access2008の.accdb内のデータと、MySQL内のデータをinner joinして取得したいと考えていますが、 可能でしょうか? 可能であればどのようにすればよいでしょうか?
下記の'←追加'と書いた部分を追加して実行しましたが、動いてくれません。 ご教授お願いします。 ("SELECT song.song_ID, song.song_name, song.song_name_yomi, kashu.kashu, ka2.kashu as kashu2, ka3.kashu as kashu3, ka4.kashu as kashu4, ka5.kashu as kashu5, ka6.kashu as kashu6, ka7.kashu as kashu7, ka8.kashu as kashu8, ka9.kashu as kashu9, ka10.kashu as kashu10, kashu.kashu_yomi, sakushi, sakushi_yomi, sakkyoku, sakkyoku_yomi, hennkyoku, hennkyoku_yomi, tie_up.tie_up, ti2.tie_up as tie_up2 kashu_yomi, ←追加 ky2.kashu_yomi as kashu_yomi2 ←追加 FROM (((((((((((((((( song left JOIN kashu ON song.kashu_1_ID = kashu.kashu_ID) left JOIN kashu_yomi ON song.kashu_1_ID = kashu.kashu_ID) ←追加 left JOIN kashu_yomi ky2 ON song.kashu_2_ID = ky2.kashu_ID) ←追加 left JOIN kashu ka2 ON song.kashu_2_ID = ka2.kashu_ID) left JOIN kashu ka3 ON song.kashu_3_ID = ka3.kashu_ID) left JOIN kashu ka4 ON song.kashu_4_ID = ka4.kashu_ID) left JOIN kashu ka5 ON song.kashu_5_ID = ka5.kashu_ID) left JOIN kashu ka6 ON song.kashu_6_ID = ka6.kashu_ID) left JOIN kashu ka7 ON song.kashu_7_ID = ka7.kashu_ID) left JOIN kashu ka8 ON song.kashu_8_ID = ka8.kashu_ID) left JOIN kashu ka9 ON song.kashu_9_ID = ka9.kashu_ID) left JOIN kashu ka10 ON song.kashu_10_ID = ka10.kashu_ID) left JOIN sakushi ON song.sakushi_ID = sakushi.sakushi_ID) left JOIN sakkyoku ON song.sakkyoku_ID = sakkyoku.sakkyoku_ID) left JOIN hennkyoku ON song.hennkyoku_ID = hennkyoku.hennkyoku_ID) left JOIN tie_up ON song.tie_up_1_ID = tie_up.tie_up_ID) LEFT JOIN tie_up ti2 ON song.tie_up_2_ID = ti2.tie_up_ID where song_name like '%%'" ))
【名字、名前、昨日のメモ、今日のメモ】というカラムがあります。 名字、名前、昨日のメモは過去のデータなので、新しく今日のメモを追加したい場合どうしたらよいでしょう？ また、一括でデータを挿入するときに、名字・名前の両方一致するものがないデータがあれば新しくレコードを作るという風にしたいのですが、可能でしょうか？ なお、同姓同名は存在しないものとします。
アクセス２０１０でご質問がございます。 00001,郵便番号,住所,氏名,TEL 00002,郵便番号,住所,氏名,TEL 00003,郵便番号,住所,氏名,TEL 00004,郵便番号,住所,氏名,TEL 00005,郵便番号,住所,氏名,TEL 00006,郵便番号,住所,氏名,TEL 00007,郵便番号,住所,氏名,TEL 00008,郵便番号,住所,氏名,TEL 00009,郵便番号,住所,氏名,TEL のようなデータが存在したとします。 下記のようにデータを移動したいのですが 00001,郵便番号,住所,氏名,TEL,00004,郵便番号,住所,氏名,TEL,00007,郵便番号,住所,氏名,TEL 00002,郵便番号,住所,氏名,TEL,00005,郵便番号,住所,氏名,TEL,00008,郵便番号,住所,氏名,TEL 00003,郵便番号,住所,氏名,TEL,00006,郵便番号,住所,氏名,TEL,00009,郵便番号,住所,氏名,TEL クエリ等で、レコード移動は可能なのでしょうか？？ ※今回の例ですと全9レコードありますので3等分にしたいので 9÷3で3レコードになります。 アドバイス宜しくお願い致します。
お世話になります。 仕事でアクセスファイルのリンクテーブル一覧を作成しなければならず、下記のsqlを用いて作業を進めています。 　　SELECT Name, Database 　　FROM MSysObjects 　　WHERE Type=6 　　ORDER BY Name; ところがこの時不思議な現象が起きます。 というのも、splで表示させたリンクテーブルの方が、リンクテーブルマネージャーで表示させたリンクテーブルよりひとつ二つ多かったりするのです。 これはどういった原因で起こり得る現象でしょうか。 削除済みのリンクを拾っているのでしょうか。 もしくは、VBAでこっそりリンクしているテーブルがあるのでしょうか。 何卒アドバイスのほどよろしくお願いいたします。
テーブルのおインデックス項目はSELECTすると検索が早いのですが、 インデックスではない項目をWHEREすると時間がかかります。 そこでテーブルカラム全部をインデックス化することでの メリット、デメリットは何でしょうか？
お世話になります。 MicroSoftAccess2010のリボンの非表示について 質問です。 リボンの非表示については、他の質問で下記のような対応方法が ありまして、設定することにより、表示をなくすことはできました。 ＜設定方法＞ システムオブジェクトの表示をチェックする。 新規で、テーブルを追加する。 テーブル名 USysRibbons フィールド名 RibbonName　テキスト型　　 RibbonXml　　テキスト型 データ RibbonNameHiddenRibbon RibbonXml"<customUI xmlns=""http://schemas.microsoft.com/office/2006/01/cust … <ribbon startFromScratch=""true"" /> </customUI>" この作成したテーブルを、ACCESSのオプション→カレントデータベースの リボン名に、テーブルを指定することにより、リボンの非表示ができました。 ここで質問なんですが、 ACCESSの帳票印刷時にページ指定印刷を行いたいときがあります。 ＡＣＣＥＳＳ２００３を利用していた時は、メニューバーの印刷からページ指定印刷を 利用者に行ってもらっており、リボンすべてが非表示になってしまうと一部問題があります。 不必要なリボンは非表示にしつつ、ページ指定印刷が可能になるような設定方法に ついてやり方を御助言いただけますでしょうか ご面倒かけまして、申し訳ありませんがよろしくお願いいたします。
お世話になっております。4つのテーブルの結合について質問させて下さい。（MySQL5) データベースの内容は販売に関するもので、以下のような４つのテーブルがあります。（不必要なカラムは省略しています） テーブル名：goods（商品 goods_no　｜　goods_name 1　　　　　　　りんご 2　　　　　　　みかん 3　　　　　　　いちご テーブル名：member（顧客データ） member_no　｜　member_name 1　　　　　　　　　　鈴木 2　　　　　　　　　　佐藤 3　　　　　　　　　　小林 4　　　　　　　　　　斉藤 テーブル名：slip（伝票番号） slip_no｜sales_member_no｜sales_date 1　　　　　　　2　　　　　　　　2013-6-1 2　　　　　　　4　　　　　　　　2013-6-1 3　　　　　　　1　　　　　　　　2013-6-2 4　　　　　　　3　　　　　　　　2013-6-3 ※slip.sales_member_no = member.member_noです。 テーブル名：sales（売上から入金までのデータを時系列で登録） sales_no｜sale_slip_no｜sales_goods_no｜sales_goods_price｜sales_goods_cnt｜request｜receipt 1　　　　　　　1　　　　　　　　　2　　　　　　　350　　　　　　　　5　　　　　　1750 2　　　　　　　1　　　　　　　　　3　　　　　　　400　　　　　　　　3　　　　　　1200 3　　　　　　　2　　　　　　　　　1　　　　　　　200　　　　　　　　5　　　　　　1000 4　　　　　　　2　　　　　　　　　3　　　　　　　400　　　　　　　　4　　　　　　1600 5　　　　　　　1　　　　　　　　receipt　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　2950 6　　　　　　　2　　　　　　　　receipt　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　2600 7　　　　　　　3　　　　　　　　1　　　　　　　200　　　　　　　　8　　　　　　1600 8　　　　　　　4　　　　　　　　2　　　　　　　350　　　　　　　　5　　　　　　1750 9　　　　　　　3　　　　　　　　receipt　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　1600 10　　　　　 　4　　　　　　　　receipt　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　1750 ※sales.sale_slip_no=slip.slip_noです。 sales.sales_goods_no=goods.goods_noです。 以上のようなテーブルがあり、4つのテーブルを結合して、 伝票単位で、売上詳細（sales）、商品名(goods）、顧客名（member）を以下のように伝票番号順で一覧で表示したいと考えていますが、エラーだったり、期待している結果を得ることが出来ません。 どのようにすれば宜しいのかアドバイスのほど頂戴出来れば幸いです。 slip_no　　商品名　個数 単価　　請求額　入金額 1　　　　　みかん　　5　　　350　　1750 1　　　　　いちご　　3　　　400　　1200 1　　　　　　　　　　　　　　　　　　　　　　　　　2950 2　　　　　りんご　　5　　　200　　1000 2　　　　　いちご　　4　　　400　　1600 2　　　　　　　　　　　　　　　　　　　　　　　　　2600 3　　　　　りんご　　8　　　200　　1600 3　　　　　　　　　　　　　　　　　　　　　　　　　1600 4　　　　　みかん　　5　　　350　　1750 4　　　　　　　　　　　　　　　　　　　　　　　　　1750 以上、お忙しい中恐縮ですが、宜しくお願い申し上げます。
お世話になります。 excelからADOでoracleのデータベースにある テーブルの必要なデータのみを抽出してexcelに 書き出そうとしています。 excelのvbaコードで、まず、ADOコネクションの生成として、 「cn.Open "Provider=OraOLEDB.Oracle;Data Source=" & "DB名" & ";User ID=hpsuser;Password=○○○;", "○○○", "○○○"」と書き、 ADOレコードセットの生成で、 「 rs.Open "～(1)～", cn, adOpenDynamic, adLockOptimistic, adCmdText」 と書いていますが、上記「～(1)～」の部分がかなり長いクエリ文になっているからなのか、 エラーがかかってしまいます。 単純なテーブルのデータを呼び出す事しかできないのか、又、 長いクエリ文のデータを抽出したい場合どの様にしたら良いのか、 どなたかご親切な方、ご教示頂けます様、宜しくお願いいたします。
テーブルA：承認が必要なデータが保存されます。 テーブルB：承認が完了したデータが保存されます。 承認処理はWebからオンライン処理で行います。 承認完了後、バッチ処理でテーブルBに内容をコピーします。 承認完了時の処理として、以下の２パターンのどちらにするかで悩んでいます。 １．テーブルAの完了フラグをONにする。 　　バッチ処理は、テーブルAの完了フラグがONのデータを対象とする。 ２．新たにテーブルCを設け、承認完了したデータをコピーする。 　　バッチ処理は、テーブルCに存在するデータを対象とする。 １は、完了・未完了が混在するデータの中から完了データを抽出しますが テーブルAの完了フラグに索引をつけておけば気にする必要がないのでしょうか？ ２は、存在するデータ全てが処理対象となる為、データの抽出は用意ですが その為だけのテーブルCを作るのもありなのでしょうか？ なお、データ件数は最大で５０万件程度を想定しています。
お世話になります。 ファイルメーカーでがフィールドの内容が未入力分のレコードのみを検索する方法はあるのでしょうか？ 入力のし忘れや、未確定案件のレコードを探すのに現在困っています。 当方Intel iMac 2.66、Mac OS X 10.6スノーレパード FileMaker Ver10です。
MYSQL初心者です。 簡単なメッセ機能を作りたいと思っています。 MyISAMテーブルを使おうとしています テーブルロックならしようとおもえばなんとかできます 質問（ロックしなかった場合） 複数の人が同時に書き込んだ(INSERTした)ときにどんな壊れ方をするんでしょうか? 一番最後の書き込まれた行だけ壊れるんですか？ 壊れ方はどんなふうになるんですか？書き込まれないだけですか？ 壊れた後でも、書き込みはできますか？ テーブルロックしておけば重複したINSERTはふせげますか？
mysqlで表の結合。 下記のように書きましたが、うまく動きません。 「left JOIN kashu ka2 ON song.kashu_2_ID = ka2.kashu_ID」 「ka2.kashu as kashu2」 ↑この部分、2つを追加しました。 何も表示されませんでした。 上の二つを削除すると動きます。 何がいけないのでしょうか？ mysql_query("SELECT song.song_ID, song_name, song_name_yomi, kashu, kashu_yomi, sakushi, sakushi_yomi, sakkyoku, sakkyoku_yomi, hennkyoku, hennkyoku_yomi, tie_up.tie_up, ti2.tie_up as tie_up2, ka2.kashu as kashu2 FROM (((((( song left JOIN kashu ON song.kashu_1_ID = kashu.kashu_ID) left JOIN kashu ka2 ON song.kashu_2_ID = ka2.kashu_ID) left JOIN sakushi ON song.sakushi_ID = sakushi.sakushi_ID) left JOIN sakkyoku ON song.sakkyoku_ID = sakkyoku.sakkyoku_ID) left JOIN hennkyoku ON song.hennkyoku_ID = hennkyoku.hennkyoku_ID) left JOIN tie_up ON song.tie_up_1_ID = tie_up.tie_up_ID) left JOIN tie_up ti2 ON song.tie_up_2_ID = ti2.tie_up_ID where song_name like '%%'");
Oracle11gでlistener.logが肥大化し、4GBまでいってしまい、 停止しました。 ログをスイッチし、Oracleは動作したのですが、 アプリケーションサーバからアプリケーションが動作しません。 例えば、SQLPLUSでSQLを発行すると正常ですが、 dllからは動作しません。 なんとなくですが、with句を用いたものが失敗しているようです。 やっぱりアプリケーションサーバを再起動でしょうか？ 日曜日まで再起動ができないため、何か方法があればご教示ください。
SELECT MAX文で、フィールドの最大値を出しています。 これまで、何の問題もなく動作していたのですが、フィールドの数値が9999を超えたとたん、10000、10001などの数値があっても常に9999を最大値として返してくるようになりました。 どうしてでしょうか? 【説明】 A. 例文は次のようなものです。 SELECT MAX(`idc`) from testinvoice; B. `idc`は長さ13のVARCHERです。整数がLatin1で収納されています。 C. `idc`に収納されているデータは、1580からはじまって、9998、9999、10000、10001まで続く約8500件の連番(整数)です。 D. これまで何年も問題なく最大値を出してきました。 とても不思議です。
こんにちは！みなさんのお知恵をお借りしたいと思っています。 下記の要件を満たすDB設計をしたいです。 MySQL5.5 + Java 5で実装予定です。 システム概要 (1)ユーザはWebサイトにて、ポイントを購入し、ポイントを使用することでアイテムが購入できる。 (2)ポイントは常時、購入することが可能で、アイテムも同様に常時、購入可能である。 (3)ポイントには有効期限があり、購入日から有効期限(1年)が過ぎたポイントは無効となる。 (4)購入するポイント数はユーザが任意の値を入力することができる。 (5)アイテムを購入する際に必要なポイント数は、アイテムによって異なる。 (6)ポイントが消失するのは月末である。 (例.2013年7月に購入したポイントは2014年8月1日になると消失する) (5)ユーザー数は300万程度 満たしたい要件 ・現在のポイント残高はWebサイトにて常時閲覧可能としたい。 ・当月に無効となるポイント数は常時閲覧可能としたい ・Webサイトをメンテナンスにして、バッチを流すなどの処理はなるべく避けたい。 お知恵を貸して頂けると幸いです。よろしくお願いします！
■phpMyAdminでint型フィールドへインポート int型のフィールドへcsvファイルからインポートする際に、元データが空白の場合にインポートするとそのフィールドに勝手に「0」が入ってしまいます。 勝手に「0」が入らないようにするにはどのようにしたらいいのでしょうか。 宜しくお願いします。
お世話になります。 phpPgAdminで更新作業をしていまして 一件一項目の更新で update "store_table" set "tenpo_add" = '東京都１－１－１' where "kaiin_no" = '123456'; とした場合はうまく更新でできたのですが、以下のように複数項目の更新が文法エラーになります。 update "store_table" set "tenpo_post1","tenpo_post2","tenpo_add" = '123','4321','東京都１－１－１' where "kaiin_no" = '123456'; このようにした場合、　　","　←この部分が文法上おかしいとのエラーが出ました。 どのように記載すれば良いかご指導いただければ幸いでございます。。
XAMPPを再インストールして パスワードなどを設定して phpmyadminを起動させると 見覚えのない赤字のビックリマークが出現していました 何が原因なのでしょうか？よろしくお願いします。
下記のようなSQLについてご指南頂きたく思います。 下記のようなテーブルがあり、 商品毎の売上を販売店毎に 売れた順に格納しています。 ＜販売テーブル＞ No　|　商品コード　|　販売個数　|　販売店コード --------------------------------------------- 1　　|　商品A　　　|　　　1　　|　1 2　　|　商品A　　　|　　　1　　|　2 3　　|　商品A　　　|　　　1　　|　3 4　　|　商品B　　　|　　　2　　|　1 5　　|　商品B　　　|　　　2　　|　2 6　　|　商品B　　　|　　　1　　|　3 7　　|　商品A　　　|　　　3　　|　1 8　　|　商品A　　　|　　　4　　|　2 9　　|　商品A　　　|　　　1　　|　3 　 上記のテーブルを使って下記のようなデータを取ってきたく考えております。 　　|商品コード|販売個数　　　　　　　　　　　　　　|販売店コード　|商品コード毎販売個数合計 　　|　　　　　　　|※ある商品の店毎の販売総数|　　　　　　　　　　|※ある商品の販売総数 　　-------------------------------------------------------------------------------- 　　|　商品A　　|　　　4　　　　　　　　　　　　　　　|　1　　　　　　　　|　11 　　|　商品A　　|　　　5　　　　　　　　　　　　　　　|　2　　　　　　　　|　11 　　|　商品A　　|　　　2　　　　　　　　　　　　　　　|　3　　　　　　　　|　11 　　|　商品B　　|　　　2　　　　　　　　　　　　　　　|　1　　　　　　　　|　　5 　　|　商品B　　|　　　2　　　　　　　　　　　　　　　|　2　　　　　　　　|　　5 　　|　商品B　　|　　　1　　　　　　　　　　　　　　　|　3　　　　　　　　|　　5 　　----------------------------------------------------------------------------- 　　やり方としては下記の(1)と(2)の結合ができれば良いと考えております。 　　一回のSQLで上記の結果を得られるようにしたいと考えております。 　　どなたかアドバイス頂ければと思います。 　　宜しくお願い致します。 (1)下記のようなSELECT文で商品コード毎の集計はできました。 　　　SELECT　商品コード,SUM(販売個数)　FROM　販売テーブル　group　by　販売テーブル.商品コード; 　　|　商品コード　　|販売個数　　　　　　　　　　 　　|　　　　　　　　　|※ある商品の店毎の販売総数 　　--------------------------------------- 　　|　商品A　　 　　|　　11　　　　　　　　　　 　　|　商品B　　 　　|　　　5　　　　　　　　　 (2)また、下記のようなSELECT文で販売店、商品コード毎の集計もできました。 　　　SELECT　商品コード,　SUM(販売個数),　販売店コード　FROM　販売テーブル　 　　　　　　　　　　　　　　　　　　　　　GROUP　BY　CONCAT(商品コード,'and',販売店コード)　; 　　|　商品コード　|販売個数　　 　　　　　　　　　　　|販売店コード 　　|　　　　　　　　|※ある商品の店毎の販売総数　|　　　　　 　　---------------------------------------------------- 　　|　商品A　　　|　　　4　　　　　　　　　　　　　　　　|　1　　　　 　　|　商品A　　　|　　　5　　　　　　　　　　　　　　　　|　2　　　　 　　|　商品A　　　|　　　2　　　　　　　　　　　　　　　　|　3　　　　 　　|　商品B　　　|　　　2　　　　　　　　　　　　　　　　|　1　　　　 　　|　商品B　　　|　　　2　　　　　　　　　　　　　　　　|　2　　　　 　　|　商品B　　　|　　　1　　　　　　　　　　　　　　　　|　3　　　　 　　----------------------------------------------------
お世話になります。 ファイルメーカーで納品書、作業指示書等の管理をしていますが、プリント時の文字数の制限等から基本カタカナは半角を使うとの社内ルールができています。 顧客よりメールで来た内容をコピー・ペーストして使いたいのですが、大抵の場合は全角カタカナを使用されているため打ち直す必要があります。 そこで全角を半角にするKanaHankaku関数を使用し、文字変換用のデータベースを作りそれを利用しています。 内容としては元となるテキスト用のフィールドとそれを変換するためのフィールドだけの簡単なものです。 しかし元のメールの文字の色や太さも反映されてしまうため、これらの書式を調整しなおす必要があります。これらの書式情報をクリアする関数やスクリプトの組み方があれば教えていただけないでしょうか。
2つのテーブルで、同じユーザテーブルを参照してデータ取得したいのですが、 どうやって結合すれば良いのでしょうか？ ■概要 ・ユーザがアクションに挑戦すると、結果を表示 ・その際、「アクション作成者」と「アクション挑戦者(ユーザ)」を表示したい ※「作成者」「挑戦者」は、同じ「user」テーブルで管理したい ■3テーブル ・「result」「action」「user」 ・「result」「action」テーブルには、それぞれ「user_id」カラムがある ・「result」テーブルには、「action_id」カラムがある。1対多？ ■知りたいこと ・一気にまとめて一覧として取得する方法 ・最終的に「結果」と、「result」「action」それぞれに対応した「user」テーブルの「name」カラムを取得したい ■試してみたこと ・これだと「挑戦者名」が取得できない 　　　　　　SELECT * 　　　　　　　FROM result r 　　　　　　　　LEFT JOIN `action` a ON r.`action_id` = a.`id` 　　　　　　　　LEFT JOIN `user` u ON r.`user_id` = u.`id` ・これだと「挑戦者」のユーザIDしか取得できない 　　　　　　SELECT *,a.user_id AS actionuser_id 　　　　　　　FROM result r 　　　　　　　　LEFT JOIN `action` a ON r.`action_id` = a.`id` 　　　　　　　　LEFT JOIN `user` u ON a.`user_id` = u.`id`
はじめまして。 手元にAccess97で作成したmdbファイルがるのでが、Windows7環境のAccess2007で開くことができません。 エラーメッセージは、「オブジェクト 'テーブル1'が見つかれませんでした。オブジェクトが存在していること、名前やパス名が正しいことを確認してください。」となっています。 このファイルをAccess2007で開くためには、いったんAccess2000～Access2003で保存し直したうえで、Access2007で開く必要があるという情報をMSのページで見ました。 しかし私はAccess2000～Access2003環境を持っておりません。 そのような中で、このAccess97で作成したmdbファイルを開かなければならないのですが、何か方法はないでしょうか。 ご教示いただけると誠に幸いです。 どうぞよろしくお願いいたします。
XP上のmdbファイル(2003形式)にDelphi7で作成したプログラムからADO（TADOConnection）で接続しています。 使い方は通信のログをmdbに追加していくというものです。 最初は動いているのですが、600～700件程度追加すると「メモリ不足です」というエラーが出て追加できなくなってしまいます。 しかし、プログラムを再起動すると、動くようになります。 メモリの状態を確認すると、 起動直後 約270MB ⇒ エラー発生時 約360MB で、メモリはまだまだ余裕があるように見受けられます。 検索して調べたところ、レジストリからMaxLocksPerFileの値を変更する方法があったため、 9500 ⇒ 200000 ⇒ 6000000 のように増やしてみましたが、効果はありませんでした。 また、ある程度動かしたら、TADOConnectionのオブジェクトを解放して再作成するように変更してみましたが、こちらも効果はありませんでした。（メモリも減っていない。キャッシュされている？） 以前はデータベースにSQL Serverを使っていたのですが、 諸事情でmdbに変更することになりました。 SQL Serverのときはこのような問題はありませんでした。 その他の情報は以下の通りです。 メモリ：512MB プロバイダ：Microsoft Jet 4.0 OLE DB Provider 原因と対策をご存知の方がいらしたら、よろしくお願いします。
部名（製造部・販売部など)、課名（製造一課・販売一課など）、係名（製造一係、販売一係など）のテーブルを作り、各部門宛ての請求書を作成しようとしています。 宛先は部名、課名、係名のコンボボックスから選択することを想定していますが、部名を選択すると、課名のコンボボックスには選択した部に所属する課だけがリストされるようにできないでしょうか。 よろしくお願いします。
オラクル初心者です。 データベースを構築するにあたってマテリアライズドビューを以下のようなロジックで作成しています。 SELECT A.a, A.b, CASE WHEN (A.c)-(A.d) AS sa その際、(A.c)-(A.d) の差の値によって saの値を変えたいと思っています。 具体的には、(A.c)-(A.d)の差が正の値であるなら、saにはその値を、 (A.c)-(A.d)の値が負の値なら、saには0を出力させたいと考えています。 CASE WHEN ( CASE WHEN (A.c)-(A.d) > 0　THEN … )AS saと書くと右（）が足りないと怒られてしまおます。 この場合、どのようにロジックを書けばよいのでしょうか。 ご回答よろしくお願いします。
MySQLの「 INT」型と「 DATETIME」型の違いを教えてください。 ・「 DATETIME」型とは、単に日付形式を担保してくれる型に過ぎないのでしょうか？ ・日付形式(フォーマット)以外を挿入すると、「0000」になってしまうということでしょうか？ ■「 DATETIME」メリット ・データ内容が見た目で分かる以外、何があるのでしょうか？ ■「 INT」メリット ・早い？
SQLITEで全角テーブルアップデート こんにちは。SQLITEでアップデートをしたいと思っています。問題がテーブル名が全角文字です。 テーブル名： T_在庫 フィールド： 商品コード,在庫 001,3 002,2 003,5 下記のSELECT文は動きます。 SELECT "T_在庫"."商品コード","T_在庫"."在庫" FROM "T_在庫" 次にUPDATEをかけたいと思っています。 UPDATE "T_在庫" SET "T_在庫"."在庫" = 0 [Err] 1 - near ".": syntax error このように表示されます。 試しに、ダブルクォテーションを外しても同じです。 どのようにすればSQLITEでアップデートがかけることができるのでしょうか？文法は間違っていないとは思うのですが・・・
●質問の主旨 phpMyAdminのMySQLで ストアドプロシージャの動作確認をしています。 試しに、 delimiter // create procedure pr30() begin select * from tb; select * from tb1l; select * from tb1; end // delimiter ; というプロシージャを作成して、 実行を押しても、画面が全く変化しません。 エラーの表示さえされません。 （もちろんデータベーステーブルのtb、tb1l、tb1が 存在することは確認済みです） また、作成している最中に、 命令文が勝手に消えることもあります。 普通に select * from tb; と、書いていても消えることはないのですが…。 この現象や対策についてご存知の方がいらっしゃいましたら、 アドバイスをお願いします。 ●環境 windows8 xammp1.8.1 phpMyAdmin3.5.2.2 MySQL5.5.27
現在MySQL Adminにアクセスしています。 選択できるデータベースが多数あります。 このデータベース内の特定のテーブルの最終更新日が1ヶ月以内のものが何があるのか調べたい時どのような方法がありますか？
次の２つのテーブルがあります。 テーブル master 形式kata 客先kyaku コードcode テーブル data 形式kata 客先kyaku 発行年月hakko 数量suryo 発行年月が201303と201305の両方があるマスタを抜き出したいため、次のＳＱＬを考えました。 select m.kata,m.kyaku,m.code from master m join data d on m.kata=d.kata and m.kyaku=d.kyaku where 201303 in (select d.hakko from data d where m.kata=d.kata and m.kyaku=d.kyaku) and 201305 in (select d.hakko from data d where m.kata=d.kata and m.kyaku=d.kyaku) 無駄があるようで、また速度向上したいのですが、どう記述していいか分かりません。 教えてください。
■環境 ・PHP+MySQL ■質問 ・「順位データ」の持ち方について教えてください ・「順位データ」はデータベース側で保存するものでしょうか？ ・あるいはPHPで都度処理するのでしょうか？ ・ケースバイケース？ ■データベース側で保存する場合 ・「通常データ」だと、該当レコードを「挿入」もしくは「更新」すればそれで済みますが、「順位データ」だと1件データを「挿入」もしくは「更新」するだけで、全レコードに影響を及ぼす可能性があります ・この場合、1レコードでもデータを変更したら、全レコードに変更処理をかけるしかないのでしょうか？
将来的にRACのクラスタ構成のDBサーバを導入するのですが、それにあたって事前に勉強しておく目的で、社内の余ったマシンを使って、RACを構築しようとしています。そもそも2台だけで構築は可能なものでしょうか？Oracleの版数は11gR2です。普通にやると外部の共有ディスクが必要のようなのですが、資産としてないので、可能であれば2台のマシンでなんとか構築したいと考えています。 今、実際にOracle Linux 6.4をインストールしました。BindのDNSインストール・設定も完了し、Oracle Grid Infrastructureのインストールを始めたところです。Storage Optionの画面で、 (1) ASM (2) Shared File System が選択出来るところまで来ています。ASMを選んで次に進むと、本来であればディスクの候補のリストが下に表示されるのでしょうが、何も表示されません。ここは、共有ディスクを購入すれば出てくるということなのでしょうか？ Amazonで検索したところバッファローやIODataなどの安価なNASが二万円前後で買えなくもないのですが、そういったものでも使えるはずなのでしょうか？ 2台のマシンにはそれなりの容量の内臓HDDがあるので、これらを流用して何とか構築したいです。。　また、(2)のShared File System（共有ファイルシステム）とは、NFSといった話でしょうか？　あまりASMとの違いがわかっていないのでご教示頂けると助かります。　NFSで構成する、という話であれば、もう一台だけオンボロマシンがないこともないのでOracle Linuxを導入してNFSとして構築できなくもないかもしれませんが、3台構成で複雑になるので避けたいです。。 お手数ですがおわかりの方いらっしゃいましたらご回答お願いします。
LAMP環境で開発をしています。 SQL文でCOUNTを求める際に、まとめて結果を求めようとして上手く行きません。 状況としては以下です。 テーブルdはidをkeyにa,b,c３つのテーブルとjoinしています。 id = 1の場合、テーブルa,b,cにマッチするレコードがそれぞれに４個、１個、０個あります。 ひとつひとつを SELECT COUNT(CASE WHEN a.name IS null THEN 1 ELSE null END) as a_count FROM d INNER JOIN a ON a.id = d.id WHERE d.id = 1 として結果を求めると4,1,0と出るのですが、まとめて SELECT COUNT(CASE WHEN a.name IS null THEN 1 ELSE null END) as a_count, COUNT(CASE WHEN b.name IS null THEN 1 ELSE null END) as b_count, COUNT(CASE WHEN c.name IS null THEN 1 ELSE null END) as c_count FROM d INNER JOIN a ON a.id = d.id INNER JOIN b ON b.id = d.id INNER JOIN c ON c.id = d.id WHERE d.id = 1 とすると28,5,0という値が返されます。 どのように書けば正しい4,1,0を得られるのでしょうか？ よろしくお願いします。
Mysql+phpで日報システムを作っています。 独学でWebサイトの情報を見ながら作っているのですが、 更新系の処理に手間取っています。 環境は以下の通りです。 PHP:5.2.4 OS:WindowsServer2003 SP1 MYSQL:5.1.41 元画面から、ボタンを押してDBの更新処理を行うと、画面が真っ白になってしまい固まった状態になります。 MYSQLの問題かなと当初は思ったのですが、更新自体もされてはいますので、PHPの問題ではと思い投稿させて頂きました。 他の参照系のスクリプトは正常に動作します。 ちなみに、この現象はIEでしか出ません。 FFやChromeでは正常に動作します。 ポップアップブロックも外し、IEのアドインを全部外してみましたが、結果は同じでした。 同様の事態を経験された方、考えられる原因を御存じの方がおられましたら、コメント頂ければ幸いです。 更新スクリプトの内容は以下の通りです。 <?php // MySQL 接続 if (!($cn = mysql_connect("192.168.*.***", "user", "password"))) { die; } // MySQL DB 選択 if (!(mysql_select_db("mydatabase",$cn))) { die; } 　　（中略） $SQL="UPDATE NIPPO SET = ***** "; 　　（中略） print $SQL; // ***** この内容が出ずに固まっている ****** $sts = mysql_query($SQL,$cn); if (!$sts) { print "<br><img src='img/error.jpg' width=32 height=32>"; print "更新に失敗しました。"; print "<br><A HREF='javascript:history.back()'>前のページに戻る</A>"; } else { print "<br><img src='img/inf.jpg' width=32 height=32>更新しました。"; print "<br><A HREF='moto.php'>前のページに戻る</A>"; } } ?> </body> </html>
今回、InnoDBとMyISAMの Auto Increments(以下AI）の挙動に対する 対処方法についての質問になります。 以前は5.1のMySQLを使用していましたが、 最近利用しているホスティング会社の方で変更があり、 MySQL5.6へのバージョンアップが行われ、 そこから発生している問題です。 例えば testtb ------------- id item ------------- 1 aaa 2 bbb 3 ccc ------------- というテーブルがあります。（InnoDB） idはプライマリーキーでAIが設定されています。 基本的にこのテーブルでは itemのアップデートくらいで、 レコードを削除するような動作は起こりません。 ところが管理者サイドのテストの際に 下記のように、でMAX(id)を抽出してそのレコードを削除し、 AIの値を削除したMAX(id)に変更するという動作が稀に発生します。 $sql = "SELECT max(id) FROM testtb "; $result = mysql_query($sql, $con); $maxid = mysql_result($result, 0); $sql = "DELETE FROM testtb WHERE id = '{$maxid}' "; mysql_query($sql, $con); $sql = "ALTER TABLE testtb AUTO_INCREMENT = {$maxid} "; mysql_query($sql, $con); 要するにテストで登録した最新idのレコードを削除し、 AI値も元に戻してテスト前の状態に復旧するという内容です。 以前のMySQLのバージョンでは これが問題なく動作していましたが、 MySQL5.6に変わってから InnoDBの場合には、 ALTER TABLE testtb AUTO_INCREMENT = {$maxid} このSQL文を実行しても結果が全く反映されません。 phpmyadminからも実行してみましたが 実行結果にエラーはでないのですが、 同様に結果は反映されず、AI値の変更が行われません。 少しググってみて、innodb_autoinc_lock_mode の設定が関係しているのではと思い見てみると innodb_autoinc_lock_mode = 1になっていました。 ちなみにこの値は共有DBのため、 ホスティング会社の方での固有の設定で 私の方で変更はできません。 上記の問題はMyISAMでは発生しませんので、 InnoDB固有の特徴によるものかと思います。 innodb_autoinc_lock_modeの設定変更なしで 上記を解消する方法はありますでしょうか？ もうMyISAMで運用するくらいしか方法が見つかりません。 それからこれに関連する内容で もう一つ質問があります。 これはphpmyadminに関する質問なのですが、 以前ですと、テーブルを選んで 上メニューの「操作」という箇所から AIの値が確認できて変更もできたかと思うのですが 現在はAIの値を操作する箇所が全く見当たりません。 確認のためにSHOW TABLE STATUSを実行する以外に 確認・変更のできる場所はありませんでしょうか？ ちなみにphpmyadminのバージョンは4.0.0です。 よろしくお願いいたします。
下記のようなテーブルで、　レベル4以下で点数が入力されているMAXの行を持ってくるにはどうしたらよいでしょうか？よろしくお願いいたします。 職員番号氏名レベル点数 01000山田　花子4 01000山田　花子340 01000山田　花子230 01000山田　花子120 01100田中　あああ410 01100田中　あああ320 01100田中　あああ230 01100田中　あああ140 01200佐藤　あああ4 01200佐藤　あああ3 01200佐藤　あああ230 01200佐藤　あああ140 この場合欲しい結果は　職員番号01000の人は点数40点の行、01100の人は点数10点の行、01200の人は点数30点の行　　3行を表示したいです。
都道府県TB 県ID 地域名 県名 参加県TB 県ID 参加県TBに県IDが無い分を都道府県TBから削除したい。ただし、都道府県TBの地域名="東北"という条件で DELETE FROM 都道府県TB WHERE 都道府県TB.地域名='東北' ～～～ WHERE 参加県TB.県ID Is Null どんな記述になるのでしょうか？(質問の意図を汲みとって頂ければ幸ですが。)
INDEXが着いていないカラムをSELECTで検索しても他のカラムにプライマリーキーがあれば、検索は高速になるのでしょか? テーブル ID、NAME IDにプライマリーキーが付いていて、NAMEのカラムのみを検索するときにも高速になるのでしょうか？
Oracle Linuxのインストールされているnode1、node2をRAC構成にするために今Oracle Grid Infrastructureをインストールしようとしています。Cluster Node Informationの画面で今Hostname（及びVirtual IP Name）を2台追加しました。 ・node1.abc.com（VIP: node1-vip.abc.com） ・node2.abc.com（VIP: node2-vip.abc.com） 次にSSH ConnectivityのボタンからOSユーザgridとパスワードを入力し、Setupを押したところ、正常に完了しました。試しに各ノードのターミナル上から $ ssh node1.abc.com date $ ssh node2.abc.com date と打つとパスワード入力抜きで日付が表示されますので、実際に設定は成功していると考えます。しかしこの状態で次の画面に進もうとすると（もしくはTestボタンを押すと）次のようなエラーメッセージが表示されます。 [INS-06006] Passwordless SSH connectivity not set up between the follwoing node(s): [node1, node2] なぜこのようなことが起きるのでしょうか？ どのようにすれば回避できますでしょうか？ 以上、宜しくお願いします。
「INT」でかつ「AUTO_INCREMENT」のカラムに0をINSERTしようとするとうまくいかないのですが、 「AUTO_INCREMENT」では0はダメなのでしょうか？ それとも「INT」だから？
データーベースが下記の様にあります、 PHPファイル内で、 この様なSQLを実行して下記の様にprintしてみましたが、 tie_upの部分、AIRとしか表示されません。 このPHPファイル内のprint($row['tie_up']);部分が怪しそうですが、 解決策が思いつきません。 もちろん、外部キーの設定も済んでいます。 --下記、SQL文-- SELECT * FROM ((((( song left JOIN kashu ON song.kashu_ID = kashu.kashu_ID) left JOIN sakushi ON song.sakushi_ID = sakushi.sakushi_ID) left JOIN sakkyoku ON song.sakkyoku_ID = sakkyoku.sakkyoku_ID) left JOIN hennkyoku ON song.hennkyoku_ID = hennkyoku.hennkyoku_ID) left JOIN tie_up ON song.tie_up_1_ID = tie_up.tie_up_ID) LEFT JOIN tie_up ti2 ON song.tie_up_2_ID = ti2.tie_up_ID --SQL文、終わり-- --下記、phpファイル内のprint文-- while ($row = mysql_fetch_assoc($result)) { print($row['tie_up']); } --print文、終わり-- --データベース-- song +-----------+--------------------+--------------------+--------------------+ |　ID　　　|　song_name　｜　tie_up_1_ID　|　tie_up_2_ID　| +-----------+--------------------+--------------------+--------------------+ |　0　　　|　鳥の詩　　　　|　0　　　　　　　|　0　　　　　　| +-----------+--------------------+--------------------+--------------------+ |　1　　　|　青空　　　　　|　1　　　　　　　|　0　　　　　　| +-----------+--------------------+--------------------+--------------------+ tie_up +----------------+--------------------+------------------------+ |　tie_up_ID　|　tie_up　　　　｜　tie_up_yomi　　| +----------------+--------------------+------------------------+ |　0　　　　　|　AIR　　　　　|　エアー　　　　　　| +----------------+--------------------+------------------------+ |　1　　　　　|　CLANNAD　　|　クラナド　　　　　| +----------------+--------------------+------------------------+ --データベース、終わり--
関係有りそうな部分だけ抜粋します。 mysqlで外部キーを設定して、 下記のようなSQLを実行してみましたが、 #1066 - Not unique table/alias: 'tie_up'と エラーメッセージが表示されました。 何がおかしいのでしょうか？ 外部キーは「song」テーブルの「tie_up_1_ID」、同「song」テーブルの「tie_up_2_ID」、 それと「tie_up」テーブルの「tie_up」です。 SQLを触るの5年振りなんで・・・。 SELECT * FROM ((((( song left JOIN kashu ON song.kashu_ID = kashu.kashu_ID) left JOIN sakushi ON song.sakushi_ID = sakushi.sakushi_ID) left JOIN sakkyoku ON song.sakkyoku_ID = sakkyoku.sakkyoku_ID) left JOIN hennkyoku ON song.hennkyoku_ID = hennkyoku.hennkyoku_ID) left JOIN tie_up ON song.tie_up_1_ID = tie_up.tie_up_ID) left JOIN tie_up ON song.tie_up_2_ID = tie_up.tie_up_ID;
SQL Server 2005 Express Edition Service Pack 4をWindows8(64bit)が入ったPCにインストールしようとしています。 32bitと64bitの両方がサポートされたSQLEXPR_JPN.EXEをダウンロードし、インストールを実行すると、64bitマシンなのに、なぜかデータベースサービス等全てProgram Files (x86)配下にインストールされます。 以前、同じくWindows8(64bit)が入っている別マシンにSQL Server 2005 Expressをインストールしたことがありますが、その時はProgram Files配下にインストールされ、64bitとして認識されたようです。 ちなみに、SQL Serve 2008、2008 R2、2012等は、きちんと64bitとしてインストールされております。 64bitのみのインストーラーや、64bitとしてインストールというインストールオプションがあれば良いのですが・・・ 同じ64bitのWindows8にインストールしようとしているのに、なぜ、このような違いがあるのかわかりません。 どなたか、正常に64bitとしてインストールできる方法をご存知であれば教えてください。
jspファイルを実行するとカラムが見つかりませんというエラーが出ました。 対象のテーブルにoniカラムは置いてあります。 どこを見直せば良いのでしょうか？よろしくお願いします。 java.sql.SQLException: Column 'oni' not found. at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1078) at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:989) at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:975) at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:920) at com.mysql.jdbc.ResultSetImpl.findColumn(ResultSetImpl.java:1167) at com.mysql.jdbc.ResultSetImpl.getInt(ResultSetImpl.java:2851) at org.apache.tomcat.dbcp.dbcp.DelegatingResultSet.getInt(DelegatingResultSet.java:275) at org.apache.tomcat.dbcp.dbcp.DelegatingResultSet.getInt(DelegatingResultSet.java:275) at suika.SuikaDAO.findKeisanByID(SuikaDAO.java:134) at suika.SuikaServlet.doPost(SuikaServlet.java:39) at javax.servlet.http.HttpServlet.service(HttpServlet.java:647) at javax.servlet.http.HttpServlet.service(HttpServlet.java:728) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210) at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222) at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123) at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472) at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171) at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99) at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:953) at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118) at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:408) at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1023) at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589) at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) at java.lang.Thread.run(Thread.java:722)
下記のようにテーブルが有り、外部キーの設定も済んでいますが、 PHPファイル内で「select * form song WHERE song_name LIKE '%%'」と実行すると 「0,眠り姫,0」と表示されます。 このsql文を実行した上の結果の一番右側を「0」でなく「栗林みな実」と出力したいのですが、 なにぶん最後にsqlを扱ったのが5年以上前で、 全部頭から抜けてしまっていますorz 外部キーは「song」テーブルのkashu_IDと「kashu」テーブルのkashu_IDに設定してあります。 mysqlのバージョンは5.1.69
tainyint型のテーブルを作成することは可能でしょうか？ create table テーブル1 (年 smallint , 月 tinyint); 上記を実行すると、「フィールド定義の構文エラーです。」と なります。 tinyint型のテーブルを作成する、create文を教えてください。 よろしくお願いします。
CentOS 6.4をインストールし、標準装備のpostgresql 8.4をインストールしました。 この環境にpgadmin3をインストールしたいのですが、最も簡単な方法を教えて下さい。 ネットで調べると、「ソフトウェアの追加／削除」から「pgadmin3」を検索し、ヒットしたモジュールにチェックを付ければインストールが完了するような事を書いていましたが、「ソフトウェアの追加／削除」で検索してもモジュールはヒットしません。 http://www.linuxmania.jp/postgresql_01.html 例ではCentOS 5でしたので、念のためにCentOS 5で試しましたが、やはり出来ません。 yumでインストールできるような事を書いているのもありましたが、 yum list 上にpgadmin3は見当たりません。 うーん、という感じです。
（テーブルA）と（テーブルB）をleft joinした際の結合条件について 詳しい方に伺いたいのですが、 on以下の部分は、（テーブルAの中にあるカラム）と（テーブルBの中にあるカラム）を 比較するような文でなければいけないですか？ 例えば、、、 ------------------------------------------------------------------------- SELECT* FROM 　timeTpl2 AS t LEFT JOIN booked AS b ON 　t.start = b.startTime AND 　b.settingDay = $day ------------------------------------------------------------------------- 上記の最後の部分（b.settingDay = $day）は テーブルbにしかない要素を変数（$day）と比較しています。 ◆疑問 記述としてだいじょうぶかどうかを知りたいです。 つまりon以下結合条件は必ず左右のテーブルの、存在するカラム のみしか比較する事ができないかどうかが知りたいです。 よろしくお願いします。
LOTUS Domino Designer 7.0でデータベースを製作しております。 添付図のようにそれぞれ複数の属性を持った文書群を、属性ごとに昇順でソートして、 ビューに並べたいのです。 従ってビューには同じ文書が複数回登場します。 しかしスクリプトが全くわかりません。 GetAllDocumentsByKeyなどを使うのでしょうか？ ビューへの表示の仕方もわかりません。 どなたかご教授いただけないでしょうか。
1台のPCで発生している問題です。SQLServerで、Select命令は即戻ってくるのですが、Insertの処理は遅く、1件に2秒くらいかかっており、理由が分からず困っています。他のPCからは、SelectもInsertも問題ありません。 ＜SQLServer環境＞ ・バージョン：SQLServer2005 Express ・OS：WindowsXP ・ポート番号：1433固定 ＜クライアント環境＞ ・OS：Windows7 　※問題の発生しているPCも、問題の発生しないPCも、共に同じOS・同様のスペックです。 ＜当方でテストした内容＞ ※全テストで、実行前にテーブルはtruncateし、トランザクションは未使用で実行しています。 (1) 1件づつ Insertし、計3000件を登録 　　　→問題発生PCでは、1件に2秒くらいかかる。問題なしPCでは、3秒くらいで全て終了 (2) sqlBulkCopyを利用し、配列変数に格納したデータ計3000件を一括登録 (配列格納後に測定) 　　　→問題発生PCでは、15秒で30件くらい。問題なしPCでは、3秒くらいで全て終了 (3) bcpin で、テキストファイルの計3000件を登録 　　　→問題発生PCでは、30秒くらい経っても開始されず。問題なしPCでは、1秒くらいで全て終了 (4) Select命令発行 　　　→問題発生PC、問題なしPC　共に、1秒くらいで全て終了。 (5) bcpout で、テーブルより計3000件をテキストファイルに落とす 　　　→問題発生PC、問題なしPC　共に、1秒くらいで全て終了。 bcpinについては、ためしに、 -S IPアドレス\Express,1433 と、ポート番号を付けて実行もしてみましたが、結果は同じで、問題発生PCでは、開始に時間がかかり、問題なしPCでは即終了しました。 以上の結果より、問題なく動くクライアントもあるため、Server側の問題ではなく、問題発生クライアントPCの環境に問題があるのではないかと思っていますが、SQLServerの接続、Selectやbcpoutには問題なく、Insertやbcpinといったデータ挿入のみが遅いという点で、何に問題があるのか、さっぱり検討がつきません。 このような場合、どういった点を調査したらよいのでしょうか？
PostgreSQL（9.1.4）のストリーミング・レプリケーションについて 現在、半年ほどRails+PostgreSQL（9.1.4）で構成されたシステムを運用しております。 DBサーバ（PostgreSQL 9.1.4）を2台使用し、PostgreSQLのストリーミング・レプリケーション機能を用いて、サーバ間でのデータ同期処理を実現させておりました。 しかし、本日より、このストリーミング・レプリケーション機能が正常に動作せず、データの同期処理が行われない状態となってしまいました。 原因の調査方法が、分からず、どのようなログを見て、どのように対処すべきか、ご存知の方がいらっしゃいましたら、教えて頂けないでしょうか？ 何卒よろしくお願い申し上げます。
先日問い合わせたSQLの高速化についてEXPLAINについて教えて頂きました。 そのEXPLAINについて調べながら試していくと、同じphpファイル内で動かしている いくつかのSQL文に対してEXPLAINのtypeがALLとなっていたので対応すべき SQLだとは分かったのですが具体的にどのようなSQL文に書き換えればいいか 分からなかったので再度質問しました。 前提としてWORDPRESSでＳＱＬをＰＨＰファイル内で$wpdb->get_results関数を使って 実行しています。 (例1)　条件一致した件数を求めるSQL SELECT a_mst.a_id FROM a_mst WHERE a_mst.a_price >= 100 AND a_mst.a_price <= 200 AND a_mst.a_print_flg = 0 SQLのSELECT にCOUNT等は使わない方がいいようなので主キーのみを出力させて count関数で件数を求めています。 このＳＱＬ文をEXPLAINでphpMyadminで実行すると id=1　　　　　　　select_type=SIMPLE　　　table=a_mst type=ALL　　　　possible_keys=NULL　　　key=NULL key_len=NULL　　ref=NUL　　　　　　　　　　rows=a_mstに登録してある件数 Extra=Using where でした。SQL文自体はあるマスタにあるデータから値が１００～２００のもので、フラグが０のものを 出力するというシンプルなSQL文なのでどう改善すればよいのでしょうか？ (例２)　２つのテーブルを結合させて条件一致したデータをそれぞれテーブルから出力 SELECT a_mst.a_name, a_mst.a_price, b_mst.b_data FROM a_mst, b_mst WHERE a_mst.a_id = b_mst.b_id AND a_mst.a_price >= 100 AND a_mst.a_price <= 200 AND a_mst.a_print_flg = 0 ORDER BY a_mst.a_price , a_mst.a_id asc LIMIT 20 OFFSET 0 です。a_mstとb_mstをidで結合させて条件一致したあとにそれぞれの テーブルデータをSELECTしています。実際のSQL文はSELECT させている項目数は多いです。 このＳＱＬ文をEXPLAINでphpMyadminで実行すると ＜１行目＞ id=1　　　　　　　select_type=SIMPLE　　　　table=b_mst type=ALL　　　　possible_keys=PRIMARY　key=NULL key_len=NULL　　ref=NUL　　　　　　　　　　rows=a_mstに登録してある件数 Extra=Using temporary; Using filesort ＜２行目＞ id=1　　　　　　　　select_type=SIMPLE　　　　table=a_mst type=eq_ref　　　　possible_keys=PRIMARY　　key=PRIMARY key_len=NULL　　　ref=b_mst.b_id　　　　　　　rows=1 Extra=Using where でした。 EXPLAINを使ったチューニングなどしたことないSQL低級者なのでどのようなSQL文にすればtypeがALLの場合や、ExtraからUsing temporary; Using filesortを消すことができるのか分からないので教えて下さる方がいましたらよろしくお願いします。 ちなみに、a_mstとb_mstはphpMyadminにてそれぞれのテーブルの「構造」を見ると 「インデックスサイズ」のところで、それぞれの主キーであるa_idとb_idがPLIMARY で登録させています。編集ボタンを押したら「インデックスを修正する」画面に変わるので一応それぞれインデックス登録はされているのかな？と思います。
QLについて教えてください テーブルAの項目はF1,F2,F3で内容が F1,F2,F3 1, 0, 0 1, 1, 0 1, 1, 1 1, 1, 2 2, 1, 1 2, 1, 2 3, 1, 0 3, 2, 2 3, 2, 3 F1をグループ化しF2の最大値の中でさらにF3が最大の行を取得したいのですが どのようなSQLにすればよいてすか？
8桁の生年月日(バーキャラ型の文字列 (例：19830609）) から 基準日(こちらも同様に8桁のバーキャラ型(例：20130613)時点の年齢を求めたいです。 この場合結果は30 できるでしょうか？ <生年月日> ID 生年月日 1 19830609 2 19830601 3 19830501 ＜基準日＞ ID 基準日 1 20130616 2 20120616 3 20110601
idの順位を取得する方法はありますか？ voteが一番多い順にソートして指定したidの順位を取得したいです もしくは、指定したidが3番以内に入っているかどうか調べたいです テーブル id　vote 1　5 2　6 3　3 4　1 5　12 ソートした後のテーブルのイメージ　id3の順位を指定した場合、4番目なので4を取得したいです id　vote 5　12 2　6 1　5 3　3 4　1 よろしくお願いします
質問です。 下記テーブルで TOKUTENテーブルのHYOKIKAN_FR時点の氏名をNAMEテーブルからGETし TOKUTENテーブルにくっつけて出したいのですが、どうしたら良いでしょうか よろしくお願いいたします。 <NAME> SYOKUINID SIME TKYSTADATE TKYENDDATE 1 あああ 0000000020120331 1 いいい 2012040199999999 2 花子 0000000099999999 3 太郎 00000000 20140101 3太郎２ 2014010299999999 4 田中 0000000099999999 5 鈴木 0000000020101231 5 鈴木２ 2011010199999999 <KIHON> SYOKUINID SYKNCODE SEX BTD 101100 2 19800101 2 01000 2 19900101 3 02000 119990202 4 03000 1 19880808 5 04000 1 19870301 <TOKUTEN> SYOKUINCD HYOKIKAN_FR HYOKIKAN_TO TOKUTEN 00001 20120401 20130331 00002 20120401 20130331 00003 20120401 20130331 01000 20120401 20130331 10 01001 20120401 20130331 01100 20120401 20130331 20 01111 20120401 20130331 02000 20120401 20130331 30 02222 20120401 20130331 03000 20120401 20130331 40 04000 20120401 20130331 50 0500020120401 20130331 60
二つのテーブルの行数は同じとします 1行に10カラム以上あるテーブルから1カラムだけ取得するのと idとvoteだけの2カラムで作ったテーブルから1カラムだけ取得する場合の処理スピードは速くなりますか? updateで更新する時のスピードもカラム数が多いと違いが出ますか？ よろしくお願いします sprintf("SELECT vote FROM hoge WHERE id=%d", $id );
postgresのデータベースから日本語の入った列の取得が上手くできずに困っています。 どうすればよいのでしょうか。。。 【DB】 postgres:9.1.1 perl: v5.10.1 databaseの文字コード：UTF-8 【クライアント】 postgres:8.4.0 perl：v5.8.8 文字コード：ECU-JP このような環境で、クライアントで 県名テーブルから県名を取得する以下のようなperlを実行した結果、 OUT.csvの県名列が文字化けしてしまったため (1)のように修正したのですがエラーとなってしまいます。 convertの記述の仕方が悪いのでしょうか？ DBD::Pg::st execute failed: ERROR: function convert(character varying, unknown, unknown) does not exist at character 19 (Test.pl) #!/usr/local/bin/perl use DBI; $query = <<EOF; SELECT KEN_ID, KEN_NAME　　←修正前 convert(KEN_NAME,'UTF-8','EUC-JP')←(1) FROM KEN_MASTER EOF $dbi = DBI->connect("dbi:Pg:dbname=datbase;host=DATA_SV","hogeUser","hogePass"); $dsi = $dbi->prepare($query); $dsi->execute(); open(OUT, "> /OUT.csv"); while ($shr = $dsi->fetchrow_arrayref) { print OUT join(",", @$shr), "\n"; } close(OUT); $dsi->finish(); $dbi->disconnect(); exit();
XAMPPでｍｙｓｑｌを使ってます。 CSVをインポートするとUTF-8が文字化けしてしまいます。詳しくわかる方いましたらお知恵をお貸しください。 まず、ｍｙｓｑｌの設定ですが show variables like 'char%'; をおこなうと +--------------------------+--------------------------------+ | Variable_name | Value | +--------------------------+--------------------------------+ | character_set_client | utf8 | | character_set_connection | utf8 | | character_set_database | utf8 | | character_set_filesystem | binary | | character_set_results | utf8 | | character_set_server | utf8 | | character_set_system | utf8 | | character_sets_dir | C:\xampp\mysql\share\charsets\ | +--------------------------+--------------------------------+ 8 rows in set (0.05 sec) となっています。 次に、アップロードするCSVですが、 １回目は、terapadを愛用しているので、terapadの機能でUTF-8に変換して保存したのですが、インポートすると文字化けしてしまいました。 次は、エクスプローラーでUTF-8に変換したファイルを読み込むと文字化けしており、エクスプローラーのエンコードで文字コードをUTF-8に変換し保存したものを、CSVに変換してインポートしたのですが、やっぱり文字化けしてしまいました。 私の知識ではこれ以上手がないのでなにかあたらしい突破口や間違いがあれば教えてください。
テーブルで一番古いレコードだけをSELECTしたいのですが、どうすれば良いでしょうか？ ■背景 ・テーブルからデータを取得しようと思ったら、「id」及び「autoincrement」に該当するカラムがありませんでした ・日付に該当するカラムもありません ・「phpMyAdmin」で確認すると、いつも同じ並び順で表示されるので、格納したレコード順で表示されているのではないかと思いました ■質問 ・この時、そのテーブルで一番古いレコードだけをSELECTしたいのですが、どうすれば良いでしょうか？ ・where?
mysq初心者です 値の取得する順番を変えないで、値を取得する方法はありますか？ 会員IDが5、1、3で取得したいのですが1、3、5に並び替えられてしまいます テーブルはIDとNAMEのみ、重複なしで、ID番号と名前番号が一致しています sprintf('SELECT id FROM hoge2 WHERE name="%s" or name="%s" or name="%s" ', ほげ5, ほげ1, ほげ3 ); $recd = array(); while ($rec = mysql_fetch_assoc($sql2)) { $recd[] =$rec['id']; }
XAMPPのv3.1.03.1.0をインストールした直後、Apacheがまず作動しなくなりました。 使用するポートを80→8080に変更したところ、なんとか正常にもどったのですが、今度は入れ替わるようにMySQLがスタートしなくなってしまいました。 再びポートを調べましたが、3306が他で使用されている様子はないため、Apacheの設定を上記のように変更したことと関係があるのでしょうか？ ■PCの状況 ・「Windwsファイヤーオール」では、MySqldは許可された状態。 ・「Skype」はアンインストール済み。「IIS」も切っている。 ・過去にMySQLもXAMPPもインストールしたことはない。今回初。 ・3306を他ポートが使用している様子はない。 Apacheの設定を変更したら、連動して必要な動作があるのでしょうか？ 勉強をはじめたばかりの初心者なもので、基本的なことも分からずすみません。 また、ほかの方のアドバイスを拝見しているとMySQLを再インストールする方法もあるようですが、その際はまたApacheのポート変更も必要なのでしょうか…？ お手数ですがご教授いただけると助かります。 参考までに…コントロールパネルには下記のようなエラーメッセージが出ています。 2:03:51 [mysql] Error: MySQL shutdown unexpectedly. 2:03:51 [mysql] This may be due to a blocked port, missing dependencies, 2:03:51 [mysql] improper privileges, a crash, or a shutdown by another method. 2:03:51 [mysql] Check the "/xampp/mysql/data/mysql_error.log" file 2:03:51 [mysql] and the Windows Event Viewer for more clues
はじめまして！ ある日、急に以下のメッセージが出てしまい、エクスポートができなくなってしまいました。 EXP-00056: Oracleエラー1578が発生しました。 ORA-01578: Oracleデータ・ブロックに障害が発生しました(ファイル番号99、ブロック番号99999) ORA-01110: データ・ファイル99: 'D:\ORACLE\ORADATA\xxxxx\yyyyyy.DBF' また、DELETEをかけるとやはり、データ・ブロック障害とのことで不正終了します。 障害になってしまったところのデータはあきらめますが、それ以外のデータだけでも 何とか取り出したいです。たいへん困惑しております。 どうかよろしくお願いいたします。
DBに以下のようなデータが格納されているとします。 | id | name | | 01 | apple | | 01 | banana | | 02 | onion | | 02 | potato | | 02 | carrot | | 02 | radish | | 03 | beef | | 03 | chicken | | 03 | pork | GROUP_CONCATという関数を使えば、 | id | name | | 01 | apple,banana | | 02 | onion,potato,carrot,radish | | 03 | beef,chicken,pork | と、まとめられることは分かっているのですが、 データ個数を指定または最大値に合わせることは可能でしょうか。 実現したい例を以下に記載します。 | id | name | | 01 | apple,banana,NULL,NULL, | | 02 | onion,potato,carrot,radish | | 03 | beef,chicken,pork,NULL | ※「id:02」の最大値「4データ」に合わせるまたは「4」を指定する GROUP_CONCATの引数にはこのような機能はないように見受けられました。 他の手法でも構わないのですがこのような内容を実現できる方法がありましたら ご教授頂ければ幸いです。 どうぞよろしくお願いします。
Oracle(10g)のあいまい検索について。 DB上に「ABC」「DEF」という２つのデータがある状態で、 「ABCDEF」で検索した場合について、 検索結果として、「ABC」と「DEF」の両方を得る方法はありますでしょうか？ （現状では対象データがありませんとなります。） LIKEによるあいまい検索や、Oracle textによる全文検索では、 上記の検索結果を得ることができません。 LIKEやOracle textの場合はあくまで部分一致なので、 検索対象の文字列（[ABC」「DEF」）より長い（「ABCDEF」）文字列での 検索はヒットしないようです。 ご存じの方いましたら、ご教示頂きたいと思います。 以上
自分ではすぐに浮かばないのですが、結構急ぎのことなのでお時間がある方でご存知の方がいらしたら教えて下さると嬉しいです。なので、途中で解決していたり質問を途中で消しているかもしれませんがよろしくお願いします。 SQLで自分が書いた文を高速化したいのですが、一般的にこうすると遅いからこうする方が良いというのがあれば教えてください。 一応自分でも調べててWHERE句では結合よりも先に条件を記載する方が良いとか書いてました。 あと、IN演算子がちょっと問題な演算子ということが。 確かにSQL文を書いているソースではいくつかSELECT文があって、それぞれでIN演算子を使っています。 調べてるとIN演算子をEXISTS演算子に書き換える方が良くなるとあったのですがEXISTS演算子はカッコ内で再度SELECT文を作るんですよね？ 今使っているIN演算子では、ほぼカッコ内に数字のいくつかの候補があってそこから該当する数字を選ばれるという形の方。 WHERE　ＡＡＡ　ＩＮ　（'122','244','366'） といった形です。 あるＳＥＬＥＣＴ文でＩＮ演算子を使って絞った値データを次のＳＥＬＥＣＴ分のＩＮ演算子の値候補として使用しています。 つまり、上記のような文１２２と２４４のデータが見つかってＳＥＬＥＣＴされると次のＳＥＬＥＣＴ文のＩＮ演算子の候補として１２２と２４４が入るという形です。 ちなみにこの処理のメインとなるテーブルでは一つの項目の値を木構造で分けているのでその辺りも考えないといけません。 以前、こちらのサイトで教えて貰った方法で動いている GROUP BY ＡＡ．Ａ１ HAVING COUNT(*) >= 0 といった処理も重くしてしまうのでしょうか？
CSVファイルからレコードをインポートしたテーブルAがあります。 インポートした後に処理済みレコードを累積収納するテーブルBがあります。 インポート後、テーブルAのレコードをもとに処理してCSVファイルをエクスポートして、処理済みレコードをテーブルBに移しています。 テーブルA、同Bには「日付」項目があります。 テーブルAにインポート後、処理を実行する際に、テーブルBの日付とテーブルAの日付の重複がないことを比較チェックし、もし重複があればメッセージを出して処理を中断させたいのです。 If～Then～Else、IsNull、DLoolup関数を使って試みましたが、うまくいきません。 VBAでどのような記述をすればいいでしょうか？
まだデーターベースを独学で始めて数ヶ月の初心者です。 以下（３行目のleft join）の記述では動かないのですが、どのように 記述したらよいのでしょうか？ やりたい内容は３行目にあるようにbookedというテーブルの中のdateが 2013-06-05だけ抽出した形のテーブルを、timeTplというテーブルとleft join させたいです。 1 "select * 2 from 3 timeTpl as t left join (SELECT * FROM booked where date ="2013-06-05") as b 4 on 5 t.start >= b.startTime and t.start < b.finishTime || 6 t.finish > b.startTime and t.finish <= b.finishTime 7 where 8 t.time > 9 (select start 10 from class as c left join member as m 11 on c.className = m.class 12 where m.name = '$name') 13 ) 14 "; よろしくお願いします。
作成したcsvファイルを使って、社員のマスター検索を行いたいです。 ＳＱＬを使って行いたいのですが、それにともない作り方の流れを教えていただきたいです。
お世話になります。 Oracle Sqlでの質問を致します。 Oracleのデータで重複データを削除したく 下記の構文を書いたのですが、 右括弧がありませんと言うエラーが出てしまいます。 見た目括弧はちゃんとあると思うのですが、 どこが悪いのか分かりません。 ご親切な方、ご教示くださいます様、 宜しくお願いいたします。 　　　　　　　　　記 DELETE FROM D入庫データ WHERE ID NOT IN ( SELECT MIN(ID) FROM D入庫データ GROUP BY PPID,台車番号,入庫数量,ロット番号,TO_CHAR（登録日時,'yyyy,mm,dd'） WHERE TO_CHAR(SYSDATE,'yyyy/mm/dd)=TO_CHAR（登録日時,'yyyy/mm/dd'） ）；
値を1レコードに詰め込む必要があり30個近くになってしまいました。 SELECTやINSERTのときの速度が気になるのですが、問題ありませんででしょうか？ また、問題があれば、どのような回避策がありますでしょうか？ 宜しくお願いします。
質問失礼いたします。 下記のSQL文を使って、「table1」をメインとして「table2」、「table3」を表示しています。 ★現在の状態 【SQL文】 SELECT table1.*, table2.id as t2id, table2.title as t2title, table2.title as t2url, table3.id as t3id, table3.title as t3title, table3.title as t3url, from (table1 left JOIN table2 ON table1.id = table2.id) LEFT join table3 on table1.id = table3.id 【table1】 id　 name　... 01　東京　... 02　栃木　... 03　埼玉　... 【table2】 id　title　　　　　　　　　　url 01　レストラン東京　　　http://~ 01　ファミレス東京　　　http://~ 02　ファストフード栃木　　　http://~ 03　喫茶さいたま　　　http://~ 【table3】 02　麺所　　　http://~ 03　ら～麺　　　http://~ 【表示】 +───+───────────+───────+ │地域│洋食　　　　　　　　　　　　　│ラーメン店　　　│ +───+───────────+───────+ │東京│レストラン東京http://~　　│　　　　　　　　　│ +───+───────────+───────+ │東京│ファミレス東京http://~　　│　　　　　　　　　│ +───+───────────+───────+ │栃木│ファストフード栃木http://~│麺所http://~　│ +───+───────────+───────+ │埼玉│喫茶さいたまhttp://~　　　│ら～麺http://~│ +───+───────────+───────+　　 ※「http://~」には全てリンクを貼っています サブの「table2」(または、「table3」)に2つの情報があると、 表示した際にレコードが2行になります。 その為、下記の通り情報が複数ある場合は1行にまとめたいと思っています。 ★希望する状態 【表示】 +───+───────────+───────+ │地域│洋食　　　　　　　　　　　　　│ラーメン店　　　│ +───+───────────+───────+ │東京│レストラン東京http://~　　│　　　　　　　　　│ │　　　│ファミレス東京http://~　　│　　　　　　　　　│ +───+───────────+───────+ │栃木│ファストフード栃木http://~│麺所http://~　│ +───+───────────+───────+ │埼玉│喫茶さいたまhttp://~　　　│ら～麺http://~│ +───+───────────+───────+　　 なにか方法などありましたら、教えて下さい。 宜しくお願い致します。
Oracle11gGoldの勉強をしているのですが、RMANのチューニングについて理解出来ない部分があります。 ・rmanの非同期I/Oを制御にするには、「DISK_ASYNC_IO」を有効にすべし ・ディスクに対するI/Oスレーブを制御するには、「DBWR_IO_SLAVES」を有効にすべし # I/Oスレーブとは非同期I/Oの際に使用されるバッファ 上の２つを踏まえた上で、次の一文が理解できません。 ・ただし非同期I/Oが有効な場合、I/Oスレーブは使用されません。 # 黒本のP223より 非同期I/Oが有効なら、I/Oスレーブが使用されるのではないでしょうか？ どなたか、RMANのチューニングに詳しい方、ご教示頂けませんでしょうか。
お世話になっております。 勉強がてらネットショップを作っているのですが、売上一覧を表示すべくところで立ち止まってしまいました。 以下にテーブルの構成および得たい結果を書き残しますので、ご教示頂けた幸いです。（MySQL5) テーブル名：member member_no　　name1 　1　　　　　　佐藤 　2　　　　　　小島 　3　　　　　　石田 　4　　　　　　鈴木 テーブル名：sales sales_no　sale_slip_no　sales_date　　member_no　goods_name　request_money　receipt_maney 　1　　　　　1　　　　　2013-6-6　　　　　2　　　　　キュウリ　　　　　　5250 　2　　　　　1　　　　　2013-6-6　　　　　2　　　　　イチゴ　　　　　　　3150 　3　　　　　1　　　　　2013-6-6　　　　　2　　　　　バナナ　　　　　　　8400 　4　　　　　2　　　　　2013-6-7　　　　　1　　　　　りんご　　　　　　　5250 　5　　　　　2　　　　　2013-6-7　　　　　1　　　　　　　　　　　　　　　　　　　　　　　　　3000 　6　　　　　3　　　　　2013-6-8　　　　　4　　　　　ほうれん草　　　　　9450 　7　　　　　3　　　　　2013-6-8　　　　　4　　　　　しいたけ　　　　　　2100 　8　　　　　4　　　　　2013-6-8　　　　　3　　　　　マンゴー　　　　　　6300 ・各テーブルにあるmember_noカラムは対となる紐付くデータです。 ・sale_slip_noは伝票番号です。 ・request_moneyは商品単位での小計金額です。 ・receipt_maneyは入金金額（またはポイントが支払いに使われた時の金額）です。 ・質問と無関係と思われるカラムは省略しています。 以上のような構成のテーブルがありますが、以下のように伝票番号毎に別け、かつ伝票毎の合計額を求めたいと考えています。 sale_slip_no　sales_date　　name　　request_money 　4　　　　　　2013-6-8　　　石田　　　　6300 　3　　　　　　2013-6-8　　　鈴木　　　　11550 　2　　　　　　2013-6-7　　　佐藤　　　　2250 　1　　　　　　2013-6-6　　　小島　　　　16800 以上ですが、join group sumの組み合わせになるのかな・・と考え調べ、試行錯誤を繰り返していますが、描いている結果を得ることが出来ません。どのようなSQLになるのかご教示いただければ幸いです。 また、売上データとして蓄積させるテーブル構成を作ったのは初めてですが、もっと適切なものがあれば、こちらも併せてアドバイスを頂けると幸いです。 お忙しいなか恐縮ですが、宜しくお願い申し上げます。
PHPとＭＹＳＱＬをつかっています 会員情報から友達の名前を登録できるようにしました postで受け取った情報は友達の名前のみです 友達の名前から友達のID番号を取得したいのですが、15人分まとめて取得する方法はありますか？ 調べるテーブルのカラムにはidとnameがあります(idとnameに重複はありません) ｈｔｍｌフォームは(input=text)が15個ほどあって、何も記入されていない欄もあります（fre3に書き込んであってfre2が空白の場合があります） $fre1 = $_POST['fre1']; $fre2 = $_POST['fre2']; $fre3 = $_POST['fre3']; 　　　・ 　　　・ 　　　・ $sql = sprintf("SELECT id FROM friend WHERE name LIKE '%s'",$fre1); $recordSet = mysql_query($sql); $data = mysql_fetch_assoc($recordSet);
tbというテーブルのbangというカラムに4が含まれていれば表示というのは select * from tb where (bang) like '%4%' ; という形になりますが、このtbテーブルにさらにname,tukiというカラムがあったとして カラムに関係なくレコードのどこかに４が入っていれば抽出するというSQL文が書きたいです。 select * from tb where bang like '%4%' or name like '%4%' or tuki like '%4%' ; と書くことで何とか今まではやってきたのですが、カラム数が増えてきてしまったので、ものすごく長いSQL文なってしまいました。 もう少しスマートにする方法はありませんか？
http://oshiete.goo.ne.jp/qa/1599858.html この質問に疑問があります。 回答２で where (column1 || '/' || column2 ||'/' || column3) like '%word1%' ; というアドバイスに対して質問者は where　( concat( column1 , column2 , column3) like '%word1%' ) でできたと返しています。 なぜ、質問者はwhere ( concat( column1 , column2 , column3) like '%word1%' ) というSQL文にいたったのでしょうか？ where　( concat( column1 , column2 , column3) like '%word1%' ) では、だめだったのでしょうか？
以下の条件を複合したSQL文を考えています。 SQLが分かる方、お手数ですがよろしくお願いいたします。 ●TBL_1、TBL_2のJUDGEが共に「OK」である、IDとJUDGEとTBL_2のDATE ◆TBL_1 ID ,JUDGE,DATE 001,OK ,20100101 002,NG ,20100102 ◆TBL_2 ID ,JUDGE,DATE 001,OK ,20130101 002,OK ,20130102 ◆希望検索結果 ID ,JUDGE,DATE 001,OK ,20130101 おそらく結合という処理が必要なのだと思います。 SQLの知識をお持ちでお時間がある方、よろしくお願いいたします。
自サーバDBでselectしたデータをそのまま他サーバDBへ直接insert出来ますか？　出来るんであればその方法を教えてください。
アクセスのレコードの更新直後、他PCから該当レコードを読むと更新が反映されていません。回避方法をお教え下さい。 尚、アクセスの初心者です。 ”データ.mdb”をServerへ置き、複数のPCの”プログラム.mdb”から”データ.mdb”のテーブルをリンクし使用する予定です。 しかし、PC-Aの”プログラム.mdb”でテーブルを更新した直後PC-Bの”プログラム.mdb”からテーブルを読み込むと更新が反映されていません。 しかし、更新後　約2秒以上経過した後に読み込むと更新が反映されています。 試行錯誤しましたが改善しません。 以下に環境を示します。 Access2003で”データ.mdb”と”プログラム.mdb”を作成しAccess2010とAccess2003で使用 T_確認テーブルに”Yes/No型”で”アクセス中フラグ”を設定 ServerとPC-AとPC-BはLANで接続 ＜プログラム内容の抜粋＞ Dim db As DAO.Database Dim rs As DAO.Recordset Set db = CurrentDb Set rs = db.OpenRecordset("T_確認テーブル", dbOpenDynaset, dbDenyRead) rs.MoveFirst If rs!アクセス中フラグ = True Then　' → または”if rs!アクセス中フラグ Then”でも同じ MsgBox "既に他者が使用", vbExclamation, "入力依頼" else rs.movefirst rs.edit 　 rs!アクセス中フラグ=True　' フラグをセット rs.update End If db.Close Set db = Nothing
FileMakerPro12を使用しております。 フィールドデータのインポート順で、 インポート先として、 非関連テーブルを選択したいと思っております。 ですが、 非関連テーブルがグレーアウトして、 選択することができません。 どのようにすれば、非関連テーブルを 選択できるようになりますか？
ODBCにてOracleに接続を行うAccessを作成し、ユーザに使用頂いております。 ２つのサーバがあり、それぞれOracleの本番環境、テスト環境としています。 （双方に作成したテーブルのDB名、スキーマ名は同一です） 開発用端末である自分の端末には、テスト用サーバへ接続するためのtnsnames.oraが、またユーザの端末には、本番用サーバへ接続するためのtnsnames.oraがセットされています。 自分の端末にて開発・テストが済んだら、ユーザの端末にAccessファイルを配布。 しかしこの度、テスト用サーバが撤去されることになりまして、、、これまで本番環境として使用していたサーバにテスト環境を同居させた場合、Accessファイルを変更する事なく　本番⇔テスト を切り替えるようテスト環境を構築する方法はありますか？ テーブルはリンクして使用しております。DB名やスキーマ名を別名で作成をと考えましたが、Access内で指定されるのでNGですよね。。。 よろしくお願いします。
すいません。現在phpを勉強中で、その際データベースが必要で、初心者サイトを見ながら初めてsqlをさわったのですが Admin自体に接続できなくなり困っています。 （最初は接続できたのですが、PCをシャットダウンして再度接続しようとしたらできなくなりました） エラーメッセージは #2002 - サーバが応答しません (あるいはローカルサーバのソケットが正しく設定されていません)。 設定ファイルに定義されている管理ユーザ(controluser)での接続に失敗しました。 と表示されました。 他の教えてgooの質問や、ググったりしてそれらしい解決方法は読んでいるのですが、専門用語だらけでほとんど分かりません。 接続ができないと何もできませんし、どなたか具体的にどういった解決方法があるか教えてもらえませんでしょうか・・。（ここの設定を見なおせ・・というアドバイスはありがたいのですが、具体的にその 設定画面までいける方法も教えてもらえると助かります。とにかくどの名前のファイルを開けるのかを教えてほしいです）
お世話になっております。 PHPにてMySQLのデータを取得するスクリプトを制作しています。 （MySQL5) 日付データ（DATE型）カラムを持つテーブルがあり、現在から直近日を取得したとき、そのデータが現在より1ヵ月以内のデータであるか否かを分別したいと考えています。 そこでお聞きしたいのは、データを参照する際、MAX()にて直近日を取得し、そのデータが1ヵ月以内であるか確認するパターンと、max()を使わず、WHERE（条件）にて、1ヵ月以内に収まる日付データがあるか確認しるパターンと、どちらが処理が速く済むのでしょうか？ 他の処理を行うための条件なので、これら処理によりデータを取得する必要はなく、該当する日付があるか否か、という確認だけのものです。 お忙しいなか恐縮ですが、アドバイスのほど頂戴出来れば幸いです。 宜しくお願い致します。
rmanで別ホストへリストアする際に、Oracleのマニュアルを見ると制御ファイルのautobackupからのリストアを行っています。 制御ファイルを別ホストのrmanのカタログなり制御ファイルに登録する必要があるかと思うのですが、 それはどうやってやればいいのでしょうか。 ちなみに以下を参照しています。 http://docs.oracle.com/cd/E16338_01/backup.112/b …
ちょっと壁に当たったので、わかる範囲でお答え頂きたいのですが、 以下のようなテーブルがあったとします。 id　user　price　date 1　A　1000　2013/5/31 2　A　1200　2013/6/1 3　B　1000　2013/5/20 4　A　1500　2013/5/12 5　C　1300　2013/5/31 6　C　1400　2013/5/14 7　C　1000　2013/5/6 8　B　1100　2013/5/24 9　B　1200　2013/5/30 10　B　1100　2013/5/4 11　A　1800　2013/4/12 12　C　900　2013/4/6 ・・・ 次に取得したいのは、 A　1200　2013/6/1 A　1000　2013/5/31 A　1500　2013/5/12 C　1300　2013/5/31 C　1400　2013/5/14 C　1000　2013/5/6 B　1200　2013/5/30 B　1100　2013/5/24 B　1000　2013/5/20 このようなデータなのですが、 条件： １．userでグループ化したうちの日付降順で並べる ２．そのuserのデータの中で、日付降順で並べる ３．userのデータが複数あっても、取得するのは新しいものから3件のみ この条件を満たすSQL文はどのように記述すればよいか、お知恵をお貸し下さい。 よろしくお願いします。
+ボタンで、フィールドを新規追加 フィールドの先頭をハイライト、右クリック フィールドメニューから、フィールドの削除 を行ったら、 フィールドが、表示されたままで、 <フィールドが見つかりません> とエラーが表示される。 このフィールドを、表示しないようにしたいですが、 どのようにすれば、よいでしょうか。
FileMaker Proを起動し、 付属のチュートリアルのファイルで、.fmp12のファイルを開いたところ、 FileMaker Pro　ネットワーク共有がオフになっているため、FileMakerで ファイルを共有できません。 と表示されました。 対処方法がお分かりでしたら、お教えください。
■質問 ・MySQL予約語名でもカラムを作成できるのでしょうか？ ■背景 ・文法エラーSQL文の原因を調べると、どうやら予約語を利用したためだと分かりました ・予約語と知っていたら初めから利用しなかったのですが、その名前で普通にカラムを作成できたので、てっきり使えるものだと思い込んでしまいました ■知りたいこと ・予約語を回避するには、ここをチェックするしかないのでしょうか？ ▽MySQL 5.1 リファレンスマニュアル :: 8.3 MySQLでの予約語の扱い 　 http://dev.mysql.com/doc/refman/5.1/ja/reserved- … ・予約語による影響を受けるのはどんな時？(CREATEは関係ない？)　予約語によって異なる？
DB初心者です。 ODBCからSQLサーバーへのアクセスを設定したく、奮闘しておりますが うまくいかず困っております。 先方から支給されたのは、 DB名、ID、パスワード、ホスト名、ポート番号、MySQLのバージョン5.0.90で、 その通り設定したつもりが、以下のようなエラーが出てソース作成できません。 --- 接続できませんでした。： SQLState: '01000' SQL Server エラー: 11001 [Microsoft][ODBC SQL Server Driver][TCP/IP Sockets]ConnectionOpen(Connect()). 接続できませんでした。： SQLState: '08001' SQL Server エラー: 6 [Microsoft][ODBC SQL Server Driver][TCP/IPSockets]指定された SQL Server が見つかりません。 --- エラー番号で検索してみても原因がわからず・・・ 詳しい方いらっしゃいましたらお願いいたしますm(__)m
さきほどバグがあがってきて対策をしています。 現状、恥ずかしながらテンパってしまっていて 急ぎで、対策するまでの間やりたいことがあるんです・・・。 それは、 「複数あるテーブルすべての、あるカラムの値が０であるすべての行のカラムの値を９に変えたい」です。 もう少し具体的に書きます。 [KOKYAKU_TABLE] [TYUMON_TABLE] [GAZOU_TABLE] という複数のテーブルがあって、 その複数のテーブルには<id>というカラムがあります。 （<id>で関連付けしてあるんです) 全てのテーブルから、<id>の値が「0」になっている行を検索し、 その値を「9」に書き換えたいんです。 何分テンパっていて、 改修作業中にいじられちゃったりしてさらにテンパってます、ごめんなさい よろしくお願いいたします＞＜
@jouken int @sql varchar(MAX) @select varchar(MAX) @where varchar(MAX) set @select = 'select * from table1' set @where = ' where case when @jouken = 0 then 'field1 = 1' when @jouken = 1 then 'field1 = 1 or field2 = 1' when @jouken = 2 then 'field1 = 1 or field2 = 1 or field3 = 1' end ' set @sql=@select+@where exec(@sql) 上記のような文字列の組み合わせでの作成でやりたいことはできたのですが、 こちらを直接SQLの中でやりたいのです。 以下の文は機能しません。 select * from table1 where case when @jouken = 0 then field1 = 1 when @jouken = 1 then field1 = 1 or field2 = 1 when @jouken = 2 then field1 = 1 or field2 = 1 or field3 = 1 end ご教授の程、よろしくお願い致します
MySQLの抽出時間を短縮できないため困っております productテーブル product_id,test_id 86009,'10701,8545' 84334,'12610,9505,13326,9024,1020747,6787,3737,5266' 85078,'1001182,1002129,1003064' 84082,'24723,23417,1002357,1000683,1002258,1003501,25426' 85072,'1008167,1007194,1006309,5240,1009347,30212' 85071,'28079,1007881,1000733,1002367,27836,25141,29863' 86014,'23988,17802,26440,1005928,22668,28372,28135' 83762,'1010127,1010436,1011554,1013949,1014307' test_masterテーブル id,initial_kana 10701,'あ' 21122,'あ' 1002129,'あ' 1002357,'い' 2291,'い' 29863,'い' 23988,'う' 1010436,'え' 22299,'え' 上記の２つのテーブルがあります。 内容は下記のようになります。 productテーブルの product_id：一意のID test_id：test_masterテーブルの一意のID(test_master.id)のカンマ区切りで接続した文字列 実際のレコード数：86,688件 test_masterテーブルの id：一意のID initial_kana：全角一文字のみ 実際のレコード数：14,602件 【やりたいこと】 （１）test_masterテーブルのtest_master.initial_kanaカラムに対応する文字（例えば'あ'）に対応するtest_master.idを取得する （２）（１）で取得したtest_master.id群を元に、productテーブルのtest_idに 　　　該当する（product.test_id文字列の中にtest_master.idが入っているもの）もののproduct.product_idを取得する ということをしたいのです。 （３）例えば、test_master.initial_kana='あ'を取得したい場合、productテーブルのproduct.product_id=86009,85078が取得される 私の作ったSQLは下記のものになります limitとoffsetに関しては、都合上消すことはできません。 ・test_masterテーブルから、test_master.initial_kana='あ'のものを抽出 ・productテーブルから、product.test_idがNULLでないものを抽出 ・上記二つから、FIND_IN_SETで、test_master.idに該当するproduct.test_idの文字列の中から抽出 --------------------------------------------------------- selectp.product_id as product_id, am.id as id from (select id from test_master where initial_kana = 'あ' ) as am, (select product_id,test_id from product where test_id is not null ) p WHERE ( FIND_IN_SET(am.id, p.test_id)!=0 ) group by am.id limit 20 offset 0 --------------------------------------------------------- このSQLを実行すると件数が多いためか 30秒ほど掛かってしまい実用に耐えられない状況です。 すみませんが、SQLに詳しい方がいらっしゃいましたら ご教授をお願いできますでしょうか。 検索が5秒くらいまで短縮できれば万々歳なのですが… よろしくお願いいたします
SQLで テーブルAとテーブルBがあり、 AとBの構造はほぼ同じとします。 Selectで引用する際に、 seelct * from (A + B) みたいなAとBをくっつけて、 あるカラムをOrderByしたいと思っております。 いったんTempテーブルなどに落とし込むなども考えましたが、 スマートではなく、時間もかかることなので、 １クエリで取得することは可能でしょうか？
ＥＲ図を理解しようとふと見てみると、種類がいっぱいあるのに驚かされます。 あんなにある必要性があるのでしょうか？ ・先駆者がいてそれじゃ不十分だから発展していったのか、 ・そもそものＥＲ図の使用度。そんなに使う？の意味合いで ・使い分けされてるのか、→だとしてその使い分けは？どれが頻度高いのか まったく開発設計に絡んだ事が御座いません。 以上どれかでもご教授いただけるとうれしいです。
php初心者です。 （DB：mysqlをphp（PDO）で操作） 最近PDOの勉強をし始めましたが、記述の際に （接続に関する部分）と（クエリに関する部分） の記述位置に関してのルールがはっきりしません。 上記２つを続けて記述をすれば問題なく動くのですが、例えば、 ----------------------------------------------------------------------- try{ $link = new PDO($db, $user, $pass); }catch(PDOException $e){ echo 'データーベースに接続できません。' . $e->getMessage(); } ----------------------------------------------------------------------- だけ先に記述しておき（接続しておいて）、その後htmlやphpの記述をはさみ、 必要な部分で以下のように（クエリ）の記述をした場合、動きません。 <?php $stmt = $link->query('SELECT * FROM booked order by rsvTime asc'); ?> <table border="1"> <tr> <th>予約時間</th> <th class="wdt_at">施術開始</th> <th class="wdt_at">施術終了</th> <th>予約未、済</th> </tr> <?php if (!$stmt) { $info = $link->errorInfo(); exit($info[2]); } 　　　　　　　　 　　　　　　（※ここでクエリしたものを使用） 　　　　　　　　　　　　↓ while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) { print "<tr>\n"; print "<td>".htmlspecialchars($row["rsvTime"])."</td>\n"; print "<td>".htmlspecialchars($row["startTime"])."</td>\n"; print "<td>".htmlspecialchars($row["finishTime"])."</td>\n"; print "<td>".htmlspecialchars($row["kafuka"])."</td>\n"; print "</tr>\n"; } print "</table>"; ?> ■質問内容 そこで質問です。PDOの接続とクエリの記述位置やその他のルールを 詳しく教えて下さい。 よろしくお願いします。
ＳＱＬ Serverを勉強中です。 以下のようなテーブルに、同一の日付に複数の名称・値のセットが存在します。 Date(日付)　 Name（名称） Value(値) 20130101　　　　　 a 　　　　　10 20130101 　　　　　b 　　　　　20 20130101 　　　　　c 　　　　　30 20130202 　　　　　a 　　　　　5 20130202 　　　　　b 　　　　　10 20130202 　　　　　c 　　　　　15 このデータを、ＳＱＬのＳＥＬＥＣＴ文で取得し、以下のような表を作りたいと考えています。 a b c 20130101102030 2013020251015 行が日付、列が名称になっています。 このように取得できるSQL文を教えてください。よろしくお願いします。
php+mysqlでシンプルな会員登録を作りたいのですがパスワードは暗号化したほうがいいですか？ パスワードを簡単に暗号化できる方法はありますか？ postされたpassと暗号化されたpassのチェック方法がわかりません ログイン if ($_POST['id'] !='' && $_POST['pass'] !='') { $sql = sprintf('SELECT * FROM hoge WHERE id="%s" AND pass="%s"', mysql_real_escape_string($_POST['id']), mysql_real_escape_string($_POST['pass']) ); $record = mysql_query($sql) or die(mysql_error()); if ($table = mysql_fetch_assoc($record)) { $_SESSION['id'] = $table['id']; $_SESSION['name'] = $table['name']; } else { //エラー }
会員の名前の更新するときに、会員以外の重複がないか調べたいです 会員以外のidと名前の一致を取得しようとしましたがうまくうごきません やりたいことは 会員以外の名前と入力した名前が重複してないか調べたいです $id = mysql_real_escape_string($_POST['id]); $name = mysql_real_escape_string($_POST['name']); $name3 = mysql_query("SELECT name FROM hoge2 WHERE NOT id='.$id.' AND name='".$name."'");
DBA_SEGMENTSのBYTEにて表示されるのは割当サイズ？だと思われるのですが（実サイズではなく）、これはテーブルをCREATE時に決められるサイズなのでしょうか？ データをINSERTすると徐々にDBA_SEGMENTSのBYTEの数値も大きくなるのでしょうか？
アクセス2010です テーブルの構造変更の為 テストTB 社員ID--社員名-責任者名 --1-----長嶋---柴田 --2-----徳川---'' --3-----張本---張本 --4-----柴田---柴田 --5-----豊臣---張本 s = "UPDATE テストTB SET 責任者ID = Dlookup('社員ID','テストTB','責任者名=社員名') Where 責任者氏名<>''" DoCmd.RunSQL s ---------------------責任者ID --1-----長嶋---柴田---4 --2-----徳川---'' --3-----張本---張本---3 --4-----柴田---柴田---4 --5-----豊臣---張本---3 としたいのですが、責任者IDが同じ数字の社員IDになってしまいます。 正しいＳＱＬはどう記述するのでしょうか？
MySQLの外部結合について教えてください 「結合の対象となっているカラムの値が一致」は必須なのでしょうか？ ■やりたいこと ・Aテーブルaカラム内にある「デリミタの先頭文字列」を抽出して、Bテーブルのidカラムと結合したい ■最終的にやりたいこと ・上記一致条件で、両テーブルデータをSELECTしたい ■試したこと ・「SELECT SUBSTRING_INDEX」で「デリミタの先頭文字列」を抽出できたのですが、そこで行き詰まりました ■質問 ・そもそもやろうとしていることが無謀なのでしょうか？ ・テーブル構成を見直した方が良いのでしょうか？
ＡＣＣＥＳＳ初心者です。 ＡＣＣＥＳＳ２０１０　ＯＳはWindows７です。 パソコンはアクセスとエクセルマクロの入門書を読み終えたレベルです。 只今、注文実績管理表を作成するために、必要な情報を複数のテーブルに 分解してコード化していますが、関連付けできない為にデーターの参照ができません。 対応方法があれば教えていただくようお願いします。 どうしても実現したいので、テーブルの設計が間違えているかもしれませんが写真を掲載します。 ■現在の状況と質問 Ａ）商品だけで300アイテムあります。リストを見ながら商品名と金額を入力するのは、膨大な時間を奪われるので、発注書に書かれている。4ケタの商品番号と注文数量の入力のみに したい。その後に入力した４ケタの数字でデーターを集計し、分析業務につなげていきたい Ｂ）【Ｃ】と【Ｄ】は注文書のイメージです。ひとり最大50個の商品を一枚の注文書で 発注します（ひとりの注文が1か月に1～3回）。一回の注文で最大、50品目のデーターを 格納することは、アクセスで可能なのでしょうか？ Ｃ）発注実績の抽出ですが、以下内容で実行したいです。どうすれば可能でしょうか？ 　　テーブルの設計と関連付け、リレーションの設定がわかりません。 　　i）個人別の1か月注文実績。商品名、注文合計数、合計金額を商品別に表示 　　ii）個人別の注文合計金額（月、年間）の集計。 　　iii）商品Ａの注文実績（月、年間） Ｄ)リレーションの状態。 【Ａ】の(2)と【Ｃ】の(2)　 【Ｂ】の(2)と【Ｄ】の(3)、(5)、(7)、(9)、(11)、(13)、(15)、(17)、(19)・・・ 【Ｃ】の(1)と【Ｄ】の(2)のみ参照整合性がとれています。 Ｅ）商品テーブルのドリルボタンを押して、下の階層を見ようとすると、画像のような メッセージがでます。これはなんなのでしょうか？ ■現在の状況を列挙します。 【Ａ】顧客テーブル (1)顧客ID（オートナンバー・・・長整数型） 主キー(2)発注コード（テキスト型） 　　　　　　　　※発注コードは『英数字』のためテキスト型。リンク先も『テキスト型』 (3)氏名（テキスト型） 【Ｂ】商品テーブル (1)商品ID（オートナンバー・・・長整数型） 主キー(2)注文番号（数値型・・・倍精度浮動小数点型） (3)品名（テキスト型） (4)金額（通貨型） 【Ｃ】注文テーブル 主キー(1)注文ID（オートナンバー・・・長整数型） 　　　(2)日付 (3)発注コード（テキスト型） 　　　　　　　※発注コードは『英数字』のためテキスト型。リンク元も『テキスト型』 【Ｄ】注文明細テーブル（注文番号は全て4ケタの数字です。重複Noはありません） 主キー(1)注文明細ID(オートナンバー型・・・長整数型） (2)注文ID（長整数型） (3)注文番号1(数値型・・・長整数型) (4)数量（注文番号1） (5)注文番号2 (6)数量（注文番号2） (7)注文番号3 (8)数量（注文番号3） (9)注文番号4 (10)数量（注文番号4） ・ ・ ・※注文番号50まで続く・・・
初歩的なＳＱＬの質問で申し訳ありません。 教えて下さい。 下記のような、ある２つの異なる名前の同項目のテーブルが存在します。 《テーブル》 Ａテーブル　 　社員番号、日付、内容 Ｂテーブル 　社員番号、日付、内容 　※ 内容に関しては、ＡテーブルとＢテーブルで全く違います。 これらの２つのテーブルをマージさせ、社員番号毎の内容毎、日付順に したいと考えています。 どのようなＳＱＬを書けば良いでしょうか？？ 尚、テーブルに関しては、諸事情であえて２つに分けてあります。 よろしくお願いします。
検索対象項目が http://www.AAA.com/中略/0109.html http://www.AAA.com/中略/acb.html や http://www.AAA.com/中略/0110-1.html であったとき 文字列の右から判断して 0109.html 0110-1.html のように数字が入っている場合のみ、検索結果の対象としたいと考えてます。 上記に関する、SQL文の書き方を教えていただけないでしょうか？ 以前、 SELECT * FROM テーブル名 WHERE フィールド名 REGEXP '/[0-9]+\\.html$' と教えていただいたのですが、対象テキストに「-」が入っているケースが増えてしまったので 改めて質問となります。 正規表現の箇所次第なのかと思うのですが、、どうもわからりません。。 よろしくお願い致します。
Oracle初心者です。 機器更新によるシステム移行を行っているのですが、 Oracleより、抽出データをCSVに出力する、プロシージャにて、 「ORA-29280: 無効なディレクトリ・パスです。」 のエラーが出て対処法が分からずに困っています。 以下、プロシージャ部分抜粋 -------------------------------------------------------------------------------- fno1 utl_file.file_type := utl_file.fopen('EXPORT_DIR','TEST1.csv', 'W'); fno2 utl_file.file_type := utl_file.fopen('EXPORT_DIR','TEST2.csv', 'W'); -------------------------------------------------------------------------------- 上記の、「EXPORT_DIR」とは、どこで定義されている変数(?)なのでしょうか？ なんとなく、EXPORT_DIRが正しくないためのエラーと考えているのですが… 処理の流れとしては、TEST.bat → TEST.sql → プロシージャ　　で、 TEST.batには試しに、SET EXPORT_DIR = D:\TEST としてみたのですが、エラーのままでした。 ひょっとして、Oracleに設定すべきもの？ すみませんが、どこでどのように定義するか教えてください。 環境： Oracle11g WindowsServer2008R2
IF もしくは CASE文(？)を利用して、FROM 箇所を変更することはできるでしょうか？ ■やりたいこと ・「hoge_id」カラムが0だったら、普通に「redult」カラムからデータ取得 ・「hoge_id」カラムが0以外だったら、「hoge_id」」「id」カラムで自己結合したテーブル(ビュー？)から「result」カラムデータ取得
ただいま『基礎からのmysql」という本で、ＭＹＳＱＬの勉強をしています。 本の中の、18-03という問題で <?php $s=mysql_connect("localhost","root","PASS") or die("失敗です"); print "成功しました。<br />"; mysql_select_db("db1".$s); mysql_query("INSERT INTO tb1 VALUES('k888','エスキュ',25)"); $re=mysql_query("SELECT * FROM tb1"); while($kekka=mysql_fetch_array($re)){ print $kekka[0]; print ":"; print $kekka[1]; print ":"; print $kekka[2]; print "<br />"; } mysql_close($s); ?> このような文章があるのですが、うまく動きません。 ----------------------------------------------- 成功しました。 Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in C:\xampp\htdocs\sounyu_hyouzi.php on line 9 ----------------------------------------------- ↑のエラーを返すのですが、 スペルミスなどはなく、さっぱり原因がわかりません。 line9ということなので、 while($kekka=mysql_fetch_array($re)){ に問題がありそうな気もするのですが、見当もつきません。 ちなみに、 コマンドプロンとで、SELECT * FROM tb1をやると +------+-----------+------+ | bang | nama | tosi | +------+-----------+------+ | A101 | SATOU | 40 | | A101 | SATO | 40 | | A101 | NAKAGAWA | 40 | +------+-----------+------+ と表示され、 show databases;でも +--------------------+ | Database | +--------------------+ | information_schema | | cdcol | | db1 | | db21 | | db511 | | mysql | | performance_schema | | phpmyadmin | | test | | webauth | +--------------------+ このように表示されますので、データベースやテーブルの問題ではないのかと思います。 なにかピンとくる方おられましたらよろしくおねがいします。
お世話になります。 MySQLでテーブルのカラムを編集(追加・修正・削除)するのに、 CUI以外で行う管理ツールはあるのでしょうか。 初心者なのでコマンド操作に戸惑っております。 どうぞよろしくお願いします。
mysqlで ■address_book +------+------+------+ | code | tel | name | +------+------+------+ | 41 | 012| android | +------+------+------+ ■customers +------+------+------+ | code | title | name | +------+------+------+ | 41 | abc| android | +------+------+------+ SELECT * FROM address_book NATURAL JOIN customers; で自然結合を行って、 その結果 +------+------+------+------+ | code | title | name |　tel | +------+------+------+------+ | 41 | abc| android | 012| +------+------+------+------+ と結果が出て、 この結果を +------+------+------+ | title | code | name | +------+------+------+ | abc | 41 | android | +------+------+------+ の順に表示させる様に、SQLを実行したいのですが、 SELECT * FROM address_book NATURAL JOIN customers; SELECT title, code, name FROM address_book; と連続でコマンドを実行できる方法はないのでしょうか？ phpmyadmin でSQLを実行しています。 お分かりになられる方、ご教授お願い致します。
いつもお世話になっております。 Access2010（ＯＳはWindows7）で作成した販売管理システム（.accdbファイル）をまるごと遠隔地のパソコンにインストールするためダウンロードさせようと思って色々調べていますが、今一つ方法が分かりません。 ファイル容量は30MBほどですが、USBメモリ等の外部メディアの使用や、インターネットによる添付ファイルでの送付ではなく、遠隔地のパソコンからダウンロードによって行ないたいので、その方法のアドバイスを是非お願いいたします。
MEMORY エンジンの説明にはテーブルサイズ制限の記載がないようですが、 InnoDBと同様に64TBまで、という解釈で良いでしょうか。 （現実にはそんなにメモリを搭載した環境はないと思いますが） 今検討しているデータベースではデータ容量の見積が最大100GBなので、 メインメモリ128GBのサーバで max_heap_table_size=110G とすれば データ全体をメモリ上に収容できると考えて良いでしょうか。
あるカラムを整数で割り、結果が整数で計算できたもののみ 出力を行いたいのですがどうすればよいでしょうか？
新規登録の時の重複をチェックしたいです テーブルのカラムはシンプルにidとnameとpassだけです nameに同じ名前の人がいると困るので、HTMLフォームから送られた名前と登録してある名前の重複がないかチェックするようにできますか？ やってみましたが動きません(ーー；； $name = mysql_real_escape_string($_POST['name']); $name3=array(); $name2 = mysql_query('SELECT name FROM hoge2 WHERE name=$name'); while($data = mysql_fetch_assoc($name2)) { array_push($name3, $data['name']); } if(isset($name3)){ print "重複があります"; }else{ //ここからsql $sql = sprintf('INSERT INTO hoge2 SET name="%s", pass="%s"', $name, mysql_real_escape_string($_POST['pass']) ); //ここまで mysql_query($sql) or die(mysql_error()); }
FileMaker Go からFileMaker Proへのデータ転送について。 現在、FileMaker Go からFileMaker Proに無線でデータを転送しているのですが、 客先のiPadでそれを動かした際、二度やって、二度とも突然FileMaker が落ちました。 肝心のデータ転送はできているのですが、いきなり落ちたため、 一度はFileMaker ファイルが壊れました。 こちらで動かしている際は、動作中にごくごくたまに落ちることはあったのですが、 データ転送中にそのようなことが起こることはありませんでした。 処理的には、FileMaker Go側のプログラム（以上、ソフトA）で PC上の転送用の別プログラム（以降、ソフトB）を非表示で開き、接続ができた場合、 ソフトBのスクリプトで、ファイルのパスを 「Get( ドキュメントパス ) & ソフトA」 で指定し、そのパスからデータをインポートすることで、 FileMaker Go からFileMaker Pro にデータを転送している状態です。 今までにデータ転送中に落ちることなどありませんでしたし、 処理中に落ちるときも、再起動すれば問題なく動いていたので気にしていなかったのですが、 二度やって二度落ちたとなると、無視できない状態です。 何故このようになるかご存知の方、いらっしゃいましたらご教授ください。
オラクルで作成しているのですが、関係演算子が無効です。と出ます。 どこを修正すればよいでしょうか SELECT * FROM 表, ( SELECT col FROM 表 WHERE col1,col2 > ) WHERE col = MIN(col);
初心者です。 ユニークキーでここのレコードにコード番号をつけたいのですが、AUTO_INCREMENTでは数字しか対応してもらえず、A101.A102のようなコード番号を自動でつけることができません。 最終的にはAテーブル　Bテーブルというかたちで作っていき、場面場面でグループ化などしたいので、アルファベットがほしいのですが、そういう場合はどのようなやり方をするのが主流なのでしょうか？
すでに作ってしまったテーブルにユニークキーを付けたいと考えています。最悪の場合、新しくカラムを作っての追加でもかまわないのですが、いろいろ試してもエラーが返されてしまいます。 codeというカラムにユニークキーを設定したいのですが、 alter table テーブル名 modify unique code; alter table テーブル名 add unique code2; alter table テーブル名 modify code unique; alter table テーブル名 add code2 unique; alter table テーブル名 modify code test unique; alter table テーブル名 add code2 test unique; alter table テーブル名 modify unique code test; alter table テーブル名 add unique code2 test; alter table テーブル名 modify (code unique); alter table テーブル名 add (code2 unique); alter table テーブル名 modify (code text unique); alter table テーブル名 add (code2 text unique); など、思いつく限り試し、グーグルで調べる限り調べたのですが、出てきたものをためしてもダメでした。 テーブルを作成した後、カラムにユニークキーを設定した経験のある方、どのように変更をしたのでしょうか？
予約システムの時間を管理するような部分の記述がわかりません。 時間を比較するにあたり、ある値から1時間引いた値を利用したい ですが、その１時間を引くという記述がわかりません。 以下の５行目の一番最後の部分はどう記述したら良いですか？ 1: "select *from 2: timeTpl as t left join booked as b 3: on t.bookTime>=b.rsvTime and t.bookTime<b.finishTime 4: && 5: t.bookTime<b.rsvTime and t.bookTime<'b.rsvTime - 01:00:00' 6: where b.rsvTime is not null"; 　↑ うまくうごきません。 [db] ・timeTpl : 予約時間の候補を納めたテーブル 　　（ex.10:30,11:00,11:30,12,00・・・・） ・booked : すでに予約済みのデーターを収めたテーブル （予約時間rsvTime=（来店時間）、矯正時間startTime、矯正終了時間finishTime） ※時間の関係する部分は"time型"となってます。 ちなみに最終的に行いたいことは・・・ コースごとに取得できる予約時間が決まっています。（timeTpl) 予約時間の３０分後から矯正が始まり、その１時間後に終了します。 timeTpl（予約候補時間）の中から、予約可能なものだけを表示したい。 よろしくお願いします。
VisualBasic.NETからADOをEXCELデータで使用して、ブック内のシート内容を読み出して集計するソフトを作っています。 題名の通りなのですが、既に別ユーザが開いているEXCELブックの内容をADOを使って読み出すにはどうすれば良いでしょうか？ 開かれていない状態のEXCELなら問題なく読めるのですが、既に別ユーザに開かれているEXCELを読もうとするとエラーとなってしまいます。 以下、ソースコードの一部です。 コメントアウト箇所はいろいろ試した残骸です。 fsに開こうとしているEXCELパスが入ってます。 rsExcel = CreateObject("ADODB.Recordset") cnExcel = CreateObject("ADODB.Connection") 'cnExcel.ConnectionString = "Driver={Microsoft Excel Driver (*.xls)};" & _ ' "DBQ=""" & fs(ii) & """;" 'With cnExcel ' .Provider = "MSDASQL" ' .ConnectionString = "Driver={Microsoft Excel Driver (*.xls)};" & _ ' "DBQ=" & fs(ii) & "; ReadOnly=True;" ' .Open() 'End With 'System.IO.File.Open(fs(ii), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read) With cnExcel .Provider = "Microsoft.Jet.OLEDB.4.0" .ConnectionString = "Data Source=" & fs(ii) & ";" & _ "Extended Properties=Excel 8.0;" .Open() End With cnExcel.Mode = ADODB.ConnectModeEnum.adModeRead cnExcel.Open() sSQL = "SELECT * FROM [" & SheetName & "$]" rsExcel.Open(sSQL, cnExcel, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly) どの方法を試してもOPENしようとする所でエラーとなります。 エラーメッセージ「ファイル '' を開くことができませんでした。ほかのユーザーが排他的に開いているか、データを読み取る権限がありません。」 既に誰かが使用中の.xlsをダブルクリックしてEXCELで開けば、読み取り専用ですが開けて内容が読める訳ですが、それをADOで行う事は出来ないんでしょうか？ COMコンポーネントのEXCELライブラリのWORKBOOKS.OPENで読み取り専用で事前に開いた後にADOでOPENすれば読めたのですが、ソフトをインストールする予定のPCはEXCEL未インストール状態なのでCOMを使う事は出来ない状況です。 何か良い手段は御座いませんでしょうか？ 詳しい方が居られましたらご教示頂きたく思います。
こんにちは。 最近仕事でmysqlを使い始め、データベースの操作自体はなんとかなっているのですが、phpのチェックボックスでデータベースから検索し、一覧として表示する際、カテゴリ毎に分けて表示したいと考えているのですが、うまいやり方がわかりません。 こういう感じです。 ケーキ（大カテゴリ） 　　チョコ（中カテゴリ） 　　　　商品1 　　　　商品2 　　　　商品3 　　ミルク（中カテゴリ） 　　　　商品4 　　　　商品5 　　　　商品6 アイス（大カテゴリ） 　　チョコ（中カテゴリ） 　　　　商品7 　　　　商品8 　　　　商品9 　　ミルク（中カテゴリ） 　　　　商品10 　　　　商品11 　　　　商品12 この際、それぞれの商品には大カテゴリ、中カテゴリが設定されています。 また、検索の仕方によっては、いきなり2つめの大カテゴリから始まることもあります（ケーキカテゴリが1件もヒットしない）。 mysql_fetch_assocを使って呼び出そうと思うのですが、その中でさらに条件で分けて書く方法がありましたら教えていただきたいです。 自分でも状況があまり分かっていないので、何か情報が足りないと教えていただければ追記いたします。 よろしくお願いします。
パソコンはアクセスとエクセルマクロの入門書を読み終えたレベルです。 只今、注文実績管理をする為にアクセスを構築していますが思うようにできません。 職場でＰＣの相談する相手がいないため、大変困っています。どなたかお知恵をください。 相談の内容ですが、【Ｃ】の注文テーブルにある「注文番号」と「数量」と「日付」で 期間中の発注実績の集計をしたいと考えています。 【Ｂ】と【Ｃ】がまったく関連付けることができません。 【Ａ】顧客テーブル 　　　(1)ID（オートナンバー） 　　　(2)発注コード 　　　(3)氏名 　　　　（注）顧客テーブルにある「発注コード」がローマ字と数字の組み合わせで 　　　　　　　、これでリレーションシップを設定したいのです。 【Ｂ】商品テーブル 　　　(1)ID（オートナンバー） 　　　(2)注文番号 　　　(3)品名 　　　(4)金額 【Ｃ】注文テーブル 　　　(1)ID（オートナンバー） 　　　(2)発注コード 　　　(3)日付 　　　(4)氏名 　　　(5)注文番号１ 　　　(6)注文番号１（数量） 　 　(7)注文番号２ 　　　(8)注文番号２（数量） 　　　(9)注文番号３ 　　　(10)注文番号３（数量） 　　 　・ 　　　　・ 　　　　・ 　　　　注文番号５０ 　　　　注文番号５０（数量）
MySQLで複数テーブルからデータ取得する際、 FROMの後に、テーブル名を2つ書いて、「WHERE」で繋げる書き方と、 「JOIN ★★ ON」で繋げる書き方では、何が違うのでしょうか？ ・「INNER JOIN」と同じ意味でしょうか？ ・書き方によっては、「LEFT OUTER JOIN」みたいにも書けるのでしょうか？ ・普通は、どちらの書き方で書くとか、そういうお作法的な暗黙の了解はあるでしょうか？ ・例えば「WHERE」だと3つ以上繋げられない(？)から、奨励されていない、とか…
Winows 7 Homeで SQL SERVER 2012 EXPRESS EDITIONを使用しています。 フィールド数は60程度のテーブルに 30,000件程度のInsert文を発行したところ、 「このクエリを実行するには、リソース プール 'internal' のシステム メモリが不足しています。」 というメッセージが出力され、処理が完了しませんでした。 どれくらいだったら、いけるか計測したところ、16,000件までは完了するのですが、 以降は同様のメッセージが出力されます。 クエリは下の文のような具合です。 INSERT INTO table1 (aa,bb,cc..) VALUES('あいう','かくく','さしす'); こちらのURLのように http://www.junmt.info/article.php/20100926164914 … INSERT INTO table1 (aa,bb,cc..) VALUES('あいう','かくく','さしす') ; とやってみましたが、ダメでした。 最大90,000件程度あるので、すごく困っています。 おわかりになる方どうか解決法を教えて下さい。
PostgreSQLのphpPgAdminを使ってデータの更新をしようと思うのですが 特定の　kaiin_no を選んで　その　t_tiket の値を　'取扱っている' に更新したいのですが 文法エラーが出ます。 文: update "store_table" set "t_tiket" = '取扱っている' where "kaiin_no" = ('100','101','103'); SQL エラー: ERROR: operator does not exist: character = record LINE 1: ...t_tiket" = '取扱っている' where "kaiin_no" = ('100... ^ HINT: No operator matches the given name and argument type(s). You might need to add explicit type casts. phpPgAdmin　では、=　や　(　）　、"　の使い方に特徴があるようなのです。 WHERE kaiin_no IN ('100','101','103');　とすべきなのでしょうか？ ご存知の方がいらっしゃればご教示くださいませ。
アクセス2010で取引台帳テーブルに連結した入力フォームを作り、件名を入力すると契約NOを自動で採番するように 下記のコードにして使っていました。 しばらくはちゃんと採番されていたのですが、分類をする時に使う、 ２個あった区分を３個に追加して、 コードも２個から３個に追加しました。それから変になった気がします。 契約NOの最大値+1だと前回作られたNOと重複するようになってしまい、 契約NO+2だと、最後の最大値の次のNOが作れます。 なぜ突然こうなったのかが分かりません。 VBのコードをきちんと学んだ事がなく、本でサンプルを見たりしながら作っています。 わかりやすく教えていただきたく、お願いいたします。 契約NOは　R-KS1305-0055 Rが区分 KSがコード 1305が年月2013/05 0055が連番で採番しています。 Private Sub 物件名_AfterUpdate() Me![契約NO] = Me![区分] & "-" & Me![コード] & Format(Me![入力日], "yymm") & "-" & Format(DCount("契約NO", "取引台帳") + 1, "0000")
php独学（数ヶ月）の初心者です。 予約を管理するプログラムを自分でつくっています。 調べても調べてもどの関数をどのように使えば 良いかわからないまま数日がたってしまいました。 （初心者のため知らずに勉強し始めてしまった非推奨のmysql関数等を とりあえずまだ使用しています。mysql関数で教えていただければと思います。 ある程度理解を深めた時点できちんと勉強しなおします） ■予約の概要 コースごとに取得できる予約時間が決まっています。 予約時間の３０分後から矯正が始まり、その１時間後に終了します。 （予約時間に来店、30分間マシーンに乗り、その後先生の矯正が １時間ある。） ■作成したDB [DB01]予約時間テンプレート：time1 コースごとに取得できる予約時間が決まっています。 （以下はあるコースの予約可能時間のテンプレです。） id, time（time型） 1,10:15 2,11:45 3,14:30 4,16:00 5,17:30 6,19:00 [DB02]予約済みを貯めたDB：booked (時間はすべてtime型） id,name,time,start,finish,course 203,tanaka,10:00,10:30,11:30,a 101,abe,14:30,15:00,16:00,a 112,yoshida,17:00,17:30,18:30,c ■質問 [DB01]のうち予約可能な時間のみ<select>文で表示させたい。 ちなみ（予約可能な時間）は、11:45,16:00,19:00の３つです。 色々考えましたが、今の自分の実力では上記を実行させるコードが断片的に しか分からずお手上げとなりました。 よろしくお願いします。
mysql素人です group_idが登録者番号で5000以上の情報を持たせたいのですがテーブル設計がわかりません 才能ないなりに考えたのですがこんなテーブルしか思い浮かばないです・・・どんどんインサートしていく感じで考えたのですが良く考えたら、登録者が1万人くらいになったら1千万行くらいになって重くなる気がしました。もっと効率の良いテーブル設計ないでしょうか？ id group_id valu idは単なる行の番号、valuが点数の情報です
SQLについてお聞きしたいです。番号カラムの中で最大の数字をもつフィールドと 同じコードを持つデータを、表から全て取得したいと思っているのですが 書き出すとGROUP BYの式が間違っているというエラーが出てしまいます。 SELECT * FROM 表 GROUP BY コード HAVING MAX(番号) =　コード どう調べればいいのか分からず四苦八苦しています。どこを直せばよいでしょうか？
小規模な業務用ソフトの為に db4o を採用したいと考えています。 ですが日本語による公式の情報が妙に古く、また紹介している採用例か海外に偏っているので、関係者を説得するのが少々困難です。 なにか良い説得材料はないものでしょうか。
パソコンにOracle Client10gとOracle Client11gを インストールしたいのですが、注意点はありますか？？ Oracle Client10g⇒Aシステム Oracle Client11g⇒Bシステム ２つのシステムを同時に起動することもあります。
お世話になります。DB初心者です。 現在　、PostgreSQLのphpPgAdminを使っていまして 以下のようなDBがあり kaiin_no　 t_name 　 t_chiket -------+-------+---------- 1001 　　 太郎　 　　 なし 1002 　　 次郎　 　　 なし 1003 　　 三郎　 　　 なし 1004 　　 四朗　 　　 あり 1005 　　 五朗　 　　 あり 以下のようなSQLで目的のデータを表示できるのは解ったのですが SELECT "kaiin_no","t_name","t_chiket" FROM "public"."store_table" WHERE "kaiin_no" IN ('1001','1002','1003'); kaiin_no　'1001','1002','1003'　の t_chiket　を　「なし」　から　「あり」　に変更すする方法をご教授いただけますでしょうか？ お手数をおかけしますがよろしくお願いいたします。
PHP（４.3.11）でMYSQL（5.0.81）に接続しようとすると接続できず、 Client does not support authentication protocol requested by server; consider upgrading MySQL client というエラーになります。 PHP文はこのように記述しています。 <?php $con = mysql_connect("localhost","root","password"); if (!$con) { print(mysql_error()); exit('データベースに接続できませんでした。'); } ?> my.cnf　に　old_passwords=1　を記述し、mysqlを再起動したのですが同じエラーでした。 他に設定しなければならない事があるのでしょうか？
参照TBのF1、F6、F8と修正TBのF1、F6、F8が同じだったら、修正TBのF2、F7を参照TBのF2、F7に置き換えたい。 SQLの書き方がわかりません。 UPDATE 修正TB INNER JOIN 参照TB ON (修正TB.F1 = 参照TB.F1 And 修正TB.F6 = 参照TB.F6 And 修正TB.F8 = 参照TB.F8) SET 修正TB.F2 = 参照TB.F2 , 修正TB. F7 = 参照TB.F7 又は、 UPDATE 修正TB SET 修正TB.F2=参照TB.F2 , 修正TB.F7=参照TB.F7 WHERE EXISTS ( SELECT 1 FROM 参照TB WHERE 修正TB.F1=参照TB.F1 And 修正TB.F6=参照TB.F6 And 修正TB.F8=参照TB.F8 )" どこがいけないでしょうか？
あるマスタデータと明細データがありキーとなる列が２つ（２列）あります マスタデータのテーブルのキー列のＡ列、Ｂ列を主キーとして定義し 明細データのテーブルのキー列のＡ列は重複ありのインデックス Ｂ列も重複ありのインデックスとしてそれぞれ設定しています その２つのキーをクエリで結合して更新する更新クエリを作成しているのですが データ量が多くなってくると非常に反応が遅くなります 同じデータ量で ２つのキー列の値をあるひとつの列に結合した値を格納しその結合列で 更新クエリを作成したところ高速に処理が動作しましたので 複合キーだった場合の処理速度が遅いのだと推測しました （※Ｃ列にＡ列　＆　Ｂ列　の結合した値を格納してＣ列をキーにするという事です） accessで複合キーの更新クエリを作成する場合、高速に動作させるには なにか工夫が必要なのでしょうか？ アドバイス下さい 上記のように複数のキーをひとつの列に結合する工夫で早くはなったのですが・・・ 余分なデータを格納する事になるので非常に容量が大きくなってしまう問題があります
ブログの1エントリーを、複数カテゴリーに属するようにしたいです。 ■テーブル構成？ ・「エントリーテーブル」「カテゴリーテーブル」 ・エントリーテーブルの1カラムで、属する「カテゴリーid」を保存するのでしょうか。例えば「2,3」みたいに ・この時、あるカテゴリーに属するエントリーをSELECTするにはどうすれば良いでしょうか？
以下のテーブルがあります。 table ID key code cls add_date -- ---- ----- ---- ---------- 1 0001 A01 0 2013/01/01 2 0001 A01 0 2013/01/15 3 0001 B01 0 2013/02/01 4 0002 C01 0 2013/01/20 5 0003 XYZ01 0 2013/01/10 6 0003 XYZ01 0 2013/01/20 ： このテーブルからkey、codeが重複したものを除いて、一意となる日付が最新のを 取り出したいのですがSQLをどのようにすればよいか教えてください。 結果： 2 0001 A01 0 2013/01/15 3 0001 B01 0 2013/02/01 4 0002 C01 0 2013/01/20 6 0003 XYZ01 0 2013/01/20 分析関数、相関関数を使うのでしょうか。 使わなくてもできるのでしょうか。 今後の為に、両方を教えてください。
いま会社のシステムを構築していて ほとんど初心者なのですが、どうしたらよいかわからず困っています。 access2003なのですが フォームからパラメータクエリを起動して、会社名を検索した結果をその会社とのコンタクトした 内容を記すフォームに情報を転載したいのですが、どうやったらよいのかよくわかりません。 顧客マスターのテーブルにパラメータクエリで会社名を検索させています。 主キーは顧客コードです。 その該当したデータは追加クエリにして顧客とのコンタクトをしたテーブルに追加するようにしています。 しかし、テーブルにではなくフォームに追加したいのですが、どうしたら良いのかわかりません。 何卒よろしくお願い致します。
テーブル作成について勉強しています。 将来、フィールドが増えてもいいようにテーブルをつくるには、 どのように作るべきでしょうか。 例えばですが、現時点で必要なフィールドは２つだけ（id,name）ですが、 今後、５つぐらいフィールドが増えても問題ないようにしたいです。 ご教授いただけませんでしょうか。 宜しお願い致します。
WinでMYSQLをインストールし他PCにアクセス こんにちは。Windows XP SP3搭載の自分のPCにMYSQL5.5を勉強をしています。こちらのPCをAとします。IPは192.168.0.1 もう一台PCがあり、Windows 7 Proを搭載して、同じくMYSQL5.5をインストールしました。こちらのPCをBとします。IPは192.168.0.2 コマンドラインを使用し、AからBに接続し、Bに搭載しているMYSQL5.5にログインしたいと思います。 どのようにすればアクセスすればよろしいでしょうか？ ネットワークについて全くわからないのですが、AからBに接続する時に、WindowsのセキュリティでAの接続は拒否されてしまわないでしょうか？どのように接続できるようにオープンにすることが可能でしょうか？ よろしくお願いします。
mySQLを使ってます。 SQL文で以下のことが実現したいです。 フィールドに登録されている文字列が http://www.AAA.jp/BBB/CCC/08191.html/?cp=waribiki http://www.AAA.jp/shop/DDD/EEE/08191.html http://www.AAA.jp/shop/DDD/EEE/ZZZ.html というタイプがあります。 SQL文で検索結果を表示したいのは、 http://www.AAA.jp/shop/DDD/EEE/数字.html のように右から「数字.html」の場合のURLパスだけを抽出したいです。 SELECT * FROM `テーブル名` WHERE `フィールド名` LIKE '%html' とやってみましたが、 http://www.AAA.jp/shop/DDD/EEE/ZZZ.html というものもヒットしてしまうため 右から「数字.html」の場合だけのSQL文の書き方を教えていただけないでしょうか？ よろしくお願い致します。
Access初心者です。 フォームのコンボボックスですが、ウェブフォームでよく見られるように、未選択時に「---選択してください---」というコメントを表示できないでしょうか。 「---選択してください---」はデータとして入らないような解決法でお願いします。 VBAでMe!コンボボックス名.Value = "AAA"というふうにやってみましたが、どうもValueはテーブルのデータ型と同じでないとダメみたいです。テーブルの当該フィールドには例えば都道府県IDのように、数値だけしか格納しない予定ですので、これでは「このフィールドに入力した値が正しくありません」というエラーが出ます。 なお使っているのは2013です。いい解決法がないでしょうか。よろしくお願いたします。
いつもお世話になっております。 現在DLookupを使用しています。 抽出条件はテキストボックスに入力した値になります。 DLookup("カラム",”テーブル”,"条件") 条件に"カラム=" & "'" & テキストボックス & "'" 上記で記載しております。 問題なく抽出出来ていたのですが、テキストボックスに「’」が入った場合に デバックが出てしまいます。 通常でしたら「’’」とシングルクォーテーションを並べて解決だと思うのですが、 それ以外の解決方法はあるのでしょうか。 ご教授お願い致します。
私は、これからベンチャー企業の立ち上げに参加する予定です。 代表の人は私の趣味で鍛え上げられたPC能力を買ってくれているようで、とりあえず顧客リストをデータベースにしておいてほしいとたのまれました。 データベースはPHPでウェブアプリ（といってもたいしたものではありませんが）を作る際にMYSQLを触ったくらいしか経験がありません。 はっきりいって、私にはエクセルで管理したほうがみやすくていいとさえ思うのですが、なんのために顧客情報をデータベース化するのかさっぱりわかりません。 一応、手土産にスマホからタッチですぐに地図が現れるウェブアプリくらいつくっていこうとは思っているのですが、世間一般的にはこういう場合どのような目的でデータベースをつかうのでしょうか？ 顧客情報はBtoBで、訪問するような形です。 代表は、この情報は社員全員に見せるのではなく、一部の人しか見れないようにすると言っていました。そういったセキュリティてきな意味でもエクセルではなくデータベースを選ぶことの利点なのでしょうか？
mysqlとperlを勉強中です 2つのテーブルから同じIDの情報を取得したいです。 hoge1テーブルとhoge2テーブルのIDは共通で一致しています。 （実際にはフィールドはもっと多いですがわかりやすくしています） hoge1テーブルは3つフィールドがあります ID　INT1　INT2 hoge2テーブルは3つフィールドがあります ID　TEXT1　TEXT2 hoge1テーブルで取得するのは数字が一致したIDです SELECT id FROM hoge1 WHERE int1=10 or int2=10 ORDER BY id hoge2テーブルで取得したいのはhoge1テーブルで取得したIDのTEXTです。やりたいことはこんな感じです SELECT TEXT1,TEXT2 FROM hoge2 WHERE id=hoge1テーブルで取得したID ORDER BY id; while (my $rec = $sth->fetchrow_array) { push(@recs, $rec); } perlでは配列で取得して後で、foreachで100個ほどprintしています。 hoge2も同じように取得したいのですが、hoge2はフォームを空白で送信できるようになっているので値がなにもないときがあります 配列に入れてしまうと空白のレコードがあるとその分、配列がずれてしまいます hoge1テーブルで取得したIDとhoge2テーブルで取得したテキストのIDを一致させる方法はありますか？ やりたいのはこうゆうことです。 テーブル1で値が一致しているIDを取得する テーブル2でテーブル1で一致したIDのテキストを取得する リレーションも考えましたが素人なのでピンときませんでした テキストのほうも配列で取得して100個ほどprintしたいのです よろしくお願いします
pg_dumpall > [出力ファイル名] で作成したバックアップからテーブル単位でリストアする方法はないのでしょうか? pg_dumpallのマニュアルを読むと、リストアはpsqlで行うことになっていますが、psqlのマニュアルには テーブル単位で取り出すオプションなどはないようです。 また:pg_dumpallで作成したファイルを: pg_restore -l [入力ファイル名] の入力ファイルにすると、"pg_restore: [archiver] input file does not appear to be a valid archive" エラーが発生します。 webでも調べてみたのですが、該当するページが見あたりません。 お手数ですがご教授ください。
FileMakerとBluetoothについて 現在、FileMakerで販売管理ソフトを作成し、 それをiPadのFileMaker Goに入れて、納品書を Bluetoothで接続されたプリンタで印刷したいと考えているのですが、 そのようなことは可能でしょうか？ FileMaker Goの普通の印刷機能ではAirPrintに対応したプリンタしか 表示されないので、Bluetoothで接続されたプリンタでは普通に印刷、とはできません。 なお、プリンタはiOSで使用できるようになっているものです。 （Star SM-S210） 最初はDDEコマンドを送信、などでできないだろうか、とも思ったのですが 印刷を行いたいのはFileMaker Goですので、それは使用できません。 方法的には、一時ファイルを作成し、 そのファイルにコマンドを書き込んで送信できないだろうか、と考えております。 何か方法をご存知の方、このようにしたらどうだろうか、という方法がある方、 ご教授いただければ幸いです。
PostgreSQLをバージョン8.2から9.2にＵＰし、Ｔｏｍｃａｔをバージョン５から７にＵＰしました。 そのほか、ＯＳはWindows7でローカルシステムを構築中です。 実行すると、HTTPステータス５００javax.naming.NamingException: Could not load resource factory class [Root exception is java.lang.ClassNotFoundException: org.apache.commons.dbcp.BasicDataSourceFactory] とエラーが出ます。 以下の環境設定の間違いと思われますが、どこを直せばよいかわかりません。 よろしくご教授ください。 ＰｏｓｔｇｒｅＳＱＬは、C:\Program Files\postgresql9.2に配置しました。 Ｔｏｍｃａｔは、C:\Tomcat7に配置しました。 システムはC:\Tomcat7\webapps\test1に配置しました。 ＪＤＢＣドライバは、postgresql-9.1-901.jdbc3.jar と　postgresql-9.1-901.jdbc4.jar を C:\Tomcat7\libnにコピー＆ペーストしました。 接続の定義は、C:\Tomcat7\conf\catalina\localhost に　test1.xmlファイルを作りました。 以下がその記述です。 <?xml version='1.0' encoding='utf-8'?> <Context path="/test1" reloadable="true" docBase="C:\Tomcat7\webapps\test1" workDir="C:\Tomcat7\work" > <Resource name="jdbc/RDBMS" auth="container" type="javax.sql.DataSource" debug="1" factory="org.apache.commons.dbcp.BasicDataSourceFactory" driverClassName="org.postgresql.Driver" username="postgres" password="postgres" maxActive="100" maxIdle="30" maxWait="10000" url="jdbc:postgresql://localhost:5432/LocalDB" removeAbandoned="true" removeAbandonedTimeout="300" /> </Context>
お尋ねします。 ＭｙＳｑｌのINNODBのファイル容量を削減する方法は、 １．mysqldump -A -u root -p パスワード --opt > ダンプファイル名　でダンプ ２．ＤＢファイルを”ｒｍ”で削除（あるいは、別フォルダに退避） ３．CREATE DATABASE データベース名 CHARACTER SET utf8;　でＤＢ再構築 ４．mysql -u root -p パスワード < ダンプファイル名　でリストア で、良いんでしょうか？（＾＾；
お世話になっております。 データベース名:payment_daibiki（MySQL 5.1） daibiki_no　postage_price_min　postage_price_max　daibiki_price 1　　　　　　　0　　　　　　　　9999　　　　　　　　315 2　　　　　　10000　　　　　 　29999　　　　　　　　420 3　　　　　　30000　　　　　　 99999　　　　　　　　630 4　　　　　 100000　　　　　　300000　　　　　　　 1050 という内容のテーブルがあります。 これは商品を発送する際の代引手数料が格納されているのですが、 postage_price_minと、postage_price_maxを参照して、この範囲内の手数料を 抽出するというものです。 例えば、発送する商品の代金が、2240円の場合、 postage_price_minより多きく、postage_price_maxより小さいものを参照するので、 求める手数料は315を返したいと考えています。 そこで質問なのですが、 SELECT * FROM payment_daibiki WHERE postage_price_min <= '2240' AND postage_price_max >= '2240' とSQLを実行させると、該当するデータはないと返されてしまいます。 初歩的な質問ですが、どこに誤りがあるのでしょうか？ また、一番小さな手数料を求めるため、 SELECT * FROM payment_daibiki ORDER BY daibiki_price DESC LIMIT 1 と実行させると、630が返ってきてしまいます。 初歩的な事とは重々承知していますが、色々と設定を変えても返ってくるデータが どれも予想を反するもので、どこに誤りがあるのか分からなくなってきました。 以上ですが、このような状況、どういったことが考えられるのでしょうか？ お忙しいなか恐縮ですが、アドバイスのほど頂戴出来れば幸いです。 宜しくお願い申し上げます。
はじめまして、私は、本業は3DCGで趣味でWeb系のツール開発をしている者です。 localhostでうまくページを表示できなくて困っています。 作っているものがCG用の開発ツールで外部に公開するものではなく、 ローカル環境のみでの使用になります。 開発環境はwindows7 64bit PHP5.3.23　Apache2.2 MySQL5.5になります。 個人で取得しているドメインのサーバーにデータをアップして見ると正常にページが 表示されますので記述したコード自体には問題はなさそうです。 昔WindowsXPで構築したマシーンのlocalhostでも正常表示されます。 以下、Windows7のlocalhostでの挙動になりますが、 (1)phpinfoのページは正常に表示されます。 (2)PHPからのMySQLへの接続とデータの取得もうまくいきます。 (3)しかし、MySQLのデータを取得し、formのselectを用いて <option value='<?=$c[$i]?>'><?=$c[$i]?></option> と記述するとルックアップメニューには空文字が入力されてしまいます。 (4)そこであえて(3)の記述を <<option value='<?php echo $c[$i]?>'><?php echo $c[$i]?></option> のように書くとなんとかメニューにMySQLのデータが入ってきます。 (5)しかし、以下のように $cate=$_GET[cate];　 などのような文を記述するだけでエラーが起きてしまいまして どう対処してよいかわかりません。 localhost環境で何か設定すべきところをしていないのか、 windows7のセキュリティの問題なのかわかりませんが、 どうしたら解決しますでしょうか。 当方、Web系は中規模ネットショップを独学で構築したレベルで実務経験はありません。 そのため難しい表現をされると理解できませんので、 あくまで初心者むけということで指導していただけると幸いです。
Accessを初めて１か月の超初心者です。 本を見たり、ネットで調べたりしてある程度使える様にはなりましたが、どうしても分からないので質問させて頂きました。 会社の出勤予定表を作成したいのですが、 テーブルで、 １、日付テーブル（ID・日付の２フィールドで日付のフィールドには４年分くらいの日付をexcelからインポートしました。 2、社員テーブル（社員ID・性・住所・・・など） は、あります。 やりたい事は、 (1)縦に社員名、横に日付を、出勤日に○を入力する様にフォームをつくりたい。 (2)それを年月を入力して１か月分のみ抽出したい。 です。 出勤予定表単体なら、社員名・年月・１日～３１日のフィールドを作ればいけるのですが、ほかのクエリで顧客数と必要社員数が月検索で一覧表示出来るクエリがあるので、そこに日ごとの社員数の過不足が出るようにしたいので、、、 簡単なことかもしれませんが、全くわかりません。 出勤テーブルをどのように作れば良いか？ 日付テーブル・社員テーブル・出勤テーブルをどのようにつなげれば良いか？ ご教授お願い致します。
画像のデータフォーマットであるビットマップについて説明するとともにそのデータ圧縮手法について可逆方式・非可逆方式を含めて説明せよ。 ★簡単にでいいのでわかりやすさ重視で説明していただけると幸いです
お世話になります。 ネットショップでの送料の計算を行いたいのですが、どのようなSQL文が適切なのか、アドバイスを頂戴したく質問させて頂きます。 以下のようなテーブルがあり、都道府県、サイズ、送料が登録されています。 no　　addr　　size　　price 1　　大阪府　140　　630 2　　大阪府　160　　840 3　　福岡県　140　　735 商品毎に商品サイズ、および発送先（都道府県別）によって、送料を抽出したいと考えているのですが、 １．同じ都道府県の登録、かつ不注意により同じサイズが登録されている。 ・・・この場合は、LIMIT　1として抽出。 ２．該当するサイズが登録されていなかった。 ・・・この場合は、同じ都道府県から一番大きな金額を抽出。 ３．該当する都道府県が登録されていなかった。 ・・・この場合は全てから一番大きな金額を抽出。 と、考えられる想定を事前に施しておきたいのですが、この場合どのようなSQL文になるのでしょうか？ PHPで制作しているのですが、１つのSQL文が思いつかずTRUEとFALSEで処理する形になってしまい、該当する都道府県がなかった場合は、結果、3度もDBに問い合わせてしまう形になっています。 お忙しいなか恐縮ですが、アドバイスなど頂戴出来れば幸いです。 申し遅れましたが、DBはMySQLの５を利用しています。 宜しくお願い致します。
イメージ的にはこのような感じです。 SELECT * from table where REPLACE(name,'★','') like %佐藤%; 例えばnameが★佐★藤★というレコードがあった場合、like %佐藤%ではヒットしませんが、★を消去して検索すればヒットします。 ★を消去して佐藤が含まれる文字列を検索したいのですが、どのようなsql文にすればよいのでしょうか？ ご教示いただけると幸いです。 宜しくお願い致します。
いつもお世話になっています。 Accessのはがきウィザードを使って、往復はがきを作成したいのですが、 他のはがき宛名と同じようになってしまいます。 ご存じのかたがいらしたら、どうぞよろしくお願いします。 ※Office系で質問しましたがご回答がいただけなかったので こちらで再質問いたします。
mysqlを使用しております。 下記のようなテーブルを作りたいと思っているのですが、 親通し番号が同じ行についてのみ1からオートインクリメントすることは出来るのでしょうか？ どなたかアドバイス頂ければと思います。 -------------------------------------------------------------------------------------- column1：親番号 column2：子通し番号 　　・ 　　・ 　　・ column1：1 column2：1　←カラム1が同じ値のとき、カラム2はinsertされた順に増えていく column1：1 column2：2 column1：1 column2：3 column1：2 column2：1　←カラム1が増えたとき、カラム2は1に戻りインクリメントされていく。 column1：2 column2：2 column1：2 column2：3
テーブル１をテーブル２で設定したのを基に並び替えをしたいんですがどうすればいいんでしょうか たとえばテーブル１のフィールド１に名前　２に年齢があり テーブル2の１に名前　２にふりがな テーブル２で設定したふりがなを基にテーブル１を並びかえる
hoge_●● hoge_★★ など、テーブル名が「hoge_」で開始するテーブルを、削除するSQL文を教えてください
プログラム素人です。 初心者なのでこんなテーブルを思いつくのですが、これってカラムをいちいち作らないといけないので後のメンテが大変な気がします CREATE TABLE hoge( id INT PRIMARY KEY, item1 VARCHAR(255), value1 INT, item2 VARCHAR(255), value2 INT, item3 VARCHAR(255), value3 INT ); こんな感じのテーブルにどんどんINSERTしていきたいのです CREATE TABLE hoge( id INT PRIMARY KEY, item VARCHAR(255), value INT ); 聞きたいこと MYSQL側 IDにPRIMARY KEYが付いているのですが2つ同じPRIMARY KEYはINSERTでききませんよね？どうすればいいでしょうか？ perl側 IDごとにまとめて取得して配列に入れる方法はありますか？ idが1のアイテムを全部取得して配列に入れる方法がわかりません（他にいい方法があったらお願いします） よろしくお願いします
●質問の主旨 コマンドプロンプトでMySQLを呼び出し、 SELECT * FROM db1.tb1; とデータベースとテーブルの全内容を呼び出すと、 文字化けがします。 普通に日本語を表示させるためには、どうしたら良いでしょうか？ ご存知の方、よろしくお願いします。 ●質問の補足 先日から、他の質問でも、文字化けが発生しています。 対応するために、「あれこれ」いじっているうちに、 MySQLでも文字化けが起こりました。 「あれこれ」いじった内容は、記憶が定かではありません。。 ●関連質問 eclipseの文字化けについて（PHPファイル) http://okwave.jp/qa/q8068188.html なぜ何も表示されないのか？ http://okwave.jp/qa/q8065031.html ●開発環境 windows8 xammp1.8.1 (phpmyadmin)
こんにちわ。 取り急ぎ有識者の方にご教授いただきたい点があります。 シェル上にて、以下のようなことをやりたいのですが、上手くできません。 --ココから # /bin/sh sqlplus Userid/Passwd@sid while true <--無限ループ do exec dbms_mview.refresh('mview_name','c'); <--マテビュー(mview_name)を完全リフレッシュ done exit 0; --ココまで 上記のように、sqlplusにてDBにログインした後、 リフレッシュコマンドをlinuxコマンドのwhile文で挟んでしまうと、 「oracleに"while・・"のようなコマンドはありません。」 のようなエラーメッセージが出て怒られてしまいます。 こういった場合の回避策・正しい書き方をご教授ください。 よろしくお願いします。 P.S 因みに、上記のようなことをやりたい理由として、 DBへの負荷試験(※)を実施するのが目的となります。 ※断続的にリフレッシュを実行し続ける 無限ループでブン回し続けて、試験終了後、 Ctrl+[c]で停止する想定です。
mac book proでバックアップを取ったアプリLINEの会話データ（talk.sqlite）を パソコン（windowsもしくはmac）で閲覧することはできるのでしょうか。 スタンプは確認する必要ありません。 色々と方法を探しているのですが ↓のようなサイトにもたどりついたものの、 なかなか私の頭ではおいつきませんでして。。。 http://www.kkaneko.com/rinkou/sqlite/sqlitedbbro … お知恵拝借させてください！
ＤＢ名に"-"を使いたいと思います。 ところが、コマンドから入れると、下記のようにエラーになってしまいます。 mysql> create database a-test; ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '-test ' at line 1 しかしながら、ｐhpMyAdminの方からは、作成することが出来ます。 コマンドの方からa-testと言ったＤＢを作成するのにはどうしたらいいのでしょうか？ 尚、バージョンは5.5.27です。 宜しくお願いします。
mysqlのtext型の文字数は何文字くらいまで入るのですか? 例えばひらがなの「あ」で何文字くらい入りますか? 200文字くらいの誤差はあってもいいのです 日本語を入れる場合は何文字くらいに制限するのがいいでしょうか？ よろしくお願いします
すいませんphpとmysqlの処理のしくみがわかってないです phpの処理の中でmysqlからSELECTで値を取得する場合 mysqlが大量のデータで処理に時間がかかった場合は、SELECTの処理に5秒くらいかかっても、phpの処理の中でそこで待ってくれているんですか？ SELECTの処理が何秒かかったとしても終わってから次のphpの処理にいっているんですか？ phpって速いのにmysqlのスピードが遅かったらちゃんと読み込まれないんじゃないかと心配になっています
SSHを使ったmysqlのエクスポート方法を教えてください LinuxコマンドもMysqlも初心者ですが、最近SSHを使ってレンタルサーバーに接続をしていろいろと試してみています。 以下を試してみましたが、エラーが出てでエキスポートできませんでした。 1. $mysql -h サーバー名 -u ユーザ名 -p 2. mysqlのパスワードを入力してmysqlにログイン 3.mysql> mysqldump -u サーバー名 -p データベース名 > testdump.sql; ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'mysqldump -u サーバー名 -p データベース名 > testdump.sql' at line 1　というエラーができてエクスポートできません。 mysql> mysqldump --user=ユーザ名 --password=パスワード名 データベース名 < testdump.sql も試してみましたができませんでした。 以上のものは全てweb上で見つけたコマンドです。 よろしくお願いいたします。
wavepad（マスター版のお試し版）を一昨日無料ダウンロードしました その日は普通に使えて、今日も先程までは使えていたのですが 今、本当に今、 急に保存ができなくなってしまいました 保存するにはソフトを購入しろとのことなのですが お金はかけられません ヘルプにも載っていなかったので質問させていただきました 至急回答よろしくお願いします！！！
お世話になります。 下記、置換前のSELECT結果を 置換後のようにしたいですが、 方法が考え付きません。 できればSQL(ストアド）のみで実行したいのですが スキル不足です。 お手数ですが、ご教授頂きたく宜しくお願い致します。 条件は、B_NOの”N002"が同一のバッチでハイフン以降が 枝番で、その数は、固定では、なくNです。 "N002"のグループ内に"N"が存在したら"P"に置換したいです。 OS:WIN 2003SERVER DB:SQL SERVER2000 SP4 置換前 REC_NO,B_NO,TYPE R001,N001-1,P R002,N001-2,P R003,N002-1,N R004,N002-2,N R005,N002-3,P R006,N003-1,N R007,N003-2,P R008,N004-1,N R009,N004-1,N 置換後 REC_NO,B_NO,TYPE R001,N001-1,P R002,N001-2,P R003,N002-1,P R004,N002-2,P R005,N002-3,P R006,N003-1,P R007,N003-2,P R008,N004-1,N R009,N004-1,N
お世話になります SQL Serverで、 100万件のレコードを削除したいのですが どのような方法が効率よいでしょうか また、メモリ負荷など、クライアント側から分かるような実行計画とかは ありませんでしょうか？ 1.100万件を1回でdelete 2.100万件を複数回に分けてdelete 3.100万件を1行ずつキー指定でdelete(deleteを100万回実行) 100万件deleteしてる場合も、他処理でレコードが登録、更新される可能性が高いため、 そちらの処理がタイムアウトなどのエラーにならないようにしたいです 詳しい方に聞いたところ、 delete発行する際に、メモリにアクセスしてるので、 3だとそれが単純計算で100万倍になるので、負荷が高いのでは？ という事でした。 ご教授の程、よろしくお願い致します
例えば以下のようなデータがあったとします 品目コード、区分 001　A 001　C 001　D 002　E 品目コードでグルーピングし区分を横に並べたデータをクエリで作成したいのです 品目コード、区分 001　A,C,D 002　E このようなデータを出力するにはどういったクエリ(SQL）を記述すればいいでしょうか？ アドバイス下さい
以下の2テーブルの構成で、from_uid毎のto_uidへの在庫移動個数(val)を集計したいと考えています。 ユーザテーブル(user)：uid(int), name(string) 在庫移動管理テーブル(zaiko)：id(int), from_uid(int), to_uid(int), val(int) たとえば、それぞれ以下のようなレコードがあった場合、 <user> uid, name 1 aaa 2 bbb 3 ccc <zaiko> id, from_uid, to_uid, val 1 1 2 3 2 1 2 5 3 2 1 1 4 3 1 4 結果として、以下を得たいと考えています。 uid=1で検索した場合 to_uid, val 1 0 2 7 3 -4 uid=2で検索した場合 1 -7 2 0 3 0 uid=3で検索した場合 1 4 2 0 3 0 （イメージとしては、対戦表？の以下のような表を一行ずつ取得する様な感じです。） ___1__2__3 1__0__7_-4 2_-7__0__0 3__4__0__0 上記のような結果を得たい場合、どのようなSQLを書けばよいのでしょうか。 内容について、わかりづらい点等がありましたらご指摘ください。
いつもお世話になっております。 標題についてご教授下さい。 DBからある項目をupper関数を使って変換しているのですが、 変換されません。 UPPERは文字列などを大文字に変換する認識なのですが、 わかりません。 [table A] key1 Ｔｅｓｔ key2 test SELECT upper(key1), upper(key2) from A 結果 key1 　 key2 Ｔｅｓｔ　 TEST 全角の英字が変換されません。 そもそも全角はtranslateしないとだめでしょうか。 お手数ですが、宜しくお願いします。 　
参考サイトのサンプルをマネしながら少しだけ改造して、OutLookのメールをAccessのテーブル"tbl_mail"に取り込むVBAを書いてみました。 一度取り込んだメールは二度と取り込まない仕組みなのですが、実行してみると必ず1通だけ重複したメールを取り込んでしまいます。 対象フォルダは「個人用フォルダ」の中の「受信トレイ」の中の「集荷」です。 サンプルとして３通のメールを入れていますが、何度実行しても、 "新しいメールはありませんでした。"とはならずに、 "読込み1件・重複2件"となります。 最近ADOを勉強し始めたばかりで原因がさっぱりわかりません。 このサンプルに対する質問は検索してもほとんど見つけられませんでした。 よろしくお願いいたします。 Access2010（Win7）で作り、DBはUSBに保存して、Access2007(vista)でも使っています。 フォームのボタンで標準モジュールのFunction MailGetoを呼び出して実行しています。 Function MailGeto() On Error GoTo エラー Dim cn As ADODB.Connection Dim rs As ADODB.Recordset Dim myNaSp As NameSpace Dim myFolder As MAPIFolder Dim mySecFolder As MAPIFolder Dim myThrFolder As MAPIFolder Dim myItem As MailItem Dim myindex As Long, x As Long, y As Long, i As Long, r As Long Dim MyCri As String Set cn = Application.CurrentProject.Connection Set rs = New ADODB.Recordset rs.Open "tbl_mail", cn, adOpenKeyset, adLockOptimistic Set myNaSp = GetNamespace("MAPI") Set myFolder = myNaSp.GetDefaultFolder(olFolderInbox) i = 0: r = 0 For x = 1 To myFolder.Folders.Count Set mySecFolder = myFolder.Folders(x) For myindex = 1 To mySecFolder.Items.Count Set myItem = mySecFolder.Items(myindex) '受信日時と件名をつなげた文字列を一意とする MyCri = myItem.ReceivedTime & myItem.Subject '条件…"tbl_mail"テーブルの"KEY"フールドの値と一致するもの rs.Find "KEY='" & MyCri & "'" If rs.EOF Then '検索条件と合致する物がない場合 rs.AddNew rs!Key.Value = MyCri rs.Fields("フォルダー").Value = mySecFolder rs.Fields("受信日").Value = myItem.ReceivedTime rs.Fields("送信者").Value = myItem.SenderName rs.Fields("件名").Value = myItem.Subject rs.Fields("メール").Value = myItem.SenderEmailAddress rs.Fields("内容").Value = myItem.Body rs.Update i = i + 1 'メール件数を求めます。 Else r = r + 1 End If Next Next If i = 0 Then MsgBox "新しいメールはありませんでした。" Else MsgBox "メールの更新が完了しました。" & Chr(13) & Chr(13) & _ "・読込み " & i & "件" & Chr(13) & _ "・重複 " & r & "件" End If rs.Close cn.Close Exit Function エラー: If Err.Number = 287 Then MsgBox "書き出しを中止しました" Else MsgBox Err.Number & Err.Description MsgBox "予期せぬエラーが発生しました" End If End Function
ズブの素人です。 わけあって素人である私がssh接続でサーバーをいじらねばならず、 データを直接書くことの恐さだけは知っているため、非常にビクビクしています。 教えてくれる人もおらず、大変困っております； どうしてこんなことになってしまったか、それが一番の問題なんですが、 直下の問題に対応するため、何卒知恵を頂戴いただけますと幸いです。 本当に素人なので稚拙な質問になってしまうと思いますが、 何卒教えていただけますと幸いです。 （mysqlに触るのも、SSHログインするのも人生初です） ■やりたいこと 『_utf8』というデータベースの中に『blog』のテーブルがあり、その中にブログがたくさん入っています。 ブログには作成者の項目が紐づいており、また、公開/非公開を決めるフラグ（0で公開、１で非公開）がついています。 今とある作成者（仮にtanaka）が書いたブログの中で、 2013/1/1までに書かれたブログを非公開にしたい（非公開フラグを１にしたい）です。 ■自力で調べたところまで 自分で調べた結果が下記のmysqlなのですが、 フラグを１にする、UPDATEの文章と 範囲を指定する、SELECTの文章の紐付けが 全く自身がありません。。。 ＝＝＝＝＝＝＝＝＝ UPDATE `blogdb_utf8`.`blog` SET `blog_trash` = '1' SELECT * FROM `blog` WHERE `user_id` LIKE 'tanaka' AND `send_time` <= '2013-01-01 00:00:00' ＝＝＝＝＝＝＝＝＝ 正直絶対どこか間違っているという 逆の自信だけございます。 ■さらに御聞きしたいこと teratermからsshログインというものを人生初しました。 ログインしたあと、ここからどこにcdして、上記の実行文を入れたら良いかがわかりません。。。 おそらく非常に初心者な質問をしているのだろうと自覚しておりますが、 何卒よろしく御願い致します
現在、某共有レンタルサーバーの契約を考えております。 そこのレンタルサーバーではmysqlが１００Mを超える場合は動作が遅くなる可能性があるということをその会社のホームページで見ました。 その会社に電話で問い合わせたところ、１００Mを超えてサーバーに負担がかかり他の利用者の方たちに迷惑がかかるような場合は何らかの制約がされるという旨の説明がありました。 そこで質問なのですが、mysqlの容量が増えると単純にサーバーの負担も増えるようようなものなのでしょうか？　例えば、２００Mのmysqlは１００Mのものに比べて2倍の負担がかかるということがあるのでしょうか？　どうも納得ができなかったため質問させていただきました。 よろしくお願いいたします。
コマンドラインが使えない共有レンタルサーバーを使用しております。 大きなmysqlファイルでもインポートできるbigdumpというものを見つけましたが、こちらはインポート用のみのようです。 http://www.ozerov.de/bigdump/ 現在、レンタルサーバー上のmysqlが大きくなり過ぎて一括ではエクスポートもできなくなっております。 そこで質問なのですが、テーブルを分割してエクスポートする以外に、大きなmysqlでもエクスポートできる何かbigdumpのようなものは存在するのでしょうか？ よろしくお願いいたします。
今現在、PHP MySQLにてDB＆簡単なCMSを作成中です。 仕入テーブル(id, date_y, date_m, id_cost, price, etc...)と勘定項目テーブル(id_cost, name_cost)をid_costをキーにして連結し、月々の勘定項目ごとの集計画面を作成したいのです。 SELECT 仕入テーブル.date_y, 仕入テーブル.date_m, 仕入テーブル.id_direct_cost, 勘定項目テーブル.name_cost, SUM(仕入テーブル.price) AS sumcost FROM 仕入テーブル NATURAL JOIN 勘定項目テーブル WHERE 仕入テーブル.date_y="'.$y.'" AND 仕入テーブル.date_m="'.$m.'" AND 仕入テーブル.typecost="direct" AND 仕入テーブル.id_direct_cost=勘定項目テーブル.id_cost ※$y, $mは集計画面で選択された年月です。 とすると、月々の合計が抽出され、勘定項目ごとの集計ができません。 当方、半年くらい学校にてPHP MySQLを習ったのですが、まだまだ未熟者のため解決できません。 お力をお貸しいただけますと大変ありがたく存じます。 どうぞよろしくお願い致します。
SQL Server(すみませんバージョンが分かりません) をVBから使っています。select やupdateのSQLアクセス を指定時間でタイムアウトさせ、できれば指定回数試行 した上でリターンさせる方法はないでしょうか？ 自前のリトライ機構を実装するのは今さらかなりインパ クト大な状況でして。。 宜しくお願いいたします。
●質問の主旨 下記のサイトを見ながら、データベースのテーブルを インポートしようとしていますが、エラーが出ます。 この場合、phpmyadminのどこを確認すればよいでしょうか？ ご存知の方、ご教示願います。 http://www.dbonline.jp/phpmyadmin/export-import/ … ●開発環境 windows8 xammp1.8.1 ●エラーの内容（添付画像） エラー 実行した SQL: -- -- データベース: `mydb10` -- CREATE DATABASE `mydb10` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci; MySQL のメッセージ: #1007 - Can't create database 'mydb10'; database exists ●インポートの内容(mydb.sql) -- phpMyAdmin SQL Dump -- version 3.5.2.2 -- http://www.phpmyadmin.net -- -- ホスト: 127.0.0.1 -- 生成日時: 2013 年 4 月 20 日 08:27 -- サーバのバージョン: 5.5.27 -- PHP のバージョン: 5.4.7 SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO"; SET time_zone = "+00:00"; /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */; /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */; /*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */; /*!40101 SET NAMES utf8 */; -- -- データベース: `mydb10` -- CREATE DATABASE `mydb10` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci; USE `mydb10`; -- -------------------------------------------------------- -- -- テーブルの構造 `db10` -- CREATE TABLE IF NOT EXISTS `db10` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` text NOT NULL, `address` text NOT NULL, `tel` text NOT NULL, PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT=4 ; -- -- テーブルのデータのダンプ `db10` -- INSERT INTO `db10` (`id`, `name`, `address`, `tel`) VALUES (1, 'あああ', 'いいい', '111'), (2, 'ううう', 'えええ', '222'), (3, 'おおお', 'かかか', '333'); /*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */; /*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */; /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
ACCESS2000でfilterとorderbyを同時に指定する場合について教えてください。 ACCESS2000とwindows7を使用しております。 あるフォームにテキストボックスとコマンドボタンを用意しております。 テキストに入力した文字を元にfilterをかけております。 Me.filteron=true Me.filter=カラム名 like ～～ filterをした後に特定のカラムでソート(降順)したいと考えております。 上記に記載したfilterの後に Me.OrderByOn = True Me.OrderBy = カラム名 を追加したのですがfilterはするのですが、ソートはしてくれません。 上記以外になにか指定するものがあるのでしょうか。 お手数ですが、お力添えお願い致します。
ファイルメーカーで作成した データベースからデータのみの書き出し、読み込みはできますか？ ファイルメーカpro11アドバンスを使っていますが、主に会社でデータ入力を行い、たまにファイルごとコピーして持ち帰り、デザイン部（ボタンや機能など）を修正して変更したりします。 その間、他の人が会社で入力をしてくれたすることがあるので、データを最新のまま 直してきたデザイン部のみ更新したいと考えてます。 エクセル書き出しとか機能があるようですが、書き出したエクセルファイルは整合性をたもったまま問題なくよみこめるのでしょうか？ よろしくお願いします。
SSH接続によりTera Termを使ってmysqlに接続しています。 今までmysqlにはphpmyadminでしかアクセスしたことがなく、初めてコマンドで挑戦中です。 mysql> show databaces　というコマンドを打つと ->　　　 という表示がされて、それ以降何を打っても　-> しかでてきません。 ->というのはどのような意味なのでしょうか？ また、どうのように mysql>　の表示に戻せるのでしょうか？ よろしくお願いいたします。
CentOS6.3(64bit)にmysql-serverとmysql-develをインストール後 mysql>　の状態の時に mysql> mysql -u root -p　と入力したところ mysql> mysql -u root -p -> 上記の画面になり 抜けようとして「quit」「bye」「exit」やら打ち込んでenterしても -> の文字がずーと出続けます。 mysql> mysql -u root -p 　　　-> quit 　　　-> bye 　　　-> quit こんな状態です。 抜ける「キャンセル」したいのですがどのようにすればよいのでしょうか。
untitled に保存されたデータをコンビニでプリントしたいのですが、可能な用に転換できますか御尋ねします。ソフトはマックでグーグルで呼び出したものです。
col1|col2|col3|col4|col5 1001|1003|20|15|5 1002|1001|23|20|3 1003|1002|40|36|4 1003|1003|40|32|4 1003|1003|30|28|4 1004|1003|20|15|5 1004|1004|14|10|5 1005|1004|23|17|6 1006|1005|20|13|7 のようなテーブルを作成し、col1に対してcol2は、行ずれで入力されています。 col1とcol2が違う場合、col3-col5をcol4へ 。 col1=col2の場合、1行上のcol4-col5としています。 EXELでは　=IF(A3=B3,D2-E3,C3-E3)　として出力でるのですが、 Mysqlでこれを実現するにはどうしたら良いでしょうか。 col1とcol2がマッチしない場合は、通常処理としてcol3-col5をcol4に行い、 マッチする場合は、通常処理で行われたcol4-col5をcol4へ出力します。 マッチが連続すれば、col4-col5が繰り返されるイメージです。 よろしくお願いします。
sql文の中で以下のように時間を指定してselectしています。ですが、時間を「sqlの実行時間からn分前までの間」に修正したいと考えています。どなたかご教示いただけませんでしょうか。 select count(*) from tableA where hoge = '0000' and end_time >= cast('2000/1/01 00:00' as timestamp) and end_time < cast('2011/1/31 00:00' as timestamp) たとえば select count(*) from tableA where hoge = '0000' and end_time >= sqlを実施した時間から45分前 and end_time < sqlを実施した時間 のようにしたいです。 ご協力お願い致します。
Access DLOOKUPについて こんにちは。Access2010でのDlookupについてお教えください。 ■注文テーブル オーダーID,商品コード,数量,お店番号 001,A01,1,お店1号 001,A02,5,お店1号 002,B01,3,お店2号 002,B02,3,お店2号 ※同一オーダーIDで商品コードが重複する事は無 ■確認用注文テーブル 商品コード,数量,お店番号 A01ですよ,1お店1号 B02です,3,お店2号 ※なんと、オーダーIDがありません。さらに商品コードに変な文字列も入っています。 ■やりたい事 フォームに「判定」というテキストボックスを配置しました。 コントロールソースで以下の条件にあっているなら○、あっていないなら×と表示したいです。 ○注文テーブル.商品コードと確認用注文テーブル.商品コードを比較。 注文テーブル.商品コードのデータが確認用注文テーブル.商品コードに含まれていること。 ○注文テーブル.数量と確認用注文テーブル.数量がイコールであること。 ○注文テーブル.お店番号と確認用注文テーブル.お店番号がイコールであること。 これらを満たしていれば、○、満たしていなければ×と表示したいです。 Dlookupでなくても、何か他に方法がありましたらお教えください。 宜しくお願いします。
Access初心者で、独学で頑張っています。 どうしても一人で解決できないので、教えてください。 下記のようなコードを書きましたが、＃１で　『PARAMETER句の構文エラーです』　となります。 Dim qd As DAO.QueryDef Dim rs3 As DAO.Recordset Dim mySQL As String Set qd = CurrentDb.CreateQueryDef("") mySQL = "PARAMETERS [ParaヘッダーID] COUNTER;" mySQL = mySQL & "SELECT [テーブルA].[明細ID], [テーブルA].[ヘッダーID] " _ & "FROM テーブルA " _ & "WHERE ((([テーブルA].[ヘッダーID])='ParaヘッダーID'));" With qd .SQL = mySQL 　 '　#1　ここで『PARAMETER句の構文エラーです』　となる .Parameters("ParaヘッダーID") = [TempVars]![tempヘッダーID] Set rs3 = .OpenRecordset() End With （この後、処理を続ける） やりたいことは、 「テーブルA」から、「ヘッダーID」が一時変数[TempVars]![tempヘッダーID]と一致するデータを抜き出し、後続の処理に使いたいのです。 なお、ヘッダーIDは長整数型で、[TempVars]![tempヘッダーID]をウォッチで確認すると整数が入っていました。 SQLについて、いろいろ調べて試しましたが、なかなか上手く行きません。 どこが違うのかご教授お願いします。
恐れ入ります。 Mysqlにて、ひとつ上のレコードを参照し、 真であれば○○偽であれば××という処理をしたいのですが、どのような方法がありますでしょうか。 EXELで行うと、=if(A1=A2,"1","0") のような処理になります。 昇順で並び替えて、重複レコードについて処理を行いたいです。 よろしくお願いします。
現在下記のSQL文で会社単位で訪問回数と請負費を出していますが。 JOINしているテーブルをUNION（複数テーブルの合計）するにはどうしたらいいですか？ （テーブルは社員単位で作成しています） SELECT TEST11.会社名, SUM(TEST2.訪問回数) AS 訪問回数, SUM(TEST2.訪問回数 * TEST2.単価) AS 請負費 FROM TEST11 RIGHT OUTER JOIN TEST2 ON TEST11.訪問日 = TEST2.訪問日 AND TEST11.区分コード = TEST2.管理番号 GROUP BY TEST11.会社名 ORDER BY TEST11.会社名 結果は下記になってます |会社名|訪問回数|請負費| 分る方ご教授頂けると幸いです
MySQL 5.6 なのですが・・・・ ＤＢの文字コードはＤＢ作成後にデータを登録した後に、途中で文字コードを変更した場合、ＤＢに登録済みの全角文字はどうなりますか？ 文字化けする場合、変換ツールのようなものはあるのでしょうか？ また文字コードの変更は ini ファイルを変更してMySQLを再起動するだけでいいのでしょうか？
MySQL勉強中です。Windows7のコマンドプロンプトでデーターを入力したいのですが、日本文字がエラーになります。 コマンドプロンプトの文字コードがシフトJISになっているので、chcp65001でutf-8にコード変換しました。しかし、日本文字が表示されません。 MSゴシックにフォント設定をしてから再度utf-8に変換しましたが、やはり日本語選択が出来ません。 ネットの情報によると、最初にMSゴシックに設定しないでコード変換してしまうと、次からは設定項目に表示されないとのことです。 さて、その対処法をお教え願えないでしょうか。 MySQLのバージョンは5.1です。 よろしくお願い致します。
恐れ入ります。mysqlで右端のカラムにデータを次々とupdateしたいのですが sql文はどのようにすれば良いでしょうか。 右端のデータの無いカラムのを探してupdateするイメージです。 よろしくお願いします。
ストアドプロシージャの中であるSQLの前に ２秒程度待ちを入れたいのですが、可能でしょうか。 INSERT xxxxxxxxx ２秒待ち UPDATE xxxxxxxxx みたいな形にしたいのです。 どなたかお分かりになる方、ご教授のほど、お願い致します。
SQLite3とPHPを使っているのですが、他のデータベースでも同じだと思うので一般的な質問になりますがよろしくお願い致します。 SELECTでデータを並び替えて抽出するにはORDER BYを使いますが、例えば2つのデータベースがあってそれぞれのカラムにある数値同士の差を降順、昇順で並び替えるにはどのような方法があるのでしょうか？ 「データベースDB1のvalueカラムにある値」　-　「データベースDB2のvalueカラムにある値」　＝　差分 この差分を降順、昇順で並び替えて取得したいのですが、このような場合は一度配列に格納しておいて、その配列を並び替えることになるのですか？ それともデータベースのクエリーでそのようなことが可能なのでしょうか？ もう一つお聞きしたいのは、「同じデータベース内での2つのカラムの値の差分で並び替え」したい場合もお教えください。 どうぞよろしくお願い致します。
よろしくお願いします。 OS：Redhat Enterprise Linux 6 DB：MySQL5.6 OSでrootで作業をしており、MySQLをrpmパッケージからインストールすると、 実行ユーザがrootになってしまうことを危惧しています。 サービスをrootで起動することはセキュリティ上 望ましくない、と聞きました。 別途「mysql」というユーザを作成しました。 このmysqlユーザをサービスの起動ユーザとしたいのですが、 どういった手順でそれを実施すれば良いでしょうか？。
マイドキュメントの隠しオブジェクトが 有るのですが 表示するには、 どうすればいいのか 教えて下さい御願い致します。
PostgreSQL 8.4に関する質問です。 サーバ：Linux、PostgreSQL 8.4 クライアント：Windows 7 Windowsマシンから、バッチファイルでサーバ上のPostgresのバックアップを取りたいのですが、 以下のコマンドをバッチファイルに記述して実行すると、 「パスワード:」というプロンプトが出て処理が止まってしまいます。 pg_dump.exe -h [DBサーバのIP] -U [ユーザ名] -F custom -b -v -f "C:\test.backup" "test" パスワードを入れればバックアップはできるのですが、 パスワードの入力まで完全自動化するにはどうすればいいでしょうか。 Linux上のPostgresはSSL接続のみ許可するようになっています。 Windowsのタスクで毎日バックアップする運用を想定しています。
Windowsに、PostgreSQL 旧バージョン等をインストールしたいのですが、 以下のバージョンをインストールする事は可能でしょうか。 PostgreSQL 7.3.6 Apache 2.2.23 PHP 5.2.17 Windows は、できれば7(64bit)、駄目ならXP(32bit)に入れたいです。 Postgresを自分で探してみたのですが、Linuxバージョンしか見つける事ができませんでした。
mysqlに「１－１－１」という文字をUTF8で登録しました。 sjisで書かれたphpファイルでこの文字を表示するために、sjisに変換したのですが 「１?１?１」となってしまいます。 うまく表示するにはどうすれば良いでしょうか？
order byする際、2カラムの先頭1文字で判断して、並べ替えることは可能でしょうか？ ■想定 ・titleカラム ・yomiカラム ※運用案 案1 「titleカラム」先頭1文字目に漢字が入っているときだけ、yomiカラムにカタカナでフリガナを振る 案2 「titleカラム」先頭1文字目に漢字が入っているときは必ず、yomiカラムにカタカナでフリガナを振る
PostgreSQLバージョン　9 OS：RedHat 現在Oracleからの移行でPostgreSQLにてTEXT取り込み処理を作成しています。 OracleではSQLLoaderを使用して取り込んでいましたが、 PostgreSQLではCOPYコマンドを使用すれば取り込みできるところまで調べました。 しかし、行末に区切文字があるためうまく取り込みできません。 【コマンド】 \copy hoge from 'hoge.txt' delimiters '|'; 【行末に区切文字がある場合NG】 AAA|BBB|CCC| ERROR: extra data after last expected column CONTEXT: COPY hoge, line 1: "AAA|BBB|CCC|" 【行末に区切文字がない場合OK】 AAA|BBB|CCC SQLLoaderでは行末の区切文字があっても取り込めましたが COPYコマンドでは取り込めないようです。 回避策はないのでしょうか？ （取引先からのTEXTなので相談はして見ますがレイアウトの変更は難しいかもしれません。） 回避策がない場合、行末の区切文字を削除する方法はありますでしょうか？ 行末だけの区切文字を削除する方法が分かりません。 （テキストは固定長でないため、桁数を指定した削除ができません） 行末区切文字削除の方法だけでも良いのでお願いします。
SQLで結果を出したとき値がNULLならタブを出したいのですが、どのような書き方をすればいいのでしょうか？ 結果をCSVとかに吐き出していたりするのですがNULLだと左に値がよってしまい別の項目に別の値が見えてしまいます。 詳しい方教えていただけませんでしょうか？
Microsoft Access 2003の共有設定について御質問させてください。 ３台パソコンがあり、仮にそれぞれＡ、Ｂ、Ｃとします。 仮に親機としてAにAccess2003データベースファイルが共有して存在しております。 もう２台、Ｂ、Ｃにはデスクトップにショートカットを設置しています。 これまでそのデータベースを３台の内、親子２台から使用できておりました。 但し、開く順番は子を開いてから、親を開かなければなりませんでしたが、今朝から突然、子機のうち１台Ｂで開くと親機Ａでデータベースを開く事ができなくなりました。 もう一方の子機Ｃで開いた時は、親機でも開く事ができます。 子機Ｂの設定が何か拍子で変更されてしまったとは思うのですが、設定を修正する方法がわかりません。 初歩的なことでしたら申し訳ありません。 自力でも調べる努力をいたしますので、どうか御教授願います。
ファイルメーカで条件による画像表示がうまく行きません。 前に似たような質問をされている方がいたので参考にしましたがだめでした。 フォーム画面でレコードの最後を表示した時に（最後です）の旨の画像を表示したいです。 データベースでオブジェクトフィールドを2つ追加し、（画像1）（画像2）とし、1はオプションで計算にし if(get(レコード番号)=get(レコード総数): "" , 画像2) 画像2はグローバルフィールドにして背景色で塗りつぶしました。 画像1を透明にし、条件で最終レコードが表示されたら空白で背景の画像を表示し、それ以外は画像2を表示して消す、との事だと思いますが、 まず、画像1が透明にできない（白になります）、多分式が間違っているのでしょうが、 画像も入れ替わりません。 オブジェクトフィールド自体を理解出来てないんでしょうか？ 本当に素人な質問です申し訳ないですが、よろしくお願いします。
はじめまして。 親子関係を持つ２つのテーブルを結合するSQLについて教えてください。 データベースはAccess2003です。 親テーブル：契約基本 【基本SEQ】【契約番号】 【契約者名】【基本契約年月日】 1　　　　　K0001　　　　契約者１Ａ　2013/05/01 2　　　　　K0001　　　　契約者１Ｂ　2013/05/10 3　　　　　K0001　　　　契約者１Ｃ　2013/05/20 4　　　　　K0002　　　　契約者２Ａ　2013/06/10 5　　　　　K0002　　　　契約者２Ｂ　2013/06/10 6　　　　　K0002　　　　契約者２Ｃ　2013/06/10 7　　　　　K0003　　　　契約者３Ａ　2013/07/01 8　　　　　K0003　　　　契約者３Ｂ　2013/07/10 9　　　　　K0003　　　　契約者３Ｃ　2013/07/10 子テーブル：契約明細 【契約番号】【契約種別】【明細契約年月日】 K0001　　　　S1　　　　　2013/05/05 K0001　　　　S2　　　　　2013/05/10 K0002　　　　S1　　　　　2013/06/05 K0002　　　　S2　　　　　2013/06/10 K0003　　　　S1　　　　　2013/07/05 K0003　　　　S2　　　　　2013/07/15 契約基本テーブルの基本SEQはオートナンバーです。 この２つのテーブルを以下の条件で結合したいです。 ・契約明細テーブルの１レコードについて、契約基本テーブルから１レコードずつ結合 ・結合する契約基本テーブルの条件は、以下の通り 　１．契約明細・契約番号単位で、明細契約年月日に最も近い基本契約年月日のレコード 　　　（明細契約年月日を超えない。明細契約年月日と同一日はOK） 　２．１．の条件を満たす契約基本テーブルのレコードが複数存在する場合、 　　　その中で基本SEQが最大のレコード 　３．１．の条件を満たす契約基本テーブルのレコードが存在しない場合、 　　　該当する契約明細レコードは出力対象外。 以上の条件をもとに、１つのSQLで以下のような結果を取得したいです。 【契約番号】【契約種別】【明細契約年月日】【基本SEQ】【契約者名】【基本契約年月日】 K0001　　　　S1　　　　　2013/05/05　　　　1　　　　　契約者１Ａ　2013/05/01 K0001　　　　S2　　　　　2013/05/10　　　　2　　　　　契約者１Ｂ　2013/05/10 K0002　　　　S1　　　　　2013/06/05…[条件を満たす親レコードがないため出力対象外] K0002　　　　S2　　　　　2013/06/10　　　　6　　　　　契約者２Ｃ　2013/06/01 K0003　　　　S1　　　　　2013/07/05　　　　7　　　　　契約者３Ａ　2013/07/01 K0003　　　　S2　　　　　2013/07/15　　　　9　　　　　契約者３Ｃ　2013/07/10 １つのSQLで処理したい理由は、そのSQLをクエリに登録して、データシートに紐付け、 一覧表示したいと考えているためです。 以上よろしくお願いします
Microsoft Access2010 選択クエリデータをEXCEL2010にエクスポートしたいMicrosoft Access2010は高齢者で初心者なので分かりやすい表現で教えて下さい、フォーム上にコマンドボタンを設置しています、コマンドボタンクリック時、EXCEL2010　sheet1 A4を起点にエクスポートしたい 宜しくお願い致します。
「さくら」のレンタルSVを利用しています。 そのSVのphpMyAdminで特定のレコードの検索方法について教えてください phpMyAdminのバージョンは3.3.10.5となっています テーブルはフールド数200程度、レコード数2000程度のDBがあります その中から、ある特定のレコードを抽出して特定のフィールドのデータ 修正をしようとしています phpMyadminにログインし該当のテーブルを指定してデータを全件表示します。 例えばフィールドが、a1,a2,a3,a4・・・とあったとします a1に"abcde"があることを確認した後(試験のためで本来は必要なし)、 phpMyadminの検索メニューをクリックして検索画面に進みます その画面でフールドa1のところに"abcde"を打鍵して「実行」ボタン を押下したら、本来は該当のデータが出てくると思うのですがエラー画面がでます 内容は 実行したSQL: select'a1','a2','a3'・・・・ from 'テーブル名' where 'a1'=abcde order by limit 0,30 MySQLのメッセージ #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'LIMIT 0, 30' at line 2 とこのようなメッセージがでます ちなみに 次のSQLのselectの所を全て選択するのでなく*で記載すると該当のレコード を抽出できます select　* from 'テーブル名' where 'a1'=abcde phpMyAdminの検索画面の最下段にオプションがあり該当のフィールドを 1つ以上選択できる画面があるのですが、10件程度の選択なら抽出します 全件を選択したり20件だとエラーとなります このオプションでの選択数は限度があるのでしょうか あるいは、別に何か選択する方法があるのでしょうか どなたか、上記の操作で検索ができるようにする方法を教えて いただけませんか よろしくお願いします。
Access2010で分割フォームを作りました。 分割ビューのデータシート部分のフィールド幅を記憶させることはできるのでしょうか？ 幅を変えても、フォームを閉じてから開きなおすと、元の幅に戻ってしまいます。 フォームのプロパティをいろいろ変えてみたのですが、どうもうまくいきません。 どなたかご存知でしょうか？
　今まで10年近く、Accessを使って仕事上でお付き合いのある会員さんの金銭的な管理を行ってきました。 　今回どうしてもその会員さんの予約の管理をしなければならなくなりJavaScript、Perl、MySqlを使ってどうにかそれをWebに作り上げることができました。 　開発の日程がなく、また、慣れない作業であったこともあって、今までのAccessの金銭的な管理システムと今回作った予約管理システムとで、会員さんの登録作業等2回ダブった作業をしなければならないこと、また、本来それらはお互いに関係しているデーターですから関連付けてデーターを使いたいのですが今現在は別々のシステムとしてPC上とWeb上に存在しております。 　そこで、それらを統合したシステムになるようにしたいと思い、ネット等でいろいろ調べたのですが、そのような情報を見つけることはできませんでした。 　将来的には今のAccessで使っている他のTable等もすべてWeb上に移しAccessを使ってWeb上のデーターを使いたいと考えておりますが、そのようにするためにはどのようにしていけばよろしいでしょうか? 　考え方、参考となるHP、その他書籍等、ご教授いただけると大変助かります。なお、今回は主にXpで開発を行いましたが、Vista、Windows7でも対応可能です。 以上、よろしくお願いいたします。
MS-Access2000を使っています。 テーブルに時間が指定してあり、その時間幅に合わせて文字列を検索したいと考えています。 Excelのlookup のように対象の値を入れると同数以外は前の(上の)数字を検索するという処理をしたいのです。 しかし、VBA内ではVlookupは無く、DLookupとなり値が同数でなければ「null」を返してきます。 何か良い方法はあるでしょうか？ぜひ、回答をよろしくお願い致します。 VBAでの関数 temp = DLookup("表記", "T_時間帯", "開始 = #" & Me.時間帯 & "#") T_時間帯 開始 表記 9:00　　午前中A 10:30 午前中B 13:00 午後A 15:00 午後B 例 *9:30をMe.時間帯に入れておくと検索値を「9:00」としたい *12:59Me.時間帯に入れておくと検索値を「10:30」としたい *13:00Me.時間帯に入れておくと検索値を「13:00」としたい *17:00Me.時間帯に入れておくと検索値を「15:00」としたい
恐れ入ります。 Mysql で、２つのテーブルがあり、 １つが1000レコード 2つめが1500レコードあります。 プライマリーコードを参照して、 1つめの1000レコードに、2つめのテーブルを揃えたいのですが、 うまくいきません。 delete from t2 left join t1 on t2.num=t1.num where t1.num IS NULL; としましたがうまくいきませんでした。 1つめのテーブルのレコードにマッチしたもの以外を2つめのテーブルから削除みたいな感じです。 よろしくお願いします。
　 お世話になります。 長文失礼します。 現在稼動中の MS ACCESS 2003で作られた業務管理システムがあります。 そのシステムのDB部分のみ SQL Server 2008 Express に移行するという作業を行なっています。 ※データ照会などのレスポンスアップが目的です 現行のシステムは FORM.MDB（インターフェースのみ） → DATABASE.MDB（データのみ） 移行後は FORM.MDB（インターフェースのみ） → SQL Server 2008 Express（データのみ） となります。 まず、DATABASE.MDBにあるテーブルをACCESSの機能である "アップサイジングウィザード"を使用し、SQL Server に移行しました。 次にテーブルのリンク先をDATABASE.MDB から SQL Server に張り替えました。 基本的には上記の処理のみでデータの照会等うまくいっているのですが 大量の件数（約20万件）のデータを照会する画面で結果が表示されるまでの速度が （現行のシステムと比較して）低下したため改善を行なっております。 上記の照会画面では ACCESSのクエリで複数のテーブルを繋げ、集計した結果を表示しています。 このクエリの代わりにSQL Server側でビューとして作成し、それに対してテーブルリンクを張れば 良いのではないかと考え、実行しました。ビューにリンクを張ったクエリ名を仮に"Q_照会"とします。 結果、照会結果を表示するまでの時間はかなり短縮できた（ように見えた）のですが 照会結果をスクロールや、PageUpキーによるページ移動をすると毎回１、２秒後に スクロール後の結果が表示されます。※現行システムではスムーズにスクロールします。 プロファイラで監視してみるとページ移動した時に、"Q_照会"をテーブルキー指定で SELECT している事がわかりました。毎回10レコード取得しています。 この様な記述は私は書いていませんのでACCESS（SQL Server?）が勝手に行なっている 動きだと思われるのですがどこかで設定できるのでしょうか？ また今回、ACCESSのクエリをSQL Serverのビューに置き換える方法を取りましたが 別の方法でレスポンスアップが望める方法があればご教授お願い致します。 　
pl/pgsqlで再帰呼び出しは可能でしょうか。 PostgreSQLのバージョンは9.2.3です。 作成しているファンクションは正方形の中心座標を求めてInsertするものです。 指定した回数だけ、再帰的に正方形を４分割にどんどん細分化していき、 それぞれの正方形の中心座標をInsertします。 ４分割にした正方形をそれぞれ以下のように番号を振って説明します。 　左上・・・(1) 　右上・・・(2) 　左下・・・(3) 　右下・・・(4) 元の正方形を求めた後、(1)→(2)→(3)→(4)の順に再帰的にファンクションを呼び出します。 パラメータを「３回」以上にした場合は、(1)についてもまた４分割していきます。 ここで、パラメータを「１回」とした場合は、元の正方形の中心座標は当然Insertできます。 パラメータを「２回」とした場合、(1)の正方形の中心座標も求まりますが、 (1)の正方形については再帰の最終処理のため、Insert後にRETURNすることで エラーとなっているのか、１つ目の正方形のレコードも(2)の正方形のレコードも Insertされていません。 さらにはその「RETURN句」が元のファンクションすら「終了」させているようで、 (2)、(3)、(4)の正方形の処理が行われません。 このように再帰呼び出しをしたいと思っても、再帰中の処理を終わらせ、 呼び出し元に戻らせるはずのRETURN句が、一番最初のファンクションの「終了」と 理解されてしまい、pl/pgsqlでは再帰呼び出しは実現できないのでしょうか。 ファンクションのイメージは以下の通りです。 CREATE OR REPLACE FUNCTION Insert_squre( IN kaisuu INT, --再帰的に呼び出す回数 IN count INT, --再帰回数をカウント IN X1 INT, --正方形の左上の頂点のX座標 IN Y1 INT, --正方形の左上の頂点のY座標 IN X2 INT, --正方形の右下の頂点のX座標 IN Y2 INT --正方形の右下の頂点のY座標 ) RETURNS void AS $$ DECLARE /* 変数定義 */ ・・・・・ BEGIN /* 中心座標を求める */ ・・・・・ /* 中心座標をInsert */ ・・・・・ /* kaisuu=countならばRETURN */ ・・・・・ /* (1)の正方形について再帰処理 */ select Insert_squre( IN kaisuu INT, --再帰的に呼び出す回数 IN count+1 INT, --再帰回数をカウント IN X1 INT, --正方形の左上の頂点のX座標 IN Y1 INT, --正方形の左上の頂点のY座標 IN X3 INT, --正方形の右下の頂点のX座標 IN Y3 INT --正方形の右下の頂点のY座標 ); /* (2)の正方形について再帰処理 */ ・・・・・ /* (3)の正方形について再帰処理 */ ・・・・・ /* (4)の正方形について再帰処理 */ ・・・・・ RETURN; END; $$ LANGUAGE PLpgSQL;
カラムはidとnameです AUTO_INCREMENTをidにつけました googleで検索したら、「AUTO_INCREMENTをつけた場合はindexをつけなくてはいけない」 と書いてあったのですが、なぜindexをつけないといけないのでしょうか？indexなしだとよくないですか？ 今あるidのカラムにsqlでindexを付けることはできますか？ よろしくお願いします
ピボットテーブルでは「値」の詳細表示ができますが、クロス集計クエリで詳細表示は可能でしょうか？ 具体的には テーブル クライアントID　　　来店日 0001_________________2013/1/1 0001_________________2013/2/3 0001_________________2013/3/1 0002_________________2013/3/5 0002_________________2013/3/7 0003_________________2013/2/5 0003_________________2013/3/10 クエリで来店年、来店月、来店日それぞれに表示指定 求めるクロス集計結果 _______________1月________2月__________3月 0001__________1____________3_____________1 0002_______________________________________5 _____________________________________________7 0003________________________5___________10 こんな感じです。 内部の運用ルール上VBAは使えません 出来る限りAccessでレポート印刷したいのです。 ピボットでの印刷はすでに行っていますが、改ページ位置などで不満が残ります。 出来ないのであれば、出来ないで上司にはあきらめてもらいます。 （無駄な時間をとらなくてすみますし・・・） 二重、三重のクエリやら、関数やら、追加・更新クエリやら試してみましたが、アイディア切れです。 どうか助けてください。 よろしくお願いいたします。
レンタルSV(「さくら」スタンダード)でMySqlを利用しています phpMyadinで作成したフールド数200程度、レコード数2000程度のDBがあります 今回、ある特定のレコードを抽出して特定のフィールドのデータ 修正をしようとしています phpMyadminにログインし該当のテーブルを指定してデータを前件表示します。 例えばフィールドが、a1,a2,a3,a4・・・とあったとします a1に"abcde"があることを確認した後(試験のためで本来は必要なし)、 phpMyadminの検索メニューをクリックして検索画面に進みます その画面でフールドa1のところに"abcde"を打鍵して「実行」ボタン を押下したら、本来は該当のデータが出てくると思うのですがエラー画面がでます 内容は 実行したSQL: select'a1','a2','a3'・・・・ from 'テーブル名' where 'a1'=abcde order by limit 0,30 MySQLのメッセージ #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'LIMIT 0, 30' at line 2 とこのようなメッセージがでます ちなみに 次のSQL文を直接たたくと表示されます select'a1','a2','a3'・・・・ from 'テーブル名' where 'a1'=abcde どなたか、上記の操作で検索ができるようにする方法を教えて いただけませんか よろしくお願いします。
ポスグレでイベントトリガを使いinsert時に任意の関数を呼び出し処理を行いたいのですが 最後にinsertされた(正確にはそのイベントが発生したときにinsertされた)レコードの データを関数内で使うやり方がわかりません。 そういった関数みたいのがあるのでしょうか。 ご存知の方、ご教示いただけると助かります。
●質問の主旨 kensaku.htmlから数字（データベースのコード番号）を入力・検索して、 PHPMyAdminにあるデータベースから、特定のレコードを取り出したいのですが、 データベースにあるすべてのデータが返されます。 検索窓に入力した特定のレコードの内容だけを 返すためには、下記のichiran.phpをどのように直せばよいでしょうか？ ●プログラムの流れ 1．kensaku.htmlの検索窓に番号を入力・送信 2．PHPMyAdminにあるデータベース（aketo)にアクセス 3．ichiran.phpで検索結果を表示 ●プログラムコード （kensaku.html) <!DOCTYPE html> <html lang="ja"> <head> <meta charset="UTF-8"> <title>PHPの基礎</title> </head> <body> <form method="post" action="kensaku.php"> ご意見コードを入力してください。<br/> <input name="code" type="text" style="width:100px"><br/> <br/> <input type="submit" value="送信"><br/> </body> </html> （ichiran.php） <!DOCTYPE html> <html lang="ja"> <head> <meta charset="UTF-8"> <title>PHPの基礎</title> </head> <body> <?php $code=$_POST['code']; $dsn = 'mysql:dbname=phpkiso2;host=localhost'; $user = 'root'; $password = ''; $dbh = new PDO($dsn,$user,$password); $dbh->query('SET NAMES UTF-8'); $sql = 'SELECT * FROM anketo WHERE code='.$code; $stmt = $dbh->prepare($sql); $stmt->execute(); $stmt->execute(); while(1) { $rec = $stmt->fetch(PDO::FETCH_ASSOC); if($rec == false) { break; } print$rec['code']; print$rec['nickname']; print$rec['email']; print$rec['goiken']; print'<br/>'; } $dbh = null; ?> </body> </html> ●開発環境 windows8 xammp1.8.1 MySQL(PHPMyAdmin)
ファイルメーカpro11でレイアウト画面内に自分で検索窓を作りたいのですがうまく行きません。 テキストの入力欄があってそこに品番を入力し検索ボタンをおすと検索結果が表示されるというシンプルなモノですが、グローバルフィールドをつくったりいろいろためしましたがだめでした。 初心者な質問で申し訳ありませんがよろしくお願いします。
●質問の主旨 wordpressのデータベースに接続しようとしたら、 「接続確立エラー」が表示されます。 （添付画像） Google検索などで自分で調べて対策を講じてみましたが、 次の画面に進めません 他に何か対策をご存知の方、よろしくお願いします。 ●状況 1．xampp1.8.1をアンインストールした後、 再インストール ↓ 2．wordpressをダウンロード ↓ 3．wordpressフォルダ内にある wp-config-sample.phpを書き換え ↓ 4．wordpressフォルダをC\xammp\htdocsの下に配置 ●書き換えたwp-config-sample.phpの参考サイト 「MySQL 設定」部分の書き換え。 http://39kn.com/2011/05/17/5366/ 「ホスト名」の書き換え http://hryksbt.b.sourceforge.jp/archives/338/
お世話になります。 PostgreSQL8.4.8のphpPgAdmin3.5.3を使ってデータを削除する際に 先ずデータをSELECT で表示させて確認後、 SQL編集　で　SELECTを　DELETE　に書き換えて実行しましたが以下エラーが出ます ≪一覧確認用≫一覧表示はできました。 SELECT "kaiin_no","tenpo_no","tenpo_name" FROM "public"."store_table" WHERE "kaiin_no" IN ('1234',2222'); ≪削除用≫SELECT 　→　DELETEに変更　→　実行　→　以下エラー DELETE "kaiin_no","tenpo_no","tenpo_name" FROM "public"."store_table" WHERE "kaiin_no" IN ('1234',2222'); ≪エラー内容≫ ERROR: syntax error at or near "," LINE 1: SELECT COUNT(*) AS total FROM (DELETE "kaiin_no","tenpo_no",... ^ 文: SELECT COUNT(*) AS total FROM (DELETE "kaiin_no","tenpo_no","tenpo_name" FROM "public"."store_table" WHERE "kaiin_no" IN ('1234','2222')) AS sub 文法エラーのようなのですが 一覧が出来ているのに　なぜ削除が出来ないのか 初心者で恐縮ですが ご教示頂ければ幸いです。
●質問の主旨 phpMyAdminのデータベースを削除したら画面の左側に エラーが出ました。この表示を消すためにはどうすればよいでしょうか？ 昨日、はじめたばかりでまだよく分かっていません。 ご存知の方よろしくお願いします。 ●質問の補足（エラーの状況） 1．データベースにチェックを入れる 2．削除ボタンをクリック 3．エラーが表示 4．このあと新規でデータベースを作成しても、 フィールドの設定をするとエラーが出る ●開発環境 windows8 xammp
mysqlを使おうと勉強中です mysqlに同時書き込みした場合についての質問です 例えば,5人のユーザーが同時に書き込んだとします。書き込むレコードは全て違います ユーザー1がレコード1行目に書き込み ユーザー2がレコード2行目に書き込み ユーザー3がレコード3行目に書き込み ユーザー4がレコード4行目に書き込み ユーザー5がレコード5行目に書き込み この場合は、普通のtableで処理できますか？
MYSQLで部屋を利用するための予約システムを作ろうと考えております。 設計として下記を考えてみたのですがおかしいでしょうか。 要件は下記のとおりです。 ・A、B、C３つの部屋の利用予約を時間単位でおこなう ・重複する時間は予約できない ・日を跨ぐ予約はできない テーブル設計 トランID（int）｜開始時刻(datetime)｜終了時刻(datetime)｜部屋ID(int) 時間についてはdatetime式で2013-03-22　12：00：00　と保存させる予定です。 入力を簡素にするため、時刻は時、分個別のプルダウンで30分刻みにしようと考えています。 そこで分からなくなってきたのがデータ保持の方法なのですが、 例えば10：00－12：00と予約入力された場合、datetime式ですと秒まで保存されますので 2012-03-22 10:00:00 - 2012-03-22 12:00:00 となりますよね。 そうなりますと、別の予約で12：00-15：00を確保したい場合、開始時刻は重複してしまうことに なりますので、テーブルには2013-03-22 10:00:01 - 2013-03-22 11:59:59と登録したほうが いいのでしょうか。 ただ、これだと時間を変更したい場合の修正の際に困ったことになりそうです。 またこの設計の場合、　開始時刻と終了時刻が他の予約と重複していないかのSQLを 考える場合、非常にやっかいなような気がしてきました。 何か別のよい設計のヒントがあればご教授願えないでしょうか。 宜しくお願いいたします。
ADO.NETでsdfファイルからmdbファイルへテーブル（TBL1)を移行させたいと思っています。 以下のようなコードでDataSetをコピーできないか試しましたが、移行できません。 sdf、mdbともテーブルのカラムの構造は同一です。 mdbの方にはレコードが空のテーブルが用意してあります。 何が間違っているのでしょうか？お教えいただけると助かります。 SDF Dim con As SqlCeConnection = DBUtility.GetConnection() con.Open() Dim strSQL As String strSQL = "select * from TBL1" Dim adapter As SqlCeDataAdapter = _ New SqlCeDataAdapter(New SqlCeCommand(strSQL, con)) con.Close() Dim ds1 As DataSet = New DataSet() adapter.Fill(ds1, "TBL1") Dim con2 As OleDbConnection = DBUtility.GetOLEConnection() con2.Open() 'MDB Dim strSQL2 As String strSQL2 = "select * from TBL1" Dim adapter2 As OleDbDataAdapter = _ New OleDbDataAdapter(New OleDbCommand(strSQL2, con2)) Dim ds2 As DataSet = New DataSet() ds2 = ds1.Copy Dim cb As OleDbCommandBuilder = New OleDbCommandBuilder(adapter2) adapter2.Update(ds2, "TBL1")
下記のようなテーブルから ユニークなデータの件数を取り出すクエリを作成したいのですが、どうもわかりません。 教えてください！宜しくお願い致します。 NO | CD1 | DATE1 | CD2 | DATE2 | CD3 | DATE3 1 111 20120301 222 20130301 333 20130303 2 111 20120301 222 20130301 333 20130303 3 222 20120301 333 20130301 4 222 20120301 333 20130301 5 333 20120301 444 20130301 555 20130302 6 333 20120301 444 20130301 555 20130303 7 333 20120301 8 333 20120302 というテーブルがあって、 この中で DATE1、DATE2、DATE3のいずれかが、 同じであれば、行を取り出しカウントする。 1項目しかデータがなければ、単純にカウントする。 取り出しはCDのみ。 上記であれば、 COUNT | CD1 | CD2 | CD3 2 111 222 333 2 222 333 2 333 444 　　　　※こちらはDATE3が異なるのでCD3は取り出さない。 2 333
現在、mysql＋phpを使ったwebシステムの開発を行っているのですが、日本語の文字化けに 苦戦しています。 mysqlのコマンドでselect * from テーブル名　と打ったところ、insertコマンドで投入した要素名で 日本語で入力したものが、?????で表示されてしまいます。 しかし、create tableコマンドでField名を日本語で入力したのですが、こちらは正しく表示されて います。 my.iniの内容を変更したりしていますが、状況に変化がありません。 どうすれば、直りますか？ 以下に、show valiablesの結果を記載します。 +--------------------------+------------- | Variable_name | Value | +--------------------------+--------------- | character_set_client | cp932 | | character_set_connection | cp932 | | character_set_database | utf8 | | character_set_filesystem | binary | | character_set_results | cp932 | | character_set_server | utf8 | | character_set_system | utf8 | | character_sets_dir | C:\xampp\mysql\share\charsets\ | +--------------------------+-----------------
PHPで、「htmlタグを含んだ文字」を、 データベースへ読み書きする安全な方法を教えて下さい。 リンクタグや、フォントタグなどは、 そのまま使用できるようにしたいです。 ■追加する時 htmlフォームからデータベースに保存（SQLインジェクション） ■編集する時 データベースからデータを読み出す（htmlエスケープ） htmlフォームで再編集し、データベースに保存（SQLインジェクション） こういう作業になるかと思いますが、 どのように処理したら、htmlタグを使いつつ、 安全に更新ができるでしょうか？ 教えてくださいm(_ _)m
このようなSQL文は危険でしょうか？ $sql = "delete テーブル名 where id = :id"; $stmt = $dbh->prepare($sql); $stmt->execute(array(":id" => $_POST['id'])); 上記の例だと、$_POST['id']は、 ちゃんとエスケープできているのでしょうか？
pl/pgsqlで変数が文字列として扱われてしまうのですがどうすればいいのでしょうか。 具体的には以下のような感じです。 CREATE OR REPLACE FUNCTION test_func() RETURNS VOID AS $$ DECLARE test_val TEXT ; ofs_num INTEGER := 0; lmt_num INTEGER := 0; t_name TEXT := 'schema1.table1'; BEGIN SELECT INTO ret_val * FROM t_name OFFSET ofs_num LIMIT lmt_num; END; $$ LANGUAGE plpgsql; 上記のofs_numやlmt_numは変数として認識してくれるのですが FROMに続く「t_name」が変数ではなくそのままの文字列として認識されてしまいます。 t_nameを変数として認識させる方法はありませんでしょうか。 教えていただけると助かりますm(_)m
一人でアクセスを使っているのですが SQLサーバーに移行するメリットはありますか？ レコード数は５万件くらいです。
MS SQL Server自体が初心者なので、初歩的な質問だと思いますが、 Enterprise Managerを使って、Aというデータベースの「tbl」というテーブルの内容を、「tbl_new」というテーブルに全てコピーするには、どうすればよいのでしょうか？フィールドの内容は同一です。 ちなみに、両方のテーブルにいくつかデータが存在していて、「tbl」が正しいデータになっています。 同じキーがあれば更新して、キーがなければ追加したいのです。 一度テーブルを消して、コピーするなどの方法が依存関係の都合でできないので、データだけ移したいと思っています。 Enterprise Managerのどの機能を使えばよいのかもわからない状態ですが、よろしくお願いします。
SQLServer2008 R2　をメンテナンスプランでバックアップする方法について、ご教授ください。 やりたいこと １）毎日完全バックアップを取得 ２）バックアップはすべて別ファイルにしたい ３）数日後たったバックアップファイルは削除したい ３）については、メンテナンスのクリーンアップタスクでできそうですが、 ２）がどのように設定するのかがよくわかりません。 データベースのバックアップタスク　により、 　(1)バックアップの種類：完全 　(2)データベース：特定のデータベース（とりたいDBを選択） 　(3)バックアップの有効期限（設定しなくてよい？） 　(4)バックアップ先：ディスク 　(5)すべてのデータベースにバクアップファイルを作成する。 　　　にチェックを入れると、勝手にファイル名が日付で作成されるようです。 上記のまま「OK」をすると、デザイン画面には「既存データに追加」と表示されています。 この設定で、毎日別のファイルができるでしょうか。 有効期限を設定しておいたほうがよいのでしょうか。 いろいろ調べてみたのですが、どうもやりたいこととぴったりマッチするものがなく、こちらに質問させていただきました。 有効期限、追加・上書き　あたりの関係がよくわかっておりません。 やってみればいいのですが、あまり時間がなく「数日」の確認を数パターンとることができないので、よろしくお願いします。
始めたばかりの初心者です。 よろしくお願いします。 phpmyadminの事で質問があります。 ◇型の設定で、桁数を決める際にINTで（６）としても 試しに１０桁を入れても（phpmyadminで直接） 入ってしまいます。試しにと思ってINTのところに ”あいうえお”を入れても入ってしまいます。 どういう事でしょうか？ ◇またINTの上限数値って4294967295だとすると 桁数の設定は（10）までは意味があっても、(11)以上に しても意味がないのでしょうか？ ◇INT（１１）に上限数値の4294967295をいれると 何が起こるのですか？ ◇最後にもうひとつ テーブル作成の際にphpmyadminの（sqlタブ）でつくるとき 以下のような記述をするとそのやり方を習ったのですが、 　（サンプル） 　　Name` varchar(32) NOT NULL default '', この記述の意味がイマイチ理解しきれません。 NOT　NULLとは、ヌル値は認めないというのに、 defaultは””（ヌル）で設定ができてしまう。って 矛盾してませんか？それとも私の解釈が間違っていますか？ たくさん質問してしまいましたが、よろしくお願いします。
職場で沢山仕様書を読んで沢山のSQL文を作成するしか方法ないのでしょうか 私の職場はプログラムの修正が多いため新規に仕様書からSQL文を 考える機会が少なく、今あるSQL文に項目を追加するというパターンが おおいです。そのため、複雑な仕様のSQL文を経験する機会が少ないです。 しかも、仕様書を作らずメモ書きや口頭でのプログラム作成が多いため 仕様書がなかったり古かったりで既存のコードからのSQL文の勉強 が難しいです。 皆さんは新人時代どのようにSQL文をマスターしましたか？ 独学方法等を教えてください
プログラマ２年目なのですが仕様書を解読して SQL文を自分一人で作成する事が中々できません 先輩に作ってもらったりヒントをもらったりする事が 多々あります。そのため、先輩に「なんでわからないの」 とあきれ口調で怒られます。 独学しようと思っても本で得られるのは単純なSQL文です 仕様書の文章を何度も何度も読み返しても答えとなるSQL 文が浮かんできません。 質問 １．仕様書の読解方法 ２．独学方法 ３．参考ホームページ ４．仕様を自分で考えて作る時の対象システム ５．SQLのよくある仕様パターン ６．ユニークなSQL文のサンプル ７．仕様プラスSQL解答例が載っているようなホームページOR参考書 上記一つでもいいのでご回答ください。より多くの皆さまからのご回答 をお待ちしております
コミットされるタイミングに関して。。。 ----------------------------------------------------- REDOログバッファがREDOログファイルに書き出されるタイミングは ・コミットした時 ・3秒毎 ・REDOログバッファが3分の1になった時 ・DBWnがデータファイルに書込むとき ------------------------------------------------------- 上記の認識ですが、この中の3秒毎と言うのが理解できません。 こちらで試してみた結果がこちらです。 プロンプト1にて (1)sql接続 (2)name列確認 結果⇒test01 (3)name列更新 結果⇒test02 (4)コミットせずに3秒以上経過。 プロンプト2にて (5)sql接続 (6)name列確認 結果⇒test01 となります。 3秒毎にコミットされていない！！ (4)でコミットをしてやると、(6)での結果はtest02になります。 3秒毎とはどういったことなのでしょうか。 よろしくおねがいいたします。
Accessで音楽CDを管理しております。レコードにはアルバム名やアーティスト、曲名等が入力してあります。フォームでアルバム名のコマンドボタンをクリックしたら、そのアルバムを全曲（アルバム単位で一曲目から最後の曲まで）を再生することはできるでしょうか。 音楽CDはDドライブに取り込んであります。音楽ソフトはWindows Media Prayerです。 よろしくお願い致します。
Access2003で作られたあるアクセスのファイル、・・・・・・・.mdbがあるんですが、 これをAccess2010しか入っていないPCで開こうとすると、 「オブジェクト・・・・・が見つかりませんでした。オブジェクトが存在してあること、名前やパス名が正しいことを確認してください。・・・・・がローカルオブジェクトではない場合は、ネットワークの接続を確認するか、サーバー管理者に問い合わせてください。」 とでて開かれませんでした。どのすれば開かれるのかよろしくお願いします。
重複レコードについて ＡＣＣＥＳＳ２００２での話になります。 テーブルに下記レコードが複数存在します。 （例） フィールド１ フィールド２ フィールド３ 愛知 田中 １２ 愛知 田中 １１ 愛知 田中 １３ 三重 山本 ２３ 三重 山本 ２１ 岐阜 鈴木 ３３ 岐阜 鈴木 ３４ 上記を下記の形で抽出したいと考えております。 フィールド１ フィールド２ フィールド３ 愛知 田中 １２ 三重 山本 ２３ 岐阜 鈴木 ３３ 条件はフィールド１で重複がなくなるように抽出したいです。 フィールド３はどの値を抽出してもかまいません。 DESTINCTでの抽出を考えたのですが、それだと全てのカラムに DESTINCTがかかって希望の抽出が出来ませんでした。 何卒ご教授お願いいたします。
◆やろうとしていること 現在エクセルで管理している40個ほどのドメイン情報を、Webで管理(検索・更新・削除)する簡易システムをデータベースとPHPの勉強をかねて構築しようとしています。 ※環境は、LAMPで構築しようとしております。 ◆知りたいこと ドメイン情報管理テーブルを作ろうとしているのですが、その作成の仕方について、アドバイスしていただけたらと思っています。（正規化の方法？？） ◆疑問点 管理対象のドメイン情報は、重複が多いデータです。 ・同一のネームサーバで複数のドメインを管理している ・同一の業者が複数ドメインのレジストラとなっている ・同一の担当者が複数案件の担当者となっている ・同一IDで複数ドメインの管理を行っている たとえば、次のような感じです。 例） ドメイン名　　　　　　レジストラ　　　　　　ネームサーバ　案件担当者　 ID　　　　　　　　案件情報　　　　　　　　　　　 hoge.com お名前.com 　　　ns.bbb.jp 東京一郎　　a0002　自社ECサイト hoge.jp　 　　お名前.com　　　　　 　ns.bbb.jp　　 東京一郎　　a0002　　自社コーポレイトサイト test.jp さくらインターネット ns.bbb.jp　　 京都一郎　　a0003 あいう社コーポレイトサイト aaa.jp さくらインターネット ns1.bbb.jp　　大阪一郎　　a0004　　かきく社コーポレイトサイト aaa.net ムームードメイン ns1.bbb.jp　　東京一郎　　a0005 さしす社blogサイト bbb.net ムームードメイン ns1.bbb.jp　　東京一郎　　a0005 たちつ社ECサイト　 現在、エクセルで上記のような情報を管理しています。 これを初学者の私なりに正規化してみると ・ドメインリストテーブル（主キーとドメイン名だけが入っているテーブル） ・案件担当者リストテーブル（主キーと案件担当者だけが入っているテーブル） ・レジストラリストテーブル（主キーとレジストラだけが入っているテーブル） ・ネームサーバリストテーブル（主キーとネームサーバだけが入っているテーブル） ・IDリストテーブル（主キーとIDだけが入っているテーブル） ※各テーブルの主キーは、ドメインリストテーブルの主キーを設定 と、知識と経験が無いため、テーブルをいちいち細かくすることしかできないのです。 そこで、このようなデータを管理するテーブルを作る場合の一般的な考え方・注意事項・コツ・ポイントなどを踏まえアドバイスをいただけたらと思い質問いたしました。 具体的に、俺だったら、こういうテーブルに分割してドメイン情報を管理する。その理由は云々、といったかたちでアドバイスいただけますと大変助かります。 よろしくお願いします。
アクセスで大分類・中分類・小分類を作っています。 コンボボックスを連動させて，作成したのですが？ データー入力後，例えば中分類を変更しても，大分類や小分類がそのままで登録されてしまうのです。 それではダメですよね・・・ その部分がデータとしてあっていればいいのですが，違うければ弾いて欲しいやり方を ご教示していただきたいのです。。。 ちなみに！ 大分類に SELECT DISTINCT 配置署所 FROM ボンベ管理クエリ; 中分類に SELECT DISTINCT 署所記号番号 FROM ボンベ管理クエリ WHERE 配置署所=[大分類]; 小分類に SELECT [ボンベID], [容器記号番号] FROM ボンベ管理クエリ WHERE 配置署所=[大分類] AND 署所記号番号=[中分類]; 中分類と小分類には，イベントとして Private Sub 小分類_Enter() Me.小分類.Requery End Sub を書き込んでいます。 　　※ この質問をする場合のカテゴリ選択のようにしたいのです・・・・ ぜひどうかよろしくお願いします。
Excelで作られている社内資産情報の台帳があるのですが、何千行にもなり、 しかもセルにVlookupやINDEX、配列関数等、色々な関数を書かなければならず、 開くのだけで1分くらい、保存するには10分くらいかかってとても使いづらいです。 Accessは使ったことがないですが、Accessでデータベースを設計して作り直した 方がいいのではないかと提言したところ、猛反対にあいました。 Ａｃｃｅｓｓで作ると、本人はできても、周りの人や引き継ぎの人が操作できなくなる、 そのExcelは昔から使われていて、変更すると色々なところに支障が出る、 データベースの設計もしたことないくせに偉そうなこと言うな、等々。 実際に社内でも、一度Ａｃｃｅｓｓで作られたけれど使い勝手が悪く、その後Ｅｘｃｅｌ管理に 戻ってしまった台帳がたくさんあります。 ほとんど使ったことはないのですが、Ａｃｃｅｓｓってそんなに使えないのでしょうか。 できればより使い勝手の良い台帳にしたいと思いますが、Ａｃｃｅｓｓで作り直そうとすれば おそらくはそれなりに時間がかかる作業であり、上司を納得させるのが難しいです。
Visual Studio2010の勉強をし始めました。データソースの変更についてお教え願います。 データソースの変更に、 ■Microsoft SQL Server ■Microsoft SQL Serverデータベースファイル 二つあります。この二つは何が違うのでしょうか？ 説明も書いてありますが、イマイチわかりません。 ネット検索もしましたが、見つけることができませんでした。 平たく、簡単に言うとどういったことでしょうか？ 宜しくお願い致します。
今までXP+AC2003+Outlook2007の組み合わせでACからメールの送信ができたのですが、今回システムを更新したら動かなくなってしまいました。(DoCmd.SendObject) 現在の組み合わせはWin7+AC2010+Outlook2010です。 今まで10種類くらいのメールをバッチ送信していたので、これをマニュアルでそれぞれ送るとなるとかなり手間がかかり困っています。 エラーメッセージは「2293　MS Accessによる電子メールメッセージは送信できません」です。 ネットで調べてみるとエラーコード2293は結構取り上げられていますが、具体的にどこをどうすれば以前のように自動送信ができるようになるのかよくわかりません。 恐れ入りますが、素人の私が設定変更できますようにご教示いただけませんでしょうか？ よろしくkお願いします。
mysqlの危険回避の質問です。 （私がした１つ前に質問したものでは、解決しなかったので再度表現を変えて行います。） mysqlでwhere句の値に 1 OR effective=0 が入ると危険であり、シングルクオテーションで回避できる、とあるサイトでみました。 それを踏まえ、それまで以下の(1)で動いていたものを(2)にしたら、動かなくなりました。 そこで質問です。 （初めてphpに触れた人に教えるレベルで、かなり噛み砕いて教えていただけたら幸いです。） ■(1)はそのままでは危険という認識でよろしいですか？ ■(2)はなぜ動かないのでしょうか？ ■(1)を危険のない（もしくは可能な限り危険のない）書き方をするとしたらどうしたら いいでしょうか？（PDOで書く事！やmysqliがいい、というのは知っています。 どうしてもmysql_real_escape_stringを使わなくてはいけないという条件があったと 想定して強引にやるとしたらどうか、という事でお答えをいただければと思います。） (1) $sql = sprintf("SELECT id , password FROM `adminDatabase` where id = '%s' and password = '%s' order by id", mysql_real_escape_string($id),mysql_real_escape_string($password)); (2) $id = "'" . mysql_real_escape_string($id) . "'"; $password = "'". mysql_real_escape_string($password) . "'"; $sql = sprintf("SELECT id , password FROM `adminDatabase` where id = '%s' and password = '%s' order by id",$id , $password ); よろしくお願いします。
添付画像のようなデータがあって、赤字のところだけ出力したいと 思っています。 グループIDごとに、一番個数が大きいもの（同じ個数の場合、個別IDが 若いもの）を出したいのです。 （順位はグループごとにふられているので、グループごと同じです） 個数が同じデータがあるもので、単純にMAXのものを…とするのも 難しそうで困っています。 ご教授いただけないでしょうか。
お世話になっております。 WEB上で検索すると、select実行時にもロックを取得しcommitもしくはrollbackを実施していることがわかりました。 そのことについて数点疑問を持ち調査したのですが、わかりませんでした。 どなたかわかる方ご教示ください。 (1) select発行時にロックを取得しcommitもしくはrollbackするという認識は正しいでしょうか。 (2) 通常SQLに不備が無ければselectは正常に終了すると思いますが、 rollbackするのはどのような状況でしょうか。 selectのSQLに不備があった場合でしょうか。 (3) コンソールからselectを発行するとcommitせずとも結果が出力されます。 このcommitされるタイミングはいつになるのでしょうか。 (4) WITH URオプションを使用するとロックを取得しないと思いますが、 ロックを取得しないということはcommit/rollbackも実施されないという認識は正しいでしょうか。 (5) commitコマンドを発行するとアクティブログに追記されるという認識なのですが、 WITH URオプションなしでselect文を発行してもアクティブログに追記されるものでしょうか。 それともテーブルの更新など実施しないので、アクティブログは更新されないのでしょうか。 (6) WITH URオプションをつけてSELECTを実施した場合はアクティブログは更新されないでしょうか。 (7) EXPORTコマンドを実行した場合も(5)(6)と同様という認識で正しいでしょうか。 以上になります。 よろしくお願いいたします。
MySQLで、テーブルに書籍名リストが入っているとします。 このとき、列「書名」には、以下のような、書名の後に1から11までの連番がついたデータが順不同で入っています。 国語辞書 1 国語辞書 2 国語辞書 3 ・・・ 国語辞書 11 このテーブルに対して、「ORDER BY 書名 ASC」でSELECTをかけると、 「国語辞書 11」が一番最初に来て、その後１から順番に並びます。 これを自然な並び（１１で始まるのではなく、１～１１の順で整列）にするには、どうしたらよいでしょうか？
環境：Windows 2008 standard edition 64bit Sqldeveloper：sqldeveloper64-3.2.20.09.87-no-jre java：jdk-6u33-windows-x64.exe 今回、Oracleへの接続として、Sqldeveloperを用いて接続しようと考えています。 　※ 厳密には環境の移植（32bit サーバ　⇒　64bit サーバ） その際に、以前の32bit環境では問題なく起動したSqldeveloperが、なぜかこのサーバでは 下記のようなポップアップ表示が出力されてしまいます。 《ポップアップ内容》 　Enter the full pathname for java.exe; その為、java.exe が存在するパスを指定し、OKボタンを押下したところ、今度は以下のような エラー表示となってしまいました。 《エラー内容》 　Cannot find a J2SE SDK installed at path:C:\Program Files\Java\jre6. Sqldeveloperはデスクトップ上から起動させていますが、そもそも64bit版の場合はどこのフォルダへ 格納するのが正しくて、上記のようなエラーを回避する為には何をすれば良いでしょうか？ 初歩的な質問で申し訳ありません。 教えて下さい。
独学数ヶ月の初心者の質問で恐縮です。 もろもろの事情で仕方なくmysql_real_escape_stringを 以下(1)のように使用しなくてはならないと仮定し、 セキュリテイの面で(2)のようにシングルクオテーションつける 事で危険を回避できますか？ またシングルクオテーションは(2)のようにつけてはいけない とかありますか？（記述の基本が曖昧なため、ただの確認の質問） (1) $sql = sprintf("SELECT id , password FROM `adminDatabase` where id = '%s' and password = '%s' order by id", mysql_real_escape_string($id), mysql_real_escape_string($password)); (2) $sql = sprintf("SELECT id , password FROM `adminDatabase` where id = '%s' and password = '%s' order by id", ’mysql_real_escape_string($id)’, ’mysql_real_escape_string($password)’); よろしくお願いします。
ファイルメーカPro(Ver11)で集計の方法がわかりません。 テーブル「商品」に フィールド「商品番号」「色」「パーツ１」「パーツ２」「パーツ３」「完成」（完成か未完かのラジオボタン）があります。 これを他の閲覧専門のページに 「商品番号」「色」毎に「パーツ１」「パーツ２」「パーツ３」の集計を一覧表示したいのです、できれば「完成」の有無で上記条件に加えて未完のものだけを表示という形にしたいですがうまくいきません。 レポート機能の集計で表示はできたのですが「商品番号」別での集計か「色」別での集計しかできませんでした。 具体的にいうとGetSummary ( パーツ１合計 ; 商品番号 )だと商品番号別の合計しか出せない、 やりたいことは大分類（商品番号）、小分類（色）別（商品番号が同じで尚且つ色別に合計を出す）に合計値を出したいので。 GetSummary ( パーツ１合計 ; 商品番号;色 )とできればいいのですが無理でした。 以上わかる方が居りましたらよろしくお願いいたします。
baunceです。 とくに困っているわけではないのですが、ずっと気になって いたのでここで質問させていただきます。 テーブルサイズを求める際に、USER_SEGMENTを参照して求めて いる方があります。 この際、GROUP BY SEGMENT_NAME と記載されている方が多いのですが、これは必要なのでしょうか。 USER_SEGMENTはSEGMENT_NAMEでユニークにはならないのでしょうか。 ちなみに私が携わっている環境ではGROUP BY してもしなくても 同じ結果となるようです。 以上よろしくお願いします。
---------------------------------------- テーブルＡの カラム１、カラム２のデータが １０、作業Ａ ２０、作業Ｂ ３０、作業Ｃ ---------------------------------------- テーブルＢの カラム１、カラム２のデータが １０、2013/1/1 １０、2013/2/1 ２０、1999/1/1 ２０、1999/2/1 ---------------------------------------- のようなデータがあります テーブルＡ、テーブルＢのカラム１はリレーションです この２のテーブルから、テーブルＢの最新日付の カラム１のグループ毎に選択するＳＱＬを教えて下さい ---------------------------------------- 結果 １０、作業Ａ、2013/2/1 ２０、作業Ｂ、1999/2/1 ---------------------------------------- select テーブルＡ.カラム１,テーブルＡ.カラム２,テーブルＢ.カラム２ で、条件をどうしたら、テーブルＢの最新日付を取り出せますか
php初心者です。独学で現在勉強していますが、環境に 関する本当に基本的な事がぜんぜん理解できていない事に 気づきました。 質問をする上でちょって変な表現をしてしまうかもしれませんが お許しいただき、また子供に教えるように噛み砕いてお答え いただければ幸いです。 質問 ■mysql mysqlそのものがいったいなんだかがよくわかりません。 （はじめは、htmlやJavaなどコンピューター言語の１つ なのかと思っていました。） ・mysqlとはDBのシステムの１つと考え、それはパソコンで いうところのOSみたいな通常はあまり意識する事が ない存在という事なのでしょうか？ ・lolipop（サーバー）を利用しているのですが、通常は mysqlというものをインストールしないと動かないものが はじめから用意されているからmysqlを意識せずにいられる のでしょうか？ ■mysqlが非推奨？？ ネットであれこれ情報を集めていたら、mysqlが今後非推奨に なるのか？mysqlの関数が非推奨になるだの、PDOやらmysqli がいいだのとありましたが、まだ全体の知識が浅いため いっている内容がさっぱり理解できません。 ・もしphpのバージョンによりmysqlを使えないと仮定した場合 サーバー上ではどんな設定が必要で、ソースの書き方はどうなって しまうのでしょうか？ （自分の理解） (1)サーバーにmysqli（これってシステム？言語？なのかすらよく 理解できていません）をインストール (2)phpでデーターを呼び出す時は、mysqliの記述の仕方で呼び出す ■これからどういう順序で何を勉強したら良い。 時間とお金がないので可能な限り効率的な順序で勉強をしたいのですが、 これからPHPとDBを扱うには何をどういう順番で勉強すると いいのでしょうか？また他にアドバイスがあればよろしくお願いします。 （クラスだの、オブジェクト指向だのが全くわかりません、またフレーム ワーク、その他難しいことは、基礎を覚えた後にやらないと結局痛い目に あうものでしょうか？などなどに対するアドバイス等） 長々となってしまいましたが、頭が混乱しているので、 頭の中の整理をお付き合いいただける方、よろしくお願いします。
当方、初心者です。 訳あって、古いバージョンのMySQLをインストールすることになりました。 MySQLのサイトからバージョンが5.1.68の mysql-server mysql-client mysql-devel mysql-shared をダウンロードして、 #rpm -ivh mysql-server-5.1.68-1.glibc23.x86_64.rpm #rpm -ivh mysql-client-5.1.68-1.glibc23.x86_64.rpm #rpm -ivh mysql-devel-5.1.68-1.glibc23.x86_64.rpm #rpm -ivh mysql-shared-5.1.68-1.glibc23.x86_64.rpm とコマンドをうちました。 それぞれ100％となり、エラーメッセージは出ませんでした。 その後 #rpm -qa │ grep mysql と打っても何も表示されませんでした。 /etc/init.d/にmysqlはありますが、mysqldはありません。 mysql startとうつとOKと表示され showdatabaseもできました。 これでインストールは完了しているのでしょうか？ OSはCentOS5.9です。 構成管理のパッケージソフトをインストールするために 前提としてMySQLが必要と記載されていたのみなので どのMySQLをインストールすれば良いかもわかりません。 心優しい方のアドバイスをお待ちしております。
形がどのようなもので、利点がなんなのかまったくわかりません よろしくおねがいします
fleuentd経由のデータをmongodbへinsertしてるのですが、 転送されたデータ件数とmongodbへinsertされている件数 が一致せず、困っております。 各ログファイルにも目立ったエラーは、出力されてませんでした。 環境ですが、2サーバ共に、 OS:CentOS5.5_64 fluentd 0.10.30 fluent-plugin-mongo (0.6.13, 0.6.11) MongoDB shell version: 2.2.2 データの流れですが、 webサーバ→logサーバ→mongodb ※Logサーバとmongodbは、同じサーバです。 webサーバ→logサーバは、問題無く全データ転送されます。 　logサーバ→mongodbは、数件差分が発生します(mongodbが数件足らない)。 各設定以下になります。 【webサーバ td-agent.conf】 /////////////////////////////////////////// <source> type tail path 省略/test.log format 省略 tag test.test pos_file /var/log/td-agent/tmp/test.log.pos </source> <match test.*> type forward buffer_chunk_limit 10m flush_interval 10s send_timeout 5s recover_wait 5s retry_limit 5 <server> host 省略 </server> </match> /////////////////////////////////////////// 【logサーバ td-agent.conf】 /////////////////////////////////////////// <source> type forward </source> <match test.test> type copy <store> type mongo database hogehoge collection test buffer_type memory buffer_chunk_limit 10m buffer_queue_limit 1280 flush_interval 1s retry_limit 10 retry_wait 5s </store> <store> type file path /var/log/td-agent/test buffer_chunk_limit 1g </store> </match> /////////////////////////////////////////// 【webサーバ mongod.conf】 /////////////////////////////////////////// # mongo.conf #where to log logpath=/var/log/mongo/mongod.log logappend=true # fork and run in background fork = true #port = 27017 dbpath=/var/lib/mongo # location of pidfile pidfilepath = /var/run/mongodb/mongod.pid # Turn on/off security. Off is currently the default #noauth = true auth = true /////////////////////////////////////////// どうぞ、ご教示お願いいたします。
文字コードについて教えてください よろしくおねがいします！！！
はじめまして AccessのVBAで製品版とランタイム版の識別判断したいのですが、どうすればいいかわかりません。 わかる方いましたら宜しくお願いします。
VB.netからプロシージャーを呼び出してます。 SQLで、inの中などで、動的にパラメータを与えたいです。 Select * from TableX where koumoku1 in (1,2,3,5,10) 例えば上の1,2,3,5,10 をパラメータとして外部から与えたいのですが、 プロシージャー側の実装としては、どのような方法があるのでしょうか？ パラメータの与え方は、 x = "1,2,3,5,10" のように1つの文字列でも良いし x[0]=1,x[1]=2,x[2]=3,x[3]=5,x[4]=10 のように配列みたいな形でも良いです。 よろしくお願い致します。
Oracleで以下のデータから１）、２）の条件でコードをselectしてくるには どのようなSQL文を書けばよいでしょうか。 [DATA] code　date　status　 0001　3-15　A 0001　3-15　B 0001　3-15　C 0002　3-15　A 0002　3-15　B 0003　3-15　B 0004　3-15　A 0005　3-15　C １）3-15においてstatusがAとBを持つcodeを返したい 　→0001,0002が返ってきてほしい ２）3-15においてstatusにCを持つがそれ以外（A,B）は持たないcodeを返したい 　→0005が返ってきてほしい 単純なものなのかもしれませんが、 どうか、お力添えのほど、よろしくお願いいたします。
Access2007です。 よろしくお願いします。 下記のようなレコードが複数あります。 予定日　　　　コード　　　　氏名　　　　開始時間　　　　終了時間 2013/03/01　　1111　　　　AAA　　　　09:00　　　　　　 10:00 2013/03/01　　1111　　　　AAA　　　　13:00　　　　　　 14:00 2013/03/01　　1111　　　　AAA　　　　08:40　　　　　　 09:00 上記以外にも複数日、複数人います。時間は08:40から18:00までの間で存在します。 ほしい結果は、2013/03/01のAAAの空き時間です。 何時から何時まであいていて、その時間は何分です、というような答えが欲しいのです。 その際、12:00から13:00の時間は除きます。 基本VBAを使用して作成しています。 何らかのヒントでもいただければと思います。よろしくお願いします。
マイクロソフトのaccess2010について質問です。 親フォームに社員番号を検索するコンボボックスがあります。 サブフォームに社員一覧があります。 名前　→　SF1 ソースオブジェクト　→　クエリ．社員一覧 検索に一致する社員番号のレコードに移動するために このようにしました。 －－－－－－－－－ Num = Me.検索社員番号 Me.SF1.SetFocus Me.Recordset.FindFirst "[社員番号]=" & Num －－－－－－－－－ しかし 実行時エラー'3070'　'社員番号'を有効なフィールド名、または式として認識できません。 というエラーが出てしまいます ご教授頂ければ嬉しいです
サーバのSqlServerのデータをCSVにエクスポートしたいのですが、うまくいきません。 管理者権限だと動きますが、一般ユーザーでEXEC xp_cmdshell"bcp・・・"だとセキュリティでひっかかり動作しません、セキュリティの設定に関する資料も少なく、どなたかご教授願えませんか。 またほかの方法でもいいんです、クライアントはC#とVBのみです。sqlcmdやbcpなどは一切ありません。ですので、すべてをできればサーバ側で行いたいのです。お願いします。
いま、英字新聞で、『ウィキペディア』に関する記事を読んでいます。 その中で、「ウィキペディアを編集するためには、ウィキシンタックス(wiki syntax） を学ばなければならない。」とあるのですが、ウィキシンタックスとは、何ですか。 また、日本語に訳したら、何て言うのでしょうか。（「ウィキシンタックス」でいいのでしょうか。） どなたか、教えてください。
お世話になっております。 ACCESSレポートのグループ改ページについて、下記サイトを参考に設定したのですが、グループ化し改ページはされるのですが、NO(ナンバー)がばらばらになってしまいます。昇順のままに改ページしたいのですが、どうすれば、昇順のまま表示されるか、なぜそうなるのか等分かる方よろしくお願いいたします。(下に簡易化した例を載せておきます、実際はカラム名(表題)は複数あり、行数も多いです。) 参考サイト：http://www.sanryu.net/acc/tips/tips219.htm (元のデータ) NO.　　グループ1　　←表題　 -------------- 1　　　　　あ 2　　　　　い 3　　　　　あ 4　　　　　う 5　　　　　い (出力したい結果1) NO.　　グループ -------------- 1　　　　　あ 3　　　　　あ (出力したい結果2) NO.　　グループ -------------- 2　　　　　い 5　　　　　い 　　　　・ 　　　　・ 　　　　・
Excelで、次のチェックをする方法を教えてください。 あるコード（英数字混在、２０桁）に対して必ず1111が紐づいていないといけないのですが、その２０桁のコードは一意でなく、1111以外にも2222、3333などが紐づいていることもあります。複数の場合、特に何件存在するかは決まっていません（1111、2222は全部で１００種類ほど）。1111が付いていないコードを洗い出したいのですが、どのようにしたらよいでしょうか。
初歩的な質問ですみません。 教えて頂けますでしょうか。 データベースでビューテーブルというものがありますが、 登録データが実テーブルではなく、ビューテーブルの方で保存（保持）されているということはあるのでしょうか？ テーブルのデータとデータベースの構造調査をしなければならないのですが、 実テーブルのみ調査をすれば良いのでしょうか？ ビューテーブルにもデータがありました。 宜しくお願い致します。
共有フォルダーにAccessのファイルがあり、1つのパソコンでAccessのファイルを開いている時、別のパソコンで同じAccessのファイルを開こうとすると、ウィンドウが立ち上がらないのですが、どういったことが考えられますか？ また、2つのパソコンで同じAccessのファイルを開いて編集するにはどのようにしたらよいでしょうか？
使用しているウォークマンに曲を入れようとしたら、容量が一杯だったので、整理しようと全削除しました。 必要な曲のみ転送しようとしたら、複数、転送できないものがありました。 ライブラリ上には曲名があります。でも再生ができませんでした。 もう一度転送しようとしたら、ファイルがありませんとエラーが出ました。 こういった事ありますか？ 私は初めての体験です。 曲は聴けるようになりますか？また、戻す方法はありますか？ ＰＣに詳しい方、このような体験をした方、アドバイスしてください！！ よろしくお願いします！！(;_;)
皆様、お知恵を拝借させてください。 現在、SQLServer + VB.netで開発を行っていますが、どうしてもうまくいかないので悩んでいます。 ロジックを組めば解決できるのは、わかっているのですが、SQL文だけで解決したいのです。 よろしくお願いします。 やりたいことは、複数テーブルからの同一IDの抽出です。 IDで単一化 テーブル【現在】を優先して抽出 テーブル【履歴】のみ存在する場合、履歴NOの大きい方を抽出 テーブル【現在】 　ID　名前　趣味 ------------------ 　10　太郎　釣り 　20　次郎　ゴルフ テーブル【履歴】 　ID　名前　趣味　履歴NO ------------------------- 　10　太郎　将棋　01 　10　太郎　囲碁　02 　30　花子　園芸　01 　30　花子　料理　02 求めたい結果は 10　太郎　釣り 20　次郎　ゴルフ 30　花子　料理 です。よろしくお願いします。
Oracle instantclient を利用し、 Windows64bit版oracleDB１１ｇR2ドライバを入れましたが cse接続がうまく出来ません。 確認した症状としては、以下のものがあります。 (1)システムDSN追加したデータソースの表示がされません。 　ユーザーDSNに追加した場合はcseで表示がされますが、 (2)ユーザーDSNで追加したデータソースを利用し接続を試みるとエラーとなります。 (1)については、 管理ツールのODBCデータ・ソースアドミニストレータにユーザDSNを追加した場合は、SysWOW64\odbcad32.exeの方にも自動的に追加され、cseのデータソースにはこちら だけ出てきているのは、この32bitの方を見ているせいではないかと思います。。 ちなみにドライバをインストールした直後はODBCデータ・ソースアドミニストレータに システムDSNの追加すらできず（14001エラー表示）、こちらは以下の処理で可能になりました。 mfc71.dll　msvcp71.dll　msvcr71.dll をsyetem32に追加 C++サービスパックedistributable Packageをインストール 似たような症状の記事もありましたが、 当方、初心者なもので、改めて質問させて頂きました。 業務上、どうしてもinstantclientを利用しDB接続する必要があり、 アドバイスがあれば、ご教授よろしくお願いします。
２つの日付を与えてその２つの日付の間の日付を以下のような表形式で返すSQL文を作りたい。 可能でしょうか？ 例えば、与える日付を以下の２つとして、 2012/01/05,2012/01/11 SQL文の実行結果は、 カラム名 2012/01/05 2012/01/06 2012/01/07 2012/01/08 2012/01/09 2012/01/10 2012/01/11 今回の例では、2012/01/05～2012/01/11までの7日間なので7件が返された。
あるテーブルのデータをダンプしてエクスポート(export_utf8.sql)しました。 それを他のMysqlへインポートしようと以下のコマンドを実行したところ、 mysql -p --default-character-set=utf8 db < export_utf8.sql 以下のエラーが出力されました。 Unknown MySQL server host 'border="1"' (1) おそらく、エスケープ関連でコケているものかと思いますが、 どうすればインポートできるのかわかりません。 ご存知の方、宜しくお願いします。
UNIONする際、片方のテーブルしかないカラムも利用したいのですが、どうすればよいでしょうか？ ■現状 SELECT tablename, id, level 　FROM ( 　　SELECT \'A\' tablename, s.id, s.level FROM A s 　　　UNION ALL 　　SELECT \'B\' tablename, r.group_id, r.level FROM B r 　) as UNI ■やりたいこと ・テーブルAにしかないカラム「age」も一緒にSELECTしたいのですが、どうすれば良いでしょうか？ ・UNIONしたいわけではなく、UNIONした後のレコード同様、「age」カラムもSELECTしたい、という意味です ・UNIONの外側で何かやればいいのかな、と思い試したのですが、うまくいきませんでした
いつも楽しく勉強させていただいております。 環境はWin7、Office2007、MySQL5.5.28です。 データはMySQL上にあり、それを集計した結果をExcelまたはcsv形式で取り出すプログラムを開発中です。 集計の表側（ブレークダウン）や絞込みの条件は可変なので、AccessでMySQLに渡すコマンドを編集し、テキストファイルとして出力します。 このテキストファイルを実行するのに目下のところ次の二通りで行っています。 １．MySQLのクライアント画面から下記のように実行 source C:\Users\meglin\Documents\サマリー.sql ２．コマンドプロンプト画面から下記のように実行 "C:\Program Files\MySQL\MySQL Server 5.5\bin\mysql" -u root -D meglindb -proot < C:\Users\meglin\Documents\サマリー.sql どちらの方法でも快適に動きます。 近々そのプログラムを運用ベースに乗せたいのですが、オペレーションをする上司が「あの黒い画面（MySQLのクライアント画面/コマンドプロンプト画面）を触るのがコワイ。すべてAccessから対応できないか」と言います。 要するに上記コマンドのサマリー.sqlをAccessの中から起動したいのです。 できますでしょうか。 おそらくShell関数を使うのだと思って下記のように書いてみたのですが、うまく動いてくれません。 Shell("""C:\Program Files\MySQL\MySQL Server 5.5\bin\mysql"" -u root -D meglindb -proot < C:\Users\meglin\Documents\サマリー.sql") どうしたらいいでしょうか。 最初はAccessからMySQLにODBC接続とADOで１行ずつ実行してみたのですが、集計の列と行が多いので処理時間がかかり実用的ではありません。
恐れ入ります。 Mysql をつかって、2つのテーブル（同一並びのカラム）の、各々のレコードを足したいのですが、 どのようにしたらよろしいでしょうか。 table1 ------------ col1|col2|col3 20 |30 |40 40 |40 |50 10 |20 |20 ------------ table2 ------------ col1|col2|col3 10 |10 |20 20 |20 |20 10 |20 |20 ------------ 処理後 ------------ col1|col2|col3 30 |40 |60 60 |60 |70 20 |40 |40 ------------ のようにしたいです。よろしくお願いします。
先日下記の質問をさせて頂きました。 http://oshiete.goo.ne.jp/qa/7952942.html 色々試しました。 Office2010が入っているWin7　Pro、でAdminユーザーを2つ作り（AとB)試しました。 AではAccessのレスポンス、動きが遅く、Bでは問題ないスピードで動きました。 友人がVBA7.0が怪しいと言ってくれたため、確認していくとレジストリHKey_CURRENT_User\Software\Microsoft\VBA\7.0\Commonのキーが違います。CltShowSelect, Dock, DsnShowSelected, FolderView, MainWindow, MdiMaximized, OBGroupMem.., PropertiesWind.., Tool, UIAccessだけのものの動きは非常に遅い（A)。 上記にAlignToGrid, AutoQuickTip2, AutoStatement2, AutoValueTips2, BackGroundCompile, backGraundProjectLoad, CollapseWindow, CompileOnDemand, DragDropInEditor, EndProcLine, FontCharSet, FontFace, FontHeight, GridHeight, GridWidth, RequireDeclaration, SaveBeforeRun, ShowGrid, ShowToolTips, UpgradeVBX（添付データ参照）が入っているものは問題なく動きます（B)。 いくつもAdminユーザーを作って試しましたが、動くものと動かないものができます。動かないもののレジストリキーを消して動かしていると再びCltShowSelect, Dock, DsnShowSelected, FolderView, MainWindow, MdiMaximized, OBGroupMem.., PropertiesWind.., Tool, UIAccessだけのものになり、動いたものは消しても元にもどります。 同じPCをですので入っているソフトウェアは同じです。なぜこのような事が起きるのでしょうか。どなたが経験者はいらっしゃいませんか。また動くレジストリに変更出来る方法はありますでしょうか。
こんにちは。「文」や「式」や「句」の違いがよくわからなかったので、調べたら文と式はわかりました。 文はそれ単独で完結する言語要素 式はそれ単独では基本的に完結せず、文または式の一部として使用される言語要素です。 式の最大の特徴として、値を返すという点が挙げられます（文は値を返しません）。 定数式はその値そのものを返します。 条件式は真偽値(True/False)を返す式です。 ただ、「句」がどういったものかがわかりません。Order By句とか色々ありOrder Byが何を意味しているのか理解はできますが、「句」ということがばひっかかります。 ひらたくいうと、どういったことでしょうか？
英語の都市と国名称を日本語に変換する為に、 利用できる無料のデータベースを探していますが、 どなたかご存じの方はいらっしゃいますでしょうか？ 無料で利用できるデータベースがあれば、 スクリプトを書いて、自動翻訳を行いたいのですが、 なかなか見つかりません。 GPSを都市名に変更するものなどはあったのですが。。。 http://ktailab.net/APIs/sekai/index_e.html ご教授いただけますと非常に助かります。 宜しくお願いします！
http://oshiete.goo.ne.jp/qa/7944235.html の件に引き続きどうSQL文を書いてよいかわからず困っています。 create table team(team_id int not null primary key,team_name varchar(30),year int(4), leagueid int(32) ); insert into team values(1,"A",2012,1),(2,"B",2012,1),(3,"C",2012,1),(4,"D",2012,1),(5,"A",2012,2),(6,"B",2012,2),(7,"C",2012,2),(8,"D",2012,2),(9,"A",2011,1),(10,"B",2011,1),(11,"C",2011,1),(12,"D",2011,1); create table taisen(id int not null primary key auto_increment,hometeam int,homepoint int,awayteam int,awaypoint int); insert into taisen (hometeam,homepoint,awayteam,awaypoint) values(1,3,2,2),(3,1,4,0),(1,0,3,2),(2,2,4,2),(1,1,4,2),(2,0,3,0),(2,1,1,2),(4,1,3,3),(3,5,1,2),(5,3,6,3),(5,1,7,1),(7,1,8,1),(9,1,10,1),(11,1,12,3); とあり、 taisen.hometeamとteam.idとtaisen.awayteamとteam.idを結合し、taisenテーブルにteamのyear、leagueid、team_nameが表示されればと思っています。 通常のjoinであればできるのですが、どのようにsql文をかけばよいのかわからず困っています。 taisen.hometeamとteam.idとtaisen.awayteamとteam.idを結合したときに | taisen.hometeam | ホームチーム名 | taisen.homepoint | taisen.awayteam | アウェイチーム名 | taisen.awaypoint | team.year | team.leagueid で結果がとれるようにしたいのですが、どのようにしたらよろしいでしょうか？
一人で、初めてAccessに取り組んでいます。 相談できる人が周りに居ないので、助けてください。 ２つのテーブルがあります。 テーブルデータA 　　　ヘッダーID（オート） 　　　グループ名 　　　区分 　　　文書名 テーブルデータB 　　　区分ID（オート） 　　　区分インデックス 　　　部品名 テーブルデータA”区分”と、テーブルデータB”区分インデックス”が、リレーションシップで繋がっています。 テーブルデータAを、”区分”の昇順で並び替えをして、フォーム上で表示させたいのですが、 フォーム上で表示させる以前に、データシートビューで確認するも、並び替えが出来ません。 テーブルデータBをデータシートビューで表示すれば、”区分インデックス”順に並ぶのですが、 テーブルデータAをデータシートビューで表示すると、昇順も降順も変化なく、”区分”で並び替えができません。（バラバラの状態です） ちなみに、”区分”及び”区分インデックス”は、テキスト型１２桁です。 リレーションシップが付いてる項目は、並び替えができないのでしょうか？
phpmyadmin上の異なるデータベース間のテーブルでリレーションをかけたいのですが、うまくいきません。 new_linkフラグをtrueにすることで異なるデータベースを開くところまではできました。 アドバイスいただけないでしょうか。 ※DB1の中にtable1が、DB2の中にtable2がある //失敗する $con1 = mysql_connect("localhost",username,pass); mysql_select_db('DB1',$con1); $con2 = mysql_connect("localhost",username,pass,true); mysql_select_db('DB2',$con2); $sql = "select * from table1,table2 where table1.id = table2.id"; $result = mysql_query($sql) or die(mysql_error()); メッセージ⇒Table 'DB2.table1' doesn't exist //これは成功する $con1 = mysql_connect("localhost",username,pass); mysql_select_db('DB1',$con1); $con2 = mysql_connect("localhost",username,pass,true); mysql_select_db('DB2',$con2); $sql1 = "select * from table1"; $result1 = mysql_query($sql,$con1) or die(mysql_error()); $sql2 = "select * from table2"; $result2 = mysql_query($sql2,$con2) or die(mysql_error());
タイトルが意味不明ですみません 実現したいことはちょっと複雑なのですが 1．表面テーブル(view?）は1つのテーブルであり、そこにSELECTやINSERT、UPDATE、DELETEを発行。 2．裏は更新系テーブルと参照系テーブルに分かれている。 【更新】表系テーブル（view可）に発行した更新系コマンドで更新系テーブルを更新し、トリガー等でリアルタイムに参照系テーブルに反映。 【参照】表系テーブルにたいして発行したSELECT文は参照系テーブルをみる。 条件として入り口を分けることはできません。
Accessの表示・非表示設定について教えて下さい。 現在取引先名簿を作成しています。 名簿上で常に非表示にしたい企業があるのですが、 例えば、チェックボックスにチェックするとレコードに表示されないような仕組みが欲しいと 考えております。 どのようにすれば良いのでしょうか 補足としてテーブルからリスト（行）を削除しない方法が望ましいです。 また、データを開いた時点で反映されている方法が望ましいです。（フィルタで一時的ではなく） 以上、よろしくお願い致します
MySQLにフォームでインサートすることに悩んでいます。 INSERT INTO table (id,date) VALUES ('1234',CURDATE()) とするとmySQLにユーザーIDと本日の日付を入力できます。 これをフォームから下記の形で入力しようとすると、日付が入力されず、0000-00-00 になってしまいます。 <form action ="insert.php"> <input type="hidden" name="id" value='1234' > <input type="hidden" name="date" value="<?php print(CURDATE()); ?>" > <input type="button" value="submit" name="入力"> </form> value=""の中で本日の日付を指定する場合はどうすればいいかをご教示願います。
アクセスの帳票フォームで入力用チェックボックスが84個（ｃｋ1からck84）あります。表示データは10個程度ですが、このチェックマークの更新前処理で、同じ場所へのダブリが発生しないような処理をしています。フォームフッターにテキストボックスを84個配し（Text1～Text84）、Text1はCk1の合計を、Text2はCk2の合計を出すようにしておき、CK1の更新前処理に Select Case Me![Text1] Case "" If (Me![ck1]) = -1 Then MsgBox "Please wait" Cancel = True Me.Undo End If Case "-1" If (Me![ck1]) = -1 Then MsgBox "Already used." Cancel = True Me.Undo End If End Select またチェックマークを入れることにより、計算処理をして結果をチェックボックスの下に表示しているためme.Refreshを更新後処理に入れております。アクセス2003＋Office2003SP3では問題なく動きますが、アクセス2003＋Office2003SP1、アクセス2010+Office2010SP1では次のチェックボックスにチェックを入れるのに5～6秒程掛かります。（アクセス2003+OfficeSP3ではチェックマークをつけて次のチェックマークを付けるのに待ち時間はありません。）したがって使い物になりません。何か考えられることはありますでしょうか。
Visual Studio 2010(c#) ASP.netでWeb開発をしており、 Oracle 10g(10.1.0)　Clientを使用してDBサーバーに接続しています。 「DLL 'OraOps10.dll' を読み込めません: アクセスが拒否されました。」というエラーが出て接続できなかったため、 ネットで解決策を探したところ、ASP.NETの権限を与えたら上手くいくとのことで権限を 与えたところ、下記のエラーが出ました。 「DLL 'OraOps10.dll' の 'GetRegTraceInfo' というエントリ ポイントが見つかりません。」 解決方法をご存じの方、ご教授ください。
レンタルビデオ店や図書館で指定日範囲内の、貸出本数の合計の最大値を取得したいです。 ※○月は○日が貸出ている本数が一番多かった… テーブル上では８桁の日付と貸出本数を持っています。 例えば、下記データがテーブルに登録されている場合に、 where文で'20130101'～'20130131'と期間を指定すると'13'が抽出されます。 １月４日が１３本貸出中で、指定期間内で一番貸出本数が多いからです。 貸出日/返却日/本数 ------------------------------------------ 20130101/20130104/4 20130102/20130105/6 20130104/20130108/3 20130106/20130109/8 20130110/20130114/5 ------------------------------------------ 調べてみたのですが、指定日の最大値取得は見つかりましたが、指定期間での抽出方法がわかりませんでした。 使用環境はSQLServerです。 ご協力、お願致します。
はじめまして。 次のような通話履歴テーブルから利用頻度の高い電話番号順に ソートして全件を抽出してきたいのですが、よいアイデアが浮かびません。 わかる方がいらっしゃいましたら、お知恵を貸してください。 id　　電話番号　更新日時　　 --------------------------- 01　　1111　　　2013/02/17　 02　　2222　　　2013/02/17　 03　　3333　　　2013/02/17　 04　　2222　　　2013/02/16　 05　　3333　　　2013/02/16　 06　　2222　　　2013/02/10　 上記のようなテーブルから以下のように抽出しようと考えております。 id　　電話番号　更新日時　　 --------------------------- 02　　2222　　　2013/02/17　 04　　2222　　　2013/02/16　 06　　2222　　　2013/02/10　 03　　3333　　　2013/02/17　 05　　3333　　　2013/02/16　 01　　1111　　　2013/02/17　 以上、よろしくお願いいたします。
order byで複数カラム指定(?)したいのですが、どうすればよいでしょうか？ 具体的には、カラムが空の場合は別カラム指定したいのですが、可能でしょうか？ ■前提 ・titleカラム、yomiカラム ■最終的にやりたいこと ・titleカラムを五十音で並べ替えたい ■運用例(案) ・titleカラムが「漢字」の場合は、yomiカラムにひらがな、を入力 ・titleカラムが「ひらがな」の場合は、yomiカラムは空 ・titleカラムが「英字」の場合は、yomiカラムは空 ・titleカラムが「先頭数語がひらがなもしくは英字で、最後が漢字」の場合は、yomiカラムは空？ ■分からないこと ・漢字対策として、「yomiカラム」作成したけど、すべてのレコードに対して、「yomiカラム」を埋める必要があるでしょうか？ ・「ひらがなだけ」、「英字だけ」、あるいは、「先頭数語が英字で最後の方だけ漢字」なタイトルは、わざわざ「yomiカラム」を埋めなくてもよい？ ■知りたいこと ・全ての「yomiカラム」を埋めなくても、「titleカラム」を五十音で並べ替える方法があれば、教えてください ※件数が多くてちょっと面倒なため、何かいい方法があればと思い、質問しました。「yomiカラム」全部埋めた方がいい、のであれば、その方向で検討しようと思います
現在 パスワードが設定されたAccessファイル(accdb形式)のデータをExcelに取り込むプログラムを作成しています． 接続時のプログラムは以下のように記述しました． Dim cn As New ADODB.Connection Dim cnStr As String, dbDir As String, Pswd As String dbDir = "c:\test\test.accdb" Pswd = "pass" cnStr = "Provider=Microsoft.ACE.OLEDB.12.0;" & _ "Data Source=" & dbDir & ";" & _ "Jet OLEDB:Database Password=" & Pswd & ";" cn.Open cnStr 上記でexcel2003及び2007からaccdbに接続したところ問題なくデータ取得できました． excel2010で上記プログラムを実行すると 「パスワードが正しくありません」 と表示され，データが取得できません． このような場合，どうすれば解決出来るでしょうか?
Excel　VBAで　アンケート集計をしたいと思い、プログラムを作ったのですが、J列までは入力がうまくいくのですが、K列にデータを入れて次の行にデータを入れると　もともと存在していたＫれつのデータが消えてしまします。 どう修正すれば　ちゃんとデータが残ってくれるのでしょうか？ 　誰か教えてください Option Explicit Private Sub UserForm_Initialize() Dim チェックボックス As Control With cboBlood .AddItem "A型" .AddItem "B型" .AddItem "O型" .AddItem "AB型" End With cboBlood.ListIndex = -1 txtNo.Value = WorksheetFunction.Max( _ [Database].Resize(, 1)) + 1 txtNo.Enabled = False txtName.Text = "" optMale.Value = True txtAge.Value = 0 For Each チェックボックス In fraOS.Controls チェックボックス.Value = False Next txtName.SetFocus End Sub Private Sub cmdEntry_Click() Dim 行 As Long Dim 確認 As Integer 確認 = MsgBox("データを登録します。" _ & "よろしいですか?", vbYesNo) If 確認 <> vbYes Then Exit Sub 行 = [Database].Rows.Count + 1 [Database].Cells(行 - 1, 1).EntireRow.Insert [Database].Offset(行 - 1).Resize(1).Copy _ [Database].Cells(行 - 1, 1) [Database].Offset(行 - 1).Resize(1).ClearContents [Database].Cells(行, 1) = txtNo.Value [Database].Cells(行, 2) = txtName.Text If optMale.Value = True Then [Database].Cells(行, 3) = "男性" Else [Database].Cells(行, 3) = "女性" End If [Database].Cells(行, 4) = cboBlood.Text [Database].Cells(行, 5) = txtAge.Value If chkWin.Value = True Then _ [Database].Cells(行, 6) = "○" If chkMac.Value = True Then _ [Database].Cells(行, 7) = "○" If chkLinux.Value = True Then _ [Database].Cells(行, 8) = "○" If chkOther.Value = True Then _ [Database].Cells(行, 9) = "○" If chkOther.Value = True Then _ [Database].Cells(行, 10) = "○" Unload frmNew End Sub Private Sub cmdCancel_Click() Unload frmNew End Sub
顧客データベースを作成して、顧客情報の検索をかけたいと考えています。 ACCESS上のフォームにて、検索ボタンをクリックして検索条件を入力し、 該当条件のみを「フォーム」の形で表示することはできるのでしょうか？ 具体的な運用方法としては、顧客の住所から、たとえば「マンション名」を検索して、 該当マンション名の物件のみを表示したいと考えています。 ワークシート形式ではなく、フォームの形で出来るようにしたいです。 クエリーではできますが、PC苦手な事務の方に使っていただくので、 計算式を覚えてもらったり、ACCESSの使用方法を学んでもらうのには非効率だと考えました。 多少のプログラミングによって、可能であるのであれば、ぜひ挑戦してみたいと思います。 より速く簡単に検索できる方法を模索しております。 よろしくお願いします。
新たしく、顧客DBをロータスからACCESSに移行しようか迷って試行錯誤している者です。 ロータスでは、カード型（ACESSでいうところのフォーム？といってよいでしょうか。。。）の形式で 検索し、該当するレコードのみを抽出できました。 例　住所で、「*東京都*」と検索すれば、該当するレコードが１０００件出てくるなど ACCESSでも同様のことは出来るのでしょうか？ ワークシートではなく、フォームの形式で検索し、その画面に現れるようにしたいのです。 色々と調べてみると、モジュールというのを使えば出来そうな気もしているのですが、 中々仕組みが理解できません。 private sub や　Me やFilter などの使い方がよくわかりません。。。 javaやhtmlなどは、ネットで調べてどうにかなったのですが。。。 詳しく説明されているサイトか何かがございましたら、ご教授いただけないでしょうか？
namesテーブルのcontentsカラムにねこを含むレコードのうち、 現在までに書き込まれたものを新しいものから抽出したいと思います。 contentsはverchar(255)、unixtimeはint(11)です。 しかし、 SELECT * FROM names WHERE MATCH (contents) AGAINST ('+ねこ' IN BOOLEAN MODE) AND BETWEEN unixtime < 1360850220 ORDER BY `unixtime` DESC limit 1,50 ; が出力されません。 このSQL文はどこが間違っているのか、ご指摘ください。 SELECT * FROM names WHERE MATCH (contents) AGAINST ('+ねこ' IN BOOLEAN MODE) ORDER BY `unixtime` DESC limit 1,50 ; だと出力されるので AND BETWEEN unixtime < 1360850220 が怪しいと思うのですが、どう訂正したらいいのかわかりませんでした。 よろしくお願いいたします。
MySQL 5.6を最近使い始めました。 大量のcsvファイルで保存されているデータを読み込んで、データベースとして扱いたいのですが、どうすれば良いでしょうか？ ファイル名は、 data1_1.csv data1_2.csv data1_3.csv data2_1.csv data2_2.csv といった形で、規則正しく並んでいるのですが、大量にあるため、ループを使って自動化したいと思っております。そのために、LOAD DATA INFILE ファイル名　を使って、このファイル名を順次変えて繰り返す方法がわかりません。 まず、ファイル名に変数が使えるのかと思って @file="data1_1.csv"としてファイル名を置き換えてみたのですが、エラーでした。これでは、この1_1を順次動かす以前に変数が無理なのかも？と思っています。 何かやり方があるようでしたら、どなたかお教えください。 どうぞよろしくお願いいたします。
create table team(team_id int not null primary key,team_name varchar(30),year int(4), leagueid int(32) ); insert into team values(1,"A",2012,1),(2,"B",2012,1),(3,"C",2012,1),(4,"D",2012,1),(5,"A",2012,2),(6,"B",2012,2),(7,"C",2012,2),(8,"D",2012,2),(9,"A",2011,1),(10,"B",2011,1),(11,"C",2011,1),(12,"D",2011,1); create table taisen(id int not null primary key auto_increment,hometeam int,homepoint int,awayteam int,awaypoint int); insert into taisen (hometeam,homepoint,awayteam,awaypoint) values(1,3,2,2),(3,1,4,0),(1,0,3,2),(2,2,4,2),(1,1,4,2),(2,0,3,0),(2,1,1,2),(4,1,3,3),(3,5,1,2),(5,3,6,3),(5,1,7,1),(7,1,8,1),(9,1,10,1),(11,1,12,3); データベース内にデータがあったときに年やleague_idごとに順位表を作りたいのですが、どのようにSQL文を書いてよいかわからず困っています。 理想はこのような感じです。 http://soccer.yahoo.co.jp/ws/standing/?l=52 お分かりの方がいらっしゃいましたらご教授お願いいたします。
テーブルが２つあるとします。 テーブルAにはテーブルBの列名がデータとして登録されてます。 テーブルBには値が格納されてます。 テーブルA Key　　field1　　field2　　field3 ------------------------------ 1　　　item2　　item3　　item5 2　　　item1　　item2　　item5 ------------------------------ テーブルB Key　　item1　　item2　　item3　　item4　　item5 -------------------------------------------- 1　　　　101　　　205　　　　350　　　420　　　510 2　　　　111　　　112　　　　113　　　114　　　115 -------------------------------------------- ここでテーブルAとテーブルBへキーを指定して、 テーブルAのfield1～field3に登録されたすべての列名を元にテーブルBから値を取得したいです。 例として キー1を指定して取得すると 205,350,510 が取れます (item2,item3,item5の列名をテーブルAで指定した為） キー2を指定して取得すると 111,112,115 が取れます キーをパラメータとして与え、 できれば２つのテーブルを結合し、１回のSQLで取得する方法はありますでしょうか？ （1回のSQLでなくても簡易であれば良いですが） よろしくお願い致します。
お世話になります。質問がふたつあります。 このような、IDとTypeのふたつのカラムで重複しているレコードが多いテーブル「tb」があるとします。 ID Type age 1 1 20 1 2 35 1 3 42 1 2 31 1 3 45 1 2 33 2 1 21 2 3 41 2 1 26 2 2 31 2 1 25 2 1 28 これを、以下のようにしたいのです。 ID Type age 1 1 20 1 2 35 1 3 42 2 1 21 2 2 31 2 3 41 group by ID, Typeとしたところ、 似たような形にはなったのですが、IDとTypeが重複した ID Type age 1 2 35 1 2 31 1 2 33 のうち、group byによってどのような基準でひとつが選択されるのでしょうか？ レコードの追加が新しいものが選ばれるのでしょうか？ また、ageをランダムでひとつを選択するような書き方はできるのでしょうか。 よろしくお願いします。
WindowsXP環境でACCESS2003を使用して、ODBCリンクでSQL SERVER2005に接続し、データーを取得後ローカルテーブルにデーターを置く処理を作って運用していたのですが、 Windows7でACCESS2003に移行し、システム内容は変更していないのですが Windows7になってリンクテーブルを開くと「ODBC タイムアウトエラー」が発生します。 WindowsXPのときはタイムアウトが出ずに1分くらいで結果が返ってきます。 多分、SQL SERVER ドライバーの影響と思うのですが分かりません。 どなたか教えてください。 Windows7 SQLSERVER（ODBC）ドライバー バージョン：6.01.7601.17514 windowsXP ドライバー バージョン：200.85.1132.00
はじめまして。 現在、私は仕事で統計を表示するためのレポートを作成中ですが、 データ取得SQLのよいアイデアが浮かびません。 わかる方がいらっしゃいましたら、お知恵を貸してください。 booking_id　　販売支店　　出身国　　　　値段　　　　車種 ---------------------------------------------- 01　　　　　　　東日本　　　ブラジル　　　100,000　　　A 02　　　　　　　東日本　　　ブラジル　　　200,000　　　A 03　　　　　　　東日本　　　ブラジル　　　300,000　　　B 04　　　　　　　東日本　　　ブラジル　　　400,000　　　C 05　　　　　　　東日本　　　日本　　　　　500,000　　　A 06　　　　　　　東日本　　　日本　　　　　600,000　　　B 07　　　　　　　西日本　　　ロシア　　　　700,000　　　B 08　　　　　　　西日本　　　ロシア　　　　800,000　　　B 09　　　　　　　西日本　　　ロシア　　　　900,000　　　B 10　　　　　　　西日本　　　韓国　　　　　100,000　　　A 11　　　　　　　西日本　　　韓国　　　　　200,000　　　B 12　　　　　　　西日本　　　韓国　　　　　300,000　　　C 13　　　　　　　西日本　　　韓国　　　　　400,000　　　C 上記のようなテーブルがある場合、販売支店と出身国でグループ化して、 それぞれの値段の合計値を出します。 その際、車種はもっとも頻出した値を表示したいのですが、 どのようにしたら実現できますでしょうか。 （最頻値が２つ以上の場合は、その中のどれかを表示する。） 期待結果は以下のようになります。 販売支店　　　出身国　　　　値段　　　車種 --------------------------------------- 　　東日本　　　ブラジル　　1000,000　　　A 　　東日本　　　日本　　　　1100,000　　　A 　　西日本　　　ロシア　　　2400,000　　　B 　　西日本　　　韓国　　　　1000,000　　　C SQL Server は、2008R2を使用しております。 以上、よろしくお願いいたします。
id　　　　　field1　　　　　field2 1　　　　　　1　　　　　　　　A 2　　　　　　1　　　　　　　　A 3　　　　　　1　　　　　　　　B 4　　　　　　2　　　　　　　　A 5　　　　　　2　　　　　　　　B 6　　　　　　2　　　　　　　　C 7　　　　　　3　　　　　　　　D 8　　　　　　3　　　　　　　　D 9　　　　　　3　　　　　　　　D field1とfield2の値が他のレコードのfield1とfield2と重複している場合はひとつのデータとして返したいです。 id1.2はfield1とfield2の値が同じなので、ひとつのデータしか返しませんが、id3はfield2が異なるので返します。 id4.5.6はいずれもfield2の値が異なるので4.5.6全てを返します。 id7.8.9はfield1とfield2が同じ値なのでひとつのデータしか返しません。 id 1 3 4 5 6 7 該当するレコードは上記のように6個となるようにするにはどのようなsql文を発行すれば良いでしょうか？ ご教示頂けますと幸いです。 宜しくお願い致します。
SQLでVIEWを作成し、そのVIEWに対してSELECT文を書くときに、そのVIEWに対してWHERE句をつけるのは、パフォーマンスを必ず下げることになるのでしょうか？勝手な認識ですが、VIEWにWHERE句をつけると遅くなる場合があると聞きました。VIEWの組み方にももちろんよると思いますが、VIEWは消極的に使い、出来る限りJOINなどして結合したSQLを書くほうが無難なのでしょうか？よろしくお願いいたします。
http://codecanyon.net/theme_previews/3101958-sto … 上記システムをmysqlでインポートしようとした所エラーメッセージが出てきてしまいます。 対処法が解りません。 解る方よろしくお願いします。 -- -- Table structure for table `store` -- CREATE TABLE IF NOT EXISTS `store` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE latin1_general_cs NOT NULL, `address` varchar(255) COLLATE latin1_general_cs NOT NULL, `number` varchar(255) CHARACTER SET latin1 NOT NULL, `latitude` varchar(255) COLLATE latin1_general_cs NOT NULL, `longitude` varchar(255) CHARACTER SET latin1 NOT NULL, PRIMARY KEY (`id`) ) ENGINE=MyISAM DEFAULT CHARSET=latin1 COLLATE=latin1_general_cs AUTO_INCREMENT=14 ; エラーメッセージが出てきてしまいます。↓ MySQLのメッセージ: ドキュメント #1064 - You have an error in your SQL syntax. Check the manual that corresponds to your MySQL server version for the right syntax to use near 'COLLATE latin1_general_cs NOT NULL, `address` varchar(255) CO
どのように質問すれば、良いのか自体あまりわかっていないのですが、 今後システムの仕事をすることになり、現在、ＤＷＨの導入を検討しております。 ＤＷＨの導入を考えているのですが、インポートしたいテーブル数が500超えてしまい、「500は多すぎる、これでは処理時間に1日かかってしまう。」と言われてしまいました。 元のシステムでオラクルのＤＢを使用しており、そのデータをＤＷＨ用のオラクルＤＢに写し、ＤＷＨにデータを入れるようにしようと考えております。 出来れば、3時間から4時間くらいで、インポートしたい（エンドユーザーがデータを確認できるように）のですが、一般的に、ＤＷＨへのインポートできるテーブル数はどのくらいなのでしょうか？また、500くらいのテーブルを希望の時間でインポートしたい場合にやりようはないのでしょうか。 分かる方いらっしゃいいましたら、ご教授ください。
ステートメントベースのレプリケーションをしている時に、 UPDATE 文でLIMIT 句を使用すると以下の様な警告が出ます。 [Warning] Unsafe statement written to the binary log using statement format since BINLOG_FORMAT = STATEMENT. The statement is unsafe because it uses a LIMIT clause. This is unsafe because the set of rows included cannot be predicted. Statement: DELETE FROM `__TABLE__` WHERE `user_id` = 1234 LIMIT 1 データ更新時にRAND()を使ったりした場合、 ORDER BYの結果が異なってしまうのが理由だと思うのですが、 ORDER BYしていないQueryに対してもwarnが出ています。 それとも何かほかに理由があるのでしょうか？
「MySQL」「PHP」、何れでも出来るような処理はどちらでやる方が良いのでしょうか？ ■例1 … 取得データを正規表現で加工して利用したい場合 ・SQL重視 … 正規表現等を駆使したSQLで、後々利用しやすい形で取得 ・PHP重視 … 普通に取得して、PHPで正規表現を利用して加工 ■例2 … データ取得がヤヤコシイ場合 ・SQL重視 … (例えそれがどんなに長くなっても)SQL文をキチンと組み立て、一度にデータ取得 ・PHP重視 … 簡単なSQL文で一旦データ取得後、PHPのループ文内等処理で、再度DBアクセスしデータ取得 ・ちょっと例えが微妙かもしれないのですが、そもそもデータ取得する際、どのように考えるのが正しいのでしょうか？ 1.なるべく利用予定に近い形でデータを取得 2.後で色々加工するかもしれないので、取得時点ではあまり加工せず、そのまま取得 ※要は、頻繁にDBへアクセスしてデータ取得するより、「DBへアクセスするのは極力避け、取得したデータはなるべく使い回す」方が良いのでしょうか？ ・それとも、ここら辺はケースbyケースなので、一概には言えないのでしょうか？ ・あるいは、別にどっちでもいい？　あまり、気にしなくても良い？
PHPとデータベースを使い、 顧客の条件に合った物件をメールに記載して送る処理を行っています。 その際、物件を記載する処理[下記(1)]の部分で同じ物件が記載されてしまいます。 (顧客によっては記載されない) データベース上に重複する物件は存在しないので、なぜ二重に記載されてしまうのかわかりません。 どこを疑えば良いでしょうか。 メール記載例：物件１、物件２、物件３、物件１、物件４、物件２、物件１、物件３、物件３ (二重記載される際のパターンは見つかりません) コード(簡略化) ---------------------------------------------------------------------- データデース１：顧客リスト データベース２：物件リスト //顧客取得 $sql_user = SELECT 条件 FROM 顧客リスト $result_user = mysql_query($sql_user) for($i = 0; $i < mysql_num_rows($result_user); $i++){ 　　$arr_user= mysql_fetch_array($result_user); 　　//顧客の条件に合った物件を取得するSQL文 　　$sql_match = SELECT * FROM 物件情報リスト WHERE～条件～ 　　$result_match =mysql_query($sql__match); 　　for($i = 0; $i < mysql_num_rows($result_match); $i++){ 　　　　$arr_match= mysql_fetch_array($result_match); 　　　　[(1)]物件を記載する処理 　　} １ユーザー分のメールを送る処理 } ---------------------------------------------------------------------- うまく説明できていなかったらすみません。
Windows版のMySQL v5.5.27です。 電話帳アプリを考えていますが、氏名、ヒラガナ、電話番号などなどのフィールドがあります。 そこでヒラガナが「か」から始まるレコードを選択したいと思っていますが、SELECT文が思いつかないのでご教授願います。 特に「か」だけではなく　あ・か・さ・た・・・ というレコードを選択です。 単純に「あ」、「か」、「さ」・・・と選択して蓄積しても良いのですがスマートなSELECTを書きたいと思って質問しました。
こういうテーブル「tb」があるとします。 「tb」 bang　nama　tuki A103　佐藤　4 A102　高橋　5 A104　鈴木　4 A101　中川　4 A103　渡辺　5 A101　西沢　5 A102　中村　6 A104　田中　5 A103　村井　6 A107　吉田　6 A101　小林　4 これを、実行後に、 bang　4月　5月　6月 A101　中川　西沢　NULL A102　NULL　高橋　中村 A103　佐藤　渡辺　村井 A104　鈴木　田中　NULL A107　NULL　NULL　吉田 このように、共通するbangで並べ替えたいのです。 A101の4月は、「中川」と「小林」で重複していますが、 このときはひとりだけが選択されてほしいです。 SELECT CONCAT(CASE WHEN tuki='4' THEN name ELSE IFNULL(null,'') END) AS '4月', ~ GROUP BY bang ~ としても、 bang　4月　5月　6月 A101　中川　 　 　 となってしまい、5月と6月が上手く表示されません。 よろしくお願いします。
iis7でxoopsを再インストールしたいと考えています。 インストール中に【XOOPS2 テーブルがデータベースに既に存在します】と出てきたので下記の方法で 削除しました。 でも、また同じようにデータベースが存在するメッセージが出てきます。 windows server2008 R2はどこからテーブルを削除すればいいでしょうか。 おわかりの方がいらっしゃいましたら宜しくお願いします。 1.IIS マネージャを開き、管理するレベルに移動します。 IIS マネージャを開く方法については、「IIS マネージャーを開く (IIS 7)」を参照してください。 UI の特定の場所への移動については、「IIS マネージャーでのナビゲーション (IIS 7)」を参照してください。 2.[機能ビュー] で、[接続文字列] をダブルクリックします。 3.[接続文字列] ページで、 削除する接続文字列を選択します。 4.[操作] ウィンドウで、[削除] をクリックし、[はい] をクリックします。
お世話になっております。 Oracle11gを使っています。 PROCESSESの値を変えようとして、 以下のコマンドを実行しました。 ALTER SYSTEM SET PROCESSES = 10 SCOPE = SPFILE; Oracleを再起動した後、 sqlplusを使ってログインできなくなってしまいました。 表面的には、 ORA-12514: TNS: リスナーは接続記述子で要求されたサービスを現在認識していません。 というメッセージなのですが、サーバのログに以下の記述を見つけました。 ORA-00444: background process "MMAN" failed while starting ORA-00020: maximum number of processes () exceeded PROCESSESの値が小さすぎたようです。 SPFILEに定義されているので、 変更するにはsqlplusで接続して、 再度ALTER　SYSTEM　コマンドを実行すると思うのですが、 そもそもsqlplusで接続できないので、変更することができません。 データベースOpen時に、 nomoutにしてPFILEから起動しようとするとしても、 これもまた、接続できないので、使えない手段でした。 また、SPFILEのバックアップも取っていなかったので、どうにもなりません。 この窮状から復旧する方法について、教えていただければ幸いです。 よろしくお願いします。
countとdistinctを使ったSQL文について VB2005＋SQLSERVER2005で開発を行っています。 distinctとcountを組み合わせて抽出するようなSQL文になるのかなと思うのですが うまくいきません カラム maker:メーカ名が登録されている テーブル　shohin カラムmakerの実際のデータ例 富士通 NEC 東芝 パナソニック NEC NEC パナソニック 抽出した結果の例 富士通　　　　１ NEC　　　　　３ 東芝　　　　　１ パナソニック　２ メーカー名とその件数が出力結果となります 以上ですがわかる方いらっしゃいましたらご回答お願いいたします。
SELECTする際、特定カラムの特定文字列がある場合に、そのレコードを弾いた結果を取得したいのですが、 どうすれば良いでしょうか？ ■前提 ・「urlpathカラム」に、「/tokyo/officeedit/261」みたいなパスが1つ入っています ■知りたいこと ・SELECTする際、「urlpathカラム」の中で、指定パスを含むレコードは除く、という条件を付けたいのですが、どうすれば良いでしょうか？ ■弾きたいパス例 ・「/tokyo/officeedit/★★」 ・「/tokyo/houseedit/★★」 ・「/site/login」
ファイルメーカーの初心者です。電卓、計算機を作る課題がでてまるっきりわからず困っています。 ファイルメーカーで計算機の作り方が載っているおすすめのサイトを教えて下さい。 かんたんなのでいいのですが手順が詳しく載っているサイトがいいです。
トレーディングカードゲームのカードを色々な条件で検索できる データベースサイトを作ろうと思っています。 具体的には、こちらのサイトのように、色々な条件で検索ができるものです。 http://itxsns.skr.jp/input2.php 他には　・無料　・スマートフォンからも利用可能　の二つです。 いまのところ、フリーのデータベースのPHPを使おうと思っていますが これまでに使ったことはありません。 よきアドバイスをお願いいたします。
はじめまして、よろしくお願いします。 職場環境がかわり、はじめてmySQLを使用しています。 ３つのテーブルから情報を検索したいのです。 [テーブル名: cast] name　　　　　　　　　　　　　// PRIMARY KEY age (例 なまえ１,　22 なまえ２,　28 なまえ３,　25 [テーブル名: photo] name order　　　　　　　　　　　　　// 写真表示順 (INT) url　　　　　　　　　　　　　　　// 写真格納先URL (例 なまえ１,　0,　http://なまえ１A.jpg なまえ１,　1,　http://なまえ１B.jpg なまえ１,　2,　http://なまえ１C.jpg なまえ３,　0,　http://なまえ３A.jpg [テーブル名: schedule] name workday　　　　　　　　　　　// 出勤日 (DATE) starttime　　　　　　　　　　// 出勤時間（TIME) finishtime　　　　　　　　　　// 退勤時間(TIME) (例 なまえ３,　2013-02-04,　 9:00,　17:00 なまえ２,　2013-02-05,　10:00,　18:00 なまえ２,　2013-02-06,　10:00,　18:00 なまえ２,　2013-02-07,　10:00,　18:00 キャスト情報(cast)とそのキャストの写真格納先URL(photo)とキャストの出勤時間(schedule)のテーブルです。 ※キャストは何枚でも写真を登録できます。登録していない場合もあります。 キャストのリストを表示したいです。 表示したい項目は cast.name,　cast.age,　photo.url,　schedule.starttime,　schedule.finishtime になります。 期待する結果は（２月５日の場合) なまえ１,　22,　なまえ１A.jpg,　NULL,　NULL なまえ２,　28,　NULL,　　　　　10:00,　18:00 なまえ３,　25,　なまえ３A.jpg,　NULL,　NULL すべてのキャストを表示します。 photo.urlはphoto.order=0のもの（photo.order=0の写真をサムネイル表示に使っています) ２月５日に出勤情報があれば表示 いろいろ考えたのですが、どうしても photo にデータがない（"なまえ２"）のところでつまづいてしまって、どうにも。。。 とりあえずPHPでそれぞれのテーブルの情報を取得して 自分で UNION、 USING('name') みたいな処理してますが、ソースがとっても恰好悪いです。 ズバッとしびれるSQL文をどうかご教示していただきたく、投稿しました。 よろしくお願いいたします＞＜
MySQLのMEMORYエンジンを使用したテーブルについて質問です。 varcharは可変長の認識だったのですが、MEMORYエンジンの場合、固定長として扱うのか・・・ InnoDBの時は2GB程のレコードだったのがMEMORYに変更したところmax_heap_table_size=7GBを超えてしまいました。 質問の内容は以下です (1)．varcharはMEMORYテーブルでは値の長さに関わらず領域を確保するのでしょうか (2)．MEMORYテーブルで可変長を扱う方法はあるのでしょうか MySQLのバージョンは5.5.28です。 難解な文章で申し訳ないですが、ご存知の方いらっしゃいましたらご教授のほどよろしくお願いいたします。
mysql php 超初心者です。 mysqlで連結先のテーブルのカウントを取得したいと思っています。 以下のような a_tblと b_tbl があり、 a_tbl の a_index と b_tbl の ab_no を 結合して b_tbl の ab_no のカウント数を 理想結果表に表示したいと思っています。 どう書いたら b_tbl の ab_no をGROUP(?) COUNTして 理想結果表の様にbテーブルのab_noのcount数を表示できるのでしょうか？ -a_tbl- a_index | a_data 1 |　りんご 2 |　信号 3 |　空 4 |　カラス -b_tbl- b_index | ab_no | b_data 1 |　 1 | 青 2 |　 1 | 赤 3 |　 2 | 青 4 |　 2 | 赤 5 |　 2 | 黄 6 |　 3 | 青 7 |　 3 | 白 8 |　 3 | 黒 9 |　 4 | 黒 -理想結果表- a_index |a_data 　　| bテーブルのab_noのcount数 1 | リンゴ 　　| 2 色 2 | 信号 　　| 3 色 3 | 空 　　| 3 色 4 | カラス　　| 1 色 私が見よう見まねで考えた式ですが、やはりこれでは表に2しか出ませんでした。 $sql = "SELECT Count(*) AS cnt FROM b_tbl LEFT JOIN a_tbl ON b_tbl.ab_no = a_tbl.a_index GROUP BY b_tbl.ab_no"; 質問の仕方もよくわからないのでわかりにくいかも知れませんが どうかご教授の程よろしくお願い致します。
SELECT a.num b.num FROM 　　サブクエリA(いろんな処理 WHERE a_id=ANY(サブクエリC(いろんな処理)) ) AS a, 　　サブクエリB(いろいろ処理 WHERE b_id=ANY(サブクエリD(いろんな処理)) ) AS b このような処理をしているのですが、サブクエリCとサブクエリＤは一字一句違わない全く同じ処理をしています。 ２回全く同じ処理をするのは処理コストが無駄にかかりますし、同じ内容を示す表記が２度出てくるのは保守性も悪くします。 サブクエリCとＤを共通化して一つにまとめる方法はありますでしょうか。
どなたかアドバイス願います。 ストアドプロシージャから「DBMS_STATS.GATHER_TABLE_STATS」パッケージを使って アナライズをやりたいと思っているのですができません。 以下のSQLをSQL*Plusから実行するとうまく動作するのですが、 プロシージャから「EXECUTE IMMEDIATE」を使って動作させると コンパイルエラーとなってしまうのです。 ※本当はテーブル名を動的に変更したいと考えているのですが、まずはコンパイルを 通したいと思いまして以下サンプルとしています。 （SQL*Plus経由で以下を実行すると動作します） exec DBMS_STATS.GATHER_TABLE_STATS (OWNNAME=>'SCOTT',TABNAME=>'EX001',METHOD_OPT =>'FOR ALL INDEXED',CASCADE => TRUE); （コンパイルエラーとなるプロシージャ） CREATE OR REPLACE PROCEDURE TEAT01 AS BEGIN EXECUTE IMMEDIATE DBMS_STATS.GATHER_TABLE_STATS (OWNNAME=>'SCOTT',TABNAME=>'EX001',METHOD_OPT =>'FOR ALL INDEXED',CASCADE => TRUE); END TEAT01; (エラーメッセージ） Error(3,19): PLS-00222: この有効範囲内に、名前GATHER_TABLE_STATSの関数は存在しません。 以上よろしくお願いします。
撮った写真がどのフォルダーに有るのか分からなくなってしまいました 撮った日付は分かっているのですが検索して探し出すことができないでしょうか
データを入力している最中、誤ってオートインクリメントのIDカラム(int 11)を削除してしまいました。 このテーブルのそれぞれのレコードに再度IDを割り振りたいです。 まだこのデータを使って何か使っているわけではないので、 IDの値自体は元のものでなくてもかまいません。 ID name 1 aaa 3 bbb 6 ccc 7 ddd : などでしたら、 ID name 1 aaa 2 bbb 3 ccc 4 ddd : と、そとりあえず個々のレコードに適当なIDを設定することができれば十分です。 このような設定を行う方法をご教示ください。 よろしくお願いいたします。
いつもお世話になっております。 この度、皆様に教えて頂きたい事象が発生しました。 内容は以下の１点です。 現在Linux上にデータベース（MySQL）があります。 通常MySQLの操作を行うには (1)rootユーザ (2)一般ユーザ (3)匿名ユーザ 等でログインして操作を行うかと思われます。 しかし、ここであえてMySQLでのユーザで操作するのではなくOS上のユーザ（root）で操作することは可能でしょうか？ 教えて頂きたいことをまとめると 【質問】 Linuxにログインする際のユーザ（OSのrootユーザ権限）でMySQLのエクスポートやインポートを行うことは可能かどうか？ *補足 MySQLのrootのPWを忘れたからこういうことをやりたいのか？ ⇒ いいえ、違います。PWを忘れた際の対処法は知っております。 　　単純に、Linux（OS）全体を扱っているrootユーザ権限で、データベースをいじれるかどうか（エクスポート、インポートが可能か）を知りたいのです。 サーバ系の知識が豊富な玄人の方々、アドバイス等頂けましたら幸いです。 *無理という回答でも結構です。 できるか、できないかが知りたいのです。 よろしくお願い致します。 以上
お世話になります。 phpmyadminのSQLで、 ブックマークの変数を利用する形で、 select文を実行したいのですが、 その際、 select文内に対して、 どのように、ブックマークの変数を記述すればよいのでしょうか？ 以上になります。 よろしくお願いします。
最終的に1億行になるであろうテーブルを含むデータベースを作っています。 テスト環境はCentOS6.3 MySQL5.5 CPU QuadCore 2.4GHz 2GBメモリです。 テスト環境を作るために10万件づつのCSVファイルをインサートしていったところ最初の10万件は数秒でインサートできたのですが、だんだん重くなり、1000万件近くになると「10万件の登録に1分半」もの時間が掛かっています。 (1000万件のデータはinnoDB上で1.2GB) サーバーを公開した場合、最大で1分間に数万件のインサートが見込まれていますので、今の環境だとテーブル内データ1千万件が限界の感じであり、現在予想している1億行では使い物にならないと危惧しています。 そのような中、調査していくとディーエヌエーの松信氏の発言で http://www.slideshare.net/kaminashi/db-6636154 18. インメモリでINSERTを完結する 　　インメモリでのINSERT性能 InnoDBの場合秒間15000 insert/s超え という記載を発見しました。 しかし、インメモリでのインサートの方法というのが分かりません。 話の筋やInnoDBという単語から言って、松信氏の言う「インメモリでINSERTを完結する」と「インメモリー・データベース」とは違うと考えております。 実メモリの範囲内という考えなら、現在のテスト環境でも1.2GBのデータを2GBメモリのマシンで展開しているわけなので、「10万件の登録に1分半」かかる理由が分かりません。 秒間15000 insert/s超えを達成させる「インメモリでINSERTを完結」させる方法について具体的にご教授いただけませんでしょうか? 宜しくお願い致します。
はじめまして。 voteというテーブルにcategory_id、individual_id、timeという３つのフィールドがあります。 (1)category_idは名前の通りカテゴリーのIDで、0～100まであります。 (2)individual_idはcategory_idごとに0～100まであます。 (3)timeは行が挿入された時間が記入されています。投票されるたびに行が挿入されます。 (4)category_idとindividual_idとdateでユニークキーを構成しています。 (5)category_idとindividual_idの２つで、個人が特定されます。 select categry_id, individual_id, count(*) from vote group by category_id, individual_id という命令文で、誰に何票voteされているかが分かります。 この先ですが、各カテゴリの中で最も多く投票されている3人ずつを表示したいのですが、どのようなSQLを書けばよいでしょうか。 似たような質問もあり、自分なりに四苦八苦して試してみたのですがうまくいきませんでした。 回答いただけると助かります。よろしくお願いいたします。
今、mac PCで　独自の認証局を作成し、自作の証明書発行をしようとしています。 今現在下記のサイトにて設定をしています。 ・http://homepage1.nifty.com/glass/tom_neko/web/we … 「起動時のパスフレーズ要求をなくす。」まで設定が終わり、 「httpd.confの設定」ができません。 できない内容 #LoadModule ssl_module libexec/httpd/libssl.so　 （↑は９５行にあり、設定ができました。） #AddModule mod_ssl.c （↑検索をかけましたが、見当たらないため設定が出来ません。） #Port 80 （↑検索をかけましたが、記述がないので設定ができません。。） それ以降は、解決しないと進めないのでやっていません。 解決方法はありますでしょうか？ 開発環境 MacBook Air Mac OS X バージョン　10.7.5 MySQLを使用 宜しくお願い致します。
データベースの考え方、で教えてください。 路線検索と、路線にひもづく駅名の時刻表を表示させる、データベースを作りたいと思っているのですが、 その場合、考え方としては、以下のような感じになるのでしょうか？ 路線名のtbl sql文: create table transit ( id integer not null, name varchar(20) not null ); 路線名tblにひもづく、駅名tbl sql文: create table station ( id integer not null primary key, transit_id integer not null, name varchar(20) not null ); 駅名tblにひもづく、時刻表tbl sql文: create table timetable ( id integer not null primary key, station_id integer not null, hour integer not null, minute integer not null ); 表示パターンとしては、 ================================= ○○線：　XX駅 6:10 20 7:30 55 . . . . . . 22:15 36 ================================== のような感じです。 よろしくお願いします。
mysql初心者です。 phpmyadmin で検索と置換のクエリ文の書き方に関して質問させて頂きます、宜しくお願いいたします。 データベース: koneko_nyan テーブル: wp_postmeta フィールド：meta_id、post_id、meta_key(varchar(255))、meta_value(longtext) があります。 フィールドmeta_valueの中の"お魚"という文字列を"焼き魚"に置き換えたい。 ただし、meta_valueフィールド全体ではなくて、meta_keyフィールドに"koubutsu"という文字列が含まれている行のmeta_valueに対してだけ置き換えを実行したいと考えています。 この場合、どのようなクエリを送れば、うまく置換できるのでしょうか？ 詳しい方いらっしゃいましたら、ご教示頂きたく存じます。
パソコンでFileMaker pro12を起動して　ipadでFileMaker go12 を使って会社で使ったり自宅でパソコン持ち帰って使ったりしているのですが　共有できたり出来なかったり不安定なのですが、どのような現象でしょうか？ wi-hiの環境は悪くないのですが・・
Microsoft ACCESS 2010を使用しています。 「テキスト0」という名前のテキストボックスがあり、 Me![テキスト0].Value = "こんにちは" というコードでテキストボックスの文字を変更します。 この時、テキストボックスの値が変更されたという条件でまた別のコードを動作させたいのですが、テキストボックスのイベントである、「更新前処理」「更新後処理」「ダーティー時」「変更時」では、動作しませんでした。 テキストボックスの値を変更する段階で別のコードを入力すれば対応は可能なのですが、「テキストボックスの値を変更した時」のタイミングで別コードを動作させることで、コードをまとめたいと考えています。 これに対して良い方法はありますか？よろしくお願いします。
MySQLのロックレベルはテーブルロックのようなのですが、行ロックに変更するって可能でしょうか バージョンは5.5です
SQL文がわからなく困っております。 下記のデータ＊01を＊02のデータのようにSELECTするためには、 どのようなSQL文を書けばよいのかお教えいただけますでしょうか？ DBはoracle11gです。 ※01 ID 　　　　 所属部署 ＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿ 　　　1　　　　　a 　　 1　　　　　b 　 　 2　　　　　a 　　 2　　　　　b 　　 2　　　　　c 　　 3　　　　　a 　　 3　　　　　b 　 　3　　　　　c 　　 3　　　　　d ____________________________ ↓↓↓↓↓↓↓↓↓↓↓↓↓↓ ※02 　ID 　　所属部署　　　　所属部署2　　　所属部署3　　　所属部署4 ＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿　　 1　　　　　　　　　a　　　　　　　　　b 2　　　　　　　　　a　　　　　　　　　b　　　　　　　　　c 3　　　　　　　　　a　　　　　　　　　b　　　　　　　　　c　　　　　　　　　d
FileMaker pro12　のラジオボタンのチャックボタンの色を変更したいのですが、初期設定の色はグリーンなのですが変更の方法がわかりません。よろしくお願いします。
Private Sub 患者番号_AfterUpdate() Dim Cn As ADODB.Connection Dim Rs As ADODB.Recordset Set Cn = CurrentProject.Connection Set Rs = New ADODB.Recordset Rs.Open "[tbl個人情報]", Cn, adOpenKeyset, adLockOptimistic Rs.Find "[患者番号] = " & Me![患者番号] If Rs.EOF Then MsgBox "レコードが見つかりません。ID=" & Me![患者番号] Else Me![性] = Rs![性] End If Rs.Close: Set Rs = Nothing Cn.Close: Set Cn = Nothing End Sub 上記の式を見よう見まねで作成したのですが、エラーが出てしまします。 　　　　　　　　　Me![性] = Rs![性]　　が見つかりません どのように解釈すれば良いのでしょうか？ ちなみに、サブフォームに入れているテキストボックスの「[性]を　同じサブフォーム内の[患者番号]から検索がしたいです。 初歩的なことで申し訳ございません。よろしくお願いします。
sqlで insert into tb1 values('○○(番号)','○○(名前)',○○(歳))； と入力して作ったデータを select bang,name,tosi from tb2; で表示したのですが、 nameのところが「??」と表示されます。 入力方法が違うのでしょうか？ それとも設定を変えないといけないのでしょうか？ 回答をよろしくお願いします。
チューニングについて質問です。 1. SQLの純粋な実行速度を知るにはどうしたらよいか 2. SQLの叩かれる回数が多い場合にレスポンスが遅くなるのはどう対応すればよいか 1については、純粋に単体での実行時間が知りたいのですがSQLのキャッシュが残っているせいか、高速に処理されてしまうために、なかなか正確な時間が分かりません。 どのようにしたら単体での実行速度を計測できるのでしょうか。 2については、SQL単体ではなかなかの速度が出せているのに、そのSQLが短時間に大量に呼び出される場合に、サーバの負荷があがり、レスポンスが遅くなってしまう場合はどう対処すればよいのかを聞きたいです。 よろしくお願い致します。
病院で勤めているものですが、FileMaker pro12でアンケート式調査なるものを作成したいのですが、例えば　質問１. 車は乗れますか？　□５点　乗れる　　□４点　ゆっくりだが乗れる　といった感じに　チェックボタン式に入力し　合計点数をもとめるようなアンケート調査です。URL 等で説明があるサイトがあれば教えてください。よろしくお願いします。
お世話になります。 添付画像のような文字列の配列変換の方法について模索しております。 ExcelでもAccseeでもMIFESでもよいので、なにか良い案がありましたら教えてください。 ※添付画像の出力セルの位置は問いません。 よろしくお願いいたします。
SQLite　バージョン3.7.10　を使用しています。 以下のサイトにソースがあります。 http://ideone.com/7FPtHL どう説明するのが適切なのかあまり分かりませんが、 よろしくお願い致します。 t5テーブルにおいて t2テーブルのt1_key1が't1_key_1'　かつ　t5テーブルのt3_keyに対応するt3テーブルのt1_keyに対応するt2テーブルのt1_key2の 例えば2012年1月の （t5テーブルのprofit　×　その日（t5テーブルのdateの日の部分）に対応した2テーブルのrate） を t4テーブルのkeyごとにグループ化してその合計値を高い順に出力したいのですが、 のですがどのようなSQL文を書けば良いのでしょうか？ ※ ただし、もしt5テーブルのdateに対応する日付がt2テーブルのdateにない場合は、 t5テーブルのdateに対応する月（年も含めて）のt2テーブルのrateの平均値、 それもない場合は、t5テーブルのdateに対応する年のt2テーブルのrateの平均値、 それもない場合は、t5テーブルの全てのrateの平均値、 を取得してt5テーブルのprofitにかけたいのです。。 ※ 例えばこのデータなら 2012年1月は +----------+------+ |　t4_name　　|　sum　| +----------+------+ |　t4_name_1　|500000| +----------+------+ |　t4_name_2　|150000| +----------+------+ という結果が得たいです。 t5テーブルのdateの'2012-01-03 00:00:02'の日付に対応するt2テーブルのdateは存在しないので、 t2テーブルの1月（2012-01）のrateの平均値（(100＋200＋300)/3＝200）を profitにかけています。 複雑すぎるというか自分でもうまく説明できないので、 せめて※の部分のSQLの書き方だけでもアドバイス頂けないでしょうか？
filemaker pro 12の画像表示で iphone5でfilemaker goを使って画像をアップロードしてipadを使いみているのですが、画像の元ファイルである iphone5の画像を削除したらilemaker goの画像も同時に消えてしますか？画像のプレビューは表示されるのですが、画像が開けません？どのような状態でしょうか？初心者ですいません　よろしくお願いします。
教えてください。SQLSever初心者です。SQLサーバがインストールされているサーバのコンピュータ名を変更します。変更によって何か影響することがありますでしょうか？
教えてください。MySQL初心者です。MySQLサーバがインストールされているサーバのコンピュータ名を変更します。変更によって何か影響することがありますでしょうか？ mysql.userなどのテーブルにhostのデータがあるようなのですが。よろしくお願い致します。
アクセスのデータ抽出についてご質問が ございます。 100件あるデータの中から 抽出条件が異なるデータを レコードごとに3件抽出したいのですが 困ってます。 例えば、100件のデータの 1フィールド目の数値が 1234567890 7891234567 5678901234 となる値を 抽出条件に割り当て 100件中3件ほど、レコードごとに 抽出出来る 方法はないでしょうか？ お手数ですがアドバイスお待ちして おります。
Access2010について質問します。 レポートの作成方法を教えてください。 現在フィールドが以下のようになっています。 ID ：苗字：名前：住所　：社内ランク 00001：山田：太郎：東京都：0 00002：東京：花子：滋賀県：1 01001：大阪：一郎：大阪府：1 01002：・・・・・・ ＩＤの左２桁は会社、右３ケタは社員ＩＤです。 このレコードを、Ａ４の左上に郵便の宛名として印刷しています。 このＡ４に宛名とは、別に社内ランク１の人リストを同じ紙面に印刷したいと思っています。 リストに掲載する人の条件は以下の通り (1)宛名の人と同じ会社ＩＤである。 (2)社内ランクが１である。 (3)氏名のみ印刷する。 現在のレポート上にサブレポートを作り印刷するのだと思うのですが、宛名のＩＤをどうやってサブレポートで取得するかわからなくて困ってます。 ご教授をお願いいたします。
みなさん初めまして。 SQLについて只今勉強中の者です。 EclipseとMySQLを接続したいのですが、どうしても接続できません。 利用環境 apache-tomcat-6.0.36 MｙSQL5.5 Windowsはｘｐです。 apache-tomcat-6.0.36を利用しており、JDBCドライバをダウンロード後、Tomcat内のcommon\lib内にmysql-connector-java-5.1.22-binを導入し、環境変数でパスを通しています。 TomcatとEclipseの接続は確認しています。 また、MySQLについては起動確認や、データベース作成は行えました。 原因のjava.lang.ClassNotFoundException: com.mysql.jdbc.Driverから、JDBCドライバにパスが通っていないため接続が出来ていないと考えております。 初歩的な質問かもしれませんが宜しくお願い致します。 以下は実行した際に表示された内容です。 HTTPステータス 500 - -------------------------------------------------------------------------------- type 例外レポート メッセージ 説明 The server encountered an internal error () that prevented it from fulfilling this request. 例外 org.apache.jasper.JasperException: javax.servlet.ServletException: java.lang.ClassNotFoundException: com.mysql.jdbc.Driver org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:500) org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:410) org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313) org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260) javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 原因 javax.servlet.ServletException: java.lang.ClassNotFoundException: com.mysql.jdbc.Driver org.apache.jasper.runtime.PageContextImpl.doHandlePageException(PageContextImpl.java:865) org.apache.jasper.runtime.PageContextImpl.handlePageException(PageContextImpl.java:794) org.apache.jsp.admin_jsp._jspService(admin_jsp.java:108) org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70) javax.servlet.http.HttpServlet.service(HttpServlet.java:717) org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386) org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313) org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260) javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 原因 java.lang.ClassNotFoundException: com.mysql.jdbc.Driver org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680) org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526) org.apache.jasper.servlet.JasperLoader.loadClass(JasperLoader.java:128) org.apache.jasper.servlet.JasperLoader.loadClass(JasperLoader.java:66) java.lang.Class.forName0(Native Method) java.lang.Class.forName(Class.java:186) org.apache.jsp.admin_jsp._jspService(admin_jsp.java:66) org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70) javax.servlet.http.HttpServlet.service(HttpServlet.java:717) org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386) org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313) org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260) javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 注意 原因のすべてのスタックトレースは、Apache Tomcat/6.0.32のログに記録されています -------------------------------------------------------------------------------- Apache Tomcat/6.0.32 以上です、宜しくお願い致します。
お世話になります。 DB：Oracle11g OS：Linux5 上記環境のDBサーバへ、Aさん、BさんがTera Term接続して、 2名とも同じスキーマSSS（DBA付与）でsqlplusにてDB接続しました。 Aさんが、TTTテーブルに対してINSERT文を実行し、 1行追記されていることをSELECT文にて確認することができましたが、、 その後Bさんが同じSELECT文を実行しても、Aさんが追記した行が表示されません。 お恥ずかしい質問で恐縮ですが、 Bさんからも、AさんのINSERT実行結果を即時に確認できるようにするための Oracleの（？）設定がありましたら、ご教示ください。 ※目的はAさんが実行したINSERT、UPDATE、DELETEの結果を、 　 Bさんが開いているTera Termのコンソールからも確認したい。
お世話になります。 下記の様な条件による連番をふるマクロを組みたいと考えており、 色々考えてたのですがやり方が分からなく困っています。多少複雑だとは思いますが、すみませんが、詳しい方よろしくお願い致します。 内容として、例えばですが野球チームの選手をランク別にあるコーチに割り当てたいとします。 T_コーチマスタ(テーブルＡ) ランク　　コーチ名　　担当数MAX -------------------------------- 　A　　　　鈴木　　　　　2←Aランク選手に割り当てたいコーチ 　A　　　　橋本　　　　　2←Aランク選手に割り当てたいコーチ 　B　　　　田中　　　　　2←Bランク選手に割り当てたいコーチ 　B　　　　青木　　　　　3←Bランク選手に割り当てたいコーチ 　C　　　　佐藤　　　　　2←Cランク選手に割り当てたいコーチ (補足：ランク順に昇順しています) T_選手マスタ(テーブルB) ランク　　　選手名　　人数(連番) コーチ名 -------------------------------------------- 　A　　　　　加藤 　B　　　　　山本 　B　　　　　渡辺 　B　　　　　吉田 　A　　　　　佐々木 　A　　　　　木村 　C　　　　　太田 (＊得たい結果) ランク　　　選手名　　担当数(連番) コーチ名 -------------------------------------------- 　A　　　　　加藤　　　　　1　　　　　　　鈴木 　A　　　　　佐々木　　　 2　　　　　　　鈴木 　A　　　　　木村　　　　　1　　　　　　　橋本 　B　　　　　山本　　　　　1　　　　　　　田中 　B　　　　　渡辺　　　　　2　　　　　　　田中 　B　　　　　吉田　　　　　1　　　　　　　青木 ※選手ランク(T_選手マスタ)別に、コーチ名と連番を割り当てたいのですが、コーチにも教えられる人数が限られており、担当数MAXまでしか連番をふれません。担当数を超えると次(下)のコーチ(ランク別)に割り当てたいです。担当者MAXがなく一人のコーチが全員分連番をふれればいいのですが・・・。 　連番を振るだけのコードだけは分かったのですが、どうすれば上手い具合にできますでしょうか？？(SQLで方法がありますか？) '連番のみのコード Sub DAO_numbers() Dim db As DAO.Database Dim rs As DAO.Recordset Dim fd As DAO.Field Dim SQL As String Dim inCount As Integer Set db = CurrentDb() SQL = "SELECT * FROM T_選手マスタ ORDER BY ランク" Set rs = db.OpenRecordset(SQL, dbOpenDynaset) Set fd = rs.Fields("人数") If rs.BOF = False Then rs.MoveFirst inCount = 1 Do Until rs.EOF rs.Edit fd = inCount rs.Update inCount = inCount + 1 rs.MoveNext Loop End If rs.Clone: Set rs = Nothing db.Close: Set db = Nothing End Sub (上記コードは使わないのであれば無視しても構いません。) 以上よろしくお願い致します。
My SQLで複数の条件での絞り込み検索をしたいのです。 TABLEAのSHOHINCDという項目をキーにして、 TABLEBにて上記で抽出したSHOHINCDを LIKE IN で抽出したいのですがどう記述したらよいのでしょうか。 初歩的な質問ではありますが、宜しくお願い致します。
RMANの不完全リカバリをバッチ化しようとしています。 サービスの起動や状態を確認するバッチ(oracle_restore.bat)内で リカバリを行うsqlファイル(oracke_restore.sql)を呼び出して、 実行しようとしています。 不完全リカバリの方法としては、時間を指定してリカバリを行うので、 rmanコマンドに、時間を引数として渡したいのですが、渡し方がわかりません。 バッチ実行時に oracle_restore.bat 2013-01-21 10:55:00 set RESTORE_TIME_YMD=%~1 set RESTORE_TIME_HMS=%~2 こんな感じで、引数を渡して rmanコマンドに rman target sys/pass @C:\oracle_restore.bat %RESTORE_TIME_YMD% %RESTORE_TIME_HMS% こんな感じで渡すことで、 set until time内に正しく時間を渡したいです。 SET UNTIL TIME "TO_DATE('%1','YYYY-MM-DD HH24:MI:SS')"; ↑sqlplusならこれで渡せたのですが。。。 なにか良い方法はありませんでしょうか。 ご教示願います。 OS：WindowsServer2008 R2 Oracle：oracleDB 11g R2
以前、知り合いからデータベースのINT型の項目には出来ればNULLを許可しない（NOT NULL）方がいいと聞いたことがあるのですが、本当でしょうか？ 現在不動産の物件データを登録するためのシステムを作成しており、 データベースの設計を行なっている最中なのですが、 例えば金額や面積など数字しか入力されない項目はINT型にしたいと考えています。 ※データベースはMySQLになります。 ただし、 物件データ登録時に数字項目に何も入力されなければ「NULL」、 0以上の数値を入力されている場合にはそのままその数値をデータベースに登録したいと考えています。 ※0を入力されている場合には「0」をそのまま入れたいです。 INT型の項目にはNULLを入れるのを避けた方がいい場合には、0を入れるような仕様に変更しようと考えているのですが、その辺のことについて教えて頂けると助かります。 ざっくりとした質問で申し訳ございませんが、宜しくお願い致します。
教えてください。 マイクロソフト　Access2010で　左右のフィールドのレコード内で重複した文言を削除したいのですがどうやってよいのか分かりません。 例えば左のレコードに ＞　ブリキ看板 テキサコ ダルメシアン TEXACO ブリキカンバン ぶりき看板 ティンサイン サインボード インテリア TINサイン アメリカン雑貨 入っており右に下記の文言が入っているとします。 ＞　ブリキ看板 ブリキカンバン アメリカン雑貨 左のレコードから右のレコードの文言を削除し ＞　テキサコ ダルメシアン TEXACO ぶりき看板 ティンサイン サインボード インテリア TINサイン という結果が欲しいのです。 よろしくお願いします。
お世話になります。 ACCESSのクエリであるテーブルの入力ミスを抽出したいと考えています。 例えば、氏名と科目と点数があるとします。 No.　　氏名　　科目　　点数 -------------------------- 01 佐藤　　国語　　　80 02 田中　　国語　　　45 03 鈴木　　国語　　　60 04 佐藤　　数学　　　75 05 田中　　数学　　　40 06 鈴木　　数学　　　48 ここで抽出したい条件として、国語は59点以下、数学は49点以下の抽出をしたいとして、今まではクエリの条件に1つずつ科目と点数に条件を入れ１つずつ結果を抽出をしていましたが、同時に結果を得ることができますか？また、結果をリスト表(クエリかレポート)として出力できますか？ 拙い文で申し訳ありませんが、分かる方いらっしゃいましたらよろしくお願いいたします。 (スキルとして少しで、ブランクもありますがVBA,SQLです)
正規化が分かりません。 冗長性を排除したい、という意図だけは分かるのですが… 例えば、リンク先で回答されているケースは、それぞれ第何正規化に該当するのでしょうか？ ＞個人IDがあり、住所情報を正規化するとしましょう ＞項目は「郵便番号」「都道府県」「市区町村」「番地」「電話番号」「メールアドレス」としますよ ＞個人IDを主キーとする「郵便番号テーブル」を作る ＞個人IDを主キーとする「都道府県テーブル」を作る ＞個人IDを主キーとする「市区町村テーブル」を作る ・これは第1正規化ですか？ ＞個人IDを主キーとする「番地テーブル」を作る ＞個人IDを主キーとする「電話番号テーブル」を作る ＞個人IDを主キーとする「メールアドレステーブル」を作る ・この内容は重複しないと思うのですが、分けると、正規化したことになるのでしょうか？ ・また、その場合は、第何正規化に該当するのでしょうか？ ▽DBの「非正規化」について 　 http://oshiete.goo.ne.jp/qa/5776795.html
以下のようなデータがあります。 id　顧客コード　日付　金額 1　A001　2012/12/25　100 2　B001　2012/12/24　200 3　A001　2012/12/24　100 4　C001　2012/12/23　500 5　A001　2012/12/23　300 6　B001　2012/12/23　100 このデータを、顧客毎に最新順で表示したいのです。 順番は、 １．最新の日付順に顧客がまず並ぶ ２．その顧客の並び順で、顧客毎に日付が新しい順に各データが並ぶ 説明が下手ですが、下の様に 1　A001　2012/12/25　100 3　A001　2012/12/24　100 5　A001　2012/12/23　300 2　B001　2012/12/24　200 6　B001　2012/12/23　100 4　C001　2012/12/23　500 A001、B001、C001の中で、最新の日付を持っているのがA001→B001→C001なので、その順で並ぶ。 （SELECT 顧客コード, MAX(日付) FROM tbl GROUP BY 顧客コード　かな？） さらに、その顧客の中で日付順にデータが並ぶ。 このように抽出するには、どのようなSQL文で行うのでしょうか。 サブクエリを使うのかなとは思うのですが、あまり理解できていないため思いつきません。 わかるかたよろしくお願いします。
SQLiteのLike句で抽出できないレコードがあります。 原因についてご教授いただけますでしょうか。 以下、操作手順になります。 ■データベースの作成 C:\>sqlite3.exe member.db SQLite version 3.7.15.2 2013-01-09 11:53:05 Enter ".help" for instructions Enter SQL statements terminated with a ";" ■テーブルの作成、レコードの追加 sqlite> create table t_member(name text, age integer); sqlite> insert into t_member values('山田一郎', 25); sqlite> insert into t_member values('田中次郎', 35); sqlite> insert into t_member values('鈴木三郎', 45); ■検索 sqlite> select * from t_member where name like '%一郎'; 山田一郎|25 sqlite> select * from t_member where name like '%次郎'; 田中次郎|35 sqlite> select * from t_member where name like '%三郎'; sqlite> 三郎だけが検索条件に適合しないのは何故でしょうか。 よろしくお願いします。
ACCESSで最小公倍数を求めた値をセットしたいのです データとしては キー項目 数値 A　　　　　２ A　　　　　３ Ａ　　　　　２ Ｂ　　　　　１ Ｂ　　　　　３ Ｃ　　　　　２ とあったとしてキー項目単位で求めた最小公倍数をセットしたデータを ｕｐｄａｔｅしたいのです キー項目　数値　最小公倍数 A　　　　　２　　　　　６ A　　　　　３　　　　　６ Ａ　　　　　２　　　　　６ Ｂ　　　　　１　　　　　３ Ｂ　　　　　３　　　　　３ Ｃ　　　　　２　　　　　２ このような更新クエリーを作りたいのですが 最小公倍数の関数がＥＸＣＥＬならＬＣＭというのがあるみたいですが ＡＣＣＥＳＳには見つからなかったので・・・ データが大量にあるのでＡＣＣＥＳＳで処理したいのですが いい方法がありましたらアドバイス下さい
こんにちは。 DB未経験で勉強中です！ どなたか教えてください。。 OracleのTO_DATE関数のようなことはSQL Serverでは実現可能でしょうか？ 数値型から日付型への変換です。 たとえば20121109を2012/11/09と変換、 もしくは201211を2012/11に変換するなどです。 是非、ご教授願いします。
viewにidentity列を追加したいのですが、SQL文が分からなくて困っています。 追加する方法をご存知の方がいましたらよろしくお願いします。 作りたいviewは以下のようなviewです。 ・テーブルA ID　　NAME　　　ADDRESS １　　　山田　　　　東京 ２　　　鈴木　　　　埼玉 ３　　　田中　　　　千葉 ４　　　佐藤　　　　埼玉 ５　　　藤田　　　　東京 ６　　　石田　　　　神奈川 ７　　　松田　　　　千葉 ・作成したいview ID　　ADDRESS　　出身人数 １　　　神奈川　　　　　　１ ２　　　　埼玉　　　　　　２ ３　　　　千葉　　　　　　２　 ４　　　　東京　　　　　　２ ↑このID列をidentity列にしたいと考えています。 使用しているDBはH2です。よろしくお願いします。
以下のように、10秒ごとにユーザごとの金額データが登録されるテーブルがあるとします。 このテーブルから、ユーザごとの最新のデータを抽出するSQLを教えて頂けないでしょうか？ 出来れば、WHERE条件で時間を指定する方法ではなく、MAXを使った方法がいいのですが…。 【ユーザ情報テーブル登録内容】 年 | 月 | 日 | 時 | 分 | 秒 | ユーザ| 金額 2012 | 01 | 14 | 10 | 00 | 00 | 00001 | 100 2012 | 01 | 14 | 10 | 00 | 00 | 00002 | 200 2012 | 01 | 14 | 10 | 00 | 00 | 00003 | 100 2012 | 01 | 14 | 10 | 00 | 10 | 00001 | 100 2012 | 01 | 14 | 10 | 00 | 10 | 00002 | 200 2012 | 01 | 14 | 10 | 00 | 10 | 00003 | 100 2012 | 01 | 14 | 10 | 00 | 20 | 00001 | 100 2012 | 01 | 14 | 10 | 00 | 20 | 00002 | 200 2012 | 01 | 14 | 10 | 00 | 20 | 00003 | 100 2012 | 01 | 14 | 10 | 00 | 30 | 00001 | 100 2012 | 01 | 14 | 10 | 00 | 30 | 00002 | 200 2012 | 01 | 14 | 10 | 00 | 30 | 00003 | 100 【抽出対象】 年 | 月 | 日 | 時 | 分 | 秒 | ユーザ| 金額 2012 | 01 | 14 | 10 | 00 | 30 | 00001 | 100 2012 | 01 | 14 | 10 | 00 | 30 | 00002 | 200 2012 | 01 | 14 | 10 | 00 | 30 | 00003 | 100 ご教示のほど、よろしくお願い致します。
以下のようなことを実現する方法についてお教え頂きたいです。 ■テーブル [XXXマスタ] ID char(8) 上記のテーブルにはIDという項目があるのですが、このテーブルで 使用していないIDのみをSQLで抽出できないかと考えております。 ただし、なるべくならワークテーブルのようなものは利用せずに 行いたいと思っております。 いい方法があれば教えていただきたいです。
現在SQLserver上で、、ＣＳＶを一時テーブルに保管し、ある条件に合致する行のみＴＢＬに追加するというストアドを書いています。そのＴＢＬには「datetime型」の列があります。 この作業で、２点問題が発生しています。 (1)ＣＳＶファイルから一時テーブルにデータを入れようとすると、datetime列がＮＵＬＬの場合、型の不一致でエラーが発生します。 (2)上記において、一時テーブルの型をとりあえずvarcharにしておくと入れれるのですが、ＴＢＬに追加しようとする際、「convert(datetime,変数)」としているのですが、上手くキャストしてくれません。（「文字列から日付への変換に失敗しました」のような文がでます） どのようにすれば、ＮＵＬＬでもdatetimeに入れられるのでしょうか？教えてください。
マイクラのゲームを起動するとどうしても動きが遅い 誰か動きを速くする方法教えてください お願いします
テーブル TB の項目 CDがNUMBER型でユニークキーだとします。 このCDで ・ある値以上の空いている最小の番号を取得したい。 としたら１つのSQLで実現できますか？ 例） ＣＤの値が 6・・・・80　150・・・　（81から149は存在しない） という具合に存在していた場合に、101以上で空いている最小の番号 を取得したいのです。 この場合は101です。1が取得されても駄目、81が取得されても駄目です。 また、同じ条件でデータが 6・・・・150　200・・・　（151から199は存在しない） の場合には151が取得したいのです。 このような値を検出するSQLってわかりますか？ 以上よろしくお願い致します。
どなたかご教示下さい。 Oracle PL/SQLにてカーソル定義を下記のように行う場合 SELECT A.* FROM testtable A WHERE A.testID = 123 AND A.testName = 'aiueo'　←このAND条件を場合によって省く 例えば変数Aが0の場合に下記条件を省きたいのです。 AND A.testName = 'aiueo' 可能でしょうか？
php・MySQL初心者です。 何とかここまで自力でやってこれたのですが、もうお手上げで…。 サンプルコードを解析し、部分的に理解しながら進んでる状態です。 やりたいことは、 「ユーザーが入力した文字列の最後の1文字だけを抜き出し、データベースに代入する」です。　←(2) ちなみに、 「ユーザーが入力した文字列をそのまま、データベースに代入する」はできました。←(1) 参考に、(1)のソースコードの一部を書きます。 ------------------------------------------- 『main.php』 <form action="result.php" method="POST" enctype="multipart/form-data"> <input type="hidden" name="MAX_FILE_SIZE" value="<?= $file_maxsize ?>"> タイトル：<INPUT type="text" name="title" size="50"><br> コメント：<INPUT type="text" name="comment" size="50"><br> <input type="submit" value="送信"> </form><hr> ------------------------------------------- 『result.php』 $comment = @trim($_REQUEST['comment']); //※ $query = "insert into main_t (comment, last)" . " values ('$comment', '$last')"; $result = mysql_query($query); ------------------------------------------- だいたいこんな感じで(1)は出来ました。 (関係がありそうなところだけを抜き出したつもりです…) 『main.php』で出力して確認もしました。 (2)の現状の私のコードを書きます。 ------------------------------------------- 『result.php』 $x = mysql_query("select right('$title', 1)"); $last = mysql_fetch_assoc($x); ------------------------------------------- これを(1)の //※ 　の部分に記述してみましたが、うまくいきません。 出力するとなぜか「Ar」と出てきます…泣 『select right('いちもじ', 1)』で『じ』とちゃんと右一文字が取り出せるのをbatファイル？みたいなので確認しました。 このSQL文をPHP内で行いたいのですが、やり方がわかりません…。 (そもそも根本的に間違っているのでしょうか…) $x = mysql_query("select * from ○○ where 条件"); $last = mysql_fetch_assoc($x); みたいにfromで検索先や条件を指定して得た「配列」を取得し、表示する方法はネット検索で沢山見つかったのですが、fromやwhereを使わず、結果も配列ではなく1つだけ得られるような場合は、どうすればよいのでしょうか？ わかりづらい文章ですみません； 難しい質問かとは思いますが、PHPやMySQLに詳しい方がいましたら、是非ともご教授いただけたらと思います。 よろしくお願いいたします。
現在、Google App Engineの環境で学習しています。 GAEではデータベースにBigTableを用いていると学習しました。 しかし、実際にデータベースの中を見てみると、DatastoreとBlobstoreに分かれています。 このBigTableとDatastore＆Blobstoreの違いは何なのでしょうか？ また、DatastoreとBlobstoreの２つの違いは何でしょうか？ Blobstoreの方が大容量のファイルを格納できるという理解で良いのでしょうか？ 以上、宜しくお願い致します。
現在、PerlでOracle-DBDを使用したスクリプトを作成しています。 テストした結果、コマンドプロンプトからの実行は問題ないのですが、 JP1から起動するとデータベースとの接続でエラーになってしまいます。 なにをやっても解消する気配がありません。 コマンドプロンプトからは実行可能なのでスクリプトは問題ないと思っています。 原因と対応方法についてご教授いただけないでしょうか。 宜しくお願います。 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　以上
MySQLの初級者です。 下記のようなテーブル構造があります。 article_flag -------------　------------- 　aid　　　　display -------------　------------- 　1　　　　　1 -------------　------------- 　2　　　　　1 -------------　------------- 　3　　　　　1 -------------　------------- 　4　　　　　2 -------------　------------- ...Primary(aid)、INDEX(display) category -------------　------------- 　cid　　　　name -------------　------------- 　1　　　　　カテゴリ1 -------------　------------- 　2　　　　　カテゴリ2 -------------　------------- 　3　　　　　カテゴリ3 -------------　------------- 　4　　　　　カテゴリ4 -------------　------------- ...Primary(cid)、INDEX(name) article_category -------------　------------- 　aid　　　　cid -------------　------------- 　1　　　　　1 -------------　------------- 　1　　　　　4 -------------　------------- 　2　　　　　1 -------------　------------- 　2　　　　　2 -------------　------------- 　2　　　　　4 -------------　------------- 　4　　　　　1 -------------　------------- 　4　　　　　2 -------------　------------- ...INDEX（cid aid) このような構造の中で、 下記のような出力を行いたいのです。 カテゴリ1　【関連記事 2件】 カテゴリ2　【関連記事 1件】 カテゴリ4　【関連記事 2件】 非表示中の記事（display = 2）は関連記事に上がらず、 関連記事の存在しないカテゴリは出力しないという仕様です。 この場合、どのようなSQL文で対処すればよろしいでしょうか？ 現状では、 SELECT c.cid, c.name FROM category as c INNER JOIN article_category as ac ON c.cid = ac.cid INNER JOIN article_flag as af ON ac.aid = af.aid and af.display = '1' GROUP BY c.cid ORDER BY c.name ASC limit 10; というSQL文でまずは抽出してから、 抽出後のPHPのループ内で、 SELECT count(ac.cid) FROM article_category as ac INNER JOIN article_flag as af ON ac.aid = af.aid WHERE af.display = '1' and ac.cid = '{取得したcid}'; とカウントして関連記事数を出すという 回りくどいやり方しか思いついていません。 また例では件数が少ないですが、 実際には、article_flagが500件、categoryが200件あり、 一つの記事に平均で10個近いカテゴリが割り当てられているため、 article_categoryの件数は5000件近くあります。 そのため、最初のSQLクエリがとても遅く、 早くても10秒くらいかかります。 基本的にはlimit 10で10件限定の表示のため、 2番目のクエリは特に重さを感じません。 1つ目のクエリで一度に関連記事数まで取得できれば最善ですが、 難しい場合には、1つ目のクエリでは、 関連記事が存在するかどうかの判定だけでも良いので、 何とか良い方法をご教授の程お願いいたします。
MySQLを使っていて、下記条件で結果がemptyになります。 どうすれば正常に取得できるようになるでしょうか。 SELECT `hoge`, `fuga`, `piyo` FROM `table` WHERE `moge` = 'moge' ORDER BY `fuga` DESC LIMIT 0, 5 ・`moge`と`piyo`にはインデックスが貼られています。 ・DESCを消すと正常に取得できます。 ・WHERE句を消すと正常に取得できます。 ・LIMITの数値を大きくすると正常に取得できます。（'moge'によってどれくらい大きくすればいいかの数値は違う） ・LIMITのoffsetを1以上にすると正常に取得できます。 1ヶ月ほどはちゃんと動作していたのですが、`fuga`をUPDATEしたタイミングからこのような現象となりました。 環境 ・Ubuntu 12.04.1 LTS ・MySQL 5.5.28 ・エンジン mroonga ・groongaのバージョン2.0.9 足りない情報があれば補足致します。 宜しくお願い致します。
いつも楽しく勉強させていただいております。 Access2007、win7で前任者が作ったものを元に類似のシステムを作ることとなりました。 その中にあるフォームで私にとってよくわからないものがあります。 そのシステムとは検索条件を入力し、条件に一致したレコードを表示するというものです。 条件を設定するフォームはレコードソースプロパティは空白、つまり非連結のフォームです。 したがって検索条件を入力するテキストボックスのコントロールソースプロパティも空白です。 こういった場合「入力する値は数字だけに限定」といった制御をするなら、入力規則プロパティを設定するか、更新前のイベントでコードを書くかするものだと思っていました。 ところがこのフォームにはそれらしき設定がまるでないのです。 それなのに数字以外の値、たとえば"a"などを入力すると 「このフィールドに入力した値が正しくありません。たとえば、数値型のフィールドに文字列を入力しました。」というメッセージをちゃんと表示し、誤った入力を受け付けません。 どなたかこの謎を解明してくださるとうれしいのですが。 前任者に直接聞けるといいのですが、その人は派遣社員でして契約終了後は連絡が取れないのです。
コンパイル済のVB6のプログラムからストアドプロシージャをCALLして いるのですが、実際にどのような値を渡しているのかを調べなければなりません。 VB6の開発環境があれば容易いのですが、現在実行環境しかない為ORACLE側での 調査が必要です。 全てのプロシージャに出力ロジックを追加すれば良いのですが、 数が多すぎて対応に困っております。 ツールや方法論等につきまして、どなたかご存知でしたらご教授頂けると助かります。 環境は以下の通りです。 Client: WindowsXP SP3 VB6で作成したEXE Server: Linux(Red hat linux) ORACLE 11g Standard PL/SQLで作成したStoredProcedure ちなみに、JdeveloperやOracle SQL Developerも調べて見たのですが、 お恥ずかしながら、今一理解が出来ませんでした。
sqlite3の動作が？xamppでは問題なく作動しますが、ロリポップサーバーではFatal errorがでます。ご教授お願い致します。 <?php $db = new SQLite3('fukurou.db'); try { $db = new SQLite3('fukurou.db'); } catch (Exception $e) { print 'DBへの接続でエラーが発生しました。<br>'; print $e->getTraceAsString(); } $results = $db->query('SELECT * FROM syouhin'); while ($row = $results->fetchArray()) { print $row['no']; print $row['name']; print $row['kakaku']; print '<br>'; } $db = new SQLite3('fukurou.db'); $db->close();
PL/SQLのバインド変数について調べていますが理解できず困っています。 [理解内容] 1．利点 　：SQL文の検索にバインド変数を利用すると、同一のSQLとして実行できる 　 ⇒ 繰り返し処理（ループ）では有効 ２．使用方法 　：静的SQL・動的SQLで使用可能　 　[疑問点] 　　静的SQLではバインド変数をどう宣言すればよいですか？ 　　[SQL*Plus]・[動的SQL]は例文がありました 　　●SQL*Plusでの宣言方法 　　　（例） 　　　　SQL> set null '<null>' 　　　　SQL> set head off 　　　　SQL> variable var_at_sqlplus number 　　●動的SQLの記述方法 　　　(例) 　　　　declare 　　　　　v_sql varchar2(256)； 　　　　　v_id varchar2(3)； 　　　　begin 　　　　　v_sql = 'select id into ：v_id from test'； 　　　　　execute immediate v_sql into v_id； 　　　　end; 　　●静的SQL　・・・【　エラーになる　】 　　　　declare 　　　　　variable v_id varchar2(3)； 　　　　begin 　　　　　select id into ：v_id from test' 　　　　end; どんな事でもかまいませんので回答よろしくお願いします
こんにちは。 ネットでAccessについて検索していると、アンチMSの人なのか、MSはAccessに対して、他のオフィス製品に比べると本気度が低いと見かけます。 素人ですが、2007から2010はそんなにかわった印象はありませんでした。 変化が少ないので、MSが本気じゃないと言っているのか真意はわかりませんが、疑問に思ったのが、MSはAccessに対して余り本気じゃないように見受けられるでしょうか？ 本気かどうかは置いておいて、非常に使いやすい、洗練されたツールだと私は思うのですが・・・
SQLite　バージョン3.7.10　を使用しています。 以下のようなテーブル構造で、 「t1」テーブルの全ての行と 「t6」テーブルのdateカラムの年の部分を グループ化して全ての組み合わせの 「t6」テーブルのamount の合計を出力したいのですが、 どのようなSQL文を書けば良いのでしょうか？ 例えばこのデータ内容なら、以下のような結果が得たいです。 +------+-------+-------+ |　year　|　t1_name　|　合計　| +------+-------+-------+ |　2011　|t1_name1|　　5000| +------+-------+------+ |　2012　|t1_name1|　10000| +------+-------+------+ |　2012　|t1_name2|　45000| +------+-------+------+ PRAGMA foreign_keys = ON; DROP TABLE IF EXISTS t6; DROP TABLE IF EXISTS t1; CREATE TABLE t1 ( key TEXT PRIMARY KEY NOT NULL, name TEXT NOT NULL UNIQUE ); INSERT INTO t1 (key, name) VALUES ('t1_key1', 't1_name1'); INSERT INTO t1 (key, name) VALUES ('t1_key2', 't1_name2'); CREATE TABLE t6 ( no INTEGER PRIMARY KEY AUTOINCREMENT, t1_key TEXT NOT NULL, date TEXT NOT NULL, amount INTEGER NOT NULL, FOREIGN KEY(t1_key) REFERENCES t1(key) ON DELETE CASCADE ); CREATE INDEX date on t6(date); INSERT INTO t6 (t1_key, date, amount) VALUES ('t1_key1', '2011-01-01', 5000); INSERT INTO t6 (t1_key, date, amount) VALUES ('t1_key1', '2012-01-01', 10000); INSERT INTO t6 (t1_key, date, amount) VALUES ('t1_key2', '2012-01-01', 15000); INSERT INTO t6 (t1_key, date, amount) VALUES ('t1_key2', '2012-02-01', 30000); http://ideone.com/I1mMba
別DBのデータを扱う場合、Oracle同士であれば普通DatabaseLinkという使い道があるかと思いますが・・・別製品のDBの場合調べたところやはりDatabaseLinkのような機能はないようだということがわかりました。 元データがOracleにあるとして別DBのデータをキーで一致させたデータのうち特定条件に適合したものをOracle側に反映させるといったことを検討しています。 なにかいい方法はないでしょうか？ よろしくお願いいたします。 （別DB・・・種類が多いのです。対象は、次の６種類です。　MySQL、PostgreSQL、SQLServer、DB２、HiRDB、Symfoware）
WebサイトのDBとしてMongoDBを使ってみようか迷っています。 「MongoDBは１レコードを更新する際、DB単位でロックする。」といった表現がちらほらネット上で散見されるため、ユーザによる更新が頻繁に発生するようなWEBサイト（SNS）でのMongoDBの使用をためらっています。 で、「MongoDBは１レコードを更新する際、DB単位でロックする。」とは本当でしょうか？ （「コレクション単位でロック」などの表現もみられるのですが、どっちにしろ、 頻繁にロックで待機がかかると実用性が乏しくなってしまう気がしています。） よろしくお願いいたします。
お世話になっております。 表題のテーマについて、理解いただける方にアドバイスお願いします。 会員を表すMembersというテーブル、 種別を表すTypesというテーブル、 会員と種別を結び付けるMemberTypeBindsというテーブルがあって、会員・種別がn対nで定義されています。 Membersの件数は200件ほど、Typeは20件程度。だいたいMembersは1～5くらいのTypeに紐づいています。 Table Members int ID(主キー, autoIncrement) varchar(20) MemberName Table Types int ID(主キー, autoIncrement) varchar(20) TypeName Table MemberTypeBinds int memberID(外部キー, MembersのID) int typeID(外部キー, TypesのID) これを、LINQで下記のクラスオブジェクトに抽出したいと思っています。 今は全件表示でもいいですが、そのうちページングで表示する必要がでてくると思います。 public class MemberTypes { 　public Member　member{ get; set; } 　public List<Type> types　{ get; set; } } どうやるかがわかりません。LINQはこんな感じだと思うのですが、 public List<MemberTypes> GetMemberTypes(){ 　using (var dc = new DataContext()){ 　　var result = dc.MemTypeBinds 　　　.GroupBy(mt=>mt.Member) 　　　// このあと、どうやったらいいかがわかりません。 　　　// DBから階層化オブジェクトを生成するのは 　　　// けっこう頻出のテーマだと思うので、しっかりマスターしたいです。 　　}).ToList(); 　　return result; 　} } LINQに詳しい方、お助けください。
最終的には以下のような「FLG1」、「FLG2」というカラムを追加したいです。 先頭はカラム名で、Excel上だと 　FLG1には　=IF(MOD(A2,2)=0,1,0) 　FLG2には　=IF(A2>=20,"L",IF(A2>=10,"M","S")) という数式が入っています。 V1FLG1FLG2 121M 50S 290L 301L 150M MySQLのデータベース上には、元々「tbl1」というテーブルに「V1」のカラムだけがある。 その「tbl1」に対して、新たに「FLG1」と「FLG2」というカラム（フラグ列）を追加したい。 というのが目的です。 現状だと（まだMySQL初心者のため）「V1」をそのままコピーし、UPDATEを使って、1つずつ条件判定して値を上書きしていく方法しかわかっていません。。。 例えばFLG2については以下のように（汗） UPDATE tbl1 SET FLG2='L' WHERE V1>=20 UPDATE tbl1 SET FLG2='M' WHERE V1>=10 AND V1<20 UPDATE tbl1 SET FLG2='L' WHERE V1>=0 AND V1<10 たぶんいくつかの方法があると思うのですが、基本的なものから難しい（ちょっとテクを必要とする）ものまで幅広く教えていただけるとありがたいです。そうすれば、それを今後勉強していけるので。
FileMakerで繰り返しフィールドの内容をまとめて消去するスクリプトを教えてください。 レコードを複製した時に、繰り返しフィールドの内容が全て不要な時があります。 繰り返し数が3個あると3回手作業で現在消しています。 繰り返しフィールドの横に消去用のボタンを作りまとめて、一度にまとめて内容を消去したいと考えています。 どのようなスクリプト組めばよろしいでしょうか？ 当方Intel iMac 2.66、Mac OS X 10.6スノーレパード FileMaker Ver10です。 よろしくお願いします。
ＳｑｌＳｅｒｖｅｒにおける、ビューとクエリについて、その違いというか、概念を教えてください。 私は、最初にＡｃｃｅｓｓと「標準ＳＱＬ」という本で、データベースを学びました。 本を読んでＡｃｃｅｓｓに向かったときに、クエリってビューのことなのかな？と思って、ずっとやってきました。 ところが、ＳｑｌＳｅｒｖｅｒには、両方の言葉が出てきます。で、とりあえず、クエリをデザイナで作ってみて、クエリにクエリを内包するようなものを作る段になって、クエリが追加できなことに気づきました。Ａｃｃｅｓｓでクエリのタブがあるところに、ビューというタブがあるので、クエリの代わりに、ビューを作りました。まったく同じ手順で作れましたが、保存するときに、「ＯｒｄｅｒＢｙ句は、ビュー定義のＴＯＰ句によって返される行を決定するためだけに使用されます。したがってクエリ自体でもＯｒｄｅｒＢｙが指定されていないと、ビューでクエリを実行したときに結果が並べ替えられ宇保証はありません。」 などと、表示されます。 ビューでクエリを実行するとは、どういう事なのでしょうか？クエリを実行するのと、ビューを実行(？)するのは、何か違うのでしょうか？
各ボタン毎にADODB.CONNECTIONと書いています AccessでVBAを書いています。 Formが3つあるとします。 ・Form1 ・Form2 ・Form3 各フォームにボタンが3個あるとします。 ・Btn1 ・Btn2 ・Btn3 各ボタンをクリックすると、テーブルの更新・追加・削除等の振る舞いをします。 そこで問題が、私は各ボタンのイベント毎に、下記のようなコードを必ず書いています。 フォームが3つ、ボタンが3つの計9つのイベントに書いています。 Dim objADOCON As ADODB.Connection Dim objADORS As ADODB.Recordset Set objADOCON = Application.CurrentProject.Connection Set objADORS = New ADODB.Recordset objADORS.Open "T", objADOCON, adOpenDynamic, adLockOptimistic objADORS.Close objADOCON.Close Set objADORS = Nothing Set objADOCON = Nothing 書いているうちに、同じ事を書いているので無駄のような気がしてきました。 これを解決するには何か良い方法はないでしょうか？ 自分で書いていて無駄だなと思っています・・・
SQLserverにデータを入れる際、現在存在しているテーブルとは型があっていない列があります。 このとき、キャストをしながらインサートを同時に行いたいのですが、どのようなクエリを書けばいいかわかりません。教えてください。
SQL素人ですが、SQLが使えるツールからデータを抽出したく、SQL文を教えていただけますでしょうか。 ・テーブルA：会員データが格納されている（氏名、メルアド、郵便番号等が入っている） ・テーブルB：特定の郵便番号のみが入っている テーブルAのデータの中からテーブルBに入っている郵便番号に合致するメルアドを抽出したい。 何卒宜しくお願い申し上げます。
いつもお世話になっております。 Access2000（OSはWindowsXP）で作った販売管理システムのスタートメニューを起動させたら、他のAccessファイル（顧客管理）にあるテーブル（住所録）の有無をチェックして、存在していればリンクし、存在していなければスタートメニューの処理を終了させるプログラムを作成中です。 VBAで記述したく、インターネットを調べて下記のように書きました。 途中までの記述ですが、住所録テーブルの有無（場合によっては顧客管理ファイルの有無でも構いませんが）を判断して、これらの処理をするには、どのように記述すればよいか教えて頂きたく思います。 なお、データ（またはファイル）が存在していない場合には、「存在していません」のようなメッセージを出したく思います。 基本的なことかも知れませんが、宜しくお願い致します。 ------------------------------------------------------------ '[接続] '(前に残ってたら消す、残ってなかったらエラーは Resume Next で飛ばす) On Error Resume Next DoCmd.DeleteObject acTable, "リンクテーブル1" On Error GoTo 0 '(再接続) DoCmd.TransferDatabase acLink, "Microsoft Access", "c:\顧客管理.mdb", acTable, "MT住所録", "リンクテーブル1", False '[切り離し] 'DoCmd.DeleteObject acTable, "リンクテーブル1"
SQL Serverについて学習中です。 認証方法の違いについてご教示ください。 SQL Serverには「Windows認証」と「SQL Server認証」の二つの認証方法があるところまでは理解したのですが、ネット検索や手元の資料をみても具体的なものが見えてきません。 (1)「Windows認証」でSQL Serverに接続するには： クライアントPCのWindowsアカウント名／パスワードが、SQL ServerがインストールされているPCに登録されているWindowsのユーザー名／パスワードと一致している必要がある。（一致していても、SQL Serverの設定で接続を拒否されていると接続できない） (2)「SQL Server認証」でSQL Serverに接続するには： SQL Serverの「ログイン」（←Windowsのアカウントではない）に登録されているユーザー名／パスワードと一致すれば、クライアントPCのWindowsアカウントのユーザー名／パスワードが何であっても、データベースに接続できる。 認証方法の違いについては、上記このような理解でよいのでしょうか？？ しかし実際には「SQL Server認証」を選択すると、SQL Serverのユーザー名／パスワードだけでなく、Windowsアカウント名／パスワードも一致していないと接続できないように思えます。 つまり 「Windows認証」は「Windows認証だけ」で 「SQL Server認証」は「Windows認証 + SQL Server認証」（両方一致しないといけない） なのではないかという気がしています。 VBやVC#等でローカルアプリを作って複数で使用したいのですが、クライアントPCのアカウント名まで管理するのは厄介です。XPパソコンをAdministratorで使用している人がたくさんいて、Windows認証をクリアできないからです。 クライアントPCのアカウント名やパスワードに関係なく、SQL Serverに登録されたユーザー名／パスワードだけで接続するには、どうしたらよいのでしょうか？ よくわかっていないので、よくわからない質問になってしまっていると思いますが、よろしくお願いします。 質問の意味がわからないところは補足しますので、ご指摘ください。
バックアップに別サーバに同じＯＲＡＣＬＥテーブルを作成することとなりました。 どんなＳＱＬでそのテーブルを作成したのか資料が無くてわかりません。 調べる方法を教えてください。よろしくお願いします。
sqlplusにてbatファイルを起動するだけで前月のデータを取得しようとしていますが、 ネットで検索等してもなかなかうまく行きません。 以下のようにbatファイルを起動すると、常に前月のT_URIのデータを取得させたいのですが、 どのようにすれば宜しいでしょうか？ご教示頂けると助かります。（期間の日付をじかに入力すれば、取得できたのですが、同じように取得したいテーブルが複数あるので） 月初日は常に1日、月末日は常に31日にして、前月をbatファイルかsqlファイル上で計算させる方法はないのでしょうか？ （会社の業務でoracleのデータベースから抜き出そうとしています。） SQLPLUS ABCD/ABCD@ORACLE.XYZ.WW @0031_ymd.sql PAUSE ↓0031_ymd.sql set heading on set echo off set underline off set termout off set pause off set pagesize 0 set trimspool on set feedback off set termout off set linesize 1000 set lines 30000 spool D:\hoge.csv SELECT * FROM T_URI S WHERE AND S.KJN_YMD >= yyyymmdd AND S.KJN_YMD <= yyyymmdd
accessの処理が遅く困っています。 何か良い解決方法があればご教授お願いいたします。 まずは現状を説明いたします。 仕事でaccessを使用していますのでどこまで話していいのか迷うとこですがなるべく詳しく書きたいと思います。 まずは私の現状を ・accessは利用歴半年ほどでまだまだ全然理解していない ・職場で必要に迫られて独学で勉強しています ・私的には頑張ってネットや書籍で色々と調べてみました 仕事場で行なっていること ・職場の基幹システム（これが何で作られているとかはさっぱり分かりません）は次のようなデータを処理しています。顧客データ、在庫管理、作業履歴、入出庫管理などなど ・上記の基幹システムが毎日「データ」という名前の圧縮ファイルを本社サーバにエクスポート？していきます ・私はのそ「データ」という圧縮ファイルを使って作業を（主にデータ分析）を行なっています ・「データ」を回答すると「データ１」「データ２」「データ３」「データ４」という４つのMDBファイルが出てきます ・私はその「データ１～４」のMDBファイルを自分の支店の共有フォルダにコピーして作業を行なっている ・ローカルのPC上ではなくネットワーク上にファイルを置くのは、支店内の全員のパソコンからアクセス出来るようにとのことです 問題となっている処理に時間のかかる処理内容というのが クエリを多重で行う（言い方が合っているのか？＾＾；）ということを５段位行っています 遅いのは当たり前というのはわかって入るのですが、１度のクエリで目的のものを表示させられないので結果こうなりました（ーー； 他にも遅くなっている理由があります 「データ１」などの元となるMDBファイルに入っているテーブルを全てリンクデーブルで参照しています（言い方あってるかな？） なぜ普通にインポートして使わないのかという理由を説明します。 ・「データ」というファイルは毎日、新しくシステムから落ちてきます ・私としては毎日行うクエリを再利用したい ・「データ１」というファイルをある場所に置いておき、自分のデスクトップにMDBファイルを作成し（これを作業ファイルと呼ぶ）、そこに「データ１」の中のデーブルをリンクさせておく。 そして作業ファイル内にクエリを作製する あとは毎日の新しい「データ」ファイルを過去のファイル（作業ファイルにインポートしたリンク先）に上書き保存する。 こうすることでクエリを作製し直さないで同じクエリを再利用し、表示されるデータは毎日最新をキープする。これが理由なんです。 （本当は作業ファイルもネットワーク上に置きたいのです、というか置いていました。しかし遅すぎるため今は取り敢えずデスクトップ上に置いています） しかしこのクエリが多重で行われているためか結果を表示するのに３分～５分かかります。 これを早くしたいのです。 上記の方法におかしな所や、こうしたほうがより早くなるなどのアドバイスがあればお願いします。 そして別件ですが、こういった状況ですので個人的に色々調べてみました。 どうもaccessは大きなデータには向いていない？というような情報を目にします。 「データ１」などのMDBファイルにあるデーブルは１００万行などのテーブルもあります。 MDBファイルの容量も2GBギリギリです。 こういう場合はMYSQLやsqliteなどを使用したほうが良いのでしょうか？ そういったものを使用した場合は今のaccessのようにGUIで簡単にクエリなどを作成できますでしょうか？ そういたものを使用してMDBファイルを扱えるのでしょうか？ 非常に分かりにくい質問で申し訳ございませんが宜しくお願い致します。
こんにちは、 A,Bテーブルがあり、Aテーブル.ID = Bテーブル.IDの状態で ＩＤごとの最新の更新時間を一件づつ取得したいのですが SQLで抽出することは可能でしょうか？ 取得したい例------------------ ＩＤ、ＴＩＭＥ(タイムスタンプ) １、1356200000 ２、1356228139 Aテーブル---------- ＩＤ 1 2 Bテーブル---------- ＩＤ、ＴＩＭＥ(タイムスタンプ) １、1350000000 １、1356200000 １、1300000000 ２、1356228139 ２、1356000000
SQL Server 2008R2のテーブル（データベース）をWindows 2000に置いて、WinXPやWin7でアクセスしたいのですができますか？ ご教授願います。
DBLINKを使用して、Oracle 10gからSQLServer2005に接続してSQLServer2005のテーブルを参照しています。テーブルデータを参照することはできるのですが、データベースとのセッションを切断してもサーバ上にhsodbcプロセスが解放されずに残る現象が発生しています。 当初は、ストアドプロシージャの不具合と考えていましたが、SQLPLUSでデータを参照した後、SQLPLUSを終了させても プロセスマネージャ上でhsodbcが解放されずに残っていたため、 APの問題ではないと考えています。 DBLINK、Oracleの設定で不備があるような気がするのですが対応策はあるのでしょうか。 お手数ですが回答をお願いします。
access2007・Microsoft SQL Server 2012です。 アクセスからアップサイズしようとすると、 「アップサイジング ウィザードは Accessプロジェクトの接続先であるMicrosoft SQL Server のバージョンでは使用できません。 最新情報とダウンロードについては、Microsoft office　UpdateのWebサイトを参照してください。」 http://support.microsoft.com/kb/967913/ja を見たのですが、この場合は、SQL Server 2008でした。 当方は2012です。 なんでできないのでしょうか？
あるＳＱＬを実行した結果 ある集計行(X1)が出るとします。 集計行(X1) ------- 12 15 23 24 28 31 45 47 ------- ここで、集計行の左の数字でグルーピングして、その中のもっとも小さい数字を 集計行の横に出すとします。（行数は変わりません） 集計行(X1),項目2 ------- 12　,12 15　,12 23　,23 24　,23 28　,23 31　,31 45　,45 47　,45 ------- もとのＳＱＬを 「select X1 from zz where 条件１」 とした場合、どのようにすればこの結果が得られるでしょう？
あるカテゴリーの商品詳細ページで前後詳細ページへのリンクを設けたいのですが、 後ろページの取得は上手くいきますが、前のページの取得がうまくいきません。 カテゴリーと商品は別テーブルで関連付けテーブルで紐づけさせてます。 PHP+MySQLで構築中です。 ・カテゴリー関連付けテーブル(catgory_term) --------------- | category_id | id | --------------- ・商品テーブルテーブル（items） ----------------------- | id | title | url | ・・・・・・・・・ ----------------------- SQL文は下記のような感じです。（並び順でもSQL内容は変わります.。下記の例は商品ID降順） SELECT items.title,items.id,items.url,MIN(items.id) FROM category_term Left JOIN items ON category_term.id = items.id WHERE category_term.category_id = 'カテゴリーID' AND items.status = 'publish' AND items.id > '商品ID' お手数をおかけしますがご教授いただける幸いです。
2つのテーブルのレコード数をカウントする方法を教えてください。 $sql = "SELECT * FROM テーブル1 and テーブル2"; $res = mysql_query($sql,$myLink); $num_k = mysql_num_rows($res); こんな感じでカウントできるかと思ったのですが出来ませんでした。 宜しくお願い致します。
ＬＡＮで繋がれていないパソコン同士でデータベースを共有したくてググったら http://office.microsoft.com/ja-jp/access-help/HA … を発見したのですが、これって 「ＬＡＮで繋がれていないパソコン同士でデータベースを共有したい」 が出来ると言う解釈でいいのでしょうか？ また、accessは２００７までしか持ってないのですが2010に買い替えないとできないのでしょうか？
こんばんは。 Oracle 11gデータベースのいくつかのテーブルを Microsoft Access 2000のテーブルにコピーしたいのですが お勧めのフリーソフトはございますでしょうか？
初心者です。 SQL SERVER 2012です。 「売上明細」テーブルに、新規行を挿入した時に、「得意先単価マスタ」を更新・または追加したい CREATE TRIGGER [dbo].[INSTEAD_OF_INSERT_ON_T_D売上明細] ON [dbo].[T_D売上明細] INSTEAD OF INSERT <<省略>> /* 得意先別単価マスタの更新 */ IF (@column_new_value$19 <> 0) BEGIN /* 得意先別単価マスタを参照する */ SET @CURSOR_PARAM_CRSTS_CRSTS_得意先コード = @column_new_value$9 SET @CURSOR_PARAM_CRSTS_CRSTS_納品先コード = @column_new_value$10 SET @CURSOR_PARAM_CRSTS_CRSTS_商品コード = @column_new_value$16 DECLARE crsTS CURSOR LOCAL SCROLL_LOCKS FOR SELECT dbo.T_M得意先別単価.作成日付, dbo.T_M得意先別単価.更新日付, dbo.T_M得意先別単価.得意先コード, dbo.T_M得意先別単価.納品先コード, dbo.T_M得意先別単価.商品コード, dbo.T_M得意先別単価.単価区分, dbo.T_M得意先別単価.売上単価1, dbo.T_M得意先別単価.売上単価2, FROM dbo.T_M得意先別単価 WHERE ((dbo.T_M得意先別単価.得意先コード = @CURSOR_PARAM_CRSTS_CRSTS_得意先コード) AND (dbo.T_M得意先別単価.納品先コード = @CURSOR_PARAM_CRSTS_CRSTS_納品先コード) AND (dbo.T_M得意先別単価.商品コード = @CURSOR_PARAM_CRSTS_CRSTS_商品コード)) OPEN crsTS FETCH NEXT FROM crsTS INTO @recTS$作成日付, @recTS$更新日付, @recTS$得意先コード, @recTS$納品先コード, @recTS$商品コード, @recTS$単価区分, @recTS$売上単価1, @recTS$売上単価2 /* 該当が有った場合は更新する */ IF (@@FETCH_STATUS = 0) IF (@column_new_value$19 = 1) UPDATE dbo.T_M得意先別単価 SET dbo.T_M得意先別単価.単価区分 = @column_new_value$19, dbo.T_M得意先別単価.売上単価1 = @column_new_value$22 WHERE CURRENT OF crsTS ELSE IF (@column_new_value$19 = 2) UPDATE dbo.T_M得意先別単価 SET dbo.T_M得意先別単価.単価区分 = @column_new_value$19, dbo.T_M得意先別単価.売上単価2 = @column_new_value$22 WHERE CURRENT OF crsTS ELSE IF (@column_new_value$19 = 1) INSERT INTO dbo.T_M得意先別単価 ( dbo.T_M得意先別単価.得意先コード, dbo.T_M得意先別単価.納品先コード, dbo.T_M得意先別単価.商品コード, dbo.T_M得意先別単価.単価区分, dbo.T_M得意先別単価.売上単価1 ) VALUES ( @column_new_value$9, @column_new_value$10, @column_new_value$16, @column_new_value$19, @column_new_value$22 ); ELSE IF (@column_new_value$19 = 2) INSERT INTO dbo.T_M得意先別単価 ( dbo.T_M得意先別単価.得意先コード, dbo.T_M得意先別単価.納品先コード, dbo.T_M得意先別単価.商品コード, dbo.T_M得意先別単価.単価区分, dbo.T_M得意先別単価.売上単価2 ) VALUES ( @column_new_value$9, @column_new_value$10, @column_new_value$16, @column_new_value$19, @column_new_value$22 ); CLOSE crsTS DEALLOCATE crsTS <<省略>> 上記のように作成してあるのですが、 すでに同一得意先・納品先・商品のマスタが存在する場合は、更新されます。 ですが、存在しない場合、新規に追加したいのですが、そこがうまく動きません。 何が原因でしょうか？
MySQLのSET型のそれぞれの値に JOINする方法はありますでしょうか？ 内容は下記のような感じです。 < shohin > group(varchar) | item(SET) ------------------------------------- 果物群A | 1,3 ------------------------------------- 果物群B | 2,4 ------------------------------------- < kudamono > id(INT) | kudamono(varchar) -------------------------------- 1 | りんご -------------------------------- 2 | オレンジ -------------------------------- 3 | いちご -------------------------------- 4 | メロン -------------------------------- このような構造の中で 果物群A ... りんご, いちご 果物群B ... オレンジ, メロン とphpで出力したいという内容です。 現状ではshohinからselectでitemの値を呼び出し、 一度、explodeで配列化して、それをfor文でSELECTをかけて、 さらにそこから得られたkudamonoを再度implodeする という回りくどい方法しか考え付きません。 よろしくお願いいたします。
ご覧いただき、ありがとうございます。 Access2010を使用している初心者です。レポート2枚を作成しています。 3点、お聞きしたいことがあります。 お分かりになる部分だけでも結構ですので、どなたかご教授いただけますでしょうか？ ********* （1）　グループ化で特定のレコードを除外して表示 レポート名：レポート2　／　レコードソース：テーブルI 使用するフィールド：依頼者ID、曜日、項目名 --- 曜日 ヘッダー --- 　　[曜日] --- 項目名 ヘッダー --- 　　★[項目名]　　　　　　　＜[項目名]A-Dの各件数＞　=Count([項目名])　 --- レポート　フッター --- 　　E　　　　　　　　　　　　　＜[項目名]がEの件数＞　=Sum(IIf([項目名]="E",1,0)) 　 ひと月の項目名と件数を下方向に並べます。 この時、項目名A,B,C,Dがあり、Eを除外して表示したいです。 ＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾ また、そのレポート内の下部で、グループ化せずにEの集計も行いたいのです。 ＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾＾ …　★の式を、=iif([項目名]<>"E",null ,[項目名])　としたら循環参照となってしまいます。 …　テーブルIから作ったA-DおよびEのみの選択クエリ、またはテーブルIとEのみの選択クエリに分けて、レコードソースに追加し、参照先を分けようとしましたが、「指定されたフィールド '[項目名]' が SQLステートメントのfrom句にある複数のテーブルを参照しました」とエラーが出ます。 ********* （2）　実人数のカウント レポート名：レポート2　／　レコードソース：テーブルI 使用するフィールド：担当者名、依頼者名、会員、項目名 --- レポート　ヘッダー --- ＜「項目名」A-Dの総件数＞ 　=Count([担当者])-Sum(IIf([項目名]="E",1,0)) ★＜「項目名」A-Dの依頼者実人数＞　 ＜A-Dで「会員」フィールドが null の総件数＞ 　=Sum(IIf([依頼者名]<>"" And [会員]="",1,0))-Sum(IIf([項目名]="E" And [会員]="",1,0)) ★＜A-Dで「会員」フィールドが null の依頼者実人数＞ ＜A-Dで「会員」フィールドが　1　の総件数＞ 　=Sum(IIf([依頼者名]<>"" And [会員]="1",1,0))-Sum(IIf([項目名]="E" And [会員]="1",1,0)) ★＜A-Dで「会員」フィールドが　1　の総件数＞ ひと月の項目名をフィールド「会員」で分けて集計します。 実人数はクロス集計クエリを参照して、手入力すれば解決しますが、できれば自動的に行いたいです。 ********* (3)　グループ内での任意の並べ替え レポート名：レポート2　／　レコードソース：テーブルI　／　使用するフィールド：担当者名、依頼者名、会員 ---　担当者　ヘッダー　--- ＜A-Dでの担当者＞ 　★[担当者]　　　　　　　　　　 --- 依頼者名　ヘッダー　--- --- 項目名　ヘッダー　--- ＜A-Dでの依頼者＞ 　[依頼者名]　　　　　　　[項目名]　　　　　　　　　＜各依頼者、各項目名の件数＞ ---　担当者　フッター　--- 　＜担当者ごとの総件数＞　=Count([担当者])-Sum(IIf([項目名]="E",1,0)) レポート1の問題を踏まえ、一応、項目名Eを除外して集計しています（現時点で未解決） ここでは、担当者の並び替えを任意に行いたいです。 昇順や降順ではなく、例えばあ・い・う・え・おを、い・う・あ・お・えのように並べたいのです。
Microsoft SQL Server 2012 をインストールしたいのですが、 既定のインスタンスと名前付きインスタンスのどちらを選べばいいのでしょうか？ ＳＱＬサーバーは初心者です。
SQLite3をPHPで使用しています。 ネットでいろいろ見たのですがわかりませんでしたのでこちらで質問させて頂きました。 SELECTで条件に合うidを抽出した場合にその行数を取得したいのですが、どのようにするとスマートに取得できるのでしょうか？ スマートにというのは「データベースへのアクセスが一度で済むような」という意味です。抽出データの取得と件数の取得が一度のアクセスで可能なのでしょうか？ $pdo = new PDO(sqlite:test.db); $query = $pdo->prepare('SELECT id FROM testTable WHERE id > 0 AND id < 10'); $query->execute(); 私が現在行なっているのは、データ抽出は上記のコードでやって、件数の取得は以下のようにしています。 $query = $pdo->prepare('SELECT count(*) FROM testTable WHERE id > 0 AND id < 10'); $query->execute(); $num = $query->fetch(PDO::FETCH_NUM); echo $num[0]; ネットで調べてもMySQLやPostgreSQLのことしか載っていなく、なかなかSQLite3での取得方法がわかりません。 お手数ですが教えて頂ければと思います。よろしくお願い致します。
Mysqlで大文字と小文字を区別するように、特定のカラムにBINARYを設定しましたが、逆に、それを解除(削除)する方法はありますでしょうか？ BINARYの設定の方法は多くのサイトで見つけられましたが、削除の方法は分かりませんでした。 どなたかよろしくお願いします。
mysql初心者です。 検索語句（search）で部分一致するものを、名前(name）と更新日（update）でユニーク指定し、修正日(time)が最新のものだけを表示させたいのですが、望む結果が得られません…。 　SELECT * FROM db WHERE name LIKE \"%{$search}%\" GROUP BY name,update までは正しいと思うのですが、さらにtimeの最新を指定する方法を教えていただけませんか？ よろしくお願いします。 いろいろ探して試行錯誤し、以下に行きついたのですが、部分一致がうまく機能しない時があります。（情報不足などあればご指摘ください。） SELECT * FROM db where (time) in (SELECT MAX(time) FROM db WHERE name LIKE \"%{$search}%\" GROUP BY name,update) （中略・件数を取得しページャーに使っています） SELECT * FROM db where (time) in (SELECT MAX(time) FROM db WHERE name LIKE \"%{$search}%\" GROUP BY name,update) ORDER BY time DESC LIMIT $start,10 （中略・whileとmysql_fetch_arrayで表示させています）
Oracle11gを使用しています。 制約と同じようにINDEXも無効化することは出来るのでしょうか。 テーブル名と、フラグ（無効化/有効化）を引数として、制約、INDEXの無効化、有効化 を行うプログラムを作成したいと考えています。 制約は、「ALTER TARBLE テーブル名 DISABLE(又はENABLE ) CONSTRAINT 制約名」 にて無効化、有効化することが出来ますが、INDEXも同じように無効化、有効化することは 出来るのでしょうか？ よろしくお願いします。
Microsoft® SQL Server® 2012 Express をインストールしたいのですが http://www.microsoft.com/ja-jp/download/details. … のどれをインストールすればいいのでしょうか？ 当方ｗｉｎ７、６４bitです。 JPN\x64\SQLEXPR_x64_JPN.exe JPN\x64\SQLEXPRADV_x64_JPN.exe JPN\x64\SQLEXPRWT_x64_JPN.exe のどれかと思うのですがわかりません。 ちなみにプログラムの一覧をみると、 画像のようにSQL Serverの一部？みたいなのが入っています。
管理番号　　試験時間　　開始日付　　終了日付 　 1 　　　　24 2012/1/1 　 2012/1/2 2 48 2012/1/1 2012/1/3 1 24 2012/1/2 2012/1/3 　2 48 2012/1/3 2012/1/5 3 24 2012/1/1 2012/1/2 こういうデータから例えば、管理番号1を抽出して 管理番号　　試験時間　　累計　　開始日付　　終了日付 　 1 24 24 2012/1/1 2012/1/2 1 24 48 2012/1/2 2012/1/3 となるようにしたいのですが、 どなたか教えていただけませんでしょうか。 よろしくお願いします。
社員の生年月日から、今日から、１ヶ月間の誕生日対象者を、誕生日順に出力したいです。 SELECT memname, REPLACE(membirth, "-", "/") as mbirth, REPLACE(RIGHT(membirth, 5), "-", "") as cdate, DATE_FORMAT(membirth, "%c月%e日") as birday FROM MEMDB ORDER BY cdate membirthは、生年月日（例1989-01-01) cdate順にsortしたら、１２月の人より、１月の人が先に出ます。 １２月の人の次に１月の人が出るようにしたいですが。。。 あと、 検索条件も WHERE RIGHT(CURDATE(),5)=RIGHT(mbirth,5) OR RIGHT(DATE_ADD(CURDATE(), INTERVAL 1 DAY),5)=RIGHT(mbirth,5) OR RIGHT(DATE_ADD(CURDATE(), INTERVAL 2 DAY),5)=RIGHT(mbirth,5) OR ... みたいに、INTERVAL 30　DAYまででチェックしてますが、 正しい方法があれば、お教えてください。
検索する文字列のデータが空の場合もその対象にするには、 SELECT * FROM `table` WHERE 1 AND `s1`='あああああ' AND `s2` IN('いいいいい',NULL) のようにするのでしょうか？ 数値の場合はデータが無いのを0で表現すれば、 SELECT * FROM `table` WHERE 1 AND `m1`<=100 AND `m2`<=250 で良いですよね？
MySQL 5.5.27, mysql-connector-java 5.1.12を用いて，MySQLにアクセスしています． しばらくは動いているのですが，時間が経つと，以下のようなエラーを吐いて止まってしまいます． 関連するコードは以下の通りです． https://gist.github.com/4243576 どなたか解決法が分かる方がいらっしゃいましたら，よろしくお願い致します． ----以下エラーコードです (行数はコードと対応しておりません． エラーコードの39行目に当たるのがgistの35行目， 287行目に当たるのがgistの46行目 291行目に当たるのがgistの50行目 になります．) com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link fai lure The last packet sent successfully to the server was 0 milliseconds ago. The driv er has not received any packets from the server. at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Sou rce) at java.lang.reflect.Constructor.newInstance(Unknown Source) at com.mysql.jdbc.Util.handleNewInstance(Util.java:409) at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1 122) at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2260) at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:787) at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:49) at sun.reflect.GeneratedConstructorAccessor10.newInstance(Unknown Source ) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Sou rce) at java.lang.reflect.Constructor.newInstance(Unknown Source) at com.mysql.jdbc.Util.handleNewInstance(Util.java:409) at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:357) at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java :285) at java.sql.DriverManager.getConnection(Unknown Source) at java.sql.DriverManager.getConnection(Unknown Source) at botan.DBManager.connect(DBManager.java:39) at botan.DBManager.insertStatusIdsLong(DBManager.java:287) Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communicatio ns link failure The last packet sent successfully to the server was 0 milliseconds ago. The driv er has not received any packets from the server. at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Sou rce) at java.lang.reflect.Constructor.newInstance(Unknown Source) at com.mysql.jdbc.Util.handleNewInstance(Util.java:409) at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1 122) at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:344) at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2181) ... 16 more Caused by: java.net.SocketException: No buffer space available (maximum connecti ons reached?): connect at java.net.PlainSocketImpl.socketConnect(Native Method) at java.net.PlainSocketImpl.doConnect(Unknown Source) at java.net.PlainSocketImpl.connectToAddress(Unknown Source) at java.net.PlainSocketImpl.connect(Unknown Source) at java.net.SocksSocketImpl.connect(Unknown Source) at java.net.Socket.connect(Unknown Source) at java.net.Socket.connect(Unknown Source) at java.net.Socket.<init>(Unknown Source) at java.net.Socket.<init>(Unknown Source) at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.ja va:256) at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:293) ... 17 more Exception in thread "main" java.lang.NullPointerException at botan.DBManager.insertStatusIdsLong(DBManager.java:291)
会社で使用しているパソコンの中で、３台に同じツールを入れ使用しており動作については何も問題なく使用できているのですが、その中の２台のパソコンについてはファンクション１１（F11)キー押下によりデータベースオブジェクト（テーブル、クエリ、フォーム、レポート・・・）を表示することができるのですが、１台はファンクション１１（F11)キーを押下しても表示しません。 何か設定があるのでしょうか？ オブジェクトの一部変更を行いたいのですが表示することができなく困っています。 回答よろしくお願いいたします。
表計算の問題で 平均売価=売上額÷売上数（整数未満四捨五入の表示） というのが出たのですが ネットで調べても難しく、どうやればいいのかさっぱり分かりません・・・。 できるだけ詳しく簡単に教えていただけないでしょうか。
下記画像の社員出身マスタのようなDBがあるとします。 会社だとこれが非常に複雑になり、さらに専門家に結合してもらわないと誰も分かりません。大変な労力です。これが大型DBになると数百のコードマスタとなり、コードマスタとマスタの突合せはともあれ、コードマスタ同士の突合せもあり、重複や入力ミスや勘違いが多発しています。 「山田,青森,青森」と言った感じでは駄目でしょうか。 どうせプログラムで入力チェックしていますし、ラジオボタンで選択する等、入力ミスが起こるはずがありません。いざとなればそこにパキスタンと手入力しても問題なさそうですし、大掛かりなシステム改編作業が減ると思いますが。 何のためにどこの会社もこういう複雑な設計になっているのでしょうか。
selectで抽出したデータの特定カラムのデータを空にしたいのですが、どのような方法がありますでしょうか。 以下のようなofficeテーブルがありまして、データは1万件あったとします。 id　name　place　 1　浅谷　大阪 2　亀山 東京 3　武本 名古屋 placeカラムに東京を含むidが5000未満のデータを抽出し、そのデータのplaceカラムをすべて空に（削除）したいと思っています。 SELECT * FROM office WHERE place like '%東京%' and id < 5000 order by id asc; 上記のselect構文で希望データを抽出することはできたのですが、その抽出したデータのplaceカラムを空に（データを削除）する方法が分かりません。 アドバイス頂けると助かります。 よろしくお願いいたします。
VisualStudio2010でwebアプリを作成しています。 クエリビルダでSQL文を作成しSQLサーバにアクセスしています。 このＳＱＬ文でわからない点があります。 列１、列２、列３のフィールドを持つテーブルがあるとします。 ドロップダウンリストで選択した項目により、ある時は列１だけ取得し ある時は列２だけ取得し、ある時は列３だけ取得する様なＳＱＬ文を作りたいのですが、どうすればよいかわかりません、列名を変数にできればよさそうなんですが、そんなことできますか？ ある時は SELECT 列１　FROM table1 ある時は SELECT 列2　FROM table1 ある時は SELECT 列3　FROM table1 としたいので 　　SELECT @列名 FROM table @列名は変数のつもりです。 このようにできればよいと思っていますが・・・ よろしくおねがいします
はじめまして。 Oracle11gで開発しています。 初歩の初歩の質問なのですが。 下記のように複数のレコードをまとめて、 INSERT先のテーブル(レコードを１個に)に入れ込むまでの処理です。 全てNUMBER型のテーブル列で、NOT NULL制御を施しています。 そのようにすれば、明示的にNULLは無くなり、「0」がデフォルトになると思ったのですが、 「tb_trn_aa_day_r.tx_00」はNULLのままでした。 初期化の「tb_trn_aa_day_r := null;」がまずいのでしょうか？ ちなみに、tb_trn_aa_day_r.tx_00～tx_23に「0」をセットしてもなぜか、NULLとなり、 「tb_trn_aa_day_r.tx_sum」が全てNULLとなってしまいます。 初期j化はどのようにすべきでしょうか？ よろしくお願いします。 /* Aデータ初期化 */ tb_trn_aa_day_r := null; IF c_aa_data_r.hour = '00' THEN tb_trn_aa_day_r.tx_00 := TO_NUMBER2(c_aa_data_r.tx); ELSIF c_aa_data_r.hour = '01' THEN tb_trn_aa_day_r.tx_01 := TO_NUMBER2(c_aa_data_r.tx); ELSIF c_aa_data_r.hour = '02' THEN tb_trn_aa_day_r.tx_02 := TO_NUMBER2(c_aa_data_r.tx); ELSIF c_aa_data_r.hour = '03' THEN tb_trn_aa_day_r.tx_03 := TO_NUMBER2(c_aa_data_r.tx); ..... ELSIF c_aa_data_r.hour = '23' THEN tb_trn_aa_day_r.tx_23 := TO_NUMBER2(c_aa_data_r.tx); END IF; dbms_output.put_line(tb_trn_aa_day_r.tx_00); /* 集計データ */ tb_trn_aa_day_r.tx_sum := TO_NUMBER2(tb_trn_aa_day_r.tx_sum) + TO_NUMBER2(c_aa_data_r.tx); /* INSERT処理 */ CREATE OR REPLACE function SYNONIM.TO_NUMBER2(str varchar2) return number is begin return to_number(str); exception when others then dbms_output.put_line('TO_NUMBER2 error: ' || SQLERRM); return 0; end; /
VisualBasic 2010 よりOracle7へ接続しようと考えております。 ※普通ならばOracleのバージョンを上げたほうがよいのは理解しています。 上記の接続方法としてどのようなものがありますでしょうか？。 現在はODBCで接続していますが、接続が遅くて改善できないものかと悩んでおります。 どなたかODBCよりも早く接続できる方法をご存知に方がいらっしゃいましたら ご教授お願い致します。
SSRSを使用しています。 検索SQL-A があるとき。 パラメータによってその結果にDISTINCTを入れたい場合の処置として。 どのようなことを追記すればよろしいでしょうか。 ざっくりとした質問で申し訳ありませんが。 ご教授の程よろしくお願いいたします。
いっも明確な回答を頂き助かっております。今回もよろしくお願いいたします。 チェックボックスで選択した条件で同じフォームに作成したリストボックスを表示したり非表示にしたり切替を行いたいのですが可能でしょうか？
データを年度の古い順に保存。 誤っているデータは、noを修正したい。 ●現在のデータ codenoyear --------------- 10112012 10122008 10132010 ↓ 正しくは、 ●正しいデータ codenoyear --------------- 10112008 10122010 10132012 この場合、誤ったデータを検索するSELECT文はどのように書くのが良いでしょうか？ 誤ったデータがある、codeを検索。 noの数字を修正、となります。 わかる方がいましたら教えて下さい。
はじめまして 皆様の知恵を貸してください mysqlでの質問なのですが、 簡潔にいうと日付が比較できません。 どういうことをしたいのかというとsqlからwhere文で今の日付より大きいもデータを抽出するということです データベースの構造は id int型 endtime datetime型 で構成されています endtimeには既にいくつかのdatetime型の値が入っています 例えば　2012-12-14 09:18:00 のように入っています でGETDATE()関数を使って今現在の時刻より未来のものだけ抽出するために convert関数を使って一度varchar型に変換することで比較しようとしました 色々インターネットで調べた結果次のような文なのではないかと考えました select id,endtime from [データベース名] where CONVERT(VARCHAR,endtime,121)>=CONVERT(VARCHAR,getdate(),121); しかし実行ができません 比較する方法を教えて欲しいです
ユーザー側で、Microsoft SQL Server2000を使用しています。 計算結果がおかしいので、仕事場で、SQL2008環境で互換モードでも、以下の現象が出てこまって おります。テストで、確認しました。 23.0 - 22.1 の計算結果を0.9と出したいのですが、 　0.899999999999999 と結果が返ってきます。 どこが間違っているのでしょうか？ SELECT [Field01] AS 'Field01' ,[Field02] AS 'Field02' ,[Field01]-[Field02] AS 'Field01-02' ,(CAST(23 AS FLOAT) - cast(22.1 AS FLOAT) ) AS 'test1' ,(CAST(23 AS REAL ) - cast(22.1 AS REAL ) ) AS 'test2' FROM [dbo].[Table01]
Filemaker pro 12v3 windows版を Windows7 64bit Ultimate atok 2012にて利用しております。 日本語のテキストを入力している時に日本語を変換して変換文字を直すために カーソルを戻そうとしても戻りません。 再変換のためには、いつも日本語を最初から入力し直さなければなりません。 他のInternet Explorerやメモ帳、Word、Firefox等のアプリケーションでは、普通にできます。 これは、何かファイルメーカーの設定が必要なのでしょうか？
下記条件を満たすSQL文を知りたいのですが、どう書けばよいでしょうか？ ■構成 Aテーブル ・「id」カラム ・「created_at」カラム … datetime型 ・「area」カラム Bテーブル ・「a_id」カラム ・「created_at」カラム … datetime型 ■前提 ・Aテーブルの1レコード(「id」カラム)に対して、0～複数のBテーブルレコード(「a_idカラム」)がある ・A.id = B.a_id ■欲しい内容 ・「Aテーブル」「Bテーブル」それぞれのカラム内容全部。※条件あり ▼条件1 Aテーブル「id」カラムに対応したBテーブルの「a_id」が複数ある場合には、該当Aテーブル内容＋ Bテーブル「created_at」カラムの値が一番新しいレコードを返す(取得レコード数は常に1) ▼条件2 Aテーブル「id」カラムに対応したBテーブルの「a_id」がなかった場合には、該当Aテーブル内容＋ Bテーブル側は何も返さない ▼条件3 ※同名カラムを取得する際には、カラム名先頭にそれぞれa、bを付与(「acreated_at」「bcreated_at」) ・後で、それぞれのテーブルカラムとして利用したいだけなので、それが出来れば形式にこだわりはありません
oracle sql developer(Version 1.5.1 )を使用してsqlを叩いてもエラーが出てくるので ご助言いただきたく思います。 update table set comment = '新規' where code = '111'; 上記のSQL文を実行すると、ora-01747のエラーが出ます。 commentという名前のカラムですが、 ここを別のカラムmailにして実行するとうまくいきます。 カラムの型は以下の通りです。 comment : varchar2(500 BYTE) mail : varchar2(128 BYTE) 唯一気がかりなのは、通常ならば update,set,where だけが濃い青色で表示されるのですが、 commentもなぜか濃い青色で表示されます。 (mailは濃い青色になりません。) ご助言の程、宜しくお願い致します。
フォーム内のコンボボックス処理について 現在ACCESS2002でDBを構築しております。 初心者です。 フォーム内でテキストボックスから値【a】をもらい、その【a】を抽出条件として抽出結果を コンボボックスに表示したいと考えております。 ※like関数を使用 Private Sub テキスト1_AfterUpdate() DoCmd.Requery "コンボ1" Me!テキスト1.Requery End Sub コンボボックスの値集合ソースの抽出条件で ((テーブル.カラム) like "'*" & Forms!フォーム!テキスト1 & "*'") 上記で指定したのですが、何も抽出されません。 イコールで下記を実行すると値は抽出されます。 ((テーブル.カラム) = Forms!フォーム!テキスト1 ) LIKE関数の使い方が悪いのでしょうか。 お手数ですが、ご教授願います。
お世話になります。 下記ような３個のテーブルから、下記画面表示内容のようにするには、 どのようなSQLを書けばよろしいでしょうか ご教示願います。 所有者テーブル 所有者ID,所有者名 1,田中 2,鈴木 3,前田 土地テーブル 所有者ID,取得日,面積 1,11/22,100 1,11/24,30 1,11/26,150 2,4/2,45 2,12/4,120 家屋テーブル 所有者ID,取得日,延床面積 1,11/25,30 1,11/30,12 画面表示内容 所有者ID,名前,土地取得日,面積,家屋取得日,延床面積 1,田中,11/26,150,11/30,12 1,田中,11/24,30,11/25,30 1,田中,11/22,100,空白,空白 2,鈴木,12/4,120,空白,空白 2,鈴木,4/2,45,空白,空白 3,前田,空白,空白,空白,空白 よろしくお願いします。
テーブルには複数の主キーがあり、そのうちの3つの主キーを元に 最も古い日付の情報を取得したいです。 同じデータが複数あるので、副問い合わせ（＝）でエラーになると思ったのですが エラーにならずにすべてのデータが取得されてしまいます。 テーブル id name sex date1 1 'A' '男' 20120101 1 'A' '男' 20120101 2 'A' '女' 20120102 select * from table where date1 = (select min(date1) from table where id = 1 and name = 'A' and sex='男'); 下記のような情報を取得するには、SQLとして間違えておりますでしょうか。 ↓ id name sex date1 1 'A' '男' 20120101 1 'A' '男' 20120101 お分かりの方、ご教授頂けませんでしょうか。 以上、よろしくお願い致します。
ACCESS2002でDBを構築している初心者です。 メインフォームに2つのサブフォーム（サブ１、サブ２）埋め込みを サブフォーム同士を連動させたフォームを作成中です。 2つのサブフォームのうちのサブ１にテキストボックスを基に コンボボックスでSQLを実行して抽出結果を コンボボックスに表示させています。 下記でaの値が変更されるとbにその値を送っています。 Private Sub a_AfterUpdate() DoCmd.Requery "b" Me!a.Requery End Sub その後bの値集合ソースでSQLを実行しております。 SQLの抽出条件「forms!サブ１!a」として、上記で取得した テキストボックスaを使用しております。 サブ１をメインフォームで開き上記を実行すると値を抽出します。 しかしサブフォームで実行した際に、「パラメータの入力」が 出てきて手動で入力しなくてはいけません。 サブフォーム上で実行する際に、イベントプロシージャや SQLの抽出条件を更新しなくてはならないのでしょうか。 お手数おかけいたしますが、ご教授よろしくお願いいたします。
今まで SQL Server2000 を使用していました。 OSはWinXp Proです。 今日アンインストールして、SQLServer2008 Express (SP3)をインストールしたのですが、 起動していないようなのです。 というのも SQLServer2000 の場合、ＯＳ起動すると右下に SQLServer のアイコンが表示されクリックすると起動しているのがわかったのですが、インストールした後、一度もこのアイコンが表示されません。 起動するには何か設定でも必要なのでしょうか？
アクセスログの分析のため月ごとで、データをlog_siteというテーブルに入れ込んでいます。(データ量は約4500万件) ※実際はもっと項目(リクエストURL、HTTPステータス、UAなど)がありますが、 ここでは省略しています。 +----+-----------------+--------------------+----------+----+------+ + No | IP | DATETIME | YYYYMMDD | HH | HHMM | +----+-----------------+--------------------+----------+----+------+ + 1 | XXX.XXX.XXX.XXX | 2012-11-14 18:50:11| 20121114 | 18 | 1850 | + 2 | XXX.XXX.XXX.XXX | 2012-11-14 11:44:04| 20121114 | 11 | 1144 | + 3 | XXX.XXX.XXX.XXX | 2012-11-14 17:16:06| 20121114 | 17 | 1716 | + 4 | XXX.XXX.XXX.XXX | 2012-11-03 16:47:01| 20121103 | 16 | 1647 | + 5 | XXX.XXX.XXX.XXX | 2012-11-05 19:35:18| 20121105 | 19 | 1935 | + 6 | XXX.XXX.XXX.XXX | 2012-11-03 16:52:39| 20121103 | 16 | 1652 | + 7 | XXX.XXX.XXX.XXX | 2012-11-04 15:19:40| 20121104 | 15 | 1519 | + 8 | XXX.XXX.XXX.XXX | 2012-11-12 12:34:58| 20121112 | 12 | 1234 | + 9 | XXX.XXX.XXX.XXX | 2012-11-09 09:50:53| 20121109 | 09 | 0950 | + 10 | XXX.XXX.XXX.XXX | 2012-11-09 13:08:53| 20121109 | 13 | 1308 | + 11 | XXX.XXX.XXX.XXX | 2012-11-08 06:57:31| 20121108 | 06 | 0657 | + 12 | XXX.XXX.XXX.XXX | 2012-11-13 11:12:14| 20121113 | 11 | 1112 | + 13 | XXX.XXX.XXX.XXX | 2012-11-05 10:22:42| 20121105 | 10 | 1022 | +----+-----------------+--------------------+----------+----+------+ 各項目は以下のように定義しています。 `No` int(11) NOT NULL AUTO_INCREMENT, `IP` varchar(15) DEFAULT NULL, `DATETIME` datetime DEFAULT NULL, `YYYYMMDD` varchar(8) DEFAULT NULL, `HH` varchar(2) DEFAULT NULL, `HHMM` varchar(4) DEFAULT NULL, やりたいこととしては、1分または1時間単位でアクセスを集計しグラフを書こうとしています。 グラフに対しては、43,56,35,・・,5といった状態で渡せばグラフを書いてくれるのですが、 そのデータを取り出すため以下のようなSQLを書いて、各1分単位でそのカウントをして見ました。 select HHMM, count(IP) from log_site where YYYYMMDD='20121101'and ( (HHMM='0000')or(HHMM='0001')or(HHMM='0002')・・・・(HHMM='2359') )group by HHMM; +------+-------+ + HHMM | count | +------+-------+ + 0001 | 43 | + 0002 | 56 | + 0003 | 35 | (----省略----) + 2359 | 5 | +------+-------+ アクセス時間については、DATETIMEの項目にデータを入れているのですが 1分ずつ、1時間ずつ集計するのに日時や秒の情報が邪魔だったので YYYYMMDD、HH、HHMMといった内容で情報を持たせています。 実行した結果、取得できるのに300-400秒必要なのですが、 1日を取得するだけで、5-7分要するのは、なんとかならないでしょうか？ 最低でも3日、最高で7日間ぐらいのデータは取得したいと考えているため、 この時間はかかりすぎなのです。 やはりログデータ量が約4500万件あるという多さから予め日ごとで集計された 数字を別テーブルに持たせることを考えていたのですが、 引っ掛けたいリクエストURLや、HTTPステータス、UAなど他の項目でも アクセス傾向が知りたいため、予め日ごとで集計された結果を別テーブルに持つ ということは出来ないので、予め集計された結果を持っておく訳にも行かず困っています。 もし今の状況でどのようなＳＱＬだったら、データをスムースに取得できるのでしょうか？ またスムーズにデータを取得するためにデータ構造の見直しが必要としたら どのように変えて、かつどのようにｓｑｌを組んで取得すればよいのでしょうか？ （仮に、日ごとでテーブルを作った場合は1日あたり150万程度になりますが 日をまたぐ場合は、どのようなSQLになるのでしょうか？） もっといい方法があれば教えていただければと思います。 よろしくお願いいたします。
現在SQLServer2000で運用しているサービスがありますが、 SQLServerでは8000バイト制限があるため、 2005か2008に変更しようと予定しています。 しかし2000→2005や 20005→2008 移行で難航したという意見が結構ききます。 コーディングを結構変更しないといけないのであれば 2000で8000バイトずつに区切ってExecuteしようと思いますが、 どれくらい移行は大変なのでしょうか？
恐らくそれほど複雑なSQLではないと思いますが、中々SQLが作成できず困っています。 回答いただければ嬉しいです。 以下のテーブルがあったと仮定します。 テーブル名： 　売上げ明細 カラム： 　・商品ID　…　売上げ明細なので一意ではありません 　・単価　…　同じ商品IDでも、レコードによって単価は異なります 　・数量　…　1～5の整数のみとします 実際のデータは以下の通りです。 商品ID,単価,数量 1001,50,2 1001,60,5 1002,90,3 1003,60,5 1003,80,4 1003,90,1 1004,60,3 上記データを以下の通り抽出するには、どのようなSQLを組めばいいでしょうか？ １．まず各商品IDの中から単価が最大のレコードだけを取り出す 商品ID,単価,数量 1001,60,5 1002,90,3 1003,90,1 1004,60,3 ２．次に数量でgroup by して、件数をカウントする 数量,件数 1,1 3,2 5,1 １つのSQL文で２の結果が得られれば、途中の抽出条件は特に問いません。 ちなみにMySQL5を使っています。 よろしくお願いします。
Accesss2002-2003データベース(MDB)からAccesssデータベース(accdb)に変換すると、ゴミ(？)が入るようです。 オブジェクト名を取得しようと下記のコードを利用しています。 '--------------------------------------------------------------------------------------------------- strSQL = "SELECT [Name] " & "FROM MSysObjects " & "WHERE ([Name] Not Like 'MSys*') AND ([Type]=1)" Set db = CurrentDb Set rs = db.OpenRecordset(strSQL, dbOpenDynaset) rs.MoveFirst Do Until rs.EOF s = rs!name DoCmd.RunSQL "INSERT INTO テーブル名(フィールド名) VALUES('" + s + "') ;" rs.MoveNext Loop '--------------------------------------------------------------------------------------------------- 取得したオブジェクト名のなかに、「f_0B367D89DA9A4E86839A6A7C5A7B0530_Data」という、私が作ったものでないものがありました。 オブジェクトウインドにも現れていません。 前後の位置関係からテーブルだと思います。 DoCmd.RunSQL "DROP TABLE f_0B367D89DA9A4E86839A6A7C5A7B0530_Data" とやっても「テーブルは存在しません」となります 「最適化と修復」、空のデータベースにインポート、試してみましたがダメでした。 MDB>accdb 変換するたびにこのオブジェクト名の番号部分が違います。 どのようにしたらこのゴミ取りできますでしょうか？ そもそもゴミではないのでしょうか？
以下のテーブルからCSVを出力する際、 ID | 名称　| コード1 | コード2 1　| 　A　　|　 111　　| 　444 2　| 　B　　|　 222　　|　 555 3　| 　C　 |　 333　　|　 666 「ID/名称/コード1コード2」のように取りだす場合のSQL文は SELECT ID, 名称, コード1 || コード1 FROM テーブル名 となると思いますがこれを、「ID/名称コード1/名称コード2」のように同じフィールドを同じ行に2回登場させたい場合はどうすれば宜しいでしょうか。 SELECT ID, 名称 || コード1, 名称 || コード2 FROM テーブル名 とした場合にはエラーになってしまいます。 宜しくお願い致します。
グルーピング内で、あるカラムの最大値のレコードで絞り込む方法は、 以下のサイトで知ることができましたが。 http://www.yokablo.com/20120905717.html tb_score +-------+-------+-------+ | c_name | game | c_score | +-------+-------+-------+ | 山田 | 高飛び | 90 | +-------+-------+-------+ | 山田 | 徒競走 | 85 | +-------+-------+-------+ | 山田 | 玉入れ | 90 | +-------+-------+-------+ | 鈴木 | 徒競走 | 85 | +-------+-------+-------+ | 鈴木 | 騎馬戦 | 50 | +-------+-------+-------+ | 室伏 | 綱引き | 100 | +-------+-------+-------+ | 室伏 | 玉入れ | 10 | +-------+-------+-------+ SQL文： SELECT * FROM tb_score INNER JOIN ( SELECT c_name, MAX(c_score) AS MAXSCORE FROM tb_score GROUP BY c_name ) AS TBDUMMY1 USING (c_name) WHERE c_score = MAXSCORE 私の場合、t_score の親テーブル名`t_company`と、 子テーブル`t_items`がありまして、 以下のようなことをやりたかったのですが、エラーとなります。 上記SQL をサブクエリにします。 select * from ( SELECT * FROM tb_score INNER JOIN ( SELECT c_name, MAX( c_score ) AS MAXSCORE FROM tb_score GROUP BY c_name ) AS TBDUMMY1 USING ( c_name ) INNER JOIN t_company ON t_company.c_name = tb_score.c_name WHERE c_score = MAXSCORE ) as T1 , t_items where T1.id_score = t_items.id_score 結果エラーメッセージは、 #1060 - Duplicate column name 'c_name' でした。 エラー箇所が、 GROUP BY c_name　か、 USING ( c_name )　か、 INNER JOIN t_company ON t_company.c_name = tb_score.c_name なのか、分かりません。 SQL の規則としてやってはいけないことをやっていると想像してますが、 ご指摘・ご指導いただけると大変に助かります。 よろしくお願いします。
以前、MySQLでのマージ方法について質問した者です。 今度は、Oracleでのマージ方法ですが、 重複行が発生して困っております。 状況としては、スキーマが二つあります。db1とdb2です。 それぞれ、同じ構造のテーブルを持っていて、格納しているデータだけが違います。 db1にdb2をマージしようとしているのですが、上手くいきません。（重複行が発生します） 方法として、以下の２パターンを試行しました。 （１）インポート 　　　db1をインポートした後に、同じスキーマにdb2からのダンプファイルでインポート　　 （２）ダイレクトパスインサート 　　　insert/*+ APPEND */ into db1.myTable (SELECT * FROM db2,myTable);. 以下は当方の使用環境です。 Windows7 Pro 64Bit Oracle11g　Standard Edition 他に必要な情報があればお聞かせください。 よろしくお願いします。
以下のようなテーブルがあった場合、PARENT が 0 のものを抜き出して、且つそれに紐づいてるカラムの個数を取得したいのですが、どのようにしたらいいでしょうか？ +---+----+--------+ + ID | XXX | PARENT | +---+----+--------+ + 1 | *** | 0 | +---+----+--------+ + 2 | *** | 1 | +---+----+--------+ + 3 | *** | 4 | +---+----+--------+ + 4 | *** | 0 | +---+----+--------+ + 5 | *** | 1 | +---+----+--------+ + 6 | *** | 0 | +---+----+--------+ + 7 | *** | 4 | +---+----+--------+ + 8 | *** | 4 | +---+----+--------+ *PARENT には、ID に紐づいた値が入ります 出力例 +---+----+--------+ + ID | XXX | COUNT | +---+----+--------+ + 1 | *** | 2 | +---+----+--------+ + 4 | *** | 3 | +---+----+--------+
お世話になります。 複数レコードがあるテーブルにて、あるレコードだけカウントアップする為のSQL文はどのように記述すれば良いでしょうか？ 要件： テーブル名'名簿'の No, 名前, 更新者, 備考に 01, 芥川龍之介, ほげ太, NULLを入力し 備考は書き込みさせるためとりあえずNULLを代入しておき 名前と更新者は同じで、Noの部分だけを01～10までカウントアップさせたい 何卒、ご教授のほど、宜しくお願いします。
現在、visual studio2010の環境で、oracle 11gのＤＢに接続を行っています。 その時、Date型の日付を取得しているのですが、DB上登録されているのに値が空白になっていました。 日付が、1990年以降であれば問題ないのですが、たまたま、1899年代の日付が設定されているデータでした。 oracle 11gでは、1990年以前は、サポートしていないのでしょうか？ よろしくお願いいたしす。
SQLを独学で勉強しています。 基本中の基本というべきところはだいたい覚えたのですが、 結合とかになってくるとよく分からなくて四苦八苦しています。 そこで何か問題集などを一冊解いて理解を深めたいと思っているのですが、 何かいい本はありませんでしょうか？ ちなみに参考書はいくつか持っているのですが、自分の場合、 本で読むよりも問題を解いて覚えるほうが圧倒的に理解しやすいので 問題集を探しています。
Mysqlの命令文作成で完全に詰まってしまって途方に暮れています。 添付画像にあるように、テーブルAのanwserの値とテーブルBのuser_answerの値が同じ場合に、テーブルBのanswer_flagを0から1に変更するというMYSQLの命令文を書きたいのですが、上手く行きません。。。 UPDATE tbl_quiz_log SET answer_flag = 1 WHERE user_answer = ANY( SELECT tbl_question.anwser FROM tbl_question INNER JOIN tbl_quiz_log ON tbl_quiz_log.question_id = tbl_question.question_id ) 何が間違っているのでしょうか？ どなたかお力をお貸し頂けませんでしょうか？ どうぞよろしくお願い致しますm(_ _)m ●補足 ※1 キャプチャー画像のカラムは一部のカラムのみ表示している状態です。 ※2 ちなみに、テーブルAのanswerがスペルミスなのは把握しております。
MySQL5.5.27, mysql-connector-java-5.1.12を用いて、DBにアクセスしています。 DBに登録されたテーブル名を取得しようと思い、以下の様なメソッドを作成しました(テーブル名は全て数字です)。 https://gist.github.com/4146754 しばらくは順調に動いていたのですが、DBに登録されたレコード数が25万を超えたあたりで、動かなくなってしまいました。 デバッグをして原因を調べたところ、 metadata.getTables(null, "%", "%", null); の実行時に、メソッドを呼び出したまま固まってしまっていることが分かりました。 同じコードを、別のDBに対して作用させたところ、問題なく動いたため、レコード数が多いのが原因ではないのかと考えたのですが、何かよい対処法はありますでしょうか？ よろしくお願い致します。
お世話になります。 クエリAとクエリBがあり、ユニオンクエリにて両クエリを結合させたいと思っております。 しかし、クエリBにしかないフィールド（test）がある為、「列数が一致しません」となってしまいます。 このような場合、一般的にはどのようにして対処するのでしょうか。 恐らくクエリAにtestというフィールドを仮想的に？追加するのだと思いますが、やり方がわかりません。 ご教授の程、宜しくお願い致します。
こんにちは。 MS-Access2003です。レコードセレクタをダブルクリックした時に以下のようなイベントを設定したいと思っています。 1.テーブルの全データを一覧で表示するクエリを連結した、表形式のフォーム(フォームA)が 　あり、そのレコードセレクタをダブルクリックします。 2.別に、そのテーブルを連結したフォーム(フォームB)があり、1.でダブルクリックしたデータが、 　その「テーブルを連結したフォーム」に表示されて欲しい。 フォームAは参照のみであり、フォームBは更新可能な設定です。 レコードセレクタのイベントはマクロで組みたいのですが、フォームBを開いた後どうすれば そのデータをフォームBでフィルターをかけたように表示できるのかが分かりません。 ご教授いただけると助かります。 よろしくお願いいたします。
誰か助けて下さい！！ さくらインターネットのデータベースで、 MySQLのヴァージョンが低くて、 設置不能のブログ（ワードプレス等）があったので、 ヴァージョンを最新する方法を探していました。 「一回消して再登録する」という記事を読んで、 バックアップも取った上で再登録したのですが、 データをインポートできません。 以前のものは mysql24.db.sakura.ne.jp 今回のは mysql443.db.sakura.ne.jp です。 エクスポートしたデータは「SQL」 「SQL圧縮」「 CSV 」の3つで保存してあります。 再度データベースを作るときにデータベース名を入力する欄がありましたが 以前使っていたものには、そんな入力は要求されなかったような気がします。 もしかしたら、それが原因かも…と思っているのですが、 お分かりになる方いらっしゃいませんでしょうか。 エラーはこちら *-------------------------* エラー 実行した SQL: -- -- データベース: `aaa_01` -- CREATE DATABASE `aaa_01` ; MySQLのメッセージ: #1007 - Can't create database 'aaa_01'; database exists *------------------------------*
初めましてphp,mysql共に初心者です。 現在以下のような問題で頭を抱えています。 映画のデータベースを使った映画の検索システムを考えています。 フィールドはid,sakuhinmei,cast1,cast2,cast3,kantokuの６つです。 検索方法として作品名やキャストなどを一つのフォームを用いて検索する複数条件を用いたシステムを考えています。 そこで以下のようなソースを作りました。 <?php $dsn='mysql:dbname=testdb;host=localhost'; $user='root'; $password='koro0401'; $dbh=new PDO($dsn,$user,$password); $dbh->query('SET NAMES UTF-8'); $kensakuwords=$_POST['kensakuwords']; $sql="SELECT * FROM eiga WHERE (sakuhinmei=.'$kensakuwords'.) OR (cast1=.'$kensakuwords'.) OR (cast2=.'$kensakuwords'.) OR (cast3 =.'$kensakuwords'.) OR (kantoku=.'$kensakuwords'.)"; $stmt=$dbh->prepare($sql); $stmt->execute(); while(1) { $rec=$stmt->fetch(PDO::FETCH_ASSOC); if($rec==false) { break; } print$rec['id']; print$rec['sakuhinmei']; print$rec['cast1']; print$rec['cast2']; print$rec['cast3']; print$rec['kantoku']; print'<br/>'; } $dbh=null; ?> 実行してみるとエラーはでないのですが、何も表示されません。いろいろネットで調べてためしてはみたのですが、自分では何が違うのかわかりませんでした。 どうかｐｈｐ、ｍｙｓｑｌに詳しい方々、お力添えお願いします。 初心者でもわかりやすい解答をお願いします。
まだphpMyAdminを勉強中のものです。どなたか教えてください。 phpMyAdminでMySQLデータのエクスポートはオンラインのままでも実行できるのでしょうか？ 色々とサイトを見てみたのですがはっきり書いているものがありませんでした。 初歩的な事ですみません。よろしくお願いします。
下記のコードは、 (1)フォームロード時にアクセスのデータベースにアクセスし、データグリッドビューに表示 (2)フォーム上のデータグリッドビューを編集 (3)データベースに登録ボタン押下すると、フォーム上にあるデータグリッドビューをアクセスのデータベースに反映（update） という作業を行うプログラムです。 このコードを実行した場合、アクセスのデータベース（登録.mdb）のフィールド数の１００以上になると、「クエリーが複雑すぎます」とのエラーが出て、データベース（登録.mdb）の更新が行えません。 何とかエラーを出なくする方法は無いでしょうか？ ＰＣ環境はWINXP+VS2008です。 Imports System.IO Imports System.Data Imports System.Windows.Forms Public Class Form1 Public dAdp As OleDb.OleDbDataAdapter Public dSet As DataSet = New DataSet("T_資料") Public Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load ''▼フォームロード時の処理 Dim cn1 As New OleDb.OleDbConnection("Provider=""Microsoft.Jet.OLEDB.4.0"";Data Source=" & Application.StartupPath & "\登録.mdb;") Dim cmd1 As New OleDb.OleDbCommand("SELECT * FROM T_資料", cn1) cn1.Open() dAdp = New OleDb.OleDbDataAdapter("SELECT * FROM T_資料", cn1) dAdp.Fill(dSet, "T_資料") Me.DataGridView1.DataSource = dSet.Tables("T_資料") cn1.Close() End Sub Public Sub cmd_Db_reg_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmd_Db_reg.Click '▼「データベースに登録」ボタンを押下したときの処理 Try Dim Builder As New OleDb.OleDbCommandBuilder(dAdp) Builder.GetUpdateCommand() dAdp.Update(dSet.Tables("T_資料")) MessageBox.Show("更新に成功しました。") Catch ex As Exception MessageBox.Show("更新に失敗しました。" + vbCr + ex.Message) End Try End Sub End Class
郵便番号を入力すると指定されたフィールドに住所が表示される機能。 この機能のオン・オフをＶＢコードから制御できないでしょうか？
さくらサーバのMysql、phpMyadminを利用しています SQL文を勉強してSQL文で書けばいいのでしょうが phpMyadminlのマンマシンインターフェースが便利なのでいつもそれを 利用しています 今回、あるテーブルからある条件に合致するレコード約2000件を 一度に削除しようとしています phpMyadminの検索タブを利用してある条件を指定して、条件に合致する レコードは2000件表示されてきます その抽出された2000件のレコードを一挙に削除したいのですが・・・ phpMyadminでは抽出レコードの表示について、初期値では1画面、 30件毎に表示されるようになっています その画面毎に一番下にメニューがあり各レコードごとにチェックボックス があり、レコード毎にチェックして、チェックがついたレコードを削除 できるようになっていますが 1レコードずつ全部をしていくのは大変のため、画面下にある「すべてのレコード にチェック」をつけるメニューがあります 2000件のテータ消去をするためには 初期値の1画面30件の表示では、70回弱の操作が必要となるため大変です このため、1画面2000レコード表示に指定すると、表示はしてくるのですが 30表示の場合に一番下に出ていた、「すべてチェックする」表示が出て きません Sql文でなく、マンマシンインターフェースで簡単に抽出してきた2000件の レコードを削除する方法はないでしょうか あれば教えていただきたいのですが・・
さくらサーバのMysql、phpMysqlを利用しています SQL文を勉強してSQL文で書けばいいのでしょうが phpMysqlのマンマシンインターフェースが便利なのでいつもそれを 利用しています 今回、あるテーブルからある条件に合致するレコード約2000件を 一度に削除しようとしています phpMysqlの検索タブを利用してある条件を指定して、条件に合致する レコードは2000件表示されてきます その抽出された2000件のレコードを削除したいのですが・・・ phpMysqlでは抽出レコードの表示について、初期値では1画面、 30件毎に表示されるようになっています その画面毎に一番下にメニューがあり各レコードごとにチェックボックス があり、レコード毎にチェックして、チェックがついたレコードを削除 できるようになっていますが 1レコードずつ全部をしていくのは大変のため、画面下にすべてのレコード にチェックをつけるメニューがあります 初期値の1画面30件の表示では、70回弱の操作が必要となるため大変です このため、1画面2000レコード表示に指定すると、表示はしてくるのですが 30表示の場合に一番下に出ていた、「すべてチェックする」表示が出て きません Sql文でなく、マンマシンインターフェースで簡単に抽出してきた2000件の レコードを削除する方法はないでしょうか あれば教えていただきたいのですが・・
書き込みさせて頂きます。 今までは、Dreamweaverを使用してhtmlを修正していました。 しかし、phpを使用しているページが出来てしまい、うまく表示できなくなりました。 そのため、XAMPPをインストールしてファイルを表示できるようにしたいです。 ※データベースは使いません。 ※修正後、ファイルをFTPソフトでアップロードします。 しかし、XAMPPのページを見ていると http://www.apachefriends.org/jp/xampp-windows.ht … セキュリティに深刻なリスクとなり得ます。等が書いてありますので インストールしようにも何だか怖くて躊躇しています。 上記のような使い方をする場合、セキュリティに何か問題が出てくるのでしょうか。 個人ではなく会社のサイトなので、心配で書き込みいたしました。 もし問題がある場合は、どのような問題があるものですか？ また、会社にはネットワーク管理者がいるのですが XAMPPをインストールする旨を伝えたほうが良いものでしょうか？ あまり交流のない部署なので…伝えなくても良いものであれば そのままインストールしたいのですが；； よろしくお願いします。
2度目の質問となり恐縮しております。 生徒の成績の得意不得意をあらわすSQLを考えています。(mySQL 5.5 centOS6.3) テストの成績をもとに 「kamedaの一番の得意科目(クラスでの相対順位が最上位)は英語で、クラス2位である」 「kamedaの二番の得意科目は数学で、クラス4位である」 「kamedaの三番の得意科目は国語で、クラス7位である」 ということが分かるようにする予定です。 当初私が考えた案ではlimit句を使った方法を考えており、limit後の値を変更することにより2位、3位を出す予定でしたが、私の方法ではうまくいかなかったためこのサイトで質問をさせて頂いたところ、minを使った方法を紹介れました。 (私の質問方法が「クラスの最上位を求める」というように省略して記載していたためmin句での回答を頂くことになりました) この回答をベースに当方で2番目を抽出出来るよう改造に着手しましたがうまく出来ません。 ●min句ベースではminから2番目というものをどうしても取ることが出来ませんでした。 ●このmin句ベースのものをlimit句のSQLに改造しようとトライしたのですがどうしても改造することが出来ませんでした。 何度もこの場をお借りして恐縮ですがお知恵を拝借したくお願い申し上げます。 **************************************************** ベースとなるデータ CREATE table seiseki2 (usr_id TEXT,kyoka_name TEXT,point INT); CREATE table point_rank (p_usr_id TEXT,1st_kyoka_name TEXT,1st_rank INT); INSERT INTO seiseki2 (usr_id,kyoka_name,point) values ('kameda','数学',85),('suzuki','数学',71),('kaneko','数学',32),('yosida','数学',61),('tanita','数学',70),('suyama','数学',80),('kisida','数学',61),('komine','数学',99),('tomita','数学',89),('sugita','数学',75),('kameda','国語',80),('suzuki','国語',46),('kaneko','国語',52),('yosida','国語',89),('tanita','国語',77),('suyama','国語',67),('kisida','国語',81),('komine','国語',89),('tomita','国語',69),('sugita','国語',70),('kameda','英語',94),('suzuki','英語',86),('kaneko','英語',50),('yosida','英語',59),('tanita','英語',48),('suyama','英語',97),('kisida','英語',74),('komine','英語',82),('tomita','英語',59),('sugita','英語',60); INSERT INTO point_rank (p_usr_id,1st_kyoka_name,1st_rank) values ('kameda','',''),('suzuki','',''),('kaneko','',''),('yosida','',''),('tanita','',''),('suyama','',''),('kisida','',''),('komine','',''),('tomita','',''),('sugita','',''); ***************************************************** この場で回答頂きましたSQL 下記はmin句を使用して最上位の教科を出すことが出来ます。 今回の質問は下記を改良し、2番目の教科、3番目の教科を出したいと考えています INSERT INTO point_rank (p_usr_id, 1st_rank, 1st_kyoka_name ) SELECT d1.id , min(d1.rank) AS top_rank , (select GROUP_CONCAT( kyoka ) from (SELECT t1.usr_id as id , t1.kyoka_name as kyoka ,( SELECT count( * ) +1 FROM seiseki2 AS t2 WHERE t2.point > t1.point AND t2.kyoka_name = t1.kyoka_name ) AS rank FROM seiseki2 AS t1 ) as d2 where d2.id=d1.id and d2.rank= min(d1.rank) group by d2.id ) AS kyoka FROM ( select t1.usr_id as id ,( SELECT count( * ) +1 FROM seiseki2 AS t2 WHERE t2.point > t1.point AND t2.kyoka_name = t1.kyoka_name ) AS rank FROM seiseki2 AS t1 ) as d1 group by d1.id ; ********************************************* ご参考 私が当初考えたSQL　順位は出ますが教科が出せません UPDATE point_rank SET 1st_rank= (SELECT ( SELECT count( * ) +1 FROM seiseki2 AS t2 WHERE 1 AND t2.point > t1.point AND t2.kyoka_name = t1.kyoka_name ) AS rank FROM seiseki2 AS t1 WHERE t1.usr_id = point_rank.p_usr_id ORDER BY rank ASC LIMIT 0 , 1)
サイト上のデータから構築したデータベースがあります。 サイト上のデータが更新された場合に、連動してデータベースが更新したいと思っています。 現状は、ChromeのPage　Monitorに更新が上がってきたら、目視で確認して、SQL文を叩いてinsertするという流れでやっています。 更新を少しでも自動化できればと思います。 とはいえ、当方はPHPとMySQLが少しできる程度の初心者なので、あまり複雑なことはできませんが。。。 初めにデータベースを構築した時は、Simple HTML DOM Parserを使ったので、これを使って更新を少しでも自動化できればと思いますが、勿論これを使わなくても構いません。 なお、サイト上のデータは、新しいものが下に来るとは限りません。 【更新前】 hoge1 hoge2 hoge3 【更新後】 hoge1 hoge4 New! hoge2 hoge3 上記のように追加されたものが途中に来る場合もあります。 一方、データベースの方では、ID管理しており、追加されたものは次のIDになるようにしたいです。 id　　　　　name 1　　　　　hoge1 2　　　　　hoge2 3　　　　　hoge3 4　　　　　hoge4 なお、マルチプライマリーキーを使っている関係で、idカラムにはauto_incrementは使っていません。 以上、情報が不足しているかもしれませんが、アドバイスいただければ幸いでございます。 （不足があればおっしゃってください。補足いたします。） また、サイト管理者には手間をかけない約束になっているので、APIで提供してもらうとかFTPで送ってもらうとか、そういうのはナシでお願いします。
Acsess初心者です。クエリでの結合（紐付け？）方法について質問いたします。 2つのテーブルから、各2つずつのフィールドを結合したいのですが、 以下の条件でそれぞれを同値であるようにしたいのです。 テーブルAには、フィールドp、フィールドqが入っています。 テーブルBには、フィールドr、フィールドsが入っています。 ※m、nは1以上の整数です ・（フィールドp、フィールドq）=（0、n）のとき、（フィールドr、フィールドs）=（2、n）と同値とする ・（フィールドp、フィールドq）=（m、n）のとき、（フィールドr、フィールドs）=（1、m）と同値とする 上記2点で、2つのテーブルを結合することは可能でしょうか？
PHPでwebツールを作っているのですが、データの保存にsqliteを使おうと思っています。 そこで疑問なのですが、PHPでsqliteを扱うのはネットなどを見て勉強したのですが、 PHPを実行してweb画面すべてを読み直したり遷移させたりしないで ボタンを押したらsqliteを実行させるのは、どういう方法でやるのでしょうか？ javascriptでやれると思ったのですが、ネットで検索してもあまり詳しく解説した サイトがなく、一般的ではないのかなと思いました。 かといってAjaxだと様々なクライアントの環境によって動作チェックしないといけないなど、敷居が上がりますし、手軽にやるにはどのようにするのでしょうか？ よろしくお願いいたします。
お世話になっております。 件名のエラースタック設定について質問があります。 OSはwindows。 oracleのバージョンは11gです。 現在、複数のeventを設定しようと考えておりまして、以下のようなSQLを実行しました。 （仮として1111と2222のエラースタックを設定すると想定します。） ・alter system set event = "1111 trace name errorstack level 3:2222 trace name errorstack level 3" scope=spfile; 上記のSQLを実行後、下記のSQLにて設定を確認しました。 ・select name,value,display_value,isspecified,ordinal from v$spparameter where name='event'; 出力結果のvalueおよびdisplay_valueに「1111 trace name errorstack level 3:2222 trace name errorstack level 3」と表示されているのですが、これは正しく1111と2222のエラースタックが設定されたということで宜しいのでしょうか？ 宜しくお願いします。
店舗を管理するデータベースをAccess2010で、 テキストボックスを二つ作り　1.にｓ店舗no　・2.にs店舗名を作り 店舗NO・店舗名のどちらかに入力すれば検索する「イベントプロシージャ」を書きました。 [イミディエイト]ウィンドウを開きながら構文しましたが、[イミディエイト]ウィンドウ では、うまく作動しますが、イベントロシージャで実際に組みますと「コンパイルエラー：構文エラー」 と表示されます。どこが間違っているのかわかりません。 何方か教えて頂けませんでしょうか？ 宜しくお願い致します。 Private Sub s店舗no_LostFocus() If Not IsNull(s店舗no) Then 'DLookup("店舗名","t店舗","[店舗no]= forms![ft店舗seach]![s店舗no]") DLookup("[店舗名]","[t店舗]","[店舗no]="& Forms![ft店舗seach]![s店舗no]) 　 End If End Sub [イミディエイト]ウィンドウ ? DLookup("[店舗名]","[t店舗]","[店舗no]="& Forms![ft店舗seach8]![s店舗no]) 梅が丘店 相模原鵜野森店 ?DLookup("店舗名","t店舗","[店舗no]= forms![ft店舗seach8]![s店舗no]") 梅が丘店 相模原鵜野森店
いつもお世話になっております。 Access2000（ＯＳはWindowsXP）上にボタンを作り、これをクリックするとExcelデータを自動的にインポートするプログラムを作って実行したら、次のようなエラーメッセージが出ます。 「予期せぬエラーが発生しました。エラー番号：3011　エラー内容：オブジェクト’RTEST’が見つかりませんでした。オブジェクトが存在していること、名前やパス名が正しいことを確認してください。」 プログラムはインターネットを調べて、下記のように書きました。 また、Excelデータはメールに添付されていたサンプルのデータ（項目は、行番号、伝票番号、所属、顧客名、金額、発行日で、データは２２件入っています。ファイルの種類は「Microsoft Excel 97-2003 ワークシート」）をマイドキュメントにコピーしました（ファイル名は RTEST.xls ）。 エラーが発生したので、C:\にコピーしてやってもみましたが、やはり同じエラーが起こります。 なお、このパソコンにはExcelはインストールされていません・・・これが問題とは思えないのですが。 原因の分かる方がおられましたら、是非対処の方法を教えて頂きたく思います。 あるいは、もっと良い記述の仕方をご教授頂くことでも構いません。 要は、他のパソコン（遠隔地にある）にあるExcelデータをUSBメモリ等のメディアまたはメールに添付して送付してもらい、それを自分のパソコンにコピーし、それをAccess2000にインポートすることができればよいのです。 手動でのインポートは問題なくできたが、自動で行いたいので、悩んでおります。 どうぞ宜しくお願い致します。 （記述したプログラム） --------------------------------------------------------- Private Sub 実行_Click() On Error GoTo エラー Dim strac As String Dim strxls As String Dim strrange As String Dim strmsg As String strac = "T_RTEST" 'Accessテーブルを指定 strxls = "C:\Documents and Settings\DAN\My Documents\RTEST.xls" 'エクセルファイルを指定 　　　（ 'strxls = "C:\RTEST.xls" 　　'C:\でやったときの記述） strrange = "RTEST" 　　　　　　　'データ入力のシート名とセル範囲を指定しない strmsg = "エクセルファイル" & strxls & "を、Accessファイル" & strac & _ "として、データ入力を行います。" & Chr(13) & Chr(13) & _ "エクセルファイルの入力レンジは、" & strrange & "です。" & _ "注意点としては、既にAccessファイル" & strac & Chr(13) & Chr(13) & _ "が存在しているとデータを追加していきますので、実行前に" & strac & _ "を削除しています。" & Chr(13) & Chr(13) & _ "よろしければ、ＯＫをクリックしてください。" 'MsgBoxのメッセージ DoCmd.DeleteObject acTable, strac 'テーブルを削除 If MsgBox(strmsg, vbOKCancel, "Microsoft Access Club") = vbOK Then '最初のデータをフィールド名として使います。 DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel3, _ strac, strxls, True, strrange MsgBox "データ入力は、正常に完了しました。" End If Exit Sub エラー: Select Case Err.Number Case 7874 'エラーの原因となったステートメントの、 '次のステートメントからプログラムの実行を再開します。 Resume Next Case Else MsgBox "予期せぬエラーが発生しました。" & Chr(13) & Chr(13) & _ "エラー番号：" & Err.Number & Chr(13) & Chr(13) & _ "エラー内容：" & Err.Description, 1, "Microsoft Access Club" End End Select End Sub ---------------------------------------------------------
カラムの合計数値を検索対象にしたいのですがどう記述すればいいでしょうか？ [TABLE_A] |ID|No1|No2|No3| |A |10 |10 |10 | |B |5 |15 |10 | |C |5 |5 |10 | |D |10 |5 |10 | |E |10 |5 |5 | 例えば上記の様なデータがある場合、No1,No2,No3の合計が30以上のレコードを抽出したい場合はどう記述すればいいでしょうか？ アドバイスよろしくお願いします。
フリーで公開されているCSVファイルをインポートしてテーブルを作成したのですが、そのCSVのファイルが追加されたり変更された時に一括で追加変更を実施しようと思い（データが２万件以上有る為一つ一つ確認するのは無理）作成し追加された場合の処理は不一致クエリを利用して問題なく出来たのですが変更された場所が有った場合の更新を不一致クエリにて行ったところ全ての件数を更新してしまうのでネットにて調べたところサンプルが有ったのでそれを元に下記の通りに記載したのですが、JOIN操作の構文エラーというエラーが出て前に進みません。 どこに問題があるのかサンプルと見比べたのですが一向に判りません。 誠に申し訳ございませんがご教授願います。 尚、サンプルとして見たのは下記のサイトです。 http://www.accessclub.jp/bbs3/0043/superbeg17558 … SELECT T傷病名マスタ取込用.傷病名コード, Ｔ傷病名マスタ取込用.傷病名 As 傷病名, T傷病名マスタ.傷病名 As 傷病名, T傷病名マスタ取込用.ショウビョウメイカナ as ショウビョウメイカナ, Ｔ傷病名マスタ.ショウビョウメイカナ as ショウビョウメイカナ, T傷病名マスタ取込用.ICD10コード as ICD10コード, T傷病名マスタ.ICD10コード as ICD10コード, T傷病名マスタ取込用.大分類 as 大分類, T傷病名マスタ.大分類 as 大分類, iif([T傷病名マスタ]![傷病名]=[T傷病名マスタ取込用]![傷病名],null,"傷病名") & iif([T傷病名マスタ]![ショウビョウメイカナ]=[T傷病名マスタ取込用]![ショウビョウメイカナ],null,"ショウビョウメイカナ、") & iif([T傷病名マスタ]![ICD10コード]=[T傷病名マスタ取込用]![ICD10コード],null,"ICD10コード、") & iif([T傷病名マスタ]![大分類]=[T傷病名マスタ取込用]![大分類],null,"大分類、") From T傷病マスタ RIGHT JOIN [T傷病名マスタ取込用] ON [T傷病名マスタ].[傷病名コード] = 傷病名コード where ((((iif(Nz([T傷病名マスタ]![傷病名])=Nz([T傷病名マスタ取込用]![傷病名]),null,","傷病名、") & iif(Nz([T傷病名マスタ]![ショウビョウメイカナ]=Nz([T傷病名マスタ取込用]![ショウビョウメイカナ]),null,"ショウビョウメイカナ、") & iif(Nz([T傷病名マスタ]![ICD10コード]=Nz([T傷病名マスタ取込用]![ICD10コード]),null,"ICD10コード、") & iif(Nz([T傷病名マスタ]![大分類]=Nz([T傷病名マスタ取込用]![大分類]),null,"大分類、"))is not null)); union select T傷病名マスタ.傷病名コード, T傷病名マスタ.傷病名 as 傷病名, T傷病名マスタ取込用.傷病名 as 傷病名, T傷病名マスタ.ショウビョウメイカナ as ショウビョウメイカナ, T傷病名マスタ取込用.ショウビョウメイカナ as ショウビョウメイカナ, T傷病名マスタ.ICD10コード as ICD10コード, T傷病名マスタ取込用.ICD10コード as ICD10コード, T傷病名マスタ.大分類 as 大分類, T傷病名マスタ取込用.大分類 as 大分類. iif([T傷病名マスタ]![傷病名]=[T傷病名マスタ取込用]![傷病名],null,"傷病名、") & iif([T傷病名マスタ]![ショウビョウメイカナ]=[T傷病名マスタ取込用]![ショウビョウメイカナ],null,"ショウビョウメイカナ、") & iif([T傷病名マスタ]![ICD10コード]=[傷病名マスタ取込用]![ICD10コード],null,"ICD10コード、") & iif([T傷病名マスタ]![大分類]=[傷病名マスタ取込用]![大分類],null,"大分類、") ON T傷病名マスタ LEFT JOIN T傷病名マスタ取込用 on T傷病名マスタ.傷病名コード=T傷病名マスタ取込用.傷病名コード where ((((iif(Nz([T傷病名マスタ]![傷病名])=Nz([T傷病名マスタ取込用]![傷病名]),null,","傷病名、") & iif(Nz([T傷病名マスタ]![ショウビョウメイカナ]=Nz([T傷病名マスタ取込用]![ショウビョウメイカナ]),null,"ショウビョウメイカナ、") & iif(Nz([T傷病名マスタ]![ICD10コード]=Nz([T傷病名マスタ取込用]![ICD10コード]),null,"ICD10コード、") & iif(Nz([T傷病名マスタ]![大分類]=Nz([T傷病名マスタ取込用]![大分類]),null,"大分類、"))is not null));
自作のストアドプロシージャのどの関数がいつ呼ばれたかを記録したいと思いました。 例えば FUNC_A という関数があって、その関数の先頭で、その関数を実行しているセッションのSIDと関数名を取得できないものでしょうか。 そのようなパッケージ DBMS_**** みたいなものがあって、下記のような感じで使えたらなあと考えています。 ------------------ FUNC_A IS sid NUMBER; funcName VARCHAR2(30); BEGIN SELECT DBMS_****.GET_EXECUTING_SID INTO sid FROM DUAL; SELECT DBMS_****.GET_CURRENT_FUNC INTO funcName FROM DUAL; ... (sid と funcName を現時刻とともに記録） END; ------------------ このような目的に合致したパッケージ、あるいはこの目的を実現する方法などありますでしょうか。 よろしくお願いします
お世話になります。 mysql 超初心者です。 Count( a) AS b FROM tblで aをCountするのはnull値以外で空白もCountしてしまいます。 これを空白もnull値と同じにCountしない方法はどうするのでしょうか？ または空白のみをCountする書き方等あるのでしょうか？ 色々調べてもググってもよくわかりませんでした。 初期値のnull値が一回書き込まれたデーターを削除すると 空白になってCount( a) でCountされて困っています。 初心者なのでなるべく具体的な回答をお待ちしています。 どうかよろしくお願いいたします。
phpMyadmin3.3.10を利用しています それを利用しての検索・削除について質問させてください あるテーブルを選択してそのデータを表示します そして表示されている画面の上にある「検索」メニュー を指定すると何のフィールドで検索するか聞いてきます 必要なフィールドに検索ワードを入れて(例えば「会社」=○○) 実行するとその検索に該当するデータが表示されます ここまではそれでいいのですが 例えば検索結果のデータが900件あったとした場合、現在は1画面に 30件ずつ表示されています 今回、この検索結果で表示された900件すべてを削除したい のですが、画面の下にある「すべてチェックする」という表示 をクリックすると、1画面(30件)しかチェックしないのでこれを チェックして削除にしても、30件しか削除できません。 このように1画面毎チェックして削除する操作となると30回の操作 をする必要があります 1画面100表示にしても、9回操作する必要があります 画面全部(表示されていない画面の分を含めて・・)をチェック して削除する方法はないでしょうか
「さくら」のレンタルサーバを利用しています そのサーバのデータベースはMySql　5.1を使っているようですが さくらが用意している管理ツール(phpMyadmin)を利用して データをCSVデータとしてエクスポートしたいのですが 日本語が文字化けします ダンプ表示には (1)CSV (2)MS Excel用のCSV (3)・Excel 97-2003 XLS workbook (4)Excel 2007 XLSX Workbook 等々の形式があるのですがいずれも文字化けします 一番下に文字コードを選択する項目があり ・non ・EUC ・SJIS のいずれもやってみたのですが結果は文字化けしてしまいます サーバ側の文字化けしないでエクスポートするためには どのように設定すればよいのでしょうか 教えていただければ幸いです
いつもお世話になっております。 以前下記についてお伺いいたしました。 今回はその続編です。 http://oshiete.goo.ne.jp/qa/7772587.html 何卒ご教授ください。 よろしくお願いいたします。 例えば下記のようなテーブルがあるとします。 【運賃テーブル】 日付　　　出発　 到着　運賃 10月1日 東京 青森 8000円 10月1日 東京 大阪 5000円 10月1日 東京 福岡 8000円 10月1日 青森 大阪 6000円 10月1日 青森 福岡 9500円 10月1日 大阪 福岡 5000円 10月1日 大阪 青森 9800円 10月2日 東京 青森 null 10月2日 東京 大阪 5000円 10月2日 東京 福岡 8500円 10月2日 青森 大阪 6000円 10月2日 青森 福岡 9500円 10月2日 大阪 福岡 null 10月2日 大阪 青森 9000円 10月3日 東京 青森 8000円 10月3日 東京 大阪 5000円 10月2日 東京 福岡 8500円 10月2日 青森 大阪 6000円 10月2日 青森 福岡 9500円 10月2日 大阪 福岡 5500円 10月2日 大阪 青森 9000円 仮に運賃を日付で比較した場合（上記を水平展開した場合） 下記のようになります。 【運賃比較】 　　　　　　10月1日 10月2日 10月3日 東京 青森 8000円 ------ 8000円 東京 大阪 5000円 5000円 5000円 東京 福岡 8000円 8500円 8500円 青森 大阪 6000円 6000円 6000円 青森 福岡 9500円 9500円 9500円 大阪 福岡 5000円 ------ 5500円 大阪 青森 9800円 9000円 9000円 ここからが前回と違うのですが 上記の場合、nullがあったら、さらにその前日と 比較する方法を教えていただきたいのです。 ※ 最悪、比較データがない場合、過去1週間前 　　までさかのぼる必要がでることもありえます。 つまり上記でいえば 10月3日の料金は前日値と比べ… 【運賃変更】 東京 青森　変更なし 東京 大阪　変更なし 東京 福岡　変更なし 青森 大阪　変更なし 青森 福岡　変更なし 大阪 福岡　変更あり 大阪 青森　変更なし もしくは 大阪 福岡　変更あり の様に、「大阪 福岡」に変更があったことを アラート表示させたいのです。 【その他条件】 ・このSQLコードは毎日回します ・前日にもデータがなく、前々日のデータと 　比較しなくてはならないこともあります。 　もしくは過去1週間ほどさかのぼらないと 　比較対象のデータがないこともあります。 ・case文を使って【運賃比較】の様なテーブルを作り 　ローカルでVBA等で比較させることも考えましたが 　データが大量すぎて、その方法は使えませんでした。 ・【運賃テーブル】の様な状態でデータをexportし 　それをローカルのExcelでピボットをかけるという方法も 　同様な理由で不可能でした。 何卒よろしくお願いいたします。
Wordpressで作られたサイトを まるごと別サーバーへお引越しする時に MySQLのデータをphpmyadminでエクスポートしています。 データベースのことはよく分からないのですが 下記サイトなどを見ながら、見よう見まねでやっています。 http://crushpow.com/archives/449.html http://memocarilog.info/wordpress/1268 http://word-express.net/wp-17#2 しかし、構造のところの 「IF NOT EXISTSを追加」 とデータのところの 「完全なINSERT文を作成する」 「長いINSERT 文を作成する」 という項目にチェックを付けている人と付いていない人がいます。 これは何が違うのでしょうか？ 自分の場合は、３箇所ともチェックを入れてエクスポートして 特にトラブルなく移行できているのですが、 とても気になりましたので、質問しました。 よろしくお願いします。
先ほど質問させていただいたものです． http://oshiete.goo.ne.jp/qa/7800181.html MySQLではwith rollupを使用して,希望の結果を得ることが可能だったのですが, 次に,Accessで同じSQLを実行したところ,エラーになってしまいました．(AccessにはWith Rollupがないようでした．) AccessでMySQLのWith Rollupの代わりになるような機能はありますでしょうか? 何度も申し訳ありませんが,宜しくお願い致します．
現在,MySQLを使用して,データベースを作成しています． 品番と,指定した期間以前のデータの数量を合計しようと思い,下記のようなSQLを実行してみました． select 品番,期間,sum(数量) as sumQuantity ftom 履歴 where 品番 = 'A' and 期間 <= '1302' group by 品番,期間 (期間は2013/02なら12/11になり,さらに / を除去した値です) 結果が添付図のようになりました． さらに,この結果のsumQuantityの合計を求めるにはどのようなSQLを記述すればよいでしょうか? サブクエリを使用するのかな?と思いましたが,うまく記述できませんでした． お分かりになられる方がいらっしゃいましたら,ご教授お願い致します．
こんにちは。Access 2010のフォームについてお教え頂けないでしょうか。 下記URLのようにForm1があります。 http://kie.nu/yHO Form1には下記のオブジェクトがあります。 ・テキストボックス　tb1 ・ボタン b1 ・サブフォーム sf1 またテーブルが1つあります。 ・テーブル T1 やりたいこと： テキストボックスにキーワードを入力して検索ボタンを押すと、検索結果がサブフォームに表示されるようにしたい。 条件： VBAでやりたい。 そこで下記のコードを書いてみました。 Private Sub cmd_exe_Click() Dim objADOCON As ADODB.Connection Dim objADORS As ADODB.Recordset Dim SQL As String Set objADOCON = Application.CurrentProject.Connection Set objADORS = New ADODB.Recordset SQL = "select * from T1 where keyword = '" & tb1 & "'" objADORS.Open SQL, objADOCON, adOpenKeyset, adLockOptimistic ここまではできて、無事にレコードセットも取得することができました。 しかし、ここでつまってしまって、どのように結果をサブフォームに出力していいのかわかりません。 こちらお教え頂けないでしょうか。宜しくお願いします。
テーブル"t_table"にカラム"col1","col2"が有り、以下の ようにデータが登録されていると仮定して |col1|col2| --------- |aaaa|00gg| |aaaa|00dd| |aaaa|00ff| の場合は行"|aaaa|00ff|"のみ抽出。 |col1|col2| --------- |aaaa|00gg| |aaaa|00dd| の場合は行"|aaaa|00gg|"のみ抽出。 |col1|col2| --------- |aaaa|00dd| の場合は行"|aaaa|00dd|"のみ抽出。 ここで優先順の基準になるのはカラム"col2"に 登録されているデータであり、その優先順は 1.00ff 2.00gg 3.00dd です。 上記のように優先順による抽出はどのようなSQL を組めば実現できるのでしょうか？
MySQLで全文検索を行いたく、色々と調べ、試行錯誤をしたのですが どうしてもできないので、mysqlでの全文検索のやり方がわかるかたがいらっしゃいましたら お教え願えますでしょうか。 私がやったこと ０。Mysqlのバージョン　5.5.23をインスコ　　my.confにft_min_word_len=1を追加　mysql再起動 １。MyISAM型のbookテーブルを作成（utf8_general_ciでとりあえず idとsearch_wordsという２カラムのみ idをprimaryに設定） ２。検索対象であるsearch_wordsをFulltext型に変換 　　sql> alter table book add fulltext( search_words ); ３。データを登録 　　insert into book (id, search_word) value (1, '夏目漱石 こころ natsume souseki kokoro BOOK-NO-012 時は明治末期。夏休みに鎌倉へ旅行をしていた「私」は鎌倉に来ていた「先生」と出会い交流を始め東京に帰った後も先生の家に出入りするようになる。先生は奥さんと静かに暮らしていた。先生は私に何度も謎めいた、そして教訓めいたことを言う。私は、先生に過去を打ち明けるように迫ったところ来るべき時に過去を話すことを約束した。'); ４。mecabで分かち書きした、「夏目」「漱石」をスペースで区切った文字で検索 　　っがしかし、検索結果が帰ってこない 実行してみたSQL 　　select * from book where match( search_word ) against( '夏目 漱石' IN BOOLEAN MODE); 　　select * from book where match( search_word ) against( '+夏目 +漱石' IN BOOLEAN MODE); 　　select * from book where match( search_word ) against( '"夏目 漱石"' IN BOOLEAN MODE); 　　select * from book where match( search_word ) against( '"+夏目 +漱石"' IN BOOLEAN MODE); 　　select * from book where match( search_word ) against( '"+夏目 +漱石"' IN BOOLEAN MODE); 　　select * from book where match( search_word ) against( '"*夏目 *漱石"' IN BOOLEAN MODE); 　　select * from book where match( search_word ) against( '"*夏目* *漱石*"' IN BOOLEAN MODE); 　　「夏目漱石」とひとくくりにした文字列で検索すると、レコードが帰ってきます 　　　また、against( 'natsume souseki' IN BOOLEAN MODE);　も帰ってきます 実際にやってみたいことは、上記の文章で「先生」「鎌倉」「私」「夏目」の４語で検索すると 上記のレコードが帰ってくるということがやりたいですのですが、 select * from book where match( search_word ) against( '夏目 先生 鎌倉 私' IN BOOLEAN MODE); のSQLや対象文字列に＋や＊を付けたものを実行しても引っかかりませんでした。 私が行った設定／sqlに不備がございましたらご指摘／ご指導いただけませんでしょうか。 よろしくお願いいたします。
東京都の学校別のランクを作っています。 現在、name school pointまでは記載されています。 この後、SQL構文で、rank欄に学校内順位を入れ、city欄にtokyoを入れたいと考えています。 完成形は下記のようなものです。 （同点2位が2人いたら、いずれも2とし、その次の人は4となる) table name__school__city___point___rank kameda__1高__tokyo___345____ 1 suzuki__2高__tokyo___341____ 1 kaneko__3高__tokyo___332____ 1 yosida__2高__tokyo___321____ 2 tanita__1高__tokyo___310____ 2 suyama__1高__tokyo___310____ 2 kisida__2高__tokyo___301____ 3 komine__1高__tokyo___299____ 4 tomita__2高__tokyo___289____ 4 sugita__1高__tokyo___275____ 5 下記のreplace文を考えたのですが、学校別の順位ではなく全体順位の入力となってしまいます。 REPLACE INTO table(rank,city) SELECT ( SELECT COUNT(t2.poit) FROM table t2 WHERE t2.poitn > t1.point AND t2.school = t1.school GROUP BY t2.school ) + 1 AS rank,tokyo FROM table t1; 学校別の順位を入力するためにはどのように改良すればいいでしょうか? SQLはmySQL5.5 CentOS6.3です。 よろしくお願いいたします。
使用環境は　DB SQL Server2008 Express 使用ツールは　Microsoft SQL Server Management Studio です SQLserver2000からSQLserver2008DBへ移行しようとしているのですが ストアドプロシージャのところでうまくいきません 具体的には、処理を走らせると下記メッセージが出てきます floatをデータ型numericに変換中に、算術オーバーフローエラーが発生しました プロシージャ"○○"は、許可されていないステータスNULLを返そうとしました。 代わりにステータス0を返します 調べると　 小数点以下があるフィールド同士を掛けて、その結果の小数点以下をROUNDで切り 捨てた値を小数点のないフィールドに追加しようとするとエラーになる　 とありました。 下記　2行あたりが怪しいと思うのですが対処方法がわかりません。 ご教授願えないでしょうか？ SET @GetRand = CAST(RAND()*10 AS numeric(1,0)) … SET @GetRand = CAST(RIGHT(CONVERT(varchar,CAST(RAND()*100 AS numeric(2,0))+100),2) As numeric(2,0)) またストアドプロシージャは、VBのようにデバッグで1行単位で処理を確認してい くことはできないのでしょうか？
こんにちは。 あるテーブル"T_TABLE"に項目がC1（主キー）、C2が有り、データが以下のように登録されていた場合、 |C1|C2| ------| |BB|XX| ------| |AA|XY| ------| |DD|XZ| ------| とあった場合、 カラムC2に"XY"の値を含む行を第一に優先し、同カラムに"XZ"を含む行を第2に優先し、同カラムに"XX"を含む行を第3に優先して抽出するにはどのようにすればよいのでしょうか？ 抽出するイメージは XY XZ XZ の順です。
サーバーAでOracleデーターベース(10g)が稼働しています（インスタンスは1つ）。 サーバーBに全く同じデータベースインスタンスを構築することを考えています。 サーバーBにはOracleはインスト済みです。 データだけを移すなら expdp/impdb を使ってスキーマ別に移すところですが、 データベースの様々な設定： アーカイブログの設定やSGAのサイズ等など、、、 も完全に同じものを構築したいと思っています。 ----------------------- 1. DBCA を使用 サーバーAでDBCAを使って、既存インスタンスからテンプレートを作成します。 次にそのファイルをサーバーBに移して、サーバーB上でDBCAを使って当該テンプレートからインスタンス作成 => この方法を一度試したのですが、よくわからない点がありました。テンプレートを使っている割には、インスタンス生成の各種パラメータを入力せねばなりません。入力した設定は無視されてテンプレートの値が使われるのでしょうか？それとも、入力した内容が優先されるのでしょうか？あるいはこの方法ではインスタンス生成のパラメータは移せないのでしょうか？ 2. expdp/impdp でFULL=Y データベースをまるごとコピーというならこの方法でもいい気がしますが、まずはサーバーB上にインスタンスを作ってからimpdpをすることになると思います。 するとインスタンスの設定は移されないということになるのでしょうか？ 3. その他の方法 何かもっと有効な方法がありますか？ ------------------------------------- 何卒ご教示のほどをお願いします。
Windows環境でのMySQLのデータベースバックアップで、以下のように文字コードを指定してバックアップが行われています。 mysqldump -uユーザ名 -pパスワード --default-character-set=sjis データベース名 > ****.sql バックアップからリストアするのですが、同じサーバ上で既存の同じデータベース(名)があるので 一度DROP DATABASE データベース名；してからCREATE DATABASE データベース名；を行うつもりです。 以下の２点について教えてください。 (1)create databaseする際に文字コードを指定する必要がありますでしょうか？ create database データベース名 CHARACTER SET sjis; (2)リストア実行時に文字コードを指定する必要がありますでしょうか？ mysqldump -uユーザ名 -pパスワード --default-character-set=sjis データベース名 < ****.sql 因みに ※my.iniには文字コードの指定で、sjis指定の表記がありました。 ※Moveble TypeでMySQLをデータベースとして使用しています。　 よろしくお願いします。
BUTILというユーティリティを使いテキスト変換したのですが文字列はうまく出てるようなのですが数字が文字化けしてるようでうまくいきません 再度教えていただきたいです お願いいたします
ファイルメーカーVer11を使用しています。 以下の方法がよくわかりません。どのようにしたらよいのでしょうか。 ＰＤＦファイルを背景にしたいのですができません。ｊｐｇなどならできるのでしょうか。 正確には以下の事をしたいと思っています。 新規にファイルを作成します。 その際、紙ベースの書類をＰＤＦ化して、背景などで取り込む。 その画像上に合わせて、フィールドを配置したいと思います。 つまり、紙で記入する場所に合わせて、フィールドを配置する。 印刷時に画像ごと印刷をすると、紙に直接記入したのと同じような感じで印刷ができる。 ファイル作成時に、紙と同じように作ればいいのですが、細かい内容が多いので、 取り込んで作成ができればと思っています。 よい方法はないでしょうか。
FileMakerでスクリプトを使用して全レコードを対象外にする方法を教えて下さい。 デジカメでで撮影した写真をFileMakerで管理しています。 流れとしては 1.先頭レコードに移動し 2.「複数レコードを対象外に」を選び該当件数分の数字を入れ、全て対象外に 3.デジカメから画像を取り込み、顧客名や撮影場所や日付等の内容を打ち込み、⌘shift=でその時に取り込んだ内容を一括変換しています。 スクリプトで一度に作業したいのは上記の1～2です。 1～2の作業が面倒なのと、その作業を忘れて3の作業を行うと整理が付かない状態となります。 ご回答のほど、よろしくお願いします。
複数カラム検索をしたいと思い、リンク先の通り、 WHERE concat(field1,char(0),field2) LIKE "%検索語%" としたらうまくいったのですが、 そのページに書いてあることが気になるので、教えてください ▽MySQLで複数フィールドから同一語を検索するには・・・ - MySQL - 教えて！goo 　 http://oshiete.goo.ne.jp/qa/2634613.html ・char(0)て何でしょうか？ ＞%データ%は全件を検索するため効率うんぬんを論ずるような仕組みではない ・どういう意味でしょうか？ ・全件検索する際は、LIKE検索を使わないのでしょうか？ 全文検索エンジン(?)を利用するのでしょうか？ ・全件検索しなければ(例えば2カラムだけ)、LIKE検索を利用しても良いのでしょうか？ ・あるいは、データ規模が少なければ、LIKE検索を利用しても良いのでしょうか？ ＞本番ではこんなことはしませんがあくまでも遊びということで ・どういう意味でしょうか？ ・concatで LIKE 検索を普通はしない、ということでしょうか？ ・それとも、LIKE 検索で、char(0)などのセパレータを挟まない、ということでしょうか？ ・あるいは、全件検索でLIKE検索を普通は使わない、ということでしょうか？
ビートリーブ6.15ファイルをcsvファイルに変換 したいのですがご存知の方教えていただきたいです。ddfファイルはありません 困っておりますよろしくお願いいたします
通販販売管理ソフトを起動しようとすると起動できなくなりました。 ソフトはドットコム通販プロです。 http://www.com2han.com/ 製造元は、再インストールして下さい。という指示でしたが、新しくプログラムをインストールし直しても症状は変わりません。 次のメッセージがでて起動できません。 マクロを実行しようとしたか、Visual BasicでDoCmdオブジェクトのメソッドを使おうとしましたが、現 在地の作業を実行しているために、このアクションを実行できません。 たとえば、コントロールを再描画しているときや、式の値を計算しているときは、フォーム上でアクション を実行することはできません。 しばらくした後でアクションを実行してください。 他のソフトは何も起動していませんが、いつもこのメッセージがでて起動できません。 誰か対応策をご指導下さい。 よろしくお願いします。
テーブル名:AAA カラム: 'fname' ,ename テーブル名:BBB カラム: "id",fcode テーブル名:CCC カラム : "id",'fname',date 上記三つのテーブルAAA,BBB,CCCにそれぞれカラムがあります。 最終的に ename fcode date　の3カラムを結合した状態でSELECTします。 ただし、条件として AAAのfname列とCCCのfname列を紐付けし、尚且つ BBBのid列とCCCのid列を紐付けし、尚且つ CCCのdate列が2012-10-31以上のものだけをSELECTしたいです。 上記を踏まえて下記二点ご質問致します。 (1)私が考えたSQL文は select a.ename ,bc.fcode ,bc.date from AAA a , (select b.fcode ,c.fname ,c.date from BBB b , CCC c where b.id = c.id and c.date >= '2012-10-31' ) bc where a.fname = bc.fname ; です。先にBBBとCCCから紐付けしその結果とAAAを紐付けしています。 このSQL文で間違いがないかどうか判定していただきたく。 (2)もっとスマートな書き方（短く書けるなど)がありましたら、 ご助言いただきたく。 ちなみにデータベースはオラクル仕様です。 宜しくお願い致します。
エクセル 入力フォームのデータを別シートに書き込む方法 １．シート1のA2に日付、B2に文字列、C2に金額、D2に個数、E2に合計金額を入力する。 ２．内容確認後、入力ボタンを押すと、 Sheet2の集計表リンクさせ、尚且つシート2内で１か月分の集計を取ります。 つまりシート1は入力シートで、同じセルに値を入力します（次回はデータが上書きされる）が、シート2では、集計表の１列ずつ下に新しく記録され１か月分の入力がされていく。 このような入力フォーム（マクロ）を作りたいと思っています。 初めて投稿するので、質問がよく分からないかもしれませんが、 よろしくお願いします。
table a ------ user_id ------ user1 user2 user3 user4 user5 ------ table b --------------- user_id role_id --------------- user1 role1 user2 role1 user3 role1 user2 role2 user4 role2 --------------- とします。 １つのＳＱＬ文で、a のすべてのユーザそれぞれが指定role_id に属しているかどうかを検索したいです。 例えば、すべてのユーザそれぞれが　role1 に属しているかどうかを検索します。 欲しい結果は以下の通りです。 ------------ user1 true user2 true user3 true user4 false user5 false ------------ ＬＥＦＴ　ＪＯＩＮ　だと思いますが、うまくいきません。 SELECT a.user_id, b.role_id FROM a LEFT JOIN b ON a.user_id = b.user_id WHERE b.role_id='role1'; 結果は以下になります。 ------------ user1 role1 user2 role1 user3 role1 ------------ ＃Ｗｈｅｒｅで絞って、当然の結果です ＳＱＬをどうかければよいでしょうか。 よろしくお願いします。
以下の処理をしようと考えています。 Aテーブルをカーソルで検索 　　　　→0件だった場合にはエラー　・・・　(1) 　　　　→データが入っていた場合には処理 　　　　→カーソルのデータがなくなったら処理を正常終了 カーソルに入っているデータが0件だった場合、Oracle上ではエラーとはみなされず、処理が正常終了してしまいます。 カーソルデータが0件だった場合にエラーを発生させるにはどのようにコーディングすればよいですか？
お世話になります。 スキーマが二つあります。db1とdb2です。 それぞれ、同じ構造のテーブルを持っていて、格納しているデータだけが違います。 db1にdb2をマージしようとしているのですが、上手くいきません。 手順としては、以下のとおりです。 （１）まず、db1のダンプを取りました。 　　（インポート先でテーブルをドロップしないようにオプションを付加） 　　　c:\>mysqldump -u root --add-drop-table=false -p db1>db1.sql （２）次に、db2に接続してダンプしたファイルをインポートしました。 　　　mysql>\. db1.sql インポートの前後で、テーブルの件数を見たのですが、 変わらないのでマージできていないようです。 以下は当方の使用環境です。 Windows7 Pro 64Bit MySQLServer 5.1（mysql-5[1].1.28-rc-win32） 他に必要な情報があればお聞かせください。 よろしくお願いします。
会員サイトでは10個の資料を掲載しており、 会員の方が資料を開いた際にその会員は資料を確認済みという情報を DB上で管理を行いたいのですが、どのようにテーブルを設計したらよいか ご教示いただきますようお願いたします。 視聴済みの判断としては現在から90日以内に1回以上資料を開いた場合としたいです。
今年からIT企業に勤める者です。 先輩から「JavaとSQLを勉強しといて」と言われました。 Javaも苦手ですが、データベース関係は、研修でサラッと触れてから無視してました。基盤に近い感じがして更に苦手意識があります(文系出身ということも関係しているかも)。 そこで、苦手意識のある人でも学びやすい、データベース関係のテキストや問題集、サイトでオススメのものを教えて下さい。なお、会社はIBMグループということもあり、DB2というものを使ってるそうです(RDBSについてもよくわかってません)。 よろしくお願いします。
お世話になります。 環境：Access2003 　　　 SQL Server 2008 R2 Express 先日、Accessのローカルにあるテーブルが20万レコードを超えた為、SQLサーバーへ移行しました。 しかし、Accessより削除クエリにて（フォーム上に設置した削除ボタンにて）当該テーブルのレコードを削除しようとすると、4分ほどかかりました。 なお、ローカルにあったときは上記操作をしても2、3秒程度で削除完了してました。 PCのスペックやテーブルのレコード数によるかとは思うのですが、ローカルテーブルとSQLテーブルでこんなに時間が違うものなのでしょうか。 また、回避策や何か設定すれば早くなるなどございましたら、ご教授頂けたらと思います。 宜しくお願い致します。
MySQLの公式サイトのリファレンスマニュアルに、そもそもの見方が説明されているページは用意されていますか？ 探したのですが、見当たらなかったので質問させていただきました。 特に斜体の部分が説明がなされているページがあれば大変助かります。 斜体の部分とは、例えば、以下のページのtable_references等です。 http://dev.mysql.com/doc/refman/5.1/ja/update.html 英語の意味からざっくり予想することはできるのですが、直訳してもよく分からないものもあるので。 ご教示のほど、なにとぞよろしくお願い申し上げます。
10月12日に、こちらでVBAの書き方をお聞きした内容の続きになります。 http://oshiete.goo.ne.jp/qa/7744550.html FrmLevelInitの実行が定期的に停止し、ログインできなくなる。 または、一度ID、Passを入力してはじかれた後、Passを再入力し直すとログイン出来る。 の2点が発生してしまいます。 環境がRuntimeを使って使用しているので、作成者が何度もVBAを立ち上げて実行し、再配布している状態です。 すみませんがお手伝い頂けますでしょうか。 Public Sub FrmLevelInit(ParamArray v()) On Error Resume Next If (IsMissing(v)) Then sIdSave = "" sNameSave = "" iUserLevel = 0 Else sIdSave = v(0) sNameSave = v(1) iUserLevel = CLng(v(2)) End If End Sub ' 指定されたフォームのコントロールのタグをチェック Public Sub FrmLevelSet(frm As Form) Dim ctl As Control Dim i As Long For Each ctl In frm.Controls With ctl i = InStr(.Tag, "," & iUserLevel & ",") If (i > 0) Then .Enabled = False End With Next End Sub Public Function LoginId() As String ' ID を返す LoginId = sIdSave End Function Public Function LoginName() As String ' 名前を返す LoginName = sNameSave End Function
MySQL初心者です。 基本的な質問ですが、教えてください。 MYSQLデータベースのバックアップは、コマンドラインからmysqldumpでバックアップを行うと思います。 CMD>mysqldump -u(ユーザーグループ) -p(パスワード) (データベース名)　> (バックアップファイル名).sql バックアップSQLを使って再度リストアで入れなおす場合は、 drop database (データベース名);と create database (データベース名); を実行してから行う必要があるのでしょうか？ (バックアップファイル名).sqlの中身を見てみると、 CREATE TABLE '(テーブル名)' (・・・・ ・・・）の前に DROP TABLE IF EXISTS '(テーブル名)'; のようにテーブルのdropをしてからの処理はあるのですが。
access初心者です。 アパレルの店舗の商品管理をaccessで考えています。 ３店舗の商品管理をaccessで考えているのですが、 accessで商品マスターテーブルを作成の際、サイズも分けて管理したいと考えています。 その際、サイズごとに商品コードを変更していかなければいけないのでしょうか？ accessのみどりの本を見ただけの知識なので、 質問自体が、合っているのかわかりませんが、質問させていただきました
MySQL5.5の準同期レプリケーションを使って、マスターサーバー(insert用)とスレーブサーバー(select用)を組み合わせたサイトを作る予定です。 マスター側のサイトはトリガーとイベントを多用しております。(トリガー13個、イベント8個) 当初、マスター側にもスレーブ側にもどちらにもトリガーとイベントを組み込んでいましたが、テストして分かったことは、イベントがエラーを起こすということでした。 マスター側でイベントが始まり結果をスレーブ側に送ることになるわけですが、同時間にスレーブ側のイベントも始まるわけなので、マスターの結果が送られてきたときにはスレーブのテーブルには計算後の数値が記載されており、結果エラーになってしまうことがわかりました。 そのため、スレーブ側のイベントは削除して構築しています。 問題はトリガーについてです。 マスター側にはAテーブルにインサートするとBテーブル、Cテーブル、Dテーブルが連鎖的に変更されるトリガを組んでおり、スレーブ側も同様のトリガを組んでいます。 幸い、いままでのテストでは、トリガーで計算した値が連鎖的に伝わってもエラーになっていません。 ただ、マスター側に高負荷が掛かり、マスターのトリガの計算よりもスレーブ側の計算のほうが早く終了した場合、イベントの時に起こったエラーが出ないか懸念しています。 テストで壊れるのはいいですが、実際に運用した後で壊れることは許されません。 質問としては、「実際にトリガーを使った高負荷サイトを構築されている方でスレーブサーバーを準同期で設定している方」から、どのように組めばよいかのアドバイスを頂きたいというものです。(こんな高負荷サイトで運用しているがトリガを組んでて問題ないなどという例があるとうれしいです) よろしくお願いいたします。 スレーブのトリガーを外すのが一番簡単な方法なのですが、万一マスターがハングアップした際にはスレーブを昇格させる予定ですので出来る限りトリガーはそのままにしたいと考えておりますが、スレーブ側にトリガを組んだままというのは常識的にあり得ないというアドバイスであればそれでも結構です。 これはお願いなのですが、「他のサイトを調べて回答する」という方は申し訳ございませんがご遠慮願います(私も簡単なテストは済ませており低負荷では問題が生じないことまでは分かっております。ブログに落ちているような経験値はこれと大差ありません。この程度ではアドバイスにならないと感じています。) 実際に運用経験があり、正確な知識をお持ちの方にアドバイス頂きたいと思います。 よろしくお願いいたします。 構成はCentOS 6.3 MySQL 5.5.28です。
こんにちは。Oracle11を使ってます。 大規模システムで大容量のテーブルを毎日バッチで取込む必要が出てきました。 そのテーブル自体カラムが３０前後で、４０００万件あります。 その処理時間に頭を悩ませていましたら、ＭＥＲＧＥ句に巡りあいました。 ＡテーブルからＢテーブルに入れるのですが、列定義(Colum数も全く違う列も存在)が若干違うのですが、それでもこれを使うことは可能でしょうか？ Ａ　　　　Ｂ ----- ----- A1　　　　B1 A2　　　　A2 A3　　　　A3 A4　　　　A6 A5　　　　- またべたのやり方ですと、Aテーブルを全件ループして、ＰＫ連結させて、Select-Ｉｎｓｅｒｔ or Select-Updateになると思うのですが、やはりデータがほとんど同じ場合と全件全部違う場合は、処理時間も軽減されるのでしょうか？
ずっとOracleを使用してきたのですが、このたびSqlServerの使用を検討することになりました。 Oracleでは、パスワードを知らなければDBの中身を参照することはできないですが、 SqlServerでは、Windows認証、SqlServer認証ともに、サーバー管理者であれば、 DBの管理ができるように思います。 開発時はいいのですが、リリース後は、サーバー管理者（客先のシステム部など）にも DBのデータは見せたくありません。 担当部署と開発担当者のみ参照できるよう設定したいのですが（パスワードを知る人間を限定する）、 SqlServerではそのような設定は可能なのでしょうか？
ポスグレDBで以下のような二つのテーブルがあって レコード数、カラム等の構造も同じだったとして カラム1の値が二つのテーブルで同じであり カラム2～4のうちどれか一つでも違うレコードを抽出するSQLがわかりません。 下記の例で言うと抽出結果がスキーマA.テーブルAの「←」のレコードを抽出したいです。 スキーマA.テーブルA カラム1|カラム2|カラム3|カラム4| --------------------------- A |aaaaaaa|bbbbbb|ccccccc --------------------------- B |aaaaaaa|bbbbbb|ccccccc　　　　　　← --------------------------- C |aaaaaaa|bbbbbb|ccccccc　　　　　　← --------------------------- D |aaaaaaa|bbbbbb|ccccccc　　　　　　← --------------------------- E |aaaaaaa|bbbbbb|ccccccc スキーマB.テーブルB カラム1|カラム2|カラム3|カラム4| --------------------------- A |aaaaaaa|bbbbbb|ccccccc --------------------------- B |1111111|bbbbbb|ccccccc --------------------------- C |aaaaaaa|777777|ccccccc --------------------------- D |2222222|bbbbbb|8888888 --------------------------- E |aaaaaaa|bbbbbb|ccccccc よろしくお願いします。
お詳しい方、どうかたすけてください。 環境はMicrosoftSQLです。 やりたいことは、 あるテーブルからデータを取ってくる際に、最後の購入日を今の日付から1週間さかのぼりしながら、 何週間さかのぼったかを、useridと一緒に結果で返したいのです。 select userid , CASE WHEN MAX(購入日) > getdate()-7 THEN 1 WHEN MAX(購入日) > getdate()-14 THEN 2 as 'week' みたいなことなのですが、 これをWHILEを使って、永遠にさかのぼれるようにしたいのです。 例としては、 DECLARE @ss int; DECLARE @Recency int; set @ss = '7' set @Recency = '0' while (getdate()- @ss > '2012-10-01') begin set @ss = @ss- 7 set @Recency = @Recency + 1 SELECT user_id, case when max(購入日)> getdate()-@ss then @Recency as 'week' end from usrbuyingtable こんなかんじかとおもったのですが、 ぜんぜんうまくいきません・・ 文法チェックをお願いします。
スクリプト言語「PHP」とGUI 、 データベース言語「SQL」とCUI は無関係？
実習の考察で困ってます。 スクリプト言語「PHP」からデータベース言語「SQL」を使用し、データベースを扱う標準関数を利用してデータベースへの「接続」「問い合わせ」「切断」を行うというものです。 私の書いた考察は、「GUIの説明・利点欠点。CUIの説明・利点欠点。」です。 画像のようなことを実習中にメモしGUIとCUIについて書きました。 この考察を今回の実習に関連付けたいのですが、どうしたらいいですか？
下記のようなカラムがある時、DBから取得した値を、引数(並べ替え順)に応じて、(同じカラムを)更新するSQL文を教えてください ●カラム id1　sex1　age1　id2　sex2　age2　id3　sex3　age3　id4　sex4　age4　 ●引数例 3 1 2 ※1番目が3、2番目が1、3番目が2 ・「1の数字が付いたカラムの値」を、「3の数字が付いたカラムの値」で更新したい ・「2の数字が付いたカラムの値」を、「1の数字が付いたカラムの値」で更新したい ●質問 ・MySQLだけで処理可能でしょうか？ UPDATE テーブル名 SET id1=(SELECT id3 FROM テーブル名 WHERE id1=id3値),sex2=(SELECT sex3 ……; ・それとも、一度、全ての値を取得して、PHP等で処理するのでしょうか？ UPDATE テーブル名 SET id1=id3値,sex1=sex3値,age1=age3値,id2=id1値 ……; ・他に何か良い方法はあるでしょうか(一旦別テーブル作成後、戻す等) ●環境 MySQL5.1
こんばんわ。 SQLServer2008にて1データベース内の全ストアドを対象に、 ストアドプロシージャ記述内で特定の文字列を検索し、置換する方法を考えています。 以下のようなsqlで、ストアド内に文字列があるものを検索することはできたのですが、 ここから先、「★★★」を「○○○」にREPLACEする方法がわかりません。 select routine_name from information_schema.routines where routine_definition LIKE '%★★★%' and routine_type='procedure' 以下のようなsqlで更新しようとしたら、エラーが発生しました。 update information_schema.routines set routine_definition = REPLACE(routine_definition, '★★★', '○○○') where routine_name = 'XXX' (error：システム カタログへのアドホック更新は許可されません。) 不定期にデータベース名を変更することがあり、ストアドの数が多いため、 一括で変換できる方法がないかと探しています。 手作業で変更していく他ないでしょうか。 なにかヒントだけでもご教示いただけると嬉しいです。 よろしくお願いします。
いつもお世話になっております。 表題の件について教えてください。 使用SQL：Oracle 例えば下記のようなテーブルがあるとします。 【運賃テーブル】 日付　　　出発　 到着　運賃 10月1日 東京 青森 8000円 10月1日 東京 大阪 5000円 10月1日 東京 福岡 8000円 10月1日 青森 大阪 6000円 10月1日 青森 福岡 9500円 10月1日 大阪 福岡 5000円 10月1日 大阪 青森 9800円 10月2日 東京 青森 8000円 10月2日 東京 大阪 5000円 10月2日 東京 福岡 8500円 10月2日 青森 大阪 6000円 10月2日 青森 福岡 9500円 10月2日 大阪 福岡 5000円 10月2日 大阪 青森 9000円 仮に運賃を日付で比較した場合、下記のようになります。 【運賃比較】 　　　　　　10月1日　10月2日 東京 青森 8000円 8000円 東京 大阪 5000円 5000円 東京 福岡 8000円 8500円 青森 大阪 6000円 6000円 青森 福岡 9500円 9500円 大阪 福岡 5000円 5000円 大阪 青森 9800円 9000円 この場合、値上がりがあったら、下記の様に 値上がり（値下がり）があった路線について一目で分かる SQLコードはどの様にかけば良いのか教えてください。 【運賃変更】 出発 到着 10月1日 10月2日 東京 福岡 8000円 8500円 大阪 青森 9800円 9000円 もし上記が可能であるならば、【運賃比較】テーブルの様に データを選択剃る方法についてもご教授ください。 よろしくお願いいたします。
ドラえもん 2012-10-29(月) 10:30 ホームページで公開されていたVBAを流用して、EXCELからデータベースの更新、削除をしようとしています。 データベースの更新に関してはうまく動作するのですが、データ削除を実施すると、 440)データをフェッチ中にエラーが発生しました。ORA-01722数値が無効です。 というエラーが発生してしまいます。 01722のエラー内容をホームページ並びに、本サイトで検索したのですが、 データの型が違うという内容で、類似の内容が無い状況でした。 型が違うという内容に対して、何をどうしたらよいかが分かりません。 コーディングのミスを指摘いただきたく よろしくお願いいたします。 VBAまったくの初心者です。 下記は、マクロの構成です。 (1)B3からR***の領域にデータベースからダウンロードしたデータが表示される。 　***は列数でデータベースの項目数で変化する (2)B2からR2には項目名称が表示されている。 (3)編集用の領域はT2からAJ2に(2)と同じ項目名を表示する。 (4)編集用のデータ領域はT3からAJ20まで。 ※ID並びにパスワードは実際のものから変更しています。 　ORACLE9.0　EXCEL2003 ------------------------------------------------------------- '「データの削除」ボタン押下後の処理 ' oo4o使用時 Private Sub btnDeleteDataoo4o_Click() On Error GoTo ERR_HANDLER 'oo4o用のオブジェクト変数の宣言 Dim OraSession As Object 'セッション Dim OraDatabase As Object 'データベース Dim rs As Object 'データセット(レコードセット) Dim rownum As Long Dim colnum As Integer Dim sSQL As String '削除対象のみを抽出するSQL文の作成 sSQL = "select * from M_TOOL_MEISAI where LINECD=" & ActiveSheet.Cells(3, 20) For rownum = 4 To 20 If ActiveSheet.Cells(rownum, 20) = "" Then Exit For End If sSQL = sSQL & " OR LINECD=" & ActiveSheet.Cells(rownum, 20) Next 'oo4oセッションオブジェクトの生成 Set OraSession = CreateObject("OracleInProcServer.XOraSession") 'oo4oデータベースオブジェクトの生成（DBへUserID:○、パスワード:×で接続） Set OraDatabase = OraSession.OpenDatabase(ActiveSheet.Cells(26, 1), "○/×", 0&) 'oo4oデータセット(レコードセット)の生成（削除対象データのみを返すレコードセットの生成） Set rs = OraDatabase.CreateDynaset(sSQL, 0&) 'レコードセット内の全レコードの削除 Do Until rs.EOF rs.Delete rs.MoveNext Loop 'オブジェクトのクローズ rs.Close 'データ表示の更新 btnGetDataoo4o_Click QUIT_OPER: 'オブジェクト変数用に確保したメモリの開放 Set rs = Nothing Set OraDatabase = Nothing Set OraSession = Nothing Exit Sub ERR_HANDLER: 'エラー処理 'エラー番号とエラー内容の表示 MsgBox Err.Number & ")" & Err.Description Err.Clear GoTo QUIT_OPER End Sub ------------------------------------------------------------------------------- 以上がエラーが発生するVBA 下記は、更新処理で正しく動作するVBA ------------------------------------------------------------------------------- '「データの更新」ボタン押下後の処理 ' oo4o使用時 Private Sub btnUpdateDataoo4o_Click() On Error GoTo ERR_HANDLER 'oo4o用のオブジェクト変数の宣言 Dim OraSession As Object 'セッション Dim OraDatabase As Object 'データベース Dim rs As Object 'データセット(レコードセット) Dim rownum As Long Dim colnum As Integer 'oo4oセッションオブジェクトの生成 Set OraSession = CreateObject("OracleInProcServer.XOraSession") 'oo4oデータベースオブジェクトの生成（DBへUserID:○、パスワード:×で接続） Set OraDatabase = OraSession.OpenDatabase(ActiveSheet.Cells(26, 1), "○/×", 0&) 'oo4oデータセット(レコードセット)の生成（全データを返すレコードセットの生成） Set rs = OraDatabase.CreateDynaset("select * from M_TOOL_MEISAI", 0&) 'データの更新 For rownum = 3 To 20 If ActiveSheet.Cells(rownum, 20) = "" Then Exit For End If '更新対象データの検索 rs.Findfirst ("LINECD=" & ActiveSheet.Cells(rownum, 20)) '編集モードに設定 rs.Edit For colnum = 1 To rs.Fields.Count - 1 Select Case rs(colnum).Type Case 10 rs(colnum).Value = ActiveSheet.Cells(rownum, colnum + 20) Case 8 rs(colnum).Value = CDate(ActiveSheet.Cells(rownum, colnum + 20)) Case Else rs(colnum).Value = ActiveSheet.Cells(rownum, colnum + 20) End Select Next rs.Update Next 'オブジェクトのクローズ rs.Close 'データ表示の更新 btnGetDataADO_Click QUIT_OPER: 'オブジェクト変数用に確保したメモリの開放 Set rs = Nothing Set OraDatabase = Nothing Set OraSession = Nothing Exit Sub ERR_HANDLER: 'エラー処理 'エラー番号とエラー内容の表示 MsgBox Err.Number & ")" & Err.Description Err.Clear GoTo QUIT_OPER End Sub
いつもお世話になります。 Access2010でレポートでの集計を行う際に条件をつけるには、どうすればよいか 教えて下さい。 レポートを作成した際、販売店コードでグループ化しています。 その中で消費者コードのレコードをカウントし、販売店コードフッターでカウント数を プリントしています。 このレコード数をカウントする際に、すべてのレコードではなく、そのレコード内にある 売上額の欄が0円より大きい(売上がある)消費者の件数をカウントするようにしたいと 考えています。 明細行には売上のない消費者もプリントされるため、プリントされる行数とカウント数は 異なってきますが、それはかまいません。 また売上がない消費者も含めた全レコード数も必要ありません。 このような条件を指定するにはどうすればよいでしょうか？ よろしくお願いします。
MySQL5.5でレプリケーション(準同期)を構築しています。 http://it.sifr.me/mysql-semi-synchronous-replica … 上記のサイトを参考に、マスターサーバー(192.168.100.101)からスレーブサーバー(192.168.100.105)にレプリケーションの予定です。 上記サイトをもとに構築していたのですが、レプリケーションの前の段階の 「SFTPで/var/lib/mysql/に接続、PUT」するという単純なことが出来ません。 下記のように192.168.100.101にあるSQLをスレーブサーバー192.168.100.105にSFTPで接続してPUTするという作業をしたころ Couldn't get handle: Permission denied になってしまっています。 [root@sv1 ~]# cd /var/lib/mysqll　　　　　　//192.168.100.101のマスターサーバー上でcd [root@sv1 mysql]# sftp -oPort=22 replica@192.168.100.105　//スレーブに接続 Connecting to 192.168.100.105... replica@192.168.100.105's password: sftp> cd /var/lib/mysql　　　　　　//192.168.100.105のスレーブサーバー上でcd sftp> put master-mysql-data.tar.gz　　　//192.168.100.105のスレーブサーバーにput Uploading master-mysql-data.tar.gz to /var/lib/mysql/master-mysql-data.tar.gz Couldn't get handle: Permission denied　　//エラー sftp> 現在のユーザー設定は以下の通りです。 ユーザー名はいずれも　replica で 192.168.100.101(マスター) ●linuxユーザー(ユーザー名　replica) ●mySQLユーザー(ユーザー名　replica) 　　　ホスト192.168.100.105 スレーブレプリケーションの許可 192.168.100.105(スレーブ) ●linuxユーザー(ユーザー名　replica)(グループ　mysql) ●mySQLユーザー(ユーザー名　replica)　 　　　ホスト192.168.100.101 　　　スレーブレプリケーションの許可&クライアントレプリケーションの許可 と設定しています。 尚、PUT先の192.168.100.105　の/var/lib/mysql/の所有者はユーザー、グループともmysqlです。 mysqlユーザーで行えばput可能のでしょうが、どのサイトを見てもreplication専用ユーザーを作って対応することとなっており、安全上の面からも機能限定のユーザーでputしたく考えております。 対応方法についてご教授いただきたくお願いいたしします。
いつもお世話になります。基本的なことかもしれませんがAccess初心者でよくわからないので 教えて下さい。 Access2010でテーブルからレコードを読み出すフォームを作成し、そのレコードを削除するため、 フォーム上に削除ボタンを設定しました。 削除ボタンをクリックすると小さなウインドウが開き下記のようなメッセージが表示されます。 　　　　　　　　　　1件のレコードを削除します。 　　　　「はい」をクリックすると、削除したレコードを元に戻すことはできません 　　　　　　　　　　「はい（Y)]　　　「いいえ（N)] メッセージのウインドウの下には読みだしたレコードのフォームが表示されていますが、 キーとなる顧客コード（数字６桁）の欄には #エラー　と表示され、その他の項目はすべて ブランクになります。 「はい」をクリックするとレコードは削除されるので処理的には問題ないのですが、 削除する前に確認するためフォーム上の項目を表示したまま残したいです。 どのようにすればよいでしょうか？ 削除ボタンのクリック時の埋め込みマクロの内容は以下のように設定しています。 　エラー時 　　　　　　　　移動先　次 　　　　　　　　マクロ名 　コントロールの移動 　　　　コントロール名　= [Screen].[PreviousControl].[Name] 　マクロエラーのクリア 　　If not [Form].[Newrecord] Then 　　　　メニューコマンドの実行 　　　　　　　　　　コマンド　レコードの削除 If文の最後 　　If [Form].[Newrecord] And Not [Form].[Dirty] Then 警告文 If文の最後 　　If [Form].[Newrecord] And [Form].[Dirty] Then 　　　　メニューコマンドの実行 　　　　　　　　　　コマンド　レコードを元に戻す If文の最後 　　If [MacroError] <> 0 Then メッセージボックス 　　　　　　　　　　メッセージ = [MacroError].[Description] 警告音　はい 　　　　　　　メッセージの種類　なし 　　　　　メッセージのタイトル If文の最後 　ウインドウを閉じる 　　オブジェクトを閉じる 　　　オブジェクトの種類 　　　　　オブジェクト名 　　　オブジェクトの保存　確認 参考にしたAccessのプログラムから削除ボタンをコピーしたため、これが適しているかどうか わかりません。 よろしくお願いします。　　　
Access2007のSQLで質問です。「ユーザが選んだレンタカー営業所に所属する車と、その借主、レンタル日、レンタル期間」を一覧で表示するクエリーを制作しています。 テーブル ■Customer -CustomerID(主キー) -FirstName -LastName ■Book -FK_CustomerID（複合キー） -FK_CarNo（複合キー） -Date -Duration ■Car -CarNo（主キー） -Model ■Own -FK_CarNo（複合キー） -FK_LocationNo（複合キー） ■Location -LocationNo（主キー） -LocationName ------------------------------------------------------------------- LocationNameの中から指定したLocationが保有するCarのBookすべてを表示するクエリーを作りたいです。 クエリーが生成するアウトプットは、CarNo, Model, FirstName, LastName, Date, Duration, です。 以下のSQLを作ってみましたが、"syntax error missing operator.."と表示されてしまいます。 SELECT c.CarNo, c.Model, cs.FirstName, cs.LastName, b.Date, b.Duration FROM Location l INNER JOIN ( ( (Own o INNER JOIN Car c ON o..FK_CarNo = c.CarNo l.LocationNo) INNER JOIN Book b ON c.CarNo = b.FK_CarNo) INNER JOIN Customer cs ON b.FK_CustomerID = cs.CustomerID) ON l.LocationNo = o.FK_LocationNo WHERE l.LocationName =:user_input ;
SQL文の文法エラーの原因が分からないので、ご教示ください。 ものは、掲示板になります。 PHPからSQLを実行しています。 テーブルの中身とSQL文とエラー文は以下の通りです。 【テーブル】 category_id | tinyint(3) unsigned shop_id | tinyint(3) unsigned id | int(10) unsigned name | varchar(255) 【SQL文】 $sql="insert into テーブル名 value(".$_SESSION['category_id'].",".$_SESSION['shop_id'].",".$_SESSION['thread_id'].",'".$_SESSION['name']."')"; 【エラー文】 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ',testname)' at line 1 エラー文中の「testname」は、テストのために、カラム「name」のところにこちらで入れたものになります。 情報に不足があれば、補足するのでおっしゃってください。 以上、よろしくお願い申し上げます。
以下のような表があります。 カテ　年　上下期　売り上げ ------------------------ A　　2011　　1　　10 A　　2011　　2　　12 A　　2012　　1　　9 A　　2012　　2　　11 B　　2011　　1　　11 B　　2011　　2　　15 B　　2012　　1　　8 B　　2012　　2　　10 ここからsqlを使ってどの年のどのカテゴリの年間総売上が一番多いかを結果として出したいです。 なので カテ　年　総売上 ---------------- B　2011　26 という結果が欲しいのですがどうすればよいですか？ SUMを使って年間の総売上は出せるのですがそこからMAXを使っても上のような結果がでません。 またカテゴリに関係なく総売上（A+B）が一番多い年を出すにはどうしたらよいですか？ よろしくお願いします。 なんかうまく表のスペースが反映されなくて見難くてすみません。
SQLで2つの表から条件に合ったデータを取り出し、同じ列に表示させたいのですが、 どうやっても外部結合のようにすることしかできませんでした。 取り出したデータを縦に結合?させることはできるのでしょうか? 例) dataは月の上旬中旬下旬でそれぞれabcとします。 入力値はmonthとdayで、これらからuriageを選択します。 dataの取りうる値はa,b,c,ab,bc,abcとします。 　　 table:A 売上表　　　　　　　　　　　　table:B 上旬中旬下旬判断 ---------------------------　　　----------- 　key　|　data　|　month　|　uriage 　　day | data --------------------------- 　　　----------- 　　1　|　　a　　|　　1　　|　　500　　　　　 1　|　　a 　　2　|　 ab 　|　　1　　|　　800　　　　　…　|　　… 　　3　|　 bc 　|　　1　　|　　400　　　　　10　|　　a 　　4　|　　c　　|　　1　　|　　100　　　　　11　|　　b 　　5　|　　abc　|　　1　　|　　900　　　　　…　|　　… 　 …　|　　…　　|　　…　　| …　　　　　31　|　　c --------------------------- 　　　----------- month = 1 , day =5のとき 　table:Bより 　　SELECT data FROM table:B WHERE day = 5 としてdata "a" を得ます。 この"a"と同じdataを持つuriageを表示させたいので 　　SELECT uriage FROM table:A 　　WHERE month = 1 AND data = (SELECT data FROM table:B WHERE day = 5) として 　table:query1 　-------- 　　 uriage 　-------- 　　　500 　-------- を得ました。 ここまでは良いのですが、これに付け加えて、 table:Bから取り出したdata "a"をtable:Aのdataが含むとき(data = a,ab,abcのとき) その全てのuriageを表示させたく、 ワイルドカードを使おうと 　　SELECT uriage FROM table:A 　　WHERE month = 1 AND data = %(SELECT data FROM table:B WHERE day = 5)% 等としてみたのですが、上手くいきませんでした。 そこで、別のクエリーを作って 　　SELECT uriage FROM table:A 　　WHERE month = 1 AND data = 'ab' AND data = 'abc' として 　table:query2 　--------- 　　uriage 　--------- 　　　800 　--------- 　　　900 　---------- を得ました。 そして、最後に、 得られた2つの表をまとめて 　--------- 　　uriage 　--------- 　　　500 　--------- 　　　800 　--------- 　　　900 　--------- としたいのですが、 　　SELECT uriage, uriage FROM query1, query2 とすると 　------------------ 　　uriage　|　uriage 　------------------ 　　　500　 |　　800 　　　500　 |　　900 　------------------ となりますし、UNIONは使い方がよくわからないためシンタックスエラーにしかならず...。 そもそも、縦に結合?はできるのでしょうか??? あれこれ試してみたのですが、詰まってしまったので、 どなたか知恵をお貸しください。
MySQLでfieldを2916個作ろうと思ったのですが、上限が1000個なのか、1001個目を作ろうとすると下のようなエラーが出ます。 ERROR 1005 (HY000): Can't create table 'features.#sql-1664_18' (errno: 139) featuresというのはデータベース名です。上限をなくす、または大きくする方法があれば教えて下さい。よろしくお願いします。
　いつもお世話になります。 　Access2010のプリンターの給紙トレイの指定について教えて下さい。 　Access2010で作成したレポートをプリントする際、カセットの用紙の有無にかかわらず エラーとなり手差しトレイからの給紙でないとプリントできません。 カセットからの給紙にするには、どうすればよいでしょうか？ 　稼働環境は下記の通りです。 　　パソコン側　Windows7 ServicePack1 64bit 　　プリンター EPSON LP-S1100 プリンターの給紙のプロパフィ　自動選択 　いくつか試してみたので列挙します。 (1)プリンターの給紙のプロパフィを自動選択から用紙カセットに変更しましたが、 　　　 結果は変わりませんでした。 (2)ExcellやWordでプリントする際はカセットから給紙されました。 (3)別のパソコンにプリンターを接続しプリントしましたが、同様のエラーとなりました。 (4)別のプリンター(Canon LBP3000)を接続しプリントした場合は正常にカセットから 給紙されました。 　Accessの問題なのかプリンターの問題なのかもわかりませんが、 　わかる方がいらっしゃいましたらよろしくお願いします。
現在、「1週間で学べるORACLE MASTERの基礎が学べる本」という本を片手にORACLEを初めて触っております。 お恥ずかしい話、2日目の「OEM起動」でつまづいて先に勧めませんので、是非お知恵をお貸しください。 現在作業はVM環境にWin7 x64bitをインストールしホストオンリー環境で構築しています。 テキストでは推奨環境に以下の手順で操作をすすめています。 ネットワーク環境を構築（Loopback アダプタ追加　IP10.10.10.10,GW 255.255.255.0 hosts ファイルにて←の名前解決を追記） 再起動 Oracle11gをインストール リスナーの作成 →　DBの作成　○ここでエラーになります。 DBの削除 OEMの起動 ・ ・ ・ DB作成をしている最中に以下のようなエラーがでます。 ！警告 次のエラーが原因でEnterprise Managerの構成に失敗しました 構成データのリポジトリへのアップロード中にエラーが発生しました。 詳細は　..\dbca/orc/emConfig.logにあるログファイルを参照してください。 ..bin/emcaスクリプトを手動で実行することにより、後でEnterprise Managerを使用してこのデータベースの構成を再試行できます。 ※パスは割愛 裏では別ウインドウで正しくDBを作成できましたとあるので、このエラーを無視してOEMの起動まですすめると、 https://localhost:1158/emでOEMにつなごうとした時にサイトが表示できないとエラーになってしまいます。 この時、テキストには ・Loopbackアダプターの構成されているか ・リスナーが開始されているか ・dbconsoleプロセスが起動しているか を確認しろとあったので、Loopbackアダプタ、リスナーの開始については問題ないことを確認。 ORACLE_SIDを設定し、dbconsoleを確認しようと emcl status dbsonsoleと入れたところ、 Environment variable ORACLE_UNQNAME not defined. Please set ORACLE_UNQNAME to database unique name. というエラーが表示されて手詰まり状態です。 set ORACLE_UNQNAMEとありましたので、orclをsetしてみましたが、エラーメッセージが変わっただけで問題解決にいたりません。 是非、この問題について何かわかればよろしくお願いいたします。
初めまして。PHP・MySQLの初心者で大変恐縮ではございますが、 ご質問させていただきます。 MySQLに画像を保存する際に、方法としてDBに 直接登録する方法（BLOB型）とディレクトリに画像を 格納する方法とがあると思うのですが、 画像を呼び出す際に、この二つの方法によって できる事やできない事、またメリットやデメリットというのもは どういったものなのでしょうか？ 当方の目的としましては、フリーワード等での検索や商品の比較、 買い物かごの制作等を今のところ視野に入れていますが、 この３つの目的以外にも、今後制作して行く上での 参考にできればと考えております。 お力を貸していただければ大変嬉しく思いますので、よろしくお願いいたします。
お世話になります。 ACCESS下記の通りにSQL又はVBAで文字を追加するにはどうすれば良いでしょうか。いい方法があればお手数ですが、教えてください。よろしくお願い致します。 あるテーブルのフィールドに県名があり、例えば青森、岩手、秋田、宮城など記入されている箇所の頭に"東北"と追加し、東京、埼玉、群馬などには"関東"と文字を一括で追加したいのですが、どうすれば良いでしょうか、条件により一括でという方法を調べていたのですが、中々良い方法が分かりませんでした。良い方法を知っている方いらっしゃいましたらよろしくお願い致します。
日付、天気、気温が並んでいるテーブルがあるとします。 そこからデータを抽出して天気ごとにグループ化し、 「天気」「最高気温」「最高気温が出た日付(複数あれば新しいほう)」「20℃以上になった最新の日付」 というビューを作りたいのですが、書き方がわかりません。 単純にグループ化すると最高気温はmaxで出せますが、日付もmaxにすると気温と関係のない最新の日付になってしまいます。 条件をつけたい場合どのようにすればいいか教えてください。
自分はSQL Server がインストールされてるのでしょうか？ コントロールパネルのプログラムと機能の一覧ですが、 これは、SQL Server がインストールされているのでしょうか？
初めて書き込みさせて頂きます。 アクセスのテーブルを帳票形式にて作成して10件づつ表示をさせようとすると一部のデータが表示されません。 方法としては、帳票形式で10件のみ表示出来る様にサイズを調整して「前へ」と「次へ」のボタンをつけて10件づつ表示させています。 ソースは下記の方法で 「次へ」 Private Sub コマンド13_Click() Dim rs As DAO.Recordset, i As Integer Const n As Integer = 10 Set rs = Me.RecordsetClone For i = 1 To n * 2 If rs.EOF Then rs.MoveLast Me.Bookmark = rs.Bookmark Exit Sub End If rs.MoveNext Next Me.Bookmark = rs.Bookmark For i = 1 To n rs.MovePrevious Next Me.Bookmark = rs.Bookmark rs.Close End Sub 「前へ」 Private Sub コマンド16_Click() Dim rs As DAO.Recordset, i As Integer Const n As Integer = 10 Set rs = Me.RecordsetClone For i = 1 To n * 2 If rs.BOF Then rs.MoveFirst Me.Bookmark = rs.Bookmark Exit Sub End If rs.MovePrevious Next Me.Bookmark = rs.Bookmark For i = 1 To n rs.MoveNext Next Me.Bookmark = rs.Bookmark rs.Close End Sub 以上、ご教授の程宜しくお願い致します。
既にあるカラムをコピーして、新たなカラムを作成したいのですが、うまくいきません。 どうしたらいいでしょうか？ INSERT INTO `rtable`.`3_column` SELECT * FROM `rtable`.`2_column` 実行すると、下記エラーになります。 #1142 - INSERT command denied to user 'DBユーザー名'@'localhost' for table '3_column' 通常のINSERTなら出来るのですが、この場合のINSERTは、何か特別な実行権限になるのでしょうか？ 環境:レンタルサーバ ちなみに、テーブルをコピーして、新規テーブル作成するのは、下記で出来たのですが、 「テーブルコピー」と「カラムコピー」では、何が違うのでしょうか？ INSERT INTO `データベース名`.`newtable` SELECT * FROM `データベース名`.`oldtable` ;
質問させて頂きます。 DB：PostgresSQL 言語：PHP 現在仕事情報の入ったテーブルから、金額の高い順にデータを10件取り出したいと考えています。 金額の入ったカラムが１つであれば、order by句で取り出すのですが、今回、時給[hour]、月給[month]、年収[year]と３つのカラムが存在しています。 ※下記のid4のように2つ以上の金額情報カラムを持っているデータも存在します。 ※データの中にはnullでなく0が入っているデータも存在します。 [id][hour][month][year] 1 ,1000 ,null ,null 2 ,1200 ,0 ,0 3 ,null ,300000 ,null 4 ,1500 ,200000 ,null 5 ,null ,null ,3200000 ... 100,null ,250000 ,null 質問の内容なのですが、下記のルールに従いデータを取得する際、どのような方法を行えば一番効率的でしょうか。 「ルール」 １． 金額比較の際、 月給はそのまま、 年収は12で割った金額、 時給に関しては、時給×８(1日の平均的労働時間)×20(1月の平均的な労働日数)の金額とします。 ２． ２つ以上のカラムに金額を持っていた際は(id4のようなデータ)、金額の大きさに関わらず、年収＞月給＞時給の順で取得する。 id4のデータならば、時給の方が月給より高いですが、月給のデータを使用します。年収があれば年収優先。 id2の場合、0はnullと同じ扱いと考え、時給のデータを使用します。 このルールをふまえたうえでデータを取得する際、SQLで全データを取得して、PHPで高い順を判定するべきか、SQLで取得する時点である程度絞って取得した方が良いのか・・・。 SQLに関しての知識が乏しいため、効率的な方法をご存知の方はアドバイス頂けると大変助かります。 よろしくお願いします。
テーブル作成後に複数のカラムを対象にしたプライマリーキー制約を設定することはできるのでしょうか。 テーブル作成時であれば、次の方法により設定することができます。 ※col_name1及びcol_name2に設定したい場合 CREATE TABLE tbl_name (col_name1 int NOT NULL, col_name2 int, col_name3 varchar(255), PRIMARY KEY(col_name1, col_name2)); しかし、一旦テーブルを作成した後に、プライマリーキー制約を設定し忘れたことに気が付き、設定したい場合は、いかなる方法によりできるのでしょうか。 次の方法にて試みたものの、エラーが生じました。 【SQL文】 ALTER TABLE tbl_name MODIFY col_name1 int, col_name2 int, PRIMARY KEY(col_name1, col_name2); 【エラー内容】 ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'col_name2 int, PRIMARY KEY(col_name1, col_name2)' at line 1 テーブルを削除し、再作成時にプライマリーキー制約を設定する方法によっても対応できますが、削除しなくてもこれを行える方法があるのか否かを知りたく、質問させていただきました。
Access2010でレポートを作成し帳票をプリントした際に最後にページヘッダーだけが印字された ものが出力されます。出ないようにするにはどうすればよいでしょうか？ レポートの内容は以下のようなものです。 　まず販売店コードでグループ化し、並べ替えキーに訪問日、住所コード、消費者コードを指定しました。 販売店コードのヘッダーはなくフッターに販売店コード毎の消費者コードのレコードカウント数を 印字するようにしています。 ページヘッダーには販売店コードと詳細行に対応した表題およびレポートの出力範囲（レポートを 呼び出すフォームで販売店コード、訪問日、住所コードの範囲を入力しています）を印字しています。 詳細欄には訪問日や消費者コード等を2行に分けて印字しています。 レポートヘッダーおよびフッター、ページフッターには何も印字していません。 このくらいの情報で判断できるでしょうか？ よろしくお願いします。
オラクルの条件で時間を指定する方法と格闘中です。 ログのようなデータがたくさんあってそこから、 18時～翌2時のデータはいくつあるか。 というSQL文を書きたいのですが、 うまくいきません。以下のようなSQLなのですが、 どなたかアドバイスいただけないでしょうか？ SELECT COUNT(*) as CNT, ID FROM テーブル名 WHERE TO_DATE(DATE型カラム, 'HH24:MI') >= '18:00' AND TO_DATE(DATE型カラム, 'HH24:MI') < '02:00' GROUP BY ID ORDER BY CNT; ちなみにこんなエラーが出ています。 SQLエラー: ORA-01843: 指定した月が無効です。 よろしくお願いいたします。
以下のようなテーブルが3つある場合に2つのテーブルにあるポイントを合計して取得したいと思っています。 ただ、外部結合しているtable_cに条件を与えるとうまく取得できません。 table_cにcdがある場合は条件を指定し、 ない場合は条件を指定しないようにするにはどうすればいいのでしょうか。 【table_a】 id　　　　name ------------------ a1　　　　aaa a2　　　　bbb a3　　　　ccc 【table_b】 b_id　　　　 a_id　　　user_id　　　　point --------------------------------- b1　　　　　a1　　　　00001　　　　5 b2　　　　　a1　　　　00002　　　　2 b3　　　　　a3　　　　00007　　　　10 b4　　　　　a2　　　　00356　　　　10 【table_c】 c_id　　　　user_id　　　　cd　　　　　bonus_point ------------------------------------------------ c1　　　　　00001　　　　cd_1　　　　1 c2　　　　　00007　　　　cd_2　　　　1 c3　　　　　00356　　　　cd_1　　　　1 SELECT table_b.user_id as user_id , (ifnull(table_b.age_count) + ifnull(table_c.bonus_point, 0)) as total_point FROM table_a INNER JOIN table_b ON (table_b.a_id=table_a.a_id) 　　　LEFT JOIN table_c ON (table_c.user_id=table_b.user_id) WHERE table_c.cd = 'cd_1' ORDER BY total_point desc ■結果 user_id　　　　total_point ----------------------------- 00356　　　　　11 00001　　　　　 6 ■求めたい結果 user_id　　　　total_point ----------------------------- 00356　　　 　11 00001　　　 　 6 00002　　　　　2 よろしくお願いします。
コマンドプロントを使用し、SQLでデータベースを作成しています。 大きなテーブルを複数作り、複数のデータの作成をしています。 １．テーブルの方の定義を行い、キー項目を決める。 ２．データは、一つ一つの項目ごとに、データの型やサイズを決める。 ３．いくつか検索をした際に、ちゃんと結果の違いが確認できるように、100レコード程度のデータを作成する。 の制約で制作しています。 SQLに触って、まだあまり経っていないためどうプログラムを組めばいいのか分かりません。　　　　テーブルの意味などや、キー項目、などの言葉の意味もあまり理解出来てません。 例えば データベース：ONLAINGAME テーブル１：ＭＥＭＢＥＲ テーブル２：WEAPON を制作し、MENBERの中に50件、WEAPONの中に50件データを作ればいいのでしょうか。 データの作り方も少し心配です。 create table MENBERl(age int, name varchar(20) , primary key (aa); 上記の文を打ち、insert into MENBER ( age, name) values(20, 'takasi'); と書けば、制約通りデータが格納できるのでしょうか？ 分かりずらいとは思いますが、詳しいお答えお願いいたします。
以下のようなuser_idとuser_pwのtableがあります。 |id(ai)|user_id|user_pw|flg| |1|AAA|111|0| |2|BBB|222|0| select id from table where user_id = AAA をされると 1 を返し、 update table set flg = 1 where id = 1　かまたは update table set flg = 1 where user_id = AAA を発行したいと思っています。 ただ、sql 発行元から2個のsqlを出せない事情があり、DB側で対応しなければなりません。 トリガはselectでは使えませんよね？　 最悪、query_logを監視しながらselectが来たら自分でupdateを発行するスクリプト しかないのかと考えています。 アドバイスお願いします。
下記のような「果物TBL」というテーブルがあるとします。 果物TBL -------------------------------- ID　　　　名前　　　　　　値段 - - - - - - - - - - - - - - - - - - - - 01　　　　りんご　　　　　150 02　　　　バナナ　　　　　250 03　　　　みかん　　　　　250 04　　　　ぶどう　　　　　300 -------------------------------- また上記のテーブルと全く同じ構成の「果物検索TBL」というテーブルがあるとします。 そのテーブルには、例として下記のような値を入れておきます。 果物検索TBL -------------------------------- ID　　　　名前　　　　　　値段 - - - - - - - - - - - - - - - - - - - - NULL　　　りんご　　　　　250 NULL　　　バナナ　　　　　NULL -------------------------------- この時、下記のようなSQLだと SELECT DISTINCT 果物TBL.名前 FROM 果物TBL INNER JOIN 果物検索TBL ON (果物TBL.ID = 果物検索TBL.ID AND LEN(果物検索TBL.ID) > 0) OR (果物TBL.名前 = 果物検索TBL.名前 AND LEN(果物検索TBL.名前) > 0) OR (果物TBL.値段 = 果物検索TBL.値段 AND LEN(果物検索TBL.値段) > 0); -------------------------------- 名前 - - - - - - - - - - - - - - - - - - - - バナナ みかん りんご -------------------------------- という結果になります。(名前：りんご・バナナと値段：250のOR検索) その結果を -------------------------------- 名前 - - - - - - - - - - - - - - - - - - - - バナナ -------------------------------- という結果にするにはどうすればいいでしょうか？(名前：りんご・バナナと値段：250のAND検索、バナナのみマッチ) 単純にORをANDにしてもうまくいきませんでした。 動的にSQLを作れれば良いのですが、この構成は変えられないのでNULL値がネックになり分かりません。 教えてください。 また、記載してるSQLよりもっとスマートな書き方があれば教えてください。
マシンＡとマシンＢにそれぞれ Access2000 がインストールされています。 マシンＡでAccess2000 でデータベースがすでに存在します。 このデータベースには複数のテーブルが存在して、そのうちあるテーブル（「テーブルＡ」とします） とまったく同じ構造のテーブル（データは転送不要）を マシンＢにもってくるにはどうすればいいでしょうか？ マシンＢのデータベース名は別の名称で、かつ、マシンＡのＤＢファイルをマシンＢに複写できないのですがどうすればいいでしょうか？ （テキストファイル程度ならマシンＢにもってこれるという前提です） フィールド数が２個程度なら手入力も考えたのですが・・・
SQLServer2000とAccess2000（adpファイル）でシステムを組んでいます。 データベースとの接続は、アプリケーションの「データリンクプロパティ」内で設定してあり、初期立ち上げフォームに次のコードを記述して接続しています。 Option Compare Database Option Explicit Public cn As ADODB.Connection Sub p_接続開始() 　‘データベースとの接続を行うプロシージャ Set cn = Application.CurrentProject.Connection cn.CursorLocation = adUseClient ‘カーソルをユーザークライアントにする End Sub その後、フォームを開いた状態で一定時間経過すると、ＰＣが「システムスタンバイ」状態になり、スタンバイを解除すると次のエラーが出て接続できません。 「[DBNETLIB][ConnectionWrite(send()).]一般的なネットワークエラーです」 しかしいろいろ試した結果、フォームのクリックイベント時に、次のコードを記述したところ、一時的に接続できるようになり、入力フォーム上のデータがSQLServerに保存出来るようになりました。 Set cn = New ADODB.Connection cn.ConnectionString = Application.CurrentProject.Connection cn.Open しかしその後、このフォームを閉じたり、他のフォームに移動したりすると、「[DBNETLIB][ConnectionWrite(send()).]一般的なネットワークエラーです」が出てエラーとなります。 データベースを終了し、再度開き直すと、完全に元通りに復活しますが、上記でフォームを閉じたり、移動したときに、エラーが出ないようにするにはどうしたらいいでしょうか？ Set cn = New ADODB.Connection cn.ConnectionString = Application.CurrentProject.Connection cn.Open この記述は、試行錯誤の末、出来たものであり、これが本当に正しいかどうかわかりません。 どなたかわかる方教えてください。
Microsoft SQL Server Management Studioを使っています。 テーブル追加時にIDENTITYの設定方法は 載っていたのですが、すでにあるカラムに対して はありませんでした。 すでにあるカラムにIDENTITYの設定方法を教えて下さい。
ｔｒｃファイルを削除する（n日分削除する）スクリプトを作成したいのですが、オラクルユーザにならないと /u01/oracle/diag/rdbms配下へアクセスできません。 スクリプトで（ルートユーザでない）ここのディレクトリへアクセスさせるには何か方法はないでしょうか？
レンタルサーバに依存しないデータベースライブラリ？を探しています。 「MySQL」や「PostgreSQL」のようなデータベースではなく、ファイルをデータベースとして使用出来るものを探しています。 例としては、「Gladius DB」や「txtSQL」等のようなものです。 これらは長い間開発が止まっているようなので、他にも同じようなものがないか探しています。 他にご存知の方がおりましたら教えて下さい。
oracleのSQLパフォーマンスについて質問です。 当方、SQLは初めてで、ずぶの素人ですが、SQLパフォーマンスを改善することになりました。 質問の仕方も悪いとは思いますが、お力添えをいただきたいと思います。 【質問１】 DBのレコード件数は、SQLパフォーマンスにどう影響するでしょうか？以下例のようなことが知りたいです。 例１ INDEXのないテーブルに対しSQLを発行する場合、レコード件数の多いDBとレコード件数の少ないDBでは、レコード件数が少ない方が、パフォーマンスが良い？ （前提として、検索対象DBは、レコード件数以外に差がないとする） 例2 WHERE句にINDEX項目を使用した場合、DBのレコード件数はパフォーマンスに影響しない （前提として、アクセスパスは適切で、検索対象をうまく絞り込むことができる） 例3 WHERE句にINDEX項目を使用したSQLをレコード件数の多いDBに発行する場合と、WHERE句にINDEX項目がないSQLをレコード件数の少ないDBに発行する場合では、どちらがパフォーマンスがよいのか （前提として検索対象DBは、レコード件数以外に差がないとする） 【質問２】 INDEXをDBに追加すると、INSERT、UPDATE、DELETEの際に、どのくらい影響するのでしょうか？ 対象のDBは、5項目あり、400万件くらいのレコードがあります。また、複合項目（2項目）のプライマリキーと、単一INDEXがついており、新たに3項目の複合INDEXを追加しようとしています。 以上、よろしくお願いいたします。
データベースの正規化で第一正規化、第二正規化、第三正規化 がありますが 「第一正規化」では、データの重複をなくす事をする 「第二正規化」では関数従属をおこないxの値が決まればyの値が決まるのと同じように あるキーが決まれば、他のキーも決まるようになること 「第三正規化」では関数従属をなくすと聞いたんですが、意味がわかりません 解釈としてはキー項目を２つ組み合わせてある項目を決めると解釈であってるでしょうか？？ 第一正規化と第二正規化はこの解釈でいいでしょうか？？ バカな質問ですいません データベースの正規化の理解に苦しんでいます 回答おねがいします。
使用環境は　DB　SQL Server2008 Express 使用ツールは　Microsoft SQL Server Management Studio です サーバーは 64bit です インストールファイルは　SQLEXPRWT_x64_JPN.exe　です 現在、同じネットワーク上には　SQLServer 2000のDBを使ったサーバーはあるので すがSQLServer2008は1台だけです 今回　SQL2008のDBを 2000の方にバックアップ用としてコピーしたいと思います ファイルの保存だけであれば可能かと思いますが　万が一の時に 接続先を変更して使えるようにしたいと思います。 認識として、 ・データファイルやログファイルは上位DBから下位DBへアタッチ操作はで きない (上位DBのファイルを下位DBがアタッチ操作できない） ・データベースコピーはできない そこで　データコピー　をしたいと思っています。 下記　HPを参考にフリーソフト(DBCopyTool.exe)を使ってみたのですが http://www.atmarkit.co.jp/fdotnet/dotnettips/859 … サーバーの登録はうまくいくのですが、対象DBの登録について SQLServer2008express や　SQLServer2005express　はうまくいくのですが SQL2000のサーバーでは、下記メッセージが出てきます Fehler:Error getting the database.オブジェクト名'sys.database'は無効です 確認したいのは　上記フリーソフトを使われたことがある方、同じような現象には ならないかどうか 何か設定、確認不足なのでしょうか？ また当初の希望内容を実現するため、他の方法があれば　ご教授願いたいと思いま す。 同HP内の文末に、SQLServer 2000とSQL Server 2008との間でコピーが正しく行え た　とあり決して依存するわけではないのですが、もしやと思い試しているのですがうまくい きません。 仮に　2000のDBを2008にコピーできるとしても、該当DBの選択のところでエラーが 出てしまうのはクリアする必要があると思うのですが… 以上　宜しくお願い致します。
商品マスタがあり、データは下記の感じで登録されています。 　コード　|　商品名　　|　商品カナ　|　分類コード　・・・ --------------------------------------------------------- 　0001　　|　マウス　　|　マウス　　|　01　　　　　・・・ 　0002　　|　キーボード|　キーボード|　01　　　　　・・・ 　0003　　|　モニター　|　モニター　|　01　　　　　・・・ 　　　　　　　　　・ 　　　　　　　　　・ 　　　　　　　　　・ SQL文で質問があります。 下記のSQLでは取得できるんですが・・・ SELECT * FROM M_SHOHIN WHERE code = ANY('{0001,0002,0003}'); 下記のSQLを実行したらエラーが出力されました。 SELECT * FROM M_SHOHIN WHERE code = ANY( 　SELECT ARRAY_AGG(code) AS code FROM M_SHOHIN WHERE class_code = '01' ); ERROR: operator does not exist: character varying = character varying[] HINT: No operator matches the given name and argument type(s). You might need to add explicit type casts. なので下記のようにCASTをするようにして実行したらエラーは出力されなくなりましたがデータの取得ができませんでした。 SELECT * FROM M_SHOHIN WHERE code = ANY( 　SELECT CAST(ARRAY_AGG(code) AS VARCHAR) AS code 　FROM M_SHOHIN WHERE class_code = '01' ); どのようにすれば取得できますでしょうか。 説明が下手で申し訳ありませんがアドバイスいただけませんでしょうか。 データベースはPostgreSQL 8.4.9です。 宜しくお願いします。
現在SQLServer2005 の WorkGroup を使用しています。 現在のPCでは処理が遅い為、新たにPCを新調し、更にSQLServer2012 Standardも購入する予定です ここで質問なのですが、 SQL2005で作成したテーブルのファイル「○○.mdf」と「○○.ldf」は SQL2012でも読み込むことは出来るのでしょうか？ もっと単純に言うと SQL2005で使ってたHDを抜いてSQL2012をインストールした新PCに繋げて アタッチすればそのままSQL2012で使うことはできるのでしょうか？
Microsoft SQL Server Management Studioを使っています。 下記のクエリを実行するとエラーが出ます。 クエリ alter table Test_table modify name nchar(20) エラー メッセージ 102、レベル 15、状態 1、行 1 'modify' 付近に不適切な構文があります。 今の状況はnchar(10)なのですが、 nchar(20)に変更したいのですが、 どうすればよろしいでしょうか？ 参考にしたURL http://www.syboos.jp/database/doc/alter-table-mo …
Access2010を使用しています。 フォーム：ログインにID、PASSのテキストBOXを設け、フォーム：メニューのコマンドボタンをID別に使用不可にしています。問題は、メニューからさらに製品仕様書の一覧フォームを開き、指定の製品の詳細フォームを開くのですが、詳細フォームにログインで入力したIDを使用し、使用不可コマンドボタンを作りたいのです。 ログインボタン Dim Res If IsNull(Me.ID) Then MsgBox "IDを入力してください" Me.ID.SetFocus Exit Sub End If If IsNull(Me.パスワード) Then MsgBox "パスワードを入力してください" Me.パスワード.SetFocus Exit Sub End If Res = DLookup("パスワード", "talogin", "ID='" & Me.ID & "'") If IsNull(Res) Then MsgBox "該当するIDはありません。正しいIDを入力してください。" Me.ID.SetFocus Exit Sub End If If Res = Me.パスワード Then DoCmd.OpenForm "メニュー" '----ID,pass合致でフォームを開く。 Forms!メニュー!ログイン名 = Me.ID Else MsgBox "パスワードが異なります。", vbOKOnly + vbCritical Me.パスワード.SetFocus End If End sub ログインボタンで、テーブルtaEnabledを参照。不可リストに書き込んだボタン名のみ、使用不可にする。 メニュー画面にログイン名を表示。 Private Sub Form_Open(Cancel As Integer) Dim AID As Long Dim Var As Variant AID = Nz(DLookup("権限ID", "taLogin", "ID ='" & Forms!ログイン!ID & "'"), 0) For Each Var In Split(DLookup("不可リスト", "taEnabled", "権限ID =" & AID), ",") Me.Controls(Var).Enabled = Flase Next Var End Sub この後、フォーム：メニューに設置の各帳票・単表フォームを開いた時に、再度IDを使用し、表示したフォーム内のコマンドボタンを使用不可にしたいので、皆様のお力をお貸し下さい。
いつもお世話になります。 入力モードの指定の仕方について教えて下さい。 フォームを開く際にWhere条件式で [顧客コード] = [顧客コードは？] と指定しています。 それで顧客コードの入力を要求してきた時に入力モードが「ひらがなモード」の時と 「半角英数」の時があります。 直前に入力したモードがそのまま使われているように思うのですが（違うかもしれませんが） 顧客コード入力の際は「半角英数モード」にしたいのですがどのようにすればいいでしょうか？ テーブルやフォーム内のテキストボックスならプロパテイのIME入力モードやIME変換モードで 指定すればよいのでしょうが、Where条件式のパラメーターの場合はどこで指定すればよいか わかりません。よろしくお願いします。 それから関連するかもしれませんので、もう一つ教えて下さい。 プロパテイのIME入力モード保持というのはどういうふうに使うのでしょうか。 今はすべて いいえ にしているのですが、何か有効に使えるのでしょうか。
データベースを用いたWEBサービス（趣味であり、商用でない）を作り始めたのですが、相談相手もいない素人が超初心者向けの本を片手に一人で作っているので、オリジナリティ溢れる珍妙な運用になっていないか相談させていただきたくお願い申し上げます。 以下、私の行っている運用の概略について記します。 レンタルサーバーを借りて、そこにPHPファイルやCSSファイルやHTMLファイルやデータベースを置いています。 私のPCにも同じものを置いています。 ローカルで更新して、問題がなさそうなら、レンタルサーバーの方も更新しています。 レンタルサーバーに置いてあるものは、WEB上で公開するためのものです。 ローカルがテスト用といった感じです。 PHPファイルや、CSSファイルはFileZillaを使ってアップロードしているのですが、データベースの方をどのように更新すれば、効率的かが分かりません。 これまで（といっても最近始めたばかりですが）は、レンタルサーバーの方のテーブルを削除して、ローカルでエクスポートしたSQLファイルを、レンタルサーバーにインポートしていました。 これは流石に非効率すぎだろということは、素人の私でも気が付くので、この度、相談させていただく次第でございます。 なお、レンタルサーバーは無限サーバーというところのものを使っています。 http://mugenserver.jp/ phpMyAdminが使える環境です。 それぞれのphpMyAdminバージョンは以下の通りでございます。 レンタルサーバー：3.4.10.1 ローカル：3.4.5 MySQLのバージョンは確認の仕方がよく分かりませんでした。 必要であれば、調べた後、補足欄に書き込みますのでご指示ください。 データベースについて、どのような運用を行うべきでしょうか？ 素人の私でも可能な現実的な運用をお示しいただければ大変助かります。 素人ですがやる気はありますので、よろしくお願いします。 その他、アドバイスに際して必要な情報があれば、お申し付けください。
お世話になります。 Access2003を利用しておりますが、一つのクエリで以下の算出(抽出？)は可能でしょうか。 検品テーブル 　・ID 　・ライン 　・グループ 　ID　ライン　グループ 　1　　L1　　　　G1 　2　　L1　　　　G1 　3　　L1　　　　G2 　4　　L1　　　　G2 　5　　L1　　　　G2 　6　　L2　　　　G3 　7　　L2　　　　G3 　8　　L3　　　　G4 　9　　L3　　　　G4 　10　 L3　　　　G4 　11　 L3　　　　G4 　12　 L3　　　　G5 　13　 L3　　　　G5 　14　 L3　　　　G6 　15　 L4　　　　G7 結果として、一つのラインでのグループ数の最大値(上記の例だとL3はグループが3つあるので3)を一つのクエリで算出したいと考えております。 以下のように3つのクエリを作成すれば結果は得られるのですが、できれば一つのクエリでやりたいところです。 　(1)検品テーブルを、[ライン]と[グループ]でグループ化 　　　L1　G1 　　　L1　G2 　　　L2　G3 　　　L3　G4 　　　L3　G5 　　　L3　G6 　　　L4　G7 　(2)上記クエリをグループ化し[グループ]をカウント 　　　L1　2 　　　L2　1 　　　L3　3 　　　L4　1 　(3)上記クエリでグループカウントの最大値 　　　　　3 この最大値3を算出するのを一つのクエリで行いたいのですが、可能でしょうか。 ご教授お願い致します。
教えてください。 DBサーバ(Windows2003)にログインし、コマンドプロンプトで >mysql -u(ユーザ）-p(パスワード) を実行し、mysqlモードに入ってから select * host,user from mysql.user; をしたところ、hostの一覧で"%"というマークが表示されています。 これはhostが特定されていないという意味でしょうか？
使用環境は　DB　SQL Server2008 Express 使用ツールは　Microsoft SQL Server Management Studio です サーバーは 64bit です インストールファイルは　SQLEXPRWT_x64_JPN.exe　です インストール時に　既定のインスタンス名　を選択し Management Studio ツールを使って接続しようとしたのですが サーバー名￥SQLEXPRESS になってしまいます 希望する内容は　サーバー名のみ　で接続したいのです 正確には　最初、名前付きインスタンス名(SQLEXPRESS)を選択して インストールしてしまい　あとでアンインストールし　 既定のインスタンス名で再インストールしているのですが 上記内容になります。 アンインストール後　関係フォルダを削除(一時　別フォルダに保管)しました 具体的には　C:\Program Files\Microsoft SQL Server　のフォルダを 一時別のフォルダにして、再インストールしてみたのですが結果は同じでした。 ちなみに、SQLServer2005Express　では　上記フォルダを削除(移動)することで インスタンス名は付かなくて　サーバー名だけになりました。 何か不要な設定が残っているように思いますが… 確認したいのは　SQL Server2008 Express　では　インスタンス名を無しにするこ とができるのかどうか 再インストール時、削除するフォルダが足りないのかどうか 以上　宜しくお願い致します。
任意の時刻にデータをモニタリングしているシステムがあり、データがMS SQL Serverに保存されています。 int ID int DeviceID 端末番号 int DeviceValue 計測値 smalldatetime DeviceTime 日時 これを、任意の日時範囲を指定し、一日単位で集計された、端末ID、計測値の最大値という形式で取得したく思います。 計測日　端末番号　計測最大値 2012/01/01 10002 34543 2012/01/01 10003 33211 2012/01/02 10002 23450 ... ... DBが得意でないため、困っています。 どなたかお助けいただけないでしょうか？
お世話になります。 下記テーブルを紐付けてクエリを作成します(Access2003)。 受注テーブル 　・ID 　・コード 　・数量 検品テーブル 　・ID 　・コード 　・検品フラグ マスターテーブル 　・ID 　・コード 　・印刷フラグ 検品テーブルのレコードは、受注テーブルの数量合計が展開されたレコード数となります。例えば、AAAというコードで数量合計が8の場合、検品テーブルではAAAのレコードが8レコード存在することになります。 但し、マスターテーブルの印刷フラグがYesとなっているものは、数量がいくつあっても受注テーブルは1レコード作成されます(数量合計で展開しない)。 　受注テーブル 　　ID　コード　数量 　　1　　AAA　　　5 　　2　　AAA　　　3 　　3　　BBB　　100 　検品テーブル 　　ID　コード　検品フラグ 　　1　　AAA　　　Yes 　　2　　AAA　　　Yes 　　3　　AAA　　　Yes 　　4　　AAA　　　Yes 　　5　　AAA　　　Yes 　　6　　AAA　　　Yes 　　7　　AAA　　　No 　　8　　AAA　　　Yes 　　9　　BBB　　　Yes 　マスターテーブル 　　ID　コード　印刷フラグ 　　1　　AAA　　　No 　　2　　BBB　　　Yes こんな感じです。 そこで各テーブルをコードで紐付けてグループ化し、検品フラグYesで抽出した状態で以下の結果を表示出来るようにしたいところです。 コード　数量合計 　AAA　　　7 　BBB　　100 要するに印刷フラグがYesのものは受注テーブルの数量合計を表示し、それ以外は検品された数を表示させたいと考えています。 あらかじめ受注テーブルでコードでグループ化し、数量の合計を算出するクエリ(※1)を作成し、そのクエリと検品テーブル、マスターテーブルを紐付けたらうまく表示出来ました。 ※数量合計はIIFで印刷フラグ=Yesの場合は※1の数量合計を、Yesではない場合は検品テーブルのレコードカウント数を表示。 しかし、できれば一つのクエリで上記の結果を表示させたいのですが、可能なのでしょうか。 ご教授お願い致します。
ある程度の区域がまとめられた、日本の住所データベースはないでしょうか？ 現在、食べログのようなウェブサービスを構築しているのですが、 食べログのように、住所をある程度のエリアごとに区切りたいと考えています。 例えば、食べログでは、北海道の住所を、 札幌市内（市街地） 札幌市内（北部） 札幌市内（南部） 旭川・富良野・士別 ・・・ と１２のエリアに区切っているようです。 （食べログは１２のエリアからさらに細かく切っているようですが、今回そこまでは求めません） こういった住所のデータベースはどこかで手に入らないでしょうか？ もしくは、簡単な構築の仕方はないでしょうか？ やはり、郵便局のサイトでダウンロードできる住所データベースから、 手作業でここからここまではhogeエリア、と自身で、決めていくしか無いのでしょうか？ （地方の土地勘もないので、それもうまくいかなそうな気がしますが）
業務システムでPostgreSQL８．３を利用しており日次でバックアップを行っています。しかし、もしシステム稼動中にサーバー障害が発生した場合、データの復旧可否が利用者にとって一番気になるところだと思います。（日次バックアップは実施しているので前日データまでは復旧できると思います。） そこで質問なのですが、最新データまで復旧するとなるとログデータが必要になると思いますが、サーバが何らかの障害でログデータすらサルベージできない状況が起きることを想定して、ログデータも別のサーバに常に退避するように設定することは可能でしょうか？（無知ですみません） 可能な場合、PostgreSQLにおける上記の具体的な実施方法を教えて頂けないでしょうか？（お恥ずかしい限りではありますが、そもそもこの方法が妥当かどうかも判断できていないです） 上記の中で、質問者はデータベースのことを分かっていないと判断されましたら、合わせてアドバイス・一般論なども頂けると幸いです。 何卒、よろしくお願いします。
3フィールド以上からなる zaikoテーブルに商品情報を登録しています。 このshohinフィールドのshohin ごとにkazu を取りだしたいのですが、 　　SELECT shohin, COUNT(*) AS kazu FROM zaiko GROUP BY shohin;　は +--------+------+ | shohin | kazu | +--------+------+ | A | 1 | | B | 3 | | C | 5 | | D | 7 | +--------+------+ と出ます。 　　SELECT COUNT(*) AS kazu FROM zaiko GROUP BY shohin; もデータが返りますが、A商品だけを取り出そうと 　 SELECT COUNT(*) AS kazu FROM zaiko GROUP BY shohin WHERE shohin='A'; とすると、ERROR 1064 (42000): が出てしまいます。 Aだけを取り出すsql 文はどのように書けばよいでしょうか？
■知りたいこと ブログカテゴリー(親・子) を取り扱う際、普通は「1テーブル」でいくのでしょうか、それとも、親と子の2テーブルを作成するのでしょうか？ ・それぞれのメリットデメリットは？ ・「ケースバイケースによるので一概には言えない？」or「どちらでも同じ？」 ・また、「2テーブル(親子)」に分けることを正規化というのでしょうか？ ■現状 ・1テーブルで運用(parent_idカラム利用) ・子カテゴリー数が多くなると、phpMyAdmin等で目視する際、カテゴリーテーブルから親カテゴリーIDを探しづらくなる(条件で抽出するので、大きな問題ではないですが)
次のような表があるとします。 科目　点数 英語　93 英語　96 英語　88 独語　95 独語　83 仏語　84 仏語　89 たとえば90点以上取った回数を調べたいだけなら、 select 科目,count(科目) as 回数 from テーブル where 点数>=90 group by 科目; とすればよいのですが、 科目、85点以上の回数、90点以上の回数、95点以上の回数 というふうにまとめたいとき、上記SQL文の数字を変えたものをjoinするしかないのでしょうか？ 簡単なやり方があったら教えてください。
縦・横いっぱいに数値の入った表があります。 この表の縦・横の合計値を求めたのですが、移動すると合計値が変わってしまいます。 合計値を変える事なく移動する方法を教えてください。（ＥＸＣＥＬのマクロで求めた）
桐　のヘルプによると　 「日付選択で　カレンダーを使用して、検索する日付を選択します」と あるのですが　カレンダーは　全く出てきません。 桐の　どのメニューから選べばできるか　ご存じの方　教えてください。 要は　カレンダーを利用して　日付データを　入力したいのです XP 桐　V9 よろしくお願いします。
当方デザイン関係の会社に勤務しています。 FileMakerを使って、作成済のデザインのJPEGデータの管理をしています。 JPEGデータには、会社での管理番号をつけて保存し、それをオブジェクトフィールドに挿入しています。 FileMakerでもFinderからでも管理しやすいように、FileMaker上に「ファイル名」というフィールドを作成し、JPEGのファイル名を入力しています。 手順としてはFinder上でJPEGのファイル名をコピーし、「ファイル名」フィールドにペーストしています。 しかし、入力するデザインの点数（レコード数）が多いと、いちいちFinderとFileMakerを行ったり来たりしなければならず、またたまに入力ミスが発生することもあります。 オブジェクトフィールドに読み込んだJPEGファイルのファイル名を、「ファイル名」フィールドに自動入力化する方法はないでしょうか？ 当方のPC環境はiMac、OS X10.6、FileMaker Ver10を使用しています。 ご回答のほど、よろしくお願いします。
　表題ではなんのことかわわからないと思います。 詳しく説明するのでみていただけますか。 顧客テーブルにレコードを追加、変更するため下記のようにしました。 (1)メインメニューで「顧客登録」ボタンをクリックする。 (2)顧客登録フォームを開く。この際埋め込みマクロのWhere条件式で [顧客コード]=[顧客コードは？]と指定する。 (3)該当のレコードがあればレコード内容が顧客登録フォーム上に表示される。 　　該当のレコードがなければ（新規登録）空の顧客登録フォームが表示される。 この時、フォーム上の顧客コード欄もブランクのため再度顧客コードを入力する ことになります。 二度手間を避けるため、一度入力した顧客コードを空のフォーム上に表示させるには どうすればいいでしょうか。 それから別の質問になるかもしれませんが、当初は(2)では単に空のこ登録フォームを 表示させ、顧客コードを入力しEnterキーを押した時に(3)に進むようにするつもりでした。 （通常はこちらのやり方かと思いますが） しかし(2)から(3)へ進む際の処理の仕方がわからず最初に記したやり方にしました。 こちらのやり方でするにはどうすればよいかも教えていただければ幸いです。
以下のエラーが出ました。 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '?') + 1).split('&'); for(var i = 0; i < hashes.length; i++) { hash =' at line 1 ) You～nearまではいつもどおりなので分かるのですが、その後が何やらよく分からないので、見方を教えていただけないでしょうか？ なお、SQL文は以下の通りです。 select カラム名1 from テーブル名 where カラム名2=$i
SQLite　バージョン3.7.10　を使用しています。 テーブルの構成などはこちらをご覧ください http://ideone.com/T50DH 次のような条件で結果を出力すると、 select sum(t5.amount * (t4.percent / 100.0)) result from ( ( select strftime('%Y', date) year, t2_key, t3_key, amount from t5 where strftime('%Y', date) = '2011' ) t5 inner join t2 on (t2.key = t5.t2_key and t2.name = 't2_name1') inner join ( select t4.* from t4 inner join t1 on (t4.t1_key = t1.key and t1.name = 't1_name1') ) t4 on (t5.t3_key = t4.t3_key and t5.year = t4.year) ); '2011'、't1_name1'、 't2_name1' の計算結果が出力されます。 例えばこの条件で、 '2011'ではなくて'2012'の計算結果を得たければ '2012'、't1_name1'、 't2_name1' の値をいちいち手動で入力してその都度求めれば出来るとは思いますが、 この３つの条件を全パターン出力してくれるようなSQL文を書くことはできないでしょうか？ 例えば '2011'、't1_name1'、 't2_name1'　の計算結果12300.0 '2011'、't1_name1'、 't2_name2'　の計算結果・・・ '2011'、't1_name2'、 't2_name1'　の計算結果・・・ '2011'、't1_name2'、 't2_name2'　の計算結果・・・ '2012'、't1_name1'、 't2_name1'　の計算結果・・・ '2012'、't1_name1'、 't2_name2'　の計算結果・・・ '2012'、't1_name2'、 't2_name1'　の計算結果・・・ '2012'、't1_name2'、 't2_name2'　の計算結果・・・ というような結果を得たいです。 これはどのようなSQL文になるのでしょうか？
　いつもお世話になります。 　昨日教えていただいたテーブル内の消費者データを姓をフォームから入力して 検索する処理の中でわからないことがあるので、また教えて下さい。 　処理の流れとしては下記のようにしています。 (1)メインメニュー（フォーム） (2)検索メニュー（フォーム） (3)検索条件入力（フォーム） (4)検索実行（クエリ） (5)検索結果表示（フォーム） (3)のフォーム内の「検索」ボタンの埋め込みマクロで(4)と(5)を呼び出したあとに (3)と(4)を閉じるように指定しています。 　(1)～(3)は順番に新しいフォームが一番前に表示されるのですが、(5)のフォームが後ろに 　隠れていてクリックして前に出さないと見られません。 　できれば(3)のフォームで「検索」ボタンをクリックすれば検索結果が一番前に表示される 　ようにしたいのですが、できるでしょうか？ 　宜しくお願いします。
SQLServer同士のサーバで、別のサーバーの特定のViewを参照する事ができますか？ ＜例＞ Aサーバーで、BサーバーのViewを参照 Select * From [B].[aaa].dbo.v_xxxx 上記のようなことがしたいのです。 データの内容上、他のテーブル・ビューは参照させたくありません。 可能な場合、お手数ですがその方法もご教授頂けるととても助かります。 宜しくお願い致します。
以下のようなSQLがあるとき、「best」カラムだけ、後で利用する際、「セレクト１」「セレクト２」何れのカラムから(どちらのテーブルから)取得したか知りたいのですが、どうすれば良いでしょうか？ ＜SQL文例＞ SELECT id, tom, best, center, dragon 　FROM ( 　　SELECT m.id, m.tom, m.best1, m.center, u.dragon FROM main m　←セレクト１ 　　　LEFT JOIN usa u ON m.usa_id = u.id 　　UNION ALL 　　SELECT s.red_id, s.red_title, s.best2, s.center, u.dragon FROM sub s　←セレクト２ 　　　LEFT JOIN usa u ON s.usa_id = u.id 　) as PIYO ＜希望＞ 「id, tom, best, center, dragon」ではなく、 「id, tom, best1, center, dragon」＋「id, tom, best2, center, dragon」で取得したい ＜質問＞ ・SQL生成の方法がおかしいのでしょうか？ ・「セレクト１」「セレクト２」を2回実行して、どーにかして足せば良いのでしょうか？ ・そもそもSQL側で足す、という考えが間違っているのでしょうか？ この場合は2回実行して、スクリプト側で処理すべきなのでしょうか？ ＜最終的にやりたいこと＞ ・「main」「sub」テーブルよりLIKE検索を行い、それぞれでヒットした該当レコードを取得したい ※UNIONを利用し、検索結果を両テーブルより取得表示するとこまでは出来たのですが、「main」「sub」何れから取得したか判断出来ないため、そこからリンクが貼れず、再考しています
ACCESS2003で作成したデータをACCESS2010で使用しています。 問題なく使用できていたのですが、エラー（フォームやマクロが消去）が発生し、 再度、エラーについて、再登録し、不要なテーブルデータも削除しました。 最後に最適化をしようと実行すると、初回にエラーメッセージ（内容は不明）が表示され、 最適化が中断されました。 データ自体共有フォルダに保存しているため、他のＰＣ（ACCESS2003）で、最適化しても 同様に中断されます。 データ容量が２ＧＢ近くあるため、それが原因なのか、もしくは他の要因なのかがわかりません。 不要なテーブルデータを削除したので、１．５ＧＢくらいにはなるはずですが・・・ 申し訳ございませんが、わかる方がいらっしゃいましたらご教授願います。
Accessで作成した消費者テーブルから姓だけを指定してレコードを抽出するため 下記のようにフォームとクエリを作成しました。 　1.フォーム名　frm検索1 フォームから姓を入力するパラメーター名　消費者名 2.クエリで指定した条件式　　Like "[Forms]![frm検索1]![消費者名]*" 　 テーブルではフィールド名は　消費者名、データ型は　テキスト型　で定義しています。 上記の指定で検索を実行したところ、検索結果は0件となりました。 どう指定すれば良いでしょうか？　　
SQL Server Compact 3.5 SP2について教えてください。 現在、SQL Server 2008R2で運用されているWebアプリケーションシステムがあります。 ASP.NETで作られており、データアクセスはLINQ for SQLで動作しています。 今回、ちょっとしたサーバ移転があり、データアクセスの頻度がさほど高くない理由から、SQL Server Compact 3.5での稼働を計画しています。 （Compact 4.0だとLINQが動作しないらしいので） で、開発環境（VS2012）にてSQL CE3.5のファイルを作ろうとしたところ、サーバエクスプローラのプロバイダ選択画面で、CE3.5も4も出てきません。 （通常のSQL Serverや、mdf形式のSQL Serverプロバイダは正しく出てきます） そこで質問なのですが、 ・SQL Server CE3.5はVisual Studio 2012に対応しているのでしょうか？ ・皆さんのVisual Studio 2012では、SQL Server CEをデータプロバイダとして、サーバエクスプローラを動作させることができますか？ よろしくお願いします。
ｐｈｐＭｙＡｄｍｉｎでデータベースの照合順序を変更したいのですが、危険なのでしょうか？ 色々調べましたが、難しくてよくわかりません。 ワードプレスのプラグイン部分の文字化けを修正するため、 ・プラグインのテーブルの照合順序 ・プラグインのテーブルのカラムの照合順序 ・データベースの照合順序 を「utf8_general_ci」に変更しようとおもうのですが、 合っておりますでしょうか？不要なものはありますか？ データベースについてはバックアップをとる必要があるのでしょうか？ プラグイン自体の過去の登録内容は消えてもＯＫです。 詳しい方、ご意見をいただければと思います。
いつもお世話になります。 また知恵をお貸し願えませんか。 　テーブルのデータをキーを指定して呼び出し修正して更新するフォームを作成しました。 修正をしたあとの処理のため「更新」ボタンと「キャンセル」ボタンを設定しました。 　修正を入力したあとに「キャンセル」ボタンをクリックした場合は正常に処理されるのですが、 何も修正入力せずに「キャンセル」ボタンをクリックすると（内容を確認したいだけ、違うレコードを 呼び出した等） 　　コマンドまたはアクション’元に戻す’は無効です というエラーメッセージが表示されます。 OKをクリックすれば処理は進められるのですが、できればエラーメッセージは表示させたくないと 思います。 　「キャンセル」ボタンのプロパティでクリック時の[埋め込みマクロ]で下記のように指定しています。 　　　条件　　　　　　　　アクション　　　　　　　　引数 エラー時　　　　　　　　次、 　　　　　　　　　　　コマンドの実行　　　　元に戻す [MacroError]<>0　メッセージボックス　　=[MacroError],[Description],はい,なし 　　　　　　　　　　　閉じる　　　　　　　　　,,確認 元に戻すがエラーになっているので　閉じる　以外を消去してところ エラーメッセージは表示されませんでしたが、修正を行ったあとに「キャンセル」ボタンを クリックしてもレコードの内容が変更されていたため元に戻しました。 どのように指定すればよいでしょうか
SQLite　バージョン3.7.10　を使用しています。 次のようなテーブル構造で、 PRAGMA foreign_keys = ON; CREATE TABLE t1 ( key TEXT PRIMARY KEY NOT NULL, name TEXT NOT NULL UNIQUE ); INSERT INTO t1 (key, name) VALUES ('t1_key1', 't1_name1'); INSERT INTO t1 (key, name) VALUES ('t1_key2', 't1_name2'); CREATE TABLE t2 ( key TEXT PRIMARY KEY NOT NULL, name TEXT NOT NULL UNIQUE ); INSERT INTO t2 (key, name) VALUES ('t2_key1', 't2_name1'); INSERT INTO t2 (key, name) VALUES ('t2_key2', 't2_name2'); CREATE TABLE t3 ( key TEXT PRIMARY KEY NOT NULL, name TEXT NOT NULL UNIQUE ); INSERT INTO t3 (key, name) VALUES ('t3_key1', 't3_name1'); INSERT INTO t3 (key, name) VALUES ('t3_key2', 't3_name2'); CREATE TABLE t4 ( year TEXT NOT NULL, t1_key TEXT NOT NULL, t3_key TEXT NOT NULL, percent INTEGER NOT NULL, UNIQUE(year, t1_key, t3_key), FOREIGN KEY(t1_key) REFERENCES t1(key) ON DELETE CASCADE, FOREIGN KEY(t3_key) REFERENCES t3(key) ON DELETE CASCADE ); INSERT INTO t4 (year, t1_key, t3_key, percent) VALUES ('2011', 't1_key1', 't3_key1', 10); INSERT INTO t4 (year, t1_key, t3_key, percent) VALUES ('2012', 't1_key2', 't3_key2', 50); INSERT INTO t4 (year, t1_key, t3_key, percent) VALUES ('2012', 't1_key2', 't3_key1', 100); CREATE TABLE t5 ( no INTEGER PRIMARY KEY AUTOINCREMENT, date TEXT NOT NULL, t1_key TEXT NOT NULL, t2_key TEXT NOT NULL, t3_key TEXT NOT NULL, amount INTEGER NOT NULL, FOREIGN KEY(t1_key) REFERENCES t1(key) ON DELETE CASCADE, FOREIGN KEY(t2_key) REFERENCES t2(key) ON DELETE CASCADE, FOREIGN KEY(t3_key) REFERENCES t3(key) ON DELETE CASCADE ); INSERT INTO t5 (date, t1_key, t2_key, t3_key, amount) VALUES ('2011-01-01', 't1_key1', 't2_key1', 't3_key1', 3000); INSERT INTO t5 (date, t1_key, t2_key, t3_key, amount) VALUES ('2011-02-02', 't1_key2', 't2_key1', 't3_key1', 2000); INSERT INTO t5 (date, t1_key, t2_key, t3_key, amount) VALUES ('2012-01-01', 't1_key2', 't2_key1', 't3_key1', 5000); 例えばテーブル「t5」から、 dateカラム＝’2011’ t1_keyカラム＝ (テーブル「t1」のt1_nameカラム＝’t1_name1’のt1_key1) t2_keyカラム＝ (テーブル「t2」のt2_nameカラム＝’t2_name1’のt2_key1) という条件の含まれてる全ての対応する行に、 テーブル「t4」のpercentカラムとテーブル「t5」のamountカラムを 掛け合わせた数値の合計を出力する。 ただしテーブル「t4」に対応するt1_keyとt3_keyがなければ、 percentを「0」としてamountと掛ける。 例えばこの条件だと '2011-01-01'と'2011-02-02'の2つの行のamountの合計を求めることになりますが、 '2011-01-01'の方は、テーブル「t4」にpercent「10」があるので　3000×(10/100)=300 '2011-02-02'の方は、テーブル「t4」にpercentがない（対応する行がない）ので　2000×(0/100)=0 合計　300＋0=300 という結果が得たいです。 これはどのようなSQL文になるのでしょうか？
うまく表現ができないのですが、 指定した文字列をワイルドカードで検索できる最大の値を検索したいと思っています。 こんなことはSQLを使って効率的に行う方法は無いでしょうか？ 例） M1 M2 P P2 P22 P23 P233 P2345 と並んでいる表に対し、条件として、P2342と入れた時に、P23の行を検索したい訳です。 （P,P2,P23もP2342に含まれるが、その中で最も大きな値） select * from mydata where key1 > 'P2342' order by key1 desc として、逆読みして完全部分一致するレコードが見つかるまで、見つからない場合は、 対象より1文字も合致しないレコードに至るまで、探すしか方法は無いものでしょうか？
やりたいことは、住所を「●丁目」までにして、それ以降の詳細はカットしたい。 問題として、下記の変換方法だと、「丁」や「-」がないものは空白で返してしまう。 何か良い方法はありませんでしょうか。 よろしくお願いいたします。 Left([番地],InStr(Replace([番地],"丁","-"),"-")-1) 丁を「-」に変換し、「-」より左を抽出 例 浅草1丁目2-3-4　→　浅草1 浅草1-2-3-4　→　浅草1 浅草1　→　空白 浅草　→　空白
以下SQL文で、「hoge」「red」をそれぞれ、「h」「r」として、「h.id」「r.red_id」とかって書きたいのですが、 どう修正したら良いのでしょうか？ (コピペしているので、LEFT JOINの後にテーブル名が来ないとき、どうしたら良いか分かりません) SELECT id, century, tom, best, center, dragon 　FROM ( 　　SELECT hoge.id, c.century, hoge.tom, hoge.best, hoge.center, u.dragon FROM hoge　 　　　LEFT JOIN usa u ON hoge.usa_id = u.id 　　　LEFT JOIN century c ON hoge.century_id = c.century_id 　　UNION ALL 　　SELECT red.red_id, c.century, red.red_title, red.best, red.center, u.dragon FROM red 　　　LEFT JOIN usa u ON red.usa_id = u.id 　　　LEFT JOIN century c ON red.century_id = c.century_id 　) as PIYO
御世話になります。 ＳＱＬＳｅｒｖｅｒ2008　メンテナンスプランについてご教示頂けたらと 存じます。 バックアップ処理などをメンテナンスプランにて設定して 処理を行っています。 毎年、ＤＢが追加になるのでわざわざメンテナンスプラン画面を起動して 追加しなければなりません。 それをコマンドというか、バッチ処理などで追加できないものでしょうか？ 宜しくお願い致します。
お世話になります。 ＳＱＬ Serverのデータ加工についてＳＱＬを教えてください。 元のデータをＳＱＬを使って下記のほしいデータのようにして取得したいのです。 （出身地毎の行で各種目別に集計したい） お願いします。 ＊元のデータ(MotoTable) 出身地,得点,種目,実施年,実施月 東京,80,幅跳び,2012,10 東京,54,反復横跳び,2012,10 長野,66,幅跳び,2012,10 新潟,47,幅跳び,2012,10 新潟,90,幅跳び,2012,10 佐賀,25,幅跳び,2012,10 佐賀,66,反復横跳び,2012,10 東京,100,幅跳び,2012,10 東京,19,反復横跳び,2012,10 愛知,5,懸垂,2012,10 愛知,6,懸垂,2012,10 佐賀,7,懸垂,2012,10 ＊欲しいデータ 出身地,合計点,幅跳び,反復横跳び,懸垂,実施年,実施月 東京,253,180,73,0,2012,10 長野,66,66,0,0,2012,10 新潟,137,137,0,0,2012,10 佐賀,98,25,66,7,2012,10 愛知,11,0,0,11,2012,10
独学で勉強しているのですがさっぱり分かりません...。 C#　visual studio へ　SQL server情報を読み込みたいのですが...Button1を押したら、sql に作成してある(ingredientという) データをrichtextbox へ送りたいです。 今のところ、SQLにcommandを送り、開き、リーダーで呼びました。 SqlConnection sc = new SqlConnection(@"........."); SqlCommand cmd; cmd = new SqlCommand ("Select * from ingredients", sc); sc.Open(); SqlDataReader reader = cmd.ExecuteReader(); その後作っておいたクラスでリストを作りストアしました。ingredientにはidとnameだけです。 List<Ingredient> ingredients = new List<Ingredient>(); while (reader.Read()) { 　string testID = reader["id"].ToString(); string ingName = reader["name"].ToString(); Ingredient oneIng = new Ingredient(Convert.ToInt32(testID), ingName); ingredients.Add(oneIng);｝ 今リストの中に情報が入っているということは分ります。でも、これをrichtextboxにどう整理して入れるのかは分りません。教えて下さい！！！
はじめまして、SQLもMYSQLも初心者です。　独学で、1，2か月といったところでしょうか MYSQL5.5.を使用しています。 早速ですが質問です。 自己結合のもとになるクエリが複雑？な場合どうすれば負荷の少ないクエリが組めるでしょうか？ 自己結合したいクエリが、相関サブクエリをつかっているためViewが作れないので 素人考えで、もととなるクエリをSQL中に何回も記述してみましたが、 メモリがオーバーフローしてしまいます。 複雑なクエリをスマートに自己結合する方法はないのでしょうか？ それとも、そもそも、最初に自己結合や外部結合でめいいっぱいデータを展開し、それを相関サブクエリ.etcで、漸次、絞り込んでいくほうが、SQLの手段としては正しいのでしょうか？ 他で上記のクエリのかなりの部分を使用するので、再利用できないかと思って組んでみましたが 行き詰まり、色々と自信がなくなってきました、アドバイスをお願いします。 以下やりたいことです 暇だったら見てください。 勉強も兼ね、カレンダーアプリで担当者ごとの抱えているプロジェクトと、忙しさ、割ける時間、効率性 を可視化することを目的としたソフトをつくろうと思っています。そこで、日にちごとに、不特定の時間帯から、時間の重複を許して、複数の時間帯を除した、あまりの時間を求めるクエリを組もうと思い、web上で勉強して、相関サブクエリと、自己結合とHAVING文などを組み合わせれば、実現可能なことがわかりました。そこで、相関図を書いて、実際に作って見たのですが、上記のようになった次第です。ぜひ、皆様のお知恵を拝借したいしだいです。よろしくお願いします。
access初心者です。 先日、「メイン、サブフォームの入力」について質問した者です。 取引先の会社情報を管理するために、access2007で顧客管理を作成しています。 現在、取引先本社情報とその支店情報を新規登録及び既存顧客を編集するフォーム「会社登録フォーム」と「会社検索フォーム」を主にVBAで作成しています。 ＜実現したいこと＞： 既存顧客を編集する場合は「会社検索フォーム」から抽出し、「選択」ボタンで会社情報を「会社登録フォーム」に呼び出し、本社及びその支店情報を編集する。 ＜困っていること＞： 「会社検索フォーム」から顧客を選択後、「会社登録フォーム」では、支店情報は変わりますが、本社情報が変わりません。 （メッセージ：「リレーションシップが設定されたレコードがテーブル'支店テーブル'にあるので、 レコードの削除や変更を行うことはできません。」というメッセージがでます。） ＜会社登録フォームの環境＞： 会社の本社情報をメインフォーム、その会社の支店情報をサブフォームに、単票形式のタブコントロールで複数画面にして、支店ごとに分けて入力できる登録フォームを作成しています。 本社テーブルの会社IDを主キーに、支店テーブルの支店IDを主キーにしてリレーションシップを設定し、クエリ「Q_本社支店」というテーブルを作成しています。 ＜会社検索フォームの環境＞： ・「Q_本社支店」テーブルを元に「会社検索フォーム」を作成しています。 ・「会社名」「支店名」等で検索し、データシートで表示します。 ・ 抽出されたレコードの「選択」ボタンで、「会社ID」を「会社登録フォーム」の本社情報の「会社ID」に代入します。 色々調べてやってはみたのですが、上手くいきません。 行き詰まり感があり、困っております。 ご教授のほどよろしくお願いいたします。
テストサイトと本番サイト２つのサイトがあります。 それぞれに使用しているファイルはすべて同じものです。 ドメイン名は違いますが、同じサーバにアップされています。 MySQLのデータを読み込んで表示させる作りなのですが、両方とも同じMySQLからデータを読み込んでいます。 MySQLのクライアントのバージョンは5.0.77と書いてありました。 $dsn = "mysql:host=example.com;dbname=test"; $user = "test"; $pas = "aaaaaa"; $db = new PDO($dsn,$user,$pas); $db->exec("SET NAMES utf8"); $db->setAttribute(PDO::ATTR_CASE, PDO::CASE_LOWER); #SQLの生成～実行 $sql = 'SELECT `a`,`b` FROM `xyz`'; $result = $db->query($sql); while($row = $result->fetch(PDO::FETCH_ASSOC)){ $hoge[] = $row; } というふうな感じでデータを拾いだして読み込んでいます。 コミットというのは、よく分かっていないので、使っていません。 （これが原因？） 今まではうまく表示されていたのですが、急に表示されなくなりました。 とりあえず、サイト閉鎖状態を解除したいので、読み込みを正常にしたいのですが、どのようにすれば良いでしょうか。 知識不足でお恥ずかしいのですが、ほんとに困ってます！助けてください！ どうかご教授よろしくお願いいたします。
FileMakerでレコードを複製する時に、特定のフィールドを空欄で複製する方法を教えてください。 当方デザインデータの管理をFileMakerで行っています。 得意先、担当者、管理番号、内容、サイズ、日付、デザイン内容のJPEG等をFileMakerで管理しています。 お客様から一回の案件で複数のデザイン作成や修正を行い、そのたびにFileMakerで管理しています。 フィールドの中で（デザインの）管理番号とデザイン内容のJPEGは同じものが絶対に存在することがないため、レコードを複製する時にこの2項目をコピーしないようにしたいです。 今、現在はショートカットで複製、上記の2項目を手作業で削除しています。 ボタンを作成してスクリプトを組むことになると思うのですが、どのようにすればいいでしょうか？ 当方のPC環境はiMac、OS X10.6、FileMaker Ver10を使用しています。 ご回答のほど、よろしくお願いします。
accessについて。 シートの中に列名name、列名friendnameがあります。 name,friendname aaaa,bbbb bbbb,cccc cccc,aaaa dddd,aaaa eeee,bbbb ffff,eeee ほしいデータは aaaa,bbbb,cccc bbbb,cccc,aaaa cccc,aaaa,bbbb dddd,aaaa,bbbb eeee,bbbb,cccc ffff,eeee,bbbb と友達の友達の名前がほしいのです。 SQLの書き方を教えてください。 よろしくお願いします。
select book.author,book.bookname,book.money*daityou.cnt from book,daityou where book.bookname=daityou.bookname; というＳＱＬ文があるとして、book.author毎にbook.money*daityou.cntを合計するにはどうすればいいですか？ よろしくお願いします。
Access重複クエリを用いて、以下のような結果を出したいのですが 可能でしょうか？ ご指導の程よろしくお願いいたします。 （例） ＜テーブル＞ ID 判定 日本語　　　英語 1　　　o 　 テスト　　　test 2 o　　　　赤　　　　　red 3　　 x 　 油　　　　　apple 4　　　o 　　 愛　　　　　love 5 x 　りんご　　　apple 6　　　o 　日本　　　　Japan 7 o　　　　テスト　　　test 8　　　o 　りんご　　　apple 9　　　x 　　赤　　　　　blue 10　　 o 　テスト　　　test ＜クエリ結果(1)＞ ・日本語重複、かつ、英語重複のレコードを、重複単位に並べ替えて抽出したい。 ※ID「3」の英語は重複しているが、日本語が重複していないので抽出しない。 ※ID「9」の日本語は重複しているが、英語が重複していないので抽出しない。 ID 判定 日本語　　　英語 1　　　o 　テスト　　　test 7 o　　　　テスト　　　test 10　　 o 　テスト　　　test 5 x 　りんご　　　apple 8　　　o 　りんご　　　apple ＜クエリ結果(2)＞ ・クエリ結果(1)に加えて、判定が「o」、「x」どちらも含まれるレコードだけを抽出したい ※ID「1、7、10」は、判定がすべて「o」の為、抽出しない。 ID 判定 日本語　　　英語 5 x 　りんご　　　apple 8　　　o 　りんご　　　apple 以上ご教授の程よろしくお願いいたします。
複数テーブルからLIKE検索を行いたいのですが、うまくいかないので教えてください ■やりたいこと ・一つのキーワードで、MAINテーブル「hoge」カラムと、SUBテーブル「hoge」カラムを検索して、該当したレコードを表示したい ■テーブル構成 ・MAIN … 「id」「main1」「hoge」… ・SUB… 「sub_id」「main_id」「sub1」「hoge」… ・1つの「id」に対して、対応する「sub_id」が複数(「id」1は一つだけ。対応する「sub_id」1は複数あります) ■試したこと1 SELECT a.* , r.* FROM main a LEFT JOIN sub r ON a.id = r.main_id WHERE ( a.hoge LIKE '%キーワード%' OR r.hoge LIKE '%キーワード%' ) とやると、2件ヒットするはずなのに、1レコードしか取得できません(1レコードに「hoge」カラムが2つ入ります) ■試したこと2 SELECT a.* , r.hoge as rhoge FROM main a LEFT JOIN sub r ON a.id = r.main_id WHERE ( a.hoge LIKE '%キーワード%' OR r.hoge LIKE '%キーワード%' ) とやると、2件ヒットするはずなのに、1レコードしか取得できません(1レコードに「hoge」と「rhoge」カラムになります) ■試したこと3 FROMで2箇所指定するのかと思ったのですが、 SELECT a.* , r.* FROM (main a,sub r) LEFT JOIN r ON a.id = r.main_id WHERE ( a.hoge LIKE '%キーワード%' OR r.hoge LIKE '%キーワード%' ) 結果は、#1066 - Not unique table/alias: 'r'になります ■試したこと4 LEFT JOINがいらないのかと思い、削除したら、2件ヒットするはずなのに、たくさんヒットしてしまいます ■質問 欲しいのは、キーワード検索した際、該当カラムにヒットした数だけのレコードなのですが、どうすれば良いのでしょうか？ ■例 ・東京で検索 ・MAINテーブル「hoge」カラム(2レコード)で2ヒット ・SUBテーブル「hoge」カラム(3レコード)で3ヒット ・ヒットした該当5レコードを取得したい
table1、table2、table3というテーブルがあり このそれぞれをidというカラムで並び替えたものを結合するので考えました。 SELECT * FROM `table1` UNION ALL SELECT * FROM `table2` UNION ALL SELECT * FROM `table3` ORDER BY `id` にすると全てを結合したものを並び替えるので SELECT *, '1' AS tbl FROM `table1` UNION ALL SELECT *, '2' AS tbl FROM `table2` UNION ALL SELECT *, '3' AS tbl FROM `table3` ORDER BY `tbl`,`id` という風に書いてみました、結果としてはよさそうですが 方法としては間違ってないでしょうか？ 他にいい方法があればアドバイスをお願いします。
PHPで以下のような構文でデータベースから読み出しています。 $sql = "SELECT * FROM table_name1 WHERE key = '111' "; $result = mysql_query($sql,$con); while($row = mysql_fetch_array($result,MYSQL_ASSOC)) { ～ } このtable_name1はMyISAMでインデックスが２つで主キーidとkeyを設定しています またこの主キーが昇順になっています。 （直接コマンドで同じクエリーをすると昇順で帰って来ます） つまり以下の様な結果が帰って来ます。 +-----+------+------+ | id | key | data | +-----+------+------+ | 1 | 111 | aaa | | 5 | 111 | bbb | | 7 | 111 | ccc | +-----+------+------+ しかし table_name1をMEMORYに変換した場合（ALTER TABLE `table_name1` ENGINE = MEMORY） 同じSQL分で +-----+------+------+ | id | key | data | +-----+------+------+ | 7 | 111 | ccc | | 5 | 111 | bbb | | 1 | 111 | aaa | +-----+------+------+ という結果になってしまいます、直接コマンドで同クエリーをうつと昇順のまま なのにPHPでの結果のみ逆になります、原因が良くわからないのですが 設定か仕様があるのでしょうか？ よろしくお願いします。
AccessとMysqlを用いてデータベースシステムを作成しています。 添付図の左の表から,右の表の品番と枝番が一致するデータを削除する場合(今回はaaaの2と6)は,どのようにSQL文を記述すればよいでしょうか? Do Untilで1行毎に比較して削除する方法では時間がかかり過ぎたため,SQL文で一度で処理できないかと考えたのですが,SQL文をどのように記述すればよいかわかりませんでした... お分かりになられる方がいらっしゃいましたら,ご教授宜しくお願い致します。
MySQL初心者です。よろしくお願いします。 以下のようなテーブルがあったとして、UPDATEでレコード1つだけnumberから特定の数をマイナスしたいのですが、どうもやり方がわかりません。 id | name | number 1 aaa 100 2 bbb 200 3 ccc 300 3 ccc 300 2 bbb 200 例えば、id=2のレコードの中から1つだけ、numberからマイナスするといった処理を行いたい場合、以下のSQL文だとidが2のものすべてから数がマイナスされてしまいます。 UPDATE table SET number = number-50 WHERE id=2; すべてのレコードからマイナスするのではなく、id=2のレコードの中から1つだけマイナスしたいんです。。。 これをid=2の中で1つ目のレコードからだけマイナスする、といったようにうまく1つのレコードからマイナスする方法をご教示いただけるとありがたいです。 つたない文章で恐縮ですが、どうぞよろしくお願いいたします。
OracleのSQLについて　助けてください。 （例） テーブルA 「human」 | ID | 名前 | テーブルB 「kotoba」 | ID | 名前 | テーブルC 「kakutougi」 | ID | 名前 | テーブルD 「kotoba_have」 | human.ID | kotoba.ID | テーブルE 「kakutougi_have」 | human.ID | kakutougi.ID | テーブルAには一人一人のIDと名前が入っています。 テーブルBには言語の種類IDと種類名（英語、日本語など）が入っています テーブルCには格闘技の種類IDと種類名が入っています。 テーブルDとテーブルEはその人がどの言語がしゃべれ、どの格闘技ができるかを示しています。 テーブルD、Eはその人が複数の言語が話せ、複数の格闘技ができる場合複数のhuman.IDが入ります。 ここで日本語と英語が話せ、柔道と空手ができる人を呼び出したい場合はどのようなSQLにすればよいのでしょうか。 プログラムでwhileで回してはできるのですが、データ量が膨大のためSQLでどうにかしたいのですがわかる方いらっしゃいますでしょうか？ 助けてください。よろしくお願いします。
Ｍｙｓｑｌを使ってwebアプリ開発を行っています。 ユーザ情報として趣味を最大5件（3件は必須）で入力できるようにしたいのですが、 その場合のデータの持たせ方を以下のように考えていますが問題ないでしょうか。 もっとよい方法などがあればご教示をお願いします。（下記は一部だけ抜粋したテーブル定義です） ■テーブルＡ（ユーザデータ） ・ユーザＩＤ ・ユーザ名 ・趣味ＩＤ１ ・趣味ＩＤ２ ・趣味ＩＤ３ ・趣味ＩＤ４ ・趣味ＩＤ５ ■テーブルＢ（趣味マスタ） ・趣味ＩＤ・・・テーブルＡの趣味ＩＤ１～５と紐づく ・趣味名 ■補足事項 ・ユーザは５つの入力ボックスに自由に入力できる。 ・値が入力されて登録ボタンが押された際に、入力値でテーブルＢを検索し検索がヒットすれば そのＩＤをテーブルＡに登録。検索がヒットしなければテーブルＢにその値を新規登録し、テーブルＡにもそのＩＤを登録。 またこのようなデータ構造にした場合、 データ（ユーザ名、趣味１～５の趣味名）を一覧表示する場合どのようなＳＥＬＥＣＴ文でデータを取得すればよいでしょうか？テーブルＡとテーブルＢをJOINで結合すればよいと思いますが、結合させたいカラムが複数ある場合にどのようなクエリにすればよいのかがいまいちわかりません。 よろしくお願いします。
お世話になります。 例えばですが、oracleでsysユーザからaaaというユーザーを作成し、 selectやcreateなどの権限を付与したとします。 そこでaaaユーザーでログインして、aaaユーザーが行うことのできる 権限を調べたいと思ったのですが、いまいちわかりません…。 (1)select * from session_privs; ではcreate系の権限は表示されますが、select系(DML文)の権限が何を付与されているか表示されませんでした。 (2)select * from user_sys_privs; でもselect等の権限の確認はできませんでした。 (3)select * from user_tab_privs; では一件も出てきませんでした。 上記3つは何か間違えているのでしょうか？ それとも他にも何か調べ方があるのでしょうか？ よろしくお願い致します。
質問失礼します。 下記のSQL文にて条件に合うものを表示しています。 select table.*, group_concat(table2.title separator '') as title1, table2.non from table2 join table on table.non = table2.non WHERE table.hiduke = '2012-09-21' AND table.genre LIKE '%ポップス%' group by table2.non すると、table.non　はあるが　table2.non　がない場合、表示されなくなります。 table2.nonはなくてもtable.nonを表示させたいのです。 ご教授お願い致します。
初心者です。 oracle 9i で下記の tmp テーブルがあります。 カラムはNoとFlgの２つだけです。 Flgに「A」が存在し、かつ、Flg 「B」が存在しないNoを取得したい場合 どのようにクエリを作ればよいのでしょうか？ <tmp テーブル> No　　　Flg 1　　　　A 1　　　　B 2　　　　A 3　　　　B 4　　　　A 4　　　　C 5　　　　A 5　　　　B 5　　　　C 上記テーブルから結果として、No 2 と 4 だけを取得したいのです。 where Flg='A'のあとにnot existsとかでできそうな気がしたのですが どのように条件指定すればよいのでしょう？
Oracleで下記のようなデータ処理を実現する方法を調べています。 (1)特定の条件でデータを抽出する。 　select X from TABLE1 where Y="test" (2)(1)で抽出したデータを別の抽出条件の値として1つずつ使用し、 　別のsqlにてデータを抽出し、件数を取得する。 select count(*) from TABLE2 where Z = aaa 　※aaaには(1)の結果を順に入れる。 ２，３件であれば手作業で(2)を実施すればよいのですが、(1)の結果が数100件 になっているため、(2)をループ処理させたいです。 PL/SQLが必要なのでは？と思いつつ、使ったことがありません。 少し調べてはみましたが、よくわからず、困っています。 特に難しい処理ではないと思ってはいるのですが、期日まで時間がなく、質問 させていただきました。 一時的なデータ確認のためだけなので、専用にプログラムを組むのはしたく 無いと思っています。 参考になる情報をいただければ幸いです。 もちろん、(2)のサンプルコードなどいただければ大変助かります。 どうぞよろしくお願いします。
以下のような集計を、VIEWを使わずに１回のＳＱＬでできますでしょうか。 【対象TBL】 CD FLG KINGAKU A, 0, 100 A, 0, 200 A, 1, 1000 B, 0, 50 B, 1, 60 【出したい結果】 CD KINGAKU_0 KINGAKU_1 A, 300, 1000 B, 50, 60 普通のSUMで出る以下の結果を、サブクエリなどで横展開しようと試みてるのですが、 うまく出来ません。。 CD FLG KINGAKU A, 0, 300 A, 1, 1000 B, 0, 50 B, 1, 60
現在Access2010でシステムを作成しています。 データシートビューで,EXCELのフィルタと同じ様に操作したいのですが,チェックボックス付きの一覧が表示されるフィールドと,表示されないフィールドがあります。 どのようにすれば,全てのフィールドでチェックボックス付きの一覧を表示させることができますでしょうか? フォームのRecordSourceは動的に変更おり,また内部結合したクエリをRecordSourceとしています。
フォーム上にオプショングループを配置して、その中にオプションボタンを2つ配置(opt1、opt2)しています。 同じことをフォームAとフォームBで行っているのですが、フォームAのほうだけ、オプションボタンをクリックした時に表示が切り替わりません。(opt1が規定値でopt2をクリックしてもopt2が選択状態になりません) この原因として何が考えられますでしょうか？ 分かる方がいらっしゃればご教授お願い致します。
アクセスはＬＡＮによる共有がいまいちなので、Asp.netで作成したwebアプリケーションによりスマートフォンでaccessのデータベースをイントラネットで共有、編集していました。 何カ月もかかって作ったwebアプリケーションもfilemaker pro12の登場により、自分がやろうとしたことは数日で作れ、簡便できれいでiphoneアプリのfailemaker　goを使用すれば共有もスムーズです。自分の知識がないのか？ぜひASP.netにはできてfailemaker にはできない。最大の強みを教えて下さい。特にデータベースにおいて このままfailemakerに移行するのは今までの自分を否定することになるので そもそもaccessレベルのデータベースをwebアプリケーションでわざわざ作成する必要がないといわれればそれまでですが 言い出せばきりがないと思うのですが、ぜひご意見をお聞かせ下さい。
ＯＳ：Win7Pro 使用ソフト：アクセス2010 ご質問させていただきます。 テーブルに以下のようなフィールドがあるとします。 [単価_1],[単価_2],[単価_3],[単価_4],[単価_5] これらのフィールドのアンダーバー以下を変数を使用して参照することは可能でしょうか？ ([単価_○]の○の部分を変数を使用して参照したいです。) 自分なりに以下のコードを作成したらダメでした。。 Dim cnt As Integer cnt=1 with me !単価_(cnt) end with ご存知の方がいましたらご教授いただけるとありがたいです。
整理されていない和食器の管理を任されました。 数にして1000個以上、茶碗から大皿まで分けて200種類ほど、写真を撮りながらエクセルに整理番号、食器名称、大きさ、形状、色調、用途、数量、保管場所、管理リストを作ることにしたのですが、 別のシートに整理番号で関連性を持たせて画像リストも作りたいと考えています。 月に一度献立が変わりその都度、数１０種類の食器を入れ替えていますが、今までは実物の山のようなサンプルの中から手探りで探し出していたようで、その労力も、時間も無駄なので、この機会に 献立に合わせてパソコンで食器を選べるようにしたいのです。 考え方としては、管理リストから各項目の条件に合った食器を抽出できるようにし、抽出をしたら、画像リストも連動して抽出されるようにできるでしょうか。 さらに画像リストにはそれぞれの画像にチェックボックスを付けてさらに抽出した中から選べるようにして、最終的にはすべて選んだものを別のシートで食器出し指図書を作りさらに連動させ画像と保管場所を表示印刷できるようにしたいのです。 なにぶんにもエクセルデータベースやマクロは経験がありませんのでわかりやすく教えていただけたらありがたいです、よろしくお願いします。
sqlを勉強したいのですが... どのような参考書を使えば良いですか？ 独学で出来るのでしょうか？ 20代後半から勉強しても出来るようになるものでしょうか？ 基礎をマスターするのにどれくらいの時間がかかりますか？ このスキルを使って就職できるようになるまでどれくらい 時間がかかりますか？ 資格などはありますか？ 何か勉強する前に知っておくべきことがあれば教えて下さい。 よろしくお願いします。
FileMakerでカスタムダイアログを使用して、スクリプトを止める方法を教えて下さい。 iMac、OS X10.6、FileMaker Ver10を使用しています。 先だって、こちらで質問させていただき、画像を書き出すスクリプトを教えていただきました。 ボタンを割り当ててはいますが、間違えて押してしまい、大量の画像を書き出すこともあり、スクリプト内に一旦確認ができるようにカスタムダイアログをおきました。 カスタムダイアログ表示時にOKで書き出し、キャンセルでスクリプトがストップと思ったのですが、キャンセルを押してもスクリプトが続行され、画像が書きだされてしまいます。 カスタムダイアログでOKまたはキャンセルをさせる方法を教えて下さい。 それともカスタムダイアログの使い方が間違えていますでしょうか？
4種の複数製品を組み合わせて金額を提示したいのですがうまくいきません 組み合わせテーブル　　　製品テーブル セットno　組み合わせ　種類　　　　　　名前　種類　金額 1　　　　　　1　　　　　　　　 a 　　　　　　　1 　　a 　　100 2　　　　　　2 　　　　　　　　a 　　　　　　　2 　　b 　　260 2　　　　　　3　　　　　　　　 c　　　　　　　 3 　　c 　　244 3　　　　　　4 　　　　　　　　a 　　　　　　　4 　　d 　　300 3 　　　　　 5　　　　　　　　 b　　　　　　　 5 　　a 　　400 3　　　　　　6　　　　　　　　 b　　　　　　　6 　　b 　　 200 3　　　　　　7 　　　　　　　　b 　　　　　　 7 　　b 　　 240 4　　　　　　8 　　　　　　　　a 　　　　　　 8 　　a 　　 333 4　　　　　　9 　　　　　　　　b 　　　　　　 9 　　c 　　 300 4　　　　　　10　　　　　　　　b 　　　　　　10 　　a 　　600 これを結合させてセットnoで纏めて合計で金額をだすと種類すべての合計がでてしまいます。 全てではなく1セットごとの値段を出すようできないでしょうか？ またできれば商品名の組み合わせが分かるようにしたいのですがいい案はないでしょうか？ よろしくお願いします。
いつもお世話になります。 Accessで集計結果をレポートにしたいのですが指定の仕方がわかりません。 教えていただけませんか？ まずは状況について説明させていただきます。 テーブルは以下の二つがあります。 　１．消費者マスター 　　　　消費者コード　　数値型（主キー） 　　　　販売店コード　　数値型 　　　　判定コード　　　 数値型（２．のテーブルとリンク） 　　　　料金　　　　　　　通貨型 　２．判定マスター 　　　　判定コード 数値型　　（10,11,12等） 　　　　判定結果　　　テキスト型（良、否、他 等） 上記のデータを基に「販売店コード」、「判定コード」で並べ替え 以下のようなレポートを作成したいと考えています。 　　販売店コード　　判定コード　判定結果　　件数　　　　　　　料金合計　 　　　1000　　　　　　　　10　　　　　　良　　　　　5（レコード数）　　12,000（料金の合計） 　　　　　　　　　　　　　　11　　　　　　否　　　　　4　　　　　　　　　　8,000 　　　　　　　　　　　　　　12　　　　　　他　　　　　2　　　　　　　　　　4,000 　　　合計　　　　　　　　　　　　　　　　　　　　　　11　　　　　　　　　24,000 レポートの集計機能を使えばいいのか、クエリでやった方がいいのか いくつか試してみたのですが、混乱してわからなくなりました。 面倒かと思いますが考えていただけませんでしょうか。 　　
■質問1 PHPを使ってMySQLに接続しているのですが、 「AUTO_INCREMENT」指定しているIDの次の値を取得したいのですが、 どうすれば良いでしょうか？ 用途としては、レコードを挿入する際、画像ファイルにレコードID名を付与したパスをつけたいのです。 ＜やりたいこと＞ 1.AUTO_INCREMENT指定しているIDの次の値を取得 2.画像ファイル名に付与 3.レコード挿入 この1を、どうやるか知りたいです ■質問2 「AUTO_INCREMENT」指定はどこに保存されているのでしょうか？ 例えばレコードを削除した後、新たにデータ挿入する場合、 次の「AUTO_INCREMENT」値ではなく、削除した一番若い番号を利用することは可能でしょうか？ ■質問3 質問2に関連しているのですが、DUMPデータを移行した際など、次の「AUTO_INCREMENT」値も新しいDBへ引き継がれるのでしょうか？
Filemakerを起動時に、前回閉じた時のレコードを最初に表示する方法を教えて下さい。 FileMakerのVerは10、Mac OS 10.6 snow leopardとなります。
いつもお世話になります。 表題の対象レコードを抽出する際にどのように指定すればよいでしょうか？ テーブルには[訪問日」という項目を下記の条件で設けています。 　データ型　日付/時刻型 　書式、定型入力とも 日付(S) を指定 テーブルにレコードを追加した時点では日付は入っておらず、後に日付を 入力するようにしています。 それでまだ未訪問のデータを抽出したいのですが、どのように指定すればよいでしょうか？ 以下の二つの抽出条件で試したのですが抽出できませんでした。 　(1) =Null と指定した場合　該当レコードなしとなりました。 (2)昇順に並べ替えした場合に先頭にレコードがあったので <#2012/09/15# と指定したのですが日付が入っていて条件にあうレコードは抽出されたのですが、 　　日付が入っていないレコードは抽出されませんでした。
いつもお世話になります。 Accessのレポート作成について教えて下さい。 テーブルに[用途区分」（数値型）を追加しコンポボックスの値リストとして 　1;家庭;2;業務用;3;その他 と定義しました。 帳票に印刷する際にコード（１，２，３）だけでなく内容（ 家庭 業務用 その他) も印刷したいのですが、どのように指定すればよいでしょうか？ よろしくお願いします。
テーブルのデータを抽出したいのですけど テーブルに idと対応するpassワードがあったとすると 入力フォームみたいのを作って 認証したいidとpassワードを入力してもらって それをテーブルにあるのか確認したい場合どうしたらいいでしょうか？ 入力フォームはこうなっています <html> <head> <title>ユーザ認証</title> </head> <body> ユーザ認証<br> <form action="ninsyou.php" method="post" name="form1"> ユーザ名： <input name="id" type="text" id="fUserName"> <br> パスワード： <input name="pass" type="password" id="fPassWd"> <input type="submit" name="Submit" value="認証"> <input type="reset" name="Submit2" value="クリア"> </form> </body> </html> わかりにくい質問ですみません。
入力フォームをhtmlに作って それをidとpassを入力して それをmysqlに登録したいのですが うまくできません <html> <head> <meta http-equiv="Content-Type"content="text/html;charset="utf-8"/> <title>登録</title> </head> <body> <form action="touroku.php"method="post"> 登録id :<br /> <input type="text"name="id"size="10"value="" /><br /> パス:<br /> <input type="text"name="pass"size="10"value="" /><br /> <br /> <input type="submit"value="登録する" /> </form> </body> </html> という感じに 入力フォームは作ったのですが それからそれをmysqlにどうやって登録をするのかわかりません 詳しく解説されてわかりやすいサイトなどを教えてください もしくは教えてください
Mac OS XでFileMaker Pro Ver10を使用しています。 Aというフィールドにポップアップで入力を早くするために、値一覧で下記のように登録しています。 「1.あいうえお工業」 「2.かきくけこ商事」 「3.さしすせそ産業」 というようにし、テンキーですぐに移動できるようにしています。 メインの得意先を0～9まで10社登録しています。 他は「たちつてと社」、「なにぬねの社」のように手入力しています。 このフィールドAをもとに「1.あいうえお工業」なら「あいうえお工業様」と表示するフィールドをBを作りたいと考えています。 後ろの「様」をつけるのは& "様"を計算式に入れたらいいというのは理解しています。 先頭につく「０.」～「９.」のみを削除するにはどうすればいいでしょうか？
MS-アクセス2000でデータベースを作っています。 データ入力画面に単一のフォーム画面で作っています。 日付登録は同じなのでフォームヘッダーに枠を作り、検索番号を入力してbodyの部分でデータ入力させています。 その際、登録項目はヘッダーにある日付だけなので、検索した結果に日付をコピーすれば入力完了という簡単な処理なのですが、次の番号を入力されるまでテーブルに反映しません。 出来れば、番号を入力し、日付がコピーされ、カーソルが番号に戻ってきた時にはテーブルに反映しているという状態にしたいのです。 VBAでカーソルが番号に戻る時に「commit」をかけてくれれば、便利なのかもしれませんが、残念ながら見つけることが出来ませんでした。 そういった更新処理は皆さん、どうされているのでしょうか？ すみませんが、良い方法をお教え下さい。よろしくお願い致します。
SELECTのSQLのパフォーマンスチューニングを行なっています。 例えば、A,B,Cと３本の候補があってA,B,Cの順に速度を見たいとき B以降はAによるキャッシュを利用して実行するはずなので、 この３つの実行速度がうまく比較できません。 （頻繁に投げられるSQLではないので、アプリ側から投げられるときは キャッシュにのっていない想定です） SQLを投げるたびに ALTER SYSTEM FLUSH BUFFER_CACHE ; でキャッシュをクリアすれば、３つを比較できるのでしょうが、 運用上の問題でそれもできません。 理想としては SELECT /*+ NOT_USE_CACHE*/ … のようにヒント句や alter sessionなどでキャッシュを使わずにSQLを投げたいのですが、 どのようにしたら実現できるでしょうか？ 環境は 9iと11gの環境がありますので、 それぞれで最適な方法がございましたらご教授ください。 よろしくおねがいします。
始めたばかりの超初心者です。オープンソース等を利用して phpとmysqlでブラウザ上にデーターベースを作成中ですが my sql のデータ数が多くブラウザの検索待ち時間が気になります。 ３０万件以上のデーターを 検索する時の待ち時間に ちょうどこのOKWaveのロード待ち時間のような 「読み込み中です。」のような画面を作りたいのですが、 javascript になるのでしょうか？ どのよう方法で実装できるのか、また 簡単に実装できそうなオープンソース等あれば教えて下さい。 どうぞよろしくお願いいたします。
SQL Server 2008 にて下記条件を満たしたデータの取得を行いたいです。 ・IDごとに、日付がある日以前で最新のものとその次の日付のデータ2件 ・ただし、その2件で価格が変わらなければ価格変動のあった日付のデータまでさかのぼる ・価格が同じデータの場合、古い日付のデータを取得 例： ・条件…日付が20040101以前 ＜検索対象データ＞ ID　 日付　　　 価格 ------------------------ 1　　 20000101　　 100 1 　　20010201　　 100 1 　　20020301　　 200 2 　　20020401　　 300 2 　　20000501　 400 2 　　20010601　　 400 2 　　20030701　　 300 3 　　20000801　　 500 3 　　20010901　 600 3 　　20040901　 600 ＜取得したい結果＞ ID　 日付　　　 価格 ------------------------ 1 　　20020301　　 200 1　　 20000101　　 100 2 　　20020401　　 300 2 　　20000501　 400 3 　　20010901　 600 3 　　20000801　　 500 なるべく少ないSelect文で取得したいと考えております。 よろしくお願いします。
Ms Access2000，2003 のVBAで テキストボックスのプロパティを変更する時 Me.TextBoxName.Fontsize = 9 などと記述しますが、 この式の左側、テキストボックス名等を変数で処理することが出来るのでしょうか？
ピクチャの写真をDVDに焼くため、新しいフォルダを作って編集していました。 すると「フォルダの中に同じ写真が存在する」という表示がでてきました。 良くわからないまま、ボタンを押してしまったら、新しく作っていたフォルダが消えてしまいました。 ゴミ箱も一応見てみたのですが、ありません（涙） 娘の赤ちゃんのころからの写真がなくなって、へこんでいます。 どなたか分かる方いらっしゃいましたら助けてください。 宜しくお願い致します。
初歩的な質問で申し訳ございません。 Accessクエリで1レコード内における特定の文字列（アルファベット（半角／全角）とギリシャ文字（半角／全角））の個数を抽出するための抽出条件は、どうしたらよろしいのでしょうか？ （例1） ＜抽出結果＞ ｜　　Ｆ1　　　｜　　Ｆ2　　｜　　F1の個数　　｜　　F2の個数　　｜ 　　あ１２あ　　　　い999　　　　　　　2　　　　　　　　　　　3 　　 う8αう　　　　７Ωえ　　　　　　　2　　　　　　　　　　　2 また、この時「F1の個数」と「F2の個数」が一致しない場合の条件付けを行う場合の 抽出条件も教えていただきたく。 （例2） ＜抽出結果※（例1）の抽出結果の場合＞ ｜　　Ｆ1　　　｜　　Ｆ2　　｜　　F1の個数　　｜　　F2の個数　　｜　　個数判定　　｜　　 　　あ１２あ　　　　い999　　　　　　　2　　　　　　　　　　　3　　　　　　　個数不一致 お手数おかけいたしますが、どうかよろしくお願いいたします。
ファイルメーカーでデザイン画像を管理しています。 1レコードあたり1点のJPEGを1つのフィールドに「参照のみ保存」で管理しています。 日付や内容等で検索をかけた後、複数のレコードのJPEGをまとめて書き出したいのですが、なにか方法がありますでしょうか？ あるいは「フィールド内容のエクスポート」でまとめて書き出すには、どのようにすればいいでしょうか。 今、現在は1点づつ書きだしている状態で、点数が多くなると非常に時間がかかってしまいます。 スクリプト等の機能で改善する方法は無いでしょうか？ Mac OS 10.6、FileMaker Pro Ver10の環境で作業をしています。
MySQLにてCOUNTした値を、更にCOUNTする事を1回のSQLにて実行する事は可能でしょうか？ ※2回のSQL、プログラミングを介する、EXCELで再集計する等でならCOUNTのCOUNTは求められるのですが…1回のSQLでの回答お願いします。 ユーザーIDと課金額のカラムからなる、以下のようなテーブルがあるとします。 buyテーブル user_id,coin 1,100 5,100 10,200 5,200 5,200 17,100 1,100 2,200 23,500 ユーザー毎の課金回数は下記にて求められますが、 SELECT user_id,COUNT(coin) FROM buy GROUP BY id user_id,count(coin) 1,2 2,1 5,3 10,1 17,1 23,1 count(coin)毎の人数というのはどのように求めればいいでしょうか？ いわば下記のような集計結果が理想です。 ※このような結果を1回のSQLにて出力するSQLをズバリ今回の例に沿って知りたいです。 count(coin),count(count(coin)) 1,4 2,1 3,1 ■環境 Apache2 MySQL5 PHP5 ご教授よろしくお願いします。
PostgreSQL初心者です。 AccessからPostgreSQLに移行しようと思い、ODBCで接続しようとしたのですが、エラーが発生して進めません！ そして、いろいろ試してみたのですが、同じエラーが発生してしまいます。 設定、エラー内容は、下記になります。 エラー内容 「ODBC--呼び出しが失敗しました。 Could not connect to the server; Could not resolve hostname.(#101)[Microsoft][ODBC Driver Manager]ドライバのSQLSetConnectAttrは失敗しました。(#0)」 設定 データソース（ODBC）→システムDSN→PostgreSQL Driver Setup Database Server dbserver User Name localhost Description Port 5432 以上、宜しくお願い致します。 OS:WindowsXP Professional Version 2002 Service Pack3 PostgreSQL 9.1 Version 1.14.3 Access XP(2002) になります。
SQL2000サーバーから、SQL2005expressへ SQL Server Management Studio Express を使って移行しています その中で、テーブルレイアウトの初期設定について 日付やPC名は、SQL2000と同じ　getdate()　や　host_name()で 設定できたのですが、サーバー名が　@@servername では 「文字列データまたはバイナリデータが切り捨てられます 　ステートメントは終了されました」 とメッセージが出てきて処理できません。 SQLserver2005expressで、サーバー名の規定値についてアドバイスをお願いします
「INSERT ステートメントは FOREIGN KEY 制約 "○○" と競合しています。競合が発生したのは、データベース "△△"、テーブル "dbo.□□", column '◎◎' です。」 SQLサーバーマネジメントスタジオでインサートのクエリを流したところ、下記のエラーが発生したのですが、解決するにはどういった観点を調査すればよろしいでしょうか？ ご存知の方、お願いします。
SQLについて質問いたします。SQL　全般でも結構です。 No,name 1,ばなな 2,りんご 3,ばなな ４,みかん 5,ばなな 6,りんご 上記テーブルで 1,ばなな 3,ばなな 5,ばなな 2,りんご 6,りんご 4,みかん の結果を得るSQLはどのように記述すればよいでしょうか？
たびたびすみません。また詰まってしまったので教えていただけませんでしょうか。 Accessでレコード更新時にある項目に自動的に値を代入したいです。 前提としてテーブルは消費者マスターと単価マスターがあります。 単価マスターはフィールドとして単価ランク（主キー）と単価（通貨型）があります。 消費者マスターのレコードをフォームを使って編集する際に単価ランクをキーに 単価マスターから単価を引っ張ってきて　料金　というフィールドに代入して画面に表示し、 必要に応じて　料金　を画面から変更する形にしたいと考えてます。 どのように指定すればよいでしょうか？ それからこれは別の質問にした方がいいかもしれませんが、差し支えなければ 教えて下さい。 レコードの更新の際に　更新日　というフィールドに当日日付を自動的に代入したいのですが どうすればいいでしょうか？
oracle10g環境で、LONG RAW型のカラムにイメージ(.JPG)が登録されております。 PL/SQLより、LONG RAW型のイメージデータを取り出したいのですが。 ＯＯ４Ｏでの取り出しあるのですが。PL/SQLで実現したいのです。 サイト検索しても見当たらないよう状態です。 PL/SQLで取り出す方法を教えていただきたいのですが。
以前に質問させていただいた件に関しての追加の質問です。 レポート出力時の範囲を下記の範囲入力画面で入力した内容を印刷したいと考えてます。 　　　　　　住所コード : [住所自]　　 ～ [住所至]　 　　　　　　販売店コード : [販売店自]　～ [販売店至]　 　　　　　　担当者コード : [担当者自]　～ [担当者至]　 レポートは販売店コードで改ページするように設定しているため販売店コードフッターで 　="住所コード：" & Forms![frm出力範囲]![住所自] & "～" & Forms![frm出力範囲]![住所至] & Chr(13) & Chr(10) & "販売店コード：" & Forms![frm出力範囲]![販売店自] & "～" & Forms![frm出力範囲]![販売店至] & Chr(13) & Chr(10) & "担当者コード：" & Forms![frm出力範囲]![担当者自] & "～" & Forms![frm出力範囲]![担当者至] と指定すればできると教えていただき解決したと思ったのですが、データが多くて改ページした場合 販売店コードは変わらないため、入力範囲が印字されません。 教えていただいた指定内容をページフッタに移動させて試してみましたがいまくいきません。 どのように指定すればよいでしょうか？ また出力範囲と同時に該当ページの販売店コードも印字したいのですが、これも単純にページフッタに移動させただけではうまくいきませんでした。 あわせて教えていただけますか。
すみません、、初めて質問しますが、 お手柔らかに宜しくお願い致します。 1.集計クエリ1 　 　ID--Group化　出庫数--合計　日付--Where条件 2..集計クエリ2 　ID--Group化　入庫数--合計　日付--Where条件 3.出力用クエリ 　ID　商品名　集計クエリ1の合計　集計クエリ2の合計 　IDと左結合で、上記のクエリを作成 デザインビューでは1～3は完成しており、 VBA上で1と2を3のSQLに置き換えるところで悩んでおります。。 どなたか教えてください。 ちなみに1.集計クエリの下記のように試してみましたが、 Dim dbs As DAO.Database Dim qdf As QueryDef Dim rst As DAO.Recordset Set qdf = dbs.QueryDefs("Q_データ抽出をしたいクエリ") With qdf .Parameters("[Forms]![f_DataEx]![txt_YearStart]") = "2011" .Parameters("[Forms]![f_DataEx]![txt_MonthStart]") = "02" .Parameters("[Forms]![f_DataEx]![txt_DayStart]") = "23" .Parameters("[Forms]![f_DataEx]![txt_YearEnd]") = "2011" .Parameters("[Forms]![f_DataEx]![txt_MonthEnd]") = "02" .Parameters("[Forms]![f_DataEx]![txt_DayEnd]") = "23" Set rst = .OpenRecordset End With 上記で求めた"rstを基にSQL文が実行できれば、実現できそうなんですが、 うまく行きません。 言葉足らずの内容もあるかと思いますが、宜しくお願い致します。
はじめまして Oracle初心者のエンジニアです。 あるプロシージャを実行すると 添付のようなアラートが出てエラーになります。 ただ、エラーにならないで処理が成功する人もいて 原因不明です。 原因や対処法をご存じの方、ご教授お願いできますか？ ちなみに他のプロシージャは正常に実行できます。 オブジェクトブラウザの出力 【 実行後パラメータ値 】 V_SHEMA_NAME : BTOB 【 DBMS_OUTPUT 値 】 BTOBスキーマへデータ反映失敗: -53203ORA-53203: セキュリティ違反です。
今、共有サーバーにCMSをインストールして使っているのですが、これを専用サーバー又は、他の共有サーバーに移し替えることって可能なのでしょうか?　ドメインなどの移動の問題もありますし、良くわかりませんでした。 もし知っていたり、参考になるようなサイトがありましたら、教えてくださいよろしくお願いします。
データ取得時に列番号を組み込みたい場合 ROW_NUMBER() OVER (ORDER BY ソートキー) で実現できますが、これは実際ソートも行ってくれるのでしょうか？ 例えば １） select dt1,dt2, dt3,ROW_NUMBER() OVER (ORDER BY dt1,dt2,dt3) as dt4 from table_1 2) select dt1,dt2, dt3 from table_1 ORDER BY dt1,dt2,dt3 では同じ順序でデータが取得されるのでしょうか？ 簡単にデータを作ってみたところ、同じようなんですが・・・・
Ｃ＃で作成するとき、string 変数にどんどんと長いクエリを書いてしまいがちです。 こういったクエリ文字をデバッグなどで、カットするととんでもなく長い１行の文字列になってしまいます。 それをSQLServer のクエリとして貼り付けると、１行なので何がなんだかわからない状態になります。 それで適当な部分でエンターキーで改行してようやくどんなクエリかわかる状態で辟易しています。 何か適当なプログラムで適当な部分で改行（折り返す？）して全体がわかるように表示する（またはテキストを変換）ようなものってないでしょうか？
Access2010についてお教えください。 添付の画像のように「テストメインフォーム」があります。 フォームには「テストサブフォーム」というサブフォームが配置されています。 画像はないですが、「テストレポート」というレポートもあります。 やりたい事。 テキストボックス(テスト1の値)に文字列を入力し、印刷ボタンを押す。 テキストボックスに入力された値をキーに「テストレポート」にデータが渡され、プレビュー表示。 「テスト5」のチェックボックスをONにする。 添付画像では、テキストボックスに入力された値が003のため、サブフォームの テスト1の値が003の行のテスト5のチェックボックスをONにする。 以上の事を実現できる方法をお教え頂けませんでしょうか。 DoCmd.OpenReport "テストレポート, acViewPreview, , "テスト1 = '" & txt_inputID & "'" とやったら、クエリパラメータみたいになり、テキストボックスの値を直接見るといったことが できませんでした・・・
項目名：コード varchar (3) を "ALTER TABLE テーブル名 ALTER COLUMN コード varchar (4);"を実行し 項目名：コード varchar (4)へ変更したいと思っています。 そこで質問なんですが現在コード の内容が"001"のような３桁なのですがそれを"0001"のように4桁に変更したいのです。(頭に"0"を追加する。) (一見づつ読んで更新していく方法はわかりますがもう少しスマートに処理がしたいので) どういったSQL文を発行すれば良いのでしょうか？ よろしくお願いします。
SQL初心者です。 基本的な質問ですみません、教えてください。 LEFT JOINとRIGHT JOINについて、どちらのテーブルを左側、どちらのテーブルを右側にするのかが分かっていません。どういう基準で左側、どういう基準で右側と考えれてばいいのでしょうか？ 宜しくお願いします。
Accessでレポートを出力する際に出力範囲を画面から入力したいと思ってます。 下記３項目をフォーム（frm出力範囲）から入力しようと考えてます。 　　　　　　住所コード （テキスト形式） : [住所自]　　 ～ [住所至]　 　　　　　　販売店コード（数値型） : [販売店自]　～ [販売店至]　 　　　　　　担当者コード（数値型） : [担当者自]　～ [担当者至]　 レポートを開く際にWhere条件式に指定すればできるのかとも思いますが （できるかどうかもわかりませんが）どうすればよいかわかりません。 どなたかお教えいただけませんか？
SQL SERVER 2012のダウングレード権に関して教えていただきたく。 6コア1CPUのサーバに対し、SQL SERVER 2012を SQL SERVER 2008 R2にダウングレードして使用する場合、 ライセンス形態はどのようになりますでしょうか？ 6コア分のコアライセンスが必要？ SQL SERVER 2008 R2の1CPUライセンスと同等価格の4コアライセンスが必要？
Mysqlでの日本語文字化け対策がうまくいかなくて困っています。 いくつもの参考ページを検索で探し、実行してみたのですが、どうにもうまくいきません。 insert into tbl values('あああ');のように、cmdに打っている時点では日本語は表示できています。 しかしselectで呼び出すと、'?f?u???'といった表記に化けてしまいます。 phpMyAdminでの表記も同様に化けます。 下記に環境と施した対策を記しますので、原因がわかる方のアドバイスをお待ちしております。 window7 64bit Xampp1.8.0 Apache 2.4.2 MySQL 5.5.25a PHP 5.4.4 phpMyAdmin 3.5.2 参考記事 http://blog.livedoor.jp/ryo511-web/archives/4915 … cmd上でshow variables like "char%"でキャラクタセットを確認したところ character_set_client utf8 character_set_connection utf8 character_set_database utf8 character_set_results utf8 character_set_server utf8 character_set_system utf8 と、表示上は意図したとおり、utf-8になっているようです。
FileMaker go で 都道府県の中から愛知県以外を抽出したいのですが、条件式はどのようになりますでしょうか？ よろしくお願い致します。
Table t1には t1code｜t1type ------------------ 花子｜1 太郎｜1 一郎｜2 次郎｜2 五郎｜2 Table t2には t2code｜date ----------------- 太郎｜2012-05-30 太郎｜2012-05-30 花子｜2012-05-10 花子｜2012-05-10 次郎｜2012-03-20 五郎｜2012-04-10 一郎｜2012-03-01 と登録されている場合に t1type毎に一番新しいdateをもつt2codeを抽出したいのです。 そこで、 select t2code,max(date) from t1 inner join t2 on t1code = t2code where (t2code,date) in (select t2code,max(date) as d from t2 group by t2code) group by t1type としたところ、 +--------+------------+ | t2code | max(date) | +--------+------------+ | 太郎 | 2012-05-30 | | 次郎 | 2012-04-10 | +--------+------------+ となります。 本来は、次郎→五郎になってほしいのですが、 どこが悪いのでしょうか？ よろしくお願いします。
MySqlには不慣れな者です。 来店table id|text_date |name 1 |20120101010101|山田 2 |20120222001227|鈴木 3 |20120309035932|福田 4 |20120309035932|館山 5 |20120713121211|大沢 6 |20120822120127|矢島 といったテーブルがあるとします。 カラムtext_dateはCHARで、日時データを持っています。 （ちょっと解り辛いサンプルで失敬） SELECT text_date, count(*) FROM 来店table WHERE text_date >= "20120101010101" GROUP BY text_date; とするとid 3・4の同日時のみカウント2として以外はカウント1で出ると思います。 希望ですが、カラムtext_dateの時間部（8・9番目の数字）でカウントを取りたいのですが。 GROUP BY の指定方法でそのような事はできるのでしょうか？ MySqlのリファレンスを色々探し回っているのですが、見つけることができません。 ご助力いただけると助かります。
OS　XP　SP3、ACCESS２００３　DBはSQLserver2005express　です SQL　Server Management Studio Express　を使って 新しいDB、テーブル、項目は作成できました。 また同じツールを使って手入力でデータを追記することもできます 質問はこのテーブルを　ACCESSからODBC接続して 追加クエリーを実行したいのですが リンクしてテーブルを開いた時点で新規レコードが追加できない状態です。 サーバーの更新をしたく、少ないデータであれば手入力でも 大量のデータでは…ACCESSのクエリーを使いたいと思っております。 ODBC接続の設定が読み取り専用になっているのか そうであれば　その設定はどこにあるのか　教えてもらえないでしょうか？ 宜しくお願いいたします
いつも大変お世話になっております。 よく分かっていなくて申し訳ありません。 SELECT … FROM Ａ Right Outer Join Ｂ Ｂ on Ｂ.c =Ａ.d 　というようなSQL文で Ｂ.cはvarcharでＡ.dはintです。 Ｂ.cは大多数の場合は数値なので動くのですが、稀に文字列が入ったときにエラーになってしまいます。 ここでエラーにならずに、そこで呼ぼうとしたものがなければNullになるようなよい方法がありましたら、ご教示いただけますと幸いです。 以下の添付画像のような結果を得られると幸いです。
現在、独学でOracle Master Bronze DBA 11gの勉強をしています。 その勉強の中で出てきた質問です。 Enterprise Managerを使用するには、 ・dbconsoleプロセス ・リスナープロセス を起動しておかなければならない と記載されています。 しかし、別のページでは、Enterprise Managerの画面でリスナープロセスのステータス（起動中、停止中など）が確認できます、とありました。リスナープロセスが停止していれば、Enterprise Managerにはアクセスできず、必然的にリスナープロセスのステータスも確認できない、と思うのですが、いかがでしょうか。
こんばんわ。 先日こちら(http://oshiete.goo.ne.jp/qa/7666702.html) で質問させていただきましたが、まだ問題があったため、 再度質問させていただきます。 以下のような20カラムある「出納帳」テーブルがあって、 同一日付の金額を集約してしまいたいです。 出納帳 ID　日付　　　金額　伝票　・・・(全20カラム) 1　2012/8/20 1000　A01　・・・ 2　2012/8/20 2000　A02　・・・ 3　2012/8/21 -1000　B01　・・・ 4　2012/8/21 -2000　B02　・・・ 5　2012/8/22 3000　A03　・・・ 6　2012/8/23 4000　A04　・・・ 7　2012/8/24 -3000　B03　・・・ 8　2012/8/24 -4000　B04　・・・ 9　2012/8/27 5000　A05　・・・ ↓「日付」で金額集約 ID　日付　　　金額　伝票　・・・(全20カラム) 1　2012/8/20 1000　A01　・・・ 2　2012/8/20 2000　A02　・・・ 　2012/8/21 -3000　　　　・・・(-1000と-2000を集約) 5　2012/8/22 3000　A03　・・・ 6　2012/8/23 4000　A04　・・・ 　2012/8/24 -7000　　　　・・・(-3000と-4000を集約) 9　2012/8/27 5000　A05　・・・ と集約キー以外はNULLにしたいのですが、 またまた、 ( SELECT　ID,　日付,　金額,　伝票,　・・・ FROM 　出納帳 WHERE 　金額>=0 UNION ALL SELECT　NULL,　日付,　SUM(金額),　NULL,　・・・ FROM 　出納帳 WHERE 　金額<0 GROUP BY　日付 ) ORDER BY 日付 とUNIONをする方法しか思いつかなかったのですが、 UNIONせずに端的に表現できるSQLはありますでしょうか？
Access始めたばかりです。 テーブルのデータを修正するフォームを作る際にWhere条件式に ="消費者コードは？" & [消費者コード] と指定したところ、"このオブジェクトにはオートメーションオブジェクト"消費者コード"は含まれません。”というエラーメッセージが表示されました。 おそらく基本的なところで間違いがあると思うのですが、よくわからないので、 ご面倒だとは思いますがどなたか教えていただけませんでしょうか？
Private Sub 商品コード_LostFocus() Dim ShukkaPtn As String ShukkaPtn = Me.出荷パターン Me.売上単価 = DLookup("[ShukkaPtn]", "[Q_単価分類別_単価]", "[商品コード]='" & Me.商品コード & "'") End Sub 商品コードと出荷パターンというテキストボックスがあって、 [出荷パターン]に14という数値がはいってるとしたら レコードセット[Q_単価分類別_単価]から商品コードで検索して、[14]フィールドにある数値を出したいのですが上の式では間違っているのでしょうか？ どこをどう修正していいのかが調べてもわかりませんでした。 宜しくお願いします。
Windows7 ProfessionalにWindows Virtual PCをインストールし、WindowsXPを動かしています。 Virtual PC上のWindowsXPでMySQL DBを作成し、そのDBをネットワーク上に接続されたWindows PCからODBC経由で アクセスしようとしましたが上手くいきません。 MySQLのODBC/Connectorの設定を、ホストPCであるWindows7マシンにではなくVirtual PCに対して行いたいのですが どのようにすればよいのでしょうか。 (Virtual PCをネットワークに接続するために、Windows7のIPアドレスとは別のプライベートIPアドレスを割当てています。)
【Table1】 Col1 Col2 Aa A Ab A Ba B Bb B Ca C Ca D 【Table2】（Data1は固定） Data1 Data2 Aa A Ab B→A Ba C→B Bb A→B Ca B→C Ca C ※Col1に重複がある場合、重複結果の1行目のレコードをData2に入れる (今回の場合CをData2に入れる) Data1は固定で、Table1を使ってData2を上記の様に修正するSQLが書けなくて困っています。 Col1が重複してない場合の修正するSQLを書いてみましたが（合っているかはわかりませんが...）、 重複する場合のSQLも追加して最終的に１つのSQLで、すべて修正できるようにしたいです。 update Table2 T2 　set Data2= 　(select Col2 from Table1 　where Col1= 　　(select Col1 from Table1 T1 　　where T2.Data1=T1.Col1 　　group by T1.Col1 　　having count(T1.Col1)=1 　) ) わかりにくい部分もあると思いますが、ご教授お願いします。
はじめまして。 SQLで部分的にGROUP BYで集計したいのですが、 どうもしっくりくるSQLがかけません。 多分CASEあたりを使うと綺麗で高速なSQLがかけると思っています。 皆様のお知恵をお借りしたく投稿しました。 具体的には以下のような出納帳データで 出納帳 日付　　　　　金額 2012/8/20　1000 2012/8/20　2000 2012/8/21　-1000 2012/8/21　-2000 2012/8/22　3000 2012/8/23 4000 2012/8/24 -3000 2012/8/24 -4000 2012/8/27 5000 ↓集計 日付　　　　　金額 2012/8/20　1000 2012/8/20　2000 2012/8/21　-3000(-1000と-2000を集約) 2012/8/22　3000 2012/8/23 4000 2012/8/24 -7000(-3000と-4000を集約) 2012/8/27 5000 というように、マイナスの金額は集約してしまいたいのですが、どのようなSQLが最適でしょうか？ とりあえず、UNIONかなと思い、 (SELECT 日付, 金額 FROM 出納帳 WHERE 金額>=0 UNION ALL SELECT 日付, 金額 FROM 出納帳 WHERE 金額<0 GROUP BY 日付 ) ORDER BY 日付 とプラス金額とマイナス金額にわけUNIONしたのですが、 もっと綺麗(高速)にやる方法があるのではないか？と思い投稿いたしました。 なにかヒントございましたら、ご教授ください。 DB環境：Oracle 11g
Access2010使用です。 売上伝票を作るのに、出荷分類7種類（工場渡し・配達・遠距離配達…）、業種別5種類（同業者、職人、現金…）と分類分けされていて、 ひとつの商品の単価で6×5＝35種類の価格設定があります。 テーブルの構成はひとつのレコードに対して、 ●商品コード ●商品名 ●分類別単価コード ●分類別単価 ●工場渡し・職人（11） ●工場渡し・現金（12） ●工場渡し・建材店（13） ●工場渡し・同業者（14） ●工場渡し・工務店（15） ●配達・職人（21） ●配達・現金（22） ●配達・建材店（23） ●配達・同業者（24） ●配達・工務店（25） ●遠配達・職人（31） ●遠配達・現金（32） ...etc とあって全部で、39種類のフィールドがあります。 売上伝票というフォームがあって 得意先マスタの方で業種は指定しているので得意先を選ぶと業種（[Forms]![F売上メイン]![業種]）は自動で指定されますが、 出荷分類（[Forms]![F売上メイン]![分類コード]）が都度、工場渡しだったり配達だったり異なるのでその都度選択します。 例えば… 出荷パターンが工場渡し・同業者（14） この場合、「工場単価4」のフィールドから指定商品のレコードにある単価を抽出したい 出荷パターンが配達・建材店（23） この場合、「配達単価3」のフィールドから指定商品のレコードにある単価を抽出したい 業種別IDと出荷分類IDを組み合わせて、（）内の2桁の番号（出荷パターン）を作っています。 Dlookupでも試みたんですがうまく動作せず、 IIFを用いて出荷パターンが「14」の場合は工場単価4のフィールドから… などと考えたんですが、フィールドを指定して、特定のフィールドから値を抽出する方法がわかりません。 説明がわかりづらいかもしれませんが、どなたか教えてください。
提示版に投稿した各ユーザーの ユーザータイプを取得したいのですが分かりません。 以下のテーブルがあります。 「bbsTable」(投稿された提示版のデータを保存するテーブル) フィールド：postUserName, postTitle, postText, postTextIndex, postDate 「userTable」(会員ユーザーのデータを保存するテーブル) フィールド：userId, userName, userType, date 今までは以下の様に提示版の投稿データを「postDate」の降順で取得していました。 select postUserName, postTitle, postText, postDate from bbsTable order by postDate desc; ですが提示版に投稿した会員ユーザーのタイプ(userType)も 一緒に取得する必要が出てきたので select postUserName, postTitle, postText, postDate, '' as postUserType from bbsTable order by postDate desc; (このSQL文をどの様に変化させたらいいのか分かりません) の様に('' as postUserType)で擬似フィールドを作成し、 選択された各レコード中の postUserName(投稿ユーザー名：bbsTable)を元に userType(ユーザータイプ：userTable)をデータとして取得し、 その擬似フィールドの部分から参照して 他の提示版データ(postUserName, postTitle, postText, postDate)と 共に取得するにはどうすればいいのでしょうか？
最近、大容量データを扱う技術がブームになり「ビッグデータ」と言われていますが、これについて難点か質問したいと思います。 (1)Yahooなど、世界中に情報発信するような規模の企業でないと、コストをかけて導入するものではないでしょうか？一企業が、自社だけのデータを処理するのに使うようなものではないのでしょうか？ (2)画像や動画など、非定型データと呼ばれるものを含まないデータでは、ビッグデータの処理技術を適用するのは無意味でしょうか？単なる文字や数字のデータだけなら、かなり大量であってもRDBMSで処理スべきところでしょうか？ (3)これは、統計学などの知識が必要で、そういう専門家がいない企業には扱えないものでしょうか？Hadoopなども、一般企業には敷居が高いのでしょうか？
お世話になります。 SQLサーバ2000から、SQLサーバ2008への移行を行っております。 以下のようなSQL文は2000では許容されていたようで、問題なく（？）稼働していただのですが2008に移行したら軒並みエラーになってしまいました。 エラーで稼働確認が進まないので、修正方法を検討しているのですが、まだSQLサーバが使えない環境で確認ができません。 2000が来てから確認する予定ではありますが、以下の通りで新旧・同様のソート順になると考えて問題ございませんでしょうか。 教えていただけると幸甚です。 【例１】 SELECT DISTINCT ISNULL(T1.C1,""),T1.C2 FROM T1 ORDER BY T1.C1 →ORDER BY 項目を　ISNULL（T1.C1,""）に変更 【例2】 SELECT DISTINCT T1.C1,T1.C2 FROM T1 ORDER BY T1.C1,T1.C3 →ORDER BY 項目から　T1.C3　を削除する 以上です。宜しくお願いいたします。
Visual Studio (C++)で作成したモジュールの使用状況を収集するために、 アプリを起動する度に、サーバに接続し、そのサーバにログを残す という仕組みを作りたいと考えています。 (本屋で物色したのですが結局、該当する本はわかりませんでした) セキュリティや拡張性などを考えると おそらく実現の方法はいろいろあると思われますが、 まずは”動かす”を第一に考えています。 １．アプリからサーバにアクセスするのは、どういった仕組みを利用するのが ２．サーバ側はどのような構成になるのでしょうか。 ３．サーバ側で受け取った情報をDBに書き込むにはどのようにするのか ネットや書籍で調べてみると 　　サーバとDBとの接続は 「TomcatからJDBCを使用してデータベースMySQLにアクセスする」や 　　「PHPからMySQLにアクセスする方法...」 　　等々なんらかの情報があるのですが、 　　アプリからサーバへのアクセスの方法は、 　　自分にはどれがそうなのかわかりませんでした。 　　 　　的外れのことをいっているかもしれませんが、教えていただけますとありがたいです。
＜やりたいこと＞ ・(ブログの)エントリーデータを元に、「categoryテーブル」より、親カテゴリー内容と、子カテゴリー内容を抽出したい ＜テーブル構成＞ ■categoryテーブル ・category_idカラム ・parent_idカラム ・その他色々カラム ＜現状＞ 1.　SELECT * FROM category where category_id = :category_id 2.　1で抽出したデータのparent_idを取り出して、再度、SELECT 　　SELECT * FROM category where category_id = :parent_id ＜質問＞ ・2回SELECTしているのが冗長な気もするのですが、普通はどう書くのでしょうか？ ・もっと良いテーブル構成があれば教えてください ※内容 … ブログの「メイン」「サブ」カテゴリー。1つのメインカテゴリーにつき、サブカテゴリーが複数
開発環境はXamppで、OSはWindowsです。 データベースを使いたいと考えていますが、初心者で非常に困っています。 <?php $dsn = 'mysql:dbname=testdb1; host=127.0.0.1'; $usr = 'ユーザー名'; $passwd = 'パスワード'; try { $db = new PDO($dsn, $usr, $passwd); print '接続に成功しました'; $db = NULL; }catch (PDOException $e) { die("接続エラー:{$e->getMessage()}"); } 上記のファイル、connect.phpを実行しても、 Parse error: syntax error, unexpected T_VARIABLE in C:\xampp\htdocs\connect.php on line 3 と表示されてしまいます。 構文エラーだと思い、自分で出来る限りなおしたのですが解決できません。 どなたかアドバイスよろしくお願いいたします。
Android実機でSQLiteを使ったプログラムを実行しました。 SQLiteのデータベースファイルはどのフォルダに保存されているのでしょうか？ 削除したいのですが、場所が分かりません。
var $user_details = array( 'id' => array('type' => 'string', 'null' => false, 'default' => NULL, 'length' => 36, 'key' => 'primary'), 'user_id' => array('type' => 'string', 'null' => false, 'default' => NULL, 'length' => 36), 'position' => array('type' => 'float', 'null' => false, 'default' => '1'), 'field' => array('type' => 'string', 'null' => false, 'default' => NULL, 'key' => 'index'), 'value' => array('type' => 'text', 'null' => true, 'default' => NULL), 'input' => array('type' => 'string', 'null' => false, 'default' => NULL, 'length' => 16), 'data_type' => array('type' => 'string', 'null' => false, 'default' => NULL, 'length' => 16), 'label' => array('type' => 'string', 'null' => false, 'length' => 128), 'created' => array('type' => 'datetime', 'null' => true, 'default' => NULL), 'modified' => array('type' => 'datetime', 'null' => true, 'default' => NULL), 'indexes' => array('PRIMARY' => array('column' => 'id', 'unique' => 1), 'UNIQUE_PROFILE_PROPERTY' => array('column' => array('field', 'user_id'), 'unique' => 1)) ); var $users = array( 'id' => array('type' => 'string', 'null' => false, 'default' => NULL, 'length' => 36, 'key' => 'primary'), 'username' => array('type' => 'string', 'null' => false, 'default' => NULL, 'key' => 'index'), 'slug' => array('type' => 'string', 'null' => false, 'default' => NULL), 'password' => array('type' => 'string', 'null' => true, 'default' => NULL, 'length' => 128), 'password_token' => array('type' => 'string', 'null' => true, 'default' => NULL, 'length' => 128), 'email' => array('type' => 'string', 'null' => true, 'default' => NULL, 'key' => 'index'), 'email_verified' => array('type' => 'boolean', 'null' => true, 'default' => '0'), 'email_token' => array('type' => 'string', 'null' => true, 'default' => NULL), 'email_token_expires' => array('type' => 'datetime', 'null' => true, 'default' => NULL), 'tos' => array('type' => 'boolean', 'null' => true, 'default' => '0'), 'active' => array('type' => 'boolean', 'null' => true, 'default' => '0'), 'last_login' => array('type' => 'datetime', 'null' => true, 'default' => NULL), 'last_action' => array('type' => 'datetime', 'null' => true, 'default' => NULL), 'is_admin' => array('type' => 'boolean', 'null' => true, 'default' => '0'), 'role' => array('type' => 'string', 'null' => true, 'default' => NULL), 'created' => array('type' => 'datetime', 'null' => true, 'default' => NULL), 'modified' => array('type' => 'datetime', 'null' => true, 'default' => NULL), 'indexes' => array('PRIMARY' => array('column' => 'id', 'unique' => 1), 'BY_USERNAME' => array('column' => array('username'), 'unique' => 0), 'BY_EMAIL' => array('column' => array('email'), 'unique' => 0)) ); } というスキーマ定義をしたところ、 user_detailsだけ、 user_details: SQLSTATE[42000]: Syntax error or access violation: 1071 Specified key was too long; max key length is 767 bytes というエラーが出てしまいます。キー長がオーバーしているらしいのですが、具体的にどこをどう修正すれば７６７バイト以下になるのかわかりません。 色々試して見たのですがわかりませんでした。 ご教示頂ければ幸いです。よろしくおねがいいたします。
sqlldrを使ってcsvファイルのデータをロードしたいのですが、 ファイル内のデータの属性、型について教えてください。 データが数値にした場合は、 「integer external」と「decimal external」のどちらが良いのですか。 違い、使い方を教えてください。
VARCHAR型のカラムに「改行を含むテキスト」をデフォルト値に設定したいのですが、どうやればできるのでしょうか？
次のmysql文を実行しているのですが、no database selectedと出てしまいます。 データベースのデータはphpmyadminを利用しています（添付画像参照） データベース名をzから始まるサーバー名のようなものを除いたものにしても ダメです。アドバイスいただけませんでしょうか。 （下の分の前後にはサーバーへの接続と切断のリクエストが入り、どちらも 無事接続、切断されています） mysql_select_db("z****_data1"); $re=mysql_query("SELECT * FROM simple_board ORDER BY bang"); echo mysql_error($s); while($kekka=mysql_fetch_array($re)){ print $kekka[0]; print " : "; print $kekka[1]; print " : "; print $kekka[2]; print "<br />"; }
中途でIT企業に入ったものです。 SQLを勉強していますが、UNIONやMINUSという集合演算子を 学習しています。 これは実際の開発業務では、どういったケース（業務の要件？）で 使用されるのでしょうか？。 例えばMINUSだと、「前月で売れたが今月は売れてない商品」を抽出する、 などのケースで使用するのでしょうか。 参考に教えて頂けると助かります。
Visual stadio C# でソフトを開発しています。EXEファイルから他所を閲覧せずに使えるEXEファイルに組み込めるデータベースソフトを探しています。SQLiteは試してみましたが、EXEファイルからDLLを参照する様にできています。コンパイル時にDLLファイルごとコンパイルするとエラーが発生しました。完成時にEXEファイルが一個で済むようなデータベースはないでしょうか。回答のほどよろしくお願いします。
【データベース：SQLServer2005】 SQLのアドバイスを頂きたいです。 【テーブル】 テーブル名：Table1 フィールド名：種類、キー1、キー2 テーブル名：Table2 フィールド名：種類、キー1、キー2 テーブル名：Table3 フィールド名：種類、キー1、キー2 【データ】 Table1 種類、キー1、キー2 001　　AAA　　BBB 001　　AAA　　CCC 001　　AAA　　DDD Table2 種類、キー1、キー2 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　DDD Table3 種類、キー1、キー2 NULL　 AAA　　BBB NULL　 AAA　　CCC NULL　 AAA　　DDD これをUNIONで取得します。 種類、キー1、キー2 001　　AAA　　BBB 001　　AAA　　CCC 001　　AAA　　DDD 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　DDD NULL　 AAA　　BBB NULL　 AAA　　CCC 実現したいのは、 １）同種類、キー1、キー2のデータで、 種類にNULLが含まれていたら、NULLのデータは取得しない ２）同種類、キー1、キー2のデータで、 種類にNULLしかないデータは、取得する 001　　AAA　　BBB 001　　AAA　　CCC 001　　AAA　　DDD 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　DDD　→いる NULL　 AAA　　BBB　→いらない NULL　 AAA　　CCC　→いらない ↓結果 001　　AAA　　CCC 001　　AAA　　DDD 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　DDD 上記を実現する為、UNION後のSQLでも構わないので、 一発のSQLで取得する事は可能でしょうか？ 有識者の方にご享受頂ければ幸いです。 どうぞ宜しくお願い申し上げます。
＜前提＞ ■oldテーブル ・idカラム ・createdカラム ・modifiedカラム ・その他色々カラム ■newテーブル ・idカラム ・createdカラム ・modifiedカラム ・その他色々カラム ＜やりたいこと＞ 両テーブルのidが一致するとき、 newテーブルの「created」「modified」カラムの値で、oldテーブルの同カラムを上書きしたい SQL文を教えてください
OSなどの更新に伴って、Access 2000で作成・運用していたツールをAccess 2010上で運用することになり、いろいろ作業を進めてきましたが、わからないことがありまして、お尋ねします。 よろしくお願いいたします。 Access 2000では、メニューの「ツール」→「オプション」の「表示」タブにある 「ウィンドウをタスクバーに表示」のチェックをONにしておくと、 複数のフォームを開いたときに、タスクバーにそれぞれのフォームのアイコンが表示され、 それをクリックすることで、たやすくアクティブなフォームを切り替えることができました。 大変重宝していましたが、Access 2010ではこれに相当するオプションの設定項目がありません。 また、Access2000で設定したファイルをAccess2010で開いても、同じようには機能しません。 同様の機能を実現する方法をご存知のかた、ぜひお知恵をお貸しくださるよう お願いいたします。 以上、よろしくお願いいたします。
accdbファイルを成績データベースとして，入力インターフェイスにExcelをもちいてデータベースシステムを運用しています． ユーザーがaccdbファイルに接続する時間は1秒未満になるようにしたり，ユーザーがデータベースに書き込みするときは排他接続するなどして，複数ユーザーが直列処理になるようにしています．これで同時利用者が数十名でもファイルは壊れませんでした． ですが，ファイルが肥大化して，年度初め10MBだったのが学期末には40M近くになっていました．バックアップ世代をとっていることもあり，ちょっと困るなと思い，手動でAccessアプリケーションによる最適化を行いました． システムはADOで作っているので各ユーザーの入力作業ではAccessアプリケーションは基本的に使いません．ただ，学期末処理をする際にExcelからAccessアプリケーションを呼び出してある資料をレポート出力します． そこで質問です．accdbファイルをAccessアプリケーションで開いてオプションで「閉じるときに最適化する」にチェックしておけば，ExcelVBAからaccdbファイルを開いて閉じたときに自動的に最適化されるのですか．
ＡＣＣＥＳＳで、何週間も原因がどうしても解らず困っております。お助けください。 ある条件を基に複数のテーブルを参照しデータ加工を行った後に、レポート作成用テーブルのいちばん最後のレコードに必ず追加登録をしたいのですが、いちばん最後のレコードに登録できたり、既に登録されているレコードの間に割り込んで登録されたり処理の検証を行うたびに結果が異なるのです。 何度もデバッグを行いましたが、レポート作成用テーブルへＵＰＤＡＴＥするまでの処理及びデータには間違いありません。レポート作成用テーブルで勝手にデータ入れ替わっているとしか思えないのですが・・・・・・ 最初はＲｅｃｏｒｄｓｅｔオブジェクトはテーブルタイプを指定し、Ａｄｄｎｅｗ及びＵｐｄａｔｅメソッドで追加登録していましたが、思うように動作しないためＲｅｃｏｒｄｓｅｔオブジェクトをダイナセットタイプに変更してみましたが処理結果は変わりません。 ※ＲｅｃｏｒｄｓｅｔオブジェクトでＩｎｄｅｘプロパティの設定はありません 参考書にダイナセットタイプのＲｅｃｏｒｄｓｅｔオブジェクトは、設定されている並べ替え規則にかかわらず、必ずいちばん最後のレコードに追加されると記載されていたので試してみましたが駄目でした。 おおざっぱな説明で現状を理解して頂けるかわかりませんが宜しくお願いいたします。
UTF８のテキストデータを取り込みする際 データが１０フィールドあるとします。 １レコード目の１フィールド目から９フィールド目までデータがあり、１０フィールド目はNULL ２レコード目の１フィールド目から１０フィールド目までデータがある場合 テキストデータ自体９フィールド目までしか取り込めない場合がございます。 こういったレコード終端がNULLの場合とNULLでない場合に取り込む際 注意することはありますでしょうか？？ 因みにデータを取り込む際、文字コードを指定しフィールドの データ型を変更する際 存在するフィールドに比べアクセス上ではフィールド数が足らなくなるのですが・・・ どうぞよろしくお願いします。
CentOS6.xのhttpdにphpMyAdminをセットアップし、別マシンにおいてあるMySQLに接続しようとしています。 外部マシンにtcpで接続するため、内部ソケットは使用しないと考えておりますが、アクセスしますと、なぜか#2002 Can't connect to local MySQL server ...というエラーメッセージが出ます。 お心あたりがあれば、ご教授ください。 ちなみに、別マシン上(CentOS5.x)で同様にphpmyadmin-2.11.11.3-2を稼動させておりますが、こちらは問題なく稼動しております。 要は、現在稼動しているphpmyadmin2をDBを含めphpMyAdmin3にマイグレーションしたいと考えているわけです。 (DBは現行稼動のものをバックアップして別マシンに再構築しています) 諸元値(関連あると思われるもの抜粋) OS=CentOS6.3 phpMyAdmin-3.5.2-1(EPELからyum) php-5.3.3-14(CentOS BASEよりyum) php-mysql-5.3.3(同上) mysql-5.1.61-4(同上) mysql-libs-5.1.61-4(同上) mysqlクライアントでは問題なくアクセスが可能です。 ※アクセスしたときのエビデンスは以下 # mysql -u root -h 10.9.1.7 -p Enter password: Welcome to the MySQL monitor. Commands end with ; or \g. Your MySQL connection id is 74 Server version: 5.1.61 Source distribution Copyright (c) 2000, 2011, Oracle and/or its affiliates. All rights reserved. Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. Type 'help;' or '\h' for help. Type '\c' to clear the current input statement. mysql> config.inc.phpには以下のように設定してあります。 /* Authentication type */ $cfg['Servers'][$i]['auth_type'] = 'cookie'; /* Server parameters */ $cfg['Servers'][$i]['host'] = '10.9.1.7'; $cfg['Servers'][$i]['connect_type'] = 'tcp'; $cfg['Servers'][$i]['compress'] = false; /* Select mysql if your server does not have mysqli */ $cfg['Servers'][$i]['extension'] = 'mysqli'; $cfg['Servers'][$i]['AllowNoPassword'] = false; ※ちなみにphpmyadmin2では、hostとextensionが異なるのみ /etc/httpd/conf.d/phpMyAdmin.confの内容は以下 Alias /mysql /usr/share/phpMyAdmin <Directory /mysql> Order deny,allow Deny from all Allow from all </Directory> ※現在はテスト中なのでInetから切断されたネットワーク環境においてあります /etc/my.conf [client] socket=/var/lib/mysql/mysql.sock port=3306 host=10.9.1.7 user=mysql -- この状態で、httpdを起動し、phpmyadminのフォルダをアクセスすると、userとpassword入力画面まで行きます。 そこで、先にmysqlクライアントで接続可能であったユーザとパスワードを指定すると、冒頭のエラーメッセージが表示されるという具合です。 ちなみに、phppgadminもセットアップしておりますが、こちらは良好に動作しております。 よろしくお願いします。
select文についてお教えください。環境はAccess2003,Win XPで動かしています。 TABLE ID(INT),STOCK(INT) 001,100 001,200 001, 002,200 002,300 002,400 003,100 上記のようなテーブル、データがあります。 ■抽出したい行 001,100 001,200 ■抽出条件 STOCKに空がはいっている。 STOCKに空がはいっている行は選択しない。 STOCKに空がはいっているIDで、同一IDでSTOCKにデータがある行を抜き出したいです。 どのようにSQLを組み立てればよいかわかりません。 宜しくお願い致します。
MAMPにてMYSQLを導入しています。 Mac os x snow leopard10.6.8 php5.3.6 mysql5.5.9 apache2.2.21 文字コードを確認すると最初はlatin1となっているため、ネットで調べ対処してみました。 対処した内容としては、以下になります。 (1)/MAMP/db/mysql/ にリネームしたmy.confを置く。 (2)[mysqld]に、character-set-server=utf8とskip-character-set-client-handshakeを追加。 (3)[mysql]に、default-character-set=utf8を追加。 その後再起動し、文字コードを確認してみたところ、以下の２つがどうしてもlatin1のままです。 character_set_database character_set_server 他にも対処してみたのですが、どうしてもこの２つだけがlatin1のままです。 どういった対処をすれば文字化けを解消できますか？ どうが、解消法をご教示戴けないでしょうか。 宜しくお願いします。
DB内データの<a>タグを、全て[url]タグへ変更したいのですが、どうすればよいでしょうか？ ＜経緯＞ ・ブログを移行したのですが、新しいブログでは、<a>タグを全てエスケープするので、該当データを[url]タグへ一括変換して、リンク表示させたい ＜変換したいこと＞ ・対象DB指定カラム(entry)内の、全ての「<a href="○○">△△</a>」を、「[url=○○]△△[/url]」へ変更したい ＜質問＞ ・どうやって、やるのでしょうか？ ・UPDATE文を利用して、正規表現とかでやるのでしょうか？ ・それとも、ＤＵＭＰデータを取得して、秀丸で正規表現とかでやるのでしょうか？ その場合は、どう書けば良いでしょうか？ ＜環境＞ ・MySQL
MAMPにてMYSQLを導入しています。 Mac os x snow leopard10.6.8 php5.3.6 mysql5.5.9 apache2.2.21 文字コードを確認すると最初はlatin1となっているため、ネットで調べ対処してみました。 対処した内容としては、以下になります。 (1)/MAMP/db/mysql/ にリネームしたmy.confを置く。 (2)[mysqld]に、default-character-set=utf8とskip-character-set-client-handshakeを追加。 (3)[mysql]に、default-character-set=utf8を追加。 その後再起動し、文字コードを確認してみたところ、以下の２つがどうしてもlatin1のままです。 character_set_database character_set_server 他にも対処してみたのですが、どうしてもこの２つだけがlatin1のままです。 どういった対処をすれば文字化けを解消できますか？ どうが、解消法をご教示戴けないでしょうか。 宜しくお願いします。
SQLServerでOracleのGREATEST関数のような事がしたいです。 具体的に書きますと、 ID | 列1 | 列2 | 列3 | 列4 | 列5 ------------------------------ 01 | 700 | 200 | 300 | 400 | 100 02 | 100 | 800 | 200 | 300 | 200 03 | 100 | 300 | 900 | 100 | 100 という表があった場合に ID | 最大値 ------------------------------ 01 | 700 02 | 800 03 | 900 といった結果を求めたいです。 CASE等を利用するしか方法はないのでしょうか。
いつもお世話になります。 oracleのシーケンスの欠番を確認したいのですが、以下のようにサービス、インスタンスの再起動を試してみたのですが欠番はおきませんでした。 ・サービスの再起動 コントロールパネルから、サービスを開いて、「OracleServiceXE」、「OracleXETNSListener」の再起動。 シーケンスをselectした結果、欠番確認できず。 ・インスタンスの再起動 コマンドプロンプトを起動し、sqlplusから、sysdbaでoracleに接続。 shutdown、startupコマンドを行い、インスタンスを再起動。 シーケンスをselectした結果、欠番確認できず。 インスタンスの再起動を行えば欠番がおきる、というのをサイトで見たのですが、欠番は起きませんでした。なぜ起きないのでしょうか。 何か手順に不備があるのでしょうか。 alter system文による欠番は確認しています。 しかし、意図的にこのコマンドを発行しなければよいので、確認したいのは、通常運用時、データベースが起因してシーケンスの欠番が発生してしまう、ということです。 再起動などは普通に行うと思うので、その際に欠番が発生することを確認したいのです。 宜しくお願いします。 oracle：Oracle Database 11g Express Edition Release 11.2.0.2.0 OS：Windows Vista Home Promium 64bit
例えばこのようなサイト。 http://www.fimosw.com/ 左上にID（メールアドレス）パスワード その下に新規会員登録とありますが、 この、新規会員登録のシステムを自分で制作して、IDパスワードを入力して 自由にログインできるサイトを作りたいと思ってます。 ちなみに、CMSはWordPressを利用します。 私はhtml・css・phpは理解してますが、データベース(mysql)に 関しては疎く途方にくれてます... どなたか、作り方の概要だけでもいいので教えていただけ ないでしょうか・・・？ または、参考になるような書籍でも.... お願いします(。・ω・。)
有るデータを元に指数近似曲線を描かせると「y = 2E+08e-0.098x　R² = 0.9847」と出ました。 インターネット等を参考にしてエクセルで値を計算させようとして以下の式を作りましたが計算結果が全く元データと合いません、何が間違っているのでしょうか？教えて下さい。 y = 2E+08e-0.098x⇒ｙ=2*POWER(10,8)*EXP((-0.098*ｘ))
PerlとMysqlでWebアプリケーションを構築しています。 その中で銀行口座のような入金・出金・残高・日付・摘要のような項目があります。 実際はお金ではなく、ポイントなので 入ポイント・出ポイント・残高ポイント・摘要です。 （日付・摘要はここでは問題ではありません） そこで本題なのですが、こういったDBを設計する際にフィールドは 入ポイント・出ポイントの２つにして、残高は出力する際に計算するのがいいのか それとも 入ポイント・出ポイント・残高ポイントの3つにして、インサートするさいに 毎回前残高を取得して、計算後インサートするのがいいのでしょうか？ ※ちなみに会員用のシステムなのでその他にIDフィールドなどがあるのはここでは割愛しております。 不明な点や不足情報があればご指摘ください。 恐れ入りますがよろしくお願いいたします。
アクセスでテキストデータを取り込む際でのご質問がございます。 外部データからテキストデータを指定して 文字コードを指定して指定フィールドを文字列（テキスト型）として取り込もうとする際 例　取り込み前のデータ（文字列の後ろにスペースを含んだ半角20桁の文字列） 　　 "1234567‐11‐2‐3 " "1234567‐234 " " " 　　＊投稿画面ではスペースが表示されません） 　　文字列（テキスト型）として取り込んだデータ 　　　"1234567‐11‐2‐3" "1234567‐234" "" となりスペースが消されてしまうのですが スペースが消されないでテキストデータを 取り込める方法をご存知の方いらっしゃいますでしょうか？ どうぞよろしくお願いします。
MySQLの事で質問です。 テーブル１～４を結合してフィールド「comment」を検索 する時にフィールド「postDate」の降順でソートしたい のですがエラーが出ました。 「SQLコマンド」 select text from table1 union all select comment from table2 union all select comment from table3 union all select comment from table4 where match(commentIndex) against("検索ワード" in boolean mode) order by postDate desc; 試しに union all select comment from table2 union all select comment from table3 union all select comment from table4 の部分を削除して実行してみた所、成功しました。 後、order by postDate desc;のみ削除した場合でも成功しました。 エラーの内容はこれです↓↓ Unknown column 'postDate' in 'order clause' フィールド「postDate」は存在します。 (varchar型何ですが、それがいけないと思い date型やdatetime型と変えてみましたがダメでした) 何とかソートしたいのですがどうすればいいのでしょうか？
シノニムって、エイリアスと同じ意味？ ってことは、いわば、エイリアスのエイリアス？
アクセスで、テキストデータを開き クエリウィザードからフィールドの抽出条件として 文字が含まれているものと文字が含まれていないものと それぞれ抽出したいのですが Likeの式から抽出出来るのでしょうか？ なにかの文字を含んでるデータに対しては 抽出できるのですが、うまく抽出出来ません。 下記のようなイメージで抽出したいと思ってます。 例　データ合計５件 　　 "00000001234-23 " "12345672-1-2 " "" "55145672-1-3-2 " "" 　　 データあり３件 　　 "00000001234-23 " "12345672-1-2 " "55145672-1-3-2 " 　　 データなし２件 　　 "" "" 宜しくお願いします。
Oracleでストアドパッケージを作っています。 key1　key2　key3　sdate　　　edate 1　　 1　　 1　　 2012/07/12 2012/09/11 2　　 2　　 2　　 2012/06/01 2012/07/31 こんなデータがあった時、以下のように日付の範囲を展開した レコード群を得たいのですが、やり方が思いつきません。 key1　key2　key3　date 1　　 1　　 1　　 2012/07/01 1　　 1　　 1　　 2012/08/01 1　　 1　　 1　　 2012/09/01 2　　 2　　 2　　 2012/06/01 2　　 2　　 2　　 2012/07/01 事情により、Typeは使えません。 展開後、別途SQLで利用するつもりです。 ストアド内だけで実装可能でしょうか？
こんにちは。SQLについてお教えください。 環境はWin XP Access 2010です。 Table1 ユーザーID,商品ID,数量 001,ABC,3 001,XYZ,2 上記のテーブルを元に下記のようなデータSQLのみで実現できるでしょうか？ 001,1 001,1 001,1 001,1 001,1 1ユーザーIDに対し、数量の合計分の行数を抽出したいです。 VBAでプログラムは使わずに標準の関数のみでできればと思っていますが、できますでしょうか？
xamppを自分のPCに入れて、MySqlを起動しようとしましたが、 「Start」を押して「Running」が一瞬アクティブになりますが、すぐに消えます。 対処方法をよろしくお願いします。 ■PCの環境 ・OSはwindowsXP。 ・Skypeはインストールしていない。 ・OSは最近リカバリーしており、日が経っていない。 ■xamppの環境 バージョン1.7.4を使用。 ■現在までに試みた事(結果、改善しませんでした)。 ・コマンドプロンプトで、「netstat -an -o」を実行して確認したが、 他に３３０６のポートを使用している形跡がない。 ・ファイヤーオール及びウイルスソフトを停止。 ・「Windwsファイヤーオール」画面の「例外」で、MySqlを追加。
SQLのINSERT文について Accessを使用していて1列目が管理Noとなっています。 その時のレコード数を管理Noに指定したいのですがうまく行きません。 Insert Into TableA Values((Select Count(*) From TableA),'データ') 原因もしくは他の方法があればご教授お願いします。
現在Webアプリを制作しています。 そこで検索機能を作成するにあたり FullTextで全文検索を行う処理を考えています。 Like文を使って検索するより速いらしいのですが、 insert/update文を実行しデータベースにデータを挿入/更新する際 FullTextで全文検索を行う場合だとインデックスを再構築する必要が あるみたいです。 http://melrose.jugem.cc/?eid=323 このインデックスの再構築についてよく分からないのですが、 上記のサイトではインデックスの再構築には REPAIR TABLE [テーブル名] QUICK; を実行とありました。 データの挿入/削除 処理後の検索インデックス修復には innsert 又は update文の直後にREPAIR TABLE [テーブル名] QUICK; を 実行するという事でいいのでしょうか？
　MySQLのFOREIGN KEYについて質問です。 下記のようにitemテーブルを作ってからarrivalhistoryテーブルを作ろうとすると ERROR 1005 (HY000): Can't create table 'xxx_db.arrivalhistory' (errno: 150) というエラーが出てしまいます。 自分でもForeign keyの作り方等調べてはみたのですが、 上手く解決することができません。 どなたかアドバイス下さい。お願いします。 ・親 create table item ( id bigint not null primary key, itemno VARCHAR(50) ) engine=InnoDB; ・子 create table arrivalhistory( id int primary key, itemno varchar(50), arrivaldate date, index(itemno), foreign key(itemno) references item(itemno) on update cascade on delete cascade ) engine=InnoDB;
現在,ACCESS2007を用いてデータベースを作成しています。 ACCESSで添付図のように,品番が同じ場合は,結合するようなことは可能でしょうか? 最初,OWCのSPREADSHEET11.0の使用検討をしたのですが,レポート上へのSPREADSHEETへの値の渡し片がわからずに,断念いたしました...
ロリポップサーバーを借りているのですが、仕様を見ると何でもデータベースを一個持つことができるんだそうです。 これの意味がちょっと分かりません(^_^; というのも、サーバーにファイルを置けばそれでデータベースになると思っていたんですが違うんでしょうか？ いまいちデータベースについて解っていないような気がします。 Accessのような形を想像していたんですが、ああいうのをサーバーでやろうとしたら、PHPとかCGIなどを駆使して作るものだと思っていたんですけど違うんでしょうか？ サーバーのデータベース機能って、どういう時にどんな感じで使うんでしょう？
mySQLでデータベース内の全てのテーブルに対するクエリーに関して質問があります(mySQL 5.5)。 仮に 「ichinensei」というデータベースにテーブル「1_kumi」「2_kumi」「3_kumi」 .....と複数のテーブルがあるとします。 テーブルは全て同じデータ形式で仮に name (char) | weight (int) という名前と体重の情報が登録されているとします。 やりたいことは全てのテーブルに対しweightを検索キーとして該当するレコードのnameをとってくる、という操作です。 weight（体重）が41,42,43,50,51であるレコードの名前を列挙するためには SELECT name FROM (全てのテーブル)　WHERE weight IN (41,42,43,50,51) 上記のようなクエリ文が考えられますが（全てのテーブル）に対する検索を１文で済ます方法が分かりません。 実際の作業ではテーブル数が数十個なのでなるべくunionなどを使ってテーブルの数分クエリ文を書くというのは避けたいと考えています。 このような場合どのようなクエリ文が使えるのでしょうか？
＜前提＞ ・created_at 登録日時カラム … 必ず値がある ・modified 更新日時カラム … nullの場合もある この時、更新日時カラムの値があれば、更新日時カラムを選択、 更新日時カラムがnullなら、登録日時カラムを選択した状態で、 降順表示させたいのですが、どうすれば良いでしょうか？ やりたいのは、こんな感じです ORDER BY 更新日時カラムの値があれば、modified 更新日時カラムがnullなら、created_at DESC
下記のDDL文を出力し実行したところ、ERROR 1064となりました。 どのように修正すればいいでしょうか？ よろしくお願いします。 create table summary_type ( summary_type_id INT not null comment 'summary_type_id' , summary_type_name VARCHAR not null comment 'summary_type_name' , summary_type_order INT not null comment 'summary_type_order' , constraint summary_type_PKC primary key (summary_type_id) ) comment 'summary_type' ;
OS: CentOS-6.3 (64 bit) はじめまして Oracle Express Edition (11g Release2) を使って Oracle の勉強を始めた者です。 dba グループに属するユーザでログインし、端末から sqlplus / as sysdba と入力しても、 ERROR: ORA-12547: TNS: 接続を失いました。 となってしまいます。 その後、ユーザ名とパスワードを入力すると、接続できます。 このエラーが出ないようにするには、どうすればいいでしょうか？ よろしくお願いします。 ＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿ [oracle_admin@dell-t108 ~]$ sqlplus / as sysdba SQL*Plus: Release 11.2.0.2.0 Production on 月 8月 6 17:41:06 2012 Copyright (c) 1982, 2011, Oracle. All rights reserved. ERROR: ORA-12547: TNS: 接続を失いました。 ユーザー名を入力してください: sys@xe as sysdba パスワードを入力してください: Oracle Database 11g Express Edition Release 11.2.0.2.0 - 64bit Production に接続されました。 SQL> SQL> select count(*) from hr.employees; COUNT(*) ---------- 107 SQL> exit Oracle Database 11g Express Edition Release 11.2.0.2.0 - 64bit Productionとの接続が切断されました。 [oracle_admin@dell-t108 ~]$ id uid=502(oracle_admin) gid=501(dba) 所属グループ=501(dba) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 [oracle_admin@dell-t108 ~]$
お世話になります。 当方、現在ACCESSにてORACLE データベース更新用のフォームを作成しています。 このフォーム内のリストボックスのデータソースにORACLEのリンクテーブルを使用しています。 通常、これを開いたときにODBC接続用のダイアログ画面が表示されると思うのですが、 このダイアログを表示しないようにするにはどうすればよいでしょうか? フォームOPEN時にVBA内でoo4oを使用してこのDBに対して適当なSELECT文を実行するように しても表示されてしまいます。 ご存知の方がいればご教示いただきたく存じます。 何卒よろしくお願いいたします。
MySQL5.5を使っています。 日時データを格納するカラムについて ・Insert時、自動的に日時データを取得する ・Update時、日時データを自動更新しない という設定ができる型はありますでしょうか？ Timest_ampだとUpdate時に日時データを自動更新してしまうのでしょうか。 どなたかご存知の方がいらっしゃいましたらお願いいたします。
２４年度春の午後問題で質問があります． $ select * from meisaihyo; +----------------+--------------+-------+ | seisancode | ryoricode | dish | +----------------+--------------+-------+ | 3100186　|　　　　　1 |　　1 | | 3100186　|　　　　　2 |　　1 | | 3100187　|　　　　　1 |　　1 | | 3100187 　|　　　　　2 |　10 | +----------------+--------------+-------+ $ select * from ryorihyo; +--------------+---------------+--------+------+ | ryoricode | ryoriname | price | cal | +--------------+---------------+--------+------+ | 1　　　　　| rice　　　|　100 |　500 | | 2　　　　　| meat　　|　280 |　1000| +--------------+---------------+--------+------+ この２つのテーブルがあり，各料理の枚数多い順に表示するものです． 選択肢から２択まで絞れたんですが，以下の２つの違いがわかりません． 複数のテーブルを結合する場合，列の値を一致させる必要がありますが， table1.hoge = table2.hogeと書こうが，table1.hoge in (select hoge from table2)と書こうが一緒だと思います．なぜなら，inを使うとtable1.hogeと同じ行しか対象にならないと思いからです． 解説をお願いします．．．． (1) $ select ryorihyo.ryoriname, ryorihyo.cal, sum(meisaihyo.dish) as dish from ryorihyo, meisaihyo where ryorihyo.ryoricode=meisaihyo.ryoricode group by ryorihyo.ryoriname order by dish desc; +-------------- +------+------+ | ryoriname | cal | dish | +---------------+------+------+ | meat　　　| 1000| 11 | | rice　　　　| 500 | 2 | +---------------+-------+-----+ (2) $ select ryorihyo.ryoriname, ryorihyo.cal, sum(meisaihyo.dish) as dish from ryorihyo, meisaihyo where ryorihyo.ryoricode in (select meisaihyo.ryoricode from meisaihyo where meisaihyo.dish is not null) group by ryorihyo.ryoriname, ryorihyo.cal order by dish desc; +---------------+------+------+ | ryoriname | cal | dish | +---------------+------+------+ | rice　　　　| 500 | 13 | | meat　　　|1000| 13 | +---------------+-------+-----+
C言語でMySQLを操作することを考えて勉強を始めたばかりなのですが、データベースのフィールドの数を表示するプログラムを作ったところ、エラーが出てしまいます。以下がコードです。 #include<windows.h> #include<stdio.h> #include<mysql.h> int main(int argc, char **argv) { MYSQL *mysql; MYSQL *con; MYSQL_RES *result; mysql = mysql_init(NULL); if(NULL==mysql){ printf( "SQLの初期化に失敗しました．\n" ); exit(1); } const char *sever ="localhost"; const char *user = "root"; const char *password = "*******"; const char *database = "features"; unsigned int portnumber = 0; unsigned int num_fields; con = mysql_real_connect(mysql, sever, user, password, database, portnumber, NULL, 0); if(NULL==con) { printf( "SQLのオープンに失敗しました．\n" ); exit(1); } result = mysql_store_result( mysql ); num_fields = mysql_num_fields( result ); printf("fieldの数は%dです。",num_fields); mysql_close( mysql ); printf( "SQLをクローズしました．\n" ); return 0; } ビルドは正常終了するのですが、 これでF5を押すと、 mysql.exe の 0x5b8a8f04 でハンドルされていない例外が発生しました: 0xC0000005: 場所 0x00000048 を読み込み中にアクセス違反が発生しました とエラーが、Ctrl+F5を押すと、 mysql.exe は動作を停止しました と出る状態です。 試しにmysql.exeを直接起動してみるとやはり、エラーの画面が出ます。 MYSQL_RES *result; unsigned int num_fields; result = mysql_store_result( mysql ); num_fields = mysql_num_fields( result ); printf("fieldの数は%dです。",num_fields); を消せば、正常に終了して、 SQLをクローズしました． と出ます。 環境は、Windows 7 ultimate、OSは64bit 開発環境は、Microsoft Visual C++ 2010 Express です。 MySQLはMicrosoft Visual C++ 2010 Expressで動くように32bit版を入れています。 どこが原因でエラーが起こっているのでしょうか？ よろしくお願いします。
教えてください。 grant all on データベース名.* to ユーザー @外部IPアドレス identified by 'パスワー'；を実行しましたが、本当にこの外部IPアドレスでgrantされているかの確認をしたいのですが、何か確認コマンドはありますでしょうか。この外部IPアドレスが表示されていればOKです。 あと1点質問ですが、mysql>use データベースしてから確認する必要がありますでしょうか。 宜しくお願いします。
Visual C# 2010 Express（WPFアプリケーション）とSQL Server 2012 Expressでツール（データベースアプリケーション）を作成していますが，いまいち作り方を理解しておらず合っているのかわからないので，教えていただきたいです。 作成しているツールは会社の課内で使用します。 最終的には課内サーバーに保存してあるDBファイルに各社員のパソコンから作成したツール経由でDBへ読み書きします。ツールの開発は私のパソコンで行います。 課内サーバはWindowsServer2010でIPアドレスを仮に\\11.22.33.444とします。 各社員のパソコンはWin7でIPアドレスを仮に\\11.22.33.445とします。 なお本文では下記のように略して記載します。 SQL Server 2012 Express：sqlserver SQL Server Management Studio Express 2012：SSMS Visual C# 2010 Express：VC# ■私が行った作成手順 ※サーバで操作 (1)サーバにsqlserverとSSMSをインストール (2)KANAISQLという名前でインスタンスを作成。Windows認証。 (3)SSMSのセキュリティでログインユーザの中に自分のドメインユーザ名を登録 (4)SSMSで「E:\…DATA」の中に：データベースを作成(BOOKDB.mdf)。テーブル「BOOKInfo」を作成。ついでに1レコード作成。 (5)SSMSでBOOKDB.mdfをデタッチ (6)BOOKDB.mdfを「E:\…booksDB」にコピペ ※開発PCで操作 (7)パソコンにVC#，sqlserver，LocalDB，SSMSをインストール (8)SQLEXPRESSという名前でインスタンスを作成。Windows認証。 (9)VC#でWPFアプリケーションを新規作成 (10)[データ]メニューの[新しいデータ ソースの追加]→[データベース]→[データセット]→[\\11.22.33.444\…booksDB\BOOKDB.mdf]を指定→テスト接続を実行→接続OK →「ローカルにデータをコピーしますか？」といった画面で「OK」をクリック (11)データソースナビゲーションパネルから「BOOKInfo」をDataGridを指定してユーザーフォームにドラッグ＆ドロップしてバインド。 (12)デバッグしてみる→正常にレコードが表示された。 (13)Datasetをデザイナーから編集でInsertクエリを作成 (14)ユーザフォームにボタンを追加してInsertクエリとUpdateクエリを実装 (15)デバッグとリビルドしてexeを実行してみる。→ツール上では正常に表示＋テーブル追加された。 (16)DBファイルを確認してみた。開発PC内のデバッグフォルダリリースフォルダ内にある「BOOKDB.mdf」は更新されていた。 ※サーバで操作 (17)サーバの[E:\…booksDB\BOOKDB.mdf]が更新されているか確認してみた。 →更新されていない。(6)の時から変更なし。 ■わからないこと 1．ツールからサーバのDBへデータの変更を反映させるためにはどうしたらよいのでしょうか。 2．またツール完成後に各社員がこのツールを使用する場合は，全員sqlserverとLocalDBをパソコンにインストールしなければならないものなのでしょうか。 詳しい方ご教授御願いいたします。
お世話になります。 データが更新された段階で、外部プログラム(xxx.exe)を実行したいと考えております。 おそらく、トリガを利用すれば可能かと思い調査しておりますが、 どのようにして外部プログラムを実行すればよいか分かっておりません。 ご存知の方、ご教示頂けないでしょうか。 よろしくお願いいたします。
Windows2008 Hyper-VゲストOS上にWindows2008 + MySQL5.5にてDB環境を構築しています。 そのMySQL環境にて下記２つのテーブルからviewテーブルを構築しています。 ○テーブル１（1,000行） CREATE TABLE `testdb`.`mst` ( `KBN` char(10) COLLATE cp932_bin NOT NULL, `NM` char(48) COLLATE cp932_bin DEFAULT NULL, `MSTDATE` int(10) DEFAULT NULL, PRIMARY KEY (`KBN`), KEY `idx_bookkbn_spdate` (`DATE`) ) ENGINE=InnoDB DEFAULT CHARSET=cp932 COLLATE=cp932_bin; ○テーブル２（145,000行） CREATE TABLE `testdb`.`dt` ( `KEYID` int(10) NOT NULL, `KBN` char(10) COLLATE cp932_bin NOT NULL, `MEMO` varchar(1024) COLLATE cp932_bin DEFAULT NULL, `SUBC01` char(128) COLLATE cp932_bin DEFAULT NULL, `SUBC02` char(128) COLLATE cp932_bin DEFAULT NULL, `SUBN01` int(10) DEFAULT NULL, `SUBN02` int(10) DEFAULT NULL, PRIMARY KEY (`KEYID`,`KBN`), KEY `idx_dt_keyid` (`KEYID`), ) ENGINE=InnoDB DEFAULT CHARSET=cp932 COLLATE=cp932_bin; ○view CREATE OR REPLACE ALGORITHM=UNDEFINED DEFINER=`test`@`%` SQL SECURITY DEFINER VIEW `viewdtmst` AS select distinct `dt`.`KEYID` AS KEYID, `dt`.`KBN` AS KBN, `dt`.`MEMO` AS MEMO, `dt`.`SUBC01` AS SUBC01, `dt`.`SUBC02` AS SUBC02, `dt`.`SUBN01` AS SUBN01, `dt`.`SUBN02` AS SUBN02, `mst`.`NM` AS NM, `mst`.`MSTDATE` AS MSTDATE, from (`dt` left join `kmst` on((`dt`.`KBN` = `mst`.`KBN`))); ■ここからご相談となります。 上記viewdtmstに対して下記の様なクエリーを実行すると 処理時間が12.5426sとかなり時間がかかり改善したいと考えています。 -------------------------------------------------------------- 検索クエリー -------------------------------------------------------------- SELECT * FROM viewdtmst WHERE KEYID = 10010 ORDER BY KEYID,MSTDATE DESC,KBN; -------------------------------------------------------------- 上記クエリーのexplain結果 -------------------------------------------------------------- id, select_type, table, type, possible_keys, key, key_len, ref, rows, Extra 1, 'PRIMARY', '<derived2>', 'ALL', '', '', '', '', 143906, 'Using where; Using filesort' 2, 'DERIVED', 'dt', 'ALL', '', '', '', '', 150813, 'Using temporary' 2, 'DERIVED', 'mst', 'eq_ref', 'PRIMARY', 'PRIMARY', '20', 'testdb.dt.KBN', 1, 'Distinct' viewを介せず直接下記のクエリーを実行すると 処理時間0.0024sで検索結果がもとまります。 -------------------------------------------------------------- viewを使わないクエリー -------------------------------------------------------------- select distinct `dt`.`KEYID` AS KEYID, `dt`.`KBN` AS KBN, `dt`.`MEMO` AS MEMO, `dt`.`SUBC01` AS SUBC01, `dt`.`SUBC02` AS SUBC02, `dt`.`SUBN01` AS SUBN01, `dt`.`SUBN02` AS SUBN02, `mst`.`NM` AS NM, `mst`.`MSTDATE` AS MSTDATE, from (`dt` left join `kmst` on((`dt`.`KBN` = `mst`.`KBN`))) where KEYID = 10010 order by KEYID,MSTDATE DESC,KBN; -------------------------------------------------------------- viewを使わないクエリーのexplain結果 -------------------------------------------------------------- id, select_type, table, type, possible_keys, key, key_len, ref, rows, Extra 1, 'SIMPLE', 'dt', 'ref', 'PRIMARY,idx_dt_keyid', 'PRIMARY', '4', 'const', 10, 'Using temporary; Using filesort' 1, 'SIMPLE', 'mst', 'eq_ref', 'PRIMARY', 'PRIMARY', '20', 'testdb.dt.KBN', 1, '' なんとかviewを使って処理速度改善を図りたいのですが、ご意見いただけないでしょうか。 よろしくお願いいたします。
こんにちわ Access2003を使っています ---------------------------------------------- __開始日時_________ ___終了日時_____検査内容__検査者名 2012/6/12 9:00 2012/6/12 11:00 検査A 名前 2012/6/12 10:00 2012/6/12 13:00 検査B 名前 2012/6/13 9:00 2012/6/13 10:00 検査C 名前 2012/6/14 10:00 2012/6/14 12:00 検査A 名前 ---------------------------------------------- のデータから。 6/12 検査A　1件 検査B　1件 6/13 検査C　1件 6/14 検査A　1件 月合計 A検査　2件 B検査　1件 C検査　1件 と、日々の各合計と、月合計の2種類の合計を取りたいと思います。 どの様な方法を取ればいいのか教えていただけませんでしょうか？ よろしくお願いします。
こんにちは、ほぼ初心者ですがよろしくお願いします。 sqlite2 で以下のような倉庫テーブルと在庫数テーブルがあったとして、 手順５で、ある品物(item_id = 1)の倉庫ごとの在庫数を取得したいと思っています。 倉庫に結合する在庫データがなくても、 倉庫に対する行を取得できる SQL 文を教えていただけませんでしょうか？ ※そもそもテーブルの作り方がおかしいでしょうか？ その辺も含めてアドバイスいただけるとありがたいです。 -- 以下sqlite です .mode column .header ON -- 手順１ 倉庫テーブル CREATE TABLE stock_sites ( id INTEGER NOT NULL PRIMARY KEY , name TEXT NOT NULL ); -- 手順２ 在庫テーブル CREATE TABLE stocks ( id INTEGER NOT NULL PRIMARY KEY , stock_site_id INTEGER NOT NULL, item_id INTEGER NOT NULL, stock INTEGER NOT NULL, UNIQUE(stock_site_id, item_id) ); -- 手順３、倉庫データ INSERT INTO stock_sites(name) VALUES('site_A'); INSERT INTO stock_sites(name) VALUES('site_B'); INSERT INTO stock_sites(name) VALUES('site_C'); -- 手順４、在庫データ INSERT INTO stocks(stock_site_id, item_id, stock) VALUES(1,1,10); INSERT INTO stocks(stock_site_id, item_id, stock) VALUES(2,2,20); -- 手順５ ある品の倉庫ごとの在庫数を取得したい SELECT t1.name AS site_name, t2.* FROM stock_sites AS t1 LEFT JOIN stocks AS t2 ON t1.id = t2.stock_site_id WHERE t2.item_id = 1 ORDER BY t1.id; -- 結果 -- site_name　　t2.id　　　t2.stock_site_id　t2.item_id　t2.stock -- ----------　----------　----------------　----------　---------- -- site_A　　 1　　　　　 1　　　　　　　　 1　　　　　10 -- 欲しい結果 -- site_name　　t2.id　　　t2.stock_site_id　t2.item_id　t2.stock -- ----------　----------　----------------　----------　---------- -- site_A　　 1　　　　　 1　　　　　　　　 1　　　　　10 -- site_B -- site_C
SELECT (副問い合わせ).a, (副問い合わせ).b, (副問い合わせ).c, (副問い合わせ).d FROM TableA ※副問い合わせの抽出条件は同じ このように同じ副問い合わせが複数あるとそれだけ処理が重くなるのでしょうか？ どうしたら一つにまとめることができるのでしょうか？
アクセス2010で、UTF8形式のテキストを開き、レコードごとにデータを 抽出する際でのご質問がございます。 指定された県の郵便番号を、レコードを抽出して、ファイルで保存する際、テキスト型文字コードUTF8に指定して保存したのですが、レコード内のフィールド文字列でスペースを含んだ半角文字14桁と全角文字8桁の混合文字列が、保存後、前半部分の半角文字のスペースがなくなってしまいます。 下記のような例がイメージとなります。 例　ァァァ　　　　　　　　　　　亜亜亜亜亜亜亜亜 　　　↓ 　　ァァァ　亜亜亜亜亜亜亜亜　 （半角領域のスペースが１桁しかなくなってしまう） のようになってしまうのですが なにか良い保存方法はありますでしょうか？ どうぞよろしくお願いします。
Oracleバージョン10 です。 group byの項目の並び順を変えると結果が異なるのですが、何か原因は考えられるでしょうか？ 例えば以下のSQL ------------------ SELECT T1.COL1, T1.COL2, T1.COL3, TRUNC(T1.COL4,'MONTH') COLM, SUM(T1.COL5) FROM TABLE1 T1 GROUP BY T1.COL1, T1.COL2, T1.COL3, TRUNC(T1.COL4,'MONTH') MINUS SELECT T1.COL1, T1.COL2, T1.COL3, TRUNC(T1.COL4,'MONTH') COLM, SUM(T1.COL5) FROM TABLE1 T1 GROUP BY TRUNC(T1.COL4,'MONTH'), T1.COL1, T1.COL2, T1.COL3 ------------------ このMINUS結合の結果でデータ（差分）が出力されます。 MINUS結合の前と後で違いがあるのは、GROUP BYの並び順のみです。 TRUNC関数を記載してますが、どうもこのTRUNC関数を除くと、 差分が出力されなくなるようです。 （TRUNCを辞めて、ただのT1.COL4 にした場合） なので、TRUNC関数が何か関係してるかも知れません。 原因が分かりません。オラクルの障害が何かなのかも知れません。 何か原因は考えられるでしょうか？
最近、特許に関する事を調べてまとめる業務をしています。 どの会社が、いつ、どんな内容で、どんな特許を申請しているか等を調べています。 今はエクセルの表に一覧にして記入しているのですが、最終的にはデータベースソフトのアクセスを 使ってデータを管理しようと考えているのですが、今回のように特許に限らず、データが多い時に 便利なアクセス以外のソフト（有料でも可）や、アクセスやエクセルでこの機能をこう使うと便利だよ等 ありましたら教えて下さい。 よろしくお願いしますm(_ _)m
こんにちは、データベース初心者です。 ―――― id | tag ―――― 1 | 1002 1 | 1004 1 | 4005 2 | 3001 というような、IDに複数の検索用タグが付いているテーブルに対して、 select TB2.id from tb as TB1 inner join tb as TB2 on TB2.id=TB1.id where TB1.tag=1002 and TB2.tag=1004 limit X,Y; というような、任意の数（例は2個）の指定したtagを全て含むIDを検索するクエリがあります。 （指定が3個の場合は単純にinner join を増やしています） で、指定のtagが1つの場合は一瞬で返されるのですが、 複数指定の場合に何秒もかかるときがありまして、 一瞬で返させるには一体どこを直せばよいのかがわからないのです。 クエリを変えるのか、テーブル構成を変えるのか、マシンを変えなきゃ無理なのか、 こういった場合のセオリーなど、ご指導願いたいのです。 ２つ目の質問として、 order by が無い場合というのは、データに大きな変更が無い期間中は、 同じクエリであれば同じ順序で返ってくると考えて良いのでしょうか？ というのも、上記クエリにorder byを付けたかったのですが、 ソート項目が多数あり断念しまして、ただページング機能は付けたく思いまして。 環境は、ローカルで、winXP、MySQL 5.1、PHP経由で、ブラウザから操作・表示しています。 id数が約1000万、tagは500種ほどあり、1idに対して1～30個ほどで平均8個くらい付いており、 テーブルのレコード数は約8000万となっています。 素人質問で恐縮ですがよろしくお願いします。
環境：Oracle 11g ＳＱＬで階層問い合わせに関して教えて下さい。 今、ある部品テーブルに対し、直下のレコードのみを抽出しようとしていますが、ある共通の 構成をＡ部品群、Ｂ部品群の中に入れた場合、なぜか同じ結果が２回表示されてしまいます。 以下にサンプルのデータとＳＱＬを作成しましたので、何がおかしいか教えて頂きたいと思います。 【Ａテーブル】 品目番号,親品目番号 A A1,A B,A B1,B ↑　Ａ部品群 C D,C B,C B1,B ↑　Ｂ部品群 　※　Bが共通の構成です。 【ＳＱＬ】 select 品目番号 as 下位品目番号,親品目番号 from A_TABLE where 品目番号 != 'B' AND 親品目番号 = 'B' start with 品目番号 = 'B' connect by prior 品目番号 = 親品目番号 【結果】 下位品目番号,親品目番号 B1,B B1,B ２回表示されてしまいます。 単純に親品目番号=’B’としてしまえば正しく拾えますが、上記のＳＱＬを多様している為、 何が間違っているか教えて頂ければと思います。 初歩的な質問で申し訳ありませんが、教えて下さい。
Windows 2003 Server Windows XP Professional Microsoft Office 2000 Oracle Databasse 9.2.0.1.0 １．Sqlnet経由でのExp/Impができません。SQLPLUSは正常につながります。 　　　　EXP system/???@??? FILE= full120725.dmp LOG= exp_full120725.log FULL=y を実行すると、Copyrights　～　all rights reservedで止まったまま、 エラーメッセージも出ません。 @???を取って実行すると正常終了します。 lsnrctl statusを実行すると以下のエラーメッセージが返ってきます。 ****************** (ADDRESS=(PROTOCOL=tcp)(PORT=1521))に接続中 TNS-12541: TNS: リスナーがありません。 TNS-12560: TNS: プロトコル・アダプタ・エラー TNS-00511: リスナーがありません。 32-bit Windows Error: 61: Unknown error ****************** ２．ＯＤＢＣで接続を設定しようとするのですが、 　　　　Microsoft ODBC for Oracle Oracle in Ora92 ともに失敗します。 １と２の原因が同じなのか、違うのか、 それとそれぞれの対処方をご教示できないでしょうか？
ＤＢのテーブル定義書に ＰＫの欄があり 名称　　　　　　PK ＸＸＸＸＸＸＸ P1 ＹＹＹＹＹＹＹ P2 ＺＺＺＺＺＺＺ という感じで書かれている場合、 ＸＸＸＸＸＸＸは複数同じ値で存在可能で、 ＸＸＸＸＸＸＸ　＋　ＹＹＹＹＹＹＹ　のフィールドの値が、両方同じデータは存在しないという意味 であっていますか？ つまり １　１ １　２ １　３ ２　１ ２　２ は存在できるが、 １　１ が更に存在できないということですか？
　現在複数のサイトでショッピングサイト（Amazon,楽天,Yahoo）を始めたのですが、 売り上げ、在庫管理がバラバラでとても不便に感じています。 　 　それぞれの運営しているショッピングサイトのDBからデータを取ってくることができれば、総合的に売り上げ、在庫管理、また、マーケティングにも役立てられると考えています。 はたして、Amazonや楽天、Yahoo等、のショッピングサイトのDBからデータを取ってくることは出来るのでしょうか？ もしご存知の方がいらっしゃいましたら教えて頂きたいと思います。 　また、そういった事が出来ない場合別の方法でそれぞれのサイトのデータを取って来て新たに統合DBを作りたいと考えていますが、一件一件て入力する以外に何か方法はありませんでしょうか？ 　こういった要望は他のサイト運営者等も抱えていると思いますがどうやって管理しているのか等ご存知の方アドバイス頂きたいです。 　よろしくお願いいたします。 　以上
空が返ってきます。 空の場合、0になるようにするにはどうしたら良いでしょうか？ UPDATE `table` SET paidy = (select sum(totaly) from `SUBTABLE`) サブテーブルのデータを元にデータを更新するのに利用しています。 ご存知の方何か良い解決方法を教えて下さい。
PHPプログラムを作りながらMySQLクエリをしていました。MySQLのクエリの過程でviewを作っていましたが開発中なので、createはしたもののdropしないというのをくりかえしてました。 プログラムができたので、createしたら終了時にdropして始末できるようにしました。 そこで、開発過程で残ってしまったviewを、phpMyAdminやコマンドで削除しようとしましたが削除できません。 強制的でもいいので削除する方法を教えてください。
in('3eiklあいうeE','3rrEき134','３我Ea','３ｅ','3Ｅ','3　E',・・・) というようにパターンごとに入れるのは無理なので、 正規表現のような使い方をして、あるカラムに含まれる、いくつかの条件を基準にして、 どれか１つでも条件に一致すれば値を取得するようにしたいです。 ・in句の中は１つ以上９以内です。 １つのときはin('5iosde')のように使います。 ・最初の数値は「1～9」を扱いたいです。 ・2番目に数値がくることはありません。 ・使う文字は、数値・英字・日本語文字列・漢字・記号などあらゆる文字です。 ・使う文字は全て全角半角の両方に対応 ・全体的な数値と文字列の割合はバラバラです。 ・空白から始まっても× ・文字数制限は特にありません。 たとえば「3」から始まり「e」を含むとき ○：取得する ×：取得しない 3eiklあいうeE（←○） 4yyte（←3から始まっていない×） 3rrEき134（←○） Eresry（←3から始まっていない×） ３我Ea（←○） 3aaaa（←eがない×） ３ｅ（←○） 5Eお（←3から始まっていない×） 3Ｅ（←○） 3　E（←○） 　3E（←空白から始まっている×）
MySQLとJavaどちらに投稿しようか迷ったのですがこちらに投稿させていただきます。 Javaでファイルのアップロードを扱おうとしています。 ファイルをMySQLにBLOB型として格納したいのですが、JDBCを利用してストリームとして渡してもByte配列にしてしまうようでたしかに100MB以上のファイルをアップロードしようとするとOutOfMemoryになってしまいました。 調べるとストレージエンジンとしてBlob streamingやPBXTを使えば解決するらしいのですがダウンロードしようと思ってSorceForgeなどを見に行ってもファイルが存在しませんでした。 もう、これらは手に入れることはできないんでしょうか？ 手に入れられないとするとどうやって解決するのでしょうか。最新のバージョンだとストリーミングに対応しているとかあるんでしょうか。 回答よろしくおねがいします。
お世話になります。 現在MySQL5.0.45を使用しているのですが、5.5.25にアップグレードしようと思っています。 直接5.0→5.5にアップグレードはできるのでしょうか？ 検索すると一回5.1にアップグレードしてから5.5を入れるみたいなことを書いてるサイトもあったので質問させていただきました。 また、5.0で使用しているデータベースやSQL文等は5.5でも問題なく使えるんでしょうか。 よろしくお願いいたします。
MySQL初心者です。 すみません。教えてください。 mysqldump -u(ユーザー) -p(パスワード） --default-character-set=sjis （データベース名） > (ファイル名).sqlでバックアップを実行すると自動的に１つのsqlファイルに全テーブル分、以下のように生成されているのですが、リストアする時は既存のデータベースを削除（drop database データベース名;) する必要がない。又、権限付与（grant）もする必要が無いということになりますでしょうか？ 逆にdatやdumpファイルとしてバックアップしているものについては、データベースの削除＆権限付与等行う必要があるということになりますでしょうか？ DROP IF EXISTS 'テーブル名' ； CREATE　TABLE 'テーブル名' ( ) INSERT INTO 'テーブル名' VALUES ( )
Hyper-VのゲストOS上に、Windows Server 2008 R2 ＋　MySQL5.1を利用してDBを構築しています。 今回このMySQL環境に、MSSQL2005よりデータを移行したいと思っていますが上手く移行できないデータがありご相談いたします。 ■相談点 SQL Server 2005からの移行データにMAC外字の文字コード（0x8540～0x889E）が保存されおり、 そのデータをMySQL Migration Toolkit（Version1.1.17）を利用し移行すると異なる文字コードへ変換されてしまう。 例：0x8646 → 0x8145 ■MySQL環境 MySQL5.1の設定、および移行先のテーブル作成構文は下記の様にしています。 [mysql] default-character-set=cp932 [mysqld] character-set-server=cp932 テーブルCreateSQL構文 CREATE TABLE `TBL01` ( `ID` int(10) NOT NULL, `NAME` char(40) COLLATE cp932_bin DEFAULT NULL ) ENGINE=InnoDB DEFAULT CHARSET=cp932 COLLATE=cp932_bin' ■MySQL Migration Toolkitの指定 ・MSSQL接続方法 　jdbc:mysql://192.168.1.1:3306/?user=test&password=test&useServerPrepStmts=false&characterEncoding=cp932 ・MySQL接続方法 　jdbc:mysql://192.168.1.2:3306/?user=test&password=test&useServerPrepStmts=false&characterEncoding=cp932 対処方法をご存じの方がいらっしゃいましたら、教えて頂けないでしょうか。 よろしくお願いいたします。
SQL Server 2008 r2 を利用していますが、 利用期限が180日間のため、そろそろ評価版ライセンスが失効しそうな状態です。 Windows Server 2008のように、 正式ライセンスを購入せず、評価版ライセンスを延長する方法は、ありますでしょうか？
■最終的にやりたいこと ・なるべくコード(SELECT文など)を見ずに、「DB」「テーブル定義者」「ER図」等からテーブル間の関係性を把握したい ■具体例 ・投稿一覧。「userテーブル」「postテーブル」 ・「postテーブル」の「user_id」カラムは、「userテーブル」の「id」カラムに対応 ※簡易な場合はある程度想像は付くのですが、ちょっと複雑な構成になると途端に苦労するので、何か良い方法はないかと思い、質問しました ■質問 ◆「リレーションシップを組む」際、「外部キー制約」はかけるのでしょうか？ 例えば、上記「投稿一覧」DBを構築する際では、どうするのでしょうか？ 1.普通、「外部キー制約」をかける 2.普通、「外部キー制約」をかけない 3.どちらでも良い ◆「外部キー制約」は何の為にかけるのでしょうか？ ・「SELECT＆JOIN」でデータ取得出来るのであれば、「外部キー制約」と「リレーションシップ構築」に関係性はないと思うのですが、そういう認識で合っているでしょうか？ ・参照先データが削除されたら整合性がとれなくなる場合のみかけるものでしょうか？ ◆「リレーションシップを確認」する目的で、「外部キー制約」をかけても良いのでしょうか？ ・「データ削除の整合性」ではなく、「リレーションシップを確認」する目的で外部キー制約」をかけても良いのでしょうか？ ◆「外部キー制約」以外に、「リレーションシップを確認」する方法はあるのでしょうか？ ・コード(SELECT文など)を見ずに、テーブル間の「リレーションシップを確認」する方法としては、「外部キー制約」以外に何かあるのでしょうか？ ・そもそも、「外部キー制約確認」＝「リレーションシップ確認」という考えは正しいのでしょうか？
こんにちは。 SQLについて質問です。 id　　name　　goal 1　　山田　　東京 2　　木下　　北海道 3　　高橋　　大阪 3　　高橋　　沖縄 こういう状態でデータが入っていたとして、 idが3の高橋はgoalが違う状態で2件データがあります。 これを、 id　　name　　goal 1　　山田　　東京 2　　木下　　北海道 3　　高橋　　大阪、沖縄 こうなるようにしたいのですが、 どうSELECT文を書けばよいでしょうか？ よろしくお願いします。　　
現在サーバを設定中なのですが、トラブルが解決出来なく、ご教授願えればと思います。 OSはCentOS 5.8 x86_64です。 MySQLは 5.5.25-1.el5.remi x86_64です。 管理ソフトHDE ISP 6.0です。 毎週日曜日の4:02にMySQLが終了します。 最初から設定されているcronを見ると 4:02に毎日のcronが有ります。 週に一度のcronは4:22に設定されているのでMySQLが終了する時間と違います。 MySQLのログには下記の様になっています。１８日に気がついてMySQLを起動しました。 120715 4:02:08 [Note] /usr/libexec/mysqld: Normal shutdown 120715 4:02:08 InnoDB: Starting shutdown... 120715 4:02:09 InnoDB: Shutdown completed; log sequence number 8651178 120715 4:02:09 [Note] /usr/libexec/mysqld: Shutdown complete 120715 04:02:09 mysqld_safe mysqld from pid file /var/run/mysqld/mysqld.pid ended 120718 15:37:02 mysqld_safe Starting mysqld daemon with databases from /var/lib/mysql 4:02のcron(cron.daily)は下記の１０個のファイルがあります。テキストエディタで内容を見てもMySQLを終了させるような文字は見当たりませんでした。 ●certwatch ●hde-webalizer.cron ●makewhatis.cron ●0anacron ●tmpwatch ●rpm ●logrotate ●mlocate.cron ●00webalizer ●zz-hde-logsurfer 何をこれから調べれば良いのかご教授下さい。
結合は最初に結合された一時的なテーブルを絞りこむ 副問い合わせは行を絞りこんだ後に実行されるかんじなのでしょうか
MySQL初心者です。教えてください。一度コマンドラインからdumpファイルをインポートしたのですが、再度バックアップで生成されたdumpでインポートし直す場合、drop database(ドロップするデータベースを指定)のような事をしてから、もう1回インポートコマンドを流すようなことをするのでしょうか？Oracleの場合、確かdrop userというようなことをしてからインポートし直したことがあると思うのですが。
あるサーバーにDBのダンプをインポート仕様としています psql - U postgresで接続できていることは確認してあります psql -h localhost -U postgres -f xxxxxx.dump xxxxxx とうつとIdent authentication failed for user "postgres"とFATALが出て インポートかでません pg_hba# TYPE DATABASE USER CIDR-ADDRESS METHOD # "local" is for Unix domain socket connections only local all all trust # IPv4 local connections: host all all 127.0.0.1/32 ident # IPv6 local connections: host all all ::1/128 ident.confには下記になってます どうしてでしょうか?
カラムに同じデータしか入れない場合（Aカラムの全てのレコードの値は’テストです’しか入ってない） とバラバラに入れる場合、実行後の速度の結果は変わるのでしょうか。 実行速度の検出をするときはデータをバラバラに入れた方がいいでしょうか。 同じデータの場合は、updateで各カラムの値を１つセットで全てのレコードを更新するだけでよいですが、バラバラの場合は、上記の他にレコードを細かく範囲を分けてデータを入れたり、ランダムを使って数字を作ったり…といろいろすることになり面倒です。
お力をお貸しください。 職場の業務で利用する単純なデータベースを、学習を兼ねて作ってみようと思うのですが、初心者なものでまず実現可能かがわかりません。 環境は ・windowsXP,windows7端末が数台（microsoft SQL server 2008がプリイン済） ・DELLのPower edge T-310がサーバーとして１台（ファイルシステムはNTFS） ・サーバーのフルコントロールは（たぶん）上司に連絡すれば可能。 ・それぞれの端末からサーバーが共有できるが、端末同士で互いに繋がることは出来ない。 ・スタンドアロンでのアプリ作成経験は有り。VBかC#．NETで作成予定。 ・SQLは勉強中…Accessは使えます。 構想では、毎日出し入れするデータをサーバーにおいて、アプリを入れたどの端末からでも修正、更新が可能なようにしたいのです。データは小規模で、同時に何人も使用することはありません。 このような場合、まずはSQLserverをサーバーにインストールするのでしょうか？そもそもNTFSにインストールって…？ それとも端末のSQLserver2008があれば、データ保存先でサーバーを選択して、他のPCから同じデータを操作できるものなのでしょうか？ 書籍も読みましたがこの辺がよくわからず（というか基本的すぎて載ってないんでしょうね）馬鹿に解るよう解説してくださるとありがたいです。
・論理名とコメント構文が分からないので、教えてください ■論理名 ・論理名は、内容を分かりやすくするために付ける日本語表記、と思っているのですが、そういう認識で合っているでしょうか？ ・論理名は、どこに付けるのでしょうか？ テーブル定義書などの設計書にだけ表記するのでしょうか？　それとも、SQLの中で「論理名」を付ける場所は決まっているのでしょうか？ ・MySQLのコメント内に、「論理名」を記述しても良いのでしょうか？ ・「論理名」を付与する場合、一般的に、どこに記述するのか？ SQLの中でも記述するのか？ について、教えてください ■コメント ・「コメント構文」と、「COMMENT オプション」では、何が違うのでしょうか？ ・SQLステートメントの構文解析とは、具体的に何を指すのでしょうか？ ・両者の使い分け(どういう時にどちらを用いるのか等)について、教えてください ▽MySQL :: MySQL 5.1 リファレンスマニュアル :: 8.5 コメント構文 　 http://dev.mysql.com/doc/refman/5.1/ja/comments. … ＞記述されたコメント構文はmysqldサーバによるSQLステートメントの構文解析に適用 ▽MySQL :: MySQL 5.1 リファレンスマニュアル :: 12.1.8 CREATE TABLE 構文 　 http://dev.mysql.com/doc/refman/5.1/ja/create-ta … ＞カラムのコメントは、255文字の長さまでで COMMENT オプションで指定できます。コメントは SHOW CREATE TABLE と SHOW FULL COLUMNS ステートメントによって表示
IN('xxx','sss',～)と複数データを指定するのがIN句の使い方ですが、 SELECT * FROM `tabledate` WHERE ～ ff IN('xxx')　～; というように１つだけ指定でも問題はありますか？
php、mysql、google maps apiを使ったウェブサイトを作成したいと考えています。 php→mysqlの段階まではクリアできていますが、mysql→google mapのプロセスで妻づいているため、このカテゴリで質問させていただきました。 phpを使ってmysqlに緯度経度等の情報を格納し、格納された情報google mapに反映（mysql内の各情報についてmap上にマーカーを付ける）させた上で、サイト上に表示させることは可能でしょうか？ phpからmysqlへ情報を格納するところまでは実際に作ってみてできたのですが、mysqlの情報が付加されたgoogle mapをサイトに表示させるところがどうしてもわかりません。 ヒントになるようなサイト等ありましたら教えていただけないでしょうか？
SQL Server2005 で開発しています。 Order by で並び替えてレコードをSelectする際に、 Order by の対象列データが同じ場合は、 どういった順番でレコードが取得できるのでしょうか？ TableA No　| Data1 | Data2 　　1| AAA | 100 　　2| AAA | 200 　　3| AAA | 300 　　4| ABC | 400 　　5| BBB | 500 (Noはクラスタ化PK) 例えば、上のようなテーブルから次のSQLを実行すると 　(1)Select * From TableA ; 　(2)Select * From TableA Order by Data1 Asc; 　(3)Select * From TableA Order by Data1 Asc, No Asc; 　(1)(2)(3)全て、次の順で返ってきました。 　　1| AAA | 100 　　2| AAA | 200 　　3| AAA | 300 　　4| ABC | 400 　　5| BBB | 500 　しかし、(2)のSQLは、データによって 　次の順で返ってくることがありました。 　　3| AAA | 300 　　1| AAA | 100 　　2| AAA | 200 　　4| ABC | 400 　　5| BBB | 500 　 　1～3レコード目までは全てData1がAAAのレコードですが 　特に指定していなくても、No（PK）の順になるのかと思っていました。 　 　なお、レコードができた（Insert順）でもなさそうです。 　この、順番は何で決まっているのでしょうか？ 　
centos5.8 + Oracle10gの環境で、netcaを使おうとすると、日本語が化け（？）ます。 不思議なのが、タイトル部分は、日本語が表示されていて、それ以外の部分の日本語は表示されていません。 http://blog.goo.ne.jp/nokonoko2006/e/2ad87e85fd6 … 上のサイトを参考に、font.properties.jaファイルを修正しましたが、症状は変わりませんでした。 javaの問題のような気もしていますが、どうすれば日本語が表示されるようになるか教えてください。 よろしくお願いします。
mysqlのMyISAM型でこういったデータの取得は適切なやり方でしょうか。 ・件数は700前後 ・インデックスは主キー以外に使っていません ・トランザクションや外部キーも使っていません SELECT * FROM tabledate WHERE 100<a AND 200>a AND 300<b AND 1000>b AND c='てすと' AND d='テテテ' AND e='testtest' AND f='ttt' AND g IN('123','456','789','122','333','4566','888') AND h IN('666','777') AND ・・・ANDが１０個続く・・・ ORDER BY year_manth_day DESC コマンドプロンプトで実行すると結果は0.12secでした。 自分のパソコンの中だけで動かしているのですが、 この実行時間は充分でしょうか。
A5:SQL Mk-2 でレンサバMySQLへ接続したい ■最終的にやりたいこと ・レンタルサーバMySQLのER図を、今あるDBデータより作成したい ■使う予定のツール ・A5:SQL Mk-2 ・poderosa(別に何でも良いのですが、これしか使ったことがないので) ■環境 ・ローカル … Win7 ・レンタルサーバ … Linux ・SSH接続 … 可 ■分からないこと ・「A5:SQL Mk-2」でレンタルサーバのMySQLへ接続出来るのでしょうか？ ・「SSHトンネル」とは何のことですか？ 「SSH接続」したら、「SSHトンネル」が出来たことになるのでしょうか？ ▽A5:SQL Mk-2 から SSHトンネルを利用して MySQL へ接続する 　 http://www.wind.sannet.ne.jp/m_matsu/developer/a … ・「SSH接続」「SSHトンネル」「SSH ポートフォワーディング」は、何が違うのでしょうか？　「SSH接続」出来る環境にあるからと言って「SSH ポートフォワーディング」出来るとは限らないのでしょうか？ ▽Poderosa を用いた SSH ポートフォワーディング 　 http://www.kuins.kyoto-u.ac.jp/news/50/poderosa. … ・このページの中で名前がなかったのですが、Poderosaでは、sshトンネルは出来ないのでしょうか？ ・また、仮にPoderosa以外を選択する場合、下記ページに掲載されているツールなら、基本的にどれを利用してもsshトンネル出来る、ということなのでしょうか？ ▽そーだいなるらくがき帳: ssh経由でデータベースに繋ぐ方法 　 http://soudai1025.blogspot.jp/2012/07/ssh.html
SQL server 2005を使っています。 誤ってDrop table ～～を使って必要なテーブルを削除してしまいました。 まだデータの圧縮とかはしていないのですが、 一旦削除したテーブルを元に戻すことは可能でしょうか？
microSDにデータうつそうとしたら「microSD異常・初期化されてません」てでてデータ開けなくなりました。 データ復旧するにはどこにいけばいいですか？ 出来れば具体的にお店紹介してくれると嬉しいです(´・ω・｀)
Access2000とExcel2000で構成しています。 Accessのフォームに日付を入力してもらい、クエリーで拾って表示しようとしたら、うまく拾えませんでした。そこで、クエリーの項目に「日付: "" & [Forms]![F_登録]![日付] & ""」と設定をしたら、うまくクエリーの結果に反映しました。 この結果を、Excelのピポットテーブルで集計しようとしたのですが、 [Microsoft][ODBC Microsoft Access Driver] パラメータが少なすぎます。1 を指定してください。 というエラーが出てピポットテーブルが更新できませんでした。 Accessの項目を「日付:date()」に変更すると、Excelのピポットテーブルは更新できます。 フォームから日付を引っ張ることにより、なぜピポットテーブルが更新できないのでしょうか？ 何か解決策をご存知の方、ぜひ回答をお願い致します。
ID　カラム １　データ ２　データ ３　データ 上記のID２削除して、下記のような順番にするにはどのようにすればよろしいでしょうか？ ID　カラム １　データ ２　データ
自分のウェブサイトに検索フォームを設置したいです。 Mysqlとphpを利用して作ると言うことは解ったのですが、 Mysqlを利用しなくても、外部csvファイルなどをサーバーにアップし、 それを読み込んで一致条件から検索結果を出力することも可能 なのかなと思います。 お伺いしたいのですが、わざわざmysqlを利用するメリットって なんなのでしょうか。 ちなみに作りたい検索フォームは、テキスト＋チェックボックスで、条件の and/orも付けてやる予定です。 CSSやphpを利用した問い合わせフォームなど基本的な事が一通り出来るレベルです 宜しくお願いいたします。
ACCESSを使ってデータを配列化させたいのです。 ・・・ですがわざわざ配列にする方も少ないらしくどのようにすればいいのか・・・といった状態です。 画像のようにAテ－ブルでは、一列目、二列目に同じデータがあるものをgroup byした上で、違うデータを配列化させたいと思っています。 このような形式に表示を変えることはできるのでしょうか？
ACCESSデータベースをSQLサーバーへアップサイジングに挑戦しています。 csvファイルの取り込みについて質問させてください。 Accessでは、 DoCmd.TransferText acImportDelim, "○○インポート定義", "○○データ読込", filepath として、インポートしていました。 アップサイズ後、同じようにインポート定義を設定しようと思ったのですが、 ウイザードで設定できないのです。（ 設定ボタンがグレーアウトしている。） それで、インポート定義なしでやってみたところ、 文字列フィールドで"00001"の表記が、すべて0が消えて"1"になってしまいます。 インポート後のテーブルのデータ型も、nvarcherになっているのですが・・ 正しいデータ型でインポートするにはどうすればよいでしょうか？ よろしくお願いいたします。
PostgreSQLによるデータベースを運用しています。 メンテナンス処理で、Vacuum処理は毎日バックアップ取得時に行っていますが、 ReIndex処理は1週間に1度程度行っています。 ReIndex処理も毎日行ったほうがよいのでしょうか。 よろしくご教授ください。
テーブル名：HOGE ID　　DATE1　　　　　DATE2　　　　　FLG ------------------------------------------------------------ 001 　2012-07-01 　2012-07-15　　0 002 　2012-07-10 　2012-07-20　　0 003 　2012-07-01 　2012-08-01　　0 004 　2012-07-05 　2012-07-19　　1 005 　2012-07-20 　2012-07-31　　0 006 　2012-07-07 　2012-07-15　　0 で、本日の日付(2012年7月9日)がDATE1～DATE2に入る、かつFLGが0のレコードだけ抽出したいです。 上記の場合、 ID 001 003 006 この様に抽出したいのですが、宜しくお願い致します。
エクセルをアクセスのテーブルに自動変換する方法
WordPress上で、例えば自作のCDコレクションのデータベースの検索はできますか？
SELECTで複数テーブルから、全カラム値を取得する際、同名カラムがあったとき、指定テーブルの値を取得したいのですが、どうすれば良いでしょうか？ ◆前提 ・テーブル「r1」 ・テーブル「t1」 ・テーブル「u1」 ※「r1」「u1」には、同名カラム「z2」あり ◆やりたいこと ・条件一致する全てのデータを取得したい ・但し、「z2」カラムの値は、「r1」テーブルの値を取得したい ◆現状 $sql="SELECT * FROM (`r1`) JOIN `t1` JOIN `u1` ON `r1`.`tid` = `t1`.`tid` And`r1`.`uid` = `u1`.`uid`"; ◆疑問 3つのテーブルから条件一致するデータを全て取得しているのですが、 「r1テーブル」「u1テーブル」に同じカラム名(z2)があるためか、 取得結果のz2内容が、「u1テーブル」の「z2カラム」値となっています(多分…)。 この時、「r1テーブル」の「z2カラム」を取得するには、どうすれば良いでしょうか？ (「r1テーブル」の「z2カラム」だけを単独で取得したいわけではなく、「SELECT * 」結果した際の「z2カラム」の値を「r1テーブル」のものにしたいです)
業務システムから抜き出したaaaa.mdfとaaaa.ldfファイルがあり、これをSQL Server2008R2 Expressをインストールしたパソコンで開くことをトライしています。 しかし、SQL Server Management Studioを起動してテーブルにアタッチしても、「aaaa.mdfはプライマリーデータベースファイルではありません」のエラーが出てしまいます。 必要なのはaaaa.mdf内のテーブルにアクセスできれば良いだけなのですが、どの様にすれば良いのでしょうか。
mongo DBの学習を始めたのですが、コレクションの内容をGUIで表示してくれるツールなどはあるのでしょうか？ あるならば、おすすめのものを教えてもらえると助かります。
お世話になります。 Oracle初心者です。 別のスキーマのテーブルをアップデートすべく、 PLSQL（プロシージャ）作成したのですが、 コンパイルすると、ORA01031：権限が不足しています。 と出てしまいます。 どなたかご教示下さいます様、 宜しくお願い致します。
検索サイトなどでカタカナで[スーパーカー]と入力し検索すると、英語表記の[Super Car]が検索結果の一部に表示されます。これDBで実現するにはどうすればよいのでしょうか?
FileMakePro7をMacOSX10.6で使用しています テキストフィールドに　コピー＆ペーストをして際 コピー元のフォントによってペースト文章のフォントがバラバラになってしまいます。固定する事は加納でしょうか？ Osaka 10Ptで統一をしたいと考えています。 私が試したのは 書式→文字　でOsaka 10Pt 書式→フィールド選択時の動作でも試しました それでも　ペースト文章のフォントがバラバラになってしまいます。 アドバイスよろしくお願いいたします。
テキストを参考にMySQL5.5の勉強をしているのですが、 テキスト通りに操作してテーブルを作ろうとしたところで次のエラーが出てしまいます。 「ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 12」 操作の手順は全てテキスト通りで、MySQLターミナルに 「CREATE DATABASE aliendatabase;」 と入力してデータベースを作り、 「USE aliendatabase;」 でデータベースを選択したまではいいんですが、 「CREATE TABLE aliens_abduction ( last_name VARCHAR(30), first_name VARCHAR(30), when_it_happened VARCHAR(30), how_long VARCHAR(30), how_many VARCHAR(30), alien_description VARCHAR(100), what_they_did VARCHAR(100), fang_spotted VARCHAR(10), other VARCHAR(100), email VARCHAR(50), );」 でテーブルを作ろうとしたところで先ほどのエラーが出ます。 原因は何なんでしょうか？ このテキストはMySQL5.5が出る前の2010年3月に出版されたものなのですが、 それが原因でしょうか？ また、2010年3月に出版されたテキストでMySQL5.5を学ぶのは難しいでしょうか？
こんにちは group_concatを複数列に設定すると、グルーピングした結果が1行に繰り返し表示されてしまいます。 どのように解決すればよろしいのでしょうか？ 例)カラムCOL1が主キーのテーブル MAIN_TABLE ----------- COL1| AAAA| SUB_TABLE1 ----------- COL1|VALUE AAAA|111111 AAAA|222222 SUB_TABLE2 ----------- COL1|VALUE AAAA|xxxxxxx AAAA|yyyyyy 上記のテーブルを下記のSQLで連結 SELECT M..COL1 ,group_concat(S1.VALUE,'/') AS GS1 ,group_concat(S2.VALUE,'/') AS GS2 FROM MAIN_TABLE AS M LEFT OUTER JOIN SUB_TABLE1 AS S1 ON M.COL1=S1.COL1 LEFT OUTER JOIN SUB_TABLE2 AS S2 ON M.COL1=S2.COL1 GROUP BY M.COL1 抽出結果が COL1|GS1 | GS2 ------------------------------------------------------------- AAAA|111111/222222/111111/222222|xxxxxxx/yyyyyy/xxxxxxx/yyyyyy と表示されてしまいます。カラムGS1とCS2に表示されているグループの繰り返しを削除し、 抽出結果を COL1|GS1 | GS2 --------------------------------- AAAA|111111/222222|xxxxxxx/yyyyyy にするにはどうすればよいのでしょうか？
AというDBのAAテーブルをBというDBのBBテーブルとしてリンクしています。 B側では単にリストで見る程度でレコードを更新、追加、削除はしません。 クエリで絞り込んで集計程度はします。 このような使い方において、B側のDBを開いたままで A側で更新や追加等を行うと排他制御とかでひっかかったりしますか？ よろしくお願いします。
userテーブルを追加(AUTOINCREMENT)していき、IDが1～10までできたとします。 その後5人削除して、再度1人を追加するとIDが11から追加されると思います。 空いた番号5～10を利用するのは適切でしょうか？ また、利用するにはどのようにしたらAUTOINCREMENTされますでしょうか？ ※ID番号を隙間なく、埋めていきたい（利用したい）と考えております。
MySQLを利用出来るレンタルサーバ借りる検討をしています。 機能を確認すると、MySQLの設置可能数にコースで制限があります。 希望としては、WordPress、Movable Type Open Source、EC-CUBE 等設置して動作確認等色々学びたいと思っています。 上記場合、MySQLを3個設置する必要があるのでしょうか。 もしくは、MySQLの設置は１個でも、テーブルを分ける事で、複数サービスを動かす事が出来るのでしょうか。 イメージが出来ない為、アドバイスを頂ければと思います。
SqlServerの「インポートおよびエクスポート」ウィザードで エクセルのデータをインポートする時に起こりました。 nvarchar(8) のフィールドに Double型のデータのインポートはうまくいきました。 nvarchar(8) のフィールドに VarChar型のデータのインポートはうまくいきました。 ですが、VarChar型とDouble型が混在しているとタイトルにあるエラーが起こりました。 エクセルで数値データが入っているとインポートウィザードでは勝手にDoubleにするらしく 回避する方法がわかりません。 どうすればいいでしょうか？
mysqlの5.0.51aを使っています。 Ａテーブル（MyIsam型） １フィールド、２フィールド、３フィールド、４フィールド、５フィールド Ｂテーブル（MyIsam型） ６フィールド、７フィールド、８フィールド、９フィールド、１０フィールド ↓↓↓↓↓↓ Ａテーブルの２フィールドと４フィールドをＢテーブルに移動し、 Ｂテーブルの１０フィールドをＡテーブルに移動する。 ↓↓↓↓↓↓ Ａテーブル １フィールド、３フィールド、５フィールド、１０フィールド Ｂテーブル ６フィールド、４フィールド、７フィールド、８フィールド、９フィールド、２フィールド このように他のテーブルにフィールドを移動する方法はありませんか？
素人質問で申し訳ありません。 複数条件で、視認性を上げるためにINを使ったりしますが INはOR検索ですよね、このような感じのAND条件を書く方法はないでしょうか？ field=1 AND field=2 AND field=3 ↓ ○○ (1,2,3) のように書きたいのです。 お願いします。
知り合いの事務所に頼まれ、不具合を見ることになりました。 現象としては、 　AccessADPファイルにてSQLServerにアクセスしていたのが、 　6/29（土）朝から、特定のPCのみ急にアクセスできなくなった。 というものです。以下に詳細を記します。 -------　動作PCの詳細 ------------ ・稼働PC5台（内、WinXP SP3（homeとPro混在)が4台、Win7が1台）の共通設定 　 　同じワークグループに設定。それぞれのPCに同じユーザーアカウントとパスワード設定 　IPアドレスはルーターのDHCP機能で自動割り当て 　すべてウィルスバスタービジネスセキュリティーがインストール済み ・SQLServer2005 Express が稼働しているPC 　Win XP SP3 Pro(32bit) 　「簡易ファイルの共有」機能はOFF 　共有ファイルは共有の有効化、アクセス許可、セキュリティー許可をそれぞれ登録 　 SQLServer は　Windows認証方式 　TCP/IPおよび名前付きパイプを使用する構成。 ネットワークアクセス許可 　（TCP/IPは1433固定）SQL Browserも自動起動設定。 WindowsのファイヤーウォールにSQLSrver、TCP1433　UDP1434　例外登録　 　SQLServer ManagementStudio Expressで 　ログインユーザーとデータベースアクセス許可を、ビルトイングループ単位で与えてある Hostsファイルの値は 「127.0.0.1」 ・問題のPC Win7 SP1 Pro(64bit) Office 2010Pro(32bit版をインストール） ワークグループ設定。ホームワークの設定はせず、社内ネットワークプロファイルで構成 　共有の有効化。 Hostsファイルの値が　 　　＃ 127.0.0.1 になっていたので、＃を取り除き上書き保存。 ---------------------　 調べてみたところ、問題のPC以外からは問題なくつながり、読み込み書き込み共にOKでした。 Administoratorでなくても、User権限の人でも問題なくつながります。 しかし、Win７マシンからだけなぜか急につながらなくなったとの事です。　 特定のユーザーではなく、特定のPCだけの現象です。ユーザーを変えてみても、 問題のPCからだけ、なぜかつながりません。 ADPファイルを新規作成し、サーバーに接続する段階ではサーバー名が出るものの、 　「信頼関係が…」うんぬん言われてつながりませんでした。 各PCのファイヤーウォールやWindowsDefenderをOFFにしてもダメでした。 そこで管理ツールのODBCでやってみたところ、次のようなメッセージが出ました。 　（ODBCは32bit版、64bit版共に試しました。） ---------------------------------------------- 接続できませんでした。 ; SQLState: '28000' SQL Server エラー: 18452 [Microsoft][ODBC SQL Server Driver][SQL Server]ユーザー '' は ログインできませんでした。このユーザーは SQL Srver の信頼関係 接続と関連付けられていません。 ----------------------------------------------- 不思議なのは、表示のユーザーのところが ''　になっている事です。 通常ここのところには 'マシン名\ユーザー名'　のような形で表示されると思うのですが…。 また、違うユーザーで同じ事をしてみたところ、今度は、ユーザー名のところに 意味不明な数字の羅列が表示されていました。 　（あとから思えば、SIDを表示してたのかもしれません。） そこで、そもそもファイルの共有事自体は出来るのか、試してみました。 結果、こちらにも問題がありました。 他のPCから問題のPCの共有フォルダへのアクセスはOKなのですが、 問題のPCから他のPCの共有フォルダを開こうとすると、 　「ユーザー名」「パスワード」 を聞いてくるダイアログが表示され、入力しても入れないPCがありました。 因みに、入れないPCの「簡易ファイルの共有」をONにすると問題なく入れますが、 これは単にGuest扱いを受けているだけだと思います。 　　　 以上からの推測ですが、SQLServerの稼働しているPCが問題のPCを正しく評価できない為に、 ユーザーが'(null)'のような形になっているのではないかとおもいました。 それで、ユーザー認証周りを見直し、グル―プだけでなく、ユーザー単位でもアクセス許可を設定 したり、新たにユーザーを作成したりして見たのですが、やはり問題のPCのみつながりません。 ファイルの共有に関しても、新たに共有設定をしてみたのですが、やはり問題のPCのみつながりません。 SQLServerの問題というよりも、PC自体の問題のように見えます。 正直なところ、Windows7はあまり使ったことがない為、行き詰まってしまいました。 素人考えでは、問題のマシン名とユーザー名が正しく正しく伝わっていない事が原因だと思うのです。 そもそも、なぜそのような事態になったのかがわからず、困っています。 「昨日までは問題なく使えていた」との事で、思い当たる節がありません。 担当していた人が退職された為、代わりに見ているのですが、 正直再インストールの方が早いのではとすら思ってしまいます。 ほかに何か見落としているところがないでしょうか。 また、対処法のヒントとなる事がありましたら教えて頂きたいと思います。 よろしくお願いします。
間違えて削除してしまったので再投稿します。 このたび、SQLServer2005SP2でレプリケーションを実装しようと思っています。 構成はこのように考えています。 Server１（プライマリサーバ）：パブリッシャ SQLServer2005 SP2 Server２（セカンダリサーバ）：ディストリビュータ＆サブスクライバ 間違えて削除してしまったので再度投稿します。 SQLServer2005 SP2 Server1とServer２のＤＢ、TABLE構成は同じです。 設定方法についていろいろ調べているのですが、どうもこれでよいかと確信がもてません。 どなたか設定方法をご教授お願い致します。 今回の構成に近い設定方法が載ったページなどがあれば合わせて教えてください。 また、Server1は更新用アプリが使用、Server２は参照用アプリが使用などといったことはできるのでしょうか？
MySQL初心者です。 ぐぐって見たのですが、良く分からなかったので質問します。 フィールドが最大5桁の数字で構成された社員IDナンバーの場合、データ型は int（5）、varchar(5)、char(5)、numeric(5) のどれになるのでしょうか？numericで試したところ、テーブルを作成すると社員IDのデータ型がdecimal(5,0)になったので、おそらくそれは無いと思うのですが。 回答、お願いします。
以下の条件 カラム「C1」が主キーのテーブルがAとB↓ テーブルA C1| --- AA| テーブルB C1|C2| -----| AA|11| AA|22| AA|33| とあった場合に、抽出結果を C1|C2 | ---------| AA|112233| にするためにはどのようなSQLを組めばいいのでしょうか？
アクセス2002 クエリにて下記２つの抽出方法を教えて下さい。 【抽出条件1】 出生時～小学校就学前（6歳に達した最初の3月31日まで） 【抽出条件2】 小学生～中学生 (4月1日時点で6歳以上) (15歳に達した最初の3月31日まで) [Q_顧客]というクエリを作っています。 5つのフィールドがあります。 氏名・年号・生年・月・日 氏名・年号はテキスト型 生年・月・日は数値型 氏名　年号　生年　月　日 花子　昭和　46　1　15 太郎　平成　15　3　13 春子　平成　17　1　11 次郎　平成　14　6　23 夏子　平成　18　4　29 秋子　平成　 9　7　12 上記のクエリから、 ・出生時～小学校就学前 ・小学生～中学生 の2つを抽出したいのですが、どのようにしたら良いか教えて下さい。 日付型で作成してなく、年齢の出し方も分かりません。 データ数も多いので、困っています。 よろしくお願い致します。
フィールドがいくつかあるテーブルがあります。 主キーが78532456から始まり、1ずつ増加します。 これを1万行追加したいです。 MYISAMでやっています。 どのようにすれば、重複な値を出さずに追加できますか。
excelにて、第3週の木曜日にA1のセルに"○"を、 そうでない日には"-"にするやり方が分かりません。 考えとして、B1のセルに=TODAY()を入力し、そこから情報を読み取り、 木曜をカウントして3回目になったときに"○"を表示させることは可能でしょうか。 ご教授の程、宜しくお願い致します。
mysql> delimiter $$ mysql> create trigger trigger_update after update on user for each row -> begin -> update address set name = new.name where name = old.name; -> end; -> $$ mysql> delimiter ; こちらをphpmyadminでどのようにしたら使うことができますか。
お世話になってます。 あるサーバー（サーバーA）上のSQLServer7.0で作成したバックアップファイルを 復元先のサーバー（サーバーB）に復元したところ、MDFファイルが3GBに対し、 LDFファイルが100GBありました。 LDFファイルのサイズを圧縮しようと、SQLServer7.0のメニューで、 　 　1. フルバックアップ 　2. トランザクションログの切り捨て 　3. 圧縮 　※以下「1.」、「2.」、「3.」を何度か繰り返し。 を行ってみましたが、300MB程度減っただけで、それ以上は小さくなりませんでした。 　SHRINKDATABASE 　や 　TRUNCATE も試してみましたが、サイズ、変わりませんでした。 他に試すことはありますでしょうか？
データが重複しないSQL文の書き方を教えてください。 下記のような2つのテーブルがあり、「管理番号」でOnして「使用数」をJoinさせ、かつ重複しないようにSQLを作成したいのですが、MySQLで可能でしょうか？ ※0002に関しては、テーブル２の方がデータ数が多いため、Join後は2行になって「使用数」は重複せず、「数」の部分には０が入ればベストです 【テーブル１】 日付　　　　品番　　管理番号　数 2012/6/12A987　0001500 2012/6/14A987　0001300 2012/6/16A987　0001400 2012/6/18A987　0001800 2012/6/12A987　0002750 2012/6/12A987　0003540 2012/6/14A987　0003740 2012/6/16A987　0003840 2012/6/18A987　0003240 2012/6/20A987　0003640 【テーブル２】 日付　　　　品番　　管理番号　使用数 2012/7/10A987　0001160 2012/7/11A987　0001260 2012/7/10A987　0002220 2012/7/12A987　0002320 2012/7/20A987　0003530 2012/7/22A987　0003430 2012/7/24A987　0003830 【テーブルJoin】 日付　　　　品番　　管理番号　数　使用数 2012/6/12A987　0001500160 2012/6/14A987　0001300260 2012/6/16A987　00014000 2012/6/18A987　00018000 2012/6/12A987　0002750220 2012/6/12A987　00020320 2012/6/12A987　0003540530 2012/6/14A987　0003740430 2012/6/16A987　0003840830 2012/6/18A987　00032400 2012/6/20A987　00036400
phpmyadmin 文字化けを開きテーブルを見ると日本語が化けてしまいます。 php のプログラムからは読み書き、表記は正しくできます。 いろいろ調べ以下をやったのですがだめでした。 「MySQLの設定」 # vi /etc/my.cnf [mysqld] datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock user=mysql old_passwords=1 default-character-set = utf8 character-set-server = utf8 collation-server = utf8_general_ci init-connect = SET NAMES utf8 #skip-character-set-client-handshake ※最終的にコメントアウト [mysql] default-character-set = utf8 [mysqldump] default-character-set = utf8 MySQLをリスタートする。 # /etc/rc.d/init.d/mysqld restart 「phpMyadminの設定」 # vi /var/www/phpmyadmin/config.inc.php $cfg['DefaultLang'] = 'utf-8'; $cfg['DefaultConnectionCollation'] = 'utf8_general_ci'; $cfg['FilterLanguages'] = ''; $cfg['DefaultCharset'] = 'utf-8'; $cfg['AllowAnywhereRecoding'] = TRUE; ａｐａｃｈｅ再起動 何か足りない点はありますでしょうか？ 環境は以下です。 phpMyAdmin •バージョン情報: 3.5.1 (最新版) •サーバ: Localhost via UNIX socket •ソフトウェア: MySQL •ソフトウェアバージョン: 5.1.61 - Source distribution •プロトコルバージョン: 10 •ユーザ: root@localhost •サーバの文字セット: UTF-8 Unicode (utf8)
バックアップする方法は何がありますでしょうか？
DELETE tbl1,tbl2,tbl3 FROM tbl1,tbl2,tbl3; DROP TABLE tbl1,tbl2,tbl3 FROM tbl1,tbl2,tbl3; 以外で簡単に複数あるテーブルを削除する方法ってありますでしょうか？
2つの表をunionでマージした結果を副問合せで使用し、この副問合せを他の表とwhereで結合するとORA-00918: 列の定義が未確定です。がでます。こんな感じです。 副問合せそのものは単独で実行してもエラーにならないので結合に問題があるようです。 どなたか回答お願いします。行き詰っています。 select as.xx1,asxx2 from (select *　from aa union select *　from bb) as, af where as.xx1=af.xx1;
首記、InnoDBであれば1000、MyISAMであれば4096という仕様かと思いますが、CREATE TABLEを実行するとカラム数1500くらいから #1117 Too many columns のエラーが出てしまい、カラム数の多いテーブル追加ができない状況です。 こちら、事象や考えられる原因、対処方法などご存じの方がいれば教示いただけますか。 またVARCHARの64K制限があるため多くのカラムはTEXTにしています。
添付画像のようなテーブルがあります。 製品IDと販売店でユニークです。 製品毎に、最安の価格で売っている店を一覧として 出したいのですが、うまくいかず困っています。 表示としては TEST1　100　A店 TEST2　300　C店 というようにしたいのです。 また、もし最安の店舗が複数あれば、登録日が一番新しい店を 最安店舗としたいです。 製品IDでGroupByをして、価格のminで、製品毎の最安はとれるんですが、 最安の店舗が複数ある場合に困っています。 サブクエリで登録日でソートしてTOP1とかになるのでしょうか。 冗長で重いクエリになってしまい、実用に耐えず、困っています。 うまい取り方があったらご教授いただけないでしょうか。 よろしくお願いします。
同一テーブル内のデータを参照してのUPDATEを行いたいです。 データは以下のとおりです。 ID1，ID2，Value １，１，在校生 １，２，10期生 ２，１，在校生 ２，２，11期生 ３，１，在校生 ３，２，12期生 そして、UPDATEしたいデータは ID１が同一で、 ID2が２でValueが「10期生」の場合に ID1が１のValueに「卒業生」と入れたいのです。 この場合に書くべきSQLはどう書けばいいでしょうか？
CENTOS5.6でMYSQL5.5.22を入れて使用しています。 テスト用プログラムを作っていて、MSYQLへのデータ挿入が止まらなかったためMSYQLをリスタートしました。 すると、起動後おそらく接続できないとのメッセージが出ています。 postfixをMysqlで使用して使っているため、メールができなくて困っています。 下記エラーメッセージがmysqlのログにありました。 120626 14:15:57 [Warning] Unknown character set: 'utf8a' 120626 14:15:57 [Warning] Aborted connection 131 to db: 'postfix用のDB名' user: 'postfix用のユーザー名' host: 'localhost' (init_connect command failed) 120626 14:15:57 [Warning] Unknown character set: 'utf8a' 120626 14:15:57 [Warning] Aborted connection 132 to db:'postfix用のDB名' user: 'postfix用のユーザー名' host: 'localhost' (init_connect command failed) 120626 14:15:57 [Warning] Unknown character set: 'utf8a' 120626 14:16:58 [Warning] Aborted connection 133 to db: 'postfix用のDB名' user: 'postfix用のユーザー名' host: 'localhost' (init_connect command failed) 120626 14:16:58 [Warning] Unknown character set: 'utf8a' 120626 14:16:58 [Warning] Aborted connection 134 to db: 'postfix用のDB名' user: 'postfix用のユーザー名' host: 'localhost' (init_connect command failed) 120626 14:16:58 [Warning] Unknown character set: 'utf8a' 120626 14:16:58 [Warning] Aborted connection 135 to db: 'postfix用のDB名' user: 'postfix用のユーザー名' host: 'localhost' (init_connect command failed) 120626 14:16:58 [Warning] Unknown character set: 'utf8a' Aborted connection の部分を色々調べたのですが、情報が少なく解決策がわかりませんでした。 Mysqlの再起動やサーバー自体の再起動を行ったのですが解決できませんでした。 何かヒントになるような事がありましたら、教えていただけないでしょうか？ 宜しくお願いします。
http://hoge.jp/data.php?id=7203をクーロンで叩くと、 その時間の株価情報を拾ってきて、WEB上に「7203,トヨタ,3080」 と表示される仕組みを作りました。(株価番号,社名,株価) この結果をmySQLのテーブルに継続的にインサートすることを考えました。 私が考えた方法は下記の通りなのですが、<?php ?> の中に<?php ?>が 含まれる形になるためか下記の方法ではインサートできません。 どのようにすればインサート出来るかご教授頂けませんでしょうか? 尚、「7203」「トヨタ」「3080」を別々に取得することはできず 「7203,トヨタ,3080」のようにまとまった形でしか取得できません。 宜しくお願い致します。 <?php $con = mysql_connect("localhost","root","password"); if (!$con) { die('Could not connect: ' . mysql_error()); } mysql_select_db("db", $con); mysql_query(" INSERT INTO table (id,company,stock_price) values (<?php echo file_get_contents('http://hoge.jp/data.php?id=7203'); ?>) "); $close_flag = mysql_close($con); ?>
MySQLで複数のデータベースを稼働していますが、サーバーの物理メモリ量が不足しているため現在使用していないデータベースをオフラインにしたいと思います。 削除はしたくないので SQL Server でいうところの「デタッチ」をしたいのですが、方法をご存じの方がいらっしゃいましたら教えて頂けないでしょうか？ 宜しくお願い致します。
PHPからmysqlのテーブルを開こうとした際に Fatal error: Call to undefined function mysql_connect() という一文が出ました。 php.iniのextension_dirのパスは一字一句間違っておりませんし、 extension=mysql.so extension=mysqli.so の二文も追加しました。また、その二つのファイルがあることも確認済みです。 また、phpファイルの構文は以下のとおりになっています。 $link = mysql_connect('ローカルホスト', 'ユーザー名', 'パスワード'); if (!$link) { die('接続失敗です。'.mysql_error()); } print('<p>接続に成功しました。</p>'); こちらもいろいろ調べまして、php_mysql.soとphp_mysql.soがないためではないかなどとかんぐっておりますが、そういった記述は私が調べた限りにおいては見かけませんでした。 php_mysql.soとphp_mysql.soというファイルはなくても、mysql.soとmysqli.soというファイルがあれば動くのでしょうか？ 仮にphp_mysql.soとphp_mysql.soというファイルがないと動かない場合、何をインストールすればよいのでしょうか？ ご回答よろしくお願いします。 また、PHPとMySQLはソースファイルを/usr/ports/distfilesディレクトリにコピーした上でポートからmake、make　installしました。 マシンスペック OS…FreeBSD6.4 Apache…1.3.14 PHP…5.2.8 MySQL…5.0.92 都合上、バージョンを他のものに変更することはできません。 追記してくれということがありましたらよろしくお願いします。
ファイルメーカ7をMacOSX10.6で使用しています 見積もりなどを作ってプリントしてFaxしています。 それをメールにペーストしたいのですが出来ますか？ 印刷でしたらレイアウト通り出来ます メールにペーストする場合レイアウトは崩れても仕方ないと思っていますが ある程度　フィールド順にコピペ出来たらと思います 見積書もりですので　フィールドは繰り返しフィールドが多くなっています よろしくお願いいたします。
FileMakerSever11にアクセスできるバージョンについて 職場でFileMakerSever11にFileMaker Pro10で作成した共有しているファイルがあります。 このファイルにFileMaker Pro7はアクセスできますでしょうか？ 職場が保有しているクライアントのライセンス数に限りがありPro10と11の残数が足りなくなったのですが，新しいのを買うにもPro12に変わったためどうしようか困っています。 以前のPro7や8はライセンス数が残っています。 新機能のグラフィックとは使わず，データ入力・参照のみに使います。 ただし，大量に使うためWeb機能では対応しないため，クライアントのみを考えています。
パスワードを暗号化するにはphp関数などでハッシュ化させてからINSERTするしかないのでしょうか？ MYSQL自体に現在INSERTされている文字列をハッシュ化させる方法はないでしょうか？
テスト用のテーブルを作りたいと思っています。しかし、主キーの部分が実際とはかけ離れた状態になってしまいます。 フィールド数が複数あり、同じ値でも構わないので1万件分のレコードを追加したいです。 やり方としては、 ＜１＞主キーのフィールド以外の全部のフィールドを作ってデータを入れます。 ＜２＞そしてから、INSERT INTO `aaa` SELECT * FROM `aaa`を1万件超えるまで繰り返し実行。 ＜３＞主キーのフィールドをauto_increment指定して追加します。 ＜４＞1万を超えるフィールドを削除するためにDELETE FROM `aaa` WHERE id>10000を実行 ※実際には主キーにauto_incrementを入れません。 ※実際には主キーのデータは数千万～億単位(89234521や000455839)の数字（型はBIGINT）で、増加の仕方はまちまちです。 auto_incrementを使わず、数千万単位の数字で、増加の仕方もまちまちな主キーのデータを追加する方法はないでしょうか。
例えば、あらかじめテーブルなどを読み、その内容により、 SQLの文そのものを非常に変えたいとします。 SQLその１ select * from TABLEA where A = 1 SQLその２ select * from TABLEA where A = 1 and B = 2 and C = 3 and D = 4 上記は例ですが、内容などにより複雑な条件式を追加したい。 ベースのSQLは非常に長い為、 例えば　完全に切り分けるのでは無く、共通の部分は共通ソースとしたい。 また、プリプロセッサみたいに、条件式が追加された場合 あたかも、初めからそのSQLのみがあり、他の制御文などをSQL文自身には追加したくない。 動的SQLでは無い方法でそのような事が可能でしょうか？ -----　イメージ ----- select * from TABLEA where A = 1 IF (条件がある時のみ） B = 2 and C = 3 and D = 4 END IF; ------------------- 実際には、SQL文の中にPLSQLの制御文をうまく追加できない。
WordPressのデータベースでテーブル2つを結合して以下の情報を取得しようとしています メール(wp_users.user_email)|名前(wp_usermeta.meta_value)|登録日時(wp_users.user_registered ) 123@a.com,山田,2012-06-17 12:33:44 456@b.jp,田中,2012-06-21 07:26:54 789@c.ne.jp,\N,2009-08-11 12:19:00 1234@d.ne.jp,\N,2009-08-11 12:19:00 321@x.ne.jp,\N,2009-08-11 12:19:00 ・ユーザーはwp_usersテーブルにeメール情報(user_email)を必ず持ている ・ユーザーの名前はwp_usermetaテーブルのwp_usermeta.meta_keyがuser_nameなレコードに保存されているが、ユーザーによってあるものとないものがある。無い場合はNULLにする。 テーブル構造は添付した画像に記載されています。 ■ユーザ数 mysql> SELECT COUNT(*) FROM wp_users; 18290 まずwp_usersとwp_usermetaをLEFT JOINしてmeta_key = 'user_name'なレコードを取得しようとしましたが、user_nameを持っているユーザーのみしか取得できませんでした。 ■user_nameを持っていないユーザーが取得できない SELECT u.user_email, m.meta_value FROM wp_users AS u LEFT JOIN wp_usermeta AS m ON u.ID = m.user_id WHERE m.meta_key = 'user_name'\G 2075 rows in set (0.00 sec) 次にサブクエリをJOINしました。結果は正しいものを取得できたのですが、実行時間が40秒以上かかってしまい実用性がありません。 ■欲しい結果（速度が遅い） SELECT u.user_email, a.meta_key, a.meta_value, u.user_registered FROM wp_users AS u LEFT JOIN (select * from wp_usermeta where meta_key = 'user_name') as a ON u.ID = a.user_id; 18290 rows in set (45.45 sec) この結果を取得できる、正しいSQLを教えてください。よろしくお願いします。
恐れ入ります。 MySQLで、 perlを使ってfrorm送信してデータを保存する際に、 フォーム上にコードを入力すると、 そのコードに付随したその他情報が、いくつかのフォーム上に現れるようにしたいのですが、方法はありますか？ 04343 を入力 ↓ MySQL上の、04343番に紐づいたデータをその他input フィールドに表示 ↓ 送信 よろしくお願いします。
テーブル名：HOGE ID　　USER --------------- 001 　A 002 　C 003 　A 004 　B 005 　A 006 　C 007　 A 008　 C 009　 D 010　 D で、下記のような結果が出したいです。 A　４ C　３ D　２ B　１ 件数の多い順に並べたいです。 宜しくお願い致します。
ファイルメーカーについてごく初歩的な質問なのですが http://www.filemaker.co.jp/products/compare/ こちらのページを見たところ[共有*]という項目に[最大5ユーザーと共有できる]等との記載があります この「共有」とはどのようなものなのでしょうか 5つまでのPCにインストールできるのでしょうか 5ユーザーまでをデータベースに登録できるのでしょうか また、[最大 250 ユーザーが同時接続できる]の「同時接続」とは何が違うのでしょう ご存じの方おられましたらよろしくお願いいたします
SQL Server 2008 R2のINNER JOINについて質問させて下さい。 ------------------------------ SELECT * FROM [Customer] 　　　INNER JOIN Pref 　　　　　　ON Customer.CustomerPref1 = Pref.PrefId 　　　　　　ON Customer.CustomerPref2 = Pref.PrefId 　　　　　　ON Customer.CustomerPref3 = Pref.PrefId WHERE ([CustomerId] = 123) ------------------------------ 3つもONがあって変なSQL文となっております。 (当然SQLエラーとなります。) やりたい事は、 顧客フォーム[Customer]の中に、都道府県をプルダウン選択する項目が3つあります。 3つとも都道府県マスタテーブルをリレーション(FK)しております。 3つの都道府県項目で「都道府県名」をそれぞれSELECTするには、 どうしたらよいでしょうか? ご教授頂けますようお願い申し上げます。 ------------------ ▼DB情報 顧客情報テーブル：Customer 顧客ID：CustomerId 都道府県カラム1：CustomerPref1(1,2,3,～などの値が格納) 都道府県カラム2：CustomerPref2(1,2,3,～などの値が格納) 都道府県カラム3：CustomerPref3(1,2,3,～などの値が格納) 都道府県マスタテーブル：Pref 都道府県ID：PrefId(1, 2, 3,～などの値が格納) 都道府県名：PrefName(1:北海道, 2:青森県, 3:岩手県～などの値が格納)
先日、お客様のPCにFileMaker Proを入れて、 FileMaker Goと連携させて動かしているのですが、 FileMakerのエラーメッセージが表示された、と連絡をいただきました。 エラーメッセージのキャプチャを添付します。 そのエラーメッセージから、 ライセンスキーは、一度に１台のコンピュータで本ソフトウェアのコピー１部の使用が許諾されるエンドユーザライセンスアグリーメントに従うために使用されます。詳細については、ソフトウェアをインストールしたアプリケーションフォルダにある FileMaker Pro または FileMaker Pro Advanced のソフトウェアライセンスを参照し てください。ライセンスキーが無効、または同一のライセンスキーによりインストールされたアプリケーションがネットワーク上の別のコンピュータで実行されている場合、FileMaker Pro アプリケーションによって、次のエラーメッセージが表示されます。 「現在、最大 登録者数でこの FileMaker Pro を使用しています。」 このエラーメッセージが表示された場合、入力されたライセンスキーがすでに使用されていることを示しています。 複数のコンピュータに FileMaker Pro をインストールするには、各ユーザに個別のライセンスキーを使用するか、ボリュームライセンスアグリーメントに基づいてライセンスを取得する必要があります。ユーザ１人に対してFileMaker Pro を１部ずつ購入する必要があります。 という文章をネットで見つけはしたのですが、 お客様のPCでは、その一台しかFileMaker Proをインストールしていません。 原因、対策等、分かる方がいらっしゃいましたら、ご教授ください。 なお、添付ファイルの隠されている文章部分には、 お客様のPC名が入っています。 お客様環境：Win7 64bit FileMaker Pro12 FileMaker Go 12 for iPad　です。
ORACLE MASTER BronzeおよびSilverの資格取得を検討しております 先ずはBronzeからと私なりに色々と調べてみましたが、確認も含めご質問させていただきます (1)Bronzeの認定資格を得るにあたり、認定パスが必要かと思いますが、 　 　A：【11g SQL基礎I [1Z0-051]】or【Bronze SQL基礎I [1Z0-017]】 　　と 　B：【Bronze DBA11g[1Z0-018]】 　の試験合格を経て認定資格が得られるのでしょうか？ 　もしくはAのどちらかを合格することで認定資格を得て、Bを受けられるということでしょうか？ (2)【11g SQL基礎～…】と【Bronze SQL基礎～…】に違いや差はありますか？ 　それぞれの良し悪しやどちらがオススメなどあれば教えてください (3)10gや11gとありますが、これはVerのようなものですか？ 　現状受けるのであれば11gでいいですか？ (4)企業によると思いますが、転職で実務経験のない者でも当資格は評価されますか？ 　また、その際階級として最低でもSilver以上は必要ですか？ (5)黒本で独学、Mysqlは少しかじった程度の知識です 　オススメの書籍があれば教えてください 初歩的な質問もございますが、 お詳しい方、是非ともご教授願います よろしくお願いいたします
phpMyAdminにてテーブルが見えません。 SQLファイルをインポートしたのですが、テーブルが見えません。 コマンドライン上から show tables とやると見えます。 なぜでしょうか？？ お詳しい方、ご教授願えませんか？
何か方法があれば教えて頂きたのです。 ＳＱＬで一致したデータの項目同同士を繋げることができるかどうか。 具体的には以下のような。 ＩＤ　　　名前 ------------ A1 SQL A1 My A2 Server のような結果が出るようなＳＱＬ文を作ったとして ＩＤ　　　名前 ------------ A1 SQL,My A2 Server みたいな同じＩＤの名前を例のようなカンマとかスラッシュ 等を間に入れてつなげていくなんてことできますか？ 実際にはＳＱＬ文で出たデータを各配列にそれぞれデータに入れて使う のでＳＱＬ文の中で仮に出来なくても結果に対してそのようにつなげることが可能かどうか。
MovableTypeをSQLiteで運営していましたが、投稿総数が3000以上となり、SQLITEの容量が160MBになってしまい、動画が不安定かつ、遅い、削除できないデータがある、再構築がもはや不可能という状態に陥ってしまいました。スパムコメントやログの削除、いらないデータの削除などがんばりましたが、調べてみるとSQLITEはVACUUMすると容量が減るとありました。 早速、VACUUMできるツールTkSQLiteでVACUUMを試みましたが、容量が大きすぎるのか、何度やってもエラーが帰ってきてスリム化できません。大事なサイトなのでなんとかしたいのですが、この肥大化しすぎたSQLITEのデータをスリム化する方法は他にありませんでしょうか？
MySQLでインポートするときに次のようなエラーが出ました。 　MySQLのメッセージ: 　#1449 - The user specified as a definer ('XXXX'@'%') does not exist 　（XXXXはデータベース名です） sqlファイルをアップロードしてインポートする形をとっています。 エラーの意味や、どうやったら解決できるか、ご存じの方いましたら ご教授願えますでしょうか？ よろしくお願いいたします。
すみません、オラクルに接続しようとすると、 「ＯＲＡ－０１０３３：Ｏｒａｃｌｅの初期化またはシャットダウン中です」とメッセージが表示され、 接続できません。 そこでｓｙｓｄｂａで接続し、shutdownを行った後にstartupを行うと、 「ORA-12514: TNS: リスナーは接続記述子でリクエストされたサービスを現在認識していま せん」とメッセージが表示され、復旧できない状態です。 どのようにすれば復旧・接続できるようになるのでしょうか？ ちなみにオラクルはoracle11gです。
| Field　　| Type | Null | Key | Default | Extra | +-----------------+--------------+------+-----+---------+----------------+ | page_id　| int(10) | NO | PRI | NULL | auto_increment | | site　　　| varchar(255) | YES | MUL | NULL | | ... ... ... このようなテーブルがあり、以下の様なSELECT文を発行してもEmptyとなってしまいます。 > SELECT `page_id` FROM `table` WHERE `site` = 'hoge'; 自分なりに色々と調べてみたところ、 > UPDATE `table` SET `site` = 'fuga' WHERE `page_id` = 1; > SELECT `page_id` FROM `table` WHERE `site` = 'fuga'; とするとちゃんと1件返ってきます。 ですが、また > UPDATE `table` SET `site` = 'hoge' WHERE `page_id` = 1; > SELECT `page_id` FROM `table` WHERE `site` = 'hoge'; とするとEmptyとなってしまいます。 どうやら、INSERTしたレコードをWHERE `site` = 'hoge'するとEmptyとなるような気がします。 何度も試したので、単純に`site` = 'hoge'の文字列自体が間違っている、などのことは無いはずです。 以下の点も合わせて、どのような原因が考えられるでしょうか。 ・レコードのINSERTは、クローラーによって行われていています。 ・他のフィールドは通常通りSELECTすることができます。 ・ストレージエンジンはmroongaです。 どなたか解決策がわかる方いらっしゃいましたら、ご回答頂ければ幸いです。 宜しくお願い致します。
あるカラムに以下のデータが入っています。 { "AAA" : [ { "id" : 1, "age" : 100, }, ], "BBB" : { "id" : 2, "age" : 200, } } ＢＢＢのageを値を取り出すにはどうすればよろしいでしょうか？
$device = 'a'; $Field = $device.'_type'; $sql = 'select "'.$Field.'" from table where member_id = "'.$id.'"'; $res = mysql_query($sql); $row = mysql_fetch_assoc($res); if ($row){ echo $row[$Field]; } $row[$Field]をechoで表示すると『a_type』と表示され、中身が表示されません。 フィールド名を変数ではなくa_typeと直接入力すると正常な結果が表示されます。 ちなみにtableにはa_type、b_type、c_typeテーブルが存在します。 ドコモからのアクセスはa_type、auからはb_typeと、ユーザーエージェントによって分けています。 フィールド名を変数で指定して値を取得するには、どのようにすればよいでしょうか？ 宜しくお願いいたします。
列１、列２ ２、name 　１、name インサート後に上記のようになっています。 列１を１、２の順番に自動にする方法はなにかありますでしょうか？
いつもお世話になっております。 Oracleの「'（シングルクォーテーション）」の使い方について教えてください。 テーブルAのフィールド００１には2桁の数値が文字列型として格納されています。 (1)SELECT　COUNT(*) FROM テーブルA WHERE フィールド００１ = '09' でデータの抽出をしているのですが、データがあるにも係らず、「０」となってしまいます。 (2)SELECT　COUNT(*) FROM テーブルA WHERE フィールド００１ = 09 では、「09」だけでなく「9」までカウントしてしまいます。 データの中には「09」「9」が混在していて、これらを別々にカウントしたいのですが、(1)では結果を得ることが出来ません。シングルクォーテーションの使い方に間違いがあるのでしょうか？ 別々にカウントする方法があればご教授いただけないでしょうか？ よろしくお願いします。
皆様にはいつもお世話になっており、誠に感謝しております。 一発で結果が分かるSQL文があれば、ご享受願いたいのです。 下記の様なテーブルがあります。 F_No　F_Kaisu　F_Memo 001　　1　　　　メモ 001　　2 001　　2　　　　ああ 001　　4　　　　いい 001　　4　　　　 002　　1　　　　かか 002　　2　　　　きき 002　　3　　　　くく 003　　1　　　　AA 003　　2 003　　2　　　　BB 003　　3　　　　CC F_Memoに値が入っているレコードが対象であり、 F_Kaisuが数字の順番になっていないF_Noを抜き出したいのです。 上記で云えば、 F_Noの001は、 F_No　F_Kaisu　F_Memo 001　　1　　　　メモ 001　　2　　　　ああ 001　　4　　　　いい であり、F_Kaisuが数字の順番にはなっていないので、 001をヒット！ F_Noの002は、 F_No　F_Kaisu　F_Memo 002　　1　　　　かか 002　　2　　　　きき 002　　3　　　　くく であり、F_Kaisuが順番なので、 002はスルー！ F_Noの003は、 F_No　F_Kaisu　F_Memo 003　　1　　　　AA 003　　2　　　　BB 003　　3CC であり、F_Kaisuが順番なので、 003はスルー！ 結果、F_Noの001を取得したいのです。 SQL一発で実行する事は可能でしょうか？ もし可能ならば、SQL文のご享受をどうぞ宜しくお願い申し上げます。
Access　VBA　でのrecordseｔ　はDAOとADOがあります。 DAOの場合recordsetからrecordsetを作成できました。 つまり、日本からある県を選び出し、その中から10代の人を選び出せました。 ところが、ADOの場合それができません。ある県の１０代の人を選び出そうとしても、 結果的に全日本の10代の人となってしまいます。 例として RD1.Filter = "購入日># " & DateAdd("yyyy", -1, Date) & "#" Set RD2 = RD1.OpenRecordset この「RD2」という新しいrecordsetができます。 RD2は購入日が今日から1年前の１つのファイルとしてsetされます。 この中から山田さんの売り上げを集計することができます。 ところが、ADOの場合下記のように書いて、 str = RS!ブランド RS.Filter = ("ブランド = " & "'" & str & "'") RS.MoveFirst str = RS!名前 RS.Filter = ("名前 = " & "'" & str & "'") 上はある雑貨店のDBですが、あるブランドを抽出します。次にその中から、ある顧客の売り上げを集計する場合、結局全ブランドの”田中さん”になってしまいます。 要は、最初にブランドで抽出した意味がないのです、 ADOでDAOのようにrecordsetからrecordsetを作る方法はないのでしょうか？ ADOの書き換えるのはMSのQSLserverがDAOの対応してないからです。
SELECT * FROM database WHERE col001=32 AND col002=223 ORDER BY id; 結果は0.5秒 ローカルPCにmysqlサーバをインストールし、ローカル内だけで使用しています。 そのうち共有のレンタルサーバーを借りようと考えています。 ローカル内だけの実行はネットの通信速度は無関係ですが、 レンタルサーバーで実行する場合は通信速度が関係してくると思います。 クエリの実行速度は通信速度に影響し、 上記の結果速度が、例えば0.5秒から1.7秒まで遅くなる。 といったようなことは起きませんか？
distinctをexistsに変換した方がパフォーマンスが良いようで、 例えば以下の例があるとします ---------------------------------- （前）SELECT DISTINCT a.ID1, a.NAME1 FROM TABLE1 a, TABLE2 b WHERE a.ID1 = b.ID2 （後）SELECT a.ID1, a.NAME1 FROM TABLE1 a 　　　WHERE EXISTS ( SELECT 'X' FROM TABLE2 b WHERE a.ID1 = b.ID2) ---------------------------------- もっと複雑なSQLの場合、EXISTSに変換できるのでしょうか？。複雑なSQLとは、 「複数のテーブルからカラムを取得」「テーブル結合が２つ以上」「外部結合」 などのSQLで、以下に例を示します。 （例）SELECT DISTINCT a.ID1,a.NAME1,b.ID2,b.NAME2,c.ID3,c.NAME3 　　　FROM TABLE1 a,TABLE2 b,TABLE3 c 　　　WHERE a.ID1 = b.ID1(+) 　　　　　AND a.ID1 = c.ID1(+)
初歩の初歩の質問で申し訳ありません。ですが非常に困惑しています。 留学先の学校の夏期講習で、ＳＱＬのクラスをとることになったのですが、一体どんな方法（何を使って）で記述?を書いていけばよいのか分かりません。 過去ＶＢとHTML/CSSのクラスをとりましたが、VBならVS2010を、HTMLならメモ帳などを使って記述していくことを教科書にも書いてありましたし、シラバスでも書いてありましたので問題ありませんでした。しかしSQLの場合何を使えばいいのかさっぱりわかりません。 ググっても、SQLの講座的なものは行き成りSELECTやFROMなどのコード文の説明を書いており、開発環境のことには触れてなかったりで・・。使う予定の教科書にも何もそれっぽいものは書いて無いし（まだイントロ部分と1章を流しで読んだだけですが）、 開講は現地時間で6/18からで、まだ学校のポータルサイトの履修コースのところが開いておらず、シラバスはまだ見れません。おそらく当日になれば見れると思うのですが・・。簡単なクラス概要ならわかります。こんな感じです。（英語で申し訳ありません。変に訳すよりはと思い、とりあえず原文載せてみました。） CSDB 10 Introduction to SQL Intended for individuals who want to learn how to search for and manipulate data in a database, create tables and indexes, handle security, control transaction processing, and learn the basics of how to design a database. MySQLやSQL Serverがあるみたい(他にもある・・？)ですが、そのいずれかを使うのでしょうか？何だかよく分かりません。 言語のハンデや頭の回転の遅さがある分いつも早め早めの行動を心がけているので、開講前には準備万端にしておきたかったのですが。。 どなたか教えてください。
MyISAMのメリット・デメリットは http://d.hatena.ne.jp/yutakikuchi/20110131/12964 … を参照にしました。 MYSQL5でMyISAMを使うべきか迷っています。 共有のレンタルサーバーを使っています。 用途は、 [1]PHPで接続してDBから絞込・並べ替えたデータを抽出してWEBページに反映させる。 [2]テーブルは５～１０個、フィールド数は合計で100以内、レコード数は1000程度 [3]データの追加と更新はphpmyadminを使用。関わるのは1クライアントのみ。 MyISAMのデメリットは、 ・更新系処理が重い →WEBページから更新させるような機能もなく、1クライアントのみなので問題ないと思います。 ・トランザクションが使えない →全ての作業で一貫して正常に終了しなかった場合にエラーにする機能 →この機能が使えないと、phpmyadminでDBを更新したときにクライアントの入力は正確でも →プログラム側のミスで誤った情報が格納される、なんてことも起こるのでしょうか。 ・テーブルロックをかけるので、複数のクライアントからの同時更新でロックが発生する。 →更新を複数のクライアントでやる用途に変更した場合に、どんなエラーが発生するのか不安。 →同じテーブルを1クライアントしか更新できず、 →その間に他のクライアントが更新することはできない。 →更新中のクライアントの作業が終了することでロックが解除されるため、 →ロック解除後に他のクライアントが更新できるようになる →という機能でしょうか。 ・外部KEY制約を使うことが出来ない。 →便利そうな機能ですが、更新時に注意すればよいので使わないと思います。 ・リカバリが面倒。 →このデメリットが一番心配です。 →MYSQLがクラッシュするとデータが消え、手動で復旧する必要がある。 →phpmyadminにエクスポートでバックアップファイルを作る機能がありますが、 →その機能を使い定期的にバックアップファイルを作り、 →クラッシュ後にそのバックアップファイルをphpmyadminでインポート。 →これでリカバリは万事解決するのでしょうか。
全てのカラムを対象にソートや絞り込みをする、また、テーブルを分割する必要がない場合、 全てのカラムにインデックスをつけるしかないと考えていましたが、 http://www28.atwiki.jp/lucier/pages/55.html 「MySQLでは1000件以下のデータの場合はインデックスを作成しないほうが 速い」 1000フィールドならカラムの数に関係なくインデックス不要で カラムの数が10の場合と、 カラムの数が50の場合 それぞれ負荷はかわらないということでしょうか。
初心者です。 いろいろ検索して改善していったつもりですが、なぜ動かないのかどうしてもわからないところがあったので質問させていただいてます。 /* サーバーへの接続 */ $link=mysql_connect($server,$user,$passwd); /* データベース内のテーブルの名前を$tablesに配列で格納 */ $STS = "SHOW TABLE STATUS"; $mytables = mysql_query($STS); while($r = mysql_fetch_array($mytables, MYSQL_ASSOC)){ $tables[] = ($r["Name"]."<br>\n"); } /* 全テーブルのレコードを全てプリント */ foreach($tables as $value){ $results = mysql_query("select * from " . $value, $link); while ($row = mysql_fetch_array($results, MYSQL_ASSOC)) { print_r($row); print("<br>\n"); } } mysql_close($link); foreachの部分を for($i = 0; $i < 2 /*$tables[$i] != 0*/; $i++){ $results = mysql_query("select * from " . $tables[$i], $link); $row = mysql_fetch_array($results, MYSQL_ASSOC); print_r($row); } でもやってみました。 これを利用して、何とか表形式でデータベースのテーブルのレコードをwebページに出力させようと思っています。 実行するとprint_r($row)の出力がでず、いろいろ試してみた結果、$resultsもしくは$rowに問題があることがわかりました。 var_dump($row); でNULLが出力されました。 var_dump($results); もやったのですが、うろ覚えなのでここには書きません。 $results = mysql_query("select * from gutaiteki_table", $link); としたら動いたので、select * from の後に変数を続けているからだめなのかなと思いましたが、私にはどうにもしようがありません。 これを正常に動作させる方法、他にうまいやり方があればその方法を教えてほしいです。 （私はデバッグのやり方がわからないので、「改変してwebのページを更新する」というのを繰り返してプログラムを作成していますが、他に方法があればそれも併せてご意見ほしいです。これは余裕があったらで構いません。）
すいません、教えてください。 以下のようなCMDバッチを作成しました。 TEST.cmd------------ sqlplus -s ID/PASS@DB @MAIN.sql 'SUB1.sql' 'SUB2.sql' > MAIN.log echo %ERRORLEVEL% MAIN.sql------------ @&1 @&2 commit; quit; これを実行した場合、MAIN.ｓｑｌの最後のコマンドquit;の 実行結果を返してきているのでしょうか? SUB1.ｓｑｌ、SUB2.sqlで失敗していても%ERRORLEVEL%で0が返ってきます。 MAIN内のそれぞれのsqlの実行結果ログを取得することは可能でしょうか? SUB.sqlの内容はいずれも単純なMERGE文です。 識者の方がいればご教示いただきたく存じます。 よろしくお願いいたします。
以下のようなテーブル(test)があるとします。 id　type　　age --+----+----- 1　　A　　　15 2　　B　　　21 3　　C　　　32 4　　A　　　18 5　　A　　　16 6　　D　　　34 7　　A　　　55 8　　C　　　22 このテーブルを「SELECT * FROM test where type = 'A' order by id」で抽出すると、 id　　type age --+-----+--- 1　　A　　　15　---(1) 4　　A　　　18　---(2) 5　　A　　　16　---(3) 7　　A　　　55　---(4) となると思いますが、phpからは「typeAで４番目に登録したもの」としてとしてクエリが 送られてくるので、id7のデータを4として抽出したいのです。 (search.php?type=A&no=4　という感じです) スマートに１文でいけますでしょうか？ MySQLのバージョンは4.0.27です。 お詳しい方、どうぞ宜しくお願い致します。
Windows版Oracle 9iでv$sysstatをチェックしたいら table fetch by rowid が　1.123456789E+10 という指数形式になって整数でなくなったのですが、これはOracleを再起動しないと元の整数値表示には戻らないのでしょうか？ 要は１０桁・９９億を越したことが原因なのですが、桁数を増やすとか、１００億を越さない前に値をリセットするなどの方法があればと思っています。
phpからmysqlのクエリを作りコンテンツを検索・絞り込みさせようと考えています。 説明するのが苦手なため画像での説明になってしまいますが、 データベースの構造 http://blog-imgs-54.fc2.com/s/k/s/sksfiosjdijf34 … 絞り込みページのイメージ http://blog-imgs-54.fc2.com/s/k/s/sksfiosjdijf34 … 種類テーブルだけは「名前」が決まれば「仲間」と「原産地」が決まるので正規化することができましたが、他はできないと思います。 現在所在地テーブルはできそうですが、市によって町名が重なってしまうところがあるので正規化していません。 特徴テーブルは、種類による一般的な特徴よりも実際の特徴を優先しているので、同じ種類でも特徴がそれぞれ違います。 テーブルを分けている理由は、その方が管理しやすいと思ったからです。 特徴テーブル、日付テーブルも同じ理由です。 コメントテーブルのデータは検索しません。 「番号」には主キーを、種類テーブルは「名前」のみ、その他のカラムには全てインデックスをつけます。コメントテーブルはつけません。 そして、絞り込みページでは、 それぞれのカラムでソートさせる機能もあります。 「絞り込み」を押すと選択した条件に全て一致するコンテンツを絞り込みます。 「詳細へ」を押すと詳細のページに入り、 詳細のページでは、そのフィールドの全てのカラムのデータを表示させます。 もっと早く検索でき、効率的な構造にしたいのですが、アドバイスをいただけないでしょうか。
私の持っている参考書の中に、次のように、 変数をダブルコーテーション、シングルコーテーション、およびピリオドで囲んでいるSQL文があるのですが、 この場合、なぜ、ダブルコーテーション、またはシングルコーテーションのみでは駄目なのでしょうか？ ［参考書の記載］ where カラム名>="'.変数.'" ※変数は日付が入ります。varchar型です。
Oracleに適用されているパッチの情報はどこを確認すればわかるでしょうか？
具体的には以下のテーブルがあるとします。 コード１　　　　コード２ -------------------- 　001　　　　　　A001 　001　　　　　　B001 　001　　　　　　C001 　002　　　　　　A001 　002　　　　　　B002 　002　　　　　　C001 そして、コード２がＡ００１とＢ００１を持ったコード１を抽出したいのです。 結果としては コード１　 ------- 　001　　 となりたいんです。 条件で単に　コード２＝Ａ００１　ＡＮＤ　コード２＝Ｂ００１　と書いただけでは無理でした。 もし、ＯＲだったら仮に重複を省いても コード１　　 --------- 　001　　 　002　　 となって、００２はＢ００１がないにもかかわらず選ばれてしまうので意味がありません。 最終的には コード２　IN (A001,A003) ＡＮＤ　コード２ IN (C001, C002)のような条件にするのですが 上記の段階で上手く行ってないので質問させて頂きました。
お世話になります。 下記のテーブルから下記の条件で データを出力するSQL文を作成したいのです。 アドバイスお願い致します。 条件１：NAMEはAを抽出 条件２：ICHIはグループ集計 条件３：ITEMはD2とD3を抽出 TESTテーブル NAME ICHI ITEM DATA ----- ---- ---- ---- A A1 D1 1 A A1 D2 2 A A1 D3 3 A A1 D4 4 A A2 D1 10 A A2 D2 20 A A2 D3 30 A A2 D4 40 B A3 D1 100 B A3 D2 200 B A3 D3 300 B A3 D4 400 データ出力結果 NAME ICHI DATA DATA ----- ---- ---- ---- A A1 2 3 A A2 20 30
例えば極端な例ですが、5000万人の会員のデータがmemberテーブルに入っていた場合 5000万行の中から特定の会員のレコードを探すのは時間が掛かると思うので select * from member where user_id = $user_id; 50万人ごとにテーブルを新たに作ってデータを格納した方がクエリの実行時間も早くなり負荷軽減に繋がるといえますでしょうか？ user_idが1～50万は テーブルmember_1 $table = member_1; user_idが50万～100万は テーブルmember_2 $table = member_2; select * from $table where user_id = $user_id; 大手会員制サイトは、膨大な会員データをどのように格納しているのでしょうか。 ご教示頂けると幸いです。 宜しくお願い致します。
検索対象のカラムがid(主キー)、bc1～bc40と41個あります。 １つのテーブルに41個のカラムを作り検索させると非常に時間がかかります。 それにインデックスを全部に付けたいですが16個までしかつけられないです。 なので、５つのテーブルにカラムを分けて全部のカラムにインデックスをつけて それぞれを検索させようと思っています。 テーブルが１つだけなら SELECT * FROM `bc` WHERE `bc1`='あいうえおかき' AND `bc2`='あいうえおかき' AND `bc3`='あいうえおかき' AND ・・・ `bc39`='あいうえおかき' AND `bc40`='あいうえおかき' ORDER BY `bc33` DESC LIMIT 0,50; のようにできますが、テーブルが複数の場合はどうしたらよいのでしょうか。 検索を試す前に下記ができるか試してみました。 SELECT COUNT(*) FROM (((`ccc` INNER JOIN `bbb` ON `ccc`.`id`=`bbb`.`id`) INNER JOIN `aaa` ON `ccc`.`id`=`aaa`.`id`) INNER JOIN `ddd` ON `ccc`.`id`=`ddd`.`id`) INNER JOIN `eee` ON `ccc`.`id`=`eee`.`id` エラーにはなりませんがカウント数が0になってしまいました。 SELECT COUNT(*) FROM (`ccc` INNER JOIN `bbb` ON `ccc`.`id`=`bbb`.`id`) INNER JOIN `aaa` ON `ccc`.`id`=`aaa`.`id` これは正確にできてカウント数100000 SELECT COUNT(*) FROM ((`ccc` INNER JOIN `bbb` ON `ccc`.`id`=`bbb`.`id`) INNER JOIN `aaa` ON `ccc`.`id`=`aaa`.`id`) INNER JOIN `ddd` ON `ccc`.`id`=`ddd`.`id` ４つ目のテーブルを入れたところから無理なようです。 他に良い方法はないのでしょうか。
以下のようなSQLがあるとします。 ------------------------ SELECT * from (select * from TABLE-A where 条件色々) AA, TABLE-B BB where BB.x(+) = AA.x ------------------------ TABLE-Aの件数は非常に多く（例100万)、条件は複雑です。 TABLE-Bの件数は少ないです（例30件） この時、実行計画が HASH JOIN RIGHT OUTER TABLE ACCESS FULL TABLE-B のように出ましたが、どのように解釈すれば良いのでしょう？ TABLE-Bは件数が少ないのでACCESS FULLでも問題ないでしょうか？ HASH JOIN RIGHT OUTER　のコストが高くなってて気になってます。 たとえば、この場合のより適切な実行計画ってありますか？
idはintでプライマリー a5はchar(10)で日本語文字列を格納 データを取得しようとすると#1054エラーがでます。 admin-------- SELECT * FROM `aaa` WHERE `a5`=`あいうえおかき` #1054 - Unknown column 'ã moniter-------- mysql> SELECT * FROM `aaa` WHERE `a5`=`あいうえおかき`; ERROR 1054 (42S22): Unknown column '縺ゅ＞縺・∴縺翫°縺・ in 'where clause' `あいうえおかき`の日本語に問題があると思い半角データを1行だけ更新しました。 admin-------- SELECT * FROM `aaa` WHERE `a5`=`abcde` #1054 - Unknown column 'abcde' in 'where clause' moniter-------- mysql> SELECT * FROM `aaa` WHERE `a5`=`abcde`; ERROR 1054 (42S22): Unknown column 'abcde' in 'where clause' admin-------- moniter-------- SELECT * FROM `aaa` WHERE `a5` SELECT `a5` FROM `aaa` WHERE 1 SELECT * FROM `aaa` WHERE `id`=89584 成功
ウィンドウズ7を使っています。FFFTPで送ろうとしたデータを削除したらデータが消失してしまい、検索をかけても見つかりません。こんなことってあるのでしょうか？とても困っていますどなたかご教示ください。
phpmyadminの画面上には サーバのバージョン: 4.1.22-Max MySQL クライアントのバージョン: 5.0.83 と表示され、 phpinfoでは Client API version 5.0.51a と表示されます。 この３種類は何か分かりませんが、 バージョンが全部違うのは問題ですか？ Client API version 5.0.51aは少し低めですが、 あとの２つも少し低めですか？
毎日部署ごとにで作業日報をとっており、その時間をつけています。 各項目の小計時間が、全体の合計になるようにフィールド設定しています。 現在毎日の合計時間はでているのですが、毎月の合計がでていません。 現レイアウトを複製し、合計時間をSUM関数でやってみたところ、検索した期間での合計にはならず全体の合計のままになっています。 例えば、4月分の合計（4月1日～30日）の合計をだずにはどのようにすればいいでしょうか。
PostgreSQL のバージョンアップを検討しています。 Version 9.1.4 Version 8.3.19 Version 8.3.1と比べると機能・性能・セキュリティなどが良くなっているのですか？ phpからの操作の仕方や挙動が変わるとかあるのでしょうか。 Version 8.3.19 の方がよいですしょうか。
Windows版　Oracle 9iで、下記のＳＱＬを実行した値で質問なのですが・・・ <<SQL>> Select name, value from V$SYSSTAT where name like 'table%'; <<SQL結果>> NAME VALUE ---------------------------------------------------------------- ---------- table scans (short tables) 41298 table scans (long tables) 171 table scans (rowid ranges) 0 table scans (cache partitions) 0 table scans (direct read) 0 table scan rows gotten 151275758 table scan blocks gotten 11959596 table fetch by rowid 23079146 table fetch continued row 1048 table lookup prefetch client count 0 Webで検索すると、 Full Scan率は「table scans (long tables)　/ ( table scans (short tables)+table scans (long tables) )」とあったり、 「table fetch by rowid　＜　table scan rows gotten」は頻繁にFull Scanしている状態とあって、「table scan rows gotten」がFull Scanの行数に思えるですが、実測した下記の値からは違うように思えるのですが、どのように解釈すれば良いのでしょうか？ table scans (short tables) 41298 table scans (long tables) 171 ---- table scan rows gotten 151275758 table fetch by rowid 23079146
すいません！ 名前をひらがなにして、バラバラにして、出力させたいのですが 何をどうしたらいいのか、教えていただけないでしょうか？ 当方の所持ソフトはOpenOffice.org 3.2というものです。 似たような質問を見つけましたが、calkやマクロがわからないため １～１０まで説明して頂けるとありがたいです。 大変面倒な回答になりますが、当方ほとほと困り果てております。。 何とぞよろしくお願いします m( _ _ )m
たとえば、こちらに「こだわり条件で絞り込む」という機能があります。 http://www.athome.co.jp/bklist?ITEM=ks&ART=13&AR … MYSQLでこのような機能を実現する場合、 1項目1カラム、全てにインデックスを設定。 または 該当する項目を1カラムにまとめて格納し（CS,CATV,グルニエ,…）、その中に一致する文字の有無を判断させる。 どのような構造だと効率的に動くようになるのでしょうか？
２００７年１２月３１日付けでEmployeesテーブルのA型の人にだけ特別給料５０００円を追加するというもので Employeesテーブルには血液型（BloodType）があり給料(Amount)や支払月（PayDate）は、Salaryテーブルにあります。 UPDATE Salary INNER JOIN Employees ON Salary.EmployeeID = Employees.EmployeeID SET Amount = Amount + 5000; AND SET PayDate = '2007-12-31' FROM Salary WHERE BloodType = 'A'; ネットなどで調べて上記のコードを書いて試してみたんですがうまくいきませんでした。 どのようなコードを書くと正しく実行できるのでしょうか？
ID、name、seibetuという列を持つ、membersというテーブルがあり、INSERT文を実行してテーブルに値を入れたいと考えています。 IDがIs IDENTITYの値がTRUEになっている列で、NOT NULLです。 以下のクエリを実行したところ、IDにNULLが入るといったエラーが起きます。 SET IDENTITY_INSERT members ON INSERT INTO members (seibetu, name, ID) VALUES ('男', 'すずき', @@IDENTITY) 何か問題があるのでしょうか？ お分かりの方いらっしゃいましたらよろしくお願いします。
スロークエリログで、特定のクエリが遅いことが分かりました。 テーブル構成は以下のような感じです。 テーブル：shoptable データ数：200件（店舗数）ぐらい id　category shopname　　 area 1　　　2　　　佐藤商店　　東京都 2　　　1　　　田中衣服　　北海道 3　　　5　　　柴田ホーム　名古屋 テーブル：goodstable データ数：25万件（商品数）ぐらい id　shopid　goods　　　　date 1　　2　　　帽子　　　　2012-06-01 03:06:56 2　　2　　　ジャケット　2012-06-01 03:10:12 3　　1　　　ライター　　2012-06-01 03:15:22 4　　3　　　くぎ　　　　2012-06-01 03:55:07 このような状況で、categoryが2のお店の商品を日付順に100コ目以降から10コだけ表示したく、こんなqueryを試したのですが、 select * from goodstable as g left join shoptable as s on g.shopid = s.id where category='2' order by g.date desc LIMIT 100,10; 表示されるまでに時間がかかってしまいます。 expainで見たところrowsで25万件すべてをチェックしているようなので、それが原因かなと思っているのですが、どのようなqueryにしたらもっと早く結果を得れることができるでしょうか。
色々、試しているのですがうまくゆきません。 どうしたらよいでしょうか？ ポストグレのドライバを設定するところがあるのですが、 何を設定していいか分かりません。
言語：C# DB：SQLServer2008 １．トランザクション開始 ２．テーブルAをUPDATE ３．色々な処理(省略) ４．テーブルＡのUPDATE前の情報を参照 ５．参照したテーブルをもとにテーブルBをUPDATE ６．すべての処理が正常だったら全テーブルコミット、１つでも失敗したら全テーブルロールバック 問題となっているのは ４．テーブルＡのUPDATE前の情報を参照する際に、テーブルAがロックされていて参照出来ないことです。 トランザクション開始時に分離レベルを設定してみましたが同じ結果でした。 ｔran = con.BeginTransaction(分離レベル); お分かりになる方ご教授お願いします。
いつもありがとうございます。 質問させて下さい。 以下のテーブルより、S1が同値で、Codeに1と0が混じっている場合、SQLでS1を取得したいのです。 NoS1Code 13001 23011 33000 43010 53021 63020 73021 83030 93041 103050 113050 （Noはキー） 望む結果 S1 300 301 302 どういうSQLを組めば実現可能なのでしょうか？ 有識者の方、ご享受宜しくお願い申し上げます。 ※VBA等プログラミングが入っても問題ありません
アクセスのレポートについて、 結果の報告書を作成したいのですが、CSVデータには、 顧客名、顧客の部、顧客の課と結果が表示されています。 報告書を顧客の課別に報告するのですが、今までの報告書形式にあわすために困ってます。 既存の報告書の結果が、縦二列にデータが並んで表示されていました。 例 　　　　レコード１　　　　　　レコード５　 　　　　レコード２　　　　　　レコード６ 　　　　レコード３　　　　　　レコード７ 　　　　レコード４　　　　　　レコード８ レポートデザインで、どのように設定したらよいか教えてください。 報告書の提出先として、結果を顧客データを所属する課別に レポートを別にしたいのですが、 レポートウィザードのヘッダーのグループ化を二重に設定する事は可能でしょうか？ よろしくお願いいたします。
phpでサイト構築を考えておりますが、データベースをmysqlかpostgresか、マイクロソフトのSQLサーバのどちらが早いのか検討しています 一日のデータの件数を5万件入れて、そのデータをselect、insert、updateなどするときに mysqlかpostgresのマイクロソフトのSQLサーバのどちらが早いのか、良くわからなくて、皆様の知恵をお借りしたいです。 シンプルに、データの件数での処理の速さで考えております。 例えば、10万件のデータをinsertする 10万件のデータを、updateする 10万件のデータを、登録する あと、どの程度データを各データベースに入れると重くなってしまうものなのか・・・ 宜しくお願い致します
PGAメモリに関してですが １．あるSQLがあるとして、そのSQLでどの程度PGAメモリを消費するかを 　　確認する事は出来るのでしょうか？ ２．PGAメモリを消費しやすいSQLとはどのようなSQLなのでしょうか？ 　　簡単なSQLより複雑なSQLの方が消費しやすいと思ってます。 　　その中で特に何か消費しやすいSQLの特徴はあるのでしょうか？ 　 (例）大量データへのアクセス 　　　　INDEXを利用しないFULL ACCESS 　　　　副問い合わせ 　　　　多数のテーブル結合 　　　　関数などの利用 　　　　order by、group by 　　　　（etc）
質問失礼します。 下記のような3つのデータベースがあるとします。 【main】 +---+--------------+------+------+ │id│title │artist│season│ +---+--------------+------+------+ │1│winter again │1　　　│4　　　│ +---+--------------+------+------+ │2│すみれ9月LOVE│2　　　│3　　　│ +---+--------------+------+------+ │3│HOWEVER │1　　　│4　　　│ +---+--------------+------+------+ │4│Boy Meets Girl │3　　　│1　　　│ +---+--------------+------+------+ │5│いつか │4　　　│2　　　│ +---+--------------+------+------+ │6│夏色 │4　　　│2　　　│ +---+--------------+------+------+ 【artist】 +---+--------+ │id│artist │ +---+--------+ │1│GLAY │ +---+--------+ │2│SHAZNA│ +---+--------+ │3│TRF │ +---+--------+ │4│ゆず │ +---+--------+ 【season】 +---+------+ │id│season│ +---+------+ │1│春 │ +---+------+ │2│夏 │ +---+------+ │3│秋 │ +---+------+ │4│冬 │ +---+------+ この3つのデータベースを最終的に1つにまとめて PHP上で下記のように表示することは可能でしょうか？ 【例.php】 +---+--------------+-----------+------+ │番号│曲名　　　　　│アーティスト│季節　│ +---+--------------+-----------+------+ │1│winter again │GLAY　　　　│冬　　│ +---+--------------+-----------+------+ │2│すみれ9月LOVE│SHAZNA　　│秋　　│ +---+--------------+-----------+------+ │3│HOWEVER │GLAY　　　　│冬　　│ +---+--------------+-----------+------+ │4│Boy Meets Girl │TRF　　　　　│春　　│ +---+--------------+-----------+------+ │5│いつか │ゆず　　　　　│夏　　│ +---+--------------+-----------+------+ │6│夏色 │ゆず　　　　　│夏　　│ +---+--------------+-----------+------+ 最初から【main】のデータベースにまとめておけばよいとは思うのですが、 データ数が数十万あり、【artist】や【season】を編集するだけでも大変になったため、 別でデータベースを作り、このような形にできないかと思っております。 また、もしできるとしたら、このような形は、 ページの表示速度が落ちたりするのでしょうか。 ご存じの方いらっしゃいましたら、ご教授お願い致します。
MySQLで年齢検索して該当する人を一覧表示したいのですが、どのようにしたらいいでしょうか？ テーブルには生年月日(birthday)を持っていて年齢に相当するカラムはありません。 管理画面で年齢をセレクトボックスで指定して検索ボタンを押すと該当の年齢の人が一覧表示させたいです。下記のように書いたのですが、ageがありません。というメッセージでダメです。 どのようにしたらいいでしょうか？ 教えてください。PHPとMYSQLです。 SELECT ( YEAR( CURDATE( ) ) - YEAR( birthday ) ) - ( RIGHT( CURDATE( ) , 5 ) < RIGHT( birthday, 5 ) ) AS age FROM member where age=36
MySQLで、perlを使ってチェックボックスでデータを送信するのですが、 カラムを分けずに、チェックボックスで複数選択されたデータを、；などの仕切りで同一フィールドへ記録したいのですが、やり方がわかりません。 <input type = checkbox name = col1 value="1"> <input type = checkbox name = col1 value="2"> <input type = checkbox name = col1 value="3"> <input type = checkbox name = col1 value="4"> 結果 col1 |col2 | +-------------- 1;2;3;4| | のような感じです。よろしくお願いします。
javascriptは検索エンジンが読むことが出来ないことが理由で不利になるそうですが、Mysqlなどのデータベースも同じですか？　でも、アマゾンとか本の名前を入れるとその情報がヒットするのはなぜでしょうか。
OEMで実行計画を見てます。 負荷の高いSQLの場合、「トップアクティビティ」からSQLを選択して見てます。 「トップアクティビティ」に出てこない、負荷の低いSQLの場合、 どのようにすればOEMからSQLの実行計画が見れるのでしょうか？
Excel：2010 Oracle：10g 接続：ADODB Oracleで質問すべきか、VB側にすべきか迷いましたが、こちらに質問させていただきます。 ExcelVBAからOracleに接続し、ストアドを実行して複数行のデータを取得後 エクセルの各セルに取得データを設定するマクロを作成しております。 コマンドのExecuteを行った後、レコードセットが取得できていないようで 「オブジェクトが閉じている場合は、操作は許可されません」 となってしまいます。 ストアド自身は、Oracle側でエラーなく動いています。 カーソルで取得したデータをエクセル側に渡すには、それ用のOutputの変数（配列？）が必要なのでしょうか？ よろしくお願いいたします。 ストアドプロシージャ（一部SELECT文は長いため、省いています） -------------------- CREATE OR REPLACE PROCEDURE A.P930 ( varCD IN VARCHAR2, varDate IN VARCHAR2 ) AS CURSOR C_SIM IS SELECT CD, NAME FROM T WHERE CD = varCD AND CNTRCT_DATE = varDate; SIM_REC C_SIM%ROWTYPE; BEGIN OPEN C_SIM; LOOP FETCH C_SIM INTO SIM_REC; EXIT WHEN C_SIM%NOTFOUND; END LOOP; CLOSE C_SIM; END; / VBA側 Connection接続はOK -------------------- Sub LIST() 変数宣言等省いています Set myCmd = New ADODB.Command With myCmd .ActiveConnection = DBADOCon .CommandType = adCmdStoredProc .CommandText = "P930" .Parameters.Append .CreateParameter("varCD", adVarChar, adParamInput, 3, strLineCd) .Parameters.Append .CreateParameter("varDate", adVarChar, adParamInput, 6, strMonth) Set myRs = New ADODB.Recordset Set myRs = .Execute End With If myRs.RecordCount = 0 Then　　　　　←ここでエラーになります 'エラーメッセージ表示 Exit Sub End I
自宅PC環境にてMySQLの学習を始めたのですが、 UTF-８の日本語表示で躓いてしまいました。 コマンドプロンプトでUTF-８を表示させるため、 レジストリエディターで、 TrueTypeFontの値のデータを「*MS ゴシック」にすることを試みたのですが、 私の環境下では上手くいきませんでした。 （OSはWindows7の64bitです。） ですので、コマンドプロンプトでUTF-８を表示させる方法か、 もしくは、その他のターミナルソフトをご教示いただきたくお願い申し上げます。 なお、今はphpMyAdminを使って凌いでいますが、 使っている参考書が、コマンドプロンプトを使うことを前提に解説されているため、 まずは、phpMyAdminに頼らずに、MySQLをマスターしたいと考えております。 よろしくお願いいたします。
レンタルサーバーのMysqlデータをバックアップしたいと考えていまして コマンドプロンプト ↓ telnetでログイン ↓ mysqldump...... と考えていたのですが、telnetが許可されていませんでした。 mysqldumpを実行するには他にどのような方法がありますか。 宜しくお願いします。
よろしくお願いします ダウンロードしたCSVデーター（３６MG、３７２００行）を並び替えタグのユーザー設定の並び替えで 実行したら、リソース不足のため実行できませんのメッセージがでて並び替えが出来ません。 OSはWiindows７を使用しています。ハードディスクの空き領域は３５０GB有ります。 どの様にしたら解決するか教えてください。パソコンについてあまり詳しく有りません。
phpでサイト構築を考えておりますが、データベースをmysqlかpostgresのどちらが早いのか検討しています 一日のデータの件数を5万件入れて、そのデータをselect、insert、updateなどするときに mysqlかpostgresのどちらが早いのか、良くわからなくて、皆様の知恵をお借りしたいです。 自分で、調べた範囲では　mysqlは、ある一定を超えると極端に遅くなるとかあったのですが・・・トリガーなどは考えないで シンプルに、データの件数での処理の速さで考えております。 宜しくお願い致します
質問をさせていただきたいのですが、 Accessで別のテーブルに有るカラムを合計した金額をもとに、 テーブルを更新するにはなにかよい案などございませんでしょうか。 具体的にもうしますと、 AテーブルとBテーブルがありまして、AテーブルのA１というカラムの値をsumし た値を BテーブルのB1というカラムに入れるアップデート文を作成したいのです。 AテーブルのA2とBテーブルB2というカラムは同じ値が一意で入っています。 インターネットで検索した、今回行おうとしている事に近い方法を 試しても上手くいきませんでした。 大変申し訳ございませんが、お知恵をお貸しいただけませんでしょうか。 以上です。 よろしくお願いいたします。
SQLで名前の属性に「様」をつけて取り出したい場合はどうしたらいいのですか。 参考書に書いてあるようにやったのですが、そうすると0が出力されてしまいました。(もとのテーブルにはちゃんと名前が入っています) よろしくお願いします。 mysql> select customername ||　'様' as お名前 from customers; +--------+ | お名前 | +--------+ | 0 | | 0 | | 0 | | 0 | | 0 | | 0 | | 0 |
