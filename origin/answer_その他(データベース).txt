可能です。　が、ここでは説明しきれません。 https://msdn.microsoft.com/ja-jp/library/aa139961(v=office.10).aspx 自分は、mdeにしてフォームですべてを管理して、フォームへのアクセス用メニューで行先を制限しています。
なんのアプリの話でしょうか。 コンボボックスで選択リストから何かを選択したとき、フォーム上の何がどのようになるのが理想なのでしょうか。 その機能は現在どのように処理させているのでしょうか。 ここから先は私の勝手な妄想なので全く希望に沿わない可能性があります。 ------------------ アプリケーションは Access を使用。 連絡先の一覧を格納しているテーブル [Addresses] がある。 連絡先一覧を表示させるためのフォーム [AddressesForm] がある。 フォームのレコードソースは [Addresses] をそのまま使用。 フォームで表示している列の中に部署名のフィールドである [Division] がある。 Division 列の値は人によっては 「●●部」だったり「●●部 ●●課」だったり「●●部 ●●課 ●●係」だったり違いがある。 フォームのヘッダー部分にコンボボックスを設置し、部署名を選択できるようにしたい。 コンボボックスの選択リストは "部" の名称一覧を入れてある。(●●部) さらに、部名のほかに 「すべて」 というキーワードも追加してある。 コンボボックスで部名を選ぶと、Division 列が「その部名から始まる」レコードだけを表示するようにしたい。 「すべて」を選択した場合はすべてのレコードが表示されるようにしたい。 ------------------ フォーム AddressesForm をデザイン モードで開く。 ヘッダー部分にコンボボックスを設置し、プロパティ シートの [その他] のタブの [名前] でコンボボックスの名前を combDivisionFilter に変更する。 プロパティ シートの [イベント] にある [変更時] を選択し、[…] をクリック。[ビルダーの選択] から 「コード ビルダー」を選択して [OK] をクリック。 VBA のエディターが開く。 Private Sub combDivisionFilter_Change() End Sub というコードが生成されるので、下記のように変更する。 Private Sub combDivisionFilter_Change() 　Dim filterValue As String 　filterValue = combDivisionFilter.Value 　If filterValue = "すべて" Then filterValue = "*" 　Form.Filter = "Division Like '" & filterValue & "*'" 　Form.FilterOn = True End Sub
テキスト型の比較では "10" < "2" ですからね。 伝票番号フィールド を 数値型にすれば問題ないんですが、 それじゃダメなの？
商品マスター内の単価を増やした場合、将来的に4つ以上になった時に 対応ができなくなり、再改造を迫られる事になります。 ＞商品マスターの単価を都度替えてしまうと、前月の売り上げ金額等が ＞合わなくなってしまう そもそも上記の状態になるのなら、商品マスター内の単価を増やしても 商品マスター内の単価を変更すれば同じ結果になるので、根本的な解決 にはなりません。 前月の売上金額を集計するには、売上明細に単価を追加し、集計時には その単価を使う様にすべき。 ＃集計毎に、数量・単価から金額計算するのではなく、売上明細の金額 ＃(計算済み)を利用するのも可 同一の商品が複数の単価を持つ場合、[商品コード][単価区分コード]を キーにした、商品単価区分マスターを使うという方法も有ります。 ＃単価区分コード=0の場合は、商品マスターの単価を使用。 上記の変更ができるかどうかは、既存のシステムがどの様に作られて いるか及び、改修担当者に変更できるだけの能力があるか次第。
それから、シートにある　在庫　ですが データとして不要です。 在庫数＝SUM(生産数）－SUM(販売数）の関係にあるので 必要に応じて計算できます。 データ集計プログラム（パッケージ品）が何なのかわかりませんが エクセル自体が集計ソフトですので どうせ考えるならエクセルで集計するプログラムを考えた方が 今回、考えておられるテキストファイルへ出力プログラムより よっぽど簡単だと思いますよ。 その昔に決めた書式・ルールにこだわるため、どんどん複雑にしてしまった。 エクセルを昔の表を作成できるワープロ版の考えから脱皮できていない。 こんな感じを受け取るのですが？？
チェックをすることでTODAYではなくその日の日付を入れるならマクロになります。 マクロでもいいならどなたか回答がくるかも知れません。 私はマクロは使わないので、提案するなら例えばマウス操作ならいけるのでしたらどこかの別セルにTODAY関数を入れておき、入力規則のリストでそのセルを参照しておけばプルダウンの候補に常に当日の日付がでて選べばその日付が入ります。
> デザイングリット(?)でする作業で対応したいと思っています。 この条件があるから回答が付かないのでしょう。 テーブル構造に問題 があるのですが 構造を変えずに、ということなら 「ユニオンクエリ」でということになります。 デザインビューではできませんが、この場合なら簡単です。 探せばネットに同じような例がころがっていると思われます。
テーブルの作り方に問題があります。 店舗名　商品名　価格、、、 というテーブルを作り、 価格表は、クロス集計クエリなどで表示すべきです。
Access2002での実現方式がわかりませんので何とも言えませんが、マイクロソフトのサイトにある以下の情報が参考になるように思います。 https://support.office.com/ja-jp/article/Access- … 　で。基本的にはデータの参照を行うテーブルと、データの追加・更新・削除を行うテーブルを完全に分離しかつ、後者につては接続ユーザごと（端末ごと）にテーブルを分けることです。これが確実です。 　それが出来ない場合はAccessへの（少なくとも）追加・更新・削除を行う端末側からの要求を一手に受けるプログラムを作成し、これが各ユーザ（端末）からの要求を受けて処理するというプログラム構成に変更することです。 　サーバープログラムを1つ作成し、各端末はAccessに接続して処理要求するのではなく、このプログラムに接続して処理要求することになるのでかなりの改修＆新規開発ですね。 　SQL Serverを入れるのが早いと思います。機能を制限した無料版があったかな？ 　えっとExpressなら無料です。SQL Server 2016 Expressですね。 　もしくはMy SQLなどに乗り換えるか。。。 参考まで。
まずクエリの考え方が間違っています。 クエリとは、実態を表示する方法であり、入力を簡単にするものではありません。 あなたが参考にしている本やサイトは、クエリを使って入力させてるの？
ページヘッダーの部分は文字だけでは状況がよくわからないので 回答は控えさせていただきます。 レコードの抽出についてですが レポートのレコードソースになっているクエリで条件を指定します。 フォームにIDがあるのであればクエリの抽出条件に =[Forms]![メインフォーム名]![ID] とすれば該当のIDのレコードのみになると思います。 http://oshiete.goo.ne.jp/qa/2114831.html
なお、ACCESSでLEFT JOINを複数利用する場合、()で括ってやらないとダメなようです。 SELECT 顧客マスタ.* , 問合せ履歴.* FROM ( 顧客マスタ LEFT JOIN 問合せ履歴 ON 顧客マスタ.顧客ID = 問合せ履歴.顧客ID ) LEFT JOIN ( SELECT MIN(問合せ履歴.登録日) , 問合せ履歴.顧客ID FROM 問合せ履歴 GROUP BY 問合せ履歴.顧客ID ) AS T1 ON 顧客マスタ.顧客ID = T1.顧客ID ただし、このクエリでは、T1内に存在する顧客IDが合致するものすべてを抽出してしまうので、1顧客IDに対して複数レコードを抽出してきてしまうため、間違いです。
作業をする際に、別MDB？のリンクテーブルを作ったなら、 もともとの状態に戻さないと、ダメだろうね。 まあ、現地に持っていったら、また、 ＞サーバのAccessデータベースが存在しないので、そのサーバのデータベースをリンクするようにAccessから指示され、リンクさせて動作させています。 になると思う。 　 頻繁にそのような作業が発生するのであれば、DAO(もしくはADOX)で、リンク先を変更するコードを書いておけば、メンテナンスは楽になると思う。 http://vba-geek.jp/blog-entry-104.html https://support.microsoft.com/ja-jp/kb/230588
連番が変化しない方がいいと思いテーブルに連番を作成する方法を回答したのですが クエリで行いたいならこちらを参考に作成してみてください。 http://www.relief.jp/itnote/archives/003569.php
>今考えていることは >テキストボックスコントロール/ラベルコントロールのクリック時イベントなどに >文字色を淡く/濃くなどと切り替えて、 >実際に作業する人には「淡い文字の所は無視してね」としてもらう・・・ >ダメですかね？ 作業工程の段階を何処かに保存する必要があるでしょうから、ダメでしょう。 没 にしてください。 すみません。
>>どなたか詳しく説明していただけないでしょうか？ それよりも、質問者さんが、データベースを「詳しく勉強されること」が必要だと思います。 >>なぜ、やりたいのかと言うと、レポート出力を使いたいからです、初心者なもので レポート出力で条件のみが印刷出来れば言うこと無いのですが この程度のことができないなら、本当に勉強不足ですよ！！
>商品名と件数が、構造上、離れてしまいます。 これは商品名と件数を配置している詳細セクションの高さが大きいからでしょう。 _________________________________________ ↓詳細 _________________________________________ となっている帯部分を選択するとそこのプロパティに切り替わります。 取りあえず、１cmくらいにしてみてください。 最終的（暫定）には、 売上日範囲の指定、 複数の顧客の確認書？をそれぞれ印刷。 のようですね。 何故、似たような質問を二つに分けたのか分かりました。
2016/7/4　 100 　　りんご 2016/7/4　 100 　　りんご 2016/7/4　 200 　　みかん 2016/7/5　 200 　　みかん 2016/7/5 　200 　　みかん これから得られるのは個数というよりも件数ですね。 売上日　 商品CD　 商品名　 個数 2016/7/4　 100 　　りんご　 10 2016/7/4　 100 　　りんご　 5 2016/7/4　 200 　　みかん　 20 2016/7/5　 200 　　みかん　 10 2016/7/5 　200 　　みかん　 15 で考えると SELECT Ｔ０１売上データ.売上日, Ｔ０１売上データ.商品CD , Count(Ｔ０１売上データ.商品名) AS 件数 , Sum(Ｔ０１売上データ.個数) AS 商品数計 FROM Ｔ０１売上データ GROUP BY Ｔ０１売上データ.売上日, Ｔ０１売上データ.商品CD HAVING (((Ｔ０１売上データ.売上日)=[いつの？])); というSQL文で 売上日　 商品CD　 件数　 商品数計 2016/07/04　 100　 2　 　 15 2016/07/04　 200　 1　 　 20 となります。 添付図は上記SQL文のデザインビューです。 リボンのΣ集計アイコンから始めてみては？
クエリデザインで「元テーブル」、「参照テーブル」を追加 クエリの種類で更新クエリを選択 「元テーブル」の「ID」と「参照テーブル」の「ID」を結合 フィールド：登録日 テーブル：元テーブル レコードの更新：[参照テーブル].[登録日] フィールド：退会日 テーブル：元テーブル レコードの更新：[参照テーブル].[退会日] フィールド：登録日 テーブル：参照テーブル レコードの更新： 抽出条件：<=[元テーブル].[利用日] フィールド：退会日 テーブル：参照テーブル レコードの更新： 抽出条件：>=[元テーブル].[利用日] Or Is Null クエリを保存し実行すればできると思います。 バックアップを取ってから実行してください。
No.1です。 > 余り、参考にはなりませんでしたが。 　なるほど。 　それは、、、 > 今は、Access,perlのdbd:mysql,myslを使っていますが。 > 今は、例えばスーパークラスを使ってのインスタンス > でのデータベースを考えているのですが。 とお思いなのに、、、 > > オブジェクト指向データベースを始めたいが、どう言うのが有るのでしょうか。 と質問されたのが原因です。 なので、それを当方に「余り、参考にはなりませんでしたが。」と言われても。。。:-) ちなみに「現状」があるということは、おやりになりたいのは本当にオブジェクト指向データベースの利用ですが？ 「オブジェクト指向言語で既存のデータベースを使用したい」のではなく？ いずれにしろ頑張って下さい。 では。
パラメータが表示されたのは指定したフィールドがないからです。 テーブル名とフィールド名を使用している名前に変更してください。 InStr関数は ある文字列 (string1) の中から指定された文字列 (string2) を検索し、最初に見つかった文字位置を返す文字列処理関数です。 InStr(string1, string2) やっていることはテーブル受付データBの②（住所）の中からテーブルマスタAの③（住所）を検索し 文字列がある位置を出しています。 必要なのは文字列が含まれているデータのみなので条件を>0としています。 試しにInStrの部分をなくしてクエリを実行してみてください。 「テーブルマスタA」のレコード数*「テーブル受付データB」のレコード数のデータが表示されるはずです。
はい良くわかりました。 前回回答と重複する部分がありますが一通り説明します。 念のため、ファイルのバックアップコピーを取ってからにしてください。 １・レポートをデザインビューで開きレポートヘッダーにテキストボックスを配置。 ２・プロパティシートを開き、このコントロールのコントロールソースに、=[いつ受付？] ３・コントロール名を、その他タブにある名前欄から、Txtパラメータ と変更。 ４・書式タブから、可視 を いいえ に変更。 一旦保存します。これからはVBAの記述です。 レポートは閉じてください。 Alt + F11 を押してVBEを立ち上げます。 今後のこともあるので変数の宣言を強制するようにしてください。 メニューのツール→オプション→編集タブの「変数の宣言を強制する」のチェックを入れてください。 http://officetanaka.net/excel/vba/beginner/06.htm Option Explicit が自動的に新しいモジュールに付与されます。 「自動構文チェック」のチェックは外しておいた方がうるさくなくて良いかも？←ご随意に。 メニューから挿入→標準モジュールにてその宣言部に Declare Function apiIsWindowEnabled Lib "user32" _ Alias "IsWindowEnabled" (ByVal hWnd As Long) As Long そのレポートのモジュールには Dim IsPrintOut As Boolean Dim IsPreview As Boolean 上二行は宣言部に Private Sub Report_Activate() IsPreview = True End Sub Private Sub レポートヘッダー_Format(Cancel As Integer, FormatCount As Integer) IsPrintOut = (apiIsWindowEnabled(Me.hWnd) = 0) End Sub Private Sub Report_Close() dim sSql as String '更新クエリのSQL文 on error goto errH sSql="UPDATE テーブルA SET 発送年月日=#" & date & "# WHERE 新規受付日=#" & Me!txtパラメータ & "#" If IsPrintOut Then currentdb.execute ssql,dbfailonerror Else 'MsgBox "プレビューのみです。" End If exit sub errH: debug.print err.number,err.description msgbox err.description & "が発生しました。発送年月日は更新されません。" End Sub 最後にメニューからデバッグ→○▽□のコンパイルを行ってエラーが出ないことを確認。 これで大丈夫かと思います。多分。 前回回答でおバカなことをしていました。すみません。
strPath = "" 　 を rst.close: Set rst = Nothing exit sub の2行に置きかえれば、 そのまま、終了する。 最後の close #1の後にも、 rst.close: Set rst = Nothing と書いておいたほうが、お行儀良いかも。
私の環境(windows10, office2007pro)では、 Application.FileDialog(msoFileDialogFolderPicker) を改行した段階で、 The library which contains this symbol is not referenced by the current... というmsgboxが出てきて、「はい」をクリックすると、 microsoft office 12.0 object libraryの参照設定にチェックが入ります。 ので、VBAエディターの「ツール」「参照設定」で microsoft office 12.0 object library にチェックを入れて、OKを押すと動くようになるのではないかと思います。
レポートを開く前にdcountでレコード件数を調べ レコードがあればレポートを表示、レコードがなければメッセージを表示し終了
サンプルです。 Sub Sample() 　　Dim i As Integer 　　Dim strSQL As String 　　Dim dbs As DAO.Database 　　Dim rst As DAO.Recordset 　　Dim OutData As String 　　Dim kind As String 　　strSQL = "SELECT * from test ORDER BY 種類, 連番" 　　Set dbs = CurrentDb 　　Set rst = dbs.OpenRecordset(strSQL, dbOpenForwardOnly) 　　kind = "" 　　OutData = "" 　　Open "C:\Sample\output.csv" For Output As #1 ' 出力モードで開きます。 　　With rst 　　　　Do While Not .EOF ' レコードが無くなるまで繰り返します。 　　　　　　If !種類 <> kind Then 　　　　　　　　If OutData <> "" Then 　　　　　　　　　　Print #1, Mid(OutData, 2) 　　　　　　　　End If 　　　　　　　　kind = !種類 　　　　　　　　OutData = "" 　　　　　　End If 　　　　　　For i = 0 To .Fields.Count - 1 　　　　　　　　OutData = OutData & "," & .Fields(i) 　　　　　　Next 　　　　　　.MoveNext 　　　　Loop 　　　　If OutData <> "" Then 　　　　　　Print #1, Mid(OutData, 2) 　　　　End If 　　End With 　　Close #1 ' ファイルを閉じます。 End Sub
図示されたようなテーブル設計はよくありません。 もしかしてクロス集計クエリから作成したテーブル？ それとも、他からインポートしたデータ？ 欠点は、 日にち分のフィールドが必要、 月が替わると再度テーブルを作り直す必要がある、 かといって年間（365日）分だけ作るのも不可。フィールド数は最大でも255まで。 集計などの分析が困難など後々泥沼に。。。 http://www.accessdbstudy.net/entry/20140915/p1 商品名 日付　　　　価格 イチゴ　2016/07/01　200 イチゴ　2016/07/03　400 イチゴ　2016/07/04　400 バナナ　2016/07/02　100 バナナ　2016/07/03　150 メロン　2016/07/01　200 メロン　2016/07/02　150 メロン　2016/07/03　100 メロン　2016/07/04　120 メロン　2016/08/01　200 のようなデザインであればクロス集計で、 テーブル名をT1とするとSQL文は、 TRANSFORM First(T1.価格) AS 価格の先頭 SELECT T1.商品名, (DMax("日付","T1","日付 Between #2016/7/1# And #2016/7/31#")-DMin("日付","T1","日付 Between #2016/7/1# And #2016/7/31#")+1)- DCount("日付","T1","日付 Between #2016/7/1# And #2016/7/31# and 商品名='" & 商品名 & "'") AS 売切回数, Int(Avg(T1.[価格])+0.5) AS 平均価格, Max(T1.価格) AS 最大価格 FROM T1 WHERE T1.日付 Between #2016/7/1# And #2016/7/31# GROUP BY T1.商品名 PIVOT Format(T1.日付,"mm/dd"); 　で、 商品名　売切回数　平均価格　最大価格　07/01　07/02　07/03　07/04 イチゴ　　　1　　　　　333　　　400　　200　　　　　　400　　400 バナナ　　　2　　　　　125　　　150　　　　　　100　　150 メロン　　　0　　　　　143　　　200　　200　　 150　　100　　120 のようになります。 新規クエリをSQLビューに切り替えて上記のSQL文を貼り付けてみてください。 平均価格は四捨五入しています。 デザインビューに切り替えられますので確認してみてください。 売切回数を求める部分の出来が良くありません。 レコード数次第では遅くて使い物にならないかも？ご参考まで。
決済日-レートのテーブルに開始日というフィールドを付け加えるのが楽です。
ご存知かもしれませんが 名前の自動修正オプションを設定する https://support.office.com/ja-jp/article/%E5%90% … より引用 『名前の自動修正で修正されない対象 名前の自動修正では以下のものは修正されません。 フォーム、レポート、またはコントロールの名前の変更は追跡されません。 マクロ内またはコード内のテーブル、クエリ、またはフィールドの名前は修正されません。』 ですので残念ながら有りません。 どこでコントロール名が使われているか調べるときに リボンのデータベースツール→データベース構造の解析を選択 必要な個所にチェック・オプションの設定を行って[OK] 印刷プレビューが立ち上がるので、リボンのテキストファイルをクリック 適当な名前で保存しメモ帳などのテキストエディタで開き検索。 としたことはあります。
質問文からは全項目において重複している行はないように見えますが。（販売日、価格が違うので） これぐらいは自分で調べる癖をつけた方がいいですよ。 「Access　重複　削除」で検索すればたくさん出てきます。
私が使っていたのは10年以上前なので忘れてしまっています。 バックアップデータがあれば戻せばいいと思いますが。 こちらで質問してみては？ http://windom.bbs.coocan.jp/?m=listtop
インデックスは残したいレコードのものを選んだグループ化したリストを作り、本番側と結びつけ、グループ化したインデックス以外のレコードを選び出し削除する。 美しくないね。　これやるんだったら、普通にグループ化して、仮テーブルに書き出して、本番を削除した後、仮テーブルから戻すほうが、良いと思う。
決済日がテーブル名なのかフィールド名なのか紛らわしいのでテーブル名を決済日テーブルとしています。 決済日当日を含まない場合は条件式を変更してください。 DMin("決済日","決済日テーブル","決済日 >= #" & [販売日] & "#")
Columnで表示するとか http://tsware.jp/tips/tips_360.htm Dlookupで表示するとか http://www.accessclub.jp/samplefile/samplefile_1 …
こんな風では？ Function myMin(ParamArray aryX() As Variant) As Variant Dim v As Variant For Each v In aryX If IsEmpty(myMin) Or IsNull(myMin) Or v < myMin Then myMin = v End If Next End Function クエリでは 最小値:mymin([A商店価格],[B商店価格],[C商店価格])*1
参考に。 Accessでのテーブルのエクスポート定義 http://waji-mart.com/homeandabroad/access%E3%81% …
Right("000000" & [項目1],6)
更新クエリを作成しマクロまたはVBAで実行。 http://www.feedsoft.net/access/guide-query/guide … http://hamachan.info/win7/Access/message_d.html
より高い知識が必要ですね。 時間とはシリアル値で管理されているのはご存知ですか？ ま、それはともかく発想を変えてみましょう。 私なら登録時に、開始時間と終了時間から、勤務時間と休憩時間と時間外とを計算し、それぞれ登録しますね。 その方が楽ですよ。 時間も時間と分を分けて計算した方が分かりやすいです。
いまいち、何をされたいのかがよくわかりませんが、追加クエリで解決できるのではないかと思われます。
回答の通り、抽出したファイルからの1行を、更にforで別ファイルを1行ずつ読んで(抽出したファイルから1行ずつ読むのと同様)、ifで比較ということです。 ただ、そういえばと思い出したんですが、findstr(回答のサイトにあります)を使えば、別ファイルを1行ずつ読む必要はないかもです。 比較はifではなくfindstrが行うことになるので、あったかなかったかはfindstrの結果から判断することになると思います。
こちらが関係しているかもしれません。”#”をやめて試してみてください。 https://support.microsoft.com/ja-jp/kb/826763
無いでしょ。 accessはデータベースですからね。 無いと思うけどなぁ。
普通に作成できたので私にはこれ以上はわからないですね。 あやしいのはリレーションですかね？ コピーを取ってからリレーションを削除して変化があるか試してみるかですが。 参考までに 作成した設定などを載せておきます。 コンボボックスの名前は大分類、中分類、小分類として作成しています。 「大分類」 値集合ソース：SELECT DISTINCT 支店 FROM 支店工場テーブル; 値集合タイプ：テーブル/クエリ 連結列：1 「中分類」 値集合ソース：SELECT DISTINCT 支店工場テーブル.工場 FROM 支店工場テーブル WHERE 支店工場テーブル.支店=[大分類]; 値集合タイプ：テーブル/クエリ 連結列：1 「小分類」 値集合ソース：SELECT DISTINCT 支店工場テーブル.都道府県 FROM 支店工場テーブル WHERE 支店工場テーブル.支店=[大分類] AND 支店工場テーブル.工場=[中分類]; 値集合タイプ：テーブル/クエリ 連結列：1 Private Sub 中分類_Enter() 中分類.Requery End Sub Private Sub 小分類_Enter() 小分類.Requery End Sub
access Microsoft Web Browser でGoogleと幸せになれるかと。 https://www.google.co.jp/search?q=access+Microso … から http://tsware.jp/tips/tips_207.htm などなど。 フォームにコントロールを配置します。 フォームの読み込み時イベントには Private Sub Form_Load Me!WebBrowserコントロール名.Navigate2 "about:blank" End Sub として白紙状態で開くようにしておきます。 何かのイベントで（たとえばコマンドボタンとか何処かのクリック時など） Me!WebBrowserコントロール名.Navigate2 "C:\・・・・・\ほにゃ.html" とすれば、ほにゃ.htmlが表示されます。 >htmlをフォームとして扱いたい ←意味を取り違えていたらご勘弁を。
excelでは無理だと思います。 最初だけです。動くのはです。 データの件数が僅か65536を越えたら動きません。 Accessなら、動きます。 最初から動かない物を作っても仕方無いです。 普通にAccessの集計クエリーでサクサクと作れますよ。 作る方法としては、 1. userのテーブルを作る 　user_id テキスト型 　user_name テキスト型 2. profitのテーブルを作る 　id auto_number 　user_id テキストの型 　profit_date テキストの型 　profit　数値の型 　date_year テキストの型 3. userとprofitのテーブルのリレーションを作る 　userのuser_idとprofitのuser_idを一対多で参照整合性を作る 4. userフォームをuserテーブルを元にデータシートビューを作る 5. profitフォームをprofitテーブルを元にデータシートビューを作る 6. userフォームを使ってuserのマスターを作る 7. profitのフォームは下記の様に作る 　idの入力は自動入力なので使用不可にする 　user_nameはuser_idを入力すると自動入力なので使用不可にする 　profit_dateは定型入力で000000;0;とする 　また、profit_dateは自動タブとする。 　 　この様な設定で、user_idとprofit_dateとprofitを入力するだけになる。 　profit_dateは、数値6桁を入力すると自動的に次の項目に飛びます。 　profit_dateはyymmddになります。 8. 年間売上の作成は、クエリーを二つ作ります。 　profitのdate_yearは、何もデータは入っていないのでこれを作ります。 　更新クエリーで、left([profit_date],2)で更新します。 9. 2番目のクエリーは、集計クエリーです。 　SELECT profit.date_year, profit.user_id, user.user_name, Sum(profit.profiit) A　S profiitの合計 　FROM [user] INNER JOIN profit ON user.user_id = profit.user_id 　GROUP BY profit.date_year, profit.user_id, user.user_name 　HAVING (((profit.date_year)="16")) 　ORDER BY profit.user_id; 　ここでは、"16"の所で年を示しています。この条件を変えるだけです。 10. 操作性を高めるためには、マクロを用意して二つのクエリー入れて置くと良い。 11. なお、これらをまとめてswitchboardに入れて置くと良いでしょう。 以上となります。 本来ならば、サンプルをアップしたい所ですが方法が分かりませんので。
ソフトを使うよりエクセルが一番いいですよ。 一番上の段に必要な項目を一つづつ入力して、左に1から番号を入力する。（簡単な方法がありますが初心者のようなので省きます） ダイレクトメール希望の人には○希望しない人には×印でいいでしょう。 ある程度入力したら一番上の段にデータのソートをつける。そうすると検索する項目に該当する人だけが画面上に出てきます。 この方法ならワードの差し込み印刷でダイレクトメールやはがきなど簡単に作成できます。 エクセルの本でもわかると思いますが。つまづいたらまた質問してください。
対象とする日付＋１日 未満をDmaxのCriteriaに指定します。 質問の例では、 Dmax("日時フィールド" ,"テーブル名","日時フィールド<#2016/5/30# +1")
fixedDateRange 固定された日付範囲かな？ timeOfDayStart [0..1] 開始時刻かな？ [0..1] は UML でいうところの多重度のことかな。
初めに言っておくと、phpMyAdminはDBメンテナンスをするためのツールであり、本来、運用で使うものではありません。 そういった要望があるならば、希望する動作をするWebページを用意しなければなりません。 決まった日時に定期的に行いたいならば、cronなどのスケジューラ―でスクリプトを実行する、という形なども取れるでしょう。 また、Webページで実装する場合、ローカルに存在するファイルを選択して処理する、という流れものでは、Webページを構成するHTMLおよびセキュリティの特性上、予めファイルを指定することはできません。 そういうものを望むならば、予めサーバに、対象ファイルをアップロードするなどという作業が必要になります。 Accessの利用を避けられないようですから、どうしても手動作業が必要になり、なんでも自動化というわけにはいきません。 より単純、より簡略化を望むならば、やはりAccessの利用を撤廃した運用を考えるべきです。
同じような質問がありますのでこちらを参考に http://oshiete.goo.ne.jp/qa/7918893.html エクスポートを2回実行すればできます。 「Access エクスポート VBA」や「Access エクスポート マクロ」などで検索すれば いろいろ見つかると思いますのでそちらも参考になると思います。
それってどうしてもSQL側でやらないとだめなの？ ふつうは受け取った側が前後のデータの収納状態をみて 表示したり、しなかったりするもんだと思いますが
Excelなどにある「マクロの記録」のことであればありません。 http://oshiete.goo.ne.jp/qa/4382941.html マクロを作成するなら「作成」タブにマクロがあります。 https://support.office.com/ja-jp/article/%E3%83% …
たしかレコードのコピーって、追加クエリ以外でもできたと思います。 でも、望む結果になって良かったですね。
今は列見出しが商品IDになってると思います。そのフィールド名は変更できますので、そこを商品名にしてみてください。 おそらく、それでいけると思います。
途中から失礼します。 『計算で求められるものはテーブルに保存しない』のが原則かと思います。 テーブルに保存した場合には現時点での年齢を求めるために 更新クエリを毎回行わねばなりません。 なので、 テーブルからは年齢フィールドは削除し、クエリに演算フィールドを設定します。 テーブル１が ID　　　　オートナンバー型 氏名　　　テキスト型 生年月日　日付時刻型 ・・・ のデザインで ID　氏名　　生年月日 1　ポチ　　2006/04/01 2　トラ　　2010/10/10 のようなデータが入っているとします。 クエリを新規作成して添付図のようにします。（読めるかな） デザイングリッドの、年齢:DateDiff("yyyy",・・・・は画面スペース上途中で切れていますので 年齢: DateDiff("yyyy",[生年月日],Date())+(Format([生年月日],"mmdd")>Format(Date(),"mmdd")) にします。 『才』を入れた状態にしたいのなら 年齢フィールドのどこかで右クリックしプロパティを表示させ 書式欄に、0\才 とします。 このクエリをフォームのレコードソースにしてください。 年齢フィールドは数値型のままなので右詰で表示されますし 抽出や平均年齢などの計算もやりやすくなるかと思います。
ヤマ勘レベルです。 一般的なWindows7などでは、Cドライブ直下はUACの制限を受けます。 メモ帳でCドライブ直下にファイルを保存しようとするとアクセスが拒否されたり、 エクスプローラでファイルをコピーしようとするとUACによる確認が求められます。 Accessの場合はmdb/accdb ファイルのある場所にロック情報ファイル ldb/laccdb が 自動的に作成されますが、これがUACによって制限されているのでは？ 問題切り分けのためにテーブル一個だけのmdbをCドライブ直下に置いて 検証してみては？ ただ、だとすると、 >ローカルドライブ（Cドライブ）にコピーして この時に何もメッセージが出なかったのか、 どうやってコピーしたのだろう？と気になります。
2007 以降なら VBA などを使用しなくても プロパティの設定だけで簡単に表示できます。 エラー処理も必要ありません。 以下などが参考になるでしょう。 イメージ コントロールを使用して、フォームに画像を表示する http://answers.microsoft.com/ja-jp/office/wiki/o … AC2007以降の帳票フォームで画像表示 http://hatenachips.blog34.fc2.com/blog-entry-362 … の 画像ファイル名のみ格納してイメージコントロールで表示する方法 あたり。
> (1) AccessデータベースからMySQLへの変換 > (2) ローカル環境で設置済みのphpMyAdminで、SQL文を有したSQL > ファイルを作成する > (3) サーバで、phpMyAdminを使用してエクスポートしたSQLファイ > ルをインポートする。 えと、普通、データの登録・変更・削除が必要になるならば、それを管理者用のWebページとして構成して、Webですべて完結させるものですが。 DBが2つあっては、どれが反映すべきデータが分かりませんよね。 面倒だったら、Accessを撤廃し、phpMyAdminの使い方をレクチャーすればいいんじゃないですかね。 しかし、それでシステムが破壊されても文句言えません。 本来、公開すべきでないものを公開するわけですから。 せっかく一旦はデータを移行したはずなのに、ローカル環境のAccessというとても閉鎖的な環境でデータの更新をすること自体が間違いだと思います。
パソコン（エクセルも同じ）は、まじめで間違いをしないものですが あいまいな計算は出来ません。 シートがどのようなものか不明ですが どこかに 新部署名　　　旧部署名 財務経理部部　　財務部 ・・・・ 元データ 部署名　旧部署名　人員 とあったら 旧部署名に =IF(COUNTIF(新部署名の範囲,A2),VLOOKUP(B2,新旧部署名の範囲,2,FALSE),A2) と云ったようにな関数を旧部署名の列に入れて、旧部署名を一致させる必要があります。
runtimeではできません。
仕組みが違うと思うけど、、、update-anywhere configuration　みたいなことがやりたいのかな？ http://froebe.net/blog/wp-content/uploads/2013/0 … レファレンスのｐ48（pdfのｐ56）あたりから書いてあるような気がします。 日本語だとV10のレファレンスが見つからないけど、ｖ8でも同じようなことが書いてあるみたいです。 ftp://public.dhe.ibm.com/ps/products/db2/info/vr … ｐ55～ いくらするのかわからないけど、このような方法もあるみたいです。 http://www.ibm.com/developerworks/data/library/t … 全くの素人なんで、大いなる勘違い等ございましたらご容赦ください。
頻度は高くないと思われますので（たぶん年に一・二回？） エクセル出力用クエリ select * from 名簿テーブル where 登録年月日 <= #2016/4/1# 削除用クエリ delete * from 名簿テーブル where 登録年月日 <= #2016/4/1# を作っておいて（抽出条件は作業のつど適宜変更） docmd.TransferSpreadsheet acExport,acSpreadsheetTypeExcel12Xml,"エクセル出力用クエリ","D:\" & format (now,"yyyymmdd_hhnnss") & ".xlsx",true でDドライブなどに出力し、 docmd.openquery "削除用クエリ" で削除。 とかでは？ なお、 どのようなデータが入るのか不明ですが、 フィールド名　データ型　サイズ ID　　　　　　長整数型　　　8 名前　　　　　テキスト　　255 住所　　　　　テキスト　　255 電話　　　　　テキスト　　　40 メール　　　　テキスト　　255 登録年月日　　日付時刻　　　8 備考　　　　　　　メモ　　1000 で各フィールドに常に目いっぱいデータを押し込むとしても Accessのサイズの上限を安全マージンをとって1.5GBと仮定します。 8+500+500+80+500+8+2000 = 3596 1.5*1024*1024*1024/3596 = 447890. 常に目いっぱいの場合でも４４万件、一般的なケースでは１００万件でも まだ余裕がありそうですので、この処理自体を考えなくても大丈夫な気がします。
２つの方法で 金額部分は数値であるとします なお、希望の最終形表示での、"金額" ･･･ 同じ文字列のフィールドは作成できないので 金額1、金額2 ･･･ １）DLookup を使う SELECT 販売店名, 品名１, DLookup("金額","テーブル１","販売店名='" & 販売店名 & "' AND 品名='" & 品名１ & "'") AS 金額１, 品名２, DLookup("金額","テーブル１","販売店名='" & 販売店名 & "' AND 品名='" & 品名２ & "'") AS 金額２, 品名３, DLookup("金額","テーブル１","販売店名='" & 販売店名 & "' AND 品名='" & 品名３ & "'") AS 金額３, 品名４, DLookup("金額","テーブル１","販売店名='" & 販売店名 & "' AND 品名='" & 品名４ & "'") AS 金額４ FROM テーブル２; ２）クロス集計を使う 以下内容で、クエリ ★★ を作っておいて SELECT 1 AS 順, 販売店名, 品名１ AS 品名 FROM テーブル２ WHERE 品名１ Is Not Null UNION ALL SELECT 2, 販売店名, 品名２ FROM テーブル２ WHERE 品名２ Is Not Null UNION ALL SELECT 3, 販売店名, 品名３ FROM テーブル２ WHERE 品名３ Is Not Null UNION ALL SELECT 4, 販売店名, 品名４ FROM テーブル２ WHERE 品名４ Is Not Null; 以下のクロス集計で最終形にする TRANSFORM First(IIF(S=1,Q2.品名,Q2.金額)) AS 値 SELECT Q1.販売店名 FROM ( SELECT 1 AS S, * FROM ★★ UNION ALL SELECT 2, * FROM ★★) AS Q1 INNER JOIN テーブル１ AS Q2 ON Q1.販売店名=Q2.販売店名 AND Q1.品名=Q2.品名 GROUP BY Q1.販売店名 PIVOT IIF(S=1,'品名','金額') & Q1.順 IN ('品名1','金額1','品名2','金額2','品名3','金額3','品名4','金額4'); 余談）テーブル１だけからでも以下の様な表示は可能 どのように表示されるのかは、実際にやってみてください TRANSFORM Sum(金額) AS 値 SELECT 販売店名, Sum(金額) AS 計 FROM ( SELECT 1 AS T, 販売店名, 品名, 金額 FROM テーブル１ UNION ALL SELECT 2, '合計', 品名, 金額 FROM テーブル１) AS Q1 GROUP BY T, 販売店名 PIVOT 品名;
クロス集計を使ってみてはどうでしょう テーブルの内容がわからないので･･･ 添付図上段のテーブル ★★ があったとします 以下をクエリの SQL ビューに記述して表示してみると、 添付図下段の表示になります TRANSFORM Sum(金額) AS 値 SELECT 摘要, Sum(金額) AS 計 FROM (SELECT 1 AS T, 日付, 摘要, 金額 FROM ★★ UNION ALL SELECT 2, 日付, '合計', 金額 FROM ★★) AS Q1 GROUP BY T, 摘要 PIVOT Format(日付,'yyyy/mm');
Access Runtimは、フォームやレポート、テーブル、クエリー、モジュールの構造やデザインの保存ができないだけで、データベースへのデータの保存・修正・削除は、問題なくできますよ。 ただ、モジュールなどでは、一部制限ができてしまったりすることがありますので、/runtimeのオプションをつけて起動し、チェックされるといいと思いますよ。
Access的なデータベースソフトということであれば、LibreOfficeのBaseがそれにあたるかと思います。 フリーオフィスで検索すると、結構出てくると思いますよ。
休日だけど気力を振り絞ってやってみた。 最初に、テーブル1 のレコードを整理するクエリを作る。 例で説明すれば 2回出てきた "会社A" の金額を合計して 350円となるようにするクエリ。 単純な集計クエリで、会社フィールドをグループ化して金額フィールドを合計してるだけ。 クエリの名前は 「クエリ1」 とした。 以下は SQL で表現。 SELECT [テーブル1].会社, Sum([テーブル1].金額) AS テーブル1金額 FROM テーブル1 GROUP BY [テーブル1].会社; テーブル2 にも同じことをするためのクエリを作る。 クエリの名前は 「クエリ2」 とした。 SELECT [テーブル2].会社, Sum([テーブル2].金額) AS テーブル2金額 FROM テーブル2 GROUP BY [テーブル2].会社; 次に、すべての会社名のリストを出力するためのクエリを作成する。 これはユニオン クエリで作成する。テーブル1 とテーブル2 の合体で作ってもいいし、クエリ1 とクエリ2 の合体で作ってもいい。 今回はクエリ1 とクエリ2 の合体で作ってみた。 クエリの名前は 「クエリ3」 とした。 SELECT 会社 FROM クエリ1 UNION SELECT 会社 FROM クエリ2; まだまだ続く。 今度はすべての会社名リストの会社名に対してクエリ1 (基となっているのはテーブル1) の金額をくっつけるクエリを作る。 これは単純な外部結合のクエリで、テーブル1 に存在しない会社の金額は空白で出力される。 クエリの名前は 「クエリ4」 とした。 SELECT [クエリ3].会社, [クエリ1].[テーブル1金額] FROM クエリ3 LEFT JOIN クエリ1 ON [クエリ3].会社 = [クエリ1].会社; 同様に、会社名リストとクエリ2 の金額を対象にした外部結合のクエリを作る。 クエリの名前は 「クエリ5」 とした。 SELECT [クエリ3].会社, [クエリ2].[テーブル2金額] FROM クエリ3 LEFT JOIN クエリ2 ON [クエリ3].会社 = [クエリ2].会社; 最後、クエリ4 とクエリ5 を単純な内部結合で合体し、比較結果を "OK" "NG" で表示するようにしたクエリを作成する。 クエリの名前は 「クエリ6」 ってした。 SELECT [クエリ4].会社, [クエリ4].[テーブル1金額], [クエリ5].[テーブル2金額], IIf([クエリ4]![テーブル1金額]=[クエリ5]![テーブル2金額],"OK","NG") AS 比較結果 FROM クエリ4 INNER JOIN クエリ5 ON [クエリ4].会社 = [クエリ5].会社; クエリ6 がお望みの表になっているかと思う。 もっと少ない素材でできるかもしれないが、それはデータベースの先輩たちに任せます。
No.1です。 つまりVBAでSQLを指定しているのですよね？ そのSQLにFormat関数を仕込みましょう。
チームスピリットの販社に詳細資料や導入事例の要求、場合によってはプレゼンテーション・デモンストレーションを養成したら如何でしょうか。
クエリというのはＳＱＬ文をわかりやすく表示したものです。　（ので、クエリでできないものをＳＱＬであればできるという可能性は少ないのですが、クエリというのはＧＵＩですから、何を具体的にやっているのかなどを文章で説明するのは非常に困難ですので、ドキュメント化しにくいという欠点があります。　また、将来的に他のデータベースに変更する際など、手間がかかるのも問題です。） データベース上ではテーブルの個々のデータの更新はできますが、クエリなどで集計したものや計算したものについては、テーブル上のどのレコードのどの値を変えるかがわからないため更新することができないのが普通です。 質問者様がやりたいことがはっきり見えていないので、正しい回答になるかがよくわからいのですが、 ・件数というのがレコード数なら、集計する前のクエリで掛け率を表示する列を作りそれを合計させる ・件数というのが個々のレコードに入っている何らかの値なら、補正件数みたいな列を作りそこに件数と予想掛け率を掛けた値を入れて置き集計させる などの方法が思いつきます。
SharePoint Online や、SharePoint Online を含んでいる Office 365 E3 などのサービスを購入すれば、Access のデータベースを Web アプリとして公開できるので、Android 等から Web ブラウザでアクセスしてデータの閲覧や編集をすることができます。 とは言え Windows 上の Access 2016 で作りこむ従来型データベースほど細かい事はできません。 フォームのデザインも簡略化されていますし、VBA も使えません。 マクロは実装されていますが、デスクトップ版 Access データベースとはちょっと様子が違います。（慣れてしまえば問題ないでしょうが） SharePoint Online や Office 365 E3 は法人向けの商品ですが個人での購入も可能です。 (私は個人的に私自身、たった一人分のライセンスだけで Office 365 E3 を使っています） とは言え法人向けに特化した管理機能なんかが付いているため、個人で買うにしてもそれなりの管理知識は必要になってしまいますね。 情報は Web や書籍で十分すぎるぐらい出ていますし、サポートは料金に含まれています。
固有名詞なので、オーロラと読むかアウロラと読むかは、アマゾン次第です。で、アマゾンのプレゼンテーションを聞くと、オーロラ。極光の意味でのオーロラの発音でいいと思います。
決して簡単ではありませんが、そう難しくもない、 でもレスが付かない。 私も今のままではレスする気になれません。 というのは、テーブルの仕様に問題あり。 > 数量は～までの数量設定となっております。 これでは、テーブルにある最大の数値 + 1 が来たらお手上げですよね？ 十分大きな数値にしておけばいいじゃないか、と言っても 絶対に起こり得ないとは言えませんから。
【結果クエリ】 SELECT IIf([テーブル名].[種別]='B','A',[テーブル名].[種別]) AS 種別, Sum([テーブル名].[金額]) AS 合計金額 FROM テーブル名 GROUP BY IIf([テーブル名].[種別]='B','A',[テーブル名].[種別]); でいかがでしょうか？ 「テーブル名」は実際の名前に置き換えてください。
やりたいことは「名前と日付を指定し、指定した日に表示する画像のパスを得る」ということですよね？ で、項目※については「指定した日付より小さい物のうちの最大値」ということだと思います。これは複問い合わせにMAXを使うことで行けるように思いますがいかがしょう。 あとnullの考慮ですね。日付指定の無い方の場合、項目※にnullを入れておくのか、最小値を入れておくのかのデータ仕様上の判断ですか。 授業の課題なのかお仕事なのかは分かりませんが、SQL化はご自身でお考えください。 INNER JOINを使う方法もあるのかな？　どうなのかな？ 参考まで。
一つの方法として、、、 クエリをＳＱＬ文にして、ＡＤＯなどで開いて値を求め、セレクト文などで印刷するものを分ける Sub cmdPRT_clicked dim con as adodb.connection dim rst as adodb.recordset Set con = CurrentProject.Connection strSQL = "SELECT * FROM ...." rst.open strSQL,con,adopenkeyset, adlockoptimistic intFiledValue = RST!FIELDxxx rst.close SELECT CASE intFiledValue case < 1 exit sub case > 1000 prtXLS("AA.xls") prtXLS("BB.xls") case else prtXLS("AA.xls") end select end sub sub prtXLS(fileName) ・・・・ end sub などのように。 エラー処理もしていないし、検証もしていないし、スペルミスすらチェックしていません。 実際に作る際には、レコード件数によって、エラー処理等をしないといけなくなる。
追加です。印刷の設定とか、プロパティで確認ができないですか？。 また、最新のドライバーも入手してください。 これ以上は、両面印刷を最近知ったので判りません。
＞カメラでは送り先をSDにすればできますが、本体だとエラーとなります それじゃ、できるところで救済して、そのあとは初期操作（リセット）してそれでもだめなら修理しかない。
＞条件として事前申請がないと旅費精算は受け付けないという事になっています。 社名以外に申請と請求を1：1で結びつけるフィールドが必要です。 それがないなら、「急いで」これを解決することは困難だと思います。 解決法としては、申請ＩＤというユニークなインデックスを表1に作り、表2にもその値を入れておき、それらを結合させることが必要です。 テーブルの結合は、こんな感じでできると思います。 http://ms-access.seesaa.net/article/46193086.html で、それをleft joinにするには、線をクリックして二番目のラジオボタンにチェックを入れてＯＫを押す。 結果的には線が矢印になる（こんな感じ）。　５番目の画像 http://www.feedsoft.net/access/tips/tips111.html　 で、選択クエリにして置き、is not nullを何らかのフィールドに指定すれば、完成です。 http://www.helpforest.com/access/ob_query/ac0500 … これをＳＱＬビューに変更すると、（やたらめったら括弧だらけの）ＳＱＬ文として見ることができます。　ここに、ＳＱＬを張り付けて動作することもありますが、ＡＣＣＥＳＳならではの制限もあり、使いやすいとは言えないかもしれません。
> データーシートビューにおいて、フォームのフィールド名ではなく任意の名前を表示 デザインビューで開き、 目的のフィールドのテキストボックスに付属しているラベルの「標題」プロパティに 表示したい名称を設定してください。
DMZには、直接インターネットからアクセスするサーバーのみを置きます。それ以外のものを置いてはいけません。
検討したわけではありませんが。 ○同じサーバー上で動作させるなら、CPUにかかる負荷は結局一緒ではないか。 　MySQLで100%使っていたとして、PostgreSQLを追加したら、 MySQL50%,PostgreSQL50%とかになるだけかと。 ○別のデータベースになるので、データの転送が必要 　データ型の不一致とかも発生し得る
現在の構造がフロントエンドにはバックエンド側のテーブルへのリンクのみが存在していて、バックエンド側にマスターの仮テーブルがあるなら、TransferSpreadsheetの処理は、バックエンド側で行うべきです。 どうしても、フロント側から行いたいなら、 1.それこそ仮テーブルにいったん格納して 2.バックエンドのマスターテーブルのデータを削除 3.バックエンドのマスターテーブルにインサート 4.仮テーブルのデータを削除 などの手順を取れば、できると思います。 まあ、個人的な経験からするとアクセスのバックエンド分離もユーザー数が多いと、時々不思議なことが起こるから、バックエンドだけでもSQLServerなどの普通のｄｂ（とりあえずexpress でいいから）に更新することを考えておいたほうが良いと思います。
リボン関連はここで。 リボンを最小化・非表示にする http://www.ka-net.org/ribbon/ri06.html
データベースを作る前に、レシートをノートに貼ることをお勧めします。
和暦と西暦の二つのフィールドを設定する必要があるのかな？ クエリのデザイングリッドに新たなフィールドを追加 和暦だよーん:[西暦] とし、Alt + Enter を押して[和暦だよーん]フィールドのプロパティを表示させます。 その書式のところに、ggge\年mm\月dd\日 とすれば今日だと西暦2016/3/5｜和暦だよーん平成28年03月05日 になります。 相互に変更可能ですから二つのフィールドを設定するよりも・・・。 gやmの数はお好みで変更を。
ファイル名を[ ]を括って保存すると上の方に表示されるようになる意味ということであれば、 前の質問で答えていますし答えられています。 （何の意味もない。単にコード順に並んで上位に表示されるだけと回答されている）
こちらの回答でできるのではないでしょうか http://okwave.jp/qa/q1290544.html
小数点以下４桁までなら数値型ではなく通貨型で書式を「標準」にすると３桁区切りの小数点以下は２桁の表示になるはずです。
Cancel=trueと言う事は、データのチェックをしようとしている訳です よね。普通は、データの整合性の観点からエラーチェックを主体にして この文脈が有ります。だから、不用意にこれを使うとデータ更新が出来 ない事になります。 Cancel=trueの条件に合致すると当然にレコードは保存されません。こ の場合に保存をする方法と言うのは、エスケープキーを打鍵してこのレ コードの保存を断念するだけです。 だって、プログラムの方で有る条件を満たしていると言う事で Cancel=trueになっているのですから。具体的にこのCancel=Trueを指定 しての文脈と言うのは。 例えば、コードとして性別と言うのが有って男性を1に、女性を2に設定 をしている場合に有るユーザーが誤って3を打鍵をした時にここで Cancel=trueにして誤ったレコードが保存されない様にガードを掛けま す。 ですから、きちんとAccessの方は動作をしているのです。だから、それ が期待をした動作で無いと言うので有れば。そもそものCancel=trueに した時の条件文に問題が有ると言う事です。 これ以上は回答は出来ません。と言うのは、何も明らかにはなっていな いからです。具体的なデータが有れば一歩踏み込んだ回答は出来ます が。 頑張って下さい。
>配列の数を100と返すのでは無く、きちんとここでは3を返す様な関数と言うのはあるのでしょうか。 VBAには配列が空かどうか一括で調べる関数はありませんので、自作するしかありません。 以下の様な具合で、取得するといいでしょう。 Dim a(100) As String a(0) = "4555" a(1) = "3333" a(2) = "eee" '中身が空でない配列の数を取得 For Each b In a If b <> "" Then i = i + 1 Next Msgbox i
> 「サポートしてないか壊れているかデコードできてない」というエラーが表示されて開くことができません。 確かに、拡張子が PDF のファイルはできるでしょうが、 > DoCmd.OutputTo acOutputReport, strReportName, acFormatXLS, strFileName & ".pdf", True 出力ファイルの形式に エクセル（acFormatXLS）を指定していますから 中身は Excel のブックです。 とりあえず acFormatPDF を指定して動作確認してください。 「excelインポート」という名前のテーブルのレコード数分、PDF を作成、 ということでよろしいでしょうか？ 同じ「お名前」「特集」の レコードは存在しない？
Microsoft Access データベース エンジン 2010 再頒布可能コンポーネント http://www.microsoft.com/ja-jp/download/details. … でしょうか？ 『詳細』や『インストール方法』などをご確認ください。
たとえばこんな感じ 文字列結合の仕方はSQLによって微妙にことなるので、 ご利用のSQLの文字列関数のマニュアルを参照ください create table table_a(No int,住所 VARCHAR(100)); insert into table_a values(1,'神奈川県川崎市宮前1-1-1'),(2,'神奈川県横浜市都筑区2-2-2'),(3,'東京都江東区門前仲町3-3-3'); create table table_b(市区 VARCHAR(100),ランク VARCHAR(10)); insert into table_b values('川崎市','A'),('横浜市','B'),('江東区','C'); SELECT No,住所,ランク FROM table_a as a LEFT JOIN table_b as b ON a.住所 LIKE CONCAT('%',市区,'%'); ただし、テーブルBの市区のカラムは実用に耐えないと思います 同名の市区町村は多数あるので、検索が競合します https://ja.wikipedia.org/wiki/%E5%90%8C%E4%B8%80 …
ロールフォワードは、どういうケースでも同一ですので、その認識は正しいです。 どういうケースであっても、トランザクションの同期点ログの書き込みが完了している場合は、ロールフォワードで、そうでない場合は、ロールバックすることになります。 「トランザクション処理中の障害」という記述の「処理中」というのは、普通は「処理開始から同期点ログ書き込み完了までの間」という意味なので、 ＞教科書には、データベースの障害には記憶媒体などの物理障害とトランザクション処理中の障害とがあり、前者にはロールフォワード、後者にはロールバックを適用する という教科書は正しいです。同期点ログが書き込まれてしまったら、まだデータファイルにデータが書き込まれていなくてもトランザクション処理は完了したことになります。
T_ボランティア日に「メッセージ」というフィールドを追加。 データ型はYESNO型で作成します。 メッセージを渡した場合はチェックをすれば誰にいつ渡したのかが分かります。 渡す日がボランティア日と違う場合はメッセージのフィールドを日付型にしてください。（その場合はこの後の抽出条件を変更してください） T_ボランティア日の「メッセージ」にチェックがある人がメッセージを渡した人になりますのでこのデータを抽出。（クエリ１とします） T_個人とクエリ１を不一致クエリを使いクエリ１に存在しない人を表示すればメッセージを渡してない人のみが抽出できます。 http://www.microsoft-access.net/start/query-7.html
ちょっと微妙かなぁ・・・・ SELECT * FROM hoge WHERE user_id IN ( SELECT t1.user_id FROM hoge as t1 INNER JOIN hoge as t2 ON 1 AND t1.user_id=t2.user_id AND t1.email_address=t2.email_address AND t2.type=1 GROUP BY user_id HAVING COUNT(*)=1 ); みたいな感じ？
いつも、アンインストールするときは そのアプリを長押しすると アンインストール削除と出てくるので それをタップして、けしています 設定のボタンから したの方にある アプリケーションを選んでも 削除アンインストールするのか 選べますよー( ´∀｀)
きょうび先生のチェックも厳しいので、 こういう掲示板で質問して回答をそのままコピペして提出すると「不可」になる 可能性も高いですがよろしいですか？ (自分なりに理解した上で、書き直した方がよいかと・・・) ＞(1) 大石蔵子さんの貸し出しの状況の一覧（KASIDASI表から作成） SELECT K.KNO,K.GAKUSEINO,K.TOSYONO,K.KIGEN,K.HENKYAKU FROM KASIDASI AS K INNER JOIN GAKUSEI AS G ON G.GAKUSEINO=K.GAKUSEINO AND G.SIMEI='大石蔵子'; ＞(2) まだ，未返却の貸し出しの一覧（KASIDASI表から作成） SELECT * FROM KASIDASI WHERE HENKYAKU=0; ＞(3) 期限が12月の貸し出しの一覧（KASIDASI表から作成） SELECT * FROM KASIDASI WHERE KIGEN BETWEEN '2014-12-01' AND '2014-12-31'; ※ただし、別の年の12月も拾いたいならやりかたは異なる ＞(4) 未返却かつ期限が12月の貸し出しの一覧（KASIDASI表から作成） SELECT * FROM KASIDASI WHERE KIGEN BETWEEN '2014-12-01' AND '2014-12-31' AND HENKYAKU=0; >(5) 未返却貸し出しで，貸出期限が古い順に出力するSQL（KASIDASI表から作成） SELECT * FROM KASIDASI WHERE HENKYAKU =0 ORDER BY KIGEN ASC >(6) KASIDASI表を基準に3つの表を内部結合し， VKASIDASIという仮想表を作成する． CREATE VIEW VKASIDASI AS SELECT K.KNO,K.GAKUSEINO,G.SIMEI,K.TOSYONO,T.SYOMEI,T.TYOSYA,K.KIGEN,K.HENKYAKU FROM KASIDASI AS K INNER JOIN GAKUSEI AS G ON K.GAKUSEINO=G.GAKUSEINO INNER JOIN TOSYO AS T ON K.TOSYONO=T.TOSYONO; >(7) 各図書の貸し出し回数の一覧を表示するSQL文 SELECT T.TOSYONO,T.SYOMEI,T.TYOSYA,SUB.COUNT AS COUNT FROM TOSYO AS T LEFT JOIN ( SELECT TOSYONO,COUNT(*) AS COUNT FROM KASIDASI GROUP BY TOSYONO ) AS SUB ON T.TOSYONO=SUB.TOSYONO; ※１回も借りられていないものをどうするかによる ＞(8) 各学生の貸し出し回数と一番遅い貸し出し期限を表示するSQL文 （１回も貸し出していない学生は表示しなくてよい） SELECT G.GAKUSEINO,G.SIMEI,SUB.COUNT,SUB.LATE_KIGEN FROM GAKUSEI AS G INNER JOIN ( SELECT GAKUSEINO,COUNT(*) AS COUNT,MAX(KIGEN) AS LATE_KIGEN FROM KASIDASI GROUP BY GAKUSEINO) AS SUB ON G.GAKUSEINO=SUB.GAKUSEINO;
一般的にはleft joinしてnullをチェック select A.* from A left join B on A.A1=B.A1 and A.A2=B.A2 and A.A3=B.A3 where B.A1 is null
ああ、まさに「email_addressの種類が3以上あるレコードを抽出したい」のですね 前の回答は全てがユニークなデータで構成されたレコードでした SELECT * FROM hoge WHERE user_id IN ( SELECT user_id FROM hoge GROUP BY user_id HAVING count( DISTINCT email_address ) >=3 ); サブクエリの最後の数字が○○個以上の部分になります
>not exists 以前はexists超高速神話がありましたねぇ・・・ 今はそうでもないんじゃないかと思います インデックスを設定して、テストしてみたのですが どちらのSQLも同じ効率のようです ちょっと調べたらこんなところがヒットしました http://kkoudev.github.io/blog/2013/09/14/sql/ left joinしてnullチェックの方が優勢との見方をしているようです。
小難しいことは考えず、楽しく行こうぜ。
＞正直申し上げて「正規のレプリケーション」の意味を理解できません。 むしろそれがびっくり！ リプリケーションというのはMySQLの機能の一つであり DBやテーブルを固めておくって解凍することは そもそも「なんちゃってリプリケーション」ですね https://dev.mysql.com/doc/refman/5.6/ja/replicat … 経験則として・・・ MySQLの地位を向上させた3.23xのテーブルは4.0xや4.1xにそのまま もっていっても読めないケースが多かったです MySQLの中のバージョンでさえそうなんですからDBが違えば 読めないケースがあっても仕方ないでしょう。 #2でも書きましたが原則テキストSQLに落としたうえで、 新DB側で読み込むのがトラブルを減らす手段だと思います。
FileMaker で聞くのが一番です 何をするかで変わるかもしれません（今までと違う作り方）　 私は安い方で十分使えてます それと買う場合　相談後にFileMakerの直販をお勧めします　説明と違う場合交換もして貰えます 登録はしなければアップデートも出来ないので直販の方が便利です　ポイントは付きませんが(T.T)
そのソフトを持っていませんので詳しい説明はできません。 もしPDFに書き出しできないのなら 「スクリーンショット」をとってJPEGにする方法があります。 それをコンビニでプリント。 住所録をプリントして読むくらいだったらそれでも使えます。
こちらが参考になるでしょう。 http://www.accessclub.jp/bbs6/0008/das1904.html おまけ、上記を参考にした 一応動作するコード。 Dim strSQL As String strSQL = "INSERT INTO table1 " & _ 　　 "SELECT Q.* " & _ 　　 "FROM [" & _ 　　 "TRANSFORM Count(収穫.ID) AS IDのカウント " & _ 　　 "SELECT 収穫.ID " & _ 　　 "FROM サイズ INNER JOIN 収穫 ON サイズ.ID=収穫.サイズ " & _ 　　 "GROUP BY 収穫.ID " & _ 　　 "PIVOT サイズ.名前 " & _ 　　 "IN ('大','中','小')" & _ 　　 "]. As Q" Debug.Print strSQL CurrentDb.Execute strSQL
あ・・・、転記ミス SELECT FID FROM 生徒テーブル GROUP BY FID HAVING SUM(性別='女')=0
ごめんなさい。ちょっとニュアンスが違いました。 条件にヒットしたレコードに対して更新を行うですね。
完全なCMOSクリアをしてみる。
そのテーブルだけのファイルをファイルサーバーに置かせてもらうのが一番かと思います。 これについては社内の管理者と相談してください。 『待ち受け画面』とはスクリーンセーバーのこと？ OSが不明ですが、そのPCでスクリーンセーバーからの復帰時にパスワード要求は変更せずに 電源設定で http://qa.support.sony.jp/solution/S090714106469 … 休止状態不可 スリープ不可 ハードディスクの電源断なし で改善されませんかね。 コントロールパネル→ネットワークアダプタの電源の管理から 電力の節約のために・・・のチェックを外す。 このデバイスで、・・・にはチェックを入れる。 も必要かも？ PS. ファイルを共有していると破損・誤削除などへの対応も必要になってくるかと思います。
すみません。　Exit Function消し忘れました。
PHPのぬるさが許せるかどうかでしょうね ある意味javascriptのぬるさに通じるものがあるので WEBプログラムとの相性がよいのですが・・・ どの規模で開発をしたいかによって選択肢は大きくかわってくると思います 個人レベルならphpがちょうどいいと思いますよ
> 実はこの一覧は元のデータベースから毎日自動更新されてしまうのでできればシートを開いた時に毎回自動的に置換されるようにマクロとして組みたいのです。 No.1 さんの回答の動作を「マクロの記録」でコード化し、 シートを開いた時（ブックを開いた時？ シートがアクティブになった時？）のイベントで、それを呼び出せばよろしいのでは？
お役に立てたなら、嬉しく思います。 私もそんなにスキルが高い訳ではないし、学歴も低いし、ベンダー資格もなくて、現場で叩き上げた経験だけで、私の意見は参考程度になれば幸いなくらいです。 二、三ヶ月前のOracleのデ－タがAccessにインポートされている理由についてのお尋ねについて、私が思うことを、もうします。 私が経験したいくつかの会社で予実管理をする場合に、accessなど基幹DB とは別の媒体で分析をすることで、基幹DBに負荷を掛けず影響も与えずに新たな情報分析デ－タを生み出し将来予測に役立てていました。なので、せっかくインポートされた情報資産を活用なさると良いかと思いました。
もし、ご興味があったら、次のプログラムコ－ドをご利用下さい。 私が実際に、会社で利用中なので、動くはずです。 Dim objExcel Set objExcel = CreateObject("Excel.Application") objExcel.Visible = True objExcel.Workbooks.Open "c:\1\業務内容.XLS" Set objExcel = Nothing 私は、拡張子のチェックをしたり、ファイル存在チェックをしたり、していますが、必ず存在していて必ずエクセルなら、このまま、ファイル名だけを動的に差し替えるように組み込めば、目的を果たすプログラムを作ることが出来ると思います。
法令を順守できること。 小笠原流派のマナーを体得してること。
№5は誤り。訂正します。 ．　A　　　B　　　C　　　D　　　E　　　F　　　G　　　H　　　I　　　J　　　K 1|　キー　　　　　　　　　　 2|　H1-A　H1-1　H1-2　　　　　　　　D1-3　D1-4　D1-5　D1-6　D1-7　D1-8 3|　H1-A　H1-3　H1-4　D1-1　D1-2　D1-3　　　　 D1-5　　　　 D1-7　D1-8 4|　H1-A　H1-5　H1-6　D1-1　D1-2　D1-3　D1-4　D1-5　D1-6　D1-7　D1-8 5|　H2-A　H2-1　H2-2　　　　 D1-2　D1-3　D1-4　D1-5　　　　　　　　D1-8 6|　H3-A　H3-1　H3-2　　　　　　　　 7|　H3-A　H3-3　H3-4　　　　 D1-2　D1-3　D1-4　D1-5　D1-6　D1-7　D1-8 1. 以下を入力します。 ・L2セルには、=IF(A2<>A3,1,0) ・M2セルには、=IF(D2<>""," "&D2,"")&IF(E2<>""," "&E2,"")&IF(F2<>""," "&F2,"")&IF(G2<>""," "&G2,"")&IF(H2<>""," "&H2,"")&IF(I2<>""," "&I2,"")&IF(J2<>""," "&J2,"")&IF(K2<>""," "&K2,"") ・N2セルには、=IF(A2=A1,N1&M2,A2&M2) 2. L～N列をそのまま7行（または、500行）下へコピーします。 3. 1行目全体を選択し、[データ][フィルタ][オートフィルタ]を実行しプルダウンメニューを生成します。 4. L列のプルダウンメニューから「1」を選択すると、N列に希望の表示が実現しコピーして貼り付けると以下のようになります。 H1-A D1-3 D1-4 D1-5 D1-6 D1-7 D1-8 D1-1 D1-2 D1-3 D1-5 D1-7 D1-8 D1-1 D1-2 D1-3 D1-4 D1-5 D1-6 D1-7 D1-8 H2-A D1-2 D1-3 D1-4 D1-5 D1-8 H3-A D1-2 D1-3 D1-4 D1-5 D1-6 D1-7 D1-8
では、フォームのコマンドボタンのクリック時の場合です。 Private Sub CMDテスト_Click() Dim RPname As String RPname = "印刷レポート" 'レポート名を指定 DoCmd.OpenReport RPname, acViewDesign, , , acHidden Reports(RPname).Controls("承認").Visible = False '承認ラベルを不可視に DoCmd.OpenReport RPname, acViewPreview, , , acWindowNormal '印刷プレビュー '↑印刷プレビューでみて問題なかったら 'レポートは保存しないで閉じます '本番では印刷プレビュー用の行はシングルクォート'でコメントアウトして '下記２行のシングルクォートを外して実行 'DoCmd.OpenReport RPname, acViewNormal '印刷開始 'DoCmd.Close acReport, RPname, acSaveNo '保存しないで閉じます End Sub
ANo.2です。 > 装置も完全なスタンドアローンタイプで、外部には一切情報が出せていない状態ですが > パトライトで稼働中、エラー、警報は出しています。 であれば、シグナルタワーの出力を拝借するのが一番無難そうですね…と言うより、それしかすぐにはできなさそうです。キヤノンに装置の改造を頼めば好きな警報出力が出せるでしょうけども、とんでもない見積もり金額が出てくるか、あるいはできませんと断られるか。 無線LANでDIOを飛ばせる製品があるんで、それを使ってシグナルタワー出力を飛ばすのが最も安直では？PCで受けて画面に出すか、そこからさらにタッチパネルに送り出す形です。 http://www.lifetron.jp/prowebWI02.htm#01 フロアをまたぐのは無線では無理で、フロア間は有線にせざるを得ませんが、それくらいは工場だったら既存のネットワークケーブルが走っていそうな気がしますけど、どうでしょう。
文字通りの再送信なら、前回送信時の情報は含まれません。 相手が自分宛にCCしたものを転送する場合では、転送の仕方によっては、前回の情報が含まれますが、もちろんねつ造可能です。
下準備。 T1workテーブルを作成します。クエリ２のフィールドにIDフィールドを加えます。 ID　　　長整数型 順番, 出荷日, 客先, 依頼№, 品番, 製品名, ロット№, 本日出荷数, 単価, 金額, 返却・修正, 完納, 完納時出荷数, 計算上金額 ID以外のデータ型やフィールドサイズはオリジナルと合わせてください。 主キーの設定やインデックスの設定は不要です。 ※返却・修正フィールドの・中黒はAccessが誤動作しますから止めておくべきです。 下記コードではそのままにしています。 また、機種依存文字の№も同様です。 T1workテーブルを元にレポートを作成します。並び順にはIDを指定。 >現在、そのクエリの結果をフォームにし印刷しています。 フォームにコマンドボタンを置いて印刷するようにします。 Private Sub CMDテスト_Click() 　　Const rowNum As Long = 8 '←ひと区切りの行（レコード）数をここで指定 　　Dim DB As Database 　　Dim RsFrom As DAO.Recordset, RsTo As DAO.Recordset 　　Dim i As Long, j As Long, smallSum As Double 　　　　 　　Set DB = CurrentDb 　　DB.Execute "DELETE * FROM T1work" '既存レコード消去 　　Set RsFrom = Me.Recordset.Clone 　　Set RsTo = DB.OpenRecordset("T1work", dbOpenTable, dbDenyRead, dbPessimistic) 　　 　　Do Until RsFrom.EOF 　　　　i = i + 1 　　　　j = j + 1 　　　　RsTo.AddNew 　　　　RsTo!ID = j 　　　　RsTo!順番 = RsFrom!順番 　　　　RsTo!出荷日 = RsFrom!出荷日 　　　　RsTo!客先 = RsFrom!客先 　　　　RsTo!依頼№ = RsFrom!依頼№ 　　　　RsTo!品番 = RsFrom!品番 　　　　RsTo!製品名 = RsFrom!製品名 　　　　RsTo!ロット№ = RsFrom!ロット№ 　　　　RsTo!本日出荷数 = RsFrom!本日出荷数 　　　　RsTo!単価 = RsFrom!単価 　　　　RsTo!金額 = RsFrom!金額 　　　　RsTo![返却・修正] = RsFrom![返却・修正] 　　　　RsTo!完納 = RsFrom!完納 　　　　RsTo!完納時出荷数 = RsFrom!完納時出荷数 　　　　RsTo!計算上金額 = RsFrom!計算上金額 　　　　 　　　　smallSum = smallSum + RsFrom!金額 　　　　RsTo.Update 　　　　RsFrom.MoveNext 　　　　 　　　　If i Mod rowNum = 0 Then　'小計行挿入 　　　　　　RsTo.AddNew 　　　　　　j = j + 1 　　　　　　RsTo!ID = j 　　　　　　RsTo!製品名 = "【 小 計 】" 　　　　　　RsTo!金額 = smallSum 　　　　　　RsTo.Update 　　　　　　smallSum = 0 　　　　End If 　　Loop 　 　　If i Mod rowNum <> 0 Then 　　　　RsTo.AddNew 　　　　j = j + 1 　　　　RsTo!ID = j 　　　　RsTo!製品名 = "【 小 計 】" 　　　　RsTo!金額 = smallSum 　　　　RsTo.Update 　　End If 　 　　RsFrom.Close: Set RsFrom = Nothing 　　RsTo.Close: Set RsTo = Nothing 　　Set DB = Nothing 　　 　　DoCmd.OpenReport "レポート名", acViewPreview End Sub でどうですかね？
全部非連結コントロールということはデータの参照のみにしたいということなんでしょうか。 VBAは使わなくても間に合いそうです。 全てのフィールドが一つのテーブルの中にあるとしたらですが、 現状では非連結になっている各コントロールのコントロールソース欄 （データタブにあります）に指定すれば良いでしょう。 たとえば会社名なら =IIf(IsNull([会員番号]),"",DLookUp("会社名","テーブル名","会員番号 = " & [会員番号])) のようになります。 テーブル名、フィールド名、そもそも一つのテーブルに出したいフィールドが含まれているのか などが不明なのでその辺はDlookUp関数やIIF関数などをヘルプで確認し変更してください。 [会員番号]はフォームに配置してある >会員番号(テキストボックス)に数値が入力されたら を指しています。 PS. 画像は拡大しても肝心なところが読み取れません。 Windowsのおまけソフトの『Snipping Tool』で必要な部分だけ 切り取ってアップすると吉。
こちらを参考に進めてください。 コントロールの囲み罫の代わりにLineメソッドで線を引きます。 [AC95] 印刷時拡張を設定したレポートで横罫線をそろえる方法 https://support.microsoft.com/ja-jp/kb/404907/ja [ACC2002] レポートのセクションのサイズに比例して縦線が伸びない https://support.microsoft.com/ja-jp/kb/286247/ja
試してみなはれ。 （関西人じゃないけど・・・） Accessの日付時刻型は倍精度浮動小数点型です １日を１として時・分・秒は小数で扱われます。 今回の場合は 30を切る ということなので Date()+29 と解釈しました。 勘違いかな？ たまにやらかすので私の回答は眉唾かも？
対処方法がここの注意書きに載っています。 https://msdn.microsoft.com/ja-jp/library/cc42669 … フィルターする前にシングルクォートが含まれるかチェックする必要があるのは・・・。
なぜExcel上で『重複する主キー』が存在するのか その訳は何か・挿入する場合の規則性を確認することから始まるのでは？ 質問者さんの言われている「履歴」についても 新しいデータを既存のデータ下/上に追加とかいろいろ考えられそうです。 機械的に単純に・・・ならインポートの際にはExcelの主キー列／Accessの主キーフィールドを 除外してAccess上で新たにオートナンバー等々で割り振ってしまえば・・とも考えられますが 他のシステムとの整合性が取れなくなりますね。 なので、最初の二行に戻ってしまいますが 重複レコードの分析、元データ作成（入力）者へ確認・・からじゃないですかね。 以上ご参考までに。
試せる環境がないので検索した結果になりますが、このURLのNo.8の否定がそうなんじゃないでしょうか。 stackoverflow.com/questions/11905868/check-if-sequence-exists-in-postgres-plpgsql 検索ワード「postgresql sequence exists」
DBF Viewer Plus で読み込ませてみます。読めたのなら(◆Table Type が xBaseIIIであることを確認します)別名で保存して、その後、別ディレクトリにコピーします。ＯＳ上で、コピーしたファイルのフィル名を該当名に変更します。出来たファイルを本番環境にコピーして試してみても良いかと。但し、インデックスファイルを使用していないことが条件です（下記参照）。 ◆Table Infoで見て《FoxBASE+/Dbase III plus, no memo》とあればok。違ったらアウト。 インデックスと同期がとれていない状態で業務システムを使うと、リンゴを更新したつもりがイチゴを更新していた、等となります。 上記で上手く行っても(at your own risk)、そちらのシステムで、ずっとＯＫとは限りません。２０年ほど前、dBase iii (plus), dBXL, Excel97 で相互運用をかましたシステムで良く発生していた障害(インデックス関係なくとも)です。これに dbf ファイルの level が絡むと、何が何やら。 その頃、小さな会社の社長や専務が、dBXL で自社システムを作っていたな。それでも、複数テーブルでインデックスを使っていたっけ。それらのシステムはどうなったんだろう。そういえば、dBase iii と dBase iii plus って微妙にちがうんだ。 閑話休題 dBXL じゃ引っ掛からないので... google [dBase 開発 請負] ***確認方法 その１ >差し替えてみるとかだけでは これが出来るという事は、該当ディレクトリが分かると云うことですよね。そこで確認(*.ndx ファイルが存在しない事)できます。 その２ XPのデスクトップアイコンをダブルクリックした直後状態が、dBXL INTRO 状態なのか、作りこまれた業務メニューなのかが判然としないのですが。 [F4] で下記が実行されます。 XL[1] > dir 上記の様にやって、*.ndx ファイルが存在しない事。 Q. 起動直後って、《業務メニュー》なんですよね？ 【回答希望】 *** ps. 分かっている人向け[素人が手を出すと火傷する] google [dbf ファイル 修復]
そちらの状況が不明です。 関連しているテーブル、MT_受付一覧・MT_キャンセル・MT_成績の各フィールド名とデータ型、 それぞれ数レコード程度のサンプル、 Q_キャンセルのSQL文、 反映させるとは具体的に上記レコードをどのようにしたいのか、 以上を提示してください。
> チェックしたい値が他にも大量にある場合はどうすればいいのでしょうか。 大量にあるならば、その『大量』にある値を、どのように指定するつもりだったのでしょうか？ 一度に行いたいなら、当然ですが、以下のように、テーブルなどが必要になると思います。 CREATE TYPE valuelist AS TABLE (val int) GO DECLARE @v AS valuelist INSERT INTO @v (val) VALUES (1) ,(3) ,(5) SELECT val FROM @v WHERE val NOT IN (SELECT NO FROM テーブル名) GO もしくは、『大量』にある値をエディタおよび正規表現などを利用して、 SELECT 値 val UNION ALL SELECT 値 UNION ALL ・ ・ ・ SELECT 値 という形に整形した上で、コピペを利用してSQLを以下のように組み立ててればいいのでは。 SELECT WK.val FROM ( SELECT 1 val UNION ALL SELECT 3 UNION ALL SELECT 5 ) WK WHERE WK.val NOT IN (SELECT NO FROM テーブル名) GO どちらにしても、『大量』にある値を操作して『一括して必要な形に整形する必要がある』ため、いちいちテーブルを用意しなければならない前者より、後者で十分かもしれません。
CSVファイルにタイトル行が有り、テーブルのフィールド名と同じ、 列数も同じ（オートナンバー型フィールドは除く）、 ならTransferTextメソッドでインポートはだめですか。 安全のためインポート定義を利用するべき オートナンバー型フィールドは考えなくとも自動的に処理されます。 トランザクション処理が出来ないからNGか・・・。 インポート出来ないデータ型（数値に文字など）の場合は インポートエラーテーブルが自動生成され記録されます。 テキスト型に255超の文字数の場合、超過分は黙って切り捨てられ エラーは記録されません。 姑息な方法かもしれませんがインポート前にオートナンバーの最大値を控え インポート処理後にエラーテーブルの有無・レコード数の増加をチェックし 変化が有れば削除クエリで元に戻す。 オートナンバーが大きく飛ぶので最適化で修正 Access VBA 自身を最適化 でGoogleとVBAサンプルもあるけど。。。 ・・・ 現状の方向だと dim v() as variant,i as integer v=split(txtData,",") '配列に格納 for i= lbound(v(i)) to ubound(v(i)) debug.print i,v(i) '添え字と値（タイトル）の確認 next with rec .addnew !購入者氏名(漢字)= v(2) !注文日時= cdate(v(0) ) 'Cdate 要らないかも？ ・・のように対応する配列を指定 .update end with のようになるかと思います。 ただ、CSVファイルを、,カンマで分割して配列に入れているだけなので ExcelでCSV出力した時のようなフォーマット （位取り有りの数値にダブルクォートがついて、"1,100"） 区切り以外でカンマが使われていると項目数・データとも崩れます。 Rollbackすることに。
残念ながら、それはモノによるとしか言えません。 Windows8.1 64bit ＆ Access2013 32 bit で Access2000に付いてくるサンプルファイルのNorthWind.mdb は動作しました（変換も新規accdbに外部データベースのインポートで可能です）。 ただ、 2013になって削られた機能があります。 https://support.office.com/ja-jp/article/Access- … 準備（覚悟）だけはしておくべきだと思います。 ユーザーインターフェイスも変わりましたし。
でしたらフォームB（条件設定画面かな？）にコマンドボタンでも作成し クリック時イベントなどに if currentproject.allforms("フォームA").isloaded = false then docmd.openform "フォームA" '開いてなかったら開く end if Forms!フォームA.recordsource = "SELECT 顧客情報TBL.* FROM 顧客情報TBL WHERE [顧客情報TBL].[利用予定日] Between " & [Forms]![条件設定画面]![コンボ12] & " And " & [Forms]![条件設定画面]![コンボ14] & " ORDER BY [顧客情報TBL].[利用予定日] DESC;" のようにレコードソースを変更するか、 フォームA自体には抽出条件を設定しないひな形フォームとして作成しておきます。 dim sFilter as string if currentproject.allforms("フォームA").isloaded = false then docmd.openform "フォームA" '開いてなかったら開く end if sFilter = ・・・・sFilterに条件を書き込むのですが具体例が挙げられません sFilter の作り方は前回回答のVBAコードを参照してください。 debug.print sFilter 'イミディエイトウィンドウで正しくできているか確認 Forms!フォームA.filter = sFilter Forms!フォームA.filteron = true のような流れになります。べた打ちなので間違っているかも。
普通はまず伝票管理テーブルをつくり、 カテゴリやアイテムを正規化してこんな感じにします。 //伝票管理テーブル create table denpyo(did int not null auto_increment primary key,dno int unique key); insert into denpyo(dno) values(1),(2),(3),(4),(6),(7),(8),(9),(10),(12),(14),(15),(18),(20),(21),(22); //カテゴリーテーブル create table cate(cid int not null auto_increment primary key,ccode int not null unique key,cname varchar(100)); insert into cate (ccode,cname) values(101,'10代'),(102,'20代'),(103,'30代'),(104,'40代'),(105,'50代'),(111,'カップル'),(112,'ビジネス'),(113,'友人'),(114,'家族連れ'); //アイテムテーブル create table item(iid int not null auto_increment primary key,icode int not null unique key,iname varchar(100)); insert into item (icode,iname) values(1001,'ﾍﾞｼﾞﾏﾖﾁｷﾝL'),(1002,'ﾎﾟﾀｰｼﾞｭL'),(1003,'ﾍﾞｼﾞﾐｰﾄ油淋鶏'),(1004,'前菜盛合せ'),(1005,'ﾍﾞｼﾞﾏﾖﾁｷﾝ'),(1006,'本日のﾊﾟｽﾀ'),(1007,'Tsﾍﾞｼﾞｶﾚｰ'),(1008,'SPﾌｰﾄﾞ'),(1009,'ﾅｯﾂｻﾗﾀﾞ'),(1010,'ﾛｰｽﾄ野菜'),(1011,'ｶﾘﾌﾗﾜｰのﾑｰｽ') ,(2001,'ｼﾞﾝﾄﾆｯｸ'),(2002,'ｶﾝﾊﾟﾘｿｰﾀﾞ'),(2003,'ﾋﾟｴｰﾙｶﾛ'),(2004,'ｿﾙﾃｨｰﾄﾞｯｸﾞ'),(2005,'ｼﾞﾝｼﾞｬｴｰﾙ'),(2006,'ｺｰﾗ'),(2007,'生ﾋﾞｰﾙ(中)'); ここから伝票とカテゴリー・アイテムをリレーションします //伝票-カテゴリーテーブル create table denpyo_cate(dcid int not null auto_increment primary key,dno int,ccode int,unique key(dno,ccode)); insert into denpyo_cate(dno,ccode) values(1,111),(1,103),(2,111),(2,102),(3,104),(4,102),(6,112),(7,113),(7,102) ,(8,114),(8,105),(9,114),(9,104),(10,114),(10,104),(12,114),(12,104),(14,102),(15,101),(18,111),(18,104) ,(20,114),(21,112),(21,102),(22,112); //伝票ｰアイテムテーブル create table denpyo_item(diid int not null auto_increment primary key,dno int,icode int); insert into denpyo_item(dno,icode) values(1,1001),(1,1002),(1,1003),(1,2001),(1,2002),(1,2003),(1,2001),(1,2002),(1,2004) ,(2,2005),(2,2006),(2,1004),(2,1005),(2,1006),(2,1007) ,(3,2007),(3,1008),(3,2003),(5,1002),(5,1001),(6,1009),(6,1010),(6,1011),(7,2001); それぞれ表示 select dno,cname from denpyo_cate as dc inner join cate as c on dc.ccode=c.ccode order by dcid; select dno,iname from denpyo_item as di inner join item as i on di.icode=i.icode order by diid; 最終的にはこう select d.dno,dc.ccode,c.cname,di.icode,i.iname from denpyo as d inner join denpyo_cate as dc on d.dno=dc.dno inner join cate as c on dc.ccode=c.ccode inner join denpyo_item as di on d.dno=di.dno inner join item as i on di.icode=i.icode order by did,dcid,diid;
> 私もちょっとイメージが完全にはつかめておりません イメージを完全につかんでください。 やりたいこと（条件）を整理してください。 > 複雑な式も可能なのかな？ やりたいことが整理されてからでないと 条件付き書式で色々設定しても堂々巡りになってしまいますよ。 私からは以上です。
>そういうデータが恐らく1万件近くあります。 ↑このデータ次第のように思えます。 #1 さんの方法の他に、 たとえば、 Address1　Address2　Distance Tokyo　　　Oosaka　　　　10 Tokyo　　　Chiba　　　　　1 Tokyo　　　Kanagawa　　　 2 Oosaka　　　Chiba　　　　 5 の様ならパラメータクエリで 図のようにしておけば、データが Tokyo　　Oosaka　　　　10 でも Oosaka　　Tokyo　　　　10 でも問題ありません。 また起点/終点どちらかを未入力なら、 入力した方の一覧が出て来るかと。 で、パラメータ部分（[起点は？]、[終点は？]）を フォームのテキストボックスに変更すれば・・・。 なにはともあれ、元データ次第のような気がします。
＞何種類もの置換があり、置換ダイアログ(ctrl+f)では大変なので、 ＞ボタン1つで自動化できないものかと思って投稿しています designerで編集ができるなら別ですが、 クライアント側でできることは限られています。 とくにメールDBを編集すること自体かなりリスキーなので より高度の管理者にお願いするしかないと思いますよ
power pivotは使ったことはありませんが、ExcelDevToolのExcelアドインに テーブルデータ集計とデータマッチングの機能があり、希望されていることが 実現できると思います。SQLを書いて、Excelのテーブルを検索することができますが、 ウィザードでSQL自動生成できますので、基本的に自分で書く必要はありません。 ご参考ください。 ２０代というフラグが立っている伝票の総計を出すこと: SELECT SUM(金額) FROM T1 WHERE フラグ='20代' 集計の例： カテゴリデータとPOSデータのテーブルをつなぎ: データマッチングでできます。 　例： https://www.youtube.com/watch?v=TitRpy797ZI
>「タブ0」の中にページが5つ設定されている状態となっております でしたら、#2 の回答で、ＯＫ牧場！です。（古っ） タブコントロール名やページ名は適宜読み替えて行ってください。
残念ながら Access 2013 で廃止、変更された機能 https://support.office.com/ja-jp/article/Access- … にあるようにExcelで行ってね・・・という事のようです。 ただ、クロス集計クエリでも実現できるのでは？と思います。 作成タブ中のクエリウィザードからクロス集計クエリウィザードが用意されています。 Access で SQL ビューを使ってクロス集計クエリを作成する http://mnrt.hatenablog.com/entry/2015/02/crossta … クロス集計クエリを使用して集計データを読みやすくする https://support.office.com/ja-jp/article/%E3%82% … 挑戦してみてください。
２番目の 累計: DSum("商品の数","Q2f2_受注記録_累計","発送日 <=" & [発送日] & "AND 在庫管理ID =" & [在庫管理ID]) は 累計: DSum("商品の数","Q2f2_受注記録_累計","発送日 <=#" & [発送日] & "# AND 在庫管理ID =" & [在庫管理ID]) では。（発送日が日付時刻型、在庫管理IDが数値型とした場合） # で括るのと AND の前に半角スペースがありません。 １・３番目は不明。
http://www.accessclub.jp/bbs/0007/beginers3124.h … では難しいことを回答されてますが、普通は http://members2.jcom.home.ne.jp/cozy.nakayama/Ac … で設定します。
アクセスは、データが入っていない状態と長さ0の文字列が入っている状態を区別しているからかな？ フィールドを数値にして規定値を0にして問題がないなら、そうするのもありかな。
たぶん select A.入金日, A.会員No, sum(A.入金額) from [ select 会員No, 入金日1 as 入金日, 入金額1 as 入金額 from テーブル1 where 入金日1 is not null union all select 会員No, 入金日2 as 入金日, 入金額2 as 入金額 from テーブル1 where 入金日2 is not null union all ... ]. as A group by A.入金日, A.会員No
oracle は知らないのですが。 ・・・ atbl.数量, DLookup("得意先コード", "btbl", "納品番号=" & [納品番号] ) AS 得意先コード from ・・・ とかですかね？ 「納品番号」がテキスト型なら DLookup("得意先コード", "btbl", "納品番号='" & [納品番号] & "'") AS 得意先コード
単価テーブルに時期を追加してクエリのフィールドに部分を作る考えでいいですかね？ ざっくりになりますが、下記の感じでどうでしょう？ 「時期分岐:IIf([単価テーブルの日付]>=[クエリの日付],"100円","150円")」
DBの種類やバージョンによってUNION時の挙動にばらつきがあるみたいですね。 本来二つのテーブルのデータ型が同じであれば、切り詰められることはないはずですけどね DB側の制限だとそのままでは解決できないので たとえばテンポラリテーブルをつかえるDBならAテーブル、Bテーブルを順に 流し込んで結果を取得するなど工夫するしかないかも
このバージョンだとなるみたいなんで手作業で分割する方法があがってます。 参考にしてみてください。 https://support.microsoft.com/ja-jp/kb/304932/ja
>Private Sub レコードの追加_Click() のコマンドボタンなどがメインフォーム上にあり .FindFirst "宿泊日=#" & D & "# AND 請求書_詳細ID =" & Me.請求書_詳細ID の末尾のMe.請求書_詳細IDがサブフォーム上にあるのでしたら .FindFirst "宿泊日=#" & D & "# AND 請求書_詳細ID =" & Me!サブフォームコントロール名.Form!請求書_詳細ID でしょうけど、。。。 http://hatenachips.blog34.fc2.com/blog-entry-347 … Me.請求書_詳細ID が重複している、 OR コントロール名を間違えている、かも？ Me.請求書_詳細ID は何処にあるのでしょう。？ 謎の仕様。 上手く行かなかったらより単純に .FindFirst "宿泊日=#" & D & "# AND 請求書_詳細ID =1" でもお試しを。
複数のテーブルをつないだクエリは「基本的に入力できません」・・・これが原則です。 入力できるのは リレーションシップがきちんと作成されている（１対１または１対多） 集計関数を使っていない などの条件があります。（前の方が示されたリンク先にはこれが書かれています） で、それをクリアしているとしても、一つ注意しなければならないことがあります。 売上伝票の例にします。 売上テーブル　＝　伝票番号　得意先ＩＤ　日付 明細テーブル　＝　伝票番号　明細番号　商品ＩＤ　数量　単価 となっている場合（売上の伝票番号と明細の伝票番号が１対多のリレーションシップ）に、 クエリは 　　伝票番号　明細番号　得意先ＩＤ　日付　商品ＩＤ　数量　単価 と作成すると思いますが、 この“伝票番号”は売上テーブルの伝票番号ではなく、明細テーブルの伝票番号にしないといけません。 「リレーションシップが設定されたフィールドは多側のテーブルのフィールドを使う」ということです。
たとえば http://blog.goo.ne.jp/pc_college/e/aef658131ce0a …
こちらのスレッドが参考になりそうです。 http://www.russ.jp/stepbbs/step.cgi?mode=view&no … もしくは空白のみソートして、未来の日付を入れて非表示にしておく（空白に見せる）…くらいしか簡単なものは思いつかないです。 手間でなければ是非(^^)
主キーの設定をきちんとしていないと「リレーションシップ未定義」となります。 主キー設定すると「重複なし」になります。テキストフィールドの値で主キーにしていいのですが、値が重複していると、主キーとして設定できません。 テーブルの中で、重複データが存在しないフィールドを主キーにします。 それぞれのテーブルに主キーを設定したら、 テーブルのリレーションシップは、片方の主キーともう一方のテーブルのフィールド（相手の主キーと同じ種類のデータを格納するフィールド）を結びます。 う～ん、具体的なフィールド名がわからないと、これ以上の説明は難しいです。
主キーが複数ある件については私の不明でした。 http://makoto-watanabe.main.jp/access/acconWhatK … 使ったことがないのでミスリードするかもしれませんから発言は控え目で。 主テーブルのIDには主キー（インデックスあり重複なし）に設定されているか。 （繰り返しになりますがテーブルを開いて何も言ってきませんよね） 主テーブルには他には主キーはないですよね。 枝テーブルには主キーが二つあるようですが インデックスを表示してみて、IDの方にインデックス名が付いていますか？ （枝テーブルの設定が関係してくるかは自信がありません）
クエリのデータを編集できない状況 https://support.office.com/ja-jp/article/%E3%82% …
ずいぶん大雑把な質問ですが、「サーバー」と呼ばれている物のOSは何ですか？ ローカルに接続とは具体的にどのように接続されていますか？ とりあえず、補足願います。
＃１です 動きましたか･･･ じゃぁ、前回エラーだったのはシート名が違っていたりしたんでしょうかね。 > 追加された各シートの1行目を「先頭行の固定」＋「フィルタ設定」するにはどうすればよいか教えていただけないでしょうか。 これ、ご自分で操作できるのであれば、「マクロの記録」を使ってみるのも良いかも。 「先頭行の固定」＋「フィルタ設定」を 2007 でやってみると、以下が記述されます。 Sub Macro1() ' ' Macro1 Macro ' ' 　　With ActiveWindow 　　　　.SplitColumn = 0 　　　　.SplitRow = 1 　　End With 　　ActiveWindow.FreezePanes = True 　　Selection.AutoFilter End Sub この記述されたものを、違うシートでステップ実行してみます。 すると、ウィンドウを分割してから枠を固定している事がわかります。 この動きで良ければ、このままの記述を組み込んでいけば良いです。 私が知っている枠固定の方法は別にあって、 　　Range("B2").Activate 　　ActiveWindow.FreezePanes = True とすると、アクティブセルの上側・左側を固定するというもの。 上記は、B2 を指定しているので、１行目と A 列が固定に･･･ 今回は１行目だけなので、左側が無い A2 を指定すれば･･･良いですね で、Samp3 に組み込んでいきますが、フィルタの設定 　　Selection.AutoFilter は、それなりに項目が記述されていないとエラーになるみたいなので、抽出したものを転記した後 　　　　　　　　End With 　　　　　　　　Range("A2").Activate ' ★ 　　　　　　　　ActiveWindow.FreezePanes = True ' ★ 　　　　　　　　Selection.AutoFilter ' ★ 　　　　　　End If 　　　　　　Columns.AutoFit ' 列幅を調整してみた これで、終了･･･でも良いですが、 現状、抽出を繰り返す＝シートの使い回し　になっています。 前回、何件か抽出されていて、今回０件ならシートは空白になりますが、枠固定が残ってしまう事に･･･ 　　　　　　Else 　　　　　　　　v.Activate 　　　　　　　　Cells.ClearContents 　　　　　　　　ActiveWindow.FreezePanes = False ' ★ 　　　　　　End If 上記部分で、枠固定を解除する様にしといた方が良いかも。 オートフィルタは、Cells.ClearContents　することで解除されるみたい･･･？ ※ > もう一点甘えてもいいですか。 動いた･･･とかの後に、追加質問があった場合、 おそらく他の方は回答してこないと思うので、急を要する場合などは別質問にした方が良いかも？ しかも、内容的には Excel のカテゴリになる？ Excel に関しての回答者さんは、Access より多いかな？ 私のわかる範囲で追加等には応えていこうとは思っていますけど･･･ 自分でやったのと、聞いただけのものなら、後々自分でやった方を覚えている？のかな？
画像が小さくて見にくいのですが、 [コード]の更新後処理に me!金額 = DLookUp("金額","Q_クエリ") とか [金額]のコントロールソースに、= DLookUp("金額","Q_クエリ") でしょうか。 Q_クエリ をどうやって生成しているか分からないので 勘違い回答かも？ ご参考まで。 PS. DLookUp("金額","Q_クエリ") では Q_クエリ で複数のレコードが抽出された場合、 最初のレコードが表示されますので、その辺もご注意を。 Windows7のアクセサリの中にSnipping Tool というのがあります。 必要な部分だけ撮ってくれますので便利です。
accdc 何処かで見たような拡張子・・・。 これですかね。 http://answers.microsoft.com/ja-jp/search/search … 今のところ４スレッドしかないので一通り目を通してみてください。 accdc になるのはアップデートで持ち込まれたバグの様です。 拡張子をaccdb に変えれば使えそうな事も書かれていますし、 より確実に手作業で行った方が・・・とも。 デジタル署名は公的な機関で取得でもしない限り、あまり役に立たないかと。 http://www.asahi-net.or.jp/~ef2o-inue/secur/sub0 … 少し古い解説ですが、 Access2010でもVBAプロジェクトのデジタル証明書で表示される注意書きは 上記解説とほぼ同じですね。 MS社さんの https://support.office.microsoft.com/ja-jp/artic … や https://support.office.microsoft.com/ja-jp/artic … もご一読を。
＞select japanese from table2 where id = (select id from table1 where english = 'foo'); englishがユニークでない場合 select id from table1 where english = 'foo' で得たidは1つとは限りません。 上記で2つ以上のidが返ってきたときid=・・・は文法的にエラーになります。 どうしてもサブクエリでやりたいならinをつかうことになるでしょう (SQLiteに該当する文法があるなら) select japanese from table2 where id in (select id from table1 where english = 'foo'); #1さんのSQL文で問題ありませんが、 ロジック的には絞ったtable1からtable2の値を得たいので select japanese from table1 inner join table2 on table1.id = table2.id and english = 'foo'; の方が、より直観的かもしれませんね。 ちなみにMySQLでテストする限り適切なインデックスさえ貼ってあれば、 効率は変わらないみたいです。
>Sheets("会社管理").Select この辺で止めて debug.print Rst.locktype してみてください。 以下Access2010のヘルプより LockTypeEnum 編集時にレコードに適用されるロックの種類を表します。 定数 値 説明 adLockBatchOptimistic 4 共有的バッチ更新を示します。バッチ更新モードの場合に必要です。 adLockOptimistic 3 レコード単位の共有的ロックを示します。Update メソッドを呼び出した場合にのみ、プロバイダーは共有的ロックを使ってレコードをロックします。 adLockPessimistic 2 レコード単位の排他的ロックを示します。プロバイダーは、レコードを確実に編集するための措置を行います。通常は、編集直後にデータ ソースでレコードをロックします。 adLockReadOnly 1 読み取り専用のレコードを示します。データの変更はできません。 adLockUnspecified -1 ロックの種類を指定しません。複製の場合、複製元と同じロックの種類が適用されます。 で、 LockType プロパティ (ADO) 編集時にレコードに適用されるロックの種類を示します。 設定値と戻り値 LockTypeEnum の値を設定または取得します。既定値は adLockReadOnly です。☆★☆注目！ 解説 プロバイダーが Recordset を開くときに使用するロックの種類は、LockType プロパティを使用して事前に設定します。開いている Recordset オブジェクトで使用されているロックの種類は、このプロパティを取得することで確認できます。 プロバイダーによってはすべての種類のロックをサポートしていないものもあります。要求した LockType 設定をプロバイダーがサポートしていない場合は、他の種類のロックに置き換えられます。Recordset オブジェクトで実際に使用可能なロック機能を調べるには、adUpdate と adUpdateBatch で Supports メソッドを使用します。 CursorLocation が adUseClient に設定されている場合、adLockPessimistic 設定はサポートされません。サポートされていない値を設定してもエラーにはなりませんが、サポートされる LockType のうち、最も近いロックが使用されます。 LockType プロパティは、Recordset が閉じているときは読み取り/書き込み可能で、開いているときは読み取り専用になります。 リモート データ サービスでの使用 クライアント側の Recordset オブジェクトで使う場合、LockType プロパティは adLockBatchOptimistic にのみ設定できます
Oracleについては不明です。 あなたが作成したファイルでなければ いじくらずに作成者に相談する事を強くお勧めします。
エクセルの最新版は、古いバージョンで作成したエクセルファイルを 問題なく開くことができますので、今回開けなかったのは、 USBフラッシュメモリに保存したエクセルファイルが部分的に壊れてしまったためと思われます。 私も経験があるのですが、ファイルをダブルクリックすると、 エクセルが立ち上がるものの、グレーの画面のまま止まってしまう、 という状況ではありませんでしたか？ この場合、エクセルを開いて、ファイル→開く　とし、破損したエクセルファイルを選択、 右下の「開く(O)」の右にくっついている下向き黒三角「▼」をクリックし、 「開いて修復する」をクリックすると、罫線や色塗りなどの情報は失われるものの、 セルに入力した情報は拾い上げることができます。 最も確実なのは、USBフラッシュメモリの破損したデータを消去して、 あなたのPCから再度保存し直すことです。 元ファイルが破損していない限り、二度も続けて同じファイルが破損するとは考えられないので、 先方の2013で問題なく開けるようになるはずです。
Sum関数の引数にはコントロール名ではなく、そのフォームのレコードソースのフィールドを参照する必要があります。 まず、サブフォームのフォームヘッダーかフッターにテキストボックスを配置して、 コントロールソース　=Sum([金額]) 名前　合計金額 とします。次に、メインフォームのテキストボックスのコントロールソースから上記のコントロールを参照します。 =[SubForm01].[Form]![合計金額] SubForm01 はサブフォーム本体の名前ではなく、サブフォームを埋め込んでいるコントロールの名前にしてください。
Q、工事依頼元へ出す見積もり書作成の場合、既に入力している部材注文一覧と仮工事発注一覧のレコードの項目名、単価、数量を受注IDで紐付けたもの全部使用したいのです。その場合、クエリーでそうなるようなものを作成し、それをコンボボックスなどで選択するのも一つの手でしょうか・・・ A、No! 　私の作法では、まず、Accessのクエリーなるものは一切利用しません。 PS、まず、入力フォーム、検索フォームのデッサンを！ 　一体、ユーザーが直感的に手早く作業するには？ということを念頭に。その実現方法は、後から考えたらいいです。
Q、帳票フォームの行の順番を簡単に変えたいのですが、何か方法はありますでしょうか？ A、ソート。 http://hatenachips.blog34.fc2.com/blog-entry-58. …
フィールドのインデックスの設定でも結構変わってきます。 ファイル名、idx.accdb テーブル名、T1 フィールド名、F1、テキスト型でフィールドサイズ255 （インデックスに、はい（重複あり）を設定 フィールド名、F2、長整数型。 標準モジュールにて Sub b() Dim db As Database Dim rs As DAO.Recordset Dim i As Long Set db = CurrentDb db.Execute ("delete * from T1") Set rs = db.OpenRecordset("T1", dbOpenDynaset) For i = 1 To 370000 rs.AddNew rs!f2 = i If i Mod 1000 = 0 Then rs!f1 = "abc" Else rs!f1 = rndStr End If rs.Update Next End Sub Private Function rndStr() As String Dim i As Integer For i = 1 To 255 rndStr = rndStr & Chr(Int(Rnd * 26) + 65) Next End Function で、b を実行しダミーデータを入れときます。（最適化も実行しといてね） このファイルを別名保存して、NOidx.accdb フィールド名、F1、テキスト型でフィールドサイズ255 （インデックスに、なし）に設定を変更します。 （テーブル名は、NoT1 とか適当に）。（最適化も実行） 二つのファイルをファイルサーバーに移動します。 もう一個検証用のファイルを作成し上記ファイルから 上記テーブルのリンクテーブルを二個作成します。 クエリを上記テーブルから二個作成 抽出条件に、Like "abc*" としてみます。 クエリの左下にあるレコード数が表示されるまで インデックス有りの場合は１～２秒 無しの場合は８秒弱でした。 （当方のはしょぼいファイルサーバーなので時間が掛かります。。。） ※初回のクエリに限ります。 一旦ファイルを閉じないとキャッシュから読みだされるようなので 連続して行う場合は時間は同じになります。 以上、 リンクテーブルでもインデックスは有効かのテストでした。 ＃１さんの回答の通りファイルサイズはどうしようもないと思います。 インデックスを作成していたなら、お邪魔虫回答ですね。(^_^;) ご参考まで。
【お知らせ】 　　　　　　If M > 99 Then 　　　　　　　　MsgBox "読込む行総数を100行に下方修正しました。(DBSelect)", _ 　　　　　　　　　　　 vbInformation, _ 　　　　　　　　　　　 " お知らせ" 　　　　　　　　M = 99 　　　　　　End If DBSelect()に99行制限をかけていました。この６行はバッサリと消して下さい。500行や1000行では変数オーバーはしないので大丈夫です。
回答No.2です。 > 例えば、ある受注の明細を全て仮テーブルに～(以下略) 具体的な実装は、システムの要件に従って工夫して頂ければ 良いかと思われます。 ただ『データをコピーして他のテーブルに格納』する処理は、 乱用すると後からデータ更新が必要になったときにコピー先も 更新が必要になって、処理が煩雑になりますのでご注意を。 安易なデータコピーもシステム崩壊原因の "あるある" です。 > 入金された物の消し込みをスル場合～(以下略) この質問が出るということは、失礼ながら質問者さんはまだ 今回作成するシステムの要件の理解が不足しています。もう いちど業務フローを見直して『なぜ、入金消込処理が必要な のか、これは何のために実施するのか』を問い直してくださ い。 これは質問者さんが今作っているシステムの『理解』のため に、質問者さんご自身の手で解決すべき内容かと思います。
演算誤差のない「通貨型」でしょうね。
すでに、f_a_007様の回答が出ているので、自分は別の視点から回答させて頂きます。 売上データにだけ存在する顧客があると想定し以下回答 初心者にはＳＱＬ文はきついかな・・・ でも、今後Accessを使っていくならば覚えていったほうが良いです 以下のテーブルを用意 住所リスト(顧客番号、名前、住所　)をTBL_ADRとし、顧客番号 1001,1002,1003を作成しておく 売上データ(顧客番号、名前、売上高)をTBL_URIとし、顧客番号 1002,1003,1004を作成しておく 抜粋＞主力キーにして合体をさせたのですが、 抜粋＞売上データに記載の顧客のみが抽出され住所リストの一部顧客が消えてしま～ 上記、現象から売上データを主体に作成しようとしているためと推測されます ■現象からの推測ＳＱＬ SELECT TBL_ADR.顧客番号, TBL_ADR.名前, TBL_ADR.住所, TBL_URI.売上高 FROM TBL_URI INNER JOIN TBL_ADR ON TBL_URI.顧客番号 = TBL_ADR.顧客番号; または SELECT TBL_ADR.顧客番号, TBL_ADR.名前, TBL_ADR.住所, TBL_URI.売上高 FROM TBL_URI LEFT JOIN TBL_ADR ON TBL_URI.顧客番号 = TBL_ADR.顧客番号; となっていると思われます。 ■住所リストを主体にしたい場合のサンプルＳＱＬ SELECT TBL_ADR.顧客番号, TBL_ADR.名前, TBL_ADR.住所, TBL_URI.売上高 FROM TBL_ADR LEFT JOIN TBL_URI ON TBL_ADR.顧客番号 = TBL_URI.顧客番号; 上記コードだと、住所リストにはなく、売上データにだけある顧客(顧客番号＝1004)は抽出されません ■住所リスト、売上データの顧客すべてを表示させたい場合のサンプルＳＱＬ (1).まず売上データだけにある顧客(1004)を列挙 (不一致クエリと呼ばれる物です) SELECT TBL_URI.顧客番号,TBL_URI.名前,TBL_ADR.住所, TBL_URI.売上高 FROM TBL_URI LEFT JOIN TBL_ADR ON TBL_URI.[顧客番号] = TBL_ADR.[顧客番号] WHERE (((TBL_ADR.顧客番号) Is Null)); (2).住所リストの顧客(1001,1002,1003)を主体にしたＳＱＬ SELECT TBL_ADR.顧客番号, TBL_ADR.名前, TBL_ADR.住所, TBL_URI.売上高 FROM TBL_ADR LEFT JOIN TBL_URI ON TBL_ADR.顧客番号 = TBL_URI.顧客番号 (3).UNIONでひとつの出力結果を出す(1,2を合体させる) SELECT TBL_ADR.顧客番号, TBL_ADR.名前, TBL_ADR.住所, TBL_URI.売上高 FROM TBL_ADR LEFT JOIN TBL_URI ON TBL_ADR.顧客番号 = TBL_URI.顧客番号 UNION SELECT TBL_URI.顧客番号,TBL_URI.名前,TBL_ADR.住所, TBL_URI.売上高 FROM TBL_URI LEFT JOIN TBL_ADR ON TBL_URI.[顧客番号] = TBL_ADR.[顧客番号] WHERE (((TBL_ADR.顧客番号) Is Null)); ※UNIONを用いる場合、クエリデザイナーでは作成が出来ません 表示をSQLビューに切り替えて自分でＳＱＬ文を入力することになります。 (4).3で纏めたＳＱＬを顧客売上台帳という名で保存 ＜顧客売上台帳 出力結果＞ 顧客番号 , 名前 , 住所 , 売上高 1001 , ○○○○ , ○○○○ , 1002 , ○○○○ , ○○○○ , \200 1003 , ○○○○ , ○○○○ , \300 1004 , ○○○○ , ○○○○ , \400 以上です
細かいことですが「RecordsetClone」は「変数」ではなくて「プロパティ」です。 さて、本題ですが、 > 一つお聞きしたいのですが、RecordsetClone変数だと、フィールド更新後に使うと、値が古いものが取得されてしまい、うまく計算が出来ない時があります。 フィールドは更新したが、まだレコード保存していない状態だとそうなるかもしれません。 フィールドを更新して、それを参照して使用する場合は、事前にレコード保存してテーブルに格納しておくべきですね。 テーブルに格納せずに、エラーや操作ミスで終了してしまった場合、テーブルの値と参照使用した値に矛盾が生じてしまう可能性があります。 フィールドを更新した場合は、RecordsetClone でデータを参照する前に、 DoCmd.RunCommand acCmdSaveRecord でレコード保存しておくといいでしょう。。 Me.Recordset だと、レコードセットでの操作（レコード移動など）が直接フォームに影響を与えてしまうので、 処理が重くなるので避けるべきです。 他にもフォームのレコードセットを参照する方法として、RecordSet.Clone があります。 「フォームの Recordset, RecorsetClone, RecordSet.Clone の違い」はWEB検索すると詳しい解説が見つかると思います。
チェックボックスは連結コントロールで、「チェック」というフィールドと連結していると仮定して回答します。 条件付き書式を使います。 フォームのデザインビューで入力可/不可を設定したいテキストボックスを選択します。 リボンの「書式」タブ→[条件付き書式]→[新しいルール]で、書式設定で「式」を選択して、隣のボックスに [チェック]=False という式を入力します。 ボックスの下の右端の「有効化」のアイコンをクリックして選択状態にします。 以上で、チェックボックスにチェックを入れてあるレコードのみ編集可能になります。
入力画面（フォーム）とテーブル設計は別に考えるようにしましょう。 通常は、注文履歴のテーブルに、商品ID（外部キー）以外の商品データ（商品名や品番）は保存すべきではないです。 履歴入力画面からは、商品管理テーブルは参照だけで変更できないような設計にすれば問題ないので。 また、リレーションシップで「参照整合性」にチェックを入れておけば、履歴テーブルのデータと紐づいているレコードをマスターから削除しようとすると警告が出て削除できないようになります。 ただし、例外として、例えば「単価」が頻繁に変わるように場合は、単価を注文履歴の方にも格納するということはあります。 注文履歴入力画面（フォーム）での商品名や品番の参照は、コンボボックスを利用すると簡単にでき、また、入力しやすいものになります。 ■T'sWare Access Tips #360 ～コンボの２列目をテキストボックスに表示する方法（コントロールソース版）～ http://www.tsware.jp/tips/tips_360.htm
速度的にどうなるかはわかりませんが、積集合を使って みるとかどうでしょう。 SELECT head, body FROM dic WHERE body MATCH 'foo bar' INTERSECT SELECT head, body FROM dic WHERE head MATCH 'bar'
また長文失礼いたします、必要な部分だけ見ていただけると助かります ■補足回答 ＞フィールドの更新後処理では、SQLで更新クエリーを実行すると ＞、フォームのレコードソースの値は既に更新されているのでしょうか？ テーブルのレコードとしてはまだ更新されていません レコードソースの連結項目であっても、 カレントレコードが「移動」されるか「閉じられる」か「コミット(保存)」された際に 初めてデータベース(テーブルレコード)に反映されます 従ってフィールドの更新後処理では、実際のレコードはまだ更新されていません レコードとしては、まだ編集中という位置づけになります 「acCmeSaveRecord」は保存の意味合いになるのであるいみ性解です ※編集中のレコードは、キーボードのＥＳＣを２度連続押下すると元に戻す機能を持っています ■余談：データベースが外部(SQLやOracle)の場合、以下のような現象が発生します (1)ＰＣ－Ａでテーブルレコード修正中(編集中)のとき、他のＰＣからそのレコード参照すると前の値が参照されます (2)ＰＣ－Ａでテーブルレコード修正中(編集中)のとき、他のＰＣでも同じレコードを修正しようとすると ___最後に更新しようとするＰＣに警告メッセージが出てきて反映できません（ココ裏覚えですがでたはず） ___その場合、レコードロックなどの仕組みを作る必要になります（仕組みは物凄い情報量になるので省きます） ■大昔(2008年ごろ)、自分が教わった事 テーブルを実際開いてみてください、テーブルのレコード内の(どれでも良いです)項目値を 入力すると左側に鉛筆マークがでてきます。 この鉛筆マークは編集中と意味で、まだレコードには実際に反映されていません キーボードのＥｓｃボタンを２回チャチャと押すと編集中のレコードは元に戻ります Ｅｓｃボタンを押さずにレコードを移動またはテーブルを閉じると反映されます ※ＶＢやＲＰＧ４００の言語で言うと、コミットされるというわけです これがAccessではフォームでも連結項目の場合、適用されるというわけです 解らなければ、そういうものだと理解しときや と教わった、やばいなぁ走馬灯のように思い出す自分・・・なんか涙出てくる 以上でした (さぁ定時だぁパチンコ行くぞ～ｗ)
＃１、＃２です ＃２のＧｒｏｕｐｂｙは、２番目をＭＡＸかMINで囲む前提です。 ルールがわからないので、どちらかお好きな方でどうぞ
いま手もとにアクセスがないので自分で確かめてみることができないのですが、↓これはヒントになりませんか？ http://www.ilovex.co.jp/blog/system/access/acces … http://ivystar.jp/ms-office/access/if-the-cause- …
cがsqlite3.Cursorだとして。 c.execute("SELECT * FROM stocks") に成功した後で、c.descriptionを調べることでわかります。 http://docs.python.jp/2/library/sqlite3.html#sql … r=c.fetchione() 等としたときの r は sqlite3.Row のオブジェクトになります。 http://docs.python.jp/2/library/sqlite3.html#row Rowにはkeysメソッドがあります http://docs.python.jp/2/library/sqlite3.html#sql … もし、簡単な参考書とかしか読んでいないのなら、公式マニュアルも読むことをお勧めします。 > 最初のRecord Setが(date,qty) = ("2014/12/1", 5)の場合 この例は「登録内容を得た後」だと思うのですが。 前と後、どちらなのでしょうか?
「SubForm」のフィールドのどれかのフィールドの ダブルクリックなどで、 　msgbox me.parent.name などとすれば、メッセージボックスでは 「FormA」が表示されますが、これは あくまでも「SubForm」でのイベントなので 当然ながらコードは「SubForm」に書き込みます。 同様にして、 ＞サブフォームのイベントで何かの処理をスル場合に、 ＞自分のフォームのフィールドの値を取得するのには の場合も、コードは「SubForm」に書き込みます。 たとえば、「SubForm」にボタンを設定して、 そのクリックイベントで、 msgbox Me.Controls("フィールド名").Value とすれば、現在「SubForm」でカレントになっている レコードの「フィールド名」の値が表示されます。
No.1です。 > Knoppix上での解決方法も教えて下さい puppy linux上の環境では、python 2.7.3でも前述のサンプルソースのコメントアウトだけで動作しました。つまりpythonではなく、インストールされているsqlite3のバージョンに依存するということになります。 通常ですと、sqlite3の最新版のソースをもってきてコンパイルし、インストールして、作成されたsqlite3.soを元のファイルと置き換えれば良いことになります。 ./configure --prefix=sqlite3のインストールされているディレクトリ make make install ただしKnoppixってCD-ROM(DVD-ROM)から起動しますよね？ いまご利用になっているsqlite3がCD-ROM(DVD-ROM)上に存在すると置き換えは難しいと思います。
Me.cmbo会社ID.RowSource = "会社ID1;依頼ID;会社ID2;会社ID3;会社名" Me.cmbo施工会社ID.RowSourceType = "テーブル/クエリ" "会社ID1;依頼ID;会社ID2;会社ID3;会社名" ↑ 少なくとも、これはテーブルでもクエリでもない。 次のサイトが参考になるかもです。 http://www.moug.net/tech/acvba/0060002.html
添付図ミス！
ネストがずれてるので "0%" が Format 関数の第2引数として評価できない位置にある。 と思うんだけど。 SELECT 　t_エクセル貼り付け.地域, 　Format 　　( 　　　( 　　　　NZ( [フロントNG] ) 　　　) 　　　/ 　　　( 　　　　NZ( [後確NG] ) 　　　　+ 　　　　NZ( [エントリー後NG] ) 　　　　+ 　　　　NZ( [アンテナ後確NG] ) 　　　　+ 　　　　( 　　　　　NZ( [フロントNG] ) 　　　　　+ 　　　　　NZ( [決裁者NG] ) 　　　　　+ 　　　　　NZ( [アンテナNG] ) 　　　　　+ 　　　　　NZ( [検討NG] ) 　　　　　+ 　　　　　NZ( [対象回線済NG] ) 　　　　　+ 　　　　　NZ( [NG] ) 　　　　) 　　　　, "0%" 　　　) AS フロントNG率 FROM t_エクセル貼り付け;
本題からズレるが、不勧奨を管理しないで良いの？
回答No.1 です。 既にマルチポストであちこちに問い合わせてらっしゃる ようなので私はこれでギブアップとさせて頂きます。 お役にたてずにすいませんでした。
開示されたレコード定義が列名のみなのでなんとも。 制約はどうしていますか？ Null、空文字を受け入れるなら、 レコード追加できますが、値を代入していない列はNullでしょうね。
>※先に開いている人には読み取りは可能 >※後から開いた人は、データの編集が可能にする >※先に開いた人が、後から開いた人がデータの編集をしている時に該当レコードの変更は出来ないようにしたい ？？？ 開いた順は特に関係ないと思います。 先に編集し始めた人に権限を与えるなら、OpenRecordsetで適切に設定することで可能です http://msdn.microsoft.com/ja-jp/library/office/f …
Q1 で、Table2との結合を外部結合にすれば、Table2に対応する部屋IDがなくても影響は受けません。 当然、Table2の部屋データは参照できません。 ただ、参照先のない外部キーを残しておくのは通常は意味がないと思います。 残しておきたいなら、マスター側のレコードは削除せずに、もう使用しないという意味のフィールドを持たせてそこにフラグを立てるという方法にすると思います。 例えば、社員マスターで、社員が退職しても削除せずに、退職フラグを立てる、あるいは退職日を入力するというように。 おそらくアパート等の賃貸管理だと思いますが、その部屋を使用しなくなった日時と理由を格納するフィールドを用意して管理するのがいいと思います。、
> その場合には、更新されたかどうかを何らかの方法でフォームに持たせることは可能でしょうか？ 本テーブルと比較するか、ワークテーブルに更新チェック用のフィールドを持たせるかですね。 ただ、面倒だし、それほどパフォーマンスには影響しないと思いますので（逆に遅くなる可能性もあり）、上書きでいいとおもいます。
>瞬時に選択したい列の行を選択する方法を教えてください。 貴方が選択したい行を誰も知らないので、不可能です。 CTRL+shift＋＊　で入力されている連続したセル範囲を選択可能です。 また画像にあるように、セル番号を入力すればそこにジャンプできますので CTRL+shift+home　等で、特定のセルから先頭セルまでを範囲指定可能です。
連結フォームなら、フィルターなどで対象の１レコードのみ抽出して「追加の許可」を「いいえ」にしておけば、レコード移動はしません。 あるいは、非連結フォームにしてもいいですね。 サブフォームのレコードソースがWorkテーブルと言うことは、本テーブルとは非連結ですので、親フォームも非連結フォームにすれば統一性があっていいかもしれませんね。 あるいは１レコードのみのWorkテーブルをレコードソースにするいうのもいいかも。
http://msdn.microsoft.com/ja-jp/library/b1e65aza … > 有効桁数: 7 桁 です。 9999999.999999 を入れようとしたら、途中で打ち切って概数にする必要があります。 9999999.999999 を有効数字7桁にするには、 9999999 で .999999 を四捨五入するとかする必要があります。 四捨五入すれば 10000000 です。 これは 1.0 * 10の7乗 であり、これを「指数表現」という方式で表現したのが 「1E+07」 です。 対策ですが ・C#でfloatを使うのなら、あきらめるしかありません。 ・doubleを使うと、SQLiteのREALと同じ精度になります。
すみません。!の件は間違い。 一覧表サブフォームのoptSelectの値は [=Nz([親フォーム]![ID])=Nz([ID]) ] ←右辺はレコードセットのID
とりあえず下記の手順を試してみてください。 1. 4つぐらいのテーブル間でリレーションを設定 2. その中の1つのテーブルから、フォームの自動作成 3. 出来たフォームのレコードソースの「・・・」ボタンをクリックして、1で設定した3つのテーブルを追加し、必要な項目を追加して、その設定内容を保存 　→最初のテーブルは「テーブル名.*」として一覧に追加、その他のテーブルは、必要な項目だけを追加 ここまで実行した後で、レコードソースのクエリデザインビューを閉じて、フォームのデザインビューに戻ります。 プロパティのレコードソース以外の項目をクリックしてフォーカスを移動させます。 ここで Ctrl + S を押してフォームを保存します。 4. 以降の手順を実行します。 以上でどうでしょうか。
Winで試してみたけど2行目は簡易パスになってますね。 MacはPDFもピクチャと同様に扱えるのでサイズが出てた。
＞各フォルダのデータを閲覧するためルートを作ってあげて目的のフォルダをひらけるようにしたいと ＞考えております。 私は、セルにHYPERLINKリンク関数を使って、ファイルやフォルダーを開いています。 URLやエクセル以外のファイルもクリック一つで開くことが出来ます。
建物NOを文字列化して、数字以外で、かつ、部屋番号に使わない文字（例えばアンダーバー）を間に挟んで、部屋番号と連結して、文字列を生成する。 例： 建物NO：125、部屋番号：A301⇒125_A301 建物NO：128、部屋番号：202⇒128_202 建物NO：1282、部屋番号：02⇒1282_02 建物NO：211、部屋番号：103⇒211_103 建物NO：21、部屋番号：1103⇒21_1103
型番-枝番 という形式が固定されているなら、 　instrで - を探す→ - みつかったら以降を削除(substr) 型番の桁が決まっているなら 　substr(キー,型番の桁数) 等が考えられます。 また、「キー」列を「型番」「枝番」に分けたテーブルにして、使用時に必要なら 「型番」|| '-' || 「枝番」 みたいに連結する、とか。
http://oshiete.goo.ne.jp/qa/8847812.html の方に回答を書いたので、そちらを参照して下さい。
こんばんは！ Sheet2のA1セルに =IF(Sheet1!A1="","",Sheet1!A1) という数式を入れておけば大丈夫だと思いますが・・・ どうしてもVBAで！というコトであれば ↓のコードをSheet1のシートモジュールにしてSheet1のA1セルにデータを入れてみてください。 Private Sub Worksheet_Change(ByVal Target As Range) If Target.Address = "$A$1" Then Worksheets("Sheet2").Range("A1") = Target End If End Sub ※　汎用性から考ると、数式で処理できるのであればそれの方が簡単だと思います。 （1）VBAの場合、範囲等こちらで設定してやる必要がある。 （2）本来は考えられるエラー等も対処しておく必要がある。 などなど・・・ ※　上記コードはA1セル限定です。m(_ _)m
添付図を忘れていました。
＞何しろ、ITの担当が私だけですので。1人で全部作っていますから。 私も、設計からプログラミング、導入時のレクチャーを一人で担当してきました。各種伝票のレイアウトに印刷発注、事務所と工場のレイアウトの設計、原価計算の仕組みから売上計算システムの改変。超片田舎なもんで地元のソフトハウスにも、この手の開発経験者はゼロ。まあ、でも、一人でもできました。質問者もできますよ。 Q、(1)(2)については、どのような設計をされていましたでしょうか？ A、生データの編集とインポートを行うプログラムで対応。 出力部門によって生データのどれとどれが必要なのかは大きく違ってきます。ですから、各担当部署は、生データ蓄積データベースから適当な時間を見計らって必要なデータを利用しやすい形に加工しつつインポート。加えて、独自に入力すべきデータの入力処理を行った後に、必要な演算と出力を行ってきたと記憶しています。なお、生データ蓄積PCと各部門PCとは、サーバーで共有すべきデータについても吐き出していたんじゃーないかと・・・。 ＞バッチのようなものを作り、それを深夜実行する。 これは、MS-DOS時代のやり方。今の時代、どんなに大量のデータであっても数十秒で加工しつつインポートすることができると思いますよ。 PS、できれば的を絞って再質問されて本当のプロからのアドバイスを！
>索引を非保存にする と書いてるのに。。。
＃１ですが、ご使用のSQLServerが2008以降なら、 「DTS」をインストールする必要があります。
> また、テーブルと画面とで分割しようと考えています。 というのが、どのようなことを想定しているのか、理解できません。 もう少し具体的に説明してもらえますか。 とりあえず、これは無視して、 > ・連結フォームの場合でネットワークで複数ユーザ（二人～三人ほど）が使用する。 > ・非連結フォームの場合で、ネットワークで複数ユーザ（二人～三人ほど）が使用する。 複数ユーザーが同時接続するなら、採番管理用のテーブルを利用したほうがいいでしょう。 採番管理テーブルには現在の主キーの最大値を格納しておきます。 新規追加するときに、採番管理テーブルを排他ロックをかけて開き、取得した値に+1して、その値を入力テーブルの主キーに設定して、採番管理テーブルの値も更新します。 もし、採番管理テーブルを開こうとしてロックがかかっていた場合は、しばらく待って、再試行をするというようにします。 非連結テーブルの場合は、上記の処理を保存コマンドボタンに設定します。 連結フォームなら、フォームの更新前処理で、NewRecord のときに実行します。
accessなら以下参考にしてください http://oshiete.goo.ne.jp/qa/3239942.html
＞テキストボックスのrecordソースがその式であれば、 ＞式が判断した値が自動で表示されるのが当たり前のような気がしますが・・・ 私もそのように思いますよ。実際に、（リレーショナルの有無に関わらず）普通はそうです。なぜ、そうならないのか？そこが不思議だということです。
＃７です 修正量がそう多くなかったので回答してみます。 修正点 ・ハイパーリンクしない ・出来上がるシート名は「1R」「2R」・・・「xR」 ・抽出内容が無くてもシートは初期化する ・騎手名は C1 から始まり、終了は空白が２行続いたら 　（24 に限定せず、書かれていた分を処理する） Public Sub Samp2() 　　Dim cn As Object, rs As Object 　　Dim sSql As String, sS As String 　　Dim v As Variant 　　Dim iRow As Long, iRowN As Long, iR As Long 　　Dim i As Integer 　　Const adStateOpen = 1 　　Const PN2007 As String = "Microsoft.ACE.OLEDB.12.0" 　　Const PN2003 As String = "Microsoft.Jet.OLEDB.4.0" 　　Const CMDB As String = "\2014.mdb" 　　Const CSQL = "SELECT * FROM 2014 WHERE 騎手名 IN ('{%1}');" 　　On Error Resume Next 　　Set cn = CreateObject("ADODB.Connection") 　　For Each v In Array(PN2007, PN2003) 　　　　cn.Open "Provider=" & v _ 　　　　　　& ";Data Source=" & ThisWorkbook.Path & CMDB 　　　　If (cn.State = adStateOpen) Then Exit For 　　Next 　　If (IsEmpty(v)) Then 　　　　MsgBox "環境不足で処理中断", vbCritical 　　　　Set cn = Nothing 　　　　Exit Sub 　　End If 　　On Error GoTo 0 　　Application.ScreenUpdating = False 　　With Worksheets("SheetDB") 　　　　iR = 1 　　　　iRow = 1 　　　　While (.Cells(iRow, "C") <> "") 　　　　　　iRowN = iRow 　　　　　　With .Cells(iRow, "C") 　　　　　　　　If (.Offset(1) <> "") Then iRowN = .End(xlDown).Row 　　　　　　　　v = WorksheetFunction.Transpose(.Resize(iRowN - iRow + 1)) 　　　　　　End With 　　　　　　If (IsArray(v)) Then 　　　　　　　　sSql = Replace(CSQL, "{%1}", Join(v, "','")) 　　　　　　Else 　　　　　　　　sSql = Replace(CSQL, "{%1}", v) 　　　　　　End If 　　　　　　sS = iR & "R" 　　　　　　For Each v In Worksheets 　　　　　　　　If (v.Name = sS) Then Exit For 　　　　　　Next 　　　　　　If (IsEmpty(v)) Then 　　　　　　　　With Worksheets.Add(After:=Worksheets(Worksheets.Count)) 　　　　　　　　　　.Name = sS 　　　　　　　　End With 　　　　　　Else 　　　　　　　　v.Activate 　　　　　　　　Cells.ClearContents 　　　　　　End If 　　　　　　Set rs = cn.Execute(sSql) 　　　　　　If (Not rs.EOF) Then 　　　　　　　　With Range("A1") 　　　　　　　　　　For i = 0 To rs.Fields.Count - 1 　　　　　　　　　　　　.Offset(, i) = rs(i).Name 　　　　　　　　　　Next 　　　　　　　　　　.Offset(1).CopyFromRecordset rs 　　　　　　　　End With 　　　　　　End If 　　　　　　rs.Close 　　　　　　Set rs = Nothing 　　　　　　iRow = iRowN + 2 　　　　　　iR = iR + 1 　　　　Wend 　　　　.Activate 　　End With 　　cn.Close 　　Set cn = Nothing 　　Application.ScreenUpdating = True End Sub
ExcelからAccessのテーブルを更新するということならば 以下のような感じですか。Accessで更新クエリを作ってみれば わかりますが。 Sub test() Dim cn As New ADODB.Connection Dim cmd As New ADODB.Command Dim strSQL As String Dim strPath As String strSQL = "UPDATE Childrenテーブル INNER JOIN Parentsテーブル " & _ "ON Childrenテーブル.ParentID = Parentsテーブル.ID SET Childrenテーブル.Flag = 1 " & _ "WHERE ([Parentsテーブル]![HasChild])=True AND ([Parentsテーブル]![AGE])=20 AND ([Childrenテーブル]![Male])=True" strPath = ThisWorkbook.Path & "\sample.mdb" cn.Open "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & strPath Set cmd.ActiveConnection = cn With cmd 　　　　.CommandText = strSQL 　　　　.CommandType = adCmdText 　　　　.Prepared = True End With cmd.Execute Set cmd = Nothing cn.Close: Set cn = Nothing End Sub なお、SQL文の中身は UPDATE Childrenテーブル INNER JOIN Parentsテーブル ON Childrenテーブル.ParentID = Parentsテーブル.ID SET Childrenテーブル.Flag = 1 WHERE ([Parentsテーブル]![HasChild])=True AND ([Parentsテーブル]![AGE])=20 AND ([Childrenテーブル]![Male])=True; ですので、コード表が乱れていたら訂正してください。
Q1、売上が確定するとは、入金された時ということでしょうか？ A1、それは、私ではなく会社に聞くべき事柄。 私は、一般論として発生主義としか言えません。 Q2、どこで、どうやって帳尻を合わせたらいいのでしょうか？ A2、それも、私ではなく会社に聞くべき事柄。 私は、帳尻を合わせる必要はさらさらないと思いますよ。 そのための、見積り金額からの自由の確保ですから・・・。
この処理が邪魔しているようですが。 　　Me.RecordSource = StrRecSource 本当に必要ですか？
＞どうも、大文字と小文字の差の様ですが case-sensitive=OFFの時、sqliteはLIKE演算に対してインデックスを使わないとのことです
>とりあえず最初の容量等をしれればと思いました。 「微々たるもの」じゃ回答になっていませんか？ ＞PostgreSQLに関してはどこに載っているか探しましたがわからず・・・。 たとえば例示したリンクからダウンロードリンクをたどれば 各OSの各バージョンがリンクされていますよね？ たとえばWin版だとアーカイブファイルで50Mそこそこですから インストールしても2～300Mでしょう もしそのくらいの容量が気になるPCなら、データの保存ができないので DBでデータ管理するのはあきらめた方がよいです。
SQL Serverのbit型と、AccessのYes/No型が対応しているようになっていますが SQLコマンドで処理する場合に違いがあります。 ※ リンクして使う分には大丈夫ですが。 bit型の値は、0または1なのに対して Yes/No型の値は、falseまたはtrueです。 この違いを知っていないと、SQLコマンドで処理するときにハマります。
#1 の回答は番号フィールドにNull がある複数のレコードが存在する場合の サンプルです。 ※最後に採番テーブルの番号の値を変更するのが抜けてました。 rs.close:set rs =nothing の前に currentdb.execute("update 採番テーブル set 番号 =" & maxnum) を追加してください。 １レコードずつ手入力で行っている場合はまた別の話になります。 フォームのレコード移動時イベントに if me.newrecord then me!フォームの番号コントロール名 = Nz(DMax("番号", "採番テーブル"), 0) +1 ・・・とかになりますが 採番テーブルの方の番号を更新するタイミングは更新前処理に行えば 良いでしょう。 が、もしかしてマルチユーザー環境で・・・と考えているのなら 全部忘れてください。ハードルがぐっと上がりますので確かな回答は出来ません。 こちらが参考になるかと思いますけど。。。 [VB] DAO でユーザー定義カウンターを実装する方法 http://support2.microsoft.com/default.aspx?scid= … 私からは以上です。
　Microsoft　は、オートナンバーの主キーの型を長整数（Long型）にしています。その理由は、整数（Intege型）についで処理速度が速いからです。キーの命は、なんと言っても処理速度。とは言っても、社員テーブルなんかは整数（Intege型）で十分間に合う訳です。でも、私は、そのように細かく使い分ける時代は終わったと思っています。なんでもかんでも主キーは長整数（Long型）で押し通しても問題ないかと思います。ただ、DECIMAL型を用いる意義はほとんどないと思いますよ。
セキュリティセンターで信頼できる場所を設定してそこにファイルを置いても駄目ですか? http://www.mkkobo.com/SecuritySet/SecuritySet201 …
>CurrentDb.Updatable　って何をしようとして... よく知らないですけど、、、 アクセスの環境変数みたいなものとして持っているものを返しているんじゃないかな？ ざっくばらんに言うと、どういう形でDBを開いたかをどこかで覚えておくためのものだと思います。 （ldb内に格納されているんじゃないかな）。 多分、参照だけなので、他には何の影響もないと思いますが、まあ、納品物なら 動作検証等はやっておいたほうがよいのかもしれませんね。
ブックマークが参照できません・・の時点で エラー処理出来たら良かったんでしょうけど、 いまさら言っても始まらないですね・・・。 以下は推測にすぎませんが ファイルをパスワード保護しているか、 「レコードレベルでロックして開く」のチェックが外れている場合に ページレベルのロックになります。 http://office.microsoft.com/ja-jp/access-help/HP … （2010でも同様です） で、Accessのキャッシュか遅延書き込みの際に 何かしらの問題があってカレントレコードだけではなく ページ（４Kバイト）単位でおかしくなったのでは？ Accessの場合1日１回のバックアップでは安心できません。 モノによってですが、タスクスケジューラで 出社時・昼食時・定時退社時間時 の１日３回×三日分の世代バックアップを取っています。 （安定動作するようになってからはお世話になっていませんが大事な保険）
多分、無意味な補足かと思いますが・・・。 1:TRANSFORM Sum(T1.件数) AS 件数のカウント 2:TRANSFORM Nz(Sum(T1.件数),0) AS 件数のカウント 1の戻り値は"" 2の戻り値は0 ですから、空欄ではなく0を表示したい時は Nz()で。
【補足】売上入力と工事台帳との関係。 これは、補足するまでもないこと。あらゆるソフトが、そのようになっていることですが・・・。 ＜工事台帳入力⇒売上伝票入力が主な流れとは限らない＞ 既製品を繰り返し販売しない場合、売上入力時に工事台帳に追加するフォームをオープンすることがほとんどでしょう。そうして、そのフォームを閉じる時に、売上入力フォームに各種データをコピー。もちろん、リンクさせてはダメですよ。 なお、当然に、新規顧客の場合も、売上伝票から顧客登録フォームを開きます。 PS、顧客台帳には、有効・無効フラッグを指示できる列があるといいでしょう。それで、各種集計を高速化できるでしょう。
単純にテーブル[会社]のみでフォームを作成し、社員表示用テキストボックスを追加。そして、そのプロパティを表示し コントロールソース=DBLookup("SELECT 社員名 FROM 社員 WHERE 会社ID=" & [会社ID] & " ORDER BY ソート番号") これは、以下の標準モジュールに登録したユーザ関数 DBLookup()を使っています。これで、クエリを用意しなくても目的を達成できます。 さて、かかるユーザ関数を標準ライブラリに登録したくない場合、 １、"社員ソートクエリ"を作成します。 SELECT 社員.会社ID, 社員.社員名 FROM 社員 ORDER BY 社員.ソート番号; ２、コントロールソースに次のように書きます。 =DLookUp("社員名","社員ソートクエリ","会社ID=" & [会社ID]) http://office.microsoft.com/ja-jp/access-help/HA … DLookup()については、マイクロソフトの解説を参照されてください。 【DLookup()の限界を破るにはVBAで同じ関数を作るしかない】 マイクロソフトの解説を読めば判りますが、ORDER BY 節を指定する引数が用意されていません。ですから、どうしても、"社員ソートクエリ"を作成するという手間が必要となります。そこで、SQL文を引数とするDBLookup()をVBAで書けば、その手間を省けるという算段になります。この辺りは、好みと趣味の問題。どっちでも良いと思います。そういうお断りをした上で DBLookup()を紹介しておきます。なお、ADOは、つぎのように参照設定しないと利用できません。 http://www.happy2-island.com/access/gogo03/capte … Public Function DBLookup(ByVal strQuerySQL As String, _ 　　　　　　　　　　　　　Optional ByVal ReturnValue = Null) As Variant On Error GoTo Err_DBLookup 　　Dim DataValue 　　Dim rst　　　　 As ADODB.Recordset 　　Set rst = New ADODB.Recordset 　　With rst 　　　　.Open strQuerySQL, _ 　　　　　　　CurrentProject.Connection, _ 　　　　　　　adOpenStatic, _ 　　　　　　　adLockReadOnly 　　　　If Not .BOF Then 　　　　　　.MoveFirst 　　　　　　DataValue = .Fields(0) 　　　　End If 　　End With Exit_DBLookup: On Error Resume Next 　　rst.Close 　　Set rst = Nothing 　　DBLookup = IIf(Len(DataValue & ""), DataValue, ReturnValue) 　　Exit Function Err_DBLookup: 　　MsgBox "SELECT 文の実行時にエラーが発生しました。(DBLookup)" & Chr$(13) & Chr$(13) & _ 　　　　　 "・Err.Description=" & Err.Description & Chr$(13) & _ 　　　　　 "・SQL Text=" & strQuerySQL, _ 　　　　　 vbExclamation, " 関数エラーメッセージ" 　　Resume Exit_DBLookup End Function
ファイルメーカーのレイアウトですよね、用紙が100mmの148mm、 これが最大の用紙なら、上下、10ミリは、マージンを取らないと、上10ミリ、ヘッダー領域、 した10ミリ、フッダーになります。 その領域の中に、レコードやフィールドを設定するので、 もちろん、サイドも5ミリはマージンを取ってください。
VBAになりますが、フォームのコマンドボタンのクリック時イベントなどに On Error Resume Next DoCmd.OpenReport "レポートの名前", acViewPreview DoCmd.RunCommand acCmdPrint DoCmd.Close とすれば近いことは出来るかもです。 （実際に印刷まで行って検証した訳ではありません） 印刷プレビュー画面の上に設定画面が出ます。 但し、印刷設定画面を閉じない限り、プレビューに切り替えてみることは出来ませんでした。 On Error Resume Next は印刷設定画面でキャンセルした場合に 実行時エラー 2501 RunCommand アクションの実行は取り消されました。 のエラー表示を回避するために入れています。 印刷設定で何を変更したいのかにもよりますが Docmd.PrintOut メソッドについても調べると 吉 かもしれません。
非常にこころもとない回答ですが、ちょっと調べてみました。 Dim XL As Object Dim BK As Object Dim SH As Object Set BK = GetObject("d:\DATA\123.xlsm", "Excel.sheet") Stop として止めておいてイミディエイトウィンドウで bk.worksheets(3).select はオートメーションエラーで失敗しました。 でも、 ?bk.worksheets(3).name や ?bk.worksheets("Sheet1").cells(1,1).value bk.worksheets(2).cells(1,1) = "ABC" と代入 は成功しました。 なので、この場合の BK はシートの集合体なのだろうと思います。 クラスには、Excel.Chart というのもあるので 図？に関しては別の扱いのような・・・？？？なので BK はブックの一部の様です。 bk.worksheets(3).select を成功させるためには Set XL = BK.Parent.Application XL.Windows(BK.Name).Visible = True bk.worksheets(3).select と２行追加で OK っぽい？です。？ 確認するためには、Xl.Visible = true としてみました。 Excelの大元の『親』が必要のようです。 しかし、 bk.worksheets(3).activate は無くてもなぜ成功するのか？ ヘルプ見ても謎は深まるばかり。。。
=IIF(IsNull(Filed1),0,1)+IIF(IsNull(Filed2),0,1)+IIF(IsNull(Filed3),0,1)+・・・+IIF(IsNull(Filed14),0,1) みたいな式でどうでしょう？
【疑問】今のアプローチは正しいのか？ ＞毎月の在庫回転期間を求めたいのです。 商品名｜月次出庫数｜月次期首在庫｜月次期末在庫｜月次在庫回転率｜月次在庫回転期間 ＡＡ１｜＿＿１００｜＿＿＿１００｜＿＿＿＿＿０｜＿＿２．０００｜＿＿＿０．５ヶ月 ＡＡ２｜＿＿＿５０｜＿＿＿１００｜＿＿＿＿５０｜＿＿０．６６６｜＿＿＿１．５ヶ月 ＡＡ３｜＿＿＿＿０｜＿＿＿１００｜＿＿＿１００｜＿＿０．０００｜＿＿＿＿＿＿＿＿ 商品ＡＡ１は、月次平均在庫数は５０。 これを一ヶ月で２倍の１００個出庫。 ですから、在庫回転期間は０．５ヶ月。 商品ＡＡ２は、月次平均在庫数は７５。 これを一ヶ月で５０個出庫。 ですから、在庫を出庫しきるにはもう半月を必要とします。 よって、在庫回転期間は１．５ヶ月。 敢えて、単月で「在庫回転期間]を出すとすれば上図のようです。 この結果を、更に、次のようにレポートしたい。 商品名｜７月度在庫回転期間｜８月度在庫回転期間｜９月度在庫回転期間｜平均在庫回転期間｜ ＡＡ１｜＿＿＿＿１／２ヶ月｜＿＿＿＿１／２ヶ月｜＿＿＿＿１／２ヶ月｜＿＿＿１／２ヶ月｜ ならば、 課題は、単月での「在庫回転期間]を求めるだけで事足りるのではと思いますよ。「商品別在庫回転期間推移表」は、単に、レポート出力の手の問題。 【在庫回転期間の定義は横に置いて】 要は、「商品別在庫回転期間推移表」をレポートすれば事足りる訳ですので・・・ <<テーブル「在庫回転台帳」>> ID=1 会社コード=XXXX 商品コード=XXXX <<テーブル「在庫回転明細」>> ID=1 在庫回転台帳_ID=1 月次=201405 月次月次出庫数=100 月次期首在庫=100 月次期末在庫=0 月次在庫回転率=2.00 ※列[月次在庫回転期間]は、月次在庫回転率の逆数なので必要ありません。 ※もちろん、質問者のいう「在庫回転率」でも同じ設計ですよ。 ID=1 在庫回転台帳_ID=1 月次=201405 前々月出庫数=XXX 前月出庫数=XXX 当月出庫数=XXX 月次在庫回転期間=XXX ↑ あくまでも雛形。私には、月次在庫回転期間の求め方がよく理解できていませんので当てずっぽうで書いています。 という二つのテーブルを生成すれば簡単に目的は達成できるかと思いますよ。「商品別在庫回転期間推移表」の出力は小一時間で終了します。ですから、レポート出力のことは一切考える必要はありません。
select 番号,max(値段) from テーブル where 番号=(select min(番号) from テーブル)
No1です。抜け落ちが、 For I = 0 to MyRs.Fields.Count - 1 obj.sheets(シート名).Cells(1,i+1) = MyRs.Fields(i).Name Next i ですね。セルの指定も反対になっていました。
Access VBAよりExcelのシート名を取得 http://oshiete.goo.ne.jp/qa/8772873.html ここでの OpenSchema を使用したものは不評だったでしょうか というのは置いといて 関数を用意しました いろんなパターンでテストはしていないので・・・ （完成形ではないので不具合等は修正してください） GetExcelSheet に、Excelファイルのフルパスを与えると シート名の配列が Variant で得られます。 内部でエラーがあったら、最後のエラー番号を返します。 内部の動きとして、GetObject で対象の Excel ファイルを開きます。 GetObject で初めて開かれた場合、そのファイルの Visible は False False なら後始末としてそのファイルを閉じ、 結果 Excel で開いているファイルが無ければ、Excel を終了します。 つまり、既に開いていたものについては閉じる事はしません。 この関数の使い方は、後半の Samp1 を例としてください。 Public Function GetExcelSheet(sPath As String) As Variant 　　Dim oApp As Object, oBook As Object 　　Dim vA() As Variant, v As Variant 　　Dim i As Long 　　On Error Resume Next 　　i = 0 　　Set oBook = GetObject(sPath) 　　If (Not oBook Is Nothing) Then 　　　　For Each v In oBook.Worksheets 　　　　　　ReDim Preserve vA(i) 　　　　　　vA(i) = v.Name 　　　　　　i = i + 1 　　　　Next 　　　　Set oApp = oBook.Application 　　　　For Each v In oApp.Windows 　　　　　　If (v.Caption = oBook.Name) Then 　　　　　　　　If (Not v.Visible) Then 　　　　　　　　　　oBook.Close SaveChanges:=False 　　　　　　　　End If 　　　　　　　　Exit For 　　　　　　End If 　　　　Next 　　　　Set oBook = Nothing 　　　　If (oApp.Workbooks.Count = 0) Then oApp.Quit 　　　　Set oApp = Nothing 　　End If 　　GetExcelSheet = vA 　　If (Err <> 0) Then GetExcelSheet = Err.Number End Function Public Sub Samp1() 　　Dim v As Variant 　　Dim sS As String 　　Dim i As Long '　　v = GetExcelSheet(CurrentProject.Path & "\test.xlsm") 　　v = GetExcelSheet("C:\test\テスト.xlsx") 　　If (IsArray(v)) Then 　　　　sS = "> シート数 = " & UBound(v) + 1 & vbCrLf 　　　　For i = 0 To UBound(v) 　　　　　　sS = sS & v(i) & vbCrLf 　　　　Next 　　　　MsgBox sS 　　End If End Sub 余談） piroin654 さんのは >　　With appObj >　　　　For Each appObj In .Sheets 部分の、For Each 用の変数を変更すれば良いと思います。 また、Shell で起動しておくことは不要と思います。 （/Runtime オプション付きで起動した中での確認なので？）
メモ型が切れるんですね キーワード「 CSVでエクスポートするとメモ型長文の後半が切れてしまいます。」を グーグル検索すると、VBAによる出力サンプルを見つけられます
フォーム参照のパラメータクエリをVBAで扱う方法 http://www.tsware.jp/tips/tips_586.htm かな。
途中から失礼します。 >請求先から複数の依頼案件にまたがって入金されたりすることもあるので、 >それをシステム設計で自動的に、 >顧客がどの依頼案件の支払なのかを作りこむことは出来ないのでしょうか？ ここの部分だけですが、件数が少ない（５件とか）場合は なんとかなる場合もあります。 が、 実体験から、 １・条件を満たす複数の組み合わせが出来る場合が多い。 ２・件数が多いと時間が掛かりすぎて無理。２のｎ乗の組み合わせから探すことに、ｎは件数。 （出来たとしても１の問題があります） ３・振込手数料の問題 （通常は手数料を振込元が負担していたがタマに手数料を差し引いた額になる） （経由する金融機関次第で手数料が変わる。） （普段は都銀→都銀、タマに「じゃアタシがついでに振り込んどくね」で信金→都銀） ４・消費税の演算（誤差）の解釈の違いから１円差でヒットしない、切り上げ・四捨五入とか。 ５・その他、作業・納品などに問題があって・・等々などなどナドナドで無理でした。 で、 請求書には一意の番号を、 請求書の中の明細も全てを通じて一意の番号となるようにしておきます。 入金額に疑問がある場合には先方の経理担当に電話して どの請求書番号（請求明細番号）についての入金なのかを確認していました。 しっかりした経理なら応えてくれるはずです。 非常にアナログ的ですが、消しこんでゆく方法は他に無いのでは？と思います。
補足: 1対多であれば、先の補足は無視してください。
通常、ご質問のような事はしません。 同じデータが複数のテーブルにあることで ファイルサイズが大きくなってしまう。 一つのテーブルだけ一部のデータを更新し、 残りのテーブルの更新を行わなかった場合にデータの整合性が取れなくなる。 （顧客番号110の商品番号10の3月のデータがテーブルAとテーブルBで異なるけどどっちが正しいの？） などよろしくありません。 一般的？には テーブル1 顧客番号|商品番号|　年月|金額 　　　10|　　　10|201401|　50 　　　11|　　　10|201401|　20 　　　10|　　　10|201402|　30 　　　10|　　　20|201401|　50 　　　11|　　　20|201401|　30 　　　10|　　　30|201402|　10 のようなテーブル構造にしてクロス集計クエリで 顧客番号|商品番号|合計金額|201401|201402 　　　10|　　　10|　　　80|　　50|　　30 　　　10|　　　20|　　　50|　　50| 　　　10|　　　30|　　　10|　　　|　　10 　　　11|　　　10|　　　20|　　20| 　　　11|　　　20|　　　30|　　30| とすると思いますけど？ ※レイアウトが崩れてしまっていたらメモ帳にでもコピペしてフォントを等幅にしてください。 Access2002の場合のでちょっと古いですが今どき（2010など）でも一緒です。 https://www.microsoft.com/japan/office/previous/ … ご参考まで。
SQLiteの関数やフローの仕様がよくわかっていませんが CASE WHEN random()<=30/88 THEN 1 WHEN random()<=22/58 THEN 2 WHEN random()<=18/36 THEN 3 WHEN random()<=13/18 THEN 4 WHEN random()<=4/5 THEN 5 ELSE 6 END 的な処理をすればいいのでは？
　環境の記載が無いので、いったい、どこまでの構文が使える不明なので考え方だけ。 　一つビューを作ります。 　ビューのカラムは、元のテーブル全てのカラムに、pointの百分率の累計値を付け加えたものです。（もし、データが三桁の個数があるなら千分率に、四桁の個数があるなら、万分率にしてください） 　１００まで（千分率なら１０００まで、万分率なら１００００まで）の乱数を生成し、乱数の数値以下で且つ最大の累計値を持つレコードを選びます。 　これで、ポイントの比率に従った確率で、ランダムなレコードが選定できます。 　工夫すれば、ビューを生成しなくても一つのＳＱＬで組めるかもしれませんが、利用できるselectの構文に依存します。 　累計値が一つのＳＱＬで生成できるかも、同じくです。
なんだか以前にも似たような質問を見かけたことが あるのですが、忘れました。 「参照」とあるのはこのテーブルの値を参照して 他のテーブルの数値の合計を出すとか、そういうことですか。 もし、そうであるならば、二つのテーブルをレコードセット にしてグルグルとループさせる必要があるならば少し 具体的でないと関数が書けないと思いますが。 質問のテーブルは連続した数値が1から並んでいますが、 実際にもそうなのですか。 データベースのテーブルはデータの並びにユニークキーが なければ、データの並びはランダムなので、「3セル分上の値」 ということは確定できません。あるいは、質問の「数字」の フィールドのようにデータが昇順になっている、あるいは 昇順に設定できる、ということであれば話は別ですが。 もっとも「7を基点に4までの範囲」と「７を起点に7,6,5,4という 感じで3セル分上の値を指します。」の部分が謎なのですが。 No2さんは理解しておられるようですが。 どのように「数字」からデータを取り出し、どのような合計を 出したいのか具体的なプロセスがわかれば簡単なのですが。
＞この場合、一つのテーブルに同じ都道府県や市区町村が重複して入るのを良しとす ＞るお考えでよろしいでしょうか? ＞この場合、運用上のやりやすさを考えたご提案かと思いましたが、その場合、デー ＞タ量が多少大きくなるのはOKとされますか? ENUMやSETで処理する限り、内部的には数値で管理されるため理論的に容量はさほど 大きくはなりません。したがって都道府県などリストの内容がほぼ普遍的なものに ついては容量を理由に正規化する必要はありません。 （とはいえ10年単位で考えると都道府県合併も可能性はありますが・・・） http://ja.wikipedia.org/wiki/%E5%88%97%E6%8C%99% … また市区町村は結構変更があるのと都道府県の下につく二次データであることから ENUMやSETに向きません。 正規化してもいいし、そのまま文字データで持ってもいいと思います。 ＞「SQLにおける効率的なデータは必ずしも容量を少なくするものではありません。」 正規化というのは多数の重複がある前提の技術です。 重複数があまりない場合は理論的には効率化されていますが実際には無駄な処理に なります。 また該当するカラムを集計のキーに使わない場合は無駄にインデックスを消費するため データは大きくなる半面全体的なスピードは低下する傾向にあります。 たとえば仮に「東京都」でデータを抽出するとき、ダイレクトに書いてある場合は 直にインデックスが効きますが、正規化してあると都道府県テーブルから 「東京都」を探し、都道府県IDを抽出したうえで都道府県IDに紐づいたレコードを 探すことになるので、処理的にはむしろ効率的ではありません。 実際には都道府県IDを最初から抽出した状態から検索するインタフェースなので 逆に正規化しておかないと、都道府県リストを都度つくる無駄がでますので 善し悪しでしょう。 ＞「都道府県名を入力欄にいれると不正にデータを抜かれやすくなると言われていた ＞時期もありますが、 ＞セキュアな技術を使えばそれは避けられるでしょう」 端的にいえばSSLで解決します。 もちろん都道府県IDに紐づけばトラフィックも減らせるので悪いわけではありません。 またインターネットのトラフィックが爆発的に増えている現在 よほど重要な個人情報でないかぎり住所からデータを不正に抜くことが 現実的ではなくなっているきらいもあります。 ＞都道府県名に対して、外部制約キーをつかったり、データ型をsetにしたりする ＞ことでデータを効率化することも可能です。 一部訂正します。 住所は都道府県が２つ以上存在しないためSET型よりENUM型がよいでしょう。 http://dev.mysql.com/doc/refman/5.1-olh/ja/enum. … ＞市町村名まで正規化するのが実用的かどうか 経験則でいえば、正規化する意義はあまり感じません。 例えば何万、何十万というデータ郡から市町村単位で広範なデータを集計する ようなケースを想定しているのであれば話は別ですが、単なる住所録としては メンテナンス性がおちるため市区町村名での正規化はお勧めしません。
利用者数 に対してフィールド名の別名宣言を省略しているのことに対する疑問でしょうか。 ユニオンクエリにした場合、フィールド数とデータ型があっていればフィールド名は異なっていも問題ないです。 最初のSELECT文のフィールド名が採用されます。 ですので、2番目は別名の宣言は省略しても問題ないのです。 SELECT "商品数" AS 項目, 年月, 商品数 AS 数量 FROM テーブル名 UNION ALL SELECT "利用者数", 年月, 利用者数 FROM テーブル名; これでもいいし、省略せずに丁寧に書けば、 SELECT "商品数" AS 項目, 年月, 商品数 AS 数量 FROM テーブル名 UNION ALL SELECT "利用者数" AS 項目, 年月, 利用者数 AS 数量 FROM テーブル名; となります。 最初のSQLは片方は別名宣言して、片方は省略したので紛らわしかったですね。 疑問に思ったことはこのようなことでしたしょうか。
Salary　テーブルの index がどうなってるかによります。 データ自体は、参考例に１，２行あればいいので、create 文の方を載せてほしかったですね。カラム区切りも解らなくなっていて、ほとんど載せる意味がない。 テーブルの意義から言って、Salaryテーブルでは、日付とEmployeeIDが決まれば、一行しか存在しないことが必要だと思いますが、もし、この２カラム連動でのunique index を貼っていなくて、同日に同一者に多重支払いしている行が存在するなら、Bと名付けたサブクエリ内でgroup by EmployeeID として、取得結果側カラムは sum(Amount) as Amount とする必要があるでしょう。 でも、現実の状況で、もし、同じ日付＆同じEmployeeIDで複数行あったら、バグ扱いになりそ。
Access　VBAにてExcelファイルのシート名を取得したい http://answers.microsoft.com/ja-jp/office/forum/ … でも質問されているようですが、以下に違う方法を紹介しておきます。 （ADO は使える環境になっているものとして） Public Sub Samp1() 　　Dim cn As New ADODB.Connection 　　Dim rs As ADODB.Recordset 　　Dim sA() As String 　　Dim i As Long 　　Const CFILE As String = "Excelファイルのフルパス" 　　cn.Open "Provider=Microsoft.ACE.OLEDB.12.0;" _ 　　　　　　& "Data Source=" & CFILE & ";" _ 　　　　　　& "Extended Properties='Excel 12.0'" 　　i = 0 　　Set rs = cn.OpenSchema(adSchemaTables) 　　While (Not rs.EOF) 　　　　ReDim Preserve sA(i) 　　　　sA(i) = Left(rs("TABLE_NAME"), Len(rs("TABLE_NAME")) - 1) 　　　　i = i + 1 　　　　rs.MoveNext 　　Wend 　　rs.Close 　　Set rs = Nothing 　　cn.Close ' '　この後、sA の配列（ 0 スタートの添え字）にシート名が入っているので、 '　続けて処理するとか ' End Sub ※ 一応、Excel ファイルが xls でも、変更することなく動くみたい ※ 2000 / 2003 で動かすのなら、以下２か所を変更してください Microsoft.ACE.OLEDB.12.0 ↓ Microsoft.Jet.OLEDB.4.0 Excel 12.0 ↓ Excel 8.0
テーブル名を ★★ フィールド名を、左から F1 ～ F5 と仮定します。 また、提示あった内容の順が保証されるように、 オートナンバ「an」昇順で表示されているものとします。 以下をクエリの SQLビューに記述してどうなりますか SELECT * FROM ★★ AS Q1, ★★ AS Q2 WHERE Q1.F1=1 AND Q1.F1<>Q2.F1 AND Q1.an < Q2.an AND IIF(Exists (SELECT 1 FROM ★★ WHERE F1=1 AND an>Q1.an), Q2.an < (SELECT Min(an) FROM ★★ WHERE F1=1 AND an>Q1.an), Q2.an <= (SELECT Max(an) FROM ★★));
見直したら、そもそもの条件がおかしいような気がします。 請求テーブルには[加入者ID]があるようには見えない。 > が選択されて、請求テーブルの更新日付を見て古い方を取ってくるので > 結局258087 20140412が取得されます。 201405 20140922が欲しいの？ 最初の１レコードを取得するロジック？ なら、現行のコードのまま、 > ORDER BY 更新日付 ASC を ORDER BY 更新日付 DESC にする。 直積使ってテーブル結合したらどうなるのかな？ SELECT 色々 --列名をt1、 t2で修飾してね FROM 請求テーブル t1, 請求テーブル t2 WHERE t1.識別ID = t2.識別ID AND t2. 加入者ID = 変数 ORDER BY t2.更新日付 DESC ; CREATE VIEW はググって下さい。 VIEWにするときはWHERE条件の AND t2. 加入者ID = 変数 は不要。VIEWに対してWHEREで変数を指定して下さい。
> で、実際のCSVファイルは数十万行あるのですが、 このファイルをコピー、編集して３行とかにしたら、２行目はきちんと取り込めますか？ 対象のCSVファイルの改行コードがVBAで想定しているものと違っていて、１行読み込むつもりが改行をきちんと見つけられずにファイル全体を読んでしまうとか？
変数にそのcsvファイルのパス例えば "file:" & Get ( デスクトップパス ) & "ファイル名.csv" とかを入れて、Event送信ステップでその「ファイルを開く」にすると エラー処理オン時はそのファイルが存在しない場合Get(最終エラー)=100 が返ります。有るときは開いてしまうけど、Windowsのコマンドか何かで 閉じることできるのかな？
【補足】MAX()、MIN()の回数を減らすには・・・。 SELECT 　　Max(Format([カード番号],"0000") & ":" & [名前]) AS THE_MAX, 　　Min(Format([カード番号],"0000") & ":" & [名前]) AS THE_MIN, 　　CutStr([THE_MAX],":",1) AS Max_番号, 　　CutStr([THE_MAX],":",2) AS Max_名前, 　　CutStr([THE_MIN],":",1) AS Min_番号, 　　CutStr([THE_MIN],":",2) AS Min_名前 FROM T4 GROUP BY T4.ファイル番号, T4.順番;
入力済みのデータなら、重複クエリウィザードで確認できます。 http://www.nbcom.co.jp/PC-Support/FAQ/acc/ht/acc … 新規のデータの追加をさせないなら、ロット、商品ID、生産者コードでユニークキーにすればいいのでは？ まあ条件付き書式でこだわるなら =DCount("*","テーブル名","ロット = '" & [ロット] & "' And 商品名 = '" & [商品名] & "' And 生産者 = '" & [生産者] & "'") >1 DCount関数 http://office.microsoft.com/ja-jp/access-help/HA …
よくあります。 何度もチャレンジしてみてください！ わたしは繰り返ししてたらできましたよ（＾∇＾）
CopyFromRecordsetについて調べてみると http://www.moug.net/tech/acvba/0090011.html オートメーションでExcelを操作した時にハマりそうな事 http://hanatyan.sakura.ne.jp/vbhlp/ExcelErr.htm
集計に１秒以上かかった場合集計中にデータが変化していくため １秒単位のデータをリアルタイムに集計することはかなり厳しいです 手っ取り早い高速化は例えば１日単位で中間的に集計したデータを 別のテーブルに保持し（日締処理）、当日分のデータと切り分けることです。 過去のデータは変化しないため集計することだけ考えればいいので。 そもそも1Gを86400秒で割ると毎秒11Kちょいのデータになります。 そうなると集計項目もかなり多いと予測されるので、 よほど真剣に仕様をきめこまないと運用に耐えないと思います
select id, iif(status=200,'ABC'+name+'XYZ',name), status from Members って感じ？試してないけど。
構築は可能です。 ただし運用できるかは質問者さんのスキル次第。 自分でファイルサーバを立ち上げることで解決しますね。 　　　ＲＡＩＤ１＋５ くらいで構築すれば良いと思います。 （ＲＡＩＤ６が必要かは判断できません） 手元にファイルサーバがあれば、それなりに早いＬＡＮ接続なら データの転送速度に不満は出ないと思います。 複数のパソコンから同時にアクセスするなら１００Ｇ　ＬＡＮおすすめ。 （１０Ｇでも良いかもしれませんがｗ） モバイル用途であれば、外付けＨＤＤを必要数用意してフォルダ単位で同期を取り 使用するデータが含まれる外付けＨＤＤを持ち出せばＯＫ。 まさかファイルサーバごと持ち出すわけにはいきませんからねｗ 手っ取り早く通信速度が速いプロバイダ契約をするというのもアリかもしれません。 （専用回線を契約するとかね）
CSVファイルの内容が提示無いので推測ですが 項目1,項目2,項目3 1,あ,あ,いい なら当然の結果と思います。 あ,あ　を１つの項目として扱いたいのなら、少なくとも 項目1,項目2,項目3 1,"あ,あ",いい という内容になっていないと１つの項目として解釈しないと思います。 元々のCSVファイルを作成する際に変更するよう依頼してみては？
CSV ファイルを、ヘッダなしファイルとして解釈させます。 以降得られるフィールド名は、F1、F2、・・・ 不要な　XXXXXX　部分は、２番目のフィールド以降 Null で除外判別できます。 ２行目の項目名部分の項目1は、 おそらく、以降のデータを解釈した際に数値と解釈されると思うので （項目1 部分が数値として解釈されたのなら Null に置き換わります） 項目1,項目2,項目3 ↓ Null,項目2,項目3 解釈が違っても項目1の有効なデータ部分は数値の様なので・・・ そこで、IsNumeric(F1) AND F2 Is Not Null　の条件を付加して インポートしたいテーブルと項目を列挙し、 それに対応する F1、F2、・・・・を記述した SQL を実行させれば終わりです。 以下は、項目3 までの記述になりますが Public Sub Samp1() 　　Const CSQL As String = "" _ 　　　　& "INSERT INTO テーブル名(項目1,項目2,項目3) " _ 　　　　& "SELECT F1, F2, F3 FROM [{%1}] IN " _ 　　　　& "'{%2}'[text;FMT=Delimited;HDR=No;IMEX=1] " _ 　　　　& "WHERE IsNumeric(F1) AND F2 Is Not Null;" 　　Const CPATH As String = "CSVファイルがあるフォルダへのフルパス" 　　Const CNAME As String = "CSVファイル名" 　　Dim sSql As String 　　sSql = CSQL 　　sSql = Replace(sSql, "{%1}", CNAME) 　　sSql = Replace(sSql, "{%2}", CPATH) 　　CurrentDb.Execute sSql End Sub ※ CSV ファイルのパスが D:\tmp\Hoge\テスト.csv だったら CPATH は、D:\tmp\Hoge CNAME は、テスト.csv
テーブル名は、Tseq とします。 下記のSQLでどうでしょうか。 Accessで試してうまくいきました。 SQLite ではどうか分かりません。 SELECT Tseq.ID FROM Tseq, Tseq AS T1, Tseq AS T2 WHERE Tseq.Point=30 AND T1.ID=Tseq.ID-1 AND T1.Point=20 AND T2.ID=Tseq.ID-2 AND T2.Point=10;
No.6です。 >Rubyのexcel2csvライブラリから勉強してみようと思います excel2csvはエクセルで作成したファイルをシート単位でデータを読み込むライブラリです。ドキュメントを見てもよくわかりませんでした。例が書いてあるのでそれを真似した使えるようになりました。主はRubyです。Pythonなどのスクリプト言語でもかまいませんが、一から始めるのでしたらRubyが良いのはないか勝手に思っています。多少複雑なことをするのでしたら強力なツールになりますので、何かのスクリプト言語を知っておくと業務の効率化に役に立つことが多いです。 ただし、excel2csvは既存のエクセルファイルのどこかのセルに書き込むなどの複雑なこと無理です。集計した結果を表示するとか、新しいエクセルファイルとして書き出すという用途には適しています。既存のEXCELファイルに手を加えるのでしたらVBAや http://magazine.rubyist.net/?0027-ExcellentRuby など（リンクの下の方に関連したリンクも）を参考にしてください。 さて、先に書いたファイルメーカーで作った予算管理データベースのことについて少し触れておきます。 だいぶ前になるのですが、外部資金をもらったプロジェクトをやっていて、そのプロジェクトのために会社のシステムと切り離した厳密な予算管理を要求されていましたので、土日を二回ほど潰して作ったものです。 発注、納品、支払いの品目ごとの管理と、月々の支払いの集計ができ、注文書や集計表の印刷や、未払いの金額を含めた予算管理ができるようにしました。 ファイルメーカーでもやる気になればこの程度のことはできます。結構複雑なことをしていましたので、作るのがたいへんではありましたが。 今だったら、Ruby on Railsで作った方がだいぶ楽なように思いますが、 顧客名簿などの比較的単純なものでしたら、ファイルメーカーが適していると思います。 No.7にの書かれているように共有が簡単にできますし、 顧客名簿程度でしたら素人でも手をつけられるものです。（私も素人ですが）
こんにちは！ Sheet1にコマンドボタンを挿入しておいて、コマンドボタンをクリックすると Sheet1の2行目データをSheet2の最終行以降にカット＆ペーストしたい！ という解釈です。 もしそうであればわざわざSheet1にデータを入力し、おなじデータをSheet2に持ってこなくても ユーザーフォームにテキストボックスを4個とコマンドボタンを配置し、 ユーザーフォームのコマンドボタンをクリックで直接Sheet2に表示させる方が簡単だと思いますが、 敢えて質問通りにやれば、 Sheet1のコマンドボタンのコードを↓のようにしてみてはどうでしょうか？ ＞したいことは、データ４列で・・・ とありますので、A2～D2セルとしています。 Private Sub CommandButton1_Click() Dim wS As Worksheet Set wS = Worksheets("Sheet2") Range("A2").Resize(, 4).Cut wS.Cells(Rows.Count, "A").End(xlUp).Offset(1) End Sub Excel2007以降をお使いだとして・・・ （ActiveXコントロールのコマンドボタンを挿入するとします） メニュー　→　開発　→　挿入　→　ActiveXのコマンドボタンを選択し、Sheet1に挿入 →　挿入したコマンドボタン上でダブルクリック　→　上記コードの1行目と最終行はすでに表示されている状態ですので、 2行目～最後から2行目までをドラッグ＆コピー　→　そのままVBE画面のカーソルが点滅しているところに貼り付け →　「デザインモード」を解除してSheet1に戻りA2～D2セルにデータ入力　→　コマンドボタンをクリック！ としてみてください。 ※　今回はActiveXコントロールのコマンドボタンとしましたが、 オートシェイプ等でも構いません。m(_ _)m
こちらの質問をされた方ですよね。 http://oshiete.goo.ne.jp/qa/8691890.html AccessとSQLServerによる環境構築(フロントエンドやバックエンドと仰っている新環境)について、ちょっとうまく伝わらなかったみたいですね(汗)それは後述するとして、先に質問に回答させて頂きます。 >【質問1】 >構築後、Accessのテーブルやフィールドを変更することはできるのでしょうか。 →後述しますが、質問者様がされようとしている新環境を実現すると、Accessからテーブルがなくなります(要らなくなります)。なので直接の回答としては「できません(もしくは不要)」が回答になります。 >【質問2】 >上記の仕組みをWindowsサーバではなく、UNIXサーバ上で実現できるでしょうか。 →AccessもSQLServerもWindowsのパソコンやサーバーで動きます。残念ながらUNIXでは動きません。 こちらはSQLServer。システム要件をご確認下さい。 http://www.microsoft.com/ja-jp/download/details. … Access2013はこちら。OfficeアプリケーションのAccess2013→オペレーティングシステム参照。 http://office.microsoft.com/ja-jp/products/FX102 … さて…AccessとSQLServerによる新環境を作ろうとするとテーブルがなくなると回答致しました。 質問者様も書かれている通り、SQLServerはデータベースを構築するソフトです。そのデータベースには様々ないわば部品を作ることが可能ですが、テーブルもその一つ。Accessにもテーブルはありますよね。つまりSQLServerにAccessのテーブルとデータを引っ越してしまい、個々のPCからはAccessからSQLServerのテーブルを参照する、というのがこの新環境。個々のPCからはSQLServer内のテーブルにデータを読み書きしに行くので、Access内にテーブルは不要となります。 これにより、みんなで同じSQLServerのテーブル(の中のデータ)を読み書きするので、データの一元管理ができる、個々のPC内のAccessにデータが分散されない、というのがこの新環境のミソだったかと。 新環境は↓こちらの図のようなものになるかと思います。 http://dba.fyicenter.com/faq/sql_server_2/Connec … ご健闘をお祈りしています。
SQLを考える時は理論の組み立てが肝要です。 (1)部門別に日時の最大値を求める。 (2)テーブルから、部門と日時が(1)と同じものを求める。 厄介なのは英語だから逆になることです。 SELECT A.* FROM テーブル AS A INNER JOIN (SELECT 部門,MAX(日時) AS 日付 FROM テーブル GROUP BY 部門) AS B ON A.部門=B.部門 AND A.日時=B.日付 ()の中のサブクエリが(1)になります。外側のSELECTが (2)に該当します。
Access持ってないので、確認はできませんが。 #6 の最初の方法だと 名簿.ID,属性.type 4,1 4,2 ができるので、4,NULLの行が無い→where に該当しない、となりそうですが その次のやつは Select 名簿.ID, 名簿.Name, 属性.Value from 名簿 Left Outer Join (select ParentID,Value from 属性 where Type = 3) as T on 名簿.ID = T.ParentID Where 名簿.IsMarried = True で動きませんか? #1でエラーになる、というのも気になります。
＞何度やっても１行目のデータしか抽出しないんです。 まあ、基本的に「やり方が間違ってる」から、何度やっても１行目しか出ないだろうね。 検索結果のシートで、上から順に、最初に見付かったもの、２番目に見付かったもの、３番目に見付かったもの…、ってやる場合は、工夫が必要だよ。 しかも、条件が「２つ」あるから、そう簡単には行かない。 担当がA1と同じ、週がD1と同じ行を、あるだけシート２に抽出したい、と言う風に思ったんだけど、違うだろうか？
＃１です 以下を参照してください http://ja.wikipedia.org/wiki/%E9%96%A2%E4%BF%82% …(%E9%96%A2%E4%BF%82%E3%83%A2%E3%83%87%E3%83%AB)#.E7.9B.B4.E7.A9.8D この中の、S:E だけの E=1,2,3 の場合を考えてみてください。 「T連番」の「連番」が、S:E に相当して、用意した連番の <=3 を使うものになります。 ※ これで回答になっていたでしょうか
> IBMのアンサーラインではJDBCドライバか、IBM DB2 Connectを使えということを言っていました。 > 前者はIBM製品ではないので後者のほうを薦めていました。 > 通信の問題もエクステンションが解決してくれるのでしょうか？ ノー、通信に責任を持つのはIBM DB2 Connectの仕事。 IBM DB2エクステンションはPHPとIBM DB2 Connectの橋渡しをするだけ。 しかしながら、IBM DB2 Connectって管理ツールじゃないですか？ IBM Data Server Clientというのがあればいいんじゃなかろうか。 いや、私も開発はJDBCでしかやったこと無いので正確なツール名は分からないのだが、 とにもかくにも、まずIBM DB2サーバーとIBM DB2クライアントがあって、例のエクステンションは IBM DB2クライアントの機能をPHPから直接呼び出せるようにするためのいわばラッパーなのです。 なので、まずそのWindowsサーバーにJDBCじゃないIBM DB2クライアントを入れるのが先決。 ODBCで接続できているという事は既に入っているはず（DB2 ODBCドライバーもODBCに対してDB2クライアントの機能を提供するもの）なので、誰かにエクステンションをコンパイルしてもらうだけでdb2_connect系が使えるようになるはずですよ。
PHPの32ビット版って最新版だとインストールできないんですか？ ググってみたけど、それらしい情報が無かったけど… PHPを32ビットにできないなら、Accessをやめた方が良いかも。 もともと、Accessってあんまり信頼性は高くないし。 PostgreSQLあたりがライセンスフリーで良いかと。64ビット版ももちろんあるし。
質問1については、 例えば名前と完全一致で検索するような場合は以下のようなSQLが実行されると推測されます。 select * from test_table where name='入力された内容' 「入力された内容」の部分にシングルクォートのことを何も考慮せずに「SQL'」を入れれば、 select * from test_table where name='SQL'' となり、エラーになります。 シングルクォートを正しくエスケープしていれば、エラーにはなりません。 他の質問も、where句にそのままいれたらSQLがどうなるかを考えればわかります。
同じテーブルを追加する時は、alias (別名)をつけます。 SELECT Persons.ID, Persons.pName, Persons_1.ID, Persons_1.pName FROM (Persons INNER JOIN Relations ON Persons.ID = Relations.yourID) INNER JOIN Persons AS Persons_1 ON Relations.spouseID = Persons_1.ID WHERE Persons.IsHusband=True;
> ただ、この方法を用いた場合ですと、前期に売上実績があり、後期に売上実績がない場合、前期の分しか表示されない状態になりました。（109期の列自体が表示されませんでした） 後期の売上実績が0件、言い換えると、「後期売上データ.」のレコード件数が 0 の場合は、後期の列は表示されません。 そういうことでしょうか。 もし、そうなら、クロス集計クエリをデザインビューで開き、ビューの上部のテーブルの背景部分をクリックして、 クエリプロパティを表示させます。そこの、「クエリ列見出し」を "前期","後期" と設定すれば、「後期売上データ.」のレコード件数が 0 でも、後期の列は表示されます。
重複クエリは、重複するレコードを抽出するもので、 今回は重複するレコードのうち最新以外は削除するということですので、 全然違いますね。 下記でどうでしょうか。 SELECT テーブル１.[共通ID], テーブル１.[連番], テーブル１.[郵便番号], テーブル１.[住所], テーブル１.[担当者名], テーブル１.[年月日], テーブル１.[フィルタ] FROM テーブル１ WHERE テーブル１.[年月日] In (SELECT TOP 1 年月日 FROM [テーブル１] As Tmp WHERE Tmp.共通ID = テーブル１.共通ID And Tmp.[フィルタ]=2 OEDER BY 年月日 DESC) ORDER BY テーブル１.[共通ID], テーブル１.[年月日] DESC; または、 SELECT テーブル１.[共通ID], テーブル１.[連番], テーブル１.[郵便番号], テーブル１.[住所], テーブル１.[担当者名], テーブル１.[年月日], テーブル１.[フィルタ] FROM テーブル１ INNER JOIN (SELECT 共通ID, Max(年月日) As Max年月日 FROM テーブル１ WHERE [フィルタ]=2 GROUP BY [共通ID] ) As Tmp ON テーブル１.共通ID=Tmp.共通ID AND テーブル１.年月日=Tmp.Max年月日 ORDER BY テーブル１.[共通ID], テーブル１.[年月日] DESC;
　この解答が正しいことだけを説明するなら、たいしたことでは無いのですが・・・ 　まぁ、先にやっておきましょうか。 　（１）主キーの存在理由。 　関係データベース（普通は、リレーショナルデータベースとカタカナで書かれることが多いですね。）は、数学の集合論をベースにした理論体系です。 　まず、集合には、行の順序はありません。これを理解しておいてください。 　社員の住所を記載した従業員表を作るとしましょう。このとき、Ａさんのデータが欲しい時に、どうやって、Ａさんを指定するかというのが問題です。（Ａさんの住所を調べたい時にも必要ですし、Ａさんが引っ越したから住所を変更するという時にも必要ですね。Ａさんが退職した時にも、まずＡさんのデータを指定する必要があります。ありとあらゆる操作の基本操作です。） 　従来のファイル形式のデータや表計算ソフトですと、１番目のデータとか５番目のデータとかいう表現が出来ますが、関係データベースでは、この表現は不可です。先に書いたように順序が無いからです。 　では、Ａさんの名前で行を指定しましょうか？もし、同姓同名の人がいたらどうしますか？（あり得ない話ではありません。というか、比較的良くある話です。） 　普通は、社員番号を一人に一つづつ割り振り、社員番号で行を指定します。これなら、絶対に重複することはありません。（というか、重複しないように割り振るという方が正しいですね。）この社員番号が主キーになります。 　これは、この従業員表を使う全ての手続きにおいて、必ず社員番号が指定されていることを表します。平たい言い方をすれば、会社に出す申請書類や報告書類には必ず社員番号が書いてあるということです。 　ちなみに、もし、他に社員を完全に一意に決められる属性があるなら、別に社員番号をわざわざ作る必要はありません。例えば、この国では、法律で、「同じ日に産まれた人は絶対に違う名前で無ければならない」と決められていたします。そうすれば、社員番号は実は不要です。主キーは、（名前・生年月日）の組で表すことが出来ます。 　これが主キーの存在意義であり、主キーの定義の一部です。 　（２）正規化の意義 　引き続き、従業員データベースを例に。従業員には、所属課があります。当然、課には、課長がいます。課長も従業員ですから、住所も電話番号もあります。 　これを１行に全部登録することは可能です。 　従業員番号・名前・住所・電話番号・課名・課長社員番号・課長名・課長住所・課長電話番号 　という表を作ったとしましょう。 　課長の住所は、この表にいったい何回現れるでしょうか？まず、課長の自分のレコードに一回。課員全員の課長住所として、課員の数だけ。おんなじデータを何回も何回も登録するのは、ディスクスペースの無駄だと思いませんか？これが、データの重複です。 　この表には、まだ問題があります。これは、人事異動の季節に顕在化します。課長さんがめでたく栄転され、新しい課長さんが着任されました。さぁ、問題です。この表の何行を直す必要があるでしょうか？はい。課員全員の課長の属性全部と、元課長自身の所属に、新任の課長自身のレコードをちゃんと直す必要があります。一つでもやり忘れたら、元課長さんは、元部下を道連れに転任したことになってしまいます。 　このようなことが起こらないように、表の形を、決まった形で変形していくのが、正規化というプロセスです。 　さて、答えの解説は、終わり。 　なんですが・・・実は、これ、データベース理論の本なら、第一章の中に書いてある内容です。つまり、スタート地点なんです。 　この段階で既に引っかかっていると言うことは、データベースの学習を何もしていないと想定できます。 　できれば、データベースの理論書を探して（どんな物でもかまいません。ＭｙＳＱＬやＳＱＬＳｅｒｖｅｒやその他、特定のデータベースの入門書でもかまいません。）一冊読みこんでおくと良いでしょう。 　残念なことに、データベースの理論は、ｗｅｂの断片的な情報だけでは理解することが、わりと難しい分野です。基礎から順番に理解していく必要があるからです。
> >通常は得意先ごとの担当＝期間×担当者で組みます。 > > 設定としては、「T得意先マスタ」に、期間フィールドを設ければ > 良いのでしょうか？ 担当の履歴を残したいとなると、 担当者 と 得意先 の関係は、多対多の関係になりますので、中間テーブルが必要になります。 T得意先マスタとT担当者マスタとは別に下記のテーブルを作成してください。 T担当履歴 --------- 得意先コード (外部キー) 担当者コード (外部キー) 開始日 終了日 これとは別に、 No.3の回答者さんも言われてますが、現行担当者 のフィールドを、T得意先マスタ に置いておくのは有効な方法だと思います。
SQLはこの手の処理は縦方向(?)に出力します select flag,sum(number) as sumNumber from test group by flag; しかし面倒ですが横方向に出せないこともありません select sum(number*(flag=4)) as sum4 ,sum(number*(flag=5)) as sum5 ,sum(number*(flag=6)) as sum6 ,sum(number*(flag=7)) as sum7 ,sum(number*(flag=8)) as sum8 ,sum(number*(flag=9)) as sum9 from test
"CREATE TABLE hoge (yobi char(5))" "INSERT INTO hoge VALUES ('土'),('日'),('月'),('木'),('水'),('火'),('金')" "select yobi from hoge order by case yobi when '日' then 1 when '月' then 2 when '火' then 3 when '水' then 4 when '木' then 5 when '金' then 6 when '土' then 7 end" こんなところでしょうか
１・ 追記する場合。 前もって前回回答の Set RS = DB.OpenRecordset("実際のテーブル名に", dbOpenSnapshot) を Set RS = DB.OpenRecordset("select * from 実際のテーブル名に order by メーカー名", dbOpenSnapshot) のように並び替えを指示してやる必要があります。 http://support.microsoft.com/kb/834927/ja または「実際のテーブル名」を出力したクエリで並び替え指定を 行っているのならテーブル名の代わりにクエリ名を指定します。 で一回目の出力をします。 二回目は前回回答の一部を修正して Sub xlS2() Dim oXL As Object Dim oBK As Object Dim oSH As Object Dim DB As DAO.Database 'ここでエラーになったら参照設定の変更を Dim RS As DAO.Recordset Dim i As Long, j As Long Set DB = CurrentDb Set RS = DB.OpenRecordset("select * from 実際のテーブル名 order by メーカー名", dbOpenSnapshot) 'か前述のようにクエリ名 Set oXL = CreateObject("Excel.Application") 'oXL.Visible = True Set oBK = oXL.Workbooks.Open("e:\123.xlsx") 'ここ Set oSH = oBK.sheets(1) 'For i = 1 To RS.Fields.Count 'フィールド名転記 'oSH.cells(1, i) = RS.Fields(i - 1).Name 'Next j = 3 'レコード転記は３行目から ’ここ Do Until RS.EOF For i = 1 To RS.Fields.Count oSH.cells(j, i) = RS.Fields(i - 1).Value Next RS.MoveNext j = j + 5 '空き間隔調整 Loop oBK.Close True 'ここ oXL.Quit Set oBK = Nothing: Set oXL = Nothing RS.Close: Set RS = Nothing End Sub です。 まとめて一気にというのでしたら、 直積とユニオンクエリで空白行を作っても 出来そうですが、すみません割愛させてください。
一人でローカルでしか使っていないなら排他モードで開く意味はないでしょうね。 ちょっと本題のアクセスとはずれますが、 例えば、AccessのプログラムがExcelのBookを作れるとして、 そのExcelを単独で編集もする。 ExcelのBookを開いて編集しているのを忘れて、 Accessのプログラムで同じExcelのBookを作ってしまうと、 編集していたのが無効になってしまいます。 あるいは、その後で、開いて編集していたExcelのBookを保存すると、 Accessのプログラムで作ったはずの情報が消えています。 とこういったことを防ぐために排他というモードがあります。 この例のExcelのBookをAccessのテーブルと置き換えてもらうとイメージがつかめるのかな？ ということで、同時に複数の人（またはプログラム）が処理をしようとしない環境では、 排他モードを使う必要性はありません。
ご使用のヤマト送り状は単票なんですか。 だとしたら、詳細セクションの「改ページ」プロパティを「カレントセクションの後」に設定して、 さらに、プリンターの設定で、ユーザー定義用紙 でご使用の用紙のサイズを設定して、 その用紙を指定して印刷してください。
他の方の回答のように年月マスターを作成しておいて外部結合するというのがいいでしょうね。 例 年月マスター　テーブル 年月　　　　　　フィールド 201401 201402 201403 201404 それを作らずにするなら、入金、出金の２つのテーブルをユニオンクエリで結合してからそれを集計クエリにすればいいでしょう。 例 Q_入出金 SELECT Format(日付,"yyyymm") AS 年月, 科目コード, 入金額, 0 As 出金額 FROM 入金 UNION ALL SELECT Format(日付,"yyyymm") AS 年月, 科目コード, 0 As 入金額, 出金額 FROM 出金; このクエリを基に集計クエリを作成。 SELECT 年月, 科目コード, Sum(入金額) As 入金計 , Sum(出金額) As 出金計 FROM Q_入出金 GROUP BY 年月, 科目コード;
No.3です。補足です。 JSONはほとんどのプログラミング言語で使えます。Cにもライブラリがあり使えるようですが、RubyやPythonなどの動的変数を使えるプログラミング言語の方が有り難みが実感できます。 YAMLはJSONよりも遅いがデータ構造の自由度が高いように思います。 これら２つはテキストで保存されますが、バイナリで保存するタイプのシリアライズもあります。 ＞・高速に入出力が出来る方が良い 検索対象にしなければ十分な速度があると思います。 ＞・複数アプリケーションからアクセス出来る方が良い データベース側の問題ですが、以前はSQLite3を使っていました。読み込みだけでは同時でも全然問題は無いのですが、同時に書き込みができないとの書き込み速度が遅いです。複数から同時に書き込みたいのならPostgreSqlやMySQLなどがお勧めです。 別の方法として、データベースにはデータファイル名だけを登録しそれを利用する方法もありますが、データがそんなに大きくないようですの、シリアライズしてしまう方が管理が楽だと思います。
私には、ここが解りやすかったです。 http://rfs.jp/sb/sql/s01/05-13.html 私としては、第２と第３の方が区別が付きにくい気がします。部分と推移の意味がつかみにくい。 SQL文操作に慣れてくると、分離した状態から考え始めるので、第３正規形となったtableの全てをjoin して第１正規化前へ戻すSQL文構築から逆算するとすこし理解が進むかも？ まず、第３正規化で分離した table は、 join `th3rd` on `main`.nonprimary = `th3rd`.primary となって本星の`main`テーブルと非プライマリーキーのフィールドで結びつきます 次に、第２正規化で分離した table は、 join `th2nd` on `main`.primaryX = `th2nd`.primary となって `main`テーブルとプライマリーキーのうちの１フィールドで結びつきます つまり、複合プライマリーキーがあるテーブルでないと、第２正規形が理解しにくいのだと思います。 最後に、第１正規化で分離したtable は、こちらのtableの方が全体を連結して、これまでの`main` テーブル側が、FOREIGN KEY の関係になります。 `the1st` join `main` on `the1st`.mainid = `main`.id join `the1stCategory` on `the1st`.Categoryid = `the1stCategory`.id
「ファイル」「共有設定」「FileMaker Server にアップロード...」選択「ホスト」一覧に表示するホストのタイプを選択・・・以下参考URL ＞現在クライアント(Fm13)の方で共有ファイルが見えません 「クライアントとしての共有ファイルの開き方」 http://www.filemaker.com/13help/ja/html/sharing_ … 参考URL：http://www.filemaker.com/13help/ja/html/sharing_ …
すでに、同名のエクセルファイルがある場合にこのようなエラーが出るようです。 同名のファイルを事前に削除しておくか、ダブらないファイル名を付ける必要があります。 私の場合は、FileName & Format(Now,"yyyymmddhhnnss")で、ファイル名に作成日時を付してダブらないようにしています。
「カンマや空白で区切られたキーワードの羅列から単語検索」ではなくて、「通常の分かち書きされてない日本語文章から、自由単語検索」なのですよね？ 英文のように分かち書きされていれば、前後に空白を入れた文字列で like 検索すれば、部分文字列のみのところと、長い文字列のところとは、個別マッチが可能 カラム値　例 ' きー ワード キーワード ' -- カラム値の前後にも区切り文字の空白を入れておくことで、先頭や最後もマッチさせ得る、検索時に、カラム値にも concat で前後に連結してもよいが時間的に無駄が多い。 条件式　例 where `カラム` like '% ワード %' and `カラム` like '% キーワード %' 分かち書きのない状態で、部分単語のみを見つけるには、perlくらいの強力な正規表現検索ができれば、可能かもしれないが、SQLiteは、正規表現検索させるには、ユーザー関数で組み込む必要がある、MySQLの正規表現検索やブール全文検索も、言明(xが前方にないaにマッチ)検索は実装されてないので、No2の方の回答のように、順番変えた組を作ってlike 検索くらいしかなさそう。OracleやpostgreSQL,Accessについてはよく知らない。
No.2gouzigです。 補足コメントの内容、そういうやり方になると思います。 そのような方法だと、取引先マスターに区分を追加するDB変更が多発してしまいます。 それでは大変なので、あらかじめ取引先マスターには区分欄を多めに作っておきますね。 そうすれば、都度DB変更作業をしなくて済みます。
>データを移植 データとは住所録ですか？バージョンは？ 参考URL なお、筆ぐるめのプログラムはWindows 8.1でインストールする必要があります（Windows 7についていたプリインストールプログラムならWindows 8.1で使用できない可能性もあります（ライセンスと、バージョン） プリインストールソフトは、基本的には、PC本体とセットの形でのライセンスで、機種を変更（Windows 8.1）した場合使用する権限がない。 Windows 7で使用できたソフトがWindows 8/Windows 8.1対応でないことがある。 参考URL：http://nakahori.cocolog-nifty.com/blog/2011/12/p …
＞>>AccessのデータをSQLで(SELECTで検索したりといった)操作 ＞これについてもう少しヒントをいただけないでしょうか？ 　http://www.geocities.jp/xmldtp/ac_sql.htm 　このサイトの記事は、古いaccessでやっていますが、新しいａｃｃｅｓｓでも、同じ機能は提供されています。バージョンが解らないので、具体的説明はできませんが、探してみればすぐに見つかります。
まだ不十分な点があるけど 一番簡単なのはCase(数量<0;計)という計算フィールドを作って このフィールドの合計を求める集計フィールドを作る。
ファイルにデータを書き出すときに２つ以上が同時に書き込むと ファイルが壊れます。 複数が書き込む処理を１つずつ処理するように制御しているというのが データベースの１つの特徴ですので、言われるような処理はできません。 １つ、あるとすれば一連のINSERTが終了次第、COMMITを挟んでおくと スレッドの終了を待たなくてもいいので速くなったりエラーが出にくくなるかもしれません。
「Microsoft® SQL Server® 2012 Express」の「Express with Advanced Services」がおすすめ。 http://www.microsoft.com/ja-jp/download/details. … 自習書のテキストもそろっている http://www.microsoft.com/ja-jp/sqlserver/2012/te … あるいは　「Microsoft® SQL Server® 2008 R2 SP2 - Express Edition」 http://www.microsoft.com/ja-jp/download/details. … http://www.microsoft.com/ja-jp/sqlserver/2008/se … MSDEは「なんちゃってSQLサーバ」みたいなものだから 本物を入れた方が後々都合が良いと思います。 最初はWindows認証で接続した方が簡単です。（Server認証はセキュリティや権限の設定が面倒くさい）
NO3です。成功しましたのでお知らせします。 1　横長のCSVデータをエクセルに取り込みます。二つのシートになります。 CSVデータはテキストファイルとしてワードなどに保存しておきます。エクセルでそのファイルを開きますが、テキストファイルを開くこととし、区切り文字はカンマと指定します。 シート1にSOGE1のデータを、シート2にSOGE2を取り込みます。 2　エクセルの横長のデータを縦長のデータに変換します。 データの変換にはシート関数があるようですが、使い方が私はわかりませんので下に示した二つのマクロを使ってしーと3しーと4に縦長のデータに変換しました。 3　アクセスにテーブルとして取り込みます。シート3とシート4をsheet3,sheet4という名前で二つのテーブルとして取り込みました。これに縦長のフィールドひとつだけのテーブルをつくり、aaaからfffまでのデータを入れておきます。テーブル3という名前になっています。 4　アクセスでテーブル3とsheet3の間にaaaなどのフィールド1によってリレーションを作り、結合の種類をテーブル3のすべてとsheet3のけっごうとします。クエリーでテーブル3とsheet3を選択して得られたデータをクエリー9という名前で保存します。 5.クエリー9とsheet4の間にリレーションを作ります。結合の種類はクエリー9のすべてとsheet4の結合とします。クエリー9とsheet4を呼び込んでクエリーを作ります。実行すればここでご希望のデータが得られます。 Sub Macro1() ' ' Macro1 Macro ' マクロ記録日 : 2014/3/25 ユーザー名 : ' Dim i As Integer, j As Integer For i = 1 To 2 For j = 1 To 5 Worksheets(3).Cells(j, i) = Worksheets(1).Cells(i, j) Next Next ' End Sub Sub Macro2() ' ' Macro2 Macro ' マクロ記録日 : 2014/3/25 ユーザー名 : ' Dim i As Integer, j As Integer For i = 1 To 2 For j = 1 To 5 Worksheets(4).Cells(j, i) = Worksheets(2).Cells(i, j) Next Next ' ' End Sub テーブル3.フィールド1Sheet3.フィールド1クエリー9.フィールド2Sheet4.フィールド1Sheet4.フィールド2 aa1a1 bb2b2 cc3 dd4d4 ee5 ff6
ここで質問しましょう。 http://joy-h.com/bbs2/viewforum.php?id=2
数人でやってるなら、別にAccessのファイル共用でもいいんじゃ ないですか？　Accessは確かに同時に使うと「落ちる」ことがある ソフトですが、数人程度なら「使ってますよ」と声を掛ければいい だけの話ですし。 それ以上に、データだけをExcelのシート１枚にまとめて、使うたび に「開いて取り込んで閉じておく」「使用中のフラグをどこかのセル に立てておく」程度で済む話じゃないかとも思えるんですが・・・。 数名程度で利用先がExcelマクロ程度なら、SQLサーバとか使う ような大掛かりな話じゃないと思いますけど。
> ためしにCdate関数を使ってみましたが 元のデータはテキスト型ということですか？ 日付型のまま、大小比較するのは危ないと思います。 (1)どうしてこういった現象がおきるのか。 「たぶん」程度ですが、日付表記の文化の違いかも。 日本では「年月日」の言葉通り、yyyymmddですよね。これは大小比較しやすい。 でも合衆国ではmm-dd-yyyyだし、他の英語圏ではdd-mmm-yy。 クエリに日付を#で囲んで記述する際に#14/03/2014#と書くようです（参考URL) なので > ?Deduction!To > 2014/02/13 は　14/02/13　→　2013/02/14と解釈されてるのかも。 if format(Deduction!To, "YYYY/MM/DD") > format(Contract!To, "YYYY/MM/DD)　Then みたいに明示したほうがトラブルにならないと思います。（処理速度が不利としても） バージョンによるのかも、とは思いますが １）ACCESSでタイムスタンプ目的で年月日時分秒を記録して ２）レコードコピーして、 ３）EXCELにペーストすると、dd-mmm-yyになる。 ４）それをEXCELでコピーして ５）ACCESSにペーストすると、yyとddが逆転する。 何度か痛い目に遭いました。 参考URL：http://office.microsoft.com/ja-jp/access-help/HA …
こんなのでもいいかな。 B1:=MIN(A1,40) C1:=A1-B1
49で始まる13桁の数字からすると、JAN－13コードですか？ 計算に用いない、とにかく読めさえすれば良い、ということならば 先頭にアポストロフィー(Shift＋7)を付加するとか。（見えちゃいますが)
　基本的には回答No.1様の方法に似た方法ではありますが、私の場合は、作業用シートの1行目に入力するシート名を間違えたり、将来的に作業人数を増やした場合における新たなシート名を記入するために、1行目が空欄の列を設けて置いたりした場合においても、エラーとはならない様にするために、次の様にします。 　まず、作業用シートのA1セルに「シート名」と入力して下さい。 　次に、作業用シートのB1～D1セルに各担当者シートのシート名を入力して下さい。 　次に、作業用シートのB2セルに次の関数を入力して下さい。 =IF(B$1="","",IF(ISERROR(1/(INDIRECT("'"&B$1&"'!A"&ROW())<>"")),"",ROW()+COLUMNS($B:B)*10000000)) 　次に、作業用シートのB2セルをコピーして、作業用シートのC2～D2の範囲に貼り付けて下さい。 　次に、作業用シートのB2～D2の範囲をコピーして、同じ列範囲の3行目以下に貼り付けて下さい。 　次に、集計シートのA4セルに次の関数を入力して下さい。 =IF(ROWS($4:4)>COUNT(作業用!$B:$D),"",INDEX(INDIRECT("'"&INDEX(作業用!$B$1:$D$1,INT(SMALL(作業用!$B:$D,ROWS($4:4))/10000000))&"'!A:C"),MOD(SMALL(作業用!$B:$D,ROWS($4:4)),10000000),COLUMNS($A:A))) 　次に、集計シートのA4セルをコピーして、集計シートのB4～D4の範囲に貼り付けて下さい。 　次に、集計シートのA4～D4の範囲をコピーして、同じ列範囲の5行目以下に貼り付けて下さい。 　以上です。 　因みに、 COLUMNS($B:B)*10000000 等の箇所において掛け合せる数を、何故100や1000等ではなく、10000000としているのかと申しますと、例えば掛け合せる数を100とした場合において、もしも、「ああ」シートの100行目よりも下の行、例えば102行目などの所にデータが入力されていますと、作業用シートの「ああ」の列の102行目の所には「202」(=102+100)と表示されてしまい、右隣の「いい」列の2行目に表示される「202」(=2+100)と区別がつかなくなります。 　一方、現行のExcelで使う事が出来る行数は、1048576行までですので、列数×10000000としておけば、万が一にも上記の様な事が起こる恐れは無くなるため、掛け合せる数を10000000としております。 　若しくは、10000000の代わりに ROWS(A:A) 等とするという方法もあります。
はじめまして、通りすがるというものです。 パススルークエリの方法ですが、パススルーでググってみると、以下のｕｒｌが検出されました。 http://support.microsoft.com/kb/303968/ja これで、解決されるのでしょうか？ データ量が増えて、ｓｑｌserverに移行した。ということですが、今まで、クライアント側のアクセスを回線 を通して、ｄｂから抽出したデータをクライアントに送信する形式となったのでそのネックで当然 レスポンスは落ちると思います。 また、氏名検索にて同一名が複数存在した場合（データ量増大により）サーバーとクライアントとの データ量が増大しレスポンスが低下することが予想されるかと思います。 これらにより、パススルークエリによる（これはアクセス特有の機能？　）レスポンスの改善はあまり 効果ないと思います。 レスポンス向上の方法として氏名のみの検索条件だけでなく、たとえば住所とか、生年月日などの 複合条件で検索することを検討したほうがよいかと思います。 複合条件で抽出件数を絞ることにより、サーバーからクライアントへのデーター送信量を絞るため レスポンス向上を図れると思います。 これに合わせ、サーバー自体に付加がかかるのであれば、インデックスを追加するとかメモリ割り 当てなど、検討してはいかがでしょうか？
Runtime版を作ろうとしているのだろうと思います。 最初の一歩でつまずくかも？ http://infith.com/system/database/mysql_odbc_win … Access2010 の場合ですがファイルの拡張子を、accdr にすると Runtimeモードで起動できます。
ExcelにはAccessのレポートを読み込む機能はないので無理なような気がします。 下記で紹介されているフリーソフトを使うというのはどうでしょうか。 レポートを PDF 出力するフリーウェアまとめ | YU-TANG's MS-Access Discovery http://www.f3.dion.ne.jp/~element/msaccess/AcTip …
こんばんは！ 関数でやってみようと作業用の列・Sheetを使用して試みましたが 数式が長くなるのであきらめました。 お望みでないVBAになってしまいますが、一例です。 ↓の画像の左側が「集計Sheet」でSheet見出しの一番左側にあり、Sheet2～Sheet4のSheet名は ああ・いい・うう　のように担当者名になっているという前提です。 まず、Alt＋F11キー　→　メニュー　→　挿入　→　標準モジュール　→　VBE画面に ↓のコードをコピー＆ペーストしてください。 Dim k As Long, lastRow As Long, str As String, wS As Worksheet 'この行から Sub Sample1() Set wS = Worksheets(1) For k = 2 To 4 '←Sheet見出しの左から2番目～4番目のSheet With Worksheets(k) .Range("A1").AutoFilter field:=1, Criteria1:=wS.Range("B2") If wS.Range("B3") <> "" Then .Range("A1").AutoFilter field:=3, Criteria1:=wS.Range("B3") End If lastRow = .Cells(Rows.Count, "A").End(xlUp).Row If lastRow > 1 Then Range(.Cells(2, "A"), .Cells(lastRow, "C")).Copy wS.Cells(Rows.Count, "A").End(xlUp).Offset(1) End If .AutoFilterMode = False End With Next k End Sub Sub Sample2() Set wS = Worksheets(1) str = wS.Range("B3") On Error Resume Next With Worksheets(str) If wS.Range("B2") <> "" Then .Range("A1").AutoFilter field:=1, Criteria1:=wS.Range("B2") End If lastRow = .Cells(Rows.Count, "A").End(xlUp).Row If lastRow > 1 Then Range(.Cells(2, "A"), .Cells(lastRow, "C")).Copy wS.Cells(Rows.Count, "A").End(xlUp).Offset(1) End If .AutoFilterMode = False End With End Sub 'この行まで 次にExcel画面に戻り、 Sheet見出しの一番左側にある「集計Sheet」のSheet見出し上で右クリック　→　コードの表示　→　VBE画面に ↓のコードをコピー＆ペースト　→　Excel画面に戻り、B2・B3セルにデータを入力してみてください。 Private Sub Worksheet_Change(ByVal Target As Range) 'この行から Dim endRow As Long If Intersect(Target, Range("B2:B3")) Is Nothing Then Exit Sub endRow = Cells(Rows.Count, "A").End(xlUp).Row If endRow > 6 Then Range(Cells(7, "A"), Cells(endRow, "C")).ClearContents End If If Target.Address = "$B$2" Then If Target <> "" Then Call Sample1 Else Call Sample2 End If ElseIf Target.Address = "$B$3" Then If Target <> "" Then Call Sample2 Else Call Sample1 End If End If End Sub 'この行まで おそらくお望み通りの動きになると思います。 ＞マクロは苦手です。関数でなんとかなりませんか？ というコトですので、 ご希望の方法でない場合は無視してください。m(_ _)m
追記 VBAからマクロを呼び出すより、 マクロの処理をVBAに変換して、すべてVBAで処理するようにしたほうが、 デバッグしやすいですね。 マクロはデバッグ機能が貧弱なので。
> tbl家族（テーブル名） > 顧客NO > 家族名 > 誕生日 > 性別 本人に加え1名しか持てませんよ？ 枝番号持たせるとか
SQLサーバーにはユーザーばかりでなくグループも設定出来ます。SQL　Serverを扱えるグループを設定し、SQLサーバーに登録し、SQL　Serverを扱うユーザーにそのグループを設定すれば、個々にユーザーをSQL　Serverに登録する必要は無くなります。
NotInList イベントはコンボボックスに無いデータを入力したときに発生します。 >もし、コンボボックスの内容に対応するレコードがなかった場合 にフォームに新たなレコードを追加したいのですから >コンボボックスを使ってレコードを検索するコードを に書き加える形になります。 分からなければ、レコードを検索するコード、 コンボボックスのコントロールソースまたは値集合ソース、 それとフォームのレコードソース、 以上３点を提示ください。
＞;extension=php_sqlite.dll エラーは、上記行の先頭にコメントアウトがあるせいだとは思うけど、 sqlite_open関数群は、sqlite２用です、SQLite3のデータファイルは扱えません。 SQLite3　を利用するなら、PDO または、SQLite3 クラスしか有りません。
あ、見直してたら、テーブルエイリアス名の抜けを発見。 sum(nedan)　のところ、２カ所とも、b エイリアスを加えて下さい sum(b.nedan) 実行チェックまで行ってないのがばればれ。
アクセスでは、大名リストテーブルと呼び出しテーブルの二つのテーブルを作ります。そしてリレーションシップを呼び出しテーブルの番号と大名リストテーブルの番号の間につくり、1対多の設定にします。クエリーをつくり二つのテーブルを乗せておいて、クエリーを実行させると、ご希望の結果が得られます。
(1)と(2)からデータを取得するクエリの結果をインポート用のテーブルに入れるならば、次のようにすればできます。 リレーションは必要ありません。 簡単なのはコピー＆ペーストですが、クエリとマクロの組合わせで自動化もできます。 ・コピー＆ペースト 　　１．インポート用テーブルのデータをすべて削除する 　　２．クエリで検索した全データをコピーする 　　３．インポート用テーブルにペーストする ・クエリを手動実行 　　クエリを準備します 　　　インポート用テーブルのデータを削除するクエリを作成します 　　　(1)と(2)からデータを取得するクエリをコピーして「追加クエリ」にする 　　　　※Accessのバージョンが書いてありませんが、メニューかリボンに 　　　　　「追加」か「追加クエリ」というのあるはずです 　　　　　追加クエリにするときに追加先のテーブルの各項目との関連づけをします 　　　　　同じ項目名なら自動で設定されます　　 　　１．インポート用テーブルのデータ削除するクエリを実行する 　　２．(1)と(2)からデータを取得する「追加クエリ」を実行する ・マクロで実行 　　上のクエリを手動実行で作成した２つのクエリを順に実行するようにマクロを 　　作成して実行します 今あるクエリ等を修正するのではなくコピーをしてから試してみることをおすすめします。
＃１さんの回答へ横レスさせて下さい 文字列中に”を含めたい場合は、２重に書くとOKです。 ｓｔｒSQL = "select 次回検査日 from 管理台帳クエリ where 最終検査日 <= DateAdd("”yyyy””,-[検査周期], #" & txtDate & "#)"
>>指定した曜日、日付でもいいので簡単に入力出来ないかと思っています。 そのような事は出来るでしょうか？ シフト表を作るようなソフトは市販されています。ですから可能です。 >>出来るのであれば、どのようにしたらよいでしょうか？ ソフトでやりたいことを要件定義としてまとめます。 そして、それを元に、画面と帳票の詳細を決めます。 それから、必要なプログラムを求め、プログラム設計書を作成します。 accessのデータベース設計を行います。 そのあとは、画面、帳票とプログラム設計書に基づいてプログラムを作ります。 それらのプログラムが完成したら、正常に動作するかテストし、問題がなければ完成です。 これ以外にもあるかもしれませんけど、およそ上記の手順で作ればできます。
>>これで動作させるとエラーになります。 エラーの内容を確認して、エラー原因を取り除いてやれば、うまくいくんじゃあないですか？
これはですね。パススルークエリーではなくふつうのクエリーですよね。 この方式ですとデーターセットが使えないと一回でまとめて更新は無理です。つまりAccessではなくC#でSQLサーバーとAccsessを両方使うとかなら出来ます。 データーセットに読み込めばソースの形式は何でも構わないので。メモリ上に展開してメモリでリレーションを掛け更新もできます。 もしどうしてもAccessを使いたい場合は本当にパススルークエリをプロフラムでその都度作るしかありません。そのパススルークエリーを元にさらにふつうのテーブル作成クエリを作成しDoCmdなどで実行するしかありません。 まずパススルークエリを作成する前に、同じクエリは削除します。 　　Dim CAT As ADOX.Catalog On Error GoTo errc Set CAT = New ADOX.Catalog Set CMD = New ADODB.Command Deleteobj = True CAT.ActiveConnection = CurrentProject.Connection If CAT.Procedures.Count > 0 Then For Each i In CAT.Procedures If i.Name = クエリの名前 Then CAT.Procedures.Delete (i.Name) End If Next Exit Function End If そのあとに新しいSQLでパススルークエリのオブジェクトを作成します。 　　 qd.SQL = "SELECT * FROM MAINDATA WHERE((DATE>=" & str月初 & ") And (DATE<=" & str月末 & "))" Set CMD.ActiveConnection = CAT.ActiveConnection CMD.CommandText = qd.SQL CMD.ActiveConnection.Properties("Jet OLEDB:ODBC Command Time Out") = 0 CMD.Properties("Jet OLEDB:ODBC Pass-Through Statement") = True CMD.Properties _ ("Jet OLEDB:Pass Through Query Connect String") = _ "ODBC;DRIVER=SQL Server;SERVER=" & server ";DATABASE=" & database CAT.Procedures.Append クエリの名前, CMD CAT.Procedures.Refresh これでAccessにクエリオブジェクトが作成されています。 テーブル作成クエリは予め作成しておいても構いません。名前は同じなので。 この後にそのテーブル作成クエリを実行します。
記載のSQLをインラインビューにすればいいのではないでしょうか。 select * from ( select *,(select count(*)+1 from card as c where c.n < card.n) as idx from card ) where ...; という感じです。 参考までに http://ideone.com/uSQ3fe
>現在、ＤＢ移行（が可能かどうか）の第一段階目として、 >とりあえず１行（１レコード）を文字化け等なしで抽出する方法を模索しております。 私の説明が悪かったのかもしれませんが、レコードレイアウトがわからないとそれができないのです。 私のいうレコードレイアウトは何バイト目～何バイト目が商品コードとかいうものではなく 何バイト目～何バイト目が1バイト整数 何バイト目～何バイト目が2バイト整数 何バイト目～何バイト目が4バイト整数 何バイト目～何バイト目が4バイト浮動小数点 何バイト目～何バイト目が8バイト浮動小数点 何バイト目～何バイト目がテキスト など、そこが何の型のデータなのかです。 例えば2バイトで構成されたレコードがあり、そのうちの1レコードの16進ダンプが 30 31 だった場合、 1バイト整数が2つと見るなら 48,49 ですし 2バイト整数が1つと見るなら 12592(ビッグエンディアンなら12337) テキスト(ASCIIコード)と見るなら "01" など何の型のデータとして見るかによって得られるデータはまったく変わります。 これがわからない状態で「文字化け等なしで抽出」といったことができると思いますか？
> ちなみに、得意先CDのIN句を抜くとちゃんとデータは抽出されます。 IN の内のSQLのみ別クエリとして保存し実行したらどうなりますか？ select [T_得意先]![得意先CD] from [T_得意先] Where [T_得意先]![抽出フラグ] = True； だけで。 テーブル名!列名で、テーブル名が長いとチェックしづらく無いですか？ T1やT2のような別名付けて正式名はFromにのみ残し、 SelectやWhereはT1やT2で修飾したほうがデバッグしやすいですよ
> フィールド1はＩＤ番号です。 ということは、オートナンバという事を言いたかったのでしょうか オートナンバであれば、以下の SQL でいけると思います INSERT INTO テーブル名(フィールド2,フィールド3,フィールド4) SELECT フィールド2,フィールド3,フィールド4 FROM テーブル名 WHERE フィールド4='巨人'; オートナンバ、いやいや自分で採番・・・テーブルによってはいろいろあると思います いろいろ対応できるかな・・・　というものを作ってみました Public Sub fncRecCopy(sTable As String, sFld As String _ 　　　　　　　　　　, Optional bAn As Boolean = False _ 　　　　　　　　　　, Optional sWheres As String = "") というインターフェイスになるのですが、 使い方（指定方法）は、 sTable　：　テーブル名 sFld　：　フィールド名の列挙　（,）カンマ区切り 　　　　　先頭が採番するフィールド bAn　：　その先頭のフィールドがオートナンバなら True を指定（既定：False） sWheres　：　抽出条件以降の記述（既定：条件なし） Call fncRecCopy("テーブル名", "フィールド1,*", True, "フィールド4='巨人'") とすると、前述SQLでの処理と同じになります ※ 処理性能は、SQL一発の場合より遅くなります フィールド1 がオートナンバでなければ Call fncRecCopy("テーブル名", "フィールド1,*", False, "フィールド4='巨人'") とすれば、フィールド1 を採番します フィールド部分の列挙を "フィールド1,*" ↓ではなく "フィールド1,フィールド3,フィールド4" とした場合、指定されたフィールド部分しかコピーしません コピーするレコードの順が必要なら、条件以降に ORDER BY 記述します "フィールド4='巨人'" ↓例えば "フィールド4='巨人' ORDER BY フィールド1" ※ 汎用的にするには ・Where 指定と、 ・ORDER BY 指定は 分けた方が良いんでしょうけど 標準モジュールに記述して利用します Public Sub fncRecCopy(sTable As String, sFld As String _ 　　　　　　　　　　, Optional bAn As Boolean = False _ 　　　　　　　　　　, Optional sWheres As String = "") 　　Dim rs As New ADODB.Recordset 　　Dim rsC As ADODB.Recordset 　　Dim sSql As String 　　Dim i As Long, j As Long 　　Dim iM As Long 　　sSql = "SELECT " & sFld & " FROM " & sTable 　　If (Len(sWheres) > 0) Then 　　　　sSql = sSql & " WHERE " & sWheres 　　End If 　　sSql = sSql & ";" 　　If (Not bAn) Then iM = DMax(Split(sFld, ",")(0), sTable) 　　rs.Open sSql, CurrentProject.Connection, adOpenStatic, adLockOptimistic 　　Set rsC = rs.Clone 　　For i = 1 To rs.RecordCount 　　　　rsC.AddNew 　　　　For j = 1 To rs.Fields.Count - 1 　　　　　　rsC(j) = rs(j) 　　　　Next 　　　　If (Not bAn) Then 　　　　　　iM = iM + 1 　　　　　　rsC(0) = iM 　　　　End If 　　　　rsC.Update 　　　　rs.MoveNext 　　Next 　　rsC.Close 　　Set rsC = Nothing 　　rs.Close End Sub ※ エラー処理は入れてません ※ 不都合あれば、変更するとか・捨てるとかしてください エラーがあったら、エラー番号を返す様に Function にするとか・・・
追記。 ANo.4のクエリを 主TBL：700レコード 副TBL1～10：100レコード の１１個のテーブルで結合してみたが、まったく問題なく動作した。 動作環境は、あえて WinXP Pro SP3 Access97 メモリ768MB CPU Celeron CPU 2.5GHz というチープな環境にしてみたが、まったく問題が無かった。
INSERT文になって再度発行処理をすればいいだけです。 Dim cmd As New OleDbCommand( "INSERT INTO table1 (オペレータ名, ランク, 補足, パスワード) VALUES " & "(?, ?, ?, ?)", cn) cmd.Parameters.Add("ランク", OleDbType.Integer).Value = RANK cmd.Parameters.Add("パスワード", OleDbType.Char).Value = PWORD cmd.Parameters.Add("補足", OleDbType.Char).Value = HOSOKU cmd.Parameters.Add("オペレータ名", OleDbType.Char).Value = OPE cmd.ExecuteNonQuery() ところでcn.Open()の後にcmd.ExecuteNonQuery()が2回もありますが、1回で十分です。
> エクスポート定義のみを作成する方法をお教えいただけませんでしょうか。 なんか勘違いしているようですね。 エクスポート定義では、 CSVファイルのフォーマットを定義できますが、 保存先のパスは設定てきませんよ。 > 行いたいことは、VBA内で出力先パス・出力先ファイル名を任意に指定し > ダブルクォーテイション無しのCSVファイルを作成したいのです。 ヘルプより ----------------------------------------------------------- 構文 式.TransferText(TransferType, SpecificationName, TableName, FileName, HasFieldNames, HTMLTableName, CodePage) パラメータ FileName インポート、エクスポート、またはリンクを行うテキスト ファイルの、パスを含めた完全な名前を文字列式で指定します。 --------------------------------------------------------------- TransferText のFileName引数に出力先パス・出力先ファイル名を設定してください。
AddNewする前の時点で、どのDBのどのテーブルに対して行うかをセットしていないためだと思います。 例えば、現在のDBの「T_追跡」テーブルをRSにセットする場合はこんな感じです。 Dim DB As DAO.Database Dim RS As DAO.Recordset Set DB = CurrentDb Set RS = DB.OpenRecordset("T_追跡") 参考URL： http://www.geocities.jp/cbc_vbnet/DAO/database.h … この一番下のサンプルが参考になります。
二つの集団の間の差は同じ母集団から出たサンプルとすれば、その確率は１００分の1以下であり、つまり極めてまれにしか起こりえないことと考えられる。したがって二つの集団の間には有意差があるという結論になります。
投稿時にMsgBoxのWhere文を書いて欲しいですね。 Date型なんだからFormat文で整形でしょうね。 Where条件に＃で囲んだ日付を書く時、元が英語圏のソフトだけに mm/dd/yyyy が良いらしい。
ですから、 ＞など設定がばらばらなのでQueryDefを使ってパラメータを ＞VBAで設定するならば、他の方への補足の内容をもとにすると、 ＞SQL文を、 として、補足にあるパラメータの宣言、 ＞PARAMETERS 納期1 DateTime; をはずしたクエリのSQL文を提案し、VBAでは、 ＞With qdf ＞.Parameters("納期") = Format(Forms![受注データ一覧]![納期], "yyyy/mm/dd") ＞Set rs = .OpenRecordset ＞.Close ＞End With のところで、 With qdf qdf.Parameters("XYZ") = CDate(Format(Forms![受注データ一覧]![納期], "@@@@/@@/@@")) Set rs = .OpenRecordset End With のように、Parameters("納期")　を　Parameters("XYZ")　のように パラメータが「納期」というようなフィールド名と同じになるのを 避けるために「XYZ」としているのですが・・・。パラメータと フィールド名を同じにするとエラーが出るのでこのようにしています。 補足にある、 ＞フォームからyyyy/mm/ddの書式で日付を指定し該当する ＞レコードをクエリで抽出します。 ということは、フォームではテキストボックスの書式が 日付型に設定してあると、いうことだと解釈します。したがって、 VBAでは、 .Parameters("XYZ") = Forms![受注データ抽出]![date1] とします。 ＞上記記述で ＞実行時エラー3061 ＞パラメーターが少なすぎます。2を指定してください。 ＞エラーが発生します。 これは、補足にある書き変えたVBAの中で、 ＞With qdf ＞.Parameters("納期1") = Forms![受注データ抽出]![date1] ＞Set rs = db.OpenRecordset("確定クエリ", dbOpenDynaset) ＞End With のところで、 db.OpenRecordset としているために、「確定クエリ」をパラメータを指定せずに レコードセットとして接続しようとしているためにエラーが エラーがでるのです。したがって、ここのところは、もともとの 設定のようにQueryDefを使って、 With qdf .Parameters([XYZ]) = Forms![受注データ抽出]![date1] Set rs = .OpenRecordset("確定クエリ") End With とします。ようするに、 Set rs = qdf.OpenRecordset("確定クエリ") ということです。 以上より、クエリの「納期1」の抽出条件に「[XYZ]」 (XYZではなく、[XYZ]です）と記入し、 そのクエリのSQL文は、 SELECT 確定.注文番号, 確定.注文年月日, 確定.発注者品名コード, 確定.[品名(品名仕様)], 確定.[注文数量(受注数量)], 社内データ.SNP, 確定.単位, 確定.納期1, 確定.納入No1, 確定.納品キー番号1, 確定.受渡場所名, 確定.発注者用備考, 確定.発注者名, Int([納入指示数量1]/[SNP]+0.5) AS 印刷枚数 FROM 確定 LEFT JOIN 社内データ ON 確定.発注者品名コード = 社内データ.得意先品目コード WHERE (((確定.納期1)=[XYZ])); VBAは、 Private Sub コマンド23_Click() Dim db As DAO.Database Dim rs As DAO.Recordset Dim qdf As DAO.QueryDef Set db = CurrentDb Set qdf = db.QueryDefs("確定クエリ") With qdf .Parameters("XYZ") = Forms![受注データ抽出]![date1] Set rs = .OpenRecordset End With MsgBox rs![注文番号] qdf.Close: Set qdf = Nothing rs.Close: Set rs = Nothing db.Close: Set db = Nothing End Sub
そう思うのなら、改行コードを調べてはどうでしょうか? MacOSのバージョンが記載されていませんが、 OS9以前のMacでは、標準の改行コードはCR でした。 OSXになってから、UNIXベースになり、標準の改行コードは LF です。 特に、ターミナルから入力するようなコマンドは、UNIXベースのコマンドであり、LFを改行コードとするものがほとんどです。(一部に自動判別するものや、オプションで指定できるものなどがあります) 一部アプリケーションで、OS9以前のMac用の意味で、「改行コード: CR(Mac)」等となっているものがあります。 もし、in.txt を保存するときに「CR」を選んでいるのなら、それを「LF」にしてください。
>Webでの公開設定してましたが、解除できません。 共有設定のインスタントWeb公開をオフにするだけ。
PSV という拡張子というか、パイプ｜で区切るのを初めて知りました。 根本的なのはファイルを作成している方で対応してもらうのが一番でしょうけど、 多分、無理な相談だと思われますので、 VBA でファイルをリネームしてインポートする処理を作るくらいではないですかね。 Excelだと柔軟に読み込めますが、Access は頑固一徹です。 >インデックスが有効範囲にありません"のエラーになるとき 既存のテーブルに追加インポートなら フィールドのインデックスが、「はい重複なし」に設定されている場合が Google とありますね。
デフォルト16回で設定されているようです。 回数を変更するにはレジストリをいじる必要あるので気をつけてください。 参考URL：http://support.microsoft.com/kb/211922/ja
補足に対しまして・・・ テーブル名の指定部分はクエリ名ではなく、そのクエリの元になっているテーブル自体の名前を指定して下さい。 「select * from～」の箇所の一文でそのままパラメータクエリ同様の役割をしてくれますので。 恐らくそれが原因かとは思いますが、もしそれでも駄目なようなら再度補足願います。。
人気といえば最近では、Redisですかね。 Redisはレプリカやその運用を考えると様々な機能が充実しており、 無料だし非常に使いやすいです。 商用の様々なシステムのフロントシステムに使用されています。 ただやはり基幹系には活用は難しく、 複雑なクエリは投げることはできません。 ECサイトや、コンテンツ系WEBサイトで、 非常に多くのエンドユーザ向けシステムに向いているといえます。 NoSQL自体は、RDBMSと比べて更新性能が非常によいです。 なので、顧客情報はRDBMS、更新系の多い揮発型データは NoSQLでといった使い方をしたりします、
EXCEL側でACCESSからインポートする方法もありますよ CopyFromRecordSet のサンプルを探してみて下さい
プリントアウトの体裁はレポートでグループ化を行えば実現できそうです。 http://office.microsoft.com/ja-jp/access-help/HA … 商品単価が頻繁に変化するのなら、T_注文履歴に加えてしまった方が『楽』はできます。 （「テーブルの正規化」に反しますけど） 部署間・チーム間で人員のトレードが行われると 前年対比などの場合に今年の構成で前年も比較するのか、前年は前年の構成で行うのか、 も問題になりそう。
可能ですが、先頭32文字と末尾20文字を切り捨てるからには、 元のデータは必ず52文字以上あるんですかね？ UPDATE [A表] SET [A表].F1 = iif( len([F1]) > 52, mid([F1], 33, len([F1]) - 32 - 20), ''); F1列が52字を越えていれば途中を切り出し、52文字以下なら空文字をセットします。 ELSE部分は適宜変更してください。
DB2に限った話ではありませんが、 リテラルを文字列として扱って欲しい場合はシングルクォーテーション(')で囲う必要があります。 (DB2では、リテラルをダブルクォーテーション(")で囲うと列名として認識されます)
No2のIf文はこの形ではなく、単に Private Sub 修正_Click() CopyRec MsgBox("修正が完了しました。フォームを閉じます。") DoCmd.Close acForm, Me.Name End Sub のように、コードを羅列しても同じなので どちらでもいいです。 一応、No1とNo2はIf文を使った例です、ということに します。
#1です。 ごめんなさい。where条件で部分一致がなりたたない。 update テーブル名 set keyword = keyword || ' ' || 追加キーワード where (' ' || keyword || ' ') not like ('% ' || 追加キーワード || ' %') ; です。
UPDATE tableA SET tableA.name = ( SELECT tableB.name FROM tableB WHERE tableA.id = tableB.id ) WHERE EXISTS ( SELECT tableB.name FROM tableB WHERE tableA.id = tableB.id )
すみません。少し単純なことに気が付きませんでした。 実際には、わざわざ「日付」を数値に変換する必要は ありませんでした。「日付」の比較に難儀したので 数値化したのですが、関数の中では直接比較できるので わざわざ「日付」を数値化する必要はなかったようです。 以下のコードをコード表に貼り付け、保存します。 「テーブル名」は実際に合わせて変更してください。 Function funcDateRank(ByVal dData As Date) As Long 　　Dim db As DAO.Database 　　Dim rs As DAO.Recordset 　　Dim minNum As Long 　　Dim i As Long 　　Dim j As Long 　　Dim strSQL As String 　　'日付だけを取り出しグループ化 　　strSQL = "SELECT 日付 FROM テーブル名 GROUP BY 日付" 　　Set db = CurrentDb 　　Set rs = db.OpenRecordset(strSQL) 　　'自分より大きい日付を見つける 　　rs.MoveFirst 　　Do Until rs.EOF 　　　　If num < rs!dData Then 　　　　　　i = i + 1 　　　　End If 　　　　rs.MoveNext 　　Loop 　　'レコード数の取得 　　j = rs.RecordCount 　　'ランクの算出 　　funcDateRank = j - i 　　rs.Close: Set rs = Nothing 　　db.Close: Set db = Nothing End Function 次にテーブルを基にクエリを作成します。 そのクエリの新しいフィールドに、 　　funcDateRank([日付]) と設定し、保存してください。 以上です。
正直、書いてあることからどういうデザインなのか今ひとつピンときません。 普通、ロックによる性能劣化の解消方法はロックの粒度を細粒度にするか、ロックフリーアルゴリズムの採用だと思いますが、提案されている方法はどちらでもないように思います。 > DBに書き込み前にロック用ファイルをファイルロックをし、書き込みが終わったらロックを解除する、という感じです。 というデザインにしたことでどうして現状より良くなるんでしょうか？ これはSQLiteがロックしてくれていたところを自分でやっただけで、本質的に現状と変わらないと思います。むしろ、自分の実装ミスによってロックがされず、にデータの消失や不整合を招くリスクのほうが高いのではないでしょうか。 いや、RESERVEDやPENDINGといったSQLite3のロック状態を使えない分だけ、それをちゃんと使って書いたコードよりも、ロックの粒度は粗くなっているので、トータルでの性能は落ちそうです。 質問者が言うところのロックファイルを使う実装というのは、要はすべてEXCLUSIVEにするということですよね？ ちなみに、 http://www.sqlite.org/lockingv3.html によると、SQLite3からはPENDING状態があることでリードの多発によってEXCLUSIVEロックが取れない状態というのは解消されたそうです。 > その他に、メインのDBに書き込みできるのはマスターのPHPだけにして、ユーザーは一切書き込みできないようにする、という方法です。 ロックを取る話と今ひとつつながって見えませんが、普通に考えていくつも問題が思い浮かびます。 1. DBの内容の不整合 2. スレーブ？によって新規作成されたDBファイル名の競合 3. スレーブ？によって新規作成されたDBが書き込み中であったことによるマスターの待ち 4. スレーブ？によって新規作成されたDBファイルによるディスク領域の圧迫 1についてですが、例えば、持っている商品の数に整合性がないわけですから、ヘタしたら自分が持っている数以上に商品を出してしまいますよね。商品数が1個で、ユーザーAもユーザーBもそれを使えると思って確保したら、マスターが突き合わせをした時に不足しているとわかると。 あるいは、新規商品の追加だけしかしないとしたら、同一商品の追加があった時に微妙に内容が違っていたことでエントリーが複数できたりしませんか？また、登録したものがマスターが処理を終えるまで見られないという状況になるとも思います。 2について、被らないようにファイル名をつけないと、先の入力を後の入力で上書きしそうです。あるいは、マスターによるDBの削除でデータがあるファイルを削除しそうです。 3について、1分ごとにマスターのデータベースを止めてひたすらアップデートをするので、スレーブ？が作ったファイルが著しく多かったり、スレーブ？が自分が書いているDBのロックを取ったまま帰らないことが多かったりすると、その間マスターを使えないということになりませんか？ 4について、それぞれのスレーブがDBファイルを作るとなると、書き込みが増えれば増えるほどファイルのオーバーヘッドの部分によるディスク領域の圧迫もありそうです。 > しかし同時書き込みでデータベースがロックしてしまうSQLiteの仕様では複数人数での運用ができません。 一応確認ですが、書き込みにはちゃんとトランザクションを使っていますよね。使うのと使わないのとでは雲泥の性能差がSQLite2のころからあるようですが。 http://www.sqlite.org/speed.html あと、釈迦に説法だと思うのですが、インデックスをちゃんと設定してquery planも確認してますよね。 http://www.sqlite.org/eqp.html http://www.sqlite.org/queryplanner.html それでだめならMySQLの採用もやむなしだと思うのですが。 自分だったらSQLite3でちゃんと性能が出るように実装してみて、ダメだったらもっと細かい粒度でロックが取れるRDBMSを採用するというアプローチを取るでしょう。 #1さんと同じく、ロック機構を自分で実装するというのは、リスクが高すぎてやりたくないです。
まず、「元データ」から「区分」以外のフィールドの選択クエリを作ります。 ツールバーの「Σ」ボタンをクリックし、集計行を表示します。 「社員コード」「日付」を　グループ化。 「勤務時間」から「訪問のカウント」までは 合計。 「開始時間」を 最小。 必要なら、フィールド名を変更。 以上です。
FM7（持っていない）には機能的に無いということなのでしょうね。 v10？以上にすると変数設定とPDF保存の機能があるので、スクリプトを設定 するとボタンを押すだけで全レコードを一括PDFにしたり出来ます。
>このようなものが２0個程あり、年度が変わるごとに全ての値を入力し直しています。 >（年度・西暦・配付率などその年の数値） これのデータを何に使用するのですか？レポートなど？ >そこで”年度”を主キーにしたテーブルを作成し、そこに他の項目（西暦・配付率など）の >フィールド（２０個）を設定し、そのデータを利用できないかと考えています。 これだと、データとして何にも使えますが、用途は？
SQLiteでは、insert or replace しかないけど select文からの入力とサブクエリは使えるから replace into [table_name] (n,c1,c2,c3) select x.n, org.c1, x.c2, org.c3 from (select 1 as n, 1 as c2 ) as x left join [table_name] as org on x.n=org.n ; n がprimary key または uniqueの前提で１行書き換えまたは、新規挿入。
(1)とは別に、(2)のデータを作るためのクロス集計クエリーを作成し、二つを社員コード、日付でリンクし、それぞれをフィールドを結合させます。この時、クロス集計クエリーは、＊で全フィールを追加します。これは、クロス集計で作成されるフィールドはその都度変化するので、フィールド名を特定できない事への対応です。 以下に具体的に書いてみます。 先ず(2)に必要なデータを求めるクエリーとして、社員コード、日付、訪問名：[区分] & ([Gコード]-1),業務時間: DateDeff("n",[開始時間],[終了時間])として、区分＝"訪問"だけを選択し、下記データのダイナセットを作成します。 社員コード| 日付 |訪問名|業務時間 ==================================== |1111111 |2013/10/01　|訪問1 |　20 |1111111 |2013/10/01　|訪問2 |　240 |2222222 |2013/10/01　|訪問1 |　60 |2222222 |2013/10/01　|訪問2 |　30 次にこのクエリーを元に、行見出し：社員コード、日付、列見出し：訪問名、集計値：業務時間としたクロス集計を行います。この結果として、下記データのダイナセットが作成されます。 社員コード| 日付 |訪問1|訪問2 ==================================== |1111111 |2013/10/01　|20 |　240 |2222222 |2013/10/01　|60 |　30 (1)の集計クエリーと上記クロス集計クエリーを社員コード、日付で連結し、(1)から社員コード、日付を除くフィールド、クロス集計からは＊を使って全フィールドを追加、結合したクエリーを作成すれば、目的の結果が得られます。確認して下さい。社員フィールド、日付フィールドの位置が中程になってしまいますが、訪問数がその都度変化することに対応するとこうなります。不明点があれば補足ください。
>特定の作業（レイアウトモードに切り替える等）をすると、 >タブ1の表示にもどってしまいます。 無理です。タブコンではなく別レイアウトにした方がまだいいかも。
もっとも肝腎なところが抜けています。 リモートマシンからどのような方法で、MySQLサーバーのあるマシンへ接続するのでしょうか？ とはいえ、第１にMySQLサーバー自体では、リモートにあるファイルは直接は読めません。 load data local infile文は、クライアントとなるアプリを通してそのファイルとSQL文とを送り込むから読めているだけです。 第２にクライアントは、何を使うのでしょうか？ mysqlクライアントツールが、リモートマシン側にあって、そこからログインするとしても、mysqlクライアントツールも、sql文を書いたテキストファイルを読んで実行することは出来ても、入力中のSQL文に、外部ファイルからのデータは取り込めません。 しかし、「特定のテキスト」自体をSQL文全文にしてしまえば、SQLスクリプトファイルとして読んで、実行することが出来ます。 http://dev.mysql.com/doc/refman/5.1/ja/batch-com … または、クライアント側のバッチファイルなり、シェルスクリプトなり、または、phpやperlなりで、そのテキストを読みとったうえで、SQL文全文を作成するプログラムを書けばよいでしょう。
#1の方と書き方が違うだけですが、 SELECT * FROM テーブル名 WHERE SUBSTR(chk_open_date_time,1,4) || SUBSTR(chk_open_date_time,6,2) || SUBSTR(chk_open_date_time,9,2) = '20131115' 後、カラムの型がもしDATE型の場合、TO_CHARでフォーマットしてみる SELECT * FROM テーブル名 WHERE TO_CHAR(chk_open_date_time, 'YYYYMMDD') = '20131115'
(1)SUBSTRで必要部分を取り出して検索する SELECT * FROM テーブル名 WHERE SUBSTR(chk_open_date_time,1,10) = '2013-11-15' SUBSTR(文字列(カラム名), 開始位置, 文字数)で必要部分を取り出して検索条件つ使用する (2)LIKEで前方一致 SELECT * FROM テーブル名 WHERE chk_open_date_time LIKE '2013-11-15%' LIKEで指定日付で始まるものを条件とする
DoCmd.OutputToは、使用したことはありませんが、レポートのRecordSourceとして、"ID=" & PubIDReturn()をWhere条件にしたQueryを指定すれば良いと思います。 フォームのテキストボックスで、PDF化したいIDを指定し、このIDで絞り込まれたレポートをPDFに出力させます。 フォーム上のボタンで操作するなら、次のようにVBAを組むことが考えられます。 モジュールオブジェクトで、Public PubID as Longとグローバル変数宣言します。 次に、このグローバル変数を返す関数PubIDReturn()を定義します。 Public PubID As Long Public Function PubIDReturn() As Long PubIDReturn = PubID End Function 次にIDを指定するフォームで、実行ボタンのクリック時イベントに次のようなモジュールを作成します。 Private Sub コマンド0_Click() If IsNull(Me![ID]) Then MsgBox "IDを指定して下さい" Exit Sub End If PubID = Me![ID] DoCmd.OutputTo acOutputReport, "レポート名", acFormatPDF, "保存path&ファイル名.pdf" End Sub レポートに設定するQueryは次のように設定します。 SELECT * FROM テーブル1 WHERE (((テーブル1.ID)=PubIDReturn())); これで如何でしょうか？ IDは、オートナンバー型を仮定しています。 実際のIDのデータ型に合わせて確認下さい。
ANO.1,2です。 >繰り返し、エクセルファイルを作成する試験を行ったところ、オブジェクト変数のclose処理を行ったのに改善されませんでした。 とは、私も意外でした。 なにか他に悪さをしている処理があるのでしょうけど、 ちょっと見当がつかないです。 ただ、最後に１個だけ、 ・・・ XLWS.Select With ActiveSheet.PageSetup ・・・ With XLWS.PageSetup に変えても動いたと思うのですが、 これでやってみてもだめでしょうか？ （ 例えばExcel自体が２個立ち上がっていると With ActiveSheet.PageSetup とすると、どちらのExcel？ってことになるように思われますので。 ）
リンクテーブルへのリンクテーブルは張れないと思いますよ。
#1です。 1秒毎に１加算した（できた）として、どうやってソレを参照するのか？ 「何らかのテーブルの何らかの列に記録を繰り返す」が必須なのですか？ select sysdate from dual; を投げれば、システム日付・時刻を取得できます。 １）処理の開始時点のシステム日付・時刻を取得し秒数に変換して保持しておく。 ２）参照したい時点のシステム日付・時刻を取得し秒数に変換し、１）の秒数を減ずる。 で経過秒数になると思いました。
【ARCHIVE_SAMPLE】 ArchiveID　Order_SampleID 1　　　　　2 2　　　　　1 【ARCHIVE_ORDER】 ArchiveID　Order_SampleID 1　　　　　1 2　　　　　2 こういうデータがあると抽出結果は2件になっていいんですか？ やりたいことはこうじゃないんですかね？？ SELECT M.* FROM ARCHIVE_SAMPLE M WHERE EXISTS ( SELECT AO.ArchiveID, AO.Order_SampleID FROM ARCHIVE_ORDER AO WHERE AO.Order_PatientID LIKE '%234%' AND M.ArchiveID = AO.ArchiveID AND M.Order_SampleID = AO.Order_SampleID ) また、LIKEでUPPER()を利用していますが、不要、かつカラムに指定することで インデックスが利かなくなります。
音楽管理ソフトは何をお使いですか？ ソフトによっては、ライブラリ中の楽曲の情報をCSV形式などで書き出せるものもありますけど。 当方が使用のMediaMonkeyですと、標準で選択ファイル群の情報をCSV形式やExcel形式で書き出せます。項目は固定で、アーティスト、タイトル、アルバム、長さ、録音年、ジャンル、評価、ビットレート、パス（CSVの場合）。 更に、CustomReportという追加スクリプトを入れれば、ソフトが管理してる情報のほとんどすべてから任意に出力項目を選んでCSV形式やExcel形式で書き出しも可能。 http://mediamonkey.xn--m8jfw.jp/index.php?%A5%B9 … タグエディタのMP3Tagでも上記と同様のことが出来ますね。 また、表計算ライクなタグエディタのSTEP、STEP_Mとかですと、セルを選択して直接Excelとの間でコピペ出来ます。 一旦Excelに読み込ませることが出来れば、後は如何ようにも出来ますよね。
私のアクセスにはないのですが、さんこうしょでみたことです。クエリーの中にユニオンクエリーと追加クエリーがあり、ユニオンクエリーでは二つのテーブルは合体することはないが、追加クェリーは合体するということです。参考にしてください。
画像のデータからという意味では無理ですね。 画像にURLなどは記録されていません。 Googleの画像で検索する機能で同じ画像のあるサイトを発見することはできるかもしれません。 http://www.google.co.jp/insidesearch/searchbyima …
SQL Serverの話ですよね？ > ntextの代わりにnvarchar(4000)を使う そういうことでしたらそうしてください。 ただし、インデックスに使わないのであればnvarchar(max)の方がよいでしょう。 http://technet.microsoft.com/ja-jp/library/ms187 … > ntext 、text、および image の各データ型は、将来のバージョンの Microsoft SQL Server で削除される予定です。 　(中略) > 代わりに、nvarchar(max)、varchar(max)、varbinary(max) を使用してください。 で、本題の「nvarcharを使うときはとりあえずnvarchar(4000)でいいんじゃないか？」という話ですが、 1列または1レコードのサイズが大きすぎるとこんな落とし穴があるようです。 クエリ関連 http://msdn.microsoft.com/ja-jp/library/ms345371 … キー・インデックス関連 http://technet.microsoft.com/ja-jp/library/ms163 … http://technet.microsoft.com/ja-jp/library/ms143 … このあたりのことも理解した上でサイズを決めた方が良さそうです。
どんな目的でインポートしたいのか分からないですが エクセルの1セルのデータはFMの1フィールドとなります。 1行が1レコードという意味です。 1レコードに全部入ったらDBとして何の意味も無いです。 単にエクセルのシートを保存したいという意味なら オブジェクトフィールドに挿入したらいいのでは？ エクセルなんか使わずに最初からFMにすればいいのに・・・
http://oshiete.goo.ne.jp/qa/8318594.html で回答したものですが、投稿後クエリで可能 であることに気づいたのですが、気が付いた ときはすでに締め切られていたので、この場 をお借りして投稿しておきます。 クエリの内容はNo1の方と重複するのですが。 SELECT * INTO テーブルB FROM (SELECT 名前1 AS 名前,タイム1 AS タイム FROM テーブルA UNION SELECT 名前2 AS 名前,タイム2 AS タイム FROM テーブルA UNION SELECT 名前3 AS 名前,タイム3 AS タイム FROM テーブルA ) AS Temp;
クエリではできない、と思いますが。 以下、DAOで。 Sub test80() 　　Dim db As DAO.Database 　　Dim rs1 As DAO.Recordset 　　Dim rs2 As DAO.Recordset 　　Dim i As Long 　　Set db = CurrentDb 　　Set rs1 = db.OpenRecordset("テーブルA") 　　Set rs2 = db.OpenRecordset("テーブルB", dbOpenDynaset) 　　rs1.MoveFirst 　　Do Until rs1.EOF 　　　　'コメントアウトしている部分は参考 　　　　'rs2.AddNew 　　　　'rs2!名前 = rs1.Fields("名前1").Value 　　　　'rs2!タイム = rs1.Fields("タイム1").Value 　　　　'rs2.Update 　　　　'rs2.AddNew 　　　　'rs2!名前 = rs1.Fields("名前2").Value 　　　　'rs2!タイム = rs1.Fields("タイム2").Value 　　　　'rs2.Update 　　　　For i = 1 To 2 　　　　rs2.AddNew 　　　　rs2!名前 = rs1.Fields("名前" & i).Value 　　　　rs2!タイム = rs1.Fields("タイム" & i).Value 　　　　rs2.Update Next i 　　　　rs1.MoveNext 　　Loop 　　rs1.Close: Set rs1 = Nothing 　　rs2.Close: Set rs2 = Nothing 　　db.Close: Set db = Nothing End Sub
CDを購入すれば良いのでは。 http://www.stat.go.jp/data/k-sugata/index.htm
適正なインデックスがあれば特にスピードは変わらないと思いますが？ //元データ create table user(user_id int,user_name varchar(20),index(user_id,user_name)); insert into user values(1,'aaa'),(2,'bbb'),(3,'ccc'); create table user_agreements(user_id int ,money int,index(user_id,money)); insert into user_agreements values(1,5000),(2,3000),(2,5000),(1,8000),(2,4500),(3,10000),(3,2500); //例1 select user_id,count(money) as money,user_name from user inner join user_agreements using(user_id) group by user_id; //例2 select user_id,(select count(money) as money from user_agreements where user_id=t1.user_id) as money,user_name from user as t1; //例3 select user_id, money,user_name from user as t1 inner join (select user_id,count(money) as money from user_agreements group by user_id) as t2 using(user_id); 例1と例2はほぼ同じ、例3は若干効率が悪いかもしれません
たとえば、 update A set numStr = case numStrの長さ when 4 then '0000' when 6 then '00' else '' end || numStr where numStr is not null; みたいな感じでいいと思うのですが、パッとInterbaseのリファレンスを見た限りでは 文字列の長さを取得する関数はないようですね・・・。 Interbaseについて全く知識がないので的外れかもしれませんが、 http://www.geocities.jp/kimura804/rdb/InterBase/ … こちらのページのようなプロシージャを作ったらうまくいくのかもしれません。 なにかの参考になれば幸いです。
桐は持ち合わせていませんが・・・。 ODBCの設定では？ C:\Windows\SysWOW64\odbcad32.exe を立ち上げると32bit版の設定ができますので、 システムDSNにエクセルの設定を追加。 名前は適当で構いません。 これを桐で使用したら出来るかもです。 AccessからVBAでODBC経由で接続した経験からですので どうかな？ http://support.microsoft.com/kb/942976/ja
ACCESSからＯracleへのリンクテーブルですか？ ACCESS上でパススルークエリ以外のクエリなら、to＿charでは無くformatを使います。 insert table into (format(now(), 'yymmdd'), ......); です。
No2です 蛇足ではありますが、示したページにはボタンで実行するように説明さてれてますが、アクション名：キー送信、キー操作：%TDCをご自身のマクロの最後に付け足すということで実行してください。 もちろん、ページのように最適化マクロという名前にしてご自身のマクロから「マクロの実行」「最適化マクロ」で実行させてもよろしいでしょう。 ただし、ページに書かれている注意事項は確認しておいてください。
Private Sub calendarForm_DateChanged(newDate As Date) 　　Me.[日報選択] = newDate 　　Call 日報選択_AfterUpdate End Sub では、どうですか。 あるいは、 Private Sub calendarForm_DateChanged(newDate As Date) 　　Me.[日報選択] = newDate 　　Me!F_日報商品売上.Requery 　　Me!F_日報扱い現金.Requery 　　Me!F_日報扱いクレジット.Requery End Sub これでは。 もし、構文エラーになるなら、メニューの [デバッグ]-[****のコンパイル] で反転選択される部分のコードを教えてください。
(1) 解りません。 もちろんkgyqk433さんがそのように要求される権利はありますが、私が従う義務はありませんので従いません。 この後に発言するかどうかはその時に決めます。 (2) 既に回答済みなので、読解力があるならご一読ください。
＞条件としては、最適化をVBAなどでするのではなく、 ＞　マクロのコマンド：データベースの最適化 ＞でしたいと思っております。 自分自身のmdbを最適化するのは不可能です。 何故なら、マクロの実行中は「自分自身が開かれている」からです。 仕様で「開かれているデータベースは最適化は不可能」になっていますから、結果的に「自分自身は最適化不可能」なのです。 なので、最適化を自動でやる場合は「マクロでは絶対に不可能」です。最適化を自動でやる場合は「VBAで、開かれていない、自分自身以外のデータベースを最適化するしかない」のです。 ＞※具体的手順を記載できない場合は、この質問は無視して下さい。 無視する訳にはいきません。 「不可能」ですから「具体的手順を記載できない」ですが、だからと言って無視し続けていると、質問者さんは「記載できる人が出てくるまで、諦めない」でしょう？ そうすると「不可能だって事に気付かず、無駄に何度も何度も質問し続ける」って事になります。 「できないものはできない」ってのが判ったら、VBAで行うとか、他の方法を考えて下さい。 ＞私の質問文が悪く、希望する回答をえれませんでした。 違う。「貴方の希望する回答が存在しない」のだから、質問文が悪かった訳じゃない。 「無いものは無い」のだから、諦めなさい。
>>となると、データベースを扱うという部分ではパフォーマンスはあまり変わらないのでしょうか？ Oracleは、データベースとしてパフォーマンスと耐障害、信頼性を十分に考えた作り方をしていると思います。 Oracleの内部動作について学べば、「プログラマーとして考えたら、こういう作りにするだろうなあ（作るのは面倒だけど・・）」と思えるような正当派の堅実なやり方をしているように思えてきます。 ですので、たぶん、大規模になれば、オープンソースソフトよりも、パフォーマンスがいいような気がします。 でも、個人ベース、中小企業レベルでは、そこまでの大差はつかないような気もします。 たぶん、どのソフトを使うかという場合、単なる速さ以外にも、さまざまな要求項目が出てくると思います。そういう中で、消去法によって残るのがOracleが多いってことだと思いますし、要求項目が少ないなら、オープンソースのソフトから選んでもいいように思います。 そして、データベースを選択するときは、単なるパフォーマンスだけでなく、「自分がこの部署を去ったあとも、システムを維持できるか？」なんてことも考えることになると思います。 そこまで考えたとき、「コストパフォーマンスとしては、最高ではないかもしれないけど、代わりの技術者が得やすくて、安心して使える有償のＤＢを選択する」という判断となることもあると思います。
プロシージャに直接ショートカットキーを割り当てることはできませんが、マクロならできますので、 マクロからプロシージャを呼び出すようにして（プロシージャの実行）、そのマクロにショートカットキーを割り当てればどうでしょうか。 マクロにショートカットキーを割り当てる方法は下記を参照してください。 キーボード ショートカットを使用して Access マクロを実行する - Access - Office.com http://office.microsoft.com/ja-jp/access-help/HA …
マクロの最後に最適化を入れたいという理由は、ワークテーブルを使用していて、大量データの削除・追加を繰り返すのでMDBファイルサイズが肥大化するのに対処したいということでしょうか。 もし、そうなら、テーブルだけのMDBファイル（データMDB）と、クエリ、フォーム、レポート、マクロ等のMDBファイル（アプリMDB）に分割してアプリMDBからデータMDBのテーブルをリンクするという設計に変更すればどうでしょうか。 ワークテーブルもデータMDBに作成します。 そうすれば、アプリMDBの方から、データMDBを最適化できます。また、アプリMDBはデータの追加・削除は発生しませんのでファイルサイズの肥大化は防げます。 また、このように分割しておくと、MDBの破損の危険性が減らせますし、アプリMDBが破損してもデータは残る、など安全性が高いというメリットもあります。
フィールドA&" "&フィールドB&" "&フィールドC などの計算フィールドを作るだけでは？
> マクロの一連の流れの最後で、データベースの最適化をしたいと > 思っていますが、具体的にどのようにすれば、 > データベースの最適化を実行できるのでしょうか？ 一連のマクロの最後に最適化するということなら可能だと思いますが、 一連の流れの途中に入れるは原理的に不可能だと思います。 最適化はいったんデータベースファイルを閉じますので。 方法は下記を参照ください。 Access2003以前の場合 開いているデータベースを最適化する(Access VBA) http://www.ka-net.org/office/of05.html Access2007 開いているデータベースを最適化する(Access 2007 VBA) http://www.ka-net.org/office/of06.html VBAになりますので、上記の Sub を Function に書き換えて、マクロの「プロシージャの実行」で呼び出します。
こちらがお勧めです。 http://www.microsoft.com/japan/office/previous/x … 「その設定の解除方法について」にも目を通しておくことをお勧めします。
Accessにぴったりの要件のように思います。 提示された要件はAccessですべて可能です。 ビジュアルスタジオ等の開発環境だと、一からすべて作成していく必要がありますが、Accessなら、テンプレートやウィザードである程度の雛型はできるので、それをもとに手直したり、機能追加したりという形で開発できるので、かなり楽できます。 プログラミング知識がなくても、ウィザードやプロパティの設定である程度のものは作成できますし、VBAを使用してプログラムすればかなり高機能なことまで可能です。 画像データの管理に関しても、2003以前のバージョンでは弱かったですが、最近のバージョンは強化されて楽に扱えるようになりました。 パーソナルに使うなら問題なくお勧めです。一桁台の人数までなら共有する運用でも使用できます。MSの製品ということもあってユーザーも多く情報も豊富にあり簡単に入手できます。 ただ、まがりなりにもデータベースなので、テーブル設計にはそれなりの知識が必要です。それなしエクセルの間隔でテーブル設計をすると使い物にならないものになります。データベースに関数する知識は他にも活かせるので苦労してでも取得しておいて損はないです。 入門書や初心者向け解説サイトは豊富にありますので、まずはその中から自分の目的にあいそうなものを見つけるといいでしょう。顧客管理をサンプルに解説しているものも見つかると思います。
そのmdbファイルをAccessw2000で開いた時、フォームが自動で表示されるようにしているのでしょうか？ 確かAccess Runtimeで使用するにはそれが前提だったはずです。 Autoexecという名前のマクロを作り、フォームを開くなどで起動後の動作を指定するのが約束事。 http://www.naboki.net/access/heaven/heaven-01.html こちらの「ランタイムはデータベースウィンドウを表示できない」にかかれてますね。 で、Autoexecマクロを作成するとRuntimeじゃないAccessで開くときも自動実行されます。 デバックやフォームのデザイン変更を行いたいときは、mdbファイルを開くときにShiftキーを押しながら開けばAutoexecは無視されるはずです。
下記のSQLてどうでしょう。 SELECT * FROM テーブル名 WHERE 名前 Not Like "[tk]*" AND 入社日 Between "19900101" And "20000101";
　質問の例題が、あまりにも省略されている為に、正確な要件が解らなくなってしまっています。 　おそらく、商品テーブルにも在庫テーブルにも、そのほかのフィールドがあるはずですよね。そうで無いと、在庫テーブルはレコードの特定が出来ませんし、商品テーブルに至っては存在価値を疑ってしまいますので・・・ 　で、質問の結合方法も、そのほかのフィールドがらみで方法が変わってきそうです。 　本当に、質問内容だけでしたら、一番単純な解は、 select distinct ID from 在庫テーブル 　です。結合の必要なんてありません。 　こんなのも、いちおうあり・・・ですが・・・ 　select distinct z.ID from 商品テーブル s join 在庫テーブル z on s.ID=z.ID 　これで、少なくとも、商品テーブルに存在する商品ＩＤのうち、在庫テーブルに存在する商品の重複の無いＩＤが取得できます。が・・・普通、商品テーブルに存在しない商品IDてのが想像しがたいので、意味があるかどうか・・・ 　普通は、この類のテーマだと、 select s.ID, sum(z.数量) from 商品テーブル s join 在庫テーブル z on s.ID=z.ID group by s.ID 　等とやって、「商品の在庫量が知りたいです」となるんですけど・・・ 　さて、いったい何がやりたいのでしょうか？ 　「いろいろとやりたいこと」の内容を書かれた方が、的確な答えが返ってくると思います。
>>ACCESSでローカルに作成したデータベースを WEB上で使用できるようにすることはできますか?? はい、条件付きで、できますよ。サーバ機のＯＳとしてWindowsOSを使っていることが必要です。offec365では無理なように思えます。 まずは、自宅サーバであれば、Windowsサーバを用意すればいいだけですね。レンタルサーバの場合は、以下のようなWindowsベースのサーバを使っている業者と契約すればＯＫです。 http://www.datajapan.ne.jp/expressweb/ ただ、ローカルにてACCESSで作成したアプリは、Ｗｅｂ対応じゃあないので、そのままでは使えないですよ。 お手軽にWebアプリとしてじゃあなく、クライアント／サーバ的に動作させるなら、リンクテーブルとしてサーバ上のＭＤＢファイルを、ローカルのACCESSアプリから使うような方法になると思います。ただし、多人数で同時使用には向かず、処理速度が遅くなると思えます。 きちんとしたWebアプリにするなら、ACCESSはデータベースとしてだけ使い、アプリ部分はASP.Netで作り直すことになると思います。 ＭＳや有志の提供でACCESSからASP.Netにアプリを変換するツールもあるようですが、１００％の自動変換はできないので、手作業でのプログラム修正・追加になると思います。 ただ、ここまでやるなら、ACCESSではなく、SQLServerをデータベースとして選んだほうがいいでしょうね。
ANo.1の方がショックを受けておられたようですが、 DB2にisnumeric等の文字かどうかや数値かどうか等を判定する関数は、なかったと思います。 以下はAS400のDB2のマニュアルですが。。。（すぐに見つかったのがこれだったので。） http://publib.boulder.ibm.com/html/as400/v4r5/ic … ということで、 ANo.1の方が書かれているＵＲＬの方法を応用するとか、 select max(項目名１) from テーブル名１ where length(trim(translate(項目名１,' ','0123456789'))) = 0 とするとかしないとダメと思います。 注：このwhere句の意味。 (1) translate(項目名１,' ','0123456789') 0から9までの数字を空白にする。 (2) trim( ・・・ ) 前後の空白を除去する (3) length( ・・・ ) 長さを調べる。 0から9までの数字は空白に置き換えられた後、他の文字がなければ、trim()で消去され、 長さ０になっています。 ただし、空白が途中に入っていても数値とみなしてしまうので、'12 3'等があれば使えません。 未検証です。 マニュアルの文法では、 translate(項目名１,変換先文字列,変換元文字列) と書いてあったので多分大丈夫と思いますが。 （Oracleなんかと逆なのでちょっと気がかり。ご自身の持つマニュアルで確認するなり、 　動かしてみて確かめるなりしてください。）
SELECT 組 ,1+IIF([タイムA]>[タイムB],1,0)+IIf([タイムA]>[タイムC],1,0) AS Aの順位 ,1+IIf([タイムB]>[タイムA],1,0)+IIf([タイムB]>[タイムC],1,0) AS Bの順位 ,1+IIf([タイムC]>[タイムA],1,0)+IIf([タイムC]>[タイムB],1,0) AS Cの順位 INTO テーブルＢ FROM テーブルＡ; イムA],1,0)+IIf([タイムC]>[タイムB],1,0) AS Cの順位 FROM テーブルＡ; 同一のタイムが複数ある時については何も書いていないので考慮していません。
cint( )でDLookupを囲う。 テキストボックスの値をNz( )で囲うと、なお良いかも。
テーブルデザイン画面で、入力を必須とするフィールドのRequired/値要求" プロパティに「はい」を設定すればよいと思います。 試して見てください。
ACCESSからやると接続文字列テストは面倒なので単体でってみるとか。 デスクトップで右クリック＞新規作成＞テキストファイルとやって ファイル名はTEST．UDLとでもして下さい。 「表とＰＣ」みみたいなアイコンに変るので起動。 ここで順を追って進めて下さい。
1の関連コードと言うと、マクロの内容を記載すればいいのでしょうか？ ・サブフォームのレコードソース。 　　-->サブフォームをデザイン表示しプロパティで確認。 ・マクロ（VBA）のコード。 　　-->どこかに XXXXXXX.Requey のコードがあるはず。 　　レコードソースから不具合の引き金になっているテーブルが判明。 　　それを手掛かりに、問題の日付以後の全データを削除。 　　（もちろん、バックアップしておいて・・・） 　　先ずは、このテーブルの破損個所の修復テストでどうなるのか？ 　　レコードソースのSQL文の変更と不具合との関係もテスト。 　　SELECT 列名 FROM テーブル名 WHERE 列名 BETWEEN 値１ AND 値２; 　　もしかしたら、 BETWEEN "#2013/09/09#" AND "#2013/0910#" 　　という書き方だとエラーは発生しないかも知れません。 2の停止コードをコメントアウトと言うのがどのような作業なのか？ 　　XXXXXXX.Requey 　　　↓ 　　' XXXXXXX.Requey 　　Stop 　　実行コードをRem文に変更。 　　同時に Stop文も挿入。 　　この修正で、サブフォーム更新はストップします。 　　Stop文を含むVBAも表示されます。 　　ここで、{F9}を押して反応をみます。 　　また、その他のエラー回避策も試します。 【最初にやるテスト】 テスト１、問題なく動作していたバックアップで問題日付を試す。 　　これが一番確実で、しかも、真っ当なやり方です。 　　「不具合が発生したらバックアップに戻れ！」です。 テスト２、HDDとMDBの修復が終わったらテーブルの修正・復元です。 　　バックアップが利用できない場合は・・・。 　　問題の日付以後の全データを削除=>最適化/修復。 　　動くようだったら、必要なデータを少しづつ戻してテスト。 　　動かなかったら、テーブルの全データを削除=>最適化/修復。 　　動くようだったら、必要なデータを少しづつ戻してテスト。 PS、考え方。 (1)Accessのバージョンの旧さが原因。 (2)MDBの破損が原因。 現象からは(2)が有力そうですが(1)も視野に。 日付が"yyyy/mm/dd"形式でないこと、あるいは、関連テーブルの破損によりレコードソースの再取得でスタック領域を浪費。もって、エラーが発生。ということならば、(2)と(1)とを両睨み。などなどと考えています。 　　
Ａ．VBE(エディタ)は、Shift-JISみたいです OfficeやVBAの文字列型はUnicodeなので、処理は可能です。 ただ、エディタがsjisなので、補助漢字はコード上に書くことができません。なぜかMsgBoxもsjisです。 　→ 仕様かと。ChrWしかないと思います。 　参考)http://codezine.jp/article/detail/1718 Ｂ．VBAはサロゲートペア(4byte文字)未対応です 2byte*2として扱われます。 　→ "
自分のソフトにデータベースの機能を組み込みたいと思ったときに使うものです。 たとえば、メールソフトで、 受信したメールを詰め込んだデータベースを作る。 並べ替え（件名、受信年月日、送信者など）などがすぐ出来ます。
No.5の補足からすると、「手元に届くデータが定型的ではない」ということですか。 それはコンピュータ処理に向きませんねぇ。(^_^;) どんなに雑であっても、一定の法則が無ければ簡単な解決方法はありません。 一番の近道は、現状のままで解決策を見つけるのではなく、 ある程度コンピュータ処理に向いた記述に変更してもらうのが一番だと思います。 #3さんが言われるようにどうしても雑な文には抜け道が発生します。 それらの注文方法が最低でもいくつかのパターンに収まるようにしてもらうべきだと思います。 例えば、 ◆区切り文字を決め（空白とか、：とか、／とか品目などで使用しない文字にします）、項目の順番を決める。 １３時５０分 3個 商品：7777 するめ （項目を空白で区切ってもらう、品目が最後と仮定し、商品コード以降の空白は品目とみなす） 高知へうど 3kg （品目は「へ」から最後の空白まで、最後の空白以降の文字は受注数とする） 高知へうどを3kg （品目は「へ」から「を」まで、「を」以降の文字は受注数とする） 上記のようないくつかのパターンに、ある程度整形してもらうことは難しいのでしょうか？ 私の今までの経験から、どんな文字が来るかわからない、ような受注内容では、いつまで経っても解決策はありませんし、 また、新たな受注文章が来た場合、今までの方法が使えなくなったり、訂正することによってこれまでの処理がうまくいかなくなるケースも往々にしてあります。 こういった、建設的ではない方法は、時間と労力と金銭の無駄．．という考え方でいます。 解決策にはなっていませんが、もっと前向きに、 建設的な方法（少しの労力を払ってでも、すべてがうまくいく方法）にシフトされることを望みます。
規格上は #2 の通りなんですが, 現実の世界は必ずしも規格に従っているわけではなく 「(SDHC ではなく) SD の 4 GB」 というのが実在していたりします. まあいまどきそうそう見つからないとは思いますが, 可能であれば確認しておくべきでしょう (規格外の製品なので使えなくても文句が言えない). あと「バンク切り替え」するやつもいた.
共有とかシェアリングてはないの。
Access2007は持ち合わせていませんので、ここんとこだけですが >※因みにアクセス2007に関してはネット環境がありませんので >ソフトやPCはアップデートはされません。 SP3未適用でしたら http://www.microsoft.com/ja-jp/download/details. … をダウンロードして、USBメモリなどを経由してインストールされれば？
http://www.mahoutsukaino.com/ac/ac2000/ac2000/ac … ここに非常に判りやすく書かれています。 ＞んでは、まずは普通にクエリを作り始めます。 ここまで出来たら、完成したも同然です。 添付画像を手掛かりにアタックされてください。
テーブルデザインの「その列」の定義と、いくつかのデータと、 クエリデザインをSQLビューにして「その問題のクエリ」を 開示していただけますか？
Access2002・2010（多分2013も）で フィールドのデータ型を設定してあっても インポートの際にはAccessが頑固一徹にデータ型を決めてしまいます。 Excelの場合はデータ行で先頭から8行を空読みして決定しています。 これはレジストリに登録されています。 レジストリエディタを立ち上げ Ctrl + F で Typeguessrows を検索すると（当方では最初に見つけるまで１分程度） WindowsXPなら HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\4.0\Engines\Excel にあるかと思います。 複数個所（Windows7 & Office2010なら二か所でした）にあることも。 規定値は、8 になっていますので この値を10進数なら30位の適当な大きな値にするか 0 にすればすべてを空読みしてからデータ型の決定を行います。 (0 だとモノによっては時間が掛かるかも） CSVファイルなら、Maxscanrows を検索してみてください。25行になっているかと。 FF1　FF2 1　　123 2　　123 3　　123 4　　123 5　　123 6　　123 7　　123 8　　123 ここまでで数値型に決定される 9　　abc データ型が違うので除外される レジストリの変更をすれば、その後はデータ型に注意しなくともすみますが、 権限の問題でRegedit.exe を立ち上げられない（変更ができない） レジストリの変更に不安 な場合は、 先頭に近いセルの値に一つにシングルクォーターしょんを付け、123 → '123 にしてしまうことです。 そうすればすべてテキスト型で読み込まれます。 なお連続している順番が 数値→数値・・・・・・・・・テキスト だと変換エラーになりますが テキスト→テキスト・・・・・・・数値 だと数値もテキスト型として読んでくれます。 テキスト型はある意味オールマイティです。
Q_商品クエリは選択クエリでしょうか。 Q_商品とT_テストのフィールド名・フィールドサイズが同じなので currentdb.execute "insert into [T_テスト] select * from [Q_商品]",dbfailonerror で機能するかと思います。 >'システムメッセージの非表示 >DoCmd.SetWarnings False >DoCmd.RunSQL "DELETE FROM T_テスト" >'システムメッセージの表示 >DoCmd.SetWarnings True は、 currentdb.execute "DELETE FROM T_テスト" ,dbfailonerror だと確認メッセージを出さずに進行します。 Setwarnings で切り替える必要がなくなります。
主キーに複数の意味を持たせるな http://hatenachips.blog34.fc2.com/blog-entry-201 … 絶対に・・・というわけではないと考えますが 人間にとって分かりやすい ≒ データベースの処理に適切 だと思います。
最も簡単な対応は、[支店マスタークエリ]を作成されることです。そのクエリで、列[新支店CD]を生成されると目的は達成されます。 ※本来は、支店コードという可変なデータ列ではなく長整数の一意な数字を主キーに。もちろん、列[支店コード]はあっても構いません。が、それは、あくまでも表のデータ。リレーションを内部管理するキーとしては不適です。
質問者さんが作成されたファイルでしょうか？ >「フォーカス喪失時」 ボタンの「クリック時」は機能します は理解不能ですが >項目の「変更時」、「更新後処理」 はまったく反応なし？ 無反応の部分のコードをいったんメモ帳などに保存し 無反応なイベントプロシージャを削除。 最適化を行ってAccessも終了します。 再度立ち上げて、以前作成したようにメモ帳で保存したコードをペースト。 で動くようになりませんかね。 あるいは、mdb形式からaccdb形式に、ファイルタブの「保存して発行」から変換するだけでも 直るかも？ なお、VBEで参照設定に無効なものが無いかとかコンパイルが通るかなども確認を。 ※念のためファイルのバックアップを取ってからお試しを※ それでもダメなら確認のために動かない部分の Private Sub ・・・ ・・・ End Sub まで載せてみては？
> 出席番号１さんがライバルだと思っているのが、 > 出席番号３さん、５さんとします。 > ３さんは１さんのことをライバルと思っていませんが、 > ５さんは１さんのことをライバルだと思っています。 という関係は，「ライバル」テーブルに次の3行を登録すれば表現できます。 (user_id, rival_id) = ((1, 3), (1, 5), (5, 1)) (user_id, rival_id) = (1, 5) と (user_id, rival_id) = (5, 1) は，主キーの値はまったく別です。 ちなみに， 「ライバル」テーブルのrival_idが「生徒」テーブルの主キーを参照する外部キーであるのと同様， 「ライバル」テーブルの user_idも「生徒」テーブルの主キーを参照する外部キーです。 それから。 出席番号というのはクラス内の連番を指す概念ですか？ であるなら。 変則的な理由で年度の途中で出席番号が変わる可能性もありえますし，1年→2年→3年の進級によっても出席番号は維持できません。学籍番号（学生番号）に代表される，入学以降変化しない識別値を「生徒」テーブルの主キーにすべきです。
削除クエリーの場合、サブフォームに#Deletedと表示 me!サブフォーム名.form.requery じゃダメですかね。ゴミレス勘弁。 dao.recordset の件は分かりません。 調べる気力も体力もスキルも。。。 Access2010のヘルプでは Sub SupplierID_AfterUpdate() 　　Dim rst As DAO.Recordset 　　Dim strSearchName As String 　　Set rst = Me.Recordset 　　strSearchName = CStr(Me!SupplierID) 　　rst.FindFirst "SupplierID = " & strSearchName 　　If rst.NoMatch Then 　　　　MsgBox "Record not found" 　　End If 　　rst.Close End Sub ともなっています。 Sub CheckRSType() 　　Dim rs as Object 　　Set rs=Forms(0).Recordset 　　If TypeOf rs Is DAO.Recordset Then 　　　　MsgBox "DAO Recordset" 　　ElseIf TypeOf rs is ADODB.Recordset Then 　　　　MsgBox "ADO Recordset" 　　End If End でRecordsetのどちらを使っているか判別できるようです。 投稿用にタブインデントは全角スペースにしています。
No.1です。 データ様式の変更ができないということですね。 その場合、クエリーで、式1: CDbl(Left([テーブル1]![名前1],Len([テーブル1]![名前1])-1))のように入力し、このカラムを昇順にソートすればOKです。 Left関数で、文字長-1の文字を取り出し、℃を除き、数字部分だけを取り出し、これを数字（倍精度浮動小数）に変換し、この値でソートするという事です。 確認下さい。
こちらで試した限りでは dim fld as object j = "select * from [Sheet1$] " 　'←ここです。 myRS.Open j, myCon for each fld in myrs.fields debug.print fld.name next だと Alt + Enter （chr(10)）は、_ アンダーバー になってますね。 j = "select count(*) from [Sheet1$] where H24_決済 = '済';" だと？
バッチファイルとはコマンドプロンプトの BAT でしょうか。 テーブルだけではなくて、まるっと変換なら Accessの起動オプション /convert を使ってみては？ http://office.microsoft.com/ja-jp/access-help/HP … VBAなら、ConvertAccessProject メソッド があります。 http://support.microsoft.com/kb/304318/ja
あまり良い設計とは言えませんが、性能的な要請が厳しく、他の手段（後述のパーティショニング等）も無くて、そうせざるを得ない場合は有るでしょうね。 ということで、「一般的なやり方ではないが、アプリ内容(仕様)によっては普通に起こりうる」になるかと。 ただし、パーティショニング機能の有るDBMSでは、それによって月や日付によって物理テーブルが分割される事は一般的だと思われます。 http://lets.postgresql.jp/documents/technical/pa … http://www.atmarkit.co.jp/ait/articles/0611/22/n … もっとも、この場合は日付や月などのカラムもそのまま残しつつテーブルを分割する事になるのですが。
なら、ゴールは見えたも同然？ まずは頑張って不一致クエリウィザードを使って 未登録車両を抜き出せるクエリを作成してください。 そのクエリ名を仮に、Q未登録チェック とします。 このクエリだけでも目的の大半は達成かと思います。 あとは前回回答のを流用して Sub UnknownCarCheck() 'Microsoft Office xx.x Access database engine Object Library←Access2007から出来ました 'または、Microsoft 3.6 Object Libary←2003だと多分こっち のいずれかに参照設定が必要です　　 　　Dim db As Database 　　Dim rs As DAO.Recordset 　　Set db = CurrentDb 　　Set rs = db.OpenRecordset("Q未登録チェック", dbOpenSnapshot) 　　rs.MoveLast 　　If rs.RecordCount <> 0 Then 　　　　MsgBox rs.RecordCount & "件不一致あり" 　　　　DoCmd.OpenQuery "Q未登録チェック" 'クエリを開いて確認 　　Else 　　　　msgbox "未登録車両はありませんでした" 　　End If 　　 　　rs.Close: Set rs = Nothing 　　Set db = Nothing End Sub というのを必要な時に行えばどうでしょ。 なお、上記回答は CSVファイルを一時的なテーブルにインポートして それと車番マスタを照合する場合を想定しています。
手元に ACCESS が無いので動作未確認ですが、下記のSQLではどうでしょうか？ (weather テーブルに、日付/時刻型のdateカラムと文字列型のweatherカラムが有ると仮定) SELECT date, weather, DateDiff("dd", date, (SELECT MIN(date) FROM weather c WHERE a.date < c.date AND a.weather <> c.weather)) AS weather_count FROM weather a WHERE NOT EXISTS (SELECT * FROM weather b WHERE a.date - 1 = b.date AND a.weather = b.weather) AND date BETWEEN '2013-7-1' AND '2013-7-31' ;
回答者皆が分からんのか、なんで　「通信速度向上」＝「ケーブルを代える。それもクロスに」　と考えられたのか？？？？ まずは、その意図を公開して下さい。 １．クロスを使うのは、ふつーであれば、Ｔのポートを使って、ＰＣ同士、HUBを介さずにケーブルで直結する場合。 ２．通信速度を上げたいのであれば、ポート・ネットワーク機器・ケーブルが速度に対応できるのか？　とくにポート・ネットワーク機器が例えばＧ baseに対応していないと、当然、その速度は出ない。 ネットワークについて、もう少し整理してもらえませんか？
表示されたメッセージの末尾にあるファイルは、記述通りの場所に存在しますか？
良いと思います。 フロントエンドは「ユーザとのインターフェイス部分」、 バッグエンドは「向こう側の処理部分」と捉えると、 別サーバにＤＢを配置しているなら、フォームに限らず 「MS-ACCESSそのものがフロントエンド」になります。
FromにSelectを書く場合でも、数式と同様にカッコが優先されるから、と思います。
「レポートの元（テーブルorクエリ）で計算しておく」ではダメなんですか？ 単価: iif([商品]='商品A', 100, iif([商品]='商品B', 300, iif([商品]='商品C', 200, 0))) 金額: [個数]*[単価] の列を追加したクエリを新たに作り、それをレポートの元とする。 合計金額でsum(金額)を月別に求めればよさそう。
「その列」をｗｈｅｒｅ条件に記述して、is null またはis not nullで絞れますか？ どちらもできないなら、nullと空文字を混同しているのかも
IPアドレスではなく、ドメイン名で指定したらどうでしょう？ あと外部データソースで指定しておいたら、 PC上のスクリプトを起動させるなどでそのファイルがホストされているか確認できます。
2013環境はないので2010で確認しましたが、質問者さんと同じ結果でした。 クエリでの比較は、テキストモードでの比較なのでそれのバグが原因だと思われます。 （テキストモードとは、大文字/小文字、半角/全角、ひらがな/カタカナ を区別しないというモード。） 吉 だけなら No.1の回答者さんの方法でいいと思いますが、他にも環境依存文字の存在する可能性があるなら、StrComp関数でバイナリモードで比較するといいかもしれません。その代わり、大文字/小文字、半角/全角、ひらがな/カタカナ を区別するという比較になりますが。 フィールド　StrComp([フィールド名],[氏名を入力してください。],0) 抽出条件　0 これで2010環境では、パラメータに 土口 の吉田さんを入力すると1件のみの表示になりました。
こんなのを使えば簡単なのでは？ http://buffalo.jp/products/catalog/network/remot …
＃１、＃２です。すみません。漏れがあるので訂正。 select 区分, 理由１ as 理由　from <テーブル名> UNION ALL select 区分, 理由２ as 理由　from <テーブル名> UNION ALL select 区分, 理由３ as 理由　from <テーブル名> ; です。 UNION と　UNION　ALLの違いは、 UNION　ALLだとおのおののselect結果すべてを返す、 UNION　だけだと　区分, 理由　の重複を除去した結果を返す、の違いです。
>どうしてそうなってしまったのか、 経験はありませんが、 可能性の一つとして、複数ユーザーが同じファイルを共有していて・・。 誰かがレコードの削除を行った。 >又直すには、どうしたらいいのでしょうか？ あなたが作成したファイルではないのなら、作成者に相談してください。 決して自分で何とかしよう・・とは考えないこと。 あなたが作成者であれば ■必ずファイルのバックアップを取ってから■ Access でオートナンバー型フィールドの値をリセットする方法 http://support.microsoft.com/kb/812718/ja の2007の説明を読んでみてください。 自信が無ければ止めることです。 元々オートナンバーは一意の番号を付与するためのものです。 結果的に（副産物として）通し番号になっているだけですので 飛び番号を気にせず使い続けるのも選択肢の一つかと思います。
投稿してからもう一回見直していたら、 dt[i] の iもlocal変数だった、 i がn-1 まで回りきってから、callbackが呼ばれるので、callback 関数にもう一つかぶせないといけない db.transaction( 　(function(x1,x2){ /* データの受け渡し用wrapper関数と引数 */ 　　return function(tx) { 　　　tx.executeSql( "insert into 対象 (番号,名称) values(?,?)",[x1,x2], 　　　　function(tx,rs) {}, 　　　　function(tx,er) {alert(er.message);} 　　　);/* tx.executeSql の閉じ */ 　　};/* return するcallback 関数の閉じ */ 　})(cd,nm) ,/* wrapper関数に渡すデータの指定。これは、 db.transaction が呼ばれた時点の変数値が入る */ 　function(er) {alert(er.message)}, 　function() {} );/* transaction メソッドの閉じ */ ※ ()や{} の多重入れ子で括りの対応が解らなくなるので、全角空白でインデントしてます。コピー時は、半角に変換してください。 実行チェックしてないので、まだ間違いがあるかも？
SQLの種類によっては以下でもいけます select hoge,sum(stat='a') as a,sum(stat='b') as b from test01 group by hoge; なおcountでやるならnullを利用します select hoge , count(if(stat = 'a' ,0,null)) as a , count(if(stat = 'b' ,0,null)) as b from test01 group by hoge; もうすこし複雑になってくるとピボットテーブルという処理用のテーブルを 用意すると効率的に処理ができます
キーとなる列名を指定して、Group Byを用います。 select hoge, count(*) from test01 group by hoge; 場合によっては select hoge, count(hoge) from test01 group by hoge; と書くかも。
＞ＤＢはｍｙＳＱＬ それはおそらくMySQLの仕様が4.0まではcharやvarcharなどいわゆる文字列型の カラムの文字数上限が255バイトとなっていたからでしょう 現在のMySQL5系は拡張されて65535文字まで格納可能なのであまり255桁に こだわる必要はないかもしれません。 ただしインデックスの特徴で極端にながい文字列にインデックスを作成すると 無駄がおおく、肥大化による弊害もでてくるため、255文字程度を上限にしておいた方が 運用上効率的かもしれません （たいていのものの名称は200文字程度におさまることですし）
> Like "81*"の人で、負担金が600以上の人を追加しようとしましたが出来ませんでした。 式2として「何を」追加したいのでしょうか？ [番号]のLike条件が3つありますが、80*、90*の場合には式2に何を返しますか？ 以下、「Like "81*"の人で、負担金が600以上」でtrueを、それ以外はfalseを返します。 式2: IIf(([番号] Like '81*') and ([負担金]>=600)),True,False)
> データを移動・・・レコード移動・・・ という言葉が出てきていますが、表示上の事と解釈して良かったでしょうか 提示された５桁の数字部分のフィールド名を「番号」、テーブル名を「★★」と仮定します。 ９レコードを３×３の表示・・・これに限定したとすれば、以下でできそう SELECT Q1.*, Q2.*, Q3.* FROM ( (SELECT (Int(番号)-1)\3 AS S, (Int(番号)-1) Mod 3 AS M, * FROM ★★) AS Q1 INNER JOIN (SELECT (Int(番号)-1)\3 AS S, (Int(番号)-1) Mod 3 AS M, * FROM ★★) AS Q2 ON Q1.S+1=Q2.S AND Q1.M=Q2.M) INNER JOIN (SELECT (Int(番号)-1)\3 AS S, (Int(番号)-1) Mod 3 AS M, * FROM ★★) AS Q3 ON Q2.S+1=Q3.S AND Q2.M=Q3.M ORDER BY Q1.M; S は、番号を元に、何組目の表示になるのか M は、番号を元に、何レコード目の表示になるのか 表示レコードは、M が同じで 隣の S は 左側の S+1 になっている ９レコード限定なので INNER JOIN で結び付け 番号 「00001」の隣は「00004」で、その隣は「00007」 番号 「00002」の隣は「00005」で、その隣は「00008」 番号 「00003」の隣は「00006」で、その隣は「00009」 番号 「00004」の隣は「00007」で、その隣は・・・ないので INNER JOIN により抽出外 横３組は変えずに表示行を変更できるようにすれば、以下の様な感じで （実行すると「行数」の入力になるので、4 とか 5 とか入力すれば・・・） SELECT Q1.*, Q2.*, Q3.* FROM ( (SELECT (Int(番号)-1)\[行数] AS S, (Int(番号)-1) Mod [行数] AS M, * FROM ★★) AS Q1 LEFT JOIN (SELECT (Int(番号)-1)\[行数] AS S, (Int(番号)-1) Mod [行数] AS M, * FROM ★★) AS Q2 ON Q1.S+1=Q2.S AND Q1.M=Q2.M) LEFT JOIN (SELECT (Int(番号)-1)\[行数] AS S, (Int(番号)-1) Mod [行数] AS M, * FROM ★★) AS Q3 ON Q2.S+1=Q3.S AND Q2.M=Q3.M WHERE Q1.S=0 ORDER BY Q1.M; ※ 計算用に追加したフィールド「S」「M」は適当にあしらってください また、別の方法（クロス集計）を使って横５組限定としてみると以下の様な雰囲気に PARAMETERS [行数] Long; TRANSFORM First(Q1.値) AS 値 SELECT (Int(Q1.番号)-1) Mod [行数] AS 順 FROM (SELECT 番号, "番号" AS 項目, 番号 AS 値 FROM ★★ UNION ALL SELECT 番号, "郵便番号", 郵便番号 FROM ★★ UNION ALL SELECT 番号, "住所", 住所 FROM ★★ UNION ALL SELECT 番号, "氏名", 氏名 FROM ★★ UNION ALL SELECT 番号, "TEL", TEL FROM ★★) AS Q1 GROUP BY (Int(Q1.番号)-1) Mod [行数] PIVOT 項目 & (((Int(Q1.番号)-1)\[行数])+1) IN ('番号1','郵便番号1','住所1','氏名1','TEL1', '番号2','郵便番号2','住所2','氏名2','TEL2', '番号3','郵便番号3','住所3','氏名3','TEL3', '番号4','郵便番号4','住所4','氏名4','TEL4', '番号5','郵便番号5','住所5','氏名5','TEL5'); ※ クロス集計では、PIVOT 部分で IN 指定（列見出し指定）しないと、 TEL1,TEL2,氏名1,氏名2,住所1,住所2,・・・の様に、組として表示してくれない ※ 各フィールドの値を１つのものとして扱うので数値型があったとしても、ここではテキストに なお、上記クロス集計で５組を有効に使ってみると（行数はレコード数によって可変） TRANSFORM First(Q1.値) AS 値 SELECT (Int(Q1.番号)-1) Mod ((Q2.CT+4)\5) AS 順 FROM (SELECT 番号, "番号" AS 項目, 番号 AS 値 FROM ★★ UNION ALL SELECT 番号, "郵便番号", 郵便番号 FROM ★★ UNION ALL SELECT 番号, "住所", 住所 FROM ★★ UNION ALL SELECT 番号, "氏名", 氏名 FROM ★★ UNION ALL SELECT 番号, "TEL", TEL FROM ★★) AS Q1, (SELECT Count(*) AS CT FROM ★★) AS Q2 GROUP BY (Int(Q1.番号)-1) Mod ((Q2.CT+4)\5) PIVOT 項目 & (((Int(Q1.番号)-1)\((Q2.CT+4)\5))+1) IN ('番号1','郵便番号1','住所1','氏名1','TEL1', '番号2','郵便番号2','住所2','氏名2','TEL2', '番号3','郵便番号3','住所3','氏名3','TEL3', '番号4','郵便番号4','住所4','氏名4','TEL4', '番号5','郵便番号5','住所5','氏名5','TEL5'); ※ Q2 でレコード数を求めておいて、前述の [行数] 部分を ((Q2.CT+4)\5) に置き換えます ただし現状では、５組目が使われない事があります。 これは、左の組から行分データを詰めるので・・・ １０レコードなら２行で５組目まで使われますが、 １１レコードなら３行で、３組目までは埋まって、４組目は２つの計１１ ３行では、１３レコードになって初めて５組目が使われる事になります。 ※ なお、データ量によって組数（フィールド側）も可変にしたい場合は、 VBA で SQL を組み立てる事になると思います。 ※ 各処理性能はわかりません
#2のTabledefのConnect（接続文字列）にヒントが隠されているかもしれませんが、 当方では、 リンクテーブルでかつシステムオブジェクトであったケースは覚えがないので分からないです。 VBA云々は関係ないだろうとは思います。
今日、見つけたんですが [印刷プレビュー]タブを丸ごと表示して良いなら こちらの方法で。 http://mukkumuku.blogspot.jp/2010/10/access2010- … グループ毎の非表示もできそうですが、ID を調べたりしなくちゃいけないので。 <customUI xmlns="http://schemas.microsoft.com/office/2006/01/cust … <ribbon startFromScratch="true" > <tabs> <!-- idMsoで指定し明示する --> <tab idMso="TabPrintPreviewAccess" visible="true" /> </tabs> </ribbon> </customUI> もっと良い方法があるかもしれないけど、 一応動いている方法。 印刷プレビュー時 に 「印刷」「印刷プレビューを閉じる」だけを表示します。 USysRibbons に レコードを追加。 RibbonName ： PrintRibbon （何でもいいけどとりあえず「PrintRibbon」） RibbonXml ： <customUI xmlns="http://schemas.microsoft.com/office/2006/01/cust … <ribbon startFromScratch="true"> <tabs> <tab id="frmPrintTab4" label="コマンド"> <group id="frmPrintGroup1" label="印刷"> <control idMso="PrintDialogAccess" size="large"/> </group> <group id="frmPrintGroup2" label="プレビューを閉じる"> <control idMso="PrintPreviewClose" size="large"/> </group> </tab> </tabs> </ribbon> </customUI> 各レポートの「リボン名」プロパティ に「PrintRibbon」 を設定。 カレントデータベースのリボン名 は、非表示用のまま変更せずに。 以上です。
普通に「=」を入れて検索ですけど。 未入力では困るフィールドには自動入力オプションの 「空欄不可」を設定しましょう。
TextFormatRemove関数
私も質問者さん同様、中間ファイルを作成してから・・と思っていましたが、 Windows Vista および Windows 7 で Access 97 ファイル形式のデータベースを Access 2007 または Access 2010 ファイル形式に変換できないことがある http://support.microsoft.com/kb/942394/ja ↑のようにすれば一発変換ができました。 以下、手順。 （当方Windows7 64bit & Access2010 32bit 環境です。適宜、読み替えてください。） （検証したファイルは唯一残っていたNorthWind.mdb です。） Windowsのスタートボタンを押し、「Microsoft Access 2010 」を右クリック、 プロパティを選択し、互換性タブを選択、 「互換モードでこのプログラムを実行する」にチェックを入れ、 直下のプルダウンメニューから、「Windows XP(Service Pack 2)」を選択、 OKを押して閉じます。 Accessを今まで通り立ち上げて新規ファイルを作成します。 リボンの外部データタブから、Access を選択してウィザードに従って 全てのオブジェクト（テーブルやクエリ、フォームなど）を選択してインポートします。 途中でエラーが発生するかもしれませんが最後まで進めます。 そのまま修正作業に入りたいところですがぐっとこらえてAccessを終了し、 前述の互換モードのチェックを外します。 Accessを立ち上げて必要に応じてインポートしたファイルの細々とした修正作業を行います。 （ここからが大変かもしれません。） なお、 Windows 7 上の Office 製品を Windows XP SP3 互換モードで実行し VBEditor を開くと、マクロの全角文字の一部が削除されコンパイル エラーが発生する http://support.microsoft.com/kb/2297924/ja というバグがありますので、互換モードはSP2を選択が無難です。 また、互換モード中であれば直接97形式のmdbを開く事も出来ました。 開く際に変換するかそのまま開くかの選択肢が現れます。
mdbの制限は調べられましたか？ http://support.microsoft.com/kb/965659/ja
「Access コンボボックス 絞り込み」をキーワードで検索するとたくさん見つかりますよ。 例えば、 コンボボックスの絞込み http://hamachan.info/access/sibori.html
> 文法は間違っていないとは思うのですが・・・ syntax errorは構文エラーという意味です。 残念ながら文法が間違っています。 http://www.sqlite.org/lang_update.html #1で指摘されていますが、 上記のマニュアルを見ると「テーブル名.項目名」という書き方はできないことがわかります。
[参加県TB] テーブルに存在しない '東北' の県レコードを [都道府県TB] から削除するってこと？ [参加県TB] の [県ID] が主キーなどユニークである必要がありますが、クエリ ウィザードの不一致クエリ ウィザードで作成されたものを DELETE に作り変え、AND で ((都道府県TB.地域名)="東北") を WHERE に付け加えるだけ。 DELETE 都道府県TB.* FROM 都道府県TB LEFT JOIN 参加県TB ON 都道府県TB.[県ID] = 参加県TB.[県ID] WHERE (((参加県TB.県ID) Is Null) AND ((都道府県TB.地域名)="東北"));
byteで作れると思います。 create table テーブル1 (年 smallint , 月 byte);
>複数の属性 表現がよくわからないのですが ここでいう属性とは所定の「フィールド」を指すのでしょうか？ また例示された「あ～お」にあたるものもフィールドだということでしょうか？
相関サブクエリは遅くなりがちです。 F1グループ化、F2最大の集計クエリを作成する。 これと元のテーブルと内部結合した集計クエリで、F1, F2 グループ化、F3最大 というようにクエリを２段にすればいいでしょう。 サブクエリを使えば、一つのクエリにできます。 SELECT F1, F2, MAX(テーブルA.F3) AS F3 FROM テーブルA INNER JOIN (SELECT F1, MAX(F2) AS MaxF2 FROM テーブルA GROUP BY F1) Q ON テーブルA.F1=Q.F1 And テーブルA.F2=Q.MaxF2 GROUP BY F1,F2;
dcount("日付","テーブルA","日付 in(select 日付 from テーブルB") とか？
補足に気付かず遅くなりました、すみません。 コントロールの位置関係がよくわからないのですが、大雑把な流れは以下の様かと思います。 ※印のところが不明点です。 このサイトではTabインデントが使えないので全角スペースで代用しています。 Private Sub 予約ボタン_Click() On Error GoTo errH 　　Dim db As DAO.Database 　　Dim rs As DAO.Recordset 　　Dim WSP As Workspace 　　Dim reTryCount As Integer 　　Set db = CurrentDb 　　Set WSP = DBEngine.Workspaces(0) reTry: 　　'※Me!機材番号txtコントロール とこのコマンドボタンが同じフォームにあると仮定 　　Set rs = db.OpenRecordset("SELECT * FROM T_管理テーブル WHERE 機材番号='" & Me!機材番号txt & "'" _ 　　　　, dbOpenDynaset, dbPessimistic) 　　DBEngine.Idle dbRefreshCache 　　If rs.EOF And rs.BOF Then 　　　　MsgBox "該当する機材番号はありません", vbOKOnly 　　　　Me!機材番号txt.SetFocus ' 　　　　GoTo atoShimatu 　　End If 　　If rs!選択フラグ = True Then 　　　　MsgBox rs!機材番号 & "は既に他者に貸出中です。", vbExclamation, "入力依頼" 　　　　Me!機材番号txt.SetFocus 　　　　GoTo atoShimatu 　　End If 　　WSP.BeginTrans 'トランザクション処理開始 　　rs.Edit 'ここでロック開始 　　　　rs!選択フラグ = True '選んだことで選択フラグをセット 　　　　rs!担当者 = Forms!F_新規貸出フォーム!担当者 'メインフォームの予約担当者をセット 　　　　rs!予約日時 = Forms!F_新規貸出フォーム!年月日 'メインフォームの予約日をセット '　　　　　　　　・　（省略） '　　MsgBox "lock" '確認用です 　　rs.Update 'ロック解除される 　　WSP.CommitTrans dbForceOSFlush 'トランザクション処理終了 　　rs.Close 　　Set rs = db.OpenRecordset("T_TMPテーブル", dbOpenDynaset) '　　rs.AddNew '　　　　rs.機材番号= ・・・・（省略） '　　　　　　　　・（省略） '　　　　　　　　・ '　　　　rs.Update 'ここで　サブフォームのリクエリーを実施 'DoCmd.GoToControl "検索"　←　コントロールをメインフォームへ移動しようとしています。 '※↑コマンドボタンはサブフォームにおいてあるのかな？ 'DoCmd.Requery "機材詳細表示リスト" '※以下二行の説明がほしいです。PS.メインフォーム名とサブフォーム名も。 'DoCmd.Requery "予約済み機材表示" errH: 　　Select Case err.Number 　　　　Case 0 '正常処理の場合、何もしない 　　　　　　 　　　　Case 91 'rs の閉じエラー 　　　　　　err.Clear 　　　　　　Resume Next 　　　　Case 3218 '同時に複数から同じレコードに更新処理が掛かった場合 　　　　　　err.Clear 　　　　　　WSP.Rollback 　　　　　　MsgBox "他の人によって更新中です。", vbOKOnly 　　　　　　reTryCount = reTryCount + 1 　　　　　　 　　　　　　If reTryCount < 2 Then 　　　　　　　　Resume reTry 　　　　　　Else 　　　　　　　　MsgBox "データを更新できませんでした。" 　　　　　　End If 　　　　Case Else 　　　　　　Debug.Print err.Number, err.Description 　　　　　　MsgBox err.Number & vbCrLf & err.Description 　　End Select 　　 atoShimatu: 　　rs.Close: Set rs = Nothing 　　Set WSP = Nothing 　　db.Close: Set db = Nothing End Sub
お礼率27%では補足も厳しいか・・・・
そのような現象は出たことがないですけど データベース管理やレイアウトモードでそのフィールドがあったら 削除するとか。
FileMaker Pro　ネットワーク共有を使うのでしたら ファイル→共有設定→FileMaker ネットワーク をONにするだけですが、使わないのでしたら毎回出ます。
>>・先駆者がいてそれじゃ不十分だから発展していったのか、 そうだと思います。 >>・そもそものＥＲ図の使用度。そんなに使う？の意味合いで いままでの開発経験では、一番良く使われる資料でした。 >>・使い分けされてるのか、→だとしてその使い分けは？どれが頻度高いのか ＥＲ図なんてエンドユーザは関係無いものです。自分たちが分かりやすく、使いやすいものが一番です。 些細な記述上の相違よりも、ＥＲ図を作るツールの値段や、使いやすさで決まることが多い気がします。 つまりは、「あれがベストだけど、手が出ないんだよ。で、次善策としてフりーのコレ」となったりします。
UPDATE テストTB A INNER JOIN テストTB B ON A.責任者名 = B.社員名 SET A.責任者ID = B.社員ID という感じでどうでしょう？
一般的には、 【Ａ】顧客テーブル 主キー(1)顧客ID（オートナンバー・・・長整数型） (2)氏名（テキスト型） ※同一顧客で複数の発注を受けたら同じ顧客IDを使うように考えます。 （発注コードは入れるべきでない） 【Ｂ】商品テーブル 主キー(1)商品ID（オートナンバー・・・長整数型） (2)品名（テキスト型） (3)単価（通貨型）・・・定価があるなら設ける。 ※同一商品で複数の発注を受けたら同じ商品IDを使うように考えます。 （注文番号は入れるべきでない） 【Ｃ】注文テーブル 主キー(1)注文ID（オートナンバー・・・長整数型） (2)日付 (3)発注コード（テキスト型） 　　　　　　　※発注コードは『英数字』のためテキスト型。リンク元も『テキスト型』 (4)顧客ID・・・顧客との紐付けはこの項目で行う。 【Ｄ】注文明細テーブル（注文番号は全て4ケタの数字です。重複Noはありません） 　主キー(1)注文明細ID(オートナンバー型・・・長整数型） 　(2)注文ID（長整数型） または 　(1)注文ID（長整数型） (2)枝番・・・1から連番 主キーは(1)と(2)のセット (3)注文番号(数値型・・・長整数型) (4)商品ID (5)数量（注文番号1） (6)単価（通貨型）・・・商品マスタの単価はいつでも同じではないので、注文と一致しないことあり。 金額は、数量×単価で求めるか、別途(7)金額を設けるか。 （金額設定の仕方によりけりで、3本1000円とかがあるなら、(7)金額も必要。） 注文明細テーブルは、「ひとり最大50個の商品を一枚の注文書で発注します」に対応して、 １枚の注文書で、最大50レコード作ります。 リレーション 【Ａ】(1)-【Ｃ】(4) 【Ｂ】(1)-【Ｄ】(4) 【Ｃ】(1)-【Ｄ】(1)か(2) というふうにしますが。 （まずは、何でこういう設計にするのか、現状との違いから話をしていったほうが 　いいのかなと思います。 　⇒現状のほうがいいというのなら、それで話を進めてもいいのですが、 　　後の実績抽出は処理が面倒になると思っておいてください。）
正しく安全な遠隔操作ツール teamviewer 8 http://www.teamviewer.com/ja/download/currentver … 私も仕事場と自宅の間で使ってます。 偶然に他のＰＣと繋がるっていう掲示版？もあったみたいですが、それは無いと思います。 あったとすれば、それは「釣り」なので気をつければＯＫかと。 参考URL：http://www.teamviewer.com/ja/download/currentver …
GoもiPadも持っていないので厳しいですが >PC上の転送用の別プログラム（以降、ソフトB）を非表示で開き、接続ができた場合、 これってBをFM共有の「共有ファイルを開く」で開いていないのでは？
対象の Excel ファイルを一時的に別名 (必要であれば別の場所に) コピーして、コピーしたものを開くようにしたらどうだろうか。 これなら 「対象のファイルが存在するか」 というチェックを事前に行うことも可能なので、誰かが対象のファイルを間違って消してしまった場合にもプログラムでエラーを検知できる。
>【Ａ】顧客テーブルは　(2)の発注コードが主キー >【Ｃ】注文テーブルは、(1)のID（オートナンバー）が主キーです。 これはOKです。ただし、注文テーブルのID は 注文ID というように内容が分かる名前に変更しましょう。 >【Ｂ】商品テーブルは、(1)のID（オートナンバー）が主キー これは、ID を主キーにするなら、リンク先も ID(長整数型)にする必要があります。 注文番号をリンク先に格納したいのなら、「注文番号」を主キーにする必要があります。 注文テーブルは、下記のように２つに分割してください。 【Ｃ】注文テーブル 　　　(1)注文ID（オートナンバー） 　　　(2)発注コード 　　　(3)日付 　　　(4)氏名 ←この氏名が顧客テーブルの氏名ならば、このフィールドは不必要 　　　　　　　　　担当者とか別の内容のデータならOK、その場合は意味を表すフィールド名に変更したほうがよい。 【Ｄ】注文明細テーブル 　　　(1)注文明細ID(オートナンバー型） 　　　(2)注文ID（長整数型） 　　　(3)注文番号　　←商品テーブルの主キーが「注文番号」の場合 　　　(4)数量
update "store_table" set "t_tiket" = "取扱っている" where "kaiin_no" = ANY('{"100","101","103"}'); ではないですか？ IN句使うなら、それでも問題なさそうですけど
> ちなみに、不要なデータは削除してはいけないのですか？ 最初の件数(DCount)で連番をつけると、削除した分だけ取得する連番が小さくなりますからダメですが、 私の提案した最大値（DMax）を取得する方法なら、削除しても大丈夫です。 コードのロジックをきちんと理解して使用するようにしましょう。
このページが参考になると思いますが、いかがでしょう。 参考URL：http://www.db4o.com/japan/
No1です。 参照TB F1　　　F2　　　　F6　　　F7　　　F8 Ａ1　　あああ　　Ｂ1　　いいい　　Ｃ1 Ａ2　　えええ　　Ｂ21　　えええ　　Ｃ21 Ａ3　　かきく　　Ｂ3　　たちつ　　Ｃ3 修正TB F1　　　F2　　　F6　　　F7　　　F8 Ａ1　　959　　　Ｂ1　　363　　　Ｃ1 Ａ2　　965　　　Ｂ23　　111　　　Ｃ23 Ａ3　　115　　　Ｂ3　　499　　　Ｃ3 Ａ1　　236　　　Ｂ1　　546　　　Ｃ1 のようなサンプルテーブルで確認していますが。 利便上、F3とかF4などのフィールドは省いています。 このようなテーブルでクエリを実行すると、 F1　　　F2　　　F6　　　F7　　　　F8 Ａ1　　あああ　　Ｂ1　　いいい　　Ｃ1 Ａ2　　965　　　Ｂ23　　111　　　Ｃ23 Ａ3　　かきく　　Ｂ3　　たちつ　　Ｃ3 Ａ1　　あああ　　Ｂ1　　いいい　　Ｃ1 のように修正TBは更新されます。補足のような エラーはでませんが、提示したSQL文を正しく クエリのSQLビューに貼り付けたのでしょうか。 あるいは、実際のテーブルに合わせてSQL文を 書き換えてエラーが出たのでしょうか。 あるいは、質問通りにテーブルは参照TB、修正TB、 フィールドはF1、F2、F6、F7、F8とした上で エラーが出たのでしょうか。
明細データのテーブルのキー列のＡ列は重複ありのインデックス⇒idx1 Ｂ列も重複ありのインデックス⇒idx2 とすると、 A=3 and B=7 の条件を求めるときは、idx1かidx2のどちらかしか使えません。 idx1 を使ってA=3 が1000件、もしくは、idx2を使って、B=7が600件とでてきても A=3 and B=7　の3件を探すには、 1000件なり、600件なりを１件ずつ調べることになるので。 極端にいうとインデックスを両方とも使っていないかもしれません。 （パラレル処理できるＤＢ＆ＨＷの組み合わせなら知りませんが、 　一般的にはどのＤＢでも同じです。） インデックスを使った処理をしようと思えば、Ａ列、Ｂ列を指定した重複ありのインデックスを 作るほうがいいです。 でも、設計の話をすると、一般には、 >マスタデータのテーブルのキー列のＡ列、Ｂ列を主キーとして定義し なら、 明細データのテーブルのキー列のＡ列、Ｂ列、連番を主キーとして定義するように思うのですが。 ## 余計な話に流れてしまいましたが。
テーブルに追加できているなら、 そのテーブルから作成したフォームをリクエリすれば良いのでは？
Windowsの場合WireWallで拒否される場合が有るので、サービスのサービス名MySQL55の実行ファイルのパス名をWireWallに追加して下さい。
都道府県テーブル を変更することが可能なら、 下記のようにするのが一番簡単でしょう。 m_prefecture prefecture_ID　prefecture_name 0　---選択してください--- 1　北海道 2　青森県 3　岩手県 コンボボックス 名前　cb都道府県 値集合ソース SELECT m_prefecture.prefecture_ID, m_prefecture.prefecture_name FROM m_prefecture; 規定値　0 連結列　1 列数　2 列幅　0cm フォームの 更新前処理 で、 Private Sub Form_BeforeUpdate(Cancel As Integer) If Nz(Me.cb都道府県) = 0 Then Cancel = True MsgBox "都道府県を選択してください。" Me.cb都道府県.SetFocus End If End Sub
条件に"カラム=" & "'" & Replace("テキストボックス","'","''") & "'" としてあげれば、' の存在を気にする必要は無くなるのでは？
顧客リストの規模とか使い方によりますね。 ただ、さっぱりわからないなら、そういった方がいいと思います。 相手があなたに十分なコンサル能力というか技術的な能力がある事を期待している以上、相手の意図が分からない場合でも、自分の知識でわからない場合でも分からないので相談することが必要な内容だと思います。 今後毎回ここで質問してもいいですが、その結果困るのはあなたでは無いでしょうか。
そういう意味で書いたのでは無くて、SM-S210iはBluetooth印刷 が可能とありますけど、あなたのは「i」が無いモデルですか？ という意味でした。 でも問題はFM GoがAirPrintしか対応していないという事なのですね。
> クロス集計をしても編集入力はできますか？ 残念ながら、できません。 １）ＡＣＣＥＳＳでクロス集計した結果をＥＸＣＥＬにエクスポートして ２）ＥＸＣＥＬで１ヶ月単位の表形式で入力・編集したものを ３）ＡＣＣＥＳＳにインポートする が良いのかも。
Wikipediaで「ビットマップ画像」「データ圧縮」を引いてみるとか
往復はがきに宛名印刷が課題とすれば ソフトはワードを使い、ツールバーでツールを選び、はがき宛名印刷と進み、はがきの選択のところで、往復はがきを指定して・・・・・・・というコースでやってみたらいかがですか。
sql 文が解らないということですか。 windows ならFireFoxのアドオン版 SQLite Managerをインストールしてみては？GUIで結構操作性よいらしいとありますが。 http://satolab.tiu.ac.jp/js/index.php/lectures/3 … インストールは、最新のFireFox をインストールして、アドオン追加するだけのようですし、 利用は、FireFox　のツールボタンから開いて、 さらに、拡張子 .sqliteのファイルを開くだけで、既に入ってるtableのデータは簡単に一覧できるようです。
wavepad のお試し期間は14日間ですから、インストールしてから 14日が経過したということでしょう。『無料お試し期間』が終わって いますので、購入しない限り、有料の機能 (保存機能) は使用 できません。 wavepad の開発者も『慈善事業』ではなく、そのソフトを売った お金で生活しているわけですから、気に入ったら買ってあげる のがアタリマエです。
Access をやる者にとって、こちらが標準かと思われます。 DJoin 関数 - リスト文字列を取得する方法 http://www.f3.dion.ne.jp/~element/msaccess/AcTip …
大変申し訳ありません。 私の勘違いだったようです。 検証結果、条件に合致しない場合には、EOF BOF ともに True になりました。 迷宮に入っていたのはヘルプを~@;}%した私でした。 orz こちらでは何故か、主キー設定無し・全てのフィールドでインデックス無し にしても機能しました？ >1つ目のメールアイテムに対して・・・ こちらです。
> Set Me!～.Form.Recordset = Me!～.Form.Recordset > > 上記が何かしら悪さをしているということも考えられますでしょうか。 この場合、どちらのサブフォームで Filter、OrderBy の設定をしているのでしょうか。 もう少し、どこにコードを設定して、それぞれのフォームがどのようになるのか詳細を説明ください。 当方、Access2000の環境はないので、Access2003でサンプルを作成して試してみましたが、正常にフィルター、並べ替えができました。ただし、フィルターをかけると、レコードセットが再生成されるため、同期しなくなりますので、再度、代入して同期させる必要があります。 こちらで動作確認したサンプルの詳細 メインフォームの読み込み時 Private Sub Form_Load() 　　Set Me.F_社員詳細.Form.Recordset = Me.社員.Form.Recordset End Sub サブフォーム F_社員 上のコマンドボタンのクリック時 Private Sub コマンド8_Click() 　　Me.Filter = "在籍支社='東京本社'" 　　Me.FilterOn = True 　　Me.OrderBy = "社員コード DESC" 　　Me.OrderByOn = True 　　Set Me.Parent.F_社員詳細.Form.Recordset = Me.Recordset End Sub
>エクセル書き出しとか機能があるようですが、書き出したエクセルファイルは整合性をたもったまま問題なくよみこめるのでしょうか？ ANo1の方も書いておられますが、問題なく読み書きできますけど、 エクセル書き出しした結果を簡単に編集できるかどうかは別の話です。 エクセルの１行が１レコードなので、繰り返し項目とかを含んでいると、 １セルの中に繰り返し100個分がまとめて入ってきて 編集できな～い、ってオチに私のところではなっています。
＞ ソフトはマック 「マック」ってこれ↓のことですか? http://www.apple.com/jp/osx/ もしそうなら、たいていOS X標準の印刷機能を使ってPDFファイルに転換できますので、コンビニに持ち込んでプリントできます。 くわしくは、コンビニの店員にお尋ねください。 http://www.lawson.co.jp/service/counter/copy.html http://www.sej.co.jp/services/print_document.html 参考URL：http://support.apple.com/kb/HT4670?viewlocale=ja …
＃１です 補足です。 提示された条件で重複するものがあったら、おかしくなっていくと思います。
スキーマ(ベンダーによってはデータベースとも呼びますね)が別なテーブルを使った差分ということでいいんですよね？ 例として、サーバAにdb1, db2スキーマが存在する場合は、「スキーマ名.テーブル名.カラム名」で参照することが可能です。 また、サーバAにdb1,サーバBにdb2というように各スキーマが別サーバにあるような場合は、ベンダーごとに変わってきます。 このような場合は各ベンダーのリファレンスを参照して、それにあわせたクエリを書く(または接続方法や接続ユーザの権限を 適切に設定する)ことになります。 また、同一スキーマのテーブルであれば、「テーブル名.カラム名」で参照することが可能です。 どちらの方法でも並び替えであれば、 「order by スキーマ名.テーブル名.カラム名 - スキーマ名.テーブル名.カラム名 asc(またはdesc)」 で並び替えが出来ます。
http://www.sharp.co.jp/support/mebius/tips/tips- … これはWindowsMeですけど、同じ感覚で行けませんかね
> NULLならタブを出したい 対象アプリケーションが不明ですが、仮にAccessであれば 　「Nullの場合のみ指定した値に変換するNz関数」と 　「指定した文字を返すChr関数」 を使用すれば、ご希望の結果が得られると思います。 ただ、「CSV【とか】」とされていますが、CSVであればNullで あっても「,(カンマ)」の数で調整されて、列ずれは起こらない ような・・・CSVを開くプログラムによるのでしょうか?(汗) とりあえず、Nullの場合の読替をTabではなく空文字で 済ませるようなら、Chr関数は不要になります。 【現状例】 Select 顧客マスタ.ID, 顧客マスタ.社名, 顧客マスタ.住所 From 顧客マスタ; 【修正例】 ※社名のNullを変換する場合 <Tabに変換する場合> Select 顧客マスタ.ID, Nz(顧客マスタ.社名, Chr(9)), 顧客マスタ.住所 From 顧客マスタ; ※「Chr(9)」がTabに相当します。 <空文字に変換する場合> Select 顧客マスタ.ID, Nz(顧客マスタ.社名, ""), 顧客マスタ.住所 From 顧客マスタ;
まずは、B-PCのAccessのツール→オプション→詳細タブの 既定の開くモードが共有モードになっているか を確認してください。 なお、既定のレコードロックは、編集済みレコード レコードレベルでロックして開く にチェック もお勧めします。 これでダメならA-PCのアクセス権の設定かもですね。 ちなみに現状の使い方はMDBファイルを壊す危険性が大です。 せめてデータ部分（テーブル）とそれ以外は分けた方が。。 http://office.microsoft.com/ja-jp/access-help/HP …
普通？はグローバルフィールド(G)に表示したい画像を入れておいて オブジェクトフイールド（いつもは空っぽ）の計算式を =Case ( Get ( レコード番号 ) = Get ( 対象レコード数 ); G)　とします。 Get ( 対象レコード数 )にしておかないと検索等で絞り込まれたとき 最終レコードになりませんから・・・・ オブジェクトフィールドを背景色で塗り潰しましょう。
k28484　さん 横から余計な口出しをして申し訳ありませんが、テーブル設計が正しく行われていないように思います。 そのため契約明細と契約基本のデータを結合して取得するだけなのに、とても複雑な結合条件が必要でＳＱＬ文もかなり複雑になってしまっています。 一般的に親テーブルの主キーで子テーブルのデータを検索できなければなりません。その逆もしかり。 親テーブル「契約基本」の主キーは基本ＳＥＱですが、子テーブル「契約明細」にはその基本ＳＥＱが含まれていません。 基本契約年月日と明細契約年月日の近いという条件でテーブルを結合するとデータの不整合が起こります。 例えば２人の契約者が違うが同じ契約明細年月日の場合、基本ＳＥＱの値が大きい契約基本テーブルのデータを探すと、１人の契約者名しか表示されません。 １人の契約者は１つの契約種別のデータを持たないなら、テーブルを親子に分ける必要がありません。 （契約番号を主キーに持つテーブルがあると見受けられます。契約基本テーブルはそのテーブルの子テーブルなのではないでしょうか？） ■１つのテーブルにした例 契約テーブル　　主キー：基本ＳＥＱ 【基本ＳＥＱ】【契約番号】【契約者名】【基本契約年月日】【契約種別】【明細契約年月日】 　1　　　　　　　K0001　　　契約者１Ａ　2013/05/01　　　　S1　　　　　2013/05/05 　2　　　　　　　K0001　　　契約者１Ｂ　2013/05/10　　　　S1　　　　　2013/05/10 　3　　　　　　　K0001　　　契約者１Ｃ　2013/05/20　　　　S2　　　　　2013/05/25 　4　　　　　　　K0002　　　契約者２Ａ　2013/06/10　　　　S2　　　　　2013/06/10 　5　　　　　　　K0002　　　契約者２Ｂ　2013/06/10　　　　S1　　　　　2013/06/15 　6　　　　　　　K0002　　　契約者２Ｃ　2013/06/10　　　　S2　　　　　2013/06/10 　7　　　　　　　K0003　　　契約者３Ａ　2013/07/01　　　　S1　　　　　2013/07/05 　8　　　　　　　K0003　　　契約者３Ｂ　2013/07/10　　　　S2　　　　　2013/07/10 　9　　　　　　　K0003　　　契約者３Ｃ　2013/07/10　　　　S1　　　　　2013/07/10 １人の契約者が複数の契約種別のテータを持つ場合、テーブルは親子に分けます。親テーブルの主キーで子テーブルのデータを検索できるように子テーブルの主キーを決めます。 ■親子にテーブルを分けた例 契約基本テーブル　　主キー：基本契約番号（基本ＳＥＱ） 【基本契約番号】【契約番号】【契約者名】【基本契約年月日】 　1　　　　　　　　K0001　　　契約者１Ａ　2013/05/01 　2　　　　　　　　K0001　　　契約者１Ｂ　2013/05/10 　3　　　　　　　　K0001　　　契約者１Ｃ　2013/05/20 　4　　　　　　　　K0002　　　契約者２Ａ　2013/06/10 　5　　　　　　　　K0002　　　契約者２Ｂ　2013/06/10 　6　　　　　　　　K0002　　　契約者２Ｃ　2013/06/10 　7　　　　　　　　K0003　　　契約者３Ａ　2013/07/01 　8　　　　　　　　K0003　　　契約者３Ｂ　2013/07/10 　9　　　　　　　　K0003　　　契約者３Ｃ　2013/07/10 契約明細テーブル　　主キー：基本契約番号（基本ＳＥＱ）、明細番号 【基本契約番号】【明細番号】【契約種別】【明細契約年月日】 　1　　　　　　　　1　　　　　S1　　　　　2013/05/05 　1　　　　　　　　2　　　　　S2　　　　　2013/05/10 　2　　　　　　　　1　　　　　S1　　　　　2013/05/05 　2　　　　　　　　2　　　　　S2　　　　　2013/05/10 　3　　　　　　　　1　　　　　S1　　　　　2013/05/05 　3　　　　　　　　2　　　　　S2　　　　　2013/05/10 　4　　　　　　　　1　　　　　S1　　　　　2013/06/05 　4　　　　　　　　2　　　　　S2　　　　　2013/06/10 　5　　　　　　　　1　　　　　S1　　　　　2013/06/05 　5　　　　　　　　2　　　　　S2　　　　　2013/06/10 　6　　　　　　　　1　　　　　S1　　　　　2013/06/05 　6　　　　　　　　2　　　　　S2　　　　　2013/06/10 　7　　　　　　　　1　　　　　S1　　　　　2013/07/05 　7　　　　　　　　2　　　　　S2　　　　　2013/07/15 　8　　　　　　　　1　　　　　S1　　　　　2013/07/05 　8　　　　　　　　2　　　　　S2　　　　　2013/07/15 　9　　　　　　　　1　　　　　S1　　　　　2013/07/05 　9　　　　　　　　2　　　　　S2　　　　　2013/07/15
ん～～～～～ Windows を再起動する。 件のアクセスファイルを開く。（他のアプリケーションは開かない） Alt + F11 を押してVBEの画面にし、コンパイルを行う。 （VBEのメニューから、デバッグ→○△のコンパイル） VBEは閉じて、念のためにリボンのデータベースツール→最適化 を行う。 フォームのコマンドボタンを押してみる。 これでもExcelが立ち上がらない・エラーも出ないのなら Set rsFrom = CurrentDb.OpenRecordset("集金明細", dbOpenSnapshot) 'クエリ名は出力したいのに適宜変更 クエリ名（"集金明細"）を指定していますが、 ここを適当なテーブル名にする。集金明細 → 適当なテーブル名 また、 上の行の前に msgbox "ここは" & screen.activecontrol.name と１行追加。 コマンドボタンを押してみる。 「ここは・・・」が出るか。 （・・・の部分がコマンドボタン名（コマンド40 になっているか確認） エクセルが立ち上がるか。 （下？のタスクバーも見てください） でどうでしょ？ 上記の変更二か所（テーブル名・１行追加）を行って コマンドボタンを押して、「ここは・・・」が出る。 ・・・はコマンド40 になっている。 にも関わらず エクセルが立ち上がらない、タスクバーにも現れないのなら 私は降参です。
No.1です。 各プロパティは私も同じでした。 「すべてのフィールドの固定解除」もやったり逆に固定もしてみましたが、 どちらでも、幅は固定できます。 確認なのですが、フォームビュー/レイアウトビュー/デザインビューのうちのレイアウトビューで幅を変更→上書き保存されてますでしょうか？ （該当のフォームのタブを右クリックして選ぶか、アプリケーションのウインドーの右下にある３つの小さいアイコンのうち、真ん中のものをクリック）
リンクテーブルはODBCで接続可能なデータベースであれば設定可能だったと記憶しています(ODBCは分かりますよね…？)。 そのため、ODBCで接続できない状況にある場合は出来ません。 GUIで操作したい、というだけならネイティブ接続が可能なフリーソフトがありますので、 クエリを発行するのが面倒でなければこちらでもいいかと思います。 http://www.hi-ho.ne.jp/tsumiki/ また、他の方が勧めているようにphpMyAdminなどを入れてみるのも手です。 ただしブラウザベースなのでaccessとは使い勝手はもちろん違います。 ちなみに、webサービスのシステムだとは思うのですが、管理画面はないんでしょうか？ 通常管理画面上でデータの追加や修正ができるようにするのが普通だと思いますが、 フロントエンドだけ作ってバックエンドは何もなしだったりすると、それはそれでシステムと見た場合にまずい気はします。 直接クエリを実行して変更することもありますが、経験上それはよほど大規模なデータ修正や構成変更があった場合のみです。
temp = dmax("表記", "T_時間帯", "開始 <= #" & Me.時間帯 & "#") でどうですか？
Accessは勝手にSQLを投げます。これはODBCなどの仕様にもなります。 要するにAccessは一人で使うもの。だからリソースをふんだんに使ってよいという設計になってます。 SQLサーバーに限らずOracleでも複数人で使うDBはPG側で考慮が必要なので、TBをスクロールするなどの処理は避けます。というような基本的な事は後で学んでください。 パフォーマンスを上げる事だけに特化すれば、まずその情報は何を基準に検索するのか。どのキーでビューを作成しているのか。 キー項目ならインデックスは自動で付加されますが、キー項目以外でリレーションを張る場合は、対象の項目にインデックスを張る。さらに検索対象の項目にもインデックスを張ります。 インデックスは多ければ今度は更新時に遅くなります。その辺はDB設計に考慮を組み込んでおきます。 またAccessはテーブルリンクは使わない。TBになるものを全てパススルークエリで作ります。 つまりAというTBをリンクするのではなく、SELECT * FROM Aというクエリをパススルー定義で作り参照するという苦肉の策です。本来は目的の情報だけをAccess側で扱うようにするため、SELECT　XXX,XXX,XXX,XXX from　A Where XXX = 'YYY' とちゃんとそのたびにクエリをパススルーで投げるのが一番です。そのためにはパススルークエリをADOXでそのたびに作成する必要があります。 そこまでやるなら、VBAで全て書き直しEXCUTEした方が早いです。 さらに早くするのはストアドプロシージャをSQL上に作成し、変数を投げて結果だけを取得するなどしてください。
クロス集計クエリの部分だけで良いですか？ クエリの表示結果は添付図の様になります。 テーブル名を ★★ と仮定します。 TRANSFORM First(Day(来店日)) AS 値 SELECT Year(来店日) AS 年, クライアントID FROM (SELECT Q1.クライアントID, Q1.来店日, Count(*) AS CT FROM ★★ AS Q1 INNER JOIN ★★ AS Q2 ON (Q1.クライアントID=Q2.クライアントID) AND (Format(Q1.来店日,'YYYYMM')=Format(Q2.来店日,'YYYYMM')) AND (Q1.来店日>=Q2.来店日) GROUP BY Q1.クライアントID, Q1.来店日) AS T1 GROUP BY Year(来店日), クライアントID, CT PIVOT Month(来店日) & "月"; ※ PIVOT Month(来店日) & "月" のまま 10月以降も表示しようとすると、順が狂います。 その時には、クエリ列見出しを設定してください。 たぶん、以下の様な感じに PIVOT Month(来店日) & "月" IN ("1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月") ※ 処理性能はわかりません ※ 不都合あれば修正してください
簡単なのは 元レイアウトに「検索モード」というボタンを作ってレイアウト切り替え（レイアウト2へ） にしておく。 新規レイアウトでレイアウト2を作り、検索条件入力用のグローバルフィールドを置き その横に「検索実行」ボタンを配置。 検索実行ボタン用のスクリプトを作る。 　・切り取り　グローバルフィルド 　・レイアウト切り替え　元レイアウト 　・検索モードに切り替え　一時停止しない 　・貼り付け　検索するフィールドに 　・検索実行　条件を記憶しない 検索レイアウトに移動する部分を新規ウインドウにしてウインドウサイズ変更などを 加えると、よりそれらしくなります。 検索実行スクリプトは検索しても該当するレコードが無かった場合等のためのエラー 処理も考えて下さい。
普通（かどうかは知りませんが）こういう要件のときは、 部屋ID=A で '2013-03-22 11:00:00' から '2013-03-22 15:00:00' と画面で入力されたとすると、 SELECT count(*) FROM 予約テーブル WHERE 部屋ID=A AND 開始時刻<'2013-03-22 15:00:00' AND 終了時刻>'2013-03-22 11:00:00' の結果が0でなければ重複しているとしてエラーにします。 00:00は含まれないので、データの持ち方は、00分00秒でＯＫです。 なにをやっているかの補足： AND 開始時刻<'2013-03-22 15:00:00' は、開始時刻が入力した終了時刻以降のものは関係ありません。 （今回の予約時間が終わってから始まります。） AND 終了時刻>'2013-03-22 11:00:00' は、終了時刻が入力した開始時刻以前のものは関係ありません。 （今回の予約時間が始まる前に終わってます。） ⇒上記以外とは、今回の予約時間が終わる前に始まり（今回の予約開始前か予約開始後かは問わない） 今回の予約時間が始まる前には終わっていない（今回の予約終了後か予約終了前かは問わない） 予約が既にあるということを調べています。
NOが主キー、CDとDATEはCD1・DATE1から順に設定されていくという前提で、 select COUNT(*), CD1, CD2, CD3 from ( --DATE1、DATE2、DATE3の全てが一致 select T1.CD1, T1.CD2, T1.CD3 from T T1 where exists ( select * from T T2 where T1.NO <> T2.NO and (T1.CD1 = T2.CD1 and T1.DATE1 = T2.DATE1) and (T1.CD2 = T2.CD2 and T1.DATE2 = T2.DATE2) and (T1.CD3 = T2.CD3 and T1.DATE3 = T2.DATE3) ) union all --DATE1、DATE2のみが一致 select T1.CD1, T1.CD2, null from T T1 where exists ( select * from T T2 where T1.No <> T2.NO and (T1.CD1 = T2.CD1 and T1.DATE1 = T2.DATE1) and (T1.CD2 = T2.CD2 and T1.DATE2 = T2.DATE2) and ((T1.CD3 is null and T2.CD3 is null) or ((T1.CD3 = T2.CD3) and ((T1.DATE3 <> T2.DATE3)))) ) union all --DATE1のみしかデータがない select T1.CD1, null, null from T T1 where T1.CD2 is null ) group by CD1, CD2, CD3; とか。 やりたいことを正しく理解できているか分かりませんが。
Accessは手元に無いのでExcelで試しましたが、配列kyoku()に曲のパス、kyokusuに曲数が入ってるとして、 pathWMP = """C:\Program Files (x86)\Windows Media Player\wmplayer.exe""" pathPlayList = "C:\Users\△△\Desktop\test.wpl" Dim kyoku(10) kyokusu = 2 kyoku(1) = "C:\～1.mp4" kyoku(2) = "C:\～2.mp4" Open pathPlayList For Output As #1 Print #1, "<?wpl version=""1.0""?>" Print #1, "<smil>" Print #1, " <head>" Print #1, " <title>～</title>" Print #1, " </head>" Print #1, " <body>" Print #1, " <seq>" For i = 1 To kyokusu Print #1, " <media src=""" & kyoku(i) & """/>" Next i Print #1, " </seq>" Print #1, " </body>" Print #1, "</smil>" Close #1 Shell (pathWMP & pathPlayList) とかで再生できました。 幸いと言うか、自分の環境だと繰り返し実行してもプレイリストのファイル名とかタイトルとかが履歴に残らないみたい？
「オブジェクト・・・・・が見つかりませんでした」 "・・・・・" が最大のヒントだと思うのですが、、、 そんでその mdb を開いたときに期待する本来の動作はどうなのか、と。 どこかに置いてあるテキストファイルとかを自動的にインポートするようにしてあるとか、何か外部との連携を取ろうと設定してあるとかね。 その外部に置いてある何かへのパスが今回の PC から見つからない場所になってしまっているとか。
SELECT フィールド１,フィールド２,max(フィールド３) from hoge group by フィールド１,フィールド２ って感じでどうでしょう。
そのフォームは単票でしょうか。 帳票なら以下の方法ではできません（コントロールを重ねないと不可能だと思います。） 現状のフォームをコピーし、コピーした方で動作確認してみます。 レコードが更新されても良いようにバックアップは取っておきます。 コピーした方のフォームに記述してあるイベント関係のものをすべて削除し、 以下の記述と置き換えてみます。 Private Function EnterCheck() 　　Dim vN As Variant 　　Dim i As Long, j As Long 　　vN = Array("大分類", "中分類", "小分類") 　　For i = LBound(vN) To UBound(vN) 　　　　If (Me.ActiveControl Is Me(vN(i))) Then 　　　　　　For j = LBound(vN) To i - 1 　　　　　　　　If (IsNull(Me(vN(j)))) Then 　　　　　　　　　　Me(vN(j)).SetFocus 　　　　　　　　　　Exit Function 　　　　　　　　End If 　　　　　　Next 　　　　　　Exit For 　　　　End If 　　Next 　　With Me.ActiveControl 　　　　.Requery 　　　　.Dropdown 　　End With End Function Private Function UpdateCheck() 　　Dim vN As Variant 　　Dim i As Long, j As Long 　　vN = Array("大分類", "中分類", "小分類") 　　For i = LBound(vN) To UBound(vN) 　　　　If (Me.ActiveControl Is Me(vN(i))) Then 　　　　　　For j = i + 1 To UBound(vN) 　　　　　　　　Me(vN(j)) = Null 　　　　　　Next 　　　　　　If (i <> UBound(vN)) Then 　　　　　　　　Me(vN(i + 1)).SetFocus 　　　　　　　　Exit Function 　　　　　　End If 　　　　　　Exit For 　　　　End If 　　Next End Function Private Sub Form_Load() 　　Dim vN As Variant 　　Dim i As Long 　　vN = Array("大分類", "中分類", "小分類") 　　For i = LBound(vN) To UBound(vN) 　　　　With Me(vN(i)) 　　　　　　.ValidationRule = "Is Not Null" 　　　　　　.OnEnter = "=EnterCheck()" 　　　　　　.AfterUpdate = "=UpdateCheck()" 　　　　End With 　　Next End Sub Private Sub Form_BeforeUpdate(Cancel As Integer) 　　If (IsNull(Me.小分類)) Then Cancel = True End Sub ※※ 操作は、必ず　"大分類" → "中分類" → "小分類"　の順であるとします。 ※ Enter 時の動き どのコンボボックスの Enter でも同じ処理を走ります。 まず、Enter になったのは「誰」を求めます。 求まったら、前操作のコンボボックスが入力されているか確認します。 値が設定されていなければ、そのコンボボックスにフォーカスを移動します。 値が設定されていれば、 Requery 後 Dropdown 表示します。 ※ AfterUpdate 時の動き どのコンボボックスの AfterUpdate でも同じ処理を走ります。 まず、AfterUpdate になったのは「誰」を求めます。 求まったら、後操作のコンボボックス値を Null に変更します。 次のコンボボックスにフォーカスを移動します。 ※ フォームのオープン時 各コンボボックスに上記関数を実行する様、イベントに設定していきます。 また、入力規則に念のため Is Not Null を設定しておきます。 既に値が設定されていて、Delキー 等で削除された場合エラーとなるように・・・ ※ フォームの更新前処理 コンボボックスは、必ず　"大分類" → "中分類" → "小分類"　の順と決めたので、 最後の Me.小分類 が Null なら Cancel = True として、更新を拒否します。 ※ コンボボックス３つの処理をまとめましたが、個別に記述しても良いと思います。 ※※ 検証等は十分に行ってください。また、不具合等あれば修正してください。
つうか、エクセルをデータベースみたいに使うほうがよっぽどつかえない。 エクセルの表でVlookup関数が使いたくなったら、私は迷わずアクセスにする。 エクセルで何とかできる程度のことなら、そんなに構えなくても、気軽にアクセスが使えるよ。 #1さんのご意見にことさら意を唱えるつもりはないけど、でも、ちょっと大げさじゃないかなぁ。 まずはクエリをつかえるようになればいいと思うな。 クエリこそがデータベースのかなめだからね。 とはいえ、みんなが使いたくないものを無理やりに使わせるわけにはいかない。 みんな新しいことを覚えたくないんだよ。 察するところ、エクセルおじさんばっかがいる職場じゃない？ワードを使う場面でも、パワーポイントを使う場面でもみんなエクセルで押し通す人のことを言っているんだけど。 余談だけど、そういう人がエクセルのことよく知っているかというとそうじゃなくて、ピポットテーブルとかいうと、？？？？？？ だったりするんだね。 そうそう、いきなりアクセスに飛ばずに、ピボットテーブルを作ってみるのも手だよ。 そういう性質の表なら、だけど。 あとは、いつまでもエクセルにしがみついている人は、そのままにしておいてあげて、あなただけアクセスに移行することもできるかもしれない。 エクセルのシートをアクセスから呼び出すことができるから(アクセスにリンク貼り付けする)、データはエクセルに入れたままにして、データの処理はアクセスでするんです。 もっともシートが、きちんとデータベースで処理できる形式になってなければいけないですけどね。
Outlook は使ったことがないので予想ですが、、、 Outlook のセキュリティ レベルが高すぎるとか、ユーザーに代わって外部プログラムからメールを送信することを許可しない設定になっているとか。
> WEB上で検索すると、select実行時にもロックを取得し 「ＤＢ２　SQL for update」でググると先頭に出ました。 ここのことだったらごめんなさい。 参考URL：http://www.atmarkit.co.jp/fdb/rensai/rdbmsarc04/ …
商品番号&"_"&色 などという計算フィールドを作って、これでソートするとGetSummary も使えます。 別テーブル（重複の無い商品マスタのような）からリレーションで集計した方がいいかも。
Bツリーは索引(INDEX)によく使われるデータ構造ですね。 索引を使うことのメリットは#1, 2さんが書かれている通りです。 索引によく使われるデータ構造は他に、ハッシュテーブルやビットマップ・インデックスなどが有りますが、それらに対してBツリーは汎用性の高さがとりえと言えるでしょう。弱点が少なく、多くの用途に適していて、ほとんどの探索・更新操作に対してそこそこの性能が期待できます。 下記のページが参考になるかと思います。 http://gihyo.jp/dev/serial/01/sql_academy2/000701
欠落するデータに規則性はあるんですか？ キーの重複とかは？
文字コードの何を知りたいのでしょうか？ 文字コードについての全般的なことを知りたいのだったら、下記のページが参考になるかと。 http://ja.wikipedia.org/wiki/%E6%96%87%E5%AD%97% … http://itpro.nikkeibp.co.jp/article/COLUMN/20061 … http://euc.jp/i18n/charcode.ja.html
syscmd(acSysCmdRuntime) で取得できますよ。
変てこな考えかも（処理性能は考えてませんので・・・） 除外する・・・これは結構厄介なものと思います。 タイムスライスして、ある・ない・・・で結果を得ても良いのかも フィールド「時刻」（日付/時刻型：主キー）のみのテーブル「T時刻」を作り、 0:00 ～ 23:59 までのデータを入れておきます。（60 * 24 = 1440 レコード） この「T時刻」を基準に、対象者の予定日と開始時間、終了時間を結び付けて、 その結果、結びついていない時刻をグルグルとみて、空きの開始、終了を処理すれば・・・ 元テーブル名を★★と仮定すると SELECT Q1.時刻 FROM T時刻 AS Q1 LEFT JOIN (SELECT * FROM ★★ WHERE 予定日=#2013/3/1# AND 氏名='AAA') AS Q2 ON (Q1.時刻 Between Q2.開始時間 AND Q2.終了時間) WHERE (Q2.氏名 Is Null) AND ((Q1.時刻 Between #8:40# AND #12:00#) OR (Q1.時刻 Between #13:00# AND #18:00#)); の様な感じで・・・・ 得られる結果は、10:01 ～ 12:00 の 120レコードと 14:01 ～ 18:00 の240レコード 全体で 360レコードになるので、360分空いている事がわかります。 ただ、注意しないといけないのは、時刻の境目・・・・ 例えば、上記の空きで 15:00 ～ 15:30 を予定に入れたら、 14:01 ～ 14:59、15:31 ～ 18:00 に分かれます。 ということは、レコード数＝分　ではなくなる？ そこで、開始と終了の時刻が重ならないように、終了の方を１分前にします。 SELECT Q1.時刻 FROM T時刻 AS Q1 LEFT JOIN (SELECT * FROM ★★ WHERE 予定日=#2013/3/1# AND 氏名='AAA') AS Q2 ON (Q1.時刻 Between Q2.開始時間 AND DateAdd("n",-1,Q2.終了時間)) WHERE (Q2.氏名 Is Null) AND ((Q1.時刻 Between #8:40# AND #11:59#) OR (Q1.時刻 Between #13:00# AND #17:59#)); これで得られる結果は、10:00 ～ 11:59 の 120レコードと 14:00 ～ 17:59 の240レコード 上記の空きで 15:00 ～ 15:30 を予定に入れたら、 14:00 ～ 14:59、15:30 ～ 17:59 に分かれます。 （レコード数＝分　でしょうか） (Q1.時刻 Between #8:40# AND #11:59#) は、 (Q1.時刻 >= #8:40# AND Q1.時刻 < #12:00#)　の方が考えやすい/指定しやすいかも・・・ 上記を指定して Recordset を得て、グルグル回して、時刻差が 1 分でなかったら 開始の時刻はそのまま・・・ 終了の方は1分加算・・・・ で、求まっていくと思います。 空きの時間帯が複数あっても、グルグル回る時の処理を考えれば良いと思います。 また、どんな時間帯で登録されていようが、求まったものを処理するだけです。 ※ 上記では 1分間隔で「T時刻」内を作成していましたが、入力が 10分単位とかなら、 登録しておく「時刻」も 10分間隔で良いと思います。 グルグル回る時には、時刻差が 10分でなかったら・・・・とか ※ 上記記述をクエリとして作成した場合 保存・閉じた後、再度SQLビューで覗くと ON (Q1.時刻 Between Q2.開始時間 AND DateAdd("n",-1,Q2.終了時間)) 部分は ON Q1.時刻 Between Q2.開始時間 AND DateAdd("n",-1,Q2.終了時間) の様に ( ) が外れます。 編集等しなければ何も影響ありませんが、編集した後保存しようとするとエラーになります。 その時には、消えた ( ) を付け直してください。 （何故なのか・・・・わかりません） ※ 冒頭でも記述しましたが、処理性能は考えてませんので・・・
> Me.Recordset.FindFirst "[社員番号]=" & Num 検索するのは親フォームではなくサブフォームですから 　Me.SF1.Form.Recordset.FindFirst "[社員番号]=" & Num だと思います。（未検証、まちがっていたら御免。）
次回からは、Accessのバージョンは明記するようにしましょう！ 操作方法が異なる場合があります。 2003以前なら参考にされたサイトのように 『並べ替え/グループ化』の設定で フィールド/式　　　　　　　　　　　　　　並べ替え順序 グループ化したいフィールド名　　　　　　　　昇順 NO.　　　　　　　　　　　　　　　　　　　　昇順 と[NO.]を追加すればできます。 >NO. というフィールド名は変更することを強くお勧めします。 http://support.microsoft.com/kb/286335/ja トラブルの元になりかねません。
Excel2007以降だとして。 （Excel2003までだと重複の削除ができないので別の方法にする必要あり） sheet1シート Ａ列：あるコード Ｂ列：紐付きコード Ｃ列以下はない sheet2シート 作業用にＡ列、Ｂ列およびＤ列を利用します。 とすると、 1.Ｂ列を、1111でフィルタする。 2.フィルタしたあとで、Ａ列をコピーして、sheet2のＤ列に貼り付ける。 （Ｂ列が1111のＡ列のみが貼り付けられるはず。） 3.Ｂ列のフィルタを解除。 4.Ａ列をコピーsheet2のＡ列に貼り付ける。 5.sheet2のＡ列を指定して、重複の削除を実行する。 6.sheet2のＢ１セルに =vlookup(A1,D:D,1,0)と入力する。 7.sheet2のＢ１セルをコピーして、Ｂxx（xxはＡ列の最終行）まで貼り付ける。 Ｂ列に#N/AとでてきたＡ列の値が1111がないもの。 ※以下は応用って感じ。 式を = if(isna(vlookup(A1,D:D,1,0))=true,"○","") とかにすると、○が出てきた行が対象。 Ａ列とＢ列をコピーして、sheet3のＡ：Ｂ列へ貼り付けしてＢ列でフィルタすると、 対象のみになります。など。。。 とりあえず、EXCELの操作のみでできる方法を記載してみました。 ## 使えるレベルが分らないので「フィルタ」って何？とか「重複の削除」ってどうすんの？とか ## ありましたらお礼なり補足なりに記載してください。
何かメッセージが出てきていませんかねー。 それとも、拡張子が、ACCDBやMDBになっているAccessファイルを ダブルクリックしても、だんまりで何も起きないのでしょうか。 Accessのバージョンによって設定方法が異なりますが オプション設定の 『既定の開くモード』を共有モードに 『既定のレコードロック』を編集済みレコードに それぞれ設定してあるか、まず確認を。 後半の質問は難しいです。とても書ききれない量があります。 なので、同じ難しいなら一足飛びに、無料のRDBMS 例えば、SQL SERVER Express Edition、MySQL ・・・にでも した方が良いのでは？という意見の方も多いです。 ユーザーに使用方法を強制することなく、 安全・確実に運用出来るように作りこむのは大変だと思います。 取りあえずは下記を読んでみてください。 http://support.microsoft.com/kb/882219/ja http://hpcgi1.nifty.com/MADIA/VBBBS2/wwwlng.cgi? …
多分最初に曲を保存した場所をどこかに移したのですね。それでＸアプリが曲データを認識できないんだと思います。 まずは、元の曲をどこに保存しているのか探してください。 それが終えたら次のステップを教えます。
新規ユーザーを作って試してみました。 Access（Office）を一回も開いていない状態 HKEY_CURRENT_USER\Software\Microsoft 下にVBA というキーは無し Access を立ち上げてテーブルを一個だけ作成 HKEY_CURRENT_USER\Software\Microsoft\VBA\7.0\Common まで出来て中味は↓だけ 名前 種類データ （既定）REZ_SZ （値の設定なし） Access閉じても変化なし Access立ち上げて標準モジュールに MsgBox "" だけのSub Module作成 実行しても変化なし Access終了後 （既定）、CtlsShowSelected、Dock、DsnShowSelected、FolderView、MainWindow MdiMaximized、OGGroupMembers、PropertiesWindow、Tool、UIAccess に増える。 （多分、モジュールの保存時に出来るものと思われるが確認漏れ） Access立ち上げてVBEのツール→オプションで、『自動構文チェック』のチェックだけ 外す。直後に （既定）、「AlignToGrid」、「AutoQuickTips2」、「AutoStatement2」、「AutoValueTips2」、 「BackGroundCompile」、「BackgroundProjectLoad」、「CollapseWindows」、「CompileOnDemand」、 CtlsShowSelected、Dock、「DragDropInEditor」、DsnShowSelected、「EndProcLine」、 FolderView、「GridHeight」、「GridWidth」、MainWindow、MdiMaximized、OGGroupMembers、 PropertiesWindow、「SaveBeforeRun」、「ShowGrid」、「ShowToolTips」、 「SyntaxChecking」、Tool、UIAccess、「UpgradeVBX」 に増える。（「」内は増えた分） Accessを再起動しても名前をその数には変化なし。 なお、本番環境だともう少し設定を変えてあるので３６個ありました。 （既定）、AutoValueTips2、AutoQuickTips2、AutoStatement2、DragDropInEditor RequireDeclaration、EndProcLine、CompileOnDemand、BackGroundCompile FontHeight、FontCharSet、FontFace、GridWidth GridHeight、ShowGrid、AlignToGrid、SaveBeforeRun ShowToolTips、CollapseWindows、UpgradeVBX、BackgroundProjectLoad PropertiesWindow、MainWindow、MdiMaximized、Dock FolderView、Tool、CtlsShowSelected、DsnShowSelected UIAccess、OBGroupMembers、UI、SyntaxChecking CodeForeColors、CodeBackColors、OBSearchHeight 数の多寡は関係ないような気がします。。。 （根拠はまったくありません） 何もしないのに数がちょこまかと増減したらマズイとは思いますけど。 それにしても解せない。 同一PC内でアカウントによって変わるなんて？ もしかして、アカウント名に日本語（全角文字）使ってるとか。 ミスリードが怖いので、少し回答を控えます。 明日は我が身かもしれないので、進展（解決）ありましたら教えてください。 最後に残念な苦言です。 困っていらっしゃるのは良く分かるのですが、 マルチポストは如何なものかと。 せめて、ここと、あそこと、あっちに同じ質問を立てています、 のようにしてください。 ↓をご一読ください！ http://stakasaki.at.webry.info/200512/article_3. …
#4 さんの回答にある国際規格「Database Language -SQL- Part 2: Foundation (SQL/Foundation)」は、和訳がJISデータベースにあります（ただし1999年版ではなく2008年版の和訳）。 http://www.jisc.go.jp/app/JPS/JPSO0020.html JISX3005-2 で検索すると出てきます。 「データベース言語ＳＱＬ－第２部：基本機能（ＳＱＬ／Ｆｏｕｎｄａｔｉｏｎ）」
はじめまして、このようなサイトがあります。言語選択で日本語を選択できます。フリー・ダウンロードです。 http://www.maxmind.com/en/worldcities
並べ替えはクエリでやれば出来ると思います。二つのテーブルから必要な項目だけクエリに取り込んで、並べ替えを指定すれば出来ると思います。
そのテーブルに、『非表示』というフィールドを加えます。 データ型は、Yes/No 書式は、True/False 『ルックアップ』タブに切り替えて、表示コントロールを「チェックボックス」に。 テーブルでは 非表示にしたい企業だけチェックを入れます。 クエリを一個作成して、非表示フィールドの抽出条件に、False とすれば？
以上と言いつつ、 最初の質問の Me.Refresh を見逃していました。 Me でフォーム全体のRefreshを行うのではなく 個々のコントロールのRefresh、Recalc、Requeryを行えませんかね？ Me!コントロール名.Re… ただ、Me.Refresh を外しても若干の改善となると。。。 実際にファイルを見られればもう少し何とかなるかも？ですが やり取りはこのサイトではご法度なのでゴメン。
Access Excel ともに2010で試しました。 パスワード・・のエラー発生。 ググリまくると http://www.access-programmers.co.uk/forums/showt … Franz Haidacher さんによれば Access2010 から採用された既定の暗号化方法（高度なセキュリティ）は ADO OLEDB では接続できないようです。 Accessのオプションのクライアントの設定から 以前の暗号化方法を使用するに変更したうえでパスワードを設定するしか 現在のところ方法がなさそうです。 (-"-) DAOなら・・・と試しましたが同じく orz
列Ｊが１０列目、列Ｋは１１列目。 ＶＢＡ中に"１０"はあるが、"１１"が見当たらない。 もう一度、やりたいことを整理して。
Access-VBAでは、普通のアプリで動いているような処理の ほとんどがプログラミングすることで動作可能です。 Accessは、ご質問のように「プログラマが別に居て、業務を 行う人はプログラムを知らない」という状況で、システムを 動かすことを前提にアプリ全体が設計されていますので。 具体的にお話の処理は、フォームで条件を決めてクエリを 走らせ、結果をフォームに転送して表示するという処理に なりますが・・・。 ただ、じゃあどうやってその「プログラム」を書くか、というと 相当にプログラミングに対する事前の知識が必要です。 例えば、この手の内容がスラスラ理解できるか・・・という 話です。了解できればほとんど万能なんですがね。 http://office.microsoft.com/ja-jp/access-help/HA … 実際、お話程度の処理なら、Excel-VBAでも十分可能です。 Excel-VBAは「手作業でやる動作を自動的にVBAのコードに してくれる」機能があるので、Accessよりとっつき易いですし、 Aceess-VBA同様に、フォームへの入出力も簡単に出来ます から・・・。 http://excelvba.pc-users.net/
クエリを使い、抽出条件のところで東京都を指定すればよろしいです。クエリのキーワードで調べてください。
>データが操作禁止になっていたので これ、どういうことですか。
phpはデータベースではありません、プログラミングの言語の1つです。 あなたの今の状況では、あなたがやりたいこと、 「データベースに登録したデータをWEB経由で検索、閲覧する」までは遠い道のりです。 まずは、フリーのWIKIサービスなどを使ってサイトを作ってみてはどうでしょう？ http://atwiki.jp/ http://wiki.fc2.com/ --------------- 名前：ガーゴイル レア：コモン 属性：飛行,悪魔 説明：・・・・・ --------------- 上記のようにカードのページを作れば、 名前やレア度や属性で検索できますよ(上記は適当なデータです)。 その上で、やっぱりちゃんとデータベースを作りたいと思ったら勉強してみてください。 インターネットの仕組み、WEBアプリの仕組み、データベースの仕組み、プログラミング、、 遠い道のりかもしれませんが、決して不可能ではないです。がんばってください。
OSは？ Win7あたりであれば「windows」キー＋Fで更新日を指定して検索とかできます
自宅にとか自宅でを聞いたのではないです。 パソコンとiPadを両方とも自宅に持ち帰ってという意味ですか。 でしたらwi-fi関連の問題になるでしょう。
＃１です > 通常状態で触れさせないようにする良い方法はないでしょうか？ VBA は大丈夫だったでしょうか。 考え方をちょっと変えてみます。 テキストボックス「テキスト0」をいじらせたくないので、Enabled / Locked で制御している。 ↓ テキストボックス「テキスト0」の Enter で異なるコントロールに Focus を移動する。 例えば、テキストボックス「テキスト0」の フォーカス取得時に以下を記述しておきます。 Private Sub テキスト0_Enter() 　　Me.テキスト1.SetFocus End Sub この場合、「テキスト0」にフォーカスが入ろうとした場合、「テキスト1」に無条件で移動させます。 意味合い的に、「テキスト0」にはフォーカスが入らないので修正等できません。 では、テキスト0.Text にどうやって値を設定し、イベントを発生させるかですが・・・・ 一旦、「テキスト0」の フォーカス取得時を無効にしてから設定して、終わったら戻します。 Dim ctl As Control Dim sS As String Set ctl = Me.ActiveControl sS = Me.テキスト0.OnEnter Me.テキスト0.OnEnter = "" Me.テキスト0.SetFocus Me.テキスト0.Text = "こんにちは" ctl.Setfocus Me.テキスト0.OnEnter = sS 今の アクティブコントロールを覚えておいて、 フォーカス取得時を無効にして、 "こんにちは"　を設定して フォーカスを元のところに戻して、 フォーカス取得時を有効にして・・・・ お礼にあった記述と変わらないですかね・・・・（上記コードは未検証） また、違う方法と言えば、手間でも自分で呼び出す・・・・ 設定後、「テキスト0」の更新後処理を動かしたい場合、 Me.テキスト0.Value = "こんにちは" Call テキスト0_AfterUpdate とすれば、同じことになると思います。 ※ フォーカスがあるうちに、Enabled = False はエラーになったような・・・・ ※ ご質問の内容をもう一度読み直してみました。 > テキストボックスの値を変更する段階で別のコードを入力すれば対応は可能なのですが、「テキストボックスの値を変更した時」のタイミングで別コードを動作させることで、コードをまとめたいと考えています。 という事ですが、アクセスで用意されているイベント（フォームに関して）は、操作する人がいること・・・ が、主だと思います。 VBA とかで値を設定する・・・・操作の範疇じゃないので自分で面倒をみることになると思います。 上記での SetFocus しないとイベントが発生しない・・・・操作していればあたり前のことなので・・・ Enabled = False / Locked = True にした状態のものの、変更イベントを取りたい・・・ 私にはチョッと理解できない部分になります。 ※ 他の方の回答を待ってください ※ 解釈違い等あれば、ごめんなさい。
テーマに連動しているようなのでできないです。
> Me![性] = Rs![性] 「指定された患者番号でレコードを取得して、内容を表示」はわかるけど テーブル構造もFormの項目も提示が無いので推測。 きっとどちらか、あるいは両方が定義されていない。 ホントに「性」ですか？姓名の「姓」が正解じゃないですか？ この手のものなら「性別」と定義していそうに思います。
そのまま作れますよ。 問題ごとの値一覧を作って、チェックボックスでは無くラジオボタン にします。 合計はSum(回答1;回答2;回答3・・・・)です。 回答フィールドは数字フィールドにしたほうがいいのかと思いました が、テキストフィールドでも数字部分だけ合計してくれますね。 何m歩けますかの問題の回答が 5点　5m 4点　4m ではダメですが。
V列の一番上の「V1」セルに以下の式を入力 =IF(ROW()=1,S1&"\"&T1,IF(OFFSET(S1,-1,0)=S1,OFFSET(V1,-1,0)&"\"&T1,S1&"\"&T1)) 入力したらV1セルを下方向の「V2」～「V10」にコピーする
select t4.name as t4_name, sum(t5.profit * coalesce(t2.rate, avg(case when date(t5.date, 'start of month') = date(t2.date, 'start of month') then t2.rate else null end), avg(case when date(t5.date, 'start of year') = date(t2.date, 'start of year') then t2.rate else null end), avg(t2.rate)) as sum from t5 inner join t4 on (t5.t4_key = t4.key) inner outer join t3 on (t5.t3_key = t3.key) left outer join t2 on (t3.t1_key = t2.t1_key2 and date(t5.date) = date(t2.date)) where t2.t1_key1 = 't1_key1' and date(t5.date, 'start of month') = '2012-01-01' group by t4.key, t4.name order by sum desc 環境がないのでテストしていませんが、上記のような感じになるとかとおもいます。 （あまり自信はないですが） あと、何でわかりにくく説明しているの？（T1 とか T2 key とか date とか） 具体的に説明してもらったほうが質問を理解しやすいです。（質問を理解するのに無駄に時間がかかりましたので・・・）
GoもiPhone、iPadも持ってませんが、Pro12のホストDBにアクセスして 使用する場合はPro12のオブジェクトフィールド内の画像を外部保存して あればいいはず。 DBをGoに転送している場合は、Pro12のオブジェクトフィールドに画像 を埋め込んでから転送しないと見えないはず。（各デバイスに画像の実体 が必要という意味で）
クエリーの機能を使って簡単に出来ます。 クエリーの抽出条件のところで、一つの条件を書き込み、その下の「または」のところに次の条件をそしてその下に３番目の条件を書き込めばよろしいです。
親と子の連動する部分は、宛名の会社の人と「同じ会社」の「ランク１のリスト」という点だと思います。 親には、印刷するしないに関わらず会社ＩＤを配置します。（会社ＩＤを印刷したくない場合には、プロパティの「可視」を いいえにします） サビレポートのプロパティ「データ」タブで「親フィールド」を「会社ＩＤ」「子フィールド」も「会社ＩＤ」にします。 サブレポートのデータソースは、クエリーで「社内ランク１」に絞り込んだ「氏名」および「会社ＩＤ」とします。 前述と同様手順でサブレポートの「会社ＩＤ」も非表示扱いにします。
＃４です ＃４の補足にあった > T_コーチマスタ(テーブルＡ) > ランク　ヒット数　 コーチ名 　担当者MAX > ---------------------------------------- > 　A　　　10　　　　　佐藤　　　　3 > 　A　　　 3　　　　 　鈴木　　　　3 は構成がおかしい(?)ので、上記「ヒット数」は考えないことにします。 ＃２でのVBAで 　　While (Not rsB.EOF) 　　　　If (sS <> rsB("ランク")) Then　' ★ 　　　　　　sS = rsB("ランク")　' ★ 　　　　　　rsA.Filter = "ランク='" & sS & "'"　' ★ 　　　　　　i = 1　' ★ 　　　　End If　' ★ 　　　　rsB("人数(連番)") = i 　　　　rsB("コーチ名") = rsA("コーチ名") 　　　　rsB.Update 　　　　i = i + 1　' ★☆★ 　　　　If (i > rsA("担当数MAX")) Then　' ★☆★ 　　　　　　rsA.MoveNext　' ★☆★ 　　　　　　i = 1　' ★☆★ 　　　　End If　' ★☆★ 　　　　rsB.MoveNext 　　Wend ★：選手側「ランク」が変わったか判別して、 　変わっていたら、その「ランク」のコーチを求め直して・・・ 　連番を 1 に ★☆★：連番をカウントアップして、 　そのコーチの「担当数MAX」を超えたら次のコーチにして、連番を 1 に なので > (最後の3までふられない理由は？) 確認された時の「担当数MAX」が 2 だったのでは・・・と思います。 （ 3 を 2 にする処理は入っていないので） ※ 以前は「担当数MAX」でしたが、＃４補足では「担当者MAX」になってますね テーブルは新しく作って変えたけど、VBAで参照しているテーブルは前のまま・・・とか？ この処理での大前提は、選手側のデータは「ランク」で並んでいる必要があります。 「ランク」で並んでいるのなら、そのランク内の並びは？？？ それを指定してあげればよいです。（それが＃３の冒頭に記述したものになります） 割り当てしたい順に並んでいる・・・・並んだ後は「ヒット数」等、確認はしません。 （なお、この前提以前に、１選手１データであること・・・・があります） コーチの方も、コーチの並び順を指定しておけば、その順は Filter 後も維持されるようです。 回答になっていたでしょうか？
基本的な流れは、ユーザー関数を作成して・・になります。 例えば 標準モジュールに Function delStr(delOrg As String, delList As String) As String Dim delAry As Variant Dim i As Integer delAry = Split(delList, " ") delStr = delOrg For i = LBound(delAry) To UBound(delAry) delStr = Replace(delStr, delAry(i), "") Next End Function とします。 左のフィールドのフィールド名が、F1 として下記が入ってると仮定 ブリキ看板 テキサコ ダルメシアン TEXACO ブリキカンバン ぶりき看板 ティンサイン サインボード インテリア TINサイン アメリカン雑貨 同様に右のフィールドのフィールド名が、F2 として下記が入ってると仮定 ブリキ看板 ブリキカンバン アメリカン雑貨 クエリのデザイングリッドに F1｜F2｜F3:delstr(F1,F2) とすればF3フィールドに結果が表示されます。 ただ、上の関数はあくまでも基本形ですので以下のような事が不明ですので 期待した結果が出ないと思います。エラー処理も入れてません。 １・ >ブリキ看板 テキサコ 文字と文字の区切りが半角スペースになっているが 全角スペースが紛れ込んでいないか ２・半角スペースが２個以上になっているのがないか ３・>TEXACO<=>texaco 大文字・小文字は同一視するのか ４・TEXACO<=>ＴＥＸＡＣＯ 半角・全角の場合は パッと思いつだけでも色々あります。
テーブル名を、T1 とした場合には SQL文では SELECT ID, 氏名, 科目, 点数 FROM T1 WHERE (科目 = '国語' AND 点数<=59) OR (科目 = '数学' AND 点数 <= 49) です。 クエリのデザインビューに切り替えても確認できます。 なお、フィールド名の 『No.』は適切ではないので 『ID』に変更しています。 http://office.microsoft.com/ja-jp/access-help/HA …
WindiwsのコマンドプロンプトはShiftJisだったと思いますが、SQLiteはUTF-8,16だったと思います。 インプットにGUIツール(PupSQLiteなど)を使ってはいかがでしょうか？
解決されていない認識で良かったでしょうか、 piroin654 さんと変わり映えしませんが回答してみます。 元々のテーブル名を「TC」と仮定します。 以下を標準モジュールに記述しておきます。 Public Function TCLCM(vCode As Variant) As Long 　　Dim rs As New ADODB.Recordset 　　Dim iNum As Long, i As Long, j As Long, iTmp As Long 　　iNum = 0 　　rs.Source = "SELECT 数値 FROM TC WHERE 項目='" & vCode & "';" 　　rs.Open , CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly 　　Do While (Not rs.EOF) 　　　　If (IsNull(rs(0))) Then 　　　　　　iNum = 0 　　　　　　Exit Do 　　　　ElseIf (rs(0) < 1) Then 　　　　　　iNum = 0 　　　　　　Exit Do 　　　　End If 　　　　i = rs(0) 　　　　If (iNum = 0) Then 　　　　　　iNum = i 　　　　Else 　　　　　　j = iNum 　　　　　　While (i) 　　　　　　　　iTmp = j Mod i 　　　　　　　　j = i 　　　　　　　　i = iTmp 　　　　　　Wend 　　　　　　iNum = iNum * rs(0) \ j 　　　　End If 　　　　rs.MoveNext 　　Loop 　　rs.Close 　　TCLCM = iNum End Function クエリは何種類かあって、表示上だけであれば 1) 更新/追加（項目・数値）したい場合 SELECT 項目, 数値, TCLCM(項目) AS 最小公倍数 FROM TC; 2) 単に表示すれば良い場合 SELECT Q1.項目, Q1.数値, Q2.最小公倍数 FROM TC AS Q1 INNER JOIN (SELECT 項目, TCLCM(項目) AS 最小公倍数 FROM TC GROUP BY 項目) AS Q2 ON Q1.項目 = Q2.項目; 2) の方が作った関数を呼ぶ回数が少ないので速いかも・・・・ テーブル「TC」のフィールド「最小公倍数」に値を設定する場合 UPDATE TC SET 最小公倍数 = TCLCM(項目); ※ 「キー項目」という項目名は、面倒だったので「項目」にしていました。 ※ 処理性能はわかりません。参考にする/しない等々自己責任にてお願いします。
H2を良く知らないのですが、一般的には、group byとRownum()とを一緒に使うと うまくいかないのではなかったかと。 SELECT ROWNUM ( ) AS ID,ADDRESS,COUNT(*) AS 出身人数 FROM SAMPLE GROUP BY ADDRESS ではなく、 SELECT ROWNUM ( ) AS ID,ADDRESS,出身人数 from ( select ADDRESS,COUNT(*) AS 出身人数 FROM SAMPLE GROUP BY ADDRESS ) とするとうまくいくのでは？ ANO.1の方が示しておられるURLの The first row has the row number 1, and is calculated before ordering and grouping the result set・・・ To get the row number after ordering and grouping, use a subquery. というのが、 「group byの前に連番振りますよ、但し・・・。 サブクエリを使うと、group byの後に連番を振りますよ。」（適当な意訳ですけど） つまり上記の意味です。
設定でフルスクリーンにする 　描画距離を普通にする だいたいの設定をOFFにしてみてはいかがですか？ あるいは軽量化MODいれてみたらいいかもしれません　　　URL→http://www26.atwiki.jp/minecraft/pages/295.html 情報すくなくてすみません　　　　　　　　　　　　　　　　　　　　　
>そこで、Slim3を使うことで、あいまい検索などRDBの様にBigTableを扱える様になる。 いえ、Slim3は、GAEで「MVCアーキテクチャー」によるWebアプリケーション開発を行うためのものです。データベースのためのものというわけではありません。（データベースアクセスを簡略化する機能も含まれていますが）そもそもSlim3導入で、あいまい検索ができるようになるわけではありません。というか、GAEにはあいまい検索のためのAPIも標準でありますから。 最近の本格サーバーサイド開発では、MVCアーキテクチャーによるフレームワークを利用して開発するのが主流となりつつあります。Ruby言語におけるRuby on Rails、PHPにおけるCakePHPといったものがこれに相当します。 MVCアーキテクチャーは、アプリケーションをモデル（データベース管理）、ビュー（画面表示担当）、コントローラー（ロジック担当）、という３つの要素に整理し、それぞれを実装していくことでアプリケーションを構築していくという考え方です。データベースアクセスなども、SQLのクエリーを直接書いたりせず、フレームワークに用意されているモデルクラスのメソッドを呼び出してアクセスするようになります。フレームワークを使って抽象化することにより、データベースなどが変更されてもコードを書き換えることなく、設定の変更だけで動かせるようになります。 GAEは、基本的な機能はAPIですべて提供されますが、MVCアーキテクチャーのための基盤は標準では用意されていません。そこでリリースされたのがSlim3です。これを導入することにより、直接APIをコールせず、モデルクラスを定義してメソッドを呼び出すだけでデータベース（この場合はBigtable）にアクセスできるようになります。 ただし、「Bigtableにアクセスしやすくする」ためにSlim3が作られているわけではありません。Slim3は、あくまでMVCアーキテクチャー実現のためのものです。それの導入により、いわば副産物的にデータベースアクセスも簡単になる、というだけのことです。 Bigtableによるデータベースアクセスに、なにか特別なものを見ているようですが、Bigtableだろうとなんだろうと、要はただのデータベースです。Bigtableは、SQLではなく、NoSQLですからちょっと違和感を覚える人はいるでしょうが、NoSQLはHTML5のWeb DBからMongoDBなどまで、今ではごく普通に使われているデータベースであり、それほど特別なものでもありません。Bigtableというデータベース機能のために、なにか特別な技術などが要求されるかのような考えは不要です。そのへんのデータベースと同じです。
No.2です。 m3_makiさんのご回答で解決されたとのことなので、今後のご参考に、ということで。 > チェックのロジックを共通化できるのがメリットということですか。 はい、前任者の方にそういう意図があった可能性を推測しての回答でした。 例えば、テーブルの各フィールドに入力するデータを非連結フォームで 一旦受けた上で、コマンドボタンのクリックなどでテーブルに反映、という 形を採る場合、フォームモジュールで対応すると、テーブル/フォームが 異なる場合は、また同様のコードを記述することになると思います。 ここで、例えば 　a)記録先の各フィールドに一対一で対応するクラス 　　→DataAccessObject(DAO)のFieldオブジェクトを経由して 　　　 『データ型』や『入力規則』『値要求』などを取得するとともに、 　　　当該フィールドに対応するコントロールの更新時(→WithEvents 　　　使用)に、それに相当するチェックを実行 　b)記録先となるテーブル/クエリに対応するクラス 　　→上記「a」のクラスを格納するコレクションを定義しておき、記録先 　　　のフィールドに対応する上記「a」のクラス群を保持 　　　(フィールド名とコントロール名を引数とするメソッドを用意しておき、 　　　同メソッドで「a」クラスのインスタンスを生成し、コレクションに追加) という2つのクラスを定義しておけば、当該フォームのOpenイベント等で 　・上記「b」クラスのインスタンスを格納する変数の定義 　・上記「b」クラスのインスタンスの生成 　・上記「a」クラスのインスタンスを生成し、コレクションに追加するメソッド 　　の呼出(Split関数と「For Next」ステートメントを使用) というコードを記述するだけで、「テーブルのフィールドに定義された各種 プロパティへのチェック」を、フォーム毎に個別にコーディングする手間が 省ける、ということです。 (更にクラスの定義に凝れば、テーブルの『入力規則』では対応できない 　「ユーザー定義関数による入力規則の定義」なども行えるかと 　思います： 　但し、この部分は各フォームのOpenイベント等での個別コーディングが 　発生することになります) ・・・と、長々と書きましたが、私自身ではまだこれに相当するクラスを 作成したことはありませんので(汗)、細部に間違いがありましたら ご容赦願います。 あくまで、イメージということで・・・(汗)
ロリポップでSQLite3クラスは使えるようになっているのか?
No.7に対し、頭の悪い勘違い野郎の反論。 Accessは立派な開発環境です。 ADO、DAO、ODBCで繋げばデータベースは何でもＯＫ。 そのデータを、オペレーターが自由に参照、加工できる操作画面、レポートを効率よく作れるのがMS-Accessです。 資金的、時間的余裕のない中小企業経営者が、寝る間を使って勉強すれば素人でもそれなりに使えるDBが組めるソフト、簡単過ぎず、難解すぎでもない、絶妙なバランスにあるのがAccess。 「マクロと関数、それ以上なら次に行くしかない」ですか・・・・ 私には意味がわかりません。 マクロ、関数の先を勉強していますが、その先は進めば進むほど奥が深いです。 むしろ、その先の方が実務に必要なテクニックが多く眠っています。 ちなみに、以前VB2005をいじりましたが商売に使える伝票（＝レポート）を作るならAccessレポートをVBAで動かした方がVB単体で描くより何十倍も表現力豊かな帳票が作れました。 ソフト開発には３つの立場の人がいます。 金を払う依頼人、金をもらうプログラマ、そしてソフト使い日々の実務を行うオペレーター。私は毎日一人３役で仕事をこなしています。 こんなことが可能なのは開発効率が極めて高いMS-Accessのおかげです。 資金に余裕があり、人材も豊富で、開発時間も十分にある会社なら「Accessである必要性は無い」の意見に、私も同感です。
とか。
自分はMongoDBを使ったことはありませんが、MongoDBのマニュアルにはそういうことが書いてあるように見えます。 http://docs.mongodb.org/manual/faq/concurrency/ http://docs.mongodb.org/manual/faq/concurrency/# … によれば、ほとんどの操作に対してdatabase単位でロックを行なっているようです。 read/write lockなのでwrite lockが必要なケースが少ないと問題ないでしょうが、ユーザーによる更新が多発する場合には大きな問題になりそうです。 http://docs.mongodb.org/manual/faq/concurrency/# … 更新の際には当然、write lockが行われるようです。 work aroundとしてはすべてのユーザーを単一のdatabaseに入れるのではなく、ユーザーIDごとに散らして入れておくという方法がありそうですが。複数のユーザーに関わる操作をされた場合には複数のdatabaseのロックを取得しないといけなくなります。
ひとつの繰り返しフィールドの消去は 変数を設定 [ $n; 値:1 ] Loop 　消去 [ テーブル::その繰り返しフィールド[$n] ]　---[]は繰り返し数指定欄に 　変数を設定 [ $n; 値:$n+1 ] 　Exit Loop If [ $n=LeftWords( FieldRepetitions ( Get ( ファイル名 ) ; 　　　　　　　　　 Get ( レイアウト名 ); Get ( アク ティブフィールド名 ) ) ; 1 )+1 ]　※ End Loop ※の部分は繰り返し表示数が3なら、単にExit Loop If [ $n=4]でもいいです。
Connectionを開きっ放しにして置くと排他や競合で問題が発生する可能性が高いので、 必要な時だけ開き終わったらすぐ閉じるのが原則かと思います。 細かく書いてゆくのが基本かと考えますが 標準モジュールに Sub myOpenCn・・・ Sub myCloseCn・・ のようなものを作成して 各ボタンには Call myOpenCn 処理・・・・ Call myCloseCn のようにしておけば良いのでは？
>SQLが使えるツール によって変わってくる場合がありますが、 SELECT メルアド FROM テーブルA WHERE 郵便番号 IN (SELECT 郵便番号 FROM テーブルB) とか。
こんな感じで、Access2010で書いたので2000だとエラーになるかも？ DAO 3.6？に参照設定が必要です。 タブインデントの代わりに全角スペースを使っています。 Sub test() 　　Dim DB As Database 　　Dim DB2 As Database 　　Dim tdf As DAO.TableDef 　　Dim i As Integer 　　Const mdbPath As String = "c:\顧客管理.mdb" 　　Const tblName As String = "MT住所録" 　　　　 　　If Dir(mdbPath) = "" Then 　　　　MsgBox mdbPath & "が見つかりません" 　　　　Exit Sub 　　End If 　　 　　For Each tdf In DB.TableDefs 　　　　If tdf.Name = tblName Then 　　　　　　DB.Execute ("drop table " & tblName)　'テーブル削除 　　　　　　Exit For 　　　　End If 　　Next 　　 　　Set DB = CurrentDb 　　Set DB2 = DBEngine.OpenDatabase(mdbPath) 　　For Each tdf In DB2.TableDefs 　　　　If tdf.Name = tblName Then 　　　　　　i = 1 　　　　　　Exit For 　　　　End If 　　Next 　　 　　If i = 0 Then 　　　　MsgBox mdbPath & " に " & tblName & "がありません" 　　　　DB2.Close: Set DB2 = Nothing 　　　　Exit Sub 　　End If 　　 　　DoCmd.TransferDatabase acLink, , mdbPath, acTable, tblName, "リンクテーブル１" 　　 　　'[切り離し] 　　'DoCmd.DeleteObject acTable, "リンクテーブル1" 　　DB2.Close: Set DB2 = Nothing End Sub
> そのソフトを私のデスクトップにインストールするのでしょうか？ はい、そうなります。 > SQL Serverというソフトなら基幹システムから落ちてくるMDBファイルを今のように扱えるのでしょうか？ MDBにあるデータ(テーブル等)をインポートして使うことになります。 単体ではもしかすると使い辛い部分があるので、フロントエンドはAccessをお使いになられた方が良いかもしれません。 参考書など多数出てますので・・・それぐらいは経費でなんとか・・・ 現在サポートされている(といってもセキュリティパッチがダウンロードできますよの意味)SQL Server Expressは以下にあります。 バージョンが新しいほど、必要なスペックはあがるとお考えください。また、対象OSも異なりますので、それぞれリンク先を確認してください。 Microsoft SQL Server 2005 Express Edition Service Pack 3 http://www.microsoft.com/ja-jp/download/details. … Microsoft® SQL Server® 2008 R2 SP2 - Express Edition http://www.microsoft.com/ja-jp/download/details. … Microsoft® SQL Server® 2012 Express http://www.microsoft.com/ja-jp/download/details. …
番外回答： 提示されたサイトを見ましたが自分には理解できませんでした マイクロソフトなのでIIS起動が条件になると思うのですが・・ というような人の回答です 大げさな表現をさせますが、1台のパソコンに無償の「Xampp」なるソフトを組み込み、このパソコンに無線LANルーター（WiFi）を有線LANで接続して電波を発信します この無線LANルーターの届く範囲に持ち込まれた無線受信可能パソコンが発信電波をとらえて使用許可が取れれば（WiFi）親PCが持っている固有のデーターベースに接続できます この親PCがどのような固有データーベースを発信しているかによって、持ち込みPCのユーザーは使う使わないを判断します ということで全く不可能ではありません（ここが言いたかっただけ）
並べ替えについて回答させてください。 >>レポート1の問題を踏まえ、一応、項目名Eを除外して集計しています（現時点で未解決） ここでは、担当者の並び替えを任意に行いたいです。 昇順や降順ではなく、例えばあ・い・う・え・おを、い・う・あ・お・えのように並べたいのです。 リレーションの機能を使って出来ます。記載順のテーブルを別に作成し、これに二つの項目を入れます。順番の番号(1,2,3・・・)と担当者氏名です。そこで並べ替えをしたいテーブルと記載順テーブルを氏名をもとにリレーションを設定します。 次にクェリーを実行します。二つのテーブルの必要事項を取り込み、ここで並べ替えの設定を記載順のテーブルの番号を基準に指定すれば、実行の結果は希望のものになります。
ご質問のコードは１行目の第０番目のデータを表示させていますが、select命令の取得フィールドを２つとも指定するようにできます。 そして、fetch を　fetch_assocに変えて、count(*)に別名kosuを与えて、連想配列で$num->idと呼び出すようにできます。 ただし、このようにしてデータ件数分だけ繰り返したとして、count()関数をその度に繰り返すでしょうから時間的ロスは出るので、別々にするのが効率的と思われます。 また、ＰＤＯを活用するとしたら、基本的なＳＱＬの操作方法は共通ですから、ＳＱＬの文法と繰り返し取得とフィールドの分割が分かれば、SQLの違いに関わらす自由に操作できます。 $pdo = new PDO(sqlite:test.db); $query = $pdo->prepare('SELECT id, count(*) AS kosu FROM testTable WHERE id > 0 AND id < 10'); $query->execute(); $num = $query->fetch_assoc(PDO::FETCH_NUM); // id,kazuを指定して echo $num->id; echo $num->kazu;
管理番号がテキスト型でしたらこちらで。 累計: DSum("試験時間","テーブル9","管理番号='" & [管理番号] & "' AND 開始日付 <= #" & [開始日付] & "#") 確認してみてください。
No.1です > 他に原因と思われるところ う～ん、とりあえず、思いつくところを挙げてみます(汗) 1)Accessでのキー操作に対する制限方法としては、前述の 　設定の他には「AutoKeys」マクロがあるので、その端末の 　ツールにそれがないかを確認してみる： 　(『テーブル』『フォーム』などの一群の中に『マクロ』というのが 　　あるので、そこで上記の名前(全角半角・大文字小文字 　　は問わない)のものがないかを確認) 　http://www.accessclub.jp/samplefile/samplefile_1 … 　お使いのAccessが2010の場合はややこしそうですが・・・(汗) 　http://www.free-style.biz/lifediary/2011/06/acce … →上記マクロで、『マクロ名』欄に「{F11}」が割り当てられている 　 ようなら、これが原因の可能性大。 　 但し、同一ツールなら他の端末のものにもあるはずなので、 　 『アクション』等の指定が異なっていないか、或いは一方で 　 「{F11}」に「+」や「^」などが組み合わせになっているのに、 　 他方でそれがない、といった違いがないか、を確認 2)ご自身でも予想されているように、ファイルが破損している： 　F11キーが有効になっている他の端末から、ツールをコピー 　して、そちらが正常に動作するかを確認してみる →コピー(差し替え)で直るようなら、破損だった可能性が高い。 　 (丸々コピーだけでよいなら上記のままでOk、ローカルテーブル 　　の内容が各端末で異なるようなら、そのデータをインポート 　　して、差し替えたファイルを使用する) 3)CtrlキーとGキーを同時押しして『イミディエイト ウィンドウ』を 　開き、そこに以下のコードを入力後、Enterキーで改行して、 　データベース ウィンドウが表示されるか確認： 　(SelectObjectメソッドの詳細については、ヘルプを参照下さい) 　　　DoCmd.SelectObject acTable, , True →上記「2」では改善せず、こちらで表示されるようなら、 　　ａ)キーボードのF11キーの不具合の可能性 　　b)Accessアプリケーション自体の不具合の可能性 　が疑われるので、 　　a)別のキーボードがあればそちらを接続して確認。 　　　別のキーボードでそのまま使用可能ならそれで対応。 　　　ノートPCなどで交換できず、端末をそのまま使い続ける 　　　しかない場合は、上記コードを適当なフォームに埋め込む 　　　か、「1」で紹介したAutoKeysマクロを使用してF11キー 　　　以外のキーにデータベース ウィンドウへのショートカットを 　　　割り当ててしのぐ 　　　(SelectObjectは「オブジェクトの選択」アクションに相当) 　　b)コントロールパネルから「プログラムの追加と削除」から、 　　　Officeアプリケーションの修復(又は再インストール)を 　　　試す 　　　念のため、Office UpdateまたはMicrosoft Update 　　　(前者は後者に統合されてもうなくなってましたっけ?(汗)) 　　　も行った上で、他の端末と同様の動作になるか、確認 ・・・以上です。 とりあえず、どれかで解決するとよいのですが・・・(汗)
未満がよくわからないと・・・ 未満はその数を含みません。 なので、整数より小さい数を四捨五入する。 小数点以下の桁数を調整するだけでいいのかな？ とも思いますが（小数点表示桁下げで5.66なら.66をなくして6にする） たとえば、関数を使って小数点以下を操作しなしさい と言われたら A１の数値を操作する場合 「整数未満四捨五入」・・・=ROUND(A1,0) 「整数未満切り上げ」・・・=ROUNDUP(A1,0) 「整数未満切り捨て」・・・=ROUNDDOWN(A1,0) とし、これが「小数第２位未満」と指定されたら ０のところに２を入れます。 5.678だったとしたら、.678の6を四捨五入して６にする。
なんか、質問内容と回答に対する補足を見ていると．．． 設計側の物を、使用者側に、そのまま見せてる感じ？ たとえば 「設計側」 コードマスター（ID,名称） 1,'北海道' ．．．．． 20,'東京' ．．．．． 47,'沖縄' 社員出身マスタ（社員コード,社員名,出身コード,方言） 1,'あ',1,1 1,'い',2,2 となっているとすると 「使用者側」 社員名を入力 or 選択（同姓同名がいる場合があるため、社員コード入力等が望ましい） 出身を選択（北海道, 東京, 沖縄 等から選択） 方言を選択（北海道, 東京, 沖縄 等から選択） 多くのシステムでは、こうなっています。 ですので、使用者側がコード入力する箇所は、社員コードぐらいですね。 ただし、昔から（汎用機）のシステムを使っていて、ずっと同じように使いたいという 会社もあります。 そのような場合、コード入力の方が、選択 or 漢字入力よりも慣れているため あえて、コード入力を使用者側がするということもあります。
リストボックスの名前が LST1 チェックボックスの名前は CHK1 LST1の隣などの同じセクションにCHK1 が有るとしたら CHK1 のクリック時イベントにて Private Sub CHK1_Click() Me!LST1.Visible = Me!CHK1.Value End Sub とかでは？
解決策となる回答では無く恐縮です。 似たような現象で Win7 64bit + Filemaker Pro11で再変換が利きません FMPro12も怪しいですが、Win7の64もかなり怪しいかと MSからのSP待ちで解決するかどうかですね？
【要旨】 値集合ソースやクエリのSQL文では、 　((テーブル.カラム) like "'*" & Forms!フォーム!テキスト1 & "*'") と、「'」は入れずに、 　((テーブル.カラム) like "*" & Forms!フォーム!テキスト1 & "*") としてください。 【詳細】 VBA上でSQL文を扱う場合や、DMaxなどの定義域集計関数の引数にする 場合は、確かに「*」と同時に「'」を使用しますが、クエリ(又は値集合ソースへの 直接入力)に使用する場合は「'」は使用せず「*」だけを指定します。 ちょっとわかりにくいかもしれませんが(汗)、完全一致の場合も、 　((テーブル.カラム) = "'" & Forms!フォーム!テキスト1 & "'" ) ではなく 　((テーブル.カラム) = Forms!フォーム!テキスト1 ) と、「'」を使用せずに指定しないと正しい結果が得られないのと同様と 考えて戴ければいいかと思います。 くどくなるのを承知で(汗)、さらに説明すると・・・ VBAでは、例えば「Me.氏名」に「鈴木」という値が入っていたとして、 　strSQL = "Select * From テーブル1 Where 氏名 Like *" & Me.氏名 & "*;" という変数への記録を行った場合、実際のWhere句は 　氏名 Like *鈴木* となって 　氏名 Like "*鈴木*" とはなってくれません。　 (「*」がワイルドカード文字ではなく乗算の演算子として扱われてしまう、と) これを防ぐため、VBA上でSQL文を扱う場合は、「'」を(又は「"」を重ねて) 使用する必要があります。 一方、クエリやSQL文を直接編集する場合は、 　氏名 Like "*鈴木*" とか 　氏名 Like "*" & Forms!フォーム!テキスト1 & "*" といったように、予め「*」を「"」で括って文字列(ワイルドカード文字)として 明示していることになります。 なので、逆にここに「'」を追加すると、その「'」まで「検索文字列」として 指定したことになってしまうので、意図した抽出結果が得られなくなる、 ということです。 ・・・以上、長くなりましたが、参考まで。 なお、余談になりますが、この「Like」は「関数」ではなく「演算子」になります。
> SQLの抽出条件「forms!サブ１!a」として、上記で取得した > テキストボックスaを使用しております。 > > サブ１をメインフォームで開き上記を実行すると値を抽出します。 Forms!メインフォーム名!サブフォームコントロール名.Form!a としてください。 あるいは、単純に、[a] とするだたけでもOKです。Formsの指定がない場合は自分自身のフォームから探しますので。また、この方法だと単独で開いても、サブフォームとして開いても正常に動作しますのでお勧めです。
ゴミではないと思いますがGoogleっても、MS社のですら出てきませんね。 とりあえず確認できたこと。 MDBファイルには存在せず、ACCDBファイルにのみ存在する。 Access2010でMDBファイルを作っても無い。 新規ACCDBファイルでオブジェクトを全く作成せずに MSysObjectsテーブルを見ると既にある。MDB→ACCDB変換に関わらず作成される。 作成時刻を見ると新規にACCDBファイルが作成された時刻になっている。 f_・・・・・・_Dataの文字桁数が同じなので何かの識別用UIDかもしれない。 気にしない事がイチバンかも？ (^^ゞ
sql puzzle でGoogleってみたら？ これなどは？ Joe Celko氏の著書[SQLパズル]の内容をふまえて構造化定理を意識しつつ、SQLパズルを解くサイトです。 Oracle9i以降が対象です。 http://www.geocities.jp/oraclesqlpuzzle/
VBAでの回答は却下でしょうか？ また、フォームAをダブルクリックするとして その際に選択された行の中に、フォームBで一意に指定できる要素 （単一または複数のフィールドの組み合わせで一意となるもの）がありますか？ たとえば、『ID』というのが一意なら、フォームAのダブルクリック時イベントで Private Sub Form_DblClick(Cancel As Integer) Forms!フォームB.Filter = "ID=" & Me!ID Forms!フォームB.FilterOn = True End Sub 等なんですけど。。
>>クエリーが複雑すぎます」とのエラーが出て、データベース（登録.mdb）の更新が行えません。 何とかエラーを出なくする方法は無いでしょうか？ たぶんクエリをなんとかシンプルに変更するしか対策は無いと思います。
> この機能のオン・オフをＶＢコードから制御できないでしょうか？ ご質問の制御の対象がフォーム上ということでよろしければ、 郵便番号・住所の入力/表示に使用しているテキストボックスの 「PostalAddress」プロパティの値を切り替えてやればOkのようです。 (普段この機能は使用しないので(汗)、今試してみました：Acc2007) 既にウィザードなどで機能を設定済みのテキストボックスがある ことを前提に、式を例示します。 『郵便番号欄』『住所欄』の2つのテキストボックスがあって、 それぞれの『住所入力支援』プロパティ(→テキストボックスの プロパティシートの『その他』タブにあります)の値が、それぞれ 　　『郵便番号欄』テキストボックス　→　プロパティ値=「住所欄」 　　『住所欄』テキストボックス　→　プロパティ値=「郵便番号欄;;;」 となっている場合は、 　　Forms!フォーム名!郵便番号欄.PostalAddress = "住所欄" 　　Forms!フォーム名!住所欄.PostalAddress = "郵便番号欄;;;" 　または、同じフォーム上なら 　　Me!郵便番号欄.PostalAddress = "住所欄" 　　Me!住所欄.PostalAddress = "郵便番号欄;;;" と、プロパティ値を「"」ダブルクォーテーションで括って代入すればオンに、 　　Forms!フォーム名!郵便番号欄.PostalAddress = "" 　　Forms!フォーム名!住所欄.PostalAddress = "" 　また、上と同様に同じフォーム上なら 　　Me!郵便番号欄.PostalAddress = "" 　　Me!住所欄.PostalAddress = "" と、空文字("")を設定してやればオフに、それぞれできます。 住所を『都道府県』と『市区町村』などに分割している場合も、 基本的には上記と同様にプロパティ値の代入で切り替え可能です。 (郵便番号系・住所系で使用しているテキストボックスの数だけ、 　代入式が必要になります： 　上の例では郵便番号欄/住所欄の2つなので、2つの代入式、と) ・・・以上、参考まで。
No5です。 「True」という文字列がBooleanで返す「True」とまぎわらしい、という ことであれば、 Function funcJudge(ByVal fP As Long, ByVal fQ As Long, ByVal fR As Long, ByVal fS As Long) As String '最初の条件 If fP = 0 And fQ >= 1 And fR = 2 And fS = fQ Then funcJudge = "同値" Exit Function End If '二番目の条件 If fP >= 1 And fQ >= 1 And fR = 1 And fS = fP Then funcJudge = "同値" Exit Function End If End Function のように「同値」でもかまいませんが。
確認ですが　JavascriptよりAjaxの方がチェックが減ると思いますが．． Javascriptなら　という理由はどういうものでしょうか 個人的には　jQueryからPHPに投げるものを作ります http://alphasis.info/2011/11/jquery-gyakubiki-jq … http://alphasis.info/2011/11/jquery-gyakubiki-jq … http://alphasis.info/2011/11/jquery-gyakubiki-jq … http://alphasis.info/2011/11/jquery-gyakubiki-jq … http://alphasis.info/jquery-api/gyakubiki/ajax/ サンプル付で分かりやすいものを紹介しておきます 分かりにくい場合は詳しく説明します　補足を
イミディエイトウィンドウでの、?DLookup・・・はDlookupの戻り値を表示せよ、という意味です。 Print DLookup・・・ の省略です。 一方、Private Sub s店舗no_LostFocus()では Dlookupの戻るところがありませんのでエラーになります。 通常は 変数 = DLookup("[店舗名]","[t店舗]","[店舗no]="& Forms![ft店舗seach]![s店舗no]) などと使用します。 また、ヘルプをご覧になれば 「criteria に適合するレコードがない場合や、domain にレコードが含まれていない場合は、Null 値が返されます。」 とも記載されています。 加えて、s店舗no がフォーカスを失うごとにDLookupで調べるよりも 更新後に行った方がベターかと思います。 具体的に何をしたいのかよく分かりませんが Private Sub s店舗no_AfterUpdate() dim へんすう as string If Not IsNull(s店舗no) Then msgbox nz(DLookup("店舗名","t店舗","店舗no="& Forms!ft店舗seach!s店舗no),"見つからない") へんすう = nz(DLookup("店舗名","t店舗","店舗no="& Forms!ft店舗seach!s店舗no),"見つからない") debug.print へんすう End If End Sub のような感じでは？ なお、オブジェクト名やテーブル名などに、 スペースが含まれていたり、予約語である場合を除いて、[] で囲まなくとも可。 http://support.microsoft.com/default.aspx?scid=k … nz関数で括るのは余計かもしれない。。
>DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel3, _ strac, strxls, True, strrange Excel では、RTEST という範囲名が設定されていないのでは？ なら此処は・・・strac, strxls, True だけで。 また、acSpreadsheetTypeExcel3 はExcel3.0形式の指定です。8 あたりでは？
追加で、気になった点を １）同じフィールド名はOK? 以下から始まる４組で、フィールド名を同じにしているがOK? > Ｔ傷病名マスタ取込用.傷病名 As 傷病名, > T傷病名マスタ.傷病名 As 傷病名, ・・・・ > T傷病名マスタ取込用.大分類 as 大分類, > T傷病名マスタ.大分類 as 大分類, また、テーブル名先頭の T が全角/半角混在するけど・・・ ２）RIGHT JOIN の ON 部分で、テーブルの修飾が無いものがある > From T傷病マスタ RIGHT JOIN [T傷病名マスタ取込用] ON [T傷病名マスタ].[傷病名コード] = 傷病名コード また、テーブル名を確認する（T傷病マスタ ? T傷病名マスタ ?） ３）SELECT 部分の IIF にも Nz は必要？ ４）WHERE 部分の IIF は不要で、そのまま判別してみたら・・・・ (Nz(T傷病名マスタ.傷病名)<>Nz(T傷病名マスタ取込用.傷病名)) OR ・・・ ５）２つ目の SELECT に FROM が無いような・・・ 上側 SELECT の雰囲気は以下（動かないかも：未検証） SELECT Q2.傷病名コード, Q1.傷病名, Q2.傷病名 AS 傷病名N, Q1.ショウビョウメイカナ, Q2.ショウビョウメイカナ AS ショウビョウメイカナN, Q1.ICD10コード, Q2.ICD10コード AS ICD10コードN, Q1.大分類, Q2.大分類 AS 大分類N, MID(IIF(Nz(Q1.傷病名)=Nz(Q2.傷病名),"","、傷病名") & IIF(Nz(Q1.ショウビョウメイカナ)=Nz(Q2.ショウビョウメイカナ),"","、ショウビョウメイカナ") & IIF(Nz(Q1.ICD10コード)=Nz(Q2.ICD10コード),"","、ICD10コード") & IIF(Nz(Q1.大分類)=Nz(Q2.大分類),"","、大分類") ,2) AS 変更部分 FROM T傷病名マスタ AS Q1 RIGHT JOIN T傷病名マスタ取込用 AS Q2 ON Q1.傷病名コード = Q2.傷病名コード WHERE (Nz(Q1.傷病名)<>Nz(Q2.傷病名)) OR (Nz(Q1.ショウビョウメイカナ)<>Nz(Q2.ショウビョウメイカナ)) OR (Nz(Q1.ICD10コード)<>Nz(Q2.ICD10コード)) OR (Nz(Q1.大分類)<>Nz(Q2.大分類)); ２つ目の SELECT では、RIGHT JOIN を LEFT JOIN に変更し、 SELECT 部分の Q2.傷病名コード, を Q1.傷病名コード, にすると、できるかも・・・
>SQL = "select * from T1 where keyword = '" & tb1 & "'" でエラーになるかと思ったら出来るんですね・・・？？ Accessが気を利かしてくれているらしいのですが、少し気味が悪いので Private Sub cmd_exe_Click() Dim SQL As String If isnull(me!tb1) then SQL = "select * from T1 " else SQL = "select * from T1 where keyword = '" & ME!tb1 & "'" end if me!sf1.form.recordsource = sql ・・・ では？
＞レコード構造を解析もしくは割り出す ＞ツールなどはございませんでしょうか？ 私が知らないだけの可能性もないわけじゃないですが、おそらくそのようなツールはないです。 例えば8バイトのバイトデータがあったとして、それが 64ビット浮動小数点 32ビット浮動小数点が2つ 64ビット整数 32ビット整数が2つ 16ビット整数が4つ 8ビット整数が8つ それ以外の組み合わせのどれか のどれに当てはまるかなんてのはツールでは判定できません。
できますよ。 PDFをコピーしてレイアウトモードで貼り付け とか レイアウトモードで挿入メニューからオブジェクト挿入 等で。 でもWinではレイアウトにPDFを取り込むと汚くなるはず。 JPEGと両方試してみてください。
>指定の場所に移動に移動してレコードのインポート→フォルダで参照データのみのインポートをおこなっています。 別のFMファイルからのデータのインポートなども同じで、 新規レコードとしてインポートすると今インポートしたレ コードだけが対象レコードになりますよ。 既存レコードは混ざりません。
検索してみました （「ビートリーブ」とカタカナで書かれたのは初めてみたので、しばらく思い出せなかった） 参考URL：http://q.hatena.ne.jp/1076907159
＞他のソフトは何も起動していませんが セキュリティ対策ソフトが常駐していませんか？（一時的に「無効」） OSは？（Administratorでログオンし実行やプログラムを右クリック「管理者として実行」実行）
回答２に対する質問についてお答えします。マクロ1の代わりに下のマクロ２を実行してください。不具合がありましたら質問をしてください。 Sub Macro2() ' ' Macro2 Macro ' マクロ記録日 : 2012/11/10 ユーザー名 : ' Dim mygyo As Integer, kijitsu As Variant, koumoku As String, tanka As Variant, kosuu As Variant, kingaku As Variant Sheets("Sheet2").Select mygyo = Cells(1, 8) + 1 Sheets("Sheet1").Select kijitsu = Cells(5, 3) koumoku = Cells(4, 5) tanka = Cells(15, 3) kosuu = Cells(20, 4) kingaku = Cells(20, 5) Sheets("Sheet2").Select Cells(mygyo, 1) = kijitsu Cells(mygyo, 2) = koumoku Cells(mygyo, 3) = tanka Cells(mygyo, 4) = kosuu Cells(mygyo, 5) = kingaku Cells(1, 8) = mygyo Sheets("Sheet1").Select End Sub
JavaでもDB2でもOracleでもWindowsでも、何にでも当てはまりますが、「まずはマニュアルを見ながら実際に使ってみる」のが良いかと思いますよ。 それで基礎を自分なりにしっかりと理解して行ったほうが良いと思います。 基礎を理解しないで、応用は出来ません。 先輩からそう言われたのであれば、多分ですが、あなたの会社にJavaやSQL（DB2）のマニュアル、参考書等は沢山あると思いますので、それらを読みつつ、実機を触って理解してみては如何でしょうか。
SQL Server 側の設計をどのようにしたのかわからないが、適切なインデックスを作成し、クエリの見直しを行うのが第一歩だと思う。 一般的に WHERE で使われる列はインデックス候補となりやすいため、受注日のインデックスを作成する。 そしておそらくは VBA のコードの中で Dim sql As String sql = "DELETE testデータ.受注日 FROM testデータ WHERE ((testデータ.受注日)=#" & juchu & "#));" とかやっているのかと思うが、SQL 文を動的に作成して実行するのをやめて、SQL Server 側にストアド プロシージャとして作成しなおし、UI 側からはこのプロシージャに必要な日付値を与えてキックする方法にする。 とりあえずそんなところか？
＃２です できそうなそぶりを見せて申し訳ありません。 私のわからないところに行ってしまいました。 ＃２で想像していたのは、 コンボボックスのデータが、何らかのタイムアウトで空欄になり・・・・ だったら Requery すれば裏方さんが繋ぎ直してくれるのでは・・・・ という考えからでした。 そして、その想像も打ち消されました。 ごめんなさいです。 そこで提案ですが、 現QAでは、他の方の登場は期待できないかも・・・ 時間的余裕があれば、待ってみるのもありかと思いますが・・・・ 本QAは締切扱いとして、 ・Microsoft Community　とか　http://answers.microsoft.com/ja-jp/office/forum/ … （モデレーターさんがどこまで面倒を見てくれるのかわかりませんが） ・moug の一般機能　とか　http://www.moug.net/faq/viewforum.php?f=3 で質問しなおされることを望みます。 ただ、回答が得られるかは・・・・ 質問しなおされる場合には、 ・ログインフォームの構成　コンボボックスで ID、パスワードを持たせている事 ・＃２で記述された どの様な時間経過でどうなるか ・Access2010 or Runtime 以外に OS を簡潔に記述されたらと思います。 なお、締め切ってから質問してください。くれぐれもBAは付けないように。 質問しなおされる時には、このQAのアドレスを記述しておいた方が良いと思います。 解決しなかったから質問した・・・と くれぐれもマルチポストにはならないように・・・・ 長々と時間を取らせて、すみませんでした。
コードの決め方にこだわらなくてよく、商品の品目ごとにコードを決めればよいです。コードのなかに一部を使ってサイズ、色を組み込むことも出来るし、サイズ、色別にコードを作ってもよいです。
、販売店コードフッターに配置したテキストボックスのコントロールソースを下記のように設定してください。 =Sum(IIf([売上額]>0,1,0))
レコードの削除 実行前、削除の確認メッセージが出ないように設定します。 そのままでは、メッセージなしに削除されてしまいますので、自前で Msgbox関数で確認メッセージを出します。 下記の部分を、 If not [Form].[Newrecord] Then 　　　　メニューコマンドの実行 　　　　　　　　　　コマンド　レコードの削除 If文の最後 下記のように変更してください。 If Not [Form].[NewRecord] And Eval("MsgBox('レコードを削除します。@「はい」をクリックすると、削除したレコードを元に戻すことはできません。@削除してもよろしいですか?',52)")=6 Then 　　　　メッセージの設定 　　　　　　　　　　メッセージの表示　いいえ 　　　　メニューコマンドの実行 　　　　　　　　　　コマンド　レコードの削除 　　　　メッセージの設定 　　　　　　　　　　メッセージの表示　はい If文の最後 「メッセージの設定」アクションを表示させるには、リボンの[マクロツール]-[デザイン]の「すべてのアクションを表示」を押し込んでおいてください。
この場合、INNER JOINの後を()でくくる必要はないのだが。 それはさておき、 SELECT c.CarNo, c.Model, cs.FirstName, cs.LastName, b.Date, b.Duration FROM Location l INNER JOIN ( ( (Own o INNER JOIN Car c ON o..FK_CarNo = c.CarNo l.LocationNo) /* o..FK_CarNo は、 o.FK_CarNo のあやまりでしょう。 また c.CarNoの後にあるl.LocationNoは何のためのものか分らないので文法エラーになります。 */ INNER JOIN Book b ON c.CarNo = b.FK_CarNo) INNER JOIN Customer cs ON b.FK_CustomerID = cs.CustomerID) ON l.LocationNo = o.FK_LocationNo WHERE l.LocationName =:user_input ; ANO.1の方が書いた方法で悪いとは思わないのですが、ご自身で書かれたselect文を試してみたければ /* ・・・　*/内に書かれた内容を直した下のselectを試して見られたらいいでしょう。 SELECT c.CarNo, c.Model, cs.FirstName, cs.LastName, b.Date, b.Duration FROM Location l INNER JOIN ( ( (Own o INNER JOIN Car c ON o.FK_CarNo = c.CarNo) INNER JOIN Book b ON c.CarNo = b.FK_CarNo) INNER JOIN Customer cs ON b.FK_CustomerID = cs.CustomerID) ON l.LocationNo = o.FK_LocationNo WHERE l.LocationName =:user_input ;
> TOP句がうまく機能しないんです・・・。 あっ、しまった。昇順ですので総売上が一番小さいのが表示レさてしまいますね。 ORDER BY句を降順に変更してください。 ORDER BY 総売上 DESC;
最近、同様のトラブルがありましたので まだ解決していないようでしたら参考にしてください。 原因については推測によるものです。 開発環境とトラブルのおきた環境でプリンタが異なっている場合です。 私の場合は、たまたまプリンタが故障して 間に合わせで、 「給紙方法」 が 「後トレイ」 しかない機種を 「通常使うプリンタ」 にしていました。 その状態で作成したレポートは デザインのページ設定で給紙方法が 「後トレイ」 に設定されていました。 それしかないのですから 「自動選択」 にならないのは当然と言えば当然ですが。 客先から、用紙切れのメッセージが出る、と報告があるまで 全く気が付きませんでした。 で、対策としては 「通常使うプリンタ」 を 「カセット」もある機種に戻して （本体が無くてもドライバさえあればOKです） デザインのページ設定で「給紙方法」を「自動選択」に変更して保存。 デザインで 「自動選択」 になっていれば 「通常使うプリンタ」を「後トレイ」しかない機種にもどしても正常に印刷できます。 いずれにしても、レポートのデザインでの「給紙方法」 を確認してください。
全部 Visual Basic Express Edition 関連でしょ。 SQL Server Compact Edition とその関連ツールだな。 これらは SQL Server の上位エディションとは違い、管理サービスを実行しなくてもデータ ファイルだけあれば DB が使えるようになるファイル ベースのデータベース。 DB を使用するアプリを開発して配布先PDでインストールする際に SQL Server をインストールしなくても良くなる。 そういうのを開発するために Visual Basic と一緒にインストールされたりする。
質問者さん 私に騙されてみる気はありますか。 以下の方法は、私がいろいろやってみて、何か動きそう・・・ というレベルのもので、Microsoft の資料等裏付けが取れていないものになります。 確認用フォームは、添付図の様になります。 （フォームウィザードから表形式として作ったものになります） 「an」「日付」「Src」を連結した帳票で、 ボタン、前に「btnPrev」、次に「btnNext」がヘッダに配置されたものになります。 VBAで、以下を記述します。 Const CSCRLNUM As Long = 10 Private Sub Form_Load() 　　Me.InsideHeight = Me.Section(acHeader).Height _ 　　　　　　　　　　+ Me.Section(acDetail).Height * CSCRLNUM _ 　　　　　　　　　　+ Me.Section(acFooter).Height End Sub Private Sub ScrollByMyself(iNum As Long) 　　Dim i As Long, j As Long 　　If (Me.Dirty Or Me.NewRecord) Then Exit Sub 　　j = Abs(iNum) 　　With Me.RecordsetClone 　　　　.MoveLast 　　　　.Bookmark = Me.Bookmark 　　　　i = .AbsolutePosition + iNum 　　　　If (i < 0) Then 　　　　　　i = 0 　　　　ElseIf (i >= .RecordCount) Then 　　　　　　i = ((.RecordCount - 1) \ j) * j 　　　　ElseIf ((i Mod j) <> 0) Then 　　　　　　i = (i \ j) * j 　　　　End If 　　　　.AbsolutePosition = i 　　　　Me.an.SetFocus　　' ★詳細にあるコントロール「an」にフォーカス移動 　　　　Me.Bookmark = .Bookmark 　　　　i = (Me.CurrentSectionTop - Me.Section(acHeader).Height) _ 　　　　　　+ Me.Section(acDetail).Height 　　　　i = i \ Me.Section(acDetail).Height 　　　　If (i > 0) Then 　　　　　　DoCmd.GoToPage 1, , Me.Section(acDetail).Height * i 　　　　End If 　　End With End Sub Private Sub btnPrev_Click()　' 前へ 　　Call ScrollByMyself(-CSCRLNUM) End Sub Private Sub btnNext_Click()　' 次へ 　　Call ScrollByMyself(CSCRLNUM) End Sub ※ ★ の、詳細にあるコントロールにフォーカスを移動しないと、まともに動きません。 上記では「an」にしましたが、「日付」でも「Src」でも・・・・ フォーカスが詳細にあることが重要です。 上記の細かい説明は、ここではしません。 ※ 本質問とは別の用途ですが、ブログに記事として載せてます。 アドレスは書けない、導くキーワードの提示も規約で禁止されているので書けません。 興味あったら探してみてください。 なお、上記を確認してみる・・・・使ってみようかな・・・・ すべて自己責任にてお願いします。
試していませんが、こちらで解決するかもしれません。 Access 2010 の修正プログラム パッケージ (アクセス x none.msp）： 2012 年 2 月 28日 http://support.microsoft.com/kb/2597935/ja
なんどもすみません（汗）。 ANo.6 ですが、FROM を FORM とタイプミスしています。 SELECT DISTINCT 果物TBL.* FROM 果物TBL WHERE (ID In (SELECT ID FROM 果物検索TBL) AND EXISTS (SELECT 1 FROM 果物検索TBL WHERE ID Is Not Null)) AND (名前 In (SELECT 名前 FROM 果物検索TBL) AND EXISTS (SELECT 1 FROM 果物検索TBL WHERE 名前 Is Not Null)) AND (値段 In (SELECT 値段 FROM 果物検索TBL) AND EXISTS (SELECT 1 FROM 果物検索TBL WHERE 値段 Is Not Null));
＞実はマシンＡとマシンＢは別の場所にあります。 AとBがインターネットに繋がる状態なら、両方に「どこでもLAN」と言うのをインストールすれば、離れた場所同士で、ファイルの共有が出来ます。 http://www.dokodemolan.com/ 当方の会社では、異なる都道府県の間、海外間で、これを使ってファイルを共有しています。
>レンタルサーバに依存しないデータベースライブラリ？を探しています。 >「MySQL」や「PostgreSQL」のようなデータベースではなく、ファイルをデータベースとして使用出来るものを探しています。 接続ライブラリを探している? データベースを探している? どっちを探している? 前者ならPEAR:MDB2かPDOを使えばいい。 後者なら#1が回答しているSQLite
　まず、正確な定義を書いておきます。 　「関係 (リレーション) がスカラ値のみを持ちうるとき、そのリレーションを第1正規形であるという。」 　「あるリレーションが、第1正規形で、かつ、すべての非キー属性が、すべての候補キーに対して完全従属するとき、第2正規形であるという。」 　「あるリレーションが、第2正規形で、かつ、非キー属性があるならば、それら全てが候補キーに非推移的に関数従属するとき、第3正規形であるという。」 　となります。 　 　まず、第１正規形では、表をフラットな形にすることを、目標とします。ここでフラットな形とは、繰り返し項目（配列）や構造体を持たないことを意味します。この段階では、キーに関する言及はありません。ただし、集合としての性質上、全てのレコードが一意に決定できる（重複がない）ことは必要です。 　第２正規形では、候補キーへの「完全従属性」を求めます。これは、候補キーの一部だけが決まれば値が決まるという項目があってはいけないことを要求しています。完全従属性は、関数従属の特別な場合です。 　 　そして、第３正規形では、「推移的な関数従属がない」ことを求めています。これは、Ａが決まるとＢがきまり、Ｂが決まるとＣが決まる　という関係です。つまり、Ａが決まるとＣが決まることになりますね。これが「推移的な」関数従属です。 　例えば、「会員番号・氏名・支店コード・支店名」というテーブルを考え、会員番号を候補キーとしましょう。（つまり、会員番号は全社で一意な番号となっています。）会員番号が決まれば、氏名と所属する支店コードが特定できます。そして、支店コードが決まれば支店名が特定できます。この結果、会員番号が決まれば、推移的に支店名も特定できます。これが、推移的な関数従属です。 　このテーブルが第２正規形は満たしていることに注意してください。候補キーは、会員番号のみですので、氏名・支店コード・支店名のいずれも、候補キーの一部分には関数従属していません。 　さて、では、もう少し補足です。 　＞「第一正規化」では、データの重複をなくす事をする 　すこし違いますね。データの重複がないことは集合としての条件で、正規化以前の話です。 　＞「第二正規化」では関数従属をおこないxの値が決まればyの値が決まるのと同じように あるキーが決まれば、他のキーも決まるようになること 　これも、少し残念。キーの一部分で決定できる項目がないようになることが目標です。 　＞「第三正規化」では関数従属をなくすと聞いたんですが、意味がわかりません 　意味がわかったら、ある意味大変です。関数従属がなくなったら、データベースとして形をなしません。 　なくすのは、「推移的な関数従属」です。「関数従属」を無くしてしまったら、データとしてのつながりがなくなる・・・つまり、テーブルとして存在しなくなってしまいます=^・・;=。
＃３です 申し訳ありません。 各フィールドの型を記述していませんでしたね。 テーブル「TA」では、LV（数値型/長整数）、その他はテキスト型 テーブル「TB」では、LV（数値型/長整数）、SLV はテキスト型 　（テーブル「TB」の主キーは　LV） たぶん、この型があっていなかったので、コンボボックスの SELECT TA.ID, TA.名前, TA.PWD, TB.SLV FROM TA LEFT JOIN TB ON TA.LV = TB.LV; が取得できていなかった可能性があります。 デザインで、この「値集合ソース」の表示部分をクリックすると、 右側の SELECT・・・・が反転表示になると思います。 その状態で、右側の[・・・]をクリックすると、クエリのデザインの様な表示になります。 「F_LOGIN：クエリ ビルダ」の表示部分で、マウス右クリックし、 「データシート」表示にしてデータがどう並んでいるか確認してみます。 OK なら保存して終了です。 標準モジュールへの変更は＃３の通りです。 確認するフォーム「F_MENU」は＃２から変更なしです。 （コントロール名に _ が付いている状態のものです） また、私が確認したのは、テーブルを以下の様に設定していました。 テーブル「TA」 ID　　名前　　PWD　LV A1234　AAAA　1234　1 B1234　BBBB　1234　2 C1234　CCCC　1234　3 D1234　DDDD　1234　6 テーブル「TB」 LV　SLV 1　,2,3,4, 2　,2, 3　,3,5, 4　,4, 5　,5,1, これで確認できると思います。 （上記では D1234 さんがオールマイティ） 繰り返しになりますが、 他のフォームでも同じように Enabled 設定したかったら、そのフォームに Private Sub Form_Load() 　　Call FrmLevelSet(Me) End Sub を記述するだけです。ただ、コントロール名は命名規則に従っている事が前提です。 また、 Call FrmLevelInit ' 初期化　を記述するのは、ログアウトする直前の最後の最後です。 途中初期化してしまうと情報が消えてしまうので、再ログインが必要になります。 ２）の方法で良かったんでしょうか。 押しつけるつもりはありませんので、良い方法が見つかればそちらの方で・・・・ ※　２）はレベルをコントロール名に持っていましたが、この部分にタグ（Tag）を使う 　　っていう方法もあります。雰囲気わかっていただけるかと思います。 ２）で「btn_4」となっていたらタグ（Tag）に ,4, を設定しておいてコントロール名は自由に >　　i = InStr(.Name, "_") >　　If (i > 0) Then >　　　　If (InStr(sUserLevel, "," & Mid(.Name, i + 1) & ",") > 0) Then >　　　　　　.Enabled = False >　　　　End If >　　End If 部分を 　　If (Len(.Tag) > 0) Then 　　　　If (InStr(sUserLevel, .Tag) > 0) Then 　　　　　　.Enabled = False 　　　　End If 　　End If に変更するだけです。 この方法では、タグ（Tag）は書き換えれませんが、 テーブル「TB」の SLV 変更で、途中からでも変更要求には対応できます。 おかしな所等ありましたら、補足いただければと・・・
回答でなくて申し訳ありませんが、質問をする際には、もっと詳しい情報（使っているソフト等）を教えて頂かないと、答えようがありませんよ。
MS-Access 2000での例。
> できれば一つのクエリで上記の結果を表示させたいのですが 一つのクエリの定義が微妙なところですが、以下でどうでしょう？ ※検品テーブルへのレコード展開はなされているものとしています。 ※インデントのため全角スペースがあるので注意してください。 ※表示順は、得られた[コード]の昇順にしています。 select t1.コード, t2.数量 as 数量合計 from マスターテーブル t1 inner join 受注テーブル t2 on t1.コード = t2.コード where t1.印刷フラグ = 'YES' union select t3.コード, count(*) as 数量合計 from 検品テーブル t3 where t3.コード in (select t4.コード from マスターテーブル t4 　where t4.印刷フラグ = 'NO') group by t3.コード order by 1 ;
http://zipcloud.ibsnet.co.jp/ 郵便番号データはこちらをすすめます http://typhoon.yahoo.co.jp/weather/jp/warn/14/ http://typhoon.yahoo.co.jp/weather/jp/warn/23/ http://www.jma.go.jp/jp/warn/320_table.html http://www.jma.go.jp/jp/warn/329_table.html もし自分なら　気象庁　の地域を参考にします http://cpf.uub.jp/seirei.html http://cpf.uub.jp/chukaku.html http://cpf.uub.jp/tokurei.html 政令市　中核市　特例市　はある程度の規模なので 分割が必要なのかもしれません http://www.water.city.nagoya.jp/user/renraku/ren … 名古屋では水道局などが情報でありました http://www.iezo.net/tiikinavi/aichi/nagoya/ 学区で分けるとか https://www.google.co.jp/search?num=100&hl=ja&sa … 個人的には　食べログを逆検索で地域をリストアップするプログラムなど用意します
表をコピーして、貼り付けたい場所を右クリック＞形式を選択して貼り付けをクリック、「すべて」から「数値」を選択すればいいのでは
＞桐の　どのメニューから選べばできるか　ご存じの方　教えてください 入力フィールドを右クリックらしいです。 ＞カレンダーを利用して　日付データを　入力 カレンダー入力コントロールは提供されてないので、カレンダーを模した入力フォームを自作する必要があるのだそうで。
2行目がファイル名だけということではないですよね。 計算式はいろいろありそうですけど =GetValue ( Substitute (オプジェクト ; "/" ; "¶" ) ; ValueCount ( Substitute (オプジェクト ; "/" ; "¶" ) ) ) とかはどうですか。オブジェクトはオブジェクトフィールドのことです。 オブジェクトフィールド内の「/」全部を改行に変更して最後の行の値を 取得する式です。ファイル名に「/」があるとダメですけど。
> 二度手間を避けるため、一度入力した顧客コードを空のフォーム上に表示させるには > どうすればいいでしょうか。 「メインメニュー」フォームにテキストボックスを配置して、名前を txt顧客コード とします。 ここに、「顧客登録」に表示させたい顧客コードを入力します。 埋め込みマクロのWhere条件式で [顧客コード]=[Forms]![メインメニュー]![txt顧客コード] と設定します。 「顧客登録」フォーム上の「顧客コード」テキストボックスの既定値プロパティを =[Forms]![メインメニュー]![txt顧客コード] と設定します。 以上でどうでしょうか。
全パターンというのは、最終的に値が取れないものも含めてでしょうか？ 値が取れるものすべて、ならば少し変えるだけで済みます。 http://ideone.com/fQFUC
「(4)検索実行（クエリ）」とは具体的に何をしているのでしょうか。 検索結果表示（フォーム） を開くときに引数で抽出条件を設定するか、抽出条件を設定したクエリをレコードソースにしておけば、抽出結果を表示出来ると思いますが。 普通は、クエリを実行する必要はないと思います。 一度、「(4)検索実行（クエリ）」の処理を削除して試してみてください。 それでも解消しないなら、「検索」ボタンの埋め込みマクロの最後に、 「オブジェクトの選択」アクションで検索結果表示（フォーム）を選択する処理を追加すればどうでしょうか。
最初の回答者の方と重複しますが 問題MDBを自身のPCにコピー。 Accessで空のMDB作成 （初期値はDatebase1.accdbになってますので拡張子をmdbに変更） （Access2003以前では使用しないのならばaccdbでも可） 空のMDBの、ファイル→オプション→カレントデータベース の名前の自動修正オプションのチェックは全て外す。 一旦MDBを閉じる。 再度開いて、リボンの外部データで問題MDBを全て、 この新規MDBにインポートする。 新規MDBでオブジェクト名が正しいか等、 VBAでは参照設定に参照不可になっているものがないかチェック。 その他諸々のチェック。 問題が無いのを確認したら、MDBを閉じる。 新規MDBのコピーを作成し（最適化の時に壊れる可能性を配慮） 新規コピーMDBを開いて最適化を試みる。 ■解決するかどうかの保証は出来ません。■ ※ファイルサイズが2GB近いならAccessの仕様の限界です。 テーブルにOLEオブジェクトの埋め込みでもしているのでしょうか？ もし問題が解決したとしても、ファイルサイズが2GB近いのなら 早晩また問題が発生する可能性があると思います。 また、Accessからも警告メッセージが出ていたはず。 なお、ファイルを共有しているので 「閉じる時に最適化」のオプションにチェックは入れないように。
その式では、「[Forms]![frm検索1]![消費者名]」で始まるデータを抽出することになります。 そのような名前の消費者が存在するはずもないので当然0件となります。 ""から出して & で連結しましょう。 Like [Forms]![frm検索1]![消費者名] & "*"
修正したときのみ、「元に戻す」を実行するようにすればいいでしょう。 修正したかどうかは Dirtyプロパティで調べられます。 　　条件　　　　　　　　　　　　　　アクション　　　　　　　　引数 [Forms]![フォーム名].[Dirty]　　コマンドの実行　　　　元に戻す
すみません。 t2の抽出条件が抜けていましたね・・・ ただ、No.4の補足にある >inner join t2 on (t2.key = (SELECT key FROM t2 WHERE name = 't2_name1')) では正しくないです。 こうしてしまうと、t2とt5の結合条件がなくなってしまうので、 t2に存在しない、t5の'2011-03-03'のレコードまで抽出されてしまうことになります。 ですので結果が13300になってしまいます。 >inner join t2 on (t2.key = (SELECT key FROM t2 WHERE name = 't2_name1')) こうではなくて inner join t2 on (t2.key = t5.t2_key and t2.name = 't2_name1') とすればいいです。 なので、 select sum(t5.amount * (t4.percent / 100.0)) result from ( 　( 　　select strftime('%Y', date) year, t2_key, t3_key, amount 　　from t5 　　where strftime('%Y', date) = '2011' 　) t5 　inner join t2 on (t2.key = t5.t2_key and t2.name = 't2_name1') 　inner join 　　( 　　　select t4.* from t4 　　　inner join t1 on (t4.t1_key = t1.key and t1.name = 't1_name1') 　　) t4 　on (t5.t3_key = t4.t3_key and t5.year = t4.year) ); これでどうでしょうか。 参考URL：http://ideone.com/86dQY
下記のSQLでどうでしょうか。 select top 1 * from mydata where 'P2342' Like key1 & "*" order by key1 desc;
> 下記の変換方法だと、「丁」や「-」がないものは空白で返してしまう。 > Left([番地],InStr(Replace([番地],"丁","-"),"-")-1) この部分だけが解決すればよいですか。 解決方法）InStr に与える文字列に必ず "-" が存在する様に加工する。 例えば、Left([番地],InStr(Replace([番地] & "-","丁","-"),"-")-1) とか、Left([番地],InStr(Replace([番地],"丁","-") & "-","-")-1) で、どうでしょうか
＜困っていること＞： 「会社検索フォーム」から顧客を選択後、「会社登録フォーム」では、支店情報は変わりますが、本社情報が変わりません。 （メッセージ：「リレーションシップが設定されたレコードがテーブル'支店テーブル'にあるので、 レコードの削除や変更を行うことはできません。」というメッセージがでます。） ----------- この点について、リレーションシップの結合の種類のところでフィールドの連鎖更新を許可していないのではないでしょうか。調べてみてください。
管理番号とデザイン内容のフィールドオプションで入力値の自動化で 計算式を選んで、式を「" "」にして既存値を置き換えるにチェックす ると複製したときどちらのフィールドも空になります。 スクリプトでやるときは 　レコードの複製 　消去/管理番号 　消去/デザイン内容 　フィールドへ移動[]　--指定しない
＃１です 投稿直前に補足が見えたのですが、読んでません。 INNER JOIN が正しいのであれば、それはそうかもしれません。 LEFT JOIN としたのは、以下の様に friendname に記述された方が name に居なかった時のことを考えただけでした。 元テーブルが以下だった時 name　　friendname aaaa　　bbbb bbbb　　cccc cccc　　aaaa dddd　　gggg eeee　　bbbb ffff　　eeee ＃１での表示結果は name　　friendname　　friendname2 aaaa　　bbbb　　cccc bbbb　　cccc　　aaaa cccc　　aaaa　　bbbb dddd　　gggg　　 eeee　　bbbb　　cccc ffff　　eeee　　bbbb となるだけです。
SQLの土俵はなんですか？ あと、カンマの後ろに半角スペースを入れる習慣をつけると読みやすいですよ。 select book.author, sum(book.money * daityou.cnt) from book, daityou where book.bookname = daityou.bookname group by book.author ;
＃１です 訂正です。 以下の様なデータがあった場合は想定していませんでした。 ID 判定 日本語　　　英語 ・・・・ 11　　 o 　テスト　　　tests 12　　 o 　テスト　　　tests １）での ORDER BY 日本語, ID　は、ORDER BY 日本語, 英語, ID　としてください。 ２）での　日本語=Q2.日本語　の後に、 AND 英語=Q2.英語　を追加してください。 重複クエリを使った例になっていなかったので、 １）は、 SELECT Q1.ID, Q1.判定, Q1.日本語, Q1.英語 FROM TE AS Q1 INNER JOIN (SELECT 日本語, 英語 FROM TE GROUP BY 日本語, 英語 HAVING Count(*)>1) AS Q2 ON (Q1.日本語=Q2.日本語) AND (Q1.英語=Q2.英語) ORDER BY Q1.日本語, Q1.英語, Q1.ID; ２）は、１）を「Q_TE_1」名で保存したとして（＃１と変わりありませんが） SELECT ID, 判定, 日本語, 英語 FROM Q_TE_1 AS Q3 WHERE EXISTS (SELECT 1 FROM Q_TE_1 WHERE 判定<>Q3.判定 AND 日本語=Q3.日本語 AND 英語=Q3.英語); なお、これらは更新できない表示となります。 ＃１は、更新可能です。
> チェックボックス付きの一覧が表示されるフィールドと,表示されないフィールド 定義されている内容と、登録されているデータはどんな状態？ 「チェックボックス付きの一覧を表示させる」意味が無い状態とか。 性別フィールドが定義されていて、取りうる値が「男性/女性」の２値なら 「チェックボックス付きの一覧を表示させる」意味はあろうけど チェックボックス付きの一覧が表示されないフィールドは 何万もレコードがあって、登録されているデータの種類も何万とあるなら、 「チェックボックス付きの一覧を表示させる」意味はなさそう。 （例：全国郵便番号簿テーブルの"郵便番号"）
> オプショングループのコントロールソースは何も指定していません。 オプショングループのプロパティ設定が下記になっているか確認。 使用可能　はい 編集ロック　いいえ フォームのプロパティ設定が下記のなっているか確認。 更新の許可　はい
その質問だと asp.net がかわいそうだ。 PageMaker に置き換えられる程度の要件だから結果として PageMaker の評価が良くなっているに過ぎない。 PageMaker は RDB ではなくカード型 DB なので、扱うデータの構造が 1枚の表で表現できる程度なら力を発揮する。 他のテーブルとの連携、プログラミングによるデータ処理のロジックなどは不得意と言える。 また、PageMaker の共有機能がどの程度なのかわからないが、Windows アカウントのグループ情報を使って、あるグループしか表示できないページを作ったりなど、ASP.NET としての可能性をまだまだ知らないだけだと思う。
With Me 　　Debug.Print .Controls("単価_" & cnt) End With とか。 Me("単価_" & cnt) でも参照できます。
質問者さんが書かれていることはリレーショナル型のデータベースが一番得意とすることです。多分全部できると思います。 EXCELだとどうなんでしょうか。VBAの得意な人はある程度のことができる様な気もしますが、データベースソフトならあまり苦労しないで可能です。 高度な使い方ではないので、No.1に書かれているようにFilemakerがちょうど良いのではないかと思います。最初はEXCELなどで、表をつくってみられてはいかがでしょうか。 食器の種類ごとに、整理番号、食器名称、大きさ、形状、色調、用途、数量、保管場所など、１種類につき１行で。 それと、 献立ごとに必要な食器の種類と数量（人数にも依存するでしょうから大皿は何人１枚とか）の表をつくると、献立と人数を入れると必要な食器をリストアップしてくれるなどが可能です。 献立が同じでも、数種類の食器の候補から選ぶのはちょっと考えないといけないような気もしますが、組み合わせの種類が多くないのなら難しくないように思います。 あとは顧客管理や予約管理も一緒にやってしまうこともできます。 EXCELでのデータがある程度できた段階で、Filemakerに読ませればそれなりのデータベースができます。試用版で試してみてはいかがでしょうか。
カスタムダイアログ表示ステップの後ろに Get ( 最終メッセージ選択 ) を入れて分岐していますか？ ボタン１が「OK」、ボタン２が「キャンセル」の場合 If [Get ( 最終メッセージ選択 ) = 2 　現在の（全）スクリプト終了 とか。
レポートの集計機能を使っても、クエリを使っても、どちらでもできます。 レポートウィザードを使えば、レポートの集計機能を使った方法が簡単にできます。 ウィザードによりレポート作成する方法 http://www.microsoft.com/japan/office/previous/x … 上記のページの説明で、集計オプションの指定のところで表示するデータの「集計値のみ」にチェックを入れておくと合計のみ表示されます。 クエリを使う場合は下記の手順で。 クエリを新規作成して、消費者マスターと判定マスターを追加します。 ２つのテーブルを判定コードで連結します。 集計クエリにします。 下記のように設定します。 フィールド____販売店コード___判定コード___判定結果____件数: 消費者コード___料金合計: 料金 集計__________グループ化______グループ化__グループ化__カウント_________________合計 このクエリをレコードソースとするレポートを作成します。 レポートフッターにテキストボックスを2つ配置してコントロールソースを下記のように設定します。 =Count([消費者コード]) =Sum([料金]) これで総件数と総合計が表示されます。
最後に編集したレコードを表示するみたいですから それだけでも良さそうですね。
Null値（未入力値）は特殊な値ですので、=演算子では比較することはできません。Is演算子を使います。 抽出条件欄に Is Null としてください。Null以外を抽出するときは、 Is Not Null とします。
レポートのテキストボックスのコントロールソースを下記のように設定してください。 =Choose([用途区分],"家庭","業務用","その他") ただし、データベースの機能を活かしたお勧めの方法は、下記のようなマスターテーブルを作成してそれを利用する方法です。 T_用途区分 -------------------- 用途区分　区分名 -------------------- 1　家庭用 2　業務用 3　その他 レポートのレコードソースの「ビルドボタン」をクリックして、クエリのデザインビューを表示させて、T_用途区分 を追加して、 用途区分フィールド同士で結合します。T_用途区分の「区分名」をダブルクリックしてフィールドに表示させます。 レポート上に「区分名」フィールドをテキストボックスとして配置します。 こちらの方法ですと、例えば用途区分が増えたり、変更になっても、テーブルデータの編集のみですみます。 最初の方法だと、フォームのコンボボックスやレポートのコントロールソースなど複数箇所の変更が必要になります。
ポップアップメニューにして0～9を入力しても 該当するリストには移動しませんよね。 ドロップダウンリストにして、Aフィールドを 計算値自動入力/既存値置き換え に設定して、計算式を Case ( PatternCount ( Self ; "." ); Substitute ( Self ; Left ( Self ; 2 ) ; "" ) & "様"; Self & "様" ) にする。 トリガにしてもいいけどSelfが使えない・・・
状況がよく分かりませんけど レコードの保存なら、VBA では、Docmd.RunCommand acCmdSave なんですけどね。 Access2000は落としてしまったので違うかも知れませんが ショートカットキーなら F9 や Ctrl + S かな？
ANo.1さんの回答の参照先は Visual Basic の例ですね。 AccessVBAはちょっと異なっていて癖がありますのでVBのコードをそのまま使えません。 ■コントロール名(文字列型)を変数にする場合 Dim　strCtl As String strCtl = "TextBoxName" Me.Controls(strCtl).FontSize = 9 .Controls は省略することもできます。 Me(strCtl).FontSize = 9 ■コントロールオブジェクト（オブジェクト型）を変数にする場合 Dim objCtl　As Object Set　objCtl = Me.TextBoxName objCtl.FontSize = 9
どこかにあるかもしれませんので、写真の検索を行ってみて下さい。
すみません、不都合が二つほど 標準モジュールは Function countStr(s As Variant) As Long 　　Dim i As Long 　　For i = 1 To Nz(Len(s),0) 　　　　If Mid(s, i, 1) Like "[A-z,Ａ-ｚΑ-ω]" Then 　　　　　　countStr = countStr + 1 　　　　End If 　　Next End Function に変更してください。 F1 と F2 のどちらかが Null だった場合のことを考慮。 また、クエリは 判定:iif(countStr([F1]) = countStr([F2]) ,"一致","不一致") にしてください（前回F1どうしを比較してましたorz） これで抽出条件に、"不一致"で出来るハズです。 以下は独り言です。 ギリシャ語のホームページからAccessのフィールドにコピペすると ほとんどの文字が全角文字に変換されてしまいます。 しかし、中には半角文字のままのが少々。 なあぜぇ？？ 少々の半角文字になってしまう文字については nora1962 さんの回答で SELECT regexp_count( 項目, "[a-zA-Zａ-ｚＡ-Ｚα-ωΑ-Ω△□]")　FROM テーブル △□は、その文字を順次一文字づつ追加したイメージです。 にすれば出来ました。 F1の個数:regexp_count([F1],"[a-zA-Zａ-ｚＡ-Ｚα-ωΑ-Ω△□]") F2も同様に 判定:iif(regexp_count([F1],"[a-zA-Zａ-ｚＡ-Ｚα-ωΑ-Ω△□]") = regexp_count([F2],"[a-zA-Zａ-ｚＡ-Ｚα-ωΑ-Ω△□])","一致","不一致") 私は文字について根本的な事がわかっていないので危ない雰囲気 (^^ゞ 私の回答ではpattern をコード中に埋め込んでしまっているので出来ません。 （VBEではShift-JIS？ですのでコピペした時点で半角ギリシャ文字が『?』になります） また前回回答でキャラクタコード云々の事をエラソーに言ってますが、これも忘れてください。 さっぱり判らなくなりました。
変数で設定するパスを間違うとそのアラートが出ます。 photexportが実際にはphotoexportになっているとか？ End Loopも無いですよ。
>「果物の出現回数が多い順に並べる」 ということなら、 select * from tableA x order by (select count(*) from tableA y where y.name = x.name ) ,No とか、 select x.no,x.name from tableA x, (select y.name,count(*) cnt from tableA y group by y.name ) z where x.name = z.name order by z.cnt,x.No とか。 DBにより多少変わるかも。(as句が必要だったりとか・・・）
> 実行結果については、どちらも特にエラーメッセージは表示されず > 画面で見る限りは何も入っていないように見えます。 > 該当項目に移動し金額や日付を入力し更新ボタンをクリックすると > 正常に反映されていました。 ということは値の代入はできているが、表示に反映されてないという状況のようですね。 通常はすぐに反映されるはずなんですが、なにか普通でない設定をしているのかな。 とりあえず、OS、Accessのバージョン、単票フォームなのか帳票フォームなのか、など、 また、標準から変更した設定などがあればご提示ください。 あと、対症法的な対策になりますが、下記のコードを追加してみてください。 Private Sub 単価ランク_AfterUpdate() 　　Me.料金=DLookup("単価","単価マスター","単価ランク=" & Me.単価ランク) 　　 Me.Repaint End Sub あるいは、Me.Recalc を追加してみてください。
すべてのページに表示させたいと言うことですね。 販売店コードフッターで正常に表示されているなら、出力範囲も販売店コードも、 ページフッターに単純に移動させただけで問題なく表示されるはずです。 frm出力範囲 は開いたままにしてますよね。 とりあえず現状の設定してある式をコピーして貼り付けてください。 それと、Accessのバージョンも教えてください。
＃１です。 > デザインビューでは1～3は完成しており、 1～3のクエリをSQLビューで表示して、開示できますか？ （クエリ１・２の日付--Where条件の年月日に関する列定義はどうなってる？）
ＣＭＳにもよるかと思いますが可能だと思いますよ。 例えば、ＣＭＳの代表としてWORDPRESSなどがありますが、この場合、現在のサーバーの管理パネルにログインして、【エクスポート】というものでデーターを抜き出します。 次に新しいサーバーにWORDPRESSのプログラム本体をインストールした後で、同じようにバックアップデーターを復元するを選択すると、そのサーバーに最初のサーバーの時と同じデーターが瓜二つでできます。 もちろん写真などのデーターもすべてコピーできています。 ＣＭＳは基本的にサーバーのデーターベースという機能を使用しますので、サーバーそのものの管理パネルの中にデーターベースの中身をエクスポートできる機能がありますし、復元もできると思います。 ドメインというのは、たぶん独自ドメインのことだと思いますので、ドメインの管理パネルにログインして、サーバーのデーターとして、【ネームサーバー】というところを新しいサーバーの指定するものに変更します。 ネームサーバーというのは、その独自ドメインのURLが呼び出された時に、どのサーバーへそのことを転送するか？という役割を一瞬で振り分けているだけになります。 ネームサーバー変更を行いますと、早ければ１時間後に新しいサーバーの方のデーターを呼び出しますが、古いサーバーと新しいサーバーがまったく同じデーターになっていると、どちらが呼び出されているのかがわかりにくくなりますので、インデックスページなどを少しだけ書き換えたりして、自分でわかるようにしたりもします。
sub 印刷ボタン_click() DoCmd.OpenReport "テストレポート, acViewPreview, , "テスト1 = '" & txt_inputID & "'" を DoCmd.OpenReport "テストレポート, acViewPreview, , "テスト1 = '" & me!txt_inputID & "'" ,openargs:=me.name にしてください。 あとチェックボックスの方なのですが、印刷プレビューだけの場合でもチェックを入れて構わないのでしょうか？ 勝手に印刷時のみと思い込んで回答します。 レポートの其々のイベントに下記のように、といってもYU-TANG さんの受け売りですけど。 Option Compare Database Option Explicit Private IsPreview As Boolean ' プレビュー判定用フラグ Private Sub Report_Activate() 　　IsPreview = True End Sub Private Sub レポートヘッダー_Format(Cancel As Integer, FormatCount As Integer) 　　If Me.Visible Then IsPreview = False End Sub Private Sub Report_Close() 　　If Nz(Me.OpenArgs, "") = "" Then 　　　　Exit Sub 　　End If 　　If IsPreview Then 　　　　' 印刷プレビューの場合の処理 　　　　MsgBox "印刷プレビュー" 　　Else 　　　　' 印刷の場合の処理 　　　　If MsgBox("印刷は無事終了しましたか？", vbYesNo) = vbNo Then 　　　　　　Exit Sub 　　　　End If 　　　　 　　　　CurrentDb.Execute ("UPDATE てーぶる名 SET テスト5 = True WHERE テスト１='" & Me!txt_inputID & "'") 　　　　Forms!テストメインフォーム.Recalc 　　End If End Sub 補足 　　If Nz(Me.OpenArgs, "") = "" Then 　　　　Exit Sub 　　End If はレポートを単独で開かれた場合には何もしないということです。 DoCmd.OpenReport "テストレポート, acViewPreview, , "テスト1 = '" & me!txt_inputID & "'" ,openargs:=me.name でフォームから開いた場合は、openargs:=me.name で名前を渡しています。 蛇足 　　　　If MsgBox("印刷は無事終了しましたか？", vbYesNo) = vbNo Then 　　　　　　Exit Sub 　　　　End If は今回の場合は１レコードだけ？の変更なので邪魔かもしれないです。 多くのレコードの一括変更の場合などの時は入れとくと幸せになれるかも。 ※夏バテ気味で何処かにポカが空いてるかも知れません。。。
提示された情報からは、No.2 の回答の ="住所コード：" & Forms![frm出力範囲]![住所自] & "～" & Forms![frm出力範囲]![住所至] & Chr(13) & Chr(10) & "販売店コード：" & Forms![frm出力範囲]![販売店自] & "～" & Forms![frm出力範囲]![販売店至] & Chr(13) & Chr(10) & "担当者コード：" & Forms![frm出力範囲]![担当者自] & "～" & Forms![frm出力範囲]![担当者至] で問題ないはずです。 情報に間違いがあるか、式に記述ミスがあるとしか思えません。 オブジェクト名に間違いがないか、記述に間違いがなかい注意深く確認してください。全角/半角が違っていたり、空白が入っていたりなど、ちょっとでも違うとエラーになります。 あと、このレポートを開くときに、フォーム「frm出力範囲」は開いたままにしてますよね。閉じちゃったら参照できませんのでエラーになります。
最初のフィールドで愛知県を除外検索実行 次のフィールドで愛知県除外で絞り込み検索
「フォームを開く」マクロの「Where条件式」に提示の式を設定したと言うことでしょうか。 で、希望することは、マクロを実行すると、「パラメータの入力」ウィンドウが開き、標題に「消費者コードは？」と表示されていて、ユーザーが入力した値と一致する[消費者コード]のレコードをフォームに表示させたいということでしょうか。 上記の推測があっているとすると、、、 「フォームを開く」マクロの「Where条件式」に下記の式を設定してください。 [消費者コード]=[消費者コードは？] この推測が違っているのなら、 どこに提示の式を設定して、 どのような動作を希望しているのか、 具体的に説明してください。
テーブルの構造が書いてないので、はっきりとは分かりませんが、式が間違っているというより、そもそもテーブルの構造がおかしいんじゃないでしょうか。 でもまずは式から検討してみましょうか。 私は、やりたいことと式がまったくあっていないと思います。 そのDLookup関数は、次のような動作をします。 テーブル"Q_単価分類別_単価"のレコードで、"商品コード"フィールドの値が Me.商品コード である（つまり当該フォームの"商品コード"テキストボックスの値）であるレコードをひとつ探し、そのレコードの"ShukkaPtn"フィールドの値を返す。 こういうことがしたいんですか？そのテーブルは"ShukkaPtn"という名前のフィールドを持っているのですか？ なお、ドメインをあらわす引数には[]をつけません。 私が想像するに、"Q_単価分類別_単価"というテーブルは、以下のような構造を持っているんじゃないですか？ 商品コード|01|02|03|04|・・・|13|14|15|・・・ そして01などのフィールドに単価がデータとして格納されているのではないでしょうか。 もしそうなら、テーブルの設計が間違っています。 あるいは、クロス集計の結果できたクエリなのかもしれませんが、そのフォームで単価を呼び出すのなら、元のテーブル（ないしクエリ）私はこういう風にするべきだと思います。 商品コード|出荷パターン|単価 そして、そのテーブルには商品コードと出荷パターンの全ての組み合わせとそれに対応する単価が書いてあるのです。 こういう風にして初めて、テーブルがデータベースとして使えるようになります。 例えば、DLookup関数で単価を呼び出すときはこうします。 Me.売上単価 = DLookup("[単価]", "Q_単価分類別_単価", "[商品コード]='" & Me.商品コード & "' AND [出荷パターン]='" & Me.出荷パターン & "'") なお、出荷パターンもテキストデータだと仮定しています。
回答が付かないようなので・・・・ フィールド数が多いのが難点ですが、 パラメータクエリーでごりごり力尽くでやるのは駄目なんでしょうか？ ただこれだけフィールド数が多いと大変ですけど。 検討済みであればごめんなさい。 お邪魔しました。
ビジネス活用事例から見て，(1)(2)(3)すべてNoです。 http://japan.zdnet.com/cio/analysis/35011528/
SDカード内にデータペースを作るちょっと特殊な方法だと削除は出来るけど通常の方法の rom内にデータペースを作るタイプだとrootでも取ってない限りそこにアクセスしてデータを削除することはできない。 アプリの管理画面からデータの削除をするしかない。
CSVとか MDBとか
今までの機能は2007？から削られたようです。 私の場合は、Alt + Tab で切り替えていたのでがっかりです。 代替案としては、最初の方の回答の他には ナビゲーションフォームを作る位しか無さそうです。 http://msdn.microsoft.com/ja-jp/library/office/f … なお、タブの表題の所を、得意先 → 得意先 &1 （半角の数字やアルファベット） 等としておくと、 フォームビューでは、得意先 1 の1の下に _ （アンダーバー？）が付きます。 この状態で Alt + 1 とするとそのタブに移動します。 ですが、いずれにしても以前に比べると・・・ですね。(-"-) MukkuMuku さんが考えられたようですが、私はAPIに関しては門外漢なのでご紹介まで。 http://mukkumuku.blogspot.jp/2010/11/office2010- …
「入力インターフェイスにExcel」 「同時利用者が数十名」 「ADO」で接続してデータ操作 「閉じるときに最適化する」にチェックしておいて、 「ExcelからAccessアプリケーションを呼び出してある資料をレポート出力」 という運用を考えているのですね。 No1、No2の回答でも言われてますが、ADOで接続して接続を閉じただけでは最適化されませんし、CreateObject で Access を起動しているのなら、Accessオブジェクトを閉じた時に最適化されます。 ただし、このような運用は、非常に危険だと思います。 例えば、誰かが ADOで接続してデータ操作しているときに、別のユーザーがレポートを印刷して閉じて最適化されたら、どうなるのか。 あるいは、二人がほとんど同時にレポートを開き印刷後閉じて、同時に最適化が始まったら、どうなるのか。 accdbファイルが破損する危険性が非常に高い運用だと思います。 最適化に失敗してデータファイルが消滅したという報告をまれにWEBでみることもあります。 レポートを印刷するたびに最適化を繰り返すというのはやはり破損の危険性を高めます。 No1の回答で紹介されているリンク先 http://office.microsoft.com/ja-jp/access-help/HA … でも、 > ネットワーク上で複数のユーザーが単一のデータベース ファイルを共有する場合を除き、最適化と修復を自動で行うようにデータベースを設定します。 というようにファイルを共有している場合は、最適化を自動で行うのは推奨していません。 accdbファイルを置いているサーバーが常時電源オンになっているなら、深夜など誰も使用していない時に、あるいは毎朝、電源を入れるならPC起動時に、自動で最適化するようにするのがいいかと思います。 安全性を重視するなら、バックアップをとってから最適化するようにするのがよりいいでしょう。Accessにおいては定期的なバックアップは必須です。 具体的な方法としては、Windowsのタスクで、上記のリンク先の最適化ショートカットのコマンドを実行させるようにします。
オートナンバー型は長整数型です。 『4 バイトで、-2,147,483,648 ～ 2,147,483,647の範囲の整数を表すデータ型。Visual Basic では、キーワードは Long で、型宣言文字はアンパサンド (&) です』 限界に達したらどうなるかというと オートナンバー型フィールドが上限値を超えた場合はどうなる？ http://www.ruriplus.com/msaccess/Exp/Exp0901.htm 負の数を使い始めたら入力の並び替えには使えませんね。 もっとも、その前にAccessでは重たくて。。。 道草ですが日付時刻型に時刻の部分も入れれば（Now()とかで）もっと使えます (＾＾ゞ データ型の限界の前にAccessが過労死するのは間違いないと思います。 『倍精度浮動小数点数型 (Double) の変数は、IEEE 64 ビット (8 バイト) の浮動小数点数の変数です。負の値は -1.79769313486231E308 ～ -4.94065645841247E-324、正の値は 4.94065645841247E-324 ～ 1.79769313486232E308 の範囲の値をとります。倍精度浮動小数点数型の型宣言文字はシャープ記号 (#) です。』 >初期値（１からスタート）に戻すこと 『Access オートナンバー リセット』でGoogleって見てください。 http://support.microsoft.com/kb/812718/ja テーブルのオートナンバーを振りなおす方法（β版） http://www.f3.dion.ne.jp/~element/msaccess/AcTip … などなど。 AccessClub.jp さんが見えなくなってる？。
UTF-8 で間違いはないのでしょうかね。 以下思いついたことです。 １・BOMの有無で読み込みが変わらないか。 ２・Shift-JIS に変換してしまったら・・。 ３・ADODB.Stream で読み込んだら。 http://d.hatena.ne.jp/replication/20091117/12584 … ４・Excelに一旦読み込ませたらどうなるか。 ５・テキストファイルをそのままデータベースとして開いたら。 http://home.att.ne.jp/zeta/gen/excel/c04p47.htm そちらのAccessのバージョンが不明なので "Provider=Microsoft.Jet.OLEDB.4.0;" & は "Provider = "Microsoft.ACE.OLEDB.12.0;" かも知れない。 Ｘ・もしかしてファイルが壊れてる？ そのファイルの製作元にShift-jis で出力できないか頼んでみる。 以上、ご参考まで。
ANo.2さんの方法で可能だと思いますが、クリエ一つでやりたい場合は、 テーブルからクエリを作成して、STOCK の抽出条件に下記の式を記述 In (SELECT ID FROM TABLE WHERE STOCK Is Null) AND Is Not Null SQLだと、 SELECT ID, STOCK FROM TABLE WHERE ID In (SELECT ID FROM TABLE WHERE STOCK Is Null) And STOK Is Not Null; これは、ANo.1さんのSQL の = を In に変更しただけです（複数の結果を返すサブクエリに = は使えない）。 他にも、 SELECT ID, STOCK FROM TABLE INNER JOIN (SELECT DISTINCT ID FROM TABLE WHERE STOCK Is Null) WHERE STOK Is Not Null; とか、いろいろあります。
質問者様はグラフに表示された数式と同じワークシートの数式を正しく作成されています。 （実際の数式ではyはなくxのところにセル参照が入っているのですよね） 元データと合わない原因ですが、グラフに表示された数式の係数の精度不足ではないでしょうか。 それが原因であれば、グラフに表示された数式の表示形式を変更して係数の精度を上げ、その数値でワークシートの数式を作り直せば多くの場合解決します。 どのような数値でも精度良く表示するためには、表示形式を指数にして小数点以下14桁にするとよいと思います。 ご存知かもしれませんが、以下念のためグラフに表示された数式の表示の変更方法を説明します。 Excel2003とExcel2007についての解説となりますが他のバージョンも大きくは違わないと思いますのでそこのところの対応はよろしくお願いいたします。 １．グラフに表示された数式を右クリック ２．2003なら「データラベルの書式設定」をクリック、2007なら「近似曲線ラベルの書式設定」を左クリックする。 ３．書式設定のダイアログが出るので、「表示形式」を左クリック（2003は上、2007は左上。最初からクリックされた状態になっている可能性あり。） ４．「分類」（表示形式）の「指数」を左クリック。（「数値」はNG） ５．「小数点以下の桁数」を14にする。（最大30だが「分類」（表示形式）が「指数」ならば15以上は無意味。Excelの精度が15桁であるため。） ６．「OK」を左クリック なお、質問者様の作成された式の「2*POWER(10,8)」の部分ですが、「2*10^8」「2E+08」「2e8」などとしても数式の値としては同じになります。
それは、選択クエリです。 http://www.geocities.jp/haku1569/pasocom/microso … 更新クエリに変更してください。 2007以降ならクエリをデザインビューで開けば リボンの中に『更新』てのが有ります。
aliasは，あるSQL文において定義され，そのSQL文の実行中に限って一時的に使用できる別名です。 synonymは，create synonym文によって定義され，他のオブジェクトからも永続的に使用できる別名オブジェクトです。 シノニムも エイリアスも「別名」ですか？　と問われれば，はいそうです，と答えますけれど， シノニムと エイリアスは同じ意味？　と問われたなら，いいえ違います，と答えます。
アクセスで空白がグループ化されない http://oshiete.goo.ne.jp/qa/7600416.html という場合もありますので、抽出条件には NZ([フィールド名],"") = "" NZ([フィールド名],"") <> "" で分けた方が良いかと。
こういうことですか。 Table1 ユーザーID,商品ID,数量 001,ABC,3 001,XYZ,2 002,FFF,4 だとして、種テーブルを一個作ります テーブル名：Tno Rno 1 2 3 4 ・ 数量の最大値を超えるまで連番で。 クエリのデザインビューに上記のTable1とTnoを加えます 結合線は引きません。 フィールド：ユーザーID｜あれ:1|　　数量｜Rno テーブル：　　　Table1｜　　　｜Table1 ｜Tno 表示：　　　　　　レ　｜　レ　｜　レ　 ｜レ 抽出条件： 　　　　　 ｜　　　｜　　　 ｜<=Table1.数量 これで確認してOKなら、数量とRnoの表示のチェックは不要です。 かな？
Values の中に Select は書けません。 下記のように書いたらよいはずです。 INSERT INTO TableA SELECT COUNT(*), 'データ' FROM TableA 参考URL：http://office.microsoft.com/ja-jp/access-help/HP …
テーブル名を、T1 として 品番　数量　場所 A　　　100　　上 B　　　 50　　上 B　　　 30　　下 ならクエリをSQLビューで表わすと SELECT 品番, (SELECT Sum(数量) FROM T1 AS Tx WHERE T1.品番= Tx.品番) AS 数量2,場所 FROM T1 ORDER BY 品番; で 品番　数量　場所 A　　　100　　上 B　　　 80　　上 B　　　 80　　下 になりますので、レポートで品番と数量2の重複レコード非表示にすれば 品番　数量　場所 A　　　100　　上 B　　　 80　　上 　　　　　　　下 の様にはなります。 （レイアウトが崩れていたらメモ帳などで等幅フォントで見てください） 添付図のように品番と数量を上下センターに収めたい時は・・・ http://www.accessclub.jp/bbs/0231/beginers72024. … のhatena さんのレスをご参考に。 中途半端な回答で御免。
Accessの場合も、Accessというソフトとデータが入ったファイルの2つが必要ですよね。 サーバにインストールされているデータベースソフト（Accessのようなもの）上で、データファイルが1個持てますという意味です。 PHP自体にはデータベース機能はありませんので、PHPからデータベースソフトに接続して、データベース内のデータを検索したり、あたらなデータを登録したりして使用します。
＞通常、これを開いたときにODBC接続用のダイアログ画面が表示されると思うのですが、 これが接続認証用（パスワードを入力等）の画面でしたら、テーブルリンクの作成画面にある「パスワードの保存(V)」にチェックを入れてリンクを作ってください。
開始日と終了日は必ず同一日でよろしいですか。 表示先はクエリでよろしいですか。 各々のクエリのデザインビューで下記のように設定してください。 日別の集計 フィールド______ 日付: DateValue([開始日時])________検査内容_____________件数: 検査内容 集計______________ グループ化_________________________________グループ化___________カウント_________ 並べ替え________ 昇順________________________________________________________________________________________ 表示_________________ レ_____________________________________________ レ_______________________ レ______________ 月別の集計 フィールド______ 月: Month([開始日時]) __________________検査内容_____________件数: 検査内容 集計______________ グループ化_________________________________グループ化___________カウント_________ 並べ替え________ 昇順________________________________________________________________________________________ 表示_________________ レ_____________________________________________ レ_______________________ レ______________ SQLでは、 日別 SELECT DateValue([開始日時]) As 日付, 検査内容, Count(検査内容) As 件数 FROM テーブル名 GROUP BY DateValue([開始日時]), 検査内容 ORDER BY DateValue([開始日時]); 月別 SELECT Format([開始日時],"yyyy/mm") As 月, 検査内容, Count(検査内容) As 件数 FROM テーブル名 GROUP BY Format([開始日時],"yyyy/mm"), 検査内容 ORDER BY Format([開始日時],"yyyy/mm");
こう? SELECT t1.name AS site_name, t2.* FROM stock_sites AS t1 LEFT JOIN stocks AS t2 ON t1.id = t2.stock_site_id and t2.item_id = 1 ORDER BY t1.id;
> SELECT tableA.a * (select 1 from tableB) > tableA.b * (select 2 from tableB) > FROM > tableA このようなSQLは文法エラーで通りません。
オリジナル文字列が abc___________ とａｂｃ＿＿＿＿＿ だった時にインポートした時点で末尾の半角スペースは削除されます。 半角文字フィールド｜全角文字フィールド abc　　　　　　　 ｜ａｂｃ＿＿＿＿＿ なので 半角全角のフィールドを結合したいのなら クエリなどで 結合:[半角文字フィールド] & space(14-len([半角文字フィールド])) & [全角文字フィールド] にして行うとか。
データが大量になってくるとデータベースを使うのが便利だと思います 1) No.1で書かれている無料で手に入るOpenOffice(あるいはLibreOffice) 2) 質問者さんが書かれているMS Access 3) それとFileMaker が個人で使われている有名どころです。 曲がりなりにもデータベースですのでそれなりの敷居の高さがあります。 上に書いたものほど敷居は高いように感じます。 私自身は全部使ってみましたが、 a) データ量が多くなりExcelでは対応できなくなった b) データをいろいろな形式で加工し出力したい。 という時には威力を発揮します。 それぞれ試用版がありますので試されてはいかがでしょうか。 http://www.microsoft.com/ja-jp/office/2010/trial … http://www.filemaker.co.jp/products/filemaker.html Excelでやれている間はExcelでやるのも一つの選択かと思います。
ショッピングサイトに行かなくてもあなたのパソコンの中にデータはありますけど？
一番の違いは結合は二つのテーブルのデータ双方を抽出結果に含められるのに対し、相関副問い合わせによるクエリでは一方のテーブルからしかデータを抽出できないことです。 後、評価順序としては外部結合の場合、外部結合がされたのちにWHERE条件の判定が行われます。 相関副問い合わせを用いる場合は多くのRDBMSでは駆動表に対する他のWHERE条件の判定を行った後に副問い合わせの判定を行う傾向がありますが、ORACLEで「PUSH_SUBQ」ヒントを使用したりすると副問い合わせを優先的に判定条件に使用したりできます。 後、「結合は最初に結合された一時的なテーブルを絞りこむ」イメージではなく、可能な限り結合された行を連続的に判定していきます。ソートや集約演算など一時テーブルを作らざるを得ない限りはできるだけ避けている実装が大半だと思います。
当方自慢のソフト　データ復旧モグラで使えば、完全にデータ取れると思います。 無料バージョンでスキャンできますよ。 http://www.p-mon.jp/データ復旧ソフト/
もう解決されているかと思いますが 日付: "" & [Forms]![F_登録]![日付] & "" ↓ 日付: "#" & [Forms]![F_登録]![日付] & "#" かもしれない。 Excelのピボットテーブルは使ったことないので。。。
クエリ上での表示でいいのですよね。 「DJoin関数」でググると、ご希望の事ができる関数が見つかりますよ。
>これを使えば、エクセルのワークシートを、テーブルのように見立てて、そのままxlsファイルの中身を修正変更出来ます。 この機能はMS社が敗訴したために随分と昔に削除されました。 http://pxp.seesaa.net/article/8627654.html
初めまして。 MongoDBのGUIツール作っています。 よかったら使ってみてください！ 　■MongoDB GUIツール 「JMongo」 　　http://d.hatena.ne.jp/moremagic/20120625/1340606 … →Java Swingで実装してあり、環境を選ばず起動できます。 　※Win、Linux　で起動することを確認してます。 ではでは。 参考URL：http://d.hatena.ne.jp/moremagic/20120625/1340606 …
「テキストのみペースト」はショートカットがcommand+option+vに割り当てられています。もしうまく行けば儲け物です。 さて、CiPTというソフトもあります。PlainClipは他のソフトでショートカットを登録しないといけませんが、こちらはその機能がすでにありますし、邪魔にならなければずっと起動しておくこともできます。 http://tama-san.com/?page_id=2 昔は、複数の操作を1つのショートカットに登録できるソフトがあったのですが、今はできるのでしょうか。 それができるのでしたら、command+option+vに、書式情報を取り除くのとペーストの2つを登録しておけば簡単なのですが。
>B側では単にリストで見る程度でレコードを更新、追加、削除はしません >クエリで絞り込んで集計程度はします であれば、B側でロックは発生しませんので 『共有モード』で開いている場合には、 A側でのクエリ・テーブルなどでの更新・追加・削除は支障はありません。 B側で突然レコードが増えたり変更されたりDeletedになって B側の人が驚くくらいです。 ただ、実際には確実にデータが変更されるように、 排他でレコードをオープンしたり トランザクション処理を行う場合がありますから その場合には障害となります（A側でロックに失敗して出来ません）。 蛇足ですがB側でも変更などの可能性がある場合は、格段に難易度が上がります。 相当作りこまないと確実な運用ができません。 ネットワーク上での Access データベースの共有について (MDB) http://office.microsoft.com/ja-jp/access-help/HP … ネットワークでの使用 http://www.naboki.net/access/achell/achell-02.html
質問は ＞日付型で作成してなく、年齢の出し方も分かりません。 ということでよろしいでしょうか？ まず、下記の列を追加します。これは生年月日をまとめて西暦になおしたものです。 生年月日:Format([年号] & [生年] & "年" & [月] & "月" & [日] & "日", "yyyy/mm/dd") 次に、下記の列を追加します。 これは、「年齢計算に関する法律」によって誕生日の前日に満年齢に達することになっているためで、学校教育法の第22条の就学の基準では「子女の満六才に達した日の翌日以降における最初の学年の初から」となっているためです。もし、この年齢ではなく、当日に満年齢になる計算をお望みの場合は、「Date()」だけに修正すればよいです。（基準日がわからないので、動かした当日にしています） 基準日:DateAdd("d",+1,Date()) 最後に、下記の列を追加します。 年齢:IIf(Format(生年月日,"mm/dd")>Format(基準日,"mm/dd"), DateDiff("yyyy",生年月日,基準日)-1, DateDiff("yyyy",生年月日,基準日)) 上記で年齢の出し方は大体分かるかと思います。 あとは年齢をもとに条件にあう列を追加していくことになるか、上記の年齢計算自体を修正するかになると思います。
そもそも、「第3木曜日=第3週の木曜日」は必ず成立するのでしょうか。 仮に、日曜始まりで週を考えるとして、その月の初日が金曜あるいは土曜の場合、 その月の第1週はその土曜までになって、第1木曜日=第2週の木曜日となったりはしないでしょうか。 まあ、この考え方はあくまで私個人のものであって、 「第3木曜日=第3週の木曜日」が必ず成立する、と質問者さんが お考えでしたらよいのですけれど。
7は持っていませんが、ファイルメニューに「レコードをPDFとして送信」 などというのはありませんか？これを（現レコードのみで）実行して メールに添付するだけでいいと思いますが。 PDF保存機能が無くても、ファイルメニューから印刷→PDFがあります。 バージョンアップするとメールを送信スクリプトとともに使って自動化 できます。7の機能が分からないのでここまでですが。
試してみた方が早いのでは？ クライアント条件として FileMaker Pro / Pro Advanced クライアントに、ライセンスされた FileMaker Pro / Pro Advanced 9、10、 または 11 が 1 コピー必要です。 となっていますね。互換性の無い機能を除いては共有出来るとは 思いますけど。
No.2のお礼欄について 基本的には質問者さんの認識でよいと思います。 しかし、データベースをがんがん構築するなんてあまり考えられないのですが。 Filemaker ProやFileMaker Pro Advancedでは少人数での使用を考えた場合に良い選択になると思います。 それ以上になるとFileMaker Server などになってくると思います。 データベースの導入が初めてでしたら、FileMaker Pro Advancedを１ライセンス購入して、必要になったときにFileMaker Proライセンスを追加するのが良いように思います。 Advancedだと個人で名刺管理をしたい場合にも、ライセンスのない他のパソコンで利用できるデータベースが作れますので。
調べてみると良く出ている障害みたいですね。 多いのは何かの原因で異常終了したとき。これはPC再起動で治る。 メモリーが少ないとき。 等々
「ｘｘできない」とか「エラーになる」とかでなく、具体的にどのようなエラーメッセージが出るとか事象を具体的に提示してください。 データ不整合やVACUUMができないなら、必要なデータを可能な限り救出して、データベースを再作成するしかないのでは？ .dump　→ .read　でダンプしてリストアするといった方法があります。ただし、動画などbinaryデータを格納しているなら、selectでhex関数を使って16進数でファイル出力といった工夫をする必要があるかも知れません。 参考URL：http://www.sqlite.org/sqlite.html
ODBC経由ならDAO接続できる気がしますが http://www.accessclub.jp/bbs/0072/beginers27186. … ただ、SQL Serverを利用するということは複数ユーザーからの同時接続の可能性が高いと思います。 カーソルをサーバー側にするのかクライアント側にするのか、共有モードをどうするのかロック戦略をどのように選択するのか注意しないと不整合が起きたり、デッドロックにはまる気もしますが。
>FFFTPで送ろうとしたデータを削除したらデータが消失してしまい ＦＴＰなのでローカルファイルとリモートファイルがあるのだが、どっちを削除したらどっちがどうなったのか？ 当てずっぽで言えば、同期設定しているのに気付かずにファイルを削除したら、ローカルもリモートも一緒に消えたってところか？
簡単なのはリレーション集計です。 別テーブルからの場合、元テーブルの日付から年月を取り出します。例201204とか。 別テーブルに部署とこの年月フィールドを作り、元テーブルとリレーション。 別テーブルにSum(元テーブル::時間)の計算フィールドを作って、部署と年月を入力 すると出ます。もちろん別でブルでは無く元テーブルの自己リレーションでも可能。
> 今一度私がやりたいことを、具体的に説明させていただきます > > 例えば「やまだ」 > 　　　　↓ > この名前をバラバラにした組み合わせを、一覧にして表示したいのです これは、、、最初の質問文からはまったく読み取れませんでしたよ。 最初から具体例を出していただくべきでした。 名前の文字数は一定ではないですよね？ これはちょっと関数では難しいような気がします。 私ではマクロでもちょっとお時間をいただかないと。。。 あるいは、具体例を質問文に書き加えて質問を立て直されたら 回答が早くつくかもしれません。
Accessのバージョンはいくつでしょう？ それによって回答も少し変わるのですけど。 まずはこちらをご覧になって分からなければ ご返答ください。当方2010と2002を所有 複数列のレポートを作成する方法 http://www.nurs.or.jp/~ppoy/access/access/acR008 … 後半部分は『課』をグループヘッダーにして 改ページを『カレントセクションの前』に指定すれば出来そうですが もっと正確なイメージが欲しいところです。 （こちらに関しては解決までの自信はありません）
MySQLを用いて動的に生成されたWebページがSEO的に有効に作ってあるか不利に作ってあるかというだけで，MySQLを使うこと自体はSEOには無関係です。 話は変わってAmazonの場合，ある一冊の本が掲載されたページのURLとして必要な情報は， http://www.amazon.co.jp/dp/477414195X/ なのですけれど，本のタイトルや著者名をURLに組み込んで， http://www.amazon.co.jp/「最速」SEO-~たった28日で上位表示する驚速ビジネスサイト構築術~-デジタル仕事術-芳川-充/dp/477414195X/ という形式で公開しています。Amazonの目に見えて分かるSEOの代表例です。
CSVファイルの段階で36MBもあると、Excelでは辛いかもしれません。 CSVファイルの先頭行の有無にもよりますが、ExcelでADOで開けば何とかなるかも？ ADODBでCSVファイル読み込み＠Excel マクロ・VBA http://www.cocoaliz.com/excelVBA/index/35/
＃２です 訂正です。 ＃２では、＃１の補足を元に、サブクエリ部分を関数に置き換えましたが、 質問を読み直してみると、A, B 逆ですね。 書き方一緒で、内容を逆にしてみて、どうなりますか。
作業セルを使いますが、こんな方法はどうでしょう。 「亜（JIS:0x3021）」～「碗(JIS:0x4F53)」までをランダムに表示します。 セルA1を作業セルとして使うとし、↓を入れます。 =RANDBETWEEN(0,2964) 漢字を表示させたいセルには↓と、入れます。 =CHAR(12321+INT(A1/94)*256+MOD(A1,94))
> 昭和の生まれなら○、そうでないなら×みたいにするにはどうしたらよいでしょう。 昭和の上のテキストボックスのコントロールソースを =IIf(Format([生年月日],"ggg")="昭和","○","×") 「×」を表示しなくてよいなら =IIf(Format([生年月日],"ggg")="昭和","○","") テキストボックスのプロパティで 「境界線スタイル」 「背景スタイル」 を 「透明」 にすることをお忘れなく。
ANo4の続きです。 >この場合、顧客IDもしくは請求番号が重複していて、登録日が同じであった場合「確認」となるのでしょうか？ の対応ですが、遅くなってしまい、すいません。 （ちょっと悩ましかった点があったので。） ANo.3の >D2セルは、=if(isna(vlookup(A2,A$1:A1,1,false))=true,"残し","削除") を =if(isna(vlookup(A2,A$1:A1,1,false))=true,"残し",if(vlookup(A2,A$1:C1,3,false)=C2,"確認","削除")) とすれば、"削除"となるもの(2件目以降)を"確認"にできます。 ※ チェックしている行より上の行（すなわち登録日が同じか後の行）に同じ顧客IDがあったときは、 登録日の列の値を比較して同じなら"確認にする処理"。 あわせて、ANo.4の >H2 =if(OR(D2="削除",E2="削除"),"削除",if(OR(F2="確認",G2="確認"),"確認","残し")) は H2 =if(OR(D2="削除",E2="削除"),"削除",if(OR(D2="確認",E2="確認",F2="確認",G2="確認"),"確認","残し")) とします。 ★この状態では、最初に出現した行が"残し"になっています。 I2 = if(isna(vlookup(A2,$A3:$H$65535,1,false))=true,"",if(vlookup(A2,$A3:$H$65535,8,false)="確認","確認","")) J2 = if(isna(vlookup(B2,$B3:$H$65535,1,false))=true,"",if(vlookup(B2,$B3:$H$65535,7,false)="確認","確認","")) を全行にコピー＆ペーストします。 ※$65535は一番下の行(Excel2003およびその互換モードでの最大行)。確認してその行の値でもＯＫ。 対象行と同一の顧客IDもしくは請求番号の行が確認となっているかどうかを判定しています。 （上記の判定で、同一日のデータのみ"削除"ではなく"確認"になっているはず。） K2 = if(OR(I2 ="確認",J2="確認"),"確認",H2) としてコピー＆ペーストすれば、K列は、 顧客IDもしくは請求番号が重複していて、登録日が同じであった場合「確認」となるはず。 （試してはいませんが。） 注：同一日の顧客IDがあるのだが、より新しい日付の請求番号があるときはどうなるのかな？ D2="確認",E2="削除"となるため、H2="削除"となっており、K2も"削除"とでてくるはず。 ま、試してみていただいて問題あるようでしたら、お礼なり補足なりに記載願います。
スクリプトのウインドウサイズ変更を使うと小さくなりますね。
その仕様は10からで当時は「邪魔」という意見も多くFM社に 改善要望とかを出したものですが、みんな慣れたのかな？ 最近話題にもなりませんね。 裏技は無いです。ステータスエリアを隠すしか。。。
.xls 開く人はいないと思いますよ。 http://excel-macro.16office.com/virus/kikentaisa …
上司に限らず、人の常識は世間の非常識であることはよくあることです。社会人になりたてであれば、こう言われてしまうと萎縮してしまうのはよくわかります。新人は世間の常識がなくても普通ですから、素直に低姿勢に教えてもらうのがよいでしょう。 ただ、ちょっとしたことはさておいて、人にものを聞くときに、自分なりにわかる範囲で調べてからというのは、人に話を聞く前の礼儀です（世間の常識と書くと起こられてしまうかもですが（ｗ）。調べれば自分の力にもなりますし、くれくれ君よりもよっぽど好印象ですよね。新しいことをやるのに時間はある程度犠牲になりますから、5分10分の手間を惜しまず調べましょう。また、せっかく Notes があるのですから、調べたことはローカルのディスカッションデータベースなどを使って走り書きして、後から検索できるようにしておくとよいでしょう。 >正直テキストの量に比べ受講期間があまりにも不足している印象を受けました。 Notes/Domino に限らず、IT系の講習は大概そんなものです。その場ですべてを理解できないのは普通で、仕事で同じ操作や項目に当たったときに見返して思い出しながら知識・経験を習得します。その場ですべて理解できないのはそんなもんだと思ってください。 研修の値段も安いとはいえませんが、相場から言って特別高いわけでもありません。上司がポケットマネーで出しているんじゃないんですから、気にする必要もないでしょう。将来あなたが成長してその分会社に返してあげればいいだけの話です。 >VBのように単純なものではなく、設計構成や言語が数種類混在しているようで想像を絶する難しさでした。 Notes/Domino の開発ってグループウェアの中では簡単な部類に入ります。できることが多いので混乱しますが、使わないものを無理に覚えなければ、非常にシンプルです。むしろ Notes でできることを VB で実装しようと思ったら、めちゃくちゃ大変ですよ。 さて、肝心の Notes/Domino ですが、きちんと学びたいのであれば、まず以下は正しく理解しましょう。 サーバー/クライアント/データベース/フォーム/フィールド（アイテム）/文書/ビュー/認証者/ユーザー/グループ/ACL （アクセスコントロールリスト） これらが理解できれば＠関数は理解しやすいでしょう。エージェントや LotusScriptやフレームなどのほかの設計要素は、その後ですね。ベースを学んでおかないとなかなか理解がすすみません。 これも Notes/Domino に限られた話ではないですが、もともと作ってあるものに手を加えるのは、新しく作るよりも大変です。これ以外の要素も沢山含まれることでしょう。ですが、まずこれらをきちんと理解しておかないと先に進むときに障害となります。 では、どうやって勉強するかというと 1. 本を読む http://www.amazon.co.jp/Lotus-Notes-8-5%E3%82%AF … http://www.amazon.co.jp/Lotus-Domino-Designer-8- … 余裕があれば、管理者編も読んでおくといいでしょう。ちなみに、Notes/Domino は昔からアーキテクチャは変わっていないので、古本屋で Notes/Domino の本を買うのもお勧めです。 2. 資料を見る Notes/Domino は初心者向けの資料がウェブにはあまりないんですが、役に立ちそうなものを紹介します http://blogs.itmedia.co.jp/donino/2008/03/post-b … http://blogs.itmedia.co.jp/donino/2008/03/post-8 … （情報量はいまひとつですが） http://notesmoe.web.fc2.com/ （おまけ） http://www.ibm.com/developerworks/jp/lotus/ldd_t … それとやはりヘルプは大事です。開発者であればデザイナーヘルプを愛用することになると思います。 3. 勉強会に参加する 無料ですので気軽に参加できます。どうにかしたいと思ったら臆さず参加しましょう。 さわってみよう Lotus 製品 http://www-06.ibm.com/software/jp/lotus/events/T … テクてく Lotus 技術者夜会 http://www.ibm.com/developerworks/jp/offers/even … どちらもお勧めですが、さわってみようであれば IBMの技術者さんになんでも聞けますし、夜会であれば、十年・二十年 Notes/Domino をやっている技術者さんたちと一緒にのみに行けます。 >確実に価値観や性格そのものが合わないので、これから先、十数年この上司と関わって仕事を続けていく自信がありません。 大きなお世話と前置きした上で、人間関係は働く上で大事な要素であることは理解できますが、他人が嫌だから自分の人生を曲げるってもったいなくないですか？少なくとも数年頑張ってみて、自分のやりたいことをほかに見つけて先に進んだほうがご自身にとっても有意義なはずです。 あとはあなた次第です。応援してます！
「未入力」と「入力するものがない」を区別できる。 たとえば、顧客名簿の電話番号を入力するところを考えてみてください。入力を忘れて登録すると Null になります。でも、顧客が電話番号を教えてくれない場合はどうしましょう。この時は空文字を入れることにします。こうしておくと、値が Null のレコードを抽出すれば、入力忘れがチェックできます。 Null と空文字は見た目で判定できないので、実際には Null を禁止したりします。そうすると、空白に見えるのはすべて空文字になります。つまり、「空白に見えるけどこれは入力忘れじゃないんだな。入力するデータがなかったんだな」とわかります。 これは一例ですが、参考URLも似たようなこと言ってます。 参考URL：http://kotori.tea-nifty.com/kotoriblog/2005/08/n …
DoCmd.OpenFormの引数OpenArgsに値を持たせ、フォーム・メイン側Form_Loadあたりで制御するのも一つの手かと思います。
＃２です 参照先をみて悩まれているようでしたら、以下でわかるでしょうか。 理解されていましたら、余計なお世話という事でスルーしてください。 帳票フォームの「得意先ID」を入力する部分がコンボボックスになっている。 つまり、コントロールソースが 得意先ID コンボボックスには、得意先名が表示されている、とします。 下側に配置するコンボボックス名を「コンボ後」と仮定します。 値集合ソースを SELECT 得意先ID, 得意先名 FROM Q得意先; 列数：２ 連結列：１ 列幅：0cm;3cm （得意先ID は表示しない様に） 入力チェック：はい コントロールソースは 得意先ID 検索文字列を入力する非連結テキストボックス名を「txt検索」と仮定します。 上記で出来上がった「コンボ後」をコピーし「コンボ前」とします。 「コンボ前」のプロパティを変更していきます。 値集合ソースを以下に変更 SELECT 得意先ID, 得意先名 FROM Q得意先 WHERE IIF(IsNull([txt検索]),True,検索カナ LIKE '*' & [txt検索] & '*'); 背景スタイルを透明にします。 「コンボ後」のタブストップを「いいえ」にした後、 「コンボ後」「コンボ前」を重ねます。（「コンボ前」が上（前面）になるように） そして、以下のイベントで処理します。 Private Sub txt検索_AfterUpdate() 　　Me.コンボ前.SetFocus End Sub Private Sub コンボ前_Enter() 　　Me.コンボ前.Requery End Sub Private Sub コンボ前_GotFocus() 　　Me.コンボ前.Dropdown End Sub なぜ、重ねるか 「コンボ前」は絞り込まれた内容になります。 そこに、連結した「得意先ID」がなければ何も表示されません。 ですが、 背景スタイルが透明になっているので、透けて「コンボ後」の表示が見えます。 「得意先ID」があれば、同じ文字列を表示することになるので、 重ね方がズレていなければおかしくはなりません。 「コンボ前」は、フォーカスを得ると透けなくなるようです。 「txt検索」が帳票フォームのどの位置に配置されているか、ですが、 ・ヘッダ/フッタ部分であれば上記で終了です。 コンボボックスに並べて、詳細に配置しているのなら、 処理しているレコード（行）以外での表示は邪魔になると思います。 邪魔と感じなければ上記で終了です。 以下は、「txt検索」を隠す方法になります。 ただ、レコードを特定できるもの（オートナンバ等）がなければできません。 この帳票で表示しているレコードにオートナンバ「an」が存在すると仮定します。 ヘッダ部に非表示のテキストボックス「txt0」を配置します。 詳細部分に「txt検索」より、ひと回り大きいテキストボックス「txt1」を配置します。 「txt1」のプロパティを変更していきます。 背景スタイル：透明 境界線スタイル：透明 フォント名：Webdings フォントサイズ：「txt検索」の倍以上 前景色：詳細の背景と同じ色 コントロールソース： 　=IIf(IsNull([an]) And IsNull([txt0]),"",IIf([txt0]=[an],"","gggg")) この「txt1」を「txt検索」に重ねて、「txt1」が上（前面）になるようにします。 上記でのイベントに加え、以下のイベントを追記します。 Private Sub Form_Current() 　　Me.txt0 = Me.an '　　Me.txt検索 = Null End Sub Private Sub txt1_Enter() 　　Me.txt検索.SetFocus End Sub 現在選ばれているレコードを特定できる「an」を「txt0」に設定します。 「txt1」では、選ばれているレコードであれば何も表示しません。 背景スタイルを透明にしているので「txt検索」が透けて見えるようになります。 選ばれているレコードでなければ、文字 "gggg" を表示します。 フォント「Webdings」の時の "g" は塗潰し文字（■の親戚？）になります。 それを表示する時の色が、詳細の色と同じであれば「txt検索」を隠せます。 やってみて隠せなかったら、フォントのサイズ、"g" の個数を変更していきます。 「txt1」にフォーカスが移ろうとした時、透けて「txt検索」が見えているはずなので 「txt検索」を入力/変更できるように「txt検索」へフォーカスを移動します。 フォーカスを得た「txt検索」は、下側に配置したにもかかわらず最前面に出てきます。 フォーカスを失うと、下側に戻っていきます。 レコードを移動した時に「txt検索」をクリアしたかったら、Form_Current　で。 ただ、上記のままでは新規登録の際、表示ズレが発生します。 新規行に入力し始めると、「txt検索」が見えるのは、さらなる新規行に。 編集中の新規行では、「txt検索」は見えなくなります。 見えなくなりますが、あるべきところをクリックすると「txt検索」がでてきます。 「txt検索」は、フォーカスを失うと、また消えてしまいます。 この動きは嫌だと思います。 上記オートナンバを使った時には、以下の処理を入れることで改善されます。 Private Sub Form_Timer() 　　Me.TimerInterval = 0 　　Me.txt0 = Me.an End Sub Private Sub Form_BeforeInsert(Cancel As Integer) 　　Me.TimerInterval = 10 End Sub Private Sub Form_Undo(Cancel As Integer) 　　If (Me.NewRecord) Then Me.txt0 = Null End Sub この所は、レコードを特定するものに何が使えるかで変わってくると思います。 それによっては、「txt検索」は隠さなくて良いや・・・とか、 ヘッダ/フッタ側に配置替えってことも・・・ いろいろと試してみてください。
>アプリ.accdbとデータ.accdbを同一フォルダにおかない場合 同一フォルダに置いてリンク先を更新。それから配布。Or 開発・本番環境のPathをテーブルに保存しておき更新。 ではないでしょうかね。 アプリから複数のデータファイルにリンクを張っている場合は後者。 テーブル名｜本番Path｜開発Path バグ取りや機能追加を行って再配布の場合には どこか（テーブルかファイルのプロパティなど）にバージョン情報をおいて アプリの起動時にチェック。 別のプロセス（VBSや更新.accdbなど）を立ち上げて自身は終了。 更新処理（ユーザーへのコピー？）が終わったら新アプリを起動。 のように行っていました。 （当初はメール告知だけだったのですが替えてくれない方が多かった） （その他にも色々と・・・） 基本的なセオリーは独学のため、よく分かりませんが、 確実・安全・・を考えて行ってみてください。 なお、当方は社内用のモノしか作成したことが有りませんので 社外用やネットワークで繋がっていない場合に関しては門外漢です。 以上、ご参考まで。
>会社のPCのaaa.fp7に私が入力したレコードだけ追加しようと試みましたが >文字化けなどありできませんでした。 どんな事したのですか？特に文字化け。 あなたが持ち帰ったファイルで、追加前のレコードを対象外にして、対象レコードは あなたが追加したレコードだけにしてしておきます。 これを会社のファイルから「新規レコードとして」インポートするの簡単です。 持ち帰ったファイルの既存のレコードは削除する必要はありません。 元ファイルに自動入力等の設定が有る場合は注意が必要です。
前にお知らせしたマクロをサブルーチンとして使い、次のマクロ3を一つ動かすだけで全ての作業が1回で出来ます。もし関心がおありでしたら、詳細をお知らせします。 Option Explicit Sub Macro3() ' ' Macro3 Macro ' マクロ記録日 : 2012/5/8 ユーザー名 : ' Macro9 Macro4 Macro1 Macro5 Macro10 Macro8 Macro2 Macro11 ' End Sub Sub Macro11() ' ' Macro11 Macro ' マクロ記録日 : 2012/5/8 ユーザー名 : ' ' Columns("C:C").Select Selection.AutoFilter Selection.AutoFilter Field:=1, Criteria1:="99" End Sub
警告がセルの色と回収予定日までの日数表示でよいのであれば R列を回収予定日、S列を回収までの日、T列を回収日とします。 U1に　=today()　と入力し今日の日にちを取得します S2に　=IF(R2="","",IF(T2<>"","",R2-$U$1))　と入力します 　（ファイルを開いた日から回収予定日までの日数計算、 　　回収日を入力すれば消える） S2を選択し書式　→条件付書式で次の設定をします 　セルの値が次の間　　→　0から９　→書式　→パターンで色選択　 　追加 　セルの値が次の間以外　　→　0から９　→書式　→フォントで白色選択　 S2を必要な行コピーします エクセル2003です
VBAでShapeを制御してやるとできそうですね。 今、手元にMS-Officeがないので、細かい話は出来ませんが、そのあたりを調べてみてはどうですか？
テーブル名を、T1 とした場合 案１、Dcount関数でクエリのデザインビューのフィールドに追加 F2:IIf(DCount("F1","T1","F1=" & [F1])>1,1,2) 案２、クエリのSQLビューに下記を張り付けてみてください SELECT T1.F1, Tx.F2 FROM T1 INNER JOIN (SELECT T1.F1, IIf(Count(T1.F1)>1,2,1) AS F2 FROM T1 GROUP BY T1.F1) as Tx ON T1.F1 = Tx.F1; 案１は遅いけど、F1のデータ変更が可能 案２は速いが、F1のデータ変更不可です。
年月で自己リレーションして、A,B,C(レコード？)の動的値一覧を 設定すると重複を除いたリストになります。それをValueCount 関数で行数を計算させます。 1例 http://pupld.net/14/120430/y7uogv6qop/index.cgi
これかも知れないですね。 [ACC2003] Access テーブルに対する処理の実行中にエラー メッセージ "ディスクの空き領域またはメモリが不足しています" が表示される http://support.microsoft.com/kb/286153/ja Acc2010 でもレジストリの値は9500でした。 上記リンク中の方法で解決するのでは？と思いますが、 最悪の場合でもテーブル作成クエリ→追加クエリと小分けして行けば よいのでは？
ファイルメーカーを購入してくださ、使いやすいですよ、イメージのことは、すべてできますよ。
Access 2000 か Access 2003 てとこじゃないですかね。 Access 2003 の場合は Windows 2000 に SP3 を当てないとダメだった気がします。
まだ、Office2010(EXCEL、Access)を起動していないためではないでしょうか？ ちなみにSandBoxModeを完全に無効化するためには以下の手順も必要になる 可能性がありますので宜しければ併せてご参照ください。 少し古い情報ではありますが、 http://support.microsoft.com/kb/834600/ja をご参照頂き、Jet4.0のSandBoxModeを変更する必要があります。 一応記載しますとレジストリ HKEY_LOCAL_MACHINE\Software\Microsoft\Jet\4.0\Engine\Engines の SandBoxModeの値を3⇒2に変更してください。 ご存知かとは思いますが、値それぞれの意味付けは以下の通りです。 0：サンドボックス モードは常に無効になります。 1：サンドボックス モードは Access に使用されますが、Access 以外のプログラムには使用されません。 2：サンドボックス モードは Access 以外のプログラムに使用されますが、Access には使用されません。 3：サンドボックス モードは常に有効になります。 　 これは、Access のインストール時に設定される既定値です。 となります。 この設定で
＞二つのうち一つを履修 まぁOracleを学習するに際してSQLの知識は最低限必要なんですけどね オラクルの資格を狙っているわけじゃなく、よくわからないけど 広く浅くIT技術を習得したいならSQLの方が無難かと。 もちろん他の回答者の方も指摘している通り、講義内容がわからない のでなんともいえません。
iOSデバイスは画面全体がボタンのような物です。 例えば、商品を仮テーブルに入力するスクリプトか、ウインドウ切り替え辺りのスクリプトなどが動いているときに画面に触れてしまい、FMが保存動作をしようとしたりすると、スクリプトを中断するか確認を求めてきます。 GO向けにスクリプトを書く際の作法的な物になるのですが、各スクリプトの先頭で「ユーザーによる強制終了を許可」ステップを「オフ」で入れてみて下さい。
↓ここが異常だと思います。 ＞1ページに最大3レコード表示するようにしていて、1レコードの表示項目数が350項目と非常に多くなっています。 毎月ですよね？ ３５０項目もあるデータを360レコードですか？ 誰が見るのでしょうか？ それはレポートじゃなくて生データですよね？ レポートの意味と目的（誰が、何を知りたいために、どれくらいの時間をかけて見るのか？）を考えて、レポートに出す出力を見直すべきと思います。
VBAの組み込み関数は殆ど使用可能です。 以下は一例です。 SELECT Format([フィールド]*0.18),"0.0") AS hoge,・・・ Format関数の戻り値は文字列なので、Accessにも このフィールドが文字列であることを認識させられます。
「ユーザ定義用紙」は、Accessの機能ではなく、プリンタドライバーの機能ですので、 下記の手順で「プリンタのプロパティ」を表示させてそこで設定してください。 「フアイル」⇒「ページ設定」⇒「ページ」で「その他のプリンタ」を選択して、「プリンターの設定」をクリック。 開いたダイアログで、「プリンター名」を選択して「プロパティ」をクリック。 設定方法はプリンタの取説かヘルプを参照ください。
式の上で＋をやめてＳＵＭ関数を使うようにすればよいでしょう。 例えば =SUM(AA5*56000,AC5*76000,AE5*136000)*0.6+SUM(E5*2000,F5*3000,G5*1000,H5*1000,AG5*1000,AH5*1400,AI5*2400)
＞まじですか… まじです。どっちみちExelの表の様な感じのものを作る必要があります。そこで初めてデータベース化ができます。 1000件程度までで検索できれば十分な場合は、データベース化はあえてせずに、OSのもつ全文検索機能に全面的に頼った使い方をしています。PDFのように全文検索用インデックスを作ってくれる形式でファイルに保存し、特定のフォルダに放り込んでおくだけです。 あとは、OSの全文検索機能を使うだけです。 さすがに該当する情報のリスト化はしてくれませんが、リストが必要ないのなら結構実用的ですよ。
No2です。訂正があります。 フィールド　　│　順位:顧客番号　　│　金額の合計　　　　│　顧客番号 テーブル　　　│　Q_売上_1　　　　│　Q_売上_1　　　　　　│　Q_売上_1 集計　　　　　│　カウント　　　　│　Where条件　　　　　│　Where条件 並べ替え　　　│ 表示　　　　　│　　チェックあり　│　チェックなし　　　　│　チェックなし 抽出条件　　　│>[抽出順位]　　│>[Q_売上]![金額の合計]　│ または　　　　│　　　　　　　　│　　　　　　　　　　　　│[Q_売上]![顧客番号] のところで、 抽出条件　　　│>[抽出順位]　　│>[Q_売上]![金額の合計]　│ において、>[抽出順位]　の不等号の向きが反対で、かつ不等号が 抜けていました。 　　　　<=[抽出順位] のように、してください。したがって、 フィールド　　│　順位:顧客番号　　│　金額の合計　　　　│　顧客番号 テーブル　　　│　Q_売上_1　　　　│　Q_売上_1　　　　　　│　Q_売上_1 集計　　　　　│　カウント　　　　│　Where条件　　　　　│　Where条件 並べ替え　　　│ 表示　　　　　│　　チェックあり　│　チェックなし　　　　│　チェックなし 抽出条件　　　│<=[抽出順位]　　│>[Q_売上]![金額の合計]　│ または　　　　│　　　　　　　　│　　　　　　　　　　　　│[Q_売上]![顧客番号] となります。 欠番があった場合はNo2の説明の通りです。 したがって、クエリのSQLビューも以下になります。 SELECT Q_売上.顧客番号, Q_売上.顧客名, Q_売上.金額の合計, Count(Q_売上_1.顧客番号) AS 順位 FROM Q_売上, Q_売上 AS Q_売上_1 WHERE (((Q_売上_1.金額の合計)>[Q_売上]![金額の合計])) OR (((Q_売上_1.顧客番号)=[Q_売上]![顧客番号])) GROUP BY Q_売上.顧客番号, Q_売上.顧客名, Q_売上.金額の合計 HAVING (((Count(Q_売上_1.顧客番号))<=[抽出順位])); また、説明の途中の 　　　>[抽出順位] のところも、 　　　<=[抽出順位] におきかえてください。 Between [最初の順位] And [最終順位] とする場合は、変更はありません。失礼しました。 たぶん、もう間違いはないと思いますが。
日付の集計をグループ化ではなく、Where 条件にすれば よろしいかと。
確認ですが、最初のテーブルは下記の様な7つのカラムを持つという事で良いでしょうか？その前提で書きます。 漫画ID(主キー) | タイトル | タグ | ページ数 | アクセス数 | Upload日 | Update日 分割の際に導入したタグIDは、漫画IDと1対1、タグとは1対多の関係になるという事でしょうか？そうだとすると「タグID」という名前は非常に不適切かと思います。(例えば漫画IDは1つの漫画について1つですよね？) そうでなく、タグに対して1対1になるのでしょうか？そうであれば、タグIDカラムに複数のIDが入る事になるので第一正規化にはなりません。 いずれにせよ、1つの漫画が複数のタグにひも付くのであれば、下記の様に漫画IDとタグのテーブルを作るのが自然でしょう。 漫画ID(主キー) | タイトル | ページ数 | アクセス数 | Upload日 | Update日 漫画ID | タグ　　　(全カラムが主キー) なお、主キーしか無いテーブルが有っても問題有りません。 > これであっているでしょうか？ 各カラムがどの様な意味でどの様な値を持つのか分かりませんので、以下はあくまで憶測です。 上に書いたとおり↓の様に分割したとします。 漫画ID(主キー) | タイトル | ページ数 | アクセス数 | Upload日 | Update日 漫画ID | タグ　　　(全カラムが主キー) タイトル、ページ数、アクセス数、Upload日、Update日 は漫画IDに完全関数従属しているようには思えます。 ですので、正規化という観点からはこれ以上、分割出来ないのはないでしょうか。 アプリケーションの仕様まで含めた観点であれば、いくつか考えられます。 日ごとのアクセス数を記録するのであれば、アクセス数のカラムを除去して↓の様なテーブルを追加することでしょう。 漫画ID | 日付 | アクセス数　　　(主キーは(漫画ID, 日付)) また、Upload日やUpdate日の履歴を記録するのであれば、↓の様なテーブルが出来るでしょう。 漫画ID | Upload日 | 備考　　　(主キーは(漫画ID, Upload日)) 漫画ID | Update日 | 備考　　　(主キーは(漫画ID, Update日)) 参考URL：http://www.techscore.com/tech/sql/SQL16/16_02.html
ちょっと前にSPIRITに統合されなかったっけ？と思いましたが、よく見るとPOSの方ですか。 SAVファイルを「メモ帳」で開いてみた時に、どう見えますか？ 数値や日付等が見える形でざーっと並んでいて、この数値はどんな意味をもつ、というのが分かれば、 PCの技術者ならできなくはないですが、 意味が分からない数値があったり、文字化けしているようなら難しいです。 POSの販売元に依頼してみるしか手がありません。 いづれにしてもデータを引き継ぎたいのなら、多少お金のかかることだと思ってください。 特に別メーカーのPOSに変える場合なら。
残念ながら 私はMacなのでAccessのことは解りません。
フォームの適当なところ（ヘッダーなど）にテキストボックスを一個配置。 名前を仮に『日付既定』とします。 顧客氏名も追加します [日付既定] ----------------------------------- 日付｜顧客番号｜顧客氏名|商品｜金額 3/8｜　　　123｜　　　　|石鹸｜200 3/8｜　　　122｜　　　　|洗剤｜100 日付のプロパティのデータタブ→既定値欄に、[日付既定] 顧客氏名のコントロールソースに、= Dlookup("顧客名","tbl顧客","顧客番号=" & [顧客番号]) 日付と顧客氏名のその他タブ→タブストップを、いいえに でどうですか。 これで新規レコードの『日付』は[日付既定]の値になります。
「id」にインデックス作成してありますか。INSERTに時間かかっているというよりidが同一のレコード検索に時間がかかっている気がするのですが。 解決策は#1さんの書かれているのが一番簡単かなと思います。
１です。 少し使いやすくしてみました。 シート1のイベントウィンドウ？に貼り付けてください。 これでボタンいらずです。 コードを書き込むセルをダブルクリックしたら使えます。 Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) Dim getstr As String Dim rg As Range Dim r As Integer Dim ws2 As Worksheet Set ws2 = Worksheets("sheet2") If IMEStatus <> vbIMEModeKatakana Then SendKeys "{kana}" End If If Target.Column = 5 Then '5はシート1のコードを入れたい列を入れる getstr = InputBox("カタカナで顧客名を入れてください。", "顧客コード検索") If getstr = "" Then Exit Sub Set rg = ws2.Cells.Find(getstr) If rg Is Nothing Then MsgBox (getstr + "は見つかりませんでした。") Exit Sub End If r = rg.Row Target = ws2.Range("c" & r) 'cはシート2の顧客コードの書かれた列を入れる End If End Sub 関数を使う場合、どうしても検索する文字を記入する場所が必要になって、そこのところがネックです。 match関数でそれ以外は解決するんですけれど・・・。
## マクロが使えない前提で（使えるとすぐだけど。） (1)B2の名前の最初のところへカーソルをもっていく。 (2)ctrl +shift + →を押す。 　　B2から??2(最後の列)まで選択される 　（但し、途中にデータが入っていない列がない前提・・・あっても複数回繰り返せば対応可） (3)コピーする。 (4)Ｂ型表に移動して、今から入れたいC??にカーソルを持ってきて、形式を選択して貼り付けで行列を入れ替えのチェックＯｎ。 縦に並んで貼り付けられる。 (5)Ａ型表に戻り営業所名をコピーする。 (6)Ｂ型表に移動して、名前の列でctrl +↓を押すと一番したまでいくから、一列左に移動して、 ctrl +shift + ↑を押す。 営業所名を貼り付けたい範囲が選択される。 (7)貼り付けをする。 これをくりかえす。
POSのデータは、どのようになっていますか？ CSV形式のようなものでしょうかね。 タイトル行の有無や項目間の区切りなど具体例をあげられた方が良いと思います。 Accessなら全てを１テーブルに収めて、クロス集計クエリで求められそうな気がします。
＞8テラみたいな事を書いています そこですか？　気になったのは。とすれば、あなたはこれを作った人の術中にはまってしまいましたね。たぶん、今話題の、占い師とか、マインドコントロールされやすい人なのでしょう。 まず、ＤＢを詳しく知っている人が、この２つを比較検討することは、まずありません。 多くの企業で、この２つを比べて、どちらを導入するか検討したことはないはずです。もしあったとしら、その会社大丈夫ですか？　近いうちにつぶれる企業でしょう。 それを検討した人を選んだ上司も悪いし、その上司を育てた環境とは。 これらの宣伝物は、エンドユーザー又は、会社の管理する側に、新しい視点を向けさせる事が目的です。切り口と言ってもいい。 例えば、ちょっと趣向が違うが、トヨタのプリウスなどの燃費優先の近未来的な車に対して、ベンツやＢＭＷの欧州勢が３リッターのディーゼルエンジンの車をぶつけくるような物です。 わかりにくいか。　欧州ではエコな車としてはディーゼルエンジン者が主流です。これは排気物がガソリンエンジンよりクリーンになると言う事です （日本の車は最近まで規制が低いので、黒いすすをたくさんだしているが、ここ１年くらいの物は改善された。欧州では規制が強く、もともと黒いすすを出すディーゼルは早い時期に撲滅されている）。 なのでエコ。しかし、プリウスは、そんな所では勝負はしてなくて、燃費がよく今ではリッター５０kmになろうとしています。 これもエコ。 もちろん、モーターで走る分、トータル的な排気物は、極端にすくなくなりますが、実はあまりその辺は、売り文句になっていません。ディーゼルは軽油で走るので、燃費を１kmでも少なくすることを考えなくても、家計にはエコですね。 しかし、よく考えてみると、ディーゼルはハイパワーが強みで、船や、トレーラー、戦車など強力なトルクを必要とされる用途に適した物です。逆に小型化（３リッター以下）が難しく、今まで日本車には適していなかったわけです。小型の車に搭載でき、低燃費が日本車の特徴。欧州は小型と言っても２．５リッター以上の小型が主流で、日本にはあわない。 なんて言うように、本来、同じ土壌で比べる事自体おかしいし、意味が在るのだろうか？　と言う概念を打ち破るには、あえて、すり込みと言うか、すり替えを行う事で、新しい視点を、エンドユーザーにもたせるのが、最も効果があり、 そうか！！ なんて思ってくれると、同じ土壌で戦えなくても、実は２００％戦略としては成功です。 それに見事、はまってしまった質問者に、拍手。
いきなりEofだったと思います。
１２個のクエリを作らずともクロス集計クエリで出来そうです。 下記の場合の、日付を製品コードに、担当者を年月日に置き換えて考えてみてください。 http://hamachan4.exblog.jp/4110849/ 具体的なテーブルのデザインや具体例が分かりませんので 的を射た回答はしづらいです。
> 「data、time、comの3つが完全に一致する」 三つの項目がそれぞれ指定された値に一致するものを取得するという事でしょうか？ そうだとすると WHERE 句にそれぞれの条件を AND で繋いで並べれば良いかと。 例) ------------------------------------ SELECT * FROM houmon WHERE date = '3/10' AND time = '17:00' AND com = 'goo'; ----------------------------------------
動的ページの作成 http://search.yahoo.co.jp/search?b=1&n=10&ei=UTF … お尋ねの事は、Ｗｅｂアプリの基本で、エンドユーザーが見るページをいちいち書き換えているサイトはごくわずかです。 通常フォームと呼ばれる検索結果ページを作るだけです。それを 「エンドユーザーが文字を入力して検索」　にするか 「絞り込んで、テンプレート（５万円台とか）をリンク」　 にして見せるかの違いだけです。どちらも上記にあるような動的ページを作成するのが基本です。そのフォームの固定されるデーターだけ編集する場合は、特にデザインの変更であるし、データー部分を変更するのは、データーベースの更新です。 つまり、あなたの場合、デザイン部の更新と、データーの更新を一緒に考えてしまっているところで混乱しているのでしょう。 ＞・利用者が物件を更新する（1人のみ） あなたの立場がよくわかないが、通常、不特定多数の方がデーターを更新する場合（そのデーターにつていは一人ですよね）必要事項をＷＥＢ入力させ、それをＤＢに更新させる場合、別ＤＢに登録させ、内容を精査したあと、特定の時間（真夜中とかアクセスが少ない時間）に、公開用のＤＢに更新をかけます。 何を入力するかわかりませんからね。それに、更新時を随時にするか、時間を区切って更新するかは、そのサイト（Ｗｅｂアプリ）を使うクライアントによりも代わるし、要望によりも変わる。ケースバイケースです。通常、あなたが示したようなのは、時間を区切っているはずです。 ＞・更新はデータベースのみ 当たり前。デザインを変更されてしまったら、何をされるかわかりませんからね。ただ、ブログのように、在る程度、デザインを追加、変更できるように、オプションとして（高く売れる）用意してあるのが普通です。 ＞・サイトへの訪問者がページを開いた（またはF５キーで更新）時に、そのページからデータベースにアクセスしてページを更新する。 これは上記までに回答しています。 ＞・データベースから情報を発信してページを更新したりはできない 意味不明。ＤＢを更新すれば、検索されて、表示される内容も変更されます。しかし、デザインまで変更されるような事がおきないように、サニタジなど、エンドユーザーの入力値、ＤＢのテーブルのそれぞれのカラムはデータ型で管理され、サーバーサイドスクリプトにより、監視されることになる。 逆に言えば、そのように対策をしていないと、表示がへんになったり、サーバーエラーとなります。 つまりＤＢ設計者、構築者、サーバーサイドのアプリの設計者、構築者によって、いかようにでもできますよ。ということ。 なので、 １）～３）のようにあげられた内容は、的外れの仕様で、 ＤＢを使ったＷｅｂサイトの動的変更を理解を深めてください。としか、いいようがない。 ＞データベース自体の変更方法は、専用のツールを使って情報を入力して更新ボタンを押すと、データベースにその情報が送られ上書きされ、物件ページや一覧ページに自動的に反映される。 それは、そのようにする場合もある。ほんの一例にすぎない。 ＞専用のツールがない場合は、sqliteならコマンドプロンプトで開いて更新、エクセルから可能であればエクセルからやる、ということですね。 これも同上 http://search.yahoo.co.jp/search?p=%22%E8%A6%81% … でリストされるように要件定義によります。誰が、何を、どこまで、どのように、求めているのかで、どうにでも設計する事柄なので、注文者に、設計者が、全ての事を考えて、聞く事柄です。 あなたが示したサイトだと、リクルートのsuumo事業部の方が発注者で、そこの要望により、ＤＢにどのように反映され、いつ更新されるかは決まっています。 このようなＷｅｂアプリを構築する場合、 http://search.yahoo.co.jp/search?p=%22Web%E3%82% … なんて検索すると、職種や業務内容が見えてきます。基本的には、 ・ＤＢ構築、管理、運用、知識、技術 ・Ｗｅｂサイト　同上 ・ＨＴＭＬなどのＷｅｂ系ランゲージの知識、経験 ・C++, C#, Java などのプログラム言語の知識、経験 ・Windowsクライアントなど業務アプリの開発経験 ・Ｗｅｂデザイン、開発、経験 が求められます。現在は、それぞれに細分化され、それぞれの担当者が大きな会社だと存在します。 Ｗｅｂアプリの最小ツールでは、最低限でも 管理ツール 　・データ更新系 　・サーバー管理系 　・メンテナンス系 を用意します。管理ツールは、人、物、金しだいです。
> ちなみに、SQL99ですと、もう少しスマートになるのでしょうか？ SQL99 だと WITH 句を使って整理すれば、少しはマシになるかも知れません。 SQL2003 のウィンドウ関数や Oracle の rownum を使えば、かなりスッキリしそうです。 http://ja.wikipedia.org/wiki/%E3%82%A6%E3%82%A3% … http://docs.oracle.com/cd/E16338_01/server.112/b …
放置されていましたので、簡単に １、２は基本的な機能です。レイアウトモードにし、検索したいフィールドを含むレイアウトを作成します。そのとき「レコードを表示」の選択をAにしておきます。データベースAを対象にするという意味です。 次に検索モードにし、該当するフィールドに入力すると、該当するレコードが表示されます。「リスト表示」を選ぶと該当するレコードがリスト表示されます。 ３は、スクリプトを作って、ボタンに割り付けておけば可能です。 参考書として「FileMaker Pro大全」を使っています。古いです。 最近では少し新しい「FileMaker Pro大全 ver.7~9 edition」が出ているようです。網羅的に書かれた分厚い本です。 それ以降出版された本はチェックしてませんので、本屋さんででも確認ください。 FileMakerはバージョンが上がってもほとんど機能は変わりませんので、少し古いバージョンの本でも十分使えます。
ここで質問するよりも、 コメントで問い合わせた方が確実に解決できると思います。 いろいろな技の記事が多くあるので、探してみてはどうでしょう。 「SetWindowPos」でブログ内を検索されるとか 解除の方法は、以下の記事に書かれているような気がします Accessウィンドウを表示しない方法 http://hatenachips.blog34.fc2.com/blog-entry-178 … 変更する前の状態を取得しておいて、それに戻す感じです。 その後のフォームの大きさ変更は、DoCmd.MoveSize でしょうか
フォームのコントロールソースのクエリを 　　　　　　商品ID　　　　｜仕入先｜商品名 Like [Forms]![商品マスタ]![cb検索] & "*" ｜　　｜ 　　　　　　　　　　　　　｜　　　　｜　Like [Forms]![商品マスタ]![cb検索仕入先] & "*" のようにしてみては。| はフィールド間の仕切りのつもり。
この辺りが参考になりそうです。 http://www.hillston.co.jp/filemaker/webkoukai.html 参考URL：http://www.hillston.co.jp/filemaker/webkoukai.html
データベースの勉強から意図的に逃げてたんで詳しくなく手探りです。 なんというかSQLiteの仕様にイラッとしました。 //====================================== http://www.sqlite.org/datatype3.html >Datatypes In SQLite Version 3 SQLite 3におけるデータ型 (中略) >1.2 Date and Time Datatype 1.2 日付と時刻のデータ型 >SQLite does not have a storage class set aside for storing dates and/or times. Instead, the built-in Date And Time Functions of SQLite are capable of storing dates and times as TEXT, REAL, or INTEGER values: SQLiteには日付や時刻を格納して蓄えておくためのクラスはない。そのかわり、SQLiteのビルトインの日付時刻関数は、日付の時刻をTEXT,REAL,INTEGERの値のどれかとして格納する >TEXT as ISO8601 strings ("YYYY-MM-DD HH:MM:SS.SSS"). >REAL as Julian day numbers, the number of days since noon in on November 24, 4714 B.C. according to the proleptic Gregorian calendar. >INTEGER as Unix Time, the number of seconds since 1970-01-01 00:00:00 UTC. TEXTはISO8601の文字列 REALはグリニッジ天文台における、先発グレゴリオ暦 紀元前4714年 正午からの経過日数 INTEGERは1970-01-01 00:00:00 UTCからの経過秒数 >Applications can choose to store dates and times in any of these formats and freely convert between formats using the built-in date and time functions. アプリケーションはこれらのどのフォーマットで日付や時刻のデータを格納するかというのを選択でき、ビルトインの日付時刻関数を使ってこれらを自由に変換できる。 ================================// さて、ISO8601として認められる書式は http://www.sqlite.org/lang_datefunc.html のTime Stringsに乗っている(訳すのは面倒だがわかるだろう) 自分で変換しろってかorz 文字列操作をいちいちやる。 http://ideone.com/5EOaS ユーザー定義関数みたいなものが作れれば楽なんだけどなあ、確かストアドプロシージャって名前聞いたことあるような。うん、あってるか自信ないけど、とりあえず機能的には、それっぽい //=========================== http://www.sqlite.org/whentouse.html >Appropriate Uses For SQLite SQLiteの適切な利用法 >SQLite is different from most other SQL database engines in that its primary design goal is to be simple: SQLiteは他の大半のデータベースエンジンと違って、その主な設計目標は「シンプルである」ことである。 (中略) >Simplicity in a database engine can be either a strength or a weakness, depending on what you are trying to do. In order to achieve simplicity, SQLite has had to sacrifice other characteristics that some people find useful, such as high concurrency, fine-grained access control, a rich set of built-in functions, stored procedures, esoteric SQL language features, XML and/or Java extensions, tera- or peta-byte scalability, and so forth. If you need some of these features and do not mind the added complexity that they bring, then SQLite is probably not the database for you. SQLite is not intended to be an enterprise database engine. It is not designed to compete with Oracle or PostgreSQL. データベースエンジンにおいて「シンプルさ」は、あなたがやろうとしていること次第で、強みにもなるし弱みにもなる。「シンプルさ」を達成するため、SQLiteは、便利だと感じる人もいる他の機能 - 高い同時実行性やきめ細かいアクセス制御、大量のビルトイン関数、【ストアドプロシージャ】、難解なSQL言語機能 (以下略) 等を犠牲にしなければならなかった。 ======================================// …このまま関数に纏めて単純化は出来ないってことねorz その日付時刻関数とやらを見てみましょうかね。 http://www.sqlite.org/lang_datefunc.html ええと、modifierには第一引数に指定された日時に対して操作を加えられる。unixepochは後ろがepochからの秒数を表す数値をDDDDDDDDDD形式にした文字列でない場合には未定義…だから役に立たない。julianday以外は文字列を返しちゃうのでこれしか使えません。julianday関数はさっきも言ったとおり基準日からの日数が帰ります ってことで、さっきちょっと見せちゃったけど こういうふうに書くことになった。 http://ideone.com/5EOaS で、2013年01月12日7時55分1秒と2012年01月12日7時55分1秒の差を求めると、 2012年は閏年なので366.0日が出力されている。だからこれが正しいんだろう。 #と、ここまで書いてから思ったけど、何で3月じゃなくて1月でやったんだろうね、俺
お尋ねしますが、ファームリストはどんなものですか。
他にも、 AC2007のPrintメソッドのバグ - hatena chips http://hatenachips.blog34.fc2.com/blog-entry-223 … AC2007の Split, InStr関数のバグ？ - hatena chips http://hatenachips.blog34.fc2.com/blog-entry-266 … というようなバグもあるようです。（2010で解消してない模様） まだまだ、未知のバグが潜んでいそうです。 個人的に使用しているものはテストも兼ねて2010で作成してますが、業務で使うものは、当分は2003のままで、バージョンアップは様子見です。
フォーム名/コントロール名は同じでしょうか。 以下でどうなりますか。 Private Sub コマンド1_Click() 　　Dim Field1 As String 　　Dim Field2 As String 　　Field1 = "name" 　　Field2 = "cat1" 　　With Me![電話帳サブフォーム].Form.RecordsetClone 　　　　If (.RecordCount > 0) Then 　　　　　　.MoveFirst 　　　　　　Open "C:\ListMaker\out.csv" For Output As #1 　　　　　　Write #1, Field1, Field2 　　　　　　While (Not .EOF) 　　　　　　　　Write #1, .Fields(Field1), .Fields(Field2) 　　　　　　　　.MoveNext 　　　　　　Wend 　　　　　　Close #1 　　　　End If 　　End With End Sub ※ Me![電話帳サブフォーム]　は、サブフォームコントロールになります。
在庫は在庫テーブルで管理した方がよいですね ただし在庫の整合性を考えるとその時点で在庫があるか否かを チェックする必要があります とくにバックデートした処理の場合、現時点の在庫をもとに処理すると その時点の理論在庫がマイナスになる可能性がでてきます。 したがって実行時点での在庫理論値を再計算するのが妥当です。 とはいえ、システム稼働時点から在庫をのべで持つのは現実的でないため 月締め処理というのを行い、在庫を確定させます。 一般的な仕組みでいうと m月n日在庫=(m-1)月末在庫+m月1日～n日入庫+m月の1日～n日 となり、(m-1)月末在庫が確定すれば比較的簡単なロジックですが 実際m月に入ってすぐ前月在庫が締まることは難しいのでバッファをもって m月n日在庫=(m-2)月末在庫+(n-1)月入庫+(n-1)月出庫+n月入庫+n月出庫 としておくことで処理速度の向上がはかれます。
ＣＳＶデータを読み込む時に注意しなければいけない点があります。 それはデータ型です。 各項目にデータ型が設定されています。 CSVデータをエクセルで開いた場合などは、これに該当するので注意が必要です。 例えば、テキスト型なのにデータ内容が"0000100"などの数値データです。 これをEXCELで開くと前のゼロがなくなり、100という値に代わってしまう場合があります。 データ型を確認しながら、効率良く処理を行うのであれば、ACCESSなど良いのではないでしょうか。 インポート時にデータ型を選択出来、その結果もリアルタイムで確認が出来ます。 MicrosoftOfficePro以上ならACCESSが入っていると思いますので、試しに処理を行ってみるといいですね。 とりあえず、インストールされているエディタもしくはＦｒｅｅをＤＬして使ってみるのも手だと思います。 それと最後にエンコードも調べて、おいて方がいいですよ。 utf-8やs-jisなどなりますからね。 では、頑張って下さい。
私ならばこうすると思います。 目的は、品名欄に合計１０行分のデータを格納する。 ACCESSのVBAを使用すると出来ると思います。 改行コード（VBLF）を入れます。 ※LINUXなら改行コードはLFです - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * - 簡単な記述　（vba） - * - * - * - * - * - * - * - * - * - * - * - * - * - * - * DIM　STRDUMMY　AS STRING FOR IXS = 1 TO 10 STEP 1 IF IXS = 1 THEN STRDUMMY &= "格納文字列" ELSE STRDUMMY &= VBLF & "格納文字列" END IF　 NEXT IXS このように１０回繰り返せば可能ですね。 多分、こんな感じだと思いますが、頑張って下さい。
No.2です。 > 上記を参考に入力したのですが、 > > パラメーターの入力 > 顧客ID > > と表示されてしまいます。 これは、DSum関数の第3引数の右辺側に指定した『顧客ID』と いう名前のフィールドが、クエリの元になっているテーブル(今回の 例では『テーブル1』テーブル)に存在しない場合に発生します。 (ちなみに、左辺側が存在しないフィールド名だった場合は、クエリ 　のデータシートビューでのエラー表示になります) ですので、『テーブル1』の各フィールドの名前と、第3引数の右辺 のフィールド名を、もう一度確認してみてください。 第3引数の右辺に正しいフィールド名が指定されれば、ご希望の 『顧客ID毎に基本情報と請求金額の合計が出て、基本情報の 編集ができるクエリ』になるはずです。 見直す際の観点としては、 　・『顧客』と『ID』の間などに、スペースやアンダーバーが入ったり 　　していないか 　・誤変換や誤字がないか などになるかと思います。 (一旦、元となるテーブルをデザインビューで開いて、当該フィールド 　の名前をCopyしてから、当該クエリをデザインビューで開いて 　上記関数の右辺に貼り付け、とするのもいいかもしれません) ※もしもクエリの「SQLビュー」を使ったことがあるようでしたら、 　 デザインビューで当該フィールドを追加した後、SQLビューに 　 切り替え、そこに表示されたフィールド名をCopy、が最も確実。 SQLビューは、デザインビューを表示した状態で、 　・Access2003以前なら、メニューで「表示(V)→SQL ビュー(Q)」で、 　・Access2007なら、『デザイン』リボンの左端の『結果』内にある 　　『表示』ボタンの下にある『▼』をクリックして「SQL ビュー」選択 で、表示できます。 (Access2010は使用したことがありませんが、多分2007と同様) 　～　～　～　～　～　～　～　～　～　～　～　～　～ なお、前回の回答で、本文中の式で「請求金額合計:」の記述が 漏れていました(正しくはNo.2の添付画像の通り)。 お詫びの上、訂正させていただきます。
Access2010単体での評価版はありませんので、 どうやってもダウンロードはできません。 OfficeProfessional2010であれば評価版はあります。 試用期間60日 評価版と製品版の同居はできないようです。 詳細は以下を参照してください。 http://www.microsoft.com/ja-jp/office/2010/trial … http://www20.buyoffice.microsoft.com/jpn/faq.asp …
下記でどうですか。 --- UPDATE テーブルＡ, テーブルＢ SET [T_テーブルＢ].[フィールドＢ] = True WHERE InStr([テーブルＡ].[フィールドＡ],[テーブルＢ].[フィールドＡ])>0;
普通はエラーにならないですね。 フィールドの集計は全てグループ化にしてますよね。 とりあえずSQL文を提示されたら何か分かるかもしれません。 重複を排除する方法は、グループ化以外に、クエリプロパティの「固有の値」を「はい」にするというのもありますのでそちらも試してみてはどうでしょうか。 あと、気になったのは、 > ”クリエ２”の各項目に以下のように抽出条件を設定、フォームから入力出来るようにしました。 との事ですが、重複を排除する（グループ化でも固有の値でも）と、入力はできなくなりますけど、いいのですか。
＃１です SELECT b.*, a.* FROM a INNER JOIN b ON (a.顧客コード = b.顧客コード) AND (a.登録日 = b.登録日); の結果は以下の様になると思います。 b.顧客コード b.登録日 b.ステータス b.ステータス更新日 a.顧客コード a.登録日 a.ステータス 1 2012/02/02 4 2012/02/08 1 2012/02/02 1 2012/02/02 3 2012/02/06 1 2012/02/02 1 2012/02/02 2 2012/02/04 1 2012/02/02 1 2012/02/02 1 2012/02/03 1 2012/02/02 1 2012/01/01 3 2012/01/04 1 2012/01/01 1 2012/01/01 2 2012/01/02 1 2012/01/01 1 2012/01/01 1 2012/01/01 1 2012/01/01 で、b.ステータス更新日 が最新の b.ステータス　が欲しいので、 抽出条件でテーブル b の「顧客コード」と「登録日」が同じで　 「ステータス更新日」が最新の（Max で指定）日付を求めています この求める時に WHERE b.ステータス更新日 In (SELECT Max(ステータス更新日) FROM b WHERE (b.顧客コード = b.顧客コード) AND (b.登録日 = b.登録日)) のままでは、何が何だかわけわからないので、 FROM b のところで　FROM b AS c　と、テーブル名を置き換えておいて WHERE b.ステータス更新日 In (SELECT Max(ステータス更新日) FROM b AS c WHERE (c.顧客コード = b.顧客コード) AND (c.登録日 = b.登録日)) とします（相関サブクエリと言うものらしいです） テーブル b 内を b のものを使ってと考えていましたが以下でも良いみたいです （テーブル b 内を a のものを使って） WHERE b.ステータス更新日 In (SELECT Max(ステータス更新日) FROM b WHERE (b.顧客コード = a.顧客コード) AND (b.登録日 = a.登録日)) SELECT b.*, a.* FROM a INNER JOIN b ON (a.顧客コード = b.顧客コード) AND (a.登録日 = b.登録日) WHERE b.ステータス更新日 In (SELECT Max(ステータス更新日) FROM b AS c WHERE (c.顧客コード = b.顧客コード) AND (c.登録日 = b.登録日)); この表示結果は b.顧客コード b.登録日 b.ステータス b.ステータス更新日 a.顧客コード a.登録日 a.ステータス 1 2012/02/02 4 2012/02/08 1 2012/02/02 1 2012/01/01 3 2012/01/04 1 2012/01/01 になります。 なお、 WHERE b.ステータス更新日 In 部分は WHERE b.ステータス更新日 = でも良いかと思います > また、ACCESSはデータの並び順で最初のものから 抽出する際には ORDER BY で並びを指定できると思いますが、 更新する時、どういう並びで、どれが最初か　私にはわかりません。
考え方は ・サブフォームのクエリを先に作る。 ・その上で、検索条件を「パラメータ」で渡す。 具体的には １）全件検索するクエリを最初に作成 ２）材料の列毎に検索条件を設定。 　ピーマン　[forms]![メインフォーム].[ch0] 　ニンジン　[forms]![メインフォーム].[ch1] 　タマネギ　[forms]![メインフォーム].[ch2] 　ハクサイ　[forms]![メインフォーム].[ch3] 　ジャガイモ　[forms]![メインフォーム].[ch4] ３）これを元にサブフォームを作成する。
PostgreSQLでは ・FROM ・WHERE ・GROUP ・HAVING ・SELECT ・ORDER みたいです。
単に、 select a.顧客id,a.氏名,a.住所 from T_2011 a,T_2010 b,T_2009 c where a.顧客id = b.顧客id and a.顧客id = c.顧客id で出てくると思いますが。 年によって、氏名（結婚・離婚による）や住所（転居・行政の地番変更による）が変わることがあるので 最新のテーブルのデータを参照しましょう。 2010年、2009年に購入していて20011年に購入していない顧客は？ など購入していないという条件をつけるのは少し難しいと思われるかもしれませんが、 以下のようなSQLです。 select b.顧客id,b.氏名,b.住所 from T_2010 b,T_2009 c where b.顧客id = c.顧客id and b.顧客id not in (select a.顧客id from T_2011 a) ※本当は、年毎にばらばらに持つのはのぞましくないんですが。 ・・・例えば、2009～2011のいづれかの年に購入した客で大阪府に住んでいる人を出したいときとかに 急に手間が増えます。
SQLを以下のように書き換えます。 SELECT [No],コード,町名.年齢,男,女 FROM テーブル ORDER BY 町名,IIf(年齢=">=101",101,Val(年齢))
アクセスログは順次出力なので、XMLで扱うのは非効率だと思います。 もう少し費用をかけてそれなりの環境を整えたほうがいいのでは？ http://www.serverdb.info/pg/search.php?fw=CentOS …[]=4&tg[]=7&od[]=2&od[]=&od[]=&od[]=&kind=search&gp=rental-vps
http://www.phpbook.jp/tutorial/sqlite/ http://codezine.jp/article/detail/433 SQLiteはPHPなら使ってみるのもひとつです JavascriptならJSONが便利かもです
普通に作ればアクセスエラーにはならないです。 Sqliteの欠点は、データベース全体ごとにロックされて待ちになることなので、1回の処理が数秒もかかり、秒間に何人もが平行してアクセスするなら、どこかでタイムアウトになる可能性がありますが、 数十人程度の小規模システムであれば全員が常時そのシステムにアクセスしていると言うことでも無い限り大丈夫では？ それともある時刻になると数十人が一斉にアクセスするとかの業務ですか？そうであれば他のDBMSがいいでしょうね。
スクリプトの方も、検索にしないでリレーションの関連レコード移動 にしたほうが簡単ですよ。
VBA＝マクロですよ。 「記録したマクロ」をベース程度には使えるものの、処理は自分で作る必要があります。プログラミングになっちゃうので、敷居は高めです。 csvやxlsなど操作はExcelマクロが楽なので、フリーマクロ集とか探せば・・・もしかしたら、あるかも。
顧客コードの更新と言うことですが、マスターテーブル（顧客表）の主キー（顧客コード）を更新する場合と、トランザクションテーブル（注文表）の外部キー（顧客コード）を更新する場合では、意味合いが異なります。 マスターの主キーの更新は、キーの値そのものを更新します。 トランザクションの外部キーの更新は、マスターのどのレコードと関連付けるかの変更です。 ですので、単純に言ってしまえば、更新したい方のフィールドを選択すればいいだけです。 エラーが発生するかどうかと、列選択は関係ないですね。 エラーが発生するかどうかは下記のような原因がありますので、エラーが発生しないような値で更新すればいいのです。 通常は、マスターテーブルの主キーは通常は一度登録したら変更しないというのが原則です。もし、更新するなら、トランザクションテーブル（注文表）の外部キー（顧客コード）も連鎖して更新させる設定（ON UPDATE CASCADE）にしておく必要があります。連鎖更新の機能がオンになっていればエラーなく更新できますが、オフの場合は、エラーになります。後、重複する値を入力してもエラーになります。 トランザクションテーブル（注文表）の外部キー（顧客コード）を更新する場合は、マスターテーブル（顧客表）に存在するコードを入力すればエラーはでませんが、存在しないコードを入力すればエラーになります。
メインのテーブルにサブのテーブルがどうぶらさがっているか表記していて INNER JOINの方が結合した条件が見やすいと思いますよ またINNER JOINしたあとにWHEREで評価をする場合もあるので 順列を考えればJOINのONで処理した方が後からみてもわかりやすいと思います
MSAccessだと思いますが、DBシステム名を記述すべきです。 詳しい事情が分からないので何ですが、直感的に設計が 宜しくない気がします。商品に卸値が複数あることはよくある 話なので、卸値テーブルを別途設けるべきでしょう。 卸値テーブルは商品コードと卸値コードをキーにし、卸値と 有効期間(適用開始日、適用終了日）などを置きます。 納品明細には新しく卸値コードを追加し、卸値テーブルと結合 させれば、目的の値がとれるはずです。こうすれば、卸値の 推移も把握できますし、過去の収益も計算可能です。また、 卸値が増えてもレコードを追加するだけで、テーブルレイアウトの 変更が不要です。 現行の設計のままやろうとすると以下のようになります。 SELECT IIf(T納品明細.卸値２,商品マスタ.卸値1,商品マスタ.卸値2) As 卸値
「外部キー制約」と「参照整合制約」は同じものと考えて良いと思いますよ。 実現方法に注目しているか、実現する内容に注目しているかの差でしょうか。 「タプル」を「行」や「レコード」と言うことも有りますが、それと同じようなことかと。 また「参照整合制約を成り立たせるために外部キーがある」という認識も合っていますよ。
いくつか、はっきりさせてください。 （１）身長・体重・視力・胸囲は、必ずセットで登録されますか？ 　　　身長のみ登録され、体重・視力・胸囲がNullという場合がありますか？ 　　　未登録時に遡るとして、対象者のすべてのレコードが未登録ならどうしますか？ （２）年はともかく、月、特に１～９はどのような形式で登録されますか？ 　　　01～09？それとも１～９？ （３）健康はnamaeなのに、名簿がnameなのには何か理由がありますか？ 　　　ついでに言えば、同姓同名にはどう対応します？ テストしてませんが身長・体重・視力・胸囲が取得できるとすれば INSERT INTO kenkou ( namae, sintyo, taizyu, siryoku, kyoi, nen, tsuki ) VALUES SELECT T2.namae, T2.sintyo, T2.taizyu, T2.siryoku, T2.kyoi, T2,nen, T2.tsuki FROM kenkou AS T2, ( 　SELECT namae, max(nen & "/" & tsuki) AS nengetsu 　FROM kenkou 　GROUP BY namae ) AS T1 WHERE T2.namae = T1.namae AND T2.nen & "/" & T2.tsuki = T1.nengetsu ; 身長・体重・視力・胸囲を考慮するならば INSERT INTO kenkou ( namae, sintyo, taizyu, siryoku, kyoi, nen, tsuki ) VALUES SELECT T2.namae, T2.sintyo, T2.taizyu, T2.siryoku, T2.kyoi, T2,nen, T2.tsuki FROM kenkou AS T2, ( 　SELECT namae, max(nen & "/" & tsuki) AS nengetsu 　FROM kenkou 　WHERE sintyo IS NOT NULL AND taizyu IS NOT NULL 　AND siryoku IS NOT NULL AND kyoi IS NOT NULL 　GROUP BY namae ) AS T1 WHERE T2.namae = T1.namae AND T2.nen & "/" & T2.tsuki = T1.nengetsu ; ＃副問い合わせのインデントに全角スペースを使ってますので注意してください。
表制約でも出来ますよ。 CREATE TABLE `注文表` ( `注文日` date DEFAULT NULL, `得意先コード` varchar(10) DEFAULT NULL , `商品コード` varchar(10) DEFAULT NULL , `数量` int(11) DEFAULT NULL, FOREIGN KEY( `得意先コード` ) REFERENCES 得意先表(得意先コード), FOREIGN KEY( `商品コード` ) REFERENCES 商品表(商品コード) );
市区町村一覧 テーブルが出来上がっているとして、 一気に設定するものとすると UPDATE 市区町村一覧 AS Q1, 住所一覧 AS Q2 SET Q2.ワーク = Mid(Q2.ワーク,Len(Q1.都道府県 & Q1.市区町村 & Q1.町域)+1), Q2.都道府県 = Q1.都道府県, Q2.市区町村 = Q1.市区町村, Q2.町域 = Q1.町域 WHERE Q2.ワーク Like Q1.都道府県 & Q1.市区町村 & Q1.町域 & "*"; としてみてどうなりますか。 都道府県で絞り込む時にはそのまま Like で良いと思いますが、 市区町村で絞り込む時には、市区町村 & 町域　で Like した方が良さそうです。
電話番号、メールアドレスを別テーブルにする。 電話番号 顧客コード　顧客情報テーブルの外部キー 種別　（固定、FAX、携帯、スマホ） 備考　 電話番号 内線番号 優先順位 メールアドレス 顧客コード　顧客情報テーブルの外部キー 種別　（PC、携帯、スマホ） 備考　 アドレス 優先順位 現状だと、電話、FAX、携帯２つまでしか対応できないが、別テーブルにすれば、もっと増えても対応できる。 そこまでする必要があるかどうかは扱うデータ次第ですが。
内容がよく理解できていなかったので飛ばし読みしてました。 本題とは離れますが 空欄と済しか無いのなら計算結果が数字でも同じですね。 Countは空欄では無いレコードをCountしますから。 また、完了フラグ＝済フラグの照合も不要ですよね。 理解できなかったのは >フィールドA（データ１・データ２・データ３とありますがデータ１～３全体に関する集計） >に関する「済」のcountを行なっており の部分です。 また、 >この完了フラグを計算式(if(〇〇フィールド="XX";"済";"")と〇〇フィールドの条件により【済】or >「空白」が入るような設定に変えた この式は正確にはどんな内容ですか？
リレー競争（relay）とリレーション（relate）とを結び付けるのは 無理がありそう。 ひとつのデータと別のデータを各々のデータの中の特定の値で関連 付ける（別データを参照したりグループ化できる等）ことができる データベース、でいいのでは？ 例えば学校の生徒名簿なら、カード型データベースでいえば一つ一 つのデータは個人データですけど、クラス名をリレーショナルキー とすれば、あるクラスには何人在籍しているとかなどキーでグルー プ化して計算できたりします。 表は関係無いです。
質問文に <元表> と <正規化> が載せてありますけれど，正規形が必ずそれになるとは言えないです。前提条件が変われば正規形も変わりますから。 次の３つの例を検討してみます。 ▼条件１ ・１つの商品はただ１人の顧客だけが購入できる ▼条件２ ・１つの商品は複数の顧客が購入できる ・１人の顧客は同一商品をただ１度だけ購入できる ▼条件３ ・１つの商品は複数の顧客が購入できる ・１人の顧客は同一商品を複数回購入できるが，１日あたりの同一商品の購入は１度だけ それぞれの場合，正規形の例は次のようになります。 ▼条件１の正規形 商品コードが決まればそれに対応する商品名，購入数，顧客コードすべて一意に決まります。 イメージとしては，オークションにおける出品と同じく，まったく同じ書籍が複数出品されたとしてもそれぞれ別々の商品コードが割り振られる条件だということです。 関数従属ではこれを，商品コード →（商品名，購入数，顧客コード）のように表現します。 したがって，この条件における正規形は「商品コード，商品名，購入数，顧客コード」です。複数の表には分離されません。 ▼条件２の正規形 商品：購入 の対応は １：Ｎ です。 商品名は，商品コードが決まれば一意に決まりますが， 購入数は「商品 SH01 を顧客 KY01 が 10個購入」「商品 SH01 を顧客 KY02 が 20個購入」のように， 商品コードが決まっただけではダメ，顧客コードが決まっただけでもダメで，商品コードと顧客コードのペアが決まると購入数が一意に決まります。 それぞれを関数従属で表現すれば次のようになります。正規形の２つの表もこうなります。 商品コード→商品名 （商品コード，顧客コード）→ 購入数 ▼条件３の正規形 質問文で挙げられた次の表は， 　　> <正規化> 　　> 売り上げテーブル：商品コード、購入数量、顧客I 次のような現象が起こることを想定していません。 「【1月23日に】商品 SH01 を顧客 KY01 が 10個購入」 「【1月24日も】商品 SH01 を顧客 KY01 が 10個購入」 そういう現象が発生するのなら，購入日付の情報を持たねばなりません。 関数従属 および 正規形 は次のようになるでしょう。 商品コード→商品名 （商品コード，顧客コード，購入日付）→ 購入数 それでも「同一顧客による１日あたりの同一商品の購入は１度だけ」という制限は残ります。 １日に何度も購入が発生する状況であるなら，購入の時分秒まで含めるなり，購入トランザクション毎に購入コードを割り当てるなりする必要があります。 ---------------------------------------- 以上，述べてきましたが，結論としては， > 正規化する前の情報を出せるように関連付けするために、 > 主キーの商品コードを、各表2つに残しておく。 という人間の意図で商品コードを２つの表に含ませているのではなく， 元表の項目を分析したら，主キーが異なる２つのグループに分離されたから，２つの表に分割したのだ，ということになります。 > なぜ商品コードで「結合する仕様になっているか」 という質問が出てくるということは，購入数という項目が「何に対する」購入数なのかを理解していないということだと思います。
こんなん、どうでしょうか。 SELECT * FROM test t1 WHERE (t1.col2 = false) AND NOT EXISTS ( SELECT 1 FROM test t2 WHERE t2.col2 = false AND t2.col3 < t1.col3 ); 同じようなものかもしれませんが。
前の方の回答通りのエラーですね。集計クエリの、[仕入数]、[納品数] は集計後のフィールドなので、 クエリのフィールド欄からは参照できません。 画像をみるかぎりは、最後の列の在庫数の演算フィールドを下記のようにすればよさげです。 フィールド　在庫数: [Q仕入数合計].[数量の合計]-[Q納品数合計].[数量の合計] 集計　合計 抽出条件　<>0 ただし、Q仕入数合計、Q納品数合計 が 商品ID でグループ化した集計クエリなら、 Q在庫表 で再度集計する必要はないので、普通の選択クエリにして、 フィールド　在庫数: [Q仕入数合計].[数量の合計]-[Q納品数合計].[数量の合計] 抽出条件　<>0 とすればOKです。
１） ちょっと変ですが，そういう捉え方でもまあ間違っているとは言えないでしょう。 テーブルは売上伝票だけを対象にするものではなく，あらゆるデータをテーブルで表現できます。 ただ，事務処理業務を情報システム化するという従来から盛んにおこなわれてきたシステム開発案件においてもっとも一般的なデータが売上伝票であり，売上伝票をどのようにテーブルで表現するかというのは新入社員SEが必ず学習するもっとも一般的な課題だったわけです。 その意味で，DB正規化の課題においてたいてい伝票が題材として取り上げられているというのはそのとおりだと思います。 ２） ちょっと引っかかりますが，そういう捉え方でもまあ間違っているとは言えないでしょう。 ご質問の中での「正規化したため」という表現は，売上伝票が先に存在するものだと捉えていらっしゃるのですよね。 でも逆に，顧客・担当者・商品・売上といった概念の方が先に存在するものである，個々のトランザクションにおけるそれらを見やすく「１枚にまとめたため」売上伝票という形式が生まれた，という捉え方もできると思います。 どちらを主として捉えても，最終的な姿は同じになるので，間違っているとは言えない（でもリレーションシップの意味を限定しすぎている）と思いました。「関連付けるため」という表現の方には違和感はありません。
問題の回答は以下のURLに書かれています。 「No909.NullとIsNullの違いとは・・・・？」 http://www.accessclub.jp/bbs5/0004/vba909.html Null と "" は違う判定結果になります。　もしNULL判定も含むよぅにしたいなら NZ() 関数をお勧めいたします。 もし、何も入力されていないことをチェックするのであれば　以下のようにすればいいでしょう。 IF len(NZ(調べたい値）) = 0 then '　＝＝＞　文字列が長さが0　かつＮＵＬＬであれば空文字列 "" に変換します。 処理 end if とすれば完璧です。 参考URL：http://www.accessclub.jp/bbs5/0004/vba909.html
データベースの「正規化」　という言葉で検索して みてください。 縦持ちという内容と同じことが説明されています。
> 許可文字数が150字程度と少ないので > キャッシュに展開しない方法をご教授いただけないでしょうか。 ということなら、許可文字一覧を1文字１レコードではなく、１レコードに すべて入れてしまえばどうでしょうか。 ◆許可文字一覧テーブル 　　　　　　　　　文字 1レコードめ　　アイウＡ１２３ 標準モジュールに下記の関数。 Public Function MeisyouError(Meisyou, ArrowChars As String) As Boolean 　　Dim c As String 　　Dim i As Long 　　MeisyouError = True 　　If IsNull(Meisyou) Then Exit Function 　　For i = 1 To Len(Meisyou) 　　　　c = Mid(Meisyou, i, 1) 　　　　If InStr(ArrowChars, c) = 0 Then 　　　　　　MeisyouError = False 　　　　　　Exit For 　　　　End If 　　Next End Function クエリ SELECT データ一覧.* FROM データ一覧, 許可文字列 WHERE MeisyouError([名称],[文字]);
ANo.1です。 >"GentaniMeisai CURSOR" >ここの文はエラー箇所の前20文字が表示されるみたいです。 失礼しました。20文字だけでしたね。(マニュアル確認しとけって言われそうですが。) 他にエラーが出ていてその影響で、FORがダメとメッセージが出ているのでない限りは、 私にはエラーになる理由が思いつかないです。 あと私に思いつくのは、念のため、FORの前に WITHOUT HOLD と WITHOUT RETURN　（もしくは他のパラメタ） をつけてみても同じか確認してみるくらいです。 （マニュアルは、省略ＯＫとなっているようにしか思えませんが。） 構文。最初につけたサイトからの引用。 >>-DECLARE--cursor-name--CURSOR--●--| holdability |--●----------> >--| returnability |--●--FOR--+-select-statement-+------------->< '-statement-name---' holdability .-WITHOUT HOLD-. |--+--------------+---------------------------------------------| '-WITH HOLD----' returnability .-WITHOUT RETURN-------------. |--+----------------------------+-------------------------------| | .-TO CALLER-. | '-WITH RETURN--+-----------+-' '-TO CLIENT-'
当方の環境で、Access2000当時に作成した古いMDBを、Access2010でAccdbに変換して試してみましたが、フィールドの固定やフィールド幅の変更は問題なく保存されました。もちろんAccessを終了して、再び開いても変更を記憶しています。 フィールドの固定やフィールド幅を変更すると、閉じるときに「レイアウトの変更を保存しますか」と聞いてきますか。 新規にAccdbファイルを作成してテーブルやクエリを作成して場合も同じ症状ですか。
> 商品マスタにはカタカナ二文字の「検索キー」フィールドを設けており、 > これをキーにしてクエリ（「Q商品検索」）で昇順に並べ、コンボボックスのコントロールソースを > そのクエリにしました。 コントロールソースではなく値集合ソースにクエリ（「Q商品検索」）を設定したのですよね。 コントロールソースは空欄にしておいてください。 コンボボックスの名前は、「cb検索キー」とします。 上記のコンボボックスを入力フォームのフォームヘッダーかフッターに配置します。 現状は、入力フォームのレコードソースは「商品マスターテーブル」になっていると思いますので、 そこのビルドボタンをクリックしてクエリのデザインビューを開いて、 「検索キー」フィールドの抽出条件欄を下記のように設定します。 Forms!入力フォーム!cb検索キー コンボボックスの更新後処理にマクロで、「再クエリ」を設定します。 これで、コンボボックスで選択した値が抽出されます。 コンボボックスが空欄の場合は、なにも抽出されません。空欄の場合はすべてのレコードを表示したい場合は、 抽出条件を下記のようにしてください。 Like Forms!入力フォーム!cb検索キー & "*"
UBS?
http://idocsq.net/page/514 「sqlite3_exec」の戻り値は正常終了が0で異常終了がそれ以外なので、SELECT文が正常に行われていれば常に0が返ります。 cygwin環境ですが以下のようにすれば、テーブルがあるかどうか判断できました。 #pragma comment( lib, "sqlite3.lib" ) #include <sqlite3.h> #include <stdio.h> // 抽出結果が返るコールバック関数 static int callback(void *NotUsed, int argc, char **argv, char **azColName){ int i; for(i=0; i<argc; i++) printf("%s = %s\n", azColName[i], argv[i] ? argv[i] : "NULL"); return SQLITE_OK; } int main(int argc, char* argv[]) { sqlite3 *db; char *zErrMsg = 0; // データベースファイルを新規生成 int rc = sqlite3_open("Sample.db", &db); rc = sqlite3_exec(db, "SELECT count(*) from sqlite_master where type='table' and name='sample'", callback, 0, &zErrMsg); // データベースを閉じる sqlite3_close(db); return 0; }
[ファイル]-[ページ設定]-[レイアウト]の「サイズ」の「実寸」にチェックが入っていたらそれを外して、「幅」を列の幅に設定してください。 これで、デザインビューでレポートの幅を広げても、列の幅は指定した値で固定されます。
＞カンマの後に半角スペースを入れて書くのはなぜでしょう？ 読みやすくするため。 入れて書けと言われたのだとしたら、読みやすく統一するためのローカルルール(SQLの仕様ではないという意味、一般的か否かで言えば超メジャーなルール)。 サンプルとして公開されているSQLに必ず入っている事を言っているのだとしたら、サンプルを公開するような人は読みやすい事の利点を知っている為そうしているという事。 ＞入れた場合と入れなかった場合の違いはありますか？ SQLとしては違いはない。 ただし、スペースを入れていないSQLを他人に見られた場合、バカにされるという違いがある。
同じ体験をしました。経験からですが、 プレビューをデザインの場面で自分の望む位置に希望のサイズで配置し、他のオブジェクトも適宜配置してそれを上書き保存をします。アクセスは1回保存しても次次になぜか聞いて来ますので、そのたびに位置を直して保存します。再起動をしてもなおらないのは、同じことを繰り返し行います。そうしているうちに、ほぼ希望に近いものになりました。試してみてください。
通常はidの方をPrimary Keyにして(custmer_id,member_id)でunique indexを作成します。このような場合は、シーケンシャルに符番するidを人工キーと呼びます。 なぜ、このような作り方をするかというと、primary keyは変化しない項目の方が望ましいからです。
| なのでランダムに生成した文字列や画像といったあまりに無意味すぎるデータだとまずいんです。 テストデータを取得するようなプログラムを作成すればいいんでは？ ニュースサイトとかのRSSを見て、文章や画像を取得していけばいい。 プログラムで抜き出しやすそうなってことは、プログラム組んでどうせ読むんだから、その方がよっぽど効率がよくないか？
SELECT T_部門.商品ID, -Int(Sum([部門ID]=1)) AS 部門１, -Int(Sum([部門ID]=2)) AS 部門2 FROM T_部門 GROUP BY T_部門.商品ID; とか TRANSFORM cint(Nz(Count(QX.[数]),0)) AS 数のカウント SELECT QX.商品ID FROM ( SELECT [T_部門].商品ID, [T_部門].部門ID, Count([T_部門].部門ID) AS 数 FROM T_部門 GROUP BY [T_部門].商品ID, [T_部門].部門ID ) AS QX GROUP BY QX.商品ID PIVOT '部門' & QX.部門ID; だと？ もし上記で結果が得られたなら後学のため大体の処理時間を教えてくださいませ。
ファイル名の候補をテーブルに持たない理由があるんですか？ テーブルに持っておけば候補が多くなろうがコードの変更は不要ですよ。 私なら フォルダを再帰でたどる部分 → FileSystemObject を使う。 ファイル名候補一覧 → テーブルに格納する。 ファイル名候補とファイル名とのすり合わせ → パラメーター クエリーを作っておき、フォルダー内で見つけたファイルの名前が格納されているか判断する。 "fileName" というテキスト型のフィールドを持つテーブルを "fileNameMaster" という名前で作っておき、ファイル名候補を入れておく。 以下のようなパラメーター クエリーを作成し、"FindFile" という名前で保存しておく PARAMETERS [@FileName] Text ( 255 ); SELECT Count(fileNameMasuter.fileName) AS fileNameのカウント FROM fileNameMasuter WHERE (((fileNameMasuter.fileName)=[@FileName])); VBA にて以下のような関数を作っておき、再帰処理で見つけたファイル名を投げる。 ヒットすれば True が返り、なければ False が返る。 Function FindFile(aFileName As String) As Boolean 　　Dim con As ADODB.Connection 　　Set con = CurrentProject.Connection 　　Dim proc As New ADODB.Command 　　With proc 　　　　.CommandText = "FindFilename" 　　　　.CommandType = adCmdStoredProc 　　　　.ActiveConnection = con 　　End With 　　Dim param As ADODB.Parameter 　　Set param = proc.CreateParameter 　　With param 　　　　.Name = "[@FileName]" 　　　　.Type = adVarWChar 　　　　.Size = 255 　　　　.Value = aFileName 　　End With 　　proc.Parameters.Append param 　　If proc.Execute.Fields(0).Value >= 1 Then 　　　　FindFile = True 　　Else 　　　　FindFile = False 　　End If End Function とか。
ポータルの縦方向連続入力は前回ので解決するはずです。 >私が思うにリレーションシップやフィールドの設定あたりに関係があるのではと >それとテーブルの構成についてですが初心者の為テーブルの構成の意味自体がよくわかりません こちらにどうぞ。 http://www.russ.jp/stepbbs/step.cgi? 「初心者の・・・」ってなってますけど何でもOKですし回答も早いですよ。
「CPU設定をシングルコアに切り替えた途端」というのが気になるんですが、仮想化されてるPCなんでしょうか？
>>ポータルに入力してEnterを押したら次のポータル行に >>行くようにしたほうが間違い無いと思いますけど。 >って、私の言っているものとは仕組みか何かが違うのでしょうか わざわざ一旦ポータル外に入力するより、ポータルに直接入力した方が 左右のフィールドとの関係が分かりやすいですよね？ 通常はフィールド移動のキーはTabですが、これをEnterに変えることが できます。ただ、これだとポータル内の1フィールドでしか動かず、縦に 連続した入力が出来ないです。そこでまたスクリプトトリガになります。 こんな感じ　↓ http://pupld.net/28/111219/u6gghc7mz0/index.cgi >初心者の為テーブルの構成の意味自体がよくわかりません これではちょっと大変かも。
PURGE TABLEはテーブルのデータを全て消すだけです、したがって、テーブルはまだ存在します。 DROP TABLEはテーブル自体を消してしますので、テーブルはもう存在しません。
DoCmd.TransferSpreadsheetを使えば可能です。 http://www.accessclub.jp/urawaza/20.html
別なテキストボックスなどに値を入れて、 更新クエリでその値を指定するという （アクセスながらの）手もある。
Accessのなかで最も理解しがたいものだと思います。 私もうろ覚えなので間違った回答をしてしまうかも知れないので参考リンクの紹介に留めておきます。 Access データベースとそのオブジェクトにユーザーレベル セキュリティを設定する (MDB) http://office.microsoft.com/ja-jp/access-help/HP … の中の、ログオンを必要としないセキュリティ設定でデータベースを保護する の部分の記述が参考となるかと思います。 一般ユーザーには何も意識させずにセキュリティの設定が可能です。 こちらのやり取りも必見です。（97の話ですが基本的には全く一緒です） http://accessclub.jp/bbs/0010/beginers3497.html リンク先でも述べられていますが、 拡張子がmdwのファイル System.mdw等 と セキュリティを設定したいmdbファイルは 必ずバックアップを取ってからにしないと悲惨な目にあいます。 下記ウィザードでは自動的にバックアップが出来ますが、何かの手違いで・・・ というのもありますので強く^2 お勧めします。 一回適当なファイルでセキュリティウィザードの指示に従って新たなmdwファイルに基づいた MDBファイルのセキュリティを設定してみてください。 そして出来たものを調べれば、mdwファイルの役割や設定の行い方の理解が進むかと思います。
出退管理はテーブル的には 社員テーブル（ＩＤ、氏名、、、、、） 打刻テーブル（ＩＤ、日付、時間、出退区分、、、） 出勤区分テーブル（ＩＤ、名称、、、）休日、有給、祝日、などが入っている。 勤務区分（ＩＤ、勤務区分名、開始時間、就業時間、休憩時間、総労働時間、、、） 個別スケジュール（社員ＩＤ、年月日、出勤区分、勤務区分、出勤時間、退勤時間、総労働時間、休憩時間、残業時間、遅刻時間、早退時間、時間調整、、、） 年休管理テーブル（社員ＩＤ、年、有給付与数、繰越数、休日数、祝日数、有給消化数、、、） みたいなかんじかな。　他社の製品なんであまり詳しくは書くわけにはいかないけど、個別スケジュールを月次のバッチ処理である程度データを埋めるところが肝だね。　あとは、労働時間とかを集計するテーブルもあるし、給与体系に結び付けているテーブルもあるし、やろうとすると、いくらでもできるけど、、、 結局、最終的には何をどう管理するために、どの程度の手間とコストをかけるのか？ それを社内でやるのと、製品を買うのとどちらがリーズナブルなのか？ という話になってくるわけだね。 休憩時間別にというのは、８時５時、９時６時、１０時７時などという出勤区分をそれぞれ作って対応したという意味。
>自動車整備工場の顧客管理データベース テーブル設計自体は、他の方の回答から考え方を読み取ってもらうといいと思いますけど、 普通は、この業種の顧客管理なら、「車検」というキーワードを重視します。 前回の車検はいつだったか？（車検の間隔は決まっているので次の車検の前に案内を出したい。） 前回の車検での修理は何をしていくらくらいかかったのか？ また、 オイル交換は前回いつだったのか？ パッテリーの交換は？ タイヤ交換は？ ・・・ 後者は、作業履歴テーブルで対応できなくないのですが、 前者は、別のテーブルを用意しておいたほうが管理しやすい。 とかいう業務系のノウハウは、パッケージソフトを購入したほうがお手軽に入手できるんですけどね。 よく考えないと作ったのはいいものの使いにくい・・・という結果になりかねないです。 （私もたずさわったことあるのがずいぶん昔なので、どんな要件があるのかはもう忘れましたけど。） 以上参考まで。
最初の質問について 入力時にそのような形式で入れてしますのでしたら、 入力するフィールド名をIDとし、タイプをテキストにします。そしてオプションのボタンを押し、 入力時の自動化の中の計算値をチェックします。 式は = Right("0000000000" & ID ; 10) にします。これで０が前に自動で入れられます。 ２つめの質問について 新たにフィールドを作り、タイプを計算にします。 式を = 施設番号 & ID にします。
なにやっているのか良くわかんないけど、 直前に、 me.refresh ってやると、なにかかわる？
「データベースに落とす」というのがどの程度のレベルの話かわかりませんが、専用ソフトを使ってもいいなら、以下のような製品があります。 データを共有したいのであれば、このようなソフトはいかがでしょうか。 スキャナつきのパッケージもあるようです。 http://www.justsystems.com/jp/products/meishikan … これ以外にも、ハードウェアとしてのスキャナを購入すると、おまけソフトとして名刺管理ソフトが付いてくるスキャナも多くあります。 お手軽で簡単に持ち運べる専用機としてはこういうのもあります。 わたしはいつもこれを持ち歩いています。 ビュアーを各ＰＣにインストールすれば、データを共有することもできます。 http://www.kingjim.co.jp/sp/pitrec/
WaitForSingleObject は呼び出し元がフリーズしたように感じるので 別解です。 Option Explicit Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long) 'http://www.wmifun.net/library/win32_printjob.html Function WaitPrintIn(ByVal DocName As String) As Boolean 　　Dim strComputer As String 　　Dim objWMIService As Object 　　Dim colPrintJobs As Object 　　Dim objPrintJob As Object 　　strComputer = "." 　　Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2") 　　 　　Set colPrintJobs = objWMIService.ExecQuery _ 　　　　("SELECT * FROM Win32_PrintJob WHERE Document = '" & DocName & "'") 　　If colPrintJobs.Count > 0 Then 　　　　WaitPrintIn = True 　　End If End Function Function WaitPrintOut(ByVal DocName As String) As Boolean 　　Dim strComputer As String 　　Dim objWMIService As Object 　　Dim colPrintJobs As Object 　　Dim objPrintJob As Object 　　strComputer = "." 　　Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2") 　　 　　Set colPrintJobs = objWMIService.ExecQuery _ 　　　　("SELECT * FROM Win32_PrintJob WHERE Document = '" & DocName & "'") 　　If colPrintJobs.Count = 0 Then 　　　　WaitPrintOut = True 　　End If End Function Sub こまんど() 　　Dim Pass1 As String 　　Dim oFs As Object 　　Dim oShell As Object 　　Dim sName As String 　　Set oFs = CreateObject("Scripting.FilesystemObject") 　　Set oShell = CreateObject("Shell.Application") 　　Pass1 = "C:\商品図面\" & rstTable!図番 & ".pdf" 　　sName = oFs.getFilename(Pass1) 　　Call oShell.ShellExecute(Pass1, , , "print", vbNormalFocus) 　　Do Until WaitPrintIn(sName) = True '印刷処理に取り掛かるまで待機 　　　　Sleep 500 　　　　DoEvents 　　Loop 　　Do Until WaitPrintOut(sName) = True '印刷が終わるまで待機 　　　　Sleep 500 　　　　DoEvents 　　Loop 　　MsgBox "" 　　'DoCmd.OpenReport "R_顧客リスト", acViewNormal, "", "", acNormal 　　'もしかしたら↑の一行だけをサブモジュールにして呼び出した方が良いかも 　　'途中省略 　　Set oFs = Nothing: Set oShell = Nothing 　　MsgBox "おしまい" End Sub ※試したわけではない（紙とインクがもったいない・・）ので結果は不明です。 とりあえず、お試しあれ。 投稿用にインデントの代わりに全角スペースを使っています。 なお、こちら（Windows7 AcroRD32 Ver10.1.1)では印刷終了後には アクロリーダーは自動的に閉じました。
> INT、INTEGERはどちらがHIRDBのデータ型ですか。 http://www.hitachi.co.jp/Prod/comp/soft1/manual/ … を見るかぎり、HIRDBでは「INTEGER」のようです。 Oracleでは「INT」「INTEGER」とも「NUMBER(38)」として扱われます。
RPGが使えるマシンでも、いまはwebが使えますよ。 社内で開発・運用するのが可能なら確認してみては？
「なでしこ」ですか、、、プリペアドステートメント-プレースホルダーにも対応していないのかな？ ＞データベース内で明らかに存在するのに検索できない エスケープ処理よりも、文字コードの問題が大きいような気がします。 SQLiteは、SQL文内の文字列として解釈できれば、基本どんなバイナリーデータもそのまま受け入れてしまうのですけど、検索やソートの時に、sjis やeucでは、バイト列がずれてマッチしたりしてうまくいきません。 SQLite3 なら、utf-8には対応してるので、utf-8でなら概ねうまく検索されます。 「なでしこ」でどの文字コードが使われているのか解りませんが、utf-8で保存し、検索時のデータ指定もutf-8でSQL文を構築、取り出し後、表示用の文字コードに変換という手順が必要です。 エスケープ処理について、phpマニュアルでの、sqlite_ecsape_string() 関数(SQLite2用)の説明によれば、文字列データのくくりは、シングルクオート(')の方を使うようにし、データ内のシングルクオート(')は2重にしてるようです。たしか標準SQL規格準拠の動作。 そのほかのバイナリー文字は、たぶん バックスラッシュ(\ 0x5c) を付加かな。 でも、SQLite3では、プリペアドステートメント推奨となっています。
＃２です 解決されたという解釈で良かったのでしょうか。 （記述を見直しました）（前のものでも一応動くとは思います） ただ、気がかりなのがCドライブ直下と言う事で・・・・ （私はそこには作らないというだけの話ですが） 「test1.csv」「test2.csv」のありかを、「D:\HOGE」と仮定します。 作成する「test3.csv」の場所を「E:\hogehoge」と仮定します。 「E:\hogehoge\test3.csv」が存在したらエラーとなります。 「D:\HOGE」を★★に、「E:\hogehoge」を☆☆で置換えて記述したとすると （＃２の記述をチョッと変更しています。 変な改行表示されるので、一度メモ帳等にコピー＆ペーストして確認ください） Dim CN As ADODB.Connection Dim sSql As String Set CN = New ADODB.Connection CN.Open "Provider=Microsoft.Jet.OLEDB.4.0;" & _ "Data Source=★★;" & _ "Extended Properties='Text;HDR=YES'" sSql = "SELECT * INTO [test3.csv] IN '☆☆'[Text;FMT=Delimited;HDR=YES;IMEX=0;]" _ 　　　　& " FROM [test.csv] AS a LEFT JOIN [test2.csv] AS b ON a.tel = b.tel;" CN.Execute sSql Set CN = Nothing ※　この辺については、Web上のブログで見たような気が気ます。 （SQLで CSV出力指定記述とか・・・） ※　 [test3.csv] の後の IN句の記述について、いろいろ確認を取られたらと思います。
表示させたいのは起動時か何かで、『期限が迫っていますよ』的なアラートですかね？ メッセージボックスではなくて、工期確認フォームを作ってはいかがでしょうか？ たぶん、現在でも『工期一覧』のようなフォームがあるでしょうから、そのリストを表示する際に期限の近い順に並べるのをデフォルトにして、一カ月を切ったら背景色を赤にするとか。 起動時に、操作メニューのようなものを表示しているなら、その中に『○件の工期が一カ月を切っています』という表示があって、クリックすると先の『工期一覧』フォームを表示するとか。 もっと確認を強制したいなら、『○件の工期が一カ月を切っています』とメッセージボックスを出して、OKを押せば強制的にその『工期一覧』フォームを表示するとか。
U-TANG さんのサイト テーブルのオートナンバーを振りなおす方法（β版） http://www.f3.dion.ne.jp/~element/msaccess/AcTip … 第II部「FAQ 編」 の最後、「-2147467259 フィールドのデータ型が正しくありません。」エラーについて と、その中の 「VBA:InStr 関数で「実行時エラー '7'」が発生する」 のリンク が参考になるかｔもしれません。 あとはお決まりの、空の MDB にオブジェクトをインポートしてみる、くらいでしょうか。
cast()でなく、varchar()で変換するとか＞ANo.3
テーブルの 「所持免許資格」 は スペースで区切られた複数の資格名が入力されている、といことでしょうか？ 少々問題がありますが、（※） 一応、これでできます。 ----------------- SELECT T_社員.* FROM T_社員 WHERE ( (所持免許資格 Like "*" & Trim([Forms]![F_抽出]![検索資格1]) & "*") AND (Trim(Nz([Forms]![F_抽出]![検索資格1],""))<>"") ) OR ( (所持免許資格 Like "*" & Trim([Forms]![F_抽出]![検索資格2]) & "*") AND (Trim(Nz([Forms]![F_抽出]![検索資格2],""))<>"") ) OR ( (所持免許資格 Like "*" & Trim([Forms]![F_抽出]![検索資格3]) & "*") AND (Trim(Nz([Forms]![F_抽出]![検索資格3],""))<>"") ) OR ( (Trim(Nz([Forms]![F_抽出]![検索資格1],""))="") AND (Trim(Nz([Forms]![F_抽出]![検索資格2],""))="") AND (Trim(Nz([Forms]![F_抽出]![検索資格3],""))="") ) ----------------- フォームのコントロール名の数字を半角にしてあります。（全角数字のオブジェクト名はトラブルの元なので） フォームとSQL の間で矛盾がないよう統一してください。 ※ 例えば、「看護師」 で抽出すると「准看護師」 も ヒットします。 　　これでまずければ、「所持免許資格」の両端にスペースを付加したものに対して検索するように修正してください。 個人的には、条件が複雑な場合、 抽出の結果をフォームに表示するのなら VBA でフィルタを操作する方が簡単かと思います。
デスクトップ画面で右クリックして『画面の解像度』を選んで、調整してみたら。あまり自信が無いけれど参考程度に。
>>勤務先で在庫システムを作るように指示されて現在勉強しながら作成している最中です。 これは、医者の知識経験が無い人に、医師を雇う予算が無いので素人に勉強してもらって手術をやらそうというようなものでしょう。 もちろん、ソフト開発なら、違法になるわけではありませんけどね。 質問者さんに支払う給料の１ヶ月分（ソフトのスペックによっては１年分になるかもしれませんが・・・）出せば、質問者さんの作るものよりもずーと良いソフトが手に入ると思いますよ。コストパフォーマンスを考えると、市販のパッケージ購入をしたほうがいいと思います。 ちなみに、私の会社はソフト開発をしていますが、経理や総務で使うソフトは、市販パッケージとかサービスを利用しています。自社開発するよりも、そのほうが安くて良いソフトが手に入るとの判断をしているものと思います。 もちろん、「在庫システムこそが我が社の生命線！」という社内の判断があり、そのソフト開発のために、質問者さんをいちにんまえのＳＥに育てようという５年とか１０年計画があるならば、初歩的な質問をしながら、ソフトを作っていくのもいいとは思います。 ただ、質問内容からして、ここで疑問点を質問するよりも、まずは在庫システムの作り方を解説した書籍などを書店で購入されて勉強されるほうが効率的だと思います。 >>テーブル２でテーブル１を参照しながら在庫テーブルから数値を引くということは可能なのでしょうか？ いわゆる「セット品在庫管理」ですね。プログラムがあれば、当然ながら可能です。 ちなみに最近は、自社用ソフトを開発するよりも、ネットのクラウドサービスを利用するほうが「早い・安い」ってことで、利用されるところが増えているようです。 ここはセット品在庫も対応しているようですし、参考になるかも？ http://cross-mall.jp/feature/
住所と名前で一意になっている前提ですが、 select 住所 , max(iif(cnt = 0, 名前, null)) as 名前1 , max(iif(cnt = 1, 名前, null)) as 名前2 , max(iif(cnt = 2, 名前, null)) as 名前3 , max(iif(cnt = 3 ,名前, null)) as 名前4 , max(iif(cnt = 4, 名前, null)) as 名前5 from( select a.住所,a.名前,(select count(*) from データ as b where a.住所 = b.住所 and a.名前 > b.名前) as cnt from データ as a ) group by 住所; でどうでしょうか。
> Set rs = db.Execute("select Name from MsysObjects where Name Like ""dbo_*"" and type = 6") この行でエラーにならなかったら無限ループですね。 エラーになってラッキーです。 システムオブジェクトを開いてトラブルがあると怖いものがあるので 「MsysObjects」 を参照しない方法で。 Sub Proc_LinkTable_Rename() 　　Dim dbs As DAO.Database 　　Dim tdf As DAO.TableDef 　　Set dbs = CurrentDb 　　For Each tdf In dbs.TableDefs 　　　　If tdf.Connect <> "" Then 　　　　　　If tdf.Name Like "dbo_*" Then 　　　　　　　　tdf.Name = Mid(tdf.Name, 5) 　　　　　　End If 　　　　 End If 　　 Next 　　dbs.Close 　　Set dbs = Nothing End Sub ナビゲーションウィンドウには遅れて表示されるかもしれません。
> アンドロイド開発環境のＳＱＬｉｔｅ はsqliteのバージョン2なのではないのでしょうか。 そうだとすると、sqlite3のファイル形式とは互換性がありません。
＃１です。 解釈に間違いがありましたね。 ＃１では単に最大値を求めていました。 > １しかなかった場合は１を抽出 と念を押したのは、社員の一覧テーブルが別途あり、 研修を全く受けていない人を１とするのか、と変に考えたためでした。 研修区分を１と６に限定したものなら、＃１で示した Max を得ているところの WHERE 条件に　研修区分 IN (1,6)　を追加します。 SELECT * FROM ★★ AS Q1 WHERE 研修区分= (SELECT Max(研修区分) FROM ★★ AS Q2 WHERE Q2.社員番号=Q1.社員番号 AND Q2.研修区分 IN (1,6)); のように。 後者についても同様に SELECT Q1.* FROM ★★ AS Q1 INNER JOIN (SELECT 社員番号, Max(研修区分) AS 区分 FROM ★★ WHERE 研修区分 IN (1,6) GROUP BY 社員番号) AS Q2 ON (Q1.社員番号=Q2.社員番号 AND Q1.研修区分=Q2.区分); ※　いろいろな記述方法があると思います。 処理速度について記述されている記事を見つけましたので参考までに グループ内であるフィールドが最大値のレコードを抽出する http://hatenachips.blog34.fc2.com/blog-entry-287 …
「みんなで助け合おう！初心者のFileMaker pro　Q&A」→このサイトを探してご覧、素晴らしい回答人が集まっていますよ。
pythonを使う（Python2.7.2はインストールの際に管理者権限も必要なくレジストリにも情報を書き込みません） ただし、日本語項目については明示的にdecodeしてあげる必要がある。 # -*- codding: cp932 -*- import sqlite3 import csv con = sqlite3.connect('mydb',isolation_level=None) sql = u"insert into mytable values ( ?, ? )" reader = csv.reader(open('my.csv','rb')) for row in reader: 　l = ( row[0], row[1].decode('cp932'), ) 　con.execute(sql,l) con.close()
お使いのDBMSによりますが。SQL規格に沿えば WHERE 列名 LIKE '%/data' ACCESSなら WHERE 列名 LIKE "*/data"
30代の男です。 作成したクエリ文を載せるほうが回答をもらうためにもよいと思います。 おそらくですが、 SELECT 明細データ.商品名 , 明細データ.区 , [コード表].変換CD FROM 明細データ LEFT JOIN コード表 ON (明細データ.区 = [コード表].区) AND (明細データ.商品名 = [コード表].商品名); とされていると推察します。 ここで問題とされていますデータ「CCCCCC,NULL」の変換CDが「000299」に変換されない事に関してですが、 まず、「NULL値」であることが問題となります。 「NULL値」は「何も入力されていない」という事になりますので 「NULL値」と「NULL値」を結合させ、結果を表示させるという事はできません。 可能であれば、「区」の項目には「NULL値」ではなく、何か別の文字(半角スペース１つでも可)を 入力することをお勧めします。 すでに多岐に渡る人がシステムを使用しており、変更が不可能というのであれば、 「明細データ」と「コード表」それぞれに以下のようなクエリを作成し、クエリ同士で 結合を行った結果を「結果リスト」とすれば表示は可能です。 ------- クエリ：明細データ変換 SELECT 明細データ.商品名, Nz([区]," ") AS 区変換 FROM 明細データ; ------- クエリ：コード表変換 SELECT [コード表].商品名, Nz([区]," ") AS 区変換, [コード表].変換CD FROM コード表; ------- 上記二つのクエリは単純に [区]という項目の値が「NULL値」であった場合、半角スペース一つで項目を表現するという ものになります。 以上です。 分かりづらい所がありましたら補足にご記載ください。。
JavaからMDBだと、JDBC-ODBCブリッジを使う事になるんじゃないかなぁ。 だとすると、Macじゃ無理っぽいけど。 Windowsでも、別途ODBCドライバが必要になるよね。
まず、URLを調べます。 wikipediaで「お米」を検索すると http://ja.wikipedia.org/wiki/お米 となりますので、 ボタンに「URLを開く」を割当て、関数で「http://ja.wikipedia.org/wiki/お米」になるように式を作成すれば可能です。 Googleの場合はかなり複雑なURLになっていますので、同じようにできるかはわかりません。
1. 対象レコードをフィールド内容の全置換で計算結果で置き換えるを選んで 式は　名前フィールド＆"社員" です。 2. は　フィールドＡ＆フィールドB　で置き換え 全置換は失敗すると元に戻せないので必ずコピーファイル等で練習して下さい。
Visual Basic 6.0 で使用できるように Crystal Reports をインストールする方法 http://support.microsoft.com/kb/193336/ja
条件が矛盾してます。１０ｔ以下と以上と言いながら実際は逆の説明になってます。 また重量の単位はkgですか？累計重量で比較ですか？それなら言われている事はほぼ不可能ですが…？ もっと明確なご説明をお願いします。
いまいち状況が掴めていないので、外しているかもしれません。 私ならば、横一行にずらーっとは並べません。 比較する際にカメレオンのように目玉を動かさねばならないからです。 もし顧客ごとに一意なIDがあれば(同姓同名の人がいる場合を考慮)、ユニオンクエリで SELECT '商品１' AS F0,担当,電話番号,契約者ID,契約者名,契約者住所,商品名１ AS 商品名,契約日,支払方法,支払回数,毎月支払額,販売価格 FROM 平成２１年度 商品１データ一覧 UNION ALL SELECT '商品２' AS F0,担当,電話番号,契約者ID,契約者名,契約者住所,商品名２,契約日,支払方法,支払回数,毎月支払額,販売価格 FROM 平成２１年度 商品２データ一覧 ORDER BY 契約者ID,F0 ではダメかな？ UNION でつなぐと重複が排除されますので、その分時間が掛かります。 UNION ALL で良いと思います。 ご参考までに。
>レコードを他テーブルにコピーしたい それリレーショナルDB使う意味あるのか?#1の言う方法でいいだろ。
「データの順序」を保持する項目が必要ですね。テーブルにオートナンバー型の列を持っておけば「ORDER BY」でその列を指定することで可能かもしれませんが、すでに存在するテーブルにオートナンバー型の列を追加した場合どのように順番が振られるかは不定なのでうまくいかないかもしれません。
select * from テーブル where コード in ( select コード from テーブル t where exists ( select 1 from テーブル t2 where t.コード = b2.コード and t.カラム1 <> t2.カラム1 ) group by コード having count(*) > 1 ) これでもいいでしょうか。
諦める http://oshiete.goo.ne.jp/qa/3114305.html
１．　"Oxford"　直前の　２語を抜き出す。 ２．　"Maid in"　直後の　１語を抜き出す。 ３．　"Style Code:"　直後の　１語を抜き出す。 　こんな感じですか？
それから、補足になりますけど、 Accessはすぐ壊れる、とかよく言われますけど、 一人で使う限り、それはまずないですし、 そうなる人は、よっぽど自分で何も調べないか、本当に、相当、かなりメチャクチャな作り方を している人だと思います。 一人で使う分には、多少無茶な作り方にしても大丈夫です。Accessは。 マルチユーザー対応にするときは、少しコツというか、裏セオリー的な技がいりますが、 それでも壊れることはめったにありません。 テキストファイルとしてのバックアップと通常のバックアップ、 最適化だけをこまめにきちんとやっていれば、 壊れる壊れると騒ぐほうが不思議なくらいです。 ７００００件なら、バックアップさえちゃんとしてれば、何の問題もありません。 SQL Serverが扱えるからすごいとか、めちゃ便利ということも別に無いですし。 ソフトウェアは適材適所で使うものなので・・・・。
#5の人に追加の形だけど >あくまでも、パーソナルデータベースツールです。 これって個人向けのデータベースって言いたいんだろうね。 だからといってリレーショナルデータベースではないという説明にはならないよ。 リレーショナルデータベースは関係モデルを採用しているデータベースのこと。 >複数のユーザーが同時に接続すると途端に排他制御の貧弱さが露呈します。 トランザクションの機能でリレーショナルデータベースやそのマネージメントの機能とは関係ないからね。 まぁプログラミング言語側からだとAccessでも最低限のトランザクションは扱える。 ただしAccessの場合ファイルタイプのデータベースなのでデータが大きくなってくると どうしてもメモリに常駐するタイプのDBに比べて不利になる。 同じようにファイルタイプのDBのSQLiteにも同じようなことがいえる。
すみません、訂正です。 「http://192.168.xxx.xxx/仮想ディレクトリ名/データアクセスページ名」で、 は、 「http://ホスト名またはグローバルIPアドレス/仮想ディレクトリ名/データアクセスページ名」で、 に訂正させてください。 すみませんでした。
すいません訂正です。 中小零細は、日本の企業の80割りをしめます。 は 中小零細は、日本の企業の8割りをしめます。 でした。 ごめんなさい。
おっと、参考URL。 http://support.microsoft.com/kb/303814
余計なお世話ですが気になるところをいくつか・・・ (1)MySQLだけの話ならMySQL板があります (2)正規化の手法としてはテーブルに埋め込む商品を特定するidは一義なものを 使うべきかと とくに他の回答者からもあるように1:1以外のデータがあると整合性に欠けます。 (3)STOCKを複数のテーブルで管理する意義はあるのでしょうか？ またTABLE1のフラグが立ってなければ同期するというロジックがわからないです。 普通考えればSTOCKはストック用のテーブルに商品IDと数量をいれておくものだと 思うのですが・・・
ネットワーク上、ということの「ネットワーク」の意味が、イントラネットなのか、 それともインターネットなのかで答えが違ってきてしまうと思いますので、 そこをまずは明確にしたほうが良いと思います。 イントラネットなら、そのまま流用が簡単にできると思いますが、 インターネットなら、データベースにAccessのファイルを使うとなると・・・ どうやってやるんでしょ？ ブラウザからPHPやASPでアクセスするんじゃないんですもんね・・・ それに、Accessのmdbなどだと、ユーザー別セキュリティがかけられないと思ったほうがいいので インターネット上では使えないと思います。 「データベースをネットワーク上に配置してアクセス」の目的も明確にご提示されたほうがよいと思います。 どんなデータベースを作って、何人が同時にそこへアクセスし、どういう機能を持たせたいのか どういう処理をさせたいのか、などをご提示されたほうがよいと思います。 でないと、今の VisualBasic2008とAccess2010 を使っての学習が、 すべてとはいいませんが、かなりムダになるおそれがあると思います。
アップデートはしてますか。 http://www.filemaker.co.jp/support/downloads/?na …
たぶん、.dumpでアウトプットし直すのが一番手っ取り早くて確実かと。 詳しくは、SQLite shellのリファレンスをご覧ください。 その他、tclやCなどでインポートプログラムを自作する等の手も考えられます。 参考URL：http://www.sqlite.org/cvstrac/wiki?p=ImportingFi …
セルA2に年齢 セルB2に「要介護」or「空白」 とすると、C2に表示させるには、 =IF(B2="要介護",2000,IF(A2>=65,5000,2000)) と入力します。
2010は持っていないので、2007での例になります。 （添付図のような感じと仮定します） サブフォーム） ・ヘッダ or フッタに総合計用のテキストボックス「txts1」を配置 　　コントロールソース：　=Sum([金額]*[数量]) 　　書式：通貨 ※ 画像では「金額」ではなく「単価」となっています メインフォーム） ・一定金額用テキストボックス「txt1」を配置 　　書式：通貨 ・サブフォームの総合計を表示するテキストボックス「txt2」を配置 　　コントロールソース：　=[FSUB].[Form]![txts1] 　　書式：通貨 　※サブフォームコントロール名を「FSUB」と仮定 ・差額表示用テキストボックス「txt3」を配置 　　コントロールソース：　=[txt1]-[txt2] 　　書式：通貨 　　条件付き書式を設定（※不要かも） 　　「フィールドの値」「次の値より小さい」「0」にして、太字/赤色 これで、近い動きになると思います。 図は帳票表示ですが、単票表示でも総合計は求まります。 ※　「txt2」「txt3」「txts1」は見るだけなので、 　　「編集ロック」を「はい」、「使用可能」を「いいえ」にしても・・・ ※　サブフォームに配置した「txts1」は、「可視」を「いいえ」にしても・・・ ※　追加したテキストボックスは表示するだけです。（保存はしません） ※　後は「txt1」に、どこからか一定金額を設定する処理を入れれば・・・と思います。 　　（現在は手入力） ※※ 基本は上記のような感じですが、引っかかるところが１つ２つ > ・金額（dlookupを使って「商品一覧表」から金額を表示しました） これは「金額」のコントロールソースに =DLookup("金額","商品一覧表","商品名 = '" & [商品名] & "'") とか記述しているのでしょうか。 であれば、上記「txts1」で記述した =Sum([金額]*[数量]) はエラーとなります サブフォームは「テーブル１」から作られているようなので、 レコードソースに指定する部分を見直します。 SELECT T1.*, T2.金額 FROM テーブル１ AS T1 INNER JOIN 商品一覧表 AS T2 ON T1.商品名 = T2.商品名 ・・・・ とかにしておくと、商品名が入力された時点で「金額」が表示されます。 表示上「金額」は入力するところではないので、入力できないようにしておきます。 この状態であれば、上記「txts1」で記述した =Sum([金額]*[数量]) を使えます。 なお、テーブル１にも「金額」があり、「商品名」の更新後処理で 　Me.金額 = DLookup("金額","商品一覧表","商品名 = '" & Me.商品名 & "'") と都度参照設定しているのであれば問題はなく、そのままで良いと思います。 キーポイントは、「金額」「数量」ともレコードソースで得られている・・・・ ※ > サブフォームの「合計金額」の『総合計』を表示したいです。 が、複数のサブフォームの合計という意味なら上記は関係ありません。
解決策ではないですが、気になったことを ＞アクセス数が増えパフォーマンスが悪くなった MySQLの問題と言っても大きくいって４つは検証すべきことがあります (1)インデックスの問題 単純に非効率なSQLを吐いていたらなんのSQLでやってもたいして 改善はみこめません。 ただし、更新・削除が遅いとなるとインデックスでなんとかなるとも言えません。 (2)エンジンの問題 MySQLの特徴はエンジンが選べること 特に高速な処理をしたい場合はトランザクションを設定せずにMyISAMを 利用するのも手です。また一時的にHEAPをつかったりいろいろ改善の手は あるかも知れません。 (3)MySQL自体の問題 ここ数年話題になっている「そもそもMySQLはフロントエンドがおそいので エンジンを活かしきっていない」という問題があります。 そこでNoSQLなどがもてはやされたりしているのですが、さらにすすんで 「HandlerSocket」などで高速化するのも検討できるようになってきました。 参考：http://itpro.nikkeibp.co.jp/article/Interview/20 … (4)ハードウェア的な問題 ハード的な問題もあるし、メモリの利用状況などもあるので ハードの強化でなんとかなるかもしれません。 とくにMySQLはマルチCPUに比例的に高速化ができるらしいので やすくてもマルチコアCPUにするだけでおおきくパフォーマンスが あがる可能性があります。
http://www.atmarkit.co.jp/fwin2k/win2ktips/404ac … とか参考にしてください Access　MSDE　とキーにしてWeb検索かけてもたくさんヒットするでしょう ODBCドライバで他のデータベースに接続させ、Accessをフロントエンドとして利用する方法なども上記に関連するページから見れますがSQLServerが相手ならばadpファイルでやった方が簡単に思えます http://www.atmarkit.co.jp/fwin2k/win2ktips/404ac … adpならば参照するテーブルとなる部分を非表示にも出来たはずなので、オペレート操作するだけの人に余計な操作されずにすんだりしますからお勧めですよ 使うオペレータは起動の際にAccessに似たアイコンをダブルクリックする 起動した画面はAccessその物なので操作にまったく違和感は無い だけど、接続しているデータベースエンジンはSQLServerになっているって感じです Accessのフォームとかレポートも使用出来るので、作る方はクエリーの代わりにストアドプロシージャを使ってデータベース操作させるように作らないといけませんが、それほど難しい物ではありません MSDEに関する書籍はたくさんあると思います MSDEはSQLServerのデータエンジンを容量など制限した機能制限されたSQLServerなので、そのままSQLServerにアタッチさせているのと同じ事になりますから、juujuu2929 さんが行おうとしている事を問題なく出来ますよ pin's Laboratory　なんかは、実際にデータベース構築している時に迷ったら利用されると良いサイトです 丸投げはダメですが、ストアドプロシージャをこう作成したが、思った通りの動作にならないなど、やってみたんだけれどこうならないのような質問出せば、有識者がきちんと対応してくれます http://www7.big.or.jp/~pinball/
>当日の日付けを自動入力させます。 これって、作成日の自動入力に設定しているのですか？ だったら変えられません。 計算値自動入力で式をGet(日付)にします。 ＋1のボタンのスクリプトは フィールド設定[その日付フィールド ; その日付フィールド+1]
キーボードの「command」を押しながらオブジェクトを移動させるか キーボードの矢印「↑」「↓」「←」「→」 参考URL：http://www.okigaru.info
Q、こんな感じでコードに書き換えられますか？ A、出来るが無意味。 在庫フォームの値を参照するという考えに無理があると思いますよ。 ・入出庫伝票に基づいて入力する。 ・入力データは、入出庫履歴として保存する。 ・在庫は、在庫マスター（商品マスター）で管理する。 ＞在庫フォームはクエリを基に作成しました。 これが無理の元凶です。 無理１、入出庫伝票は入力だけでなく訂正や削除も発生する。 無理２、だから、式＝（数量＜現在庫）の真偽は流動的である。 無理３、現在庫が信頼できない上に参照にも時間がかかり過ぎる。 この無理の１～３を解決するのはテーブル構造のみ。 だと、思いますよ。
Filemakerに切り替えましょう。全部簡単に連携できます。
30代の男です。 単純に考えて作成しました。 SELECT 　COUNT(A.[地域番号]) AS [該当件数] FROM ( 　　　　　SELECT [地域番号],[区分番号] 　　　　　FROM [テーブル１] 　　　　　WHERE [評価]="1" 　　　　　GROUP BY [地域番号],[区分番号] 　　　　 ) AS A INNER JOIN ( 　　　　　SELECT [地域番号],[区分番号] 　　　　　FROM [テーブル１] 　　　　　WHERE [評価]="2" 　　　　　GROUP BY [地域番号],[区分番号] 　　　　 ) AS B ON A.[地域番号]=B.[地域番号] AND A.[区分番号]=B.[区分番号] 説明ですが、 「AS A」前の括弧内でまず、「評価」が１である「地域番号」と「区分番号」を持つレコードを抽出 「AS B」前の括弧内で「評価」が２である「地域番号」と「区分番号」を持つレコードを抽出 これら二つの抽出データを「INNER JOIN」で結合すると、 「評価」が１と「評価」が２の両方にデータが存在する情報のみ抽出できる。 「評価」が１と「評価」が２の抽出条件の両方にデータが存在するという事は ２レコード以上存在していると見て問題ない。 よって、それらの結果に対してCOUNTしてあげれば、抽出したい件数が求めることができます。 なお、各行は途中のスペースが削除されないために「全角スペース」を入力しています。 実際のACCESSに複写する際に「半角スペース」に変更してください。
説明文通りにSQLつくればいいと思いますが。。。 ＞t1とt2のIDが同じで、t2の日付がt1の日付以下 t1.ID = t2.ID and t1.日付 >= t2.日付 で結合 ＞最大のレコード t1.ID, t1.日付で集約してMax(t2.日付) --- SELECT t1.ID, t1.日付 AS 日付1, Max(t2.日付) AS 日付2 FROM t1 INNER JOIN t2 ON t1.ID = t2.ID and t1.日付 >= t2.日付 GROUP BY t1.ID, t1.日付;
以下ではどうですか。 DAOをつかっているので、参照設定で Microsoft DAO xxx Object Library　にチェックが入っているか 確認してください。 Sub test() Dim strSQL As String Dim db As DAO.Database Dim rs As DAO.Recordset Dim str As String strSQL = "SELECT T_誕生日マスタ.名前, T_誕生日マスタ.誕生日 FROM T_誕生日マスタ WHERE ((T_誕生日マスタ.誕生日)=Date());" Set db = CurrentDb Set rs = db.OpenRecordset(strSQL) If rs.RecordCount > 0 Then rs.MoveFirst Do Until rs.EOF str = str & rs!名前 & "さん" & Chr(13) rs.MoveNext Loop MsgBox "今日は" & Chr(13) & str & "の誕生日です" End If rs.Close: Set rs = Nothing db.Close: Set db = Nothing End Sub
No10の あるいは、関数を使った使用例 のところで、以下のSQL文 SELECT TA.商品名 FROM 商品テーブルA AS TA INNER JOIN 商品テーブルB AS TB ON TA.商品名=funcAAA(TA.商品名,TB.商品名); を SELECT TA.商品名 FROM 商品テーブルA AS TA INNER JOIN 商品テーブルB AS TB ON TA.商品名=funcA(TA.商品名,TB.商品名); にしてください。関数名のfuncAがfuncAAAになっていました。
テキストボックスだとプロパティウィンドウでIME をコントロール出来るのですが。 インプットボックスでは簡単にできません。 IME のコントロール http://www.vba-world.com/ime_ctrl.html InputBoxでIMEをオンにする http://officetanaka.net/excel/vba/tips/tips16.htm VBAでIMEの操作はできます http://questionbox.jp.msn.com/qa3103148.html を参考にしてください。 参考URL：http://www.vba-world.com/ime_ctrl.html
最初にレポートを作った手順を覚えておられたら その概要を補足してください。
補足をよんでいなかったので、In句の中身の使い道 がわかりませんでした。 コード　IN（○○,××） ○○,××は、元フォームに表示されているレコードになりますので ということならば、No3の方の回答の、 strWhere = ",'" & !コード & "'" を strWhere = strWhere & ",'" & !コード & "'" にすればよろしいかと。
色々と方法は有りますが下記リンクの、１番でよろしいのでは？ http://officetanaka.net/excel/vba/tips/tips39.htm １番の方法で複数のファイルを選択したい場合は Ctrl + G でイミディエイトウィンドウを出して そこに、filedialog と入力しF1キーを押して出るヘルプにそのまんまが載っています。
クエリで順番を指定する。　順番を指定する項目がないなら、レコードを1件ずつ順番をつけながら取り込む。 （インデックスのフィールドの属性が、数値であるべきところを文字列としていると文字列順に並んでしまうことも有る。）
順序を維持したいなら、何かの条件が必要。 ex）得意先コードの昇順・購入日付の昇順など。 インポートするデータに、上記のような条件付けが可能な列（フィールド）が無ければ オートナンバーを使用した「主キー」列を設けるのも手です。 インポートした順になります。 エクスポートするときに、上記の列で並べ替えしておけばＯＫ。
GROUP BY でも同様のことができます。 重複行削除するのがDISTINCTで、 集合演算をするのがGROUP BYですが、 パフォーマンスはGROUP BYの方がよいらしい。 --- select A from Table group by A
リレーションシップが設定されているかフィールドの名前などからされていると判断された場合は、デザインビューでテーブルを追加した時点でフィールド同士が線でつながって（ジョインされて）います。 リレーションシップはクエリのデザインビューで設定することもできますし、最初から設定しておくことも可能です。　私は個人的には、アクセスの場合原則的にリレーションシップを設定しません。　クエリでジョインの設定をするだけです。 パフォーマンス上違いがあるかどうかは良くわかりません。　多分同じ処理をしているのだと思いますが、詳しく知りません。　適正なインデックスの設置と最適化がされていることのほうが大切だと思います。
一般的にはレコードはExcelで言えば一つの行がAccessの一つの レコードにあたります。したがって、9ｘ9の塊を一つのレコード とすることはできません。したがって、上記のデータを 一つのレコードとする単票フォームはつくることができません。 単票フォームに非連結のテキストボックスを81個置き、 VBAでデータを取得して、あるいは取得しながら テキストボックスにデータを表示することは可能でしょう。 ただし、VBAでグリグリ書く必要があります。 単票フォームでなく、表形式のフォームならばExcelの データを普通にAccessにインポートし、Excelの一つの 行をレコードとして処理するならば、表形式の フォームをつくればそのままデータが表示されます。 何をするのかはわかりませんが、9ｘ9の塊を9ｘ9の配列に入れ、 その配列をもう一つの配列に入れて複数の9x9のデータの塊を 処理をすることはできます。 しかし、VBAに熟知していることと、このような配列はメモリを 非常に圧迫することなど、かなりハードルは高いのが現実です。 また、Aceessに４つのフィールドを作り、 9ｘ9のExcelのデータ、その列、行の位置データを同時に 取得しながらAccessにインポートし、同時に塊としての 認識データを追加し(すなわち横のものをすべて一列に 入れるという感覚で)、そののちテーブルからフォームの 非連結テキストボックスにデータを表示するVBAを作る、 という手の込んだことをすればある程度のことはできると 思いますが。
No2です。 サブフォームのレコードソースがテーブルならば、 そのテーブルをもとにクエリを作成し、抽出条件に 条件を設定し、それをサブフォームのレコードソース にするか、あるいはサブフォームのレコードソースで クエリビルダを起動し、クエリと同じような条件設定 をして閉じ、OKという方法ならば、 フォームを印刷プレビューにしても レコードはフィルタがかけられた状態になります。
該当コントロールの値が変更されてフォーカスが他のコントロールに移る前に発生するイベントです。 フォームのデザインモードでコントロールを選択した状態でプロパティシートを表示します。イベントタグに「更新後処理」という見出しの項目があります。 デフォルトでは空白ですが、空欄の下向き矢印「▼」をクリックすると「イベントプロシージャ」と表示されるのでそれを選択し、その右にある「...」のマークをクリックすると自動的に更新後に行う処理のひな形が作られ、そのプログラムの編集画面に移ります。 ただ、個人的には更新前処理の方が使う場面が多いですね。入力チェックしてエラーメッセージを出して再入力をさせるなどは更新前処理で行います。
ADOXやDAOを利用すれば、テーブル定義情報を列挙できます。 詳しくは、各APIのドキュメントをご覧ください。 参考URL：http://msdn.microsoft.com/ja-jp/library/cc389593 …
(1) Excelのシートをテーブルとしてリンクして、 普通のテーブルのような扱いで、データを 取り出すことができます。 ツールバーの「ファイル」「外部データの取込」 「テーブルのリンク」と進めて、Excelファイルを 指定して、表示される「ワークシートのウィザード」 を利用してデータを抽出します。 この場合、Accessのバージョンによっては リンクしたしたシートは参照のみでデータを 書き変えたりすることはできません。データを 別テーブルに移し変え、加工することは できます。 (2) (1)の「外部データの取込」から「インポート」 を選択すれば、同様にウィザードを利用して データを取り込むことができます。 (3) Excelのファイルの特定のデータを選択し、 Excelのツールバーのデータから「Ms Accessに変換」を 選択してウィザードに従ってデータをAccessに 送り込むことができます。 (4) その他、複雑な処理があらかじめ必要な場合は VBA等を使って処理をしながらデータを Accessから取り込んだり、ExcelからAccessに 送り込んだりします。 上記のような感じですが、そのときの条件によって 最適な方法は変わる可能性があります。分からないときは 具体的な内容を質問の中にいれることをお勧めします。
テキストボックスのプロパティを開いて、 タブ移動順を変更します。
クエリに条件を設定するときは、クエリのデザインビューで、 (以下はグループ化の場合) フィールド　　　　　NOの先頭　　　　　　　他のフィールド テーブル　　　　　　　テーブル1　　　　　　テーブル1 集計　　　　　　　　　　先頭　　　　　　　　　グループ化 並べ替え 表示 抽出条件　　　1110 Or 1230 Or 124 または のように、抽出条件のところに入れます。また、 Orなどは上記のように半角開けて設定します。
可能です。テーブルを作って、条件等で関連付けることが出来ます。テーブル同士もつなげて、１つのデータを棒状のようにつなげることも可能です。
Accessのヘルプには、 警告音の周波数と継続時間は、ハードウェアに依存するので、 コンピュータの機種によって異なる場合があります。 Visual Basic で "Beep/警告音" アクションを実行するには、 DoCmd オブジェクトの Beep メソッドを使用します。 これを前提に、過去の質問にも同じようなものがあります。 http://oshiete1.watch.impress.co.jp/qa4043791.html あまり、OSに依存した部分にアプローチすると 方法によっては元に戻すのが大変な場合があります。 したがって、WEBで検索した方法についても 慎重に行なってください。たとえば、API、レジストリ などにもアプローチする方法があります。
lightboxさんの「SQLの窓」ほどメジャーではありませんが、以下の簡易SQL実習教材を作っています。よかったら操作してみて下さい。 http://www.vector.co.jp/soft/cmt/win95/edu/se479 … 入門書とACCESSの.mdbファイルの実習用データベースを3種類、圧縮していますので、「SQLの窓」でも私の「アクセスデータベースSQL操作ページ」でも接続して適当なSQLコマンドを試してもらえます。 リレーショナル型データベースの実感がつかめれば、自分なりのデータベースを用意して操作してみるといいでしょう。
テーブルにどのようにデータが入っているのですか 教えてください
>USING (SELECT '12345' key from dual) acにあるdualは任意の名称でしょうか？ すみません。dual表はOracleでのダミーテーブルのようなものです。 対象のデータベース名が書いていなかったのに、当方の環境でのSQLを書いてしまいました。 ですので、上記の箇所はお使いになっているデータベース製品に合わせて修正してください。
No1です。 レポートフッターに表示する場合は、 レポートフッターに置いたテキストボックスの コントロールソースに、 =Sum([金額]) としても表示されます。ページフッターに =Sum([金額]) とすると、エラーが表示されます。
候補キーとは， １つの表において行を一意に識別できる属性集合のすべて。 （一般的に，主キーとなり得る候補は複数存在するので） 主キーとは， 候補キーのうち設計者によってただ１つ選ばれた属性集合。 その属性値は，重複値はなく空値もない（unique かつ not null） 外部キーとは， 他の表の主キーに向けて参照関係が結ばれている属性。 キーワード「主キー　外部キー」でGoogle画像検索して上位にヒットしたページ例がこちら。 http://www.witc.co.jp/program/education/ops/ac/a … 内部キーという用語は知りません。 キーワード「"内部キー"」をGoogle検索すると， 　> 次の検索結果を表示しています: "外部キー". と誘導されますから，それほど一般的な用語ではないようにも思います。 利用者が関知する自然キーに対して，システム内部で生成される便宜上の一意属性を人工キーと呼びますが，これを内部キーと呼んでいる可能性はないですか？ http://ja.wikipedia.org/wiki/主キー
計算式で検索はできません。 除外条件がよく判りませんが、電話番号にスペースが 入っていないとして、簡単そうなのは 検索モードにして フィールド(1)に02を入れる フィールド(2)にAを入れる 除外 新規検索条件 フィールド(1)に03を入れる フィールド(2)にAを入れる 除外 検索実行 対象/対象外を入れ替える か 検索モードにして フィールド(1)に02を入れる フィールド(1)に03を入れる 新規検索条件 フィールド(2)にAを入れる 除外 検索実行 対象/対象外を入れ替える のどちらかをスクリプトにするだけです。
たとえば =ROUNDUP(1.5,0) は2.0ですが小数点以下を必ず0.8(この場合2.8)にしたいのでしたら 単純に =ROUNDUP(1.5,0)+0.8 とすればいいのではないでしょうか。
>Jetがまともに動かなくなるのはどういう操作をしたときですか どういう操作というよりも、データベースにアクセス出来ないアプリケーションがでてきてしまいました。
No1を訂正します。行数をカウントすることに します。 Private Sub txメモ_Enter() If UBound(Split(Me!txメモ, vbCrLf)) = 0 Then Me!txメモ.SelStart = Len(Me!txメモ) End If End Sub のように。
VBAを使用する回答(ACCESS単独では、正規表現が利用できませんので、VBAからVBScriptなどを呼び出して正規表現を利用する必要があります)は、すでに出ているので、関数とクエリだけで行う方法をひとつ。 特定の文字列を削除するには、REPLACE関数を使用して、対象文字列を""に置換すればできますが、残念ながら、REPLACE関数は、ワイルドカードが使えません。 そのため、今回のような、(不定の文字列)を置換することは単純にはできませんが、RIGHT・MID・LEFT関数とINSTR関数をうまく組み合わせて、更新クエリを作成すればできます。 削除したい(文字列)が、間違いなくフィールドの左端(1文字目)から入っているのなら、以下のように更新クエリを作成して実行で完了です。 1.削除したい(文字列)を含むフィールド(仮に「F1」とします)だけを持つ選択クエリを作成する。 2.抽出条件:に、InStr([F1],"(")=1 と入力する。 3.選択クエリを、更新クエリに変更し、レコードの更新:に、 Right([F1],Len([F1])-InStr([F1],")")) と入力する。 そのまま更新クエリを実行するか、一旦保存してから、その更新クエリを開けば削除完了です。 削除したい(文字列)の位置が不定でも、関数を適切に組み合わせることで、いろいろな条件に対応できます。
No2の そのコントロールソースに sum([単価]*[数量]) を設定してみてください。 の「その」とはテキストボックス のことです。つまり、 そのテキストボックスのコントロールソースに sum([単価]*[数量]) を設定してみてください。 ということです。テキストボックスのプロパティで 設定します。
オプション設定で行えます。 Access2010ではクライアント設定に、Enter キー入力後の動作 があります。 VBAなら、 Application.SetOption("Move After Enter),0　　'停止 Application.SetOption("Move After Enter),1　　'次のフィールド Application.SetOption("Move After Enter),2　　'次のレコード また、入力後に『Enter』 の代わりに『↓』とか。 マルチポストは止めましょね。 「マルチポストが嫌われる理由～なぜマルチポストは問題か」 http://stakasaki.at.webry.info/200512/article_3. … 嫌気がさして去って行かれる方が・・・
Private 削除ボタン_click() Me.undo exit sub で入力前の状態に戻るはずですけどねぇ？ Me.Undo の前に、Me.Recalc とか Me.Requery って入れてませんよね？ クリックする前にはレコードセレクタが編集中のアイコン（鉛筆マーク）になってますよね？ 帳票フォームの場合に削除ボタンを詳細セクションに置いてあって そのレコードのボタンではなく前後のボタンを押しているとか？ レコードが移動すればその編集中のレコードは確定されます。 Undo で戻せるのは編集中の場合だけです。 キーボードのESCキーを押した場合と一緒です。確定したものを元には戻せません。 Private 削除ボタン_click() If Me.Dirty Then Me.undo Else Msgbox "編集中ではありません" End If exit sub コードの内容をこんな風に差し替えてみたら・・ それでもダメならもっと詳～～細な説明が必要ですね。
30日前以前ではないの？ "≤ "＆Get(日付)-30
フォーム上にPDFを表示させるのはこの辺を見てもらうとして http://www.tsware.jp/tips/tips_440.htm 私の環境ではAdobe PDF Reader しか見つかりませんでしたのでこれを入れました。 ※但し単票フォームの場合だけです！ 帳票フォームの詳細セクションに表示させようとすると 全てのPDF表示が同じになってしまいます。個別に表示させる方法は知りません。 フォームに配置したAcrobatのActiveXコントロール名を、AcroPDF とします。 フォームの移動時イベントに Private Sub Form_Current() Me!AcroPDF.src = "適当なPDFファイルのフルパス" End Sub でとりあえず表示は出来ますが当然のことながらPDFが切り替わることはありません。 そこでテーブルにPDFファイルのフルパスを格納するフィールドを設けます。 テキスト型フィールドサイズ255 格納する値の例として、d:\DB\郵便番号\郵便番号制マニュアル.pdf みたいに。 さていよいよ佳境に。 新たに設けたPDFファイルのパスを格納するフィールド 仮にPDFpath とします。 ここにパスを入れてゆくのですが、 今回はそちらの環境が全く分かりませんので地道に一個ずつ行う場合です。 たとえばフォーム上でPDFpathテキストボックスのダブルクリック時に Private Sub PDFpath_DblClick(Cancel As Integer) 　　'要参照設定 Microsoft Office xx.x Object Library 　　With Application.FileDialog(msoFileDialogFilePicker) 　　　　.InitialFileName = "D:\"　　　　　　　　'初期検索先指定 　　　　.Title = "ファイル選択" 　　　　.AllowMultiSelect = False　　　　　　　　'複数ファイル選択の不可 　　　　.Filters.Clear　　　　　　　　　　　　 'ファイルフィルタの設定 　　　　.Filters.Add "PDF ファイル", "*.pdf" 　　　　.ButtonName = "決定"　　　　　　　　　　'ボタンの表示文字列の設定 　　　　'キャンセル時にはShowメソッドは0(Long型)を返す 　　　　 If CBool(.Show) Then 　　　　　　Me!PDFpath = .SelectedItems(1) 　　　　 Else 　　　　　　 Cancel = True 　　　　 End If 　　 End With End Sub とかでしょうか。後はご自身で調べてください。私からはここまでです。
Accessで全て処理するのが一番だと思います。 以前、Accessを入れていないPCでExcelで行っていた時には シート上五行位をコマンドボタン・一時テキスト置場・説明文などを置いといて それから下はレコード表示。 主キーのレコード有無でAccessに無ければ追加クエリかレコードセットで処理。 既存のレコードをAccessからExcelに展開して修正を加えた場合は 修正を加えていないものも含めて更新クエリかレコードセットで処理してました。 無駄を含む処理なのですが、どうせ変更の有無確認処理をどこかでやらねばならないのなら まとめて更新処理をした方が楽だったので・・。 Accessで全てまかなえませんかね～。
以下のような方法で。 削除コマンドのクリック時に Dim rs As Recordset Set rs = Me.RecordsetClone rs.Bookmark = Me.Bookmark rs.Delete rs.Close: Set rs = Nothing とします。 DAOを使っているので Microsoft DAO xx Object Library にチェックが入っているか参照設定で 確認してください。 なお、主キーなどにオートナンバー を使っていると削除したレコードの 番号が欠番となります。
No1です。 >ラベルはの部分はコメントアウトしてもいいです。 というのは、リンク先の Me.ラベル.Visible = False Me.ラベル.Visible = True の部分をコメントアウトするということです。 とくに使用しなければですが。
SQL文を書く前に、まずは不一致クエリを作成みてください。 作成したクエリで必要なデータが表示されるか確認してみてください。 場合によっては少し手直しをする必要があるかもしれません。 そのときは補足してください。 次に、できたクエリを追加クエリに変更します。 追加先テーブルはテーブル3とします。 わからないところがあれば補足してください。
ユニオンクエリを使います。 ユニオンクエリはデザインビューでは作成できません。 SQLビューで下記のように記述してください。 SELECT 売上 FROM テーブル1 UNION ALL SELECT 売上 FROM テーブル2 UNION ALL SELECT 売上 FROM テーブル3;
西暦から和暦に替えたいがためだけでクエリを組む必要はありません。 テーブルデザインで『日付』フィールドが日付時刻型になっているのなら その書式を、ggeemmdd にすれば良いだけです。 テーブルをいじりたくない場合でも、クエリのデザインビューでフィールドを右クリックし 現れたプロパティシートの中に書式が有りますので、ggeemmdd に設定してください。 入力や変更は西暦で行ってください。 今年の年月日なら月日だけ入力すれば、Access が自動的に補完してくれます。 9/14 → 2011/9/14 →平230914 質問のタイトルは質問内容が分かりやすいものにしましょう。
リレーションだけの本もあるのですか・・・ リレーションの基本はVer.7からほとんど変わっていないと思いますけど、 11（持ってないけど）ではポータルフィルターとか有るようですね。 リレーションのどんなところが判らないのですか？ 市販本で解決するのかな。
（１）処理待ちテーブルを集計し、重複のあるもののみ別テーブルに吐き出す。 （２）別テーブルにあるものを処理待ちテーブルから削除する。 （３）別テーブルから処理待ちテーブルに追加する。 で、よろしいかと。
＞Call F_ExecuteSQL("DELETE FROM " & TName & "") の F_ExecuteSQ　が関数として設定されているならば、 という条件で、コンパイルして、エラーがでなければ 実行できるはずです。 関数が設定されていないならばNo1のような方法で 簡単に実行できるはずです。 (1)、(2)、(3)以外の他の部分については エラーが出るのか確認はしていませんが。
No2 の方の参照先でも説明されてますが、 TransferSpreadsheetメソッドのRange引数で、セル範囲、または名前付き範囲 を指定できます。また、HasFieldNames引数を True にすれば先頭行をフィールド名とします。 今回は、6行目が見だし、7行目からデータですので、 DoCmd.TransferSpreadsheet acImport, , _ "取り込み先テーブル","C:\DATA\取り込み元ファイル.xls", True, "A1:G99" とすれば、希望に近いものになるのでは。
No7の中で、 GroupがもしItemGroupということならば、 (2)、(4)のクエリでGrouoとなっているところを ItemGroupとしてください。 以上以外に表記の違いは変更してください。 確認ですが、 GroupはItemの分類ですか？
新たに計算フィールドを3個作ります。計算式はそれぞれ Year(納期) Month(納期) Day(納期) CSV形式で書き出す時に、この3個のフィールドを書き出します。
閏年判定関数は下記でもいいですね。 Public Function IsLeapYear(aYear As Long) As Boolean 　　IsLeapYear = IsDate(aYear & "/2/29") End Function
No2です。ひょっとしたら登録した サブフォーム名と同じになっているかもしれません。 いずれにしても、デザインビューで サブフォームの縁を右クリックして プロパティで名前を確かめてみてください。
再インストールする
コードに間違いがありましたので、訂正します。 コマンドボタンクリック時のコードを下記に訂正 Sub コマンド0_Click() 　　Dim Res As String 　　Do 　　　　Res = InputBox("数値を入力してください", "数値入力", Res) 　　　　Res = StrConv(Res, vbNarrow) 　　　　Res = Replace(Res, " ", "") 　　　　If Res Like "*[!0-9]*" Then 　　　　　　MsgBox "数字だけ入力してください。" 　　　　Else 　　　　　　Exit Do 　　　　End If 　　Loop 　　Me.テキスト1 = Res End Sub 更新前処理のコードを下記に訂正 Private Sub テキスト1_BeforeUpdate(Cancel As Integer) 　　Dim Res As String 　　If IsNull(Me.テキスト1) Then Exit Sub 　　If Res Like "*[!0-9]*" Then 　　　　Cancel = True 　　　　MsgBox "数字だけ入力してください。" 　　End If End Sub
Access,Excelどちらでもよいので VBAを使用して文字コード変換してみて テキストデータを出力してみてはどうでしょう 文字コードをS-JISからUTF-8に変換する http://cats.yuki-mura.net/sjisutf.html 参考URL：http://cats.yuki-mura.net/sjisutf.html
方法は複数考えられますが、乱数は作れるわけなので、数値から文字を作り出せれば解決ですよね？であれば、CHAR関数が使えます。これは太古の8ビットPCでBASICを使っていた人には馴染みやすい関数ですが、CHAR(数値)とすると、数値を文字コードとした文字が返ってきます。例えばCHAR(65)の結果はAです。CHAR(66)ならBで、67はC。以下順番に続き、90がZになります。小文字は97～122でa～zになります。と言うことは、 １）65～90の乱数を作る部分 ２）97～122の乱数を作る部分 ３）0～9999の乱数を作る部分 ４）乱数の重複をはじく部分 ５）最初の二つの乱数から文字に変換し、0～9999の乱数とくっつける部分 これだけの処理を集めればよいことになります。 １）～３）は、RANDBETWEEN関数を使えば一発です。すでにご存じかも知れませんが。 http://www.relief.jp/itnote/archives/001184.php ４）の重複をはじく部分ですが、うまい関数があります。 http://www.relief.jp/itnote/archives/001798.php ここまでくれば、あとはもうできますよね。 おまけに、もしパスワードに記号を使いたくなった場合に備えて、文字コード表（ASCIIコード表）のリンクを貼っておきます。記号もコードさえ解れば、アルファベットと同じくCHAR関数で簡単に作れますから。もし何なら、数値もCHAR関数で作ってしまうこともありですね。 http://www9.plala.or.jp/sgwr-t/c_sub/ascii.html
>社員原価というのはテーブル名でしょうか？ すみません、社員単価入力テーブルのことです。 質問者様の「コード」と「モジュール」の違いがいまいちわからないのですが、 全てイベントプロシージャに書いてもできるかなぁと。 Private Sub 日給のテキストボックス名_GotFocus() 　Dim db As Database 　Dim rs As Recordset 　Dim strSQL As String 　Dim 最新日付 As String 　Dim 原価金額 As Currency 　Dim 残業単価 As Currency 　'--入力チェックなど 　If IsNull(Me![個人ID]) Then Exit Sub 　If IsNull(Me![日付]) Then Exit Sub 　Set db = CurrentDb 　'--入力日付以前の最新日付の取得 　strSQL = "SELECT MAX(日付) as 最新日付 FROM 社員単価入力テーブル WHERE 個人ID = " & Me![個人ID] & " and 日付 <= " & Me![日付] & "" 　Set rs = db.OpenRecordset(strSQL) 　最新日付 = rs.Fields("最新日付") 　rs.Close 　'--↑で取得した日付と一致する社員単価入力テーブルのレコードを取得 　'--（※職位手当などが社員単価入力テーブルにあると仮定してます） 　strSQL = "SELECT * FROM 社員単価入力テーブル WHERE 個人ID = " & Me![個人ID] & " and 日付 = " & 最新日付 & "" 　Set rs = db.OpenRecordset(strSQL) 　原価金額 = rs.Fields("原価金額") 　職位手当 = rs.Fields("職位手当") 　職務手当 = rs.Fields("職務手当") 　日給 = (原価金額 + 職位手当 + 職務手当) / 24 　　 ←24で割るんですか？ 　残業単価 = (原価金額 + 職位手当 + 職務手当) / 24 / 8 * 1.5　　←24で割るんですか？ 　Me![出力するテキストボックス名] = 日給 　rs.Close 　Set rs = Nothing 　db.Close 　Set rs = Nothing End Sub こんな感じで必要なテーブルの値を取得して、計算した結果をテキストボックスに表示すればいいのかなと。 SQLがわからなければ、DLookUPやDMaxで同じように値を取得することもできます↓。 　最新日付 = DMax("日付", "社員単価入力テーブル", "個人ID=" & Me![個人ID] & " and 日付 <= " & Me![日付] & "") 　原価金額 = DLookup("原価金額", "社員単価入力テーブル", "日付 = " & 最新日付 & "")
データベース製品はどれも一長一短で、『これさえ選べば大丈夫！』 のような絶対的な存在はありません。 このような選定作業をする場合は、各製品の 機能、性能、サポート状況、 信頼性、価格などをまとめた表を作り、システムで約束しなくてはならない 性能・信頼性や、コストを比較検討して決めるのが普通です。 なので、こんなところで噂話を集めてないで、何を比較検討しなくてはなら ないか、本気で考えて表を作り、それを埋めることからはじめてください。 どんな表を作ればいいのか皆目想像がつかないのであれば、先輩でも 上司でも聞いたら良いです。聞く人がいないような状態なのであれば、 悪いことは言いません、コストを割いてプロにお願いすることをお勧め します。
推測になりますが、 以下の様な情報があったので、記述されていたのでは・・・ Access 2007 のフォームでフィルタを実行する場合、抽出結果にフィルタが反映されない ​http://support.microsoft.com/kb/941800/ja​ ※ 実際のところは FOM に問い合わせてみた方が良いと思います。 ※ バージョンによっては不要だとか・・・・ ※ いつ頃修正があって・・・・とか、詳しく教えてもらえるかもしれません。 ※※ 私はマクロを使わないので、実際のところわかりません。
No.1です。 nora1962さんの回答を拝見して自分の回答の間違いに気づきました。 >where tableA.nameA = tableB.nameB は on tableA.nameA=tableB.nameB です。すみません。
Ｑ伝票合計 をデザインモードで開いて、SQLビューで見てみましょう。 （クエリーの中身は、実はこんなものなのです。 　ここが分からないとなると、掲示板ではなかなか伝え切れません。 　ACCESS入門書を購入してください。 　SQLビューで見てみれば、No2の回答がなんとなく分かると思います。） それをここに提示しましょう。 そうすればさらに回答が付くでしょう。
できません。 副次インデックスはCEATE INDEXで作成があります。 また、MySQLの場合インデックス名はテーブルごとに独立しており、テーブルが異なれば同一のインデックス名がつけられますが、PostgreSQLの場合はスキーマ単位で一意である必要があります。
データをまとめていいならこれでいけませんか？ select コード,0 from テーブル group by コード having sum(状態)=0
3つのフィールドと2つのフィールドが全く同じレコードの 削除でしたら 姓1＆"-"＆姓2＆"-"＆名1＆"-"＆名2＆"-"＆名3 などと連結して一つのフィールドにすればできますけど。
新規検索条件を作成して下さい。 それに条件を入力していけばor検索になります。
AとB、両方ともいったん最適化／修復してみたらいかがでしょうか？
できますなら、ユーザーに日付を縦方向に取る表や画面になれてもらうのが一番コストがかからないと思いますけど でないと無駄な作業ばかりが増える羽目になると思いますけど データベースは一般的に時間軸は縦方向に取るように仕組み上なっていますからそれに逆らうとあとあと不便なことになってしまう気がします 今回限りにしておくことをお勧めます
カッコがつながってしまいますけど コピー[ ] フィールドへ移動[ ]---指定しない とすると そのフィールドをクリックまたはそのフィールドへタブ移動 した時点でフィールド内容はコピーされますが フィールドへ移動[ ]---指定しない が効いているのですぐにフィールドから出て選択・変更はで きないはずなのですが。
重複レコードの検索・削除はいろいろな方法がありますし ヘルプにも書いてあります。 http://www.filemaker.co.jp/help/html/non_toc.46. … 削除の計算結果が保存されない場合は、別フィールドを 作って、その計算結果で全置換するといいのでは。
講師数の部分が「03」とあるので文字列な気がしますが、 数値であれば合っていると思います。 試せないのでしょうか？
FM社目線の比較表 http://www.filemaker.co.jp/downloads/pdf/compari …
実務レベルと、学習レベルだと模範になるモデルはかわってきます。 今回は学習レベルということでよろしいですか？ 実務レベルではご提示のようなデータの持ち方はありません →受注番号 受注日 得意先コード 得意先名 得意先住所 ｛商品コード 商品名 販売単価 受注数量 受注金額｝ (1)受注番号をプライマリとして処理するかどうか 通例、受注番号はユニークですが、特定の受注を修正する必要が出た場合 履歴の問題から受注番号を新たに振りなおす必要がでてきます。 それはビジネス的にはナンセンスなので、プライマリーなIDを別途もたせるか 枝番をつけるかのどちらかになります。 (2)得意先コードと得意先名、得意先住所は学習レベルでは正規化すべき項目ですが 実務レベルでは正規化できません。 つまり得意先の名前や住所は普遍性がなく、変わる可能性が高いからです。 逆に名前や住所がかわるたびに得意先コードを振りなおすケースもありますが そうすると集計性がそこなわれます。場合によってはこれも枝番を発行したりする ケースになるかもしれません。 (3)同様に商品コードは受注番号にひもづくとして、商品名は普遍性があると みて正規化することができるかもしれません、販売単価と受注数量は受注番号 に依存するものなので正規化対象ではないでしょう。 近年の傾向から消費税も変動的なものなので、税金も受注番号ごとに持たせる 必要がでてくると思います。 （実際は期日と税テーブルで対応は可能ですが集計を簡素化するためには有効） 受注金額も集計のため持たせるのが実務的ですが、計算結果なので学習レベルでは もたせる必要はありません。 (4)販売単価についてもマスター化できますが、ビジネスにおいては販売単価は ころころ変わります。当然実務レベルでは個別にもつのが常識で、学習レベルでは 商品マスターに埋め込めるかもしれません。 あわせて粗利なども個別受注ごとに持たせた方が集計はしやすくなります。 総じて・・・きっちりやるなら [販売データテーブル] *オリジナルID 受注番号 受注日 作成日 更新日 得意先コード 得意先名(受注時) 得意先住所(受注時) 商品コード 販売単価 受注数量 受注金額税抜 税額 受注金額税込 削除フラグ [得意先テーブル] *得意先コード 得意先名 得意先住所 注)結局名前と住所は二重でもつことになる [商品テーブル] *商品コード 商品名 となり、ざっくりとするなら [販売データテーブル] *受注番号 受注日 得意先コード 商品コード 受注数量 [得意先テーブル] *得意先コード 得意先名 得意先住所 [商品テーブル] *商品コード 商品名 販売単価 みたいな持ち方になるでしょうか・・・
DBMSによります MySQLならGROUP_CONCAT関数 PostgreSQLなら以下のサイトの要領 http://www.geocities.jp/oraclesqlpuzzle/postgres … Oracleなら http://www.geocities.jp/oraclesqlpuzzle/10-18.html 再帰SQLに対応していれば http://www.atmarkit.co.jp/bbs/phpBB/viewtopic.ph … の例が使えるかもしれません。
URLをhttp://maps.loco.yahoo.co.jp/mapsにすると検索トップ画面は 出ますけど。
ボタン設定の「内容を選択」のチェックを外す。
クロス集計での一例ですが ID　品番　金額 111　AAA　1000円 111　BBB　150円 222　ZZZ　300円 上記のテーブル名を「TB」、「ID」は数値型、「品番」はテキスト型と仮定します。 また、同一ID内で品番は重複しないものと仮定します。 テーブル「TB」をチョッと加工していきます。 重複した ID=111 の場合、レコード毎に横に表示していきたいので、 その「ID」の中で自分は何番目・・・を追加しておきます。 その順番のフィールド名を「C」と仮定すると、 C ID　品番　金額 1 111　AAA　1000円 2 111　BBB　150円 1 222　ZZZ　300円 になるようにします。 この状態にするには、クエリのSQLビューで、 SELECT DCount("*","TB","ID = " & ID & " AND 品番 <= '" & 品番 & "'") AS C, * FROM TB; (今回何番目は、品番の昇順でみてます) この「C」の値で、横に表示していきます。 また、横に表示する際、解釈するフィールドは基本１つです。 「品番」「金額」の２つを表示させたいので、細工をします。 上記テーブルの各レコードを倍にし、その時に番号を振っておきます。 番号のフィールドを「N」と仮定します。 N C ID　品番　金額 1 1 111　AAA　1000円 2 1 111　AAA　1000円 1 2 111　BBB　150円 2 2 111　BBB　150円 1 1 222　ZZZ　300円 2 1 222　ZZZ　300円 この番号を振りながら各レコードを倍にするには、 フィールド「N」（数値型）だけのテーブル「T_NO」を新設し、1 と 2 だけを登録しておきます。 前述のクエリのもの（以下 Q1 と記述）と、T_NO を直積させます。 SELECT * FROM T_NO, Q1 これで、加工した上記テーブルが出来上がります。 この「N」を何に使うかですが、 N=1 の時には、「品番」を扱いましょう N=2 の時には、「金額」を扱いましょう という具合です。 準備が出来たので、このテーブルを使ってクロス集計していきます。 上記テーブルを作りながら、クロス集計する記述は以下 （クエリの記述はこれだけで：上記説明用に記述したものも含まれています） TRANSFORM First(Choose(N,品番,金額)) AS 値 SELECT ID FROM T_NO, (SELECT DCount("*","TB","ID = " & ID & " AND 品番 <= '" & 品番 & "'") AS C, * FROM TB) AS Q1 GROUP BY ID PIVOT "NO" & C & Choose(N,"_品番","金額"); で、表示結果は ID　　NO1_品番　　NO1金額　　NO2_品番　　NO2金額 111　　AAA　　　　1000円　　　BBB　　　　150円 222　　ZZZ　　　　300円 のようになります。 PIVOT 部分は、列名を作るところですが、 PIVOT Choose(N,"品番","金額") & C の様にすると、 ご希望の「品番1」「金額1」のような「列名」になりますが、並び順に難あり。 作られた「列名」が文字列なら、文字列として比較並び替えられます。 サンプル上では、「金額1」「金額2」「品番1」「品番2」の順になります。 クエリをデザインビューにして、「クエリ列見出し」を設定することで、 並びを固定することができます。 以下は、「クエリ列見出し」を使わないでどうにか・・・っていう細工になります。 レコード毎に「品番」「金額」の並びになってもらいたいので、 番号は先頭に付ければ・・・数字で始まるのはヤダから "NO" を付けて・・・ PIVOT "NO" & C & Choose(N,"品番","金額") レコード毎になったのは良いけど、「品番」「金額」の順が逆・・・ じゃ、"品番" の前にだけ "_" を付けますか・・・ PIVOT "NO" & C & Choose(N,"_品番","金額") "NO" & C の部分は今回 1 ～ 6 という事なので、そのままで良いと思いますが、 C が 2 桁とかの場合は、C を Format(C,"00") とかにしないと・・・ 「NO1」「NO2」があって「NO11」もあると 「NO1」「NO11」「NO2」の順になるとおもいます・・・・ 参考にする/しない等、自己責任でお願いします。 以下のような方法もあるようです http://detail.chiebukuro.yahoo.co.jp/qa/question …
お答えします。 1.エクセルの段階でテーブル a,b ごとに 　　　　　=ネットワークID×100+スロット番号×10＋ポート番号 を計算して、識別のフィールド名をつけます。 2.エクセルの表をアクセスにインポートします。 3.アクセスの世界でa,bの識別をユニオンでまとめます。そのため 3-1　クエリー新規のところでaテーブルを読み込み端末番号だけを抜いたものをaqクエリーとして保存します。b テーブルについてもbqクエリーをつくります。 3-2　クエリー新規作成のところで　新規作成の窓でOKを、次のテーブルを選ぶ窓で「閉じる」を選ぶ。 3-3　ツールバーのクエリーをクリックし、そこで現われるすだれの中のSQLを選択し、ユニオンを選びます。 　　　そこに 　　　　table aq union table bq と書き込んで、ツールバーの中のびっくりマークを押して実行させます。 その結果をabqという名称でクエリーに保存します。 4.リレーションを新たに作成します。クエリーabqと,テーブルa,テーブルbの間に識別をもとにつくります。結合の種類は 編集して、クエリーabqの全部とテーブルa, テーブルbの同じ識別を結合させます。リレーションを保存します。 5.クエリーを新規作成にします。このクエリーに取り込むのはクエリーabqの全部と,テーブルaの端末番号、識別,テーブ ルbの端末番号、識別です。実行させると希望のものの一つ前のものが現われます。後の判定はパソコンでも出来ます がとりあえず人間がやることにしますか。
> " & Me.部署 '" & Me.部署 & "'
＃１です。 > １つのフィールドに > 201-1 > 202-2 > 235 > 1011　 > > と並び替えたいという意味です。 これは、どう解釈すればよいのでしょうか。 １つの文字列を、複数のレコードに分割して並び替えるっていうことでしょうか。 それとも、１つのフィールドにあるもので並び替えるってことで良いのでしょうか。 後者だとすると、レコードセットを使うまでもないので、楽だと思います。 VBA (ユーザ定義関数)を使うことには変わりはありません。 大丈夫ですか。 ＃１と同様に、"-" の前後を数値として扱わないといけないと思うので、 数値化する部分はそのまま使います。 今度は、その数値化したものを文字列（固定長）にして比較するものを作ってあげます。 前回同様に、数字以外は "-" のみである前提とします。 固定長の文字列にする時に、６文字-６文字　となるようにしてみます。 以下を同様に標準モジュールに記述します。 Public Function NumOrder(vS As Variant) As String 　　Dim sAry() As String 　　Const SEP As String = "-" 　　NumOrder = "" 　　If (VarType(vS) <> vbString) Then Exit Function 　　If (Len(vS) = 0) Then Exit Function 　　sAry = Split(vS & SEP, SEP) 　　NumOrder = Format(CLng("0" & sAry(0)), "000000") & "-" _ 　　　　　　　　& Format(CLng("0" & sAry(1)), "000000") End Function ? NumOrder("201-1") の結果は 000201-000001 ? NumOrder("50") の結果は 000050-000000 ? NumOrder("1011") の結果は 001011-000000 で、この関数の戻り値で並び替えをすれば良いと思います。 ※ それぞれ６文字で足りなければ、増やすなりすれば・・・ 「テーブルA」のフィールド「F1」がそのフィールドだったら、 SELECT * FROM テーブルA ORDER BY NumOrder([F1]); で、いけそうな気がします。 参考にする/しない等々、自己責任でお願いします。 ※ 上記では、文字列に展開しましたが、実数化する方法もあると思います。 例えば 202-2 を 202.2 に、235 を 235.0 に・・・とか
> 回避策をご存知であれば教えてください。 Accessのクエリの場合、「全角/半角」の違いだけでなく、 「カタカナ/ひらがな」まで同じものとして扱われてしまいます。 (Excelからインポートした場合など、その機能が重宝する 　場合もあるのですが) 確か、設定でこの問題を回避することはできなかったと 記憶していますので、全角/半角の区別が必要な場合、 私は以下のような方法を採っています： Select 番号, 名前 From テーブル1 Where InStr(1, 名前, "\", 0); つまり、第4引数を指定したInStr関数であれば、全/半角 の区別がされることを利用する、ということです。 なお、ヘルプでは「vbBinaryCompare」などの定数が提示 されていますが、これらはVBAでのみ有効で、クエリやマクロ などでは使用できませんのでご注意ください。 (上記のように、「0」「1」などの「値」を指定します) 【今日の蛇足(汗)】 こちらの環境(Access2003/XP)で確認したところ、 今回の事例に限っては「InStr(名前, "\")」としても 抽出可能なようです。 (第1引数および第4引数を省略：詳細はヘルプを参照下さい) これは恐らく、InStr関数の内部処理では、「\」は半角 円マークではなく「バックスラッシュ」として扱われている のではないか・・・と推測します。 (クエリでは確かに「\」は「￥」の半角文字として扱われて 　いるのですけれどね・・・) http://oshiete.goo.ne.jp/qa/4114026.html 一応、参考まで。
No.1です。 インラインビューには別名をつけないといけないということかもしれません。 select 企業 ,取引開始日 ,取引終了日 ,取引開始日 - 前回取引終了日 as 経過日 ,case when (取引開始日 - 前回取引終了日) > 21 then '○' else null end as "3週間以上" from (select 企業 ,取引開始日 ,取引終了日 ,(select max(取引終了日) from 取引データ B where b.企業 = a.企業 and b.取引終了日 < a.取引開始日) as 前回取引終了日 from 取引データ A) as 取引データ; などとして試してみてください。
それと、Mo5の(3)の 列数　　1 列幅　　2cm No5の(4)の 列数　　2 列幅　　0cm;2cm は重要なので必ず設定してください。
すでに検討されていたらお許しいただきたいですが、この種の計算はエクセルでやるべきだと思いますが、なぜアクセスを使われるのですか。お尋ねしたいです。
計算フィールドにして、式を=Get ( 計算式繰り返し位置番号 )にする。とか。
外部結合すればいいのではないでしょうか。 select t1.id,t1.名前,min(t2.国) as 国 from t1 left join t2 on (t2.t1id = t1.id) group by t1.id,t1.名前; 山田花子さんのアメリカ、イギリスのうち どちらを取得するのかの条件が不明なのでmin関数で取得しています。 そこらへんは適当に修正してください。 一応動作確認はしました。 http://ideone.com/RY2Ku
あちらの掲示板の方法で解決したのですか？ 繰り返しフィールドにするとグローバルフィールドもリレーションも 年代の数だけ要るということも無いのですが・・・ グローバルフィールドは簡単に言うと全レコードに共通した同一の値を 持てるフィールドです。 今回の場合は 　元テーブル　　　　　関連テーブル 　年代グローバル　=　年代フィールド でリレーションして関連テーブルのレコード数をカウントするのに使っ たわけですね。索引が持てないので逆方向の集計はできませんが。 ver.8なら全レコードに渡ってスクリプトで計算するときの変数代わりに も使えるので重宝します。用途は広いです。
No.1 の回答のコードにいつくか間違いがありましたので、下記に訂正します。 Dim rs As DAO.Recordset Dim cd As String, i As Integer Set rs = CurrentDb.OpenRecordset("SELECT * FROM ランク ORDER BY コード, 期ごと DESC") Do Until rs.EOF 　　If cd = rs!コード Then 　　　　i = i + 1 　　Else 　　　　i = 1 　　　　cd = rs!コード 　　End If 　　rs.Edit 　　rs!順位 = i 　　rs.Update 　　rs.MoveNext Loop rs.Close Set rs = Nothing
あっ 式の中の「; 」は「,」です。
そんな上司には、事故が起こるまでは何を言っても無駄です。 今やるべきことは、実際に事故が起きたときのあなたの作業量を最小にするための事前準備です。 そして、めでたく事故が起きたときに提出する提案書の草稿を作っておきましょう。
> DoCmd.ApplyFilter , "([部署コード] = 1 And [社員番号]=2)" 　DoCmd.ApplyFilter , "([部署コード] = 1 And [社員番号]='2')" あるいは 　DoCmd.ApplyFilter , "([部署コード] = 1 And [社員番号]=""2"")" 前者の方が分かりやすいでしょう。 ちなみに、日付時刻なら 　[日付]=#2011/7/15# です。
12のフィールド名を知らせてくださいませんか。
基本はANDがORより強い・・・ 今回ORで書かれているところも実はANDのような気がします。 WHERE 1 AND Field1 IS NULL AND Field2 BETWEEN 1 AND 14 AND Field3 IN(0,3) AND NOT (Field4 IN (2,3,4,8)) AND Field5 IN(0,6) AND Field6 IS NULL AND Field7 IS NULL
外付けについて特別にコメントしている方がいますが、質問者＝回答者の可能性も。 外付けも内臓も、同じようなメーカーであり、同じような種類の物を使っているので同じです。 ほとんどの方が、外も中も同じような場所においています。つまり、外付けは置く場所に気おつけるなんていうのはナンセンスです。 なので、HDDの耐用年数、使用環境として質問するのが妥当であり、回答も同じです。 ＞外付けのハ－ドディスクの耐用性（信頼性）等、どのようなお考えでしょうか いまさら、何でこんな質問するのか不思議です。もう、何百回とか質問、回答が繰りかされています。 なので、この投稿は、投稿増やそうプロジェクトや（いわゆる関係者によるやらせ＜＝１００００％そうでしょう）、アンケート、釣り、のたぐいですね。 ＞また、デ－タ等の蓄積（保存）方法等はどのようにしているのでしょうか なんて、あきらかにマーケティングですね。 それなら、それでいいんですがね。いかにも困っているように装うのは、どうもな・・・・ もう２０年位前から、そのHDDの問題はRaidと言う方法で解決しています。 なので、２０年間同じ質問、回答を繰り返す意味がわからない。 そのサブセットとして、バックアップシステムが発展してきたので、 ・２４HノンストップにはRaid ・とめる事ができる場合は、バックアップも在り。 ・震災の事などもかんがみると、もしもの時のコールドバックアップをとっておく これが、ハードレベルでの運用管理です。これは２０年前からそうでした。東電や、原子力発電所に関しては、これらの思想がなかったようですね。 あきらかに人災ですね。 もちろん実際の運用では、昔はHDDが容量が小さく、高額で、信頼性が低かったので、バックアップは当たりまえ。よく昔の映画でコンピューターがでてくると、テープが回っていますが、あれば、バックアップシステムの部分であり、実はコンピューターではなかったのです。 なのでRAIDはここ１５年くらいで普及した状態です。バックアップ先も１０年くらい前から、テープからHDD又はDVD、BDに変わってきています。 しかし、いまだに業務用にはテープでのバックアップは多用されています。昔のシステムを更新していないためです。 BDなどの光学メディアは、いまのところ永久保存用と考えるべきです。書き込み読み込み遅いため、実用向きではありません。 たとえば、リカバリーディスクとしては、BD、DVDが有効ですが、毎日のバックアップや、２ヶ月以内で更新されるバックアップには向きません。 上記を考えると、業務用には RAIDとコールドバックアップの併用が多用されている理由です。福島の原発も、この思想があったらいまみたいになっていなかった。
私なら、一度作成されたデータベースを触らずにするよりも、全面的に重複している項目を見直しして作り変えます 所在地情報　　所在地（キー）、場所名　その他情報 所在地詳細　　所在地と駐車場番号をキーにする　そのた情報 顧客情報　　　顧客ID（キー）、氏名、住所、連絡先　など 契約状況　　　所在地と駐車場番号、契約日をキー、顧客ID、解約日 後はクエリーを作成し (1)利用されている駐車場は　契約状況から解約日がNULLを抽出 (2)空きは　所在地詳細と(1)を突合せあれば利用中、そうでなければあきになります (3)この空きの一覧から割り付けられる一覧を表示し,選択できるようにすればよいと考えます でも、一からの作成と変わらないので、大変とは思います データベースのよさは、重複した内容を持たないことにあります ただ、処理速度の観点から重複する項目を持つことは可能です さらに、解約日入力のとき、フォームからであれば、解約日を入力した際イベントプログラムを作成し、NULLならチェックをはずし、そうでなければチェックを入れることは可能です 少しVBAを駆使されてもよいように考えます お役に立たなかったかもしれませんが参考までに
レイアウトモードで、新しいレイアウトを造り、表示させたい、リースの部分だけの顔を作ってください。ファイルメーカーは、一つの帳票で、幾つもの顔を持つことができます。意味分かるかな。
No1です。 回答に抜けているところがありました。 給与明細のフォームのレコードソースは質問の、 ＞以上の二つテーブルから社員の給与明細のフォームを ＞作成しています。 ではなく、別個に 日付　　社員ID　社員名　職務　職位　月給　日給 で、給与明細テーブルというもの作って回答しています。 結果は多分同じだと思いますが、一応念のために。 理由は、No1でも説明しましたが、 ＞以上の二つテーブルから社員の給与明細のフォームを ＞作成しています。 では、給与明細のフォームのフィールドが足りないからです。
明細テーブルの入力は、普通は見出しテーブルのポータルで行うわけですから、 シリアル値自動入力にすると個々の明細品目に一意のアイテム番号が付きます。 という意味です。 見積ユニーク番号と複合でキーとして使える「行番号」とうことでしたら、見積 明細テーブルで自己リレーションを作って 　　　見積明細テーブル　　　　　見積明細テーブル2 　　　見積ユニーク番号　　=　　見積ユニーク番号 　　　シリアル　　　　　　>=　シリアル 　=Count(見積明細テーブル2::商品コード)　とかになりそう。
まず、提示されたSQL文ですが、元のテーブルを示す「From句」が抜けています(汗) <現在> SELECT　Aテーブル.コード1 AS コード,Aテーブル.値 UNION SELECT　Bテーブル.コード2 AS コード,Bテーブル.値 <修正後> SELECT　Aテーブル.コード1 AS コード,Aテーブル.値 From Aテーブル UNION SELECT　Bテーブル.コード2 AS コード,Bテーブル.値 From Bテーブル <修正後(省略版)> SELECT コード1 AS コード, 値 From Aテーブル UNION SELECT コード2, 値 From Bテーブル ※1つのSelect文内にテーブル/クエリが1つだけの場合、「テーブル名.フィールド名」 　 の「テーブル名.」部分は省略できます。 さて、本題ですが・・・私自身がそうだったのですが(汗)、「ユニオンクエリは比較的 単純な構文なのでいいけれど、集計などになると、ちょっと・・・」という場合は、 デザインビューを利用することも可能です。 1つは、「(テーブルに代えて)ユニオンクエリを元にした、新規クエリの作成」です。 もうひとつは、「ユニオンクエリそのものから、デザインビューで編集可能なクエリ」に 持っていく方法です。 前者は簡単だと思いますので省略しますが、今後のことを考えて、後者について その手順を紹介してみます。 【手順】 1)元となるユニオンクエリをSQL文で作成 　(→念のため、『！』(実行)ボタンを押して結果が表示されるか確認) 2)そのSQL文の前後に、それぞれ「Select * From (」と「) As Temp」を追記 　例) Select * From ( SELECT コード1 AS コード, 値 From Aテーブル UNION SELECT コード2, 値 From Bテーブル ) As Temp 3)ツールバーなどにある、デザインビューに切り替えるためのボタンをクリック 4)ユニオンクエリとして記述したクエリとそのフィールドが、通常のテーブルや 　クエリと同様に表示されるので、通常の選択クエリや集計クエリなどと 　同様に編集 5)保存して閉じる ・・・以上です。
いきなりレポートを作るのではなく、給与テーブルを作りましょう。 従業員情報、出勤カレンダー、日報、等々のテーブルを基に給与計算をし、 その結果を給与テーブルに格納する。 給与テーブルを元にレポートを作成する。 １年分の給与テーブルを基に年末調整を行なう。 その他にも社会保険料の計算や税金計算等やるべきことは沢山あります。 従業員数はどの位ですか？ ５人以上なら市販の給与計算ソフトを使うのがお勧めです。 ５０人以上で特殊な計算が必要なら、独自に給与計算プログラムを作ってもいいかも。 少人数なら、、社会保険や税金計算のマスタ整備の手間を考えると、 基本的に手計算（エクセル等を使って）です。
#1補足です。 http://code.google.com/p/cowares-excel-hello/sou … ここの 1,353行目に、mdbファイルを開き、 CurrentDb 相当のものを取得する記述があります。 周辺を見れば Access Object との関連は理解できると 思います。 これは Excel VBA ですが、 VBScript でも同じです。 参照設定の代わりに CreateObject になるぐらいです。 これらのキーワードがわかれば、 検索すれば、もっと丁寧に説明したページも出てくると思います。
select Table1.id from Table1 minus select Table2.id from Table2; とか？
プルダウンメニューですね。 作り方はこんな感じです。 http://mbsupport.dip.jp/hp/form_6.htm 実際の詳しいソースはこんな感じです。 http://vued.blog56.fc2.com/blog-entry-18.html
紹介したサイトに 「ちなみに、DB2 Express-c 8.2は、どこのサイトにもありません（IBM のサイトにもありません）」 ってあるんですがね。
こんにちは。 普通(?)はテーブル設計書にリレーション構成図みたいなものがあってテーブル同士の繋がりがわかる資料があります。 >テーブル設計書のカラム名を見ただけではわかりません >こういった場合はどうすればいいのでしょうか これはテーブルを設計した人に聞くしか無いです。 テーブルAに商品コード,テーブルBに商品名があるような場合はテーブルBにも商品コードのカラムがあるはずですのでそれを結合すれば良いと想像することは出来ますが。 あとはプライマリーキーになってる項目とか。資料が無い限りは予想でしかわかりません。 さすがにどのようなテーブル設計になってるかわかりかねますので、先輩に聞いてくださいとしか回答できません。
こんな感じでどうでしょうか。 update TBL_B B set B_UP = '++++++' where exists ( select * from TBL_A A where A.A_ID = B.B_ID and A.A_BETU = B.B_ID and --B_KY ではないですか？ (A.A_ID = 'A599' and A.A_KY = 'K1')); ただ、使っているデータベース製品によっては上記のSQLではうまくいかないこともあるかもしれません。
ANo.1はまだ正規化が済んでいません。ANo.1を流用して回答します。 [社員] 社員番号｜氏名 0001｜ほげ 0002｜ふー 0003｜ばー 0004｜ばー子 0005｜ほげ子 主キー：社員番号 [所属] 社員番号｜部署番号 0001｜BU01 0001｜BU02 0002｜BU03 0003｜BU04 0004｜BU05 0005｜BU04 主キー：社員番号、部署番号 [部署] 部署番号｜部署名 BU01｜デバッグ部隊 BU02｜接待ゴルフ部隊 BU03｜リリース部隊 BU04｜クレーム対応部隊 BU05｜接待ゴルフ部隊 主キー：部署番号
もう1階層追加しちゃだめですか？ select F_1, F_2 from TEST2 where F_1 IN ( select F_2 from TEST2 where F_1 IN ( SELECT F_2 FROM TEST2 WHERE F_1 IN ('AAA') ) );
すぐに思いつくのは伝票における「合計金額」項目の扱いでしょうか。 「合計金額」は発行された１枚の伝票に対して必ず１回 登場しており， これは主キー「伝票連番」に対する関数従属項目に位置づけられます。 しかし，この「合計金額」が 明細行の 単価×数量 を集計することで求められる（導出できる）ものなら， それは解答記述の中に含めず積極的に省略せよ，ということでしょう。
携帯からパソコンに写真を移すときには、携帯のメールでパソコンのメールアドレスあてに送ることが出来ます。逆もパソコンから携帯へメールアドレスを使えば送ることが出来ると思います。
Me!txt_件数 = Nz( DSum("1", "T_テーブルA", "○○コード = 1"), 0) 上記でテストして下さい。 私は、件数集計は上記で行っています。
でなければ コード　　97上　 97下　96上　　 合計 A 　　　　 2　　　　1　　8　　　　11 B 　　　　 5　　　　6　　3　　　　14 というクロス集計クエリ（Ｑ１）を作成し SELECT Q1.*, NZ(Q1.97上)+NZ(Q1.97下) AS [97上+97下] FROM Q1
一つ大事な作業が行われていません。 iTunesのデータを移行した場合、外付けHDDのライブラリを指定してあげなければいけません。 この作業を行わないと、iTunesはライブラリが見付けられないので、マイミュージックに新しくライブラリを作成してしまい、今回の様な現象に見舞われます。 なので、ライブラリを指定してあげて下さい。 方法は、「Shift」キーを押したまま、「iTunes」を起動します。 開いた画面で、「ライブラリを選択」を押します。 その後、外付けHDDに移動させた「iTunes Library.itl」を探して選択して下さい。
update CUSTOMER set RES_NOTE = RES_NOTE || ' ' || NOTE; という感じでRES_NOTEとNOTEを連結した値でRES_NOTEを更新することができます。 ただ、文字列の連結方法はご使用のデータベース製品によって異なりますので、 そのあたりはご自身でお調べください。
EXCEL（VBA)+DBと言う考えですよね。 ならば、SQLサーバーでいいと思います。 問題ないと思いますがExpress 版はデータベースの容量に4GB の制限制限があります。
>各行ごとに「price * amount」をしたものの合計を求める方法 「各行ごと」とは、どういう意味でしょうか？ 各行に、「同じ合計値」を結合したいという意味ですか？
そのダイアローグのメッセージには何と？ たまたま似たようなお話が他でありましたので参考にされては？ http://www.moug.net/faq/viewtopic.php?t=58665
たぶん、#1さんの指摘通りだと思うのですが。 select文実行前に、列名をヘッダ出力＆表示カラム位置を合わせる指定をしてみてください。 .header on .mode column そうすれば、列に期待した通り値が入っているか、確認できると思います。
BUFFALOの様ですね。 http://www.vor.jp/oui/oui.html
長くなったので分割して続き。 で、どうして「テーブルを増やさないようにするか」の理由は「テーブルを増やすと、付随したクエリも増えるし、ユーザーインターフェース部分も新規に追加しないとならないから」です。 新しい種別が増えるごとに新テーブルを増やしていたら、その新規テーブルにアクセスするユーザーインターフェースもすべて新規作成になるし、入力や閲覧や検索や印刷ルーチンも、全部、新規作成になります。 そういう作り方をせず「テーブルは全部共通で１つ」にすれば、ユーザーインターフェースは１つで済み、ホテルだけ扱いたい場合は「フィルターを設定してホテルだけ抽出」とかが可能だし、駅前エリアの全施設を出したい場合は「フィルターを設定して駅前だけ抽出」とかも可能です。 もちろん、フィルターを設定しないでおけば「すべての施設を全部閲覧」とかが可能です。 このように「テーブルを１つにする」ことで「複数の種類、複数の種別を、一括で操作できるようになる」と言う利点もあります。 検索を行う場合も「どこかの施設に居る、役職が何か判らない、鳩山一郎さんを探す」と言う場合、テーブルがバラバラだと、全部のテーブルを検索しないとなりません。 その場合、テーブルが増えるたびに、増えたテーブルも探しに行くよう、検索ルーチンに手を加えないとならなくなります。 なので「できるだけ、メインのデータが入るテーブルは１つで済ます」のです。 ですので「種別の数だけテーブルを作る」とか「エリアの数だけテーブルを作る」と言う作り方は、やってはいけません。
どういうSQL文を作ってるのか解りませんが、カラム名が同じ時はtable名も付けて区別します、同じtableをjoin するときは、別名(alias)を付けて区別します。 create table tblname as select 文なら、select 句に指定するカラム名がカラム名だけで区別できるように、カラム名にalias を付けます。 rank.hoge って、table名が rank で、 hoge がカラム名ですよね。 rank1 はどこから出てきたのかな？新規table名の方？join対象tableのalias? 例文 rank テーブルが、hoge,new,old のカラムを持ってるとして create table rankjoin as select rank0.hoge as r0hoge, rank0.old as veryold, rank1.hoge as r1hoge, rank1.new as new, rank1.old as old from rank as rank0 join rank as rank1 on rank0.new=rank1.old ; これで、rankjoin は、r0hoge,veryold, r1hoge, new,old のカラムを持つことになります。 rank1 対象にselect 例文作成すると select r0hoge,r1hoge, new from rank1; SQLiteなら、view も作成できるけど、select句のかち合うカラムには別名必要なのは同じ。
プリンタのデバイスをインターネットからゲットしましょう☆ メーカーや機種などをネットで検索して デバイスをダウンロード、インストールしましょう！！ できますかね？
> 担当欄のセル とか > ○を入力すると「太郎、花子...」と > 表示させたいのですが。。 と書かれてもどこに表示させたいのかが不明です もともと 　　　A　　　　　B　　　C　　D　　E　　F １　　　　　　　　月 　火 　水 　木 　金 ２　太郎 ３　花子 ４　一郎 ５　次郎 ６　三郎 ７ ８　担当者名 といった表があって(A列にはすでに担当者名が入っている) たとえばB3に○を入れたらB8に花子と出したいのでしたら 8行目の担当者名の各曜日の行に担当者名を入れたい のでしたらB8に以下の式を入れて右にフィルしてみてください。 =INDEX($A$2:$A$6,MATCH("○",B2:B6,0))
8000*60（分）*24（時間）*31（日）*6（月) ≒2G（21億件） レコードサイズがどのくらいか分かりませんが結構なサイズですね。 データベースソフトを何にするかとともにハードもそれなりに検討する必要があると思います。 （SSDのRAID0構成など）。 特に、更新（INSERT）しながら、SELECTが発生するので大量のランダムアクセスが発生する可能性があります。 後、できるだけフラグメンテーションが起きにくいDBがお勧めです。 MySQLなどでもデータファイルサイズを指定して、再起動（2回ぐらいエラーになりますがその後アロケートされます）してできるだけ連続領域にデータを格納するとか。 OracleでINDEX領域とデータ領域を分けてデータファイルを指定してDATABASEを作成するのがいいかもしれません。
shut0325です。 深夜の扱いですが、これは会社のルール（特に給与計算）も影響します。 例えば、交代制で深夜に通常勤務するパターンがある場合は、 「深夜だけど、残業ではない部分」というのも存在します。 また、休憩時間も、徹夜するようなときは、昼12時に1時間とって、夜の23時に1時間というパターンもあるかと思いますし、22時にとる場合もあります。そうなってくると、給与計算の結果は異なる可能性があるのです。 そうなってくると、勤務パターンをいくつか作り、それに対して、「遅刻・早退・残業・深夜勤務」と分けて処理する必要があります。 今回は、そのような2交代/3交代がないパターンで、徹夜する場合も区切りを一旦午前6時に設けるという方法で考えたいと思います。 考え方はシンプルで、前回のコードでのEndTimeを利用します。 午前2時に終わった場合、EndTimeは2＋24＝26（時）です。 つまり、深夜扱いに切り替わるの22時（22）を引けば、深夜時間が出てきます。 例えば、ETが19：00の場合どうなるでしょう？ 答えは-3です。なので、「EndTime-22(時）が0より大きい場合は、その結果をMe.shinyaに代入し、それ以外の場合はMe.shinyaを0に」すれば良いのです。 問題は残業(Zan)との兼ね合いです。 単純に上記式のみであれば、残業m時間（うち深夜勤務n時間）となります。 場合によっては、通常勤務時間で深夜になる場合もあるでしょう。 そうなると面倒だという場合、 残業計算に入る前に、深夜時間を算出し、総勤務時間からそれ引いた上で、残業計算を行う一行を足す必要があります。 まず、ここまでのコードを下記に記します。 前回のコードの、 最初の方を書き換え＋追加して下さい。 ----- Dim StartTime, EndTime, Kugiri, tuujou, Soukinmu,shinyakugiri,SinyaTime As Long:'追加 tuujou = 8: '通常勤務時間　8時間 Kugiri = 6: '変更　区切り時間　午前6時 shinyakugiri = 22:'追加　深夜区切り　22時 ----- 次に下記コードに2箇所追加記述します。 ----- '完了時間が　0時以上　5時以下　の場合、24時間足す。 If EndTime >= 0 And EndTime <= Kugiri Then EndTime = EndTime + 24 End If '追加 SinyaTime = EndTime - Shinyakugiri If SinyaTime > 0 Then Me.sinya = SinyaTime Else Me.shinya = 0 ----中略 '総勤務時間算出 Soukinmu = EndTime - StartTime - Me.kyukei '工数算出 Me.kousu = Soukinmu / tuujou '追加（Me.sinyaは前の処理で、深夜にかかっていない場合0なので、適切に計算される） Soukinmu = Soukinmu - Me.sinya -----以下略 以上ですが、最後に残った問題は休憩時間の処理です。 これはテキストボックスを追加して、「何時に」「どれだけ（時間）」というのが無いといけません。そうなってくると、今は開始時間/完了時間/休憩時間　の3つでよかったのですが、項目を増やすと入力が煩雑になり、面倒ですね。3回休憩する可能性があれば、3項目×2＝6つ入力箇所が増えます。 一番楽なのは勤務形態によりますが、「22時以降の勤務は必ず1時間の休憩を取る。とらない場合でも、取った計算になる」とし、深夜扱いの時間を23時とする方法。 なので、22：30に完了した場合は、22時を超えた30分は深夜扱いにならない。 或いは、23時を超えている場合は無条件で1時間休憩が付与され、それ以前は休憩はなしでやったという扱いにする。 例：23：10→深夜時間は10分（休憩1時間引き）　22:30→深夜時間は30分（休憩なし） こういったパターンであれば、テキストボックスを追加することなく、解決できます。 ここから先は勤務形態で対応できる設計にする必要がありますので、それらを整理して明文化する事が先決となります。
MySQLのリンクテーブルを作成して試してみましたが再現しません。 "DELETE FROM TEST_WORK" という内容のクエリを作成して実行すれば、削除件数を確認してくると思います。 試してみていただけませんか。
失礼しました。VBEの参照設定で、Microsoft DAO 3.6 Object Library にチェックを入れてお試しください。 イミディエイトウィンドウにて ?application.CurrentDb.TableDefs("テーブル名").Fields("フィールド名").Properties("description").Value ↑として、EnterKey で『説明』が返ってきませんか（あればの話ですが (^^ゞ） application.CurrentDb.TableDefs("テーブル名").Fields("フィールド名").Properties("decimalplaces").Value =4 同様に入力後、EnterKeyで桁数が４桁になるとハズ？ 標準モジュールにて Sub test() '要参照設定 Microsoft DAO 3.6 Object Library 　　Dim db As DAO.Database 　　Dim tdf As DAO.TableDef 　　Dim fld As DAO.Field 　　Dim prp As DAO.Property 　　On Error Resume Next 　　Set db = Application.CurrentDb 　　Set tdf = db.TableDefs("そのテーブル名") 　　　　For Each fld In tdf.Fields 　　　　　　Debug.Print fld.Name 　　　　　　For Each prp In fld.Properties 　　　　　　　　Debug.Print , prp.Name, prp.Value 　　　　　　Next 　　　　Next 　　Set tdf = Nothing 　　Set db = Nothing End Sub 当方Access2002
model句の出番ですな。 SELECT 親テーブル.ID, 親テーブル.カラムＡ, ConcatT.カラムＢ FROM 親テーブル LEFT OUTER JOIN ( SELECT ID, SUBSTR(ConcatカラムＢ, 2) AS カラムＢ FROM 子テーブル MODEL RETURN UPDATED ROWS PARTITION BY(ID) DIMENSION BY(Row_Number() OVER(PARTITION BY ID ORDER BY 枝番)) MEASURES(カラムＢ, CAST(NULL AS VARCHAR2(2)) AS ConcatカラムＢ) RULES ITERATE(100) UNTIL (PRESENTV(カラムＢ[ITERATION_NUMBER + 2], 1, 0) = 0) (ConcatカラムＢ[0] = ConcatカラムＢ[0] || ' ' || カラムＢ[ITERATION_NUMBER + 1]) ) ConcatT ON 親テーブル.ID=ConcatT.ID ORDER BY 親テーブル.ID; 枝番100件までの想定だけど、事前に件数数えて動的にループ数変えてもいいかも。 参考URL：http://www.geocities.jp/oraclesqlpuzzle/model-22 …
データベースとかプログラミングという事についてあまりにも知識が無さ過ぎるように見受けられます。 まずはそちらの初心者向けの解説書とか読んだ方がいいのでは無いでしょうか?
>１つのテーブル内で７つ分（複数）のレコードを編集するには、という点です。 1テーブルで何十万のレコードでも編集できます。 スクリプトとかリレーションとポータルとか使ったことありますか？ 無ければ、Filemakerに付いている「タイムカード」というテンプレート を改造するといいかと思われます。 予定表関連は要望もどんどん増えていきますし、filemakerとスケジュール やカレンダーでググると有料無料のテンプレートもたくさんあります。
shut0325です。 ＞もし休憩時間は1時間ではなく、忙しい日には30分しか休憩してない場合なら、どうすればいいでしょうか？ その場合は、その休憩時間のテキストボックスの名前を kyukei として、 コードの中の、 kyukei = 1: '休憩時間　1時間 これを消してください。 規定値が1との事ですので、例えば30分なら0.5という入力になります。
情報があいまいな部分があるので確認させてください。 > Private Sub to11_Click() > DoCmd.OpenForm "F_支所A" > Set Forms!F_支所1.Recordset = Me.Recordset この F_支所A と F_支所1 は別のフォームですか。 それとも、実際は同じフォームで、ここに書き写すとき書き間違えたのですか。 > DoCmd.close acForm, "F_支所一覧", acSaveYes F_支所一覧 というのは、「to11」ボタンの配置してあるフォームですか。 > Excelに出力したい情報はデータシート形式で、支所のフォームに > F_活動記録　サブフォームとして埋め込んでいます。 「支所のフォーム」とは「F_支所A」のことですか。 > Private Sub Eccelで保存_Click() > DoCmd.OutputTo acOutputForm, "F_活動記録", acSpreadsheetTypeExcel9 > End Sub 「Eccelで保存」ボタンは、F_支所A に配置してあるのですか。 > 教えていただいた「RecordSource に抽出条件を設定したSQL」は > Q_活動記録のレコードソースに記述するのでしょうか。 これは最初の質問の「読み込みのイベントで抽出」というから、読み込み時イベントで自分自身のFilterプロパティに抽出条件を設定するということを推測して回答したことですが、実際はそうではないようなので無視してください。 とりあえず、上記の質問に回答してください。 下手な推測でまた、間違った回答をしてしまっては無駄骨ですので。
そうしましたらコードで記載する場合は >DoCmd.TransferText acExportDelim, , "活動記録", "c:\活動記録.csv", True 上記のように記入していらっしゃったかと思いますが、"活動記録"を"[クエリ名]" ⇒DoCmd.TransferText acExportDelim, , "クエリ名", "c:\活動記録.csv", True へ変更すればcsvファイル出力は可能かと思います。 ただ、上記のような記載だと任意の出力先指定やファイル名は選択できません。 下記URLで名前を付けてファイルの保存が載っていますので参考にして見てください。 http://www.accessclub.jp/samplefile/samplefile_2 …
>各テーブルで必要なフィールドを >一つのテーブル内で作ってしまって >レイアウトを変更しながら管理していくやり方 わかりやすい例を書くと 例えば果物屋さんの場合、販売の伝票テーブルで、何月何日、誰々に みかん　10個　単価100円 りんご　20個　単価200円 などと記入していくわけですが、みかんの単価が100円とかりんごが 200円などというデータは同じテーブルのフィールド値としては持て ませんよね。毎回手入力するなら別ですが。 あなたが作ろうとしているDBの内容はどんなものですか？
ひょっとしてリレーショナルデータベースのオブジェクトと、他のオブジェクトを混同されてはいないでしょうか？ 以下、リレーショナルデータベースの「オブジェクト」に関してのみお答えします。 ・「オブジェクト」は「テーブル（表）」「インデックス（索引）」などを指す。 ・「オブジェクト」は「SQL」で「作成/操作」される。 ・作成/変更/削除を行うには、create/alter/dropコマンドを使用する。 ・生成されたオブジェクト（主にテーブル）にデータ格納/検索するなどのデータ操作については、insert/update/delete/selectコマンドを使用する。 つまりデータベースオブジェクトに関しては、原則的に「ファイルと言う概念」はありません。 もちろん管理する上ではファイルはあります。データはメモリ上に展開されますが、最終的にはファイルに永続化されますから。 でも RDBMS では、作成したオブジェクトが、どのデータベースファイルに格納されたかなどは、管理者が知っていればよいのです。 使用者や管理者以外の開発者は、オブジェクトに割り当てられた「顧客マスタ」「総勘定元帳」などの業務的な概念を相手にします。
1つのファイルを、異なるバージョンのAccessがインストールされた PCで使用する場合、方法としては2つあるかと思います。 一応、Excel2003での「2007 ビューア」のような「互換ファイルみたい なもの」という意味では後者(Runtime)が該当するかと思いますが、 それぞれ難点がありますので、事情と照らし合わせてどちらを採るか、 或いは製品版を導入するか、検討してみてください。 ※私自身は「Access2003で統一された環境(職場・複数端末)」と、 　 「Access2003・2007の共存環境(自宅・単一端末)」しか扱って 　 いないため、利点・難点とも見落としがある可能性もあります(汗) 【1・新旧双方でサポートされているMDB形式を使用する】 <利点> 　・全てのPCで、テーブルやフォームなどのデザイン変更やVBAの 　　編集などが可能 <難点> 　・新旧バージョンで共通の機能のみしか使用できない 　　※バージョンアップで追加/削除された機能は、以下のサイト 　　　などで確認可能(予め目を通すにしても、トラブル発生後に 　　　確認するにしても、面倒なのが・・・(汗)) 　[Office Access 2007 での変更点] 　http://technet.microsoft.com/ja-jp/library/cc179 … 　[Access 2010 での変更点] 　http://technet.microsoft.com/ja-jp/library/cc179 … 【2・Runtimeにより全PCでaccdb形式を使用可能にする】 <利点> 　・全てのPCで、新バージョンの機能を使用したデータ操作が可能 <難点> 　・製品版Accessの入ったPCでしか、デザイン変更やVBAの編集 　　はできない 　・Accessに関する端末ごとの設定(の一部?)については、Access 　　から設定できなくなるため、レジストリの操作が必要になる 　　http://www.u670.com/2011/02/08/access2010-runtim … 　　http://www.mkkobo.com/runtime/runtime03.htm 　・旧バージョンのAccessと共存させた場合、競合のようなことが 　　おきることがある(らしい(汗)) Runtimeのダウンロード元(Access2010)： http://www.microsoft.com/downloads/ja-jp/details …
すいません↓ではマイナス表示されてしまいますね。順番入れ替えて 残業時間: IIf([完了時間]>#17:00:00#,DateDiff("n",[完了時間],#17:00:00#),0) 残業時間: IIf([完了時間]>#17:00:00#,DateDiff("n",#17:00:00#,[完了時間]),0) ↑としてください。 で、クエリのデザイン画面で 開始時間｜完了時間｜の隣のフィールドに 開始時間｜完了時間｜残業時間:IIf([完了時間]>#17:00:00#,DateDiff("n",#17:00:00#,[完了時間]),0) としてデータシートビューに切り替えて確認してください。 分単位の結果が表示されるハズです。 このクエリを元にフォームを作成すれば残業時間も表示されます。
> コード　2011前　2010後 　2010前　・・・・・・・・・・まだまだ続きます。 まず問題点と疑問点 (1)　「コード」と変換対象の「2011前」のようなフィールド以外のフィールド（例えば「合計」のような）はないか？ (2)　現時点で変換するフィールド数はいくつ？ (3)　変換は定期的に行うものではなく、今回１度のみで良いか？ (4)　出来あがったテーブルのデータを年月で並べ替えると 　　　　「前」と「後」が前後します。　（文字コードは 前 ＞ 後 ですから。） 　　　　　2001後、2001前、2002後、2002前、・・・・ のように。 上記のうち問題点をクリアする方法はいろいろありますが、とりあえずすべて無視。 > レコード数が何十万とあるので、変換するのに時間があまりかからない方法を教えて頂ければ助かります。 一般に、SQL で処理するほうが、レコードセットで順に読み書きしていくより高速です。 レコードセットの開くモードにもよりますが 大きなテーブル全体を読む場合など、メモリ上で処理しきれない場合に ワークファイルに書き出してから処理されますので ある程度以上のサイズになると、極端に遅くなりますね。 私の低スペックマシン （Celelon 1.46GHz、メモリ　2ギガ、Vista、 Access2007、 2000形式MDB） で テストしてみました。 条件： 　　変換するフィールド数　10 　　入力レコード数　10万 （Null値 はテストのための 1個 のみ。 出力レコード数 99万9999 になる） 　　出力テーブルを作成しておく。（インデックス なし） 　　　　フィールド：　年月（テキスト型）、コード（テキスト型）、数（長整数型） 　　入力テーブル、出力テーブルとも閉じておくこと。 　　MDB を開いた直後に実行する。 　　（繰り返し実行していると、だんだん遅くなっていきます。メモリの解放等、いまく行ってないのでしょうね） －－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－ Sub TabConv() 　　Dim FieldNameAra() As String 　　Dim strSQL As String 　　Dim dbs As DAO.Database 　　Dim tdf As DAO.TableDef 　　Dim i As Integer 　　Set dbs = CurrentDb 　　'フィールド名の配列を作成 　　With dbs.TableDefs("テーブルA") 　　　　If .Fields.Count > 1 Then 　　　　　　ReDim FieldNameAra(1 To .Fields.Count - 1) 　　　　　　For i = 1 To .Fields.Count - 1 　　　　　　　　FieldNameAra(i) = .Fields(i).Name 　　　　　　Next 　　　　Else 　　　　　　MsgBox "テーブルが不正です" 　　　　　　Exit Sub 　　　　End If 　　End With 　　'変換開始 　　Debug.Print Time$() 　　For i = LBound(FieldNameAra) To UBound(FieldNameAra) 　　　　strSQL = "INSERT INTO テーブルB ( コード, 年月, 数 ) " & _ 　　　　　　　　"SELECT コード, '" & FieldNameAra(i) & "' AS 年月, [" & FieldNameAra(i) & "] AS 数 " & _ 　　　　　　　　"FROM テーブルA " & _ 　　　　　　　　"WHERE [" & FieldNameAra(i) & "] Is Not Null" 　　　　 dbs.Execute strSQL 　　Next 　　Debug.Print Time$() End Sub －－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－ 結果： 　　約１３秒 　　１フィールドごとの処理ですから、時間はフィールド数に比例すると思われます。 　　同じ条件で、No2 さんのコードを実行すると 約４０秒かかりました。 　　こちらは、No3 さんのテストでもわかると思いますが、 　　フィールド数が多くなると極端に遅くなります。 　　（私の低スペックマシンでは、やってみる気にもなれない） 　　なお、出力テーブルに、「年月、コード」で 主キーを作成しておくと 　　３分以上かかりました。 　　主キーなしのテーブルに出力してから、そのテーブルに主キーを作成するのは、ほぼ瞬時。 質問者さんがまだ見ているか分かりませんが、 おもしろそうなのでやってみました。 　　
>エラーコード：-3010 [Microsoft][ODBC Microsoft Access Driver] パラメータが少なすぎます。1 を指定してください。 とでてくるのは、SELECTの次のmid(U.受払年月日,1,6)で、U.受払年月日が認識できなくて、 パラメタが足りないっておこられているのでは？ というのは、 ★のところ。 FROM (部門マスタ INNER JOIN ((SELECT mid(受払年月日,1,6),部門CD,商品CD,科目CD,SUM(受払数) as SUM受払数 FROM 受払TBL WHERE 受払年月日 BETWEEN '201101' and '201105' GROUP BY mid(受払年月日,1,6),部門CD,商品CD,科目CD) AS U INNER JOIN 商品マスタ ON U.商品CD = 商品マスタ.商品CD) ON 部門マスタ.部門CD = U.部門CD ) ★ここにas uがないのでSELECT句内で、U.XXXとつけても見つからないと思いますが。 INNER JOIN 科目マスタ ON U.科目CD = 科目マスタ.科目CD fromの次の(と★の直前の)を削除すると、副問い合わせにならないので、 U.XXXはみつかるはずですが。
書いてある通りなんですけどね。 マクロタブを開き、新規作成をクリックします。 アクションを「テキスト変換」にします。下方に クエリ名や出力ファイルの指定欄が表示され るので、目的のものを入力します。 あとは名前を付けて保存します。この時に 名前を「AutoExec」にします。
失礼しました。コントロール上ではフォームのマウスクリック時イベントは発生しませんね・・ となると、フォームのマウスボタン移動時かな？
SQLiteは本体プログラムに対して、直接リンクしたライブラリもしくは共有ライブラリやダイナミックリンクライブラリの形で利用できる、組み込み型データベースエンジンです。 http://ja.wikipedia.org/wiki/SQLite A1. APIの結果コードが返ります A2. Bindメソッドを使います
64bitOSのコントロールパネルで登録したシステムDSNは32bitのACCESSからは認識されません。 http://support.microsoft.com/kb/942976/ja こちらを参考にして32bitのDSNを登録してください。
ダブルクォーテーションの間に、スペース以外の文字が入っているのかな？ SELECT [Q_名簿]![姓] & Space(1) & [Q_名簿]![名] ...（以下略） だとどうです？
If DFirst(True, "テーブル", "コード = (以下略) にしてみてはいかがでしょう。
すみまませんでした。 SELECT U.商品CD, 商品マスタ.商品名, U.[部署CD], 部署マスタ.部署名, U.SUM受払数 FROM 部署マスタ INNER JOIN ((SELECT 商品CD,受払年月日,部署CD,SUM(受払数) as SUM受払数 FROM 受払TBL WHERE 受払年月日 = 20110513 GROUP BY 商品CD,部署CD,受払年月日,受払数) AS U INNER JOIN 商品マスタ ON U.商品CD = 商品マスタ.商品CD) ON 部署マスタ.部署CD = U.部署CD ORDER BY U.商品CD, U.[部署CD], U.受払年月日,U.[SUM受払数]
Private Sub Form_Open(Cancel As Integer) 　　Me.OrderBy = "製品ID" 　　Me.OrderbyOn = True End Sub としてみてください。
「☆」だけだと検索できませんね。 「らき☆すた」は特殊な事例だと思います。 通常、「☆」などの記号による検索結果は、多くの人にとってはあまり意味のある結果とはならないように思います。 このあたりをご参考に。 Google 検索の基本: 基本的な検索のヘルプ http://www.google.co.jp/support/websearch/bin/an … 　基本事項 　　通常、句読点や @#$%^&*()=+[]\ などの特殊文字は無視されます。 Google 検索の基本: その他の検索のヘルプ http://www.google.co.jp/support/websearch/bin/an …
NOT EXISTS条件はカッコ内のSELECT文でレコードが取得できないときにTRUEになります。 先ほどのSQLの、 >where not exists( >select * from Test as tb >where Test.ID > tb.ID); のSELECT文でTestテーブルから自レコードよりIDが小さいレコードを取得しています。 #tbはただのテーブル別名です。 #SQLiteだとDELETE対象のテーブルにはテーブル別名がつけられない（？）ようだったのでTestと指定しています。 レコードが取得できない = 自レコードのIDが最も小さい ということになります。 なんとなく分かっていただけますかね・・・
サンプルをお見せするテクニックが私になくて申し訳ありません。 ポイントはクエリーを用いて、上限年齢の人の生年月日と下限年齢の人の生年月日をdateadd関数を使って計算して求め、二つの生年月日と受付の人の生年月日と比較して、範囲内にあるかどうかの判定をして範囲内の人だけ表示するようにすれば良いわけです。
ご質問の件ですが、構文に間違いはありません。 正しい構文です。 考えられる点をいくつか挙げていきます。 ・接続しているユーザーに、deptテーブルが無い（またはSELECT権限が無い） ・エラーの文字通り、deptテーブルに depart_id が無い SQL> desc dept と打ってみてください。 これでエラーになるなら ↓ ・接続しているユーザーにdeptテーブルが無いので、deptテーブルがあるユーザーに接続しなおす ・そもそも作っていないなら、deptテーブルを作る エラーにならないが、カラムの一覧に depart_id が表示されないなら ↓ ・deptテーブルが間違って作られているので、作り直す となります。 上記が問題ないのであれば、ちょっと、微妙ではありますが、使用されているバージョンがANSI JOIN（INNER JOINやLEFT JOIN）の構文に対応していない古いバージョンである、なども考えられます。 ただ、エラーの内容（ORA-00904:無効な識別子です）からすると、他の原因もありそうな気がします。 このエラーは引用符（シングルクォート、ダブルクォート）の扱いを間違える事で発生する場合が多いんです。 例えば、CREATE時に ＞CREATE TABLE "dept" ＞（中略） ＞"depart_id" number, ＞（以下略） みたいに、小文字をダブルクォートで括ったりしていませんか？ この場合、ORACLEの仕様上、 d.depart_id　　→エラーになる D.DEPART_ID　　→エラーになる d."depart_id"　→正常終了 になります。 何故そうなるのか、については長くなるので書きませんがｗ、気になったら補足に入れてもらえれば説明します。 蛇足ですが、SQL plus（SQL*Plus）はORACLEのクライアントプログラムの名前なので、 「ORACLEを独学で学び始めたものです。」 の方が適切な書き出しですね。 （ORACLEのカテに質問した方がよいのでは？その方が回等も得やすいと思います）
> インターフェース？が必要だから 多分入力専用の画面とかがいるよってことだと思いますが、エクセルで十分先生の納得できるものが出来ます。(入力専用のフォームを作ることも出来ますし、シートをロックして入力専用とかにもできます) が、インターフェースを凝るほど作るほうは大変だと思います。 たとえば、こちらにある成績表なんかみたいなのだとそれほど難しくもないと思いますがいかがでしょう。下のほうにあります。 http://www.navi2.com/download/thanks.html
prefectureには必ず値がある場合にはcount(prefecture)ですね。でもまれにそのつもりでも値が入って無くグループ指定もして無い項目を対象にする人が居て、その場合はひどい間違えが発生する可能性もありcount(*) が一般的とされてます。 この例題の場合はcount(prefecture)が正解でしょう。大きいテーブルだとcount(*) はパフォーマンスが落ちますので。
アクセスのソフトにあるクエリーを使って、1　クエリーにテーブルを追加　2　問題とするフィールドの抽出条件として　たとえば　=254 のように条件を指定の後　3　そのクエリーを実行　4　そうすると条件にあったデータだけが示されます
[ああああ]、[ｂｂｂｂ]はパラメータなんでしょうか？ クエリデザインで縦に配置したらどうなりますか（他に条件設定していたら同様に設定する必要がありますが）
12万件だけど、恒星データベース HYG 2.0はなぜかgzipで二重圧縮されているので、2回展開してください。 参考URL：http://www.astronexus.com/node/34
> 上記IN句内のSELECT文の結果は、'A'、'B'、'C'、'D'です。 他に、NULL値が返ってきていませんか？
質問者様がプログラマ、SEなど、開発者なのかどうかによって回答が変わります。 開発者（もしくはそれに近い位置の立場）であるなら、以下のマイクロソフトのサイトに詳しい説明が載っていますのでご覧ください。 ↓ ネイティブ イメージ ジェネレータ (Ngen.exe) http://msdn.microsoft.com/ja-jp/library/6t9t5wcf(v=vs.80).aspx そうではないなら、噛み砕いて言えば、「.NETと言うものを使ってアプリケーションを作るときに、作ったアプリの起動が速くなるようにするもの」です。
sybaseは使ったことがないのですが、 charindex関数とsubstring関数を組み合わせればいいのではないでしょうか。 select substring(カラム1,1,charindex(カラム1,'@') - 1) from テーブル; でどうでしょうか。
質問の場合の、 Private Sub 失効有無_AfterUpdate() DoCmd.GoToRecord , , acNewRec DoCmd.GoToControl "ID" End Sub には問題は無いようなので、動くとは思いますが。 代案として、 Private Sub 失効有無_AfterUpdate() DoCmd.GoToRecord , , acNewRec Me!ID.SetFocus End Sub でも、同じとは思いますが。一応確認してみて ください。 >移動したいのですがうまくいきません。 とは、エラーも表示されずに移動しない、 ということですか。 一応、コード表のデバックから、コンパイル を選択して実行してみてください。
No1の訂正です。 ＞当月末残高:[前月末残高]-[当月回収額]+[当月掛売上] は、 当月末残高:Nz[前月末残高]-Nz[当月回収額]+Nz[当月掛売上] の部分を、 ＞当月末残高:[前月末残高]-[当月回収額]+[当月掛売上] は、 当月末残高:Nz([前月末残高])-Nz([当月回収額])+Nz([当月掛売上]) に変更してください。()が抜けていました。
１つの部署に対していくつかに枝分けれするならば、すべてをばらばらにしてデーターの一元性をたもたさなければなりません。最終的に報告書としてまとめるにはそれぞれのコードに対して名前付けが必要になりますから、名前付けの手段としてそれぞれに関連づけてクエリーを幾重にもつくり、その最後のものを実行するだけで目的がはたせるようにしなければなりません。とにかく私の危惧しているのはデーターベースを作成する際の方法です。何件の社員、部署、資格があるのかわかりませんがそれぞれを間違いなくコードだけで入力していくことができるのかという点です。もし件数が多いのならその方法を構築していく必要があります。
追加です フォームヘッダーのテキストボックスに値が入っていない場合 フォームを開いたときに最初に開いたテーブルの販売者も値が無しになりますし 移動時にも販売者が値無しになります。 それを防ぎたい場合は Private Sub Form_Current() If Not IsNull(Me.フォームヘッダーのテキストボックス名) Then Me.販売者のテキストボックス名= Me.フォームヘッダーのテキストボックス名 End If End Sub にしてください。
もう解決されているかもしれませんが、一応。 VBA にて行う例です。 ■不足に事態に備えファイルのバックアップは必ず取って置いてください■ ツールの参照設定から Microsoft DAO 3.6 Object Library にチェックを入れてください。 以下を標準モジュールにコピペして実行してみてください ※この頃ポカが多いので検証はじっくりと・・・。 Sub test() '要参照設定 DAO 3.6 Object Library 　　Dim db As DAO.Database 　　Dim rsFromA As DAO.Recordset 　　Dim rsFromB As DAO.Recordset 　　Dim rsTmp As DAO.Recordset 　　Dim rsTo As DAO.Recordset 　　Dim i As Long 　　Set db = CurrentDb 　　Set rsFromA = db.OpenRecordset("select DT from T1 group by dt order by DT", dbOpenSnapshot) 　　Set rsFromB = db.OpenRecordset("select DT from T1 group by dt order by DT", dbOpenSnapshot) 　　Set rsTo = db.OpenRecordset("select * from T1 order by DT", dbOpenDynaset) 　　 　　rsFromB.MoveNext 　　 　　Do Until rsFromB.EOF 　　　　i = 0 　　　　If rsFromA!DT <> rsFromB!DT Then 　　　　　　 　　　　　　Do Until rsFromB!DT = rsFromA!DT + i + 1 　　　　　　　　 　　　　　　　　Set rsTmp = db.OpenRecordset _ 　　　　　　　　　　("select * from T1 where dt =#" & rsFromA!DT + i & "#", dbOpenSnapshot) 　　　　　　　　i = i + 1 　　　　　　　　　　 　　　　　　　　Do Until rsTmp.EOF 　　　　　　　　　　rsTo.AddNew 　　　　　　　　　　rsTo!DT = rsFromA!DT + i 　　　　　　　　　　rsTo!NM = rsTmp!NM 　　　　　　　　　　rsTo!FEE = rsTmp!FEE 　　　　　　　　　　rsTo!REF = rsFromA!DT 　　　　　　　　　　rsTo.Update 　　　　　　　　　　rsTmp.MoveNext 　　　　　　　　Loop 　　　　　　　　 　　　　　　　　rsTmp.Close: Set rsTmp = Nothing 　　　　　　Loop 　　　　End If 　　　　rsFromA.MoveNext: rsFromB.MoveNext 　　Loop 　　rsTo.Close: Set rsTo = Nothing 　　rsFromA.Close: Set rsFromA = Nothing 　　rsFromB.Close: Set rsFromB = Nothing 　　db.Close: Set db = Nothing End Sub
質問の意味がわからないのですが、推測で回答します。 Sheet2を図のようにして Sheet2には、例えばA1セルに =B1&C1 Sheet1には、例えばA1セルに 　=VLOOKUP(B1&C1,Sheet2.$A$1:$D$4,4,FALSE)
こういうことでしょうか？ 画像はOpenOfficeですが、；を，にすればＥｘｃｅｌでも同じです。 G２セルに =INDEX(B2:E2,1,MATCH("イチゴ",B1:E1,0),1) G5セルに =INDEX(B4:E4,1,MATCH("大根",B3:E3,0),1)
コントロールの移動 http://office.microsoft.com/ja-jp/access-help/HA … 上記に使い方が書かれています。
とりあえず、中間回答ということで SELECT T1.時間,T1.項目,T1.項目件数, (SELECT MAX(日時) FROM Test WHERE Test.項目=T1.項目 And 日時 BETWEEN '2010-12-01 00:00:00' AND '2010-12-01 23:59:59' ) AS 最新日時 FROM ( SELECT SUBSTR(日時, 12, 2) AS 時間, 項目, COUNT(項目) AS 項目件数 FROM Test GROUP BY SUBSTR(日時, 12, 2),項目 ) AS T1 INNER JOIN ( SELECT 時間, MAX(項目件数) AS 最大件数 FROM ( SELECT SUBSTR(日時, 12, 2) AS 時間, 項目, COUNT(項目) AS 項目件数 FROM Test GROUP BY SUBSTR(日時, 12, 2),項目 ) GROUP BY 時間 ) AS T2 ON T1.時間=T2.時間 AND T1.項目件数=T2.最大件数 問題は、「最多出現する項目」が複数あった場合ですね。 Oracle、DB2,Sqlserver,PosgresqlのようにWindow関数があると簡単ですが、Sqliteだと上記の結果を元にもう一度結合処理するぐらいしか思い当たりません。
MySQLであれば、独自機能のGROUP_CONCAT関数で実装できると思います。 参考URL：http://dev.mysql.com/doc/refman/5.1/ja/group-by- …
フォームのデザインビューで、テキストボックス「AAAA」 の上で右クリックし、プロパティシートを表示し、 更新後処理の右端をクリックし、「ビルダの選択」 のフォームを表示し、「コードビルダ」を選択し、 「OK]とします。 表示されたコード表を以下のように設定し、 保存します。 Private Sub AAAA_AfterUpdate() Me!CCCC.SetFocus End Sub これで、「AAAA]の更新後に「CCCC]にフォーカスが 移動します。
Photoshop Album mini 3.0でなくては駄目なのでしたら、 http://www.mirrorservice.org/sites/ftp.adobe.com … にあります。 しかし、Windows2000などではなく、Windows7なのでしたら、3．2でよろしいのではないでしょうか。 ★インストール手順（Photoshop Album Mini 3.2） http://kb2.adobe.com/jp/cps/231/231118.html
http://www.grot3.com/software/office/access/Form … の下の方の設定でできます。 操作ミスを防ぐだけならホームタブくらいは出ても良いと思いますが、気分的にカッコ悪いと思ったら隠しても良いですね。 意図的な変更を防ぐのでしたらmdeにした方が良いと思います。
こんな感じでどうでしょうか。 SELECT date , (SELECT MIN(date) FROM カレンダーテーブル AS T2 WHERE T1.DT < T2.DT AND T2.FLG = 0) - T1.date AS 日数 FROM カレンダーテーブル AS T1; ACCESSの環境がないので動作確認はできていません。
ルックアップテーブルを使うのが簡単そう。たとえば 『書店一覧』というテーブルがあって 書店名 アサヒ 昼間 夕日 等のデータが格納してあるとし。 書籍テーブルでは書店名を納めたいフィールドが 『発行書店』とすれば 書籍テーブルをデザインビューで開き 発行書店の、ルックアップタブを開き 表示コントロール → コンボボックス 値集合タイプ→テーブル/クエリ 値集合タイプ→書店一覧 連結列→１ 列数→1 列幅→2 （見やすいサイズに） 等としておけば、テーブル上でもフォーム上でも お望みの形になると思います。 書店の一覧表テーブル内に、ID・書店名・電話番号・住所などが ある場合はもう少しややこしくなりますけど。 そちらのテーブルの内容が分からないのでここまで。 ところで、 変数を宣言する際にどちらのライブラリを使うか明示されれば DAOとADOの共存できますよ。 http://msdn.microsoft.com/ja-jp/library/cc948691 … ↑の真ん中あたり
テーブルの列構成、どの列で行を一意に識別できるのでしょうか？ >「顧客ID」があるので「顧客ID」が同じという条件で 同一行内で、「コメント」列の値を「ノート」列に移すのではないという意味ですか？ 顧客IDだけでは、テーブル内で行を一意に識別できないなら、行を識別するキーはどうなっているのですか？ 同一行での列値の移動といった話なら、例えば次のようなUPDATE文が考えられます。 UPDATE 顧客 SET ノート=コメント ,コメント=NULL -- コメント列の値は、どうしたい？ [WHERE 検索条件] 母体データ数、更新対象行が数十万件以上といったレベルなら、更新を複数回に分けるといったことを検討する必要があるかもしれません。 もし、「同一テーブル内の別の行へ」といった話なら、前述の通り、行を対応付けるキー、行進対象行を識別するためのキーがどうなっているか提示してください。 また、自表や他表の検索結果を使っての更新などは、RDBMSによる仕様差があったりします。RDBMS名とバージョンを提示してください。
>これはオープンソースなのでしょうか？ オープンソースの意味理解しているのか? オープンソースを勘違いしていないのか?
最初にレコードを作成した順番になりますのでその都度ソートする意外方法は有りません ソートするスクリプト作成しておいてファイルを開いたら適用するくらいですかね
必ず、yyyymmdd と一桁の月と日にはゼロで埋められているのなら あえて、yyyy/mm/dd のフォーマットにしなくとも そのまま使えますよ。 契約開始日と契約終了日が、yyyy/mm/dd になっていて合わせる為なら Format([元データ],"@@@@/@@/@@") とすれば Nullは空白のままです データ型を文字列から日付型に変更する場合は IIf(IsNull([元データ]),Null,CDate(Format([元データ],"@@@@/@@/@@"))) かな？
エラーが起きたなら、 エラーの内容を書くと わかる人にはわかる。 エラー内容を書かなくても わかる人にはわかるのだが、 そういう、まっとうな仕事を している人で、このサイトを 定期的に見てる人がいるか どうかはわからない。 DB2はおろか、DB自体 ほとんど触ったことのない、 人間の直感的な意見だけど、 この辺をチェックしてみるのもよいかも。 http://publib.boulder.ibm.com/infocenter/db2luw/ …
複数フィールドでインデックスを作成してください Access2003まではテーブルのデザインビューで メニューの表示→インデックスからです。 http://www.officepro.jp/access/table/index13.html
私も同じ現象で悩んでいました。 「FileMaker Server の Admin Console は Java 6 Update 24 と互換性がありません」 だそうです。 私が示した参考 URL からの抜粋です。 > Windows の場合、コントロールパネルから Java 6 Update 24 を削除 > することができます。 アンインストールにより、アップデート前の Java に > バージョンを戻すことができます。 参考URL：http://www2.filemaker.co.jp/fmi/xsl/techinfo/bro …
おお！ またやってしまいましたかorz 試したつもりだったのですが・・・言葉もありません。 鱗の次は冷や汗。。。 piroin654 さん ありがとうございます。 そして、質問者さんごめんなさい。 バグの根っこは、getColCount 関数に有りました。 ついでに見直して データが空（Null）だった場合に対応したつもり。 Nz で囲んだだけです。こんどは大丈夫かな？ Function getColCount() As Long '最大の分割数取得 　　Dim db As DAO.Database 　　Dim rs As DAO.Recordset 　　Dim t As Long 　　 　　Set db = CurrentDb 　　Set rs = db.OpenRecordset(tblName, dbOpenSnapshot) 　　 　　If rs.EOF = False Then 　　　　Do Until rs.EOF 　　　　　　t = UBound(Split(Nz(rs!f1, ""), "-")) 　　　　　　If getColCount < t Then 　　　　　　　　getColCount = t 　　　　　　End If 　　　　　　rs.MoveNext 　　　　Loop 　　End If 　　getColCount = getColCount + 1 　　rs.Close: Set rs = Nothing 　　db.Close: Set db = Nothing End Function Sub makeTable()　　 'テーブル操作 　　Dim db As DAO.Database 　　Dim rsFrom As DAO.Recordset, rsTo As DAO.Recordset 　　Dim tdf As DAO.TableDef 　　Dim strSql As String 　　Dim i As Integer 　　Dim tVar As Variant 　　 　　Set db = Application.CurrentDb 　　 　　'既存テーブルにフィールド追加 　　i = getColCount 　　strSql = "alter table " & tblName & " add column F" 　　For i = 1 To i 　　　　db.Execute strSql & CStr(i + 1) & " text(20) ", dbFailOnError 　　Next i 　　db.TableDefs.Refresh 　　'各フィールドにF1フィールドの分割した値を格納 　　Set rsFrom = db.OpenRecordset(tblName, dbOpenSnapshot) 　　Set rsTo = db.OpenRecordset(tblName, dbOpenDynaset) 　　Do Until rsFrom.EOF 　　　　tVar = Split(Nz(rsFrom!f1, ""), "-") 　　　　rsTo.Edit 　　　　For i = 0 To UBound(tVar) 　　　　　　rsTo.Fields("F" & CStr(i + 2)) = tVar(i) 　　　　Next i 　　　　rsTo.Update 　　　　rsFrom.MoveNext: rsTo.MoveNext 　　Loop 　　rsFrom.Close: Set rsFrom = Nothing 　　rsTo.Close: Set rsTo = Nothing 　　db.Close: Set db = Nothing End Sub
　今仮に、A1セルに「点数」、B1セルに「名前」と入力されていて、A2～A6に各点数が、B2～B6に各名前が入力されていて、 C1セルに点数を入力すると、 C2以下に、その点数の人の名前を並べて表示するものとします。 　その方法は、C2セルに次の数式を入力してから、C2セルをコピーして、C3以下に貼り付けて下さい。 =IF(ROWS($2:2)>COUNTIF($A:$A,$C$1),"",INDEX($B:$B,SUMPRODUCT(ROW($A$1:$A$6)*($A$1:$A$6=$C$1)*(COUNTIF(OFFSET($A$1,,,ROW($A$1:$A$6)-ROW($A$1)+1),$C$1)=ROWS($2:2))))) 　後は、C1セルに点数を入力すると、その点数と同じ行に入力されている名前が、C2以下の各セルに表示されます。 【例】 　　　　A列　 B列　 C列 1行目　 点数　名前　 50 2行目　　50　　Ａ　　Ａ 3行目　　85　　Ｂ　　Ｃ 4行目　　50　　Ｃ　　Ｅ 5行目　　90　　Ｄ 6行目　　50　　Ｅ
なぜ Windows 7 に Access 2000 をインストールしてしまったのか。 現行が 2010 だから 2007, 2003, 2002, 2000 と 4世代も前、干支で 1回り前の製品ですよ。 http://www.microsoft.com/japan/office/2007/OScom …
「プロバイダーが見つかりません」が出ているので、AccessDatabaseEngine_X64.exe（64ビット）もインストールしてみたらどうなりますか？ もしも、それで動くなら、64ビットアプリケーションとして動いていることがわかります。 アプリケーションが32ビットなら32ビットのドライバが、64ビットなら64ビットのドライバが使われます。 64ビットOSでは、32ビットと64ビットの両方のドライバをインストール可能です。
そのテーブル類はテーブルウインドウにありますか？ あるなら、リンクではなく、インポートしたのでしょう。 そうでなければ、クエリ自体がパススルークエリである可能性があります。
VB2008 Express Editionでいいんじゃないですか？ SQL Server Express Editionとの組み合わせで 無料です。Windows Server 2003にも入れられますし。 あとはもう本を買ってきたほうが早いです。 10人で社内のLAN内にいる人しか見ないなら WEB化より、Accessの方が作成時間からすれば 簡単だと思いますが。
>=DSUM(C59:E90,E90,C114:E115) この式って =DSUM(C59:E90,E59,C114:E115) ではないでしょうか？ また、 >行の114まで条件が入力できるようになっています。 とありますが、 >C114:E115 これは115行目に条件を入力するのではないかと思いますし、 >条件の部分もセルを結合しています。 とありますが、そうすると見出しと値の入力分で3行必要だと思うのですが 2行分しかないしないように思います。 書いてある内容の整合性がいまいち分からないのですが、 当方の環境（Excel2002 SP3）では、 1.　C59に分類と入力してC60と結合、D59に媒体と入力しD60と結合、E59に金額と入力しE60と結合 2.　61行目から90行目まｄに適当に値を入力 3.　C114に分類と入力、D114に媒体と入力、E114に金額と入力 4.　E117に"=DSUM(C59:E90,E59,C114:E115)"と入力 として、115行目に適当に検索条件を入力するとE117に正しく合計が表示されました。 ただ、C～Eの114行目と115行目を結合、式を"=DSUM(C59:E90,E59,C114:E116)"に変更して 116行目に条件を入力した場合はうまくいかなかったので、 検索条件の見出しが結合されているとダメなのかもしれません。
有効になっていないとか http://www.newsbit.jp/blog/index.php?itemid=83
> "WHERE コード = " & !コード 　"WHERE コード = '" & !コード & "'" あるいは 　"WHERE コード = """ & !コード & """" ですね。 前者の方が分かりやすいと思います。 こちらを参考にして、データ型の違いをマスターしてください。 クエリの抽出条件の例 http://office.microsoft.com/ja-jp/access-help/HA …
　月順位の数値が存在している行には、必ず年順位も存在している場合にのみ有効な方法です。 　今仮に、 「年順位」と入力されているセルがA1セル、 「月順位」と入力されているセルがB1セル、 「修正順位」と入力されているセルがC1セル、 であるものとし、 A列とB列の2行目から11行目にかけて順位が入力されているものとします。 　その場合、C2セルの修正順位を求める数式の一例は、次の様になります。 =$B2+SUMPRODUCT(($A$2:$A$11<$A2)*($B$2:$B$11=$B2)) 　この式を、エラー防止と、行数の変化に対応するように、拡張すると、次の様な数式となります。 =IF(COUNT($A2,$B2)=2,$B2+SUMPRODUCT(($A$1:INDEX($A:$A,MATCH(9^9,$B:$B))<$A2)*($B$1:INDEX($B:$B,MATCH(9^9,$B:$B))=$B2)),"") 　C3以下の修正順位に関しては、C2セルに上記の数式を入力してから、C2セルをコピーして、C3以下に貼り付けるだけで表示されます。
　まず、 A1セルに　　番号 B1セルに　　日付 C1セルに　　内容 D1セルに　　入ったお金 E1セルに　　使ったお金 F1セルに　　残りのお金 と入力して下さい。 　次に以下の操作を行って下さい。 まず、A2セルにカーソルを合わせてマウスを右クリック 　　↓ 現れた選択肢の中から、[セルの書式設定]を選択してクリック 　　↓ 現れた[セルの書式設定]ウィンドウの[表示形式]タグをクリック 　　↓ [セルの書式設定]ウィンドウの[分類]欄の中から、[ユーザー定義]を選択してクリック 　　↓ [セルの書式設定]ウィンドウの[種類]欄に yyyy/m/d(aaa) と入力する 　　↓ [セルの書式設定]ウィンドウのOKボタンをクリックする 　これで、A2セルに例えば 2011/4/5 と入力すると、 2011/4/5(火) と表示される様になります。 　尚、入力している時と同じ年の日付を入力する場合には、年を省略して、 4/5 と入力しても、 2011/4/5 と入力した場合と同じ結果が得られます。 　次に、以下の操作を行って下さい。 D2セルにカーソルを合わせて、マウスの左ボタンを押しっ放しにし、そのまま（ボタンを押したまま）カーソルをF2セルに移動させてから、ボタンを放す。 　　↓ 選択範囲を示す黒い太枠の内側にカーソルを合わせてから、マウスをマウスを右クリック 　　↓ 現れた選択肢の中から、[セルの書式設定]を選択してクリック 　　↓ 現れた[セルの書式設定]ウィンドウの[表示形式]タグをクリック 　　↓ [セルの書式設定]ウィンドウの[分類]欄の中から、[会計]を選択してクリック 　　↓ [セルの書式設定]ウィンドウの[記号]欄の中から、 \ を選択してクリック 　　↓ [セルの書式設定]ウィンドウのOKボタンをクリックする 　これで、D2～F2セルの何れかに、例えば 1500 というデータが入っている場合には、 \1,500 と表示される様になります。 　次に、F2セルに次の数式を入力して下さい。 =IF(COUNT($D2,$E2)=0,"",SUM($D$1:$D2)-SUM($E$1:$E2)) 　次に、A2セルに次の数式を入力して下さい。 =IF($F2="","",COUNT(A$1:A1)+1) 　次に、A2～F2の範囲をコピーして、3行目以下に貼り付けて下さい。 　後は、D列やE列の各セルに、金額を入力して行けば、F列に残金が自動的に表示されます。
１Ａあ ２Ａう ３Ａお １Ｂい ２Ｂえ ３Ｂか これを並べ替えするとできます。並べ替えに必要な情報を生成すればＶＢＡでなくてもできます。 並べ替えの何に困っていますか？。
ADOでやったらどうなりますか？
DLookup関数で参照することができます。 テキストボックスのコントロールソースに =DLookup("フィールド名","テーブル名","抽出条件") と設定すればテーブルのデータを表示させることができます。 ただ、クエリにそのテーブルを含めた方がパフォーマンスがいい場合が多いです。 クエリで参照するのがデータベースの本来のやり方です。それが出来ない事情というのが想像つきませんが、具体的にどのような事情でしょうか。
リレーションなんて、高度な技は必要ないのでは。 「名前」「日付」「感想」「ひらがな」「検索記号用ラン（○、×、△、◎）」「シリアル番号」 これだけ、作って、表テーブルで、一覧、名前で、検索すれば、名前で並びます。 日付で検索すれば、日付で、検索ご、名前でソートしてください。 データーベースには、シリアル番号、と自分で任意に検索するために、◎とか、○とか、×とか、△ のランが一つ作って、あると、便利ですよ。 このヒントで、わかるかな。
もう少し説明します。 (1)アクセスからＣＳＶ形式で「顧客・売掛金・前回検針データ」を出力 0000.csv。 (2)(1)で作成した 0000.csv からハンディ用データを作成 (3)ハンディにハンディ用データを転送。 (4)現場に行き、ハンディで今回の検針データを入力。金額を計算し、印刷。 (5)事務所にもどり、ハンディの結果ファイルからアクセス取り込み用のCSVを作成。1111.csv (6)アクセスに　1111.csv データを読み込ませる。 (1)(3)(6)はそちらのプログラミング (2)(5)はこちらの用意したプログラム (4)は、もちろんこちらの作成したプログラムとなります。 参考URL：http://www.hyper-tsukumi.jp/~m-kwmr/
以下のサイトにあるマクロをOutLookに設定。 http://outlooklab.wordpress.com/2007/08/25/%E8%B … 現在、OutLookをインストールした環境がないので 試していませんが、 Set outApp = CreateObject("Outlook.Application") [Accessからメールアドレスを代入] outApp.Run("ReplyWithAddressBookName") のようにしてマクロを試してみてください。
テーブルの作り方を変更する必要があるのでは。 各テーブルのフィールドで必要ないもの、 あるいは、master以外の各テーブルには主キーとなる フィールドがないので、たぶん分類はできない と思いますが。 各テーブルについて確認しますと、 (1) mastereは、 mas_id---mas_nm---mas_nm2 　　１－－AAAA－－－BBB 　　２－－CCCC－－－DDD ですから、msa_idを主キーに設定します。 構造はこのままでいいと思います。 (2) subは、 mas_id---sub_id---sub_nm 　　１－－－１－－－１１ 　　１－－－２－－－１２ 　　２－－－１－－－２１ 　　２－－－２－－－２２ となっていますが、本来はこうではなく、 mas_id---sub_id---sub_nm 　　１－－－１－－－１１ 　　１－－－２－－－１２ 　　２－－－３－－－２１ 　　２－－－４－－－２２ のように、sub_idを一意に設定しなければ sub_idを設定する意味がありません。 つまり、sub_idをsubの主キーに設定します。 (3) detailは、 mas_id---sub_id---det_id---det_nm 　　１－－－１－－－１－－－１１１ 　　１－－－１－－－２－－－１１２ 　　１－－－１－－－３－－－１１３ 　　１－－－２－－－１－－－１２１ 　　１－－－２－－－２－－－１２２ 　　１－－－３－－－１－－－１３１ のように、なっていますが、 mas_idはsubでデータを持っていますから detailで持つ必要はなく、subと同様に、 sub_id---det_id---det_nm 　　１－－－１－－－１１１ 　　１－－－２－－－１１２ 　　１－－－３－－－１１３ 　　２－－－４－－－１２１ 　　２－－－５－－－１２２ 　　３－－－６－－－１３１ とすれば、subとdetailの間のデータの 関連性は保たれ、かつdetailの各レコードの 一意性が保たれます。ここでも det_idを主キーに設定します。 (4) 同様に、saiについても、 det_id---sai_id---sai_nm 　　１－－－１－－－１１１１ 　　１－－－２－－－１１１２ 　　１－－－３－－－１１１３ 　　２－－－４－－－１１２１ のようにします。sai_idは重複のない数字に 設定します。 まずは、このことについて確認してみてください。 No2で示している、T大分類、T中分類、 T小分類の各テーブルのフィールドの 設定をよく見ればわかると思いますが。 一応、説明しますと、 T大分類　： 大分類ID(主キー) 大分類名 T中分類　： 中分類ID(主キー) 中分類名 大分類ID T小分類　： 小分類ID(主キー) 小分類名 中分類ID のようになっています。 なお、いったんリレーションは解除 しておいてください。 あるいは、あえて言うならばリレーションは 必要はありません。
見出し語があれば定義を取るのは自動化出来ます。 見出し語の一覧を得るのは不可能なので、その会社に申し入れるしかないです。
折角のやる気に水をさすようで残念ですが VBA でどんなに足掻いても、所詮はAccessですから それなりのモノにしかなりませんよ。 キッパリ セキュリティの観点から考えると １・OSレベルのアクセス権で制御（ユーザー分ファイルを分割しなくてはならない） ２・Accessのワークグループ情報に基づく制御 MDBファイルであれば有効ですがACCDBではなくなってしまいました。 Access 2003 のユーザーレベル セキュリティを Access 2010 で設定または変更する http://office.microsoft.com/ja-jp/access-help/HA … またユーザーごとにテーブルを分けなくてはなりませんので 後々管理が煩雑になると思います。 ３・VBAで頑張って、最終的に、MDE か ACCDEにしても 分かる人には分かっちゃうので、余り期待しないほうが良いかと。 それを踏まえたうえで、クエリの抽出条件に environ("username") としてみてください。Windowsのログオン名で選択されます。 ただし、大文字・小文字・全角・半角は同一視されます。
RDBMS名とバージョンは、何ですか？ DDL（定義）は、RDBMSによる機能差、仕様差が多い部分です。
１０年分は年をまたぐのかどうか。 複数年なら、 2005年のある日から今日までとしても、 2005年のある日から年末まで何日か、 ＋2006年＋2007年＋2008年＋2009年＋2010年 ＋2011年の今日まで何日か。 日単位の算出は2005年と2011年だけになるようにできないか。 過去年なら曜日祝日が決まっていれば、 その年の月曜は何日ある、日曜は何日ある、祝日は何日と決まるはず。 １度テーブルを作っておけば良いのでは？。 求めるときには作ったおいたテーブルからレコードを選択、検索する。 3650レコード分を都度作成しようとしていないか。 それは無駄な処理かもしれない。 3650件程度でストレスが出るほどというのもどうでしょう。 アクセスで扱うデータ量を考えると許容範囲かと思います。 どこに時間がかかっているかを見直す。 クエリなどの結合はどうか。 さらなる効率化となると、 算出式を考えて求められたらいいが、 土日だけなら 単純に１年の週の７分の２が土日＋週の端数での考慮、 祝日もあれば、そうもいかないと思います。
SQLデータベースが何か書かれてないので、もしかすると違うかもしれないけど 標準準拠なら、% はワイルドカードといって、０個以上の文字列にマッチ %@ では、@ 文字のみ、または、何かの文字列の最後に@ が付いてるもの mysqlだとlike '%@' のように使う。 in で使えるところをみると、mysql以外のようだけど。
ファイル復元ソフトを使用する。 ■ファイナルデータ 　http://finaldata.jp/ あたりが有名。 フリーソフトでもあるけど、自分は使ったことが無いのでコメントはパス。 ■Glary Undelete 　http://www.forest.impress.co.jp/lib/sys/file/del … とか。 くれぐれも消してしまったファイルがあるドライブにインストールしないように！ 上書きされて二度と復元できないようになる可能性があります。 （他にドライブが無ければ、一時的に USBメモリにインストールするなどしましょう）
> このような場合、リレーションはどのようにすればいいのでしょうか？ まず、テーブルですが、3つ用意することになります： 　1)部品を一元管理する『部品名称』テーブル 　　(「部品番号」が主キー) 　2)機種を一元管理する『機種名称』(仮名)テーブル 　　(「機種番号」が主キー) 　3)各機種で使用する部品とその数などを記録する『構成一覧』テーブル 　　(1機種内で同部品を複数使用する場合に、『数量』フィールドのみで 　　対応できるなら「機種番号」と「部品番号」の2フィールドで主キーに、 　　「1機種が複数ユニットから構成される」等の理由により同機種内でも 　　部品番号が重複するなら、別に通し番号を設定するなどして、そちらを 　　主キーに、それぞれ設定) 　　※このテーブルには、『機種名』や『部品名』は記録しません(念のため)。 その上で、リレーションシップは以下のように設定します： 　a)『機種名称』の『機種番号』(1)－(多)『構成一覧』の『機種番号』 　b)『構成一覧』の『部品番号』(多)－(1)『部品名称』の『部品番号』 こうすることで、 　1)部品メーカー等による部品自体の変更は『部品名称』で、 　2)自社製機種の名称変更などは『機種名称』で、 　3)自社製機種の設計変更(一部部品の置き換え等)は『構成一覧』で、 それぞれ対処すればよい、ということになります。 このあたりの考え方については、もしも余裕があるようでしたら、「正規化」と いうものを調べてみることをお勧めします。 参考までに、以前以下のQ＆AのNo.6で提示したURLを再掲しておきます： http://oshiete.goo.ne.jp/qa/6153112.html テーブルの『正規化』： http://www.annyys.net/html/kihon_002.htm http://www.atmarkit.co.jp/fdb/rensai/db_enginer0 …
リンク先のテーブルにユニーク索引を作成してください。 alter table テーブル名 unique ( 項目1, 項目2, ... ) これで更新クエリで対象レコードが指定した項目でユニークになるのであれば更新可能なはずです。
もし、プログラムソースの問題でなければですが、Access2003を再起動してみては？必要であれば、Windowsの再起動も！ 過去にAccessでツールを作成していて、コードと違った動作をする事象がありました。 「コーディング->動作確認->コーディング・・・」のサイクルを何度か繰り返すと度々起きてました。 ですが、Access若しくはWindowsを再起動することで回復してました。 運用時には”おかしい”といった報告はなかったので、開発時に起きる現象と認識して仲良く付き合って作業を進めていましたよ。
従業員テーブルと健康保険料表テーブルそれぞれに 健康保険加入フィールドと介護保険加入フィールドがあれば、 従業員::健康保険加入＝健康保険料表::健康保険加入 従業員::介護保険加入＝健康保険料表::介護保険加入 のリレーションを追加すればいいんじゃないでしょうか。 そして、「入力値の自動化」「ルックアップ値」「近似値（小さい値）を使用」
> Access2000からSQLServer2008Expressにつないでいます。 これはリンクテーブルですか、それともパススルーもしくはADOでのExecuteメソッドどれでしょう。 パススルーもしくはADOでのExecuteメソッドの場合は上記の構文はエラーになるはずです。 SQL-SERVERでの構文は UPDATE A SET A.ロット = B.LOT_NO FROM A,B WHERE (A.枝 = B.枝) AND (A.依頼 = B.依頼) AND (A.ロット IS NULL) AND (B.LOT_NO IS NOT NULL) になります。 リンクテーブルの場合は、結合条件である（依頼,枝）が主キーであり、ACCESSにリンクする際にその旨登録する必要があります。 条件を満たしていれば、提示しているSQLで更新可能なはずです。
DB2 の接続情報が違うというのがありがちな気がします。 DB2 の接続先，ID, パスワードは確認されました？
なるほど、やはり改ページコントロールの 位置の問題でしたか。ループと聞いて ひょっとしてと思って改ページコントロールの 位置をずらしてみて確認していたのですが、 他の問題があるのかと思っていました。 質問で提示されたコードはこのような場合の 模範コードのようなものですから、コードには 問題ないと思っていたのですが、解決はなによりです。 同じようなレポートを作成したいという人に とってはこのコードは最高のサンプルになります。
No.2,3です。お礼ありがとうございました。 ＞[プログラミング言語][DB]では何もできないような ＞どうしてMySQLを使う必要があるのでしょうか？ まず、高度なことをしようと思えば、高度なことができるプログラミング言語が必要になります。 ここのサイトも[プログラミング言語＋DB]でなければ、ここまで高度なことはできません。（しかも高速に） また、[DB管理システム]と[DB]を組み合わせて使うのは、[プログラミング言語＋DB]で開発し、そのDBの１項目などをチョットだけ直したい場合、それだけだとSQL文で直さないといけないのですが、[DB管理システム]でそのDBと接続することができれば、表形式に表示して簡単に一部を修正できるので間違いが少なくなります。 また、DBを参照するだけでも表形式の方が見やすいですしね。 今回、出て来た[プログラミング言語]は、ほとんどがWeb系のプログラミング言語ですが、ブラウザに表示するようなものを作ろうとした場合は、必然的にこれらの言語からどれかを選択することになります。 それは[DB管理システム]自身のDBと組み合わせて使うことができないため、必然的に[DB]と組み合わせて使うことになります。 その時に、補助的な目的でその[DB]に[DB管理システム]を接続し、使うというものです。 文章が長い割に、うまく説明できなくて済みません。
SQLiteのバージョンは、何ですか？ SQLite3以降であれば、sqlite_master表に「create table文」がそのまま入っていると思います。
サブクエリのお話になりますか。 それとも、以下のような表示にする方法になりますか。 会社　部署　200901経費計　200902経費計　200903経費計　200904経費計　201001経費計 AAA　AAA01　　　30000　　　　　　30000　　　　　　40000　　 BBB　AAA01　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　50000　　　　　　　60000 CCC　AAA01　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　150000 後者だとして、上記の表示にするには、クロス集計を使います。 クエリをSQLビューに変更して、以下を記述します。 TRANSFORM Sum(経費TBL.経費) AS 経費の合計 SELECT 経費TBL.会社, 経費TBL.部署 FROM 経費TBL GROUP BY 経費TBL.会社, 経費TBL.部署 PIVOT 経費TBL.年度 & Format(経費TBL.月,"00") & "経費計"; 記述後デザインビューに変更すると、デザインビューでの書き方がわかると思います。 上記では、データのある年度、月で表示されますが、 > 会社 , 部署 , 200901経費計 , 200902経費計 , … , 201012経費計 より 2009の1月～2010の12月までを表示したい場合は、工夫が必要になります。 上記のクエリに、「クエリ列見出し」を設定する方法があります。 また、以下のような方法もあります。 テーブル２つ追加します。 テーブル「T年度」に「年度」(数値型)に 2009　と　2010 の２レコードを登録しておきます。 テーブル「T月」に「月」（数値型）に　1　～　12　の１２レコードを登録しておきます。 クロス集計を使うことに変わりはありませんが、SQLビューで記述する内容を以下にします。 TRANSFORM Sum(Q2.経費) AS 経費の合計 SELECT Q1.会社, Q1.部署 FROM (SELECT 会社, 部署, 年度, 月 FROM (SELECT DISTINCT 会社, 部署 FROM 経費TBL) AS T1, T年度, T月) AS Q1 LEFT JOIN 経費TBL AS Q2 ON (Q1.会社=Q2.会社) AND (Q1.部署=Q2.部署) AND (Q1.年度=Q2.年度) AND (Q1.月=Q2.月) GROUP BY Q1.会社, Q1.部署 PIVOT Q1.年度 & Format(Q1.月,"00") & "経費計"; サンプル上では動いているようですが、使える/使えない等自己責任にてお願いします。 （2007でやってみましたが、2003でも動くと思いますが・・・）
RDBMSは何ですか？ SQLCODEは、各RDBMSでそれぞれ独自の値を割り当ており、RDBMSが異なれば意味も違ってきます。 ちなみに、各RDBMSでバラバラのエラーコードを、ほぼ同じ意味で割り当てるために設けられているのが、SQLSTATEです。
受信者が日本語で表示される設定はすでに済んでいるようですので、あとはクライアントの設定だけです。 設定についてはこちらをどうぞ。 http://detail.chiebukuro.yahoo.co.jp/qa/question …
下記の記事に該当する事象のようです。 [ACC2000]フォームヘッダ/フッタのコンボボックスで入力ができない問題 http://support.microsoft.com/default.aspx?scid=k … MSもバグと認識していて、AC2002 で修正されたようです。 ということでAC2002以上にバージョンアップするというのが一番の解決策でしょう。 AC2000 のままでいくなら、 現在の帳票フォームを非連結のフォームにサブフォームとして埋め込んで、検索用のコンボボックスはメインフォームの方へ移動する。 あるいは、 レコードセットをダイナセット、追加の許可をはいにしておいて、詳細のすべてのテキストボックスの編集ロックを「はい」にして入力できないようにしておく。
もしかして その共有フォルダにあるMDBを皆が突っつき合っているのですか？ それなら『データが飛びまわる』可能性が高いですね。 元々個人的に使用する場合を考えて作られてきたので 共有して安定させるには、かなり作りこまねば（試行錯誤）なりません。 とりあえずはこの辺をご覧下さい。 Access 共有 注意点 の３つのキーワードでGoogleりました。 http://detail.chiebukuro.yahoo.co.jp/qa/question … http://www.naboki.net/access/achell/achell-01.html http://www.naboki.net/access/achell/achell-02.html
こんばんは。 ＞データベースが何であるかよくわかりません。 なので、 データベース使用経験 には、「経験なし」と記入すればよろしいかと・・・。
No5の最初の部分について少し訂正です。 「T部屋マスタ」 部屋コード(数値型、あるいはオートナンバー) 部屋名 として、 「T商品マスタ」 商品コード(数値型、あるいはオートナンバー、主キーとしていない) 商品名 部屋コード(数値型) 部屋名 としています。 「T商品マスタ」は「T部屋マスタ」の部屋別に 同じ商品名が存在する可能性があるかもしれない、 という想定にしています。つまり 「T部屋マスタ」 部屋コード　　部屋名　 1　　　　　　　部屋A 2　　　　　　　部屋B 3　　　　　　　部屋C 「T商品マスタ」 商品コード　商品名　部屋コード　部屋名 1　　　　　プランA　　1　　　　　部屋A 2　　　　　プランB　　1　　　　　部屋A 3　　　　　プランB　　2　　　　　部屋B 4　　　　　プランC　　2　　　　　部屋B 5　　　　　プランC　　3　　　　　部屋C 6　　　　　プランD　　3　　　　　部屋C のようなデータではないか、ということです。 さらに、このTreeに他のテーブルのフィールドを 載せるのならば、他のテーブルと「T部屋マスタ」 の関係、あるいは「T商品マスタ」との関係が 明確であること、すなわち部屋コードや部屋名が ある、あるいは商品コードがある、のどちらかならば Treeにフィールドを追加できます。ただ、 「Q商品」はどのようなTreeeを形成するために 作成したのか、ただテーブルがこのようにありますと 示されても上記のような設計になっているのか 分からないので、そのまま「Q商品」のフィールドを ノードに追加していっても意図したTreeになる ということはまったく保証できません。 TreViewを設定するときはデータの設定、 つまりテーブルの設計と親子関係を 明確にするフィールドの設定が非常に 重要で、アバウトな設計ではTreeViewは 形成できません。
PerlでNet::Smtpモジュールを使う例 http://www.hidekik.com/cookbook/p2h.cgi?id=smtpt … Rubyでnet/smtpモジュールを使う例 http://d.hatena.ne.jp/koseki2/20090328/rubymail basp21を使う http://www.atmarkit.co.jp/fwin2k/win2ktips/301ma … いずれにしても、メール一件ずつSMTPサーバーに接続して、送信、クローズを行うのでスピード的にやや難があるかもしれませんが。
オートナンバーのフィールドを 設定するだけでいいのでは。 主キーである必要はありません。
>フォーム上で「１０：００：００」と表示されているのを，「午前１０時００分」と表示させたい とっても微妙～～～～～な質問です。 全角で表示されてますよね？ 一時一分の場合はどのように表示？ このテキストボックスコントロールは連結コントロール Or 非連結？ 連結の場合は元になっている大元のテーブルとクエリのフィールドの説明？ ただ表示されれば良いのですか。どこかの計算か何かで使いませんか？ Access のバージョンは？ フォームをデザインビューで開いて当該のコントロールの書式を ampm hh時nn分 とすれば良さそうですが、それだけではかなり危なっかしい気がします。 念のため上記の六つの？を教えてもらったほうが良いかもです。 ※書式設定のヘルプは、先のフォームをデザインビューで開き 「１０：００：００」と表示されている所のプロパティの書式タブの書式欄に カーソルを持って行ってから、F1キーを押せば現れます。 こんな風に "Format/書式" プロパティ "Format/書式" プロパティを使用して、日付、時刻、およびテキストの表示方法と 印刷方法をカスタマイズできます。参照と設定が可能な文字列型のプロパティです。 解説 定義済み書式を使用することも、書式指定文字を指定してカスタム書式を作成することもできます。 設定値は、データ型によって異なります。それぞれのデータ型の設定値については、次のトピックを参照してください。 日付/時刻型 ～～～以下省略～～～ で 日付/時刻型をクリックすれば説明が現れます。 ↓ "Format/書式" プロパティ ― 日付/時刻型 日付/時刻型のデータの場合、"Format/書式" プロパティに定義済みの日付/時刻書式 またはカスタム書式を設定できます。 ～～～以下省略～～～ まずは、F1 キーをあっちゃこっちゃで押してみることです。 ヘルプを見ても分からなければ→WEB上のサイトを検索→最後にコミュニティで教えてもらう 『天は自ら助くる者を助く』です。
ちょっと違ったやり方を （１）「.NET Framework v3.5」がインストールされていることを確認する。（C:\WINDOWS\Microsoft.NET\Framework\v3.5\vbc.exe」が存在する） 「.NET Framework v4.0」は不可。 （２）以下の内容のファイル「RegxReplace.vb」を保存する。 Imports System Imports System.Data Imports System.Data.SqlClient Imports System.Data.SqlTypes Imports Microsoft.SqlServer.Server Public Class RegxReplace <Microsoft.SqlServer.Server.SqlFunction()> _ Public Shared Function RegxReplace(s As SqlString,r As SqlString,d As SqlString ) As SqlString Dim source As String = s.ToString() Dim regx As System.Text.RegularExpressions.Regex = New System.Text.RegularExpressions.Regex(r) Dim ret As SqlString = new SqlString(regx.Replace(source, d.ToString())) Return ret End Function End Class （３）「C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\Binn\sqlaccess.dll」があることを確認。 （４）コンパイル vbc /t:librarly /r:"C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\Binn\sqlaccess.dll" RegxReplace.vb 「RegxReplace.dll」が出来ればOK （5）SQLCMDからManagementStudioで以下のSQLを発行してSQLCLRを有効にする。 EXEC sp_configure 'show advanced options', 1 GO RECONFIGURE GO sp_configure 'clr enabled', 1 GO RECONFIGURE GO （６）続いてDLLの登録。使用するDBを選択して実行。 USE データベース名 GO CREATE ASSEMBLY [RegxReplace] FROM '作成したDLLファイルのフルパス' WITH PERMISSION_SET = SAFE GO （７）SQLで使えるように関数の公開 CREATE FUNCTION RegxReplace( @str nvachar(max), @regx nvarchar(max), @repnvarchar(max) ) RETURNS　nvarchar(max) EXTERNAL　NAME　RegxReplace.RegxReplace.RegxReplace GO (8)試してみる ・数字を削除 select cast( dbo.RegxReplace( 'ABCDEFG123','\d', '') as varchar(20) ) →'ABCDEFG' ・数字以外を削除 select cast( dbo.RegxReplace( 'ABCDEFG123','[^\d]', '') as int ) →123 （９）order by句を組み立てる order by cast( dbo.RegxReplace( 項目名, '\d', '') as varchar(20) ), cast( dbo.RegxReplace( 項目名, '[^\d]', '') as int )
2つのテーブルの結合条件があると思います。それに使える索引が存在するかどうか。 後、where句でテーブルA、Ｂがどれくらい絞り込めるかが分からないと適切な実行プランが割らりません。 たとえば、テーブルAでnameが条件なっていて、テーブルBでageが条件になっていて、結合条件のカラムにＩＮＤＥＸがない場合、テーブルBで絞り込める件数が少なければ、 SELECT /*+ INDEX( テーブルA name ) INDEX( テーブルB age ) USE_HASH( テーブルA　テーブルB ) */ になると思います。 しかし、結合にＩＮＤＥＸが使えるなら、そのINDEXを用いた INDEX、USEL_NLヒントを指定した方が実行コストは小さいでしょう。
メインフォームが、絞り込み値の「００１」、「最新日付」「直前最新日付」で サブフォームがその明細、 としたらメイン、サブにしなくてもいいように思います。 ただ単にサブをやってみたいがためにしたのなら検討しても良い。 クエリやフォームをしっかり覚えてからサブフォーム試すのがベターです。 サブのイメージをそのままメインに、 メインのフォームヘッダに「００１」、「最新日付」「直前最新日付」 でもよさそうだが、どうでしょう。 フォームにて「００１」や「００２」を入力し随時絞り込みできますし。
＞現在、1～５までをそれぞれのテーブルを作って、フォームを作ろうとしています テーブルの状態が固まってからクエリやフォームを作る。 フォームを作ってておかしいからと言ってまたテーブルを直す、またフォームを直す、 これがあまりにも頻繁に起きていたのでは時間のロスです。 土台となることをしっかりやること。 確認できた事項から取り組むこと。 その方が後でやり直しが少ないです。 作り方が確かな部分とあやふやな部分を明確にしておくこと。 中途半端で進めると、どこでどうおかしくなったか訳わからなくなりますから、 おかしいときはこのあたりだ、だけでも進めるうえで違います。
＞勉強の仕方がどうのこうのと言うより、まず使って慣れろ 使う時間は増やしてもらっていいですが、 勉強の仕方がめちゃくちゃとか自分のレベルに合わないことを いきなり取りかかろうとするとかえって遠回りでしょう。 実際に作ると言っても、 設計、仕様を考える 目に見えるもの（フォームやレポート）を考える 使える機能を考える クエリ等でデータを組み立てる 正規化、効率化を考える 機能アップを考える いろいろ段階があります。 できあがったものを見たときは、どこまで吸収できるか、です。 ちょっと状況変わると何を変えたらいいかわからない、 エラーが出ると何していいかわからない、 それなら基礎から学習しておいた方が良い。
こうしたら？ サブフォームのレコードソースを仮に『T1』として （テーブルかクエリ） T1のフィールドに『期日』が有るとします。 メインフォームのコントロール名とコントロールソースをそれぞれ 最新期日改 = Dmax("期日","T1") 直前最新期日 = Dmax("期日","T1", 期日 < #" & 最新期日改 & "#") ↑は↓でも 直前最新期日 = Dmax("期日","T1", 期日 < #" & Dmax("期日","T1") & "#") 最大値の次に大きい最大値は・・です。 期日フィールドが日付型としています。
間違いがいくつかあります。 DoCmd.OutputTo acOutputReport, "受注確認PDF", acFormatPDF, "C:\PDF" 上記のコードで、出力ファイル名が指定されていない。 ちゃんと拡張子も含めてファイル名を指定する必用があります。 さらにファイル名には、: は使用できません。 レポートを開くときのイベントでOutputToを実行してますが、このイベントではOutputToは実行できません。フォーム上のボタンのイベントプロシージャで OutputTo を実行しましょう。 「一件（１ページ）づつ保存する」ということですが、具体的にはどのように１件だけ抽出しているのでしょうか。レポートのレコードソースをパラメータクエリにしているのでしょうか。それともレポートを開くアクションで Where条件式を設定しているのでしょうか。 パラメータクエリで、受注一覧フォームの受注IDを参照しているとして回答します。 また、マクロとイベントプロシージャを混在させるのは煩雑ですので、イベントプロシージャのみで記述します。 受注一覧フォーム上のコマンドボタン（コマンド1）のクリック時のイベントプロシージャ Private Sub コマンド1_Click() DoCmd.GoToRecord acActiveDataObject, , acFirst Do If Me.Recordset.RecordCount = Me.CurrentRecord Then MsgBox "最終レコードまで出力しました。" Exit Sub End If DoCmd.OutputTo acOutputReport, "受注確認PDF", acFormatPDF, "C:\PDF\受注確認書(受注ID " & Me.顧客コード & ").pdf" DoCmd.GoToRecord acActiveDataObject, , acNext Loop End Sub
普通に内部結合でいけるんじゃないか？ select DDD.SOFU_COD, DDD.IDO, DDD.TEL from DDD inner join AAA on DDD.IDO = AAA.IDO
＞クエリで表示だけさせない方法 『クエリで表示だけさせない』ための条件は、 表示させたくないレコードと表示させたいレコードの区別をつける、 その手段が「・・・フラグ」や「適用開始・終了日」。 「・・・フラグ」とはいいつつも、とりあえず値は何でもいいんです。 表示させたくないレコード＝１、表示させたいレコード＝０、等ON/OFFそれだけ。 クエリで＝０だけ、とやれば表示させたいものだけ、です。 しかし「得意先」「取引先」の特性から、「適用終了日」。 この４月から取引始めます、というのは今登録しても実際には使ってはいけないし、 ほか合併あるから３月いっぱいだけ取引は控える、は３月だけ止める、 ２月末で取引先社名が変わる、は３月以降止める、 などある期間でもって使える使えないがあると 単に＝１や＝０よりは、「適用開始日」「適用終了日」のが融通効いて好ましい。 取引先だけでない、商品なども同じ。 １番いけないのは、 １つの項目に２つ以上の意味を持たせ、項目本来の使い方が失われること。 こういうときにしか使わない項目なのになぜ・・・になってるの？、と 不具合を招くもとです。 『論理削除』は、取引先でなくてもよく使う手段です。 レコードを実際削除するのかどうかは有識者に確認です。
一般的なことですが同じ系列のデータは、分けない方がいいです。 と、いうのは、分けてしまうとデータがまたがるテーブルに対して問い合わせを行うのがややこしくなります。 ですので分けない方が得策です。 データベースは、本来データを蓄積していく物です。 『データが多くなると遅くなるんじゃないか』と思うかもしれませんがデータが増えて遅くなるのならその処理のやり方に何かしらの問題があると考えるべきです。 インデックス等を必要な場所に付けていればデータの量が多くても少なくてもさほど関係ありません。 ただ、MS-Accessの場合は、それ自体にデータ量の制限があります。 細かい計算は、さておき　2GBの壁があります。 通常のキャラクターならかなりの量が保有可能ですがやはり限界があることも事実としてあります。 また、Access自体のデータベースの不安定さも考慮すべき点と思います。 ある程度データ量があり、業務で使用するデータであるのなら SQL Server等のデータベースを使用することも考えた方がよろしいかと思います。 Microsoft SQL Server 2008R2 Express ですと　10GBまでのデータを扱えます。 こちらは、無料です。 SQL Serverは、難しくありません。ややこしいのはインストールだけです。 既に、MS-Access でシステムを作成なさっているのならテーブルをSQL Server へ転送してそのテーブルにリンクすれば、Access のシステムを使い続ける事ができます。 操作は、Access データは、知らないうちにSQL-Serverへいく　システムになります。
EPSONのプリンタのホームページにて、 http://faq.epson.jp/faq/01/app/servlet/qadoc?000 … よくある質問コーナー 「任意の用紙サイズ（ユーザー定義サイズ）を使用したい」 説明があります。 よく使う用紙、ということならメーカ側が準備しているものです。 会社オリジナルなら個別設定でしょう。 これでもダメなら印字許容範囲を満たして一番近い設定にしておく。 連続帳票なので印字テストは必須です。 余白を必要以上に多くしたりして 右端をミシン目位置に設定したいけど実際はさらに左へ１ｃｍが設定上の右端、とか。 微調整するものです。 こういう決まった用紙なら、 ｃｍ定規でなくてインチも測ることができる定規のが良いです。 印刷設定側もインチ表記あります。 アクセスのレポートのゲージは、 センチ表記ですか？インチ表記ですか？。 インチ表記にするとわかりやすいです。
> 使用してたDBはDB2です。 > エラーになったのではなく、別の結果が出ていました。 補足、ありがとうございます。 DB2は手元に無いので確認は出来ないのですが、エラーになるならともかく、別の結果になったのはちょっと不思議です。 実行されたSQLの内容とその時のテーブルのデータを補足して頂ければ、何か分かるかもしれません。
手作業でやっていることを、そのまま置き換えるのが一番簡単そうです。 Access からオートメーションでExcelのBookを開き Access で取り出しやすいように整形してから取り込む。 こんな感じ ※MDB ファイルと XLS ファイルは同じフォルダにあると仮定しています。 Sub test() 　　Dim oXL As Object 　　Dim oBK As Object 　　Dim oSH As Object 　　Dim tmpXls As String 　　Set oXL = CreateObject("excel.application") 　　Set oBK = oXL.Workbooks.Open(CurrentProject.Path & "\得意先リスト.xls") 　　Set oSH = oBK.Sheets("リスト形式") 　　tmpXls = CurrentProject.Path & "\得意先リストtmp.xls" 　　With oSH 　　 .Rows("1:4").Delete Shift:=xlUp 　　 .Columns("O:AZ").Delete Shift:=xlToLeft 　　 .Columns("I:L").Delete Shift:=xlToLeft 　　 .Columns("E:E").Delete Shift:=xlToLeft 　　 .Columns("A:A").Delete Shift:=xlToLeft 　　End With 　　If Dir(tmpXls) <> "" Then 　　 Kill tmpXls 　　End If 　　oBK.saveas filename:=tmpXls 　　oBK.Close SaveChanges:=False 　　oXL.Quit 　　Set oXL = Nothing 　　'CurrentDb.Execute ("delete * from 得意先リスト") 　　'↑既存レコード削除ですので必要に応じて！！ 　　DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, _ 　　"得意先リスト", tmpXls, hasFieldNames:=True 　　DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, _ 　　"得意先リスト参考までに", tmpXls, hasFieldNames:=True 　　MsgBox "終了" End Sub 参考になるかと思われるところ（私も以前どっぷりとハマリましたorz） http://hanatyan.sakura.ne.jp/vbhlp/ExcelErr.htm http://homepage1.nifty.com/rucio/main/technique/ …
合っているかわかりませんが・・・。 http://social.msdn.microsoft.com/Forums/ja-JP/sq … 「仮想ＯＳ」の機能も参考かと思われます。
>varcharにしておけば大丈夫 それはフィールドのデータ型の話ですね。 業務にマッチしたテーブル設計とは次元が 違います。 >文字列なら必ずインポートできるから インポートするとは即ち、そういうテーブルが 新しくできると言うことなので、「設計する」 という話ではなくなります。 確かに、何も考えないでインポートすると、 勝手に型が決まってしまうので、会員ＩＤの ように前ゼロが意味を持つデータなのに、 数値と認識されて前ゼロが取れるという トラブルが起きないとも限りません。 なので、インポート時の問合せには全て 文字型と答えておけと言うのかも知れない ですね。 でも、それは技術云々ではなく、業務上の 要件ですから、知らなくてよいというもの でもないと思いますよ。 少なくとも、数値、文字列、日付くらいは区別 して使うべきでしょうね。いずれは使いこなせる ようにならないと、アナタが困りますよ。
エラーメッセージが出ている通りでしょう。 >ファイルサイズは規定の４９MB どこからこの数値が？ ディフォルトで2メガか4メガくらい。 iniを変更してもMAXで8メガがインポートの制限だったと思う。 データを分割してインポートしてみてください。
year( current date ) * 10000 + month( current date ) * 100 + day( current date )
基本がしっかりしていれば、上達します。 自分で解決策を探すことを知っているし、持っています。 一例） ACCESS http://www.happy2-island.com/access/gogo03/capte … http://www.tsware.jp/index.htm http://www.accessclub.jp/index.html EXCEL http://www.asahi-net.or.jp/~ZN3Y-NGI/YNxv20002.h … http://www.asahi-net.or.jp/~ef2o-inue/top01.html http://www.voicechatjapan.com/excelvba/VBArei4.htm 基本的にパソコンは、 きちんと指示すればきちんと答えを返してくれます。 意図しない結果となるとき、 『できない』じゃなくて『できないように指示していることに気付いていない』 使い方間違えば、それなりの動きをします。 使い方や事例、サンプルはたくさんありますから、 １つでも多くこなして自分のモノにすること。 機能要件（仕様）を考える→使う命令、仕組みなど考える→組み立てる →関数やコードを書く→確認する （仕様）があいまいなうちに結果を急ぐと結果はともないません。 そこで、 サンプルやコードを見たまま使って終わり、 これでは結果は出ますが、あなた自身は何も得るものがなく上達しません。 カンニングに近いと思えば良いです。 答えだけみるか、答え見て解説までみるか、さらに自分で何か作るか・・・、 これだけで差が出ます。 一言で言えば、『プログラミング』しているかしていないか、 『プログラミング』しない人はなかなか力が身につきませんね。 アクセスでもエクセルでもいいので、 何か作成課題テーマを持ってみては？。
＞→Q_型式で2個表示されます。 基になっているクエリでレコードが２個なので２個、 SQLの「DISTINCT」で対処できる可能性あります。 ＞レコードが新規 フォームのプロパティ「レコード追加の許可」で対処できる可能性あります。 この２つを学習してみてください。 おかしい、と思ったときは、フォームならプロパティ、クエリを中心に 「そのように仕向けている」と思っても良いです。 クエリで正しいデータを取得できていて、それでコンボボックスに定義できる、 というもの。使い方がおかしい？と見なおす。 どこかにおかしいかも、というところがある、のがほとんどです。 サブフォームを扱うには フォーム１面の動作はある程度理解できている必要あります。 ・・・・のときはどうなる、ｘｘｘｘのときはどうなる、 こういうのを整理して把握していく。 いろいろ高度なこといきなりやると原因がどこにあるのか探すことになりますが、 １つずつ段階踏んで理解していれば、不安なところは覚えたての箇所に限られます。 これは間違っていないから、 ここにおかしい箇所がある、そういう見方になってきます。 ACCESS http://www.happy2-island.com/access/gogo03/capte … http://www.tsware.jp/index.htm http://www.accessclub.jp/index.html
> ユーザー名とはどの事を指しているのでしょうか？ 登録フォームの電子メールアドレスです。
>・毎日CSVを作るためファイル名に日付を入れたい 実行日時をバッチ内なり、SQL内なりで取得してファイル名に付加すればいいのではないでしょうか。 具体的な処理方法がわからないので、自分にはこれ以上の回答をすることができません・・ >・抽出条件に特定の日付を入れたいのですが対象のテーブルでは日付を日付型でもっておらず文字列です 日付項目をyyyymmdd形式の文字列に変換して比較すればいいのではないでしょうか。 >対象のdbがOracle、DB2、MySQLです。 全てのDBに対してひとつのファイルで処理するということなのでしょうか？ そうだとすると変換の方法が難しいかもしれませんね・・
ドリームウィーバーは使ったことが 無いのですが、Access本体の クエリビルダでは使えると思います。 次に思いつく手は二つあります。 一つはAccessにTransformクエリを 作成しておき、"SELECT * FROM クエリ" というSQLで開く。こちらは条件の反映が 難しいです。別途、条件テーブルを使って、 結合させる必要があるかも知れません。 もう一つは条件で集計する方法です。 SELECT SName, SUM(IIf(SCat=1,1,0)), -- 中略 -- SUM(IIf(SCat=5,1,0)) FROM Syouhin WHERE ～ GROUP BY SName もしかして、IIｆはAccess特有の関数 なので、通用しないかも知れません。 Oracleで言うDECODEやCASE WHEN に 相当する関数です。
多分「曜日」のリレーションが出来てないのでしょう。 完全に同じでないとリレーションしない。 ○「日曜日」 ×「日」「日曜」 サンプルをアップしてありますので、解析してください。 リンク先「売上.fp7」「売上.zip」どちらも同じものです 参考URL：http://briefcase.yahoo.co.jp/bc/nyrky004/lst?&.d …
NOT EXISTSを使ってもよさそうです。 --全角でインデントしています select * from 表 a where not exists ( 　select * from 表 b 　where a.顧客ID = b.顧客ID 　and a.月 = b.月 　and (a.購入日 < b.購入日 or (a.購入日 = b.購入日 and a.連番 < b.連番)) ); 自レコードと顧客ID・月が同一で、購入日が後のデータor購入日が同一で連番が大きいレコード が存在しないものという条件で取得します。
レポートのOpenイベントで、レコードソースを動的に 変更すれば可能です。よく使うやり方ですよ。 例えばフォームで条件を変え、それを反映した SQLに動的に差し替えるなどフツーの話です。 以下はOpenイベントでの処理例です。 Private Sub Report_Open(Cancel As Integer) Me.RecordSource = "XXX" 'クエリ名 End Sub
＞SELECT Count(M_File.key) AS M_F_count ＞FROM BUSYO_MST LEFT JOIN M_File ON BUSYO_MST.Key = M_File.key ＞GROUP BY BUSYO_MST.Key というのは [Count] ０ ２ １ のカウント数の項目だけ、他テーブルと紐付けるキーがありませんね。 それと、 このカウントを求めるのに「BUSYO_MST」との紐付けは必要ですか？。 ここで、紐付けが無くても りんご　２ みかん　１ という（発生分の）２個のレコードは生成できます。 これを基にBUSYO_MSTを更新する、という手もあります。 バナナ　５→０ りんご　１→０ みかん　３→０ と全部０でクリアしておいて りんご　２ みかん　１ の情報から バナナ　５→０ りんご　１→０→２ みかん　３→０→１ です。 いずれにしても、そのエラーメッセージの説明内容をよく見てからです。 「BUSYO_MST」が カウントするための基になっているテーブルであり、 カウント更新するための更新先のテーブルです。 普通に考えるとそれでうまく行くの？、となりますよね？。
(1)テーブルＡに(s,t,u)のインデックスを作成してください。 (2)その上で下記のSQLを実行してみてください。 SELECT * FROM テーブルＡ T1 WHERE NOT EXISTS ( SELECT 1 FROM テーブルＡ T2 WHERE T1.S=T2.S AND T1.U=T2.U AND T1.V=T2.V GROUP BY T1.S,T1.U,T1.V HAVING COUNT(*)>1 )
コーレルドローでA4に1字をいっぱいに拡大印刷できました。コーレルドローでは200ポイントまでフォントがあります。200フォントの字をビットマップに変換後、範囲を選択後ドラッグで自由にどこまでも拡大できました。字がわかればメールで送りましょうか。
No4です。 No4の続きとして。 フィールド名は質問の通りの抜き出し番号になっていませんが、 リンクしたCSVをT1、追加先テーブルをT2として、以下のようなクエリ で追加。 INSERT INTO T2 ( 番号, 名称, 受付日, 種別, 登録番号 ) SELECT CLng([フィールド1]) AS F1, T1.フィールド2, DateValue([フィールド3]) AS F3, T1.フィールド4, CLng([フィールド5]) AS F5 FROM T1; あるいは、 >前の方の複数のフィールドでNull値があった場合 この意味が分かりづらいのですが、もしかしたら、 インポートしようとしているフィールドにNullデータ が存在する、という意味ならば、 INSERT INTO T2 ( 番号, 名称, 受付日, 種別, 登録番号 ) SELECT IIf(IsNull([フィールド1]),Null,CLng([フィールド1])) AS F1, IIf(IsNull([フィールド2]),Null,[フィールド2]) AS F2, IIf(IsNull([フィールド3]),Null,DateValue([フィールド3])) AS F3, IIf(IsNull([フィールド4]),Null,[フィールド4]) AS F4, CLng(Nz([フィールド5])) AS F5 FROM T1; これで対応できるものかな、というところですかね。
１．PCのバックアップから復元する ２．キャリアの電話帳お預かりサービスから復元する ３．しこしこ入力する です
こちらがズバリですね。 http://www.nurs.or.jp/~ppoy/access/access/acF010 …
バーコードが13桁以外もあれば13桁に合わせる必要があるか、も検討です。 13桁以外があれば単純抜き取りでは崩れます。 ちなみに、ＪＡＮコードは８桁もあります。 データとして保持したいなら、 左から５桁、 右から８桁、 はLEFT関数やRIGHT関数で編集すれば取り出せます。
ルックアップとかが出てきている時点で間違っている気がします。 > すべてのレコードから得られた値を集めた「カテゴリ一覧」を設け これは値一覧の定義で「フィールドの値を使用」でフィールド「カテゴリ」を指定すると出来ます。 ・「書誌情報2::カテゴリ一覧」と「書誌情報::カテゴリ」をリレーション ・「カテゴリ一覧」フィールド（グローバル：テキスト）をラジオボタンで 上記値一覧にしてレイアウト上に配置（書誌情報2からレコードを表示） ・ポータルで書誌情報のフィールドを表示
＞テーブル一覧から該当するテーブルを選択し、デザイン又は右クリックでデザインビューで開く。 この操作すら検討がつかないということ？。 ｍｄｂをクリックしたとき、システムの画面が自動で立ちあがってくるから、 こういう画面に到達できない、というのはありえます。 「起動時マクロを実行させない、ＳＨＩＦＴキーを押しながら」というので回避。 何らかの処理をしたときにこういうことをしたい。 それも一時的にとなるか、恒久的か。 「フィールドに追加したい」、 だけではいろんな場面があります。 自己解決してなかったら補足すること。
＞実は、ジャンルのテーブルを「ジャンル１」「ジャンル２」と二つ用意する ＞方法は一度ためして、それ以外の方法がないかと悩んでいました。 ＞ ＞今、DATA1の中に「カテゴリ１」から「カテゴリ５」まであり、 ＞これでは同じ内容のテーブルが５個になってしまうので、 ちょっと勘違いされているようです。 私の回答は、「別名を付けているだけ」であり、ジャンルのテーブル自体は「１つのまま」です。 ジャンルテーブルを２つ（５つ）作る必要はありません。 大事な事なので2回書きますｗ 私の書き方で必要なテーブルは 「ＤＡＴＡ１とジャンルの２テーブル」だけです。 「ＤＡＴＡ１とジャンル１とジャンル２の３テーブル」ではありません。 つまり「同じテーブルを別のテーブルとして扱っている」だけです。 そうではなく、単純に 「LEFT JOINを何度も書くのは煩雑なので単純にできないか」 と言う事でしたら、「できません」。 そもそも、ジャンル１～ジャンル<ｎ>、と言う風に、横に繰り返し列を持つのは正規化上、好ましくないんです。 （まあ、５つくらいが限度でしょう） これが何10とあるなら、ＤＡＴＡ１とカテゴリのリレーションを持つ中間テーブルを作るべきでしょうね。 データの正規化については、ご自分で調べてくださいね。
え～と・・・ 何処からお話したら良いものやら (^^ゞ 下準備 >商品ＩＤを「ア000」「イ000」など、頭文字+番号としたいと考えているのですが と考えているテーブル名を『T在庫管理』とします。 これを元に帳票フォームを作成して名前を、F在庫管理 とします。 その、F在庫管理 フォームをデザインビューで開いて （商品ＩＤ → 商品ID にしてます） 商品ID のフィールドのプロパティのイベントタブの更新後処理に （▼・・・ の三点リーダみたいな方をクリック） そうすると Private Sub 商品ID_afterUpdate() End Sub てのが現れますので 前述のように Private Sub 商品ID_afterUpdate() 　　Me!商品ID = nextID("商品ID", "T在庫管理", Me!商品ID) End Sub といれておきます。 次に 挿入→標準モジュール と進んで、そこに Function nextID(fld As String, tbl As String, str As String) As String 　　Dim t1 As Variant 　　'変数に色々なタイプを入れるのでVariant型にしてます 　　t1 = DMax(fld, tbl, fld & " like '" & str & "*'") 　　't1 に 頭文字で始まる最大値を格納 　　t1 = Mid(t1, 2) + 1 　　't1 から数値部分（回答例だと３桁）にプラス１ 　　nextID = str & Format(Nz(t1, 1), "000") 　　't1 が Null だった場合を考えて（最初の○001を求めるためにNZ関数使用） End Function と記述。' で始まる行は解説用のコメントです。 で、エラーが無いかコンパイル。 無ければフォームの商品IDコントロールで例えば ぶ だけ入力してEnterで確定すると（更新後処理イベントが発生）、 順次 ぶ001、ぶ002・・・と増えてゆきます。 提示された連番部分が３桁（例、ぶ001 ～ ぶ999）なので、Format(Nz(t1, 1), "000") としておりますが、ここは５年くらいのスパンで考えて質問者さんで判断してください。 Format(Nz(t1, 1), "000")→Format(Nz(t1, 1), "0000") ４桁確保 オートナンバー的なものを用意する場合に一般的なのは、Dmax 関数を使うのですが 今回の場合は、『頭文字+「オートナンバー」みたい』とのことですので、 ちょっと工夫が必要です。 『「防水ゴムキャップ」などは、「ボ」ではなく、「ゴ」の部類にしたい』という 希望もありますし、また既に稼動しているのでこのような回答になったしだいです。 なんのこっちゃ？さっぱりわからん？なら、下記などでもお勉強してください。 魔法使いの開発工房 http://www.mahoutsukaino.com/ ※WEB上で有志の方が色々と解説されていますが、 それだけでは虫食い状態の知識に留まりがちです。 RDBはAccessに限らず裾野（基本的な知識）が無いと必ず行き詰まります。 本も数冊読んで裾野を広げてくださいまし。
補足すると、ACCESSの仕様で使用できる項目数は1テーブルで255までです。 http://office.microsoft.com/ja-jp/access-help/HP … 多分、レコード数と混同されているのではないかと思います。 で、どうしてもテーブル形式からフォームを起動したいというなら、「データシート」形式のフォームというのがあります。 リボンの「作成」→「その他のフォーム」→「フォームウィザード」→で参照したいテーブルを選択して、全項目を「選択したフィールド」に移します。 「次へ」ボタンをクリックすると、フォーム形式を聞かれるので、「データシート」を選択して、一旦完了してください。 テーブルを開いたのと同様に見えるはずです。 そうしたら、リボンの「表示」から「デザインビュー」を選択してください。 そうすると、1レコードの画面になると思います。 ここで、ユニークになるキー項目にマウスを合わせます（マウスカーソルが十字になります）。その状態で、マウスの右クリックから「プロパティ」を選択し、表示されるプロパティシートの「イベント」にある「ダブルクリック時」の右の欄の右はじの方にある下向き三角をクリックして、表示される「イベントプロシージャ」を選択してください。 その後、下向き三角の右にある「...」のようなボタンをクリックするとイベントプロシージャの編集画面になります。 後は、 DoCmd.OpenForm "開きたいフォーム名" でフォームが開けます。 この設定はフォームをデータシートモードで開いた時も有効です。 ただ、ダブルクリックしたレコードのキー項目の値に応じたレコードをフォームに表示しなければいけないので、そこは連結フォームなど一工夫いると思います。
BIツールは星の数ほど存在しています。 老舗のBIベンダー（SAP,Oracle,IBM）の他に、OpenSource系、日本国内発、等色々と存在します。 ツール単体を比較しても、Core BI系、開発言語系、BusinessAnalytics寄りのもの、ETLライクなものと細かな機能差、価格差を問えば非常に沢山の選択肢があります。ですので、私からは、対象PRJの最終ゴール、または運用能力によってツール選定のジャンルを絞り込む事をお薦めします。 選択肢としては、まずA.クラウド型か、B.ライセンス型の選択肢をお考えになり、次にライセンシングの選択肢 １．クライアント台数（指名ユーザー）で課金、２．BIサーバーのCPUで課金、３．同時ユーザーで課金、４．レンタル型を決めて、残るプロダクト群から、機能要件等、お好みのツールを選ばれる事をお薦めします。 また、選定の際には、完全Freeライセンスの物の場合を除き、Presales支援をしてくれる人物の評価を優先して下さい。識別の仕方は、BI要件の選別や優先順位づけが上手な人物かどうか。あまり居ないと思いますが、もしそういう人を抱えるベンダーと会う事が出来たのであれば、多少高くともそのベンダーの製品を採用することを強くお薦めします。実は、最終的に実装する（事になる）機能は、どのツールを選んでも、大して変わりません。その意味で、BIソフトウエア選定に時間をかけるのはあまり得策ではなく、コンプライアンス上、相見積もりをとっておけば、あとは「人」で決めることをお薦めします。 余計なお世話ですが、もしご要望であればニュートラルなスタンスで、最終に残ったBIベンダー名を教えていただければ、私のわかる範囲で追加情報をお教えします。私はBIの普及を心から願っているBIファンの一人です。『BI/EPMコンサルタントのブログ』でKeywordsearchしていただければ、私のブログにGoogle reachしていただけると思います。 　　　　　　・・・※"BIコンサルタントのBlog"ではないので気をつけて下さい。 参考URL：http://shinochika9861.blog22.fc2.com/
> どこをどう修正すれば元通りになりますか？ 実はちょっとした勘違い、だったりしないでしょうか(汗) 現在「#」が表示されているExcelの列の幅を試しに 広げてみてください。 「###」だったものが「TRUE」や「FALSE」と表示される ようになる・・・んじゃないかと思います(汗) なお、Excelの列幅の初期設定を変えたい場合は・・・ テンプレートファイルを作成するのが簡単、でしょうか。 (私の場合、Excelの方がAccessより不慣れなもので・・・(汗)) http://office.microsoft.com/ja-jp/excel-help/HP0 … http://office.microsoft.com/ja-jp/excel-help/HA0 … もしも上記でも変化がないようでしたら、そのセルを 選択した時に、数式バーにどんな値が表示されるかを 念のためお知らせ下さい。 (「#」になるとして、それが1個かそれとももっと多いか、等)
できますよ。 (1) サブレポート1およびサブレポート2にレポートの フッター/ヘッダーを表示します。 (2) サブレポート1のレポートフッターにテキストボックス をおき、その名前を「受注金額合計」とし、コントロール ソースを =Sum(Nz([受注残金額])) とします。なお、[受注残金額]はサブレポートの詳細で 「納品予定月別受注残高」を表示しているテキストボックスの 名前です。実際に合わせて変更してください。 次にプロパティの「可視」を「いいえ」にします。 (3) (2)と同様に、サブレポート2のレポートフッターにテキストボックス をおき、その名前を「売上済金額合計」とし、コントロール ソースを、 =Sum(Nz([売上済金額])) とします。なお、(2)と同様に[売上済金額合計]はサブレポートの 詳細で「売上済金額」を表示しているテキストボックスの名前です。 実際に合わせて変更してください。 次にプロパティの「可視」を「いいえ」にします。 (4) メインレポートにも、レポートのフッター/ヘッダーを表示します。 メインレポートのレポートフッターにテキストボックスを置き、 その名前を、合計とします。メインレポートのコード表を開き、 以下を貼り付け保存します。 Private Sub レポートフッター_Format(Cancel As Integer, FormatCount As Integer) Me!合計 = Reports!メインレポート!サブレポート２!売上金額合計 + Reports!メインレポート!サブレポート１!受注残高合計 End Sub 字数制限のためコードが途中で改行されています。 以上で、メインレポートの下に「受注残高」+「売上金額」 が表示されます。 なお、各コントロールソースにNzを加えているのは もしデータが無くてもエラーが生じないように するためです。 何かわからないことがあれば補足してください。
SQL的には 会社idと都道府県idを紐づけるテーブルを用意するのが汎用性が高い持ち方です。 ただし他の方が指摘もありましたが一覧を作るのが面倒になりますが それもピボットテーブル的な処理でかのうです。
> サブフォームでのリンク親フィールドをどの様に設定すれば > 良いのかがわかりません。 サブフォームの『リンク親フィールド/リンク子フィールド』は 完全一致でないと使用できません。 ですので、今回のように「範囲指定」がご希望の場合は、 そこは空白にした上で、サブフォームに使用するレコード ソースとして、『メインフォームのコンボボックス群を抽出 条件に指定した選択クエリ』を使用します。 (「Between Forms!メイン!コンボ1 and Forms!メイン!コンボ2」 　の式は、そのクエリのデザインビューで、日付の抽出条件 　として使用することになります) さらに『リンク親フィールド/リンク子フィールド』を指定した 場合と違い、この形だとコンボボックス群の値を変更しただけ ではサブフォームに反映されないため、注意が必要です。 これについては、各コンボボックスの『更新後処理』イベントで、 サブフォームの「再クエリ(Requery)」を行うマクロ又はVBAを 実行することで対応します。 (マクロなら、『アクション』に『再クエリ』を指定し、左下に表示 　される『コントロール名』欄にサブフォーム名を指定。 VBAなら、「[サブフォーム名].Requery」を実行) ※ここでの「サブフォーム名」は、サブフォームの表示に使用して 　いる『ソースオブジェクト』の名前ではなく、「サブフォーム 　コントロール」としての名前ですので、併せてご注意下さい。
端末によってはという条件であればあてはまらないかもしれませんが、MDBが破損している可能性はありませんか？ 当方もこれでハマった事があります。 またAccess2007のランタイム形式でXPではMDB形式で正常に動きますが、VistaやWin7ではMDE形式で導入しないとエラーになるという現象に遭遇した覚えがあります。
DB2は全然触ったことがないのですが、同じような質問があったようです。 http://oshiete.goo.ne.jp/qa/1196541.html ここにあるのが最新バージョンのマニュアルではないかと思いますので、見てみてください。 https://www-304.ibm.com/support/docview.wss?rs=7 …
追伸 Me.Recalc '←この一行を入れます 忘れてました。
アプリケーションには様々な形態があります。 Webアプリケーションの場合 (1)クライアントが要求をサーバに送る。 (2)サーバはクライアントに応答を返す。 ここで、サーバがＤＢを操作する必要があり、 しかも同じマシンでない場合はＤＢサーバへ 接続して操作します。 つまり、クライアント→サーバ→ＤＢサーバ という感覚です。 クライアント／サーバの場合 クライアントは必要な資源をサーバから取得 します。情報はサーバから供給されますが、 実行するのはクライアント側プロセスです。 例えばＡｃｃｅｓｓでＤＢサーバ上のテーブルを 参照するなどがその例で、以下の感じです。 クライアント→ＤＢサーバ いずれにしても、DBを扱う場合はDBサーバに アクセスする訳です。 >何層だろうとサーバOSが、指定されているIPとDBを自動で判断し 違います。自動で判断できるOSやコンテナは ありません。必ず相手先アドレス、サービス名、 ユーザID、パスワードなどを記録しています。 例え、WebサーバとDBサーバが同一マシン だとしても指定が必要です。 >SQLSeverの設定でクライアントの許可をすればいいんだよ 「クライアントの許可」って何でしょう？ 先程も言いましたけど、「？？？→DBサーバ」の 左側は接続可能であれば何でも良いのです。 実際の業務ではプログラム中に定数で接続先を 定義することは絶対にありません。 何故なら、環境が変わって、DBサーバのアドレスや サービス名が変わることを想定しなければならない からです。特に開発中のテストDBと本番のDBは 構成は同じでもIPアドレスは違います。 テストの完了したプログラムは１文字（例えコメント) でも修正できません。 Visual Studio では確かConfigファイルに接続文用の 文字列が記録されてた記憶があります。 プログラムではここの内容を読み出して接続している はずで、これならConfigを変更するだけで、接続先を 変えられます。
Firefox >なぜそこまで、Firefoxに？
#1です。リンク先の下のほうにCommandについて 説明と使い方が簡単にありますが、#2さんの方法でも、あるいは テキストボックスのコントロールソースに =Command() とすればコマンドラインの値がテキストボックスに 入ります。 たとえば、以下はVBSの場合ですが、 Option Explicit CreateObject("WScript.Shell").Exec """C:\Program Files\Microsoft Office\Office12 \MSAccess.Exe""" & _ """C:Users\admin\Desktop\text.accdb""/x """ & "m1" & """ /cmd """ & 1 & """" これはマクロm1(フォームを開くマクロ)を実行し、 数値の1を引き渡します。引き渡された1は フォームを開くと自動的にテキストボックスに 表示されます。cmd、x　の順番のほうが早いかも しれません。
もしかしたら、Internet Explorer が足を引っ張っているのかも？ IE7ではセキュリティタブ。イントラネットのネットワークを自動的に検出するのチェックをはずす http://windows.microsoft.com/ja-JP/windows-vista … FQDN または IP アドレスを使用すると、 イントラネット サイトがインターネット サイトとして識別される http://support.microsoft.com/default.aspx?scid=k … ネットワーク共有上のファイルを開いたとき、開くのに時間がかかる、 読み取り専用で開く、あるいはエラー メッセージが表示される http://support.microsoft.com/default.aspx?scid=k … など。 後は、アンチ マルウェアが邪魔をしているとか・・
最近Delphi触っていないので、間違ってたらごめんなさい。 トランザクションの排他レベル（トランザクションの分離レベル）の設定が不適切だと思われます。 > 実行中の他のプログラムで入力済みのデータが見えません。 他のプログラムでコミットする前に、そのデータを見たいなら、 →DirtyRead (しかし、InterBaseではDirtyReadは指定できないっぽい？) 他のプログラムでコミットしたデータを見たいなら、 →ReadCommitted 読み込み側が、暗黙のトランザクションで、RepeatableReadになっていませんか？ > 二つのPCで入力していくとTest_Noが二重に登録されます。 MAX(Test_No)が3だとします。 1. プロセスAでMAX(Test_No)読み込み(A:3) 2. プロセスBでMAX(Test_No)読み込み(B:3) 3. プロセスAで+1を書き込み(A+1:4) 4. プロセスBで+1を書き込み(B+1:4) 5. プロセスAでコミット 6. プロセスBでコミット 2と3が入れ替わっても、トランザクションの排他レベルがDirtyReadでもなければ、 Test_No=4で登録されたレコードは見えないので一緒 SEQUENCEを使った方が良いのではないでしょうか？
都道府県、区分ですべて なのか 件数が１つでもあればその都道府県、区分はすべて なのか 件数のない千葉とかまで必要かどうか じゃなくて質問からすると後者では？、件数の発生しないものまで表示はよくある話です。 区分が３まであっても考え方が理解できたら対応可能かと思います。
＞最後に処理された時点 項目に「更新日時の１４ケタ」を用意する。 これを基準にクエリで並び替えすることで「最後に処理された時点」のレコードかどうかは 特定できます。 初期値はすでに過ぎてしまった「20100101000000」にでもしておく。 入金があった日でもって売掛残が確定する、というのであれば、 最終入金確定日が基準かもしれません。 ＞過去の履歴を見るのには非常に便利 ２４日の売掛残１５００円、 ５００円変動があって、２５日の売掛残は１０００円 と算出されているとして、 ２４日時点はどうだったか（＝１５００円？）というそんな見方があるのかどうか。 既存の仕組みでは、売掛残は求まっていますか、表示のときに計算されるものですか。 ＞顧客別の売掛残を抽出するクエリー 並びの基準になる項目があれば、 直近から数件表示にするだけ、かも。 「降順」「先頭１０レコードのみ」とするだけで見たいものが出てくる？。 「降順のクエリ」、日付が変わったときは「再クエリ」で表示を行うことは 使えるのでは？。
当該Excelファイルの保存場所とファイル名が常に同じなら、 Excelファイル自体をリンクテーブルとしてはいかがでしょうか。 そうしてしまえば、後はそのリンクテーブルから「ID」と「NAME」 フィールドのみを指定した追加クエリを作成することで、 それ以外のフィールドを一切無視して、データを取り込むことが できると思います。 【Excelからのリンクテーブルの作成方法】 <Access2003以前> 1)データベース ウィンドウ(テーブルなどの一覧が表示される 　画面)を右クリック 2)「テーブルのリンク」を選択して、『リンク』ダイアログを開く 3)同ダイアログ下方にある『ファイルの種類(T)』のコンボボックス 　で、「Microsoft Excel」を選択 4)当該ファイルを指定したら、『リンク(K)』ボタンをクリック <Access2007以降> 1)『外部データ』リボンを選択 2)『インポート』グループ(?)内にある『Excel』ボタンをクリック 3)『外部データの取り込み - Excelワークシート』ダイアログが 　開くので、『ファイル名(F)』に当該ファイルを指定 　(アドレスを貼り付けるか、『参照(R)』ボタンで指定) 4)その下にあるオプションボタンから、『リンク テーブルを作成して 　ソース データにリンクする(L)』を選択 以上の操作を行うと、ウィザードが起動しますので、必要な 設定を指定すれば、Excelファイルへのリンクテーブルが作成 できます。 このリンクテーブルは(他社特許の関係で)参照専用となって いますが(古いバージョンだと編集可のままかもしれません)、 それ以外は通常のテーブルと同様に扱えますので、これを 元に追加クエリまたはテーブル作成クエリを作れば、実質的に 「Excelからのインポート」と同様のことが行えます。 ※Excelファイルの保存先やファイル名が一定でない場合も、 　VBAでFileDialogオブジェクトやTransferDatabaseメソッド等を 　使用して当該ファイルへのリンクを行うコードを作成すれば、 　一応対応は可能かと思います。
> SQL文で書くと、 > select 顧客番号,etc…　from 顧客データベース > full join 電話データベース on > 顧客データベース.顧客番号 = 電話データベース.顧客番号 > WHERE 電話1=検索番号　OR 電話番号2 = 検索番号… > といった感じでしょうか。 顧客マスタと電話番号テーブルと分割した場合（正規化）と、顧客マスターに電話番号を入れた場合と、ゴッチャにしてますね。 正規化した場合は、 電話番号テーブルは、1レコード1電話番号になりますので、 SELECT 顧客マスタ.* FROM 顧客マスタ LEFT JOIN 電話番号テーブル ON 顧客マスタ.顧客番号 = 電話番号テーブル.顧客番号 WHERE 電話番号 = [検索番号] です。 顧客マスターに電話番号を入れた場合は、 SELECT 顧客マスタ.* FROM 顧客マスタ WHERE 電話1 = [検索番号] OR 電話2 = [検索番号] OR 電話3 = [検索番号] ということです。
＞請求書を発行するにあたって必要なテーブル 請求書には、 ・発行日 ・作番 ・内訳 ・金額 ・請求先 が必要
＞どのようなテーブルが必要になってくるのか教えてください。 ＞具体的に○○表（○○○、○○○、○○○、○○○）という形でお願いします。 仕組みで必要となるだろう要素やキーワード（○○○、○○○、○○○、○○○）を とにかく洗い出してみてください。 その中で同じ分類のものは１つのテーブルに分けていきます。 契約している顧客→だれが、だれにどんな、契約名、いつから・・・ 出張作業→だれがどこにいつ、どんな要件で・・・・ 各テーブルにまとまってきたらリレーションも考えます。 会社：その所属社員＝１：ｎ とか。 「どのようなテーブルが必要になってくるか」 の前にまずどんな項目が存在するのか、になってきます。
以下に同様の質問の回答があります。 http://oshiete1.watch.impress.co.jp/qa4405868.html
RDBMSは、何ですか？
用語が一定で表記されていないので読解にとまどいます。 (顧客情報=サブフォーム=子フォーム？、顧客番号=顧客CD？) 2/2の表示が出て、「顧客情報入力フォーム」がすべて ブランクになるということは、「顧客情報入力フォーム」の レコードソースの新規レコードに移動したということです。 試しに入力してテーブルにどのように反映されるか確認 してみてはどうですか。入力しなければ何も反映されません。 (入力してもフォームの鉛筆マークが出ていれば一旦 レコードを前にもどしてレコードの保存を確定してください。) どうしてもフィルターをかけたレコードのみを表示し、 新規レコードに移動可能にしたくないのであれば、 「顧客情報入力フォーム」のプロパティで 移動ボタンを「いいえ」にしてください。 補足の、 ＞但し、子フォームの訪問情報には顧客コードと過去に入力した ＞履歴情報が親フォームで指定した顧客番号とは関係なく ＞表示されています。 は子フォーム(サブフォームのこと？)のレコードソースの 設定がうまくいっていないのでは、と思いますが。 レコードソースのSQL文をよく確認してみてください。 抽出条件など。
テーブルのインポートはそれほど頻繁に行う作業では無いと思えますが ボタンで実行させなくてはいけない程頻度が高いのですか テーブルのリンクでは駄目なんでしょうかね？ リンクも含めてインポートに関しては Ctrl + G を押したらイミディエイトウィンドウが 開くのでそこに TransferDatabase と入力してから、F1 キーを押して 現れるヘルプをごらん下さい。
The CARD ですか・・懐かしいですね。 MSDOSからWindows95に切り替わる辺りにチラッと試したことがあります。 はるかな昔の話で恐縮です。 お持ちのバージョンがどのようなものかは分かりませんが カード型データベースの延長型なら ファイルメーカーはどうでしょうか？ たしか出自はカード型データベースだったような気がします。 ↓評価版ダウンロード http://www.filemaker.co.jp/support/downloads/ Googleってみて、もう1個 TCARDは、出来るだけ簡単な操作を目指した汎用カード型のデータベースソフト http://www.dicre.com/soft/tcard.htm こちらも試用版があります。 ※残念ながら、私メはどちらも試したことは有りません。 長いものに巻かれて、Microsoft Access です。
Access2003のこの手のトラブルは下記がよくあるのですが。 http://support.microsoft.com/kb/867666/ja 全角文字のユーザ名でログインしたりしていませんか。 もしそうならば、以下の要領で設定を変えてみてうまくいくか確認 してみてください。 http://support.microsoft.com/default.aspx?scid=k …
・社員データ（社員番号、氏名、……） ・顧客データ（顧客ID、顧客名、……） ・履歴データ（日付、作業内容、……） ・単価データ（作業内容、単価、……） ・予定データ（作業予定日、作業場所、……）
日別売上クエリ をRecorsetとして開きたいのですよね。 なら、CreateQuery しなくても、そのまま開けばいいですね。 Dim qd As QueryDef Dim rs As DAO.Recordset Dim dDate As Date dDate = #2010/12/05# Set qd = CurrentDb.QueryDefs("Q_受講者数") qd.Parameters("pDate") = dDate Set rs = qd.OpenRecordset > つまり、それから呼ばれるクエリ内のパラメータにも、自動的に値が与えられるのでしょうか？ パラメータ名が同じなら、クエリ内のすべてのパラメータに自動的に値が与えられます。
抽出条件欄に Is Not Null と書いてください。
ワイルドカード検索だからです。 この場合はインデックスによる検索は機能しないので、 １件ずつの条件抽出になります。 気になった点を挙げます。 (1) エンコード If Nz(Me.txtカナ氏名, "") <> "" Then 　　　　If Len(zyuFilter) > 0 Then 　　　　　　　　zyuFilter = zyuFilter & " AND ((検索テーブル.カナ氏名) LIKE '*" & Me.txtカナ氏名 & "*')" 　　　　Else 　　　　　　　　zyuFilter = zyuFilter & " ((検索テーブル.カナ氏名) LIKE '*" & Me.txtカナ氏名& "*')" 　　　　End If End If ↓ If Nz(Me.txtカナ氏名, "") <> "" Then 　　　　If Len(zyuFilter) > 0 Then　zyuFilter = zyuFilter & " AND " 　　　　zyuFilter = zyuFilter & "カナ氏名 LIKE '*" 　　　　zyuFilter = zyuFilter & Replace(Me.txtカナ氏名, "'", "''") & "*'" End If このようにすべきでしょう。 同じコーディングを続ける（コピペがあるのでやりがち）のはバグの元です。 また、入力データに'(アポストロフィ)が含まれるとSQL構文エラーになるので、 念のためエンコードします。 また、テーブルが１個しかないので修飾はなくても問題ありません。 (2)直接実行 DoCmd.OpenQuery "作業テーブル_削除" DoCmd.RunSQL zyuSQL ↓ CurrentDb.Execute "DELETE FROM 作業テーブル" CurrentDb.Execute zyuSQL この方法だとSetWarningは不要です。 (3)DCount この系統の関数は避けるべきです。 もし、DBが他のものに代わり、ODBCリンクテーブルになった場合、 物凄く時間がかかります。Dfirstなども同じです。面倒でも SQLからレコードセットを作って値を得るようにする必要があります。 また、レコード件数ならMe.SUB.Form.Dynaset.RecordCountで 求められますので、関数やクエリは不要です。 (4)作業テーブル キーやインデックスが多いのとか？ また、作業テーブルを使う必然性は何でしょう？サブフォームの RecordSourceのSQLを直接書き直せば済むと思いますが・・・
> rs2.Open strSQL2, cn2, adOpenKeyset, adLockReadOnly, adCmdTableDirect strSQL2 の内容は テーブル名ではありませんから adCmdTableDirect はまずいのでは？ adCmdText で試してみては如何ですか？
大学と大学種類の変更後処理で共通メソッドを 呼び出すようにし、いずれかが変更されたら 区分を自動的に更新するようにします。 因みに、大学と大学種類の結合文字列でマスタを 検索するだけなので、リレーションとかの問題では ありません。単に条件式の書き方の問題です。 共通関数ではDDFirstなどを使えばよいでしょう。 全部書くと以下のようになります。 Private Sub 大学_AfterUpdate() 判定 End Sub Private Sub 大学種類_AfterUpdate() 判定 End Sub Private Sub 判定() Dim 結果 If Nz(大学, "") = "" Then Exit Sub If Nz(大学種類, "") = "" Then Exit Sub 結果 = DFirst("国公私立区分", "大学名マスター", _ 　　　　　　　　　　　"大学名='" & 大学 & 大学種類 & "'") If Not IsNull(結果) Then 国公立私立区分 = 結果 End Sub
質問番号：6351264で補足を要求した者ですが、提示された画像はさっぱり読めません(^^; と、これだけでもなんですので、ヒントになればと思うことなどを列挙し補足なり、追加質問を待ちます １．レポートは基本的に、（集計機能などを別にすれば）クエリで抽出できるデータしか表示できません。 ２．上記から、具体的にどのようなデータを抽出したいのでしょうか？ ３．レポートに表示されるのは、「列」と「行」です。これを具体的に書けばどのようになりますか？ ４．前記１．に関連し、レポートで列の集計は簡単にできますが、行の集計は面倒です。この点はどうでしょうか？
質問内容がほとんど理解できません(^^; 通常の報告書（？）的なものをイメージすると 営業マン一人毎に 列名： ブランド名、目標数、目標金額、実績数、実績金額 の５列 ブランド毎に１行で合計１３行 上記から、５列×１３行　で一人の報告書になるかと思うのですが、違うのでしょうか？ 出したい数字、文字の羅列をエクセルなどで表現し、その画像を質問に添付できないですか。
> 顧客一覧の顧客コードの部分をダッブルクリックするとその顧客の > 詳細情報入力フォームへ移動ｓる様に設定したいのですが、 顧客コード テキストボックスのダブルクリック時のイベントプロシージャに、 DoCmd.OpenForm "詳細情報入力フォーム", , , "顧客コード=" & Me.顧客コード と1行記述。これが、いちばん標準的な方法だと思います。 上記は、顧客コードが数値型の場合です。テキスト型の場合は、 DoCmd.OpenForm "詳細情報入力フォーム", , , "顧客コード='" & Me.顧客コード & "'"
フォームにある Public Sub SetFilter(rpt As Report) With rpt .Filter = "[受験番号]=" & Forms!F_社員情報!受験番号 .FilterOn = True End With End Sub を標準モジュールに設定してください。フォームのほうは 削除してください。これで一度確かめてみてください。
画像になった状態の文書を「文字として認識する」ソフトがあります。 OCR と呼ばれます。 ↓ http://ja.wikipedia.org/wiki/%E5%85%89%E5%AD%A6% … 有名どころでは 「Adobe Acrobat」※フリーのAcrobat Readerではありません 「e.Typist」 「読んde!!ココ」 「クセロReader ZERO 」※フリーだけど配布終了 ですが、OCRの認識・変換率は必ずしも完全ではありません。 （高機能の有料製品であってもです） OCRを通した後の文章は、必ず「人間が目検証で」確認し、誤認識した部分を修正する必要があります。 また、OCRソフトごとのスキャン時の癖を掴む必要もあります。 （段組の文章は苦手なので、こまめに選択スキャンする、など） その意味では、#1さんの「人が見て文章をテキストに転記する」と言う怪答(？)も、間違いとは言えません。
>ACOSのTQFTOOLみたいなのありませんか？ このサイトの利用者が全員ACOSのことを知っているわけではないですけど。 何ができるのかを説明しないと回答のしようがないです。
> 教えて頂いたコードを書いて試してみましたら「該当するデータはありません。」 > とメッセージが出てしまいます。 コードは正常に動作していると言うことですね。 txt検索に、実際に存在する管理番号を入力していますか。 ちゃんと入力しているのに「該当するデータはありません」と出るのなら、 "管理番号 Like '*" & Me!txt検索 & "*'" の部分が間違っていることになります。 管理番号というフィールド名に間違いはないですか。 データ型はテキスト型で間違いないですか。 上記部分を、下記のように書き直した場合どうなるか試してもらえますか。 "管理番号 = '123456'" 123456 は実際に存在する管理番号で。
旧バージョンとの比較表があります（PDF) ttp://www.filemaker.co.jp/downloads/pdf/filemaker_versions.pdf 「ランニングコスト」の意味が不明ですが、導入コストは「ボリュームライセンス」を参考 ttp://www.filemaker.co.jp/purchase/store/licensing.html 4が手元に無いのでうろ覚えですが、オブジェクトの参照データのみの挿入、地図の表示（Webブラウザで）は出来ていたように思います。 操作性はファイル作り方次第でバージョンや機能には関係ありません。 有ると便利な機能も作成者の腕次第ですが、 テーブル構造、Webビューア、スクリプトトリガは非常に便利なツールです。 心配なのは4が今後のOSで動くのか、というところです。 PCを買い替えた場合に動かなくなる可能性があります。 まあ、それから11を買ってもファイル変換はすぐにできますが。 参考URL：http://www.filemaker.co.jp/downloads/pdf/filemak …
バーコードリーダーについて調べてみました。 バーコードリーダー入門 http://barcodereader.web.fc2.com/09_01.html インターフェイスには キーボード送信 と RS-232C規格通信 の2種類あるようです。 「改行コードを送ることでフォーカス移動」ということは、キーボード送信 だと思われます。 もしそうなら、回答No.5 で提案した定型書式と自動タブでフォーカス移動するはずです。 もし、それで、だめなら、変更時イベントでTextで長さを調べてSendKeysで改行を送信したらどうでしょうか。 Private Sub テキスト1_Change() 　　If Len(Me.テキスト1.Text) >= 8 Then 　　　　SendKeys "{ENTER}" 　　End If End Sub 参考URL：http://barcodereader.web.fc2.com/09_01.html
field追加(alter table)じゃなくて、「行追加時に、uniqueカラムのデータがかち合ったら追加しない」でいいですか？ 「制約競合解決アルゴリズム」を　ON CONFLICT で指定します conflict-algorithm ::=ROLLBACK | ABORT | FAIL | IGNORE | REPLACE insert文では、ON CONFLICTの代わりに or で記述できます INSERT OR IGNORE INTO table-name (column-list) VALUES(value-list) 参考 http://www.3rd-impact.net/Document/SQLite/Transl …
SQLでは、OR条件とAND条件ではAND条件が優先されます。 条件1 OR 条件2 AND 条件3 AND 条件4 AND 条件5 という記述だと「条件1に合う　または　条件2,3,4,5に合う」 という意味になってしまいます。 （条件1に合ってさえいれば、条件3,4,5に合っていなくてもよい） これを「条件1または条件2に合う　かつ　条件3,4,5に合う」 とする場合は (条件1 OR 条件2) AND 条件3 AND 条件4 AND 条件5 と記述します。 これで「条件1,3,4,5に合う　または　条件2,3,4,5に合う」 データを抽出することができます。 質問文の例でいうと >受注表.作業員１ =　作業員表.氏名 or 受注表.作業員２ = 作業員表.氏名 の部分を()でくくればいいのではないかと思います。
No1回答したものです。 参考サイトurlを間違えました済みません、SQLite構文解説はこっちです。 http://www.sqlite.org/lang_datefunc.html
状況が良く飲み込めませんが １ If Me!全データ = True Then の 全データ のコントロールがフレーム51の中にあるのなら If Me.フレーム51.Value = 13 Then になるのでは？ ２ フォームを開いた時に今年のデータを表示して「txt_仕入月」を表示しない。 フォームのOpen時イベントにてレコードソースの設定と、 txt_仕入月はデザインビューで予め不可視に設定しておくとかでは駄目？
フォームヘッダーかフッターにコマンドボタン(btnPreview)を配置して、 コマンドボタンのクリック時のイベントプロシージャに Private Sub btnPreview_Click() Dim strFilter As String strFilter = Me.RecordSource strFilter = Mid(strFilter, InStr(strFilter, " WHERE ") + 7) DoCmd.OpenReport "レポート名", acViewPreview, , stFilter End Sub でどうですか。 あと、抽出ボタンで RecordSource を書きかえてますが、 Filterプロパティを設定する方がシンプルになります。 コード例 Private Sub btnSearch_Click() Dim strWhere As String Dim strAndOr As String strWhere = vbNullString If Me.optAndOr.Value = cAnd Then strAndOr = " AND " Else strAndOr = " OR " End If If Me.txtYear.Value <> vbNullString Then strWhere = strWhere & strAndOr & " 年度 LIKE '*" & Me.txtYear.Value & "*'" End If If Me.txtName.Value <> vbNullString Then strWhere = strWhere & strAndOr & " 営業担当 LIKE '*" & Me.txtName.Value & "*'" End If 'WHERE句編集 strWhere = Replace(strWhere, strAndOr, "", , 1) 'レコードソース書き換えと再クエリ Me.Filter = strWhere Me.FilterOn = True End Sub Private Sub btnPreview_Click() DoCmd.OpenReport "レポート名", acViewPreview, , Me.Filter End Sub
ウィザードでは多分無視されるというか、 もともと、データアクセスページには 「サブフォーム」という概念が無いのではないでしょうか？ （データアクセスページはWebページのため） データ アクセス ページへのページの埋め込み http://msdn.microsoft.com/ja-jp/library/aa139975(office.10).aspx
＞日常的に入力作業をする事務職員のスキルがないため、Excelで作成したいと思います。 Accessの方が入力用のフォームに各項目を入力だけです。 また、多くの部分をウィザードで構築できるので楽です。 Excelだと入力する場所がズレたり、表の計算式や参照が狂うと崩れるので、使う人にスキルというか注意が必要になりますね。 それに、Excelでそういう事をしようとすると複雑な式やＶＢＡなどマクロプログラムが必要になってきて、かえって難しくなると思いますよ。
手元にアクセスがないので、うろ覚えのまま書きますが、挿入先のテーブル名だけじゃなくて、フィールド名も指定しなきゃいけないんじゃなかったかな？ ためしに、ここ↓に書いてあるみたいにやってみてください。 http://www.techscore.com/tech/sql/04_01.html
つまり、実際のセルの値は「YYYY+"/"+MM+"/"+DD」ということですね。 "/"はファイル名としては使用できないのでエラーになります。 YYYYMMDD.xlsというファイルでよければ、 　Range("k2").Value の部分を 　Replace(Range("k2").Value, "/", "") に変更してください。
Null値をそう表示しているだけとか。
>フォームに作成日の検索に加えたいですが 別の話になるので、新しくスレッドを立ててください。 考え方をまとめてからコーディングしましょう。 (1)Date1とDate2があればこの範囲 (2)Date1だけならDate1以降 (3)Date2だけならDate2以前 (4)Date1、Date2がなければ条件にしない If Nz(Date1, "") <> "" Then 　　　　If Nz(Date2, "") <> "" Then 　　　　　　　　strWhere = strWhere & strAndOr & " 作成日 Between #" _ 　　　　　　　　& Date1 & "# And #" & Date2 & "#" 　　　　Else 　　　　　　　　strWhere = strWhere & strAndOr & " 作成日 >= #" & Date1 & "#" 　　　　End If Else 　　　　If Nz(Date2, "") <> "" Then 　　　　　　　　strWhere = strWhere & strAndOr & " 作成日 <= #" & Date2 & "#" 　　　　End If End If 上のDate1やDate2は正しくはMe.Date1.Valueですが、Valueはデフォルトプロパティ であること、Date1やDate2がクラス内オブジェクトとして認識できることから省略も 可能なのです。 尚、作成日に時刻表記がある場合、作成日<=#2010/11/20#とやると、これは 0時0分0秒になるので、2010/11/20 00:00:01以降、つまりこの日にできたものは 対象外になります。また、時刻は微妙に一致しないことがあるので、Format関数を 使い、合わせるほうが正確です。 strWhere = strWhere & strAndOr _ & "Format(作成日,'yyyy/mm/dd')<='" & Date2 & "'"
このあたりを参考に 参考URL：http://www.eurus.dti.ne.jp/~yoneyama/Excel/jituy …
専門書を買った方が早いです。 他の分野でも、そういうことはサイトでは調べきれないことは多々ありますよ。
#1、#2です。 cboConditionに元々はLIKE、BETWEENというキーワードが入っていたが、 それを「類似」と「の間」に変更した、ということでしょうか。 本来はキーワードのBETWEENをstrConditionに渡すということであったならば >Case dbDate >If fBetween Then >strCriteria = strCriteria & strCondition _ >& " #" & Format(varValue1, "yyyy/mm/dd") & "# AND #" _ >& Format(varValue2, "yyyy/mm/dd") & "#" において、 >strCriteria = strCriteria & strCondition _ のところを、 strCriteria = strCriteria & " Between"_ でいいのでは、と思います。"" の中のBetweenの 前は半角空けておきます。 これで、#1で述べましたようにMsgBoxでstrCriteria の中身が、 作成日 Between #2010/10/01#　AND　#2010/10/30# となっていればいいのではと思います。 また、他の >Case dbInteger, dbLong, dbCurrency, dbDouble, dbSingl の場合も同様だと思いますが。
=IF(ISNA(VLOOKUP(C11,$J$10:K41,2,0)),"投入",VLOOKUP(C11,$J$10:K41,2,0)) ですかね。 vlookupを2回書かなくても済む方法もあるのかもしれません・・
こちらをどうぞ FileDialog プロパティ http://office.microsoft.com/ja-jp/access-help/HA … サンプルコードはヘルプの中にもあるかと思います。
Ｎｏ．３の方が書いておられるように、テーブルに配列が使えればいいですね。 しかし、これはＤＢエンジンがユーザーに配列のように見せているだけで、 内部は最大フィールドが用意されていて、使わないところにはｎｕｌｌが入って いるように思います。 さて、以前の解答で（１）または（３）の方法が良いと書きました。 フラグが立つ確率が２０％以上ならば間違いなく（１）でしょう。 確率が１０％以下ならば（３）もコンパクトで速いと思います。 さて、集計ですが、（１）も（３）も同じ事です。 （１）では単純に集計できますし、（３）もＩＤでグループ化すれば 簡単に集計はできます。
ヘルプを読み返してみましたが、 レコードセットと言うよりは１レコードでの制限のように思えます。 テーブルの制約と読み合わせた、私の想像です。 TMPファイルのサイズが1.7Gとの事ですので、 MDBファイルの2Gの壁が近づいてますよ？
>サーバOS：WinXP(SP3) は単なるファイルサーバなので >このような状態で、サーバにはAccess（Officeすべて）をインストールしていなくても >データの管理は可能ですか トラブルが発生したらローカルPCにコピーすれば何とかなると話かと。 Windows XP Professional は同時接続数？が１０までと限られていたハズ？ なので、ここが引っかかるかな？ それよりも重要なのはAccessは共有で運用されると、とても貧弱です。 もともと、共有なんて視野に入れて開発されたわけでは無いので 『おまけ』程度です。開発にはかなり神経を使います。 取りあえず、バックアップはこまめに。 Acc2007だと自動？なのかな？？ データベース自動バックアップ関数 (FSO)←Acc97の頃なので要移植？？ http://www.moug.net/tech/acvba/0070012.htm
訂正です。 #1において、 >If IsLoaded("F_研修受付入力") Then を If CurrentProject.AllForms("フォーム1").IsLoaded Then となっていますが、 If CurrentProject.AllForms("F_研修受付入力").IsLoaded Then としてください。フォーム名が違っていました。
どのRDBMSをお使いかわかりませんが、以下の記述で大抵は行けると思います。 一応、2,3のRDBMSで試しました。 （エイリアスの記述はRDBMSによって癖があるので注意） select T1.* from テーブル１ as T1 where exists (select 'X' from テーブル１ as T2 where T2.Ａ = T1.Ａ and T2.Ｂ = '１' and T2.Ｂ in ('１', '２') and T2.Ｂ <> T1.Ｂ and T2.Ｃ = T1.Ｃ ) ご質問の要件のような「同じテーブル内でレコードをまたいだ条件がある」場合には、「自己結合」と言って、同じ「テーブル１」が2回登場するようなSQLになります。 今回の場合は、値の取得は1テーブルでよく、「条件に合致するものがあるか存在する事を確認したい」だけなので、EXISTS を使用します。 この様に、主たるテーブル（この場合はT1）と副問合せ側のテーブル（T2）を紐付ける事を「相関副問合せ」と言います。 [存在する事を確認する条件] (1)「Ａ」＝１ (2)「Ｂ」＝１or２ (3)「Ｂ」＝１の取得データと「Ｂ」＝２の取得データで「Ｃ」が共通していること 上記を相関副問合せに当てはめて言い換えるとこうなります。 ↓ 「(1)(2)の条件を共通して満たすレコードで「自分以外（この場合はＢが異なるもの）」で更にＣは等しい」
> マルチユーザーとは、何人もアクセスを > いじる状態、ということでしょうか。 はい、そうです。 > とすれば、管理者、教務、経理の3人しか > いじることはないと思うのですが、 > それでもマルチユーザーとなりますか？ はい。 ２人以上が、つまり、２人か３人が １つのAccessのファイルに同時にアクセスして お仕事しないといけないような状況であればマルチユーザとなります。 でも３人のうち、「常にだれか一人にしか使わせない」仕様にして作れば マルチユーザーにはなりません。 マルチユーザ → 同時複数台数アクセス、という感じです。 マルチユーザ対応ということで作る場合はそれなりに工夫が必要と なってきます。 どんなことが必要になるかは、また別の質問をたててみてください。 Accessのマルチユーザー利用で注意しないといけないのは ファイルが壊れることが稀にある、ということです。 VistaとWin7では検証してませんけど、OSがXPや２０００だと マルチユーザー対応させるとファイルが壊れることがちょくちょくあります。 クライアントが２０台くらいになると、規模や仕組みにもよりますが いったん壊れ始めると止まらないような形で壊れたりすることもあります。 データ量が少ないときは顕在化しにくいですが、数万件とか増えてくると 症状が出始めたりします。（あくまでもパソコン台数が多い場合です。） ただ、クライアントが３人（３台）だけなら、まず破損は生じないと 思いますので、あまり心配いらないとは思います。 多分、バックアップだけこまめに、確実にやっておけばいいと思います。 Access（MDB系のファイル）ではバックアップは必須で、バックアップを怠って、 ファイル破損でデータをすべて失う人がたまに居ますので、 （掲示板でもちょくちょく見かけます）ご注意ください。 最適化、という機能を是非お早いうちに学習してください。 「Access ファイル 破損 」でWeb検索すると色々と情報が出てきます。 が、怖がる必要はありませんので、「ふーん、こんなことがあるんだ。」と まずは覚えておいて、データのバックアップだけ必ずこまめにとってください。 破損自体は掲示板でちょくちょく見かけるとはいえ、確率は低いですから。 （でも実際にあるので注意は必要なのです。多分一回くらいはご経験されると思います。） ※回答の文章が長くて、また、わかりにくくてすみませんでした。
もうひとつ質問を立ち上げられていますね。 そちらで続きを行いたいと思います。（こっちは閉じてね） なお、あちらでも述べましたが、OS と Access のバージョンを明記のこと。 さて、どうしたら一番使いやすいかなと思案中。
キリが無いので回答はこれまでにしますが、 コンパイルが通るのか？ 参照設定にDAO3.6が設定されているか？ を確認してください。 PS. Me![見積番号].DefaultValue = rs![見積番号] + 1 は Me![見積番号] = rs![見積番号] + 1 で十分でしょう。
#1、#2、#3　です。 説明が足りないような気がするので少し捕捉 しておきます。 Drop Tableを実行した場合、対象となるテーブルが 無い場合、SQLの中でテーブルが無い場合に対応は できません。したがって、Drop Tableを実行する 場合に、テーブルが無いときにエラー表示が されないようにするにはプログラムからDrop Tableを 実行するようにしてテーブルが無ければ実行しない、 あれば実行するというプログラムを組む必要が あるために、#2のようなプログラムを提示しました。 簡単、というわけにはいかないのですが、どちらか というと、このような場合の常套手段のような方法です。 以上です。
No.1　です。 補足いたします。 英語サイトになりますが、殆どのケースは多言語対応しています。 この為、開発元の英語サイトに拒絶しないで下さい。(*^_^*) そして、デザインは自由に変更できます。
No.1です。 > a:ショートカットからでなく、accessの開くからでないと開けない 憶測になりますが、前回回答の「c」で提示した、「/excl」を指定した ショートカットになっているのかもしれません。 (コマンドラインオプションでの指定は、Accessのオプションの設定よりも 優先されます。また、Access2007でも有効なことは、今確認しました) 当該ショートカットの右クリックで表示されるメニューから「プロパティ(R)」 を選択して『プロパティ』ダイアログを開いたら、『ショートカット』タブの 『リンク先(T)』にファイルアドレスが記述されていると思いますので、 その末尾の方に「 /excl」(大文字の場合もあり)が入っているようでしたら、 その部分(半角スペースも含めて全6文字)を削除して、『OK』ボタンで プロパティを保存後、起動してみて下さい。 ※こちらのOSはWindowsXPなので、この辺りも細部はそちらと違う可能性が 　 あります(汗) > b:データを保存しているPCから先に、accessを開かないといけない 前回回答したオプションの設定は、その設定を行ったPC端末に対して のみ、有効になります。 (その端末に保存されたファイルであっても、他の端末から開いた場合は、 　開いた側の端末の設定が使用されます) もしも、データを保存しているPCに対してのみオプションの設定を行って いた場合は、もう一方の端末でも同様の設定を行えば、起動順序に 依らずに共有可能になると思います。 (既にそうされていたらすみません(汗)) 思い当たるところとしては、以上です。 これで解決に至るとよいのですが・・・(汗)
「移動入力」とどんなふうにするんですか？ 結構難しいことをやろうとされているように思いますが説明が簡単すぎてよく理解できません。 もう少し説明をお願いします。 参考URL：https://docs.google.com/document/d/1aPqmwjULN30J …
テキストボックスに値があるかどうか、判定できます。 フォームの元になっているテーブルの該当項目の判定をクエリで行う か フォームの起動のときのFormloadイベントで行う。 ただし、 これを装備して行うのはそこそこ自分で作れるようになってからです。 使い方間違うとカーソルが意図したとこに止まらないで 無限に陥ってしまうからです。 無限に陥ってしまって、止め方がわからない、デバッグできない、 それでタスクで強制終了させる、そういうようならなおさらまだ早い。 できる状況でしょうか。 それから、 入力途中で終わっているか否かは必要な機能なのか？、です。 １レコードすべて入力する、を１工程とする仕組みが普通と思います。 項目も途中で終わらせないといけないほどの量でしょうか・・・。 こういうチェックは おおむねモノができあがってから装備かと思いますしどうでしょう？。 他の質問を見る限りではまだまだ覚えてもらいたいことあります。 がんばりましょう。
#4で追加したT番号の番号フィールドの初期化の コードの中で、 If Not IsNull(varInput) Then としているところを If StrPtr(varInput) <> 0 Then に置き換えてください。InputBoxを表示したとき キャンセルを選択するとエラーが出てしまうので 上記のようにします。
事情が良くつかめていませんが 地区→■ 地番→□ とすると ■□■□■□ ■□■□ ■□■□■□ ・・・・・・ のようになっているのでしょうか？ 多分、『地区』コントロールは詳細行に配置されているのかな？と推測されますが 最初のご質問で >地区フィールドはプロパティーで重複データ非表示にしています とのことですので ■□　□　□ 　□　□ ■□　□　□ のように最初だけ表示されるはずなんですけどねぇ？？？Access2002で検証。 PS. ___________________________ |　　|50　　|112　　|112-2| |羽島|20　　|211　　|213　| |　　|40　　|515　　|313　| 添付された画像のように『羽島』を上下の中央に配置するには VBAで行わねばなりませんが、 残念ながら当方では解決できません。
＞「Q仕入管理」にて作成した管理番号をまだ「ID・管理番号・商品名・商 ＞品説明…」等が未入力の「商品説明テーブル」の「管理番号」フィー ＞ルドにコピーすると云う事です。 ＞先に「商品説明テーブル」に「管理番号」を登録しておいて後から「商品 ＞名・商品説明」等を入力します。 ということは、まだ何も入力されていない 「商品説明テーブル」に先に「管理番号」 だけをコピーしておく、ということで いいのでしょうか。それですと、適当な オートナンバーのフィールドを作成 しておいて追加クエリ、 INSERT INTO 商品説明テーブル ( 管理番号 ) SELECT Q仕入管理.管理番号 FROM Q仕入管理; です。オートナンバーは主キーである 必要はありませんが、クエリの実行上 必要になります。特に必要がなければ デザインビューで削除してもかまいません。 何かあれば補足してください。
回答というよりはご意見ですが。 ＞レポートの結果を社員ごとにPDFファイルにして添付ファイルとし、メールの宛先は社員の所属上司にし、CCで社員メールアドレスに送る。 「レポートの結果を社員ごとにPDFファイルに」 と 「PDFファイルを添付ファイルとし、メールする」 は 分けて考えても良いと思います。 「PDFファイルを添付ファイルとし、メールする」 は自動化できれば、最悪ＡＣＣＥＳＳでなくても良いのでは？。 「レポートの結果を社員ごとに」 これはクエリの条件を考える。 社員ごとに抽出すること、と全員分繰り返すこと２点を切り分けて考える。 「PDFファイルをメール」 これはACCESSを使ってメールする、を考える。 ネット検索するかテクニック集の本を参考にする。 「社員ごとにPDF作ってメール」 の最終目的での回答を待っていては、なかなか少ないように思います。 あとは、 健康診断結果であれば、個人情報扱いでは？。 本人以外は結果が見えない方が良いと思います。
条件に合うときに、フィールドのフォントの色を背景色と同じ色になるように設定。 やり方は回答No.1の参考URLのヘルプに記載されています。 厳密に言うと質問の"表示しない方法"ではなく、見えなくする方法です。 なお、ソフトウェアに関する質問をする場合、そのバージョンやOSを明記しましょう。
#1です。 記号としての#、つまり半角の#は制御文字なので#1のような使い方を します。 もし、 Like "#*" のように、#を全角で記入すると＃で始まる レコードが表示されます。
＃６、＃８です。多少時間が取れたので、簡単なサンプルを １．「基本製品マスタテーブル」を一覧するフォーム「特別製品仕様書マスタ追加フォーム」を作成します。 ２．テキストボックスとして少なくとも一つ「id」を貼り付けます ３．追加クエリ「特別製品仕様書マスタ追加クエリ」を作成し、ＳＱＬ文は INSERT INTO 特別製品仕様書マスタ SELECT 基本製品マスタテーブル.* FROM 基本製品マスタテーブル WHERE (((基本製品マスタテーブル.id)=[Forms]![特別製品仕様書マスタ追加フォーム]![id])); とします ４．フッタを表示しボタンを一つ貼り付けます ５．ウィザードなどをし良し、ボタンのイベントを Dim stDocName As String stDocName = "特別製品仕様書マスタ追加クエリ" DoCmd.OpenQuery stDocName, acNormal, acEdit とします これでこのフォームを実行し、適当なレコードを選択後にボタンを押せば、そのレコードが「特別製品仕様書マスタ」に追加されるはずです。一応当方ではサンプルを実行し、この追加を確認しています。
訂正です。 Private Sub 詳細_Format(Cancel As Integer, FormatCount As Integer) i = i + 1 If cnt Mod 5 = 0 Then で、 If cnt Mod 5 = 0 Then を If i Mod 5 = 0 Then としてください。2箇所あります。
何をお悩みなのか良く分からないのですが 単純にT_基本データを元とする単票フォームがあるのですから この中に同じくサブフォームを単票で入れ込んで 両方の従業員番号で親子のリンクとすればおしまいと思えるのですが？ ※サブフォームのレコードセレクタは消します。 ついでに親フォームのレコードセットをスナップショットにしておけば 某所から来る基本データを誤って変更するなどが防げます。 ※子フォーム（T_付属データ）は変更OKです。 勘違いならゴメン。
「ポートが解放できない」というのをどうやって確認したのか良く分かりませんが。。。 （サーバのログでも見ましたか？） 単にWebサーバ（IIS？Apache？）が443ポートでListenしてないだけでは？と思います。 Apacheならhttpd.conf、IISなら管理画面で確認してみてください。 参考URL：http://support.microsoft.com/kb/323972/ja
ど素人の私が答えるのもなんですが、 テーブルAとテーブルBのインサート時にテーブルXに同じデータを登録しておくというのはいかがでしょうか？
間違えてしまいましたすみません。 正しくは、 新しいフィールドを３つ作ります ID1：フィールドタイプ数字 ID2：フィールドタイプ計算　ID1+1 ID3：フィールドタイプ数字 ID1=ID2で自己リレーション　"ファイルB" ID3=ID3で自己リレーション　"ファイルC" スクリプト ID1フィールド　フィールドの内容の全置換　シリアル番号　増分１ ID3フィールド　フィールドの内容の全置換　 　　　　　　　If ( ファイルA::甲 = ファイルB::甲 ; ファイルB::ID3 ; ファイルA::ID1 ) 乙フィールド　フィールドの内容の全置換　Count ( ファイルC::ID )
テーブルを作る。 テーブルのデータをすべて削除する削除クエリを作る。 テーブルごとに作ったテーブルにデータを入れる追加クエリを作る。 マクロなどでそのクエリを順番に実行させる。 マクロを実行させる。
自分で既存のCMSで構築すれば。 ただしCMSを使うにしてもノウハウは必要だけどな。
私自身はレポートを使うことが殆どないのですが・・・(汗) > これは、縮小して収めてくれるという意味ではないのですか？ Excelと違い、残念ながらAccessには縮小印刷の機能がありません。 ですので、ご質問のオプションの機能は、「文字のサイズは変えない前提」 で、フィールド内の余白の調整で1ページ内に収めようとするだけですから、 フィールドに記録された文字幅がそれなりにある場合は、2ページ以上に またがってしまうことになります。 従って、ウィザードで作成したレポートで横幅が収まりきらない場合は、 各フィールドの列幅を手動調整するか、当該フィールドの文字サイズを 縮小するマクロ(→Excelのセルの書式設定の「縮小して全体を表示」の ような形)を組んだりすることになるかと思います。 (以前、質問者の方が下記の質問でその種のコードを提示されています： 　http://oshiete.goo.ne.jp/qa/6115432.html　) なお、Access2007から、列幅の調整は『レイアウト ビュー』でも可能に なったので、それほど手間は掛からないかと思います。 また、列幅に収まらないデータを改行してもよいなら、当該テキストボックス 列幅をある程度小さくした上で、プロパティシートの『書式』タブの『印刷時 拡張』の設定を「はい」にするといった方法もありますので、参考まで。 (同じくExcelでの「折り返して全体を表示する」と同じような機能になります)
http://groups.google.az/group/microsoft.public.j … 行き詰まったのでGoogle。 上記ではレスがつかなくてOSの再インストールまでしたそうです。 （クリックしても飛ばないかもしれませんのでその際はアドレスをコピペ） どうも似たような症状。 初心に立ち返って、思いつくままに。 ・メニューのヘルプから『アプリケーションの自動修復』 ・新規データベースでも発生するか ・ADOのバージョンが古いので、2.5まで上げてみる。Microsoft ActiveX Data Object 2.5 Library 2.1のチェックは外して、プルダウンメニューの中央辺りに2.5があります。 最新は多分、2.8以降になっているかと思います。 ・メニューから（VBEでは無い方）『ツール』→『オプション』→『全般タブ』 新規データベースの並び順が、日本語 UniCode であれば、日本語に変更。 これで新たに作ってみて試す。 これで駄目なら私は降参です。 ※Microsoft DAO 3.6 Objects Libraryのチェックは戻して置いてください。
Private Sub 複数_Click() と Private Sub 次へ_Click() の機能をまとめてあります。 商品数の数によってコマンドボタンを押す都度 管理番号1と2は増加、 他は前レコードの値が入ります。 手抜きのため、サンプルコードは仕入場所_ID だけですが よ～く動作検証＆読んで見てください。 Private Sub コマンド_Click() 　　Dim Data1 As Date 　　Dim oldBKNo1 As Long 　　Dim newBKNo1 As Long 　　Dim oldBKNo2 As Long 　　Dim newBKNo2 As Long 　　Dim shohinSuu As Long 　　Dim basyoID As String 　　 　　If Me.Dirty Then 　　　　If MsgBox("編集中です。保存しますか", vbYesNo) = vbNo Then 　　　　　　Exit Sub 　　　　End If 　　　　DoCmd.RunCommand acCmdSaveRecord 　　End If 　　 　　DoCmd.GoToRecord Record:=acLast 　　'最終行の各値を変数に保存。 　　Data1 = IIf(IsNull(Me!仕入日), Date, Me!仕入日) 　　oldBKNo1 = CLng(Nz(Me!管理番号1, 0)) 　　oldBKNo2 = CLng(Nz(Me!管理番号2, 0)) 　　shohinSuu = Nz(Me!商品数, 0) 　　basyoID = Nz(Me!仕入場所_ID, "") 　　 　　If Me!商品数 <= DCount("管理番号1", "T仕入管理", "管理番号1='" & Format(oldBKNo1, "000") & "'") Then 　　　　newBKNo1 = oldBKNo1 + 1 + Abs(oldBKNo1 Mod 9 = 0) + (oldBKNo1 = 0) 　　'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~↑の9は本番では999に変えてください 　　　　newBKNo2 = 1 　　　　shohinSuu = 0 　　　　basyoID = "" 　　Else 　　　　newBKNo1 = oldBKNo1 　　　　newBKNo2 = oldBKNo2 + 1 　　End If 　　 　　'新規レコードに移動 　　DoCmd.GoToRecord Record:=acNewRec 　　'Me.Recordset.AddNew 　　'変数の値を加工して代入 　　Me!仕入日 = Data1 　　Me!管理番号1 = Format(Right(CStr(newBKNo1), 3), "000") 　　Me!管理番号2 = Format(newBKNo2, "00") 　　Me!商品数 = shohinSuu 　　Me!仕入場所_ID = basyoID 　　Me!ID.SetFocus End Sub あと、いまさらなのですが・・・気になっていまして・・ 今後のことですが、ここも読んでみれば良いかと データベースの正規化の基礎 http://support.microsoft.com/kb/283878/
すみません。 リンクがあるのを失念してました。 リンク先に「サポートＢＢＳ」があるのでそこで解決策を、がよいです。 できることとしては 最初から、権限設定とか何か手順が抜けているかどうか見直し、してみて下さい。
> (2)ルックアップ列の表示を解除したい 1)Accessの画面左端に表示される『ナビゲーション ウィンドウ』で、 　当該テーブルの右クリックメニュー内の「デザイン ビュー(D)」を 　クリックするなどして、デザインビューを開く 2)ルックアップ列を設定したフィールドを選択 3)左下方(ナビゲーション ウィンドウよりは右)に表示される領域で 　『ルックアップ』タブを選択 4)一番上に『表示コントロール』の設定項目があるので、そこの 　値を「テキストボックス」に設定 　(→それより下の項目は全て非表示化(テーブル保存後は削除)) 5)テーブルを保存して閉じる ・・・以上で、当該フィールドはテキストボックスでの表示になり、 同フィールドに保存された数値が表示されるようになります。 > リレーションシップを削除しても、ルックアップ列が表示されるのは > なぜですか？ 記録した数値に対応したテキストを表示させるだけなら、実は上記の 『ルックアップ』タブに表示される各項目の幾つかを設定するだけで 可能で、リレーションシップの設定自体は必須ではありません。 ただ、適切なリレーションシップを設定することで、 　・未登録の項目を勝手に入力されるのを防いだり(=参照整合性) 　・無用化したレコード(ルックアップで表示される選択項目)が発生 　　した場合に、それを削除するだけで、関連する全てのレコードを 　　一括で削除したり(=連鎖削除) といったことが可能になるため、同ウィザードではそれらの設定を同時に 行うように設計された、ということだと思います。
#7です。一応確認のため同じデータを、 Excelでデータ作成→CSVに変換→メモ帳で確認 クエリをCSVにエクスポート→メモ帳で確認 クエリをExcelに出力→CSVに変換→メモ帳で確認 で確認しています。メモ帳で確認すると以下のような 形式になります。 "すずき　はなこ↑鈴木　花子" "たなか　たろう↑田中　太郎"
標準では、そのような機能はありません。 どうしても、ということなら こちらが参考になるかもしれません。 http://hatenachips.blog34.fc2.com/blog-entry-176 …
Excelの仕様は、１シート65536行、256列、列幅255文字、セル内容は32767文字までとなっています。 2003まではこの制限があります。2003以降でしたらヘルプで見てください。 貼り付けるデータ内容が大きくExcelのシートの制限を越えてしまう内容なのかが分かりませんが、複数シートを使用しているファイルであれば使っているPCのメモリに依存しますので貼り付けできず破損し保存できなくなってしまう場合もありますが質問内容からでは不明です。 破損したExcelファイルはもう開かないはずです。 更新する前の状態でExcelは開くということなので、貼り付けるデータ内容によってだと思います。 貼り付けるデータがいつも更新しているデータ容量と違うとか何か違いはないのでしょうか。 どのようなデータか分かりませんが貼り付けるデータを分割して貼り付けるとか試してみるしかないと思います。
DB2はここ10年くらい触っていないので、ご質問のような機能も初耳でしたが、面白い機能なのでちょっと調べてみました。 ＞上記、マニュアルの通り、PL/SQLステートメント実行のためには、DB2サーバで何かしらの設定が必要なのでしょうか。 以下の設定が必要なようですが、設定されているでしょうか？ Oracle アプリケーションを使用可能にするための DB2 のセットアップ http://publib.boulder.ibm.com/infocenter/db2luw/ … DB2_COMPATIBILITY_VECTOR レジストリー変数 http://publib.boulder.ibm.com/infocenter/db2luw/ … 上記、設定されているのであれば、申し訳ありませんが、今のところ自分にわかるのもここまでです。
次のレコード で想像するのは 最新の値と前回値 の様なデータですが、SQLでやる場合は一意なIDがあるテーブルであれば 以下の様なやり方で表示出来ると思います。 逆の考え方であれば、MAX → MIN に置き換えれば良いと思います。 select * from テーブル as A where A.ID = ( select MAX(B.ID) from テーブル as B where B.ID != ( select MAX(C.ID) from テーブル as C ) ) 日時でと言う事であれば (日時が一意である事が前提ですが) IDで記述している部分を日時のフィールドに変更する事で取得可能かと思います。
どうにもなりません。　 そんな判断を鵜呑みにするような会社にいてはいけません。 すぐに転職先を探しましょう。 もしくは、 そんな判断をする社員を雇っておいてはいけません。 すぐに、首にしましょう。 どちらも無理なら、 被害が拡大する前に、専門家にご相談ください。 オラクルに戻すのが一番安上がりだと思いますが、 フリーのｄｂを使うのも、ありかもしれません。
デザインで設定を元にデータシートビューを（毎度）作ってます。 クエリデザインビューで設定を定義する、 その実行結果を見るのが（クエリの）データシートビュー、 そういう使い方です。 テーブルのデザインビュー、データシートビューも同じ感覚と みていいでしょう。 デザイン上でも変更できて、データシートビュー上でも変更できたら 何が正しい状態かわからなくなってしまいます。 クエリデザインビューで設定したらデータシートビューで確認、 追加修正あったらクエリデザインビューで修正しまたデータシートビューで確認、 この繰り返しです。 必要に応じて保存。
「データベースの各用語」ということですが、 ベンダーや製品により違いがありますので 漠然と検索すると余計に混乱すると思います。 Oracle、SQLServer、DB2、その他いろいろありますので、 お気を付けください。
ホームページを見ると、履歴として画像とかも残っていきます。 一定期間で自動的に消えるけど消したいなら、 ディスククリーンアップが安全でいいかと。 スタート、プログラム、アクセサリ、システムツールの中にあります。 フォルダの場所は以下。　（ユーザー名）の処は人によって違います。 C:\Documents and Settings\（ユーザー名）\Local Settings\Temporary Internet Files 詰まるところ、PCを軽くしたいならレジストリクリーナーとかオススメ。 http://www.altech-ads.com/product/10001211.htm
VisualStudio2005については不明ですが Access2002上では下記のSQLで求められました。あんまりぱっとしないけど。。 SELECT schedule_T.sid, schedule_T.stime, (select time from time_t where time_id=schedule_T.stime) AS stimeA, schedule_T.etime, (select time from time_t where time_id=schedule_T.etime) AS etimeA FROM schedule_T WHERE schedule_T.sid=1
最後の End ステートメント で グローバル変数がクリアされます。 VBA では、End ステートメント の出番はほぼありません。 On Error GoTo エラー ～ ～上記回答のコード ～ 出口: 　Exit Function エラー: 　MsgBox "ネット接続を確認して下さい。" & Chr(13) & _ 　"エラーナンバー：" & Err.Number & Chr(13) & _ 　"エラー内容：" & Err.Description, vbOKOnly 　Resume 出口 End Function こんな感じのコードで、エラーもクリアされます。
No.8です。 > ○select * from テーブル名 where A2='BB' and not exists (select A1 from テーブル名 where A2<>'BB') 違います。not exists で書くならこうです。 select * from テーブル名 t1 where t1.A2='BB' and not exists (select * from テーブル名 t2 where t1.A1 = t2.A1 and t2.A2<>'BB') >なぜか（方言のせい？） なので、使用しているDB名やバージョンは明記してください。 こちらには何もわかりません。
本当にいろいろな方法があります。 一番簡単なのは、 あらかじめ「追加クエリ」を作成しておき 　Docmd.OpenQuery "追加クエリ名" あるいは DAO で 　Set dbs = CurrentDB 　dbs.Excute "追加クエリ名" 追加クエリを使用しない場合は 追加クエリの SQL文 に相当するSQL を 実行。 　strSQL="INSERT INTO 商品登録データ SELECT 一時商品登録データ.* FROM 一時商品登録データ" 　Docmd.RunSQL strSQL あるいは DAO で 　Set dbs = CurrentDB 　dbs.Excute strSQL とか。 直書き、間違いがあったら御免。
「すべて」を選択したらありませんか。
(2)バッチ処理 については、#6で示したコードと、 以下で完成すると思います。 (1) 追加クエリを作成。以下のSQL文を新規クエリの SQLビューに貼り付け保存。テーブル1から テーブル2に追加します。フォームのレコードソース をテーブル1とします。クエリ名はQ追加としています。 INSERT INTO TdataB SELECT * FROM TdataA; (2) フォームにコマンドボタンを設置。そのクリックイベントで 以下のように設定します。 Private Sub コマンド0_Click() Dim rs As Recordset Set rs = Me.RecordsetClone If rs.RecordCount = 20 Then If MsgBox("データを登録します。よろしいですか？", vbYesNo) = vbYes Then DoCmd.OpenQuery ("Q追加") End If Else MsgBox ("レコードが20件登録されていません") End If End Sub あとは、#4について補足があれば(1)についても完成しますが。
エンティティとリレーションシップ というページ、付録１に説明が少しありました。 多－多は誤った構成を招くようです。 参考に。
NO1さんの検索結果のサイトには妥当な説明がなされており、それはそれでいいんですが、 ＞意義を教えていただけますか SQLや、RDBMSなどを習う最初は、みなさんそのように思います。７年位前からは特に。 ヒントは、話せは長い長い歴史の忘却のかなた在ります。 今のようにGUIが普通で、SQLなんかサブセットのように思っている、DB構築者が多いですが、その昔業務関係のDBはCUIが中心。その中で、DB管理者や、業務用ソフトのDB担当では、いかにスピーディーに末端のDBクライアントアプリ作成者や、DB管理者に検索を用意に渡されるかが問題になっていました。 これにはクライアントツールの開発環境が、あまりにも長くなるSQLを管理しないといけなくなり、特に業務用では検索速度などが、大事です。いかにDB側、OS側、CPU側にキャッシュさせスピードをあげるかが問題になります（１５年以上前は、業務マシン、ワークステーションとっても今のパソコンの１０分の１以下のスピード）。 そこで、Viewはとても効果があります。長かったSQLも半分になります。検索結果をいちいち変数にいれてとか、一回、ファイルに保存してとか、プロセス間通信でスレッドに渡してとか、そんな事を考えなくても、１クッション省くことができ、プログラミングが、よりシンプルに作れます。 それがNo1さんが「検索代行」（個人的には言葉は妥当ではないと思うが）といっている部分です。 例をあげれば、４つ以上のテーブルから、各店舗の日別売りあげと、個人売り上げをマージしてランキングでソートして一つのViewになっていたとしたら、どうでしょう。クライアントツールを作るSEは、そのViewに対してSELECT文を１行つくればいいだけですよね。 これはクライアントツール（DBから見て）のアプリ側が、より規模の大きいものになれば、それだけ効果が増します。何せすでに、すでにできている検索文を使うだけで、プログラムを作れるのだから。いわばオブジェクト指向のプログラミングで言えばClass定義などカプセルかをしたのと同じ効果があり、うまく作れば、効率化絶大です。 また、セキュリティー面でも活用できますね。特定のユーザーにViewの使用だけを認めれば、特定の検索しか、できないことになります。 まあ、今はGUIで、ちょちょいのちょいとクエリーが作れるので、どうなのか？　といわれると。うん～～～～と黙ってしまいますが（１５年以上前は、なかったんですよ）。業務用で一部あり、高かった（１００万円以上）。もちろんアクセスやエクセルなんて、あったけ？　と言う時代のこと（Office95からGUIで単純なものができた。業務用レベルではなかった）。
質問からすると 削除方法以前に削除したいレコードの特定もまだできてないようです。 テーブルＡを基準とした選択クエリで、テーブルＢのＦ１と一致するデータのみを表示する。これのクエリ作り方はわかりますか。これの結果が今削除しようとしている対象なので削除前の確認用になります。 削除の仕掛けにするにはこの選択クエリを削除クエリとして変更し名前つけて保存します。 あまりわからず状態で、確認なしでいきなり削除するのは間違いを招きやすい。
ご質問の趣旨とはずれてしまいますが 私の場合はフォームのOpen時イベントで Docmd.Movesizeでサイズ指定しています。 FormのサイズはFormを開いた状態で Forms!フォーム名.width などで取得できます。 今回の場合最大化しても少し欠けるので一部分が見えない とのことですので DoCmd.MoveSize Right:=0, down:=0, Width:=1000, Height:=1000 などとしても フォームのタイトルバー等でその分スペースを喰われるので 多分駄目でしょうけど。 当方Acc2002
もう解決されているかもしれませんが・・・。 直接的な回答ではありませんけれども Excelでインポートしたい範囲を選択してコピー（Ctrl+C) Accessのテーブルにレコードがゼロの場合 レコードセレクタ（横向き三角）をクリックしてペースト（Ctrl+V） 既にレコードが有るテーブルの場合 レコードセレクタのアスタリク（*）をクリックしてペースト（Ctrl+V） で取りあえずはしのげるかも？ >空白セルがあったりするからですか？ については他にもデータ型の違いとか 行が何行にも渡って空白の場合とかでも発生するかも知れません。 未検証です。
既に回答されていますが、 レコードの移動は、フォーカスが移動することによって起きるものと思っています。 （レコードセレクタは例外？） テキストボックスなどにくっついているラベルをクリックすることで、 くっついている元にフォーカスが移動します。 それをトリガとして、レコードの移動が起きます（と思っています） ラベル単独では、クリックしてもフォーカスの移動が起きないので、 レコードの移動もありません。 現状のフォームへの、簡単な修正方法（私が考えれる範囲で）は、 クリックすることによってフォーカス移動が起きるコントロール （コマンドボタン）をラベルの上に配置します。 手順） ・コマンドボタンをラベルの大きさで作ります。 （今回はフォーカスを移動させるだけなので、名前は何でもいいと思います） （イベント等を設定するのなら、わかりやすい名前に変更した方がよいでしょう） ・プロパティで以下３つを変更します。 「標題」→空白に 「透明」→はい 「タブストップ」→いいえ ・このコマンドボタンを、ラベルの上に重ねます。 （コマンドボタンは、あとから作ったので、重ねた時には上側になると思いますが、） （上になっていないようであれば、） （マウス右クリック→位置→最前面へ移動　で上側にしてください） 以上 ※ フォームでの見た目は、ラベルをテキストボックス化したものと同じになると思います。 操作の上で若干異なる点が・・・ コマンドボタンを使った時） 違うレコードの、このコマンドボタンをクリックすると、 フォーカスがフォーム上から無くなったかのように感じます。 （見えてないだけで、透明にしたコマンドボタンにあります） テキストボックスを使った場合） そのレコードのタブ移動順の若いものにフォーカスが移動しました。 余談） この帳票フォームでの、ご質問以外に想定される操作には何がありますか。 レコードセレクタが表示されていて・・・ レコードセレクタを使った、レコードのコピー＆貼り付け操作も想定？？？ もし想定しているのであれば、上記2つ方法での違いは、実際に試してみてください。
SQL92では外部キーの種類として「MATCH型」が規定されていますが、sqlite.org によると、現在、sqliteでは未サポートです。 ＞また、どんな値が入るのでしょうか？ ＞私が確認したところ、いつもNONEしか入っていません。 今後のバージョンで対応した時にPRAGMAのインターフェースを追加したくないので、あらかじめMATCHを含んだ形にしておいて、対応するまでは常に「NONE」を返すようにしているのでしょう。 対応するようになったら、FULL、PARTIAL、などのMATCH型の種類が入ると思います。
こちらをどうぞ。 取得データの行数を指定 http://www.dbonline.jp/sqlite/select/index10.html
余計なお世話かもしれませんが・・・ >フィールドサイズ：15（テキスト型） これが数値型だったら簡単なんですけどね テーブルデザインのフィールドの書式に半角スペースだったら@を１５個 0の場合は0を１５個。 テキスト型の場合は半角スペースの場合のみできましたが 半角スペースの場合は後々トラブルの元になったかすかな記憶が・・・ テキスト型の場合はクエリなら format([フィールド名],string(15,"@")) format([フィールド名],string(15,"0")) とか
リストボックス上で色分けでなくて リストボックスで選んだものを別のテキスト項目にも表示して そこで色分けをする。
こんな感じだと思ってください（実際にはこんなことしてません） Where A ＆ B ＆ C >= 10 ＆ 20 ＆ 30 　イメージがつかめないかな？ Where A * 1000000 + B * 1000 + C >= 10020030 　こんな感じです。 正確に書くと Where A = 10 And B = 20 And C >= 30 Or A = 10 And B > 20 Or A > 10 です。
ＳＱＬで 「重複した行を1つにまとめるには、SELECTの後にDISTINCTを指定」 SELECT DISTINCT * FROM ～ 期待している箇所で適用できるかは、確認してみてください。
項目（テキストボックスとか？）をクリックして選択。 Ctrlキーを押しながら矢印キーで移動。 ではどうでしょうか？
本であればこちらがいいと思います。http://amzn.to/cqmbP1 ほかの方が回答しているように、データベースの文書のフィールドに書き込むということが前提になりますが、別のデータベースの文書のフィールドを利用するには式ではなくLotusScriptを使うのが普通だと思います。考えなければならないのは、 ・データベースAのどの文書のフィールドを参照するのか。いま編集している文書なのか、まったく別の文書なのか ・データベースBのどの文書のフィールドを参照するのか。新しく文書を作成するのか、あるキーを元に文書を探し出すのか ・その場で処理を行うのか、バッチで一括処理をするのか こんなことを考える必要があります。それぞれ処理が違うのでなかなかうまく説明できませんが、今編集している文書の fromdocfield のフィールドの値を otherdb.nsf に新規文書を作って formname という名前のフォームの文書の fromdatefield に値を入れるとするとこんな感じですかね。 一応コンパイルエラーにならないことだけ確認しましたが、うまく動くかどうかは確認してません。ご参考までに。 Dim session As NotesSession Dim fromworkspace As NotesUIWorkspace Dim fromuidoc As NotesUIDocument Dim sdate As String Dim todb As Notesdatabase Dim todoc As NotesDocument Set session = New NotesSession Set fromworkspace = New NotesUIWorkspace Set fromuidoc = fromworkspace.CurrentDocument sdate = fromuidoc.FieldGetText("fromdatefield") Set todb = session.GetDatabase("server/domino","otherdb.nsf") Set todoc = todb.CreateDocument() todoc.form = "formname" Call todoc.FieldSetText("todatefield", sdate) Call todoc.save(True, False)
OS が違うので・・・ CreateObject("Shell.Application").ShellExecute PhotName で出来るかな？ フォトビュワーがスタートからのメニューにあるのなら （ショートカットだとして） それを右クリックしてプロパティをみればリンク先にプログラム名が見えるかも。 またはフォトビューアを立ち上げてからタスクマネージャでそれらしいのを探すとか ※当方WinXP　&　Acc2002なので、ここまで。
Ctrl + P という手もある。 あとはネットやヘルプを駆使して リボンのカスタマイズですかね。
レコード３件毎が決まっているなら レコードを３件分を１レコードにした状態の（横並び）テーブルを作れば レポート作成時にヘッダを出しやすいのではないでしょうか。 ３件ごとにするには連番でもつけるようになると思いますが、 クロス集計クエリ使えば、連番を横軸にすると横並びにはできそうです。 【テーブル】 レコードＡ：１ レコードＢ：２ レコードＣ：３ レコードＤ：１（４の余り） レコードＥ：２（５の余り） 【中間テーブル】 １・・・・、２・・・・、３・・・・ レコードＡ、レコードＢ、レコードＣ レコードＤ、レコードＥ、空エリア 【レポート】 ヘッダ 詳細（レコードＡ、レコードＢ、レコードＣ） ヘッダ 詳細（レコードＤ、レコードＥ、空エリア）
DB2は触ったことないのですが。 改行コードがCR+LFだとしたら、 replace(文字列,CHR(13)||CHR(10),'置換文字列') ではどうですか？
「魔法使いの開発工房」と言うのをインターネットの検索で見つかると思います。ここをおすすめします。広すぎてどこに自分に合うのがあるか、探すのが一苦労ですが。
Me!ではなく、 Format(Forms!メインフォーム名!テキストボックス名, "000000") では？
新規ブックで空白セルをコピーするのに20秒位かかる現象ですよね？ でしたら、Excel終了した状態で「ディスクのクリーンアップ」を試してください。 ダメでしたら、TEMPフォルダの中身を「手動」（笑　で消しましょう。 当方も過去に同じ状態になりましたが、解決しました。
情報学関連だと、英語の論文をサーベイすることが多く、次のサイトを良く使います。 http://www.informatik.uni-trier.de/~ley/db/index … ここでは査読付きの論文誌原稿・国際会議予稿が検索できます。 参考URL：http://www.informatik.uni-trier.de/~ley/db/index …
仮に データシート 　担当者　店名　電話番号　作業列 　　A　　あ電気　-3　　　　　2 　　B　　い電気　-4 　　A　　う電気　-5　　　　　4 　　C　　え電気　-7 ・・・とあって 表示シート 　検索名 　　A 　店名　　　電話番号 ・・・ と準備してあるとして データシートの作業列に =IF(A2=表示シート!$A$2,ROW(),"")　といれて下までコピィしておきます。 検索して表示したい行にのみ　その行番号が表示されます。 作業列が目障りであれば、非表示にしてください。 表示シートの店名の下に =IF(ISERROR(SMALL(データシート!$D:$D,ROW(A1))),"",INDEX(データシート!B:B,SMALL(データシート!$D:$D,ROW(A1)))) といれて右へコピィ、下へコピィします。 式はながいですが 空いているセルに ＝SMALL(データシート!$D:$D,ROW(A1)) 更に空いているセルに INDEX(データシート!B:B,SMALL(データシート!$D:$D,ROW(A1))) と入れて下へコピィしてみると、なんだといった感じで理屈がわかると思います。
まずSQL的な高速な処理は無理です。遅くてもよいならという前提で、 中区を汎用にするため%を両端につけます CONCAT('%',市区町村名カラム、'%') これをもとにINNER JOIN すればよいでしょう SELECT 住所カラム,市区町村コードカラム FROM テーブルA INNER JOIN テーブルB ON 住所カラム LIKE CONCAT('%',市区町村名カラム、'%') ただ「重複しないと考えて」といいつつもかなり無理があるロジックです。 たとえば広島市で検索をかけると東広島市がヒットしたりします。 正規表現のつかえるSQLであれば、いろいろ調整できるかもしれませんね
drはSystem.Data.OleDb.OleDbDataReaderですよね。 ならば、Readを実行後、列を指定しないとデータは取得できないのでは? 単一の数値を取得したいだけであれば、ExecuteScalarでいいと思いますけど。
SendObjectは何かと引っかかるものがあるので、 #1でのサイトの最後にあるBASP21を使った方法が いい場合があります。 以下のサイトでは過去ログでBASP21に関するものがいくつかあります。 http://www.accessclub.jp/bbs3/0228/superbeg72768 … BASP21のサイトは以下です。 http://www.hi-ho.ne.jp/babaq/basp21.html
>変換する これはどういう意味でしょう？ 元MDBのデータを新MDBに取り込むという話ですか？ 元MDBの方のフィールドの属性を変更したいとか？ 仮に元MDBに新MDBのテーブルをリンクした場合、 CurrentDBには以下の情報があります。 (1)TableDefs 　TableDefのコレクション 　TableDefには以下のプロパティがあります。 　(a)Attributes 　　0なら実テーブル、&H40000000ならリンクテーブル 　(b)Name 　　本DB上での名前 　(c)SourceTableName 　　リンク下での名前 　(d)Fields 　　Fieldオブジェクトのコレクション 　(e)Indexes 　　Indexオブジェクトのコレクション 　(f)その他は省略 (2)Fieldのプロパティ 　(a)Name 　　フィールド名 　(b)Type 　　属性 　(c)Size 　　文字数 　(d)その他は省略 　　しかし、Null許可とか重要なもの多数 (3)Indexのプロパティ 　(a)Primary 　　主キーかどうかを表す 　(b)Unique 　　重複不可を示す 　(c)Fields 　　キーを構成するFieldのコレクション 　(d)その他は省略 以上のネタを使えば手作業ではなく、正確に変換の プログラムが作れると思いますよ。
　データベースから、select文でORDER BY無しで全データ検索をかけると、順不同になります。これ、定義で順序を保証しないとなっているからです。現実として、ＤＢＭＳが違えばもちろんのこと、下手すると、データ入力時の物理データファイルの空き領域の都合なんて理由で順番が変わります。そして、次の日にデータファイルの最適化（ＤＢＭＳによっては必要です。）をすると、また順序がかわります。 　SQLが複雑になるにつれ、もっといろいろな要素が絡みこんできます。ＳＱＬの最適化によりあなたが入力したＳＱＬと等価だけど違うＳＱＬ文を実行している事だってあります。 　さて、問題のＳＱＬです。一見、選択するKOKYAKU番号が違うだけで、同じように動いたら、一連番号枝番の大小も同じになっても良さそうな・・・・と考えてはいけません。 　入力順序が同じかどうかは質問文からは解らないし（というか、実運用では誰も知らないというのが普通ですよね。ついでに言えば、その時の物理ファイルの空き領域が飛び地になっていたかもしれません。）、選択した結果のデータ件数も違います。（ソートアルゴリズムによっては、対象の件数の偶数奇数で違う結果が出ます。） 　事によったら、KOKYAKU番号11111111の時と22222222の時では、実行するアルゴリズムが違う可能性さえ否定できません。（優秀な最適化機構では、データベース上のデータの分布・偏りまで、統計情報として最適化に利用します。このような場合、当然、検索の条件によって最適化の結果が変わることもあるわけです。またテーブルのサイズが大きく変われば、最適化の結果も変わります。）アルゴリズムが変われば、出力の順序が変わっても不思議ではありません。 　とりあえず思いつくままに落書きしてみただけで、結果の順序が変わる理由なんてまだまだいくらでも出てきます。 　 　結論は、ORDER BYで明示したフィールド以外の順序を問うてはいけません。昨日の結果と同じ順番で出て欲しいというのでさえも×です。同じように出て欲しいのであれば、ちゃんとORDER BYに書きましょう。（もし、今は、思ったように動いても、明日のデータ数で同じように動く保証はありませんし、物理ファイルを再編成・最適化したら、きっと違う動きをします。）
<O>さん そうですか、 それは、良かった〓 私も睡〓時間が短縮する効果を実感して〓〓す〓 無料なので、有難〓〓す〓 自殺防止用に開発された〓で鬱〓〓も統合失調〓〓も有効〓と思います〓 ストレス解消やマイナス観念を消去するのにも有効のようです〓で、大〓〓活用して欲しいです〓 〓みに<T>くん用には、<?Y>くんが家族〓名前を使っ〓〓つに余〓に取り〓〓てくれるよ〓〓す〓 <K> ここまで解読できました。 人名と思しきところは伏せておきました。<?Y>は1文字目が読めないので2文字目のイニシャルです。
横から失礼します。 > A、Bフォームのポップアッププロパティは「いいえ」です。 ということですが、 「作業ウィンドウ固定」は「はい」になっていませんか？ あるいは、フォームを開くコードで WindowMode を acDialog にしていませんか？ Ｂのフォームが、上記のどちらかの方法で開かれている場合 Ｂのフォームを閉じるか、非表示にするまで Aのフォームに制御を戻すことはできません。 > Ｂのフォームは、開くのに時間がかかる為閉じたくないのです。 ということなら、B の切り替えボタンに、 　　Me.Visible=False で、B を非表示にしたらどうでしょう。 この場合、A のフォームを閉じるときに B も閉じるようなコードも必要になってくるかもしれませんね。
参考） http://www.accessclub.jp/bbs2/0109/beginter32872 … No32872.タブを含む固定長テキストファイルのインポート方法 タブの扱いに困るケースは事例があるのでいろいろ探してみましょう。 TransferText をそのまま使うと イレギュラーなケースは対応できないこと多々あります。 案１） インポートの直前にインポート対象のファイルに対して 「テキストファイルのTabを，に変える」をＶＢＡで処理させます。 Ａファイルをインポート →Ａファイルを加工してＢファイルで保存、実際はＢファイルでインポート →Ｂファイルは削除しておく とする。 案２） ＶＢＡで対象のファイルを１レコードずつＥＯＦになるまで操作し、 Tabを操作しながらテーブルへインポートする。
私もわからず困っていたのですがようやく分かったので報告します。簡単に言えばwindowsに入っているデーターファイルのアイコンを出しておき、iphoneをUSB接続してiTunesを同期させ左側に出てきたデバイスのiphoneをクリック、Appタブをクリック、下の方へ行くとファイル共有に出る。右側の文章に先ほどのデーターファイルのアイコンを移動させると自動的に同期してiphoneに入ります。 iphoneのFileMaker goを起動させFiles on Deviceからデーターファイルを操作できます。 参考URL：http://www.emic.co.jp/go/category/filemaker-go/
ＶＢができるのだったら、SQL ServerのExpress Edition＋Visual Basic 2010 Expressの組み合わせはどうですか？ どちらもマイクロソフトからダウンロードできます。 参考URL：http://www.microsoft.com/japan/msdn/vstudio/expr …
クエリ内がどういう形式になっているかわかりませんが、一つのcsvファイルにエクスポートするということは、カラム数は同数で且つそのカラム名・カラムの並び順も全て同じということでしょうか。 それであればクエリを一つにまとめて（クエリ1、クエリ2、クエリ3をサブクエリにしてUNION ALLなどする）新たにクエリ4を作成されるのが手っ取り早いです。
Donation Wareですけど http://homepage.mac.com/aamann/Mail_Scripts.html を試してみて下さい。
訂正。(2)のところで、 Private Sub t1_GotFocus() If Forms!フォーム名!ctlサブフォーム名!テキストボックスB Like "*" & "支払" & "*" Then になっていましたが、 Private Sub t1_GotFocus() を、 Private Sub AA_GotFocus() としてください。書き間違いです。
ＶＢＡはよく知らないし、ざっと見ただけですが Forms!F_設備詳細!設備管理No. = Forms!F_稼働設備一覧!設備管理No これは Forms!F_稼働設備一覧!設備管理No　の番号で該当する詳細を開きたいつもりのようですが、実行されているのは開かれた詳細の設備管理Noを Forms!F_稼働設備一覧!設備管理Noにより書き換えているようです。 該当する詳細を開く方法は色々あるでしょうが、フィルターの使用など如何でしょうか？
UPDATE K INNER JOIN R ON K.ICHI=R.ichi AND K.CODE=R.CODE SET R.ATAI=100 WHERE K.CODE="K002" AND K.ICHI="H20" AND K.[NAME]="電力" 使用するDBシステム、バージョンを書きましょう。 微妙に違いがあります。 尚、複数テーブルの結合で更新する場合は１：１か、１：ｎの１側しか 更新できません。キーやインデックスの関係が述べられていませんが、 この点が保証されないとSQLを実行してもエラーになります。
第１段階のテーブルAをもとにクエリーで式1のフィールドを新たに作ります。そのやり方はツールバーのなかのビルドのツールを使います。式1に書き込む内容は下に書いているものを入れます。 IDコード大項目中項目数量式1 11232211100　　　　　1232211 21232211501232211 31231812401231812 41232612301232612 523420911002342091 623420182002342018 723424183002342418 823424244002342424 92562512582562512 102562512262562512 112562624232562624 式1: [テーブルA]![コード] & [テーブルA]![大項目] & [テーブルA]![中項目] ここまでお分かりでしょうか。ビルドのウインドウのところをご存知でしょうか。
[Office ボタン] － [Accessのオプション] - [カレントデータベース] で 「フォーム上のコントロールに Windows のテーマを使用する」にチェック。
＃１です ＃２への補足で >関数を駆使して抽出する方法はないでしょうか？ ですが、＃２の回答は関数そのものです。それ以上に何をお望みなのか？
Excelから簡単にという意味をとりちがえていなければ、 (1) 新しいシートで、ツールバー→データ→外部データの取り込み →新しいデータベース、クエリ→データソースの選択 →Ms Access Database* から、データベースを選択 (2) クエリウィザード-列の選択　でクエリを選択し、 必要な列を選択。 (3) データの抽出で住所フィールドをクリック。 右に表示された「次の条件に一致する行だけを含む」 で 「値を含まない」　を選択。その右側のリストに 「八王子市」を記入。 (4) そのまま、終了まで次へを選択。 というような手順なら取り出せると思いますが。
一式全て外注だと予想以上の金額になります。jt190sさんも仰られているぐらいですね。 拠点が多いならもっとかかるかもしれません。 同時アクセスが５までなら普通のファイルメーカーでいけると思います。 でも、上記の程度だとリレーションの勉強とサーバーに置く関係の勉強をすこしすると 自分でできるくらいの難易度だと思います。 私は製造＆直売店をやっていますが、殆どのシステムを自作したので多分200万+月々くらいのシステムをハード+ソフト込みで10万以下で作っています。先日30万くらいするPOSレジを中古ハード込み3万以下で作りました。ソフトはオークションで入手です。 ファイルメーカーは一度慣れるとこまごましたところにも使えるのでとても便利でお得です。 Verは５で十分です。
クエリで項目の値を取得する際、DLOOKUP関数を使うというのはどうでしょう。テーブル２からの顧客ＩＤ取得等に使えたらと思います。
No2です。 エラー処理ですが、AddNewの前にOn Error GoToを使用してエラー時にエラー処理ルーチンに飛ばしたらどうかということです。エラー処理ルーチン内ではErrオブジェクトを利用してエラーの種類を判別して対応するメッセージを表示するか、もしくはErr.Descriptionでエラーメッセージを表示されたらどうかということです。 これでエラーメッセージ終了後に画面に制御を戻すという感じです。 （結局、どこでチェックをしようと、チェック開始前から関連するテーブル全体をロックして他からの更新を排除して処理を行うようなことでもない限り、チェック後にAddNewが完了するまでの間に他から更新される可能性が否定できません。ですのでこのように実行時エラーに備えます。）
【要旨】 分割したくない(=システム側に残したい)テーブル群を「隠しオブジェクト」にし、 隠しオブジェクトを非表示に設定した上で、分割ツールを実行します。 【詳細】 > 特定のテーブルのみ分割しないような設定はあるのでしょうか? Accessのデータベース分割ツールは、表示対象のテーブルのみが対象と なり、非表示のテーブルは対象外になります。 ですので、冒頭に示したように、分割の対象外にしたいテーブル群を一旦 「隠しオブジェクト」に設定し、ナビゲーションウィンドウで「隠しオブジェクト」 を表示しない設定にしてやれば、ご要望の動作を実現できるかと思います。 <隠しオブジェクトの表示/非表示の設定方法> ※隠しオブジェクトを指定する際は、それを表示する設定にしておいた方が 　 確認・修正がしやすくなります。 　 (隠しオブジェクトは淡色表示になります(表示する設定にしている場合)) 1)Officeボタンをクリックし、最下方の『Accessのオプション(I)』ボタンをクリック 2)『Accessのオプション』ダイアログ(?)が開くので、左端の領域から『カレント 　データベース』を選択 3)中頃の『ナビゲーション』の領域にある『ナビゲーション オプション』ボタンを 　クリック 4)『ナビゲーション オプション』ダイアログが開くので、下方の『表示オプション』 　内の「隠しオブジェクトの表示(H)」をオンまたはオフに設定する 5)各ダイアログを、『Ok』ボタンをクリックして閉じる <隠しオブジェクトの指定/解除の方法> 1)ナビゲーションウィンドウで、対象テーブルを右クリック 2)右クリックメニューの最下方にある「テーブル プロパティ(B)」を選択 3)『(テーブル名) のプロパティ』ダイアログが開くので、下方の「隠しオブジェクト 　(D)」チェックボックスをオンまたはオフにする 4)上記ダイアログを、『OK』ボタンをクリックして閉じる ・・・以上です。 この方法で、冒頭の通りの設定を行った上で、分割ツールを実行して下さい。 (『データベースツール』リボンの『データの移動』内の『Accessデータベース』 　ボタンから、ツールを実行)
2010年６月のＡを除外検索する。
mdbファイルがあるなら、W7マシンに動作するアクセスを インストールし、ファイルを開き、エラーが起きた場所を特定し 問題を探り修正する。たぶん、対応するデータ形式に修正すれば 動くと思いますが、他のOSで動かなくなる可能性もあります。 そうだとするとデータ型をテキストにして対応するコントロールを 直すしかないのかな。 mdbが手に入らないなら、Acc2002以降で新規作成しデータを インポートする。
つまり、一月目、二月目、と数えでヤレばいいんですね。 (Year(清算日)-Year(受付日))*12+Month(清算日)-Month(受付日)+1 こんな感じでどうでしょうかね。
＜クエリ結果＞ フィールド1　　フィールド2　　フィールド3 aaa　　　　　　bbb　　　　　　ccc aaa2　　 　　　bbb2　　　　　 ccc2 が aaa aaa2 bbb bbb2 ccc ccc2 でよいならＥＸＣＥＬも考えますが、邪道なので。 ＶＢＡで行います。 TransferText を使わなければ、いろいろできます。 出力ファイルＯＰＥＮ クエリ１件目取得 レコード無くなるまで繰り返し 　１項目目出力＆改行 　２項目目出力＆改行 　３項目目出力＆改行 　・・・ 　クエリｎ件目取得
任意のアプリは何でしょう? そのアプリがコマンドからファイルが開けるなら、Eventを送信の計算で入れてあげれば良いだけです。 計算式は普通のアプリなら以下で行きます。 "そのアプリのフルパス "&Substitute( GetValue ( GetAsText( test::オブジェクト) ; 3 ) ; "imagewin:" ; "file://"
特に問題は無いと思います。 ですが、Windows Server 2008と言う事は、その SQL Server はそれなりにミッションクリティカルな業務で使われていると思います。 もし、基幹業務で使われているなら、そこに別のRDBMSをインストールすべきではありません。 ですので結論としては 開発機なら「可能」です。 開発機ではなく本番環境なら「可能ではあるが、MySQLは別サーバーで立てる」が推奨案です。
追加した列のデータ型は何でしょうか？ こちらのSQLite.DLL使用ですよね？ http://sqlite.phxsoftware.com/
カテゴリー違いです。 とりあえず、Windowsの拡張子の関連付けとかアイコンについて調べてみれば戻せると思います。 詳しくは分かりませんが、アプリから読む分には問題ないと思いますので、 上記の件を調べてみてください。
いろんな方法がありそうですが、フィルタを使うのが簡単かもしれません レポートでのデザインモードで １．レポート全体を対象としプロパティのデータタブをクリック ２．フィルタ欄に　[ID]=15　と書き込む ３．すぐ下にあるフィルタ適用を　「はい」にする これでテスト。１５番だけが表示されたら、これがダイナミックに替わるようにする ４．フィルタ欄に　[ID]=forms!当該フォーム名.[ID]　と書き込む 「当該フォーム名」はそちらの現況に併せてください。上記回答は当方で試した物なので、道筋は正しいですが、初心者が正しくたどれるかは疑問です。健闘を祈ります
レコードカウントで採番する場合は、 rsInMain.AddNew rsInMain!番号 = rsInNUM!番号 + 1 rsInMain!項目1 = rsOutMain!項目1 rsInMain!項目2 = rsOutMain!項目2 j = rsInMain!番号 rsInMain.Update のところで、 rsInMain!番号 = rsInNUM!番号 + 1 を rsInMain!番号 = rsInMain.RecordCount + 1 に置き換えればいいです。 それと、 'T_番号の更新 rsInNUM.Edit rsInNUM!番号 = rsInNUM!番号 + 1 rsInNUM.Update の部分はコメントアウトするか削除します。 こちらの環境では、レコードソースを クエリ、テーブル、SQLどれも問題はないのですが。 一応、簡単にT_テーブルでオートフォームでフォームを つくり、あとボタンをくっつけた簡単な フォームでやっています。
先の物では先頭部分の表示に問題があったので修正します。 それとともに表示時間を柔軟に調節出来るようにしました。 後の欠点としては、全角半角文字の区別をしていないので、表示にズレがでてしまう問題が残っています。 ------------------------------------------------------------------------ Public Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long) Sub sample2() Dim i As Integer, j As Long, k As Integer Dim tmp As String Dim mes As String Dim word As Integer Dim loops As Integer Dim CEL As String mes = "ExcelVBAでテロップを表示したい。ExcelVBAを独学でゼロから学んでる超初心者です。" & _ "worksheet上に右側から現れて左側に消えて行くというごくシンプルなテロップを作成したいのですが" & _ "ExcelVBAでテロップ作成することは出来ますか？" & _ "出来るのであれば、コードを教えて頂けるととてもありがたいです。" & _ "わがままな質問で申し訳ありません。宜しくお願い致します。" word = 30 loops = 3 CEL = "A1" mes = String(word, "　") & mes For k = 1 To loops For i = 1 To Len(mes) DoEvents Sleep (250) tmp = Mid(mes, i, word) Range(CEL) = tmp Next Range(CEL).ClearContents Next End Sub
残念ながら質問がよく分かりません。 実行中の画面を添付してみてはどうでしょうか。
SELECT句で、IIF関数またはSWITCH関数で項目１を評価すればいいです。
No3です。昨日中途半端に終わったので追記です。 No1の方のご指摘の「業務で使うものをこんなところに晒して問題にならないのか」は適切ですね。今回のはマイクロソフト社提供のサンプルプログラムのメニュー画面に見えますのであまり問題ないと思いますが、こういうことに気をつけるように習慣づけておいた方がいいでしょう。 データを取得した後で　If (rs.EOF) Then　としていますが、ここではレコードセットにデータが存在するかどうかのチェックを行っています。 イメージとしてはAccessのテーブルをダブルクリックで開くとデータが表として表示されますがレコードセットもあのような感じです。テーブルを表示した際には最後の行が新規入力用の空の行になっていますが、EOFとはEnd of Fileの意味でデータの終わりを意味し、あの新規入力用の空の行だと思えばいいです。 ここではレコードセットを開いた直後にEOF=True（つまりデータ無し）の状態かどうかを判定しています。 rs.Close　～　Set con = Nothingの部分はオブジェクト型の変数を使用した場合の、後片付けのお約束だと思ってください。オブジェクト型の変数を使用するとメモリが使われますが、その使ったメモリをきれいにする処理だと思ってください。 Select Caseは多肢選択でrs![Command]の各値に対応するcaseの命令を実行します。 ここでrs![Command]はレコードセットrsの中のCommandという名前の項目を意味します。Accessではレコードセットやフォーム、レポートの各項目を参照する際にこのような書き方をします。 ＞Case conCmdGotoSwitchboard これは多肢選択の中のある値に関する処理の始まりですが、このプログラムの書き方はハンガリアン記法（だったと思う）というスタイルで記述されているのでconCmdGotoSwitchboardは定数（constant）のはずです。今回の質問範囲では定義されていないようですがどこかで定義されているはずです。 ＞Me.Filter = 画面の項目名以外にプロパティもVBAから制御できます。その場合には対象の画面（オブジェクト）に．（ドット）＋プロパティ名で参照や設定を行います。ここではこの画面でのFilterプロパティに値を設定しています。 なお、Accessのデザインビューではプロパティシートには日本語でプロパティの名称が記載されていますがすべてに対応する英語の名称があります。これについては開発者向けのヘルプで調べてください。（私も丸暗記はしていないです。よく使うものは覚えていますが） ＞DoCmd.OpenForm rs![Argument], , , , acAdd DoCmd命令ですがAccessのマクロを実行するVBAの命令です。Accessには簡易言語としてマクロというものが搭載され、そこには「フォームを開く」「レポートを開く」・・・と言った命令が用意されていますが、それの実行を行います。こちらもプロパティ同様にマクロとしては日本語ですがVBA上では英語の名称となっています。（こちらもヘルプを調べてください。このケースではOpenFormはフオームを開くの意味ですが。） ＞On Error Resume Next ＞On Error GoTo 0 これらはエラー発生時の処理の制御ですね。上がエラーが発生しても気にせず（処理を中断せず）次の行を実行しろ、下はこれまでに設定したエラー発生時の処理をリセットしろ（エラーが起きたら処理を中断しろ）の意味です（たしか・・・） ＞Err <> 0 ErrはAccessで定義されている変数で、最後に発生したエラーのコードを保存しています。０の場合にはエラーがなかったという意味です。これの仲間で最後に発生したエラーメッセージを保存する変数もあったはずです。 今回私からお教えすることができるのはこれくらいです。 基本的にはプログラムを書く人間は自分でヘルプから探せるようになるべきだと思います。
Filter ( テキストフィールド ; "ABC...xyz" ) ダブルクォーテーションの中は大文字小文字のアルファベットすべて入れてください。 参考URL：http://www.filemaker.co.jp/help/html/func_ref3.3 …
＞「主キーにできるならば」というのはどういった意味合いなのでしょうか？ 型名にどういうデータが入るのかわからなかったからです。 私も携帯電話くらいは持っていますが、あまり機種に興味はないので・・・ さすがに同じキャリアでは別々の機種に同じ型名はつけないだろうと思いますが、ドコモとauなど別のキャリアで型名がかぶることがあるかどうかがわからなかったのです。 もし被る可能性があるなら、理屈の上では「社員CD＋型名＋製造番号」では一意にはならなくなるから主キーにはできないということです。（現実には別キャリアで型名が被ることがあっても製造番号まで一致する可能性は極めて低いので問題ないとは思いますが）
#1です。 すいません。今試してみたら、#2さんのやり方でＯＫでした。 VBA上では #日付型# の記述はエラーになると勘違いしていました。
ＳＱＬ文で　SELECT の後に　DISTINCT を加えては？ http://www.sophia-it.com/content/DISTINCT
入力内容を保存方法はいくつかありますが 今回例としては、×ボタンで閉じる時に 入力内容をテキストファイルへ保存し 次回、ユーザーフォームを起動表示した際に 保存内容をテキストボックスに初期表示します。 例） テキストボックスのオブジェクト名 : txtMemo １．×ボタンで閉じる時にテキストファイルへ保存 ユーザーフォームのTerminateイベントに下記処理記述 Private Sub UserForm_Terminate() Const TXT_FILE As String = "￥memo.txt" Open ThisWorkbook.Path & TXT_FILE For Output As #1 Print #1, txtMemo.Text Close #1 ' ファイルを閉じます。 End Sub ２．起動表示時に保存内容をテキストボックスに初期表示します。 ユーザーフォームのInitializeイベントに下記処理記述 Private Sub UserForm_Initialize() Const TXT_FILE As String = "￥memo.txt" Dim TextLine 'ファイルの存在チェック If Dir(ThisWorkbook.Path & TXT_FILE) = "" Then Exit Sub End If Open ThisWorkbook.Path & TXT_FILE For Input As #1 Do While Not EOF(1) Line Input #1, TextLine txtMemo.Text = TextLine Loop Close #1 ' ファイルを閉じます。 End Sub
Notesのメールは必ずしもPOP技術をつかっていません。 チェックするだけなら標準ツールでnminder.exeが用意されているので試してみては？ どうしてもPOPでということであれば、管理者に問い合わせるしかありませんね
インデックスが無い場合は、普通はシーケンシャルスキャンになると思います。 日経BPのサイトに処理の流れが載っていました。 SQLの処理の流れ(インデックス無し) http://itpro.nikkeibp.co.jp/article/COLUMN/20070 … インデックス(Bツリー)を使わない場合と使う場合の比較。 http://itpro.nikkeibp.co.jp/article/COLUMN/20070 …
ソート用のフィールドを用意しておいて、UPDATEで定期的に値をRANDしてやればどうでしょう？ もちろん特定の参照キーをもとに別テーブルで管理してもいいとは思いますが
一個の列の設定や受け取りで、 :値の受け取り変数[:標識変数] といった書き方をします。 標識変数は、列の値が「null」なのか「nullでない有効な値」なのかを判別するために使います。 標識変数が負であれば、受け渡しをしようとした列値がnullという意味になります。この場合、列値の受け渡し変数の値は、保証されません。 標識変数の値が0であったり、正の数値なら、nullでない有効な列値が返されているという意味になります。 標識変数の値の具体的な意味については、お使いのRDBMS、コンパイラのマニュアルを参照してください。
そのままファイルがあったドライブに一切アクセスせずに別のハードディスクを用意して復元ツールを使えば助かるかも http://aos.com にアクセスしてオンラインスキャンをして目的のファイルがあるかどうか探してください 見つかればツールを買って復元してください オンラインスキャンで発見は出来ても救出は出来ません
業務特性を考える事もできない初心者がアーキテクチャ設計をしちゃ失敗の元ですよ
bindに限らずコマンド全般のオプションで、データやメッセージを標準出力に表示するかどうかだったと思います。 コマンドオプションでマニュアルにのっていませんか？
>ワイルドカードの&はOLE DB Provider for Jet すみません。ワイルドカードがなぜか 　　& になっていました。 　　% です。
最近プログラム書いていないので間違っていたらすいません。 da.SelectCommand = cmd　でデータを取得するＳＱＬ文（Select文）をセットしていると思いますが、そのSelect文にdistinctキーワードをつけてＳＱＬの段階で重複を省けばいいのではと思います。
テーブルやデータは残っています。テーブルオカレンスが失われただけです。 【対応方法】 レコードのインポートで元テーブルを丸ごと新規テーブルにインポート
[ショートカット キーを有効にする] オプション
Amazon などの API を使って商品一覧を取得してはどうでしょうかね。 自分でプログラミングする手間が掛りますけど。
ALL ABOUT JAPANサイトのエクセルの使い方、で住所の取り出し方の考え方と解説あります。 リンク先は控えてないのでこのサイトを検索して下さい。 市区町村郡レベルまで書いてあります。
No.1の方が示された参考URLでの質問者の方の要望は 　「Accessのランタイムが既にインストールされているか」 なので厄介なことになっていますが、今回ご質問の 　「作成されたデータベースがランタイム上で動いているのか、 　アクセス2007本体で動いているのか」 であれば、その「作成したデータベース」の適当な場所から、 以下のようなコードを実行してやれば、確認できます： 'データベース起動時に自動で開くようにしているフォーム 'の「開くとき」イベントで、MsgBoxで表示する例 Private Sub Form_Open(Cancel As Integer) 　　Dim IsRuntime As Boolean 　　'SysCmdでランタイムかどうかを確認 　　'(上述URL内で、みるくさんもこのコマンドを提示されています) 　　IsRuntime = SysCmd(acSysCmdRuntime) 　　'確認結果をMsgBoxで表示 　　MsgBox IIF(IsRuntime, "ランタイム","アクセス本体") & "から起動" End Sub なお、Accessには「ランタイムモードで起動するコマンドライン オプション」がありますので、これを使用して「Access本体の ランタイムモードで起動」した場合は、「ランタイム」扱いになります。 (というか、Accessインストール済みの端末しか手元にないため、 　動作確認はこのランタイムモードで行いました(汗))
SQL文にorder by を付ければソートできます。 ただ、質問のSQLですと、単純に order by block_CDと書くとエラーとなるので SELECT TOP 1 "*", NULL, 0 FROM Q_type UNION SELECT [type_CD], [blockname], [block_CD] FROM Q_type order by 3 と記述してみてください。 参考URL：http://oe-roel.spaces.live.com/Blog/cns!61C9112E …
追加ですが、ページのカウントなどを していますか。
エクセルで開く→CSVデータで保存する というのがもっとも簡単なやり方だと思いますが、なにか特殊な意図がありますか？
長年5.5を使ってたので6は未使用のままですが、 ヘルプに「Case 関数はそれぞれの式を順に評価し、真の式が見つ かった場合にその式の結果を返します。」と書いてあるとおり、 case(value<389,4,value<410,2,value<=540,1,value<600,2,4) のように順に分けていけばいいはずですが。つまり、value<410を 評価するときには既にvalue<389は偽であるのです。
ツールからReal Player SP のアドオンを有効にしてください。
細かいコードの書き方が分からないので（私の想像範囲外のエラーもあるかもしれないので）方向性だけ書きますね。 ＞現在、Bテーブルを先に貼り付け、貼り付けたBテーブルとSNOが一致するAテーブルの情報を ＞格納するところで行き詰っています。 流れを見ると、やりたいことは先にＡテーブル（１側）を検索し、その検索結果に対応するＢテーブル（Ｎ側）のデータを取得（読み取りのみで更新しない）したいものと理解します。 ・個別に各テーブルを検索するのではなく、ＡとＢを結合したレコードセットを検索すれば 　いいと思います。 ・レコードセットの元のＳＱＬはこんな感じです。（AAA、BBBはＢテーブルの項目と想定して 　記述しています。またＡに対応するＢが存在しない場合にキー以外の項目にNULLを返すために 　SELECTでの[SNO]はＡテーブル側を使用してLEFT JOINとしていますが、それが不要なら 　INNER JOINでもかまいません。） SELECT [A].[SNO], [B].[AAA], [B].[BBB] FROM [A] LEFT JOIN [B] ON [A].[SNO] = [B].[SNO] WHERE [A].これ以降にテーブルＡの検索条件を記述してください。 ・上記ＳＱＬには、処理の必要に応じてORDER BY句を設定して並び替えてください。 ＞エラー原因 本物のコードを見ていないので確かなことは言えませんが ・ＳＱＬ文中の ON 以降にテーブルＡＢ間の結合条件が記述されていない。 　ここは ON [A].[SNO] = [B].[SNO] のようになると思います。 ・A.[SNO]='rst!SNO'　と本当に記述しているなら・・・それは「テーブルＡのSNOの内容が 　"rst!SNO"という文字列（ＶＢのコード中のrst!SNOが示す内容ではないことに注意）と 　一致している」と言う意味なのでそこがおかしい。
１）伝票番号の先頭文字がそのまま集計グループになる仕様とする。 ＭＩＤ関数かＬＥＦＴ関数で１ケタ目を取得する。 「”伝票番号”」＆「ｘ」、項目に付与させる１ケタの判定にも使う。 並びにも使われる可能性も考えて、「伝票番号集計グループ」とかにする。 ２）縦並びのデータを横にし合計する。 これはクロス集計クエリが望ましい。縦軸：抽出日付、横軸：伝票番号集計グループ 「伝票番号１」「伝票番号２」「伝票番号３」 よりは 「伝票番号１」「伝票番号５」「伝票番号８」 のがより作りやすい。前者でも判定を入れれば可能。 ３）「１」「５」「８」以外があるかどうか。 ほかにもなければ、伝票番号の先頭１ケタを使えるが、 後で「４」で始まるものも増えたとなると 「伝票番号１」・・・「１」から始まるもの 「伝票番号２」・・・「５」から始まるもの 「伝票番号３」・・・「８」から始まるもの 「伝票番号４」・・・「４」から始まるもの と作っておくとギクシャクした構成になってしまう。
今更かもしれませんが・・・(汗) 『既定のショートカット メニュー』の設定は、手動で切り替えた際の メッセージにもあるとおり、再起動しないと有効になりません。 (そう言いつつも、『ナビゲーション ウィンドウの表示』のように、 　「設定の即時無効化」が可能な項目もあったりするのですが(汗)： 　但し、これも「非表示→表示」の一方通行で、完全ではありません) [参考]ナビゲーションウィンドウの即時表示方法(フォームからの場合)： 　　DoCmd.SelectObject acForm, Me.Name, True ですので、(「設定変更の即時有効化」に比べると、だいぶ手間が 掛かってしまいますが、)代替策を2つほどご紹介してみます。 【案1・フォーム側の『ショートカットメニュー』の設定を切り替える】 『既定のショートカット メニュー』が有効な状態でも、各フォームの 『ショートカットメニュー』プロパティを「いいえ」に設定すれば、 フォーム上でのショートカットメニューは無効化できます。 但し、「全てのフォームで個別に設定が必要」なのと、「テーブル本体 やナビゲーション ウィンドウの表示が許可されている場合、そこでの ショートカットメニューは無効にならない」という問題があります。 【案2・管理者用と一般ユーザー用に、データベースを分割する】 2007でのマルチユーザーでの動作確認ができていませんが、恐らく Access2003までと同様、他のユーザーが使用中の場合にはデザイン ビューで開くことはできても、変更の保存はできないものと思います。 この問題を回避する意味でも、こちらの手段をお勧めします。 これを行うにあたっては、「管理者/一般」用の分割を行う前に、 「テーブル」のみを持つ「バックエンドエンド」ファイルと、「それ以外」を 持つ「フロントエンド」ファイルに分割する必要があります。 分割は、手動でも行えますが、ウィザードでも行えます： http://office.microsoft.com/ja-jp/access/HA10240 … 手動の場合は、 　1)新規MDBファイルを作成し、全テーブルを一括インポート 　　(既存MDBからの「エクスポート」だと個別になるため手間が膨大) 　2)既存MDBからテーブルを全て削除 　3)新規MDBの全テーブルに対して、改めてリンクテーブルを作成 でOKです。 これで、バックエンド(テーブル)側さえ共有にしてしまえば、全ての ユーザーが同じテーブルの読み書きをすることができます。 あとは、フロントエンド側をコピーして配布(ネットワークにつながった 各個人のPCに保存)すれば、一般ユーザーに対してはショートカット メニュー等の使用を制限しつつ、管理者は(自分のPCに保存した MDBファイルを使用することで)いつでもデザイン変更が可能、という 運用方法をとることができます。 (配布ファイルのみ、『既定のショートカットメニュー』をオフにする、と) ※現状では、1つのMDBファイルを共有しているのかと思いますが、 　 本来は各個人のPCにフロントエンドのコピーを置く形にした方が、 　 データベースとしては安定します。 　 但し、管理者のPC上でのデザイン変更は、(当然ながら)他のPC 　 に自動では反映されないので、各ユーザーにその都度配布する 　 (または最新ファイルの保存場所を決め、各自にコピーしてもらう) 　 か、その差替を自動で行う仕組みをつくる必要が生じますが(汗) ・・・以上、参考まで。
補足） システムの核となるテーブルは分ける 受注テーブル（受注コード、受注日、締切日、出荷日、顧客コード） 受注明細テーブル（受注コード、商品コード、数量） 入力用の１次的なテーブルは１つにする。 （受注コード、受注日、締切日、出荷日、顧客コード、商品コード、数量） という使い方はあります。 更新に必要な情報は１テーブルに格納し、個々のテーブルへはこの情報から更新させる。 別々で 更新用受注テーブル（受注コード、受注日、締切日、出荷日、顧客コード） を入力した２日後に 更新用受注明細テーブル（受注コード、商品コード、数量） を入力とすると同期がとれませんので （受注コード、受注日、締切日、出荷日、顧客コード、商品コード、数量） を一度に入力させるという意味です。 基本的には無駄のないよう正規化します。 テーブルというものなんでもかんでも分けるかというとそうでもないです。 用途によって、どういう構造にするかは変わります。
まだどうしたいのかよく分かっていませんが、 本題の、 A購入= DCount("名前", "3月の来店者データ", "A購入='○'") ですが、 "3月の来店者データ"のテーブル　を　"3月の１回だけ来店の来店者データ"のクエリ ではダメなのでしょうか？。 クロス集計について、 縦横の２次元テーブルから他の縦横の２次元テーブルを起こすのは困難ですが、 １次元テーブルから２次元テーブルをつくるのはこのクロス集計クエリでできます。 使い方をマスタすればいろいろ使い道はあります。 ２次元テーブルから１次元テーブルをつくるのは追加クエリの繰り返しでできます。
「商品名」が格納されているマスタテーブル「商品マスタ」とかはないのでしょうか。 あればそこにソート用の項目を新たに用意すると将来的にも汎用性あると思います。 ａｃｃｅｓｓにしてもＳＱＬサーバにしても、 一部の文字列を抜きとる処理をしないと先に進みません。 「商品名」で困難なら、商品コード＋αとか 他の項目で代用できればそれでも構いませんが・・・。
＃１です 現在＃４までの投稿通知メールが届いていますが、＃１のだけ届いてません。 システム上の何かでしょうか。検閲に回っているとか？ 質問者さんへの通知は、どうなっているのでしょう？ ＃１のは 受付日 >= #2010/4/1# AND 受付日 < #2010/5/1# の決め打ちでしたが 流動的に指定できるようにしてみました。 クエリを開くと [年月？]　を聞いてくるので、 「2010/4」とか「H22/4」とか「平成22年4月」とか入力します。 SELECT 社員.名前, IIF(IsNull(T1.社員ID),0,T1.カウント) AS 受付回数 FROM 社員 LEFT JOIN (SELECT 社員ID, Count(*) AS カウント FROM 受付 WHERE 受付日 >= CDate([年月？]) AND 受付日 < DateAdd("m",1,[年月？]) GROUP BY 社員ID) AS T1 ON 社員.ID = T1.社員ID; CDate や DateAdd 部分で、日にちを指定しないと１日に解釈してもらえます。 後は、[年月？] 記述部分をフォーム参照に変更するとか・・・
OLAPはEXCELからもダイレクトに繋がるSQL Server が一番いいと思います。 なかなかコアな分野なので専門家を探して相談されるほうが良いと思います。 「SQL Server OLAP コンサルティング」で検索してみると、いろいろと出ますよ。
もし、計算を開始するフィールドの位置が 最初のフィールドからではない場合、 Private Sub cmdB() Const COUNTFIELD = 8 'テーブルの計算対象のフィールド数 のあとに、 Const STARTFIELD = 0 '計算を開始するフィールドの位置 を追加してください。 この場合は0ですから、先頭のフィールドから計算を 開始します。２番目のフィールドから始める場合は Const STARTFIELD = 1 とします。 さらに、 '集計 For i = 0 To COUNTFIELD - 1 a(i) = rs.Fields(i).Value s = s + a(i) Next i のところで、 a(i) = rs.Fields(i).Value を a(i) = rs.Fields(i + STARTFIELD).Value に変更してください。 以上、変更したところは先頭のフィールドから 計算を開始する場合でも使えます。
>Unicode はちなみに、半角・全角共に 1バイトですか？ unicodeも全角3バイトですよ テキストに保存すれば一目瞭然です。 SHIFT-JISのほうがunicoudeやUTF-8より明らかに容量が小さいことが分かります。
データにどのようなパターンがあるかによって、必要になる式が 全く違ってきてしまいますが・・・(汗) とりあえず、全てが「英字(字数不定)」＋「-」＋「数字(字数不定)」の パターンであるなら、以下のようなSQLでいけます： (使用アプリケーションがAccessで、テーブル名が「tbl_商品」、 　並べ替えを行うフィールドの名前が「商品名」としての例) Select * From tbl_商品 Order by Left([商品名], InStr(1, [商品名], "-")-1), CLng(Mid([商品名], InStr(1, [商品名], "-")+1)); 【解説】 まず、InStr関数で「商品名」の中の「-」の位置を割り出します。 これをLeft関数の引数と使用して、「-」の手前まで(→「InStr(～)-1」) で切り出したのが、Order By句の1条件目の式です。 次に、数値部分も同様に、今度は「-」の次から(→「InStr(～)+1」)の 切り出しになりますが、これにはMid関数を使用します。 但し、Mid関数で切り出しただけでは文字列扱いとなってしまうので、 これをCLng関数を使用して数値化します。 (なお、もしも数字部分が小数もありえるなら、CLng関数の代わりに 　CDbl関数を使用する必要があります) これがOrder By句の2条件目になります。 ※上記のパターンのデータしかないことが前提の式です。 　 このパターンに合わないデータがある(「ABC123」など)場合は、 　 「プロシージャ呼び出しが正しくありません」とのエラーが発生 　 しました(汗)
良くわからない質問文章なので、回答が寄せられていない様子です。 タイトルでは、「DBソフト」と記入しているため、確かにこのカテゴリに含まれそうな質問だけど・・・ ＞そのような運営が可能なシステム 内容を読む限りでは、DBを含めた「HP製作」に関する質問になっています。 つまり、「カテゴリが違うから、この技術者のカテ利用者から相手にされない」ことになっている様子です。 身近なAccessだって画像は扱えるし、 画像を扱えるDBなどは、自分でネット検索して仕様を読めば解ることなので、 そもそも、技術者向けのカテで質問するべきことではない事だと、皆が思っています。 となると普通は、本文にある「HPの構築に関するシステム」についてを知りたいのだろうと考える。 でもそれは、カテゴリが違う話。　だから・・・相手にされない。 そんな様子になっています。 文章をきちんと整理した上で質問の要点を絞り、 その要点を、どのカテゴリで質問すべきか？考えてから、 再質問することを薦めます。 現在の「回答が得られない」原因は、この不明な質問自体にあります。
テーブル構成が何となく変な気がしますが、 そのままクエリにすると以下のような感じです。 SELECT A.名前, IIf(B.名前 Is Null,"×","○") AS A購入, IIf(C.名前 Is Null,"×","○") AS B購入, D.回数 FROM ((3月の来店者 AS A LEFT JOIN 3月のA購入者 AS B ON A.名前=B.名前) LEFT JOIN 3月のB購入者 AS C ON A.名前=C.名前) LEFT JOIN 来店者の来店回数 AS D ON A.名前=D.名前 私が訪ねたいのは関連テーブルの名前と、レイアウトです。
>VLOOKUPと同じ関数 と云うことであれば、すでに＃１に提示されたとおりですが、「依頼書の内容を入力するのに使いたく」が主たる目的であれば、メイン / サブによる参照が便利かもしれません。 http://www.accessclub.jp/samplefile/samplefile_2 … ちなみに上記のようなＵＲＬがあるとは、＃１回答で知りました。私はアクセスのフォームなどを使うことがほとんどないのですが、「教えて！goo」で回答するときなどには便利ですね。 参考URL：http://www.accessclub.jp/samplefile/samplefile_2 …
可能です。 フォームの RecordsetType プロパティに 2 を設定してください。 詳細はヘルプで下記をご参照ください。 Access 開発者用リファレンス　Form."RecordsetType/レコードセット" プロパティ
データソースネーム（DSN）にユーザとパスワードを 含めていませんか？ これだと、そのDSNを使う限り、アカウント別の制御は できません。DSNのユーザ、パスワードの欄を空にして みてください。最初に接続する時に問い合わせがあると 思います。
> 皆さんはどんな事をしてstep upしていますか？ 【第1段階】 とりあえず、自分自身が持っている何らかの情報を まとめるためのシステムを実際に作ってみる。 (私は、手帳などに書き溜めていたメモの整理を 　するためにAccessを使用し始めました) ご自身の趣味に関連する記録(実際に使うかは別と して、入手や実行時、或いは読み返す・再訪時の 感想など)を記録するようなシステムなら、機能の イメージが具体化しやすい分、実戦的な勉強になると 思います。 (但し、機能を多く載せることより、最初は「システムと 　して全体が動くこと」を目標にされた方がいいでしょう： 　細部に深入りして、今にして思えばかなり無駄なこと 　をしてきた経験から(汗)) 【第2段階】 基本的な構成が組めたら、データベース内の細々と した機能の拡張をしてみる。 例えば、フォームでの検索には、フォーム毎に専用の テキストボックスを設置することが多いですが、 その代わりに、各フォームで共通で使用できるツールを 作成してみる、などです。 最初は、Accessの右クリックでの検索機能の置き換え 程度から始めて、そこから更にOr検索に対応させるとか、 指定範囲内への代入機能(同じ値、或いはExcelのフィル ハンドルのような連続データにする)など、「あったら便利 そうな機能」を考え、その実現のために必要な情報を 集める・・・といったことをすると、結構勉強になります。 【第3段階】 自分の作ったデータベースを管理するためのツールを 作成してみる。 仕事などでデータベースを共有する場合を考えると、 誰でもフォームのデザインを変えられたり、データの 削除ができてしまうのは脅威でもあります。 通常は、そういったことへの対策は個々のデータベースに 対して行いますが、ある程度の数を作ると、新しいデータ ベースに取り掛かるたびにその対応をするのが面倒に なってきます(汗) 第2段階までが(主に)１つのファイル内の操作だったのに 対して、今度は別のファイルを扱うことになることから、 それまでとは違った領域に踏み込むことになりますので、 これも勉強になります。 ・・・以上、自分のたどっている最中のところを、簡単に ご紹介してみました。 それと、Access付属のヘルプとサンプルデータベース (NorthWind)は、初めはかなり難解だと思いますが、 特に前者は私としてはかなり重宝していますので、 もしもインストールされていないようでしたら、入れておく ことをお勧めします。 http://office.microsoft.com/ja-jp/access/HP05188 …
＞A３に数式を入れたいのですが、A１とA２に入力しない時は空白にしたいのですができますか？ Excelだと仮定して回答します。Ａ３に　=IFERROR(B1/(A1*A1),"")　と入力してください。 計算結果がエラーの場合には空白に置き換えてくれます。 日付関数とラジオボタンは普段私は使わないので、調べる気が起きないのでパス。
開きたいPDFのファイルパスが解っているのでしたらEvent送信で開けます。 Apple Scriptでするより楽ではないかな？
「高速化かつODBCの設定をしなくても済むように出来ればDAOを使って接続したい」 という要求じたい無理があると思います。 ODBCのDSNを設定せずに接続したいというのなら、 SELECT * FROM [odbc;Driver={SQL Server};Server=サーバー名;Uid=ユーザー名;Pwd=パスワード; Database=データベース;].[テーブル名] でアクセス可能ですが、リンクテーブルの方が高速かなあ。
「組み込み」だけでメシが食えるほど甘くないです。 技術のトレンドは移りゆくものです。「芸は身を助ける」と 言うように多芸であれば自分を高く売るチャンスが増えます。 「組み込み」できないけど「データベース」得意な人と、 「組み込み」はバッチリだけど「データベース」サッパリな 人ではどちらが、会社では望まれていると思いますか？ 答えは「両方できる人」です。
No.2です。 > 「元のMDWファイル」が何を指すのかがわかりません。 ご推測の通り、デフォルトのSystem.mdwのことです。 ですので、 > もう一歩ですので、ご教授願えませんでしょうか？ とのことでしたが、解決は遠いかもしれません(汗) というのは、権限の割り当て方次第ではありますが、仮に セキュリティウィザードを『次へ』ボタンだけで進めて最後に 『完了』ボタンをクリック、という形で権限設定をした(=一般 ユーザーに一切の権限を与えない)場合、System.mdwが 指定された状態で当該MDBファイルを起動しようとすると 「オブジェクト '(File Path)' を使用する権限がありません」 とのメッセージが表示されて、開けないはずだからです。 (もちろん、既定の「Admin」アカウントなどに「データベース 　を開く」の権限を与えている場合は、上記メッセージは 　出ず、アカウントの要求もなしで開くことができます) ※アカウントの要求は、MDBへの権限設定の内容に関係 　なく、新規作成したMDWを使用した場合に表示されます。 　(権限未設定のMDBでも、wrkgrpコマンドラインを使用した 　 ショートカット経由で開くと、アカウントが要求される) ですので、System.mdwを指定した状態で開けるということは、 　a)データベースやテーブル・フォームなどに、権限が設定 　　されていない 　b)一般ユーザー(System.mdwの既定の管理者アカウント 　　である「Admin」を含む)に、権限を与えてしまっている のどちらかの可能性があります。 で、前回の手順に沿って操作を実行されたのだとすると、 「a」の可能性はないはずなので、残るのは「b」ということに なります。 ですので、ちょっと手間は掛かりますが、まずは新規MDBを 作成して、これに対してセキュリティウィザードを実行する ことで新規MDWファイルを作成し(→ウィザードの途中にある 権限の割当では、ユーザーに一切権限を与えない)、この MDWファイルを元に、前回の回答の手順を再度実行して もらうのが、結果的には最も早く解決につながるかと思います。 (なお、上記で作成した新規MDBは、新規MDWファイルの 　作成のためだけのものなので、作業が終わったら削除でOK) 上記の手順を踏んで、「新規の管理者(ウィザードの初期設定 のままなら、ウィザードを実行したコンピューターの名前が アカウント名になっているはず)のみが全権限を持ち、その他 のユーザーは開くこともできないMDBファイル」を作成して、 　1)MDBを直接開こうとしても、全PCで開けないこと 　2)「/wrkgrp」コマンドラインを使用したショートカットを経由し、 　　新規の管理者アカウントの情報でログインすれば開けること を確認してみてください。 それが正しく動作をすることを確認したら、改めてウィザードを 適用するか(→System.mdw以外を使用している場合、ウィザード の最初の段階で、「現在のワークグループ情報ファイルを変更 する」が選択可能)、メニューから「ツール(T)→セキュリティ(T) →ユーザー/グループの権限(P)」を選択して、中間的な権限 (データベースやフォームは開けるが、デザインの変更などは できない、等)を持つユーザーやグループを追加する、という ように段階を踏みましょう。 ・・・以上、長文失礼致しました(汗)
サクラから提示されたドメインは多分 http://○○○.sakura.ne.jp （○は自分で指定したアドレス） というドメインだと思いますが、お金をかけずに複数サイトを運営するには２つ方法があります。 (1)下層ディレクトリを使う。 　　簡単に言うと、 　　　http://○○○.sakura.ne.jp/second-site/ 　　のように、今提示されているドメインの中にフォルダを作って運用するという方法。 　　上記の場合はsecond-siteというフォルダを作ってsecond-site内は別のサイトを 　　立ち上げてしまう。 　　簡単ですがアドレスが長いのが欠点。。。 (2)最初に提示されたドメイン以外にあと２つサブドメインを無料で利用できるので、 　これを使う。 　詳しい方法はオンラインマニュアルがありますのでそちらを参考にしてください。 　（参照URL欄のアドレスから飛べます） 頑張ってください。 ご参考までに。 参考URL：http://support.sakura.ad.jp/support/manual/rs/se …
＞フォームでは旧商品名に入力すると新商品名に対応する商品名が表示されます。 ＞そのレコードをテーブルで開くと、旧商品名は保存されているのに新商品名は保存されて ＞いません。 まず、今のコントロールソースの設定ではこうなってしまいます。 最初初期段階では結構こうやってしまうものです。 テーブル「新商品名」項目に直接値を入れてもフォームには出てきませんよね？。 旧商品名は出るけども。 普通のやり方では、コントロールソースに =[新商品名]としないと 画面での新商品名の値でもってテーブルの新商品名への更新はされません。 そこを=[旧商品名].column(2) としているため保存されないのです。 画面は正しく出ますが・・・。 やりたいことに対して、やっていることが中途半端で間違っているので 今のやり方を修正しなくてはなりませんね。やりたいことは処理は可能です。大丈夫です。 ＞フォームの新商品名のコントロールのコントロールソースに =[旧商品名].column(2) と入れてみる これは、 フォーム「新商品名」に「[旧商品名].column(2)」を表示する、の設定であり、 テーブルの「新商品名」に「[旧商品名].column(2)」を設定する、を意味しません。 ここに？？が生まれています。 ・フォームに「（更新される前の）旧商品名」を表示する項目 ・フォームに「（更新される前の）新商品名」を表示する項目 ・フォームに「[旧商品名].column(2)」（＝更新後の新商品名）を表示する項目 ３つ同時にフォームで表示させるにはどうするかを考えてみましょう。 ３つめの「更新後の新商品名」表示に対しては「非連結項目」を使うことになります。 ヘルプやサンプルを見て学習しておいてください。 対応としては、 １）旧商品名＝テーブルの旧商品名 ２）新商品名＝テーブルの新商品名（画面上は非表示項目にします） ３）新商品名＝[旧商品名].column(2)（非連結項目、画面上は「新商品名」というラベル表示にします） ３つの項目を用意し、 １）が更新されたら、３）の項目の値を２）へ設定する という動きにします。この動きを理解することです。 マクロの「値の代入」を使います。
> ※フィルターの場合はエラーになるのに？ 私の環境ではエラーにはならないのですが。 私の場合は、レコードソースにテーブルを直に指定して、 フォーム上には一部分しか表示していない帳票フォームで確認してみたのですが。 フォーム上に表示していなくても、 レコードソースで得られているものは利用できたと思います。 必要であれば、確認した際の内容を記述しますが・・・
次のマクロご希望の計算が出来ました。お試し下さい。 行数はfor next文のところで指定してください。現在は16としています。 Sub Macro1() ' ' Macro1 Macro ' マクロ記録日 : 2010/5/3 ユーザー名 : ' ' Range("A1:C1").Select Selection.Copy Sheets("Sheet2").Select Range("A1").Select ActiveSheet.Paste Dim gyo1 As Integer, gyo2 As Integer, retu As Integer, endgyo As Integer, id As Variant, rnk As Variant, tuki As Variant 'InputBox (endgyo) Worksheets("Sheet1").Activate gyo1 = 2 id = Cells(gyo1, 1) rnk = Cells(gyo1, 2) tuki = Cells(gyo1, 3) Worksheets("Sheet2").Activate gyo2 = 2 Cells(gyo2, 1) = id Cells(gyo2, 2) = rnk Cells(gyo2, 3) = tuki gyo2 = gyo2 + 1 'MsgBox (endgyo) For gyo1 = 3 To 16 Worksheets("Sheet1").Activate 'MsgBox (id) 'MsgBox (Cells(gyo1, 1)) If Cells(gyo1, 1) = id And Cells(gyo1, 2) = rnk And Cells(gyo1, 3) = tuki Then Else id = Cells(gyo1, 1) rnk = Cells(gyo1, 2) tuki = Cells(gyo1, 3) Worksheets("Sheet2").Activate Cells(gyo2, 1) = id Cells(gyo2, 2) = rnk Cells(gyo2, 3) = tuki gyo2 = gyo2 + 1 End If 'id = Cells(gyo1, 1) 'rnk = Cells(gyo1, 2) 'tuki = Cells(gyo1, 3) Next End Sub
　仮に、会員情報も、貸し出し情報も全部一つのテーブルで登録するとします。 　必要な項目は・・・ 　会員番号・氏名・住所・電話番号（他、個人情報。） 　貸し出したビデオのタイトル（又は、ビデオＩＤコード）・貸出日・返却期限 　といったところでしょうか。 　さて、このテーブルの一行（一レコード）は、一人一行となるでしょう。 　レンタルビデオ店は、大概複数のビデオが借りられますね。と一人で２本３本と借りていく人がいますし、何本貸すことになるかも解りませんね。人によっては一本だし、他の人は５本くらいかも・・・ 　では、一行に、何本になるか解らないビデオＩＤや貸出日・返却期限を登録するには、どうしましょうか？　ビデオＩＤ１・ビデオID２・ビデオＩＤ３・・・とフィールドを並べるのが一番に思いつく方法です。 　これを繰り返し項目と言います。 　ところで、フィールドはいくつ並べたらいいのでしょうか？今、店の規則で一人５本までとしているから、５つ？もし、隣接店との競争の関係で一人１０本に改訂されたら、どうします？とっても拡張性に問題がありますね。これが繰り返し項目を嫌う理由の一つです。もう一つは、データの検索や集計がすごく面倒になります。（ＳＱＬに話が進まないと今は理解できないかもしれません。） 　別の解としては、一人一行を放棄して、ビデオテープ毎に一行を作る方法もあるでしょうが、そうすると、今度は、同じ人の住所や電話番号を山ほど登録する羽目になります。 　会員さんが引っ越しをして住所が変わったら、いったいいくつのレコードを更新することになるのでしょうね。ぞっとする話であることだけは確かです。 　どちらも、データベースの設計では避けるべきとされる事項です。これを考えるための方法論の一つが正規化です。 　この物語の次の作業は、会員情報テーブルと、貸し出しテーブルの二つのテーブルに分離して（更にビデオ情報が要るから、３つかな？）・・・と続くのでしょうが、その辺はもう一度続きを読んで見てくださいね。　
お節介な上にコードが間違っているという・・・m(_ _)m Sub subContorolLock() 　Dim objForm As Object 　Dim cnt As Control 　Set objForm = Me 　For Each cnt In objForm.Controls 　　If cnt.Name = "チェックボックス1" Then 　　　cnt.Locked = False 　　Else 　　　cnt.Locked = True 　　End If 　Next End Sub ロック/非ロックが反対でした・・ 失礼いたしました。
既に退職しているのであれば、いまさら引継ぎを行う義務はないと思います。 （引継ぎには日当を払うのが妥当ではないかと思います。） まだ退職していないなら、引継ぎに関して業務命令を出すことができます。 その命令に従わないなら、損害賠償を起こすよということもできます。 ＤＤＲに関しては、持ち出しを許可するかしないかはどちらでも良いと思います。 実際には、開発者であれば、かなり厳重な環境でない限り持ち出すのはそんなに 難しいことではないと思いますので、正式に許可を得ようとするには理由があると思います。 （そのソフトがそのままどこかで使われる可能性が高いということです。） それ事態が悪いことだとは思いませんが、会社がお金をかけて作った財産が、 退職する開発者の利益のために使われるべきではないような気もします。
VBから、どの様な方法でACCESSの起動とパラメータ指定していますか？ 例えば、ACCESS2007でしたら、 C:\Program Files\Microsoft Office\Office12\MSACCESS.EXE "C:\hoge\Database1.accdb" /CMD TEST,123 の様な呼び出しであればパラメータ取得出来ると思いますが、どうでしょうか？
No3の方が言いたかった事を述べてくれているようです。 ＞ちなみに上司はいません。営業の方がやりとりしているのですが 私は比喩として、上司と部下と言う実際にあるケースを上げただけです。それを質問者と相手の営業マンに置き換えてください。それを説明しないとならないなんて。スターゲイト（U.S.AのSFテレビドラマ）に出てくる宇宙人との会話みたいです（何度も比喩の説明を宇宙人にしています）。なれてくると、「あんたにまかせるよ」と言うのが、営業をしているとでてくる決まり文句です。 これは、本当に「あなたに任せたわけではありません」。私のかゆい所を調べて、気に入った物を、持ってきてくれる事を期待して、言っているだけで、本当にあなたが仕様を決めて持っていたったら、次からは仕事は来ません。 たぶんヒントとして、データーベースにするという事は、とどのつまり、 「検索結果をどのようにするか」 につきます。No3の方も書いていますが 「入力項目は、出力項目は、出力帳票」 で、「入力項目＝営業」として検索したら、何が出力されるのか？　そのフォーマットは、メディアは？ これだけの事でも、あなたが勝手に決められますか？　 No3の方も記載していますが、調査して問題点を洗い出し、どのような情報が欲しいのか聞かないとだめですよね。 それに向けて、DBの設計に入ります。それがないと実際の所設計は無理です。 良くあるのが、写真データーなどの組み合わせです。DBを使う人間に聞くと（オペレーター＝＞事務の方）、写真とか、伝票などスキャンしたデーターも付随していると便利ね！　とか良く言われます。 単なる顧客DBでも同じです。営業の人から出た話でも、いざ使ってもらうと、これって、発注や注文データーと一緒にならないの？　なんて苦情が経理や商品管理部から出てきます。昔（２０年前）なら、全部テキストデーターで取り出し、マージして再構築なんてシステムが中小の企業ではあたりまえでした（大手もでも同じだったな、つながっていなかったので）。継ぎ足しですね。 検索イメージを提示すると、相手側も、話しやすいでしょう。
書き忘れ フォームやレポートを使っている場合は、Baseは使えないけどMicrosoftが配布している無償のAccessRuntimeが使用できます。 http://www.microsoft.com/downloads/details.aspx? … バージョンは今のところ2007のみですが、それ以前のバージョンで作成されたものも問題なく動くと思われます。
簡潔にまとめていただいてありがとうございます。 いただいた情報の範囲内での回答になりますが、ご容赦を。 (1) レポートの詳細に二つのサブレポートを配置する方法。 (2) レポートウィザードで作る方法。 (3) コードを書きまくる方法 のような方法があるとは思いますが、 思考減退に伴い厳密な方法が思い浮かばないというか、 この場で説明しきる自信がないので、 (2)の方法を取り上げてみます。以下手順。 (1) 集計のクエリをQ集計とします。このクエリを もとにユニオンクエリを作ります。フィールドは適時変更、 追加してください。 SELECT Q集計.顧客ID, Q集計.日付, Q集計.結果１, Q集計.結果2, Q集計.結果3 FROM Q集計 WHERE (((Q集計.日付)=[前回集計日付])); UNION SELECT Q集計.顧客ID, Q集計.日付, Q集計.結果１, Q集計.結果2, Q集計.結果3 FROM Q集計 WHERE (((Q集計.日付)=[今回集計日付])); 適当な名前で保存します。 (2) レポートの新規作成を選択。基になるテーブルまたはクエリの 選択で保存したクエリを選択し、レポートウィザードを選択し、OKとします。 (3) 選択可能なフィールドで全て選択し、次へ行きます。 (4) グループレベルで顧客IDを選択し、次へ行きます。 (5) あとはそのまま次へを選んでレポート名を適当に設定し、 レポートのデザインを編集するを選択し、完了を選択。 (6) デザインビューが表示されたら詳細の部分でマウスを 右クリックし、並べ替え/グループ化を選択。フィールドの 空いている所の右をクリックし、日付を選択。 選択した行の右側の並べ替え順序をクリックし、 昇順を選択してレポートを保存します。 以上で終了です。 レポートをダブルクリックするとパラメータの 入力が表示され、まず前回集計日付、続いて 今回集計日付が表示されるので、それぞれの日付を 入力します。入力が済むとレポートが表示され、 IDごとに上が前回、下が今回というように表示されます。 これは一つの方法です。DLookupで何を参照しよう としたのかはわかりませんが、これを参考に何か あれば質問してください。
設計思想としては邪道かもしれませんが、難しく考えないで 数値 ０・・・25・・・50・・・75・・・100 に対応する分算出テーブル ０・・・15・・・30・・・45・・・60 を作りリンクさせるのが簡単で早いです。 これで確実に不具合なく機能するものをまず作って、 書式なり関数なりでかっこよく？整えるのが良いと思います。
フォームやレポートのレコードソースには、テーブルやクエリの他に SQL文を直接指定してやることもできます。 一例： http://oshiete.goo.ne.jp/qa/5784557.html ですので、フォームAのフィルタをDoCmd.OpenReportのWhere Conditionに指定する代わりに、レポートのレコードソースを 切り替えてしまうのが、現状からの大幅な改修は行わずに 目的の結果を得られる解決策ではないかと思います。 (No.5のお礼欄の対応をされた後では、ちょっと遅かったかも 　しれませんが(汗)： 　但し、『フォームAのクローンをつくって「選択」をTrue』という 　操作で、もしもテーブルは元のフォームAと同じままだとすると、 　　・クローンではなくフォームAそのもので処理してもいいか、 　　・フォームだけでなくテーブルも別に用意しないとまずいか、 　のような気がします(汗)) 以下、上記内容での改修案になります： 【現状】 DoCmd.OpenReport "レポートＣ", acViewPreview, WhereCondition:=フィルタ 【改修】 'フィルタは使用せずにレポートを開く DoCmd.OpenReport "レポートＣ", acViewPreview 'レポートのレコードソースを差し替え '(元のレコードソースが「クエリZ」だった場合) Reports!レポートＣ.RecordSource = "Select * From クエリZ Where " & フィルタ & ";" 上記の例は、元のコードが「フォームAで現在フィルタが 適用されているか」を判定していないので、それを踏襲 した形としました。 通常は、フィルタを解除(フォームのFilterOnプロパティを Falseに設定、或いはツールバー等で「フィルタの解除」 を指定)しても、フォームのFilterプロパティには、直前の 条件が記録されたままになりますので、フォームAの フィルタを解除した状態で、上記コードでレポートを開くと、 レポート側はフォームAと異なる結果を表示してしまいます。 これを避けるためには、フィルタ解除時に「Filter=""」の 代入を行うか、上記のコードを以下のようにして下さい： 【再改修】 Dim strRs As String　　'変数を宣言 DoCmd.OpenReport "レポートＣ", acViewPreview 'フォームAのフィルタ適用状況に応じてレコードソースを選択 Select Case Forms!フォームA.FilterOn 　　Case True　　'フォームAでフィルタ適用済 　　　　strRs = "Select * From クエリZ Where " & フィルタ & ";" 　　Case Else　　'フォームAでフィルタ解除済 　　　　strRs = "クエリZ" End Select '選択したレコードソースに差し替え Reports!レポートＣ.RecordSource = strRs ・・・以上です。
RDBMS名とバージョンを、明記するようにしてください。 ここに質問をする人で、RDBMSを省略する人は、MS-ACCESSというパターンが多いですが、非常に方言が多いですので。 品名ごとに別行としてということなら、単純なグループ化です。 SELECT 品名,COUNT(*) AS 行数 FROM 売上テーブル GROUP BY 品名
入力テキストボックス項目の店舗は数字のがユーザ側には扱いやすいです。 コンボボックスならどちらでも良い。 エリアと連結して１フィールド化で扱うケースがあれば そのときの店舗、エリアは前０付与し固定長の文字のが扱いやすいです。 いずれにしても内部コードが表に出ることは少ないと思います。 （レポートやフォームには店舗名や都道府県名、エリア名で出す方が・・・。） 店舗のマスタテーブルは 店舗－（都道府県）－エリアの３フィールドのコード（と名称）は必要になるでしょう。 また、店舗が決まれば、都道府県やエリアが決まる設計、正規化しましょう。 使いたい場面でどうするかが決まります。 文字型が絶対というわけではありません。
血圧　オムロン　グラフ 　上記のキーワード群で検索すれば、１カ月分の血圧表・折れ線グラフ表示セットのExcel 2003ファイルがダウンロード可能です。（私も利用中。オムロンさんに感謝） 　以下URLは検索できない場合の助け舟です。 参考URL：http://www.healthcare.omron.co.jp/product/hem_no …
　4th Dimension の名前だけしか知りませんが、たぶんSQLで操作する機能もあるでしょうから、目論見の動作をちょっとSQLで記述してみます。 SELECT 名前,Max(A),Max(B),Max(C) FROM データテーブル WHERE 名前 IN (SELECT DISTINCT 名前 FROM データテーブル); 　大筋の考え方は合っていると思いますが、複数のMax()関数を同時に使うとヒットしない値が出てくるかもしれません。また、値が空白のときに何が表示されるかが不明ですので、様々なテストデータで試して改良してみて下さい。
置換を使えば良いと思います。 範囲を指定して検索する文字列に　-　を入れ 置換後の文字列に何も入れないで置換を行う
連続した曜日を抽出する時には、判別しやすい形にすることができます。 Weekday の、第２引数を使います。 Weekday(日付,2) とすると、月曜日から 1 が振られます。 　土曜：6 　日曜：7 Weekday(日付,2) >= 6 で土日が判別できます。 また、 Weekday(日付,7) とすると、土曜日から 1 が振られます。 　土曜：1 　日曜：2 Weekday(日付,7) <= 2 で土日が判別できます。 範囲をどちらかに偏らせておくと、判別は楽なのかなと思います。 どちらかと言えば、土日なので、土曜を指定する後者の方が良いのかも。 以下手順でできるようです。 「レコード」→「フィルタ」→「フォームフィルタ」から 入力欄に Weekday([日付],7)<=2 を入力し フォーム上で、マウス右ボタンで「フィルタ/並べ替えの実行」を選びます。 または、 通常のフォーム上の日付をクリックし、マウス右ボタンで、 フィルタの対象欄に、Weekday([日付],7)<=2 を入力 設定された内容は、以下手順で編集できます。（初めからこの画面でも） 「レコード」→「フィルタ」→「フィルタ/並べ替えの編集」 と辿ると、クエリのデザイン画面と同じような表示になります。 そこで、フィールドに　Weekday([日付],7)　を入れ （入れると　式:Weekday([日付],7)に変わります） 抽出条件に　<=2 とし、 マウス右ボタンで「フィルタ/並べ替えの実行」を選びます。 実行した後は、編集画面は閉じて良いです。 編集画面で、Weekday([日付])　を入れ 抽出条件に 1 Or 7 を設定/実行しても同じです。 ※編集画面にはSQLビュー的な機能はないようです。 また、フォーム上のボタンを押した時に土日に絞り込むのなら、以下の記述で良さそうです。 Private Sub btn1_Click() 　　Me.Filter = "Weekday([日付],7)<=2" 　　Me.FilterOn = True End Sub
フォームをデザインビューで開き、開く時の部分の　...　の部分をクリックしコードビルダを開き、 DoCmd.Maximize を入力して保存すれば良いです
＃２です >データ獲得間隔が変わる場合があります データ獲得間隔で割った view（クエリ）を介在させては？ 試してみました。３０間隔の場合 SELECT [time]/30 AS c FROM 5824933sampling; を介在させて SELECT [5824933check].id, [5824933div].c FROM 5824933check LEFT JOIN 5824933div ON [5824933check].id = [5824933div].c WHERE ((([5824933div].c) Is Null)); 当然のことながら、テーブル名やフィールド名は試験用に適当な（仮の）ものです。間隔が変わるごとに view を、動的に変化させる。
コンボボックス２つ使って・・・ということになりますか。 帳票フォームであれば以下が参考になると思います。 （地方と県の関係部分が） 帳票フォームの複数コンボボックスで絞り込み http://hatenachips.blog34.fc2.com/blog-entry-73. … また、単票フォームであれば、 上記内でコンボボックスに重ねているテキストボックスを削除した形にしてみてください。 難しそうなら、 現状のテーブルサンプルを、 また、ルックアップで選択した時の「値」には何を使おうとしているのか、 提示してもらえますか。
フラグは「旗」で「目印」に使います。 目印フィールドを作って複製元のレコードで例えば「1」と入れておきます。 複製完了後に「レコードへ移動/前の」をループして目印フィールドが「1」 だったらループを抜ける。などで使います。 レコードIDを変数に入れて使えば目印フィールドも要らないかも。 私もFM教室の1生徒です。リンク先で質問すればたくさんのアイデアを得る ことができますよ。 参考URL：http://www.russ.jp/stepbbs/step.cgi?
共有については経験が無いですが、試しにLAN内で共有してみたところ（共有プリンタで） クライアント側では共有プリンタに設定し直さないとダメみたいですね。 ネットワークプリンタというのは判りません。 試してみるのが早いのではありませんか？
> 理想的な正規化とは第３正規化 基本的には、個々のシステムの要件によります。 ただし、原則的に第3正規化、もしくはボイスコッド正規化まではすべきとする文献も多いです。 また、一概に非正規化すると性能が上がるとは限りません。 下記の様に非正規化することで、かえって性能の低下を招くことも有ります。 非正規化する 　↓ 1タプル(行)の項目数が増える 　↓ 検索時のメモリ使用量が多くなる 　↓ ディスクソートやスワップが発生しやすくなる 　↓ かえって性能が低下する > 第２正規化の結果と第３正規化の結果が同じということはありますか？ あります。 正規形は下記の順に条件が厳しくなっていきますが、各段階の条件に違反する事項が元のデータ構造に存在するとは限りませんので、ある段階を満たした時点で次以降の段階も満たすことも有ります。 第1 → 第2 → 第3 → ボイス・コッド → 第4 → 第5 例えば、1カラムのみの1テーブルだけを考えれば、何もしなくても第5正規形になっていることになります。
設定のオートナンバーがプログラムで どのように活用されているのかさだかでは ありませんが、質問の現象はプログラム、 あるいはテーブルの書式などを見ないと 何が原因かはこちらではわかりません。 自作連番の再設定、あるいはオートナンバーの 初期化、再設定などに対応する術はいろいろ あります。 以下に以前回答したオートナンバーの初期化 等に関するものがあります。何かの役に 立てばと思います。 http://oshiete1.watch.impress.co.jp/qa5737015.html
>なでしこから標準でつかえそうも無いSqliteのドットコマンドを利用したく調べております。 何故なでしこの公式サイト読まない? SQLiteに接続する方法書いてあるの完全に無視。 ついでにDLLを利用する方法もマニュアルに書いてある。 すべて無視してこんな質問するのは何故?
＃１です > 文字を入れ替え、その入れ替えた文字を再度テキストボックスに入力したい ここでの「再度」を理解できていないのですが。 どのような記述になっているのでしょうか。 テキストボックス「txt1」に、"(1)" の入力で "第一章" に置き換えるものとした場合、 Private Sub txt1_Change() 　　If (Me.txt1.Text = "(1)") Then 　　　　Me.txt1.Text = "第一章" 　　End If End Sub の様な記述になっていると、 Me.txt1.Text = "第一章" によって、Change イベントが発生します。 Me.txt1.Value = "第一章" または、 Me.txt1 = "第一章" とすることで、イベントを発生させずに値を代入することができます。 ただ、これをすると、更新前処理、更新後処理も発生しないことになります。 更新前処理、更新後処理も発生させつつ、２度処理しないようにする時には、 (a) フラグ制御する Dim bFound As Boolean Private Sub txt1_Change() 　　If (Not bFound) Then 　　　　If (Me.txt1.Text = "(1)") Then 　　　　　　bFound = True 　　　　　　Me.txt1.Text = "第一章" 　　　　End If 　　End If 　　bFound = False End Sub フラグが立っていない時だけ、判別/処理する。 Me.txt1.Text = "第一章"　をした時点で、変更時/更新前処理/更新後処理まで動き切ります。 (b) 変更時処理を一旦無しにする Private Sub txt1_Change() 　　Dim sTmp As String 　　If (Me.txt1.Text = "(1)") Then 　　　　sTmp = Me.txt1.OnChange 　　　　Me.txt1.OnChange = "" 　　　　Me.txt1.Text = "第一章" 　　　　Me.txt1.OnChange = sTmp 　　End If End Sub Me.txt1.Text = "第一章" する前に、変更時イベントを受け取らないようにします。 Me.txt1.OnChange に "[Event Procedure]"　や　"[イベント プロシージャ]"　が設定されていると、 Private Sub txt1_Change()　が呼び出されます。 Me.txt1.Text = "第一章"　をした時点で、更新前処理/更新後処理まで動き切ります。 動き切った時には、他へコントロールが移動しても再度イベントが発生することはありません。 Me.txt1.Text　に値を代入しなかった場合は、 他のコントロールに移動した時点で、更新前処理、更新後処理が動きます（変更していたら） Me.txt1.Text　への設定は、txt1へフォーカスがある時だけ有効です。 他の処理をしつつ、txt1へ代入＆変更時/更新前処理/更新後処理を動かしたい時には、 例えば、ボタンがクリックされた時に Me.txt1.SetFocus Me.txt1.Text = "第二章" と記述します。 2007での動きを記述してみましたが、この内容が得たかったものなのかは？？ また、他にも方法があるのかもしれません。
定形化されたインポートでないので、 TransferTextは使わない、での回答のつもりです。 「,,」を「," ",」に置き換えてから １項目単位にテーブルへ追加で・・・、ということでどうでしょう。
access2007 を持っていないので、間違っているかもしれませんが、 acc2000では、タブのページの追加やnameの変更はデザインモードで開かないとできませんでした。　個人的には、動的なmdbのデザインの変更操作はあまりお勧めしません。（巷ではｍｄｂ破損の原因になると言われています。） 私なら、デザインより使い勝手を重視してリストなどからフィルター設定を選ぶような形にすると思いますが、どうしてもタブコントロールが良いなら、あらかじめ、必要最大数を作成しておき、２ページ目以降の「可視」を「いいえ」にしておき、一ページ目のタブに「または」ボタンでも貼り付けて、２枚目の「可視」を「はい」にしていく位しか思いつきません。
恐らく、データベースの管理者以外のユーザーにはデータベースウィンドウを 表示できないようにした、ということだと思いますが、だとしたらF11キーなどの ショートカットキーは、むしろ無効化させておいた方がよいかと思います。 (別のショートカットキーを経由するなどして、データベースウィンドウを表示 　させることができてしまうためです) ※データベースウィンドウの表示は、VBAなら「DoCmd.SelectObject」で、 　マクロなら「オブジェクトの選択」で、それぞれ対応できます。 　(それぞれ、3番目の引数に「True/はい」を指定することで可能) パスワードの入力要求はInputBoxでも可能ですが、パスワード入力らしく 「***」といった表示にさせたい場合は、フォームで自作することになります。 1)新規フォームをデザインビューで開く(テーブルやクエリは指定しません) 2)テキストボックスを追加し、プロパティシートの『その他』タブで、『名前』に 　「パスワード」と指定 3)上記テキストボックスのプロパティシートで、今度は『データ』タブを選択し、 　『定型入力』の欄に「パスワード」と入力 　(パスワード入力時に「***」と表示させるため) 4)コマンドボタンを2つ追加し、一方の名前を「認証」、もう一方を「取消」と 　指定 5)「認証」ボタンのプロパティシートで『イベント』タブを選択し、『クリック時』に 　カーソルを移動したときに右端に表示される『...』(ビルダ)ボタンをクリック 6)『ビルダの選択』ダイアログが表示されたら、「コード ビルダ」をダブルクリック 　(Accessの設定によっては、直接以下のVBE画面が表示されます) 7)VBE(=Visual Basic Editor)の画面が表示され、「Private Sub ～～」と 　いう文字が自動入力されるので、そこを以下のように編集(下記のコピー 　＆ペーストでOk)： Private Sub 認証_Click() 'エラー発生時には「エラー処理:」の行に飛ばすための宣言 On Error Goto エラー処理 　　'変数を宣言 　　Dim strPWD As String, Rslt As Boolean 　　'正規パスワードを定数として記録 　　Const strReg As String = "abcDEF" 　　'入力したパスワードを変数に記録 　　'(空白(Null)は、空文字("")に変換) 　　strPWD = Nz(パスワード, "") 　　'正規パスワードと比較 　　'(StrComp関数を使用し、大文字・小文字を区別させます) 　　Rslt = (StrComp(strPWD, strReg, vbBinaryCompare) = 0) 　　'合致した場合はデータベースウィンドウを表示、しなければ終了 　　If Rslt Then　　　'合致 　　　　'メッセージを表示して、データベースウィンドウを表示 　　　　'(「acTable」は『テーブル』タブの指定。フォームなら「acForm」) 　　　　MsgBox "正規のパスワードを確認しました。", , "確認" 　　　　DoCmd.SelectObject acTable, , True 　　Else　　　　　　　　'不一致 　　　　'メッセージを表示して、Accessを終了 　　　　MsgBox "パスワードの認証に失敗したため、終了します。", , "確認" 　　　　DoCmd.Quit acQuitPrompt 　　End If 終了処理: 　　'処理を終了(→「エラー処理」部分が無限ループになるのを回避) 　　Exit Sub エラー処理: 　　'エラー発生時はエラー内容をメッセージボックスで表示 　　MsgBox Err.Number & "：" & Err.Description, , Me.Name & " 認証" 　　Resume 終了処理 End Sub 8)「取消」ボタンのクリック時には、このフォーム自体を閉じるためのコードを 　指定(VBAなら「DoCmd.Close」、マクロなら「閉じる」アクション) 9)フォームのプロパティシートで、『書式』タブの各項目を以下のように設定： 　『レコードセレクタ』=「いいえ」 　『移動ボタン』=「いいえ」 　『サイズ自動修正』=「はい」(既定で「はい」のはず) 　『自動中央寄せ』=「はい」 　『境界線スタイル』=「ダイアログ」 10)今度は『その他』タブに移動し、以下のように設定します： 　『ポップアップ』=「はい」 　『作業ウィンドウ固定』=「はい」 　※ここの設定は、フォームを開くときにダイアログモードを指定する場合は 　　省略できます。 　　(VBAなら「DoCmd.OpenForm "フォーム名", , , , , acDialog」、マクロなら 　　『フォームを開く』アクションで『ウィンドウ モード』に「ダイアログ」を指定) 11)このフォームに適当な名前をつけて保存して閉じる 以上で作成したパスワード確認用のフォームを、現在、F11のキー送信を 行っているボタンから呼び出すようにしてやれば、目的を達せられるかと 思います。 ・・・以上、長くなりましたが(汗)、参考まで。
(1)数が限定されていて、増減が無い。 (2)名称、表記などに変更が無い。 こういう場合は一般にマスタを設けないことが多い。 マスタを定義して保守する負荷と受ける恩恵の差を 考慮して決定しています。 性別に関しては上記の条件を考えても一般的には マスタ化しないと思います。その他に元号なども マスタ化された例を見ません。（私だけかも）
DB2の排他制御は、そんなに詳しくないですが。。。 排他制御は、RDBMSにより、仕組み、細かな仕様に差がある部分です。それをいろいろなオプションを組み合わせることで、ほぼ同等、あるいは代替手段として使用できるように各RDBMSで段階的に実装しています。 SELECT同士であれば、一方が FOR UPDATE などで更新前提あるいは排他的なオプションを指定した検索をしなければ、共用（排他制御による待ちにはならない）できるのは当然の動きと思います。
SQL文でLEFT JOINを使います。 SELECT xyz.xyz_id FROM xyz LEFT JOIN abc ON xyz.xyz_id=abc.xyz_id WHERE abc.xyz_id is NULL;
Ceiling ( 数値 ) 参考URL：http://www.filemaker.co.jp/help/html/func_ref3.3 …
＃1 です。 DB2 Express-C が無料か？ ということではなく IBM ID が無料か？ というご質問でしたね。 http://www-06.ibm.com/software/jp/lotus/trials/d … こちらでは無料と書かれていますね。 IBM ID の取得に関しては 　DB2 Express-C インストール 　http://www.db.is.kyushu-u.ac.jp/rinkou/db2/db2.h … こちらの手順で操作していくと、 （ただし、最初のWebページはこちらが日本語） （　http://www-06.ibm.com/software/jp/data/db2/v9/ex …　） ４．サイン・イン のところで 　　「Proceed Without an IBM ID」が選択できるようです。 　　日本語のページでは 　　「IBM ID を使用しないで次に進む」 　　というのがあります。 　これなら、IBM ID を取得せずにダウンロードできそうです。
あ、一部間違ってますね。 フィールド設定 [ 別::結果; 別::結果 & 元::役名 & "," ] ではなく フィールド設定 [ 別::結果; 別::結果 & 元:役者 & "," ] です。役名→役者
> 多分設定でしょう Accessの左上のOfficeボタンから、その設定画面が呼び出せます。 1)Officeボタンをクリック 2)最下方にある「Accessのオプション(I)」ボタンをクリック 3)『Accessのオプション』画面が開くので、左側の領域で『詳細設定』を 　選択 4)右側の中ほどに『表示』という領域があり、そこに『最近使用した 　ドキュメントの一覧に表示するドキュメントの数(R)』の項目があるので、 　そこで適当な数を指定 5)『OK』ボタンを押して上記画面を閉じる ・・・以上です。
既に回答そのものはでているようですが。 >セミナーの日付ごとにYes/No型フィールドのチェックボックスを作りました。（全部で20個くらい） とのことですが、この類のセミナーは将来的に増加するものと考えます。どのように対応するのでしょうか？ 通常ＲＤＢ（リレーショナルＤＢ）ではテーブル ・住所録（？） ・セミナー の二つをテーブル「出席（仮称）」で関係づけ、多対多の関係を記録します。このような設計に替える気は無いでしょうか？
b.mdbにリンクテーブルを作って、 オートナンバー以外のフィールドを追加クエリにて追加。 時間がかかるのが心配なら、オートナンバーで範囲を指定し、 件数を確認しながら追加。
フォーム上の社員番号のテキストボックス名を「txt社員番号」と仮定します。 そのテキストボックスの入力規則に以下を設定します。 DLookUp("社員番号","従業員マスタ","社員番号='" & [txt社員番号] & "'") Is Null エラーメッセージに、「重複しています」等設定しておきます。 ※　 DCount でも良いと思いますが、DLookUp は見つかった時点で戻ってくると思ってます。 DCount は、あってもなくても全レコードをみると思うので、どちらかと言えば DLookUp でしょうか。 （重複するものがなければ全レコードを見るのは変わらないと思いますけど）
もう一つのリンク先が同じところに なっていました。以下です。 http://oshiete1.goo.ne.jp/qa5784777.html ついでだから、方法を貼り付けておきます。 リンクの仕方は、データベースウインドウ を表示したままで、 (1)ツールバーのファイルから、 　外部データの取り込み→テーブルのリンク (2)取り込み.CSVが置いてあるフォルダを 表示。 (3)ファイルの種類はテキストを選択。 (4)取り込み.CSVをクリック (5)テキストリンクウィザードが起動 (6)区切り記号つきを選択 (6)カンマ選択 先頭行をフィールド名として使う 　にチェック (7)次に進みIDの選択確認 (8)リンク終了のメッセージ確認 以上で取り込み.CSVがテーブルとして リンクされます。
#1です 外付けケースを開け HDDのコネクタを確認してください 参考HP http://www.pc-info.sakura.ne.jp/hddnosyurui.html IDEならIDE用3.5インチHDDCASE SATAEならSATA用3.5インチHDDCASE を試されてもよいと思います。 USBの3.5インチHDDケースならパソコンショップで販売しています。 （自作パソコンSHOP） 大手の量販店だと無い場合もあります。 その場合は出費が増えますが、HDD付きのUSBHDDを購入して 載せ替える方法もあります。 交換して動作しない場合はHDDも故障していますので専門の修理会社に 依頼してください。 （相当な出費になる可能性があります） 参考URL：http://www.pc-info.sakura.ne.jp/hddnosyurui.html
レコード単位で削除するとそのレコードに 含まれるすべてのフィールドが削除されます。 IDのフィールドがオートナンバーや 自作関数によって番号を取得していると 欠番が生じます。オートナンバーの場合は 普通では欠番を埋めることはできません。 欠番を埋めるのはちょっとした工夫が 必要です。自作関数の場合はいくらでも 埋め戻しができますが。 以下にオートナンバーの欠番を埋める 方法があります。 http://oshiete1.watch.impress.co.jp/qa5737015.html
アクセスのメリット 1.一応データベース（の端くれ）であるので、作りやすい。 2.（エクセルに比べると）パフォーマンスが良い。 3.複数ユーザー対応することが（一応）可能である。 4.ＳＱＬＳｅｒｖｅｒへのアップサイジングや他のＤＢへの変更が容易である。 アクセスのデメリット 1.時々壊れる。 2.（エクセルを良く知っている人でも）取っ掛かりにくい場合がある。 3.クライアントに最低ランタイムが必要である。 エクセルのメリット 1.大体誰でも理解できる。 2.大体誰でも持っている。 3.互換ソフト等もあり、コストがほぼかからない。 エクセルのデメリット 1.遅い 2.同じ機能を持たせるためには、アクセスよりはるかに多いコーディングが必要になる。 3.データ数に限りがある。 4.複数ユーザー対応するのは困難である。 5.他のＤＢへの変更は原則的に作り直しになる。
あるいは、以下のような記述もあります。 SELECT T2.id, T2.pass, T2.biko FROM T2 UNION SELECT T1.id, T1.pass, T1.biko FROM T1 WHERE id NOT IN (SELECT id FROM T2);
sql文で一発です。 select ... into ... from ... left join ... on ... where ... みたいに。 sql はＤＢによりちょっと文法が違いますので、詳しくはｄｂ指定し、現在のテーブル名などと共に、再質問したほうが良いと思います。 また、どのようにｓｑｌを発行するかも、ｄｂ指定の上そちらのカテでご質問ください。
PCに、デジカメに付属していた、CDがあるはずですので そのCDをPCに入れて、その中の『写真管理ソフト』をインストールしてください。 デジカメをUSBでつなげば、ソフトが起動するはずです。 取り込みボタンが有ると思いますので、クリックして取り込んで ください。 あとは、わからなかったら『取り扱い説明書』を読んでください。
自分もあまり詳しくはないのですが、SDカードを経由するのがいいかと 携帯に合わせるためにmicroSDを購入し、後はパソコンにもつけられるよう、変換用アダプタを購入するべきですね この前auショップに行った時は、防水のものがセットで売られていましたよ お近くのauショップに行ってみてはいかがでしょうか？教えてもらえると思います
レポートに出力している内容が不明なのですが、 サブレポートのサイズを限界まで広げ、「印刷時拡張」を 「いいえ」にします。これで、ある限度以下の場合は 下のサブレポートが上に移動することはありません。 厄介なのが限度以上に明細がある場合です。 限度を10行と仮定すると、10行毎にグループが発生する ことになります。親レポートのクエリに工夫が必要です。 以下は一例です。 【親側のクエリ】 SELECT 0 AS G,* FROM 元クエリ WHERE 明細数<= 10 UNION ALL SELECT 1 AS G,* FROM 元クエリ WHERE 明細数 BETWEEN 11 AND 20 UNION ALL SELECT 2 AS G,* FROM 元クエリ WHERE 明細数 BETWEEN 21 AND 30 ORDER BY 1,2 ← "G" と　元クエリの最初の項目でソートする意味 明細が10以下なら１レコード、11～20なら２レコードという具合に 出力されるので、親レポートとして、伝票としては１個でもトリガを 複数にすることができる。 【子側のクエリ】 SELECT A.xx,A.yy,～,Int(COUNT(B.xx)/10) AS J FROM 元明細 AS A LEFT JOIN 元明細 AS B ON A.xx=B.xx AND A.dd>B.dd GROUP BY A.xx 例えば、日付の昇順に並ぶなら、自分の日付未満の日付のデータの数が 自分の順位(0から)になるわけです。 サブレポートのリンク条件としてはG=Jです。 Jは順位を10で割った商なので、0～9位は0、11～19位は1という具合に なります。 ちょっとヤヤコシイのですが、実現可能なはずですよ。
「技術者向」に「技術者が答えてくれる」かのような期待をお持ちの方が多いようですが、「技術者レベルの質問」と言う意味でしょう。また、「データベース」はソフトウェアの話しではないか　と。 さて、本題について・・・ ハードディスク自体が無事であれば、ハードディスクケースに移植すればデータ回収に難しいところはないと思われます。 が、 ＞半年ほど前なのですが大丈夫でしょうか？ やはり、ココが心配ですね。 ハードディスクがコーラを浴びて半年間放置していたとしたら・・・ハードディスクが腐食している可能性もあります。 ハードディスクやコネクタ（接点）が腐食していたら・・・ハードディスクケースに収容すること自体が困難である可能性も考えられます。
よく見れば。 確かに、このカテゴリーならSQLとか答えるべきでした。 でも、質問者さんはそのレベルではなかったようで。 >コマンドプロンプトって何ですか？ ここで説明するには欄が小さすぎるし、書くのも面倒です。 「コマンドプロンプト」で検索して「初めての」とか「入門」とか「講座」とかあるサイトを読んでください。
自力でインポートするしかないようですね。 Sub インポート() Dim SQL AS String Dim 行 AS String Dim 項目 'テーブルのデータを消去（必要に応じて） CurrentDb.Execute "DELETE * FROM hoge" 'テキストファイルを開く Open "C:\～\hoge.txt" For Input As #1 'EOFまでのループ Do Until EOF(1) 　　　　'１行読み込み 　　　　Line Input #1, 行 　　　　'カンマで分離 　　　　項目 = Split(行, ",") 　　　　'SQL構築 　　　　SQL = "INSERT INTO hoge VALUES" 　　　　SQL = SQL & "('" & 項目(0) & "'" 　　　　SQL = SQL & ",'" & 項目(1) & "'" 　　　　SQL = SQL & "," & 項目(2) & ")" 　　　　'SQL実行 　　　　CurrentDb.Execute SQL Loop Close End Sub
レポートフッタの領域にテキストボックスを２個設け、 コントロールソースをそれぞれ以下のように記述します。 =Sum(商品分類１) =Sum(商品分類２)
>・分割入力したほうがいいでしょうか？ >　都道府県、市区郡町村、以下の地名から番地まで、建物名 >　＊集計作業をするときは「○○市○○」までで集計する予定です。 「○○市○○」の部分まで分割することになります。 ここからはアドバイスですが 郵便番号を単位に集計する方法が考えられます。同様のことで事業部と話し合いをしたことがあります。 質問者と同じで、細かく集計できるようにと提案でしたが、郵便番号ベースの集計で満足を得られました。 理由として、MS-IMEには郵便番号辞書があったり、郵便番号から住所を得られるソフトが多数あるので、入力作業の時間短縮が可能です。 郵便番号　住所１　住所２　に分割して、住所１は郵便番号で得られる情報にしました。 （長いもには巻かれろ！　ですかね） 相手が法人であれば、会社名、部署名、担当者名などが必要になります。 郵便、宅配便の郵便番号を利用したシステムにも便利です（一例でいえば、宅配業者のデータ取り込みのシステムなど）。 集計も人口の分布（？）を考えると郵便番号単位で集計すると結果便利だった様です。 >（氏名の入力） >・氏名は、姓と名で分割したほうがいいでしょうか？ 入力の画面（フォーム）は分けて入力しますが、フィールド（列）は1つにしました。 必ず、姓と名の間には全角スペースが入る様にします。 万能を考えると出来るだけ細かく分割することになりますが、 集約するほうが使い安いということになります。 むやみにフィールド（列）を増やすのではなく、使用する部署との 打ち合わせを十分に行って目的に応じたデータベースにしてみてください。
もう答えでちゃってるけど、一応貼りますよ～。 …前回のはテーブル名抜けてましたね。(-_-;) select * from [table_name] where 個数 = ( select max(個数) from [table_name] where (個数 <= 350) AND (名前='あああ') )
いつも同じテーブルをエクスポートするのなら マクロの「データベース変換」を使えば メッセージは表示されませんが。
> 格納されているデータへ何か影響しますでしょうか。 影響しないはずですが、Alterを行う前には念のためのバックアップは必要でしょう。 同一インスタンス内に、列定義拡張済みの作業用テーブルを用意して、中身をコピー。 新旧テーブルの列比較して「データ内容が同一であること」を確認したら、 テーブルリネームすれば安心できるのでは？ （インデックスも合わせて定義または再作成が必要ですが）
>フォーム名!テキストボックス1 これで本当に動いていたのでしょうか？ 変数 = Forms!フォーム名!テキストボックス1.Value これが正しい構文ですけど・・・
・USBメモリを挿し直す ・PCを再起動する ・別のPCがあればそちらにUSBを挿してみる といったことは試しましたか？
[参考]OpenPNE http://www.openpne.jp/ [参考]Amazon.co.jp： OpenPNEによるSNSサイトの構築 オープンソース徹底活用: 荒木 祐二, 川井 義治, 小林 良正: 本 http://www.amazon.co.jp/OpenPNE%E3%81%AB%E3%82%8 … 書籍じゃなくても、ネット上に色々情報あると思いますが。
1辺の長さ/Cos(Radians(45)) だったらルートも要らない。。
こんな感じ SELECT A.日付,SUM(B.売上) AS 売上累計 FROM テーブル AS A LEFT JOIN テーブル AS B ON A.日付>=B.日付 [WHERE 日付等、商品など抽出条件] GROUP BY A.日付 WHERE句は抽出条件がなければ省略可能 尚、不等号の結合条件なので、SQLビューで 直接SQLを記述すること。(GUI操作できない)
SELECT テーブル.日付, Sum(テーブル.売上) AS 売上集計 FROM テーブル GROUP BY テーブル.日付;
＃３です コンボボックス「セミナー名」のクリック時イベントに以下を記述してみてください。 Private Sub セミナー名_Click() 　　Dim iNumS As Long 　　Dim vTmp As Variant 　　If (IsNull(Me.セミナー名)) Then 　　　　Me.受付番号 = Null 　　　　Exit Sub 　　End If 　　Select Case Me.セミナー名 　　　　Case "セミナーA": iNumS = 1000 　　　　Case "セミナーB": iNumS = 2000 　　　　Case "セミナーC": iNumS = 3000 　　End Select 　　Me.受付番号 = Nz(DMax("受付番号", "セミナー受付", "セミナー名 ='" & Me.セミナー名 & "'"), iNumS) + 1 End Sub ※　 選択したセミナー名の採番初期値を設定しておきます。 セミナー受付テーブルから、登録されているセミナー名の受付番号最大値を求めます。 なかったら、採番初期値＋１を、あったら、最大値＋１を受付番号に設定します。 ※　この書き方になるとセミナー名が変わったとか・・・で修正が必要になります。 そこでコンボボックスに非表示で採番初期値を設定しておきます。 テーブル「T講座一覧」 講座ID　講座名　　採番初期値 1　　　セミナーA　　1000 2　　　セミナーB　　2000 3　　　セミナーC　　3000 コンボボックスの値集合ソースは、 SELECT 講座名, 採番初期値 FROM T講座一覧 ORDER BY 講座名; として、 連結列：　１ 列数：　２ 列幅：4cm;0cm　（２列目を表示しないように0に：4部分は適当に） としておけば、 　　Select Case Me.セミナー名 　　　　Case "セミナーA": iNumS = 1000 　　　　Case "セミナーB": iNumS = 2000 　　　　Case "セミナーC": iNumS = 3000 　　End Select 部分は、 　　iNumS = Me.セミナー名.Column(1) で、後々修正が要らなくなります。 （テーブルの内容を書き換えるだけの修正になります）
再度アドバイスいたします。 ACCESSのMDB作成は、データやクエリ、フォーム、レポート・・・それらを動かすマクロ等・・・　手法はたくさんあるので、開発規模が小さいうちに色々なことを試してみてください。 （開発規模が大きくなると、先に回答された方の言うとおり、データベースやクエリの設計がシビアになっていきます） 以下　補足の回答の一例です。 ・データ入力時 入力用テーブル+フォームで蓄積用テーブルに対して「追加クエリ」 例：http://www.seta.media.ryukoku.ac.jp/manual/offic … ・データ検索時 蓄積用テーブルを元に検索条件指定を指定して「テーブル作成クエリ」→検索結果用テーブル+フォーム ※テーブル作成クエリにパラメータを指定する方法などを使用 ※データを不注意に破壊（削除、更新）しない自信があれば、当初のとおり蓄積用テーブルを参照しても良いかもしれません。 例：http://www.sk-access.com/Syo_Query/SqA009_Parame … ・データ削除や更新 検索結果用テーブルで蓄積用テーブルに対して、「削除クエリ」や「更新クエリ」を使用。（あらかじめ顧客コードなど唯一無二のフィールド（キー）を作っておく必要があります。） 例：http://www.nurs.or.jp/~ppoy/access/access/acQ010 … 例： http://makotowatana.ld.infoseek.co.jp/access/ach … 上記でよく使うクエリの種類は一通り使用するので、慣れてみてはいかがでしょうか？
iif(int(累計ポイント/1000)>0, int(累計ポイント/1000) & "000ポイントになりました！","") ではどうでしょう？ iif(int(累計ポイント/1000)>0, int(累計ポイント/1000) & "000ポイントになりました！","ポイント券発行まであと" & 1000 - 累計ポイント & "です") でも良いかも。
ACCESSからのアプローチでしたら (1)ACCESSでクエリを作る (2)クエリのデザイン画面で、メニューにある「SQLビュー」を押す (3)作ったクエリがSQLで表示される クエリ＝SQLです　
＃２です > vDt = DMax("見積り番号", "案件", "見積り番号 Like '" & Format(Date, "yy") & "*'") ↓これを今日固定で書きなおすと vDt = DMax("見積り番号", "案件", "見積り番号 Like '10*'") となります。 見積り番号が 10 で始まるものの中での最大見積り番号を得るものになります。 DMax のヘルプで使い方を見てください。 ３番目の引数には、条件を指定できます。 vDt = DMax("Right(見積り番号,4)", "案件", "見積り番号 Like '10*'") のように、得る段階で数字部分のみを抜き出すこともできますが、 私は素の値を得てから必要に応じて加工することを良くやります。
例えば、単価100円、個数20個のレコードで 　SELECT [単価文字列] + [個数文字列] AS 売上金額 FROM 売上テーブル のようなクエリを働かせると、 　この行では、10020 と文字の追加として表示されます。 しかし、同レコードで、 　SELECT [単価文字列] * [個数文字列] AS 売上金額 FROM 売上テーブル のようなクエリを働かせると、文字列を自動的に数値扱いにしてくれて、　2000 と表示されます。 これは、 / - の計算でも同様に計算されます。 　また、裏技的に、式の先頭に 0 + を付けて、 　SELECT 0 + [単価文字列] + [個数文字列] AS 売上金額 FROM 売上テーブル のようなクエリを働かせると、 　この行では、数値計算として2000 が表示されます。 　さらに、型変換(キャスト)関数を使って、 　SELECT CInt([単価文字列]) + CInt([個数文字列]) AS 売上金額 FROM 売上テーブル のようなクエリを働かせても、 　正しく、数値計算として2000 が表示されます。
該当コントロールの書式を以下のように設定します。 ;;;0 セミコロンで４個の書式を定義しています。 ＋の書式；－の書式；0の書式；Nullの書式 つまり、＋、－、０の場合は標準、Nullなら0と 表示すると言う意味です。また、金額なので、 \\#,#;-\\#,#;\\0;\\0 としても良いでしょう。
先ずBetweenは関数ではありません。 また、クエリ内にDSumなど持ち込むのは意味がありません。 日付の指定は"#2010/03/10#"とするか、DateSerialなら DateSerial(2010,3,10)となります。 (1)クエリビルダを起動させ、tblメインを選ぶ。 (2)問合数、日付をグリッドにドロップする。 (3)ツールバーの「表示」→「集計」をクリックする。 (4)問合数の集計を「合計」にする。 (5)日付の集計を「Where 条件」にする。 (6)日付の抽出条件に「BETWEEN #2010/3/1# AND #2010/3/31#」と 　　記述する。 抽出条件の記述は他にMonth(日付)=3のような方法もあります。 また、(5)の日付を上記のように「月:Year(日付)*100+Month(日付)」とし、 集計を「グループ化」にすると、年月別の問合数合計が得られます。
はじめまして、通りすがると申します。 上記ご質問の件なのですが、条件が曖昧のためご希望の回答は得られないと 思います。 まず、集計の対象の条件なのですが、文面には１－５、６－１０、１１－ １５とあるのに、例データには、土、日分はデータがなく５日分のデータ がずれて記載されてますね。これは日が固定でなく、休日がある場合、 たとえば、１－７日の集計があったり、その場合に８－１０の集計月があ るということでしょうか？ 対象外の集計日は、土、日以外に発生する可能性はあるのでしょうか？ たとえば、ゴールデンウィーク、正月、大みそか、お盆、そのた休日など 、このようなことを考慮するのであれば、おそらく関数だけでは無理と思い ます。（関数で行うためには、固定的にデータを特定できる条件が必要） また、日と曜日、数式だけでも判断はできないと思います。 少なくとも、項目として計算対象か否かを判断する条件が必要と思います。 （数式が入っていないからといって、対象外とは限らない） ロジックを考える前に、条件を整理するところから検討しては如何でしょ か？
はずしていたらごめんということで、 SELECT テーブルB.商品ID, テーブルB.商品名 FROM テーブルA LEFT JOIN テーブルB ON (テーブルA.商品名 = テーブルB.商品名) AND (テーブルA.商品ID = テーブ ルB.商品ID) WHERE (((テーブルB.商品ID) Is Not Null) AND ((テーブルB.商品名) Is Not Null)); または SELECT テーブルA.商品ID, テーブルA.商品名 FROM テーブルA RIGHT JOIN テーブルB ON (テーブルA.商品名 = テーブルB.商品名) AND (テーブルA.商品ID = テーブ ルB.商品ID) WHERE (((テーブルA.商品ID) Is Not Null) AND ((テーブルA.商品名) Is Not Null)); 結果は同じことですが。
No.1です。 > 試しに2007版で新規ＤＢに新規フォームを作成し、試してみましたがダメでした。 > また、Accessオプションでは「次のフィールド」となっていました。 ご質問のファイル(の特定フォーム)に限った話であれば、或いはフォームの プロパティシートの「キーボードイベント取得」プロパティが「はい」になっていて マクロ/VBAで何らかの処理がされているのかとも思いましたが、 新規DBの新規フォームでも同様の症状だとすると、ご自宅のPCのAccessに なんらかの異常が発生している可能性が高いと思います。 面倒かとは思いますが(汗)、「アプリケーションの修復」もしくは「再インストール」を 試してみてください。 (修復は、コントロールパネルから『プログラムの追加と削除』を起動し、 　Access2007又はOffice2007を選択すると表示される『変更』ボタンをクリックして、 　ウィザード(?)から実行できます) すみません、これでも解決しないとなると私ではちょっと対処法が思い浮かびません(汗)
>１行分だけ表示したい これは希望であって、現実ではありません。 内容が同じかどうかは人間だけが分かっている ことがらです。SQLにはDISTINCTと言う指定が あり、これは出力されるフィールド内容が全て 同じデータは１行のみになるというものです。 クエリが５行あったら、明細行も５行でなければ 使い物になりませんよね。クエリが１行になる ようにSQLを組み立てるべきです。
自力で更新すれば良いのでは？ Sub 記事欄_AfterUpdate() '★ Dim SQL As String SQL = "UPDATE テーブル SET 記事欄='" SQL = SQL & Replace(Me.記事欄.Value、"'", "''") SQL = SQL & "' WHERE ログインID='" SQL = SQL & Me.ログインID.Value & "'" CurrentDb.Execute SQL End Sub ★フォームの記事欄のイベントで、 「更新後処理」を選び、コードビルダを 起動します。あとは回答を参照してください。 レコードセットを使う方法もありますが、 更新SQLの方がずっと高速です。 先ず、非連結フォーム（テーブルやクエリに 関連しない）ではフィールド内容は何処にも 反映されません。また、連結であっても、 更新可能でないクエリであれば、当然ですが 更新できません。
>番号を進まない時があります ひょっとして「案件テーブル」の 見積り番号の更新、あるいは レコードの追加がうまく行われなかった ということが一番の現象の発端で、 これがどこに由来するかは、 プログラムなのか、全体の イベントの流れなのか、 あるいはファイルの肥大によるもの なのかはわかりません・・・・、 ということも考えられます。
シート１とかあるのでエクセルであろうと思いますが、スプレシードにある機能をそのまま使えばいいだけですが？　選択した行とか、取得できますよね。フィルターとかバージョンが違っても付いていますよね。 アクセスでも、キュエリーで、行を選択。イベントトリガーが取得できますよね？ ＞フォームから選ぶのが大変で、 ＤＢとして扱えばＳＱＬで、できますよね？　ADOstreamでもできます。
H2を知らないケド。Oracleだったら。 select ID, MIN(TAG) from A GROUP BY ID ORDER BY ID ではどうでしょう？ select ID, MAX(TAG) from A GROUP BY ID ORDER BY ID もお試しください。
いくつかの方法があります。 (1) 質問の末尾の場合。 あらかじめ、リレーションが張られて いる場合は一旦リレーションを 削除します。 質問のように最後のレコードの場合、 テーブルをデザインビューにし、 オートナンバーのフィールドを 数値型に変更し、保存します。 次に新しいフィールドに別名で オートナンバーを登録し、保存します。 テーブルを開いてみます。データが 思い通りになっていたら、数値型の フィールドを削除し、オートナンバー のフィールド名を必要な名前に変更し、 保存します。 必要ならば、リレーションを張りなおします。 (2) そのほかいろいろな場合の方法がありますが、 以下に例とサイトがあります。参考にしてください。 http://oshiete1.watch.impress.co.jp/qa5734176.html
でしょうね。PowerPointでも140cmほどが限界ですから。 データベースで360cmってどこの勧進帳だよって感じですが、小計な どがあって単純な書き出しでは面倒なことになるのなら、51.4cmで レポートを作成して7倍拡大印刷(当然幅も)くらいしか手口はないと 思います。拡大印刷についてはプリンタドライバの設定か、同梱さ れたユーティリティでやることになりますね。プリンタの説明書に 長尺印刷についての記載がありませんか。
「常に1つのフォームだけが開いた状態」にしたいということでよろしければ、 以下のようなマクロを作成し、3つのフォームの『開くとき』イベントで 実行させれば、おおむねOKです。 ※「おおむね」の理由については後述。 <アクション> 　閉じる <引数> 　オブジェクトの種類：　フォーム 　オブジェクト名：　=Screen.ActiveForm.Name 　※先頭に「=」が必須となるのでご注意下さい。 　　(なお、入力後は自動的に角括弧で括られます) 「Screen.ActiveForm.Name」は、現在アクティブになっているフォームを 確認できるので重宝します。 但し、最初にフォームを開くときはアクティブなフォームがないために、 エラーになってしまうという問題があります(→上で「おおむね」とした理由)。 これを回避するために、新たにダミーのフォームを作成して、Autoexec マクロか『起動時の設定』で開くフォームにはこれを指定した上で、 そのフォームをアクティブにしてから、ユーザーが最初に触るフォームを 開くようにしてください。 【ダミーフォームの『開くとき』イベントに組み込むマクロ】 全部で2つのアクションになります。 <アクション> 　値の代入 <引数> 　アイテム：　Forms!ダミーフォーム.Visible 　式：　True 　※ダミーフォームを強制的にアクティブ化 <アクション> 　フォームを開く <引数> 　フォーム名： (「履歴」「新規」「検索」のどれか) ※最初に開くフォームをAutoexecマクロで開いている場合は、『開くとき』 　イベントに組み込む代わりに、同マクロに直接、 　　　『フォームを開く』(ダミーフォーム) 　　　『値の代入』(Forms!ダミーフォーム.Visibleへの代入) 　　　『フォームを開く』(「履歴」「新規」「検索」のどれか) 　を組み込む形でも可です。
ちょっと試してみました。色々なやり方があるでしょうが、取り敢えず「親子フォーム」で。 試験に利用したテーブル 名称：連番 フィールド：id　一つだけフィールドがあり 1,2,3,4,5,6,7 と連番が入っています。 クエリ（SQL文）を SELECT 連番.id, Int([id]/8) AS g FROM 連番; とすれば８個ずつ　g　が同じ値を持ちます。このクエリをレコードソースとして、既定のビューを帳票フォームとしてフォームを作成します。 親フォーム方は 1 ずつ増えるデータ（今回は面倒なので「連番」テーブルを使用）をテキストボックスなどに連結し、親子関係を 親　id　＜＝＞　g　子 で作れば、８個ずつ表示されるようになります。
質問を読んで思うのですが、リスト１とリスト２は並び順が違うだけですね。 リスト２の並び順には、何らかのルールがあるのでしょうか。 もしそうであれば、リスト１をコピィして、並び替えては如何でしょうか？ リストの並び順にルールがなくて、現在の並び順を変更したくないというのであれば リスト１に作業列を加えます。リスト２がリスト２というシート名だとして 売上合計の隣にでも　=MATCH(A2,リスト２!A:A,FALSE) 下へコピィしておきます。 リスト１にリスト２では何行目にあるのかが数値ででます。 リスト２にない場合はエラーが表示されますので、これをコピィして阿値にして貼り付け、作業列の順番に並び替えれば、ご希望の表になると思います。
ブックを開いた順番に番号を割り振っているので、閉じない限り番号は維持されます。 ＞上記の操作をした後にマクロを実行すると 実行するマクロが不明なので解りません。 ブックやシートを指定しないコードなら、最後にアクティブになっているシートに対して実行されます。
Currentproject.Path で、現在の MDB のフォルダが取得できます。
どうしても気になったので一応最初のフォームでの やり方を説明しておきます。 questionkingさんの回答からレポートのヘッダが わかりましたので、以下のようにラベルの 移動、ヘッダの構成を行ってください 顧客IDのフッタは並べ替え/グループ化を 選択し、顧客IDを選択し、グループフッタを 「はい」にすると表示されます。 ####################################### メインレポート： ーーーーーレポートヘッダーーーーー ーーーーーページヘッダーーーーーー 「ラベル類」 ーーーーーーー詳細ーーーーーーー 「サブレポート」 ーーーーー顧客IDフッターーーーーー ーーーーーページフッターーーーーー ーーーーーレポートフッターーーーー ###################################### サブレポート： ーーーーーレポートヘッダーーーーー 「ラベル類」 ーーーーーーー詳細ーーーーーーーー 「テキストボックス類」 ーーーーーレポートヘッダーーーーー ###################################### サブレポートは最初のもので動けばそれで もいいです。 このように構成をした後に、顧客IDフッタ の上で右クリックしてプロパティを選択し、 改ページの欄の「カレントレコードの後」を 選択します。 レポートフッタの下の部分には余分な余白を 残さずレポートフッタに入れ込んでください。 残っていると余分なページが表示されます。 設定がおなじであれば、これで望みのレポート になるはずです。 ミソは改ページの欄の「カレントレコードの後」 の設定です。これはレポートの構造がわから ないと設定できないプロパティです。 もしうまくいったら何がポイントだったか おぼえておいてください。この レポートをいじくってみてください。 回答者さんが熱心に回答されていたので 回答をひかえたのですが、questionkingさんが 熱心だったので回答を寄せておきます。 また、以下に先で役立つレポートを公開 されています。ヘッダ、書式設定、 改ページコントロールなどの使い方、 ヘッダなどの各コントロールのイベント などを使えるようになるとレポートは自在です。 あとはquestionkingさんが考えておられる ような方向でいいです。 何かあれば書き込んでください。では。 http://www.ynsk.co.jp/ http://www.msactry.com/ http://homepage2.nifty.com/MrUr/katuyo/index.htm
Access2007を含め、SQL Server 2008を正式にサポートしているadpはないはずです。 SQL Server 2008ではいくつも新しいデータ型が追加されましたが、それらはサポートされませんし、書かれているようにオブジェクトの保存もadp側からはできず、SSMSで対応する必要があります。 SQL Server 2005であれば、保存できるはずです。 SQL Server 2008も、Access2010までいけばサポートされるかもしれません。 http://technet.microsoft.com/ja-jp/library/cc179 …(office.14).aspx#BKMK_WhatsNew
サブクエリではないので、ご希望の回答ではないと思いますが、 こういう手法もあるよという意味で、ご参考までに。 連番の意味を取り違えていたら、捨ててください。 参考URL：http://www.f3.dion.ne.jp/~element/msaccess/AcTip …
素人ですので、間違っているかもしれませんが、 他の（本格的？）なｄｂについては、ロールバックの機能があるので、 ログとして残されているものの簡単に取り出せる情報として 提供されていないと思います。 そのため、そのような情報が必要な場合は、テーブルにそのような情報を 持たせます。
VBAを動作させる環境が手元に無いので確認が取れないのですが、VB6や.net以降では、名前空間を事前に宣言できるImportsステートメントという物があります。 そこで、DAOを宣言されているのだと思います。 その場合、 Dim myDB As DAO.Database　を　Dim myDB As Database　と書くことができるようになります。 Importsステートメントのい使用は、プログラムの先頭に宣言する必要があります。 プログラムの先頭(ソースコードの先頭行付近)に 「Imports DAO」の宣言があると思われます。
>「数値型」でもいいじゃないの？ 「いいじゃない」レベルではありません。 金額を扱う場合は演算誤差を避ける必要が あります。２進法を使う限り実数演算では 誤差が出ます。 よって、通貨型も適切ではありません。 数値型→十進型を使うべきです。 データ容量、演算速度とも不利ですが、 人間の計算と同じ結果になるのが最大の メリットです。 それに、容量や速度と言っても、僅かな 問題です。
あちゃ書き間違ってた。ごめんなさい。 command +vでペーストですから option+command +vです。optionキー押しながら編集メニューを 開くと、「ペースト」が「テキストのみペースト」に変わります。
データベースにおいてはデータを取り出す際にどのような順番で取り出すかを指定することになっています。 1　10　11　2　3　4　5　6　7　8　9 となるのは、取り出したデータを文字列として扱いその順番に並べているからです。 1　2　3　4　5　6　7　8　9　10　11 とするためには、数値の順番で並べる必要があります。 お使いのデータベースの種類や取り出し方を提示していただければ、具体的手法に言及できるかもしれません。
> データベースウィンドウ全体（2007だとナビゲーションウィンドウ）を > 隠す方法は知ってますが、違う方法を考えています。 ワークグループ情報ファイル(拡張子「.mdw」)を使用したユーザーレベル セキュリティを使用する、という方法があります。 これを使用すれば、制限が必要なテーブルに限定して、追加・削除・ 更新の可否を、それぞれ個別に指定することもできます。 但し、Access2007ではこれを新規に適用する手段は用意されていない ので、この機能を使用する場合は、Access2003で設定することに なります。 (Access2007では、新規適用はできませんが、旧バージョンで適用した 　ものを使用することはできます) http://office.microsoft.com/ja-jp/access/HA10198 … (「Office Access 2007 とユーザーレベル セキュリティ」で検索して下さい： 　ページ最下方になります) こちらも参考に： http://office.microsoft.com/ja-jp/access/HA10234 … http://office.microsoft.com/ja-jp/access/HA10166 … ・・・ただ、これを実際に使おうとすると、かなり深みにはまる場合が ありますので、ご注意下さい(汗) http://oshiete1.goo.ne.jp/qa5702534.html
If（データの有無）により開くフォームが違うようです。 "F_基本情報入力"：データなし "F_基本情報"：データあり だとするとレコードソースも違う可能性があります。 何故、違うフォームなんでしょうね？ 単に「追加」を許す/許さないという仕分けでしょうか。 だったら、やはりAllowAdditionsプロパティを変える だけで済む話なんですけどね。（その他、更新や削除も 同様のプロパティがあり、動的に変更可能です） まぁ、画面タイトルや色使いなど違いを持たせているなら、 口出しするところではないですが・・・ ★該当データが無ければ、自動的に新規登録になります。 これは「追加を許す」場合の話です。こういう条件の場合、 データグリッドは「抽出されたデータ＋新規用の空データ」 という具合になります。「抽出されたデータ」なければ 「新規用の空データ」だけが残るという理屈です。
アクセスのグラフをはじめて使ってみました。 グラフクエリの場合は 集計方法の段階で「なし」を選ぶと良いようです。 若しくは、グラフをデザインビューで開き プロパティのデータのタブにある値集合ソースを SELECT ＩＤ, 比率 FROM table1; とかえても表示されると思います。
> 更に、「テーブルＢ」の年齢と「クエリ１」の年齢をリレーション(多対1？)して > 「クエリ２」としました。 使用されているのがAccessなのでしたら、テーブルBとクエリ1を結合させるのではなく、 クエリ1の『年齢』をコンボボックス表示にされてはいかがでしょうか。 添付画像のようなクエリを作成したら、「項目: 年齢」のフィールドのプロパティシートで 『ルックアップ』タブを選択し、『表示コントロール』に「コンボボックス」を指定します。 そうすると、その下に新たに項目が表示されるので、以下のように設定してください： 値集合タイプ：　テーブル/クエリ 値集合ソース：　テーブルB 連結列：　　　　 1 列数：　　　　　　2 列幅：　　　　　　0cm;3cm ([「3cm」の方は適当でOkです) これなら、クエリ1(テーブルとしてはテーブルA)だけが元になっているので、演算を行って いない氏名や生まれ年のフィールドの編集に制限は掛かりません。
質問の意味が不明です。 多対多のリレーションは、関連づけのためのテーブルをもう一つ用意しますが、そんなことを訊いているのではないですよね？
まず質問者が使っているレンタルサーバで使えるDBはなにか? 定番だと ・MySQL ・PostgreSQL ・SQLite でしょう。 そのどれが使えるか? 使えるならCMSを使うかゼロからプログラミングして構築する。 ゼロから開発する場合ならDBが使えなくてもCSV形式やXML形式でデータ管理すればなんとかなるでしょう。 DBを使うにしても手軽さだとSQLite,MySQL,PostgreSQLの順番かな。 CMSまで使わないにしても手軽にやりたいなら http://www.cgi-amigo.com/ これかな。
＃１、＃２です > また今度よろしくお願いします 私が悪かったです。 フォーム系のことならいろいろと考えれると思います、が、 レポートの凝ったものになると・・・ 凝ってない（？）のかもしれませんが。 私は自力でEXCEL出力するたちなので、レポートはほとんど使ったことが・・・ （じゃ、回答するなって・・・） 失礼しました。
これらは Access のシステムオブジェクトです。 決して削除してはいけません。 消去する方法、 というか、見えなくするには メニューバーの [ツール] - [オプション] - [表示]タブで 「システムオブジェクト」のチェックをオフにしてください。
回答が付かないようなので、極大雑把な設計方針を。 テーブルは複数フィールドにまたがって主キーの設定が出来ます。そこで「年月」と「職員ID」を主キーに設定すれば、二重登録しようとするとエラーになります。 上記のような仕組みを利用すれば出来るはずですが、クエリーとマクロだけで出来るか、検証していません。
Union All を使えば比較的かんたんかな？ Select　to_char(テスト日時,'YYMMDD'), 'A' As 科目, 科目Ａ Form テーブル名 Where ・・・ Union All Select　to_char(テスト日時,'YYMMDD'), 'B' As 科目, 科目B Form テーブル名 Where ・・・ Union All Select　to_char(テスト日時,'YYMMDD'), 'C' As 科目, 科目C Form テーブル名 Where ・・・ 他には、 Select テスト日時,科目Ａ,科目Ｂ,科目Ｃ From テーブル名 Where ・・・・ で取り込んで、DavtaGridViewに表示する際に表示を変える方法ですね。 リンク先のようにDatagridViewにプログラムでカラムを追加後に、各行のデータを形式に合わせて入れていく方法です。 値の設定は、ループを使えば目的の表示もできます。 日付はFormat関数を使えば変更できます。 参考URL：http://homepage1.nifty.com/rucio/main/dotnet/Sam …
scriptから実行したことがないので、エラー内容がよくわかりませんが、 一度目でできなくてその後できるようになるというのは、timeoutを食らっている可能性があると思います。 objCon.ConnectionTimeout の値を倍くらいに設定してみたら何か変わりますか？ 若しくは、ＶＢ（Ａ）から同じコードを投げたら、別のエラーメッセージが帰ってきますか？
フォームを保存せずに閉じて特に問題が なければ、 ボタンを一つ追加。 ボタンのクリックイベントで DoCmd.SetWarnings False DoCmd.Close acForm, Me.Name, acSaveNo としたらどうですか。
＃２です > 入力用フォームのほうにはある「区分」が用意されており、区分コードをコンボボックスで選択する作りになっています。 > その場合でも、１つのフォームでできるのでしょうか？ > 「表示フォーム」は区分コードに紐づいている「区分名」が表示されるようにしてあります。 コンボボックスの内容（連結列）が同じであれば、同様に既定値を設定できます。 コンボボックス名が「cbx01」だったとします。 表示の元となる区分テーブル「T区分」が以下だったとします。 区分コード　区分名 1　　　　　　区分A 2　　　　　　区分B 3　　　　　　区分C 4　　　　　　区分D 5　　　　　　区分E コンボボックスの値集合ソースが SELECT 区分コード, 区分名 FROM T区分; 連結列：１ 列数：２ 表示フォームでの列幅：　0cm;2cm （１列目を表示しない：区分名だけ表示） 入力フォームでの列幅：　2cm;0cm （２列目を表示しない：区分コードだけ表示） この設定で、コンボボックスに表示されるものは変わりますが、連結されているものは「区分コード」になっているので、 Me.cbx01.DefaultValue = Screen.ActiveForm.cbx01 で既定値を設定することができます。 （起動元に同様のコンボボックスがあったとして） 表示用/入力用ともコントロールソースには「区分コード」に対応するフィールドを指定していると思いますので、問題なさそうな気がします。 なお、起動元に「区分名」しかない時とかは、その時のテキストボックス名を「txt1」とすると、 Me.cbx01.DefaultValue = _ 　　DLookup("区分コード", "T区分", "区分名 = '" & Screen.ActiveForm.txt1 & "'") とすれば既定値として設定できます。 列幅（表示）の切り替えは、ColumnWidths で変更します。 列幅が上記例であるとすれば、 レコードがあったら、Me.cbx01.ColumnWidths = "0cm;2cm" 入力用なら、Me.cbx01.ColumnWidths = "2cm;0cm" と設定すれば、表示は切り替わります。
幾つか方法はありますが、比較的わかりやすいと思われる、DCount関数で レコードの有無を確認し、If文で条件分岐、という方法をご紹介します： '【ウィザードで作られたVBA(コマンドボタン名=コマンド3)】 Private Sub コマンド3_Click() On Error GoTo Err_コマンド3_Click 　　Dim stDocName As String 　　Dim stLinkCriteria As String 　　stDocName = "フォームB" 　　 　　stLinkCriteria = "[ID]=" & Me![ID] 　　DoCmd.OpenForm stDocName, , , stLinkCriteria Exit_コマンド3_Click: 　　Exit Sub Err_コマンド3_Click: 　　MsgBox Err.Description 　　Resume Exit_コマンド3_Click 　　 End Sub '【加筆修正したコード】 Private Sub コマンド3_Click() On Error GoTo Err_コマンド3_Click 　　Dim stDocName As String 　　Dim stLinkCriteria As String 　　 　　stLinkCriteria = "[ID]=" & Me![ID] 　　'DCountの結果で、開くフォーム名(→stDocName)を切替 　　If DCount("*", "フォームBの元テーブル", stLinkCriteria) = 0 Then 　　　　stDocName = "フォームC"　　'レコード不在(=0)時はフォームCを指定 　　　　DoCmd.OpenForm stDocName　　'stLinkCriteriaは使用しません 　　Else 　　　　stDocName = "フォームB"　　'レコード存在時はフォームBを指定 　　　　DoCmd.OpenForm stDocName, , , stLinkCriteria 　　End If Exit_コマンド3_Click: 　　Exit Sub Err_コマンド3_Click: 　　MsgBox Err.Description 　　Resume Exit_コマンド3_Click 　　 End Sub ・・・以上です。 なお、コードの理解を最優先に考え、「ID自体が空白(Null)」といった場合の 例外処理は入れていません。 (呼び出しもとのフォームAが、そういうデータを表示しない場合、杞憂という 　ことにもなりますので・・・)
作成者であれば、レコードの排他制御とかの問題は否定できているのかな。 あとは、インストールされているプリンタの状況とかによって、 レポートの余白とかが変わってくることはあると思いますが、 内容に影響することはないですよね。 次のステップとしては、 ローカルにmdbをコピーした場合何が起こるか、 リンクテーブルで処理した場合何が起こるか、 などを検証していくことになると思います。
どうも駄目っぽいですね（私が知らないだけかもしれませんが） 以下の方法２つを考えてみました。（遅かったらごめんなさい） １）ユーザ定義関数を使用する ２）コンボボックスで選んだ時、不可視のテキストボックスに値を代入しておいて、クエリではテキストボックス側を参照する フォーム名を「F1」、コンボボックス名を「cbx01」と仮定します。 １）ユーザ定義関数を使用する 以下の内容で、標準モジュールに関数を記述します。 Public Function myCombo(sCombo As String, iNum As Integer) As Variant 　　On Error Resume Next 　　myCombo = Eval(sCombo & ".Column(" & iNum & ")") 　　If (IsError(myCombo)) Then myCombo = Null End Function クエリの方では、2つ目を参照したかったら以下の様に記述します。 myCombo("[Forms]![F1]![cbx01]",1) 参照でエラーになったら Null で戻るので、その処理は入れてください。 ２）コンボボックスで選んだ時、不可視のテキストボックスに値を代入しておいて、クエリではテキストボックス側を参照する フォームヘッダ（フッター）部に、不可視のテキストボックスを配置します。 テキストボックス名を「txt_cbx2」（2列目用）、「txt_cbx3」（３列目用）と仮定します。 コンボボックスのクリック時イベントで以下を記述します。 Private Sub cbx01_Click() 　　If (Not IsNull(Me.cbx01)) Then 　　　　Me.txt_cbx2 = Me.cbx01.Column(1) 　　　　Me.txt_cbx3 = Me.cbx01.Column(2) 　　Else 　　　　Me.txt_cbx2 = Null 　　　　Me.txt_cbx3 = Null 　　End If End Sub マクロでするなら、 条件：　Not IsNull([cbx01]) アクション：　値の代入 アイテム：　[txt_cbx2]　　　式：　[cbx01].[Column](1) 条件：　...　　（半角ピリオド３つ） アクション：　値の代入 アイテム：　[txt_cbx3]　　　式：　[cbx01].[Column](2) 条件：　...　　（半角ピリオド３つ） アクション：　マクロの中止 条件：　（空欄） アクション：　値の代入 アイテム：　[txt_cbx2]　　　式：　Null 条件：　（空欄） アクション：　値の代入 アイテム：　[txt_cbx3]　　　式：　Null クエリからは、[Forms]![F1]![txt_cbx2] とか [Forms]![F1]![txt_cbx3] で参照するようにします。
＜店名＞＝店Ａ この部分はフォームヘッダなのでしょうか？ 正解は「現在のカレント行の店名」です。 行が変わる度に、ここも内容が変化しますが、 変化前と、変化後が同じなので「分からない」 というのが実相です。しかし、同じ内容なら 出所が何処でも気にする必要はないと考える 人が多いなか、こういう点を疑問に思うことは なかなか見上げた心がけだと思いますよ。
　意外と回答が付かないようなので、基本的な操作しか知らないのですが、助言差し上げます。 　まず、クライアント側で作ったＳＱＬコマンド文字列を、直接sqlite_query( )命令に埋め込むことは可能です。しかし、もしこのPHPファイルの仕組みを悪用する相手が、DROP TABLE コマンドをくっつけて呼び出してきたら、データベースが壊されてしまうでしょう。また勝手に )で閉じてめちゃくちゃなhtmlタグを入れると、好き勝手なPHPコマンドを割り込まされる可能性もあります。これは大変なセキュリティホールになってしまいます。クロスサイトスクリプティング攻撃もしくはＳＱＬインジェクション攻撃を調べてみて下さい。 　その対策としては、htmlspecialchars()関数やstripcslashes()関数などで受け取った文字列を置き換えて、勝手なプログラム動作が起きないようにします。 　思惑の画像ファイル抽出をしたければ、必要な変数（ファイル名の一部、ファイルサイズ上限、ファイルの日付範囲、ファイル形式など）のみをフォームから受け付け、クエリ文字列やヘッダ情報として受け渡して、文字列をチェックした後に、ＰＨＰプログラム中で生成するＳＱＬ文の中に組み込み、sqlite_query()命令で実行させる手順をとるべきです。
あ、必ず日付から入力するのでしたらこれはどうかな。 1.合体2=日付 & "-" & 部屋番号というテキストフィールドを作る。 　自動入力にして式はCase( not IsEmpty(部屋番号), 日付 & "-" & 部屋番号) 2.これを照合フィールドとして自己リレーションを設定する。 3.合体2の制限はユニーク値ではなく計算式=Count(自己リレーション::合体2) = 0で制限。
常々言っていることですが、理論の構築が大切です。 目的は「商品から見て、同時に購入される他の商品」 ということですよね。図解は以下の通りです。 商品－顧客⇒顧客－商品（但し、右の商品は左の商品以外） buy1とかbuy2が何を意味するか不明なのですが、購入された 数という意味なら、右側商品のレコード件数になります。 尚、後々のため、右側の商品IDも取っておきましょう。 これをそのままSQLにします。 SELECT Max(C.id) As id,A.item,B.item as douji, Max(D.id) As douid,Count(B.item) As buy FROM ((tbl As A INNER JOIN tbl AS B ON A.user=B.user) INNER JOIN item As C ON A.item=C.item) INNER JOIN item AS D ON B.item=D.item WHERE B.item<>A.item GROUP BY A.item,B.item これで縦には並ぶようになると思います。これをqryという クエリとして登録します。これを横にするにはもう少し 工夫が必要になります。「横に並べる」ためには列の位置を 決めるための項目が必要なので、以下のように仮定します。 (1)レコード件数の多い順 (2)レコード件数が同じ場合は同時購入商品IDの小さい順 SELECT A.id,A.item,A.douji,Count(B.id)+1 AS COL FROM qry AS A LEFT JOIN qry AS B ON A.id=B.id AND (A.buy<b.buy OR (A.buy=B.buy AND A.douid>B.douid)) GROUP BY A.id,A.item,A.douji ※Count(B.id)+1 これが並び順を示す列位置項目です。 このクエリをqry2として登録します。 縦を横にするにはAccessは便利で、Transferクエリを 使います。 TRANSFORM Max(A.douji) SELECT A.id,A.item FROM qry2 AS A GROUP BY A.id,A.item PIVOT A.COL 横に並べる方式が今一つ不明ですが、イメージに 近いものができると思います。
SQLを考える場合は理論の構築が大切です。 先ず、「最後に記録されたレコード」とは何か？ 「時間が最も大きい」ということですね。・・・(1) SELECT メンバー,Max(時間) AS 最後 FROM 行動 GROUP BY メンバー この最大値と同じ時間を持つレコードが目的のものです。・・・(2) SELECT A.メンバー,A.場所,A.時間 FROM 行動 A INNER JOIN (SELECT メンバー,Max(時間) AS 最後 FROM 行動 GROUP BY メンバー) B ON A.時間=B.最後 氏名が分からないので、メンバーと結合します。・・・(3) SELECT A.メンバー,C.名前,A.場所,A.時間 FROM (行動 A INNER JOIN (SELECT メンバー,Max(時間) AS 最後 FROM 行動 GROUP BY メンバー) B ON A.時間=B.最後) INNER JOIN メンバー C ON A.メンバー=C.メンバー 即ち、１回のクエリで目的の情報は得られます。 SQLではプログラムのようにステップが無いので、 理論の構築とそれを表現するセンスが大切になります。 DBシステム、バージョンが記載されていないので、 結合式（JOIN句）の書式が一致しないかも知れません。 尚、Max関数はLast関数と異なり、殆ど全てのDBシステムで サポートされています。
> Me.Filter = 伝票チェック = 0 ↓以下に変えてみてください。 Me.Filter = "伝票チェック = 0" 元のままだと、伝票チェック が 0　ですか？という結果（True/False）が Me.Filter に代入されることになると思います。
はじめまして、通りすがると申します。 上記ご質問の件なのですが、関数等を使用しなくてもexcelの機能で できそうな気がするのですが．． 　メニューより、データ：集計 　EXCEL2007でしたら、データ：小計　 ではダメでしょうか？
お疲れ様です。 私も勉強中です。（ＴＴ） お気持ちの「まったく理解できません」はとても良く分かります。 私のやりかたは、全部理解しようとせず、今日は１個とかにしています。 あなたが能力がないのではく 「まったく理解できません」＝いっぱい覚えることがある ということだと思います。 なんのアドバイスにもなってませんが、それではーー☆
> 集計 は、絞込み表示になりますか。 最近のQAでいえば、以下が参考になると思います。 Access チェックボックスを利用した絞込検索のクエリ記述 http://oshiete1.goo.ne.jp/qa5554301.html
テーブルAの名前を「TA」、テーブルBの名前を「TB」とした時、 UPDATE TA RIGHT JOIN TB ON TA.社員番号=TB.従業員コード SET TA.社員番号 = TB.従業員コード, TA.社員氏名 = TB.社員氏名, TA.フリガナ = TB.従業員名カナ, TA.部署コード = TB.所属コード WHERE TA.社員番号 Is Null; では、どうでしょうか。
> 小計の部分を「テキスト10」でＳｕｍを行う > 事はできないのでしょうか？ http://office.microsoft.com/ja-jp/access/HP05187 … こちらの フォームまたはレポートで合計または平均を計算する の メモの欄に詳しく書かれています。
エクセルのデータはそのまま、殆ど手を煩わすことなくアクセスのテーブルにすることが出来ますので、挑戦されることをおすすめします。あらかじめアクセスの新規ファイルを作っておいて、空っぽでもいいですから、そしてそこにエクセルのデータを読み込むという手順になると思います。 マスターテーブル、クエリーなどの構想は追って検討されたらよいです。取引先、商品はマスターにふさわしいです。しかし出庫はマスターというよりもクエリーとすべきでしょう。というのは出庫のなかには当然取引先、商品を入れなければならず、そうすると同じ項目が複数のマスターにあるというのは賢いことではないです。取引先、商品は出庫クエリーのなかではコードで参照するのがいいと思います。
＞できれば、そのやり方を教えていただければ幸いです。よろしくお願いいたします。 ＃２さんが書かれた通りです。 [Ctrl]+[A] で、全選択。必要な範囲をマウスでドラッグして範囲選択する事もできます。 [Ctrl]+[C] コピー [Ctrl]+[V] 貼り付け どのアプリでも上記ショートカットは可能です。 Ｗｅｂサイトの場合、コピー禁止の場合があるので画面キャプチャするしかないです。 コピーできるのは、画面に表示されている範囲だけなので、見えない部分のコピーはできませんから、その場合はスクロールさせて再度コピーするしかありません。 [PrintScreen] （全画面） や [Alt]+[PrintScreen] （アクティブウィンドウ）で、コピーできますから、[Ctrl]+[V] でエクセルに画像として貼る事もできます。
> (1)連結テキスト＋ラベルの方法しか「人」を表示することはできないのでしょうか？ 連結テキストボックスに入る値が数値であれば、書式プロパティに 「0\人」とか「0"[人]"」と入力すれば、そのように表示されます。 書式プロパティには他にも書式指定文字を使えますので、詳細は ヘルプにてご確認ください。 > (2)合計人数　と　［合計人数］　は意味が違うのだと思いますが具体的にはなにが違うのでしょうか？ コントロールソースに「合計人数」と設定した場合は、レポートの レコードソースにあるフィールド「合計人数」に連結していることを 示します。 一方、コントロールソースに「＝［合計人数］＋”［人］”」と設定した場合の 「[合計人数]」は、レポートのプロパティ「合計人数」を参照する ことを示します。したがって、レポート上に「合計人数」という名前の 付いたコントロールがあれば、そちらを参照します。もし、その式が 設定されたテキストボックス自体の名前が「合計人数」だった場合は、 循環参照が発生するのでエラー表示になるはずです。 ちなみに > どうも、連結テキストの内容を編集して > 　合計人数 > などに＋”［人］”を追加しても上手くいきません > 　合計人数＋”［人］” > とならずに > 　＝［合計人数］＋”［人］” > となってしまいます。 になる理由ですが、コントロールソースの先頭が「=」ではない場合は 連結コントロールを指しますので、必ずレコードソースにその名前の フィールドが存在しなければなりません。おそらくレコードソースに 「合計人数＋”［人］”」などという名前のフィールドが無かったので、 自動修正機能が必然的に演算コントロールと判断して、先頭に「=」を 付加したのでしょう。 また文字列との連結に「+」を使うのは、お勧めしません。「&」を 使ってください。
＃１です。補足を元に、簡易化したテーブルとクエリで試験してみました。こちらでは３．で、思い通りの抽出が出来ます。以下にそのＳＱＬ文を示しますので、問題点を検討してください。 SELECT t_薬剤マスター.薬剤ID, t_薬剤マスター.薬剤区分ID, t_薬剤マスター.薬剤名 FROM t_薬剤区分 INNER JOIN t_薬剤マスター ON t_薬剤区分.薬剤区分ID = t_薬剤マスター.薬剤区分ID WHERE (((t_薬剤マスター.薬剤名) Like "*薬剤名*")); これでも判らないようであればpiro0422さんの作った３．部分のＳＱＬ文を提示してください。
ちょっと趣旨とは違うかもしれませんが、参考になりますでしょうか？ http://www.accessclub.jp/bbs3/0146/superbeg50152 …
私も、コンボボックスのNotInListイベント以外はVBAではなく マクロで対応する形で数年間使用していました。 VBAの方が圧倒的に幅が広くなるのは事実ですが、 とりあえずはとっつきやすいところから入る、というのはありだと 思っています。 > 「テーブルレベル入力規則の未定義の関数名です。。」と > エラーが出てしまいます。テキスト型でも数値型でもです。 Rnd関数はVBAによって定義されているので、ご提示の式が 実際に使用されたものそのままだとすると、Access自体が 正常でなくなっている可能性を疑うべきかと思います。 添付画像は、こちらの環境(XP Home＆Access2007)で 作成したサンプルです。 左のデザインビューでRnd関数を指定したのに対し、右の データシートビューでは問題なく乱数が表示されています。 とりあえず、当該DBを開いたら、Ctrl＋Gを同時押しすると 『イミディエイト』ウィンドウが開きますので、試しにそこに ?Rnd() と入力した後、Enterキーを押してみてください。 それでもエラーになるようなら、Accessが不具合を起こして いますので、アプリケーションの修復、もしくはアンインストール 後に再インストール、しかないと思います。 (・・・VBAのdllのみ差し替え、という方法もあるのかも 　しれませんが、私はその辺りは疎いので・・・(汗)) ※もしも複数のバージョンのAccessをインストールしている場合は、 　 一旦古い方を立ち上げた後に再びAccess2007を起動して 　 みてください(途中の、「構成しています...」といった感じのものは 　 きちんと処理が終わるまでそのままにしておいて) 　 以前、これをキャンセルしたために、動作がおかしくなったことが 　 ありましたので・・・。
> (1)整数型のフィールドプロパティに「小数点以下表示桁数」の項目があるのでしょうか？ はい。あります。 データ自体は整数型ですから小数点以下を保持しませんが、表示方法として 小数点以下を付けて表示するか指定するために、「小数点以下表示桁数」 プロパティがあります。 > (2)浮動小数点表示桁数を「自動」と「桁数指定」するのとでは、データサイズが変わるのでしょうか？ いいえ。変わりません。 表示桁数はあくまで見せ方、お化粧の類です。データの内容とは関係ありません。 化粧を変えると体重も変わるか、という話と一緒ですね。
>(1)テキストの外枠は、罫線代わりには使用する うまく重ねたらできますが。 >(2)外枠を固定する 何もしなければそのままの大きさで 表示されます。 テキストボックスの場合、プロパティの 印刷時拡張、あるいは印刷時縮小が 「はい」になっていたら自動的に 文字列の大きさに合わせて自動調整 されます。 文字の大きさは同じくプロパティ で設定できます。 また、ラベルやテキストボックスを デザインビューで開いているときに ポイントして右クリックでサイズ変更 から自動調整をクリックするとサイズが 自動的に文字列に合わせて変更されます。 戻すには「グリッドに」をクリックします。 SizeToFitというメソッドもありますが、 これはコードから使ってサイズを自動 調整するものなのであまり関係がない かもしれません。 こんなところですが。
yu_tangさんのおっしゃるとおりです。 テキストボックスに Captionはありません。 申し訳ありませんでした。 自分の文章を見て確認させていただきました。 今回初めて参加させていただきましたが、 ラベルとテキストボックスを混同されていると思い色々考えているうちに中途半端に送信してしまいましたようです。 私も独学で覚えましたので、最初は意味がわからないことを色々やっていたなと思い、アドバイスできればと思ったのですが、かえって混乱させてしまいました。 横槍を入れて申し訳ありませんでした。
フリーソフトで下記のものは、バックグラウンドでｍｄｂを使用し、データを管理しています。 http://www.vector.co.jp/soft/win95/home/se306920 … アクセスがあれば直接データ（テーブル）を見ることができるので、必要なものを探せるでしょう。 あとは栄養管理関係の書籍でＣＤ－ＲＯＭ付きのものがあり、「栄養成分表（五訂）」が収録されているようなことが書かれているのがあります。使用したことがないので本当に利用できるか判りませんが。
設計（発想）がＤＢ的ではないような気がします。 「集計を行った結果を、個人別に表示」が目的ならば、適当なテーブルとクエリで一つのフォームを使用して表示できます。 また「自分専用テーブルを作成して格納」はどちらかと云えばやらない方がよいような。 では具体的にどうするか？ 例えば（仮称） indexテーブルを作成 フィールド dataid:当該レコードとリレーションを取るため userid:ユーザーとリレーションを取るため このテーブルに対象データを積み上げてゆけば、後は適当なクエリを作成して、フォームでユーザーごとのデータを表示できます。 この方法ならば、（今回は必要ないかもしれませんが）同じフォームで、全ユーザーとか、ユーザーＡとユーザーＢのデータを表示みたいなことも出来ます。
＃３です > >動くのならそのままでも良いような気がしますが > はい、このままにします。 動くという意味の中には、苦もなく応答が待てる、ということも含まれます。 > でも、ご回答にあった「コード」。とてもいいです。 > 回転時間がない分かなり速くなりました。 While 部分でレコード数分１つ１つ処理しています。 .MoveFirst で先頭に移動し、レコードを更新したら、.MoveNext で次のレコードに。 最後を処理するまで繰り返します。
コントロールソースにいれるなら =IIf(IsNull([次診断日]=True) Or [次診断日]="","初診日","次診断日") だと表示されると思います
> この線は、何か意味があるのでしょうか？ テーブル「A」と「B」があり、それぞれのレコードが以下のようだったとします： (「ID」が主キー) 「A」テーブル 　ID　 データ 　1　　Test1 　2　　Test2 　3　　Test3 「B」テーブル 　ID 　1 　2 このテーブルを元にクエリを作成した場合、以下の結果が表示されます： 【双方の『ID』間に結合線がある場合】 　A.ID　B.ID　A.データ 　　1　　　1　　Test1 　　2　　　2　　Test2 【双方の『ID』間に結合線がない場合】 　A.ID　B.ID　A.データ 　　1　　　1　　Test1 　　1　　　2　　Test1 　　1　　　3　　Test1 　　2　　　1　　Test2 　　2　　　2　　Test2 　　2　　　3　　Test2 つまり、結合線があった場合は、それぞれのテーブル間で共通したもの のみが結果として表示されるのに対し、結合線がなかった場合は共通 するしないに関わらず、すべての組み合わせ(2レコード×2レコード=4 レコード)が表示されます。 少し言い方を変えると、「結合線を使用すれば、一方のテーブルを 他方のテーブルの検索条件として使用できる」ということです。 (あくまで、使い方の一例ですが) > 「リレーション」（これは自分で作るので納得しているのですが）とは > 違いはあるのでしょうか？ こちらについては、長くなるので以前の回答へのリンクを貼っておきます(汗) http://oshiete1.goo.ne.jp/qa5073445.html
SQLがUNION ALLなのでデータ量による オーバーヘッドが生じている、という 可能性が一番高いとと思われますが。 その他は、スワップ、他のアプリの 起動など。 このSQLをどこから呼び出してどのような 処理をしているかにもより、そのときに オーバーヘッドが生じている、という 可能性はどうですか。連続処理を しているならばオーバーヘッド、 スワップも有りかもしれませんが、 スワップが生じたらすぐわかりますね。 こんなところです。
説明が前後してしまいますが、 最初のコードは何のイベント で書かれているコードなのかを 聞いていればもう少し短い スレッドになったかもしれません。
レポートの元ネタはフォームと同じで、クエリです。 クエリの特別な例として「単一テーブル」があります。 先ず、クエリを作成するところから始めて下さい。 複数テーブルを使うクエリはザラで、むしろ、単一 の場合の方が珍しいくらいです。
＞集計するシートと集計されるシートのシート名が一緒の時、わざわざsheets("1日")と書き直さなくても この集計シートの関係がどうなっているか解りませんが、 例え、シート名が同一であっても、ブック名から明記すれば問題無くマクロを動かす事が可能です。 マクロ動作中にどのブック（やシート）がアクティブになるかをしっかりと把握しながらマクロを書かないと混乱する事になりますから、ブック名やシート名を明記するような記述方法を癖にした方が誤動作防止面だけでなく可読性も高まります。 ThisWorkbook.Sheets("sheet1") Workbooks("Book1").Sheets("sheet1") Workbooks("Hoge1").Sheets("sheet1") ＞"Activesheetと同じシート名"のようなマクロの組み方は出来るのでしょうか。 マクロでシート名を取得出来ます。 WsName = ThisWorkbook.ActiveSheet.Name '変数にシート名取得する。 Workbooks("Book1").Sheets(WsName).Activate ' 変数 WsName と同名シートをアクティブにする。 ２行を一緒にすると、こんな書き方も。 Workbooks("Book1").Sheets(ThisWorkbook.ActiveSheet.Name).Activate 動作テストはしていませんが、修正してみました。 ---------------------------------------------------------- Sub 集計2() Dim TmpBook As Workbook Dim WsName As String Application.ScreenUpdating = False fldPath = ThisWorkbook.Path & "\" fname = Dir(fldPath & "*.xls") WsName = ThisWorkbook.ActiveSheet.Name Do Until fname = Empty If fname <> MyBook.Name Then Workbooks.Open fldPath & fname Set TmpBook = Workbooks(fname) With TmpBook.Sheets(WsName) mx = Application.WorksheetFunction.Max(.Columns(1)) lr = .Range("B65536").End(xlUp).Row .Rows("6:" & lr).Copy End With Application.DisplayAlerts = False TmpBook.Close Application.DisplayAlerts = True FR = ThisWorkbook.Sheets("1日").Range("B65536").End(xlUp).Row + 1 ThisWorkbook.Sheets(WsName).Cells(FR, 1).Paste Application.CutCopyMode = False End If fname = Dir Loop Application.ScreenUpdating = True End Sub
質問の意図がいまいち。 1. Outlook Express やその他のデーター場所を今とは違う場所に移して運用したい。 2. Outlook Express やその他のデーター場所は移さず、今あるこれらのデーターを別の場所にバックアップしたい。 1. なら外付けの HDD や内蔵 HDD を増設。またはシステム用 HDD ごと交換。 2. なら CD-R や DVD-R に焼く。 私も恒久的な保存媒体として USB メモリーは信用していません。 もちろん CD-R や DVD-R も数年ごとに焼き直ししますけどね。
Filemaker社の意見ですが・・ http://www.filemaker.co.jp/downloads/pdf/compari …
失礼しました。 >イメージコントロールか >連結オブジェクトフレームを貼り付け、 ではなく、 >連結オブジェクトフレームを貼り付け、 です。写真２枚ならば連結オブジェクトフレーム を２つ貼り付け、テーブルの２つの Oleオブジェクト型のフィールドを 指定します。
どうだったでしょうか？ うちではAccessのFD4枚のアップデートは必ずするようにしていますが、マイクロソフトのサポートページにあるサービスパックはいれたのかどうかちょっと記憶がないです。（OSはWindows2000） それでセットアップでBtrieveのISAMドライバをいれ、別にPervasiveSQLのクライアント版（だったかな？）も入れており、wbtrcall.dllはwindowsのフォルダではなくパスの通ったところにありました。 こういう状態でアタッチを選ぶとBtrieveが選択できるようになっています。Btrieveを選んでFILE.DDF(他にFIELD.DDF、INDEX.DDFの3つでセット)を指定。これでBtrieveのテーブルが指定できるようになります。
追加ですが、実際に使用するときは ちゃんと札幌市交通局にその旨 を伝えて許可を取ってからに してくださいね。
　ん～？　本当にJDBCドライバがない事が原因かなぁ？ 　org.apache.tomcat.dbcp.dbcp.SQLNestedException: Cannot create JDBC driver of class '' for connect URL 'null' 　このメッセージを読む限りでは「URLがnullなのがおかしい」と私は思うのだがどうだろう。server.xml(または該当context.xml)の該当箇所と、web.xmlの該当箇所をもう一度確認してみたらどうかな。
会社のシステム管理者に尋ねる内容ではないかと思いますが、こんなところで質問して設定してしまって大丈夫なのでしょうか？ 自宅クライアント側の設定で 「サーバー アドレス」 というのだから、会社のルーターのアドレスとか。
Outlook からOEへ移行をされる方は多くはないと思いますが、 手順どおりにやれば通常はできます。エラーが出ることはありません。 Microsoftの公式ページに手順が載っているくらいですから。 そのため、Outlook のプログラム自体が正常に動作してないように見受けられます。 「もし私でよければ」、ですが、何か解決策があるか探してみます。 OSやエラーメッセージの全文、またどのタイミングで出るかなどできるだけ詳細を正確にお知らせください。 また、Officeの複数バージョンインストールしたこともないですよね？ 改善できる補償はないですし、少しお時間いただくことになりますが。 また、vCard形式でも移行できるかもしれません。 プログラムの問題であればできない可能性が高いですが、試してみるのも いいかもしれません。 （こちらは一人ずつではないとできないと思いますが）
ＭＤＢの最適化のことでした。 私のアクセス（2000）では、フォームを削除すると、クラスオブジェクトは自動的に削除されていましたので、何らかのバグみたいなものかも知れません。 まあ、アクセスですから何でもありなのかな。 同じ名前でフォームを作って、もう一回削除してみるとか、 悪さをしなさそうなら、放置するとか、 どうしてもいやなら、他のｍｄｂでつくりなおすとか、、、
たぶん、シートの表示設定の関係でしょう。 オプションから『シート見出しを表示する』にチェックして下さい。 ワークシート見出しが表示されない http://oshiete1.goo.ne.jp/qa3965162.html http://office.microsoft.com/ja-jp/excel/HA102787 …
試してみたところ、追加はできても、更新と削除は出来ないようです。
共有設定のマニュアル通りに設定していますか？ バージョン違いますが同じような質問がここに↓ http://www.kipwmi.com/fmbbs/wwwlng.cgi?print+200 … http://www.kipwmi.com/fmbbs/wwwlng.cgi?print+200 …
マクロの『メッセージボックス』アクションでも、フォームのデータを参照することは 可能ですが、この場合は 　・先頭への半角等号(=)の追加 　・その他の文字をダブルクォーテーション括り が必要になります。 【メッセージ内容が固定の場合の「メッセージ」引数】 　○×さんのデータを削除しようとしています 【「○×」の部分にフォームのデータを使用する場合】 　=Forms!フォーム名!フィールド名 & "さんのデータを削除しようとしています" 　※「&」の前後には半角スペースが必要になります。 なお、個人的にちょっと気になったので試してみたところ、後者のように式を指定した 場合も、「@」によるメッセージのセクション分けが可能でしたので、合わせて参考まで。 (セクション分け： 　「メッセージ」引数に「注意@削除します@よろしいですか?」と指定してみてください。 　それぞれが改行表示され、1行目は太字になります)
>左辺と右辺の和集合が互いに素でない こんなこと考えながら仕事してるプロは まず、いないと思います。 要素のうち、「タイプ」が曖昧ですが、 これは置いておきます。 業務内容から見るに、一つの企画に複数の 社員が従事している（社員は企画に属する） という場合、より小さく（細かく）分類 出来る方が効果的です。 何故かと言うと、企画を限定しても社員が 特定できないのに対し、社員を限定すると、 企画も決まるからです。 以下のデータモデルを想定してみます。 企画Ａ＋社員１ 企画Ａ＋社員２ ここで、「企画Ａ」を指定してもデータは一意に なりません（上の行か下の行かハッキリしない）。 しかし、「社員２」を指定すると、データが一意に なります。 但し、従属性が反対なら企画がキー候補に なります。 実業務では一人が複数の企画に従事したり、 参加/脱退を行うので、社員と企画は別々の テーブルとし、社員、企画、参入/脱退、日付などを 記録したテーブルを設計する方が普通です。
＃１です > 再クエリが１回分遅れます。 > [B]で何回か入力すると、その時の入力分は更新されず、 > 前回の入力分だけ更新されていきます。 > [B]で新規登録した後[A]に戻っても、 戻ると表現されていたのは、[B]を閉じる、で良かったのでしょうか。 [B]を閉じずに[A]に行ったり、[B]に行ったりしているのでしょうか。 閉じずに反映する時には、[B]の更新後処理イベントで、 オブジェクトの選択　フォーム, フォーム[A]名, いいえ 再クエリ をやってみてください。 この時、[B]がポップアップになっていない時など、[A]に表示が切り替わるので 再クエリの後に、 オブジェクトの選択　フォーム, フォーム[B]名, いいえ を追加して、[B]を表示するようにします。 また、[B]を閉じる方法が複数ある場合には、[B]の閉じる時イベントで オブジェクトの選択　フォーム, フォーム[A]名, いいえ 再クエリ をやってみてください。
引き続き。 補足説明を受けてやってみたらと思うことを。 （１）アップデート前DB （２）クエリをコピーした空DB （３）アップデート先DB とした前提で、、 （１）、（２）、（３）でクエリのSQLビューを見て、 SQL文（テキスト）が３者で同じになっていますか？ 「式1:[???]」という変化がどこで起こっているかわかれば 対処もできそうな気がします。 ちなみに、SQL文は結構複雑ですか？　 ここで公開することは可能ですか？
IMSについても、IBMによる高価なセミナーが実施されているようですね。 英語サイトですけど、IMSのDB内部構造等について、図などを用いられて解説されているところがありました。 http://www.dbazine.com/ofinterest/oi-articles/ims2 ざくっと見ましたけど、 IMSでのHSAMは、OSレベルではBSAM、QSAMで実装されている。 IMSでのHISAMは、OSレベルではVSAMで実装されている。 といった記述があるようです。 メインフレームの情報は、インターネット上でゴロゴロ転がっている訳ではないし、情報の鮮度や信憑性なども判断できません。 どこの誰だか分からない人に聞くのは、仕事上、大いに問題ありです。 ただ、IBMの情報は、英語サイトなどで意外と出てたりしますけどね。 英語サイトですが、メインフレーム・フォーラムもあるようですよ。 http://ibmmainframes.com/index.php
そんなことで悩まないでください。 上手く設計すれば速くなります。 上手くSQLを書けば速くなります。 NULLが入らない項目にはNOT NULL制約を付けてください。 できれば項目にNULLが入らないような設計を心がけてください。 お願いします（ある開発者の心の叫び）。 ・NULL撲滅委員会 http://www.geocities.jp/mickindex/database/db_ge …
※見積もり ※顧客管理 --これができないデータベースソフトは無いでしょう。 ※上記の作業を3台のPCで行いたいと考えております（共有ネットワークとして） --Flemakerに共有機能が付属しています。 参考URL：http://www.filemaker.co.jp/support/technologies/ …
本質的な差異はありません。 パフォーマンスに差が出るという事も 常識的にはありえないと思います。 今のオプティマイザはそんなに質は悪くありません。 20年以上前のDBもしくは無名で信用性の無いDBをあえて 使うという状況でもない限り気にしなくていいと思います。
Access2003以上ならばオブジェクトの 依存関係を示すツールがあえいますが、 それ以前のバージョンにはないので、 私ならば、「会社マスタ」を 「会社マスタ100」とかにテーブル名を 変えてそのまま実際の運用をシュミレート し、エラーを探して依存関係を調べますが。 ただし、テーブル名を変更する前に ツール→オプション→全般　の 名前の自動修正を行うのチェックをはずして から取り掛かります。 たいした回答ではないので他の皆さんの 意見もお聞きください。
「統合」というのが、単にシリアルに積み重ねる だけなら簡単に実現できます。 １ケ月分をまとめるのもVBAで簡単にできます。 結合ルール（例えば、結合後、各データが誰の ものか分からなくなっても良いとか、ブックの ファイル名が人名だから、これを生かしたい等） を細かく記載してください。また、マクロを使う ので、VisualBasicのカテゴリの方が回答を 得易いと思われます。
>カラムのタイプがdatetimeだと上手くいきません。 うまく行かないとは、具体的にどのようになるのですか？エラーメッセージなり、格納したデータの検索結果なり、具体的に提示してください。 >カラムのタイプをdatetimeからtextに変更するのは避けたい SQLiteのバージョンは、何でしょうか？ SQLiteはデータ型の実装を限定していて、日時の形式により、内部的にはtextやintなどのデータ型として格納されます。
VISAL BASIC　のカテゴリに回答しておきました。 こちらに向こうのリンクを貼り付け、向こうには こちらのリンクを貼ってこちらを閉じればと 思いますが。
マクロということであれば、回答（1）さんのやりかたでできると思います。 そのデータがソートされているならば、前回と同じか違うかだけを見ればいいので ループが１つ減るかと思います。 マクロでない方法では、ピボット機能とか集計機能とかフィルタオプション機能とかで テコテコやればできると思います。（その後、マクロ化も可能）
こんばんは。 ノートPCからデスクトップPCに変えるのであれば、 まず、NEXTGEARシリーズは、液晶ディスプレイがついていません。 http://www.dospara.co.jp/5goods_pc/pc_detail.php … NEXTGEARシリーズとほぼ同等のスペックです。 液晶ディスプレイのセットもあります。 ニコ生をするなら、HDD1TB、Geforce GTS250ほどのスペックはいらないと思います。 でも、後々PCでしたいことが増えるとしたら、積んでおくのも悪くはないかもしれませんね。
SUM(売上)とした時、売上が一件も無いと、 Nullになります。そこで、Nz関数を使い、 Nz(SUM(売上),0)とします。
計算フィールドなのでしたら自動で全レコード計算されますが？
メールはソフトによってバックアップするものが違うことがありますので、使っているソフトで探してみてください。 たとえば、「アウトルック、バックアップ」などをキーワードに検索してください。 住所や、フォルダ構造、メールなどそれぞれのバックアップが別々である可能性があるので、ちょっとめんどくさいかもしれません。 http://support.microsoft.com/kb/882809/ja http://support.microsoft.com/kb/882808/ja http://office.microsoft.com/ja-jp/outlook/HA0110 … http://detail.chiebukuro.yahoo.co.jp/qa/question … このようなソフト（外付のディスクなど）をつかうと、コンピューター全体のバックアップを取ることができます。 多少時間がかかるかもしれませんが、こちらのほうが楽かもしれません。
OSがわかりませんが、従来XP使用者が多いので、参考URLをご覧ください。メールフォルダのメールメッセージ、メールアカウント、アドレス帳、IEのお気に入りなどのエクスポートの他マイドキュメントの画像ファイル、文書ファイル、音楽ファイル、年賀状の住所録・デザインなどのデータもバックアップ保存します。 USBフラッシュメモリーよりCD/DVD-Rなど大容量のメディアに書き込み保存するのをお勧めします。 （ちなみに、私のデジカメ写真からマイピクチャーに保存した画像だけでDVD-R、10枚分になりました） アプリケーションは保存し復元しても起動しませんから、パソコン添付のインストール用CD-ROMからインストールしなおすことになります。 パソコンに慣れたら、イメージバックアップソフト（有料/無料）により、パソコン丸ごとイメージバックアップをとると、リカバリ（工場出荷状態にする）より簡単に現状復元が可能です。 リカバリ（OSインストール）→セキュリティ対策ソフトをインストール→エントリー登録→アップデート→Windows Update更新（SPを当てることも含む）→各種アプリケーションをインストール→メールアカウントの設定とインポート、アドレス帳のインポート、お気に入りのインポート→フリーソフトをダウンロード・インストールなど現状にするのがイメージバックアップファイルからのリストア（復元）で一発でできます。 「イメージバックアップソフト」の「フリー」は検索してヒットしますが、原則英語版です（市販の有料のものは日本語版）使いにくいかも。 参考URL：http://www.microsoft.com/japan/windowsxp/pro/eva …
カテゴリ違い
検索条件は手入力ですよね？ でしたら 検索モードに切り替え[一時停止] 検索実行 レコードのソート[記憶する; ダイアログなし]
私は不一致クエリウィザードって使ったことないので、以下想像が入っています。 まず、なぜ「is null」かという話であれば、これはまさに、相手のレコードがないものを探しているからです。 テーブルAフィールド1の内容と、テーブルBフィールド1の内容を比べるとします。次にこれでたとえば「テーブルAのすべてのレコードと・・・・」というクエリを作るとします(つまりクエリビルダでみると矢印でフィールドをつなぐやりかた)。テーブルAのすべてのレコードが表示されますが、テーブルBに該当するレコードがなければ、そのテーブルBのフィールドがNullで返ってきます。 そのNullのレコードを探すから、「is null」の条件が入ります。 次にもともとNullのレコードは除外したいというのであれば、いくつか方法があります。 まず、その不一致クエリにテーブルをそのまま使わずに、テーブルから当該フィールドの値がNullであるレコードを除外するクエリで不一致クエリをつくることです。ですから２段階にクエリを作ることになります あるいは、もとのテーブルで、Nullを別の値に置き換えてしまうのものひとつの手です。何かの文字や数値で都合が悪ければempty値にしておけばいいでしょう。以後の入力でもNullを許さないような入力画面を作るとなおよいわけです。 または、IsNullの評価を別のフィールドでするとか。主キーのように必ず値をもっているフィールドがあれば、そこでIsNullの評価をすれば、もともとNullということはないですね。
エクセルの書式を文字列にしてから、 エクセルにデータを入れないと その時点で数値に変換されると思います。 ので、データを入れる前に、書式を文字列にしておくか 手で入力しているなら、文字列指定（’1Ｅ00032）するか、、、 桁数などが定型でもとの文字列が推測できるなら、アクセスで 変換させることもできるかもしれません。
こういう方法もありますが。 Access/VBA Tutorials - A new method for disabling the Mouse Scroll Wheel in Access forms http://www.everythingaccess.com/tutorials.asp?ID … 参考URL：http://www.everythingaccess.com/tutorials.asp?ID …
VB 6.0 で作ったアプリからは、Access のデーター ファイル、つまり *.mdb を利用するだけなら Access 自体はいらない。 ということは、Access がインストールされていない環境に上記条件のシステムを配布するのなら Access のランタイムは不要。 Access のデーター ファイル自体を Access で開くような機能があるのなら Access または Access ランタイムが必要。
カテゴリ違い
実は重要なことがまだ機能として付け加えられて いません。それはサブフォームに入力し終わった 時点でどのタイミングでサブフォームを隠すか ということです。サブフォームのすべての項目を 満たしたとき、もし間違いがあった場合、訂正を するということも考えられます。エンターキーを 押した時点での項目チェックをすれば、その時点で フォームを隠すこともできますが、以上の点で どう判断するかで隠すタイミングがむつかしい のです。検索のテキストでマウスをクリックした タイミングでサブフォームを隠すには、 マウスボタンクリック時のイベントで、 Private Sub tx検索_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single) Forms!frmMain2!frmSub2.Visible = False End Sub のように、 Forms!frmMain2!frmSub2.Visible = False を加えるだけです。やってみてください。 上記のコードを付け加えれば、サブフォームは 隠れますが、それまではひらいたままです。 ということでどのタイミングで隠したらよいのかは 一つ考えてみてください。考えが確定したら 実装します。 また、レコードの書き換えからの保護という ことは一つの案として同じテーブルを 二つ用意し一方が変化したとき他方と 比較して変化する以前のものに変化が あったか確認し、なければそのレコードを 変化したテーブルに保持し、サブフォームが 閉じた時点でその新規のレコードを 他方に移し、再び同じことを繰り返す という方法もあります。もし以前の レコードに手が加えられたということが 確認できた時点でサブフォームを閉じ、 テーブルを元にもどします。 という方法もあります。 ただ、比較するテーブルの隠避やレコードが テーブルそのものを見ても判らない ように正規化しておくということも 必要になります。 ということで、閉じるタイミングを 考えてみてください。
つーか、そもそもノートPCは上位のグラフィックチップを最初から搭載した高級機種でもない限り3Dゲームには不向きです。デスクトップなら性能が不足していてもグラフィックボード交換で3Dゲームに対応させることができますが、ノートではそのような構造にはなっていないので。 どうしてもそのゲームをやりたければデスクトップを買うことですね。
ターゲットが何なのかを具体的に提示しなければ、誰も具体的なアドバイスはできません。
このような場合はクエリでグループ化 をします。方法は選択クエリを作成 してクエリのデザインビューのままに して、ツールバーのΣの印をクリック すると出来上がりです。 たとえば、できたSQL文を見ると このようなものが出来ます。 SELECT tblT.ID, tblT.生年月日, tblT.区分 FROM tblT GROUP BY tblT.ID, tblT.生年月日, tblT.区分; では。
UACが絡んでいるような気がします。 ・ODBCの設定が実行ファイル等で自動的に行われる場合なら、その実行ファイルを右クリックして「管理者として実行」を試してみる。 ・ODBCの設定を手動で行っているのであれば、ODBCコントロールパネルを右クリックして「管理者として実行」を試してみる。 どちらも駄目なら、UACを無効にすれば設定可能かどうかお試し下さい。 参考URL：http://blog.livedoor.jp/akf0/archives/51383403.h …
当初はVBAでループをぐるぐるなどと 考えていましたが、結局クエリで すべて対応することにしました。 最初から整理しておきます。 １　二つのテーブルをtbl1、tbl2とします。 　　フィールドはそのままです。差分の 　　確認と差分の追加のクエリの作成。 差分の取り出しクエリをQ差分とします。 SELECT tbl2.A, tbl2.B, tbl2.C, tbl2.D, tbl2.E FROM tbl2 LEFT JOIN tbl1 ON (tbl2.E = tbl1.E) AND (tbl2.D = tbl1.D) AND (tbl2.C = tbl1.C) AND (tbl2.B = tbl1.B) WHERE (((tbl1.B) Is Null) AND ((tbl1.C) Is Null) AND ((tbl1.D) Is Null) AND ((tbl1.E) Is Null)); そのQ差分をもとに追加クエリQ差分追加 を作成します。 INSERT INTO tbl1 ( B, C, D, E ) SELECT tbl1.B, tbl1.C, tbl1.D, tbl1.E FROM tbl1 RIGHT JOIN tbl2 ON (tbl1.E = tbl2.E) AND (tbl1.B = tbl2.B) AND (tbl1.C = tbl2.C) AND (tbl1.D = tbl2.D) WHERE ((Not (tbl1.B) Is Null) AND (Not (tbl1.C) Is Null) AND (Not (tbl1.D) Is Null) AND (Not (tbl1.E) Is Null)); 追加後にはtbl1のAのフィールドは空です。 オートナンバーならば自動的に番号が 割り当てられます。 ２　二番目の質問部分です。 この場合は二つのテーブルのAが必ず 　　１対1で対応していることを前提と 　　しています。 tbl1とtbl2のDのフィールドの違いの確認 Q_Dのフィールドの比較　とします。 SELECT tbl1.A, tbl1.B, tbl1.C, tbl1.D, tbl1.E, IIf([tbl1]![D]<>[tbl2]![D],[tbl2]![D]) AS tbl2のD FROM tbl1 INNER JOIN tbl2 ON tbl1.A = tbl2.A; 確認後に更新するときのクエリ Q_Dのフィールドの更新　とします。 UPDATE tbl1 INNER JOIN tbl2 ON tbl1.A = tbl2.A SET tbl1.D = IIf([tbl1]![D]<>[tbl2]![D],[tbl2]![D],[tbl1]![D]); tbl1とtbl2のEのフィールドの違いの確認 Q_Eのフィールドの比較　とします。 SELECT tbl1.A, tbl1.B, tbl1.C, tbl1.D, tbl1.E, IIf([tbl1]![D]<>[tbl2]![D],[tbl2]![D]) AS tbl2のD FROM tbl1 INNER JOIN tbl2 ON tbl1.A = tbl2.A; 確認後に更新するときのクエリ Q_Eのフィールドの更新　とします。 UPDATE tbl1 INNER JOIN tbl2 ON tbl1.A = tbl2.A SET tbl1.E = IIf([tbl1]![E]<>[tbl2]![E],[tbl2]![E],[tbl1]![E]); 他のフィールドへの更新も似た方法でできます。 これらのクエリをVBAの中に取り込んで一発で やるということも出来ますが、大事なデータは バックアップを取りながら、なおかつ差分の 確認後に慎重に更新を行うようにしたほうが 無難だと思います。その後にバックアップ データの処分を慎重に行えば間違いがおこり にくいと思います。 何かあれば書き込んでください。
原則的にＲＤＢにおいては、順番の指定なしでデータを抽出する際にはその順番は担保されません。　とはいっても、アクセスでは（私の経験からすると）入れた順に出てくると思います。　格納先のテーブルに主キーやインデックスが設定されている場合、そちらが優先されたと思います。　しかし、そうならなかったとしても（私を含め）誰も責任を取ってくれません。 なので、エクスポートしたい内容を順番を指定して選択クエリにて抽出し、そのクエリ自体をエクスポートするのが普通です。　一旦別テーブルに格納したい理由があるなら、（データ量の問題とかで）さらにその別テーブルを順番に並べたクエリをエクスポートするのもありです。　 参考URL：http://oshiete1.goo.ne.jp/qa5595405.html
Ctrl + W または Ctrl + F4
> Field_cをある語句(複数)で検索してマッチするものがあれば、そのレコードの内容を表示させる。 これにはクエリを使用します。 以下、Access2003での操作手順です： 1)Accessのメニューで、「挿入(I)→クエリ(Q)」を選択するなどして、『新しいクエリ』ダイアログを開く 2)上記ダイアログで「デザインビュー」を選択して、『OK』ボタンをクリック 3)『テーブルの表示』ダイアログが開くので、当該テーブルをダブルクリックするなどして追加した後、 　『閉じる(C)』ボタンをクリックして、同ダイアログを閉じる 4)クエリのデザインビューの上半分の領域に表示された、指定したテーブルのフィールド一覧から、 　「*」と「Field_c」をそれぞれダブルクリックするなどして、下半分の領域に追加 5)下半分の領域に『表示』チェックがあるので、「Field_c」のものだけチェックを外す 　(「*」は全フィールドを表示するためのものなので、上記チェックをつけたままだと「Field_c」が 　　重複してしまうため) 6)「Field_c」の『抽出条件』欄に、以下のような式を入力 　・クエリ実行時にパラメータダイアログが表示される形でよい場合： 　　Like "*" & [検索条件は?] & "*" 　・『MF1』フォームの『検索条件』テキストボックスの値を参照する場合： 　　Like "*" & Forms!MF1!検索条件 & "*" 　※ここでの「*」は曖昧検索にするためのワイルドカード文字で、「4)」での「*」とは別物です。 7)適当な名前をつけて保存 ・・・以上です。 検索結果をフォームとして表示したい場合は、上記クエリをレコードソースとして、新規フォームを 作成してください。 【確認】 上記の式では、指定した条件に部分一致したものが抽出されることになります。 (Field_cのデータに「aaa bbb ccc」と「aa bb cc」がある状態で、検索条件に「aa」を指定すると、 　双方が抽出される： 検索条件指定後の式が、「Like "*aa*"」(=「aa」を含むもの)になるため) スペース区切りの各Keyワードに完全一致した時に限定する場合は、「Like」の隣の「"*"」は 右側にスペースを追加して「"* "」に、右端の「*」は左側にスペースを追加して「" *"」にした上で、 当該テーブルのField_cに記録されたデータについても、左右の両端にスペースを追加しておく 必要があります。 (検索条件に「bb」を指定したとき、実際の式は「Like "* bb *"」(=「 bb 」を含むもの)となるため、 　「bbb」を合致させずにおくことができるようになります。 　また、データの両端に予めスペースを追加するのは、検索条件に「aa」を指定した場合に、 　式が「Like "* aa *"」となり、「aa bb cc」のままではスペースの不足により非該当となるのを 　防ぐためです) > 更にその絶対パスを含むファイル名(Excel)をクリックすればExcelのデータを表示させたい こちらについては、テーブルのデザインビューを開いて、Field_bのデータ型を「テキスト型」から 「ハイパーリンク型」にしてやるのが最も簡単です。 (現在のデータが、ハイパーリンク型とするために必要な形に自動的に変換されます)
私は 2007 を使っていないので実地に確かめたわけではありませんが、 ちょっと調べた限りでは分割フォームのバグくさいですね。 同様の問題がいくつかのフォーラムで報告されています。 http://www.experts-exchange.com/Microsoft/Develo … http://bytes.com/topic/access/answers/735432-acc … どれも解決していません。また公開されている MS のバグリストにも (自分の探した限りでは) 見当たりません。 Access 2010 のベータ版でも同じ現象だという書き込みがあったところを 見ると、今のところ MS はこれをバグと見ていないか、またはバグだと しても優先度が非常に低い扱いではないかという推測ができそうです。 分割フォームと同等のフォームはサブフォームを使って簡単に自作できます から (2003 までは皆さんそうしていたはず)、従来の方法にするか、または バグが直るまで (バグだったとして、ですが) 待つかいずれかではないで しょうか。
pdf作成に関しては、専門のソフトウエアが必要です。 具体的手順ははソフトにより異なりますが、一種のプリンターとして扱うものがほとんどだと思います。　無料のものも、有償のソフトもあります。　印刷（ｐｄｆ作成）の際に保存先をＵＳＢメモリを指定するとそのままＵＳＢメモリに保存されますが、マイドキュメント等に一旦保存してコピーするほうが安全です。
　そのマクロは自作のものでしょうか、それとも受け継いだマクロでしょうか？ 　単純なマクロなのか、VBAコードなのかよく分かりませんが、フォーム名が正確に一致していない可能性が一番高いと思います。 　"***フォーム"の横棒がマイナスか漢数字の一かカタカナの横棒か、全角文字か半角文字か、違っているだけでエラーになります。もしくは"***フォーム"フォームと表記されるような名前指定が必要なのかもしれません。しっかり確かめてみましょう。 　また、VBAコードのフォーム名を" "　で囲んでいないときに、エラーになる可能性もあります。プログラムを丁寧に見てみましょう。 　手掛かりだけで考えると、この２点の助言を挙げられます。
1　参照設定で使っていないコントロールに 　チェックがついていないか。 ２　最適化してみる。 ３　あたらしいファイルを作り 　　前のファイルのオブジェクトを 　　すべてインポートしてみる。 　　これで正常ならば前のファイル 　　が壊れた可能性がある。 そのほか、 http://support.microsoft.com/default.aspx?scid=k … http://support.microsoft.com/kb/884484/ja こういった情報もあります。
case(IsEmpty(フィールド);"";フィールド<=基準値;"L";...のよう に、caseの先頭に空欄の時の処理を入れればいいでしょう。
テーブルのデータとして仮定します。 月データの無い場所を「TblA」に金額 0 で追加するものになります。 テーブル「TblA」のサンプルです。 （an はオートナンバ） an　　場所　　　　　月　　　　　　金額 1　　東京支店　　　2009年1月　　\100 2　　東京支店　　　2009年2月　　\200 3　　東京支店　　　2009年3月　　\300 4　　名古屋支店　　2009年1月　　\1,000 5　　名古屋支店　　2009年3月　　\3,000 6　　大阪支店　　　2009年1月　　\10,000 7　　大阪支店　　　2009年2月　　\20,000 8　　大阪支店　　　2009年3月　　\30,000 処理したい期間の月が作成されているだけのテーブルを１つ用意します。 テーブル「TblB」のサンプルです。 月 2009年1月 2009年2月 2009年3月 以下のクエリをSQLビューに記述します。 INSERT INTO TblA ( 場所, 月, 金額 ) SELECT T1.場所, T1.月, 0 FROM (SELECT * FROM (SELECT DISTINCT 場所 FROM TblA) AS Q1, TblB) AS T1 LEFT JOIN TblA AS T2 ON (T1.場所=T2.場所) AND (T1.月=T2.月) WHERE IsNull(T2.月); ※ (SELECT * FROM (SELECT DISTINCT 場所 FROM TblA) AS Q1, TblB) では、本来あるべき場所と月の一覧を作成します。 場所　　　　　　月 大阪支店　　　2009年1月 大阪支店　　　2009年2月 大阪支店　　　2009年3月 東京支店　　　2009年1月 東京支店　　　2009年2月 東京支店　　　2009年3月 名古屋支店　　2009年1月 名古屋支店　　2009年2月 名古屋支店　　2009年3月 この一覧と「TblA」を比較して、無いもの　IsNull(T2.月)　を使って 金額 0 のレコードを追加します。 ※ SELECT T1.場所, T1.月, IIF(IsNull(T2.月),0,T2.金額) AS 金額 FROM (SELECT * FROM (SELECT DISTINCT 場所 FROM TblA) AS Q1, TblB) AS T1 LEFT JOIN TblA AS T2 ON (T1.場所=T2.場所) AND (T1.月=T2.月); とすれば、テーブルに登録するまでもなく、結果を表示することができます。 場所　　　　　　月　　　　　金額 大阪支店　　　2009年1月　　\10,000 大阪支店　　　2009年2月　　\20,000 大阪支店　　　2009年3月　　\30,000 東京支店　　　2009年1月　　\100 東京支店　　　2009年2月　　\200 東京支店　　　2009年3月　　\300 名古屋支店　　2009年1月　　\1,000 名古屋支店　　2009年2月　　\0 名古屋支店　　2009年3月　　\3,000 処理性能はわかりません。 使えなかったらごめんなさい。
レコード数を調べるにはコストがかかるので、 スクロールバーのつまみ部分の初期値は適当に 設定されています。 特に設定はありません。 いったん最終レコードへ移動すれば適切な高さに なります。
最後に記録したレコードをそれぞれに 取り出すの簡単ですが、問題は日付の 評価です。単純に日付が先の場合、 あるいは後の場合には順序に応じて ポイント加算する、という方法もあり ます。あるいは一定の数値に達して いた場合に日付の順序に応じてポイント を計算するという方法もあります。 また、ある基準値からある 基準値に達する時間の短さを評価 したり、一定の数値幅をクリアした 時間を評価したり、最後に記録した 時間をさかのぼって一定の数値を クリアした時間を評価してポイント を計算する、など様々ですが、日付を 評価することがいろいろなことに 矛盾や不都合を生み出さなければ 日付をどのように評価する、という ことを示されたらそれなりの対策は 出てくると思います。
単純にチェックするだけなら可能ですし、 承認時のメール送信もスクリプトで設定可能です。 ですが厳密に承認権限を設定するなら、 ユーザーごとの権限設定したりしないといけないので そこが面倒かもしれません。
「履歴」の読みたがえということはないでしょうか。 しかばねの中だけ見ると「復」なので「ふく」と読んじゃったとか…。
＃１ですが、ちょっと題意と異なってましたね。 顧客名の下の空白行は何に使用されるのかな？ 「列Ｂ以降をセットで表示させたいから」ですかね。 手順を見直します。 １）列Aと列Ｂを選んで、列の挿入をしてください。（現在の列Aが列Ｃになるように） ２）新たなセルＡ１に値[1]を、セルＡ２に値[2]を、 　　新たなセルＡ３に値[1]を、セルＡ４に値[2]を入れます。 　　（文字としての[ ]は入れなくて良い） ３）新たなセルＢ１に式[=C1]を、セルＢ２にも式[=C1]を 　　新たなセルＢ３に式[=C3]を、セルＢ４にも式[=C3]を入れます。 　　（文字としての[ ]は入れなくて良い） ４）セルＡ１～とセルＢ４を選択し、範囲の右下の■を下方向にドラッグ（マウス左ボタンを押したまま、マウス移動させる）するなどして 　　「必要な行数」に数字を埋めてください。 　　４の倍数行でないと処理できないので、場合によっては多少余分にコピーしてから不要行を消去してください。 ５）シート左上隅（セルＡ1のもうひとつ左上）をクリックしてシート全体を選択してください。 ６）オートフィルタを作成してください。 ７）列Ｂのオートフィルタを用いて顧客名で検索してください。 これでどうでしょう？
　私はSQLITEは試しに触ったくらいで実際に開発業務などで使った事はないので劇的に的外れかもしれないが、普通のSQL的にはLEFT OUTER JOINする側（存在しない場合にNULLになる側）をWHERE句で条件指定したらいけないんじゃないかな。 SQLITEでサブクエリーが使えるかどうかは分からんけど SELECT B.時,C.人数 FROM BLANK_DATA B LEFT OUTER JOIN (SELECT * FROM CNT_DATA WHERE 日時による範囲指定) C ON B.時=strftime('%H',C.日時+2415018.5) という風に、日時指定で特定の日時だけを抽出したものをLEFT OUTER JOINしてやるとか。 ＜別解＞ 　C.日時による範囲指定が C.日時>='2009-01-01' and C.日時<='2009-01-31'などのように不等号で表す事ができるのならば、LEFT OUTER JOINのON句に「定数を先にして」記述する事で対応できる。LEFT OUTER JOIN的には。 SELECT B.時,C.人数 FROM BLANK_DATA B LEFT OUTER JOIN CNT_DATA C ON B.時 = strftime('%H',C.日時+2415018.5) and '2009-01-01'<=C.日時 and '2009-01-31'>=C.日時 　これはLEFT OUTER JOINの仕様なのでSQLITEがどこまでそれにそっているかによる。また、この場合は範囲指定にBETWEENは使えない。LEFT OUTER JOINのON句に記述する条件は必ず等号、不等号の右側に（ここで言う）Cテーブルが来ないといけない。 ＜よく分かる解説＞ 質問者のSQLがLEFT OUTER JOIN的にどうマズいのかについて。 ID列があるテーブルBとID列とNAME列があるテーブルCがある。 [テーブルB] |ID| |01| |04| |09| [テーブルC] |ID|NAME| |01|HOGE| |09|FUGA| SELECT B.ID, C.ID, C.NAME FROM B LEFT OUTER JOIN C ON B.ID=C.ID 結果はこうなる |B.ID|C.ID|C.NAME| | 01| 01|HOGE | | 04|NULL|NULL |　←(1) | 09| 09|FUGA | (1)に注目すると、この行はC.ID列がNULLとなっている。CテーブルがないためにCテーブルから抽出される列は全てNULLになる行が返される訳だ。ここで、WHERE句にC.ID BETWEEN 00 AND 99とすると、C.ID列がNULLである(1)は抽出対象から外れてしまうよね。この話自体はLEFT OUTER JOINは関係なくって、NULLはBETWEEN 00 AND 99にはヒットしないだけの話。質問者のSQLで「WHERE C.日時による範囲指定」の「C.日時」がまさにこのNULLの状態な訳だ。なのでせっかくCからの列がNULLで抽出できた行がWHERE句によってヒットしなかったという訳。
Ｎｏ2です。　申し訳ありません。前回の質問をよく読みませんでした。 アクセスではレコードの順番がインサートされた順から変わるということはあまり経験したことがありませんが、それが担保されているわけではありません。　テーブル前後に「最適化」をすると、何か変わるかもしれませんが、、、 皆様のご回答のように、 SELECT Xテーブル.* FROM Xテーブル 0RDER BY XテーブルXテーブル.品コード, Xテーブル.明細番号; のようなクエリをつくり、そのクエリをexportの対象にするのが良いと思います。 　　
SQLServer　と　PostgreSQL　は、まったく関連性のないソフトウェア なので　その可否を言及することはできません。 　（※それぞれが、相手の挙動を考慮して作られているわけではない） 　何か不具合（干渉）がおきるかもしれないので、それを覚悟の上で ご使用になられたほうが良いでしょう。
以下参考になるでしょうか ACCESS2007でイレギュラーなグループ化は可能ですか？ http://oshiete1.goo.ne.jp/qa5492502.html > 現在、得点が入っているテーブルから得点を取ってきてそれに応じて > 100000以上ならAランクという物を作りたいと思っています。 だけであれば、 SELECT * FROM テーブル WHERE 得点 >= 100000; で抽出できると思います。 （抽出されたものをAランクという扱いにすれば良いと思います）
>「リレーション氏名×住所はありうるだろうか」という問いに対しての答えとして「ありうる」と考えております。 私もありうるとおもいます。 だって、直積集合を定義することと、その集合が空かどうか、というのは全然関係のない話ですから。 そもそも話の前提として、氏名という集合と住所という集合を定義しているけれど、その集合は空であるわけでしょう？ 実務の上ではありうる話で、データベースを作ったけど、まだなんのデータも入力していない、ということに対応すると思いますが、どうでしょう。 >次数が0のリレーションはありうるだろうか。 リレーショナルデータベースで言うところの「次数」とは、言ってみれば関係のある項目の数のことです。 普通実務で扱うのは2次のリレーションです。 例えば、工場に機械とスペアパーツがあって、どの機械とどのスペアパーツが対応するかという表を作れば、この関係が２次です。 普通は、この２次の関係がたくさんあるそういう状態なんですね。 他の次数の例が思い浮かばないんですよねぇ。１次・・・・工場に機械があって、その機械のリストを作れば、それは１次？だと思っているのですが(違っていたら誰か教えて！)。 3次なんていうと、話は分かるような気がしますが、そんな関係が実務上実在するのだろうかと思うのです。3次くらいはあるかなぁ。 じゃ、0次。 データベースの無い状態？を0次といいます？？？ そういいたければ、そういってもいいとは思います(思うだけね、データベース理論の分野でどう考えるのかはしりません)。 でも、私は実務でデータベースを扱っているだけなので、そこまでいくとなんか付き合いきれない気がする・・・・・
結果=Case(IsEmpty(そのフィールド);0;そのフィールド)
In演算子では指定したリスト内(→今回の例では「青,子」)と完全一致した ものしか抽出対象になりませんので、「リスト内の文字を含むもの」を抽出 したいということでしたら、既に回答がある通り、Like演算子を使用する必要 があります。 なお、リストとして列挙する項目がそれぞれ一文字ずつなのでしたら(つまり 「'青木', "裕子"」といった、複数文字の項目からなるリストでないなら)、 以下のSQLでも対応可能です： Select 名前 From テーブル1 Where 名前 Not Like "*[青子]*" 念のために明記しておきますが、角括弧内の項目は、カンマ等の区切りは 【無用】です。 (No.2の方と同様、AccessでANSI89系(→Accessの初期設定値)の場合。 　メニューで「ツール(T)→オプション(O)」で『オプション』ダイアログを開き、 　『テーブル/クエリ』タブを選択すると「SQL サーバー互換構文 (ANSI92)」欄 　で設定変更が可能：Access2003) ※「ANSI○○」については下記URLを参照下さい。 また、今回の例では使えませんが、角括弧([ ])を使用した曖昧検索では、 ハイフン(-)を使用することで文字範囲を指定すること等も可能ですので、 併せて今後の参考まで： http://office.microsoft.com/ja-jp/access/HA10076 … (適用対象がAccess2007となっていますが、それ以前のバージョンでも同様)
　ちょっと習作的に同じフォルダにあるすべてのExcelワークシートの特定範囲を抽出するマクロを組んでみました。デバッグ済みですので、よかったら参考にしてみて下さい。 　ただ、質問がネットワーク間の抽出だとしたら、PHPやASPやPerl等のサーバ再度プログラミング技術が必要になるでしょう。 　　　　　　　　　　　　　　　　　　　　　　　　　　　　海星 Private Sub CommandButton1_Click() Dim objFS As Object, objFolder As Object, colFiles As Object Dim i As Integer Dim strPath As String Dim aFile As Variant Dim cellsPut As Range Dim xlsApp As Object, xlsBook As Object, xlsSheet As Object Set objFS = CreateObject("Scripting.FileSystemObject") strPath = ActiveWorkbook.Path Set xlsApp = CreateObject("Excel.Application") xlsApp.Application.Visible = False Set objFolder = objFS.GetFolder(strPath) Set colFiles = objFolder.Files i = 5 For Each aFile In colFiles If LCase(objFS.GetExtensionName(aFile)) = "xls" Then Set xlsBook = xlsApp.Workbooks.Open(aFile, , True) Set xlsSheet = xlsBook.Sheets(1) ' もし中身がエクセルファイルなら、シート1の2行目のAからDまで（Cells関数の(2,1)～(2,4)にあたる） ' を抜き出してこのマクロを動かしているシート1の5行目から順番に書き込んでいく。もし範囲を変えたいときはこの座標を操作する。 ' 同様にもし３行分ずつ埋め込むのなら、i=i+1 を　i=i+3 という風に変更する。 xlsSheet.Range(xlsSheet.Cells(2, 1), xlsSheet.Cells(2, 4)).Copy ThisWorkbook.Sheets(1).Paste (ThisWorkbook.Sheets(1).Cells(i, 1)) i = i + 1 xlsBook.Close End If Next xlsApp.Application.Quit Set xlsSheet = Nothing Set xlsBook = Nothing Set xlsApp = Nothing Set colFiles = Nothing Set objFolder = Nothing Set objFS = Nothing End Sub
新しいデータをテーブルに追加したいときは追加クエリ 今あるデータを変更したいときは更新クエリ レコードを追加したときに自動で他のデータを追加するためには、少々のＶＢＡ（かマクロ）を使用する必要がある。 バッチ処理みたいな感覚で、クエリ実行するとh04が登録されていない商品に関して全件０円登録をすることも可能だが、クエリがほんの少し複雑。 お勧めとしては、商品マスターや出庫テーブルの構造を見直すこと。 私が作るなら、 割引率が違う店舗の数が２，３種類に限られ、商品数も限定されるなら商品マスターに割引後価格を持たせる。 店舗により割引金額が異なるなら、顧客マスター側に割引率を持たせて、出庫テーブルに理由などのデータを持たせて、不良品を識別する。
>2.Webの方でアクセスした時に何か制約があると聞きました。(使えないスクリプトがある?) それはどんなものでしょうか? >当然、データ入力とか可能ですよね?? 下記リンクが参考になるかと http://www2.filemaker.co.jp/fmi/xsl/techinfo/bro … http://codezine.jp/article/detail/4754 データ入力も手入力だけではないので何とも・・・ インスタントWeb 公開はFilemakerの画面とは全然違うので面倒です。 操作に不慣れな方が操作方法を勉強して使うのでしたらFilemakerも4～5台購入して共有した方が 将来的にも機能的にもいいかも知れませんね。
大変なのは判りますがマルチポストはしないように。 もとの掲示板を参照してください。
すでに確認済みかもしれませんが・・・ 1. TCP 389 を開けている? 2. ユーザーのDNが CN=Urabe なのに内容は CN: test になっている 　ただの修正ミス？登録時にエラーになるはずです。 3. ローカルアクセスは可能？ 　$ getent passwd test 　$ ldapsearh -x -D 'cn=Manager,dc=sample1,dc=com' -w admin -h localhost 'ou=kaihatu'
1. サービス停止 2. DB_CONFIG 以外全て削除（or どこかに退避） 3. サービス起動（自動的に初期操作が走る） 4. データが消えたので再度導入。
ver.7にあるかどうか解りませんが、8(以降?)でしたらポータルの1行1行を 分割して、好きに並べることができます。
クエリ=SQLです。 クエリ上で、必要な項目を表示し、グループ化を行い、ＩＤと修理日については最大なり、先頭なりを設定します。　 そのクエリをＳＱＬビューに変えると、ＳＱＬ文を見ることができます。（括弧だらけですが）
> 区分名も変らずに済むのでしょうか？ 恐らく、『修理履歴クエリ』は、修理履歴テーブルと実施区分テーブルから作成された のだと思いますが、今回のような場合(→修理履歴テーブルの実施区分IDの更新)は、 修理履歴テーブルを直接使用するか、対象を絞り込んだり並べ替えを指定したりする 意味で、同テーブルだけから作成したクエリを使用します。 その上で、コンボボックスを使用し、実施区分IDの値を、『実施区分テーブル』の対応 する『区分名』の値に変換して表示させてやります。 (コンボボックスは、「選択肢を表示するため」だけでなく、こういった「表示用の値への 　変換」にも使用できます) なお、この設定(→コンボボックスによる変換表示)は、フォーム上でも勿論できますが、 テーブル側で設定しておくと、次回から同テーブルを使用して別のフォームを作成する 際には、『フィールドリスト』からドラッグ＆ドロップでコントロールを追加するだけでコンボ ボックス表示となるので便利かと思います。 修理履歴テーブルでの『実施区分ID』の設定変更は、以下の手順で行えます： 　1)修理履歴テーブルをデザインビューで開く 　2)実施区分IDを選択 　3)画面左下の領域にある『ルックアップ』タブを選択し、『表示コントロール』を 　　「コンボボックス」に変更 　4)コンボボックス用の設定表示に切り替わるので、以下のように指定： 　　　値集合タイプ　= テーブル/クエリ 　　　値集合ソース = 実施区分テーブル 　　　連結列　　　　= 1 　　　　(→上記テーブルの「1」番目のフィールド(=実施区分ID)の値を保存) 　　　列数　　　　　 = 2 　　　　(→上記テーブルの「2」番目までのフィールドを使用する意味) 　　　列幅　　　　　 = 0cm;5cm 　　　　(→1番目のフィールドを0cm幅(=非表示)、2番目を5cm幅で表示) 　　⇒データとしては実施区分IDの値を保存しつつ、表示は区分名の値となります。 　5)テーブルを保存して閉じる ・・・以上です。 テーブルをデータシートビューで開き、『実施区分ID』がコンボボックス表示になり、 実施区分テーブルの『区分名』が表示されることを確認して下さい。 次に、フォームの変更手順です： 　1)当該フォームをデザインビューで開く 　2)フォームのプロパティシートの『レコードソース』の値を、修理履歴テーブルに変更 　3)実施区分IDや区分名を表示させるコントロールを一旦削除 　4)フィールドリストが表示されていない場合は、 　　　Access2003までなら、メニューで「表示(V)→フィールド リスト(L)」 　　　Access2007なら、『デザイン』リボンの『ツール』内の『既存のフィールドの追加』 　　をクリックして、フィールドリストを表示 　5)『実施区分ID』フィールドをドラッグ＆ドロップで、フォームに追加 　6)『実施区分ID』の名前でコンボボックスが追加されるので、必要に応じて名前を 　　変更 　　(同コンボボックスのプロパティシートで、『その他』タブの『名前』で設定： 　　　『データ』タブの『コントロール ソース』ではないので、念のため) 　7)保存して閉じる ・・・以上です。 なお、フォーム上でコンボボックスの設定を行う場合は、ツールバーからコンボボックス をドラッグ＆ドロップで追加後、プロパティシートの『書式』タブと『データ』タブに、 テーブルのデザインビューと同様の設定項目があるので、そこを編集します。
お使いになっているソフトを当方が使ったことがないので、漠然とした回答になりますが、エクセルのバージョンが古いものなら、最新に変えられてはどうでしょうか。 エクセル2003までは最大行数が65536ですが、2007なら1048576行まで行けますので、10万行オーバーでも処理できると思います。
環境（Acc97）がないのではっきりわかりませんが、VB6からAcc2000にADOのConnection.executeでinsert文を実行したところ4000文字程度は問題なく登録できました。（何バイトまで登録できるかは実験していません。） そもそも、アクセスに10KBのデータを登録すること自体が間違っているような気がします。 （データ数が増えていくなら、ファイルの場所と必要であれば暗号キーなどだけをdbに入れておいて、他の方法で読み出すほうが安全だと思います。）
何のためにそのようなことをするのか目的をよく検討する必要があります。 No.1の回答のようにプロパティで簡単に非表示にはできますが、キーボードから Ctrl+F4 で簡単にフォームを閉じることができます。Alt+F4 でAccessごと閉じることができます。 それについては問題ないのでしょうか。 とりあえず下記は、フォーム上の閉じるコマンドボタンを押したとき以外は、フォームを閉じれないようにするコードです。 'フォーム 読み込み解除時 Private Sub Form_Unload(Cancel As Integer) Cancel = True End Sub 'コマンドボタン「終了」クリック時 Private Sub 終了_Click() Me.OnUnload = "" '読み込み解除時のイベント抑止 DoCmd.Quit End Sub
ファイル 復活についての知識が不足しているようですね。良かったら、これを参考にでもしてください。 http://www.magicqsoftware.net/file-recovery.html ソフトを使わずにファイル復活させるのは不可なので、これを試しに使いましょう。 ただし、復元ポイントを事前に作ったら話は別ですが。 以上は参考まで。
リレーショナルデータベースでテーブルを分割するのは正規化するためです。 正規化の目的は入力の効率化・省力化ではなく、データの整合性維持です。 テーブルを分割すると一般的に入力負荷は増えます。しかし逆にいうと、ここまで分割しないとデータの整合性が失われる可能性があるということなのです。 今回のエンティティ群から部分関数従属と推移的関数従属を排除して第三正規化すると、質問者さんの結果になります。 これは質問者さんにとっては「理論的」ではないということでしょうか。 どうしてもテーブルの数を抑えたいという場合、（許されるならばですが）科目と課題を階層データと見做して、統合してしまうという方法はあるにはあります。 ・学生　　（学生ID*, 氏名） ・科目課題（科目課題ID*,科目課題名,親科目課題ID) ・履修実習（学生ID*,科目課題ID*,点数） この場合、科目課題テーブルは親科目課題IDがないものが「科目」で、テーブル内にリレーションを持つ状態（自己参照）になります。 ただ、実務上は扱いやすい構造とはいえないでしょうね。
なんとなく、質問の感じから、サーバー上で実行するのではなく、クリックしたときに、「実行するか、保存するのか」のダイアログが出て、「実行」を選ぶと自分のPC上で実行するというようなことがしたいのではないかと思いました。 それであれば、aタグでリンクを書けばいいです。<a href="xxxxx.exe">
回答します。アクセスのレポートをワードのリッチテキストファイル形式で保存をした後、これにテキストボックスを挿入し、そのなかにワードの文書ファイルを貼り付けることが出来ますが、これではいけないのでしょうか。
画像はemfなどのウインドウズメタファイルで保存されていなければ、jpg, bmpなどであれば外部記憶デバイス（USBメモリなど）に保存してから移せばよいと思います。 zipもただの圧縮形式ですから、その中身のソフトやファイルが使えるか、どうかのほうが懸念です。 iTuneはもともとMacのソフトです。他の音楽データも、mpeg3であれば問題はないですが、wmaで保存されている場合は、コーデックをインストールしなければ再生できないと思います。 ウイルスバスターはちょっとキツイと思います。再インストールの必要があります。 あと、データの初期化ですが、リカバリすればよいです。ノートPCならば、どこかのメーカ製だとおもいますから、リカバリディスクなどが購入時についているか、HDD内にリカバリ領域があるはずです。 ただし、完全に消去させたいのであれば、リカバリするだけではダメです。削除したデータを復元できる可能性があるからです。
>ブルーレイに落として貰った物を 中身はなんなのでしょう？　もしデジタル放送を録画したものであればどうがんばってもできませんよ。（ビデオカメラで撮影したようなものであれば、やり方によってはできるでしょうけど）
日付と顧客IDで複合リレーションを設定して、Bの受注シリアルはルックアップを設定し Aから再ルックアップする。
> 「Ctrl＋Enter」で改行できますが、これを無効にしたい 「Ctrl+Enter」をキークリック時イベントで拾い、無効化してやるのがよいかと 思います。 (特定のテキストボックスに限ってであればそのテキストボックスの同イベントに、 　フォーム全体であればフォームのプロパティシートで、『イベント』タブの 　『キーボードイベント取得』を「はい」にした上で同イベントに、下記のコード 　を記述) Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)　　　　'フォーム時 'Private Sub テキスト0_KeyDown(KeyCode As Integer, Shift As Integer)　　'テキストボックス 　　'「Ctrl+Enter」の同時押し時 　　If KeyCode = vbKeyReturn And Shift = acCtrlMask Then 　　　　MsgBox "改行は使用禁止です。", vbExclamation, "確認" 　　　　'入力したキーを無効化 　　　　KeyCode = 0 　　　　Shift = 0 　　End If End Sub なお、メモ帳などで入力した文をCopy＆Pasteされた場合などには、この方法 では対処できませんので、これについてはテキストボックスの更新後イベントで 対応します。 (クリップボードの内容を見て、改行があったら削除、という方法もあるかとは 　思いますが、私はクリップボード周りは手を出したことがないので・・・(汗)) ※上記の「Ctrl+Enter」対応はリアルタイムですが、こちらはテキストボックス 　 の更新が確定したときの発生となります。 　 使用頻度の高低からすれば、これでもよいかと思っていますが、逆に全て 　 の場合で「確定時に一括」でよいなら、キークリック時の対応は省略して、 　 こちらのみでもOKです。 Private Sub テキスト0_AfterUpdate() 　　'Accessでの改行コードがあった場合は削除(=空文字に置換) 　　If InStr(1, テキスト0, vbCrLf) Then 　　　　MsgBox "使用禁止のため、改行は削除されます。", vbExclamation, "確認", 　　　　テキスト0 = Replace(テキスト0, vbCrLf, "") 　　End If End Sub ・・・以上です。
追加質問です。 学生コードはテキストボックスに手動入力し、そのコードを参照して 氏名を表示しているのですか。 あるいは、学生コードは他のコントロールに表示されていて、その値を 参照して氏名を表示しているのですか。 このようなことがお聞きしたいのです。では。
先の質問を閉じずに関連質問をするのはマナーが悪いですよ。 「先頭文字位置」はずばり、探し始める位置です。Mississippiで 先頭文字位置が3なら、Mi[s]sissippiから探し始め、Miss[iss] ippiということで5文字目で発見しましたね。それだけ。
追加です。 ランタイムを置くという方法もあります。2000ならディベロッパーが 必要ですが、最近のバージョンはランタイム版が配布できるようです。
失礼しました。訂正です。 テーブル名tblTableがSQL文の中ではtblTになっていました。どちらかに統一してください。 strSQL = "SELECT tblT.ID, tblT.氏名, tblT.年齢 FROM tblT WHERE (((cmdType([年齢]))=True));"
> PCの何か設定？と考えたりもしたのですが、はっきりとした原因がわからないのでは、 > 他の人にDBを使っていただけないので、エラーにならないVBAでいきたいです。 こちらのOSはWinXPのみなので、そちらでの全ての状況を確認できたわけでは ありませんが、対処法は(多分)見つかりましたのでご報告します。 【対処方法】 現状のコードを以下のように修正します(OutputToメソッドで対応可)。 <現状> DoCmd.OutputTo acOutputForm, "フォーム1", acSpreadsheetTypeExcel9 (「WinXP＆Acc2003」で出力可、「WinXP＆Acc2007」で出力不可を確認) <修正> DoCmd.OutputTo acOutputForm, "フォーム1", ａｃOutputXls (「WinXP＆Acc2003」、「WinXP＆Acc2007」ともに出力可を確認) 【説明】 VBE画面で「OutputTo」のところにカーソルを移動した状態でF1キーを押すと、 対応するヘルプが表示されるので確認されることをお勧めしますが、このメソッドの 第3引数(OutputFormat)には、「AcFormat」クラスの定数(→「ａｃFormat～」で 始まる形になっています)を指定することになっています。 ・・・なのにAcc2003だと、本来「TransferSpreadsheet」メソッドで使用するはずの 「AcSpreadsheetType」クラスに属するacSpreadsheetTypExcel9を指定しても、 エラーにならずに出力できてしまうようです。 一方、Acc2007では、これが厳密に適用されるようになったため、提示されたコード では、「現在出力しようとしているオブジェクトの形式は無効です」とのエラーが発生 するようになったものと推測されます。 ・・・従って、上記の修正は、「本来Acc2003のOutputToでも使用されるべき 引数の型」を指定しただけ、ということになりますので、OS・Applicationの違いに 関係なく、エラーは発生しなくなるものと思います。 (なまじAcc2003で柔軟に対応されてしまったために、Acc2007への移行で余計な 　混乱を招かれてしまった、ということかと・・・(汗)) ※TransferSpreadsheetメソッドの件は、元々OutputToメソッドの代替策として 　 検討されたものと思いますので、省略します。 　 (フォームの出力には対応していないので、強引にやるなら一時テーブルを 　　作成してデータをコピーして・・・といったことになり、煩雑ですので)
すでに自分で調べて、ワークシート関数で文字の色をカウントできないってことはわかったかと思います。 ですので VBA で関数を自作してみました。 セルから =CountEX と打てば呼び出せます。 引数は 3つあります。 1つ目の引数は検索したい文字または、文字が入っている単一セルを指定します。 2つ目の引数は検索したい文字色を数値で指定します。赤なら 255 です。 3つ目の引数は検索範囲を指定します。 例: B2～B20 にある、赤で入力された ◎ の数を取得する。 =CountEX("◎", 255, B2:B20) Public Function CountEX(char As Variant, colorNumber As Long, targetRange As Variant) As Long Dim hit As Long Dim aString As String If TypeName(char) = "Range" Then aString = char.Value Else aString = char End If Dim cell As Variant For Each cell In targetRange If (cell.Value = aString) And (cell.Font.color = colorNumber) Then hit = hit + 1 End If Next CountEX = hit End Function これを対象ブックに組み込むか、アドインとして使ってみてください。 動作保証はいたしかねます。
>広範囲すぎて良く分かりません。 質問が広範囲すぎるのが問題であると思われます。 ＤＢの選択で悩んでいるのか？ ハードウエアの選択で悩んでいるのか？ ＤＢサーバーを立てる手順がわからないのか？ サーバーを立てた後何をしたら良いのかがわからないのか？ ・・・ まず、どのようなシステムを構築したいのか？ そのようなシステムを購入できるのか？ ＤＢサーバーから導入することが可能なのか？（コスト、セキュリティ、時間的、、、） そのあたりの判断を行い、 必要なスペックを満たしたハードウエアを手に入れ、 ソフトウエアを手に入れインストールし、 ネットワーク環境を整備し、クライアントを用意し、 ｄｂ上に必要なテーブルなどをつくり、 i/oに必要なソフトウエアを開発する。 バックアップや、効率化のための手法を確立し、定期的にメンテナンスを行う。 必要なデータを移行し、実稼動を始める。 ・・・・・ 素人がテキトーに考えるとこんな流れになるけど、 どのステップをとっても、それぞれいろいろあって、 ピンポイントな回答を得るためには、ピンポイントな質問が必要。　 ただで試せるＤＢもあるので、中古のＰＣに入れて遊んでみるというのも手ではある。　 もしくは、それこそアクセスなどでＤＢというのに慣れてみるのも良いと思う。
単に全てをさきにORDER BY するだけ SELECT '全て'as type , count(name) as 合計 FROM meibo union all SELECT type type, count(name) FROM meibo GROUP BY type ORDER BY NOT type='全て' ,type ASC
プリンタは、何をお使いでしょうか？ あまり現実的なアドバイスではありませんが、 ポストスクリプトプリンタを使用すると、印刷が早くなった経験があります。 次回、プリンタを購入されるときの参考にしてください。
アクセスＶＢＡで、行数を確認してみてはいかがでしょうか？ （Microsoft Scripting Runtimeの参照を設定する必要があります。） Private Sub コマンド1_Click() Dim x As Long Dim fname As String fname = "C:\temp\test.txt" x = 0 Dim fso As New FileSystemObject Dim ts As TextStream Set ts = fso.OpenTextFile(fname) Do Until ts.AtEndOfStream x = x + 1 ts.ReadLine Loop MsgBox x End Sub
下記でどうでしょうか。 SELECT A.*, (SELECT TOP 1 name FROM login B WHERE B.uid = A.uid AND ltime <= atime ORDER BY ltime DESC) AS name FROM log A;
クエリを新規作成して、AテーブルとBテーブルを追加します。 ２つのテーブルは結合しません。 Aテーブルの住所の抽出条件に、 Like "*" & [市区町村名] & "*" と設定します。これで、２つのテーブルは関連付けられます。 ただし、市区町村名 だけだと、重複する可能性があるかも知れませんので、 その場合は、重複して出力されます。 Bテーブルの方に、都道府県名もはいっているのならいいですか。
昔はプログラムに記述するべきだと考えていましたが、 現在はテーブル定義の活用も必要だと感じます。 テーブル機能のエラーをそのままユーザに表示 するのはみっともないので、当然プログラムでの制御 をメインとし、テーブルでの制御は最後の砦とするのが 私の考えです。 理由１ プログラム以外でデータの直修正を行わなくては ならない場合にデータの不整合が発生する可能性がある が、テーブルに入力規則などがあれば防止できる。 理由２ 開発時に担当者がプログラムのミスにすぐに気がつく。 こんなところですかね。いずれも開発時に時間が多少 多くかかりますが、将来のトラブルがその分防げる と思いますよ。
> ちなみにウィザードでは余計な選択をせず、 > そのまま「次へ」「次へ」で完了させてます。 「.bak」ファイルを削除してしまったのは痛いところですが、「.mdw」ファイルは 残っていて、パスワードも特に設定していないのでしたら、復旧は可能です。 ただ、手順は面倒です(汗) 1)ウィザードで作成されたMDWファイルを開く 2)「MSysGroupList」クエリを開いて、「Name」を確認 　※ウィザードで特に指定していなければ「Admins」(管理者グループ)と 　　「Users」(一般ユーザーグループ)の2つだけが存在するはずです。 3)『MSysGroupMembers』クエリを開き、『パラメータの入力』ダイアログの 　『GroupName』に「Admins」を入力して『Ok』をクリック 4)表示された『Name』を記録(→メモ帳にCopy＆Pasteなど)して閉じる 5)MDWファイルを閉じる 6)ウィザード実行時にデスクトップに作成されたショートカットを既に削除して 　しまった場合は、リンク先として以下のようなアドレスを指定したショートカット 　を作成します： 　　"c:\ProgramFiles\Office11\MSAccess.exe" "c:\Test.mdb" /WRKGRP "c:\セキュリティ.mdw" 　(「c:\ProgramFiles\Office11\MSAccess.exe」はAccessの実行ファイルの、 　 「c:\Test.mdb」は当該MDBファイルの、「c:\セキュリティ.mdw」は当該MDW 　 ファイルの、それぞれアドレス) 　※間に「/WRKGRP」が追加されているので、忘れずに入れてください。 7)上記のショートカットを実行すると『ログオン』ダイアログが表示されるので、 　「4)」で確認したNameを『名前(N):』欄に入力して『Ok』をクリック 　※パスワード未設定なら『パスワード』欄は未入力。 8)当該MDBファイルが開けたら、そのファイルを開いたままで、メニューから 　「ツール(T)→セキュリティ(T)→セキュリティウィザード(W)」を選択 9)ウィザードの最初の画面では「現在のワークグループ情報ファイルを変更 　する(M)」を選択して『次へ(N)』をクリック 10)2番目の画面では『すべてのオブジェクト』タブを選択し、『全て選択(A)』 　　をクリックした後、『次へ(N)』をクリック 11)3番目は飛ばし、4番目の画面で「ユーザーグループに一部の権限を 　与える(Y)」を選択したら、『データベース』～『マクロ』のタブをそれぞれ 　選択していって、すべてのチェックをオンにし、『次へ(N)』をクリック 　(それぞれのタブで「管理者(S)」をチェックすれば、一括で指定できます) 12)あとはそのまま『次へ(N)』で確認だけして、最後に『完了』をクリック ・・・以上です。 これで、MDBファイルを直接開いても、問題なく起動できるようになっている はずです。 なお、万が一権限の復活が不充分だった場合を考えて、今回のMDWファイルは しばらく削除せずにおいて様子を見ておかれることをお勧めします(汗)
エラー処理を省いてシンプルに書くと、 Middle(　フイールド名;　　　　　　 Position(フイールド名;"<";1; 1)+1; Position(フイールド名;">";1; 1) -(Position(フイールド名;"<";1; 1)+1) ) で、いけます。
おそらく…… 手間も費用もかけず、インストールすれば即使えるソフトを、 ということでしょうが…… 御社の要望に合致するフリーソフトを見つけるのは難しいと思います。 汎用的な表計算ソフトや簡易データベースソフトになるでしょう。 大本は、他の方の意見と同じですが、どうしてもということであれば、 参考図書や経験者の多いもの（ExcelやAccessなど）をおすすめします。 相応の手間や費用は必要です。
> (1)ＡＣＣＥＳＳ（２００３）からＣＳＶを出力する際、「””」をうまく取る方法は無いでしょうか？ 手動でエクスポートし、ウィザードの「設定」ボタンをクリックすると、「文字列の引用符」を指定するところがあります。 それを保存しておき、 次回からは、その定義を使用してエクスポートしてください。 （手動、マクロ、VBA のいずれでも使用できます）
> Ａｃｃｅｓｓ2003で作ったデータベースを2007に引き継いで使用したところ！のマウス操作のくるくる回る所が作動してくれません！どうしてでしょうか？？？ http://support.microsoft.com/kb/967189/ja 2003 までは、意図せず移動してしまい マウスホイールを無効にするコードを書く必要があったのですが 2007 で、この機能はなくなり 歓迎している人も大勢いるようです。
Accessですが、 メニューバー＞ツール＞データベースユーティリティ＞最適化/修復 で、ちょっとは軽くなるかもしれません。 （バージョンをお書きになっていないのでその辺はよしなに・・・） なお、当方使用の2003の場合ですと、オプションの中に、「閉じるときに最適化する」というチェックボックスがありますので、それをオンにしておくと、いちいち手動で実行する手間が省けます。
認証機構を自前で用意するのは非常に面倒ですし、 セキュリティ的にちゃんとした物であることを保証するのは難しいですから、 .htaccess でのWWWサーバの認証機構を使った上で、 パスワードファイル(.htpasswd)を自前で更新する というのが比較的簡単で確実かと思います。 .htpasswd は1行1エントリの単純なテキストファイルですから、 それとは別に「有効期限」などを管理しておいて、 定期的に有効期限内のエントリだけを抽出して.htpasswdに書き出せば 期限付きアカウントになります。
ここで言ってる「プロンプト」とは、コマンドプロンプトではなく、Accessのクエリ実行時にパラメータ入力を要求してくる「ダイアログ」のことを指しているのでしょうか？（これをプロンプトを言われても判らない人が多いと思いますが・・・） もしそうなら、以下のようなSQLにすれば逝けると思います。 select * from TABLE where ([項目名１] is not null and 項目名 like ("*" & [項目名１] & "*")) or ([項目名２] is not null and 項目名 like ("*" & [項目名２] & "*")) or ([項目名３] is not null and 項目名 like ("*" & [項目名３] & "*")) []のパラメータ名が同じものは、何度出てきても1種類につき1回しか出てきません。
DoCmd.OutputTo acOutputForm, "F6_全データ", acSpreadsheetTypeExcel9 参考URL：http://accessblog.net/2008/10/export-to-excel-th …
> [Forms]![得意先フォーム]![txt検索]というパラメータがでて これが出る以上は、「得意先フォーム」が(直接)開いていないか、同フォーム上に 「txt検索」というコントロールがないか、のどちらかを考えるしかありません。 すでにフォーム名やコントロール名は何度も見直されていると思いますので、 その間違いはないとするなら・・・考えられるのは『「得意先フォーム」をサブフォーム として使っている』、といったところでしょうか。 上記の推測が正しければ、クエリの検索条件を以下のように変更してください。 (最上位のフォームが「メインフォーム」で、そこに埋め込んだ「得意先」サブフォーム 　のソースオブジェクトを「得意先フォーム」にしている場合) 【現在】 Like "*" & [Forms]![得意先フォーム]![txt検索] & "*" 【修正】 Like "*" & [Forms]![メインフォーム]![得意先]![txt検索] & "*" ※サブフォームの元になっている「得意先フォーム」の名前は、クエリの検索条件 　 の式上には出てきません。 　 (埋め込んだサブフォームコントロールが、同名だった場合は別として) なお、今回の質問の件とは直接の関連はありませんが、 > Set rs = Me.Recordset.Clone の「Recordset」と「Clone」の間の「.」は無用ですので、ご注意下さい。 (「RecordsetClone」でひと括り)
Accessについては詳しくないですが、標準SQLの考え方で。 複数行になりえる検索する場合、カーソルを使います。 カーソル宣言をしておき、次のようにSQLを実行します。 open（カーソルのオープン） ↓ fetch（カーソルを使って1行取り出し。対象行がなくなるまで繰り返し） ↓ close（カーソルをクローズ） 検索条件の値を、埋め込み（バインド）変数や ?パラメタ　を使っている場合は、open前にそれらの変数に値を設定しておきます。 そして、openすることで、検索対象行が決まり、ソートも行えるようになります。 open済の状態で、それらの変数の値を変えても、再openしなければ意味がありません。 つまり、検索条件を確定させ、検索した結果を、一時的なファイルのように扱っています。 参考までに、SQL例を示しておきます。 (1)カーソル宣言 declare cursor cr1 for select c1,c2,c3 from t1 where c1 between ? and ? order by c1 (2)カーソルをオープン open cr1 using 1番目の?に入れる値 -- 今回は、得たいc1の最小値 ,2番目の?に入れる値 -- 今回は、得たいc1の最大値 (3)カーソルがら行を1行ずつ取り出す fetch cr1 into :xc1 ,:xc2 ,:xc3 (4)カーソルのクローズ close cr1
＃２です > "日付", "品番ID", "設備ID", "売上", "生産数"　らの影武者をヘッダーに配置して 表現が適切ではなかったと思います。 それぞれに対応させる非連結のテキストボックスをヘッダーに配置して "tk日付", "tk品番ID", "tk設備ID", "tk売上", "tk生産数"　の様に名前付けする ということです。 いまだにこの方法は未検証です。 （多分、大丈夫かと）
失礼いたしました。こちらです。 http://publib.boulder.ibm.com/html/as400/v5r1/ic …
サンプル。 Sub Sample() 　　Dim dbs As DAO.Database 　　Dim tdf As DAO.TableDef 　　Dim fld As DAO.Field 　　Set dbs = CurrentDb 　　Set tdf = dbs.TableDefs("テーブル名") 　　For Each fld In tdf.Fields 　　　　fld.AllowZeroLength = True 　　Next End Sub
まずはSQL Server 2008自習書シリーズがお勧めです。 http://www.microsoft.com/japan/sqlserver/2008/se …
なかなかレスがつかないですね。 テーブルの書式変更などを行うためには、 通常のSQLでなくDDL（データ定義言語）を使うようです。 「Access　DDL」で検索してみてください。 データベースエンジン（ADOやDAO）により 記述方法が異なると思いますので 注意してくださいね。
選択クエリでクエリを作る際に三つのテーブルに リレーションシップをはったのであれば、 クエリデザインツールバーの集計でグループ化 すれば重複データは出てこないはずです。 質問内容と違っていたらすいません。
データベースとクライアント間の文字コードの違いは、一般的には、ミドルウエアが解決します。 今回の場合、EXCELは、ODBC等のドライバを経由して、SQLiteにアクセスするかと思いますが、 適切なODBCドライバを選択するなり、ODBCの設定かで解決できる問題かと思いますよ。 と思いつつ、SQLiteのODBCアクセスってやったこと無いので、調べてみると・・ http://kzworks.at.webry.info/200804/article_34.h … でODBCの不備で苦労してるようで、仕方なく、 http://kzworks.at.webry.info/200908/article_41.h … 日本語対応版を作ってるみたいですね。 参考まで。
A1のセルに"1"、B1のセルに"A"、 C1のセルに"-"、D1のセルに"6"、 E1のセルに"6"と入力された状態で、 F1のセルに"1A-66"と表示したいということですか？ そうであれば、F1のセルに次の数式を入力すれば 目的の通りになるかと思います。 =A1&B1&C1&D1&E1
「■あああああ」ごとセンタリングしたいということでしょうか。 <table align="center"><tr><td> <table bgcolor="#ffff00" border="1" bordercolor="#c0c0c0" cellspacing="1" cellpadding="5" width="10" height="15" align="left" valign="top"> <tr><td bgcolor="#ffff00"></td></tr> </table> <font color="#44c600">ああああああ</font> </td></tr></table>
■　「外部参照」と書かれているのが, 参照整合性制約 (referential integrity あるいは foreign key constraints) だとします． ■ PRAGMA foreign_keys = true が必要です． ■ SQLite のバージョン 3.6.19 から使える機能 http://www.sqlite.org/changes.html 参考URL：http://www.db.is.kyushu-u.ac.jp/rinkou/addb/2.html
データテーブルへ格納するのは（一般的には）顧客IDでしょうね（一意ですよね）。 >顧客名から顧客名(英語名)をselectした場合に、顧客名は一意でも >顧客名(英語名)が一意ではなかった場合に問題が起きます。 意味がよくわからないのですが >マスタを修正した場合には３．で過去データを >参照する時に修正後のマスタ情報が表示されてしまいます。 顧客マスタの履歴管理をおこなうのであれば、 ・顧客ID(PK) ・適用開始年月日(PK) ・適用終了年月日 ・顧客名 ・顧客名(英語名)
> 仕入マスタに新規レコードをフォームから追加する際、 > 品番を入れたら商品マスタから商品名が参照され表示される、というフォーム 以下は、追加の時だけ表示するものではなく、常に表示されるものになります。 （商品マスタの品番には、重複がないものとします） 「仕入マスタのフォーム」が既にあるようですので、「品番」の横にでもコンボボックスを追加します。 ラベル部分は要らないと思うので、ラベルは削除しておきます。 コンボボックス名を「cbx品番」としたとします。 プロパティで以下を変更していきます。 コントロールソース：　品番 列数：　２ 列幅：　0cm;4cm　　（１列目を非表示に、２列目の幅は適当に） 値集合ソース：　SELECT 品番, 商品名 FROM 商品マスタ; 　　（並び順があるのなら追加で指定します） 連結列：　１ タブストップ：　いいえ これにより、「品番」テキストボックスの値を変えると、コンボボックスの表示も変わります。 また、コンボボックスを変更すると、「品番」テキストボックスの値が変わります。 新規ボタンが、「仕入マスタのフォーム」にあるのなら、以下のような書き方でいけると思います。 Private Sub 新規_Click() 　　Me.AllowEdits = True 　　Me.AllowAdditions = True 　　DoCmd.GoToRecord , , acNewRec End Sub Private Sub Form_Current() 　　If (Not Me.NewRecord) Then 　　　　If (Me.AllowEdits) Then Me.AllowEdits = False 　　　　If (Me.AllowAdditions) Then Me.AllowAdditions = False 　　End If End Sub ※　新規ボタンを押すまでは、編集/追加できないようにする、という前提で。 ※　新規ボタン押したけど、何もせずに他へ移動しても大丈夫なように。 　　（レコード移動時に新規でなければ、Falseへ、重複設定を避けるように True の時のみ） ※　新規の時のみコンボボックスを表示するのなら、上記タイミングで Visible を設定すればよいと思います。
単純にして味わい深くかつ巧妙なSQL文ですが、直積というヒントでこのSQL文のからくりをイメージ 出来たとはすばらしい。もはや上級者の仲間入りです。SQL文と直積の概念を結びつけるのは大変です 。集合を十分わかっていないとイメージがわかないものです。ましてや指定のテーブルを使って直積 の概念を取り入れた題意のSQLを一つだけ開発しなさい、と言われたとんでもない難問です。 何か少し疑問が残ったみたいですが、Ms Accessを持たれていたら以下のSQLを登録して実行してみて ください。ただしMs Accessはこのままで受け付けますが、登録後に若干の変更を行います。これは Ms Accessの方言だと思ってください。実行すると商社.商社番号を問い合わせてきます。そのときに 納品していないものがある商社の商社番号を入れると、納品していない商品を実行結果として表示 します。ここがこのSQLのミソです。 SELECT * FROM 商品 WHERE Not EXISTS (SELECT * FROM 納品 WHERE 納品.商品番号=商品.商品番号 And 納品.商社番号=商社.商社番号); もちろんデータが大量にある場合は商社テーブルのレコードをループしながら商社番号をこのSQLに 送り込むプログラムが必要ですが、数個のレコードでこのからくりは確認出来るのでそこまでは必要 無いと思います。 また直積という概念はSQLを自在に扱う上で重要なカギの一つとなります。ただ、このSQL文に内在 する見えるデータと見えないデータをTrueとFalseというスイッチではなく、Exsitsあるいは Not Existsという言葉の概念で捉えてください。たしかにTrueやFalseを条件の判断に使う データベース(例えばMs Access)がありますが、本来はこのSQL文が標準的な書き方です。直積が わかればTrueとかFalseという補助手段は必要ありません。そのほうが将来のためです。 データを処理するアルゴリズムとこまごまとしたテクニックは分けて考えてください。 必要があればテクニックは後からついてきます。そっか、アルゴリズムを構築するときはTrueとか Falseを使いますよね。話が少々迷路に入りかけているのでこのあたりにします。がんばってください。
VBAを走らせるためのOSに組み込まれたプログラムがXPと7では違います だからもしかするとそのプログラムのバージョン(OSのバージョン)が関係しているのでは、と考えます
> リストフォームとは、帳票形式のフォームになりますか？ 以下参考になると思います。 カレント行の背景色の変更 http://hatenachips.blog34.fc2.com/blog-entry-18. … その３まであるようです。
食べ物テーブルが食べ物の名前だけならば、そんな風に作ったっていいと思います。 でも、どうして、中間テーブルを作るか・・・・下の説明では、1レコードを1行で書いて、レコードを下に並べて書きます。 人 食べ物 1 寿司 1 すき焼き 2 寿司 2 そば 3 すき焼き 3 うどん 説明しやすい単純な例は、例えば、「寿司」を後で「鮨」と直そうと思ったとします。 中間テーブルの方法ですと、食べ物テーブルの1レコードを直すだけですみますね。ところが、中間テーブルを使わない方法ですと、寿司のあるレコードを全部直さなければなりません。 まあ、でも、食べ物を「寿司」という"記号"あらわすか、「1」で代用するかは、あまり本質的な問題ではありません。 実は、食べ物テーブルが食べ物の名前だけならいいのですが、普通、そのほかのデータが一緒に書いてあるのが一般的です。 寿司 カロリー 定価 和食・・・・ などというように、ですね。 これを中間テーブルを作らない方法にすると、不便さが倍増します。 人 食べ物 和洋 定価 1 寿司 和食 100円 1 すき焼き 和食 300円 2 寿司 和食 100円 2 そば 和食 200円 3 すき焼き 和食 300円 3 うどん 和食 50円 後で、寿司の定価を150円に直そうと思ったとき・・・あまり考えたくないですね。 それに同じデータが何回も何回も入っているのはスペースの無駄ですし、入力の手間も無駄で、間違いが起こりやすくなります。 更に、うまい簡単な例が思いつかないのですが、これでは、データをいろいろな用途に使いまわすにも不便なのです。
勤怠(従業員IDと勤務日からなる。)を記録したテーブルを[T_勤務]として、 1)作業クエリ[Q_時給]を定義： SELECT [T_勤務].[従業員ID], [T_勤務].[勤務日], Max([T_時給].[発令日]) AS 最終発令日 FROM T_勤務 INNER JOIN T_時給 ON [T_勤務].[従業員ID]=[T_時給].[従業員ID] AND [T_時給].[発令日]<=[T_勤務].[勤務日] GROUP BY [T_勤務].[従業員ID], [T_勤務].[勤務日]; 2)[Q_時給]と[T_時給]を組み合わせて、[Q_給料]を定義： SELECT Q_時給.従業員ID, Q_時給.勤務日, T_時給.発令給 FROM Q_時給 INNER JOIN T_時給 ON Q_時給.従業員ID = T_時給.従業員ID AND Q_時給.最終発令日 = T_時給.発令日; ――で、どうでしょう。
SQL-Server 2008 Express は無償で利用できます。4Gまでの制限があります。 これで試してみてデータが増えてきたら有償版に移行すればいいのではないでしょうか。 設計をお見直すことも必要だと思いますが。
考え違いです。テーブルの値を使う場合はVALUES句は使いません。 INSERT INTO カウンタ統計 ( [DATE], USER_COUNT ) SELECT Date() AS [DATE], COUNT(*) AS USER_COUNT FROM hiplus_HW_USER
追加の説明です。"tableBのpointerはtableAのidを指しています"の 私の解釈について説明をしておきます。 tblBのpointerフィールドに足し算の相手となるtableAのidが入力され ているというように解釈しています。tableBのpointerフィールドには ランダムにtableAのidが入力されている、ということです。では。
>大量ファイルを読み込み、ファイル情報をSQL(SQLite)に追加 具体的に母体データが何件くらいあり、その内、何件くらいが操作対象になるのでしょうか？ 表の列構成、インデクスの定義方法、どういうSQLで操作しているのか、といったことを提示しなければ、誰も適切なアドバイスはできません。
複製数というグローバル数字フィールドを作って、ここに複製したい数を 入力して次のスクリプトを動かす。 Loop 　レコード/検索条件複製 　フィールド設定 [複製数 ; 複製数-1 ] Exit Loop If [ 複製数=0 ] End Loop
エラーの内容が分かりません。 ラベル印刷用のクエリを準備します。 クエリの全件を出力するように印刷するものだけ集めます。 次に、宛名ラベルウィザードに沿ってラベルのレイアウトを決めます。 http://office.microsoft.com/ja-jp/access/HA10007 … テーブルまたはクエリの配置するフィールドを選択して、 完了します。 次に今作ったレポートをデザインビューで開きます。 適当に選んでいて、もし1つのテキストボックスになっていて、 式で書かれていた場合、このテキストボックスを消します。 表示→フィールドリスト でフィールドリストを表示させます。 フィールドリストの中で 表示させるフィールドを選択して ドラッグアンドドロップします。 住所など長いものは、表示できる長さにするか、 2行で表示できるように大きさを調整して下さい。 クエリ作成前に、住所データを住所1、住所2とか分割するのも手です。 こうすると、面倒なラベル自体のレイアウト関係だけ ウィザードを使い、内容部分だけシンプルに配置することができます。 レポート上で式を書くのではなく、 クエリの時点でまとめておいた方がスッキリすると思います。
#2 再回答です。 要点だけで、サンプルを作りました。 サンプルでは、内容確認のために「社員NO」自体も入っていますが、 非表示でも項目無しでも同じ動作が可能です。（＝所属＆氏名のみ表示） また、面談者の氏名＆企業名は、T2_面接　テーブルに項目追加すればよいです。 作成手順は・・・ クエリの画面で、面接用のテーブルにある各社員NOに対して、それぞれ社員テーブルをリンクさせます。 次に、「社員1」とつながった社員テーブル内の、所属＆氏名をダブルクリック。 次に、「社員2」とつながった社員テーブル内の、所属＆氏名をDクリック。 次に、（サンプルには社員NOもあるため）、それぞれの社員NOもDクリックです。 このクエリを、「SQLビュー」で表示させると、以下の内容になります。 SELECT T1_社員.所属, T1_社員.氏名, T1_社員_1.所属, T1_社員_1.氏名 FROM (T2_面接 INNER JOIN T1_社員 ON T2_面接.社員NO１ = T1_社員.ID) INNER JOIN T1_社員 AS T1_社員_1 ON T2_面接.社員NO2 = T1_社員_1.ID; 当然ながら、二つのテーブルを作成し、「ツール」⇒「リレーションシップ」内であえて設定をせずに、サンプルのクエリ内での設定を行うだけで、実現可能です。
ご参考まで。 宛名ラベルを指定位置から指定枚数 印刷する方法 参考URL：http://www.f3.dion.ne.jp/~element/msaccess/AcTip …
Access 2000 で試している PC と、Access 2003 で試している PC とは同じ PC ですか別の PC ですか？ 別の PC であった場合、OS は同じバージョンですか？ プリンターは同じものですか？ プリンター ドライバーは同じものですか？ 別のプリンターである場合、切れてしまう Access 2003 の PC で印刷してみたプリンターに、Access 2000 の PC からも出力してみたり。 という所も確認してみたり。
Dim app As Object Dim sourceBook As Object Dim sourceSheet As Object Set app = CreateObject("Excel.Application") Set sourceBook = app.Workbooks.Open(CurrentProject.Path & "\h.xls") Set sourceSheet = sourceBook.Worksheets(1) iUsed = sourceSheet.UsedRange.Rows.Count せめてこれぐらいまでは参照をする。
>検索条件を保持したまま、うまく検索条件を追加していく方法 検索モード時の 対象レコードの拡大 対象レコードの絞り込み
Excelだけで作業出来そうなアイデアです。 まず、住所録のシートに、「印刷：要・不要」の項目を作り、 例えば　１：要、２：不要　として、全件の判断を入力します。 次にフィルタの機能を使って、印刷するものだけを画面表示させます。 その状態で、先頭の行から末尾の行までを「範囲選択」して、 別のシートへコピーします。 これで、データの準備は完了です。 後は参考のサイトを読んでみてください。 参考URL：http://hamachan.info/word/atena.html
#1です。 前回答えを書いたつもりだったので、補足になりますが。。 >なるほど、FROMでAを指しているところでエラーというわけでしょうか エラーはおきません。SELECT文の結果がゼロ件で何も登録されないというだけです。 >この点も合わせて、SELECTにDISTINCTをつけて以下のようにすれば解決するでしょうか？ なぜBLOODテーブルだけにしたのにDISTINCTが必要と思いましたか？ BLOODテーブルはマスタですから、データは４件だけで重複はありませんよね。 このあたりが机上学習の弱さですかね。。 無料で使えるものを入れてみては？
ターゲットを指定しないから、せっかく開いたフォームを 閉じてしまっているのです。 DoCmd.Close acForm, Me.Name とします。
あなたの独断で動くのはお勧めしません。 プライバシーを侵害する行為だからです。 http://www.google.com/search?hl=ja&lr=lang_ja&ie … あなたが直接消してしまったファイルだけじゃなく、あなたにメモリを貸す前に友人が削除したデーターも見えてしまう可能性があるってことを考えてみてください。 単に空き容量をかせぐためだったのか、あなたに見せたくないデーターだったのかは友人のみが知ることです。 データーを復活させるフリーソフトの存在を友人に知らせるぐらいにしておいたほうが良いでしょう。
＃１です > 指定しているクエリは抽出結果のフォームなのですが 既に抽出結果をフォームに表示しており、それをExcel出力したいということでしたか？。 抽出結果を表示しているフォーム名を「F1」と仮定します。 Private Sub 伝票発行_Click() 　　Dim app As Object 　　Dim iRow As Long 　　Dim iColm As Long 　　iRow = 12 　　iColm = 1 　　Set app = CreateObject("Excel.Application") 　　app.Workbooks.Open filename:=CurrentProject.Path & "\nouhinsyo.xls" 　　app.Worksheets(1).Select 　　With Forms("F1").RecordsetClone　' ★ 　　　　.MoveFirst 　　　　While (Not .EOF) 　　　　　　app.Cells(iRow, iColm + 2) = !品番 　　　　　　app.Cells(iRow, iColm + 3) = !商品名 　　　　　　app.Cells(iRow, iColm + 4) = !受注数の合計 　　　　　　app.Cells(iRow, iColm + 8) = !備考 　　　　　　.MoveNext 　　　　　　iRow = iRow + 1 　　　　Wend 　　End With 　　app.Visible = True　' ☆ 　　Set app = Nothing End Sub ※ ☆では、Excel書き込み保存していません。（結果を表示する状態） 　　書き込み保存用に変更してください。 ※ ★では、自分のフォームに抽出結果が表示されているのなら 　　With Me.RecordsetClone 　　に書き換えてください。 ※※ 0件の時に実行するかは処理を盛り込んでください。 　　.MoveFirst でエラー？
(1)VBAでやる方法 A.データベースウィンドウで「モジュール」の新規作成を行う。 B.イミディエイトウィンドウで、"DoCmd.～"を打ち込み、Enterする。 (2)マクロでやる方法 A.データベースウィンドウで「マクロ」の新規作成を行う。 B.添付画像のように設定して保存する。 C.上記マクロを実行する。
いまいち理解できないのとEXCELのバージョンが不明ですが excel2007ならば コンボボックスで選択する値の一覧を作成して データ→データの入力の規則→データの入力の規則 で入力値の種類をリストにして選択値の範囲を指定すればコンボボックスはできますよ。
どこかのブログの話ですか? どこのことか分からないと回答ができません。
普通にフィルタ機能とコピー＆ペーストではダメでしょうか？
試しに CurrentDb.Execute str_SQL に変更してみては。
私はジジイなので、若い頃はスポ根的にカラダで覚えました。 当時はCPUは遅く、メモリも少く、DBエンジンの頭も悪かったので、 単に結果が得られるだけではダメで、処理速度も求められました。 会社の若手にSQLを教える時は事例を示し、口頭で説明するように しています。「百聞は一見に云々」でして、こうすると大体は理解 してくれます。SQLはプログラムのように多数のステップから構成 されるわけでは無いので、理論の組み立てが重要です。 本とか、このような場での文字表現では表現する方も、理解する方も 難しさが伴います。 とりあえず、必要なデータ、条件などを箇条書きにすることを薦め ます。あとは事例ごとに自分の考えたSQLをこういう場に提示して、 添削を求めることで、自分の引き出しを多くするくらいでしょうか。
参照整合性の意味を誤解または「判っていない」ようです。 参照整合性は、例えば「キー」となるフィールドに誤ったデータを入れ、それでリレーションを取ったあと、正しい値に修正しても、リーれーションが担保されるための機能です。 従って「前の住所や旧姓もそのまま残し、前のお名前での利用履歴なども残す」ためには、それに適したＤＢの設計をする必要があります参照整合性があってもなくても、直接は関係ありません。
取引時の通貨コード、金額と決済時の通貨コード、金額の両方が 必要なのでは？ 私は証券取引の経験しかないのですが、値洗いは当日のレートで ドル換算でやってました。勿論、テーブルに記録するのではなく、 SQLで動的計算結果を出力するのですが・・・ 決済すると、損益が確定する（その後変動しない）ので、テーブルに 記録しても良いでしょう。 尚、通貨別に複数フィールドを設ける方法は薦められません。
＃３です > rs.Source = "SELECT * FROM 社員マスター WHERE 部署名 = '人事部';" > ★ rs.Open , CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly １行目は、「社員マスター」から「部署名」が人事部であるレコードを得るものです。 テーブル名、フィールド名が正しいか確認してみてください。 （テーブル名が違うのでしょうか？） 以下記述にも「社員マスター」「部署名」が出てきますが、それぞれ確認してください。 > 人事部から経理部などに変わった時にも使えるのでしょうか？ 部署の選択をコンボボックスで行うとします。（コンボボックス名を「cbx1」と仮定） コンボボックスは非連結です。 そのコンボボックスのプロパティ「値集合ソース」を SELECT DISTINCT 部署名 FROM 社員マスター; とします。 これにより「部署名」に登録されているものを選択できるようになります。 この処理を付加した一連の処理例は以下 Private Sub コマンド12_Click() 　　Dim rs As New ADODB.Recordset 　　Dim toAddress As String, ccAddress As String, bccAddress As String 　　Dim sSubject As String, sMes As String 　　Dim sTmp As String 　　toAddress = "aaaa@bbbb.cccc" 　　ccAddress = "" 　　bccAddress = "" 　　sSubject = "業務連絡（明日の予定）" 　　sMes = "お疲れ様です%0d%0a明日はXXXさん休暇です%0d%0a頑張っていきましょう" 　　If (Not IsNull(Me.cbx1)) Then 　　　　rs.Source = "SELECT * FROM 社員マスター WHERE 部署名 = '" & Me.cbx1 & "';" 　　　　rs.Open , CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly 　　　　While (Not rs.EOF) 　　　　　　bccAddress = bccAddress & ";" & rs("メールアドレス") 　　　　　　rs.MoveNext 　　　　Wend 　　　　rs.Close 　　　　If (Len(bccAddress) > 0) Then bccAddress = Mid(bccAddress, 2) 　　End If 　　sTmp = "" 　　If (Len(ccAddress) > 0) Then 　　　　sTmp = sTmp & "&Cc=" & ccAddress 　　End If 　　If (Len(bccAddress) > 0) Then 　　　　sTmp = sTmp & "&Bcc=" & bccAddress 　　End If 　　If (Len(sSubject) > 0) Then 　　　　sTmp = sTmp & "&Subject=" & sSubject 　　End If 　　If (Len(sMes) > 0) Then 　　　　sTmp = sTmp & "&Body=" & Replace(sMes, Chr(&H20), "%20", , , vbBinaryCompare) 　　End If 　　If (Len(sTmp) > 0) Then Mid(sTmp, 1, 1) = "?" 　　MsgBox "Mailto:" & toAddress & sTmp '　　CreateObject("WScript.Shell").Run "Mailto:" & toAddress & sTmp End Sub ※　文字列が作られているか確認のため最後で MsgBox で表示しています。 大丈夫そうなら、MsgBox をコメントに、次の行を有効にしてください。 ※　コンボボックスで選択されていない時には、BCCは作りません。 ※　toAddress には、自分とか、代表のアドレスを設定してください。
＃３です > それで、条件入力フォームの「受注元」部分（コンボボックスで取引先リストを参照して、これを選ばせていた）を、ただのテキストボックスにかえたら。。 > 出るようになりました。（＞＜） コンボボックスということなので、後は、連結列を確かめてみてください。 例えば、「値集合ソース」が、 SELECT 受注元ID, 受注元 FROM テーブル名; の様に２列以上抽出していたとして（上記では２列）、 連結列：1 列幅：　0cm;2cm としていると、表示上は「受注元」のみが表示されますが、 このコンボボックスの値は連結された１列目「受注元ID」となります。
エクセルで次のマクロを使うと実行できます。 Sub Macro1() ' ' Macro1 Macro ' マクロ記録日 : 2009/11/11 ユーザー名 : ' Dim mygyo1 As Integer, myretu1 As Integer, mygyo2 As Integer, myretu2 As Integer, myid As Integer, mymygyo1 As Integer mygyo2 = 2 mygyo1 = 2 myretu1 = 2 Do myretu2 = 4 Cells(mygyo2, myretu2).Value = Cells(mygyo1, 1).Value myretu2 = myretu2 + 1 Do Cells(mygyo2, myretu2).Value = Cells(mygyo1, 2).Value 'Cells(mygyo2, myretu2).Value = Cells(mygyo1, myretu1).Value mymygyo1 = mygyo1 mygyo1 = mygyo1 + 1 myretu2 = myretu2 + 1 Loop While Cells(mygyo1, 1) = Cells(mymygyo1, 1) mygyo2 = mygyo2 + 1 Loop While mygyo1 < 8 ' End Sub
Access(MDB)でもSQL Serverでも、フロントエンドはACCESSですね？ 基本的にはデザインビューでクエリを作成して、SQLビューでSQL文表示するのが簡単でしょう。 テーブル４．Cards テーブルの構造からするとKindOfCardで暑中見舞い／年賀状を識別するんですかね？ １）Where条件をKindOfCard＝Yesにして、IndividualID別CardID別別にmax(SendYear)とmax(ReceiveYear）を取得するクエリを作成。 ２）Where条件をKindOfCard＝Noにして、IndividualID別CardID別別にmax(SendYear)とmax(ReceiveYear）を取得するクエリを作成。 ３）テーブル１～３を結合して送付先を取得するクエリを作成。 ４）１）と２）と３）を結合（３のすべて、１・２はあるもの）年は４列アリ ５）１）２）のSendYearとReceiveYearを判断して、不要なものを表示しない。 の５段階で作成していくことになると思います。 「一文で表記したい」なら、１）～５）を纏めることで対応できそうですね。
VBAでの処理 Sub 行転記() 　　Dim ws As Worksheet　'転送先シート 　　Dim Lastline As Long　' 　　Set ws = Worksheets("シート2") '転送先シート 　　Lastline = ws.Range("A" & Rows.Count).End(xlUp).Row + 1 '最後の行番号+1をLastlineに 　　ws.Range("D" & Lastline).Value = Range("B14").Value 　　ws.Range("H" & Lastline).Value = Range("B25").Value 　　ws.Range("I" & Lastline).Value = Range("B24").Value End Sub で書いてあることはできると思います。 転記項目もこれだけではないでしょうが、増やすことも難しくないでしょう。（納品日、金額など） ただ、納品書も複数行あるようですのでその部分は少し工夫が必要でしょうが 頑張ってください。
> レポートにある情報IDのフィールドの値を、新規追加するフォームに > コピーすることはできますでしょうか？ フォームと違い、レポートでは「現在のレコード(クリックしたデータ)」を取得する 手段がないのでできません・・・と言おうと思ったのですが、改めてAccess2007 で確認してみたところ、できました(汗) ・・・Access2003から、だいぶ様変わりしているようで・・・(汗) とりあえず、レポートで「情報ID」を表示しているテキストボックス(仮にtxt情報ID とします)のダブルクリックでフォームを開くと同時に、その情報IDをフォームの同名 テキストボックスに代入する、というコードを、参考までに以下に示します。 (本当にポイントだけですが(汗)) 'レポート側：txt情報IDの「ダブルクリック時」イベント Private Sub txt情報ID_DblClick(Cancel As Integer) 　　'DoCmd.OpenFormのOpenArgs引数を使用して、フォームに情報IDを渡す 　　'(「情報IDの最小値=1」の前提で、Nullは0に変換：実際にない値なら何でも可) 　　DoCmd.OpenForm "[F_記録]", , , , acNewRec, , Nz(Me!txt情報ID, 0) End Sub 'フォーム側：フォームの「開く時」イベント Private Sub Form_Open(Cancel As Integer) 　　Dim InfID As Long 　　'OpenArgsで渡された情報を確認 　　InfID = Me.OpenArgs 　　'渡された情報が空でなかったら、txt情報IDテキストボックスに代入 　　'(情報IDの最小値が0なら、ここの「InfID > 0」も「InfID > -1」等に変更が必要) 　　If InfID > 0 Then Me!txt情報ID = InfID End Sub ・・・以上です。
まず、異なるMDBファイルに保存されているA・Bのテーブルを比較するための環境を作ります。 これは、C.mdbとでも名づけて新たに作成しましょう。 （以下はC.mdb内での処理記述となります。） A・Bそれぞれに存在する、同名のテーブルへリンクを行い、 C.mdb内で比較すべき２つのテーブルを扱えるようにします。 後は、下記参考ページの説明に従って作業を進めることができます。 やってみると、それほど難しいものではありませんので、頑張ってください。
No.1です。 > ここはすべて右揃えです このサイトにアップすると連続する半角スペースが削除されてしまうのと、フォントに よって文字幅も変わるので、意図を汲み損ねていたらすみませんが、 小数点で揃えず、テキストボックスに右揃えにする、ということでよろしいでしょうか。 前回は、入力・編集も行う可能性を考えての回答でしたが、参照・表示専用で よければ、以下の方法で対応できます。 また、今回の方法であれば、整数データの場合に小数点(「.」)を表示させずにおく こともできます。 (なお、更にやり方を変えれば、入力/編集にも対応可能ではありますが、VBAを 　使用してかなり厄介な制御をすることになるので、お勧めはできません) 仮に、現在のテキストボックスの『コントロールソース』プロパティ(→プロパティシートの 『データ』タブにあります)が「フィールド1」だった場合、同プロパティを以下のように 変更して下さい。 【現在】 フィールド1 【変更後】 =Format([フィールド1], IIF([フィールド1]-Int([フィールド1])=0, "\\#,##0", "\\#,##0.0#")) ※先頭の「=」は必須になります。 これで、後は『書式設定 (フォーム/レポート デザイン)』ツールバーで右揃えを指定 してやれば、ご希望の書式になるかと思います。 <関数の概略> 　・Format関数： 　　第1引数で指定した値を、第2引数で指定した書式にします。 　・IIF関数： 　　第1引数の条件を満たす場合は第2引数を、満たさない場合は第3引数を返します。 　　(上の式では、第2引数で整数の場合の、第3引数で小数ありの場合の書式を指定) 　・Int関数： 　　引数の数値の整数部分を返します。 　　(この結果と、元の値が一致すれば(=差が0)、小数部分がない(=整数)と判断)
大丈夫です。 心配なら SQL 部分をクエリのSQLビューに記述し、デザインビュー表示にしてみてください ただし、項目4　は、そのテーブルにあるフィールドになります。
　原則として、現行で行っている記事の管理方法をそのまま踏襲なさった 方が、トラブルの発生を極力抑えることができると思います。 　※現行とは、まったく違った手法をとった場合、実際問題として、 　どのような想定外のトラブルが発生してもおかしくありません。
再び＃１です。 ＞それはやったが、 そうでしたか・・・それは失礼しました。 Access97に保存されているものが、テーブルだけであるならば・・・ ２００個のファイルからテーブルを一つにインポートする処理を（Access97で）記述し、それでファイル変換という手がありそうですが。 また、あなた自身のAccess知識次第では、上記前提に関係なく、処理を記述して実行できます・・・・が、どちらが早く終わるかは、貴方次第なのが難点ですね。 ご存知かも知れませんが、Accessユーザーの集まるサイトを紹介しておきます こちらで同じ質問を出してみてはいかがでしょうか？ ただし、提案される手段によっては上記の様にAccess97に保存されている内容に左右されることも考えられます。 具体的にAccess97の内容までを記入して質問をしないと、折角の助言を無駄にしてしまう結果になる事も十分に考えられます。 ご承知の通りと思いますが、質問側の注意と、善意の回答者さんに対する依頼側の配慮が必要ですので、（別の質問をどこかでする場合には、）ココの質問の説明だけでは不十分だとも思われます。 決定打を提供できず、残念ですが、良いアイデアが頂けると良いですね。 参考URL：http://www.accessclub.jp/
プログラムより算数の質問ですね。 エクセルのセルに =1-0.6912*25/30 と入れてみてください。
クエリの作り方でいいですか 以下に手順） ・クエリをデザインで作成します ・テーブル「T_顧客」を１つ、テーブル「T_紹介者」を５つ表示させます。 テーブル「T_紹介者」を５つ表示させると、テーブル名のところが、 「T_紹介者」、「T_紹介者_1」～「T_紹介者_4」になっていると思うので、 「T_紹介者」を表示上から削除します。 「T_顧客」、「T_紹介者_1」～「T_紹介者_4」の５つが表示されているようにします。 ・「T_顧客」の「紹介者１」を「T_紹介者_1」の「ID」にドラッグします。 結合線が表示されるので、線をダブルクリックします。 結合プロパティは、'T_顧客'の全レコードと・・・・　に変更しOKボタン 紹介者２～４も同様に、 「紹介者２」を「T_紹介者_2」の「ID」に 「紹介者３」を「T_紹介者_3」の「ID」に 「紹介者４」を「T_紹介者_4」の「ID」に 結合プロパティは、'T_顧客'の全レコードと・・・・　に全て変更しOKボタン ・以下の順番にテーブル内の項目をダブルクリックしていきます。 「T_顧客」の「ID」「住所」「氏名」「TEL」 「T_紹介者_1」の「氏名」 「T_紹介者_2」の「氏名」 「T_紹介者_3」の「氏名」 「T_紹介者_4」の「氏名」 ・下に表示されている一覧部分のフィールド欄のところの「氏名」が重複しているので、 テーブルが「T_紹介者_1」の「氏名」を「紹介者1: 氏名」に変更します。同様に テーブルが「T_紹介者_2」の「氏名」を「紹介者2: 氏名」に テーブルが「T_紹介者_3」の「氏名」を「紹介者3: 氏名」に テーブルが「T_紹介者_4」の「氏名」を「紹介者4: 氏名」に このクエリの表示を、データシートビューに切り替えてみます。 良かったら保存します。
「起動時の設定」 で 「既定のショートカットメニュー」がオフになっているのでは？ Access2007 なら 「Accessのオプション」 の 「カレントデータベース」にあります。
再び＃１です。 ＞回答ありがとうございます。 どういたしまして。 補足された利用者側の希望を考慮すると、質問者さんが補足内で疑問に思っていたことの説明よりも、別の「基本仕様」について記入する方が良さそうです。 利用者のご希望を推測すると、「帳票形式のフォーム（Excelのシートのような感じ）」よりも、「単票形式（１レコードづつ画面表示）」での「データ閲覧」で良さそうですね。 つまり、レコードごとの比較には重点が置かれておらず、１レコード分の各項目を（クリックなどの作業無しで）見やすく表示されている方が大事ということです。 その様な場合では、１画面で表示する項目の「配置」と「大きさ」を工夫することで、TXTBOXのサイズ変更無しで、見やすい閲覧画面を作成できます。 この様な場合では、（TXTBOXの文字数にもよりますけど、）最初から大きなサイズ（＝項目の保持できるバイト数を表示可能なサイズ）でBOXを設置するのが良いでしょう。 また、↑の様な項目が多く、１画面に収まらないなどの場合は、「タブ」を設置し、タブ内に（カテゴリ分けした）項目を振り分けるなども効果的です。 まあ、表示する文字数の多いBOXをタブで切り替えて見られるようにしても良いですし。 画面のデザインは、ある程度のセンスが必要だと思いますが、「一番利用する人」の意見を何よりも優先させ、後は工夫次第で知識が少なくても十分に使えるものが作成できますよ。 頑張ってください。
Access97 の場合、 リンクテーブルマネージャは メニューの [ツール] - [アドイン] にありますが そこに無いということでしょうか。 その場合、一番簡単なのは、 一度、リンクテーブルを削除し、 改めて、リンクテーブルを作成することだと思います。 念のために、リンクテーブルの作成は メニューの [ファイル] - [外部データの取り込み] - [テーブルのリンク] です。
その MDB は開くと何かを自動表示するようになってますか？ フォームを開くとか。 たった 1文字の "2" にこだわらずオブジェクトやプロシージャ等の名前の付け方で "2" を使ってる物はありますか？ 全角文字の "２" を使ってるとか。 という確認を行ってみるのも手だと思います。
GetObject を使うのに、開くべきデーターファイルが決まってるんだったら Dim oDoc As Object Set oDoc = GetObject("C:\filename.doc") oDoc.Application.Visible = True てのがシンプルかと。 GetObject の第1引数のみを使う方法です。 この場合、GetObject で返ってくるのは Word Document への参照なので、Word Application はその親になります。
Access での回答になります。 横での計算は苦手なので、ユーザ定義関数を作成します。 Public Function Check11_20_3(ParamArray iNum()) As Boolean 　　Dim i As Integer 　　Dim iCount As Integer 　　iCount = 0 　　For i = LBound(iNum) To UBound(iNum) 　　　　If ((iNum(i) >= 11) And (iNum(i) <= 20)) Then 　　　　　　iCount = iCount + 1 　　　　End If 　　Next 　　If (iCount >= 3) Then 　　　　Check11_20_3 = True 　　Else 　　　　Check11_20_3 = False 　　End If End Function テーブル名を miniloto と仮定した場合、クエリでは SELECT N1, N2, N3, N4, N5 FROM miniloto WHERE Check11_20_3(N1,N2,N3,N4,N5); とします。 ミニロトのデータだと思いますが、他のフィールドに回はありますか？ 回フィールドがあったとして（提示では１～１１） SELECT 回, N1, N2, N3, N4, N5 FROM miniloto WHERE 回 IN ( SELECT 回 FROM (SELECT 回, N1 AS N FROM miniloto UNION SELECT 回, N2 AS N FROM miniloto UNION SELECT 回, N3 AS N FROM miniloto UNION SELECT 回, N4 AS N FROM miniloto UNION SELECT 回, N5 AS N FROM miniloto) GROUP BY 回 HAVING SUM(IIF(N >= 11 AND N <= 20,1,0)) >=3 ) ;
アクセス2000で試してみました ページフォーマット時　× 開く時　○ 詳細のフォーマット時　○ 何故そうなるのかは判りません。
1商品1レコードのテーブルを作り、商品DBと商品番号でリレーションして 詳細フィールドはルックアップなどを設定します。 納品書にはこのテーブルのポータルを作成してポータルに入力します。
Web デザインが得意（HTML に堪能）なのは，とても良いと思います． HTML の中に「プログラム」を埋め込み，そのプログラムの中から データベースにアクセスします． つまり,　おおまかに言って、 1. HTML (Web) 2. プログラム (HTML 生成や HTML フォーム等を含むソフトウエア) 3. プログラムとデータベースの仲立ち 4. データベース管理システム の4つの組み合わせになります． 2 -> PHP, 3-> PHP用のソフト, 4 -> MySQL は定評のある組み合わせです．書籍は大量にあります 一方で、Ajax とか目新しいことを考えておられるなら 2 -> eRuby (単純に Ruby ということもある), 3 -> ActiveRecord, 4 -> MySQL が向いている可能性があります．これも「Ruby」、「Rails」というキーワードで本を探すと、多数見つかると思います． 本の好みがあると思いますので、ご質問からは具体的な書籍名を示せませんが、「初心者」と書かれておられますので、Java, C, C++ は避けた方がよいように感じます． 「何をなさりたいか」　（例えば、営業で同業者に勝ちたいなど下世話な観点も含め）　がより具体的に書かれていましたら、より踏み込んだ回答が（多分、他の方から）得られると思います
>MySqlのイメージ >オープンソース　無料 ライブラリがGPLでMySQLの標準の接続ライブラリを使う場合接続したソースもGPLになるからそれを避けるためにはMySQLの商用ライセンスを買う必要がある。 だから本当の意味ではMySQLは無料というのは微妙。 >競合製品はpostgre 正式名称はPostgreSQL。 ついでに小規模レベルでの競合製品にSQLiteも仲間に入れてあげてください。 ちなみに >競合製品はOracle ですけど#2さんの情報だとDB2が無償バージョンがあるようですけど Oracleも無償バージョンがあります。
Free DVD MP3 Ripper http://www.gigafree.net/media/dvde/freedvdmp3rip … 　ライティングソフトを使えばmp3から音楽CD作れます(大抵のライティングソフトでは・・・)。
> ファイル名に処理日時（now()）をセットする記述方法 この場合は、ファイル名そのものではなく、式が必要ということになるので、 先頭に「=」が必要になります。 また、Windowsのファイル名には「/」や「:」(いずれも半角)は使えないので、 それを避ける必要があります。 この書式を指定するのには、Format関数を使用します。 (Format関数の詳細については、Accessのヘルプをご確認下さい) ファイル名が日時の数字のみでよいなら(→「20091031132405」)、 　="c:\" & Format(Now(), "yyyymmddhhnnss") & ".xls" すべてハイフンつなぎでよいなら(→「2009-10-31-13-24-05」) 　="c:\" & Format(Now(), "yyyy-mm-dd-hh-nn-ss") & ".xls" 年月日と日付の間はスペースで区切り、時刻には「：」(全角)を使うなら (→「2009-10-31 13：24：05」)、 　="c:\" & Format(Now(), "yyyy-mm-dd hh：nn：ss") & ".xls" 　※くれぐれも「：」は半角にはしないようご注意下さい。
嘘を書いているかもしれませんが、気になったところ２つ １）変数 Worksheet 変数名を変えてみるとか？（大丈夫なのかもしれませんが）、 > Worksheet = "納品書" 'ワークシート名 せっかくワークシート名を設定しているので、指定時に使用したらどうでしょう > Set Ws = Wb.Worksheets(1) 'ワークシートの指定 ２）Excel の Object名 > Dim app As Object > Set app = CreateObject("Excel.Application") なので、最後の方の以下 > Ex.Quit 'エクセルセッションをクローズする。 > Set Ex = Nothing '変数の初期化 部分は　app ？ このミス（？）を防止するには、コードの先頭に Option Compare Database Option Explicit のように　Option Explicit　を書いておくと、宣言していない変数を使っていると コンパイル時にエラーになるので、、、 後は主要なところにブレイクポイントを設定し、ステップ実行した方が早そうです。 （On Error Resume Next　はコメントにしてから）
＃２です > こういう場合はどうしたらよいのでしょうか。 もっといい方法があると思いますが、私はタスクマネージャからExcelを終了させてます。 VBAでやろうとすると、起動しているExcelは以下の方法で得ることができます。 　　Dim oApp As Object 　　On Error Resume Next 　　Set oApp = GetObject(, "Excel.Application") 　　If (Not oApp Is Nothing) Then 　　　　' ここで、ワークブックをループするなりして閉じるとか 　　　　' 　　End If ただ、Excel起動中に 　　Set oApp = CreateObject("Excel.Application") でExcel起動すると、Excelが複数立ち上がることになります。 （タスクマネージャで見るとわかると思います） なので、 　　Set oApp = GetObject(, "Excel.Application") で処理するのもループさせ、Excelが無くなるまで処理するのでしょうか。 ※確認作業中はファイルが壊れてもいいようにコピーは取っておきます。
失礼します。 > Do Until の後の変数名3 で > コンパイルエラー：修飾子が不正です > が発生してしまいました 変数名3 は String 宣言していますが、記述内容からみてレコードセットの 扱いになっています。 Dim 変数名3 As String を削除（コメントでも）後、変数名3 を 変数名2 に置き換えてみてください。 エラーは無くなると思います。 本来のしたいことになりますが、この後どのような処理で画面に表示されますか。 いろいろ方法はありますが、今の記述は使いません。 １）DoCmd.OpenForm で条件指定 ２）検索結果画面のレコードソースのクエリでテキストボックス参照 ３）検索結果画面は使わずに、一覧画面で絞込み表示 などなど、 １）DoCmd.OpenForm で条件指定 検索結果画面のレコードソースには条件を記述しないで、 全件表示できるようにしておきます。 DoCmd.OpenForm の WhereCondition に WHERE に書く条件を作成し指定します。 これにより、検索結果画面での処理記述は要らなくなります。 フィルタがかかった状態での表示となります。 ２）検索結果画面のレコードソースのクエリでテキストボックス参照 クエリの「検索したい列名1」「検索したい列名2」の抽出条件に、 [Forms]![一覧画面]![検索ボックス] を指定しておきます。 これにより、検索結果画面での処理記述は要らなくなります。 ３）検索結果画面は使わずに、一覧画面で絞込み表示 WHERE に書く条件で、フィルタを設定します。 Me.Filter = "検索したい列名1 = '" & ・・・・ Me.FilterOn = True 解除は、Me.FilterOn = False となります。 以下参考になると思います。（その３まであります） 複数条件の抽出フォームの設計 その1 http://hatenachips.blog34.fc2.com/blog-entry-129 … １）２）では、 検索結果画面を使っており、一覧画面と同じものも表示しているので 検索結果画面のものを削除したりすると、一覧画面側を再表示させるなど 同期をとった処理が必要になると思います。
こちらを参考に。 Access 2007 のフォームでフィルタを実行する場合、抽出結果にフィルタが反映されない http://support.microsoft.com/kb/941800/ja
Aテーブル、Bテーブルにある「顧客No」「名前」の一覧を作ります。 SELECT 顧客No, 名前 FROM Aテーブル UNION SELECT 顧客No, 名前 FROM Bテーブル ; 上記内容をベースに、各テーブルの情報を拾っていきます。 （Aテーブル、Bテーブルに関して、一覧作成も一気にやると以下記述に） SELECT Q1.顧客No, Q1.名前, TA.住所, TB.電話 FROM ( (SELECT 顧客No, 名前 FROM Aテーブル UNION SELECT 顧客No, 名前 FROM Bテーブル) AS Q1 LEFT JOIN Aテーブル AS TA ON TA.顧客No = Q1.顧客No) LEFT JOIN Bテーブル AS TB ON TB.顧客No = Q1.顧客No ; この情報で Cテーブルを作成するのなら、１行目を以下に変更します。 SELECT Q1.顧客No, Q1.名前, TA.住所, TB.電話 INTO Cテーブル ・・・・ ・・・・ ※ここで書いたのは、クエリのSQLビューで記述します。 見当違いでしたらスルーしてください。
順番に処理します。 (1)売上1と利益1を集合させます。 SELECT コード,1 AS 区分,"売上額" AS 表示名,名称,売上額,売上年, 　　Left(売上年,4) AS 年,Val(Right(売上年,2)) AS 月 FROM 売上1 UNION SELECT コード,2 AS 区分,"利益額" AS 表示名,名称,売上額,売上年, 　　Left(売上年,4) AS 年,Val(Right(売上年,2)) AS 月 FROM 利益1 上記SQLを持つクエリを作成します。→Q1 (2)上記クエリからクロス集計を作ります。 TRANSFORM SUM(売上額) SELECT コード,MAX(名称) AS 名称,MAX(表示名) AS 区分名 FROM Q1 WHERE 年="2008" GROUP BY コード,区分 PIVOT 月 ※１売上年はYYYYMM形式の文字列と解釈しています。日付型の場合は 　使う関数が異なります。 ※２列見出しは数値の4,5,…です。"4月","5月"のような文字列では 　"1月","10月","11月","12月","2月","3月",…のように並びます。
クエリに「月」のフィールドを追加。 　月: Month(出荷日) 「表示」欄のチェックをオフにする。 この「月」のフィールドに抽出条件を指定する。 直接、問題と関係ないが > 抽出条件は【1月分または7月分】です。 または の場合は 抽出するのは、１月と７月 の２カ月分のみ、 BETWEEN AND の場合だと １月から７月の７カ月分になります。
あぁ、新規レイアウトを作るときのテンプレートですか。 私はいつも空白レイアウトから始めるので使ったこと無いです。 レイアウトモードにしてパートを選んで塗りつぶし設定で変えられます。
>もできるようになるんですか？ 削除したファイルを復元させるだけで、ゲームができるようになるか どうかは分かりません。 それに、ファイルを復元できない場合もあり得ます。
SQLの意味 SELECT A.ID,A.教科,A.点数,A.平均点,A.フラグ, X.N-A.ID AS 演算 FROM テストM AS A LEFT JOIN (SELECT B.ID,MIN(C.ID) AS N FROM テストM AS B LEFT JOIN テストM AS C ON B.ID<C.ID AND B.平均点<C.点数 WHERE B.フラグ=1 GROUP BY B.ID) AS X ON A.ID=X.ID (1)最終的に表示されるデータは２個の要素の結合です。 　主となるものはテストMで、別名としてAを割り当てています。 　従となる方は（SELECT B.ID ～ BY B.ID）までのクエリです。 　同様に別名Xを割り当てています。　SELECTの後に続く、A.IDとは 　「Aに属する方のID」と言う意味です。 　最初（左）に書いた方が主、後（右）に書いた方が従なので、結合 　する場合の記述語は"LEFT JOIN"となります。 (2)従となるクエリも２個の要素から成り立ちます。 　主となる方はテストMで、別名Bを割り当てています。()内なので、 　Aを使っても良いのですが、外側の別名と紛らわしいので、異なる 　別名を使っています。"WHERE B.フラグ=1"でフラグが1のデータのみ 　抽出しています。 　従となる方もテストMで、結合する条件（ON 以降）は以下の通り。 　●主のIDよりも大きい（後方にある） 　●主の平均点より大きい点数 　但し、これですと、主１に対し、従が複数になる可能性があります。 　そこで、主のID１個に絞り（GROUP BY B.ID）その従の中で最小の 　ID（MIN(C.ID)）を求めています。この最小値は外側でも使うので、 　フィールド名としてNを割り当てます（AS N) 　もし、該当するデータが無い場合はNULLになります。 (3)主と従を結合します。結合条件は「IDが一致する」なので、 　ON A.ID=X.ID となります。X.Nは(2)で示した次に平均を超える 　点数の中で最小のIDです。X.N-A.IDで目的の値を得ます。 　もし、該当がないと、X.NはNULLになるので、NULLとの演算結果も 　また、NULLになります。 サブクエリ（SELECT B.ID ～ BY B.ID）単独でも実行可能です。 >「抽出条件でデータ型が一致しません」 もしかして、フラグは文字型だからでは？フラグが文字型の場合は B.フラグ='1' のように引用符（アポストロフィ）で囲まなくては なりません。（別解の方も同じ修正が必要） 別解の方は一般的でない（Access固有の演算子がある）こと、 全体の結合から抽出するので効率が悪いこと、以上の点から前者に 比べて劣っています（他のやり方もあるという例です）。よって、 忘れて頂いて結構です。
すみません、訂正です。書き忘れました。 >最終目的がわからないのでいいのかどうかわかりませんが、 >表示するだけでいいなら、 は 最終目的がわからないのでいいのかどうかわかりませんが、 表示するだけでいいなら、クエリを一個作って、 それを連結フォームのソースにするだけで終わりです。 でした。
>VBAを習得していないので、マクロでやってみようかと思います。 エクセルではVBAもマクロも同じもののことです。 アクセスでは、VBAとマクロは全く別物です（同じように機能を作成する方法ではありますが） 試しに、新しいブックに シート名　材料使用量マスター　として 商品ID　材料ID　数量 100011000002 100012000031 100013000012 100021000011 100022000032 といったように商品ごとに使用する材料と数量を入れた表を準備 シート名　使用材料一覧　として 商品ID　材料ID　数量 とタイトル行を準備 もひとつのシートに（名前は自由） 日付　納品No　商品ID　数量 10月1日1100012 と売れた商品を入力するシートを準備します。 そのシート名のタブを右クリック、コードの表示をクリックすると　VBエディターが起動します。 Private Sub Worksheet_Change(ByVal Target As Range) If Target.Column = 4 Then 商品ID = Range("C" & Target.Row) 数量 = Target.Value MsgBox 商品ID For i = 2 To Sheets("材料使用量マスター").Range("A65536").End(xlUp).Row If Sheets("材料使用量マスター").Range("A" & i).Value = 商品ID Then GYOU = Sheets("使用材料一覧").Range("A65536").End(xlUp).Row + 1 Sheets("使用材料一覧").Range("A" & GYOU).Value = Date Sheets("使用材料一覧").Range("B" & GYOU).Value = Sheets("材料使用量マスター").Range("B" & i).Value Sheets("使用材料一覧").Range("C" & GYOU).Value = Sheets("材料使用量マスター").Range("C" & i).Value * Target.Value End If Next End If End Sub 上記をコピィして貼り付けてください。 細かいことまでは説明いたしませんが、 If Target.Column = 4 Then　　つまり 売上を入力するシートの4列目D列に数量を入力したときに 記述したVBAが実行されて 使用材料一覧のシートに　使用した材料が書き加えられていきます。 コードは、わかりやすいように Sheets("使用材料一覧").とか何度も記述しています。少し勉強していただけると 応用やもっとシンプルなコードになると思います。 注意 数量を入れたときでなく、間違って入力して、後で変更の作業を行ったときも実行されます。
RDBMS名だけでなく、バージョンも明記するようにしてください。 表の構成列が、質問文では分かりづらいです。ファイル名は、どこで管理されているのですか？ また、どういう母体データから、どういう結果を得たいのでしょうか？
電話番号が記録されているということは、 そのセルは数値型ではなく、文字型ではないでしょうか？ Dim tmpInt As Integer　の宣言で、tmpIntは数値として扱われるので、 文字型のフィールドとは一致しないことになります。 Dim tmpInt As String に変更してみれば、どうでしょうか？
いろいろ方法があると思いますが。 例えば、 FETCH FIRST n ROWS を使うとか。 なお、RDBMS名に加え、バージョンも明記するようにしてください。
> mdbを立ち上げた時に「ナビゲーション」が非表示になるようにしたい Access2007のアプリケーション全体に対してではなく、mdbファイル個別の設定に なりますが、以下の操作でできます： 1)対象mdbファイルをAccess2007で開く 2)画面左上のOfficeボタンをクリックし、最下方にある『Accessのオプション(I)』を 　クリック 3)『Accessのオプション』ダイアログが開くので、左側の領域で『カレント データベース』 　を選択 4)グレー(?)背景の2段目の『ナビゲーション』領域に『ナビゲーション ウィンドウを表示 　する(N)』のチェックがあるので、オフに設定 5)『Ok』ボタンをクリック 6)「指定したオプションを有効にするには、現在のデータベースを閉じて再度開く必要が 　あります。」のメッセージが表示されるので、Okをクリック ・・・以上です。 これで、データベースを閉じて開き直すと、設定が反映されます。
１、１件分のデータ。 　レコード ２、複数のデータをまとめたもの。 　ファイル ３、ほとんどのプログラミング言語で利用できる基本的なデータ構造　　　で、同じ型のデータを連続的に並べ、添字により識別する。 　配列 ４、前後のデータの所在地をポインタにより連結するデータ構造で、デ　　ータの削除や挿入が容易である。 　リスト ５、先に入力されたデータが先に出力される(先入先出法)データ構造。 　キュー ６、後に入力されたデータが先に出力される(後入先出法)データ構造。 　スタック ７、スタックで、データを入力すること。 　PUSH ８、スタックで、データを出力すること。 　POP ９、キューに、３→５→８と順に入力した後、最初に出力される値はい　　くつか。 　3 １０、スタックに、３→５→８と順に入力した後、最初に出力される値　　　はいくつか。 　8 というところですかね。
今なら本屋さんに並んでいます ・導入効果バツグン！ PHP5.0＋MySQLで構築する最速Webシステム 　星野努著」CD-ROM付き　Apache 2.0.45、PHP5 MySQL5 技術評論社刊　ISBN4-7741-2707-8 C3055 2980E 内容は画像系のアルバム集と思えばよいでしょう サンプルではJPGのみの取り込みなので、必要な画像系が取り込めるようにすればよいです 自分はJPG、GIF、PDFを取り込んでいます サンプル版が巧く組み込めれば成功と思いましょう 改造は幾らでもできます データベースというのはデータを個人で入れるには荷が重いソフトですね
下記のサイトの受注管理データベースはいかがでしょうか？ http://www.newsbit.co.jp/software/rodb/index.html 無料というのも魅力ですし、楽天市場、Yahoo!ショッピング、ビッダーズ、自社サイトなど複数のネットショップの受注を1つのデータベースで一元管理できる受注管理・顧客管理データベースです。 Yahoo!ショッピングや楽天のCSVを取り込んで使う分には無料で高機能だと思います。 また、BitplusPRO（別売）は、定型のメールをデータベース化するソフトで、これを使うと楽天市場、ビッダーズ、フューチャーショップ2、 ジョイカート（A/Bタイプ）、ショップサーブ2、ショップメーカー、ショップマネージャー、カラーミーショップ(PC/モバイル)、 独自サイトの注文メールが簡単に取り込めます。 楽天市場、Yahoo!ショッピングなど複数のネットショップを運営している方には便利だと思います。 BitplusPROのページ http://www.newsbit.co.jp/software/bpp/index.html
> フォーム上で、生徒の学籍番号を入力すると、 > 自動的に学科と生徒の名前が表示されるようにしたいです。 幾つか方法が考えられますが、2つほど紹介します。 ※下記の「タブ」は、各コントロールのプロパティシートのタブのことです。 【1・DLookup関数を使用する方法】 フォームに『学科』『氏名』テキストボックスを新規作成し、コントロールソースに 上記関数を使用した式を指定します。 コントロールソースのみの設定なので簡単ですが、レコード毎に演算が実行される 分、動作が遅くなるのと、このコントロールでの並べ替えや検索は行えないという デメリットがあります。 (並べ替えや検索については、コントロールソースの代わりに、クエリ上で同関数を 　使用した演算フィールドを作成し、そのフィールドをコントロールソースにすれば 　対応可能になりますが) 『学科』テキストボックス： 　<データ>タブ 　・コントロールソース=(下記の式を、等号も含めて入力) 　　　『学籍番号』フィールドが数値型の場合： 　　　　=DLookup("[学科]", "T学生名簿", "[学籍番号]=" & [学籍番号]) 　　　『学籍番号』フィールドがテキスト型の場合： 　　　　=DLookup("[学科]", "T学生名簿", "[学籍番号]='" & [学籍番号] & "'") 『氏名』テキストボックス： 　<データ>タブ 　・コントロールソース=(同上) 　　　『学籍番号』フィールドが数値型の場合： 　　　　=DLookup("[氏名]", "T学生名簿", "[学籍番号]=" & [学籍番号]) 　　　『学籍番号』フィールドがテキスト型の場合： 　　　　=DLookup("[氏名]", "T学生名簿", "[学籍番号]='" & [学籍番号] & "'") 【2・コンボボックスを使用する方法】 T学生名簿のデータをリストに持ち、『学籍番号』を連結列とするコンボボックスを 使用することで、対応する『学科』や『氏名』を表示します。 設定項目は多くなりますが、上記の方法よりも動作は軽くなります。 『学科』コンボボックス： 　<書式>タブ 　・列数=「2」 　・列幅=「3cm;0cm」 　　※「3cm」は適宜調整してください。また、リストをドロップダウンさせたときに学籍番号 　<データ>タブ 　・コントロールソース=「学籍番号」 　・値集合タイプ=「テーブル/クエリ」 　・値集合ソース=「Select [学科], [学籍番号] From T学生名簿;」 　　※上記の式を入力後、右端の「...」ビルダ)ボタンをクリックすると、上記の式に 　　　 対応したクエリのデザインビューを確認できます。 　・連結列=「1」 　・入力チェック=「はい」 　　(今回の例では自動で設定され、「いいえ」にはできません) 　・使用可能=「はい」　┬→「編集不可」＆「カーソル移動・コピーは可」になります。 　・編集ロック=「はい」　┘　　 　　※「編集不可」＆「カーソル移動やコピーも不可」にする場合は、 　　　 「使用可能=いいえ」＆「編集ロック=はい」にします。 　　　 (グレー表示でよい場合は「使用可能=いいえ」＆「編集ロック=いいえ」) 　　※「使用可能=はい」＆「編集ロック=いいえ」にしてしまうと、コンボボックスのリストを 　　　 表示させると同じ学科内で学籍番号が最小の人にデータが勝手に変わってしまう 　　　 ので注意して下さい。 　　　 (コントロールソースを「学籍番号」ではなく「=[学籍番号]」にすれば、この問題は 　　　　回避可能ですが、演算コントロールなので並べ替えや検索はできなくなります) 『氏名』コンボボックス： ※デザインビュー上で『学科』コンボボックスをCopy＆Pasteした後、必要箇所のみ 　 修正してやるのが楽かと思います(→以下、その前提で修正箇所のみ提示)。 　<データ> 　・値集合ソース=「Select [氏名], [学籍番号] From T学生名簿;」 ・・・以上です。
SQLを提示してください。 それと、食材テーブルを更新していますが、間違って、２回実行 したら、実際より２倍の量が消費されたことにならないですか？ 再実行性の確保、入出庫履歴の管理、更新データ修正時の対応 これらの要件を満足しているでしょうか？
私自身はmdbファイルしか扱っていないのですが・・・ > ADEファイルをShiftキーを押しながらクリックしてもSQL Server上の > 生データが表示されない方法 こちらのサイト(Microsoft サポート)によれば、 http://support.microsoft.com/default.aspx?scid=k … adpファイルに対して、イミディエイト ウィンドウ(→Ctrl+Gキーの同時 押しで表示)で以下のコードを実行すれば、Shift押し起動を無効化 できるとのことです： 　CurrentProject.Properties.Add "AllowBypassKey", False 但し、ご自身でもShift起動ができなくなりますので、予めどこかの フォームに、自分だけが起動法を知っているイベント(例えばメイン画面 の左上隅をCtrl＋Shift＋Altを同時に押しながら右クリック、など)を 用意しておき、必要に応じてそこから 　CurrentProject.Properties.Remove "AllowBypassKey" を実行できるようにしておいた方がよいかと思います。 (初めは、原本のadpのコピーで動作確認した上で、問題がなければ 　原本に適用＆adeに変換、とした方が無難です) 以下も参考まで(適用が「Access2007」となっていますがそれ以前の ものでも同様です)： http://office.microsoft.com/ja-jp/access/HA01232 … なお、AllowBypassKeyは、実際には外部からも操作(True/Falseの 切替)が可能ですので、こちらも参考にされた方がいいかもしれません： http://office.microsoft.com/ja-jp/access/HP05279 … ※2番目のURLにある通り、AllowBypassKeyはmdbにもあるのでそちらで 　 経験がありますが、adpやSQL Serverのセキュリティについては当方は 　 詳細不明のため、追加説明はできませんので、ご了承願います(汗)
PRAGMA table_info 参考URL：http://www.sqlite.org/pragma.html#schema
> １回目の入力はＩＭＥが全角・人名モードになるのですが、 > ２度目以降は半角カタカナ・人名／地名モードになってしまいます。 恐らく、1回目の入力から2回目に当該テキストボックスへの移動までの 間に、半角カタカナを指定したテキストボックス(またはコンボボックス)を 経由しているのではないでしょうか。 (或いは『IME 入力モード』が「オフ」や「使用不可」、または英数系?) ともあれ、回避策としては、『IME 入力モード』を、現在の「オン」から 「ひらがな」に変更します。 (「オン」は、「ひらがな/全角カタカナ/半角英数」などのモードを特に指定 　しない場合に使用します。そのため、特定モードで固定したい場合は、 　それに合わせた設定値(ここでは「ひらがな」)を指定する必要がある、 　ということです) > 上のタブにＩＭＥ入力モード保持というのもありますが、どういう時に > 利用すればよいのでしょうか？ 私自身はこの設定は使用していないのですが・・・(汗) 例えば、取引情報を入力する場合、『企業略称』テキストボックスには 「アルファベットの略称」や「漢字の略称」、「カタカナの略称」がそれぞれ 連続することになります。 このとき、同テキストボックスの『IME 入力モード』を「ひらがな」などに固定 してしまうと、アルファベットやカタカナの略称のデータを入力する際には 毎回手動で「全角カタカナ」や「半角英数」に切り替える・・・という使い方を する方もいる可能性があります。 『IME 入力モード保持』は、恐らくそういう場合を想定した機能ではないかと 思います。 (もちろん、ひらがなからの変換で全角カタカナや半角英数に変換するように 　している人の場合は、切替は不要ですので、この設定は使用しなくても 　かまわないことになります)
認証API提供サイトの仕様によって違うと思います。 そこに問い合わせるのが一番でしょう。
ご質問ですが、 クエリには「∞」（外部キー）のマークがついた方を追加します。 ですので、「販売履歴」テーブルの方の「顧客ID」です。 「1」（主キー）の方を追加しても（「顧客リスト」の方の「顧客ID」）結果は変わりませんが、 後々そのクエリを元にフォームを作成すると、 新しいデータを入力＆追加できないといったトラブルが起こってしまいます。 分かりにくくて申し訳ございません。
HTMLとの連携ならMySQL+PHPの方が扱いやすいと思いますよ ※ MySQLはデータベース、PHPはプログラミング言語です どちらも無料で環境構築も出来ます（XAMPPで検索してみて下さい） アクセスで出来るかどうかについては、アクセスで作ろうと思った ことがないので出来るかどうかはナゾです スミマセン ひとまず↑二つでの構成がメジャーどころです CMSを利用するのも宜しい気がしますが、とりあえず軽く勉強は してみた方がよいかと思いますよ（応用きかないと困るかもなので） あ、でもまずはお使いのサーバでこれらが使用可能かどうかを 確認した方が良いです（無料だとダメってところが多いので）
このソフトはlzh形式で圧縮されていますので 解凍しなければなりません 日本では多く採用されている形式ですが この形式のファイルはWindowsの標準の機能では解凍できないので 解凍するためのソフトが必要です 窓の杜やvectorで捜索すと フリーの解凍ソフトがあるので そちらからダウンロードして利用してください 例 http://www.vector.co.jp/soft/win95/util/se169348 …
ExcelからCSV形式で保存し、それをテキストエディタで開いてみて ください。問題の列が""（引用符）で囲まれていれば文字型、 そうでなければ数値型の判断です。もし、数値型と判断されて しまう場合はセルの書式で、該当列を「文字列」に強制してみて ください。
処理性能をどこまで求めているのかわかりませんが、１文字づつ判別して分離する例です。 数字じゃない、数字、数字じゃない、数字、が繰り返し現れるとすると 　　Dim sRet(1 To 4) As String 　　Dim sTmp As String 　　Dim i As Integer, j As Integer 　　Dim ss As String 　　ss = "あいう123かきく4567" 　　For j = 1 To 4 　　　　sRet(j) = "" 　　Next 　　i = 0 　　For j = 1 To Len(ss) 　　　　sTmp = Mid(ss, j, 1) 　　　　If (sTmp Like "[0-9]") Then 　　　　　　If ((i Mod 2) <> 0) Then i = i + 1 　　　　Else 　　　　　　If ((i Mod 2) = 0) Then i = i + 1 　　　　End If 　　　　sRet(i) = sRet(i) & sTmp 　　Next '　　For j = 1 To 4 '　　　　Debug.Print sRet(j) '　　Next Debug.Print の結果は以下 あいう 123 かきく 4567 ※　テーブルへの設定の仕方は、方法含め自由です
こちらを参考に。 http://office.microsoft.com/ja-jp/access/HA10167 …
No.3です。 > 1行目で作成画面を閉じて、2行目でメインフォームの再クエリの > 準備をするわけですね 　　(中略) > そして3行目で、再クエリと。 おおすじで、それでOKなのですが、No.3の末尾に書いた「<解説>」部分の読み 込みが不足されているようです。 No.2の方のVBAと、No.3のマクロとでは、「閉じる/Close」と「再クエリ/Requery」 の順序が逆になっています。 そのため、レコードが保存されていない状態でOkボタンを押すと、No.1・2の補足 欄に書かれたように、「Requeryをしても反映されない」という結果になります。 (ちなみに、作成画面のOkボタンを押す直前の状態でテーブルを見てもらえば、 　そこではまだテーブルにも反映されていないことを確認できます) ※作成画面に保存ボタンを設置して押すか、可能なら別のレコードに移動した 　場合は、「Requery→Close」の順でも反映されます。 「1行目で閉じることによって、再クエリ実行時にはレコードが保存済みになる」、 このことが重要です。 ですので、VBAの場合でも、マクロと同様に、先にCloseを行ってからRequeryと してやれば、「作成画面」で登録しようとしたレコードがメインフォームに反映される ようになります。 Private Sub Ok_Click() 　　DoCmd.Close acForm, "作成画面" 　　Forms!メインフォーム.Requery End Sub また、別のやり方として、閉じる/Closeによる自動保存に頼る代わりに、明示的に レコードを保存する、というのもあります。 これであれば、RequeryをCloseの前においても、メインフォームに新規レコードを 反映させることができます。 こちらの場合は、Requeryの前に「DoCmd.RunCommand acCmdSaveRecord」 を追加します。 Private Sub Ok_Click() 　　DoCmd.RunCommand acCmdSaveRecord 　　Forms!メインフォーム.Requery 　　DoCmd.Close acForm, "作成画面" End Sub > 「acForm」というのがいくら調べてもわかりません マクロで「閉じる」アクションを選択してみると、画面左下に、「オブジェクトの種類」 という欄があり、そこのリストに「テーブル」「フォーム」などが並んでいると思います。 「acForm」というのは、そこの「フォーム」と同じ意味です。 実際には、「DoCmd.Close 0」ならテーブルを、「DoCmd.Close 2」ならフォームを それぞれ閉じる、という意味になるのですが、ただの数値では非常に覚えにくいし 後から見直してもわかりにくい、ということで、VBAの中で「0」や「2」の代わりに 使える定数として、「acTable」や「acForm」などが予め組み込まれています。 (MsgBoxで表示ボタンの種類を指定で使用する「vbOkOnly」(=0・Okボタンのみ)や、 　MsgBoxで選んだボタンを返す「vbCancel」(=2・キャンセルボタンを選択)等の 　組み込み定数などもあります： 　頭が「ac」のものはAccessで、「vb」のものは(Excel等も含めた)VBAで、 　それぞれ定義されているもの) 　 ・・・この辺りの定数は、全てを覚えるとなると大変ですが、VBA内にそれを補助する 機能(→添付画像：「Close」の後に半角スペースを入力すると表示)もありますし、 相当するマクロアクションをVBAに変換してやるという手もありますので、あまり気に しない方がいいと思います(汗)
こういう話は決まった計算式はありません。 よその例は参考になりません。 一番典型的なところを一部切り出して実際にやってみるしかないです。 それに基づいて難易度や全体整合等を考慮して見積もるべきです。 顧客相手ならそれくらいやらないと説得できませんよ。
文字列ですよね？ EXCELの関数を利用すれば良いのでは？ LENB（セル番号）で該当するセルのバイト数が表示されます。 全セルに関してバイト数を求め、更にバイト数の最大値（MAX)をチェックすればエラーか否かが確認できますね。
写真をバックアップする時にエラーが出るのですよね。 私は電源トラブルによるHDDのトラブルと考えます。 HDDはこれから悪化の一途を辿ると考えられますので、 これ以上被害を拡大しないために、出来るだけ多くの データのバックアップを行い、早くHDDの換装をお奨め いたします。 どうしてもバックアップが取れなかったデータは、巡回冗長 エラーが出るHDDをデータ用HDDとして取り付けて、更なる バックアップを試みることになると思います。 私なら時間の無駄と考えて諦めますけど。
まずあなたのコードを見ます。 Sub ボタン1_Click() 　　Dim tmpInt As Integer, motoHani(), myRng As Range, i As Integer 　　tmpInt = Worksheets("入力フォーム").Range("C4").Value 　　’入力フォームシートのC4の値をtmpintに代入（たぶん社員ID) 　　motoHani = Array("C6", "C7", "C8", "F8", "C10", "C11") 　　'入力フォーム上の対象セルをmotohaniｍにセット 　　Set myRng = Range("社員テーブル").Columns(1).Find(tmpInt, LookAt:=xlWhole) 　　'社員テーブル上のtmpint(社員ID）の一致するセルを取得 　　If myRng Is Nothing Then 　　　　　　MsgBox "該当する事案はありません" 　　　　　　Exit Sub 　　End If 　　'以上見つからなかったときの処理 　　For i = 0 To UBound(motoHani) 　　　　Range(motoHani(i)).Value = myRng.Offset(0, i + 1) 　　Next 　　'見つかったら入力フォーム上の対象セルにその行の値を代入 End Sub で目的の処理は 入力フォーム上のC4セルで社員テーブルを検索 見つかったら入力フォーム上の対象セルをその行に代入 つまりセルを見つけるまでは一緒で代入が反対になるだけでいいと思います。 　　　　Range(motoHani(i)).Value = myRng.Offset(0, i + 1) を 　　　　 myRng.Offset(0, i + 1)=Range(motoHani(i)) に変えたSubを作ればOKだと思います。 おまけ 新規追加のときは最後の列を見つけて同じ代入処理でできますがこのときは社員IDも代入することを忘れずに テストしてませんがたぶんこれでいいと思います。 うまくいかなかったらまた書いてください。
No.3、DexMachinaです。 名前はあいまい検索にしていない、4行目はCopy＆Pasteした後で「=0」を「>0」に修正する のを忘れてる、追加するつもりだったLen関数と「& ""」の説明はすっぽかす・・・ すみません、寝惚けてたか酔っ払ってたのか、というぐらい、ひどい回答でした(汗) (2番目(「=0 → >0」)を正しく記述していれば、「001 又は 稲本 吾郎」はきちんとできていたわけで・・・) 既に30246kikuさんが説明されていますが、若干の補足も交えてということで・・・ > ・マクロ1行目はどういう効果があるのですか？ No.4で30246kikuさんからも「アクション：全レコードの表示　でも同じですか？」と 訊かれていますが、その通りで、[番号検索]や[名前検索]で一旦絞り込んだ後の 解除(全件表示)を意図したものです。 (「全レコードの表示」にしなかったのは、その存在を失念していたためです(汗) 　動作に違いはなかったと記憶しています) > ・また条件の中に「& ""」という文章が入っていますが、これは何を表わしているのですか？ [名前検索]の値がNullだった場合に、空文字(長さ0の文字列)に変換しています。 これは、Len関数の引数がNullだった場合、戻り値が0ではなくNullになってしまう (=「Len(～)=0」も「Len(～)>0」も不成立扱いになる)ことへの対策です。 http://oshiete1.goo.ne.jp/qa4850675.html​ 【追加情報1】 　　[名前] Like "*" & [Forms]![メインフォーム]![名前検索] & "*" の代わりに 　　[名前] Like [Forms]![メインフォーム]![名前検索] というように「"*"」を削除した上で「Like」を使用すると、「名前検索」欄にそれぞれ 　　「森」と入力　　→　「森」での完全一致検索に、 　　「森*」と入力　→　「森田」「森山」等、「森」での先頭一致検索に、 　　「*森」と入力　→　「杉森」「三森」等、「森」での後方一致検索に、 　　「*森*」と入力→　「森」「森田」「杉森」等、「森」でのあいまい検索に、 というような使い方もできますので、併せて参考まで。 (もっとも、これはユーザーが「*」の使い方を覚えるか、フォーム上に説明文を出して 　おいてそれを見てもらう、といったことが必要になってしまいますが) 【追加情報2】 > VBAにも挑戦してみたいと思っています。 自分で組むなどして動作を理解したマクロがある場合、Accessの「マクロをVisual Basicに変換」を使用してみるのも、取っ掛かりとしてはいいかもしれません。 (VBAとして効率のいいコードにするには、そこから手を加える必要はありますが) Accessの画像左端で対象マクロを選択すると、『データベース ツール』リボンの 『マクロ』内の『マクロをVisual Basic に変換』ボタン(→添付画像の赤丸のボタン)が 有効になりますので、その状態でクリックすればVBAに変換されますので、試してみる のもいいかもしれません。 > どっちに”良回答”をつければいいかわからないです（笑） 個人的には気にしていますが、そこはどうぞご自由に(笑) 「気にしている」というのは、「わかりやすく簡潔な回答ができたか」ということへの ひとつの目安にしているから、ですので。 ・・・まあ、No.3のようなポカをやっているようではダメなんですけれどね・・・(汗)
PDF を作成するには 1. 文書の作成プログラムで[ファイル] - [印刷] を選択します。 2. 利用できるプリンタの一覧から PrimoPDF プリンタを選択し、[OK] ボタンをクリックします。 3. PrimoPDF のメイン ダイアログが表示されます。 PDF ファイルを保存する場所を指定し、 出力するファイル名を入力します。 この時、PrimoPDF のその他のオプションを設定することも出来ます。詳細は、「PrimoPDF オプションの設定」を参照してください。 4. [PDF の作成] ボタンをクリックします。 Copyright 2008, activePDF, Inc. All Rights Reserved. 参考URL：http://www.xlsoft.com/jp/products/primopdf/pdf/p …
> 「余分な文字」をまとめたテーブルでも作成しそれを使ってうまい事出来ないか そのテーブルを作れば、クエリで一発で対応できます。 (こちらの環境で動作確認済み：WinXP Home＆Excel2003) 【テーブル】 「TableA」テーブル： 　フィールド = No(テキスト型・主キー), 型番(テキスト型) 「削除リスト」テーブル： 　フィールド = 削除文字(テキスト型・主キー) 【クエリ】 SQL文： 　UPDATE TableA, 削除リスト SET TableA.型番 = Replace([型番],[削除文字],""); 添付画像は、左から 　　更新クエリ適用前のテーブルのデータ(予め複製) 　　更新クエリ適用後のテーブルのデータ 　　上記SQL文をクエリのデザインビューで表示したもの です。 『削除リスト』に登録された文字パターンを複数持っている場合も含めて、問題なく 削除されることを確認しました(→No=06)。 ※2つのテーブル間にフィールドの結合がない選択クエリを作成すると、そのレコードは 　 双方のテーブル件数の乗算となります(一方のテーブルが5件、他方が6件なら、 　 選択クエリは5*6=30件を表示)。 　 これと同じで、上記クエリを実行すると、「○○件のレコードが更新されます」の 　 確認メッセージでは、テーブルの実レコード数より大きくなりますのでご注意下さい。
誤解があるかも知れないので、念のため。 IMSでは、階層型DBであるDEDB等以外に、25年以上前からRDBMSとしてDB2を接続できます。
質問に対する答えはNO1さんがおつしゃるとおりだと思います。 私は話を先に進めて次のようなテーブルがあれば、質問者のほしい商品別のの粗利、得意先別粗利などは、簡単なクエリーで求められるのではないかという観点から、素人ですが、テーブルの構想を提案いたします。 テーブルは4つ 売上テーブル、フィールドは期日、得意先、商品名、売上単価、数量、請求額、入金予定日、担当者 仕入れテーブル、フィールドは期日、仕入先、商品名、仕入単価、数量、契約額、支払予定日、担当者 入金テーブル、フィールドは期日、得意先、商品名、受取金額、受取方法、担当者 支払テーブル、フィールドは期日、仕入先、商品名、支払金額、支払方法、担当者
コマンドプロンプトから DIR C:\～ /AH を実行する。
クエリだけではチョット厳しそうなので、ユーザ定義関数で月末を求めます。 標準モジュールに記述するのは以下 Public Function GetLastDay(vD As Variant) As Variant 　　Dim vRet As Variant 　　Dim i As Integer 　　vRet = Null 　　If (IsDate(vD)) Then 　　　　vRet = DateAdd("m", 1, Format(vD, "yyyy/mm")) - 1 　　　　i = Weekday(vRet, 7) 　　　　If (i <= 2) Then vRet = vRet - i 　　End If 　　GetLastDay = vRet End Function クエリからの呼び出し方） クエリのSQLビュー表示での記述例 テーブル１にフィールド [日付] があり、その日付で月末を求めるには、 SELECT 日付, GetLastDay(日付) AS 月末 FROM テーブル1; ※ ユーザ定義関数では、NULL の日付も処理できるように、受け/戻しに Variant 利用 日付なら翌月１日の前日を求め、Weekday 土曜日基準で 2 以下の時には、さらに土曜日基準値を減算 Weekday 2つ目のパラメータに 7 で、土曜日から 1,2,3・・・　の値が返ってくるので 2 （日曜）以下なら翌月１日の前日から、1 or 2 を減算 ※　関数名は、適宜変更してください。
更新クエリで一発、瞬時です。 ＳＱＬ文は UPDATE Aテーブル SET Aテーブル.B = 0;
30バイトから128バイトに変わっているような・・ ＃UTFで漢字などを使われている場合には１文字が可変長なので要注意 【v9】 http://publib.boulder.ibm.com/infocenter/db2luw/ … 【v9.5】 https://publib.boulder.ibm.com/infocenter/db2luw …
Web で Access 2007 入門 とかで検索すればよろしいかと。 サイトは個人の好みがあるでしょうから検索結果からご自分で選んでください。 "教えてもらう" ではなく "自分のために自分で学ぶ" という姿勢をお忘れなく。
１つの実現案になります。 使用するテーブルは以下の２つ（構成等は案です） ・俳句の入っているテーブル テーブル名：T俳句 フィールド名：an, rd, 俳句 フィールドの型：an(オートナンバ),rd(単精度浮動小数点型),俳句(テキスト型) ・１日５件選んだテーブル（１０日分格納） テーブル名：T除外 フィールド名：an, 日付 フィールドの型：an(長整数),日付(日付型) 処理の流れ：概要） １）その日に処理したかは T除外の日付で判別 ２）T除外の日付で１０日前のものがあったら、日付をもとに削除 ３）乱数を発生させ、T俳句のrdを書き換える ４）T除外にある an 以外のT俳句のrd昇順のTOP 5の an を実施した日付とともにT除外へ登録 ５）印刷等はT除外の日付をもとに an とT俳句の an を結び付けて・・・ 記述例） SQLを記述しますが、クエリからでも VBA のExecute からでも処理しやすい方で、、 １）DLookup("日付","T除外","日付 = Date()") Is Null で、今日は処理していない ２）今日より１０日以前のものがあるか判別するなら DLookup("日付","T除外","日付 < Date()-10") Is Null そのまま削除するのなら、 DELETE * FROM T除外 WHERE ((T除外.日付) < Date()-10); ３）乱数の書き込み UPDATE T俳句 SET T俳句.rd = Rnd([an]); ４）T除外にある an 以外で、T俳句 rd 昇順の TOP 5 をT除外に追加 INSERT INTO T除外 ( an, 日付 ) SELECT TOP 5 T俳句.an, Date() AS 日付 FROM T俳句 LEFT JOIN T除外 ON T俳句.an = T除外.an WHERE ((T除外.an) Is Null) ORDER BY T俳句.rd; ５）今日選んだ５件の俳句部分を抽出 SELECT T俳句.俳句 FROM T俳句 INNER JOIN T除外 ON T俳句.an = T除外.an WHERE ((T除外.日付) = Date()); これらを組み合わせていけば、そこそこのものができると思います。 ※　シートに入れる、っていうのがわかりませんでした。
ExcelでもAccessでもやれるでしょう。 Excelの方がとっつきやすいと思います。 内容が今ひとつつかみきれないのですが、「契約月、領収月の関係、A表の横列は無限に増えていくのかなど」 聞いた限りでは、少しVBA（マクロ）も必要のように見受けられます。 それなりの覚悟をもって取り組んでください。 まず要求を整理して集計表用紙か何かの上で記入して見るのもいいかもしれません。
以前たまたま読んだことがあった記事のURLを、参考URLにはりました。 参考URL：http://www.atmarkit.co.jp/fjava/rensai4/bigtable …
＃４です 近いと思われるものを２パターンで、 新規mdbでサンプル取り込み後、確認してみてください。 （サンプル部分をメモ帳とかに貼り付け保存後、インポート） > 番号をずらすことが出来ればと これは理解できてません。 １）グループ１とグループ２でグループ化 ２）指定 code を基準とした生成 共通） 元となるテーブルのサンプルを以下とします。 テーブル名：T6 フィールド名：code, sold, syuG1, syuG2 sold のみテキスト型、その他は長整数 テーブルサンプル（インポートしやすいように：見にくいです） "code","sold","syuG1","syuG2" 1,,1,1 2,,1,1 3,"完売",1,1 4,,1,2 5,,2,2 6,,2,2 7,"完売",2,2 8,,2,3 9,,3,3 10,"完売",3,3 11,,3,3 12,"完売",3,4 13,"完売",4,4 14,,4,4 15,,4,4 16,"完売",4,5 17,,5,5 18,,5,5 19,,5,5 20,,5,6 グループ１テーブル テーブル名：T6_G1 "syuG1","内容" 1,"AAAA" 2,"BBBB" 3,"CCCC" 4,"DDDD" 5,"EEEE" グループ２テーブル テーブル名：T6_G2 "syuG2","内容" 1,"aaaa" 2,"bbbb" 3,"cccc" 4,"dddd" 5,"eeee" 6,"ffff" １）グループ１とグループ２でグループ化 標準モジュールにユーザ定義関数を記述（以下例） Public Function GetCode20Pat1(vG1 As Variant, vG2 As Variant) As String 　　Dim rs As New ADODB.Recordset 　　Dim sSql As String 　　Dim sRet As String 　　Dim i As Integer 　　On Error Resume Next 　　sRet = "" 　　sSql = "SELECT code FROM T6 WHERE (Nz(sold,'') <> '完売')" 　　If (IsNull(vG1)) Then 　　　　sSql = sSql & " AND (syuG1 Is Null) " 　　Else 　　　　sSql = sSql & " AND (syuG1 = " & vG1 & ")" 　　End If 　　If (IsNull(vG2)) Then 　　　　sSql = sSql & " AND (syuG2 Is Null) " 　　Else 　　　　sSql = sSql & " AND (syuG2 = " & vG2 & ")" 　　End If 　　sSql = sSql & " ORDER BY code;" 　　i = 0 　　rs.Source = sSql 　　rs.Open , CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly 　　While ((Not rs.EOF) And (i < 20)) 　　　　sRet = sRet & " " & rs("code") 　　　　rs.MoveNext 　　　　i = i + 1 　　Wend 　　rs.Close 　　If (Len(sRet) > 0) Then sRet = Mid(sRet, 2) 　　GetCode20Pat1 = sRet End Function クエリのSQLビューに以下記述（貼り付け＆保存：どちらでも） SELECT Min(T6.code) AS code , T6.syuG1, First(T6_G1.内容) AS 内容1 , T6.syuG2, First(T6_G2.内容) AS 内容2 , GetCode20Pat1(T6.[syuG1],T6.[syuG2]) AS rink FROM (T6 LEFT JOIN T6_G1 ON T6.syuG1 = T6_G1.[syuG1]) LEFT JOIN T6_G2 ON T6.syuG2 = T6_G2.[syuG2] WHERE (Nz([T6].[sold],"")<>"完売") GROUP BY T6.syuG1, T6.syuG2 ORDER BY Min(T6.code); とか SELECT Q1.code , Q1.syuG1, T6_G1.内容 AS 内容1 , Q1.syuG2, T6_G2.内容 AS 内容2 , Q1.rink FROM ((SELECT Min(T6.code) AS code , T6.syuG1, T6.syuG2, GetCode20Pat1(T6.[syuG1],T6.[syuG2]) AS rink FROM T6 WHERE (Nz([T6].[sold],"")<>"完売") GROUP BY T6.syuG1, T6.syuG2) AS Q1 LEFT JOIN T6_G1 ON Q1.syuG1 = T6_G1.syuG1) LEFT JOIN T6_G2 ON Q1.syuG2 = T6_G2.syuG2 ORDER BY Q1.code; このクエリを実行すると以下の表示に code...syuG1.....内容1....syuG2.....内容2.....rink 1..........1..........AAAA..........1..........aaaa..........1 2 4..........1..........AAAA..........2..........bbbb..........4 5..........2..........BBBB..........2..........bbbb..........5 6 8..........2..........BBBB..........3..........cccc..........8 9..........3..........CCCC..........3..........cccc..........9 11 14.........4..........DDDD..........4..........dddd..........14 15 17.........5..........EEEE..........5..........eeee..........17 18 19 20.........5..........EEEE..........6..........ffff..........20 左の code は、グループ１とグループ２でグループ化した際の最小 code になります。 （完売は除く） このグループ１とグループ２でグループ化すると、以下の様な表示にはなりません > 1 　01 クリスマス　　01 リース 　1 2 3 4 5 6 7 8 ～ > 15 　01 クリスマス　 01 リース 　　　　　　　15(最初の番号) ～ > 10 　01 クリスマス 　 02 ファイバーツリー　 10 11 15 18 ～ > 30 　01 クリスマス 　 02 ファイバーツリー 30(最初の番号)～ ↓上記での1,2行目が1つに、3,4行目が１つになります > 1 　01 クリスマス　　01 リース 　1 2 3 4 5 6 7 8 ～ > 10 　01 クリスマス 　 02 ファイバーツリー　 10 11 15 18 ～ ２）指定 code を基準とした生成 左の code に表示するものを別テーブルで指定する例 rink は、指定された code のグループ１とグループ２が同じものを完売除きで、指定された code 以上で生成 code を指定するテーブルサンプル テーブル名：T6_1 "code" 1 5 10 15 20 標準モジュールに以下ユーザ定義関数を記述 Public Function GetCode20Pat2(iCode As Long) As String 　　Dim rs As New ADODB.Recordset 　　Dim sSql As String 　　Dim sRet As String 　　Dim i As Integer 　　On Error Resume Next 　　sRet = "" 　　sSql = "SELECT Q1.code FROM T6 AS Q1 INNER JOIN " 　　sSql = sSql & "(SELECT * FROM T6 WHERE code = " & iCode & ") AS Q2 " 　　sSql = sSql & "ON (Q1.syuG1 = Q2.syuG1 AND Q1.syuG2 = Q2.syuG2 AND Q1.code >= Q2.code)" 　　sSql = sSql & " WHERE (Nz(Q1.sold,'') <> '完売')" 　　sSql = sSql & " ORDER BY Q1.code;" 　　i = 0 　　rs.Source = sSql 　　rs.Open , CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly 　　While ((Not rs.EOF) And (i < 20)) 　　　　sRet = sRet & " " & rs("code") 　　　　rs.MoveNext 　　　　i = i + 1 　　Wend 　　rs.Close 　　If (Len(sRet) > 0) Then sRet = Mid(sRet, 2) 　　GetCode20Pat2 = sRet End Function クエリのSQLビューに以下記述（貼り付け＆保存） SELECT T6_1.code , T6.syuG1, T6_G1.内容 AS 内容1 , T6.syuG2, T6_G2.内容 AS 内容2, GetCode20Pat2(T6_1.code) AS rink FROM ((T6_1 INNER JOIN T6 ON T6_1.code = T6.code) LEFT JOIN T6_G1 ON T6.syuG1 = T6_G1.[syuG1]) LEFT JOIN T6_G2 ON T6.syuG2 = T6_G2.[syuG2] ORDER BY T6_1.code; このクエリを実行すると以下の表示に code...syuG1....内容1....syuG2.....内容2....rink 1..........1..........AAAA..........1..........aaaa..........1 2 5..........2..........BBBB..........2..........bbbb..........5 6 10.........3..........CCCC..........3..........cccc..........11 15.........4..........DDDD..........4..........dddd..........15 20.........5..........EEEE..........6..........ffff..........20 code = 10 のところは、code = 10 自体が完売なので、rink は 11 から また、rink 生成は指定された code 以上と条件付けているので code = 9 は除外 ※　各クエリでSQLビュー記述後は、デザインビューで設定を確認してください。 　（デザインを見ればどのような指定になっているかわかりやすいと思います） ※　rink 作成時の20件抽出は、ループのところでカウントしています。 　（サンプルは20件以下なので、TOP 20 では得られませんでした） ※※　＃１の回答をベースにするなら、１）でしょうか ※※　サンプルテーブル内のデータを書き換えて、いろいろ確認してみてください ※※　これで完とは思っていないので
revisionテーブルの次の３つの属性 　　rev_page　　整数型８桁 　　rev_text_id 整数型８桁 　　rev_user　　整数型５桁 には，いずれも (FK) すなわち 外部キー(Foreign Key) と書かれていますので，原則として他のテーブルの主キー（灰色の鍵の形の小さなアイコン）を参照しているはずの属性です。あとは属性名の特徴とデータ型の一致より， 　　rev_page　　は pageテーブルの主キー page_idを参照 　　rev_text_id は textテーブルの主キー old_id を参照 　　rev_user　　は userテーブルの主キー user_idを参照 と判断できます。
＃２です > ＞現在部署番号は "1" 固定ですが、パラメータ渡し、グローバル変数化は自由です。 > 固定ではなく、任意の番号を入力する方法 １）パラメータ渡し 既に部署番号を参照できる構成になっていた場合 （フォームに部署番号の入力/選択欄がある場合など） 変更するのは以下２行 Public Function GetNewNum() As String 　　sD = Format(Date, "yymm") & "1" ↓　整数で受け渡す場合 Public Function GetNewNum(iBuNum As Integer) As String 　　sD = Format(Date, "yymm") & iBuNum ↓　長整数で受け渡す場合 Public Function GetNewNum(iBuNum As Long) As String 　　sD = Format(Date, "yymm") & iBuNum ↓　文字で受け渡す場合 Public Function GetNewNum(sBuNum As String) As String 　　sD = Format(Date, "yymm") & sBuNum ↓　NULL を渡す可能性がある場合 Public Function GetNewNum(vBuNum As Variant) As String 　　sD = Format(Date, "yymm") & vBuNum ※ NULL なら部署番号を 1 にするなど処理の追加が必要 １－１）呼び出し方 Me.指示書番号 = GetNewNum(Me.txt_部署番号) とか（部署番号が入っているテキストボックス名を txt_部署番号 とした場合） ２）グローバル変数利用　その１ 操作を始めた時、その人が扱える部署番号を固定した作りになっている場合や、複数のフォームにまたがって同じ部署番号を使いたい場合など 標準モジュールに以下を宣言（整数として扱う場合：型については上記同様に） Public iPubBuNum As Integer この変数を　　sD = Format(Date, "yymm") & iPubBuNum　　部分で参照します。 iPubBuNum には、部署番号を得た時点で代入しておきます。 ２－１）呼び出し方 変更ありません ２－２）コメントは書いておきましょう（同じ標準モジュールに書いた時の例） ' 処理中部署番号 '　設定：XXXXのタイミング '　参照：指示書番号生成（GetNewNum）/ YYYY ' Public iPubBuNum As Integer ・・・ ' 指示書番号生成 '　iPubBuNum は部署番号（グローバル変数） ' Public Function GetNewNum() As String 　　・・・・ 　　sD = Format(Date, "yymm") & iPubBuNum 　　・・・・ 　　GetNewNum = sRet End Function とか、 ３）グローバル変数利用　その２（複合） 処理中部署番号をグローバル変数で持って置き、GetNewNum を呼ぶ時にパラメータにする ' 処理中部署番号 '　設定：XXXXのタイミング ' Public iPubBuNum As Integer ・・・ ' 指示書番号生成 ' Public Function GetNewNum(iBuNum As Integer) As String 　　・・・・ 　　sD = Format(Date, "yymm") & iBuNum 　　・・・・ 　　GetNewNum = sRet End Function ３－１）呼び出し方 Me.指示書番号 = GetNewNum(iPubBuNum) ※　この辺の書き方/内容については、会社なり、部、課、チームなどにルールがあると思いますので、それに従ってください ※　関数（モジュール）の結合度等ルールがあれば、それに従ってください。 ※　変数/関数名は適宜変更してください ※　説明になってたでしょうか
同じようなものですが、クエリでの書き方例です。 SELECT format(iif(weekday([年？] & "/10",6)=1,[年？] & "/10",dateadd("d",8-weekday([年？] & "/10",6),[年？] & "/10")),"m月d日(aaa)") AS 日付; これを保存実行すると、年？　を聞いてきますので、2009　とか入力します。 （ H21　の入力でも、平成21　の入力でも、そこそこ動きます） ※入力された年の 10/1 が、金曜日基準で1なら、10/1を、 でなければ、８ － 金曜日基準値　を10/1に加算。 それを指定形式に変換 ※日付部分で日を省略すると１日となります。 明示的に　"/10" を "/10/01" にしても・・・
こんにちは 私も、よくこれにやられています。 Access 2007 で直線を含むレポートやフォームのセクションの高さが、直線の配置により増加することがある http://support.microsoft.com/kb/932492/ja これが原因です。 > 用紙の最後まで罫線を表示する は、詳細セクションの高さと、改ページコントロールの上位置が 一致しないとうまく動かないです。 私の場合は、 横線を少しだけ上方向に移動して使っています。 Ctrl+↑　で少しずつずらして、詳細の高さと改ページの上位置がそろえられればOKです。 縦線使ってると、少しだけ最終行ではみ出しますが、 プリンタによっては気にならないので一度お試しください。
＃１です。補足いただいてもまだ判らないところがあります。例えば「累金額　　…　金額　　（不可視：集計実行で全体を選択）」で「集計実行で全体を選択」とは？ しかし補足いただいても、あまり有効な回答はできそうもありません。ACCESS 2007もありません。 しかし質問と補足から「何らかの演算がレポートビューではなされ、印刷プレビューではなされない」可能性を考えます。 この問題を切り分けるため、レポートでできるだけ演算を使用せずＳＱＬ文で表現できないでしょうか？ あるいは質問を切り替えて、「これこれのテーブルから必要なデータを取り出すためのＳＱＬ文はどのように書けばよいか？」としては如何でしょうか？
この質問に回答しようと考える一般の人はいないでしょう。私も回答する気になれません。まず質問番号：5272888の最終部分でレポートに任意の納品書番号が印刷されることを確認し、その後に、問題を一般化して（充分整理して）質問してください。私に一方的に依存するのはやめてください。
> 改行コードが入っていないように思えます。 No.1の方の回答にもある通り、Excelのセル内とAccessのフィールド内とでは、 改行コードが違います。 ただ、Excelの改行コード自体は、インポートの際に取り込まれていますので、 Accessにてクエリ等を使用して変換してやれば、改行表示されるようになります。 例えば、Excelからのインポートデータが保存されているテーブルを「テーブル1」、 改行コードが入ったフィールドを「フィールド1」とすると、以下のSQL文で改行 コードを変換できます(添付画像は同じもののデザインビュー)： Update テーブル1 Set フィールド1 = Replace([フィールド1],Chr(10),Chr(13) & Chr(10)); ※Chr関数は、引数で指定したコードに対応する文字を返す関数です。 　 「Chr(10)」はラインフィード(=Excelのセルでの改行コード)を、 　 「Chr(13) & Chr(10)」はキャリッジリターン＆ラインフィード(=同・Access)を 　それぞれ表します。 ※Replace関数は、第1引数で指定した文字列の中から第2引数で指定した 　文字列を探し、あった場合は第3引数で指定した文字列に置換する関数です。 　但し、Access2000では、クエリ上では使えなかったと記憶しています。 　この場合は、標準モジュールでユーザー定義関数を作成してやれば、 　その関数を使用することで同様の処理が行えます。 一例(Replace関数の省略可能な引数を全て省略したもの)： Public Function Replace2(sExp As String, sFnd As String, sRpl As String) As String 　　'Replace2関数で指定した引数をそのままReplace関数に渡し、 　　'戻り値をそのままReplace2関数の戻り値にします。 　　Replace2 = Replace(sExp, sFnd, sRpl) End Function
No.1です。 > なぜこんなにリレーションシップ画面上でテーブル名＋１、２、３、４と > できてしまったのでしょうか。 2つのテーブルの間に、異なる関連性(リレーションシップ)を持たせた場合、 そのような形で表示されます。 ですので、そのような表示がされたからといって、即座にデータベースの 構造に問題があるとは断定できません。 (ただ、私自身は、『リレーションシップ』画面で、同一テーブルが4つも 　表示されるようなデータベースは組んだことはありませんが・・・) 以下、同一テーブルが表示される場合とされない場合、それぞれの 簡単(・・というか大雑把)な例を挙げてみます。 【1・複数のフィールドを使用した、1種類の関連性を持つ例】 下記のようなテーブルに、「学年」と「組」フィールドでリレーションシップが 設定されていた場合は、「学年」と「組」がセットとして、1種類の関連性 を持った形になります。 この場合は、同一テーブルが複数表示されることはありません。 (『リレーションシップ』画面では、それぞれのテーブルが、2つのフィールドで 　結合された状態で表示されます) <担任一覧> 　フィールド：　学年、組、担任ID <生徒一覧> 　フィールド：　生徒ID、学年、組、姓、名 【２・複数のフィールドに、それぞれ異なる関連性がある例】 下記のようなテーブルがあり、 　・<委員長一覧>テーブルの委員長IDと、<生徒一覧>テーブルの生徒ID 　・<委員長一覧>テーブルの委員会IDと、<生徒一覧>テーブルの委員会ID のそれぞれにリレーションシップが設定されていた場合、『リレーションシップ』 画面にそれぞれのテーブルを１つずつ表示してしまうと、上の「１」の場合とは 意味が違うのに、同じ表示になってしまいます。 (「1」では「学年」「組」がともに一致するものを関連付けているのに対して、 　こちら(「２」)の場合は、委員長になっていない委員(生徒)もいるので、 　「委員会ID」と「委員長ID-生徒ID」は、必ずしも同時に一致しなくてもよい) これを避けるため、一方のテーブルが(番号を追記されて)重複して表示され、 一方とは「委員会ID」同士で結合線を、もう一方とは「委員長ID」と「生徒ID」 で結合線をそれぞれ表示することで、「1」の場合と違うことを図示しようとして います。 <委員長一覧> 　フィールド：　委員会ID、委員長ID <生徒一覧> 　フィールド：　生徒ID、学年、組、姓、名、委員会ID ・・・以上、言葉ばかりなので、ちょっと(かなり?(汗))わかりにくいかと思いますが、 参考まで。
>[在庫リスト]と[材料]はどのようにつなげばいいのでしょうか？ ただつなぐだけなら構成テーブル経由でつなげばいいと思いますが ＞製品の在庫管理のデータベースを考えております。 テーブル設計に対するお尋ねだったので「正規化」ということを意識して「一般的な」回答を示したのですが
No.2、DexMachinaです。 > どうして削除されないのかわかりません。 私の場合、ヘルプを頼りにトライ＆エラーでの経験則で覚えてきたので、 この件についての原理・理論的な説明はできないのですが(汗)、 とりあえず対処法について、説明します。 (一対多のリレーションシップが設定された複数テーブルからクエリを作成 　した場合、多側の削除は可能ですが、一側は削除不可のようです： 　No.1の補足欄で「ちなみに」として触れられている例が該当) > これを踏まえて、上記の手順を確認しながらクエリを作成してみました とのことから、リレーションシップの設定で、「参照整合性」と「連鎖削除」 の設定は済んでいるものと思います。 でしたら、「伝票ヘダー」テーブルだけを元にした削除クエリを作成すれば、 『連鎖削除』の設定により、「伝票明細」の該当レコード(=「伝票ヘダー」 で削除されたのと同じ「発注番号」を持つレコード)も同時に削除されます。 SQL文： Delete 伝票ヘダー.* From 伝票ヘダー Where (伝票ヘダー.出力フラグ = 1);
「都道府県別、商品ID別、月度別集計」ならば、 都道府県, 商品ID, 月度:Format(日付,"yyyy/mm"), [合計] です。
補足です。 名前と動作速度のからみでいうと、 「名前の自動修正」機能がONになっていると 遅くなることがあるので、 僕はそれはいつもOFFにしてます。 他の全く関係なさそうな不具合を頻発したこともあって・・・。
SELECT D.個人No, C.判定フラグ FROM [select a.個人No, a.入社年度, b.所属コード from 社員マスタ A LEFT JOIN 所属テーブル B ON (A.個人No = B.個人No)]. as D LEFT JOIN 判定テーブル C ON (D.所属コード = C.所属コード AND D.入社年度 = C.入社年度) ではだめですか？
自表のサブクエリの結果で更新するといった操作は、RDBMSにより機能差があります。RDBMS名、バージョンを明記してください。
条件は１つだけ使用します。 式　を選んで、[数量]=1 Or [数量]=3 Or [数量]=5 Or [数量]=7 と記述し、フォント赤を選びます。
あまり自信はありませんが like命令みたいな機能を期待して 「ここ」　へは　　*　をいれてみるといいかもしれません （*　には　あいまい検索の機能が有るので） （自信なし） あるいは ｎｕｌｌの時には stLinkCriteria = "[会社CD]=" & Me![会社] というような感じで　[会社]だけの条件文を使用するという ロジックも方法として有ると思います
だんだん回答することに疲れてきました。もう少し解決するための努力をして欲しいです。当方に依存してばかりでは技術者（プログラマー）として自立できません。 と、これだけでもなんなので。 問題をできるだけ切り分ける（以前にも書いたはず） １．当該ＳＱＬ文からクエリを作成し、直接実行する ２．変化がない（０件のレコードが更新されます）ならば、選択クエリに変更して、なぜ０件なるかしらべる ３．クエリが有効ならばＶＢＡが確実に実行されているか、ブレークポイントを設けたり、ステップインで実行してみる
ご質問が抽象的なので本サイトの以下のカテゴリで「複数条件」で検索して、類似質問／回答をご参考にして下さい。 ・デジタルライフ＞ソフトウエア＞Ｏｆｆｉｃｅ系ソフト（又は、ＭＳ　Ｏｆｆｉｃｅ）
つまり得意先コードというのはテキスト型なのでしょうか。 そうであれば、 b = "得意先コード = '" & Me![得意先コード] & "'" として試してみてください。 Where条件で、テキスト型の定数はアポストロフィ(')で囲みます。
>レポートは毎度作り変えないといけないのでしょうか？ そうです。 我々ですと、印刷せずにExcelなどにExportします。Accessは無理 でもExcelは使えるという人は多いし、ExcelプレインストールPCも 多いですからね。「あとは勝手に」という感じです。 >掲載いただいたままコピペしてみたのですが ちょっと参考に書いただけです。本当はレポートを開く時の処理で、 レポートのRecordSourceを動的に書き換えるのが本当の方法です。 Private Sub Report_Open(Cancel As Integer) Dim 画, 自 As String, 至 As String, SQL As String On Error Resume Next Set 画 = Forms("期間抽出フォーム") SQL = Err.Description On Error GoTo 0 If SQL <> "" Then 　　MsgBox "期間抽出フォームが開いていません", vbCritical, "エラー" 　　Cancel = True 　　Exit Sub End If 自 = Trim(Format(画.期間自, "@")) If 自 <> "" Then 　　If Not IsDate(自 & " 00:00:00") Then 　　　　MsgBox "期間自が不正です。", vbCritical, "エラー" 　　　　Cancel = True 　　　　Exit Sub 　　End If End If 至 = Trim(Format(画.期間至, "@")) If 至 <> "" Then 　　If Not IsDate(至 & " 00:00:00") Then 　　　　MsgBox "期間至が不正です。", vbCritical, "エラー" 　　　　Cancel = True 　　　　Exit Sub 　　End If 　　If 自 <> "" Then 　　　　If CDate(自) > CDate(至) Then 　　　　　　MsgBox "期間自＞期間至です。", vbCritical, "エラー" 　　　　　　Cancel = True 　　　　　　Exit Sub 　　　　End If 　　End If End If SQL = "TRANSFORM Count(A.処置履歴ID)" SQL = SQL & " SELECT B.衛生士名前" SQL = SQL & ",Count(A.処置履歴ID) AS 件数" SQL = SQL & " FROM (処置履歴 AS A" SQL = SQL & " INNER JOIN 衛生士マスタ AS B" SQL = SQL & " ON A.衛生士ID=B.衛生士ID)" SQL = SQL & " INNER JOIN 処置内容マスタ AS C" SQL = SQL & " ON A.処置ID=C.処置ID" If 自 <> "" Or 至 <> "" Then 　　SQL = SQL & " WHERE A.処置日" 　　If 自 <> "" Then 　　　　If 至 <> "" Then 　　　　　　SQL = SQL & " BETWEEN " 　　　　　　SQL = SQL & Format(CDate(自), "\#YYYY/MM/DD\#") 　　　　　　SQL = SQL & " AND " 　　　　　　SQL = SQL & Format(CDate(至), "\#YYYY/MM/DD\#") 　　　　Else 　　　　　　SQL = SQL & ">=" 　　　　　　SQL = SQL & Format(CDate(自), "\#YYYY/MM/DD\#") 　　　　End If 　　Else 　　　　SQL = SQL & "<=" 　　　　SQL = SQL & Format(CDate(至), "\#YYYY/MM/DD\#") 　　End If End If SQL = SQL & " GROUP BY A.衛生士ID" SQL = SQL & " PIVOT C.処置内容" Me.RecordSource = SQL End Sub 但し、SQLの項目名とレポートのコントロールソースが合っていない ので、一度、上記クエリ（RecordSourceに代入直前のSQL）を元に レポートを作り直してください。
＞stLinkCriteria = "[カナ氏名]=" & "'" & Me![カナ氏名] & "'" stLinkCriteria = "[カナ氏名] Like '*" & Me![カナ氏名] & "*'" でしょうか？
フォームやテーブル、テキストボックスなどの名前を 詳しく提示されたほうがよいかもしれません。 でないと、多分、回答するほうが推測になってしまうので 正解を得る前にわけがわからなくなってしまう可能性があります。 ・基本情報のフォーム名 ・それは連結フォームなのか？ ・連結しているならそのテーブル名 ・明細のほうの同じ情報 ・明細フォームは基本情報のフォームにサブフォームとして埋め込んであるのか？ ・そうじゃないとすれば、単独の明細フォームなのか？ ・明細フォームのなんという名前のテキストボックスに基本情報を 転記したいか？ などです。
テキストボックスのプロパティでしょうか。 それなら 「使用可能」 を 「いいえ」 「編集ロック」 を　「はい」とすることで 元の背景色になります。
クロス集計クエリーを作成したらいいですね クロス集計クエリーは 集計行にて 　衛生士ID　　　グループ化を指定　　　　 　処置ID　　　　グループ化 　件数把握のためには　なにか数値項目を１つ適当に指定して 　そこへは　「カウント」としたらいいです 　**結局　３つの項目をアウトプット指定する** 「行列の入れ替え」へは 　衛生士ID　　列　　　 　処置ID　　　行 　数値項目のところは　カウント と指定します （件数が０件の部分は０ではなくてNULLになると思われる） （NULLを０にするには　別途　更新クェリーを作成　NULL　なら 0） -------------------------------------------------- 年月日による選択は（簡易に書くと） フォームを作成して そのフォームで　年月日を２つ「テキスト項目」を作成して そこへ入力したほうが楽だと思います その２つのテキスト項目を　クェリーの「抽出条件」行のところにて [Forms]![フォーム名]![フォームでの項目名] の機能を使用すれば　選択が簡単にできます between forms![フォーム名]![フォームでの項目名]　and forms![フォーム名]![フォームでの項目名]
no1です。当方のパソコンでは記載したサイトにつながることを確認しましたが、あなたの場合どうしてできないか、私はわかりません。
絶対値を取れれば良いのでしょうか？ ABS(-123)　->「123」 ですかね。
＃７の補足を読むと、当該フォームは概ね私の意図したとおりに動き、そしてそれはcamo-tさんの望むものとは違うようです。 そもそも誤解の始まりは「質問番号：5243829」です。質問文の意味がはっきり読み取れなかったのですが、「文房具店に売っているような納品書には最初から連番が振ってあるものがありますよね？あのイメージです」だけを根拠として回答してきました。「最初から連番」がオートナンバーで振られる番号で、文房具店の納品書が動的に動かないように、従業員（コード）が変わっても、連番が変わることはありません。 ともかく本件はそろそろ打ち止めにしたいです。私が回答するかどうかは別にして、そもそもの仕様やテーブルの構造、相互の関係などを明確にした質問文を新規作成することを強くお奨めします。
mattalixさんが回答されているとおりですが、 SQLite、PostgreSQLなどの追記型のデータベースは、deleteで論理削除し、vacuumで物理削除するしくみです。 (ちなみに、PostgreSQLは、 vaccumで、deleteを再利用可能領域に変換する=>ファイルサイズ変更なし、 vaccum fullで、ファイルサイズ詰めです。SQLiteは、vaccumでファイル サイズも小さくなります。） 「deleteの後のトリガーに登録」？ということについては、 SQLiteをどのようなケースでご利用されているか、 （デスクトップアプリケーションの組込みDBか、Webアプリケーションのバックエンドか）わかりませんが、 deleteした時に、物理ファイル内のデータも削除しなくてはならないなど 特別な理由がない限り、vacuumの処理は、deleteのタイミングごとに行うというよりも、むしろデータベースのメンテナンスとして定期的にバッチ処理で行うのが一般的かと思います。 （vaccum処理対象のレコード数が多いと、それなりに処理に時間がかかるためです。） つまり、デスクトップアプリケーションならば、アプリ起動時や終了時に自動実行するか、ユーザがメニューから「最適化」処理として呼び出せるようにする、Webアプリケーションならば、サイトのメンテナンス日などにスケジューラで実行させる(Linuxならばcron、Windowsならばタスクから、vaccum処理を記載したプログラムを呼び出す)などです。
> また、2002でString関数を使って簡易的なグラフを作成していますが、そのフォームを2002で開くと普通に簡易グラフが表示されます。 しかし、それを2003で開くと、画面が点滅して固まります。 これじゃないかな？ http://support.microsoft.com/kb/837457/ja 参考URL：http://support.microsoft.com/kb/837457/ja
追加クエリをつくって、ＶＢＡから実行させる方法もあります。
Accessのクエリーで結合条件のプロパティを開くと 「両方のテーブルの結合フィールドが同じ行だけを含める」 「（テーブルA）の全レコードと（テーブルB）の同じ結合フィールドのレコードだけを含める」 「（テーブルB）の全レコードと（テーブルA）の同じ結合フィールドのレコードだけを含める」 の3種類があると思いますが テーブルAにしか存在しないレコードを抽出したい場合は 2番目の結合を選び、テーブルBの結合フィールドの抽出条件をIs Nullとします。 逆にテーブルBにしか存在しないレコードを抽出したい場合は 3番目の結合を選び、テーブルAの結合フィールドの抽出条件をIs Nullとします。 結合の種類を2番目から3番目に変えるとき Is Nullの条件を指定するフィールドも変えなければいけません。 質問者様の例でいうと、 今年度にしか存在しない端末を抽出したい場合は昨年度の端末名をIs Null 昨年度にしか存在しない端末を抽出したい場合は今年度の端末名をIs Null としなければいけません。 失礼ながら、この点を間違えておられるのではないかと思います。 違っていたらすみません。
＃６です >>新規作成→オートナンバーで連番が自動作成される >これはどういう操作でしょうか？ 新規作成は、「納品書新規作成」のつもりでした。＃６に書いたような構造を持つ、「納品書テーブル」の存在が前提です。このテーブルに「納品書ID：オートナンバー」が存在しなければならないですが、「その作り方も判らない」ようであれば、入門書などで勉強してください。 >>新規レコード追加→親子の関連づけにより「注文テーブル」の「納品書ＩＤ」に親フォームの「納品書ＩＤ」が記載される >この「関連付け」はどこでなされているのでしょうか？ 「親子の関連づけ」が正しくされていれば、アクセスが面倒を見てくれます（自動的に記入してくれる）。
グループ化した場合、GROUP BY 句で指定しない項目は集計関数を使う 必要があります。(1)を全部書いてしまうと、次のようになります。 SELECT A.品番 AS 品番,SUM(A.数量) AS A数量,SUM(A.金額) AS A金額, SUM(B.数量) AS B数量,SUM(B.金額) AS B金額 FROM テーブルA AS A LEFT JOIN テーブルB AS B ON A.品番=B.品番 GROUP BY A.品番 UNION SELECT B.品番 AS 品番,SUM(A.数量) AS A数量,SUM(A.金額) AS A金額, SUM(B.数量) AS B数量,SUM(B.金額) AS B金額 FROM テーブルA AS A RIGHT JOIN テーブルB AS B ON A.品番=B.品番 GROUP BY B.品番 ちょっと説明不足でしたね。
メニューバー「表示」から「並べ替え/グループ化の設定」を選び、 フィールドに「学年」を指定します。「同一ページ印刷」を「いいえ」に 設定すると、複数学年の情報が同一ページに出力されなくなります。 また、学年以外にクラス、氏名など並べ替えたいものがある場合は 上記の「並べ替え/グループ化の設定」でフィールドを指定しておく 必要があります。尚、特定の学年のみレポートするのであれば、 レコードソースのクエリで、条件句を記述して、抽出条件を設定する こともできます。
エクセルではこの種の問題は楽と考えやってみました。このデータをエクセルにエクスポートし、データのないところには「ZZZ」を入れると、次のマクロで実行できました。計算結果は表の右側に出てきます。期日が同じときはdoubleddateのエラーメッセージが出てきます。 Sub Macro1() ' ' Macro1 Macro ' マクロ記録日 : 2009/8/27 ユーザー名 : ' Dim myid1 As String, myid2 As String, mydate1 As Date, mydate2 As Date, aa As String, bb As String, cc As String, dd As String, ee As String, mygyo As Integer, mygyo2 As Integer, myarray(8) As String, myclm As Integer, mymyclm As Integer, hajimegyo As Integer, zzz As String, mygyo3 As Integer, myid3 As Integer, mydate3 As String For mygyo = 2 To 9 myid1 = Cells(mygyo, 1) mydate1 = Cells(mygyo, 2) mygyo2 = mygyo + 1 myid2 = Cells(mygyo2, 1) mydate2 = Cells(mygyo2, 2) 'IDが同じか調査 If myid2 = myid1 Then hajimegyo = mygyo ' MsgBox (myid2) '期日が同じか調査 If mydate2 = mydate1 Then '期日が同じ MsgBox ("date doubled") MsgBox (mydate2) Else '期日が同じでない For myclm = 3 To 7 'データがZZZか調査 'MsgBox (Cells(mygyo, myclm)) If Cells(mygyo, myclm) = "zzz" Then 'データがZZZである myarray(myclm) = Cells(mygyo2, myclm) 'MsgBox (mygyo2) Else myarray(myclm) = Cells(mygyo, myclm) End If Next For myclm = 3 To 7 mymyclm = myclm + 7 Cells(mygyo, mymyclm) = myarray(myclm) Next End If Else End If '次のIDが同じか調査 mygyo3 = mygyo + 2 myid3 = Cells(mygyo3, 1) 'MsgBox (mygyo3) mydate3 = Cells(mygyo3, 2) If myid3 = myid1 Then '期日が同じか調査 If mydate3 = mydate1 Then '期日が同じ MsgBox ("date doubled") MsgBox (mydate3) Else '期日が同じでない For myclm = 3 To 7 'データがZZZか調査 mymyclm = myclm + 7 'MsgBox (Cells(mygyo, mymyclm)) If Cells(mygyo, mymyclm) = "zzz" Then 'データがZZZである myarray(myclm) = Cells(mygyo3, myclm) 'MsgBox (mygyo3) Else myarray(myclm) = Cells(mygyo, mymyclm) End If Next For myclm = 3 To 7 mymyclm = myclm + 7 Cells(mygyo, mymyclm) = myarray(myclm) Next End If End If 'MsgBox (myid1) Next ' End Sub
手動印刷も同じですが、スクリプトで印刷するときは印刷設定もセットで組まないと、最後に使用した印刷設定が記憶されるはずです。 印刷設定無しで印刷したことがないので・・・・
新規レイアウトではなく、新規テープルで画像だけをポータル表示すればいいのでは？ ポータルは行ごとに分割できますから。
厳密に書くと SELECT a.name, b.id FROM テーブルA AS a , テーブルB AS b WHERE... となります。 FROM句で宣言している テーブルA AS a は、 「テーブルAをaという名前で扱いなさい」 という意味。 もちろん SELECT テーブルA.name, テーブルB.id FROM テーブルA , テーブルB WHERE... と書いても同意ですが、 SELECT句にいちいち テーブルA.* , テーブルA.** , テーブルA.*** と書くのは面倒ですよね。 さらに、副問い合わせや、同一テーブルを別々に扱いたい場合などなどなど・・・・ 様々な場面で AS を使うことで、すっきりと見やすいSQL文を作ることも可能です。
select a.EMPNO as EMPNO 　　　,b.DATA1 as DATA1 　　　,case when b.DATA1 >= c.DATA2 　　　　　　 then null 　　　　　　 else c.DATA2 　　　　 end as DATA2 from tb_a a left outer join tb_b b 　 on a.EMPNO = b.EMPNO left outer join tb_c c 　 on a.EMPNO = c.EMPNO order by EMPNO,DATA1 --------結果----------- EMPNO　　DATA1　　DATA2 000001　　　　　　　　　AAAAA 000002　 　AAAAA　 BBBBB 000002　　 BBBBB 000002　　 CCCCC 000003　　　　　　　　　CCCCC
同じレポートの最後に分類別小計もプリントしたい、ということですか？ もしそういうことなら、サブレポートを作ることで実現できそうです。 まず、小計の部分のレポートを作ります。すでにおつくりになられたクエリを元に作ることになります。これが次のサブレポートになります。 メインレポートで、レポートフッタ(ページフッタではない)を表示させ(上のメニューバーの「表示」のところにある・・・はず)、そこに小計のレポートを無連結のサブレポートとして貼り付けます。 サブレポートって何？ということでしたら、ここらへん↓をご参照ください。 http://office.microsoft.com/ja-jp/access/HA10209 … http://office.microsoft.com/ja-jp/access/HP05187 … http://www.mahoutsukaino.com/ac/ac97/basic/subr1 …
カテ違いです。 SQL＊PLUSはORACLEなので、カテゴリーを変えると回答が集まり易くなりますよ！きっと。 ちなみに。 set serveroutput on spool @C:\TEST\spool.txt spl文ナンタラ spool off とすると、CドライブのTESTフォルダのspool.txtファイルにsql文とその結果セット表示が「これが、貴方の命令でスプールしたモニター表示でございます」と言う感じに書き込まれていたと思います。
どの場面に出てくる何と何の違いなのかを示してもらいたい。 特に "結合プロパティ" のほう。 クエリのデザイン画面に出てくる結合プロパティの事を言ってますか？ Access 2007 での説明になるが、メニューの場所の違いはあれど意味は旧バージョンでも同じ。 Access でいうリレーションは、テーブルとテーブルの結びつきを "静的に" 設定する作業。 ここで設定したものは DB 内のすべての場面において活きてくる。 クエリ等のデザイン画面にテーブルを 2つ以上配置してフィールド間を結びつける際の "結合プロパティ" は、そのクエリの中でのみ有効な設定。 ちなみにリレーションのデザイン画面でも、テーブルとテーブルの間に引いてある線を右クリックしてリレーションの設定画面を出し、その中の "結合の種類" というボタンを押せば "結合プロパティ" が出てくる。
(1)クエリとして実現したい場合は該当フィールドの他にレコードを 一意に識別できる項目が必要です。 (2)レポートで出力する場合はグループヘッダに指定することで、 最初に出現したものだけを表示することができます。 いずれにも該当しない場合は単純な方法では処理できません。
　私も一時期迷いましたが、結果的にPostgreSQLにしました。 ・将来性 　PostgreSQLは将来性があります。これからもOracleに追いつき、追い越そうと進化していくでしょう。 　ですが、Oracleに買収されたMySQLにはそれは絶対にありません。むしろ棲み分けのために機能が押さえ込まれていく可能性の方が高いように思います。また、今までMySQLを支援してきた開発コミュニティの大多数は、「あのOracle社」の売り上げに貢献するためにボランティア活動を続けていけるほど心が広くないのではないかと思います。 ・設計 　PostgreSQLはかなり「マトモな」DBだと思います。「え？こんなことが？」ということがほとんどありません。全般的に70点、というカンジです。 　ですが、MySQLはかなりクセがあります。一般的なSQLのコツ以外に、MySQL独自の制約やコツのようなものがけっこうあります。（サブクエリが異様に遅いとか）　普通ならこうするけど、MySQLの場合はこうしないといけない、というようなことはあまり考えたくないです。 　それよりなにより、なんといっても「シーケンスがない！」というのが衝撃でした。もちろん代替策はあるんですが、「代替策があるからシーケンスなんて無くてもいいだろ」という考え方はどうも納得できません。 　PostgreSQLは、機能改善の仕方が順序立っていて、まずこの機能、次にこの機能、という流れがとても自然な気がします。反面MySQLは行き当たりばったりで機能拡張していて、結果的に100点の部分もあるけど0点の部分もある、という印象です。 ・コスト 　PostgreSQLはどこまでいっても無料、というのが安心です。反面、責任を持っている企業もないというのが不安といえば不安ですが、有償でサポートしている会社がないわけではないので必要ならそういうところを利用するのもあるかと思います。 　反面、MySQLは責任を持っている企業がある反面、そこがサポート収入に異様にどん欲なところである点が不安です。無償版の存続すら絶対とは言えない状況ですから。 ・情報 　日本語の情報に関していえば、PostgreSQLが圧倒的です。ですが、マニュアル自体がかなり簡素なので、突っ込んだことを知りたいと思うとユーザのブログなどの非公式情報に頼ることが多く、ここが物足りない点ではあります。 　MySQLは今現在は日本語の情報が少ないのですが、Oracleはマニュアルなどの技術情報の開示についてはかなり積極的ですし、ドキュメントの日本語化もかなりスピーディです、今後は期待できるかもしれません。 ・その他 　MySQLの利点は、無償版でもクラスタの機能があるところです。PostgreSQLは単体ではクラスタの機能がありません。（私はここで迷った） 　ただ、pgpool2などの外部のプロジェクトやDRBDなどを使えばカバーできますし、PostgreSQLも次のバージョンでクラスタリングがサポートされそうな雰囲気です。（本当は今のバージョンで実装されるはずだったが間に合わずに延期になった） 　これらの点を総合的に判断すると、やっぱりPostgreSQLかな、と自分的には判断しています。
「mdb」とあるので、Microsoft Access の話だと思いますが、バージョンは 何でしょうか。 バージョンによって回答がまったく変わってきますので、バージョン情報が 非常に重要になってきます。 Access 2007 以降であれば、イメージ コントロールに [コントロールソース] プロパティが追加されたはずなので、そちらを試してみるとよいでしょう。 Access 2003 以前であれば、下記を試してみるとよいでしょう。 OleImage 関数 - 表形式(帳票)フォームにパスから画像を表示する方法 | YU-TANG's MS-Access Discovery http://www.f3.dion.ne.jp/~element/msaccess/AcTip … OleImage 関数を使うなら、VBA のコーディングは基本的に不要です （特殊なケースでは数行のコーディングが必要になる場合もあります）。 「使用上の注意」をよく読んだ上で、ニーズにマッチしないと思われる 場合は、他の方の回答を採用してください。 参考URL：http://www.f3.dion.ne.jp/~element/msaccess/AcTip …
うまく伝えることができるかが難点ですが テーブルA/Bの内容が以下だとします。 （ここだけ、新規mdbで確認してみてください） テーブルA） 授業日 2009/04/07 2009/10/05 2009/05/08 2009/03/02 2009/11/03 2009/12/05 テーブルB) 期間名称初日最終日 前期2009/04/012009/09/30 後期2009/10/012010/03/31 ここで、＃１での手順に従って、クエリを作成実行すると 授業日期間名称 2009/04/07前期 2009/10/05後期 2009/05/08前期 2009/11/03後期 2009/12/05後期 の様になります。 > 複数のデータの他のデータも表示されません これは、授業日/期間名称しか表示選択していないので、他は表示されません。 表示したいものは、追加設定していきます（本来のテーブルAの内容上で） DLookup の方法も書いておきます。 今まで使用していたテーブルAを表示するクエリをデザインで開きます。 表示したい位置のフィールド欄に以下を記述します。 （テーブルBを表示する必要はありません） 期間名称: DLookUp("期間名称","テーブルB","[初日] <= #" & 授業日 & "# AND [最終日] >= #" & 授業日 & "#") 上記テーブルA/Bの内容で、授業日/期間名称を表示させると 授業日期間名称 2009/04/07前期 2009/10/05後期 2009/05/08前期 2009/03/02 2009/11/03後期 2009/12/05後期 となります。 テーブルBの範囲にない日付 2009/03/02 の表示では、 前者：表示されません 後者：NULL　（空白）表示となります また別の方法：テーブルBを使わない方法） ４～９月：前期 １０～３月：後期 という設定が今後も変わらないのであれば、授業日から計算します。 クエリを作ります。 テーブルAを表示させて、授業日をダブルクリックします。 授業日の隣のフィールド欄に以下を記述します。 期間名称: IIf(Month(DateAdd("m",-3,授業日))<=6,"前期","後期") 内容的には、３か月前の月を求め、６以下なら前期、でなければ後期 クエリをデータシートビュー表示にして表示を確認します。 授業日期間名称 2009/04/07前期 2009/10/05後期 2009/05/08前期 2009/03/02後期 2009/11/03後期 2009/12/05後期 サンプルのデータでは、上記の様になります。 前回 範囲外であった 2009/03/02 にも期間名称は埋められています。 またわからなかったら、補足してください。
> インポートした内容をフォーム上で確認できるようにしたいのですが、それはきついですか データをインポートできればフォームで確認できます。
NO1です。 いろいろ疑問はありますが、とりあえずご提案です。C1に以下式を入力してみて下さい。 =INDEX($A$2:$B$65536,MATCH("開始",$B$2:$B$65536,1),1)
>accessのデータベースはやはり変換する必要がありますか？ テーブルは変更する必要がありません。 データの入出力および更新に関しては、ＶＢ側で作り直したほうが良いと思います。
MySQLは実質、項目数の制限がありません（サイズによる制限はあるが）。 ACCESSで255項目以上を扱う場合はテーブルを分けるしかないと思います。それに項目数が無制限だとしても１テーブルに100項目程度くらいにしたほうがいいですね。そのほうが管理しやすいと思います。
複数のクエリを作成してフォームサブフォームで対応するようにすればいかがでしょう。 ただ、そんなに大量のフィールドが本当に必要なのかどうか 再度設計をを見直してもいいと思われます。
以前のバージョンにあった、「ワークグループの管理」機能を使用しての ユーザーごとのパスワード設定や権限の管理は可能ですが、 適用対象は「mdbファイル」(Access2002-2003形式)に限られます。 http://office.microsoft.com/ja-jp/access/HA10166 … (「accdbファイル」(Access2007形式)の場合はWindows Sharepoint 　Servicesを使うしかない?：この辺り、触れたことがないので・・・(汗)) http://office.microsoft.com/ja-jp/access/HA10165 … (「Windows SharePoint Services を使用した Web での共同作業」の項を参照) ・・・「ワークグループの管理」を使用した管理は、正直、最初は意味がわからない 感じがするのではないかと思いますが、大雑把な流れだけあっさりと・・・(汗) (詳細は、1つ目に挙げたURLを参照下さい) 1)新規データベースをmdb形式で作成 2)『データベース ツール』リボンの『管理』枠にある『ユーザーと権限』の「▼」 　をクリックして、「セキュリティ ウィザード(W)」を選択 　※mdb形式でないと、『管理』枠は表示されないようです。 3)ウィザードに従って、処理を進め、「mdwファイル」と「セキュリティ設定された 　データベース」を作成 　※拡張子が「.bak」のファイルは、セキュリティ設定前のファイルです(拡張子 　　のみ書き換え)。既存のデータベースにセキュリティ設定を行った後で、 　　パスワードを忘れるなどして開けなくなった場合には必須になるので、 　　削除はしないことをお勧めします(完全な新規ファイルの場合は削除可)。 　※こちらはAccess2003/2007が共存した環境で使用しています。 　　Access2007単独だとウィザードが止まるようでしたら、ご容赦願います(汗) ウィザード上では、とりあえずは殆どデフォルトのままでもOkだと思います。 (PIDやWIDといったものが出ますが、通常はこれを入力するシーンは発生しない) 指定するとしたら、ファイル名ぐらいでしょうか。 それ以外は、上記ID系を除いて、後で編集が可能ですので。 (上でウィザードを呼び出した「▼」で 　　「ユーザー/グループのアカウント(A)」でユーザーやグループの追加/削除が 　　「ユーザー/グループの権限(P)」で各ユーザー・グループの権限が、 　それぞれ編集できます) なお、最後に表示されるレポートは、ウィザード上でも警告が出るはずですが、 必ず保存してください。 (・・・ウィザードの各画面は、念のためスクリーンショットで記録を取った方が 　安心かも・・・： 　上記のID系が、レポートで「作成済み」としかでなかったような、おぼろげな 　記憶があるので) 一応、Access2003時の情報も参考までに挙げておきます： http://office.microsoft.com/ja-jp/access/HP05257 … ※No.1の方が言われるように独自システムで対応される場合は、Shiftキーを 　押しながらファイルを開くと、起動時に動くはずの処理(AutoExecマクロや 　自動で開く設定にしていたフォームなど)が行われなくなるので、それについての 　対処も必要になるかと思います。 　(対処法については「Access AllowBypassKey」でWeb検索して下さい： 　　Access2007でも多分対応しているはず(汗))
Excel2007(エクセル2007)基本講座の総目次 http://www.eurus.dti.ne.jp/~yoneyama/Excel2007/i … Excel2007(エクセル2007)Q&A(Tips)：Excel2003以前のデータ→フォームはどこにあるの？ http://www.eurus.dti.ne.jp/~yoneyama/Excel2007/F …
クエリＡ→クエリＢと、クエリＢ→クエリＡをUNIONします。 (1)クエリ:Q1 SELECT A.薬品コード AS KEY, A.薬品コード AS Aコード,A.名称 AS A名称,A.数量 AS A数量, B.薬品コード AS Bコード,B.名称 AS B名称,B.数量 AS B数量 FROM クエリＡ AS A LEFT JOIN クエリＢ AS B ON A.薬品コード=B.薬品コード UNION SELECT B.薬品コード AS KEY, A.薬品コード AS Aコード,A.名称 AS A名称,A.数量 AS A数量, B.薬品コード AS Bコード,B.名称 AS B名称,B.数量 AS B数量 FROM クエリＡ AS A RIGHT JOIN クエリＢ AS B ON A.薬品コード=B.薬品コード (2)上記クエリを元に作るクエリ SELECT Aコード,A名称,A数量,Bコード,B名称,B数量, Nz(A数量,0)+Nz(B数量,0) AS 合計 FROM Q1 ORDER BY KEY
＞成績データベースは番号1、氏名1、番号2、成績2の４フィールドがあるとします。 ここは、 番号、氏名、成績の３つのフィールドでいいんじゃないでしょうか。 なぜ同じ内容（番号）なのに番号という名のつくフィールドを３つ（番号、番号１、番号２）も作る必要があるのでしょうか？ 特に番号２の意味がわかりません。 名簿データベースの『番号』と成績データベースの『番号』のリレーションをとり、成績データベースのフォームに名簿データベースのフィールドを乗せればいいんじゃないでしょうか。
＃１、＃３です。テーブルをドラッグ・ドロップで子フォームを作成したことはなかったので、試してみました。いくつか気付いた点 １．子フォームのレコードソース 「処置履歴」テーブルになっていますが、クエリにして並べ替え順を指定した方がよいでしょう。指定がないとＤＢがどのような順でデータを返すかは不定です ２．子フォームの表示形式 リストタイプ（データシートや帳票）でも良いでしょうが、単票にしてかつ日付降順にしておけば、最終レコードが表示され使いやすいかもしれません この問題に関し、さらなる疑問点などが生じた場合は、補足などで質問するより、新しい質問で投稿することをお奨めします。「補足」ではごく少数の人しか読まないし、従って回答も偏ったものになってしまいます。
はい, フォントの書式設定に「上付き」や「下付き」があります.
No.3です。 マナーを守って質問するのは悪くないですよ。その為のサイトです から。お礼とかも馴れて来ますよ。それよりＰＣは解決しました？ ハードディスクは足りてる様ですね。メモリはどうだろ？ ＯＳの再インストールは軽くなる事が多いけどＰＣに馴れてない人は 危険です。手順を誤ると入れたソフトや大事な写真や書類などのデータ が無くなる事があるので貴方にはおすすめしません。 もしかしてデスクトップ画面いっぱいに沢山のファイルを置いてません か？マイドキュメント等のフォルダに整理してしまわないとＰＣが重い 状態になります。
>SQLiteがMSAccessと同じような仕組みのデータベースだいう記載を見つけ 共通するのは、1個のファイル上に定義情報とユーザデータが管理されることくらいではないでしょうか？ MS-ACCESSはGUIツールがRDBMSと一体になっていますが、SQLiteはそうではありませんし、どの部分を指して「同じような仕組み」と言っているのか意味がわかりません。 >そうですか、SQLiteは参照整合性を実装していないのですか。 SQLiteのマニュアル類を、見る気がないということでしょうか？ マニュアルでは、制約や動作を指定できるけど、解析だけされ機能としては働かないことが明記されています。 http://www.sqlite.org/faq.html#q22 しかし、トリガにより、同じような機能を実装できるといった例が紹介されています。 http://www.sqlite.org/cvstrac/wiki?p=ForeignKeyT … >SQLiteは、RDBというのには機能が低すぎるということですか。 RDBMSには、他のRDBMSと比べて実装が進んでいる部分と遅れている部分があります。SQLiteは、かなり機能を絞り込んで実装されています。
ImportExportSpecificationオブジェクトのXMLプロパティに、 指定ファイルのパス名が格納されていることは確認できました。 標準モジュールに以下のコードを貼り付けた後、Ctrl+Gキーで イミディエイト ウィンドウを表示させたら、そこに「ImpExpTest」と 入力して、Enterキーを押してください。 指定したインポート操作について、XMLプロパティに記録された 値がイミディエイト ウィンドウに表示されます。 あとは、InStr関数を使って、「Path=」の直後とその次の「"」の 位置から、パスの開始位置と長さを確認して、Mid関数で 切り出し、ということになるかと思います。 (こちらはコード省略させていただきます) Public Sub ImpExptest() On Error GoTo エラー処理 　　Dim Prj As CodeProject 　　Dim Obj As ImportExportSpecification 　　Dim ImpName As String, strXML As String 　　'パス名を確認するインポート操作の名前を指定 　　ImpName = "(保存済みのインポート操作名)" 　　'XMLプロパティの値をイミディエイト ウィンドウに表示 　　Set Prj = CurrentProject 　　Set Obj = Prj.ImportExportSpecifications(ImpName) 　　ｓｔｒXML = Obj.XML 　　Debug.Print strXML 　　 終了処理: 　　'念のためにメモリを明示的に開放 　　Set Obj = Nothing 　　Set Prj = Nothing 　　Exit Sub エラー処理: 　　MsgBox Err & "：" & Error$, , "ImpExpTest" 　　Resume 終了処理 End Sub
FMそのように項目が横並びの集計は少々面倒です。 2009/08/01 　食費1000 　光熱費0 　交通費0 　・・・・・ 2009/08/02 　食費300 　光熱費3000 　・・・・・ と縦並びならすぐできますけど。
レイアウトモード ↓ レイアウトメニュー ↓ レイアウト設定 ↓ レコードの変更を自動的に保存
質問していることが理解できません。売上と粗利を同時に見たいということでしょうか、それとも、クリックで売上と粗利を切り替えてみたいのですか。
それほど高度なことをしないなら、 また、Webデータベースなどを作らないなら、 Accessのほうがよいかとは思います。 他の方のご回答どおり、情報が多いですし、 いたるところでSQLが使えますから。 ファイルメーカーも面白いソフトですが、SQLが使えないようなので 色んなソフトに応用の利く汎用テクニックが習得できません。 なお、Accessはデータベースソフト（RDB)ですが、 ExcelがまったくAccessのようなことができないわけでもありません。 Excelにも、「MicrosoftQuery」というソフトが使えるようになっていて （「新しいデータベース」というやつです）、Accessのクエリと 同じようなことができます。 RDBが小規模な局面でも生きるとすれば、 例えば、 ・件数が2000件くらいだけど、 ・ベン図で表現するような「AND」と「OR」を使った、 　かつ、複数の表をからませた、 　複雑な条件でのデータ抽出をしたい。 とか、 ・Excelのピボットテーブルと連携させて詳細なデータ集計をしたい。 ・それを分析に役立てたい。 というような場合だと思います。 その場合は、 「MicrosoftQuery」か、Accessを使うと、無駄なVBAプログラムを 書くことなく、目的が達せられます。 Accessもファイルメーカーも体験版（試用版）がありますから 一度お試しになってみてはいかがでしょうか？ 比較的簡単なデータ処理でしたら、「MicrosoftQuery」で十分かもしれませんが・・・。 >どういった関係の職種 小規模な例では、 営業さんなんかが、自発的に数字を集計、分析などをして、 仮説と検証やマーケティングに用いたりするようなときに 使います。 Excelのピボットテーブルと連携させると 普段行なっている集計を、10倍～時には100倍以上の効率で終らすことも 可能です。 規模が大きくても小さくても、 「分析効率を今以上に上げたい。」 「目標を決める前にまずいろんな角度から現状分析したい」 「Excelだけを使うより、もっと短時間に、いろんな角度からの 　分析をしたりしたい。 「いろんなパソコンにバラバラにExcelファイルとして 　　散在している業務データをを一元化管理したい。 　　そしてデータを一度入力したらいろんな使いまわしが 　　できるよにしたい」 などの要望があれば、Accessや、「MicrosoftQuery」が生かせると 思います。
そのフォームをデザインビューで開き、プロパティを表示します。 プロパティ「データ入力用」が「はい」になっていたら「いいえ」に変更してみてください。 追加/削除/更新の許可は、処理に合わせて設定してみてください。
質問しているほうもあまりわかっていないんでしょうね。 逆に、ツールってなんですか？ってその人に聞いてみればよかったのかと。 話の内容から想像するに、 「DBMS」 　Oracle DB + バージョン番号 　SQLServer バージョン番号 　DB2 MySQL など。 「ツール」 　DBにアクセスするツール 　=SQLPLUSとか、object Browserとか。 　 MS-Access経由のODBC接続とか。 　DBを使用しているアプリケーション 　Visual Basicだったり、 　Oracle EBSだったり、Oracle BAMやWebLogicとか。 を聞いているのではないかと想定されるけど。
＃５です （なにも反応ありませんが、どうしたのでしょうか） 補足の補足です） > ボタンクリック時、マクロのフィルタの実行で、Where条件式に > [備考] Like "*" & [Forms]![フォーム]![検索] & "*" > を記述すると、VBAで以下の記述と同じことになります。 > Private Sub ボタン_Click() >　　Me.Filter = "[備考] like '*' & [Forms]![フォーム]![検索] & '*'" >　　Me.FilterOn = True > End Sub 上記、はしょって記述しました。 マクロのフィルタの実行は、実際には DoCmd 系の ApplyFilter に変換されるようですが、その処理の主は上記だと思っています。 また同様に DoCmd 系に ShowAllRecords があって、フィルタ解除できますが ApplyFilter と同様に Me.Filter / Me.FilterOn を操作するものと、私は解釈しています。 （ここでの DoCmd 系は、一段皮をかぶった関数でしょうか） Me.Filter に直接設定した方が良いのか、 ApplyFilter を使うべきか悩むところです。 あえて、 ApplyFilter を使用する例として、以下が参考になります。 （私は Me.Filter ばかり使ってますが） なお、マクロの条件式に記述できるのは255バイトと2007のヘルプには記述されていました。 255文字なのかもしれませんが、＃１での記述は LenB でバイト数を求めると 352 バイトになります。 VBA の記述にトライされてみてはいかがでしょうか。 ※　私がフィルタに記述する時に注意していること SQL の Where句の記述ができるとヘルプ等に書いてますが、BETWEEN は使わないようにしてます。 単純なものでは動くけど、条件が複数になると動かないなど、いい目見てないので。 その時には、○○ BETWEEN XX AND YY を ○○ >= XX AND ○○ <= YY に変更したり。 単純な比較演算子のものを AND / OR でつなげていくことをします。 （前述したようにコントロールの参照ではなく、即値を利用した内容で） （伝わりましたでしょうか）
テーブル等の構造示されたので、試してみました。どうも集計クエリを使用して、更新をかけようとするとエラーになるようです。これがＳＱＬの仕様なのか、Accessの仕様なのか良く判りません。 で、対策なのですが、迂回手段として、集計クエリから一旦テーブルに出力し、それを利用して更新をかければできます。 １．中継用のテーブルを作成 名称：入出庫集計テーブル フィールド：部品品番、出庫数の合計 ２．中継用テーブるのクリア ＳＱＬ文：DELETE 入出庫集計テーブル.* FROM 入出庫集計テーブル; ３．集計の出力 ＳＱＬ文：INSERT INTO 入出庫集計テーブル ( 部品品番, 出庫数の合計 ) SELECT 入出庫テーブル.部品品番, Sum(nz([入庫数],0)-nz([出庫数],0)) AS 出庫数の合計 FROM 入出庫テーブル GROUP BY 入出庫テーブル.部品品番; ４．更新クエリ ＳＱＬ文：UPDATE 部品マスターテーブル INNER JOIN 入出庫集計テーブル ON 部品マスターテーブル.部品品番 = 入出庫集計テーブル.部品品番 SET 部品マスターテーブル.現在庫 = [入出庫集計テーブル].[出庫数の合計]; あまりスマートとは思えませんが、実行できました。
たしかに辞書もデータベースの一種なんだろうけど、製品名やバージョンぐらい欲しいですね。
カスタムアクセス権を使わすに、ということですか？ OnObjectEnterのスクリプトトリガを使って If［フラグフィールド≠進行中］ 　フィールドへ移動-----フィールドを指定しない End If などを実行するよう設定します。 全部のフィールドにトリガ設定が必要です。
正規化しない方のデメリットは言うまでもありません。 ・状態が４つ以上持てない（この内容だと確実に３つじゃ足らなくなりますよ） ・状態コードでの検索がしづらい（状態1='001' OR 状態2='001' OR 状態3='001') ・状態コードでの集計がしづらい（UNIONしないと集計できない） また、更新もこちらの方がしづらいでしょう。 ・同じ状態コードを重複して登録しないようにしなくてはならない、またそのような制約をかけづらい ・未登録のフィールドを探して更新しなくてはならない ・状態コードのみの更新であっても、商品テーブルの行全体をロックしてしまう テーブルを分けると単純にJOINしただけでも状態の登録数だけ商品マスタが増幅されてしまって扱いづらいと思っておられるかもしれませんが、MAXを利用してグループ化すれば正規化しないイメージのレイアウトでデータは簡単に取得できます。JOINを書くのが面倒なら、ビューなりを作成しておけばいいでしょう。 結合により件数次第で検索速度は下がるかもしれません。しかし、正規化しない例では状態マスタを３個結合しないと状態名込の情報を一発で取ってこれません。だから実際には問題にはならないと思います。 以下はDBMS次第です。 ・ウィンドウ関数をサポートしているならば、状態コードに枝番そのものを設けないことも可能です。その方が登録処理が容易になります。 ・連鎖更新をサポートしていないならば、主キー（商品コード）を後で変更しなくてはならないようなデザインにはしないことです。
> １．両者の違い　と　その使い分け　 私は次のように考えています。 クロス集計クエリもピボットテーブルも、「クロス集計ツール」の一種。 どちらを使っても良い。 ただ、ピボットテーブルのほうが高度なクロス集計ができる。 例えばAccessのクロス集計クエリは「値」に指定できるフィールドが１つだけだが、 ピボットの場合は、仕様の限度までいくつでも、複数の「値」を指定し、 同時集計ができる。 集計の切り口をユーザーがリアルタイムに自由に変える事ができる。 クロス集計クエリではそのような部分がピボットよりも自由度が低い。 そのため、基本的にAccessのクロス集計クエリは必要箇所以外は あまり使わない。 Accessのクロス集計を使うのは、 ・どうしてもレポートやフォームのソースなどとして必要 な場合しかあまり使いません。 でもレポートもどうしてもAccessのレポートじゃないといけない場合 以外は、ピボットで代用してしまいます。 結局、「Excelにデータを落としたい」という要望が大抵出るので、 レポートやクロス集計クエリにするのが面倒ということもあります。 （ExcelピボットはAccessにつなぐ場合は、ソーステーブルが65000件 　超えててもOKなので） ですから、 「最終的にいろんな角度から集計・分析したい」という要望がある場合は、 私はほとんどピボットテーブルを使います。 ピボットのほうが、ユーザーがあとから「こんなこともしたい」と 言ってきたときに、先に作ったものを見せ方を変えるだけで済むこともあるので。 ・社内向け集計書類→ほとんどピボット。 ・社外向け集計書類やどうしてもAccessのクロス集計クエリでないとマズイ場合 　　→クロス集計クエリ。 ・システムの中で、どうしてもAccessのクロス集計クエリでないとマズイ場合 （クロス集計の結果をさらに加工してサブシステムなどで使いたいとき など。） 　　→クロス集計クエリ。 という感じでしょうか？ 要は 「ピボット」＞「クロス集計クエリ」という感じ。 ピボットでできないのは、出力結果をネストさせてAccessのレコードセット にすることくらいではないでしょうか？ 最終結果出力としてなら、レイアウト的には、「クロス集計クエリで できることはすべて、ピボットの中に含まれてしまう・・・」 というイメージでとらえています。 ちなみにAccessにもピボットはありますが、Excelのほうが自由度が大きいですし、 あまりAccess内にピボットを増やすと容量が肥大することもあるので、 AccessにExcelから接続して、Excelのピボットを使う場合が多いです。 それをAccess側からCOMなどで自動的に開いたり、 操作（自動レイアウト変更など）をしたりします。 >２・印刷プレビューでうまく表示されない（レイアウト） 状況がよくわかりませんのでどうお答えしてよいかわかりません。 何の何のレイアウトが印刷プレビューでうまく表示されないのでしょう？ >３．Web形式で出力したいのですが ？？ ブラウザ上でピボットテーブルやクロス集計クエリを操作したいという意味でしょうか？ もしそうでしたら、ピボットテーブルならできるので、この場合は クロス集計クエリは要らないとは思いますが、ユーザーさんのご要望が どうなのかよくわからないのでなんともいえませんが・・・。
2007は使ったことありませんが、たぶんできるでしょう。 うろ覚えですが、Forms![フォーム].[コントロール]、というような感じで開いているフォームの上の、コントロールの値を参照できます。 クエリの場合は、[クエリ].Parameters![パラメータ]、だったかな？こっちはもっと自信ありませんが。
> 合計の行を上と下にも太線を引きました。 合計の行の上ではなく、「3 3 レモネード　220円」の下に線を引いてみてください。 見た目からはわからないのですが、実はそこはExcelは「下の行の上線」か「上の線の下線」か区別しています。 「3 3 レモネード　220円」の下に線を引いた後に3行と4行の間に1行挿入すると、挿入した行の上の線は消えます（というより下に移動します）が、挿入した上の行の下の線は消えません。
>リレーションシップで組んだ 関係ありません。 >複数フィールドで主キーを構成していませんか？ 例えば、部品テーブルはIDと部品名で主キーになっていないかという ことです。もし、このような状態ですと、IDだけでは一意にならない ため、IDだけの結合式では多：多の関係にしかなりません。 テーブルをデザインビューで開いた時、鍵マークのついたフィールドが ２ヵ所以上ないか確認してください。
Advancedでしたらメニューのカスタマイズができるらしいですが 持っていないので詳細は不明。 アカウント制限でメニュー表示を「編集のみ」にして、他の必要な メニュー項目はスクリプトボタンにすれば一応できますが・・
レコード単位は無理だと思うけど、マージフィールドは？コピペできないよ。 参考URL：http://www.filemaker.co.jp/help/html/create_layo …
連結フォームを利用するのをやめて、データの登録、修正等を ＳＱＬ（クエリでも）によって行うことによって解決できると思いますが、、、 ちょっと手間がかかりそうですね。
自己参照と言って、自分のテーブル内の主キーを使って外部制約を掛けているケースです。 階層構造を表現する方法の１つとして使われます。 よくつかわれる例として 社員コード　　　主キー 社員名 上司社員コード　外部制約（社員コード） というのがありますね。
> 初心者なんですが、アクセスが好きで > 独学ながら少しづつ勉強しています。 私も独学でやり、最終的には小さな会社の事務システムをアクセスで作りました。 頑張ってくださいね。
A4 サイズの単票レポート作れば？
>テーブルは細分化したほうが良い 「場合による」としか言えません。「正規化」と言いますが、 あくまで、目安です。実際のニーズによっては「正規化」を 崩す必要があることも想定されますし、実例も多くあります。 >1つのフォームで色々なテーブルに結果を反映できるように 難しいし、やるべきではありません。ハッキリと言えます。 >主キーなしでただつなげただけ ｎ：ｎの組み合わせで、重複が生じます。 ただ、主キーでなくても重複の無いインデックスを設定した項目の 結合であれば、１：１あるいは１：ｎになることもあります。 前にも回答しましたが、１：ｎの組み合わせでは１側のテーブルしか 更新できません。 さっと見ただけですが、次のようにすべきです。 (1)コードマスターは廃止する。 (2)１マスタ：１フォームにする。 (3)売り上げ計画、売上げ結果をマスタと呼ぶのは止める。これも 　　１テーブル：１フォームにする。 (4)１テーブル：１フォームは更新対象で、例えば売り上げ計画が 　　参照するであろう顧客コードは顧客マスタを参照すべきです。
一から十まで聞く内容でもないと思いますので「レコード追加 SQL」で web 検索してみてくださいな。 気に入ったサイトがあったらブックマークしておくと良いでしょう。 レコードの削除や変更などの SQL も学べると思います。 頑張ってください。
条件が適用されたかどうかを直接知る方法はないようです。 なので、テキストボックスの中身が"９：００"以上かどうかを 調べれば良いのでは？ Private Sub テキスト1_AfterUpdate() Dim 応答 If Me.テキスト1.Value = "無" Then 　　If Me.テキスト0.Value >= "9:00" Then 　　　　応答 = MsgBox("いいですか？", vbQuestion or vbYesNo) 　　　　・・・その後の処理 　　End If End If End Sub
何のファイルを何ソフトを使ってCドライブに保存していたときの話でしょうか？？ その辺が解らなければ回答をする方としてもさっぱり解りませんよ 私の意見としてはCドライブ以外にソフトをインストールするのはあまりお進めできません Dドライブにインストールした所でCドライブのシステム入れ替えなどをしたら結局はDドライブにあるソフトも再インストールです アプリケーションは設定なども有るのでDドライブを作る余裕があるならCドライブを拡張して利用した方がいいでしょう 『小さな親切大きなお世話、アナタの悩みママンが解決』 from maman
DBにはファイル名を入れて、「ファイルの実体をDB外で管理」するメリットは、 ・DBを経由することによるオーバーヘッドがない ことにつきるかと思います。とくに、Webサーバアプリケーションなんかでは、 画像表示のためだけに、ページ中の画像ごとにWebサーバアプリを起動して「サーバアプリがDBから読み込んでWebサーバに渡す」という処理を行うのはかなりの負荷になります。 一方、ファイルの実体をWebサーバから直接見えるようにしていれば、 画像の表示に関しては、サーバアプリを通す必要が無くなり、サーバアプリそのものの起動回数を減らすことができます。 あと、せいぜい数十キロバイト程度の画像で処理枚数がそれほど多くないならDB経由でもオーバーヘッドが問題にならないかもしれませんが、 枚数が非常に多いとか、ムービーなどで数百MBオーダーの世界になると、たとえDBに格納するサイズ的に問題なかったとしても、パフォーマンス的に実体のDB格納はありえないと思います。 ファイル名格納の欠点は、 ・ファイルの実体についてDB的な管理ができない といった点でしょうか。ファイルの管理のために、DBのシステム的なことを自前で処理する必要がでてきます。 たとえば、mixi では、画像データは別サーバに置いていて通常のDBとは別管理になっているのですが、その結果として ・ログインしていなくても(mixiの会員でなくても)記事に貼られた画像は見ることができる http://d.hatena.ne.jp/hasegawayosuke/20061017 という問題が出てます。 結局「DBを通す(というか認証システムを通す)とパフォーマンスが落ちる」という問題から、 これは「そういう仕様である」ということになっていたりします。 ちなみに、回答者さんのコメント > 昔画像ファイルを１フォルダに10万件以上も保管したシステムを扱ったことがあって、ファイル名のパターンで取り出そうとして、あまりの遅さに閉口した についてですが、確かに昔は「ファイル名は線形探索」なために、1ディレクトリのファイル数が多いと極端に遅くなるOSが普通でした。 ですが、OSにもよりますが、今では、そういった状況でもハッシュなどの採用で高速に動作するように改善されたOSが多いかと思います。
あっ、フィールドへの入力を許可しない+スクリプト入力 でも良かったかも知れない。 どちらもスクリプト実行のアカウント制限が必要ですが。
v2.0 のフォルダにある aspnet_regiis.exe で大丈夫です。 というか、2.0 +α が 3.0 で、さらに +α が 3.5 なわけで、IIS から見ればどれも 2.0 です。 ですので IIS を動かすサーバーに framework の 3.5 さえインストールしてあれば、IIS 管理画面での設定は 2.0 にしてあっても 3.5 の機能を使った asp.net アプリもちゃんと動いたかと思います。 # 「動いたかと思います」って無責任な言い方しちゃいました。 # Virtual PC 内の Windows Server 2008 に SQL Server 2008 をインストール中なもんで、動作が遅くて試せないんです。。。
No.1です。 > （Excel　→　Access）　をできるようになりました。 ・・・すみません、すっかり遅くなってしまいましたが > Excel　→　SQLサーバー　へ更新クエリをしようとすると > 「時間切れになりました」となります。 の方が未解決ということでしょうか(汗) だとしたら、・・・SQL Serverは使っていないので、そちらは ちょっとわかりかねますが、Access側で確認しておくべき点 だけ、挙げてみます。 【Access2003以前】 1)Accessで当該mdbを起動 2)メニューで「ツール(T)→オプション(O)」を選択 3)『オプション』ダイアログで『詳細』タブを選択 4)以下の設定を変更 　『既定の開くモード』　：　「共有モード(S)」 　『既定のレコード ロック』　：　「編集済みレコード(D)」 　『レコード レベルでロックして開く(O)』　：　オン 5)Okボタンをクリックしてダイアログを閉じる 6)念のためAccessを一旦終了して、動作をテスト 以上です。 ・・・参考になるかどうか・・・(汗)
SQL文を作る(書く)事自体は人間がする作業。 データベースなどに問い合わせるのは、その名のとおり「クエリー(query)」といいます。 つまり、データベースそのものがSQL文を作るわけではありません ですから、「作成」するのは人間。 作成されたSQL文をDBに問い合わせるのは「発行」「実行」「問い合わせ(クエリー)」といいます。
こういうことでしょうか http://detail.chiebukuro.yahoo.co.jp/qa/question …
ついでですので、さらに補足します・・・。 (01)～(04)を適用したのちに、サブデータシートと並べ替えの設定を OFFにしたテーブルの速度と、 SQLにADPでリンクしたテーブルの開く速度はそれほど変わりません。 以前、100万件のデータで SQL SErver2000でテストしました。 今は2005、2008ですが重たくなってるので多分遅いと思います。 また、2000などでは、表示件数が限られてきます。（設定が要る） 例えば数万件のレコードをもつテーブルの場合、 デフォルトでは全件表示されません。 Access（JETエンジン）は適切な設定をすればローカルや数十万件程度なら SQL Serverにはひけは取らないです。 ただ、（JETエンジン）にはストアドプロシージャが無いので、 それを使う処理ならやはりSQL SErverのほうが速いです。 ただ、SQL Serverを使うことで「色んな場面での手軽さ」は 確実に失うので、SQL Serverに移行する際は、 十分に試用、テストをしてからにしたほうがいいと思います。 Accessみたいに簡単ではないですから…。
データベースでは一つのトランザクションが複数の表(あるいは行)を更新するのが普通です。 何らかの原因でトランザクション処理が中断(中止)された場合、複数の表の間に矛盾が生じることは避けなければいけません。 方法は一つ、更新前ジャーナルを使ってトランザクション開始前に戻すことです。これがロールバックです。 次にデータベース処理の高速化のためにジャーナルやデータベース更新情報をメモリーにバッファリングした場合です。 バッファーが蒸発する危険性がありますので時々全書き込みをやってバッファーを空にします。これがチェックポイントです。 ことが起こればジャーナルで最新のチェックポイントまでロールバックし、そのあとトランザクション終了ジャーナルを見つけて 終了ジャーナルがあればそこまで更新後ジャーナルで前進(ロールフォワード)し、 終了ジャーナルが見つからない場合トランザクション開始ジャーナルまで更新前ジャーナルで後退(ロールバック)をします。 重ねて言いますがトランザクション開始ジャーナルの所まで戻すのがロールバック、 トランザクション終了ジャーナルのところまで進めるのがロールフォワードです。 これらのことは原子性という言葉で表せます。Wikipediaによると Atomicity トランザクションに含まれるタスクが全て実行されるか、あるいは全く実行されないことを保証する性質をいう。日本語ではアトミック性または原子性とも呼ばれる。 口座Aから口座Bに対し1万円送金する場合を考えたとき、送金操作は次の2操作によって行われる。 口座Aの残高から1万円を引く 口座Bの残高に1万円を加える Atomicityが保証されるとは、上の操作1、2が全て行われるか、あるいは全く行われないことを指す。どちらか片方だけが実行された場合、銀行全体の預金残高に矛盾が発生してしまう。
ファイル→ファイルオプション→テキスト で設定できますよ。
マスターが２つあってはいけないですね。 ２つある理由もよくわかりません。 どうしてもやるのなら1日に1回バッチでbookAをコピーしてBにすればどうでしょうか。それで足りなければ1日に2回、3回、4回。。。1時間置きに1回とか。。 そうすれば同じものが2個できます。
> Andでフィルタリングしたいのですが、たとえばこのようにすると構文エラーとなります。 提示された式に合うテキストボックスを作成して、同じ式で動作確認してみましたが、 『コード1・開始・終了のすべてに条件を指定』した場合、エラーは発生しませんでした。 (フィルタが正しく適用される) 一方、『コード1・開始・終了の少なくとも1つが空欄(Null)』の場合は、確かに構文 エラーが発生しました。 もしも、やりたい内容が「コード1のみを指定した場合は日付を無視」といったことだと したら、少し仕組みを考える必要があります。 以下、参考までに一例を提示します： (「開始」のみ指定時は「開始以降のもの」を、「終了」のみ指定時は「終了以前の 　もの」を、それぞれ抽出する形にしてみました) Private Sub フィルタ実行_Click()　　　　　'コマンドボタンを想定しました 'エラーが発生した場合の対応を宣言(→「エラー処理:」の行に飛ぶ) On Error GoTo エラー処理 　　'変数を宣言 　　Dim strFilter As String, iCode As Byte, iHead As Byte, iTail As Byte 　　'それぞれの入力状態を確認 　　iCode = IIf(IsNull(コード1), 0, 1) 　　iHead = IIf(IsNull(開始), 0, 2) 　　iTail = IIf(IsNull(終了), 0, 4) 　　 　　'入力状態に合わせてフィルタ式を作成 　　Select Case iCode + iHead + iTail 　　　　Case 0　　　'0+0+0：全て空白 　　　　　　MsgBox "先に条件を指定してください。", , "確認" 　　　　　　GoTo 終了処理 　　　　Case 1　　　'1+0+0：コード1のみ入力 　　　　　　strFilter = "コード Like '" & Me.コード1 & "'" 　　　　Case 2　　　'0+2+0：開始のみ入力 　　　　　　strFilter = "日付 >= #" & 開始 & "#" 　　　　Case 3　　　'1+2+0：コード1と開始を入力 　　　　　　strFilter = "(コード Like '" & コード1 & "') And (日付 >= #" & 開始 & "#)" 　　　　Case 4　　　'0+0+4：終了のみ入力 　　　　　　strFilter = "日付 <= #" & 終了 & "#" 　　　　Case 5　　　'1+0+4：コード1と終了を入力 　　　　　　strFilter = "(コード Like '" & コード1 & "') And (日付 <= #" & 終了 & "#)" 　　　　Case 6　　　'0+2+4：開始と終了を入力 　　　　　　strFilter = "日付 Between #" & 開始 & "# And #" & 終了 & "#" 　　　　Case 7　　　'1+2+4：全て入力 　　　　　　strFilter = "(コード Like '" & コード1 & "') And (日付 Between #" & 開始 & "# And #" & 終了 & "#)" 　　End Select 　　'フィルタを適用 　　DoCmd.ApplyFilter , strFilter 終了処理: 　　'処理を抜ける 　　Exit Sub エラー処理: 　　'エラーが発生した場合はメッセージを表示して終了処理に移動 　　MsgBox Err & "：" & Error$, , Me.Name & " フィルタ実行" 　　Resume 終了処理 End Sub ・・・以上です。 なお、現状では『コード』については『コード1』テキストボックスに「2」を指定すると 「コード=2」の完全一致検索になります。 (「2*」を指定すれば先頭一致、「*2」なら後方一致、「*2*」ならあいまい検索) もしかしたら意図的にそうされたのかもしれませんが、もし常にあいまい検索を希望 されるようでしたら、コード部分については 　　"コード Like '*" & コード1 & "*'" という構文が必要になりますので、蛇足まで。
> DoCmd.OpenReport "帳票(1)", acPreview, , strSQL OpenRecordメソッドの第4引数「WhereConditions」は、 その引数の名前の通り、Where条件式だけを指定します。 そこに「Select * ～」まで入れてしまっているために、 意図した動作になっていないものと思います。 ですので、 strSQL = "SELECT * FROM アプリデータＤＢ WHERE アプリデータＤＢ.端末名 = 'AAAA' " を strSQL = "アプリデータＤＢ.端末名 = 'AAAA' " (または　"端末名 = 'AAAA' ") に変更してみてください。
Me.Filter="A='" & Me![C] & "'" Or "B='" & Me![C] & "'" ↓以下でどうなりますか Me.Filter="A='" & Me![C] & "' Or B='" & Me![C] & "'" ※ Or は、文字列として組み込みます。
私自身は次のような感じで考えてます。 ●正規化 　　正規化では、システム全体のパフォーマンスや 　　例外処理などのことは一切考慮していない。 　　あくまで二重登録を避ける、とか、 　　１つ１つの表を「関係性のあるデータのみにまとめる」ためのもの。 　　設計の基本。 　　（基本はあくまでも基本。 　　　「いかなる場合も死守せねばならないもの」ではない。 　　　しかし、基本であるから、軽く扱っては絶対にいけない。） 　　マスタテーブル（顧客マスタ、商品マスタ、など）を 　　対象に（中心に）考えることが多いもの。 　　トランザクションテーブル（売上明細、業務日報、など）においても 　　もちろん、考慮されるべきものであるが、 　　トランザクションテーブルでは業務において正規化すると 　　パフォーマンス云々以前に、「単純に業務的に都合が悪くなること」は結構多い。 ●パフォーマンス 　　基本的に正規化しまくった場合、リレーションの本数が増える。 　　RDBでは一般的にリレーションの本数が増えれば増えるほど、 　　正しい（というかパフォーマンス重視の）SQLを書かないと 　　クエリ（ビューなど）のパフォーマンスが落ちる可能性が高くなる。 　　※もちろん、パフォーマンスの低下にはその他の理由もたくさんあります。 　　　　　　　　 ●例外処理 　　業務のことをすべてカンペキにRDBシステム上で表現することが 　　難しい場合もある（けっこうある）。 　　そのような場合も含めていろんな例外処理があると思うが、 　　例外処理は正規化の枠をはみ出すこともある。 　　これはどうしようもないことも少なくない。 ●例外処理以外に、トランザクションテーブルで正規化すると日常的に都合の悪いこと 　　日常的によくあるのが価格。 　　例えば売上明細のトランザクションテーブルでは 　　本来の意味の正規化から言えば、 　　商品IDさえ入力できるようにしてしまえば、商品の価格は入力しない。 　　でも価格は頻繁に変更されることがある。 　　このような場合に、正規化によって常にクエリ（SQL）で 　　商品価格を求める形にしてしまうと、 　　売価変更前の売上データまでもが、すべて、売価変更後の 　　価格にされてしまって、データベースが滅茶苦茶になってしまう。 　　また価格の場合、値引きなどもあり、そのときそのときで最終売価が違う。 　　このように、マスタの値が日常的に頻繁に変更されるフィールドに関しては 　　トランザクション側でも同じフィールドを持たせないとどうしようもない。 　　（厳密には、「定価」と「売価」はまったく性質が異なる、ということで 　　　最初から「違うもの」として扱う、ということなのかもしれませんが） 　　取引先の締め日なども同様。 　　「この商品は今月送ったけれども、支払いの締め日としては再来月扱いにしてほしい」 　　などの要求は販売系では日常茶飯事でおきる。 　　このような場合も、「締め日」、などのフィールドは、マスタと 　　トランザクションの両方で持っておかないとどうしようもない。 　　でないと、業務の実情に合わないデータベースになってしまう。 以上のようなことをふまえ、バランスをとって 正規化を守ったり、崩していたりします。 パフォーマンスとメンテナンス、機能の製作期限などの面を見て、 くずしても問題ない場合のみ正規化を崩してます。 Accessの場合はストアドプロシージャが無いため、他のRDBソフトよりも 正規化を崩すケースが多いかもしれません。 ケースバイケースです。 　　 　　
まず、『F_書籍名で検索』のクエリにて『抽出条件』に以下を入力。 Like "*" & [Forms]![F_書籍名で検索]![書籍検索] & "*" 次にマクロを新規作成します。 アクションに『フィルタの実行』を選択。 フィルタ名に上記のクエリ名を入力。 そして、『F_書籍名で検索』に戻り『書籍検索』のプロパティにて 『更新後処理』に新規作成したマクロを指定します。 これだと『書籍検索』に言葉を入力して『ENTER』を押すと抽出されます。 私的にはコマンドボタンはいらないと思います。
スライドできてますけど。
テーブル関連フォームの場合、テキストボックスが非連結ですと、 単なる表示だけです。当然、対応するDBフィールドが無いので、 反映されません。その「何日間」のコントロールソースが空欄では ありませんか？ このテキストボックスを自動計算で入力不可にしたい場合は次のよう に設定します。「使用可能」←「いいえ」、「編集ロック」←「はい」 また、「いつから」の更新後処理で、入力値と今日までの日数差を 「何日間」のValueとして代入します。
私も前に AND, OR を書きます。 ANDやOR が後ろにあると条件文に紛れてしまい見にくいのと、その行の条件がAND条件なのかOR条件なのかは上の行を見ないとわからないからです。 前に出ていれば、その条件が AND条件なのか OR条件なのかがはっきりわかり、後から見たときのわかりやすさがずいぶん違います。
次の２個のクエリを作ります。 (1)Q1 TRANSFORM MAX(品名) SELECT 顧客名 FROM T GROUP BY 顧客名 PIVOT 品名 IN ('ばなな','りんご','みかん') ※IN () の中は実際の品名をある分だけ並べてください。 (2)Q2 SELECT 品名,COUNT(顧客名) AS 件数 FROM (SELECT 顧客名, ばなな & Iif(りんご Is Null,'','+' & りんご) & Iif(みかん Is Null,'','+' & みかん) AS 品名 FROM Q1) GROUP BY 品名 ※顧客名から後の品名の結合はある分だけ同様に結合します。 尚、品名に空白など名前として使用できない文字が含まれる場合、 または"GROUP"のような予約語と同じ名前がある場合は[]で囲みます。
固定でやるのならテーブル作成ではなく テーブルを事前確保しておき 全レコード削除後に INSERT INTO T統合 SELECT Qユニオンクエリ.* FROM Qユニオンクエリ; としてレコード追加方式をとるのも可能かと思いますが
質問内容がいまひとつ分からないのですが、以下のように解釈して みました。 (1)一つのID（メインF側）を新規登録する。 (2)上記に関連するサブデータを登録する。（約100件） (3)次に別のID（メインF側）を新規登録する。 (4)上記に関連するサブデータを登録する。 この時、(4)を１からやるのは面倒なので、(2)で作ったデータを (4)用にコピーして、それから添削しようとしている？ いろいろな条件が絡むのですが、次のようなSQLをメインF側で新規に 登録が行われる度に実行します。 INSERT INTO xxx(ID,サブID,配送先,・・・) SELECT メインFのID,サブID, 配送先,・・・ FROM xxx WHERE ID = メインFのID - 1 xxx はサブフォームの元になるテーブルで、１個前のデータをコピー しようというものです。「メインFのID」は実際の数値が入ります。 あるいは[Forms][メインF][ID]のような記述です。
id が一意であれば、やはり意味がありません。 Aでid=1ならBでもid=1で、しかも一意なので１レコードしか該当 しません。それでいて、flagが1でもあり、0でもあると言うのは 絶対にあり得ない条件です。 もし、idが一意でない場合はflagが0と1の両方を持つという意味で 考えられる条件ではあります。しかし、そういう抽出条件ならば、 他に書きようがあり、この方法は少し違和感があります。 経験から見ると、SyBaseのエンジンはスマートなほうで、あまり 効率化を意識しなくても良いのですが、有名な○○○○では こういう書き方は速度の劣化を招きます。 SELECT A.* FROM (SELECT * FROM table WHERE flag=1) A, (SELECT id FROM table WHERE flag=0 GROUP BY id) B WHERE A.id=B.id このように条件を絞ったクエリ（レコード数が少ない）同士を結合 させる方が一般に高速です。
LANで繋がれていないのに、そのパソコンからどうやってサーバーを見るのでしょうか？ 「社内LANには繋がらないが、外（Internet）には出る事ができる」 と言う意味でしたら、宅ふぁいる便とかでよいのでは？ http://www.filesend.to/ そのままだと不安だと思うので、とりあえず mdb にパスワードを設定し、zipにする時にさらにパスワードを指定して。 いずれにしても、社内の基幹情報（かどうかはわかりませんが）を社外に出す上でのコンプライアンス/セキュリティポリシーがどうなっているかを上司なりネットワーク管理者に確認の上で行った方がよいと思います。 もっと簡便に使いたい、と言う事であれば、「コンプライアンス/セキュリティ上、データの扱いがキツくない」前提で、レンサバで WebDAV などを設定すれば、共有フォルダとして使えて楽チンだとは思いますけど。 ・Apacheの設定 ・.htaccessの設定（BASIC認証も使うなら） に習熟している必要があります。 ただし、WebDAV 越しに.mdbを開く、なんて事はできません。 （あれ？できたかな？いずれにせよ遅くて使い物にならないと思います）
例えば 　　　　男子　　女子 野球　　　12 サッカー　12　　　3 バレー　　　　　　7 テニス　　7 卓球　　　　　　　4 その他　　6　　　　2 といった表を作成して、棒グラフ（男子と女子の積み上げ、集合棒グラフ）で試してみてご希望のグラフになりませんでしょうか？
SQLite2について詳しくなく、SQLの実装状況も十分に把握していません。また、CSVファイルとSQLで操作したいというテーブルの関連、対応付けができるキーは「メールアドレス」だけなのかといったことも不明ですが、差分を求めるSQL例でいいなら、SQLite3では実装済のSQLを、いくつか提示しておきます。 (1)existsを使った例 select * from "配信リスト" as x where not exists (select 1 from "配信停止リスト" where x."メールアドレス"="メールアドレス") ; (2)inでサブクエリを使った例 select * from "配信リスト" where "メールアドレス" not in(select "メールアドレス" from "配信停止リスト") ; (3)outer joinを使った例 select * from "配信リスト" as x left join "配信停止リスト" as y on x."メールアドレス"=y."メールアドレス" where y."メールアドレス" is null ; (4)exceptを使った例 select "メールアドレス" from "配信リスト" except select "メールアドレス" from "配信停止リスト" ;
エクセルになれるため？というのがどういうことなのでしょうか？ 積分など数学の知識を応用して計算式？ VBAを駆使してプログラムを作成する？ 取り合えず、以下の方法は如何でしょうか。 A　　B　　C X　　Y 0 0.1 0.2 0.3 ・・・　 B列には、式を（ｙ＝ｘ-3なら　=A2^3といったように）入れる。 C列には、A2からA3の範囲で出来る台形の面積を求める式 =(B3+B2)*(A3-A2)/2 下へコピィ SUM関数で、面積を求めたい範囲のC列の値を合計します。 あくまでも近似値です。
質問の意図がよくわかりませんが、 シート2にあるデータをシート1に移動したい。 その時にデータの値だけではなく色の情報も移動させたい。 ということでしょうか？
画像が扱えるカード型のデータベースソフトということになると思います。 オンラインソフトではシェアウェアでよければ TCARD for Windows があります。 参考URL：http://www.dicre.com/soft/tcard.htm
やりたいことは共有されたドライブにあるPDFファイルを開きたいのですよね それになぜAccessを使うのでしょうか 行いたいPCにAccessは入っているのでしょうか？ （業務でAccessを使っていて全PCに入っているのかな？） また、開きたいPDFはどうやって探すのでしょうか？ vbsでファイルを開くウインドウを出して選択させローカルに複写してAcrbatで開くようにすれば良いと思いますが また、複写後に開くだけの2,3行のvbsを作りエクスプローラーの右クリック送るに入れてエクスプローラーからでも出来るようにすることも可能ですけど
こんにちは。 起算日が～２８日の場合は起算日のｎヵ月後と対象日を比較します。 対象日が小さくなった時点でそのｎヵ月後のｎが月数です。 小数点以下はありませんが、日付（ｄｄ）を比較すれば、未満かどうかの判定はできると思います。 ２８日以降の場合は対象日が月末の場合には対象日＋１日して上記の計算をします。（1/30～2/28を１カ月と計算するためです） これをVBAなりで組めば計算できるような・・・・ ご参考になれば
あまりにも基本的な検索テクニックですが、 「php　sqlite　centos　インストール」でググってみましたか？ あるいはそのエラーメッセージそのものをググってみましたか？
> ほかに何か問題があるのでしょうか。 何をやりたい式なのか、意味がよくわかりませんが。 > Me.Fliter = "[金額] Between [Forms]![F_金額で検索]![金額1] And [Forms]![F_金額で検索]![金額2] Is Null" とりあえずヤマカンで [金額] Between [金額1] And Nz([金額2], 2147483647) とか。
まず、個人データテーブルと問診票テーブルを「氏名」でリレーションします。 レイアウトで表示するレコードは「個人データテーブル」にします。 ヘッダの部分に、個人データテーブルのフィールドのうち表示させたいもの（「氏名」など）を並べます。 次に、ボディ部に、ポータルを作成します。横並びが希望とのことでしたがとりあえず縦で作ってみてください。 ・関連テーブル：問診票テーブル ・ポータルレコードのソート：昇順（ソートを指定：日付） ・ポータルレコードの削除を許可する ・最初の行　１　行数　10 ・垂直スクロールバー　にチェック これで作成してください。 ポータルに配置するフィールドは、問診票テーブルのフィールドです。 （日付、 そうすると、該当する個人データの問診レコードが日付の昇順で縦に複数並んで表示されるはずです。 （もしそうならなければ、リレーションや関連テーブルなどを見直してください） ここまでができたら、今度はさっきのポータルの行数を１にします。 次に、そのポータルをコピーして右側の適当な場所にペーストします。 ペーストしたほうのポータルを右クリックして、ポータル設定の「最初の行」を2にします。 あとは同じように、右側にペーストして「最初の行」を3,…としていけば横並びのポータルになります。
＞データベースからデータを読み込むのとでは、 ＞どちらがどれくらい早いのでしょうか？ 条件によって異なりますので、正直わかりませんね。（苦笑） 当方、SE暦はかなり長いのですが、前提条件によって結果はいくらでも変わります。 ・実行環境(CPU・メモリ・ディスク) ・使用するデータベースの種類 ・そのデータベースが、専門家の手によって最適化されているか ・読み込むデータの件数とレコード長 くらいがわからないと、何とも言えませんね。 また、ＳＥを長くやっていれば、テストデータを使って性能評価をする機会は何度もあるかと思いますので、自分で実際に性能評価をして体験してみるのが、スキルを伸ばす観点からも有益でしょう。
こちらが参考になるでしょう。 http://www.accessclub.jp/bbs3/0346/superbeg10420 …
チェックボックスの数だけフィールドを作ってしまえばいいと思います。 それでは具合が悪いという場合は、正規化すれば良いのではないでしょうか。
＃１です。 acSpreadsheetTypeExcel12　としたのは、サイズが小さい方がいいのかな程度のものです。 テーブル構成「ID」「F1」～「F10」 IDはオートナンバー、F1～F10はテキスト型、サイズ100で内容は「あいうえおかきくけこ」の10文字。 レコード数は200000レコード。 acSpreadsheetTypeExcel12 で出力した xlsb ファイルは、1462272バイト。 acSpreadsheetTypeExcel12Xml で出力した xlsx ファイルは、8974336バイトでした。 どちらでも 65535行超え出来るようですので、ご自身で判断してください。 （出力時の処理時間は違いがあるようですが） （ちょっと書き変えればいいので、どちらでも検証できると思います） DexMachina様、ありがとうございました。
やはり削除されましたね。 サンプルで説明しないと面倒なこともあるのに・・・ 今後の質問はこちらにした方がいいですよ。↓↓ 参考URL：http://www.russ.jp/stepbbs/step.cgi?
直感で考えると、 DBは使わずに、テキストファイルとしてVBで処理するほうが早いんじゃないかな？ 何の根拠もないけど。（というか、根拠を出すためには双方やってみないといけない。）
エクセルを持っていないので推測になりますが エクセル側の書式を2009/06/01形式にしてFMの日付フィールドにインポート してもそうなるのですか？
グローバルフィールドとのリレーションをすると良いのでは？ 例えば グローバルフィールドA　＝　フィールド(都道府県) グローバルフィールドB　以上　フィールド（年齢） グローバルフィールドC　以下　フィールド（年齢） こんなリレーションを作ると グローバルフィールドを変えるだけで ポータルの条件が変更されて条件に合うポータルが表示できます okigaru.info 参考URL：http://www.okigaru.info/
Dim RS As New ADODB.Recordset ↓　以下としたらどうなりますか Dim RS As DAO.Recordset ※ VBE での参照設定は確認してください。
できますよ。 以下はその例です。コントロール名は"WB"とし、フォーム内の イベント（ボタンのクリック等）のプロシージャです。 Dim C, D, B, T As String '==HTML組み立て== T = "<HTML><BODY>ABC" T = T & "</BODY></HTML>" '==オブジェクトの取得== Set C = Me.WB Set D = C.Document If D Is Nothing Then 　　C.Navigate "about:blank" 　　Do 　　　　DoEvents 　　　　Set D = C.Document 　　Loop While D Is Nothing End If Set B = D.Body '★ここでHTML仕込む B.InnerHTML = T
これでもいけるかな。 select userid,username from user where userid in (SELECT p1.userid FROM purchase as p1 where exists ( select 1 from purchase as p2 where p1.purchasedate + 1 = p2.purchasedate ))
現在手持ちのテーブルから「ランダムな３件を抽出」するＳＱＬが下記です。 SELECT TOP 3 Test.uid, Rnd([uid]) AS xx FROM Test ORDER BY Rnd([uid]); 乱数を生成して、毎回違うものを抽出するようにしています。「uid」がこのテーブルのプライマリーキーなのですが、ともかくこのテーブルのフィールドをRnd関数のパラメーターに与えるのがポイントです。 レコードごとに乱数を生成するので、レコード数が多い場合には何らかの工夫が必要かもしれません。
http://www.accessclub.jp/bbs2/wforum.cgi?mode=al … http://detail.chiebukuro.yahoo.co.jp/qa/question … サイトによりマルチを禁止しているところもあります。
クエリにひとつ計算のフィールドを作り、こんな風な数式を書いておきます。 今週:Format([日付],"ww")=Format(Date(),"ww") で抽出条件は True です。 この ww で、Format()関数は、その日付が、その年の最初から数えて第何週目にあたるのかを返します。 週の変わり目は、土曜と日曜の間でいいですか？ 週の始まりが月曜日なら、 今週:Format([日付],"ww",2)=Format(Date(),"ww",2) です。
こちらも参考に http://itpro.nikkeibp.co.jp/members/SI/oss/20031 …
スタッフテーブルとは別のテーブルを作ります。役職履歴テーブルというようなものです。 このテーブルは、 スタッフAさん、1998年、アシスタント スタッフAさん、2000年、チームサブリーダー スタッフAさん、2005年、チームリーダー という感じになります。
> 現在起きている問題というのは、 > mdbファイルが肥大化して、さらに常時誰かが利用しているので > そのmdbを最適化するタイミングがなかなか無いということ > > 又、mdbからのリンクテーブルで設計しているので、 > だんだんと処理速度が遅くなっていることです この場合は明らかに、サーバー系の DB に移行したほうがよいですね。 ネットワーク越しに MDB ファイルを利用するときは、ファイル全体が 読み込まれます。誤解されがちですが、対象テーブルだけが読み込まれる わけではありません。単なるファイルコピーと同じです。 この辺、興味があるようでしたら詳しくは下記記事を参照してみてください。 パケットで知るデータベース http://www.int21.co.jp/pcdn/vb/noriolib/vbmag/99 … 記事自体は古いですが、JET DB に関しては基本的に変わっていないはずです。 ただ逆に言えば、ふつうにファイルをコピーして（たとえばデスクトップに） 貼り付けたときにかかる時間をはるかに超えて待たされるようでしたら、 何か別のトラブルが発生している可能性が濃厚です。一度、比較してみては。 もしふつうにファイルコピーしてそれくらいかかるなら、どうしようも ありません。 MS SQL Server なり Oracle なりなんなりに移行しましょう。導入手順は、 検索すれば解説ページが公式・非公式ともに山のようにヒットしますので、 とにかくやってみて、詰まったところで具体的に質問を挙げれば具体的な 回答が付くと思います。 最適化に関しては、ずっと誰か彼かが開き続けていたらどうしようも ありませんが、そうでなければ [閉じるときに最適化する] オプションを オンにしておくことで多少改善されませんか。 参考URL：http://www.int21.co.jp/pcdn/vb/noriolib/vbmag/99 …
カレンダー コントロールの値をどうやってテキスト ボックスに転記してるのか書く気にはなれませんかね。 ご自分でも方法に問題があるんじゃないかと感じているんですから。
>Ａ，Ｂのテーブルで品番ごとに集計した結果から、数量が不一致のものを取り出す方法がわかりません。 この質問と、お望みの結果は異なりますよね？ >あ００１/　4（←Ａ－Ｂ＝4） >う０００/　10 集計結果を取り出すのではく　集計した差分を取り出そうとしていますね。 Ａ－Ｂ＝4　とされているので であれば、う０００は　Ａ－Ｂ＝-10ではないでしょうか？ あ００１/　4 う０００/　-10 差を取るのであれば、どちらか基準側が必要ですので Ａ－Ｂで差が0以外を抽出すると SQLビュー SELECT 品番, 差分 from ( SELECT 品番, Sum(数量) AS 差分 FROM (SELECT テーブルA.品番, テーブルA.数量 FROM テーブルA union all SELECT テーブルB.品番, テーブルB.数量 * -1 FROM テーブルB) GROUP BY 品番 ) where 差分 <> 0 order by 品番 2007での結果 品番　差分 あ001　4 う000　-10 結果をこちらで読み替えました 意味が違っていたら、読み捨ててください。 また、SQｌビューに貼り付けて実行できるように　1SQLで書きましたが 個別にクエリーにされても　問題ありません。
1.繰り返しで作っている現在のテーブルで、「全レコードを表示」にします。 2.ファイルメニューから「レコードのインポート」を選び、相手ファイルは自分自身にします。 3.インポート設定順窓でインポート先は「新規テーブル」を選び、新規レコードとして追加を指定。 4.インポートオプションで繰り返しフィールドは「複数のレコードに分ける」を指定してインポート。 　これで1繰り返し行が1レコードに変換されます。このテーブルの名前を仮に「リスト」としてリスト 　表示にしておきます。元々繰り返し設定だったフィールドは繰り返しのままになっているので、全て 　普通のフィールド（繰り返し数1）に変更しておきます。 5.データペース管理のリレーション設定で、元テーブルの相手フィールドと、リストテーブルの相手フィ 　ールドを照合フィールドに設定し、リレーション編集で、リストテーブル側の新規レコードの作成を許 　可にします。 6.元々のテーブルのレイアウトモードに戻って、繰り返しフィールドを削除して今作ったリレーションの 　ポータルを配置し、その中にリストテーブルの関連フィールドである::日付、::内容、::訪問者などのフ 　ィールドを置きます。 Aさんの顧客レコードのポータルにはAさんの訪問履歴だけが表示されます。 コピーしたファイルで練習してください。
質問しようとしている状況が良く判りません。 通常、メインフォーム/サブフォームは、例えば「大分類/小分類」みたいなものがあり、メインフォームで大分類項目を選択すると、サブフォームにその大分類に属する小分類項目が一覧表示されるようなものを考えます。この場合、IDを手入力するような状況は考えられず、小分類項目を追加する場合には、該当するフィールドに、大分類のIDが自動的にセットされます。 ご質問の状況は違うようなので、具体例を交え、改めて状況を説明してください。
TransferSpreadsheetの代わりに、OutPutToを使用してみてください。 なお、下記のコードのみですと、同名ファイルが既にあった場合、確認メッセージなしで 上書きされるのでご注意下さい(汗) ・・・それと、OutPutToは古いバージョンから引き継がれているためか、環境によっては 約16000行を超えるとその部分が出力されない場合がありますので、これもご注意下さい(汗) Private Sub コマンド62_Click() On Error GoTo エラー処理 　Dim stDocName As String, stFilePath As String 　stDocName = "集計" 　stFilePath = "C:\Documents and Settings\user\デスクトップ\ABC\data2.xls" 　DoCmd.OutputTo acOutputQuery, stDocName, "MicrosoftExcelBiff8(*.xls)", stFilePath, True 終了処理: 　Exit Sub エラー処理: 　MsgBox Err & "：" & Error$, , Me.Name & " コマンド62・Click" 　Resume 終了処理 End Sub ・「acOutputQuery」は、「クエリの出力」の指定です。 ・「MicrosoftExcelBiff8(*.xls)」は、Excelフォーマットでの出力の指定です。 ・OutPutToでは拡張子なしだと拡張子なしのまま出力されるため、ファイルのパスに 　「.xls」を追加しました。 ・5番目の引数の「True」は、出力したファイルを自動で起動するかどうかの指定です。 　(起動させない場合は「False」を指定) なお、「MicrosoftExcelBiff8(*.xls)」なんて覚えていられない、と思う場合は、 『マクロ』であれば選択肢がコンボボックスからの選択制になっているので、 一旦そちらで目的の動作を行うものを作成してしまい、それをメニューから 「ツール(T)→マクロ(M)→マクロをVisual Basicに変換(B)」と選択してやれば、 マクロで指定した引数も含めて自動でVBAのコードに変換してくれるので、 試してみてください。 ※Accessの『マクロ』は、『モジュール』(≒VBA)とは別物です。 　(データベースウィンドウ(テーブルやクエリの一覧が表示される画面)のところに 　ある『マクロ』を選択して、新規マクロを作成します) 　(上記メニューで変換する際は、予めそのマクロを選択(反転表示)状態に 　　しておく必要があります) ※「OutPutTo」に対応するマクロの「アクション」は、「出力」になります。 　(『アクション』欄のコンボボックスの一番下の方にあります) 以下は、マクロのヘルプですが、引数は同じなので参考になるかと思います： http://office.microsoft.com/ja-jp/access/HA01226 …
select into where で古いデータだけのテーブルを作成し、delete where で元のテーブルから古いデータを削除する。
質問者さんが礼に挙げられている後者のページでは「MeCab」が使われていますが、MeCab は日本でもトップレベルの「形態素解析エンジン」です。 ですが、質問者さんが求めるものは「形態素解析」ではなく「意味解析」のレベルになります。 「行った演技」でも、前後の文脈では「いったえんぎ」の方が正しい場合もあるでしょうし、 逆に「行った場所」でも、前後の文脈によっては、「おこなった場所」の方が正しい場合もあるでしょう。 そういった文脈を解析する「意味解析」が出来るものでないとお望みの結果が得られませんが、 意味解析技術では、未だに満足できるレベルの成果は得られていません。 ちなみに、MeCabの場合は、複数の「候補」を出力することができて、 それを使えば > % echo '行った場所' | mecab -O yomi -N 2 > イッタバショ > オコナッタバショ と、両方の読みを出すことは可能です。
Access2003でLikeを使うとき % ではなく * で任意指定かな。 東京都%　⇒　東京都* としてみてください。
＃１です。 ＞このプログラムではパラメータに入力したDATAに対し、過去3年間出ますが単年度、あるいは複数年度出す為には、どうしらいいですか？ 元々どのようなシート構成に対して、どんな結果をもたらすように作られているのかが 不明なので、追加質問の件は私にはわかりません。 もし過去に質問をしていてこのコードが得られたのであれば、そのリンクを貼ってみると 新しい回答がつくかも知れません。
直接の回答は簡単ですが、 今後のために勉強してください。 http://www.google.co.jp/search?hl=ja&q=access+sq …
＃１です。補足を読んでも今一つ良く判らないことと、問題を単純化するために、以下のようなテーブル設計で試してみました テーブル名：A取引先テーブル フィールド：取引先ID,取引先名,キャッシュバック率,キャッシュバック遅延月数 テーブル名：A請求テーブル フィールド:請求ID,請求金額,請求日,取引先ID 以下のようなＳＱＬ文（クエリ）で、６月１日請求の 請求日、取引先、請求金額、キャッシュバック金額 が表示されます。 SELECT A請求テーブル.請求日, A取引先テーブル.取引先名, A請求テーブル.請求金額, [A請求テーブル_1].[請求金額]*[A取引先テーブル].[キャッシュバック率] AS キャッシュバック金額 FROM (A取引先テーブル INNER JOIN A請求テーブル ON A取引先テーブル.取引先ID = A請求テーブル.取引先ID) LEFT JOIN A請求テーブル AS A請求テーブル_1 ON A取引先テーブル.取引先ID = A請求テーブル_1.取引先ID WHERE (((A請求テーブル.請求日)=#6/1/2009#) AND ((A請求テーブル_1.請求日)=DateAdd("m",-[A取引先テーブル].[キャッシュバック遅延月数],[A請求テーブル].[請求日]))); ※留意点 ０．将来の拡張も含めキャッシュバックの遅れが2ヶ月以上も扱えるようにしています。 １．請求は一社から月一回しか来ないものとしています。それ以上ある時は集計クエリーの利用などが必要。 ２．請求日は一日（ついたち）に固定しています ３．キャッシュバック金額に少数以下がありますが、そちらの規則に従い、切り捨て等の処理が必要です。
>TBLrs.FindFirst"AAA='"&Me.COM_A&"'"And"BBB='"& Me.COM_B & "'" 恐らく『「And」は文字列として渡す必要があるから』と考えられて 「"And"」という形で挿入されたのだろうと思います。 確かにそう(=文字列として渡す必要がある)なのですが、そのためには、その前の 「AAA='」という文字列と、「Me.COM_B」というコンボボックスへの参照式とを 結合させた場合と同様に、「&」を使ってやる必要があります。 なお、文字列が連続する場合は、「"～"& "～"」とする代わりに、文字列全体を 一組の「""」で囲って「"～～"」とすることもできます。 ですので、上記の部分を 　TBLrs.FindFirst "AAA='" & Me.COM_A & "'" & " And " & "BBB='" & Me.COM_B & "'" とするか、または連続する文字列をひとつにまとめて 　TBLrs.FindFirst "AAA='" & Me.COM_A & "' And BBB='" & Me.COM_B & "'" と修正すれば、正しく動作するかと思います。 (「And」の前後には、ともに半角スペースが必要なので注意)
Ｒ÷ＳはＳの要素を全て含む、Ｓに含まれない属性の集合ですから、fatherだけを抜き出すのではなく、 father/motherの組み合わせで見なくてはいけません。 Martin/Melanieの組み合わせはMaria, Sabineの両方の要素持っているから商に含まれますが、 Hans/Helga, Hans/Ursulaの組み合わせはいずれもMaria/Sabineの両方を要素として持ちません。 したがって商ではないです。 逆の見方をすると、Ｒ÷Ｓ＝Ｔの場合、Ｔ×Ｓ＝Ｒが成り立ちますから、ＴとＳの直積を求めてみます。 Hans/Helgaが商に含まれると、直積のHans/Helga/Sabine/2というＲには存在しなかったものが生じます。 したがって商ではないです。
DoCmd.TransferSpreadsheet acExport, , クエリ名, 出力先ファイル名
親子、他の親との関係が、最初からギチギチに決まっていて、その関連付けでの操作に特化しているかどうかです。 事前に設計された親→子、親→子→別の親などの参照は効率的に行えますが、その一方で、事前の設計になかった別の親や別の子を、新たに追加したり、関連の変更といったケースでは、設計変更を含めた多くの作業が発生します。 DBMSでの実装では、階層DBMSやネットワーク型DBMSでは、親子間のポインタをレコード中に持たせたり、親子を物理的に近傍に格納し、1回のI/Oでファミリー全体を得られたりするといったことで、高性能を出せるようにしています。 一方で、親子などの関連付けの変更などでは、それぞれでポインタを持っているといったことから、RDBMSのように表の追加、参照制約の定義、インデクスの定義といったようには簡単にはできません。 また、事前に定義された親子、子と親の関連以外を連携させた操作は、DMLでは行えず、アプリ側での対処になります。 リレーショナル型での参照制約（外部キー制約）は、RDBに階層型やネットワーク型の特長を生かしたものです。
「静かな革命へ」「教育テレビの誕生」でぐぐれば一発。
Accessは仕様制限があるのでやめたほうがいいと思います。 http://hp.vector.co.jp/authors/VA014071/tips/spe … 拡張性を考えると VB.Net+Oracleがいいと思います。 あるいは SQL Serverでは2000だとセキュリティに適してないと聞きます。 なのでSQL Serverだと2005以降をお勧めします。
入力欄がテキストボックスならば プロパティ/書式/上余白 に数値を入れると位置が変わります。フォントサイズを大きくして、中央に表示されるようにした方が見やすいかもしれません。あるいは両者の併用。
質問が曖昧で良く判りません。 １．（例えば）苦情処理内容を一件ごとフォームで表示し、これに関連する写真を表示したいのでしょうか？ ２．上記前提で、一物件に複数の写真があり、一覧表示したいのでしょうか？それとも１枚だけ？
アクセスの場合、データやクエリーの修正をしたとき、そのままでは計算の結果にデータ修正の効果が現われず、そこでいったんすべてを保存して、アクセスを再起動したら、よくなったと言う経験があります。参考までに。
Accessなら IIf(条件, 真の場合, 偽の場合) が使えるよ IIf(Ｔ取引先マスター.値引CD=2 and Ｔ請求データ.請求金額>=500000, ROUND([請求金額]*0.01), IIf(Ｔ取引先マスター.値引CD=3 and Ｔ請求データ.請求金額>=500000, ROUND([請求金額]*0.0036), 0)) AS 値引
100を1100 101を1101 で良いのですか? であれば A1　に　100　と入って下記の式をB1に入れれば　 B1　は　1100　となります。 = Text(A1, "1000") 他のセルは式をコピーして下さい。
質問したのに見てないみたいですね。 あ　毎月の支払額はPMT関数で出ます。 い　1回目の金利は元金×年利÷12で出ます。 う　1回目の元金分返済額は毎月の支払額-1回目の金利で出ます。 え　1回目の元金残高は「元金-う」ですから、これをグローバルフィールドに入れて 　　フィールド設定で2回目の元金残とすればいいはず。
データマイニングツールはベンダーや研究者によって定義が変わると思いますよ。 あるツールはおっしゃるようにモジュールとインターフェースといった分類で販売されてますし、オールインワンで売ってるところもあります。なので明確な定義はないのではないかと。あるとしたら学会とか そういうところの先生に聞いたほうがいいです。 構成と分類はベンダーによってマチマチです。領域についてもリスク与信からマーケティングまでいろいろです。しかも銀行なのか、イーコマースなのか、クレジットカードなのかいろいろです。 「Excel」のみを例に取ります。なお、人によりけりなので 参考程度で。多分、いろいろでしょう。 構成： シート、各種アドオンモジュール、グラフ機能、入力支援などなど 分類： スタンドアロンの単一タスク（複数起動も可能なので判断はできませんね。領域は「営業」領域での集計から「病院」の患者数の集計などなど） 検索サイトでSAS 及び　SPSSなどをキーワードで検索してみてください。違いがわかります。どちらかといえばモジュールベースではなくプロダクトベースでの販売が多いので、調べるときに注意してください。
直接の回答ではありませんが・・・。 フリーのモデル・データを配布しているところは海外のサイトにいくつかあったのですが、久しぶりに見てみたところ、ほとんど有料になっていました。また、無料のものはごくちゃちな初心者が作ったようなものしかありません。 樹木は、自分で描いた絵や写真を切り抜き、板状のポリゴンにアルファチャンネルのマスクで不要な部分を透明にし、これを９０度クロスさせたオブジェクトで、案外リアルに見えるものです。（アップにするわけにはいきませんが）。 あるいは一枚だけのポリゴンでもオブジェクトをカメラに正対させる方法があれば（手動でもいいですが）ケースによっては自然に見せることができると思います。
テーブルを単にデータシートビューで開いてもコードの昇順に表示 されるとは限りません。「テーブルを作る時のSELECT INTOでORDER BY したじゃないか」というのは人間の都合で、ORDER BY されたのは元に なるテーブルが一時的に並べ替えられただけです。 データシートビューにはテーブル毎に独自の書式（列幅、並び順）が 記録されます。掲題の例では品コード、明細番号の２列を選択し、 メニューバーから「レコード→並べ替え→昇順」と設定します。 ビューを閉じる時には変更を記録するかどうか問合せがあります。 但し、SELECT INTO を再実行すると、テーブルは削除→作成となる ため、同じテーブル名でも表示形式はリセットされます。 希望の並び順になるようなクエリを作成し、そちらを開く方が話が 簡単です。
oRec_Q_W_RegWData.addnew 　　oRec_Q_W_RegWData.Fields("Hantei") = 　oRec_Q_W_Reg2Data.Fields("Hantei") 　　oRec_Q_W_Reg2Data.Movenext loop ↓以下のように Update を入れてはどうでしょう oRec_Q_W_RegWData.addnew 　　oRec_Q_W_RegWData.Fields("Hantei") = 　oRec_Q_W_Reg2Data.Fields("Hantei") 　　oRec_Q_W_Reg2Data.Movenext oRec_Q_W_RegWData.Update loop
フォームの「日」の更新後処理に以下のコードを記述します。 Dim V V = Me.日.DefaultValue If Not IsNull(V) Then 　　V = CDtae(V) 　　Me.日.DefaultValue = Format(V, "\#M/D\#") End If
> 技術力：Accessの初歩段階です。提供されているマクロを > いじっている程度。プログラミングをAccessに書いたことなし。 とあるのと、 > Accessのマクロ-ワークシートの変換で、指定したクエリは同一ファイルに > 複数シートとして出力できることまではできています。 とのことから、恐らく、マクロの『アクション』列に、対象となるクエリの数だけ、 「ワークシート変換」が並んでいる状態ではないかと思います。 以下、この前提で、現在のマクロへの加筆修正の仕方を説明します。 (恐らく、現状でできる最も簡単な方法かと思いますので) 1)当該マクロをデザインビューで開く 2)マクロの『条件』列が表示されていない場合は、Accessのメニューで 　「表示(V)→条件(C)」を選択して、『条件』列を表示 3)「ワークシート変換」アクションで指定している『テーブル名』欄のクエリ 　の名前を「クエリ1」とした場合、その行の『条件』欄(＝「ワークシート 　変換」の左隣)に、以下の式を入力： 　　DCount("*","クエリ1")>0 4)以下、「ワークシート変換」が記載されている全ての行の『条件』欄に、 　同様の式を入力 5)マクロを保存して閉じる ・・・以上です。 なお、『ワークシート変換』の『テーブル名』で「=Forms!フォーム1!テキスト0」 といった形でフォームのテキストボックスを参照している場合は、『条件』欄の 式を以下のようにして下さい： 　　DCount("*",Forms!フォーム1!テキスト0) ※上では「,」(カンマ)の後のクエリ名を「"」(ダブルクォーテーション)で囲んで 　 いるのに対し、下の場合はその囲みがないので注意してください。
一例としてコメントしますが。。 取引テーブルと商品マスタがあり、取引テーブルの商品コードは商品マスタの商品コードに対して外部参照制約がかかっています。 すでに取引テーブルにはその商品の取引が記録されています。 商品マスタの見直しにより、商品コード３桁のものを４桁に変更しなくてはいけなくなりました(101は1101)。 UPDATE 商品 SET 商品コード=商品コード+1000 WHERE 商品コード<=999; UPDATE 取引 SET 商品コード=商品コード+1000 WHERE 商品コード<=999; 外部参照制約がかかっているため、どちらを先に実行してもエラーになります。 この場合の対応方法は大別して３種類 1) 一旦外部制約を無効にする 　ALTER TABLE 取引 DISABLE CONSTRAINT 外部制約1; 　UPDATE 商品 SET 商品コード=商品コード+1000 WHERE 商品コード<=999; 　UPDATE 取引 SET 商品コード=商品コード+1000 WHERE 商品コード<=999; 　COMMIT; 　ALTER TABLE 取引 ENABLE CONSTRAINT 外部制約1; 2) 新しい商品コードを先に追加してしまう 　INSERT INTO 商品 SELECT 商品コード+1000,商品名 FROM 商品 WHERE 商品コード<=999; 　UPDATE 取引 SET 商品コード=商品コード+1000 WHERE 商品コード<=999; 　DELETE FROM 商品 WHERE 商品コード<=999; 　COMMIT; 3) もし外部参照制約に遅延制約がかかっていれば、 　SET CONSTRAINTS 外部制約1 DEFERRED; 　UPDATE 商品 SET 商品コード=商品コード+1000 WHERE 商品コード<=999; 　UPDATE 取引 SET 商品コード=商品コード+1000 WHERE 商品コード<=999; 　COMMIT; 他には取引データを取引テーブルに取り込んだ場合、存在しない商品コードであれば遡及して商品マスタにデータを追加する手順も認める場合（トリガ使用）など。一般的にはイレギュラーケースでも本来の更新手順で更新処理をしたい場合に利用できますが、他に方法がある場合遅延制約は使わなくてもよいと思います。 遅延制約をサポートしていないDBMSの場合、たとえばSQL Serverでは外部制約の連鎖更新がサポートされており、 　UPDATE 商品 SET 商品コード=商品コード+1000 WHERE 商品コード<=999; により、商品マスタの商品コードも連鎖的に変更されます。
ODBC 使えばできると思います。 http://www.filemaker.co.jp/support/technologies/ … http://www.filemaker.co.jp/help/html/odbc.18.2.h … Excel へのインポートであれば、ファイルメーカー側の機能で Excel 形式や CSV 形式でエクスポート機能がありませんか？
どーしようもできないです メルアド忘れたんだったら(^_^;
AutoFill と呼ばれる機能ですが、リンク先によると、あまりにも不評だったため 2007 で機能自体が削除されたとのことです。 参考URL：http://accessjunkie.com/faq_27.aspx
データの中にもスペースがある可能性があるなら、一番手っとり早い方法はやはり「CSVにすること」ではないでしょうか。 1) メモ帳で開く 2) 編集－置換で、「お客様ＩＤ」→「,お客様ＩＤ,」、「お客様名前」→「,お客様名前,」という風に項目をカンマで挟むように置き換える 3) 保存してCSVとして開く 当面何度もそれを行わなければならないならば、この変換処理はExcelVBAでやっても数行の処理です。 Sub ProcSep() Dim sDataline As String Close Open "C:\ファイル.csv" For Input As #1 Open "C:\ファイル2.csv" For Output As #2 Do Until EOF(1) Line Input #1, sDataline sDataline = Replace(sDataline, "お客様ＩＤ", ",お客様ＩＤ,") sDataline = Replace(sDataline, "お客様名前", ",お客様名前,") sDataline = Replace(sDataline, "お客様住所", ",お客様住所,") sDataline = Replace(sDataline, "お客様電話", ",お客様電話,") sDataline = Replace(sDataline, "ご注文内容", ",ご注文内容,") Print #2, sDataline Loop Close End Sub
こんにちは。 参考になりそうなサイトを見つけましたので、貼っておきます。 http://www.mahoutsukaino.com/ac/access2007/02_db … mdbを作る際か、保存する際に、2000互換の指定をする必要があるようですが、それでうまく行けば良いのですが…。 では。
> 1以上にしたい場合はどのように書けば良いのでしょうか。 > （0以外を指定したいと思います） 「コード」フィールドのデータ型が、「数値型」か「テキスト型」かによって、 式が若干変わります。 (なお、上記の質問文から、負の数および小数のコードはないと判断) 【数値型の場合】 　DoCmd.ApplyFilter , "コード > 0" または 　DoCmd.ApplyFilter , "コード >= 1" 【テキスト型の場合】 　DoCmd.ApplyFilter , "CLng(コード) > 0" または 　DoCmd.ApplyFilter , "CLng(コード) >= 1" なお、万が一Null(空白)のデータがある場合は、それを表示しないなら 　DoCmd.ApplyFilter , "CLng(Nz(コード, 0)) > 0" 表示するなら 　DoCmd.ApplyFilter , "CLng(Nz(コード, 1)) > 0" とします。 (CLng関数は指定したデータの型を長整数型に、 　Nz関数は1番目に指定したデータ(上では「コード」)を、2番目に指定 　したデータ(上では「0」や「1」)に、それぞれ変換する関数です) ※データ型がテキスト型で、数値(長整数型)に変換できないデータが 　 1件でもあった場合はエラーとなり、上記の式では検索できません。
サブフォームコントロール名とサブフォームの関係について http://oshiete1.goo.ne.jp/qa4752536.html の＃３を参照してみてください。 サブフォームコントロール名を使わない方法もありますが、わかりますでしょうか。 一応以下に1例を書いておきます。 (1)準備 標準モジュール先頭にグローバル変数を宣言 Public objFSUB As Object (2)サブフォーム起動時に自身を変数に代入＆終了時に開放 サブフォームの「読み込み時」イベントで代入 Private Sub Form_Load() 　　Set objFSUB = Me End Sub サブフォームの「閉じる時」イベントで解放 Private Sub Form_Close() 　　Set objFSUB = Nothing End Sub (3)objFSUB を使用した設定等 objFSUB.Filter = "・・・・" objFSUB.FilterOn = True など、サブフォームに設定したいことは objFSUB を使用して設定/参照できます。 書き方は、サブフォーム内で、Me.xxxx と書くように、Me の部分を objFSUB に書き換えるだけです。 やりたい操作、記述をサブフォーム側で書いて、それをコピー、貼り付けし、 Me 部分を objFSUB に書き換えます。 ※この方法はサブフォームに限らず、フォーム間での設定/参照にも使用できます。
セルの中に =COS(2*SQRT(3)*PI()*A2) と入力します。 上記の式で、 π　：　PI() √　：　SQRT() COS ：　COS() SIN ：　SIN（） となります。 エクセルの関数は以下のサイトに載っていますので、調べてみてください。 エクセル基本講座（エクセル関数一覧表） http://www.eurus.dti.ne.jp/~yoneyama/Excel/kansu …
勝手に作成されるんじゃなくて、ソース内のディレクトリに.svnというファイルそのものが含まれているんじゃないでしょうか？ もし、FTPやSCPなどでサーバーにアップされたものをDLしたのであれば、アップした人が知識不足で、.svnファイルも同時にアップされているたけ。 この場合は、貴方側がどうこうできる問題ではない。 サーバーにアップした人に言うしかない。 .svnが生成されるのは、subversionからコミットしたりチェックアウトしたりする場合のみです。
たとえば項目名が「zennen%」なら、項目名をすべてダブルクォーテーション で括ってください（"zennen%"のように)。 個人的には多少冗長でも「percnet」にするほうを選びますが。
時間があったので、雰囲気作ってみました。 なるべく元の変数名を使うようにしていますが、細かい判別部分は分かってません。 （SQLの文字列がどこで使われているのかもわからなかったので） 雰囲気で見てください。雰囲気で。（検証とかしてません） 一時テーブルへ取り込みUpdate操作後、本テーブルへ追加する方法として 一時テーブルは本テーブルと同じ構造で既に存在していると想定 （DoCmd.TransferText の時にテーブルが新規に作られる？） ファイル名にドット（ピリオド）が複数あった場合用に InStrRev に変更 Const FolderPath = "\\St1\第２業務部\$運用\TESTkanno" Const ITName = "T_Mas" Const TmpITName = "Tmp_Mas"　　' ★ T_Mas 構造と同じ取り込み用一時テーブル名 Const teigi = "ＲＧＢ定義" Private Sub Form_Load() 　　Dim oFSO As Object 　　Dim oFile As Object 　　Dim sName As String 　　Dim sTmp As String 　　sTmp = "" 　　Set oFSO = CreateObject("Scripting.FileSystemObject") 　　For Each oFile In oFSO.GetFolder(FolderPath).files 　　　　sName = oFile.Name 　　　　If (Right(sName, Len(sName) - InStrRev(sName, ".")) = "csv") Then 　　　　　　sTmp = sTmp & ";" & Left(sName, InStrRev(sName, ".") - 1) 　　　　End If 　　Next 　　If (Len(sTmp) > 0) Then 　　　　sTmp = Mid(sTmp, 2) 　　End If 　　Me.lst_01.RowSource = sTmp 　　Set oFSO = Nothing End Sub Private Sub Cmd_01_Click() 　　Dim LsName As String 　　Dim TName As String 　　Dim Name1 As String 　　Dim Name2 As String 　　Dim ret As Variant 　　Dim sSql As String 　　Dim iTmp As Long 　　For Each iTmp In Me.lst_01.ItemsSelected 　　　　TName = Me.lst_01.ItemData(iTmp) 　　　　LsName = FolderPath & "\" & TName & ".csv" '　　　　一時テーブルへまずは取り込み 　　　　CurrentProject.Connection.Execute "DELETE * FROM " & TmpITName 　　　　DoCmd.TransferText acImportDelim, teigi, TmpITName, LsName, True 　　　　Name1 = TName & ".csv" 　　　　Name2 = Left(TName, Len(TName) - 5) 　　　　ret = MsgBox(Name1 & "を　FileName、" & Name2 & "を　区分に追加しますか？", _ 　　　　　　　　　　vbYesNo + vbQuestion, "インポート確認") 　　　　If (ret = vbYes) Then 　　　　　　sSql = "UPDATE " & TmpITName & " SET FileName = '" & Name1 & "',区分 = '" & Name2 & "'" 　　　　　　CurrentProject.Connection.Execute sSql '　　　　 一時テーブルから正式なテーブルへ (必要なら除外フィールド指定) 　　　　　　sSql = InsertSqlMakeFromTable(ITName, TmpITName) 　　　　　　Debug.Print sSql 　　　　　　If (Len(sSql) > 0) Then 　　　　　　　　CurrentProject.Connection.Execute sSql 　　　　　　End If 　　　　End If 　　Next End Sub －－－以下を標準モジュールへ作成－－－ ' 追加クエリ作成用ファンクション （条件設定なし） ' sTo : 追加先テーブル名 ' sFrom : 追加元テーブル名 ' sBase : フィールド名参照テーブル名（省略時 sTo 使用） ' sExclusion : 追加除外フィールド名（オートナンバーなど除外するためのもの） '　　　　　　 複数指定時は、,カンマ区切り ' ' 戻り値： INSERT INTO で始まるSQL文 ' ' ※ ADOX使用のため、参照設定に ADO Ext が必要 ' Public Function InsertSqlMakeFromTable(sTo As String, sFrom As String, _ 　　　　　　　　　　　　　　　　Optional sBase As String = "", _ 　　　　　　　　　　　　　　　　Optional sExclusion As String = "") As String 　　Dim catdb As New ADOX.Catalog 　　Dim clm As Column 　　Dim sTable As String 　　Dim sToTmp As String 　　Dim sFromTmp As String 　　Dim vTmp As Variant 　　Dim i As Integer 　　Dim bFound As Boolean 　　On Error GoTo ERR_HAND 　　sTable = IIf(Len(sBase) = 0, sTo, sBase) 　　If (Len(sExclusion) > 0) Then 　　　　vTmp = Split(sExclusion, ",") 　　End If 　　sToTmp = "" 　　sFromTmp = "" 　　catdb.ActiveConnection = CurrentProject.Connection 　　For Each clm In catdb.Tables(sTable).Columns 　　　　bFound = False 　　　　If (Not IsEmpty(vTmp)) Then 　　　　　　For i = 0 To UBound(vTmp) 　　　　　　　　If (clm.Name = vTmp(i)) Then 　　　　　　　　　　bFound = True 　　　　　　　　　　Exit For 　　　　　　　　End If 　　　　　　Next 　　　　End If 　　　　If (bFound = False) Then 　　　　　　sToTmp = sToTmp & ", [" & clm.Name & "]" 　　　　　　sFromTmp = sFromTmp & ", [" & sFrom & "].[" & clm.Name & "]" 　　　　End If 　　Next 　　If (Len(sToTmp) > 0) Then 　　　　InsertSqlMakeFromTable = "INSERT INTO " & sTo & " (" & Mid(sToTmp, 3) & ") " & _ 　　　　　　　　　　　　　　　　"SELECT " & Mid(sFromTmp, 3) & " FROM " & sFrom & ";" 　　Else 　　　　InsertSqlMakeFromTable = "" 　　End If 　　Exit Function 　　 ERR_HAND: 　　InsertSqlMakeFromTable = "" End Function
肝心なポイント 商品：部門　の関係は１：ｎ、ｎ：１、ｎ：ｎ　のどれでしょう？ 関係が分からなくては設計できません。ｎ：ｎの以外ではｎ側から １側を参照するようにして、リレーションシップを構築できます。 ｎ：ｎの場合、設計基準が間違っています。つまり、商品も部門も マスタで、「取り扱い」という別の実運用データがあるということに なります。こういうデータモデルが抜けているのです。目先を凌ぐ ことは既に出ている回答で可能ですが、モデル化を正しく行い、 検討（できれば権威者に見てもらうと良い）したうえで、実現する 手順を守るべきかと思います。
>そのカルテを同時に数人で書き込みたいのでDBに保存し共有できないかと思っています。患者数は大体５０人程度です。 と云うことならば、ＬＡＮ（ローカル・エリア・ネットワーク：有線でも無線でも）で、共有ディスクを作り、そこにエクセルデータを置けば、取り敢えずできます。ＤＢを導入せずでも。 ５０人程度ならば、検索機能なしでも、適切にフォルダを別ける程度でも済みそうです。 しかし、同時書き込みによるデータの不具合等を回避することなどを考えると、ＤＢを介在させる必要が出てきそうですが、これも様々なグレードで、様々な費用になりそうです。もう少し仕様を詰めて再質問した方がよいのでは？
AccessなのでASという予約語を入れる必要があります。 また、timeは時刻を求める関数で予約語なので[]で囲みます。 というか名前を変えるべき。DBなども宜しくありません。 SELECT B.ID,B.[time],B.subject FROM (SELECT ID,Min(time) AS mtime FROM DB GROUP BY ID) AS A INNER JOIN DB AS B ON A.ID=B.ID AND A.mtime=B.[time] ORDER BY B.ID,B.subject 前の例文でGROUP BY句が間違ってましたね。 誤：GROUP BY DB 正：GROUP BY ID
> 単票形式のデータを開くことはできた ということなので、その時の OpenForm のパラメータ「WhereCondition」に識別番号を使用した条件を設定するとよいと思います。 ヘルプで OpenForm を参照してみてください。
図にあるオブジェクトだけを考えるのであれば、(2)の設計は冗長です。あえて申請者と合格者を分ける意義がなさそうです。 合格者だけを抽出するには(1)のok_ngフラグ条件で抽出します。 DBは普通そのように使います。 さらに一会社の就職の申請・合否決定というユースケースを考えると、 単年で同じ会社に何度も就職活動することはほぼありえないので、 私なら申請書テーブルにすべての情報を持たせる設計をします。 がんばってください。
　追加でもう一点。 　データベースシステムを利用する、最大の動機と利点は、複数のアプリケーションで、同じデータを扱う時に、統一した方法で同じデータをアクセスできるということです。 　この目標を達成するためには、データそのものがもつ性質は可能な限りデータベースだけで実現しなければなりません。データの整合性もそのひとつですし、データの制約もそうです。（例えば、数値は正の数値であるはずとか、この項目は絶対に定義されていなければならないとか、そういった類の指定です。） 　従って、「（個人的にはテーブルが増えると管理が面倒なのでコードにするにしても、参照するプログラム側で連想配列でも持たした方が楽かなと思っているのですが）」という発想はやめましょう。これをやると、総てのアプリケーションが、この約束を守るための同じコードを書かなくてはならないと言うことになります。これは、最初の目標に背を向ける行為ですから。 　これにより、考え方として、もう一つ追加しておきます。 　データのチェックや処理ロジックにまつわる事項は、可能な限りデータベース側で実現できるように考えてください。単純な値のチェックはもちろんのこと、データの抽出や選別・集計などはＳＱＬ文で行うことを前提にすることです。 　 　最後に、「上記のようにコードをつけて分離しようと思えばできる項目が複数あり、やるべきかやらざるべきかで悩んでおります。」の基準ですが、現実世界で、単独で存在し得る事項はコードをつける価値があると思ってください。（もし、今は必要ないが、実は、もっと項目がある可能性がある場合には、分ける価値がある可能性が高いです。例えば、人名。今は必要なくても、人名テーブルには性別や生年月日など他の項目がつく可能性があります。） 　元の事例に戻ると、Genre_nameは単独で存在し得ますね。「ＳＦ」とか「ラブストーリー」とかは、なにも映画の世界に依存する分類項目ではないです。一方、これは極端な例ですが、w_dateは、この項目単独では価値がありません。 　こう考えれば、少し解決の導入になるかもしれません。
　これではダメですか？ Case（対象日 <= TextToDate("2008/3/31"),Truncate(対象金額 * 0.04 ,1 ),Truncate(対象金額 * 0.03 ,1 )）
このような仕組みを「全文検索」と呼びます。 （#2さんの回答のとおりです） >PDFにして保存するのが一番との事で、その方向で進みそうなのですが 最初の前提として、これは、OCRを使って文字列となっているものですよね？単純に画像をPDFにしたものだと、文字列としての情報にはなりませんから、全文検索以前の問題になります。 以下は、業者に頼むなりして、紙媒体を（画像ではなく）文字列変換したPDFが存在する、と言う前提です。 で、ご質問の解ですが、正直申し上げて、Accessで全文検索システムと言うのはあまり聞いた事がありません。 と言うのは、文書が膨大になればなるほど、全文検索用の言葉（トークン）はその何10倍、何100倍も膨大となり、Accessで管理できるリソースの上限を超える場合が多いからです。 （1つのPDFファイルが何MBで、それが何個あるかによりますが） データベースシステムの観点で見た場合、全文検索のオプションは、 ・Microsoft SQL Server の FullText Search Engine ・Oracle の Oracle Text などがあります。 記憶の限りでは、Accessに全文検索オプションはありません。 私は Oracle Text しか使った事がありませんが、PDFファイルの内容を解析して全文検索のトークンを作成し、非常に高速に検索する事が可能です。 登録についても、PDFにさえなっていれば、OCRを使う事もなく、バッチでバシバシ登録し、自動的にトークンに区切って検索語テーブルを作成してくれます。 （テキスト、Excel、Word、パワポでも可） ただ、さすがにここまで来ると「ちょっとオラクル知ってます」程度のSOHO技術者に頼む、と言うわけには行かず、それなりの会社を探し出して、設定と作り込みで（相当な最安値でも）数100万は行ってしまいますね。
1.クエリを作る。 　クエリ→新規作成を実行し、テーブル追加画面が出たら閉じる。 　次にSQLビューを開いて、以下のSQLを記述する。 INSERT INTO 請求TBL(会員ID,会費区分ID,請求金額,請求日) SELECT 会員TBL.ID,会員TBL.会員区分ID,会費TBL.年会費,Date() FROM 会員TBL INNER JOIN 会費TBL ON 会員TBL.会費区分=会費TBL.会費区分ID 　これを「請求クエリ」という名前で保存する。 2.マクロを作る。 　マクロ→新規作成を実行する。以下のステップを記録する。 　(1)メッセージの設定　メッセージの表示：いいえ 　(2)クエリを開く　クエリ名：請求クエリ　★他は規定値でよい。 　(3)メッセージの設定　メッセージの表示：はい 　これを「請求マクロ」という名前で保存する。 3.フォームを作る。 　コマンドボタンを配置する。ボタンのプロパティ「クリック時」に 　マクロ名の「請求マクロ」を記述する。 以上で準備完了です。後はフォームを開いて、ボタンをクリックすれば マクロが稼動して請求データが出来ます。 フォームでなくても「請求マクロ」を実行すれば、もっと極端には 「請求クエリ」を開くだけで請求データが挿入されます。 「マクロを使って云々」とありましたので、その線に沿ってみました。
>(Java + ベンダー製ＤＢ) >隔離レベルがREAD UNCOMMITTEDであれば >デッドロックは起こりえないと思う 排他制御などの内部処理は、RDBMSにより、単位、強さ、期間などに、少なからず仕様差があります。 排他制御などの標準化は、後回しになったこともあり、RDBMSにより実装状況に大きな違いがある部分です。 例えば、排他制御に関係する指定を、SQL中の特別なキーワードであったり、SQL中のコメントであったり、設定ファイルなどであったりで細かな指定の組み合わせにより、他RDBMSと同じような動作をする機能を提供しています。 >デッドロックが発生しているとの事 >デッドロックが発生する原因として何が考えられるでしょうか？ 事実関係が不明な上、RDBMS名やバージョン、資源などが具体的でなければ、誰も回答できません。
これでも駄目でしょうか？ 参考URL：http://www.astrum.ne.jp/faq/howto/faq/rireki/
質問文を見る限りだと、SQL文が直積の形になっていそうな感じ。 そうだとすると、200の5乗=3200億件くらい検索してるからのように思えます。 外してるかな?
インチキ技（参考までに） 標準モジュールに次の関数を定義します。 Function B(ByVal T As String, ByVal I As Long) Dim R Set R = CreateObject("ScriptControl") R.Language = "JavaScript" B = R.Eval("""" & Replace(T, """", "\""") & """.split(/\s+/g)[" & CStr(I) & "]") End Function クエリは以下のように記述します。 SELECT B(住所,0) As 住所1,B(住所,1) As 住所2,・・・ FROM ～ (1)Splitと異なり2個以上の半角空白でも、1個の半角空白として分離します。 (2)最初が半角空白でも無視します。B(住所,0)は最初に有効な部分列を返します。 (3)文字列のブロック数以上のインデックスを指定しても空文字列が返るだけです。
>noという列を追加し、AUTOINCREMENTで定義しました。 >INSERTできたのですが、行を追加しても自動的にナンバリングなく、空白で追加されました。 CREATE TABLE文と、INSERT文の記述を提示できませんか？ INSERT INTO 表名 VALUES(NULL,値1,値2,・・・) -- no列にはnullを格納するように指定 あるいは、 INSERT INTO 表名(列1,列2,・・・) -- no列は指定しない VALUES(値1,値2,・・・) いった記述にしていますかね？
私の感想は、 > MySQLなども勿論いいですが、導入が超簡単という意味ではsqliteは便利だと思うのです。 この意見と > 情報も少なくて、ちょっとしたことをするのにも苦労します。 こちらの意見が矛盾しているのが答えだと思います。
MySQLならこんな感じ(簡易検証のみ実施) select c.名前, min(c.入金日) incomedate from ( select T入金.名前, sum(T入金.金額) as sumamt, b.入金日 from T入金, ( select 入金日, 名前 from T入金 group by 入金日 ) b where T入金.入金日 <= b.入金日 and T入金.名前 = b.名前 group by T入金.名前, b.入金日 ) c where c.sumamt >= 50000 group by c.名前;
ACCESSなしでもプログラムでMDBの操作は可能ですが、データ移行のためという目的であれば、一回限りなのでわざわざプログラムで移行するというのは無意味と考えます。 Office Professional 2007の試用版がありますので、これを使ってデータ移行された方がよいと考えます。（ダウンロードするにはWindows Live IDのアカウントが必要です） http://trial.trymicrosoftoffice.com/trialjapan/d … 尚、どうしてもプログラムでデータ移行したいという事であれば、ADOXのキーワードで調べましょう。
まあ基本的には他の方と一緒の意見ですが…。 外部ツールを起動させるのではなく、ActiveX (Windows Media Player ActiveX コントロール) を挿入して使う手もあります。 どっちが都合が良い状況なのか分かりませんが。 その場合の再生位置（開始秒数）の指定方法は下記。 http://msdn.microsoft.com/ja-jp/library/cc429695 … 実例。 http://www.happy2-island.com/bbs/bbs.cgi?mode=vi … ただし、これも自力で組めないとか、そもそも ActiveX って何？？ 状態の場合は、詳しい方（プロでも知り合いでも）に頼んだほうが 良いと思います。 > マクロ開発費用のだいたいの相場 gadd3 さんも書かれていますが、プロなら３万以下はないです。 電気工事でも、たとえ結果的にゆるんでいたネジを発見して締めた だけだったとしても、プロを拘束して結果を出させたら、一定の 基準単価より下には下がらないです。 それ以下は、お友達価格とか、学生バイトの範疇ですね。 参考URL：http://msdn.microsoft.com/ja-jp/library/cc429695 …
fp5というとファイルメーカーの5～6で使ってたヤツですね。 ファイルメーカ－10のデモ版をダウンロードしてください。そいつ で渡されたファイルを開こうとすれば、10の形式に変換するメッ セージが出てきます。 参考URL：http://www.filemaker.co.jp/redirect/campaign.html?
SELECT A.ステータスID,MAX(A.ステータス) AS ステータス, COUNT(B.キー) AS 件数 FROM ステータステーブル AS A LEFT JOIN 案件テーブル AS B ON A.ステータスID = B.ステータスID GROUP BY A.ステータス 集計対象は絶対にNullにならない項目を指定します。
不一致クエリー　の機能で　可能だと思います
基本的な部分だけ、 応用は如何様にもできると思います。 フォーム表示時に、リストボックス「lst00」に対象フォルダ 「E:\Access\2007\tmp」にある XXX.txt（拡張子「txt」）を リストボックス「lst00」に拡張子なし名で表示する例です。 （リストボックスの「値集合タイプ」は、「値リスト」にしておきます） （リストボックスはプロパティで「複数選択」を「拡張」に変更しておきます） （※複数選択に関して、ヘルプを参照してください） Private Sub Form_Load() 　　Dim oFSO As Object 　　Dim oFile As Object 　　Dim sTmp As String 　　Const FolderPath = "E:\Access\2007\tmp" 　　sTmp = "" 　　Set oFSO = CreateObject("Scripting.FileSystemObject") 　　For Each oFile In oFSO.GetFolder(FolderPath).files 　　　　If (Right(oFile.Name, 3) = "txt") Then 　　　　　　sTmp = sTmp & ";" & Left(oFile.Name, InStr(oFile.Name, ".") - 1) 　　　　End If 　　Next 　　If (Len(sTmp) > 0) Then 　　　　sTmp = Mid(sTmp, 2) 　　End If 　　Me.lst00.RowSource = sTmp 　　Me.lst00 = Null 　　Set oFSO = Nothing End Sub Private Sub Cmd_01_Click()　では、選択されたものに対して、処理を行えばよいと思います。 　　Dim vTmp As Variant 　　sTmp = "" 　　For Each vTmp In Me.lst00.ItemsSelected 　　　　・・・・ Me.lst00.Column(0, vTmp) で、選択されたファイル名が分かるので、 Me.lst00.Column(0, vTmp) & ".txt" でファイルの名前、 FolderPath & "\" & Me.lst00.Column(0, vTmp) & ".txt" でフルパスの名前が得られます。 補足：余談） SQL = "INSERT INTO T_Mas (ID1,ID,処理状況,請求日,・・・ の中で、TName を代入的に生成していますが、 SQL = "INSERT INTO T_Mas (ID1,ID,処理状況,請求日,・・・ [XXX].・・・ とか、テーブル名を置き換える部分を XXX 名で作っておきます。 テーブル名を換える場合、 Replace で置き換えします。 上記XXXで作っておいたものを　CONSTSQL と仮定した場合、 SQL = Replace(CONSTSQL,"XXX",TName) ソース（記述）を見た時、何をやっているか、よりイメージしやすくなると思います。
>>「Accessのレプリケーション機能を使用」、「Windows管理ツールにあるODBCを利用」、「MSDEを利用」、「SQL Serverを利用」などの説明がありました。 いろいろと調べられたようですね。その中でマルチユーザでのベストな選択は、「SQL Serverを利用」になると思います。が、この場合は、サーバにmdbを置くのじゃあなく、SQL Serverのデータベースを利用します。SQLServerには、無償のExpress版もありますが、データベースの最大容量が4GBという制限があるので、テストじゃあなく本格的に利用されるなら、商品版を使われるほうがいいと思います。 なお、マルチユーザでの利用を考えた場合、入力フォームのロジックは、シングルユーザと大きく違います。それを知らずに作ると、とても遅いレスポンスのシステムになったり、最悪の場合には、データが変になる可能性もあります。 また、Accessを使っての開発はなかなか大変ですので、できれば、何らかの業務アプリ開発ツールを利用されるほうがいいと思います。（ツールは割りと高価なことが多いです・・・） また、マルチユーザでのアプリの利用は、最近は、ＬＡＮ環境だけでなく、ネットを通じて遠隔地からの利用も多いと思えるため、この際、Accessとは縁を切って、Ｗｅｂ環境で動作するアプリをめざされるのもよいかと思います。 こうしておくと、「ユーザが１人増えたので使えるようにセットアップして」とか「そのシステムをうちの部署でも使いたい」とかの要望が来たときも、ブラウザーが使えればシステムが利用可能になるので、手間がかかりません。（ちょっと質問とは離れすぎた解決策かも？）
互換は、あると言えばあるし　ないと言えばない・・ 物が違います。 上位バージョンである2007は、過去のバージョンのファイルは 使えるし、新規作成でも2000形式　2002-2003形式を選べます。 sie1164さんが購入された本のサンプルが　2007形式であれば 2003では使えません。 2007が動作するPCで、2003形式で保存することもできますが 2007独自の内容があれば問題があるし、そもそも　その本は使えませんよね？ 買い直されたほうが無難ですよ。
きつい言い方になるのかもしれません。 先に結論を。 １度教えてくださる方と対話できる形で、講習なり講座を受けらたらと思います。 このご質問は数日前（２２日?）の焼き直しと思います。 なぜ、回答がつかなかったのか、これについて考えて見られたらと思います。 Accessで実現する疑問点/対策/処置方法以前のものと、私は思います。 （今回のご質問からは消えていますが「返す」とはなんなのか・・・とか） 以下にご質問への回答になる(?)ものを記述します。 ・フィールド名の命名について フィールド名は後々処理するうえで、参照する人（VBAやクエリ等を利用して）がイメージしやすい名前を付けます。 今回で言えば「営業終息」という名前を付けたわけですが、値はYes/No。 では、営業終息＝Yes と判別した時、どのようなイメージを持たれますか。 営業終息がYesなのだから、一段落した。。。と私はイメージします。 つまり、「営業終息」とフィールド名を決定したので、イメージと同じYes＝-1の値を、オプショングループに表示している「営業終息」に割り当てます。 営業終息＝No は、イメージからして終息していないのだから、営業中ととらえてた方が素直。 では、もし・・・のご質問に対して、 フィールド名を「営業中」とした場合、営業中＝Yes をイメージしてください。 さらに、フィールド名を「営業」とした場合、営業＝Yes でどのようなイメージを持たれますか。 （この場合、イメージし難いですよね） 前回の私の回答で、補足して書いておけばよかったのですが、 オプショングループで値をデータとして格納する場合の多くは、そのフィールドにどのような値を入れるか設計されていることの方が多いです。 オプショングループのそれぞれの値を逆にして入れても・・・は、通じません。 （オプショングループは単に分かりやすい入力を行わせるために使われる部品でしかないと思っています） ただ、オプショングループの部分に限ってみれば、どの値をどの順で設定しなければならない、ということはありません。
ＶＢ６では、コントロール配列の数の変更ができましたが、ちょっとソースが見つかりません。 事情が良くわかりませんが、他の方法で解決できないなら コントロール配列をある程度用意しておいて、表示をon/offすることによって、数だけあるように見せることはできますが、とってもめんどくさいことになると思います。 私が作るなら、検索部分と編集部分は別に作ると思います。 （検索部分で編集したいレコードを特定し、編集部分には１レコードのみ表示させる）Ｎｏ1の方がおっしゃっていることと同じかな。
SELECT テーブル1.ID, テーブル1.strat, テーブル1.end, IIf(Weekday([テーブル1]![strat])=1,DateDiff("ww",[テーブル1]![strat],[テーブル1]![end])+1,DateDiff("ww",[テーブル1]![strat],[テーブル1]![end])) AS 日曜日の回数 FROM テーブル1; 確認は2003でしています
印刷したい商品は50個で印刷しない商品は何個あるのですか？ 検索条件50個入力は結構大変かも。。やはり商品マスタのようなテーブルを作った方がいいかも知れません。すぐ出来ます。 これが出来ても50個のチェック付けは必要ですが。
どこで配布されているソフトでしょう？ 配布元にバグ情報とか、QandAとか、質問受付ページとかないのですか？
Access2003＆Excel2003＆WinXPにて確認したところ、 右クリックメニューから『形式を選択して貼り付け』ダイアログを 表示させ、「Unicode テキスト/テキスト/Csv」を選択すると、 貼り付け後のセルでは「折り返して全体を表示する(W)」の チェックはオフのままとなりました。 ただ、フィールド名部分は、データ行部分と同様に、白地のままに なり、文字の中央寄せなどの設定も行われなくなります。 先頭行の書式は従来通りにしたいとなると、今度はこちらを 手動で設定するしかなくなります。 (「領域選択+背景色指定+枠線指定+中央寄せ」の4操作) 通常の貼り付け直後の、貼り付け領域全体が選択された状態で 右クリックして「折り返して全体を～」を一度に設定を解除 することもできますので、フィールド名の行は従来通りにしたい という場合は、どちらにしても1度の操作では対応できないこと から、一長一短ということであわせて参考まで(汗)
> 昭33.03.17 このデータが格納されたフィールドの型はテキスト型でしょうか。 であれば、以下でどうなりますか。 DateValue(Replace([生年月日],".","/")) ※ テキスト　昭33.03.17 → 昭33/03/17 に変更後、日付へ
クエリのデータを編集する - Office Online http://office.microsoft.com/ja-jp/access/HA10097 … を読んでね > ACCESSで二つのテーブルの差分のクエリを作りデータの修正を > 行っています。 が、「更新可能なクエリ」では無いと言う結論だと思うよ クエリの作り方、テーブルの相互関係など、複合的な話で決まるから、現状、ＳＱＬ文を公開するなり、テーブルの構造の話をするなり、しないと、具体的なアドバイスは、ないということね
対象がフォームかクエリかの違いはありますが、内容としては以下の質問と かぶりますので、同時に説明させていただきます： (私の説明で理解できましたら、そちらの質問は削除依頼を出して戴けたら 　と思います： 　もちろん、納得できなかった場合は、その限りではありません(汗)) http://oshiete1.goo.ne.jp/qa4899074.html ◎「\」および「"」について： > \　次の文字をそのまま表示します。文字をニ重引用符で囲んでも同じです。 (http://office.microsoft.com/ja-jp/access/HA01232 … 　から抜粋。フォームなどのプロパティシートの『書式』にカーソルをおいた 　状態でF1キーを押してヘルプを表示させても同様の内容が見られます) つまり、『書式』プロパティでの「\殿」或いは「"殿"」という指定は、ともに 『「殿」という字をそのまま表示させる』、という意味になります。 (但し、「\」は後続文字が1文字の場合、「"」(二重引用符)は複数文字に対応し、 　Access2003では文字数に合わせて自動的に「\」と「"」が変換されるようです) ◎「@」について： > @　文字が存在する場合はその文字を、文字が存在しない場合は空白を表示します。 (http://office.microsoft.com/ja-jp/access/HA01232 …) ・・・と説明されていますが、では実際に『書式』プロパティに「@」なしで 「\殿」にしたら、フィールドやテキストボックスの値が表示されず「殿」だけに なるかと思ってやってみると、そうはなりませんでした(汗) (記録されたデータのみが表示され、「殿」の字は出てこない) どちらかというと、「@」は、「記録されているデータと、書式で追加する 文字との、位置関係を指定するための記号」と言った方が実情に合っている ように思います。 つまり、「佐藤」というデータが入っている状態で、書式プロパティが 「@\殿」なら「佐藤殿」となり、同じく「\殿@」なら「殿佐藤」になる、 ということです。 ・・・以上、簡潔ではありませんが(汗)、参考まで。
no1です。下記のサイトもありました。 参考URL：http://www.accessclub.jp/index.html
>その中に「値リスト」と値集合ソースは、 >「見積中、返答待ち、確定、作業中、作業完了、入金待ち、NG」となっています。 >コンボボックス内はそのような”順番”で表示されるのですが、 それはそうです。 自分で、値のリストをその様に入力しているのでそうなります。 勝手に変わったりしません。 コンボボックスは、自分で入力した順番です クエリーとは全く別物ですよね。 クエリーで思ったように並べたいのであれば、ちゃんとオーダーを指定する必要があります。 しかし、単なる（見積中、返答待ち、確定、作業中、作業完了、入金待ち、NG）　この文字の羅列通りに並べることは無理ですよね。 文字で並べると、この順番にはできないので 例えば、状態テーブルを作成（状態ID,状態分名）し 01　見積中 02　返答待ち 03　確定 04　作業中 05　作業完了 06　入金待ち 99　NG の様に登録し、管理します。 集計元のテーブルの該当データも文字ではなく、状態IDで格納します。 コンボボックスもこの状態区分テーブルからリスト表示するようにし 集計クエリーのオーダーも状態IDを指定すれば、希望する状態が作れます。
>しかし、作り直しとは厳しい…。 そんなに困難な作業ではないですよ。 是非ポータルを活用しましょう。繰り返しのままですと絶対困ります。
6のアカウントとパスワード無しで良さそうですがアカウントも入力できないということですか？
この場合はレコードセットのことをさしています。 DAOという方法でテーブルの内容を操作する時の約束事で、 　レコードセット!Edit 　レコードセット!フィールド名 = "aaa" 　レコードセット!Update みたいな表記で該当フィールドに値を書き込めます。 逆に値を取得したい時は 　dim value as variant 　value = レコードセット!フィールド名 となります。 詳しくは参考サイトをリンクしておきますのでそちらで。 参考URL：http://www.accessclub.jp/dao/index.html
レイアウトモードで小計パートのタブをダブルクリックすれば改ページ設定があります。
なんか回答付きませんね。 DoCmd.SetWarnings False DoCmd.CopyObject "パス\data.mdb", "T勤務情報", acTable, "WK勤務情報" DoCmd.SetWarnings True としたら、どうなりますか。 ※ SetWarnings の使い方は、VBEのヘルプにて確認ください
質問者自身で、少し考えた方がよいと感じますが、違うでしょうか？ >振込先銀行を支払い元と同銀行同支店・同銀行支店違い・別の銀行と分ける そのままやればよいでしょう。回答＃２の画像で、１行目、２行目は「支払い元と同銀行同支店」です。 ３行目、４行目で「bb銀行」を「aa銀行別支店」とすれば「同銀行支店違い」を処理できます。「bb銀行」を「別の銀行」と書き換えれば. . . . それとも全く違うアルゴリスムを要求しているのでしょうか？
こちらを参考に。 http://oshiete1.goo.ne.jp/qa2563409.html
ＡＮｏ2です。 支店テーブルとグループ化したクエリを連結させれば、 すべての支店のデータをひとつの表にすることもできます。 レコードが全くない場合ははヌル（ブランク）表示になりますが、、、
LsName がテーブル名を入れた変数なんだったら、 " [" & T_Mas & "].[電話番号],　'" & LsName & "'," & FileName & " From " & LsName とすべきだと思うが、、、 （Fromのあとにスペースが必要） イミディエィト・ウィンドウに表示させているＳＱＬを再度ご確認ください。
下記ツールはいかがでしょうか。 こちらは使ったことがあります。結構便利だと思います。 ​http://www.superdbtool.com/​ 主な機能： ​http://www.superdbtool.com/help.htm​ テーブルを選択... 全てのシートのテーブル定義を取得(シート名で) 条件でデータを取得... 選択されたシートのデータを取得 全てのシートのデータを取得 論理名を取得 その他のデータ取得>現在のシートのデータを取得 その他のデータ取得>コメント条件で現在のシートのデータを取得 その他のデータ取得>コメント条件で全てのシートのデータを取得 SQL実行... データ作成>他のシートデータから1件のデータを作成 データ作成>選択された列のデータを作成 データ作成>データ関係シートを作成 データ作成>データ関係を自動作成（同名列のみ） データ作成>データ関係定義シートでデータ関係を作成 データ作成>データ関係でデータを作成 データ作成>関係シートから各シートへデータコピー 選択されたシートのデータを入換 全てのシートのデータを入換 選択された行データを追加 選択されたシートのデータを追加 全てのシートのデータを追加 選択された行データを削除 条件でデータを削除 SQL実行履歴 DB接続>DB接続情報変更 DB接続>DB切断 参照してください。
>2台の距離は遠いためクロスケーブル（？）などで繋ぐことは不可能です。 　ＬＡＮは、規格は１００ｍまでの保証ですが、ケーブル自体は３００ｍのものも売っていますよ。 　参考まで。
＃１です テーブル名 : Sample IndexKey 1100-12 2100-12 3110-22 4110-22 5110-22 として、クエリにてSQL文を SELECT Sample.*, [Key] & "/" & DCount("*","Sample","[Key] = '" & [Key] & "' And [Index] <= " & [Index]) AS NewKey FROM Sample; と、すると・・・ IndexKeyNewKey 1100-12100-12/1 2100-12100-12/2 3110-22110-22/1 4110-22110-22/2 5110-22110-22/3 のように出来上がります DCount関数で、同じ[Key]の自分のレコードより[Index]が小さいをレコード数を数えてると言うことね
使用中のパソコンがWindows XP の場合 スタート ↓ ファイル名を指定して実行(R) ↓ msconfig と入力する 下の３つのチェックをはずす MobileMe QuickTime iTunes ↓ 適用（Ａ） ↓ ＯＫ これで再起動すると、メッセージがでなくなる可能性が高い。
うーん、原因不明ですね。Vista環境では一応改行区切りできてます。 考えられるのはエスケープ文字（Vistaでは円マーク OS Xではバックスラッシュ） の関連でしょうか。 $buf =~ sub/(m4a|m4p)/\1\n/g; でもかわらないでしょうか。 後「CotEditor」をお使いとのことですが、このエディタの正規表現置換の 機能を利用されてみてはいかがでしょうか。 検索文字列に「(m4a|m4p)」を指定して置換文字列に「\1\n」を指定して みてください。 こちらでは、「CotEditor」は使えないのであくまで推測を域を脱しませ んが。
そんな大雑把な説明をどこに書いてあったのでしょうか。 単に拡張子を".db"にしたところで対応するソフトが無ければデータベースとして認識できませんし、 拡張子が".txt"のままでもデータベースのソフトウェアから相応の設定を行えばデータベースとして使用可能です。 元の資料、書籍かサイトかは分かりませんがそちらを再度確認しましょう。 拡張子を表示させる方法は以下の通りです。 １．どんなものでもいいのでフォルダを開く ２．メニューより　ツール→フォルダオプションを選択 ３．タブ「表示」にて詳細設定「登録されている拡張子は表示しない」のチェックを外してOKボタンを押す
データでしたらフォルダごとコピーで大丈夫です。 オブジェクトフィールドに画像などを参照保存している場合はリンクが切れる場合があります。
SELECT * FROM [;DATABASE=C:\ＤＢ.mdb].[一覧表] LEFT JOIN [;DATABASE=C:\ＤＢ2.mdb].[固有情報] ON 一覧表.ＩＤＮｏ = 固有情報.ID1 というやり方もあります。
私も初心者ですが まずクエリーで割り算に関する二つのフィールドを取り出します。 次にレポートでテキストボックスを作りそこにクエリのふたつのフィールドを取り込み、さらにひとつのテキストボックスを作ります。そのテキストボックスのプロパティーのなかでデータのラベルにあるコントロールソースに =[フィールド1]mod[フィールド2] といれてから 最後にビューをクリックすると割り算の余りが示されます。 これを新しいテーブルにしたいですが、そこは私はわかりません。
しまった～っ こいつは礼も補足も書かない放置人だった。
何となく大塚商会でメンテが行われている模様ですが WordPressのインストールは何回も行ってますが ツール中では簡単な物ですし ９９円のサーバでも動いているので サーバ側の問題では
ご使用の接続サービスや回線業者で多少設定の方法も変わります。 参考URLにBIGLOBEのインターネット接続設定のページを記しておきますので参照して、自分にあった接続方法に必要なツールを入手してください。 下記はBIGLOBEが提供している接続設定ツール http://support.biglobe.ne.jp/settei/setuzoku/oth … 参考URL：http://support.biglobe.ne.jp/settei/setuzoku/ind …
手元にあるAccess2003での確認結果ですが、「データベース変換」 アクションには、テキストのインポートはありませんでした。 csvやtxtのインポートでしたら「テキスト変換」アクションで 行えますので、こちらを使用されてはいかがでしょうか。 (『変換の種類』には「区切り記号付きインポート」を指定)
No.1です。 > As 時間 の部分は任意でつけてよいのですよね？ はい、基本的には大丈夫です。 (但し、「+(半角プラス)」単独など、一部の文字は使用すると 　エラーになるので、完全に任意というわけではありません) > 演算子がありませんとでます(>_<) どういうふうにしたときにそのエラーが出るか、あたりをつけて 確認したところ、「As」の前後のスペースのどちらか一方でも 全角にしてしまうと、Asが演算子としてではなく、前後と連続した 文字列としてして認識されてしまい、ご質問のエラーとなることが わかりました。 ですので、全角スペースを半角スペースに修正していただけば、 ご質問のエラーは出なくなると思います。 また、補足欄の文を見ると、「マスタ」の後のピリオドも全角 となっているようなので、こちらも半角にしておいて下さい。 (このままだと「マスタ．時間1」がパラメータとして要求される 　ことになりますので・・・)
たぶん、 i = i + 1 はいらないと思います。
これは別板の「ご紹介」の質問と同じですか？ だとしたら、ファイル構造も不明ですし、やはり難しいですよ。 私の勘違いだったら無視してください。
解りにくい、その説明のままなのですが 「矢」フィールドに含まれる値は「的」 　　　　　↓ つまり「的」が< フィールド名> 引数 　　　　　↓ ですから、GetField ( "的" )　と同じ 　　　　　↓ 的フィールドの内容は「標的」なので 　　　　　↓ 　　　答えは「標的」 用途も良く解りませんが、私の環境では出番は無さそう・・
一例ですが、 Private Sub ボタン_Click() 　　Dim vTmp As Variant 　　Dim sTmp As String 　　sTmp = "" 　　For Each vTmp In Me.リスト名.ItemsSelected 　　　　sTmp = sTmp & "," & Me.リスト名.Column(0, vTmp) 　　Next 　　If (Len(sTmp) > 0) Then 　　　　CurrentDb.Execute "DELETE * FROM テーブル名 WHERE ID IN (" & Mid(sTmp, 2) & ");" 　　　　Me.リスト名.Requery 　　End If End Sub ※　Mid(sTmp, 2)　は、先頭にある「,」を削るため ※※　データをバックアップしてから
自分は使ったことありませんが、MS がそんなような 技術情報を出しているので、ご参考まで。 [HOW TO] Access 2000 でユーザーのアイドル時間またはアクティブでないユーザーを検出します。 参考URL：http://support.microsoft.com/kb/210297
よくその　mts ってのはわかりませんが たいていのものなら、Craving Explorer で 変換可能だとおもいます。 初耳でしたら　おためしあ＾れ
入力後チェックするというのもありだと思いますが、入力時に制限するということもありだと思います。 テキストボックスのプロパティで、 「IME 入力モード」を「使用不可」とし、 「キー入力時」イベントで判断します。 以下例 Private Sub テキストボックス_KeyPress(KeyAscii As Integer) 　　Select Case KeyAscii 　　　　Case vbKey0 To vbKey9, vbKeyBack, Asc("-") 　　　　Case Else 　　　　　　　　KeyAscii = 0 　　End Select End Sub ※ IME 入力モードがオン（漢字：全角）の時にはここは通りません。 ※ IsNumeric だけでは、,　.　全角数字 が、すり抜けます。
MSDE 2000 と 商用の MS SQL Server 2000 は、データベースエンジン部分については、基本的に同じものです。 ただし、商用とMSDEでは機能制限やクライアントツールの違いがあります。 これから勉強しようと思っているなら、コマンドラインツールしかないMSDEはあまりお薦めできません。 （「コマンド大好き！GUIは不要」と言うなら別ですが） 最新の Express Edition（これも無償です）の方が、よろしいのではないかと。 しかし、Win2000と言う事は、メモリやCPUもそれなりに昔（失礼）だと思いますので、むしろ、MSDE の方が快適かもしれません。 （メモリ1G未満でセレロンクラスのCPUだと、MSDEでないとキツそう） Express EditionとMSDEの違いについては、以下を参照ください。 「SQL Server Express」と「MSDE」を比較する http://itpro.nikkeibp.co.jp/article/COLUMN/20060 … 参考URL：http://itpro.nikkeibp.co.jp/article/COLUMN/20060 …
経験は特にありませんので参考意見ですが。 Advanced Microsoft Jet SQL for Access 2000 http://msdn.microsoft.com/en-us/library/aa139977(office.10).aspx 上記文書内に、下記の一節があります。 Note The GRANT and REVOKE statements can be executed only through the Jet OLE DB provider and ADO. They will return an error message if used through the Access SQL View user interface or DAO. ですので、推測ですが下記のように DAO 経由で実行しようとして いらっしゃるのではないでしょうか。 CurrentDb.Execute "GRANT SELECT ON TABLE myTable TO MyGroup" 正しくは、Jet OLE DB プロバイダと ADO 経由で実行する必要が あります。 たとえば Access 上から開いているカレントのデータベースに 対して実行するなら、こんな感じではないでしょうか。 CurrentProject.Connection.Execute "GRANT SELECT ON TABLE myTable TO MyGroup" 単発の変更でしたら [ツール]-[セキュリティ] から GUI ベースの 手作業で変更したほうが簡単ですが…。 参考URL：http://msdn.microsoft.com/en-us/library/aa139977(office.10).aspx
No.3です。 > ご提案いただいた１）～４）は入力用各種フォームに対するコーディングが大変で、 > メンテナンスはもっと大変に思われるのですが、違うのでしょうか？ すみません、おっしゃるとおりです(汗) Delphi等、Access以外のものは知らないので、No.1の方への補足欄を見た際には その旨コメントするつもりだったのが、すっかり忘れていました。 アドバイスをするつもりが却って混乱を招いてしまったようで、申し訳ありません。
>データベースの本などを読むと、ソートのアルゴリズムなどが出てくる 提示内容が曖昧過ぎです。 具体的にどんな本のどんな部分で、どういったソートのアルゴリズムが出ていたのですか？ この提示内容だけでは、SEやプログラマとして知っておくべき常識として書かれているのか、SQLの機能や動作について書かれているのか、それともRDBMSの仕組みなのかといったことを判断できません。
Edition を確認してください。 http://office.microsoft.com/ja-jp/visio/HA011496 …
レポートにテキストボックスを配置して、コントロールソースに =([終了時間１]-([終了時間１]<[開始時間１]))*24 のような式を設定するとか。関数は不要です。 「26」のような数値が表示されるはずですので、書式プロパティに 「#\時」とでも設定しておけば、「26時」と表示させることが できるでしょう。 テキストボックスの名前は「終了時間１」や「開始時間１」と カブらない別の名前にしてください（でないと循環参照が発生 しますので）。 なお、TimeDiff() を使うなら、 =TimeDiff([終了時間１]-([終了時間１]<[開始時間１])) のような式を設定すれば「26:00:00」のようには表示できます。 ただし「26時」の表示形式にはなりませんので、今回の場合は 微妙にニーズとマッチしないかも。 TimeDiff() も使いどころにハマれば便利な関数だと思いますので、 機会があればご利用ください。
ANO2ですが、 "UPDATE TABLE1 LEFT JOIN TABLE2 ON TABLE1.ID = TABLE2.ID SET TABLE2.NAME = [TABLE1]![NAME], TABLE2.[PRICE] = [TABLE1]![NAME];" ↓ "UPDATE TABLE1 LEFT JOIN TABLE2 ON TABLE1.ID = TABLE2.ID SET TABLE2.NAME = [TABLE1]![NAME], TABLE2.[PRICE] = [TABLE1]![PRICE];" でした。
質問の意図が、よく分からないのですが。 PL/SQLに慣れることが目的なら、Oracle 10g Expressなどの無償版を利用するといった方法があります。 それとも、「PL/SQL Developer」の使い方に慣れることが目的なのでしょうか？
BeforeUpdateイベントで処理せずに、電話番号のExitイベントで処理した方がよいでしょう。たとえば企業名入力に移行しようとした瞬間。重複があれば電話番号にフォーカスを戻す。 それから重複があった場合、既に登録済み番号の企業名を表示する必要などないのでしょうか？タイプミスによる重複かどうか確認できた方がよいと思うのですが。
おはようございます。#1です。 尚更リカバリーして頂くしかありませんね。
IBMのホームページから探すのは分かりにくいですが無料版DB2はあります。 こちらからどうぞ。 http://www.ibm.com/developerworks/jp/offers/db2e …
おはようございます。 Officeを再インストールする。 リカバリーする。 などでは?
(1)だけ 3個のテーブルのリレーションの照合フィールドは何なのですか？ 普通はAが顧客マスタとしての扱いで、B,Cの顧客番号に入力すると名前・住所・連絡先が 自動入力される。という使い方をします。 >Aというひとつのデータベースに、BとCの情報も書けるところをつくり、必要な時だけ >表示+入力＋印刷する これはAに顧客番号を照合したB,Cのポータルまたは関連フィールドを配置すれはできます。
追加質問１への回答。 違います（違う可能性があります）。 質問文における図では t3における時刻の前後関係が読み取りにくいですが，トランザクションＢのCOMMITが先でデータが確定。その後にトランザクションＥが開始されてそのデータを読んでいるかもしれませんから。 追加質問２への回答。 前者はデータベース利用者が明示的に発行する"ROLLBACK"というSQL命令で， 自分が実行している１トランザクションに対してのみ対象とします。 後者はデータベース管理者がおこなう障害復旧操作で， 複数のユーザが実行している複数のトランザクションが対象となります。 ロールバックを実現する仕組みはどちらも同じですが，その対象範囲が異なります。 (１)トランザクション中のディスク書き込みについて。 「データベーススペシャリスト試験」ということですから，個別製品の技術ではなく，一般的な解答が望まれているんですよね……。 私が知っている例ですと，ORACLE Databaseという製品におけるCOMMITとは，REDOログファイルに書き込むことであって，データファイルに書き込むことではないんです。COMMIT＝データファイルに書き込むこと，とは言えない例が実製品ではあるんです。 ただ，そのような製品実装に因らない一般的な解答としては，質問者が×をつけた， 　　>コミットとチェックポイントにメモリからディスクに書き込まれ、 　　>それ以外では書き込まれない（メモリ上で処理される） で正しいように私は思うのですが。 この点，「それ以外にも随時書き込まれる」のはどういう場合か，No.1の回答者の方に教えていただけるなら私にとっても勉強になります。 (２)トランザクションのロールバックについて ○必ず更新前ログでディスクを上書きして終了，で正しいと思います。 　　>チェックポイントがあったらディスクに途中状態で書き込まれている というのは間違いでしょう。トランザクションＣが確保中のデータに対して，別のトランザクションにしろチェックポイントにしろ書き込みを許すというのは，そもそも排他制御していないということで，その前提自体が間違っていると思います。 障害発生により，データファイル上に残っているデータそのものが信用できない，まだCOMMIT前でディスクには書き込まれていないので「データファイル上のデータは元のまま残っているはず」という前提が保証できない。だから，データファイル上のデータが現在どんな値であろうと，トランザクション開始時にコピーしておいた更新前データを上書きするんじゃないでしょうか。 Googleしていて次の資料を見つけました。p.28-29の説明が，特定の製品に因ることなく，分かりやすい説明だと思いました。ご参考までに。 白井 靖人(静岡大学　情報学部情報科学科・准教授) 　平成19年度前期「データベース論」講義情報 　　第12回（7/02）障害回復，同時実行制御（講義資料） http://arc0.pico.cs.inf.shizuoka.ac.jp/~shirai/h … http://www.deainoba.jp/data/view_detail.php?subj …
「配列数式」って聞いたことないですか？ 入力方法が特殊ですが、複数条件を使うことができます。 D1列に =MAX(IF(A1:A5="I",C1:C5,0)) と入力して、確定時に「Shift」「Ctrl」を押しながら「Enter」を押してください（３つのキーを一緒に押す）。 セルには入れていないのに、セルの内容を見ると、 {=MAX(IF(A1:A5="I",C1:C5,0))} という風に中括弧で括られていれば、うまく入力できています。 「配列数式」で検索してみてください。
バスワードがネックのようですね。 今そのランタイムファイルを開くときパスワードを要求されないのでしたら ファイルメーカーの体験版（Adv.ではない方）をダウンロードして.usrを開 いてみては如何でしょう。バージョンの互換性は不明ですが。
> WHERE テーブル2.品番 Like "*[テーブル1].[品番]*" これだと "[テーブル1].[品番]"　という文字列を含むものという意味になってしまいますね。 　WHERE テーブル2.品番 Like "*" & [テーブル1].[品番] & "*" にしてください。
回答がつかないね。 意地悪を書くけど、何をしたいのかよくわからないんだ。 適当に想像しながら、考えてみた。 一番問題になるのは、1行目って何、という点だ。 本当に最初のレコードに、AAAA BBB　を入力したら、未来永劫　AAAA BBB　だけしか入力しないのだろうか？ それはないだろうね。 ここでは、データベースにアクセスして、最初に入力したレコードのことを、『1行目』ということだと思って続けるね。 以下、アイデアだけ書く。 アイデアだけでも長くなりそうだし、今手元にAccessがないので実行確認できないし、さらに、質問の意味を取り違えているのに、具体的に細かく書いたら恥ずかしいから。 まず、一時書き込み用のテーブルを作る。『最初のレコードテーブル』という名前だとしよう。 これはレコードを一件だけ含むテーブル。 入力フォームを開いたら、このテーブルのレコードの内容を削除する(空白のレコードにする)。これは、『開くとき』イベントで実行する。 品番、色番の規定値として、この『最初のレコードテーブル』の値を使う。一番最初は空のレコードだから、規定値も空になるはず。 レコードにデータを入力して、『最初のレコードテーブル』が空の場合に限り、入力した品番、色番を書き込む。 これは、『更新後』イベントで行う。 2件目からは、規定値として最初に入力した品番、色番がでるはず。もしかしたら、フォームをリクエリする必要があるかもしれない。 更新後イベントで、入力した品番、色番を『最初のレコードテーブル』の値と比較して、違っていたら入力し直しにする。 こんな感じでいかが？ 思いつきで書いているから、細かいところで期待したとおりに動作しないところがあるかもしれない。 ごめんね。
7は知りませんが、8にはあります。切り上げ関数。
PCのスペックがたりないからきちんと保存されてないんじゃないの？ Craving Explorerで保存されてはどうですが。 URLをつけておきます 参考URL：http://www.crav-ing.com/download.html
RDBMS名、バージョンを書きましょう。 insertで列名を省略するということは、「その表の構成列を、定義順に指定した」と解釈されます。したがって、values句で指定する値は、すべての列に対して必要になります。 特定の列だけの値を指定したいなら、列名を明記し、指定しない列はnull値を許すかdefault句で省略時の値を設定しておく必要があります。 insert文で列名を省略する別の方法としては、ビュー表を定義し、ビュー経由でinsertする方法があります。この場合も、上述のようなnull値許可やdefault句の設定が必要になります。なお、ビュー表の扱いにはRDBMSにより差があり、insertやupdateなどでできる操作に制限が出る場合があります。
＃３６を回答してから約一ヶ月ですが、「新しい質問」をされたようにも見えません。 １．私が見落としている ２．問題は自力解決した ３．その他 どれでしょう？
Ｂ１セルに =IF(A1="済",0,"") でどうですか
もしかしたら、テーブルに保存されてない、空の新規レコードのことを言っているのでしょうか。 レコードを削除すると、その次のレコードにフォーカスが移りますので、最後のレコードを削除すれば、確かに新規レコードにフォーカスが移ります。 それに疑問を抱いたことなんかなかったのですが・・・・ まいったな。空のレコードがテーブルに勝手に保存されるのかと思った。 そのフォームで、レコードの追加をしないのなら、フォームのプロパティで、レコードの追加を「いいえ」にすれば、新規レコードにフォーカスが移りません。 あるいは、レコードを削除するマクロがあるようですから、最終レコードを削除した後に、最後(削除した後の最後)のレコードにフォーカスを移すようにすれば、新規レコードが出てきません。 と、いう感じでどうでしょう。
販売日と販売開始日を混同されているのでは？車両本体価格等を見直して新たに販売開始日を設定した場合、「販売車」には新しいレコードが追加されますが、「買取売約」にはレコードが追加されるわけではありません。 １台しかない車を２回以上売ることはできないということです。
「半角カナチェック」で検索すれば・・・いろいろな言語のサンプルがヒットしますよ。 半角数字チェックは・・・半角カナのチェックロジックを修正すればＯＫでは？ もう少し、質問する際に情報がないと・・・ピンポイントの回答が書けませんので、この程度の回答で許してね！
ZIPJIS 郵便番号簿と市区町村コード他データベース http://www.vector.co.jp/soft/data/personal/se021 … yahooやgoogleで「JIS 市区町村コード ダウンロード 」をキーにして検索すれば沢山出てきますよ。 http://www.google.com/search?hl=ja&lr=&num=50&q= …
こちらが参考になるでしょうか。 http://shinob.cocolog-nifty.com/mix_dvd/2007/07/ …
データやファイルのことですよね。 はずしてたらすいません。 イメージファイル（多分このときは圧縮・展開と表現するかな）や、不可逆圧縮（画像などのデータ間引き）は別として データのサイズを小さくしたり、または小さく圧縮されたデータを元の状態に戻すことです。 たとえば、「AAAAAA」という文字列を「A6」で置き換えれば、6文字を2文字にすることができ、1/3の容量になります。 Lhaplusなどの圧縮解凍ソフトで出来ます。 Vectorなどで気に入るのを探してみてください。 参考URL：http://www.vector.co.jp/
IsAdministrator 関数のリンクです。 参考URL：http://www.tek-tips.com/viewthread.cfm?qid=415246
insertとupdateは全く違います。 前者はデータを追加するもので、後者はデータを更新するものです。
ファイルAでフィールド値をコピーしてファイルBを検索モードにして貼り付け。 とか そのフィールドを照合するリレーションを設定して、スクリプトの関連レコードのみ表示する。 とか 同じリレーションでファイルAのポータルに表示。 とか・・・
その桐のフォームは「新橋」と「26-3」が別の項目になっていませんでしたか？ エクセルでは、桐に限らず他のソフトからのテキストデータをコピペするとき、この26-3や3/04のような数字の並びは自動的に日付や時刻形式の数値データと認識して貼り付けます。 試しに、この質問ページの26-3の部分だけをコピペしてみて下さい。 やはり3月26日となりませんか？ 結構ありがた迷惑な機能ですが、これはこれで役に立つこともあります。($や\のついた数字はそのまま通貨形式の数値で貼り付けてくれるなど) これをそのままコピーするには、あらかじめ貼り付け先のセルの書式を「文字列」にしておいて、「形式を選択して貼り付け」から「テキスト」形式で貼り付けるしかないと思います。
http://support.microsoft.com/kb/328828/ja こちらの ・複数のテーブルやクエリを含むクエリで、そのテーブルやクエリが、クエリのデザイン ビューで結合線によって結合されていないと、データを更新できません。この問題を回避するには、データを更新できるようにテーブルを正しく結合します。 ということです。
自作PCですか？ PCの型番・仕様など詳細がわかりませんので憶測で書きますが、 デバイスマネージャにオーディオデバイスなしとあるならば、 文字通りオーディオを再生するパーツ（サウンドカード）が組み込まれていないか、 カードが故障のためシステムが認識できていないか、 のどちらかだと思います。
フィールド1="○"は論理式ですからフィールド1が○でしたら1、その他は0を返します。 式の中の○と実際に入力している○は同じものになっていますか？ フィールド1～50はテキストフィールドになっていますか？
ver.5持っていませんが、添付ファイルをファイルメーカーのデータとして格納しておくことは 出来ませんし、「メール送信」でもメーラーが起動するわけですから、特別便利ということは ありません。これはver.9でも同じです。ver.10はメーラー不要らしいですが。 便利なのは、宛先や本文をフィールド値で指定できるくらいです。ver.8？くらいからは添付フ ァイルもファイルパスで指定できますが。
このオートナンバーを使うのは、決定した仕様でしょうか。 私が考えれる範囲では、かなり厳しい仕様なのでは、と思ってしまいます。 番号　　商品　　金額　オートNO 123-333　赤飯　　100　　1 123-444　ご飯　　200 2 123-555　五平餅　150 3 ここに 番号　　商品　　金額 123-222　だんご　100 123-223　アイス　200 123-222　だんご　150 を追加したら、 番号　　商品　　金額　オートNO 123-333　赤飯　　100　　1 123-444　ご飯　　200 2 123-555　五平餅　150 3 123-222/4　だんご　100　4 123-223　　アイス　200 5 123-222/6　だんご　150 6 に、ということですよね。 さらに 番号　　商品　　金額 123-222　だんご　100 123-223　アイス　200 123-222　だんご　150 を追加したらどうなるのでしょう。 番号　　商品　　金額　オートNO 123-333　赤飯　　100　　1 123-444　ご飯　　200 2 123-555　五平餅　150 3 123-222/4　だんご　100　4 123-223　　アイス　200 5　←ここも書換え？ 123-222/6　だんご　150 6 123-222/7　だんご　100 7　←？ 123-223/8　アイス　200 8　←？ 123-222/9　だんご　150 9　←？ オートナンバーは、レコードを登録した際に確定する数値だった（？）と思うので、 1度仮の番号で登録、 オートナンバー値を取得、 重複番号をチェックし、 加工した番号で更新 以前のオートナンバーなし番号に対して更新処理＋α （α：他のテーブルデータの書き換えもあり？） というような流れになるのかもしれません。 VBAでの記述になるのでしょうか。 以下のような変更では？ 番号　　細番　商品　　金額 123-333　1　　赤飯　　100 123-444　1　　ご飯　　200 123-555　1　　五平餅　150 123-222　1　　だんご　100 123-223　1　　アイス　200 123-222　2　　だんご　150 123-222　3　　だんご　100 123-223　2　　アイス　200 123-222　4　　だんご　150 「細番」は、番号が重複した際の数値 追加時に、番号がなかったら、細番=1 あったら、細番=Max(細番)+1　（その番号での細番最大値+1） IIF で DLookup や DMax を使えば、クエリでもできると思います。 番号と細番で、主キーとするのでしょうか。 ※ 何に使うテーブルなのかわからないので、これがいいのかわかりません。 識者の回答を待って下さい。
最初に日付型について、理解してみましょう！ 1900/01/01 = 1として、１日を＋１づづしてます 2009/03/02 = 39,509として、実際、保管されてます ですので、保管している状況では、和暦／西暦が、実際は、無関係です これを書式、定型入力で入力し、上記のように、数値に変換、保管、表示するときに、再度、変換表示してるものです これを和暦/西暦を保管して、更に、表示で再現するとなると・・・ 変換せずテキストにするか？ （ただし、入力チェックは、モジュール化する必要があり） 別のフィールドに、和暦/西暦の表示フラグ的なものを作り、クエリにて、入力用と、表示用のフィールドを２つ設定する必要が、あります どっちにしても、簡単には、出来そうに無いね＾＾；
もう少し勉強してからでないと自作はやばそう。 同じソケット規格のCPUでも新旧存在し、マザーボードよりも後に出来たCPUなんて正しく認識されるわけが無い。 ただし、BIOSアップデートで認識できる場合はある。
この場合も設計を見直した方がよさそうです。 つまり、A店数量とB店数量が同じレコードではなく、別レコードにします。 例が既に集計結果のような形になっていますが、1商品を1レコードにした方が集計しやすいです。
おっと、間違い。 　DoCmd.OpenReport "印刷", acNormal, , "コード=" & !コード ですね。
この質問は、エクセルの関数なのでしょうか？ データAと言うシートの2列目（つまりB列）に関数を入れたい？ 表示したいのは、データBのシートのA列に得意先Noと同じ数値があれば、隣の受注No、なければ、得意先Noを表示したい。 といったことであれば、 データAシートのB列は =IF(ISERROR(MATCH(A2,データB!A:A,FALSE)),A2,VLOOKUP(A2,データB!A:B,2,FALSE)) 下コピィでどうでしょう。
>確かに「*」を使用すると全ての操作がうまくいくのですが、 >何故%でやった場合に違いが出るのかが気になっています。。。 どのように件数を取得してどのようなSQL文で更新しているのかわからないので回答出来ませんが、 件数の取得とデータの更新のSQL文を見直してみるとか、 件数の取得の時も*を使ってみたらどうなるか調べてみるといいかもしれません。
ノートPCが机の上でコンパクトというのは幻想か勘違いですけど… ノートPCは本体が必ず机の真ん中を占有します。 また、デスクトップPCのキーボードをどけるように 手軽にどけることができない重さをともなっています。 もちろんデスクトップPCのように、上に小物を置くこともできません。 ですから、液晶ディスプレイとデスクトップPCの組み合わせが 机の上で、もっともコンパクトな運用だと言えます。 場合によっては、液晶アームを使うのも良い方法です。 私は現在は二つの液晶の一方をアームで設置し 10キーの無いキーボードとトラックボールを並べています。 (FILCO Majestouch tenkeyless,Logitech TrackMan Wheel) トラックボールはそれ自体が移動しないために、散らかった机で使いやすい。 なお、オンラインゲームの種類によって必要なスペックは大きく違います。 負荷の低いものであれば、Atom330(DualCore x HT)を採用したもので コンパクトなものがいろいろ出ていますから、これらでもいいかもしれません。 ただし、YouTubeなどでは高解像度の動画が使われだしたので Atomとそれに組み合わされるグラフィック機能では頼りない可能性はあります。 それ以上に、負荷の高いオンラインゲームは もっとも強力なPCを必要とする分野の一つです。 コンパクトさを重視すると、割高になるはずで 普通のミニタワーPCを、少し離れたところに設置することを 考慮したほうがいいかもしれません。
7を持っていないのでどんな関数が有るのか不明ですが、単純に Max=Max(A商店;B商店;・・・;Z商店)とすると 答=Case(A商店=Max;A商店;B商店=Max;B商店;・・・・・;Z商店=Max;Z商店) ならver.6でも出来そう。式を作るのが大変ですね。スクリプトの方がいいかも？ そのような計算がたくさんあるのでしたら、フィールド構成を変更した方が良さそうです。
問題のありかの可能性としては 1.空白行を追加する場所が間違っている？ （ANo.1の方がおっしゃっておられること） strSQLの内容を詳しく見てみる必要があります。 2.空白行の追加方法に問題があるのではなく、空白行の計算方法に問題がある？ （ANo3の方がおっしゃっておられること） intCountの計算方法があっているか確認する必要があります。 どちらにしても、提供されている情報だけでは原因を特定できません。
SQLとはデータを操作するものであり、Excelに変換する処理はExcelファイルを作成するわけですからファイル操作です。 SQLではファイルを操作することはできません。 したがってどうしてもコマンドでやりたければ、VBAの助けを借りることになります。 AccessのVBAを使ったことが少しでもあれば、ただExcelにするのは簡単です。実質のコードは１行です。 作成したユニオンクエリを「ユニオンクエリ1」という名前で保存したとして、以下を実行することになりますね。 Sub Export() DoCmd.TransferSpreadsheet acExport, _ acSpreadsheetTypeExcel9, "ユニオンクエリ1", "C:\(出力先のファイルパス)\森本.xls", True End Sub
一番簡単なのは、下記のような形かと思います。 ファイルAとファイルBとを、差分がわかるようなんらかのキーでリレーションします。そして次のようなスクリプトを組みます。 1) Aから「関連レコードへ移動」でレコードを絞り込んでBに移動 2) Bで対象外レコードを表示させる 3) Aに戻ってBをインポート実行 リレーションに使えるキーがない場合は、計算フィールドで作りましょう。 参考URL：http://www.filemaker.co.jp/help/html/scripts_ref …
XLin*Kaiを使うためではありませんか？ デバイスマネージャー 参考URL：http://blog.moscacieca.velvet.jp/?eid=517087
>これなら、所属部活(学生番号、部活番号)の学生番号が何度出現しても、部活番号が何度出現しても、問題ないということですよね？？ 問題ありません。 通常N:Nのリレーションシップの場合は、今回のようにします。 もちろん第３のテーブルの主キーは学生番号＋部活番号です。 したがって、学生番号＋部活番号の組み合わせは重複できませんので念のため。
クエリーのSQLはVBAにて CurrentDb.QueryDefs("クエリー名").SQLで読み書きできます 例 CurrentDb.QueryDefs("クエリー名").SQL = Replace(CurrentDb.QueryDefs("クエリー名").SQL,"2009/02/19","2009/02/20") 複数クエリーを処理したいのであれば For Each 変数 In CurrentDb.QueryDefs を利用すると楽かも
SELECT A.ID,A.kudamono,A.yasai, B.その他の列1～～～～～～～,B.その他の列X FROM A,B WHERE A.ID = B.ID; 解りやすい様に適当に改行してます。 このサイト参考になると思います。 http://detail.chiebukuro.yahoo.co.jp/qa/question … 詳細は参考URLへ。 参考URL：http://access-sql.seesaa.net/category/3001313-1. …
instr関数とvbBinaryCompareモードの組み合わせで逃げられませんか。
これと同じかな？ http://www.accessclub.jp/bbs5/wforum.cgi?mode=al …
(1)ダミーでテーブルを指定します。先頭１件だけ抽出します。 select top 1 (select ～ from tbl_A where ～)+(select ～ from tbl_B where ～) AS 結果 FROM tbl_A,tbl_B (2)FROM句にクエリを使います。 select A.数値+B.数値 AS 結果 FROM (select ～ AS 数値 from tbl_A where ～) AS A, (select ～ AS 数値 from tbl_B where ～) AS B 個人的には(2)ですかね。ASを除けば、Oracle等とも互換性のある 書式です。 (select ～)は１レコード１項目しか無いと想定しています。
バインドが上手く言ってないようですね。 PHPのようですが、PDOでのバインドの方法って違ったような記憶があります・・・ 定かではないですがステートメントを取得するには query()じゃなくて prepare()じゃなかったでしたっけ？ $stmt = $pdo->prepare('～省略 WHERE cid = :cid ORDER 以下略～'); $stmt->bindValue(':cid', $cid, PDO::PARAM_INT); if (!$stmt) { db_error($pdo->errorInfo()); }
VBAに限定しての話です。（SQLも分からない、となると話は別です） 以下の質問があります。 (1)近くに専門家がいて、不明点を直ぐに質問できる。 　Yes→２週間くらいで習得可能 　No→次の質問へ (2)コレクションとオブジェクトの違いが分かる。 　Yes→１ヶ月くらいで習得可能 　No→次の質問へ (3)イベントドリブンの感覚は習熟している。 　Yes→２ヶ月くらいで習得可能 　No→次の質問へ (4)未知の研究経験 　理科系大学ではよくあるんですが、参考書も教科書も無い状態で、 　あるテーマについてのレポートを提出する。というような訓練を 　何度かしていますか？ 　Yes→３ヶ月くらいで習得可能 　No→習得にはかなり時間がかかる。 ご質問内容だけでは目的、環境、質問者の経験など全く不明なので、 一般的な話と、自分の経験から導いているものなので、他の方には 異議もあるかと思いますが、こんなものではないでしょうか。 私はVB（VBA含む）は17年くらいやっていて、その間に新人教育も 何度もやっています。 ご質問の件の場合、仕事である以上、悠長なことは言えないはず なので、(2)がクリアできないなら、「自分には解決できない」という 報告をすべきでは？ 教育期間が必要→未経験者ということですから、命令を出した側と しても、担当者を取り替える、開発体制を見直す、などの対策を施す 必要があり、そのための期間も必要になるはずです。
他にリレーションしているファイルやテーブルが有れば、それを開けば解るかも知れません。 そこでその顧客名で検索すればIDフィールドがあるかも。またIDでリレーションしていて別ファイルの 顧客名や住所は関連フィールドとして配置している場合はIDだけ残って顧客名答は空白になりますので 空白を検索してみるとか。
スクリプトを作る時にIFで機能を変えたらいかがですか？ 例えば"レコード毎機能"というテキストフィールドを作っておき ポップアプリストでもチックボックスでもよいですが項目をあらかじめ作っておきます。 URLを開く ファイルを開く ・ ・ ・ スクリプトで IF レコード毎機能＝"URLを開く" URLを開く「フィールド値」 else 開く 数種類の場合は、組み方が色々ありますのでなんともいえないですが このままIFを入れ子でやっていくか計算式を使ってその中で論理関数で振り分ける方法も有ると思います。 URLを開く・ファイルを開くだけの機能でしたらファイルを開く方もパスを入れる事で開きますので特に複雑なスクリプトを組まなくても大丈夫です。 例えばこんな感じで C:\Documents and Settings\あなたのID\My Documents￥開きたいファイル
既にご回答が出ているように AS を使用して一つのテーブルを二つに見なせばよいのですが、これは Access のGUIでクエリを操作するとき、同じテーブルを二度選択してやればあとは Access がやってくれます下記は「担当者名 AS アシスタント名」を別にすれば、 Access が作成してくれたものをＳＱＬビューで見たものです。 SELECT 実施テーブル.*, 担当者テーブル.担当者名, 担当者テーブル_1.担当者名 AS アシスタント名 FROM (実施テーブル LEFT JOIN 担当者テーブル ON 実施テーブル.担当者コード = 担当者テーブル.担当者コード) LEFT JOIN 担当者テーブル AS 担当者テーブル_1 ON 実施テーブル.アシスタントコード = 担当者テーブル_1.担当者コード;
画面右上「ページＰ」左クリック。 下がってきた表示の中の「拡大(Z)」にマウスを持って行くと、その横に「拡大、縮小　○○％」が出てきます。 その中の１００％を左クリック。
No.1の方の回答にもあるように、ご質問のような場合にはレコードソースを 切り替えて対応するのが一般的かと思います。 (例えばAccess2003までのマクロなら、「値の代入」アクションで『式』に 　クエリ名を、『アイテム』に「Forms!(フォーム名).RecordSource」を指定、等) ただ、以下の前提が成り立つ場合には、1つのクエリでも対応が可能です： 　1)抽出条件の対象となるフィールドは、常に「空白(Null)」以外(→必須)。 　2)抽出速度は、ある程度目を瞑ってもよい。 この場合は、クエリのデザインビューで下の画像のような抽出条件にします。 なお、この例はAnd検索(=双方の条件を満たすものを抽出)です。 Or検索が必要な場合は(多分ご希望はAnd検索かと思いますが)、 　【現状】　Like "*" & ～ & "*"　｜　Like "*" & ～ & "*" 　【変更】　Like "*" & ～ & "*"　｜ 　　　　　　　　　　　　　　　　　　　　 ｜　Like "*" & ～ & "*"　 　というように、段をずらして抽出条件を指定して下さい。 こうすることで、テキストボックスがNullの場合には抽出条件が「Like "**"」と なるため、’対象フィールドがNull以外’の全レコードが抽出対象になります。 ◆ここでNullが対象外となるため、上記「1)」の前提が必須となります。 ◆テキストボックスがNullなら本来不要な抽出(「Like "*"」による全件抽出) 　を行っているため、上記「2)」の弊害(=抽出の鈍化)が発生します。 なお、抽出条件式を 　Like IIF(IsNull([Forms]![MF1]![テキスト1]),"*",[Forms]![MF1]![テキスト1]) としてやれば、ユーザーがワイルドカード文字(*)を指定することで、前方一致・ 後方一致や、完全一致での検索を行うこともできるようになります。 (ワイルドカード文字を入力しないと、完全一致検索を実行) ところで、上記で「空白(Null)がない前提」としましたが、「空文字("")」は 存在しても構いません。 ですので、Nullを空文字に置換してもよいなら、現在のデータがNullを含んで いたとしても、以下の手順を経ることで対応可能になります。 1)テーブルをデザインビューで開き、対象フィールドの『空文字列の許可』を 　「はい」に設定し、保存して閉じる(既になっていればそのままでOK) 2)更新クエリなどで、対象フィールド毎に、Nullを空文字("")に置換 　(複数フィールドを同時にやるには、クエリでの代入値に式を設定する必要が 　　発生します。失敗して既存データを削除(=空文字で上書き)しては問題 　　なので、面倒でも1フィールドずつ処理することをお勧めします) 3)テーブルを再びデザインビューで開き、対象フィールドの『値要求』を「はい」 　に設定 ※実行前に、バックアップは必ず作成しておいてください。 ・・・以上、対応法としてはちょっと特殊なのでお勧めはできませんが、参考までに。
既存のキーをレコードの追加はできません。 存在する部分は、更新クエリーで処理します。 存在しない場合は、追加クエリーで追加します。 追加クエリーの対象は、不一致クエリーで対象を把握できます。
NULLは値ではありません。 退職年月日 < 20090210 の条件式は退職年月日がNULLの時に'unknown'を返します。 ですから AND 退職年月日 IS NOT NULL の指定は必要ありません。 なお退職年月日がDATE型ならば適切な処理で"20080210"を時刻型にする必要があります。 これはRDBMSにより仕様が違いますので割愛させていただきます。
ご質問の件は、私にはできませんが アクセスからEXCELをレポートの代わりにすることは 罫線等の便利さからありえます。 今回の場合にはすでにEXCEL上で、レポート機能は完成しているとのことですので。 アクセスのモジュールがおわかりでしたら　以下の様にもできます。 （ACESSからEXCELの操作ができる前提ですが） データはあくまでもACCESSで管理 アクセスからの印刷指示時 ・EXCELの差し込み印刷用データのセル範囲をクリア ・印刷対象データを、EXCELの差し込み印刷用データのセル範囲に書き出し ・EXCELを起動（印刷用のEXCELファイルを開く） データのセットから、EXCELの起動まですべてACCESSでしてしまう形です。 VBAでの、EXCEL操作は　NET上に幾らでもサンプルがありますので トライして見られてはいかがですかね。
Mid関数を利用するのであれば、 =Mid([電話番号],Instr([電話番号],"-")+1,InstrRev([電話番号,"-")-Instr([電話番号],"-")-1) ですが =Split([電話番号],"-")(1) とすれば出ます。
#3です。補足を拝見いたしました。 ↓こういう情報がとても大事だと思います。 > その中に含まれるデータ（dbfです。地名、道路路線名、駅名、施設名称、緯度経度等）を > 他のパソコンからExcelやAccessで読み出し、 > データの追加や分析を行い、再度地図上に反映させる、というものです。 この辺から、dbfファイルを(例えば)Accessにリンクやインポートをして使用していて、それを活用されていることが伺えます。 ※私、「dbfってなんじゃらほい？」というレベルですので、あらかじめご了承を(汗) 例えば新しく作られる環境は↓こんな感じのものをご提案できそうですｗ (1)SQLServerをサーバー機にインストールしてデータベースサーバーとして利用。 (2)一旦dbfファイルをAccess等にインポート。 (3)(2)のアクセスから(1)にインポート。 (4)各PCからデータを扱う場合はAccessを使ってSQLServerに接続。データ追加・修正・削除etcを行う。 SQLServerには無償版がありますので、まずはご自分のPCにインストールしてみてはいかがでしょうか？ 【Microsoft&reg; SQL Server&reg; 2008 Express】 http://www.microsoft.com/downloads/details.aspx? … インストール→(1)～(4)を実行して、タスクマネージャを使ってどのくらいCPUを使っているか、どのくらいメモリを使っているか見ていると、サーバー機の構成が見えてくると思います。 インストール前に↓こちらを参考にされるといいかもしれません。「推奨システム要件」をご参照ください。 【SQL Server 2008 システム要件】 http://www.microsoft.com/japan/sqlserver/2008/pr … > SQLServer以外にはOraclを聞いたことがあるのですが、 ※「Oracle」ですねｗ Oracleにも評価版がありますので、あわせて試されてみるといいかと。 【ダウンロード - Oracle Database】 http://www.oracle.com/technology/global/jp/softw … 最新版は11gになります。Windowsでしたら上から5番目の「Oracle Database 11g Release 1 (11.1.0) for Microsoft Windows (32-bit) 30日間トライアル版」かと。もし64bit版のWindowsでしたら、上から7番目の「Oracle Database 11g Release 1 (11.1.0) for Microsoft Windows x64 30日間トライアル版」です。 > SQLServerでよいのでしょうか。 うーん。 こればっかりはご予算や、どっちが使い勝手がイイとかにも関係しそうな気がします(汗) 私の浅い経験からですがｗ データへの信頼感というのはOracleの方が上、という意見が多いかもしれません。ただ個人的な偏見ですがｗ(製品版の)Oracleはツール類が使い辛い、SQLServer(の製品版)はツール類が使いやすい、という偏見がございますｗ社内SEをやっていますが、ツール類が使い辛いと仕事がはかどらなかったり… 製品版の購入を検討されるなら↓こちら。 SQLServer価格表 http://www.microsoft.com/japan/sqlserver/2008/ho … Oracle価格表 http://www.oracle.com/lang/jp/corporate/pricing/ … では、ご検討をお祈りしています。
おてもとの入力フォームがどんなかにもよるかもしれないので、アイデアだけ書きます。 その１ フォームの規定値に何も書いていない状態で、担当者コードが入力されたら、そのテキストボックスの更新後イベントで、規定値に入力された担当者コードを書き込む。 フォームと閉じるときに、閉じる時イベントで、規定値を空欄に戻す。 その２ 入力された担当者コードをどこかに覚えておいて(テーブル、テキストファイル、VBAの変数など)、適当なイベントでテキストボックスに書き込む。
どんなDBでも壊れる時は壊れます。Accessだけの専売特許ではありません。 DBが壊れなくてもハードディスクが火を噴くとか・・・（実経験あり） 誰かが誤って削除してしまうとか・・・（実経験あり） なので、バックアップ体制から逃れられるDBシステムはありません。 どんなDBシステムを使うかは(1)データ量、(2)アクセス頻度、(3)応答速度、 (4)コストなどを勘案して決めます。データ量が少なく、コストを抑える ように指示されているなら、Access2007は十分に検討対象になると思います。
SQLの基本的な構文であり、MySQLとは違うといったことはありません。 update 表名 set 列名=列名+1 >mySQLと同じ書き方ではできませんでした。下の２つの書き方はいずれもだめでした。 「だめ」とは、具体的にどうなるのですか？ 文法エラー？ 更新しているはずなのに、値が変わっていない？
http://www.kotaete-net.net/Default.aspx?pgid=14& … そご参考になさってみてはかがでしょうか？ Shellかなんかで目的のMDBを起動しておいてからGetObjectなどをすればいいのかもしれません。（うろおぼえなので外れかも） 他の方法としては、 (01)「別のmdb」側に、標準モジュールで目的のフォームを開くプロシージャを書く。FunctionかSubかどっちか忘れましたけど、どちらかか、両方か。Docmdなどで普通に開く簡単な1行コードでOKです。このプロシージャをtest01()とします。 (02)「別のmdb」をVBEの画面から「参照設定」でmdbの参照設定を施す。 これで「別のmdb」の標準モジュールのプロシージャを直接Callできるようになります。 (03)呼び出しもとのプロシージャから、 コマンドボタンのクリックイベントで Call test01() とでもすれば、呼び出しもとのAccessウィンドウの中で目的のフォームが開きます。 以上、ランタイム環境でやったことはありませんが、もしかしたらできるかもしれません。 ※通常mdbを参照設定するときは、汎用（共用）モジュールなどを格納することが多いと思います。のべつまくなしにmdbに参照設定をかけると、ちょっとどうなるのかわかりませんので、たくさんのmdbを参照設定する場合は、実験しながら試してみてください。
INSERT INTO まとめテーブル SELECT * FROM テーブル1 IN 'C:\Test\B.mdb'; のような感じで。
> 入力してみたのですがエラー 簡単な確認方法を以下に。 ・テーブル「T_A」を作成します 　作成後、データを何件か登録します ・テーブル「T_A」をテーブル「T_B」名でコピーします 　コピー後、T_Bのデータを何件か削除します ・クエリを作成します 　（クエリウィザードは使用しません） 　　クエリデザインでテーブルを何も選択せず「閉じる」ボタンクリック 　　クエリの表示を「SQLビュー」に変更します 　　表示されているものを削除後、提示内容を貼り付け、表示を「データシートビュー」へ で、どう表示されるでしょうか。
アドレス帳を起動して ヘルプ→バージョン情報でファイルの場所が 表示されます。 たとえば C:\Documents and Settings\XXXX\Application Data\Microsoft\Address Book\XXXX.wab
＃２　修正です >　　Wend >　　If (Len(sTmp) > 0) Then 　↓ 　　Wend 　　rs.Close 　　If (Len(sTmp) > 0) Then ※　処理が複雑になっていますが、「管理番号」のデータ桁を揃えておくと簡単になります。 　　RIGHT(" " & T_T6.管理番号,6)　→　T_T6.管理番号　に置き換えれます。 　　また、Replace　も不要になります。
私の思っている通りの意味なら、元に戻さずに、次の並べ替えができるはずです。 エクセルの場合、並べ替えたらそのままそれが確定して、前にどう並んでいたか、というのは関係なくなってしまいますので。 ですので、いくつか思いつくことを書くと、まず・・・ 『-』が半角だったり、全角だったりチャンポンに使っていませんか？また、気がついたら『ー』になっていたなんてことを、私はよくやるのですが。 そのせいで、期待通りに並ばないことがあります。 あるいは、並べ替えをするときに、追加した分を選択していないとか。 手でやるときは考えにくい理由ですが、VBAで自動処理をしている場合、うっかり、選択すべき範囲を固定してしまっていることがあります(私だけ？？？)。
　htmlで書いた普通のホームページを公開するためには、webサーバーが必要です。（例えば、apacheとかがフリーでは有名ですね。）そして、そのサーバーが、共有するネットワーク環境でアクセスできるように設定することも必要です。 　これは、わかりますね？ 　これと同じように、jspで書かれたwebアプリケーションを公開するためには、アプリケーションサーバーが必要です。（フリーでは、例えば、同じくapacheのグループが開発したApache Tomcatが有名です。）そして、webサーバーと同じく、共有するネットワーク環境で、このサーバーにアクセスできるように設定することが必要です。 　さて、この文章が、暗号に見えるようでしたら、もはやここで説明できる領域を超えています。そのレベルから説明を始めたら、本が一冊書けるからです=^・・;= 　解らないところがあるという程度でしたら、どこでつまづいているか補足お願いできますでしょうか？アプリケーションを開発環境で作成した後、サーバーを一から立ち上げて、サーバーにアプリケーションをセッティングして、他のパソコンから見えるようにする手順を一から書いていたら、この回答欄に書ける文字数を軽く超えますので（苦笑）
>ファイルメーカーサーバーでこのようなことはできるのでしょうか？ そのためのソフトです。詳しくはHPで
１．FIREFOXをダウンロード ２．ツールーアドオンーSQLITE Managerを追加 ３．ツールーSQLITE Managerを起動。 ローカルにあるデータベースファイルを.dbなどを編集できます。 ４．編集したファイルをFTPでアップすればOKです。
読み切れていないかもしれませんが、こういうことがやりたいんですかね。。 SELECT t1.番号,Nz(cnt1.件数,0),Nz(cnt2.件数,0) FROM (test1 t1 LEFT JOIN (SELECT 一つ目,COUNT(一つ目) AS 件数 FROM test2 GROUP BY 一つ目) cnt1 ON cnt1.一つ目=t1.番号) LEFT JOIN (SELECT 二つ目,COUNT(二つ目) AS 件数 FROM test2 GROUP BY 二つ目) cnt2 ON cnt2.二つ目=t1.番号
今回のようにTabStopの「はい/いいえ」の切替だけなら、以下のような方法もあります。 (コントロールの種類によって、より細かい制御を行う場合は、No.1の方のように 　Select Case を使うのが正当ですが) ◆コメントのせいで行数が多くなっていますが、コード本体はほんの数行です。 Private Sub Test1() 'エラーが発生した場合は「エラー処理」に飛ばす On Error Goto エラー処理 　　Dim Cntl As Control, PrpVal As Boolean 　　'『入力値』テキストボックスが空白かどうかで、タブ移動を切り替える場合 　　'(TabStopプロパティへの、Len関数の演算結果の代入により、文字長が 　　'　0なら「いいえ(False)」、それ以外は「はい(True)」扱いになります) 　　PrpVal = Len(入力値 & "") 　　'『サブ』サブフォーム内の全コントロールのタブ移動を切替 　　For Each Cntl In Me!サブ.Controls 　　　　Cntl.TabStop = PrpVal 　　Next 終了処理: 　　'念のため、明示的にメモリを解放 　　Set Cntl = Nothing 　　Exit Sub エラー処理: 　　Select Case Err 　　　　Case 438 　　　　　　'ラベルなど、TabStopプロパティを持たないコントロールへの代入に 　　　　　　'よるエラー　→無視して処理を継続 　　　　　　Resume Next 　　　　Case Else 　　　　　　'上記以外のエラー　→メッセージを表示 　　　　　　MsgBox Err & "：" & Error$, , Me.Name & " Test1" 　　　　　　Resume 終了処理 　　End Select End Sub ・・・ところで、本当に必要な処理は、サブフォームのコントロールのTabStop なのでしょうか。 もしも「ある条件の下では、サブフォームへのタブ移動はさせないようにしたい」 ということだとすると、サブフォーム内のコントロールのTabStopを制御しても、 解決しません。 この場合は、コントロールとしてのサブフォームのTabStopを「いいえ」(False)に 設定してやる必要があります(サブフォーム内のコントロールは切替不要です)。 ※場合によっては、サブフォームのEnabledプロパティを「いいえ」にしてやる、 　 という手もあります。 　 (但しこの場合は、予めフォーカスをサブフォーム外に出す必要あり) Private Sub Test2() On Error Goto エラー処理 　　サブ.TabStop = (Nz(入力値, "") = "") 終了処理: 　　Exit Sub エラー処理: 　　MsgBox Err & "：" & Error$, , Me.Name & " Test2" 　　Resume 終了処理 End Sub
> 在庫管理をするのに、エクセルとアクセスどちらが適当なのか。 どうやって管理するのか、によると思います。 例えば 1月27日…商品Aが50個入ってきた。 1月28日…商品Aが20個出て行った。 …といった感じで商品Aの履歴も含めて管理するのであれば、Accessの方がデータの操作がしやすいと思います。そうではなくて単純に商品Aが今何個あるのか、ということだけ管理できればいいというのであればExcelでも可能かと。個数だけ更新すればいいのですから。 もちろんデータ件数もAccessとExcelどちらを…という切り分けになります。データが多くなればAccessの方がデータを扱いやすいかと思います。 いづれにしても、質問者様がどのような作業を意図されているのか、によると思いますよ。 > どのような、特徴があるのか？将来的にどちらがいいのか？ 特徴はリレーショナルデータベース…といって伝わるでしょうか(汗)実際に使われた方が伝わると思います。Accessをお持ちでしたら以下のサイトをサンプル使いながら読んでいただくと、よりご理解いただけるかと。 【Microsoft Access Club】 http://www.accessclub.jp 【Microsoft Access初心者入門講座】 http://ms-access.seesaa.net/ > ＣＳＶって、両方に適用できますか？ 適用、が伝わりにくいですが(汗) ExcelでCSVファイルは開けます。ただご存知かとおもいますが、例えばCSVに「001」と入っているデータをExcelで開くと「1」と表示されます。回避方法はあるみたいですが↓ 【CSV 形式ファイルを Excel で開く際の "001" 問題を回避する方法 】 http://www.f3.dion.ne.jp/~element/msaccess/AcTip … AccessではCSVファイルのデータをテーブルにインポートする、という形でデータを扱うことができます。 ご質問の意図を取り違えているかもしれませんので、参考の参考程度に。
>SQL＋ACCESS SQLと言っているのが、Microsoft SQL Serverではなく「AccessのJetSQLを使っている」と言う意味であると想定してお答えします。 >上記の技術は不必要になるとかんがえられるのでしょうか 導入方法によります。 導入のポリシーとして、Accessから本番のORACLEに接続してよいのであれば、これまでの技術的な資産は、「原則」そのまま運用できます。 「原則」と書いたのは、ODBCでリンクを張りなおすのと、ODBCリンクにした時に、多くの場合パフォーマンスに問題が発生して、パススルークエリ（AccessからJet経由ではなく、直接ORACLEの方言のSQLで記述する）に書き換えるなど対応の必要が生じるからです。 本番への接続が不可となる場合、別途、何らかの業務クライアント（WebかC/S）を導入するはずだと思いますので、これまでの技術的な資産は不要となるかもしれませんが、定期的にスナップとしてCSVを取得するなどの運用が可能なのであれば、これまでどおりに使えます。 （リアルタイム性が失われますが、）
宛名職人は使ったこともないものですが 製品のページを見てみました。 読み込みが可能なファイル形式 宛名職人 住所録ファイル(*.ata)：宛名職人98～2009 とありますので、CSV（書き出しは記載がなかったですが）と言う考えを止めて、XPのマシンから該当のファイル 宛名職人 住所録ファイル(*.ata)を　USBメモリか何かに コピーして、Vistaの宛名職人2009で取り込めると思います。 お試しを
