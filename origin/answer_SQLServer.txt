SQLSERVERということであれば、LEFT JOINの代わりにOUTER APPLYを使ってクエリを簡単にする手もあります。 速度はデータにもよりますが、LEFT JOINより早いようですね。 相対コスト（LEFT JOIN 82：OUTER APPLY 18） DECLARE @TA TABLE (id INT NOT NULL PRIMARY KEY,item VARCHAR(30),quantity INT) INSERT INTO @TA VALUES(1,'商品1',10),(2,'商品2',20),(3,'商品3',30) DECLARE @TB TABLE (id INT NOT NULL PRIMARY KEY,item VARCHAR(30),price INT,saledate DATE) INSERT INTO @TB VALUES(100,'商品1',100,'2016-08-10'),(101,'商品1',110,'2016-08-11'),(102,'商品3',200,'2016-08-12') SELECT TA.item,TA.quantity,TB.price,TB.saledate FROM @TA as TA OUTER APPLY( SELECT TOP 1 * FROM @TB as TB WHERE TA.item = TB.item ORDER BY TB.id ) as TB
連鎖参照整合性制約の事ですか？？？ http://msdn.microsoft.com/ja-jp/library/aa933119 … 上のURLの説明を読んでください。 前提条件として、外部キーが設定されている事とCREATE TABLE（もしくはALTER TABLE）でREFERENCES句に"ON DELETE"、"ON UPDATE"が設定されている必要があります。 マスターデータを削除したら、それに関連するデータも同時に削除される設定です。こうしておかないとエラーとなります。 ALTER TABLEで外部キーを設定して、同時にREFERENCES句に"ON DELETE CASCADE"を追加すれば行けると思います。
普通は動くはずですけど、リンクテーブルのデータ型が変わっちゃっているのかな？ その場合は、クエリを修正する必要があるかもしれません。
おそらく、出題者が求めている結果は下記でしょう。 書籍コード　　total 1001　　　　 54000 1234　　　　 25000 その為には、GROUP BY と SUM() と AS を使います。 ＞ 新しくtotalという列を作り、20000円以上のコードとともに表示するという意味らしいです。 AS を使えと言う意味でしょう。 これまでに習ったことを理解して覚えていれば簡単に解けるはずです。それができないと言う事は、問題を解く前に、復習をすべきでしょう。 ＞ 抜き出した合計を列名totalとともに表示しなさい。 この記述が曖昧だから他の回答者のように迷いますが、授業を受けていればこれまでの経緯で理解できるはずです。
リンクテーブルを使うのが一番幸せな方法。 ローカルの DB 内には外部 DB のテーブルへのリンク情報が保存される。 フォーム、クエリ、レポート、VBA コードなどからは、ローカルの DB にあるテーブルも、リンクテーブルも、どちらも違いなく扱えるというメリットがある。 ODBC を媒体にして VBA コードから外部 DB へ接続し、レコード群のやり取りだけを行う方法も可能だが、自由度は減る。 ユーザー側にある Access の DB にはユーザーが操作するフォームやレポートがあるわけだが、これらとデータの仲介が全て VBA コードによる処理となるため、"非 VBA" で接続する方法がとれない。 具体的には、フォームやレポートのデザイン画面でレコードソースを設定することができなかったり、Access 側のクエリが使用できなかったりする。 UI とデータをそこまで分離させようとするのであれば、Access じゃないほうがもっと便利に開発できるんじゃないか？ と個人的には思う。 Visual Basic 2015 Express とかのがもっと本格的に、もっと自由に開発できる。 VBA のコードで作成した DAO または ADO の Reocordset オブジェクトをフォームの Recordset プロパティに設定して読み書きするためのサンプルは下記を参照。 https://msdn.microsoft.com/ja-jp/library/office/ … DB からデータを取得したり、DB のデータを更新する部分は SQL 文を中心に処理することになるかと思います。 データを更新する場合は SQL Server 側に作成したストアド プロシージャーを VBA から呼び出して適切な更新値を与えてあげるやり方が主でしょうかね。 「ADO SQL Server」 あたりで検索していくと調査がはかどると思います。
オンプレの更新頻度やクラウドの参照頻度によりますが、 そもそもオンプレのデータをクラウドからプルするのはセキュリティ的にどうかと思います オンプレ側からプッシュする方式がよいのではないでしょうか？ 同じ種類のSQLサーバーであればリプリケーション機能があったりしそうですが 無理ならとりあえず、SQL文ベースでのダンプとインサートができるか確認し、 無理ならCSVなど汎用テキストで受け渡すことになると思います 本来はEDIなどかまして所定の入出力形式のすり合わせをしておくのでしょうけどね
MicrosoftR SQL Server 2016 Express https://www.microsoft.com/ja-JP/download/details …
Dim 行 As Long Dim END行 As Long Set Sh = ActiveSheet END行 = Sh.Range("A65536").End(xlUp).Row　’最終行 For 行 = 2 To END行 If IsNumeric(Sh.Range("A" & 行).Value) Then　’数値の場合のみ If Sh.Range("A" & 行).Value >= 3000 Then Sh.Range("B" & 行).Value = "A" ElseIf Sh.Range("A" & 行).Value >= 2000 Then Sh.Range("B" & 行).Value = "B" ElseIf Sh.Range("A" & 行).Value >= 1000 Then Sh.Range("B" & 行).Value = "C" Else '1000未満なら無処理 End If End If Next 行
#2です ためしたところ別名をつかわないと名前が競合しますね SELECT COALESCE(営業所区分,センター区分) AS 営業所区分2,SUM(数量) AS 数量 FROM 数量テーブル GROUP BY 営業所区分2 ORDER BY 営業所区分2
これは、TwitterBrainのインストールが上手くゆかないという質問じゃありませんか？　 そのPHPプログラムの動作条件としてMySqlというデータベースが必要。PHPプログラムをサーバーに送信しるにはFTPが必要。 で、あなたは、サーバーにインストールはしたが、うまく動作しないために困った。。 で、なにがうまくゆかないのかの説明がうまく出来ていない状態です。 おそらく、売る側はポン付けで動かせるとしていると思いますが、それにはサーバーの条件ありませんか？ http://wxiaoy.com/category10/entry74.html また、PHPプログラムを改変することは許可されてますかね？
基礎からやるならやはり入門書を2~3冊読み漁るところからじゃない?
デバッグ実行とか、プロファイラとかで ②の EXECでどんなSQLを実行しているか、確認してはどうです? @colNameが COL だったとすると @preDataColはT1.COL @postDataColはT2.COL になって、②のSQLが SELECT COL As ColumnName, T1.COL AS PreData, T2.COL AS AfterData FROM T1,T2 WHERE T1.BusinessName = T2.BusinessName AND T1.COL<>T2.COL となる、ということは理解できてますか? これだと COL As ColumnName のCOLがT1.COLとT2.COLの2つの候補があるので「曖昧」だ、ということは理解できますか? 「ColumnName」という名前から推測するに SELECT 'COL' As ColumnName, T1.COL AS PreData, T2.COL AS AfterData FROM T1,T2 WHERE T1.BusinessName = T2.BusinessName AND T1.COL<>T2.COL というSQLにするつもりだったのでは? 自分で書いといてなんですが これって、SQLインジェクションの危険があります。 気を付けてください。 やはり、列名をユーザーが自由に変えられる、というのは問題だと思います。
SELECT A.BusinessName , A.Item1 AS PreData , B.Item1 As AfterData FROM T1 A , T2 B WHERE A.BusinessName = B.BusinessName AND A.Item1 <> B.Item1 UNION ALL SELECT A.BusinessName , A.Item2 AS PreData , B.Item2 As AfterData FROM T1 A , T2 B WHERE A.BusinessName = B.BusinessName AND A.Item2 <> B.Item2 UNION ALL SELECT A.BusinessName , A.Item3 AS PreData , B.Item3 As AfterData FROM T1 A , T2 B WHERE A.BusinessName = B.BusinessName AND A.Item3 <> B.Item3 ORDER BY BusinessName ASC , PreData ASC
複雑な SQL は保守性が悪くなるのでオススメできませんが、 やるとしたら select *, _ case when B.親フラグ = 1 then _ _ AA.金額 - AA.子の費用合計 _ else _ _ {算出費用の計算式} _ end from ( -- 複問い合わせで、親以外の費用合計をあらかじめ計算。子が無ければ 0 とする _ select A.PID, A.金額, coalesce(sum( {算出費用の計算式} ), 0) AS 子の費用合計 _ from A left join B on A.PID = B.FID and B.親フラグ = 0 _ group by A.PID, A.金額 ) as AA left join B on AA.PID = B.FID
PHP はまるっきりわからないので、外しているようでしたら無視してください。 接続文字列のサーバー名の所は合っていますか？ サーバー名だけで済む場合と、サーバー名に続いて \インスタンス名 とする場合があります。 SQL Server は同一サーバーにいくつもインストールすることができるため、インストールされた SQL Server 毎を区別して管理するため、それぞれのインスタンスに名前を付け区別します。 最初にインストールされた SQL Server の製品版はインスタンス名が付きません。 2つ目以降にインストールされた SQL Server の製品版にはインスタンス名を付ける必要があります。 SQL Server Express の場合は最初にインストールした場合でも強制的に SQLEXPRESS というインスタンス名が付くのでサーバー名の欄は ServerName\SQLEXPRESS となります。 外していたらごめんなさい
例えば。 重複の無いテーブル (列は 列１、列２、列３ ) で、行数を数えるなら 　SELECT COUNT(*) FROM 重複の無いテーブル になりますよね? サブクエリの使い方で、わかりやすいのは、FROM やJOINで「テーブルの代わりに」サブクエリを使うというものではないでしょうか。 　SELECT COUNT(*) FROM サブクエリ as W -- 別名を付ける サブクエリ自体は、いくつか制限があるものの、基本は「普通のクエリを()で囲ったもの」 となれば、あとはわかるのでは?
NULLの置き換えなら ISNULL が使えるはずです。 複雑なものも CASE WHEN が使えるはずです。
SQL の WHERE には、さまざまな条件式が書けます。 AND,OR, () を使って、複数の条件式を結びつけることができます。 SELECT * FROM city,town と結合したテーブルを 「 city.id=town.city_id でなおかつ city.id=? 」 という条件で抽出したければ、上記の言葉を SQLの式で表現するだけです。 WHERE city.id=town.city_id AND city.id=? また前にも書きましたが、city.id=town.city_id なのだから、INNER JOIN いいように思います。 SELECT * FROM city INNER JOIN town ON city.id=town.city_id WHERE city.id=? PHPのプログラムがどんなことやってるか、については、読むのが面倒なのでやりません。
以下のようにすれば、wp19_で始まるテーブルの一覧が「wp19_tables.txt」に作成されます。 mysql -u root -p[rootのパスワード] -N information_schema -e "SELECT table_name FROM tables WHERE table_schema=’データベース名’ AND table_name LIKE ‘wp19_%’" > wp19_tables.txt 問題は出力で、こんな感じにすれば出力出来るかも？ mysqldump -u root -p[rootのパスワード] データベース名 <wp19_tables.txt > ダンプファイル名 出来ない場合は、 mysqldump -u root -p[rootのパスワード] データベース名 wp19_tbl1 wp19_tbl2 wp19_tbl3 ・・・ > ダンプファイル名 のように出力されたtxtを参考に、テーブル名を並べて書けば出力出来ます。
連携するシート１と そのシート１を参照してレイアウトを工夫するシート２ってことでは駄目なのか？
①② その程度なら何でもよくないですか？ WindowsServer, SQLServerに拘る理由はなんでしょうか？ ③④ レンタルを無償って、あり得ないと思います。 それはつまり、部屋貸してるのに家賃いらないよってことですよ。 楽なのはAzure。 契約内容によってはレンタルサーバの料金を超えるでしょう。 共用サーバならこんなとこありますが。 http://www.winserver.ne.jp/ > 最終的にはWEB上でDB更新用サイトを限定公開したり、 > アプリを開発してANDROID端末上でDBを更新したりしたい、 自分のところから出てるグローバルIPが固定なら出来ますね。 また、WebAPIを構築しておけばAndroidアプリからの制御ということも可能でしょう。 しかし、それがWindowsServer, SQLServerでなければならない理由にはなりません。 どうしてもWindowsServerがいいというのならば、やはりAzureを選択した方がやれることが広がる分、便利かと思います。 (やらなきゃいけないことも増えます)
「sql update join」で検索するといいかも
SQL の delete 命令に join 句は使えません。 https://www.postgresql.jp/document/9.0/html/sql- … PostgreSQL ならば using 句が使えますが、 独自拡張であるし join 句とは使い方が異なるので、 in やサブクエリを使うことをオススメします。
「終了日が2015年10月14日より前」 だったら書けますか? これでも書けないなら、まずはこれができる程度にSQLの勉強をしましょう。 もしかしたら、算数や国語の勉強も必要かもしれません。 できるのなら、 「2015年10月14日」の部分を「今日」に置き換えればいいのです。 データベースにもいろいろありますが、大抵の場合、「今日」を知るための方法が用意されています。 SQL Serverのカテゴリーなので、SQL Serverのマニュアルを載せます https://msdn.microsoft.com/ja-jp/library/ms18672 … > 終了日（END_DATE）が無期限の場合はNULLも設定されている 一つはNULLかどうかの判定 END_DATE IS NULL / END_DATE IS NOT NULL と他の条件とのAND / OR とを組み合わせて、目的の条件にすることです。 もう一つは、NULLの場合は「9999/12/31とする」といった感じで置換処理です。 SQL Serverの場合は、ISNULLという関数があります https://msdn.microsoft.com/ja-jp/library/ms18432 …
最初に（）の中を評価し、その結果に対して（）の外を評価すればよいです。 SELECTとかFROMとかの単語は英語の意味のままで見れば何をしたいか意味はだいたい察しがつきますよね。:-)
>Windows8.1以降ってローカルアカウントより >マイクロソフトアカウント仕様の環境になる？かなと思うので、 それはあり得ないと私は思っているので、さっさとローカルアカウントに戻しました。MS的にはそうしたいでしょうけど。 なので深追いしてないし実際やってないけど、保険として残しておいた私的なメモから。 コレをやってみるとか。 http://121ware.com/qasearch/1007/app/servlet/rel … あるいは、「コントロール パネル」→「すべてのコントロール パネル項目」→「ユーザー アカウント」でアカウントのIDらしきものが見えるからそれを使ってみるとか。
フィールド名をF1～F4とした場合ですが、 判定: IIF([F1] In ([F2],[F3],[F4]) OR [F2] In ([F1],[F3],[F4]) OR [F3] In ([F1],[F2],[F4]) OR [F4] In ([F1],[F2],[F3]),1,null) では？
単純復旧モデルでは、トランザクションがコミットされたタイミングで自動的に解放OKのフラグがつきます。 ですので、処理は不要です。 （また明示的に対応がありません） 完全復旧モデルでは、トランザクションログバックアップを実行すると解放されます。 フルバックアップではだめです。 dbcc shrinkfileは、自動拡張したファイルサイズを縮小するために使用します。 縮小できるのは、解放可能フラグがついている場合です。 イメージ的には、 トランザクションログファイルが1GB 長いトランザクションやトランザクションログバックアップをしなかったことで、ログファイルが2GBに自動拡張。 トランザクションログバックアップをして、2GBの内解放可能な領域を解放。 2GBを1GBに戻したいときにdbcc shrinkfileを実行となります。
単純復旧モードにしていれば、コミットされたトランザクションはトランザクションログに残らず解放されます。 しかし、コミットされていないトランザクションは解放されていません。 今回のケースですと、何か長いバッチ処理がはしっていませんか？ もしくは、大量のデータを一気に更新する処理をしていませんか？ 例えば２時間かかるバッチ処理をワントランザクションで実行していると、 1時間経過して5GB使用してしまいまんぱんになることはあります。 上記のクエスチョンどちらのケースでも、DBCC SHRINKFILEしても意味がありません。 対応としては、コミット粒度の見直しか、例えばバッチ処理で必要な容量までは トランザクションログを確保するとかでしょうか。 ワントランザクションで10GBトランザクションログが必要なら、 ワントランザクションを維持するには、ログを10GBにするしかありません。 トランザクション粒度を見なおして、１トランザクションで必要な容量を 数GBにするとかでしょうか。 ちなみに以下のケースもあるので、ご注意。 １　データ更新料は少ないが、数時間かかるトランザクション ２　１０分程度でおわるがデータ更新料が多いトランザクション ３　それいがいのトランザクション １〜３の順番にトランザクションが実行されると、１がコミットされるまでは、 ２と３の分のトランザクションログは解放できないのです。
>論理更新については検索ヒットもなくよくわかりませんでした 論理削除は削除したレコードを残しておいて、後で何を削除したか 確認できるようにすることですが、論理更新では更に一歩すすめて レコードの更新を ・旧レコードの論理削除 ・旧レコードの内容を更新したものを新規挿入。 に置き換えます。つまり全ての更新履歴がDBの中に 残ることになります。金銭を扱うDBではよくやる処理方式です。 レコードは作成日付、更新日付や更新回数など、おきまりの 列をもつことになります。
> それは「レコードの移動を検出して」ということなんでしょうか。 そうです。 dataTable_RowChangedイベントで行の移動が検知可能そうです。 自前で実装するとテキトーですが、以下のようになると思います。 private void button1_Click(object sender, EventArgs e) { // DBから取得したと仮定 var dt = new DataTable(); var c = new DataColumn("column1"); dt.Columns.Add(c); c = new DataColumn("column2"); dt.Columns.Add(c); var r = dt.NewRow(); r["column1"] = "1-1"; r["column2"] = "1-2"; dt.Rows.Add(r); r = dt.NewRow(); r["column1"] = "2-1"; r["column2"] = "2-2"; dt.Rows.Add(r); // DBに応じたTableAdapterと紐づけ // BindingSourceと紐づけ var bs = new BindingSource(); bs.DataSource = dt; dataGridView1.DataSource = bs; // 行変更イベントの設定 dt.RowChanged += dt_RowChanged; } void dt_RowChanged(object sender, DataRowChangeEventArgs e) { Console.WriteLine("行の値が変更された"); // ここでTableAdapterでUpdateを行う } また、そんなことせずとも、データソースを登録しておいて、データソースを画面上へ貼りつけることにより、ほぼ動作するスケルトンが出来上がります。 それに対して、RowChangedイベントでもデータ更新するような実装を加えてしまえば、ご希望の動作をするのではないでしょうか。 大分古い、かつVB.NETですが、以下記事が参考になると思います。 http://www.atmarkit.co.jp/fdotnet/vblab/vb2005m_ … http://www.atmarkit.co.jp/fdotnet/vblab/vb2005m_ … データベースエンジンの違いは関係ありません。 勝手に違いを吸収してテーブル更新を行ってくれます。 具体的なクエリの発行内容が分からないや、何やってるかわからないなどの理由で嫌う人もいますが、好き嫌いなど度外視して構わないほどあっさり動作してくれますよ。
そもそもの話 「SQL Server2012 Management Studio」は、単なる管理ツールであってDB本体ではない それとも「Express with Tools」とか「Express」と言ったモノを、「SQL Server2012 Management Studio」と誤表記しているのだろうか？ 色々やってインストールしたとしか書かれていないので何とも言えんが・・・・
select 売上日 as 日付 , sum(case 商品 when 'A' then 数量 end) as 商品A , sum(case 商品 when 'B' then 数量 end) as 商品B , sum(case 商品 when 'C' then 数量 end) as 商品C from 売上 group by 売上日
GROUP BYのグループ化条件にCASE式を使えばいいと思います。 WITH使って1月/2月/3月以降というデータを持つ列を増やす方法もありだと思います。 ただ，条件どおりに行うと3月以降のpriceが300ではなく1200になりますが。 --- お試し ここから --- DECLARE @table TABLE ( [id] INT, [month] NVARCHAR(3), [limit] DATE, [price] INT ) ; INSERT INTO @table ( [id], [month], [limit], [price] ) VALUES ( 1, N'1月', CAST('2015-01-01' AS DATE), 100 ), ( 1, N'1月', CAST('2015-02-01' AS DATE), 100 ), ( 1, N'2月', CAST('2015-03-01' AS DATE), 200 ), ( 1, N'2月', CAST('2015-04-01' AS DATE), 200 ), ( 1, N'3月', CAST('2015-05-01' AS DATE), 300 ), ( 1, N'4月', CAST('2015-06-01' AS DATE), 300 ), ( 1, N'5月', CAST('2015-07-01' AS DATE), 300 ), ( 1, N'6月', CAST('2015-08-01' AS DATE), 300 ) ; SELECT [id] AS [id], CASE MAX([month]) WHEN N'1月' THEN N'1月' WHEN N'2月' THEN N'2月' ELSE N'3月以降' END AS [month], MAX([limit]) AS [limit], SUM([price]) AS [price] FROM @table GROUP BY [id], CASE [month] WHEN N'1月' THEN 1 WHEN N'2月' THEN 2 ELSE 3 END ; WITH temp AS ( SELECT [id], [month], CASE [month] WHEN N'1月' THEN N'1月' WHEN N'2月' THEN N'2月' ELSE N'3月以降' END AS [temp_month], [limit], [price] FROM @table ) SELECT [id], [temp_month] AS [month], MAX([limit]) AS [limit], SUM([price]) AS [price] FROM temp GROUP BY [id], [temp_month] ; --- お試し ここまで --- テスト環境 (SELECT @@VERSIONの結果) Microsoft SQL Server 2014 - 12.0.4050.0 (X64) Feb 19 2015 18:37:03 Copyright (c) Microsoft Corporation Express Edition (64-bit) on Windows NT 6.3 <X64> (Build 9600: ) (Hypervisor)
for /f "delims=" %%A in ('sqlcmd ～～～') do set A=%%A echo %A%
このサイトで解決できないのでしょうか？ https://support.microsoft.com/ja-jp/kb/2730109/ja
大変申し訳ありません。私の早とちりでした。 つい、PWも書いてあると思い込んでしまいました。 失礼いたしました。 さて、問題の件ですが、 私が回答できるのは推測の域をでませんが、 実際には、設定や手順のチェックシートを作って 全端末の確認を確実にすべきかなと思いますが 初心に戻って、 メッセージが正しいとするならば、(実は正かったという事が結構あります) ・使用している Access2000 ADP は SQL Server 2000までしか対応していない。 ・だとすると、更新できているのは SQL2000(以前のサーバー)に接続していて、 　更新できていないのは、今のSQL2014 に接続している。 という可能性はありませんか? または、Accessのプログラム更新などで途中からSQL2000以降も対応していて、 その更新がされてるかどうかで動きが違うという可能性。
とりあえずエラーメッセージでは 5行目を指摘しているので、 ,(SELECT PREF_NAME FROM PREF_TABLE WHERE ID = A.PREF_ID) AS PREF_NAME これを修正しましょう。そもそも、記述ミスですよね。 ,B.ID AS PREF_NAME と書きたかったのだと思いますが、これだとエラーでますか? エラーになるなら Group by に追加しましょう。 GROUP BY A.PREF_ID, B.ID
＞要求が失敗したか、サービスが適切な時間内に応答しませんでした SQL Server 2008 ？ 回避するには、サービス管理コンソール (Services.msc) を使用して SQL Server エージェントサービスを開始 http://support.microsoft.com/kb/955494/ja
＃１だけど、Where条件の話ね。 列見出しはDayで囲うが、1～31で並んだら、 ドラッグ＆ドロップで入れ替えて
そのテーブルのデータが入ったファイルがread onlyの属性になっていると言われているので、ファイルのパーミッション等を確認しましょう。 このあたりが参考になるのではないでしょうか。 http://d.hatena.ne.jp/susan-style/20120914/13476 …
mdfファイルをNAS上に配置したいということですよね。 OSが書かれていませんが、Windows Server 2003以外であればシンボリックリンクで出来たという事例を見たことがありますので試す価値があるかもです。 デタッチ・アタッチをする方法ですが。 mklink /d NGだったら、切り分けとしてWindowsの共有フォルダでどうなるかを確認したらいかがでしょうか。 NAS NGでWindows共有 OKならば、問題はTS-X2.0TL/R5 が対応してないということになりますね。 上手くアタッチ出来たとしてもサポートされている構成とは言いがたいので、 別の回答者さんも書かれていましたが、iSCSIを使用するのがベストな選択だと思います。 TS-X2.0TL/R5がiSCSI対応ではないところがつらいですが。
TESTしてませんし、Deleteできるかわかりませんが SELECT * FROM test1 INNER JOIN (Select * From test2 where (フローID, 更新日時) = (SELECT (フローID, MAX(更新日時) ) From test2 Group by フローID ) ) as test2w ON (test1.フローID=test2w.フローID) カッコのネスト間違えてたらゴメン。 でも、重複のあるフローIDの、MAXではなかった行はどうなるのかな？
Single()を使ってマージしてしまうとデータが実体化しますんでNGかと。 普通にFirstOrDefaultつかえば？ var dc = new myDataContext(); var language = dc.Languages.FirstOrDefault(lng => lng.Id==3); if (language != null) { language .Language = "SriLankā"; db.SubmitChanges(); } 拡張メソッド記法で申し訳ありません。
質問に質問で返すようで申し訳ないが、あなたはなぜSQL Server 2012 Express LocalDBを常時起動させておきたいのだろうか。あるいは、なぜ常時起動させておく必要があるのか。 SQL Server 2012 Express LocalDBは、クライアントからの接続要求があると自動的に起動し、接続中は動作し続け、クライアントから切断されてアイドル状態が続く（デフォルトは5分だと思う）と自動的に停止する。 この「自動起動する」がミソで、このためにSQL Server 2012 Express LocalDBは自分が不要だと判断したら勝手に終了してメモリを解放する事ができるようになっている。 どうしても常時動かし続けたいなら、必ず１つクライアントを接続しておくくらいしか手がないのでは。 それか素直にLocalDBではなくSQL Server 2012 Express Editionを選択してサービス起動するか。
他の方も書いてるようにSQLを書かないとわかりませんよ。 >パススルークエリで、INSERT／UPDATE／DELETEするという意味です。 疑問だらけですが、これをVBAでするにはその都度CreateQueryDefでクエリをAppendする必要があると思います。なぜそんな面倒なことをするのでしょうか？ 直に発行しない理由がわかりません。 さらにそれなリンクテーブルはいらないと思います。フォームなどを作るのに面倒だからという使い方はありますが、こういうことをするとリンクテーブルで開いたテーブルのロックと更新のクエリのロックがバッティングしますから当然壊れます。
こういうことでしょうか？ select S_Id , count(case C_Id when 1 then 1 else null end) Count_1 , count(case C_Id when 2 then 1 else null end) Count_2 , count(case C_Id when 3 then 1 else null end) Count_3 , count(case C_Id when 4 then 1 else null end) Count_4 , count(case C_Id when 5 then 1 else null end) Count_5 , count(case C_Id when 6 then 1 else null end) Count_6 , count(case C_Id when 7 then 1 else null end) Count_7 from Person where Z is not null group by S_Id; C_Idの種類分だけ列記しなくてはいけませんが・・
Select * From "曲名テーブル" as t1 Left Join "アーティストテーブル" as t2 On t1."アーティスト番号1" = t2."番号" Left Join "名前テーブル" as n_t1 On t2."アーティスト" = n_t1."番号" Left Join "アーティストテーブル" as t3 On t1."アーティスト番号2" = t3."番号" Left Join "名前テーブル" as n_t2 On t2."アーティスト" = n_t2."番号" Where (n_t1."名前" like '%大塚愛%' or n_t2."名前" like '%大塚愛%') 純粋にorでどちらかがhitすれば出るようにしてるだけですね。 頂いた情報をもとに書くとすればこんな感じでしょうか。 作曲者と編曲も同じようにすれば大丈夫です。
INSERT INTO TABLE_A (NAME_A) VALUES ('あいうえお') INSERT INTO TABLE_B (A_ID,NAME_B) VALUES (SCOPE_IDENTITY(), 'さしす')
SQL Server Data Toolsというツールが使えそうですがどうでしょうか。 参考URL：http://codezine.jp/article/detail/6531
> 動き的には一緒だったりしますかね…。 実行プランを見れば分かります。 http://technet.microsoft.com/ja-jp/library/ms178 …(v=sql.105).aspx SQLServerのオプティマイザは賢いので、SQLクエリを多少変えた程度では変わらないはずです。 パフォーマンス向上にはインデックスの追加が有効かもしれない。 ランクテーブルにインデックス{順位, 製品ID}を追加
なんだか誤解されるのもアレなので、連投？ながら補足させて下さい。 質問文からの推量になりますが、質問者様の社内状況としてAccess→SQLServerに変更します、ということがまだ決定もしていないんじゃなかろうか、と。とりあえず「複数人で入力をする必要が出てきた」のでその方法を探っていて、お手軽にできるんじゃなかろうか？と質問されたのだと思っています。 そこで私の回答としては、Access→SQLServerの移行って結構大変な作業ボリュームになりそうですよ、ご自分でやるのも結構大変、まして業者に頼んだところで…ということでパッケージソフトでクリアできる処理内容ならそっちの方が楽じゃないの？という内容にしたつもりです。 別にパッケージソフトの回し者ではないですけど、ある程度定型化されたシステムへの移行の方が、移行作業も今後の運用も楽になると思います。 ご健闘をお祈りしています。
FULL OUTER JOIN
>Windows認証で接続しているユーザです。 >ユーザは同じですがドメインが異なる windowsドメインって同じユーザーＩＤでも、 ドメインが異なるユーザーＩＤはまったく別のユーザーＩＤとして扱われますが。 ＤＢでもいいけど、 ファイルアクセス権限で試してみたほうが早いかな。（同じだから） ドメインＡとＢがあって、ＸというユーザーＩＤが両方にいたとして、 ドメインＡのＸに参照権限を与えてもドメインＢのＸでは参照できません。 ドメインＡのＸを消すと、参照権限はS-xxxxxみたいなのに化けてしまって ドメインＢのＸの権限などありません。 内部的には、S-xxxxxみたいなの(SID)で管理しているので、 ユーザーＩＤがいっしょかどうかという管理はしていないということです。 ということから、質問の方法でバックアップを戻すと アクセス権限がなくならないほうがおかしいってことになります。
残念ながら、秒を消すことができません。 http://msdn.microsoft.com/ja-jp/library/ms187819 …
select distinct * from ( select b as X from table_A union select c as X from table_A ) as table_B こんな感じ？ ちなみに、SQL Server 2008R2 で動作確認しています。
SQL2000 の時に似たような事例がありました。 SQL2008R2 にも同様の問題があるのかはわかりませんが、 私が経験した事例では 比較的重いクエリーを実行すると4つのCPU(2コア×2スレッド)全てで 100%の状態が数分間続き、他の処理ができない状態でした。 最終的には、SQL2000が使用する CPU を一つ減らすことで 発生しなくなりました。 マイクロソフトの推奨として SQLサーバーを DC と同居している場合には、 CPU0は DC用に空けろとしています。 (この話は講習の時に聞いただけなので、資料としてはみたことありません)
SELECT * FROM table WHERE field NOT LIKE '[0-9][0-9][0-9]-[0-9][0-9][0-9]' 参考URL：http://msdn.microsoft.com/ja-jp/library/ms179859 …
素直に UPDATE TEST_TABLE SET NAME = substring(StoreBranchName,1,len(StoreBranchName)-1) where substring(StoreBranchName,len(StoreBranchName),1) = '　' while @@rowcount > 0 begin UPDATE TEST_TABLE SET NAME = substring(StoreBranchName,1,len(StoreBranchName)-1) where substring(StoreBranchName,len(StoreBranchName),1) = '　' end とでもすれば？ と思います。 説明： 末尾１文字が全角空白なら、文字列を末尾１文字を除く文字列に置き換える。 処理結果が０件になるまで繰り返す。 なお、全角空白、半角空白と続くと、半角空白より前は削除されません。
できない http://blogs.msdn.com/b/jpsql/archive/2011/06/14 …
自分で使うなら、既存のものを使えばいいじゃないですか。 「データをエクセルのように表形式で扱いたい」：データベースはSQLServerですか。
試してないけど set @maxseq = @maxseq - 1; bulk insert test_table from 'C:\data\test.csv' with (firstrow = 1,lastrow = @maxseq,formatfile = 'C:\ImportOrg_Fmt.xml'); でうまくいくような気がする。 それでだめなら declare cmdstr as varchar(2000); set @maxseq = @maxseq - 1; set cmdstr = 'bulk insert test_table from ''C:\data\test.csv'' with (firstrow = 1,lastrow = ' + @maxseq + ',formatfile = ''C:\ImportOrg_Fmt.xml'')'; exec (cmdstr); といった感じで書く。 execは http://msdn.microsoft.com/ja-jp/library/ms188332 … 参照。
残念ながら >持ち合わせていないので 検証できる環境がありません。 識者のご登場をお待ちください。
execute('select * from [test].[dbo]' + '.[test]') ならできます。 文2では、from以下が単なる文字列となってしまっているのです。 なので、全体を文字列とみなして、executeで処理することになります。 参考URL：http://msdn.microsoft.com/ja-jp/library/ms188332 …
>「SET XACT_ABORT ON」としているので「adoCN.BeginTrans」はなくてもいいと思うのですが Set adoCN = New ADODB.Connection adoCN.Open CurrentProject.Connection adoCN.BeginTrans adoCN.Execute "exec dbo.実行ストアド" insert into アクセスのテーブル values(1) 'エラー判定 adoCN.CommitTrans とかだと、 adoCN.BeginTransとadoCN.CommitTransはなくては困るはず。 （アクセスのテーブルへのinsertがストアドの結果に関係なく実行されるから。） ということで >明確に『不要である』としている文献等、見つからなかったため は見つからないと思います。 ストアドプロシジャ内のどの命令でエラーがでているのかが不明なので （⇒これを特定するのが先のように思いますが） はっきりしたことはわかりませんが、 >このストアド内では「SET XACT_ABORT ON ～ SET XACT_ABORT OFF」としてあります のほうが問題なのでは？ ## SET XACT_ABORT ONなんて気持ち悪くて使う気にならないので使ったことはないので ## 良く分かりませんが クライアントのadoのトランザクションの中で、突然、sqlserverにトランザクション制御を 任せるような命令を出したらなにかおかしくなるようにしか思えないです。 SET XACT_ABORT ON ～ SET XACT_ABORT OFF を Begin Transaction ～ Commit にしてエラー制御をきちんと書いて、エラーならロールバックするようにしてみたら？ と思います。 （SQL Serverはトランザクションの入れ子がOKだったはずなのでbegin transactionを 　書いても大丈夫だったと思いますが、ダメならストアド側でトランザクション制御はしないとか。） ## 的外れだったらごめんなさいね。
他の方が仰るように、ソースを見ながら修正ではコストが膨大になると思います。 それよりは、どのような機能が欲しいのか整理して1から依頼した方が早そうです。 なおこのようなカスタムメイド型のツールもあるようです。 http://www.eye-brain.jp/rakuchin.html
亀レスですが参考になれば。 サイトというのが，SharePointのドキュメントライブラリーを指しているのであれば，通常は各々のライブラリーでアップロードすると思いますが，実はドキュメントライブラリーはExplorerでも開けますので，フォルダーにファイルをコピーする様にライブラリーにファイルをコピーすることができます。 操作メニューから，Explorerで開くを実行するだけで簡単に開きます。 コピー元のファイル名やコピー先のパスなど，いつも同じ状況であれば，スクリプトを作っておけば何度でも同じ事が実行できます。コピー元のファイル名が違うだけならば，ファイル名などを指定してコピーする様に作れば良いと思います。 コツは，フォルダーのパスと同じく，ライブラリーを開いたパスを使って，スクリプトを記述することでしょうか。 単発であれば，最初のファイルをコピーしておき，Explorerで開いたフォルダーに次々とペーストしていけば良いと思います。
復元時にデータファイルとログファイルの格納先を指定して変更する必要があります。
こんにちは。 イノ(inno)です。 方法はいろいろありますけど、 上記の条件のにあうSQLを作ってみました。 下記のSQLをそのまま実行してみてください。 先ずは、テーブルを作成してください。 --################################# --#### テーブル作成 --################################# --#### ユーザーテーブル CREATE TABLE dbo.TempUser ( Sn int , UserName nvarchar(100) , IsCheck bit ) --#### 当番履歴テーブル CREATE TABLE dbo.TempUserLog ( Sn int , UserName nvarchar(100) , RegDate Datetime ) ここまでがテーブル作成です。 それでは31人のユーザーデータを登録しましょう。 --################################# --#### データ登録 --################################# DECLARE @i int SET @i = 1 WHILE(@i <= 31) BEGIN INSERT INTO dbo.TempUser (Sn, UserName, IsCheck) VALUES (@i, CONVERT(varchar(10), @i) + 'さん', 0) SET @i = @i + 1 END ここまでがユーザー登録です。 では、下記のSQLを実行すると当番を計算して結果がでるようになっています。 履歴も残しています。 --################################# --#### 当番計算 --#### １度にランダムに５人ずつ当番になる。 --#### １度当番になると、全員の当番が一巡するまで回ってこない。 --################################# DECLARE @TempSelectUser TABLE ( Sn int ,UserName nvarchar(100) ) DECLARE @Sn int DECLARE @UserName nvarchar(100) DECLARE DB_Cursor CURSOR FOR SELECT TOP 5 Sn, UserName FROM ( SELECT TOP 5 1 Code, Sn, UserName FROM dbo.TempUser WHERE IsCheck = 0 ORDER BY NEWID() UNION ALL SELECT TOP 5 2 Code, Sn, UserName FROM dbo.TempUser ORDER BY NEWID() ) A ORDER BY Code OPEN DB_Cursor FETCH NEXT FROM DB_Cursor INTO @Sn, @UserName WHILE @@FETCH_STATUS = 0 BEGIN INSERT INTO @TempSelectUser SELECT @Sn, @UserName IF 0 = (SELECT COUNT(Sn) FROM dbo.TempUser WHERE IsCheck = 0) BEGIN UPDATE dbo.TempUser SET IsCheck = 0 END UPDATE dbo.TempUser SET IsCheck = 1 WHERE Sn = @Sn INSERT INTO dbo.TempUserLog SELECT @Sn, @UserName, GETDATE() FETCH NEXT FROM DB_Cursor INTO @Sn, @UserName END CLOSE DB_Cursor DEALLOCATE DB_Cursor --################################# --#### 当番結果 --################################# SELECT * FROM @TempSelectUser ここまで実行してみてください。 上記のSQLを実行するたびに当番を計算して結果を表示します。 履歴を見るには下記のSQLを実行してご確認ください。 SELECT * FROM dbo.TempUserLog ORDER BY RegDate DESC どうですか。 正常に実行されましたか。
INSERT INTO テーブル1(依頼No, 依頼日) SELECT MAX(依頼No)+100, '2013/05/13' FROM テーブル1
>間違っているかもしれませんが、ＢＣＰを使う場合。 >販売管理ＳＶ側で、ｂｃｐコマンドでバックアップファイルを作成・出力。 >ＡＤＳＶ側で、出力されたバックアップファイルを読込と言う事で宜しいでしょうか？ はい。あっています。 とはいえ、 > >お教え頂いたURLを拝見しましたが、イマイチ理解出来なかったため、最低限必要な書き方をお教え頂け>たら幸いです。 という感じでしたら、リンクサーバを使うほうがいいのかなあという気がしてきました。 http://sql55.com/query/linked-server.php ここで、SQL SERVER認証のほうをつかう。 これが難しいようなら、 下のサイトの「SQL Server Management Studio の使用」のところを見てもらう。 http://msdn.microsoft.com/ja-jp/library/ff772782 … ちょっとわかりにくいかも。 ならば、下のサイトの手順でやってみる。 http://d.hatena.ne.jp/haradago/20110125/p1 ぐらいかな。 ・・・これで引っかかるようなら、どこがわからないか、あるいは、何を入力したか 　　　返信いれてください。
2008でなければいけない理由は? 最新の2014やその前の2012ではだめなのでしょうか?
まずは、マニュアルをよみましょう。 http://technet.microsoft.com/ja-jp/library/bb510 … http://technet.microsoft.com/ja-jp/library/ms187 …
＞MSDEとMicrosoft SQL Server 2005 Express Edition Service Pack 3 エディションとしては後継になります。 せっかくなので２０１０とかにしても良いとは思います。２００５では２０００のコマンドから変更された部分もあり注意も必要ですが、２００５から後はあまり変更無いと思います。 またマネージメントツールは別でダウンロードする必要があります。これが無いと全部コマンドベースなので辛いです。
Windows 8.1 を搭載しているコンピューターに SQL Server をインストールする前に、状況に応じて、以下の最低要件を満たしていることを確認する必要があります。 SQL Server 2008 R2 Service Pack 2 以降の更新プログラムを適用する必要があります。 参考URL：http://support.microsoft.com/kb/2681562/ja
こんにちは。 イノ(inno)です。 翌月10日を取得する時は下記のようにします。 DECLARE @Today DATETIME SET @Today = GETDATE() SELECT CONVERT(CHAR(7),DATEADD(MM,1,@Today), 111) + '/10' これが一番簡単です。 @TodayにDATEADD(MM,1,@Today)をして翌月に移動します。 CONVERTを利用して'yyyy/MM/dd'形式に変換して前から7文字を切り取ります。 その後に'/10'をつけて'yyyy/MM/dd'に変更します。 上記の方法はSQL SERVERの全バージョンから使えます。 SQL SERVER 2012ならば「EOMONTH」を使って下記のように記述して取得することができます。 SELECT DATEADD(day, 10, EOMONTH(GETDATE())) 「EOMONTH」はSQL SERVER 2012以上から使えます。
　解りやすいのは、with句を利用して、ROW_NUMBER列を形成し、本体select文側で、ROW_NUMBER列に対して条件付けしてあげることかな。 　例えば・・・ WITH JYUNITUKI AS (SELECT RETU1,RETU2,RETU3, 　　　　　　 ROW_NUMBER() OVER ( ORDER BY RETU1) AS ROWNUM 　　　FROM TABLE1 WHERE 条件いろいろ) SELECT RETU1, RETU2, RETU3 FROM JYUNITUKI J WHERE J.ROWNUM　BETWEEN 50 AND 100 　とかですね。
副問い合わせを使って「テーブルAのTOP10を抽出したもの」とテーブルBを外部結合したらどうでしょうか。 SELECT AA.列名, テーブルB.列名 FROM (SELECT TOP 10 列名 FROM テーブルA) AA LEFT OUTER JOIN テーブルB ON (結合条件) このようにFROM句の後に()をつけてSELECT文を記述すると、そのSELECT文の結果を一つの表（ビュー）として扱えます。
SQL Serverのエディションにもよりますがクライアントアクセスライセンスがクライアント数分必要になります。 参考URL：http://www.microsoft.com/ja-jp/sqlserver/2012/ho …
#1 です。 補足に書かれた 「ログファイルではなくて、トランザクションログのフォルダについての質問になります。 」 の意味が良くわかりません。 ちなみに、質問文には「Logファイル」は有っても「トランザクションログ」とは書いてありません。 insert処理でLogファイルに書きこまれるのはトランザクションログです、 そして、トランザクションログは各データベースのログファイルに書かれます。 なので、データベースのログファイルについた書いたつもりですが 質問者の認識と異なる部分があるのかもしれません。 とりあえず書けば (1) 新規にデータベースを作成する場合には 　「サーバーのプロパティ」の「データベースの設定」にある 　「データベースの規定の場所」に設定されているフォルダが 　デフォルトのフォルダーになります。 　実際にデータベースを作成する際にそれを変更することも可能です。 (2) 既に作成されたデータベースについては、当然、あとから(1)を変更しても変わりません。 　「データベースのプロパティ」の「ファイル」にデータベースファイルとログファイルの一覧があります。 　これを変更したい場合は少し注意というか正しい手順で行う必要があります。 　マニュアル等を確認して行ってください。 あとはなんだろ？ 「SQL Server ログ」のことかな? これは、SQLサーバーをインストールした場所から変更できそうに無いですね。 インストール時に好きなところへ指定できるかは、少し調べてみないとわかりません。 でも、データの更新があったからといって、このログが書き込まれるわけでは無いので、 実際に、このログが頻繁に書き込まれているとするなら、他にエラーとかの原因が考えられます。
こんにちは。 あぁ。空白が入っていましたね。 下記のように-1をしてください。 Ltrimを使うよりいいです。 DECLARE @Str VARCHAR(100) SET @Str = 'abc 123 xyz' SELECT RIGHT(@Str,CHARINDEX(' ',REVERSE(@Str))-1) SET @Str = 'abcxcvzx 123456 xyzsdf' SELECT RIGHT(@Str,CHARINDEX(' ',REVERSE(@Str))-1) また下記の質問の件ですが、 >> CHARINDEXで検索文字列を「123」とすると結果が得られ >> ないのですが、REVERSE関数により反転してしまっている >> からですか。 そうですね。REVERSE関数により検索ができなかったからです。 どんなデータでどんなデータを得られたいかをもっと詳しく教えて頂ければ、 答えするのに助かりますが。。。 よろしくお願いします。
こんにちは。 下記のようにsubstringとcharindexを使えばできます。 例文を作成しましたので、下記のSQLを実行してみてください。 DECLARE @Str nvarchar(100) SET @Str = N'こんにちは。山田です。会員番号123456です。ありがとうございます。' --#### 結果 SELECT SUBSTRING(@Str, CHARINDEX('会員番号', @Str), 10) SET @Str = N'こんにちは。会員番号561257です。' --#### 結果 SELECT SUBSTRING(@Str, CHARINDEX('会員番号', @Str), 10)
SQL Server はインストール時にその辺の必要な環境をチェツクしてダメならインストールを中止し、何が足りないかを知らせます。 ですからまずはインストーラーを走らせるのがいちばん早いです、
デバッグ時の環境と、サーバーマシンで動作させようとしている環境との 違いを確認してください。 何が同じで何が異なるのか？ 特にDBサーバーは同じか? ドメイン環境か? SQLサーバーへのアクセス時のログインは SQLサーバー認証かWindows認証か? を書いてください。 質問をざっと見た感じでは アクセスしているDBサーバーが異なるか、 ログインユーザーが異なるか のどちらかだと想像します。
クライアントツールに関しては製品版もExpress版も同じですので特に問題は有りません。サーバーのインストールに関してはSQL Server2005 Expressもインストールされているようですので、デフォルトではインストールは出来ません。2005Expressをアンインストールするか、アンインストール出来ない場合はインスタンス名を変更してインストールして下さい。通常のインストールではSQLEXPRESSがデフォルトのインスタンス名ですので2005で既に使われているはずです、別の名前に変更すればインストール出来ます。
詳細な情報が無いので、 「できますよ」としか言えませんが、 注意として、create view するユーザーは 元テーブルへのアクセス権限が必要です。
一般論として 一番考えられるのがコンパイルが動作する場合ですね。 ストアドプロシャを修正後 最初の実行はコンパイルされるので、少し時間がかかります。 二回目以降は速くなります。 質問の内容からこのケースに該当するかどうかは不明ですが、 コンパイルされる条件は他にもいくつかあるようです。 以下も参考にしてください。 http://engineermemo.wordpress.com/2013/08/02/%E3 …
「rooms.idが重複しないもののみ抽出」 ということなので、重複しているrooms.idのレコードは１件も出したくないのなら、 SELECT max(R.updated_at), R.id, max(R.public), max(M.room_id), max(M.sendfrom_list_id), max(M.sendto_list_id), max(M.body) FROM messages AS M, rooms AS R WHERE R.public = "t" AND M.room_id = R.id GROUP BY R.id HAVING count(*) < 2 ORDER BY R.updated_at DESC; ででると思うけど ・・・blobとかの型（つまりmax()を使えない型）の項目があればだめですが。⇒別のやり方有り。
>結果NULLが返されるのはなぜでしょうか @結果＝@結果＋@会社名 最初の@結果か、いずれかのレコードの@会社名に Nullが１つでもあれば、Nullになりますが。 @結果＝ 'ABC' + null は、 @結果がnullになります。
答えやすい質問から・・・ 　・基本的には前日のデータに戻すような対応をする契約です 　 　　これで問題ないのであれば、完全バックアップモードから 　　単純バックアップモードへ設定変更してしまうことが一番手っ取り早く 　　以後の運用設計や運用が楽になります。 　　その代わり、障害が発生した場合には必ず最後の完全バックアップを 　　とったタイミングまで巻き戻ってしまいます。 　・ログファイルのバックアップは上書きしていき、 　　データの完全バックアップのみNヶ月分残すというような運用でも 　　問題なく復元できるのでしょうか？ 　　問題ありません。 　　厳密に言うと、最後にフルバックアップをとってから、次のフルバックアップを 　　とるまでの間のトランザクションログバックアップがあれば問題ありません。 で、いろいろ考える前に急がば回れの典型例になっていますので、 落ち着いて次の自習書を読むことをお勧めします。 http://go.microsoft.com/?linkid=9820534
WHERE条件に「全ての列がNullで無い」を指定したら、personal_idを網羅できますか？ 同一ｉｄで複数行出てこないなら、そこから取得する。 複数行出るなら、Topキーワード使って一行に絞れば良さそう。 updateのwhere条件には、更新対象列 is Null入れとけば良いし。
Viewとなると、正直提示された情報だけでは原因特定は厳しいので、 まずは実行計画を確認してみると良いかと思います。 後はもう少し情報を増やす意味で次のオプションをつけてみるのもいいかと。 ----- set statistics io on set statistics time on set statistics profile on go <調査したいクエリ> go set statistics profile off set statistics time off set statistics io off go -----
三つも五つも変わらないのでは？ まず作成したクエリを出しましょう。
テーブルは2列だけどインポートファイルは4列あるというエラーですね。 列の定義確認してください。
文字列型の数値変換ですか？ 意味不明です。 数字自体、文字列ではないので。 数値型からデートタイムに変換するべきことです。 私自身よく出来た話です。 文字列型から、デートタイムに変換すると yyyy/m/dなら出来ますが、 yyyy/mm/ddに変換は不可能です。 数値型でもキー入力で数字に変換されますから、 他のウェブサイトで拝見したほうがよろしい。 楽天市場の買い物の数値型も。
こんにちは。 下記のようにしてみてください。 -- #### テーブル作成 CREATE TABLE dbo.TempData ( ID int , Code1 varchar(10) , Code2 varchar(10) , Code3 varchar(10) , Val1 int , Val2 int , Val3 int ) -- #### テストデータ登録 INSERT INTO dbo.TempData SELECT 1, 'A1', null, null, 1, null, null UNION ALL SELECT 2, 'A1', 'Z1', null, 2, 1, null UNION ALL SELECT 3, 'B1', 'A1', null, 1, 1, null -- #### データ確認 SELECT SUM(CASE WHEN Code1='A1' THEN Val1 ELSE 0 END) AS Val1, SUM(CASE WHEN Code2='A1' THEN Val2 ELSE 0 END) AS Val2, SUM(CASE WHEN Code3='A1' THEN Val3 ELSE 0 END) AS Val3 FROM dbo.TempData WHERE Code1='A1' OR Code2='A1' OR Code3='A1'
WHERE CHARINDEX('人間', naiyou) BETWEEN 0 AND CHARINDEX('第二章', naiyou + '第二章')
＞としないのには、トラフィックの問題以外に何か理由があるのでしょうか？ フィールドの並び順が「予期せぬ結果」になるからです。 例えば、最終的な抽出結果を「項目名が１行目に付かない、CSVファイルに落とす場合」を考えてみましょう。 CSVになった段階で「１番目の項目が何、２番目の項目が何、３番目の項目が何」と言う情報は失われます。 もし、誰かが、大元のテーブルのIDフィールドとuserフィールドを「逆の順番に並び替えた」とします。 SELECT * FROMだと「抽出結果が、１番目の項目がIDで、２番目の項目がuserである」と言う保証はありません。誰かが元テーブルのフィールドの順番を入れ替えてしまったかも知れません。 入れ替えたのを知らずに、そのままCSVファイルに落としてしまうと、「１番目の項目が何、２番目の項目が何」と言う情報は失われているので、想定外のCSVファイルが出来上がってしまいます。 SELECT ID, user FROMなら「抽出結果が、１番目の項目がIDで、２番目の項目がuserである」と言う事が保証されます。誰かが元テーブルのフィールドの順番を入れ替えても、結果は変わりません。 結果のフィールドの並び順が保証されるので、そのままCSVファイルに落としても、想定通りのCSVファイルが得られます。 SELECT文で「すべての項目が全部並べて書いてあって、抽出条件も何もなしで、全レコードを返している場合」がありますが、このSQL文の意味は「結果のフィールドの並び順を固定するため」なので、安易にSELECT * FROMに書き換えると、思わぬ所でバグを産んで、痛い目に遭います。
No.2です。 不確かですがCOBOLでROWCOUNTは使えなかったような気がするので… SELECT COUNT(*) INTO :ホスト変数 FROM テーブル名 DISPLAY ホスト変数
SELECT tbl_1."請求ID" , tbl_1."請求先名 " , (Select 　　　　　　' ' + tbl_3."商品名" + "*" + "個数 " From "注文TBL" tbl_2 Left Join "商品TBL" tbl_3 On tbl_2."商品ID" = tbl_3."商品ID" WHERE tbl_1."請求ID"= tbl_2."請求ID" For_XML_Path('')) as "商品名" FROM "請求TBL" tbl_1 こんな感じだったかな～。コード検証はしていません！ For_XML_Pathで言うならば文字列の結合GroupByになったはずです。 MySQLでいう、group_concat関数ですね。
グラフィカル実行プランの表示 (SQL Server Management Studio) http://technet.microsoft.com/ja-jp/library/ms178 …(v=sql.105).aspx 同じ実行プランであれば、差はありません。
SQL分の効率分析ツールなら、SQL Server Profilerを勧めます。 スタートー＞すべてのプログラムー＞Microsoft SQL Server 2008ー＞パフォーマンスツールー＞SQL Server Profiler 新しいトレースを作成して、実行すると、SQL文のパフォーマンスを見ることができます。 ご参考になれればと思います。
Access MDB からの移行というのであれば、Access ADP + Microsoft SQL Server が最も簡単かと。 http://oshiete.goo.ne.jp/qa/7439684.html
GROUP　BYを行う項目の型はなんでしょう？ char(3) ’1△△’と’1△’は同じ （’1△’を格納していても、’1△△’となるため） varchar(3) ※Oracleではvarchar(3) ’1△△’と’1△’は別 ※ ’△△1’と’1△’が同じとみなされる？ ⇒暗黙の型変換がされてしまって数値に変換されている気がします。。。 SQL Server2000で試す環境がないので、はっきりしたことはわかりませんが。 ・・・項目としているけど実はConvert関数を使っている関数式とかならかなりあやしい。
販売管理システムだけであれば特に問題はありません。将来拡張した時点で必要であれば有償版にされれば良いと考えます。制限としてはCPUは１ソケットまたは４コアですのでクアッドコア以上のCPUのマシンを使えば４スレッドまで動かせます。メモリが最大１GBですが３２BitOS自体が最大４GB（内ユーザー領域2GB）であった時代でもそこそこ動いていたので、さほど問題にはならないと考えます。データベースは最大４GBですが、１データベース単位なので、１テーブルの容量が4GBを超えない限り、複数のデータベースに分散して持てば回避可能です。
こんにちは。 下記のSQLを利用して簡単にバックアップすることができます。 DECLARE @Path nvarchar(200) DECLARE @DBName nvarchar(100) DECLARE @FileName nvarchar(100) DECLARE @FullFileName nvarchar(500) SET @Path = 'D:\backup' -- バックアップファイルを保存する経路 SET @DBName = 'master' --バックアップしたいデータベース名を記入 --　経路設定 SET @Path = @Path + N'\' + @DBName -- フォルダー生成 EXECUTE master.dbo.xp_create_subdir @Path --　ファイル名 SET @FileName = @DBName + N'_Backup_' + CONVERT(VARCHAR(10), GETDATE(), 120) + +N'_' + LEFT(REPLACE(CONVERT(VARCHAR, GETDATE(), 108),':','-'),5) --　経路 + ファイル名 SET @FullFileName = @Path + N'\' + @FileName + N'.bak' -- バクアップ実行 BACKUP DATABASE @DBName TO DISK = @FullFileName WITH NOFORMAT, NOINIT, NAME = @FileName, SKIP, REWIND, NOUNLOAD, STATS = 10 修正が必要なところは下記の２つです。 SET @Path = 'D:\backup' -- バックアップファイルを保存する経路 SET @DBName = 'master' --バックアップしたいデータベース名を記入
こんにちは。 どんな方法でバックアップを行ったかは分かりませんが、 普通にバックアップを行うと「bak」,「trn」拡張子で作成されます。 「mdf」,「ldf」のファイルがありましたら、「ATTACH」で復元することができます。 利用方法は下記のとおりです。 CREATE DATABASE [データベース名] ON ( FILENAME = N'D:\SQL_Data\DBFileName.mdf' ) ,( FILENAME = N'D:\SQL_Data\DBFileName_log.ldf' ) FOR ATTACH GO 例えば、データベース名が「LogDB」だとしたら CREATE DATABASE LogDB ON ( FILENAME = N'D:\SQL_Data\LogDB.mdf' ) ,( FILENAME = N'D:\SQL_Data\LogDB_log.ldf' ) FOR ATTACH GO こんな感じになるかと思います。 FILENAMEのパスは正しく入力してください。 またUSBにあるファイルをサーバーにコピーしてからご利用ください。 上記のパスにUSBを指定してしまうと復元するデータベースがUSBと繋がってしまいますので、ご注意ください。
一般にいわれるレンタルサーバじゃ無理と思いますが。 接続文字列の中でポート番号を書きますが（書かなければデフォルトのポート番号使用。） このポート番号が、WebブラウザとAccessやVBで使うODBCやADO(ADO.Net)etcで違っていて 一般にいわれるレンタルサーバでは、Web経由のアクセスしかできない設定のはず。 普通、サーバ側のポート設定などさせてくれないし、設定できても、 ファイアーウォールを通過できないとかになりそうです。 とややこしいことは置いておいて、お望みのことは、 ホスティングサービス、とかクラウドサービスとか呼ばれるサービスを探してください。 ま、レンタルサーバ業者もやってますので、レンタルサーバで探して、ホスティングやクラウドの 項目を見るということになると思います。 これらは条件がまちまち。業者毎に違うと思ってもいいと思います。 で、設定は逆に、社内ＬＡＮにサーバを置いているのとほとんど一緒。 単に接続するIPアドレスが替わるだけ、といったパターンもあります。 （クラウドのPaasやホスティング） 但し、ＯＳやデータベースはこちらで用意するという条件になるかもしれません。 また、サーバの設定などもこちらということになるでしょう。 （通常のサーバへの導入とほぼ同じ手順を、特定のツールかリモートデスクトップ接続で接続した 　サーバに対して行います。ＣＤ－ＲＯＭとかは、大抵、クライアントに接続されている装置を使う。 　業者ごとにまちまちかもしれません。） クラウドのSaasなら、データベースまで業者持ちというのもあるのかもしれませんが、 こうなるとサーバの設定は業者側がしていて変更不可。 接続文字列とかに制限（ポート番号はこれ、とか）がついてくるかもしれません。 ちなみに、ネットワークはVPN(仮想プライベートネットワーク)にして外部とつながない、 （外部とつなぐなら、HTTPとか別の方法を使うべき） とかにしておかないと不正侵入されて大変困ったことになります。
SELECT C1, ( CASE MIN( CASE C2 WHEN 'R' THEN 1 WHEN 'P' THEN 2 ELSE 3 END ) WHEN 1 THEN 'R' WHEN 2 THEN 'P' ELSE 'S' END ) AS C2 FROM Table1 GROUP BY C1 ORDER BY C1
動的SQL http://stackoverflow.com/questions/5019041/how-t …
こんにちは。 下記の私の回答に少し間違いがありました。 「root139」さんの回答が正しいですね。 大変失礼いたしました。 よろしくお願い致します。
SQL Server 2005 Express は、Vistaまでのようです。(正式サポートは) http://technet.microsoft.com/ja-jp/library/ms143 …(SQL.90).aspx Windows7で利用できるのは、2008以降のようですね。 http://technet.microsoft.com/ja-jp/library/ms143 …(v=sql.100).aspx > もし対応していたとしても新しいExpress Editionに変えた方が良いでしょうか？ SQL単体での利用であれば、新バージョンの方がOSとの適合と言う点で推奨しますが、、 大抵はSQLを利用しているアプリケーション側に大きく依存する事となると思いますので、そちらの方の確認を。
実際に使ったことがないのであまり自信がないのですが、Access オブジェクトの SQLServer への移行にMicrosoft SQL Server Migration Assistant (SSMA) for Access というツールが使えるようなことが書いてあります。たしかクエリも Access オブジェクトの一種でしたよね。試してみてはいかがでしょうか。 SQLServer 関連ソフトウェアのダウンロードページ（SSMA for Access へのリンクあり）： http://www.microsoft.com/ja-jp/sqlserver/2012/do … SSMA for Access の使い方（英語）： http://blogs.msdn.com/b/ssma/archive/2011/01/29/ …
CASE WHEN @D = 0 THEN (dbo.TEST.D = dbo.TEST.D) '全データを WHEN @D = 1 THEN (dbo.TEST.D = 1) '値が1のデータを WHEN @D = 2 THEN (dbo.TEST.D = Is Null) 'データがNull のものを ↓ ((@D = 0 AND dbo.TEST.D = dbo.TEST.D) OR (@D = 1 AND dbo.TEST.D = 1) OR (@D = 2 AND dbo.TEST.D = Is Null) ) とした方がよいかと思います。
パスワードはいれましたでしょうか？ 15247ってことは、古いパスワード部分をnullというか空白状態で有効にしようとされていません？ 混合モードで指定したsaパスを古いパスワードにいれて、それとは違うパスワードを新のほうにいれてみたらどうなるでしょうか？ あと、15247はsysadminが付与されてないユーザで操作されているのかな？ という印象を受けます。 こんな回答となってしまいますが、申し訳ない。
Q_Data の定義に問題があると思います。 キーが１対１になっているクエリーは読み取り、更新とも可能ですが、 １対多ならば読み取りのみ可能となります。 Select * from Q_Data でレコードの重複がないかどうかを確認してください。 　
こんにちは。 方法として２つの案を準備しました。 まずは下記のSQLを実行して質問に書いてあるテストデータを準備します。 -- #### テーブル作成 CREATE TABLE dbo.TestData ( LogDate date , Data1 nvarchar(10) ) GO -- #### テストデータ登録 INSERT INTO dbo.TestData SELECT '2013-08-01', N'ああああ' UNION ALL SELECT '2013-08-03', N'いいいい' UNION ALL SELECT '2013-08-06', N'うううう' GO -- ################################################ -- #### 方法１：毎回日付テーブルを作成する。 -- #### 短所があり、パフォーマンス的に悪いです。 -- ################################################ DECLARE @StartDate datetime, @EndDate datetime SET @StartDate = '2013-08-01' SET @EndDate = '2013-08-10' DROP TABLE #TempDate CREATE TABLE #TempDate ( ComDay date ) DECLARE @i int SET @i = 0 WHILE (@i <= DATEDIFF(DD, @StartDate, @EndDate)) BEGIN INSERT INTO #TempDate (ComDay) VALUES (DATEADD(DD, @i, @StartDate)) SET @i = @i + 1 END SELECT A.ComDay, ISNULL(B.Data1, '') Data1 FROM #TempDate A LEFT OUTER JOIN dbo.TestData B ON A.ComDay = B.LogDate ORDER BY A.ComDay -- ################################################ -- #### 方法2：日付テーブルdbo.tComDayを作成しておいて使う。 -- #### おすすめする。 -- ################################################ SELECT A.ComDay, ISNULL(B.Data1, '') Data1 FROM dbo.tComDay A LEFT OUTER JOIN dbo.TestData B ON A.ComDay = B.LogDate WHERE A.ComDay BETWEEN @StartDate AND @EndDate ORDER BY A.ComDay 上記の方法１と方法２の実行結果 ComDayData1 2013-08-01ああああ 2013-08-02 2013-08-03いいいい 2013-08-04 2013-08-05 2013-08-06うううう 2013-08-07 2013-08-08 2013-08-09 2013-08-10
読ませていただくと、2がベストと思われます。 Webシステムにすることによって、SQL処理は本社のサーバーで実行され、結果がWebベースのテキストで飛んできます。 データーベースが一カ所のため、整合性にも問題ないですし、やり取りは結果のテキストだけですので、VBベースのシステムに比べるとかなり速くなると思われます。 ただ、インターフェイス面でVBのような手の込んだ処理が出来ないことがありますので、利用者から別の文句が出る可能性があります。 また、開発元ベンダーさんも実績が無いとのこと、そうなると、他の案ですが、 > 4.SQL Serverを各拠点に立て、ミラーリングする >（マスタや採番は一元化管理が必要です。データの整合性を保つのが困難な印象で、 > 4より1か2か3の方が良いシステム構成かと思います） マスタはそんなに頻繁に更新されるものでしょうか？ 採番は、絶対に連番でないと困るのでしょうか？ そのあたりを考え直すと、ミラーリングでも十分実用的になりますし、速度もほぼ本社並になることでしょう。 合わせて、緊急時のバックアップにも使えます。 ベンダーさんにその辺りのノウハウを持っていないか、聞いてみてはいかがでしょうか？ ターミナルサーバー、MetaFraame(Xen Desktop)、Horizon View、同じようなものですが、拠点側での同時利用者がどれぐらいの規模かによって、構成が決まります。サーバーにそれなりのコストがかかるのと、クライアントとして動かす中のOSのライセンスが結構ネックになります。 最後にあまり期待できないかもしれませんが、WAN高速化装置(アクセラレーター)と言われるものがあります。 http://www.itmedia.co.jp/enterprise/special/0706 …
こんにちは。 LEFT OUTER JOIN と　INNER JOIN は少し差があります。 下記のSQLを実行して確認してみてください。 CREATE TABLE #TempTableA ( Idx int , DataA varchar(10) ) CREATE TABLE #TempTableB ( Idx int , DataB varchar(10) ) INSERT INTO #TempTableA SELECT 1, 'A' UNION ALL SELECT 2, 'B' UNION ALL SELECT 3, 'C' UNION ALL SELECT 4, 'D' INSERT INTO #TempTableB SELECT 1, 'Z' UNION ALL SELECT 2, 'Y' UNION ALL SELECT 4, 'X' UNION ALL SELECT 5, 'V' 上記のSQLを利用してテーブル作成とデータを登録します。 その後、LEFT OUTER JOIN　でIdx値が３のデータを抽出してみます。 SELECT A.Idx, A.DataA, B.DataB FROM #TempTableA A LEFT OUTER JOIN #TempTableB B ON A.Idx = B.Idx WHERE A.Idx = 3 結果は下記のとおりです。 1件のデータが出ます。 ですが、#TempTableBテーブルにはIdxが3のデータがないのでnullのデータで表示されます。 IdxDataADataB 3CNULL 今回は、INNER JOINで実行してみます。 INNER JOINは両方のテーブルにデータが存在しないとデータが表示されません。 SELECT A.Idx, A.DataA, B.DataB FROM #TempTableA A INNER JOIN #TempTableB B ON A.Idx = B.Idx WHERE A.Idx = 3 ですので、1件も表示されません。 LEFT OUTER JOIN と　INNER JOINはこの差がありますので、 注意して適当なSQLを利用する必要があります。
こんにちは。 MSSQLサーバーのテーブルで最新でInsertした直後に、そのレコードを削除して、 再度Insertした時のIDENTITY列の値はその前にInsertした時に使用された値が 再度使われることはありません。 手動で設定し直す限り。 #### Identityを設定する方法 テーブルを「デザイン」で開いてIdentityで設定するカラムを選択すると 【例のプロパティ】に「Identityの設定」があります。 スクリーンショットのように画面が見えない場合は、 「IDENTITYの設定」前にある「+」マークをクリックすると スクリーンショットのように表示されると思います。 そこで「(idである)」項目を「いいえ」から「はい」に変更すると設定は終わります。
HKEY_LOCAL_MACHINE です。 ＃　先の質問で「媒体」求められた経緯といい、 ＃　以前に製品版をインストールしたことがあるのなら ＃　もう少し違う操作が必要かも。
> win764bitにMicrosoft SQL Server 2008をインストールしたいです。 > それとも何かＣＤ－Ｒが必要なのでしょうか？ 製品版なら媒体が必要です。 SQL Server 2008がExpressなら、ダウンロードしたファイルを指定する。
いずれにせよ、ブラウザに認証ダイアログが表示される(IISが401を返す？)のと、データベースの話は直接の関連はないでしょう。 IIS側の動きを調査 →IISのアクセスログ ASP.NETの動きを調査 →trace.axd http://www.atmarkit.co.jp/fdotnet/dotnettips/040 … ブラウザ側の動きを調査 →HTTPモニタソフト(Inetspy/横取り丸など)
>SELECT * FROM DDD WHERE B = (SELECT B FROM DDD WHERE C=1) SELECT * FROM DDD WHERE B in (SELECT B FROM DDD WHERE C=1) だったらできるんじゃないかな～
タスクマネージャのプロセスには現れていない。 プログラムの追加と削除にも無い。 ならアンインストール時に消し損ねたので レジストリから削除すればよいかと。 サービス一覧の中で、SQL Server(YAYOI) をダブルクリックすると 全般タブ中に サービス名 ○○○ 表示名 SQL Server(YAYOI) 後略・・・ となっているハズです。 コマンドプロンプトを立ち上げて sc delete "○○○" でEnter。 SQL Server Agent(YAYOI) も同様に。
TCP/IPのポート 1433 を閉塞しているとか？ 参考URL：http://support.microsoft.com/kb/287932/ja
case式を使って、 select YEAR("日付") as yere,MONTH("日付") as month,sum(case when "収支名" = '収入' then "金額" else "金額" * -1 end) as "差" from 収支 group by YEAR("日付"),MONTH("日付") こんな感じでどうでしょうか。 "収支名"には'収入'・'支出'しかない前提です。
バックアップではなく、復元ですよね。 なら、復元元と復元先が逆ではないでしょうか？
ワークグループ環境で動作する SQL Server をドメインに参加させる場合でも、 再インストールは必要ありません。 ドメイン参加後、ドメインユーザーで SQL Server を管理したり、接続する場合は SQL Server の「ログイン」にドメインユーザーを追加して適切なロールを設定する 必要があります。 データベースエンジンサービスや Agent サービスのサービス開始アカウントを ドメインユーザーにする場合も、再設定が必要です。 これはSQL Server 構成マネージャーなどから行います。
メリット 検索が早くなる デメリット 更新や挿入の処理に時間がかかる ディスクやメモリをたくさん喰う RAMが少なくてテーブル数やデータ量が多いとスワップアウトするので検索が遅くなる RDBMSがインデックスの効率が悪いと判断したらインデックスを使用しないので資源の無駄遣いになる
＞32bitと64bitの両方がサポートされたSQLEXPR_JPN.EXE これは32 ビットと 64 ビット (WOW インストール) 64ビットネイティブはSQLEXPR_x64
謎のおまじない http://www.atmarkit.co.jp/bbs/phpBB/viewtopic.ph … http://ameblo.jp/gurizou/entry-11287297746.html
＞DB名、ID、パスワード、ホスト名、ポート番号、MySQLのバージョン5.0.90 ＞[Microsoft][ODBC SQL State: '08001' SQL Server エラー: 6 [Microsoft][ODBC SQL Server Driver][TCP/IPSockets]指定された SQL Server が見つかりません。 --- 先方から指定のあったMySQLと、質問者様がお使いのODBCドライバーに互換性がありません。 Microsoft SQL Server はマイクロソフトの製品であり、MySQL は現在はオラクルがライセンスを管理しています。 MySQL に接続するなら、MySQL のODBCドライバーを使用してください。 MySQL用のODBCドライバを入手する方法。 http://mysqlweb.net/s/article/61906902.html
andとorで記述できます。 select * from table1 where @jouken = 0 and field1 = 1 or @jouken = 1 and (field1 = 1 or field2 = 1) or @jouken = 2 and (field1 = 1 or field2 = 1 or field3 = 1)
select * from テーブルA union select * from テーブルB order by あるカラム; で出来る思いますが、セレクトされるカラムがunionの前後で同じでなくてはいけませんので、テーブル構造に違いがあるのであれば　＊　ではなくカラム名を書き出してセレクトするカラムを指定してください。
Date と Name が同一のレコードが複数在る場合や、同一のDateに a だけが存在して b, c が無い場合などはどういった値になれば良いのでしょうか？ 仮に Date と Name が同一のレコードが複数有る場合は最大の値、特定の Name の値が無い場合は null になるとすると、下記の様なSQLで取得できるでしょう。 SELECT Date, MAX(CASE WHEN Name = 'a' THEN Value ELSE NULL END) AS a, MAX(CASE WHEN Name = 'b' THEN Value ELSE NULL END) AS b, MAX(CASE WHEN Name = 'c' THEN Value ELSE NULL END) AS c FROM tbl GROUP BY Date; この様に CASE 式と集約関数を組み合わせは非常に便利です。 下記のページが参考になるでしょう。 http://codezine.jp/article/detail/404?p=2 http://codezine.jp/article/detail/751?p=1
一括でインポートするのが吉 http://nasunoblog.blogspot.jp/2012/05/sql-server …
＞"N002"のグループ内に"N"が存在したら"P"に置換したいです。 を「B_NOのグループ内に'P'が存在したら'P'に置換」と解釈しました。 SELECT REC_NO, B_NO , CASE WHEN 'P' IN (SELECT [TYPE] FROM Table1 x WHERE SUBSTRING(x.B_NO, 1, 4) = SUBSTRING(a.B_NO, 1, 4) GROUP BY [TYPE],SUBSTRING(B_NO, 1, 4)) THEN 'P' ELSE [TYPE] END [TYPE] FROM Table1 a
元データの件数はどのくらい？ 2000万行あるうちの100万行と、101万行のうちの100万行だと違う方法がありそう。
共用サーバーで100MBのDBというのがあまり想像できませんが、数MBであっても負荷が掛かるようなSQLを実行すれば制限を受けたり追い出される可能性があります。実際に停止され専用サーバーに移った事があります。 最近では専用サーバーも3千円台からあるようです。 基本的に共用サーバーの負荷許容量は公表されていません。100MB級のDBを扱う予定があるのでしたら最初から専用サーバーにしてしまうのも手かと思います。
残念ながらSQL Serverの機能としては提供されていません。 プログラムの実装側で対応する必要があります。 今回のケースですとVBで、タイムアウトとリトライを作りこむしかないかと思います。
社員テーブル１～3があると仮定した場合、以下のSQLで実現可能です。 SELECT NES.会社名 ,SUM(NES.訪問回数) AS 訪問回数合計 ,SUM(NES.単価) AS 請負費合計 FROM( --社員テーブルその1 SELECT TEST11.会社名, SUM(TEST2.訪問回数) AS 訪問回数, SUM(TEST2.訪問回数 * TEST2.単価) AS 請負費 FROM TEST11 RIGHT OUTER JOIN TEST2 ON TEST11.訪問日 = TEST2.訪問日 AND TEST11.区分コード = TEST2.管理番号 GROUP BY TEST11.会社名 UNION ALL --社員テーブルその2 SELECT TEST11.会社名, SUM(TEST2.訪問回数) AS 訪問回数, SUM(TEST2.訪問回数 * TEST2.単価) AS 請負費 FROM TEST11 RIGHT OUTER JOIN TEST2 ON TEST11.訪問日 = TEST2.訪問日 AND TEST11.区分コード = TEST2.管理番号 GROUP BY TEST11.会社名 UNION ALL --社員テーブルその3 SELECT TEST11.会社名, SUM(TEST2.訪問回数) AS 訪問回数, SUM(TEST2.訪問回数 * TEST2.単価) AS 請負費 FROM TEST11 RIGHT OUTER JOIN TEST2 ON TEST11.訪問日 = TEST2.訪問日 AND TEST11.区分コード = TEST2.管理番号 GROUP BY TEST11.会社名 ) AS NES GROUP BY NES.会社名 ORDER BY NES.会社名
DataRowのRowStateがModifiedになっているから。 DataRow.SetAdd()でRowStateをAddedに変える。
将来にわたっても自分以外は使わない、現時点でも複数の人が同時に使わない、データベース容量最大２GBを超えない、のであればそのまま使方い続けた方が良いです。そうでなければ、ACCESSはJIS規格に成っていないので、JIS規格となっているSQLとC言語、C#等で再構築されると良いです。つまり、SQL　Serverへの移行とプログラムの再構築をお勧めします。
新しいクエリを使ってＳＱＬ文を組み立てて下さい。下記はキーが２項目データーが２項目の場合の例です。 delete from tbl_new where not exists(select ' ' from tbl where tbl_new.キー1=tbl.キー1 and tbl_new.キー2=tbl.キー2) go update tbl_new set データ1=tbl.データ1,データ2=tbl.データ2 from tbl_new,tbl where tbl_new.キー1=tbl.キー1 and tbl_new.キー2=tbl.キー2 go insert tbl_new select * from tbl where not exists(select ' ' from tbl_new where tbl_new.キー1=tbl.キー1 and tbl_new.キー2=tbl.キー2) go です。
(1)～（5）の設定でやりたいこと(1)(2)は満たせます。 「すべてのデータベースにバクアップファイルを作成する。」でバックアップごと、データベース毎に 異なるファイル名でバックアップが作成されます。 やりたいこと(3)の削除はご認識の通り、クリーンアップタスクで行えます。 バックアップの有効期限を設定する必要はありません。
>１．仕様書の読解方法 何度も読みます。 >２．独学方法 文法は簡単なので、確実に全ての文法を理解する事です。 >３．参考ホームページ 特にありません、文法が簡単なので、後は知恵を使う必要があります。 >４．仕様を自分で考えて作る時の対象システム リレーショナルデータベースを扱うのでほとんどが事務処理関連のシステムです。 >５．SQLのよくある仕様パターン 同じテーブルを何度も形を変えて使うパターンが多いです。また、CASEを使用する場合が多いです。 >６．ユニークなSQL文のサンプル 文法が単純なのでユニークな物はほとんど有りません。ただし、RDBMS毎に仕様が異なるので注意が必要です、特に複数テーブルを使ったUPDATE文はRDBMS毎に、まさにユニークです。 >７．仕様プラスSQL解答例が載っているようなホームページOR参考書 無いので、全て自分の頭で考えています。しいて言えばそのRDBMSのSQLリファレンスです。
データベースファイルというのは SQLサーバーが使用するデータを格納するファイルです。 (拡張子は データ用 MDB,NDB ログ用 LDB です。) 一般的にはデータベースにアクセスすると言うことは SQLサーバーの様なデータベースソフトに対してアクセスします。 データ操作と言う意味では、データベースファイルに直接アクセスすることはありません。 説明にもあるように SQLサーバーA から データベースX をデタッチすると データベースX に使用しているデータベースファイルはフリーになります。 そのデータベースファイルを別のSQLサーバーBに持っていき アタッチすると、データベースX が使用できるようになります。 データベースファイルを操作するのはこういった特殊な場合だけです。 プログラミングの勉強と言う意味では データベースファイルは使用しないと思って良いでしょう。
質問通りにSQL作るとこんな感じ SELECT MIN(t.個別ID) 個別ID, t.グループID, t.順位, t.個数 FROM table_1 t INNER JOIN (SELECT a.グループID, MAX(a.個数) 個数 FROM dbo.Table_1 a GROUP BY a.グループID) ex on ex.グループID=t.グループID AND ex.個数 = t.個数 GROUP BY t.グループID, t.順位, t.個数
単純に権限付与するならsysadminで、 GRANT exec ON xp_cmdshell TO <SQLLogin> ですが、この辺はある種のFAQで、もう一手間、二手間必要かもしれません。 http://www.atmarkit.co.jp/bbs/phpBB/viewtopic.ph … http://ameblo.jp/sql-server/entry-10292432498.html http://bokuibi.blogspot.jp/2009/06/sql-server.ht … http://support.microsoft.com/kb/890775/ja バージョンや認証方法でも対処法が変わります。 とは言え、（私は、仕事で使っていたのは2000が最後ですが）基本理念は変わっていないと思います。 ところで、bcpでサーバにファイルを吐いた後、クライアント側に持って来る処理は不要なのでしょうか？ ファイルサイズにもよるとは思いますが、C#とVBが使えるなら、それこそ、OLEDB、ODBC経由でCSV吐くサンプルは沢山転がっていると思います。 数100MB以上とかなら、サーバ側で吐いたのを圧縮転送の方がいいですけど。
ビュー自体には実データは存在しませんが、実データの見方を定義しているので、調査しようとしてい範囲によっては、調査の必要が有る可能性は有ります。ビューを沢山作ると、システムの解析が面倒になるので、あまり作らない事をお勧めします。
select ID,名前,趣味 from 現在 union all select ID,名前,趣味 from 履歴 t1 where 履歴NO=(select max(履歴NO) from 履歴 t2 where t1.ID=t2.ID) and not exists(select ' ' from 現在 where 現在.ID=t1.ID) order by 1 です。
全ての貸出日もしくは全ての返却日を調べれば一番貸出本数が多い日が含まれるはずなので、それを利用すれば良いかと。 例) ------------------------------------ SELECT MAX(合計本数) AS 合計本数 FROM ( SELECT (SELECT SUM(本数) FROM 貸出 b WHERE a.貸出日 BETWEEN b.貸出日 AND b.返却日) AS 合計本数 FROM (SELECT DISTINCT 貸出日 FROM 貸出 WHERE 貸出日 BETWEEN 20130101 AND 20130131) a ) c; ---------------------------------------- 別名aのサブクエリーで全ての貸出日(重複なし)の集合を取得しています。 その一つ外側で、全ての貸出日について合計の本数を算出しています。 そして、一番外側で合計の本数が一番多いものを抽出しています。 日付を絞り込むには、一番内側の別名aのサブクエリーで条件を指定すれば良いです。
この辺が関係あるかもです。 Windows7(64Bit版)での32Bit版ODBC管理ツール http://rinta-annex.at.webry.info/201202/article_ … http://support.microsoft.com/kb/942976/ja 要は、OS(Windows7) が64bit の場合に既定で64bit版ODBCを使用しようとしますが Access は32bitで動いているので64bit版ODBCでは接続できない。 なので、 『Odbcad32.exe ファイルの 32 ビット バージョンは、 %systemdrive%\Windows\SysWoW64 フォルダーにあります。』 で設定を行う必要がある・・という事。 OS が 32bitならこの回答は読み捨ててください。
1) 値段の集計 SELECT 販売支店, 出身国, SUM(値段) AS 値段 FROM テーブル GROUP BY 販売支店, 出身国 ORDER BY 販売支店, 出身国 (2)車種の頻度順 SELECT COUNT(*), 車種 FROM テーブル GROUP BY 車種 ORDER BY COUNT(*) DESC, 車種 (3) 合体 SELECT a.販売支店, a.出身国, SUM(a.値段) AS 値段 , ( 　　SELECT TOP 1 b.車種 　　FROM テーブル b 　　WHERE b.販売支店 = a.販売支店 AND b.出身国 = a.出身国 　　GROUP BY b.車種 　　ORDER BY COUNT(*) DESC, b.車種 ) AS 車種 FROM テーブル a GROUP BY a.販売支店, a.出身国 ORDER BY a.販売支店, a.出身国
SQL Server のカテゴリーに質問されているので SQL Server の質問てことでいいんですかね。 Xoops が SQL Server を使っているとして、、、、 接続文字列は DB へ接続するための文字情報なので、それを削除しても DB は削除されない。 相手が SQL Server なら Management Studio または Management Studio Express を使って DB 自体を削除する。
select m.name,s.makercd,count(s.makercd) from shohin s left join meisho m on s.makercd=m.makercd group by s.makercd; 追加質問に素直に答えると上記です。 追加質問のエラーというのは、多分ですが、 「Column 'makercd' in field list is ambiguous」ではないでしょうか？ であれば、これはgroup byで指定したmakercdに、 どちらのテーブルのmakercdかの指定がないためです。 上記のsqlは素直にそれを訂正しただけです。 ただ、例を見てたのですが、「004 東芝」はmeishoには登録されているけど shohinに出てきていないですね。 ----------- 001 富士通 3 002 NEC 2 003 パナソニック 1 004 東芝 0 ----------- もし、上記のような0件の結果も必要ならば以下となります。 select m.makercd,m.name,count(s.makercd) from meisho m left join shohin s on m.makercd=s.makercd group by s.makercd order by m.makercd;
6.5の古いバージョンは問題が出ましたが、最近のバージョンは問題は出ないはずです。尚、クライアントからの接続は当然コンピューター名を変更する必要があります。
数値を日付に変えるのは通算日付になるので普通出来ません。つまりOracleでも文字列を日付に変換するはずです。 つまり文字にかえてからこれです。 http://dbhikaku.web.fc2.com/sqlserver_convert.html
## Nullじゃなくて''（空文字）が登録されているような気がしますが。。。 ## select case when 変数 is null then 'NULL' when 変数 = '' then '空' else 'OK' end ## from CSVファイル ## でNullと出ずに、空とでたらそうです。 ## 調べてみないと分らないので、それはさておき、 とりあえず、 convert(datetime,変数) のほうは、 case when 変数 is null then null when 変数 = '' then null else convert(datetime,変数) end としたらうまくいくのではないかと思います。 datetime型の変数がNot Null指定でテーブルを作っているとダメですが。
ここでLINQについて質問しても回答は出ないのでは。 C#カテのほうが向いてると思うよｗ LINQは本当に便利。取得だけならSQLなど一行も書く必要ないし、オブジェクトに詰める手間もいらない。 キモは、Group化してまとめたボディ部を、Selectで別の型に変えるところでしょう。 public List<MemberTypes> GetMemberTypes(){ 　using (var dc = new DataContext()){ 　　return dc.MemTypeBinds 　　　.GroupBy(mt=>mt.Member) 　　　.Select(g=>new MemberTypes{ 　　　　member　= g.Key, 　　　　types　= g.Select(mtg=>mtg.Type).ToList() 　　　}).ToList(); 　} } 逆の種別->メンバー（複数）変換も書いてみたｗｗ public List<TypeMembers> GetTypeMembers() { 　using (var dc = new DcHealth()) { 　　return dc.MemTypeBinds 　　　.GroupBy(mt => mt.Type) 　　　.Select(g => new TypeMembers { 　　　　type　= g.Key, 　　　　members= g.Select(mtg => mtg.Member).ToList() 　　　}).ToList(); 　} } 面白いｗｗｗ
クエリ(Query)は「問い合わせ」の意味でSQLのQは元々はQueryの略でしたが今はSQLで一つの言葉になっています。ビュー(View)は「景色」や「見解」と言った意味ですが、RDBMSでは実際のテーブルをSQLのSELECTで問い合わせた状態を、仮想のテーブルと見立てる場合に使用します。ちなみに私の作っているツールは７種類のRDBMSに対応していますが、テーブル名一覧等のテーブル構造がRDBMS毎に異なるのでViewを造って見かけ上同じ構造のテーブルに見立てる事でツール側ではどのRDBMSでも同じ書き方でSQLが書けるので便利に使っています。
テーブルから別のテーブルへだったら INSERT INTO table1 SELECT cast(aaa as char), bbb, ccc,・・・ FROM table2 WHERE ～～～ こんな感じでできるんじゃないかな～
実験した訳ではなく予測で回答しますのであしからず。 一応SQL　Server認証は通常はWindows認証は不要です。 (1)Guestユーザーを有効化してみてはどうでしょうか。 (2)昔パソコンへのログインIDがサーバーにも有っ、てそのパスワードが異なると動かない場合がありました、パソコンへのログインIDをサーバーには存在しない物にしたら動きませんか。
実際に試したことは無いのですが Windows 2000でSQL Server 2008 R2は動作対象外なので動かない （インストール時に弾かれる）と思います。 そもそもWindows 2000は、すでにサポート終了しているため 不具合があっても修正されません。 SQL Server 2008 R2を Windows Server 2008 R2 に入れて ネットワークで接続されたWindows 2000に DB を置いて ほかの端末から SQL Serverにアクセスとかなら できると思います。 （この場合、Windows 2000にDBを置く意味が無い）
Access2007 → SQLServer2008 で出来ないものが 後発のSQLServer2012なら、なおさら無理というものでは？ >状況 >この動作は仕様です。 ↑これは、哀しいですねぇ。 なお、Access2013からは、 『アップサイジング ウィザードを使用すると、Access データベース テーブルを新規または既存の Microsoft SQL Server データベースにスケール アップできます。この機能は Access 2013 で削除されました。』 です。 他にも、ひどいと思う変更が幾つか。あんまりだ！ Office 2013 での変更点 http://technet.microsoft.com/ja-jp/library/cc178 …
#1 です。 最初のIF の条件に合った場合の処理と 合わなかった場合の処理を明確に区別しましょう。 それぞれを BEGIN END でくくります。 そしてそれらの間に ELSE を記述します。 つまり、以下のように記述します。 IF (@@FETCH_STATUS = 0) BEGIN IF (@column_new_value$19 = 1) update ・・・ ELSE IF (@column_new_value$19 = 2) update ・・・ END ELSE BEGIN IF (@column_new_value$19 = 1) insert ・・・ ELSE IF (@column_new_value$19 = 2) insert ・・・ END いかがでしょう? 元のソースがどうなっているか判りませんが、 ツールも100% では無いと言うことでしょう。
SQL Server は同一マシン上にいくつもインストールすることができる。 SQL Server は DB を管理するサービス (DBMS) なので、同一マシンに複数インストールすれば、同一マシンで複数の DBMS が稼動することになる。 1つめの DBMS で管理されている DB-A という DB があったとして、さらに 2つ目の DBMS にも DB-A という DB があったとしても、1つ目の DBMS で管理している DB-A と 2つ目の DBMS で管理している DB-A は別物である。 これは Windows のフォルダーで考えればわかりやすい。 1つのマシン上には複数のドライブ (C とか D とか) をマウントできる。 各ドライブには当然ながらフォルダーがあるが、C:\hoge と D:\hoge という 2つの同じ名前のフォルダーはドライブが違うので別物である。 で、本題。 同一マシン上に複数の DBMS をインストールする場合、それぞれの DBMS のインスタンスに名前をつけて区別する。 ただし 1つの DBMS しか稼動させない場合は名前をつける必要がない。これを 「既定のインスタンス」 と呼ぶ。 既定のインスタンスが稼動しているマシンに 2つ目の DBMS をインストールする場合、すでに稼動している既定のインスタンスと区別するために何か名前をつける必要がある。これが 「名前付きインスタンス」 である。 ただし DBMS を 1つしか稼動させない場合でも、何が何でも既定のインスタンスにしなくてはならないわけじゃなく、名前をつけてやってもかまわない。 例外として、SQL Server の無償版である Express Edition は、通常は名前付きインスタンスとしてインストールされる。 名前付きインスタンスを指定せずにインストールした場合は、既定の名前付きインスタンスである SQLExpress が使用される。
JPN\x64\SQLEXPRADV_x64_JPN.exe をダウンロードすれは間違い無いです。 これには全ての機能が入っています。 インストールの時に選択してください。 リンク先をちゃんと読めば違いが書いてありますよ。 単に DBだけが必要で他の機能は不要なったら JPN\x64\SQLEXPRWT_x64_JPN.exe でも良いかもしれません。
SELECT case when （ドロップダウンリストの値） = 1 then 列１　 when （ドロップダウンリストの値） = 2 then 列２ when （ドロップダウンリストの値） = 3 then 列２ end FROM table1 （ドロップダウンリストの値） は変数として引き渡してもいいし、Select文を組み立てるときに 固定値をセットしてもいい。 固定値の例） （ドロップダウンリストの値）が1なら、 SELECT case when 1 = 1 then 列１　 when 1 = 2 then 列２ when 1 = 3 then 列２ end FROM table1 となるので、列１が返ってくる。
SSRSは使っていないのでよくわからないですが、 一般にSQLで、パラメタによってdistinctをするしないを区別するのは無理です。 （パラメタによって別のSQLをそれぞれ発行するしかないです。） 無理やりするなら、 select * from (select A1,A2,A3,・・・,row_number() over(order by A1,A2,A3,・・・) as rn from tableA) group by A1,A2,A3,・・・,case when (パラメタ) = 'する' then 1 else rn end でできるでしょうけど。 注： select distinct A1,A2,A3,・・・ from tableA と select A1,A2,A3,・・・ from tableA group by A1,A2,A3,・・・ は同じ結果になります。
おかしくなって当然です。 回避策は、#2 さんがしめされているので なぜか？ の部分をExcelの場合で説明されています。 SQLServer でも考え方は一緒です。 ※ #2 さんの詳しい解説ですね。 日経PC21 / エクセル（Excel）「演算誤差」対策講座 http://pc.nikkeibp.co.jp/pc21/special/gosa/
土地テーブルと家屋テーブルは、同一所有者ＩＤで同一取得日で複数のレコードがあってもおかしくない はずだけれども、テーブルの項目がないので、ないと仮定しましょう。 （あったら以下のSQLではうまく結果はでません。） select a.所有者ID,a.所有者名 as 名前,b.土地取得日,b.面積,c.家屋取得日,c.延床面積 from 所有者テーブル a, (select b2.所有者ID,b2.取得日 as 土地取得日,b2.面積, ROW_NUMBER() OVER(PARTITION BY b2.所有者ID ORDER BY b2.取得日 DESC) as No from 土地テーブル b2) b full outer join (select c2.所有者ID,c2.取得日 as 家屋取得日,c2.延床面積, ROW_NUMBER() OVER(PARTITION BY c2.所有者ID ORDER BY c2.取得日 DESC) as No from 家屋テーブル c2) c on b.所有者ID = c.所有者ID and b.No = c.No where a.所有者ID = case when b.所有者ID is null then c.所有者ID else b.所有者ID end という感じでできるはずです（未検証）
インストールはうまくいきましたか？ あと、システム用件は満たしていますか？ WindowsXPの場合、 SP1とSP3がセットされている事が条件とのことです。
アプリケーションからはどのような接続方式なのでしょう？ VBとかのアプリケーションであれば何もせずに移行できる場合もあります。 面倒そうなのは、 ・システムテーブルを直接操作している　→　方法が少し変わった ・DBCCコマンドを使用している　→　T-SQLに変わった （互換性レベルを90以上にする場合） ・外部結合演算子を使っている　→　OUTER JOINに変更する必要がある ・ORDER BYでテーブル名にプレフィックスを付けていたりする　→　エラーになる これに該当しなければ、そのまま動くかもしれません。
クエリA側にダミーの項目を1つ増やすのであれば以下の様にすればよいと思います。 クエリA select 　　A.Col1 　　,A.Col2 　　,A.Col3 from A クエリB select 　　B.Col1 　　,B.Col2 　　,B.Col3 　　,B.Col4 from B としてUNIONするとこうなります。 select 　　A.Col1 　,A.Col2 　,A.Col3 　,'' AS Col4 from A union all select 　　B.Col1 　,B.Col2 　,B.Col3 　,B.Col4 from B
http://detail.chiebukuro.yahoo.co.jp/qa/question … こちらをどうぞ。
＞SET @GetRand = CAST(RAND()*10 AS numeric(1,0)) RAND()*10の値が9.5以上だと破たんする（＝丸められて10になる。）ので、floorするとか。
こんな感じでどうでしょうか。 select C1, C2 from T_TABLE order by case when C2 = 'XY' then 1 when C2 = 'XZ' then 2 when C2 = 'XX' then 3 else 4 end, C1; SQL Serverの環境がないので動作確認はしていません。
Windows認証も無効化できます。 SQL Serverのログインで、Windowsユーザーで設定されたログインを削除することでWindows認証できなくなります。 SQL Server認証は純粋にIDとPASSの組み合わせなので、サーバー管理者云々は関係ありません。 SQL Serverの認証方式として、 Windows認証 Windows認証＋SQL Server認証（混合） の2種類しか選択肢がないので、混同されているのだと思います。 Windows認証は、OSの認証に使用したユーザーに権限を付与した認証。 これはOSのユーザーにSQL Server内のログインで権限が付与する形式。 なので権限をはく奪するなり、ログインから削除すればOSのユーザーで認証できなくなります。 SQL Server認証はIDとPASSの比較。 こちらもログインで設定されております。OSのユーザは関係ありません。 SQL Server Management Studioでサーバーに接続し、インスタンスのセキュリティのログインにWindowsのOSユーザーのログインがあると思いますので削除すればWindows認証ではログインできなくなります。
SELECT USERID,DATEDIFF(DAY,購入日,GETDATE())/7+1 FROM テーブル名 でどうでしょうか。
information_schemaの中身はシステムの情報なのでupdate文なんかで変えちゃいけません。 ・・・不整合が起こってシステムが異常な動作をしても知りませんよ、って内容なので。 で、エラーになるんでしょう。 routine_definitionだけテキストファイルに出力して、メモ帳かなにかで 「CRAEATE PROCEDURE 」を「ALTER PROCEDURE 」に 「★★★」を「○○○」に一括置き換えして sqlcmd等で実行すればそれでしたい作業は終わりのはずですが。 ## とここまで書いて、ちょっと甘いことに気づいた。 ・sqlcmdで接続するデータベースをきちんと指定するか、出力結果の先頭にuse等を追加して指定する。 ・各alter文の最後にgoがないとだめなので、 SELECT ROUTINE_DEFINITION + CHAR(13) + CHAR(10) + 'GO' + CHAR(13) + CHAR(10) AS Expr1 FROM INFORMATION_SCHEMA.ROUTINES WHERE (ROUTINE_DEFINITION LIKE '%★★★%') AND (ROUTINE_TYPE = 'procedure') とselect文を変更する。 なお、select句の中を、 REPLACE(REPLACE(ROUTINE_DEFINITION, 'CREATE PROCEDURE ', 'ALTER PROCEDURE ') ,'★★★', '○○○') とするだけでメモ帳なんか使わないって方法でも大丈夫のような気がしますが、 '★★★'と'○○○'の内容次第。 '★★★'でPROで'○○○'がXYZとしたら、ALTER PROCEDUREが、ALTER XYZCEDUREになってしまって 全部エラー。。。 ということも考慮する必要はあります。
細かいことをいうと > データベース：ONLAINGAME ではなく「ONLINEGAME」でしょう。基本命名規則を英語に準拠するなら注意しないと後で訳がわからなくなります。 > MENBERの中に50件、WEAPONの中に50件データを作ればいいのでしょうか。 これはゲームの性質によります。多人数の同時アクセスが想定されるなら、MEMBERテーブルのレコード件数を多めにしておいたほうが本番に近い検証ができる気がします。（同時アクセスのシミュレーションができる環境も作らないといけませんが） > create table MENBERl(age int, name varchar(20) , primary key (aa); 「MENBERl」の「|」は不要です。セミコロンの前に閉じかっこが必要です。「primary key(aa)」とありますが、「aa」という項目がありません。多分このままでは通らないと思います。
エラーとなる理由は、スタンバイ解除後の、フォームのクリックイベント時に実行され保存した変数等が、クリックイベント終了時に全て無くなるからです。この現象をスコープから外れる等と言います。 参考url : http://ja.wikipedia.org/wiki/%E3%82%B9%E3%82%B3% … ちなみに、何らかの処理中にスタンバイ等になりネットワークが切断されてしまった場合は、そこでエラーとし、アプリケーションを強制終了し、再度、最初から実行させるのが一般的です。 ※そうしないと、データベースの整合性が崩れてしまう可能性があるため。
私の知る限りですが、すでにあるカラムにIDENTITY属性は付加できません。
> DBCopyTool.exe これは使ったことが無いのでわかりません。 > また当初の希望内容を実現するため、他の方法があれば　 DTS（Data Transformation Services）を使う、ではダメですか？ 直接接続がダメでも、Textなり、MDBなりにデータ変換するツール（双方向）。 参考ＵＲＬ：MicrosoftさんのWebページ [SQL Server 2008 R2 における SQL Server 2000 DTS のサポート] 参考URL：http://msdn.microsoft.com/ja-jp/library/bb500440(v=sql.105).aspx
大変失礼いたしました。 指摘いただいた通り、Standardは大丈夫そうですね。 勘違いしておりました。 Server OS縛りなのはEnterprise Editionのようです。 惑わせてしまい申し訳ありません。
alter table Test_table alter column name nchar(20)
SQL Server 2008 Expressを既定のインスタンスとして作成すると、インスタンス名がSQLEXPRESSとる仕様になっています。 検証していないので不確かですが、 SQL Server 2008 Expressを名前付きインスタンスを選択し、名前に「MSSQLServer」を入力しインストール すると希望されているサーバー名のみの接続が可能になるかもしれません。 ちなみに、SQL Serverはインスタンス名無しではインストールできません。 普段サーバー名だけで接続できているのは、裏側で既定のインスタンス名である「MSSQLServer」を自動保管しているのです。 例えばtestサーバーに、製品版の既定のインスタンスをインストールしたとします。 Management Studioで、接続先に「test」と入れて接続を試みると、 裏側で、「test\MSSQLServer」と解釈しているのです。 インスタンス名が「MSSQLServer」以外の場合は、ユーザーが指定する必要があるのです。 ですので、Expressの場合、あえて名前付きインスタンスを選択し、「MSSQLServer」でインストールすると結果的に、上記動作にのっとり、サーバー名だけで接続できるようになるかもしれません。
select cast( DeviceTime as date ) as 日時, DeviceID as 端末番号, max(DeviceValue) as 計測最大値 from テーブル名 group by cast( DeviceTime as date ), DeviceID order by 日時,端末番号
こんにちは。 リンクサーバーを使えば、 意図されていることができるかと思います。 参照URLに手順が記載してあります。 参考URL：http://msdn.microsoft.com/ja-jp/library/ff772782 …
えーと、たぶんSQL Server Compact Edition 3.5は、ASP.NETに対応していなかったと思います。 対応したのはFramewok 4のASP.NETからかな？ 3.5CEはLINQのデータソースとして選択できるけど使えないと思います。 あと、SQLServer CE（3.5、4とも）は、Visual Studioと別製品。WebMatrixなんかだったらインスコされるけど、Visual Studioだけだと入らないよ。 インストーラがあるので、そちらからダウンロードしてインストールしてみてください。
こんにちは。 ・sp_add_job ・sp_add_jobstep を使うことで、自動化することはできると思います。 参考URL：http://msdn.microsoft.com/ja-jp/library/ms189953 …
select 出身地,sum(幅跳び),sum(反復横跳び),sum(懸垂),実施年,実施月 from ( select 出身地,得点 as 幅跳び,0 as 反復横跳び,0 as 懸垂,実施年,実施月 from MotoTable where 種目 = '幅跳び' union select 出身地,0 as 幅跳び,得点 as 反復横跳び,0 as 懸垂,実施年,実施月 from MotoTable where 種目 = '反復横跳び' union select 出身地,0 as 幅跳び,0 as 反復横跳び,得点 as 懸垂,実施年,実施月 from MotoTable where 種目 = '懸垂' ) group by 出身地,実施年,実施月 order by 出身地,実施年,実施月 とか、 select 出身地, sum(case when 種目 = '幅跳び' then 得点 else 0 end) as 幅跳び, sum(case when 種目 = '反復横跳び' then 得点 else 0 end) as 反復横跳び, sum(case when 種目 = '懸垂' then 得点 else 0 end) as 懸垂, 実施年,実施月 from MotoTable group by 出身地,実施年,実施月 order by 出身地,実施年,実施月 とか。 ## 下のほうが早そうだが、キーの持ち方とかで一概にはいえない。
# SQL ServerではなくC#の質問であるように思えますが……。 データを「どのように表示したい」のですか。 データの表示方法は一通りではないので，そのデータをどのように表示するかは作るときに決めなければならないことになります。 > string testID = reader["id"].ToString(); > Convert.ToInt32(testID) int testID = reader.GetInt32(reader.GetOrdinal("id")); とすれば，Convertする必要はないかと。
with T as ( select t1.* from ( select 検索対象データ.*, dense_rank() over( partition by ID order by 価格 ) rnk from 検索対象データ ) t1 where t1.rnk <= 2 ) select T.ID, T.日付, T.価格 from T where not exists ( select 1 from T T2 where T.ID=T2.ID and T.価格=T2.価格 and T.日付>T2.日付 ) order by T.ID, T.日付 desc
確かインストールしてから変更していなければ、 SERVERPROPERTY ( 'servername' )と同じところを見ていたと思うので、 nvarchar(128) http://msdn.microsoft.com/ja-jp/library/ms174396(v=sql.90).aspx より。 心配なら、 nvarchar　とのみ設定しておけば？ http://msdn.microsoft.com/ja-jp/library/ms187944 … より なお、SQL Server2000 と仕様が変わっていた項目だった記憶があります。
エラーメッセージそのものだけど、 インサートしようとしているデータに外部キー違反があるため、インサートできなかったってこと。 ・インサートをあきらめるか、 ・別の値をつけてインサートするか、 ・キーの設定を変えるか
SQL SERVER 2008 R2、 PostgreSQL 9.1(cygwin）で試したところではrow_number()のover句でのオーダー順で出力されました。 実行計画をみても、WINDOWSソートの後はシーケンス処理のみということで今の実装上ではover句の指定順になると思われます。 なお、SELECT文の最後にORDER BYでROW_NUMBER関数の値を指定したところ、SQL SERVER 2008 R2では無視（最適化）され、PostgreSQLでは実行されるようです。 ただし、SQLの規格としてはおそらくover句順を保証してはいないと思います。
>string 変数にどんどんと長いクエリを書いてしまいがちです SQL文の中に改行コードを含めてもかまわないので、 適当なところ（項目名の次とか、命令の次とか）に改行コードをプログラムで入れても問題ないので 私はプログラムでstring 変数中にクエリを書いている処理の最中にところどころで、 string 変数中に改行コードを入れることをしていますが。 C#は使わないので例えばVBとかでは dim sqlstr as string sqlstr = "Select * from tableA" & vbcr &vblf sqlstr = sqlstr & "where tableA.A1 = '" & wkstr1 & "'" & vbcr &vblf sqlstr = sqlstr & "order by " & wkstr2 & wkstr3 & wkstr4 といった具合。 ## whereの中はホスト変数にしたほうがいいけど・・・ま、サンプルということで。
主キー項目でないなら update テーブル名 set コード = '0' + コード
ライセンスについてここで質問しても何の保証もない。 質問をするならマイクロソフトかマイクロソフトのパートナー企業にすべき。 SQL Server に関するご相談窓口 http://www.microsoft.com/ja-jp/sqlserver/2008/r2 …
主キーが無いのでは？ AccessでODBC接続のリンクテーブルは 主キーがないと更新可能になりません。
SELECT … FROM Ａ Right Outer Join Ｂ Ｂ on Ｂ.c =Convert(varchar(10),Ａ.d) varchar(10),は、 Ｂ.cの型にあわせる。 ただし、 今までは暗黙の型変換で、数値に変換されていたから条件が成立していたケースで条件が成立しない 場合がでてくるかもしれません。 例） Ｂ.cが' 1'で、Ａ.dが1のとき、 数値に変換されると、どちらも1ですが、 文字に変換すると、 Ｂ.cが' 1'で、Ａ.dが'1 'になって等しくならないかも。 というようなことがおきたら、 on trim(Ｂ.c) = trim(Convert(varchar(10),Ａ.d)) trim()を利用してください。
【例2】はホントのSQL文ですか？selectする列とOrder Byの列が合ってません。 やはり実機で、シンプルな検証データ・テーブルで確認をしたほうが良いでしょう。 OracleだとOrder By をselectする列番号で指定できましたが、SQLServerはどうでしたっけ。 SELECT DISTINCT ISNULL(T1.C1,""),T1.C2 FROM T1 ORDER BY 1
補足ありがとうございます。 ということは >001　　AAA　　DDD があって >NULL　 AAA　　DDD もあるというのは間違っていますよね。 ですので、以下のデータと結果を正として考えます。 --データ 001　　AAA　　BBB 001　　AAA　　CCC 001　　AAA　　DDD 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　EEE --DDDをEEEに変えました NULL　 AAA　　BBB NULL　 AAA　　CCC --結果 001　　AAA　　BBB 001　　AAA　　CCC 001　　AAA　　DDD 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　EEE 以下のSQLでどうでしょうか。 select 種類,キー1,キー2 from ( 　select 種類,キー1,キー2,count(*) over(partition by キー1,キー2) cnt 　from ( 　　select 種類,キー1,キー2 from Table1 　　union select 種類,キー1,キー2 from Table2 　　union select 種類,キー1,キー2 from Table3 　) ) where 種類 is not null or cnt = 1 order by 種類,キー1,キー2; 全角スペースでインデントしているので、実行時には削除するか半角スペースに置き換えるなどしてください。
SELECT ID,MAX(列) AS 最大値 FROM (SELECT ID,列1 AS 列 FROM テーブル UNION ALL SELECT ID,列2 AS 列 FROM テーブル UNION ALL SELECT ID,列3 AS 列 FROM テーブル UNION ALL SELECT ID,列4 AS 列 FROM テーブル UNION ALL SELECT ID,列5 AS 列 FROM テーブル) AS TBL GROUP BY ID ORDER BY 1 でどうでしょうか。
1> App.config の connectionString にサーバのDBを指定する 2> ～.exe.config の connectionString にサーバのDBを指定する
ＤＢのテーブル定義書を書いた人がどんなルールで書いているのかわかりませんから 断言はしませんが（本筋はどういうルールで書いたかを書いた人に聞くべきと思う） >・・・（略）・・・ >１　１ >が更に存在できないということですか？ 一般的には質問に書かれているようなことを意味しているでしょう。 他のこととしては、P1とP2の違いについて書くと where ＸＸＸＸＸＸＸ Between 1 and 3 等、ＸＸＸＸＸＸＸを使った検索はＹＹＹＹＹＹＹを含んでいても含んでいなくても、 プライマリキーを利用した検索になりますが ＸＸＸＸＸＸＸを使わず、ＹＹＹＹＹＹＹを使った検索では、プライマリキーを利用しない検索になる という意味も読み取ることができます。
実運用に使わないならSQL Server 2008 R2 Developerを検討してみてください。 最大 CPU 数 : 256 論理プロセッサまで 最大メモリ : OS がサポートする最大容量まで 最大 DB 容量 : 無制限 ライセンスで許容される仮想化環境数 : 無制限 (ライセンスはユーザーごとに許諾されます) http://www.amazon.co.jp/SQL-Server-2008-Develope …
サーバ上にmdbファイルを置いて クライアント上のAccessからネットワーク経由で共有されたサーバ上のmdbファイルを開く というaccessで時々やっているのを見かける方法をイメージして考えていませんか？ SQL Serverは普通、こんなことはしません。（理由は後述） 1.サーバ機上で、SQL Serverを常時動かしておきます。 (当然、データファイルもこのSQL Serverからアクセスします) 2.クライアントとサーバの通信は、TCP/IPを利用します。 （後述のODBCやADOがTCP/IPの通信をします。） 3.クライアントからは、ODBCやADOその他の方法で、SQL言語を使って、SQL Serverとアクセスします。 4.ODBCやADOは、AccessやEXCEL、ExcelのVBAやVB.2008、C#その他の開発ソフトから利用できます。 ということで、 >・それぞれの端末からサーバーが共有できるが、端末同士で互いに繋がることは出来ない。 それぞれの端末からサーバーが共有できる必要はありません。 ただし、SQL Serverと接続するためのポートがウイルス対策ソフトなどでブロックされていないこと が必要です。 >このような場合、まずはSQLserverをサーバーにインストールするのでしょうか？ まず、サーバ上にSQL Serverをインストールします。 >そもそもNTFSにインストールって…？ NTFSだろうが他のファイルシステムだろうが、ファイル共有するわけではないので関係ないです。 >それとも端末のSQLserver2008があれば、データ保存先でサーバーを選択して、 >他のPCから同じデータを操作できるものなのでしょうか？ 端末のSQLserver2008で、データファイルをネットワークドライブ（サーバー）上のファイルを 指定できなくはないと思いますが、ネットワーク経由にすると異常に遅いのと、 利用前に、SQLServerを起動して、利用後にSQLServerを停止しないとダメで、 停止していないと排他がかかって他の端末から利用できない。 ということ、使用前使用後で数分ずつかかり、なおかつ処理が遅いという、使い物にならない結果が 待っています。。。こんなことはしないことをお薦めします。 ## という説明でイメージくらいはつかんでいただけたかと。。。
ソートアルゴリズムを勉強すれば分かりますが、ほとんどのソートアルゴリズムはキーで指定された以外のデータ順については保障がありません。（安定的なソートではない）。 また、RDBMSが仮に安定的なソートアルゴリズムであっても、どのような順序にデータをフェッチするかはRDBMSの実装に依存しています。 > この、順番は何で決まっているのでしょうか？ きまりはないと思ってください。
まず、現時点のDBをバックアップしてください。 バックアップをきちんとしてあるなら、その時点までは復旧できます。 復旧してDROPしたテーブルデータをbcpツールなどでエクスポートし、現時点のDBに再度切り替えてエクスポートしたデータをインポートするぐらいでしょうか。
既に一度インポートしたのであればテーブルは出来てるんだから EnterpriseManagerでテーブル定義を変えて、レコード全部削除してから再度インポートするとか。 ＤＴＳ（データ変換サービス）では定義できませんでしたっけ？
違っていたらすいませんが、アタッチする際に[データベースの詳細]でファイル名を確認してみてください。mdfファイルとldfファイルを同じ論理名（NAME）でアタッチしようとしているということはありませんか？ 例えば、mdfのNAMEがaaaaならばldfのNAMEはaaaa_logなどにしないといけません。
確かに「なぜ」なのかは不明ですが、情報が足りないのかも知れません。（SQLServer、Excelのバージョンやデータの中身等） 現状、質問から読み取れる内容でやってみた画像を添付しておきます。 ちなみに、SQLServer2008、Excel2003です。 画像中の「B列」が数値と文字データが混在する列です。当方では「'」がないデータはDoubleと認識しますが、「'」を付けたデータではVarCharと認識されました。
こんにちわ。 Windows認証方式ということで、前提として、問題のWin7PCのWindowsログインユーザーがSQLServer2005 Express が稼働しているPCに適切な権限のグループ（Administrator等）に登録されているかどうかご確認されましたでしょうか？ 切り分けとして、一時的にデータベースの認証方式をSQLServer認証との混合方式にして接続が可能であれば、Windows認証の問題と言えるのではないでしょうか。 それでWindows認証の問題となった場合にWin7PCとSQLServer2005 Express が稼働しているPCとのユーーザー登録状況を記載されると問題の有無が判断できる情報になるかと思います。
参照URLに自習書があります。参考にしてみてください。 ディストリビュータとサブスクライバを同一サーバーで実行するのは 普通やりません。そういう設定ができるかどうかは知りませんが... この場合はパブリッシャとディストリビュータを同一サーバーで実行するのが普通です。 >また、Server1は更新用アプリが使用、Server２は参照用アプリが使用などといったことはできるのでしょうか？ これができなかったら、レプリケーションする意味がありません。当然できます。 参考URL：http://technet.microsoft.com/ja-jp/sqlserver/cc7 …
下記のSQLを実行してみてください。 見やすいように半角スペース2つは全角スペース1つに変換してます。 使用される際は「全角スペース1つ」を「半角スペース2つ」に変換してください。 SET NOCOUNT ON DECLARE @LogicalFileName sysname, 　　　　@MaxMinutes INT, 　　　　@NewSize INT -- *** 検索条件により、次の 3 行を変更してください。 *** USE　　 データベース名　　　　　　　　　　　　-- ログを圧縮するデータベース名を指定してください。 SELECT　@LogicalFileName = 'ログファイル名',　-- 圧縮したいログファイルを確認指定してください。 　　　　　　　　　　　　　　　　　　　　　　　-- (ログファイルは sp_helpfile で確認可能です) 　　　　@MaxMinutes = 10,　　　　　　　　　　 -- ログファイル圧縮処理の実行時間を指定します。 　　　　@NewSize = 512　　　　　　　　　　　　-- 単位は MB です。 -- セットアップ/初期化 DECLARE @OriginalSize int SELECT @OriginalSize = size -- 8K ページ 　FROM sysfiles 　WHERE name = @LogicalFileName SELECT 'Original Size of' + db_name() + ' LOG is ' + 　　　　CONVERT(VARCHAR(30),@OriginalSize) + ' 8K pages or ' + 　　　　CONVERT(VARCHAR(30),(@OriginalSize*8/1024)) + 'MB' 　FROM sysfiles 　WHERE name = @LogicalFileName CREATE TABLE DummyTrans 　(DummyColumn char (8000) not null) -- ログをラップし、それを切り捨てます。 DECLARE @Counter　 INT, 　　　　@StartTime DATETIME, 　　　　@TruncLog　VARCHAR(255) SELECT　@StartTime = GETDATE(), 　　　　@TruncLog = 'BACKUP LOG ' + db_name() + ' WITH TRUNCATE_ONLY' -- 最初の圧縮を試みます。 DBCC SHRINKFILE (@LogicalFileName, @NewSize) EXEC (@TruncLog) -- 必要な場合に、ログをラップします。 WHILE　　 @MaxMinutes > DATEDIFF (mi, @StartTime, GETDATE()) -- 有効期間は切れていません 　　　AND @OriginalSize = (SELECT size FROM sysfiles WHERE name = @LogicalFileName)　 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 -- ログは圧縮されていません　　 　　　AND (@OriginalSize * 8/1024) > @NewSize　-- 新しいサイズに渡される値は、現在のサイズ未満です。 　BEGIN -- 外部ループ 　　SELECT @Counter = 0 　　WHILE　((@Counter < @OriginalSize / 16) AND (@Counter < 50000)) 　　　BEGIN -- 更新します 　　　　INSERT DummyTrans VALUES ('Fill Log')　-- char フィールドなので、8000 バイト挿入します。 　　　　DELETE DummyTrans 　　　　SELECT @Counter = @Counter + 1 　　　END　 -- 更新 　　EXEC (@TruncLog)　-- ログの切り捨て。 　END　 -- 外部ループ SELECT 'Final Size of ' + db_name() + ' LOG is ' + 　　　　CONVERT(VARCHAR(30),size) + ' 8K pages or ' + 　　　　CONVERT(VARCHAR(30),(size*8/1024)) + 'MB' 　FROM sysfiles 　WHERE name = @LogicalFileName DROP TABLE DummyTrans PRINT '*** データベース全体のバックアップを実行します ***' SET NOCOUNT OFF
添付画像がありません。 サンプルデータをテキストでいいので補足してください。
こんな感じでしょうか？ この場合は、内部ではなく外部結合にして都道府県テーブルを 別名で３つ開けるという形になると思います。 SELECT Customer.* 　　 , Pref1.PrefName as PrefName1 　　 , Pref2.PrefName as PrefName2 　　 , Pref3.PrefName as PrefName3 　FROM Customer 　LEFT OUTER JOIN Pref Pref1 　　ON Customer.CustomerPref1 = Pref1.PrefId 　LEFT OUTER JOIN Pref Pref2 　　ON Customer.CustomerPref2 = Pref2.PrefId 　LEFT OUTER JOIN Pref Pref3 　　ON Customer.CustomerPref3 = Pref3.PrefId WHERE CustomerId = 123
SELECT F_No FROM (SELECT DISTINCT F_No,F_Kaisu FROM テーブル名 WHERE F_Memo IS NOT NULL)AS T GROUP BY F_No HAVING COUNT(*)<>MAX(F_Kaisu) ORDER BY 1 です。
#3 です。#4 さんとほとんど同じですが、その後気付いたのが MAX を使う方法でした。 SELECT NAME, ICHI, MAX(CASE WHEN ITEM = 'D2' THEN DATA ELSE NULL END) AS DATA_D2, MAX(CASE WHEN ITEM = 'D3' THEN DATA ELSE NULL END) AS DATA_D3 FROM TEST a WHERE NAME = 'A' GROUP BY NAME, ICHI ;
・@@IDENTITYは直前のIDENTITY列の値です。INSERT INTOする場合に使う物ではありません。 ・SET IDENTITY_INSERTはリストア時など，明示的にIDENTITY列に値を入れたい場合に使います。 というわけで，このクエリは， INSERT INTO members (seibetu, name) VALUES ('男', 'すずき') のみでよくなります。 # SET IDENTITY_INSERTは不要。
> １．トランザクション開始 > ２．テーブルAをUPDATE > ３．色々な処理(省略) > ４．テーブルＡのUPDATE前の情報を参照 同一トランザクションでUPDATEしてから更新前の情報を取得しようとすること自体無理があるように思えるのですが。 SELECT UPDLOCK でデータ取得してから更新処理を行うのが妥当ではないですか。
select s1 from テーブル名 where code in ( 0, 1) group by s1 having count( distinct code ) > 1 でどうでしょう。
その程度したら、3つのDBどれを使用しても性能差は出ないと思います。 自分が一番使い慣れているDBを使用するのが良いかと思います。 >あと、どの程度データを各データベースに入れると重くなってしまうものなのか・・・ 数千万件でも問題なく動作しますよ、mySQLもSQL Serverも。 HWを大きくして、数を増やしていけば、どこまでも。 と、しか言えないのは、 性能は一概にデータ量だけで判断できないからです。 一般論として、よく言われるのは メモリにキャッシュしきれないデータ量になると急激に遅くなる というものです。 以上をまとめると、 適切なHW構成であれば、どのデータベースを使用しても性能は担保できる。 5万件であれば、無茶苦茶なクエリを書かなければ、 メモリに乗り切るかどうかが性能分岐点になりやすい ってところでしょうか。 ちょっと不親切な回答になり、すみません。
A1, B1, C1の型は何ですか。 こちらで試した結果から，A1の型がINT型になっているのではないでしょうか。 ---- TEST ---- DECLARE @table1 TABLE ( A1 DECIMAL, B1 DECIMAL, C1 DECIMAL ) DECLARE @table2 TABLE ( A1 INT, B1 DECIMAL, C1 DECIMAL ) DECLARE @table3 TABLE ( A1 DECIMAL, B1 INT, C1 DECIMAL ) DECLARE @table4 TABLE ( A1 DECIMAL, B1 DECIMAL, C1 INT ) DECLARE @table5 TABLE ( A1 INT, B1 INT, C1 DECIMAL ) DECLARE @table6 TABLE ( A1 INT, B1 DECIMAL, C1 INT ) DECLARE @table7 TABLE ( A1 DECIMAL, B1 INT, C1 INT ) INSERT @table1 VALUES ( 20, 10, 50 ) INSERT @table2 VALUES ( 20, 10, 50 ) INSERT @table3 VALUES ( 20, 10, 50 ) INSERT @table4 VALUES ( 20, 10, 50 ) INSERT @table5 VALUES ( 20, 10, 50 ) INSERT @table6 VALUES ( 20, 10, 50 ) INSERT @table7 VALUES ( 20, 10, 50 ) select 1, 3 / ((1 / (A1 + 1) + 1 / (B1 + 1)) + 1 / (C1 + 1)) as HARMEAN from @table1 UNION ALL select 2, 3 / ((1 / (A1 + 1) + 1 / (B1 + 1)) + 1 / (C1 + 1)) as HARMEAN from @table2 UNION ALL select 3, 3 / ((1 / (A1 + 1) + 1 / (B1 + 1)) + 1 / (C1 + 1)) as HARMEAN from @table3 UNION ALL select 4, 3 / ((1 / (A1 + 1) + 1 / (B1 + 1)) + 1 / (C1 + 1)) as HARMEAN from @table4 UNION ALL select 5, 3 / ((1 / (A1 + 1) + 1 / (B1 + 1)) + 1 / (C1 + 1)) as HARMEAN from @table5 UNION ALL select 6, 3 / ((1 / (A1 + 1) + 1 / (B1 + 1)) + 1 / (C1 + 1)) as HARMEAN from @table6 UNION ALL select 7, 3 / ((1 / (A1 + 1) + 1 / (B1 + 1)) + 1 / (C1 + 1)) as HARMEAN from @table7 (列名なし)HARMEAN 118.97101449275362318 227.14516129032258064 344.62500000000000000 421.65625000000000000 5153.00000000000000000 633.00000000000000000 763.00000000000000001
こんにちは。 以下のようにすれば取得できます。 SELECT COUNT(data) FROM( SELECT ID,data1 AS data FROM テーブル UNION ALL SELECT ID,data2 AS data FROM テーブル UNION ALL SELECT ID,data3 AS data FROM テーブル UNION ALL SELECT ID,data4 AS data FROM テーブル UNION ALL SELECT ID,data2 AS data FROM テーブル ) AS TBL WHERE ID='1' AND data = 'True'
UPDATE テーブルＡ SET Point2=Point WHERE SEQ=1 AND Point!=99 UPDATE テーブルＡ SET Point=ROUND(Point2,0) WHERE SEQ=1 AND Point=99 AND Point2!=99.0 の２個のSQLで出来ます。
世代管理は不要です　>「その後保存期間5年間」のレコードを保持＜　の意味は小１～中３までの過去データを卒業後５年たったら削除と解釈します。 卒業1年目～卒業5年目の５レコードは必要ありません。データ削除は在籍フラグ項目を作り「在籍中：進級：卒業：転出：転入：休学：留学：除籍：etc」を管理し、年度末に「卒業：転出：除籍」が５年以上前を検索、該当生徒のデータを削除します。 ただし5年間のレコード保持が卒業生の進路追跡であれば別です。顧客（できれば担当部署の学校側）に聞取り、確認をおすすめします。個人情報でもあるので追跡調査は考えにくいです。 小中一貫教育の私立、又は市町村教育委員会からの受注のようですが、要件定義をもっと詰めること。顧客はシロウトさんなので気軽に「調査書」「卒業生名簿」等の出力帳票を追加してきます。注意しましょう。 発注者の意見だけで決定するのではなく、作業している学校での調査をおすすめします。 名簿は事務に在籍生徒コードがあり、各校で卒業まで変わらないはずです。名簿テーブルを2つに分けて 名簿テーブル　　　　　　　　　　　　　　　　　　在籍テーブル　　　 ---------------------　　　　　　　　　　------------------------------------------ 在籍生徒コード｜生徒名｜住所etc｜　　　在籍生徒コード｜年度 ｜学年　　　　｜在籍フラグ｜ 　　　　００００１｜生徒Ａ｜　　　　　　　　　　　　　　００００１｜２０１１｜小学１年生｜進級　　　　｜ 　　　　００００２｜生徒Ｂ｜　　　　　　　　　　　　　　００００１｜２０１２｜小学２年生｜在学中　　｜ 　　　　００００３｜生徒Ｃ｜　　　　　　　　　　　　　　００００２｜２０１２｜小学２年生｜２年次転入｜ 　　　　００００３｜生徒Ｃ｜　　　　　　　　　　　　　　００００３｜２０１１｜中学３年生｜卒業　　　　｜ 名簿テーブルから在籍テーブにリレーションを貼って使ったほうがいいです 調査書の発行が要件に含まれていると転入前の学校の教科、成績も考慮する必要があります。 複数の学校に対応する市町村教育委員会等からの発注であれば、転入出も考えて、学校コード、在籍生徒コードの複合キーがいいでしょう。 複雑な要件の後出しがあると思って柔軟に頑張ってください。
関係ないかもしれませんが、 BEGIN TRY 　　★ 　　BEGIN TRY 　　　　▲ 　　END TRY 　　BEGIN CATCH 　　END CATCH CATCH ↑ここにBEGINが必要では？ END CATCH というのは置いておいて、 本当に、 ★の位置だとテーブルのドロップはCATCH できるのですが ▲の位置だとテーブルのドロップはCATCH できないようですが、 となっているのでしょうか？ BEGIN TRY 　　★ 　　BEGIN TRY 　　　　▲ 　　END TRY 　　BEGIN CATCH 　　　　※１ 　　END CATCH BEGIN CATCH ※２ END CATCH となっていたら、▲でテーブルがdropされていてエラーになったら、※２が実行されていると 思われるのですが。 ★と▲両方に別のテーブルを使ったselect文を入れてみてそれぞれのテーブルがdropされた状態で 試してみられては、と思います。 理由 ▲で使用しているテーブルがないときに、 　　BEGIN TRY 　　　　▲ 　　END TRY 　　BEGIN CATCH 　　　　※１ 　　END CATCH がコンパイルエラーになるので、※２のほうのcatchが処理される。 と思いますが。 参考； http://msdn.microsoft.com/ja-jp/library/ms175976 … の ---引用--- TRY ブロック内の下位の実行レベル (たとえば、sp_executesql またはユーザー定義のストアド プロシージャを実行しているとき) でのコンパイル中またはステートメントレベルの再コンパイル中にエラーが発生した場合、そのエラーは TRY...CATCH 構造よりも下位のレベルで発生し、関連する CATCH ブロックによって処理されます。 次の例は、SELECT ステートメントによって生成されたオブジェクト名解決エラーが TRY…CATCH 構造でキャッチされず、同じ SELECT ステートメントをストアド プロシージャ内で実行した場合には CATCH ブロックでキャッチされることを示しています。 （以下例文が載っていますが省略） ---引用ここまで--- ・・・マニュアルベースで実際には試していないですが。
以下のキーワードで Google 検索すればよいのでは？ ・ sp_MSforeachdb ・ DBCC SHOWCONTIG
insert into テーブルB(会員NO,SEQ,Rank) select a.会員ＮＯ,'7','1' from テーブルＡ as a where SEQ = '1' and Point <> '99' ん？単純に、こういうこと？？？ ただし、 ・一発処理。（定期実行なんぞ考慮してないです。データを用意する目的で、全部データがそろってる状態～で最初に一発だけ流すようなもんです。 ・重複なんぞ考慮してない。（だからこその一発処理。ではあるけど。ついでに言うと、テーブルＢで会員Noでプライマリとってあったりしたら入らないけどね。うん。（まぁ、クエリ実行後のテーブルBを見た限りは、大丈夫か。うん。 定期処理にしたりするのなら、not existsとかでも使ってやる必要があるかと思います。 まぁ、 select a.会員ＮＯ,'7','1' from テーブルＡ as a where SEQ = '1' and Point <> '99' とりあえず、コレだけで実行してみてください。
テストのために以下の項目を持つ「テーブル:日付テスト」を作成し、実証してみました。 　1.[インデックス] ⇒数値型 　2.[日付] ⇒日付型 データには 2012-03-01 00:00:00.000 ～ 2012-05-01 00:00:00.000 までの日付の値を持つデータを追加しました。 質問されている３０日前までのデータを抽出するという条件を満たす条件としては (本日=2012/04/23)として、範囲は 2012-03-24 00:00:00.000 ～ 2012-04-23 23:59:59.999 までとなります。 ですが、実際に重要なのは日付のみであり、時間(hh:mm:ss)は必要ありません。 そこでまずは「項目:[日付]」を「YYYYMMDD」の数値型に変更する事を考えます。 その際の記述としては 　CAST(CONVERT(VARCHAR,[日付],112) as BIGINT) となります。上記の記載でどのように値を変更しているかというと、 １．CONVERT(VARCHAR,[日付],112)で 　　日付型(例:2012-03-01 00:00:00.000)を文字列型(例:20120301)に変換しています。 ２．さらに大小比較を正確に行うために文字列型を数値型(BIGINT)に変換するために 　　CASTを行っています。 　　CAST(CONVERT(VARCHAR,[日付],112) as BIGINT) 　　これで「文字列:20120301」を「数値型:20120301」とすることができます。 次に変換した数値型の日付に対して 2012/03/24<=CAST(CONVERT(VARCHAR,[日付],112) as BIGINT)<=2012/04/23 とすれば、2012/03/24ならば何時であっても抽出範囲に入り、また、2012/04/23ならば何時であっても抽出範囲に入ります。 よって、次に本日日付を「数値型:YYYYMMDD」に変換する事と ３０日前の日付を「数値型:YYYYMMDD」に変換し、その条件をWHERE文に組み込めば完成です。 まずは本日日付を「数値型:YYYYMMDD」にする方法としては 　CAST(CONVERT(VARCHAR,getdate(),112) as BIGINT) となります。 上記の記載は[日付]を「日付取得関数:getdate()」に変更しただけです。 よって、これで「数値型:20120423」となります。 最後に30日前の日付を「数値型:YYYYMMDD」にする方法としては 　CAST(CONVERT(VARCHAR,DATEADD(day ,-30 , getdate()),112) as BIGINT) となります。 こ部分に関しては質問者様が記載されている 　dateadd(d,-30, getdate()) を組み込んだだけですのでご理解いただけると思います。 以上の構文をクエリに組み込みSELECT文を作成すると以下のようになります。 SELECT 　　[インデックス] 　,[日付] 　,CAST(CONVERT(VARCHAR,[日付],112) as BIGINT) FROM　[dbo].[日付テスト] WHERE　CAST(CONVERT(VARCHAR,[日付],112) as BIGINT)>= 　　　 CAST(CONVERT(VARCHAR,DATEADD(day ,-30 , getdate()),112) as BIGINT) 　　AND　CAST(CONVERT(VARCHAR,[日付],112) as BIGINT)<= 　　　　 CAST(CONVERT(VARCHAR,getdate(),112) as BIGINT) 一応検証を取りましたので問題ないと思います。 なお、先頭の空白は見やすくするために全角スペースにしています。 クエリとして使用する際はお手数ですが、半角スペースに変更してください。
http://keicode.com/db/mssql-how-to-check-file-ex … 非公開ストアドプロシージャという理由で使用を控えたいという理由なら、SQL CLR経由でSystem.IO.File.ExistsメソッドやSystem.IO.Directory.Existsメソッドが使えると思います。
ロックを考慮しなければ一般的に INSERT INTO SELECT の方が高速です。 一件ずつキー重複などを判断しなければならないような場合だとカーソルで回す必要があるでしょう。
CAL って昔はサーバーに購入数を入力してたけど、今はないんじゃない？ Windows Serve ではとうの昔に設定が廃止されてます。 結局のところマイクロソフトとあなたの会社との間で結んだ 「契約」 だから、「ちゃんと買う」っていう大人の約束ですよ。
ExpressEdtionの補足ですみません。最新の2012もダウンロードできます。
マイクロソフトのサイトに原因と回避策がありますが、試されましたか？ http://support.microsoft.com/kb/197463/ja 機械翻訳は意味が分かり辛いので英語版のほうが理解し易いと思います。
「sqlserver 表領域」というキーワードで検索すると、 「ファイルグループ」というものが引っ掛かりました。 http://www.atmarkit.co.jp/fdb/rensai/rdbmsarc06/ …
DELETE FROM 社員マスタ WHERE EXISTS ( SELECT 1 FROM 組織マスタ b WHERE 社員マスタ.部署コード = b.部署コード )
http://engineer-memo.com/blogs/engineer-memo/arc … にもありますが、tempdbは初期サイズから必要に応じて拡張され、再起動時に初期設定値に再度初期化されます。 起動されている最中には縮小されませんから、処理量のピーク時にデータファイルのサイズを確認して、初期サイズを再設定することが考えられます。 ただし、本当にtempdbの拡張がパフォーマンスのボトルネックになっているかは別問題です。tempdbへのアクセスそのものがボトルネックになっているならtempdbをデータベースファイルと違うストレージに分散配置するなどして競合を減らすなども考えられます。 そもそも、データベースファイルやログファイルの配置やSQLの記述が問題になっている可能性もあります。 バージョンは古くなりますが「インサイドMicrosoft SQL Server 2005 クエリチューニング&最適化編」などの書籍も参考にしてみてはどうでしょうか。
処理件数を非表示にする方法 ⇒SELECT文の前に「set nocount on」を記載すると件数は表示されません。 SELECT文の発行ごとにSELECT結果がグリッドに表示されるのを非表示にする方法 ⇒デバッグのためには表示された方が良いと思いますが、 　とりあえず…SELECT文の前に「SET NOEXEC ON」を記載するとデバッグだけ実施され、 　グリッドは表示されません。 例であげると以下のとおりです。 SET NOCOUNT ON SET NOEXEC NO SELECT * FROM DB.dbo.TableName go
その製品を使ったことがないので無責任な回答です。 ユーザーズガイドはご覧になってみましたか？ http://www.symantec.com/business/support/index?p … P277 から始まる「Symantec System Recovery を使用したデータベースのバックアップ」 によれば、Windows のボリューム シャドウ コピー サービス (VSS) に対応しているデータベース製品は Symantec System Recovery からの指示が VSS を通じてデータベース製品に行き、自動的にスリープさせるなどの処理が行われると書いてありますが？ コマンドを使って制御しなくてはいけないのは VSS に対応していないデータベース製品をバックアップしたい場合などだそうです。
OSはともかく、DBサーバは同じバージョンを使用するべきでしょう。 ちなみに現在もMSサイトからMSDE2000 SP3 ReleaseA が入手可能。
質問者さんはスルーされていますが、#1さんのSQLも十分スマートだと思いますが・・・。 #1さんは EXISTS 句の中身だけ書かれている様だったので、それ以外を補完してみました。 ------------------------------------ SELECT * FROM テーブル T1 WHERE NOT EXISTS (SELECT 1 FROM テーブル T2 WHERE T1.コード = T2.コード AND T1.区分 = T2.区分 AND ( T1.有効期間開始日 < T2.有効期間開始日 OR T1.有効期間開始日 = T2.有効期間開始日 AND T1.有効期間終了日 < T2.有効期間終了日)); ------------------------------------ 参考URL：http://codezine.jp/article/detail/907
SELECT DISTINCT コード FROM テーブル WHERE コード NOT IN(SELECT コード FROM テーブル WHERE 区分 IN('A01','D01')) ORDER BY 1 です。
集計関数で検索するときは HAVING を使います。 > 3回以上の入金という条件指定ができない SELECT 顧客ID, COUNT(*) FROM 入金テーブル GROUP BY 顧客ID HAVING COUNT(*) >= 3 > 明細を出すところ SELECT * FROM 入金テーブル a WHERE EXISTS(SELECT 1 FROM 入金テーブル WHERE 顧客ID = a.顧客ID HAVING COUNT(*) >= 3)
まずはこれを読んでみたら？ 参考URL：http://msdn.microsoft.com/ja-jp/library/ms187445 …
ANo.2回答者：nharasawa様 MySQLで実際に確認してみて，違いがあることが分かりました。 ANo.2のご説明も納得です，たいへん勉強になりました。
>GOTO 異常終了処理 でcatchブロックの外へ飛ばしてからエラーメッセージを取得できるのかな？ http://msdn.microsoft.com/ja-jp/library/ms179296 … をみると、 「 ・・・ エラー関数 ・・・ ERROR_MESSAGE() はエラー メッセージのテキストの全文を返します。 ・・・ TRY...CATCH 構造の CATCH ブロックのスコープ内であれば、←ここ！ どこからでもこれらの関数を使用してエラー情報を取得できます。 ・・・ 」 とあります。 gotoで飛ばすとCATCH ブロックのスコープ外になりませんか？ 一般にはgotoを使わず、以下のようにすると思います。 ・・・ UPDATE処理 　↓ 　エラー発生(3) COMMIT CATCH ログ出力（エラーメッセージ） ロールバック END ※エラー発生(3)までのエラーがおきなければ、COMMITされ、CATCH～ENDは実行されません。 あと、ＤＢとの接続が切られるようなエラーのときは、Catch以下を実行せずに切断されてしまうようです。（ハードエラーでＤＢが落ちたときとかかな） 詳細は、上記で参照しているサイトをみてください。 だいたいの例文はあると思います。
一ヶ月内でいいなら select 営業日,営業日フラグ, ( select count(*) from テーブル名 a2 where a2.営業日<=a.営業日 and a2.営業日フラグ=1 ) 営業日日数 from テーブル名 複数の月をまたがって月ごとの営業日日数を求めたいなら、分析関数を使うのがいいでしょう。
DSN を利用すれば、Access からは SQL Server がどこにあろうと DSN 名だけを気にすればよい。 開発で本番用 DB に接続することが問題ないのであれば、 <開発> 本番用 DB に接続するための DSN を開発用 PC 内に作成し、開発用 PC の Access で開発を行う。 <本番環境への移行> 本番用 PC 内に DSN を作成し (または開発用 PC 内の DSN を持っていき)、Access DB を本番用 PC に持って行って運用開始する。 ※ 本番用 DSN の名前は開発用 DSN の名前と同じにする。(Access DB は DSN の名前を頼りにしているため)
1 の回答へのコメントへの回答 メッセージ 3902、レベル 16、状態 1、行 2 COMMIT TRANSACTION 要求に対応する BEGIN TRANSACTION がありません。 書いてある日本語の通りです。 BEGIN TRANSACTION Update テーブル名・・・・ COMMIT って書けばいいのです。 ただ、その前に一度「SQL　トランザクション」で勉強されてから、 タスクをこなされた方が良いかと思いますよ？ 何の目的で書いたプログラムなのかはわかりませんが、 トランザクション（transaction、commit、roll back）ぐらいは 把握されてからプログラムを書かれた方が幸せになれると思います。
質問者さんの認識の通り、本来は、deleted.xxxで更新前の値を取ることができます。 下記のような簡単な例で確認できます。 declare @data table (k int, v int); insert into @data values (1,1),(2,2),(3,3); update @data set v=20  output deleted.v, inserted.v where k=2; 従って、書かれている以外の部分に原因があるはずです。
select a.id from a natural join b where flag = 1 and a.id not in (select id from a where flag <> 1); で，削除対象のIDであるBとGが抽出されるので，これを， delete from a where a.id in (……); に組み込めば良いのではないでしょうか。 私の手元にあるDBソフトは同一テーブルを２重にネストしてdelete対象にできないので，別途viewを作る必要がありそうなのですが。
ちょっとまわりくどいですが CASE NUMERIC = '' WHEN THEN 0 ELSE CONVERT(NUMERIC,'1') END と空白NULLチェックすればコケはしないです。 ただし、文字の比較なら思った結果は得られません。 No1の方の指摘どおりになるでしょう それよりはゼロフィルした値と比較したほうが楽ではないでしょうか？ SUBSTRING('0000000000' + 【対象カラム】 , LEN(【対象カラム】) , 10) > SUBSTRING('0000000000' + NUMERIC , LEN(NUMERIC) , 10); パフォーマンス無視なので、レコード数が少ないならこれでも大丈夫ですが、
？？？ Windows 7 32bit の PC に SQL Server 2008 R2 Developer 32bit版と一緒にインストールした SQL Server Management Studio (32bit) からネットワーク越しに SQL Server 2008 R2 64bit版を管理してもいいかってこと？ 大丈夫ですよ。
ストアド内の「動的SQL」はよろしくないようです。 (1) ストアド内に4通りのSQL文を書く (2) クライアント側でSQL文を生成 (3) SQL文を一行で書く WHERE (@param1 IS NULL OR A.COLUMN1 = @param1) AND (@param2 IS NULL OR A.COLUMN2 = @param2) # @param1がヌルのときは、A.COLUMN1を参照しないのでパフォーマンス的に大差ないはず。
select * from テーブルA A1 where not exists ( select 1 from テーブルA A2 where A1.グループ=A2.グループ and exists ( select 1 テーブルB FROM テーブルB B where A2.社員番号 = B.社員番号 )); のようなやり方もあります。 select * from テーブルA where グループ not in ( select グループ from テーブルA where 社員番号 IN ( SELECT 社員番号 FROM テーブルB )); も。
以下で調査可能ですよ。 sys.objectsでテーブルのみ抽出。 ※type='U' sys.objectsとsys.columnsをJOIN ※object_idが一致 sys.typesとsys.columnsをJOINしデータ型の名称を取得 ※system_type_idが一致 >Not Null制約や、 sys.columns.is_nullable >カラムのバイト数、 文字型の場合、sys.columns.max_length 数値型(decimal)の場合、sys.columns.precisionとsys.columns.scale（少数部） >PKかどうか sys.indexesとsys.objectsをジョインし、索引がPKかどうか判定 sys.indexes.is_primary_key sys.columnsとsys.index_columnsをJOINし、索引列を特定 ※sys.columnsとobject_idが一致 ※sys.columnsとcolumn_idが一致 PK列を判定 これらの情報から私はテーブル定義書を逆生成してますよ。
「SELECT *」以外にもinsertで列名を指定しない場合も問題が出ます。 新規にシステムを作る場合は、このような使い方をしないようにすれば、問題は減ります。
アドバイスになるのか、わからないですが．．． メンテナンスを考えて、どうすべきか？ってことが必要かと思います。 各マスタを1つにまとめた場合(※テーブルの項目に種別フィールドで判別するようにする。) の場合は、後でマスタをメンテする場合に、種別フィールドに割り当ててあるコード（かな？）が 画面等ですぐにわかれば良いのですが、そうなっていない場合、 操作説明書なりドキュメントを引っ張り出してきて、探さないとわからないという設計は良くないと思います。 個人的には、マスタを別々に分けた方が良いと考えています。（メンテナンスはしやすいので）
>「テーブルA」の「会員NO」すべての内、 >「テーブルB」の「会員NO」と一致し、かつ「生年月日」が１つも一致しない「会員NO」を拾い出したいと >考えています。 また、 >1 →　会員NOと生年月日が一致する >2 →　テーブルBで会員NOが一致する2件のうち、片方の生年月日が一致する >4 →　会員NOが一致しない とありますので 抽出するデータは必ずテーブルBに存在する必要があります。 その事を考慮に入れ、まず、テーブルBとテーブルAを会員NOと生年月日でLEFT JOINし、 テーブルA.生年月日がNULLになるレコードの会員NOおよびその件数を抽出するクエリを作成します。 　SELECT 　　 BA.会員NO 　　,COUNT(*) AS レコード件数 　FROM テーブルB　 AS BA 　LEFT JOIN テーブルA AS BB 　ON BA.会員NO=BB.会員NO 　AND BA.生年月日=BB.生年月日 　WHERE BB.生年月日 IS NULL 　GROUP BY BA.会員NO これで 会員NO,レコード件数 2 ,1 3 ,2 というデータが抽出されます。 次にテーブルBが会員NO毎に何件ずつあるかを抽出します。 　　SELECT 　　　　 BC.会員NO 　　　　,COUNT(*) AS レコード件数 　　FROM テーブルB AS BC 　　GROUP BY BC.会員NO これで 会員NO,レコード件数 1 ,1 2 ,2 3 ,2 となります。 最後に上記で作成した２つのクエリより会員NOとレコード件数をINNER JOINで結合します。 SELECT B1.会員NO FROM( 　　 SELECT 　　　　　 BA.会員NO 　　　　　,COUNT(*) AS レコード件数 　　 FROM テーブルB AS BA 　　 LEFT JOIN テーブルA AS BB 　　 ON BA.会員NO=BB.会員NO 　　 AND BA.生年月日=BB.生年月日 　　 WHERE BB.生年月日 IS NULL 　　 GROUP BY BA.会員NO 　　 ) AS B1 INNER JOIN 　　 ( 　　 SELECT 　　　　　 BC.会員NO 　　　　　,COUNT(*) AS レコード件数 　　 FROM テーブルB AS BC 　　 GROUP BY BC.会員NO 　　 ) AS B2 ON B1.会員NO=B2.会員NO AND B1.レコード件数=B2.レコード件数 これで 会員NO,レコード件数 3 ,2 のデータのみが抽出できるようになります。 クエリを見やすいように前方のスペースは全角スペースにしています。 利用される際は全角スペースを半角スペースに変換してください。
教科書通りにして、動作しなかったっという質問でしょうか？ それとも教科書の内容を参考に独自アプリを実装したが、想定した通りに動かないという質問でしょうか？ ここでは、後者と仮定して説明します。 //尚、書籍は参照していないので想像で回答しています。 @で始まるのはパラメタライズドクエリと呼称される.NETの仕組みを利用するものであり SQL Server側の機能ではありません。 @変数名を含んだクエリを記述します。 SELECT * from testTable Where name like %@変数名% そして次のようなコードで@変数名に値を代入しています。 SelectParameters.Add("変数名", TextBox1.Text) つまり、 クエリで@GoodsIDと変数名を記述し、別途コードで変数名に値（テキストボックスの内容）を代入します。 おそらく書籍にも、そのような説明が記載されているかと思います。
状況として、 ・SQL Server Management Studio 2008で、SQL Server 2008 Expressに接続すると参照したいデータベースを確認できる。 ・Access 2003で接続するとシステムデータベースしか参照できない。 という認識であってますでしょうか。 上記前提で、まず考えられるのはユーザ権限周りの問題です。 AccessからSQL Serverへの接続は、SQL Server接続（IDとパスワード）でしょうか？ SQL Server Management Studio 2008で、SQL Server 2008 Expressに接続する際にも同じSQL Server接続で接続していますでしょうか？たとえば、Windows認証を使用しているとか…？
SELECT 　　 A.商品CD ,B.商品名 　　,A.得意先CD ,C.得意先名 　　,A.価格合計 FROM ( 　　　SELECT 　　 　　　商品CD 　　　　　,得意先CD 　　　　　,SUM(価格) 　　　FROM 売上明細テーブル 　　　GROUP BY 商品CD,得意先CD ) AS A LEFT JOIN ( SELECT 商品CD,商品名 FROM 売上明細テーブル GROUP BY 商品CD,商品名 ) AS B ON A.商品CD=B.商品CD LEFT JOIN ( SELECT 得意先CD,得意先名 FROM 売上明細テーブル GROUP BY 得意先CD,得意先名 ) AS C ON A.得意先CD=C.得意先CD ORDER BY A.商品CD,A.得意先CD でどうでしょう。
個人的には　PHPオンリーでも可能です メールを送るなら　メールの使えるサーバが必要な程度 条件で検索して　メールフォームから応募は このへんならシンプルに作成できます 求人登録は　認証など必要ないのでしょうか ID認証と　掲載記事の認証など 管理件数はMAXどのくらいを考えているのでしょうか
UPDATE 顧客テーブル SET 担当者 = '中村' WHERE ID IN (SELECT TOP 2 ID FROM 顧客テーブル WHERE 担当者 IS NULL ORDER BY ID)
WHERE 売上日=Date() AND ( 顧客マスタの1フィールド LIKE 'Y%' AND 顧客マスタの1フィールド NOT LIKE 'S%' ) AND 伝票番号%2<>0 質問の意図が読み切れていないのですが、 顧客マスターの1フィールド（S、Y、SL、YL、余白で文字無し）で、 Like "Y"を満たせば自動的に、 Not Like "S"を満たしてしまいますが……。 Y、YL、余白を選択したいという意図でしょうか？ であれば、下のような書き方も…。 WHERE 売上日=Date() AND 顧客マスタの1フィールド NOT IN ('S','SL') AND 伝票番号%2<>0 余白がNULLであるなら、以下でしょうか。 WHERE 売上日=Date() AND ( 顧客マスタの1フィールド IN ('Y','YL') OR 顧客マスタの1フィールド IS NULL ) AND 伝票番号%2<>0
> win7（PRO　64bit)にSQL2008はインストール可能か？ こちらを参照するのが確実だと思います。 http://www.microsoft.com/japan/sqlserver/2008/pr … > クライアントPC（XP)でMSSMSを起動し、サーバー（win7)のDBへの接続は可能か？ 認証設定は必要でしょうが可能だと思います。
あらま・・・。 SQLServerには、何で接続してるんですかね？ 普通のSQL（select * from table）とかって書いて試すビューないですか？？？ そこに貼り付けて実行したら、data_Bテーブルが空っぽで出来上がるはずですが・・・。
(1)が完了した時点でSQL Serverのパスがバッチのプロセス中には設定されていないのでは？ (1)と(2)の間にsetコマンドを挟んでPathの情報を確認してみてください。 >(1)インストール >(2)MDFのアタッチ インストールパスが固定なら(2)でsqlcmdをフルパスで指定すればよいと思います。
SELECT LEFT(列名,LEN(列名)-4) FROM テーブル名 で最後の４文字を取れます。
select t1.KAINo , (select count(*) from テーブルA t2 where t1.KAINo = t2.KAINo and t2.SEQ <= t1.SEQ) from テーブルA t1 KAINo SEQ　 0001 　　 1 0001 　　 2 0001 　　 3 0001 　　 5 0002 1 0002 5 上の順にt1で取得されるとして、 (select count(*) from ・・・)は、それぞれ 1 2 3 4 1 2 となります。 件数多いとちょっと遅いので要注意ですが。
あまり難しいことはせず、SQL文は単純なものが望ましいです。 ちなみに以下のSQL文はデータが存在しない月は0(ゼロ)として 取り扱っていますので必要に応じて修正して下さい。 SELECT [当月], [前月], ([当月] - [前月]) AS [差分] FROM ( SELECT ISNULL([当月],0) AS [当月], ISNULL([前月],0) AS [前月] FROM ( SELECT SUM([当月]) AS [当月], SUM([前月]) AS [前月] FROM ( SELECT [単価] AS [当月], 0 AS [前月] FROM [テーブルA] WHERE [年月] = '2011/02/01' UNION ALL SELECT 0 AS [当月], [単価] AS [前月] FROM [テーブルA] WHERE [年月] = DATEADD(month ,-1 , CAST('2011/02/01' AS datetime)) ) AS T0 ) AS T1 ) AS T2
多分現地のSQL2008は文字長指定が短いのではないでしょか。 SQLに「WHERE DATALENGTH(RTRIM(会員NO))=8」を付加してあげればエラーにならないと思います。
バックアップはふつうテープストリーマを使って定期計画にしたがって行いますが、レストア方法、パックアップ媒体の保管についても十分検討のうえ決めます。案外、レストア時を考慮しない差分バックアップだけ長期にわたってとり続ける素人くさい管理者もいます。 ホットスワップの仕方、レイドシステム異常時の緊急対応方法、手当てが遅れてハードディスク障害を招いた場合の全面復旧方法、サーバーシステムのメーカー保守契約の更新やリース期間終了後のシステム以降、製造中止予定部品の予備調達も対策をこうじていないとなりません。 パフォーマンスチューニングは原因別対策をあらかじめ用意し、必要なら原因特定のための調査分析方法も学ばなくてはなりません。 運用時は毎日システムログ、データベースアクセスログ、ウィルスチェックログ等を確認し異常に気づいたら早急な対応を行う必要があります。またシステム構成要素の保全情報収集活動も欠かせません。業務日誌を記録し、いつ何の作業を行ったか（行わなかったか）トレースできるようにします。作業漏れや設定間違いがないことを記録するには手順書を作り従うこととエビデンスとして設定画面のスクリーンショット作成や設定ファイルのバックアップ等も必須です。このほかに関係部署からのクレームに対する対応の記録もふつうは作成することになります。 その他には、ソフトウェアのセキュリティパッチ適用可否を判断するための試験環境の構築・保持、試験手順書の作成・改訂、試験実施、適用可否報告書の作成もあげられます。場合によってはデータベースシステムのバグ修正やデータ修正、特権ユーザの追加・削除の立ち会い、パスワードの定期更新と関係者への通知、職場によっては修正指示内容に沿った修正作業実施が加わります。
こんにちわ 他の方も書いていますが、 トリガーは実テーブルまたはビューに所属しますので、 無いテーブルに対しては作成できません。 SQLサーバーのストアドか何かで insert しているのであれば、 そのストアドに組み込むことは可能だと思います。 実テーブルのあるDB側で作成するのが、本来のやりかたですね。
付け加えると、SORT処理などが多い場合、TempdbのSSDの配置も効果が見込まれることがあります。
select cd,sum(money),sum(persion) from ( select b.cd1 cd,sum(a.money) money, sum(a.person) person from Aテーブル a,Bテーブル b where a.key_code = b.key_code group by b.cd1 union select b.cd2 cd,sum(a.money) money, sum(a.person) person from Aテーブル a,Bテーブル b where a.key_code = b.key_code group by b.cd2 union select b.cd3 cd,sum(a.money) money, sum(a.person) person from Aテーブル a,Bテーブル b where a.key_code = b.key_code group by b.cd3 ・・・ select b.cd10 cd,sum(a.money) money, sum(a.person) person from Aテーブル a,Bテーブル b where a.key_code = b.key_code group by b.cd10 ) group by cd,order by cd [結果] | cd | money | person | ---------------------------------------------- | 01 | 5000 | 30 | ---------------------------------------------- | 02 | 5000 | 30 | ---------------------------------------------- | 10 | 5000 | 30 | ---------------------------------------------- | 30 | 5000 | 30 | ---------------------------------------------- | 51 | 5000 | 30 | ---------------------------------------------- ・・・ ---------------------------------------------- | 90 | 5000 | 30 | ---------------------------------------------- と出したいということかな？ （違う気がしますが。） ・・・違うなら、サンプルの訂正（[Aテーブル]のkey_codeに002も入れましょう。）と、 結果を明示してください。 [Aテーブル]のcode1,code2,code3が絡むのかもしれませんが、 今の提示では、1か2なので、[Bテーブル]と結合結果は「なし」。 また、 key_code = '000' で結合といわれても、結合結果は「なし」。 最初のサンプルにあわせた形で続きを書かないと意味不明になってしまいます。
予約後だけではなく、命名規則に反したテーブルも[]でくくれば作成できてしまいます。 当然、命名規則に反するのでselectする際もエラーになりますが、select時にも[]でくくればアクセス可能です。 あと、エラーがでるならエラーコードや内容や、本当に発行しているSQL(再現するもの)を書きましょう。 予約語が原因なのか命名規則に反するのか想定でしか書けません。 select * from tableはサンプルなのでしょうか。それでは予約語と突っ込みが入るのはしかたがありません。　 create table 111 (a char(1)) メッセージ 102、レベル 15、状態 1、行 1 '111' 付近に不適切な構文があります。 create table [111] (a char(1)) コマンドは正常に完了しました。 select * from 111 メッセージ 102、レベル 15、状態 1、行 1 '111' 付近に不適切な構文があります。 select * from [111] (0 行処理されました) 当然、数字のみのオブジェクトは命名規則に反します。
ANo.1　nharasawa さんも回答しておられるように、2008もあります。 しかし、Management Studio は、2005と2008は、共存できなかったと思います。 (小生のお客様のXP/Vista/7のOSにて、共存できなかった。) 但し、Expressの場合ですが、インスタンスが重複しなければ、Microsoft SQL server 2005と2008を共存して、小生は利用しています。 －以　上－
>ところで、全部“秒数”なのですが、ミリ秒やマイクロ秒などで ミリ秒まで計れますが、秒以下は全て切り捨てで表示しました。どちらにしても、簡単なSELECTだけの結果なので、念のため。 尚、７種類のRDBMSを扱った中では、SQL　Serverが一番扱いやすく、問題も少ないです。 ちなみに、MONOによるlinuxクライアントでもSQL　Serverが何も追加インストール無で、いきなり動きました。
2000と2005は同時にインストールする事が出来るので、どちらも入っている可能性があります。 サービスにSQL　Server（インスタンス名）があると思いますが、インスタンス名が異なる物が２個有れば、どちらもインストールされていると考えられます。 ただし、最新はSQL　Server2008R2ですので、最新に切り替えた方が良いと思います。
SELECT 大連番,小連番 FROM テーブル T1 WHERE NOT EXISTS(SELECT 'A' FROM テーブル T2 GROUP BY 大連番 HAVING T1.大連番=T2.大連番 AND MAX(T2.小連番)=T1.小連番) ではどうでしょうか。
方法は変更するので心苦しいのですが、ADOを使用して接続したほうが良いように思います。 　　　　Dim StrDBConect As String　　　　　　　　'DB接続文字列 　　　　Dim AdoConnect As New ADODB.Connection　 'ADO接続 　　　　Dim AdoCommand As New ADODB.Command　　　'ADOストアド実行用 　　　　Dim AdoRecordset As New ADODB.Recordset　'ADOレコードセット実行用 　　　　Dim StrSQL As String　　　　　　　　　　 'クエリ文挿入用 　　　　StrDBConect = "" 　　　　StrDBConect = StrDBConect & "Provider=SQLOLEDB;" 　　　　StrDBConect = StrDBConect & "Data Source=データベースサーバ名;" 　　　　StrDBConect = StrDBConect & "Initial Catalog=Northwind;" 　　　　StrDBConect = StrDBConect & "Persist Security Info=True;" 　　　　StrDBConect = StrDBConect & "User ID=SQL Server ログインユーザＩＤ;" 　　　　StrDBConect = StrDBConect & "Password=SQL Server ログインパスワード;" 　　　　 　　　　'データベースに接続 　　　　AdoConnect.ConnectionString = StrDBConect 　　　　AdoConnect.Open() 　　　　'コマンドを実行する接続先を指定 　　　　AdoCommand.ActiveConnection = AdoConnect 　　　　'SQL文を作成する 　　　　StrSQL = "" 　　　　StrSQL = StrSQL & "SELECT FirstName FROM Employees;" 　　　　 　　　　'パラメータを？マークで指定する 　　　　AdoCommand.CommandText = StrSQL 　　　　AdoRecordset = AdoCommand.Execute 　　　　Do Until AdoRecordset.EOF 　　　　　　msgbox(AdoRecordset("FirstName").Value) 　　　　　　AdoRecordset.MoveNext() 　　　　Loop 　　　　AdoRecordset.Close() 　　　　AdoConnect.Close() 　　　　AdoRecordset = Nothing 　　　　AdoCommand = Nothing 　　　　AdoConnect = Nothing ちなみに上記の方法でプログラミングを行う場合、 参照定義に「Microsoft ActiveX Data Objects 2.x Library」を追加する必要があります。 ※ 内容を見やすくするため、ソースの前には全角スペースを入れています。 複写される場合は半角スペースに置換してください。
SQL Server 2008 Express with Advanced Services なら PowerShell 1.0 下記ページ内で 「powershell」 で検索してみてください。 http://msdn.microsoft.com/ja-jp/library/ms143506 … 事前に下記を手動でインストールしておく必要があります。 .NET Framework 3.5 SP1 Windows インストーラー 4.5 Windows PowerShell 1.0。
書き忘れ。 ANO6のRAISERRORはSQL Server2005の新機能です。 （このQ/Aを参照された他のかたのために記載しようと思って忘れてました。 ・・・といいつつ、書いている本人のためだったりして。）
No.3です。 すみません。 すでに nda23さんが同様の回答（1レコードにまとめるか別レコードに分けるかが違いますが）をされていましたね。 また、補足に >データ項目は数値項目です。顧客コードも数値で入っています。 とあるのに、余計な変換も入れてしまいました・・・ ちゃんと読まずに申し訳ないです。
SQL Serverも教育機関向けライセンスプログラムがあるみたいですね。 http://www.microsoft.com/ja-jp/education/license … より。 アカデミックパックならば、 http://www.microsoft.com/ja-jp/education/license … より Q. アカデミックパックを譲渡するのは可能ですか？ A. 譲渡先がアカデミック対象ユーザーに該当していれば、譲渡可能です。 とあるので、そちらが、アカデミック対象ユーザーに該当していなければ 譲り受けることができないですね。 ⇒譲り受けることができないなら、通常バージョンに変更することはできず、 　新規購入するしかないでしょうね（必要なら。） 　使用に関しても同様。 譲り受けることができたとして、 ライセンスについては、永続ライセンス（取得後に卒業などで取得する資格を失ってからも使える） らしいのでその後の費用は有償サポートを除けばいらないのかな。 教育機関向けライセンスプログラムはアカデミックパックだけではなく、 スクールアグリーメントみたいに非永続ライセンスのものもあります。 ものによって内容もまちまちです。ものを特定しないとどうこう言えません。 ＭＳのカストマーインフォメーションセンターにでも聞いてみれば？ （購入前の質問しか受け付けていないですけど、質問の答えしだいでは購入することになる 　かもしれないからここへ質問して問題ないはずですよ。） URLは以下です。 http://support.microsoft.com/contactus/?ln=ja
データベースに限らず，ネットワーク，セキュリティ，プログラミング，ソフトウェア，ハードウェア，なんでもかんでも。 技術の進歩ってすべて，人類が創り出した英知の結晶と言うに値するんじゃないですか。
デフォルト設定でインストールしている場合は、記載のような動きになることはありません。 まずは、サーバの設定状況の確認が必要です。 SQL Server構成マネージャで、両方のサーバーのインスタンス名を確認してください。 さらに、SQL Browserの起動有無も確認してください。 SQL Serverのサーバ名のみを指定した場合、 自動的にインスタンス名MSSQLSERVERが自動補完され、 MSSQLSERVERインスタンスに接続します。 次に、インスタンス名を指定した場合はSQL Browserが名前解決をします。 しかし、現在説明ただいている状況になるパターンが想像できません。 インスタンス名とポートの組み合わせの確認でしょうか。 //変更したくないとおっしゃられている以上、変更前と同じ接続文字列（サーバー名\インスタンス名も含めて）を使用しようとしているって認識であってますよね？
>最初に投稿されたコメント の定義がはっきりしないので（投稿日が日付だけなのであれば投稿順が分かりませんし）、 コメント番号の一番小さいものを最初のコメントとして考えました。 select a.エントリ番号,b.コメント番号,b.元コメント番号,b.コメント内容 from ( select ta.エントリ番号,min(tb.コメント番号) as 最初のコメント番号 from ブログエントリ ta inner join コメント tb on (ta.エントリ番号 = tb.エントリ番号) group by ta.エントリ番号) a inner join コメント b on (b.コメント番号 = a.最初のコメント番号 or b.元コメント番号 = a.最初のコメント番号) order by b.コメント番号; こんな感じでしょうか。
SELECT A_取引先.* FROM A_取引先 WHERE NOT EXISTS ( SELECT 1 FROM B_売上 WHERE A_取引先.取引先CD=B_売上.取引先CD) なんてのもあります。 B_売上.取引先CDにINDEXがあればかなり高速です。
ツール→オプション→クエリ結果→結果をグリッドに表示の 「結果のコピーまは保存時に列のヘッダーを含める」 にチェックを入れれば可能
SQL Serverのバージョンによってはダメかもしれませんが。 select count(distinct 科目) as 科目種類 from テーブル; でも。
デフォルトでは自動拡張になっています。テーブルを格納するデータファイルも自動拡張になっています。 データファイルの最大サイズを制限することや、データファイルサイズの監視は出来ます http://social.msdn.microsoft.com/Forums/ja/sqlse … 個別のテーブルについては、「sp_spaceused」と「sp_send_dbmail」を使って監視可能ですが、「sp_send_dbmail」はExpressEditionではサポートされないので、その場合は工夫が必要です。 「sp_spaceused」 http://msdn.microsoft.com/ja-jp/library/ms188776 … 「sp_send_dbmail」 http://msdn.microsoft.com/ja-jp/library/ms190307 …
oracleの(+)は外部結合の右側、right joinの左側を意味します。 なので select * from (select cal1,cal2,cal3 from tbl1,tbl2 where cal1 >100) aaa left join (select cal1,cal2,cal3 from tbl1,tbl2 where cal1 <=100) bbb on aaa.cal1 = bbb.cal1 and aaa.cal2 = bbb.cal2 and aaa.cal3 = bbb.cal3 inner join tbl3 on aaa.cal1 = tbl3.cal1 かな。ただし、元データが同じで「cal1 >100」と「cal1 <=100」では「cal1」が100でないと「bbb」側はすべてNULLになるのですがいいのでしょうか？
select 年度,count(distinct 国),count(distinct 種類) from テーブル1 group by 年度 order by 年度 で出ます。
過去の質問に http://okwave.jp/qa/q6534575.html というのがありました。 まず、ログを確認してください。 後、AWEで使えるのはバッファプールだけなのでその他の作業領域が不足しているとするとエラーが解消されない可能性もあります。
＞Replace関数だと一度に一つしか削除できないようなので何か方法がないかと ＞思案しております。 Replace関数を入れ子にすればよろしいかと。 Replace(Replace(Replace(Replace(Replace(商品名, '.', ''), ',', ''), '-', ''), ' ', ''), '/', '') もちろん、関数を作ればカッコイイですけど。 ORACLE なら既に REGEXP_REPLACE なんて関数があります。
[所属テーブル]、[住所テーブル]の構成が良くないですがSQLを作るとしたら以下の通りです。 SELECT T0.[名前], T0.[性別], T1.[住所], T0.[所属] FROM [所属テーブル] AS T0 LEFT JOIN [住所テーブル] AS T1 ON T0.[名前] = T1.[名前] AND (T0.[性別] = T1.[性別] OR T0.[性別] IS NULL)
http://msdn.microsoft.com/ja-jp/library/ms187887 … あらかじめ、インサートする対象のフィールドにデフォルト値で空文字列を設定します。この状態でBULK INSERTを実行すれば空文字列が設定されます。
あなたのおっしゃっているPeer To Peerのシステムがイメージできません。 もう少し具体的に補足してください。
こちらが参考になるでしょうか。 http://social.msdn.microsoft.com/Forums/da-DK/tr … Google翻訳： http://translate.google.co.jp/translate?hl=ja&sl …
>「'対象テーブル名'」には変数がいれられないので、どうしようかと悩んでいます。 declare @tblname varchar(100) set @tblname = '対象テーブル名' DECLARE CURS_test CURSOR FOR 　 SELECT name FROM dbo.syscolumns 　 WHERE id IN 　 (SELECT id FROM dbo.sysobjects WHERE name = @tblname) 　 ORDER BY id, colid; >カラム名をカンマで繋げてひとつの変数に格納する方法がわかりませんでした。 declare @colnm varchar(100) declare @colnmconcat varchar(100) set @colnmconcat = '' fetch next CURS_test into @colnm While @@fetch_status = 0 begin if @colnmconcat = '' begin set @colnmconcat = @colnm end else begin set @colnmconcat = @colnmconcat + ',' + @colnm end fetch next CURS_test into @colnm end こういった感じでどうでしょう？（未検証ですが。）
このSQLでは >dbo_TblAには以下のようなデータが2行入っています。（重複している） >SYAINCD XXXXX >StartDT 2011/1/1 >EndDT 2011/12/31 >YuukouDT 2011/1/2 のデータが2レコードのみ存在する場合は2件のレコードが返されると思います。 dbo_TblAのStartDTに2011/1/2以降のデータまたはYuukouDTに2011/1/3以降のデータが 1レコードのみ存在した場合SQLの結果がはじめて1レコードになります。(もちろんSYAINCD='XXXXX') 条件文を (H.StartDT)=( SELECT MAX( K.StartDT) FROM dbo_TblA K, dbo_TblA L WHERE K.SYAINCD = H.SYAINCD AND L.SYAINCD = K.SYAINCD AND L.StartDT = K.StartDT AND L.YuukouDT = K.YuukouDT AND L.StartDT <= '2011/04/20') と (H.YuukouDT)=( SELECT MAX(H_ED.YuukouDT) FROM dbo_TblA H_ED WHERE H.SYAINCD = H_ED.SYAINCD AND H.StartDT = H_ED.StartDT AND H_ED.YuukouDT <= '2011/04/20') にわけて考えればわかりやすいと思います。 何を抽出するSQLかわかりませんがこんな奇怪なSQLは書かないように努力しましょう。
ExecuteNonQueryメソッドを使えばUPDATE、DELETEの対象件数が戻り値になります。
環境がないのでAcc2000でしか確認できていませんが、 MSysObjectsというテーブルの中のデータベースというフィールドに記載されていると思います。 表示方法は、 http://www.tsware.jp/tips/tips_126.htm
SQLは基本一緒です。最も重要なことはWindows上でしか動かないこと。 特徴としては、 ・UNDO、REDOともにトランザクションログとして管理する。 ・DBのブロックサイズが8KB固定で領域管理は8ブロック（64KB）を1エクステントとして管理 ・UPDATE文にFROM句があるなどの拡張構文あり。 ・バッチという概念がある（いまゆるバッチ処理ではなく一連のSQLの処理単位）。 ・サーバーのメモリをSQLSERVERが最大限使用することが基本。
直接テーブルに書き込むこともできますが、安全を 考えて、新しいテーブルにデータをすべて書き出す ことにしました。 質問のテーブル名を「Tポータルサイト」とします。 準備として「Tポータルサイト」と同じ構造の 空のテーブルを一つ用意をしておいてください。 名前を「T書き込み用」とします。 そのとき、フィールドの数を適当に増やして置いて ください。見た目は同じでも空白や改行コードが 入っていると違うデータとして判断します。どちらかと 言えば、目いっぱい設定しておくほうがいいかもしれません。 たとえば、yahoo!　というポータル名がたくさん存在 するならばそれだけ一目では分かりにくいデータ が紛れ込んでいる可能性もあります。 なお、フィールド名は先頭の「ポータル名」だけは 固定で、あとはどのようなフィールド名でも かまわないようになっています。「ポータル名」 も実際に合わせて変更してください。 もし、実行後、データの抽出数が予定より 多い場合は、たとえば、 SELECT * FROM Tポータルサイト WHERE (((Tポータルサイト.ポータルサイト名)="yahoo!")); のように、特定のポータルサイト名を指定して確認、修正も できます。 では、以下のコードを実行してみてください。 一応、DAOで記述しています。 なお、参照設定で Microsoft Scripting Runtime にチェックを入れてください。DAOのチェックの確認も。 Sub testポータル() Dim db As DAO.Database Dim rs1 As DAO.Recordset Dim rs2 As DAO.Recordset Dim rs3 As DAO.Recordset Dim strSQL As String Dim dic As Object Dim v As Variant Dim k As Variant Dim i As Long Dim j As Long 'テーブルのポータルサイト名の名寄せのSQL文 strSQL = "SELECT ポータルサイト名 FROM Tポータルサイト GROUP BY ポータルサイト名;" Set db = CurrentDb Set rs1 = db.OpenRecordset("Tポータルサイト") Set rs2 = db.OpenRecordset(strSQL) Set rs3 = db.OpenRecordset("T書き込み用", dbOpenDynaset) Set dic = CreateObject("Scripting.Dictionary") If rs2.RecordCount > 0 Then rs2.MoveFirst Do Until rs2.EOF If rs1.RecordCount > 0 Then rs1.MoveFirst Do Until rs1.EOF For i = 0 To rs1.Fields.Count - 1 v = rs1.Fields(i).Value If rs2!ポータルサイト名 = rs1!ポータルサイト名 Then '配列へデータ格納 If Not IsNull(rs1.Fields(i)) Then If Not dic.Exists(v) Then dic.Add v, v End If End If End If Next i rs1.MoveNext Loop End If 'テーブルへデータの書き込み k = dic.Keys rs3.AddNew For j = 0 To dic.Count - 1 rs3.Fields(j) = k(j) Next j rs3.Update dic.RemoveAll rs2.MoveNext Loop End If Set dic = Nothing rs1.Close: Set rs1 = Nothing rs2.Close: Set rs2 = Nothing rs3.Close: Set rs3 = Nothing db.Close: Set db = Nothing End Sub
「>=」、左辺値が右辺値以上。 「=<」、このような演算子はありません。「<=」の誤りです。 オフィシャルなマニュアルは http://www.postgresql.jp/document/9.0/html/ にありますが、 http://books.shoeisha.co.jp/book/b81869.html あたりを購入して勉強することをお勧めします。
ANo3です。 書き忘れ。 ただし、TableAに「名前」がNullの「ID」があり、このＩＤをキーとした場合は TableBの「名前」ではなく、TableAの「名前」すなわち、 Nullを出力したいという仕様でないことが条件です。
何がしたいのか分かりません。 >文字を登録したいです。 >「邉」がパソコンに登録してない 登録とは何ですか? MS-IMEの単語登録ですか? であれば「文字」を登録するという言い方で何を言おうとしているのかよく分かりません。 漢字変換でこの文字が出るようにしたいのですか? >渡辺→渡邉と入力したい これは何ですか? 「渡辺」という文字から「渡邉」に変換するのですか? >文字コードが無いからだと思うのですが 意味が分かりません。文字コードは環境によってあったりなかったりするものではありません。 >「渡・」と文字化けではないのですが「邉」が「・」で表示されております。 それを文字化けというのではないですか? またその表示されている環境が重要です。どこで表示されているのですか? >サーバー：Microsoft SQL Server 2008 >クライアント：Windows XP Service Pack 3 唐突にそんなことを言われても困るのですが。まずあなたは何をしているのですか?
#1 です。状況説明、ありがとうございます。 しかし・・・・・・・。やはり ODBC のデータソース作成の際、デフォルトデータベースが、DB1になっていなかったのでは・・・・・くらいしか思いつきませんでした。ごめんなさい！(>_<)。
名称でグルーピングして、区分が2,3,4のレコード件数が0のものを取得する。 select 名称 from テーブル group by 名称 having count(case when 区分 in (2,3,4) then 1 else null end) = 0; もしくはnot existsを使って select distinct 名称 from テーブル a where not exists (select * from テーブル b where a.名称 = b.名称 and b.区分 in (2,3,4)) and 区分 not in (2,3,4) --なくても結果は同じです ; とかでも。
SQLAzureMW http://sqlazuremw.codeplex.com/ を使用すれば、SQL Server 2008 R2からSQL Server 2005へ移行できます。 移行したいSQL Server 2008 R2がインストールされたローカル上で、 本ツールを使用し、ローカルもしくはNW上のSQL Server 2005に DBをコピーします。 コピーが完了すれば、そのファイルを使用すればオフライン環境の SQL Server 2005にも持っていけます。
ああ、単純な記述ミスでした。 No=Case when @no is null then No else @no end ＊↑でなぜ条件をみたすのかは理解できているでしょうか？ 　あと、Case文の文法は自分で調べましたか？ 　というのはちょっと気になります。 　
サブクエリで取得するのが簡単なのではないでしょうか。 こんなイメージです。 select 　年月,ID,体重 as 今月体重 ,(select 体重 from テーブルA b where b.ID = a.ID and b.年月 = a.年月の1か月前) as 前月体重 from テーブルA a where a.年月 = 2011年02月; 年月のデータ型が分かりませんし、SQL Serverでの日付関連の処理に詳しくないので >a.年月の1か月前 この部分はご自身でうまく処理してください。
SQL SERVERはあまり詳しくないのですが、単純復旧モデルでもトランザクションが長い場合はそれなりにログが肥大化してしまうのではないでしょうか。 トランザクションが終了してしまえば、領域は再利用可能になりますが、ファイルサイズ自体は自動では縮小しないと思います。 定期的にDBCC SHIRNKＦＩＬＥの必要性があるのではないでしょうか。
・SQL Server の基本的な操作等については、マイクロソフトのサイトに「自習書」がありますので、 　そちらを参考にされたら良いかと思います。(参照URL) ・データベースさえできてしまえば、データの出し入れは Oracle とほとんど変わりないと思います。 ここで，疑問点ですが、 ・SQL Server はOracleと別にサーバーを構築するということですか? 　または、Accessの様に各PCにインストールする想定ですか? もし、Access の様に 各PCにインストールするのであれば、SQL Server Express Edition を使用します。 ご存じとは思いますが、Developer Edition は開発または教育用のみで、業務では使用できません。 SQL Server Express Edition はマイクロソフトのサイトから無料でダウンロードできたと思います。 VB2005 にも添付されているかもしれません。 参考URL：http://technet.microsoft.com/ja-jp/sqlserver/cc7 …
それだけの情報だとよくわかりません。１つのテーブルから取得するのか、データとは文字列なのか他のテーブルの項目とJOINしたいのかなど詳細がわからないと答えようがないと思います。 ■完全一致 select * from （テーブル名） 　　where （項目A） = '（検索したい文字列）' or （項目B） = '（検索したい文字列）' ■部分一致 select * from （テーブル名） 　　where （項目A） like '%（検索したい文字列）%' or （項目B） like '%（検索したい文字列）%' これではダメでしょうか？
select コード,sum(数量) from ( select テーブルB.コード,テーブルB.数量 from テーブルB left join テーブルA on テーブルB.コード = テーブルA.コード union select テーブルB.コード,テーブルB.数量 from テーブルB left join テーブルA on left(テーブルB.コード,4) = テーブルA.コード and テーブルB.コード not exists (select テーブルA.コード from テーブルA x where テーブルB.コード = x.コード) ) group by コード order by コード といった感じのｓｑｌでどうでしょう？ ポイントは、テーブルBのコードがテーブルAにあるときとないときで別々にJoinしてunionした結果を group byするということで。
お使いのバージョンは本当に「2008R2」でしょうか？ 「2008R2」のExpress版はまだ出てなかった気もするのですが。 TIME型が追加されたのは2008からです。一度バージョンを確認してみてください。
こんなのでどうでしょ。 SELECT A.料理名 , ISNULL(MAX(CASE B.オプション WHEN '00' THEN '1' END), '0') + ISNULL(MAX(CASE B.オプション WHEN '01' THEN '1' END), '0') + ISNULL(MAX(CASE B.オプション WHEN '02' THEN '1' END), '0') AS オプション FROM 料理テーブル AS A LEFT JOIN オプションテーブル AS B ON A.料理名 = B.料理名 GROUP BY A.料理名
AccessのvbaでSQLServerに接続してデータを追加したらどうでしょうか。 別EXEを作成、管理する手間も省けますし。
リンクテーブルを作り直す。 ＤＡＯで動的に接続先を変更することも可能らしい。 http://billyboy.blog81.fc2.com/blog-entry-104.html
このあたり？ http://awoni.net/fc/remote/
高速化のアドバイスだけ。 (1) > AND u.保管河岸コード =isnull(@保管河岸コード,u.保管河岸コード) AND (@保管河岸コード IS NULL OR u.保管河岸コード = @保管河岸コード) と書いたほうがよい。 @保管河岸コードがNULLのときは、u.保管河岸コードを参照しなくてすむ。 また、列を右辺に書くとインデックス検索にならない可能性がある。 (2) WHERE 条件1 AND 条件2 AND 条件3 ... のように複数の条件を指定するときは、以下の優先順位で指定する プライマリーキーによる検索 インデックス付の列による検索 絞込みがきつい条件 逆に言うと、WHERE で頻繁に使用する列にインデックスを付ける
codeの値を一意に設定することは可能ですが、そのためにはどういう順番で連番をふるかの情報が必要です。 「作りたいテーブル」の例だと、無理やりやろうとするならストアドプロシージャでループし、(code_up code_low)が同一でcodeが振られていない場合はカウントアップしながら更新していくイメージでないと実現できないと思います。実行速度が心配です。 ( code_up, code_low ) 順に連番を振るのなら update テーブル set code = s.rn from ( select row_number() over( order by t.code_up, t.code_low ) as rn, t.* from ( select distinct * from テーブル ) t ) s where テーブル.code_up=s.code_up and テーブル.code_low=s.code_low; で実現できるはずです。
>「ユーザが入力するSQLServer用のログインIDとパスワードを使う」 >という項目が選択出来るのですが、どちらを選択し、ログインIDとパスワードは >何を設定すればよいのかが分かりません。 おそらくManagement Studioで作業してますよね？ で、あれば、まずはManagement Studioで指定している方式とユーザで試してみてください。 ※おそらくsaでログインしていると思います。 ただしsaでログインするのは権限が大きすぎるのであれば、 このODBCで使用する用途にあったユーザを作成してください。 Management Studioの「セキュリティ - ログイン」から「新しいログイン」で 作成できます。 セキュリティに関わるので適切な権限を割り当てましょう。
select 氏名 ,sum(case when 科目 = '国語' then 得点 else null end) as 国語 ,sum(case when 科目 = '英語' then 得点 else null end) as 英語 from 得点データ group by 氏名; でいいのでは？ 2005以降ならpivotを使ってもいいのかもしれません。 自分では全く使ったことが無いというかSQLServerの環境自体が無いので書き方は分かりませんが。
追記　前の回答で「標準的なクエリ」というのは取り消します。 （簡単だと思ったら、ＤＢＭＳごとにだいぶ異なるようです） SQL Server 2005 では下のように、結合が使用できるようです。 （試してはいませんが・・・） -- テーブルを結合して更新する update a set a.visit_point = b.visit_point from a_table a, b_table b where a.member_no = b.member_no -- 相関サブクエリを使った例 update a_table a set visit_point = (select b.visit_point from b_table b where a.member_no = b.member_no) where exists (select null from b_table b where a.member_no = b.member_no) -- 更新する値が複数ある場合は set (col1, col2) = (select table1.col1, table2.col2 from table1 ...) のようにする。
そのテーブルに主キーのように一意性のある列がなく、すべての列を見渡しても全く同じ値が入っているレコードが複数あるってことでしょうか。 Management Studio のツールでは、一意の区別がつかない場合は全ての列の値を使って更新対象レコードを一意に識別しようとしますが、それでも更新対象レコードの区別がつかない場合はエラーになります。 素直に [新しいクエリ] で SQL を書いたほうが良いかと。 まぁ何かのテストデーターなのかもしれませんが、すべての列を見比べても全く同じ内容のレコードが複数必要な場面ってあるんでしょうかね。。。
>私はいつもSQL Server Management Studioで削除したいDBを選択して、右クリック＞削除でDBを削除していますが、mdfファイルが残ることもあるのでしょうか。 本作業では、一切MDFファイルは削除されません。 削除されるのは、SQL Serverの管理下から外れるだけです。 SQL Server Management Studioのオブジェクト絵ウクスプローラー上に表示されないデータベースが使用していたファイルを削除しても問題ありません。 また、SQL Serverが動作している状態では、データベースが使用しているファイルは消すことができません。 ですので削除できる場合は、データベースで使用していないファイルです。
＞　＜データベース名＞．＜テーブル名＞．＜列名＞ ではなく以下です。 <データベース名>.<スキーマ名>.<Table名>.<列名> スキーマ名が抜けてます。スキーマ名はデフォルトだとdboです。 ※自データベース内かつデフォルトだと<データベース名>.<スキーマ名>が省略可能。 あと、SQLを発行しているユーザ（ログイン）は異なるデータベースを参照可能ですか？ 権限がないと参照できませんのでログインのプロパティからサーバロールとユーザマッピングを調べてください。
あ、ごめんなさい。 ANo1のものです。 ミスしてます。 ANo1では、 yotei_id　　jishi_day　　ninzu　　shiten　　shain_yotei_id　　shain_nam 5　　　　　　2011/7/5　　3　　　　支店B　　　　Null　　　　　　Null ができてしまいます。 >insert into #TMP >select a.yotei_id,a.jishi_day,a.ninzu,a.shiten,b.shain_yotei_id,b.shain_nam >from tbl_yotei a,tbl_shain_yotei b where a.yotei_id = b.yotei_id > >を実行する。（shain_yotei_idとshain_namがNULLでないレコードが格納される） まではいいのですが、 >select max(ninzu) from tbl_yotei >の値を取得する。 ここは、 select yotei_id,ninzu from tbl_yotei をカーソルで取得して、１件ずつ処理する必要があります。 > >while等を使って1から上で取得したmax(ninzu)まで以下のＳＱＬを繰り返す。 >insert into #TMP >select a.yotei_id,a.jishi_day,a.ninzu,a.shiten,NULL,NULL >from tbl_yotei a >where (select count(*) from #temp b where b.yotei_id = a.yotei_id) < 繰り返しの値 これは、上で取得したレコード毎に繰り返し処理します。 ということで、 (元質問に書かれているのと同様に) DECLARE c_yotei cursor FOR SELECT yotei_id,ninzu FROM tbl_yotei OPEN c_yotei FETCH NEXT FROM c_yotei INTO @yotei_id, @ninzu WHILE @@FETCH_STATUS = 0 BEGIN set @i = 1 while @i > @ninzu insert into #TMP select a.yotei_id,a.jishi_day,a.ninzu,a.shiten,NULL,NULL from tbl_yotei a where a.yotei_id = @wk_yotei_ID and (select count(*) from #temp b where b.yotei_id = @wk_yotei_ID) < @i set @i = @i + 1 end FETCH NEXT FROM c_yotei INTO @yotei_id, @ninzu end ということで。 （すいませんでした。）
「どうにかしてある項目」をいつ作るかについて。 ＯＲＡＣＬＥですと関数インデックスを使う場面ですが、 ＳＱＬＳｅｒｖｅｒでは計算列が使えますね。
「SQL Server 構成マネージャ」で、 ・TCP/IP ・名前付きパイプ が無効なのでは？
これでいかがでしょうか。 select * from table1 where replace(replace(col1,' ',''),'　','') like '%NTTデータシス%'
strSelect &= " inner join (select * from クライアントマスタ union select * from 関連会社マスタ) as CM on TM.ClientNO = CM.ClientNO " これはunionしているから仕方ないですけど、 他のjoinの大半について。 strSelect &= " left outer join (select * from コードマスタ where 識別コード=00002) as CO2 on TM.内容NO = CO2.汎用コード"　 などはなんでleft outer join (select * from ・・・)なんですか？ left outer join コードマスタ as CO2 on TM.内容NO = CO2.汎用コード and 識別コード=00002 としていないから副問い合わせをした結果と結合するので、 インデックスは使えないし、作業用にメモリかディスクは食っているし負荷とレスポンスの大敵と なっていますけど。 なお、 inner join (select * from クライアントマスタ union select * from 関連会社マスタ) as CM on TM.ClientNO = CM.ClientNO も、 inner join クライアントマスタ as CM1 on TM.ClientNO = CM1.ClientNO inner join 関連会社マスタ as CM2 on TM.ClientNO = CM2.ClientNO として、冒頭のSelect句の、 select CM.クライアント名 as クライアント, を select case when CM1.クライアント名 is not null then CM1.クライアント名 else CM2.クライアント名 end as クライアント, とし、末尾のwhere句に and (CM1.クライアント名 is not null or CM2.クライアント名 is not null) としたほうが、私が思っているデータ量なら、はやいと思います。 （select * from クライアントマスタ union select * from 関連会社マスタ 　が数十件程度しか取得しないのならこちらは無視してください。）
この現象はSQLサーバーでは普通です。 SQLサーバーはメモリーをあるだけ使いにいきます。 再起動すれば、元に戻ります。 もし、他のアプリに影響があるならば、上限の設定をしてください。
こんにちは。 こちらで掲載されている内容のことでしょうか？ http://oshiete.goo.ne.jp/qa/1677227.html 上記で張ってあるSiSのリンクが古いので下記ダウンロードサイトでOSやドライバを選択してダウンロード可能です。英語サイトですが具体的な更新方法についてはこちらのＦＡＱを参考にしてみては？ http://w3.sis.com/download/ 参考URL：http://w3.sis.com/download/
JDBC接続を主に紹介したのですが、実際やってみるとSQL Server 2005 jdbc driver からだと正常にSQL Server 2008 に接続できないようです。 なので、無難にODBC接続をお勧めします。
エラーどおりなので、Selectした結果とジョインして更新をかけます。 ※この場合、コードが一意にならないと駄目です。 create table test ( コード varchar(10), 名前 varchar(10), 連番 int ); insert into test values('001','AAA',null); insert into test values('002','BBB',null); insert into test values('003','CCC',null); select * from test; UPDATE test SET test.連番 = b.NewNo FROM test inner join ( select コード, (ROW_NUMBER() OVER(ORDER BY コード) + 14) as NewNo FROM test) as b on test.コード = b.コード ; select * from test; (1 行処理されました) (1 行処理されました) (1 行処理されました) コード 名前 連番 ---------- ---------- ----------- 001 AAA NULL 002 BBB NULL 003 CCC NULL (3 行処理されました) (3 行処理されました) コード 名前 連番 ---------- ---------- ----------- 001 AAA 15 002 BBB 16 003 CCC 17 (3 行処理されました)
こんにちわ。 詳細な条件が不明なのでなんとも言えないですが 「UNION」結合ではどうでしょうか？ 例で言えば IDの1～3の3件、ID昇順 UNION ALL フラグ=2の2件、ID昇順 UNION ALL ID3以降、且つフラグ<>2、ID昇順 というようにやれば抽出できそうですが…
補足 週の数え方については以下を参照。 http://ja.wikipedia.org/wiki/%E6%97%A5%E4%BB%98 http://msdn.microsoft.com/ja-jp/library/ms174420 … 製造系だと週の考え方がやっかいです。 多分、指摘されます。
少し違う形ですけど、検索範囲がかわっても単純だから動的に組み易いかな select hinmei_id ,MAX([6-12_in]) as '6-12_in' ,MAX([6-12_out]) as '6-12_out' ,MAX([6-13_in]) as '6-13_in' ,MAX([6-13_out]) as '6-13_out' ,MAX([6-14_in]) as '6-14_in' ,MAX([6-14_out]) as '6-14_out' ,MAX([6-15_in]) as '6-15_in' ,MAX([6-15_out]) as '6-15_out' ,MAX([6-16_in]) as '6-16_in' ,MAX([6-16_out]) as '6-16_out' FROM( select hinmei_id ,ROW_NUMBER()over(partition by date order by hinmei_id ) as 'R' ,case [date] when '2011-06-12' then in_suryo else null end as '6-12_in' ,case [date] when '2011-06-12' then out_suryo else null end as '6-12_out' ,case [date] when '2011-06-13' then in_suryo else null end as '6-13_in' ,case [date] when '2011-06-13' then out_suryo else null end as '6-13_out' ,case [date] when '2011-06-14' then in_suryo else null end as '6-14_in' ,case [date] when '2011-06-14' then out_suryo else null end as '6-14_out' ,case [date] when '2011-06-15' then in_suryo else null end as '6-15_in' ,case [date] when '2011-06-15' then out_suryo else null end as '6-15_out' ,case [date] when '2011-06-16' then in_suryo else null end as '6-16_in' ,case [date] when '2011-06-16' then out_suryo else null end as '6-16_out' from meisai )X group by R ,hinmei_id 下記を参考にしました。　 参考URL：http://www.oreilly.co.jp/books/9784873113159/
sp_helpsrvrolemember というストアド プロシージャを使えば指定したサーバーレベル ロールのメンバーを得ることができます。 VBScript 等で SQL Server にアクセスして上記プロシージャが返すレコードを展開すれば良いかと。 しかしそれなりの権限があるユーザーで実行しないと取得できないと思います。
拡張ストアドの xp_cmdshell で可能です。 但し、この拡張ストアドは SQL-Server ユーザーがコマンドラインで実行可能な全ての行為を行なう事ができてしまいます。 それくらい危険極まりないので、デフォルトでは使えないようになっています。 （かつて猛威を振るったワーム型ウイルス Slammer は、確かこの xp_cmdshel を内部で使っていました） 使い方は以下、MSDNを参考に。 xp_cmdshell (Transact-SQL) http://msdn.microsoft.com/ja-jp/library/ms175046 … xp_cmdshell オプション http://msdn.microsoft.com/ja-jp/library/ms190693 … 企業やプロジェクトによっては、セキュリティの観点から xp_cmdshell の使用を禁止している場合があるかもしれません。 xp_cmdshell 以外にも方法はいくつか考えられます。 ■ストアドからDTSをキックする 自分はやった事無いですが（もしくは忘れてしまいましたが）多分、DTSが使えるのであればファイルの削除も可能でしょう。 ■OLE オブジェクトを使う 例えば、VB（VBA、VBS）などでファイルシステムを扱う場合、 CreateObject("Scripting.FileSystemObject") のように書きます。 これと同じ事をTransact-SQLでは sp_OACreate 'Scripting.FileSystemObject' と表現できます。 つまり、Scripting.FileSystemObjectの DeleteFile メソッドもストアドから実行できる、と言う事です。 こちらの方法は自分もやった事があります 結構ハマり、後々のお守りも大変だった記憶があります。 セキュリティの制限さえ無ければ、xp_cmdshell が一番楽チンです。
大体やりたい事のイメージはつかめます。 ＞wk_hizukeというテーブルには複数のレコードが入っており、そのレコード ＞を一件ずつ読みながら、上記の処理を行ないたいと考えております。 （略） ＞が、妥当と思われる構文を見出すことができずにおる次第です。 その場合は、「カーソル（CURSOR）」を使用します。 ・カーソルをオープンし、それを1行ずつ読み込んでループの中で処理する と言う方法です。 カーソルを定義して、オープンした後、そのカーソルを1行づつ処理します。 カーソルLOOPで1行読み込む事を「フェッチ（FETCH）」と言います。 本家MicrosoftのMSDN - FETCH (Transact-SQL) http://msdn.microsoft.com/ja-jp/library/ms180152 … ＠IT：ストアドプロシージャによる繰り返し処理 http://www.atmarkit.co.jp/fnetwork/rensai/sql22/ … ストアドプロシージャの花形“カーソル”を使おう - ＠IT http://www.atmarkit.co.jp/fdb/rensai/tsql11/tsql … 肝の部分だけ簡潔に書くとこんな感じです。 （sp_hizukesanshutuに必要な変数定義や構文の確かさ等々は省略しています） -- カーソル定義 DECLARE wk_hizuke_cur CURSOR FOR SELECT tokuisakicode FROM wk_hizuke; -- カーソルオープン OPEN wk_hizuke_cur; -- 1行先読み FETCH NEXT FROM wk_hizuke_cur; --↓ ↓ ↓ ↓ ↓ LOOP処理開始（データが存在する間ループする） WHILE @@FETCH_STATUS = 0 BEGIN -- ↓1行読んだ後の処理をここに記述する -- ストアド呼び出し exec sp_hizukesanshutu @tokucd , @hizuke1 output; -- おそらくこの後、output の hizuke1 を使って何か処理するんでしょうね？ -- 更に1行追加で読み込み（データがあれば再度ストアド呼び出しを行なう） FETCH NEXT FROM wk_hizuke_cur; END --↑ ↑ ↑ ↑ ↑ LOOP処理終了 -- カーソルクローズ CLOSE wk_hizuke_cur; --最後のおなじない DEALLOCATE wk_hizuke_cur; この手の処理の王道が、上記のカーソルでLOOPする方法です。 バルク的にガッと一発で処理する方法と言うのも、アレコレいじれば多分可能ですが、output を使って何か処理するのであれば、バルク的な処理はできない、と言う要件ですよね、おそらく。 いずれにせよ、まずは王道を先に身に付けた方がよろしいかと思います。
hostsにlocalhostしか記載されていないのではありませんか？
Q1 Windows Server ではなく、XP Vista 7 といったクライアント用 Windows で SQL Server を稼働させるのであれば、クライアント用 Windows の同時アクセス数の制限が心配ですね。 クライアント用 Windows はサーバー用 Windows と違って、外部から同時にアクセスできる数に制限が設けられています。（台数ではありません） それと、SQL Server を導入する場合、無償で使用できる Express Edition じゃない限り、CAL も考慮する必要があります。 箱で買う場合(最近のバージョンを箱で買ったことがないのですが) 5CAL が付属していると思うので、それ以上のクライアントからアクセスするならクライアント数ぶんの CAL を追加購入する必要があります。 まぁ CAL に関してはクライアント数やらユーザー数やら、何の数に対してライセンスを購入するのか選べますので、ご自分の職場の環境に応じて選べばよいと思います。 CAL を必要としない、プロセッサ ライセンスというのもあります。 http://www.microsoft.com/japan/sqlserver/2008/ho … Q3 すべてストアドにする必要ないでしょ。 パラメータ クエリならストアド化。 静的なクエリ（パラメータから動的に値を受け取って実行するのでない）ならクエリのまま（というかビュー） ひとまず無償の SQL Server Express Edition をダウンロードして手近な PC にインストールしてみてテストをしてみることが必要でしょうね。
TABLE2.[TYPE] in ('77','88','99') でいいのでは?
sqlcmdのプロンプトを二つ立ち上げて （トランザクション1） begin tran go select * from テーブル with ( updlock ) where 条件 go （トランザクション2） update テーブル set 項目 = ～ where 条件 go として見てください。トランザクション2は待ちになります。 トランザクション1のselect文の with ( updlock ) を取ると待ちになりません。
> メールアドレスの入力チェック perl5.10以降なら http://www.din.or.jp/~ohzaki/mail_regex.htm ここのあたりの記事も参考に http://blog.livedoor.jp/dankogai/archives/511899 …
とりあえず、DBの主要データとストアドなどは移行できるはずです。 （セキュリティ関連の定義は移行できないはず） 但し、一部のSQLが非互換のため以下のような可能性があります。 ・SQLエラーとなり実行できない。 ・実行できるものの、結果が微妙に異なる。 ・DTSを使用されているのなら、SSISで作り直しが必要 特に、結果が微妙に異なるのが厄介で、実際に現と新の結果を 比較しないと判らないこともあります。 また、アップグレードアドバイザというツールが提供されているので、 移行前にどのような問題が発生しそうか、ある程度検証できます。 （これは、ストアドのチェックはできるがVB6内のSQLに対しては無力） それよりも問題なので、VB6で、Server側で動かしてターミナルサーバで 使用しているのなら、ランタイムはWOWを使用して32ビットでなんとか 稼動するものの、IDEは64ビット版ではサポートされていないようです。 ＃開発は別の32ビット版で行うならOKかも・・ 結局、移行にはちゃんとした調査・計画（事前検証を含む）が必要です。
PIVOT使ってできそう。 実行してないから、エラーになったらゴメン。 SELECT 日付, [No.1], [No.2], [No.3], [No.4], [No.5] FROM ( SELECT 日付, 場所, 線量 FROM テーブルB ) T PIVOT ( SUM(線量) FOR [日付] IN ([No.1], [No.2], [No.3], [No.4], [No.5]) )
以下の方法で、可能かと思います。 postgresql9.0では動作確認しました。sql serverもrecursiveと window関数が使えると思いますので、適時書き換えて動くかと思います。 arrayが使えなかったら、path || '-' || t2.code のようにし、 商品コードをハイフンで区切って、ひとつの文字として扱う必要があります。 --全体の流れ- 1.再帰SQLを用いて、顧客ごとに、row numberで商品に番号を割りつけ。 2.得意先ごとに商品コードを配列に順に格納。 3.商品がすべて格納された配列のみを残す。 4.配列でグループ化し、タブっている配列(商品の組み合わせ)を除外。 5.最後にもとのテーブルと結合させて、完了。 ---------- create table tbl(customer text, code text); insert into tbl values ('A', '1'), ('A', '2'), ('B', '5'), ('B', '6'), ('B', '7'), ('C', '1'), ('C', '2'), ('D', '5'), ('D', '7'); -- with recursive tbl_root(customer, code, r, root) as ( select customer, code, t1.r1, array[code] from (select *, rank() over (partition by customer order by code) as r1 from tbl) as t1 where t1.r1=1 union all select t2.customer, t2.code, t2.r2, root || t2.code from (select *, rank() over (partition by customer order by code) as r2 from tbl) as t2 inner join tbl_root as t3 on t3.customer=t2.customer and t3.r=t2.r2-1 ) select 'pt_'||tt4.customer as pattern, tt4.code,tt3.root from(select tt2.*, min(k) over (partition by tt2.root) as mk from (select tt1.customer, tt1.root , row_number() over() as k from (select customer, code, root, array_upper(root,1) as au, max(array_upper(root,1)) over (partition by customer) as maxarray from tbl_root ) as tt1 where tt1.au=tt1.maxarray group by tt1.root, tt1.customer ) as tt2 ) as tt3 inner join tbl as tt4 on tt3.customer=tt4.customer where tt3.k=tt3.mk ; -- pattern, code, root ---------------------- pt_A, 1, {1,2} pt_A, 2, {1,2} pt_B, 5, {5,6,7} pt_B, 6, {5,6,7} pt_B, 7, {5,6,7} pt_D, 5, {5,7} pt_D, 7, {5,7}
8GB の何をどういう風に送っているのかまったく書かないのですね。 Command オブジェクトを使用しているのならタイムアウト値を無制限にするとか。
row_numberで1からの連番ふれるよ INSERT INTO ATBL(CD, NO, NAME) SELECT CD, row_number() OVER(ORDER BY CD) AS NO, NAME FROM BTBL 参考URL：http://msdn.microsoft.com/ja-jp/library/ms186734 …
SQL Server 2005より前なら、#1さんの回答のように 「case式で振り分けて・・・」といった方法でクロス集計を実装することが多いです。 SQL Server 2005からは、独自機能の pivotを使う方法があります。 例えば、次のようなSQLになります。 select 得意先ID ,[3] as "３月売上" ,[4] as "４月売上" ,[5] as "５月売上" from ( select 得意先ID ,month(年月日) as 月 ,売上金額 from 売上明細テーブル ) as p pivot ( sum(売上金額) for 月 in ([3],[4],[5]) ) as pvt order by pvt.得意先ID ; 参考URL：http://msdn.microsoft.com/ja-jp/library/ms177410 …
>SQLServerのCALの考え方をお教え下さい。 http://www.microsoft.com/japan/sqlserver/2005/ho … にあるdocの「マルチプレキシング」を参照。 >実利用者分必要orAPのデバイス数分必要 Webシステムだと プラウザの実利用者分必要 or ブラウザのデバイス数分必要 になると思います。 CAL数が多いならプロセッサライセンスがお得。 あと、Windows Server CALも必要です。 安く上げるなら、Windows Server Web Edition + SQL Server Express Editonがお勧め。
Aは空なのであれば、INSERTしなければいけないですよね。 INSERT INTO A.顧客マスタ （顧客番号1, 顧客番号2, 顧客番号3) SELECT SUBSTRING(顧客番号,1,3) SUBSTRING(顧客番号,4,3) SUBSTRING(顧客番号,7,2) FROM B.顧客マスタ; みたいな感じでしょうか。 データベースA、Bというのがどういう意味合いなのかが分かりませんが、 AからBの顧客マスタを見れる状態になっていなければいけませんね。
OSは違いますが（Windows7） PC1：Sqlserver 2005 Developper Edition（32bit） PC2：Oracle 11g R2 64bit でPC1からPC2へアクセス可能です。ただし、私の環境ではPC1（Sqlserver側）からOracleのデータに対してトランザクション処理を行おうとするとエラーが発生します。
参考までに WITH T( [DATE] ) AS ( SELECT GETDATE() AS [DATE] UNION ALL SELECT [DATE] - 1 FROM T WHERE [DATE] >= GETDATE() - 30 ) SELECT * FROM T;
多分、空白文字列のパスワードが認められないせいだと思うので、Management Studioで適当なパスワードを入力してOKをクリックしてみてください。
「フリーで使えるデータベースを手に入れる」でしょうね。 MySQLやPostgreSQL、Oracleにもトライアルのためのダウンロードがあります。 ただ、インストールや設定のハードルが高いように感じられるなら トライアル版付きの書籍（入門書）を入手するが良いかも。 （ブックオフの105円コーナーあたりで見かけることがあります）
ハードディスクの容量不足ならハードディスクを増設出来ないのですか？
「SELECT 'ABC123' , 'りんご' FROM foo」と書くとfooのレコード数だけの行の（'ABC123' , 'りんご'）というデータを作成してしまいます。 質問の記述ではDISTINCTを用いてそれを再度一行にまとめようとしています。しかし、fooにそもそも一行もデータがないとまとめる段階でデータが存在しないので挿入できないのです。 また、fooのレコード数だけのレコードを作ってまとめるのは無駄な作業で、fooのレコード数が増加していくとパフォーマンスの劣化が見逃せなくなります。 SQLを記述する時は、「とりあえず、動けばいい」ではなく、どんな動作が裏で行われているかを念頭に置いておくようにしてください。 で、ACCESSですが、ACCESSの場合はFROM句を省略出来ません。 その代わりに何でもいいので一行のレコード（しかも一行のみ）のダミーテーブルを作成し、FROM句を構成すればいいのです。（OracleのDUAL表と一緒です） フィールドも一つでバイト型で構いません。とりあえず「0」の値を入力しておけば結構です。テーブル名も「DUAL」とでもつけてください。 そうすれば INSERT INTO foo(商品コード, 商品名) SELECT DISTINCT 'ABC123' , 'りんご' FROM ＤＵＡＬ WHERE NOT EXISTS( SELECT * FROM foo WHERE 商品コード = 'ABC123' ) でいけるはずです。
指摘したことの繰り返しになりますが、ユーザーA，Ｂがいてほぼ同時に作られたSQLを実行した場合、後続のSQLは先行のSQLの終了を待ちません。すなまち、同じMAX値を取得します。 作られたSQLシングルユーザーで間をおいて実行している限りは正常に動くでしょう。しかし、マルチユーザーで負荷が高く鳴った時はエラーを起こす可能性をもっています。潜在的バグですね。
クエリによるトレースファイル作成ならいかがでしょうか？ プロファイラでお好みの設定で実行します。 ファイル-エクスポート-トレース定義のスクリプト　からスクリプトを保存します。 プロファイラは終了してください。 ManagementStudio、クエリアナライザなどで↑で保存したSQL開きます。 「exec @rc = sp_trace_create @TraceID output, 0, N'InsertFileNameHere', @maxfilesize, NULL」 こんな一文がありますので、「InsertFileNameHere」の部分に保存先のパス+ファイル名に変更 実行します。 ☆このとき結果として出力された値は、停止と終了で使用するので控えてください。 これでトレースファイルが作成されていきます。 ファイルの作成数、1ファイルのサイズ上限など設定できますのでお好みに。 ManagementStudio、クエリアナライザは閉じて大丈夫だったと思うのでこれでいけるのではないかと思います。 停止、終了は、 sp_trace_setstatus 2, 0 --2の部分は☆の出力された値、0は停止です。 sp_trace_setstatus 2, 2 --2の部分は☆の出力された値、2は終了です。 この順番でやらないと作成中のファイルが開放されないので気をつけてください。 ちなみに、 sp_trace_setstatus 2, 1 --2の部分は☆の出力された値、1は開始です。
MS ServerManagement StudioをSQL認証で立ち上げて、ログインに該当ユーザーが存在すること、サーバーロールの「sysadmin」にもあるか確かめてみてください。
以下の事を補足願います。 １．サービスですでにSQL　Server　Agenntが起動していないか？ ２．ログにエラーメッセージ等がでていないか？ 以上　２点　宜しくお願いします。
>現在メンテナンスしているシステムです。 ウェブベースなんですか。 The underlying connection was closed: Unable to connect to the remote server. で検索してみると、 proxyサーバーがhttpリクエストを拒否している可能性 DNSの解決ができていない可能性 などが示唆されています。 http://nilangshah.wordpress.com/2007/03/01/the-u …
テーブルAとテーブルBで、同一内容のレコードが存在していても全件取得したいなら SELECT * FROM テーブルA union　all SELECT * FROM テーブルB テーブルAとテーブルBで、同一内容のレコードが存在している場合に除外して取得したいなら SELECT * FROM テーブルA union SELECT * FROM テーブルB
No2です。 もしかしたらレジストリに書き込み権限がないのではないでしょうか？ インストールを実行されているアカウントは管理者権限でしょうか？ 違うのであれば管理者権限を持つアカウントでインストールを行ってみてはいかがでしょうか。
> かといって、SQLServerに登録されているDomain Usersを削除 > してしまうと、Webアクセスの際、エラーになってしまいます。 偽装しなければよいのでは？
こうしたらどうでしょうか。 order by case substring(itemNo,1,1) when 'P' then 1 when 'N' then 2 when 'Q' then 3 else 99 end , itemNo SQLServerの環境がないので動作確認はしていませんが・・・
機能面では、SQL Serverが上回りますが、クエリはデザイナを使って作成するものだと思っていると、ちょっと苦労するかもしれません。 SQL Serverのクエリデザイナは、あくまで補助的なもので、Accessのものほど高機能ではありません。やはり直接SQL文を書くのが基本です。 なお、おそらく唯一Accessでしかできないクエリ機能は、クロス集計クエリです。これをクエリ(ビュー)で実装することは、SQL Serverではできません。
回答自体は他の方がしていますが、リファレンスで自分の必要とする関数を探すと良いですよ。 http://technet.microsoft.com/ja-jp/library/ms189 …
UPDATE　商品マスタ　SET　単価　=　単価　*　1.05 でいいのでは？ 一部の商品のみであれば後ろにWHERE句をつければ良いと思います。
SELECT 元テーブル.売先コード, 元テーブル.需要家コード, 売先名称テーブル.取引先名称 AS 売先名称, 需要家名称テーブル.取引先名称 AS 需要家名称 FROM 元テーブル LEFT JOIN 取引先テーブル AS 売先テーブル ON 売先テーブル.[売先、需要家コード] = 元テーブル.売先コード LEFT JOIN 取引先名称テーブル AS 売先名称テーブル ON 売先名称テーブル.取引先名刺ID = 売先テーブル.取引先名刺ID LEFT JOIN 取引先テーブル AS 需要家テーブル ON 需要家テーブル.[売先、需要家コード] = 元テーブル.需要家コード LEFT JOIN 取引先名称テーブル AS 需要家名称テーブル ON 需要家名称テーブル.取引先名刺ID = 需要家テーブル.取引先名刺ID; ですね。
SQL ServerはDDLでもロールバックされます。 一時テーブルでも実テーブルでも同じで、ロールバックすると無くなります。
dbo.[テスト（テスト）] というか、テーブル名を変更するべき
テーブル（オブジェクト）のリネーム構文は以下の通り。 sp_rename [ @objname = ] 'object_name', [@newname =] 'new_name' Excelでも使用して新旧名称をまとめ、式としてSQL文として生成（複数行可） 列Aに旧名、列Bに新名があるとします。 （一行目ならセルA1に旧名、セルB1に新名） セルC1に式[="sp_rename '" & B1 & "', '" & A1 "'"]を入力 セルC1を必要なだけコピー。 列Cをテキスト保存するなり、コピペなり。 上記をクエリアナライザにコピペして実行するも良し。 OSQL(今はSQLCMDかな）で実行するも良し。
データバースサーバをインタネットに晒すなんて恐ろしすぎます。 ASP.NET WebサービスとWinフォームによる、いわゆるスマートクライアントという手も。
参考URLを添付します。 インポートとリンクの方法、両方説明していますので、ご注意ください。 ODBCで接続する場合はODBC設定も忘れずに！ 参考URL：http://office.microsoft.com/ja-jp/access-help/HA …
> DAO感覚でIndexしてseekすれば高速検索が簡単にできると甘く考えておりました。 そう美味しい話はあまり、ありません。 DAO感覚でやろうするなら、一捻りしてパススルークエリとワークテーブルを使うやり方があります。 最初のクエリ発行の際にある程度の絞り込みが出来るのが前提ですが、ワークテーブル（INDEX作成済み）の全件削除、パススルーのSQL組み立てとこのパススルークエリのデータをワークテーブルに挿入するクエリの実行。 後は、非接続ですが、高速に扱えます。 更新の場合は、別途ADOでもいいので更新・削除・追加クエリを発行することになります。 ただし、非接続なので、他のユーザーが更新していないか、チェックして更新用のSQLを実行することになりますので、ADOのトランザクション機能を使うのがいいかもしれません。 欠点は最初のパススルークエリでのデータ件数が多いと、ネットワーク負荷・DISK負荷が高いのでレスポンスが悪いのと、ワークテーブルの全件削除と挿入を繰り返すのでローカルのACCESSのファイルが肥大化しやすいことです。
1.SQL Serverのエンジンを停止する。(おそらく現時点ではしなくてもよい) 2.該当のmdfファイルをデータ格納場所以外のフォルダに移動する。 　例）「C:\Program Files\Microsoft SQL Server|MSSQL\Data\」が 　 データ保存先である場合は「Dドライブ」の直下などに移動。 3.SQL Serverのエンジンを起動する。 4.１ヵ月前のデータベースを「mdf」、「ldf」共に 　 「C:\Program Files\Microsoft SQL Server|MSSQL\Data\」 　へ復元する。 5.SQL Serverのエンジンを停止する。 6.「Dドライブ」に移動した「mdf」ファイルを 「C:\Program Files\Microsoft SQL Server|MSSQL\Data\」に複写する。 ※ 上書きする。 7.SQL Serverのエンジンを起動する。 8.該当のDBにアクセスしてみる。 これで解決できると思います。 ちなみに「logデータを書き込む領域がなくなりました」というエラーメッセージ が表示される原因は「復旧モデル」が「完全」になっているからと思われます。 差分バックアップを行わないDBであれば、「復旧モデル」は「単純」が最適とおもわれます。 　 　
SQL Serverの場合、insertedとdeletedのデータ有無で判断するのが、一般的です。 両方あれば、UPDATEです。
こんばんは。 ＞更新フラグが0のものを検索して 0のものを1にするだけなら、 update テーブル set 更新フラグ=1 でいいんじゃ？ where句も要らないような・・・。
すみません。 ＞どうやっていいのか見当もつきません。 でしたね。 ＞(3) (2)の処理が失敗したらロールバック これを知っているなら、 http://technet.microsoft.com/ja-jp/library/ms175 …(SQL.100).aspx http://technet.microsoft.com/ja-jp/library/ms188 …(SQL.100).aspx （前述のページからたどったページ） トランザクションの仕組みは業務用DBSでは必ずあり、やり方はほとんど同じです。 BEGIN　（性格には違うが） でトラップをセット。これからの処理がDBSによって無い場合も、 エラーになった場合、自動でロールバックがかかります。エラーになったところより後半は実行されません。エラーになった戻り値を終了番号として、CMDに渡されます。それを判断する。 このやり方が一つ。他は構造化したやり方で、明示的に指定する方法。 BEGIN 1 command BEGIN 2 command などとすると（そこに注意書きがあるので、それに従う事）、その実行単位でのトランザクショントラップになります。 VBやVBS、VBAなではおなじみの on error と言うステートメントと同じ。この辺が上記のサイトのリファレンスをたどっていけば記述されているという事です。つまり、他の言語を学習した事があるかたなら、おなじみのやり方で、構造化できると言う事です。構造化しないで、単純に、エラーコードやえらめーっセージをで判断する方法もあるので、ケースバイケースです。 これは、他のVBからのAPI呼び出しでも同じなので、それぞれ呼び出し側のエラーとラップ方法に依存するやり方もありますよ。と言うこと、CMDのバッチエラー処理は前回提示しましたね。 なのでエラートラップは、設計者しだいで、いかようにもなります。 まとめ、BEGIN・・と言う、エラーとラップを使って構造化する方法と、コマンド実行のエラーステートメントを利用する方法を使う。 VB、VBA、VBSなどのエラートラップによく似ているので、慣れていれば親しみやすい。 予断ですが、ユーザー管理等で、LDAPを使うかRDBMSを使うか、システムの選択をするとき、システムの機能ではエラートラップが構造化している（ロールバックがある）RDBMSを選ぶ理由はそこにある。 ただ、LDAPでも使用している言語なりフレームワークのエラートラップを使えるので、ロールバックと似た事は簡単（オブジェクトのクローン作成）。
リンクサーバと言う機能で可能です。 SQL Server のリンク サーバーお よび分散クエリで Excel を使用す る方法 http://support.microsoft.com/kb/306397/ja 他にも表関数を使う方法もありますが、まずはリンクサーバからでよいと思います。 但し、これはあくまでも、行データとしての扱いとなります、 Excelをバイナリとして登録もできますが、OLE呼び出しするなら作り込みが必要になると思います。 マイクロソフト同士と言ってもAccessほどの親和性はないので。
>途中でエラーになりインストールできません。 だけでは、誰も対策が分からないと思いますので エラーの内容を具体的に記載した方がいいと思いますよ。 表示されたメッセージをそのまま貼り付けるとか。 こちらは確認されましたか？ http://technet.microsoft.com/ja-jp/library/ms143 … インストールしようとしているSQL ServerとOSのエディションは要件に合っていますか。
＞・DBA関係（Oracleでいうデータディクショナリのようなものからの情報取得） 開発でという事であれば、通常はいらないのでは？僕はスキーマ情報を取得する時に調べるぐらいですが・・。 ＞・バックアップの方法、リストアの方法 これはSQLServerは非常に簡単です。 自動化をしようとしたらバッチを作って・・といろいろしなければならないと思いますが、手実行であればManegementStudioを使用すればすぐにできます。 コマンドベース(osqlなど)でもできます。 ＞１●開発で必要なスキル／知識の差分 バックアップとりストア、必要であればサーバーを公開する設定とか、後、SQLServerは結合は基本的にJoin(Inner joinなど)です。SQLチューニングはほとんど意識する事もありません。インデックスを効果的に定義するぐらいです。後、SQLServerはアタッチとデタッチでSQLServerごと容易に他の端末や環境に移行する事が可能です。 ＞２●何か良いサイトや、良い学習方法 書籍を１冊か２冊ぐらいは読んでおいた方がいいかと思いますが、SQLServerは簡単なのでほとんど実地で対応できると思います。Oracleやってた人なら大丈夫！！と思います。。
補足をお願いします。 uchi38さん、pamanatuさんともに開示する情報が少なすぎます。 少なくともクライアントからの接続形態・現象発生時のエラーコード・メッセージ等を記されないと、どんな識者でも検討はつかないと思います。
SQL Serverのバージョンは？ 列数を可変というのが、実際に最大何列くらいになるのかにもよりますが。 ぱっと思いついたままを書くと、 (1)最大列数を固定にし、くっつける行がない場合は、''（長さが0の文字）をくっつけるといった方法を使えば、シンプルに実現できるかも知れません。 (2)いろいろな要件を満たすには、ストアドプロシジャでやる (3)可能な限り「SQLだけ」で実現したいなら、SQL Server 2005以降であれば、WITH句で再帰クエリを行いながら、列値を連結していくといった方法も考えられます。
こんばんは ご質問の内容だけならば、データのあるテーブルを Table_1 とすれば、 SELECT 明細ID, MAX(日付) AS 日付 FROM dbo.Table_1 GROUP BY 明細ID で可能です。 そうでなくてTable_1の他のフィールドが必要なら以下のようにします。 方法は2段で、 まず、View_1を上記と同じように設定します。 SELECT 明細ID, MAX(日付) AS 日付 FROM dbo.Table_1 GROUP BY 明細ID 次にView_2を以下のように設定します。 SELECT dbo.Table_1.num, dbo.Table_1.明細ID, dbo.Table_1.日付, dbo.Table_1.データ１ FROM dbo.Table_1 INNER JOIN dbo.View_1 ON dbo.Table_1.明細ID = dbo.View_1.明細ID AND dbo.Table_1.日付 = dbo.View_1.日付 もしかしたら、こちらが参考になるかもしれません。 http://oshiete.goo.ne.jp/qa/6484067.html
DBMSのパフォーマンスチューニングに魔法はありません。 工数、予算の関係上、仕方ない部分もありますが、どう考えても条件が理不尽です。 「以前にオラクルでアナライズにより飛躍的に処理速度が向上した経験があります。」 SQL SERVERにも「UPDATE STATISTICS」という統計情報を更新するコマンドはありますが、現状で「なぜ遅いのか」を突き止めないでむやみに行っても結果がしれていると思います。 まず、何がボトルネックになっているか調べてください。パフォーマンスモニタでCPU（多分マルチCPU、マルチコアだと思いますが）の使用率、WAIT。DISK I-Oの転送量、WAIT。がどうなっているのか、書込み量、読込み量。特定のボリュームにI-Oが偏っていないかなど。 SQLの実行プランは取得されているのでしょうか。場合によってはINDEXを一つ追加するだけで解決する場合もあります。 その上で、パラメータチューニングできるかどうか検討してみてください。 「Dr. K's SQL Serverチューニング研修」 http://www.atmarkit.co.jp/fdb/index/subindex/drk …
Manegement Studioで復元実行時にデータベースの上書きオプションがありますが、これをやってもだめでしょうか？
インストールしようとしている端末に別途、SQLServerの別のコンポーネントがインストールされていませんか？ またインストール使用している端末とインストールEXEのbitはあっていますか？ 確か32bit用と64bit用があったと記憶していますが・・・。
実際に不可能ではないですが、 片方のコネクションがトランザクションを開始してしまい、 あるテーブルの行を更新してしまうと、 もう片方のコネクションはコミット待ち状態になります。 本来、コネクションは複数持つべきではありません。 SQLServerの同時接続数にも触れますし、 1つのコネクションを使いまわすのが一般的です。 コネクションは引数等も利用して1つにするように心掛けましょう。
先ほどのSQLをサブクエリなりVIEWなりにして、その外側で条件を指定すればいいのではないでしょうか。 select * from (先ほどのSQL) where 発送区分 = 1; という感じで。
私はSP2を当てたらできました。
SQL Server Management Studio Expressを起動し、 セキュリティ⇒ログイン に「ドメイン￥ａｄｍｉｎｉｓｔｒａｔｏｒ」 を追加してみてください。
bcpを使用しないでT-SQL(つまりsqlcmdやManagementStudio)から、SQL文でCSVを 作成するということでしょうか？ bcpが使えるならbcpでCSV出力可能です。 SQLだけでやるなら以下のように連結して出力します。 select col1 + ',' + col2 + ',' + col3 from tname; もう少し前提条件をしぼってもらえればピンポイントでアドバイスできるかと思います。
ここらへんの事でしょうかね。 [ディスク使用量の概要レポート] http://msdn.microsoft.com/ja-jp/library/cc280506 …
ODBCを作成した時、接続のテストがあると思いますが、それではうまく接続できますか？ 接続ができればそのODBCをリンクテーブルに適用してやればうまくいくと思いますが。 また適用ができなければ一旦リンクテーブルを削除して、作成したODBCで再リンクを作成してみてはいかがでしょうか？
すみません > exl.Workbooks("db1.xls").Save はexl.Workbooks("book1.xls").Save の誤りです。
str関数は固定長で右揃えした文字列を出力する関数っぽいですね。 http://technet.microsoft.com/ja-jp/library/ms174 … 整数を文字列に変換するなら、素直に cast(XX as varchar)の方がTrimもいらない様だし安心かと。 あと、"_table"の部分がテーブル単位で固定であるなら ストアド内で書きこむのではなく、トリガーとか、計算列とか、 場合によってはビューの使用も考慮していいんじゃないかという気がします。
#6です。 気になったの書き込みます。 参照側で考えていましたが、更新側のロック範囲は適正でしょうか？ 不必要に広い範囲に排他ロックを掛けていないでしょうか。 例えば更新が select xx from yy where zz>aa for browse のようになっていると広範囲にロックが確保され要注意です。 また、更新がバッチであれば、途中コミットして排他時間を短くするなりの対策が考えられます。 とにかく参照処理も更新処理も出来るだけ範囲を小さくされることをお勧めします。
SQLを考える時には理論を考えないと いけません。それと、質問が曖昧です。 >この中で一番新しい（＝若い）日付の 日付は二つあるんですよね？ 配送日なのか到着日なのかハッキリ しません。配送日が早くても、到着日が 遅い場合もあるのでは？ 「新しい」と言いますが、２行目は一番 古いですよ。 ここでは「古い配送日」と仮定します。 (1)テーブルＢから依頼No毎に、一番 　日付の古い（小さい）ものを抽出する。 (2)上記クエリとテーブルBを依頼Noと 　最も古い日付と結合させ、依頼Noと 　枝番を抽出する。 (3)上記のクエリと依頼No、枝番が一致 　するデータを抽出する。 これを表わすと以下のようになる。 SELECT A.* FROM テーブルＢ A INNER JOIN (SELECT B.依頼No,B.枝番 FROM テーブルＢ B INNER JOIN (SELECT D.依頼No,MIN(D.配送日) 過去日 FROM テーブルＢ D GROUP BY D.依頼No) C ON B.依頼No=C.依頼No AND B.配送日=C.過去日) E ON A.依頼No=E.依頼No AND A.枝番=E.枝番 ちょっと分かり難いので説明します。 ２番目のサブクエリ"(SELECT D.依頼No～) C" この部分が(1)にあたります。このカッコの 内側は依頼No毎に最過去日を取っています。 １番目のサブクエリ"(SELECT B.依頼No～) E" ここは最初のクエリ（Cというエイリアス）と 依頼No、日付が一致するクエリで(2)にあたり ます。 最も外側の"SELECT A.*～"が目的の結果を 得るためのものです。 外国語なんでね、日本人の考えと逆順になる ところがイヤですね。
not exists を使って select 依頼no発送日,到着日 from table名 a where not exists(select * from table名 b where a.依頼No. = b.依頼No and a.発送日 > b.発送日); 分析関数が使えるなら select 依頼no,発送日,到着日 from (select 依頼no,発送日,到着日,row_number() over(partition by 依頼no order by 発送日) rnum from table名) where rnum = 1; とかでしょうか。
UPDATE テーブル SET 会員種別 = '000' + SUBSTRING(会員番号,1,1) 数値が一桁と仮定しての話です。
訂正です。 #3で、 ＞たとえば、A1、A2などにID、商品名などと としていましたが、 ＞たとえば、A1、B1などにID、商品名などと にしてください。
すみません、sqlserverでしたね、それでは select * from 棚卸履歴テーブル where 棚卸日 >= convert(varchar(4),getdate(),121) + '-4-1'; か select * from 棚卸履歴テーブル where 棚卸日 >= convert(varchar(4), case when month(getdate())<=3 then year(getdate()) - 1 else year(getdate()) end,121) + '-4-1'; を試してください。
(1)数量がゼロのデータが少なく、数量でNULL値を持つものがない。 (2)商品に索引が作成されている。 状況なら。 create table zaiko ( souko char(1), shohin nvarchar(1), suryo int ) create index idx_shohin on zaiko (shohin) insert into zaiko values ( 'A', '●', 10 ); insert into zaiko values ( 'B', '●', 20 ); insert into zaiko values ( 'C', '●', 5 ); insert into zaiko values ( 'A', '×', 3 ); insert into zaiko values ( 'B', '×', 15 ); insert into zaiko values ( 'C', '×', 0 ); select * FROM ZAIKO where zaiko.shohin not in ( select shohin from zaiko where suryo = 0 ) という書き方が有効かも知れません。
エディション別の機能比較は、 http://technet.microsoft.com/ja-jp/library/cc645 … を参照してください。 Express Editionでの制約として、今回のケースで問題になりそうなのは、 データベース使用可能HDD容量：10GB データベース使用可能メモリ：1GB だと思います。 容量は、サイジング値から判断すると問題無いように思います。 メモリがネックになる可能性はあります。 使用用途にもよりますが、データ量が増えてきたときに問題になるかもしれません。 APのつくりに左右されますので、 評価環境にて評価をした方が良いかと思います。
ここのあたりを参考にしてください。 http://www.asahi-net.or.jp/~ef2o-inue/vba_o/sub0 … 注意点は ・参照設定でADOを有効にしておく必要がある。 ・ADODB.CONNECTION、ADODB.RECORDSETを宣言する際にnewを付加しておく。 ぐらいかな。
sysobjects http://msdn.microsoft.com/ja-jp/library/ms177596 … sys.objects http://msdn.microsoft.com/ja-jp/library/ms190324 …
SQL Server 2000と2008は共存可能です。 導入する顧客管理ソフトアプリが動くかどうかは別として……。 導入した顧客管理ソフトがインスタンス名を指定できるようになっている、もしくはカスタマイズできるのであれば大丈夫です。
書かれている内容から問題の原因を特定するのは難しいです。 評価環境 　ノートPCを使用 　OS不明(32bitか64bitか不明) 　SQL Server 2005 Express 　この環境でも、クラサバ？ 　(DBサーバのノートPCに、別のPCに乗ってるアプリからアクセス？) 本番環境 　サーバー機(コア何個？) 　Windows Server 2008(32bitか64bitか不明。Windows Updateかけて最新？) 　SQL Server 2008 パフォーマンス値 　メモリ、ネットワークは殆ど使用していない 　CPUも25%程度(この25%は何を見て、25%と判断？) ってな状況ですと、物理I/Oはどうなのか気になります。 また、「ノートPCよりレスポンスが3倍ほどかかるようになりました」では、 1秒が3秒になったのか、 10秒が30秒になったのか、 2分が6分になったのかでも話が変わってきます。 が、まずはインデックスの再構築、統計情報の更新などを試されるといいかと思います。 参考情報として、URLを一つ載せておきます。 参考URL：http://technet.microsoft.com/ja-jp/library/ms177 …
何回もどうもすいません。忘れてました VAR/60.00 などでもよいです。（暗黙の変換が効きます。）
これ３本同時に実行なんでしょうか？ インサートの場合は行単位で当然ロック掛りますし、トランザクションを賭けていれば全てインサート終わるまで（遅延書き込みも）ロックですよね。 ＳＥＬＥＣＴ同士でも完全に読み込むまでは行がぶつかればロック掛りますよ。これプログラムからＳＥＬＥＣＴですか？ ならレコードセットを最後まで読み込んで閉じないと、大量情報ではカーソルが途中を指しているかによってはバッテイングしますよ。ＮＯＬＯＣＫはなるべく掛けないと。ＮＯＬＯＣＫ掛けないってことは書き込むかもしれないってことですから。
気になるのであれば、実際に確認してみましょう。 意味のない条件は、SQL解析エンジンが無視してくれる可能性は高いです。 実際に「実行のクエリプランを含める」をチェックして結果を確認して下さい。 ※環境依存なので絶対に無視するとは言い切れません。 それで問題なければ、いいんじゃないですか？ 性能試験を行って問題ないことを確認しているのであればOKだと思いますよ。
GUI操作時に【スクリプト】をおすと、その操作に対するSQL文が表示されます。 それを実行すればGUIと同じことが出来ます。 そのSQL文をファイルにしてあげて、sqlcmdで実行すればコマンドラインから実行できます。 さらに、そのコマンドをバッチファイルに書いてあげればバッチ化できます。 sqlcmdはこの辺りを見て勉強してください。 http://msdn.microsoft.com/ja-jp/library/ms170207 …
こんにちは。 こちらはいろいろデータベース について文章を収集しましたので。 お気軽にお越し下さい http://bbs.flatworld.jp/forum/61 また、このサイトにはほかのいろいろなソフトがある。紹介したい。 http://www.flatworld.jp/
「ユーザー データベースの移動を参照してください。 http://msdn.microsoft.com/ja-jp/library/ms345483 … これで移動可能ですよ。
リソース(メモリ容量やHDD容量)に問題が無いのであれば、特に問題無く 共存させることができます。 強いて言えば、SQL Server 2008が名前付きインスタンスになるぐらいでしょうか。
結合キーを揃えて集計したものと 担当者テーブルを結合させます select 担当.tanto_id as 担当者ID ,担当.tanto_name as 担当者名 ,isnull(売上.売上合計,0) as 売上合計　--null処理 from table_tanto as 担当 left outer join ( select tanto_id,sum(kingaku) as 売上合計　--集計 from table_uriage_meisai where date between '2010/11/01' and '2010/11/30'　--範囲指定 group by tanto_id　--集計 ) as 売上 on 担当.tanto_id = 売上.tanto_id コピペして見やすいようにタブを入れて見て下さい。
件数だけ取得するんじゃなくて データを取得したいんじゃないのかな？ select TAB.* from TABLE as TAB inner join (select b列,c列,max(d列) as d列 from TABLE group by b列,c列) as NST on TAB.b列 = NST.b列 and TAB.c列 = NST.c列 and TAB.d列 = NST.d列
オンラインREDOログが一杯になったらコピーされるのがアーカイブREDOログです。 オンラインREDOログは、そのままサイクリックに再利用されます。 Oracleとは切り離された単独のファイルですからエクスプローラー上から操作しても問題はありません。※内部的にはリカバリのために必要なファイルとして記録されていますが、あくまでリカバリ時に必要なものなので通常運用では参照されません。 ただしリカバリには必要なファイルです。 データベースの変更情報が全て記載されたファイルなので、ファイルに抜けがあると、それ以降を戻すことができなくなります。 ちなみにどういう運用をしていますか？ オンラインバックアップを取得しているのであれば、それ以前のアーカイブREDOログは 削除可能です。バックアップ以後の変更情報を当てていけば最新状態に戻すことが可能です。 逆にバックアップを適切に取っておらず、戻すことが出来ないアーカイブREDOログを延々と溜め込んでいるなら無駄ですし、いざという時に復旧できないので危険です。 少なくともファイルのリストをメモしておき移動して保存しておいてください。 その上で、バックアップ・リカバリ計画を確認してください。 もし、ないのであれば、ちゃんと計画をして取るようにしてください。 壊れた時に復旧できなくて困るよりは、今、きちんと確認しておいた方が良いですよ。
T-SQLの表示で、コマンドがどうなっているか確認してください。 http://msdn.microsoft.com/ja-jp/library/ms190488 … 手元で確認したところ、「解放された領域はオペレーティングシステム に返す」を指定するとTRUNCATEONLYになるようです。 これだとファイルのデータが入っている末尾を切り捨てるだけなので、状況によっては ファイルサイズは小さくなりません。データが後ろの方に存在しそのデータが消されない場合とか。これはあり得るケースです。 確実なのは、NOTRUNCATEをやってからTRUNCATEONLYをすればファイルは小さくなるかと思います。
デフォルトは自動起動です。 Windows版のORACLEもそうです。 と言うか、Windowsのサービスとして登録されるタイプのRDBMSは殆どそうですね。 手動起動にするなら、コンパネのサービスで SQL Server の関連サービスの「スタートアップの種類」を「手動」にしてください。 再起動しただけではDBが立ち上がらなくなります。 Management Studio からでも設定できるかもしれませんが、今、手元に SQL Server がないのでわかりません。
テーブルの設計が悪くないですかね？ フルテキストテーブルを作成しておいて 一時テーブルの内容を、実行の都度insert & delete するしかないでしょうね
nvercharのようにユニコードに対応しているデータ型に、正しくユニコード文字を 格納したい場合には、 INSERT INTO TestTable VALUES(N'test') のように、値の前に「N」プレフィックスをつけなければなりません。 これは、SQL ServerでもOracleでも同じ仕様です。
「新しいクエリ」で、テーブルに結びついてないクエリエディタを開いて、 そこで実行してください。
たしか、SQL Server 2000 のクライアントをインストールすれば MSDE の操作もできたと思います。 また、フリーではありませんが、 SQL Server 2000 Developer Edition というのがあります。 これだと、XP にもインストールが可能です。 いまさら、売っていないとは思いますが、1万円しなかったと思います。
アクセス権がないためでは？ XPHomeの場合、セーフモード（電源入れロゴが出たらF8を軽くトントン叩く）起動し、Administratorクリックしログイン後インストール SQL Serverはインストールできたのですか？ http://oshiete.goo.ne.jp/qa/4129036.html
BCPには列名を出力するオプションはありません。 「BCP　列名」で検索すると同様の質問、回答をがすぐに出てきます。 別途列名を取得したCSVをコマンドプロンプトで結合するような 対応が多いようです。
>1　とは基のテーブルということですよね う～ん、少し違う。別に基がｎで、従が１もありえます。 主キーを結合条件にしている方が１です。だって、重複 しないわけですからね。但し、従側の場合は結合しない、 即ち、実体が無いことがあるため、更新できません。 やっぱり、一時テーブルに抽出して、主キーによる INNER JOIN を考えるほうが間違いないですし、少し 複雑な処理にも応用できるので、こちらを勧めたいですね。
マクロの具合が悪いんだから マクロを提示しないと始まらない。
他のDBを参照するには、同じサーバ内であれば DB名.スキーマ名.テーブル名とすれば可能です。 例えば　SELECT * FROM DB2.dbo.TBL1 他のサーバの場合はリンクサーバの設定をして サーバ名.DB名.スキーマ名.テーブル名とすれば可能です。 例えば　SELECT * FROM SERVER2.DB3.dbo.TBL1 質問の例だと以下のようなSQL文になりますかね？(DBAから行う場合) UPDATE TBL1 SET TBL1.会員番号 = TBL2.会員番号 FROM TBL1 INNER JOIN DBB.dbo.TBL1 AS TBL2 ON TBL1.会員名 = TBL2.会員名 WHERE TBL1.会員番号 IS NULL
　考え方としては、テーブルの設計書を見ただけで、それが何を表している項目なのかが解るのが理想です。（もちろん、備考欄・コメント欄に意味を書くのは無しと言うことで） 　その上で、そのテーブルを利用してＳＱＬを書く立場になれば、項目名は出来るだけ短い方がありがたいですよね。なにせ、ＳＱＬ書くたびに毎度毎度その名前を書く羽目になるわけですから。 　短すぎず、長すぎず・・・・この間で、苦悩するのが名前付けの作業です=^・。・^= 　今回の場合、得意先の住所か、会員の住所かはテーブル名を見れば一目瞭然です。ですから、S_TOKUI_ADDのTOKUIは、長すぎの部類と思います。でも、ADDだけだと、動詞に取られかねません。S_ADDRESS当たりが無難なラインかと思います。C_TOKUI_TELのTOKUIも同じく長すぎの部類かな。TELだけで、まぁ誤解されるような用例もないですから、これはC_TELでも良いように思います。 　多分、ＳＱＬを書く時には、テーブル名のエイリアスをつけて、TOKUI.S_ADDRESSの様に使うことが多いです。これが、TOKUI.S_TOKUI_ADDだと、得意先の意味がダブってますよね。やっぱり、タイプの無駄でしょう。
ちゃんと実行してないので、自信ないですが、雰囲気はこんな感じで update table2 t2 set t2.伝票 = NVL(( select max(t1.コード) from table1 t1 where t2.地域 = t1.地域 and t2.商品 = t1.商品 ),'なし') ; NVLしているのは、該当伝票がないときにエラーにならないように。 maxは、複数該当しちゃった場合に、一番大きいコードを使うように。 参考になれば、幸いです。
IN句を使うのが吉。 WHERE フィールド名 IN(10, 20, 30) 文字列なら WHERE フィールド名 IN('AA', 'BB', 'CC') ってな感じに。
どのように書いたらこのエラーが出たのかを書かないと 原因はわからないでしょう importが正しくできていないようなメッセージに見えますが…
IP指定でのアクセス拒否は、プロキシを経由すれば簡単に回避可能です。 また、BASIC認証はBASE64でユーザ名やパスワードがエンコードされます。 BASE64方式での認証は認証される時点でのパケットを傍受されれば、参考URLのようなアプリケーションで簡単にその中身を確認可能です。 SQLインジェクションを仕掛けるような技術力を持った攻撃者にとっては、それらのセキュリティ対策はザルと同然です。 参考URL：http://www.ahref.org/app/base64/
では、当該テーブルのほかの項目に対して主キーが設定されていませんか？テーブルインポート時に連番でレコード番号項目が自動的にデフォルトで付与されていたり、項目名に「番号」、「ID」といった言葉を含んでいるために主キーが自動的に設定されていないですか？
クラスマスタの登録IDクラスが試験項目マスタの登録ID(4桁)+試験項目マスタの更新カラム名(2桁)である前提で、 declare 　cursor c1 is 　select 試験項目マスタ.登録ID 　　　　,substr(クラスマスタ.登録IDクラス,5,2) 更新カラム 　from 試験項目マスタ 　　inner join クラスマスタ 　　on 試験項目マスタ.登録ID = substr(クラスマスタ.登録IDクラス,1,4) 　order by 試験項目マスタ.登録ID 　; 　 　w_sql varchar2(4000); begin 　for r1 in c1 loop 　　w_sql := 'update 試験項目マスタ '; 　　w_sql := w_sql := 'set ' || r1.更新カラム ||' = ''○'''; 　　w_sql := w_sql := 'where 試験項目マスタ.登録ID = ' || r1.登録ID; 　　execute immediate w_sql; 　end loop; 　commit; end; / とかでどうですか？ update文を登録ID毎に実行したい気もしますが、とりあえずイメージだけでも。
SELECT BUSYO_CD,MIN(RENBAN), MAX(RENBAN) FROM ( SELECT RENBAN,BUSYO_CD, ISNULL( (SELECT MAX(RENBAN) FROM @BUSYO AS S2 WHERE S2.RENBAN < S1.RENBAN AND S2.BUSYO_CD <> S1.BUSYO_CD),0) AS grp from @BUSYO as S1 ) TT GROUP BY TT.grp,BUSYO_CD ORDER BY TT.grp
SQL Server 2005 EXPRESS Developer EditionというものはＭＳのホームページには存在しませんよ。 SQL Server 2005 EXPRESS EditionとSQL Server 2005Developer Editionの２つは存在しますね。 >>Developer Editionは開発・テスト用途と言う事ですが、本番環境との違いとは何ですか？ 文字通り、開発とテストには使ってよいけど、本番環境、つまりは実際の業務では使ってはいけないって意味ですね。 ”開発とテスト”環境と"本番"環境に差があるのは、おわかりだと思います。「テスト環境だよ」といいながら、日々の売上業務にDeveloper Editionを使ってはいけないってことですね。 本番で使うなら、WorkgroupかStandardかEnterpriseのエディションの中から、適切なものを選んで買ってくださいってことですね。 紳士協定的なものと私は思っていますが、なんらかのチェックをＭＳが行っているかもしれませんので、違反が判明したら、大変なことになるかもしれませんね。
SQL ServerでもAccessでも競合が起こらないようにアプリを作らなければどちらでも同じです。 Accessでも競合が出ないように作れば2台で同時に使用しても実用に足るものは作成できます。 想像でしかないのですが、常にテーブルを開いた状態で動いているのではないでしょうか。そういう作りなら競合が出てもしかたがないと思います。
誕生年、名前、年齢が同一で住所がことなる場合はどのレコードを取得するのでしょうか？ たとえば、 誕生年|名前|年齢|住所|・・・ S34 |山田|24|大阪 S34 |山田|24|大阪 S34 |山田|24|大阪 S34 |山田|24|東京 というデータの場合は大阪と東京のどちらを取得するかの条件は決まっていますか？ そんなデータは存在しないというならば、row_number関数を使って select 誕生年,名前,年齢,住所 from ( 　select 誕生年,名前,年齢,住所 　　　　 ,row_number() over(partition by 誕生年,名前,年齢 order by 住所) row_num 　from テーブルA ) where row_num = 1; とかでもいいかと思います。 参考URL：http://msdn.microsoft.com/ja-jp/library/ms186734 …
ちょっと否定的な書き込みで申し訳ないのですが、 これは技術的興味ということでトライしているのでしょうか？ マイクロソフトはWindows Server 2008では、SQL Server 2000をサポートしていませんので、インストール出来たとしても運用には大きなリクスを伴うことになります。 http://www.microsoft.com/japan/sqlserver/2005/ho … そんなこと百も承知でやっているということならば申し訳ありません。
はじめまして。 解決にならないかもしれませんが、参考になれば幸いです。 ちなみにサーバーのＯＳは何でしょうか？ C:\AAA.csv ↑Ｃドライブ直下にファイル出力しようとしているので、ひょっとしたらアクセス権が無い等の理由で失敗しているのかなと思いました。 共有フォルダを作ってそこに出力するなど、出力先を変えてみてはいかがでしょうか。
No.1です。 >もしかして、条件EmployeeID=Employees.EmployeeIDで、相関副問い合わせのときのように、１つのEmployeeIDが副問い合わせの中に渡されて、その度ごとに副問い合わせが実行されるのでしょうか？ はい。SELECT句の副問い合わせは、抽出されたレコードの分だけSELECTが実行されます。 スカラー副問い合わせ というものですね。
思いつくことを列挙してみました。的外れかもしれませんが、許してください ・実行権限がない（SQLサーバーのジョブはユーザーは誰で動作するのでしょうか？） ・SQLサーバーにexeの実行権限がない（スクリプトだけしか実行できないとか） ・SQLサーバーの処理機能（Shell)に偽EXE(Bat_To_Exe_Converterで作成したexe）を実行する能力がない。（VisualStudioで本物のEXEを作って実行できるか試せばわかる） ・相対パスになっていてパスがちゃんと読めない（exeの指定は絶対パスで書いてありますか？） ・実行した結果を格納する権限（大抵はファイルを書き出す権利）がない
　ご質問の文章だけではなかなかイメージしづらいです。 　そのアクセスソフトのバックアップはとられてませんか（データ自体は古くても構いません）。 　もしあるようでしたら、今問題のソフトを一旦コピーするか別のフォルダーに退避させ、バックアップソフトをセットして下さい。 　次にそのバックアップ部分はデータが古いので、「テーブル」の中身を全て削除して、問題のアクセスのテーブルの中身をセットすれば問題解決と思います。 　ただこの私が言ってる意味がわからなければ、アクセスに詳しい人に聞くか、再度お尋ねください。ただし、バックアップがあることが前提です。 　
できるSQLServer運用という本を少し読んで、SQLSEVERの導入・運用を経験し、SQL文をたくさん書くってことで、私はがんばりました。
これはManagement Studioからではなく，T-SQLによる設定方法とみなしてよいでしょうか。 T-SQLでは，GRANTを使います。たぶん，他のDBにおけるSQLでも同じでしょう。 MSDN: GRANT (オブジェクトの権限の許可) (Transact-SQL) http://msdn.microsoft.com/ja-jp/library/ms188371(SQL.100).aspx
3年ほど前にAccessアップサイジングウィザードを使用してSQL Serverへ移行しました。 結論は圧倒的に速度アップしました。VPNを通じて2拠点間で単純なフォームを開くのに 3分程度要していたものが、瞬時に開くようなりました。テーブルとクエリはSQL側に フォーム、レポートとモジュールはAccess側に置いています。クエリはSQLだとビュー、 ストアドプロシージャ、テーブル値関数になります。Access.mdbの場合クエリを実行 する際、サーバからクライアントにクエリに関連するテーブルの値をダウンロードして きます。またクエリ実行中もサーバとの同期を取りながら計算しているため時間が かかります。Access.adpの場合はクエリの結果のみを受け取るためサーバの処理速度 に依存することになります。 3年前はSQLは全く知りませんでしたし、今も高速化のテクニックなど知りません。 使用しているサーバはDELLのPowerEdge840です。サーバ専用機を使用するメリットは 24時間365日稼動が前提として製作されているので信頼性が高いという点だと思っています。
> SQLServerへの接続の場合、dbOpenTableは使用できないのでしょうか？ > dbOpenTableが使用できないとなると、IndexやSeekも使用できないということでしょうか？ はい、その通りです。
ディスクアクセスと比べれば計算は非常に高速です。 計算が多いから遅いということは、あまり考えられません。 ３万件のテーブルだけを使用しているのですか？ 複雑な計算をしてるなら当然複数のテーブルを使用してますよね。 それら複数のテーブルをサーバーに置いてリンクテーブルにし、 従来通りのクエリーをそのまま使った場合は、確実に遅くなります。 高速化にはそれなりのテクニックが必要です。 方法はケースバイケースですので、実際のクエリーを見てみないと分かりません。
手元にMSSQLが無いので推測です。 強制的にエラーにすると接続エラーが出る、との事ですが、以下の可能性が考えられます。 DOSのコマンドの多くはエラーの場合、正常時とエラー時で出力される標準出力が違います。 つまり、接続エラーと正常メッセージは別の領域に吐かれている、と言う事です。 それを両方同じにするなら > D:\AAA.log ↓ > D:\AAA.log 2>&1 とする必要があります。 最後のおまじないは、「エラー時にも正常の標準出力として表示せよ」と言う意味です。 （Unix/LinuxでもWindowsでも同じ）
64Bit版しか提供がないのはWindows2008R2です。 SQL Server2008は32bit版、64bit版両方存在します。 2008のExpress版をダウンロードすればよいと思います。
Windows Installer Cleanup ユーティリティを保存してあるので特に。。。 とだけ回答してもしょうがないので、完全無保証ですが手助けを。 http://web.archive.org/web/20050329041601/http:/ … URL からもわかるとおり Microsoft ではない第三者のサイトですので完全に無保証です。 ご自分でリスクを背負ってダウンロードしてください。
「XXとYYが何件あるかカウントをして」というのがイメージつかめませんが、 こういうこと？ Select A.*,B.BCnt from A inner join ( Select B4,Count(*) BCnt from B Group by B4 ) C on A.A4=B.B4 これでA3とBCntを比較すればいいんじゃないでしょうか？ ＊意味合いが違うのであれば、結果としての表がどういうものが必要なのかを提示するといいと思います。
こんにちは。 まずは起動して良かったです・・・。 コマンドラインからMySQLに接続できないとの事ですが、 「どのようなコマンドを打って」 「どのようなエラーメッセージが出たか」 を補足してもらえますか？ 単につながらないだけでは、原因がわかりません・・・。
こちらをどうぞ。 http://support.microsoft.com/kb/280106/ja
こんにちは。 cp932がデフォルトなので・・・。 UTF-8に変更してはどうですか？ 今更無理ですか・・・。
まずリンクサーバの登録をします。Managment Studioからサーバオブジェクトを展開しリンクサーバを右クリックし新しいリンクサーバをクリック。画面の指示に従って登録してください。 SQL文の例 SELECT AA.*, BB.社員名 FROM 別のマシンのインスタンス名.別のマシンのデータベース名.dbo.社員マスター AS BB INNER JOIN dbo.テーブルa AS AA ON BB.社員コード = AA.社員コード VPNを構築していれば遠方のSQLサーバともおなじ要領で結合することができます。
> 物理名を英語表記にしておかないと > パフォーマンスが低下するなどの弊害があるのでしょうか？ パフォーマンスがどうかという話なら関係ないと思います。 只、歴史的には日本語は幾多のトラブルを起こしています。 ＤＢ自体あるいはフロントエンドのバージョンアップの際に、 全角文字の片方のバイトが制御文字だった場合とか 全角英数字が勝手に半角に変換されてしまうとか 半角カナが勝手に全角に変換されてしまうとか 全角の波線がうまく処理されないとか。 現在チャンと動いていても将来まで保証されるものではありません。
>ダミーテーブルを使用するということができないよう 何を言いたいのかよく分かりませんが、１ヶ月分の日付の集合を生成といったことなら、SQL Server 2005以降なら、WITH式で再起呼出する方法でも作れると思います。
こんにちは。 データベースはSQLServer プログラムはVB2010 なので、逆にXAMPPは不要かと思います・・・。 （PHPやPerlで開発するなら便利ですが） あと必要なのはWebサーバーだけなので、Apache入れるかIIS使うかですね。 ＞XAMPP　+　SQLServerで使用すれば良い、という事で合ってますよね。 まぁ間違ってはないですけでど・・・。 XAMPPは要らんと思います。 （入れたからって損ではないですが） SQLServerインストール。 VB2010の開発環境は既にある（はず）。 ApacheまたはIISを起動させれば、お望みの事になるかと・・・。
CATCHブロックの中は空でいいですよ（CONTINUEはOracleでは？） 以下ご参考までに。 件数のことを考えると、エラーになる理由が分かっているならば、本当はカーソルを使わずにエラーにならないものだけをINSERTするような処理を書いた方がよいですけどね。 DECLARE @TBL TABLE (ID int PRIMARY KEY,VAL char(1)) DECLARE @ID int,@VAL char(1) DECLARE C CURSOR FAST_FORWARD LOCAL FOR SELECT 1 ID,'A' VAL UNION ALL SELECT 2 ID,'B' VAL UNION ALL SELECT 3 ID,'C' VAL UNION ALL SELECT 3 ID,'D' VAL UNION ALL SELECT 4 ID,'E' VAL UNION ALL SELECT 5 ID,'F' VAL OPEN C FETCH NEXT FROM C INTO @ID,@VAL WHILE (@@FETCH_STATUS=0) BEGIN 　BEGIN TRY 　　INSERT INTO @TBL VALUES (@ID,@VAL) 　END TRY 　BEGIN CATCH 　END CATCH 　FETCH NEXT FROM C INTO @ID,@VAL END CLOSE C DEALLOCATE C SELECT * FROM @TBL ID　VAL -------- 1　A 2　B 3　C 4　E 5　F
> ANSI_PADDING へえー！ 知らなかった。 文字列を厳密に比較するときは、 WHERE colA COLLATE JAPANESE_BIN LIKE '1234 ' みたいに書かないといけないのかな？
質問は？
意味がよく分かりませんが、以下のSQLでどうでしょう SELECT A.* FROM 社員台帳 AS A INNER JOIN 年度辞書 AS B ON A.年度=B.年度
SELECT 商品マスタ.商品名 FROM 商品マスタ WHERE 商品マスタ.子コード in( SELECT 対応テーブル.子コード FROM 対応テーブル,商品マスタ WHERE 対応テーブル.親コード = 商品マスタ.商品コード AND 対応テーブル.親コード = 1000,1002,1004 )
EXCELでデータベース（のように使うってことですよね）はあんまり 聞いたことないですが・・・。 メリットとしては導入コストの削減、メンテナンスを手で可能 （SQLサーバーなどのツールを使わずにってこと） デメリットとしては、管理データの件数が増えていった再の検索速度の低下 セキュリティの問題（この辺りはＰＣの設定の問題もあるので、EXCELに限りませんが・・） >飲食店の顧客データベースを作成する際 >一般的にどのように行っているのか これは、もうピンキリじゃないですか？ 飲食店というのも幅が広いすぎですよね？ チェーン店なのか、店と事務所が別なのか、１店舗で１人だけなのか 店の規模や、かけれるお金などによりさまざまなシステムがあると思いますよ。 小さい店舗なら、EXCELだけで、管理とかありそうですし。 規模が大きい店舗（チェーン店、全国展開しているもの）とかなら、 ORACLEやwebシステムでMySqlとかも考えられます。
SQL Server Management Studio Express は製品版より機能が制限されています。 SQL Server 2005 の各エディションがサポートする機能 http://msdn.microsoft.com/ja-jp/library/ms143761 … には載っていないけど SqlServer Management Studio ExpressではSqlServerログが見られない？ http://lsahf.spaces.live.com/blog/cns!AC381CDFEF … だそうです。 Developer Edition版のManagent StudioならSQL Server ExpressのSqlServerログは見えるのでは？
SELECT 生年月日, dateadd(d,1,substring(convert(varchar,getdate(),111),1,5)+substring(convert(varchar,生年月日,111),6,5)) AS 契約開始日 FROM 給与台帳 その他にも色々と表現する方法はあると思いますので １例としてご参考にして頂ければと思います。
#2です。 >Set Cmd = New ADODB.Command >Cmd.CommandText = ”CREATE VIEW ビュー AS SELECT * FROM テーブル WHERE 日付='2010/07/09'” >Cmd.Execute もちろん、権限があればできます。 しかし、そのリクエストをした人にもう一度確認することをお勧めします。 私もVB内で10行以上のクエリを組み立てて実行しているのを見てげっそりすることはありますので、 「長いクエリはビューで管理したい」というリクエストは理解できます。 ただ、本当に「パラメータまで含めて一切をビューにし、すべてWHERE文の一切ないSELECT * FROM ビューだけにしたい」 というリクエストをしたとすれば、その人はシステムのことを理解していないので、説明すべきだと思います。 ・同時に複数のユーザ・複数の処理でビューを参照できなくなるので、ユーザ数×処理数だけ同じようなビューが必要 ・ビュー定義の一部だけを再作成することはできないので、再作成には常に全部を実行する必要がある。処理はわかりやすくならない
VB6と違い、コントロールに「デフォルトプロパティ」は存在しません。 テキストボックスならtextbox1.textまできちんと記述しないといけません。 textbox1だけなら「テキストボックスオブジェクト」になるので、それを文字列には代入できないわけです。
Order by にたいして、インデックスは有効です。 TOP は関係ないと思います。 インデックスを作成してみてはいかがでしょうか？
この問題には定義が一つなく、「何々付いての問題」のお題できまりますね。つまりカテゴリーですね。 例えば「データベース管理システム」はDBMS(RDBMS)の事でしょうかね。それともDBを管理する管理ツール＆リソースツールのお話でしょうかね。 それで答えが少し違います。 「（２）データベースシステム」とは前述のDBMSとはあきらに違う事がわかりますが、（１）の続きとして出ているのしょうか?　それとも違うカテゴリーでていうのでしょうか? ＞どれも正解のように思えるんですが いいえ、（１）がDBMSであれば、正しくない物を消去するとCしか残らないですね。 a=DBの構築機能、b=DBの活用方法、c=DBを管理するソフト又は、ファイヤーウォール及びOS、d=運用 となる。質問では「役割」となっているので、Cしか残らないかも。だが１つの機能なので、役割と言っていいのか? MSのM=マネジメント　を意味する所からいえば、DBを管理する事柄と言えば、不正アクセスの防止も役割の一つか。 これは、SEと言う職種の、「構築、運用、管理」と言う３つのカテゴリーで分けての設問であれば、この質問の回答は楽に導き出せます。実際の意味とちょっと違うかも。 SEといっても、この３つ全部やっている方もいれば、大きい会社だとかなり分業されています。募集も、この３つに分散されています。 この問題はSE及びシステム営業の何かの試験問題でしょう。 （２）も消去していくと、a,cですね。aは、RDBMSを使用して構築する場合、先に検索結果がどのようなものが必要が最初に考える必要があります。後からでは思うような検索が出ないからと言って、再構築は不可能に近いです。 その場合、例えば株価の予測をする場合、何を項目とするのか、何をキーとするのか、何によって変動するのか（更新される項目）、当初から分析手法を明確にしていないと決まらないからです。 ｃは、必ずしもそうとは言えませんが、項目を追加だけですむ場合もあります（設計によります）。 以上。これに正解があるとしたら、DBMSを知っているか、知っていないかの基準は結構いいかんげんなものとなってしまう。
SQLプロファイラ http://www.atmarkit.co.jp/fwin2k/tutor/sql02/sql …
insert ～;select scope_identity(); 3,4を同時に行う http://social.msdn.microsoft.com/Forums/ja-JP/sq …
多少余計なものも拾うかもしれませんが、 select * from sys.sql_modules where definition like '%union%' が手っ取り早いです。
ちょっと噛み合ってないような気がするので。。 ＞また、入金の数値が、本来の数値の７倍，８倍となって出力されます。 JOINの対象となっているキーが両方とも主キーではないので、当然ながらそうなります。 一旦それぞれのテーブルを集計してから結合するか、UNIONを使うのが一般的だろうと思います。 ○一旦集計してからFULL OUTER JOINする select isnull(u.user_id,n.user_id) user_id, isnull(u.uriage_total,0) uriage_total, isnull(n.nyukin_total,0) nyukin_total from (select user_id,sum(uriage_kingaku) uriage_total from table_uriage group by user_id) u full outer join (select user_id,sum(nyukin_kingaku) nyukin_total from table_nyukin group by user_id) n on u.user_id = n.user_id ○UNIONしてから集計する select user_id, isnull(sum(uriage_kingaku),0) uriage_total, isnull(sum(nyukin_kingaku),0) nyukin_total from ( select user_id,uriage_kingaku,0 nyukin_kingaku from table_uriage union all select user_id,0,nyukin_kingaku from table_nyukin) tmp group by user_id
　とりあえず、 　http://www-06.ibm.com/systems/jp/i/seminar/dwhou … 　このあたりを読んでください。 　必要十分なだけのことが書いてありますから=^・。・^= 　ちなみに、http://www.google.co.jp で、「データウェアハウス　分析手法」と入れて検索しただけ。まぁ、トップにこんなわかりやすい文書が出てくるのも珍しいですが（苦笑）。 　蛇足ですけど、調べる方法を探して調べるのも学習のうちですよ。というか、回答内容より本当はそっちの方が大事だと思うんですけどね。（もう一つ付け加えると、質問サイトで質問するというのは学習する時の調べ方としては、あまりよろしい方法ではありません。先生に答えを聞いているのと同じレベルですから。）
商品番号と数量がくっついていて、正確な数字がわかりませんが、以下として回答します。 select * from 出庫記録 商品番号 数量 日付 ---------- ----------- -------- PRT145 4 20090610 DP255 2 20090610 DP266 3 20090611 PRT255 2 20090611 (4 行処理されました) 回答は以下です。 SELECT MAX(数量) FROM 出庫記録 ----------- 4 (1 行処理されました) SELECT AVG(数量) FROM 出庫記録 WHERE 日付='20090610' ----------- 3 (1 行処理されました) SELECT COUNT(*) FROM 出庫記録 ----------- 4 (1 行処理されました) SELECT SUM(数量) FROM 出庫記録 WHERE 日付='20090611' ----------- 5 (1 行処理されました) ＞a=1 は間違いです。
SQLにおける不等号は数学で出てくるものと同じで、示された値を含みません。 ですので、「年齢 > 20」は年齢が20より大きい場合(21以上)、「年齢 < 20」は年齢が20より小さい場合(19以下)となります。 ちなみに含めたい場合は後ろに「=」を付けます。「<=」「>=」 ですので、(2)の答えは2行になるはずですね。 参考URL：http://ja.wikipedia.org/wiki/%E4%B8%8D%E7%AD%89% …
SQLにはそのような機能はありません。 どのような言語を使用しているのかはわかりませんが、入力のテキストボックスが２つあるのであれば、SQLの作成の前の時点で２つの内容が同一かチェックし、同じでなければエラーとするロジックを組む必要があります。 SQLはあくまで、データを操作するための言語ですので、入力文字のチェックは画面を作成している言語の方で行うのが一般的です。
クエリプランを確認してみましょう。 TOP句を切って先頭何行かを取るだけでも時間がかかるのは、全部並べ替えてみなければ対象が分からないからです。 従って、 1) TOP句のみ　　　IndexScan/TableScan＋Top 2) ORDER句のみ　　IndexScan/TableScan＋Sort 3) TOP句＋ORDER句 IndexScan/TableScan＋Top N Sort となり、3は2と同じくらいになるはずです。 （クラスタインデックスでORDER句を切ったときは例外で、ソート不要のためその場合は1と同じになります） したがって、質問者さんの環境で2と3はどうプランされるかを確認されるのがいいと思います。 なお、TOP 100 PERCENTはSQL Server 2005以降では無視されますので、1と同じ結果になります。
データベースの場合、まず実践が第一です。 文法を覚えたところで、いくら文法的に合っていても、それが望んだ結果となるとは限りません。 最近では、MySQLなどフリーでもそれなりに使えるDBもありますので、それで自分で実際に確かめた方がいいでしょう。 質問の２番目の本になるかと思いますが、私は秀和システムの「SQL辞典」を持っていますが、SQL全部を覚えきれるわけではないので、このような本は１冊は持っていていいでしょう。 SQL言語は、古くからあり、ある意味枯れた言語でもありますので、一度覚えてしまえば、変わったとしてもマイナーチェンジなので、それ以上はそれほど大変ではありません。 また玄人となれば、まずはオラクルDBが必須です。 これを知らずして、玄人とは呼びません。 オラクルを知っていれば、他のDBでできてオラクルでできないことはまずないと言っても過言ではありません。 そして、オラクルにしても単にSQL言語を知っているだけではなく、DB設計やDB構築などができて、初めて玄人と呼べます。 それは長い道のりですが、できれば玄人を目指して頑張って欲しいと思います。
http://support.microsoft.com/kb/918992/ja などがsaで不明エラーで出る要因の一つですが 細かいことはSQLServerのエラーログを詳細に解析しないとなんとも…というところですね。 アプリケーション作成ということですが、WGEを使っていらっしゃるということで、お仕事でしょうか? 会社のDBメンテナンス部門に連絡したり 会社でMSとサポート契約を結ばれていないか確認してみるのも一つの手ですよ。 何の回答にもなっていませんが、根を詰めないようにしてくださいね。
DELETE FROM SYS WHERE [update] >= '2010/06/01' ちなみに、updateというのは予約語ですので、カギカッコで括らないとエラーになります。 不便なので、別の名前にすることをお勧めします。
質問の意味が、「あるテーブルのデータについて、対象フィールドにシングルコーテーションが含まれていたら、そのデータを削除する」ならば、 DELETE FROM あるテーブル WHERE 対象フィールド LIKE '%''%'
if(objDr.Read()){ // 検索の結果、該当するレコードが存在した場合、認証は成功 FormsAuthentication.RedirectFromLoginPage(txtUsr.Text,false); 　　　※このあとを色々と試したのですが駄目でしたorz //objLbl.Text=objCom; //下記のソースを参照する： objLbl.Text = objDr.GetInt32(0).ToString(); // または objLbl.Text = ((int)objDr["所持数"]).ToString(); }else{ objLbl.Text="正しいユーザーIDを入力してください"; }
t1とかt2について これらは「alias」と言って、長いテーブル（またはテーブルと同じ働きと考えられるもの）に 対する別名です。 他にも列名に対しても使えます。 例． select publish,max(price) as 最大値,min(price) as 最小値 from dbo.book group by publish このように使うと（上で「最大値」「最小値」が列に付けたaliasです） publish 　　最大値 最小値 1 インプレス 3129 2625 2 秀和システム 3360 2520 3 翔泳社 4179 2940 のように出力されます。 また、同じテーブルでも別扱いできます。このことによって 自分自身のテーブルとの結合ができます。
#1,#2です。 @@CURSOR_ROWSが件数を返すのはSTATIC/KEYSETカーソルのみのはずです。 STATICは指定してますよね？
曜日の算出を行うにはDATEPARTを使います。 DATEPART(dw,GETDATE()) これにより日曜日から土曜日までが1～7の数字で返ります。 それぞれの曜日の数字が返ってきたときに、何日動かせばその週の月曜日になるかを考えてください。 日 1　－6日 月 2　　0日（そのまま採用） 火 3　－1日 水 4　－2日 木 5　－3日 金 6　－4日 土 7　－5日 よく見てみると、日曜日以外は返ってきた数字を2から引けば動かすべき日数になることがわかります。 （日曜日だけは特別です） したがって、 CASE WHEN DATEPART(dw,GETDATE())=1 THEN DATEADD(d,-6,GETDATE()) ELSE DATEADD(d,2-DATEPART(dw,GETDATE()),GETDATE()) END これでその週の月曜日が求まりますが、GETDATE()というのは時刻もついているので、検索対象のフィールドに時刻まで入っていないなら、このままでは月曜日の取引が全部拾われないことになります。 時刻部分を落とす最もシンプルな方法は一旦年月日の文字型にしてから日付型に戻すことです。 CONVERT(datetime,CONVERT(varchar,日付,111)) 上記をまとめると BETWEEN CONVERT(datetime,CONVERT(varchar, CASE WHEN DATEPART(dw,GETDATE())=1 THEN DATEADD(d,-6,GETDATE()) ELSE DATEADD(d,2-DATEPART(dw,GETDATE()),GETDATE()) END,111)) AND DATEADD(d,6,CONVERT(datetime,CONVERT(varchar, CASE WHEN DATEPART(dw,GETDATE())=1 THEN DATEADD(d,-6,GETDATE()) ELSE DATEADD(d,2-DATEPART(dw,GETDATE()),GETDATE()) END,111))) となります。 逆にもし検索対象のフィールドが時刻も含まれているならば、6日足して日曜日を求めるのではなく、7日足して月曜日を求めて、日付>=週初の月曜日(時刻なし) AND 日付<次の月曜日(時刻なし)としてください。
http://technet.microsoft.com/ja-jp/library/ms186 … >1 回の DELETE または UPDATE 操作によって起動される連鎖参照動作は、循環参照を含まないツリー形式になっている必要があります。DELETE または UPDATE 操作によって生じる一連の連鎖参照動作の影響を複数回受けるテーブルがあってはいけません。 上記に反することから、このケースはCASCADEできないと考えられます。 したがって、外部参照制約だけで表現することはできません。仕様だから仕方がありません。 代替案としては、参照元のテーブルAには通常の外部参照制約だけを掛け（ON DELETE NO ACTION)、削除されたときの動きはINSTEAD OFトリガで実装することになると思います。 テーブルのデザインで回避したいというならば、テーブルBにテーブルAを参照する複数のキー項目を持たせないようにするしかありません。 （マッピングIDでも持たせて２行で収録するとかです）
「在庫データの(例えば)入庫数が、受払データのどれにあたるのか」といったことを、結合によって一覧表示したい、ということでしょうか？ もしそうなら、ちょっと無理な気がしますが… 在庫と受払を紐付けるものが、日付と品番のみ。 でも在庫の日付って、受払の日付とは違うものですよね。 在庫側6/1のデータは、受払の6/2～6/4のデータ… 例えば6月中に入出庫したデータは、在庫の6/1のデータに加算される、とか省略されている仕様があるのでは？ もしそうなら、 在庫.年月の年と受払.日付の年 と 在庫.年月の月と受払.日付の月 と 在庫.品番と受払.品番 を結合してあげれば、なんとなく出来そうな気もします。 当方SQLServerがないため、Accessでのクエリになりますが、ご参考まで。 SELECT 　　　　Q_在庫.年月 AS 在庫_年月 　　　　, Q_在庫.品番 AS 在庫_品番 　　　　, Q_在庫.入庫数 AS 在庫_入庫数 　　　　, Q_在庫.出庫数 AS 在庫_出庫数 　　　　, Q_受払.伝票No AS 受払_伝票No 　　　　, Q_受払.日付 AS 受払_日付 　　　　, Q_受払.入出庫区分 AS 受払_入出庫区分 　　　　, Q_受払.数量 AS 受払_数量 FROM 　　　　(SELECT Year([年月]) AS 年, Month([年月]) AS 月, 在庫データ.年月, 在庫データ.品番, 在庫データ.入庫数, 在庫データ.出庫数 FROM 在庫データ) Q_在庫 　　　　LEFT JOIN 　　　　(SELECT 受払データ.伝票No, Year([日付]) AS 年, Month([日付]) AS 月, 受払データ.日付, 受払データ.品番, 受払データ.入出庫区分, 受払データ.数量 FROM 受払データ)Q_受払 　　　　ON 　　　　(Q_在庫.品番 = Q_受払.品番) AND (Q_在庫.月 = Q_受払.月) AND (Q_在庫.年 = Q_受払.年) ORDER BY 　　　　Q_在庫.年月 　　　　, Q_受払.伝票No; 結果 在庫_年月 | 在庫_品番 | 在庫_入庫数 | 在庫_出庫数 | 受払_伝票No | 受払_日付 | 受払_入出庫区分 | 受払_数量 -----------+-----------+-------------+-------------+-------------+------------+-----------------+----------- 2010/06/01 | A | 3 | 1 | 1 | 2010/06/02 | 入庫 | 1 2010/06/01 | A | 3 | 1 | 2 | 2010/06/03 | 入庫 | 2 2010/06/01 | A | 3 | 1 | 3 | 2010/06/04 | 出庫 | 1 2010/07/01 | A | 0 | 1 | 4 | 2010/07/02 | 出庫 | 1
ロックされてコピー不可能なファイル名が分かるのであれば、参考URLで紹介されているようなツールを使用し、まずはどのプロセスによってロックされているのかをご確認下さい。 参考URL：http://kroko.maxs.jp/~kroko/mt/archives/003290.s …
ネットワークに問題がないなら、 Connection Timeoutとか。
エラー処理などは入れておりません。 置換対象のDBは、実行する場所に依存しております。 実行は読み出し例： ---------------------------------------------------- EXEC 全置換 '検索文字列','置換文字列' ---------------------------------------------------- このコードは全角スペースを利用しています。 「全角スペース1個」→「半角スペース2個」に置き換えて利用してください。 CREATE PROCEDURE 全置換 ( 　　@検索文字　 AS NVARCHAR(MAX), 　　@置換文字　 AS NVARCHAR(MAX) ) AS BEGIN 　　DECLARE @tbl SYSNAME 　　DECLARE @col SYSNAME 　　DECLARE cur CURSOR FOR 　　　　SELECT A.name AS TBL,B.name AS COL 　　　　FROM　 SYS.TABLES A 　　　　　　　 INNER JOIN Sys.Columns B ON A.object_id　= B.object_id 　　　　ORDER BY A.name, B.column_id 　　OPEN cur 　　FETCH cur INTO @tbl,@col 　　WHILE @@FETCH_STATUS=0 　　BEGIN 　　　　DECLARE @prm NVARCHAR(MAX) 　　　　SET @prm　　= '@find NVARCHAR(MAX), @rep NVARCHAR(MAX)' 　　　　DECLARE @sql NVARCHAR(MAX) 　　　　SET @sql = 'UPDATE ' + @tbl + ' SET ' 　　　　SET @sql = @sql + '[' + @col + '] = REPLACE([' + @col + '], @find, @rep) ' 　　　　SET @sql = @sql + 'WHERE [' + @col + '] LIKE ''%'' + @find + ''%''' 　　　　EXECUTE sp_executesql @sql, @prm, @find=@検索文字, @rep=@置換文字 　　　　FETCH cur INTO @tbl,@col 　　END 　　CLOSE cur 　　DEALLOCATE cur END
検索すると http://www.pcreview.co.uk/forums/thread-1303421. … http://www.ehow.com/how_5552829_create-sdf-files … 有償のものはあるようですが、、、 http://www.gui-innovations.com/html/remotesqlce. … http://www.flyhoward.com/SDF_Viewer.aspx
DATEDIFFは片端ですから、dateAは含まれないということですかね。 計算でも見づらくはなりますが、できることはできますよ。 期間内最初の土曜、日曜をそれぞれ求めて、残りの期間を7で割って回数を求めます。 SELECT dateA, dateB, DATEDIFF(d,dateA,dateB) -CASE WHEN DATEADD(d,7-DATEPART(dw,DATEADD(d,1,dateA)),DATEADD(d,1,dateA))>dateB THEN 0 ELSE DATEDIFF(d,DATEADD(d,7-DATEPART(dw,DATEADD(d,1,dateA)),DATEADD(d,1,dateA)),dateB)/7+1 END -CASE WHEN DATEADD(d,8-DATEPART(dw,dateA),dateA)>dateB THEN 0 ELSE DATEDIFF(d,DATEADD(d,8-DATEPART(dw,dateA),dateA),dateB)/7+1 END FROM T_TEST
データベース 　-DB名 　-セキュリティ 　-ユーザ　でプロパティを表示し、「セキュリティ保護可能なリソース」で操作してください。 http://technet.microsoft.com/ja-jp/library/ms188 …
SQL Server 2005のSSMSでは行数に制限がなかったので、2008で困った人は結構いるようですね。 SQL文を学ぶに越したことはないものの、ちょっとした作業にはGUIは便利であることは私も否定しません。 ツール=>オプション=>SQL Serverオブジェクトエクスプローラ=>コマンド ここに「上位<n>行の選択コマンドの値」「上位<n>行の編集コマンドの値」という設定があります。 それぞれをゼロにすると、件数制限は外せます。 ただ、「100万件のテーブルでこれをやるとどうなるか」を考えると、件数制限ができるようになった理由もご理解いただけるでしょう。一応「改善」の１つだと私は思います。
操作方法については #1 さんが詳解した URL で勉強しましょう。 んで SQL Server Express Edition がいつインストールされたのか、ですが。。。 本人が明示的にインストールした記憶がないのであれば、おそらく Visual Studio やら Visual Basic をインストールしたときにインストールされたのだと思います。
SQL Serverが当該ファイルを使用中なのでは。 SQL Serverを停止してみるとか。VWDのDatabase Explorerならアタッチ方式でなく接続方式を使えないか試してみるとか。
コマンドEXITを使って、＠＠ERRORの値を返すとか。 詳しくはosqlあるいはsqlcmdのコマンドリファレンスをご覧ください。
sp_spaceusedとか。 定義を参照して、希望する結果を出力するようなクエリを組み立ててみては。
どうやら、SQL Serverは2008ではTRUNCATE_ONLYは使えないようですね。 参考URLを参照ください。 参考URL：http://yorihiko.blogspot.com/2009/06/sqlserver20 …
テーブルsysobjectsを検索してCSV化したいテーブル名を出力するSQLを実行して、その結果を使ってbcpを起動するバッチを作るとか。
DELETE FROM DB2.dbo.table1 INSERT INTO DB2.dbo.table1 SELECT * FROM DB1.dbo.table1 膨大な行数であれば、DB2.dbo.table1のインデックスを一時的に削除するとよい。
こんにちは DB2はバージョンによっても関数の仕様が違ってくるので、かなりわかりにくいですね・・・。 （何故DB2なのか・・・、マニュアル少ないし・・・） とりあえずTMSPCカラムの型が整数値なら、CHARで変換できます。 DECIMALでフォーマット指定なら、バージョンを教えてください。
うーん…それってプログラムに問題があるような気がするのですが。 プログラム側で接続を開放しそこねていて、多重接続しているとか...。 そういう状態になったときにsysprocessesテーブルなどで接続数を確認してみてもいいかもしれません。
こんばんは ＞エクセル出力時のパラメーター長の制限(?)で断念しました。 これがよくわかりませんが・・・、 SQL Serverなので、「sp_executesql」でやっちゃえばいいかと思います。
SQL ServerのmsdbはMicrosoft System Databaseの略のはずですけどねぇ。。
ＢテーブルのSELECT文で ltrim関数で、左空白文字を外し、concat関数で左一桁に「0」を 文字連結させる。 SELECT concat('0', ltrim(ＮＯ)) from Ｂ ・・・
再帰CTEの話をすると混乱するかもしれませんので、とりあえず以下を。 ただ、クエリを見る限り、Accessっぽいのが気になります。 SELECT CASE WHEN d5.ChildID IS NOT NULL THEN d5.ChildID WHEN d4.ChildID IS NOT NULL THEN d4.ChildID WHEN d3.ChildID IS NOT NULL THEN d3.ChildID WHEN d2.ChildID IS NOT NULL THEN d2.ChildID WHEN d1.ChildID IS NOT NULL THEN d1.ChildID END, CASE WHEN d5.ChildID IS NOT NULL THEN d4.ChildID WHEN d4.ChildID IS NOT NULL THEN d3.ChildID WHEN d3.ChildID IS NOT NULL THEN d2.ChildID WHEN d2.ChildID IS NOT NULL THEN d1.ChildID END, CASE WHEN d5.ChildID IS NOT NULL THEN d3.ChildID WHEN d4.ChildID IS NOT NULL THEN d2.ChildID WHEN d3.ChildID IS NOT NULL THEN d1.ChildID END, CASE WHEN d5.ChildID IS NOT NULL THEN d2.ChildID WHEN d4.ChildID IS NOT NULL THEN d1.ChildID END, CASE WHEN d5.ChildID IS NOT NULL THEN d1.ChildID END, COALESCE(d1.ChildName,d2.ChildName,d3.ChildName,d4.ChildName,d5.ChildName) FROM Department d1 LEFT OUTER JOIN Department d2 ON d2.ChildID=d1.ParentID LEFT OUTER JOIN Department d3 ON d3.ChildID=d2.ParentID LEFT OUTER JOIN Department d4 ON d4.ChildID=d3.ParentID LEFT OUTER JOIN Department d5 ON d5.ChildID=d4.ParentID
とくに特別な処理は必要ないはずです。 リストアは正常に行われたと書かれていますが、中身が見られないならば、それは正常に行われていないということかもしれません。 ・sys.databasesのstate_descの内容がONLINEになっているか ・use データベース名 ・そもそもsysadmin権限のあるユーザでリストアしたか ・バックアップファイルが正常か あたりを確認してみるしかなさそうです。
ですか・・・。 じゃあWhileで発行するのをやめたらどうですか？ BEGIN TRAN update table set A=1,B=2 where id=1; update table set A=2,B=3 where id=5; update table set A=9,B=99 where id=7; update table set A=5,B=10 where id=15; update table set A=1,B=10 where id=75; COMMIT まとめて実行・・・。
はじめまして、通るすがるともうします。 普通、サーバー系で使用するものって（ＤＢサーバーとか、ｗｅｂサーバーとか） それを２４時間稼働するために、様々なチューニングを施して、１年中稼働できる ようにメモリおよびディスク容量を見積もって構成を決めるのですけど、そんな 簡単に、ソフト入れ替えて済むものなのでしょうか？ たとえば、コンピュータ会社にソフト制作（ＰＣへのインストール、設定込み） を依頼して導入したＰＣに、ユーザーによる他アプリケーションをインストール して何か不具合があったとしてもそれは、保障しませんよ！
名前付きパイプを使用して接続するようにしてみてください。 詳細は下記。 参考URL：http://support.microsoft.com/kb/195566/ja
SELECT A.* FROM TBL A INNER JOIN (SELECT Max(登録日) AS 最新日 FROM TBL WEHERE 登録日<=CONVERT(SMALLDATETIME,'2008/12/08')) B ON A.登録日=B.最新日 こんな感じでしょうか
http://www.microsoft.com/downloads/details.aspx? … http://blogs.technet.com/sqlpm-j/archive/2009/05 … SP3を適用すれば良いようです。SP3のインストール対象OSにWin7があります。
ダウンロードの画面に以下の記述がありますので、ご自分の環境にあったものを選択してください。 注 : SQL Server 2008 Express には、32 ビット版と 64 ビット版があります。SQLEXPR32_x86 は、32 ビット オペレーティング システム用の SQL Server 2008 Express のインストールだけに使用できる小型のパッケージです。SQLEXPR_x86 は、同じ製品ですが、32 ビットと 64 ビット (WoW) の両方のオペレーティング システムへのインストールをサポートしています。SQLEXPR_x64 は、ネイティブの 64 ビット SQL Server 2008 Express であり、64 ビットのオペレーティング システムへのインストールだけをサポートしています。これらのパッケージに、それ以外の違いはありません。 http://www.microsoft.com/downloads/details.aspx? …
誤字がかなり多いので一旦整理しますね ---テーブル情報--- ・FoodList NO Food 1 りんご 2 みかん 3 ぶどう ・MyList NO first second 1 2 3 2 1 2 3 2 1 --------------- 正しくは以下の通りです。 -------------------------------- SELECT MyList.No, FoodList.Food As firstFood, FoodList_2.Food As secondFood FROM MyList INNER JOIN FoodList ON MyList.first = FoodList.No INNER JOIN FoodList As FoodList_2 ON MyList.second = FoodList_2.No -------------------------------- スレ主の2件目クエリーの結合順序が逆になっているのが原因ですね。
#2です。 失礼しました。 #1さんのって、カレンダのマスタを利用しているタイプだと勘違いしていました。 「CROSS APPLY hoge.nodes」 これよいですね。 勉強になりました。 m(_ _)m
詳しい情報が欲しければ，リンクを辿ってMSDNまで行けばあります。 MSDN: SQL Server 2008 の各エディションがサポートする機能 http://msdn.microsoft.com/ja-jp/library/cc645993 … など。 SQL Server 2005の時は，MSDEからの乗り替えという問題があったり， 初のExpress Editionということもあって，色々情報を提供する必要があったのだと思います。 元々，SQL ServerのExpress Editionでは色々制約は確かにあるものの， Workgroupと比べて大きく機能が削減されているわけではありません。 # 運用面からはいくらか不安になるかもしれませんが……。 なので，特別専用情報を提供していないだけだと思います。 ちなみに，Tech・EDをはじめとした各種技術カンファレンスでは， SQL Server 2005は「旧バージョン」として扱われ，移行対象の技術にすらなっています。 SITE: Microsoft Tech&middot;Ed Japan 2009 ホーム http://www.microsoft.com/japan/teched/2009/defau … のセッションT4-302 SQL Server 旧バージョンからの移行 http://www.microsoft.com/japan/teched/2009/sessi …
昔、以下のSQLを作ったことがあります。2005では問題なかったです。 私の用はこれで足りたので必要に応じて修正してみてください。 SELECT b.name as "Table名", a.name as "カラム名", c.name as "データ型", a.column_id as "カラム順", a.max_length as "データ長", a.precision, a.scale , case when a.is_nullable =0 then 'Null不可' else 'NUll可' end as "NULL", case when a.is_identity =0 then '×' else '○' end as "オートナンバー", case when a.default_object_id = 0 then '×' else d.definition end as 'デフォルト値', case when f.index_column_id is not null AND e.is_primary_key = 1 then 'PK' else '×' end as 'PK' FROM sys.columns as a Left outer JOIN sys.objects as b ON a.object_id = b.object_id Left outer JOIN sys.types as c ON a.system_type_id = c.system_type_id Left outer JOIN sys.default_constraints as d ON a.default_object_id = d.object_id Left outer JOIN sys.indexes as e ON a.object_id = e.object_id AND e.is_primary_key = 1 Left outer JOIN sys.index_columns as f ON a.object_id = f.object_id AND a.column_id = f.column_id WHERE b.type = 'U' AND c.name != 'sysname' ORDER BY b.name,a.column_id
＞処理に障害が発生しても処理が止まる事がないようにしたいのです。 SQLエラーが発生したからって、勝手にコネクション切れたりしませんが・・・ try～catchの中でSQL発行して、エラーが起きたら、catchの中で適切なエラー処理を行って、呼び出し元へきちんと処理を返せば良いだけですよね。 なので、エラーが起きても続行する事と、コネクションを操作する事に関連性はありませんよね。 まぁ、貴方のやり方で言うなら、cnをグローバルに取るなり、その関数の呼び元で生成して引数で渡して来るなりして、オブジェクト自体は呼び元で生成。 こちらの関数内では、openとcloseだけを行う。 オブジェクトの破棄は、再度呼び出し元で。 とでもやれば、貴方の思っているようなのが出来るのでは？
テーブルではなくデータベースを選択した状態で、 「右クリック」から「タスク」-「スクリプトの生成」を選んでください。 そこから、DB上のオブジェクトの作成スクリプトを出力出来ます。
ODBCの設定を確認してください。 「規定のデータベースを以下の物に変更する」の項目は、どうなっているでしょうか。 ODBCのDSNでは上記で指定したDB上に存在するものが表示されます。 新しいDBを作成したとしても、そのDBを参照するように設定しないと参照出来ません。 DSNで指定したDB上のテーブルと、ManagementStudioで参照しているDB上のテーブルは一致しますか？ 上記を確認してください。 >あるときSQL Server Management StudioでTB01を削除しました。 >ところがACCESSからODBCを通して接続すると削除したはずのテーブル”TB01”が見えていて >リンクを張るとデータも出てきます、 上記ということは、別のDBを操作していると思われます。 SQL Serverを再インストールしたとのことですが、その設定をODBC側に反映させていますか。また、SQL Serverは外部接続可能な設定にしていますか。
どこまで理解されているか不明のため、質問だけに答えます。 >FileStreamデータ型はEXE形式のファイルを格納することも可能でしょうか？ EXE形式のファイルでもバイナリであることに変わりはないので格納できます。 >また、ファイルをテーブルに格納したあとに、実ファイルをHDDから削除しても問題ないですか？ 実ファイルの「場所だけ」を記録するわけではないので、問題ありません。
SQL Serverには以下の方法があります。 ・クラスタ ・ミラーリング ・レプリケーション クラスタは共有ディスクを使用するので、拠点間の距離により制限されます。あとMSCSが必要になります。同一DBを別のサーバで共有するイメージです。アクティブ/スタンバイですけどね。 http://msdn.microsoft.com/ja-jp/library/ms189134 … ミラーリングは別サーバの別DBに変更情報をコピーするイメージです。 こちらもアクティブ/スタンバイですが、スタンバイ側は読み取り専用で参照することも可能です。 http://technet.microsoft.com/ja-jp/library/cc917 … レプリケーションは別サーバの別DBの個別オブジェクトの変更をコピーするイメージです。 http://msdn.microsoft.com/ja-jp/library/ms151198 … この場合はデータベースミラーリングが当てはまると思います。
バックアップのリストア、データファイルのデタッチ／アタッチ、どちらもできます。 ただし、セキュリティ関連などはずいぶん変わりますので、再設定をお勧めします。 また、SQL Server 2008 ExpressにはSQL Server Agentはついてません。念の為。
SqlParameterクラスを使います。 MSDN: SqlParameter クラス (System.Data.SqlClient) http://msdn.microsoft.com/ja-jp/library/system.d … 詳しい方法に関しては，マイクロソフト サポートオンラインの記事 MSKB: [HOWTO] パラメータ化されたストアド プロシージャを ADO.NET と Visual C# .NET を使って呼び出す方法 http://support.microsoft.com/kb/310070/ja を参照してください。
inner joinであれば、どちらも違いはありません。 outer joinであれば、まったく違うものになります。 outer joinの場合、on句の結合条件で偽となる行も、nullとして結果が返されます。また、where句の抽出条件で偽となる行は、最終的な結果としては返されません。
どうやってSELECTしているのかわからないのですが、クエリ画面でSELECT文投げているのではなく、SSMSの機能を使ってクエリを実行しているならば、念のため以下のリンクもチェックしてみてください。 http://support.microsoft.com/kb/915849/ja
SQL Server 2000ではおそらくテーブルを参照しているViewなりストアドなりを全部ALTERしてやるほかないと思います。 （sp_refreshsqlmoduleを実行すればいいのですが、SQL Server 2005 SP2で追加されたものなので）
SQL Server 2008のSSMS/SSMSEから、ALTERですまないテーブル構造の変更はデフォルトでは許可されない設定になりました。 オプションのデザイナ－テーブルおよびデータベース デザイナに 「テーブルの再作成を必要とする変更を保存できないようにする」というのがありますので、そのチェックを外してください。 http://msdn.microsoft.com/ja-jp/library/ms188490 …
夜間バッチかAgenetジョブで実行されているかと思います。 その処理を行っている時間帯に何か問題が発生していないか、イベントビュワー、SQLエラーログを確認してみてはどうでしょうか。 現状、情報がすくなく原因予想が妄想の域を超えるのが難しいです。
ORDER BY 単価 * (フラグ + 1)
SQLのコミットは、どの時点で実行しているのでしょうか？　質問を読むとコミットの可能性は低いですが・・・当たり前過ぎて見過ごすこともあるので参考までに。 １個のSQLでコミットすると非常に遅くなるので、ある程度纏まった時点でコミットしていると思いますが、コミットまでのSQLが大量に貯まるとコミットした時点で大量にメモリを消費して・・・という可能性もあるのでご確認しては？
>にしますと、状態が１，３の場合は、1のみしか取得できません 「状態が１，３の場合」というのはみかんTに状態が１，３の データしかないという意味ですよね？ この条件で「状態が１，３の場合は、1のみしか取得できません」 ということは他に原因があるかもですね。 ちなみに以下のselect文で期待している値は取れますでしょうか？ SELECT 　連番, 　入荷日, 　状態 　FROM みかん 　WHERE 　　(状態 IN (1,2)) OR 　　(状態 = 3 AND NOT EXISTS (select * from みかん where 状態 = 4));
私はロックヒントを殆ど使わないのですが、実際主キーのないテーブルで試してみるとそうなります。 プロファイラで見ても、ロックヒントのないSELECTがテーブルに対するインテント共有ロック以外取得していないように見えます （ちなみにREPEATABLE READでは行共有ロックを取得し、SERIALIZABLEではテーブル共有ロックを取得しますし、主キーのあるテーブルではキーレベルの共有ロックを取得しいくのでXLOCKでブロックできます）。 MSDNのどこにもそのような記述はないので、いろいろ探した結果、あるMSDNのブログで１つだけそれらしい記述のあるものを見つけました。 > SQL Server avoids acquiring read committed locks when it knows that no data has changed on a page. http://blogs.msdn.com/craigfr/archive/2007/04/25 … この理解が正しいとすれば、「ユーザデータベースでは変更のマークのないページには共有ロックはかけない」となり、XLOCKだけではREAD COMMITTEDのSELECTは阻止できませんから、SERIALIZABLEで排他することが必要になります。 （つまりXLOCK,HOLDLOCK、または、TABLOCKXということになります）
通常は以下のように手順３、４は一緒にやります。 SELECT * INTO TABLEB FROM TABLEA GO TRUNCATE TABLE TABLEA GO INSERT INTO TABLEA(年度,項目1,項目2,...) SELECT 2010,項目1,項目2,... FROM TABLEB ORDER BY 履歴番号 GO もしかして、年度＋履歴番号で主キーになっていて、同じテーブルに2009年度と2010年度を両方収録し、しかもそれぞれの年度で１から連番を振るという意味ですか？ その場合は「TRUNCATE TABLE TABLEA」の代わりに、「DBCC CHECKIDENT (TABLEA,RESEED,0)」を実行し、2010年度も1から振られるようにします。 （こういう使い方はあまりお勧めではないですけど）
Xp のファイヤーウオール　を設定してください。 ＳＱＬ Server に必要なポート（TCp 1433)　が解除されていないと　接続できません。 また　ＳＱＬ Server 側にも設定が必要です。 ◆ SQL Server 2005 Tips and Tips 第 1 回 ネットワーク接続を有効化しよう http://www.microsoft.com/japan/sqlserver/2005/ss … ◆SQL Server 2005でネットワーク接続を有効にするには？ http://www.atmarkit.co.jp/fdotnet/dotnettips/545 … 上記にてたぶん　ＯＫだと思います。 ◆SQL Server 2005 自習書シリーズ 　http://technet.microsoft.com/ja-jp/sqlserver/cc7 … この辺も読んでおくことをおすすめします。
SQL Server 2000だと、ここまでじゃないでしょうか。 SELECT OBJECT_NAME(i.id),s.groupname FROM dbo.sysfilegroups s INNER JOIN dbo.sysindexes i ON i.groupid = s.groupid WHERE i.indid in (0, 1) SELECT s.groupname,f.name,f.filename FROM dbo.sysfiles f INNER JOIN dbo.sysfilegroups s ON s.groupid=f.groupid ファイルグループ内のどのファイルが使われているかまではわからないと思います。 そのファイルが空かどうかはちょっと乱暴ですが、削除できるかどうかで確認はできます。 （実際Enterprise Managerで削除しようとすると、確認もしないでALTER DATABASE文を投げてくれています）
そうでしたね、ゲストではログインできるのでした。 そうすると、 ログインアカウントの登録の登録内容が怪しいですね、 ログインアカウントが正しいかどうかの確認をもう一度行ってみてください。 VB.NET側のタスクがどのユーザーアカウントによって実行されているのか？ そのユーザーがSQLServerのログインアカウントに登録されているか？
奥が深いと思ったら、どこがおかしいのかは最終のアプリケーションの戻りだけを調べるのではなく、 いろいろな方法で問題がある個所を特定する必要がありますね。 1)SQL Server Management StudioでSQL Serverに直接接続する ・古いアプリケーションと書いてあったので、もともとSQL Server 2005ではなかったのであれば、 　データベースのプロパティで互換性レベルが90になっているかどうか確認する ・クエリ画面でテーブルを直接SELECTし、確かに値が入っていることを確認する ・対象のクエリを投げてみて、確かに値が入っていることを確認する 2)MSDASQL以外の違うプロバイダを使って接続してみる ・ADOで接続してみる(ゴミプログラムを書いて確認） Dim cn As Object Dim rs As Object Set cn = CreateObject("ADODB.Connection") Set rs = CreateObject("ADODB.Recordset") cn.Open "Provider=SQLOLEDB;Data Source=インスタンス名;User ID=ユーザ名;Password=パスワード;Initial Catalog=データベース名" rs.Open "クエリ",cn Do Until rs.EOF ' Msgbox や Debug.Printで中身を確認 rs.MoveNext Loop rs.Close cn.Close Set rs = Nothing Set cn = Nothing ・上記のProviderを"SQLNCLI"に変更して確認してみる 今の段階ではなんとも言えないですが、MSDASQLではエラーでSQLOLEDBでは正常ならば、プロバイダの問題という可能性もありますし、最終的にはテーブルを再作成（外部キーを保管して別のテーブルにデータを移すのは簡単にできます）すれば解決するかもしれません。
ツールのオプションのスクリプト生成のところで、「Use <Database>のスクリプト生成」(True/False)が選べるようになっていませんか？
Number列に「SELECT Number FROM test.dbo.tblinfoB WHERE userId = name'」という「文字列」をセットしようとしてエラーになっていますNumber列はintですし、こんな「クエリそのもの」をセットtblInfoAにセットしたいわけではないですよね。 そもそもなぜ同じように書かなかったのでしょうか？ （実行したいクエリの方にはVALUES句はないですよね） 普通に考えたら、以下のようになると思いますが。 mssql_query("INSERT INTO test.dbo.tblInfoA (Number,ID) SELECT Number,userId FROM test.dbo.tblinfoB WHERE userId='$login';")
#2,#5です。 サーバとクライアント両方に同じ名前、同じパスワードのユーザが存在する（ブランクパスワード不可）ならば、通常は接続できるはずです。 SQL Server 2008/Windows 7のワークグループ環境まではちょっとないので、質問者さんの環境でもそうだとは断言はできませんが、少なくとも2005/XP環境で試してみると問題なく認証されますね。 それにしてもアカウントは漢字なんですか？（単なる例にしては。。）
『DBサーバのレスポンスが悪いことによるPVの減少』ということですね。 WEBサーバのログなどは解析しましたか？（レスポンス時間等・・・） CPU使用率の波形だけではDBのせいと断定するには弱いのですが、、、 まぁ人間の感は意外とよくあたりますので、、、 DBの件数増加や、統計情報の劣化、インデックスのフラグメントとかとか。。 （0と100の行き来で、レイジーライターかと思ったけど若干波形が違う・・・）
「排他制御に適しているのはどちらか」という質問の答えは、当然ながらSQL Serverです。 Accessは自身がサービスをもっていないので、いわば「管理者のいないデータベース」です（もともとがシングルユースを前提としたものなので当然なのですが）。レコード単位の排他制御の機能はありますが、アクセスする各ユーザが制御することになるため、テーブルに正しくアクセスする仕組みになっていない限り（＝トランザクションモードとロックとキャッシュを考慮したアクセス方法のみでアクセスするように作られていない限り）実現できません。 少なくとも更新時の排他制御は本来ユーザに十分な知識がなくても実現されるべきものなので、その意味で適していないと思います。 「複数ユーザによるアクセス」「排他制御」が条件になっていて、まだデータベースを選べる状態なんだったら、SQL Serverを選択すべきでしょう。
その職場で、なにをするかにもよります。 下記の役割では求められる知識が異なります。 ・DBの構築・管理（DBA） ・DBのテーブル設計など ・アプリの開発 SQL Serverの基本的なところを知るには以下の書籍がわかりやすかったです。 SQL Server2005でいってみよう　開発編 SQL Server2005でいってみよう　運用管理編 あと、なにをするにもBooks Onlineは必須でしょう。 http://msdn.microsoft.com/ja-jp/library/bb418431 …
OfficeアプリケーションとはAccess.adpでしょうか？Access.adpの場合は「ファイル」-「接続」で出てきたデータリンクプロパティの「すべて」のタブをクリックし最下行のWorkstation IDの値を各PCの名前に変更して「OK」　この作業を各クライアントで行う必要があります。
>この事から、リンクサーバーでのSQL文の実行自体はAccessで行っているのでしょうか？（Accessに負荷がかかっている？） そりゃあそうです。 SQL Serverは質問者さんとAccessの間に立って、質問者さんの投げたSQL文をAccessに代わりに投げて結果を受け取っているだけですからね。 パフォーマンスを考えたら、別の人も書かれているようにACCESSの該当テーブルをSQL Serverへのリンクテーブルにして、SQL Serverからは実体のテーブルを参照するようにした方が遥かによいです。
「CodeBとNameは1行に最大5回まで存在しうる」ので常に５セット(CodeB5,Name5まで)返していいということですよね。 SQL Server 2005以降であれば、以下のような書き方ができます。 SELECT ID, CodeA, MAX(CASE WHEN Seq=1 THEN CodeB END) CodeB1, MAX(CASE WHEN Seq=1 THEN Name END) Name1, MAX(CASE WHEN Seq=2 THEN CodeB END) CodeB2, MAX(CASE WHEN Seq=2 THEN Name END) Name2, MAX(CASE WHEN Seq=3 THEN CodeB END) CodeB3, MAX(CASE WHEN Seq=3 THEN Name END) Name3, MAX(CASE WHEN Seq=4 THEN CodeB END) CodeB4, MAX(CASE WHEN Seq=4 THEN Name END) Name4, MAX(CASE WHEN Seq=5 THEN CodeB END) CodeB5, MAX(CASE WHEN Seq=5 THEN Name END) Name5 FROM (SELECT a.ID,a.CodeA,b.CodeB,b.Name, ROW_NUMBER() OVER (PARTITION BY a.CodeA ORDER BY b.CodeB) Seq FROM TableA a INNER JOIN TableB b ON b.CodeA=a.CodeA) tmp GROUP BY ID,CodeA
なんでもいいなら、Microsoft AccessでもSQLは使えます。 敷居は一番低いと思いますが、ちょっと特殊なのであんまり勧めません。 カテゴリでもある、SQL Serverでいいんじゃないでしょうか？ 無償で使えるExpress版もあるので、お金もかかりません。 他には、Oracle, Sybase, PostgreSQL, MySQLなどがありますが、No.1の方が言うとおり、環境に合わせたものを使うのが一番いいです。 SQL準拠と言っても、各RDBMSによって、ちょっとずつ仕様が違うので。
#1,#2です。 ・・そうですか。それは知りませんでした。 確かにGRANT EXECUTE TO (ユーザ）でいけそうですね。 設定した結果がユーザのプロパティでは確認できないみたいですが、 データベースのプロパティからは確認できます。 （もしくはsys.database_permissions) ということは、個別に指定しなくてもよさそうですね。
年に数回程度って… その間、OSも再起動しないってことなんでしょうかね？ ずっと起動したまま？ もしそうなら 定期的に再起動かけるようにタスクに記録した方がよいと思います。 | ※ちなみにプログラムではきちんとコミットしているようでした。 そりゃそれがおかしかったら 年に数回しか起きないってことはないと思いますよ　笑
この辺りの対応はおこなってますか。 http://msdn.microsoft.com/ja-jp/library/ms998292 …
通常のCTEでは直前の階層をもとに次の階層のデータを返すという繰り返しになるため、今回の目的の結果にはなりません。 また、最後の２行（部下がいない）は、CTEに外部結合が認められないので出すことができません。 したがって、すべてをアンカーメンバーとして最後の２行は後で付加する方式で考えると以下のようになると思います。 WITH 階層データ AS (SELECT 上司の氏名,氏名,階層,上司の氏名 元の上司, 階層 元の階層 FROM データ WHERE 上司の氏名 IS NOT NULL UNION ALL SELECT d.上司の氏名,d.氏名,d.階層, h.元の上司,h.階層 FROM データ d INNER JOIN 階層データ h ON h.氏名=d.上司の氏名) SELECT 元の上司,氏名 FROM (SELECT 元の上司,氏名,元の階層,階層 FROM 階層データ UNION ALL SELECT 氏名,NULL,階層+1,階層+1 FROM データ WHERE 氏名 NOT IN (SELECT ISNULL(上司の氏名,'') FROM データ) ) tmp ORDER BY 元の階層,階層
SQL Server 2005からはユーザとスキーマは分離されています。 スキーマを分けてテーブルなどのオブジェクトを作ることで、オブジェクトを分類して管理することができます。 すべてのスキーマには所有者がいます。 所有者になれるのはユーザのほかデータベースロール、アプリケーションロールです。 従来はスキーマはユーザと連動していたので、testusrユーザを作るとtestusrスキーマが作られ、そのスキーマ内にテーブルを作ってしまうと、testusrを削除できなくなってしまうという問題がありました。 今は書かれている通り別のユーザにスキーマの所有権を移すことができるので、所有するスキーマを全部他のユーザに移してしまえば、ユーザの削除も可能です。 今回話題になっているスキーマがdb_datareader, db_ownerなどのシステムにもともと作られていたスキーマなのであれば、それらの本来のスキーマ所有者は同じ名前のデータベースロールです。なので、同じ名前のデータベースロールに所有者を変更しておけばよいでしょう。 また、testschema1など自分で作成したスキーマで、そのスキーマ自体がもう不要なものなのであれば、スキーマフォルダからそのスキーマ自体を削除してしまっても構わないです。既にそのスキーマに削除できないオブジェクトが作成されているならば、どれか別のユーザに所有権を移してあげて問題ありません。適当なユーザがないならばdboユーザに所有権をつけてください。
SQL ServerでもCOALESCE関数が使えるのではないですか？ COALESCE(電話番号, 携帯電話番号)
以下を参照してください。 http://msdn.microsoft.com/ja-jp/library/ms143241 … http://msdn.microsoft.com/ja-jp/library/ms143241 … >パターン2 >SQL2000→SQL2000→SQL2000→SQL2000 これは意味がわかりません。 レプリケーションを4重にするのですか？ 最初のSQL Server2000をパブリッシャにして、あとの3つへレプリケートすればすむのではないでしょうか。
全く同じ事で悩んでいました。 ■知りたいこと ですが、ExcelやCSVファイルにエクスポートし、 そのファイルをインポートしようとした場合に該当の問題は良く発生します。 原因は、 (1)DBのデータ型とExcelセルのデータ型が一致していない (2)Excelにエクスポートする際に、Excelに対応する書式にDB値が変更されるが、逆にDBのインポートの際にうまく取り込めない 等、さまざまな要素が考えられると思います。 特にフラットファイル（CSV）に出力するとより顕著に表れます。 想像ですが、DBにVarcharを使ってませんか？ ExcelはNTEXTとして吐かれると思うので、インポートの時にはあわせてあげる必要があります。（それでもエラーが出たりしますが） 素直にバックアップかデタッチしたほうがスムーズにいくでしょう。
[Access] [更新クエリ]で検索してみてください。 以下のような感じで、更新クエリを作成すればOKです。 http://makotowatana.ld.infoseek.co.jp/access/ach … http://office.microsoft.com/ja-jp/access/HA10076 …
> MSDE2000にて自動で圧縮されるという噂 聞いたことありません。 MSDE200のトランザクションログはデフォルトで「シンプル」になります。 「シンプル」の場合は、トランザクションログが肥大化しません。 http://www.horikawa.ne.jp/cgi-bin/showlog.cgi?kd …
IPアドレスが正しいものであるならば、構成マネージャでプロトコル「TCP/IP」が有効になっていることと、インスタンスのプロパティでリモート接続が有効になっていることを確認してみてください。
>WHERE retu LIKE 'data%' >AND CAST(RIGHT(retu,3) AS Int) BETWEEN 100 AND 300 を >WHERE retu LIKE 'data%' >AND ISNUMERIC(RIGHT(retu,3))=1 >AND CAST(RIGHT(retu,3) AS Int) BETWEEN 100 AND 300 または >WHERE retu LIKE 'data%' >AND RIGHT(retu,3) BETWEEN '100' AND '300' >AND ISNUMERIC(RIGHT(retu,3))=1 とすればよいでしょう。
#1です。 >要は、名前に対して、コード１は複数ある可能性があり、 >コード２は１つしか存在しない、のです。 「名前からコード２は一意に決まる」、これが仕様であるということならば、 SELECT a.名前, a.コード1, ISNULL(b.コード2, (SELECT コード2 FROM BTABLE WHERE コード1 IN (SELECT コード1 FROM ATABLE WHERE 名前=a.名前)) ) FROM ATABLE a LEFT OUTER JOIN BTABLE b ON b.コード1=a.コード1 なんて書き方もできますが、SQL Server 2005以降ならば以下の方法が一番楽でしょう。 SELECT a.名前, a.コード1, MAX(b.コード2) OVER (PARTITION BY a.名前) FROM ATABLE a LEFT OUTER JOIN BTABLE b ON b.コード1=a.コード1
OSの日付と非常に密接ですので、難しいと思います。 OSの日付を変えると支障が出るが、SQL Serverだけなら、と思っておられるなら、以下のリンクもご覧ください。 http://support.microsoft.com/kb/951622/ja そのような状況が想定される場合、予めGETDATE()をスカラー関数でカプセル化しておくなど、作る前なら やりようもあったんですけどね。。
#1です。 補足ですが、RESTOREコマンドに「WITH REPLACE（強制的に上書きする）」を指定します。 リストア先のパスが異なる場合は「MITH MOVE '(論理名)' TO 'リストア先パス'」も指定します。 SSMSの復元画面にはスクリプト生成機能がありますので、それも活用してみてください。
「バックアップを取ろうとして間違えてリストアし３日前に戻った」ということは、 「最新のバックアップは３日前のもので、それ以降のバックアップはない」ということですよね。 NTBackupなど、OSレベルでのバックアップも取っていないのですよね。 残念ながらデータベースファイルもログファイルも完全に上書きされていますので戻すことは不可能です。
一応結果は出たので参考程度に・・・ select a.id, coalesce(c.count, b.count, null) from tableid as a left join table1 as b on(a.id = b.id) left join table2 as c on(a.id = c.id) order by a.id coalesce() リスト内の最初の非NULL要素を返す。
「反映されない」が「クエリ自体がエラーになる」という意味であれば ・select 直後の「Aテーブル」の記載 ・「@伝票番番号FROM」 ・「ユーザID」が最後の列なのに後ろにカンマがついている 正直これらは質問するときの打ち間違いなのか、ソースもそうなっているのか、全く判別ができません。 「反映されない」が「０行処理されました」と表示されるという意味であれば、 要は対象データがヒットしないということで、 ・@IDがCテーブルのIDに存在しない ・@CDがAテーブルのCDに存在しない ・@伝票番号FROM～@伝票番号TOの間にあるAテーブルの伝票番号が存在しない （@IDや@CDをセットしたつもりでも、実はセットされてないとかも含む） のいずれかだと思います。 後者の場合、 --delete from Bワークテーブル --insert into Bワークテーブル --( --ID, --CD, --伝票番号, --部門CD, --引当日, --ユーザID --) select 　Cテーブル.ID, 　Aテーブル.CD, 　Aテーブル.伝票番号, 　Aテーブル.部門CD, 　Aテーブル.引当日, 　Aテーブル.ユーザID from Aテーブル INNER JOIN Cテーブル ON Cテーブル.ID = @ID --where Aテーブル.CD = @CD --and ((Aテーブル.伝票番号 >= @伝票番号FROM) OR (@伝票番番号FROM IS NULL)) --and ((Aテーブル.伝票番号 <= @伝票番号TO) OR (@伝票番号TO IS NULL)) のように条件指定部分やINSERT部分をコメントアウトして、単なるSELECT文として結果が返るか調べ、 あとは徐々に条件指定を増やしてチェックするのが一般的です。
まず、確認として、エージェント経由とManagementStudio経由で レスポンスの違いはないでしょうか。 違いがなければSQLの問題です。 > WHERE A + B + C NOT IN (SELECT A + B + C FROM TABLE_A) Where条件に式を入れると索引を使いません。 ManagementStudioで、実行計画を表示させてみましょう。おそらく索引を使っていないと思います。 せめて、こう書きましょう。片側のテーブルの索引は使ってくれるかもしれません。 WHERE (A,B,C) NOT IN (SELECT A,B,C FROM TABLE_A) あとは、not existsで以下に書き換えるか。 INSERT INTO TABLE_A SELECT AAA, BBB, CCC, 0, 0 FROM TABLE_B WHERE not exists (select 'X' FROM TABLE_A where ABLE_A.A = ABLE_B.A and ABLE_A.B = ABLE_B.B and ABLE_A.C = ABLE_B.C ); not inには以下の問題があるので、私はnot existsを使ってます。 http://oshiete1.goo.ne.jp/qa5419099.html?ans_cou … いずれにしろ、実行計画を取ってみて効率のよい書き方を探してください。
ありますよ。 テーブルとインデックスの見積もり式です。 http://msdn.microsoft.com/ja-jp/library/ms187445 …
リストアしたファイルが最後のレプリケーション設定／変更後のものであるならば、通常は再作成は不要です。 パブリッシャデータベースをリストアした場合であれば、リストア後にsp_replrestartを実行してディストリビュータと再同期させ、その後サブスクリプションの再初期化を実行することになると思います。 参考URL：http://msdn.microsoft.com/ja-jp/library/ms152560 …
発行するのはデータベースクライアント 実行するのはデータベースサーバ
#1,#2です。 この質問は、「既定のデータベースがリストア対象のデータベースと同じ場合に、ADO経由でリストアを実行するための方法」だったと思いましたが、そちらの方はもういいわけですかね。 別の質問の方の「バックアップを自動化するツール」ということでsqlcmdをご紹介し、そこにsqlcmdの構文をご紹介したのですが、osqlでも構文は殆ど同じです。 （-Qパラメータを使います）
#1です。 定期的にっていうのは、タイマー処理ということではないわけですね。 いずれにしても、sqlcmdの使い方は以下の通りです。 バッチファイルに貼るなり、VBAでシェル実行するなり、してください。 （本当にやるときは改行しちゃだめですよ、念のため） sqlcmd -S(インスタンス) -U(ユーザID) -P(パスワード) -Q""BACKUP DATABASE (データベース名) TO DISK='C:\(パス)\(データベース名).bak' WITH INIT" > C:\(パス)\log.txt sqlcmd -S(インスタンス) -U(ユーザID) -P(パスワード) -Q""USE master;RESTORE DATABASE (データベース名) FROM DISK='C:\(パス)\(データベース名).bak' WITH REPLACE"" > C:\(パス)\log.txt
パラメータの@valueが長さを指定していないので、１バイトとみなされ、どんなにやっても@maxbyte以上にならないから、無限ループなんだと思いますよ。 ちなみに、2005でtext型を勧めるのもどうかと思いつつ、 SELECT substring(convert(text,@value),1,@maxbyte) はたまに使います。
技術的な裏付けがない直観なのですが、ASP.NETからSQL Serverに接続するときに使用する接続文字列が変更に対応させてないからだと思います。 まずは、恐らくweb.configの中のconnectionStringに記載されている接続文字列を変更してみてはどうでしょうか。
ロールを利用したグループ単位での権限設定 http://www.atmarkit.co.jp/fnetwork/rensai/sql18/ …
混乱があるかな、と思うのは、 「DBNull.Value」はVB内で解釈されるもので、「INSERT INTO ...」という構文はSQL Serverで解釈されるものです。 したがって、SQL Serverが「INSERT INTO tbl_Main(dteDate) VALUES (DBNull.Value)」というSQLを受け取っても、 「DBNull.Value」が何なのかSQL Serverには判断できないです。 「INSERT INTO tbl_Main(dteDate) VALUES (NULL)」でいいでしょう。
2ヶ月を減算すればいいのでは？
>#1さんの指摘では、ttrがスコープ外？だったから >いけなかったのでしょうか。 迷走してませんかね？ >b (ttr.documentcode, cnt) as ( CTEで「表名を　b　、列名を　ttr.documentcode　と定義する」という指定になっていますよ？ もし、仮にそういった列名を使いたいなら、標準SQLでは " （二重引用符）、SQL Serverなどは　[ ] で囲みますよね？
IDENTITY関連なら以下を参照しておいた方が良いですよ。 http://msdn.microsoft.com/ja-jp/library/ms176057 … http://msdn.microsoft.com/ja-jp/library/ms186775 … http://msdn.microsoft.com/ja-jp/library/bb734402 …
取り込み先のインスタンスがデフォルトインスタンスではないんじゃないのですか？ （たとえばlocalhost\SQLEXPRESSとか） 普通は-Sオプションでインスタンスを指定します。 bcp TEST.dbo.table1 in "フルパスのファイル名" -Slocalhost\インスタンス名 -C -t, -T
実際に実行されているSQL文とかはみれないのですか？
多対多のリレーションについて、中間の所属テーブルで多対1対多の構成に分解して構築する意図の問題ですね。 ukiuku0904さんの考えた3つのエンティティで概ね合っていますが、 所属表は、学生名、サークルのアトリビュートは不要です。また、所属表のインデックスのための所属主キーがあった方がよいでしょう。 ・学生表 学生ID（主キー)、学生名、入学年度 ・所属表 所属主キー、　学生ID、　　　　サークルID 　　　　　　　学生テーブル　　サークルテーブル 　　　　　　　から矢印　　　　から矢印 ・サークル表 サークルID(主キー)、サークル名 と構築し、 SELECT * FROM　所属表 INNER JOIN 学生表 ON 所属表.学生ID=学生表.学生ID 　などと操作して、リレーショナル型データベースの特性を生かした 活用を目論むことになります。
「今までに一度も購入したことがない人」であれば商品購入テーブルにいないので別ですが、今回は最低一回は購入した人が対象になっているので、差分をとるようなクエリが適当だとは思えないです。 いろいろ方法はあるでしょうけど、とりあえず購入月は数字で入っているとして考え方を示しますと、以下のようになります。 SELECT 顧客ID, 商品コード FROM 商品購入テーブル WHERE 顧客都道府県 IN ('東京都','神奈川県') AND 顧客ID IN (SELECT 顧客ID FROM 商品購入テーブル WHERE 購入月=5) AND 顧客ID IN (SELECT 顧客ID FROM 商品購入テーブル WHERE 購入月=6) AND 顧客ID NOT IN (SELECT 顧客ID FROM 商品購入テーブル WHERE 購入月 IN (7,8)) しかし、これはさすがに効率がよくないので、 「5月と6月に購入してて、7月と8月に購入していない]の部分はGROUP BYを使って一括で条件指定するのも手です。 SELECT 顧客ID, 商品コード FROM 商品購入テーブル WHERE 顧客都道府県 IN ('東京都','神奈川県') AND 顧客ID IN (SELECT 顧客ID FROM 商品購入テーブル WHERE 購入月 BETWEEN 5 AND 8 GROUP BY 顧客ID HAVING SUM(CASE WHEN 購入月=5 THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN 購入月=6 THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN 購入月 IN (7,8) THEN 1 ELSE 0 END)=0)
Access のリンクテーブルでその DB に接続して、テキスト ファイルにエクスポートしては？
結合がお好みならば、FULL OUTER JOINを使ってみてください。 SELECT ISNULL(a.ID,b.ID) ID, ISNULL(a.VALUE,b.VALUE) VALUE FROM TableA a FULL OUTER JOIN TableB b ON b.ID=a.ID WHERE a.ID IS NULL OR b.ID IS NULL
#1です。 本当は998と指定することと、997と指定することは同じことです。 実はDATETIMEの一番最後（ミリ秒）の部分には「0,3,7の３種類の数字しか収録されない」のです。 それ以外の数字を入れようとしても丸められてしまいます。 http://msdn.microsoft.com/ja-jp/library/ms187819 … 例えば'2009/11/18 10:00:00.998'をセットしようとすると、 8ミリ秒＝7ミリ秒＋1/3と判断されてしまい、丸めて7ミリ秒になるということです。 結果は'2009/11/18 10:00:00.997'になります。 したがって'2009/11/18 10:00:00.999'をセットしようとすると、'2009/11/18 10:00:01.000'になります。 9ミリ秒＝7ミリ秒＋2/3と判断し、丸めた結果切り上がるというわけです。
(1)はインポート・エクスポートユーティリティを使った話でしょうか？ エクスポートユーティリティを使ってExcelにエクスポートしたものをインポートできないという点については、当方では確認できません（問題なく改行込みでインポートできました） (2)同一インスタンス内にあるのであれば、 INSERT INTO データベース名.スキーマ名.Aテーブル SELECT * FROM データベース名.スキーマ名.Bテーブル が一般的ではないでしょうか？ インスタンスをまたぐ場合でも、SSISやリンクサーバを使えばできると思います。
「あるパッケージ」という表現を使われている時点で 具体的な回答をすることができないのですが…(・・;) ここからはあくまでも'推測'です。 sqlConf.php というファイル名をキーワードに検索 したところ、「WEBSQUARE」という会社のパッケージ製品 にたどり着きました。こちらの商品をお使いなんでしょうか？ だとすれば、メーカーに質問されるのが筋なのでは？ マニュアルも公開されているようですし、 まずはそちらをご一読される事をオススメします。 少しでもこれがご理解できない、というレベルでしたら、 まずはご自身のスキルを磨いて下さい。 どんなご事情か存じませんが、がんばって下さい。
PATINDEX('%[^0-9]%',フィールド) を使うとできそうな気がします。 http://technet.microsoft.com/ja-jp/library/ms188 … http://technet.microsoft.com/ja-jp/library/ms187 …
メッセージはSQL Serverが出しているものです。 エンドユーザのログインがuser1であるとして、 ・user1が「勤怠_DB」においてdb_ownerである ・「SP_労務明細表」に対するEXECUTE権限を明示的にdenyしていない （denyしていれば２番のコメントのところで実行した２つ目のクエリに出てきます） ・user1でSSMSにログインし、上記ストアドを手動実行すると実行できる という理解なので、実行が拒否される理由が正直わからないです。 （こちらでは、いただいたソースでいろいろ試しても再現できませんので。。） で、user1にsysadminを付けるとExcelファイルに出力できるわけですか？ ＞どうもファイルへの出力が出来ないようです。 SQL Server自身がデータベース外のリソース（ファイル等）にアクセスするためには、確かにsysadminが必要ですが、メッセージは、そもそもこのストアドの実行権限がないと言っています。 （Excel出力のVBAを実行すると、SQL Serverが行うのは「EXEC SP_労務明細表 'xxxx','xxxx','xxxx'」だけであって、ファイル出力はアクセスが行います） ＞そのモジュールを使っている命令やコンボボックスの、ソースにストアドを指定してある部分はストアドも動作しています。 のように、まだコミュニケーション不足の部分があるんですかね。。
インストールしたのは本当にSQL Server 2008 Management Studio Express だけですか？ http://www.microsoft.com/downloads/details.aspx? … もしそうならば、SQL Serverを管理するためのツールをインストールしただけで、 肝心のデータベースエンジン（質問者さんがサーバと呼んでいるもの）をインストールしていないことになります。 以下のもの(SQL Server 2008 Express Edition)をインストールしてください。現在の最新版はService Pack1です。 http://www.microsoft.com/downloads/details.aspx? … このインストールが成功したら、サーバ名＝localhost\SQLEXPRESSで接続できるようになるはずです。
全部Excelに吐き出したいのですよね？ ＞実際の所２０個のテーブルに対して同操作を繰り返し手動で項目整理を行う事になるのでしょか １回で１ブックに全部吐き出すことができますよ。 ・変換先にExcelを指定し、保存先のファイルパスを指定 ・「１つ以上のテーブルまたはビューからデータをコピーする」を選択 ・コピーしたいテーブルすべてをチェック。何もしないとテーブル名がシート名になる（変換先の名前は個別に変更可能） ・「データ型マッピングの確認」画面が出る ここで注意マークが出ている項目は正しく出力できない可能性があります。上の画面でテーブルを選んで、下の画面でチェックをオフにすることをお勧めします。 あとはそのまま進んで実行します。 エクスポート作業は何回試しても元データに影響することはありませんから、うまくいくように設定を変えつつ何度でも試してみることです。 （技術不足は手数でカバーするしかありません）
Access のテーブル側で、日付列の書式設定を明示的に設定しておくとよかったように記憶してます。 (2) については当方の環境が合わないため回答できません。
4桁の数字はどうやっても時刻とは認識されないので、手間でも':'を入れてあげる必要があるでしょう。 方法はなんでもかまいません。 insert into table1 values (STUFF('1234',3,0,':')) insert into table1 values (LEFT('1234',2)+':'+RIGHT('1234',2))
SQL Server 2005以降でROW_NUMBER()が使えます。 SELECT ROW_NUMBER() OVER (ORDER BY コード) AS 連番,コード,名称 From テーブル where 条件 ただし、ソート順指定は上記の通り必須です。
OS と SQL Server のバージョンやエディションが何なのか分かりませんが、とりあえず。 1. [マイ コンピュータ]-[右クリック]-[管理] 2. "コンピュータの管理" ツールの左側ツリーで [サービスとアプリケーション]-[SQL Server 構成マネージャ]-[SQL Server xxx のサービス] を選択。 3. 右側ペイン "SQL Server (MSSQLSERVER)" とか "SQL Server(SQLEXPRESS)" とか(カッコの中はインスタンス名)を右クリックして [プロパティー] を選択。 4. [ログオン] タブを見る。 または、[サービスとアプリケーション]-[サービス] を選択。 右側ペインの "SQL Server (インスタンス名)" を右クリックして [プロパティー] を選択。 [ログオン] タブを見る。 または、[スタート]-[管理ツール]-[サービス] でもサービス一覧が表示される。 または、[スタート]-[プログラム]-[Microsoft SQL Server xxxx]-[構成ツール]-[SQL Server 構成マネージャ] とか。
クライアント＝SSMSであるならば、前者はOK、後者はNGです。 （データベース間の連携という意味では互換性はあります）
質問の背景が十分理解できたわけではないです （レガシーASPなのか、ASP.NETなのか、なぜADO/ADO.NETでやらないのか、Exe自体がリモートで動いた結果のエラーなのかどうかも？） 手動でうまくいき、リモートでうまくいかないのは権限の問題でしょう。 システムDSNはレジストリに書かれますが、ASPによりサーバ側で動くアカウント（IUSER_xxxxとか)がそれを読めていないのでは？ ファイルDSNに変えて権限を与えてみたら確認できるかもしれません。 ちなみに、ASP経由でサーバのExeを叩くようなことはセキュリティ面でも処理の安定性の面でもあまりやらないと思います。
補足。（大雑把に説明してるので厳密には違う部分もあることは頭に入れてください） かえって混乱するようであれば無視してください。 SQLでの「and」というのは 「andの左右両方の条件式が成り立つときに『条件成立』とする」 という意味があります。 なので、 1=0 and 1=1 　は、「成り立たない」and「成り立つ」なので、条件は成り立たず、 0=0 and 1=1 　で、「成り立つ」and「成り立つ」なので、ここで初めて条件は成立します。 だから、 1 = a and b 　というのは、andの右側が条件式になっていないのでエラーになります。
PFSはGAMやSGAMと同じくシステムの内部情報ですので、通常意図的にこのような不整合を生じさせることはできないはず。。 ちなみにSQL Server 2005のSPはいくつですか？ 以下のサイトによれば、SQL Server 2005 SP2までにはPFSのバグらしきものがあったようです。 http://www.sqlskills.com/BLOGS/PAUL/post/Corrupt … 直接関係あるかはわかりませんが、この内容だと主にBULK処理の場合に発生する可能性がありそうですね。
もともとMSDEは実運用目的に作られていないので。 ソフト開発時のデバッグ用途等の簡易機能だけですので、それほど性能を求めてはいけません。 原因としては、SQLサーバと違いノーメンテナンスだからでしょう。 普通、SQLサーバでは、１日１回か最低でも週１回は最適化等のメンテナンスを行いますので。
質問者さんがETLに求めるものが何か全くわからないので、SSISの何をコメントすればよいのか見当がつかないです。 他のツールとの比較検討をする目的なら、チェックしたいポイントがあるはずですよね？
一般論として、クエリを分析、実行するオプティマイザはクエリそのものの違い、データ件数の違いだけではなく、 インデックス情報や収集した統計情報も使って最適な実行プランを作成しようとします。 http://technet.microsoft.com/ja-jp/library/cc966 … また、実行プランはキャッシュされますので、その差が影響する場合もあります。 その意味では、データ量が少し違うだけで別のプランが有利だと「判断する」可能性は当然ながらあります。 （オプティマイザが選択したプランが常に最適というわけではありません） HashJoinとNested-Loopが本当に唯一の違いなのであれば、質問者さんのこのクエリの実行環境においては、1000件が結合方法を切り替えるボーダーになっている可能性はありますが、それだけが理由なのか、当然ながら開示された情報では圧倒的に情報が不足していますのでコメントすることはできません。 前述の通り、実行プランの選択には多くの要素があることを認識いただくべきだと思います。
#1です。一部訂正。 unionでallを指定しなければ、重複排除されるので、#1のselect文のgroup byは不要。もし、各値が何件あったかといった情報も知りたい場合は、group byとcount関数等を組み合わせて使ってください。 各値を昇順や降順に並べたい場合は、#1のselect文にorder byを追加してください。
#1です。 私の、ということであれば、varchar(4)にしてチェック制約を掛けますかね。 （日付も結局別フィールドに持たせるならばdatetimeにしてしまいますが） でもsmallintでも構わないと思います。 チェック制約も活用してきちんと収録されるようし、時間計算にはスカラー関数をいくつか用意すればいい話です。 （分単位の情報を計算列で持たせるのでもいいと思います）
#1です。 キーが２つ以上あるならば、EXISTS句を使ってください。 DELETE a FROM Test1 a WHERE NOT EXISTS (SELECT NULL FROM Test2 WHERE tt1=a.t1 AND tt2=a.t2) DELETE a FROM Test2 a WHERE NOT EXISTS (SELECT NULL FROM Test1 WHERE t1=a.tt1 AND t2=a.tt2)
#1,#2です。 テーブルの別名をうまく使わないと、JOINの多いクエリは複雑になるので、混乱するんだと思います。 今回はどうせ別名は必須なので、全部のテーブルを別名を使って書けばよいと思います。 SELECT --表示するデータ ・・・ ・・・ ・・・ FROM Aテーブル a LEFT OUTER JOIN Bテーブル b ON a.○○ = b.○○ LEFT OUTER JOIN Cテーブル c ON a.△△ = c.△△ INNER JOIN (SELECT 住所,COUNT(DISTINCT 郵便番号) CNT FROM Aテーブル GROUP BY 住所) d ON a.住所=d.住所 WHERE a.■■='1' ORDER BY a.◎◎
SQL Serverだと以下のようにsys.sp_addextendedpropertyを使用します。 EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'コメント' , @level0type=N'SCHEMA', @level0name=N'dbo', @level1type=N'TABLE', @level1name=N'テーブル名', @level2type=N'COLUMN', @level2name=N'カラム名' http://msdn.microsoft.com/ja-jp/library/ms180047 …
項目No1～3それぞれについてキー番号内でユニークになるように登録されているならば、 以下の方法でいいでしょう。 SELECT a.キー番号, a.項目No, CASE 項目No WHEN b.項目No1 THEN b.項目No1名称 WHEN b.項目No2 THEN b.項目No2名称 WHEN b.項目No3 THEN b.項目No3名称 END FROM テーブルA a LEFT OUTER JOIN テーブルB b ON a.キー番号=b.キー番号 AND a.項目No IN (b.項目No1,b.項目No2,b.項目No3) 上記を満たさないならば、別の方法が必要です。 SELECT a.キー番号, a.項目No, b.項目名称 FROM テーブルA a LEFT OUTER JOIN (SELECT キー番号,項目No1 項目No,項目No1名称 項目名称 FROM テーブルB UNION SELECT キー番号,項目No2 項目No,項目No2名称 項目名称 FROM テーブルB UNION SELECT キー番号,項目No3 項目No,項目No3名称 項目名称 FROM テーブルB) b ON a.キー番号=b.キー番号 AND a.項目No=b.項目No
#1です。 SSMSでテーブルを直接開いて編集しているのであれば、 ツールバーから「抽出条件ペインの表示」を選んで、たとえば以下のように条件を指定し、実行すれば並び順を希望のものにしたまま編集できます。
#2です。 cというのは、よく見ていただくとわかりますが、 SELECT 郵便番号,COUNT(*) 番号 FROM Bテーブル GROUP BY 郵便番号 HAVING COUNT(*)>1 というクエリの結果自体に別名をつけたものですので、 別に新しいテーブルは必要ありません。 そのままいけるでしょう。
3000バイトのフィールドのテーブルを作り、REPLICATE('a',3000)で3000バイトの文字列を10レコード入れ、 あとは以下のクエリを流しっぱなしにすれば、ディスクのIO次第ですが、１～２時間で30GBになるでしょう。 INSERT INTO TABLE1 SELECT t1.FLD FROM TABLE1 t1,TABLE1 t2,TABLE1 t3,TABLE1 t4,TABLE1 t5,TABLE1 t6,TABLE1 t7,TABLE1 t8
\PerflibのLast Counter/Last Helpの10進値と、\Perflib\009(011でも同じ)のCounter/Helpのデータ末尾の項目の数字は通常一致しています。 私の端末の例ですが、 Last Counter REG_DWORD0x000033a (13114) Last Help REG_DWORD0x000033b (13115) Counter値末尾 「..... Cache % Process Memory Limit Used 13108 Cache % Process Memory Limit Used Base 13110 Cache Total Trims 13112 Cache API Trims 13114 Output Cache Trims」 Help値末尾 「...... 13109 Cache % Process Memory Limit Used Base 13111 Total number of entries forcibly removed from the cache due to memory pressure. 13113 Total number of entries forcibly removed from the cache due to memory pressure that were originally inserted into the cache using one of the public cache APIs. 13115 Total number of entries forcibly removed from the cache due to memory pressure that were originally inserted into the cache by the output cache feature.」 もし合っていなければ、合わせろということですかね。 私もここをいじる機会は特になかったです。
SQL Server 2000でこれを一発でやるのは結構厄介ですね。 しかも、示して頂いている例だけだと、このテーブルには主キーがないのかもしれないと思えます。 softのように同じupdtimeのものが３つある場合に、Itemcを選ぶ基準がわからなかったので、 とりあえずcodeの降順で一番大きいものにしておきました。 実態に合わせて調整してください。 SELECT (SELECT TOP 1 code FROM table1 WHERE cate=t.cate and updtime=t.upddtime ORDER BY code DESC), t.cate, t.updtime FROM (SELECT cate,max(updtime) updtime FROM table1 GROUP BY cate) t
以下のリンクが参考になると思います。 Unicode を使用するサーバーと Unicode 以外を使用するクライアント間のデータ変換の管理 http://technet.microsoft.com/ja-jp/library/ms190 …(SQL.90).aspx INSERTをどういう風に行うイメージなのかわかりませんが、 sSQL = "INSERT INTO TABLE1 VALUES ('" & sFileData & "')" といった方法を考えているのであれば、 sSQL = "INSERT INTO TABLE1 VALUES (N'" & sFileData & "')" のようにNプレフィックスをつけないと化けるはずです。 データベースの照合順序（のコードページ）を日本語以外にしないと確認しづらいと思いますが。 なお、根本的なところを書いておきますと、SQL ServerのUnicodeはUCS-2で、UTF-8ではありません。 データベース側で設定できるのはデータ型（Unicode型か非Unicode型）だけであり、Unicode型ならばUCS-2、非Unicode型で日本語の照合順序を選択すると、コードページ932(いわゆるS-JIS)になります。
こんな感じでしょうか WITH TestKo12(betumei1, betumei2, betumei3) AS ( 　　SELECT k11, k12, k13 FROM TestKo1 　　UNION ALL 　　SELECT k21, k22, k23 FROM TestKo2 ) SELECT 　　t1, 　　t2, 　　betumei1, 　　betumei2, 　　betumei3 FROM TestOya INNER JOIN TestKo12 　ON t1 = betumei1 > やはり、unionを使うことでしか対応できないのでしょうか？ UNIONを使うと拙いことでもあるのでしょうか どうしてもUNION以外で実現したいのであれば、到底お勧めできませんが・・・ WITH TestKo12(betumei1, betumei2, betumei3) AS ( 　　SELECT 　　　　COALESCE(k11, k21), 　　　　COALESCE(k12, k22), 　　　　COALESCE(k13, k23) 　　FROM TestKo1 　　FULL OUTER JOIN TestKo2 　　　ON NULL IS NOT NULL　-- ありえない条件 ) SELECT 　　t1, 　　t2, 　　betumei1, 　　betumei2, 　　betumei3 FROM TestOya INNER JOIN TestKo12 　　ON t1 = betumei1 二つ目は実装環境によっては期待通りの結果に成らない可能性もあります インデントは全角スペースで入れているので、コピーして実行する場合は 半角スペースに置換して試してください
Vista対応は確かSP1からですが、今はSP3まで出ているので、SP3を入れればよいと思います。 Express Editionならば、 ・Microsoft SQL Server 2005 Express Edition Service Pack 3 http://www.microsoft.com/DOWNLOADS/details.aspx? … ですが、SQL Server Management Studioという管理ツールがついてこないので、 ・Microsoft SQL Server 2005 Express Edition with Advanced Services Service Pack 3 http://www.microsoft.com/downloads/details.aspx? … の方がいいかもしれません。 インストール方法・使い方については自習書を見て頂いた方がよさそうです。 ・Express基本操作 http://msdn.microsoft.com/ja-jp/sqlserver/cc7206 …
苦言を呈するようですが、自分の書いたものを投稿する前に見直すようにしてください。 詳しく仕様を書いても、辻褄が合わないところだらけです。 ＞番号は1～5,番号2は5～6まで表示したいのです。 例をみる限りは、明らかに「番号は1～4,番号2は5～8まで」ですよね ＞FROM T_テーブル AS T_M_名称_1 いきなり「T_M_名称_1 」という別名が出てくるのはおかしいです（その後は使っていないし）。 そのうえで質問です。 ・SQL Serverのバージョンは何ですか？（今回の質問だと結構重要な点です） ・番号に抜けがある場合、どうしたいですか？例えば、番号=2のデータがなかったとしたら？ (番号1の方に出すのを1,3,4だけにするのか、前に詰めて1,3,4,5にするのかでクエリは随分変わってきます）
以下のサイトくらいしか参考になるものがありませんが。。一応。 SQL Server Integration Serviceをインストールしているならば、そのインストールがうまくいっていない可能性があるということです。 >SSIS No Such Interface http://www.sqlservercentral.com/Forums/Topic2677 … >"no such interface supported" and SSIS http://vasudevtroubleshooting.blogspot.com/2009/ … 対応策は ・SSISのアンインストール＆再インストール ・特定のdllのレジスト となっていますが、なにぶんそのメッセージを出すことができないので、当方では試せません。
Sum関数を使うときは　Group by句で集計キーを指定する。 Joinは使えると思いますがやったことはありません。 日付はそれでもいいと思いますがBetweenを使う方法もあります。
#1,#3です。 >内部的には、一度テーブル結合し、Test2.tt3='AA'を探しだしているということですかね。 >その上で更新しているのでしょうか。 考え方としては近いです。 ただし、実際に確認してみると、SQL Serverのオプティマイザは以下の通りもっと性能がよく、「各レコードの更新回数がｎ回になるだけ」というのは正しくなかったので訂正させていただきます。 ---------------------------------------------------------------------------------------------------------------- データを少し変えて重複させ、どういうプランで実行するか見てみます。 Test1 t1 t2 1 A　　--t1=1を２件いれます 1 A　　--t1=1を２件いれます 2 B Test2 tt1 tt2 tt3 tt4 1 1 AA X　　--t1=1を２件いれます(ただしtt4には別の値を) 1 1 AA Y　　--t1=1を２件いれます(ただしtt4には別の値を) 1 2 BB Z 2 1 CC W SET STATISTICS PROFILE ON GO UPDATE Test1 SET t2=b.tt4--敢えてTest2のtt4で更新させてみます。 FROM Test1 a INNER JOIN Test2 b ON b.tt1=a.t1 AND b.tt3='AA' GO Rows　Executes　StmtText 2　　　1　　　　UPDATE Test1 SET t2=b.tt4 FROM Test1 a INNER JOIN Test2 b ON b.tt1=a.t1 AND b.tt3='AA' 2　　　1　　　　　|--Table Update(OBJECT:([Test1]), SET:([Test1].[t2] = [Expr1006])) 2　　　1　　　　　　|--Top(ROWCOUNT est 0) 0　　　0　　　　　　　|--Compute Scalar(DEFINE:([Expr1006]=CONVERT_IMPLICIT(varchar(2),[Test2].[tt4] as [b].[tt4],0))) 2　　　1　　　　　　　　|--Stream Aggregate(GROUP BY:([Bmk1000]) DEFINE:([b].[tt4]=ANY([Test2].[tt4] as [b].[tt4]))) 4　　　1　　　　　　　　　|--Nested Loops(Inner Join, WHERE:([Test2].[tt1] as [b].[tt1]=[Test1].[t1] as [a].[t1])) 3　　　1　　　　　　　　　　|--Table Scan(OBJECT:([Test1] AS [a])) 6　　　3　　　　　　　　　　|--Table Scan(OBJECT:([Test2] AS [b]), WHERE:([Test2].[tt3] as [b].[tt3]='AA')) SELECT * FROM Test1 GO t1 t2 1 X 1 X 2 B ---------------------------------------------------------------------------------------------------------------- この通り、 1)「Test1」と「Test2のうちtt3='AA'のもの」を結合して、４行を得る 　（Test1とTest2両方にt1=1のものを２行ずつ入れましたから、２×２に重複されて４行になります。 2)ただ、更新するのはTest1のうちの２行なので、２行を２回ずつ更新するのは無駄。したがって集約して２行にしてしまう 　このときに「ANY([Test2].[tt4] as [b].[tt4])」とあるように、tt4の値が複数あったら任意の１つ(つまりXかYかどちらか）にしてしまいます。 3)最後に２行を任意のtt4(例えばX)で更新する。 データ件数が多くなると、集約方法が「並び替え＋DISTINCT」になったりしますが、基本的な考え方は変わらないようです。 以上、ご参考まで。
2つのテーブルを user_id をキーに結合してやれば良いと思います。副問い合わせ等は特に必要ないかと。 例) --------------------------------------------------------------- SELECT t1.user_id, t2.name, t1.time FROM table1 t1 INNER JOIN table2 t2 ON(t1.user_id = t2.user_id) ORDER BY t1.user_id ------------------------------------------------------------------- 片方のテーブルにしかデータが無い場合でも出力したい場合は、「INNER JOIN」の部分を適宜「LEFT OUTER JOIN」「RIGHT OUTER JOIN」などに変えて下さい。 また、行の順番を変えたい場合は、「ORDER BY」の後を変えて下さい。 参考URL：http://www.atmarkit.co.jp/fnetwork/rensai/sql04/ …
#1です。 LDFしかないのであれば、あきらめた方がいいでしょう。 １トランザクションでも復旧したいというケースであれば、ApexSQLLogなどのログマイナーツールを使う手もありますが、前日のバックアップ以降に発行したDDLがあると、かなり厳しくなります。
現在VB側のアクセスがユーザインスタンス(AttachDbFilename=C:\..\xxx.mdf;User Instance=True)になっているとすれば、そのままでは目的の形にするのは無理だと思います。 もともとユーザインスタンスは、そのPCにインストールされているSQL Serverにそのユーザだけがアクセス可能になるように利用時のみアタッチ／デタッチする仕組みですが、SQL Serverにアタッチしてしまうとそのファイルをユーザインスタンスで使うことはできなくなります。 >今度はSQL Server側にパーミッションが変更されるようで、vbからアクセスできないようになってしまいました。 とありますが、パーミッションというよりも、SQL Server自体が排他的にMDFファイルを抱えてしまう(=ずっと使用中)ことによりアクセスができなくなるということです。 したがって、VB側の接続方式を変更するしかないでしょう。 データソースを「SQL Serverデータベースファイル」ではなく「SQL Server」にして、SQL Serverにアタッチ済のデータベースに対して接続を行うように変更してみてください。 （Data Source=.\SQLEXPRESS;Integrated Security=True;Initial Catalog=データベース名というような接続文字列になるはずです）
[FIX] SQL Server 2008 をインストールすると、インストールに失敗し、エラー メッセージ "属性が一致していません" が Summary.txt ファイルに記録される http://support.microsoft.com/default.aspx/kb/957 … インストール先フォルダのアーカイブ属性を確認してみてください、他にもドライブ圧縮している場合には発生したというのも見たことがあります。 ※Express Editionは評価版ではなく、無料で利用できるエディションです。
#1です。 メンテナンスプランで自動生成されたパッケージではバックアップを行うコンテナの「Disable」属性がtrueとして生成されます。したがって、SETオプションで「Disable」属性をfalseにしてあげないとコンテナの中身を実行しないまま正常終了します。 したがって、 /SET "\Package\Subplan_1.Disable";false というようなパラメータを追加する必要があると思います。 このSETパラメータの詳細は、メンテナンスプランを実行するジョブのステップを開き「コマンドライン」タブを見ると確認できます。 なお、DTEXECの性質上、リモートでは無理だと思います。
>プログラムで5分ごとの時間が入った配列を作って1レコードずつ素直に検索しにいくのとどっちが早いでしょうか？ 8,640回クエリを実行しようと思っているならば、圧倒的にその方が遅いです。 8,640件×16のデータを取ってきて、最終的に必要なのが何か読めませんので、なんとも言えませんが、 8,640件×16のデータ全部を使わず、絞り込むのであれば、8,640件×16のデータを取ってくること自体がナンセンスです。 最初から必要なものだけ拾ってくればいいと思います。 >LINQというやつでもだめなのかな～ LINQは処理速度をアップするためのものではありませんよ。
SQL Serverエージェントのサービスアカウントは何を使っていますか？ なんだかhosts読めてないみたいな感じですね。 （名前解決できないとそのメッセージが出るはず） レプリケーションを設定したときのアカウントで実行したらどうなりますか？
構文はあっていますが、ここに開示されている情報が理由ではないと思います。同じ環境ではないでしょうが、再現させられないですからね。 少なくとも ・ここに開示されているソースだけでも再現するか ・動的クエリでない状態でストアド単体でクエリアナライザで実行しても再現するか ・動的クエリの状態でストアド単体でクエリアナライザで実行しても再現するか ・動的クエリ部分を普通のSELECTにしても再現するか ・動的クエリ部分を動的SQLでないストアドプロシージャにしてEXECする形に変更しても再現するか ・出力先をCSVやACCESSのテーブルにしても再現するか といったあたりの切り分けはできているんですよね？ 単体実行で再現するとは思えないので、OLEとの相性になってくるのかもしれません。 （BCPで動的SQLを使うな、という話は前に技術情報に出ていましたので、動的SQLでうまくいかないケースが他にあってもおかしくはない）
原則論から言えば「トリガは使わなくて済むならばできるだけ使わないようにする」が正しいです。 ただし、私はトリガーでやっていいケースはあると考えています。 ・その２つのテーブルの間に極めて密な関係がある（例外なく反映させる） ・１つのテーブル以外はアプリケーションサイドで通常更新対象と認識されていない ・複数のルートでテーブル更新が掛けられる可能性がある ・ユーザがトリガーを無効にできる権限を持っていない 具体的には数十万件の取引データからリアルタイムの累積残高を取得・表示させるための残高テーブルの更新にトリガを使用したことがあります。 今回のケースはストアドでもトリガでやってもいいケースだと思いますが、以下の点は留意してください ・SQL Serverには行トリガがないので、複数更新が掛けられたときの処理を組み込む 　（複数行更新は不可とするか、全部が在庫条件を満たしたときだけＯＫとする） ・在庫がマイナスになる場合はトリガ内でRAISERRORを発行する ・呼び出し元（ストアドでもアプリでも）はエラートラップが必須
UNION文全体を括って、TOP100を切ればいいでしょう。 SELECT TOP 100 * FROM (SELECT dbo.A店TB.ID, ・・（略）FROM dbo.A店TB WHERE (略) UNION SELECT dbo.C店TB.ID, ・・（略）FROM dbo.C店TB WHERE (略) UNION SELECT dbo.C店TB.ID, ・・（略）FROM dbo.C店TB WHERE (略) ) tmp ORDER BY ... 通常SQL Serverでこのように書くと、それぞれのベーステーブルに対して最大でTOP 100がかかるようにプランされるはずです。
レガシーADOのように結果セットを複数受け取れない場合には、「○行更新されました」というメッセージ自体を１つの結果セットとして先に受け取ってしまうため、後続の結果セットが受け取れない可能性があります。 少なくとも、私の読解力では「動的SQLの結果が無くなってしまいます」はそのように読めたということです。 いずれにしても、質問者さんのようにMSのサポート体制が微妙な組み合わせ(Access ADP 2003 & SQL Server 2008でしたよね）で開発をしていて、不明な現象をどうしても追求したい場合、少なくともトラブルシューティングのための検証ステップが３つは足らないと思います。 ・クエリアナライザでの単体検証 ・Access 2003(MDB)でデータソースのプロバイダを「SQLOLEDB(SQL Server)」にした環境 ・Access 2003(MDB)でデータソースのプロバイダを「SQLNCLI10(SQL Native Client 10.0)」にした環境 今の方法では、SQL Serverが悪いのか、データプロバイダが悪いのか、組み合わせが悪いのか、切り分けできませんよね。
＞[Microsoft][ODBC SQL Server Driver][TCP/IP Sockets]一般的なネットワーク エラーです 名前付きパイプを使用して接続するようにコンピュータを構成します。 MDAC ドライバを Web サイトからダウンロード TCP/IP ソケットの設定 詳細は参考URLをご覧ください。 「ODBC 接続が SQLState: '08001' DBMSSOCN で失敗する 」 参考URL：http://support.microsoft.com/kb/195566/ja
SQL Server プロファイラでサーバトレースを設定するしかないと思います。 プロファイラにはスクリプトをエクスポートする機能があるので、SQL:Stmt Completedのみを（Durationにしきい値を設定して）トレースし、 それをストアドプロシージャにしてSQL Serverエージェントのジョブに登録する（サービス起動時に起動）のですかね。 とりあえず試すときはトレースの止め方／消し方は把握してください。あと、サーバ負荷のチェックも忘れずに。 http://technet.microsoft.com/ja-jp/library/aa173 …(SQL.80).aspx
SSMSで「データベースエンジン」に接続し、「管理－レガシ－データ変換サービス」と辿っていくと、そのパッケージが表示されませんか？
リストアしたということは、もしかして以下の問題でしょうか？ http://www.microsoft.com/japan/sqlserver/2005/ss … リストアでログインのマッピングが切れるのはよくあるので注意が必要です。
SELECT * FROM TABLE1 WHERE KEY='A'とSELECT * FROM TABLE1 WHERE KEY='B'の２つのクエリについて、 sp_executesqlは、「SELECT * FROM TABLE1 WHERE KEY=@A」でパラメータが異なるもの、と認識し、実行時に過去に実行したクエリプランがキャッシュされていればそれを使います。 EXECでは全く別のクエリと認識されますので、毎回新しいクエリプランを作成します。 したがって、定型クエリを繰り返し実行するケースでsp_executesqlを利用すると、多少効果的です。 また、sp_executesqlでは実行した結果をTransact-SQLの変数に受け取ることもできますが、EXECではできません。 なお、adp上での両者の違いについては確認できませんでした（両方ともパラメータ入力を求めない） それにしても > exec ('select * from T_日報 where 日付=''' + @日付_sp + '''') は私的にはちょっと画期的でした。EXEC文だとdatetime型を単純に文字列連結してもエラーにならないんですね。
SQL ServerではUNIQUE制約をつけると自動的にインデックスが作られます。 その関係でSSMSでは「インデックス／キー」から作成します。
SELECT CASE WHEN B IS NULL THEN 'b' ELSE B END AS B FROM テーブルA でどうでしょうか
(SQL Server Reporting Service 2008は触った事ないので、ご参考まで) コンピュータの世界(?)では０で除算自体がなんだか悪なので それを避けるように設計をするのがスジです。 あとは決め事なんで、その要件にあわせて、なんかをします。 ブランクとしたり、エラーとするなり、割られる側も０ならば１としたりとかとか。。
SQL Server 2008 Management Studio を用いて SQL Server 2008 に接続する http://network.station.ez-net.jp/client/database … こちらなどを参考に「構成ツール」と「ファイアウォール」を設定してみるとどうでしょうか。
・SQL Serverのポート設定を確認する ・Windows Server 2003のファイヤーウォールにSQL Serverが使用するポートがあいているか確認する ・SQL Serverの外部接続が利用できる状態か確認する 　TCP/IPなどが有効になっているかなど
BCPユーティリティと、sqlcmdユーティリティによるOPENROWSETの違いを認識していただく必要があります。 BCPユーティリティによるINSERTはBCPを実行している端末で行われますが、OPENROWSETはそのクエリが実行されるサーバで行われます。そして、sqlcmdユーティリティは「指定したサーバでのSQL文実行を指示する」ものに過ぎないので、結局後者の方法はサーバにあるファイルを読むことが前提になっているのです。 もともと質問者さんが最初にBCPを使おうとしてできなかったときにも私が回答したのですが、フォーマット変換の難しいファイルを読み込もうとしていたので、SQL Serverがローカルにあることを確認した上で、より柔軟性の高いOPRNROWSETをお勧めしたということです。 前述の通り、本質的な違いがありますから、sqlcmdのローカルフォルダにあるファイルをそのまま指定したところで実現できません。どうしてもという場合は、ローカルフォルダを共有してサーバからアクセスさせる必要があります。 http://msdn.microsoft.com/ja-jp/library/ms175915 … ただし、そのような使い方（サーバからクライアントの共有フォルダにアクセスする）が想定されたものになるはずがありませんので、その場合はどうしてもBCPを使わなくてはならないでしょう（もしくはSSISか）。フォーマットの問題は一時テーブルを使うなどして回避するしかないと思います。
bcpにはヘッダーを指定する機能がないんですよ。 別にヘッダーファイルを用意して足してあげるしかないかもしれませんね。 それを自動でやるスクリプトを以前載せたことがあったのですが、ちょっとやりすぎの感もあるので、あえてここでは紹介しません。 （あとはSSISパッケージを使う方法になってしまうので、さすがに敷居が高いですかね）
おおっと確かにデータベースに保存するオプションは指定できないですね。 ファイルに吐いて、リアルタイムで照会するときはfn_trace_gettableを使うしかなさそうですね。 （ファイルの結果がテーブル形式で返るので、必要に応じてテーブルに入れるとか）
> 主キー設定をしないで投入したら問題なくできました。 重複を含むレコードがテーブル化できているのですから、 主キーをグループ化要素として、件数が１を越えるものを検索なさると良いでしょう。 クエリアナライザで実行できると思います。 SQL2005の書き方が不明なので、調整してください。(Oracleチックかも） 主キーの構成が不明ですが、仮に[伝票番号][枝番]の2項目で主キーなら select [伝票番号], [枝番], count(*) from [重複含むテーブル] group by [伝票番号], [枝番] having count(*) > 1 ;
SSMSから実行しているのなら、「既存のデータベースを上書きする」にチェックを入れてください
>クライアントソフトにも、無償版と有償版があったのですね。 SSMSEはSSMSに比べていろいろな制約がかかっています。 一番納得いかないのは「トリガを無効にする」ができないことです（Expressの制約と関係ないのに。。）
普通にJOINすればできますが、そもそも質問に書いてある結果はテーブル定義と矛盾しています。 子テーブルのaが複数のAに、孫テーブルのaaaが複数のaに紐づいていますし、aaaも主キーになっていません。 こういうデータを登録したいのであれば、子テーブル、孫テーブルは複合キーにしないといけないでしょう。
bcpとsqlcmdによるOPENROWSETの実行は別物です。 同じようなことはできますが、まずは区別して認識しましょう。 OPENROWSETは、ファイルをテーブルに見立ててSELECTする方法です。 だから書いているクエリも"INSERT INTO ～ SELECT ～"です。 列数の少ないテーブルAから列数の多いテーブルBにINSERTするとき、どうしていますか？ INSERT INTO テーブルA (列1,列2,列3,...,列10) SELECT 列1,列2,列3,....,列10 FROM テーブルB って書きますよね？ やっているのは全く同じことです。
EXEC msdb..sp_help_job @execution_status=1 を実行して、返ってきたもののname列をチェックするのが一番簡単ではないかと思います（current_execution_status=1は「実行中」）。
#2です。 やはりExpressでしたか。SQLプロファイラはExpressにはついていませんが、フリーのがあるので、ご参考までに。 少し遅いけど十分使えます。 http://www.atmarkit.co.jp/fdotnet/dotnettips/744 … それ以外の情報（動的管理ビューやは利用状況モニタ）は2005では使えます。
「階層問い合わせ」っぽい話ですね。 SQL Server2005だと「階層問い合わせ」はできるみたいです。 http://msdn.microsoft.com/ja-jp/library/ms175972 … >J. 複数のアンカー メンバと再帰メンバを使用する 設計的には「階層問い合わせ」を調べてみてください。 fatherがいるならmotherがいると思うので。 「階層問い合わせ」なら家系をさかのぼることも可能ですよ。
SQL Server 2008 Native Clientは、SQL Server 7以上のデータベースアクセスをサポートしているため、通常の使用には問題ないでしょう。 問題点は書かれた２点にすべて包含されていると思いますが、 ・最新版のSQL Serverの便利な機能が使えない ・もうすぐ延長サポートが終了する 後者については、「もうメインストリームサポートは終わっている」とも言えます。 （セキュリティパッチ以外の対応は行われないので、万一不都合な点が発見されたとしてもサポートされない。2005か2008にアップグレードを勧められるだけ）
ORDER BY (CASE WHEN 値段 < 100 THEN 1 ELSE 2 END) でどうでしょう。
ごめんなさい。いろいろ間違いてしまいました。。。 ローカルＰＣで軽く実験してみましたが、なんかできないっぽいですね。。。 すみませんでした。
SQLserver2005 での知識ですので、参考になるかわかりませんが、、、 サーバのプロパティのセキュリティのログインの監査で 失敗したログインを残すようにして そのＰＣからのログインを実施します。 サーバのログファイルの表示で、どのドメインの どのユーザでログインしようとしたか出てくると思いますので それから、調査していけば、わかるかもしれません。
結構有名な問題らしく、先日私もハマりました。 レジストリのHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\PendingFileRenameOperations このキーの名前を一時的に変更すると（PendingFileRenameOperations=>PendingFileRenameOperationsXなど）、インストールが続行できます。 終わったら忘れずに戻しておきましょう。
別のDBでも同じインスタンス内ならば同じです。 SELECT * INTO DB_B.dbo.顧客 FROM DB_A.dbo.顧客
質問の「mdfに変換する」という表現からは誤解している可能性もあるような気がしていますが、 SQL Server Management Studio Expressは2005ではなく、2008のものを入れましたか？ 2005のManagement Studio Expressにはデータのインポートがないので。
可能ですが、SQL Serverのたて方次第で方法は変わります。 ・１台のサーバにSQL Serverを１つだけインストールし、その中に全部のデータベースを作成する ・１台もしくは複数台のサーバにSQL Serverを複数インストールし、それぞれの中にデータベースを作成する どちらの方法で移行するかはシステム要件次第＆サーバの台数次第です。 １つのSQL Server内に全部のデータベースを作成すると管理は容易ですが、１つのSQL Serverにサービスはデータベースエンジンとしては１つなので、負荷も集中しますし、SQL Serverのサービスがダウンしたときには、すべてのシステムが利用不能になります。 それを避けなければならないニーズがあるときに複数のSQL Serverをインストールしてそれぞれで管理します。 サーバ１台に複数のSQL Serverをインストールすることもできますが、管理負担は増えますし、CPU・メモリはそれだけ余計に食います。 前者であれば話は簡単です。 サーバAにSQL Serverをインストールして、例えば「社員」データベースと「売上管理」データベースを作成したとすると、 「社員」データベースのアクセス権限さえ与えてやれば、「売上管理」データベースに対してSQLを投げるときに SELECT * FROM 社員.dbo.社員マスタ という形で参照できます。 後者の場合は、リンクサーバというものを設定します。 サーバAに「社員」データベース、サーバBに「売上管理」データベースがあるときに、サーバBに「サーバA」という名前でリンクサーバを設定しておけば、 SELECT * FROM [サーバA].社員.dbo.社員マスタ という形で参照できます。
重複したものを除く　という条件であれば、 SELECT * FROM テーブル 電話番号 in (SELECT 電話番号 FROM テーブル GROUP BY 電話番号 HAVING COUNT(*)<2) で、2レコード以上に存在する電話番号のレコードを除去できます。
プロバイダは外のデータとの受渡のインターフェースを提供するものです。 mdbにせよ、adpにせよ、直接SQL Serverのデータにアクセスできるわけではありません。 複数提供されているプロバイダのいずれかを使ってSQL Serverにアクセスして、データのやり取りをしているわけです。 SQL Serverの場合、一般的に使われているのが、 ・Microsoft OLE DB Provider for ODBC(MSDASQL) ・Microsoft OLE DB Provider for SQL Server(SQLOLEDB)　～最も一般的 ・Microsoft SQL Server Native Client(SQLNCLI)　　　　 ～SQL Server 2005対応 ・Microsoft SQL Server Native Client 10.0(SQLNCLI10)　～SQL Server 2008対応 ポイントは以下の２点だと思います。 ・DATE型はSQL Server 2008で登場したデータ型であり、それ以前には存在しなかったこと 　（したがって、それ以前に提供されているプロバイダはDATE型に対応していない 　　＝呼び出し元のアプリケーションで問題なく使えるような形で返すことを保証していない） ・MicrosoftのAccess開発チームは、SQL Server 2008に対応できる十分なインターフェースの提供をadpに関して行っていない 　（これはOffice2007でも同じ。内部的にはSQLOLEDB固定で使っていると思います） したがって、adpでDATE型を使うこと自体をやめた方がいいと私は思っています。 なお、smalldatetimeかdatetimeかについては、ストレージに余裕がなければsmalldatetime、それ以外ならdatetimeでいいと思います。 理由は以下の２点です。 ・datetime型の方が優先順位が高いから 　（datetime型とsmalldatetime型の間で演算をすると、smalldatetime型はdatetime型に暗黙変換されます) ・すべてのテーブルで共通して同じ型を使うようにしておいた方が開発上コントロールしやすいから ご参考までに。
#2です。 >とりあえずヒットした１件目のテーブルBのLENとDIVの値を取得することにしようと思っています。 俄かには信じがたい作り方ですが、とりあえずLENとDIVが入っていてもいなくても１件目でいいのですね？ SELECT a.A_NO, a.DAT_NO, a.B_NO, a.C_NO, a.D_NO, b.[LEN], b.DIV FROM テーブルA a LEFT OUTER JOIN (SELECT B_NO,C_NO,[LEN],DIV FROM テーブルB b1 WHERE C_DAT_NO IN (SELECT MIN(C_DAT_NO) FROM tableb WHERE B_NO=b1.B_NO AND C_NO=b1.C_NO) ) b ON b.B_NO=a.B_NO AND b.C_NO=a.C_NO 「LEN/DIVが入っているもののうちの１件目」であれば、サブクエリの中身に[LEN] IS NOT NULLなりを条件として追加すればよいですが。。
試しにこちらの適当なテーブルに索引をつけて検索してみました。 (1)WHERE COL1 IS NULL INDEX SEEKになりました (2)WHERE ISNULL(COL1,'') = '' INDEX SCANになりました INDEX SEEKなので(1)の方が効率がよさそうです。 ManagementStudioでSQL実行時に「実際の実行プランを含める」のオプションつきで実行してみてください。 でも、(2)は長さ0の空文字も対象にするから(1)と(2)は結果が変りますよね。このことを考慮してますか？ ※長さ0の文字列とNULLを区別するかどうかはDBによって異なります。
素人で、僕もわからないの回答になるかどうかわかりませんが、会社で勘定奉行を使っていますが、以前、同じようにSQLServer2005のサービスが起動しない状態になりました。 今も、時々起動しないときがあります。 ただ、回復させる事は出来ましたので、僕のやった手順を書いて見ます。 まず、「スタート」→「すべてのプログラム」→「SQLServer2005」→「構成ツール」→「SQLServer構成マネージャ」の順に開いて下さい。 そうすると、SQLServerConfigurationManaerと言うのが開きますから、その中で、状態が停止のプログラムが無いでしょうか？ もしあれば、そのプログラムをダブルクリックしたらプロパティが出てきますから、「開始」をクリックしたら、実行に状態が変わります。 それで、動かなかったプログラムが動きました。 良かったら、試してください。
ドメインとワークグループの変更は何回か行ったことがありますが、特に問題はありませんでした。 ただ、SQL Server へのログインを"コンピュータ名\インスタンス名"で行っている場合にはコンピュータ名が変わるとそのままではログインできなくなるので注意が必要です(コンピュータ名が変わらない場合や、.\インスタンス名や(local)などで自分自身に接続している場合は問題ありません)。 あとはサービスを起動しているアカウントがドメイン環境でも特に制限されていなkれば、問題ないと思います。
その必要最小限の使い方だけを目指している場合は、「with Advanced Services」ではなく「with Tools」を選ぶべきだったかも。。 （Reporting Serviceとかは今回の場合インストールのハードルを上げているだけのようなので） ところで、XP Home Editionで動くんでしたっけ？ システム要件 http://www.microsoft.com/japan/sqlserver/2008/pr … Local SystemやNetwork Serviceを指定して動けばいいのですが。。
C#で書いていた人ですか？ 改行コードは「\r\n」です。 hCommand.CommandText = "INSERT INTO table1 VALUES (1,'abc\r\ndef\r\nghi\r\njkl')"; あと、SQL Server Management Studioのデザイン画面では改行が入った文字列の登録はできないです。 クエリ画面で INSERT INTO table1 VALUES (1,'abc def ghi jkl') と実行すれば改行込みになります。
SQLServerはオープンソースではないので、どのような要求と応答が あるのかについて、開かれた資料が無いのでは？ 答えてくれないと思いますがメーカに直接問い合わせるしかない ような気がします。それと、組み込みでデータベースアクセスと いうのは荷が重過ぎると思いますけどね。 私が担当するとしたら、DBサーバにODBCを組み込み、こちらに独自の サーバプログラムを置いて対処するくらいしか思いつきません。 例えば、SQLを発行して、結果を受け取ることを考えるとします。 (1)クライアント→独自サーバプログラム：SQLの要求 　ここは自作プログラムなので、仕様は自由に決められます。 (2)独自サーバプログラム→SQLServerのサーバプログラム：SQLの要求 　ここはODBCを使う方法で処理します。 (3)SQLServer→独自サーバプログラム：結果応答 　ここもODBCを使う方法で処理します。 (4)クライアント→独自サーバプログラム：結果応答 　ここも自作プログラムなので、仕様は自由に決められます。 こういうのもダメなら、オープンソースのDBシステムにしてみては？
>なら、切断は >ビデオを入れたまま、電源を切った >と言うイメージでしょうか？ テレビの電源を切ったイメージですね。 テレビは電源入ってないけど、ビデオは動き続けている状態です。 で、再度テレビの電源を入れるとビデオをすぐに見られる。 テレビの電源を切るのが、オブジェクトエクスプローラーの切断。 テレビの電源を入れるのが、オブジェクトエクスプローラーの接続。 ビデオの電源を切るのがSQL Serverのインスタンス(サービス)を停止。 って感じかと。 却ってわかりにくくなっちゃったかも^^;
ソース自体に特に問題はないです。 DBConfiguration.DbConnectionStringの中身が問題でしょう。 書かれていないからそれ以上はわかりませんが。 「VS200xでC#を使ってSQL Server200xからデータを取得しようとしています。」というような一文を冒頭に書くようにしたほうがいいですね
参考になりますか、わかりませんが、、、 remote query timeout とか知ってます。 あと接続のタイムアウトも、ODBCの接続プールのタイムアウトとか。 あと、、、セッションタイムアウトとか。。。
これでよいですか？ SELECT p.PCID, p.SOFTID, p.VER, s.SOFTNAME FROM PC p INNER JOIN SOFT s ON s.SOFTID=p.SOFTID AND s.VER=p.VER
#1です。 そうですか、失礼しました。ADPでしたね。（質問者さんの名前を見ないで回答してしまいました） MDBの場合はODBC経由でプロバイダを指定できますから、問題ないと思ったのですが、ADPは接続時に使うプロバイダがSQLOLEDB(OLEDB Provider for SQL Server)に固定されていて、SQLNCLI10(SQL Server Native Client 10.0)を使わせることはできないのではないかと思います（別にVBAでADO接続を開けば別ですが）。 結局ADPではSQL Server 2005/2008の新機能を完全には使えないということになりますね。 今回は連結フォームということなので、今のままいくか、datetimeに変換したビューでも用意するしかないと思います。 >SQL Native Client はサーバーにインストールするのでしょうか、クライアントでしょうか? クライアントです。SQLNCLI10は通常SQL Server 2008をインストールするときに指定すれば一緒にインストールされるものなので、入れても影響があるとは思いませんが、でも上記の通りで入れても本件は解決しないと思います。
SQL ServerのExpress以外をインストールすると、デフォルトインスタンスのサービスはMSSQLSERVERになります。 ですから、今接続しようとしているのはデフォルトインスタンスでしょう。であれば、 sqlcmd -E -S localhost だけで接続できるはずです。 なお、質問者さんが書いている「インスタンス名」というのはインストールされているフォルダ名を指しているように思います。 ちなみにMSAS10.MSSQLSERVERはAnalysis Serviceのもので、データベースエンジンはMSSQL10.MSSQLSERVERというフォルダになります。
わたしは無料のCSE（Common SQL Environment）があります。 必要なら、連絡してください。
デフォルトインストールをしている場合ですと エクスプローラーで、 C:\Program Files\Microsoft SQL Server\90\Tools\Binn\VSShell\Common7\IDE\ssmsee.exe を開いてください。 もし無い場合は、バージョン差異なのでProgram Files配下のSQL Serverという単語がついているフォルダ内を上記パスを参考に探してみてください。
「リモート接続」の言葉の定義として「離れた場所」って意味です。 物理的に違うPCやサーバー間で通信を行って接続するのであれば、LAN内だろうとインターネット越しだろうとリモート接続といいますが、あえて言う言葉でもないです。 というのも、DBなどのサーバーに物理的に違うPCなどから接続するのは「ものすごく当たり前のこと」なため、わざわざ「リモート接続」とは言いませんけどね。 なにかしらの資料を書くために使うのであれば使っても良いと言葉だと思います。
使用しているSQL ServerのEditionはExpressでしょうか？ Expressですとデフォルト設定ではIP接続が無効になっています。 http://techpubs.borland.com/silk_gauntlet/SilkCe …
SQLの基本はすでに勉強されているということでしたら、下記の本がお勧めです。 達人に学ぶ SQL徹底指南書 http://www.amazon.co.jp/dp/4798115169 作者のミックさんは Codezine で連載をされていて、下記のURLで見ることが出来ます。この本はそれに加筆修正したものと言ってよいかと思います。 http://codezine.jp/author/252 チューニングに関することでしたら、まずRDBMSの仕組みを理解されると良いと思いますので、下記の本などがお勧めです。 RDBMS解剖学 http://www.amazon.co.jp/dp/4798108642
以下のようにやります。 SELECT * FROM テーブル名 WHERE 項目=" & ID & " AND MONTH(IN_DATE)=7 ORDER BY IN_DATE DESC SELECT * FROM テーブル名 WHERE 項目=" & ID & " AND DAY(IN_DATE)=12 ORDER BY IN_DATE DESC
Enterprise Managerを別に入手することができれば、MSDEは管理できます。SQL Server 2000の評価版をダウンロードしてEnterprise Managerをインストールする方法が以前はありましたが、今はSQL Server 2000はダウンロードできなくなったので、周りにCDが転がっていない限りは入手できません（MSDN/Technetサブスクリプションを購入していればまだダウンロードは可能）。 ちなみにSQL Server 2005用のSQL Server Management Studio ExpressでもMSDEは管理できます（除くSQL Server Agent)。
リストアするときにそのデータベースに接続しているセッションが残っていると、リストアがいつまで経っても0％のままなので、「おかしいな」と思うことは昔よくありました。 （実際には「排他アクセスを取得できませんでした」というメッセージが別ウィンドウで返ってきているのですが、気付きにくいんですよね） 今回のケースが同じものか、書かれている状況だけでは判断できませんが、クエリアナライザの接続も一つ残らず閉じて、それでリトライしてみることをお勧めします。
下記にサイトからの情報を転載します。 SQL Serverでは、ピリオドしか想定していないようです。 Oracleもそうだったと思います。 MySQLも・・・。 どちらかというと「!」のほうがイレギュラーになるんだと思います。 オブジェクト名としての識別子の使用 http://msdn.microsoft.com/ja-jp/library/ms187879 … サーバー名、データベース名、および所有者名は、オブジェクト名の修飾子です。 オブジェクトを参照するときに、サーバー、データベース、および所有者を指定する必要はありません。 修飾子の位置をピリオドで示せば、修飾子を省略できます。オブジェクト名の有効な形式には、次のものがあります。 server_name . database_name . schema_name . object_name server_name . database_name .. object_name server_name .. schema_name . object_name server_name ... object_name database_name . schema_name . object_name database_name .. object_name schema_name . object_name object_name
SQL Serverに関わるファイルの拡張子には次の３つがあります。 .mdf .ndf .ldf それぞれの役割は、 .mdfはプライマリファイル .ndfはセカンダリファイル .ldfはログファイル となります。 ここから、私が勝手に妄想してみると、 mdfはPrimary(もしくなMain？) Database File ndfはSecondary Database File ldfはLog Database File となりました。 はてさて、上のような意見はいかがでしょうか・・・。
もちろんできます。でないとデータベースの意味がありません。 Pc-2にSQL Serverは不要です。 目的が分かりませんが、ご自分の作成されるプログラムでも、AccessやExcel、その他各種のクライアントアプリケーションからつなげますのでお好きなものをどうぞ。
#1です。 幅の広いテーブルはSQL Server 2008からのテクノロジです。 http://msdn.microsoft.com/ja-jp/library/ms186986 … 殆どがNULLしか入らないことが分かっている列が多いケースで、サイズを小さくするために「スパース列」というものが使えるようになりましたが、そのスパース列をまとめた列セットを使用したテーブルが幅の広いテーブルということになります。 （よりXMLライクなテーブルって感じで、使い勝手は随分違います） 特殊なことをしない限りは幅の狭いテーブルということです。
メンテナンスプランが使えるようになったということは、DTExec.exeも使えるようになったということですよね。 であれば、メンテナンスプランを作成することにより、ジョブが作成されますので、そのプロパティのサブプランで「コマンドライン」を見ると、DTEXECのパラメータが書かれています。 たとえば以下のような。。 /SQL "Maintenance Plans\メンテナンスプラン名" /SERVER "サーバ" /CHECKPOINTING OFF /SET "\Package\Subplan_1.Disable";false /REPORTING E これの先頭に「DTEXEC 」をつけて実行すればよいです。
「MTB-L1の後ろは"a"であってはいけない」ならば、「MTB-L1の後ろは"-"でなくてはいけない」として検索条件を書くしかないと思います。 "SELECT * FROM TABLE1 WHERE A LIKE '" & HENSU & "-%'"
#1です。 もうSQL Server 2005以降を使うようになって久しいので、記憶があいまいです。。 ポートを変更したのであればポート指定するか(サーバ名\インスタンス名,ポート番号)、クライアントネットワークユーティリティで別名登録しないと接続できないんじゃなかったんでしたっけ？ クライアントネットワークユーティリティはcliconfg.exeでも起動するはずです。そこでTCP/IPでポート指定で別名登録、ってのは昔よくやりました。
こんにちは コンピューターには少々詳しい自身がある私にとっても、ＤＴＳというのは？？です。 お客様にとっては、もっと？？？？？？？？です。 一番いいのは、技術的なことは言わず「設定の変更に２時間かかります。その間システムは使えません」と、お客様が一番知りたい部分だけ説明しておくことだと思います。 お客様にとって重要なのは、技術的な内容ではなく、「いつ使えるようになるのか」です。 通常の作業くわえて、万一のトラブル対応の１時間くらいをプラスして「３時間程度システムが使えなくなります」と説明した方が伝わりやすいと思います。
うーん、そもそもやり方に問題がありますね。 バックアップというのは、通常BACKUPコマンドを使って実行し、バックアップファイルの拡張子はBAKになります。 戻すときはRESTOREコマンドを使って実行します。 質問者さんがやられたようにMDF/LDFのファイル自体をコピーする方法は一般的ではありません。 が、もしやるならば、「オフラインにする」のではなく、「データベースのデタッチ」を実行してデータベースを一旦切り離し、 それからコピーするのが正しい方法です。 （お勧めはしませんが、SQL Serverサービスを停止させてからコピーする方法もあります） データベースのステータスはシステムデータベースのmasterが管理しています。 データベースをオフラインにして、ファイルを差し替えたことにより、masterデータベースの把握している状態と齟齬が生じてしまったため、そのような状態になってしまったと考えられます。 そのデータベースをドロップするかデタッチして、改めてMDF/LDFをアタッチするしかないと思いますが、前にコピーしたMDF/LDFも同じ方法でとったものならば、わずかながらうまくいかないリスクはあります。 SQL Serverのバージョンは何ですか？Enterprise ManagerもしくはSQL Server Management Studioが使える状態ですか？ （バックアップ、リストア、デタッチ、アタッチはGUIでできるので）
#4です。 ああ。確かにここまで書いてて検証してないというのはあたまわるすぎですね＜私 失礼しました。 多分「ひとつでも式にNullがあるとすべてNullになる」というのを以前聞いてて、無条件にそれを信じ込んでいたせいだと思います。
バックアップ/リストアを使う？ http://a-tak.com/xoops/modules/bwiki/index.php?S …
セッション番号はSQLを実行するときの番号というよりも、SQL Serverとの間に確立されている接続の番号というふうに理解してください。 もちろん、SQL Serverにログインするたびに割り当てられるのですが、１ログイン１個割り当てられるわけではありません。 たとえば、SSMSを開いてクエリを実行したとすれば、左の方に「オブジェクトエクスプローラ」を表示するのに１つ、クエリ実行画面を１つ開くと１つ、という風に割り当てられていきます（それぞれ１セッション使っているわけです）。Accessでリンクテーブルなどを使ってアクセスすると、１つのリンクテーブルにアクセスするたびに１セッション割り当てられます。 上記以外にも、SQL Serverデータベースエンジン自体も常時もしくは定期的にSQL Serverとのセッションを使っています。 そのあたりの情報は「利用状況モニタ」もしくは「sys.dm_exec_sessions」というシステムビューで確認できます。
#1です。 そもそも目的はセッション情報の収集だけですか？ サンプルとしてログオントリガを使って「似たようなこと」をやる例をあげますが、もともとsys.sysprocesses（SQL Server 2005以降は動的管理ビューsys.dm_exec_sessionなどの利用が推奨されています）はリアルタイムの情報ですので、ログオンを検知してから動的管理ビューを参照するまでのコンマ秒以下のずれまでは保証の限りではありません。 CREATE TABLE [testdb].[dbo].[session_log]( [session_id] [smallint] NOT NULL, [login_time] [datetime] NOT NULL, [host_name] [nvarchar](128) NOT NULL, [program_name] [nvarchar](128) NOT NULL, [login_name] [nvarchar](128) NOT NULL ) GO CREATE TRIGGER [COLLECT_SESSION_INFO] ON ALL SERVER WITH EXECUTE AS 'sa' FOR LOGON AS BEGIN INSERT INTO testdb.dbo.session_log SELECT session_id, login_time, host_name, program_name, EVENTDATA().value('(/EVENT_INSTANCE/LoginName)[1]','nvarchar(128)') FROM sys.dm_exec_sessions WHERE session_id=EVENTDATA().value('(/EVENT_INSTANCE/SPID)[1]','int') END GO ※EXECUTE ASのついた処理を実行する方法は一番簡単なのはTRUSTWORTHYをONにすることですが、その辺も含めて何をやっているか理解して試してください（トリガでセッション情報を収集しようと考えるくらいですから、素人ではないとお見受けしますが）
SQL Serverに何で接続しようとしているのかわかりませんが、 http://www.silex.jp/support/faq/vsec0.html を参考に接続しようとしているソフトを例外設定に追加してみてはどうでしょうか？
ID Sort Name　　Price　Effective　Time 5　1　　りんご　110　　True　　　 2009/04/20 3　2　　ぶどう　150　　True　　　 2009/04/01 7　3　　なし　　90　　 True　　　 2009/04/25 4　4　　ばなな　80　　 True　　　 2009/04/01 が欲しいなら select * from テーブル as t1 where effective = true and not exists ( select 1 from テーブル as t2 where t1.name = t2.name and t1.time < t2.time ) ですが。 はずしていたらごめんなさい。
・CASE文を以下の通り変更してください。 > case when sc.scale is null then '文字' else '数字' end as タイプ CASE xxx WHEN の書式の場合、条件は「=」とみなされます。 フィールド=NULLはANSI標準では常にFalseです。 ・また、おそらくこのままでは正しくでません。 （floatやrealが数字とみなされない） 私が書いたらこうするだろうというのを参考までに書きます。 なお、SQL Server 2008をお使いならば、sysobjects/syscolumnsでなく、sys.objects/sys.columnsを使った方がよいです。 SQL Server 2005のときから次バージョンではsysobjectsなどはサポートされない可能性があると言われていますので、 さすがに次のバージョンではなくなっているかもしれませんので。 select sc.name as フィールド名, case when type_name(sc.user_type_id)='timestamp' then 'その他' when type_name(sc.user_type_id) like '%date%' then '日付' when type_name(sc.user_type_id) like '%time%' then '日付' when sc.precision<>0 then '数字' when sc.collation_name is not null then '文字' else 'その他' end as タイプ from sys.objects as so inner join sys.columns as sc on so.object_id=sc.object_id where so.type='V' and left(so.name,2)='K_' ・日付を判断する項目はなく、上記の通り判別するしかなさそうです。 　ただ、date,time,smalldatetime,datetime,datetime2,datetimeoffsetと全部拾えるでしょう。
SQL実行タスクに変数を割り当てる場合は、 ・Statementには 「DELETE FROM [tblTesttable] WHERE TIMEID=?」と指定します。 ・パラメータマッピングを指定します 変数名：User::valtimeを選択 方向：Input データ型：DATE パラメータ名：0 (たぶん、ここがミソ） パラメータサイズ：-1　（デフォルトのまま。SP2が当たってないとないかも） パラメータが複数ある場合は、パラメータ名を0,1,2..という風に増やします。 そうすると、パラメータが「?」に順番に割り当てられていきます。
一応、実SQLを載せておきます。 ※机上で書いてて合っているか不安になったので。 create table 表1 ( col1 char(1) ); create table 表2 ( col1 char(1) ); insert into 表1 values('A'); insert into 表1 values('B'); insert into 表1 values('C'); insert into 表2 values('C'); insert into 表2 values('D'); insert into 表2 values('E'); select a.col1,b.col1 from 表1 a inner join 表2 b on a.col1 = b.col1 order by 1,2; 表1 表2 ----- ----- C C select a.col1,b.col1 from 表1 a left outer join 表2 b on a.col1 = b.col1 order by 1,2; 表1 表2 ----- ----- A NULL B NULL C C select a.col1,b.col1 from 表1 a right outer join 表2 b on a.col1 = b.col1 order by 1,2; 表1 表2 ----- ----- C C NULL D NULL E select a.col1,b.col1 from 表1 a full outer join 表2 b on a.col1 = b.col1 order by 1,2; 表1 表2 ----- ----- A NULL B NULL C C NULL D NULL E
インデックス付きビューの作成 http://technet.microsoft.com/ja-jp/library/ms191 …(SQL.90).aspx 上記の「必要条件」を参照してください。
ひょっとして リンクテーブルのキー設定が間違っていませんか？
サーバーにSQL Server 2005をインストールして、クライアントにはSQL Server Native Clientをインストールすれば、クライアントからアクセスはできます(あまり特殊なことを行わなければ、OS標準のSQL Serve ODBCドライバでもアクセスできます)。 クライアントからManagement Studioでデータベースの管理も行う必要があれば、クライアントにManagement Studioをインストールする必要があります。 SQL Server Native Client は製品版にも含まれていますが、こちらからダウンロードもできます。 http://www.microsoft.com/downloads/details.aspx? …
SQL> select * from test; 　　　ID1　　　　ID2　　　XXX ---------- ---------- ---------- 　　　　1　　　　　1　　　　100 　　　　1　　　　　2　　　　200 　　　　1　　　　　3　　　　150 　　　　2　　　　　1　　　 1000 　　　　2　　　　　2　　　　500 　　　　3　　　　　1　　　　 50 　　　　3　　　　　2　　　　100 7行が選択されました。 SQL> select ID1 　2　　　　,max(ID2) as ID2 　3　　　　,max(XXX)keep(dense_rank Last order by ID2) as XXX 　4　　from test 　5　 group by ID1; 　　　　ID1　　　　ID2　　　　XXX ---------- ---------- ---------- 　　　　 1　　　　　3 　　　　150 　　　　 2　　　　　2 　　　　500 　　　　 3　　　　　2 　　　　100 SQL>
使用しているログインが両データベースのテーブルを参照可能なことが条件です。なければ割り当ててください。 そして以下のように指定すればSCからCMのオブジェクトが参照できます。 select * from SC.dbo.AAA; select * from CM.dbo.BBB; また、上記のようにDB名まで指定したくない場合は、シノニムを作成します。 > 中から列名の店コードが違う物だけ抽出したいです。 これは以下の質問を参考にしてください。 http://oshiete1.goo.ne.jp/qa5007701.html
直接質問されている2点への回答ではないのですが、 DBの容量が膨らんでいるのは インデックスと言うよりは、トランザクションログが膨らんでるような気がします。 バックアップモードがどうなっているのか、バックアップを定期的に行っているのかでトランザクションログの状況が変わります。
#1です。老婆心ながら。。 ・こういうテーブルを作成する場合は、どちらかというとtempdbに作成した方がいいです。 　おそらく今のデータベースはオンライン更新の掛る業務DBなので、復旧モードがフルになっているはずです。 　したがって、バルクのデータ処理を繰り返し実行すると、トランザクションログが膨らみます。 ・前にも書きましたが、動的SQLを使う場合は、どういう方法でもいいのでパラメータは検証してください。 　今回のケースで、パラメータを検証しないと、 　@テーブル varchar (50),@フィールド varchar (max)というパラメータに 　 EXEC ストアド1 'テーブル1; DROP TABLE テーブル1--','*' EXEC ストアド1 'テーブル1','* FROM 見てほしくないテーブル--' 　という渡し方もできてしまいます。 　このストアドの存在を実行できる人は基本的に何でもできることになりますから、セキュリティ上好ましくないです。 　イントラだからいいだろうと思わないで検証する習慣にした方がおすすめです。 　（アプリケーションとデータベースは別物なので、データベースにしてみれば自分の身は自分で守らないといけません） ・ストアドの先頭に"SET NOCOUNT ON"を切るのも習慣にした方がいいです。 　場合によってはデータセットが受け取れないかもしれません。
SQL Server構成マネージャを立ち上げる ネットワークの構成でTCP/IPが有効に成っているか確認する Windows FirewllがTCP1433を通すか確認する(とりあえず無効でも良いかも) ウィルス対策ソフトが妨げていないかの確認のため一時的に無効にして確認する 　※自己責任で。。
#2です。 >おっしゃっていることをまとめてみたのですが↓であっていますでしょうか？ >・新設されたvarchar(max) 型などのLOBは1列ごとに16バイト、1行で最大500バイトまでのポインタを保持する >・従来のままの型で1行で8Kを超える場合1行全体で24バイトのポインタを保持する ・新設されたvarchar(max) 型などのLOBは1列ごとに16バイトのポインタを保持するが、先頭部分をデータエリア内に保持するというオプションを指定すると、最大500バイトまでの部分は8Kのデータページに保持される ・従来のままの型で1行で8Kを超える場合、超えたとSQL Serverが判断した時点で超えた列について、１列につき24バイトのポインタを保持させ、超えた部分を行オーバフローページに押し出す ということかと思います。 この辺は「Inside SQL Server 2005 ストレージエンジン編」という本にくわしく書かれていますよ。
こんな感じですかね。 select * from テーブルA where not exists ( select * from テーブルB where テーブルB.名前 = テーブルA.名前 and テーブルB.番号 = テーブルA.番号 ) 参考URLのサイトは、SQLServerでは無いですが、基本的なクエリを 知るのには良いと思いますよ。 参考URL：http://homepage2.nifty.com/sak/w_sak3/doc/sysbrd …
そうですか、ユーザの便宜のためのテーブルなわけですね。 SQL Server 2008でしたね。。 テーブルレイアウトがわからないので、以下でサンプルを書きますので、適当に加工してください。 CREATE TABLE テーブルレイアウト ([テーブル名][sysname],[フィールド名][sysname],[定義体名][nvarchar](50)) DECLARE @tablename sysname='テーブル1' DECLARE @name nvarchar(50)='定義体1' MERGE テーブルレイアウト t1 USING (SELECT NAME FROM sys.columns WHERE OBJECT_ID=OBJECT_ID(@tablename)) c ON t1.テーブル名=@tablename AND t1.定義体名=@name AND c.NAME=t1.フィールド名 WHEN NOT MATCHED THEN INSERT VALUES (@tablename,c.NAME,@name) WHEN NOT MATCHED BY SOURCE AND t1.テーブル名=@tablename AND t1.定義体名=@name THEN DELETE;
インストール場所はデフォルトの場所でしょうか？ どこか別の箇所でしょうか？ うろ覚えなんですが以前、デフォルト以外のドライブにインストールすると英語表記になるというバグを聞いたことがあります。
これでどうですか select* fromマスターテーブル where not exists ( select * from 店コードテーブル where 店コードテーブル.店コード = マスターテーブル.店コード ) or not exists ( select * from 地域テーブル where 地域テーブル.店地域 = マスターテーブル.店地域 )
>下記の様に列側に持たせようと思っているのですが・・・ これはいけません。正規化の原則以前に使いづらいですよ。 あとで「赤が選べる靴はどれか」「４色以上選べる靴はどれか」「色別の注文状況が見たい」って聞かれたときに死にます。 （OR文やUNIONの嵐になります） 外部制約も掛けられません。 1)「組み合わせマスタ保守」ではなく、「色組み合わせマスタ保守」と「素材組み合わせマスタ保守」を用意する 　・色組み合わせマスタ保守（靴、色） 　・素材組み合わせマスタ保守（靴、素材） 　それぞれ、靴マスタと色マスタ、靴マスタと素材マスタに対する外部キー制約を掛けます。 2)「組み合わせマスタ保守」を以下のレイアウトにする 　・組み合わせマスタ保守（靴、区分、連番、色、素材） 　靴、色、素材にそれぞれ外部キー制約を掛けます。 　色と素材のいずれかしか収録されないので、主キーがなくなり、代替キー（連番）を振って靴・区分・連番で主キーにします。 　テーブルは１つで済みますが、NOT NULL制約も掛けられず、検索・更新効率は悪くなります。 普通は1)の考え方です。 横並びの情報がパッとみたいのであれば、別途CASE、MAXを使ったビューを作成すればよいと思います。
http://msdn.microsoft.com/ja-jp/ms172984.aspx http://msdn.microsoft.com/ja-jp/ms172432.aspx http://technet.microsoft.com/ja-jp/ms191426.aspx 簡潔にまとまった内容ではないのですが、いくつかの作法が紹介されています。 結合は5つ以下に・・・など。
sqlserverの接続例です。 http://www37.atwiki.jp/kuronekosoft/pages/14.html デモです。 http://kuronekosoft.nobody.jp/tutorial/s_tutoria … 黒猫　Studio　はSELECT文を作る必要がありますから、ちょっと敷居が 高いですかね。
ALTER TABLE #worktable ADD PRIMARY KEY CLUSTERED ([sysdate]) でいけるとおもいますが。
テーブル名は[3ABC]のようにカギカッコで括ってみてください。
基本的にはファイアーウォールしかないのですが、どうしてもというならば、SQL Server 2005以降であれば ログオントリガを使う手はあります。DDLトリガをログオンに対してサーバレベルで設定し、IPを調べて接続を許可するかどうかチェックします。 簡単なサンプルは以下の通り。 CREATE TRIGGER [DENY_IP] ON ALL SERVER WITH EXECUTE AS 'sa' FOR LOGON AS BEGIN DECLARE @IP nvarchar(20) SELECT @IP=EVENTDATA().value('(/EVENT_INSTANCE/ClientHost)[1]','nvarchar(20)') IF ISNUMERIC(REPLACE(@IP,'.',''))=1 AND @IP<>'xxx.xxx.xxx.xxx' ROLLBACK END 詳細はリンクをご覧ください。 参考URL：http://technet.microsoft.com/ja-jp/library/ms189 …(SQL.90).aspx
#1さんのであっていますが、もしそのデータベースでデータベースダイアグラムを使っている場合は、 以下のように条件を追加してください。 select type,name from sys.objects where type IN ('P','TR') and is_ms_shipped=0 and object_id not in (select major_id from sys.extended_properties where minor_id=0 and class=1 and name=N'microsoft_database_tools_support') order by type,name
接続文字列の編集ミスだと思いますが・・・。 本番用が間違っていないか確認してみてはどうでしょうか。
2008 なので同じじゃないかもしれませんが、 Management Studio にてテーブルを右クリックし、[上位 200行の編集] で開いた場合にはクエリデザイナのツールバーが使えますね。 他には、、、 テーブルを右クリックし、[テーブルをスクリプト化] から UPDATE や INSERT を選択できますね。
バッチ処理で１行ずつINSERTするのはさすがにナンセンスでしょう。 ・ログファイルはどこにあるのですか？ ・SQL Serverのエディションは？ サーバにあるなら、BCPユーティリティ、SSIS、xp_cmdshell＋BULK INSERTのいずれか ローカルにあるなら、BCPユーティリティかSSIS で実行するのがよいと思います（SSISはStandard以上です）。 SSISはBIDS(VB2008のBusiness Inteligence Development Studio)でグラフィカルに作れますが、プログラミング志向ならばそれ以外の方法も取れます。 あとはサーバ管理者の意見も聞いてみるのがいいでしょう。 （SSISがインストールされていないならインストールする必要があるし、xp_cmdshellは少しセキュリティを緩める必要がありますので）
これは、動的SQLを実行するためのsp_executesqlというシステムストアドプロシージャを使う場合にはよく見かけます。 動的SQLの場合、 SET @F1 = 1 SET @F2 = 2 SET @sql = N"SELECT * FROM TABLE1 WHERE F1="+CONVERT(varchar,@F1)+' AND F2='+CONVERT(varchar,@F2) EXEC sp_executesql @sql というように都度実行するSQL文を組み上げる方法でも構わないのですが、変数部分をパラメータとして渡すことができます。 SET @F1 = 1 SET @F2 = 2 SET @sql = N"SELECT * FROM TABLE1 WHERE F1=@P1 AND F2=@P2" SET @parm = N"@P1 int,@P2 int" EXEC sp_executesql @sql,@parm,@F1,@F2 この方法のメリットはSQL Serverのクエリ実行を解析するオプティマイザが過去に実行して、キャッシュに保管されている実行プランを再利用してくれることです。 つまり、上記処理を繰り返し行うときに、一度実行した"SELECT * FROM TABLE1 WHERE F1=? AND F2=?"という内容のクエリについては、そのときに立てたプランを探してそれを使ってくれるということです。 （実行のたびプランを作成しないため、パフォーマンスがよくなる）。
確かにそのような技術情報はでていませんが、全く同じ条件でSP2では動くならばバグの可能性は高いと思います。 SP2では、SSISのバグはかなりたくさんFixされているからです。 >http://support.microsoft.com/kb/921896/ja （ちなみに私はSP1はスキップしました） そのエラーが発生した場合、解決できている例も見当たらなかったので、できればSP2をあてた方がいいのかも、しれません。
DTSはSSISとは違って、コンテナもないし、Or条件で後続を指定することもできないので、通常はデータフローのActiveX設定で「実行しない」にするなどでステップをスキップしようとすると、後続の処理も実行されないで終わってしまいます。 したがって、前提後続を維持したままでどうしてもスキップを実装したい場合は以下のようにします。 1)１つ目のファイル取込の前にActiveXスクリプトタスクを置き、以下の処理を記述する Function Main() 　Set fso = CreateObject("Scripting.FileSystemObject") 　Set f = fso.OpenTextFile("対象ファイル") 　If f.AtEndOfStream Then 　　Set oPkg = DTSGlobalVariables.Parent 　　oPkg.Steps("１つ目のファイル取込のステップ名").ExecutionStatus=DTSStepExecStat_Completed 　End If 　f.Close 　Set f = Nothing 　Main = DTSTaskExecResult_Success End Function 2)２つ目のファイル取込との間のワークフローを「成功」ではなく「完了」にする 見ての通りで、ファイルが空かどうか調べ、空の場合はファイル取込のステータスを先に「完了」に変更してしまいます。 （「成功」にしようとするとうまくいかない可能性があるので、上記でお勧めしておきます）
そういえばSSIS関連の書籍って殆ど見かけませんね。 翻って自分はどうやってSSISが使えるようになったのか、と考えると、 ・SQL Server 2005のSSIS自習書（応用編までやると意外と侮れないです） http://msdn.microsoft.com/ja-jp/sqlserver/cc7206 … http://technet.microsoft.com/ja-jp/sqlserver/cc7 … ・MSDN ・MCITP(Database Developer)の試験対策本（洋書） http://www.amazon.co.jp/MCITP-Developer-Microsof … ・SSISの解説書（洋書：これは全部は読まず。。） http://www.amazon.co.jp/Professional-ServerTM-In … 感覚が身についてくれば、MSDNを見ながら実際に試してみれば、大抵の問題は解決しますね。 ・・そんな感じじゃないでしょうか
>TOP 100 を 99.9999….としますと、自動的に100と変更されてしまいます。 9が多すぎたようです。 TOP xx PERCENTは、クエリのプロパティのビュータブに指定欄がありますね。TOP 99.99999999999999999999999999999999 PERCENTであれば、こちらで試した限りは効きました。
このような考え大丈夫でしょうか？ SELECT * FROM マスターテーブル AS M INNER JOIN 店コードテーブル AS S ON M.店コード = S.店コード 店コードが一致するレコードを抽出しているのですね。 はい、大丈夫です。 もっとも単純に、分かりやすい式を書くのであれば この条件否定なので left outer join で結合して、結合できなかったデータ、 つまり、店がNullのデータを取れば抽出できます。 SELECT * FROM マスターテーブル AS M left outer join 店コードテーブル AS S ON M.店コード = S.店コード where S.店コード is null または、 SELECT * FROM マスターテーブル as M where M.店コード not in （　select 店コード from 店コードテーブル) 等でいけるでしょう。 ただ、参考URLにもありますように、 is　null　とか not in は遅いです。（Indexで見れなくなるので） 大量データを扱うような場合や、速度が求められるような場合は 別途クエリを検討しましょう。 参考URL：http://www.geocities.jp/mickindex/database/db_op …
#2です。 WITHはCTE(共通テーブル式)と言って、SQL2005から使えるようになりました。同じ記述が複数登場するようなケースで先頭に宣言します。 このCTEは一時テーブルではなく、tempdbに実体が作られるわけではありません。 （もちろん分析関数を使った時点で処理中にtempdbを使うのは避けられないわけですが） ＞1000万件ではなく７億万件という笑えない大きさです。 これは後出しじゃんけんみたいなものですね。 結局LAGはなくても、LAGと同じ機能のものお望みということですよね。 であれば、SQL Serverにはありません。 たぶん、一時テーブルを使わない方法では先に書いた方法以外はないと思います。 正直知恵を絞る場所はLAGの代わりを探すことではなくて、７億件を一気に処理させないで済む方法を考えることだと思わなくはないです。
test1 向けと test2 向けの 2種類を作っておけばいいのでは？
ちょっと言葉足らずでした。 SQL ServerのエラーもWindowsのイベントログに記録されることがあるのです。 Vistaですと、コントロールパネル→管理ツール→イベントビュアー イベントビュアーの(確か)アプリケーションに記録されるかと思います。
SQL Server Compact Editionのデータファイルです。 通常のSQL Serverのmdfにあたりますね。
バージョン不一致のような気がしますね。 （そのPCには最初から管理者権限でログインしてやっていますよね？） やはり最初からSQL Server Express 2008 With Toolsをインストールした方がよかったかなぁ。 とりあえず、インストールしたSSMSEでクエリは実行できますか？ 上にある「新しいクエリ」押すと、画面右側にクエリを打てる画面がでますから、以下を貼って、「！実行(X)」で実行してください。 （オブジェクト一覧を表示するクエリ） USE master GO SELECT * FROM sys.objects GO 何か結果が返ってくれば、今度は以下を貼って、データベース名とMDF/LDFのフルパスのところを書きかえ、実行してください。 （データベースをアタッチするクエリ） USE [master] GO CREATE DATABASE [データベース名] ON ( FILENAME = N'C:\MDFのフルパス\xxx.mdf' ), ( FILENAME = N'C:\LDFのフルパス\xxx.ldf' ) FOR ATTACH GO どうなりますか？
>UNIX上で、データベースを使ってweb掲示板を作っています。 ここは SQL Server のカテですが、Microsoft SQL Server にUnix版はありません。 お使いのデータベースは本当にSQL Server でしょうか？だとすると、Unix版の Sybase SQL Server ？ それとも他のデータベースですか？ >データが登録されている表から条件に合うような行を削除したいんですが、できなくて困っています。 どうできないのでしょうか？ 実行時にエラーが出るのか、方法がまったくわからないのか。 また、「ただ単に削除したい」のか「Webアプリから削除を行いたい」のかについても質問からは読み取れません。 もし後者だとしたら、プログラム言語は何でしょうか？ 以上、補足願います。
下記の書き方だと、UPDATE句が参照可能なのはKSK011のみです。 WHERE句の IN内にサブクエリで書かれても「KSJ01」はメインで参照はできません。あくまでWHERE条件として使われます。 > UPDATE KSK011 > SET KSK011.ZZAI = KSJ01.ZAIK >WHERE KSK011.HINB IN >(SELECT KSK011.HINB FROM(KSK011) > INNER JOIN KSJ01 ON KSK011.HINB = KSJ01.HINB); 上記をわかりやすくSELECT句で表現すると以下となります。 select xxx.colx1,zzz.colz1 from xxx inner join zzz on zzz.colz1 = xxx.colx1 where xxx.colx1 in (select coly1 from yyy) メインのSELECT句が参照できるのはFROM句で指定されたxxxと ジョインしているzzzだけです。 yyyはin句の評価でしか使われません。 FROM句に入れていないのでSELECT候補ではありません。 FROM内にないものは参照できないと考えてください。 UPDATE文を考える時もSELECT文を考えてから置き換えたほうがわかりやすいです。SELECTできなければUPDATEもできません。
1)[Browse]をクリックして、任意のフォルダ(他のお二方が回答されていることを参考に。。)を選択してください。 2)[Unzip]をクリックしてください。 これで駄目な場合は、各ボタンをクリックしたらどうなるかを教えてください。エラーが出るのか、うんともすんとも言わないなど。。
SQL Server 2005以降ならば、以下の通りです。 SELECT t1.A,t2.A FROM (SELECT ROW_NUMBER() OVER (PARTITION BY A ORDER BY A) SEQ,* FROM テーブル1 WHERE A<=3) t1 FULL OUTER JOIN (SELECT ROW_NUMBER() OVER (PARTITION BY A ORDER BY A) SEQ,* FROM テーブル2 WHERE A<=3) t2 ON t2.A=t1.A AND t2.SEQ=t1.SEQ
#1です。 >ところで、10CAL付とされたのはどういう理由でしょうか？ ExpressやDeveloperもCALの費用が発生するのでしょうか？ Standardをパッケージで買うと勝手に10CALついてくるから、そう書いたまでです。 Developer/ExpressはCALは不要です。
そのテーブルには主キーが設定されていますか？ ないとAccessからは更新不可になりますが。
補足です。 >ちなみに調べてみたのですがxp_cmdshellは2005からの機能みたいで、2000上では使えないようですね。 そんなことはありません。SQL Server 2000でも使えます。 http://msdn.microsoft.com/ja-jp/library/aa260689(SQL.80).aspx むしろ、このストアドはテクノロジとしては古いです。 （xpはSQL Server 2000時代の拡張ストアドプロシージャのプレフィックスです。SQL Server 2005ではCLRが推奨されています）
このあたりを読んでACCESSとの違いを理解しましょう。 http://www.microsoft.com/japan/solutions/lob/sce … SQL Serverはファイル単体で動くものではありません。 データファイルとしてファイル自体は存在しますが、SQL Serverのサービスが管理しているので、データファイルを勝手に移動させると データベースが壊れます。 共有フォルダに置くという概念が、全く別のことだと理解してください。 例えば、C:\Program Files\Microsoft Officeを共有フォルダにコピーしても、他のマシンからはオフィス製品を動かすことは出来ませんよね。そのレベルの話だと思ってください。 SQL Serverをインストールしたマシン上でデータを管理し、 他のマシンに対して提供するのが役割です。データはあくまで、SQL Serverの動いているマシン上に存在できません。 なので、このマシンにセキュリティをかけていくのが基本です。 そのうえで、やりたいことと折り合いをつけてください。
(3) がよくないのでは内科と思います。 移行元と移行先のPCでマスターキーが変更されたためと思います。 #1 の方のいう方法での移行でいいと思います。
SQL の方言や機能の違いについてでしょうか？ "SQL ポケット リファレンス" という本があります。 http://www.amazon.co.jp/%E6%94%B9%E8%A8%82%E6%96 … たしか逆引きリファレンスで、SQL の構文等が各種 DB ごとに記載してあったと思います。
>で質問の内容としてはSQL Server2005をインストールした時に >初めからある「sqlexpress」に接続せずに >新しい接続先でDB等を作りたいです。 インスタンスを分けたいということでしょうか。 ※接続先 = インスタンス と解釈します。 その場合はインストーラーから新しいインスタンスを作成します。 その際に「名前付きインスタンス」を選択して、任意の名前をつければ、「sqlexpress」とは別のインスタンスを作成可能です。 http://msdn.microsoft.com/ja-jp/library/ms143531(SQL.90).aspx http://msdn.microsoft.com/ja-jp/library/ms143744 … あと、SQL Serverの用語は覚えておいた方が良いですよ。
ここはSQL Serverのカテゴリーですが…… 以下のようにフォーマット指定してあげれば良いです。 文字列 column カラム名 format a20 数値 column カラム名 format 00000 詳しくは以下URLを参考にしてください。 http://www.shift-the-oracle.com/sqlplus/command/ …
#1です。 >ExcelのVBAを使ったことないんですが、Excelのマクロにこの例を貼り付けて、実行したら出来るということですか？ >実行してみると、「プロシージャの外では無効です」と表示されます。 Visual Studioがあるなら、別に無理してExcel使う必要はないですけど。 エラーの件は参照設定かなぁ。 VBScriptでも同じ結果になりますか？ （As以下をコメントにする以外は同じです） Dim strPath 'As String Dim cat 'As New ADOX.Catalog Dim strConnect 'As String strPath = "C:\test.mdb" '作成するmdbのフルパス strConnect = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & strPath & ";Jet OLEDB:Engine Type=5;" Set cat = CreateObject("ADOX.Catalog") cat.Create strConnect >Visual Studio でテーブルって追加できますか？ それようにわざわざコードを書けばできますけど、それよりは、回答に書いたようなツールを使った方が早いと思います。 今、検索して発見しましたが、これなら、mdbの生成とテーブルの追加と両方できますよ。 ↓ http://www.asahi-net.or.jp/~ef2o-inue/download/s …
多分、この質問と同じですよね。 http://oshiete1.goo.ne.jp/qa4966123.html クエリ1.sqlは、データベースのオブジェクトとしてではなく、単にテキストファイルとして保存されているので、Access からはリンクできません。 多分、やりたい事は、そのクエリをそのまま Access から実行、と言う事でしょうから、解としては、そのファイルを開いてクエリをコピーして、Access のパススルークエリを作成して、ペーストです。
正直回答に自信はありませんが、わかる範囲でお答えします。 復旧モデルはなんでしょうか？話を聞いている限り、フルですか？ また、トランザクションログの切り捨てと圧縮をした方がよさそうです。また、切り捨てがされないとのことですが、恐らくアクティブなログファイルがあると切り捨て対象にならないので、それかもしれませんね。 http://msdn.microsoft.com/ja-jp/library/ms178037 … をご覧の上、アクティブログがあるか確認してみてください。 （アクティブログがあると、いくら圧縮かけても無駄なので） また、切り捨てと圧縮の方法については、 http://techbank.jp/sqlserver/#a2 http://techbank.jp/Community/forums/p/1119/6132. … あたりを参考にして頂ければと思います。 ＞2分に1回ほどの割合 これについては、復旧モデルをフル(完全復旧）以外のものにすれば変わるかもしれませんが確証はありません。 http://msdn.microsoft.com/ja-jp/library/aa173678(SQL.80).aspx 1時間に1回、バックアップを自動的に戻すようなことをしなければ、 復旧モデルは、完全復旧でなくても良いような気がするので、 ご検討ください。
デバッグモードと本番環境とでは違うことを認識すべきです。 本番環境の設定が必要だと思いますね 参考)ＤＢ（SQLserver）の書込みが出来ないのですが http://ap.atmarkit.co.jp/bbs/core/fdotnet/10909
他のは調べられて、これだけわからないというのも不思議な気がしますが、とりあえず順番に書いておきます。 select d.name, suser_sname(d.owner_sid), d.is_date_correlation_on, round(m.size * CONVERT(float,8) / CONVERT(float,1024),0), d.is_auto_shrink_on, d.is_auto_close_on, d.is_auto_create_stats_on, d.is_auto_update_stats_on, d.is_auto_update_stats_async_on, case d.page_verify_option when 0 then 'NONE' when 1 then 'TORN_PAGE_DETECTION' when 2 then 'CHECKSUM' end from sys.databases d inner join sys.master_files m on m.database_id=d.database_id and file_id=1
状況確認です。 1)SQL Server Management Studioで「新しいクエリ」をクリックして開いた「クエリエディター」にクエリを入力する。 2)クエリを名前をつけて保存する。 この状況では、オブジェクトエクスプローラから見ることはできません。オブジェクトエクスプローラーに表示されるのは、基本的にSQL Serverの支配下にあるものです。 先ほど保存したSQLはSQL Serverに保存したのではなく普通にテキストファイルを拡張子sqlで保存しただけのものです。ですので、保存したSQLは動かしたり削除ができます。 と言う状況で、何をしたいのでしょうか？ ・別の日に、SQL Server Management Studioを立ち上げて、保存しておいたクエリをクエリエディターに表示させたい？ →[ファイル]→[開く]→[ファイル]でSQLを選択。 何をやりたいからSQLを選択したいのかを記載していただけると、より具体的な回答を他の方もしやすいかと思います。
#1です。 とりあえずリンクサーバが使えたのであれば、よかったです。 >しかしデータを読んでいるだけで保存はされていないので、後はテーブルを作ってコピーするSQL文を追加すればよいのでしょうか？ その通りです。データは入れ替えでよければ、テーブルを作っておいて、 TRUNCATE TABLE テーブル; INSERT INTO テーブル SELECT * FROM ACC...テーブル; を実行させればOKです。 Standardということなので、SQL Server Agentが使えます。 タスクを新規登録して、上記の２つのコマンドを打ち込み、スケジュールを指定すれば自動実行されます。 詳細はリンクなど、MSDNを参考にしてください。 サーバはSQL Server 2000だそうですが、通常の作業には全く問題ないです。ただ、タスクの登録までSSMSでできるかは試したことがないので、わかりません。 うまく登録できないようなら、サーバにログインしてEnterprise Managerを開き、そこで設定した方がいいかもしれませんね。 参考URL：http://msdn.microsoft.com/ja-jp/library/ms189237(SQL.90).aspx
他の皆さんが指摘しているように予約語です。 予約語は以下のものがありますので、注意して作成しましょう。 http://msdn.microsoft.com/ja-jp/library/ms189822 … http://msdn.microsoft.com/ja-jp/library/ms189822(SQL.90).aspx
なんとなく誤解があるんだろうなぁと思っていましたが。。 LEFT OUTER JOINの結果のNULLとレコード自体のNULLには何の違いもありません。NULLはNULLです。 以下で確認してください。質問者さんの考え方では、以下でもKEYID=2のレコードが抽出されることに なりますが、実際には抽出されません。 DECLARE @TBLA TABLE ([KEYID][int],[F1][varchar](5)) DECLARE @TBLB TABLE ([KEYID][int],[F2][varchar](5)) INSERT INTO @TBLA VALUES (1,'X') INSERT INTO @TBLA VALUES (2,'Y') INSERT INTO @TBLA VALUES (3,'Z') INSERT INTO @TBLB VALUES (1,'ABC') INSERT INTO @TBLB VALUES (3,'BCD') SELECT a.KEYID,a.F1,b.F2 FROM @TBLA a LEFT OUTER JOIN @TBLB b ON b.KEYID=a.KEYID WHERE b.F2='ABC'
>CASE WHEN [GCODE] = 0 THEN [CHIBAN] ELSE [GCODE] END 上記のCASE文の[GCODE]が数値型のようなので暗黙の型変換が行われているのでしょう。 なので、[CHIBAN]内に文字列が入っていて変換できないのでしょう。 戻り値の型 http://msdn.microsoft.com/ja-jp/library/ms181765 … >result_expressions およびオプションの else_result_expression の型のセットの中から、最も優先順位の高い型を返します。詳細については、「データ型の優先順位 (Transact-SQL)」を参照してください。 データ型の優先順位 http://msdn.microsoft.com/ja-jp/library/ms190309 … CASTで文字列に明示的に変換すればよいでしょう。 http://msdn.microsoft.com/ja-jp/library/ms187928 … データ [GCODE]　[CHIBAN] 0A 01 03 1A 1B エラーケース select CASE WHEN [GCODE] = 0 THEN [CHIBAN] ELSE [GCODE] END AS 番地 from test オッケーケース select [GCODE],[CHIBAN], CASE WHEN [GCODE] = 0 THEN [CHIBAN] ELSE CAST([GCODE] AS nvarchar(10)) END AS 番地 from test GCODECHIBAN番地 0A A 01 1 03 3 1A 1 1B 1 Select時には型を合せましょう。
いわゆる同時接続数は、インスタンスのプロパティの「接続」タブで設定可能です。 （サービス再起動が必要） 既定値は0ですが、SQL Serverでの最大値は32,767ですので、0の場合はそれ以内でメモリなどの実装状況によりSQL Server自体が動的に決定することになります。 接続数に関してはメモリ実装状況により一概には言えないと思います。 以下のリンクが参考になると思います。 http://www.atmarkit.co.jp/fdb/rensai/drk03/drk03 … 1接続あたり28KBのメモリが必要になりますが、このメモリが確保されるのは「memory to reserve」領域になります。この領域は大きなクエリの一部も使いますし、それ以外の領域と合計して実装しているメモリが足りているかどうかが最終的な判断基準になります。 ただ、よほどのクリティカルなシステムでない限り、システム自動設定になっているパラメータを設定するのは避けた方がよいと思います。 参考URL：http://msdn.microsoft.com/ja-jp/library/ms187882(SQL.90).aspx
VBと比べてAccessの方が有利なところは ・印刷物を簡単に作れる ・SQLServerとの親和性が高いのでデータのやり取りが簡単 ・ソースとプログラムが一体になっているので将来的にもメンテナンスが可能 などが考えられます。 もしそのシステムが社内で使う物であれば断然Accessをおすすめします。 ソフトウェアを他社に納品するなどであればVBの方がいろいろ楽かもしれませんが・・・。 なお、Access2007であればランタイムが無料で配られています。SQLServerもExpressEditionなら無料で使えます。 導入コストはVBと変わりません。 新規作成するならともかく、今までAccessで作っていたものをわざわざVBに変えるメリットは無いと思っていいと思います。
まず、今回のケースでは、アップサイジングウィザードの利用はできません。 以下のリンクを参照してください。 http://support.microsoft.com/kb/967913/ja Access2003/2007ですら対応していないのですからね。 もともとウィザードの精度はあまり良いものとはいえず、エラーメッセージが出ても対処がわかりにくいことが多いです。 したがって、手間はかかりますが、以下の手順で実行することをお勧めします。 すくなくとも自分が何をやっているか、理解しながら進めることができると思います。 1) SSMS(SQL Server Management Studio)でデータベースを作成する 　・データベースタブで右クリックして「新しいデータベースを作成」を選び、データベース名だけ入力してあとは初期値で可 2) SSMSのデータのインポートを使って、MDBファイルのテーブルを移行する 　・作成したデータベースを右クリックして「タスク－データのインポート」 　・データソースは、元となるMDBファイル（ユーザ名、パスワードはAccess側に掛けていなければ不要） 　・変換先は上記で作成したデータベースがデフォルトで選択されているはずです 　・「１つ以上のテーブルまたはビューからデータをコピーする」 　・「コピー元のテーブルおよびビューを選択」ですべてのテーブルを選択（ビュー、クエリは選択しない） 　・実行すると、MDB側のテーブルレイアウトに合わせてテーブルが自動生成され、データがコピーされます 3) SSMSでデータベースの下に作成されたテーブルをそれぞれ右クリックして「デザイン」を選択 　・ここが手間といえば手間ですが、正しいデータ型でコピーされていることを確認しつつ修正します 　・SSMSの「ツール－オプション」の「Designers」で「テーブルの再作成を必要とする変更を保存できないようにする」の 　　チェックがオフになっていることを確認 　・それぞれのテーブルにつき、以下を修正 　　a)主キーを設定 　　　・テキスト型からコピーされて、データ型がnvarchar(MAX)になっている場合は適当な長さ（nvarchar(50)など）に変更する 　　　・NULLを許容のチェックはオフ 　　　・列を選択して右クリックすると「主キーの設定」が選べる 　　b)リレーションシップの設定 　　　・デザイン画面を右クリックすると「リレーションシップ」が選べるので、「追加」 　　　・「テーブルを列の指定」をクリックすると「...」ボタンが出るので、それを押して主キーテーブルを指定 4) PCにODBC接続のためのDSNを作成 　・メニュー－コントロールパネル－管理ツール－データソース(ODBC) 　・データソースドライバは「SQL Server Native Client」を設定 　・名前は任意(SQLSVなど)、サーバはlocalhostなど。 　・ログイン情報はSQL Serverにログインするときの情報を指定（Windows認証ならば省略可） 　・既定のデータベースは新しく作成したデータベースを指定 5) Access側にあるテーブルをすべて削除して、代わりにSQL Serverにコピーしたすべてのテーブルをリンクテーブルとして登録する 　・リンクテーブルのやり方はわかるという前提です（作成したDSNを使用） 　　わからなければ以下のリンクも参照 　　http://homepage2.nifty.com/SALTY/tips/access/odb … 　・テーブル名はすべて従来のテーブル名と同じになるように 上記までで、テーブルがすべてSQL Serverに移り、それを参照してAccessが動く状態になります。 クエリがAccess側にあっても、「やりたいこと」はすべて満たされるはずです。 （SQL Server内にあるテーブルをAccess側でクエリとして呼ぶことになるため） クエリはSQL Serverではビューと呼びますが、移行するには、 ・SQLビューで表示されるSELECT文をSQL Serverに持っていく 　CREATE VIEW (ビュー名) AS SELECT ....という形式で実行して、ビューを作成する ・ビューに対するリンクテーブルを追加する の手順を踏む必要がありますが、ここはもう少し理解できてからの方がいいと思います。 >あと参考書も買わないといけなさそうです もう少しSQL Serverのことは理解した方がいいかもしれませんね。 買うのもいいですが、参考になるものはネット上に大量にありますよ。 まずは、以下のあたりを見てみるといいと思います。 SQL Server 2008自習書シリーズ http://www.microsoft.com/japan/sqlserver/2008/se … SQL Server 2005自習書シリーズ （質問者さんの目的であれば2005も2008も変わりません。ドキュメントはこちらの方が豊富です） http://technet.microsoft.com/ja-jp/sqlserver/cc7 …
>いろいろ調べた結果、OSは32bit版で、CPUは64bit・32bitマシンともに >対応ということがわかりました。 でしたら、ダウンロードするものが違います。 >（「X64実行可能ファイル」という項目がありそこからダウンロードしました） ここで、「x86実行可能ファイル」を選んでください。
「時間軸の概念」が無くてもご希望のことはできそうに思います。 例えば在庫数を「在庫数データ」として持ち、それが変動してしまうと「時間軸の概念」が必要になりますが「総入庫数」－「総出庫数」として求め「入庫記録テーブル」「出庫記録テーブル」のフィールドを 品物ＩＤ 個数 入出庫日時 とすれば、ある品物に対し、ある時点での個数を計算できます。棚卸しも、ある種の入出庫と考えて処理すれば良さそうです。 >１．トリガで情報を残し、その情報をアクセスします。 >２．一連のトランザクション群を逆算処理してその時点の情報を採取する このように難しいことをする必要が、本当にあるのでしょうか？
参考になるかわかりませんが、リンクにSQL Serverを騙して復旧させた例があります。 正直もはやこのレベルでしか対処は無理かと。 参考URL：http://social.msdn.microsoft.com/Forums/ja-JP/sq …
エラー内容がわからないとアドバイスできません。 イベントビューアやSQL Serverのログを確認してください。 ※デフォルトだとログはインストール配下の以下ファイルです。 <インストール場所> \MSSQL10.MSSQL2008\MSSQL\Log\ERRORLOG
もし、SQL Server 2008 Express Editionを利用されている場合。。 フリーのプロファイラがあります。 説明ドキュメントはありませんが、使い方は殆どSQL Serverプロファイラと同じですので、そちらを参考に。 私が使った限りでは、オリジナルよりも少しレスポンスが遅いけど、これだけ拾えれば十分でしょう、という感じです。 参考URL：http://code.google.com/p/sqlexpressprofiler/
結論がでたようですが、こちらも以下で再現しました。 できれば第三者が再現可能なソースを提示していただけると理解が早いです。 ----------- DECLARE @rReat Real DECLARE @mMoney money DECLARE @fReat float set @rReat =200 set @fReat =200 set @mMoney = 9.4 select @rReat * @mMoney select FLOOR(@rReat * @mMoney) select @fReat * @mMoney select FLOOR(@fReat * @mMoney) ------------- 1880 (1 行処理されました) ---------------------- 1879 (1 行処理されました) ---------------------- 1880 (1 行処理されました) ---------------------- 1880 (1 行処理されました)
世の中にはAccessのプロフェッショナルという人がいるのも確かで、私もSQL Serverはいかなる環境・ケースでもAccessより優れているというつもりはありません。 私見ですが、Accessと比較した場合にSQL Serverを導入する一般的なメリットはデータの集中管理にあると思います。 したがって、下記のような観点がそもそもない場合、SQL Serverを導入するメリットは限定的です（それこそ、データ容量が増やせるだけじゃないの、ということになるかと）。 1.データアクセスの集中管理 　Accessを共有フォルダに置いて処理をさせたところで、結局はクライアント側のリソース(CPU/メモリ)が使われます。SQL Serverにした場合、クエリなどのデータアクセスに関する処理はサーバのリソースで実行されますので、サーバのスペックが高ければ高いほど高いパフォーマンスが得られます。 　また、同時アクセスに対する制御が十分に行われるので、アクセス競合時の処理にも不安がありません（Accessでも十分に工夫してやれば、データ競合の問題は起こらないという意見はありますが、Accessというソフト自体がもともとがシングルユースを前提としており、複数ユーザによるアクセスを想定したデザインになっていないというところがポイントかと思います。要はデータベースとして基本的な部分でも、書く人のスキルに大きく依存します。） 2.高精度なバックアップ 　SQL Serverはトランザクション単位でログを記録することから、完全モードで運用すれば、トラブル発生の直前あるいはバックアップが保存されている限り過去の任意の時点までデータベースを復元することができます。 　Accessではmdbのコピーという方法しかないため、トランザクションの多い場合の復元時点のバリエーションには限界があります。 3.セキュリティ 　共有ドライブにAccessを置くということは、サーバに共有フォルダを設けないといけないということです。そのAccessを開ける人は一般的にそのフォルダに対して権限を持ちすぎることになります（場合によってはmdbを削除することもできるでしょう）。 　SQL Serverは通常TCP/IPでアクセスするため、サーバに共有権限を与える必要はありません。また、アクセスレベルも詳細に設定することができます。 　ユーザはサーバにあるSQL Serverの関連フォルダにアクセスすることはできませんから、不正なオペレーションから守ることができます。データに対する不正なオペレーションについても、ユーザの触れないレベルでログを記録したり、強制的にロールバックしたりすることができます。 4.Accessにはない機能の利用 　Accessのクエリに相当するビュー以外にも、ストアドプロシージャ、テーブル関数、トリガなどの機能を使って、データベース側で固定処理を組み込むことができます。また、データベース側でスケジュール処理を実行させたり、メールを飛ばしたりすることが可能です。
SQL Server構成マネージャを開いて書くサービスの設定を確認しましょう。 「SQL Server Browser」と「SQL Server(MSSQLSERVER)」は別のサービスですので、「SQL Server Browser」を自動実行にしているのでしょう。 ちなみに「SQL Server Browser」の役割は以下です。 >使用可能なサーバーの一覧の参照 >適切なサーバー インスタンスへの接続 >専用管理者接続 (DAC) のエンドポイントへの接続 http://msdn.microsoft.com/ja-jp/library/ms165724(SQL.90).aspx
これって、SQL Serverの話ですか？ メールアドレスとは？ ダウンロードとは？ カテゴリー違いでは・・・　
WHERE TEST LIKE '%AA%' AND TEST NOT LIKE '%B%' です。
列の拡張ぐらいでしたらロックがかかるので大丈夫でしょう。 しかし、データ量が多いと負荷がかかりますので 業務時間帯に行うのはやめた方がよいと思います。 ※注意点 ManagemrntStudioからテーブルのデザインから変更しようとすると 以下の流れで変更を適用されます。 ・変更適用済みのワークテーブル作成 ・データコピー ・元テーブルと同じ権限を付与 ・本テーブル削除 ・ワークテーブルを本テーブルに変更 ・プライマリーキー作成 なので、一瞬ですがテーブルがなくなります。 Alter table文で変更すると本テーブル自体に変更が行なわれます。
匿名接続にする方法は、インスタンスのプロパティで「Security\requireClientAuthentication」をFalseにするだけです。 ただし、質問者さんの環境でこのアプローチが有効かはわかりません。 このサイトではSQL ServerのBIユーザはあまりいないようですし、質問者さんのように「あまり一般的でない」やり方を試行される 場合は正直回答がつきにくいと思います（一般的な質問であれば代わりに手元の環境で試してあげることもできますが）。 したがって、MSのBIフォーラムなどで聞いてみるといいかもしれません。 （それでも回答がつく保証はありませんが） 参考URL：http://social.msdn.microsoft.com/Forums/ja-JP/sq …
違うレコードの内容で更新するためには、何らかの方法で２つのレコードを結合させる必要があります。 ３通り書いておきますので、理解しやすそうなもので試してみてください。 update W_i set 数値=b.数値 from W_i a inner join (select * from W_i where 行番号=1) b on b.品番=a.品番 where a.行番号=2 update a set 数値=b.数値 from W_i a inner join W_i b on b.品番=a.品番 and b.行番号=1 where a.行番号=2 update W_i set 数値=isnull((select 数値 from W_i where 品番=a.品番 and 行番号=1),a.数値) from W_i a
例えば strSQL = "Select * From xxx " strSQL = strSQL & "where 月 = '" & Range("A1") & "'" 参考にして下さい。
>SQLに対して更新(追加)をかけると そのSQL次第だと思います。JOINは入っているのでしょうが。。
一応、SQL Server2000は以下の組み合わせでレプリケーションが出来るようです。 http://msdn.microsoft.com/ja-jp/library/aa237134(SQL.80).aspx ※マージレプリケーションは不可となっています。
一応、補足です。 Management Studioでデータベースのプロパティでファイルを 参照すると、どのデータベースがどのファイルに対応されているかが わかります。 または以下を参照。 select * from sys.database_files; http://msdn.microsoft.com/ja-jp/library/ms174397 … ※Sizeは8KB単位
経験はありませんがマイクロソフトの表記上は大丈夫かと思われます。 それよりも、Enterprise + StandardのEdition違いのほうが問題が起きそうです。 Enterpriseでは動作モードが高可用性、高パフォーマンス、高度な保護の3種類あるのに対し、Standardでは高パフォーマンスを選択できませんのでご注意を。
バックアップしたDBのデータファイルのパスをデフォルトから 変えているのでしょう。 メッセージで対処方法は記載されています。 >WITH MOVE を使用して、そのファイルにとって有効な場所を特定してください。 以下のようにMOVE句で移動するか、復元先のディレクトリを作成するか どちらかで対処してください。 RESTORE DATABASE [test] FROM DISK = N'C:\xxx_backup.bak' with MOVE N'test' TO N'E:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\Data\test.mdf', MOVE N'test_log' TO N'E:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\Data\test_log.ldf', RECOVERY; GO
Accessが手元にないのでこれが通るか試してもらえるでしょうか？ SELECT　* FROM　Table1　A WHERE　A.Date BETWEEN　#2008/10/1#　AND　#2008/10/31# VBAだから日付部分は下記でとれるかな 引数の取り方がわからないので年と月は適当に置き換えてね DateSerial(2009,10,1) DateSerial(2009,10 + 1,0))
SQLサーバではなくて、クライアントの話であれば 可能といえます。 しかし、メモリが512MBというと、Windows2000とか WindowsXPならSP1まででないと現実的ではないので セキュリティとか考えると、SQLサーバを使うクライ アントとしては不適切でしょう。 実際の1,048,516TBを扱うSQLサーバはお化けマシン です。というか、1台のPCでは実現不可能です。
#1,#2です。 結局インストールされているのはExpressでしたか？ （サービス名はSQL Server(SQLEXPRESS)なっていましたか？） ローカルのSQL Serverは全く使っていないと書かれていたので少し気になったのですが、SSMSで接続するときにローカルのSQL Server Expressに接続しましたか？（localhost\SQLEXPRESSに接続しないで、どこかリモートのSQL Serverに接続したなんてことはないですよね）。 インスタンスの横に表示されるバージョンはそのインスタンスのバージョンです。だから、リモートのSQL Serverに接続したのだったら、そのリモートのSQL Serverのバージョンになります。 そこは間違いないということならば、結局インストールがうまくいっていないということになるのでしょうね。SQL Server Express自体をアンインストール＆インストールするのも一つの手ですね。
>SELECT > a.ro_no, > b.data_name >FROM table_1 a, > table_2 b, > table_3 c >WHERE b.data_name <> '' > AND a.code_no = b.code > AND a.user_id = c.user_id >ORDER BY a.ro_no, b.data_name; SQL Serverの照合順序はどうなっていますか? これは比較の際に大文字小文字を区別するかどうかなどを指定します。 以下URL参照 http://msdn.microsoft.com/ja-jp/library/ms187582 … 複数表とジョインしているので、比較の設定が異なるせいな気がします。 ジョインで複数件数が返ってきている気がしますので、該当データを確認してください。
>匿名認証とはIISですか？ ユーザ認証をしないモードです。 IIS経由も以下のリンクの通りやってやれなくはないでしょう。 http://bloggingabout.net/blogs/mglaser/archive/2 … VPNだったら以下のリンクが参考になるかもしれません。ただし、やったことはないし、そもそも簡単に試せないので、これ以上のコメントは避けます。 http://blog.stevienova.com/2008/01/14/how-to-con … http://www.mydatabasesupport.com/forums/sqlserve …
#1です。 実際に試してみましたが、画像をよく見るとフォルダを指定していませんね。この状態では入力が不十分なので、OKは選べません。 フォルダを指定すればOKが指定できるようになるはずです。 ただし、自宅のPCはSP1をあててしまったので、RTMの状態でもそうなるかは確認できないのですが。
どういう環境でAccessを使っているか？にもよるかと思いますが。 個人で使うPCで同時に1人しか使わないのであれば、Accessで十分だと思います。 使い続けるとファイルサイズが肥大化するので、定期的に最適化すればファイルサイズもまた小さくなって検索速度もそこそこ早くなるので、それほど問題にならないと思います。 基本的に ・複数人で同時に参照・更新・編集する ・データ件数・データサイズが大きい 場合はSQL Serverを選びます。 Accessの場合は全データをファイルとしてPCが全件読み込んだ上で、テーブルの検索とかを全てPC上で行いますが、SQL Serverの場合は、検索条件などを送信して、実際の検索処理などはサーバで行います。 SQL Server自体が専用のサーバであることと、必要なデータのみ送受信するので、Accessよりも効率的にデータの検索などが行えます。 イメージは > テーブルデータ以外はそのままMDBファイルに入れて、 > テーブルのみを別ファイルに移行するリンクテーブ > ル（be.mdb）と同じようなものなのでしょうか？ およそその通りですが、Accessのリンクテーブルも実際には全データをPCで読み込んでPCで処理しているので、その部分が専用のサーバでやれると思えば大体OKです。
SSMSをインストールしているならば、テーブルを右クリックして「テーブルをスクリプト化」でもできますし、まとめて生成したい場合もデータベースを右クリックして「タスク－スクリプトの生成」でできます。
独自に作成した定義書からってのは既存ツールでは難しいんじゃないでしょうかね。 Excel で作成した独自定義書ってんだから定義されたものを VBA で読み取って SQL 文を生成するようにしてみてはどうでしょうか？
AccessからSQL Serverへの移行となるとちょっと厄介ですね。 Accessで使用しているクエリの中にはAccess専用のものがあったり、VBAでの記述方法が混在していたりしてフォームの構成と棲み分けがやりにくい部分がありますが、 一方でSQL Serverは基本的には ・データベースを作成 ・データベースの管理下にテーブルとストアドプロシージャを作成 ・各テーブルへのアクセス権を設定 あたりが中心になり、フォームを作ったりする機能は持ち合わせていません。 大まかに言って、Accessにおけるテーブルとクエリ？に相当する機能を負っていると考えてよいかと思います。 実際に使用される際も、Accessのフォームからボタンを押したときにSQL Serverへクエリを発行してデータを取得する、といった方法が中心になるかと思います。 例えば↓こんなところで情報を漁ったり掲示板で情報を漁ったりするのが最初かと思います。 http://www.atmarkit.co.jp/ ただこういったところで質問する際、質問があまりに半端だと総すかんを食うこともありますのでご注意を。 あと、先月あたりから調査を始められたのでしょうか？ Microsoftは旧バージョンであるSQL Server2005を含むVisual Studio2005のサポートを先月末で打ち切りました。 現在は後継バージョンであるVisual Studio2008に含まれるSQL Server2008がサポートされており情報も追加されています。 今から始めるのであれば新バージョンで着手する方が良いのではないかと。
#1です。 列定義を行う画面に「型の推測」ボタンがありますので、それを押してためしてみてください。
#1です。 「メンテナンスクリーンアップタスク」というのを追加すれば可能です。 メンテナンスプランで作成されるバックアップは１バックアップ１ファイルになりますので、指定日数後に削除するように登録しておけば期限が過ぎたバックアップファイル自体が削除されていきます。
ファイルの読み込み時エラーであれば捕捉できるはずですが、ファイル不存在などの場合は、リンクページの「ステートメントレベルの再コンパイルで発生するエラー (コンパイル後の名前の遅延解決により発生するオブジェクト名の解決エラーなど)」に相当するため、捕捉できないのだと思います。 したがって、以下のように動的クエリにすればよいです。 なぜこれだとOKなのかも、リンクページに書いてあります。 DECLARE @sql varchar(max) BEGIN TRY SET @sql='BULK INSERT TABLE1 FROM ''C:\AAAAA.txt'' WITH (ROWTERMINATOR=''\n'')' EXEC (@sql) END TRY BEGIN CATCH SELECT ERROR_NUMBER(),ERROR_MESSAGE() END CATCH 参考URL：http://technet.microsoft.com/ja-jp/library/ms175 …
＞この部分は何を行っているのでしょうか？ ＞＞isnull(d.TotalAmount,0) そもそもleft outer joinにしている理由は「Totalにはあるけど、（削除されたなどで）Detailにはないというケース」を想定してのものです。 Detailが万一なくなっていれば、やはりTotalAmountは0にしたいでしょうから。 上記のケースではDetail側はデータがないので、NULLになります。 ISNULLは「NULLならばゼロにする」という関数です。 これにより上記ケースでもTotalAmountを0にできます。
質問の意味がよくわからないのですが、 > データのパーセンタイル値を「入れる」 というのは、テーブルに収録したいという意味ですか？ それとも単にSELECT文で取得したいという意味ですか？ 後者の意味ならば、こんな感じですかねー。 SELECT Data, CONVERT(float,(ROW_NUMBER() OVER (ORDER BY Data)))/(SELECT COUNT(*) Cnt FROM データ) FROM データ
>SELECT keyword FROM table ORDER BY keyword OFFSET 5000000 LIMIT 30 これ、SQL Serverではありませんね（Postgresかな）。 このタイトルでこのカテゴリに投稿したら、Postgresの人は見てくれないかもしれませんよ。
ただ件数を増やしたいということなら、一番簡単な方法は以下の通り。 INSERT INTO TABLE2 SELECT t1.* FROM TABLE1 t1,TABLE1 t2,TABLE1 t3,TABLE1 t4 TABLE1に10件あれば、これで１万件ですね。
>余分に残しておく必要はあるのでしょうか? 用途次第です。障害復旧の目的だけであれば、最新のフルバックアップとそれ以降のトランザクションログバックアップがあれば それでいいと思います。 個人的な経験ではユーザエラー（データを消してしまっていたのを戻したい）、ログ取得が不十分なケースでの調査、月次処理のやり直し、 などの理由で別環境にリストアして対応したことがあります。Standardエディションにはスナップショット機能がないので、そのようなニーズがあるならば、それに応じたバックアップの保管が必要になると思います。 >サーバはRAID5の構成ですがログも物理的に別のドライブに採るようにした方がいいのでしょうか? 通常はデータベースファイルとバックアップファイルが別のストレージに保管されていれば、足りると思います。 >また、データベースの圧縮やインデックスの再構成などもしたいのですが、 そんな場合別のプランにした方がいいのかサブプランを追加して行く方がいいのでしょうか? どちらでも構わないです。管理がしやすい方でやってみてください。 なお、フルバックアップの過去分を保持しないならば特に、フルバックアップの前に「整合性チェック」タスクを組み込むことをお勧めします。 内部的に整合性エラーが生じた状態でフルバックアップを取ると、バックアップの中身もそうなりますので。 >どの本にも書いてないので 確かにそういう書き方をしている例はあまりないかもしれませんが、以下のページの例で代替手順１がそのケースだと思います。 （代替手順２も可能であることから、午後 8 時のトランザクションログバックアップには午後 4 時以降のトランザクションが含まれていることがわかりますよね） http://msdn.microsoft.com/ja-jp/library/ms189596 …
先日からの質問を見ていると、自分で調べもせず、デタラメなことばかりやっているように感じてしまうのですけれど。 書籍を購入するなどして、基本からしっかり勉強した方がいいのではないでしょうか？ 本題です。 RDBMSは、ここのカテゴリ通りSQL Serverでしょうか？バージョンも明記してください。 ストアドプロシジャにするとか、ある表の操作の背景で別表も操作するようにトリガを定義するといった方法になります。
リンクのページが参考になるかと思いますが、SMOはCOMオブジェクトとして使用することはできないため、Access2000からSMOを使うのはあきらめた方がよいです。 引続きDMOはサポートされます（SQL Server 2005の新機能はサポートされませんが）ので、どうしても必要ならばDMOを使い続けるしかないと思います。 参考URL：http://social.technet.microsoft.com/Forums/en-US …
ドライバーはDVDマルチか何かでしょうか？　XPだとしたら標準でCD-RW書き込みソフトが入っていると思います。 CDに焼く場合設定変更とディスクの初期化する必要があります。 （例） (1)マイコンピュータ→「DVD-RAM(E:)」アイコン上で右クリック→プロパティ(R)→「書き込み」タブの「このドライブでCD書き込みを有効にする(E)」にチェックを入れ「OK」 (2)マイコンピュータ→「DVD-RAM(E:)」アイコン上で右クリック→フォーマット(F)で初期化する。
質問を読むとデータベースがどうこうという前の要件定義レベルの 話のようですね。 データベースはデータを保存する入れ物でしかないので、やりたいことをまとめたほうがよいでしょう。そのうえでソフトウェア等を選定します。 ※DBはただの入れ物ですが、確実に保存する信頼性の高い入れ物として作られています。 前提の知識レベルからするとゼロから自分で作るよりは、ネットショップやホームページ運営のASPサービスなどを利用した方がいいかもしれません。 24時間運用でトラブル時には昼夜問わずに対応することを考えれば そういうサービスを利用する方が良い気はします。
・とりあえずそのJOINだけ何とかしたい場合、 　SELECT * FROM テーブルBIN t1 　INNER JOIN テーブルBIN2 t2 ON t2.フィールド=t1.フィールド COLLATE Japanese_90_BIN2 WHERE ... ・データベースの既定の照合順序を変更したり、既存のテーブルの照合順序を変更するのは、普通は以下の制約にかかる可能性が高いので、厳しいと思います。 --次の条件の 1 つ以上に該当する場合、ALTER COLUMN で照合順序を変更することはできません。 --・CHECK 制約、FOREIGN KEY 制約、またはその列を参照する計算列が変更された場合。 --・列にインデックス、統計、またはフルテキスト インデックスが作成された場合。変更する列に対して自動的に作成された統計は、列の照合順序を変更すると削除されます。 --・スキーマ バインド ビューまたは関数で列が参照されている場合。 そうなると、地道に既定値で作成したテーブルを再作成するしかないと思います。 参考URL：http://msdn.microsoft.com/ja-jp/library/ms190273(SQL.90).aspx
#1,#2です。補足です。 とりあえずお役に立てたなら何よりですが、「テーブル関数でもいい」ということは「SQL Serverにオブジェクトを作成してもいい」ということですよね。 テーブル関数がOKで、ストアドプロシージャはNGという理由が、特になければ、ストアドプロシージャの利用も検討してみてください。 SQL Serverは「ストアドプロシージャ内でSELECTした結果がレコードセットで受け取れる」という比較的珍しいDBMSです。
>RECORD　SETの処理の様な記述 つまりカーソルを使いたいということでしょうか？ DECLARE @FIELD varchar(100) DECLARE DCUR CURSOR LOCAL FOR SELECT [項目] FROM XXXX OPEN DCUR FETCH NEXT FROM DCUR INTO @FIELD WHILE (@@FETCH_STATUS=0) BEGIN --@FIELDを使った処理 FETCH NEXT FROM DCUR INTO @FIELD END CLOSE DCUR DEALLOCATE DCUR
Javaは使っていないのですが、リンクサーバに関する限り同様の環境で試してみても、そのような事象は確認できませんでした。 したがってあくまで推測の域ですが、ポイントはリンクサーバ側というよりもJDBC側ではないでしょうか？ とりあえず、以下のあたりをお勧めします。 ・SQL Server単体で実行して、本当にロールバックされないか試してみる。 　BEGIN TRY 　BEGIN TRAN 　INSERT INTO テーブルa values (...) -- 正常終了するもの 　INSERT INTO テーブルa values (...) -- 制約違反が生じるもの　 　COMMIT TRAN 　END TRY 　BEGIN CATCH 　ROLLBACK TRAN 　END CATCH ・以下のページをチェックして、JDBC経由でのMSDTCが正しく機能しているか確認する。 　http://msdn.microsoft.com/ja-jp/library/ms378931(SQL.90).aspx
インストールスクリプトの作り方として、その方法は「SQL Serverでは」一般的ではないと思います。 OracleのSqlPlusの「@」のようなものはありません。 インストール用に複数のsqlファイルを準備するならば、ドライバはsqlファイルではなく、バッチファイルにし、 そこにosqlコマンドを並べていくことになります。 どうしてもドライバをsqlファイルにしたい場合、xp_cmdshellを使ってosqlを実行することになります。 （sysadminしか実行できないものになります）
SQL Server 2005以降なら、標準SQL準拠のinformation_schemaを利用できます。 それより前であれば、RDBMS独自のシステム・カタログ等を参照することになります。
もしまだ解決していないなら。。 手持ちの環境(SQL Server 2008/Oracle11g)では主キーがなくても同じ事象は確認できなかったので、 主キーがない＝リンクサーバで利用できない、ではないかもしれません。 ただ、いずれにしても、Oracle側を変更できない以上、SQL Server側で対処できる範囲は限られます。 ・Microsoftのではなく、OracleのODBCドライバを使っていることを確認する 　http://www.oracle.com/technology/global/jp/softw … ・OPENQUERYを使ってみる 　SELECT * FROM OPENQUERY(リンクサーバ名, 'OracleのSELECT文') ・どうしてもダメなら、何か経由させてみる 　例えばOracleのテーブルをAccessにリンクして、そのMDBに対してリンクサーバを設定してみるなど 　Accessの場合、主キーがなくても主キーを指定してリンクできるので、何か違いが出るかもしれません。
最小と最大の違いはありますが、以下の質問と同じ内容です。 参考にしてください。 http://oshiete1.goo.ne.jp/qa4750759.html
鶏と卵みたいなことですが、アタッチする前に対象のMDFファイルを変更したい名前で「コピー」し、 そのコピーした方のMDFをアタッチしてデータを更新すればよいと思います。
>レプリケーションで作るもんなんですかね？ そう思います。リアルタイムに近い状態で照会したいならトランザクションレプリケーションを設定するでしょう。 データの反映タイミングの許容度によってログ配布やスナップショットも検討対象にはなるでしょうが。
以下にサンプルをあげますが、回答というよりも、あくまでも一例としてやり方だけ理解していただきたいという趣旨です。 これを見ると以下のことがわかるはずです。 ・Sessionに入れた配列は結局一旦配列の変数に取り出して使う ・同じページ内の処理であれば、結局Sessionを使う必要はない ・SqlDataSourceへの値のセット方法は、パラメータとして渡す方法だけではない また、ここまで来ると質問内容はデータベースカテゴリよりも、明らかにASP.NETです。ASP.NETカテゴリの方がはるかに早く適切な回答が付くでしょう、ということもコメントしておきます。 　Dim myArray() As String = Split("1,0,1,1,0", ",") 　Session("aaa") = myArray 　Dim myNewArray() As String 　myNewArray = Session("aaa") 　Dim strSQL As String = "SELECT * FROM TABLE1" 　Dim strWhere As String = "" 　For i As Integer = 0 To UBound(myNewArray) 　　If myNewArray(i) = "1" Then 　　　Select Case i 　　　　Case 0 : strWhere = strWhere & " (F1=1 AND F2=0)" 　　　　Case 1 : strWhere = strWhere & " OR (F1=2)" 　　　　Case 2 : strWhere = strWhere & " OR (F2=1 AND F3=1)" 　　　　Case 3 : strWhere = strWhere & " OR (F1=1 AND F2=1)" 　　　　Case 4 : strWhere = strWhere & " OR (F3=2)" 　　　End Select 　　End If 　Next 　If Left(strWhere, 3) = " OR" Then strWhere = Right(strWhere, Len(strWhere) - 3) 　If strWhere <> "" Then strSQL = strSQL & " WHERE " & strWhere 　SqlDataSource1.SelectCommand = strSQL
最近は基本情報でもこんなわかりにくいSQL文出すんですね。 （すいません。第二種時代の人間で） さて、エがなぜ不正解かというと、「その部署にプログラマである社員が１人もいない場合、抽出できないから」です。 アはCOUNTを使っていますから、サブクエリの結果がゼロ人でも「0」を返してくれますが、エはサブクエリの結果が該当なしとなってしまい、メインクエリのIN句の条件を満たさなくなってしまうのです。
なぜセッション変数に入れてSQLデータソースに渡さないといけないのかがわかりませんが、チェックボックスリストとSQLデータソースは別のページにあるのですか？ セッション変数に入れるならば入れるで構わないのですが、セッション変数は配列だってセットできます。だから一旦配列に受ければいいです。よい例かどうかわかりませんが、、 Dim lngCnt As Long = MyCheckBoxList.Items.Count - 1 Dim myArray(lngCnt) As String For i As Long = 0 To lngCnt 　　myArray(i) = IIf(MyCheckBoxList.Items(i).Selected, "1", "0") Next Session("xxxx")=myArray SQLデータソースのSelectCommandには、チェックボックスリストの結果をループで読み出して組み上げたSELECT文をセットすることになると思いますが、そこはおわかりだろうと思います。
転送先のSQL Server Agentサービスを起動しているアカウントは何ですか？(SQL Server構成マネージャで確認) 転送先のSQL Server Agentサービスのアカウントの権限でアクセスしにきているので、それ次第だと思います。 （ビルトインアカウントのいずれかを使っているならば、Everyoneフルコントロールにしたところでダメなケースがあります） まあ、そこで悩むくらいなら手動でデタッチ＋ファイルコピー＋アタッチした方が早いだろうというのは確かです（デタッチもアタッチもSSMSでできるからコマンドは不要ですし）。
>つまりXP上にSQLServer Enterprise managerのようなソフトでDBを監視したいのですが。 SQLServer Enterprise managerはサーバー上だけで使うわけではありません。クライアントソフトですから。 LAN上のDBのホスト名やIPがわかっていて、そこにクライアントPCから接続可能であるなら、普通に見れるはずです。
CASE式でテーブルを切り替えることのできるDBMSはないと思います。 そのためにOracleでもSQL Serverでも苦労して動的クエリを書くのです。 SET @sql='SELECT * FROM '+CASE WHEN @FLG=0 THEN 't当月集計' ELSE 't累積集計' END+' AS t請求残' EXEC (@sql)
WITH NORECOVERYでは当然そうなります。 （データベースの復元を完了させないで、引続きトランザクションログをリストアするときや、ミラーリングするときに使うモードだからです）。 通常の場合は、デフォルトのWITH RECOVERYです。 別にトランザクションログを追加であてる必要がないのならば、もう一度WITH RECOVERYでリストアしなおしてください。 追加であてるトランザクションログがあるのならば、復元中のままトランザクションログをWITH NORECOVERYでリストアし続けて、最後のトランザクションログだけをWITH RECOVERYでリストアしてください。
ひとまず、私の解釈による仕様と うろ覚えのＳＱＬでの回答です。 ［仕様］ T_i テーブルに格納されているデータを 番号１カラムのグループ毎に小計を求め W_i テーブルの内容を更新する。 ［ＳＱＬ文］ なんとなくこんな感じ。 update W_i set 数値 = ( select sum(金額) from T_i where 区分 = '0' group by 番号1 ) where (区分 = '0') and 番号1 = ( select 番号1 from T_i where 区分 = '0' group by 番号1 ); 丸々上書きされてしまうなら Insert 文の方が楽な気もしますが…。
これでどうでしょうか。 mySQL = "INSERT INTO ZAIKO(ID, HINBAN, HINMEI, QTY, DATE) " & _ "VALUES ('NY','" & objForm.GetField("品番") & "'," & _ "'" & objForm.GetField("品番") & "'," & _ CLng(objForm.GetField("数量")) & "," & _ "'" & Date & " " & Time & "')" ID ===> 'NY' HINBAN ===> '" & objForm.GetField("品番") & "' HINMEI ===> '" & objForm.GetField("品番") & "' QTY ===> CLng(objForm.GetField("数量")) DATE = '" & Date & " " & Time & "' HINBANとHINMEIが同じなのは気になりますが
素直にジョインすると以下のようになります。 select a.氏名, b.教科名 AS 教科1, c.教科名 AS 教科2, d.教科名 AS 教科3, from 受講履歴 a left join 教科 AS b on a.教科1 = b.教科ID left join 教科 AS c on a.教科2 = c.教科ID left join 教科 AS d on a.教科3 = d.教科ID where a.出席番号 = 1002 ; でも、普通に考えて「受講履歴」の教科カラムが3つだけとは思えないのです。教科を横持ちにするとカラム数分しか履歴はもてないのでは？ 実際のテーブル構造は違うと思いますので参考までに。
特にキューブの再作成などの設定は必要ありません。 私がロールコントロールも込みでAnalysis Serviceを設定するようになったのは2005からなのですが、そもそもサーバ管理者に含まれている人は一切の制限設定がきかないです（データベースエンジンのsysadminロールと同じ）。 それくらいしか思い当たるフシはないのですが。。
ODBCドライバの設定方法 http://www.venus.dti.ne.jp/~yoshi-o/RDB/ODBC-con … SQLServer 2000の項目を参照 たぶん2005でも同様だと思うので ログイン方法はちゃんと指定してますか？
SQL Server 2000だったのですね。 私の認識する限りでは、SQL Server 2005のようにエラーを抑え込むTRY/CATCH構文のようなものは2000にはないので、VBAサイドでOn Error Resume Nextを使ってエラーを抑え込むことになると思います。
問題を切り分けるために、 ・SQLPlusとかでOracleクライアントからOracleデータベースへの接続は可能or不可能。 ・余裕があればPingが通るとか、TracertやTNSPingを実施結果 …とか書かれてみてはいかがでしょうか？
掲示板を勘違いしてOracleで作成していました。 create table a ( c1 int, c2 int, c3 int, c4 nvarchar(50) ); select x.C1,x.C2,x.C3,x.C4 from ( select C1,C2,C3,C4,max(C3) over(partition by C1) max_c3 from a) AS x where x.C3 = x.max_c3; SQL Serverだとこっち。
質問者さんがされた作業をもっと具体的に書いてください。 「Accessをインストール」というのは、Microsoft Office 2000のCD-ROMからAccess2000をインストールしたということですか？ それともAccess2000はもうインストール済の状態で、協力会社の提供したツールを動かすための何か他の作業をしたということですか？ また、そのファイルはmdbまたはmdeなのだと思いますが、それがエラーメッセージなしに開けば、正しく動いていると言えますか？ そのエラーメッセージを出なくできる可能性はありますが、「インストール作業」がうまくいっていないことが原因なのであれば、目先の問題（エラーメッセージ）を解決したところで、正しく動くかどうかはその協力会社の人しかたぶん保証できないためです。
どうやって入手したSQL Server 2005をインストールしていますか？ 文字通り質問者さんのPCは最小要件を満たしていないと思われます。 http://www.microsoft.com/japan/sql/editions/expr … 上記をチェックして、CPU、OS、メモリ、ハードディスクの空き容量等を確認してみることをお勧めします。 次へ進めないのならば、そのままのスペックではインストールは続行できないと思います。
本質的には接続文字列を変更するだけの話です。 ただし、どこにあるどういうSQL Serverに接続したいかにより変わります。 cn.Open "Provider=SQLOLEDB;Data Source=(サーバ名);Initial Catalog=test;Integrated Security=SSPI" サーバ名は「どこにあるどういう名前でインストールしたSQL Serverか」により決まります。同じPC内にあるなら、省略するか「localhost」(SQL Server Express以外のデフォルト)か「localhost\SQLEXPRESS」(SQL Server Expressのデフォルト)のいずれかで通るでしょう。 また、上記はWindows認証を選択してインストールした場合で、混合認証の場合はIntegrated Securityの代わりにUser IDとPasswordの指定が必要です。
＞ これですが、本番環境上で複製をするという意味でしょうか？ はい、そうです。 この方法では一時的に十分な空き領域が必要ですので、今回の例では使えないですね。 （あまり参考にならなくてすいません）
RDBMSは、ここのカテゴリ通りSQL Serverですか？ バージョンは？ 自表を自己結合したり、他表を結合してのupdateは、RDBMSによる仕様差があります。 update t1 set b=y.d from t1 as x,t2 as y where x.a=y.c
DTSでそのような内容を動的に変更するときには、動的プロパティタスクを使うのですが、そもそもどこまで理解して作成されているのかよくわからないので以下の点を確認させてください。 ・「ストアドプロシージャーよりパラメータを渡してDTSを起動」というのは、xp_cmdshellもしくはエージェントタスクを使って、DTSRUNを実行し、そのときに/Aスイッチでパラメータを渡しているという理解であっていますか？ ・パラメータが確実にパッケージ内のグローバル変数にセットされていることは確認できていますか？
SQL Server 2000/2005/2008は同時にインストールすることは可能です。XPならば実際に私もやったことがあります。 ただ、VistaにはSQL Server 2000は載らないです。
資料ということであればこれは参考になりますか？ http://msdn.microsoft.com/ja-jp/library/bb677622 … また、SQL Server 2008 Enterprise Edition は評価版がありますのでご自身でテストしてみてはどうでしょうか？ http://msdn.microsoft.com/ja-jp/evalcenter/bb851 …
SQL って略さず、面倒でも SQL Server て書いたほうが良いと思いますよ。 きっと参考になると思います。 http://www.sqlpassj.org/tokushu/backup/default.a …
リンクテーブルならば、更新できないテーブルに主キーを設定していますか？または、主キーを指定してリンクしましたか？
そんなサイズで試した人はほとんどいないと思いますが、オフィシャルマニュアルによれば以下の通りです。 インスタンス数：50 インスタンスごとのデータベース数：32,767 データベースサイズ：1,048,516TB データベースごとのファイル数：32,767 データファイルサイズ：16TB ログファイルサイズ：2TB
横からですが SELECT 項目,MIN(登録ＮＯ)AS 登録ＮＯ FROM テスト GROUP BY 項目 ORDER BY MIN(登録ＮＯ) でいけます。
ODBC接続利用可であれば参考URLを参考にしてみて下さい 参考URL：http://homepage2.nifty.com/SALTY/tips/access/odb …
小文字だからじゃないですか？ sqlCommand^ sqlCmd=～ 　　　　　↓ SqlCommand^ sqlCmd=～
現在使われているSelect文を以下のように変更して下さい。 SELECT * FROM [テーブル名] WITH (UPDLOCK,NOWAIT) WITH句を書くことにより更新クエリを防ぐことができます。 詳しくは「更新ロック SQL Server」で検索下さい。
その段階から目的を達するまで説明するのは無理なので、まずは以下のドキュメントを一通りご覧ください。 今回の質問の答えも含めて載っていますから。。 「SQL Server 2005 自習書　Express 編 Express 基本操作」 http://msdn.microsoft.com/ja-jp/sqlserver/cc7206 …
Webシステムで、接続をSessionに押し込んで使いまわすのは見かけますが、クライアントシステムでは確かにあまり見かけたことがありませんね。 やりたい場合は、グローバルのオブジェクトに入れてしまえば済む話だと思いますが、リモートの場合はプログラムを立ち上げているだけで セッションがずっと残るので、データベース管理者にしてみれば迷惑な話かもしれません。 ネットワークなり、データベース側の理由でセッションが切れてしまったときには、プログラムを立ち上げ直さないといけなくなりますね。 別の方のコメントの通り、ネットワーク負荷軽減のメリットはまずないと思います。
Windows Server2008のファイアウォール設定は問題ないですか？ ポート1433開いていますか？ 参考URL：http://msdn.microsoft.com/ja-jp/library/cc646023 …
スカラー関数自体はパラメータを受け取って、スカラー（今回の場合はvarchar文字列）を返すだけですから説明は不要として、おそらくわかりにくいのは DECLARE @STR varchar(8000) SELECT @STR=ISNULL(@STR+@DELIM,'')+[名物名] FROM TRN_table_B WHERE [都道府県CD]=@PREFCD ですよね？ もともとテーブルの値を変数に受けるときに、 SELECT @STR=[名物名] FROM TRN_table_B WHERE ... という書き方をします。 (SET @STR = (SELECT [名物名] FROM TRN_table_B WHERE ...)でもいいですが、MSの今の推奨は上） このとき該当するデータが１件だけならわかりやすいですが、２件以上ある場合、SQL Serverでは検索される順番に「それぞれの行で」@STR=[名物名]が行われます。 例えば上記SELECTの該当が３件で、それぞれ「たこ焼き」、「お好み焼き」、「豚まん」だとしたら、１行読み込むごとに@STRに「たこ焼き」=>「お好み焼き」=>「豚まん」とセットされていき、最後が「豚まん」なので、実行後の@STRは「豚まん」になります。 この性質を利用すると DECLARE @STR varchar(8000) SET @STR='' SELECT @STR=@STR+[名物名] FROM TRN_table_B WHERE ... という書き方ができます。 この書き方をすれば、１行読み込むごとにその行の名物名が足されていくことになるので、実行後の@STRには「たこ焼きお好み焼き豚まん」と入ります。 当然「区切り文字を入れたい」と思いますよね？ そこで DECLARE @STR varchar(8000) SET @STR='' SELECT @STR=@STR+','+[名物名] FROM TRN_table_B WHERE ... と書きなおすと、@STRの結果は「,たこ焼き,お好み焼き,豚まん」となります。 区切り文字は入りましたが、先頭にも区切り文字が入ってしまいます。 SUBSTRINGなどを使って先頭の区切り文字を削ってもいいわけですが、ここでもう１つの性質を利用します。 「SQL Serverでは文字列結合の中にNULLが入っていると結合結果もNULLになる」 上の例で「SET @STR=''」と初期値にブランクを指定している理由がここにあります。 （初期値設定がないと@STRはNULLですから、クエリの結果もNULLになってしまいます） 逆にいえば、NULLのときには何を結合しても結果はNULLです。 それで、 DECLARE @STR varchar(8000) SELECT @STR=ISNULL(@STR+',','')+[名物名] FROM TRN_table_B WHERE ... と書けるわけです。 １行目　名物名＝たこ焼き @STRはNULLなので、@STR=ISNULL(@STR+',','')+[名物名]の部分は => @STR=ISNULL(NULL+',','')+'たこ焼き' => @STR=ISNULL(NULL,'')+'たこ焼き' => @STR=''+'たこ焼き' => @STR='たこ焼き' ２行目　名物名＝お好み焼き @STRは'たこ焼き'なので、@STR=ISNULL(@STR+',','')+[名物名]の部分は => @STR=ISNULL('たこ焼き'+',','')+'お好み焼き' => @STR=ISNULL('たこ焼き,','')+'お好み焼き' => @STR='たこ焼き,'+'お好み焼き' => @STR='たこ焼き,お好み焼き' 以下同じ。 結果、先頭の区切り文字はなく、きれいに想定した結果になるというわけです。 仕組みを理解すると、応用が効きます。文字列加工のかなりのケースでカーソルが不要になります。 ぜひ活用してみてください。
理由は3rd_001さんの書かれた内容だろうと思います。 （追加書きしたいテキストは「My Document」の中、なんてことは。。） 補足として。。。 「ＳＳＭＳから間違えたコードを含むvbsを実行すると実行のまま止まらなくなる」のは、vbsが返す構文エラーのエラーメッセージのメッセージボックスが内部的に表示されっぱなしになるからです（xp_cmdshellはインタラクティブではないので、そのメッセージを見ることはできず、永遠に実行中になる）。 今回のうまく動かないvbsでは、「On Error Resume Next」が切られているでしょうから、実行時エラーの「書き込みできません」というエラーメッセージは出ず（＝実行中のまま止まることなく）、正常終了します。 従って、xp_cmdshellからvbsを実行する際に気をつけることは「エラーログを書くこと」でしょうか。
「MSDEにはあったのに2005Expressでは削除された」という意味でしょうか？ であれば答えはYesですね。2008Expressにもついていません。 参考URL：http://msdn.microsoft.com/ja-jp/library/ms165672(SQL.90).aspx
書いてありませんか？ >Download the file that is appropriate for your operating system version and platform. >For Windows Vista, Windows Vista Service Pack 1 and Windows Server 2008: >x86 Platform: Windows6.0-KB942288-v2-x86.msu >x64 Platform: Windows6.0-KB942288-v2-x64.msu >IA64 Platform: Windows6.0-KB942288-v2-ia64.msu 32Bitならx86ですね。 参考URL：http://www.microsoft.com/DOWNLOADS/details.aspx? …
どうやっていてダメなのか読みきれていませんが、以下は参考になりますか？ CREATE TABLE DB ([A][varchar](10)) INSERT INTO DB VALUES ('abcde') INSERT INTO DB VALUES ('bcdef') DECLARE @A varchar(12) SET @A='%def' SELECT * FROM DB WHERE DB.A LIKE @A SET @A='def' SELECT * FROM DB WHERE DB.A LIKE '%'+@A DROP TABLE DB
勘違いな回答でしたらごめんなさい。 SQLServer2000なら、クエリアナライザでこのコマンドを実行すればログの切捨てはできたような・・・ backup log [対象のデータベース名] with truncate_only dbcc shrinkfile('[対象のデータベース名]_log')
しまった。言葉足らずでしたか。。 SysAdmin(System Administrator)を付与しているからそうなるのです。 SysAdmin権限を持っていると自動的にdboで接続されるので、SELECT * FROM TABLE1とやると、SELECT * FROM test_user.TABLE1ではなく、SELECT * FROM dbo.TABLE1を実行しようとするのです。 これは仕様だと思いますよ。
「ウィンドウ」メニューの「ウィンドウレイアウトのリセット」で初期状態になりません？
「回答」フィールドは数値型なんですね。 「質問番号1に回答(=1)が入力され、かつ質問番号3に回答(1以上10以下)が入力されているIDをテストテーブルから取得したい」 という場合は、以下の通りです（何パターンも書き方はあります） SELECT DISTINCT ID FROM test_table t WHERE EXISTS (SELECT NULL FROM test_table WHERE ID=t.ID AND 質問番号=1 AND 回答=1) AND EXISTS (SELECT NULL FROM test_table WHERE ID=t.ID AND 質問番号=3 AND 回答 BETWEEN 1 AND 10) 理解が違ってたら教えてください。
変数をSQL実行タスクで使う場合は、タスクのプロパティのExpressionから設定をします。 変数名がTABLENAMEとすると、SQLStatementSourceに以下のように登録します。 "CREATE TABLE [" + @[User::TABLENAME] + "] ([CD] VARCHAR(10),[NAME] VARCHAR(20))" これでTABLENAMEに入った変数のテーブル名で作成できます。 ##test_tableを使ったSSISパッケージを複数同時に実行した場合、不具合が起こる可能性があるというのは正しいと思います。 それはグローバルの一時テーブルを使っているからで、ローカルの一時テーブルにすれば問題ないはずです。 #を１つ落として、#test_tableにすればよいと思います。タスク設定画面では選べないので、SQL実行タスクのプロパティから直接変更します。 >SSISを始めたばかりで　考え方自体がおかしいのかも知れません・・・。 全然おかしくはないです。ただ、SSISパッケージを複数パラレルで実行させるようなデザインは避けられるなら避けた方がいいと思います。
バックアップは取得できるけど、7:00でなくて、8:00に実行されてしまうということですか？ ・サーバの時間はあってますよね？（いちおう） ・タスクを右クリックしてスクリプトを生成してみると、以下のようにスケジュールを追加する 　部分があります。パラメータは以下のようになるはずです。なっていますか？ 　EXEC @ReturnCode = msdb.dbo.sp_add_jobschedule @job_id=@jobId, @name=N'(Name of Schedule)', @enabled=1, @freq_type=8, @freq_interval=62, @freq_subday_type=1, @freq_subday_interval=0, @freq_relative_interval=0, @freq_recurrence_factor=1, @active_start_date=(開始日yyyymmdd), @active_end_date=99991231, @active_start_time=70000, @active_end_time=235959 ・一度そのジョブを完全に削除して、再登録してみてください。
質問が良く分かりませんねぇ？ DBはストアドって書いてあるからSQL Server？ 単価、数量がテキスト型？ Accessはプロジェクト(ADP)？orMDBでリンク？ 分からない事だらけなので・・・ 欲しい回答になるか不明ですが SQL Server上でViewを作成し単価数量に関しては数値化しておくほうが良いのでは？ MDBならパススルークエリーで作成する方法もあると思います。 Cast(数量 AS decimal) AS SURYO, Cast(単価 AS decimal) * (Case When 区分番号 = '1' Then -1 Else 1 End) AS TANKA そして印刷時読込みSQL側で数量、金額をSUMしておく こんな感じでしょうか
日付型の内部表現は浮動小数点数ではありません。 内部表現は整数型で、fuuten_no_nekoさんの方法は「たまたまAccessでうまくいっている」だけにすぎません(Accessについては無知なので、Accessで試したわけではありません。Accessでももしかしたらうまくいっているように見えているだけで、本当はうまくいっていないかもしれません)。 SQL ServerはAccessよりも型に厳格なので、浮動小数点数の結果が欲しければオペランドの最低片方が浮動小数点数型である必要があります。 また、浮動小数点数型の演算には誤差が付き物ですので、全くすすめられる方法ではありません。 SQL Serverなら、DATEADDを使うのがもっとも適切な方法です。
Accessであれば直接SQL Serverにつなぎますし、都度セッションが確立されるので、以下の方法で呼び出した端末が特定できるはずです。 SELECT host_name FROM sys.dm_exec_sessions WHERE session_id=@@SPID
#1です。連投失礼します。 バックアップを取得したサーバーに再度触れるようでしたら、データファイルだけ持ってくるってのもアリかと。想像ですが、ログファイルも結構な大きさだと思うんで。 バックアップ取れる方ならやり方はご存知かも知れませんが… ・サーバー側で対象DBをデタッチ(しないとコピーできなかった気がします)。 ・サーバー側でデータファイルを好きなところにコピー。 ・サーバー側で対象DBをアタッチ。 ・PC側でデータファイルのみを指定してアタッチ。 > .mdfや.ldfをローカルのドライブ以外（NASなど） > に置いて、レストアするような方法はないでしょうか。 4～5年前にチャレンジしたときは確か無理だったかと…SQLServer側で\\マシン\C$\hoge…とかを理解してもらえなかったと思いますが…
お好きなほうをどうぞ。 ただ、テーブル名といい、カラム名といい、ほめられたものではありませんよ？ http://www.geocities.jp/mickindex/database/db_ma … このサイトを参考に勉強しなおしてみてはどうでしょう？ SELECT 　　T.SN 　, T.CD 　, T.DATE FROM 　　[TABLE] T WHERE 　　T.CD = 'A2' AND 　　　T.DATE = ( 　　　　SELECT MAX(T2.DATE) FROM [TABLE] T2 　　　　WHERE T2.CD = 'A2' AND T2.SN = T.SN 　　　) ; SELECT 　　T.SN 　, T.CD 　, T.DATE FROM 　　[TABLE] T WHERE 　　T.CD = 'A2' AND 　　　NOT EXISTS( 　　　　SELECT * FROM [TABLE] T2 　　　　WHERE T2.CD = 'A2' AND 　　　　　T2.SN = T.SN AND 　　　　　T2.DATE > T.DATE 　　　) ;
MDBでよく見かける「ローカルのワークテーブルにまとめて落してグリッドでメンテナンスさせる」というのの類似のことをやろうとしているのでしょうか？私はあまりそういうのはしないので、踏み込んだコメントは避けます（アプリケーションロックでしのいでいる例が多いかもしれないですね） ・元のテーブルにロックを掛けたいとのことですが、SQL Serverにロックヒントなどを使ってロックを掛けさせると、ロックされたリソースにアクセスした側は永遠に待ちになりますので、あとからアクセスした側は画面が真白になって使い物にならないと思います。で、SET LOCK_TIMEOUT 0とすればすぐにロックタイムアウトしますが、アプリケーションの修正を考えると現実的ではないでしょう。 メンテナンス中にロックを掛けたままトランザクションを維持し続ける仕組みも難しいです。 ・SQL Server 2005から動的管理ビューで、sys.dm_exec_sessionsというのが提供されていますので、「現在アクセスしているセッション」は見ることができます。見られるのはアクセスしているアプリーケーション名、ユーザ名、ホスト名などですが、テーブル単位・レコード単位でのアクセス状況がわかるわけではありません。 ・コントロールする単位がテーブルであったとしても、Oracleと違い、SQL Serverはテーブル単位で参照専用にすることはできません。更新を無効にするトリガを仕込んで、それをメンテナンス中だけ有効にするのがせいぜいかと思います。
SQL Serverのデフォルトの照合順序(Japanese_CI_AS)では、できないと思いますので、照合順序を変更します。 SET @after = REPLACE(@before, '濁点', '' COLLATE JAPANESE_BIN) Japanese_CI_ASは、大文字小文字、かな、全角半角を区別しないという意味ですが、区別したとしてもカナの濁点部分だけを認識させることはできませんので、バイナリ照合を指定するということです。
その表現だとどちらともとれるので、念のため伺いますが、そのSQL2008\sqlsrvというユーザはすでに存在していますか？ （インストール時に勝手につくられませんが）
#3回答者です。 jamshid6さんとのやり取りで解決できたとのことで、まずはよかったですね。 質問＆回答の横から入るような形になりましたが、「分析関数」や「WITH句による共通表式」（SQL Serverでは、再帰クエリも可）は非常に便利な機能なので、ぜひ勉強してみてください。 また、#3で示したように、CREATE TABLE文やINSERT文を貼り付けて、アドバイスしようとする側ですぐに利用できるようにしてもらえれば、より多くの人が、より効率的にアドバイスできるので、早く適切なアドバイスが得られる可能性があります。
SQL Server 2005 Expressのリモート接続はデフォルトではオフです。 http://support.microsoft.com/kb/914277/ja http://www.atmarkit.co.jp/fdotnet/dotnettips/545 … ネットワークの方もポートがブロックされている可能性があるなら、チェックしてください。
#3です。 > 縦には繋がっていません。 > OSもファイルサーバーもバラバラです。 ↑このあたりから ・各階専用のファイルサーバーがある。 ・別の階から別の階のLANにはアクセスできない。(例えば2Fから3Fに…は無理) …と理解しました。従って同じDBサーバーに対して、各階からデータの入力を行うということが不可能… 各階専用のファイルサーバーにDBを用意して…というのもできそうですが、各階のデータを集計する場合に質問者様にかかる負担を考えると、現実的でないと思います。 > 1台に入れ込み、みんなで入れ替わり使います。 お金のこと、LANなどインフラ周りを考えると、やはり1台のPCにアプリ、DBを設定する。そしてその1台をみんなが使う。というのが現実的な気がします。 開発環境はご自分でご用意できそうな雰囲気ですし、#1さんのご助言もとても参考になると思います。 本番環境はなるべくいいPCに。 できればXP、無理なら2000に(OSからPCの性能をなんとなく判断しています)。 そこに「SQL Server 2000 Express Edition」をインストール＆DB構築。 作られたアプリもセットアップ。 ※ひょっとしたら必要なMDACもインストール。 …といったところでしょうか。 いろいろと情報を提供していただいたにもかかわらず、この程度のご助言になってしまい、申し訳ありません。 開発の成功を願っております。 ↓MSの「SQL Server 2005 Express Edition」のURLになります。 【SQL Server 2005 Express Edition】 http://www.microsoft.com/japan/sql/editions/expr … ↓本番環境構築の際には必読です。「推奨システム要件」側をご参照ください。個人的にはメモリは最低1GB、余裕があれば2GBは用意したいです。 【SQL Server 2005 Express Edition システム要件】 http://www.microsoft.com/japan/sql/editions/expr … ↓ダウンロードはこちら。 【ダウンロード : SQL Server 2005 Express Edition SP2】 http://www.microsoft.com/downloads/details.aspx? … 【ダウンロード : MDAC 2.8】 http://www.microsoft.com/downloads/details.aspx? …
XP SP3ですか？KB954459は2008/11/10の配布ですね。私はここ数ヶ月はインストールはしていないので、あくまで情報提供として書き込みします。 同じ事象で死んでいる人はいるみたいです。 http://www.eggheadcafe.com/software/aspnet/33664 … ・XP SP3の場合、もしくはSP2にSP3を当てたケースでKB954459(MSXML6.0 SP2)がインストールされると、 　MSXMLがシステムファイルとしてプロテクトされるので、インストールが失敗する ・SQL Server 2008で同様の事象が報告されたときには、そこが失敗しても、SQL Serverのインストールには支障がないから、MSは直さないと言っている（らしい） 　http://connect.microsoft.com/SQLServer/feedback/ … 　SQL Server 2005については、今のところレスポンスはない 　https://connect.microsoft.com/SQLServer/feedback … ・最初のスレッドによれば、解決できた人はKB954459を抜いて、MSXML6.0を入れ直しているらしい。 　（単純に抜けないので、Windows Cleanup Installerで抜く）
これだけの情報で答えろといっても。。 でも、そのエラーはデータベースファイルもしくはログファイルのサイズが一杯になり、自動拡張できない(or自動拡張がオフになっている）ときに出る可能性があるみたいですよ。
公式ホームページの資料を活用しましょう。 エディション毎の機能比較がちゃんと載っています。 http://www.microsoft.com/japan/sql/prodinfo/feat … また、バックアップリカバリについても資料があります。 http://download.microsoft.com/download/a/3/5/a35 … GUIの使い方などは以下が参考になるでしょう。 http://download.microsoft.com/download/a/3/5/a35 … データベースの概念を理解した上でバックアップ・リカバリを 行なわないと後で痛い目をみます。 ※ちゃんとバックアップが取れていなかったり復旧できなかったり。 資料をよく読んでからテストしたうえで行なってください。
おまけです（内部結合の例） UPDATE 表A SET 列3 = '○', 列4 = '△', 列5 = '×' FROM 表A a INNER JOIN 表B b ON b.列1 = a.列1 AND b.列2 = a.列2 AND b.列6 = '□' WHERE a.列1 = '◎' AND a.列2 = '◎'
構造だけコピーしたいのなら、以下の方法ではだめですか？ SELECT TOP 0 * INTO 新しいテーブル FROM 今のテーブル ・同一DB内、同一スキーマ内、別DB間どれでもいけます。 ・TOP 0をつけなければ、データもコピーされます。 ・追加項目はテーブルのデザインで追加しますが、それすら大変なら 以下でもいいです。 SELECT TOP 0 CONVERT(varchar(1),NULL) 処理内容, CONVERT(datetime,NULL) 日時, * INTO 新しいテーブル FROM 今のテーブル
SQL Server 2005ならば、スキーマを分ける手はありますね。 スキーマは無意識にdboを使っていると思いますが、SQL Serverのセキュリティタブの中で作れます） スキーマが別でも同じDB内ならリレーションは張れますし、スキーマ単位にアクセス権限を指定することもできます。 また、スキーマが別なら同じテーブル名でも登録可能です。 今回の例だと、請求スキーマや仕入スキーマを作って、請求.T_○○、仕入.T_○○という風になるでしょう。 dbo以外のスキーマは省略できないので、検索はSELECT * FROM 請求.T_○○という風になります。 それはそれで使いづらい点もなくはないですが、管理上はすっきりします。
MSの正式なコメントではありませんが、以下のサイトに >An implementation decision was made to sacrifice some scale to gain more digits on the left side of the decimal point, up to a minimum of scale 6. So the numeric(77,20) is actually converted to numeric(38, 6). The same behavior happens for division. というスタッフのコメントがあります。 「有効桁数38を超えた場合の切り詰め処理は小数点第６位までを限度に行う」という仕様みたいですね。 参考URL：http://www.bokebb.com/dev/english/2011/posts/201 …
そうなんです。なくなってしまったみたいです。 GUIだけでやる方法はないかもしれません。 代わりの方法は、以下をそれぞれ実行して、結果を右クリックして「結果に名前をつけて保存」くらいでしょうか(csvになりますが)。 SELECT name FROM sys.tables WHERE is_ms_shipped=0 SELECT name FROM sys.views WHERE is_ms_shipped=0 SELECT name FROM sys.procedures WHERE is_ms_shipped=0 （条件がシンプルなのと、作成日時なども取りたいかもしれないので、上記をお勧めしておきます。データベースダイアグラムの機能を使っているとそれらも含まれてしまいますが、大きな問題はないはずですので）
information_schema.columnsビューで調べられます。 参考URL：http://msdn.microsoft.com/ja-jp/library/ms188348 …
SQL Serverのバージョンによって、ずいぶん変わるところです(特に2000までと2005以降)。 基本的にシステムビューを検索する方法しかありません。 1) INFORMATION_SCHEMAビューを使う(2000/2005以降とも) 　以下のビューを検索します。コードは変換されているので比較的使いやすいですが、情報は限られます。 　INFORMATION_SCHEMA.TABLES 　INFORMATION_SCHEMA.TABLE_CONSTRAINTS 　INFORMATION_SCHEMA.KEY_COLUMN_USAGE 2) オブジェクトカタログビューを使う 　SQL Server 2005以降と、2000以前で違います。 　(SQL Server 2005以降) 　sys.tablesテーブル情報 　sys.columnsカラム情報 　sys.indexesインデックス・制約情報 　sys.index_columnsインデックス・制約のカラム情報 　(SQL Server 2000まで) 　sysobjectsテーブル情報 　syscolumnsカラム情報 　sysindexesインデックス・制約情報 　sysindexkeysインデックス・制約のカラム情報 　これらのビューを使うときには、以下の組み込み関数も利用して内部IDを取得することが多いです。 　object_id('テーブル名') object_name(オブジェクトID) 　type_name(ユーザタイプコード) これらの中で一番厄介なのが、インデックスのとり方です。INFORMATION_SCHEMAからは制約の情報は取れますが、 インデックスの情報はとれません。 従って、2)の方法になるのですが、あまり簡単に取れないです。 　(SQL Server 2005以降) select object_name(ix.object_id), ix.name, ix.index_id, ix.type_desc, ic.index_column_id, c.name from sys.indexes ix inner join sys.index_columns ic on ic.object_id=ix.object_id and ic.index_id=ix.index_id inner join sys.columns c on c.object_id=ix.object_id and c.column_id=ic.column_id where ix.object_id=object_id('テーブル名') 　(SQL Server 2000まで) select object_name(ix.id), ix.name, ix.indid, case when ix.indid=1 then 'CLUSTERED' else 'NONCLUSTERED' end, ic.colid, c.name, (ix.status & 1) from sysindexes ix inner join sysindexkeys ic on ic.id=ix.id and ic.indid=ix.indid inner join syscolumns c on c.id=ix.id and c.colid=ic.colid where ix.id=object_id('テーブル名') and (ix.status & 96)=0 私の認識が間違っていなければ、上記の通りです。
どちらの知識も必要です。 頭脳と勉強力に磨きをかければ、どちらの資格も取得可能です。
文字コードがきちんと設定されないのでは？ユニコード設定になっています？ たとえば、%田%でヒットさせられますか？ （この場合は田中仙市もヒットしますが） そうであれば_は文字単位ではなくバイト単位でヒットしている可能性が ありますので、__(_が２つ)でヒットするかもしれません。 mysqlのバージョンや、文字コードの設定によって結果がかわってくる ので、適当な処理をいれてやることが必要でしょう。 実際のところ日本語のワイルドカード処理はあまりきちんとできない かもしれませんけどね
２つの日付が未入力のときには、SQLには''(ブランク)が渡されて、 AND 受注残.受注日>='' AND 受注残.受注日<='' となってしまい、結果何もデータが返ってこないので、 他に指定した条件に合致するデータを返したい とこういうことでいいですか？ 最初に、以下の部分は条件が重複しているので、片方だけにしてください。 AND 受注残.受注日 >= '2004/10/01' AND 受注残.受注日 <= '2004/10/11' AND 受注残.受注日 between '2004/10/01' and '2004/10/11' 1)テーブルの受注日が必須項目であれば、 AND 受注残.受注日>=ISNULL(NULLIF(CONVERT(varchar,'2004/10/01'),''),'1900/01/01') AND 受注残.受注日<=ISNULL(NULLIF(CONVERT(varchar,'2004/10/11'),''),'2099/12/31') と書くことで、2004/10/01と2004/10/11が入っていないときには、代わりに1900/01/01と2099/12/31が渡されるので、受注日以外の条件に合致するものが返されます。 もしくは、 AND 受注残.受注日>=(CASE WHEN '2004/10/01'='' THEN '1900/01/01' ELSE '2004/10/01' END) AND 受注残.受注日<=(CASE WHEN '2004/10/11'='' THEN '1900/01/01' ELSE '2004/10/11' END) 2)他に書いているようにやってもいいです。 AND ('2004/10/01'='' OR 受注残.受注日>='2004/10/01') AND ('2004/10/11'='' OR 受注残.受注日>='2004/10/11') 3)見たところ、VBか何かで組み立てたSQL文をそのまま貼っただけのようですね。 それなら、日付の条件がブランクなら日付の条件いれなくてもいいのでは。 If strDateF<>"" THEN strSql=strSql+"AND 受注残.受注日>='" & strDateF & "'"
つまり50バイト（半角50文字）しか保管できないということですね。 そこは4000とか8000とかにしないとだめですね。
この辺はチェックされたんですよね？解決した人はみんなCABファイルのマニュアルインストールをしているようですが、、 SQL Mobile Installation Problem on Device http://social.msdn.microsoft.com/forums/en-US/sq … [RESOLVED] Windows CE 5.0 and SqlCe - Can't PInvoke DLL 'sqlceme30.dll http://www.vbforums.com/showthread.php?t=464346
例を２つ示します（ROW_NUMBERはSQL Server 2005以降)。 SELECT DISTINCT A,B FROM 表1 a WHERE B IN (SELECT TOP 1 B FROM 表1 WHERE A=a.A ORDER BY (CASE B WHEN 3 THEN 1 WHEN 2 THEN 2 WHEN 1 THEN 3 WHEN 4 THEN 4 WHEN 5 THEN 5 ELSE 99999 END)) SELECT A,B FROM (SELECT A,B, ROW_NUMBER() OVER (PARTITION BY A ORDER BY (CASE B WHEN 3 THEN 1 WHEN 2 THEN 2 WHEN 1 THEN 3 WHEN 4 THEN 4 WHEN 5 THEN 5 ELSE 99999 END)) SEQ FROM 表1) tmp WHERE SEQ=1
普通に考えると、以下のようになりおますが、どうでしょう? select A.CD,A.NAME,A.KUBUN,B.NENGETU,B.DAY1,B.DAY2 FROM A left outer JOIN (SELECT B.CD,B.NENGETU,B.DAY1,B.DAY2 FROM B WHERE B.NENGETU = 200811) AS B ON A.CD = B.CD WHERE A.KUBUN = 1
#1です。 すみません。ntextでしたので、nvarcharに変換すべきでしたね。 update t_meisai set m_syohin = 'aa' where CONVERT(nvarchar(4000),m_syohin) = 'bb'
>group by以下については、転記する際にkingakuを飛ばしてしまいました。質問する側としては迂闊なことでした。 それです。GROUP BYのキーからkingakuを外してください。
「SQLServer management studio」は接続するSQL Serverを切り替えることができます。もし違うSQL Serverに接続したいなら、「ファイル」-「オブジェクトエクスプローラーを切断」にして、再度「ファイル」-「オブジェクトエクスプローラーを接続」してみてください。そのとき、どのSQL Serverに接続するのか、SQL Serverの名前を知っておく必要があります。通常は「コンピュータ名\データベースインスタンス」となっています。
件数次第ですが、1000～2000件までならば、Excelのデータを読み込んで、 "SELECT tmp.* FROM 　 (SELECT '値' A,'値' B, '値' C UNION ALL SELECT '値','値', '値' UNION ALL ...) tmp INNER JOIN (SQL Serverのテーブル) t ON t.A=tmp.A AND t.B=tmp.B AND t.C=tmp.C" という文字列を組み上げて実行するという手もあります。 これだと１クエリで全件チェックされ、返って来たものが重複しています。 （長い文字列なので、Mid$などを使って組み上げます） 組み上げた中のtmpに当たる部分は、頭に"INSERT INTO (SQL Serverのテーブル)" と付ければ、INSERTも１クエリでできます。 数千件以上あるなら、一旦ExcelのデータをSQL Server側のワークテーブルに入れた方がいいと思います。 入れてしまえば、重複チェック/チェック後のINSERTは１クエリでできます。
SQLの基本的な機能は、RDBMS間で大きな差がありません。しかし、いろいろな機能を使い始めるとRDBMSによる方言が意外とあったり、標準SQLへの準拠状況にも差があります。 また同じRDBMSであっても、バージョンにより大きく機能が違う場合もあります。 SQL Serverを用いた「SQLの入門者向け」サイトがあったので、紹介しておきます。 http://www.atmarkit.co.jp/fdb/index/subindex/tsq … SQLを机上だけで覚えるのは難しく、実際に使って試行錯誤する方がはるかに効果的です。 MySQLやPostgreSQLなど、オープンソースを使う方法もありますし、PCのスペックに余裕があるなら、SQL Serverも無料で使えるものがあります。 マイクロソフトのホームページで、「無料で期間限定で使える試用版」、「無料で使用期限のないExpress Edition」といったものがあります。 http://www.microsoft.com/japan/sql/default.mspx 「自習書」のダウンロードやノウハウなどの記事もあるので、活用してみるといいでしょう。
それはやはりメールセッションを有効にしたことが反映されていないと思います。 （サービス再起動前には確かにそのメッセージ出てました）
select top 1 * from tab1 order by [ランク],(評価3)*-1, (評価5)*-1
SELECT (A>B)がどうやってもエラーになる通り、方法はないと思います。 パラメータをintかbitにして、 SELECT dbo.UserFunction(CASE WHEN A>B THEN 1 ELSE 0 END) とでもやるしかないかと。
Oracle/SQL ServerともDBでファイルを保管することは可能です。 DBでの保管方式は通常複数用意されており、実際にファイルをデータストレージに保存する方法や専用ストレージに保存する方法、それ以外の方法もあります。 ファイルをDBに保存することの良し悪しは、立場と志向により意見が分かれますので議論する気はないのですが、保存しない方のメリットの例がすでに挙げられているようなので、保存する方のメリットをいくつかあげておきます。 （ちなみに私は基本的にDB保管するようにデザインするタイプです） ・フィールドの１つとして取り扱われるので、実ファイルの存在とデータの整合性をDB自体が保証する ・データベースバックアップにファイル自体も含まれるので、リカバリが容易 ・SQL ServerのReporting ServiceのようにDBに収録された画像ファイルをそのまま割りつけられるようなツールにも利用できる ・DB内にバイナリ保管してしまうと、手順を踏まないとファイルに戻せないので、物理的なセキュリティ対策には有効 MicrosoftのSharepointなどがドキュメントをデータベースに保管している例です。
#1です。もう一つ代案を書いておきます。 質問者さんは、「テーブル作成SPを作って共用する」ということを考えておられるので、ストアドを１つ作る代わりにテンプレート用の実テーブルを１つ作るのも手かと思います。 ・一時テーブルのレイアウトのテーブル(TEMPLATETBL)を準備 ・一時テーブルを使うストアドでは、作成用のストアドを呼ぶ代わりに以下を実行する SELECT TOP 0 * INTO #TEMPTBL FROM TEMPLATETBL 効果はたぶん同じです。 （DROPはDROP TABLE #TEMPTBLですが、先に書いた通り無理に実行しなくても基本的に自動でDROPされます）
なるほど。原因わかりました。 標準モジュールのシート名も「getblock」にしていますね。何でもいいのでここを「getblock」以外にしてみてください。 ＃プライベートリンクは禁止されているはずなので、上記リンクは後で削除がかかるかもしれません
こんにちは。 環境設定をした記憶はあまりないのですが、そのエラーメッセージですとPATHが通ってないですね。 (インストールフォルダ)Microsoft SQL Server\90\Tools\Binn にPATHを設定してください。このフォルダの中にsqlcmd.exeが入っているはずです。
プログラムからアンインストール出来ない場合は直接実行ファイル等を削除してもレジストリに残っていたりします。 再度インストールし直してから「プログラムの登録と削除」を行って下さい。
これはチェックされていると思いますが、 http://msdn.microsoft.com/ja-jp/library/ms143532(SQL.90).aspx 併せてこちらもチェックしてください（2005にする以上、2005の機能も使いたいでしょうから） http://msdn.microsoft.com/ja-jp/library/ms178653(SQL.90).aspx 使っている機能にもよりますが、あまり上記のうち深刻なものは私の場合はありませんでした。 ただし、上記に書かれていませんが、私が一番ハマったのは「VIEWのTOP 100 PERCENTが効かなくなる」です。
たぶんデータソースの定義が壊れた？かもしれないのですが、 ＳＳＭＳで接続できているのであれば、VisualStudio2005で直接そのデータベースに接続して編集することが可能です。 接続方法は、VisualStudio2005→ファイル→開く→Analysis Services データベース→データベースを選択 接続すると、データベースの定義をVisualStudio2005に取り込むことができます。 これで、集計デザインをしてみてください。 私は、いつも直接データベースを編集しています。ＳＳＡＳのソースは 壊れることがよくあったもので・・・・
・まずtable1のtestというフィールドは、char,varchar,nchar,nvarcharのいずれかのデータ型であることを確認してください。 ・文字列の場合はシングルコーテーションで括ってください。str= "INSERT INTO table1 (test) VALUES("+data+")"; => str= "INSERT INTO table1 (test) VALUES('"+data+"')";
もともとSQL Serverのセキュリティ管理はそんなに複雑ではありません。登録のやり方も特に問題ないようです。同じことは当方でやっても起こらないですね。。 ログインからユーザを削除したときに、それを割り当てていたデータベースからも個別に削除を行いましたか？ あとはなんでしょうねぇ。
SQL Server Management Studio Expressは入っているのですね？ （入っていなければダウンロードしてインストールすることをお勧めします） そこからセキュリティ－ログインで、今アクセスに使おうとしているユーザのプロパティを開き、「ユーザマッピング」で参照したいデータベースに参照権限が付いているかどうかご確認ください。
同じスキーマというのがSQL Serverのインスタンスに相当するとして。。 AccessではDB1に接続、DB2のTBL1を参照する場合、 1)テーブル参照の表記をDB名.スキーマ名.オブジェクト名にすれば、SQLの発行は可能 SELECT * FROM DB2.dbo.TBL1 2)このようなテーブルの直接参照をadpが認めてくれない場合、接続先のDB1にそれを参照するオブジェクトを作って参照すればよいです。 （VIEWでも更新条件を満たせば更新可能なのはご案内の通り） CREATE VIEW VIEW1 AS SELECT * FROM DB2.dbo.TBL1 極端にいえば、同じスキーマになくても、あらかじめSQL Serverでリンクサーバを設定しておけば、 CREATE VIEW VIEW2 AS SELECT * FROM SERVER2.DB3.dbo.TBL1 として同じことが可能です。 ストアドプロシージャも同様です。 mdbでリンクテーブルを張る場合には2)の方法が一般的です。 これらをadpから作ったことはないので、このようなViewやストアドをadpから作らせてもらえるかどうかは今は確認できませんが、仮にAccessから作成できなくても、あらかじめSQL Server Management Studioで作成しておけば、そのオブジェクトは問題なく使うことができるはずです。
うーん、2000ではデータ型変更はできなさそうですね。 ADDとDROPを組み合わせてカラムを作りなおすしかなさそうですが、それならパブリケーションを作りなおした方が楽ですよね。
>Reporting Serviceは、おそらくインストール済みです。 そうですか。こちらでも試してみましたが、インストール可能にはなりませんでした。 でも、インストール済であるということなのであれば、 1)ASP.NETとIISをインストールして、サービスを上げます。 2)SQL Server2005-構成ツール-Reporting Service構成を起動 　Reporting Serviceがインストール済でサービスも起動していれば、自動的に有効なインスタンスを探し出して表示してくれますので、選択して接続します。 3)上から順番に設定していきます。 3-1)レポートサーバ仮想ディレクトリ（新規作成：ReportServer） 3-2)レポートマネージャ仮想ディレクトリ（新規作成：Reports） 3-3)WindowsサービスID（設定済ならそのまま） 3-4)データベースのセットアップ（接続して、新規作成：ReportServer） 　上記以外は設定必須ではありません。 それで完了です。 インストールは通らないので、インストール後にIISを削除して、入れ直し、それから設定しても問題ありませんでした。 （昔やっていたのは、Reporting Service自体を後で追加インストールするケースでした） あとはとにかくやってみるだけでは？ ちなみにトラブルシューティングのページは以下です。 （特に構成エラーのトラブルシューティングは見ておいてください） http://msdn.microsoft.com/ja-jp/library/ms159135(SQL.90).aspx ReportingService2005の場合、入口の段階より、Sharepointも使っている環境ではそれ以外の理由でレポートマネージャがエラーになったり、エクスポートがハングしたり、印刷できなくなったりと、あとの方が厄介だったりします。
あくまでも（経験に基づく）私見ですが、書かれている内容は正しいです。それらの関数はSQL Serverで解釈できるようにOLEが変換できないので、ACCESSのあるクライアント側までデータを引っ張ってこないと判断できないです。必然的にトラフィックは増えます。 同じようなことが、リンクテーブルとローカルテーブルのJOINや、クエリ内でテーブルを参照するタイプのACCESSユーザ定義関数を使用するケースなどでもいえます。 Accessももともと閉じたデータベースとして使えるものですし、便利な機能がたくさんありますが、ACCESS外のDBMSで管理するデータを扱う場合はパフォーマンスを考えればデータのある側で処理するに越したことはないでしょう。 ネットワークのトラフィックを減らすためには、書き換える方法は別にストアドプロシージャでなくて通常のクエリでもかまわないので、少なくともデータ抽出に関しては純粋にSQL Serverが解釈できるSQL文を投げて、必要十分な結果だけを受け取るようにすることでしょう。 （具体的にACCESSがどんなSQLをSQL Serverにリクエストしているかを確認するためにSQL Serverプロファイラを活用することをお勧めします） ちなみに突き詰めていくと、すべてのDBアクセスをパラメータ付のストアドプロシージャだけで行うという方向性になると思います。Webアプリなどはこういうアプローチも多いです。
それならこうすればどうでしょう？ IIF(TRIM("" & [C_html_text]![4_1] & [C_html_text]![4_2] & [C_html_text]![4_3])="","",[T_shop_additional3]![tg6]) & MID(IIF(TRIM("" & [C_html_text]![4_1] & [C_html_text]![4_2] & [C_html_text]![4_3])="","<BR><BR>","") & IIF(TRIM("" & [C_html_text]![4_1])="","","<BR><BR>" & [C_html_text]![4_1]) & IIF(TRIM("" & [C_html_text]![4_2])="","","<BR><BR>" & [C_html_text]![4_2]) & IIF(TRIM("" & [C_html_text]![4_3])="","","<BR><BR>" & [C_html_text]![4_3]) & IIF(TRIM("" & [C_html_text]![4_1] & [C_html_text]![4_2] & [C_html_text]![4_3])="","","</FONT>"),9) Replaceは使わなくても済むなら使わない方がよいです（全体に対して改めて文字列走査を掛けるのは非効率です）。
ADは使わないということでしたので、こちらでもローカルユーザ同士で最後まで設定してみました。 1)サーバA、クライアントBにいずれもローカルユーザSSASUSRを登録し、パスワードを同じにします。 2)サーバAでSSMSからSSASに接続し、A\SSASUSRにインスタンスの管理者権限をつけます。 3)クライアントBにB\SSASUSRでログインし、サーバAのSSASに接続できることを確認します。 4)サーバAにA\SSASUSRでログインし、DMアドインのサーバ構成ユーティリティを開き、設定を行い、DMAddinsDBを作成します。 5)そのままサーバAでSSMSを開いてSSASに接続し、DMAddinsDBのロール（ExcelAddins_Role_...) のメンバシップにA\SSASUSRを追加します。 6)サーバAのインスタンス管理者からA\SSASUSRを外します。 7)クライアントBから、DMアドインのサーバ構成ユーティリティを開き、設定を行いますが、新規DBは作成せず、既存のDBとしてDMAddinsDBを指定します。 8)クライアントBから、DMAddinsDBに対して管理者として使えることを確認します。 確かにおっしゃっていたマッピングエラーは、6)で新規DBを作成しようとすると出ました（ようやく。。） しかし、既存DBに権限を与えてから接続させると問題なく稼働しました。 メンバシップ画面やインスタンスのセキュリティ画面では、メンバの追加は手打ちではできませんので、結局いずれもA\SSASUSRを登録することになります。それで問題ないようです。 もともとDMアドインは、そこから先使いこなすところがキモなので、うまくセットアップが完了することを祈っています。
質問の意図が不明ですが、mdfはデータベースそのものです。 SQL Serverというデータベースエンジンで作成されるデータベースのデータはすべてここに収録されています。
#2です。参考リンク貼り忘れました。 http://support.microsoft.com/?kbid=920700
SQL Server 2005になったときに待機系サーバに課金しないポリシーを導入しています（たしかそれまでは必要だったはず）。 したがって、サーバライセンスなら問題なし、プロセッサライセンスならCPUの数が同じかそれ以下なら問題なしです。 同時にデータベースとして利用されないことが条件なので、基本「待機系とはいえ遊ばせているのは勿体ない」と考えないことです。
サーバライセンスがないとインストールができないですが、CALがないとか不足していたということで接続できないということはないはずです。もともと契約上の概念なので、必要数だけ買わなければ違法というだけだと思います。 SSASのデータマイニングに関する情報はMSのサイトだけでなくあります。私はどちらかというと本（洋書ですが）の方で勉強しました。 ＞SQLserverとエクセルを同一パソコン上に置いたものでのみの説明 「SSASをリモートで使う」ということを難しく考えすぎていませんか？SQLサーバのリモートアクセスを正しく認めればいいだけです。別にSSASに限ったことではありません。 むしろ具体的なマイニング技法の理解とその設定の方法を理解する方がはるかに重要なんではないかと思いますが。
(1)のDBコネクションの設定については、以下のURLに記述してあるパラメータの解説と 最後の方にある接続文字列の制限事項に引っかかっているのではないでしょうか？ http://technet.microsoft.com/ja-jp/library/ms173 … 要は、パスは絶対パスで指定し、パス中に空白があるなら引用符(')で囲みなさいと。 (2)の質問は分かりません。
前の処理が不明なのでなんともいえませんが、そのRecordset.Openの第一パラメータ(CommandText)がコマンド文字列、または、ストアドプロシージャと評価するようになってしまっているようです。 もし、そのようにテーブル名だけを記載して評価させたいのであれば、オプションパラメータで強制的にテーブル名であると認識させればよいかと思います。 oRS.Open "TBL_NAME", 接続情報, 3, 3, 2 末尾の2はadCmdTableです。
私も実際にそういう使い方をしたことはありませんでしたが、確かに インライン関数はビューと同じ基準で更新可能な内容であれば、更新できるとmsdnにも書かれていました。 従って、その使い方は別に変ではありません。 （が、パラメータを切らない限りはビューと比べてうまみもありません） ただし、この使い方はあくまでもインライン関数(戻り値にテーブル変数を使わずダイレクトにリターンする)のみ可能ですので、その点だけはご留意ください。
「データベースに接続できません」から「ユーザー'sa'はログインできませんでした」に変わっていますね。。 考えてみましたが、一般的な設定には特に問題は見当たらない上に、「ログインできませんでした」ということはデータベースは見えているということですから。 そうすると、管理メニューにあるSQLサーバログにはログインに失敗したログが書かれているはずです。その内容により、なぜログインが失敗したか、メッセージおよび状態コードで判断できることがあります。 http://msdn.microsoft.com/ja-jp/library/ms366351(SQL.90).aspx また、他のsysadminユーザを新規作成して、そのユーザでも試してみるとsaだけが問題なのかも判断できると思います。
SQLは基本条件に合致した行を抽出するものですので、今回のように別の行をAND条件で括るのは、シンプルにはできません。 どれでもできるはずなので、理解しやすいものをお使いください。 1) ID別にデータを１行にしてから処理する SELECT ID FROM (SELECT ID, MAX(CASE WHEN 質問番号=1 THEN 回答 END) 回答1, MAX(CASE WHEN 質問番号=2 THEN 回答 END) 回答2, MAX(CASE WHEN 質問番号=3 THEN 回答 END) 回答3 FROM TEST_TABLE GROUP BY ID) tmp WHERE 回答1='回答例1' AND 回答3='回答例3' 2)上記の変型 SELECT ID FROM TEST_TABLE GROUP BY ID HAVING MAX(CASE WHEN 質問番号=1 THEN 回答 END)='回答例1' AND MAX(CASE WHEN 質問番号=3 THEN 回答 END)='回答例3' 3)ID/質問番号が主キーであるとして、合致した行の数で抽出 SELECT ID FROM TEST_TABLE WHERE (質問番号=1 AND 回答='回答例1') OR (質問番号=3 AND 回答='回答例3') GROUP BY ID HAVING COUNT(*)=2 4) サブクエリを使う SELECT DISTINCT ID FROM TEST_TABLE WHERE ID IN (SELECT ID FROM TEST_TABLE WHERE 質問番号=1 AND 回答='回答例1') AND ID IN (SELECT ID FROM TEST_TABLE WHERE 質問番号=3 AND 回答='回答例3')
master DBはサーバレベルの情報を持っています。 他のDBからmasterファイルを持ってきて起動させるのは問題有りません。 上書きだと心配だと思いますので、以下の要領でバックアップを取って下さい。 現状インスタンスが立ち上がっていないと推測できるので、 現状のmdf，ldfファイルを物理的にバックアップ（ファイルのコピー）を取って下さい。 ※前回の書き込みの手順です。 とはいえ以下のエラーが出ているので、恐らくSQLServerのDBの異常によるものではないかと思います。 「Service Principal Name」エラーと出ています。なのでDBレベルではなくインスタンスレベルの問題だと推測できます。なのでmasterDBの対応を行なったとしても解決にはならないと考えられます。 よってまずはエラーの出ている箇所を率直に受け取りSPN部分の障害を取り除けばよいかと考えられます。 「The SQL Network Interface library could not deregister the Service Principal Name (SPN) for the SQL Server service. Error: 0x54b. Administrator should deregister this SPN manually to avoid client authentication errors.」 ※本番環境であれば気軽に？アプリケーションの追加は宜しくありません。今回の問題は恐らく後からインストールしたアプリケーションが悪さをしてしまったためかな？と考えられます。 （サーバの重要度がどれ位なのか分からないので一概には言えないのかも知れませんが・・・） 本来であれば検証環境で同等の確認後に本番に適用できたらよかったですね。
ストアドプロシージャというものの性質を理解する必要があると思います。 確かにストアドプロシージャの中にSELECT文を書けば、結果を返してくれますし、それをデータソースに使うことはできるでしょう。 ただし、テーブルやビューが更新可能（ビューは条件付）であるのに対し、ストアドプロシージャやテーブル関数が返すレコードは データ処理後の単なるデータ集合にすぎない（元テーブルとの関係から切り離されている）ため、それに対して更新を掛けるという 発想自体に無理があります。 試したわけではないですが、NewRecまではAccess側での処理にすぎないので、うまくいっているように見えるということではないかと思います。 更新する場合はテーブルやビューを使うか、全項目をパラメータにした更新用ストアドプロシージャを準備すべきでしょう。
通常SQL Serverの権限はデータベース／ユーザ単位につけるもので、個別のテーブルに権限をつけることは極めて稀です。 また、SQL Serverにはテーブル単位で読み取り専用にする機能もありません。 実際に更新権限をはずしても、表示されるメッセージは異なります。 ということで、ずいぶん悩みましたが、可能性が１つありました。 そのテーブルには主キーがなく、しかも、主キーを指定しないままリンクしたのではありませんか？ 主キーのないリンクテーブルは更新できません（ODBCドライバの仕様上）。 その点を確認してみていただけますか？
ルータがTCP1433をブロックしているのではないでしょうか。 参考URL：http://support.microsoft.com/default.aspx?scid=k …
デッドロックが原因であれば、 SELECTだけの方は SET LOCK_TIMEOUT 10000 （ミリ秒） 等を利用して設定値を小さくしエラーにしてみたらどうですか？ 逆にデッドロックが原因ではない場合は 設定値を大きくし、エラーが発生しないように待つ設定にしてみたら如何でしょうか？ 経験上ですがSQLServerの場合ロックのエスカレーションのせいでいきなりデッドロックが発生する事があります。 エスカレーションのせいでテーブルロックにまで膨らんだりします。 （以前プレミアサポートに確認したら時はPKeyやindexを指定していればありえないと言っていましたが、発生してしまっていました。） 実行中にロックレベルやロックの状態を確認するとはっきりとするかもしれませんね。 ※2008では設定でエスカレーションを外せるようにはなってるみたいですね。 更新を伴うSELECTだとしたら、処理の順番を統一しているか確認が必要かもしれません。 処理の入り口で同じテーブルにテーブルロックをかけるように命令すれば確実にデッドロックは発生しなくなると思います。 （必ず待ちが発生し処理を平行して行えなくなるデメリットは発生します。）
sys.columnsが見えているだけに権限の可能性は低いと思いますが。。 ・ユーザDBのビュー→システムビューの中にINFORMATION_SCHEMAシリーズのビューはありますか？（みえますか？） 少なくともsys.columnsなどは見えると思います。 ・インストールするとき照合順序を変更しましたか？ INFORMATION_SCHEMA.COLUMNSを全部大文字にしてもエラーになりますか？
#1です。 できませんだけだと何なので、きわめて限定的ですが、Transact-SQLの一時ストアドプロシージャを使う例を参考までに示します。 ローカルサブプログラムは作れないので、ストアド内で一時ストアドプロシージャを作って完了後にドロップします。 CREATE PROCEDURE sp_test AS BEGIN SET NOCOUNT ON DECLARE @sql varchar(8000) SET @sql = 'CREATE PROCEDURE #wkFunc (@P varchar(20))' +' AS BEGIN SET NOCOUNT ON SELECT @P+@P END' EXEC (@sql) EXEC #wkFunc 'A' SET @sql = 'DROP PROCEDURE #wkFunc' EXEC (@sql) END ・ストアドのみ可能です（関数はできません） ・本体のストアドプロシージャはコンパイル時に一時ストアドプロシージャがないといけないので、先に作成してからコンパイルします。 ・一時ストアドプロシージャはセッション内でのみ有効なオブジェクトで、セッションが切れたら消えますが、念のためDROPしています。 まあ、これが限界かと。
>追加情報: ファイル C:Documents and Settings yukenMy Documents est2.mdf の自動的に名前が付けられたデータベースをアタッチできませんでした。 このメッセージを見る限り、明らかにmdfのパスを C:\Documents and Settings\yuken\My Documents\est2.mdf とされていますね。VC++の場合、接続文字列をただコピペしてもだめです。 VC++であれば、C:\\Documents and Settings\\yuken\\My Documents\\est2.mdfという風に「\」を重ねて書かないといけないのではないですか？ （こちらでやっても、「\」１つでは同じエラーがでますよ） ついでにマイドキュメントではなく、C:\TEMPなどもっとパスが短いところで試してみてください。 （もともとマイドキュメントは権限が本人にしかないので、権限が理由のときに切り分けが難しくなります）
ハードの修理が可能であれば修理してください。 ハード修理後に「DBCC CHECKDB」でデータベースが修正可能ならよいのですが。 最悪はバックアップから戻すしかないかもしれません。
＃２です。 ＞D_TBLとその他の関係が逆（right で D_TBL）以外は＃１さんので行けると思います。 ＞D_TBLが全件になるので、 ＞軸となるD_TBLを先に書いて、 ＞そこに残りすべてを結合した結果をleftするのでも良いと思います。 勘違いです。逆の逆にしてしまっていました。 やっぱり、＃１さんのであってます。
ネットワーク（ＬＡＮ通信）は、正常ですか？
＞SELECT ROW_NUMBER() OVER (ORDER BY ID) SEQ,* FROM TABLE ROW_NUMBERは分析関数と呼ばれますが、 「ROW_NUMBER () OVER (ORDER BY ID)」と書くことで、戻りのレコードをID別に並び替えた場合の連番を返してくれます。 これをメインのクエリで使うために、私が勝手に「SEQ」という名前をつけているとご理解ください。
テーブルの列数（カラム数）ですか？、行数（レコード数）ですか？ レコード数には基本的に制限はありません。Express Editionの場合はデータベースが4GBまで、という制約があります。 カラム数ですが、Editionに関係なく制限は1,024です。 ただし、それと同時に１行の上限が8,060バイトという制限があります。 従ってcharやintのような固定長フィールドで定義した場合、まず先にこちらの制限にかかると思います。 一方、varcharなどの可変長フィールドの場合は、１行の上限を超過したときに行オーバーフローページに書き出すことが できる仕組みになっているため、8,060バイトに含まれるのは固定２バイト＋行オーバーフローページへのポインタ24バイトの 計26バイトになります。別途必要な内部オーバーヘッドも考慮すると可変長のみでの最大フィールド数は307になるようです。 なお、テーブル列を追加する場合、再作成しないでALTERした場合、ALTER前の長さも上記制約上カウントされてしまうはずです。 参考になれば幸いです。
ＤＢに限らず、紙で管理する場合でも、 例えば、「売上伝票」のような物には、 どのお客さんに売ったか、とか、どの 商品を売ったか、などの情報を、 「顧客コード」や「商品コード」などの、 簡易化した情報を載せますよね。 で、これらのコードを伝票とは別に管理 する管理台帳が必要な訳です。 ・顧客コードと顧客情報を結びつけるための 　顧客管理台帳 ・商品コードと商品情報を結びつけるための 　商品管理台帳 こう言ったものを「顧客マスタ」「商品マスタ」 と呼び、一般的に「マスタ」と言います。 因みに、ここで言う「売上伝票」のような ものは、「マスタ」に対して「トランザクション」 と呼びます。
ここは意見が分かれるところかもしれませんし、そこまでソリューションエクスプローラを使いこなしている自信もありませんが、私の考えでは全部YESです。開発者かDBA向けの機能でしょう。 ちなみに、エンドユーザにSSMSを渡してどんなSQL書いてもいいよというのは結構危険だと思っているので、私はSSMSはエンドユーザには使わせていないです。 ソリューションエクスプローラが意外と使いづらいというのは前にも書いたとおりです。 ご参考になれば幸いです。
>二バイト文字を使わない場合ですが、大文字小文字を 使い分けていますか? 命令は大文字とか、項目名の先頭は大文字で始めるとか 完全に好みの問題だと思いますよ。正直、人それぞれだと思います。 私は、といえば全部大文字にしています。複数の開発メンバーで作業したときに標記がブレる可能性が高いから、そのような標記ルールにしています。一方で、単語の切れ目が分かりにくくなるため、「_」を入れることが多くなるのがデメリットです。
このＵＲＬが疑問の答えになっているのではないでしょうか？ 一般に”共有”はデータを相互に操作出来る環境で、 その方法とは別に、 ＳＱＬServerのような一般のＤＢはデータ操作を提供するサービス ですので、共有とは別物と考えたほうがよろしいかと思います。 参考URL：http://www.llc-com.co.jp/software/sql.html
MDBのリンクテーブルですら、SQLサーバに存在するテーブルに対してSELECT文を実行して全件を取得し、Access側でデータを抽出する、ということはありえません。 ましてやADPは実質SQL Serverに対して操作するようなものですからね。 実際にAccessがSQL Serverにどのようなコマンドを発行しているか、SSMS付属のSQLプロファイラで監視してみるとわかります。 「SELECT ..... FROM テーブル１ WHERE ...... ORDER BY .....」とACCESSのADPのリストにのデータソースに指定して 実行してみると、これがそのままSQL Serverに送られます。 ですので、オブジェクト内でのソートにこだわっていた理由がそこにあるなら、心配せずにadp側でWHERE句やORDER句を切っていただいて構わないと思います。 なお、質問者さんの書かれたdboというのは、（厳密な表現ではありませんが）テーブルの所有者を示す「スキーマ名」というもので、これにより処理の内容をわけるようなものではないです。
No.1です。 >SQLServer2005_SSMSEE.msi >SQLServer2005_SSMSEE_x64.msi >のどちらをダウンロードすればいいのでしょうか？ （OSはXPホームSP3） x64とついているのは64ビットマシン用です。お使いのPCは、まず32ビットだと思うので、SQLServer2005_SSMSEE.msiの方を使ってください。 （念のため確認するなら、コンピュータのアイコンを右クリックしてプロパティをみてください）
SQL Server Management Studioで「接続」を１回だけして、目的のデータベースが並んで見えるならば、それが同一インスタンスにいるということです。 どうも書いている様子からはそもそもインスタンスは１つしかないようですね。何も設定しなくても、データベース名まで含めて指定すれば、見られると思いますよ。
>http://support.microsoft.com/kb/936305/ ↑の先頭にある「修正プログラムのダウンロード」だと 64bitの環境しかありません、32bitのパッチは何処にあるのでしょうか? これは気づきませんでした。32bit版だけ提供を打ち切っているのですね。その場合は累積プログラム３以降を使えばよいです。 http://support.microsoft.com/kb/939537/ ちなみに累積プログラムは文字通りそれまでのパッチが含まれます。 （すでに累積プログラムは９まで出ています） >ビューは細工をせずに使い、細工する場合はテーブル値関数を使った方がいいと言うことでしょうか? 基本的にはその通りです。もし極力すべて（抽出も並び替えも）をサーバ側のオブジェクトに含めて処理してしまい、Accessは表示に徹するという考えなら、むしろストアドプロシージャを使う方がよいと思います（TOP 100 PERCENTをあてにする必要もなくなりますし）。 まあ、adpとの相性やそれ以外の使い勝手もあるでしょうから一概にはいえませんが。まあいろいろ試してみてください。
Microsoft SQL SERVERは、無料のものもあるし、有料のものもある。 値段に応じて制限が減っていく 2005の比較表 http://www.microsoft.com/japan/sql/prodinfo/feat … 2008の比較表 http://msdn.microsoft.com/ja-jp/library/cc645993 … 無料のEXPRESSエディションなら、ダウンロードしてインストールできます 勉強や小規模なもの（で機能が足りる）ならEXPRESSエディションで試してみて、必要に応じて有料の上位エディションを購入すればよいかとおもいます
gawein193さん 結果はいかがですか？
ドキュメントを読んだのに試していないというのは、試す環境をお持ちでないということですか？ 「できなくはない」というのはAgent Jobはスケジュール実行の目的で使うことの方が圧倒的に多く、 管理者以外に権限を渡す方が少ないと思っているから、そう書いたまでです。 （私自身も実務では管理者以外に権限を付与していません） まあ、これは多分に主観が入っているので、他意はありません。 管理者以外の人でもSQLAgentUserRole以上を割り当てれば、SQL ServerエージェントにSSMSから アクセスできるようになります。SQLAgentUserRoleであれば自分で作ったJob以外は見えませんし、 実行もできます。 もちろん、実行する内容自体に権限がない（ストアドやVBSを実行する権限がないなど）場合は実行してもエラーになるだけですが。
データベースを右クリックして「タスク→データのインポート」ってやっているのですよね？ （そのデータインポートおよびエクスポートウィザードで、データソースにフラットファイルソース、変換先にSQL Serverを使用してインポートしているのだと思っていますが） 私が書いているのは、そのウィザードの設定画面の「詳細設定」画面の話です。 もし違う方法でインポートしているのであればどうやってインポートしているか教えて頂けますか？
これも本来 SQLServerを他のマシンから参照可能にする手順ですが、 スタートメニュー 　⇒ Microsoft SQL Server 2005 　　⇒ 構成ツール 　　　⇒ SQLServerセキュリティ構成 『サービスと接続のセキュリティ構成』を選んで 　⇒ DatabaseEngine 　　⇒ リモート接続 ローカル接続およびリモート接続、TCP/IPのみを使用する。 てな手順ではいかがでしょうか？
誰でもこのエラーが出るわけではないようですが、同様のエラーの報告はMSのフォーラムでもいくつもログされています(VS2008SP1でも)。 もしかしたら不具合なのかもしれませんが、公式にアナウンスされているものはないようなので、詳細はわかりません。 結局、VWD2008がSQL Server2008用のSMO(SQL Server管理オブジェクト)を使おうとしているのが原因なので、実効性のある対応としては、使う使わないに関わらず、 ・SQL Server 2008 Express with Tools http://www.microsoft.com/downloads/details.aspx? … ・SQL Server 2008 Express with Advance Services http://www.microsoft.com/downloads/details.aspx? … ・SQL Server 2008 Feature Pack http://www.microsoft.com/downloads/details.aspx? … のいずれかをインストールすることくらいしかないようです。 ちなみに、私はXP SP3でしたが、このエラーはでませんでした。
主キーにすると複数の列に対して重複がないようにチェックができます。例えば住所録で「氏名」と「住所」を主キーにして同姓同名や同住所を許容しつつ二重登録をなくすことができます。インデックスではこのようなことはできないと思います。
SQLServer では、 SELECT フィールド1, CASE WHEN MIN(フィールド2) < 0 THEN 'NG' ELSE 'OK' END AS 結果 FROM テーブル1 GROUP BY フィールド1 フィールド1結果 ANG BOK Accessは、CASEが使えませんので、IIFを使います。
Visual Studio Expressは2005もそうでしたが、2008でも接続方法が限られるようですね。 SQL Serverにつなぐためには、質問者さんが試された方法（アタッチといいます）しかありません。 これは、SQL Serverから「切り離した」データベースファイルに都度接続するよう設定する方法です。 SQL Serverで作成したデータベースファイルは、SQL Serverが稼働している(=サービスが上がっている)間は、SQL Serverが「常に使用中」という状態になります。したがって、切り離さないといけません。 切り離すためには、SQL Server Management Studioで対象のデータベースを選択して右クリックし、「タスク」=>「デタッチ」を選択します。 その後で再度接続を試してみてください。 もちろん、切り離した状態ですから、同時にSQL Server Management Studioからは見ることはできません。 Visual Studio Expressではこの方法しかないので、有償のEditionを買わない限り仕方ありません。
テーブル２つ程度なら、これでもいいかと思います。 SELECT (SELECT COUNT(*) FROM AA.TBL01) TBL01, (SELECT COUNT(*) FROM BB.TBL02) TBL02
（今確認中かもですが） 前回の解答でも言いましたが、Case2で追うといいと思います。 理由は単純に「2回目のループで」「エラーが発生する」からです。 たとえばこんな感じのコード（これでは動かないかもですがそのあたりは適当に修正してください）で、 for i=0 to 6800 pCmd.Parameters("@i_ParamA1").Value = strVALA1(i) pCmd.Parameters("@i_ParamA2").Value = strVALA2(i) pCmd.Parameters("@i_ParamB2").Value = strVALB2(i) pCmd.Parameters("@i_ParamC2").Value = strVALC2(i) 'debug(S) Dim RS as recordset set RS = ("Select * from tableA" の結果) '******ブレークポイント********** 'debug(E) localConnection.execute next で、上記ブレークポイントで2件目のInsert直前で 1. レコードセットRSの状態（件数が1件なのか、キー列の値は？） 2.（strVALA1(i)ではなく）pCmd.Parameters("@i_ParamA1").Valueの値 を確認した場合、「素直に考えたら」キーが重複するような状態になっているはずです。 どういう状態になっているでしょうか？ あと、エラーが発生する場合、そのメッセージはどういう形になるのでしょうか（極力正確に） #それでもだめなら中間テーブル経由するとか代替案を考えるしかないんじゃないかと。
sqlcmdでmdfをアタッチするバッチファイルを作成すればできるのでは？ sqlcmd -Sサーバ -E -Q"CREATE DATABASE testdb ON (FILENAME='mdfファイルのフルパス') FOR ATTACH"
以下のようなスクリプトでもチェックできるかな dim cn dim rst dim re set cn = createobject("ADODB.connection") set rst = createobject("ADODB.recordset") set re = createobject("VBScript.RegExp") re.pattern = "^\(\d+\)\d+-\d+$" cn.ConnectionString = "provider=sqloledb;data source=xxx;initial catalog=xxx;user id=xxx;password=xxx" cn.Open rst.Open "select telno from address", cn, 3 Do Until rst.EOF if re.test(rst.fields("telno")) then else WScript.Echo rst.fields("telno") end if rst.MoveNext Loop
とりあえずうまくいってなによりです。 >データベースのところにシステムデータベースというのがあるんですが、これは何なのでしょうか。これは消しても大丈夫ですか？ システムデータベースという名前の通り、SQL Server自体がシステムを動かすために使うコアのデータベースですので、削除してはいけません。そのままお使いください。
小数部分が８桁より多い場合、'NG'を表示させます。 select 'NG' where ( 100000000*(123.123456789-floor(123.123456789)) -floor(100000000*(123.123456789-floor(123.123456789))) )>0 要するに、小数部分を100000000倍してさらに小数部分があるかどうかを調べることで小数部分が８桁より多いかどうか調べています。
以下は .NETの例です。参考にしてください。 http://homepage2.nifty.com/inform/vbdb/net_sql.htm
データベースエンジンのバージョンとSSMSのバージョンが一致しているかどうか確認してみることをお勧めします。 詳細を確認できないのですが、少なくともこのsp_delete_profile_spの@force_deleteパラメータはSQL Server 2005になったあとで追加されたものです(SP1だったか、SP2だったか）。 SP2にはこのパラメータはありますが、データベースエンジンのバージョンが違えばこのパラメータがない可能性があります。 （ちなみにSQL Server2008ではこのパラメータはなくなっているようです）
>varchar型のフィールドにデータを格納しているのですが この際に、改行コード付きでは駄目なのでしょうか？ 今の例ですと、句読点の○で区切っていますがこの辺は変わる可能性は？ 素直に登録時に改行位置まで含めて登録し、表示はデータをそのままというのが自然だと思いますけど？ その辺は、システムの要件が不明なので何とも。
SELECT roomtype, MAX(sumnum) AS Expr1 FROM (SELECT TOP (100) PERCENT stayday, roomtype, SUM(roomnum) AS sumnum FROM Test_Room WHERE (CONVERT(Varchar(10), stayday, 111) BETWEEN '2008/09/21' AND '2008/09/23') GROUP BY stayday, roomtype ORDER BY stayday) AS derivedtbl_1 WHERE (roomtype IN ('SD', 'SS')) GROUP BY roomtype ORDER BY roomtype
データの暗号化について上手くいって無いようですね。 EncryptByKeyおよびDecryptByKeyの関数仕様は熟読しましたか？ テーブル定義で暗号化対象のカラムの型はどのようになっていますか？ EncryptByKeyの戻り値の型がvarbinary 型である事を考慮して見直してみては如何でしょうか？ 参考URL：http://msdn.microsoft.com/ja-jp/library/ms174361 …
SQL Server の場合、よく使うのは３パターンです。 状況に応じ使い分けられると便利なので、一応３つ書いときます。 --JOIN DELETE TABLE2 FROM TABLE2 t2 LEFT OUTER JOIN TABLE1 t1 ON t1.KEY1=t2.KEY1 AND t1.KEY2=t2.KEY2 AND t1.KEY3=t2.KEY3 WHERE t1.KEY1 IS NULL AND t2.ITEM2>='2008/02' --EXISTS Clause DELETE TABLE2 FROM TABLE2 t2 WHERE NOT EXISTS (SELECT NULL FROM TABLE1 t1 WHERE t1.KEY1=t2.KEY1 AND t1.KEY2=t2.KEY2 AND t1.KEY3=t2.KEY3) AND t2.ITEM2>='2008/02' --IN Clause DELETE FROM TABLE2 WHERE KEY1+'*'+KEY2+'*'+KEY3 NOT IN (SELECT KEY1+'*'+KEY2+'*'+KEY3 FROM TABLE1) AND ITEM2>='2008/02'
こんにちは 「サービスと接続のセキュリティ構成」が「ローカル接続のみ」 になっていませんか？ 「構成ツール」の中にある「SQL Server セキュリティ構成」を 起動して、「サービスと接続のセキュリティ構成」を選択します。 ツリー内の「database Engine」内の「リモート接続」の設定が 「ローカル接続のみ」になっている場合は、「ローカル接続およ びリモート接続」に切り替えて見てください。 また、SQL 2005 Expressを初期設定でインストールした場合なら "SQLEXPRESS"と言う名前付きインスタンスでインストールされま す。Expressの場合、データソース名は、"<サーバ名>\SQLEXPRESS" で接続しないと、エラーになったと思います。
以前、統計情報を更新したら格段に速くなりましたよ。 統計情報の更新がないようだったので・・・
スキーマの出力はやったことがないのですが 「Database」→「Reverse Engineer Wizard」 で取込たいDataSourceを指定でER図を作っています。 スキーマの変更履歴はSQLServer　Managementがあれば レポート（Excel）出力で作成しています。
Windows XP Sp2 + SQL Server 2005 Compact Editon(英語版)で、同様の問題を経験し、結構はまりましたので、ご参考まで。 SQL Server 2005以降のバージョンでは、デフォルトでは、他ノードからのアクセスを受け付けない仕様になっていると思います。 という訳で、私の場合はインストール後、以下の作業が必要でした。 <SQL Server Serer 2005 Surface Area Configuration> 　◆Local connections onlyチェックボックスをオフにする。 　◆Using TCP/ID and named pipeチェックボックスをオンにする。 <SQL Server Configuration Manager> ◆TCPのポートをDynamicから1433固定に変更 (何ゆえ、Dynamicがうまく動作しなかったのか、原因は不明) <Windows Firewall> 　◆TCP1433を例外リストに追加 以上、日本語版では、微妙に用語が違うとは思いますが、SQL Server 2000でのご経験をお持ちなので問題ないと思われます。 お役に立ちますことを祈っております。
インデックス再構築中はテーブルがロックされるため、テーブルにアクセスできなくなります。 （オンライン再構築はEnterprise版のみ可能です）
SQLServerは英語OSですか？ データをインポートするには何を使用されますか？
#1です。やり方はわかったようですので、補足ですが、 パススルークエリは丸ごとSQL Serverにクエリを投げるので、 INSERT INTO (SQL Serverのテーブル) SELECT * FROM (Accessのテーブル) みたいな使い方はできません。 基本的にはパラメータも渡すことができないので、実行の都度QueryDefのSQLを書き換えてExecuteするような使い方になるかと思います。 今回は１レコードだけということなので、特に問題はないと思いますが、複数レコードをINSERTするのだったら、 INSERT INTO TABLE VALUES ('A','B','C'); INSERT INTO TABLE VALUES ('D','E','F'); INSERT INTO TABLE VALUES ('G','H','I'); と並べるよりは INSERT INTO TABLE SELECT 'A','B','C' UNION ALL SELECT 'D','E','F' UNION ALL SELECT 'G','H','I' とやると１ステートメントでINSERTできるので少し速いはずです。
エンタープライズマネージャが使えるなら 1.対象のデータベースを右クリックで、デタッチ 2.ファイルを移動 3.データベースフォルダ（上記1の1階層上）を右クリック、アタッチ でいけるんじゃないかと。
技術的にはIDを指定してINSERTを行うことはできます。 2番が既になくなっているとすれば、 SET IDENTITY_INSERT AAAA ON GO INSERT INTO AAAA(ID,....) VALUES (2,....) GO SET IDENTITY_INSERT AAAA OFF GO といった具合です。 ただし、アプリケーションの処理として実装するのはお勧めできません。同一セッションでは２つ以上のテーブルに対して同時にIDENTITY_INSERTをONにできないとともに、ONにしている間は自動インクリメント自体が無効になるからです。
ストアドプロシージャは、SELECTするものではなく、EXECするものなので、テーブルの代わりには使うことはできません。 1)そのストアドプロシージャを書き換えて別のものにしてもいい場合、 　いくつか制約はありますが、テーブル関数に書き換えることでSELECT文で使うことができます。 2)そのストアドプロシージャを書き換えることができない場合 　一旦ワークテーブルに受けてSELECTする方法が使える場合があります。 いずれにしても、そのストアドプロシージャがどのようなパラメータがあって、戻りがどのようなものか、もう少し詳細が必要かと。
ODBCの設定で、「既定のデータベースを以下のものに変更する」で目的のデータベースになっているか確認してみてください。 デフォルトは「master」になっているので。
SQL Server2005で気をつけなくてはならないのは、 各単位ごとに決定すべきことが分かれていることです。 ・サーバ単位 　ソフトウェアのインストール場所 　※デフォルトのDBのファイルの位置が決まる。 　SQL Serverを動かすOSユーザ 　サーバ名 　インスタンス 　※サーバ名＋インスタンスが外部からの接続に必要 　　これが変わるならクライアントの指定も変わります。 ・インスタンス単位 　インスタンス（複数構築可能） 　※規定インスタンスか名前付きインスタンス 　ログイン（アプリがDBにアクセスするために指定する） ・DB単位 　照合順序（大文字小文字の比較） 　※大文字小文字の違いでSQLが通らない場合があります。 　データ・ログファイルの構成 　ユーザ（ログインにマッピング） ・SQL Serverエージェント 　※ジョブ実行に使用する。 　　バックアップのジョブ・定期ジョブなど。 上記の用語がわからないと構築は難しいです。 ※全てデフォルトで作成されているのならインストーラでボタンをポチポチ押していくだけで構築できるんですけど。 書籍だと「SQL Server2005でいってみよう　運用管理編」あたりが役に立つと思います。 DBの構築って、未だに結構な工数を取られる作業ですので、ちゃんと調査して行わないと後で不都合な点が見つかりますよ。 DBだけならアタッチ・でタッチで移行できますが、インストール時に指定する項目は事前調査を元に指定しないといけません。気をつけてください。
解決済みかもしれませんが。 select [No] from 物件 みたいに []とかで囲むと予約語でも使えるはずです。
>とりあえず今知りたいのは、削除箇所のみをフルバックアップファイルからリストアできるかどうか、とその方法が知りたいのです。 そこがポイントなんですね。物理構成単位（ページなど）の部分的なリストアならできますが、テーブルという論理構成単位でのリストアはできないです。
こんな感じでどうぞ。MAXはSUMなどに置き換えれば他のケースでも応用がききます。 SELECT [INDEX], MAX(CASE WHEN ID=1 THEN PARAM END), MAX(CASE WHEN ID=2 THEN PARAM END) FROM tbl1 GROUP BY [INDEX]
SQLSERVERが「名前つきインスタンス」になっていませんか？ http://support.microsoft.com/kb/328306/ja
行数が６の倍数でなかったら、最大の商品IDの続きでダミー行を補う、というクエリのサンプルは以下のようになります。 何もないところから行は生み出せないので、５行の空行を生成し、余りに応じて使います。 必要な情報は入っていると思いますので、中身をみてください。 SELECT a.商品ID,a.数量,a.価格,b.商品名 FROM 表A a,表B b WHERE a.商品ID=b.商品ID UNION ALL SELECT RIGHT('0000'+CONVERT(varchar,(CONVERT(int,c.MAXID)+t.SEQ)),4) 商品ID, 数量,価格,商品名 FROM (SELECT 1 SEQ,NULL 数量,NULL 価格,NULL 商品名 UNION ALL SELECT 2, NULL,NULL,NULL UNION ALL SELECT 3, NULL,NULL,NULL UNION ALL SELECT 4, NULL,NULL,NULL UNION ALL SELECT 5, NULL,NULL,NULL) t, (SELECT COUNT(*)%6 PAGEROW, ISNULL(MAX(a.商品ID),'0000') MAXID FROM 表A a,表B b WHERE a.商品ID=b.商品ID) c WHERE t.SEQ<=(6-PAGEROW) AND c.PAGEROW<>0
VB2008(VB.NET)でのDBへの接続方法はADO.NETという方法で接続します。 ADO.NETで探せばかなりの本がありますので探してみてください。 どの本がいいかは、DBの知識や利用方法によって異なりますので 本屋でADO.NETの本を開いてみるのが一番早いです。
＞今回の事例はやっぱり基本的なことなのでしょうか？（開発を行う者にとっては当然のことなのでしょうか？） おそらく、.NETでWindowsアプリを開発する人には基本的なことでしょうね。でも、焦ることはないと思います。私もアプリ開発は専門ではなくて、普段はASP.NET(Web)の方でしか書かないから最初気付かなかったわけですからね。 質問者さんがSQL Serverに投稿されましたので、たまたま私が拾いましたが、プログラミングカテゴリに投稿していれば一発で回答がついたかもしれません。今回の件も、データベースがエラーメッセージなしで更新もされないという事象はありえないという認識のもと、ExecuteNonQueryのところの変数をチェックして気づいたというのが正直なところです。使っていないとわからない、そんなものです。 >また、上記のような事はどのようにして学べばよいのでしょうか？仕事はサービス業を行っていますので、周囲に詳しい方もいないので相談が出来ない状況です。 本業でなく.NETで書かれているとすれば大したものだと思います。 .NETは深く理解しなくても動くものが作れてしまうので、結果的に基本的なことで見落としてしまうことがあるというだけです。 独学で作り始めたのであれば、一通り作れるようになったと思ったところで、データベースを使った基本的なプログラミング解説書を読んでみると、自分が見落としていることがかなり書かれていることに気付くはずです。あとはそういう本やWebに載っているサンプルコードをできるだけ見てみることをお勧めしておきます。王道はありません。頑張ってください。
そこまで調べられたのであれば、 ・データベースをデタッチする方法 http://msdn.microsoft.com/ja-jp/library/ms191491 … ・データベースをアタッチする方法 http://msdn.microsoft.com/ja-jp/library/ms190209 … を読んでそのとおりやっててみてください。 デタッチして、mdfファイルをコピーして持って行き、アタッチするという手順です。
SQL Server 2005以降なら、information_schemaが実装されているので、定義済の表の構成列名、データ型などの参照がより簡単になっています。 http://msdn.microsoft.com/ja-jp/library/ms186778(SQL.90).aspx
・両方のテーブルに同じデータが存在する場合（今の書き方） SELECT (省略) FROM Ａテーブル INNER JOIN Ｂテーブル ON Ａテーブル.勤務区分 = Ｂテーブル.勤務区分; ・Ａテーブルの全レコードを抽出し、Ｂテーブルに対応するデータがある場合は、Ｂテーブルからもデータを牽く場合（これがやりたいこと） SELECT (省略) FROM Ａテーブル LEFT JOIN Ｂテーブル ON Ａテーブル.勤務区分 = Ｂテーブル.勤務区分; ・Ｂテーブルの全レコードを抽出し、Ａテーブルに対応するデータがある場合は、Ａテーブルからもデータを牽く場合（やりたいことの逆） SELECT (省略) FROM Ａテーブル RIGHT JOIN Ｂテーブル ON Ａテーブル.勤務区分 = Ｂテーブル.勤務区分;
少し疑問なのが、前回の回答、なぜこういうつくりにしたのかわかりました？ わかって使っていないのなら、また条件が変わったときに同じように聞くとになりますよね。 いっそのこととりあえずデータをソートなしで取得して、 java側で一致件数をカウントする関数を通して、java側でソートかけたほうが楽じゃないです？ あ、それで、私ならどうするかというと、ユーザー関数を自作します。 文法はうろ覚えなのでイメージだけ Create function Sortlank (tbla1 varchar ,tbla2 varchar, ... pma1_1 varchar, pma2_1 varchar,... pma2_2 varchar,... ) (計算して一致する数を出す） ------- で、Select文は select A.*, dbo.SortLank(a-1,a-2,....,'aaa','bbb'...) as Sortkey order by sortkey,id みたいな感じで。 そのほうが順位付けのロジックを説明しやすいんじゃないかと。
参考意見として。 もしこのSQLの結果をVBなどの言語を使って取り出しているなら、 取り出し側で「Nullや空文字なら0を返す」関数を作ってそれを通すという方法もあります。
ROWIDはOracleの発想ですね。そもそもSQL Serverではそういう概念のものはないんじゃないかと思いますが。 提供されているシステムビューではそのテーブルのデータはどのPartitionのどのPageからデータが書き込まれているかを確認できるだけだと思います。
(1)～(3)まで回答します。SQL Server の前提です。 (1)データベース容量とは「データベースがデータを格納するために占有するファイルサイズ」と言っていいと思います。 最初に大きめの空っぽのデータベースファイルを作成し、データをその中に埋めていく事が可能ですし、最初は小さいデータベースファイルを作成し、データの増加に応じてデータベースファイルの大きさを増やす事も可能です。 データベースファイルの大きさは OS が認識できますが、その中にどれくらいのデータが入っているのかは、SQL Server が管理します。 SQL Server Express Edition では、データサイズ 4GB までという制限がありますが、これはデータベースファイルのサイズが 4GB までである事を指します。 (2)例で言う「HDD:100G」が「既に100G使っている」という意味であれば「使用容量合計は104GBになる」であっています。 物理的に合計100G入るディスク装置が全て未使用で、SQL Server のデータ領域を4G取るという意味でしたら、96Gが残りのディスク容量になります。 (表現が微妙なので、ご質問者さんの認識があっているのかちょっとわかりませんので、両方の想定で書きました。) (3)可能です。SQL Server で言うと「デタッチ」という作業を行えば、データベースファイル自体を別のディスクに一時的に移動することができますし、データベースファイルはそのままで、データの中身だけを別のディスクにバックアップすることもできます。 (4)見積もりとるなり代理店にきいてみてください。
ManagementStudioに勝るものはないと思いますが。
こんな感じになるでしょう。 SELECT 仕入先名, MAX(CASE WHEN ROWNUM=1 THEN 商品名 END), MAX(CASE WHEN ROWNUM=1 THEN 数量 END), MAX(CASE WHEN ROWNUM=2 THEN 商品名 END), MAX(CASE WHEN ROWNUM=2 THEN 数量 END), MAX(CASE WHEN ROWNUM=3 THEN 商品名 END), MAX(CASE WHEN ROWNUM=3 THEN 数量 END) FROM (SELECT (ROW_NUMBER() OVER (PARTITION BY m.仕入先ID ORDER BY t.仕入数量 DESC)) ROWNUM, m.仕入先名 t.商品名, t.仕入数量 FROM 仕入先マスター m INNER JOIN 仕入テーブル t ON t.仕入先ID=m.仕入先ID) tmp GROUP BY 仕入先名
＞SQL Server は、コマンドプロンプトから ＞「net start SQLServerAgent」、 ＞「net start mssqlserver」、 ＞「net start sqlservr」と入力することで起動できます ＞ただし、「net start SQLServerAgent」で起動すると、 ＞「net stop SQLServerAgent⇒net stop mssqlserver」という手順でサービスを停止することになります。 ＞「net stop mssqlserver」のみを実行しても、手順は省けません。 http://www.sqlpassj.org/bunkakai/begin/series/s0 … 以上は、2005年の9月頃に SQL Server 2000 で確認したことです。 で、＜手順は省けません＞は、どこで知ったのでしょうか？ もしかしたら、SQL Server ユーザーグループの分科会かもです。 上述のサイトの＜DBバックアップとリカバリー＞を印刷し熟読した記憶があります。
「"」（二重引用符）で囲むか、[ ] で囲むことで、予約語と同じ名前や特殊記号などを含む名前も使えるのでは？ 「"」で囲む方法は標準SQLに準拠、[ ]で囲む方法はSQL ServerやMS-ACCESSの独自仕様です。 例 "4月期売上" [4月期売上]
本来の質問からは相当乖離しているような気がしてきましたが。。 コンソールアプリケーションはその環境であれば動くはずです。 ファイルの書き出し先をマイドキュメントにしているようですが、C:\Tempなど普通のフォルダを指定して試してみてください。 SQL Serverがxp_cmdshellを実行するとき、質問者さんのユーザＩＤの権限で実行すると思っていませんか？ 何も考えないでインストールしたのだったら、おそらくローカルシステムアカウントで実行されます。そのフォルダにアクセスする権限がなければファイルは書き出せません。 ＃念のため、ちなみに書かれていたものをコピペして、フォルダを変更してコンソールアプリケーションにして実行してみたら、ファイルは書き出されました。
これでどうでしょうか。 UPDATE [TBL A] SET [TBL A].tanka = [TBL B].tanka FROM [TBL A] INNER JOIN [TBL B] ON [TBL A].KOUMOKU = [TBL B].KOUMOKU
肝心のところがよくわからないのですが。。 ・上記の対応は、各ログインに割り当てられている「既定のデータベース」が存在しなくなったときに、「既定のデータベース」を変更する対応ですが、これをやったのだから、SQL Server Management Studioからインスタンスに接続できるようになったのですよね？そこから「データベースの名前の変更」をしようとしても何かエラーメッセージが出るということですか？ ・saは使えないのですか？
Oracle以外の主要なRDBMSは、空文字は有効な値、nullは不定な値です。 標準SQLも、後者です。 >oracleには、空文字は存在せず、すべてnull値として扱ってくれて非常に、わかりやすいです。 これはOracle以外のRDBMS利用者には、非常に紛らわしい仕様です。 標準SQLや多くのRDBMSの常識では、nullは「列名 is null」、「列名 is not null」でしかヒットしません。ところが、Oracleの場合、「列名=''」でもヒットしてしまいます。
sqlcmd自体に指定時間を実行する機能があるとまでは思っておられないですよね。 したがって、基本的には ・SQL Serverエージェントタスクを登録する ・Windowsのタスクスケジューラに登録する のどちらかしかないです。 （おそらく後者でしょうね） バッチファイルに sqlcmd -E -d db -i c:\a.sql -o c:\1.txt を貼って保存し、タスクスケジューラに登録するだけです。 -Eオプションを使っておられるので、タスクにはSQL Serverに接続できるユーザのIDとパスワードを指定する必要があります。 もし全く違う質問なのであれば、環境情報などももっと具体的に書かれるといいと思います。
単に頭に余計な「!!」がついているからではないですか？
他で使うときに、ODBCのデータソース選択画面で「クエリウィザードを使ってクエリを作成/編集する」というチェックをオフにすると、いきなりMS Queryに飛ぶからエラーにはならないはずです。 クエリウィザードはODBC（というかMicrosoft OLE DB Provider）が書式を評価するので、ODBC書式({ts 'yyyy-mm-dd 00:00:00'})しかサポートしてくれていないということかと思います。 GETDATEに限らず、SQL Server独自の関数はつかえないです。 ここはどうしようもないところで、クエリウィザード以外のところで対応するように考えていくべきかと。
やり方としては問題ありません。 ファイルの圧縮はファイルを個別に圧縮するDBCC SHRINKFILEの機能で、こちらで圧縮することもよくあります。
条件がDMLトリガによる起動となっていますので、ストアドプロシージャ以外の選択肢はないですね。そうすると、そもそも以下のいずれかの方法しかないと思うのですが、セキュリティの条件が厳しいならば、設定が初心者向けではないため、お勧めできません。 ・xp_cmdshellをEXECUTE AS句を指定したストアドプロシージャの中で使う。sysadmin権限がなくても、ストアドプロシージャを実行させることができます。ただし、偽装実行を認めるための設定が必要で、セキュリティを考慮する場合は証明書による署名をかけることになります。 ・CLRストアドプロシージャを.NETで作成し、権限セットを「外部アクセス」に指定して、SQL Serverに配置する。これもセキュリティの条件が厳しいならば、署名を掛ける 実際の手順を紹介しているサイトを見た記憶はありませんが、MCP教科書(MCITP)のDatabase Administratorで、署名付CLRストアドプロシージャの作成手順については紹介されていたと思います。
私はSQL Serverユーザで、MySQLは仕事で使ったことがないということもありますが、SQL ServerはMicrosoftの製品ですので、Accessとの親和性は非常に高いです。その意味でSQL Serverの方をお勧めしておきます。 同様のアップグレードの例にも事欠かないはずです。 仕事では有償のEditionをつかっていますが、前にSQL Server 2005 Express Edition with Advanced Option（これも無料）を検証したときに、あまりの機能の充実さに驚いた記憶があります。 SQL Server Expressでもデータベースは4GBまでサポートします、容量的にも十分かと思います。 SQL Server Expressの場合、リモート接続の設定に苦しむ例が多いみたいですが、逆にいうとそれも多く例があるということなので、そこは調べてみてください。
SET NOCOUNT OFFは不要です。 ストアドプロシージャ内で切ると、その中でだけ有効です。 ついでですが、ストアドが中で一度終わっている理由はなんでしょう？ 中のend/beginは必要ないように見えます。 更にいうと、一時テーブルを作成せず、select文だけ書いても同じ結果になるような気がします。 （つまり、この部分だけ） ALTER procedure [dbo].[S_業者請求伝票分R] @myid int as begin 　　　set nocount on 　　　SELECT hh.発注物件ID, ga.発注ID, ga.業者請求日, ga.業者請求額, ga.最終支払, 　　　　　　ga.請求メモ,zz.会社名,hh.特記,hh.受注登録ID 　　　FROM dbo.T_業者請求 AS ga left outer JOIN 　　　　　　　dbo.T_発注 AS hh ON ga.発注ID = hh.発注ID INNER JOIN 　　　　　　　 dbo.T_住所 AS zz ON hh.会社ID = zz.会社ID 　　　where hh.受注登録ID=@myid end
AutoNumber型と発想は似ておりますが、 identityは型ではなく、カラムの属性となります。 テーブルに渡って番号が増加するデータを持つ場合に、IDENTITY属性を指定し、SQL Serverに自動的にセットさせることができます。 IDENTITYを使用する場合はデータ型を「int」かつ、「NULLを許容」にする必要があります。 IDENTITY属性は、シードと呼ばれる初期値とインクリメントと呼ばれる増分を指定し、数値を初期値からレコード追加の際に増分を加算された値で自動セットしてくれるので便利ですが、登録された値を取得するには@@IDENTITYをSELECTしないと取得できなかったり、TableAdapterのUpdateメソッドでは対象テーブルのIDENTITY属性を持つフィールドを含めたDataTableを使用するとうまくいかなかったりなったりと制約もありますので使用の際には検討が必要です。 ご注意ください。
実際のデータベースは集合演算ではないので、射影ではDISTINCTをつけて重複を排除します。また、結合も要約も実装されているので、書き方も変わってきます。 今回の例では、そのまま関係代数式っぽく書くと 1)SELECT DISTINCT X.氏名 FROM X, X AS X1 WHERE X.氏名=X1.氏名 AND X.所属チーム<>X1.所属チーム 2)SELECT DISTINCT 所属チーム FROM X EXCEPT SELECT DISTINCT 相手チーム FROM Y WHERE 所属チーム='A' 3)SELECT DISTINCT 所属チーム FROM Y WHERE 得点時間>=15 4)SELECT DISTINCT 所属チーム FROM X EXCEPT SELECT DISTINCT 所属チーム FROM Y となりますが、1)2)4)については実際は、以下のようにします。 1)SELECT 氏名 FROM X GROUP BY 氏名 HAVING COUNT(*)>1 2)SELECT DISTINCT 所属チーム FROM X WHERE 所属チーム NOT IN (SELECT 相手チーム FROM Y WHERE 所属チーム='A') 3)SELECT DISTINCT 所属チーム FROM X WHERE 所属チーム NOT IN (SELECT 所属チーム FROM Y)
saではつながるということでしたよね？ 「ログインできませんでした」というメッセージが出ること自体、DBは見えていますので、明らかにユーザ設定の問題だと思ったのですが。。 ちょうど手元に使ってないSQL Expressがあったので、XP SP2２台で試してみましたが、そのような問題は起きませんでした。 。。もしかして他のユーザとはSQLユーザでなく、Windowsユーザですか？
こういうやり方なら実装したことがあります。 CREATE TABLE t_val([SEQ][int] IDENTITY,[FLG][int]) CREATE PROCEDURE ap_nextval AS BEGIN SET NOCOUNT ON INSERT INTO t_val(FLG) VALUES (1) RETURN SCOPE_IDENTITY() END DECLARE @nextval int EXEC @nextval=ap_nextval アプリケーションだとストアドの最終行はSELECT SCOPE_IDENTITY()の方が取りやすいかもしれません
とりあえず、根本的な原因究明とかは ロックの詳細情報で確認してどうにかするしかないと思うので、 で、根拠なしなことを言うと、 7.0では、デッドロックの判断が甘くて、DB側で「デッドロック」と認識できていないのかも知れないですね。
うーん、すみません。DB2だとちょっとわかりません。 ただ、今回の例でもそうですけど、複数のステートメントを一括で実行させたい場合は、ストアドプロシージャにした方がパフォーマンスやメンテナンスの面でもいいと思います。 （作成が認められているなら、ですが）
SQLServerのCompact Editionは通常のSQLServerとはベースが違っているようです。 Compact Edition のSQLはT-SQLのサブセットを実装していてその中には BULK INSERTはないです。よって使えないと思います MicroSoftのSQLServer Books Onlineで確認してみてください SQLServer Books Online = http://msdn.microsoft.com/ja-jp/library/ms189826 … この中にはBulk Insertがある SQLServer CompactEditionの　Books online= http://msdn.microsoft.com/ja-jp/library/ms173372 … この中にはBulk Insertはない
どうやら私が直接回答しなくても、ヒントから答えを導き出したようですね。 READ_COMMITTED_SNAPSHOTは、2005から追加された分離レベルになりますのである程度、使えるんですが、READ_COMMITTED_SNAPSHOTは、SQL Serverのtempdbに変更前後の内容を書きだしにいくので、若干レスポンスは落ちます。 そのため、READ_COMMITTED_SNAPSHOTを使う場合は、SQL Serverにあるtempdbの設定やチューニングをきちんと行うことが不可欠になりますので、そこだけご注意ください。 ＞出来るだけ複雑にしたくないのが正直なところです。 作ったクラスは複雑にはなりますが、他のクラスからみたら、Access、SQL Serverを意識させないので、むしろ他のクラス達から見たら、簡単になるんですけどね・・・ 工数の兼ね合いとかおありだと思いますので、最終手段としてご検討頂けるといいかもしれません。 ひとまず、分離レベルをお試し下さい。
おおむね正しいです。 （超厳密な議論までは必要ないでしょう） 補足するとしたら、 ・トランザクション分離レベルについては、通常は下から２番目のREAD COMMITTEDになっていて、COMMITしていない更新はSELECTでは読み取らないけれども、COMMITされれば即反映するので、今SELECTしたものが次SELECTしたものと同じという保証はないこと ・OracleとSQL Serverとではロックのメカニズムは同じではないこと くらい認識していればいいかと思います。
今度の会社で、ということは転職もしくは新社会人ですよね。 だとすればそちらの会社にはDBの知識に明るい方はいるでしょうし、経験のない方にいきなり全部をやれとは言わないと思います。(思いたいです^^） もちろん知識を蓄えて即戦力になろうという意気込みはとても素晴らしいものですし頑張っていただきたいです。 ですがひとえにDBといっても分野が広く、使用する機会のない知識もたくさんあります。またRDBの種類が変われば色々と細かい部分が違ったりします。SQLServerの知識を所望されているようですが、おそらくそれに特化した知識よりも広く使える知識を持っていたほうがいいと思います。それは何かというと経験上、SQLの知識ですね。どちらかというとDDLよりはDMLです。SQLはISOにて標準化されていますので、標準にあった知識を得れば損をすることはありません。(RDB特有の地方言語は便利なんですけどね） 古い本で申し訳ありませんが「プログラマのためのSQL 第2版 ジョー セルコ (著), Joe Celko (原著), 秋田 昌幸 (翻訳) 」を推薦させて頂きます。
試験問題についての詳細はルール違反になるから誰も書き込めないのではと思いますけど、知りたいのは試験の話ですか？それとも試験と関係なくてもINSTEAD OFトリガの書き方がアドバイスできればいいということですか？ （私が70-431取った時はシミュレーション試験開始前でしたので）
時刻関連や数式関連の便利な関数は全てアウトだと思いますよ。 これはMSSQLとMySQLだけではなくOracleやAccessなど他のRDBにおいても言える事でしょう。 私は標準SQLにないものは全て違うという風に捉えています。 違いを調べるより標準でないSQLは何かを調べたほうが答えに早く辿り着けるかもしれません。
それからもう１つ忘れてました。 恐らくエラーの現象が変わったので、SQL Server Management Studioを開き、下記のクエリを更に実行してみてください。 CREATE CREDENTIAL [MyCredential] WITH IDENTITY = '<domain>\<user>', secret = '<password>' go Sp_add_proxy @proxy_name='My Proxy', @credential_name='MyCredential' これで、Agentは2005から、sysadminの資格情報を持つものしかアクセスできなくなってしまったので、上記のサービスに対する権限、 MDFファイルに対する権限の他に、上記が必要かと思います。 それでも駄目であれば、他の手を考えるしかありません。 宜しくお願いします。
接続URLのportが8080になっていますが、これはTomcatのportでは ないですか？ SQLServerの場合は、規定値 1433で、変更していなければ指定する必要はないと思いますが。 url = "jdbc:sqlserver://localhost:8080;databaseName=testdb;"; 参考URL：http://msdn.microsoft.com/ja-jp/library/ms378428 …
ANo.2です。 後段のＳＱＬ試してみました？ これならSQLServer2000でもいけると思ったんですが。
はじめまして。 情報がかなり少ないので、推測の上でのコメントご容赦下さい。 恐らくですが。 「MDAC2.8」がクライアント側(?)に必要だと思われます。 比較評価できるクライアントが２台あれば、 動作確認が取れると思います。 あくまでも「可能性」ですのでご了承を。
ストアドやPG内で変数としてクエリを生成してSQL-Serverへ変数毎投げるのであれば、以下のクエリでカラム名を取得できるので恐らく可能ですけど。 クエリのみだと難しいかな……… 私の知っている限り、クエリの結果をカラム名としてSELECT句へ展開する事ができないので。 SELECT c.name FROM sysobjects o , syscolumns c WHERE o.name = 'テーブルA' AND c.id = o.id AND c.name like '00%' ORDER BY c.colid お役に立てずに申し訳ないです。m(_ _)m
うひゃー、まるでパズルのようですね。 検索条件は必ずワンセットだけですか、とか、細かいデータの入り方が不明ですが、今回の例なら以下のようにできます。 最初のワークテーブルに入れているところから、より検索に向いたテーブル構造が何かも察して頂けるのではと期待します。 (検索対象がresulttblに、検索条件はsrchtblに１行だけとしてみてください） DECLARE @res TABLE　([ID][int],[CAT][varchar](1),[VAL][varchar](3)) DECLARE @srch TABLE　([CAT][varchar](1),[VAL][varchar](3)) INSERT INTO @res SELECT ID,'a' CAT,a1 VAL FROM resulttbl UNION ALL SELECT ID,'a',a2 from resulttbl UNION ALL SELECT ID,'b',b1 from resulttbl UNION ALL SELECT ID,'b',b2 from resulttbl UNION ALL SELECT ID,'c',c1 from resulttbl UNION ALL SELECT ID,'c',c2 from resulttbl INSERT INTO @srch SELECT CAT,VAL FROM (SELECT 'a' CAT,a1 VAL from srchtbl UNION ALL SELECT 'a',a2 from srchtbl UNION ALL SELECT 'b',b1 from srchtbl UNION ALL SELECT 'b',b2 from srchtbl UNION ALL SELECT 'c',c1 from srchtbl UNION ALL SELECT 'c',c2 from srchtbl) tmp GROUP BY CAT,VAL SELECT r.*,ISNULL(c.CNT,0) FROM resulttbl r LEFT OUTER JOIN (SELECT wt.ID, COUNT(*) CNT, SUM(CASE WHEN wt.CAT='c' THEN 1 ELSE 0 END) CNT_C FROM @res wt INNER JOIN @srch ws ON ws.CAT=wt.CAT AND ws.VAL=wt.VAL GROUP by wt.ID) c ON c.ID=r.ID ORDER BY CNT DESC,CNT_C DESC
確かに警告（SQL Serverのパフォーマンス条件警告）でできます。 アプリケーションログに書きたければ、 1)メッセージを作る EXEC sp_addmessage 50001,16,'Transaction Log Full','us_english' 2)警告の応答にジョブの実行を選んで RAISERROR (50001,16,1) WITH LOGを登録 がてっとり早いです。 でも、イベントログに書いてすぐ気付けますか？ 普通にやるとたぶん15秒に１回くらいの頻度で書きこみますので、そこは工夫してください。
sqlcommandにストアド呼び出し用のパラメータを設定していないのが原因だと思います。（これで意味通じますか？） 上記の意味が良くわからないという場合は、 呼びだしたいストアドのソースと、 ASP.NETで、sqlcommandを使っている箇所のソースを 公開して頂ければ、上記の意味と合わせて、ご回答致します。 ＃ソースで公開してはまずい箇所は、加工して頂いても構いませんので。 宜しくお願いします。
テーブルに列を追加すると、参照する分には特に問題はないのですが、追加するときに追加の仕方によっては影響がでます。 （Accessの中でそのテーブルをどう更新しているか次第ですが、今回はそこを確認されているわけではなかったようなので） 絶対に影響が出るというわけではないですよ。 リンクの貼り直しというのは、SQL Server側の作業ではなく、Access側の作業です。Accessのバージョンやリンク方法が読み取れませんが、「Accessのリンクテーブルのはりなおし」であれば身近にお分かりになる方もいらっしゃるのではないですか？
はじめまして。 文字列をfloat型やmoney型に変換される時、どの様に変換をされてますでしょうか。 どの様に変換されておられるのか、再度ポストして頂けますでしょうか。
> あるサイトで見たのですが、 > マイコンピューターのプロパティから > リモートを許可するにチェックを入れました。 そらリモートデスクトップやろ！（見た瞬間思わずこう叫びました） リモートデスクトップとは、RDPというプロトコル(一般的なポート番号は3389)を使って、Windowsマシンの画面を別のマシン上に表示できる仕組みで、SQL Serverとは何の関係もありません。 > レジストリのHKEY_LOCAL_・・・・/TcpPort でポート番号を調べました。 いきなりここだけレベル高い事してますな。ただ、これだとポート番号を勝手に変えられた時に困るので、例外を「プログラムの追加」でSQL Serverを登録すると良いでしょう。あるいは、ポート番号を決めてそこだけあけるか。本来ポート番号を調べる必要はありません。なぜならあなたが決定するのだから(あなたが提示したサイトの１の（５）)。一般的には1433を使います。 > 別マシンのユーザID/パスワードとはどのユーザID/パスワードのことでしょうか？ これは普通にWindowsのユーザアカウントの事でしょうね(提示されたサイトでは)。ただ、おそらくあなたは最終的にSQL Serverをバックエンド、Accessをフロントエンドとした情報システムを構築したいのだと思うので、ユーザアカウントを作る方法はあまりお勧めできません。まぁとりあえずこっちはおいておこうよ。先にネットワークでつなげる方をやろう。知りたいのであればつながった後でこっちも説明します。提示サイトの手順１は全部やったんだよね？　だから接続自体は今でもできるはずなんだけどな。確かに言葉っ足らずで肝心の「なぜこうするか、こうすると何が起こるのか」がさっぱり書かれていないので、サイト様には申し訳ないが引用で説明をつけさせてもらおう。 > １．SQL Serverにリモート接続許可する設定 > （１）SQL Server Configration Managerを立ち上げる 　ANo.1の方がおっしゃるとおりSQL Server Configuration Managerはあなたのマシンにも入っているはずです。スタートメニューあるいはマイコンピュータを右クリックして管理の中に自動で入るはず。 > （２）SQL EXPRESSのプロトコルでTCP/IPを有効にする。 　ここでこうしないと当然TCP/IP接続できないよね。 >（４）IPアドレスのIP1,IP2の有効を「いいえ」にする。 　これはおそらくサイト様の環境がLANカードが1つでそれがIP1、もう一つがローカルループバックアドレス(127.0.0.1)なのだろう。これはLANカードが増えるとIP3、IP4・・・となるので、一番下のIPALL以外全て無効にしよう。 > （５）IPAllのTCP動的ポートを消し、TCPポートにマシン上存在しないポート番号を指定（例：1234） 　ここで指定したポート番号で接続します。前述の通り一般的には1433番。 　まずここまででサーバ側の設定は全て完了した事になる。（５）で指定したポート番号にtelnetで接続してみればうまくいっているか分かるのでとりあえずその確認をしましょう。それとも、「TCP/IPでの導通は既に確認できていて、ユーザ名の登録だけが分からなくってまだ」って事なのかな？　それなら、質問文の「拒否されましたとエラーが出ます。」のところを詳しく。なんでもそうだけど、質問の時にエラーなどのメッセージは可能な限り正確に書かないと、かえって状況を推測する妨げになるのです。「Connection Refused」なのか「Invalid Username/Password」なのかで話が全然違いますので。 とにかく、 １．サーバ側の待ちうけ設定は正しくされているか ２．TCP/IPでの接続は確実にできているか を全部クリアしてからやっとユーザ名の話に移れる訳です。
SQL Serverを使おうというのに、自分でマニュアル類を見る気はないということでしょうか？ 文字連結の指定方法は、標準SQLや主要なRDBMSでは「||」を使います。 また、MySQLのようにCONCAT関数を使用するものもあれば、DB2のようにCONCATというキーワードを繰り返し指定するものもあります。 さて、本題のSQL Serverですが、文字連結は「+」を使います。 ちなみにUPDATEで検索条件を指定しないと、全行更新になりますよ。
組み上げている動的クエリ自体は文字列ですので、 SET @WHERE = 'WHERE Rank > ' + CONVERT(varchar,@Rank) としてみてください。
　ローカルシステムアカウントはビルトインと書かれてある通り最初から存在するアカウントなので改めて作成する必要はありませぬ。 　サービスを実行するためのアカウントで、Windowsファイルとプリンタの共有などもこのアカウントで動作している。 　ローカルシステムは意外と権限が強いので可能であればmssqlなど適当な名前のアカウントを作成し、最小限の権限で動作させる方が理想的。書き込み権限がデータフォルダだけとかね。
>App_Dataの中の*.mdf、*.ldf と書かれていることから、「SQL Server 2005 Express Edition」を使用されているのではないかと推測して、回答させていただきます。 ExpressEditionでは「Integration Services」が同封されていません。 そのため、バックアップするためのスクリプトを書いてWindowsのタスクに登録する必要があるかと思います。 また、ただ単に個人用途として定期的に*.mdfと*.mdlをコピーしたいというのであれば、バッチファイルをタスクに登録する方法でよいかと思います。 例 net stop MSSQL$SQLEXPRESS rem xcopyなどでファイルをコピーする処理を記述 net start MSSQL$SQLEXPRESS
>これは削除してもいいのでしょうか 問題ありません。バックアップのために残るだけですので他のMDBファイルなどに退避してしまいましょう。
データ移行の問題ですようね。 自分作成されたツールがありますから、便利なんです。 2000のテーブルからInsert Sqlを作成して、 2005のテーブルに挿入することができます。 CSVファイルを出力する方法も使ってもかまわないと思っています。
A1=0,A2=0,A3=0,A4=0 B1=0,B2=0,B3=125,B4=0 C1=77,C2=0,C3=457,C4=0 D1=0,D2=5,D3=0,D4=0 E1=2,E2=0,E3=0,E4=0 これってテーブルですか？ A～Eがカラム(列)で、1～4がレコード(行)ですか？ それとも逆ですか？
フォームに ・客先 ・図面番号 ・装置名称 のコンボボックスがあり、それらを選択してから検索ボタンを押下すると保管先が得られる。 既に客先、図面番号、装置名称の値はDBから取得してコンボボックスにバインド済みである。 質問をこのように解釈して回答させてもらいます。 どのようにしてDBと接続しているのかわからないので大まかに2通りの方法を挙げます。 1つ目は、あらかじめDBから保管先も取得しておきます。 おそらく保管先、客先、図面番号、装置名称で一意になるデータと思われますので、コンボボックスの値がわかれば保管先を求めるのは簡単でしょう。 2つ目は、コンボボックスで選択されたデータを元にSQLでデータを取得します。 SELECT A.保管先 FROM テーブル A WHERE A.客先 = @客先 AND A.図面番号 = @図面番号 AND A.装置名称 = @装置名称 上記のようなSQLをDBに投げてやればOKです。
方法はいろいろあると思いますが、同じ掃除箇所を２つ以上のクラスが掃除することがないのであれば、 1)同じ掃除箇所について、その日以降最初に別のクラスが掃除した日を求める 2)それより前で最後に掃除した日を求める 3)グルーピングする という考え方がわかりやすいかと思います。 SELECT [クラス],[掃除箇所],MIN([日付]),MAXDATE FROM (SELECT [クラス],[掃除箇所],[日付], (SELECT MAX([日付]) FROM [掃除当番] WHERE [クラス]=t1.[クラス] AND [掃除箇所]=t1.[掃除箇所] AND [日付]<ISNULL( (SELECT MIN([日付]) FROM [掃除当番] WHERE [クラス]<>t1.[クラス] and [掃除箇所]=t1.[掃除箇所] and [日付]>=t1.[日付]),'2099/12/31')) MAXDATE FROM [掃除当番] t1) tmp GROUP BY クラス,掃除箇所,MAXDATE
これでどうでしょうか？ AにあってBに無い場合も考慮してLEFT JOINにしました。 もしBに無い場合に予測金額も出したくないのでしたらINNER JOINに変更して下さい。 SELECT T.品番, T.予測金額, SUM(ISNULL(T.確定金額,0))AS 確定金額 FROM ( SELECT A.品番, A.予測金額, B.確定金額 FROM テーブルA A LEFT JOIN テーブルB ON A.品番 = B.品番 WHERE A.品番 LIKE 'あ%' ) T GROUP BY T.品番, T.予測金額
>アドホッククエリにするしかないですかね。 SQL Serverでは、そう呼ぶのですね。 そういうことだと思います。
SQL Server のご利用されているエディションは何でしょうか？ 上位エディションであれば、「SQL Profiler」というのが SQL Server 2005に同梱されていますので、その「SQL Profiler」を 使って、どんなアクセスがあり、どんなSQL・ストアドを実行したのか一目でわかるものがあります。 SQL Server 2005 の SQL Profilerのリファレンス http://technet.microsoft.com/ja-jp/library/ms173 … もしSQL Server 2005の下位エディション（Express版）をご利用になっているのであれば、「SQL Server 2005 Express Profiler」というのが 公開されています。 http://code.google.com/p/sqlexpressprofiler/ 参考にして下さい。
こんにゃくは。 ほぼ似たような環境で試してみましたけど。。。 まぁ、直接は出来なかったので別回答で。 ●作業を別ける。 SQLDBのバックアップをネットワーク上の共有フォルダに取る。 では無く SQLDBのバックアップを作成する。 作成したバックアップファイルを共有フォルダにバックアップする。 ですかね。 まぁ。。。 ひとまず、SQLServerの保守計画やら、定期ジョブやらの機能で、サーバ上のどこかにバックアップファイルを作成します。 次に、Win2003のシステムツール内にある「バックアップ」から、バックアップするジョブを作成して、スケジュール等を組んで、定期ジョブとして設定する。（「バックアップ」は、WinXPあたりから、デフォルトで提供されているツールですので探してみてください。 まぁ、二段階で定期ジョブ～を組む。。。って感じで。 ●ネットワークドライブのパスを指定する。 バックアップファイルの保存指定先として「\\サーバ名\drv_d」のように、ネットワーク上の別PCから覗けるような、ネットワークドライブ（？）パスを指定する。 。。。って、ここまで書いて、そんな大変じゃないやと思って試してみましたが、こっちで出来ますね。。。(´・ω・`)（上の行書き込んだ時点では試してなかったので。。。
説明不足ですみません。 convert関数は、SQL-Server側の関数です。 VBA側ではなく、SQL-Serverへ渡しているクエリ内に含めて大丈夫です。 2008/05/01 がWK_HIZUKEという変数に格納されているとすると、 SQL_STRING = "～ WHERE A_date > convert(datetime,'" & WK_HIZUKE & "' ～" 恐らくこんな感じかな？ 変数でなければ、 SQL_STRING = "～ WHERE A_date > convert(datetime,'2008/05/01' ～" こんな感じ？
申し訳ありません。 VBとの連携となるとちょっと知識がないので、何ともいえないのですが、 http://www.atmarkit.co.jp/fdotnet/vblab/vsdbprog … この辺のサイトが参考になるのではないでしょうか。 状況から判断すると、どこかのタイミングでトランザクションが切れてしまっているようですね。 > また、Select文発行時に、ロックされているか判定する方法も教えて頂けないでしょうか。 sql_lockなどのコマンドでロックされているオブジェクトがあるか？は確認できたような気はしますが、この情報だけではどのテーブルが？までは分からなかった気がします。 現在、SQL-Serverの環境が無い為、また後ほど回答させてください。 ちょっとできるか自信がありませんが。 なんか、総じてあまりお役に立てずに申し訳ありません。
＞クライアント側では、どうすることも出来ないということでしょうか？ JavaScriptなどを使い、桁数のチェックをする処理を追加すればできないこともないですが、今回の事象を聞いている限りちょっと違うようですね。 こういうエラーが起きないよう、例えば、5文字までしか入力できないのに、桁をオーバーして6文字分入力されてしまったというケースがあった場合、「5文字以内で入力してください」等のエラーメッセージを出してあげるのが一般的です。 ちなみに、「そのページにアクセスする」といっても、何かを入力した後、ボタンを押して表示されるページのことを「そのページにアクセスした」とおっしゃっているのか、そのページのURLを直に指定して「そのページにアクセスした」とおっしゃっているのかはわかりませんが、もし後者であれば、プログラム内部で保有している固定値が許容範囲の桁数を持つデータを保持しているためにエラーになってますので、いずれにしてもそのプログラム内部を改修しない限り、この現象は永遠に解決しないと思います。 どなたかわかる方にプログラムを見てもらうなり、もしくはある程度、この件を任されているのであれば、ASPがわかるプログラマさんや、ご自身が、サーバー側に設置しているソースコードを修正するしか方法はないのではないでしょうか？ このプログラムの具体的な仕様を明示し、またエラーを具体的にどう修正したら良いか？という質問であれば、皆さん答えられると思いますが、 ＞IEやSleipnirだとこのエラーが表示されますが、Apple Safariだとエラーは起きませんでした。 だけだと、結果的にどうされたいのか？伝わらないと思いますよ。 要点をもう少し詰めて、このプログラムは本来どういう動きするのが正しいのか？補足を下さい。よろしくお願いします。
>serverPCもクライアントPCもWindowsXP サーバーにXPはありませんが、2003でしょうか？ アップサイジングウィザードは、かなり簡素なテーブルでしか 通用しません。（フィールド数やデータ数が多いとだいたい落ちます） アクセスからテーブルをエクスポート、あるいはSQLサーバーからテーブルをインポートし、リンクさせることでやってみてください。
SQL Server 2005 エディション別機能比較表 http://www.microsoft.com/japan/sql/prodinfo/feat … SQL Server 2005 Express Edition 概要 http://www.microsoft.com/japan/msdn/sqlserver/ex … -------------------- エンタープライズ機能はサポートされていません。 CPU は 1 つに制限されます。 バッファ プールが 1 GB に制限されています。 データベースは最大 4 GB まで拡張可能です。 データベース エンジンにはそれ以外のワークロードに違いはなく、他のエディションと同等のパフォーマンスを示します。 -------------------- 高度な機能を使わない、大きなデータを扱わないのであれば、 SQL Server Express Edtion と SQL Management Studio Express で十分でしょう。
SQL Server 2005で動けばいいのですよね？ SQL例です。 select coalesce(max(seq), 0) + 1 as gap from (select seq, Row_Number() over(order by seq) as Rank from SeqTbl) where seq = Rank; http://codezine.jp/a/article/aid/1269.aspx
質問者の内容とおり、以下のテーブルを作成しました。 CREATE TABLE [dbo].[対象テーブル]( [Seq] [bigint] IDENTITY(1,1) NOT NULL, [基準日|変更フラグ|連番|銘柄コード|項目1] [varchar](50) NOT NULL, ) INSERT INTO 対象テーブル select '080612|1|001|CD0002|01010101' union select '080613|1|001|CD0002|01010101' union select '080614|1|001|CD0001|11001100' union select '080614|1|002|CD0002|11111111' union select '080615|1|001|CD0001|10101010' union select '080615|9|002|CD0002|01010101' union select '080615|1|003|CD0002|01010100' CREATE FUNCTION CTE() RETURNS @TEMP TABLE ( 基準日 varchar(6), 変更フラグ varchar(1), 連番 varchar(3), 銘柄コード varchar(6), 項目1 varchar(8) ) AS BEGIN declare c1 cursor for select [基準日|変更フラグ|連番|銘柄コード|項目1] as str_A from 対象テーブル declare @wk_str varchar(50) declare @wk_基準日varchar(6), @wk_変更フラグvarchar(1), @wk_連番varchar(3), @wk_銘柄コードvarchar(6), @wk_項目1varchar(8) open c1 fetch next from c1 into @wk_str WHILE @@FETCH_STATUS = 0 begin set @wk_基準日= substring(@wk_str,1,6) set @wk_変更フラグ= substring(@wk_str,8,1) set @wk_連番= substring(@wk_str,10,3) set @wk_銘柄コード= substring(@wk_str,14,6) set @wk_項目1= substring(@wk_str,22,8) insert into @TEMP(基準日, 変更フラグ, 連番, 銘柄コード, 項目1) values (@wk_基準日, @wk_変更フラグ, @wk_連番, @wk_銘柄コード, @wk_項目1) fetch next from c1 into @wk_str end close c1 DEALLOCATE c1 RETURN END ※使い方↓とおり select * from cte() 上記を利用すればクエリを作成し、参照できるかとおもいます。 ご参照ください。
内側のクエリで付けた別名を、その外側のクエリで利用することは可能です。 ＜例＞ select x.c1,x.c1*10 as c2 from (select 1 as c1) as x
ANo.1です >メインPC上でACCESSからSQLにデータは入れれたのですが。。。 >今そこで止まってます。。 別にSQLServerをインストールしたPCからでも他のPCからでも扱いは変わりません。接続先がlocalhost\SQLXPRESSでなく（接続先コンピュータ）\SQLEXPRESSになるだけです。SQLServerをインストールしたPCで適切なセキュリティ構成（リモート接続の許可とかファイアウォールの例外設定とか）は必要ですが・・。
箇条書きで、わかる範囲で回答します。 ＞SQL Server 2000でのbulk insert とはどういうものなのでしょうか？ 一言でいえばCSV形式のファイルをテーブルやビューに、一括して取り込むコマンドです。 CSV形式は、タブやカンマ区切りをはじめ、どんな項目区切り文字でも対応可能で、INSERT文で登録処理するよりもBULK INSERTの方が、高速に処理できることから、私は愛用しています。 ＞csvにヘッダーがある場合除くなどもできたりするのでしょうか？ はい。できます。正式には、FIRSTROW というオプションを使って、データ読み込み開始行を指定することで、ヘッダ行を読み込まないようにすることができます。 例えば、１行目がヘッダ行、２行目以降がデータ行の場合は、FIRSTROW というオプションに「2」を指定することで、ヘッダ行を読み込むことなく、処理することができます。 詳しくは、 http://msdn.microsoft.com/ja-jp/library/ms188365 … をご覧下さい。 ＞できれば、具体的なコマンドの書き方もご教示ください。 どんなCSVファイルを読み込みたいか？にもよりますが、 今回のお話を聞いている限りの仕様だと、 -- タブ区切りのCSV BULK INSERT [dbo].[OutputTable] FROM 'c:\aaa.csv' WITH ( FIELDTERMINATOR ='\t', FIRSTROW = 2, ROWTERMINATOR = '\n' ) みたいな感じですね。 また、レスポンスを意識し、ある程度、１レコード長の長さが わかっているのであれば、BATCHSIZE というオプションを使用すると 高速に処理できることがあります。 詳しいことはすべて、マイクロソフトのMSDNに詳しい使い方を サンプル付きで掲載していますので、ご参考にしてみてください。 http://msdn.microsoft.com/ja-jp/library/ms188365 … 参考URL：http://msdn.microsoft.com/ja-jp/library/ms188365 …
レプリケーションを停止するには、SQL構成マネージャーで SQLServerAgentを停止すると、レプリケーションのJOBが 全て止まります。 テーブルのデザイン変更などの時はいつも止めています。
仕様です。ORACLE、DB2、Postgresql、Mysql、ACCESSでも同じ結果が返り ます。 Sqlserverなら SELECT t.id,count(テーブルA.社員番号) FROM ( select '00004' as id ) as t left join テーブルA as t2 on t2.社員番号 = t.id group by t.id; でお望みの結果が得られるのでは。
ANo.1です。 なるほど、であればやっぱりバックアップです。 保守計画ウィザードを色々といじってみて下さい。 DBなので、何があってもバックアップだけとっておけば何とかなります。 ※アクセスで複数接続して稼動していたDBであれば基本的にアップサイジング後の運用にそんなに問題ないはずです。
http://oshiete1.goo.ne.jp/qa4089307.html にも、ご質問UPされていたので、念のため、こちらにも回答しておきますね。 ご提示頂いたテーブル名を「TEST」と定義してお話しますね。 いろんなやり方がありますが、私なら、 SELECT 　MAX(date), 　grade_id, 　point FROM TEST GROUP BY 　grade_id, 　point とかやりますね。試してないので確実ではないですが、 一度、上記のイメージでやってみてください。 ちなみに、関係ありませんが、「Disthinct」ではなく、「DISTINCT」が正しいスペルになりますので、今後スペルミスに気を付けてみてください。
No1の方のSQLがヒントです。最新日付と結合するデータが、目的のデータと考えます。 SELECT A.* FROM TTT AS A INNER JOIN (SELECT MAX([date]) AS MaxDate,grade_id FROM TTT GROUP BY grade_id) AS B ON A.[date]=B.MaxDate AND A.grade_id=B.grade_id テーブル名をTTTと仮定しました。 dateはAccessでは組込み関数名と同名なので、[]を付けました。 全てのフィールドが同じになるレコードが無い場合はDISTINCTは不要です。
私もまったく同じことをやってみました。 結果ですが、スキーマ名（dbo）とXMLスキーマーコレクションの名前を [] で囲ってみてください。そうするとエラーがなくなります。 例：DECLARE @xml xml ([dbo].[schema_test]) それから、 SET @xml = '<root> <A>AAA</A> <B>BBB</B> <C>ooo</C> </root> ' とやると、rootノードがないとエラーになります。 その先、何がしたいのかまで掲載されていないので、あえてここでは 触れませんが、一応、私が検証したコードを掲載しておきますね。 -- graf_さんのXMLスキーマ DECLARE @xml xml ([dbo].[schema_test]) -- OPENXML用のハンドル DECLARE @DocHandle int -- graf_さんのスキーマからOPENXML用のハンドルを取得する EXEC sp_xml_preparedocument @DocHandle OUTPUT, @xml -- graf_さんのスキーマをSQLを使って開いてみる SELECT * FROM OPENXML (@DocHandle, '/root',1) WITH (A varchar(max), B varchar(max), C varchar(max)) -- OPENXML用のハンドルを削除 EXEC sp_xml_removedocument @DocHandle 以上、ご参考になれば幸いです。
全く見当違いの回答だったら申し訳ありませんが、 SQL 2005 Expressを初期設定でインストールした場合なら "SQLEXPRESS"と言う名前付きインスタンスでインストールされます。 その場合のデータソース名は、"<サーバ名>\SQLEXPRESS"となります。
いれようと思っている sql server のバージョンはなんですか？ iis がないっていってるのは、sql server が使いたいと思っているバージョンの iis がみつからないからじゃないですか？
WEを使ったことがないので正確にはわかりませんが、マイクロソフトのサイトを見る限り、WEはEE（最上位エディション）と機能的に同等なので、WEでできることは全てできると思います。 ただ、WEにない機能も含めることができるので注意が必要ですね。 参考URL：http://www.microsoft.com/japan/sql/prodinfo/feat …
attach、detachを行えばできます。 参考リンクを張っておきます。 参考URL：http://support.microsoft.com/default.aspx/kb/224 …
ManegmentStudioがあるなら簡単にできますよ。 オブジェクトエクスプローラのデータベース欄を右クリックして、新しいデータベースを選択して、名前を決めてOKを押します。 仮にtestというデータベース名にしたとすると、オブジェクトエクスプローラにtestと書かれた黄色いアイコンが出ます。 これを展開していくとテーブルと書かれたアイコンがありますので、これを右クリックして新しいテーブルをクリックします。 列の定義などをする画面になりますので、適当に入力するとテーブルができあがります。
select A.id,A,name from A left outer join B on A.id=B.id and B.hiduke="20080531"; を実行してみて下さい。 wagonahruさんのSQLだと結合した後の表に対して抽出を行っています。 ですから何もデータが返って来ないのだと思います。 あとデー等を質問欄に書くと返答が早くもらえると思いますよ。
回答のSQLをそのまま使っていますか？ create table aside ( no int ) insert into aside values (1); insert into aside values (1); insert into aside values (3); insert into aside values (2); insert into aside values (1); create table bside ( no int, bname varchar(10) ) insert into bside values ( 1,'test1'); insert into bside values ( 2,'test2'); insert into bside values ( 3,'test3'); insert into bside values ( 4,'test4'); で SELECT B.No ,B.BName ,COUNT(a.no) AS Count FROM Aside AS A right JOIN Bside AS B ON A.No = B.No GROUP BY B.No ,B.BName は No BName Count ----------- ---------- ----------- 1 test1 3 2 test2 1 3 test3 1 4 test4 0 にこちらの環境ではなります。 回答の「count(a.no)」を「count(*)」や「count(b.no」にするとcountが １になります。
ご利用されているデーターベースは、SQL Server で宜しいでしょうか？ また、可能であれば、ご利用になっているSQL Serverのバージョンを教えて下さい。 具体的なバージョンを示して頂ければ、別ユーザに移行するSQL Scriptの情報をご提示致しますが、方法論としては、移行前ユーザの情報をすべて、ひっぱりだして、その情報を元に新しいユーザを作るというやり方になるかなと思っています。 ひとまず、SQL Server のバージョンを教えてください。 宜しくお願いします。
・サーバー(SQLServer) ・クライアント(Access) というような構成で、テーブル間はAccessのリンクで接続しているということでしょうか？ SQLServerはデフォルトではリモート接続が許可されていませんので、リモート接続の設定を行わなければなりません。 参考URLを記載しておきます。 参考URL：http://support.microsoft.com/kb/914277/ja,http:/ …
select A.列１ ,B.列３ from A left join B on a.列２=b.列２ where b.列１='aaa'
スタートメニューから辿っていくと、 トレースを取得するツールが存在すると思います。 　SQL Server 2000：プロファイラ 　SQL Server 2005：SQL Server Profiler MSDEなど管理ツールがない場合は、 ストアドプロシージャを作成して取得する方法があります。 使い方などは下記URLがわかりやすいかと思います。 参考になれば幸いです。 参考URL：http://www.sqlpassj.org/tokushu/dba/01.aspx
SQLやProfilerのトレースではなく、具体的に、これらの処理を実装している、ソースを見せて頂けませんか？ （まずい箇所は加工して頂いて結構なので） そういう意味で、この補足をお願いしてたのですが、言い方が悪くてすいません。 ソースを見ない限り、トランザクションの単位もわかりませんし、 分離レベルの状態もどうなっているのか予測がつきません。 ＞＞また、トランザクションは、１つ目のSELECT FROM UPDATE FORと ＞＞２つめのUPDATE文で違うトランザクションなのでしょうか？ ＞＞（SQL Profilerからの結果では予測ができませんでした） ＞COMMITまでが一つのトランザクションならば、一つのトランザクションだと思います。 だと思いますだと、はっきりしたことがご回答できないので、やはりストアドやSQL、もしくは、他のプログラミング言語(VBやC#等)で記述されたものが公開されてないと、情報が少なくて、回答に困ってしまうと思いますので、情報をもう少しだけ精査して頂き、そのうえで対処方法をご回答いたします。 すべては、「ソースに始まり、ソースで終わる」　です。 宜しくお願いします。
質問が曖昧です。 「データを移行できるか？」ならば既に回答が出ているとおりですが、通常データーベース・アプリケーションはデータとそれを操作するための（アクセスならば）フォーム、クエリー、レポートなどの組み合わさったものです。つまり 「アプリケーションのデーターベースを移行できるか？」と云うことであれば、フォームやレポートなどをC＋＋やVBで書いてあれば比較的簡単、アクセス自体に依存しているならば大変な作業になるでしょう。
クロス集計のようなことをやりたいのですよね？ select pc_name, sum(case when soft_name='soft1' then 1 else 0 end) as soft1, sum(case when soft_name='soft2' then 1 else 0 end) as soft2, sum(case when soft_name='soft3' then 1 else 0 end) as soft3, sum(case when soft_name='soft4' then 1 else 0 end) as soft4, sum(case when soft_name='soft5' then 1 else 0 end) as soft5, sum(case when soft_name='soft6' then 1 else 0 end) as soft6 from t1 group by pc_name
SQL server というジャンル名ではなく、 「マイクロソフト SQL server」 というデータベースの商品名です。 聞きたいのは、どのデータベースが初心者に向いているか？ ということではないのですか？ そうであれば、 MySQLやPostgreSQLが普及率的に多いです。 簡単かどうかはまた別の話。 検索すればさまざまな情報も取得できるし解説本もたくさん出ているという意味では初心者でも手が出しやすいデータベースです。 いい大人が、他人へ質問するときに「ダッチャ」は無いかと思いますよ。 単なる冷やかしかと思ってしまいますよ。
テーブルを全てSQLserverに移植し、MDEファイルでリンクしましょう。 40万件はアクセスのデータ数として現実的ではありません。 ただし、テーブルの構造や作り方によってスピードが変わるか わかりません。DBチューニングで劇的に変わることもあります。 またクエリー→VIEWに、VBAでのレコードセット呼び出しをDAOやADOに 書き換えることによってアプリケーションとしての動きが劇的に 早くなることもあります。 要は、ネットワーク上やローカルに引っ張ってくるデータをできるだけ 少なくするにはどうしたらいいか設計すること。できるだけクエリー処理などをSQLサーバーでさせるようにし、MDEは最小限のデータを表示 するインタフェイスとして考えること。 こういったことが必要です。 上記の内容の理解に時間がかかるようであれば悪いことは言いません。 プロに任せましょう。
SQL Server 2005 SP1 で対応されたフェールオーバー + ミラーリング機能ですね？ また、プリンシパルサーバーとミラーサーバーの他に 「ミラーリング監視サーバー」を設置されていますよね？ さらに、「プリンシパル（データーベース）サーバー」は、 完全復旧モデルになっていますか？ ＃関係ないですが、 　「フェイルオーバ」ではなく、「フェールオーバー」です。 ＃http://www.microsoft.com/library/media/1041/japa … の図を見ながら、お話します。 さて、通常フェールオーバーを可能にしている場合は、クライアントからアクセスされる「外向けのネットワークアドレス」は必ず１つになるはずです。 プリンシパルサーバー・ミラーサーバーは内部向け（別セグメント）でのIPアドレスを割り当て、プリンシパルがDownした時、ミラーの方に、フェールオーバーするので、プリンシパルサーバー・ミラーサーバーだけの内部ネットワークに関して言えば、IPアドレスは切り替わります。 （物理的に、使用するサーバーが変わったと認識するので） ただし、外向け（外部）公開用のIPアドレスに関しては、切り替わることはありません。固定です。 恐らくミラーリング監視サーバーが、プリンシパル・ミラーのどちらかがアクティブになっている方のサーバーのデータベースインスタンスを使用するということを判定していますので、外向けからは、プリンシパルのDBが稼働しているのか、ミラーのDBが稼働しているのかは、わかららないようになっているためです。 まったくこの辺りは試していませんが、 http://www.microsoft.com/japan/sql/facts/compare … を見る限り、クラスタ系のフェールオーバーも、ミラーリングのフェールオーバーも同じかなと思った次第です。 自信はありませんが、ご参考になれば幸いです。
該当テーブルの右クリックメニューでスクリプトを出力するメニューがありませんでしょうか。 手元にSQL Server 2005しかないのですが、「名前を付けてテーブルをスクリプト化」というメニューがあります。 参考になれば幸いです。
key1、key2が文字の場合、こんなのも可能です。 SELECT * FROM tblA WHERE key1 + "^" + key2 in (SELECT key1 + "^" + key2 FROM tblB) "^"の部分は、キーに出現しない文字列にします。 数値でしたら、 CAST(key1 AS VARCHAR)のように文字列に変換します。 インデックスが使えませんので、テーブルのサイズによっては遅いかも知れませんが。
ADOで解決したみたいですが、DAOでODBC接続して更新するにはODBC Directを用いる必要があります。 こんな感じです Dim Cn As DAO.Connection Dim ws As DAO.Workspace Dim rcdst1 As DAO.Recordset Dim strCnct As String Dim strSQL As String strCnct = "ODBC;Driver={SQL Server};SERVER=(local);DATABASE=pubs;UID=xxx;PWD=xxx;" 'ＤＢ接続 Set ws = DBEngine.CreateWorkspace("", "", "", dbUseODBC) Set Cn = ws.OpenConnection("", False, False, strCnct) strSQL = "SELECT * FROM Table1" Set rcdst1 = Cn.OpenRecordset(strSQL, dbOpenDynaset, dbExecDirect, dbOptimistic) rcdst1.AddNew rcdst1!ID = 1 rcdst1!Name = "aaa" rcdst1.Update http://msyk.net/vb5db/ODBCDirect.html http://www.ie.reitaku-u.ac.jp/~ykago/lectures/db …
接続文字列はどうなっていますか？接続先がサーバ名のみ（サーバ名\SQLEXPRESSになっていない）ということではないですよね？ ウチの環境だと・・ Access2002からはODBCのドライバで「SQL Native Client」でも「SQL Server」でも繋がってます。DelphiのADOコンポーネントからは「SQL Native Cliebnt」でも「Microsoft OLE DB Provider for SQL Server」でも接続可です。 （蛇足ですが）後者で「Microsoft OLE DB Provider for ODBC Drivers」では繋いだとこがありません。が、試したところODBCのデータソース定義を指定してちゃんと繋がりました。 ということで「Microsoft OLE DB Provider for SQL Server」でちゃんと繋げてます。言語は違いますが接続の可否は参考になるでしょう。
ワンクッション入れて、全体数がゼロだった場合に遅延率を0かNULLにすれば いいのではないでしょうか。 SELECT CASE WHEN 全体計=0 THEN NULL ELSE 未入荷計/全体計*100 END AS '遅延率(%)' FROM (SELECT COUNT(CASE WHEN CONVERT(CHAR(10), 納期, 111) = GETDATE() AND 入荷数 = 0 THEN 0 ELSE NULL END) AS 未入荷計, COUNT(CASE WHEN CONVERT(char(10), 納期, 111) = GETDATE() THEN 0 ELSE NULL END) AS 全体計 FROM ...
「トランザクション 分離レベル ファントム」などで検索することをおすす めします。 MS SQL-SERVERの分離レベルはデフォルトでは「READ COMMITTED」なので、 トランザクション単位では読み取りの一貫性を保証しません。 他のトランザクションが挿入しCOMMITしたデータをUPDATE段階で読み込んで しまいますね。 だからといって分離レベルをSERIALIZABLEに上げると、パフォーマンスの劣化やデッドロックエラーが頻発する危険が大きいです。 楽観的ロックでループ回すのが一般的かもしれませんね。
日付の形式(yyyymmddなど）とデータ型は何ですか？ datetime型やchar(8)などに格納している場合と、年、月、日を別の列にしている場合など、条件が大幅に違ってきます。
aspnet_regiis.exe というファイルが、.NET Frameworkをインストールするとできますので、そのコマンドでASPNETユーザを作成してください。 コマンドライン %windir%\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe -i .NET Framework2.0 であれば、 %windir%\Microsoft.NET\Framework\v2.0.50727 の下にaspnet_regiis.exeがいると思いますのでご確認ください。
Enterprise ManagerはSQL Server2000等に付属していた管理ツールですが、SQL Server 2005では廃止され、Management Studioというものになっています。これはSQL Server Express with Advanced Servicesにも含まれるので、無償で利用可能です。まずこれをインストールしておいたほうが後々管理しやすくなるはずです。 http://www.microsoft.com/downloads/details.aspx? … Management Studioで該当のサーバに接続し、セキュリティ->ログインにユーザーASPNETを追加、その際サーバーロールを設定する項目があるので、そこでdbcreatorにチェックを入れておけばASP.NETでもCREATE DATABASEが使用できるようになると思います。 参考URL：http://www.microsoft.com/downloads/details.aspx? …
まずはManagement Studioから接続できるか確認してみるのがよろしいかと思います。 Management StudioはSQL Server用の管理ツールです。 Express Edition版はMicrosoftから無償でダウンロードできます。 接続する際の注意点としてはSQL Server 2005 Express Editionでは既定のインスタンスが固定されていますのでサーバ名は『[サーバー名]\SQLEXPRESS』としなければなりません。 また、初期設定ではネットワーク接続ができない仕様となっていますので注意してください。（設定を変更すれば接続できます） また、SQLの勉強でしたらManagement Studioでもクエリアナライザがありますので十分可能です。 慣れるまでに大変かもしれませんががんばってください。 参考URL：http://www.microsoft.com/Downloads/details.aspx? …
ここはMS SQL Serverに関する質問を扱うところなので、MYSQLについての 質問をするのはちょっと筋違いでは。 http://tomo.ac/goodstream/database/mysql/linux/t … の「CSVから入力（インポート）する方法」が参考になるかもしれませんが。 MYSQLの方で改めて質問したほうが適切な回答が得られると思いますよ。
マイクロソフトのサイトにSQLサーバーの自習書があります。 ご参考にしてみてはいかがでしょうか。 参考URL：http://www.microsoft.com/japan/technet/prodtechn …
検索のキーを同じ方法で暗号化すれば、検索できるのでは? 例えば、keyというカラムに f() で暗号化した値が入っているとします。 その時、WHERE句で f(探したい値) = key を指定すれば、持ってこれると思います。 質問の意味を取り違えていたら、すみません。
これは参考になりますか？ http://forums.microsoft.com/MSDN-JA/ShowPost.asp …
select id,max(col1),max(col2),max(col3) from テーブル名 group by id; で一応できるようですが。
VisualStudio Professional でないと、SQLのデバッグを行なうことができません。 自分もSQLのデバッグを目的にSQLServer2005Developerを購入しましたがデバッグできず、ここ数日調べ回っていました。 ではSQL2005に入っているVS2005のエディションは何かと言うと、Standardだとのことです。 参考リンク： SQLServer2005のストアドプロシージャのデバックの設定方法をご教示ください -OKWave http://okwave.jp/qa3665478.html MSDN　T-SQLのデバッグ http://msdn2.microsoft.com/ja-jp/library/ms165045(VS.80).aspx
次の2つのSQL文を書けばいいのでは? ストアドプロシージャで、ループを書くより効率もいいと思います。 ところでこの例では、テーブルBは区分しか持ってませんが、もちろん他のカラムもあるんですよね。 そのときは。SELECT文で必要な値を取得してくださいね。 INSERT INTO テーブルB(区分) SELECT 1 FROM テーブルA WHERE 区分1 <> 0; INSERT INTO テーブルB(区分) SELECT 2 FROM テーブルA WHERE 区分2 <> 0;
「リンクサーバー」を設定します。 http://msdn2.microsoft.com/ja-jp/library/ms18827 … 設定すれば SELECT a.*,b.* FROM [データベース名１].[dbo].[テーブル名１] AS a INNER JOIN [リンクサーバー名].[データベース名２].[dbo].[テーブル名２] AS b ON a.ID=b.ID と書けます。
調べた限りでは、VB2005 express editionでMDFを指定してスタンドアロン のアプリケーションと他のアプリケーションは同時には実行できないようで す。 やるとすれば、以下の手順で作り直しになりそうです。 ・MDFを指定して最初のフォームのデザイン画面を出してプロジェクトを 　閉じる ・app.configを編集。たとえば <?xml version="1.0" encoding="utf-8" ?> <configuration> <configSections> </configSections> <connectionStrings> <add name="WindowsApplication1.Properties.Settings.pubsConnectionString" connectionString="Data Source=.\sqlexpress;Initial Catalog=pubs;Integrated Security=True" providerName="System.Data.SqlClient" /> </connectionStrings> </configuration> ・プロジェクトを開きなおす。 ・でプログラミングをやりなおす。
「visual basicとSQLserver2005Expressを利用してスタンドアロンで利用するシステム」 とはVisual Basic Express EditionでMDFファイルをスタンドアロンで使用 するものでしょうか？ でしたら、そのシステムはMDFファイルを排他的に占有してしまいますから ASP.NETと同時に利用することは出来ません。 VisualBasicのEditionをあげてリモート接続するように変更するようにして ください。
SQL Serverも、バージョンによってSQL実装の状況が違いますから、明記するようにしてください。 差分検索ですぐに思いつくのは、以下のようなSQLです。 -- 例1 not existsを使う select * from 個人ファイル as pf1 where not exists (select 1 from 個人ファイル２ as pf2 where pf1.個人ＮＯ=pf2.個人ＮＯ) -- 例2 not inを使う select * from 個人ファイル where 個人ＮＯ not in(select 個人ＮＯ from 個人ファイル２) -- 例3 outer joinを使い、対応するキーがなかった行を検索 select pf1.* from 個人ファイル as pf1 left join 個人ファイル２ as pf2 on pf1.個人ＮＯ=pf2.個人ＮＯ where pf2.個人ＮＯ is null
これでどうですか？ SELECT 　列A * ( DATEDIFF( Day, 列B, 列C ) + 1 ) FROM 　テーブル名 質問文を勘違いしていたらすみません。
http://www.atmarkit.co.jp/fdotnet/basics/adonet0 … の「paramins.cs」が参考になるのでは。
当方SQLServerとかやったことありませんが聞きかじりで > ISNUMERIC(b) ISNUMERIC(cast(b as bigint)) たぶん精度オーバーのように見えます。 詳しくはcastかconvert関数? を見てみると幸せになれるかも。
こんばんは 自分もライセンスとか詳しくないんですが、 ＞３． は、やばくないですかね？ プロセッサライセンスとやらを購入していれば問題さそうですけどODBCだからと言ってのライセンス不要とは書いてないっぽいので #詳しい方つっこみお願いしますぅ 参考URLを貼ったので参照されてはどうでしょう？ 参考URL：http://www.microsoft.com/japan/sql/prodinfo/comp …
　もしかして、質問の趣旨を誤解しているかもしれません。その節はご容赦を。 　具体的な名前にすると、たとえば、住所・氏名・電話番号が入ったテーブルがあって、これを、あるユーザーは、「住所・氏名・電話番号」の順番で出したいし、別のユーザーは、「氏名・住所・電話番号」と出したいとか・・・そういう意味でしょうか？ 　とすれば、これは一つの固定したＳＱＬでやるには無理があるように思います。 　たとえば、 　select A B C D from TB; 　とすれば、出力は、 　1 2 3 4 　となりますし、 　select A C D B from TB; 　とすれば、出力は、 　1 3 4 2 　となります。 　では、これを可変にするには、アプリケーションで、ユーザーの要求にあわせて、その場でＳＱＬ文を構築してそれをデータベースに発行するしかありません。 　アプリの言語がわからないので抽象的になりますが、 　"select　"と 　フィールド名をスペース区切りで希望の順番に並べた文字列 　" from TB;" 　の３つの文字列を連結して、この結果をＳＱＬ文としてデータベースに渡すというカタチです。（動的ＳＱＬといいます）
老婆心 http://www.google.com/search?client=opera&rls=ja … http://www.google.com/search?client=opera&rls=ja …
SQL Server Management Studio Express というものを ネットからダウンロードしてください。 ＭＳのサイトにあります。 それを起動してサーバーに接続したら（Windows認証がいいです） 左のオブジェクトエクスプローラで「データベース」で右クリックし、 「新しいデータベース」を選びます。 出てきたダイアログで 「データベース名」を入れてＯＫします。 次に、できたデータベースを展開し、 「テーブル」を右クリックして「新しいテーブル」をクリックします。 するとテーブル定義のウィンドウが開きますので、 あとはだいたい Access と同じです。 なお、いらなくなったテーブルやデータベースは勝手に削除しては いけません。 必ずこの Management Studio を使って削除してください。
はじめまして。以下、長文ですが回答いたします。 １.データベースサーバーとは何か？ データベースをインストールしたPC = データベースサーバという認識で、概ね問題はないと思います（時によりですが、データベースソフトそのものをデータベースサーバと言う事もあるでしょう。IISというソフトそのものをウェブサーバと呼ぶように）。 ウェブサーバとデータベースサーバを別々のPCに別けるかどうかは、また別の問題です。 よくあるパターンとしては、開発時には１つのPCに IIS とSQL Server をインストールして開発を行い、実稼動時には物理的に別々のPCにウェブとデータベースを別けるなんてやり方があります。 ２.データベースは何がよいか？（SQL Serverでよいか？） 質問の内容を拝見する限りでは、機能面的にはどれでも大差ないというのが実感です。 １万～３万レコードというのは、商用RDBで扱うボリュームとしては、かなり小規模な部類に入ると思いますので、高速性云々を気にされているようですが MySQL を選んだために致命的に遅くなったということは無いと思います（当然、ミリSec、マイクロSecの差は出ますが、致命的とは言えないですよね？）。 ですので、選ぶポイントとしては、価格、サポート内容、ネット上のコミュニティーの有無、周りに識者がいるかどうかといった点を考慮された方が良いと思います。 そういった意味で、SQLServer を選択されるというのは、有力な選択肢の一つと考えて良いでしょう。 ３．SQL ServerをインストールするＰＣは何が最適か？ XP よりも 2000 の方が安定しているかどうかというのは、大変難しい問題な気がしますが、2003Server が使えるのであれば、それをお勧めします。セキュリティ、サポート、安定性などを考えて、ウィンドウズ系OSとしては、もっとも有効な選択といえるでしょう。 ４.最終的に自分の思っていることと実体の構成（理解）は理解は以下のような感じで正しいのでしょうか？ 正しいです。 正しいですが、必ずしもウェブサーバとデータベースサーバを別ける必要はありません。 金銭的に余裕があるなら、別けるべきですが、１台のPCで構成してもとりあえずは問題なく動くでしょう。パフォーマンスの問題も、さほど気にならないと思います。 ただし、障害時復旧という観点から言えば、断然別けるべきです。このあたりの話は、話し出すとかなり長くなるので割愛しますが…。 老婆心ながら１点付け加えるならば、「共有データベースで壊れにくい？壊れない？」との記述がありましたが、壊れないデータベースというものはありえません（また、壊れないと明確に謳っているデータベースも無いでしょう）。ですので、マニュアルなどをきちんと読んで、障害時対応の最低限の知識を得ておくことと、バックアップ運用のルールしっかりと決めておくことをお勧めします。 5.SQL ServerのデータベースはＭＤＢのような最適化というような作業が必要なのでしょうか？ 商用RDBはMDBに比べるとだいぶ高級ですので、さほど気にする事はないかと思います。 ただ、delete/insert を繰り返し何度も行うと、パフォーマンスが下がる場合がありますので、１年に１度くらい気にしてあげた方が良いかもしれません。 最適化のやり方は、データベースの実装依存ですので、マニュアルを見るしかありませんが、一般的なTIPSとして、バックアップ⇒TRUNCATE⇒インポートなんてのもあります。 6.SQLServerは行ロックできないか そんなことはありません。ちゃんと行単位でロックできます。 行単位でデータベースにロック命令を出すことを「悲観的ロック」といいますが、このロックのやり方は、真面目に考え出すと結構むずかしく（ロックしたら必ずロック解除する必要があるが、ユーザが途中で操作をやめてしまったら…？）、採用には一考の必要があります。 ちなみに、提示の例ですと、Ａさんが更新を終えるまで、Ｂさんは「更新画面を見れない」ということになると思います。 一般的に、行ロックされたレコードに対する取得要求は即時エラーになるか、ロックが解除されるまで待つかです。ロック解除まで待つ方法を選択した場合、確実にロック解除されるように実装しないととんでもない目にあいます。 排他制御の方法として、悲観的ロック以外に「楽観的ロック」という方法もありますので、導入を検討してみてください。 MDBとRDB（SQLServer等）は、似ている部分もありつつも、本質的にかなり異なるものですので、導入直後はかなりの想定外トラブルに悩まされると思います。 ただ、システムを大規模化していく以上、避けては通れない道だと思いますので、がんばってください。
削除直後～バックアップ直前に損傷したらアウトなので注意してくださいね。 回避案 １）バックアップフォルダを設ける。DTSはここへ出力する。 ２）１）のバックアップフォルダを設ける。 その上で、 タスクによる削除は２）に対して削除を行う。 タスクによって１）のファイルを２）に移動する。 DTSで１）にエクスポートする。
チト、未完成でした。 ____|建物コード|部屋コード|階数| __1|___________1|401_________|_____4| __2|___________2|501_________|_____5| __3|___________3|202_________|_____3| __4|___________3|301_________|_____3| SELECT tab1.[建物コード],tab1.[部屋コード],tab1.[階数] FROM (SELECT Max(階数) AS MAX_FLOOR, [建物コード] FROM tab1 GROUP BY [建物コード]) As X LEFT JOIN tab1 ON (X.[建物コード] = tab1.建物コード) AND (MAX_FLOOR = tab1.階数); ここまではOKだと思います。 問題は、[部屋コード]と[階数]とで条件を設定すれば矛盾が生じることでしょう。 ならば、次のような列[RF]を生成したらどうでしょうか？ ____|建物コード|部屋コード|階数|RF_____| __1| ___________1|401_________|_____4|49599| __2|____________2|401_________|_____4|49599| __3|____________2|501_________|_____5|59499| __4|____________3|101_________|_____1|19899| __5|____________3|202_________|_____3|39798| <-- 最大値 __6|____________3|301_________|_____3|39699| 試しに、X を生成するSELECT文を実行してみます。 ___|建物コード|MAX_FLOOR|MAX_RF| __1|___________1|_______________4|__49599| __2|___________2|_______________5|__59499| __3|___________3|_______________3|__39798| SELECT [建物コード],Max(階数) AS MAX_FLOOR, Max([階数]*10000+(10000-[部屋コード])) AS MAX_RF FROM tab1 GROUP BY [建物コード] これで、首尾よく[階数]最大で[部屋コード]最小を抜き出しています。 ここまでくれば、[MAX_RF]を手掛かりに「部屋コード]と[階数]を特定することが出来るかと思います。
SQLCMD（バージョンによってはOSQL）で下記のようにやっても、NULLが 最後尾に出力されませんか？ create table tbl ( dt nvarchar(5) ) go insert into tbl values ( NULL ); insert into tbl values ( N'01:10' ); insert into tbl values ( N'03:20' ); insert into tbl values ( N'09:10' ); go select dt from tbl order by case when dt is null then 1 else 0 end, dt; go
「実行結果にタイマ」って、何のタイマですか？
パフォーマンスモニタで SQL Server: Buffer ManagerオブジェクトのBuffer Cache Hit Ratioカウンタ あたりを確認してみてはどうですか。
>idを+1表示です select max(id)+1 from 表名 php等で参照するには、 select max(id)+1 as 別名 from 表名 というように、別名を付けます。
> かわりに、MDACドライバをインストールしてみようともしましたが、 > こんどは「このバージョンのWindousと互換性がない」エラーが出ました。 インストールしようとしたMDACのバージョンは何だったでしょうか？ http://www.microsoft.com/downloads/details.aspx? … の「Microsoft Data Access Components (MDAC) 2.8 SP1」の対象OSには、 windowsXPは含まれていません 「MDAC 2.7 Refresh - 日本語版」か 「Microsoft Data Access Components (MDAC) 2.8」 を試してみてはどうでしょうか。
mdbファイルはACCESS依存のファイルなので データの変換作業が発生いたします。 よって、SQL Serverへのデータの インポート作業を行う必要があります。 ちなみに、Express Editionは、 基本的にアプリケーション開発を念頭に置いた DBのみの提供ですので、 上記のようなインポート作業を行うツールなどは 付属しておりません。 もし、yukorin_t様がアプリケーション開発、 特に.NETの知識をお持ちであるなら 簡単にACCESSからのデータを SQL Server Express Editionへ移行可能だと思いますが、 そうでなければ上位バージョンの導入をオススメ致します。
あくまで噂ではありますが 製品出荷時期は第3四半期とか？ http://japan.cnet.com/news/ent/story/0,200005602 … 第3四半期なので９月前後でしょうか。
クライアント側にAccessが必須かどうかは「どういうシステムなのか」に依存します。ウチはDelphi7で作ったアプリでSQLServerを使ってますのでクライアントにAccessはインストールしていません。 ＃Accessを使うにしても、Runtimeだけで良ければ無償ですし・・ SQLServerのどれを使うかは同時接続数やデータベースサイズなどで変わってきます。とりあえず無償のExpress版で様子を見るという選択肢もあります（汗
http://kakaku.com/item/37100310079/ ここにもあるとおり、694,761円ですよ！ とても個人で買える代物ではありません。 私は Express Editon でがまんしていますし、 それで特別困ることはありません。 あ、Management Studio 2005 Express は ダウンロードしておくと便利です。
それぞれ、 Ascending Descending の略です。
恐らくトランザクションログが肥大化していると思われます。参考URLをチェックしてみてください。何か解決策が見つかるかも知れません。 参考URL：http://support.microsoft.com/kb/873235/ja
こちらをご参考に 参考URL：http://msdn.microsoft.com/library/ja/default.asp …
CREATE TABLE TBL ( ID INT PRIMARY KEY, CUSTOM INT, TANTO1 INT, TANTO2 INT, SYOHIN INT, DATE DATETIME ); CREATE INDEX TBL_IDX1 ON TBL ( CUSTOM, SYOHIN, DATE ); CREATE INDEX TBL_IDX2 ON TBL ( CUSTOM, SYOHIN, TANTO1 ); INSERT INTO TBL VALUES (1 ,1 , 10, 10, 999,'2007/01/01' ); INSERT INTO TBL VALUES (2 ,1 , 10, 10, 999,'2007/02/01' ); INSERT INTO TBL VALUES (3 ,1 , 20, 20, 999,'2007/03/01' ); INSERT INTO TBL VALUES (4 ,1 , 20, 20, 999,'2007/04/01' ); INSERT INTO TBL VALUES (5 ,1 , 10, 10, 777,'2007/05/01' ); UPDATE T1 SET T1.TANTO2 = ( SELECT TOP 1 T2.TANTO1 FROM TBL T2 WHERE T1.CUSTOM=T2.CUSTOM AND T1.SYOHIN=T2.SYOHIN ORDER BY T2.DATE , T2.ID ) FROM TBL T1 WHERE EXISTS ( SELECT 1 FROM TBL T3 WHERE T1.TANTO1<>T3.TANTO1 AND T1.CUSTOM=T3.CUSTOM AND T1.SYOHIN=T3.SYOHIN ) かなり冗長なインデックスですが、ここまでしなくても、(CUSTOM,SYOHIN) にインデックスを貼れば、かなりパフォーマンスは違ってくると思いま す。
CSVにエクスポートすれば、どうにでもなるのでは? Sql文を教えてくれ、ってことですか? Sql文を書ける方ですよね?
>>・すでに存在するレコードA1をテーブルAにInsertして（これがCOMMITするまではエラーにならないとして）、COMMITしないうちにSELECTされる >⇒十分にあり得るとは思いますが、この様な場合は、既に存在するレコードA1と新たにInsertされようとした重複するレコードA1’がNolockでSelectした場合2件抽出されることになるのでしょうか？ 理論上はあり得ると思いますね。 ただROLLBACKのログがない、ということですから、これもあり得ないということでしょうか。 エラーになったらROLLBACKされるはずですよね。 となると、いよいよわかりません。
SQL Server 2005では、Oracleでいう分析関数が実装されています。 select 列名1, 列名2 from (select rank() over(partition by 列1 order by 列2) as rk, 列1,列2 from 表名) as x where rk=1
ここは、仕様を提示して、SQLを作ってもらうサイトではありません。 こういった投稿は、「質問でなく、作業依頼」として、削除される可能性があります。 質問内容が、非常に分かりづらく、いろいろな解釈ができてしまいます。 他人が見て、分かりやすい説明をしてください。 また、RDBMSは、ここのカテゴリ通りSQL Serverですか？SQL Serverも2000と 2005ではSQLの機能拡張が行われています。バージョンを明記してください。 >でJOINすると、 >A1 B1 B2 >A1 B1 B3 >が抽出されます。 通常、ジョインする場合は、双方の表に対応するキーを持ちます。これは、直積ということですか？ >ここで、 >A1 B1 B2 B3 >A1 B1 B2 B3 >という風にJOIN先のデータを >両方の行にSelectさせることは可能でしょうか？ データを抽出するルールを説明してください。 データが2行でなく、10行、100行と存在した場合、どういう抽出ルールになるのですか？
こんな感じ。 select cast(convert(varchar(8),dateadd(m,-1,getdate()),20)+'01' as datetime)
説明が分かりづらいですね。 また、仕様を提示して、SQLを作ってもらうというのは、ここでは「質問でなく、作業依頼」として削除される場合があります。 ここでは、自分で考えた上で、具体的に何が分からないかを示して質問することになっています。 １．名前ごとにデータ１の値が最大の行を検索 select * from A as X where データ1=(select max(データ1) from A where 名前=X.名前) order by NO ２．名前ごとに日付が最新の行を検索 select * from A as X where 日付=(select max(日付) from A where 名前=X.名前) order by NO
ここで得られた回答を根拠に導入しても責任取れませんから、ご自分でマイクロソフトに聞いて責任ある回答を得、それを根拠に導入するようにしてください。 まぁ私としてのお勧めは 「プロセッサ ライセンスにする」 ですが。 一応、以下は SQL Server 2005 のライセンス ガイドです。 http://www.microsoft.com/japan/sql/howtobuy/lice … 中央の絵の左側メニュー [ライセンス モデルを選択する際のヒント] を押すと参考になる情報があるかもしれません。 問い合わせはマイクロソフトのカスタマー インフォメーション センターへ電話します。 http://www.microsoft.com/japan/customer/info/pho …
SQL Serverや、IBMのDB2などでは「ロック方式」というものが採用されておりまして、これは対象リソースに対してロックを取得し、同時実行に関する問題がないことを確認してから、実際のデータを読み書きしていく方式です。 よってただSELECTを発行しても、場合によってはトランザクション終了時までLOCKが発生します。 これを回避するにはSELECT文に WITH (NOLOCK)オプションを指定すると解決いたしますが、処理中に変更や削除が行われるテーブルに対してはオススメ致しません(RASISが損なわれる可能性があります) サンプル SELECT DATA_A, DATA_B, DATA_C FROM TEST_TABLE WITH (NOLOCK) WHERE DATA_A = 'aaaa'
前の質問を締め切らずに継続する質問をする行為は、「続きの質問」として、ここでは規約違反です。 RDBMS名とバージョンを明示するように求めましたが、なぜ提示がないのでしょう？せっかく具体的なSQLを提示しても、dekinaikunさんの環境では実行できない可能性があります。 >aとbの数値を引き算しようと考えていますが、可能なのでしょうか？ 可能かどうかと言われれば、可能です。 しかし、RDBには、「前の行」や「後の行」という概念がないので、利用者側で通番を付けるといった工夫が必要になります。また、そういった操作は、SQLだけでやるより、ストアドプロシジャを使うとか、アプリケーション側でやる方が、シンプルだし性能も出せます。 以下のように、表定義やデータを格納するSQLを貼り付けておくと、アドバイスする側としてもすぐに検索SQLの作成に入れるので、多くの人から早くアドバイスをもらえると思いますよ。 １．表定義例 create table tbl1 (seqno int identity(1,1), id int, 数値 int, 更新日付 datetime); ２．格納データ例 insert into tbl1(id,数値,更新日付) values(1,23,'2008/02/23 2:00:00'); insert into tbl1(id,数値,更新日付) values(1,34,'2008/02/23 3:00:00'); insert into tbl1(id,数値,更新日付) values(1,50,'2008/02/23 4:00:00'); insert into tbl1(id,数値,更新日付) values(1,23,'2008/02/23 5:00:00'); insert into tbl1(id,数値,更新日付) values(2,25,'2008/02/23 3:00:00'); insert into tbl1(id,数値,更新日付) values(2,50,'2008/02/23 4:00:00'); insert into tbl1(id,数値,更新日付) values(2,70,'2008/02/23 5:00:00'); insert into tbl1(id,数値,更新日付) values(2,50,'2008/02/23 6:00:00'); ３．検索例 select x.id, x.数値-(select 数値 from tbl1 where seqno=x.seqno-1) as 数値, x.更新日付 from tbl1 as x where x.seqno>all (select min(seqno) from tbl1 where x.id=id) order by x.id,x.更新日付 ;
動的SQLとか動的クエリと言います。 http://www.microfocus.co.jp/manuals/SE40/dbdyna. … SQL Server 2000ではNVARCHER型の変数に対して有効ですが、 変数を+で連結すれば最大80000byteまでの文字列を動的SQLで発行可能だったと思います。
空白ということは、オブジェクトが未指定なのでnullとなるのかと思います。 テキストボックスの値はstring.emptyまたは""(空文字)で初期化されておりますでしょうか？
SQL Serverのバージョンは何でしょうか？ SQL Server 2005なら、Oracleでいう分析関数が実装されています。
>GO は無くても動くと思うのですが、どのような意味があるのでしょうか？ この辺の事情については、詳しい訳ではないのですが。。。 SQL Serverは、SQLをキャッシュに溜め込んで行き、goで実行する仕組みです。 マニュアルの例題を見れば分かると思いますが、SQL Serverは、ストアド・プロシジャを定義しなくても、if文などの手続を含めてSQLを指定可能で、文を溜め込んで、goで実行します。また、「go 実行回数」といった指定で、複数回実行させることもできます。
ここはSQL Serverのカテゴリですが、カテゴリが不適切では？
SQL Server 2000で動くかどうか分かりませんが、SQL例です。 select * from t1 as x where 履歴番号=(select max(履歴番号) from t1 where コード=x.コード) order by コード
まず、前の質問を締め切ってください。今のままでは、マルチポスト扱いになります。 RDBMSは、SQL Serverでいいのでしょうか？バージョンは、何でしょうか？ 提示されたSQLは、相当にデタラメになっています。 表のデータ例、得たい結果例を示してください。
原因はいろいろあります。 フィールド数があまりに多かったりするとダメなことが多いです。 正確な切り分けはできませんがフィールド数に依存しています。 SQLサーバー側でDBを作って、エキスポートしてあげてください。
>言語はSqlseverです 「Sqlserver」という言語はありません。 きっと「Visual Basic」ですね。 すでに shimix さんから的確なアドバイスが付いていますが、 意味が分かっていないようです。 >For hcnt = 1 To 18 としているので、「hcnt」は変数です。 それをダブルクォーテーション「"」で囲ってしまっては 単なる文字列になってしまい、変数「hcnt」の「内容」は 取り出せませんよ。 フォームにコマンドボタンを１個配置し、次のコード（３行目から４行目を入力）を実行してみると、何が起こっているかわかるはずです。 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Dim hcnt As Integer = 1 MessageBox.Show("hcnt=" & hcnt) End Sub
１．SQL Server の起動 net start mssqlserver net start SQLServerAgent この2行をバッチファイルの中に記載すれば、SQL Server に必要なサービスを起動することが出来ます。 ２．SQL Server の停止 net stop mssqlserver この１行でSQL Serverの関連するサービスを停止することができます。 多分、この様子からすると、データベースのバックアップを行うためにサービスの起動停止を考えているのではないでしょうか？ それであれば、一度、以下の書籍（参考URL）を読んでみることをお薦めします。 参考URL：http://www.seshop.com/detail.asp?pid=3748
SQL Server 2000ですと有効です。 しかもLENやDATALENGTHで変数を評価しても大丈夫ですが 取得した戻り値は0ではなく「NULL」状態となります。 作法としてはNULL代入はオススメ致しませんが (アプリケーション側でのバグに繋がりやすいため) 私はdatetime型など初期化に難しい値には NULLをセットして初期化してます。 sample DECLARE @str varchar(100) DECLARE @num int SET @num = null SET @str = null SET @num = DATALENGTH(@str) PRINT ISNULL(CONVERT(varchar, @num), 'NULL')
明細Noの列長が100バイト、200バイト、500バイトといった極端に長いものでなければ、index-Aはなくてもいいと思います。 列長が極端に長いと、インデクスの１ページで管理できるキー数が少なくなるので、インデクス部分のI/O増になる場合があります。 そうでないなら、性能差は殆ど表には見えないレベルです。
まず、検索に引っかかるかどうか、ということですが どのポータルサイトの検索でも ドメイン設定されている全てのサイトを検索表示されるわけではありません。 検索される仕組みとして有名なのは、 1, 検索結果を取得する「検索ロボット」が 　 ネット上のサイトを収集し、検索エンジンに登録する 2, 各ポータルサイト運営の社員がサイトを登録する などのアクションを起こさないと検索結果には表示されないのです。 よって、どうしてもURLで検索されたいのであれば ・ページのヒット数(みんなに見てもらう回数)を増やす ・色々なサイト(出来ればアクセス数の多い)からリンクを張ってもらう などの工夫をする必要があります。 ほかにも簡単な工夫としては ・HTMLにmetaタグを挿入して検索され易いようにする ・Googleにサイト登録する 　http://www.google.co.jp/addurl/?hl=ja&continue=/ … などがあります。
SQL Serverのストアドプロシージャでは 昔からの仕様で変数には配列が存在しません。 しかしながら、SQL Server 2005はXMLを使用して 配列的に引数を渡すことができます。 http://blogs.sqlpassj.org/yoneda/archive/2005/05 … また、内部変数を配列的に使用したければ代わりに、 Table型変数やCursorまたはCursor型変数の使用ができるので、 こちらで配列的な処理が可能でしょう。 (ただし膨大なデータ量だとパフォーマンス劣化の恐れがあります)
コンテンツ・・ですか？SQLServerの移設の話ではないのでしょうか？ ＃ひょっとして「webサーバ」の移設の話？
UNICODEでもSHIFT-JISでもプログラム側で一旦受けて、 Byte配列に格納してから評価するのはどうですか。 Sub bbb() Dim strTest As String Dim bytArray() As Byte Dim intcount As Integer strTest = StrConv("全(株)", vbFromUnicode) bytArray = strTest For intcount = 0 To UBound(bytArray) Debug.Print bytArray(intcount) Next End Sub
RDBMSは、ここのカテゴリ通りSQL Serverですか？ バージョンは？ もし、SQL Server 2005なら、分析関数でRANK()を使えるので、より簡単に記述できます。
renameの第２パラメータにパスは指定できません。 コマンドプロンプトで rename /? と指定してください。 ファイル (複数可) の名前を変更します。 RENAME [ドライブ:][パス]ファイル名1 ファイル名2 REN [ドライブ:][パス]ファイル名1 ファイル名2 ファイル名2 には新しいドライブもパスも指定できないので注意してください。 と出てきます。 多分コレでは？
SQL Server 2005とのことなので、情報スキーマを利用するのが簡単だと思います。 http://msdn2.microsoft.com/ja-jp/library/ms18677 … 検索SQLとしては、こんな感じです。 select ref.CONSTRAINT_NAME, col.TABLE_SCHEMA, col.TABLE_CATALOG, TABLE_NAME, COLUMN_NAME, ORDINAL_POSITION from INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS as ref, INFORMATION_SCHEMA.KEY_COLUMN_USAGE as col where ref.CONSTRAINT_NAME=col.CONSTRAINT_NAME order by ref.CONSTRAINT_NAME,ORDINAL_POSITION ;
こんばんわ 遅くなりました。。。(^^； >実は「AAA」「BBB」ともに複数のフィールドがありまして 複数ある場合で、全て取得したい場合は、 cmd.CommandText = "SELECT A_No FROM AAA"; のSQLを「SELECT * FROM AAA」で取得することが出来ます。 INSERT方法ですが、 >while (dr.Read()) >{ >// INSERT文 >cmd.CommandText = ""; >// INSERT実行 >cmd.ExecuteNonQuery(); >} この箇所を次のような感じで修正するとよいのではないかと思います。 // dr.Read()は取得したデータを1行ずつ読み込む // 全て読み込むとループから抜ける while (dr.Read()) { // 読み込んだ行のデータは、今回でいうとdrに配列で格納されている // 値を取り出すには dr[0] やdr["A_No"]のようにフィールドを // 指定する // INSERT文 cmd.CommandText = "INSERT INTO BBB (B_No) VALUES (" + dr[0].ToString() + ")"; // INSERT実行 cmd.ExecuteNonQuery(); } このように記述すると、取得したデータの行数だけINSERTできるはずです(^^；
一応、私の方でご質問の内容のサンプルを作ってみました。 ただ、ちょっとコードが長かったので、 私のBlogの方にサンプルコードを掲載しましたので、 ご参考頂ければと思います。 http://blogs.wankuma.com/mymio/archive/2008/01/2 … もし追加の質問がある場合は、私のBlogではなく、 このスレに追加で質問して頂けると助かります。 （OKWave系列の利用規則に反してしまうため） 以上、ご参考になれば幸いです。 参考URL：http://blogs.wankuma.com/mymio/archive/2008/01/2 …
おそらく一番簡単なのは・・ ・CSVファイルをAccessのテーブルにインポートする ・AccessでSQLサーバのテーブルをリンクしておいて、そのテーブルに追加クエリを実行する あたりでしょうか。マクロを作っておいて、CSVファイル作成（同じファイル名に上書きしていく）→Accessでマクロ実行というのが手っ取り早いと思います。 一度Express版（無償です）でもインストールして、ローカルでいろいろ触ってみるといいのですが、SQL文でテーブルを作るのはAccessのようにはいきませんしねぇ。 ＃ウチだとCSVファイルの内容チェックとか重複転送チェックとかでついついアプリを組んでしまいますが（汗
データファイル、トランザクションログの圧縮が必要ですね。 圧縮例（下記はトランザクションログの例ですが）： backup log DB名 with no_log dbcc shrinkfile(トランザクションログファイル名) みたいな感じで、dbccコマンドで圧縮してあげないと 小さくならないです。 詳細は、DBCC SHRINKFILE　の使い方がマイクロソフトのサイトで 公開されてますので、これを使って、 データファイルとトランザクションログのサイズを圧縮してください。 http://msdn.microsoft.com/library/ja/default.asp … ご参考になれば幸いです。 参考URL：http://msdn.microsoft.com/library/ja/default.asp …
SQL Server2000のデータをbcpでCSVにエクスポート→そのCSVをOracleのSQL*Loaderで、インポートするということですね。 SQLChar型？って定義はありましたか？ ちょっと良く分からないのですが、SQL Serverで格納している データがSJISかUNICODEかにもよりますが、感覚的には こんな感じでできませんか？ -- テーブル名の頭は、必ず「#」をつける。するとtempdbに -- このテーブルがSQL Server上で作成されます。 -- エクスポートするイメージのワークテーブルを作成する CREATE TABLE #WORK_TABLE ( field1 varchar(max), field2 varchar(max), field3 varchar(max)........ ) go -- ワークテーブルに改行文字をReplace INSERT INTO #WORK_TABLE SELECT field1, field2, field3, REPLACE(CAST(問題の改行含む項目 as varchar(max)), '0x0D0A', ' ') AS field4, ....... 以後項目分続く FROM 　[db名].[bcpでエクスポートしようとしていたテーブル] go -- BCP実行。細かい引数などのオプションは用途で合わせてください。 -- （特に接続方法や接続文字列） DECLARE @filePath nvarchar(max) DECLARE @bcpCmd varchar(max) SET @filePath = 'c:\aaa.txt' SET @bcpCmd = 'bcp "SELECT * FROM #WORK_TABLE" queryout "' SET @bcpCmd = @bcpCmd + @filePath + '" -U username -P pw -password' EXEC master..xp_cmdshell @bcpCmd これをSQL Server上でクエリとして実行します。 （Enterprise Managerか、クエリアナライザでしたっけ？で 　細かいところを調整して、実行すれば、恐らくいけるかと 　思います） お試しください。
違うみたいですね。 7.0と2005で違うところは、MDACぐらいでしょうか。 SQL Server2005 では、 Microsoft Data Access Components (MDAC) 2.8 SP1　以上が必要です。 参考URL： http://msdn2.microsoft.com/ja-jp/library/ms14350 … また、MDACのバージョン確認方法は、 http://support.microsoft.com/kb/301202 をみて、確認してみてもらえますか？ もし、MDACが既定を満たしているようであれば、また別の原因です。 この手の問題は推測しながら、１つずつ潰していくしかないので 根気よくやっていくしかないと思います。 よろしくお願いします。
> WindowsXPのマシンにSQLサーバをインストールして、 > あるシステムを10台以下のクライアントで運用しようと > 考えています。 物理的にはインストール可能ですし、動作もします。 しかし本番運用で使っていいかどうかは別の話。 まず Windows XP はサーバ用途（他のクライアント等に何かのサービスを提供する目的）で使ってはいけないし、XP にそういったツールを導入してはいけない。 SQL Server 2000 のシステム要件によると http://www.microsoft.com/japan/sql/prodinfo/prev … XP にインストール可能な Edition は Evaluation、Developer Edition、Workgroup Edition です。 Evaluation は評価用。Developer Edition は開発過程で使うもの。なのでどちらもたとえ Windows Server にインストールしても本番運用として使うことはできない。 Workgroup Edition: http://www.microsoft.com/japan/sql/prodinfo/prev … これを見る限り、XP などのデスクトップ OS で使用する場合は Access からの乗り換えなど、個人で使うようなケースなんじゃないかと。 とは言え私の発言には一切法的根拠も責任もありませんので、マイクロソフトに問い合わせるのが一番です。
Accessから取得した結果をDataSourceにして、 そのDataSourceをバインドしてGridViewにデータを 表示させているかと思いますが、そのGridViewをXMLで定義している *.aspx か *.ascx のソースを可能な限りで構いませんので 公開して頂けますか？また、使用されているVS.NETのバージョンも 教えてください。（回答方法が若干変わりますので） また更に、できるのであれば、Accessのデータを取得した結果を 格納しているDataSourceやDataSet、DataTableをGridViewに どのようにバインドしているのか見てみたいので、 そのあたりのソースも公開して頂けると助かります。 よろしくお願いします。
改行の制御コード入れてみてください。
＞１．fGet印刷ジャーナルファイルRecordsetで定義しているadoRsの ＞レコードセットがCloseされていない ＞　　→これについてはadoRsの値をpfAutoClosed()で使用している ＞　　　ため、fGet印刷ジャーナルファイルRecordset()内でClose ＞　　　することができません。 ＞　　　実際には、pfAutoClosed()のEnd Sub３行前でCloseして ＞　　　います。 どういうトランザクション単位で、処理したいのでしょうか？ まずはそこからですね。 別に、adoRsは、pfAutoClosed()用と、fGet印刷ジャーナルファイルRecordset()用と ２種類のRecordsetを定義しても問題はないですよね？ また、Connection（adoCn）についても同じことです。 「○○で使用しているからできません」ではなく、 「トランザクションの単位」がこうなっているから、ここは別けられないと いう説明がない限り、具体的な解決案を出せませんので、 SELECT系と更新（INSERT, UPDATE, DELETE)のトランザクションは どういうくくりで処理したいのでしょうか？ そこを補足ください。 ＞２．adoCn.BeginTrans()の位置を変更する ＞　　→adoCn.Execute(sMySQL, , ADODB.CommandTypeEnum.adCmdText) ＞　　　の後にadoCn.BeginTrans()を変更した場合、 ＞　　　一つ目のadoCn.Execute(sMySQL, , ADODB.CommandTypeEnum.adCmdText) ＞　　　のところでフリーズしてしまい動かなくなります。 フリーズするとは、どのような現象でしょうか？どのようなエラーが出ますか？ また、先ほども申し上げた通り、処理したいトランザクションの単位がわからなければ、 adoCn.BeginTrans()　の書く位置もまた変わってきますので、 「処理したいトランザクション単位」を教えてください。 ただ、見ている限り、SELECT系と更新系のConnection(adoCnを２種類）と トランザクション(adoCnを２種類用意するとトランザクションは別けられます）は わけてしまっても問題無いようには、見えます。 もう少し情報を精査して頂き、「エラーになるから」ではなく、最終的に何ができればいいのか？ の情報をお寄せ頂けると幸いです。 よろしくお願いします。
＞完全バックアップファイルが存在しなければ、差分バックアップをリストアすることはできないのでしょうか？ はい。できません。 差分バックアップは、その差分バックアップに含まれるデータの最新の完全バックアップに基づいて行われるものです。 そのため、完全バックアップが消えてしまっては、比較の元がないために、エラーになり、復元はできません。 詳しくは、マイクロソフトのサイトにも書いてありますので ご覧下さい。 ■差分バックアップ http://msdn2.microsoft.com/ja-jp/library/ms17552 … ＞もし、完全バックアップファイルを削除すると、差分バックアップをリストアできないのであれば、バックアップファイルを残すことなく、差分のみをリストアする上手い方法がないでしょうか？ 差分バックアップではできないので、部分バックアップを 使って見ては、如何でしょうか？ 部分バックアップは、SQL Server2005からサポートされている ものです。 ■部分バックアップ http://msdn2.microsoft.com/ja-jp/library/ms19021 … ただし、ストアドやテーブル等のオブジェクトの単純比較というレベル の差分であれば、「SQL Server Compare」という フリーソフトで管理することは可能です。 ■SQL Server Compare http://www.yessoft.com/dnn/ ＃それでも、テーブル内に格納されているデータに対する差分は、 　このツールでも無理です。 　その場合は、完全バックアップ + 差分バックアップか、部分バックアップのどちらかを取らない限り無理です。 ご参考になれば幸いです。
再びNo1です。 No1でも提案しましたが、SQLServer Management Studioというツールを使用してみてはどうでしょうか。 わざわざMS社に確認してみたところ、 ＞Management Studio は、Visual Studio 2005 に組み込まれているツールとなりますので、Visual Studio 2005 Standard Edition に含まれております。 とのことでした。 なのでManagement Studioのご使用をお勧めします。
ストアドの問題もそうですが、どちらかというと、 Accessのadpファイルでの制限もあるかもしれませんので、 そちらを調べてみることをお勧めします。 Accessになってしまうと、私まったくわからないので、 別途Accessのコーナーで詳しい方に聞いてみるといいかもしれません。 お役に立てなくてすいませんでした。
xp_cmdshellでSQLCMDを使いたくないということは、 xp_cmdshell経由で、bcpを使いたくないということでしょうか？ ■一括インポート操作とエクスポート操作 http://msdn2.microsoft.com/ja-jp/library/ms18704 … ■BCPを使った例 DECLARE @filePath nvarchar(max) DECLARE @bcpCmd varchar(max) SET @filePath = 'c:\aaa.txt' SET @bcpCmd = 'bcp "SELECT * FROM TABLE" queryout "' SET @bcpCmd = @bcpCmd + @filePath + '" -U username -P pw -password' EXEC master..xp_cmdshell @bcpCmd また、上記のようなxp_cmdshell経由でBCPも使えないとか、制限があるのであれば、OPENROWSETを使えばできないことはないです。 （ただ、いろいろとテキストファイル側の項目定義フォーマットが 別で必要なので、下記だけでは動かないです。 とりあえず、こんな感じですということで掲載します） INSERT INTO OPENROWSET('MSDASQL', 'Driver={Microsoft Text Driver (*.txt; *.csv)};DefaultDir=C:\;','select * from aaa.txt') SELECT * FROM テーブル を使った、ファイル生成もありますが、 デフォルトのSQL Serverのセキュリティ設定（Ad Hoc Distributed Queries）が有効になっていないと、使えなかったと 記憶してます。 ■セキュリティ「Ad Hoc Distributed Queries」を有効にする方法。 EXEC sp_configure 'show advanced options', 1; GO RECONFIGURE; GO EXEC sp_configure 'Ad Hoc Distributed Queries', 1; GO RECONFIGURE; GO これで、OPENROWSETを使ってテキストファイルに吐けるようには なるはずですが、いずれにしても、OPENROWSETを使って書き出すのは、 セキュリティ上、お勧めしかねるのと、サーバーの設定を 変えるメリットがないため、素直にxp_cmdshellか bcpユーティリティ を利用することを強くお勧めします。 参考URL：http://msdn2.microsoft.com/ja-jp/library/ms18704 …
質問の趣旨ですが、「SQLの絵本」の本内に掲載されている サンプルコードが、ネット上のどこかにないかという意味でしょうか？ この本を存じ上げていませんが、 http://books.ank.co.jp/books/2004/sql_ehon.html で、本の概要を見る限り、それぞれの章でサンプルコードが 掲載されているようですが、それだけでは、 足りないということでしょうか？ 具体的にどの章のどのサンプルが欲しいのか、 また、各章で掲載されているサンプルコードでは何が足りないから、 サンプルが欲しいと思われているのか、教えて下さい。 参考URL：http://books.ank.co.jp/books/2004/sql_ehon.html
極めて難しい事例ですね。簡単には解けそうにありません。年末の夜だというのに、お疲れ様です。 *　スピードの速い１台だけ、MTUの設定値が違う 　MTUとは、IPのような可変長フレームのプロトコルにおける、フレーム最長値のことです。VPNの場合、IPSec等のフレーム付与により、ネットワークフレームの上限値を超えてしまい、フレーム分割作業が途中で必要となり、その分、遅くなるという現象が考えられます *　VPNとは常時接続ではなく、認証つきのオンディマンド接続である 　マイクロソフトのNT系OSには全て同じバグがあり、オンディマンドでPPPセッションを張りに行くにあり、エラー時のリトライを3秒後に行うよう、レジストリに書いてあるのですが、この数値が無視され、1秒後に再接続にいきます。認証が1秒以上遅れると、第2セッションがPCから張り出され、第1セッションの返事がまだ来ていないので、行きと帰りがぐちゃぐちゃになります。ただ、賢いメーカーのモデムは、Windows NTはパーだと知っており、1秒後に再接続の要求が来ても無視します。反応の速いPCだけ、賢いメーカーのモデムにつながっているのでは？もしくは、異なるPPPoEクライアントソフトを使っているとか？ *　システム言語のミスマッチ 　WindowsはXP/2003の世代から、サーバとクライアントで、システム言語が一致しているかを厳密に見るようになりました。例えば、Win2000時代には、キーボードをだまして101キーボードモード(英語キーボード)にすると英語版Citrixサーバに入れたのですが、この手がXPになってから通用しなくなりました。まさかMSの作るAccessでこんな現象があるとは思えませんが、サーバとシステム言語が一致しているクライアントのみ反応が早いという可能性がゼロとは思いません。必要であれば、MSに聞いてみてください なお、様々な調査をされたということですが、パケットキャプチャはご利用になりましたか？以下がお奨めです。 http://www.space-peace.com/ethereal/ よく分からん事象ですねえ。
マイクロソフト製品のライセンスに関する質問はここでは得られませんよ。 もしここで得られた何らかの体験談を踏襲してあなたが実践したとして、それがライセンス違反になる可能性もあります。 あなたが実際に 「どのように」 監視をするのか、その実行方法によっても違ってくる可能性もあります。 よって必ずマイクロソフトに相談してください。 <マイクロソフト カスタマー インフォメーション センター> http://www.microsoft.com/japan/customer/info/def … 記載されているフリーダイヤルに電話して [1]-[2] でいけます。
こういう情報もありますが、確認済みでしょうか。 http://cs.albis.jp/blogs/ms-18e/archive/2006/04/ …
本当にパスワードが設定されていないのでしたら、－Pで通ります。 通らないようでしたら、原因は他にあるかと思います。 例えば、認証がWindows認証限定になっているなどが考えられます。
データ列数が3つのみであれば、No.1の回答が最適かと思いますが、 実際にはもっと多数の列が存在するようであれば、IDとDATA列のみ の別テーブルを作成した方がよろしいかと思います。 既存テーブルをTable1,新しいテーブルをTable2とした場合の例： insert into Table2 (ID,DATA) select ID , DATA1 from Table1 insert into Table2 (ID,DATA) select ID , DATA2 from Table1 insert into Table2 (ID,DATA) select ID , DATA3 from Table1 ・ ・ Table2からのクエリ例： declare @i int set @i = 1 while (select max(ID) from Table2) >= @i begin select ID ,DATA from Table2 where DATA= (select max(data) from Table2 where ID=@i) set @i = @i + 1 end
こんばんは。 >サンプルデータベースに登録 という用語はあまり使いませんので、私が質問内容を正確に理解できたかどうかわかりませんが。 サンプルデータベースがネットからのダウンロードで手に入れたものであれば、それ（～.mdfファイルと～.logファイルの２つ）を 「C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\Data」フォルダに移動するだけではだめで、「データベースにアタッチ」という作業が必要です。 SQL Server Management Studio Express を起動し、サーバーに接続されたら、オブジェクトエクスプローラでサーバー直下の「データベース」ノードを右クリックして、「アタッチ」を選択し、「データベースのアタッチ」ダイアログから「追加」ボタンをクリックして、使用したいデータベース（mdfファイル）を選択します。 このようにしてやっとデータベースが使えるようになります。 的外れでしたら、もう少し情報を追加してください。
可能です。方法はいろいろありますがたとえば、 データベース名を右クリック→タスク　 からインポートやエクスポートを選ぶのが手軽な方法のひとつです。
現在、実際に試せる環境が無いので若干文法が間違っているかもしれませんが、以下の内容でいけるのではないかと思います。 SELECT T01.Nomber ,SUM(ISNULL(CASE WHEN KenYY + KenMM = '200711' THEN Siyoryo ELSE 0 END, 0)) AS 2007年11月 ,SUM(ISNULL(CASE WHEN KenYY + KenMM = '200712' THEN Siyoryo ELSE 0 END, 0)) AS 2007年12月 ,MAX(ISNULL(CASE WHEN T01.RecNO = T02.MIN_RecNO THEN Sedai ELSE 0 END, 0)) AS Sedai_MIN ,MAX(ISNULL(CASE WHEN T01.RecNO = T02.MAX_RecNO THEN Sedai ELSE 0 END, 0)) AS Sedai_MAX FROM TABLE T01 INNER JOIN (SELECT Nomber ,MIN(RecNO) AS MIN_RecNO ,MAX(RecNO) AS MAX_RecNO FROM TABLE GROUP BY Nomber) T02 ON T01.Nomber = T02.Nomber GROUP BY T01.Nomber
inner join を使ったらよいのでは？
aaaとAAAを区別したいなら。データベースの照合順序を変えてみると エラーなしで処理できるかもしれません。照合順序はシステムレベル・データベースレベル・テーブルレベルで設定できます。初期設定では osの設定を引き継ぎます（この場合大文字小文字を区別しない）。paradoxで正常であれば問題なくinsertできるはず・・・
No.2さん、アドバイスありがとうございます。 ＞そんな制限を持っているRDBMSは聞いたことがありません たとえばマイクロソフトのアクセスは、主キーが無くとも（ユニークなフィールドが無くとも）テーブルの追加更新が可能です。これをSQLサーバーにアップサイジングした際に「更新できない」「追加できない」というのは良くある話です。 質問者の方はACCESS2000のDBから乗り換えとのことなので充分に可能性があることと思っての回答でしたが、はずしてましたでしょうか。
SELECT 1のＤＢクエリ クエリ.ID, 1のＤＢクエリ クエリ.品目, 1のＤＢクエリ クエリ.式1, 1のＤＢクエリ集計.式1の合計, 1のＤＢクエリ クエリ.日付 FROM ( SELECT 1のＤＢクエリ.ID, 1のＤＢクエリ.品目, 1のＤＢクエリ.金額*２のＤＢ_a クエリ.金額/２のＤＢ_b クエリ.金額 AS 式1, 1のＤＢクエリ.日付 FROM (SELECT １のＤＢ.ID, １のＤＢ.品目, １のＤＢ.金額, １のＤＢ.日付 FROM １のＤＢ WHERE １のＤＢ.ID=1 ) as 1のＤＢクエリ, (SELECT ２のＤＢ.区分, ２のＤＢ.品目, ２のＤＢ.金額, ２のＤＢ.日付 FROM ２のＤＢ WHERE ２のＤＢ.区分="a" ) as ２のＤＢ_a クエリ, (SELECT ２のＤＢ.区分, ２のＤＢ.品目, ２のＤＢ.金額, ２のＤＢ.日付 FROM ２のＤＢ WHERE ２のＤＢ.区分="b" ) as ２のＤＢ_b クエリ where 1のＤＢクエリ.品目 = ２のＤＢ_a クエリ.品目 and ２のＤＢ_a クエリ.品目 = ２のＤＢ_b クエリ.品目 ) 1のＤＢクエリ クエリ, (SELECT Sum(1のＤＢクエリ クエリ.式1) AS 式1の合計 FROM SELECT 1のＤＢクエリ.ID, 1のＤＢクエリ.品目, 1のＤＢクエリ.金額*２のＤＢ_a クエリ.金額/２のＤＢ_b クエリ.金額 AS 式1, 1のＤＢクエリ.日付 FROM (SELECT １のＤＢ.ID, １のＤＢ.品目, １のＤＢ.金額, １のＤＢ.日付 FROM １のＤＢ WHERE １のＤＢ.ID=1 ) as 1のＤＢクエリ, (SELECT ２のＤＢ.区分, ２のＤＢ.品目, ２のＤＢ.金額, ２のＤＢ.日付 FROM ２のＤＢ WHERE ２のＤＢ.区分="a" ) as ２のＤＢ_a クエリ, (SELECT ２のＤＢ.区分, ２のＤＢ.品目, ２のＤＢ.金額, ２のＤＢ.日付 FROM ２のＤＢ WHERE ２のＤＢ.区分="b" ) as ２のＤＢ_b クエリ where 1のＤＢクエリ.品目 = ２のＤＢ_a クエリ.品目 and ２のＤＢ_a クエリ.品目 = ２のＤＢ_b クエリ.品目 ) as 1のＤＢクエリ集計;
クエリだけでは難しいかもしれません 同様の質問内容がありましたのでご参考にどうぞ http://www.atmarkit.co.jp/bbs/phpBB/viewtopic.ph … VB等のプログラムの開発環境があれば，それを併用されてはいかがでしょうか？
>WHERE >　　x.ユニークNo = y.ユニークNo AND >　　x.大分類コード = y.大分類コード AND >　　x.代表フラグ = z.代表フラグ AND >　　y.代表フラグ = z.代表フラグ AND >　　x.ユニークNo = z.ユニークNo これは副問い合わせ（インラインビューー、仮想ビュー）の条件なのでインデックスは効きません。 ＞GROUP BY　ユニークNo) AS z, ＞GROUP BY ユニークNo,代表フラグ) AS x, ＞GROUP BY　ユニークNo, 代表フラグ,大分類コード) AS y GROUP BYは内部でソートするのでインデックスををつけると有効です。 ユニークNo ユニークNo,代表フラグ ユニークNo, 代表フラグ,大分類コード の3つを作ればどうですか。 p.s 複雑なSQLになると言うことは構造が悪いと言うことです。 ANo.1さんが言ったように構造の見直しをしたほうがいいと思います。 これを、テーブルの正規化といいます。 正規化は自動ツールもあるので一度試してみれば。 アクセスでもできますよ。
今、手元に環境が無いので細かい説明が出来ませんが。 デタッチ・アタッチを使えば良いと思います。 SQLserverをインストールした先に、データベース名のLDFファイルやMDFファイルができていると思います。 デタッチすることで、そのファイルが取り出せるようになりますので、オラクルのDMPのように扱えます。 元に戻すときは、そのファイルを指定して、アタッチすればOKです。
sp_executesql のSQL文とパラメタ宣言の部分のデータ型は、nvarcharなどのunicode系のデータ型でなければなりません。 >DECLARE @SQLString VARCHAR(500) >DECLARE @ParmDefinition VARCHAR(500) ↓　修正要 DECLARE @SQLString NVARCHAR(500) DECLARE @ParmDefinition NVARCHAR(500) また、sp_executesqlの使用方法に、根本的な誤りがあるようです。 パラメタで可変にできるのは、条件式の値部分や受け取り変数の部分だけです。 sp_executesqlは、表名や列名を、可変にする機能ではありません。
推察通り「Profiler」を利用すると簡単に確認可能です。 　※起動して「新規追加」→「トレース」を選びます。 参考URL: http://technet.microsoft.com/ja-jp/library/ms173 … http://www.sqlpassj.org/tokushu/dba/01.aspx
ビューでは不可能だと思います。 同じ様なアクセス方法を行いたいのであれば、 テーブル値を返すユーザー定義関数を作成する方法があるかと思います。構造は同じと言う事なので、1つの関数で済むと思いますし。 例：Select * From ユーザー定義関数(1～4のパラメータ) 上記例の様な使い方が可能です。
＞DELLパソコンならではの何かが邪魔をしているのでしょうか。 機種というより、OSのような気がします。 DELLのOSは、DELL機種にしかインストールできないように、カスタマイズされています。 （秋葉原でDELLのXPが安く売っていたのですが、家のPCにインストールできませんでした。） 穴1433（ポート：1433）はあいていますか。 Windows XP の Service Pack 2 (SP2) では、デフォルトで「ローカルの ファイアウォール機能」が有効になるため、ポート 1433 がブロックされます。 確認方法は、コマンド プロンプト]から以下のコマンドを打ってみてください。 netstat -an 結果； Active Connections Proto Local Address Foreign Address State TCP 0.0.0.0:135 0.0.0.0:0 LISTENING TCP 0.0.0.0:445 0.0.0.0:0 LISTENING TCP 0.0.0.0:1025 0.0.0.0:0 LISTENING TCP 0.0.0.0:1026 0.0.0.0:0 LISTENING TCP 0.0.0.0:11560 0.0.0.0:0 LISTENING TCP 0.0.0.0:17673 0.0.0.0:0 LISTENING TCP 0.0.0.0:31038 0.0.0.0:0 LISTENING 意味； Ｐｒｏｔｅ：通信プロトコルの種類　「ＴＣＰ」　「ＵＤＰ」を表示 ＬｏｃａｌＡｄｄｒｅｓｓ：パソコン側の「ＩＰアドレス：ポート番号」 Ｆｏｒｅｉｇｎ　Ａｄｄｒｅｓｓ：接続先の「ＩＰアドレス：ポート番号」 Ｓｔａｔｅ：ＴＣＰ接続の状態を示す。「ＬＩＳＴＥＮＩＮＧ」は待ち受け中　「ＥＳＴＡＢＬＩＳＨＥＤ」は通信確立を示す。 1433があればOK 無ければ、[Windows ファイアウォール] ツールを使って、[例外] を追加する必要があります。 ホスト名解決も必要な場合もあります。 確認方法ですが以下を入力してください。 ping　対象先ホスト名 対象先ホスト名ですがソースを見てください。 "Data Source=XXXホスト"となっています。 結果例 NG： ping yahoo Unknown host yahoo. OK； Pinging yahoo.co.jp [124.83.139.192] with 32 bytes of data: こんな感じだったらOK NGの場合hosts ファイルへ登録が必要です。 又、接続文字列に“Data Source=192.168.X.XX”のように IP アドレスを直接指定すれば、ホスト名解決は不要になります。
正規化されていませんが、本当にこの表でやりたいのですか？ もしそうならば、B表、C表は、A表と重複する情報を持っており、今回の結果であればA表だけから得られます。 select EmpID,Period, sum(case when 休暇理由='有休' then 取得時間 else 0 end) "取得時間(有休)", sum(case when 休暇理由='病欠' then 取得時間 else 0 end) "取得時間(病欠)" from A where EmpID=1 group by EmpID,Period order by EmpID,Period もし私がこういった表を作るなら、以下のようにします。 (1)従業員表を作る →EmpID、氏名などを管理 (2)カレンダー表を作る →年月を管理。日付まで持ち、休日を識別することにも利用してもいい。 (3)休暇理由表を作る →理由コードと理由を管理 (4)休暇管理表を作る →EmpIDと年月、理由コード、取得時間を管理 ↓ 結果的に、A表に相当するものは必要なくなります。 →検索結果としてA表に相当するものを作れる また、これらの表から今回の結果を得るのに、FULL JOINは必要ありません。 親表に対し子表が複数存在するLEFT JOINです。
SQL Server 2005なら、情報スキーマが提供されています。 sys.objects等を参照するより、より簡単に参照しやすくなっています。 <SQL例> select ref.CONSTRAINT_NAME, col.TABLE_SCHEMA, col.TABLE_CATALOG, TABLE_NAME, COLUMN_NAME, ORDINAL_POSITION from INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS as ref, INFORMATION_SCHEMA.KEY_COLUMN_USAGE as col where ref.CONSTRAINT_NAME=col.CONSTRAINT_NAME order by ref.CONSTRAINT_NAME,ORDINAL_POSITION 参考URL：http://msdn2.microsoft.com/ja-jp/library/ms18677 …
社内ネットワーク上のSQLServerには正常に接続することができるのならば、SQLServer自身の設定の問題ではないのかもしれませんね。 なんらかのVPNを使うための設定が必要なのでしょうね。 Pingが通るとの事なのでVPNを使用した通信ができていない訳でもないんでしょうが、、、、 ちなみにPingはIPアドレスでもサーバー名でもできますよね？ ん～、でも名前解決できてないならエラーメッセージが違う様に思えますね。 正直、すぐには次善の策が思いつかないといったところです。 お力になれず申し訳ない・・・
下記のどちらかでしょう。 1.別のマシンに復元し、必要なテーブルをインポートする。 2.別のＤＢを作成し、そこに復元。必要なテーブルをインポートする。
まず、@command に入れている内容をコマンドプロンプトで実行した場合は、ちゃんと出力されていますか？ あと、、、 「C:\XXXX\aaa.txt」のファイルの有無は、SQL Servereが入ってるサーバー内を確認してますか？ 私は昔、自分のローカルにできると勘違いしていた事があるもので。。。
下記のような感じの処理をストアドファンクションかバッチかに組み込めばいいんじゃないでしょうか。 （datetimeって「日付」なので、datetimeで登録したいなら、時間表示の前に日にちが必要になりますね。） -------- サンプル　ここから　-------- -- 元の「分」データ DECLARE @org_minute int DECLARE @minute int-- 分 DECLARE @hour int-- 時 -- 指定の形式に整形 DECLARE @time_str varchar(8) -- org_minuteに値を入れる処理を入れる -- (SELECT文を使って与えるとか、 -- VBAなどと組み合わせてユーザから受け取るとか・・・) -- 時を計算 SET @hour = @org_minute / 60 -- 分を計算 SET @minute = = @org_minute % 60 -- 結果の結合 SET @time_str = @hour + ":" + @minute + ":00" -------- サンプル　ここまで　--------
自己結合してみましょう。 select x.商品番号,y.商品番号,count(*) as 見た人数 from tblA as x,tblA as y where x.商品番号<>y.商品番号 and x.見た人=y.見た人 group by x.商品番号,y.商品番号 order by x.商品番号,y.商品番号
これで試してみてください。 SELECT sum(case when CONDITION = '1' then 1 else 0 end) as cnt1, sum(case when CONDITION = '2' then 1 else 0 end) as cnt2, sum(case when CONDITION = '3' then 1 else 0 end) as cnt3, sum(case when CONDITION = '4' then 1 else 0 end) as cnt4, sum(case when CONDITION = '5' then 1 else 0 end) as cnt5 FROM A
どうしても全件ということであれば（例えば、全員に1ポイントを追加付与）後はインデックスがあるとそれも更新対象となってしまうので、極力インデックスを減らしたり、使うとしてもサイズが小さくなるようにしたり（カラム数を減らす）とか。 どのみち、その処理を完了するには、5000万件分のテーブルデータへのアクセス（Read&Write）が発生するので、肝は必要以上のアクセス、つまりインデックス等へのアクセスを発生させない事かと。物理設計を見直せるのであれば、データとログのディスクI/Oを散らすとかも出来ますね。それなりのハードウェアである必要がありますが・・・。 なお、中間でのコミットは一貫性の保持が出来なくなるためオススメは出来ません。あと、チェックポイントの処理は自動でやるはずなので考慮する必要はないでしょう。
いったんワークテーブルを作成し、その後、何段階かSQLを実行するしかないかもしれません。 1.ワークテーブルを作成。 2.1.で作成したワークテーブルにCSVファイルをインポート。 3.ワークテーブルと最終テーブルを比較。主キーが一致するレコードはUPDATE。 4.ワークテーブルと最終テーブルを比較。主キーが一致しない項目はINSERT。 5.必要なければ1.で作成したワークテーブルを削除。
case文を使う場合は、 case when 式1 then 0 else 式1 end のように、同じ式を書く必要があります。 計算結果がnullになるような場合なら、 coalesce（式1,0) といった関数を使う方法もありますが、今回は該当しませんね。 式に別名を付けた場合、そのクエリ内でなく、その外側のクエリでなら、別名で操作できます。 select EX1 from (select *,suuchi*2+1 as EX1 from tbl1) as x
ないと思います。 基本的に、SQLServerは人の手を煩わせないよう、なんでも自動化するのを良しとして作られています。
既に回答されていますが、、、 vista対応しているものは「奉行21Ver.IVシリーズ」だけみたいです。 vistaではインストール箇所や、プログラムの実行権限等でXPとは大幅に変わっています。 そのため、XPで動くソフトでもvistaで動かないソフトは大量にあります。 残念ながら、動かないソフトの１つということです。 ※そもそも、Microsoft製品でさえ、vista以前のソフトは動かないものが多いです。 ということで、XP以前のPCで使うか、新しいソフトを購入するのどちらかになると思います。 （参考） -- ※ 「奉行21Ver.III シリーズ」以前の奉行21シリーズ製品、および奉行2000シリーズ製品は、「Windows Vista™」へ対応しておりません。 上記製品をお使いのパソコンをWindows Vista™へ変更される場合は、「奉行21Ver.IV シリーズ」へのアップグレードが必要となります。 アップグレード価格やお手続き方法につきましては、最寄りの弊社事業所、販売代理店、またはサポートセンターまでお問い合わせください。 -- 参考URL：http://www.obc.co.jp/support/os_sp/vista.html
RDBMSは、このカテゴリ通りSQL Serverですか？ 2000ですか？2005ですか？ こういった操作では「FULL JOIN」をすぐに思いつくのですが、「FULL JOINを未実装のRDBMS」や「実装していてもバージョンが新しくないとだめ」といったケースがあります。もし、「FULL JOIN」が未実装の場合は、「LEFT JOIN」+「RIGHT JOIN」+「UNION」で実現することが可能です。 >二つのテーブルを比較 比較するには、行を一意に識別できるキーが必要です。社員Noをキーにするということでいいですか？ >変わったレコードの変わった項目だけを取り出したい 項目数を可変にすることは、SQLだけでは困難です。 変更内容を知るには、変更前と変更後の情報がないと困るでしょ？ SQL例を提示します。 「丸投げ」的な質問の仕方をしているのですから、何をやっているかくらいは自分なりに調べたり試行錯誤してみましょう！ select coalesce(x.EmpNo,y.EmpNo) as EmpNo, case when x.EmpName is null and y.EmpName is null then null when x.EmpName is null and y.EmpName is not null then 'null=>('+y.EmpName+')' when x.EmpName is not null and y.EmpName is null then '('+x.EmpName+')=>null' when x.EmpName=y.EmpName then '='+'('+x.EmpName+')' else '('+x.EmpName+')<=>('+y.EmpName+')' end as EmpName, case when x.EmpSection is null and y.EmpSection is null then null when x.EmpSection is null and y.EmpSection is not null then 'null=>('+y.EmpSection+')' when x.EmpSection is not null and y.EmpSection is null then '('+x.EmpSection+')=>null' when x.EmpSection=y.EmpSection then '='+'('+x.EmpSection+')' else '('+x.EmpSection+')<=>('+y.EmpSection+')' end as EmpSection, case when x.EmpAddr is null and y.EmpAddr is null then null when x.EmpAddr is null and y.EmpAddr is not null then 'null=>('+y.EmpAddr+')' when x.EmpAddr is not null and y.EmpAddr is null then '('+x.EmpAddr+')=>null' when x.EmpAddr=y.EmpAddr then '='+'('+x.EmpAddr+')' else '('+x.EmpAddr+')<=>('+y.EmpAddr+')' end as EmpAddr from Emp2006 as x full join Emp2007 as y on x.EmpNo=y.EmpNo order by EmpNo
こんにちは、nas02です。 Visual Studio 2005 のサーバエクスプローラからSQL Server 2005 Compact Edition のDBを接続すると 以下の３つが表示されます。 ・テーブル ・システムビュー ・レプリケーション この中の「システムビュー」に「INFORMATION_SCHEMA.TABLES」があります。 このビューに該当テーブルがあるかチェックすれば良いと思います。 （TABLE_TYPE と TABLE_NAME を抽出条件にすれば良いかと）
[SELECT 商品番号,商品名 FROM 商品表] で商品番号と商品名を抽出。 [WHERE EXISTS] は（）内の条件に一致するものを商品表から抽出。 [(SELECT * FROM 注文表 WHERE 商品番号 = 商品表. 商品番号)] はEXISTSの条件です。 注文表の中の商品番号は注文された商品番号がすべてあるんですが、商品名がありません。しかし、商品名を出さないといけないので、EXISTSを使い注文表の中の商品番号と商品表の商品番号が一致する商品番号と商品名を出すをいうSQL文です。 解説が下手ですみません。。
アがダメな理由 　誤）ＷＨＥＲＥ　学生番号　＝　３００　ＯＲ　４００ 　正）ＷＨＥＲＥ　学生番号　＝　３００　ＯＲ　学生番号　＝　　４００ イがダメな理由 　ＳＥＬＥＣＴには学生氏名、ＧＲＯＵＰ　ＢＹは所属学科なので正しくない。 　どちらかにそろえないと。また学生氏名でグループ化すると同姓同名をどうする？ ウがダメな理由 　たぶん「学生氏名が文字型だから」 　　ＷＨＥＲＥ　学生氏名　＝　'新橋一郎' だと思いますが、 　もしかするとイと同じく同姓同名だと複数行が返されるから。 だと思います。
REPLACE　についてはわかりません。 質問のＳＱＬ ======================================= insert into [test01].dbo.test_table select * from [test02].dbo.test_table ======================================= は　当然、既存のtest01の主キーとtest02の値が重複すればエラーになります。 もし、重複を避けたいのであるなら　一旦、一時テーブルに重複しないデータを抽出しておき、その一時テーブルのデータを挿入するといった2ステップになります。 例、一時テーブルへ重複しないデータを出力 SEECT INTBL02.* into #TempTBL1 from [test01].dbo.test_table AS INTBL01 Left Join [test02].dbo.test_table AS INTBL02 ON INTBL01.Mkey1 = INTBL02.Mkey1 Where INTBL01.Mkey1 Is NULL Insert Into [test01].dbo.test_table SEECT * FROM #TempTBL1 ___________________________________________________________
#1 です。 少し勘違いがありましたので、修正します。 【第２正規形】 {従業員番号,職種コード}→{経験年数} の関係と、{職種コード}→{職種名} の関係を分割する必要がありますので 従業員 = 従業員番号 + 従業員名 + 入社年月日 + 部門コード + 部門名 職種歴表 = 従業員番号 + 職種コード + 経験年数 職種 = 職種コード + 職種名 第三正規形は結果的には先に書いたもので正しいと思います。
とりあえず、イベントビュアに何かエラー等が出てないかを確認しましょう。 C2監査モードで動作している時に、監査ログがいっぱいになって書き込め無くなると、動かなくなります。が、違いますよね～
SQL Server 2000の場合以下のSQLで要求を満たします。 if (select COLUMNPROPERTY( OBJECT_ID('TABLE_A'),'COLUMN_A','PRECISION')) > 0 print('テーブルTABLE_AのカラムCOLUMN_Aが既に存在します。') else alter table TABLE_A　add COLUMN_A int; go 補足) COLUMNPROPERTYの三番目のパラメータ'PRECISION'は指定した列のデータ型の有効桁数を返します。無効な入力の場合NULLを返すますので、カラムがない場合はNULLになります。 そして、NULLと数字０の比較で常にFalseになることを利用しました。 COLUMNPROPERTYの詳細はSQLOnLineHelpを参考にしてください。 参考URL：http://d.hatena.ne.jp/nagakura_eil/20070913/1189 …
他表を利用してupdateする場合、SQL Serverでは、from句を使用します。 UPDATE TABLE_A SET 単価 = TABLE_B.単価 FROM TABLE_B WHERE TABLE_A.商品 = TABLE_B.商品 AND TABLE_A.色 = TABLE_B.色
＞SQLサーバ[セキュリティフォルダ]下の[ログインフォルダ]の ＞ユーザ情報は保存出来ないのでしょうか？ master、msdb、modelをバックアップすればユーザー情報もリストアできます。 ＞SQLサーバ自体のバックアップは取れるのでしょうか？ 同上
>Dayフィールド、Timeフィールドは共にvarchar2です。 SQL Server 2005を使用しているのですよね？ varchar2は、「Oracle独自のデータ型」と認識していますが？ 時刻をvarcharで管理するメリットって、思い浮かばないのですが？ SQL例を提示しておきますので、何をやっているかは自分なりに調べてみてください。 select [day], sum(datepart(hh,[time])) +floor(sum(datepart(mi,[time]))/60) as hh, sum(datepart(mi,[time]))%60 as mm from tbl1 group by [day]
SQL Server 2000 の知識しか無いのですが、それをベースにいいますと SQL2000 では レプリケーションは エージェントというサービスが実行してます。そこで、レプリケーションを行う場合には、そのエージェントサービスの実行をローカルユーザーでは無く、ドメインユーザーで実行する様に変更します。各PCではそのドメインユーザーがローカルPCの管理者権限を持つ様にします。 SQL2005 の場合にはそのサービスがどれになるのか、不明です。 SQL Server 自身も同様にドメインアカウントで実行した方が良いと思います。
＜確認＞ http://localhost/phpinfo.php　はバージョンが表示されましたか? バージョンはいくつでしたか ＜確認＞ http://localhost/PHPtxtWrite/phptxtwrite.php　が404の時は 場所が違っているはずです 例として　test.jpg　を表示したい時は　C:\xampp\htdocs　に置いて C:\xampp\htdocs\test.jpg　これを表示するなら http://localhost/test.jpg　これを開きます 「C:\xampp\htdocs\」と「http://localhost/」は同じということです フォルダがあるときの例として C:\xampp\htdocs\PHPtxtWrite\phptxtwrite.php　これを開く時は http://localhost/PHPtxtWrite/phptxtwrite.php　これになります C:\xampp\htdocs\(=http://localhost/)公開フォルダの中の PHPtxtWrite　フォルダの中の　 phptxtwrite.php　というファイル　を開くということになります 置いている場所を確認してください URLに合うように場所を移動するか　 場所に合わせてURLを変更してください ＜機能＞ 商品名,商品ID,商品在庫数の項目 これは表示だけでしょうか　在庫数は増減させますか 1個ずつ上下しますか　入力しますか 平均的な在庫数　一回の増減数　はどのくらいですか 発注点などは必要でしょうか(少なくなったらMailとか)　 商品数はいくつくらいでしょうか　これから増えますか 今後数年間くらいでMAXどのくらいの予定でしょうか 商品検索はしますか　画像は表示しますか
SQL Serverは、2000ですか？2005ですか？ Bテーブルでは、年度毎にCODE=0のデータは、必ず存在する訳ではないのですよね？ 例えば、次の1件だけが追加されることもありますか？ NO NENDO CODE BIKO --+------+-----+---- __3_____2008________1_3333
バックアップ→復元で、 復元するときにデータベース名と、物理ファイル名を書き換えるとOKのはず。
バックアップ後に BACKUP LOG （データベース名）WITH TRUNCATE_ONLY を実行すればログが切り捨てられます。 ただ、ログを削除しても「圧縮」しないと、見た目上の容量は 変わりませんよ。これは仕様です。 参考URL：http://www.sqlpassj.org/tokushu/backup/03.aspx
状況がよくわかりませんが、次のどれかでしょうか？ ・SQLServerが起動していない ⇒SQLServer構成マネージャのサービスで確認して下さい。 ・接続時のインスタンス名が異なっている ⇒データソース作成時にサーバー名を指定する箇所で、プルダウンを選択するとサーバーの一覧が表示されます。ここで、インスタンス名を指定していた場合は、(サーバ名)\(インスタンス名)と表示されます。SQLServerのDB作成時にインスタンス名を指定した場合は、インスタンス名も指定しないと接続できません。 ・接続する権限がない ⇒SQLServerセキュリティ構成で、新しい管理者を追加する。
詳しく説明ください。
ぱっと思いついたのは -- SELECT MST.SHAIN_ID, MST.SHAIN_NAME, MAX(LOG.LOGINTIME) FROM MST, LOG WHERE MST.SHAIN_ID = LOG.SHAIN_ID GROUP BY MST.SHAIN_ID, MST.SHAIN_NAME ORDER BY MST.SHAIN_ID; -- ※動作検証していませんので、動作保障はしません。 パフォーマンスが悪い理由はFROM句にクエリーを使っていることです。 必要なとき以外は使わないほうがよいです。
これで試してみてください Scn.ConnectionString = _ "Data Source=サーバー名;Initial Catalog=データベース名;User Id=ユーザー名;Password=パスワード;"
Windowsのロケールの設定を日本語にした状態でSQLServerをインストールした場合、cp932がデフォルトの照合順序になります。照合順序については参考URLをご覧下さい。 SQLServerではわかりませんが、PostgresではJDBCドライバ部分で変換していたように記憶しています。ODBCドライバではAutoTranslateという機能があります。 このため、ODBC接続で何も考えずにvarcharを使用するとcp932になります。 参考URL：http://www.microsoft.com/japan/msdn/sqlserver/sq …
SQL Server は データ更新中のバックアップが可能です。 バックアップの内容はバックアップが完了した時点の DB状態がバックアップされていることになります。 (バックアップ完了時点で、コミットされていれば、 バックアップはされています。) DBの不整合はアプリの異常終了等でも発生します。 不整合は、2フェーズコミットで減らすことができます。
URLやURLのQueryStringにはWEBサーバーによって、MaxBufferとか URLセパレーター間の文字数であるとかサイズ制限の設定値があり ます。またブラウザ側にも発行できるサイズの制限があります。 どのように発行して何で取得しようとしているのかが不明ですが、 手法としては、XMLHTTPを使用して長文SQLはPOSTデータとして送信 します。 WEBサーバー側では、Requestオブジェクトを工夫してTextとして取得 してSQLとして発行します。 レコードセットはXMLでResponseに書き込みます。 クライアント側はPOST後のResponseTextを直接XMLとして見るか、 XMLDomDocument.LoadXml→Recordset.Open XMLDomDocument として、通常のRecordsetに落とすことが出来ます。 ややこしそうですが、VBAやVBScriptの使えるプラットフォームなら サーバー側・クライアント側ともに10数行のコードで実現できます。 (ちょっとしたテクニックは必要ですが…) あと、少なくともセキュリティ上の配慮はないと危険です。 例えば、delee/drop/truncate/update/insert等が含まれていたら 実行しないとか、Querystringに暗号コードを含ませるとか…
色々やり方はあると思いますが、 初心者と言うことなので、簡単な方法。 ----以下手順---- 新規のクエリを作る。 テーブル1を追加する。 クエリのフィールドに、CODE,NAME,SUUを追加。 [表示]→[集計]で集計クエリにする。 SUUの集計を「最大」にする。 名前をつけて保存する「最大数」 このクエリを閉じる。 もう1つ新規のクエリを作る。 テーブル1と、先ほどのクエリ「最大数」を追加する。 CODE,NAME,SUU（SUUの最大）同士を結合する。 クエリのフィールドに、CODE,NAME,SUU,DAYを追加する。 [表示]→[集計]で集計クエリにする。 DAYの集計を「最小」にする。 ----以上手順---- CODEとNAMEの扱いに関して少し疑問がありますが、 多分これで希望通りの結果が出ると思います。 この例では、２つのクエリを作りましたが、 １つのクエリで書くことも可能です。
こんにちは。 XML型はバイト数の指定はできないみたいですよ。なぜかはよく知りませんが、XML型がBLOB（バイナリラージオブジェクト型）なので文字列や数値のように指定ができないかと思われます。 確証はありませんのでご参考まで。
＞商品の入力には困らないのですが・・・ 困ると思いますよ。 商品マスターで設定するのは標準仕入単価。 これを仕入単価とイクオールとすると様々な問題が発生するでしょう。 仮に１０伝票入力してから標準仕入単価の入力ミスに気付いたとしたら・・・。 そういうことで、[仕入伝票！仕入単価]を設けるのが常套手段かと思います。 そういう設計ならば、質問の件も片付きます。 なお、通常は、仕入伝票には[区分]欄を設けます。 仕入、返品、運賃、値引、無償などなど。 それによって、入力すべき欄を限定していくのはＶＢＡの役割。 このように思います。
たしか、GUI上では、無理だったような気がしました。 SQL Server 2000 の例になってしまいますが、 http://www.microsoft.com/japan/technet/prodtechn … にもあるように、変換先と変換元のマッピングをオリジナルで やるには、DTS(VBScript)（2005の場合だとSSIS(SQL Server Integration Services)でVB.NET（C#は未サポート))を使い、 マッピング処理を行うパッケージを自分で作って、それをパブリケーション側の「サブスクリプション」の変換設定で、作ったパッケージを設定するしか方法がしかなかったような気がします。 マッピングだけじゃなく、列名の変更についても同様のやり方だった ように記憶しています。 ＃SSISについては、 http://www.microsoft.com/japan/sql/prodinfo/feat … に概要がありますので、ご確認頂けたらと思います。 かなり面倒な形で大変恐縮ですが、ご確認頂けると幸いです。 参考URL：http://www.microsoft.com/japan/technet/prodtechn …
すいません、質問の趣旨がいまいち良く見えてないんですが、 ・「存在しないときにはエラー」というのは、 　ファイルグループ・セカンダリファイルが存在しないときに 　エラーになっているという意味でしょうか？ ・エラーにならないよう、存在しない時の対処をどのように 　行えば良いか？という質問ですか？ ・sp_helpfileとsp_helpfilegroup以外で確認できるストアドが 　ないかという質問ですか？ 上記の文面だけだと、現象はわかるんですが、何をどうしたいのか よくわかりませんので、質問したいことを詳細に教えて下さい。
AccessでODBCリンクを張るのが一番ラクですよ。 データのインサートや参照、変更など全て行えます。
基本的におっしゃったような手順がGoodかと思います。 ただ、気になるのは、 「もしなんらかの事象でSQLServerのインスタンスが停止しない場合は、強制終了等の保険の手段をもって終了する」 のところですね。 この場合、TerminateProcessというAPIを使って、SQL Serverのサービス（インスタンス）を強制終了するようにすべきですね。 C#で書くと、 [DllImport("Coredll.DLL")] public static extern int TerminateProcess(IntPtr hProcess, int uExitCode); を定義して、TerminateProcessを呼び出す必要があります。 hProcessは、OpenProcessというAPIで、SQL Serverのサービス用 プロセスを取得したもの、uExitCodeは、 確かSERVICE_CONTROL_SHUTDOWN？（忘れてしまいましたが）を 設定し、TerminateProcessすれば、問題ありません。 ＃　OpenProcessもTerminateProcessも.NET Frameworkの 　　マネージコードではなく、アンマネージ（Win32）用の 　　Functionになりますので、DllImportして、呼び出してください。 ＃　OpenProcess、TerminateProcessのサンプルがVC++のものは 　　たくさんありますが、C#用のものが少ないみたいなので 　　少しネットでお探しになってみることをお勧めします。 　　（私も半分忘れてます） こうすれば、（２）は、より安全できると思います。 参考になれば幸いです。
最終的に得たい形式等が不明ですが。。。 例を示しておきます。 declare @yyyymmdd char(8); select @yyyymmdd = '20070930'; select convert(varchar(10), dateadd(month,-1, substring(@yyyymmdd,1,4)+'-' +substring(@yyyymmdd,5,2)+'-' +substring(@yyyymmdd,7,2) ), 20); go
もう解決しているか、あきらめていらっしゃるかも知れませんが・・・ *.mdfにSQLServerを実行しているアカウント（具体的にはローカルグループのSQLServer2005MSSQLUser$YOUR_PC_NAME$SQLEXPRESS）に対しフルコントロールのアクセス権限を与えてください。詳細な手順は、参考URLの私のブログのエントリをご参照ください。 ＃同じエラーにハマってかなり焦りました・・・(^^;;; 参考URL：http://d.hatena.ne.jp/babydaemons/20071207
#1です。 すみません、Oracleでは完全外部結合は使用できないみたいですね。 LEFT OUTER JOIN と RIGHT OUTER JOIN を UNION で組み合わせるようです。
ここは「SQL Server」のカテゴリですが、SQL Serverについての質問ですか？ SQL Serverには、「desc 表名」といった機能は、ないのではないでしょうか？ 表やインデクスの定義情報の管理方法は、RDBMS毎にかなり違いますし、情報を得る方法も違います。 RDBMSにより、ディクショナリ、カタログ、情報スキーマ等と呼ばれ、主要なRDBMSでは、SQLによる検索を可能にしています。また、いくつかのRDBMSでは、「DESC」(DESCRIBE)といった特別な命令を準備している場合もあります。 RDBMS名とバージョンを明記してください。
SQL Server 2005の環境しかないのですが、「SQL Server 2000でも動くと思われるSQL」、「SQL Server 2005の機能を使ったSQL」の例を提示しておきます。 １．～SQL Server 2000 (1)概要 SQL Server 2000までは、インラインビューの利用範囲に制限がある(Oracle並には実装していない）と、マイクロソフトの機能比較で記載されています。実際にどの部分まで実装され、どの部分が未実装なのか不詳ですが、以下のSQLを試してみてください。 (2)SQL例 select x.基本コード,x.大分類,中分類 from (select 基本コード,min(大分類) as 大分類 from tableA group by 基本コード) as x, (select 基本コード,大分類,min(中分類) as 中分類 from tableA group by 基本コード,大分類) as y where x.基本コード=y.基本コード and x.大分類=y.大分類 ２．SQL Server 2005～ (1)概要 SQL Server 2005で分析関数が実装されました。今回のようなケースに適用すると便利です。 (2)SQL例 select 基本コード,大分類,中分類 from (select 基本コード,大分類,中分類, rank() over(partition by 基本コード order by 大分類,中分類) as rank from tableA) as x where rank=1
SQL中に変数を指定できるのは、検索条件式中の値部分など、限られた場所だけです。これらの部分以外を可変にしたい場合は、実行時にSQL文を文字列で組み立て、EXECUTE文で実行する「SQLの動的実行」という方法を採る場合が多いです。 オンラインマニュアル（http://msdn2.microsoft.com/ja-jp/library/ms18833 …）に掲載されている例 EXEC ('ALTER INDEX ALL ON ' + @schemaname + '.' + @tablename + ' REBUILD;'); その他、参考 http://homepage1.nifty.com/kojama/works/rdbms/ms …
私も昨晩SQL Server 2005 Express Editionをインストールしました。 奇遇ですね^^ エラーメッセージを見ると、「.Net farmework 2.0がインストールされていないか、問題がある。」と言っていますね。 >以前に、いくつかv.1.0.3705, v.1.1.4322などのインストールをしていたのを... とのことですが、v.2.0 でなければダメなのでは？と思いました。 （素人考えですが。。。） こちらに詳しく書いてあるようです。 http://www.thinkit.co.jp/free/article/0603/9/2/ また、私の場合、SQL Serverをインストールする前に、VB 2005 Express Editionをインストールしたのですが、 VBインストール時に、インストーラはSQL Server関係のプログラム（コンポーネント？）を インストールしようとして失敗していました。 このときの残骸にSQLをアップデートするような形でインストールしたはずです。 参考になりましたら幸いです。
SQL Server 2005 SP2 をインストールされていらっしゃる場合、 実は、SP2は、2007/3/6版と2007/3/9と2種類あって、 どうもこの3/6版の方は、メンテナンスプラン関係のバグが いろいろとあったようなので、できれば、3/9版のものを インストールしなおすか、SQL Server 2005 Service Pack 2 重要な更新 (KB:933508)をあてるかした方が、宜しいかと思います。 http://www.microsoft.com/japan/sql/sp2.mspx 自信はないのですが、念のためご確認頂けたらと思います。 参考URL：http://www.microsoft.com/japan/sql/sp2.mspx
各cd、date列の値毎に、最少のid列の値を得るということなら、 次のSQLで結果を得られます。 select * from tmp where id in( select min(id) from tmp group by cd,date ) order by id
<tab1> ID___kname___address1___address2___dob 1____田中_____東京都______渋谷区_____1960/01/01 2____上村_____東京都______渋谷区_____1970/01/01 3____橘川_____null___________null_________null 4____田中_____東京都______null_________null 5____橘川_____東京都______渋谷区____null (1) SELECT * FROM tab1 WHERE (Address1+Address2) is not null and dob is not null; (2) SELECT * FROM tab1 WHERE Address1 is not null and Address2 is not null and dob is not null; (3) SELECT * FROM tab1 WHERE isnull=0; 検索->表示を１０００回繰り返した場合、1=4.85秒、2=5.00秒、3=5.10秒。 なお、bit列を設けた場合、比較する列が１個増えると(3)が(1)(2)との差を0.1秒縮めるようです。 ですから、比較する列数では、空行が存在するか否かの列を追加した方がスッキリする気がします。 もちろん、目的と運用次第でしょうが・・・。
見ている所はあっていると思います。 このエラーからすると言語はVBですね。 私はC#で製作しました。 多分、１～４で行なうDLLの参照設定が上手く出来てないからだと思います。 ここの説明を参考にして、試してみたら上手く動きました。(勿論VBで試しました) ※Tablet PC 用の参照設定は無視しました。 まだ、引っかかっているとすれば、参照設定しているDLLが間違っているのではないでしょうか？ 因みに私は、デスクトップ用のランタイムをインストールしてないので 以下の場所を参照させました。 「C:\Program Files\Microsoft Visual Studio 8\Common7\IDE\System.Data.SqlServerCe.dll」 更に、実行時には以下のDLLを実行場所に置きました。 ・sqlcese30.dll ・sqlceme30.dll ・sqlceqp30.dll ・sqlceer30ja.dll 何れも「C:\Program Files\Microsoft Visual Studio 8\Common7\IDE\」以下にあります。 作成したSDFファイルは、サーバエクスプローラから接続して操作できます。 ※クラスライブラリの詳細はVS2005 MSDNライブラリの方を見る方がよいです。 .NETの開発 　－.NET Freamework SDK ドキュメント 　　－クラス ライブラリ リファレンス 　　　－System.Data.SqlServerCe 頑張ってください。
カテゴリ通り、SQL Serverについての質問ですか？特定のRDBMSに関する質問なら、バージョンを明記しましょう。せっかく具体的なアドバイスをもらっても、質問者さんの環境では実行できないかも知れません。 質問の差分検索を行う方法は、1文で行うとしても次の三つの方法がすぐに思い浮かびます。 (1)not existsを使う (2)not inを使う (3)left joinを使う 「丸投げ」はここの禁止事項でもあるので、上記のキーワードでネット検索してみてください。
という話になると、無理ですね。 sp_helploginsは、いろんなところからシステムビューを取得し、 TempDBを一旦生成してから、結果を表示する仕組みにしてますので 単純なビュー化は、無理です。 もしやるのであれば、 sp_helptext N'[master].[dbo].[sp_helplogins]'　と sp_helptext N'[master].[dbo].[sysusers]'　 でみると、「sp_helplogins」や「sysusers」のストアドソースを 見ることができますので、ソース内に書かれている重要箇所の SQLをかいつまみながら、うまくJOINさせて、 独自ストアドをつくるしか方法がないと思います。 カタログビューでもできないことはないですが、 データベースロールメンバシップもという話になると、 sp_helploginsのストアドソースを活用して、 独自ストアドを用意するしか対処のしようがないと思います。 （残念ですが） この辺りは、将来的（来年発売される SQL Server2008）には システムビューとして、用意してくれないかなと思うところでは あります。
SQL Serverがインストール済みなら、 このマージレプリケーション用のC#のサンプルコードが 既にHDDにコピーされていると思いますので、 そのままSharpDeveloperというツールで、VB.NETにConvertかければ 使えそうですね。 後は、VB.NETに変換した後の解析次第かなと思います。
どうも、これですね。 http://support.microsoft.com/kb/304261/ 基本的には、SQL Serverは、NASに対し、DBファイルの保存を UNC指定でサポートしていないみたいなことが書いてあるっぽいです。 斜め読みしただけで、詳しくは見てないのですが、ご参考になれば 幸いです。 ＃日本語のページを探したんですが、見つからなくて、すいません。 ＃的外れだったら、すいません。自信はないです。
＞一向にインストールされる気配がありません 何か、エラーが表示されたりしていませんか？ また、イベントログに何かエラーが出ていないか確認して 頂き、そのエラー情報を教えてください。 ＞自分なりにいろいろと調べましたが 調べたサイトのURLがわかれば教えてください。 ＞若干スペックが足りなく、警告がでます インストールしようとしているサーバに、どれぐらいのメモリ容量を 積んでいるんでしょうか？ 細かいことはわかりませんが、.NET Frameworkのバージョンが古いか Windows Installerのバージョンの問題かなという気はしています。 とりあえず、もう少し情報下さい。
No1です。 再度確認です。 >テーブル内が↑の状態で11時のみを指定するとコード0001,0002のレコードのみ取得する条件の書き方を知りたいですが 11時のみだと 0003 10時のみだと 0001,0002 ではないでしょうか？ SELECT Code,BegTim FROM テーブル WHERE DATEPART(HOUR,BegTim) = 10 '←又は 11
Windows デスクトップ サーチと、SQL Server 2005 Compact Editionは、関係性がないので、アンインストールしても問題ないと思います。 ただ、写真やメール、スケジュール情報や各種ファイルをSQL Serverとあわせて情報管理＆検索を行いたい、PDAに取り込むとかやるのであれば、結構便利ですけど、そういうことをしないのであれば、アンインストールしても問題ないと思います。 http://www.microsoft.com/japan/windows/desktopse … http://www.microsoft.com/japan/sql/editions/comp …
No1さんの回答の２番煎じです。 <出荷ファイル> ID__出荷日_________出荷番号 1___2007/08/06__5 2___2007/08/06__7 <出荷明細> ID__出荷日_________出荷番号__品名 1___2007/08/06__5_____________A 2___2007/08/06__6_____________B UNION 演算子を使用すると、2 つ以上の SELECT ステートメントの結果を結合して単一の結果セットにできます。 (Books Online) ですから、＜最大値なら単一の結果セット＞と考えるでしょう。 select 出荷番号 from 出荷ファイル where 出荷日='2007/08/06' union select 出荷番号 from 出荷明細 where 出荷日='2007/08/06' このSQL文の実行結果は次のようです。 ____|出荷番号| ____|____________| ___1|__________5| ___2|__________6| ___3|__________7| こうなれば、出荷番号=7 を選択するのみ。 select max(出荷番号) As 出荷番号最大値 FROM (select 出荷番号 from 出荷ファイル where 出荷日='2007/08/06' union select 出荷番号 from 出荷明細 where 出荷日='2007/08/06') as ShipNumbers ____|出荷番号最大値| ____|_____________________| ___1|___________________7| 「No1さんの回答の２番煎じ」という理由です。 PS:[素直に考えればunionを使いたくなります]とは、どういう意味なのか？ SELECT * FROM 出荷ファイル AS A INNER JOIN 出荷明細 AS B ON A.出荷日=B.出荷日 ____|ID|出荷日_______|出荷番号|ID|出荷日_______|出荷番号|品名| ____|--------------------------------------------------------- ___1|_1|2007/08/06|__________5|_1|2007/08/06|___________5|A___| ___2|_2|2007/08/06|__________7|_1|2007/08/06|___________5|A___| ___3|_1|2007/08/06|__________5|_2|2007/08/06|___________6|B___| ___4|_2|2007/08/06|__________7|_2|2007/08/06|___________6|B___| なるほど、単一の結果セットにならないので最大値を求めるには適しないということなんでしょうね。 ※恥ずかしながら、本日、生まれて初めて union なんて使ってみました。 ※まあ、便利なものがあったんですね。
EXECでSQLを動かした場合は、COUNTの結果は取れないですね。 select @aWork = count(*) from a where id = @IDs でやれば、OUTPUTで結果を返すんですが、どうしてもEXECじゃ なきゃダメであれば、EXECじゃなく、sp_executesqlを使って、 下記のようにしてみたらどうでしょう？ -- 実行 EXEC sp_executesql N'select @aWork = count(*) from a where id = @IDs', N'@aWork int OUTPUT, @IDs varchar(max)', @aWork output, @IDs ご参考までに、どうぞ。 参考URL：http://blogs.sqlpassj.org/yoshihirokawabata/arch …
テンポラリーテーブルを作る方法でできませんか？ ストアドプロシージャ内でTEST2に該当するテーブルを造ります。 Create Table #TEST2 (以下略 というように頭に「#」をつけてください。 以降このテンポラリーテーブルを使えば、同じ手順でできると思います。
ご存知かもしれませんが、Enterprise ManagerからGUIでバックアップをかなり細かくスケジュールできます。 さて、「バッチでデータベース保守計画」ですが、実現されたい内容によるかと思いますが、簡単なバックアップならば.batファイルにOSQLコマンドを記入してWindowsスケジューラーから定期的にSQLを実行できます。 自分はバックアップ用のストアドプロシージャをいくつか作ってバックアップを取っていました。 OSQLの使い方はヘルプに詳しく乗ってます。または下記のサイトもわかりやすいと思います。 http://d.hatena.ne.jp/chaichanPaPa/20061029/1162 … 参考URL：http://d.hatena.ne.jp/chaichanPaPa/20061029/1162 …
((マスタ.BIKOU) like '*' + Forms!確認日!確認日 + '*')) これだとどうですか？ ＃アクセスは使わないので演算子に誤りがあるかもしれません。
他の方が回答されている動的SQLか、受け取った変数をテンポラリテーブルに挿入してから、IN (SELECT a FROM temp_table) というのも可能だと思います。
まずは、何を目的に５つのＤＢの特徴や長所、短所を調べているのですか？ →それにより好ましい返答の書き方が変わります・・・f^_^; 　どういったことを知りたいのか？(観点) 　どういう粒度の情報を知りたいのか？(知識レベル) とりあえずさらっとした情報を以下に、、、 (誤解を恐れずに主観も交えてます。) 無償：MySQL,PostgreSQL 有償：Microsoft Access,Microsft SQL Server,Oracle 大規模向：MySQL,PostgreSQL,Microsft SQL Server,Oracle 小規模向：Microsoft Access 上級者向：MySQL,PostgreSQL,Oracle 万人向　：Microsoft Access,Microsft SQL Server スピード 速　MySQL,Oracle 中　PostgreSQL,Microsft SQL Server 遅　Microsoft Access Windowsとの相性(※どれもWin上で動きますが) 良　Microsft SQL Server,Microsoft Access ↑　Oracle ↓　PostgreSQL 悪　MySQL 冒頭の質問に補足していただければ、もう少し別の書き方が出来るかもしれません。
SQL Server 2000 では不能は撤回！ お恥ずかしながら、サブクエリに関しての勉強不足でした。 ___|(expession)| ---|------------ __1|__________6| No2さんの回答を実行すると目的を達しました。 ※ゴミ回答、お詫びです。
DTSインポート/エクスポートというツールで簡単に出来ますよ。 (#1の方のご紹介されているページにも記述がありますが) 具体的には、エンタープライズマネージャ上でコピー元のデータベースを右クリックして、[全てのタスク]-[データのエクスポート]から起動できます。 試してみてください。
それから、レプリケーションの種類は、何かをお尋ねするのを 忘れました。（マージかスナップショットですよね？） レプリケーションそのものをストアドで設定するには、 「sp_replicationdboption」というストアドでできます。 http://technet.microsoft.com/ja-jp/library/ms188 … ただ、上記ストアドだけではできないような気がするので、 念のためマルチバージョンに対応した 作り方を、下記で一読されて、他にも使用すべきストアドが ないかお探しになった方がよろしいかと思います。 http://technet.microsoft.com/en-us/library/ms143 … （英語） なお、ストアド名さえわければ、ストアドの引数は、 「sp_help ストアド名」 で調べられますので、それで調べてみてください。 ＃レプリケーションというより、パブリケーションや 　サブスクリプションの作り方に問題があるような気もするので、 　もし、ダメなら、別途ご相談下さい。
両者に機能的な差はないようですが、Developer Editionはライセンス上「実運用に使用することができない」となっているはずです。 参考URL：http://www.microsoft.com/japan/sql/prodinfo/feat …
>> Manegement Studio Expressの起動時に管理者として実行すると >> 作成が可能 ということは、バグではなく、権限の問題ではないですか。 そのユーザには Create Table の権限を設定していますか。
shainCD　って社員コードですよね、きっと！ ってことはそのテーブルに同じ社員コードからのデータは格納できないのでは？？ 私がやるとすれば shainCD、oubotime、shukketu、del 　　　↓ shainCD(キー)、回答連番(キー)、oubotime、shukketu として連番がMaxのもの(Select Top 1 などして)を取得します。 削除フラグ(delフィールド)は不要ではないでしょうか？ 登録時の処理にちょっと手を入れないといけないですがいかがでしょうか? 問題を間違って理解してたらゴメンナサイです。
svrnetcn.exeを実行する
１．まずDROPをクエリエディタで開きます。 ２．次にCREATEでクリップボードを選択します。 ３．そして１で開いたスクリプトにペーストします。 ステップ数は多いですが、これでも実現可能です。 シノニムなど、ALTERが選択できない場合にやっている方法です。
補足です。早い話が、 「sp_spaceused テーブル名」 でテーブル単位の容量を確認することができますってことです。 前回提示したサンプルは、DB内にあるすべてのテーブルの 容量を１つずつ表示しているというサンプルになります。 ご参考までに。
確認ですが、検索条件のキーとなっている Col1という項目ですが、主キーでしょうか？ もし、Col1が主キーでない場合は、SQL Server側で インデックスを貼ってみるといいかもしれません。 またその時に、1日に1回程度、インデックスの再構築する Agentをしかけておくといいかもしれません。 ご参考になれば幸いです。
RDBMSは、SQL Serverなのですね？ 2000ですか？2005ですか？ バージョンにより、せっかく具体的なSQLを提示しても、質問者さんの環境では動かせない場合があります。 以下のSQLを試してみてください。2005なら動くと思います。 2000なら、インラインビュー（「select ～ from (select ～ from ～）」という記述）が、使えないかも知れません。 select * from(select c1 from A union select c1 from B union select c1 from C) as x where not exists (select * from A,B,C where A.c1=B.c1 and B.c1=C.c1 and x.c1=A.c1)
補足： ? DBSelect("select * from table1 where isNull(項目_1, '') Like '%'") 1;aa02; 2;aa01; 3;; 4;bb01; 5;bb02;
無事、接続ができた＆問題が解決できて良かったです。 アタッチの場合もその手順で合っています。 （ご報告ありがとうございます） むしろ、アタッチで試した場合でもやっぱり同じだったことが わかり、了解致しました。 いずれもマイクロソフトの既知の問題として、以前のバージョンから このような現象が良く発生しております。 バックアップ/リストア、アタッチ/デタッチ　共に ユーザIDの扱いは注意が必要かもしれないということで、 ご参考になれば幸いです。
TCP/1433 だけではなく、 UDP/1434ポートについても ポートを空けていますか？ UDP/1434 を使用してアプリケーションからの通信リンクが確立されますのでご確認下さい。 また、ODBC接続で名前付パイプで接続しているケースになると TCP/1954 でネットワーク要求しますので、こちらもあけておく 必要があります。 さらに、ODBC接続情報には、DBサーバのマシン名ではなく、 IPアドレスを指定してみるパターンも試してみてください。 参考URL：http://msdn2.microsoft.com/ja-jp/library/ms17548 …
・回線種別 ・1日あたりの検索・更新頻度 により、大きく異なります。 私の場合、自宅から、ＡＤＳＬ４７Ｍの回線で、会社へＶＰＮ接続し ておりますが、レスポンスタイムで苦痛を感じることさえ、あります。 拠点単位で独立したデータであれば、トランザクションは、拠点管理として、 日次バッチなどで、本社のマスタを更新されることをお勧めします。 光接続であれば、レスポンスタイムなど、激減するかもしれませんがね。
ストアドプロシージなど見たことも使ったこともない一介のデザイナでプログラマではない門外漢ですが・・・。 まず、ストアドプロシージャ云々はさておいてＳＱＬ文を完成させることが先決かと思います。 そうすれば、後はトントンかと。 例えば、 "AAAA" & "BBBB" ---------> "AAAA" + "BBBB" "#2007/03/20#" -----------> "2007/03/20" MOD ---------------------> % DateDiff("m", XXXX, YYYY) ---> DateDiff(month, XXXX, YYYY) 1 & "年" ------------------> convert(varchar(2), 1) + "年" などなどの修正が必要です。 <Table1> ID____入社年月日 1_____2004/01/01 SQL Server 2000 上にこのようなテーブルを作成し、Ａｃｃｅｓｓ2002のイミディエイトウインドウで修正を反映したＳＱＬ文を実行。 [イミディエイト] ? DLookup("Convert(varchar(2),DateDiff(month,[入社年月日],'2007/03/20') / 12) + '年' + convert(varchar(2),DateDiff(month,[入社年月日],'2007/03/20') % 12) + 'ヶ月'","Table1") 3年2ヶ月 こういう結果を得ました。 なお、一応、ストアドプロシージャも作成してみました。 実行結果は、次のようです。 勤続年数 3年2ヶ月 CREATE PROCEDURE dbo.[ストアドプロシージャ1] AS SELEC　CONVERT(varchar(2), DATEDIFF(month, 入社年月日, CONVERT(DATETIME, '2007-03-20 00:00:00', 102)) / 12) + '年' + 　　　　　　　　CONVERT(varchar(2), DATEDIFF(month, 入社年月日, CONVERT(DATETIME, '2007-03-20 00:00:00', 102)) % 12) + 'ヶ月' 　　　　　　　　AS 勤続年数 FROM　dbo.Table1 GO なお、このストアドプロシージャに関して補足質問されても何も判りません。
<Table1> ID__A___B___C 1___5___a____b 2___7___c____d 3___4___a____d 4___5___f_____b select patindex('%[a]%', B)+patindex('%[b]%', C)*2 As GroupNumber, * from table1; |GROUPNUMBER|ID|A|B|C| ---|--------------------- 1| 3| 1|5|a|b| 2| 0| 2|7|c|d| 3| 1| 3|4|a|d| 4| 2| 4|5|f|b| このように Case文の多くは、数値に換算できることが多いです。 そして、見出しも、GROUPNUMBERで生成できます。 インラインビューが使えるならば、GROUPNUMBER を生成する記述も一回で済みます。
DTSオプションだと相対PATHみたいなので、 FileオプションでPATHを指定して見て下さい。 dtexec /File C:\sql2005\dtsx\(パッケージ名).dtsx このとき、Serverオプションは不要なので、試していただけますか？
#2 です。 Express Edition は、デフォルトではネットワーク構成が無効となっている様です。BooksOnline で確認。 有効にする方法は、他のエディションと同じだとすると、構成マネージャからできます。
ご回答が遅くなってすいません。 ＞MDACの最新バージョンは2.8 そうですね。最新は、2.8なので、念のため各クライアントに 割り当てておくといいかもしれません。 （Webアプリであれば、WebサーバとDBサーバだけ、MDACの 最新を割り当てておくだけでいいんですけど、Windowsアプリだと 各クライアントに割り当てる必要ありですね） ＞予約語の違いについて 当時の担当者に問い合わせたところ、SQLを変更したのではなく、 sp_dbcmptlevel というストアドを使って、 「データベースの互換性レベル設定」っていうのをやって、 それで吸収したそうです。 なので、予約語の違いによるSQLやストアドの修正は してなかったそうです。 sp_dbcmptlevelストアド（旧バージョン互換性設定）については 下記をご参考にしながら、設定すればOKです。 http://msdn2.microsoft.com/ja-jp/library/ms17865 … よろしくお願いします。
下記、インラインで回答します。 ＞現在、Standard EditionとWorkgroup Editionとで選択を迷っている状態ですが、やはり機能的にWorkgroup Editionでは後々不足する部分が出てくるでしょうか？ http://www.microsoft.com/japan/sql/prodinfo/feat … にもあるように、Workgroup Editionだと機能が制限されて しまいますね。 クラスタやミラーリングでDBサーバを構築するのであれば、 Standard の方がいいという部分、 また、DBのレスポンスが悪い場合は、チューニングアドバイザーと いうのを使って、ボトルネックを探せる便利な機能があるんですが それもWorkgroupにはなく、Standardにはある状態です。 上記以外は、あまりWorkgroupとStandardの違いというのは ないと思っています。 また、普通にDBを接続して、SQLやストアドでテーブル操作するような ことであれば、どのエディションでも使えますし、 Standardか、Workgroupのどちらにするかについては、 ご予算次第かなと思います。 ＃　個人的にはレスポンス対策ができ、チューニングアドバイザー 　　がついているStandardは、結構お勧めですね。 ご参考になれば、幸いです。
select 名前, sum(case when 月=1 then 金額 else 0 end) as １月, sum(case when 月=2 then 金額 else 0 end) as ２月, sum(case when 月=3 then 金額 else 0 end) as ３月, sum(case when 月=4 then 金額 else 0 end) as ４月, sum(case when 月=5 then 金額 else 0 end) as ５月, sum(case when 月=6 then 金額 else 0 end) as ６月, sum(case when 月=7 then 金額 else 0 end) as ７月, sum(case when 月=8 then 金額 else 0 end) as ８月, sum(case when 月=9 then 金額 else 0 end) as ９月, sum(case when 月=10 then 金額 else 0 end) as １０月, sum(case when 月=11 then 金額 else 0 end) as １１月, sum(case when 月=12 then 金額 else 0 end) as １２月 from テーブル名 group by 名前
ORACLEしか知らないので、確かなことは言えませんが、 SQLでいう列番号は、SELECT句の列リストの順番で決まるはずですから、設問自体が矛盾 しているように思います。 レコードセットから取るにしても、結果が出た後どうするかという話ですから、同様です。 また、列番号がORDER BY句以外で使えるという話も聞きません。 やはり、A No.2さんの言うように、結果を取り出したあと、それを数字のような固定した 名前や数字にしたい、というような話だと思いますが、いかが？ ならば、レコードセットを使うとか、SQL上で処理するなら列別名を使うとか、でしょう。
SQL Serverの勉強方法ですが、目的によっても違ってくると思います。 たとえば単純にSQLすらわからないから、SQLだけ覚えたいとか SQL Server独自のサーバー管理手法を覚えたいなど... もし、単純にSQL構文だけを勉強したいのであれば、 MSDEでも、SQL Server 2005 Express Editionでも、どちらでも いいと思いますが、画面（GUI）がある分、 SQL Server 2005 Express Editionの方が入りやすいかなと思います。 また、SQL Serverのサーバ管理手法を覚えたいのであれば、 MSDEは、すべてがCUI（コマンドベース）のため、専門知識は 身につきますが、初めは、何かとイメージしずらい部分もありますので、 基本から確実に学びたいのであれば、 GUIベースのSQL Server 2005 Express Editionの方がいいかと 思います。 用途や目的により変わってくると思いますので、その辺りは ご判断頂きたいと思います。
SQL Server上でXMLファイルを読み込むには、 「SQL Server Integration Services(以下、SSIS）」の機能を 使えばできますが、ストアドではできません。 もし、.NET + VB.NET の技術をお持ちであれば、SSISの機能で 作ることをお勧めします。 SSISについて http://www.microsoft.com/japan/sql/prodinfo/feat … ＃　ストアドから、SSISのモジュールを呼び出すことも可能です。 　　（sp_start_jobというストアドで呼び出せます） ただし、SSISじゃなく、どうしてもストアドでやりたい場合は、 制限付ではありますが、動くサンプルを作ってみました。 制限内容： ・XMLファイルがSJISであること ・SQL Serverの設定で、xp_cmdshellストアドが動く 　サーバ環境にあること # xp_cmdshellの動作を許可するには、事前に下記のストアドを 　流し、管理者ユーザで、サーバ設定を変更する必要があります。 ---------------------------------------------------------- sp_configure 'show advanced options', 1; GO RECONFIGURE; GO EXEC sp_configure 'xp_cmdshell', 1; GO RECONFIGURE; ---------------------------------------------------------- もし、それらの制限が回避できるのであれば、下記のコードで XMLファイルをストアドから読み込むことができます。 master DBにある「dbo.xp_cmdshell」というストアドを呼び出し、 XMLの内容をDOSのtypeコマンドで取得。 取得した結果を「#」付のテーブル名（ようは、tempDBに一時格納） させ、展開させ、後は、sp_xml_preparedocument やOPENXMLを 使って、XMLを目的に合わせてデータ処理すれば、宜しいかと 思います。 ■ストアドからXMLファイルを読み込む declare @buffer nvarchar(max) declare @maxLine int declare @i int declare @line nvarchar(max) -- tempdbに一時テーブルを作成する create table #tempXML(lineBuffer nvarchar(max)) -- DOSのTYPEコマンドでXMLファイルの内容を表示させ、tempdbに作成した#tempXMLテーブルに内容を書き込む insert into #tempXML exec master.dbo.xp_cmdshell 'type C:\abc.xml' -- 初期化 SET @i = 0 SET @buffer = '' -- XMLファイルの行からバッファを生成する declare cur cursor for select * from #tempXML open cur fetch next from cur into @line while @@FETCH_STATUS = 0 begin 　if @line is not null and PATINDEX('%<!--%', @line) = 0 　　begin 　　　set @buffer = @buffer + @line 　　end 　　fetch next from cur into @line end close cur deallocate cur -- XMLファイルから読み込んだXML文字列を取得する select @buffer -- 一時テーブルを削除する drop table #tempXML -- XMLパーサーでXML用のノード階層を作る declare @hdoc int exec sp_xml_preparedocument @hdoc output, @buffer -- ノードをテーブルに格納したイメージを表示 select * from OPENXML (@hdoc, '/views/view',1) -- XMLパーサー解析用ハンドルを閉じる exec sp_xml_removedocument @hdoc 長くなりましたが、ご参考になれば、幸いです。
そもそもリレーションシップの参照整合性に「連鎖更新」や「連鎖削除」はあっても「連鎖追加」はありません。 もしレコードの追加を連鎖して行いたいのであればソフト側で 親レコードの追加をトリガーに、子レコードを作るようなスクリプト を書くしかありません。
確証が得られていないので、自信はないのですが、 SQL Serverの接続オプションで、ANSI_WARNINGS、ARITHABORT、 ARITHIGNOREがOffだと、エラーは発行しなかったかと思います。 なので、 http://technet.microsoft.com/ja-jp/library/ms190 … をみながら、サーバ設定を変更するか、 サーバ設定変更が容易にできない環境にある場合は、 INSERT処理を行っているストアドや、ストアドじゃなく普通にINSERT している場合は、下記のようにしてみてください。 （エラー番号とメッセージが出たような記憶があります） ■ストアドの場合のイメージ -- エラーメッセージを表示するよう設定 set ANSI_WARNINGS on set ARITHABORT on SET ARITHIGNORE on go -- INSERT処理用のストアド CREATE PROCEDURE XXXXXX AS BEGIN 　　問題のINSERT文の実行 END ■普通にINSERTしている場合 set ANSI_WARNINGS on set ARITHABORT on SET ARITHIGNORE on go 問題のINSERT文の実行 的外れだったら、すいません。
＞違法ですが、5ユーザCAL購入で10ユーザ接続しても、 ＞SQLSERVER側は判断できないので、 ＞使用できてしまうという認識でよいですか。 ちょっと、誤解がありますね。文面を良く読みましょう！ それから、ユーザと接続数をごっちゃになってませんか？ 1ユーザ = 1接続　ではありませんよ。 5ユーザCALなのに、10ユーザが10接続する = ライセンス違反 　　　　　　　　　　￣￣￣ 5ユーザCALなのに、5ユーザが10接続が接続する = ライセンスOK 　　　　　　　　　 ￣￣￣ ￣￣￣ SQL Serverの接続数というのは、同時接続数を表しているもので CALとは別物と言いましたが、 5ユーザCALなのに10ユーザが接続した場合は、Windows 側で、 CALエラーが出ます。 必要があるならば、適切なライセンスを購入してください。 それから、違法は違法ですので、ユーザ数が足りなければ、 SQL Serverで問題がなくても、Windows側でライセンス違反に なりますので、ご注意下さい。
何を印刷したくて、どんなレイアウトのものを印刷したいのか 記載されていないので、やりたいこととの意図がずれている かもしれませんが、無難に何かを印刷したいのであれば、 ストアドではなく、SQL Server 2005 Integration Services （以下、SSIS)を使って、印刷処理を実装してみるというのは、 如何でしょうか？ Developer Editonであれば、SSISは使えたと思います。 ただし、どんなものを印刷するにせよ、 VB.NETのコーディング技術が別で必要になりますが... SSISについては、http://www.microsoft.com/japan/sql/prodinfo/feat … に紹介されております。 作成した、SSISをストアドから、呼び出すようにすれば できると思います。 ストアド内からSSISを呼び出すには、sp_start_jobを使えば 呼び出せます。 ご参考になれば、幸いです。
SQL = "SELECT [月] + '月' FROM AS 式1 月表" ですね。文字列を付加するときはシングルクォーテーションで括ってください。
select substring('-----20～24/25～29/30～34', 分布区分*6, 5) AS 年齢範囲,Sum(人数) as 総数 FROM (select *, (年齢 / 5 - 3) as 分布区分 FROM 年齢分布) AS X GROUP BY X.分布区分; なにげなく、質問文にある Count関数を使っていました。 もちろん、Sum関数です。
ザッと Web を見渡してみましたが有効な情報が見つかりませんでした。 ただ、ライセンスに対する責任ある回答は私たち一般人には答えられないのでマイクロソフトに聞くしかないですよ。 マイクロソフト カスタマーインフォメーションセンター http://www.microsoft.com/japan/customer/info/def … ここに電話して [1]-[2] で大丈夫だと思います。
質問者さんの質問内容ではテーブル名、カラム名が例示されていません。 >パラメータ　telnoを求める画面がでてきます。 ＃１さんのテーブル名、カラム名（電話番号）は、貴方の環境のテーブル名とカラム名に変更する必要があると思いますが…？
ID 値は以下の方法で管理できます。 ・Microsoft&reg; SQL Server™ 2000 レプリケーションで、ID 値の範囲をパブリッシャおよび全サブスクライバに動的に割り当てて、ID 列を自動的に管理できるようにする。 ・Transact-SQL の NOT FOR REPLICATION オプションで ID 列を定義する。 ・ID 列が不要な場合、複合キーや rowguid 列など ID 列以外の主キーを使用する。この方式では、レプリケートされたデータの ID 列を管理するオーバーヘッドをなくすことができます。 上記の詳細は以下のサイトを参照ください。 http://msdn.microsoft.com/library/ja/
リンクサーバを構築しないでもできますよ。 Management Studioから、リンク元のサーバを右Clickし、 サーバのプロパティを表示させます。 そこに、「接続」というタブがあるんで、 「このサーバへのリモート接続を許可する」をCheckONにしておく ことと、 SQL Serverをインストールすると、 [構成ツール]の配下に「SQL Server セキュリティ構成」もインストールされるので、「サービスと接続のセキュリティ構成」を 選んで、SQL Server 2005 Surface Area Configuration　を 起動させます。 [リモート接続]というタブがあるので [ローカル接続および[リモート接続]を選択し、 適切なTCPプロトコルを設定し、適用させて、SQL Serverのサービスを 再起動すれば可能です。 細かい点としては、SQL Server Browser Serviceの有効化や SQL Serverのファイアウォール設定を行う必要があります。 詳しいことは、ご確認頂いていたサイトの日本語版が http://support.microsoft.com/kb/914277/ja-jp にもありますので、少しはわかりやすいかと思います。 なお、設定後のSQLアクセスは、 select * from [サーバAのサーバ名].[DB名].[スキーマ名(dbo等)].[テーブル名] で接続可能です。 よろしくお願いします。 参考URL：http://support.microsoft.com/kb/914277/ja-jp
> どこを見てもコードの時点でデータを入力してその表示を行っていてそういったことを書いているものが見つかりません。よろしくお願いします。 スミマセン、rondon7 さんが分からない部分が分からないのです。 やりたい事の一連は分かりました。それらの中でどこの技術が分からないのか。。。 ズバリのサンプルを探すのではなく、解説等を読みながら応用していくのがスジであると思います。 たとえば先に示した MSDN : 10 行でズバリ !! SQL Server Mobile Edition を利用したオフライン ストレージの活用 (VB) http://www.microsoft.com/japan/msdn/thisweek/300 … では 「オフライン ストレージ」つまりプログラムを実行している端末内にある SQL Server Compact Edition のデータと通信するための方法が書かれています。 SqlCeConnection オブジェクトのインスタンス cn を作成して open しているあたりです。 更にデータベースに対してコマンドを実行する方法も書かれています。 SqlCeCommand オブジェクトのインスタンス cmd を作成し、コマンドの内容である SQL を設定してから実行しています。（データを挿入するコマンドですが） データベースにデータを登録するのであればこれだけで理解できると思います。 しかし上記サンプルの場合、登録するデータはソースコードの中に埋め込まれています。 テキストボックスの値を取り出すのにはどうしたら良いのか。。。 これは VB.NET で Windows フォームを使った通常のアプリケーションでも方法は同じです。 というか、スマートデバイスの Form にテキストボックスを配置してプロパティの一覧を眺めてみれば 「これかな？」 という予想ができたりします。 提案なのですが、先に Windows フォームを使って少し勉強してみてはどうでしょうか？ ほんの少しで構わないと思います。 サンプルだって星のように転がっているし書籍だって山のようにあることでしょう。 .NET Framework を使ったアプリケーション開発の特徴は、Windows アプリだろうが Web アプリだろうがスマートデバイスだろうが、似たような方法で開発できるところです。 テキストボックスの値ならどんなテキストボックスであっても Text プロパティなのです。 そうやってご自分の頭の中にあるいくつかの小さな知識の島を結びながら、やりたい事を実現する作業がプログラミングだと思います。 頑張ってください。
SELECT * FROM Table1 ORDER BY [日付]-Int([日付]); では如何でしょうか？
SQLサーバー7(NT)がドメインに参加していないと難しいです。 ・SQL7のログイン ・SQL2000のログイン ・ドメインのログイン の権限を持つタスクからでないと統制できないので。 どうしても今の状態で行うとなるとミドルソフトを入れて （たとえばMS-ACCESSなど）両方のテーブルにリンクを貼り、 そこでコピーを行う、などがよいと思います。 量的に大したことが無ければバッチの柔軟性があがって 管理しやすいかも。
今回のやつは、 固定値をAとして、インラインテーブルを作るといういみなので、 そこにテーブルBの列を書いたらエラーになりますね。 なら、 select A.*,B.COLC COLC, B.COLD COLD, =======>>★ from ( select 'AAA' COLA, 'BBB' COLB ) A left join TABLEB B on B.コード・・・・ では？ 「どのテーブルとどのテーブルを外部結合したいか」 をイメージするといいかと思います。
<Table1> ID___年月日１____年月日2 1____20070707___2007/07/07 2____20070707___2007/08/08 SELECT convert(smalldatetime,年月日1) AS 年月日整形1 from Table1; --|年月日整形1 --|------------| __1|2007/07/07 | __2|2007/07/07 | SELECT * from Table1 WHERE convert(smalldatetime,年月日1)=年月日2; --|ID|年月日１|年月日2___| --|----------------------- -1|_1|20070707|2007/07/07| こういう手法も・・・。
対象DBのプロパティで設定できたような記憶があります。 全然別な対処法ではあるのですが、削除ファイル復元ツールで削除してしまったファイルを探してみては？
データベースのみ移動した場合には、ログインユーザとデータベースユーザが異なります。 detachでデータベースファイルをCOPYし、新環境でCOPYしたデータベースファイルをattatchすることでデータベースが登録できますが、ログインユーザを作成していなければ、データベースユーザのみ設定された状態になります ログイン名の情報はmasterデータベースのsysxloginsシステムテーブル で管理されます。 一方、データベースユーサは、個別データベースの中の、sysusers　システムテーブルで管理されます。 以下にデータベース移動時のログインユーザとデータベースユーザが不一致となった場合の確認方法と解決方法が明記されています。 http://www.horikawa.ne.jp/cgi-bin/showlog.cgi?kd …
静的SQLは、SQLを含むアプリケーション等のコンパイル時に、SQL文を予め前処理（アクセス計画等の作成）しておき、実行時に前処理するオーバヘッドをなくす方法です。 動的SQLは、アプリケーション実行時に、文字列でSQL文を組み立てて前処理後、実行する方法です。 ストアドプロシジャ等は、RDBMSにより前処理済の場合と、前処理未実施の場合があります。 静的SQLでは、事前にアクセス計画が決まっているので、SQLの実行を早く行なえます。その反面、表名や検索条件で使用する列名などを変更はできません。 一方、動的SQLでは、実行時に操作対象の表や列名、条件式等を自由に変えられますが、実行時に前処理するオーバーヘッドがかかります。 参考URL：http://ja.wikipedia.org/wiki/SQL
クエリアナライザの実行計画は確認しました？ その関数の中で使われてるSQLを段毒で実行するとどうです？ ＞のマスタ系テーブルの列データとコンペア そこでテーブルスキャンが発生しているとすごいことになりますよね。
文字列ですから、考え方としては日付の１文字目から１２文字を抽出して、その文字列に対してグループをかければできるかと。 　SQLサーバーは、私は使ってないので、実験ができないのですが、次のような感じでしょうか。 SELECT min(日付) FROM table_name GROUP BY substring(日付, 1, 12) ORDER BY min(日付) （ORDER BY句は、付録です（笑））
残念ながら、SQL Serverには、ストアドに限らず、テーブルについても 更新履歴は持っておりません。 ただ、作成日と最終更新日付は持っています。 （下記のSQLを叩くとわかります） use [対象のDB名] go select 　[name], 　[create_date], 　[modify_date] from sys.objects where type_desc = 'SQL_STORED_PROCEDURE' どうしても更新履歴を管理されたい場合は、 ストアドのソース（*.sql) をVSSなどのソース管理ソフトウェアで 管理するしか方法がありません。 私も以前、いろいろと探したことがあったんですが、 めぼしいものはありませんでした。 ご参考になれば幸いです。
＞手元のPC環境では「テーブル」という項目がありませんでしたが、 サーバ名 -> システムデータベース -> msdb で試したからでしょうか。 そうですね。どうも、利用者側が作成したテーブルしか表示しない みたいなので、msdbだと、システム系のテーブルしかないと 思いますので、表示されなかったんだと思います。 ご確認下さい。
master DBにある「dbo.xp_servicecontrol」というストアドで チェックできます。 実行例： exec master.dbo.xp_servicecontrol 'QUERYSTATE', 'SQLServerAgent' 結果： Current Service State -------------------------- Running. 参考URL：http://www.siccolo.com/how-to-create-sql-mobile- …
なお、GUIベースで実行できない場合は、 SQLで実行することもできます。 -- ログインユーザを作成する EXEC master.dbo.sp_addlogin @loginame = N'ログインID', @passwd = N'パスワード', @defdb = N'該当DB名' GO EXEC dbo.sp_grantdbaccess @loginame = N'ログインID', @name_in_db = N'ログインID' GO EXEC sp_addrolemember N'db_datareader', N'ログインID' GO EXEC sp_addrolemember N'db_denydatawriter', N'ログインID' 先ほども申し上げた通り、ここで書き込み禁止に設定したのは、 あくまでもSQLで登録・更新・削除を実行した場合のものであり、 ストアドから登録・更新・削除を行うようになっている場合は、 ストアドの実行権限で制御しなければなりません。 DENY EXECUTE ON 書き込み処理が書かれているストアド TO [ログインID] もし、質問の趣旨が違っていたら、ごめんなさい
selectの選択リストには、列名や式以外に、文字や数値の定数を指定できます。 INSERT INTO テーブルB ( A, B, C, D ) SELECT テーブルA.A, テーブルA.A, '東京','品川' FROM ～ ※テーブルBの列A,Bの両方に、テーブルAの列Aの値を入れるのですか？
質問者様がお知りになりたい事（解決したい事）が、Diskの空き容量確保という事であれば、多分ログ切捨及び圧縮が唯一の手段だと考えられますが・・・
下記は、SQL Server 2000の話でしたが、 SQL Server 2005の場合は、〔AWEを使用してメモリを割り当てる〕 というサーバオプションがあるので、それを有効にすると 増加を抑えられます。 参考URL：http://www.atmarkit.co.jp/fdb/rensai/drk02/drk02 …
> 項目1・項目2・項目3には、それぞれ6桁固定の数字が入っているとします。 > select count(distinct 項目1+項目2+項目3) from テーブル名 その仕様であれば問題ないとは思いますが、 応用が利かない（固定じゃなかったらNG）のでお勧めできません。 select count(*) from (select distinct 項目1,項目2,項目3 from テーブル名) の書き方の方が無難だと思います。
こんにちは。 以下のように分割して削除する方法如何でしょうか。 SET ROWCOUNT 500000 '←削除対象件数中、500000レコード対象で、打ち切る。 DELETE FROM テーブル　WHERE COL2=条件 SET ROWCOUNT 0
SQL Serverメールがある環境が今手元にないので、 正式には確認できないのですが、 「SET ANSI_DEFAULTS ON」を使ってみるというのは如何でしょうか？ -- SJISにする SET ANSI_DEFAULTS ON -- メール送信実行 exec dbo.sp_send_dbmail ...... -- 元に戻す SET ANSI_DEFAULTS OFF 間違っていたらすいません。 参考URL：http://technet.microsoft.com/ja-jp/library/ms188 …
> ちなみにフィールド名（列名？）も一緒に出力することは可能でしょうか。 Sub aaa() Const connstr = "Provider=sqloledb;" & _ "Data Source=サーバー名;Initial Catalog=データベース名;User Id=ユーザー名;Password=パスワード; " Dim conn As New ADODB.Connection Dim rs As New ADODB.Recordset Dim strSQL As String 'コピペして下さい strSQL = "SSMSE（SQLServerManagementStudioExpress）を使用して作成したクエリ" conn.Open connstr rs.Open strSQL, conn If rs.EOF = False Then 'フィールド名を取得 Dim i As Integer For i = 0 To rs.Fields.Count - 1 Cells(1, i + 1) = rs.Fields(i).Name Next i Range("A2").CopyFromRecordset rs End if rs.Close conn.Close Set rs = Nothing Set conn = Nothing End Sub 後は、SQL文を自動編集したり、 ツール　－　マクロ　－　マクロ　－　オプションで ショートカットを作ると使い勝手が良くなると思います。 また、ワークシートにボタンや画像を配置しそれをクリックすると データ抽出なんかもできます。
補足。 NULL 値の比較（MSDN）より（参考リンク） ------ SET ANSI_NULLS をオンにすると、比較する式のどれかが NULL の場合、TRUE または FALSE は生成されず、UNKNOWN が返されます。認識できない値はそれ以外の値と論理的に比較できないためです。 ------ 参考URL：http://msdn.microsoft.com/library/ja/default.asp …
表の列構成、元のデータ例、得たい結果例が示されていると、回答する側としても分かりやすいのですけどね。 次のようなSQLでは、いかがでしょうか？ select 学年, count(case when 性別='m' and 評価='A' then 1 else null end) as 男A, count(case when 性別='m' and 評価='B' then 1 else null end) as 男B, count(case when 性別='m' and 評価='C' then 1 else null end) as 男C, count(case when 性別='w' and 評価='A' then 1 else null end) as 女A, count(case when 性別='w' and 評価='B' then 1 else null end) as 女B, count(case when 性別='w' and 評価='C' then 1 else null end) as 女C from t1 group by 学年 ;
複数のカラムを主キーにすることは可能です。 (1)SQLを走らせる。(ALTER TABLE tablename ADD PRIMARY KEY　～) (2)Management Studioを利用しているなら、 　・テーブル名右クリック→変更　でカラムの一覧を出す。 　・主キーにしたいカラムをクリックして選択(複数ある場合はCtrl押しながら選択) 　・選択したカラムの上で右クリックして主キーの設定を選択 上記のいずれかでできると思います。
ゴミレスになるかもしれませんが、少々補足を... 圧縮は、即時には反映されません。 どの程度待てば反映されるのかは、私も良く知りませんが、しばらくの後に(最高でも一日)確認してください。 なお、トランザクションログをバックアップして、バックアップしたファイルのサイズがかわらなければ、圧縮してもかわりません。 （バックアップして、バックアップしたサイズが小さくなれば、 圧縮して小さくなる可能性があると思います。）
ご自身が調べたとおり、開発者がテスト用に使います。 Enterprise Edition なんて高いものを買わなくても DB アプリが開発 & テストができるように、です。 その代り、本番運用で使ってはいけません。あくまでもテスト用です。
DB未経験ですので見当違いだったらごめんなさい。 SQL Server2005 SP1　KB913090のようですが SQL Server2005 SP2では駄目なのでしょうか？ http://technet.microsoft.com/en-us/sqlserver/bb4 … というのも、 もし、Hotfix自体がIntegration Servicesを起動しようとするなら， http://support.microsoft.com/kb/918644 に引っかかっている気がするからです。 これはイベントビューアに症状が残るそうです(この修正はSP2に含まれる) http://connect.microsoft.com/SQLServer/feedback/ … こっちは読んでませんが。
http://oshiete1.goo.ne.jp/qa3125405.html http://oshiete1.goo.ne.jp/qa3125520.html I think that people here cannot get what you mean by the question, and they passed by,I mean, does not answer these questions. I think it is better for you to tell us details in your native language. (there are many people here who can read/write foreign languages,so feel free to do so.) a sample site in your language would be nice. e.g "Japanse QA site Like Yahoo! Answers in English" you can add an additional reply comment for each post by clicking link below. Anyway,I,as a native Japanese,often use @IT to study technologies that I'm new to. http://www.atmarkit.co.jp/
単純に考えると、そのフォルダが「圧縮フォルダ」になってるんじゃないかと思うのですが…。 あと、どうやって其のデータベースを作成されているのかがわからないと （手順、オプション、スクリプト使ってるならそのないよう） 答えは難しいのでは？
こんにちは。 これかな～。間違ったらごめんなさいね。 $sql = "insert into table_name(date) values($day)"; 　↓ $sql = "insert into table_name(date) values('$day')";
SELECT ID, COUNT(ID) FROM テーブル GROUP BY 日付 日本語は下手ですから 特に説明がなかった
'D:\sqlserver\MASTER.bak'に対する適切なアクセス権が設定されていないだけだと思います。ご確認下さい。
１日の日付はcastoffさんのやり方で取得できます。 Cast(LEFT('20070621',1,6) + '01' as DateTime) 翌月の１日は上記をDateAdd関数で１月進めることで取得できます。 DateAdd(m,1,Cast(LEFT('20070621',1,6) + '01' as DateTime)) where句には day >= 当月の１日 and day < 翌月の１日 と記述すると当月分が指定できます。
＞（条件）N-aに値有りのとき、N-bは値有り ＞　ただし、1-aから5-a全て値なしのときは対象外 と ＞not( ＞(1-a is not null AND 1-b is null) or ＞(2-a is not null AND 2-b is null) or ＞(3-a is not null AND 3-b is null) or ＞(4-a is not null AND 4-b is null) or ＞(5-a is not null AND 5-b is null) or ＞(1-a is null AND 2-a is null AND 3-a is null AND 4-a is null AND 5-a is null) ＞) の２つが、同じ意味とは思えないんですが・・ （説明と違う条件式になっていると思いますよ） ＃１で書いたのは・・ ＞N-aに値有りのとき、N-bは値有り ＞ただし、1-aから5-a全て値なしのときは対象外 ”N-aが値有り”の場合しか対象としないのだから、”1-aが値なし”の場合というような但し書き条件など無意味であるという話です。 最初の質問にあるSQL文は説明に合致しているとは思いますが、説明の書かれた条件そのものに無駄があると思いますよ。
こんにちは。 こんな感じで、如何でしょうか。 select T1.ti , avg(T1.va) from ( select date as ti, value as va from test_table union all select date as ti, value as va from test1_table ) T1 group by T1.ti
回答にはなっていないのですが、 ANo.2を回答されている内容に一部補足します。 奉行はスタンドアロン版とLANPACK版・新ERP版がありまして スタンドアロン版は、MSDE(現在の最新版ではSQL2005Express Edition)を使っています。 LANPACK版・新ERP版はSQL(現在の最新版はSQL2005)を使っています。 同居については、できるかできないかは私にはわかりませんが、 異なるデータベースを一緒にするのは、リスクが高いと思います。 データベースが複数あると、サーバに負荷がかかるために まず動作不安定（動作が重い、最悪の場合サーバダウン）というのが考えられます。 また、最初は順調に稼動したとして、その後にサーバダウンが発生した場合、どちらに原因があるかの追求が困難ですのし、それを復旧しても、またいつか、ダウンする可能性も考えられられます。 そう考えると、やはりサーバを分けるのが無難だと思います。 あと構成（利用ライセンス数）がわからないのですが、 単純にオービック7と奉行を比較した場合、オービック7の方が上位なソフトだと思うので、 今使っているサーバが高性能であれば、今使っているサーバをオービック7を入れて、現在の奉行は、安いサーバを購入して、そっちに移行してやるという方法も、どうでしょうか？（移行という作業が面倒かもしれませんが・・・）
例えば テーブル名:TABLE_AAA、項目名:COL1 をINT型にしたい場合は ALTER TABLE TABLE_AAA ALTER COLUMN COL1 INT でできます。
やはり参照設定が怪しいとしか・・・・ あるいは単純にwithの書き方とか・・・ 私の環境下では以下のコードは問題ありませんでした。 すでにMSDEにテーブルは移行されていて そのリンクを都度張りなおすってことですよね。 リンクしたまま配布してはダメなんですか？
SQLの動的実行にする必要があります。 (1)SQLを文字列として組み立てる変数を宣言 (2)SQLを文字列として組み立て (3)(2)をexecuteで実行 以下のような感じです。 declare @sqlstmt varchar(500) set @sqlstmt = 'UPDATE dbo.共栄会旅行貯金 SET ' + @Mfld + '=' + @Msitei + ',' + @KOUfld + '= 給与.旅行 FROM dbo.給与 INNER JOIN dbo.共栄会旅行貯金 ' + 'ON dbo.給与.SNAM = dbo.共栄会旅行貯金.SNAM' execute (@sqlstmt)
＃１です。 質問者様は、VB6やAccessVBAなどの知識がおありなのでしょうね。 であれば、是非ともまずはVB.NETを覚えられてはよいかと思います。 VB.NETはVB6開発者にとって、他のOOP(オブジェクト指向プログラミング)へのとても近道な言語だと思っています。 VB.NETさえ覚えてしまえば、C#やJavaへのステップアップがとても楽になるはずです。 >Accessで使われるVBAも.NETに変わると思います。 そうですね、いずれ今のVB6に近いVBAがなくなるかもしれませんね。 既にAccessでもExcelでも.NETを利用したVSTOという開発方法が存在していますし。 http://www.microsoft.com/japan/msdn/office/acces …
無料で使えるRDBMSに関してだけ、少しコメントします。 Oracleの無料版は、Oracle 10g Expressです。ただし、英語版しかなかったと思います。 DB2 UDBにも、無料で使えるExpress Editionがあります。 PostgreSQLは、8.0からWindowsにネイティブで対応しています。 無料で使えるRDBMSでは、MySQLも人気が高いです。
SQL Serverのこの辺の機能については、あまり詳しくないのですが。。。 >マニュアルもなく、Web検索しても オンラインマニュアルがあります。 http://msdn.microsoft.com/library/ja/default.asp … 質問者さんの細かな要件に合致しているかは不詳ですが、csv出力はbcpユティリティで行なえるようです。 http://homepage1.nifty.com/kojama/works/rdbms/ms …
SQLServer2000。。。ですが。。。 「ジョブステップの編集」で、種類～を「オペレーティングシステムコマンド(CmdExec)」にする。とか。
データが消えたわけではないので、作り直せばいいのでは？
投稿した内容を見て、他人が理解できる内容か、確認していますか？ 例） テーブルA テーブルB キー 値 キー 値 1001 1 1101 1 1002 2 1012 2 1003 3 1003 3 1004 4 1104 4 1202 5 1303 6 得たい結果から見ると、次の2行は、テーブルBの値ではないのですか？ 1202 5 1303 6 質問者さんが考えたSQLで、 SUBSTRING(A.キー, 1, 1) は、質問内容の説明にないことをやっていますが？ >時間が非常にかかってしまうので 多くのRDBMSでは、インデクスを付けた列でも、関数などで演算してしまうとインデクスを有効利用できません。SQL Serverでは、プライマリキーを優先して使うようですが、この表でのインデクス定義内容が分かりません。 >よい方法を知りたく思っています キーの2番目の文字を取り除いた値を、双方の表の列に持ち、インデクスを定義しておく方法がいいと思いますけど？
>exec 01,abc 文字データなのに、「'」で囲まないで与えているのですか？ tbl1のPC列、Filename列のデータ型は、どう定義していますか？
古いSQLserverでも・・ SELECT A1.番号,A1.処理通番 FROM A as A1,A as A2 WHERE A1.番号 IN (SELECT 番号 FROM A GROUP BY 番号 HAVING COUNT(*) > 1) and A1.番号=A2.番号 and A1.処理番号>A2.処理番号 group by A1.番号,A1.処理通番 having count(*) < 4 な感じで書けるんじゃないかな。 分析関数を使う方が処理が速いので、2005を使っているなら、A1に書かれているSQL文が良いと思いますけどね。
三層スキーマという言葉が登場し、構造型DB（CODASYLが規定した階層／ネットワーク型DBの標準規格）が実用化されたときは、それぞれが独立した定義で分かりやすかったのですが、リレーショナルDBではRDBMSにより定義方法が様々だったり、多用な操作ができるので区別がしにくいところもあります。 (1)概念スキーマ 　表の列構成、キー、表と表の関連など。 (2)外部スキーマ 　表の特定列、ビューなど、利用者側からみた論理的な行の構成。 (3)内部スキーマ 　データベースのスペースの割り当て、表やインデクスの格納方法など。
#2です。 すみません、下のSQLだとエラー出ますね。 SELECT CASE WHEN カラム IS NULL THEN 'NULLだったよ' ELSE CAST(カラム AS VARCHAR) END FROM テーブル ならエラーにならないかな。 お試しください。
#2さんの回答にあるように、再帰的に検索したいのでしょうか？ 使用するRDBMSは、ここのカテゴリ通り、SQL Serverなのでしょうか？ SQL Server 2005からなら、WITH文が使えるようになっており、再帰的な検索が可能になっています。 参考URL：http://www.microsoft.com/japan/msdn/sqlserver/dn …
>as 一箇月前の表示をしないようにするためには >どうしたらいいか 「名前」列と「日付」列だけ表示したいということでしょうか？ もしそうなら、、、以下のように変更してください。 ＜SQL例＞ select 名前,日付 from tbl出席簿 where substring(convert(varchar(10),日付,101),7,4) +'/' +substring(convert(varchar(10),日付,101),1,5) =substring(convert(varchar(10),dateadd(month,-1,getdate()),101),7,4) +'/' +substring(convert(varchar(10),dateadd(month,-1,getdate()),101),1,5) ＜簡単な説明＞ (1)convert(varchar(10),日付,101) →101は、日付データの書式を示し、mm/dd/yyyyの形式で返すように指定しています。 (2)substringでは、(1)のmm/dd/yyyyの形式から、yyyyを前に持って行き、'/'と(1)の残りのmm/ddを文字連結した結果を返すように指定しています。 参考URL：http://msdn2.microsoft.com/ja-jp/library/ms18792 …
WindowsNT、Windows2000、WindowsXP系統だと 65535件まで登録できた記憶があります 逆にWindows95,98,98SE系統はその半分以下（詳細の数はわすれましたが コンピュータらしい数値です） なものなので、ＳＱＬ側でちゃんと件数分データをはいているのか コンボボックスにちゃんと加えているのかを確認してみてください また、Windows98系のシステムが混在して運用する場合は 上記の制限が発生するので注意してください
おそらく"強力なパスワード"の条件を満たしていないから 参考URL：http://msdn2.microsoft.com/ja-jp/library/ms14370 …
windowsの標準機能ですが、コマンドラインからサービスの起動と停止が可能です。 (XXXXXサービスの起動) NET START XXXXX (XXXXXサービスの停止) NET STOP XXXXX サービス名を指定して起動と停止が可能です。（スペースを含むサービス名の場合は、ダブルコーティションで囲む）
SQL Server 2005 Compact Edition を使えばどうでしょうか
select D.URD_HIN_CD, D.URD_HIN_MEI,sum(D.URD_BARA_SU) as URD_BARA_SU WHERE H.URH_TKI_CD = 9999 AND H.URH_DENNO = D.URD_DENNO AND H.URH_KEJ_YMD between 20050601 AND 20050630 GROUP BY H.URH_TKI_CD,D.URD_HIN_CD, D.URD_HIN_MEI な感じ。 何が判らないのか書かれていないので、説明のしようがない。
CONVERT関数を使うとできます。 たとえば。 現在日時が 2007/05/22 17:48:10 だとします。 GETDATE()でその現在日時がDateTime型でとれます。 これをCONVERT関数を通して日付部分だけをnVarChar型に変換します。 CONVERT(NVARCHAR, GETDATE(), 111) 最後の「111」がフォーマットの指定で、「yyyy/MM/dd」形式で日付だけを持ってくる指定になります。 詳しくは参考URLのCONVERTの引数styleをご覧ください。 参考URL：http://msdn2.microsoft.com/ja-jp/library/ms18792 …
お使いのバージョンが判りませんが、附属のコマンドラインツールでSQL文を流し込めば良いかと思いますけど。 （お使いのバージョンにより、コマンドラインツールが変わります）
ここはSQL Serverのカテゴリなので、DB2の質問をするなら、「その他（データベース）」が適切ではないでしょうか？ DB2の文字連結は、「文字 CONCAT 文字」で行なうようです。 「文字||文字」でも可能ですが、マニュアルによるとIBMの他のRDBMSとの互換上の問題があるので、CONCATの使用を推奨しています。 SQL例としては、下記のようになるようです。 UPDATE T1 SET C1=C2 CONCAT '-' CONCAT C3
#1回答者です。 #2回答者さんの回答を見て、私もaccessの仕様に驚きました。階層DB的な発想ですね。 ところでSQL Serverのバージョンは、何でしょうか？ #2回答者さんの使用している「select ～ from (select ～ from ～ ) as 別名」は、インラインビューというもので、SQL Server 2000では未サポートです。 http://www.microsoft.com/japan/sql/prodinfo/comp … もし、SQL Server 2005なら、#2さんのSQLに加え、以下のような分析関数という機能を使うことでも実現可能です。 select フィールド1,フィールド2,F.フィールド3 from (select rank() over(partition by フィールド3 order by id) as F_row, フィールド1,フィールド3 from FFテーブル) as F, (select rank() over(partition by フィールド3 order by id desc) as L_row, フィールド2,フィールド3 from FFテーブル) as L where F.フィールド3=L.フィールド3 and F_row=L_row and F_row=1;
私も同じような内容で困っています。 ですが、私の場合ＵＳＢ接続ではなく内蔵ＤＡＴなので、今のところ対処方法は見つかっていません。 ＵＳＢ接続の場合、Microsoftのサイトに解決方法が掲載されていました。テープデバイスを追加するストアドのようです。 試してみてください。 参考URL：http://msdn.microsoft.com/library/ja/default.asp …
ボトルネックになっている処理を探して、 実行計画を分析して、インデックスなどを検討するとか。
select 名前,count(*) from test as A where A.日付 <= (select min(B.日付) from test as B where B.名前 = A.名前 and B.合否= '合格') group by 名前; な感じ？ SQLServerの環境が無いので、動作確認していません。
バックアップ元と復元先で照合順序が違うようです。 DBの設定を確認してみては。 http://www.microsoft.com/japan/msdn/sqlserver/sq … 参考URL：http://www.microsoft.com/japan/msdn/sqlserver/sq …
普通はテーブルロックはかからないし、 ロックは不要です。 自動的に変更された行に対してロックがかかるので、 通常はそれで十分なはずです。
サーバ側でファイアウォールが動いているってことはありませんか？
cast(isnull(TRIM(文字列フィールド),0) as INT) as 変換後データ でできます。 　SQL SERVER 2005 Books Online またはマイクロソフトのMSDN ・CAST および CONVERT (Transact-SQL) http://msdn.microsoft.com/library/ja/default.asp … を見てください。 ただわからないというのでは・・・・ 調べてみてエラーになるので　というのは○です。
＜Table1＞ ID___日付 1____2007/04/01 2____2007/04/02 3____2007/04/03 4____2007/05/03 5____2007/06/03 ＜抽出結果＞ _1|2007/04/01| _2|2007/04/02| _3|2007/04/03| ＜SQL文＞ SELECT * FROM Table1 Where convert(varchar, 日付, 111) 　　　　LIKE 　　　　datename(year,'2007/04/01') + '/' + datename(month,'2007/04/01') + '%'; こんな感じでもヒットします。
select sysobjects.name from dbo.syscolumns inner join dbo.sysobjects on sysobjects.id = syscolumns.id where syscolumns.xtype = '175' and syscolumns.name = 'name' あ～、xtypeの値(175)は違う取得の方法があるはず。
＞SQLServer2005からSQLServer7.0へ接続 具体的に言うと？ （DBが7.0でクライアントが2005？）
普通のアプリと同様に、 「プログラムの追加と削除」から消して、CDからインストールすればいいはずですが…。
insertの構文は、大きく分けて二つあります。 (1)insert into 表名[(列名,列名,...)] values(値,値,...) (2)insert into 表名[(列名,列名,...)] select文 (2)のselect文を指定する方法では、他表（RDBMSによっては自表も）からデータを検索して、その結果を格納できます。select文の選択リストには、定数も指定できます。 【SQL例】 INSERT INTO TmpA (a,b) select 1,b FROM TmpB
この場合は、LDFファイル自体をファイルコピーで退避すればよかった記憶が…MSにそのあたりの手順（復元まで）を示したものがあるようなきはするのですが…よく覚えてません。
Insert　ではなく　バルクコピー Select Into 　で　#TempFile テンポラリーファイルに必要な データを出力し、その後Select Union文でマージする。 方法ではいかがでしょうか？ Select Into でテンポラリーファイルに出力する際にCLR関数を使って 抽出すればいいのでは・・・
匿名アクセス（IUSR_コンピュータ名）をSQLServer上のデータベースのユーザーとして登録すればＯＫだと思います。
ARCserveなどの、バックアップソフトは使わないのでしょうか。
以下のサイトをごらんください。 MSDNフォーラム http://forums.microsoft.com/msdn-ja/ShowPost.asp … 以上
確実に実行されているとは、どのように確認しましたか。 ManagementStudioでテーブルを開いて見たのでしょうか。 WHEREの条件を満たすデータがないのでは、ないですか？
的外れな回答だったらごめんなさい。 Table_1とTable_2の同じSeqNoのupdatetimeを一度に変更したいわけですよね？ @SQLNo int AS BEGIN UPDATE Table_1 SET updatetime = GETDATE() WHERE (Table_1.SeqNo = @SQLNo) UPDATE Table_2 SET updatetime = GETDATE() WHERE (Table_2.SeqNo = @SQLNo) END こんな感じのストアドプロシージャを作成して実行してみてはどうでしょう。 また、トリガーの作成をしても良いのではないでしょうか。
こんな感じかな。 if a > b 　　begin 　　　　if b > c 　　　　　　begin 　　　　　　　　if c > d 　　　　　　　　　　begin 　　　　　　　　　　　　set @ABC=1 　　　　　　　　　　end 　　　　　　　　else 　　　　　　　　　　begin 　　　　　　　　　　　　set @ABC=2 　　　　　　　　　　end 　　　　　　end 　　　　else 　　　　　　begin 　　　　　　　　set @ABC=3 　　　　　　end 　　end else 　　begin 　　　　set @ABC=4 　　end
ネットワーク連携が前提になりますが、レプリケーションは検討されましたか？ <http://itpro.nikkeibp.co.jp/article/COLUMN/20060 … <http://msdn2.microsoft.com/ja-jp/library/ms15119 … <http://www.microsoft.com/japan/technet/prodtechn …
SQL文に関する質問なのでしょうか？ ならば、 SELECT ROUND(値,-3)/1000 FROM Table1; 実行結果 __1|______12| __2|______12| __3|______13|
print 1/60 print cast(1 as real)/60 のちがいかと。 「暗黙の変換」でBOOKSONLINEを検索するとそのあたり出てくるかと思います。
insertのなかでselect文を使用すればよいと思います 下記URLの「INSERTとSELECTの組み合わせ」を参照してみてください 参考URL：http://www.atmarkit.co.jp/fnetwork/rensai/sql12/ …
A.ありません。 項目長を短くする事によってデータが破損する可能性があるからです。 一度、テーブルを他にコピーして項目長を削除してから変更後に コピーしたデータをコピーしてしてください。
列[合格日]を[結果]と変更していますが・・・。 SELECT 名前, MIN(日付) AS 初合格日 FROM 試験履歴 WHERE 結果=1 GROUP BY 名前; 花子, 2007/04/06 太郎, 2007/04/01 SELECT A.* FROM 試験履歴 AS A, (SELECT 名前, MIN(日付) AS 初合格日 FROM 試験履歴 WHERE 結果=1 GROUP BY 名前) AS B WHERE A.名前=B.名前 AND A.日付=B.初合格日 ORDER BY A.ID; 1, 太郎, 2007/04/01, _80, Yes 6, 花子, 2007/04/06, 100, Yes いずれにしろ、同姓同名問題は残ります。 受験者の一意に特定する列が無いので仕方ないかと思います。
（１）について 基本的に.NET Frameworkは各バージョンを同時にインストールすることができ、それぞれのファイルは上書きされないので、既存のアプリケーションに影響がでることはありません。 （２）について 自分が.NET Framework2.0をインストールしたときに再起動を要求された記憶がないです。
No1. 2個目の Left Outer JOIN の箇所が誤りがありました。 以下のように訂正してください。 _________________________________________________ Select A.aaa , B.eee , C.fff FROM A_TBl As A Left Outer JOIN B_TBL as B ON B.aaa = A.aaa Left Outer JOIN B_TBL as C ON (C.bbb = 0 and C.aaa = A.aaa) Or (C.bbb <> 0 and C.aaa = A.ccc) where A.eee > 0 ____________________________________________ 以上
(1)カーソル名=TCURのカーソル宣言で、sysobjects表のname列を検索するselect文が記述されていますよね。 そのカーソルを利用したfetchで、name列の検索結果を、ローカル変数=@nameに取り込んでいます。 (2)「+」は文字連結ですが、分かりにくいですね。 「'」と「"」の使い方は正しいでしょうか？ 「"」なら、予約語とぶつかった場合でも、表名、列名で使用可能にするための指定です。 (3)whileループですから、ループに入る前と、ループの最後には、同じ実行文が入ります。 例えば、最初のfetchでは、1件もヒットしなかった場合にループに入らない判定になりますし、最後のfetchでは2件目以降でヒットしなかった場合にループを抜けることになります。
関数をどうしても作りたいのでしょうか？ この程度の操作なら、SQL Serverの基本的な機能で行えますが？ select 製品,在庫数,注文数, case when 在庫数>=注文数 then 'OK' else 'NG' end as 判定 from 伝票 >これをストアドプロシージャで実行すると、パラメータで指定したHANTEI がテーブルにないのでエラーになります。 >テーブルに判定に相当する項目を用意すると正しく結果が出ます どうしても関数にしたいなら、どのように関数を呼んでいるか、その辺のソースコードを貼り付けて見せてもらえませんか？
たぶん日本時間から９時間ずれた時間とは・・・ちょうど世界協定時間（グリニッチ時間）に成っているじゃないのどっかの設定が・・・
以前(6.0の頃)と違い、今は書店に行くと、易しいのから、プロ向けのモノまで書籍がそろっています。 又、ヘルプも以前にくらべれば、ずいぶんとマシなものとなってます。 ネット情報にいたっては、比べられないほど沢山あります。(PASSJもあります） 今仕事で、SQLServer使っている方は、うらやましいかぎりです・・・
もしかして 以下のＵＲＬが参考になるのでは http://forums.microsoft.com/msdn-ja/ShowPost.asp … あと、SQL SERVER 2005 Books Online マイクロソフトのホームページを検索してみてください。
ＳＱｌ SERVER　は　ACCESS のMDB　と違い、クエリの中に関数を埋め込むことはできないというかやりか方がまったく違います。 従来の　標準モジュールとまったく同じとは行きません。 Sql SERVER 2005 は　Express版ですか？ それとも　Standard もしくは　Developper ですか？ もし、ライセンスを持っていて　Express版以外なら SQL Server Management Studio からエクスプローラ風に簡単にＤＢ の操作できるようになっています。 ツリーの中のプログラミングに「関数」があるはずです。 ここにユーザー関数を記述します。 いずれにせよ　SQL文とストアド、関数の作成方法の知識が必要になります。 検索サイト(Google)で→　Create Function Sql server 2005 を検索してください。 マイクロソフト　のサイト http://www.microsoft.com/japan/msdn/sqlserver/se … などを参考にしてください。 もし　SQL　CLR　を用いるのであれば　VB.NET　でも開発できるようですが　そこまでしなくてもたいていは　SQL　で作成した関数で間に合うのではないかと思います。 もしくは関数にしなくてもストアド内で完結してしまうかです。 提示している　関数の仕様、つまりやりたいことを教えてください。 アドバイスできると思います。 あと、誰かすでに作成しているフリーの関数のリソースなどを用いることも可能です。
#2、#5回答者です。 SQL Serverのバージョンは、何でしょうか？ #2、#5で提示したSQL中の 「select ～ from(select ～ from ～)」 という記述は、標準SQLでも規定され、多くのRDBMSでもインラインビューといった機能名で実装されていますが、SQL Serverでは2005で実装されたらしいことが分かりました。 そのため、やってること（＝質問者さんがやりたいことを推測したもの）の確認とSQL Server 2000でも実行可能なSQLを改めて提示します。 SQL Server 2005では、前回提示のSQLで、そのまま動くと思います。 １．提示された条件→こちらでの解釈 (1)表Aには、ID列とTEXT列がある。 (2)表Bには、ID列がある。 (3)表Aに表Bの全行を追加。この時、TEXT列には、表AのID=1の行のTEXT列の値を格納。 →表AのID=1で行を絞り込めるとのことから、列IDはユニークと推測しています。 ２．やりたいことの推測 表A ID TEXT 1 a 2 b 3 c 表B ID 4 5 6 得たい結果(表A) ID TEXT 1 a 2 b 3 c 4 a 5 a 6 a ３．SQL例 　※列TEXTはTXTと変えています。 (1)SQL Server 2000でのSQL例 insert into A select B.ID,A.TXT from A,B where A.ID=1; (2)SQL Server 2005でのSQL例 (1)または、以下のような記述も可能 insert into A select id,txt from (select txt from A where id=1) as x,B
もう少し、簡潔に書けます。 A LIKE '2___[0123456789]' A LIKE '2___[0-9]' % 0個以上の文字に対応します。 _ 任意の１文字に対応します。 [...] 各カッコ内に指定した文字に対応します。 [＾...] 各カッコ内に指定した文字以外に対応します。
>Field1をサマライズしてカウントと名称を取得するクエリー >Select Count(TableA.Field1) as RecCount, TableA.Field1 From TableA 「group by Field1」の指定が必要です。 >Field1をサマライズしてカウントと名称を取得するクエリー >Select Count(TableB.Field1) as RecCount, TableB.Field1 From TableB 「group by Field1」の指定が必要です。 >希望する結果 表名、列名は、簡単化していますが、下記のようなSQLになります。 select Acnt,Bcnt,x.f1 from (select count(*) as Acnt,f1 from A group by f1) as x left join (select count(*) as Bcnt,f1 from B group by f1) as y on x.f1=y.f1
MSSQL2000とは、 SQLServer2000のことですか 確か、SQLServer2000はサーバーＯＳでしか動かなかったと思います。 SQLServer2000互換のMSDEはWindowsVistaでも動くのでは、 SQL Server 2005 Express Editionでしたら動くと思いますが 無料ですし、
こんな感じで sub test() const connstr = "Provider=SQLOLEDB;Data Source=(local);" & _ "Initial Catalog=sekisan;Integrated Security=SSPI;" Dim conn As New ADODB.Connection Dim rs As New ADODB.Recordset Dim ret As Boolean conn.Open connstr, ユーザーＩＤ,パスワード rs.Open "Select * From テーブル名 Where 抽出条件 ", conn Range("A1").CopyFromRecordset rs rs.Close conn.Close Set rs = Nothing Set conn = Nothing End sub >SQLSERVERの既存のデータに書き出すことって SQL文作ってゴリゴリまわす方法 レコードセットを作製し 新規のとき rs.addnew rs.update とする方法があります
そういやあ，UAC無効にしたり，SQL Server SP2当てた時に http://support.microsoft.com/kb/929907/ja チェック入れた？和訳解りにくいが，てっきりSP2当てるだけで良いと思ってたんでスルーしてたけど。 入れなかった時の対処って上のより↓の方がわかりやすい http://itpro.nikkeibp.co.jp/article/COLUMN/20061 … ただし、上のリンクはBeta用のManagement Studioを紹介しているので http://www.microsoft.com/downloads/details.aspx? … か http://www.microsoft.com/downloads/details.aspx? … のどちらかの方が適切だろう インストール後にSQL Server Management Studioを管理者として実行(しなくても権限を聞かれるらしいが) そのまま接続して・・・ITProに書かれているので略。 やってみたら？俺が的外れなら申し訳ないけど
SQL SEVER の　サンプル　ＤＢなどでテストしていませんか？ 「AdbentureWorks」など 「AdbentureWorks」では外国語の昇順に設定されていますので ????　に表示されてしまいます。 MSDNのフォーラム http://forums.microsoft.com/MSDN-JA/ShowPost.asp … 「SQL Server 2005 で文字化け」を参照してください。 デフォルトは　日本語設定では Nvarchar では　Unicode varchar では Shift-JIS だったと思います。 MSDN ライブラリ http://msdn2.microsoft.com/ja-jp/library/ms17608 … を参照してください。 以上
はじめまして。 例えば"-12"の場合は、頭に空白を5byte分入れるということで良いですか？ select right(space(8) + convert(varchar,c),8) from　xxtbl または select right(' ' + convert(varchar,c),8) from　xxtbl ※シングルクォーテーションの間は半角スペース８個分です。 　ここの掲示板に投稿するとスペース表示は詰められているようです。 で出来ると思います。
select Ｂキー from テーブルＢ left join テーブルＡ on テーブルＢ.Ａキー = テーブルＡ.Ａキー where テーブルＡ.Ａキー is null でできませんか？
0文字詰めなら、Right関数を使用する手があります。 Right('00000000' + C列 , 8) 8桁0詰め指定なら、最初に「0」を8桁分並べた文字と目的の列を結合します。 「'00000000' + C列」の部分です その文字列に対してRight関数を使用し、右から8文字を取ってきます。
> サブクエリを元データとして使用し・・・ この、クエリで使用したテーブルはどの様な設計になってますか？ そのテーブルが、顧客別に集計できる設計となっていれば、 元データとなるかもしれません。 が、この質問内容だけだと情報が少なすぎて、なんともいえません。 どうでしょう？
自信なしですが、 http://www.sqlpassj.org/bunkakai/security/series … この辺りの問題なのかしら？
あっ、間違い！ UPDATE A_TBL SET 数量 = 数量 - 10; UPDATE A_TBL SET 数量 = 0 WHERE 数量 < 0; １行で記述するなら UPDATE A_TBL SET 数量 = CASE WHEN 数量 < 0 THEN 0 ELSE 数量 - 10 END
SQLServer2005のバグのようです。 SQLServer2005 ServicePack1を当てることで、 直ります。操作方法も若干変わるようです。
>SQL文で書くことは可能でしょうか？ 具体的な結合方法が分からないのですが、可能ではないでしょうか？ >SELECT ((((cols FROM A INNER JOIN B ON --) INNER JOIN C ON --) > OUTER JOIN D ON --) INNER JOIN E ON --) >と単純に書くとネスト数のオーバーなのかエラーが出ます。 条件など、記述を丸ごと省略しないでください。これらは回答者が内容を判断する上での大切なヒントです。 単に「エラーが出る」ではなくて、どういうエラーなのか、内容を書いてください。 「SELECT ((((cols FROM A INNER JOIN B ～」の「cols」って、もしかして列名ですか？括弧の位置がおかしいですけど？ select ～ from ((A inner join B on ～ inner join C on ～) left join D on ～) inner join E on ～ といった形式になるのでは？
>accessの場合クエリおよびsqlのprgで作成したテーブルの連結リレーショナルで更新ができていた >sqlserverの場合はテーブルの連結した状態では更新できないのでしょうか accessの「連結リレーショナル」というのが、どのようなものか分かりませんが。。。 updateの一文で複数表の更新をしたり、「基の表をジョインしたビュー」を使っての更新といった意味なら、SQL Serverでは行えません。 参考URL：http://msdn2.microsoft.com/ja-jp/library/ms17752 …
過去にこんな例があります http://okwave.jp/qa1409350.html はずしたらスルーでお願いします。
見た感じですと２００５はＵｎｉｃｏｄｅでデータが入っているのではないでしょうか？ ＡＳＣＩＩ指定とかできないのでしょうか？
Enterprise Managerからでもできますよ。 (1)対象のストアドを複数選択した状態で、コピー（Ctrl＋C or 右クリックから） (2)メモ帳などに貼り付け 又は (1)対象のストアドを複数選択した状態で、右クリック(操作)⇒「全てのタスク」⇒「SQLスクリプト作成」 (2)全般タブの「プレビュー」 (3)「コピー」 (4)メモ帳などに貼り付け
MySQLがいまのところお勧めかな。
テーブル名：SPDS_PARTS_ATTR_TREATMENT 全フィールド抽出と仮定して、 SELECT * FROM SPDS_PARTS_ATTR_TREATMENT WHERE REV_NO = (SELECT MAX(REV_NO) FROM SPDS_PARTS_ATTR_TREATMENT) では駄目ですか？
Rinrin-chamiさん　こんにちは　danchorといいます。 ＮＯ２の方の回答の通りですが、ファイルがISOなのではないですか？ 私もダウンロードしてきて、ISO形式のファイルをいったんＣＤ２枚に焼いてインストールしました。（簡単でしたよ） ＣＤ－Ｒなどに焼くソフトが別途いりますが、最近はコンボドライブが多いのでついていることも多く、もしなければフリーソフトを捜しましょう。 でもハードが対応しているのがまず先ですが。
'\'+LTRIM(LEFT(CONVERT(nchar(50), CAST([金額] AS money), 1), 47)) こんなやり方しかないかなぁ～
No1です ＞一括で削除 いかんせんAccessがわからないのでTOMO0301さんがあともう一歩なのか どうなのか解りません。 お役に立てず申し分けございませんが excelだけで処理するのでしたら ”おしえて”の検索窓で”Excel　シート　比較”を打つと同様な事例 があります。 注意すべきところは vbaマクロで処理する内容と計算式によっての内容を読み間違えないことです。 そちらで質問されたほうがいいかもしれませんが他に参考になるサイトをあげときます。 参考URL：http://www.moug.net/
WAITFORでは駄目ですか？ 詳しくはBooksOnlineをご参考に。
こんな感じでどうでしょう。 select convert(char(19),startTime,120) as startTime from t1 where convert(char(19),startTime,120)='2007-03-01 17:30:20'
消してしまっても、復元すると元通りになったような気がしますが。 もっと特殊な状況なのかしら。
Case文を使って Select Sum(case When A=0 then 1 else 0 end +case When B=0 then 1 else 0 end +case When C=0 then 1 else 0 end ) as total, Sum(case When A=0 then 1 else 0 end) as asum で出すとか…。
最適化してみましたでしょうか？ しても同じなら、私にもちょっと分かりません。
null insert into t1(c1,c2,c3) values('a',1,null)
メモ参照 参考URL：http://msdn2.microsoft.com/ja-jp/library/ms16567 …
本番環境構築する人の割には判別材料の記入が少ないですねぇ。 Enterprise Managerの再インストールはしましたか？ エラー画面は一切でないでEnterprise Managerが応答なしになるのでしょうか？ SQLのサービス自体は動作しているのでしょうか？ 他の端末からEnterprise ManagerでDB操作するとどうでしょうか？ この内容だとこのあたりが一杯一杯です。。。
すでに別に方法で自己解決しているようですが、 エクスポート出来ます。 bcp db1.dbo.test out D:\work\test.txt -S CPU\INS -U SA -P PASS -T です。 CPUはサーバー名（例はインスタンス名付き） SAはユーザー名（ＳＱＬ認証の場合） PASSはパスワード 私も先週悩みました。 /?のレファレンスもわかりにくいですね。
質問の意図が分かりません。 >WHERE (c4, c2) この記述方法は、SQL92で規定されている行値構成子（行値式）ですが、SQL Serverでは未サポートです。 標準SQLについて、聞きたいのですか？
エンタープライズマネージャで、「現在の利用状況」をいろいろ見てみると出ているかも。
SELECT LEFT(A, CASE WHEN LEN(A) < 4 THEN 0 ELSE LEN(A)-4 END ) + '****' AS hoge FROM hogehoge ではどうでしょうか？ ※4文字以下の場合は固定で'****'としています。
…であれば問題なく動きそうなんですが…。 接続文字列にネットワークライブラリを明示的に指定しているとか。 接続文字列にNetwork Libraryという文字列がありませんか？ 参考URL：http://blogs.sqlpassj.org/yoshihirokawabata/arti …
EMでテーブルを右クリック、コピー メモ帳でペースト 参考URL：http://q.hatena.ne.jp/1094879774
MDFとLDFを新サーバー内にコピーしてそれをアタッチしたらいけるんじゃないかと…。 コピーするときは試用版が入っているPCのSQLサーバーサービスを停止する必要があります。
返事遅れてもうしわけありません。（チェック漏れでした） 正直な話、業務ではほとんどSQL認証で運用しているんで、 Windows認証は詳しくないんですよ。 でも、おそらく、認証の問題だと思います。 なぜドメイン参加が拒否されているかわからないのですが、 とりあえずXPHomeだったらOSの制限で参加できないですしね…。 SQL認証にするかドメインに参加させるか、 サーバーをドメインからはずすか…かなと思います。 ただ、現在クライアントでログインしているユーザー名／パスワードで、 そのサーバーの「ローカルユーザー」を登録、 SQLサーバー上で、DBにアクセスできる権限を付与する （エンタープライズマネージャーで設定可能） と、うまくいくかも… （明示的に「ローカルユーザー」として認識させる）
まず、参照設定をしてください 　'Microsoft ActiveX Data Object x.x Library'の追加 で、以下のコーディングでどうでしょう。 　Dim cnn As New ADODB.Connection 　cnn.Open "Provider=SQLOLEDB;Data Source=NetworkPC1;Initial Catalog=DataBase1;", "aa", "123456" 　cnn.Execute("INSERT Syain ([No], [Name]) VALUES (1,'HammerHead')") 動かしてないので文法エラーがあるかも。
多分無理です。 MSDEの場合、デフォルトでは復旧モデルは「シンプル」のはずなので。
検索と言っているのは、「＝」条件やlikeの前方一致など、インデクスを有効利用できる検索ですか？ それとも、「C1 like '%xxx%'」といった検索もあるのですか？ 母体データ件数は、1万件以上くらいはあるのでしょうか？ 母体件数が数千件以下程度と少なければ、インデクスを付ける効果は少なくなります。 >FirstNameとLastNameに複合インデックスを設定しました インデクスを構成する先頭列は、LastNameではないのですか？ 普通、FirstNameでの検索より、LastName単独またはLastName+FirstNameでの検索が多いと思いますが？ インデクスを有効利用できる検索条件を指定することが前提ですが、(LastName＋FirstName）でインデクスを付ければ、LastNameだけの条件でもインデクスを活用できます。 ある程度の母体データ量があり、インデクスを有効利用できるFirstNameだけでの検索もあるなら、FirstNameにもインデクスを付けた方がいいでしょう。
> 余分な改行コードを消す方法 もともと、プログラムで取り込むためのものではないので、そこまで対処するのは無理があると思います。 取り込み側で空の行は取り込まないようにするか、 BCPなどのデータエクスポート用ツールを使って出力するかしたほうがいいと思います。
SP2以下であればSP3以降にあげるとか…。 参考URL：http://support.microsoft.com/kb/841375/ja?spid=2 …
私なら SELECT 　台帳.* FROM 　台帳, 　(SELECT 　　　注文書No, 　　　MAX(注文書No枝番) AS 注文書No枝番 　　FROM 　　　台帳 　　GROUP BY 注文書No) 台帳2 WHERE 　台帳.注文書No = 台帳2.注文書No 　AND 台帳.注文書No枝番 = 台帳2.注文書No枝番 です。
SQLサーバーのODBCドライバのバージョンは揃ってますか？ 最新のMDACをあててみてはいかが。 参考URL：http://www.microsoft.com/downloads/details.aspx? …
ありますよ。 IDENTITY列　について調べてみてください。
クライアントPCからSQL SerVerにあるデータベースに接続するためには、 1.SerVer がクライアントPCを認識し接続許可をする。 2.SQL SerVer がクライアントPCを認識し接続許可をする。 3.データベース がクライアントPCを認識し接続許可をする。 （SQL認証であれば、1＝2　に設定されていることですよね） 今データベースにアクセスできないのは、「1」の部分が接続許可を 出していないからだと思います。 （ここをはっきりさせるために、SerVerにアクセスできますか？と聞きました） ＞Windowsのパスワードをかけない状態であれば、きちんとサーバーにアクセス出来るし パスワードををかけたことにより、今まで「ユーザー名+パスワードなし」で SerVerに接続していたのに、今度は「ユーザー名+パスワード」では違うクライアントPC だと、SerVerは思ってしまうのです。 これを回避するためには、 「SerVer　-　マイコンピュータ　-　右クリック　-　プロパティ　-　管理　-　 　ローカルユーザーとグループ　-　*ユーザー　-　操作（タスク）　-　新しいユーザー」 上記の処理でパスワード入りの新しいユーザーを作成するか、下記です。 「*ユーザーの右クリック　-　すべてのタスク　-　パスワードの設定」 私のお勧めは上の方で、新しいユーザーを作成してそれが成功したらいらないユーザーを 削除するほうが安心です。 また、SerVerによっていろんな設定があるので、上は一般的にあまり手の込んだ管理を していないSerVerの設定方法です。 ネットワーク管理者がいらっしゃるなら、その方に相談してみてはどうですか？
クラスタリングされていると言うことはシステムダウンはゆるされないでしょうだから片方だけ適用されているのでは開発責任者かMSに聞いたほうが良い。要はデータの狂いさえなければ良い。
おっと、 SET @CNT = @CNT + 1 が抜けている！
＞やっぱりタイミングはプログラムで書かない限りわからないものなんですね いえ。プログラムで書けないから、わからないものなのです。 どんなにがんばってもわかりません。 ＞プログラムの終了は「もう使われていないな」という判断にはならないのでしょうか？ もちろん、なります。 アプリケーションの終了は、全てのアプリケーション固有のリソースを開放します。 共有リソースを定義した場合は、その部分は開放されません。 （例えば、C言語でmarshalでアロケーションした場合とかは開放されない）
AテーブルのBBBのID値は、1の誤りでしょうか？ そう仮定します。 なお、「KEY」は予約語のようなので、注意してください。 insert into C select XA."KEY",XA.yymm from (select "KEY",max(yymm) as yymm from A where ID=1 group by "KEY") as XA inner join B on XA."KEY"=B."KEY"
Datas.発生日 2006/12/01 2006/12/01 select convert(char(6),発生日,112) from datas; (expession) ------------ 200612 200612 SQL Server 2000 の　smalldatetime　型の変換例です。
yymmとは、日付等のデータ型ですか？ 数値データですか？ 条件式で四則演算等を行うと、インデクスが有効利用されない可能性がありますが、性能はあまり気にしないのですか？
多くの主要なRDBMSは、表や列の定義情報を表形式で管理しており、ユーザに参照するためのビュー表などを公開し、SQLでの検索を可能にしています。 MySQLのように、SHOWコマンドなどの特別なコマンドを利用させる方が珍しいです。MySQLも5.0からか情報スキーマが公開され、SQLでの検索が可能になりました。 SQL Serverでは、システムテーブルを直接検索したり、ビューを検索したり、提供されているストアドプロシジャーを使うといった方法があります。 これから使うなら、情報スキーマビュー「INFORMATION_SCHEMA.COLUMNS」表を検索する方法を覚えておくといいでしょう。 参考URL：http://msdn2.microsoft.com/ja-jp/library/ms18677 …
SELECT Min(tr11) AS tr11の最小 FROM TR1; では？
曜日はこれで返り値を得て処理します DAYOFWEEK関数 http://msdn2.microsoft.com/ja-jp/library/aa33725 …
一番簡単な方法を・・・・ クエリのレコード表示をコピーしてEXCELに貼り付け。 あとは好きな形で保存しましょう。
実機確認してみましたが、表示結果の違いは、クライアントソフト（コマンドプロンプトやアナライザ）の仕様差ですね。 数値表現の限界に関しては、#1さんの回答の通りで、浮動小数点では小数以下何桁まで精度を維持して欲しい場合には使用すべきではなく、decimal型などを使用すべきです。 今回の表示結果の差は、クライアントソフト自身あるいは、その開発言語の仕様差で、丸め等が行われた結果です。 decimal型などを使用し、小数点以下の精度も保証する定義（ただし、トータル桁数が15桁などの制限あり）にすれば、今回のような問題は発生しません。
DELETE FROM テーブルＡ WHERE 顧客ＩＤ + 店舗ＩＤ IN (SELECT 顧客ＩＤ + 店舗ＩＤ FROM テーブルＢ) 顧客ＩＤ、店舗ＩＤ両方のキーが共に一致する場合のみ でしぼる場合こっちがいいかと
手許に検証環境が無いので参考意見です。 依存するライブラリ等があるのでsqlmaint.exeファイル単体だけコピーやファイル共有したのでは動かなかったと思います。 実行するPCにSQLServerのコンポーネント（クライアントツールでいいのかは未確認）をインストールする必要があります。 こういう場合は、サーバ側でバッチを実行してクライアントで結果を受け取るようなつくりにするか、 xp_sqlmaintをクライアント側で呼び出して、サーバ側でsqlmaintを動かす （詳細はBooksOnlineを参照ください） ようにするかと思います。 参考URL：http://msdn.microsoft.com/library/ja/default.asp …
直接コマンド叩ける環境ではないので何とも言えないですが コマンドの末尾に > [ファイル名] などと付加して テキストでメッセージを吐かせて それを find コマンドなどでエラー文字列を検出させたりしてはどうでしょうか？ "\\jdn-svr\Binn\sqlmaint" -S JDN-SVR -U acdb -P acdb -D Support -RebldIdx 100 > log.txt
＞a^2.1 という具合に小数点のべき乗の部分が あ。すみません。読みきれてませんでした。 で、そのあたり調べてみると…。 T-SQLでのべき乗は、"^"では行われないみたいです。 "^"は、「ビットごとの排他的 OR」です。 ということで、Power関数を使用するようです。 declare @a as float @a=2 power(cast(@a as float),0.5) で、ルート2が帰ってきます。 （詳細はBooksOnline参照） #言語によって、四則演算以外は違ってたりするので、ヘルプなどで確認するほうがいいかとおもいます。
bcpコマンドでいけると思います。
単純にPowerUsers権限じゃないでしょうか？ ODBC接続を追加できるということは、アプリケーションをインストールできるということとほぼ同じと考えていいので、一般ユーザー権限では不可能だと思います。 あ。「システムDSN」じゃなくて「ユーザDSN」だとうまくいくかも知れません。（Guestでは無理でしょうが）
#1回答者です。 例を間違えました。訂正します。 select power(2,0.5) →1 select power(2.00000,0.5) →1.41421
SELECT CASE WHEN [列名A]>=0 THEN '+' + convert(varchar,[列名A])ELSE convert(varchar,[列名A]) END AS [任意の列名], CASE WHEN [列名B]>=0 THEN '+' + convert(varchar,[列名B])ELSE convert(varchar,[列名B]) END AS [任意の列名] FROM [テーブル名] こんな感じで良いと思うのですが
こちらのサイトが役に立つかと http://www.techscore.com/tech/sql/03_02.html#sql32
今無事に動いているものは変えたくない。 たぶんこの情報システム担当者の考えだと思います。 フィールド名を挿入するにはシステムを多少変更しなくてはいけませんし、カラムの定義は仕様書なり作業マニュアルに記載されているでしょうからね。 もしかしたらシステム内のフィールド名はユーザーが直感的に理解できる名前じゃない可能性もありますし。 要は誰が動くかですよ。 システム管理者がシステムを変更してフィールド名の行を追加し、データを受け取った側がデータの中身を見て内容を確認し、フィールド名の行を削除してからサブシステムに読み込ませるのか、 データを受け取った側がスクリプトか何かでフィールド名の行を追加してからデータを見て内容を確認し、送られてきたオリジナルのデータをサブシステムに読み込ませるのか、、、 いろいろ手段はあると思いますので、情報システム担当者、あなた、送信先の担当者とじっくりと話し合ってみたらどうでしょうか。 常識がどうとか、そんなんじゃなく、どうすればみんなが幸せになれるかって点で。
こちらのサイトが参考になるかと。 http://www2.nsknet.or.jp/~azuma/ms/0053.htm
回答が遅れました。 色々なアドバイスが出てきていますので、一度切り分けて 考えてみてはいかがでしょうか。 ・SPから当該UPDATE文のみを抜き出して実行してもデッドロックになるか？ ・TABLOCKにした場合でも同じか？ ・ロックの待ち時間を長くしてみてもTIMEOUTが発生するか？ をまずは試してみてください。 その結果によって原因がわかるかもしれませんし、 別のアドバイスが出来るかもしれません。
客先の状況ですが、 ・サーバー（DBの本体）は古いSQL Server ・管理用端末には、SQL Server2000のEnterpriseManagerやツールが 　インストールされている ということでしょうか？いや、「客先のSQL2000のEnterprise...」と書かれているので、そのまま読むとバージョンが同じように見えてしまいます。客先のDBサーバーで動いているSQL Server本体のバージョンが判れば、それを書かれた方が話は早いと思います。 で、軽く見てみたところ、マイクロソフトがSYBASE社からSQL Serverを買い取った頃のバージョン（Ver.4だそうです）では、CASE文はサポートされていなかったかもしれません。 http://msdn.microsoft.com/library/ja/default.asp … によると、SQL Server6.0からANSIスタイルのCASE式に対応した、と書かれています。私が初めて使ったSQL Serverが6.5で、97年頃の話でしたから、それ以前。かなり前のバージョンですが、そんなに古いサーバーのお話でしょうか？ そのあたりをまずしらべられて、疑問を払拭されるのがよいと思います（もしかしたら、バージョンを問い合わせたりとかが、いろんな事情で出来ない状況なのかな？とも推測しますが...そこは判らないのでお任せしますね）。 何かのヒントになれば幸いです。
「SELECT Prefecture FROM Address 　　WHERE InputAddress LIKE Ward + '%'」 Prefecture:県名（千葉・埼玉・神奈川） Address:表名 InputAddress:検索する住所＝東京都大田区ＸＸＸ１－２－３ Ward:区名（東京都品川区・杉並区・大田区） こんな感じで如何でしょうか。
普段、Oracle 相手に SELECT 文を作ってるので、それをさっ引いて読んで下さいナ。 SELECT SUM( NVL( 面積, 0 ) ) FROM 物件情報 WHERE 契約日 > ADD_MONTHS( SYSDATE, -12 ) AND 契約日 <= SYSDATE …と、こんな感じのことがしたい訳ですな。 ・“今日”を示す、SQL変数が Access にもあると思うので、それを使う。 ・1年後の日付を取得する、ってな日付関数もあったと思うので、それを使う。 ・[面積]が DBNull.Value の場合は 0 と読み替えるような、数値関数もあったと思う。
解決してよかったですね。 入れ直しは考えましたが、書くまでに至らずそのままでしたね。 特に何も良いアドバイスをできなかった私には何も言えません。 参考URLにあるような画面が出たのでしょうか？ これは msvc(何とか).dll というファイルが出しているメッセージです。 mmc.exe がまだ使用できない関数を呼び出そうとした時に、上記のメッセージがでるのです。 とするとmmc.exeが呼び出そうとした時にパスが正しい msvc*.dll に通っていない時にも出ますね。問題の時の、フォルダ上の位置関係と、現在の位置関係を比べてみるとなにか違ったかもしれません。 すいません。お役に立てなくて。 参考URL：http://photozou.jp/photo/show/7/382948
SCOPE_IDENTITY() 参考URL：http://www.atmarkit.co.jp/bbs/phpBB/viewtopic.ph …
はじめまして。 ＞　USE db_Sample; ここで、最後のセミコロンは要りません。 USE db_Sample CREATE VIEW viw_sample1 as select * from tbl_sample1 これでビューを作成できるはずです。 補足で、データベース"db_Sample"上にテーブル"tbl_sample1"が存在していないと作成できないと思います。
私は、SQLServerを知らないので、正しい答えかどうかわかりませんが、 トランザクションなしにINSERT句が発行できるわけがないと思うのですが(^_^;) INSERT句だけを実施すると、暗黙のトランザクション開始-終了命令がINSERT句前後に発行されるため、 その分遅くなるというのが答えではないでしょうか。
ID　　Field_1 1　　　123.1 2　　　1000.12 3　　　-123.01 SELECT Left('-', PATINDEX('%-%', str(Field_1)) / (PATINDEX('%-%', str(Field_1))-1)) + Left('+', PATINDEX('%-%', str(Field_1 * -1)) / (PATINDEX('%-%', str(Field_1 * -1))-1)) + Right('0000000000' + convert(varchar(11),abs(field_1)),11) FROM Test ---|(expession) | ---|------------- 　1|+00000123.10| 　2|+00001000.12| 　3|-00000123.01| しかし、面倒くさいです。 表示する際の書式で解決すれば簡単かと思いました。
断片的な参照で良ければですが。 right(('00000000000' + convert(varchar(11),convert(decimal(11),売上金))),11)) のように、桁数分の0を数値の頭につけてから、必要桁数をRightで抜き出すという方法を用いるようです。
Access2000はSQLServer2005に対応していないと聞きましたが、勘違いだったらごめんなさい。
長さの上限は、予め分からないのですか？ インデクスの定義可否、ソートやグループ化で使用できないなど、text型にするといろいろな制約が出てきます。
SQL Server 2005 Expressでは、以下の方法でした。 デフォルトではsaログインは無効ですので、コンソールより C:\>sqlcmd -E -S .\SQLEXPRESS 1>ALTER LOGIN sa ENABLE 2>GO 1>ALTER LOGIN sa WITH PASSWORD='パスワード' 2>GO 1>exit
http://cafelounge.net/dev/?SQLServer%2F%B2%F2%C0 … を参考に。 xtypeの値は、 http://msdn2.microsoft.com/ja-jp/library/ms17759 …
SELECT X.A FROM テーブルA AS X INNER JOIN テーブルA AS Y ON X.B = Y.B GROUP BY X.A HAVING Count(*)>1; 最適な答えではないと思いますが、これで求まると思います。
CASE WHEN　を使用すれば可能なような気がしますが。。。 w_sql = w_sql & " CASE WHEN WK.項目=1 THEN 100 　　　　　　 w_sql = w_sql & " WHEN 2 THEN 200" w_sql = w_sql & " WHEN 3 THEN 300" 　　　　　　　　　　　・ 　　　　　　　　　　　・ 　　　　　　　　　　　・ w_sql = w_sql & " END" また w_sql = w_sql & " CASE" w_sql = w_sql & " WHEN ～　" w_sql = w_sql & " ELSE" w_sql = w_sql & " CASE ～" w_sql = w_sql & " WHEN ～" 　　　　　　　　　　　・ 　　　　　　　　　　　・ 　　　　　　　　　　　・ w_sql = w_sql & " END" w_sql = w_sql & " END" なども可能と思われます＾＾
私も初心者なので詳しいことはわかりませんが、 クエリアナライザはその名の通り「クエリを分析」 するものなのでレスポンス等が悪いときなどの調査 に役に立っています。 エンタープライズマネージャはあくまで管理するもの と考えたほうがいいかもしれません。 間違ってたらすいません。
計算式をベタ書きすれば良いのでは。こんな感じ： select (abs(sgn( V1 )) +abs(sgn( V2 )) + abs(sgn( V3 ))) / (case V1 when 0 then 0 else 1/V1 end+case V2 when 0 then 0 else 1/V2 end+case V3 when 0 then 0 else 1/V3 end) where T 1列分に射影した表をunionすれば、AVG()が使えるかも。
サーバーエクスプローラ →データ接続 →右クリック →接続の追加 →データソース：Microsoft SQL Server 画面の説明欄は、SQLServerプロバイダは2000以上としている。 しかし、MSDNではSQLServerプロバイダは7.0もOKなのだけど。 http://msdn2.microsoft.com/ja-jp/library/ms171961(VS.80).aspx OLEDBプロバイダを選ぶなら7.0との接続はOKだそうです。 http://blogs.wankuma.com/trapemiya/archive/2006/ …
http://www.microsoft.com/japan/sql/solutions/aup … ＜自分でアップサイジングを実行する＞ まずは、ここから・・・。
確認が２点 １．管理ツールなどでODBCのシステム（またはユーザ）DSNを作成すると 　　ウイザード形式で接続を作成できます。それはもんだいなくうごくでしょうか？ ２．OSQLなどのツールで、外部からSQL認証でログインすることは可能でしょうか？
＞条件1.テーブル2.TT1はテーブル1.T1に存在するものに限る 失礼しました LEFT JOIN ではなく INNER JOIN ですね　（ーー；
#1回答者です。 今回はCD列とID列という、たまたま同じ値を持つ列だったので、group byに列を追加するだけでOKでした。 グループ化したものと、グループ化していないものを結合したいという要件は時々あり、そういうときは例3のような使い方の方が応用は利くと思います。
そのチケット業者に連絡しましょう。 業者のサーバがおかしいのでどうしようもないですね。
例えば、id管理表.final_value　の int 型の not null を null に変更するには ? CnnExecute("ALTER Table id管理表 ALTER COLUMN final_value int NULL") True Transact-SQL リファレンスの　ALTER TABLE の構文の最初の６行に書かれています。 *SQL Server 2000
> このようなことができるのでしょうか？ できます。 > 仮にできるとしたら、こういう結合をなんと呼ぶのでしょうか？ 分散クエリです。
可能です。 インポートのウィザードで 「変換元データベースから・・・」を選択されていると思いますが、 オブジェクト転送を選択して下さい。 「SQL Server データベース間のオブジェクトとデータのコピー」 です。次に出てくるウィザードで、制約をいれたり、ストアドを選択できたりします。
#1です。 >これに成功したら、移行は、容易いものです。 移行なんて、エクスポート、インポート出来れば問題は無いですが、本格的なデータベース使うと必ず考えなくてはならないスキーマー設計、テーブル、インデックス設定、view設定、ユーザ権限管理から、再編成スケジュールなり、バックアップ稼動監視やら、・・・有るじゃないですか。どうしたってコスト問題は絡むので、会社となると一人で決めれる問題じゃない気はします 参考URL：http://www.gihyo.co.jp/books/syoseki-contents.ph …
直接の回答ではなく、申し訳ないのですが、No.1さんの指摘にもあるとおり、論点が少々おかしいように思います。よほど切羽詰まった状況や、業務の間隙を縫っての作業でなければ、やはり予備の時間を用意して、ゆったり確実に作業、という方向で検討するのが妥当と考えます。 また、手順に「失敗した場合の手順」は含まれていますか？リカバリーの時間も含めて「見積もり」としておかないと、トラブルが起きて、どちらのDBも中途半端な状態になったときに元に戻す時間が取れません。 ここは、やはり「ながめの時間を用意しておいて、前倒しできればラッキー、位に考える」のが正解かと思います。
SQL Serverのトリガに詳しくはないのですが、 UPDATE Books SET Stock = @Stock 上記のupdate文は検索条件がなく、全行更新になっているのでは？
「SQLプロファイラ」で確認できます。 「Enterprise Manager」のツールメニューから選択するか、 スタート→プログラム→SQL Server→プロファイラを選択すると 起動できます。実行された全てのSQL文をリアルタイムで 確認することができます。
'（シングルクォーテーション）が含まれた文字列を考えるのって、最初はすごく戸惑いますよね。 以下のように考えていくと、わかりやすいのかな、と思います。 １．''で囲まれた部分は文字列として扱われる ２．'（シングルクォーテーション）を文字列として扱うのには、''（シングルクォーテーション二つ） まず実際に作成したい文字列を記載し、上記を踏まえて分解していきます。 １．TEKIYO LIKE '%未%'　　　　←作成したい文字列 ２．TEKIYO LIKE ''%未%''　　　←シングルクォーテーション部分を二つに ３．TEKIYO LIKE ''%　　未　　%''　←変数部分となるところを分ける ４．'TEKIYO LIKE ''%'　　未　　'%'''　　←変数以外の文字列となる部分をそれぞれシングルクォーテーションで囲む ５．'TEKIYO LIKE ''%' + @TEKIYO + '%'''　　←３．で切り出した変数部分となるところに ＋＋で変数を埋め込む こんな感じでいかがでしょうか。
#1回答者です。 課題の丸投げは、規約違反ですよ？ 「SELECT * FROM ～」を使えというなら、EXISTSを使うのでは？
>あるDBの全テーブルのサイズを表示させたいのですが 個々のテーブル単位でしょうか？ Enterprise ManagerでDBを選択し、「表示」→「タスクパッド」を選択、表示されたら、「テーブル情報」タブをクリックすると、テーブルごとのサイズは表示できます。 時間があれば、プロファイラを動かしながら上記の操作を行うと、EnterpriseManagerが発行している、テーブル毎のサイズを取得するまでのスクリプトを取得できます。
(^^; 先ほどの参考URLにASPからのもありました。 参考URL：http://support.microsoft.com/kb/252987/JA/
昔、DTSを使ってやっていました。 他にも方法があるかもしれません。 参考URL：http://www.microsoft.com/japan/msdn/sqlserver/co …
微力ながら自分も同じ現象にあったことがあるので コメントさせていただきます。 tempdbはテーブルもログもバックアップできません。 １．SQLServerを再起動する ２．テーブルサイズを最初から広く取っておく ３．テーブルの自動拡張設定の拡張率を大きくする この３点を試してみてはいかがでしょうか？ ちなみに自分は１番と２番で問題解決しました。
SQLというのは、SQL ServerのSQLという意味ですか？ 完全というほど、マスターする意味はないと思いますが？ 各RDBMSでは標準SQLに準じてSQLをサポートしている一方で、独自仕様としてサポートしている部分が少なくありません。DDL（定義系SQL）や関数などには、独自仕様の部分が目立ち、ストアドプロシジャは相当な部分が独自仕様です。 標準SQLの最新仕様を漏れなくマスターしようと思っても、各RDBMSにより実装の範囲が異なっていたり、仕様差がある場合も少なくありません。 言語仕様などをすべて頭に入れておく必要はなく、どういったものが、どういった本やサイトに記載されているということを知っておけばいいのです。 もし、SQL Serverに詳しくなりたいなら、SQLだけでなく、DB設計や運用などを学び経験する方がいいでしょう。
実機確認はしていませんが、以下のSQLではどうでしょうか？ select sum(kingaku) from( select kingaku from tbl_2000 union all select kingaku from tbl_2001 ) as t;
SELECT文のなかでCASE文を使用してください。 例えば、 SELECT CASE WHEN 項目Ｃ=0 THEN 0 ELSE 項目Ｂ/項目Ｃ END AS 項目Ａ ... FROM ... これで、項目Ｃが0の時は「0」にできます。
有償も可であれば、XCuteというツールがあります。 今はWeb機能メインになっていますが、昔はDB<->Excelの連携ツールでした。 連携機能は現在もあるはずです。 一応プログラムレスをうたっているツールなので比較的簡単にメンテナンスできると思います。 ただ、結構なお値段がしてしまいます。 参考URL：http://www.microlab.jp/xcute/
ファイルがなければ作成、あれば上書きされます。 参考URL：http://msdn2.microsoft.com/ja-jp/library/ms18860 …
クエリーアナライザで、テキストファイルをテーブルにアップロードするのであれば、「BULK INSERT」を使用してみて下さい。 http://msdn2.microsoft.com/ja-jp/library/ms18836 … クエリーアナライザにこだわらないのであれば、「DTS」を使ってみて下さい（SQLSERVER 2000の場合）。 http://www.microsoft.com/japan/msdn/sqlserver/co …
ANO.1です。 ＞＞スカラ値関数ではOKのようです（補足で頂いたSQLもOKです）。 ＞ここのところを再度ご教授願えないでしょうか。 なるほど納得です。私はEXECUTEしてました。 例： DECLARE @ret int EXEC @ret = dbo.F_GET_DAY 通常、関数は、SELECTでも使用しますので、 そのあたり検証すべきでした。 申し訳ありません。 SELECT, PRINTともＮＧで、EXECUTE はＯＫでした。 拡張ストアドの種類や関数の実行の仕方など、 SQLServerが判断して実行可否を決定しているのですね。 で、その判断基準は明記されておらず （関数の設計基準はありますが）、 実行してみないことにはわからないようです。 またまた勉強になりました。
「ABC\DB01」で接続できませんか？
http://okwave.jp/qa2506963.html ここで答えたURLを参照してください。
商品マスタ、顧客マスタ等の、現在取り扱い件数、内容など、 1日、月のトランザクション処理件数、 などなど、分からないとなんともいえません。 又、VB.2005は、WEBにも対応可能です。 基本的なところが、ないような感じです。 業務システム作成はまだ無理では？ もう少し、知っている人に相談するのが先だと思います。
10行目を見るとStockNo でA1,A3共に結合しているので、 A1,A3テーブル共にStockNoというフィールドが存在している と思います。 そこで、3行目で、A1.*, A3.* としているので S1というデーぶるには、A1,A3テーブルの全フィールドと していますが、StockNoフィールドがどちらにも入っているので どちらを適用してよいかわからず、エラーになっていると思います。 なので、3行目を必要なものだけに書き換えては、いかがでしょうか？ A1.StockNo,A3.hoge1,A3.hoge2・・・・・ 私も、試す環境がありませんので、予想だけですが・・・
IN ではなくて ANY　を使うといいのでは？ SELECT id, code, num, title FROM contents WHERE code=2 AND id = ANY (SELECT MIN(id), num FROM contents GROUP BY num) これだとINとほぼ同じ意味になるはずです。
ライセンスに関する質問は、最終的にはマイクロソフトや商社に直接聞いて確認してください。 参考までに、（あくまで記憶です） Windows Server 2003 の IIS がインターネットからしアクセスされず、しかも認証なしの匿名で不特定多数からしかアクセスされない場合だけ、CAL が必要ありません。 実際にはシステム管理者の分だけ CAL は必要です。 イントラネットに設置される場合は必ず CAL が必要になります。 CAL は「接続デバイス数または接続ユーザー数」か「同時アクセス数」で運用しますので、規模で見積もってお得な方にします。 SQL Server 2000 は IIS などの Web サーバからアクセスされるとしてもユーザー分の CAL が必要になります。 ユーザーが多いとか不特定多数の場合は CAL ではなくてプロセッサ ライセンスを購入します。
CHAR型や DATE型は、それらの値をシングルクォーテーション（’）で囲みます。 insert into table1 (ID, 日付) values(2, '1999/09/14 23:23:00'); 1 件のレコードを挿入しました。 ということで、そもそも CDATE関数を使う必要がないです。 insert into table1 (ID, 日付) values(3, CAST('2000-05-08 12:35:29.998' AS datetime)); 1 件のレコードを挿入しました。 と書くことも可能ですが、その必要もないかと思います。
はじめまして。 不確か（手元にマニュアルがありませんので）ですが、"Sp_Add LINKED SERVER"からすると、 接続対象のサーバが見つからないのではないでしょか。 このエラーが発生する端末のhostsに当該サーバの情報が無いのではないでしょうか。 見当違いの回答でしたらお詫びいたします。
エンタープライズマネージャで、 ジョブヒストリの詳細を確認してみてください。 なにかヒントになるエラーなどが書かれているかも。
No.1で回答させてもらった者です。 > インスタンスがある場合は「Data Source=192.168.0.10\インスタンス名」って > できないのでしょうか？ 今、以下の環境で確認したところ、 当方の環境では、 ・IPアドレス\インスタンス名 ・コンピュータ名\インスタンス名 共にADO接続できました。 [試した環境] ・WindowsXP Professional SP2 & MSDE2000 SP4(名前付きインスタンスにてインストール) ・Windows Server 2003 & SQL Server 2000 SP4(名前付きインスタンスにてインストール) のSQL Server 環境に対し、同一LAN上に存在する、 WindowsXP Professional SP2から接続を確認。 当方ではこれ以上わかりませんが、参考になれば幸いです。
> 学校の課題で Stored Procedures の頭に > 番号を使わなければいけないのですが、 そこが課題だとすると規約違反なんですよね、、、 ストアド プロシージャを作ることが課題だけど、関係ない部分でつまづいてるってんなら問題ないんだけど、、、 とりあえず create procedure [1234-selectData] as select * from Account exec [1234-selectData] てな感じで。 どんな時でもオブジェクトの名前は [ ] で囲んで書く癖をつけておくと変なエラーに巻き込まれませんよ。
SQL Server 7.0 は、既定のインスタンスとしてのみインストールできます。 インストールしようとした別のソフトが、SQL Server 7.0を必要とする場合、残念ながら、インストールは失敗すると思われます。 検討違いでしたら、すみません。
どこでエラーが出るのか、 どんなエラーが出るのか、 どのようにして INSERT しようとしているのか、 を書いた方が、、、 日付値を日付型の列に入れる場合、 #2006/10/06 00:04:30# ってしてます？
予めテーブルが用意されておく必要があります。 BCPユーティリティの詳細につきましては、「SQL Server Books Online」の「bcp ユーティリティ」などをご覧いただくのが良いと思います。（既にご覧になっている場合はご容赦ください。） 因みに、以下のURLからダウンロードが可能です。 http://www.microsoft.com/downloads/details.aspx? …
SELECT CURRENT_DATE FROM test_table を SELECT [CURRENT_DATE] FROM test_table にしてあげたらよいです。
http://homepage1.nifty.com/kojama/works/rdbms/ms … SQL文を書いたファイルをバッチで実行するには？ を実行してみてください。 あと定期実行は、 ・Windowsのコントロールパネルに「タスク」があるので、それでやらせてもよし。 ・フリーソフトの定期実行を行うものを利用。 ・業務系であれば、サポートを行わないフリーソフトを利用するわけにもいかないだろうから、そのような定期実行ソフトを購入する。
こんにゃくは。 もう、NULLについての方法は出ているようなので、別の考え方？だけ参考までに。。。 >>どのように回避すればいいのか。 一番簡単に思いつく～とすれば、「NULLを入れさせない。」ですよね。 入れさせなきゃ悩む必要ないですから－ｗ－ 入れさせない方法として考え付くものとして（？） ・ユーザーに入れさせない。 ・入れてもNULLにさせない。 かな。 ユーザーに入れさせない。としたら、入力時に判定させて、必ず何かを入力しなければいけないようにメッセージを出してやったりすればいいですよね。 でなければ、ユーザーが入れても、システムで無理矢理、スペース１つ入れてやるとか、何かすればOKですよね。 で、個人的な意見ですが、NULLは非常に好きじゃないです（笑 NULLのためにわざわざ処理考えなきゃいけないときとかありますしねぇ。。。 検索条件も、NULLがあるがために２回やったり。。。(_。。_ できることなら使いたくないって思っているので、自分で何か考えるときは、できるだけNULLを使わないで済む方法。 を考えながらやってますよ。 まぁ、参考までにー。です。
バッチファイルの作り方がわからないのでしょうか？ とりあえず、テキストファイルを作って その拡張子を.batに変更するだけだと思います。 最初は次の行に"pause"をいれて結果を確認するといいかも。
http://homepage2.nifty.com/inform/vbdb/ ここのページの 「ADO で SQL Server に接続する」 これをやってみて、わからないところを具体的に言ってください。 あなたの文面を読んで、 ・初心者だということ ・うまくいっていないこと だけがわかりますが、何ができていて、何ができていないかがさっぱりわかりません。 多分、この書き込みを見た多くの人が思っていることでしょう。 初心者だという自己紹介よりも、質問の解決に向けて、どのようなことを公開したら問題が解消されるかを考えながら質問をしてください。 私もたまに質問を投げたりします。 ある程度の実験と考察を繰り返し、 ・何をやりたいのか ・この質問を投げるまでに、何をやったのか（参考にしたURLがあればそれも公開） ・それで問題となるポイント（エラーが出ているのであれば、出力されているエラー情報など） は最低限載せます。 そうすることで、問題解決の糸口が見つかりやすくなります。
fromにtable1は不要なのではないでしょうか？ update table1 set column1 = 'AAA' from table2 where table1.column2 = table2.column2 and table1.column1 = 'BBB' and table2.column1 = 'CCC' こんな感じでいけると思いますよ
まず、通常はファイル操作について、ロールバックを行うような仕組み自体ないと思います。 （あ。NTFSはそういう仕組み持ってるか…でもそのトランザクションをプログラムから操作は出来ないと思います） なので、まず、ファイル捜査を「元に戻す」所から、自分で実装しなければいけないのでは？ で、それができたら、DBのトランザクションとそのファイル操作のトランザクションが連動するようにクラスなりを作成すればいいと思います。
結構いろいろややっこしいです。 こちらを参考にがんばってみてください。 http://www.eonet.ne.jp/~link-room/tyakuuta-imo.h … Macな方ならこちらもどうぞ。 http://sunsky3s.s41.xrea.com/ http://blog.livedoor.jp/gm0079/archives/50200712 …
その場合、全部を変数に入れればできます。 デカいSQLだとけっこう大変なことになりますけどね(^^; 例） @変数A = "SELECT TABLE.field AS " + @変数B + " FROM・・・" EXECUTE(@変数A)
sysobjectsでidを捕まえたら、「sys《ほにゃらら》」系のテーブルより、取得できます。 SELECT OBJ.idAS オブジェクトID ,OBJ.nameAS オブジェクトNAME ,CLM.nameAS 引数名 ,TYP.nameAS 引数型名 ,CLM.precAS 引数有効桁数 ,CLM.scaleAS 引数少数部桁数 ,CASE CLM.isoutparam WHEN 0THEN '入力' WHEN 1THEN '入出力' ENDAS 引数タイプ FROM sysobjectsAS OBJ LEFT JOINsyscolumnsAS CLM ONOBJ.id= CLM.id LEFT JOINsystypesAS TYP ONCLM.xtype= TYP.xtype WHERE OBJECTPROPERTY(OBJ.id, N'IsProcedure') = 1 ORDER BY OBJ.id ,CLM.colid
これでやってみてください。「データ」→「外部データ取り込み」→「新しいデータベースクエリ」→「データソース選択ダイアログ」→<新規データソース>→新規データソース名を入力（任意）→アクセスするデータベースの種類に対応するドライバ選択（SQL server)→サーバーの選択→オプション・データべースを選択→ＯＫ・・・　　これで出来ます WIN XP PRO SP2 & Access 2003 環境でテストしました。
補足です。エンジンを止めるとはアプリのことです。server側にコピーしたら、SQL Enterprise manager （多分ある）でアタッチすると使えます。
「is null」は「null」を検索するものであって、 「空白を検索」するものではありません。 スペースの検索は、 ＜検索対象＞ like '%　%' です。 （%の間は全角スペース若しくは半角スペースです。 検索対象スペースに合わせてください。）
『CNT_1は無効です』というエラーですが。有効な列として認識されて無いようです。この場合ストアドプロシージャを利用しCN_1,2,3を変数に代入してから計算する方法もあります。
>1ページ8KBをほぼ占有 あ。そうだ。１レコードあたりの最大がそれだけでしたね。 …ということはvarcharだと厳しいかもしれませんね…。 textはその枠とは関係ないので、そのほうがいいのかも。 特に検索対象にしないのであればリスクもないわけですし…。
試してはいませんが、私の環境にインストールしてある SQL Server 2005 の Books Online（2006年4月）に書いてありました。 ms-help://MS.SQLCC.v9/MS.SQLSVR.v9.ja/toolref9/html/6f175bcd-0c68-4f66-b20e-443ba2c44127.htm または Web の MSDN2 ライブラリ http://msdn2.microsoft.com/ja-jp/library/ms17419 … SQL Server 2005 ツールは SMO を使用しており、SQL Server 2005 の新機能を完全にサポートしています。SQL Server 7.0 と SQL Server 2000 ツールは DMO を使用しており、SQL Server 2005 の新機能がサポートされません。 ・SQL Server 2005 ツールでは、SQL Server 2005 の管理および SQL Server 2000 のすべての機能の管理を行えます。 ・SQL Server 2000 ツールでは、SQL Server 2005 の管理を行えません。 ・SQL Server 2005 ツールと SQL Server 2000 ツールは、同一のコンピュータ上にインストールした場合でも正常に動作します。
SQLServer2000を使用してますが。初期作成サイズより圧縮するには、SHRINKDATABESEではなくSHRINKFILEでデータファイル・ログファイルを個々に圧縮する必要があるとおもいます。
SQL-Server2000ということで、 エンタープライズマネージャを使用して、 「データベースの圧縮」を行えば （事前に「BACKUP LOG データベース名 WITH TRUNCATE_ONLY」が行われていれば） ログのファイルは小さくなるはずです。 参考URL：http://www.microsoft.com/japan/technet/prodtechn …
ちとイメージが沸かないのですが、 レコードを追加する一連の処理の最後に、今追加したレコードのオートインクリメントの値を取得したい ってことですか？ @@IDENTITY が使えますね。 この URL は規約に引っかかるのかな・・・ http://blog.temtecomai.net/archives/9477867.html じゃぁこっちで http://www.google.com/search?hl=ja&lr=lang_ja&ie …
それはDDLトリガのことではないですか？ トリガにはDDLトリガとDMLトリガがあります。 > また、Alterでトリガーを無効にしたい場合は > トリガーをドロップする方法が無難なのでしょうか？ DISABLE TRIGGER でいいと思います。 参考URL：http://msdn2.microsoft.com/ja-jp/library/ms18974 …
ご承知のように　SQL Server は、リレーショナルデータベースを構築し管理する言語です。 サーバーに置かれているデータを管理することに軸足があります。 ところで、データ自体の入力・参照・変更・削除は、クライアントのパソコンから行うのが通例です。 サーバー側をバックエンド、クライアント側をフロントエンドと呼ぶとします。 質問は、フロントエンドに関する質問かと思われます。 この場合、SQL Server の説明書をいかにひっくり返そうとも書かれていないことでしょう。 フロントエンドを開発する言語は、Visual Basic であったり Access であったりするからです。 ですから、その方面から攻める必要があります。 キーワードは、「クライアント/サーバーシステム」です。 ***** ところで、Windows 3.1 の頃は、シコシコとDDE通信を利用して VB で書いていました。 DDEサーバーとDDEクライアントという関係でC/Sシステムを構築してきた訳です。 ところが、昨今は、多少、事情が異なってきました。 　「Access97以前のバージョンでは、データベースアクセスのプログラムにDAO(Data Access Object)が推奨されていたが、 Aceess 2000からは、ADO(ActiveX Data Object)が推奨されるようになった。これは、mdbデータベース、SQL Severともに対応し、一応はDAOとRDO(Remote Data Object)もサポートされているものの、今後の開発は基本的にADOに集約される。 ADOは、・・・適応領域がRDBMSだけでなく、さまざまなデータソースに対してOLE DB(Object Linking and Embedding DB)を経由してアクセスできる。今後の開発には、なるべくADOを利用すべきだろう。」(クボタシステム開発 河端善博氏) 　「Aceess 2000から『Microsoft Accessプロジェクト』形式による保守が可能となりました。 Accessプロジェクトを使うとAceess 2000とSQL Server7.0の親和性をより向上させ、Accessデータベースを作る感覚でC/Sシステムの構築ができます。・・・Accessプロジェクトは、C/Sシステム構築の新たな開発環境として、大きな進化を遂げたのは確かです。今後にも大いに期待できるものであることは間違いありません。」（インフォネット開発 本田剛氏） 今では、DDE通信のために開発したライブラリを搭載したパソコンは粗大ゴミとして捨てて久しいです。 ***** マイクロソフトの回し者みたいな回答ですが、私は、Microsoft AccessプロジェクトをSQL Server のフロントエンドに選びました。 この辺りの事情は、以下を参照すると更に詳しく判ると思います。 http://www.sqlpassj.org/ ＊SQL Serve の学習２ヶ月余。ストアドプロシージャを未だ攻めきれていません。 ＊まあ、同じ素人同士、頑張りましょう。
コマンドボタンのウィザードを起動して＜レコードを保存＞を選んだ時に生成されるコードです。 Private Sub コマンド0_Click() On Error GoTo Err_コマンド0_Click 　　DoCmd.DoMenuItem acFormBar, acRecordsMenu, acSaveRecord, , acMenuVer70 Exit_コマンド0_Click: 　　Exit Sub Err_コマンド0_Click: 　　MsgBox Err.Description 　　Resume Exit_コマンド0_Click 　　 End Sub ですから、レコードを一旦保存しているようです。
select 列１,count(distinct 列２) from テーブル group by 列１ でいけるかな？
何だかプロシージャの制作依頼に聞こえるのは、私だけでしょうか．．．
データベース関係未経験。 治ることは一切保証できません おそらくKBの元になったであろうスレッド http://www.dbtalk.net/microsoft-public-sqlserver … そこにはKBに書かれていない記述が一つあります。 2.Also please check if an environment variable __COMPAT_LAYER is set? "set __COMPAT_LAYER=" , basically disabled the compat layer and dta ran OK 以下がこの記述の説明(英語) HOW TO: Script Compatibility Layers in Windows XPhttp://support.microsoft.com/?kbid=286705 環境変数__COMPAT_LAYERがセットされてたら set __COMPAT_LAYER= で適用しないようにしろ、という話も見つかります。 少なくともスレッドに依れば01-03-2006の段階で Maciek Sarnowicz [MSFT]は、これ以外の原因はわからないとしています。 アドバイスまで。
SQL Serverの何を勉強されるのでしょうか？ とりあえず、このサイトが本家ですので、情報収集してみてください。 http://www.microsoft.com/japan/sql/techinfo/defa …
可能です。 インストールパッケージの展開先は自動的にCドライブにされますが、SQL　Serverそのもののインストール先は指定できます。
http://pcweb.mycom.co.jp/news/2006/01/31/344.html こういうのが参考になりませんかね？
> 当方で開発用に購入したVS2005 Proには「SQL Server 2005 Developer Edition」が一緒についていました。 > これは開発用で、出来上がったアプリをユーザーに使ってもらうにはユーザーのクライアント機に 「SQL Server Express Edition 」と「NET Framework 2.0」をインストールしてもらえばOKということになるのですか？ そういうことになります。 ただ一概には言えませんが、私の場合はお客様から要望された機能の業務用アプリケーションを開発して納品するのが仕事なので、インストール作業については私の側で行うことが多いです。 特に SQL Server も絡む場合はそうしますね。 ちなみに .NET Framework 2.0 ランタイムは Windows Update からインストールできますし、下記 URL から落もダウンロードできます。 http://www.microsoft.com/downloads/details.aspx? … さらには作成したアプリケーションのインストール セットに含めて、相手の PC に .NET Framework 2.0 が入っていない場合は自動インストールさせることもできます。 http://www.atmarkit.co.jp/fdotnet/dotnettips/496 … インストーラをきちんと作りこめば ・ SQL Server 2005 Express Edition インストール ・ 今回のアプリ用のデータベース作成スクリプト実行 ってのも自動でやれるでしょうが、なかなかそこまではｗ
SQLDMOでサブスクリプションの登録処理を作成した時に、同様のことで悩んだので、もしかしたら、原因が同じかもしれません。 このときの原因は、サブスクリプションエージェントのfrequency_typeプロパティを未指定にしていた為、データの同期は実行されませんでした。 もし原因が同じであれば、以下のようにすれば、うまくいくと思います。 ＞(http://msdn2.microsoft.com/ja-jp/library/ms14730 … ) ここの「バッチ ファイルを使用したタスクの自動化」にスクリプトの以下のような箇所があります。 ＞REM -- Add a pull subscription at the　Subscriber ＞sqlcmd /S%Subscriber% /E /Q"USE %SubDb% EXEC sp_addmergepullsubscription （後略) ＞sqlcmd /S%Subscriber% /E /Q"USE %SubDb% EXEC sp_addmergepullsubscription_agent （後略) この最後の「sp_addmergepullsubscription_agent」プロシージャーの「@frequency_type」オプションに６４（自動起動）を設定しみてください。 参考URL：http://msdn2.microsoft.com/ja-jp/library/ms18772 …
「Ｂの売上データの中で、何種類の商品が売れたか知りたい」 という事でよろしいでしょうか？ “ＡＡ”、“ＢＢ”といった商品を表す項目を「商品コード」と 呼ぶことにしますね。 SELECT COUNT(*) FROM 商品マスタ WHERE 商品コード IN(SELECT DISTINCT 商品コード FROM 売上げデータ) ↑このようなSQLでお望みの結果が得られませんでしょうか？ SELECT DISTINCT 商品コード FROM 売上げデータ ↑これは、売上データの中にある商品コードを重複を除いて取得するので ---------- ＡＡ ＢＢ ＤＤ という結果が帰ってきます。 で、１商品１データしかない商品マスタの中で、商品コードが このいずれかと一致するレコード件数を取得する、という手法です。 「○月×日までに売れた商品の種類を知りたい」 「１ヶ月の間に売れた商品の種類を知りたい」などと限定する場合は ( ) の中の SELECT DISTINCT 商品コード FROM 売上げデータ このSQLにWHERE条件を付加して絞り込めばよいかと思います。 ご参考までに。
スタートから、[SQL Server 2005]→[構成ツール]→[SQL Server 構成マネージャ]を起動してください。 その中で、SQL Server 2005 ネットワーク構成から、SQLEXPRESSのプロトコルを参照してみてください。 名前つきパイプや、TCP/IPは有効になっていますか？ 無効になっているならば、有効にして接続確認を行ってみてください。 スタートからの位置はSQL Server 2005 Expressだけをインストールしているわけではないので、実際は微妙に違うかもしれません。
大きな問題はないと思われますが、Server2005がもつ機能のうち、.NET2003（Framework 1.1）では動作しない（対応していない）ものがあります。 参考URL：http://forums.microsoft.com/MSDN-JA/ShowPost.asp …
ＳＱＬ７．×あたりでは やれたはず＜実際やったことはないです http://www.microsoft.com/japan/technet/prodtechn …
SQL Server 2000ですか？ ユニークなキーはないのですか？ ここには書かれていませんが、年＋社員NOでユニークになるのですか？ 評価が同じデータがあった場合は、どうするのですか？
単に「エラーが出る」ではなくて、どんなエラーか内容を書きましょう。 >WHERE句を減らしてHAVING句にしましたが、 >エラー表示されてしまいます。 そんなデタラメなことをやってはいけません。（笑） HAVINGは、GROUP BYと共に使用するものです。 表名、列名の指定は正しいとして、表の関連付けのための条件とその他の条件をANDで結んでください。 EXISTS内のSELECTの列名は、今回のSQLの場合は意味がないので、一般的には「*」を指定します。 （慣習的に「1」を指定する人もいる） 【修正例】 SELECT HINMOKU_NAME FROM HINMOKU WHERE EXISTS (SELECT * FROM URIAGE WHERE URIAGE_DATE ='2004-11-10' AND MOKU.HINMOKU_CODE=URIAGE.HINMOKU_CODE);
XML にして引き渡すなんてのもいけるかもしれませんね。 試してないのでアイデアだけですが。
alt＋Ｆ4を連打とか強制終了とかありますが、 1番簡単なのが、『PCのコンセント抜いて下さい』w.
SQL Server 7.0 の頃がどうだったかは手元に BOL がないので答えられないのですが、ビットに対してオイラなら「0 である」「0 じゃない」って考えますね。 ビットが 0 と 1 なのか、0 と -1 なのかってのはバージョンによって変わる可能性がありますが、0 は普遍（だと思う）からです。 開発言語で言えば、VB なんて VB 6.0 までは Boolean の True を 1 にすべきか -1 にすべきか、倍黒ソフトによってバージョンアップのたびに議論されてきました。
詳しい状況がわかりませんが、こんな技術情報がありました。 これは、SQL Serverへのアップサイジングですが、参考になるかもしれません。 参考URL：http://support.microsoft.com/kb/272384/
まあ、一介のデザイナーでプログラマではありませんが・・・。 チクッと同じような作業をしてみました。 CREATE TABLE Test (id_name VARCHAR(32) NOT NULL,fainal_value INT Default 1) これは、SQL SERVER 2000 に既定値を持つテーブルを作成するTransact-SQL文です。 周知のように、コマンドラインからバッチファイルとして実行することも可能です。 AccessからSQL文を発行して実行して見ると、確かに、既定値が定義されたテーブルが作成されました。 念のためにクエリアナライザでも実行しても同じ結果を得ました。 osql でも確認しました。 ということは、こんな感じでやればと思います。 さて、多分、ここまでは質問者も到達していることでしょう。 だとすれば、Default設定不可の列に設定しようとしているなどで失敗していると推察します。 Books Online の<DEFAULT 定義の作成と変更>を参照すれば、Defaultの設定には幾つかの条件があることが判ります。 そこら辺りを調べると解決すると思います。
どうしてもSQLServerManagementStudioExpressから実行せねばならない、というわけではないのなら、バッチファイルを作るのがよさそうです。 メモ帳などに osql -E -i ファイル名 という感じで書いて、.batという拡張子をつければバッチファイルの完成です。 このファイルをダブルクリックすれば中に書いてあるコマンドがコンソールで実行される、というわけです。 以上、ご参考までに。
「08001」でググってみたら、↓のサイトが出てきました。 これじゃないですか？ 参考URL：http://support.microsoft.com/default.aspx?scid=k …
ふと思ったのですが、LotNoがnvarcharなのであれば、 Dlookupの抽出条件の部分の引数は「'」ではさまないといけないのでは？ それと、引数がフォーム名までしか指定していないので、テキストボックス名まで渡さないとだめなのではないかと・・・。 Me![単価] = Dlookup("単価","原料マスタ","LotNo = '" & [Forms]![入力票]![LotNo] & "'") という感じです。 検討違いでしたらごめんなさい。
http://oshiete1.goo.ne.jp/kotaeru.php3?q=1127154 http://oshiete1.goo.ne.jp/kotaeru.php3?q=1341533
Page6のみの総数=Page6の総数-Page7の総数
> サーブレットをコンソールから実行するのって > どのようにするのですか？ 普通にstatic void main(String[])を作ってやればコマンドラインから 呼べます。クラスパスやドライバは設定ファイルを読んでくれる わけではないので個別に指定が必要ですが。
プライマリキーを設定することで、インデクスが自動的に作成され、既定値ではクラスタ化（近傍配置）も行われます。 (1)CREATE TABLE文の説明 http://msdn2.microsoft.com/ja-jp/library/ms17497 … (2)SQL Serverのインデクス・アーキテクチャ http://www.microsoft.com/japan/msdn/sqlserver/co …
s_husky です。 エラー確認しました。INはエラーでませんが＝は複数行の時にエラーが出ました。
思いっきり亀レスですが… Sybase 用のモジュールを使って接続したことがあります。 SQL Server 7 の時代の話なので、ご参考まで。
そのとおりです。 ぎりぎりの桁数にすると、拡張の際ないたりしますし。 プリミティブな処理では、割り切れる桁のほうが 処理が早かったりします。 このへんはｄｂのサーバーの方で調整ができるなら やっておいてソンはないです
実際に 2タイプの削除操作の際にバックでどんな T-SQL が動いているか、SQL Server Management Studio の [ツール]-[SQL Server Profiler] でトレースして確認することができます。 実験したデータベースは作って間もない、テーブルも作ってないデータベースです。 大きく違うのは、 [バックアップを削除し、データベースの履歴情報を復元する] にチェックを入れた場合は sp_delete_database_backuphistory というストアド プロシージが実行され、その後に DROP DATABASE が実行されるのに対し、 [バックアップを削除し、データベースの履歴情報を復元する] にチェックを入れなかった場合は DROP DATABASE だけが実行されていました。 （実際にはその過程でいろんな SELECT が動いてます） バックアップのファイルを物理的に削除するというよりは、システム DB などに記録されている「バックアップの履歴」を削除するというイメージじゃないですかね。 バックアップしたファイルは SQL Server からするとバックアップした瞬間から外部ファイルであって、SQL Server の管理外にあるファイルになるんだと思います。 余談ですが、SQL Server Profiler というツールはかなり便利なツールです。 Management Studio のような GUI ツールで DB を操作した時、実際に SQL Server 上ではどんな SQL 文を実行しているのかが分かりますので、例えば自作の Web ブラウザ版 Management Studio のようなツールを開発するのにも役立ちます。
二つのテーブルを同時にインサートする事は 不可能な為、やはり２回のインサート文が必要ですね (1)Ｂのテーブルへのインサートを行いその時にLEFT JOINで 　Ｂのテーブルを紐付け、ＩＤがNULL　の場合をインサートの 　条件とすれば、１と２の作業が行えます。 (2)(1)同様にＢのテーブルをJOINしインサートを行えば(1)の処理で データが存在する為、データは反映されると思います。
select A,min(B) from テーブル名 group by A; +------+--------+ | A | min(B) | +------+--------+ | 1 | 1 | | 2 | 2 | +------+--------+ 2 rows in set (0.00 sec) とかどうでしょう？
>deptidを出力パラメータに渡す方法 select @deptid=deptid from MST_Employee where EmployeeID = @UserID And PassWord = @PassWord という方法で渡せます。 ところで、この条件でヒットするのは1行だけなのでは？ パラメタ＝@RowCountの目的が、よく分かりませんが？ それに今の記述では、@RowCountには何も設定されていません。システムから返される@@ROWCOUNTの内容を、設定したいのでしょうか？ プロシジャとファンクションの定義と実行例を、参考までに示します。 1.プロシジャ (1)定義 create procedure dbo.funLoginCheck (@UserID char(5), @PassWord varchar(10), @RowCount int output, @DeptID char(2) output) as select @DeptID=deptid from MST_Employee where EmployeeID=@UserID And PassWord=@PassWord set @RowCount=@@ROWCOUNT (2)実行 declare @dept char(2) declare @rowcnt int exec dbo.funLoginCheck @UserID='U1',@PassWord='P1', @RowCount=@rowcnt output,@DeptID=@dept output select @rowcnt,@dept 2.ファンクション (1)定義 create function dbo.funLoginCheck (@UserID char(5), @PassWord varchar(10)) returns char(2) begin declare @DeptID char(2) select @DeptID=deptid from MST_Employee where EmployeeID=@UserID And PassWord=@PassWord return @DeptID end (2)実行 select dbo.funLoginCheck('U2','P2')
まったく存在しないものを検索するというのは無理な話なので、他にコード管理のテーブルを作ったりunionで作ったりして、その後joinするしかありません。 (1)表定義＆データ例 create table table1 (fID smallint, fName varchar(8), fItemCD char(2)); insert into table1 values(1,'山田','01'); insert into table1 values(2,'木村','03'); insert into table1 values(3,'田中','04'); insert into table1 values(4,'佐藤','02'); insert into table1 values(5,'高橋','03'); insert into table1 values(6,'川島','03'); insert into table1 values(7,'山下','06'); create table fItemCD_Master (fItemCD char(2), fItemName varchar(20)); insert into FItemCD_Master values('01','A'); insert into FItemCD_Master values('02','BB'); insert into FItemCD_Master values('03','CCC'); insert into FItemCD_Master values('04','DDDD'); insert into FItemCD_Master values('05','EEEEE'); insert into FItemCD_Master values('06','FFFFFF'); insert into FItemCD_Master values('07','GGGGGGG'); insert into FItemCD_Master values('08','HHHHHHHH'); insert into FItemCD_Master values('09','IIIIIIIII'); insert into FItemCD_Master values('10','JJJJJJJJJJ'); (2)検索 select M.fItemCD,count(T.fItemCD) as Rslt from fItemCD_Master as M left join table1 as T on M.fItemCD=T.fItemCD where M.fItemCD in ('04','05','06') group by M.fItemCD;
INSERTする側に対応する文字(文字コード)がなければ 登録されればどうでしょうか？
アンインストールに失敗した場合、再度インストール、再起動、アンインストール、再起動、再度インストールしろ、といいますが駄目でしょうか？（評価版だから）
・年の取得 DATEPART(yyyy, GETDATE()) ・月の取得 DATEPART(m, GETDATE()) ・日の取得 DATEPART(d, GETDATE()) ・数値変換(Smallint) CONVERT 関数で行う
一時テーブルを作成して、何らかの障害が起きた場合、セッションが切れてしまうはずですから、明示的にドロップする必要はおそらく、ありません。
SQL Server 2000 の情報ですが「1.2 SQL Server によるトランザクション管理」あたりが参考になるかと。 http://www.microsoft.com/japan/msdn/sqlserver/co … 上記 URL を含む検索結果 http://www.google.com/search?hl=ja&lr=lang_ja&ie …
参考になりそうなhpがありましたので、参考URLに書いておきます。 私は2005EXPRESSを使っているので断定はできませんが・・・助けになるかも知れないので、私の場合を書いておきます。 レジストリの値を確認してみてはどうでしょう？ 2005EXPRESSの場合、 HKEY_LOCL_MACHINE 　\SOFTWARE 　　\Microsoft 　　　\Microsoft　SQL Server 　　　　\MSSAL.1 　　　　　\MSSALServer にLoginModeという名前のキーがあります。 このデータの値が1だとWindows認証のみのモード、2だと混合モード（Windows認証とデータベース認証の両方が使える）です。 1になっていた場合、2に変更して、いったんサービスを停止して再開すればよいようです。 なお、デフォルトではsaログインは無効ですので、コンソールより C:\>sqlcmd -E -S .\SQLEXPRESS 1>ALTER LOGIN sa ENABLE 2>GO 1>ALTER LOGIN sa WITH PASSWORD='XXXXXXXX' 2>GO を実行します。（もしかしたら、これだけでいけるかも、ですね。） パスワードの変更は sqlcmd から実行可能です。 コマンドプロンプトから下記のコマンドを実行してください。 sqlcmd -E -S .\SQLEXPRESS 1>ALTER LOGIN sa WITH PASSWORD='XXXXXXX' 2>GO sqlcmd は OSQL に置き換わるものです。 （あくまでも、2005の場合ですから・・・参考までに。） 参考URL：http://support.microsoft.com/default.aspx?scid=k …
一つ上の質問の回答No.1に、SQL Server 2005 の osql の代わりのコマンドの使い方が紹介されています。 SQL Server 2005 に関するMicrosoft の説明と一致しているようです。
#1回答者です。 何となく、やりたいことが分かりました。 TitleDBの内容をヘッダのように表示し、それ以降にDataDBの内容を表示したいということですね？ UNIONを使う方法が、簡単だと思います。 (1)表定義＆データ例 create table TitleDB (Title1 varchar(50), Title2 varchar(50)); create table DataDB (memberNo char(5), memberName varchar(20), data1 varchar(50), data2 varchar(50)); insert into TitleDB values('好きな食べ物','好きな飲み物'); insert into DataDB values('0001','田中','ばなな','コーラ'); insert into DataDB values('0002','鈴木','りんご','ビール'); (2)検索SQL例 select 0 as SortKey,'会員番号' as 会員番号,'会員名' as 会員名,Title1 as タイトル１,Title2 as タイトル２ from TitleDB union select 1 as SortKey,memberNo,memberName,data1,data2 from DataDB order by SortKey ; この検索により、1行目にタイトル情報、それ以降にデータが検索できます。 SortKeyというのは、タイトル→データの順序保証をするために加えています。
スーツのデザイナでプログラマではありませんので参考程度に・・・。 質問者のコードを参考に SQL Server 2000にExcelからアクセスしてみました。 Private Sub CommandButton1_Click() On Error GoTo Err_CommandButton1_Click 　　Dim isError As Boolean 　　Dim oWK　　 As Object 　　Dim oDB　　 As Object 　　Dim rRec　　As DAO.Recordset 　　Dim strCon　As String 　　Dim strQ　　As String 　　strCon = "ODBC;DRIVER=SQL Server;SERVER=LAVIE;UID=sa;PWD=login007;DATABASE=Sales2006SQL" 　　strQ = "select * from [table1]" 　　Set oWK = DBEngine.CreateWorkspace("LAVIEWK", "LAVIE", "LAVIE", dbUseODBC) 　　Set oDB = oWK.OpenConnection("", dbDriverNoPrompt, False, strCon) 　　Set rRec = oDB.OpenRecordset(strQ, _ 　　　　　　　　　　　　　　　　dbOpenDynamic, _ 　　　　　　　　　　　　　　　　dbExecDirect, _ 　　　　　　　　　　　　　　　　dbOptimisticValue) 　　With oWK 　　　　.BeginTrans 　　　　With rRec 　　　　　　If Not .BOF Then 　　　　　　　　.MoveFirst 　　　　　　　　Do Until .EOF 　　　　　　　　　　If .Fields(0) = 1 Then 　　　　　　　　　　　　.Edit 　　　　　　　　　　　　.Fields(1) = "Z"　　　　' ロールバックされる 　　　　　　　　　　　　.Update 　　　　　　　　　　ElseIf .Fields(0) = 3 Then 　　　　　　　　　　　　.Edit 　　　　　　　　　　　　.Fields(0) = 1　　　　　' エラーが発生する 　　　　　　　　　　　　.Update 　　　　　　　　　　End If 　　　　　　　　　　.MoveNext 　　　　　　　　Loop 　　　　　　End If 　　　　End With 　　　　.CommitTrans 　　End With 　　rRec.Close 　　oDB.Close 　　oWK.Close Exit_CommandButton1_Click: 　　Exit Sub Err_CommandButton1_Click: 　　MsgBox "データの更新時にエラーが発生しました。" 　　Resume Exit_CommandButton1_Click End Sub ＊これでエラーを発生させるとトランザクションがロールバックされましたので多分OKかと。 ＊なお、ただ単に参照するだけであれば、全体に疑問があります。
s_husky です。 回数は、 SELECT Count(*) FROM TABLE1 WHERE 部課名='a' AND 社員NO=1 AND 入室時刻 BETWEEN '2006/01/01 0:00:00' AND '2006/01/01 23:59:59'; |(expession)| ---|------------ 　 1| 1|
Microsoft SQL Server Management Studio Expressも ダウンロードしていますか？ 参考URL：http://www.microsoft.com/downloads/details.aspx? …
マスターテーブルのトリガという機能を使っていると思います。 私も以前やっておりました。 Enterprise Manager をお使いならテーブルを表示して 右クリック=>全てのタスク=>トリガの管理で参照できます。
起動させなきゃいけないのは SQLServerAgent じゃなくて、SQLServer そのもののサービスじゃないですか？ [コントロール パネル]-[管理ツール]-[サービス] で MSSQLServer（名前違うかもしれません）を [右クリック]-[プロパティ] でプロパティを表示させ、[ログオン] タブに切り替え、どのユーザーでログオンしているのか確認します。 ローカル システム アカウントじゃなくて明示的にユーザーを指定しているのなら、パスワードが変えられちゃったか、そのユーザーに適切な権限がないんでしょう。
必要なEDITIONは何ですか？ 例えば、SQL Server 2005 Enterprise Evaluation Editionなら、評価版は下記URLです。 http://www.microsoft.com/downloads/details.aspx? … 用途や機能が限定されますが、無期限で無料で使えるEXPRESS EDITIONなら、下記URLです。 http://www.microsoft.com/downloads/details.aspx? …
#1、#3回答者です。 ビューの役割や使い方を説明しましたが、ビューとは何かを説明していませんでしたね。 ビューというのは、実体（DB中のデータ）を持たない仮想の表です。 ビューを利用時に、ビューで参照している表から、実際のデータが持ってこられます。 使う目的や使い方は、既に回答の通りです。
登録してあるサーバーを右クリック ⇒[SQL Server 登録プロパティの編集] にあります。
うるおぼえですが、動的ＳＱＬを利用すれば良いと思います。 S_SQL varchar(256); BEGIN -- 実行するSQL文 S_SQL := 'SELECT count(*) from ' || @tbl_name; -- SQL実行と結果取得 EXECUTE IMMEDIATE S_SQL 記述に自信がないので、『動的ＳＱＬ』で しらべてください！笑
select "name", isnull(sum(case when youbi in('月','火') then kingaku end),0) as "月～火", isnull(sum(case when youbi in('水','木','金') then kingaku end),0) as "水～金", isnull(sum(case when youbi in('土','日') then kingaku end),0) as "土～日" from 小遣い帳 group by "name"
DTS（データ変換サービス）ウィザードで、できたような。 詳しくはBooksOnlineをご覧ください。
「レプリケーション」で調べれば 見つかると思います。
SQL Server のログインユーザーあたりを作り直すとか。
私見ですが、MySQLがいいのではないでしょうか？ PHPを使用するということであれば、一番よく見かける 組み合わせですし。 調べる必要がある場合にも、ネット上の情報も多いし、市販本も けっこう色々発売されていると思います。 遊びレベルでしか使ってませんが、IISサービスは止めてしまって、Apacheサーバを使用するという方法もありますね。もし、Javaも使いたくなった時に、これならTomcatの導入も楽だと思います。 動作としては、JavaよりPHPの方が軽く動く感じです。
>SQLのどこが間違っているのでしょうか？ 最初の条件では、c列の値が01、02がヒットします。 二つ目の条件では、d列の値が、01、03がヒットします。 これにより、c列=01 & d列=03の行もヒットしてしまいます。 つまり、c列の値とd列の値の組で、「2件以上あるもの」という条件になっていません。 以下にSQL例を示します。 select * from t1 x where exists (select * from t1 where x.c=c and x.d=d group by c,d having count(*)>1)
「実行プランの表示」ではどうですか？ 参考URL：http://www.microsoft.com/japan/msdn/enterprise/p …
列dateは何型で宣言されているのでしょう？ また、hiniti、 hiniti2はどのような形式？ ("select * from ABC where date between #" & 　hiniti & "# and #" & hiniti2 & "# ;") ではどうでしょう？ select * from ABC where date between #2006/04/05# and #2006/07/04# ; となるように。
No4です。失礼しました。こちらの文法ミスです。 SELECT ID, Len(ID) AS C0, CASE when substring(ID, 1, 1)='A' THEN 1 Else 0 End AS C1, CASE when substring(ID, 2, 1)='B' THEN 1 Else 0 End AS C2, CASE when substring(ID, 3, 1)='C' THEN 1 Else 0 End AS C3, CASE when substring(ID, 4, 1)='D' THEN 1 Else 0 End AS C4, CASE when substring(ID, 5, 1)='E' THEN 1 Else 0 End AS C5, CASE when substring(ID, 6, 1)='F' THEN 1 Else 0 End AS C6, CASE when substring(ID, 7, 1)='G' THEN 1 Else 0 End AS C7, CASE when substring(ID, 8, 1)='H' THEN 1 Else 0 End AS C8, CASE when ID='ABCDEFGH' THEN 1 Else 0 End AS C9 FROM 台帳 WHERE (ID LIKE '%BCDEFGH')
ヒント：外部結合
Books Online にて、 [SQL Server 2006 Books Online]-[SQL Server データベース エンジン]-[データベース エンジンの操作方法に関するトピック]-[サーバーの管理方法に関するトピック]-[SQL Server Management Studio の操作方法に関するトピック]-[サーバーの認証モードを変更する方法] に書いてあります。 まず、Management Studio にて Windows 認証でデータベース サーバーに入ります。 左側ツリーの [サーバー名]-[セキュリティ]-[ログイン]-[sa] を右クリックして [プロパティ] を選択。 <ログインのプロパティ - sa> というダイアログが出るので、[全般] タブの [パスワード] へ適当なパスワードを入れます。 [状態] タブの [ログイン] が「無効」になっていれば「有効」にして [OK] を押します。 Management Studio にて、左側ツリーの [サーバー名] を右クリックして [プロパティ] を選択。 [セキュリティ] タブの [サーバー認証] を「SQL Server 認証モードと Windows 認証モード」に変更して [OK] を押します。 SQL Server を再起動する必要がある旨のダイアログで [OK] を押します。 Management Studio にて、左側ツリーの [サーバー名] を右クリックして「再起動」を選択。 もし Windows Server 2003 上で動いている場合、sa のパスワードを設定する画面で「パスワード ポリシーを適用する」にチェックが入っていれば、Windows Server 2003 で導入された「パスワードの複雑性」が適用されます。 具体的には、 ・8文字以上 ・ユーザーアカウント名の全てまたは一部を含まない ・A-Z, a-z, 0-9, !$#%などの記号のうち、3種類以上を使う などなど。
>サーバーだと該当クライアントのPCが新規登録の候補にすら表示され ていません。 サーバーにクライアントが正常に登録されていないようですね。 SQLサーバーのクライアント認証で「SQLサーバー認証」を使用すると、 そのサーバーに登録されていないユーザーでもSQLサーバーにはアクセスできるようになります。手順は １　SQLサーバーのプロパティ⇒セキュリティ⇒認証のところで 　　「混合モード（Windows認証とSQL認証）のほうを有効にします。 ２　セキュリティ⇒ログイン⇒新規ログインのところでSQL　SERVER認　　証の方を選択します。 ３　該当データベースに作成したユーザーを登録します。 この方式では、クライアントがSQLに接続する時は「セキュリティ接続」のチェックをオフにしないと接続できません。
SQL SERVER 2005ならROW_NUMBER()が使えるけど 2000なら面倒ですね
Program⇒MicrosoftSQLserver⇒サーバーネットワークユーティリティのところで、TCPIPのプロパティで既定のポートの番号を1433に設定できます。 できなかった場合はクライアント側のネットワークユーティリティで SQLサーバーのポート番号を指定する方法もあります。
やるべきは、 １、関連するテーブルに列を追加する。 ２、フォームを追加された列を参照するように修正する。 ３、新たに参照した列を表示・更新するコントロールをフォームに配置する。 という手順です。 Accessのヘルプの目次を開いて該当する箇所に目を通されると問題点が見えるかも知れません。 この一連の手順を詳細に書き出すと、Accessのヘルプそのものになります。
--基本はこれだけでもよいかと。。。 select * from TBL --テーブルロックを同時にかける方法 --だから、他の人がロックをかけていたら、ロックをかけれない --http://www.microsoft.com/japan/developer/library … select * from TBL with (TABLOCKX) --逆に待ちたくない場合 select * from TBL with (nowait)
C:\Program Files\Microsoft SQL Server\MSSQL\Data ここに無ければ、OSに捜索願いをだしましょう。 Windowsキー+F ファイル名は[*.mdf] 探す場所は[ローカルハードドライブ] それっぽいのがどこかにあるはず。
sSQL = sSQL & " 実在庫数=実在庫数-(実在庫数-棚卸数)" は、展開すると sSQL = sSQL & " 実在庫数=棚卸数 " と言うことですよね。 これでどうですか pvBase.CvtSQL(TDBGrid.Columns("実在庫数").Value) が気になりますが。
参考のＨＰ http://www.microsoft.com/japan/technet/prodtechn … バックアップについては http://www.microsoft.com/japan/technet/prodtechn … のバックアップ・リカバリ を参考にしてください。 ほか私の過去ログ http://okwave.jp/kotaeru.php3?q=2199096
GUI からっていうならクエリアナライザで。
CPUのspecが問題だと思います。 ご質問のデータ量より遥かに多いデータ量を運用しているSQLサーバー を管理していますが、CPUはIntelXenon2.80GHz2個で、負荷が50%を 超える事はありません。（DualCoreのCPUなので実質は４CPUということ になります。メモリーは2Gbyte。HDはシリアルATAでRAIDは組んでいません。SQLServerは2000です。
ODBCの設定はどうでしょう？ ２台とも同じですか？
http://support.microsoft.com/gp/lifecycle 一応ライフサイクルとして公表されています。 サポートの範囲にもよりますが発表後１０年が基本です。 （メインストリームサポート５年・延長サポート５年） 需要に応じて延長される事もありますが基本的にこの範囲で考えておいた方が良いでしょう。 SQLserver7.0の時はこんな感じです。 http://support.microsoft.com/default.aspx?scid=f …
>どのように結合したらよいのでしょうか？ テーブル2に対してテーブル1を２つ結合させれば出来ます。 下記ではテーブル1を２回結合させるためテーブル1とテーブル1_1として結合させています。 SELECT テーブル2.ID, (テーブル1.名前) AS 午前担当, (テーブル1_1.名前) AS 午後担当 FROM (テーブル2 LEFT JOIN テーブル1 ON テーブル2.午前担当 = テーブル1.[No]) LEFT JOIN テーブル1 AS テーブル1_1 ON テーブル2.午後担当 = テーブル1_1.[No] ORDER BY テーブル2.ID; INNER JOINを使うとテーブル2の午前・午後担当フィールドにNullがあった場合表示されないのでLEFT JOINとしてNullの場合も表示させるよう対応しています。 Nullは絶対ないという場合ならLEFT JOINをINNER JOINとしても大丈夫です。 これで出来ます。
SQLServerなどODBCが使えるDBには接続できると思いますが。 COBOLソースプログラム中に埋込みSQL文を記述してコンパイラを使って翻訳・リンク後して実行可能モジュールを作成すれば良いと思います。 NetCOBOLなどインターフェースに合わせた接続が出来るものも出ているようです。
#1です。 補足の通りです。 【バックアップのストアドサンプル】 SQL Server 2005 Expres 参考ＵＲＬ http://msdn2.microsoft.com/ja-jp/library/ms16570 … http://msdn2.microsoft.com/ja-jp/library/ms17020 … ================================================================ set ANSI_NULLS ON set QUOTED_IDENTIFIER ON GO CREATE Procedure [dbo].[DBのバックアップ] @Path nvarchar(50) = N'C:\DBバックアップ\', -- バックアップ先のフォルダ @Fname nvarchar(50) = N'ほにゃららDB.Bak'　-- バックアップの出力先ファイル名 as declare @BKF as nvarchar(100) set @BKF = @Path + @Fname BACKUP DATABASE ほにゃららDB TO DISK = @BKF WITH FORMAT, NAME = 'Full Backup of ほにゃららDB' return ================================================================ 上記ストアドをDBに登録します。 登録するには上記内容を、メモ帳形式で保存し、拡張子を.SQL とします。 仮に　"C:\BACK.SQL" とします。 SQLCMD　で即時実行するコマンドを入力します。 コマンドプロンプトで ============================================================ sqlcmd -E -P -S ほにゃららDB -d ほにゃららDB -s , -w 1024 -i "C:\BACK.SQL" ============================================================ で登録されます。 もし、エラーがあれば中断されます。 今回はこれをＯＳ側で制御する簡単な方法を書きます。 まずメモ帳で"C:\backUP.BAT" というファイル名で新規作成します。 ================================================================ sqlcmd -E -P -S ほにゃららDB -d ほにゃららDB -s , -w 1024 -Q "EXEC DBのバックアップ @PATH = 'C:\バックアップ先フォルダ',@Fname = 'ホニャララ_2006_06_3'" ================================================================ という内容を記入します。 このバッチファイル("C:\backUP.BAT")をうまくゆくかテストします。 コマンドプロンプトで実行してみます。 うまく行くことを確認したら 　Windows XP の　スタートップ・アクセサリ・シシテムツールの タスクマネージャを開きます。 これに先のバッチ"C:\backUP.BAT"　を定時に実行するよう登録すれば 指定時刻に実行されます。 結果はＤＢのＬＯＧとイベントビューワに記録されます。 ＤＢのＬＯＧについてはＭＳのホームページをご覧ください。 なお定期タスクはあえて登録しなくても上記方法で十分活用できます。変更も簡単なのでこちらをおすすめします。 ストアドの変数「@Pathと@Fname」に渡す内容を変更すればバックアップしたいＤＢや出力先も変更できます。 以上、参考まで
聞いているのはデッドロックの事ですか。 通常ロックは排他制御をする際にどのようにかけるかとか考慮しますけど。そのロックの事ではないですね。 デッドロックは排他制御の不備が原因で起こるのがほとんどだと思います。 テーブル再編成などはデータベース止めて処理するのでロックは起きないと思いますが・。 ユーザーは突然変な事をしでかしますからね。困るものです。 複数のファイルにまたがる排他制御を行う時にAファイルをロックしてBファイルのロック解放を待っていて別のユーザがBファイルをロックしてAファイルのロック解放を待ち続けるみたいな処理が進まないという事態に陥る。 これがほとんどとは言いませんが同様の原因によるデッドロックが多いのではないでしょうか。 排他制御の仕方・プログラムの設計に問題がある場合に支障が出るのでそこをしっかりやれば大丈夫だと思いますけどね。
WindowsXPは無理なようです。 参考リンク先でご確認下さい。 WinXPのhomeやProfessionalのSPにもよりますが、Personal、Developer、Desktop Engine、SQL Server CE 、Enterprise Evaluation Editionは可能なようです。 参考URL：http://www.microsoft.com/japan/sql/prodinfo/prev …
何を起動しようとしていますか？Enterprise Manager？サービス？ アンチウィルスのFWでポートを閉じていませんか？ OSは2000Sですか2003Sですか？
object_id だけだと select * from sysobjects で取得できる全てが対象となり、テーブルだけではなく、トリガやストアドなども対象となってしまうと思うのですが、、、 システムテーブルは関係ないと思うので、OBJECTPROPERTYでさらに絞ると確実ですよ^^ select case when exists( select * from syscolumns where id in ( --ユーザテーブル一覧に絞る select id from sysobjects where OBJECTPROPERTY(id, N'IsUserTable') = 1 ) and id = object_id('テーブル名') and name = 'カラム名' ) then 'ある' else 'ない' end
SQLserverに詳しいわけではないんですが・・ SQLserverのインスタンスは、サービスとして稼働しています。 サービスから見えるドライブレターは、デスクトップユーザから見えるものとは 異なります。 ユーザ権限の問題はありますが、ドライブレターだけの問題であれば、 ネットワークドライブを\\server\shareのようなUNC指定で記述することで どの環境からでも同じ物を指すことが可能です。 (webdavなどは別ですけどね） ただし、ユーザ認証の問題は別に存在しますので、それも解決しないと アクセス出来ません。 ユーザ認証については、どのようなネットワークドライブかによるので コメントできません。
SQLS→SQLSのリストアで、SQLユーザーを復元できない事象に合いました。SQLユーザーがバックアップPCに括り付いているのではないかと。 仕方ないので、私は一度復元後にSAあるいはadminで接続し、SQLユーザを削除、再作成で対応しています。
まず、使用する方法が異なると思います。 count(*) の場合には、全件（データがあろうが無かろうが）rowの件数分カウントしてくれます。 count(ID)に関しては、ID列にデータが入っているもの（null以外のデータ）件数をカウントしてくれます。 なので、上記での使い方が異なるのですが、 スピードで考えると、結果に対するカウントなので count(*)の方が早いと思います。（ID列にインデックスを指定しているのであれば、ほぼ互角だと思います） SQLServerで実行計画など見れるか分りませんが、そのようなツールで確認できれば、確実かもしれません。
たしか計算後の指定はhavingでやらないといけなかったのではないでしょうか。 SELECT Sum(売上マスタ.数量) AS 数量の合計, 売上マスタ.単価*数量の合計 AS 売上金額 FROM 売上マスタ Having 売上マスタ.数量 <> 0;
システム ストアドプロシージャの sp_rename みたいですね。 SQL Server 2005 の SQL Server Profiler でトレースしてみたらこんな感じ。 USE testDB; GO EXEC sp*_rename @objname = N'[dbo].[table1]', @newname = N'table2', @objtype = N'OBJECT' GO まぁ詳しくは Books Online で調べてみてください。
　ずい分前に雑誌か何かで読んだ記憶がありますが、ＯＤＢＣを介するが故に限界が低いのではないでしょうか？　高いレスポンスを要する処理には向かないと記述されていたと記憶しています。 　ＯＤＢＣによる中間処理を介するおかげでＶＢなどでのＤＢ関係の開発が簡単になっていると思いますが、ＯＤＢＣ自身はブラックボックスであり、その部分の高速化は開発元でなければ改善されませんからね。 　マイクロソフトもサーバ市場でのシェア拡大を狙っているでしょうが、必ずしもＯＤＢＣの改良による手段だけではないでしょう。ＷＥＢ技術が進み開発環境の変遷からＯＤＢＣは枯れた技術として存在位置を固めたままなのかと思います。
ちょっと裏技的ですが、別なキーを付けてソートすれば良いでしょう。 select * from ( select '1' as key, a from table where a IN (1,2) union select '2' as key, a from table where a = 5 union select '3' as key, a from table where a NOT IN (1,2,5) ) order by key, a というイメージで出来ると思います。 （手元にSQLServerがないので、細かい文法が間違っていたらごめんなさい。）
エラーじゃなくて警告なんじゃないですか？ http://support.microsoft.com/kb/818202 そういう仕様なんだと思います。
重大度レベル20 new_dts0002から２つのファイルをアタッチするときにログスキャンに渡されたログシーケンス番号(1458:16:1)が不正である。 データベースサーバーからデタッチされたデータベースに対してだけ実行されていないとか。 プライマリファイルにデータベース内のほかのファイルを指すシステムテーブルが格納されているがデータベースがデタッチされた後で移動されたファイルがこの一覧に指定されていないとか。 サーバーにアタッチするときデタッチしたデータベースのレプリケーションが有効になっていてレプリケーションの削除がされていないとか。
SQLServerのdatetime型の既定値は mon dd yyyy hh:miAM です。 そのままSUBSTRINGで抜き出せばMM DD YYYYになります。 日付型データを文字列として値を返すのは CONVERT(char,日付型フィールド,111) でYYYY/MM/DDの形式の文字列になります。
No.2です ウソをついたようですね ごめんなさい
カーソル宣言の部分だけ書かれても、そのカーソルが正しく利用されているかは判断できません。 ストアドプロシジャでカーソルを利用する、簡単な例を以下に示します。 ●表定義＆データ例 create table t1 (c1 int, c2 varchar(8)) insert into t1 values(1,'A') insert into t1 values(1,'AA') insert into t1 values(1,'AAA') insert into t1 values(1,'AAAA') insert into t1 values(2,'B') insert into t1 values(2,'BB') insert into t1 values(2,'BBB') ●ストアドプロシジャ create procedure sp_hoge @ic1 int as --カーソル使用例 declare @oc1 varchar(8) declare @oc2 varchar(8) --カーソル宣言 declare cr1 cursor for select * from t1 where c1=@ic1 --カーソルオープン open cr1 --FETCH（行の取り出し） fetch next from cr1 into @oc1,@oc2 --LOOP while (@@fetch_status <> -1) --エラーまたはEOFでない間 begin if (@@fetch_status <> -2) --EOFでなければ何か処理をする begin print @oc2 end --FETCH（行の取り出し） fetch next from cr1 into @oc1,@oc2 end --カーソルクローズ close cr1 return go ●ストアドプロシージャ実行 exec sp_hoge 1 go
>WHERE ColumnA = 1 になったり、 >WHERE ColumnA = 2 になったりします。 カーソル宣言のSELECT文で、条件式の値部分をパラメタ名にして可変にできますけど？ WHERE ColimnA = @parm1 「SQL Server 2005ではできない」と、誰に聞いたのですか？
SQL Server のバージョンぐらいは書きましょうよ。 SQL Server 2000 らしいですが、参考になりますでしょうか？ http://oshiete1.goo.ne.jp/kotaeru.php3?q=1422923
勉強の目的は、何でしょうか？ 特定のRDBMSを使うことが前提なら、そのRDBMSを使って勉強するのがいいと思います。 情報処理技術者試験などの受験のためなら、標準SQLと各RDBMSのサポート状況に注意する必要があります。 標準SQLと各RDBMSには、一般的に以下のような差異があります。 (1)標準SQLに規定されているが、RDBMSでは実装していない。 (2)標準SQLとは仕様差がある形で、RDBMSで実装している。 (3)標準SQLには規定されていないが、RDBMS独自で実装している。 各RDBMSは、サーバーPC＝クライアントPCという運用形態で、1台のPCでSQLを使用した操作が可能です。 オープンソースで有名なRDBMSでは、PostgreSQLやMySQLがあります。 (1)PostgreSQL・・・広範囲の機能をサポートしている反面、標準化前にサポートしているため、独自仕様となっている部分が多い。 http://www.postgresql.org/ (2)MySQL・・・頻繁にバージョンアップし、標準SQLにも準拠して来ているが、まだまだ最新の標準仕様に追い付いていない部分が目立つ。 http://dev.mysql.com/downloads/ 商用RDBMSでも、最近はExpressエディションとして、個人使用なら無料で使えるものも増えています。 (1)SQL Server 2005 Express http://www.microsoft.com/japan/sql/editions/expr … http://www.microsoft.com/downloads/details.aspx? … (2)Oracle 10g Express http://www.oracle.com/technology/products/databa …
ＭＳＤＥが起動しているのを確認して osql -E でプロンプトモードに入れませんか。
質問文にある URL というよりは、 「3.2.4 MSDE 1.0 から MSDE 2000 SP4 へのアップグレード」ですよね？ http://download.microsoft.com/download/7/c/2/7c2 … C:\MSDELog.log に何か記録されていませんか？ ユーザー名とパスワードはきちんと入れてますよね？ まさか AnAdminLogin とか AdminPassword をそのまま使ってませんよね・・・ それと DISABLENETWORKPROTOCOLS オプションは使わない方が良いのでは？
作成したユーザに作成したデータベースに対する権限が設定されていないのではないでしょうか？ ご確認ください。
MSSQLサーバーなら「SQL Server Enterprise Manager」-「データ変換サービス」-「データのインポート」 がGUIで出来るのでわかりやすいかと思います。 また、osqlを利用してバックアップとリストアを実行することで同様に可能です。 お役に立てたら幸いです。
例えば以下のようなSQLなら、SQL Server 2005でもサポートされています。 with team_costs as ( select team_name,sum(nenpo) team_total from players p,teams t where p.team_id=t.team_id group by team_name), avg_cost as ( select sum(team_total)/count(*) avg from team_costs) select * from team_costs where team_total > (select avg from avg_cost) order by team_name;
CSVデータをロードする際に件数を読み込んでグローバル変数にマッピングしてワークフローのプロパティ画面でオプションからタブを選んでActiveXスクリプトを使用にチェックをしてActiveXスクリプトプロパティで分岐の判定をするのはどうでしょうか。 If DTSGlobalVariables("グローバル変数名").Value = 0 Then 　正常終了として処理させる Else 　続いて処理させる End IF こんな感じではどうでしょうか。
C:\>osql -U ユーザー名 -P パスワード -d データベース名 で接続できませんか？　お試しください。
>とはどのようなエラーなのでしょうか？ ポート関連でエラーが出ているのではないかと思うのですが・・。 SQLServerにConnectionの際にurlにデータベース名の指定が必要ですがしてありますでしょうか？ SQLServerの既定の設定がリモート接続を許可しないようになっているとか。 デフォルトでTCPポートの1433でLISTENINGをしますがポートの設定はどうでしょうか？ 後はポートの開放が上手くされているか確認してみてください。
SQLサーバーを使わなくなって久しいですが… まず、ライセンスを購入しましょう。 そして、コントロールパネルにライセンスというものがあると思いますが、SQL Serverの状態はどうなっていますか？
もう見つけましたかね。 ここら辺とか。 http://msdn2.microsoft.com/ja-JP/library/ms190990(SQL.90).aspx http://msdn2.microsoft.com/ja-JP/library/ms189134(SQL.90).aspx
>コンパクトアクションはどこで実行したらよいのでしょうか EnterpriseManagerを使用して出来ませんでしょうか。 コンパクトしても余分なゴミを除くだけですが・・。 サーバを立ち上げなおして追加できるようになったなんてないですよね。 サーバー:メッセージ7399・・・タイムアウトが発生しました のようなエラー7399であれば何か問題が発生していることを示すプロバイダから返される汎用のエラーメッセージなんですがトレースフラグ7300を使って詳細なエラーメッセージをプロバイダから取得しないと何が原因でタイムアウトになっているのか不明です。 通常はリンクサーバーのリモートクエリを実行するとエラーメッセージでクエリの処理時間がtimeoutオプションの値を超えたときなどに表示されるのですが。 MicrosoftのSQLServer2000ServicePackはあてていますか？ http://support.microsoft.com/kb/290211/　で入手できますが。
s_husky です。 select ID, (round(round(数量 + (0.99) * sign(数量), 2),0,1)) from table1; 負の値については考慮していませんでした！ 面目ありません！
> CPUはPentiumDです。 であれば x86 です。
MSDE2000は利用したことはありませんが、SQL Serverではurlにデータベース名の指定が必要です。 Connection con = DriverManager.getConnection ("jdbc:microsoft:sqlserver://127.0.0.1:1433;databaseName=samdbname",user,pass );
有名どころでは、ODBC 接続になりますが CSE とか。 http://www.hi-ho.ne.jp/tsumiki/ 使ったことがないのですが、Vector ではこんなのとか。 http://www.vector.co.jp/soft/winnt/business/se34 … あとはマイクロソフトからの情報ではこれらとか。 http://kinshachi.ddo.jp/kurage/html/MT/comp/arch …
ADOを想定していますが、こういう質問ですか？（これだとマルチユーザには対応できませんが） cn.open "provider=・・・" cmd.activeconnection=cn cmd.commandtext="select distinct date_1 from Table" rs1=cmd.execute if not rs1.eof then do until rs1.eof str1 = str1 & "sum(case when 発送日='" & rs1(0) & "' then 1 end) as [" & rs1(0) & "]," rs1.movenext Loop str1 = left(str1, len(str1)-1) str2=str2 & " if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[V_TEST]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)" str2=str2 & " drop view [dbo].[V_TEST]" str2=str2 & " CREATE VIEW V_TEST AS SELECT 商品No," & str1 & " FROM Table Group by 商品No" cmd.commandtext=str2 cmd.execute end if cn.close
select 氏名 dateadd(mi, cast(substring(時間2,3,2) as int), dateadd(hh, cast(left(時間2,2) as int), [対象月]))- --AS 時間2 dateadd(mi, cast(substring(時間1,3,2) as int), dateadd(hh, cast(left(時間1,2) as int), [対象月])) --AS 時間1, from ・・・datediffは不要でした。
>保存の際に定義されているフィールドが多すぎますとエラー Accessのテーブル内のフィールド数の上限は255フィールドです。 例えばフィールドのプロパティを変更するとAccessは変更後の設定が適用された新しいフィールドを内部的に作成し変更前のフィールドを別に保持します。保存するまで実際には置き換わりません。 この変更前内部フィールドもフィールド数の制限に数えられるため表面的には255フィールドを超えていないように見えても内部では超えているということが起こり得ます。 質問を例にとれば フィールド数が255のテーブルの内の１フィールドをサイズ変更すると 254フィールド+フィールドサイズ変更フィールド+フィールドサイズ変更前フィールド=256 となります。内部カウントは256になりテーブルの仕様の255フィールドの制限をオーバーしてしまいます。そのため保存時にエラーが発生します。最適化を行えば内部カウントも最適化されます。 フィールドサイズが200を超えそうならテーブルの構成を考え直す必要はあると思います。 >フィールドサイズを変更して保存するだけでAccessのファイルサイズが大きくなる Accessは最適化し管理しないでいるとどんどんファイルサイズが大きくなっていきます。これはAccessではいたって普通の事です。 フィールドサイズを変更した元のフィールドがゴミデータとして残ればファイルサイズも増えます。 オプション設定で[終了時に最適化]をオンにすればいつも終了時に最適化してくれます。
#1 です。 > ODBC経由の接続にするのはどうなんでしょうか？ > ODBCの設定をユーザにしてもらうのは、敷居は高いでしょうか？ > インストーラでODBCの設定を自動化することはできますか？ ODBC 接続を使うにせよ、ODBC の後ろで（MDAC などのインストールによって提供される）ドライバが必要なのは変わりません。 手数から言えば、MDAC または何らかのドライバのインストールに加えて ODBC データソースの設定が増えるだけですので、最初の質問の解決にはなりません。 それを踏まえた上で ODBC 接続を使う場合ですが、 クライアントのレジストリに直接書き込む方法。 クライアントに配布するアプリケーションと同じフォルダ（または好きなフォルダ）に *.DSN ファイルを配置する方法。 などがあります。 レジストリに書き込むのであれば、インストーラの中で DSN の設定をレジストリに登録するように設定すれば良いと思います。 ファイル DSN にする場合は開発用マシンでファイル DSN を作成して、アプリケーションがそのファイルを読み込むように指定しておき、インストーラの設定で *.dsn ファイルをクライアントの任意の場所にコピーするように設定すれば良いと思います。 いずれにせよ、ODBC の設定をするだけインストール作業の手数も増える事には変わりありません。 どんな言語でアプリケーションを開発するのかわかりませんので、仮に .NET Framework を使うアプリケーションとすれば、 ODBC を使うよりもプログラムの中からネイティブに「.NET Framework Data Provider for SQL Server」を使ったほうが速いです。 その接続文字列は Appl.Config ファイル（昔で言えば ini ファイル）に書き込んでおく事も可能ですし、（あまりお勧めしませんが）アプリケーションの中に埋め込んでおくことも可能です。
sp_who とか。
OSQLから以下のクエリを実行してはどうでしょうか？ osql -S "本番環境のサーバ名" -U "ユーザ" -P "パスワード" BACKUP DATABASE [テーブル名] TO DISK='C:\backup.bak' osql -S "テスト環境のサーバ名" -U "ユーザ" -P "パスワード" RESTORE DATABASE [テーブル名] FROM DISK='C:\backup.bak' 的外れでしたらすみません。
MSDE または　SQl SERVER 7.0以上であれば DATEADD 関数で簡単に求めることができます。 >>例：200604の場合01～30という値を返す ということですが　詰まるとこ月末日が求められればＯＫ なわけですよね？ 例： 2006年4月の末尾を求める ---------------------------------------- Create Procedure 月末日計算 @P計算年月 as datetime = '2006/04/01', -- 計算したい年月を設定します。 @O月末日 as INT OUTPUT as declare @WK月末日 as datetime SET @WK月末日 = dateadd(d,-1,Dateadd(m,1,@P計算年月)) SET @O月末日 = day(@WK月末日) return 0 ----------------------------------------- 実際に使う場合は declare @OT結果月末日 as int 　EXEC 月末日計算 @P計算年月 = '2006/04/01', @OT結果月末日 output @P計算年月の日付部分は必ず　1日を指定してください。 もし、ストアドでなくクエリでというならば Access ではP計算年月にはパラメータクエリで日付を設定してください。 　　SELECT P計算年月,CAST(dateadd(d,-1,Dateadd(m,1,計算年月)) as Datetime) as 計算年月月末日, cast(day(CAST(dateadd(d,-1,Dateadd(m,1,計算年月)) as Datetime)) as int) as 月末日 もう少し具体的な使用目的などをがわかれば細かく説明できますが 日付のチェックをしたいなら　ISDATE 関数でチェックできます。
質問文を読む限りでは、パスワード情報を変更したために、データをダウンロードするシステムが使用しているSQL Server接続用ユーザ情報が不整合を起こしているのでしょう。 ODBCデータソース等の設定を確認してみては。 何処を調べれば良いのか、さっぱり解らない場合は、当該システムを設置した人に教えてもらえば。 （業者さんなら金額が発生するかも。）
データベースに書き込み・削除を行うのに必要なアクセス許可がないことが原因だとか。 SqlStr="Update Table SET ・・・ SqlStr="Delete From ・・・ などのSQLは正しいかだとか。 providerのreturned messageには何となっていますか？
テーブルBもしくはテーブルB.LotNoが取得できていないのではないでしょうか。 UPDATE dbo.テーブルA, dbo.テーブルB SET dbo.テーブルA.更新区分 = 1 WHERE (((dbo.テーブルB.LotNo)=dbo.テーブルA.LotNo)); か UPDATE dbo.テーブルA INNER JOIN A ON dbo.テーブルB.LotNo = dbo.テーブルA.LotNo SET dbo.テーブルA.更新区分 = 1; で回避できると思うのですが。
SQL*Plus と同じレベルであれば　コマンドラインからosqlというので良いかと思います。（osql -?　でヘルプ） 私の場合は普段は参考URLのCommonSQLEnvironment(CSE)というのを使っています。ODBC経由になりますが、トランザクション処理もできます。 参考URL：http://www.hi-ho.ne.jp/tsumiki/
(local) は？
標準アクセスポートが違うので共存することに関しては特に問題ありません。 ただ一台のマシンですから、当然全体的なパフォーマンスは落ちますし、メモリセッティングに気を配る必要は出てきます。
まあ、出すようにすることもできるとは思うんですが…。 SQLサーバーはNTドメインとは別の認証方法で運用することができます。（混合認証） SQLサーバーにアクセスするときも当然認証が必要なんですが、なぜ聞いてこないかというと、多分そのパスワードがプログラム内（または別の場所）に記述されていて、プログラム内でパスワードの認証を行っているからだと思います。
今、SQLServerの環境がないので試せないですが、 改行コードはMSの場合通常は{CR}{LF}なので replace(answerName, char(13) + char(10), '') で上手くいかないでしょうか。 もし改行コードが{CR}、または、{LF}のみの場合は、 replace(answerName, char(13), '')、または、 replace(answerName, char(10), '')で 試してみて下さい。
手順1 　ハイフンを含まないDBを作成(仮にaaaとする) 手順2 　ビューを作成する CREATE VIEW dbo.VIEW1 AS SELECT * FROM [aaa-01].dbo.bbb_table 手順3 　ビューにBCPINを行う >bcp aaa-01..bbb_table in c:\ccc.csv -E -c -t, -U sa -P dddd bcp aaa..VIEW1 in c:\ccc.csv -E -c -t, -U sa -P dddd この方法は、カラムにスペースが存在した場合などにもビューを利用することで、BCPINを行うことができます。 っていうか、ハイフンやスペースを含むのってあまりよくないですね^^;; アンダースコアへの変更が可能であれば、DB構成の変更をお勧めいたします。
Visual Studio 2003 でテーブルのデザインを変更中、メニューの [ダイアグラム]-[変更スクリプトの生成] コマンドまたは <テーブル> ツールバーの [変更スクリプトの生成] ボタンをクリックすると <変更スクリプトの保存> ダイアログが表示されます。 その中にスクリプトが表示されています。
同じライセンス管理マネージャの中で設定できませんか？
ストアドでも何でもいいと思いますが、1SQL文の発行で済む問題では無さそうですね。 結果的に、カーソルを「あーだこーだ」として処理を行うことになるので、SQLサーバ側/.NET側のどちらでも良いかと思います。 もし私であれば、今後誰がメンテをするかによって決めます。 ・今後ストアドがわかる人がメンテをしていくなら、こういう複雑な部分はストアドにやらせる ・けど、その確信が無ければ.NET側でやらせた方が無難
一つのフィールド内に特定の文字を含む行を検索ですか？ where column_name like '%keyword%'でOKでは？ (補足） データ量はどれくらいでしょうか？ 何百万レコードとか対象にするのであれば、検索に時間がかかってしまうので、フルテキストインデックスって技術を使うことになります。（2000では標準機能）
説明文中の列Classは、列Kubunと同じものですか？ 【例】 select SlipNo,ListNo,Kubun from A where SlipNo not in(select distinct SlipNo from A where Kubun=1);
>ACCESSのテーブルにあるデータを抽出条件としたい qDefに代入するSQLを SELECT USRID, MAIL FROM S_USR INNER JOIN T_USR ON S_USR.USRID = T_USR.USRID とすれば良いのでは。
以下のサイトが参考になれば良いのですが・・・・ 参考URL：http://www.microsoft.com/japan/sql/prodinfo/prev …
SQL文を示すと一発で回答が付くと思いますよ！
s_husky です。 質問を読み間違っていました。 　 |ID 　|Time | ---|----------------------- 　1|AAA|2006/02/01 0:00:10| 　 2|BBB|2006/02/01 0:00:10| という結果を欲しているならば... Select distinct ID , max(time) as time From job Where Time > '2006/01/01 23:59:59' and Time < '2006/02/01 23:59:59' group by id ※指定された範囲に合致するIDを一意に抜き出し、その間のtimeの最大値を取得する。 ※これで、事実上、同一の結果が求まると思います。
#1です。 SQLServer7環境なので、若干違うと思いますが。 ローカルで入って、masterデータベースのシステムテーブルにある、「sysservers」のカラム「srvname」、「datasouece」、「srvnetname」を新しいコンピュータ名に変えれば使えるようになるかと。
そのアクセスログを何に使うか？ で決めたらいかがでしょうか。 アクセス数が知りたいだけなら、ＤＢにアクセスカウントだけ格納していけばよいと思います。 画像ごと、日ごと、月ごとなどなど 何かトラブルがあったときの対応だけなら、テキストがよいと思います。 取り出してEXECL等で検索も思いのままです。 大きくなったら簡単に削除できるし。 何に使うか決めてない、とりあえずログ！！なら、 テキストがよいような...
No1のGoogle検索が精一杯です。 それ以上は、ルール違反です。 特定のHPを示唆する検索ワードも厳禁ですので悪しからず！
#2です。 intoじゃなくてasでした。
1つ目の方法としては、 DB に作成したストアド プロシージャのパラメータを使っているので制御の必要なし。 2つ目の方法としては、 DataAdapter の InsertCommand や UpdateCommand で Parameter を使うので、結局コレもストアド プロシージャのパラメータと同じ理由から制御の必要なし。 たぶん Haule さんが行っている方法はプログラムの中で動的に SQL 文を作成されていると思いますが、これらは "SQL インジェクション" と呼ばれるセキュリティホールになりやすいので、なるべくパラメータを使用した方法にしたほうがいいですよ。 SQL インジェクションについては http://www.google.com/search?hl=ja&lr=lang_ja&ie … とか http://msdn2.microsoft.com/ja-jp/library/ms16195 …
同期の実行は 連続して実行の場合これは通常トランザクションレプリケーションの場合です。 要求時に実行の場合これは通常マージレプリケーションの場合です。 トランザクションレプリケーションの同期はディストリビューションエージェントが更新・挿入・削除などの変更をディストリビューションデータベースからサブスクライバに転送することでマージレプリケーションの同期はマージエージェントがサブスクライバからパブリッシャに変更をアップロードしパブリッシャからサブスクライバに変更をダウンロードすることでデータは集約されて最終的にパブリッシャとすべてのサブスクライバでデータ値が同じになります。 この辺が違うところです。 >どちらが適しているのでしょうか レプリケーションのパブリッシングにローカルディストリビュータを使用するのかリモートディストリビュータを使用してパブリッシングを構成するのかを考えれば良いかと思うのですが・・。 リモートディストリビュータはマージレプリケーションよりトランザクションレプリケーションでよく使用されると思います。 トランザクションではレプリケートされたすべてのトランザクションの書き込みと読み取りがディストリビューションデータベースに対して行われるのでディストリビュータが果たす役割が大きくなりマージでは普通プルサブスクリプションが使用されるのでディストリビュータですべてのエージェントが実行されるのではなくて各サブスクライバでエージェントが実行されます。 この二つの観点から判断しても良いと思いますが。
＞＃２どの ＞UPDATE B_table SET date = (SELECT date FROM A_table where code = B_table.code) このSQLだと、Ｂに該当するデータがＡに無い場合、B.dateにNULLが設定されます。 WHEREで更新対象を絞るのを忘れると、悲しい結果になりかねません。 UPDATE B_table SET date = (SELECT date FROM A_table where code = B_table.code) WHERE date in (select date from A_table) とか UPDATE B_table SET date = (SELECT date FROM A_table where A_table.code = B_table.code) WHERE exists(select 1 from A_table where A_table.code = B_table.code) と書くのが良いかと。 SQLserverらしく、UPDATE ～ FROM構文の方が、効率は良いですけどね。（たぶん）
SELECT name from table1 Order by yomi; 　　 |NAME　　　　　　　　 | ---|-------------------------- 　 1|井上　　　　　　　　　　| 　 2|大井　　　　　　　　　　| 　 3|佐藤　　　　　　　　　　| ここは、素直に[読み]列を追加されたらどうでしょう！
Access と SQL Server は、「似て非なるもの」と言えます。 似: 同じ、リレーショナルデータベース言語。 非:Access は、スタンドアロン向き。SQL Sever はC/Sシステム向き。 SQL Sever は、Oracle とか Informix とかの Unix版データベース言語のPC版の一つに分類されると思います。 フロントエンドの開発自体は、Ａｃｃｅｓｓ.adpを利用すれば、一部の機能（ストアドプロシージャ）を無視すれば、全く、同一の作業と言えます。 Ａｃｃｅｓｓ　の特徴として、テーブル全体のデータをやり取りしないとC/Sシステムが構築できません。 これに対して、SQL Sever は、Ａｃｃｅｓｓ.adp側にテーブル全体を渡す必要がありません。 テストしたところ、SQL SeverでC/Sシステムを構築するとAccessのそれの50倍速以上で動作するようです。
開発であるならＭＳＤＮからダウンロード可能ですが 運用はだめです、、というかできません
サブクエリを好まないかもしれないので 少し冗長ではありますが CREATE PROCEDURE usp_testA AS BEGIN SELECT A.filed1, A.filed2, (CASE A.filed3 WHEN 1 THEN 'SSS' ELSE 'TTT' END )ac_test, B.filed1, (CASE WHEN B.filed5 = 1 THEN 'WWW' WHEN B.filed5 = 2 THEN 'XXX' WHEN B.filed5 = 3 AND A.filed3 = 1 THEN 'SSS' WHEN B.filed5 = 3 THEN 'TTT' ELSE '???' END )ac_value ・・・ というのはいかが？
s_husky です。 Ｎｏ５の回答を確認しました。 　　　|ITEMID1|ITEMID2|ITEMID3| ----|--------------------------------- 　　1| 　　　　2| 　　　　　1| 　　　　0| 　　2| 　　　　0| 　　　　　0|　　　　　1| 　　3| 　　　　1| 　　　　　1| 　　　　 0| ID Date 　　Member ItemID 1 20060201 1　　　　　　 1 2 20060201 1　　　　　　 1 3 20060201 2　　　　　　 2 4 20060203 2　　　　　　 3 5 20060204 3　　　　　　 1 6 20060204 1　　　　　　 2
例えば、列[区分]と[販売単価]を持つ表＜商品枝版情報＞というのがあるとします。 [区分]毎に[販売単価]の平均を求めるには、 SELECT 区分, AVG(販売単価) FROM 商品枝番情報 　　　　　　GROUP BY 区分 というSQL文になります。
ややこしいですがsp_indexesは分散環境で使用します sp_statisticsを使用してください
Structured Query Language直訳すると構造的問い合わせ言語となります。 元々は、IBM社が独自プログラミング言語RPGIIIで開発されたQueryからの発展版で、RDB（リレーショナルデータベース）の操作に利用します。 RDBとは例えば、名簿、住所録と電話番号表、メールアドレス帳がバラバラにあるとします。必要に応じて名簿の名前を基準に電話番号やメアド、住所を探しますが、これがRDBの考え方です。 SQLは「データベースAの項目A1とBの項目B1とB2、Cの項目C1とC4を名前順で並べ替えて表示して下さい」と言う様な命令を書く言語です。（データベースの事をSQLではテーブルと言います） 「それならエクセルやアクセスと同じ」になりますが、それらで作られたファイルは専用ソフトでしか、使えません。SQLはソフトを問いません。それが一番の強みです。 Serverはテーブルを集積する場所です。 つまりSQLサーバーはSQLが使えるソフトからデータを呼び出せる様にするソフトと言えます。
#1、3です。 言い忘れたことをひとつ そういえば大昔に同じ質問を@ITの掲示板で見かけた気がします たぶんDatabase Expartだと思います。検索してみてください。 http://www.atmarkit.co.jp/bbs/phpBB/index.php そのときのシステムテーブル(sysobjectsやsyscolumns)はバージョンによって仕様が変更になる可能性があるので、できるだけSQL-92準拠のInformation_schemaを使用したほうがよいと、どなたかが発言されてました 実際に2000と2005ではシステムテーブルに仕様変更があったみたいですし、ver7.0と2000も違います
私の環境ではreturnで問題ないみたいです 逆に IF @@ERROR = 0 BEGIN [SQL文2] END とすればよいのではないでしょうか？もしくは IF @@ERROR = 0 　GOTO ENDLABEL [SQL文2] ～ ENDLABEL: 最終行にラベルを定義してgotoで抜ける方法もあります
SP2はDCOMを使ったリモートデバッグが出来なくなっているのでポートは自分で開けなくてはダメとか色々あるようです。 下記のサポートから順次参照してみてください。 参考URL：http://support.microsoft.com/default.aspx?kbid=8 …
Dim strSQL As String Dim cn As Object Dim rs As Object Set cn = CreateObject("ADODB.Connection") Set rs = CreateObject("ADODB.Recordset") strSQL = "select abc.フィールド名 from abc where No = '" & No & "'"" Set rs = cn.Execute(strSQL) ざっとですが・・こんな感じで行けませんか。
「SWL Server 7.0 MSDE 完全トレーニングテキスト」という書籍に書いてありました。 "SELECT @hoge=" の書き方は SQL Server 6.5 までの書式で、SQL Server 7.0 以降は "SET @hoge=" の書き方を推奨しているようです。 ただし SELECT を使う方法も依然として大丈夫です。 個人的な意見ですが、変数への代入などは SET を使った方が読みやすいかな、と思ってます。 SELECT がやたらと出てくると見づらくて・・・
OKですが、 DBが使用しているファイルは最適化されません。 DBが使用しているファイルも最適化したいなら、 停止してからです。 DBを使用している業務はどうなのでしょうか？ もし、パフォーマンス的にクリティカルなら、 同時に実行しないほうが良く、 可能であれば、保守時間にDBを止めてデフラグを かけた方が良いでしょう。
なぜドキュメントを読まないで作業しちゃうんでしょうか・・・ 解凍先のフォルダに ReadmeSql2k32desksp.htm というファイルがあって、 目次に「3.2 MSDE 2000 SP4 Setup の実行」があって、 その記事の中に「3.2.2 MSDE 2000 の既存のインスタンスの SP4 へのアップグレード」という項目があって、 そこにすべて書いてありますよ。 さらに「3.2.3 MSDE 2000 SP4 の新規インスタンスのインストール」を読めば、SP4 用のファイルでインスタンス名付きの新規インストールが行われてしまった理由も理解できると思います。 ちなみに上記ドキュメントは SP4 のダウンロード ページ（http://www.microsoft.com/downloads/details.aspx? …）の下部にも直リンクで公開されています。 http://download.microsoft.com/download/7/c/2/7c2 … 付属するドキュメントのうち、"ReadMe" は必ず読むようにしましょう。
http://www.microsoft.com/japan/msdn/sqlserver/co … こちらのページの「3.SQLServerAgent のサービスアカウント」の章の の中の「ローカルシステムアカウントを指定した場合は・・・・」 に今回の件は関係していませんか？
http://www.microsoft.com/japan/msdn/data/odbc.asp 例えばodbc経由で接続できます。 参考URL：http://www.microsoft.com/japan/msdn/data/odbc.asp
＞strDBName = RS.Fields("dbNm").Value '(1) これで何を求められているのでしょうか？ フィールド名であればRS.Fields(i).Nameですよね。
行番号を150000で割った余り 参考URL：http://www.microsoft.com/japan/msdn/sqlserver/co …
http://www.microsoft.com/japan/msdn/sqlserver/co … http://www.microsoft.com/japan/msdn/sqlserver/co … 参照してみてください。 参考URL：http://www.microsoft.com/japan/msdn/sqlserver/co …
有りました。 データベースクラスタリングミドルウェアです。 ご希望の動作な気がします。 但し、使った事は無いので自信は無しです。 参考URL：http://pcweb.mycom.co.jp/news/2006/01/31/344.html
Web サーバ側は何で作っているのでしょうか？ 例えばストアドプロシージャ側で CREATE PROCEDURE SearchContents (@sqlWhere nvarchar(255)='') AS DECLARE @query nvarchar(500) SET @query = 'SELECT * FROM hoge ' + @sqlWhere EXEC sp_executesql @query GO ってのを作っておいて、 Web サーバ側の言語で、 検索文字列を分解する。 WHERE に続く部分の SQL 文字列を生成する って処理を行って、ストアドプロシージャ「SearchContents」に引数として、生成した WHERE～ の部分を与えるってのはどうでしょうか？ もちろん、不正な文字列が入力されていないかとか、文字列は長すぎないかとか、SQL インジェクションになりそうなものは排除するようにする必要があります。
このようなSQL文では如何でしょうか？ SELECT * FROM goo WHERE (((goo.Date)<(SELECT Max(Date) FROM goo) And (goo.Date)>(SELECT Max(Date)-2 FROM goo)));
SQLServerにはその機能は無いようです。但し、条件付で似たような処理を行わせることは可能です。 条件 １．取得したいSELECT結果はソートしたものである ２．必ず取得レコード数ある（5～10の場合、10レコード以上ある） 取得方法 １．内部のSELECT文で10レコード昇順で取得 ２．１の結果を5レコード降順で取得 SELECT TOP 5 * FROM ( SELECT TOP 10 * FROM TABLE ORDER BY TABLE.KEY ) A ORDER BY A.KEY DESC
-iオプションを使いましょう。 C:\>osql.exe -S server -U sa -P pass -i inputfile.sql C:\>isqlw.exe -S server -U sa -P pass -i inputfile.sql 　この"inputfile.sql"がファイル名です。インクルードはちょっと分かりません。
自信なしですが、 ・ODBCドライバがサポートしていないデータ型を使用している ・テーブル名、項目名に予約語が含まれている ・主キーがついていない という方面でも疑ってみてもいいかもしれません。
> あと、エンタープライズマネージャーで行なってい> た、バックアップのスケジュール管理の > 方法が分からず苦戦しています。 > どこで設定すればよいのかご存知であれば教えてください これって Express Edition では無理じゃなかったかなぁ・・・ エージェントのジョブって Express では作れなかったような。 んなもんで「今まではお客さんに付けるシステムに MSDE をくっ付けることが多かったけど、2005 ではダメかもね」てきな話題が一時期 ML で流行ったような。 まぁ MSDE が「こんなんで何故無料なの？」といった大盤振る舞いでしたからね。 http://www.microsoft.com/japan/sql/prodinfo/feat … http://www.microsoft.com/japan/sql/prodinfo/feat …
一部のコンポーネントを除きインスタンスはセットアップでSQLServer2005にアップグレードできます。 ほとんどのアップグレード操作はセットアップによって実行できます。 参考URL：http://msdn2.microsoft.com/ja-jp/library/ms14424 …
select * from X as X1 where exists ( select a from X group by a having a = X1.a and max(b) = X1.b) こんなのもアリかな？
SQL Serverでは ・テーブルや列名などは「識別子」 ・文字列や数字などは「リテラル」 と呼ばれています。 それぞれを区別するために通常は、 識別子はそのまま表記し リテラルにシングルクォーテションで括って表記します dateaddのdは識別子なのでそのままでの表記になります しかしSQL-92(国際規格)では識別子をダブルクォーテーションで括る表記を認めているため SQL ServerではSQL-92の表記をサポートするためのオプションが存在します SET QUOTED_IDENTIFIER OFF select dateadd("d",1,getdate()) --エラーになります select "ABC" as col1 --正常に動作します SET QUOTED_IDENTIFIER ON select dateadd("d",1,getdate()) --正常に動作します select "ABC" as col1 --エラーになります クエリアナライザでは規定値でOFFの状態となっています 変更は[ツール]-[オプション]-[スクリプト]や上記のSETコマンドを使用することで可能です 一方Accessなどではリテラルをダブルクォーテーションで括る事があるので ツールの方から自動的に上記のコマンドが暗黙的に実行されOFFになっているようです SQL Server2000で確認しましたが、多分Ver7でも同じだと思います 詳しくはクエリアナライザのヘルプで「SET QUOTED_IDENTIFIER」を参照してください
MDBの場合、ユーザ定義関数はVBAでモジュール内に書いていましたが、 ADPでは、T-SQLでユーザ定義関数を書きます。 http://www.microsoft.com/japan/msdn/library/defa … 参考URL：http://www.microsoft.com/japan/msdn/library/defa …
おはようございます。 ライセンスに関してはマイクロソフトのサイトに書いてある情報を参考にしながら、マイクロソフトに直接電話して聞くのが一番ですよ。 なぜかと言うと、 ・マイクロソフト以外の情報源の場合、内容に責任がない。 ・マイクロソフトのサイト上の情報だけだと受け手の感じ方にバラつきがある。 という理由です。 ライセンスは難しいですからね。
><% @Transaction=Required %> <%@language="VBScript"　Transaction=Required %> では >[トランザクションマネージャ通信] 分散トランザクションコーディネータ(MSDTC)を使っていますよね。 [プログラム]→[管理ツール]に[コンポーネントサービス]がありませんか。 なければ[ファイル名を指定して実行]dcomcnfg.exeと入力し[OK] をクリックし[コンポーネントサービス][コンピュータ][マイコンピュータ]を順に展開します。[マイコンピュータ] を右クリック[プロパティ]で[セキュリティの構成]をクリック。そこに[トランザクションマネージャ通信]がありませんでしょうか。 分散トランザクションの実行を許可するには[トランザクションマネージャ通信]の[受信を許可する]をオンにします。 [MSDTC]タブにある[ネットワークDTCアクセス]をオン。 これでMSDTCのネットワークトランザクションを有効にします。
.netのDataGrid側に問題があるように思われます。 プロパティの設定を確認してみては？
　＃１です。 　SQL Server 2000で同時接続ライセンスが廃止されたという情報は知らなんだ・・・・。という事は30CALが必要ですな。さらに＃１で言っているインターネットコネクタライセンスはLAN内のWebアプリに対しては使えない。 　つまり、＃２、＃３、＃４さんの言う通りです。 　ところで、「HTTPクライアント数の10%～30%のCALを用意する」というのも、DBMSがSQL7で同時接続ライセンスを使う場合の話で、例えば100人が該当のWebアプリを使っている場合、同時アクセスの数は正確に計測するかまたは100窓の場合ページビュー(=HTTPコネクションがある=Webアプリが動いている=DBにコネクションをはっている)がその10%～30%くらいと算出するのが一般的ですよ」とMicrosoft正規代理店の人に教えられたので信用していたが一般的では無いのですか・・・・。 　もっともこれも同時接続ライセンスが無くなってしまったという2000以上は無意味だ。 　これ聞いたん3年前(つまり、既にSQL2000が出ていた)の話なんやけどなぁ。 　結論として、私が＃１で言った内容は嘘でした。
シングルクォートでくくってください。 Update r_event Set ew_date = '2005-01-14'
最適な方法は分かりませんが。 1. SQLで改行を"<br/>"ではなく"&lt;br/&gt;"に置換し、XSLで<xsl:value-of select="." disable-output-escaping="yes" />とする。 2. SQLで改行を"<br/>"に置換し、XSLで<xsl:copy-of select="node()" />とする。 どちらかでいけそうに思います。
replace([Question]),char(10),'<br />') AS Que, replace([Answer]),char(10),'<br />') AS Ans 上記の([Question])と([Answer])部分ですが、( )の右の括弧は不要なのではないでしょうか。 質問と関係のない回答で失礼しました。
価格.com http://kakaku.com/prdsearch/detail.asp?prdkey=37 … 無料版の「SQL Server 2005 Express Edition」がお勧め http://www.atmarkit.co.jp/bbs/phpBB/viewtopic.ph …
「操作中」っていうのが微妙に心配・・・ 編集用の画面を開いてから閉じるまでずっと参照も禁止するとか・・・
随分前に同じメッセージを見たことがあったのですが、私の場合同ＫＢであっさり解決できたので、それ以外の現象・原因を想定してませんでした。もっとも、それ以外に実際思い付かないのですが。 既にご覧になったかも知れませんが、No.1 に記載したリンク先ページの [原因] のところにあるＫＢや 827422 などでもダメでしょうか。
CREATE TABLE temp AS SELECT * FROM distributors; DROP TABLE distributors; CREATE TABLE distributors AS SELECT * FROM temp; DROP TABLE temp; SQLServerの場合はわかりませんが、テーブルの再作成という事では。独自で拡張しているなら、alter tableだと思いますが。 参考URL：http://www.postgresql.jp/document/pg653doc/j/use …
ODBC経由での接続と仮定し、以下説明します。 2台目のクライアントのSQLServer用ODBCドライバが古いということは考えられませんか？ ODBCでデータソースを新規作成する際、SQLServer用のドライバが一覧表示されると思います。 （SQLServerであれば、「SQLSRV32.dll」がドライバの実体のはずです。） そこの画面でドライバのバージョン、更新日時が表示されると思いますので、各々を確認してみてください。 1台目のクライアントのものよりバージョンが古ければ、バージョンを上げてみられることをオススメします。 ＃過去、この対処で類似事象をクリアした経験があります。 　（その際のクライアントOSはWinXP Proでした。）
まずサーバー上でSQLを叩いた時はすぐ結果がでるんですかね。 経験上、テーブル構造とSQLを改善すると処理速度が全然違ってくる場合があります。（６時間かかってた処理が３０分で終わるとか・・・） データ量が多いのが問題であれば、一度に表示する件数を制限して、表示する分だけ受け取って表示する等どうでしょうか。
CommandオブジェクトのCommandTimeoutプロパティがデフォルトで３０秒ConnectionTimeoutは１５秒のはずですがもっと時間が掛かるようなSQLでも発行しているのでしょうか？ CommandTimeoutやConnectionTimeoutに0を設定して無制限に待機するか・・。 ストアドプロシージャを走らせるときにタイムアウト値を無制限に設定すればどうでしょうか。
アナログなやり方で恐縮ですが。。。(^_^; １．「ALTER TABLE ADD...」で列追加 ２．ターゲットとなるテーブルに関する外部参照制約を全てDisableに ３．INSERT INTO （新テーブル名） SELECT （望む順の列名） FROM （旧テーブル名）; ４．Drop Table （旧テーブル名）; ５．ALTER TABLE （新テーブル名） RENAME TO （旧テーブル名）； ６．制約を再作成 あまり自信がありませんが、こんな具合でいけませんかね・・・。 ＃エリアナライザ的な書き方でなく、重ねて恐縮です。
クライアントのみがインストールされているPCのEnterpriseManagerに SQLServer2000のサーバー本体がインストールされているPCが見えていますか？ もし登録されていない場合は新規サーバーを登録してみてください 登録や接続ができない場合はそのサーバー自身のEnterpriseMnagerでセキュリティのログインを確認してください。 ドメインユーザーアカウントが登録されていない可能性があります
UPDATE Table1 SET data = Left(data,1) + REPLICATE('x', Len(Data) -1) これですと、任意の文字列と置換することができます。
>それにしてもコネクションとトランザクションオブジェクトを別々に >渡してやる必要性がよく理解できません。コネクションオブジェクトから >トランザクションオブジェクトも参照できるのでは？と思うのですが・・・。 たしかに私も腑に落ちない・・・気がします なにか別に設定が必要な理由があるのかも知れませんね 複数のトランザクションが存在する場合に指定が必要になるのかも！ 私の過去のコードにはしっかり sqlCommand.Transaction = tran がありました（いつの間にか記述してたみたい） すいません。#2ではまったくその事に触れていませんでした 憶測での回答になってしまいますが トランザクションが割り当てられたコマンドが実行されたときに 自動的にBegin Tranされ トランザクションが割り当てられていないコマンドが実行されたときに 自動的にCommit Tranが実行されてしまうのかも知れません 時間があったら実証して見たいと思います
もうだいぶ時間が経っているので解決しているかもしれませんが、 私も(恐らく)同じ問題にぶち当たって調べていたところだったので、 今後調べる方の参考にもなるかと思い、私の場合の解決方法を投稿しておきます。 EnterpriseManagerでテーブルを編集した後、 編集した行にフォーカスが当たったまま更新を実行すると、このエラーが起きるようです。 編集した行から他の行へ一度フォーカスをはずしてから実行すると、正常に更新されます。 違った原因で起きている場合もあるかもしれませんが、 このエラーが起きたときは一度試してみてください。
> Management Studioが使ってみたいです。。。 ご存知かもしれませんが、ExpressEditionでもSSMSE CTPなら使えますよ。念のため。。。 （いずれはCTPではなく、正規品もいけるようになるはずですが。。。） ＜SQL Server Management Studio Express (SSMSE) 　　Community Technology Preview (CTP) を入手する方法＞ http://support.microsoft.com/kb/907716 > なんでダウンロードできないでしょうね？？？ > まだ時期ではないかもと思ったり。。 > それならあのページの挙動がおかしいです。 それはやっていないのでなんとも・・・。(^_^;
そもそもWindows認証というのは、現在Windowsログオンに使用 しているログオン名を使って、MSDEにもログオンするという 設定です。 Windowsのログオン名はMSDEにも登録されていますか？登録して いないのであれば、自動的にguestが使用されます。 パソコン名では認証できません。認証はログオン名だけです。 もし、Windowsのログオン名が分からないということでしたら、 コマンドプロンプトを開いて、「set」というコマンドを実行して ください。 「USERNAME=」の後に書いてあるのが、ログオン名です。
SQL Serverはあまり詳しくないんですが、TOP句を組み合わせて使うのが一般的なようです。 http://www.atmarkit.co.jp/bbs/phpBB/viewtopic.ph … ORACLEならROWNUMで簡単にできるんですけどね。
試せるようであれば、下記のやり方を試してみてください。（確実に上手くいくかどうかはわかりませんが・・・） １．SQLSv2000のデータベースをデタッチする。 ２．デタッチしたデータベースのmdfファイル, ldfファイルをSQLSv2005でアタッチする。 データ類はこれですべて移行されると思います。 ※かならずバックアップをとってから作業をしてくださいね。 それと、もう少し環境を詳しく書いたほうがいいと思います。そのSQLSv2000と2005は、同一PCなのかどうか、試してみて失敗したことなど・・・。 コメントもつけづらいと思いますよ
SQL Server(2000時点)にはOracleのnowaitにあたるものはないと思います かわりにタイムアウトを設定して最終エラー番号を取得するしかないでしょう。 set lock_timeout 3000 <--例は3秒のタイムアウト select ～ update ～ select @@error <--正常終了は0、ロックによるタイムアウトが発生した場合は1222が返されます
#2です。回答し忘れました >エンタープライズマネージャーからテーブルデザインの書き出しってできますか？ エンタープライズマネージャーでは少なくとも私はその方法を知りません。 テーブルを右クリックして「全てのタスク」-「SQLスクリプトを作成」でテーブルを作成するSQL文の自動作成は出来ますけど
セキュリティの構成はどのようになっていますか？ セキュリティの設定でリモートアクセス検疫サービス等の設定がされているとリモート接続を許可しないようにする機能もあるのでSQLServerの設定を確認してみてください。 ちなみにVBからどのように接続しているのでしょうか？ SQLServerへの接続の確立は Dim cnn As New ADODB.Connection 　　 ・ '接続を確立する cnn.Open "Provider=SQLOLEDB;" & _ "Data Source=(local);" & _ "Initial Catalog=×××;", "××", "" こんな感じですか？
s_husky です。 昔ながらの我流に固執するのは良くありません。1#は、ゴミと認識して下さい。
このUPDATE文の意味を説明できますか？ 相関名eとeeを使っていますが、列deptnoは更新される訳ではない。 UPDATEでは条件指定もなく、全件更新。 やりたいことは何でしょうか？ それが分かれば、代替手段も提案できるかも知れません。 特定のRDBMSの構文を示されただけでは、両方のRDBMSに精通している人にしか、回答できない場合もあります。
CREATE TABLE Test (Mykey Varchar(50) default 'abcd') カッコが無いとエラーになりません？
OSによって呼び方は変わるかもしれませんがタスクスケジューラでバッチファイルを仕込んでおけば意外と簡単にできますよ。 停止：net stop MSSQLServer 開始：net start MSSQLServer のコマンドをそれぞれ実行する（同時実行でも構わないと思いますが…wait を入れた方が良いでしょうから）ことで対応出来ると思いますよ。
>「initial catalog」はデータベース名でよいのでしょうか？ はい、masterやNorthWindがそれにあたります >「user id」についてはEnterpriseManagerのどこに >表示されているのでしょうか？ セキュリティのログインに表示されています。 初期設定ではログイン名saとパスワード空白(だったかな？）が設定されています。sa以外のログインは自分で作成してください。 >SQLServerのユーザーIDというイメージができていないのですが、 >これはSQLServerのみに使用するIDでしょうか？ そうです。単純なIDとパスワードでの管理です >それともWindowsを使用するログインユーザーのことなのでしょうか？ ログインユーザーを認証に使用する方法もあります。 どちらもサポートされています。 注意すべきことは新規ログインで作成できる２つの種類Windows認証とSQLServer認証のうちSQLServer認証はSQLServerのプロパティ-セキュリティで認証が混合モードの時にしか使用できません(saも使用できません) その場合はWindows認証を使用するかSQLServerを混合モードにしてください（一度混合モードにするとWindows認証モードのみに変更できません） 接続文字列ですがWindows認証を使用して接続を行う場合は user id=db201 password=db201 を削除して代わりに Integrated Security=SSPI と記述してください それからWebサーバなどからログオンしていないユーザがデータベースに接続するときに Integrated Security=SSPI と記述すると、IISの場合は仮想ディレクトリの匿名アクセスのアカウントが使用されます。 あらかじめセキュリティのログインに追加しておくと接続できます
SQLServer2000ならクエリアナライザがあれば 大抵の開発では十分だと思います。 参考までに、 CSEというツールが有ります。 ttp://www.hi-ho.ne.jp/tsumiki/cse_5.html
無いと思います。 Insert,Updateを行ったその都度 @@Errorを取得、If文で処理を分岐の方法で対応するしかできないのではないのでしょうか
SqlCommand cmd = cn.CreateCommand(); cmd.CommandText = "select * from A_Table join DB_B..B_Table on A_Table.Col1 = DB_B..B_Table.Col1"; SqlDataReader rdr = cmd.ExecuteReader(); クエリのテーブル名でDBを省略せずに記述では？ テーブルの所有者がdbo以外の時は所有者も指定してください
無かったと思います declare @d datetime,@d2 datetime select @d = getdate() select @d2 = cast(year(@d) as char(4)) + '/' + cast(month(@d) as nvarchar(2)) + '/1' select dateadd(day,-1,(dateadd(month , 1, @d2 ))) as 当月末,@d as 今日 もっと簡素な方法があるかも
日本語にする意味は見やすいくらいでしょう。英字にした方がベターです。以前、オラクルでの開発で日本語で定義していき、最終段階になって、日本語のためによくわからないエラーが出たことがあります。その時になってからではもう日本語から英字に修正できないので大変困りました。
よく分からないのですが、これはACCESSのクエリ用の 構文では？ >[name] = "あり（B)",3,） まず、「,)」で終わるような構文は、一般的にないと 思いますが？ SQL SERVER系の独自SQLについて詳しくないのですが、 SQLの構文としては見たことがありません。 検索したら、ACCESSのクエリ用の構文のような感じ ですが？ 参考URL：http://www.microsoft.com/japan/msdn/library/defa …
select name from * order by switch ([name] = "なし",1, [name] = "あり（A)",2, [name] = "あり（B)",3,） いろいろツッコミどころのあるクエリですが（笑 select * from テーブル名 order by case [name] when 'なし' then 1 when 'あり(A)' then 2 when 'あり(B)' then 3 else 0 end
試しに SELECT (SUBSTR(項目名,1,(INSTR(項目名,'　')-1))) AS 名前1, (SUBSTR(項目名,(INSTR(項目名,'　')+1))) AS sub名前1, (SUBSTR(sub名前1,1,(INSTR(sub名前1,'　')-1))) AS 名前2, (SUBSTR(sub名前1,(INSTR(sub名前1,'　')+1))) AS sub名前2, (SUBSTR(sub名前2,1,(INSTR(sub名前2,'　')-1))) AS 名前3, (SUBSTR(sub名前2,(INSTR(sub名前2,'　')+1))) AS sub名前3, LTRIM(sub名前3) AS 名前4 FROM テーブル名 こんなんで切り出せればいいですが・・。項目の中で全て同じ数のスペースがあれば良いですが可変してるとエラーですね。
ちょっと内容がよくわかりませんが、Fドライブへ追加でバックアップしたいということであれば、下記のスクリプトをジョブで実行すればよいかと思います。 ・db_nameは実際のデータベース名に置き換えてください。 ・これはSQL2000では動作しますが7ではテストできていません。 declare @bkup_date char(8), @bkup_str varchar(100) set @bkup_date = (select convert(char(8),getdate(),112)) set @bkup_str = 'f:\' + @bkup_date + '.bak' backup database db_name to disk=@bkup_str with init
select 明細ID, (select top 1 NAME from テーブル as b where A.明細ID=B.明細ID order by KINGAKU desc) as NAME, KINGAKU from (select 明細ID,sum(KINGAKU) as KINGAKU from テーブル group by 明細ID) as A とかで良いと思います。 他にも、色々とやり方はありますが。
GetDate()はdatetime型なのでsmalldatetime型にInsertすると時刻部分が切り詰められます。 ただそのようなエラーは自動的にキャストするので出なかったような？ どうしても出るようであれば GetDate()のかわりにConvert(smalldatetime,GetDate()) を使用してください
ANo2さんのおっしゃるとおり 非正規系になるのが問題かと。。 ANo1をあえて少し改良するとこんな感じですかね。 検証はしてません select ID, replace( 　'アタマ' + 　case when DATE1 is NULL then '' else '・りんご' end + 　case when DATE2 is NULL then '' else '・みかん' end + 　case when DATE3 is NULL then '' else '・かき' end + 　・・・ 　case when DATE8 is NULL then '' else '・ばなな' end , 　'アタマ・','') as 新規項目 from TABLE1
見当たりませんね～。 declare @str1 nvarchar(1),@str2 nvarchar(50) select @str1 =N'.',@str2 = N'12345.6789' select substring(@str2,1,charindex(@str1,@str2)-1) as 前, substring(@str2,charindex(@str1,@str2)+1,len(@str2)-charindex(@str1,@str2)) as 後 こんな感じにしかできないみたいです
単に、PKがIDだけではないとか、トランザクションをかけていないだけではないですか？ 現在業務中のため、手元に環境がSQLサーバしかないので、 ・クエリアナライザ ・VBScript でやってみましたが、問題なしで普通にロックがかかりました。。。 私の行った方法が、そちらでもそのまま実現できるように、全て張っておきます。 ※1.テスト環境構築⇒pubs設定にしてあります ---------------------------------------------------------------------------------------------------------------- USE pubs GO if EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[TBL_NAME]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) DROP TABLE [TBL_NAME] GO CREATE TABLE [TBL_NAME] ( [ID] [numeric](8, 0) NOT NULL , [FLD] [char] (8) COLLATE Japanese_BIN NOT NULL CONSTRAINT [XPKTBL_NAME] PRIMARY KEY CLUSTERED ( [ID] ) ON [PRIMARY] ) GO INSERT INTO TBL_NAME VALUES(1,'A') INSERT INTO TBL_NAME VALUES(2,'B') INSERT INTO TBL_NAME VALUES(3,'C') INSERT INTO TBL_NAME VALUES(4,'D') INSERT INTO TBL_NAME VALUES(5,'E') GO SELECT * FROM TBL_NAME GO ---------------------------------------------------------------------------------------------------------------- ※2.ロック用のVBScript (必要に応じてGetConnection()関数を変更してください) ---------------------------------------------------------------------------------------------------------------- Option Explicit Call Main_Lock() 'メイン:ロック Sub Main_Lock() Dim adoCnn Dim adoRec Dim strSQL Set adoCnn = GetConnection() adoCnn.BeginTrans strSQL = "SELECT * FROM TBL_NAME with (rowlock,updlock) WHERE ID IN(2,3,4)" Set adoRec = adoCnn.Execute(strSQL) MsgBox adoRec.RecordCount & "件のデータをロック中...更新用のVBScriptを実行ください" adoCnn.CommitTrans 'またはRollbackTrans adoCnn.Close Set adoCnn = Nothing End Sub '汎用:コネクション Private Function GetConnection() CONST ADO_CUR_LOCATION_SERVER = 2 'ADODB.CursorLocationEnum.adUseServer CONST ADO_CUR_LOCATION_CILENT = 3 'ADODB.CursorLocationEnum.adUseClient Set GetConnection =CreateObject("ADODB.Connection") GetConnection.CursorLocation = ADO_CUR_LOCATION_CILENT GetConnection.Open "Provider=SQLOLEDB;" & _ "Data Source=(local);" & _ "Initial Catalog=pubs;", "sa", "sa" End Function ---------------------------------------------------------------------------------------------------------------- ※3.更新用のVBScript (必要に応じてGetConnection()関数を変更してください) ---------------------------------------------------------------------------------------------------------------- Option Explicit Call Main_Update() 'メイン:更新 Sub Main_Update() Dim adoCnn Dim strSQL Set adoCnn = GetConnection() strSQL = "UPDATE TBL_NAME SET FLD = 'わ' WHERE ID = 1" Call adoCnn.Execute(strSQL) Call Msgbox("STEP 1 終了") strSQL = "UPDATE TBL_NAME SET FLD = 'わ' WHERE ID = 4" Call adoCnn.Execute(strSQL) Call Msgbox("STEP 2 終了") strSQL = "UPDATE TBL_NAME SET FLD = 'わ' WHERE ID = 5" Call adoCnn.Execute(strSQL) Call Msgbox("STEP 3 終了") adoCnn.Close Set adoCnn = Nothing End Sub '汎用:コネクション Private Function GetConnection() CONST ADO_CUR_LOCATION_SERVER = 2 'ADODB.CursorLocationEnum.adUseServer CONST ADO_CUR_LOCATION_CILENT = 3 'ADODB.CursorLocationEnum.adUseClient Set GetConnection =CreateObject("ADODB.Connection") GetConnection.CursorLocation = ADO_CUR_LOCATION_CILENT GetConnection.Open "Provider=SQLOLEDB;" & _ "Data Source=(local);" & _ "Initial Catalog=pubs;", "sa", "sa" End Function
テーブル設計に疑問が残りますが… SELECT CHIKU, '雑誌', COUNT(*) FROM table WHERE DATE1 IS NOT NULL GROUP BY CHIKU UNION SELECT CHIKU, 'ネット', COUNT(*) FROM table WHERE DATE2 IS NOT NULL GROUP BY CHIKU UNION SELECT CHIKU, 'メール', COUNT(*) FROM table WHERE DATE3 IS NOT NULL GROUP BY CHIKU で、いいのでは。
http://www.microsoft.com/japan/sql/default.mspx http://msdn.microsoft.com/vstudio/express/sql/de … 参考URL：http://www.microsoft.com/japan/sql/default.mspx
select y.*,z.* from ( select a.伝票番号, (select top 1 伝票明細 from テーブルＢ as b where a.伝票番号=b.伝票番号 order by b.伝票番号,b.伝票明細) from テーブルＡ a ) as x join テーブルＡ as y on (x.伝票番号=y.伝票番号) join テーブルＢ as z on (x.伝票番号=z.伝票番号 and x.伝票明細=z.伝票明細) みたいな感じでキーリスト(x)を作ってしまうと、後はどうにでも成るように 思います。（SQLは未検証です） もっとも、キーリストの部分は、伝票番号配下の決定要素が１つなら、 select y.*,z.* from ( select 伝票番号,min(伝票明細) as 伝票明細 from テーブルＢ group by 伝票番号 ) as x join テーブルＡ as y on (x.伝票番号=y.伝票番号) join テーブルＢ as z on (x.伝票番号=z.伝票番号 and x.伝票明細=z.伝票明細) と簡素に済ませても良いかと思います。
SQL文はDatabaseに格納されたデータを 検索・追加・削除・更新など様々な処理を行う為の言語です。 Oracle・SQLServerなどにかかわらず基本的な統一規格があり、 全メーカ標準仕様に則って作られております。 (メーカごとの差異は若干ございますが。) まずは、言語なので試されるのが宜しいかと。 Oracleでしたら以下サイトなどで資料も多数ございますし、 無償で個人の試用もできるようですので、 試してみてはいかがでしょうか? 参考URL：http://otn.oracle.co.jp/beginner/index.html
＞この２台をDSL回線にてつないだところ 自営網でなく、普通にxDSL越しのインターネット経由なのですよね？ 想像ですが・・ xDSLルータのコンフィグというか環境の問題ではないでしょうか？ 例えば、アドレス＆ポート変換の類、フィルタリング等の。 可能なら、セキュリティの観点からも、ipsecやsoftetherなど インターネットをトンネルする仕組みで考えるのが良いように思います。
　サイトはわかりませんが、自分はこうしているという説明でよければできます。 　１．【データベースのバックアップ】でトランザクションログを選択し、「アクティブでないエントリをトランザクションログから削除」のオプションにチェックを入れて実行する。 　 　２．【データベースの圧縮】の「ファイル圧縮」でログファイルを選択し、圧縮操作で「ページを圧縮後、ファイルから空き領域を切り詰める」を選択して実行する。 　１．⇒２．の順で行う必要がありますが、どちらもスケジュール化できるので、ログの切捨てを自動化することも可能です。
手元に環境がないのでテストできてないですが こんな感じで文字列連結していけばいけると思います。 間違ってたらすみません。 CREATE PROCEDURE usp_Enquete @ask_id varchar(10) AS DECLARE @str varchar(1000) DECLARE @numRank int DECLARE @Counter int DECLARE @StrFileds varchar(1000) 　--ADD BEGIN SELECT @numRank = count(*) FROM B_Answer WHERE ask_id = @ask_id END SET NOCOUNT ON SET @Counter = 1 SET @StrFileds='' --ADD WHILE @Counter <= @numRank BEGIN SET @StrFileds=@StrFileds + ',A.NO'+Convert(varchar,@Counter) --ADD SET @Counter=@Counter+1 --ADD END SET @str ='SELECT count(ansList.NO1) AS NumAns' + @StrFileds+' FROM .....' --ADD
困り度３の割には反応が無いですね。 意味は違ってきます。 商品別に複数の発注番号を参照する場合に使用しますから、 where 商品名='○○' and 発注番号 between 12345 and 23456 みたいな使い方の場合に有効。 where 発注番号 between 12345 and 23456 みたいな検索では、商品名の絞り込みが効かないので総スキャンが発生。 発注番号あたりに複数の商品があるなら CREATE INDEX Idx原価2 ON T原価 (発注番号,商品名); か、とは思うが、発注番号あたりに何千何万の商品がないならばこのようなINDEXは普通作りません。 CREATE INDEX Idx原価_発注番号 ON T原価 (発注番号); で充分でしょう。 where 商品名='○○' where 発注番号=12345 のような検索が行われるなら、 CREATE INDEX Idx原価_商品名 ON T原価 (商品名); CREATE INDEX Idx原価_発注番号 ON T原価 (発注番号); が有効です。
基本的に、＃１で書かれているＳＱＬで異論はないのですが・・ 100001件目～100010件のような、巨大なデータの後半戦だと、 not inが如何にも苦しいように感じます。 select * from (select top 10 * from (select top 100010 * from X order by x) order by x desc) order by x の方がＲＤＢに、ちょっとだけ優しいような気がします。 （top 100010の時点で苦しいのですけどね）
ANo.3です。訂正あり update Table1 set セッション7 = case Table1.[ID] % 3 when 1 then T1.セッション5 else Table1.セッション7 end, セッション8 = case Table1.[ID] % 3 when 1 then T2.セッション5 else Table1.セッション8 end from Table1 left join Table1 as T1 on Table1.[ID] = T1.[ID] - 1 left join Table1 as T2 on Table1.[ID] = T2.[ID] - 2 where Table1.[ID] % 3 = 1　　＜＜--Table.[ID]になっていました また最後のwhere句をつける場合はSet句をかなり簡略できます セッション7 = T1.セッション5, セッション8 = T2.セッション5, こちらの方が良いかもしれません
まったく別物になってしまいますが、 create table でテーブルを作成し、 insert into select でデータをコピーするという方法もあります。
内容を見るところAccessのアップサイジングウィザード等が書いてあるのでAccessから（使って）SQLServerへテーブルを追加したいということでいいのでしょうか。 ADODBのConnectionとRecordsetを宣言して "provider=SQLOLEDB;data source=server;user id=id;password=pass;initial catalog=DB名" で接続させる。 INSERT INTO テーブル名 SELECT * FROM OPENROWSET('Microsoft.Jet.OLEDB.4.0','mdbをフルパスで指定';'Admin','SELECT * FROM mdbのテーブル名') でSQLServerのテーブルに追加する。 こんな感じで良いと思いますが。
SQL Serverは主キーに設定した時点で 強制的にindexが作成されるはずでは？ create indexを主キーに対して実行すると indexが重複して作成されてしまうはずです。
> <a href="http://～addata.asp?id={ID}">{NAME}</a>の 　　　　　↑↑↑…ここは何のURL(?)を入れたらいいのですか?それから、addataとは何ですか?知識が乏しくて テキトーで済みません＾＾； NAMEをリンクして、住所を表示させたいのですよね？ という事は、住所を表示させる為の別のファイルを作成するのでは？という事からきています。 ですから、<A>タグを利用し、別のページへIDを渡しています。 adddata.aspで、IDから住所情報を取得し、表示させる、 という動作を想像しました。 ここで言っている「adddata」というのは、 「AddressData」を省略しちゃいました。 「Add」の意味がちょっと分かり辛いですね・・・。
ANo1です まだ解決していないでしょうか？ 気になって調べてみたところ 汎用拡張プロシージャを使用してWSHをストアドプロシージャから実行出来るみたいです。ただしsyadminのメンバでないとだめですが declare @cmd nvarchar(255) set @cmd = N'cscript c:\○○\■■.vbs' exec master..xp_cmdshell @cmd （注意）絶対に入力を求めるステートメントをWSHに入れないでください。osqlが入力待ちのままハングします。 またcscriptを省略しても動作は同じになりますが、その際WScript.Echoなど出力系を入れたり構文エラーがあると同様にハングします。ハングした場合はプロセスのWScript.exeを切って下さい。 WinXPでの確認です
1. サーバのHDDにあるファイルをクライアント端末で読み込んだり、クライアント端末からサーバのHDDにファイルを作成したりすること（サーバにあるファイルの共有）ができることを確認する。 2. サーバ側でSQL Server 6.5の「SQLセットアップ」を起動→続行(O)→続行(O)→ネットワークサポートの変更(N)→続行(O)。 3. 「名前つきパイプ」にチェックを入れてOK(O)。 4. 名前付きパイプ名(N)の値（たとえば「\\.\pipe\sql\query」）を確認。 5. セットアップが終了するまで続行(O)。 6. クライアント側で、ODBCデータソースの構成の中にある「クライアントの設定(T)」をクリック。 7. ネットワークライブラリから「名前つきパイプ(P)」を選択。 8. パイプ名(E)に、4.で確認したパイプ名称（たとえば「\\.\pipe\sql\query」）を入力。 9. SQL Serverを実行しているサーバのサーバー名(C)を入力してOK。
１件ずつやるから遅いんだと思います。 存在チェックも含めて全体で一括処理できませんか。 テキストを読みこんで登録する処理ならば、一旦BCPでワークに入れてからやってみてください。
回答No.1の内容でちゃんと動くようですよ。他のSQL文が間違っているのではないでしょうか。
それ、使いたいですよね。でもSQL Serverでは使えないみたいです。 group byの中にcase...endを丸ごと書き入れれば同じことができるのですが、同じことを2回書かないといけないのは見た目が冗長なだけでなくメンテナンス性も下がりますし、なによりgroup byの中身がちょっとでも変わるとちゃんと文句を言う（つまり、2回とも本当に全く同じかどうか、SQL Serverはちゃんとチェックしている）というのが、釈然としないところです。別名を使わせてくれれば全部解決するのに。 なお、同じく若干冗長な表現になりますが、こういう書き方もできます。（SQL Server 2000以上。SQL Server 7.0だとどうかな・・・6.5以前では使えません。） select a, x from 　　(select a, case...end as x from table) as tablex 　　group by a, x こうすると、「カラムaとカラムxを持つ中間的なテーブルtablex」が外側のselectで仮定されるので、カラムxをgroup byで使うことができます。
簡単にやるなら AccessのテーブルにExcelのSheetとSQLServerのテーブルをリンクさせてAccessで追加クエリを作りインポートする。またはSQLビューでinsert into ・・の記述を書きインポートさせる。 これが一番簡単で理解しやすいと思います。 Excelのリンクはファイルを指定してすぐ出来ますSQLServerはODBCを使いODBC経由でAccesのテーブルにリンクさせます。ODBCでSQLServerの接続の設定をしてAccessのテーブルでODBCデータベースを選び設定したSQLServerのテーブルをリンクすればＯＫです。 クエリはウィザードを使えば出来ますのでこの方法が一番簡単で良いと思います。
こんな経験あります。さすがに９０秒まではないですが。 テーブルやストアドなどオブジェクト数が多くなるとこうなるみたいですね。でもサーバーでやると早い。 こんなもんだと思って使うしかないみたいですよ。
日本語と英語の違いだけ。 http://dictionary.goo.ne.jp/search.php?MT=call&k … http://dictionary.goo.ne.jp/search.php?MT=%B8%C6 …
>Accessでは日々追加されていくデータを月毎に・・ファイルごとにバックアップを行っていました >MSDEでは細かくファイルをわけずに保存するものなのでしょうか？ Accessで月毎にバックアップをとるのはそのシステムの運用の仕方によりますが月3000件程度なら年間でも36000件なら年間を通して使いその月毎のレコードのみバックアップに蓄積していく仕方でも大丈夫だと思いますが。MSDEの移行の話なので置いといて・・。 通常はSQLServerやMSDE等のアックアップは全体バックアップが基本になると思います。 運用しているデータベースのデータとトランザクションログの内容をすべてバックアップします。 バックアップデバイスへの書き込みは追記形式となります。追記形式とはバックアップデバイスに存在する既存のバックアップの内容を破棄しないで後ろへ後ろへとバックアップの内容を作成する形式です。一番最後のバックアップがバックアップセットの1番となります。その前のバックアップが２番。 フルモードでバックアップをするとデータベースに対する更新などの命令を実行したときはトランザクションログファイルの中にその実行された命令の詳細情報がすべて記録されます。レコードのすべての情報が記録されトランザクションログファイルが膨大に膨れ上がることがありますけど。 MSDEで作成されたデータベースの運用モードの初期値はシンプルモードに設定されているはずです。シンプルモードはトランザクションの内容を上書き消去していきますのでトランザクションログ管理作業が不要になる運用モードです。そのかわりトランザクションログファイルの継続的な記録の保存が行われないので全体バックアップを最後に実施したときにしか復元されないので多少（１ヶ月前ならその後１ヶ月分）のデータ損失が発生します。 リカバリの操作では全体バックアップが基準となりますから頻繁に全体バックアップを実行することが大事です。 下記にMSDEの自習書がありませので参考にしてみてください。 参考URL：http://www.microsoft.com/japan/sql/msde/techinfo …
CREATE PROCEDURE usp_BZipInsertTable AS ＜＜抜けてます BEGIN BEGIN TRANSACTION
> バックアップを取るということは領域の解放、ログファイルサイズの縮小にはならないんじゃないか 逆に、バックアップを行わないと解放は行われません。 その本にはバックアップのコマンドとかは書いてないのでしょうか？ とりあえずBooks Onlineで、Backup Logの項目を調べてみるといいのでは？
ヒントだけ挙げておきます。 ・テーブル内のカラム数を減らし、それにあわせてSELECT/INSERTするカラム数も減らして（例えば1つにして）も現象は同じですか。
No8ですが、 > EXCEPT を使用する次のクエリは、EXCEPT オペランドの左辺のクエリから返され、右辺のクエリからは返されなかった、重複しない値が返されます。 なので、これでは不十分だと思います。 逆も必要なので、Unionして select * from Ａテーブル except select * from Ｂテーブル Union select * from Ｂテーブル except select * from Ａテーブル #あ。なるほど。EXCEPTはOracleのMinus互換の命令か…。
Amazon.co.jpで「ソフトウェア：SQL server」を検索しリリースの古い順番に並べると、マイクロソフト製SQL Server 2000製品の多くが2000/10/27と2000/10/31にリリースされています。 ですので、発売日は2000年10月かと思います。 ・・・というのを見てからGoogleで "sql server 2000" "2000年10月" を検索したところ、 　　MS、.NET Enterprise Serversのスケジュールを発表 　　http://www.atmarkit.co.jp/news/200010/25/msc.html という記事がヒットしました。 　　商品名：SQL Server 2000 　　発売予定：10月27日 だそうで。
IF...ELSE BEGIN...END WHILE GOTO 等を使って実行の流れを制御します。 またエラー発生の有無はグローバル変数@@ERRORで判別します。
「ORDER BYがどうの」ではどんな問題が発生しているのか分かりません。
create table #T( a nvarchar(10) ) go insert #T values(N'ABC') insert #T values(N'%ABC') select * from #T where a like '[%]A%' select * from #T where a like '#%A%' escape '#' SQLの検索もですが、 Googleの検索技術も身につけましょう！ http://www.google.co.jp/search?sourceid=navclien …
DBCC ステートメントを使用します。 クエリアナライザ等から、 DBCC DROPCLEANBUFFERS を実行して下さい。 参考URL：http://www.microsoft.com/japan/msdn/library/defa …
create table #T( d datetime, i int ) go insert #T values(N'2005-10-18 20:54',100) insert #T values(N'2005-10-18 21:30',200) insert #T values(N'2005-10-18 00:13',150) insert #T values(N'2005-10-19 10:00',100) insert #T values(N'2005-10-19 12:00',500) insert #T values(N'2005-10-19 20:00',200) select convert(nvarchar(10),d,111) as d2, sum(i) as i2 from #T group by convert(nvarchar(10),d,111) --もっといい方法があるかも？ --何とかそれらしくなりました
ANo2～4です。 もう解決されたのかな？ もしまだであれば、ここまで来たのなら何とかここで解決したいですね。 少し意図がわからなくなってきました。 もし可能なら、実際のテーブルAの実データに近い形で さらにこうなって欲しい結果も同時に補足していただけると イメージがつきやすいのですが。
普通にVB系(6とか.net等)とかでいいのではないでしょうか。ストアドを使って、sqlサーバからメールも送れるし、タスクマネージャにvbで作った実行モジュールを登録して、適当な間隔で起動して～もできますしね。 なによりVBAを使ったことがるということなので
一回だけのバッチ作業ですか？ であれば 仮テーブルを作成 csvを全部取り込む 連結クエリのdelete文でまったく同じレコードを消す 残ったのをまとめてinsert 何度も行う必要があるならお薦めできない方法ですが 取り込み対象を確認できるのでらくだと思います
>できればODBC経由でなく直に繋ぎたいのですが、むりならODBC経由でもいいです。 この文の意味は、、、想像ですが、、、 単に、コントロールパネルで設定しない状態で接続をしたいってことですか？ それであれば、接続の文字列次第で、どうにでもなります。 参考URLはVB6での例ですが、VB5でも流用可能だと思います。 DAOでODBCドライバを利用（ただしデータソースの登録は不要） http://homepage2.nifty.com/inform/vbdb/dao_odbc. … ADO http://homepage2.nifty.com/inform/vbdb/ado_sqlse …
ANo.3です。 間違いがありました insert T(col1) select N'bbb' as col1 union select N'ccc' のようなinsertに対応してませんでした。 この行を if (select count(*) from T where exists(select * from inserted where inserted.col1=T.col1)) >= 2 このように三行に変更してください declare @er nvarchar(10) select top 1 @er = col1 from T where exists(select * from inserted where inserted.col1=T.col1) group by col1 having (count(*) >= 2) if @er is not null
基本的に、単純に結合して、集計するだけでＯＫなハズです。 ＃１、＃２どちらも同じ結果となるＳＱＬだと思います。（というか、違いが無い ^^;） 効率的には、 select a.id,b.name,a.point,b.busho from (select id,max(point) as point from smpl_tbl2 group by id) as a inner join smpl_tbl1 as b on (b.id=a.id) とした方が良いような気がします。 （ホントのところは、索引の持ち方次第なので、不明ですが・・）
これでやってみてください。 osql -S(local) -E -Q"RESTORE DATABASE sample FROM DISK='D:\sample.bak' WITH REPLACE" Windows認証で動作します。 つまり今WindowsにログオンしているユーザーでMSDEにログオンすることになります。 これを先のSQL文で実行させるには混合認証モードに設定を変更する必要があります。 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\MSSQLServer\LoginMode ← 2
価格の一例として、Amazon.co.jpの場合、日本語版で最も安いものは SQL Server 2000 Developer 価格: ￥5,821 （税込） http://www.amazon.co.jp/exec/obidos/ASIN/B00005O … 最も高いものは Microsoft SQL Server 2000 Enterprise Edition プロセッサライセンス 価格: ￥2,611,351 （税込） http://www.amazon.co.jp/exec/obidos/ASIN/B00005O … 桁違いとはこのことですね(笑)
MSDE（MSSQLSERVER）サービスで使用するアカウントの指定が誤っている（アカウント名が存在しないか、パスワードが異なっている）ようです。 サービスのプロパティのログオンタブで正しいアカウント名を指定してください。
No1の補足です。（ポイントはNo1に振ってください） ＞ORACLEのDECODEに相当する関数 といういみであればNo1で使われているCase文になるはずです。Books Onlineに使用方法はあるはずなので。
> このtestDBを削除することによって稼動中のDBに影響があるものなのでしょうか。 基本的には問題ないはずです。 ただ、この状況だと、何らかの原因で復元に失敗している可能性が高い気がします。 リトライ時には別のサーバーで行ったほうが無難なような気がします。 あ。それと原因として考えられるのが、復元時のオプション。 復元のオプションとして、「読取専用状態で復元」というのがあった（トランザクションログの復元を行う場合にはこのオプションを使ったはず）はずですが、ひょっとしてそれで復元かけてません？
私は以下の方法でトランザクションログを切り捨てています。 checkpoint backup log DB名 with no_log checkpointでアクティブログをフラッシュしてログを切り捨てることでDBサイズが肥大するのを防いでいます。 またDBのサイズは増えることはあっても、特別なことをしない限り減ることはありません。 使用率を見てそれが減っていることは確認できると思います。
SQLって使われるデータベースソフトによっていろいろ違うんですよ。 まぁちょっとずつ。 ご自分の環境にあるデータベースソフトにちなんだ辺りから始めればいいと思います。 Officeが入ってるならAccessからとか。 SQLServer(MSDEという種類ね)だったら無償でダウンロードできますからそっちからも始められます。 MySQL(っていうデータベースソフトね)も無償です。 それぞれSQL言語のちょっとしたとこが違いますけど、ひとつ極めれば大体わかるようになります。 がんばれ！おれもがんばる！
VBAも久しく触ってないですし、 SQLDMOは使用したことはないので コードはよく判りません。 SQLDMOの列の説明とEnterpriseManagerのデザイン画面の列の説明が 同じものをさしているのであれば以下のクエリで取得できます select colid,col.[name] as column_name,value as comment from (select [id],[name] from sysobjects) as tbl join (select [name],[id],colid from syscolumns) as col on tbl.[name]=@TABLE_NAME and tbl.[id]=col.[id] left join (select [id],smallid,[value] from sysproperties) as cmt on col.[id]=cmt.[id] and colid=smallid order by colid ただし権限調査やパフォチュはやってないのはご勘弁！
Version 7.0以降なら使えます。 Version 6.5以前では使えません。
「ツールは使わない」のであれば手作業しかありませんから、「手作業より手間のかからない方法」は存在しません。 ツールを使ってもよいのであれば、バックアップ用のSQLテキスト（backupステートメントを使う）をあらかじめ用意しておき、それをosqlに流せばよいでしょう。 　　BACKUP DATABASE database1 TO DISK "database1.backup" 　　GO 　　BACKUP DATABASE database2 TO DISK "database2.backup" 　　GO 　　... みたいな感じで。
selectの最後に 　　order by SDate, STime と付ければ、selectの結果がSDateとSTimeの昇順に並びます。
その方法では正解とは言えません。原因が分からないまま解決しようとしているからです。 まずエラーが発生している直接の原因は「開かれているカーソルが存在しないか閉じられています」なのですから、なぜそのエラーが発生した場所において開かれているカーソルが存在しない、あるいはカーソルが閉じられているのか、それを調べてください。 おそらくは、そのエラーメッセージが表示される以前の段階で既にエラーが発生して「カーソルを開くことができない状態」となっているにもかかわらず、アプリケーションがそのエラーをチェックせずに次に処理を進めているため、質問のようなエラーが発生しているのではないかと思います。 エラーメッセージが指し示すエラーの直接の原因が判明したら、ようやく、その「原因」を生じさせている理由（真の原因）を調べることができます。それが判明しないうちに何か行っても、その行った「何か」がエラーとどういう関係にあるのかは全く不明なのですから、その行為が正しいのか否かを論ずることはできません。
SQLはOracleであってもSQLServerでも基本的に同じです。 基本的にOracleと違うのはSQLServerは一つのインスタンスに複数のデータベースを対応させられる。 >Oracle特有のSQL構文をSQL Serverに見合った構文に・・一般的なSELECT文、INSERT、UPDATE、DELETE文はそのまま使う事が可能か？ Oracle固有の関数はSQL-Serverでは使用できませんがその辺を考慮すればSELECT文、INSERT、UPDATE、DELETE文は使えます。 Oracleで日付を取るときはご存知のようにSYSDATE、SQLServerではSYSDATEのかわりにGETDATE関数を使います。 OracleのDATE型では秒単位までなのに対してSQLServerのDATETIME型は秒以下のレベルもある。Oracleでは日付データにTRUNC関数を使うことで日時の情報だけを取り出せますSQLServerでは時刻を切り捨てる関数はないのでconvertを使ったりします。でもSQLServerはDATEDIFF・DATEPART・DAY・MONTH・YEARを使って加算したり抜き出したりできる。 NULLの置き換えはOracleはNULLを置き換えるときにNVL関数を使いまがSQLServerではISNULL関数を使って記述します。 以上の様な使える関数と構文の違いを考慮すれば一般的なSQLは使えます。
在庫に無いコードの名称はどうするかがわからないので、あのようなSQL文にしました。 複数のカラムの更新をしたいのであれば、 INNER JOINのイメージであれば、 UPDATE 発注明細TBL SET 発注明細TBL.在庫名称2 = 在庫TBL.在庫名称 ,発注明細TBL.[明細のカラム] = 在庫TBL.[在庫のカラム] ・・・・・・・・・・・・・・・・・・・・ FROM 在庫TBL WHERE 在庫TBL.在庫コード = 発注明細TBL.在庫コード でできます。 LEFT JOINのイメージはサブクエリかな？ どうしたいのかを言っていただかないと、どっちにも転向しやすい方法でしか、物を言えませんので、どうしたいかを予め伝えていただけると助かります。
これでいけるでしょう。 SELECT u.ユーザーID,u.ユーザー氏名, m1.売上,m2.売上,・・・ from ユーザーマスター u left join (select ユーザーID,sum(売上金額) as 金額 　　from 1月売上テーブル group by ユーザーID) m1 on u.ユーザーID=m1.ユーザーID ・・・
SQLserverは詳しくないんですが．． ＞sqlservr.exeが２つ起動しているのが確認 ＞できました。 複数のインスタンスが存在する構成になっているんでは？ SQLserverのサービスマネージャーで確認されるとわかると思います。
なるほど、VBを使用する場合ですか・・・それですと、タイムアウトを大きくする以外にはなさそうですね。 逆に、タイムアウトは大きくせず（通常のトランザクションを流すのと同じ程度に設定し）、タイムアウトが発生したらある程度の時間間隔を置いて再接続を試みるという方法もあります。 2.の現象が発生している原因が判明し、その原因を取り除くことができるようであれば、この方法でも良いのではないかと思います。
レプリケーション実行時に使用されるユーザです。 詳しくは システム管理者ガイド 　　→第4部 セキュリティ 　　→第8章 セキュリティの概念 　　→サーバーのログインID 　　→SQL Serverが用意するログインID 　　→repl_publisherログインID に解説があります。また、SQL Server 6.5のSQL Server Books Onlineでrepl_publisherを検索しても同様の内容が表示されます。
まず最初に調べるとすれば 1. バイナリエディタ（http://www.zob.ne.jp/~c.mos/soft/bz.html 等）を使って、行終端文字が本当に\nになっているかどうかを確認する。特に、bulk insertを実行しているサーバ上で、ファイルの内容を確認すること。 2. すべてのデータを1行とみなしているのだとすれば、データファイルが1行であればエラーなくbulk insertが可能なはずなので、データファイルが1行の場合と2行ないしそれ以上の場合でテスト実行を行う。 あたりでしょうか。
他のシステムストアドプロシージャの心当たりはありません。 　　No.1648536 質問：列名とそのデータ型 　　http://oshiete1.goo.ne.jp/kotaeru.php3?q=1648536 にあるようにsyscolumns等のシステムテーブルから自前で情報を取得するか、ODBC経由の場合は接続文字列に"DATABASE={データベース名};"を追加して任意のデータベースに接続してからテーブル情報・列情報を取得するか、あるいはOLEDB経由でデータベース情報・テーブル情報・列情報を取得するか、というところではないでしょうか。
sysobjectsを使用する際、たとえば 　　SELECT COUNT(*) FROM sysobjects のように使いますが、 　　SELECT COUNT(*) FROM [接続先データベース].[接続時アカウント].sysobjects の略になっています。 もし接続時アカウントが参照したいデータベースに対する十分な権限を持っていれば 　　SELECT COUNT(*) FROM [参照したいデータベース]..sysobjects のようにして「参照したいデータベース」のsysobjectsを参照することができます。 例えば 　　SELECT COUNT(*) FROM tempdb..sysobjects のように使います。
使用しているツールの側で、文字列の受け取りバッファの大きさを256文字分しか用意していないのかもしれません。 そのvarcharフィールドに対して SELECT LEN(そのフィールド) FROM テーブル を実行すると、そのフィールドの中の文字列の長さが返りますが、それも256でしょうか。 もし上記SELECTの結果が256ではない（もっと大きい）場合は、256文字しか表示されないのはツール側の受け取りバッファが小さいだけで、実際に記録されている文字列はもっと長いということになります。 ＃SQL Server 6.5までvarcharの長さは255文字までに制限されていましたが、SQL Server 7.0以降ではvarcharの長さは8000文字まで使用できます。
＃２です。 >残念ながら同じ会社で同じ商品のレコードが複数存在していました。 ということなのでちょっと修正してみました。 select * from URIAGE_TBL where 得意先 in ( 　select 得意先 from ( 　　select distinct 得意先,商品 　　from URIAGE_TBL 　) tmp 　where 商品 in ( 'A', 'B' ) 　group by 得意先 　having count(*) >= 2 ) ちょっと長くなってしまってSQL的にどうかなとは思いますが、 これでお望みの結果は抽出できるかと
>あれはどこに売ってるのでしょうか？ 大型店舗 or ネット通販 > 勉強がてらSQLServerを使って管理したいのです。 5CALの規模であれば、 開発 → 評価版 or Developer Edition 本番 → MSDE2000RelA がお勧め。
＃１のsupobです。 すでに、＃３で、k_o_r_o_c_h_a_nさんが回答されているので、 重なってしまいますが、私も同じ考えです。 『時間として出力されていない』という意味が分かりませんでした。 フォーマット的に「社員番号,日付,業務開始,業務終了」となっているので、 単純には時間としての情報（業務開始と終了）はあると思うのですが、 まさか、午前10時を表すために、"1000"が"10:00"になっていないとダメだ、とか、秒の情報が無いから、ということなのでしょうか・・・ それとも、やはり単純な開始～終了時間だけでは、労基法的な休憩時間・深夜などの時間が表現しきれないからダメだということなのでしょうか・・・ そうですね、、、私なら、 情報量としては、最低限必要なものが出力されているようなのですが、 　　1)何かまだ不足する情報があるでしょうか。 　　2)出力フォーマット的に何か不都合なものがあるでしょうか。 のようなことを、その開発担当者の方にお伺いすると思います。 また、あまり参考にならないかと思いますが、以上です。
多分accessのＡＤＰでフォームを作っておられると思うのですが、結論として「出来ません」。 ＶＢＡで商品マスタから値をとってきてセットするかＤｌｏｏｋｕｐ関数を使ってください。
単一のトランザクション内に多数のレコード更新があると、場合によっては更新するレコード数よりはるかに多い数のレコードがロックされ、そのトランザクションが終了するまで問い合わせができない場合があります。これはSQL Serverが持つ弱点の1つです。 単一の大きな、長時間を要する更新トランザクションのかわりに、小さな更新トランザクションに分割することが可能であれば、そうすることで、レコードがロックされている時間を短くすることができます。 そういう見直しが難しい場合は、SQL Serverの設定で「レコードロックからページロックへの移行」のパラメータを変更し、できるだけページロックに移行しないように設定すると、若干は状況が改善される可能性があります。 ただし、レコードロックからページロックへの移行は更新トランザクションのパフォーマンス向上のために行うことで、ページロックへの移行を少なくすると更新トランザクションのパフォーマンスが落ちる可能性があります。 それにより更新トランザクションの実行時間が長くなるとレコードロックされる時間も長くなるので、逆に問い合わせのパフォーマンスが落ちる可能性もあります。 パラメータを変更する場合には、いろいろパラメータを振って、どの程度影響があるか確かめてみてください。 それから、考慮の順番としては逆かもしれませんが、可能であればSQL Serverに使わせるメモリの量を増やしてみてください。大きなトランザクションでも、うまくキャッシュメモリに入れば高速に処理を完了することができますので。
convert(char(8),id) のかわりに right(" "+convert(varchar(8),id),8) にしてみては。（回答の表示では連続する空白が詰まって表示されてしまいますが、実際には、上記の【"】の間には空白が7個入ります。）
同じ[MAIL_ID]で違う[USER_ID]のレコードが存在するということでしょうか？ その場合[MAIL_ID]でグループ化した、どの[USER_ID]の[SEI][MEI]を出力したいのですか？ （現在はそれぞれ別個に最小値を出力しているようですが） 最小値を出力するのでしたら[MIN(USER_ID)]の[SEI][MEI]を出力したほうが良いのでは？
SELECT A.ID, A.MinSEI + A.MinMEI AS Name FROM (SELECT TABLEA.ID, Min(TABLEA.SEI) AS MinSEI, Min(TABLEA.MEI) AS MinMEI FROM TABLEA GROUP BY TABLEA.ID) AS A これでできませんか？
SQLServer2000はWindows上で使用、インストールするソフト？？だと思います。 上記の場合ですとレジストリ若しくは何らかの設定ファイルにより再インストールを行っても期限切れになっている可能性が高いと考えられます。 非常にSQLServer2000を使用したいのであれば購入する事をお勧めします。（高いでしょうけど・・・）
「group by」の数量と金額を取り除いて下さい。 数量と金額は集合関数を使っていますので、「group by」に記述する必要はありません。
ストアドプロシージャでよければsp_columnsが使用できます。 例えば 　　sp_columns TableA などと実行します。 ストアドプロシージャを使いたくない場合は 　　SELECT c.name, t.name 　　　　FROM sysobjects o, syscolumns c, systypes t 　　　　WHERE o.name = 'TableA' AND c.id = o.id AND c.type = t.type または 　　SELECT c.name, t.name 　　　　FROM sysobjects o, syscolumns c, systypes t 　　　　WHERE o.name = 'TableA' AND c.id = o.id AND c.xtype = t.type のようにします。（SQL Serverのバージョンによって使いわける。） sp_columnsの使い方やテーブルsysXXXの内容の詳細は、マニュアル・ヘルプファイルを参照してください。
>ＳｑｌＳｅｒｖｅｒエージェントのジョブとして登録して実行しようとするとエラー どこでエラーになっているのか不明ですが・・。 ジョブステップにアクションフローロジックを実装して失敗時の動作をレポートして確認してみてはいかがでしょうか？ 後は SQLServerAgentに登録したタスクは権限がなければ実行できませんけどジョブの所有者が重要なファクターとなります。その確認は？ SQLServerAgentのサービスアカウントがリソースのアクセス許可をもっていないとジョブは失敗します。その確認は？ ジョブの所有者がsysadmin固定サーバーロールのメンバの場合はSQLServerAgentのサービスアカウントが適切な権限をもっている必要があります。その確認は？ すいません。このくらいしか思いつかないですが・・。
1. 実行結果の内容を全部テキストエディタ（メモ帳など）にコピーして、「（1行処理しました）」の数を数える。 とはいえ、20万件もあるのでは実行結果のバッファがあふれて、最後のほうの一部しか残っていないでしょうから・・・ 2. isqlやosqlでクエリを流し、実行結果をリダイレクトでテキストファイルに入れる。この方法であれば「実行結果のバッファがあふれて前のほうが見えない」ということなく、実行結果はすべて記録できます。実行完了後に、ゆっくり「（1行処理しました）」の数を数えてください。 数を数えるのが面倒という場合は・・・ 3. まず10万件ずつに分割してクエリを流す。エラーが発生したら、その「エラーが発生した側」を再度2つに分割してクエリを流す。これを、1回に流すクエリの件数が手頃な数になるまで繰り返す。最初が20万件なら、2分割を15回繰り返せば6件まで絞り込めます。一度に2分割でなく4分割にすると、4分割を7回繰り返せば12件まで絞り込めます。 もし「クエリ」の内容が「同一テーブルへのinsert」の場合は・・・ 4. insertするvaluesの内容に連番のIDを追加し、同じくIDカラムを追加したテスト用テーブルにinsertする。insertが失敗するとIDカラムの連番に穴があくので、検索すればどのinsertが失敗したのかすぐに分かる。 ひとまず思いつくのは、こんなところでしょうか。
バックアップ・リストア操作の方法と使用条件については、マニュアルないしヘルプに記載があるかと思いますので、まずはそちらをご参照ください。 その記述の中に分からない点があれば、「分かった部分」と「分からない部分」を挙げて補足願います。
正整数を入れるカラムで、空いている最少の数を求めるという問題と考えていいでしょうか?
次のようなSQLで良いように思います。 select seihin1,sum(scount) from ( select left(seihin,4) as seihin1,count(seihin) as scount from test group by seihin having (count(seihin)>1) ) as X group by seihin1
現在のデータベースファイル(*.mdf)の保存先は、既に分かっておりますでしょうか？ 分かっている場合は、SQLサーバを停止後、上記ファイルをバックアップ。 分からない場合は、スタート＞プログラム＞Microsoft SQL Server＞Enterprise manager　 を起動。 ※ここから先は、環境により異なります。 コンソール ルート＞Microsoft SQL Servers＞SQL Server グループ＞Local＞データベース＞DB名 を右クリック＞プロパティ＞データファイル に、保存先が記載されているはずなので、 やはりSQLサーバを停止後、バックアップ バックアップが完了し、リストアが終わったら、 同じく、Enterprise managerより コンソール ルート＞Microsoft SQL Servers＞SQL Server グループ＞Local＞データベース　 を右クリック＞すべてのタスク＞データベースのアタッチ にて、起動するウィザードより アタッチするデータベースのMDFファイルを参照して、 OKを押下。 問題がなければ、データベースのアタッチが正常に完了しました。のメッセージが表示されますので、 Enterprise managerより確認して下さい。 私の知っている手順は、以上となります。
ある特定のカラムに関して「格納順を昇順にする」という条件の場合のみ、可能です。 samp1_tableのカラム「n」に関して格納順を昇順にしたい場合、カラム「n」に対してクラスタ化インデクスを作成します。そうすると、samp1_tableの中の各行はカラム「n」に関して物理的に昇順になるように格納順が変更されます。 なお、クラスタ化インデクスは1つのテーブルに対して1つしか作成できないので注意してください。また格納順を降順にすることはできません。 クラスタ化インデクスとはどういうものか、およびクラスタ化インデクスの作成方法についてはSQL Serverのヘルプに記述があるので、そちらを参照してください。
SELECT ISNULL(MAX(最新番号 + 1), 1) FROM 採番テーブル でいかがですか。
INNER　JOIN　で社員IDを結んでますから、ANDの場合どちらか片方だけの検索で済みます。 where文部分をANDじゃなくてORにした場合なら両方見に行くのでコストがかかります。
CONVERT ( varchar(20) , GetDate, 111 ) でしょうか。　varchar(20)　である必要はありません。
こんばんは。 SQL文は回答できませんが、sum関数,avg関数,group by句を組み合わせてselect文を作成しましょう。 参考URLを載せておきます。 参考URL：http://www.ann.hi-ho.ne.jp/hirok/sql/
MSDEには、GUIによる管理ツールは付属していませんので、直接コマンドを打ってやる必要があります。 慣れていないと敷居が高く感じるでしょうが、インターネット上にはドキュメント類が豊富にありますので参考にしながら利用してみてください。 参考URL：http://www.microsoft.com/japan/sql/msde/techinfo …
パスするークエリーはaccessを通さずに直接ＳＱＬサーバーへクエリを発行します。 だから　[Forms]![フォーム1]![テキスト0]　が文字列としてわたされ、解釈できなくなるわけです。 やり方としては以下の方法があります。 ただ、パススルークエリを使うよりをＡＤＯでつなげたほうがいいと思います。 dim qd as querydef dim db as database set db=currentdb set qd=db.querydefs("クエリ名") qd.sql="UPDATE テーブル1 SET テーブル1.B = '" &[Forms]![フォーム1]![テキスト0] _ & "' WHERE (((テーブル1.A)=1));" qd.execute あとは適切にオブジェクトを開放してください
以下の様なサンプルでは、いかがでしょうか？ Private Sub DataFile_Read() Dim xlsApp As Object Dim xlsBook As Object Dim xlsSheet As Object Dim Dat_A1 As Variant ''' ''' mstrDataFile:グローバル変数で ''' 事前にファイル名を設定しておく!!! ''' ここで、ファイル名を設定しても可 ''' Set xlsApp = CreateObject("Excel.Application") 'xlsApp.Application.Visible = True '可視 xlsApp.Application.Visible = False '不可視 Set xlsBook = xlsApp.workbooks.Open(mstrDataFile) Set xlsSheet = xlsBook.ActiveSheet '---↓↓↓---　この間でデータを読み込む。 Dat_A1 = xlsSheet.Range("a1").Value '---↑↑↑--- xlsSheet.Application.Quit Set xlsSheet = Nothing Set xlsBook = Nothing Set xlsApp = Nothing Debug.Print Dat_A End Sub
ひょっとして、そのデータベースを復元しようとしている環境のファイルシステムはFAT32形式ではないでしょうか。 FAT32形式ですと、ファイルの最大サイズが4GBに制限されているので、11GBのファイルを作成することができません。 これが原因の場合、ファイルシステムをNTFSに変更するか、あるいはデータベースをダンプする前にあらかじめトランザクションログをtruncateしておく必要があります。 ダンプファイルからログを除いてデータ部分のみリストアする方法は、SQL Server 7.0ないしそれ以前には存在しませんでした。SQL Server 2000についてはちょっと分かりません。
結論から言うと、ご希望の関数はありません。 mid関数で文字をひとつずつ検査してアルファベット化どうかを判断する自前関数を作るしかありません。 create procedure alpha @moji varchar(100) as declare @kekka varchar(100) declare @i int set @kekka = '' set @i=1 while @i<=len(@moji) begin if substring(@moji,@i,1) >='a' and substring(@moji,@i,1)<='Z' set @kekka = @kekka + substring(@moji,@i,1) set @i=@i+1 end select @kekka
どちらも認証のことだけなので、それによるデータ破損は考えられません。 認証方法導入について(参考までの個人的意見です) ※Windows統合認証 ドメインでのネットワーク構成がなされている環境開発に適しています。 開発要員が増えたり減ったりするのであれば、端末に設定しないでも、ドメインサーバでDBアクセスと権限が管理ができちゃいます。小さなプロジェクトなら、そんな事は意識しなくてもよいと思いますが、大きなプロジェクトなら、導入前テスト用に複数のテスト用SQLサーバが存在し、その中にチーム別のDBを持っている場合があります。そういう時こそ、威力を発揮すると思います。 しっかり管理しているのであれば、実環境での導入も不可能では無いですが、もし最高権限を持った人がPCをつけっぱなしで席を離れたら、データ操作をされる恐れがあるので、あまり運用では聞きません。 ※SQL Server認証 もちろんID/PASSを知っていないとログインできません。 小まめにPASSを変更すると、関係者に周知しなければならないので、開発では向かないですが、周知する必要の無い実環境には適しています。 ただ、「実環境がSQL Server認証だから、開発もSQL Server認証で」というプロジェクトもあるとは思いますが、それはそれで問題は全然ありません。 プロジェクト管理者がPCをつけっぱなしで席を離れることがあっても、DB関係のアプリケーションさえ立ち上げていなければ、直接の改ざんは不可能です。(Windows統合認証よりは全然マシです)
動作環境が限定されるが、出来なくはない。 http://homepage1.nifty.com/kojama/works/rdbms/co … ローカルなHTMLファイルならこれでいいですが、 Webならば、通常はサーバ側で行ないます。 Webアプリケーション http://e-words.jp/w/WAS.html Perl PHP JSP ASP ASP.NET などで開発します。
SQL State：’08001’SQL Server エラー ： 11 上記だと単純にネットワークがつながってない状態のエラーのはずですが。 そのＰＣの出ているパソコンを再起動しても直らない場合 はＬＡＮ関連機器が故障している・正しく接続されていない等の可能性があります。 ケーブル、ハブ等の接続の状態確認し必要があれば正常なものと交換して確認してみてください。 あとログイン名を変更したなど、サーバーに登録した内容を変更してしまった場合にも出ますので、もし変更したような場合は元の内容に戻します。
<NULL> の入力は Ctrl + 0 です。
update A set 社員数=B.社員数 from A, B where A.ID = B.ID でいかがでしょうか。
なんだか国語カテゴリの質問みたい(笑) 「役職」 「当番」 「権限」 「できること」（小学校みたいだ(笑)） 「機能」（あまりに広い意味を持つ言葉なので使いづらいですが） 「許可」（各コラムごとに「〇〇を許可する」「××を許可する」と書いた上で、全体を総称して「許可」や「許可一覧」とする） あるいはいっそ、「許認可権限」とでもすれば、役所からの連想である程度分かってもらえるかも・・・ しかし、短い、簡潔な単語「だけ」で理解してもらうのは難しかろうと思います。「ロール」も、ただ「ロール」とだけ書いてあって英語圏の人に分かってもらえるかというと、その筋の人だけしか分からないでしょう。 ある程度の説明文章を付けた上でなら「役割」でもいいような気がします。「役割：〇〇を××する□□のこと。例えば・・・」と、同じ画面上に表示するわけです。
巨大な環境なら混み合うとでますね。 始めはインストールミスかと思ったのですが、重たい処理を平行に流すと頻繁にでました。 通信関係だと思うんですけどね。 スタンドアローンならごめんなさいね。
>Windowsのバージョンも関係しているのでしょうか？ う～む。。。関係ないと思うのですが。。。あるのかな～ であれば、Enterprise Managerのデタッチ/アタッチで、MDFとLDFファイルをコピるっていうのはどうでしょうか？ 方法がわからなかったら、補足に書いてください。
ストプロで、カーソルに格納したレコードを、１変数にセットしたく思います。 収め方はいろいろあります。 ・テンプテーブルを作成 ・カーソルのまま処理 ・配列にセット この後の処理で何がしたいかがわかれば、おのずと最適な格納方法がわかるのですが、、、
目的が「CSV形式の文字列からなる結果セットを作成する」（つまり、クエリの結果をファイルにするプログラムは別に用意してある）のであれば、非文字列カラムをすべて文字列化して連結、つまり 　　select a+','+convert(varchar(10),b) from test みたいなクエリの実行でできます。結果は 　　aaa,1 　　bbb,2 のようになるので、その結果セットをファイルに出力してください。 目的が「CSV形式ファイルを作成する」（つまり、クエリの結果をファイルにするプログラムも用意していない）のであれば、一括コピーユーティリティ（bcp.exe）が使用できます。 bcpを使用する例は 「CSVファイルにエクスポートするには？」 http://homepage1.nifty.com/kojama/works/rdbms/ms … 「BCPツールでCSV出力すると、空白が一つ入ってしまいます。」 http://www.atmarkit.co.jp/bbs/phpBB/viewtopic.ph … 等にあります。 なお、出力すべきデータの中にコンマが含まれる場合の条件付けは別途必要になりますのでご注意ください。
参考URLに書いてありますが、基本的にはデータベースをバックアップ・デタッチしてＳＱＬＳｅｒｖｅｒを再インストール→ＳＰ４の直前のパッチ適用→データベース復元という手順になるようです。 参考URL：http://download.microsoft.com/download/7/c/2/7c2 …
質問の仕方については 「真・技術系メーリングリスト FAQ」 http://www.geocities.co.jp/SiliconValley/5656/ 　第5章 質問はしてみたけれど・・・ 　　Q:「ソースを見せてください」と言われました。　守秘義務があるので見せられないのですが、どうすれば良いでしょうか? が参考になるかと思います。（これ以外にも、メーリングリストへの質問でなくても役に立つ情報満載です。）
正式な方法はデータベースごとに転送するか、ダンプ（バックアップ）を取っておいてロード（復元）することなのですが、もしも全データベースのバックアップ・リストアで、なおかつフォルダ構成を変えないのであれば、データベースデバイスファイル（*.dat）をコピーする手もあります。 なお、データベースデバイスファイルのうち一部だけをコピーして済ませることはできません。必ず全部まとめてコピーしてください。またコピーする前にデータベースサービスを停止しておいてください。 ※注：私は何度かこの方法を使ったことがありますが、マニュアルに記述のある方法ではありませんので、常に正常な状態のデータベースが得られるという保証はできません。コピー後dbccする等、チェックは十分行ってください。 フォルダ構成が変わる場合（例えばC:\MSSQL\DATA\がD:\MSSQL\DATA\に変わる場合）は、この方法は使えません。
select 名前,歳 into #1 from T_master --ワーク＃１に吐き出し select * from #1 --ワーク確認（はしょってもOK） truncate table T_A --移行テーブルトラン insert into T_A select * from #1 --挿入 見たいな方法でいけないのですか？ ２つ作っておけば簡単にデータ写せますよ。
「ヌル文字列」と「1字空白」が区別されないのはSQL Serverの仕様ですので、「ヌル文字列」と「1字空白」を区別するには、どちらかを別の形で表現するしかありません。例えば「ヌル文字列」のかわりにNULLを使う等です。
サーバのOSがWindows 2003 SP1（あるいはWindows XP SP2）であれば、Windowsの標準機能であるWindowsファイアウォール設定で制限を加えることができます。 設定手順は以下のとおりです。 1. コントロールパネル→Windowsファイアウォールを選択。 2. 「全般」タブで「有効（推奨）(O)」を選択し「例外を許可しない(D)」のチェックを外す。 3. 「例外」タブで「プログラム及びサービス」一覧からSQL Serverを選択して「編集(E)...」をクリック（存在しない場合は「ポートの追加(R)...」をクリックして適当な名称とSQL Serverのポート番号を入力）。 4. 「スコープの変更(C)...」をクリックして接続を許可するクライアントのIPアドレスを指定。
＞どのような項目にインデックスを定義すると、効果が高いですか？ カーディナリティ（=cardinality，基数，要素の数）が高いものに設定するのが効果的です。 高いもので最たる物は、プライマリーキー（主キー）になります。 ＞複数のインデックスが定義されていた場合に、 ＞使用するインデックスがどのようにして選択されるのでしょうか？ オプチマイザが判断するコストが低い順です。 このコストが低いければ、インデックスがあっても使用されないこともあります。 インデックス１（ａ，ｂ）、インデックス２（ｂ，ａ）とあったとして、 条件がｂに対してだけであれば、インデックス２が使用されますが、 インデックス１しかない状態であれば、インデックスはまず使用されません。 それは、インデックス１がｂに対して索引にはならないからです。 では、使用される組み合わせ全てのインデックスを持てば効率的かといえば、 そうはなりません。 確かに照会では効率が上がるかもしれませんが、更新では効率が落ちてしまします。 さらに、物理的な資源を消費することにもなります。
質問のタイトルのとおり、クエリアナライザのデバッグ実行を使用します。 「SQL クエリアナライザ Part 2」 http://www.sqlpassj.org/dbe/kaihatsu/02.aspx の「Tips1 ストアドプロシージャのデバッグ実行機能」に、簡単な解説があります。 その他、Visual Studio .NETのSQLデバッグ機能を使用してデバッグすることもできます。
ここのカテゴリってSQLSERVERですよね？ >>text LIKE '%'|| word ||'%' >>今SQLite このあたりを見ると違うDBのような・・ 知識不足でごめんなさい 以下のSQLでうまくいく予定ですが 長文SQLでごめんなさい SELECT A.text,A.code,A.num From ( SELECT sample1.text,sample1.code,c_text.num,Count(*) as 出現回数 FROM sample1,buf1,c_text WHERE sample1.code = buf1.g_num AND sample1.code = c_text.g_code AND sample1.text LIKE '%' + c_text.word + '%' Group By sample1.text,sample1.code,c_text.num ) A ,( SELECT B.text,MAX(出現回数) 出現回数最大 From ( SELECT sample1.text,c_text.num, Count(*) as 出現回数 FROM sample1,buf1,c_text WHERE sample1.code = buf1.g_num AND sample1.code = c_text.g_code AND sample1.text LIKE '%'+c_text.word + '%' Group By sample1.text,c_text.num ) as B Group By B.text ) BB WHERE A.text = BB.text AND A.出現回数 = 出現回数最大
#1です。 全くごもっともです。インデクスがないと今回の用途ではフルスキャンになるため、当然付けているものという思い込みがあり、それが前提条件であることを書くのをすっかり忘れていました。
なるほど、「別サーバ」が問題だったんですね(^^; 今試験できる環境にないので、以下は参考にならないでしょうか？ http://oshiete1.goo.ne.jp/kotaeru.php3?q=1523790
WindowsのバージョンによってODBCデータソースのあるフォルダが違いますが　コントロールパネルもしくはコントロールパネルにある管理ツール内にODBCデータソースがあります。 ODBCデータソースを立ち上げるとODBCデータソースアドミニストレータが表示されます。ユーザーDSNで設定します。 追加をクリックするとソースのドライバ一覧が表示されますのでODBCで使用したいドライバを選択し完了をクリックするとそのソースのセットアップウィザードが開きますので順次進めます。 大体はデータソース名（任意）を付けてその元になるDB等の場所とファイルを選択します。 ログイン名やパスワードがある場合は詳細設定で設定します。 順次進めていくと接続テストが出来ますのでテストがOKなら完了です。 後はそのユーザーDSNを使いたいアプリで指定すれば使えます。 接続テストしてもうまくいかない場合は削除してもう一度やり直せば大丈夫なので頑張ってやってみてください。
整数にavgを適用すると整数で返すからです。 avgの対象を浮動小数点数に変換しておけば浮動小数点数で値が返ります。 select a from test select avg(a) from test select avg(a+0.0) from test 【結果】 a ----------- 1 1 1 1 2 ----------- 1 ------------------------------------------ 1.200000 ということです。
SQL Enterprise Managerで設定したいSQL Serverを右クリックして「環境設定」を選択、さらに「設定」タブを選択すると設定項目の中にMAXDOPがないでしょうか。
bulk insertは単なるSQLステートメントですから、一般のSQLステートメント（例えば単一のinsert）を送出する場合と同じ扱いでSQL Serverに送って処理させることができます。 例えばODBCを使用するとか、あるいはDB-Librartを使って送出する等です。 別の方法として、一括コピー関数（bulk-copy function）を使用する手もあります。 「Bulk-Copy Functions」 http://www.microsoft.com/japan/msdn/library/defa … 上記にあるのはDB-Libraryの一括コピー関数ですが、ODBCにも一括コピーAPIがあるようですので、そちらを利用してもよいかと思います。
SQL Server が手元にないんですが、標準のSQLでしたら、 SELECT Place, CASE WHEN Area IS NULL OR Area = 0 THEN Area ELSE CAST(Area AS CHAR) || "m2" END FROM MyTable CAST(Area AS CHAR) || "m2" の部分は、SQL Server で動くんでしたら、Area + "m2" のままでいいでしょう。
テーブルの形は完全に同一ですか？ SQLスクリプトをエンタープライズマネージャで生成してみて確認できますか？ また Identify 形式を利用していませんか？
レコードデータサイズで大事なことが1つ抜けていました。 NULL許容カラムは、そうでないカラムよりも1バイト大きくなります。ですので、例えば10カラムあって全部NULL許容の場合は、そうでない場合と比較してレコードデータサイズが10バイト大きくなります。
「SQL Developer Center - Columns: SQL Server 2000 における Web アプリケーション開発」 http://www.microsoft.com/japan/msdn/sqlserver/co … のシリーズはいかがでしょうか。
直訳すると --------------------------------------------------------------------- 更新しなさい　AbcMstテーブル AbcMstテーブルのmemberNoカラムはAbc2テーブルのmemberNoに AbcMstテーブルのTelカラムはAbc2テーブルのTelに 変更内容を参照するレコードはAbcMstテーブルとAbc2テーブル（AbcMstテーブルのBBBNumが'00001'を抽出した物）を双方のmemberNoの右側5桁で内部結合した物。（同じ物） 変更対象レコードはAbcMstテーブルのBBBNumカラムが'00555'の物 --------------------------------------------------------------------- 以上を解かりやすく説明すれば AbcMstテーブルのBBBNumが'00555'のレコードに対して memberNoカラムとTelカラムの更新をしろ 参照する値はBBBNumが'00001'でmemberNoの右側5桁が同じ物。 このSQLでちょっと気になるところはmemberNoの右側5桁を参照した時、選択される項目が複数件になったときにSQLがどう動くかですね。
＞エラーで ＞"System.DataSqlclient.SqlException"のハンドルされていない例外がsystem.data.dllで発生しました。 というのはもっと詳細に分からないものしょうか？ .netについては、詳しくないのですが・・ SQL文にエラーがあるのだと推測できるので、まずは、server1でSQL文が処理できるか 処理できないかを確認した方が良いでしょう。 SQLserverのクライアントツール（何でも良い）で、SQL文を処理してみてください。
コントロール名のネーミングが良くない場合は、書き方を変えることで通る場合があります。 Forms("フォーム名").Controls("コントロール名") もしこれでだめなら >設定したのですがエラーがでます どのようなエラーがでているのですか？
まずVBAとSQLの２つのプログラムコードがあることを理解してください。 Forms!・・・はVBAの記述、convertはSQLの記述ですよね。SQLのconvert関数の中にVBAの記述をしても理解できません。SQLにわたすとき、つまりSQL文の変数を作るときにそのへんを考慮します。 具体的には sql = "項目名 = " & forms("MainCommunication_F").controls("Frm_1") とすればいけるんじゃないでしょうか。
「表示形式'00000'」が何を指しているのかよく分からないのですが、こういうことでしょうか。 select a from test select right("0000"+convert(varchar(10),a),5) from test a ----------- 1 22 333 4444 55555 ---------- 00001 00022 00333 04444 55555
Northwind and pubs Sample Databases http://www.microsoft.com/downloads/details.aspx? … "New scripts for creating the Northwind and pubs sample databases for use with SQL Server 2000 and MSDE 2000." ちなみに、Googleに "sql server" northwind sample database を入力した検索結果の先頭に出てきました。 参考URL：http://www.microsoft.com/downloads/details.aspx? …
そこまでお分かりなら、もう答えは出たようなものなのですが・・・想像力をもう少しだけ働かせてください。 　　select getdate() 　　select convert(varchar(20), getdate(), 114) 　　select convert(varchar(10), getdate(), 114) をクエリすると 　　--------------------------- 　　2005/7/12 12:46 　　(1 件 処理されました) 　　 　　-------------------- 　　12:46:41:666 　　(1 件 処理されました) 　　 　　---------- 　　12:46:41:6 　　(1 件 処理されました) こうなります。 これならばお分かりになるでしょうか。
システムストアドプロシージャsp_lockを使用してはいかがでしょうか。 詳しい解説はヘルプにもありますが、使用例が http://www.microsoft.com/japan/msdn/sqlserver/co … で説明されています。 参考URL：http://www.microsoft.com/japan/msdn/sqlserver/co …
bcp（バッチコピープログラム）というユーティリティを使用してテーブルの内容をインポート・エクスポートすることができます。 オプションが多数あるので、使用方法はヘルプを参照してください。 このカテゴリでbcpを検索すると何件か回答があるので、それも参考になると思います。 参考URL：http://www.systeminfinity.co.jp/sub/tech/doc/SQL …
ストアドでUPDATEを書いておいて、アクセスからストアドをコールする方法が一般的かと思います。 create文でストアドを作ってみてください。 残念ながらSQL文を打ち込むかったるい作業です。 参考文献はMSDNやNETに転がっています。 がんばってくださいね。
あまり自信はないのですが、なかなか回答が付かないようですので・・・ 私もちょっと試してみたのですが、ストアドプロシージャが返すレコードセットを別のSQL分のパラメータとして使用するのは、普通の方法では無理そうでした。 そこで、「普通の方法では無理」ということを前提にした上で、次の方法はいかがでしょうか。 (1) ストアドプロシージャの構造を変える Proc_Aがレコードセットを返すのではなく変数に値を返す構造になっていれば、問題はないわけです。 ですので、Proc_Aと同じレコードセット（1行1列）をパラメータとして返す新しいストアドプロシージャProc_A'を作成し、それを使用するのはいかがでしょうか。 なお、現状でProc_Aも必要としているのであれば、Proc_AとProc_A'でほぼ同じクエリが重複してしまうので、Proc_AはProc_A'を使用する形に書き直すほうがより好ましいかと思います。 (2) 超が付くほど強引な方法です ストアドプロシージャProc_Aの内容（SQL文）を取得することは可能なので、それをそっくり取得して、その中にあるSELECT ...をSELECT @var=...に変更してダイナミック実行し、取得した値をパラメータとして返すのはいかがでしょうか。 Proc_Aが自前のストアドプロシージャであれば(1)のように書き換えてしまえばいいわけですが、ヨソのストアドプロシージャであって内容がいつどのように変わるか定かではないという場合には、こんな方法を取るのもやむを得ないのかなと思います。
フィールドのタイプがわからないけど値リスト関係の設定か？
おまけですが、次のようにすると、どの科目かも出せます。 select t0.n,t1.kamoku,floor(t1.p), t2.kamoku,floor(t2.p), t3.kamoku,floor(t3.p), t4.kamoku,floor(t4.p) from aaa as t0, (select n,k+0.3 as p,'国語' as kamoku from aaa union select n,s+0.2 as p,'算数' as kamoku from aaa union select n,r+0.1 as p,'理科' as kamoku from aaa union select n,sh as p,'社会' as kamoku from aaa) as t1, (select n,k+0.3 as p,'国語' as kamoku from aaa union select n,s+0.2 as p,'算数' as kamoku from aaa union select n,r+0.1 as p,'理科' as kamoku from aaa union select n,sh as p,'社会' as kamoku from aaa) as t2, (select n,k+0.3 as p,'国語' as kamoku from aaa union select n,s+0.2 as p,'算数' as kamoku from aaa union select n,r+0.1 as p,'理科' as kamoku from aaa union select n,sh as p,'社会' as kamoku from aaa) as t3, (select n,k+0.3 as p,'国語' as kamoku from aaa union select n,s+0.2 as p,'算数' as kamoku from aaa union select n,r+0.1 as p,'理科' as kamoku from aaa union select n,sh as p,'社会' as kamoku from aaa) as t4 where t0.n = t1.n and t0.n = t2.n and t0.n = t3.n and t0.n = t4.n and t1.p > t2.p and t2.p > t3.p and t3.p > t4.p
ちょっと自信がないのですが、リレーションはることでできませんでしたっけ？ トリガは、No1さんのいわれるとおり、insertedとdeletedという一時テーブルを使うのですが、 updateが走ったとき、deleted+insertedを使います。 なので、 FOR INSERTのときには insert into TABLE2 select * from inserted とか FOR DELETEのときには detete TABLE2 where 主キー = (select 主キー from deleted) とか、そんなかんじで使います。 でも、あんまり頻繁に更新がかかるようなら、とても重くなったはずなので、あんまりオススメしません。 プログラム側で、同じように更新をかけに行くようにするか、リレーション（自信ないですが）かなと思います その線で一度みてみてください
MSDEとはMicrosoft SQLSerever Desktop Editionの略です。 会計ソフトに同封されていた制限使用ライセンスのEDITIONによるでしょう。 混在は無理と思います。
SECTN_Cの0か1というのが「単年月」「複数年月」という事ですか？ あとWHERE句でどういったデータを抽出しようとしているのかが良く分かりませんが、そのまま使用させてもらうとして以下のようだとどうでしょうか？ SELECT SECTN_C, TK = sum(CASE WHEN CTR_M = '2005/06/01' THEN COSTM_GR ELSE 0 END), sum(COSTM_GR) AS TR FROM V_TEST WHERE CTR_M = '2005/06/01' OR CTR_M = '2005/04/01' GROUP BY SECTN_C
ぱっと思い浮かんだ方法なのですが、 １）Excel表（以下Ａ）と比較したいデータベースのテーブルを、Excelにエクスポートする ２）エクスポートしたExcel表（以下Ｂ）のID列を昇順に並べ替える ３）ＡのID列の真横にでも（どこでもいいですが…）１列挿入し、Vlookup関数を使ってＢと比較させる。一致したら◎、一致しないとき×など、IF関数も組み合わせてください ４）VBAを使用して、Vlookup関数の列が◎の行の、１と書かれているセルを０に上書きするという処理を作る …完全自己流ですみません。もし挑戦できそうなら、試してみてください。 それ以前に目的と間違っていたらすみません。
それぞれ、システム関数HOST_NAMEとSUSER_SNAMEではいかがでしょうか。
現在SQL Serverで試験できないので、AccessでテストしたSQL文です。テーブルは単純化し ・売上テーブル 売上NO:Pkey 品名 販売単価 ・ワークテーブル id:Pkey 品名 販売単価 です。 まず一次試験として SELECT (SELECT COUNT(*)+1 FROM ワークテーブル WHERE (ワークテーブル.品名<S.品名) OR ((ワークテーブル.品名=S.品名) AND (ワークテーブル.id>S.id))) AS [No], S.品名, S.販売単価 FROM ワークテーブル AS S ORDER BY S.品名; このSQL文はいかがでしょうか？品名順に連番が振られるようであれば INSERT INTO 売上テーブル ( 売上NO, 品名, 販売単価 ) SELECT (SELECT COUNT(*)+1 FROM ワークテーブル WHERE (ワークテーブル.品名<S.品名) OR ((ワークテーブル.品名=S.品名) AND (ワークテーブル.id>S.id))) AS [No], S.品名, S.販売単価 FROM ワークテーブル AS S; これで売り上げテーブルに「主キー重複エラー」なしにINSERT出来ます。 勿論、最終的にお望みのものにするためには right('0000000000' + (convert(nvarchar,max(売上ＮＯ) ここら辺の処理が必要なわけですが。 蛇足かもしれませんが、ワークテーブルに id を置いたのはともかく重複しない Pkey が必要だからで、それがないと連番が崩れます。
このクエリでいかがでしょうか？。 SELECT TOP 100 * FROM TableA ORDER BY newid();
MSDEのバージョンを書いてよ。 > MSDEってローカルのみしか接続できないのでしょうか？ MSDE2000ReleaseAなら、デフォルトのインストールでそうなります。 インストール時にDISABLENETWORKPROTOCOLS=0を指定するか、 インストール後にSVRNETCN.EXEでTCP/IP接続を有効にする必要があります。 サーバ側で netstat -an を実行して TCP 1433 Listeningと表示されますか？
　無線LANというのは、理論上はLANケーブルの部分が電波になっただけだ。理論上LANケーブル上で動くものは全て動く。理論上ね。まぁ、pingが飛んでHTTPやFTPが繋がれば全く問題は無いよ。 　ところで、SQL Serverに接続するとは、プログラム作るのか、Enterprise Managerなどを使うのか、どちらだろうか。 　プログラムから接続するには、最低限MDACがあれば良いが、SQL Serverのクライアントをインストールした方が便利は便利だ。 　Enterprise Managerやisqlw(クエリアナライザ)はSQL Serverクライアントに含まれるものなので当然インストールが必要になる。
結論だけ言えば「出来る」でしょう。 しかし状況がはっきりしません。 １．Bは参照だけでよい ２．Bは、Aの処理が終わった後データを変更したい ３．上記２．であれば、処理可能になった通知が欲しいのか など、です。 しかし何も考えずに作っても、データベースがかなりカバーしてくれるような気もします。A01のデータに対し複数の変更が行われれば、それなりの警告を出してくれます。 まずはプロトタイプを作成し、上記状況を実験してみてはいかがでしょう。一台のPCからでも実験できるはずです。
生きているStandardEditionが手元に無いので EnterpriseEditionで試してみました。 バックアップ先指定時（追加）に、 "\\Remote_Server\Share_folder\BackupFile" の形式で入力することで、 ネットワーク共有されたドライブにバックアップファイルが作成されました。 恐らく、StandardEditionでも、選択するのではなく 共有先を自力で入力すればできるのではないでしょうか。
型をintとしてidentity列にすればいいです。
SQLServer2005は今年11月発表予定なので 日本での発売は年末ぎりぎりではないでしょうか？！ なので、まだ販売されておりません。
BCPなるコマンドラインツールが、それにあたるかと思います。 コミット間隔も指定できるので、件数が増えても それなりに使えるのではないでしょうか。
Oracleだとsysdateでシステム日付(サーバ日付)を取得できるのですが。 クライアントの日付取得は MyDate = format(now, "yyyy.mm.dd hh:mm:ss") のようにして取得できないでしょうか。 DATEADD(d,-1,MyDate) Date関数・Now関数ではどうでしょうか DATEADD(d,-1,Date) DATEADD(d,-1,Now)
前の投稿で書いていますが、SQLserver付属のbcpやdtsで、CSVを作れば良いんじゃないですか？ 当然、なんらかの条件で、unixへ連れ出す情報は、SQLserver上で絞れる前提ですが．． dtsは詳しくないですが、少なくともbcpで、抽出条件付きでCSVファイルを出力できますので。 CSVファイル（テキスト）ベースであれば、文字コード変換の問題も簡単にクリアできますし、 CSVがロードできないデータベースは少ないので、unix側のＲＤＢに何を使っても困らないと思います。
　特に SQL Server に限った場合だと、「ほとんど同じ」のようです。 　もしかしたら扱える桁数とか微妙に違うかもしれませんが。 　おそらくは互換性のために残されているんじゃないかと。
すいません、下の#4のＳＱＬに1箇所間違いがありました。 select WK1.区分, WK1.年月, 　　　 WK2.金額 　from テーブルＡ WK2, 　　　　(select max(年月) as 年月, 　　　　　　　　区分 as 区分 　　　　　 from テーブルＡ 　　　　　　　　 ~~~~~~~~~~ 　　　　group by 区分) WK1 where WK2.区分 = WK1.区分 　and WK2.年月 = WK1.年月
> DBのデータではなく、プログラム自身にかいたItemを表示させることはできました。 　Good Job！　じゃあ次のステップは、「Itemを設定する段階で、あるテーブルのレコードセットが取得されている事」やね。 　これは、別にDataGridの中という話でもなんでもなく、プログラム中にADO.NETでDataReaderなどを使うだけの話やわいな。 　その、Itemに設定しているプログラムはDataGridのイベント中に書いているのかな？　その中で普通にDataReaderやDataAdapterを使ってデータを取ってくれば良い。DataSetと組み合わせても良いし。
oracleしか知らないのでそれを前提に ＜バイナリをDB化するメリット＞ ・DB内で閉じたレコード操作（COPY、DELETEなど）をする際にプログラムが簡単 ・DBのセキュリティに守られる。 ・バックアップ・リストアのトランザクションが容易 ＜バイナリを外部ファイルにするメリット＞ ・DB容量が少なくてよい、容量見積もりが簡単 ・外部ファイルのある場所はDBでなくともネットワーク上にいればいいので分散管理できる。また移行も簡単（外部ファイルの物理コピー及びDB上のファイルパスの付け替え） ・ローダーなどのツールが使用可能もしくは容易 ・システム外、外部ファイルをメールなどのグループウェアと連携させることも容易 といったところで一長一短があります。 構築するシステムにも依存するので上記の条件にどれくらい当てはまるかですね。 また、一般論は知りませんが、私はwordやexcelといったpcファイルをバイナリデータとしてDBに取り込んでいるシステムは見たことはないです。(検討したことはあるのですが、DBの容量が不採決の理由です） ツールは知りません。
bcpを使えばできます。 ただし、列名は出力できません。
動くでしょう。 一度やってみたら。 ただし、期待通りの動きはしません。##tmpは接続ごとの一時テーブルですのでたとえば、 １．ＶＢから当該プロシージャを読んで##tmpを作成 ２．ＶＢから##tmpを参照 としても１と２は接続が別なので参照できません。
かなり強引ですが・・・ select * from dual a b --------------------------- --------------------------- 2005/2/16 0:00 2005/3/16 0:00 2005/7/16 0:00 2005/8/16 0:00 2005/2/16 0:00 2005/3/17 0:00 のとき、 select datediff( 　　mm, 　　datename(yy, a) + '-' + datename(mm, a) + '-1', 　　datename(yy, b) + '-' + datename(mm, b) + '-1' 　　) + 　　case 　　　　when datename(dd, a) < datename(dd, b) 　　　　　　then 1 　　　　　　else 0 　　end 　　from dual ----------- 1 1 2 となります。 内容は (1) aとbをyyyy/mm/ddからyyyy/mm/1（月始め）に変換し、datediffで月数を計算 (2) aの日付(dd)よりbの日付(dd)が大きい場合は切り上げるので月数を1つ増やす というものです。 （SQL文中のインデントは全角空白なので、そのままコピー＆ペーストでは使えません。ご注意ください。）
とりあえず、MSDNの情報です。 機械翻訳らしいので、わかりにくいですが・・・（＾＾； 「322 ジョブ詳細 テーブルにレコードを追加するのを試みているエラーがジョブで発生し、ジョブのターゲット ワークステーションの一覧は生成できません。 考えられる原因のつが SQL server は使用できないです。 表示されたターゲット ワークステーションの一覧が空だったから、任意のアクションを実行するを使わないで、ジョブが 」 回答じゃないですね（＾＾； 英文サイトならもっとわかりやすいかもしれません。 参考URL：http://support.microsoft.com/default.aspx?scid=k …
ODBCデータソースアドミニストレータでデータソースを設定しテストしてみてください。 ウィザードに従って設定していくと最後に接続テストが出来ます。 ＳＱＬサーバーの指定の仕方に間違ったところがあるのだと思うのですが・・。別のネットワークにあるＳＱＬサーバーへ接続する設定にしてみてください。ＳＱＬサーバーにはネットワーク参照でたどり着けるはずです。
すみません。回答遅くなりました。 >1.上記のクエリは変更前のコンピュータで実行すればよろしいのでしょうか？ >変更後だとSQLserverに接続できない為実行できません。 変更後に行います。 master.sysserversテーブルにサーバ名が保存されており、 その内容を更新するストアドプロシージャになります。 >2.クエリ部分に打ち込むのは、USE master～go迄の >5行でよろしいのでしょうか？ はい、それで大丈夫です。 ストアド自体の補足ですが、以下を参照してみてください。 http://www.microsoft.com/japan/msdn/library/defa … http://www.microsoft.com/japan/msdn/library/defa … それと同じエラー事象がありますので、ここも参考になるかも知れません。 http://www.casupport.jp/resources/tng/tecdoc/031 …
確認なんだが、AとBはそれぞれ USE A、USE Bでテーブルにアクセスできるんだね？ それはユーザじゃなくてデータベースだ。ログインとデータベースユーザとデータベースの関係についてはBooksOnlineを参照の事。ってMSDEか・・・・。OracleとSQL Serverの違いは、両方使えるようにしたい場合は一通り勉強しておこう。 で、データベースAを使用している状態で、データベースBのテーブルを読むには、仮に今ログインしているログイン名をshiraoとし、データベースユーザも同じとすると select * from B.shirao.CLR01 となる。
ネットワークでつながってないですか。 それではサーバーAに何かデータベースを作成してそこへ移行してください。作成する際にはサイズを小さくしておいて自動拡張にしておけば、必要最低限のサイズになるかと思います。それをバックアップすればどうでしょうか。
少なくとも「CGIと言えば言語はPerl」と分かるぐらいに勉強してください。 検索サイトは参考URLのように仕組みが異なります。 どのような仕組みにするかでプログラムや運用方法が異なってくるでしょう。 また誰（ryo78さんだけか、不特定多数の人か、社内の人間だけか）が、どのような目的で使用するかで用件は固まってくると思います。 もう少し絞り込んでから、質問をしてみてはいかがでしょうか？ 参考URL：http://www.affiliatemanual.net/seo/shurui.html
コネクションを開くときに接続時間を指定するはずですが、十分な時間になっていますか？ con.Openを実行する前に、 con.ConnectionTimeOut の設定をしてあるか確認してみてください。
Null のレコードを0として扱いたいのであれば、 select IsNull(労働時間, 0) as 労働時間 from table where としてあげれば、労働時間のフィールドがNullの場合、かわりの値として0を 出力することができます。 ・・ということでよろしいでしょうか。 くわしくは、BooksOnlineで、isnull関数を調べてみてください。
では、単純にアンインストール、インストールではどうでしょうか？ ユーザ情報等、とんでしまいますが、データベースそのものは、 MDF,LDFファイルをバックアップ（コピー）しておき、 (1)インストール後、新規DB作成(以前と同じ名称） (2)SQL Serverサービスを停止 (3)新規DB作成されたMDF,LDFファイルにバックアップ 　 していたファイルを上書き これでDB自体は元に戻るので、MMCコンソールだけの問題であれば 良いのかな？と。 でも再インストールしてもダメとのことなので、 この手順では、もう試しているんですよね。。。 私の場合、最後の「ファイルへのアクセス権...」という メッセージはなかったので、その違いが原因かも知れません。 後はレジストリ関係でしょうか。。。 あまりお役に立てず、すみません。
気をつけるところは、アクセス用のアカウントに関するところだけだと思います。 クライアントからODBC等でアクセスする際、もともとSQL Server専用のログインアカウントを使用していれば問題ないのですが、Windowsのログインアカウントを認証に使用している場合は domain\userId で認証しているので、そのあたりの確認が必要でしょう。
オーダリングのログから集計するようなSELECT文をチューニングしたときの経験からいくつか。（SQL Server2000） 実行時にビューの中身をコピーしてからそのテーブルを見るのだとしたらビューだけでやったほうがいいです。 ビューのリアルタイム性が求められていなくて、定期的にビューの結果をテーブルに放り込んでおいてそこから他のリアルタイム性が求められるテーブルと結合してSELECTを発行するのならパフォーマンスは向上します。 サブクエリ、ビューを多用する場合は、ストアドプロシージャで動的にテーブルを作り、そこにデータを放り込んでインデックスを作成してからSELECTした方が早かったりします。 実行プランやプロファイラを見てもいいですが、本当に複雑な場合はDBの仕組みを考えながら人間が最適化したほうが早いですよ。 肝心の回答ですが、「VIEWを通して得るデータにリアルタイム性があるかどうかで変わってくる」、ということになると思います。
自社の社員名簿を使うのが手っ取り早いでしょうか。 実名 → 仮名への変更は、姓と名を1レコードずつずらして結合することで実現しました。 (姓と名の間がスペースで区切られていることを利用) 必要に応じて、住所、e-mailアドレス等も加工して架空の内容に変更します。 件数が足りなければ、必要な回数だけループしてレコードを増やします。(同姓同名の人がN人いることにする) 元のレコードが数100件程度あれば、レコードのカーディナリティはじゅうぶんに実用的だと思います。
whileでまわせば出来るかと declare @d datetime set @d='2005-05-10' while @d<='2005-12-31' begin select @d set @d=dateadd('d',1,@d) end
こんにちは。 個人的な意見ですが、このようなテーブルは正規化したほうが良いかと思いますが… SQLでは、上記の例ですとID=03のレコードから「01,02」という値(文字列)は取得できますが、「01」というデータと「02」というデータを個別にとることは出来ません。 しかも、カンマでいくつ区切られているのかがわからないと、何度繰り返し処理を行えばよいかがわかりません。SQLにそこまで高度な処理を求めるのは無茶です。 とりあえず、「01,02」という値を取得して、これを分解してからもう一度SQLを回す方法が良いかと思います。 どうしてもというのであれば、 【限定１】IDは必ず２桁 【限定２】項目は絶対にカンマ区切りで、余分なスペース等が入らない 【限定３】項目は最大3つのID で、こんな感じで出来なくも無いです。 SELECT ID, 名称, NULL, NULL FROM テーブル WHERE 項目 IS NULL UNION SELECT A.ID, A.名称, A.項目, B.名称 FROM テーブル AS A, テーブル AS B WHERE LEN((A.項目) = 2 AND B.コード=A.項目 UNION SELECT A.ID, A.名称, A.項目, B.名称 & ',' & C.名称 FROM テーブル A, テーブル B, テーブル C WHERE LEN(A.項目)=5 AND B.コード = MID(A.項目,1,2) AND C.コード = MID(A.項目,4,2) UNION SELECT A.ID, A.名称, A.項目, B.名称 & ',' & C.名称 & ',' & D.名称 FROM テーブル A, テーブル B, テーブル C, テーブル D WHERE LEN(A.項目)=8 AND B.コード = MID(A.項目,1,2) AND C.コード = MID(A.項目,4,2) AND D.コード = MID(A.項目,7,2) ; MIDとかLENとかは、DBMSにより変わります。 MID(A,B,C)は文字列AのB番目の文字がC文字分だけ抽出した文字列を返す関数、 LEN(A)は文字列Aの文字列長を返す関数です。DBMSによりこのへんの値を変えてください。 項目カラム内のIDの最大数が増えたら、UNION SELECTをもっと増やせばとりあえずOKです。
ＮＩＣは動作していますか？ ＨＵＢなどの「ＬＡＮケーブルの向こう側」が存在しないと 「ＴＣＰ／ＩＰの動作が正しくない」と解釈し、ＳＱＬサーバが起動できないと思います。 Ｏｒａｃｌｅインストール後動作しない、とありますが、いまＯｒａｃｌｅを起動できますか？ 同じ状況になるように思います。
SEM(SQL Server Enterprize Manager)のみをインストールできます。 インストーラのウィザードで、インストールするコンポーネントを取捨選択できますので。
松本です。 このエラーは、ストアドプロシージャが該当データ ベース内に存在しない場合に発生しますので、 まずは、proc1 が Northwind データベース内に作成 されているかどうかを確認するとよいと思います。 USE Northwind し忘れて master データベース内に 作ってしまうというのはよくある話です。 Northwind データベース内に proc1 があるかどうか を確認するには、クエリアナライザまたは osql から 以下実行して USE Northwind EXEC sp_help 'proc1' 結果が返ってくれば、正しく作られています。 逆に作られていない場合は次のメッセージが表示されます 「オブジェクト 'proc1' はデータベース 'Northwind' に存在しません」 あと、接続文字列の中の Initial Catalog=Northwind または Database=Northwind となっていることも確認 したほうが良いと思います。 あと、cmd.CommandType =　 ← が全角空白になって るのですが、これはコピペ時のミスですよね？
まずはキー設定をはずしてデータを復元し、それから重複データを削除する方法が確実かとおもうのですが
Namazuを使う。 WordやExcelの文書も検索できるようです。 参考URL：http://www.namazu.org/
キーワードが判れば、必要な情報を見つけ出すことは難しくないと思います。 オンラインヘルプも検索エンジンも使い方をご存じないのでしょうか？
SQLserverにそれほど詳しくないんですが・・ ＞SELECT 受注表.受注番号,商品表.商品名 ＞FROM 受注表,商品表 USING(商品コード) ＞WHERE 商品表.単価 >= 500; というSQLは、SQLserverで動きますか？ SELECT 受注表.受注番号,商品表.商品名 FROM 受注表 INNER JOIN 商品表 USING(商品コード) WHERE 商品表.単価 >= 500; というＳＱＬであれば、SQLserver以外の他のＲＤＢでは、構文としてあり得るのですが、 それと勘違いされてませんか？ そうであるなら、理解としては、 FROM A INNER JOIN B USING(KEY_COLUMN) は FROM A INNER JOIN B ON (A.LEY_COLUMN=B.KEY_COLUMN) と同義です。（記述の簡略が可能であると思えば良いかと）
ランダムリードの反対は、シーケンシャルリード、です。 ランダムリードは、データーベースを任意のキーや、レコードの番号でレコードを選択して読み取る方法。 シーケンシャルリードは、データーベースのレコードを、テーブルに並んでいる順に読み取る方法、です。 長所短所、というより・・そもそも、用途が違うので、比較できるモノではありませんね。 一般に、シーケンシャルリードの方が、検索の手間もなく、ディスクバッファなども有効に利用されるので、読み込み速度自体は圧倒的に高速です。
私はOracleをお薦めします。(私見で恐縮ですが・・・) 簡単に比較を以下に説明します。 ・Oracle 　- OSを問わず利用できる 　- 企業で利用されている数が多い(仕事が多い) 　-　Oracle10gからはかなり使いやすい ・SQLServer 　- Windowsのみ 　- 自動的に様々な設定を行ってくれるが、Errorがでたら原因がわからないことが多い 以上となります。
「改訂新版 SQLポケットリファレンス」￥２０７９。これぐらいしか知りませんが重宝しています。 http://www.amazon.co.jp/exec/obidos/ASIN/4774117 … 参考URL：http://www.amazon.co.jp/exec/obidos/ASIN/4774117 …
テーブル２のキー設定はありますか。 どちらにしてもメッセージは気にしなくてもいいです。 そんなものだったような気がします。 またＳＱＬですが上記のものは以下のように簡素化できます。 delete from テーブル２ where 列１= (select 列１ from deleted)
当方の環境でも発生しましたが、接続できるようになりました。 原因が同じかどうか分りませんが、参考になるかもしれませんので投稿します。 【環境】 WindowsXP SP2 Microsoft SQL Server 2005 Express Edition April CTP(日本語版) Microsoft .NET Framework 2.0 Beta2 Microsoft .NET Framework 2.0 日本語Language Pack Beta2 Microsoft SQL Server 2005 Express Manager April CTP(英語版) サービスSQL Server(MSSQLSERVER)のログオンアカウントをデフォルトからドメイン内の自分のアカウントに変更したところ接続できました。なぜそうなのかは、すみません、よく分りません・・・ SQLServer Configuration Manager上でサービスのアカウント設定を変更しようとすると「実行しようとした操作はプロバイダによってサポートされていません」と出るのでアンインストールして、再インストール時にアカウントを設定しました。 なお、SQLServerExpressはデフォルトではリモートアクセスを受け付けない設定になっているそうです。設定手順はこちらで解説されています。 sqlexpress's WebLog How to: Configure Express to accept remote connections http://blogs.msdn.com/sqlexpress/archive/2005/05 …
#1です。 ウイザードで名前が出なくても、直接入力して進めてはだめですか。 ちなみに先のレジストリはnetbios接続、tcp/ip接続を許可するという設定です。 また混合モードで接続する場合は、以下のレジストリ変更が必要です。 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\MSSQLServer 項目名：LoginMode 値；2
インデックスをつけるのが一番簡単だとおもいます。 基本的にはいれた順に並ぶとおもうのですが、そうならない場合もあります。よくわかりません。
これでいけるでしょう。 INSERT INTO tbl2(fld1,fld2,fld3) select Q.fld1,(select top 1 fld2 from tbl1 T1 where T1.fld1 = Q.fld1 order by T1.キーとなる項目),Q.count_fld3 from (select fld1,count(fld3) as count_fld3 from tbl1 group by fld1) Q
ツール→参照設定でmicrosoft ActiveX Data Object2.Xにチェックをいれてください。 上のXは環境によって違うので適当なやつを選んでください。2.5とか2.6なら大丈夫だと思います。
GetChunk メソッドと AppendChunk メソッドは、ADO.NET の DataReader 列、DataSet 列、または Command パラメータでは利用できません。 http://support.microsoft.com/default.aspx?scid=k … とあってDataReaderは使えないと取れますが 実際は使えるようです http://www.atmarkit.co.jp/fdotnet/dotnettips/253 …
アメリカでは、四捨五入といったら偶数丸めだそうです。 私は、C#で開発を行っているのですが、C#では1.2と返ってきます。 1.24→1.2 1.25→1.2 1.26→1.3 1.25で1.3が返ってくるということは、SQLServer2000は厳密（日本風）な四捨五入なんでしょうね。 参考までに。
http://oshiete1.goo.ne.jp/kotaeru.php3?q=1127154 > Microsoftのサイトで調べてみたところ、「同時接続ユーザーは５人以下と想定されています」と書いてあるのですが 何処ですか？ > ・MSDEで認証モードに関わらずWindows統合認証を使う場合はWindows Server CALが必要 Server2003なら、SQL認証でもWindows Server CALが必要
平均チェック数がCategoryIDの平均だと仮定すると、 select customerID,userID,avg(CategoryID) from テーブル group by customerID,userID なんて単純ではないですかね？
ちょっとレスポンスは悪くなると思いますが select (select count(col1) from X as Y where Y.col1<=X.col1) as ID,* from (select * from tabA union select * from tabB) as X
No.1です。 脊髄反射で答えていました。すみません^^; 実際に活用されるSQLがもう少し複雑なのであれば、VIEWを使うと後々使いまわしが効いて便利かもしれませんね。
データベースの構造をどうされているかわかりませんが、ログ領域をたくさんとっていて、ログがいっぱいになったりしていませんか？ そんなときにＤＢに更新・追加やバックアップ処理等が行われると、ログ領域が足りず、エラーになったりします。１４Ｇというと相当大容量なサイズですが、ログの切捨てを実施する事をお勧めします。 コマンドからでもよいですが、SQLServerでお使いのデータベースを右クリックし、データベースの編集を選べば、ログの切捨てが選べると思いますがどうでしょう？ 後コマンドタイムアウトですが、あれって０だか-1だかに設定するとタイムアウトしないようにできませんでしたっけ？フリーズするというのなら、タイムアウトしないようにしたところでしようがないんですが一応。
価格を、どうチェックしたいかがわかりませんので、親／子の全ての価格を同時に問い合わせるSQLを載せています。 select * from ( select 親商品コード１,(select 価格 from 商品コード where 商品コード=親商品コード ) as 親価格, 子商品コード１,(select 価格 from 商品コード where 商品コード=子商品コード１) as 子価格１, 子商品コード２,(select 価格 from 商品コード where 商品コード=子商品コード２) as 子価格２, 子商品コード３,(select 価格 from 商品コード where 商品コード=子商品コード３) as 子価格３, ・ ・ 子商品コード９,(select 価格 from 商品コード where 商品コード=子商品コード９) as 子価格９, 子商品コード１０,(select 価格 from 商品コード where 商品コード=子商品コード１０) as 子価格１０ from マスタ情報 ) 価格差のあるモノだけを問い合わせするなら、最後に where isnull（親価格,0) <> isnull(子価格１,0)+isnull(子価格２,0)+ …… +isnull(子価格１０,0) のような条件を付ければ良いと思います。
その１ 　プログラム上で、テンポラリテーブルを作成し、 　データを書き出す。 　その後、ストアドプロシージャを呼び出し、 　ストアドプロシージャ内で、テンポラリテーブルより 　データを取得する。 　※プログラム側で、トランザクションを制御する。 ◎その２ 　プログラムで、CSVファイルとして吐き出す。 　ストアドプロシージャを呼び出し、ストアドプロシージャ内で、 　BULK INSERTで取得する。 　※WEBアプリなどなら、セッション変数＋時間で、 　　CSVファイル名を一意にする。
どの様に使用するのか分かりませんがSQLServer2000とAccessは共有（共存？）できます。 SQLServer2000をテーブルとしてAccessへテーブルリンクして使用できます。SQLServer2000をバックエンドとしてAccessをフロントエンドとして使ったりとか・・。 SQLServer2000のテーブルをAccessにエクスポートしたりもDAOを使えばできます。 質問の内容と違ったらゴメンなさい。
SQL Server 今はMicrosoftの出しているWindows専用のデータベース。ただし、安いとも言い切れない。Windowsに特化してチューニングされているのが特長ですね。 Sybaseが出していた同名のRDBMSのライセンスを買ってWindowsに移植したモノですが現在のバージョンのコードはほとんど書き換わってます。 Oracle 商用RDBMSの定番。価格は機能に応じて安いのから高いのまであります。（Oracle＝高いと言うすり込みが行われていますが、システムの組み方によってはSQL Severより安くなります。）Linux、Windowsからメインフレームまでほぼ同じ様に動作する互換性が最大の強みでしょうか？イメージとしては中規模から大規模向けですね。 PostgresSQLはオープンソースのRDBMSです。基本的にはOracleクローンを目指しているのか機能は多いですがOracleよりは遅い様です。オープンソースなのでほとんどのOSで動きます。サポートしている会社は日本では多いですが欧米ではMySQLの方が主流の様です。まともにシステム組んでいくとOracleじゃないとダメと言うのが5年ぐらい前の一般的評価でしたが今はどうなんでしょうねぇ？ MySQLも商用以外はフリーのRDBMSです。機能よりも速度重視なので、機能に不足部分がありますが何より軽いです。使えるOSが多いのも魅力でしょうか？
すみません。訂正です。 フィールドＡのデータとテーブルＢのデータのカウント結果を抽出することで 必要な結果を取り出すことができます。 　↓ テーブルＡのフィールドデータと、テーブルＢのフィールドデータのカウント結果を抽出することで 必要な結果を取り出すことができます。
#2の補足です。 convert関数の３つめのパラメータによって日付の書式がかわります。 111 yyyy/mm/dd 112 yyyymmdd 121 yyyy-mm-dd 詳しくはヘルプをみてください
クエリアナライザで出力をファイルにして区切りをカンマにすればよいと思いますが。 またはアクセスプロジェクトでビューをエクスポートするとか。 ボタン一発でやりたいならadoを使って自分でプログラミングするしかないと思います。
SQLを実行してエラーになると@@error変数にエラー番号が格納されます。これを利用してエラーハンドリングをします。 具体的には下のようになります begin trans SQL文１・・・ if @@error<>0 goto XXX SQL文２・・・ if @@error<>0 goto XXX commit return XXX: rollback xp_cmdshell ログ出力するexe return 上の下から２行目のxp_cmdshellはexeをバックグラウンドで実行するものなので、事前にイベントログへ出力するexeを作っておけばよいかと思います。 ただ、想像するにこれは定期的に自動で処理されるものかと思います。そのような場合はSQLエージェントを使用してジョブとして実行すれば、失敗時にイベントログへ出力することはジョブの設定で可能です。
BCP を使用してデータをエクスポートできるようです 。 >bcp テーブル out テーブル名.csv -P -Usa -フォーマットファイル -ログ名.log フォーマットファイルの内容はマニュアルを参照してください。
SELECT ISNULL(フィールドA,0)+ISNULL(フィールドB,0) で良いかと思います。
URIミスりました。 http://www.microsoft.com/japan/sql/techinfo/Admi …
>select a + b from (select 1 as a, 2 as b) >select a from (select 1 as a) > >はNGです。 うーん、残念。 あとはXMLなんかでテーブル作っちゃうかな。
misty7666さんの書き方で取れると思います。 SQL文の日付の指定部分ですが、シングルクォーテーション「'」で囲まれていないと「構文エラー・・・・」 が発生するので、その点を確認してみてください。 （「SELECT * FROM info WHERE date BETWEEN 2004/01/01 AND 2005/01/01」とかになってませんか？）
はじめまして。 ご希望の回答になるかわかりませんが、 SQL Serverの扱い方に関して参考になった本は翔泳社の『SQL Server 2000でいってみよう』です。 SQL Serverの操作方法や構築、保守など一通り書かれています。 SQL構文の参考書はOracleマスターの学習参考書になります。
↓の質問と同じ方ですね＾＾ Accessの場合、業務用アプリケーションが稼動している時に、mdbを 直接開いて更新・追加・削除するとデータの整合性が保たれなくなり mdbの再生成などを行わなければならなくなります。 これは2.0に限った事ではなくAccess全般に言えることですね
Access2.0ですか・・懐かしいですねー今使ってる人は だいぶ少ないと思いますねー＾＾ 私の経験から言わせてもらえば、 XPでは「正常に」動作しません。 実際にXPに導入したわけではありませんが、NT4.0、Win2Kでは ダメだったからです。マイクロソフトさんのサポートも 既に終わっているので調べることが出来ませんが、 Access2.0を使い続けるのならば、Win95・Win98を使う 事をお勧めします
同時接続数の上限に達したのではないでしょうか？
> 今Win2000ProをしようしていますがServer系のOSは必要とするのでしょうか？ 必要ではありません。Win2kで可能ですよ > 後Access2000からMSDEをインストールしましたが設定方法はSQLServerの本を読めばできるのでしょうか？ SQL ServerとMSDEとの違いはご存知でしょうか？SQL ServerにはGUIがついております。視覚的にはACCESSを使用しているみたいな感じになります。MSDEでの設定はすべてMS-DOSで設定します。その違いをクリアできれば十分MSDEでも良いと思います。 アクセス限度などもありますが、がんばってください。
同じテーブルを続けてということは、１回目は出なくて、２回目に出るということですか？ それならば、クローズしていないのにまた接続しようとしているなどが原因として考えられるのではないでしょうか。どのように書かれているのかわからないので、推測でしかありませんが、設定ではなく、プログラムの書き方の問題だと思います。
同一サーバー上であれば Bデータベース上にいるとして、 select * from A.dbo.テーブル名 とか update A.dbo.テーブル名 set ... のようにアクセス可能です。 AとBが別のサーバーの場合は「リンクサーバ」等を 使用します。 詳細はマニュアル（Books Online）参照。
一概には言えません。 項目a と 項目A それぞれのカーディナリティ に左右されると思います。 一般的に、インデックス項目が複数ある場合、 オプティマイザは、カーディナリティが高い （＝列のdistinct値の数が小さい）方を優先 します。 （そうではない場合もあります） つまり、データの分布によって、(1)が速い場合 もあるし、(2)が速い場合もある、と言う事です。
サーバはポートに穴 http://okweb.jp/kotaeru.php3?q=1242610 クライアントはODBC設定 接続するSQLサーバ名は、サーバ側IPアドレス ルータを利用しているなら、ルータのWAN側IPアドレス(サーバでhttp://ddo.jpを見たら、IPアドレスがわかります)
テストしていないので、気づきませんでしたが．． SQLserverだと、インラインビューにも別名を付与しないと いけないかも。 select * from (select ～) as 別名 この別名の箇所は、お好きな名称を付けていただけばＯＫです。
SQLserverのレプリケーション機能を使うより組んだほうがいいような気がします。 件数などがわからないので、的外れなことを書いていいるかもしれませんが、バッチでレプリケーとするなら、AとBとそれぞれのデータをMergedDBへ追加したらどうですか
ＨＤＤ・ＮＴＦＳアクセス権限 を与えていないからじゃないですか？
すみません、end忘れました。 >select case >when 区分 = 1 then 'A' >when 区分 = 2 then 'B' >else 'C' >from テーブル名 select case when 区分 = 1 then 'A' when 区分 = 2 then 'B' else 'C' end from テーブル名 ですね。
ユーザデータベースのテーブルのサイズは厳密に計るのは至難の業です。 ざっくりとしたテーブルのサイズの計算方法ですが 1レコードを 8KB で計算すれば少なく見積もることはない思います。インデックスはテーブルサイズの 30% って感じです。この計算方法はあくまで目安でお願いします。 システムデータベース(master.mdf, master.ldf, msdb.mdf, msdb.ldf, model.mdf, model.ldf) は約60MBです。このサイズはあまり変わらないものなので気にすることはないと思います。 ただし tempdb はちとややこしいです。これのサイズは発行する SQL に依存します。大量のデータで ORDER BY, GROUP BY, UNION などをすると一旦このデータベースに格納するのでそのときは多めに確保してください。 インデックスの見積式については 30% と書きましたが一応ちゃんとした見積式があります。しかしややこしすぎてあまり現実的ではありませんので知らないほうが幸せだと思います。不幸になりたいのでしたら書きまのでいってください。
質問の内容がいまいち理解できませんが・・ 以下脳内妄想 質問 NEC製？のBackup Execというバックアップソフトの MicrosoftSQLServerエージェントを利用して取得した バックアップファイルをSQLServerからアクセスして データベース上に復元することは可能ですか？ 回答 NEC製？のBackup Execを利用したことがないので 分かりませんが、他のバックアップソフトを利用している 経験上、そのソフトでバックアップ取ったものは、 そのソフトでなければ復元できないと思います。 詳しくはそのソフトの仕様を確認して下さい。 妄想終了 こんな感じでいいですかね^^;
なるほど。 エンタープライズマネージャのviewの生成画面はダメなのでしょうか。 GUIでビューを作成できたはずです。 生成後、ビューをスクリプト表示すればSQLは生成されているはずです。 手元にSQLSERVERがあればいいのですが、ないものでちょっとあいまいですが。
何を知りたいのか良くわからない感じですが．． AおよびB: トランザクションログは、ロールフォワードによって書かれるモノではない。 障害回復の際、トランザクションログを使って、データベースを復旧する。 C: 未完了トランザクションは、トランザクションログを使って、 トランザクション開始前の状態にロールバックする。 質問された内容は、参考URLに示した１ページに書かれているので 読んでください。 参考URL：http://www.microsoft.com/japan/msdn/library/defa …
DROP DATABASE [商品(NEW)データ] で行けると思います。 こう言う事があるので、オブジェクトの名前は 半角英数をお薦めします。
直接の解決ではありませんが、私がいつもやっている方法を紹介します。 １．udlをつくります。作成方法は新規で空のtxtファイルを作り拡張子をudlにします。これをダブルクリックすると、開きますので接続情報を設定します。 ２．コネクションのオープン方法を下記のようにします。 　Conn.Open "filename=" & XXX.udl XXX.udlは１で作成したファイルのパスと名前です。
特に問題なく共存できます。（実際に使えた） ただし、それなりにDISKやメモリは必要です。
タスクトレイに出てくるあれは、SQL Server サービス マネージャと言い、インストールされたらスタートアップに登録される。実体はMSDE2000インストールディレクトリ中にあるsqlmangr.exeというプログラムだ。 MSDE2000インストールプログラム内を検索したらすぐ見つかると思うので、ショートカットをスタートアップに登録してあげると良い。
ひょっとしてストアドからストアドを呼んだりしてませんか。 一時テーブルはコネクションごとに作成されるもので、コネクションが閉じれば消えてしまいます。 ストアドもこのコネクションと同じものにあたります。 AというストアドからBというストアドを呼び、Bの中で一時テーブルを作成する処理を行うと、Bが終了した時点で一時テーブルは削除されてしまいます。
件数が多いのでメモリ不足になっているのではないでしょうか？ インデックスは適切に張っているという前提で回答します。 メモリ不足のようなので SQL を分割するといいでしょう。A テーブルと B テーブルの JOIN した結果をワークテーブルに落としておいてそれを元に一気に UPDATE かけるといいと思います。2度手間のように見えて意外と速くなりますよ。 それでもダメなら、あとはハードウェアですね。メモリを増やすとかディスクを増やすとかいくつか方法があります。
標準の機能では無いはずです。 ストアドを作ってテキストを貼り付けるか、もしくはVBAでテキストを読み込み、ADOかSQL-DMOでやるしかないと思います。
DROP DATABASE [削除するデータベース名] って SQL を発行してやってください。
xp_cmdshell で実行しているコマンドは ストアドやクエリアナライザ上のSET文で 制御できません。 （別セッションですから） bcp の [-E keep identity values] スイッチでは どうでしょうか？（未検証）
デッドロックとは、複数のプログラムがお互いの資源の解放を待ちあって、処理が進まない状態のことを言います。 例えば、下記の様なプログラムが有った場合、 ===== プログラム1 ===== 1.テーブルAをロック 2.テーブルBをロック 3.何らかの処理 4.テーブルBを解放 5.テーブルAを解放 ===== プログラム2 ===== 1.テーブルBをロック 2.テーブルAをロック 3.何らかの処理 4.テーブルAを解放 5.テーブルBを解放 プログラム1がテーブルAをロックし、同時にプログラム2がテーブルBをロックすると、プログラム1はプログラム2がテーブルBを解放するのを待ち、プログラム2はプログラム1がテーブルAを解放すのを待つので、処理が進みません。 詳しくは下記のサイトを参照して下さい。 http://www.microsoft.com/japan/msdn/sqlserver/co … http://www.atmarkit.co.jp/fnetwork/rensai/sql28/ …
SELECT * FROM TEST A INNER JOIN (SELECT 日付,ナンバー,MAX(サブナンバー) AS サブナンバー FROM TEST GROUP BY 日付,ナンバー) B ON A.日付 = B.日付 AND A.ナンバー = B.ナンバー AND A.サブナンバー = B.サブナンバー ですね。
SQL プロファイラでログを記録するか、リアルタイム に監視できます。
遅くなりましてすみません。 DNS の設定の仕方を解説しているサイトはわからないです。 きっとですがすでに SQL グループのレコードに今回追加した IP が登録されていると思います。 今回のクラスタはマルチホームとなるので、単純に SQLグループのホスト名で名前解決をすると A ネットワークと B ネットワークのどちらの IP が返ってくるかが予測できません。レジストリで何とかなったと思うのですが余りいい方法でないと思います。 ですので A ネットワーク と B ネットワークそれぞれ専用のレコードを追加してやれば解決します。 DNS のレコードの追加自体は簡単です。前方参照ゾーンの下にあるドメイン名のノードに Host っていうレコードを追加してください。 そのときに登録するホスト名は A ネットワーク、 B ネットワークそれぞれから SQL Server にアクセスするときの名前となります。そして IP アドレスも 同様にそれぞれのものを登録してください。 たとえば SQL グループのホスト名が SQL だったら SQL-A, SQL-B というレコードを追加してやり、クライアントからもその名前で接続に行かせるといった感じです。
インポートする前にデータをすべて削除するか、 インポート時に「列マッピングと変換」で「変換先 テーブル内の行を削除」を行えば、重複しないと 思います。 オンラインで使用しているテーブルの場合は、 時間を決めて行ったほうが良いと思います。 ビューで使用しているとの事なので難しいかもしれま せんが、データを削除した後キーを作成してデータを インポートし、ビューを再度クリエイトしたほうが、 長期的に見て効率的かもしれません。
どれぐらいの領域を確保すべきかというのは、一概には言えないですね。ハードウェアの構成なども絡んできます。 基本的には確保できるだけ確保してください。 ただし、システムDB や tempdb の分のサイズも残してください。システムDB は約 60MB temdb はシステムの発行する SQL 次第です。大規模なソートを行う場合は多めに残してください。 次に OS と同じパーティションに保存する場合(推奨しません)は ページファイルの最大サイズの分も残してあげてください。 推奨としては、データファイル専用ディスクに配置してできるだけ領域確保する。もし足りなくなったらディスクを追加してそこにも領域を確保する。こんな感じにすれば間違いないと思います。
