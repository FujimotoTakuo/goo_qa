テーブルに保持している条件を満たすデータ抽出についてご教示ください。 フラグ① a フラグ② a フラグ③ b 金額① 100 金額② 100 金額③ 100 上記レコードのフラグと金額は紐付いており、フラグがaの場合、金額①と金額②を加算、フラグがbの金額③は加算しない。 仮にフラグ①〜③が全てaの場合は、金額①、金額②、金額③全てを加算するとしたいです。 case式等で対応できないかと考えましたが抽出方法がわからず。 わかりにくい説明かと思いますが、お知恵を拝借できればと思います。
varchar(1)で定義したフィールドにデフォルトで空文字列をセットしようと、''をデフォルトにしようとした。すると、エラーになった。一旦、デフォルトをNULLにし、updateで''を設定しようとした。すると、truncateされ、'が入った。ということは、''は’が２つと解釈されている。 どういうことか？　''が空文字列と思ってきたが.... なお、""でもやってみたが、"がひとつ登録された。
論理削除とは、boolean型のdeleted_atみたいなものをつけて、trueなら、存在する。falseなら、存在しない(物理的には、存在し、中身はNULL)みたいな事。と認識しているのですが、合っているでしょうか？ deleteではなく、trueの場合のデータを0か、NULLで上書き→falseにする。 という感じで良いでしょうか？また、not nullのフィールドが存在した場合、0を、それ以外はnullを突っ込むという感じですか？ そして、insertの場合、idが自動付番の場合で、10番まで存在し、5番までは、true。6以降はfalseの場合、新しい行を追加するとき、6番目に追加、(update)するのですか？それとも、11番目にcreateするのでしょうか？
質問の内容はタイトルの件なのですが、詳細に説明させて頂きます。 テーブル名：sample ---------- id,type ---------- 1,A 1,A 1,B 1,C ---------- 上記のような4件のレコードが入ったテーブルがあったとします。 このテーブルのidでグループ化し、 -------------------------- SELECT id FROM sample GROUP BY id HAVING count(type) = 3 -------------------------- のようにして、typeが3種類だけのレコード(A,B,Cのような)を取得したいのですが、 この方法だと、単純にレコード件数の4件が取れてしまいます。 どうにかAの重複を1つとして、うまく取得する方法は無いでしょうか。 よろしくお願い致します。 また、質問内容におかしな点などあればご指摘下さい。
質問させて頂きます。 ▼テーブル名[sample] -------------- ID,type -------------- 1,A -------------- 1,B -------------- 2,A -------------- 3,C -------------- 上記のようなデータの入ったテーブルがあるとします。 この中から、下記のような条件のデータを取得する場合、どのようなクエリを作成すればよろしいでしょうか。 ①typeがAとBも持っているIDを取得 ※この場合だと、ID「1」が結果になります。 ※ID「1」は2行あるため、取得結果は1行でも2行でも構いません。 ②typeがAのみのIDを取得 ※この場合だと、ID「2」が結果となります。 グループ化を使用して？など考えてはいるのですが、そこから先の条件指定をどのようにすれば分からず悩んでいます。 何か良い方法をご存知の方は教えて頂けると幸いです。 また質問内容に不備な点などあれば、すぐに修正するのでご指摘下さい。 よろしくお願い致します。
多数の似て非なるテーブルが沢山あります。これを一つ一つ専用のデー タベースを作ると言うのも、管理の面で大変だと思うので。 ひとつの基本となるクラスを作ってから、その基本クラスを継承して専 用のデータベースを作らなくても対処が出来る様なデータベースを考え ているのですが。 それと言うのは、mysqlで対処出来るのでしょうか。
お世話になっております。 掲題のとおり mysqlで1レコード内にある1つのフィールド内で重複した値があった場合対象レコードを出力したいのですが良い方法はないでしょうか。 例えば nameというフィールドに 青木　青木　隆 とあった場合、青木が重複しているので対象のレコードを出力する といった感じです その他 nameの中身が全く同じ値で重複しているレコードを出力するsql文をお教え頂いてもよろしいでしょうか。 例えばnameの中身で ーーーー 青木　隆 ーーーー 青木　隆 ーーーー といった列が２つ存在した場合、２つのレコードを出力する といった感じです。 後者は調べれば分かりそうですが前者は調べるのに時間がかかりそうで お教え頂けると助かります。 どうぞよろしくお願いいたします。
現在、以下のようなシステム構成をとった運用をしています。 (1) クライアントPCでAccessを使用した業務プログラムがあります。 (2) そのクライアントPCで構築データベースを公開する為に、レンタルサーバにmysqlのデータベース 　　を構築し、クライアントで作成したデータをレンタルサーバのmysqlにインポートしてます。 (3) サーバ側で、PHPのプログラムでmysqlのデータベースをアクセスして、データを公開しています。 このシステムを、クライアントで直接、レンタルサーバのmysqlのデータベースを更新するように 変更する事を計画しています。 Webで検索すると、SSH接続、ODBC接続で、Accessのプログラムのまま、レンタルサーバのmysqlへ アクセスできるような記述を見つけましたが、 パフォーマンス等の観点で、業務システムに使用するには、不適切との記述もあります。 やはり、本当にそうなのでしょうか？ 特に、Accessに拘る必要はないのですが、帳票等も出力したいので、Accessが楽かなとも 思っています。 そのようなプログラム構成が妥当なのか、ご教授頂けないでしょうか？
例えば以下のように、0.8秒で抽出できたと書いてあるのに、 Showing rows 50 - 74 (5568 total, Query took 0.8403 seconds.) 実際にphpmyadminで表示されるまでに、１分くらいかかりました。 同様にサーバー上においたphpプログラムから実行した時の時間と、ターミナルなどで実行した時にかかる時間が大きく違うときがあります。 上記の原因、改善策はあるのでしょうか？よろしくお願いします。
次のようなテーブルから期間を指定して下のような曜日ごとのカウント（count）とその平均（ave）と その期間内にその曜日が何回出現したか（week_count）を求めたいのですが DROP TABLE IF EXISTS t1; CREATE TABLE IF NOT EXISTS t1 ( id int(11) NOT NULL, created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO t1 (id, created) VALUES (1, '2016-07-10 00:00:00'); INSERT INTO t1 (id, created) VALUES (2, '2016-07-17 00:00:00'); INSERT INTO t1 (id, created) VALUES (3, '2016-07-17 00:01:00'); INSERT INTO t1 (id, created) VALUES (4, '2016-07-18 00:00:00'); week　count　　ave　week_count 0　　　　　3　　　1.5　　　　2 1　　　　　1　　　0.5　　　　2 2　　　　　0　　　0　　　　　1 3　　　　　0　　　0　　　　　1 4　　　　　0　　　0　　　　　1 5　　　　　0　　　0　　　　　1 6　　　　　0　　　0　　　　　1 どのようなSQL文にすれば良いのでしょうか？ 曜日ごとのカウントだけなら次のSQL文 select count(*) as count, DATE_FORMAT(created, '%w') as week, created from t1 where created between '2016-07-10 00:00:00' and '2016-07-18 23:59:59' group by DATE_FORMAT(created, '%w'); で取得できるのですが・・・
CREATE TABLE IF NOT EXISTS t1 ( id int(11) NOT NULL, name, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO t1 (id, name) VALUES (1, 'a'); INSERT INTO t1 (id, name) VALUES (2, 'b'); CREATE TABLE IF NOT EXISTS t2 ( id int(11) NOT NULL, t1_id INT, price INT, PRIMARY KEY(id), FOREIGN KEY (t1_id) REFERENCES t1(id) on update cascade on delete cascade ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO t2 (id, t1_id, price) VALUES (1, 1, 1000); INSERT INTO t2 (id, t1_id, price) VALUES (2, 1, 800); INSERT INTO t2 (id, t1_id, price) VALUES (3, 1, 500); INSERT INTO t2 (id, t1_id, price) VALUES (4, 2, 2000); INSERT INTO t2 (id, t1_id, price) VALUES (5, 2, 100); このようなテーブル構造で、t2テーブル内の t1_id=1の最後、INSERT INTO t2 (id, t1_id, price) VALUES (3, 1, 500); t1_id=2の最後、INSERT INTO t2 (id, t1_id, price) VALUES (5, 2, 100); のpriceの合計 500+100=600 を得たいのですが、どのようなSQL文にすれば良いのでしょうか？
mysqlからSQLダンプしたテキストファイルを linuxのsplit -C 1024M ファイル名 で分割したのですが、（こうすると1024MB以下で行単位で区切ってくれる） 複数行にまたがっているSQL文の途中行で区切られている場合があり、 別マシンのデータベースにインポートするとエラーになってしまいます。 SQL文の末尾はセミコロンなのですが、 1024MB以下になるように、セミコロンが末尾にある行で区切ってもらう方法を探しております。 linuxのコマンドでもwindowsフリーソフトでもかまいません。 ご存じの方どうかご教示ください。
ローカルの環境（XAMPP)で動作していたPHPのプログラムを レンタルサーバにアップロードして動作させたところ、 日本語データが全て、"???????"と表示されしまいます。 mysqli_select_db($conn, "p13ns4_006_server_cans"); mysqli_set_charset('utf8'); と、mysqli_set_charset('utf8'); は、入れてあります。 何か、考えられる事あるでしょうか？
MS-AccessのデータをMySQLデータベースに変更する為に、 MS-AccessのテーブルからODBCデータベースにエクスポートしようとすると 「データをエクスポートできませんでした」のダイアログが出て、エラーが発生してしまいます。 対象のテーブルは幾つかあって、他のテーブルは成功するのですが、 一つのテーブルだけが、このエラーになってしまいます。 バージョンは、 Connector/ODBC 5.3.6 を使用しています。 エラーの原因として考えられる事等、ご教授ください。
太郎　サッカー 2 データベースから 名前と球技名でgroup化した結果 次郎 サッカー 2 左のようになったのですが 太郎 野球 1　　　　番号の小さい順に（野球、サッカー、ラグビーの順に）ならびかえたい 　 次郎 野球 1　　　　のですがorder by　番号 してもエラーがでます。 三郎 ラグビー 3　　良い方法はないものでしょうか。 三郎 ラグビー 3　　どうぞどなたかおねがいします！！
SQl勉強中の初心者です 結合したテーブルのSUMの値が思うように集計できません。 以下のような2つのテーブルがあったとします。 テーブルA Date,ConNo 2016-05-15,test001 2016-05-15,test001 2016-05-25,test002 2016-05-25,test002 2016-05-25,test002 テーブルB ConNo,line,Amt test002,1,1500 test002,2,1500 test002,3,1500 select A.Date,A.ConNo,Sum(B.RAmt) as B_sum from テーブルA A left outer join テーブルB B on A.ConNo= B.ConNo group by A.Date,A.ConNo into :arDate,:arConNo,:arAmt; テーブルAを主として、group byしたときに、対応するテーブルBをSUMしたいのですが、 SUMした値が以下のようにデータ数分倍になってしまいます。 2016-05-15,test001,0 2016-05-25,test002,13500 以下のような結果にする場合は、どう書けばいいのでしょうか? 2016-05-15,test001,0 2016-05-25,test002,4500 宜しくお願いします
初心者ですが、あるテーブルにあるnullになっているレコードをを抽出してHTMLの検索画面に表示したいです。 仕様上、下記のように書けば、削除済のレコードを抽出することが可能となっております。 EX：<td><input type="radio" name="is_deleted" value="y" %%para:checked:is_deleted:y%% />削除済も表示</td> （paraで置き換えて、is_deletedというカラムの中に「y」の値になっているものを抽出する感じです） nullになっているレコードを抽出するのに下記のように書いてみたのですが、抽出できていません。 <td><input type="checkbox" name="goods_name" value="null" %%para:checked:goods_name:null%% />商品名が空欄のものを表示</td> <td><input type="checkbox" name="goods_no" value="null" %%para:checked:goods_no:null%% />商品NOが空欄のものを表示</td> どなたか教えて頂けますでしょうか。
ローカルのPCに存在するmySQLをSQLファイルとしてエクスポートします。 このSQLファイルをインターネット上のサーバ（レンタルサーバ）のphpmyadminで インポートする時に、 ローカルのPCに存在しているSQLファイルを指定するには、どのようにすればいいのでしょうか？ SQLファイルもサーバにアップロードしておく必要があるのでしょうか？ ご教授ください。
MySQLで、複数のカラム値の計算結果をASで新しいカラム名で出力し、新しいカラム名で抽出を行った時にレコード数をカウントする方法を知りたいです。 WHERE句ではエラーになるのでHAVING句を使うということまではわかったのですが、結果の総レコード数を出力することができません。 テーブル名:s id | a | b 1 | 100 | 200 2 | 200 | 80 3 | 300 | 20 4 | 400 | 90 5 | 500 | 40 下記のような手順を踏んでみました。 まず、WHERE句で全件を出力 SELECT count(id) FROM s WHERE 1 [結果] count(id) 5 ASを使わない aカラムで抽出 SELECT count(id) FROM s WHERE 1 AND a BETWEEN 200 AND 400 [結果] count(id) 3 AS を使って (a/b)*100 を計算したカラム c を作成 SELECT id,a,b,(a/b)*100 as c FROM s WHERE 1 AND a BETWEEN 200 AND 400 idが2,3,4の3件分のデータが表示される id | a | b | c 2 | 200 | 80 | 250.0000 3 | 300 | 20 |1500.0000 4 | 400 | 90 | 444.4444 cカラム（計算した結果）でBETWEENを実行 SELECT id,a,b,(a/b)*100 as c FROM s WHERE 1 AND c BETWEEN 200 AND 500 エラーになる #1054 - Unknown column 'c' in 'where clause' ASを使った時に Where句では c を指定できないのでHAVING句を使うということを知り、WHERE句をHAVING句に書き換える。 SELECT id,a,b,(a/b)*100 as c FROM s HAVING 1 AND c BETWEEN 200 AND 500 id | a | b 1 | 100 | 200 |333.3333 2 | 200 | 80 |250.0000 4 | 400 | 90 |444.4444 この結果のレコード数をcountで取得したいです。 SELECT count(*),id,a,b,(a/b)*100 as c FROM s HAVING 1 AND c BETWEEN 200 AND 500 SELECT count(id),id,a,b,(a/b)*100 as c FROM s HAVING 1 AND c BETWEEN 200 AND 500 これだと結果が5件になってしまいます。 idでグループ化すれば良いと思い SELECT count(id),id,a,b,(a/b)*100 as c FROM s GROUP BY id HAVING 1 AND c BETWEEN 200 AND 500 を実行 count(id) | id | a | b | c 1 | 1 | 100 | 30 | 333.333333300 1 | 2 | 200 | 80 | 250.000000000 1 | 4 | 300 | 90 | 444.444444400 HAVINGとGROUPを使っているので、このように3行の結果が出るのは当然だと思うのですが、この時の結果を「SELECT count(*) FROM WHERE 1」の時と同じように count(id) 3 という合計値だけ出力するようにしたいです。 ご回答よろしくお願い致します。 ~~~~~~~~~~~~~~~~~~ テストデータ ~~~~~~~~~~~~~~~~~~ CREATE TABLE `s` ( `id` int(11) NOT NULL, `a` int(3) NOT NULL, `b` int(3) NOT NULL ) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8; INSERT INTO `s` (`id`, `a`, `b`) VALUES (1, 100, 30), (2, 200, 80), (3, 300, 20), (4, 400, 90), (5, 500, 40); ALTER TABLE `s` ADD PRIMARY KEY (`id`); ALTER TABLE `s` MODIFY `id` int(11) NOT NULL AUTO_INCREMENT,AUTO_INCREMENT=6;
MySQLについてですが、ローカルとレンタルサーバー共にphpMyadminで作成データベースを観覧していますが、データ型がvarcharやtextが文字化けします。照合順序は utf8_general_ci になっております。原因がわかりません。こころあたりがありましたらアドバイスくたざい。よろしくお願いします。 一方で、ターミナルコマンドで接続した場合で データベースを確認した場合は、文字化けせずに、しっかりと保存されていますし、データーをセレクトして出力した場合も、しっかりと表示されますので、問題は、phpMyadminの設定にあるのではないかと思うのですが分かりませんでした。
次のようなテーブル構造で CREATE TABLE IF NOT EXISTS area ( id int(11) NOT NULL AUTO_INCREMENT, parent_id INT, name varchar(64), level int NOT NULL, PRIMARY KEY(id), FOREIGN KEY (parent_id) REFERENCES area(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO area (parent_id, name, level) VALUES (NULL, '地球', 1); INSERT INTO area (parent_id, name, level) VALUES (1, '日本', 2); INSERT INTO area (parent_id, name, level) VALUES (2, '東京都', 3); INSERT INTO area (parent_id, name, level) VALUES (3, '千代田区', 4); INSERT INTO area (parent_id, name, level) VALUES (2, '神奈川県', 3); INSERT INTO area (parent_id, name, level) VALUES (4, '大手町', 5); INSERT INTO area (parent_id, name, level) VALUES (7, '1', 6); これを普通に取得すると上から順番（挿入順）に表示されますが、 次のように 地球 　日本 　　東京都 　　　千代田区 　　　　大手町 　　　　　1 　　神奈川県 という順番で取得したいのです。 どのようなSQL文を書けば良いのでしょうか？
mysqlのselect文について質問があります。 idというカラムから下4桁と一致するデータを抽出したいと思っています。 下記のようなselect文を試したのですが「返り値が空でした(行数0)」と表示されてしまいます。 $idnumber = 0001; SELECT * from meibo where SUBSTR('id',-4,4) = '$idnumber'; idカラムには50001というデータがあるのは確認しているので、select文が間違っていると思うのですがどこが原因なのでしょうか。
MySQLで作ったデータベースをローカルからレンタルサーバーに移動するとき、サーバーにあるphpAdminよりエクスポートしてインポートするまたは、TeraTermなどでサーバーのmysqlにログインしてデータベースやテーブルをいっこいっこ作っていく方法が思いあたりますが、プロの方はどのようにやっていますでしようか? 　この他にも方法はありますか?
ローカルで作成したMySQLのテーブルデータをサーバーに移したいのですが、スムーズにいかずにいます。(ローカルのphpMyAdminよりエクスポートした、sqlファイルを編集したものをサーバー側のphpMyAdminよりインポートしています。) 特に、登録日と更新日のカラムのCURRENT_TIMESTAMPに問題があるようで、下記のようなメッセージがでます。2つは無理とのことです。 #1293 - Incorrect table definition; there can be only one TIMESTAMP column with CURRENT_TIMESTAMP in DEFAULT or ON UPDATE clause 　 しかし、ローカルではちゃんと定義されているので、なぜサーバーになると無理なのかがわかりません。 このようなSQLの文章になっていますが、どのように書けば、2つのCURRENT_TIMESTAMPの存在が可能になりますでしょうか? よろしくお願いましす。 CREATE TABLE IF NOT EXISTS `comment` ( `comment_id` bigint(20) unsigned NOT NULL AUTO_INCREMENT PRIMARY KEY, `post_id` int(11) DEFAULT NULL, `content` text CHARACTER SET utf8, `reg_tim` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP, `upd_tim` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP ) ENGINE=InnoDB DEFAULT CHARACTER SET=utf8;
mySQLでselectした100万件近くをinsertしたいのですが insert selectは遅いので別の方法を考えています。 プロシージャを作成してselectした結果で バルクinsertをしようと思うのですがどう書けばいいか、よくわからず。 どなたか教えていただけないでしょうか。 mySQL初心者です。 よろしくお願いします。
MySQLでのことですが、MAX()とGROUP BYを使うの＋ ORDER BY を使いたいのですが、どうもいっしょ使えないようなのでよい方法はありますでしょうか?よろしくお願いします。　下記のクエリのように SELECT name, content, max(time) FROM message GROUP BY name messageテーブルより name の同じものをグループ化し、その中でも更新が新しいものをMAX()で出力しています。ただグループ化したそれぞれのnameの最新更新は出力できますが、これらの最後に ORDER BY time DESC　を加え　timeの新しいものから順に並ぶようにしたいのですが、これが上手く機能しません。
下記のようMySQLを使い、Unionで結合していますが、出力する2つのカラムのうち、一列目のカラムの重複している部分がある行だけ省きたいと思います。そこで、group by を最後に追加したいと思うのですが、動きませんでした。もしかしたら結合したあとにGROUP BYは無理なのかもしれませんが、他のやり方でも可能なら教えてくださいるよろしくお願いします。 (SELECT other_id AS a,send_tim FROM message WHERE user_id =5 GROUP BY other_id)union (SELECT user_id AS a,send_tim FROM message WHERE other_id =5 GROUP BY user_id)order by send_tim desc GROUP BY a
DBは、Mysqlです。どうかアドバイスをいただきたいです。 宜しくお願いします。 以下のようなテーブル table1 があります。 ******************* table1 ******************* 銀行名, 出金, 入金, 月 ******************* A, 100, 0, 2月 B, 0, 100, 2月 A, 0, 100, 2月 A, 100, 0, 3月 B, 100, 0, 3月 B, 0, 100, 3月 A, 100, 0, 3月 B, 0, 100, 4月 ... ******************* 3月時点の各口座の出金合計、入金合計、前月残高、翌月繰越を求めたいです。 select (SUM(t.入金) - SUM(t.出金)) as 前月残高, SUM(t.入金) as 入金合計, SUM(t.出金) as 出金合計, (SUM(t.入金) - SUM(t.出金)) as 翌月繰越 from table1 as ｔ selectは、こんな感じでまとめたいのですが、それぞれの条件が3月、3月以前、3月以後と異なっているために、一つのselectにまとめられず、困っております。 自己結合なのか、サブクエリなのか、別の方法なのか。 アドバイス頂けたらと思います。 宜しくお願いします
初心者です。 phpファイルにおいて下記のように書きましたらDBにinsertできますが、 「 $sql = mysql_query("insert into table1 (item_code, addr) values('$mail[item_code]', '$mail[addr]')", $con); 」 下記のように書き加えたらうまくtable2からデータをとって、table1にinsertできません。 書き方が間違っていると思いますが、どなたか教えて頂けませんでしょうか。 「 $sql = mysql_query("insert all into table1 (item_code, addr) values('$mail[item_code]', '$mail[addr]') into t_table1 (maker, maker_name) select maker, maker_name from table2 order by goods_code limit 1", $con); 」 よろしくお願い致します。
MySQL内の画像のタイトルを変更して、さらに圧縮したいです。MySQLにはパスしか載っていないのか、そしてそのパスを変更するのでしょうか？
タイトルと本文だけを投稿するブログのようなものを練習として作っています。そこで分からないことがあります。 投稿フォームよりタイトルと本文を投稿して、index.php に一覧(記事のタイトル)を表示させています。そして、一覧のそれぞれの記事タイトルより、個別記事にリンクしたいと思いますが、リンク先の個別記事のデータをSELECTする方法が分かりません。 ・記事のテーブル名: post ・カラム no / title / content index.php(一覧) から article.php(個別記事)へ urlに 記事のnoを加えてリンクさせています。そして、article.php のurlの記事noを where句に指定して、記事を表示したいと考えています。 しかし、where句をどのように書けばよいのかが分かりません。例えば、記事noが　12　である場合、　/article.php?no=12 とリンクされてきた時に、どのように 12 を取得してwhere句で指定するのかが分かりません。 ↓　この文の? の部分をどのようにすればよいのか教えてください。 $st = $dbh->query("SELECT * FROM post WHERE no=?");
下記の実行すると、エラーが表示され LIMIT 0,50を外すとエラーにはならず、結果が表示されます。 ただ、一度に全件が表示されるのでLIMITで表示させる件数を制御したいと思っていますが、 なぜかエラーになっています。どこが間違っているのでしょうか？ $query = "select * from tableA ta left join tableB tb on ta.id = tb.id left join tableC tc cf on tb.id = tc.id left join tableD td on tb.id = td.id where tb.aaa != ''"; $xdays = (isset($days) and $days !== "")?$days:null; $xmn =(isset($mn) and $mn !== "")?$mn:null; $xfp =(isset($fp) and $fp !== "")?$fp:null; $xre =(isset($re) and $re !== "")?$re:null; if(is_null($xdays) and is_null($xmn) and is_null($xfp) and is_null($xre)){ $query .= " and 0"; }else{ if(!is_null($xdays))$query .=" and tb.day='" .$xdays ."'"; if(!is_null($xmn))$query .=" and tb.mn = '" .$xmn ."'"; if(!is_null($xfp))$query .=" and tb.fp='" .$xfp ."'"; if(!is_null($xre))$query .=" and tb.re='" .$xre ."'"; } $query .=" order by tb.day DESC,tb.jikan limit 0,50; エラー： empty: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'and tb.fp='4'' at line 20 以前の質問 https://oshiete.goo.ne.jp/qa/9061230.html を参考に、修正している状況で、LIMITのエラー？になって困っています。
PHP5.5でMySQLに　PDOでデータベースに接続しています。 他にも、Zend_DB や　PEAR::MDB2 , などのライブラリがありますが、大規模なサイトになった場合での処理速度を重視すると、どの接続方法がベストでしょうか?
初心者です。一度似た質問をさせていただきましたが、再度整理しましたので、質問に答えて頂けたら幸いです。 下記のm_magazine（DBのテーブル名）の中にそれぞれの月のmagazine_id(1、2、3…と番号順に登録してあります。)と月刊のurl、タイトルであるmagazine_titleなどのカラムを収納させてあります。 生成させた今月号の月刊ページには来月号のリンクと先月号のリンクを自動的に取得させたいのですが、下記のように書くと、最新号は次のようになってしまします。 「 次の月刊へ：2016年2月号　○○○　　前の月刊へ：2016年1月号　○○○ 次の月刊へ：2016年3月号　○○○　　前の月刊へ：2016年2月号　○○○ 次の月刊へ：2016年4月号　○○○　　前の月刊へ：2016年3月号　○○○ 」 つまり、最新号には過去の全部の「次の月刊へ」と「前の月刊へ」が全部出てしまいます。 次に新しい号は「次の月刊へ：2016年4月号　○○○　　前の月刊へ：2016年3月号　○○○」は出ずに、あとは全部出てしまいます。最も古い号は逆に何も出ません。 どなたか教えて頂けませんでしょうか。よろしくお願い致します。 ◆DB仕様 「 -- Table "m_magazine" DDL CREATE TABLE `m_magazine` ( `magazine_id` int(11) NOT NULL COMMENT '月刊ID', `url` varchar(256) DEFAULT NULL COMMENT 'URL', ` magazine_datetitle` varchar(256) DEFAULT NULL COMMENT '月刊年月タイトル', `magazine_title` varchar(256) DEFAULT NULL COMMENT '月刊タイトル', `is_deleted` char(1) NOT NULL COMMENT '削除フラグ（y, n）', PRIMARY KEY (`magazine_id`), KEY `is_deleted` (`is_deleted`), KEY `create_staff_id` (`create_staff_id`), KEY `modify_staff_id` (`modify_staff_id`), CONSTRAINT `m_magazine_ibfk_1` FOREIGN KEY (`create_staff_id`) REFERENCES `m_staff` (`staff_id`), CONSTRAINT `m_magazine_ibfk_2` FOREIGN KEY (`modify_staff_id`) REFERENCES `m_staff` (`staff_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='月刊管理マスタ'; 」 ◆生成に使っているPHPファイル 「 $currentid = $h['magazine_id']; $sql2 = "select distinct url, magazine_datetitle, magazine_title from m_magazine where magazine_id = (select min(magazine_id) from m_magazine where magazine_id > '$currentid' order by magazine_id desc limit 1)"; $sql3 = "select distinct url, magazine_datetitle, magazine_title from m_magazine where magazine_id = (select max(magazine_id) from m_magazine where magazine_id < '$currentid' order by magazine_id desc limit 1)"; $ret2 = f_db_select($sql2, $h['url'], $h['magazine_datetitle'], $h['magazine_title']); $ret3 = f_db_select($sql3, $h['url'], $h['magazine_datetitle'], $h['magazine_title']); foreach ($ret2 as $h2) { $nexturl = f_db_select($h2['url']); $nextdatetitle = f_db_select($h2['magazine_datetitle']); $nexttitle = f_db_select($h2['magazine_title']); } foreach ($ret3 as $h3) { $prevurl = f_db_select($h3['url']); $prevdatetitle = f_db_select($h3['magazine_datetitle']); $prevtitle = f_db_select($h3['magazine_title']); $wkbuff .= <<<EOF <p> 次の月刊へ：<a href ="{$h2['url']}">{$h2['magazine_datetitle']}　{$h2['magazine_title']}</a><br/> 前の月刊へ：<a href ="{$h3['url']}">{$h3['magazine_datetitle']}　{$h3['magazine_title']}</a> </p> EOF; 」
SQLの処理速度があまりに遅い（最悪1分以上かかる）ので わかる方がいらっしゃいましたらアドバイスをお願いいたします MySQL４になります----------------------- -- 問題SQL SELECT COUNT(*) as count FROM ( SELECT id, word FROM ( SELECT distinct tbl.id, p.word FROM table01 tbl INNER JOIN table02 p ON p.id = tbl.id WHERE keyword LIKE 'a%' UNION SELECT distinct tbl.id, p.word FROM table11 tbl INNER JOIN table12 p ON p.id = tbl.id WHERE keyword LIKE 'a%' ) test1 UNION SELECT id, word FROM ( SELECT distinct tbl.id, p.word FROM table21 tbl INNER JOIN table22 p ON p.id = tbl.id WHERE keyword LIKE 'a%' UNION SELECT distinct tbl.id, p.word FROM table31 tbl INNER JOIN table32 p ON p.id = tbl.id WHERE keyword LIKE 'a%' UNION SELECT distinct tbl.id, p.word FROM table41 tbl INNER JOIN table42 p ON p.id = tbl.id WHERE keyword LIKE 'a%' UNION SELECT distinct tbl.id, p.word FROM table51 tbl INNER JOIN table52 p ON p.id = tbl.id WHERE keyword LIKE 'a%' ) test2 GROUP BY word ) A ---------------------- 既存のテーブルが、table01～table51（各テーブルに付随するサブテーブルでtable02～table52がある感じ）まであり その各テーブル内に存在しているカラムkeyword（varcharで NOT NULL、indexは張ってある）の一文字だけを指定し検索結果の件数を取得したいのですが 速度があまりに遅く、悩んでおります。 2文字以上だと若干重いかなという感じがするだけです (実際のSQLはもっとごちゃごちゃしており、見やすくするため不必要なカラム等削除しております) table01は51万レコード、table11は、175万レコードあります。 （その他は1万レコード程度です） そもそもこの件数をLIKE検索で行っていること自体、おかしいのですが もうどうしようもないので、このSQLをなんとか修正したいと考えております 目標としては、 この旧SQLと新SQLで取得した件数が同じになり、かつ速度が上がることにあります 「 ) test2 group by word 」については、table21～table51で重複するwordを削除したいという意向があり、ついております （table01とtable11と一緒にunionして、group byしたくないです） 私のほうで修正・実行した方法は、 １）SELECT count(*) as count from を SELECT count(id) as count from と*を止める指定する ２）test1とtest2内のSELECTで取得するカラムを最小限にする（上記のものはかなり少なくしてあり、もうこれ以上減らせません…） ３）test1内のSQLでtable01、table11をunionしているところを、分割する ↓こんな感じに分割 SELECT count(id) as count from ( select id, word from ( SELECT distinct tbl.id, p.word FROM table01 tbl INNER JOIN table02 p ON p.id = tbl.id WHERE keyword LIKE 'a%' ) test1 union select id, word from ( SELECT distinct tbl.id, p.word FROM table11 tbl INNER JOIN table12 p ON p.id = tbl.id WHERE keyword LIKE 'a%' ) test２ union select id, word from ( ・ ・ ・ となります。 一応、６０秒程度掛かっていたものが、5～20秒程度で帰ってくるようにはなりましたが まだまだ実用には耐えられない状況です もしまだ改善すべき箇所等ございましたらアドバイスをおねがいいたします よろしくお願いいたします
SELECT SUM() AS FROM GROUP BYにて商品の合計個数と重量を集計しています。 賞味期限のデータがyyyy-mm-ddで登録されているのですが、これをyyyy-mmで集計するにはどうしたら良いでしょうか？ 下の画像のように左が現状の状態で、それを右のような状態(賞味期限をyyyy-mmにして商品の個数と重量と賞味期限のyyyy-mmの月ごとで集計したい。)にしたいです。 因みに左の方のSQL文は以下で集計しています。 SELECT syoumi, syouhin,SUM(kosu) AS gokei_kosu,SUM(jyuryo) AS gokei_jyuryo FROM storage GROUP BY syoumi どなたかご教示頂きますようお願い致します。
久々データベースを触っているのですが、Primary KeyのようにAutoIncrementするフィールドにPrefixを付たいのですがどのようにすれば良いのでしょうか？ http://detail.chiebukuro.yahoo.co.jp/qa/question … このページで言っているように、プログラム側でPrefixを付け、それをTransactionを使って、CharFieldに入れるしかないのかなとも思いましたが。 もしMySQLやMariaDB、PostgreSQLなどにそのようなPrefixを付けて自動でインクリメント出来る機能があれば教えて欲しいと思います。 宜しくおねがいします。
テーブルで、id,useid,date,extext という項目があり、idにプライマリーキー、userid、dateにインデックスとユニークキーを設定しています。 自宅のパソコンでやると、問題なくデータが追加できるのですが、今使っているパソコンからだと ユニークキーを設定すると、重複データが追加できなくなりました。 データのサンプル　は　id=1,userid=1,date=2014-1-1,extext="aaaaa"(一つ目は追加できます。） id=2,userid=1,date=2014-1-2,extext="bbbbb"（#1062 - Duplicate entry '1' for key 'userid_2'というエラーがでます。）
下記のsqlでテーブルとデータを用意する。 create table 収穫 (登録日 date,番号 int,容量 text(1)); insert into 収穫 values ('160201',1,'s'),('160201',2,'m'),('160202',3,'m'),('160203',4,'s'); 容量はs,m,lの3種類がある。然し、データとしては全てがそろうとは限らないとする。 前持ってデータを決め打ちが出来ないので出カのテーブルは全てを用意をすると create table クロス集計 as select 登録日 ,sum(case 容量 when 's' then 1 else 0 end) as s ,sum(case 容量 when 'm' then 1 else 0 end) as m ,sum(case 容量 when 'l' then 1 else 0 end) as l ,count(*) as 合計 from 収穫 group by 登録日 ; 上記を実行すると確かにクロス集計のテーブルは出来ますが。然し、今回の様に必ずしも列見出しが3個とは限りません。若しも、これが大量に増えた場合は非常にsqlを組み立てるのがめんどうになります。また、見た目にもデータが全く無いのにも関わらずに列見出しとしては存在をしますので。 非常に煩わしくなります。こう言う事が有る為に、この問題を避けるために別のプログラムで予めそのデータが有るのかをチェックしてsqlを作っていますが。 この様な方法(この場合は、プログラムでデータが有るのかをチェックしてsqlを組み立てると言う方法) 以外にmysqlでのsqlの記述が有るのでしょうか。 有ったら教えて欲しいのですが。若しも、無ければ従来の方法で出すだけですが。 宜しくお願いします。
create table table1(id int,合計 int,目標 int,実績 double); とした時に、実績を一発で出したい。 実績は、(過去の合計の累計/過去の目標の累計) * 100で求める。 例えば例として下記の様になります。 id 合計 合計の累計 目標 目標の累計 実績 1 2 2 3 3 66.67 2 1 3 3 6 50.00 3 1 4 3 9 44.44 4 2 6 3 12 50.00 5 1 7 3 15 46.67 6 1 8 3 18 44.44 7 2 10 3 21 47.62 現在は、一発では出来ないので個々に個別で求めています。 1. 合計の累計を出す 2. 目標の累計を出す 3. 実績を出す ここでは、実績だけあれば良いので合計の累計とか目標の累計も本来は 不要ですが。実績の出し方が分からないのでテーブルにフィールドを入 れています。 これをテーブルに一括してidと合計と目標だけで実績を保存をすると言 う事は出来るのでしょうか。 宜しく回答をお願いします。
$sql='INSERT INTO extra(id,userid,exid,date,extext) values(null,?,?,?,?)'; $stmt=$dbh->prepare($sql); $flag=$stmt->execute(array($placeholders[':userid'],$placeholders[':exid'],$placeholders[':date'],$placeholders[':extext'])); if($flag){ print('データの追加に成功しました。'); }else{ print('データの追加に失敗しました。'); } } 上記の文で、インサートを行うと初めの一つのデータだけはインサートできますが、その後は全く追加できません。idがプライマリーキーで、autoincrementをしているのですが、自動入力の際には 引数をnullにすると自動でインクリメントしてくれると書いてありました。
実は、perlでmysqlを起動してsourceコマンドを実行したかったのですが。エラーになります。 mysql単体では、sourceコマンドは正常に動きます。 その為に、perlは切り離してmysql単体で動かしたいのですが。ここではどうしても パスワードを聞いてきます。どうしても自動化をしたいので。ここでは、mysqlのログイン を自動化をしたいのですが。方法が分かりません。windows7でmysqlを使っています。 済みません。方法を教えて下さい。
既出の問題だと思うのですが、WindowsServer(2012)上で動作するphp+mysqlで全角ハイフン文字が「？」に化けてしまう現象で困っています。 全くの素人が試行錯誤の状態で作ったアプリなので、mysql(V5.5)のテーブルはsjis、php(5.4)スクリプト自体もsjisで書いています。また環境変数は下記の通りです。 mysql>show variables like 'chara%' character_set_client | cp932 character_set_connection | cp932 character_set_database | utf8 character_set_filesystem | binary character_set_results | cp932 character_set_server | cp932 character_set_system | utf8 テーブルAに入っている値を照会して、選択した結果を上書きするケースもあるため、別のテーブルBに書き込む処理を行っており、テーブルB上には、化けた文字とそれを画面上で修正した文字が混在する困った状態になっています。 まずは、テーブルAを照会する時点で、文字化けをしない状態にし、文字化けをしている状態のテーブルBの値を更新する必要があると思うのですが、まずは前者から対処したいと思います。 対処方法として、化けた文字を$strとすると、 $str=mb_convert_encoding(mb_convert_encoding($str, 'sjis-win', 'auto'), 'UTF-8', 'sjis-win'); とか、 $str=mb_convert_encoding($str, mb_internal_encoding(), 'SJIS-WIN'); とか試してみましたが、全ての文字が化けてしまう状態です。 対処方法がありましたらよろしくお願い申し上げます。
とあるテーブルに,CSV形式のデータを流し込もうとしたら,以下のようなエラーが出てきました。 mysql> LOAD DATA INFILE "c:/syokuji.csv" INTO TABLE syokuji FIELDS TERMINATED BY ',' -> ENCLOSED BY '"'; ERROR 1290 (HY000): The MySQL server is running with the --secure-file-priv option so it cannot execute this statement これはなぜ起こるのでしょうか？ ちなみに,使用しているOSはWindows10です。
table1のフィールドがsql1のみで内容はsqlのupdate文が格納されてい ます。そして、このtable1のsql1を読んでその内容で更新クエリーを実 行するとした場合は、どの様にmysqlでは処理を記述すれば良いのかと 言うのが分かりません。 例えば、table1が下記の場合はどう言う記述になるのでしょうか。 update result1 set target1=7 where id between 1 and 13; update result1 set target1=12 where id between 14 and 20; update result1 set target1=20 where id between 21 and 31; この場合は、table1を読んで、sql1の更新クエリーを実行したいのです が。個別にレコード単位に処理をする所がプロシージャをどの様に使う のかと言うのが良く分かりません。 済みません。sqlの例示をお願いします。
windows7のmysqlで今日の日付から、今月の日付をテーブルに格納した い。例えば、テーブルのtimecardで、 日付　出社時刻　退社時刻 と言うのが有って、事前に日付のフィールドを予め作りたい時にどの様 にして日付を作るのかと言う事です。 日付に関しては、curdate()で今日の日付が例えば、2016-02-10と出ま す。この値を使って日数は、day(last_day(curdate()))で29と出ます。 160201から、160229迄を日付としてinsert intoをしたいのですが。繰 り返しの数は、day(last_day(curdate()))で得られます。 問題は、160201から160229をどの様にしてデータを作って追加するのか と言う事ですが。その辺の処理が良く分かりません。 済みませんが、sqlの例示をお願いします。 宜しくお願いします。
テーブル名は、収穫で下記のデータが入っている。 日付　id　size 160201　1　S 160201　2　S 160201　3　M 160202　4　L 160202　5　L 160203　6　L 160204　7　S これのクロス集計を下記の様に作りたい。 テーブル名は、crossとする。 日付　S　M　L　合計 160201　2　1　　3 160202　　　2　2 160203　　　1　1 160204　1　　　1 済みません、sqlの回答をお願いします。
例えば、テーブルがtable1で、データが下記の場合。 id money sum 1 12 2 20 3 22 上記のデータを下記の様に更新を掛けたい id money sum 1 12 12 2 20 32 3 22 54 この時のmysqlでのsqlを教えて下さい。
MySQLにmembers,subjects,colorsの３つのテーブルがあり、memberには名前データ、subjectsには好きな教科データ、colorsには好きな色のデータが入っています。membersのidとsubjectsのmember_id、membersのidとcolorsのmember_idが結合キーになっています。 ３つのテーブルを連結させてAND検索、OR検索を行いたいと思います。 ２つのテーブルのAND検索OR検索については以前ここで質問して回答を頂きました。（https://oshiete.goo.ne.jp/qa/9128029.html） これを応用して３つのテーブルで検索を行おうとしているのですがうまくいかないので、やり方を教えていただければと思います。 「求める結果」 以下の４パターンのSQL文を作成したいです。 1.指定する教科と色のどれか１つにでも該当 例）国語 英語 青 緑 のどれか１つに該当する名前を検索 2.教科はAND 色はOR 例）国語と英語の両方に該当し、かつ、青か緑のどれか１つにでも該当する名前を検索 3.教科はOR 色はAND 例）国語と英語のどれか１つにでも該当し、かつ、青と緑の両方に該当する名前を検索 4.指定する教科と色のすべてを満たす 例）国語 英語 青 緑 のすべてを満たす名前を検索 「作成したSQL」 （科目のAND) SELECT m.id,m.name FROM members as m INNER JOIN subjects as s on m.id = s.member_id AND s.subject in('国語','英語') Group By m.id Having count(distinct s.subject)=2 （科目のOR) SELECT m.id,m.name FROM members as m INNER JOIN subjects as s on m.id = s.member_id AND s.subject in('国語','英語') Group By m.id （色のAND) SELECT m.id,m.name FROM members as m INNER JOIN colors as c on m.id = c.member_id AND c.color in('青','緑') Group By m.id Having count(distinct c.color)=2 （色のOR） SELECT m.id,m.name FROM members as m INNER JOIN colors as c on m.id = c.member_id AND c.color in('青','緑') Group By m.id これらを組み合わせてSQLを作れば良いと思うのですが、うまくいきません。 「テーブル構成」 [membersテーブル]（名前） id (int) auto_increment name (varchar) [subjectsテーブル]（科目） id (int) auto_increment member_id(int) subject (varchar) [colorsテーブル]（色） id (int) auto_increment member_id color (varchar) 「入力されているデータ例」 [membersテーブル] id|name 1[山田 2|鈴木 3|田中 [subjectsテーブル] id|member_id|subject 1 |1| 国語 2 |1| 数学 3 |1| 英語 4 |2| 国語 5 |2| 英語 6 |3| 数学 [colorsテーブル] id|member_id|color 1 |1| 赤 2 |1| 青 3 |2| 赤 4 |2| 緑 5 |3| 赤
このオプションが設定されていると任意のホルダーのファイルがload data infileでERROR1290 (HY000)のエラーが出る。 このオプションを変更して値をnullにしたい。その方法が分からな い。簡単に変更出来る方法を教えて下さい。 宜しく、お願いします。
お世話になります。 MySQLで２つのテーブルを結合し検索を行ったところ、私のPCで検索結果が得られるまで136秒もかかってしまい、非常に困っています。 これを1～2秒程度に納めたいのですが、どこを改善していいのかご教示いただけないでしょうか。 検索でやりたいことは、 検索キーと一致するNAMEを検索し、これに対応するFILE_IDに対応づけられているすべてのCLASSとNAMEの組み合わせを検索し、 得られたCLASSとNAMEの組み合わせの検索数をその組み合わせごとに集計し、 検索数の多い順に、CLASSとNAMEの組み合わせを出力する、 というものです。 例えば、結合テーブルが次のような場合に検索キーを与えたときは、次のような結果を得るものです。 FILE_ID GOODS_ID CLASS NAME 1 1 1 商品A 1 2 1 商品B 2 1 1 商品A 2 2 1 商品B 2 3 2 商品C 3 1 1 商品A 3 3 2 商品C 検索キー「商品A」の場合の検索結果： CLASS NAME NUMBER 1 商品A 3 1 商品B 2 2 商品C 2 検索キー「商品B」の場合の検索結果： CLASS NAME NUMBER 1 商品A 2 1 商品B 2 1 商品C 1 検索キー「商品C」の場合の検索結果： CLASS NAME NUMBER 1 商品A 2 1 商品C 2 1 商品B 1 （１）RELATION_GOODSテーブルの構造 CREATE TABLE IF NOT EXISTS RELATION_GOODS( FILE_ID INT NOT NULL, GOODS_ID INT NOT NULL, PRIMARY KEY(FILE_ID, GOODS_ID), INDEX FILE_ID(FILE_ID) USING BTREE, INDEX GOODS_ID(GOODS_ID) USING BTREE) （２）GOODSのテーブルの構造 CREATE TABLE IF NOT EXISTS GOODS( GOODS_ID INT NOT NULL, CLASS INT NOT NULL, NAME VARCHAR(1000) NOT NULL, PRIMARY KEY(GOODS_ID), INDEX CLASS_GOODS(CLASS, NAME(255)) USING BTREE, INDEX GOODS(NAME(255)) USING BTREE, INDEX CLASS(CLASS) USING BTREE) （３）検索式 SELECT B.CLASS, B.NAME, COUNT(*) AS NUMBER FROM RELATION_GOODS AS A INNER JOIN GOODS AS B ON(A.GOODS_ID = B.GOODS_ID) WHERE A.FILE_ID IN( SELECT A.FILE_ID FROM RELATION_GOODS AS A INNER JOIN GOODS AS B ON(A.GOODS_ID = B.GOODS_ID) WHERE B.NAME LIKE 'DVD' ) GROUP BY B.CLASS, B.NAME ORDER BY NUMBER DESC （４）諸情報 テーブル名 レコード数 データ型 照合順序 サイズ オーバーヘッド GOODS 612,750 InnoDB utf8_general_ci 69.6 MiB -- RELATION_GOODS 12,352,490 InnoDB utf8_general_ci 485 MiB -- バージョン： MySQL5.6.24 （３）の実行時間：Showing rows 0 - 24 (30181 total, Query took 136.2325 seconds.)
指定のカラムの最大値を出す方法はmax(カラム名）とやればいいのですが、１行の中の複数のカラムの中で最大値を出したい場合はどうしたらいいでしょうか？ 例えば、 id name score_a score_b score_c 1 hogehoge 1 3 2 2 hoge 5 1 3 とデータがあって、 指定のidで、score_a,score_b,score_cの最大値を出す。 id = 1 なら、　score_bの「３」が最大値 id = 2なら、　score_aの「５」が最大値 といった結果を出したいです。 よろしくお願いします。
下記のテーブルがある。idはintで、mailはtext +------+--------------------------------------+ | id | mail | +------+--------------------------------------+ | 1 | 最初のinsert into の実験 | | 2 | 上手く行ったが、こんなもんでは無い。 | | 3 | 途中からだが、上手く行くのか。 | | 4 | 今度はもうバッチリ見たいだ。 | | 5 | end_of_record | | 6 | これが最後のテストデータです。 | | 7 | 始めて、途中でエラーが出たが。 | | 8 | 何か知らんが、2回目でエラーになる。 | | 9 | ここで動かない理由は何なんだ。 | | 10 | ここは気にせずに前を向いて歩こう。 | | 11 | end_of_record | +------+--------------------------------------+ これは、 select * from work where id<= ( select min(id) from work where mail = "end_of_record" ) ; 上記を実行すると下記が得られる。 +------+--------------------------------------+ | id | mail | +------+--------------------------------------+ | 1 | 最初のinsert into の実験 | | 2 | 上手く行ったが、こんなもんでは無い。 | | 3 | 途中からだが、上手く行くのか。 | | 4 | 今度はもうバッチリ見たいだ。 | | 5 | end_of_record | +------+--------------------------------------+ では、これをdeleteで実行しようとすると、サブクエリーでは同一の テーブルが使えないと言うエラーが出る。 delete from work select * from work where id<= ( select min(id) from work where mail = "end_of_record" ) ; 別名を使った、deleteのsqlを教えて下さい。 宜しく、お願いします。
今は、実際にテーブルのカウントを取って確認を取っていますが。この 方法は件数が増えると遅くなります。 select count(id) from mail; 実際の処理は件数を取得するのが目的では無くて、テーブルにレコード が有るのかどうかの確認ですので件数を取得する必要は無いのですが。 他に方法を知らないのでこの方法を今は取っています。 簡単にレコードが有るのかの有無の確認と言うのは取れないのでしょう か。 宜しく、回答願います。
mailのテーブルは下記の様に定義をしています。 1. mail text 2. id int この状態でload data infileで、idに連番を付加したいのですが。 出来る方法は無いのでしょうか。
workのテーブルに下記のデータが入っている。 この時に、end_of_recordで分離されているので最初のidがここでは1か ら4迄をselect句を使って抽出をしたい。 mysqlのselect * from work where ... で、何とか抽出をしたいのですが。構文が分かりません。 sqlの回答をお願いします。 +------+--------------------------------------+ | id | mail | +------+--------------------------------------+ | 1 | 最初のinsert into の実験 | | 2 | 上手く行ったが、こんなもんでは無い。 | | 3 | 途中からだが、上手く行くのか。 | | 4 | 今度はもうバッチリ見たいだ。 | | 5 | end_of_record | | 6 | これが最後のテストデータです。 | | 7 | 始めて、途中でエラーが出たが。 | | 8 | 何か知らんが、2回目でエラーになる。 | | 9 | ここで動かない理由は何なんだ。 | | 10 | ここは気にせずに前を向いて歩こう。 | | 11 | end_of_record | +------+--------------------------------------+
現在、自作でアクセス解析を作成しております。 グラフ等の表示で必要なレコードの取得についてどうしてもわかりません。 ご教授頂ければと思います。 =========================================== ■レコード一覧 =========================================== id date 　　page_id session_key device 1 2016-1-1　　1 1 pc 2 2016-1-1　　2 1 pc 3 2016-1-1　　1 2 smart 4 2016-1-1　　2 2 smart 5 2016-1-1　　1 3 pc 6 2016-1-1　　2 3 pc 7 2016-1-2　　1 3 pc 8 2016-1-2　　1 4 smart 9 2016-1-3 　　1 5 pc =========================================== 日付ごとにアクセスした人数(uniqu数)取得したいです。(表示上デバイス毎) DISTINCTを使えば重複を取り除けるのでしょうが、どこにどういれれば良いかわかりません。 現状のsqlを記載します。この結果からsession_keyを取り除く為にはどのようなsqlにすればよいか。 SELECT `date` , COUNT(CASE WHEN device = 'pc' THEN 1 ELSE NULL END ) AS `pc` , COUNT(CASE WHEN device = 'smart' THEN 1 ELSE NULL END ) AS `smart` FROM `access_records` WHERE `date` >= '2016-01-01 00:00:00' AND `date` <= '2016-01-03 23:59:59' GROUP `date` ORDER `date` ASC =========================================== ■現状の結果 =========================================== date 　　pc smart 2016-1-1 　　4 2 2016-1-2 　　1 1 2016-1-3 　　1 0 =========================================== =========================================== ■取得したい結果 =========================================== date 　　pc smart 2016-1-1 　　2 1 2016-1-2 　　1 1 2016-1-3 　　1 0 ===========================================
単純にデータとして以下のようなのがあった時 data createdate 1 2016-01-01 01:01:22 1 2016-01-01 08:00:23 1 2016-01-03 09:00:22 みたいなデータがあって 結果として、 2016-01-01 → 2個 2016-01-02 → 0個 2016-01-03 → 1個 と取得した。この「０」個も取得できるようにしたいです。 上記の場合は、1/1から1/3の値の集計として出す。この日付の範囲も指定したい。 例えば、1/1~1/4の範囲で上記のデータを解析すると 2016-01-01 → 2個 2016-01-02 → 0個 2016-01-03 → 1個 2016-01-04 → 0個 となる。 よろしくお願いします。
MySQLの最新バージョンをこちらのサイトで見ているのですが、 http://openstandia.jp/oss_info/mysql/version/ 10月26日に5.7.9になって 12月14日に5.5.47になっていますが、数字が減っていても 新しい日付でリリースされたものが最新バージョンになるのですよね？ 同じく、PHPはこちらを見ましたが http://news.php.net/group.php?group=php.announce 7.0.1が最新ということでしょうか？
初めまして、XAMPPのコントロールパネルv3.2.2を開いて、ＭｙＳＱＬのスタートボタンをクリックすると次のようなエラメッセージが表示されて開くことができません！。 Status change detected: stopped 18:19:31 [mysql] Error: MySQL shutdown unexpectedly. 18:19:31 [mysql] This may be due to a blocked port, missing dependencies, 18:19:31 [mysql] improper privileges, a crash, or a shutdown by another method. 18:19:31 [mysql] Press the Logs button to view error logs and check 18:19:31 [mysql] the Windows Event Viewer for more clues 18:19:31 [mysql] If you need more help, copy and post this 18:19:31 [mysql] entire log window on the forums さらに、ブラウザを立ち上げて「http://localhost/」への接続もできません！。 何方か　解決方法を教えてください、よろしくお願いします。 尚、OSはWindows10をダウンロードして使っています。
mysqlの勉強でworkbenchをインストールしようと思っていますが。ユー ザー登録をしないとインストールが出来ない見たいです。 私はもう定年退職をしていて勤務をしていないのですが。この場合はイ ンストールは出来ないのでしょうか。適当に前の職場の内容でも良いの でしょうか。 回答の程宜しくお願いします。
例えば、sqlと言うテーブルに下記のsqlの内容が入っている。 クエリー1として、 SELECT TOP 5 Mail.* FROM Mail; 次に、そのクエリー1を使って DELETE クエリ1.* FROM クエリ1; 上記の行が入っている。 ここでは最終的には2行目の削除クエリを実行させたい。また、ここで はこの削除クエリーの後に有る処理を実行して、その後に再度この削除 処理を繰り返す。最終的にはこの削除対象のテーブルのデータが空にな る迄この処理を実行させたい。 然し、先ずはこのテーブルに格納されているsqlをmysqlで実行させる方 法が分かりません。 mysqlにevalの機能は有るのでしょうか。 宜しく、お願いします。
■データベース os：linux mysql バージョン：5.1.73 ストレージエンジン：myisam Ａテーブル：indexあり　レコード件数：10,000,000件 ■webサーバー os：linux 開発システム:php ＜概要＞ linux環境で集計phpにてＡテーブルを作成します。 windows環境でAテーブルの内容を閲覧phpにて表示させます。 現象を下記に記述します。 ・linux環境 １．ＤＢ上のＡテーブルが毎朝の更新処理で作成(更新)されます。(9時３０分頃完了) 　　※作成処理はこれで完了です。翌朝まで処理は起動しません。 ・windows環境 ２．9時30分から11時59分59秒の間にAテーブルでselect文を発行 ３．3秒程でselectされた内容が表示されます。(この内容はキャッシュされます。） ４．この後、未キャッシュのselect文を9時30分から11時59分59秒の間に何度発行しても 　　3秒程でselectされた内容が表示されます。(この内容もキャッシュされます。） ５．この後、12時00分00秒にAテーブルで同じselect文を発行 ６．3秒程で表示されていたものが、5分程の時間を要して表示されます。 　　※index使用せず、テーブルフルスキャンしていると思われます。 　　(この内容もキャッシュされます。） ７．この後は、未キャッシュのselect文を12時00分00秒から14時59分59秒の間に何度発行しても 　　3秒程でselectされた内容が表示されます。(この内容もキャッシュされます。） ８．この後、15時00分00秒にAテーブルで同じselect文を発行 ９．3秒程で表示されていたものが、又5分程の時間を要して表示されます。 　　※これもindex使用せず、テーブルフルスキャンしている。(この内容もキャッシュされます。） １０．その後は、18時00分00秒、21時00分00秒と３時間間隔で同現象となります。 要望としまして 上記の３時間間隔でフルスキャンしてしまう現象を止めたいと思っています。 my.cnfの内容、phpに組み込まれている内容など調べてみたのですが、 時間によってフルスキャンしてしまう(index使用しない)設定がみつかりませんでした。 オプティマイザの挙動（統計情報も関わっている？）についても調べたのですが 上記現象に繋がる情報を取得出来ませんでした。 この現象を解決していただける方、どうかご教示お願いいたします。
mysqlで２つのテーブルをINNER JOINしてデータを抽出したいのですが、うまくデータが抽出できないのでSQL文の書き方を教えてください。 「テーブルの構成」 [postテーブル] id (int) auto_increment name (varchar) [categoryテーブル] id (int) auto_increment post_id(int) name (varchar) 「入力されているデータ」 [postテーブル] id| name 1 | 自由課題 2 | 夏休みの宿題 3 | 研究 [categoryテーブル] id| post_id|name 1 | 1 |国語 2 | 1 |算数 3 | 1 |理科 4 | 2 |国語 5 | 2 |英語 6 | 2 |社会 7 | 3 |理科 8 | 3 |英語 9 | 3 |国語 「抽出したいデータ」 postテーブルとカテゴリーテーブルを SELECT * FROM post INNER JOIN category ON post.id = category.post_id のようにINNER JOINして、categoryテーブルのnameに国語と理科の両方が含まれるpostテーブルのidとnameを抽出したいです。 上記のデータだとpostテーブルの「id=1,name=自由課題」と「id=3,name=研究」という結果が得られれば良いです。 SELECT * FROM post INNER JOIN category ON post.id = category.post_id where category.name='理科' というcategoryのnameを１つだけ指定した場合は抽出できるのですが、 SELECT * FROM post INNER JOIN category ON post.id = category.post_id where category.name='理科' and category.name='国語' と指定した場合 データが抽出できず空の結果が返ってきてしまいます。 ２つのテーブルのINNER JOINという問題以前に 一つのカラムで「国語」かつ「理科」というand検索の方法がわかっていないのが問題のような気がしています。 ご回答よろしくお願い致します。
うん十の手習いでphpを使い始めた者です。 phpでmysql(5.5)のデータに対し、照会画面を作っています。 並び順は、降順と昇順の組合せになっており、 select ymd , soshi, shain from mytbl order by ymd desc, sos, shain の結果で表示される一覧表で、各行をクリックすると、 そのレコードの明細を表示する画面があります。 その明細画面で、次レコードに移動するボタンを設け、 元の一覧表の次の順のレコードを表示したいのです。 明細画面で表示した、ymd,sos,shain の値を別プログラムで、 $ymd, $sos, $shain　として受け取り、 元のクエリの頭出しをするために、 select ymd , soshi, shain from mytbl where ymd <= {$ymd} and concat(sos,sycd) >= {$sos}{sycd} order by ymd desc, sos, shain としても、次レコードの値は正しい値にすることはできません。 並び順が全て昇順であれば、 where concat(ymd,sos,sycd) >= {$ymd}{$sos}{sycd} とすれば可能なのですが、要件的に降順にする必要があるので困っています。 私のつたない知識の範囲からすると、 where ymd <= {$ymd} とだけ、指定して、読み飛ばしすれば出来るのでしょうが、次レコード移動の 度に空読みが発生してしまうので、非現実的です。 カーソルを使ったりしてこんな処理は出来るのでしょうか？
スーパーPDF変換ソフトのお試し版をダウンロードしました。 RDFの書類を添付して送ると、相手にPDFの書類だけが送られるのではなく、 その形のまま（変換できるツールバーなど）も一緒に送られてしまうので、 スーパーPDF変換ソフトをアンインストールしようと思ったら、 間違って違うソフトまでアンインストールしてしまった。 そしたらPDFの書類が見れなくなってしまった。 間違ってアンインストールしたソフトが「Foxit　Corporation」 これが本当に影響したのかも分からない。 それで焦ってシステムの復元をしてしまった・・・。 元に戻ったと思い、直ぐスーパーPDF変換ソフトをアンインストールしようとしたら、 「ファイルが見つかりません」と出てくるのですが、デスクトップにアイコンがあるのと、 やはりPDFの書類はそのままついてくる。今度は色だけがない状態で。 スーパー変換ソフトをアンインストールすること、PDFが見れるようにもとの状態にしたいこと、 アクロバットリーダーがダウンロードが出来ないこと、 その他、復元が原因で今まで閲覧していたものやID、PWが全て消えてしまった。 残しておく方法を教えてください。 この4つを教えて頂きたいので、どうぞ宜しくお願いいたします。
すいません。本当にDBに関しては素人でトンチンカンな質問かもしれませんが、今、MovableTypeのVer4.3のDBからdumpしたデータが手元にあります。 これを自前のサーバーで復元してとりあえず中身が見たいのですが、phpmyAdminでインポートしようとすると、エラーが出てしまって困っています。 エラー SQL query: DROP TABLE IF EXISTS `mt_as_ua_cache` MySQL のメッセージ: ドキュメント #1046 - No database selected これは、mt_as_ua_cacheという名前のテーブルを作ってからインポートをすればいいんでしょうか。 （mt_as_ua_cacheを作ろうとするとエラーが出て作れません） おそらく元のDBはmySQL4.0系、インポート先は5.5です。 やりたいのはとりあえずDBに入れて中身を確認さえできればいいので、エラーがある状態でも入れられればいいです。 不足情報があれば追記しますのでご指摘お願い致します。
サービスにmysqlの登録が成功した後に起動すると 「システム エラー 1067 が発生しました」と表示されてしまいました。 解決策を見ているとアインストールしてインストールし直す意見が一番多かったのですが それ以外に解決方法はないでしょうか？（以前もアインストールしてインストールし直しても上手くいかなったためです）
javaでwebアプリケーション開発をしています。 mysqlに直接ひらがな・全角・半角・英数を打ち込むと受け付けてくれるのですが、servlet→jsp→mysqlの流れ（Java）で、情報を入力すると全角と平仮名が文字化けしてしまいます。 そのためmy.iniの変更を [mysql] default-character-set=utf8 ↓↓↓ [mysql] default-character-set=cp932 に変えましたが今だに文字化けしています。原因は何でしょうか・・・？ ご教示お願い致します。
商品の入出庫記録簿を作成しようとしています。 データベース内の「1.入庫のテーブル」と「2.出庫のテーブル」から、SUM関数で指定項目の合計値を出力しましたが、1の入庫テーブルから出庫テーブルの在庫を減算する方法を教えて下さい。 要約すると、SUM関数で各テーブル(入庫のテーブル,出庫のテーブル)の指定項目の合計値を求めた後に、「1.入庫のテーブル」‐「2.出庫のテーブル」の結果を出力させたいです。 ※1.添付画像を参照していただくと分かりやすいかもです。 ※2.PDO方式でSQL文を記載しています。 1.入庫テーブルの合計値を求めるSQL文 $sql1 = "SELECT syouhin, SUM(kosu) AS 個数合計,SUM(jyuryo) AS 重量合計 FROM shipping GROUP BY syouhin"; 2.出庫テーブルの合計値を求めるSQL文 $sql = "SELECT syouhin1, SUM(kosu1) AS 個数合計,SUM(jyuryo1) AS 重量合計 FROM storage GROUP BY syouhin1";
Javaの勉強をしながらeclipseとmysqlで管理ソフトを作っています。 DAOパッケージで String sql = "select （カラム値） from card_data where card_id = ? order by company_name"; と記述すると、うまくselectされません。（where card_id = ?を外すと値を取ってきます） これは記述の仕方が悪いのでしょうか？それとも、WHEREとORDER BYを同時使えないのでしょうか 詳しい方いらっしゃいましたらご教示お願いします。 ＊環境 eclipse4.5 All in one windows7 　　　 mysql
+-------------------------------+ | SHOP_CD | +-------------------------------+ | 11230 | | 11230,21002,28003,28005,99309 | | 11230,23003 | | 11230,23003,23003 | | 11230,28003 | | 11230,28003,28005 | | 11230,28005,21002,28003 | | 11302 | | 11302,11230 | | 11302,11230,11332 | +-------------------------------+ カンマ区切りの文字列を 重複を省いて取得したいと考えておりますが 実現方法が思いつきません 結果としては、 11230 11302 11332 21002 23003 28003 28005 　・ 　・ とSQLのみを使って配列で取得したいと考えております splitのようなSQL系関数を探したがないので 実現方法またはヒントをいただけると幸いです 宜しく御願いいたします 環境は PHP5、MySQL5.6 になります
こんにちは。 WindowsServer2003上で、MYSQL+phpで動作しているアプリがあります。 これを2008サーバーに移転作業を行っているのですが、非常に困った事態に陥っています。 事前に並行のテスト稼働をしており、旧サーバー上で動作しながら、新サーバーを動かしており、動作確認を1ヶ月以上していました。 移転自体は問題なく終わっており、新サーバーでの動作も確認できるのですが、 旧サーバー上でMysqlサーバーを停止すると、新サーバーが動かなくなる不思議な現象が起きています。 phpスクリプトは、グループウェアの中から、グループウェアの持っているログイン情報を取得し、パラメタで与えて呼び出しています(言語はColdfusion)。その時に取得された変数の値を手入力して同じブラウザで呼び出すと、同じ状況でも正常に動作するのです。ブラウザをCtrl+F5でクリアしても同じです。 グループウェアの仕様と言っても、その中では、MYSQLを使っている訳ではないので、移行によって何か条件が変わるということは考えにくく、何が問題なのか、私の知識ではお手上げな状態です。 何かヒントになる情報でも構いませんので、頂けたら有難いです。 よろしくお願いします。
MySQL5.7.9.0 を windows web server 2008　にインストールしたいのですが、セットアップウィザードが起動しません。 OSが古いせいでしょうか？それとも、ほかに考えられる理由があるのでしょうか？ インストーラーは、mysql-installer-community-5.7.9.0を使っています。 ご教授いただければ幸いです。
日付の月と区分でグループ化して 月の最終日データの値を取得したいのですが どうすればいいのでしょうか？ 値は必ずしもMAXとは限らないのです。 よくわかっていないのですが サブクエリとかを使用すればできるんでしょうか？ 日付,区分,値 2015-01-01,1,2500 2015-01-02,1,2700 2015-02-01,1,3200 2015-02-02,1,700 2015-01-01,2,750 2015-01-03,2,800 2015-02-01,2,1100 2015-02-02,2,1300 データが上記なら 2015-01,1,2700 2015-02,1,700 2015-01,2,800 2015-02,2,1300 と取得する方法です。 よろしくお願いします。
教則本のブログ作成より応用してSNSを作るために自分でデータベースを作成していましたが、素人なので、気づけば汚いデータ構造で、非効率なテーブルになっています。正規化に関する参考書籍を読みましたが、概要は理解できるものの、それを実際に使うとなると、どう応用すればベストな状態になるのかが分かりません。そこで、成り行きできなく、あらかじめ SNSを作成するにあたって必要なテーブルをあらかじめ作成しようと思いますが、一般的に、どのような構造にすることが望ましいでしょうか。 参考となるような、必須テーブル(内部のカラムの詳細等)と、テーブル同士の関連がわかるような内部設計がわかるような解説サイトがありましたら教えてください。(書籍等も) または、テクニックなど豆知識てきなものでもありましたら教えてください。
phpMyAdmin にログインできません。 ユーザー名 : root パスワード : password でログインしようとすると、 #1045 MySQL サーバにログインできません とでます。 MySql 5.6 phpMyAdmin 4.4.14.1-all-languages よろしくお願いします。
３つのテーブルを結合（INNDR JOIN）している状態で重複するデータを無くしたいです。 [テーブルの種類とカラム内容] posts(id,name) categories_posts(id,post_id,category_id) categories(id,name) [現在作成しているSQL文] SELECT * FROM categories_posts INNER JOIN potsts ON categories_posts.post_id = posts.id INNER JOIN categories ON categories_posts.category_id = categories.id; 1つのpostsに複数のcategoryが登録されている場合、postsのデータが重複して取り出されるので、重複するpostsを１つにまとめたい。 GROUP BY を使うというのはいろいろと調べてみてわかりました。自分で実験してみましたが、エラーになってしまいます。 1.postsとcategoriesの関連をcategories_postsというテーブルで管理しています。これらのテーブルをつなげるには上記に記載したSQL文で良いか？（データは取得できていますが記載するテーブルの順番など、これで良いのか？） 2.GROUP BYを使うときに GROUP BY posts.id か　GROUP BY categories_posts.post.idのどちらを使えば良いか？また、上記のSQL文のどこに記載したら良いか？ ご回答よろしくお願い致します。
下記のようなテーブルがある場合にSQL文を書くとき、 id | aaa | bbb | ccc 1 AAA BBB CCC 2 AAB BBB CCD 項目aaaとbbbを検索対象とした場合 Where aaa=AAA and bbb=BBB となると思いますが、 この項目aaa,bbb,cccの中から、ユーザが入力した項目のみ検索対象としたい場合にどのように記述すればよいのでしょうか？ 現状では、下記のようにphpでaaa,bbb,ccc項目のどこに条件が入力されているかで、ifで分けして複数のＳＱＬ文を書いていますが、どうにか１つのＳＱＬでスマートにできませんか？ if aaa !="" and bbb = "" and ccc ="" then select * from table where aaa = *** elseif aaa !="" and bbb !="" and ccc="" then select * from table where aaa = *** and bbb=*** end
Xamppをインストールして、MySQLの文字コードをシフトJISにする為、my.iniファイルを開いて、次の様に設定しました。 [mysqld] #bind-address="127.0.0.1" character-set-server=cp932←追加した skip-character-set-client-handshake←追加した 二箇所追加してMySQLを再起動させたら、エラーが表示されて再起動がされなかった。 どうすればいい？ なお、この設定は「基礎からのMySQL」の本に記されたものです XAMPP1.8.3（MySQL5.6）を使っています。
まずは実行したいddl insert into tb_A (col_a,col_b,col_c,col_d,col_e,col_f,col_g,col_h) values ((select col_a from tb_B),col_b,col_c,col_d,col_e,col_f,col_g,col_h) col_aは複数あります。col_b〜hは値を直接指定でinsertしたいのですが、 エラー: Subquery returns more than 1 row 一件しか返せない？となります。 複数行一括でinsertするにはどうすればいいでしょうか。
まったくの初心者ですが、どうしてもWPを使いたいので対処法を教えて頂けると助かります。どうぞよろしくお願いします！勉強する気はあるので、書籍等おすすめがあったら教えてもらえると嬉しいです。 【環境】 WordPress のバージョン: 4.2.4 使用しているプラグインとテーマの情報(名称、入手先 URL、バージョン)　Twenty Fourteen. PHP、MySQL のバージョン: 5.5 サーバー環境: Xserver ブラウザとそのバージョン：　Safari バージョン 6.2.3、Firefox40.0.2 【問題】 Xserverを使用しています。自動インストールでWordPressをインストール後、WPで投稿をかきあげ公開したのですが、サイトでは「このウェブスペースへは、まだホームページがアップロードされていません」と出てしまいます。 超初心者用などのサイトを見て、インストールしました。SQLは自動生成しました。（ただ不安なのは、xserverで自動インストールをしましたが、「wp-config.php」については自動インストールの場合は必要ないのかと思い、行っていません。一応、miをダウンロードして、WordPressのフォルダーに入っていたwp-config.phpのサンプル等を読んだのですが、どうすれば良いのか分からず挫折しています。 【行った事】 ・http://itwebkatu.com/xserver_no_upload/　等の記事を見たので、index.htmlを消そうとしましたが… 1)public.htmlの直ぐ中に入っているindex.htmlを消したところ、403が出るようになりました。 2)public.html＞wpの中には、index.phpのみなので、どこを消せば良いのか分かりません。 ・ドメインを初期化、WordPressをアンインストールし、さらにインストールしましたが、変わりません。 ・SQLももう一度設定し直したり、再度自動生成したりしましたが、うまくいきません。
mysql> select * from rellist; +-----------------+------------+---------------------+---------------------+ | peerId | roomId | modified | created | +-----------------+------------+---------------------+---------------------+ | 3EQBWrqHnikWkTo | TNhIxdEKn | 2015-08-13 21:07:02 | 2015-08-13 21:07:02 | | 7hQ6qGmjh3TEiBd | pOJGAaVWzr | 2015-08-13 20:57:55 | 2015-08-13 20:57:55 | | 9cykwLPXvobT2zi | TNhIxdEKn | 2015-08-13 21:07:48 | 2015-08-13 21:07:48 | | DTYr97cO6dNW7CB | pOJGAaVWzr | 2015-08-13 20:55:34 | 2015-08-13 20:55:34 | | lBzkYuPMjnXoUq2 | 7fXXpUreG1 | 2015-08-13 21:06:13 | 2015-08-13 21:06:13 | | li0NspvzwnkRDRs | pOJGAaVWzr | 2015-08-13 20:55:26 | 2015-08-13 20:55:26 | | UNEFHZvKpgRnBt4 | TNhIxdEKn | 2015-08-13 21:07:10 | 2015-08-13 21:07:10 | | Vfzwwx653bEoVUw | 7fXXpUreG1 | 2015-08-13 21:06:20 | 2015-08-13 21:06:20 | +-----------------+------------+---------------------+---------------------+ 8 rows in set (0.00 sec) mysql> select * from peerslist; +-----------------+-----------------------+---------------------+---------------------+ | peerId | email | modified | created | +-----------------+-----------------------+---------------------+---------------------+ | 3EQBWrqHnikWkTo | main@gmail.com | 2015-08-13 21:07:02 | 2015-08-13 21:07:02 | | 7hQ6qGmjh3TEiBd | aaa@gmail.com | 2015-08-13 20:57:55 | 2015-08-13 20:57:55 | | 9cykwLPXvobT2zi | aaa@gmail.com | 2015-08-13 21:07:48 | 2015-08-13 21:07:48 | | DTYr97cO6dNW7CB | bbb@gmail.com | 2015-08-13 20:55:34 | 2015-08-13 20:55:34 | | lBzkYuPMjnXoUq2 | main@gmail.com | 2015-08-13 21:06:13 | 2015-08-13 21:06:13 | | li0NspvzwnkRDRs | main@gmail.com | 2015-08-13 20:55:26 | 2015-08-13 20:55:26 | | UNEFHZvKpgRnBt4 | bbb@gmail.com | 2015-08-13 21:07:10 | 2015-08-13 21:07:10 | | Vfzwwx653bEoVUw | bbb@gmail.com | 2015-08-13 21:06:20 | 2015-08-13 21:06:20 | +-----------------+-----------------------+---------------------+---------------------+ のようなテーブルがあります。 bbb@gmail.comが存在するRoomIDのメンバ一覧を全て取得したいのですが、どのように実施すればよいかご教授願います。 ちなみに以下でやりましたが、当然うまくいきませんでした。。。 (原因はわかりますが、どのように修正すべきかがわかりません。よろしくお願いします。) SELECT b.peerId,b.email,a.roomId FROM rellist a INNER JOIN peerslist b ON a.peerId = b.peerId WHERE b.email="bbb@gmail.com" ORDER BY a.CREATED DESC; SELECT b.peerId,b.email,a.roomId FROM rellist a INNER JOIN peerslist b ON a.peerId = b.peerId WHERE a.roomId =(SELECT b.roomId FROM peerslist a, rellist b WHERE a.email="bbb@gmail.com" AND a.peerId = b.peerId ORDER BY b.CREATED DESC);
[親テーブル] create table example( number int unsigned auto_increment not null primary key, ： ); [親テーブルに紐づくチェックボックス用テーブル] create table example_checkbox( example_number int unsigned not null, ： ); numberとexample_numberで繋がっているのですが、チェックボックス用テーブルには、 チェックボックスにチェックされたIDが累積して格納されております。 本来ならばexampleテーブルに正規化して持たせたかったのですが、チェックボックス の数は可変するため、別テーブルにしております。 exampleテーブルの一覧を出す際に、example_checkboxで指定されたIDがあるか（チェック されているか否か）の条件を入れたいのですが、exampleとexample_checkboxは1対多で あるため、joinを使うとexample_checkboxの数分結果が返ってきてしまうものと想定して おりますが、何かうまいやり方はないものでしょうか。 アドバイスいただければ幸いです。
xamppのmysqlのパスワードを設定するにはどうすればいいのですか? Apacheの横のadminをおしてもwelcome to xamppと表示されるだけです。
お世話になります。 MySQLで　テーブル名：table_abc 内に　カラム名：member_no　で数字が10桁と11桁の番号としてデータが格納されているのですが カラム名：member_no　の11桁の値の　先頭数字に 0 が付いて始まっているので その11桁の先頭数字０をとり、10桁にしたいのですがどのようにSQL文を書けばよろしいでしょうか？ ちなみにもとからある10桁の値の方は、0以外の数字から始まっています。 （データベースへはphpMYadminからアクセスしています。） 猛暑の中、恐縮ですが　御教示頂ければ幸いです。
MySQL のJavaです。 パラメータに、iPara_food_idとiPara_kind_idを与え、 １）comment_textが、null か、空っぽで、 ２）limit_date が最大、 ３）のレコードを１件抽出したいのですが、 String strSQL = "SELECT record_id, color_id FROM foods" + " WHERE" + " (food_id = " + 123455/*iPara_food_id*/ + ")" + " AND (kind_id = " + 1545334/*iPara_kind_id*/ + ")" + " AND (comment_text IS NULL) OR (LENGTH(comment_text) = 0)" + " AND (delete_flag = false)" + " ORDER BY limit_date DESC" + " LIMIT 1"; テーブルとソースを何度も見直したり、 値を変更してみたり、 パラメータの値を変更してみたり、 したのですが、 パラメータに、iPara_food_idとiPara_kind_id。 何を与えても、同じレコードを抽出してきます。 それは、３０件ほどのレコードの中で、 日付が途中くらいのもので、comment_text が空の ものです。 comment_textが空のレコードは、 ２件あるのですが、 固定で抽出してくるレコードは、 日付の大きいほうです。 なぜ、パラメータが聞かないのでしょうか？ ※上記、思い切って、むちゃくちゃな、数値を 　指定していますが、それでも、同じレコードを 　抽出してきます。
MySQLをJAVAで使っています。 指定キーの中で、一番日付の大きなレコード項目全てを 取り出したいのですが、 下記SQLだと、何も抽出されません。 何が間違っているのでしょうか？ さらに、もっと簡単なSQL文はないでしょうか？ SELECT * FROM food WHERE (food_id = 1) AND (food_name = 'みかん') AND (food_id = (SELECT MAX(date) FROM food WHERE (food_id = 1) AND (food_name = 'みかん'))) 与える検索キー項目は、food_id=1, food_name=みかん foodテーブル例 food_id　　food_name　　　date --------------------------------- 1　　　　　みかん　　　　2015-01-01 1　　　　　みかん　　　　2015-02-01 1　　　　　みかん　　　　null 1　　　　　みかん　　　　2015-04-01 2　　　　　きんめだい　　2015-01-01 2　　　　　じんたん　　　2015-02-01 2　　　　　コロッケ　　　2015-02-01
MySQLのON DUPLICATE KEY UPでエラーもでずに、 更新や新規作成もされない。 MySQLで、ON DUPLICATE KEY UPDATE を初めて使っています。 ところが、レコードが更新や作成されなくて困っています。 具体的には、下記のようなSQL文ですが、 どこがわるいのでしょうか？ String strSQL = "INSERT INTO interview_patient_modoule (" + "aaa"　・・・複合キー +",bbb"　・・・複合キー +",ccc" +",ddd" 　・・・複合キー +",eee" + ")" + " VALUES (" + "1" + ",2" + ",3" + ",4" + ",5" + ")" + "ON DUPLICATE KEY UPDATE" + "aaa = 1"　・・・複合キー +",bbb = 2"　・・・複合キー +",ddd = 3"; 　・・・複合キー // SQLの実行 dbStatement.execute(strSQL);
MySQLのON DUPLICATE KEY UPでエラーもでずに、 更新や新規作成もされない。 MySQLで、ON DUPLICATE KEY UPDATE を初めて使っています。 ところが、レコードが更新や作成されなくて困っています。 具体的には、下記のようなSQL文ですが、 どこがわるいのでしょうか？ String strSQL = "INSERT INTO interview_patient_modoule (" + "aaa"　・・・複合キー +",bbb"　・・・複合キー +",ccc" +",ddd" 　・・・複合キー +",eee" + ")" + " VALUES (" + "1" + "2" + "3" + "4" + "5" + ")" + "ON DUPLICATE KEY UPDATE" + "aaa = 1"　・・・複合キー +",bbb = 2"　・・・複合キー +",ddd = 3"; 　・・・複合キー // SQLの実行 dbStatement.execute(strSQL);
MySQLです。 既にレコードがあるか、ないか、不明な状態で、 同じキーのレコードを書き込みたいのですが、 事前にレコードの有無を確認せずに、UPDATE or INSERTする方法は、 ありますか？ レコードをユニークにするキーは、３つあります。
MySQLです。 商品IDと販売先、管理番号が、判明しているとき、 最大商品IDとそのレコードを取得するには、 どのようなSQLを書けば、よろしいでしょうか？ select *, ？ from SYOUHIN WHERE ???? テーブル例） ↓ユニーク 商品ID　販売先　管理番号　 販売日 1　　　A社　　　1　　　　　2015-07-10 2　　　A社　　　2　　　　　2015-07-12 3　　　B社　　　1　　　　　2015-06-30 4　　　B社　　　2　　　　　2015-07-06 5　　　C社　　　1　　　　　2015-04-21
MySQLを使っています。 同じ商品のレコードが複数あります。 その多数のレコード中に、日付項目があります。そこから、 １）指定日に、２）一番近い過去の日の１件の、３）全商品のレコード、を抽出するには、 どのようなSQL文を書けばよいでしょうか？ １．過去に複数ある日付の中から、指定日に、一番近いレコード。 レコードの例） 指定日＝2015-07-01 商品ID 日付 1 2015-10-11 ・・・未来 ⇒ 抽出せず 1 2015-08-02 ・・・未来 ⇒ 抽出せず 1 2015-07-01 ・・・指定日 ⇒ 抽出せず 1 2015-07-01 ・・・指定日 ⇒ 抽出せず 1 2014-01-01 ・・・過去 ⇒ 抽出せず 1 2015-06-03 ・・・過去 ⇒ 抽出したい★★ 2 2015-10-11 ・・・未来 ⇒ 抽出せず 2 2015-08-02 ・・・未来 ⇒ 抽出せず 2 2015-07-01 ・・・指定日 ⇒ 抽出せず 2 2014-01-01 ・・・過去 ⇒ 抽出せず 2 2015-06-03 ・・・過去 ⇒ 抽出したい ★★
商品テーブルの中で、 同じ商品のレコードが複数あります。 その多数のレコード中に、日付項目があります。 そこから、 １）指定日に、２）一番近い過去の日の１件、３）指定日を含めて、複数ある指定日及び未来の全レコード、を抽出するには、 どのようなSQL文を書けばよいでしょうか？ １．過去に複数ある日付の中から、指定日に、一番近いレコード。 ２．指定日と未来に複数ある日付の中の、全ての未来の、レコード。 レコードの例） 指定日＝2015-07-01 商品ID 日付 1 2015-10-11 ・・・未来 ⇒ 抽出したい 1 2015-08-02 ・・・未来 ⇒ 抽出したい 1 2015-07-01 ・・・指定日 ⇒ 抽出したい 1 2015-07-01 ・・・指定日 ⇒ 抽出したい 1 2014-01-01 ・・・過去 ⇒ 抽出しない★ 1 2015-06-03 ・・・過去 ⇒ 抽出したい 2 2015-10-11 ・・・未来 ⇒ 抽出したい 2 2015-08-02 ・・・未来 ⇒ 抽出したい 2 2015-07-01 ・・・指定日 ⇒ 抽出したい 2 2015-07-01 ・・・指定日 ⇒ 抽出したい 2 2014-01-01 ・・・過去 ⇒ 抽出しない★ 2 2015-06-03 ・・・過去 ⇒ 抽出したい
MySQLの容量の削減の仕方 Media Wikiをしていたら気付かないうちに 数日間で大量のスパムが来て、 MySQLデータベースが肥大化しました。 またそのためサイト全体にもパフォーマンスが 落ちてきました。 サイト上から直接のログは消したものの DBの容量の削減手順や方法が調べても はっきりと理解できたか不安です。 知っている方いたらわかりやすく 教えて頂けると助かります。 よろしくお願いします。
社内システムをPHP＆MYSQLで構築しています。 現在、MYSQLの文字列削除に頭を悩まされており、ここで質問させていただきました。 テーブル名：sampleTbl ID　rlist 45　6,455,121,898,742,45 46　556,55,11,189,72,325 47　46,45,1321,2,742,33 48　46,455,121,32,742,4788 49　476,423,111,828,106,46 50　556,433,141,888,211,45 現在、このようなテーブルがあり、レコード数は1万を超えます。 例えば「rlist」に含まれる「72、6、45、106、211、2」を削除したいと考えています。 replaceを検討しましたが、削除する文字列が動的に変わるため、replaceだと削除する文字列が多くなるほどSQL発行が多くなってしまいます。 何か良い方法はないでしょうか。よろしくお願いいたします。
文字列長を調べる関数として、Web上で“char_length”という関数を見つけ、早速使ってみました。 紹介ページでは、全角も半角も1文字は1という結果が返って来ると書かれています。 しかし私の場合、そんな結果が返って来ません。 名簿テーブル（UTF-8）の姓カラム（UTF-8）に漢字名（UTF-8）が入っており、ここにchar_length関数を使うと、漢字2文字なら6、3文字なら9という結果が返って来ます。 Web上で説明されているような、2や3という結果は一つも返って来ません。 半角1文字（UTF-8）ならちゃんと1で返って来るのですが、全角1文字（UTF-8）は3と返って来るようです。 使用環境やバージョンによるものかな、と思って調べてみたのですが、そういった情報は発見できませんでした（むしろ、自分より古いバージョンのMySQLでも正常結果が返って来ている例も発見したりして・・・） どこか設定の問題でしょうか？ 対処法があれば教えてください。 宜しくお願いします。 Windows XP Pro SP3 MｙSQL 5.1.30
環境はMySQL5.5です。 学習問題ソフトを2つのテーブルで作っています。 1つ目のテーブル名はquestionsで id, mondai, kotaeで 問題文と答えが入ってます。 2つ目のテーブル名はquestion_historiesで id, questions_id, is_correctで 1つ問題を解くごとにquestionsのidと正解・不正解のbool値をいれていきます。 やりたいことは 「questions.id, questions.mondai, 正解率(この問題の正解数/この問題と解いた回数*100)」 を出したいと思います。 どんなSQLを書けばいいか教えてくださいｍ（＊＿＿）ｍ
以下の様な3カラム（room,reservation,daytime）のデータがあったときの解析方法を教えていただきたいです。 room reservation daytime 1 空き 2015-05-01 1 空き 2015-05-02 2 予約 2015-05-01 2 予約 2015-05-02 1 予約 2015-06-01 1 空き 2015-06-02 2 予約 2015-06-01 2 予約 2015-06-02 ホテルの予約状況を想定して、各月の部屋毎の合計予約数を出したいです。 上記の例であれば、以下の様な結果 2015年５月　room1の予約数 0 2015年５月　room2の予約数 2 2015年６月　room1の予約数 1 2015年６月　room2の予約数 2 よろしくお願いします。
mysqlで下記のAAAというテーブルからuniqueキー設定されている BBBという列名をuniqueキーから解除することを考えています。 CCCもuniqueキーですが、CCCはuniqueのまま残します。 テーブル構造は下記の通りです。 CREATE TABLE `AAA` ( `id` char(5) NOT NULL COMMENT 'ID', `BBB` char(3) NOT NULL COMMENT 'コード', `CCC` varchar(50) NOT NULL COMMENT '名前', PRIMARY KEY (`id`), UNIQUE KEY `UK_AAA` (`BBB`,`CCC`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='AAA用' まずは、下記sqlでindexを削除しました。 alter table `AAA` drop index UK_AAA ; その後のテーブル構造は下記のようにUNIQUE KEY `UK_AAA`が消えました。 CREATE TABLE `AAA` ( `id` char(5) NOT NULL COMMENT 'ID', `BBB` char(3) NOT NULL COMMENT 'コード', `CCC` varchar(50) NOT NULL COMMENT '名前', PRIMARY KEY (`id`), ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='AAA用' そして次のsqlでBBBをuniqueに再び設定しようと試みました。 alter table `AAA` add unique (BBB); しかし、ここで警告メッセージが出現しうまく反映されません。 [Err] 1062 - Duplicate entry '0' for key 'BBB' 自分でこの警告を調べてもわかりませんでした。 結果的にBBBがunique解除されればいいので、私が実施したsql手順 でなくても他に効率のいいやり方があればその方法をご教授ください。 よろしくお願いします。
table1とtable2を結合した上で、areaのフィールドをまとめたtable3を作るにはどうすれば良いでしょうか。 table1 id | area | ----+----------- 1 | 東京　　 | 2 | 神奈川 | 3 | 神奈川 | 4 | 千葉 | table2 id | area | ----+----------- 1 | 青森　　 | 2 | 東京 　| 3 | 神奈川 | 4 | 埼玉 | table3 id | area | ----+----------- 1 | 青森　　 | 2 | 東京 　| 3 | 神奈川 | 4 | 埼玉 | 5 | 千葉 |
MYSQLでマトリックスの内容を管理することはできるでしょうか？ 例えば 　　　肩幅　　身幅　　着丈 XS　　40　　　45　　　59 S　　　44　　　52　　　65 M　　　48　　　56　　　70 L　　　50　　　60　　　75 これを管理するには2つのテーブルで分けて管理するしかないですか？
MySQL5逆引き大全460の極意という本を参考に勉強しているんですが ALTER TABLE <テーブル名> ADD (<カラム名> <型情報>, <カラム名> <型情報>, ....); という形式で列定義を複数追加するときに後ろに[FIRST|AFTER 列名]という風に書いてあります。 しかしそれで実行するとエラーになります。 私が何か書き方を間違えているのか、本が間違っているのかわかりません。 一応本に書いてある通りにはやったつもりなんですが。 ちなみにADD id INT AFTER name,ADD score INT FIRSTのような形式で複数追加する場合は AFTERもFIRSTも問題なく実行できます。 ～ADD (<カラム名> <型情報>, <カラム名> <型情報>, ....);のときのAFTER等の使い方 もしくは使用可能か不可能かについて教えていただきたいです。 よろしくお願い致します。
MySQLで複数テーブルを作成することはできますか？ 試しにCREATE TABLE tb1(c1 int), tb2(c1 int);のようにしたらダメでした。 また、MySQLでできなかったとしたとき他のRDBMSならできるというものが あれば教えていただきたいです。 よろしくお願い致します。
mySQLのストアドプロシージャにて、以下のようなコードを用いています。 SELECT * from `db`.`table` where `criteria` = criteria; この時、期待と異って`db`.`table`の全レコードが返されます。 しかし、where句にて条件を`table`.`criteria`のようにテーブル名を含めて 指定すると期待通りに抽出された結果が得られます。 なぜ、カラム名と変数名が同一だと、このような結果になるのでしょうか。 バッククオートにより`criteria`がカラム名だと明示されている筈です。 また、テーブル名を含めた指定だと期待通りの結果になる理由も分かりません。 仕組みをしっかり理解したいので、ご教示頂けますと幸いです。 ところで、対象をテーブル名やデータベース名を含めて記載すること(パスで言うところのフルパス)は何というのでしょうか？ こちらもご存知でしたら、ご教示願います。
MySQL5.1（サーバCentOS）に他のＰＣ（windows7)から接続できません。他の質問などを見て以下の４点を確認し ​ました。 ・MySQLの接続可能なユーザとＰＣをＳＱＬで確認　select ​user,host ​from ​ mysql.user; ・CentOSのネット設定確認　netstat ​で0.0.0.0:3306 ​0.0.0.0:* ​LISTENが表示 ​ される。 ・CentOSのファイヤウォール確認iptables -nL ・windows7からtelnetでcentOSにログインし、mysqlコマンドで接続 ですが、windows7にmysqlをインストールして、コマンドラインからmysql -h CentOSのIP で接続しようとすると、接続できません。 ERROR 2003 (HY000): Can't connect to MySQL server on ''(10061)が表示されます。 質問 ・クライアントwindows7での設定は何か必要ですか？ ・my.cnfのbind-addressをコメントアウトする書き込みがありましたが、mysql --helpで表示されるパスにmy.cnfがありません。作成する必要はありますか？ よろしくお願いします。
MySQLでデータ挿入時にid としてauto_increment値を設定するのですが、 同時にp_codeというカラムで3ケタのゼロフィルしたコード値を入れたいのですが、 可能でしょうか？
Mysqlの文字コードがlatin1のサーバーAと、Mysqlの文字コードがutf8のサーバーBがあります。 サーバーA内でデータを取得し表示する際は、そのまま表示するだけで文字化けせず表示できますが、サーバーBからサーバーAのMySQLに接続し、表示した場合は文字化けします。 サーバーBはMysqlの文字コードの文字コードがutf8なのですが、サーバーAからデータを取得して表示するだけなのに文字化けってするのでしょうか？ どなたか原因が分かる方、よろしくお願いいたします。
以下のような機能を実装するためのデータベースを作成したのですが、どのようにテーブルを作ればいいのかわかりません。 ・いろいろなブログからRSS経由で記事名・更新日時・url等々取得する（それをDBにほうりこむ） ・取得したものの中でクリック率が高いものを順に表示する ・取得したものの中でカテゴリ別に分けて表示する この場合、１つのテーブルの中に、記事名・更新日時・url・クリックカウント数等々、全部放り込めば良いと素人考えで思ってしまうのですが、あまりよろしくないのでしょうか？（正規化とかそういう考え？） テーブルは２つくらいに分けたほうがいいのでしょうか？ ご回答宜しくお願いいたします。
wifiなどネットワークに関する分かりやすいホームページや本を教えてください。
現在Windows　XP上で動いているソフトなのですが、 このソフトが、MySQL　Server＆ Cliants 4.0.13 （Winmysqladmin1.4及び Mysql ODBC 3.51） を使用しています。 このPCが壊れてしまったため、新しいパソコン　windows 7 pro　32bit (ハードウェアでHDD2個のミラーリング仕様)を購入し このソフトをインストールしたのですが、うまく動きません。 具体的には、ソフトはインストールでき、Winmysqladmin1.4が起動するのですが、 赤信号になってしまい、緑信号表示になりません。 ためしに、別のPC（元windows xp　を　7　アルティメットにバージョンupしたもの） に同じソフトをインストールし、うまく動いたので、 my.iniのセットアップやpathの設定は間違っていないと思うのですが。 データーベースは、詳しくないので、助けていただけるとうれしいです。 中途半端な知識で挑んだのが失敗でした･･･。 ちなみに、DBの用語等もわからないので、これからMYSQLの勉強をしようと思うのですが、 お勧めの本がありましたら教えてください。
テーブルAはid、名前、住所、電話番号のカラムがあり、データが入っております。 テーブルBもid、名前、住所、電話番号のカラムがあり、データが入っております。 これまでは二つのテーブルを利用しておりましが、二つのテーブルの構成が同じで、二つのテーブルに分けておく必要がない為、今後は二つのテーブルを1つにまとめて、テーブルCを作成して利用したいと思いました。 この場合はどのような方法で作成出来ますでしょうか。 また、今回は1つのテーブルにまとまればいいので、テーブルCを作成するまでもなく、テーブルＡの中にテーブルＢの内容をそのまま入れる方法もあるかと思うのですが、そちらの方法も教えていただけますでしょうか。 よろしくお願いします。
昨日から、なにかのブラウザを開くたびに 画像のような広告が、左下、中央の下、右下から飛び出してきて、そのまま他のブラウザに勝手に移動してしまい、ものすごく困ってます。 ウイルスをスキャンしても調べて出てくる Advanced System Protector」「Advanced File Optimizer」 「Advanced Driver Updater」「Advanced System Optimizer」 「regclean pro」「Yontooなんとか」「Uniblueなんとか」 「QuickShare」「AddLyrics」「WebCake」 「MixiDJ chrome Toolbar」「MyPC Backup」 「lucky leap」「MixiDJ dToolbar」「DefaultTab」 「pricemeter」「mobogenie」 というものをアンインストールすればいいとあるのですが、 コントロールパネルを開いても何一つありません。 どうしたら広告が消えるのでしょうか。 パソコンはWindows7です。 お願いします！
Windows2003上で稼働していたMysql5.1を Windows2008R2上の5.5に移行中です。 試行錯誤のうえ、mysqldumpで日次行っているバックアップデータをレストアするまではなんとかできたようですが、phpのプログラムで日本語を表示すると文字化けが発生してしまいます。 文字コードの設定は旧マシンと同じ状態になっていることは確認しました。 元の設定も少しいびつな状態になっているとは思いますが、Command Line Clientで見ると、正常に日本語は表示されています。 ▼my.iniの内容 [mysql] default-character-set=cp932 [mysqld] default-character-set=cp932 ▼mysqlの環境変数 mysql>show variables like 'chara%' character_set_client　cp932 character_set_connection　cp932 character_set_database　utf8 character_set_filesystem　binary character_set_results　cp932 character_set_server　cp932 character_set_system　utf8 ▼データ文字セット 対象データベースの文字コード：utf8 テーブルのdefault-charaset：cp932 十分に理解していないうえでデータベースを構築しているのでいびつな状態になっている状態ですが、移行後も、phpのソース(文字コードsjis)上に記載してある日本語の表示文字は正確に出ています。 2008になってunicode化された影響なのでしょうが、プログラムの変更をせずに文字化けを解消する方法はあるのでしょうか？ テーブルの文字列を直接変更すればいいのかもしれませんが、 テーブル内のカラムも個別に文字コード設定してあったりして、どう直せばよいのかも判らない状態です。 create table `mytbl` ( `row1` char(20) character set sjis , (中略) ) default charaset cp932; よろしくお願い申し上げます。
外部端末を利用したいので、 my.cnfを [mysql] default-character-set=utf8 user = mysql pid-file = /var/run/mysqld/mysqld.pid socket = /var/run/mysqld/mysqld.sock port = 3306 basedir = /usr datadir = /var/lib/mysql tmpdir = /tmp language = /usr/share/mysql/English bind-address = ***.***.***.*** としました。 mysqlを起動したところ mysql: unknown variable 'pid-file=/var/run/mysqld/mysqld.pid' とエラーが出ます。 解決方法が分からず困っています。どのように対処すれば良いでしょうか？ 教えてください。 宜しくお願いいたします。
運用中にWEBアプリの改修できるシステム設計(DB層)のお話です。 開発環境でDB改修後その内容をを(運用中)本番DBへ反映(デプロイ)したい場合、 どのような(設計)方法がありますでしょうか。 ご存知の方、宜しくお願いします。
標題の実行結果の見方について調べたのですが、結果の各行の内容を説明しているものが見つかりませんでした。 もし、標題の実行結果について説明しているサイトや書籍があれば、お教え頂けないでしょうか。 ※参考にしたサイト http://dev.mysql.com/doc/refman/5.6/en/show-engi … http://staffblog.yumemi.jp/mysql-show-engine-inn … 出力結果 ===================================== 150304 8:24:35 INNODB MONITOR OUTPUT ===================================== Per second averages calculated from the last 11 seconds ----------------- BACKGROUND THREAD ----------------- srv_master_thread loops: 15253 1_second, 15253 sleeps, 1392 10_second, 1358 background, 1358 flush srv_master_thread log flush and writes: 15272 ---------- SEMAPHORES ---------- OS WAIT ARRAY INFO: reservation count 2751, signal count 2750 Mutex spin waits 1332, rounds 39960, OS waits 1332 RW-shared spins 1419, rounds 42570, OS waits 1419 RW-excl spins 0, rounds 0, OS waits 0 Spin rounds per wait: 30.00 mutex, 30.00 RW-shared, 0.00 RW-excl ------------ TRANSACTIONS ------------ Trx id counter 23F0EA Purge done for trx's n:o < 23F0E3 undo n:o < 0 History list length 1513 LIST OF TRANSACTIONS FOR EACH SESSION: ---TRANSACTION 0, not started MySQL thread id 3022, OS thread handle 0x7f1d46b9f700, query id 218103 localhost root show engine innodb status -------- FILE I/O -------- I/O thread 0 state: waiting for completed aio requests (insert buffer thread) I/O thread 1 state: waiting for completed aio requests (log thread) I/O thread 2 state: waiting for completed aio requests (read thread) I/O thread 3 state: waiting for completed aio requests (read thread) I/O thread 4 state: waiting for completed aio requests (read thread) I/O thread 5 state: waiting for completed aio requests (read thread) I/O thread 6 state: waiting for completed aio requests (write thread) I/O thread 7 state: waiting for completed aio requests (write thread) I/O thread 8 state: waiting for completed aio requests (write thread) I/O thread 9 state: waiting for completed aio requests (write thread) Pending normal aio reads: 0 [0, 0, 0, 0] , aio writes: 0 [0, 0, 0, 0] , ibuf aio reads: 0, log i/o's: 0, sync i/o's: 0 Pending flushes (fsync) log: 0; buffer pool: 0 731 OS file reads, 28619 OS file writes, 11544 OS fsyncs 0.00 reads/s, 0 avg bytes/read, 0.00 writes/s, 0.00 fsyncs/s ------------------------------------- INSERT BUFFER AND ADAPTIVE HASH INDEX ------------------------------------- Ibuf: size 1, free list len 0, seg size 2, 0 merges merged operations: insert 0, delete mark 0, delete 0 discarded operations: insert 0, delete mark 0, delete 0 Hash table size 276707, node heap has 5 buffer(s) 0.00 hash searches/s, 0.00 non-hash searches/s --- LOG --- Log sequence number 118470215 Log flushed up to 118470215 Last checkpoint at 118470215 0 pending log writes, 0 pending chkp writes 8358 log i/o's done, 0.00 log i/o's/second ---------------------- BUFFER POOL AND MEMORY ---------------------- Total memory allocated 137363456; in additional pool allocated 0 Dictionary memory allocated 161090 Buffer pool size 8192 Free buffers 7224 Database pages 963 Old database pages 375 Modified db pages 0 Pending reads 0 Pending writes: LRU 0, flush list 0, single page 0 Pages made young 0, not young 0 0.00 youngs/s, 0.00 non-youngs/s Pages read 720, created 243, written 18604 0.00 reads/s, 0.00 creates/s, 0.00 writes/s No buffer pool page gets since the last printout Pages read ahead 0.00/s, evicted without access 0.00/s, Random read ahead 0.00/s LRU len: 963, unzip_LRU len: 0 I/O sum[0]:cur[0], unzip sum[0]:cur[0] -------------- ROW OPERATIONS -------------- 0 queries inside InnoDB, 0 queries in queue 1 read views open inside InnoDB Main thread process no. 8696, id 139763711444736, state: waiting for server activity Number of rows inserted 31935, updated 4850, deleted 834, read 1867566 0.00 inserts/s, 0.00 updates/s, 0.00 deletes/s, 0.00 reads/s ----------------------------
MySQLでの、ランキング表示について質問です。 select u1.s_id , s.s_name , sum(quantity) 売上数, (select count(*) 1 from (select sum(quantity) kei from u_data group by s_id) u2 where sum(u1.quantity) < u2.kei) ランキング from u_data u1 inner join syouhin_m s on u1.s_id = s.s_id group by u1.s_id , s.s_name order by 4; 上記のSQL文で　(where sum(u1.quantity) < u2.kei)　の部分が 良く分からないので、解説できる人はよろしくお願いします。 （実行もできるし、答えも合っています。）
MySQLでインサートするときに、ユニークキーを設定せずに重複データを避ける方法ってありますか？ 複数データを一気にインサートしているので、ユニークキーを設定するとその中の１個でも重複があると全部はじかれてしまいます。 現在は、 select cn from テーブル名 where cn in ('aaa,'bbb','ccc') ※cn：重複ないデータにしたいカラム名　 ※('aaa,'bbb','ccc')　実際に入れたいデータ といったんセレクトして、セレクトできなかったデータだけにして、 インサート(複数一気に）するといった流れでやっています。 これを１つの文とかで書けないのでしょうか？ not existというのを聞いたことがあるのですが、 色々検索しましたがよくわからなかったです。。。 よろしくおねがいします。
なかなかうまくいきません。 dataの平均を出してから順位を取得したいです。 アドバイスお願いします。 select 　　　id, 　　　avg(data1) avg, 　　　(select count(avg(data1)) avg 　　　 from score b where a.avg<b.avg)+1 as rank from score a group by id order by avg desc; ERROR 1111(HY000):Invalid use of group function
MysqlでWaiting for table lock　というエラーがでて困っています。 上記のエラーがでて特定のテーブルにアクセスする事ができません。 該当のエラーのIDをKILLしても、そのTableにアクセスが出来ません。 こちらのWaiting for table lockを解除する方法ご存知でしょうか？ よろしくお願い致します。
CentOS 5.11でwordpress4.0.1を動かす為にPHPバージョン5.5.20、MySQLサーバーバージョン5.5.41を入れましたが、wordpressの設定画面が開かず「お使いのサーバーの PHP では WordPress に必要な MySQL 拡張を利用できないようです。」と表示されて、どうしたら良いか判りません。 詳しい方、この様な場合はどの様に対処したら良いか教えて下さい。 宜しくお願い致します。
アンケート結果を集計する効率の良いシンプルなSQLを教えて下さい。 MySQLで、以下の状態です。 テーブル名：hoge カラム：id,kbn id...auto kbn...1～5 欲しい結果は、以下の状態です。 順位,kbn,count 1位,5,60ポイント 2位,3,45ポイント 2位,1,45ポイント 4位,4,30ポイント 5位,2,10ポイント ※位やポイントはプログラム側で付与するので不要です。 2位の様に同点の場合は同じ順位を表示し、3位を飛ばし順位を表示させたく思います。 どうぞ、よろしくお願い致します。
MySQLを使って管理画面を作っております。 $sql='INSERT INTO players(name,price,position_id) VALUES(?,?,?)'; という文で使ったidをコピーしてから次のINSERTの文でそのidの番号を使って別テーブルのカラムにその番号をINSERTするしくみを作りたいのですがなかなか上手くいきません。 var_dump($last_id);では番号がコピーされているのですが、INSERTができません。 いつもお世話になってしまい大変恐縮なのですが、どなたかご教授いただけないでしょうか？よろしくお願い致します。 <!DOCTYPE html> <html> <head> <meta charset="UTF-8"> <link rel="stylesheet" type="text/css" href="../../xxxxx/team.css"/> <title>選手追加完了</title> </head> <body> <div id="main"> <?php $pro_name=$_POST['name']; $pro_price=$_POST['price']; $pro_position_id=$_POST['position_id']; $pro_team=$_POST['team_name']; $pro_name=htmlspecialchars($pro_name); $pro_price=htmlspecialchars($pro_price); $pro_position_id=htmlspecialchars($pro_position_id); $pro_team=htmlspecialchars($pro_team); $dns = "mysql:host=localhost; dbname=player;charset=utf8"; $dns_id = "xxxxx"; $dns_pw = "xxxxxxx"; try { $conn = new PDO($dns, $dns_id, $dns_pw, array(PDO::ATTR_EMULATE_PREPARES => false)); } catch (Exception $e) { echo 'ERROR: ' . $e->getMessage(); die(); } try { //トランザクションを開始する。オートコミットがオフになる $conn->beginTransaction(); //処理その(1) $sql='INSERT INTO players(name,price,position_id) VALUES(?,?,?)'; $stmt=$conn->prepare($sql); $data[]=$pro_name; $data[]=$pro_price; $data[]=$pro_position_id; $stmt->execute($data); //直近id取得 $last_id_sql = "SELECT LAST_INSERT_ID() as id"; $stmt = $conn->prepare($last_id_sql); $stmt->execute(); $last_id = $stmt->fetch(PDO::FETCH_ASSOC); $stmt->closeCursor(); //確認var_dump($last_id); //処理その(2) $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); $sql2='INSERT INTO team(team_id,team_name) VALUES(?,?)'; $stmt=$conn->prepare($sql2); $data2[]=$pro_team; $data2[]=$last_id; $stmt->execute(array($last_id,$pro_team)); $stmt->closeCursor(); //確認var_dump($last_id); //変更をコミットする $conn->commit(); } catch(PDOException $e){ //変更をロールバックする $conn->rollBack(); echo 'ERROR:' . $e->getMessage(); } // 切断 $conn = null; print $pro_name; print'を追加しました。<br />'; ?> <a href="xxxxx">戻る</a> </div><!--main--> </body> </html>
f1、id、name、price の株価データがhistoryテーブルに入っています。 f1は発注番号です。「id,name=株券」は複数あるため、ひとつの株券だけを見ると発注番号はランダムになります。 SELECT * FROM (SELECT f1,id,name,price FROM history WHERE id = 2001 ORDER BY f1 DESC limit 0,10) as AA ORDER BY f1 ASC 上記のSQL文により、株ID=2001番の直近10回の売買価格(推移)を取得することが可能です。 f1 　　id 　　name 　　price 14585 2001 日本製粉　521 14595 2001 日本製粉　523 14607 2001 日本製粉　527 14684 2001 日本製粉　524 14705 2001 日本製粉　520 14771 2001 日本製粉　519 14795 2001 日本製粉　518 14800 2001 日本製粉　516 14804 2001 日本製粉　517 14882 2001 日本製粉　519 やりたいこと この直近の取引10回に関し、若い順に必ず0から9の番号を振る関数(下記の仮想カラムzeroを追加する)を作りたいと思っています。 f1 　　id 　　name 　　price　zero 14585 2001 日本製粉　521 　　0 14595 2001 日本製粉　523 　　1 14607 2001 日本製粉　527 　　2 14684 2001 日本製粉　524 　　3 14705 2001 日本製粉　520 　　4 14771 2001 日本製粉　519 　　5 14795 2001 日本製粉　518 　　6 14800 2001 日本製粉　516 　　7 14804 2001 日本製粉　517 　　8 14882 2001 日本製粉　519 　　9 株によっては10回未満の取引のものもあり、その場合はたとえば4回しか取引のない株の場合はzeroの値は0から3を振ることになります。 SELECT * FROM (SELECT f1,id,name,price FROM history WHERE id = 2001 ORDER BY f1 DESC limit 0,10) as AA ORDER BY f1 ASC を改良して作ろうとしましたがいいアイデアが浮かびません。 どなたか助けて頂けませんでしょうか? よろしくお願いいたします。
すみません、MySQLのSQL文で教えてください。 以下のSQL文を実行すると UPDATE overflag c, asinprice d SET d.priceCheckUS = TRUE WHERE c.asin=d.asin AND c.priceOverUS=0 LIMIT 1; ERROR 1221 (HY000): Incorrect usage of UPDATE and LIMIT というエラーが出力されます。 UPDATE asinprice d SET d.priceCheckUS = TRUE WHERE d.asin='111' OR d.asin='000' LIMIT 1; は実行できました。 複数テーブルだと実行できないように理解しましたが、何が問題か教えてください。 よろしくお願いします。
こんばんは ＰＨＰ+ＭｙＳＱＬで１月～12月までのテーブルがあるのですが 1行目から12月のデータを1行目から1月のデータを取得して 並べて表示したいのですが、どういうコードを書けばいいか すみませんが、教えてください。 お願いします。
今までの経緯は以下です： http://oshiete.goo.ne.jp/qa/8863196.html http://oshiete.goo.ne.jp/qa/8863915.html 実は、当該問題が消えました。 特段、対処はしていません。 その後、問題発生前と同様に使っていました。 そして先ほど、同問題が発生しました。 前回までの助言を参照し、データベース本体を発見しました。 C:>dir "C:\Program Files\MySQL\MySQL Server 5.0\data\XXX" /B db.opt dic.frm dic.MYD dic.MYI list.txt dic.MYDとdic.MYIの２つだと思われます。 そして、その両方が読み込み専用で無いことが分かりました。 もう殆ど諦めていますが、何か対処方法があってら教えて下さい。
select文の記述について質問させていただきます。 下記のデータベースのテーブルの先頭からnumberを条件として ２名分のデータをselect文にて抽出したいと思っております。 (numberが重複し、重複数も異なるデータとなります。） select文の記述をどのようにするか教えていただければと思っております。 よろしくお願いいたします。 データベースのテーブル +——+—————+—————+————+ | id | name | number | score | +——+—————+—————+————+ | 1 | tanaka | 358 | 98 | | 3 | tanaka | 358 | 23 | | 4 | tanaka | 358 | 45 | | 11 | yamada | 126 | 63 | | 17 | yamada | 126 | 77 | | 23 | suzuki | 274 | 36 | | 45 | suzuki | 274 | 16 | | 59 | suzuki | 274 | 89 | | 73 | suzuki | 274 | 75 | | 80 | hanako | 89 | 24 | | (以下続く) | +——+—————+—————+————+ 抽出結果 +——+—————+—————+————+ | id | name | number | score | +——+—————+—————+————+ | 1 | tanaka | 358 | 98 | | 3 | tanaka | 358 | 23 | | 4 | tanaka | 358 | 45 | | 11 | yamada | 126 | 63 | | 17 | yamada | 126 | 77 | +——+—————+—————+————+
Ruby on RailsのデータベースとしてMy SQLを使いたいと思っています。 ですが、現在持っている本ではインタフェースが変わっているのか上手くいかないので御教示をお願いします。 特にConnectorとかがよく分かりません。 そこで一からMySQLをインストールし直そうと思っています。 環境は、 ・Windows7　32ビット ・Rails 3.2.19 ・ruby 1.9.3p545 (2014-02-24) [i386-mingw32] となっております。 宜しくお願い致します！
windows７上のphpmyadmin(xamppについてくるもの）で、行を挿入しようとしたら、 Warning: #1366 Incorrect string value: '\xE3\x81\xAF\xE3\x81\x98...' for column 'note' at row 1 と言われてしまいまして、行を表示させてみると、マルチバイトのところが、?????と表示されてます。 これは、どうすれば対応できるのでしょうか？ よろしくお願い申し上げます。
質問した内容は以下にあります。 http://oshiete.goo.ne.jp/qa/8863196.html 先ほど、指示されたホームページに行ったら、以下の内容が表示されるようになっていました。 「Table '○○○' is read only」 4.パーミッションを660に chmod 5.オーナーをmysqldに chown 6.グループ権限をmysqldに 7.再起動 残念ながら、上記の4,5,6とも具体的な作業内容が分かりません。 詳しい方、解説をお願いします。
“ERROR 1206 (HY000): The total number of locks exceeds the lock table size”エラーが発生する場合の対処方法について教えてください。 /etc/my.cnfの“innodb_buffer_pool_size”を大きくするのが解決策ですので innodb_buffer_pool_size = 2G のように最大値に変更してみましたが、解決しませんでした。 一応、 max_connections も減らしてみましたが、解決しません。 PHPからMySQLにコネクションを接続し続けて切断するような処理はしていませんが、問題ありますでしょうか？（最初にmysql_connectで接続し、プログラムが終了するまで、何回もmysql_queryでSQL文(SELECTやUPDATE等)を実行しています。） 一概に言えませんが、データベースをバックアップでテキストで出力しても、300Mbyteくらいのデータですが、２Gのメモリを使うのでしょうか？ 物理メモリを増やして innodb_buffer_pool_size を増やすしか解決方法がないのかご教授頂きたいです。 （ロックするテーブルは同時に1個しかしていないです。） 詳細な内容は提示していないので、わかりにくいですが、ご指摘頂ければ提示します。 設定や状態確認や見ておくべき点などが提案ベースでも教えて頂ければ幸いです。 すいませんがよろしくお願いします。
このジャンルでお願いします。 例えば次のようなアカウント情報を格納するテーブルがあったとして CREATE TABLE user ( 　id int(11) NOT NULL AUTO_INCREMENT, 　name varchar(64), 　email varchar(64), 　password varchar(64), 　PRIMARY KEY(id) ); idカラム名を「id」か「user_id」にするか悩んでいます。 自分としては「id」のままで良いと思っているのですが、 参考書や他の方のやり方を見てると「user_id」のようにしてる方もいます。 「user_id」にすることによってSQL文を見た時にも何のidかすぐ分かるし、 USING句を使えるなどのメリットがあるのでたしかにこちらの方が良いかなぁとは思うのですが、 「user_id」にするなら統一性をもたせるために「name」も「user_name」にするのか、 「email」も「user_email」にするのか、などキリがないというか・・・ そういう理由もあって自分としては「id」のままなのですが、 みなさんはどちらのやり方をされているのでしょうか？
当方Macユーザです。 ターミナル（≒コマンドプロンプト）でスーパーユーザで作ったデータベースが、phpMyAdmin（以下Admin）で見られません。 Adminでは、pmaというユーザにすべての権限を与え、このユーザでデータベースを閲覧しています。 ターミナルにおいて、pmaでログインしてshow databases;をすると、該当のデータベース名が表示されているので、ターミナルでは見られるのですが…。 OpenPNEのメンバー管理をしたいので、ターミナル上では操作したくありません。どうかAdminでデータベースが見られるよう、お知恵をお貸しください。
このジャンルでお願いします。 次のようなテーブルで CREATE TABLE IF NOT EXISTS item ( id int(11) NOT NULL AUTO_INCREMENT, name varchar(32) NOT NULL, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO item (name) VALUES ('item1'); INSERT INTO item (name) VALUES ('item2'); INSERT INTO item (name) VALUES ('item3'); INSERT INTO item (name) VALUES ('item4'); INSERT INTO item (name) VALUES ('item5'); INSERT INTO item (name) VALUES ('item6'); CREATE TABLE IF NOT EXISTS treepath ( ancestor_id int(11) NOT NULL, descendant_id int(11) NOT NULL, FOREIGN KEY (ancestor_id) REFERENCES item(id) ON DELETE CASCADE ON UPDATE CASCADE, FOREIGN KEY (descendant_id) REFERENCES item(id) ON DELETE CASCADE ON UPDATE CASCADE, PRIMARY KEY(ancestor_id, descendant_id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO treepath (ancestor_id, descendant_id) VALUES (1, 1); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (1, 2); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (1, 3); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (1, 4); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (1, 5); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (1, 6); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (2, 2); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (2, 4); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (2, 5); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (2, 6); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (3, 3); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (4, 4); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (4, 6); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (5, 5); INSERT INTO treepath (ancestor_id, descendant_id) VALUES (6, 6); item1┬item2 　　　│　├item4 　　　│　│　　└item6 　　　│　└item5 　　　│ 　　　└item3 を item1┬item2 　　　│　│　　 　　　│　└item5 　　　│ 　　　└item3 　　　　　└item4 　　　　　　　└item6 のようにitem4以下のノードをitem3の下に移したいのですが、 その場合のtreepathテーブルの更新はどのようなSQL文にすれば良いのでしょうか？
AWSにあるデータベースをまるごと移行する場合、ローカルにエクスポートしないで移行できる方法があれば教えてください。 AWSは別アカウント、別インスタンスとなります。 よろしくお願いします。
一つのページから別々のテーブルにデータをINSERTしたいのですが、"id"と"number"は同じ値でそれぞれのテーブルにいれたいのですが、どうやってやるのでしょうか？ 下のPHPのコード(一部)でデータを流してみたのですが、このままやると、もしデータに不具合があって片方だけ登録されないことがあると、一方は登録されて、一方は登録されないという事態が発生してしまい、"id"が違う番号で登録されてしまう可能性があります。 id int(8) NOT NULL AUTO_INCREMENT で"id"は作りました！ $insertSQL1 = sprintf("INSERT INTO tbl1 (id, number, name, price) VALUES (%s, %s, %s, %s)", GetSQLValueString($_POST['id'], "int"), GetSQLValueString($_POST['number'], "text"), GetSQLValueString($_POST['name'], "text"), GetSQLValueString($_POST['price'], "int")); $insertSQL2 = sprintf("INSERT INTO tbl2 (id, number, ename, eprice, extra) VALUES (%s, %s, %s, %s, %s)", GetSQLValueString($_POST['id'], "int"), GetSQLValueString($_POST['number'], "text"), GetSQLValueString($_POST['ename'], "text"), GetSQLValueString($_POST['eprice'], "int"), GetSQLValueString($_POST['extra'], "text")); 別々のテーブルで共通のidを使う方法はないでしょうか？ phpMyAdminのSQLを使ってます。 回答よろしくおねがいします！
PHPMyAdminのSQLのコマンドで、 もしdata001がNullだったら、data001に"1"というデータをいれる。 もしdata001がNullじゃないかつdata002がNullだったら、data002に"1"というデータをいれる。 このようなSQLのコマンドはどうやって打つのでしょうか。 回答よろしくおねがいします！
SELECT (`総額` / `個数`) FROM tb_item で`総額`を`個数`で割った単価（のような）値が取得できるものとします。 このとき、この「計算で出た単価」と「10,000という値」を比較して大きいほうの値を返すクエリはどのように書くのでしょうか？ なんとなく、 SELECT MAX(`総額` / `個数`, 10000) FROM tb_item のような感じで取得できるような関数を探していますが、MAXだと列の中で最大値を取得してしまうので渡しが使いたい内容と違います。 サブクエリを使わずになるべく簡潔に書く方法を知りたいです。 どうぞよろしくお願い致します。
下記の質問をさせていただき、解決いたしましたが、それに関連して新たなご質問です。 http://oshiete.goo.ne.jp/qa/8830319.html 上記質問内容は、 以下のようなデータから、「結果」のような形でデータを取り出したいというもので、「いただいたご回答」の形で一旦解決しました。 usr テーブル +--------+------+ | usr_id | name | +--------+------+ | 1 | 太郎 | | 2 | 二郎 | | 3 | 花子 | +--------+------+ usr_trm テーブル +--------+--------+ | usr_id | trm_id | +--------+--------+ | 1 | 1 | | 1 | 3 | | 1 | 4 | | 2 | 1 | | 2 | 2 | | 2 | 3 | | 3 | 2 | +--------+--------+ cat テーブル +--------+------+ | cat_id | name | +--------+------+ | 1 | 性別 | | 2 | 部署 | +--------+------+ trm テーブル +--------+--------+------+ | trm_id | cat_id | name | +--------+--------+------+ | 1 | 1 | 男性 | | 2 | 1 | 女性 | | 3 | 2 | 総務 | | 4 | 2 | 経理 | +--------+--------+------+ 結果 +--------+------+------+------+ | usr_id | name | cat1 | cat2 | +--------+------+------+------+ | 1 | 太郎 | 1 | 3,4 | | 2 | 二郎 | 1,2 | 3 | | 3 | 花子 | 2 | 　 | +--------+------+----- +------+ いただいたご回答 select t1.usr_id,t3.name ,group_concat(if(cat_id=1,t1.trm_id,null)) as cat1 ,group_concat(if(cat_id=2,t1.trm_id,null)) as cat2 from usr_trm as t1 inner join trm as t2 on t1.trm_id=t2.trm_id inner join usr as t3 on t1.usr_id=t3.usr_id group by usr_id さらにそこから、例えば「総務に所属する人をランダムにn件」という形で絞り込もうと思い、 WHERE t2.trm_id=3 と ORDER BY RAND() LIMIT 10 を追加したところ、条件通り抽出はされるのですが、結果の「cat1」「cat2」に他のカテゴリーの値が入らなくなりました。 WHERE t2.trm_id=3 を消すと「cat1」と「cat2」に値が入ってきます。 「cat1」と「cat2」に全ての値が入った状態で絞込をするために、どのようにすればよいかわかりません。 アドバイスをいただけると幸いです。
MySQLを使用したホームページを運用しているのですが、このたびホスティングサーバーを変更する予定で、新しい移行先のホスティング側に、サイトデータ・SQLデータを移行しましたが、データベースを読み込む部分だけ文字化けして表示されてしまいました。 ※日本語だけすべて???で表示されてしまいます。 phpMyAdmin上で見ると、正常にデータベース内容の日本語は表示されています。 照合順序の文字コード変更などをぐぐって作業してみましたが、解決できません。 よろしくお願い致します。
下記のような２つのテーブルがあり、 仕入れテーブルから、2014/1/2にBさんが仕入れたデータを 削除したいのですが、SQLが分かりません。 どのようなSQLにすると実現することができるでしょうか。
以下のようなデータがあります。 このデータから最後の「結果」のような形でデータを取り出したい場合、どのようにすればよいでしょうか？ cat1とcat2を分けない形はgroup_concatを使ってできたのですが、カテゴリーごとに分けて取得したいです。 usr テーブル +--------+------+ | usr_id | name | +--------+------+ | 1 | 太郎 | | 2 | 二郎 | | 3 | 花子 | +--------+------+ usr_trm テーブル +--------+--------+ | usr_id | trm_id | +--------+--------+ | 1 | 1 | | 1 | 3 | | 1 | 4 | | 2 | 1 | | 2 | 2 | | 2 | 3 | | 3 | 2 | +--------+--------+ cat テーブル +--------+------+ | cat_id | name | +--------+------+ | 1 | 性別 | | 2 | 部署 | +--------+------+ trm テーブル +--------+--------+------+ | trm_id | cat_id | name | +--------+--------+------+ | 1 | 1 | 男性 | | 2 | 1 | 女性 | | 3 | 2 | 総務 | | 4 | 2 | 経理 | +--------+--------+------+ 結果 +--------+------+------+------+ | usr_id | name | cat1 | cat2 | +--------+------+------+------+ | 1 | 太郎 | 1 | 3,4 | | 2 | 二郎 | 1,2 | 3 | | 3 | 花子 | 2 | 　 | +--------+------+----- +------+
コマンドプロンプトで「SELECT * FROM testtable」などとやったときに、列数が多いと結果が行単位に改行されて見にくい。 改行させない方法ってありませんか？ あるいはコマンドプロンプト自体の幅を広げる方法とかありませんか？ この質問ここではマズかったかな？
お世話になります。 my ｓｑｌのテキスト欄ですが、以下のような文字化けになってしまいました。 ¤¦¤´¤¶¤¤¤Þ¤¹¡￡<br />¤è¤¤¤È¤³¤í... このような文字化けはどうやったら直るのでしょうか？ 日本語データーがすべてこのようになってしまいました。 ヒントのような事でも良いのでどうか回答の程よろしくお願い致します。
Mysqlのデータベースの中にhisotryテーブルを作成しています。 その中にはヒストリーIDと顧客IDとログの内容とタイムスタンプが入っています。 このテーブルから顧客ID毎の一番古いタイムスタンプを取得したいのですが、 どうすればよいのかわかりません。 よろしくお願いします。
phpMyAdminでテーブルをエクスポートして、違うテーブルにインポートしていれたいのですが、sqlファイルでエクスポートしようとすると、自動でWHEREの中身がid = "1234"とかになってしまって、勝手にidがひも付けされてしまいます。おそらくその原因はプライマリーキーだからなのでしょうが、WHEREの中身をdata1 = "23456"みたいにidではない違うカラムにひも付けすることはできるのでしょうか？　data1をプライマリーキーにしようとしてもできませんでした（重複してないはず。） 回答よろしくお願いします！
TableName = key_table ID, GroupID, Key(文字列型), Value(文字列型) 1, 1, 'start_date', '2014-11-05' 2, 1, 'end_date', '' 3, 2, 'start_date', '2014-11-05' 4, 2, 'end_date', '2014-12-05' 5, 3, 'start_date', '2014-4-05' 6, 3, 'end_date', '' start_dateが2014-11-05で、end_dateが''か未来にセットされているGroupID1とGroupID2を検索するSQLはどういう方法がありますでしょうか？ SELECT GroupID from key_table where (Name='start_date' AND Value = '2014-11-05') AND (Name='end_date' AND (Value = '' OR end_date > '2014-11-05') な感じでやってみようと思ったのですが、動作しません。 このテーブル構造でどうしても検索しないといけません。 以上、よろしくお願いします。
毎回お世話になっています。 今回も知恵を頂けたらありがたいです。よろしくお願い致します。 下記のようなプログラムを組んだところ、ページを開いたらすぐ全データがが出てくる状態になっています。ページを開いても何もデータが出てこない状態にして検索してからデータが出てくるようにするにはどのように書き換えれば良いのでしょうか？ <!DOCTYPE html> <html> <head> <meta charset="UTF-8"> <title>リーグデータ</title> <link rel="stylesheet" type="text/css" href="../common/style.css"/> </head> <?php error_reporting( E_ALL ^ E_NOTICE ); ?> <body id="list"> <div id="main"> <form name="search_form" action="player_list.php" method="post"> <input type="hidden" name="cmd" value="search" /> <table> <tr> <th class="th_top">選手名</th> <td class="td_top"> <input type="text" name="name" size="30" value="<?php echo $_POST['name'] ?>"> </td> </tr> <tr> <th>チーム名</th> <td> <input type="checkbox" name="team_id[]" value="1" <?php if (isset($_REQUEST['team_id']) and in_array('1',$_REQUEST['team_id'])) print 'checked'; ?>/> 名古屋 <input type="checkbox" name="team_id[]" value="2" <?php if (isset($_REQUEST['team_id']) and in_array('2',$_REQUEST['team_id'])) print 'checked'; ?>/> 徳島 <input type="checkbox" name="team_id[]" value="3" <?php if (isset($_REQUEST['team_id']) and in_array('3',$_REQUEST['team_id'])) print 'checked'; ?>/> 千葉 <input type="checkbox" name="team_id[]" value="4" <?php if (isset($_REQUEST['team_id']) and in_array('4',$_REQUEST['team_id'])) print 'checked'; ?>/> 浦和 <input type="checkbox" name="team_id[]" value="5" <?php if (isset($_REQUEST['team_id']) and in_array('5',$_REQUEST['team_id'])) print 'checked'; ?>/> 磐田<br /> </td> </tr> <tr> <th class="th_middle"> ポジション </th> <td class="td_middle"> FW MF DF GK </td> </tr> </table> <p> <input type="submit" value="検索"> <input type="reset" value="リセット"> </p> </form> <?php try { $dsn = 'mysql:dbname=xxxxx;host=localhost'; $user = 'xxxxx'; $password = 'xxxxxx'; $dbh = new PDO($dsn,$user,$password); $dbh->query('SET NAMES utf8'); $sql = 'SELECT code,name,team_name,price,position,gazou FROM mst_player_market WHERE 1'; $stmt = $dbh->prepare($sql); $stmt->execute(); $dbh = null; if(isset($_POST['name'])) { $name = htmlspecialchars($_POST['name']); print($name); } if(isset($_POST['name'])) { if(!$_POST['name']==true){print ''; }else{ $sqlN ='code IN (SELECT code FROM mst_player_market where name LIKE ("%'.$_POST['name'].'%"))'; $sql.=' and ('.$sqlN.')'; } } if(isset($_POST['team_id'])and is_array($_POST['team_id'])){ $ary = array_filter($_POST['team_id'], function($v) {return is_numeric($v);}); $sqlA = 'code IN (SELECT playerid FROM team WHERE team_id IN ('.implode(',', $ary).'))'; }else{ print ''; $sqlA = ' 1 '; $flag=false; } $sql.=' and ('.$sqlA.')'; if($flag) $sql.="AND 0 ";; //参考 print $sql."<br>"; //実行 $pdo = new PDO($dsn,$user,$password); $stmt = $pdo->prepare($sql); $stmt->execute(); //画像処理 $rows=array(); while($row = $stmt->fetch(PDO::FETCH_ASSOC)){ $rows[]=$row; }; //参考SQL文表示 print_r($rows); print'選手一覧<br /><br />'; print'</form>'; } catch(Exception $e) { print'ただいま障害により大変ご迷惑をお掛けしております。'; exit(); } ?> <?php foreach((array) $rows as $row ){ ?> <tr> <td><img src="../player/<?php print( htmlspecialchars( $row["gazou"], ENT_QUOTES )); ?>" /></td> <td><?php print( htmlspecialchars( $row["team_name"], ENT_QUOTES )); ?></td> <td>\<?php print( htmlspecialchars( number_format( $row["price"] ),ENT_QUOTES ) ); ?></td> <td> <?php print( htmlspecialchars( $row["name"], ENT_QUOTES ) ); ?> </td> <td> <?php print( htmlspecialchars( $row["position"], ENT_QUOTES ) ); ?> </td> </tr> <?php } ?> </table> </div> <!------------mainのdiv--------------> </body> </html>
phpMyAdminを使ってます。一つのデータベースに入ってる二つのテーブルを統合するため、機能でいうとFULL OUTER的なのがやりたいのですがphpMyAdminがそれをサポートしていないので、代わりにUNIONを使ってやろうと思ったら、二つのテーブルのカラムの数と型が同じでないとできないらしく、そこで止まってしまってるのですが、どうにかできるコードはないでしょうか？ もともとは日本語のデータベース（１）と英語のデータベース（２）で分けていたのですが、英語（２）では入れなくてもいいデータがたくさんあり、カラムの数が２倍くらい変わってしまっているので、今から英語（２）の方を無理矢理日本語（１）に合わせるとなるとなんかデータが変になりそうなのでそれはまだやってないんですが。←無理矢理合わせるのはどうにも方法がなくて最終手段としてやりたいです。 回答よろしくおねがいします。 何か抜けている点があったら言ってください！
VPSで色々とためしてみているのですが、どうもユーザーとか権限とかよく分かりません。 「Linux自体のユーザー」と「MySQLのユーザー」との間には何か関係はあるのでしょうか？ うまく言えませんが、例えば「MySQLのユーザー」は「Linux自体のユーザー」になってなければならない---なんてことです
PCに数年前に導入したMySQLのrootのパスワードを忘れてしまいました。 どこかに書いておいたはずなのですが、思い出せません。 rootのパスワードを調べる方法、または不明のまま新しいパイワードに変更する方法はあるでしょうか。
現在、レンタルしているサーバのPHPmyAdminにて、データベースを作成しました。 データベースのエンジンはMyISAMになっており、InnoDB型がいいため、 テーブルの作成時にInnoDB型に設定をしました。 すると、構造タブでみるとデータベース：MyISAM テーブル：InnoDB となっておりますが、テーブルはInnoDBとして扱われているという認識でいいのでしょうか。 勉強中のため、詳しい方がおりましたら、教えていただけると助かります。
SELECT ～ FOR UPDATEやSELECT ～ LOCK IN SHARE MODEという行ロックがあり、この件について解説しているサイトをいろいろ見ているのですが、振る舞いが複雑だということはわかりました。 しかしそもそもなぜSELECTで行ロックするのか、運用上でどんなときに使うのかを解説しているサイトは見当たりませんでした。 私は、SELECTするときは単に SELECT * FROM tb_a WHERE id = 1; としか記述していません。 質問1. なぜSELECTするのにトランザクションが必要なのでしょうか？運用上でどんなときにSELECTでトランザクションを使うのでしょうか？よく解説サイトには、 BEGIN; SELECT * FROM tb_a WHERE id = 1 FOR UPDATE; COMMIT; と書いています。SELECTするのに行をロックする必要性がいまいちわからないです。 質問2. トランザクションを開始したときにロックがかかるのではないのでしょうか？つまりBEGIN;でロックがかかるわけではないのですか？SELECTのクエリーにFOR UPDATEと書くということはこのSELECTのコードが実行された時点でロックがかかるのでしょうか？ 質問3. FOR UPDATEやLOCK IN SHARE MODEというのはSELECTにしか使えないのか、もしくはSELECTだから意味があるのでしょうか？UPDATEやDELETEは単にBEGINE;とCOMMIT;で囲えばいいだけですよね？ 質問4. 以下のようなコードを解説しているサイトがあります。 BEGIN; SELECT * FROM tb_a WHERE id = 1; COMMIT; SELECT文にはFOR UPDATEも書いていないのですが、これは何を意味するのでしょうか？つまり、SELECTするのになぜトランザクションを実行するのでしょうか？ 一番知りたいのは運用上どのような場合にSELECTでトランザクションを使って行ロックするのか、ということです。 どうぞよろしくお願い致します。
PHPで、以下のようなソースで、存在しているデータベースtestに接続し、もしない場合、name_listというテーブルを作り、1カラム目をカラム名がnoで、int型でnot null auto_incrementにして、2カラム目をカラム名がnameで、not nullで作りたいのですが、うまくテーブルが作られません。 どうすればうまく作られるか教えてください。 <?php try{ $pdo = new PDO('mysql:dbname=test; host=localhost; charset=utf8', 'root'); $st = $pdo->prepare("create table if not exists name_list (no int(100) not null auto_increment, name varchar(100) not null);"); $st->execute(); }catch(PDOException $e){ print('Error:'.$e->getMessage()); die(); }
独自ドメインを取得し、Wordpressサイトを開こうと考えておりますが、分からないことがたくさんある上、自分が何を知らないのかも知らないので難儀しております。 1. ドメインをGodaddyなどの会社から取得し、それをdreamhostなどのレンタルサーバーにアップロードしたWordpressに使うにはどうしたらいいのか？ 2. htaccessやアパッチなどの設定（gzipやキャッシュなど）など、HTMLやCSSなどのプログラミング言語ではない、重要なウェブサイト運営の知識 3. ページの表示速度を早くするために、gzipをOnにすべきか、bpsは十分かなどの設定可能なオプションと測定方法など 4. その他ここに挙がっていないけれど、wordpressサイトを運営する上で重要なこと を知識の漏れが内容に、体系的に学べられるサイトを探しております。 英語ができるので海外サイトでも結構です。 どなたかご助力ください。よろしくお願い申し上げます。
以下のようなPHPのソースとMySQLのテーブルで、numberが0の行をhtmlで取得しようとしているのですが、検索窓に0を入れて検索しても取得できません。ちなみに、numberが1や2の行は取得することができます。 なぜnumberが0の行を取得できないかと、どうすればnumberが0の行を取得することができるか教えてください。 <PHPのソース> <?php $url = "localhost"; $user = "root"; $pass = ""; $db = "test"; $html = ""; // MySQLへ接続する $link = mysql_connect($url,$user,$pass) or die("MySQLへの接続に失敗しました。"); // データベースを選択する $sdb = mysql_select_db($db,$link) or die("データベースの選択に失敗しました。"); // クエリを送信する $sql = "SELECT * FROM test"; $result = mysql_query($sql, $link) or die("クエリの送信に失敗しました。<br />SQL:".$sql); //結果セットの行数を取得する $rows = mysql_num_rows($result); ?> <form action="" method="post"> <input type="text" name="numberSearch" value=""> <input type="submit" value="検索"> </form> <?php //表示するデータを作成 if($rows && !empty($_POST['numberSearch'])){ while($row = mysql_fetch_array($result)) { if ($row["number"] == $_POST['numberSearch']) { $html .= "<tr>"; $html .= "<td>".$row["alphabet"]."</td><td>".$row["number"]."</td>"; $html .= "</tr>\n"; } } }else{ $msg = "データがありません。"; } // MySQLへの接続を閉じる mysql_close($link) or die("MySQL切断に失敗しました。"); ?> <html> <head> <meta charset="utf-8"> <title>numberSearch</title> </head> <body> <table width = "200" border = "0"> <tr bgcolor="##ccffcc"><td>alphabet</td><td>number</td></tr> <?= $html ?> </table> </body> </html> <データベースのテーブル> alphabet number A 0 B 1 C 2 D 1 E 1 F 0 G 1
下記のスクリプトで、MySQLサーバーのテーブルの中身を見ようとしたら、 返り値が空でした(行数0) ( クエリの実行時間 0.0010 秒 )　と表示されます。 どこが間違ってるのでしょうか。 ////////////////////// // データベース登録 // ////////////////////// $con = mysql_connect("mysql020.******", "*****", "*****"); // リモートのMySQLデータベースサーバーに接続する mysql_select_db("LAA0471050-ideamemo"); // データベースサーバーに存在する（myPHPAdminで作成済みの）データベースを選択する $sql = "SET NAMES utf8"; mysql_query($sql, $con); $sql = "INSERT INTO ideamemo_table (color, title, contents, create) VALUES ('$color', '$title', '$contents', '$create');"; mysql_query($sql, $con); mysql_close($con); ?>
現在、ブランドサイズをインターナショナルサイズに変換するデータベース設計をしていて悩んでいることがあります。どうか知恵をお貸しください。 参考にしています書籍は、ミック著「達人に学ぶDB設計徹底指南書」です。 書籍には、正規化の次数が低いほど検索SQLのパフォーマンスは良いですが、データ整合性は低く、正規化していくほどパフォーマンスが低下する代わりにデータ整合性が高くなります。と書いています。 ですので、正規化した結果、５つのテーブルが出来上がりました。 これらを正規化したテーブルを中間テーブルで扱うには、どのように設計すればよろしいでしょうか？ 以上、よろしくお願いします。 下記は、正規化したテーブルです。 テーブル名 ：： ブランド 扱うデータ ：： （仮）A、その他ブランド.... テーブル名 ：： 性別 扱うデータ ：： メンズ、レディース、ユニセックス テーブル名 ：： カテゴリー 扱うデータ ：： ウェアー、ボトム、シューズ、その他カテゴリー.... テーブル名 ：： ブランドサイズ 扱うデータ ：： 1、2、3、その他ブランドサイズ.... テーブル名 ：： インターナショナル・サイズ 扱うデータ ：： S、M、L、その他サイズ....
お世話になっております。 MySQLに保存している顧客データの処理について質問させてください。（MySQLとPHPでブラウザ経由でデータ管理をしています） 以下のようなテーブルがあり、顧客に対して配送するダイレクトメールの印刷をする流れのことです。 no　　name　　dm 1　　佐藤　　no 2　　吉田 3　　谷口 4　　伊藤 まず最初にこのテーブルにある顧客を一覧で表示させますが、名前と共にチェックボックスを設け、 noという値が入っているレコードはチェックを入れて一覧表示します。 一覧表示の後、印刷表示というボタンを押すと、印刷用レイアウトの画面に移動し、印刷を実行という流れです。 dmというカラムは印刷をするか否かのフラグであり、noと代入されているか顧客は印刷しないことを意味しますが、 印刷前の確認が出来るようにするためであり、また印刷対象の変更を同時に行えるようにしたいと、このような流れになってます。 そこで質問なのですが、単純に一覧から印刷用ページに移動させるだけなら問題はないのですが、このチェックボックスのチェック、チェックを外したり、チェックを入れたりと、服すのチェックを一度に行い、印刷用ページに移動(ポスト）したとき、チェックの入ったデータだけ印刷一覧に表示したいと考えてます。 このとき、変更があった顧客のdmカラムをアップデートしたいのですが、どのような仕組みが一番負荷が少なくて住むのでしょうか？ 現在の顧客数は1万5千件程度ですが、印刷用ページに移動した際、１つずつチェックをするのは非常に非効率ですし、かといって、元々チェックの入っていたデータと、印刷ページにポストしたとときのデータを共に違う配列に代入して・・・とも考えているのですが、効率のよい流れというものがなかなかイメージすることが出来ません。 お忙しいとは思いますが、お知恵を頂戴できれば幸いです。 宜しくお願いいたします。
「←追加」と追加したのですが、Warning: Invalid argument supplied for foreach()とエラーがでました。 調べたり、試行錯誤してみましたがダメでした。 何が間違っているのでしょうか？ try{ $dbh = new PDO($dsn, $user, $password); print('接続に成功しました。<br>'); $dbh->query('SET NAMES utf8'); $sql = ('SELECT song.number, song.song_title, artist.artist, ka2.artist as artist_2, ka3.artist as artist_3, ka4.artist as artist_4, ka5.artist as artist_5, ka6.artist as artist_6, ka7.artist as artist_7, ka8.artist as artist_8, ka9.artist as artist_9, ka10.artist as artist_10, ka11.artist as artist_11, ka12.artist as artist_12, sakushi.sakushi, ss2.sakushi as sakushi_2, ss3.sakushi as sakushi_3, ss4.sakushi as sakushi_4, sakkyoku.sakkyoku, sk2.sakkyoku as sakkyoku_2, sk3.sakkyoku as sakkyoku_3, sk4.sakkyoku as sakkyoku_4, hennkyoku.hennkyoku, hk2.hennkyoku as hennkyoku_2, hk3.hennkyoku as hennkyoku_3, hk4.hennkyoku as hennkyoku_4, genre, gr2.genre as genre_2,←追加 tie_up, part FROM (((((((((((((((((((((((((((( song LEFT JOIN artist ON song.artist_1 = artist.artist_ID) LEFT JOIN artist ka2 ON song.artist_2 = ka2.artist_ID) LEFT JOIN artist ka3 ON song.artist_3 = ka3.artist_ID) LEFT JOIN artist ka4 ON song.artist_4 = ka4.artist_ID) LEFT JOIN artist ka5 ON song.artist_5 = ka5.artist_ID) LEFT JOIN artist ka6 ON song.artist_6 = ka6.artist_ID) LEFT JOIN artist ka7 ON song.artist_7 = ka7.artist_ID) LEFT JOIN artist ka8 ON song.artist_8 = ka8.artist_ID) LEFT JOIN artist ka9 ON song.artist_9 = ka9.artist_ID) LEFT JOIN artist ka10 ON song.artist_10 = ka10.artist_ID) LEFT JOIN artist ka11 ON song.artist_11 = ka11.artist_ID) LEFT JOIN artist ka12 ON song.artist_12 = ka12.artist_ID) LEFT JOIN sakushi ON song.sakushi_1 = sakushi.sakushi_ID) LEFT JOIN sakushi ss2 ON song.sakushi_2 = ss2.sakushi_ID) LEFT JOIN sakushi ss3 ON song.sakushi_3 = ss3.sakushi_ID) LEFT JOIN sakushi ss4 ON song.sakushi_4 = ss4.sakushi_ID) LEFT JOIN sakkyoku ON song.sakkyoku_1 = sakkyoku.sakkyoku_ID) LEFT JOIN sakkyoku sk2 ON song.sakkyoku_2 = sk2.sakkyoku_ID) LEFT JOIN sakkyoku sk3 ON song.sakkyoku_3 = sk3.sakkyoku_ID) LEFT JOIN sakkyoku sk4 ON song.sakkyoku_4 = sk4.sakkyoku_ID) LEFT JOIN hennkyoku ON song.hennkyoku_1 = hennkyoku.hennkyoku_ID) LEFT JOIN hennkyoku hk2 ON song.hennkyoku_2 = hk2.hennkyoku_ID) LEFT JOIN hennkyoku hk3 ON song.hennkyoku_3 = hk3.hennkyoku_ID) LEFT JOIN hennkyoku hk4 ON song.hennkyoku_4 = hk4.hennkyoku_ID) LEFT JOIN genre ON song.genre_1 = genre.genre_ID) LEFT JOIN genre gr2 ON song.genre_2 = gr2.genre_ID)←追加 LEFT JOIN tie_up ON song.tie_up_1 = tie_up.tie_up_ID) LEFT JOIN part ON song.part_1 = part.part_ID) ;');
ユーザーと商品のテーブル（省略）、 商品ジャンルテーブル、 genre id　　 name 1　　　家電 2　　　3万円台 3　　　テレビ 4　　　黒 5　　　SONY 6　　　三菱 商品とジャンルのリレーションテーブル、 item_genre item_id genre_id 1　　　　1 1　　　　2 1　　　　3 2　　　　1 2　　　　3 2　　　　4 2　　　　6 ユーザーが希望する商品ジャンルのテーブル（ユーザーとジャンルのリレーションテーブル）、 user_genre user_id genre_id 1　　　　1 1　　　　3 2　　　　1 2　　　　3 2　　　　4 3　　　　1 3　　　　3 3　　　　4 3　　　　5 以上があるとします。 この時に商品側から（商品IDを元に）、その商品を希望しているユーザーIDを取得する場合の SQL文の作成方法のご教示をお願いいたします。 上記のテーブルの例ですと、アイテム1から取得したいユーザーIDは1、アイテム2からは ユーザーID 1と2を取得できればOKです。 商品が持つジャンルIDが1,2,3に対してユーザーが希望するジャンルIDが1,3のように少ない 場合は対象にふくまれますが、商品が持つジャンルIDが1,3に対してユーザーが希望する ジャンルIDが1,3,4のように多くなる場合は対象に含めません。 色々と考えてみたのですが、頭がこんがらがってしまい迷宮に迷い込んでしまいました。 すみませんがお知恵をお貸しください。よろしくお願いします。 ※DBサーバーがMySQLのため、MySQLで実現できる方法だとありがたいです。
最近、しょちゅうMYSQLが急に、停止しkillして再起動しておりますが、 その度に、以下のログが記載がありますが、具体的な対策などご存知でしたらご教示下さい。 現在、./ibdata1 は、./ibdata1 と./ibdata1.bak にしております。 InnoDB: Unable to lock ./ibdata1, error: 11 InnoDB: Check that you do not already have another mysqld process InnoDB: using the same InnoDB data or log files. InnoDB: Shutdown completed; log sequence number 0 100570041 [Note] /usr/libexec/mysqld: Shutdown complete mysqld ended InnoDB: Error in opening ./ibdata1 141007 22:41:19 InnoDB: Operating system error number 11 in a file operation. InnoDB: Error number 11 means 'Resource temporarily unavailable'. InnoDB: Some operating system error numbers are described at InnoDB: http://dev.mysql.com/doc/refman/5.0/en/operating … InnoDB: Could not open or create data files. InnoDB: If you tried to add new data files, and it failed here, InnoDB: you should now edit innodb_data_file_path in my.cnf back InnoDB: to what it was, and remove the new ibdata files InnoDB created InnoDB: in this failed attempt. InnoDB only wrote those files full of InnoDB: zeros, but did not yet use them in any way. But be careful: do not InnoDB: remove old data files which contain your precious data! 141007 22:41:19 [ERROR] Can't start server: Bind on TCP/IP port: Address already in use 141007 22:41:19 [ERROR] Do you already have another mysqld server running on por t: 3306 ? 141007 22:41:19 [ERROR] Aborting 141007 22:41:19 [Note] /usr/libexec/mysqld: Shutdown complete 141007 22:41:19 mysqld ended
データベースに入っている値を見るとAUTO_INCREMENTされているIDなどが列の削除に空き（2の次が10のような）が存在しております。INT(10)に設定されているため、保管数の限界が存在します。こういうのを整頓（2の次は3）しなおすことはできるのでしょうか。 無知ですいませんが、教えていただけませんでしょうか。 組み合わせは、PHP＋Mysqlです。
WindowsServerでPHPとMySQLで作成したプログラムを動かしています。 PHPからINSERTでMySQLに登録すると環境依存文字（「(株)・(有)など）が「？」になってしまいます。 PHPからSELECTでブラウザ上に表示させると文字化けはしていませんが、phpMyAdminで確認すると「？」になっています。 このデータベースの内容を他のサーバーに移すときに、phpMyAdminからエクスポートまたはmysqldumpすると「？」のままエクスポートして、他のサーバーでインポートしても当然「？」になってしまいます。 環境依存文字が文字化けしない、あるいは他のサーバーでも環境依存文字をそのまま移行できるようにはできないでしょうか。 よろしくお願いします。 PHPはEUC-JP、データベースはujisで作成しています。 INSERTの直前でSET NAMES UJISを実行しています。
MySQL5.6のストアドプロシージャが返すSELECT結果のフェッチ方法について教えてください。 delimiter $ create procedure sample_proc() begin select * from TEST_TBL; end$ の様なストアドプロシージャがあり、これを他のストアドプロシージャから呼び出して、 ループしながらフェッチしたいのですが、どうすればよいでしょうか。
mysql> mysql> show variables like 'character_set%'; +--------------------------+----------------------------+ | Variable_name | Value | +--------------------------+----------------------------+ | character_set_client | sjis | | character_set_connection | sjis | | character_set_database | sjis | | character_set_filesystem | binary | | character_set_results | sjis | | character_set_server | sjis | | character_set_system | utf8 | | character_sets_dir | /usr/share/mysql/charsets/ | +--------------------------+----------------------------+ 8 rows in set (0.00 sec) mysql> mysql> character_set_systemもsjisに変更したいと考えております。 どのようにすれば可能でしょうか？ やりたいことはmysqlworkbenchでselect文のクエリ内容を日本語表記することです。 ご存知の方、宜しくお願いします。
このジャンルでお願いします。 次のようなテーブルで DROP TABLE IF EXISTS item; CREATE TABLE IF NOT EXISTS item ( id int(11) NOT NULL AUTO_INCREMENT, parent_id INT, name varchar(32) NOT NULL, level int NOT NULL, FOREIGN KEY (parent_id) REFERENCES item(id) ON DELETE CASCADE ON UPDATE CASCADE, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO item (parent_id, name) VALUES (null, 'item1'); INSERT INTO item (parent_id, name) VALUES (1, 'item2'); INSERT INTO item (parent_id, name) VALUES (2, 'item3'); INSERT INTO item (parent_id, name) VALUES (3, 'item4'); INSERT INTO item (parent_id, name) VALUES (2, 'item5'); INSERT INTO item (parent_id, name) VALUES (null, 'item6'); INSERT INTO item (parent_id, name) VALUES (6, 'item7'); INSERT INTO item (parent_id, name) VALUES (null, 'item8'); DROP PROCEDURE IF EXISTS UPDATE_LEVEL; DELIMITER // CREATE PROCEDURE UPDATE_LEVEL() BEGIN DECLARE CNT INT; DECLARE LVL INT; SET LVL=1; UPDATE item SET level=0; UPDATE item SET level=LVL WHERE parent_id IS NULL; SELECT COUNT(*) INTO CNT FROM item WHERE level=LVL; WHILE CNT>0 DO UPDATE item INNER JOIN (SELECT id FROM item WHERE level=LVL) as temp ON parent_id=temp.id SET item.level=LVL+1; SET LVL=LVL+1; SELECT COUNT(*) INTO CNT FROM item WHERE level=LVL; END WHILE; END // DELIMITER ; DROP TRIGGER IF EXISTS TRG_INSERT_ITEM; DELIMITER // CREATE TRIGGER TRG_INSERT_ITEM AFTER INSERT ON item FOR EACH ROW BEGIN CALL UPDATE_LEVEL(); END; // DELIMITER ; itemテーブルにinsertした場合にトリガーでUPDATE_LEVEL()を実行するようにしているのですが、 実際に挿入すると、 ＞Can't update table 'item' in stored function/trigger because it is already used by statment which invoked this stored function/trigger . このようなエラーが出てしまいます・・・ UPDATE_LEVEL()にinsertらしき記述はないと思うのですが、 これはなぜこのようなエラーが出るのでしょうか？
お世話になっております。GROUP BY に関してつまずいています。 色々と調べているのですが、解決できないため質問させて下さい。 まず下記のような履歴テーブルがあります。 rireki_member_noとは投稿者のIDであり、title1、title2に登録された日付データ（date型）は その投稿者が投稿した日付が登録されています。（title1だけの場合もあればtitle2だけの場合もあり、両方の場合もあります） rirekiテーブル rireki_no　rireki_member_no　　title1　　　　　title2 　1　　　　　　　2　　　　　　　2014-09-12　 　2　　　　　　　1　　　　　　　　　　　　　　　　　2014-09-12 　3　　　　　　　3　　　　　　　2014-09-14 　　2014-09-14 　4　　　　　　　2　　　　　　　2014-09-18 　5　　　　　　　1　　　　　　　　　　　　　　　　　2014-09-19 また、下記は投稿者のテーブルであり、rireki_member_noと、member_noは紐付いたものとなります。 memberテーブル memner_no　　member_name 　1　　　　　　　佐藤 　2　　　　　　　吉田 　3　　　　　　　佐々木 そこで今回行いたいのは、タイトルを指定し、且つ日付を範囲指定した時、その会員の名前、そして投稿した日付を一覧で表示したいと考えていますが、その際のSQL文が分からず困っている状況です。 イメージ的には、 title2を指定し、2014-9-13から20149-19と範囲指定した場合 3　　佐々木　　2014-09-14 2　　吉田　　　2014-09-19 といった結果を求めたいと考えています。 お恥ずかしいとは思いますが、実は昨夜からずっと悩んでいたりして・・・ rirekiテーブル単体であれば、 http://norm-nois.com/blog/archives/1293 で似たような内容で紹介されているのですが、今回のようにJOINが絡むと難易度が高くなっている状況です。 お忙しいなか恐縮ですが、お知恵を頂戴出来れば幸いです。 宜しくお願い致します。
no type name ---------------------------- 1 1 peach 1 1 peach 2 5 tomato 4 6 apple 4 6 apple 1 1 peach 　上記のように、重複するレコード（行）が存在してしまっているテーブルで、重複をなくす処理を、SQLで簡単に行なうにはどうしたら良いでしょうか。MySQLです。上の例では、下のように更新したいのです。よろしくお願いします。 no type name ---------------------------- 1 1 peach 2 5 tomato 4 6 apple
応援しているサッカーチームの試合データをMySQLを利用しテーブルに格納したいと考えています。 そこでMySQLやPHPに詳しい方にお聞きしたいことがあります。 例えばA・Ｂ・Ｃと3チームあるとしたら、A対B、A対Cの試合データは格納しますが、B対Cのデータは不要です。あくまでもAチームに関するデータのみを格納し、私が開設しているサイトで閲覧者に検索フォームから自由な形でデータを参照できるようにしたいです。 参考までに格納したい試合のデータは下記のようなデータです。 http://www.j-league.or.jp/result/2014/j2/030201. … 現在、既に一定のデータはテーブルに格納しています。現在のテーブルの構造です。 https://www.dropbox.com/s/z2qc2zff2fn8m8f/gamedb … スタメンの選手やベンチの選手、交代選手、警告をもらった選手、得点者などはテーブルに格納していません。これらのデータは試合ごとに大きく数が異なるのでどのようにして格納すれば良いのか分からなかったので。 現在は格納していないこれらのデータを格納することで下記のような条件を指定しても対象データが羅列されるようにしたいです。 ・○○選手がイエローカードをもらった試合。 ・点を取られている選手ランキング。□□選手(※対戦相手の選手)には一番点を取られているなど。 ・○○選手がスタメンだった試合。 ・○○選手が途中出場した試合。 ・○○選手はこれまで△試合に▲分出場している。 ・□分～□分の間の得点は何点。逆に失点は何点など。 などなどです。 私が現在思いついている構造ですが、新しくテーブルを複数作成する。こういったケースではそれぞれのテーブルに共通のIDを振る必要があるとのことですが、これは日付（開催日）で代用しようと思っています。同じ日に2試合は絶対にないので。 作成するテーブルは下記のようにします。 ・ホームチームスタメンテーブル ・アウェーチームスタメンテーブル ・ホームチームの警告をもらった選手テーブル ・アウェーチームの警告をもらった選手テーブル ・ホームチーム得点者テーブル ・アウェーチーム得点者テーブル .....などなど。 こういったテーブルを作成し、それぞれID(開催日)と一定数のカラムを予め用意する。得点者のテーブルでしたら1試合で一方のチームが10点を取ることは限りなく0に近いのでとりあえず10用意する。同じように得点した時間も10用意。 datadating(開催日) | goal_1_min(得点時間) ｜goal_1（得点者） ｜ goal2_min(得点時間) | goal2(得点者) |.......... このように格納していけば思い通りの結果が得られるようになるのかな？と思っていますが、果たしてこのようなテーブルで作成していき、後々サイト側の検索フォームから指定した条件で無事に結果を得られるか不安です。 ちょっとしたことでも良いので、詳しい方の意見をお聞きしたいです。 どうぞよろしくお願いします。 長文失礼しました。
MySql初心者ですのでお手柔らかにお願いします。 最近MySqlにロックという機能があることを知りました。 同時にデータベースの操作がされると困る場合にロックするのだと思うのですが、そういうことって結構起こるのでしょうか? updateの場合、取得してから更新するまでラグがあるので問題が起こるのはイメージできるのですが、insertする時にも起こりえるのでしょうか? だとすればどんな操作でもロックはするに越したことはないように思えますが、オプションで用意されてるということは必要な場面とそうでない場面があるということなのでしょうか。 また、不具合が起こるのであれば自分で実際に試してみたいのですが、そもそも同時に操作を行うやり方がわかりません。 意図的に不具合を出しながらテストする方法があれば教えていただけないでしょうか。 よろしくお願いします。
hostingerというレンタルサーバーで MySQLデータベースを作成しphpMyAdminで接続したのですが 特権メニューが表示されておらず、ユーザーの追加が出来ませんでした。 rootでログインしようにも、 ログイン名[root] + データベース作成時設定したパスワードでは サーバーに接続できず ログイン名[root]　+パスワード無しでも接続出来ませんでした。
このジャンルでお願いします。 次のようなテーブルで CREATE TABLE IF NOT EXISTS user ( id int(11) NOT NULL AUTO_INCREMENT, name varchar(32) NOT NULL, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO user (name) VALUES ('user1'); INSERT INTO user (name) VALUES ('user2'); INSERT INTO user (name) VALUES ('user3'); CREATE TABLE IF NOT EXISTS item ( id int(11) NOT NULL AUTO_INCREMENT, parent_id INT, name varchar(32) NOT NULL, FOREIGN KEY (parent_id) REFERENCES item(id) ON DELETE CASCADE ON UPDATE CASCADE, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO item (parent_id, name) VALUES (null, 'item1'); INSERT INTO item (parent_id, name) VALUES (1, 'item2'); INSERT INTO item (parent_id, name) VALUES (2, 'item3'); INSERT INTO item (parent_id, name) VALUES (3, 'item4'); INSERT INTO item (parent_id, name) VALUES (2, 'item5'); INSERT INTO item (parent_id, name) VALUES (null, 'item6'); INSERT INTO item (parent_id, name) VALUES (6, 'item7'); INSERT INTO item (parent_id, name) VALUES (null, 'item8'); CREATE TABLE IF NOT EXISTS user_item ( id int(11) NOT NULL AUTO_INCREMENT, user_id INT, item_id INT, type varchar(16) NOT NULL, PRIMARY KEY(id), FOREIGN KEY (user_id) REFERENCES user(id) ON DELETE CASCADE ON UPDATE CASCADE, FOREIGN KEY (item_id) REFERENCES item(id) ON DELETE CASCADE ON UPDATE CASCADE ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO user_item (user_id, item_id, type) VALUES (1, 1, 'allow'); INSERT INTO user_item (user_id, item_id, type) VALUES (1, 3, 'deny'); INSERT INTO user_item (user_id, item_id, type) VALUES (1, 7, 'allow'); user_itemのuser_idが1のitemの行を取得したいのですが、 その条件として ・user_itemテーブルのtypeが'allow'のitem_id以下のitemの行 ・ただしtypeが'deny'のitem_id以下の行は除く この例だと、user_itemの INSERT INTO user_item (user_id, item_id, type) VALUES (1, 1, 'allow'); の行によってitemテーブルの INSERT INTO item (parent_id, name) VALUES (null, 'item1'); INSERT INTO item (parent_id, name) VALUES (1, 'item2'); INSERT INTO item (parent_id, name) VALUES (2, 'item3'); INSERT INTO item (parent_id, name) VALUES (3, 'item4'); INSERT INTO item (parent_id, name) VALUES (2, 'item5'); が取得候補になりますが、 INSERT INTO user_item (user_id, item_id, type) VALUES (1, 3, 'deny'); によって INSERT INTO item (parent_id, name) VALUES (2, 'item3'); INSERT INTO item (parent_id, name) VALUES (3, 'item4'); の行は除かれ、 INSERT INTO item (parent_id, name) VALUES (null, 'item1'); INSERT INTO item (parent_id, name) VALUES (1, 'item2'); INSERT INTO item (parent_id, name) VALUES (2, 'item5'); の行が取得されます。 つまりitemテーブルにおいて上の階層の直近の（user_itemと結合して取得した）typeが 'allow'である場合のみ取得したいのです。 INSERT INTO item (parent_id, name) VALUES (null, 'item1');←取得 INSERT INTO item (parent_id, name) VALUES (1, 'item2');←取得 INSERT INTO item (parent_id, name) VALUES (2, 'item3'); INSERT INTO item (parent_id, name) VALUES (3, 'item4'); INSERT INTO item (parent_id, name) VALUES (2, 'item5');←取得 INSERT INTO item (parent_id, name) VALUES (null, 'item6'); INSERT INTO item (parent_id, name) VALUES (6, 'item7');←取得 INSERT INTO item (parent_id, name) VALUES (null, 'item8'); 複雑ではありますが、これはどのようなSQL文にすれば良いのでしょうか？
以下のようにDBに登録されています。 id　date　cost 129　1404313200　6000 76　1404313200　5000 129　1404226800　4000 54　1404226800　75000 129　1404226800　55000 日付はUNIX TIMEです。 各IDの、最新日のcostを抽出したいのですが、どのようにすればいいでしょうか。 上記だと 76　1404313200　5000 54　14042268007　5000 129　1404313200　6000 が抽出される方法を知りたいです。 （ID129のdateが1404313200で一番大きい＝最新） よろしくお願い致します。
エックスサーバーを借りているのですが、FILE権限がありませんでした。 GRANTで権限を付与しようとしてもエラーとなり付与できませんでした。 OUTFILEでCSVファイルを出力できないのですが、レンタルサーバーでデータベースをファイルで入出力するには一般的にどのような方法でやるのでしょうか？ dumpではなく、Webサービスを利用するユーザーにデータベースのデータをcsvファイルとして出力したいのです。 どうぞよろしくお願い致します。
このジャンルでお願いします。 次のようなテーブルで CREATE TABLE IF NOT EXISTS user ( id int(11) NOT NULL AUTO_INCREMENT, name varchar(32) NOT NULL, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO user (name) VALUES ('user1'); INSERT INTO user (name) VALUES ('user2'); INSERT INTO user (name) VALUES ('user3'); CREATE TABLE IF NOT EXISTS item ( id int(11) NOT NULL AUTO_INCREMENT, name varchar(32) NOT NULL, PRIMARY KEY(id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO item (name) VALUES ('item1'); INSERT INTO item (name) VALUES ('item2'); INSERT INTO item (name) VALUES ('item3'); CREATE TABLE IF NOT EXISTS user_item ( id int(11) NOT NULL AUTO_INCREMENT, user_id INT, item_id INT, PRIMARY KEY(id), FOREIGN KEY (item_id) REFERENCES user(id) ON DELETE CASCADE ON UPDATE CASCADE, FOREIGN KEY (user_id) REFERENCES item(id) ON DELETE CASCADE ON UPDATE CASCADE ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO user_item (user_id, item_id) VALUES (1, 1); INSERT INTO user_item (user_id, item_id) VALUES (2, 1); INSERT INTO user_item (user_id, item_id) VALUES (3, 2); INSERT INTO user_item (user_id, item_id) VALUES (1, 2); INSERT INTO user_item (user_id, item_id) VALUES (1, 3); INSERT INTO user_item (user_id, item_id) VALUES (3, 3); user_itemテーブルでのselectで、 user_idが1で一番最初に挿入された行だけ を取得したいのですが、どのようなSQL文にすれば良いのでしょうか？ この例なら INSERT INTO user_item (user_id, item_id) VALUES (1, 1);←取得 INSERT INTO user_item (user_id, item_id) VALUES (2, 1); INSERT INTO user_item (user_id, item_id) VALUES (3, 2); INSERT INTO user_item (user_id, item_id) VALUES (1, 2);←user_id=3が最初に挿入されているので取得しない INSERT INTO user_item (user_id, item_id) VALUES (1, 3);←取得 INSERT INTO user_item (user_id, item_id) VALUES (3, 3);
テーブルtb1が以下のようになっているとします id, region, station1, station2, station3, station4, station5 0, 東京, 池袋駅, 渋谷駅, null, 新宿駅, null 1, 横浜, null, 横浜駅, 戸塚駅, 菊名駅, 反町駅 2, 大阪, 梅田駅, 天満駅, 野田駅, null, null このようなテーブルを、以下のような結果として取得するSELECT文はどのようになるのでしょうか？ 0, 東京, 0, 東京, 池袋駅 0, 東京, 渋谷駅 0, 東京, 新宿駅 1, 横浜, 1, 横浜, 横浜駅 1, 横浜, 戸塚駅 1, 横浜, 菊名駅 1, 横浜, 反町駅 2, 大阪, 2, 大阪, 大阪駅 2, 大阪, 梅田駅 2, 大阪, 野田駅 複数の列を行にするのがわかりません。 そもそも、tb1の設計が良くないのですが、これは変えられないと先方に言われました。 どうぞよろしくお願い致します。
おせわになります。助けてください。 id | nendo | sdate | edate 0 | 2012 | 2012-04-01 | 2013-03-31 1 | 2013 | 2013-04-01 | 2014-03-31 2 | 2014 | 2014-04-01 | 2015-03-31 2 | 2015 | 2015-04-01 | 2016-03-31 といったデーターベースがあります。 2014/03/31 という日付がどの年度の日付なのかを 調べるＳＱＬをどう書けばいいのかわかりません。 SELECT * FROM m_nendo WHERE sdate <= '2014/03/31' and edate >'2014/03/31' といった書き方をしているのですが、思う結果を取れません。 ネットでどういう言葉で検索したらいいのかも・・・わかりません。 書き方をご存知の方、教えて頂けませんか？ よろしくお願いします。
Mysqlの検索用のインデックスの書き方を調べているのですが、なかなか見つかりません。 テーブル、customersを作成して、その中に、項目として、 `email` varchar(100) default NULL を定義した場合、 インデックスの付与として、 KEY `idx_customers_email` (`email`) と書いた場合と、 FULLTEXTインデックスの付与として FULLTEXT KEY `email` (`email`) と書いた場合、何が違うのでしょうか？ また、このあたりの詳しい説明が載っているサイトとかあれば是非教えてください。
お世話になります。 DB初心者です。 現在とある中規模の掲示板システムを設計しています。 データベースを利用する事での利点をお聞きしたいです。 お恥ずかしながら、当方あまりデータベースを利用した事がなく これまで掲示板等のログは全てテキストファイル形式で利用してきました。 従って、データベースの技術的な知見も乏しい事から、今回データベースを 利用するにあたっては、そのメリットを最大限に活かせる事が 出来ないのではないかと不安に考えています。 （逆にシステム高負荷になったり…） そこで、データベースを利用する事で、何がどうメリットがあるのか もしくはデメリット等、教えて頂けませんでしょうか？ よろしくお願いします。
MySQL 5.5で、mysqlコマンドからSQLを流したときと、PHPから同じSQLを発行したときで結果が違うのです。 どうも日付のパースが関係しているようで、「2014-08-19」と書くとどちらも同じ結果になるのに、 「2014-8-19」と書くとPHPでは1行も返ってこなくなります。 再現例： ================== CREATE TABLE t (day date NOT NULL) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; INSERT INTO t (day) VALUES ('2014-08-19'); SELECT * FROM t WHERE day = '2014-8-19'; +------------+ | day | +------------+ | 2014-08-19 | +------------+ 1 row in set (0.00 sec) ↑同じSELECTをPHPから発行すると1行も返ってこない。 ================== mysqldとmysqlは5.5.30。 phpinfo()のmysqlのセクションでは Client API version 5.5.30 と出ています。 show variablesで見るとdate_formatはどちらも%Y-%m-%dになっています。 他にどこを確認すればいいでしょうか？
いつもお世話になっております。いろいろSQL文の本を読んだのですがわからないので今回もよろしく お願い致します。 SELECT DISTINCT * FROM bukken WHERE (id IN (SELECT fid FROM fudou_kodawari WHERE kid IN (1,4))) というSQL文があるのですが、これだと1,4が1つでも含まれるリストが出てくるのですが1,4が完全に一致しないと出てこないようにするにはどのようにSQL文を変更すれば良いのでしょうか？ 何卒よろしくお願い致します。
いまサーバーで管理している情報をすべて英語に翻訳してデータベースに登録するにはどういう方法があるのでしょうか？ Google Translateを使ってすべてのデータを英語にすることはできたのですが、変換されたあとそのデータをどうやってデータベースにいれてあげればいいかで止まってます。 回答よろしくおねがいします！
現在MySQLを学習しているんですが、ちょっとわからない問題が出てきまして質問させていただきます。 トリガーの問題なんですが、 各種テーブルに対して更新処理（追加、削除、更新）した場合、その処理を実施した時間、ユーザー名、テーブル名、処理内容を別のテーブルに自動保存する って内容なんですが、ここのテーブル名、処理内容の自動保存の構文がびっくりするくらい分かりません。。。。。 結構調べたのですが、なかなかヒットしないので質問させて下さい（涙） お願い致します（涙）
最近MySQLをちょこちょこ触っているものですが、ふとした疑問にぶち当たりました。 もし、ご存じの方がいらっしゃいましたらご教授頂けないでしょうか？ 質問 AというMySQLマスターServer BというMySQLスレーブServer があり、お互いにレプリケーションの関係を築いております。 ここに、突然 全く別のデータが入っている CというMySQLマスターServerの受け皿としてBをスレーブに出来ますでしょうか？ つまり、B(MySQLスレーブServer)はAのスレーブでもあり、Cのスレーブでもある。 ということが出来るのでしょうか？ （出来る、出来ないで結構です、やり方などのご教授はいりません。） MySQLにお詳しい方いらっしゃいましたらアドバイス頂けないでしょうか？ よろしくお願い致します。
お世話になります。 店舗販売、通販を始めて約7年程が経ちました。 少しずつではありますが固定客も増えつつあります。 しかし、弊社は現在のいくつかの問題を抱えています。 下記は、弊社が抱えている問題です。 店舗と通販の在庫が合わず棚卸しの際に、残業が続いてます。 店舗と通販の共通ポイント化がされていません。 顧客ランクの管理。 売上集計がデーターベースとの連携が取れていません。 解決策としてO2O（オーツーオー）を取り入れようと思い製品の説明会に何度も足を運びましたが弊社に合う製品がありませんでした。 結果、店舗と通販の製品を一元管理できるように自社開発することになりました。 ここからが本題なのです。データーベース設計する際、店舗と通販は別々のテーブルを作成する必要があるのでしょうか？ 以上、宜しくお願い致します。
mysqlのバックアップを検索したところ、データベースがオンライン(稼働中)の場合、mysqlhotcopyやmysqldumpを使ってのバックアップで、オフラインの場合は、/var/lib/mysql/*のディレクトリコピーをするといったサイトが多いのですが、オンライン中(稼働中)に/var/lib/mysql/*のディレクトリコピーをするのは問題があるのでしょうか。 単純にディレクトリコピーをしてしまえば、リストアの時も簡単な気がするのですが、オンライン中にディレクトリをコピーしたら、壊れるとかありますか。 よろしくお願いします。
Excelで以下のような表をデータベースにした場合についてお伺いします。 【Excel表】-------------------------------------- 購入日　, 店舗, 商品名１　, 商品名２, 商品名３ 2014/4/1, Ａ店, ボールペン, ノート　, えんぴつ 2014/4/2, Ｂ店, ハンカチ　, 洋服　　, くつした ------------------------------------------------- まず第一正規形は以下のようになると思います。 【第一正規形】----------------------------------- 購入日　, 店舗, 商品名 2014/4/1, Ａ店, ボールペン 2014/4/1, Ａ店, ノート 2014/4/1, Ａ店, えんぴつ 2014/4/2, Ｂ店, ハンカチ 2014/4/2, Ｂ店, 洋服 2014/4/2, Ｂ店, くつした ------------------------------------------------- 第二正規形は以下のように重複している部分を別のテーブルにします。 【第二正規形】----------------------------------- tb_purchase 購入日　, 店舗コード, 商品名 2014/4/1, 1 　　　　, ボールペン 2014/4/1, 1 　　　　, ノート 2014/4/1, 1 　　　　, えんぴつ 2014/4/2, 2 　　　　, ハンカチ 2014/4/2, 2 　　　　, 洋服 2014/4/2, 2 　　　　, くつした tb_shop 店舗コード, 店舗 1 　　　　, Ａ店 2 　　　　, Ｂ店 ------------------------------------------------- 質問１． ここで疑問に思ったのですが、このようにtb_shopの「店舗コード」は実際にはどのようにして作成するのでしょうか？ tb_shopには重複しない「店舗コード」が必要ですが、それにはAUTO_INCREMENTを使うのが一般的なのでしょうか？ 質問２． 実際の挿入時のクエリーは以下のような感じで良いのですか？ １．「2014/4/3にＡ店で消しゴムを買った」というデータを挿入する場合 　1. tb_shopで店舗カラムが「Ａ店」となる店舗コードを取得 　2. tb_purchaseに「2014/4/3, 1, 消しゴム」を挿入 　こんな感じでしょうか？ ２．「2014/4/3にＣ店で牛乳を買った」というデータを挿入する場合（1～4はそれぞれ一つのクエリーです）、 　1. tb_shopで店舗カラムが「Ｃ店」となる店舗コードを取得 　2. Ｃ店が存在しないのでtb_shopに挿入 　3. 挿入後に「Ｃ店」となる店舗コードを取得 　4. tb_purchaseに「2014/4/3, 3, 牛乳」を挿入 　なんか手間が増えますが、1～3はそれぞれ別々のクエリーでやらないとダメでしょうか？ 質問３． あと質問ですが、このままだとtb_purchaseは主キーがないので、購入idのようなカラムは必要ですよね？ 主に聞きたい内容は上記の「店舗コード」なる、テーブルとテーブルを繋ぐコードのようなものは どのように作るのが一般的で同時挿入でも重複しないコードを作れるか？という点です。 自前でたとえば「S001, S002, …」というようなコードを作ったら、同時挿入で問題が出ますよね？ 初心者的な質問ですみませんが、どうぞよろしくお願い致します。
受注金額や発注金額をDBから読み込み、税抜および税込の金額を算出するプログラムを作成しています。 税込金額を算出する際は金額+floor(金額*税率)の式を用いているのですが、 消費税分が整数になる場合、floor計算後に金額が1足らなくなることがあります。 桁上がりしない程度の数を足せばいいと言われたのですが、税率8%計算でギリギリ繰り上がらない0.039を足しても、2500万前後で誤差が発生してしまいます。 扱う金額は現在DBにある中では最大で4000万を越えます。 どうにか誤差が発生しないようにできないでしょうか？
CentOS6.4にpdo_mysqlが入ってなかったので、ダウンロードして展開までしたのですが、 cd PDO_MYSQL-1.0.2 で展開先のディレクトリに入って、 $ ./configure --with-pdo-mysql=shared,/usr/local/mysql を実行しようとすると、configureがないと言われてしまいます。 configureを実行するには何がしかのソフトをインストールする必要があるのでしょうか？ 情報いただけたらと思います。
複数のテーブルをleft joinで繋いで、カラムをエクセルのようなシートとしてWebで表示しています。 各カラムは、VERCHAR、DECIMAL、INT（SMALLINT～MIDIUMINT）の型を持っています。 エクセルのシートのような感じなので、エクセルのオートフィルタのような機能を付けたいと考えています。 各カラムをAND条件で指定できるやつです。 ですが、そもそもカラムの数が30ほどあります。 このような場合でもANDやBETWEENを使ってひたすらWHERE条件やCASEなどで抽出するようにするのでしょうか？ DECIMALやINTの場合は条件を○○（最低値）～○○（最高値）のようにします。 VARCHARの場合は、選べる文字列が複数（数十程度）あり、そこから選べるようにします。 例えば、東京駅。渋谷駅、新宿駅、品川駅、横浜駅・・・などがあって、フィルターしたい文字列だけ選びます。 たぶんINを使った感じになります。 聞きたいのは、WHERE　○○　AND　○○　AND　○○　AND　・・・のようにひたすら条件を作っていくしかないのでしょうか？ どうぞよろしくお願い致します。
PHPでMySQLテーブルロックされている一覧を取得したいですがどのようにすれば良いかご教授願います。 Web検索で調べるとロック状態はmysql_list_processesや、show processlistでも試してみましたが、思うような結果は得られませんでした。正常には動作していますが、欲しいデータが取り出せないですす。。。 単純に、現在ロックしているテーブル名（レコードロックは不要です。）を一覧で出力させることはできないのでしょうか？ PHPから実施できるやり方をご教授頂けると幸いです。 -------Test Program()--------- <?php $link = mysql_connect('localhost', 'login_id', 'login_pass'); mysql_select_db('db_name'); mysql_query('LOCK TABLES table1 WRITE'); mysql_query('INSERT INTO table1 SET field1 = "test", field2 = "1"'); //$result = mysql_list_processes($link);　以下のSQL文とも入れ替えて試しました。 $result = mysql_query('show processlist'); while ($row = mysql_fetch_assoc($result)){ printf("%s %s %s %s %s %s %s %s\n", $row["Id"], $row["User"], $row["Host"], $row["db"], $row["Command"], $row["Time"] , $row["State"], $row["Info"]); } mysql_free_result($result); mysql_query('UNLOCK TABLES'); ?>
phpMyAdminをロリポップで使っていて、データベースに入ってる３つの情報（140ほどの行があります）だけを３００列分それぞれ変えたいのですが、SQLから直接変えてたのでは日がくれてしまいます。↓こんな感じ UPDATE items SET data1='2014-07-17', data2='9800', data3='-2.9' WHERE data4=5663; ↑これを３００個それぞれ書く。 なのでExcelのファイルを直接読み込むことができるような機能があれば教えていただくて質問させていただきました！ よろしくおねがいします！
MySQLでSQLを書いている初心者です。 ある会社には卸売部門と小売部門があり、同一の商品を扱っています。 それぞれの売上明細は　tbl_sales と tbl_retailsales で別になっています。 商品別の2つの部門の売上数量を１行で表現したいと考えています。 下のような感じです。 商品ID　商品名　卸売　小売 ========================= 00001　　aaaa　　100　　10　　 00002　　bbbb　　200　　13　　 00003　　cccc　　300　　15　　 2つのSQLをUNIONでつなげてみましたが同一行に「卸売」「小売」が並んでくれません。 SELECT goodsId, goodsName, sum(quantity) FROM tbl_sales WHERE salesDate BETWEEN '2014-06-01' AND '2014-06-30' GROUP BY goodsId UNION SELECT goodsId, goodsName, sum(quantity) FROM tbl_retailsales WHERE retailSalesDate BETWEEN '2014-06-01' AND '2014-06-30' GROUP BY goodsId どのようにSQLを組み立てたらいいでしょうか。 教えて下さい。 よろしくお願いいたします。
お世話になります。 以前質問させていただいたのですがごちゃごちゃになってしまったので項目など見直してもっと単純な作りにしたいと思います。 MySQLを使ったWEBアプリを作っているのですが、特にこだわりのcheckboxと地域のcheckboxで分けてフォームからPHPのプログラムで受けて展開させる方法がわかりません。 どなたかご教授いただけたらと思っております。 テーブルに関しては賛否両論ですが、まずは３つでやってみたいと思います。 １つのほうが簡単そうなのですが、せっかく作ったので。 SQL文の間違いなのはわかっているのですがどうしてもわかりません。 何卒よろしくお願い致します。 下記のようなフォームにしたいと思っております。 <h1>マンション物件の条件検索</h1> <form name="search_form" action="mansion.php" method="post" > <input type="hidden" name="cmd" value="search" /> <table> <tr> <th>価格帯</th> <td> <select name="price_min"> <option value="1" selected="selected">下限なし</option> <option value="10000000">1000万</option> <option value="15000000">1500万</option> 略 </select> ～ <select name="price_max"> <option value="999999999999" selected="selected">上限なし</option> <option value="10000000">1000万</option> 略 </select> </td> </tr> <tr> <th>愛知県 - 名古屋市</th> <td> <td> <input type="checkbox" name="chiiki_id[]" value="1" <?php if( $_REQUEST["chiiki_id"] == "1" ){ print( 'checked' ); } ?>/> 中村区 <input type="checkbox" name="chiiki_id[]" value="2" <?php if( $_REQUEST["chiiki_id"] == "2" ){ print( 'checked' ); } ?>/> 西区 略 </tr> <tr> <th>愛知県 - その他の地域</th> <td> <input type="checkbox" name="chiiki_id[]" value="1" <?php if( $_REQUEST["chiiki_id"] == "1" ){ print( 'checked' ); } ?>/> 尾張 <input type="checkbox" name="chiiki_id[]" value="2" <?php if( $_REQUEST["chiiki_id"] == "2" ){ print( 'checked' ); } ?>/> 三河 </td> </tr> <th>こだわり条件</th> <td> <input type="checkbox" name="kid[]" value="1" <?php if( $_REQUEST["kid"] == "1" ){ print( 'checked' ); } ?>/> 新築 <input type="checkbox" name="kid[]" value="2" <?php if( $_REQUEST["kid"] == "2" ){ print( 'checked' ); } ?>/> 南向き <input type="checkbox" name="kid[]" value="3" <?php if( $_REQUEST["kid"] == "3" ){ print( 'checked' ); } ?>/> セキュリティ充実 </td> </tr> </table> <input type="submit" value="検索" class="Btn-gray button"> </form> <p></p> <?php //初期設定 //username,$password,$dbnameは適当に if( $_REQUEST["cmd"] == "search" ){ $dsn = 'mysql:host=localhost;dbname=fudousan'; $username = 'xxxxx'; $password = 'xxxxxxx'; $data=array(); $sql = "SELECT t1.* FROM bukken as t1 "; $flag=true; //kid絞り込み if(isset($_REQUEST["kid"]) and is_array($_REQUEST["kid"])){ $sql.="INNER JOIN (SELECT DISTINCT fid FROM fdou_kodawari WHERE kid in ("; $sql.=implode(",",array_fill(0,count($_REQUEST["kid"]), '?')); $sql.=")) as t2 ON t1.id=t2.fid "; $data=array_merge($data,$_REQUEST["kid"]); $flag=false; } //WHERE句作成 $sql.= "WHERE 1 "; //名古屋の地域checkbox $sql = "SELECT t1.* FROM bukken as t1 "; if(isset($_REQUEST["chiiki_id"]) and is_array($_REQUEST["chiiki_id"])){ $sql.="INNER JOIN (SELECT DISTINCT chiid FROM chiiki WHERE chiiki_id in ("; $sql.=implode(",",array_fill(0,count($_REQUEST["chiiki_id"]), '?')); $sql.=")) as t2 ON t1.id=t2.chiid "; $data=array_merge($data,$_REQUEST["chiiki_id"]); $flag=false; } //WHERE句作成 $sql.= "WHERE 1 "; //価格絞り込み if(isset($_REQUEST["price_min"]) and $_REQUEST["price_min"]!==""){ $price_min=str_replace(",","",$_REQUEST["price_min"]); }else{ $price_min=0; } if(isset($_REQUEST["price_max"]) and $_REQUEST["price_max"]!==""){ $price_max=str_replace(",","",$_REQUEST["price_max"]); }else{ $price_max=100000000; } if(isset($_REQUEST["price_min"]) or isset($_REQUEST["price_max"])){ $sql.="AND price_min BETWEEN ? AND ? "; array_push($data,$price_min,$price_max); $flag=false; } //実行 $pdo = new PDO($dsn,$username,$password); $stmt = $pdo->prepare($sql); $stmt->execute($data); $rows=array( 以下省略 使っている３つのテーブルです。 bukken id、 bukken_name、 address 、price_min、 price_max、 station 1 名駅MID 愛知県名古屋市中村区 40770000、 55100000 名古屋駅 2 プレサン浄心 愛知県名古屋市西区 30800000、 40001000 浄心駅 3 アネシア八事 愛知県名古屋市昭和区50000000、 62510000 八事日赤 4 アメニ港明 愛知県名古屋市港区 25000000、 35000000 港区役所駅 5 ユーハウ上飯田 愛知県名古屋市北区 32000000、 43330000 上飯田駅 6 ローレル葵 愛知県名古屋市東区 30000000、 46000000 高岳駅 7 ライオンズ上小田井 愛知県名古屋市西区 35000000、 55000000 上小田井駅 8 ポレスターセントラル名西 愛知県名古屋市西区 28000000、 38000000 浄心駅 chiikiテーブル chiid chiiki_id 1 1 2 2 3 3 4 4 5 15 6 6 7 2 fudou_kodawariテーブル fid kid 1 1 1 2 1 3
いつも大変お世話になっております、ありがとうございます。 データベースについての質問です。 大変初歩的な質問ですが何卒よろしくお願い致します。 不動産物件の絞り込み検索システムを作成したいのですが、テーブルの作成方法がわかりません。 不動産の条件検索フォーム 物件種別　　チェックボックス　　３種類 価格帯　　　プルダウン 所在地　　　チェックボックス 最寄り駅　　テキスト 間取り　　　チェックボックス　　　　４種類 こだわり条件　　チェックボックス　　１６種類 とする場合、データベース内でいくつテーブルを作成すればしっくりくるのでしょうか？ どうかよろしくお願い致します。
ｍｙｓｑｌの参照の負荷の問題解決はスレーブが有効だがｍｙｓｑｌの登録・更新の負荷の問題解決は何が有効なのでしょうか
こんにちわ カートを作っていてつまづいたのでお力かしていただきたいです。 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitio … <html xmlns="http://www.w3.org/1999/xhtml"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> <title></title> </head> <body> <?php try{ require_once('../common/common.php'); $post=sanitize($_POST); $pro_name=$post['name']; $pro_namecode=$post['namecode']; $pro_kg=$post['kg']; $pro_price=$post['price']; $pro_gazou_name=$_POST['gazou_name']; $pro_gazou_name2=$_POST['gazou_name2']; $dsn='mysql:dbname=LAA******-******;host=mysql***.phy.lolipop.lan'; $user='LAA******'; $password='********'; $dbh=new PDO($dsn,$user,$password); $pdo=new PDO("mysql:host=mysq***.phy.lolipop.lan;dbname=LAA*****-*******;charset=utf8",'LAA*****','********←パスワード'); $pdo->setAttribute(PDO::ATTR_ERRMODE,PDO::ERRMODE_EXCEPTION); 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 $sql='INSERT INTO mst_product(namecode,name,kg,price,gazou,gazou2) VALUES(?,?,?,?,?,?)'; $stmt=$dbh->prepare($sql); $data[]=$pro_namecode; $data[]=$pro_name; $data[]=$pro_kg; $data[]=$pro_price; $data[]=$pro_gazou_name; $data[]=$pro_gazou_name2; $stmt->execute($data); $dbh=null; print$pro_name; print'を追加しました。<br/>'; } catch(Exception $e) { print'ただいま障害により大変ご迷惑をおかけします。<br/>'; exit(); } ?> <a href="pro_list.php">戻る</a> </body> </html> 一応エラーもでないで最後のprint$pro_name;print'を追加しました。<br/>'; までいくんですがデータベースを見ても商品は追加されていません。 エラーもでないで最後まで行くということは一応接続は出来ているということ なんでしょうか？ どうしたらきちんと商品登録でしますか？ レンタルサーバーはロりポップです。 必要かは分からないんですが phpバージョンは５．３ データベースバージョン５．６ よろしくおねがいします。
独学でPHPを勉強しています。 一つ分からない事があったので詳しい方にお聞きしたいです。 DATE型同士で日数を算出し、日数が短い順番に並べたいと思っています。 テーブルは下記のようにしました。 テーブル名：office name(VARCHAR型)｜in(DATE型)｜out(DATE型) 佐藤｜2010-11-10｜2010-12-13 田中｜2010-10-30｜2012-01-30 水谷｜2009-09-20｜2011-03-20 上記のテーブルでいうと次のようなランキングにしたいです。 佐藤　33日 田中　1年92日 水谷　1年197日 このようにDATE型同士で日数を算出する場合、どのようなSQL文になるでしょうか？ ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
以下のような形でDBに登録されています。 iddatecost 12914043132006000 7614043132005000 12914042268004000 54140422680075000 129140431320055000 id 129のものをすべて抽出したいのですが、もしdateが同じだった場合は、同じdateの中でのcostの最大値の行だけ抽出したいです。 このようなことは可能でしょうか。 上記の例でいうと、 12914042268004000 129140431320055000 が取得できればOKです。 あまりmySQLは詳しくないのでselect文でそのまま頂けると嬉しいです。 よろしくお願い致します。
3ヶ月の集計結果を、QWERTYのPKとかぶらないものだけインサートします。 ただし、PKとかぶったものの中でも、QWERTYのCNT1が0のレコードについては、 QWERTYのCNT1のみ集計結果をアップデートしようとしています。 しかし、「~」部分の「ON DUPLICATE KEY UPDATE・・・」を挿入した際に、 エラー(ERROR 1111 (HY000): Invalid use of group function)となってしまいます。 ＜SQL文＞ INSERT IGNORE INTO QWERTY( PHOGE, J, MHOGE, SHOGE, CNT1, CNT2, CNT3, NDATE, YMO ) select TEST.PHOGE, TEST.J, 'ABCD', TEST.SHOGE, sum(TEST.m1cnt) AS M1, sum(TEST.m2cnt) AS M2, sum(TEST.m3cnt) AS M3, '2014-07-01' , TEST.YMO from ( select PHOGE, J, SHOGE, SUM(OD_CNT) AS m1cnt, 0 AS m2cnt, 0 AS m3cnt, YMO from HUJIKO WHERE CARD = '1' AND (KHOGE = '1' OR KHOGE = '9') AND (ODATE LIKE'2014-07%') group by PHOGE, J, YMO UNION select PHOGE, J, SHOGE, 0 AS m1cnt, SUM(OD_CNT) AS m2cnt, 0 AS m3cnt, YMO from HUJIKO WHERE CARD = '1' AND (KHOGE = '1' OR KHOGE = '9') AND (ODATE LIKE'2014-08%') group by PHOGE, J, YMO UNION select PHOGE, J, SHOGE, 0 AS m1cnt, 0 AS m3cnt, SUM(OD_CNT) AS m3cnt, YMO from HUJIKO WHERE CARD = '1' AND (KHOGE = '1' OR KHOGE = '9') AND (ODATE LIKE'2014-09%') group by PHOGE, J, YMO ) AS TEST GROUP BY TEST.PHOGE, TEST.YMO, TEST.J ON DUPLICATE KEY UPDATE CNT1=if(CNT1=0, TEST.M1 , CNT1); ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 「ON DUPLICATE KEY UPDATE 」で実現不可能であれば、 他の方法を取りたいのですが、 なるべく一つのSQL文で実現可能な方法をとりたいと考えています。 ご教示の程よろしくお願いいたします。
MySQLのカラム名に日本語を使うか、英数字を使うかで迷っています。英数が無難だと思うのですが、日本語の方が簡潔で分かりやすい命名ができるので、もし大した問題が無ければ日本語を使おうと考えています。 そこで3点お伺いしたく存じます。 1. 日本の企業はMySQLのカラム名に日本語を使っているケースが多いのか、それとも英数字のみのケースが多いのか、最近の傾向をご教示頂けますか。統計は無いと思いますので、体感や自社ルールの場合等でも結構です。 2. 日本語を使うことでセキュリティホールができることは考えられますか。例えば、マルチバイト文字はSQLインジェクション対策をすり抜ける・・・等。 3. 自分なら日本語と英数字のどちらを使うか。理由も添えて頂けると幸いです。 当方の開発環境は、PHP(ver. 5.5.9) + MySQL(ver. 5.6.16)です。 お手数おかけしますが、ご教示お願い致します。
PHPとMySQLでデータサイトを作成しています。 詳しい方に二点ほどお聞きしたいのですが。 テーブルは下記の通りです。データベース名はgame。 フィールドについて「issue」は結果。「h_a」はホームかビジターか。「h_score」はホーム側スコア。「a_score」はビジター側スコア。「opponent」は対戦相手です。 テーブル名：game issue(VARCHAR型)｜h_a(VARCHAR型)｜h_score(INT型)｜a_score(INT型)｜opponent(VARCHAR型) ●｜H｜8｜9｜チームB ○｜A｜2｜8｜チームC ●｜H｜4｜9｜チームD ○｜Ａ｜3｜3｜チームB 一点目。 格納したデータから自分のチームのスコアが多い順に10ほど並べたいと思っています。 問題はホームゲーム時（H）の場合はホーム側スコア（h_score）、ビジター（Ａ）の時はビジター側スコア（a_score）を適用することです。 現在は下記のようなコードしか記述していません。 $stmt = $dbh -> query("SELECT * FROM game ORDER BY () DESC LIMIT 10"); 二点目。 対戦相手ごとに勝率を計算し、勝率が高い順から10ほど並べることは可能でしょうか？ 勝率は「勝った試合数÷（勝った試合数+負けた試合数）*100」で計算。 上のデータでいうと、下記の順番です。 1 勝率100％　チームC 2 勝率50％　チームB 3 勝率0％　チームD こちらは不可能でしたら構いません。 ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
申し訳ございませんが質問させてください。 風俗サイトのスケジュールを組み込んで欲しいとお客様に頼まれています。 当方PHP/Mysqlは初心者で、本やネットで勉強中ですが、お手上げ状態です。 本日日付｜明日の日付｜明後日の日付｜・・・ と1週間の、スケジュール表示をしたいので、テーブル(id,In_time,In_time1,In_time2,out_time,out_time1,out_time2...)values(:id, :In_time, :In_time1, :In_time2, :out_time, :out_time1, :out_time2... )で作成して…とここで思考が止まってしまいます。 例えば日付はphpで出力？　mysqlに格納して 出力? そもそも日付はSQL？PHP?どちらで取得するものなのか？ どうやって朝5時に日付と時間を自動で更新するのかが、まったくわかりません。 お手数ではありますが、誰かご教授いただける人がいたら教えてください。 皆様お忙しいとは思いますが宜しくお願い致します。
MysqlにURLを登録したあと、それをXMLで落として、使用したいと考えています。 MysqlにURLを登録する場合、テーブルに項目名を「hpurl」と設けたとして、データ型・照合順序はどうすればいいのでしょうか。 （入力はDBに直接、手入力、またはCSVからインポートする予定です） データ型は「varchar(255)」・照合順序は「ascii_general_ci」でいいのでしょうか。 また、そのほか留意することがあるでしょうか。 ご教示いただきたく宜しくお願い致します。
COUNTによる集計と同時に、パーセンテージを求めたいのですが、どのようにSQLを書けばよいのでしょうか？(MySQL4.1) たとえば、 テーブル名：test、レコード数：100件、カラム数: 2 date product 2014-05-01 メガネ 2014-05-01 鉛筆 2014-05-02 メガネ 2014-05-03 メガネ 2014-05-05 鉛筆 ・・・ ・・ ・ 2014-06-30 鉛筆 ・ ・ という2014年5月1日～6月30日のデータを、 select DATE_FORMAT(date, '%Y-%m'), product, count(product) from test group by product, DATE_FORMAT(date, '%Y-%m'); とすると、以下のようにグループ（月、製品）毎に個数が表示されると思います。 2014-05　メガネ 30 2014-05　鉛筆　20 2014-06　メガネ 15 2014-06　鉛筆　35 それを次のように月別の割合（パーセント）を求めるにはどのようにSQLを書けばよいのでしょうか？ 2014-05　メガネ 30　60% 2014-05　鉛筆　20 40% 2014-06　メガネ 15 30% 2014-06　鉛筆　35 70% 一見、インラインビューでできそうだったのですが、月別にする段階でできなくなりました。 (月別にせずデータ全体に対してならインラインビューでパーセンテージが求められると思います。)
店舗の毎日の売り上げを、日付・販売員名・売り上げ額のテーブルで集計しています。 【テーブル例1】 date, name, price 2014-05-01,吉田,2400 2014-05-01,佐藤,1500 2014-05-02,佐藤,3000 ...(中略)... 2014-06-18,佐藤,3000 2014-06-30,吉田,1000 これを月別、販売員別の金額で次のように集計したいのですが、 【例2】 各販売員がその月に売り上げた金額の合計 2014-5 吉田　205000 2014-5 佐藤　120000 2014-6 吉田　75000 2014-6 佐藤　90000 SELECT文における"GROUP BY"の条件を、"GROUP BY date AND name"のように"AND"でつなげてもうまくいきませんでした。 もちろん、条件をひとつだけにした"GROUP BY date"　および　"GROUP BY name"では、それぞれ日付別の集計、あるいは販売員名別の集計が出ます。 【質問】 1.GROUP BYは複数の条件をつけることができないのでしょうか？ 2.どのようにすれば【例2】の集計ができますか？
<th>物件種別</th> <td> <input type="checkbox" name="kid[]" value="1" <?php if( $_REQUEST["kid"] == "1" ){ print( 'checked' ); } ?>/> 温泉 <input type="checkbox" name="kid[]" value="2" <?php if( $_REQUEST["kid"] == "2" ){ print( 'checked' ); } ?>/> キャンペーン <input type="checkbox" name="kid[]" value="3" <?php if( $_REQUEST["kid"] == "3" ){ print( 'checked' ); } ?>/> イベント <input type="checkbox" name="kid[]" value="4" <?php if( $_REQUEST["kid"] == "4" ){ print( 'checked' ); } ?>/> 特別室<br /> <input type="checkbox" name="kid[]" value="5" <?php if( $_REQUEST["kid"] == "5" ){ print( 'checked' ); } ?>/> 和室 <input type="checkbox" name="kid[]" value="6" <?php if( $_REQUEST["kid"] == "6" ){ print( 'checked' ); } ?>/> 喫煙室</td> </tr> <tr> //まずこのSQL文でt_hotelsのテーブルとt_hotel_kodawariを結合します $sql="SELECT t_hotels.id,t_hotels.hotel_name,t_hotels.price,t_hotels.address,t_hotel_kodawari.id,t_hotel_kodawari.kid FROM t_hotels JOIN t_hotel_kodawari USING(id) WHERE 1 "; テーブル t_hotel_kodawari id kid ------------ 1 1 1 2 1 4 2 1 2 5 3 2 4 3 4 6 5 2 5 3 6 1 7 2 テーブルt_hotels id hotel_name price address ----------------------------------------------------- 1 Aホテル 10000 栃木県・・・ 2 Bホテル 12000 栃木県・・・ 3 Cホテル 9000 千葉県・・・ 4 Dホテル 10000 千葉県・・・ 5 Eホテル 15000 愛知県・・・ 6 Fホテル 30000 東京都・・・ 7 Gホテル 40000 神奈川県・・・ テーブルt_hotels とt_hotel_kodawariをJOIN USINで結合して表示 id hotel_name price address id kid ------------------------------------------------------------------- 1 Aホテル 10000 栃木県・・・ 1 1 1 Aホテル 10000 栃木県・・・ 1 2 1 Aホテル 10000 栃木県・・・ 1 4 2 Bホテル12000 栃木県・・・ 2 1 2 Bホテル12000 栃木県・・・ 2 5 3 Cホテル 9000 千葉県・・・ 3 2 4 Dホテル 10000 千葉県・・・ 4 3 4 Dホテル 10000 千葉県・・・ 4 6 5 Eホテル 15000 愛知県・・・ 5 2 5 Eホテル 15000 愛知県・・・ 5 3 6 Fホテル 30000 東京都・・・ 6 1 7 Gホテル40000 神奈川県 7 2 $condition = array(); //仮にkid１が一つ選択されたら まず if( !empty( $_POST["kid"] )){ for($i=0; $i<count($_REQUEST["kid"]); $i++) { $tmpKey = "kid".$i; $sql .= " and kid = :".$tmpKey; $condition[$tmpKey] = $_REQUEST["kid"][$i]; var_dump($sql); } } で絞り込まれSQL文が作られ、 var_dump($sql);でSQL文を表示させると string(184) "SELECT t_hotels.id,t_hotels.hotel_name,t_hotels.price,t_hotels.address,t_hotel_kodawari.id,t_hotel_kodawari.kid FROM t_hotels JOIN t_hotel_kodawari USING(id) WHERE 1 and kid = :kid0" の結果によって、 kid１を選択するとホテルA,B,Fが表示されます。 でkidがまずandで絞り込まれます。 ですが、もう二つ目選択すると string(184) "SELECT t_hotels.id,t_hotels.hotel_name,t_hotels.price,t_hotels.address,t_hotel_kodawari.id,t_hotel_kodawari.kid FROM t_hotels JOIN t_hotel_kodawari USING(id) WHERE 1 and kid = :kid0" string(200) "SELECT t_hotels.id,t_hotels.hotel_name,t_hotels.price,t_hotels.address,t_hotel_kodawari.id,t_hotel_kodawari.kid FROM t_hotels JOIN t_hotel_kodawari USING(id)「 WHERE 1 and kid = :kid0 and kid = :kid1"」 で ------------------------------------------- 二重にand で絞られてしまい何も出てきません。希望としては二回目の選択からkidはor条件にすれば仮にkid1,kid2ホテルA,B,C,E,F,Gと両方を含む表示を実現したいのですが、 実際はSQLの表記の方法をネットや本で調べたのですが、分からない状態です。ご教授いただけたらと思います。 なお、私の希望通りの方法ではなくても実現できれば大丈夫です。 どうかよろしくお願い致します。
こんにちは。SQLでNOT INが実行速度が遅いため、EXISTSで書き直したいのですが、思っている結果がでません。 SQLのどこが間違っているかお教え頂けませんでしょうか？ ■ ・テーブル名：R_TABLE ・フィールド:id データ： id(ユニークではない) 001 002 003 003 003 007 008 009 ■ ・テーブル名：P_Master ・フィールド:id データ： id(ユニーク) 001 002 003 ■やりたい事 R_TABLEのデータを条件によって削除したい。 条件はP_MASTERに無いR_TABLEの行を削除したいです。 ■欲しい結果 R_TABLE 001 002 003 003 003 ■書いたSQL DELETE FROM R_TABLE WHERE R_TABLE.id NOT IN (SELECT R_TABLE.id FROM R_TABLE INNER JOIN P_MASTER ON R_TABLE.id = P_MASTER.id) これは正しい結果がでました。 書きなおしたSQL DELETE FROM R_TABLE WHERE R_TABLE.id WHERE NOT EXISTS (SELECT R_TABLE.id FROM R_TABLE INNER JOIN P_MASTER ON R_TABLE.id = P_MASTER.id) 結果はR_TABLEから何も消されていませんでした。 どこを修正すれば正しい結果が得られるでしょうか？ 副問い合わせで、R_TABLEとP_MASTERのINNER JOINの結果が得られ、R_TABLEからINNER JOINに含まれないデータ削除しろという命令だと思っていたのですが違うみたいです。 どこを修正すればよろしいでしょうか？ よろしくお願いします。
phpmyadminでデータベースを作成しているのですが、外部キーを相互に参照し合っているテーブルがあります。 一方のテーブルにデータを入れようとすると、参照先の外部キーにそのデータはありません、とエラーが出るし、もう一方のテーブルにデータを入れようとしても同じエラーが出ます。 調べたところ、遅延制約というのがあるようですが、それをphpmyadminで設定する方法が分かりません。 sql文を直接入力するしかないのでしょうか。 設定の方法や、他の方法をご存知の方はぜひご教授ください。
「WP+さくらインターネット」の組み合わせでホームページをすでに５年も展開していました。 Wordpressのバージョンが古く、そのためデータベースのバージョンアップを求められ様々なサイトを参考にしてMy SQLを4から5にバージョンアップを挑戦しました。 いろいろサイトを確認して慎重に作業を行い、UTF-8にてPHPMｙAdminへログイン。 「構造」欄の「DROP TABLEを追加」と「IF NOT EXISTSを追加」にチェックを入れデータベースのエクスポート。 terapadというテキストエディタにて上から20行目あたりにあるCREATE DATABASEの前に--を入れました。 その後、旧データベースを削除。 そして新しいデータベースを作成。 PHPMyAdminに再度ログインし、新しいデータベースを選択。「操作」タブにて「照合順序」をutf8_generalciに変更し、sqlファイルをインポートしたところ 「#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--CREATE DATABASE `sankei-kouki`' at line 4 」と出てきました。 なぜだ？なぜだ？と再度さまざまなサイトをみながら対応策を調べてみました。 再度テラパッドにてsqlファイルを確認すると下記のものです。ちなみに「〇〇〇〇」は私のＨＰにあった任意の文字列です。 -- phpMyAdmin SQL Dump -- version 2.11.11.3 -- http://www.phpmyadmin.net -- -- 繝帙せ繝・ mysql68.db.sakura.ne.jp -- 逕滓・譎る俣: 2014 蟷エ 6 譛・18 譌・ 10:58 -- 繧オ繝シ繝舌・繝舌・繧ク繝ァ繝ウ: 4.0.27 -- PHP 縺ョ繝舌・繧ク繝ァ繝ウ: 5.3.22 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */; /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */; /*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */; /*!40101 SET NAMES utf8 */; -- -- 繝・・繧ソ繝吶・繧ケ: `〇〇〇〇` -- --CREATE DATABASE `〇〇〇〇`; --USE 〇〇〇〇; いくつかの参考サイトにあった「文字化け」というのは、このことを言っていたのかもしれません。 注意していたのはインポート後の「文字化けをしないように」という事で、ここでは文字化けを気にせず「CREATE DATABASE」と「USE」の前に--を入れる事だけに集中していました。 すでに旧データベースは削除済み。もう私のホームページはすべてが終わってしまったのでしょうか？ 助けてください（大泣）。
エクセルで作ったような単純な縦横型のリレーショナル構造だとして、各列の一番大きな値を赤文字にしたいと思っています。 このとき、 (1)1回のクエリで全体を取得し、連想配列などにいれて各列をソートして1番大きな値を探す (2)必要な回数分、適したクエリを投げて、結果を変数に格納し、IDなどで一致させる という二通りのやり方を考えたのですが、どちらが一般的でしょうか。 (1)の場合は、DBに負荷がかからなくていいのかなと思いますが、多彩なフィルタやソートを使わずに、DBを使う意味があるんだろうかと考えてしまいます。 (2)の場合、列数が多いと、たとえば今回は5列分の結果を取得しようと思っていますが、1ページを表示させるのに5回DBへのアクセスがあることになり、運用としてどうなんだろうと考えた次第です。 アクセス数などにもよるのかと思いますが、一般的にこうする、というのがありましたら教えていただければと思います。 もちろん(1)(2)以外の方法でも歓迎です。 よろしくお願いします。
まだ解決できないので、大変恐縮ですがご教授お願いします。 どうかよろしくお願いいたします。 数人にご教授いただいき、チェックボックスの選択には一つのkid（kodawari_keyの略）に対して２複数の値をもっているホテルを表示させるにはデータベースのtableを複数に分けて紐付けする必要があるとアドバイスをいただき、教えて頂いたとおりtableをホテル用とチェックボックス用とチェックボックスのid用とに分けて、SQL文で紐付けしたつもりだったのですが、チェックボックスをチェックしてから検索ボタンを押すと Fatal error: Call to a member function execute() on a non-object in C:\xampp\htdocs\koredake\xxxxx\ｘｘｘｘｘｘｘ.php on line 97 のようなエラーが出てしまいます。 このことから紐付けのSQL文が間違っているのではと思うのですが、正解がわかりません。 どなたか教えていただけたらと思っております。 //MySQLの部分　教えていただいた部分で大変恐縮です。 //ホテルの基本情報 CREATE TABLE t_hotels(id int not null primary key,name varchar(100) not null,price_min int not null,price_max int not null,address varchar(100) not null); INSERT INTO t_hotels VALUES(1,'HOTEL A',5000,10000,'栃木県・・・'), (2,'HOTEL B',5000,12000,'栃木県・・・'), //こだわり情報 CREATE TABLE t_kodawari_key(id int not null primary key,name varchar(20)); INSERT INTO t_kodawari_key VALUES(1,'温泉'),(2,'ランチ'),(3,' ディナー'); //ホテルごとのこだわり CREATE TABLE t_hotel_kodawari(hid int not null,kid int not null,unique key(hid,kid)); INSERT INTO t_hotel_kodawari VALUES(1,1),(1,2),(1,3),(2,1),(3,2),(3,3),(4,3); //温泉かランチにこだわりがあるところ SELECT hid,t3.name,t3.price_min,t3.price_max,GROUP_CONCAT(t2.name) as kodawari,t3.address //温泉かランチかディナーのうち２つ以上にこだわりがあるところ SELECT hid,t3.name,t3.price_min,t3.price_max,GROUP_CONCAT(t2.name) as kodawari,t3.address //PHP部分　前半省略 <h1>ビジネスホテルの条件検索</h1> <form name="search_form" action="zenzen16.php" method="post" > <input type="hidden" name="cmd" value="search" /> <table> <tr> <th>物件種別</th> <td> <input type="checkbox" name="kid[]" value="1" <?php if( $_REQUEST["kid"] == "1" ){ print( 'checked' ); } ?>/> 温泉 <input type="checkbox" name="kid[]" value="2" <?php if( $_REQUEST["kid"] == "2" ){ print( 'checked' ); } ?>/> ランチ<br /> <input type="checkbox" name="kid[]" value="3" <?php if( $_REQUEST["kid"] == "3" ){ print( 'checked' ); } ?>/> ディナー <input type="checkbox" name="kid[]" value="4" <?php if( $_REQUEST["kid"] == "4" ){ print( 'checked' ); } ?>/> 駐車場</td> </tr> <tr> <th>価格帯</th> <td> <input type="text" name="price_min" value="<?php print( htmlspecialchars( $_REQUEST["price_min"] ,ENT_QUOTES ) ) ?>" size="8"> ～ <input type="text" name="price_max" value="<?php print( htmlspecialchars( $_REQUEST["price_max"] ,ENT_QUOTES ) ) ?>" size="8"><br /> </td> </tr> <tr> <th>住所</th> <td><input type="text" name="address" value="<?php print( htmlspecialchars( $_REQUEST["address"] ,ENT_QUOTES ) ) ?>" size="20"></td> </tr> </table> <input type="submit" value="検索" class="Btn-gray button"> </form> <p></p> <?php if( $_REQUEST["cmd"] == "search" ){ $pdo = new PDO("mysql:host=localhost; dbname=hotel_reservation; charset=utf8", "koredake", "koredake123", array( PDO::ATTR_EMULATE_PREPARES => false ) ); $sql = "select * from t_hotels where 1 = 1 "; $condition = array(); //この部分が特に自信が無いです。 if( !empty( $_POST["kid"] )){ $sql = $sql . " left outer join kid on t_hotels.hid = kid.hid"; } if( !empty( $_REQUEST["price_min"] ) ){ $sql = $sql . " and price >= :price_min "; $condition[":price_min"] = $_REQUEST["price_min"]; } if( !empty( $_REQUEST["price_max"] ) ){ $sql = $sql . " and price <= :price_max "; $condition[":price_max"] = $_REQUEST["price_max"]; } if( !empty( $_REQUEST["address"] ) ){ $sql = $sql . " and ( address like :address ) "; $condition[":address"] = "%{$_REQUEST["address"]}%"; } $statement = $pdo->prepare( $sql ); $statement->execute( $condition ); $results = $statement->fetchAll(); ?> <table border="1"> <caption>検索結果</caption> <tr> <th></th> <th>ホテル名</th> <th>宿泊料金</th> <th>住所</th> </tr> <?php foreach( $results as $result ){ ?> <tr> <td><img src="hotel/<?php print( htmlspecialchars( $result["id"], ENT_QUOTES )); ?>.png" /></td> <td><?php print( htmlspecialchars( $result["hotel_name"], ENT_QUOTES )); ?></td> <td>\<?php print( htmlspecialchars( number_format( $result["price"] ),ENT_QUOTES ) ); ?></td> <td> <?php print( htmlspecialchars( $result["address"], ENT_QUOTES ) ); ?> </td> </tr> <?php } } ?> </table> </div>
「たったコレだけでPHPプログラミングが理解できる本」を参考にPHPでプログラムを書いていまして、 ビジネスホテルの検索機能をチェックボックス機能を余分につけて検索できないか試したのですが、 チェックボックスにチェックを入れると全く検索できず他のテキストボックスに入力するだけなら検索できます。 なんとかチェックボックスを有効にできないかいろいろなサイトを調べたり本を読んだりしましたが解決策が見つかりません。 いろいろな機能に対応できるようなプログラムを組みたいと思ったのでかなりの初心者で大変恐縮ですが、どなたかご教授お願いできないかと思っております。 あと参考になるサイトがございましたら、教えていただきたいと思っております。 何卒よろしくお願い致します。 前半省略 <form name="search_form" action="" method="post" > <input type="hidden" name="cmd" value="search" /> <table> <tr> <th>物件種別</th> <td> <input type="checkbox" name="kodawari_key[]" value="温泉" <?php if( $_REQUEST["kodawari_key"] == "温泉" ){ print( 'checked' ); } ?>/> 温泉 <input type="checkbox" name="kodawari_key[]" value="ランチ" <?php if( $_REQUEST["kodawari_key"] == "ランチ" ){ print( 'checked' ); } ?>/> ランチ<br /> <input type="checkbox" name="kodawari_key[]" value="ディナー" <?php if( $_REQUEST["kodawari_key"] == "ディナー" ){ print( 'checked' ); } ?>/> ディナー</td> </tr> <tr> <th>価格帯</th> <td> <input type="text" name="price_min" value="<?php print( htmlspecialchars( $_REQUEST["price_min"] ,ENT_QUOTES ) ) ?>" size="8"> ～ <input type="text" name="price_max" value="<?php print( htmlspecialchars( $_REQUEST["price_max"] ,ENT_QUOTES ) ) ?>" size="8"><br /> </td> </tr> <tr> <th>住所</th> <td><input type="text" name="address" value="<?php print( htmlspecialchars( $_REQUEST["address"] ,ENT_QUOTES ) ) ?>" size="20"></td> </tr> </table> <input type="submit" value="検索" class="Btn-gray button"> </form> <p></p> <?php if( $_REQUEST["cmd"] == "search" ){ $pdo = new PDO("mysql:host=localhost; dbname=hotel_reservation; charset=utf8", "koredake", "koredake123", array( PDO::ATTR_EMULATE_PREPARES => false ) ); $sql = "select * from hotels where 1 = 1 "; $condition = array(); if( !empty( $_POST["kodawari_key"] )){ $sql = $sql . " and kodawari_key = :kodawari_key"; $condition["kodawari_key"] = $_REQUEST["kodawari_key"]; } if( !empty( $_REQUEST["price_min"] ) ){ $sql = $sql . " and price >= :price_min "; $condition[":price_min"] = $_REQUEST["price_min"]; } if( !empty( $_REQUEST["price_max"] ) ){ $sql = $sql . " and price <= :price_max "; $condition[":price_max"] = $_REQUEST["price_max"]; } if( !empty( $_REQUEST["address"] ) ){ $sql = $sql . " and ( pref like :pref or city like :city or address like :address ) "; $condition[":pref"] = "%{$_REQUEST["address"]}%"; $condition[":city"] = "%{$_REQUEST["address"]}%"; $condition[":address"] = "%{$_REQUEST["address"]}%"; } $statement = $pdo->prepare( $sql ); $statement->execute( $condition ); $results = $statement->fetchAll(); ?> <table border="1"> <caption>検索結果</caption> <tr> <th></th> <th>ホテル名</th> <th>宿泊料金</th> <th>住所</th> </tr> <?php foreach( $results as $result ){ ?> <tr> <td><img src="hotel/<?php print( htmlspecialchars( $result["id"], ENT_QUOTES )); ?>.png" /></td> <td><?php print( htmlspecialchars( $result["hotel_name"], ENT_QUOTES )); ?></td> <td>\<?php print( htmlspecialchars( number_format( $result["price"] ),ENT_QUOTES ) ); ?></td> <td> <?php print( htmlspecialchars( $result["pref"], ENT_QUOTES ) ); ?> <?php print( htmlspecialchars( $result["city"], ENT_QUOTES ) ); ?> <?php print( htmlspecialchars( $result["address"], ENT_QUOTES ) ); ?> </td> </tr> <?php } } ?> </table> </div> </body> </html>
mysql4.0.25でlike binaryを使って日本語検索をしていますが インデックスを使いたいので前方一致で条件を作ると検索されません。 文字コードはeuc-jpです。 部分一致でしか検索にひっかからないのですが 文字コードなど関係があるのでしょうか？
SQLを使って、「名前」（カラム名=name)と「コメント」（カラム名=comment)のテーブルを作りました。 このテーブルに対して、検索フォームを作りました。 このフォームに名前を入力すると、該当する行が検索されるようにしました。 ◆入力フォーム　form.php <form action = "kensaku.php" method="post"> 名前：<input type="text" name="name"> <input type="submit" name="submit" value="検索"> </form> ◆検索結果　search.php <?php function connect() { return new PDO("mysql:dbname=★;host=★","★","★", array( PDO::MYSQL_ATTR_INIT_COMMAND => "SET CHARACTER SET `utf8`")); } $pdo = connect(); $st = $pdo->query("SELECT * FROM table WHERE name='" . $_POST["name"] . "' "); $address = $st->fetchAll(); ?> <?php foreach ($table as $g) { ?> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="GENERATOR" content="IBM WebSphere Studio Homepage Builder Version 14.0.8.0 for Windows"> <p>名前<?php echo $g['name'] ?></p> <p>コメント<?php echo $g['comment'] ?></p> <?php } ?> ここで、該当する文言の一部でも検索できるようにしたいです。 ※例えば、「山田太郎」を検索する場合に「山」だけでも検索できるように。 LIKEを使えばよいかと思い、 $st = $pdo->query("SELECT * FROM table WHERE name='" . $_POST["name"] . "' ");を $st = $pdo->query("SELECT * FROM table WHERE name LIKE='%" . $_POST["name"] . "%' "); と、記述してみましたがだめでした。 どのように記述すればよいか教えていただけないでしょうか。 何卒お願いします。
クエリのパフォーマンスチューニングを勉強し始めたのですが、クエリの実行時間の良し悪しはどのように判断したらよいのでしょうか？　実行にかかった時間の目安などはあるのでしょうか？ ちなみに、MySQL5.5を使用しています。 以上、よろしくお願い致します。
自分のパソコンでは文字化けせず、正しく表示されているのですが、 niftyのデータサービスを使ってphpで表示すると文字化けします。 my.iniとmy.cnfの問題と思いniftyサーバーにftpで接続し探したがファイルが見つかりません。 mysqlとphpはutf8で設定しています。 niftyサーバーのmysqlは５、phpMyAdminは2,11,9です。
何十万件もあるリストを短時間に表区分をかえたいのですが、 １件ずつかえるととてつもなく時間がかかるんで、 なにかよい方法はないでしょうか？ たとえば、 以下のような３行の表を、 0001　|　犬　猫 0002　|　猿　狐 0003　|　犬　猿　狐 以下のような動物種ごとに行をわけたい。 0001　|　犬 0001　|　猫 0002　|　猿 0002　|　狐 0003　|　犬 0003　|　猿 0003　|　狐 エクセルはつかえますが、マクロはつかえません。 テキストエディターはサクラエディターをつかっています。
複数のテーブルを結合してレコードを取得するシステムを作成しています。 問題に関わってくるのが、プロジェクトIDや件名を保存するプロジェクトテーブルと、発注先や買掛日・発注金額などを保存する発注テーブルです。 1つのプロジェクトに対して複数の発注先があり、2つのテーブルはプロジェクトIDによって結合されています。 WHERE句によって各カラムの条件でレコードを絞り、プロジェクトIDや件名でグループ化を行い、最終的にプロジェクトID、件名、グループ内で最も遅い買掛日、グループ内の発注金額の総額etcを表示します。 現在起こっている問題の例を挙げます。 1つのプロジェクトに、発注先がA社・買掛日が2014年4月30日・発注金額が10万の発注と、発注先がB社・買掛日が2014年7月30日・発注金額が20万の発注があるとします。 これを発注先がB社・買掛日が4月1日から5月30日までの間という条件で検索をかけると、 本来ならこのプロジェクトは表示されないはずなのですが、最も遅い買掛日が7月30日(B社の買掛日)、発注金額が10万(A社の発注金額)で表示されてしまうのです。 どうすればこれを修正することができるのでしょうか？
単一レコード内において、 Bの値を条件により決定したいのですが可能でしょうか。 ＜構成＞ テーブル:hoge カラム:A,B ＜条件＞ Aにデータがあれば、Bは"●" Aにデータがなければ、Bは"×" よろしくお願いいたします。
こんにちは。 my sql 初心者です。 データをcsv形式でエクスポートする際に問題があり質問です。 商品管理番号サイズカラー ASブルー AMイエロー BSブルー BMイエロー BLレッド CSブルー CMホワイト というデータがあったとします。 ※上記はデータの一部です。実際はもっと文字数もサイズカラーも多いです。 このデータを使ってビューを作成します。 -------------------------------------------------------------------------------- CREATE VIEW item_v_tab AS SELECT id, CONCAT('size:',サイズ,'#','color:',カラー,'=',商品管理番号,'&')AS subcode, 商品管理番号 FROM zaiko; -------------------------------------------------------------------------------- この時にデータ型はmediumtextとなります。 次に、 -------------------------------------------------------------------------------- SELECT id, 商品管理番号, group_concat(distinct subcode order by subcode ASC separator '\n') as subcode FROM item_v_tab group by 商品管理番号; -------------------------------------------------------------------------------- で商品管理番号をグループ化します。 そしてcsvでエクスポートすると subcodeの一部、サイズカラーが多いもので文字数が切れてしまいます。 データ型を変更すれば切れずにすべて出力できるのかな？ と考えて調べていたのですが、方法がわかりません。 お分かりになる方お教えいただけないでしょうか。 以上よろしくお願い致します。
例えば、Twitterのようなシステムを作るとします。ユーザの情報に「名前」「ID」「フォロワー」があります（3つだけユーザー情報とします）。 id , name, follower_idsのようなフィールドが必要だと思います。ですが、この時follower_idsはいくらでも要素が増える可能性があります。このようなユーザー情報をSQL（特にMySQL）で管理することはできますか？ 今回の例のような構造をデータベースに保管したいのですが、どんな形式をとったらいいか迷っているので、質問しました。ちなみにSQLはやったことがありません。おすすめの方法があったらお願いします。XMLやJSON形式というキーワードにもたどり着きましたが、なるべく早いデータ操作をしたいです。
ご覧頂きありがとうございます。 今回の質問ですが、MySQLの表結合時の処理速度（負荷）についてお聞きします。 SELECT abcd.name, hoge.age FROM abdc, hoge WHERE abcd.id = hoge.id; SELECT abcd.name, hoge.age FROM abcd LEFT JOIN hoge ON abcd.id = hoge.id; 上記のいわゆるJOINとJOIN(省略)？になりますが、どちらが処理速度的に優秀なのでしょうか？ 可能であればどういった処理が走っているのかも御存じであれば教えて頂きたいです。 参考URLでも構いませんので、よろしくお願い致します。
SQLについての質問です。 MySQLを使っています。 1か月間の得意先別の入金の集計を取りたいと思っています。 表としては以下のような感じです。 ID　　得意先名　　現金計　振込計　相殺計　手数料計　　合計 =========================================================== 001　aaaaaaa　　　30,000　　40,000　　25,000　　　　840　　95,840 002 bbbbbbb　　　10,000　　20,000　　30,000　　　　420　　60,420 SELECT * sum(nyukin) AS genkin FROM nyukin_meisai WHERE tokuisaki_id = '001' AND nyukin_kubun = '現金' AND uriage_bi BETWEEN '2014/05/01' AND '2014/05/31' SELECT * sum(nyukin) AS furikomi FROM nyukin_meisai WHERE tokuisaki_id = '001' AND nyukin_kubun = '振込' AND uriage_bi BETWEEN '2014/05/01' AND '2014/05/31' 以下続く と得意先毎/各区分ごとに一つひとつSQLを発行すればできるんでしょうけど、 これをひとつのSQLで実現したいと思っていますがSQLをどのように組み立て てよいものやら困っています。 case を組み込んだりしてもうまくいきませんでした。 どなたかご指導下さい。 よろしくお願いします。
お世話になっております。 PHPとmysqlでサイトを作っておりまして、そのログを分析しようとしています。 あるテーブルにユーザー名とログイン日付が入ったテーブルが有ったとして、その中で連続○日ログインしていた人は○人という結果を取りたいと考えているのですがこれをSQLで処理する方法はありますでしょうか？ 今のところ、PHPで全データを取った後にPHP側で処理するしかないかと思っているのですが、件数が多いため可能であればmysql側で処理したいと思っています。 日付はUNIXTIMEに直すなどすればINTEGERに変換出来るとは思っているのですが、日付型（難しいようであればINT型の連続値でも問題ありません）でSQLで処理出来る方法はあるのでしょうか？ ○○結合をすれば良いなど手がかりなど教えていただけると助かります。 ■テーブル username　　　login_date ほげ　　　　　　2014/5/1 ほげ　　　　　　2014/5/2 ほげ　　　　　　2014/5/3 ほげ　　　　　　2014/5/4 ふーばー　　　2014/5/2 ふーばー　　　2014/5/3 あああ　　　　　2014/5/1 あああ　　　　　2014/5/3 あああ　　　　　2014/5/4 ■ほしい結果 4日連続　　　１名 ２日連続　　　２名
テーブルに事前に記載された数値を用い、べき乗の数値の挿入(アップデート)をしたいと考えています。 *********************************************** やりたいこと *********************************************** テーブル　baken umaban___bekijyo___name 1_______NULL____ HOTARUNOHIKARI 2_______NULL____ MADONOYUKI 3_______NULL____ OPPEKEPE 4_______NULL____ KOTARO これをUPDATEして、bekijyo欄に「2のumaban乗」の数値を挿入する。 umaban___bekijyo___name 1_________2_____ HOTARUNOHIKARI 2_________4_____ MADONOYUKI 3_________8_____ OPPEKEPE 4________16_____ KOTARO ************************************************ まずは、べき乗を求めるために下記のSELECT文を作成したところうまくいきました。 SELECT uma_code,umaban FROM (SELECT POW( 2, umaban ) AS uma_code,umaban FROM cbf_today_baken WHERE umaban<'11') AS temp1 umaban___uma_code___ 1_________2_____ 2_________4_____ 3_________8_____ 4________16_____ あとは、上記の2つをくっ付けるだけです。 UPDATE baken SET bekijyo=(SELECT uma_code FROM (SELECT uma_code,umaban FROM (SELECT POW( 2, umaban ) AS uma_code,umaban FROM cbf_today_baken WHERE umaban<'11') AS temp1) WHERE cbf_today_baken.umaban=temp1.umaban) 上記でアップデート可能と思われましたが、エラーになります。 #1248 - Every derived table must have its own alias どこに誤りがあるのかご教授頂けましたら幸いです。
いつもお世話になっております。 コマンドプロンプトにてMySQLに接続後、文字コードを変更まで行える batファイルを作成したのですが、うまくいかず困っております。 batファイル： c:\xampp\mysql\bin\mysql -u root -p1234 にて接続ができることは確認いたしました。 aaa.sqlファイル set character_set_client='sjis'; set character_set_connection='sjis'; set character_set_results='sjis'; c:\xampp\mysql\bin\mysql -u root -p1234　db1 < c:\（ファイルの場所）\aaa.sql とし、実行しましたが、ウィンドウが閉じ、うまくいきません。 いったいどのあたりが悪いのか見当がつかず、困っております。 お忙しいところすみませんが、お知恵を貸していただけませんでしょうか。 何卒宜しくお願いいたします。
Wordpressにあるusermetaというテーブルに、 別のDBのテーブルからデータをINSERTしたいのですが、 #1241 - Operand should contain 1 column(s)　というエラーが表示されてうまくいきませんでした。 具体的なSQL文は、 insert into ***_usermeta (umeta_id,user_id,meta_key,meta_value) select (null,tableBid,'first_name',''), (null,tableBid,'last_name',''), (null,tableBid,'nickname',tableBname), (null,tableBid,'***_capabilities','a:1:{s:10:\"subscriber\";b:1;}'), (null,tableBid,'***_user_level','0') from dbB.tableB where tableBname<> 'Admin' dbBのtableB にあるAdmin行以外を対象としています。 実際にはもう少しデータが多いのですが、select (null,uid,'first_name','') from ・・・ だけにしても同じエラーが出ましたので、構文の書き方が間違っていると感じています。 （別のDBではなく、同じDBの別のTableからのINSERTでも同じエラーが表示されました） 上記のようなケースの場合、どのようにSQL文を書けばよいのでしょうか？ お分かりになられる方がいらっしゃいましたら、ご教示頂けますと幸いです。 宜しくお願い致します。
$sth = $dbh->prepare('SELECT name, colour, calories FROM fruit WHERE calories < :calories AND colour = :colour'); $sth->bindParam(':calories', $calories, PDO::PARAM_INT); $sth->bindParam(':colour', $colour, PDO::PARAM_STR, 12); $sth->execute(); 上記ではなく $sth = $dbh->prepare('SELECT name, colour, calories FROM fruit WHERE calories < ? AND colour = ?'); $sth->execute(array($calories,$colour)); のようにbindParamやbindValueを使わない場合は危険はあるのでしょうか？ ご教示頂けますと幸いです。 宜しくお願いいたします。
現在、サーバー内には、 ■wordpress ■メールマガジン の２つのシステムが入っております。 システム上から確認したときは文字化けが起こっていないのですが、 PHPadminの画面から確認すると、メールマガジンのデータのみ 日本語が文字化けしておりました。 文字化けの原因は、照合順序がlatin1_swedish_ciのためではないかと、 考えております。 エクスポートを試しても、文字化けしておりました。 照合順序をutf8_general_ciに変更したり、エンコードを変えてみたりも試してみましたが、うまくいきません。 文字化けを直す手段はあるのでしょうか。
一覧画面と検索画面を一緒にしています 一覧画面は10件表示にし、テキストになにも入力されてなかったらデータを全件表示したいです また、1 l　2 l 3 のようにページを表示し、また何件中何件目データですと表示したいです <!--一覧画面 index.php--> <html> <head> <title>一覧画面</title> </head> <body> <br><br> <blockquote> 一覧画面 <br><br> <?php if ($_GET) { // データがGETされていたら $event = isset($_GET['event']) ? $_GET['event'] : ''; // 取得 if (isset ($_GET['page'])==false) { $page=0; } else { //そうでなければpageパラメータの値をpage変数にセット $page = $_GET['page']; } } ?> <?php $pdo = new PDO("mysql:dbname=db_test;host=localhost", "root", "admin"); $name=isset($_GET['name'])?$_GET['name']:""; $sql ="select * from tbl_test where "; $sql.="`氏名` like concat('%',?,'%') "; $sql.="or `住所` like concat('%',?,'%') "; $sql.= " limit " . $page*10 . ", 10" ; $stmt = $pdo->prepare( $sql); $stmt->execute(array($name,$name)); $count = $stmt->rowCount(); if($count>0){ print "<table border=1>" ; print "<tr>"; print "<th>番号</th>"; print "<th>氏名</th>"; print "<th>住所</th>"; print "<th>操作</th>"; while($row = $stmt->fetch(PDO::FETCH_ASSOC)){ print "</tr>"; $ID = htmlspecialchars($row['番号']); $NAME = htmlspecialchars($row['氏名']); $ADDR = htmlspecialchars($row['住所']); echo "<tr> <td>$ID</td> <td>$NAME</td> <td>$ADDR</td> <td><a href='edit.php?番号=$ID'>修正</a> <a href='delete.php?番号=$ID'>削除</a></td></tr>"; }; print "</table>" ; }else{ print "該当するデータがありません"; } ?> <br><br><br> <form action = "index.php" method="GET"> <input type="hidden" name="event" value="find"> <input type="text" name="name"style ="font-size:20px;width: 400px; height: 40px"> <input type="submit" value="検索" style ="font-size:20px;width: 100px; height: 40px"> </form> <br><br> <form action = "regist.php" method="GET"> <input type="hidden" name="event" value="regist"> <input type = "submit" value = "新規登録" style ="font-size:20px;width: 100px; height: 40px"> </form> <input type="hidden" name="page" value="0"> </blockquote> </body> </html> 検索のテキストボックスが空だったら全件表示したいのですが今１０件しか出ません limitの書く場所が原因でしょうか？ またこのように一覧画面と検索結果画面が一緒じゃまずいですかね？ 検索結果を別ウインドウじゃなく自分に返したいと思いこのやり方にしたのですがよくないですか？
mysqlで検索フォームを作成しています 入力してデータに該当したら検索結果が出るのですが 該当者がいないときはテーブルの表のみ出力してしまう 該当者なしと入力フォーム側に表示したいです また　''''''を入力するとSQLになるのですが mysql_real_escapeを使えば出なくなります どうしたらいいですか <html> <body> <?php //データベースに接続 if (!$con = mysql_connect("localhost", "root", "admin")) { echo "接続エラー" ; exit ; } //データベースを選択 if (!mysql_select_db("db_test", $con)) { echo "データベース選択エラー" ; exit ; } //フォームで送られてきた条件を元にSELECT文を作成 $sql = "select * from tbl_test where (氏名 LIKE '%{$_GET['name']}%') or (住所 LIKE '%{$_GET['name']}%')"; //SELECT文を実行 if (!$res = mysql_query($sql)) { echo "SQLエラー<BR>" ; exit ; }else{ } //検索結果表示 echo "<table border=1>" ; echo "<tr> <th>番号</th> <th>氏名</th> <th>住所</th> <th>操作</th> </tr>" ; while($row = mysql_fetch_array($res)) { $ID = htmlspecialchars($row['番号']); $NAME = htmlspecialchars($row['氏名']); $ADDR = htmlspecialchars($row['住所']); echo "<tr> <td>$ID</td> <td>$NAME</td> <td>$ADDR</td> <td><a href='edit.php?番号=$ID'>修正</a> <a href='delete.php?番号=$ID'>削除</a></td></tr>"; if ($_GET) { // データがGETされていたら $event = isset($_GET['event']) ? $_GET['event'] : ''; // 取得 } } echo "</table>" ; //結果セットの開放 mysql_free_result ($res) ; //データベースから切断 mysql_close($con) ; ?> </body> </html>
mysqlのfulltextを使用した全文検索で引っかからないワードがあって困っています。 例えば、keywordsテーブルにwordsカラムに以下のレコードがあったとします。 -------------- ジェフ トム ram -------------- このとき、下記のsqlを発行してもジェフやramが引っかかりません。 SELECT * FROM `keywords` WHERE MATCH(words) AGAINST('ジェ*' IN BOOLEAN MODE); SELECT * FROM `keywords` WHERE MATCH(words) AGAINST('ram*' IN BOOLEAN MODE); （※以下は引っかかる SELECT * FROM `keywords` WHERE MATCH(words) AGAINST('トム*' IN BOOLEAN MODE);　） もちろん、カラム定義には、alter table keywords add fulltext(words)をしています。 またFull-Text Stopwordsもデフォルトのままです。 どんな原因があるか分かる方いらっしゃいますでしょうか？ 以上、よろしくお願い致します。
MySQLでデータの表示を行っています 10件ずつ表示し、１１件からは２ページ目に表示したいです サイトや本を見ながらデータ表示と次の10件のリンクは表示されるよう自力で頑張ったのですが 次の１０件を押してもデータが変わらず１件目から１０件目のままです どこが違うか教えてもらえますか。 どうコードを入力するか教えてくれたらありがたいです 一覧　ta2.phpです <html> <body> <form action = "ta2.php" method="GET"> <input type="hidden" name="page" value="0"> </form> <?php //データベースに接続 if (!$con = mysql_connect("localhost", "root", "admin")) { echo "接続エラー" ; exit ; } //データベースを選択 if (!mysql_select_db("db_test", $con)) { echo "データベース選択エラー" ; exit ; } //LIMITを使ったSELECT文を作成 $sql = "select * from tbl_test" ; $sql.= " limit " . $page*10 . ", 10" ; //SQL実行 if (!$res = mysql_query($sql)) { echo "SQLエラー<BR>" ; exit ; } //検索結果表示 echo "<table border='1'> <tr> <th>番号</th> <th>氏名</th> <th>住所</th> <th>操作</th> </tr>"; while($row = mysql_fetch_array($res)) { $ID = htmlspecialchars($row['番号']); $NAME = htmlspecialchars($row['氏名']); $ADDR = htmlspecialchars($row['住所']); echo "<tr> <td>$ID</td> <td>$NAME</td> <td>$ADDR</td> <td><a href='edit.php?番号=$ID'>修正</a> <a href='delete.php?番号=$ID'>削除</a></td></tr>"; header('content-type: text/html; charset="utf-8"'); if ($_GET) { // データがGETされていたら $page = isset($_GET['page']) ? $_GET['page'] : ''; // 取得 } } $sql = "select count(*) from tbl_test " ; if (!$res = mysql_query($sql)) { echo "SQLエラー<BR>" ; exit ; } $row = mysql_fetch_array($res) ; $cnt = $row[0] ; //ページ表示 if(!$cnt > 10) echo ceil($cnt / 10), "ページの中の", $page + 1, "ページ目を表示<br>" ; //前の10件 if ($page != 0) { echo "<a href = ta2.php?page= $page>" ; echo "&lt 前の10件" ; } //次の10件 if (($page + 1)*10 < $cnt) { echo "<a href = ta2.php?page= $page>" ; echo " 次の10件 " ; } //結果セットの開放 mysql_free_result ($res) ; //データベースから切断 mysql_close($con) ; ?> </table> </body> </html>
お世話になります。 前回立てたトピック（http://oshiete.goo.ne.jp/qa/8565634.html）でサンプルデータにミスがあったため、立て直しです。 ※顧客＆商品ごとの本申込という文字列が含まれる最新データを取得したい ※商品名の長さは変動します（商品名には実際は番号はありません） ※MySQL5です。 どうぞお知恵をお貸しください。 ■テーブルデータ CREATE TABLE IF NOT EXISTS `TABLE1` ( `SEQ_ID` mediumint(8) NOT NULL AUTO_INCREMENT COMMENT 'シーケンスID', `TO_USER_NM` varchar(128) DEFAULT NULL COMMENT '顧客', `MAIL_TITLE` varchar(256) DEFAULT NULL COMMENT '商品', `SEND_TIME` datetime NOT NULL COMMENT '購入日時', PRIMARY KEY (`SEQ_ID`) ); INSERT INTO `TABLE1` (`SEQ_ID`, `TO_USER_NM`, `MAIL_TITLE`, `SEND_TIME`) VALUES (1 , '顧客A', '『商品1』仮申込', '2014-03-01 13:07:43'), (2 , '顧客C', '『商品1』仮申込 / 変更1', '2014-03-02 10:06:54'), (3 , '顧客E', '『商品1』仮申込', '2014-03-03 10:06:54'), (4 , '顧客E', '『商品1』本申込', '2014-03-04 13:33:51'), (5 , '顧客B', '『商品1』本申込', '2014-03-05 14:58:41'), (6 , '顧客A', '『商品1』本申込 / 変更1', '2014-03-06 16:42:56'), (7 , '顧客D', '『商品1』本申込 / 変更2', '2014-03-07 17:27:33'), (8 , '顧客C', '『商品1』本申込 / 変更1', '2014-03-08 13:56:29'), (9 , '顧客A', '『商品2』仮申込', '2014-03-09 18:44:05'), (10, '顧客A', '『商品2』仮申込 / 変更1', '2014-03-10 10:43:14'), (11, '顧客C', '『商品1』本申込 / 変更2', '2014-03-11 08:51:02'), (12, '顧客C', '『商品1』本申込 / 変更3', '2014-03-12 20:33:39'), (13, '顧客A', '『商品2』本申込', '2014-03-14 18:52:44'), (14, '顧客B', '『商品1』仮申込', '2014-03-15 16:13:47'), (15, '顧客B', '『商品1』本申込 / 変更3', '2014-03-16 21:07:35'), (16, '顧客B', '『商品1』本申込 / 変更4', '2014-03-18 21:07:34'), (17, '顧客B', '『商品3』仮申込', '2014-03-19 21:42:46'), (18, '顧客B', '『商品3』本申込', '2014-03-20 22:14:10'), (19, '顧客A', '『商品2』本申込 / 変更1', '2014-03-21 23:44:06'), (20, '顧客A', '『商品1』本申込 / 変更5', '2014-03-22 08:22:59'), (21, '顧客A', '『商品2』仮申込', '2014-04-01 13:07:43'), (22, '顧客A', '『商品2』本申込 / 変更2', '2014-04-02 10:06:54'), (23, '顧客B', '『商品2』仮申込', '2014-04-03 10:06:54'), (24, '顧客B', '『商品2』仮申込 / 変更1', '2014-04-04 13:33:51'), (25, '顧客B', '『商品2』本申込', '2014-04-05 14:58:41'), (26, '顧客F', '『商品1』仮申込', '2014-04-06 16:42:56'), (27, '顧客F', '『商品1』本申込', '2014-04-07 17:27:33'), (28, '顧客G', '『商品3』仮申込', '2014-04-08 13:56:29'), (29, '顧客F', '『商品1』本申込 / 変更1', '2014-04-09 18:44:05'), (30, '顧客G', '『商品3』本申込', '2014-04-10 10:43:14'), (31, '顧客A', '『商品1』本申込 / 変更6', '2014-04-11 08:51:02'), (32, '顧客A', '『商品2』本申込 / 変更3', '2014-04-12 20:33:39'), (33, '顧客F', '『商品1』本申込 / 変更2', '2014-04-14 18:52:44'), (34, '顧客C', '『商品3』仮申込', '2014-04-15 16:13:47'), (35, '顧客C', '『商品3』本申込', '2014-04-16 21:07:35'), (36, '顧客H', '『商品1』仮申込', '2014-04-18 21:07:34'), (37, '顧客H', '『商品1』本申込', '2014-04-19 21:42:46'), (38, '顧客H', '『商品1』本申込 / 変更1', '2014-04-20 22:14:10'), (39, '顧客E', '『商品2』仮申込', '2014-04-21 23:44:06'), (40, '顧客E', '『商品2』仮申込 / 変更1', '2014-04-22 08:22:59'); ■取得したいデータ 38, '顧客H', '『商品1』本申込 / 変更1', '2014-04-20 22:14:10' 35, '顧客C', '『商品3』本申込', '2014-04-16 21:07:35' 33, '顧客F', '『商品1』本申込 / 変更2', '2014-04-14 18:52:44' 32, '顧客A', '『商品2』本申込 / 変更3', '2014-04-12 20:33:39' 31, '顧客A', '『商品1』本申込 / 変更6', '2014-04-11 08:51:02' 30, '顧客G', '『商品3』本申込', '2014-04-10 10:43:14' 25, '顧客B', '『商品2』本申込', '2014-04-05 14:58:41' 18, '顧客B', '『商品3』本申込', '2014-03-20 22:14:10' 16, '顧客B', '『商品1』本申込 / 変更4' '2014-03-18 21:07:34' 12, '顧客C', '『商品1』本申込 / 変更3' '2014-03-12 20:33:39' 7 , '顧客D', '『商品1』本申込 / 変更2' '2014-03-07 17:27:33' 4 , '顧客E', '『商品1』本申込', '2014-03-04 13:33:51'
先ほども質問したのですが再度質問させていただきます mysql limitページ分割を行っていてエラーは消せたのですが今度 SQLエラーになり出来ません 前の人が質問したのを参考にしてつくったのですがうまくいかず困っています 検索結果を10件ずつ表示して googleみたいに 1l 2l 3 みたいな感じやりたいです <body> <?php error_reporting(E_ALL ^ E_NOTICE); //データベースに接続 if (!$con = mysql_connect("localhost", "root", "admin")) { echo "接続エラー" ; exit ; } //データベースを選択 if (!mysql_select_db("db_test", $con)) { echo "データベース選択エラー" ; exit ; } //LIMITを使ったSELECT文を作成 $sql = "select * from tbl_test where (氏名 LIKE '%{$_GET['name']}%') or (住所 LIKE '%{$_GET['name']}%')"; $sql = "limit" . $page * 10 . ", 10" ; //SQL実行 if (!$res = mysql_query($sql)) { echo "SQLエラー<BR>" ; exit ; } //検索結果表示 echo "<table border=1>" ; echo "<tr> <th>番号</th> <th>氏名</th> <th>住所</th> <th>操作</th> </tr>" ; while($row = mysql_fetch_array($res)){ $ID = htmlspecialchars($row['番号']); $NAME = htmlspecialchars($row['氏名']); $ADDR = htmlspecialchars($row['住所']); echo "<tr> <td>$ID</td> <td>$NAME</td> <td>$ADDR</td> <td><a href='edit.php?番号=$ID'>修正</a> <a href='delete.php?番号=$ID'>削除</a></td> </tr>"; //検索条件に該当する全データの件数取得 $sql = "select count(*) from tbl_test " ; $sql = "where (氏名 LIKE '%{$_POST['name']}%') or (住所 LIKE '%{$_POST['name']}%')"; if (!$res = mysql_query($sql)) { echo "SQLエラー<BR>" ; exit ; } $row = mysql_fetch_array($res) ; $cnt = $row[0] ; //ページ表示 if(!$cnt > 10) echo ceil($cnt / 10), "ページの中の", $page + 1, "ページ目を表示<br>" ; //前の10件 if ($page_num != 0) { echo "<a href = find.php?name=".$name. ". $page -1.>" ; echo "&lt 前の10件"; } //次の10件 if (($page_num + 1)*10 < $cnt) { echo "<a href = find.php?name=".$name. ". $page +1.>" ; echo " 次の10件 &g</a>t" ; } //結果セットの開放 mysql_free_result ($res) ; //データベースから切断 mysql_close($con) ; } ?> </body> </html>
前の人が質問したのを参考にしてつくったのですがうまくいかず困っています 検索結果を10件ずつ表示して googleみたいに 1l 2l 3 みたいな感じやりたいです <html> <body> <?php //データベースに接続 if (!$con = mysql_connect("localhost", "root", "admin")) { echo "接続エラー" ; exit ; } //データベースを選択 if (!mysql_select_db("db_test", $con)) { echo "データベース選択エラー" ; exit ; } //LIMITを使ったSELECT文を作成 $sql = "select * from tbl_test where (氏名 LIKE '%{$_POST['name']}%') or (住所 LIKE '%{$_POST['name']}%')"; $sql = "limit" . $page_num*10 . ", 10" ; //SQL実行 if (!$res = mysql_query($sql)) { echo "SQLエラー<BR>" ; exit ; } //検索結果表示 echo "<table border=1>" ; echo "<tr> <th>番号</th> <th>氏名</th> <th>住所</th> <th>操作</th> </tr>" ; while($row = mysql_fetch_array($res)){ $ID = htmlspecialchars($row['番号']); $NAME = htmlspecialchars($row['氏名']); $ADDR = htmlspecialchars($row['住所']); echo "<tr> <td>$ID</td> <td>$NAME</td> <td>$ADDR</td> <td><a href='edit.php?番号=$ID'>修正</a> <a href='delete.php?番号=$ID'>削除</a></td> </tr>"; //検索条件に該当する全データの件数取得 $sql = "select count(*) from tbl_test " ; $sql = "where (氏名 LIKE '%{$_POST['name']}%') or (住所 LIKE '%{$_POST['name']}%')"; if (!$res = mysql_query($sql)) { echo "SQLエラー<BR>" ; exit ; } $row = mysql_fetch_array($res) ; $cnt = $row[0] ; //ページ表示 if(!$cnt > 10) echo ceil($cnt / 10), "ページの中の", $page_num + 1, "ページ目を表示<br>" ; //前の10件 if ($page_num != 0) { echo "<a href = find.php?name=",$name, ", $page_num -1.">" ; echo "&lt 前の10件"; } //次の10件 if (($page_num + 1)*10 < $cnt) { echo "<a href = find.php?name=",$name, ", $page_num +1.">" ; echo " 次の10件 &g</a>t" ; } //結果セットの開放 mysql_free_result ($res) ; //データベースから切断 mysql_close($con) ; ?> </body> </html> Parse error: syntax error, unexpected '前の10件' (T_STRING), expecting ',' or ';' というエラーが出て自分なりにバグを消しているのですがまだエラーが消えずに困っています
こんにちは質問させてください。 商品が登録されているテーブル A に以下のカラムがあるとします。 id(int),　　name(varcahr),　　dt(datetime) id　　　には 店を識別す固有の番号がふってあり、 name　には 商品名、　 dt　　　には商品を登録した日付が入っているものとします。 やりたいことは ”id が 「１」 である全商品数” と ”今月登録された商品の数” を出力したいのです。 id が 1 である商品の数は以下のSQLで取り出せます。 SELECT　COUNT(*)　FROM 　(　SELECT　*　FROM　A　WHERE　A.id='1'　)　AS tbl1 id が 1 で 今月登録された商品の数は以下のSQLで取り出せます。 SELECT　COUNT(*)　FROM 　(　SELECT　*　FROM　A　 　　 WHERE　A.dt　BETWEEN　DATE(　 　　　　　DATE_SUB(　NOW(),　INTERVAL　DAYOFMONTH(　NOW()　)-1　DAY)　) AND 　　　　　LAST_DAY(　NOW()　)　AND　A.id='1'　)　AS　tbl1 これをひとつのSQLにまとめるにはどうしたらいいのでしょうか…。 宜しくお願い致します。
お世話になります。 以下のテーブル1からサンプル1のようなデータを抽出したいのですが、SQLはどのように書いたらよいでしょうか。 ・顧客と商品ごとに購入日時が最新のデータを取得 ・商品は左側の番号が同じ場合は購入日が最新のデータのみ抽出したい データベースは　MySQL5　です。 よろしくお願いいたします。 ●テーブル1 顧客　　商品　　購入日時 --------------------------------- 　A　　2-2　　2014-04-23 08-00-00 　A　　2-1　　2014-04-21 08-00-00 　B　　2-3　　2014-04-20 09-00-00 　B　　2-2　　2014-04-18 06-00-00 　B　　2-1　　2014-04-15 05-00-00 　A　　1-3　　2014-04-12 08-00-00 　A　　1-2　　2014-04-10 04-00-00 　C　　2-2　　2014-04-09 05-00-00 　C　　2-1　　2014-04-08 06-00-00 　C　　1-2　　2014-04-07 08-00-00 　C　　1-1　　2014-04-06 05-00-00 　A　　1-1　　2014-04-05 02-00-00 　B　　1-2　　2014-04-04 02-00-00 　B　　1-1　　2014-04-03 01-00-00 ●サンプル1 顧客　　商品　　購入日時 --------------------------------- 　A　　2-2　　2014-04-23 08-00-00 　B　　2-3　　2014-04-20 09-00-00 　A　　1-3　　2014-04-12 08-00-00 　C　　2-2　　2014-04-09 05-00-00 　C　　1-2　　2014-04-07 08-00-00 　B　　1-2　　2014-04-04 02-00-00
PHPでデータの登録を行っています いろいろ調べながら試行錯誤しています 登録できる条件があります 1.番号が重複じゃない 2.番号、氏名、住所が空白でない場合です 現状 1.2両方できていてデータも追加されるのですが、 ２の条件、空白だった場合エラーメッセージを表示したいのですが表示されず困っています <?php $err = ""; if(empty($_POST['ID'])) $err.= "<br><br>番号入力してください。<br><br>"; if(empty($_POST['NAME'])) $err.= "<br><br>氏名入力してください。<br><br>"; if(empty($_POST['ADDR'])) $err.= "<br><br>住所を入力してください。<br><br>"; if(empty($err)) { $pdo = new PDO("mysql:dbname=db_test;host=localhost", "root", "****"); $st = $pdo->prepare("INSERT INTO tbl_test VALUES(?,?,?)"); $st->execute(array($_POST['ID'], $_POST['NAME'],$_POST['ADDR'])); if($st->rowCount()>0) { header('Location: http://localhost/top.php'); }else{ print "既に登録している番号です"; } echo $err; } ?> 重複したときは"既に登録している番号です"と表示されるのですが、空白だった場合$errが表示されません
以下のSQL文を実行すると CREATE TABLE if not exists table_A ( idint(11) not null auto_increment, company_idint(11) not null, created_atdatetime NOT NULL, updated_attimestamp NOT NULL, PRIMARY KEY (id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; CREATE TABLE if not exists table_B ( idint(11) not null auto_increment, from_idint(11) not null, company_idint(11) not null, created_atdatetime NOT NULL, updated_attimestamp NOT NULL, PRIMARY KEY (id) FOREIGN KEY (from_id) REFERENCES table_A(id) ON DELETE CASCADE ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; 上記を実行すると以下のエラーがでます。 #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FOREIGN KEY (from_id) REFERENCES table_A(id) ON DELETE CASCADE ) ENGINE=Inn' at line 8 解決方法をご存知の方はご教示頂けますと幸いです。 宜しくお願いいたします。
データの新規登録を行っているのですが 番号が重複しないでまたデータがすべて入力されたらデータの追加を行いたいのですが エラーが出て対処できずに困っています 下記のエラーがでます Parse error: syntax error, unexpected end of file in C:\WWW\test\htdoes\insert.php on line 20 20行目は一番下の行です <html> <body> <?php $pdo = new PDO("mysql:dbname=db_test;host=localhost", "root", "admin"); if($st->rowCount()>0){ if ($_POST['ID'] != '' && $_POST['NAME'] != '' && $_POST['ADDR'] != ''){ $st = $pdo->prepare("insert ignore into tbl_test values(?,?,?)"); $st->execute(array($_POST['ID'], $_POST['NAME'],$_POST['ADDR'])); header('Location: http://localhost/top.php'); }else{ print データ未入力の場所があります; } }else{ print "既に登録している番号です"; ?> </body> </html>
tbl_aとtbl_bから、tbl_cを作りたいのですが どのようなsql文を書けば良いでしょうか？ アドバイス頂けると嬉しいです。よろしくお願い致します。 テーブル：tbl_a ----------------- code1,code2,name ----------------- 001,a,あ 002,a,あ 003,a,あ 004,a,あ 005,b,い 006,b,い 007,b,い 008,c,う 009,c,う 010,c,う 011,c,う 012,d,え 013,d,え 014,d,え テーブル：tbl_b ----------------- code1,point ----------------- 003,10 004,2 008,10 009,5 011,20 テーブル：tbl_c ----------------- code2,name,point ----------------- a,あ,2 b,い, c,う,5 d,え,
３つのテーブルを連携した並び替えのSELECT文について教えて下さい。 例えば次の3つのテーブルがあるとします。 COOK_TBL ---------------- COOK_NAME パスタ パスタ グラタン オムライス グラタン カレー ZAIRYO_TBL --------------- COOK_NAME ZAIRYO_NAME グラタン　 鶏肉 オムライス 卵 オムライス 玉ねぎ パスタ　　 卵 パスタ　　 麺 COOK_KIOKU_TBL --------------- COOK_NAME オムライス グラタン COOK_TBLのCOOK_NAMEでグルーピングしたものに対し、ZAIRYO_TBLのCOOK_NAMEに存在するものは全て抽出し、 COOK_KIOKU_TBLのCOOK_NAMEとCOOK_TBLのCOOK_NAMEと一致するレコードは頭の方（COOK_KIOKU_TBLのCOOK_NAMEのレコード順）に並び替えられるようにしたいです。 得たい結果は次の通りです。 COOK_TBL ------------- COOK_NAME オムライス グラタン パスタ どうしても分かりません。 助けて下さい。 os: windows 7 eclipse: Version: 4.2.0
すいません1つ質問があります。 通常であれば、　mysql> とあってコマンドを入力するのですが、 たまに、"> となってしまい何も受け付けないときがあります。 \c　でキャンセルも出来ません。 どうしてこうなるのかもわからないです。 なぜこうなるのか？　そしてこの問題を解決するにはどうすればよいかご教授頂けると幸いです。 ネットで調べましたがこの件について触れているページがありませんでした。 よろしくお願いいたします。
すいません1つ質問があります。 こちらのサイトでCSVのファイルのインポート方法を勉強していますが、下記の方法だとあらかじめ、データベースが格納されているフォルダにCSVを置いてある前提でこのやり方をやります。 LOAD DATA INFILE "T01Prefecture.csv" INTO TABLE T01Prefecture FIELDS TERMINATED BY "," LINES TERMINATED BY "\r\n"; 僕が知りたいのは、例えば、 C:\Users\Ken\Desktop\T01Prefecture.csv ここに置いてあるCSVを指定してインポートしたいと考えています。 そのやり方がどうもこのパスを書くだけでは出来ないです。 どなたかやり方を教えて頂けますか？ 僕が書いたのは下記の通りです。 LOAD DATA INFILE "C:\Users\Ken\Desktop\T01Prefecture.csv" INTO TABLE T01Prefecture FIELDS TERMINATED BY "," LINES TERMINATED BY "\r\n"; よろしくお願いいたします。
入力フォームに入力された番号が登録されてなかったら新規登録できるようにしたい INSEPT IGNORE INTOで主キーを無視するのではなく重複したらエラーメッセージを出しユーザにもう一度入力させるようにする 新規登録フォーム <html> <head><title>新規登録</title></head> <body> <blockquote> <form action = "insert.php" method = "POST"> <br><br>登録画面<br><br> すべての項目入力してください<br> 番号<input type="number" name = "ID"> (一覧画面にない番号を入力してください) <br> <br>氏名<input type="text" size = "50" name = "NAME"><br><br> 住所<input type="text" size = "130" name = "ADDR"><br><br> <a href="http://localhost/top.php"> <input type = "submit" value = "登録する" style ="font-size:20px; width: 100px; height: 40px"></A> <a href="http://localhost/top.php"> <input type = "button" value = "一覧に戻る" style ="font-size:20px; width: 100px; height: 40px"></A> </body> </blockquote> </form> </body> </html> 登録を実行するフォーム <?php $con=mysqli_connect("localhost","root","admin","db_test"); // Check connection if (mysqli_connect_errno()) { echo "Failed to connect to MySQL: " . mysqli_connect_error(); } if ($_POST['ID'] != '' && $_POST['NAME'] != '' && $_POST['ADDR'] != '') { $id = mysqli_real_escape_string($con, $_POST['ID']); $name = mysqli_real_escape_string($con, $_POST['NAME']); $addr = mysqli_real_escape_string($con, $_POST['ADDR']); $sql="INSERT INTO tbl_test (番号, 氏名, 住所) VALUES ('$id','$name','$addr')"; if (!mysqli_query($con,$sql)) { die('Error: ' . mysqli_error($con)); } header('Location: http://localhost/top.php'); exit(); } else { ?> <html> <body> <blockquote> <br><br>データが未入力の箇所があります。すべてデータを入力してください <br><br><br> <a href="http://localhost/regist.php"> <INPUT TYPE = "button" VALUE = "登録画面に戻る" style ="font-size:20px; width: 140px; height: 40px"></A> <br><br><br> <A HREF="http://localhost/top.php"> <INPUT TYPE = "button" VALUE = "一覧に戻る" style ="font-size:20px; width: 140px; height: 40px"></A> </blockquote> </body> </html> <?php } mysqli_close($con); ?> どういう風にselect文を書けばいですか？
「ストアドファンクションの再帰呼び出し」はできないのでしょうか。 hoge関数をhoge関数の中で呼び出しています。 hoge関数では、条件に当てはまらないと第三引数を、 編集して再帰呼出しをしています。 再帰呼出しする条件を引数に設定して実行すると、以下の実行結果(ERROR)が表示されます。 ＜実行結果＞ mysql> select hoge('7','1234','1234567891012'); ERROR 1424 (HY000): Recursive stored functions and triggers are not allowed. よろしくお願いします。
番号　int プライマリーキ- 氏名　varchar 住所 varchar データベースで入力フォームから新規登録をしたいのですが Duplicate entry '11' for key 'PRIMARY' 11はすでに存在していると出ます オートナンバー型に変えずに"すでに登録されている番号です"というエラーメッセージを出し、もう一度登録画面に戻るしたいのですが、 try文で例外処理させれば出来ますか？ また出来るのであればどういう風に記述するか教えてもらえますか？
初めての質問になります。 以下のようなテーブルで、dataカラムにカンマ区切りのデータを保存しているのですが、こちらはgroup byやcount等を使ってSQL一発で集計結果を取得できるのでしょうか？ SELECT count(*) FROM TEST WHERE FIND_IN_SET('1', data)で1から順番に取得は出来るのですが、数が多いとちょっといかがなものかと思い、質問させていただきました。 環境：mysql5.5 ------------ ｜data ------------ ｜1,2,3 ------------ ｜1,2,10 ------------ ｜1,2,3,10 ------------ 期待する結果は以下のような感じです。 1｜3 --------- 2｜3 --------- 3｜2 --------- 10｜2
MySqlバージョン：5.1.61で、下記のSQLを実行すると、 １件しかデータが無いにも関わらず、EXPLAINの結果で 「Extra: Using where; Using filesort」が発生します。 ---------------- CREATE TABLE IF NOT EXISTS tbl ( user int(11) NOT NULL, item int(11) NOT NULL, prm1 int(11) NOT NULL, prm2 int(11) NOT NULL, prm3 int(11) NOT NULL, PRIMARY KEY (user,item) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO tbl (user,item,prm1,prm2,prm3) VALUES (1,1,10,10,10); EXPLAIN SELECT * FROM tbl WHERE user=1 ORDER BY prm1; EXPLAIN SELECT * FROM tbl WHERE user=1 ORDER BY prm2; EXPLAIN SELECT * FROM tbl WHERE user=1 ORDER BY prm3; ---------------- ORDER BY句で使用する項目(prm[n])は10項目以上になりますので 10件を超える複合インデックスを張る事は避けたいと考えております。 また、tbl全体のデータは1億件、1userあたり100～200件を想定しています。 複合インデックスを使用せず「Using filesort」を 発生させなくする事はできるのでしょうか？
下記のような＜検索対象データ＞から、＜取得したいデータ＞を取得するSQLがわからず困っています。 ご教授下さい。 【条件】 同一[ID]で[NO]が最大のレコードのみを取得する。 ＜検索対象データ＞ IDNODATA ---------------- AA1あいうえ AA2あいう AA3あい BB1かきく BB2かき CC1さしす CC2さし ＜取得したいデータ＞ IDNODATA ---------------- AA3あい BB2かき CC1さし よろしくお願いします。
一覧画面に更新ボタンを作成しました 更新ボタンを押すとkoushin_input.phpにデータを渡し入力フォームを表示され番号、氏名、住所が選択されたデータが表示されるようにしたいのでが更新ボタンを押しても下記のように出ます string(64) "SELECT `番号`,`氏名`,`住所` FROM tbl_test where `番号`=0" bool(false) データが削除されています ソースコードはtop.php 一覧画面です <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <title>一覧画面</title> </head> <body> <BLOCKQUOTE> <BR>一覧画面<BR><BR> <?php $con=mysqli_connect("localhost","root","admin","db_test"); if(isset($_GET["del"]) and isset($_GET["id"]) and $_GET["del"]==1){ $id=(int) $_GET["id"]; $result = mysqli_query($con,"DELETE FROM tbl_test where `番号`={$id}"); } // Check connection if (mysqli_connect_errno()) { echo "Failed to connect to MySQL: " . mysqli_connect_error(); } $result = mysqli_query($con,"SELECT * FROM tbl_test"); echo "<table border='1'> <tr> <th>番号</th> <th>氏名</th> <th>住所</th> </tr>"; while($row = mysqli_fetch_array($result)) { echo "<tr>"; echo "<td>" . $row['番号'] . "</td>"; echo "<td>" . $row['氏名'] . "</td>"; echo "<td>" . $row['住所'] . "</td>"; echo "<form action=koushin_input.php method=get>"; echo "<td><input type=submit value=更新></td>"; echo "</form>"; echo "<td><a href=\"".$_SERVER["SCRIPT_NAME"]."?del=1&amp;id=".$row['番号']."\">削除</a></td>"; echo "</tr>"; } echo "</table>"; mysqli_close($con); ?> <BR><BR><BR> <A HREF="http://localhost/regist.php"> <INPUT TYPE = "SUBMIT" VALUE = "新規登録"></A> </BLOCKQUOTE> </body> </html> 受け取る側 koushin_input.phpです <html> <body> <?php // データベースに接続 if(!$con=mysql_connect("localhost","root","admin")){ echo"接続エラー"; exit; } // データベースを選択 if(!mysql_select_db("db_test",$con)){ echo"データベース選択エラー"; exit; } // SELECT文を実行 $id=(isset($_GET["id"]))?((int) $_GET["id"]):0; $sql = "SELECT `番号`,`氏名`,`住所` FROM tbl_test where `番号`={$id}"; var_dump($sql); if(!$res=mysql_query($sql)){ echo "SQL実行時エラー"; exit; } // データの存在チェック if(!$row=mysql_fetch_array($res)){ $row=mysql_fetch_array($res); var_dump($row); echo "データが削除されています"; exit; } // 入力画面の出力 echo "<form action=koushin.php method=post>"; echo "名前：<input type=text name=NAME value=\"" . $row['氏名'] . "\"> "; echo "住所：<input type=text name=ADDR value=" . $row['住所'] . "> "; echo "<input type=submit value=更新>"; echo "</form>"; // 結果セットの解放 mysql_free_result($res); // データベースから切断 mysql_close($con); ?> </body> </html> どこが原因なんでしょうか?
一覧画面に更新、削除というボタンをつくり番号を受け取って削除したいのですが、削除ボタンを押しても画面は変わるのですが削除されません 助けてください 番号　int プライマリーキー 氏名 varchar 住所 varchar 一覧画面のソース <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <title>一覧画面</title> </head> <body> <BLOCKQUOTE> <BR>一覧画面<BR><BR> <?php $con=mysqli_connect("localhost","root","admin","db_test"); // Check connection if (mysqli_connect_errno()) { echo "Failed to connect to MySQL: " . mysqli_connect_error(); } $result = mysqli_query($con,"SELECT * FROM tbl_test"); echo "<table border='1'> <tr> <th>番号</th> <th>氏名</th> <th>住所</th> </tr>"; while($row = mysqli_fetch_array($result)) { echo "<tr>"; echo "<td>" . $row['番号'] . "</td>"; echo "<td>" . $row['氏名'] . "</td>"; echo "<td>" . $row['住所'] . "</td>"; echo "<form action=koushin_input.php method=post>"; echo "<td><input type=submit value=更新></td>"; echo "</form>"; echo "<form action=sakujo.php method=post>"; echo "<td><input type=submit value=削除></td>"; echo "</form>"; echo "</tr>"; } echo "</table>"; mysqli_close($con); ?> <BR><BR><BR> <A HREF="http://localhost/regist.php"> <INPUT TYPE = "SUBMIT" VALUE = "新規登録"></A> </BLOCKQUOTE> </body> </html> 削除ソース　 sakujo.php <html> <body> <? // データベースに接続 if(!$con=mysql_connect("localhost","root","admin")){ echo"接続エラー"; exit; } // データベースを選択 if(!mysql_select_db("db_test",$con)){ echo"データベース選択エラー"; exit; } // DELETE文を実行 $sql = "delete from tbl_test where '番号'= 番号; if(!$res=mysql_query($sql)){ echo "SQL実行時エラー"; exit; } // データベースから切断 mysql_close($con); // 登録完了メッセージの表示 echo "削除完了"; ?> </body> </html> どういう風にpostで渡せばいいですか？
すいません。1つ教えて頂きたいことがあります。 http://mysqlweb.net/category/4005373-1.html このファイルを参照してCSVを取り込もうとしていますが、何度やっても1行しか取り込まないです・・・。 Warningが出て、メッセージは Non-ASCII separator arguments are not fully supported 　です。 改行コードが悪い、というのはわかりましたが何をどうしたら修正出来るのかわからず 困り果てております。 どなたかこの原因を解消する方法をご教授下さい。。。 よろしくお願いいたします。
データベースのテーブル内容をサーバー上にcsv出力すると同時に出力した内容を配列で取得できないでしょうか？（PDOを利用しています） $sql= "SELECT id, name FROM tb INTO OUTFILE '/tmp.csv'"; $stmt = $dbh->query($sql); これでcsvは出力されるのですが、csv出力した内容を配列で取得したく、 $array = $stmt->fetchAll(PDO::FETCH_ASSOC); をするとGeneral Errorとなります。 先にSELECTで内容を配列で取得してから配列のループでcsvの内容を作成し、出力する方法もありますが、データ量が数十万件あるのでループ処理が遅い気がしています。 良い方法があればお教えください。 よろしくお願い致します。
MySQLの複合インデックスに関して質問させて頂きます。 現在検索条件に3つのカラムを使用して検索をかけているSELECT文があります。 データの件数は100万件ほどあるとします。 【例】 「SELECT * FROM test WHERE a = '1' AND b = 'xxxxx' AND c = '1';」 カラム「a」「c」は、0と1のみが格納されたカラムで、頻繁に更新されます。 カラム「b」は、同じ値が入ることがありますが、ほぼユニークな文字列が格納されます。 上記のような場合、インデックスは ・「a,b,c」の全てを設定した複合インデックスを作成するべきか。 ・cは頻繁に更新されるので、「a,b」のみの複合インデックスを作成するべきか。 ・aも同じく頻繁に更新されるので、WHERE句の検索順をbを先に持ってきて、「b」のみの単独インデックスを作成するべきか。 一概にこうだという答えは無いかもしれませんが、何か良い方法があれば教えて頂けると幸いです。 また、質問に不備な点がございましたら、ご指摘お願いいたします。
いま下記のソースで一覧画面が表示されます！ 氏名をクリックしたら別ウインドウで詳細画面を表示させたいのですがやり方がわかりません 参考までに教えてください <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <title>一覧画面</title> </head> <body> <BLOCKQUOTE> <BR>一覧画面<BR><BR> <?php $con=mysqli_connect("localhost","root","password","db_test"); // Check connection if (mysqli_connect_errno()) { echo "Failed to connect to MySQL: " . mysqli_connect_error(); } $result = mysqli_query($con,"SELECT * FROM tbl_test"); echo "<table border='1'> <tr> <th>番号</th> <th>氏名</th> <th>住所</th> </tr>"; while($row = mysqli_fetch_array($result)) { echo "<tr>"; echo "<td>" . $row['番号'] . "</td>"; echo "<td>" . $row['氏名'] . "</td>"; echo "<td>" . $row['住所'] . "</td>"; echo "</tr>"; } echo "</table>"; mysqli_close($con); ?> <BR><BR><BR> <A HREF="http://localhost/regist.php"> <INPUT TYPE = "SUBMIT" VALUE = "新規登録"></A> </BLOCKQUOTE> </body> </html>
実は、かなり悩んでいるため、助けて(教えて)いただけないでしょうか？ なおMysqlのバージョンは5.5.31です。 ・hoge_test.txtの中身 011010000000009　　　　　043.052927141.3446931 011000000000009　　　　　043.059576141.3581841 011010010000009　　　　　043.036466141.3242842 011010010010009　　　　　043.038999141.3229683 0110100A0020009　　　　　043.037663141.3252133 0110100E0030009　　　　　043.037048141.3238143 ※真ん中の　　　　　の部分は2バイトの空白5文字。。。 先頭の11桁分は、数字+A～Z、 test6とtest7にあたる部分には、43.059576や141.358184などといった 小数点(少数6桁)のデータがあります。 といったhoge_test.txtの固定長のデータ(改行コードCR/LF)があるとき、 CREATE TABLE `hoge_test`.`hogehoge` ( `test1` varchar(11) DEFAULT NULL, `test2` varchar(3) DEFAULT NULL, `test3` varchar(1) DEFAULT NULL, `test4` varchar(5) DEFAULT NULL, `test5` varchar(1) DEFAULT NULL, `test6` varchar(9) DEFAULT NULL, `test7` varchar(10) DEFAULT NULL, `test8` varchar(1) DEFAULT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC; 上記のように定義して、以下のような形で取り込んでみました。 ※小数点部分はDOUBLEを使うのもありですが・・・うまくいかなかったので文字列として取り込むことに set character_set_database=sjis; LOAD DATA LOCAL INFILE "hoge_test.txt" INTO TABLE hoge_test.hogehoge FIELDS TERMINATED BY '' OPTIONALLY ENCLOSED BY '' LINES TERMINATED BY '\r\n' ; 上記を実行すると、こんな感じのような形となります。 '01101000000', '271', '6', '1', '', '', '', '' これを以下のようにしたいのですが、 そももそLOAD DATA で、このような固定長データを読み込むは難しいのでしょうか？ オラクルでいうところのPOSITION句で各項目のレコード上の位置を指定はできないのでしょうか？ http://oracle.se-free.com/utl/C2_kotei_load.html それとも単純に私の定義や取り込む方法がマズイのでしょうか？(だから取り込めないんだと思っていますが。) 最終的に、どうしたいかというと、以下のような形で、各カラムにデータが入ればＯＫです。 '01101000000','000','9','　　　　　','0','43.052927','141.344693','1' そのままLOAD DATAで取り込みたいですが、この際元データをsedなどのlinux系標準のコマンドで カンマ区切りやタブ区切りに変換して、LOAD DATAで読み込んでも構わないです。 (ただエクセルで操作してというのは無しでお願いします。) ※データ量としては、200Ｍ単位です。 hoge_test.txtを　sedで○○○○○で置き換えて、定義とLOAD DATAで、○○○○○で こういう風に○○○○○書けば取り込めばできるよ みたいな形でコードを教えていただけると助かります。 お手数をおかけいたしますが、よろしくお願いいたします。
MySQLのストアド（プロシージャ/ファンクション）でテキストファイルを削除する方法を探しています。 テキストファイルは、他のファイルでも構いません。 テーブルにデータがINSERTされた時に実行されるストアドです。 system rm -f 'ファイル名'; によるファイルの削除を試みましたが、エラーが発生します。 可能であればストアドからファイルを削除したいですが、難しいようでしたら上記の条件を満たす限り、どのような方法でも構いませんので、教えて欲しいです。 各バージョンは最新バージョンとします。 大変困っていますので、どうかご協力を、宜しくお願い致します。
MySQLの文字コードをsetコマンドで変更した後、再度ログインし直すと 元の設定に戻ってしまいます。 他にやるべき作業があるのでしょうか？よろしくお願いします。 mysql -u root show variables like "chara%"; set character_set_server=utf8;　 show variables like "chara%";　←変更されている exit mysql -u root show variables like "chara%";　←元に戻っている version 5.1.73
「CONCAT」使ったLIKE検索はできるようになったのですが、まだできない事があり質問。 東京都新宿区大久保2-26 という住所があり、下記のようにカラム展開されているとします。 東京都 | 新宿区 | 大久保 | 2 | 26 | これを「新宿区大久保2-26」で検索する場合です。 東京都 | 新宿区 | 大久保 | 2 | -26 | としておけばCONCATでまとめて検索できますが、先にハイフンを入れておく事に不自然さを感じます。ハイフンなしだと東京都新宿区大久保226でもヒットしてしまうし。 なにか対処方はあるのでしょうか？
こんにちは。 今phpとデータベースを勉強中でしてそれを使ったウェブサイトを作りました。 画像とその画像の説明文をいろんな条件で並び替えるサイトです。 プログラム自体はできあがったのですが、文章はデータベースに入れるとして、画像も できたらデータベースに入れたいと思い調べてみると入れる事はできるようです・・。 ただ画像の量が多く最終的には5000枚-10000枚くらいになりそうです。 複数の条件で並び替え→表示とする場合、データベースに画像を入れる場合と、サーバにそのまま置く場合では結果表示速度に差ってでるものなのでしょうか・・。（そのサイトを数十人が一度に並び替えをすると仮定して） どこかのサイトに画像をデータベースに入れるとかなり遅くなるというような事が書いてありました。 事実でしょうか？ 質問の意味が分かりにくいかもしれませんが詳しい方いましたらご回答いただけると助かります。
よろしくお願いいたします。 PostgreSQLの、 CREATE TABLE global_points ( id SERIAL PRIMARY KEY, name VARCHAR(64), location GEOGRAPHY(POINT,4326) ); というSQLの、最後の location GEOGRAPHY(POINT,4326) というところを、MySQLで、実装しようとしているのですが、MySQLにも、地理情報に関する命令はあるようですが、どうすればよいのか見当がつかなく困っています。 どなたか、MySQLでは、こういう風に書くなどのことをご存知の方おられましたら、どんなことでも構いませんので、ご教授願います。
mysql で　 ON DUPLICATE KEY UPDATE 　といれると、 すでに同じプライマリキーのデータが存在した場合アップデートとして 扱われますが、プライマリキーが同じであり、かつ　プラス条件を 課すことはできないのでしょうか？ たとえば、プライマリキーが　５のデータを更新すると すでに、5のデータが存在した場合はアップデートとして扱われるが ただし、ある条件（日付が◯◯日以下等）に反する場合は アップデートも行われない。 というような処理です。
この質問を記事投稿後　やっぱり消したいと思って、消すとします。 この時、サーバーに　「◯◯のアカウントで投稿された◯◯番の記事を削除する」　 というリクエストを送っているのであれば ログインIDはセッション等から読み込むことで書き換えれないでしょうけど 記事番号は POST値やGET値をツール等で書き換えてしまったら 本来消すことのできない記事も消えてしまわないのでしょうか。 つまり　SQLにして UPDATE 　質問テーブル SET 　表示 = 0 WHERE 　アカウントID = 私のID AND 　記事ID = この記事のID←この値を改ざん！ 　 のようなことがおこらないように一般的にどうやって防いでいるのでしょうか？
UPDATE、SELECTで共に同一のテーブルの同一の主キーを指定したWHERE検索をEXPLAINで行ったところ、 SELECTに関してはtype値がconstになり、 UPDATEに関してはtype値がrangeになりました。 その他の違いといえば、UPDATEの場合はExtra値がUsing whereになるだけで、他は特に差異がありません。 UPDATEで変更する列にインデックスを作成してみても（WHEREで指定する列も含め）、やはりconstにはなりませんでした。 なぜこのような違いが発生するのでしょうか？ また、UPDATEステートメントでもtype値をconstにするためにはどのようにすればよいでしょうか？ よろしくお願いいたします。
XamppでインストールしたphpMyAdminには インストールされた初期状態では rootユーザーが最初から３つ登録されています。 1.root ホスト 127.0.0.1 2.root ホスト ::1 3.root ホスト localhost ３つとも削除はできないようになっていますが rootユーザーが３つあるのは それぞれ何か特別な役割があるのでしょうか？ パスワードを設定する場合は それぞれ異なるパスワードを設定することになるのでしょうか？ よろしくお願いいたします。
以下のようなテーブルがあります name point date A　1　2014/1/1 B　2　2014/1/1 C　3　2014/1/1 A　1　2014/2/1 B　3　2014/2/1 C　2　2014/2/1 A　2　2014/3/1 B　4　2014/3/1 C　3　2014/3/1 上記のテーブルを name point(2014/1) point(2014/2) point(2014/3) A　1　1　2 B　2　3　4 C　3　2　3 というように並べるにはどのようなSQLを打てばよいでしょうか。 以下のようなSQLを打ってみたらデータ量が多いときになかなか応答が帰ってきません。 SELECT name, ifnull(sum(CASE WHEN date = '2014-01-01' THEN point END),'-') as point(2014/1),ifnull(sum(CASE WHEN date = '2014-02-01' THEN point END),'-') as point(2014/2),ifnull(sum(CASE WHEN date like '2014-03-01' THEN point END),'-') as point(2014/3) FROM tableA GROUP BY name
水平分割（パティショニング/シャーディング）されたテーブルが何十個もあり、それらのテーブルから一気に条件にあうデータを抽出したいです。 このような場合にどのようにSelect文を書けば良いでしょうか？ 自分で作ったものではなく、ただの利用者であるため、分割しないように作り直すなどの根本的な対策はできないです。 なお、使っているDBはMySQLです。
まず、御覧頂きありがとうございます。 早速質問なのですが、 CREATE TABLE `hoge` ( `id` int(8) NOT NULL, `name` varchar(30) NOT NULL, PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO `hoge` (`id`, `name`) VALUES (1, 'hogeA'), (2, 'hogeB'), (3, 'hogeC'), (4, 'hogeD'); CREATE TABLE `test` ( `id` int(8) NOT NULL, `name` varchar(30) NOT NULL, PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO `test` (`id`, `name`) VALUES (1, 'testA'), (4, 'testD'); という値が入ってるテーブルがあるとします。(長くなってすみません) で、 hoge.id と test.id が重複した場合 test.name を表示させたいです。 期待値としては id,name 1.testA 2,hogeB 3,hogeC 4,testD になります。 業務でJoinを使うようなテーブル構造にそもそもしないというのもあり、クリティカルなSQLコードに不慣れで御知恵を借りたく質問させて頂きました。 よろしくお願いします。
mysql初心者です。 3つのテーブルでスケジュールの仕組みを考えていますが Staff→スタッフデータ id　　name 1　　　田中 Sch1→日付出勤 id　　start_time　　end_time　　date　　flg 1　　　9:00　　　22:30　　　2014-03-17　　　1 Sch2→曜日出勤 id　　start_time　　end_time　　dateW 1　　　9:00　　　22:30　　　1 ※dateWは曜日(0～6) 日付出勤優先なので、なければ曜日出勤を出力します。 たとえば、 田中さん (1)日付登録：2014-03-17（月）　09:00-18:00 (2)曜日登録：1（月）　10:00-19:00 (3)曜日登録：2（火）　09:00-18:00 PHP側でやるなら、 for (一週間分回す) { if (Sch1[date]) { 日付設定出力 }else{ 曜日設定出力 } } 全出力した（日付、曜日）データを一個の配列に入れて、start_timeでソートするかで出力する。。 Mysqlのif文かcase文分でどう書いたらいいですか？ 説明が下手ですが、 どなたかご存知の方がいらっしゃれば是非、ご教授ください。
MySQLで下記SELECTレコードを削除したいと思い、 DELETEへ変えたら文法エラーになります。 SELECT * FROM `piyo` AS a LEFT JOIN `hoge` AS c ON a.`hoge_id` = c.`hoge_id` WHERE c.`x_id` =13 DELETE * FROM `piyo` AS a LEFT JOIN `hoge` AS c ON a.`hoge_id` = c.`hoge_id` WHERE c.`x_id` =13 どう書けば良いでしょうか？
ランキングを作成する、効率の良いSQLを教えて下さい。 MySQLで、以下の状態です。 テーブル名： hoge カラム： id,kbn,name,score,flg,date id…自動 kbn…1～4 name…string score…int flg…bool date…年月日 (1)dateが1週間以内のデータのみ (2)flgがtrueのデータのみ (3)kbn毎に、5レコード取得 (4)順位は、点数が重複している場合は同一の順位をつけSQLで生成しn位のフォーマット (5)6レコード以降に同一スコアのデータがある場合は日付が古い順 (6)scoreは、n点のフォーマット (7)該当データが5レコード存在しなかった場合は、順位だけをセットし他をnull 欲しい結果は、以下の状態です。 kbn,順位,name,score 1 ,1位 ,ホゲ,100点 1 ,2位 ,あい, 85点 1 ,2位 ,かき, 85点 1 ,4位 ,くけ, 70点 1 ,5位 ,さし, 65点 2 ,1位 ,すせ, 99点 2 ,1位 ,たち, 99点 2 ,3位 ,つて, 80点 　　・ 　　・ 　　・ 4 ,4位 ,らり, 10点 null ,5位 ,null, null 以上、よろしくお願い致します。
以下のようなテーブルがあります。 そのテーブルの内容と、そのテーブルのあるカラムの件数を条件にして抽出したいのですが、どのように指定すればよろしいでしょうか？ テーブルA id(int) AUTO_INCREMENT, user_id(varchar), price(int), date(datetime) 表示したい一覧 user_id | date | price A | 2014-03-10 10:00:00 | 2600 B | 2014-03-11 11:00:00 | 2720 A | 2014-03-13 12:00:00 | 2500 C | 2014-03-14 15:00:00 | 2860 B | 2014-03-18 13:00:00 | 2450 A | 2014-03-19 19:00:00 | 2550 ・・・ などのレコードがあった場合、 user_idが同じ場合のレコード数が2～5の場合等を抽出したいと思います。 うまく表現できませんが、このような場合の抽出の仕方をわかる方、よろしくお願いします。
質問させて頂きます。 PHPとMySQLを使用して、ユニークな値(10桁ほどの英数文字列)を持ったデータを、DBに大量に登録したいと考えています。1度に1万件ほどを想定しています。 その場合、 先に大量のデータを作成して、1件ずつユニークかのチェック→DBに登録(insert)といった方法や、 1件データを作成→ユニークチェック→DBに登録(insert)を繰り返す方法などあると思うのですが、 どのような方法が比較的DBに負荷をかけずに短い時間で行なうことが出来るでしょうか。 質問が大雑把になってしまい申し訳ありません。 自分なりに調べてはみたのですが、確認したサイトなどによって方法がバラバラでしたので、こちらで質問させて頂きました。 処理以外の部分でも、テーブルやカラムにこういった設定を行なうと良いなど、どのような情報でもよろしいので、ご教授頂けると幸いです。 また、上記の質問内容に不備な点がございましたら、申し訳ございません。 ご存じの方がいらっしゃいましたら、よろしくお願いいたします。
WKテーブルにカラム ID(PK), POSTNO, DATA, FLAGがあります。 POSTID毎にIDで小さい順に並べて2件以上の行にFLAGを1に設定したいです。 以下のようなイメージです。 カンマは実際にはありません。 select * from WK; ID POSTID DATA FLAG 1 1 aaaa 0 2 1 bbbb 0 3 1 cccc 0 →これを1 4 1 dddd 0 →これを1 5 5 eeee 0 6 5 ffff 0 7 5 gggg 0 →これを1 8 4 hhhh 0 9 4 iiii 0 10 4 jjjj 0 →これを1 まず行単位にPOSTID毎の件数が必要と思い以下のselect文を書いてみました。 更にPOSTID毎に上位2件以外を抽出するにはどうすればいいでしょうか。 またはもっと上手いやり方があればご教示お願いします。 select a.ID, a.POSTID, b.CNT from WK a, (select POSTID, ID, count(POSTID) as CNT from WK group by POSTID) b where b.POSTID = a.POSTID order by a.POSTID, a.ID; ID POSTID CNT 1 1 4 2 1 4 3 1 4　この行を抽出したい 4 1 4　この行を抽出したい 8 4 3 9 4 3 10 4 3　この行を抽出したい 5 5 3 6 5 3 7 5 3　この行を抽出したい
MySQLを利用して点数の抽出をしたいと思います。 -------------------------------------- point | -------------------------------------- 9 1 1 5 6 6 3 2 1 9 2 3 8 9 9 4 3 -------------------------------------- というテーブルデータがあったとして、point の存在する順が欲しいのです。 PerlからMySQLを利用しています。その際のSQL文が知りたいです。 point 9 が4件で一番多いので　9 という数字が最初に返り、 point 3 が3件で二番めに多いので　3 という数字が次にかえってくる という風にしたいのですが、可能でしょうか？
Mysqlの件で教えてください。 Mysqlのバージョンは5.6.14です。 +---------------------------------------------------+ |　　juchuu　　|　　keishiki　　|　　　starttime　　　|　　koutei 　　| +----------+-----------+---------------+------------+ | 8830 | 7745 | 2013-12-1 14:24 | 1010 | |　　8830 | 7745 | 2013-12-2　8：30 |　　　1020　 | |　　8835 |　　　7720　 | 2013-12-3　15：20 |　　　1010 ｜ | 8840 |　　 7745　　　| 2014-01-01 8：30 |　　　1010　 | |　　8840 |　　7745 | 2014-01-01 13：30 ｜　　1020 | 上記のテーブルで、 ・keishiki=7745　のデータ ・直近のjuchuuのグループのリスト（4行目と5行目のリスト） を取得する構文を教えてください。 juchuuグループは2行とは限りません。 よろしくお願いします。
・MySQLで一致条件に正規表現を使用することは出来ますか？ ・もし出来るとすればどのようにすれば良いでしょうか？ ■やりたいこと ・aテーブルのurlカラム内容が「/color/★★」だったら「/color/」以下の★★を抽出して、bテーブルのidと一致したレコードを抽出したい ・aテーブルの★★と、bテーブルのidカラムが一致しているレコードが欲しい ・aテーブルのurlカラムには「/color/58」「/color/26」「/hoge/■■」などが入っています SELECT ＊ 　 　 FROM a 　 　　 LEFT JOIN a.url = b.id 　　　 REGEXP '^(/color)'？ 　　　 where a.★★ = b.id
MySQL5に、以下のような月刊雑誌目次データがあります。 mysequenceが通巻第●号、のような数字を表しています。 最新の3号（あるいは6号、12号）だったら 仮想カラム myflg=1と印をつけるSELECT文をご教示 いただけないでしょうか。 データ例では138～236号と途中を省略しまくってますが 実際は1号から数百号まであり、最新の3冊（あるいは6冊、12冊） だったら、 if ($myflag = 1 ){ echo "<img src='./image/最新の3号.gif'>"; } みたいな使い方をしたい次第です、よろしくお願い致します。 select *, (if( select (max(mysequence) - 3),1,0 ) as myflg) from mymagazine みたいな雰囲気かと思いますが、left joinとか難しい照会が 必要でしょうか。よろしくお願い致します。 create table mymagazine ( mycode int(5) unsigned not null auto_increment comment '管理コード', mypubyear int(4) default null comment '発行年', mypubmonth int(2) default null comment '発行月', mysequence int(3) default null comment '号', mysortno int(2) default null comment '巻毎のソート番号', mycategorycode int(2) default null comment '分類コード', mytheme varchar(900) default null comment 'テーマ', primary key( mycode ) ) engine=InnoDB default charset=utf8 auto_increment =1; insert into mymagazine ( mypubyear , mypubmonth , mysequence , mysortno , mycategorycode , mytheme )values(2005,7,138,1,99,''),(2005,7,138,2,1,'サッカー'),(2005,7,138,3,1,'サッカー'),(2005,7,138,14,16,''),(2005,7,138,15,15,''),(2005,8,139,4,1,'野球'),(2005,8,139,5,1,'野球'),(2005,8,139,17,17,''),(2005,8,139,18,17,''),(2005,9,140,1,99,''),(2005,9,140,2,1,'テニス'),(2005,9,140,3,1,'バスケ'),(2005,9,140,4,1,'バスケ'),(2005,9,140,5,1,'バスケ'),(2005,9,140,6,1,'水泳'),(2005,9,140,7,2,''),(2005,9,140,8,14,''),(2005,9,140,9,13,''),(2005,11,142,2,1,'柔道'),(2005,11,142,3,1,'剣道'),(2005,11,142,4,1,'剣道'),(2005,11,142,5,8,''),(2005,11,142,6,2,''),(2006,1,144,2,1,'卓球'),(2006,1,144,3,1,'卓球'),(2006,1,144,4,1,'バレー'),(2007,9,236,2,1,'陸上'),(2007,9,236,3,1,'陸上'),(2007,9,236,4,1,'陸上'),(2007,9,236,5,4,'ソフト'),(2007,9,236,6,5,'');
MySQLのdatetime型カラムに「月」や「日」だけ不明なデータを格納したいのですが、どうすれば良いでしょうか？ ・具体的なパターンは、下記3フォーマットの何れかです ・2013-03-02 ・2013-03 ・2013 ※月日が不明なデータは全体の一部 ■案1 ・不明な日付を0に置き換え格納 ・2013-03-00 ・2013-00-00 ■案2 ・不明な日付を1に置き換え格納 ・2013-03-01 ・2013-01-01 ※本来の日付と見分けがつかなくなる ■質問 ・日付不明が後で判別できるよう、出来れば0で置き換えたい ・MySQL的に問題ないでしょうか？ ・一般的に日付が不明なデータはどのように処理するのでしょうか？ ■環境 ・MySQL ・PHP
同順位を考慮したランクの取得について(1～55位まで) 下記の2つのテーブルがあります。 rankingscoreinfo フィールド名 型 長さ missionid integer 4 NOT NULL name varchar 20 NOT NULL skill integer 4 NOT NULL score integer 4 NOT NULL rankinginfo フィールド名 型 長さ NOT NULL missionid integer 4 NOT NULL name varchar 20 NOT NULL kind integer 4 NOT NULL missionidとname２つのテーブルの共通フィールドです。 この二つを組み合わせて同順位を考慮したスコアランキングを作成したいです。 １位のscoreが３人同点の場合、３人のスコアランキングは１位で次の人は４位になるようにしたいです。 SQLを組んだのですがレコード数が増えるにつれてどんどんSQLが返ってくる速度が遅くなって困っています。 この二つのテーブルの最速のSQLを組みたいのですがどなたか教えて下さい。 とりあえずINDEXは考慮なしでお願いします。 参考までに私が組んだSQLは下記のものになります。 SELECT d.name FROM (SELECT *, (SELECT COUNT(a.score)+1 FROM rankingscoreinfo AS a , rankinginfo as b WHERE a.missionid=10 AND a.skill= 2 AND b.kind = 2 AND a.missionid = b.missionid AND a.name = b.name AND a.score > c.score ) AS score_rank FROM rankingscoreinfo AS c WHERE c.missionid = 10 AND c.score AND c.skill=2 ) AS d , rankinginfo as e WHERE e.missionid = 10 AND e.kind = 2 AND d.skill = 2 AND d.missionid = e.missionid AND d.name = e.name AND d.score_rank >=1 AND d.score_rank <= 55 ORDER BY score_rank
MySQL超初心者です。 現在いろいろストレージエンジンを試しているのですが、テーブル内に格納されているデータのストレージエンジンを調べる方法はないでしょうか？ いろいろ調べてみたのですが、テーブルのストレージエンジンを確認するコマンドにshow table status;がありました。しかしこれでは、データが本当にそのストレージエンジンを使って格納されているかどうかがわかりません。 一覧表示か検索でテーブル内に入っているデータのストレージエンジンを直接参照する方法はないでしょうか？
PHPとMySQLを利用した検索フォームを作成しています。 そこで質問なんですが、2重括弧があればそのカッコ内の単語はすべて検索結果に表れないようにしたいです たとえば、[[test]]というデータがあったとすると、testと検索しても表示されないようにする。 PHPでもMySQLでも構いません。個別に単語を登録する以外でこれを解決する方法はないでしょうか？ よろしくお願いします。
社員の中で直近の1ヶ月に誕生日を迎える社員を抽出し近い日付から順番に表示したいと思っています。 以前ご教示頂いたコードで出来たのですが、少しおかしい点が見つかりました。 現在では下記のように正常に表示されます。 3月2日　　山田 3月15日　菊池 3月22日　田中 しかし、実際に山田の誕生日である当日（3月2日）になると、山田のデータは一番下に表示されてしまいます。 3月15日　菊池 3月22日　田中 3月2日　　山田 コードは下記のようになっています。 $stmd = date('m/d'); $endmd = date('m/d', strtotime('+1month')); $join = $stmd < $endmd ? 'and' : 'or'; $sql="SELECT office.*, (case when date_format(birth, '%m/%d') <= ? then 1 else 0 end) as sw FROM office where date_format(birth, '%m/%d') >= ? " . $join . " date_format(birth, '%m/%d') <= ? order by sw, date_format(birth, '%m/%d')"; これはどのようにすれば当日になっても順番どおりに表示させることが出来るでしょうか？ ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
社員のデータをテーブルに格納しました。 テーブルは下記のようになっています。inが入社年。outが退社年です。退社年が空白の社員は在籍中を表しています。 テーブル名：office nama(VARCHAR型)｜in(INT型)｜out(INT型) 田中｜2003｜2008 加藤｜1995｜2001 桐谷｜2009｜ やりたい事が二点あります。 (1)「2007年に在籍した社員」と指定した場合。上のテーブルでいうと田中のデータを抽出。 「in<2007 AND out>2007」このような指定をすればいいのかと思ったのですが、空白(現在も在籍中)の場合どうすればいいのか分かりません。 (2)「在籍年数が4年以上6年未満の社員」と期間を指定した場合。上のテーブルでいうと田中と桐谷のデータを抽出。 この場合SQL文はどのようにすれば良いでしょうか？ このテーブルのデータの書き方だと難しいでしょうか？難しければもっとこうした方が良いなどアドバイスを頂けると幸甚です。 ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
PHPやMySQLの勉強を兼ねてサッカーチームの試合データをテーブルに格納しました。 テーブルは下記のようにしました。他にもフィールドはありますがとりあえず3つのみ。 左からホームゲーム(H)かアウェーゲーム（A）か。ホームチームの得点。アウェーチームの得点です。 table名：gamedata h_a(VARCHAR型)｜home_score（INT型）｜away_score(INT型) H｜5｜3 A｜2｜1 A｜3｜4 このようなテーブルから「2得点以上5得点未満の試合」を抽出したい場合はどのようなSQL文になるのでしょか？ 上記のテーブルだと「A｜3｜4」このデータだけ抽出されることになります。 問題点だと思うのは下記の二つ。 一つはホームゲームの場合は「home_score」に得点が格納されていますが、アウェーゲームの場合は「away_score」に得点が格納されていることになります。 二つ目はデータがまだ不十分で得点が何も入力されていないデータもあるという点です。こういうデータはスルーしたいです。 ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
登録されているレコードが６カ月または１２ヶ月以内か判定し、TRUEならフラグに１を記すSELECT文をご教示お願いいたします。 MySQL5です。テーブル　mytableに、 (1) myName（氏名、varchar(600)、レコード例：加藤太郎） (2) RegistDate（INSERTした日付、timestamp、レコード例：2005-06-25 09:30:00） と２カラムがあります。 考え方としては照会時に、 「本日のサーバーの月度　マイナス　RegistDateの月度 ≧ 7ヶ月（または13ヶ月）」なら「myFlag=1」ということになるかと思いますが・・・ select case when to_days(now()) - to_days(RegistDate) >=7 then myFlag = '1' from mytable とか、 IF THENなどになろうかと思いますが、よろしくお願い致します。
ワードプレスで作ったホームページをあるサーバーでアップしてましたが 突如エラーが出始めた為、サーバーの移転を考えていますが、その新たな サーバーのphpmyadminを起動して、以前のサーバーからエクスポートした mysqlのデータをインポートしようとしましたが、エラー１０４４というのが 出てきてしまい、困っています。 ホームページ制作に関しては素人中の素人な為、ネット上で解決方法を 模索してみるもののいまいち分からず今に至っています。 とりあえず、ネットで調べた方法の１つでmysqlのデータを見れるようにして CREATE DATABASEから始まる記述を削除してみたのですが、これでも 上手くいかず、、。 他にも調べた結果、Dosコマンドの事やルート権限の事も書かれていましたが、 私には難しく、分からずじまいでした。 どこをどうしたらいいのかさっぱり分からず途方にくれています。 このエラーを解消し、データを上手くインポートするにはどうしたらいいのかを 教えて頂けたらと思います。
エックスサーバーを借りたのですが、phpMyAdminでトリガーが作れません。 そもそもトリガーのタブがなく、データベースを選んでSQLコマンドでトリガーを作成すると、 #1227 - Access denied; you need the SUPER privilege for this operation と出て「SUPER権限がないために実行できない」ようです。 phpMyAdminのトップ画面には「特権なし」と書いていますし、どうすればトリガーを作成できるのでしょうか？ そもそも作成できないのでしょうか？ エックスサーバーのマニュアルにも記載されておらず、ネットで検索しても出てきません。 何かおわかりでしたらお教えください。 どうぞよろしくお願い致します。
お世話になっております。データベースのテーブルの別け方について質問させて下さい。 例えば、会員制のブログサービスを公開するとして、各会員の個人情報を収めるmemberというテーブルを以下のような構成で用意したとします。 （idはURLの一部となるもの） no　　id　　　mail　　　pass　　name　　blog_title 1　　lala　***@***.com　1234　　佐藤　　私の日記帳 2　　tecno　**@***.com　5432　　石田　　明日は何処へ 3　　nonno　**@***.com　9812　　毛利　　音楽大好き 上記は、会員の個人情報と併せ、ブログのタイトルなども1レコードで済むことが出来るので、会員情報とブログの情報も登録したケースです。 対して、以下は会員情報とブログ情報を別けた場合です。 memberテーブル no　　mail　　　pass　　name 1　***@***.com　1234　　佐藤 2　**@***.com　 5432　　石田 3　**@***.com 　9812　　毛利 blog詳細テーブル(member_noとnoで紐付けている） no　member_no　id　　　blog_title 1　　1　　　　lala　　私の日記帳 2　　3　　　　nonno　音楽大好き 3　　2　　　　tecno　明日は何処へ 例えばhttp://blog.sample.com/lala/ というURLにアクセスされた場合、１つのテーブルに情報が収められている場合、個人情報が登録されたテーブルに接続しなければなりませんが、ブログ情報だけを別にしたテーブルを設けていると、個人情報が登録されたテーブルには接続しなくても済むかと思います。 ここで質問させて下さい。 以前、1つのレコードで収まるなら、複数のテーブルを用意する必要はないといった意見を聞いたことがあるのですが、上記のような2つのケースの場合、やはり貴重な情報を含まれたテーブルは、極力、接続機会を減らす方が良いのでしょうか？ 今日まで、1つのレコードで収まるなら複数のテーブルは用意することなく来ましたが、もしかして、 ・2つのテーブルに別けようが、１つが漏洩したら全て漏洩したと同じだ。だから1つにまとめて問題ない。 ・貴重なテーブルは接続機会を減らすべきだ。 というような意見があるのでは？と、意見を伺えればと思い、質問させて頂きました。 お忙しいとは思いますが、ご意見のほど宜しくお願い致します。
こんにちは。 改行を含む文字列「abc改行def」をVARCHAR型のカラムに登録した時に、文字列「改行def」が削除されてしまい困っております。解決方法をご存知の方がいらっしゃいましたら教えて頂きたいです。
PDOを利用してprepareとbindValueでPDO::PARAM_INTなどと型指定をしてINSERTしているのですが、ネットをいろいろ見てみると「型指定をしてもexecute()時に全ての型は文字列として扱われる」と書いています。 これはデータベースの各カラムの型は無視して全て文字列としてINSERTしているのでしょうか？ それともデータベースの型にMySQL側で勝手に変換して値を挿入してくれるのでしょうか？ INSERTした数値を含むデータをprepareでSELECTしてexecute()してみると数値を含めて全てのカラムがstringとして取得しています。 MySQL側ではカラムの型をINTやFROATとして定義しても数値を文字列として挿入するとMySQL側も文字列として扱うのですか？それとも数値に変換されて挿入されますか？ もし文字列として挿入されたらインデックスに影響しますか？ いまいちどうすればいいのかわかりません。 一応 $id = 1; $name = "hoge"; $float = 0.055; $stmt = $dbh->prepare("INSERT INTO REGISTRY (id, name, float) VALUES (:id, :name, :float)"); $stmt->bindValue(:id, $id, PDO::PARAM_INT); $stmt->bindValue(:name, $name, PDO::PARAM_STR); $stmt->bindValue(:float, (string)$float, PDO::PARAM_STR); としています。 あと、PDO::PARAM_FLOATはないみたいで、PDO::PARAM_STRにすべきと書いていますが、このように指定してもMySQL側で勝手にFLOAT型に変換して値をINSERTするのでしょうか？ どうぞよろしくお願い致します。
以下の様なテーブルとフィールドがあります。 ============= テーブル：words //英単語と意味です フィールド：word(主キー),meaning テーブル：examples //例文です フィールド：word(主キー),example ============= 入っているデータは、 ============= [words] word, meaning -------------- woman,女性 big, 大きい shoes, 靴 [examples] word,example -------------- woman,This woman wears big shoes. ■ ■ ============= exampleテーブルのexampleフィールドの「This woman wears big shoes」に含まれるbigとshoesを 自動的にwordsテーブルから抜き出して■の位置に 【big,This woman wears big shoes.】　 【shoes,This woman wears big shoes.】 とexampleテーブルに付与したいのですがなにかいい方法はありますでしょうか。 すでに入っているwomanは抜きたいです。 もしかしてデータベースの構造がおかしいかもしれません。出来ればご享受願えればと思います。
環境 OS:windows8 XAMPP：ver1.7.3 ウィルスソフト：市販のものは使ってません。 状況： 同じPCで以前まで使えていたのですが、windows8の自動更新の影響かわかりませんが、 XAMPPを立ち上げて、Apacheはスタートボタンを押して「Running」のステータスに かわりますが、MySqlはスタートボタンを押して「Running」のステータスに 変わりません。。 MySqlはスタートボタンを押したその後の ステータスは 「MySql started busy...」 となります。 どなたか同様の問題で解決された経験の方がいらっしゃいましたら お知恵をいただければ幸いです。 よろしくお願い致します。
ただいま以下の一つのテーブルを正規化しようとしています。 テーブル：英単語 フィールド：単語、意味1、意味2、意味3、品詞、分類1、分類2、分類3、例文、難易度、ID（主キー・オートインクリメント） これを以下のように分けました。（分類とは単語の分類です。例えば year なら意味は 年 で分類は 時間 とか 単位 とか属性を入れたいのです。） ＊＊＊＊＊＊ テーブル：英単語 フィールド：単語、意味1、意味2、意味3、分類ID、分類ID、分類ID、例文ID、難易度、ID（主キー・オートインクリメント） テーブル：分類 フィールド：分類名、ID（オートインクリメント　主キー） テーブル：品詞 フィールド：品詞名、ID（オートインクリメント　主キー） テーブル：例文 フィールド：例文、ID（オートインクリメント　主キー） ＊＊＊＊＊＊ (1)これで正規化できているでしょうか？ もしできていないなら、どうすればよいでしょうか？ (2)また、仮にこのままデータベースを作るとすると、INSERTの時に英単語テーブルの分類IDに、分類テーブルのIDをひもづけるにはどうしたら良いのでしょうか？ INSERT INTO 分類 (分類名) VALUES("時間") のあと、オートインクリメントされたIDを取り出して、英単語テーブルに入れるにはどうしたらいいでしょうか。
SELECT文で質問があります。 商品情報を格納したテーブルを作成し、「商品名を検索するとその商品番号を取得する」という単純なSELECTですがうまくいきません。 ■tb_items　→　商品情報を格納しています。 -------------------------------------------- 商品番号　サイズ　重さ 001　　　50　　　120 002　　　30　　　200 -------------------------------------------- ■tb_details　→　店舗毎の情報を格納しています。 -------------------------------------------- 商品番号　店舗番号　商品名　　　　　　　価格 001　　　shop_A　　シャープデジカメ　　50000 001　　　shop_B　　シャープcamera　　　56000 002　　　shop_A　　パナソニックスマホ　85000 002　　　shop_B　　Panasonicスマホ　　 79000 -------------------------------------------- ここで、「商品名を検索するとその商品番号を取得できる」としたいのですが、例えば「シャープ」で検索すると商品番号001を取得できますが、「sharp」で検索すると当然ですが商品番号001は取得できません。 そこでタグのようなものを登録するテーブルをさらに作成しました。 ■tb_tags -------------------------------------------- タグ　　　　　商品番号 sharp　　　　　001 カメラ　　　　 001 スマートフォン 002 携帯　　　　　 002 -------------------------------------------- 試しに「sharp カメラ」を検索してみました。SELECT文は以下のようにしました。 -------------------------------------------- SELECT 　tbI.`商品番号` FROM 　tb_items AS tbI LEFT JOIN 　tb_details AS tbD ON tbI.`商品番号` = tbD.`商品番号` LEFT JOIN 　tb_keywords AS tbK ON tbI.`商品番号` = tbK.`商品番号` WHERE 　( 　　((tbK.`タグ` = 'sharp') OR (tbK.`タグ` = 'カメラ')) OR 　　( 　　　(tbD.`商品名` LIKE '%sharp%') AND (tbD.`商品名` LIKE '%カメラ%') 　　) 　) -------------------------------------------- 取得した結果は、 001 001 というように同じ商品番号を重複して2つ取得してしまいます。 検索を「シャープ camera」にしても重複して2つ取得してしまいます。 やりたいことは、「検索文字列（空白区切りあり）で商品名とタグを検索してヒットした商品番号を重複なしに取得したい」です。 どのようなSELECT文にすれば良いのでしょうか？ お手数ですがアドバイスを頂けたらと思います。 どうぞよろしくお願い致します。
phpmyadminで日本語のデータだけ文字化けしてしまいます。 phpで作成された掲示板からデータをmysqlに投稿し、そのデータを再度掲示板で表示しています。 投稿・表示するphpファイルはutf8で、mysqlのmy.cnfは以下のようになっています。 --------------- [mysqld] datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock user=mysql # Disabling symbolic-links is recommended to prevent assorted security risks symbolic-links=0 character-set-server=utf8 [mysqld_safe] log-error=/var/log/mysqld.log pid-file=/var/run/mysqld/mysqld.pid [mysql] default-character-set=utf8 [mysqldump] default-character-set=utf8 --------------- phpmyadmin（2.11.11）側は、MySQ の接続照合順序:utf8_unicode_ci にしています。 phpmyadminで文字化けしているデータをphpで見ると問題なく表示されてるのが不思議です。 どこが問題なのでしょうか。
プログラム初心者です 掲示板のレスを削除フラグを立てて後からメンテの時に削除するようにしました 将来行う削除する方法なんですが、daleteで行を削除するのではなく、カラムに入っている内容を削除しただけでもパフォーマンスはよくなりますか？残った行はid番号だけにする予定です 例えば100ＭＢの容量が70ＭBくらいになるイメージです それともメンテの時に行を削除したほうがいいでしょうか？ 大体の経験からの判断でいいのでよろしくおねがいします
プログラム初心者です phpとmysqlで簡単な掲示板を作りました 一つのテーブルでsure_idごとにスレッドをつくり、resu_idでレス番号をつくっています そこで削除フラグがある場合にはそのレスを表示しないようにしたいのです 素人なのでこんな方法しか思い浮かばないのですがこれで大丈夫でしょうか？ 5番のスレッドを全て取得し、削除フラグがない行を全て取得 SELECT * FROM bbs WHERE sure_id=5 and dll_flg=0 質問1 削除フラグはどのような立て方が良いでしょうか?0と1でしょうか？ 質問2 削除フラグのカラムにもインデックスを張ったほうが速いですか? 質問3 phpでいちいちif文で判定するよりsqlで表示判定したほうが早いですよね？ よろしくお願いします
こんにちは。 タイトルが上手くまとまっておらず、すみません。 以下のようなことを実現したいと思っております。 カラムc1(INT型)とカラムc2(INT型)をもつテーブルt1があるとします。 「INSERT INTO t1(c1) VALUES(1);」などと実行した場合、自動的にカラムc2が以下のように同一のカラムc1の値同士の中で連番されていくようにするテーブル定義はできないでしょうか。 ↓「SELECT c1, c2 FROM t1 ORDER BY 1 ASC, 2 ASC;」を実行した様子 1,1 1,2 2,1 3,1 3,2 ※ フォントの違いによる形崩れは免れないと思い、CSVのようにカラムの区切りをカンマで、レコードの区切りを改行で表現しています。 言うまでもなく、c1とc2の組は必然的にユニークになります。 ご教授、お願いします。
mysql初心者です 行数を取得したいです 処理をすこしでも軽くしたいです このように書くとテーブルの中身は見に行かないらしいのですが SELECT COUNT(*) AS cnt FROM bbs WHEREをつけると中身を見に行きますか? SELECT COUNT(*) AS cnt FROM bbs WHERE sure_id=5 中身を見に行く場合、カラムを指定したほうが早いでしょうか? SELECT COUNT(id) AS cnt FROM bbs WHERE sure_id=5 よろしくお願いします
今jspファイルでボタンを押すとサーバーにあるデータベースの結果をcsvファイルとして保存するファイルを作りました。 今、作業用のパソコンからテラタームを使い、リモート接続で作業をしています。 なので出力するcsvファイルをサーバーの方ではなく、作業用のパソコンに落としたいのですが、方法はないですかね？ 今はjspのほうでSELECT * FROM テーブル名 INTO OUTFILE のコマンドをmysqlに送っています。 phpmyadminで接続してそこからcsvファイルを落とすと閲覧しているパソコンに落ちるようになってるのでそ それができたらなと思います。 何かいい方法はないでしょうか？ よろしくお願いします。
タイトルの件について、分かる方おりましたらどなたかご教授ください。 [DBサーバ] Linux CentOS 6.4 CPU Xeon core4 SSD 250GB RAM 32GB バージョン情報 MySQL 5.5 tomcat 6 JDK 6 会員データをCSVから大量にUSERテーブルへINSERTする処理を行っています。 また、それに関連するデータも同時にINSERTをします。 (USER_ID を持っている SERVICE_POINTテーブルやADDRESSテーブル) 処理の流れとしては以下となります。 (1) 会員情報の入ったCSVファイルをサーバへアップロード (2) 1でアップロードしたCSVファイルを○○○○件毎に一時ファイルに切り分ける ～～ ここからバックグラウンドで実行 ～～ (3) 2で切り分けたファイルをループで回しながら、メアドの重複やフォーマットエラーなどを判定する (4) 3でエラーがあれば即座にERRORSテーブルにエラー詳細をINSERTし、コミット＆continue; (5) 3でエラーがなければUSERテーブル・SERVICE_POINTテーブル・ADDRESSテーブルへINSERT処理 (6) その他関連するテーブルへUPDATE処理 (7) 3に戻る ストレージエンジンは全てInnoDBです。 my.cnfのInnoDBの設定は以下の通りです。 innodb-buffer-pool-size = 24G innodb-log-buffer-size = 8M innodb-log-file-size = 1024M innodb_log_files_in_group = 3 innodb_fast_shutdown = 0 innodb_data_file_path = ibdata1:10M:autoextend innodb_file_io_threads = 4 innodb_change_buffering = all innodb_thread_concurrency = 16 innodb_flush_log_at_trx_commit = 2 innodb_max_dirty_pages_pct = 90 innodb_flush_method = O_DIRECT innodb_lock_wait_timeout = 120 innodb_additional_mem_pool_size = 128M innodb_file_format = Barracuda innodb_file_per_table = 1 なお、ERRORSテーブルのINSERTは非常に速いです。 会員数が全くない状態だとスムーズに登録されていくのですが (1秒に15件程度) テーブルが肥大化して20万件を超えると１秒に１件ほどしかINSERTされません。 この速度を少しでも速くしたいなと思っています。 １件ずつコミットしているのには理由があります。 ただ、1000件ずつコミットしても速度はほぼ変わりませんでした。 こういう場合、やはりパーティショニングを検討しなければならないでしょうか。 よろしければどなたかご教授ください。 以上、よろしくお願いいたします。
WEB上でリッチテキストエディッタで入力した内容を そのままデーターベースに保管したいです。 最大文字列などが想像できませんが、かなり文字数が多くなる場合もあると 考えております。 その場合、保管先になるデーターベースの型と値は何を指定しておくと いいのでしょうか。 ご教授いただけると助かります。 よろしくお願いいたします。
たとえば銀行口座に2/4時点で100万円あったとします。 2/10に-10万円 2/25に+20万円 2/27に-1万円 というような感じで、日付と入出金額をDBに入れていきます。 このとき、ある日付時点での残高を表示するにはどうしたらいいでしょうか。 つまり、 2/4　100万円 2/10　90万円 2/25　110万円 2/27　109万円 という結果が得られるようにしたいです。 Excelを使えば簡単ですが、そのほかにもやることがあるのでDBを使っています。
プログラム初心者です テーブルに途中からプライマリーキーを作成することはできますか？ idとゆうカラムを追加で作成して主キーにしようとしたのですがエラーがでます idはint型でテーブルには100行あるのですが全部0になっているのが原因かもしれません このidカラムに1～100まで数字を与える方法はありますか？ よろしくお願いします
商品情報が入ったテーブルが２つあります。 一つは商品のスペックが入ったテーブル　→　tb_spec 一つは商品の種類と価格が入ったテーブル　→　tb_variation tb_spec ---------------- 商品ID, 重量 item001, 100 item002, 150 ---------------- tb_variation ---------------- 色, 商品ID, 価格 赤, item001, 12000 青, item001, 15000 黒, item002, 21000 白, item002, 20000 赤, item002, 23000 ---------------- これを一致する商品IDで内部結合でのSELECTで抽出します。 　SELECT s.`商品ID`, s.`重量`, v.`色`, v.`価格` 　　FROM tb_spec AS s 　　INNER JOIN tb_variation AS v 　　ON s.`商品ID` = v.`商品ID` 結果は、 　Array( 　　[0] => Array ([商品ID] =>item001 [重量] =>100 [色] =>赤 [価格] =>12000) 　　[1] => Array ([商品ID] =>item001 [重量] =>100 [色] =>青 [価格] =>15000) 　　[2] => Array ([商品ID] =>item002 [重量] =>100 [色] =>黒 [価格] =>21000) 　　[3] => Array ([商品ID] =>item002 [重量] =>100 [色] =>白 [価格] =>20000) 　　[4] => Array ([商品ID] =>item002 [重量] =>100 [色] =>赤 [価格] =>23000) 　) というように結果が帰ってきます。 これを、 　Array( 　　[0] => Array ([商品ID] =>item001 [重量] =>100 [色] => Array( 　　　　　　[赤] => Array([価格] =>12000) 　　　　　　[青] => Array([価格] =>15000) 　　) 　　[1] => Array ([商品ID] =>item002 [重量] =>100 [色] => Array( 　　　　　　[黒] => Array([価格] =>21000) 　　　　　　[白] => Array([価格] =>20000) 　　　　　　[赤] => Array([価格] =>23000) 　　) 　) というように商品ID毎の配列で取得できるSQL文は書けるのでしょうか？ 上記と多少配列の構造が変わっても良いのですが、商品ID毎に取得できればと思っています。 どうぞよろしくお願い致します。
OS:Windows server2008 SQL:MySQL server Express(WevPlatformにて自動インストール） WebPlatform2.0を使用しWordpressをインストールする際 「手順2/2アプリケーション情報の入力」 から続行を押した時に Unabele to connect to any of the specified MySQL hosts. System.Exceptionの例外がスローされました データベースに接続できません と出てしまいます。 どこに問題があってこのエラーが出ているのでしょうか 解決方法をご教授ください よろしくお願いいたします、。
1対多で結合する場合に、多が絞り込み条件となった場合のSQLについての質問です。 たとえばカスタムテーブルを使ったSELECT文などで、このような絞り込み条件が必要になると思います。 まずカスタムテーブルの具体例として、たとえばユーザーテーブルがあったとします。 [user_table] id=INT //オートインクリメント user_id=VARCHAR //adminなどのユーザーID文字列 user_pass=VARCHAR //パスワードを保存※ハッシュ化した値 user_name=VARCHAR //山田太郎などのユーザー名 user_mail=VARCHAR //ユーザーのメールアドレス user_description=TEXT //ユーザーの自己紹介文 user_created=DATETIME //ユーザーの登録日 とりあえず、上記のようなデータをユーザーの基本データだとします。 このユーザーテーブルから、たとえば名前を元に検索するのは単純です。 たとえばこのような感じでしょうか。 SELECT * FROM user_table WHERE user_name = '山田太郎' このテーブル構造を変更することなくカスタムデータを追加したい(しかも柔軟に)という要望を実現するために、ユーザーカスタムテーブルを作ったとします。 [user_custom_table] id=INT //オートインクリメント relational_id=INT //user_table.idへの参照 custom_name=VARCHAR //カスタムフィールド名 custom_value=VARCHAR //カスタムフィールドの値 custom_name、custom_valueには、たとえばそれぞれ以下のような値が入るとします。 custom_name、custom_value Birthday 、1998/1/1 CompanyName 、○○株式会社 CompanyTel、000-0000-0000 CompanyAddress、東京都千代田区○○-○○ user_custom_table.relational_idはuser_table.idにリレーションしているとすると、INNER JOINして値を取得する方法は判ります。 ※カスタムテーブルに値がない場合という状況は無視できる仕様です。 たとえば、会社住所が東京都で始まるユーザのみを抽出すると、以下のような感じでしょうか。 SELECT user_table.* FROM user_table INNER JOIN user_custom_table ON user_table.id = user_custom_table.relational_id WHERE user_custom_table.custom_name = 'CompanyAddress' AND user_custom_table.custom_value LIKE '東京都%' ただ、この方法だと、誕生日が○月○日以前で、会社名に○○を含んで、会社住所が東京都で始まり…と検索条件が増えていった場合にINNER JOINがどんどん増えていって、いかにも効率が悪いと思えてなりません。 とりあえず適当に書いてみるとして、以下のような感じでしょうか。 SELECT user_table.* FROM user_table INNER JOIN user_custom_table AS custom_1 ON user_table.id = custom_1.relational_id INNER JOIN user_custom_table AS custom_2 ON user_table.id = custom_2.relational_id INNER JOIN user_custom_table AS custom_3 ON user_table.id = custom_3.relational_id WHERE custom_1.custom_name = 'CompanyAddress' AND custom_1.custom_value LIKE '東京都%' AND custom_2.custom_name = 'Birthday' AND custom_2.custom_value < '2001/1/1' AND custom_3.custom_name = 'CompanyName' AND custom_3.custom_value LIKE '%○○%' もっと効率の良い書き方、一般的にはこういう場面ではこんな書き方をするなど、識者の方から教えを請いたくて質問しました。 ※ちなみにDBはMySQLですが、とくにMySQLに限らない方法で答えを頂ける方がありがたいです。
mysqlのデータを今csvファイルに保存しようとしているのですが、 データの中にcsvファイルに保存しなくてもいい情報と保存したい情報があります。 例えばデータが 姓 　　山田 名 　　太郎 年齢　　 20 住所 東京 学校 東京大学 だったとします。 そこで 姓と名と年齢だけの情報を保存したいとします select * from テーブル名 where 名前 and 名 and 年齢 INTO OUTFILE "ファイル名.csv" fields terminated by ',' これで保存されると思ったのですが、 保存されたcsvファイルは空白でした。 学校が東京大学の人がデータに5人中3人だとして　東京大学の人のデータを取り出したい場合にwhere 学校 = "東京大学"みたいに使うのだろうと思いました。 自分は全員分のデータの中のここでいう姓と名と年齢だけの情報を保存したいです。 なので姓と名と年齢だけの情報を保存したい場合にはどうしたらいいですか？
単純な質問ですみません。 idを例えばアルファベット5～10文字程度にしたVARCHAR(10)とする場合と、tinyintにする場合では検索スピードはどちらが速いのでしょうか？ idの種類は多くても10種類くらいです。 レコード数は50万件くらいあります。 アルファベットのidを数値にするとは、例えば apple → 0 orange → 1 banana → 2 というような感じです。 また、idをもしtinyintにした場合、phpMyAdminなどでレコード表を確認した場合、何のidかわかりにくいですが、これは仕方ないのでしょうか？
mysqlで　SELECT文を作成しています。　 諸事情であるテーブルとテーブルを１対１の関係でプライマリーキー同士でつないでいます。 この時、Aというテーブル　と　Bというテーブルでつないでるとして Aテーブルにあるカラムのみを使ってでソートする場合パフォーマンスは問題なく Bテーブルにあるカラムのみでソートする場合もパフォーマンスに問題はありません。 しかし、Aテーブル　Bテーブルのカラムを組み合せてソートすると パフォーマンスが極端に落ちてしまいます。 これを改善する方法はないでしょうか？
プログラム初心者です mysqlのカラム、varchar(255)に実験で270文字HTMLフォームからmysqlに入れてみました そうしたら、255文字しか保存されていませんでした もしかしたら、PHPで文字数制限しなくてもmysql側のカラムの文字数設定だけでいいのではないかと思ってしまいましたがこれだと不具合とかでてきますか？ データ型のtextも文字数指定できるのでしょうか？ やっぱり、文字数制限はPHPなどでやったほうがいいのでしょうか？ よろしくお願いします
プログラムど素人です プライマリーキーはつけといたほうがいいでしょうか？ プライマリーキーがないとプライマリーキー以外のカラムをselectするとき遅くなるのでしょうか？ プライマリーキーのカラム名はid以外でもいいですか？ 質問2 phpmyadminからindexを他のカラムにつけた場合はそのカラムにindexつけた後に追加された行も自動的にindexがついていますか？ よろしくお願いします
こんにちは。よろしくお願い致します。 sqlの書き方がわからず質問いたします。 コード10020のaaaaさんについて 年月(ym）別に点数（score）を集計した値と 点数の総合計を一度にまとめて取得したいです。 データの内容は下記のとおりです。 アドバイス頂けますととても助かります。 よろしくお願い致します。 code,name,score,group,ym --------------------------- 10020,aaaa,10,1,201305 10020,aaaa,15,2,201305 10020,aaaa,20,7,201305 10020,aaaa,12,9,201305 10020,aaaa,10,1,201306 10020,aaaa,15,2,201306 10020,aaaa,20,7,201310 10020,aaaa,12,9,201310 10020,aaaa,10,1,201310 10021,bbbb,10,1,201305 10022,cccc,10,1,201305
レストラン、不動産、求人などの検索サイトは多数のチェックボックス検索項目があり、 「OR検索」が多発するため、索引がうまく使用されず、件数が増えるとすぐに遅くなると 思います。 設計上の配慮はどのようなことがあるのでしょうか。 index_merge である程度、効果があるのでしょうか。 http://dev.mysql.com/doc/refman/5.1/ja/index-mer …
プログラム初心者です シンプルな掲示板をつくりました ホームページのトップページに新しく書き込まれたスレッドを表示したいです bbsに書き込まれたらbbsテーブルに行番号を付けてどんどんインサートしていくようにしてます トップページはindex.phpです id （オートインクリメントでつけた行番号） sure_id （タイトルごとのid。これでタイトルごとにまとめています） mes 書き込まれた文章 name 書いた人の名前 time 型はdatetimeです（書き込まれた日付） bbs番号3番のスレ 2番目の書き込み　2013-09-12←これが新着で取得したい値 1番目の書き込み　2013-09-10←なぜかこちらを取得してしまう 下記のようにindex.phpで表示したいです bbs番号3番のスレが2013-09-12 しかしやってみたら新着順にはなるものの3番目のレスの古いほうから値を取得していました SELECT * FROM bbs GROUP BY sure_id ORDER BY MAX(time) DESC LIMIT 1,10 bbs番号3番のスレが2013-09-10 bbs番号5番のスレが2013-09-11 bbs番号6番のスレが2013-09-09 こうなるようにしたいです bbs番号3番のスレが2013-09-12　←最新の書き込まれたスレッドのなかから一番新しい日付を表示したい bbs番号5番のスレが2013-09-11 bbs番号6番のスレが2013-09-09 よろしくお願いします
このジャンルでお願いします。 tbl id　　starttime　endtime　val 1　　　　　0　　　　　　40　　3 2　　　　　160　　　　170　　1 3　　　　　160　　　　190　　2 starttimeとendtimeは「分（160なら60×2＋40で2時40分になります）」で保存してます。 このようなテーブルで、時間毎にvalの平均を出したいのですが、 id　　hour　avg(val) 1　　　　0　　　3　　←　0～1時まで 2　　　　1　　　0　　←　1～2時まで 3　　　　2　　　1.5　　←　2～3時まで 4　　　　3　　　2　　←　3～4時まで ・ ・ 24　　　23　　　0　　←　23～24時まで といった感じで24区間に分けてその区間毎のvalの平均を出したいです。 これはどのようなSQL文になるのでしょうか？ またこのようなSQL文で１度に取得するやり方と、 いったん全行取得してPHPなどでループして平均を計算するやり方とでは レコード数が増えてきた場合にどちらが速いとかはあるのでしょうか？
プログラム初心者です phpとmysqliで簡単な掲示板を作りました。これをスレッド掲示板に変更したいと思っています 質問1 MyISAMの違うテーブルに同時アクセスできるのでしょうか？ bbs1とゆうテーブルに同時アクセスはできないのはわかりますがテーブルを二つに分けた場合どうなりますか？ 例えばbbs1とbbs2とゆうテーブルを作った場合、bbs1とbbs2に同時に書き込まれた場合でもテーブルが違うと書き込めるのでしょうか? 質問2 2chのようにスレッド掲示板にしたいのですが、テーブルは2つで作れると考えました（スレッドとレス）スレッド番号でレスをまとめるやり方です このような1つのテーブルでレスをまとめた場合、複数のカラムにindexをつけると将来100万行とかになっても軽快に動きますか? それとも、スレッドごとにテーブルを作ったほうがいいのでしょうか？ よろしくお願いします
Mysqlでわからないところがあります。 テーブル名はtestで下のようになるとします test clm1 | clm2 ----------- 3 | 1 2 | 1 4 | 1 3 | 2 4 | 2 1 | 2 2 | 2 6 | 2 このときにclm1に2.4.6を含むclm2を出力させたいです。 この場合2.4.6すべてを含んでいるclm2の2が期待する答え（1は2.4しか含んでいないため）です。 どなたかご教授願います。
仮登録から本登録の流れというのは、どの設計になるのでしょうか？仕組みは色々な方法があると思うのですがいまいちイメージがつかめないです。 以下は、私が設計したいと思っている流れです。 (1)お問い合わせフォームまたは電話にてお申込み連絡を承ります。サービスの利用が可能かを確認致します。 ここで基本的な会社の情報をいただきます。メールにて送信。 ↓ (2)メール確認後、ご訪問、電話にてご説明。 弊社担当よりサービスのご案内・利用方法についてご説明させて頂きます。 ↓ (3)クライアントがサービス利用と判断された場合は利用に必要な項目を確認、取得します。 最終的にはどのようなデータベース設計になるのでしょうか。 よろしくお願いします。
単純な質問ですみません。 現在、商品の名前や価格・在庫数を商品テーブルに記録しています。 この商品の価格や在庫数の1年分（365日分）の履歴をデータベースに記録したいのですが、通常はどのような設計になるのでしょうか？ 価格テーブルや在庫テーブルを作って356日分のカラムを作るのが普通ですか？ あと、商品データベースには商品テーブルが一つだけあります。 もし上記のように価格テーブル、在庫テーブルを作るとしたら商品データベースの中に作るのでしょうか？ それとも価格データベースの中に価格テーブル、在庫データベースの中に在庫テーブルを作るのでしょうか？ 長所・短所などがありましたら教えてください。 どうぞよろしくお願い致します。
こんにちは。現在データベースとphpを使ったサイトを作っています。サイト自体は出来上がりまして データベースに情報を登録しているのですが、少し疑問が出てきました。 私の作っているのは例えば情報をデータベースからPHPで出力させ、任意の順番に並べ替えるという サイトなのですが、 （例えば花でしたら「正式名称」や「育て方」などデータベースから出力させ表示させるといった風なものです） しかしこの場合、データベースに情報が全ての情報が入っているため検索にまったくひっかからず、 どうしてよいものか悩んでいます。 他の似たようなサイトを見ていたのですが、そちらもphpでデータベースから出力させているのですが 花の名前+育て方　などで検索すると検索に反映されているようです。 この部分がよくわかりません。データベースから全ての情報を出力させているのは間違いないと思うのですが ・・・。 そのサイトの全てのページのアドレスを見るとphp?というのが含まれています。私のサイトにはそういったものは含まれていませんし、これで何か推測できることってありますでしょうか？
MySQLで改行を含む文を登録したいんですが、改行を改行コードに書き換えて登録したいです。 改行コードはどのように書けばいいですか？ 登録したい文： あいうえお かきくけこ さしすせそ
MySQLで改行を含んだ文を登録したいんですが、ネットを見ると改行を文字コードに変換して1行にしているようですが、これはどういう意味があるんですか？ そのまま改行した文を登録出来るようですが、文字コードにしたものとの違いがよくわかりません。 取り扱い方などの違いを詳しく説明してください。
大変申し訳ありません。本日も質問させてもらったのですが、一部情報（履歴）が不足していて追加で質問させてください。 以下のようなテーブルがあり、価格が異なるところを差額一覧を出したいと思っております。 （先ほどは2名の方に回答頂き、すみませんベスト１０の設定がわからず設定できなくて、すみませんでした。） 【テーブル構成】 商品ID、商店ID、価格（円）、履歴 というテーブルがあり、 商品A、商店１、1000、1 商品A、商店２、1500、1 商品A、商店３、800、1 商品A、商店１、2000、2 商品A、商店２、2500、5 商品A、商店３、1800、3 商品B、商店１、2000、1 商品B、商店２、1700、1 商品B、商店３、2600、1 商品B、商店１、2500、4 商品B、商店２、2000、6 商品B、商店３、2800、7 ・・・（多くの商品データがあります） というデータが格納されております。 商品と商店の区分ごとに履歴の最も大きいものを取り出し　（←追加） 商店１を基準に、商品毎に商店２、３の価格差を大きい順にソートして出したいと考えています。 SQL分ではどのように記載すれば良いでしょうか？ （実際に比較したデータは以下を抽出し）【履歴の古いのは無視】 商品A、商店１、2000、2 商品A、商店２、2500、5 商品A、商店３、1800、3 商品B、商店１、2500、4 商品B、商店２、2000、6 商品B、商店３、2800、7 ・・・（多くの商品データがあります） （今回の場合の希望出力が以下のような感じです。） 価格差、商品名、商店　（←綱目です。） 800、商品B、商店３ 500、商品A、商店２ -200、商品A、商店３ -500、商品B、商店２ ご教授頂けると幸いです。 ちなみに、教えて頂いたSQLをもとに以下のようにやってみましたが、うまくいきませんでした。。。 全くよくわかっていません。少し解説を入れて頂けると幸いです。 ------------------------------------ SELECT a.価格 - b.価格 AS 価格差, a.商品ID AS 商品名, a.商店ID AS 商店 FROM 対象テーブル a INNER JOIN 対象テーブル b ON (a.商品ID = b.商品ID AND b.商店ID = '商店１') WHERE a.商店ID <> '商店１' AND a.履歴 = (SELECT MAX(a.履歴)) AND b.履歴 = (SELECT MAX(b.履歴)) 【←追加】 ORDER BY a.価格 - b.価格 DESC; ---------------------------------------- select t2.価格-t1.価格 as 価格差 ,t1.商品名 ,t1.商店 from テーブル1 as t1 left join ( select 価格,商品 from テーブル1 where 商店=商店1 ) as t2 on t1.商品 = t2.商品 where t1.商店<>商店1 AND a.履歴 = (SELECT MAX(a.履歴)) AND b.履歴 = (SELECT MAX(b.履歴)) 【←追加】 ORDER BY t2.価格 - t1.価格 DESC;
大変申し訳ありません。ほかにも似たようなのがあるのですが、応用が利かずわかりませんので、ご教授頂けると幸いです。 以下のようなテーブルがあり、価格が異なるところを差額一覧を出したいと思っております。 【テーブル構成】 商品ID、商店ID、価格（円） というテーブルがあり、 商品A、商店１、1000 商品A、商店２、1500 商品A、商店３、800 商品B、商店１、2000 商品B、商店２、1700 商品B、商店３、2600 ・・・（多くの商品データがあります） というデータが格納されております。 商店１を基準に、商品毎に商店２、３の価格差を大きい順にソートして出したいと考えています。 SQL分ではどのように記載すれば良いでしょうか？ （今回の場合の希望出力が以下のような感じです。） 価格差、商品名、商店　（←これは当然、出力されない） 600、商品B、商店３ 500、商品A、商店２ -200、商品A、商店３ -300、商品B、商店２ ご教授頂けると幸いです。
このジャンルでお願いします。 t1テーブル id　name 1　　aaa 2　　bbb 3　　aaa t2テーブル id　t1_id　num 1　　1　　　10 2　　2　　　100 3　　1　　　1000 4　　3　　　1 このようなテーブル構成で、 t1のnameが「aaa」 かつ t2のidが最新の行だけnumを合計した数値を得たいのですが、 この例だと、 まずt2テーブルの id　t1_id　num 1　　1　　　10 3　　1　　　1000 4　　3　　　1 が該当して、t2のidが最新の行だけなので id　t1_id　num 3　　1　　　1000 4　　3　　　1 に絞られて、1000＋1で「1001」という結果が得たいのです。 どのようなSQL文にすれば良いのでしょうか？
以下のようなテーブル table1 があります。 ******************* table1 ******************* Name, Kyouka, Score, ID ******************* 山田, 国語, 92, 10001 鈴木, 国語, 71, 10002 田中, 国語, 89, 10003 山田, 数学, 65, 10004 鈴木, 数学, 69, 10005 杉田, 英語, 96, 10006 山田, 英語, 63, 10007 田中, 英語, 76, 10008 ... ******************* カラムIDはPRIMARYを指定しています。 カラムScoreはインデックスを作成しています。 このテーブルで、「IDと教科」を指定したときに、以下の2つのデータを得たいと思っています。 (1) IDに対応する名前と、その教科中の順位 (2) その教科のレコード数 具体例としては、例えば「ID=10001、教科=国語」を指定したときに、「山田、3人中1位」というような情報が得たいです。 （「ID=10001、教科=英語」のようなおかしな組み合わせは指定しないようになっています。） (1) は、以下のようにして名前と順位を得る事が出来ました。 SELECT Name, (SELECT COUNT(*) + 1 FROM table1 b WHERE b.Score > a.Score and Kyouka='国語') AS rank FROM table1 a WHERE ID='10001' ORDER BY Score DESC; (2)は、以下のようにして特定の教科のレコード数を得る事が出来ました。 SELECT COUNT(*) FROM table1 WHERE Kyouka='国語'; しかし、実際にはレコード数が大量にあり、頻繁にこの検索を実行する予定なので、負荷が心配です。 出来るだけサーバーの負荷を減らすために、1回のSELECT文の実行で(1)と(2)をどちらも実現できるような方法はないでしょうか。 また、このテーブルでインデックスを作成しているのはIDとScoreのみですが、より負荷を減らすにはKyoukaにもインデックスを作成した方が良いでしょうか。 何卒、よろしくお願いいたします。
Canvasを使ってweb上にグラフを表示するサイトを作成したいです。 作りたいグラフのデータは項目が20あり、個数は1700以上あります。 外部であらかじめ作成したデータファイルを読み込む形式で作成したいと考えております。 CSV形式がよいのか、他の方法がよいのかご教授お願いいたします。
現在古いAccessで住所録の管理をやっていて、ハガキの印刷など帳票の出力にも使ってます。 近々PCを買い換えます、Accessは買い換えずにMySQLに移行しようと考えています。 データとしては問題ないのですが、入出力で困ってます。 特に帳票の出力は何で作ればいいものでしょうか。 というか、皆様何で作っているんでしょうか。 今までAccessだったので、そんなことを考えたこともありませんでした。 アドバイスをお願いいたします。
テーブル名：tb event | artist 23 | hamasaki 23 | hamasaki 23 | smap 24 | speed 24 | smap 上のデータは イベント23で浜崎が２曲歌ってSMAPが１曲歌い、 イベント24でスピードが１曲、SMAPが１曲歌ったようなことを考えます。 このようなデータが与えられたときに 浜崎が出演している回数をランキング形式で表示するのに SELECT artist, COUNT( artist ) FROM tb GROUP BY artist ORDER BY COUNT( artist ) DESC とすると同じイベント23で２曲歌っているので 浜崎は2回カウントされます。 これをイベントごとに１回分までしかカウントしない （参加したイベント数）のような意味でカウントするには どうしたらよいでしょうか？
MySQLでint(11)を良く見かけるのですが、int型最大値は「2147483647」なのに何故int(11)が成立するのでしょうか？ int(10)までだと思うのですが… 括弧内の数字に上限はないのでしょうか？ 単なる表示幅だから、例えば00002147483647でも良い？ それともマイナスを考慮してint(11)？
お世話になります。 MYSQLにて以下のようなtableがあるとします。 id ex_id name count flag time memo 1 1 山田 100 on 10:11 テスト 2 1 山田 80 on 10:12 テスト2 3 2 田中 50 on 10:13 テスト3 4 3 鈴木 30 on 10:14 テスト4 5 3 鈴木 110 on 10:14 テスト5 6 3 鈴木 10 on 10:14 テスト6 このうち、countの数字が高いものから表示したいのですが、 ex_idが重複する場合はその数字が最も高いもののみ表示したく考えています。 目的とした表示結果順は以下です。 id ex_id name count flag time memo 5 3 鈴木 110 on 10:14 テスト5 1 1 山田 100 on 10:11 テスト 3 2 田中 50 on 10:13 テスト3 distinctやgroup byなど色々考えてみたのですが、思ったような挙動になりませんでした。 以上、よろしくお願い致します。
WAMP初級者です。 とある情報を検索するサイトを運営していますが、その検索対象となる元データはCSVで作成し、MySQLへインポートして情報を更新しています。 環境は文字コードutf-8としているので、エクセルで編集したCSVそのままではだめなので、いったんKanjiTranslator（http://www.kashim.com/kanjitranslator/　）を使ってutf-8に変換し、それをインポートするやり方をとっています。 皆さんも、こんな感じでひと手間かけているのかと、ふと疑問に思いましたので、質問させていただきます。 １）CSVでutf-8で保存する方法がある？（調べていますが、なさそうでした。。） ２）KanjiTranslatorなどは使わずに、もとのSJISのCSVから直接utf-8でインポートする方法がある？ ３）エクセルではなくもっと良いのがある？ ちなみに環境はMySQL Server 5.6 Apache/2.2.4 (Win32) PHP/5.4.22です どなたかご存知の方ご教授いただけますと幸いです。
'SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry '2147483647' for key 'hoge' ・「Duplicate entry」と表示されたので重複エラーかと思ったのですが、コードを見ても良く分かりませんでした ・そこで再度検索したら、「'2147483647'」まで含む同じエラーが幾つかヒットしました https://www.google.co.jp/search?q=Fatal+error%3A … ■質問 ・エラーの意味を教えてください ・「'2147483647'」には何か特別な意味があるのでしょうか？ ※エラー見た時は、'hoge'カラムに「'2147483647'」があって、それが重複されていると思っていたのですが… ■環境 ・MySQL
MySQLは「5.1」をCentOS5.8上で使っています。 - date,station 2013-11-01,urawa 2013-11-01,omiya 2013-11-01,omiya 2013-11-02,omiya 2013-11-02,akabane 2013-11-02,ikebukuro 2013-11-02,omiya - 日付ごとのdistinctなstationの個数について、 1ヶ月分の合計数を出すためのSQLを作りたいと思っています。 上の例で言うと、 2013-11-01はdistinctなstationは2個 2013-11-02はdistinctなstationは3個なので、 2013-11分の合計として、 「5」個という数を出したいと思っています。 - select count(distinct station) from table_name where date like '2013-11-%' - とすると日付の区別もなく、 固有のstationの個数として「4」個と出てきてしまい、 どうしていいか分からないでいます。 どんなSQLを作れば、 日付ごとの「distinctなstation数」の1ヶ月分の合計値を出すことが出来るでしょうか。 教えていただけますと幸いです。
お世話になります。 よく他のサイトなどで見かけるカテゴリ分けの際にそのカテゴリに属する件数を表示する際、下記のどような方法が賢いのでしょうか？ 【例】 登録されている不動産データ（1万件前後とします）を県別でカテゴリ表示 ・東京都（1,234） ・神奈川県(987) というように表示をしたい。 【方法１：】 データを追加・変更をする時点で、変更前のカテゴリの個数から-1、変更後のカテゴリの個数に+1をしてUPDATEで変更する 【方法2：】 定期的にcronでカウントするプログラムを走らせる ⇒ただこの方法だと実際の件数とCronが走るまでの間に個数に差が発生してしまう問題がでてしまう。 【方法3：】 ページを読み込む際に、count(*)で数える 【方法1】で作っていましたあ２つのカテゴリにまたがる場合（東京都、神奈川県両方）もあり、このとき【方法1】での処理が難しく質問をさせて頂きました。 上記以外にも何か良いカテゴリ件数の表示方法がありましたらアドバイス頂けますと幸いです。
すいません。初めてデータベースを扱うのですが、今までローカル環境でしか動かしていないため どのように実際に動かすのか分からない部分があります。（サイトは完成していましてローカル環境ではちゃんと動きました） まずデータベース名やアカウント名なのですが、データベースのためにさくらのサーバーを借りました。 データベースの設定画面を見ると以下のようになっています。 ----------------------------------------------------- データベース バージョン: MySQL 5.5 データベース サーバ mysql9999.db.sakura.ne.jp データベース ユーザ名 (初期アカウント名) abcd777 接続パスワード変更 ************ データベース名 abcd777_data ------------------------------------------------------- 上記の場合以下で合っているのでしょうか？ $pdo = new PDO("mysql:dbname= _abcd777_data ; host=mysql9999.db.sakura.ne.jp", "abcd777", "************"); ポート番号なども設定があるような事も書いてあるサイトがあるのですが何をどうしてよいのか 全く分かりません。（とりあえず上記のような設定でデータベースからデータをphpで呼び出しましたが 上手く動きませんでした） もう一つ疑問があるのですが、私はトップページをindex.phpとしましたが、上記のような方法では アカウントやらパスワードが丸見えですよね？ そもそも私は全く違う事をしているのでしょうか？ できれば実際の運用の流れも簡単に書いてもらえると助かります。
お世話になります。 VB.NETでウェブアプリ開発をしようと、以下の環境に、(1)～(4)の手順で環境を作成しました。 作業環境：Win7 x64 Pro（仮想マシン） 使用ツール：Visual Web Developer2010 MySQL：5.6.15 Conector/NET：6.7.4 (1)Visual Web Developer2010　をインストール (2)SQLServerではなく、MySQLが使いたい為、別途MySQLをインストール (3)データベース：TEST_DB　と、テーブル：t_sample を作成 (4)mysql-connector-net-6.7.4.msi　　をダウンロードし、インストール。 　（Select Platform:Microsoft Windows) 環境作成後、 Visual Web Developer2010　を起動し、プロジェクトを新規作成し データベースエクスプローラーより、接続の追加を選択し、 データソースの選択　ダイアログを開くきましたが データソース一覧に、MySQLが表示されず、接続が出来ません。 .net、MySQLで検索をしますと、多くの参考資料が見つかります。 その殆どが、「Conector/NETのインストール」だったのですが、 他にも何か必要なもの、あるいは操作が必要なのでしょうか？ もしくは、手順上に誤りがあるのでしょうか？ ご教授くださいませ。
表題の通り、MySQLでカラムの論理名を取得する方法を探しています。 show full columns from table; でやってもダメでした、、、
タイトル通りですが、windowsで特にいじりません。 バックアップとして置いておきたいだけです。 置いてリストアなどでLinux側へ配置後実施の流れをとる場合、何か問題があるでしょうか。 [環境] Linux:CentOS6.3 windows:windows server 2003 mysql:mysql2 よろしくお願いします。
MySQL Version 5.1.41 このジャンルでお願いします。 例えば地名を格納する テーブル「area」 +------+-------+ |　id　|　name　| +------+-------+ |　1　|　渋谷１丁目| +------+-------+ |　2　|　渋谷２丁目| +------+-------+ があったとします。 次にその上位？（これらの丁目を包括する）データが必要なった場合に 新たにテーブルを作ってその外部キーをテーブル「area」に新たに追加する方法が良いのでしょうか？ テーブル「grouparea」 +------+-------+ |　id　|　name　| +------+-------+ |　1　|　渋谷区| +------+-------+ テーブル「area」←このテーブルの列構造をその都度変える +----+---------------+-----------+ |　id　　|　grouparea_id　　|　　　name　　| +-----+-------------+-----------+ |　1　　|　　　　　　1　　　　|　渋谷１丁目| +-----+-------------+-----------+ |　2　　|　　　　　　1　　　　|　渋谷２丁目| +-----+-------------+-----------+ でもこれだとさらにその上位概念のエリア「東京」や「東京」は 「関東」、あるいは「東日本」といった具合に追加したくなった場合に、 順番的に「grouparea」テーブルの先に「ken」テーブルを追加してて 後に「grouparea」テーブルを追加したくなったら テーブル「ken」 +------+-------+ |　id　|　name　| +------+-------+ |　1　|　東京都| +------+-------+ テーブル「area」 +----+---------------+-----------+ |　id　　|　　　　　ken_id　　|　　　name　　| +-----+-------------+-----------+ |　1　　|　　　　　　1　　　　|　渋谷１丁目| +-----+-------------+-----------+ |　2　　|　　　　　　1　　　　|　渋谷２丁目| +-----+-------------+-----------+ 次に「grouparea」テーブルを追加したくなったら テーブル「ken」 +------+-------+ |　id　|　name　| +------+-------+ |　1　|　東京都| +------+-------+ テーブル「grouparea」 +----+---------------+-----------+ |　id　　|　　　　　ken_id　　|　　　name　　| +-----+-------------+-----------+ |　1　　|　　　　　　1　　　　|　渋谷１丁目| +-----+-------------+-----------+ テーブル「area」 +----+---------------+-----------+ |　id　　|　grouparea_id　　|　　　name　　| +-----+-------------+-----------+ |　1　　|　　　　　　1　　　　|　渋谷１丁目| +-----+-------------+-----------+ |　2　　|　　　　　　1　　　　|　渋谷２丁目| +-----+-------------+-----------+ このような変更しなくてはいけないですよね？（このような変更が可能なのかは分かりませんが・・・） 自分的にはこのやり方は違うような気がするのですが、 なにか良いやり方や考え方があればアドバイス頂けないでしょうか？
CentOS5.3を使用し、PHPのバージョンを4系から5.3へバージョンアップしたらMySQLの挙動が変になりました。 これまでは、 # mysql -u -p [enter]でパスワードを要求され、パスワード入力後MySQLにログインできていて、 mysql>show databases;を実行するとこれまでのデータベース一覧が当然出てきました。 バージョンアップ後、 # mysql -u -p [enter]でパスワード要求もなくログインされ、 mysql>show databases;を実行すると、 +--------------------+ | Database +--------------------+ | information_schema | test +--------------------+ のみ表示されます。 どうしてこうなったのかわかりません。 PHPのバージョンアップは以下のとおりしました。 以前のPHPバージョンを削除 yum remove php php-* 5.3のインストール # yum install php53 php53-mbstring php53-mysql なお、WordPressをインストールした際にも以前は通常通りインストールできたのですが、 5.3にしてからは 「データベース接続確立エラー」と表示されDBへ接続できないようで困っています。 以前質問させていただいた時に 「MySqlの設定が初期化されたかMySqlも更新されたかです。」とご教授をいただいき、 # ls /etc/my.cnf* を実行したところ、すでに /etc/my.cnf my.cnfが存在しております。 当該サーバーに以前より現存していたDBを使ったサイトの閲覧も可能なので、どうなっているのかわかりません。 緊急性を要し、再度ご質問させていただきました。 大変申し訳ございませんが、ご教授よろしくお願いします。
wordpress目的でxamppを入れて、しばらく利用してたのですが 今日突然apacheのみ立ち上がらなくなりました。 mysqlとftpはOKです。 localhostはみれてます。 ☆環境 ・OS：mac 10.6.8 ・xampp：1.7.3 ・エラーメッセージ： httpd: Syntax error on line 120 of /Applications/XAMPP/xamppfiles/etc/httpd.conf: Cannot load /Applications/XAMPP/xamppfiles/modules/mod_apreq2.so into server: cannot create object file image or add library XAMPP内にmod_apreq2.soというのは無いようです。。。 ☆試したこと ・再起動 ・ポート80がかぶっていることが原因のケースがあるようなので確認しましたが特にスカイプなど利用しておらず無さそうです。 ・「システム環境設定」より「web共有」のon/off 再度インストールはまだしてないのですが、その前に改善方法があらばと、 ご質問させて頂きました。どなたかご教授いただけますと幸いです。
お世話になります。 商品データとカテゴリテーブルをそれぞれ分けたデータベースを作っており、JOINで該当カテゴリ名を抽出しています。 しかし商品によって複数のカテゴリに属する（カンマ区切りで「1,2,3」というように現状格納しています）場合、それらのすべてを拾ってくることは可能でしょうか？ またカテゴリひとつひとつに対して商品データ内にカラムを用意するべきでしょうか？ select `shop`.no, left outer join list_category on `shop`.category=`list_category`.no （現状） どうぞよろしくお願い致します。
すいません。今phpなどを使いウェブサイトを作っているのですが、データベースがどうしても 必要となり、参考サイトなどを見ながら作りました。 ほとんどできたのですが、最後に一部データベースの関数などでわからない事があり困っています。 （正直私はプログラムはphp程度が少し分かる程度で、データベースも単純な使い方しかしない 予定なので参考サイトをざっと見ただけでmysqlの事がほとんど分かりません） ググってそれらしい物を探してはいるのですが、私がやりたい事はデータベースから 件数を取りたいだけです。 取った件数をphpで表示したいのですが、何時間やっても良くわかりません。 申し訳ないんですが取り出した後その件数をphpのechoで表示するまでをサンプルとして書いてもらえませんか？（可能であれば「ここでこのような処理が行われている」とコメントがもらえると助かります） データベース関係はphpと違って初心者用のサイトなども無く、書いてある事がほとんど分かりません。 （ここでSELECT COUNT(*)を使うと教えてもらったのですが、SELECT COUNT(*)でググっても サンプルなども出てきません） $pdo = new PDO("mysql:dbname=aaa", "root"); $pdo->query("set names utf8;"); // ------------------------------------------------ $sql = $pdo->query("SELECT COUNT(*) FROM bbb"); $stmt = $pdo->query($sql); $stmt->execute(); $count=$stmt->rowCount(); echo $count; ----------------------------------------------- $result = mysql_query("SELECT COUNT(*) FROM bbb"); $row = mysql_fetch_assoc( $result ); echo $row;
プログラム初心者です phpとmysqliの手続き型を使っています 簡単な掲示板を作りました MyISAM から InnoDBに変更したいです phpadminから InnoDBにテーブルは変更できました InnoDBを使うときのsqlはMyISAM で使っていたsqlをそのまま使っていいでしょうか?（特に変更するところはないでしょうか？） よろしくお願いします
すいません。今PHPとデータベースを勉強中なのですが、 $st = $pdo->query("SELECT * FROM udon WHERE not abc = '111' limit 5, 10 "); 例えば上記のような絞り込みをした後、絞り込んだ後の数を数えたいのですがそのような 事はできますでしょうか？ 絞り込み後の検索結果が５件以上の場合、残りを「次のページ」などのように分けて表示させたいのですがデータベースの絞り込み後の数を数える方法が分からないため先に進めません。 わかる方いましたら教えてください。
以下のようなSQL文があった場合 SELECT table_a.* FROM table_a LEFT JOIN table_b ON (table_a.id = table_b.aid) これでtable_bを連結したtable_aができると思いますが、table_bのフィールドは id , aid, value となっていた場合、valueが「1」かつ「2」のデータを検索する場合は、どのようにWHERE句を書けばいいのでしょうか。 WHERE (table_b.value = '1' AND table_b.value = '2') ではうまく取得出来ませんでした。 お分かりの方、よろしくお願いします。
表題にUNIQUE制約の値を「更新」する方法とありますが、 正確にはUNIQUE制約が設定された値を「入れ替える」方法について質問します。 あるテーブルに order という並び順（数値）を格納するカラムがあるとします。※このテーブルのプライマリーキーは id とします。 並び順ですので一意な値です。よって、order にUNIQUE制約を設定しています。 例えば 1～5 個のデータ（フィールド）があったとして、並び順も 1～5 あるわけですが、この並び順を入れ替える場合、並び順を格納しているカラム（ order ）にUNIQUE制約があるため、それぞれ UPDATE で上書きすることができません。 つまり、{ id: 1, order: 1 } というデータと { id: 2, order: 2 } というデータの並び順（ order ）を { id: 1, order: 2 } と { id: 2, order: 1 } というように入れ替えようとする場合、並び順（ order ）は一意であるため、UPDATE で上書きができないのです。 できればトランザクション内で処理したいのですが、これらの処理をスマートに更新する方法はないでしょうか。それとも、並び順（ order ）にUNIQUE制約を設定せず、アプリケーション側で並び順（ order ）を一意に保つよう実装するしかないでしょうか。
現在phpMyAdminを利用してデータを入力しています。 初めてで不安な点があるので詳しい方にお聞きしたいことがあります。 □数字の入力について 後から平均を出したり足し算したりする予定ですが、コンマを入れた状態でも演算できますか？入れない方が良いのでしたら、tableに出力するときにコンマを入れて出力できれば良いのですが。 「20,150」「20150」 □名前の入力について 現在は「山田　太郎」というように姓と名の間に全角スペースを入れて一つのフィールドに入れているのですが、これは姓と名で分けたほうが良いでしょうか？ 例えばスペースを入れた状態でサイトの閲覧者がテキストフィールドから「山田太郎」と入力し検索して引っかかりますか？ □改行について 一つのセル？内に改行してデータを入力することはできますか？ 以上の三点です。 ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
お世話になります。早乙女遙佳と申します。 Webサイト上から会員名や点数を入力し、 送信ボタンが押されると、 受け取ったCGI側でDBに書き込み、 今月成績の良かった方、上位3名は○○さんと○○さんと○○さんです というサイトを作りたいと思っています。 データベースは、MySQLを使って学習していますが、 教えていただけますでしょうか？ scoreテーブルとして、以下のテーブルを作っています。 会員の毎月の点数と、先月からの点数の増加分を格納するテーブルです。 ID name score month increment 1 taro 100 11 0 2 jiro 200 11 0 3 taro 50 10 0 4 jiro 250 10 0 /* 今月の点数を求める */ SELECT score AS thisMonthScore FROM `score` WHERE name = 'taro' AND MONTH = '11'; /* 先月の点数を求める */ SELECT score AS prevMonthScore FROM `score` WHERE name = 'taro' AND MONTH = '10'; /* 点数の増加分を書き込む */ UPDATE `score` SET `increment`= 50 WHERE name = 'taro' and month = '11'; 質問１ 上記のUPDATE文では、増分を書き込むために、 `increment`= 50 としていますが、 upScore = thisMonthScore - prevMonthScore `increment`= upScore のように書けたらと思うのですが、できないものでしょうか？ 質問２ WHERE name = 'taro' の様に各会員の氏名を書いていますが、 「すべての会員についてループさせる」 様にはできないでしょうか？ 擬似コードですが memberName = select name from `score`; //会員名の配列 memberCount = select count('name') as cnt from `score`; //会員数 for (i = 0; i < memberCount; i++){ 　thisMonthScore = SELECT score AS thisMonthScore FROM `score` WHERE name = 　memberName[i] AND MONTH = '11'; //今月の点数 　prevMonthScore = SELECT score AS prevMonthScore FROM `score` WHERE name = memberName[i] AND MONTH = '10'; //先月の点数 　upScore = thisMonthScore - prevMonthScore; //点数の増加分 　UPDATE `score` SET `increment`= upScore WHERE name = memberName[i] and month = '11'; //DBの更新 } のようなイメージです。 DBの呼び出し元であるCGIでループを書けばもちろんできるのですが、 SQL文で処理させた方が速いのかなとも思ったりもしたのですが、 通常、どのように書くものでしょうか？ 毎月100件、1年で1000件、10年分で10000件くらいのレコード数になりますが、このくらいであればあまり速度などは気にせずとも良いものでしょうか？ 質問３ 成績の良かった方、上位3名を抽出するにはどのようなSQL文になるでしょうか？ 第一位　taroさん 50点 第二位　jiroさん -50点 第三位　saburoさん -100点 のような感じです。 初歩的な質問で恐縮ですが、 どうぞ、よろしくお願いします。
no | food_id ---------- *1 | 2 *2 | 3 *4 | 1 ---------- food_id | food -------------- **** 1 | バナナ **** 2 | ラーメン **** 2 | いちご ------------ こんな風にIDの対応表みたいな テーブルを作ったとして 今までfood_idみたいなネーミングをしてたのですが 紛らわしいかなと思って名前を変えたいと思いました。 よくあるパターンだと思うのですが どんな一般的にネーミングが考えられますか？
以下の様なデータが、データベースに入っています。 table 映画データ 映画館　　　　映画名　　　　 日付　　　 メモ ------------------------------------- バルト9 　「タイタニック」　　2013-10-16　　※2000円 バルト9 　「E.T」　　　　　　　2013-10-19　　※子ども向け 渋谷東急　「007」　　　　　　2013-10-17　　※R指定 バルト9 　「タイタニック」　　2013-10-17　　※2000円 渋谷東急　「007」　　　　　　2013-10-18　　※R指定 渋谷東急　「アメリ」　　　　 2013-10-20　　※女性向け バルト9 　「E.T」　　　　　　　2013-10-18　　※子ども向け バルト9 　「タイタニック」　　2013-10-15　　※2000円 渋谷東急　「007」　　　　　　2013-10-19　　※R指定 これを映画館 >映画名 > 日付（初めから終わりまでつなげる）の順番で抜き出したいです。 以下のように。 バルト9 　「タイタニック」　　2013-10-15 - 2013-10-17　　※2000円 バルト9 　「E.T」　　　　　　　2013-10-18 - 2013-10-19　　※子ども向け 渋谷東急　「007」　　　　　　2013-10-17 - 2013-10-19　　※R指定 渋谷東急　「アメリ」　　　　 2013-10-20　　　　　　　　　　　※女性向け このようなSELECT文はどう書けばよいでしょうか。 すみませんがよろしくお願いいたします
id place 5　上野 6　銀座 7　銀座 これに対して SELECT place,count(*) FROM tb GROUP BY place ORDER BY COUNT(*) DESC; でplaceのvalueごとのランキング的なものを作成することはできたのですが id place 5　上野 6　銀座,東京 7　銀座,上野 8　銀座 に対して place COUNT(*) 銀座 3 上野 2 東京 1 という表を表示したいのですが、可能ですか？
初心者ではございますが、質問失礼いたします。 下記のようなＳＱＬ文を使っています。 例文： SELECT table1.no, table1.titile, table1.date FROM table1 WHERE ( table1.title REGEXP "りんご" || table1.title REGEXP "みかん" || table1.title REGEXP "ばなな" || ......... AND date > '2013-11-11' ORDER BY table1.date DESC table1.titleから、各単語を含むタイトルを全て表示させるもので、 検索する単語は無制限に増える予定です。 現在の文でも結果など特に問題ないのですが、 コードが長くてこれでいいものかと思い探したところ特になかったため、 良い方法をご存知の方がいらっしゃったら・・・という望みで 質問の方させていただきました。 お時間のある際にでもお教えいただければと思います。 もし、上記に変わる表現がない場合は、無いとお教えいただければ助かります。 何卒宜しくお願い致します。
MYSQLを使っています。 【売上テーブル】 ||　日付　||　金額　|| ----------------- ||　2011/01/01　||　100　|| ||　2011/01/01　||　200　|| ||　2011/01/02　||　600　|| 　　　　　　　　　　・ 　　　　　　　　　　・ 　　　　　　　　　　・ ||　2012/12/31　||　500　|| ||　2012/12/31　||　100　|| SELECT　SUM(金額) FROM　売上テーブル WHERE　日付 BETWEEN '2011-01-01' AND '2011-12-31' GROUP BY DATE_FORMAT(日付, '%Y/%m') で月初から月末のデータを表示させることはできますが、 2011/01/10～2011/02/09を一か月として 以降は 2011/02/10～2011/03/09 2011/03/10～2011/04/09 　　　　　　　・ 　　　　　　　・ 　　　　　　　・ 2011/12/10～2012/01/09 といった感じに1年間のデータを表示させる方法がわかりません。 どうぞ宜しくお願いします。
MySQLの設計について質問があります。 まずDBの設計ですが以下のような場合どのようにすればよいのでしょうか？ 1. 商品情報が数十万件あり、商品DBを作ってその中に全商品を登録するテーブルを作る 2. 各会員が上記の中から自分が扱いたい商品を登録するテーブルが必要 このとき、2.のテーブルは、 　A. 1.のDBの中に作る 　B. 各会員のDBを作ってその中に扱いたい商品のテーブルを作る 　C. 会員DBを作って会員ごとのテーブルを作る のどれが正しいのでしょうか？各会員が扱う商品数も数万～数十万件になります。 どうぞよろしくお願いいたします。
必要に駆られたのでMySQLについて勉強しているのですが、 ファイル読み込みで問題が起こり、詰まってしまっています。 MySQL上で自作したsampledb内にテーブルprefectureを作成し、 そのテーブル内にPrefecture.csvファイル(文字コードshiftJIS)からデータを入力しようと しているのですが、最初の一件しかテーブルに格納されず、他のデータが入らないのです。 以下に入力したクエリ文を掲載します。 create database sampledb　default character set sjis create table Prefecture(PREF_CD INT(3),PREF_NAME VARCHAR(10),PRIMARY KEY(PREF_CD)) LOAD DATA INFILE "Prefecture.csv" -> INTO TABLE Prefecture FIELDS TERMINATED BY"," -> LINES TERMINATED BY"\r\n"; Query OK, 1 row affected, 1 warning (0.08 sec) Records: 1 Deleted: 0 Skipped: 0 Warnings: 1 select * from prefecture +---------+-----------+ | PREF_CD | PREF_NAME | +---------+-----------+ | 　　　　　 1 | 北海道 2 | +---------+-----------+ 1 row in set (0.00 sec) Prefecture.csvについてはこちらのサイト仕様上添付できませんでしたが、 1,北海道 2,青森県 3,岩手県 . . .（以下省略） のように、47都道府県の番号と地名を並べたものです。 独力では解決法を見出せません。 どうかご助力お願いします。
すみません、教えてください(><) mac（ os X 10.7.5）でMAMP+Eclipse+PHPを使って以下のようにMySQLにデータ挿入 mysql_connect('localhost','root','root') or die(mysql_error()); mysql_select_db('mymy'); mysql_query('SET NAMES UTF-8'); mysql_query('INSERT INTO item SET id=1, name="あいうえお"'); をしたのですが、 phpMyadminからデータを確認してみると日本語が文字化けしてしまいます。 （phpMyadminからデータを挿入した場合はちゃんと表示されます。） 色々と調べ、 Eclipseの環境設定でワークスペースの文字コードやphpの文字コードをUTF-8にしたり、 MySQLのmy.cnfファイルの中に以下 [client] default-character-set = utf8 [mysqld] skip-character-set-client-handshake default-character-set = utf8 character-set-server = utf8 collation-server = utf8_unicode_ci init-connect = SET NAMES utf8 [mysqldump] default-character-set = utf8 [mysql] default-character-set = utf8 を追加して再起動し、DBを一旦削除して再度作り直して挿入してみたりとやったのですが、改善されません。 サーバ接続の照合順序 は「utf8_general_ci」として作成しています。 コンソールからMySQLへ接続してDBの文字コードを確認してみると character_set_client | utf8 | | character_set_connection | utf8 | | character_set_database | utf8 | | character_set_filesystem | binary | | character_set_results | utf8 | | character_set_server | latin1 | | character_set_system | utf8 | | character_sets_dir | /Applications/MAMP/Library/share/charsets/ | というかたちになっています。 他にどういった点を改善すればいいのでしょうか？ もうお手上げ状態でどうすることも出来ずにいます。。。
すいません。PHPを初めて勉強して実際にプログラムを作ってみたのですが、 その際データベースについて少し疑問があります。（初めてデータベースやPHPに触るので おかしな質問だったらすみません） 私は自分で撮った写真等を自分のウェブサイトに掲載したいと考えています。 データベースも同時に勉強し、とりあえずウェブサイトの形はできました。またデータベースに 入れるフィールドが8個あります（フィールドというのかカラム名というのかよくわかりませんが・・） さらに写真が2000枚くらいありますのでかなりの量となります。 （写真は今後もっと増えます） 例 写真のファイル名、カメラの種類、日付、季節、場所、カメラの設定、コメント、評価 これを季節や日付、場所など絞込、並び替えなどを訪問者が自由に できるようにしたいと考えています（フォームボタンを設置してラジオボタンなどで 並び替えをするサイトです。並び変えはデータベースで行いループで全てphpで表示します） ただそれに加え、画像の横に以下のような説明欄を設けデータベースから表示させるつもりです。 日付　2013-1-1 場所　海 カメラの種類　*** カメラの設定　*** コメント　********** 例えば　日付なら"日付$ggg"みたいな事になります。つまり以下のようにします。これが一番 更新が楽なのでそうしたいです。ただこの場合だと当たり前ですが5つのフィールドから5つの データを取り出す事になりますし、さらに何千枚もの写真の並び替えも同時に行う事になります。 （並び替えのプログラムなどは省略してあります） $pdo = new PDO("mysql:dbname=*****", "root"); $pdo->query("set names utf8;"); // $st = $pdo->query("SELECT * FROM ******************"); while ($row = $st->fetch()) { $ggg = ($row['日付']); 日付　$ggg 場所　$aaa カメラの種類　$bbb カメラの設定　$ccc コメント　$ddd 表示は1ページに200枚ぐらいと考えていますが、このような事はレンタルサーバーで可能なので しょうか？パソコンの事はあまり詳しくないのですが、普通に考えれば処理できそうにないような 気がしますがどうでしょうか・・。
MySQLでデータベースを作成して、データベース認証させてコンテンツを表示するプログラムを書いているのですが、パスワードやユーザー名をルートディレクトリの外に置いてrequire_onceする意味が今ひとつわからないので教えて下さい。 require_once('../../../DBparameter.php');　//　DBparameter.phpの中にパスワードやユーザー名 として、ルートディレクトリの外にDBparameter.phpを置けば確かに、パスワードやユーザー名を見ることはできませんが、このプログラムが存在するフォルダ内をのぞけるぐらいの詳しい人であれば、このプログラムを見るのは簡単にできると思うんですが、そうすると、 $con = mysql_connect(host, username, password); などとしてデータベースを開き、結局はデータベース内の情報を抜かれてしまうような気がするのですが、どうなんでしょうか？ 確かに、データを抜き取るためのプログラムを他人のドメインにアップロードするのは簡単ではないので、ほとんど無理だとは思うんですが、それならばスクリプト内にパスワードやユーザー名をそのまま書いてもいいのではないかという気がするんです。
01234561 の中に 1 は何個ありますか？ 期待値 2 という文字列に対する関数があったはずなのですが、調べても出てきません。 ご存知の方いらっしゃいましたらお願いします。
データベースについて詳しい方にお聞きしたい事があります。 初心者なので書いている内容におかしな点もあるかと思いますが、よろしくお願いします。 5年ほど前のJavaを習っていて、簡単なデータベースを作ったことはあります。 □現在、会社が違うレンタルサーバーを一つずつ借りています。 A社のサーバー上で作成したデータベースをB社のサーバー上に公開しているサイトから呼び出し、テーブルを一覧表示できるのでしょうか？ □初心者がデータベースを作成するにはphpMyAdminを使用するのが一番良いでしょうか？ 使い方を検索してみたらちょっと難しそうですね。 Javaでデータベースの勉強をしていた時はあらかじめ作ったフォームにデータを入力していくだけだったので、同じような感じのシステムはないかなと思いました。 □現在使用しているサーバーはMySQLが5つ使えると書いています。 既にWordPressでブログ開設していて4つ使用しています。残りは一つ。 野球チームのデータベースを作成しようと思っているのですが、これまでの試合の記録のデータ、これまでの選手のデータのデータベースを作成したいと思っています。 MySQLは残り一つですが、この二つのデータベースを作る事は可能なのでしょうか？二つ必要ですか？ □スマホのサイトも作成しているんですが、PCサイトと同様にデータベースに接続し、一覧表示できるのでしょうか？ スマホでPHPが使えるのかなと思ったので。 ご存知の方いらっしゃいましたらご教示ください。 よろしくお願いします。
プログラム初心者です phpとmysqlで簡単な掲示板を作りました カラムは sure、title、text、time、name selectで同じスレ名をselectします それで取得できたのがこんなかんじになります スレ名(sure) タイトル(title) テキスト(text) 書き込まれた時間(time) 書き込んだ人の名前(name) タイトル(title) テキスト(text) 書き込まれた時間(time) 書き込んだ人の名前(name) このレス一覧に番号を振る方法を教えてください こんな感じにしたいです NO2 タイトル(title) テキスト(text) 書き込まれた時間(time) 書き込んだ人の名前(name) NO1 タイトル(title) テキスト(text) 書き込まれた時間(time) 書き込んだ人の名前(name) よろしくお願いします
・MySQLのGREATESTで、引数のどれかが NULL である場合、NULLを戻さず、それ以外の残りから ( 最大値の ) 引数を戻すことは可能でしょうか？ ・また、GREATEST以外で、同じような処理をするにはどうすれば良いでしょうか？ ・後、MAXとは何が違うのでしょうか？ ■最終的にやりたいこと ・「aカラム」と「NULLを含むbカラム」の最大値基準で、降順表示したい
■前提 ・MySQLの同じテーブル内に、datetime型の「aカラム」「bカラム」がある ■質問 ・この時、bカラムがNULLだったら、aカラムの値をbカラムへコピーするSQL文を教えてください
顧客ごとにテーブルを作る香ばしいプログラムのSQL文を書くことになりました。 user_0001 user_0002 user_0003 user_0004 user_0005 といった具合にどんどん増えていきます。 カラムは仮に id, name, tel が入っているとします。 プログラムの修正は行えません。 通常JOIN句でテーブルの結合を行うと思うのですが、「user_」という文字列を含んでいるテーブルを全て結合せよ！みたいな命令文はSQLで書けるのでしょうか？ 無理、無駄、素直にプログラムで出せ、というアドバイスでも構いませんのでよろしくお願いします。
　ある教本でPHPを勉強中です。 私のパソコンは普通の現代版Wiedowsパソコンですがそのパソコンに、 　XAMPPをインストールして、MySQLを構築しました。 最初は手探り状態でスタートして、やっと教本の半ばを過ぎました。 　現在、６章を勉強中です。 その６章はMｙSQL（RDB）の、最初に「Webアプリケーションの標準構成」の図がありました。 　図を言葉で表すと 　「各端末 ⇒ Webサーバ ⇔ PHP ⇔ MySQL」 　となります。 　その図を、客観的に見た場合、 Webサーバ ⇔ PHP ⇔ MySQLと別々に書かれているので、 　　３台のパソコンで構築されているように見れます。 　たぶん間違いはないと思うのですが、XAMPPは、「Webサーバ ⇔ PHP ⇔ MySQL」を一台の パソコンで構築できるとの認識で間違いないでしょうか！？ 　教本は「基礎から学ぶ」とは書いてありますが、ページ制限も有るだろうから、詳しくは、解説がありません！？ 　以上よろしくお願いします。 　
PHPとMySqlを勉強し始めたものです。 超初心者ですが、よろしくお願いします。 ＠PAGES（http://atpages.jp/）というサイトを使っています。 ネットで見つけたサンプルプログラムを使って、データベース（MySql）へのデータの入力と読み出しをやってみたのですが、半角英数字なら、読み込みや書き出しはできるのですが、日本語の文字であれば、空白になってしまいます。 プログラムを調べてみると、PHPでのデータベースへの書き込みのときは、ちゃんと日本語の文字を書き出そうとしているようなのですが、「phpMyAdmin」というサイトで書き込まれた情報を見てみると、空白なので、データベース側がデータの受け取りを拒絶したようにも思われます。 サイトで検索して、HTMLの<HEAD></HEAD>のところに下記のような行を入れたり、 <meta http-equiv="Content-Type" content="text/html; charset=euc-jp"> 『mysql_query("SET NAMES 'utf8'"); 』という行をデータの書き込み行の前に入れたりしても、変わりませんでした。 どのようにすれば、日本語もデータベースで扱えるようになるのか教えてください。 よろしくお願いします。
頭の整理ができないので技術的なこともさることながら、SQL構築の考え方もうかがいたいのですが、 以下のテーブルに対して、スペース区切りで複数キーワードをAND条件で結ぶとして ID　MyCol1　MyCol2 -------------------------- 1　いちご　みかんジュース 2　ぶどう　いちごみるく 3　みかん　すいかジュース 4　すいか　めろんソーダ 5　めろん　ぶどうガム 検索フォームに「いちご　ソーダ（※スペース区切り）」と入れたら、IDの1、2、4がマッチするようにしたいです。 スペース区切りで複数キーワードをAND条件で結ぶSQLは、以前教わりました。 http://oshiete.goo.ne.jp/qa/1212708.html $sql = 'select * from t_url'; if ($title != '') { $titles = array(); foreach (preg_split('/(\s|　)+/', $title) as $word) { array_push($titles, "MyCol1 like '%$word%'"); } $sql .= ' where (' . implode(' and ', $titles) . ')'; } 今回の質問は、受け取った$titleを「MyCol1」だけでなく「MyCol1かMyCol2」にも同じ照会する方法をうかがいたいです。 検索キーワードが「いちご　ソーダ」だったとき、MyCol1だけなら、 and (MyCol1 like '%いちご%' and MyCol2 like '%ソーダ%') でよいわけですが、MyCol2はどう熱かったらいいのでしょうか。 and (MyCol1 or MyCol2 like '%いちご%' and MyCol1 or MyCol2 like '%ソーダ%') みたいにできればよいのでしょうが。 PHPのコードも、上記のものだとMyCol1にしか照会がかかりませんが・・・
MySQL5　に年度、通し番号が　格納されており、 select year, number from mytable ・・・と抽出すると以下のようになります。 2005　1 2005　2 2005　3 2008　4 2008　5 2008　6 2008　7 2008　8 2010　9 2011　10 2011　11 2011　112 同じ年度グループ内で、最大となる通し番号の行に「myFlg =1」と付けるSQL文をご教示ください。if とか group by とか as myFlg =1 みたいな記述をするのかなと想像するんですが・・・ PHP5のWHILE文でmyFlg = 1となっている行だけを出力し、上記データ例では、 while ($col = mysql_fetch_array($rst)) { if ($col['myFlg']) == '1') { echo $col['year'] . "年の最大番号は、" . $col['myFlg']. "番"; } } を実行することで、以下のような結果を得ることを期待しています。 2005年の最大番号は、3番 2008年の最大番号は、8番 2010年の最大番号は、9番 2011年の最大番号は、112番 よろしくお願いします。
プログラム初心者です シンプルな掲示板をつくりました ホームページのトップページに新しく書き込まれたスレッドを表示したいです 状況を説明します bbsに書き込まれたらbbsテーブルに行番号を付けてどんどんインサートしていくようにしてます トップページはindex.phpです index.php(トップページ) mysqli（手続き型）のカラム　bbsテーブル id （オートインクリメントでつけた行番号） bbs_id （タイトルごとのid。これでタイトルごとにまとめています） title スレタイトル mes 書き込まれた文章 name 書いた人の名前 time 型はdatetimeです（書き込まれた日付） 例えば、下記のように書き込まれたら 新しい書き込みがbbs番号3番のスレが2013-09-10 12:10:00 新しい書き込みがbbs番号5番のスレが2013-09-10 12:00:00 だとしたら 3番のスレへのリンク 5番のスレへのリンク のようにトップにスレへのリンクを書き込みが新しい順に20くらい表示したいです よろしくお願いします
さくらインターネットや、カゴヤのデータベースサービスを利用しているのですが データをバックアップするにもいつも途中で止まってしまいます。 データは多いテーブルで100万データあります。 効率のよいバックアップ方法、もしくは別サービスのデータベースに移す方法とかありますでしょうか？ よろしくお願いします。
使用環境：mysql　5.1 内容：テーブルに格納されている最後の行数が知りたいです。 テーブル名：seito noname 1tanaka 2suzuki : : 100kato のように1つのレコードに番号を振って名前をつけているのですが、 「seito」テーブルに登録されている最後の番号を取得するSQL文 を教えていただけないでしょうか？ ちなみに、最後が必ず「kato」というわけではないので「seito」テーブルの noカラムにおける最後の番号を取得したいと考えてます。 上記の場合「100」番が取得できれば希望の結果となります。 よろしくお願い致します。
■環境 ・MySQL ■前提 ・テーブルA … idカラム ・テーブルB … A_idカラム ■やりたいこと ・テーブルAデータを取得する際、テーブルAレコードに応じて、テーブルB「A_idカラム」の数(レコード数)も取得したい ■取得イメージ例 ・テーブルA「全カラム」、「count」カラム ※「count」カラム … テーブルBにある「A_idカラム」の数 ■知りたいこと ・どこにも存在しないこの「count」カラムはどうやって作成したら良いでしょうか？ ・全体のSQL文
３つのテーブルを結合させたSQL文について作成方法を教えてください。 よろしくお願いいたします。 【テーブル構成】 テーブル名---項目名/項目名・・・です。 tblA---id/del_flg/name tblB---id/del_flg/add tblC---id/del_flg/family 各テーブルはidによりリンクされます。 tblAのdel_flgは在籍者＝0　退職者＝1で、一人１レコードです。 tblBでは住所管理をしています。 旧情報を残したいので、更新時には新たにdel_flg＝0でレコードを作成し、既存レコードはdel_flg＝1に更新します。 tblCは、既婚者のみ作成されるレコードです。 つまり、tblBとtblCは、レコードが存在しない、あるいはdel_flg＝0のみ、del_flg＝0とdel_flg＝1が混在　のどれかのパターンになります。 【やりたいこと】 いま、これらすべてのテーブルを全部つなげて、在籍している人の情報だけ集めたいのです。 tblAからはdel_flg=0のレコードをすべて取得したうえで、tblBとtblCにdel_flg＝0のレコードがあればその情報も取得したい。 【経過】 select * from (tblA inner join tblB on tblA.id = tblB.id ) inner join tblC on tblA.id = tblC.id とりあえずwhere条件をつけなくても、tblCに存在している人しか取得ができないのです。 where条件も含めて、上記条件のもと、希望するようなSQLの組み立て方をご教授ねがいたいのでよろしくお願いいたします。 できれば、早目の回答が希望です。
さくらのレンタルサーバを利用しています そのサーバにあるphpMyadminの利用での質問です さくらサーバのデータを1レコードCSVでエクスポートした時、テキストエディターで そのデータをみた時、本来、1行で表示されるべき所が複数行になってみえています。 よくみると、さくらサーバ側のあるフィールドで改行して表示させている所が エディター側で改行されているようです CSVにエクスポート時にどこか指定する所がありきちんとみえるようになるのでしょうか よろしくお願いします。
さくらのレンタルサーバを利用しています そのサーバにあるphpMyadminの利用での質問です phpMyadminの検索機能を利用して特定のレコードをcsvデータとして抽出したいと思います 例えば、テーブルaのid=1000の場合の画面表示は次のSQL文で表示されます ------------------- SELECT * FROM `tbl_a` WHERE `id` =1000 ------------------- パソコン側の保存先が C:\Documents and Settings\users\My Documents\SAKURA_DL" とした場合のSQL文はどのように記載すればいいか教えていただけませんか ちなみに 次のように記載してみたのですがエクスポートされません --------------------------------------------- SELECT * FROM `tbl_a` WHERE `id` =1000 INTO OUTFILE "C:\Documents and Settings\users\My Documents\SAKURA_DL" ---------------------------------------------- よろしくお願いします。
先程、次のような質問をして、素晴らしい回答をいただきました。 http://questionbox.jp.msn.com/qa8279886.html しかし、ベストな回答でない事に気付きましたので、再び質問させていただきます。 ちなみに、データベースはMYSQLです。 下記が先程の質問の回答を踏まえて少し質問を変えたものです。 重要なのが☆の部分です。 ************************************************************************ 現在の日時を基準に下記テーブルより直近で空いている日付とその時間帯を求めるSQLを教えて下さい。 下記のjikan_tblは、未来の予定のレコードが登録されています。 １レコード目は、2013年9月27日10時から同日の10時15分までの予定のデータです。 ☆（先程の質問はこちら） 15分間隔で予定のレコードを登録していますが、現在の日時が2013年9月27日の10時の場合、 直近で予定を入れられる時間帯を知りたいのでSQLで同日の10時45分から11時が空いていると取得できればベストです。 ちなみに同日の11時15分から11時30分と取得されてしまうのは、NGです。 ☆（今回の質問ではこちら） 15分間隔で予定のレコードを登録していますが、直近で予定を入れられる15分間隔の時間帯を知りたいので 次のそれぞれのパターンで取得できればベストです。 現在日時：2013年9月27日の8時50分の場合　→　取得時間帯は9:00～9:15 現在日時：2013年9月27日の9時05分の場合　→　取得時間帯は9:15～9:30 現在日時：2013年9月27日の10時00分の場合　→　取得時間帯は10:45～11:00 現時点から直近の15分区切りの時点を求め、求めた時点から直近で空いている15分間の時間帯を求めたいです。 先程の回答では、27日10時現在では、素晴らしい結果がでましたが、現在時間を27日9時と設定しても 10時45分から11時が求められました。 私の質問の書き方が悪かったと思います。 回答していただいた方にお詫びします。 jikan_tbl start datetime, end datetime jikan_tblのレコード 2013-09-27 10:00| 2013-09-27 10:15 2013-09-27 10:15| 2013-09-27 10:30 2013-09-27 10:30| 2013-09-27 10:45 2013-09-27 11:00| 2013-09-27 11:15 2013-09-27 11:30| 2013-09-27 11:40 知恵を貸して下さい。 宜しくお願いします。 os: windows 7 eclipse: Version: 4.2.0 Build SDK: Android 4.3(API 18) PHP 5
現在の日時を基準に下記テーブルより直近で空いている日付とその時間帯を求めるSQLを教えて下さい。 下記のjikan_tblは、未来の予定のレコードが登録されています。 １レコード目は、2013年9月27日10時から同日の10時15分までの予定のデータです。 15分間隔で予定のレコードを登録していますが、現在の日時が2013年9月27日の10時の場合、 直近で予定を入れられる時間帯を知りたいのでSQLで同日の10時45分から11時が空いていると取得できればベストです。 ちなみに同日の11時15分から11時30分と取得されてしまうのは、NGです。 jikan_tbl date_start int(8), time_start int(4), date_end int(8), time_end int(4) jikan_tblのレコード 20130927 | 1000 | 20130927 | 1015 20130927 | 1015 | 20130927 | 1030 20130927 | 1030 | 20130927 | 1045 20130927 | 1100 | 20130927 | 1115 20130927 | 1130 | 20130927 | 1140 難しく調べても分かりません。 知恵を貸して下さい。 宜しくお願いします。 os: windows 7 eclipse: Version: 4.2.0 Build SDK: Android 4.3(API 18) PHP 5
SELECT id (price * 10) FROM table WHERE id IN (1, 2, 3) を、実行すると +--+-----+ | id | price | +--+-----+ | 1 | 100 | | 2 | 100 | | 3 | 100 | +--+-----+ に、なります。 この結果に対してid1には*10、id2には*20、id3には*30というような処理はMySQLで可能でしょうか？ 期待値としては +--+-----+ | id | price | +--+-----+ | 1 | 100 | | 2 | 200 | | 3 | 300 | +--+-----+ です。 よろしくお願いします。
説明下手ですがお付き合いください。 まず table には +----+---+ | id | num | +----+---+ | 1 | 10 | | 1 | 10 | | 2 | 10 | +----+---+ この様な値が格納されており、これに対して SELECT id, SUM(num) FROM teble GROUP BY id; を実行すると +----+---+ | id | num | +----+---+ | 1 | 20 | | 2 | 10 | +----+---+ この様になります。 では、本題です。 上のコマンドで出力した結果に対してさらに 20 <= num のような条件を付加させたいです。 その場合の期待値としては +----+---+ | id | num | +----+---+ | 1 | 20 | +----+---+ です。 書いてて泣きたくなる程説明が下手ですが、よろしくお願いします。
さくらサーバを利用しています そのサーバにあるphpMyadminの利用で質問させてください テーブルAにレコードA1～A1000までの1000件のデータがあります そこに1001件目のレコードを追加したいのですが、フィールドが 700項目程度あり、そこに1項目ごと入力するのが大変なので、 A1～A1000のデータの中から、類似の1つのレコードをCSVでダウンロードして パソコン側でそのデータを修正してアップロードしたいと思います そこでphpMyadminを利用しての次のような手順でデータ操作しようと思っています phpMyadminのメニューにあるエクスポートで該当のレコードをPC側に抽出し そのデータをエクセルで必要な所を修整します そして、A1～A1000にないID番号を振り、そのデータをphpMyadminで インポートさせようと思います そこでお聞きしたいのは この1件のデータをインポートをさせた時、サーバ側にある1000件のデータにプラス されて1001件になるでしょうか それとも、1000件の上にインポートされたデータがかぶせられて、1000件の データがなくなり1件になってしまうのでしょうか 自分では前者のように1001件になると思うのですが万一後者になったら 大変なため質問させていただきました よろしくお願いします。
mysql初心者です phpとmysqliを使っています テーブルhogeにid、gifとカラムがあります gifのカラムを空にしたいのですがこんな感じでいいでしょうか？ mysqli_query($link,sprintf('UPDATE hoge SET gif="%s" WHERE id=%d', "", mysqli_real_escape_string($link,$id) )); よろしくお願いします
タイトル通りです。 VirtualBoxの仮想環境のCentOS内に Apatch+PHP+Mysqlで開発環境を作っているのですが どうにもこうにも文字化けします 症状としては phpmyadminで確認した時、日本語のデータが正しく表示されるが 実際にphpでデータベースから取り出して表示すると???になります。 phpのフォームから日本語を入力してそのデータを表示すると正しく表示されるのですが 今度はデータベース内のデータが文字化けしています。 こちらのスクリプトでは文字化けしないのでPHPの設定ミスではないようです http://tsuttayo.jpn.org/php/char_trn/ phpinfoの情報 DirectiveLocal ValueMaster Value mbstring.detect_orderautoauto mbstring.encoding_translationOffOff mbstring.func_overload00 mbstring.http_inputautoauto mbstring.http_outputpasspass mbstring.http_output_conv_mimetypes^(text/|application/xhtml\+xml)^(text/|application/xhtml\+xml) mbstring.internal_encodingUTF-8UTF-8 mbstring.languageJapaneseJapanese mbstring.strict_detectionOffOff mbstring.substitute_characterno valueno value Mysqlの設定もご覧の通りです Variable_name Value character_set_client utf8 character_set_connection utf8 character_set_database utf8 character_set_filesystem binary character_set_results utf8 character_set_server utf8 character_set_system utf8 character_sets_dir /usr/share/mysql/charsets/ 以下my.cnf [mysqld] datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock user=mysql # Disabling symbolic-links is recommended to prevent assorted security risks symbolic-links=0 character_set_server=utf8 default-storage-engine=InnoDB innodb_file_per_table default-character-set=utf8 skip-character-set-client-handshake [client] default-character-set=utf8 [mysql] default-character-set=utf8 [mysqldump] default-character-set=utf8 [mysqld_safe] log-error=/var/log/mysqld.log pid-file=/var/run/mysqld/mysqld.pid スクリプトはちゃんとUTF-8BOMなしで作っています。 Mysqlのバージョンは 5.5.33です。 PHPのバージョンは 5.4.19です。 PDOのオプションも試しみましたがうまくいきませんでした。 非常に困っています。 回答いただけたら幸いです。
データベース・MySQLの初心者です。 もう一つ教えてください。 下のテーブルで、NO、数値、和算カラムがあります。 NOカラムの１、２の行の数値カラムを足し、 NOカラム２の和算カラムに、結果の３を入れます。 同じように、２行づつ和算を行なうには、どのようにSQL文を つくれば良いでしょうか？ テーブル NO　数値　和算　和算カラムの結果 １　　１　　　null　　null ２　　２　　　null　　３ ３　　５　　　null　　７ ４　　２　　　null　　７ ５　　２　　　null　　４ よろしくお願いします。
データベースの初心者です。MySQLを使用してSQL文を試しましたが、うまくいきません。 わかりやすく教えていただけますか？ 下のような２つのテーブルで、テーブル２の項目カラムに存在するデータが、 テーブル１の区分にあれば、一致する行（NOカラムの５～７）だけに、 フラグ”１”を付けたいのです。（区分カラムに、"*"で始まるデータは除きます） 区分に、データが全て埋まっていれば簡単に出来るのですが、 先頭行のみデータがあって、次の区分まで、Nullが入っています。 テーブル１ NO　区分 フラグ １　　aaaaa　　　null ２　　null　　　　 null ３　　null　　　　 null ４　　null　　　　 null ５　　bbbbb　　 null ６　　null　　　　 null ７　　*nozoku　 null ８　　ccccc null ９　　null null テーブル２ NO　項目 １　　bbbbb ２　　eeeee よろしくお願いします。
XAMPP Version: 1.8.2　です。 　 Xamsのデータベースをデータベースから削除した後 　SQLから、以下2個プログラムを入力しました。 　すると、削除したにも関わらず、エラーが出て プログラムが反映されません。 　Xamsを削除後、再起動したらまたXamsのデータベースが 再構築されます。 　私は作成した記憶はありません。 　すでに存在しているので、作成しする必要は ないのか、よくわかりません！？ 　皆様どう思われますか！？ 　以下入力したプログラムです。 ---------------------------------------------------------------- CREATE DATABASE xmas; USE xmas; CREATE TABLE xmastran ( book_id int not null auto_increment, name varchar(30) not null default '' , org varchar(50) not null default '', addr varchar(80) not null default'', tel varchar(20) default '', mail varchar(40) default '', course varchar(30) default '', nums integer default 0, PRIMARY KEY (book_id) ) ENGINE=MyISAM DEFAULT CHARSET=utf8; エラー 実行したSQL： DATABASEクリスマスを作成します。 のMySQLのメッセージ：ドキュメント ＃1007 - データベース'クリスマス'を作成できません、データベースが存在している -------------------------------------------------- CREATE DATABASE if not exists xmas; USE xmas; CREATE TABLE xmastran ( book_id int not null auto_increment, name varchar(30) not null default '' , org varchar(50) not null default '', addr varchar(80) not null default'', tel varchar(20) default '', mail varchar(40) default '', course varchar(30) default '', nums integer default 0, PRIMARY KEY (book_id) ) ENGINE=MyISAM DEFAULT CHARSET=utf8; エラー 実行したSQL： TABLE xmastranを（CREATE book_idのINT NOT NULL AUTO_INCREMENT、 名VARCHAR（30）NOT NULL DEFAULT''を、 orgのVARCHAR（50）NOT NULL DEFAULT''を、 addrはVARCHAR（80）NOT NULL DEFAULT''を、 電話VARCHAR（20）DEFAULT''を、 メールVARCHAR（40）DEFAULT''を、 もちろんVARCHAR（30）DEFAULT''を、 numsはINTEGERのデフォルトは0、 PRIMARY KEY（book_id） ）ENGINE = MYISAM DEFAULT CHARSET= utf8を; のMySQLのメッセージ：ドキュメント ＃1050 - テーブル 'xmastran'は既に存在します。 ------------------------------------------------------------------- 以上よろしくお願いします。
MySQL 5.1 利用中です。 テーブルに登録されている文字列が以下のようになっている場合 右から1文字だけを削除するSQL文を教えてください 右から「部とか課や/」が削除されるイメージです。 →SQL実行前 name 経理課 営業部 開発部 部門開発部 RアンドD/ →SQL実行後 name 経理 営業 開発 部門開発 RアンドD よろしくお願い致します。
phpを勉強始めたばかりで、データベースを使う必要がでてきたため、初心者サイトを 読んでいるのですが、一点質問があります。 行いたい事は、データベースに保存した画像パスをphpで出力するだけなのですが、パスが 文字列として扱われてしまっています。画像を出力するにはどうすれば良いでしょうか？ 例えば以下のようなphpプログラムで、nameには画像パスである 「abc.jpg」という文字が 入っていたとすると以下ではそのままabc.jpgという文字列が出力されてしまします・・・。 <?php $pdo = new PDO("mysql:dbname=aaa", "root"); $pdo->query("set names utf8;"); $st = $pdo->query("SELECT * FROM bbb"); while ($row = $st->fetch()) { $name = htmlspecialchars($row['name']); echo '<img src="$name">'; } ?>
http://php1st.com/435/ 　にある説明config.inc.phpファイルですが、 $cfg['Servers'][$i]['auth_type'] = 'config'; $cfg['Servers'][$i]['user'] = 'root'; $cfg['Servers'][$i]['password'] = '12345'; ---------------------------------------------- にすると 以下のエラーが出ます。 ＾＾＾＾＾＾＾＾＾＾ phpMyAdmin へようこそ エラー MySQL のメッセージ: ドキュメント #1045 - Access denied for user 'root'@'localhost' (using password: YES) MySQL サーバに接続しようとしましたが拒否されました。config.inc.php のホスト、ユーザ名、パスワードが MySQL サーバの管理者から与えられた情報と一致するか確認してください。 それで ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ $cfg['Servers'][$i]['auth_type'] = 'cookie'; $cfg['Servers'][$i]['user'] = 'root'; $cfg['Servers'][$i]['password'] = '12345';　 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 　にすると、 　phpMyAdmin phpMyAdmin へようこそ 言語 - Language ログインドキュメント ユーザ名:root パスワード：・・・・・ ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ それで 　http://php1st.com/435/ 　にある説明では 　$cfg['Servers'][$i]['auth_type'] = 'config'; 　にしなさいとあります。 しかし、私の場合は、この質問の冒頭にでた同じエラーが出たので、 $cfg['Servers'][$i]['auth_type'] = 'cookie'; 　としたら、 　ちゃんとログイン画面が出るうになりました。 　なぜでしょうか！？ 　宜しくお願いします。　
1日24回（約1時間毎に）米ドルの為替レートを記録したテーブル（米ドルtbl）があり、 内部に数年分のデータが蓄積されています。 取得日時(datetime)　　米ドル為替レート(usd) ----------------------------------- 2012-10-23 23:00:01　　79.45 2012-10-24 00:00:00　　79.38 2012-10-24 01:00:05　　79.40 2012-10-24 02:00:01　　79.41 　　　　・　　　　　　　　　　　・ 　　　　・　　　　　　　　　　　・ このテーブルを使って、各月の米ドルの最大値（最安値）を求めたければ、 select year(datetime) as 年, month(datetime) as 月, max(usd) as 最大値 from 米ドルtbl group by 年, 月; とすれば、 年　　　月　　最大値 ------------------------- 2012　9　　　79.21 2012　10　　80.36 2012　11　　82.76 2012　12　　84.94 2013　1　　　91.38 2013　2　　　94.71 2013　3　　　96.69 という結果が得られるのはわかるのですが、 この結果に更に、その最大値を取得した日時を加えて、 年　　　月　　最大値　　取得日時 --------------------------------------------- 2012　　9　　　79.21　　2012-09-06 15:00:01 2012　　9　　　79.21　　2012-09-13 04:00:00 2012　　9　　　79.21　　2012-09-22 22:00:02 2012　　10　　80.36　　2012-10-24 03:00:00 2012　　11　　82.76　　2012-11-18 22:00:03 2012　　12　　84.94　　2012-12-21 13:00:02 2013　　1　　　91.38　　2013-01-18 20:00:01 2013　　2　　　94.71　　2013-02-14 11:00:00 2013　　3　　　96.69　　2013-03-26 21:00:02 というようなデータを得たいと思うのですが、 どういう構文を書けばいいか、皆目見当がつきません。 その月に最大値の取得日時が何回もあるなら、 上記2012年9月のように、それらすべてが表示されるのが理想です。 どうぞ宜しくお願い致します。
MySQL 5.1 利用中です。 area | number /tokyo/01/ aa1 /tokyo/02/ bb2 /chiba/01/ aa1 上記のようにテーブルに情報が登録されているとします。 やりたいことは、areaフィールドに登録されている 「tokyo」がある場合はnumberフィールドを「東京」の名前を 追加したいと考えてます。 やりたい事の実行結果 area | number /tokyo/01/ 東京/aa1 /tokyo/02/ 東京/bb2 /chiba/01/ aa1 このように処理するには 　UPDATE テーブル名 SET WHERE area LIKE '%tokyo%' = REPLACE(number,'','東京/'); こんな感じかと実行してみたら、やっぱりだめでした、、 何かアドバイスをいただけないでしょうか？ よろしくお願い致します。
商品のデータベースがあるんですが、一つの商品テーブルに複数の店舗の商品をまとめて登録しています。在庫数は店舗別のテーブルで分けているのですが、これをＳＱＬで商品コードで結合ができません。 仮に商品がＡ、Ｂ、Ｃと登録されていたとして、店舗１にはＡとＢの商品があるため２つの在庫数を設定しており、店舗２にはＢとＣの商品があるため２つの在庫数を設定しています。 つまり片方のみの商品もあれば両方に存在する商品があります。 このときにＳＱＬで商品情報を取得する場合に、結合したいのですが結果が0件となり上手く結合ができません。 商品コードがＢのときにＳＥＬＥＣＴ文で両店舗の在庫数を同時に取得したいし、ＡやＣではそれぞれの店舗在庫を取得したいのですが、何か良い方法はないものでしょうか？
http://okwave.jp/qa/q8247435.html 　以上のトラブルの経緯がありまして・・ 次に出たのが以下のエラーです。 XAMPP Control Panel v3.2.1ですが 　気になることがあります。 　以下[Apache]の項目のほとんどが赤文字です。 　これって何か”ヤバイ”ことなのでしょうか!!?? 　よろしくお願いします。 3:32:31 [main] Initializing Control Panel 3:32:31 [main] Windows Version: Windows 7 Ultimate SP1 64-bit 3:32:31 [main] XAMPP Version: 1.8.2 3:32:31 [main] Control Panel Version: 3.2.1 [ Compiled: May 7th 2013 ] 3:32:31 [main] Running with Administrator rights - good! 3:32:31 [main] XAMPP Installation Directory: "c:\xampp\" 3:32:31 [main] Checking for prerequisites 3:32:59 [main] All prerequisites found 3:32:59 [main] Initializing Modules 3:32:59 [Apache] Problem detected! 3:32:59 [Apache] Port 80 in use by ""c:\xampp\apache\bin\httpd.exe" -k runservice" with PID 1108! 3:32:59 [Apache] Apache WILL NOT start without the configured ports free! 3:32:59 [Apache] You need to uninstall/disable/reconfigure the blocking application 3:32:59 [Apache] or reconfigure Apache and the Control Panel to listen on a different port 3:32:59 [Apache] Problem detected! 3:32:59 [Apache] Port 443 in use by ""c:\xampp\apache\bin\httpd.exe" -k runservice" with PID 1108! 3:32:59 [Apache] Apache WILL NOT start without the configured ports free! 3:32:59 [Apache] You need to uninstall/disable/reconfigure the blocking application 3:32:59 [Apache] or reconfigure Apache and the Control Panel to listen on a different port 3:32:59 [mysql] XAMPP MySQL Service is already running on port 3306 3:32:59 [main] Starting Check-Timer 3:32:59 [main] Control Panel Ready 3:33:10 [Apache] Installing service... 3:33:14 [Apache] Problem detected! 3:33:14 [Apache] Port 80 in use by ""c:\xampp\apache\bin\httpd.exe" -k runservice" with PID 1108! 3:33:14 [Apache] Apache WILL NOT start without the configured ports free! 3:33:14 [Apache] You need to uninstall/disable/reconfigure the blocking application 3:33:14 [Apache] or reconfigure Apache and the Control Panel to listen on a different port 3:33:14 [Apache] Problem detected! 3:33:14 [Apache] Port 443 in use by ""c:\xampp\apache\bin\httpd.exe" -k runservice" with PID 1108! 3:33:14 [Apache] Apache WILL NOT start without the configured ports free! 3:33:14 [Apache] You need to uninstall/disable/reconfigure the blocking application 3:33:14 [Apache] or reconfigure Apache and the Control Panel to listen on a different port 3:33:14 [Apache] Attempting to start Apache app... 3:33:26 [Apache] Installing service... 3:33:27 [Apache] Successful! 3:33:27 [Apache] Successful! 3:33:28 [Apache] Status change detected: running
現在IDを主キーとするデータが有り、複数のデータをまとめて書き換える際、 一時テーブルにIDと変更内容を用意しておいて、UPDATE と INNER JOIN を用いて 一気に書き換える予定です。 更新そのものはこれで問題ないのですが、その際に一時テーブルに無いレコードは削除したいのですがどうすればいいのでしょうか？ 参考： http://qiita.com/masuidrive/items/0671ea7efa91a9 …
ALTER TABLEの処理が全然終わらなくなってしまったので、質問させて下さい。 下記のような状態です。 ・テーブルの行数は962362 ・topコマンドで見たとき、普段mysqldのCPU使用率が50～100%なのですが、ALTER TABLE後に確認すると2%前後になる ・試した処理はdrop indexとadd column ・mysqlを再起動しようにもstopするのに数分かかる ・nginxを一度stopし、負荷の少ない状態でも同じことを試しましたが結果はかわりませんでした ・検索してみると、key_buffer_sizeが少なすぎることが原因という記事をみかけたので、試しにkey_buffer=512Mとして、設定を読み込み直してから試してみましたが結果はかわりませんでした このような場合の原因と対策を教えて頂ければ幸いです。 足りていない情報は随時補足させていただきます。 是非回答宜しくお願い致します。
環境は PHP5.3.3 MySQL5.0.95 です。 現在TBL1にURL(address)と、そのURLのタイトルタグの中身(title)と、独自に数えてる数字(count)を入れています。 その1つのアドレスに対してcountの数は色々あるので、 そのcountをアドレスと対にして合計したもの(SUM)で並び替えています。 (分かりづらかったらすいません。addressは主キーではないということです。) タイトルに関しては最近取得し始めたところで入ってるところと入っていないところがあります。 その状況下で SELECT address, title, sum(count) as SUM FROM TBL1 where address LIKE "%hoge.com%" group by address order by sum DESC LIMIT 10; こういうSQL文を使ってSELECTした際に、 hoge.com以下の例えばhoge.com/1.html,　hoge.com/2.html, ... といった感じのURLごとにSUMの数で並び変わるのですが この場合titleはどのカラムを参照していることになるのですか？ (address) (title) (SUM) hoge.com/1.html | test1 | 500 | hoge.com/2.html | test2 | 400 | hoge.com/3.html |　　　　| 300 | hoge.com/4.html | test4 | 200 | hoge.com/5.html | test5 | 100 | hoge.com/6.html |　　　　| 40 | hoge.com/7.html | test7 | 20 | hoge.com/8.html |　　　　| 10 | hoge.com/9.html |　　　　| 6 | hoge.com/10.html |　　　 | 5 | こんな結果だったとして、titleが入っているものと入っていないものの区別がつきません。 入っていないURL(例えばhoge.com/3.html)のaddressカラムも全て空というわけではありません。 逆に入っているものに関しては、全ての行にtitleが入っているわけではありません。 主キーは今回のSELECTとは関係してない"ID"です。 ID | address | count | title 1 | hoge.com/1.html | 3 | test1 2 | hoge.com/1.html | 10 | 3 | hoge.com/1.html | 43 | test1 ID | address | count | title 1 | hoge.com/3.html | 4 | test3 2 | hoge.com/3.html | 3 | 3 | hoge.com/3.html | 42 | それぞれは主キーに応じてcountが個別にある状態です。 上記は正確ではありませんが、こんな感じです。 こうして共に入ったり入ってなかったりするのにSELECTした結果に 入ってるものと入ってないものが出てくるのが分かりません。 ちなみに、検証すると一番countが多い行にtitleが入っていたらSELECT文にも出てくるというわけではないようです。 なぜtitleが出るものと出ないものがあるのでしょう？ ご教授宜しく御願い致します。
あるテーブルtable01にname列があったとします。 その列に ”様"　をつけたいと思い、concat文を使おうと思い、 以下のようにしたのですが、 mysql> Select concat(name,"様") from table01; +-------------------+ | concat(name,"様") | +-------------------+ | ito様 | | sato様 | | aikawa様 | | abe様 | | yamada様 | +-------------------+ 5 rows in set (0.00 sec) 列名もconcat(name,"様")となってしまっていますが、　As nameを使う以外に nameとだけ表示させる方法はありますか？
topコマンドで見た時にいつもmysqldのCPU使用率が300前後になっています 改善方法など全くといっていいほどわからないのですが、まずslow-logを覗いてみたところ SELECT `a_id`, `b_id`, `hoge` FROM `table1` WHERE `a_id` IN (10,27,37,38,46,47,51,69,73,82,86,90,103,110,125,129,134,135,136,137,139,142,148,150,161,168,181,184,187,191,192,198,200,206,215,222,230,231,249,264,266,270,271,302,315,338,342,349,360,361,366,376,383,385,399,405,406,410,412,424,427,432,438,444,454,456,457,462,480,483,484,487,488,492,493,494,506,509,517,549,559,573,574,578,579,586,587,594,597,599,609,612,617,619,625,629,632,633,637,642,646,679,681,684,687,688,689,691,692,696,698,699,700,708,716,738,739,740,742 ,755,758,764,767,768,772,774,778,780,782,783,786,787,792,793,795,796,799,802,807,808,810,811,815,816,817,819,821,823,826,827,828,829,831,833,834,839,840,841,846,849,854,855,856,857,858,859,860,861,864,872,879,881,882,884,888,890,892,893,894,896,899,907) ORDER BY `updatetime` DESC LIMIT 0, 100; このようなクエリが1秒以上かかっていました。 `table1`と`table2`は`a_id`で紐付いていて、事前に`table2`に入っているa_idの一覧を取得してから上記のクエリを作成しています。 `table1`のスキーマを確認したところ INDEX a_id(`a_id`) INDEX updatetime(`updatetime`) となっていました。 （素人ながらに INDEX idx1(`a_id`, `updatetime`) とするべきだったのでは…と思ったのですがALTER TABLEで追加してみたところ、結果は変わりませんでした。） EXPLAINしてみたところ 1 | SIMPLE | feed | range | a_id,i1 | a_id | 5 | NULL | 237900 | Using where; Using filesort と返ってきました。 このような状態では、どのように対策するのが良いのでしょうか。 決まった正解はないのかもしれないですが、考えられる可能性で試すべき項目を教えて頂ければ幸いです。 ・table2のidに紐付いたtable1の情報を取り出したい場合の適切な設計 ・適切なSQL文 ・適切なインデックスの貼り方 などをご教授いただけると嬉しいです。 21時～0時くらいの時間帯になるとアクセスが増えload averageが10前後になってしまい、いつサーバーが落ちるかとヒヤヒヤしています… 是非ご回答宜しくお願い致します。
MySQLでWhere句の書き方で苦戦しています。 以下のuser_table（オーダー)が来たときに、スタッフが用意すべき数量を商品ごとに抽出するSQLを書いています。 Where句の書き方が思いつきません。ご指導をお願いいたします。 user_table (name) (product) (user_volume) takada | pro_001 | 500 | takada | pro_002 | 100 | matuda | pro_003 | 400 | kawase | pro_001 | 200 | yosida | pro_001 | 500 | tanaka | pro_001 | 300 | tanaka | pro_002 | 500 | tanaka | pro_003 | 300 | 作りたいテーブル(SQLの結果) total_table (id)(product_name)(total_volume) staff | pro_001 | 1500 | staff | pro_002 | 600 | staff | pro_003 | 700 | 途中まで作って断念したSQL INSERT INTO total_table (id ,product_name,total_volume) SELECT 'staff',product,SUM(user_volume) FROM user_table WHERE ・・・;
お世話になっております。 WHERE文に関して、少々分からない事が出てきたため質問させて下さい。 id　mail　name　・・・・ 現在、上記のようなカラムを持つmemberというテーブルがあり、このテーブルにあるメンバー向けにメールマガジンを配信しております。 今回、メールマガジンの配信の停止を求められたのですが、色々なタイプのメールマガジンを配信しており、その１つだけを停止を求められたので配信停止依頼のあった者だけを no　no_id　no_mail といったようなテーブル（no_magazine)を設置し、配信の停止を求めてきた方のidと、mailを、上記テーブルに登録する流れを考えました。 そこで質問です。 配信停止を求めてきた方だけを、no_magazineテーブルに入れ、memberとno_magazineをLEFT JOINして問合わせを考えておりますが、このように、no_magazineにデータがない方だけに配信をしようとした場合、どのようなWHERE文になるのでしょうか？ no_magazineにデータがある方だけに送るのは簡単ですが、データがない方だけに送るケースが判らずに質問させて頂きました。 色々と試行錯誤しているのですが、どれも上手くいかなくて・・・ お忙しいなか恐縮ですが、アドバイスのほど頂戴出来れば幸いです。 宜しくお願い申し上げます。
mysqlで検索した結果に対して 同一テーブルの他のカラムに共通の文字列を書き込みたいです。 たとえば、 SQLで検索した結果に対して、対象レコードの「price」の項目に 「300」の文字列を登録するイメージです。 例： 元のレコード name　　　price りんご みかん なし 「ん」で対象レコードを検索した結果イメージ： name　　　price りんご みかん このとき、「ん」に該当する「price」のカラムに 「300」と値段を登録したいです。 理想の処理結果のイメージ： name　　　　price りんご300 みかん300 お手数ですが、アドバイスよろしくお願いします。
Apache2.2をアンインストールしたいのですがどうしたらできますか！？ OSはWindpws7です。 　なぜか！”アプリケーションの追加と削除”には存在しません 　よろしくお願いします。
PHPのforeachでSQL文を処理しても良いか教えてください。 ・foreachループの中でSQLを書いているのですが、なるべくしない方がよいのでしょうか？ (一般的な書き方ではない？) ・MySQLで代替する書き方はあるでしょうか？ ・もし代替する書き方がなくてforeach文を使う場合、SQL文が長くてもクエリ数が少ない書き方の方がよいのでしょうか？
　ｐｈｐMｙＡdminでSQLに 　以下の文を入力しました。 　CREATE DATABASE xmas; USE xmas; CREATE TABLE xmastran ( book_id int not null auto_increment, name varchar(30) not null default ' ' , org varchar(50) not null default ' ', addr varchar(80) not null default' ', tel varchar(20) default ' ', mail varchar(40) default ' ', course varchar(30) default ' ', nums integer default 0, PRIMARY KEY (book_id) ) ENGINE=MyISAM DEFAULT CHARSET=utf8; 　以上SQLに入力した文ですが！ 　以下のエラーが出て先に進みません。 　 エラー 実行した SQL: CREATE DATABASE xmas; →　(http://dev.mysql.com/doc/refman/5.5/en/create-da …にリンクされている) MySQL のメッセージ: ドキュメント #1007 - Can't create database 'xmas'; database exists サーバ "127.0.0.1" 上でクエリを実行する: CREATE DATABASE xmas; USE xmas; CREATE TABLE xmastran ( book_id int not null auto_increment, name varchar(30) not null default ' ' , org varchar(50) not null default ' ', addr varchar(80) not null default' ', tel varchar(20) default ' ', mail varchar(40) default ' ', course varchar(30) default ' ', nums integer default 0, PRIMARY KEY (book_id) ) ENGINE=MyISAM DEFAULT CHARSET=utf8; 　　以上ですが、何が原因で進めないか原因を追及中です。 　最近SQLを始めたので、全く見当がつきません。 皆様よろしくお願いします。 　
SQL文でダブルクォートかアポストロフィーか迷っています！？ 　以下のＳＱＬ文の 　name varchar(30) not null default " ,等の 　最後から２番目に　"　ダブルクォートがあります。 　教本を見ながら入力したのですが、' ' アポストロフィーが２個あるようにも見えます。 この場合、どちらが正規でしょうか！ 　 　以下問題のＳＱＬ文です。 　よろしくお願いします。 CREATE DATABASE xmas; USE xmas; book_id int not null auto_increment, name varchar(30) not null default " , org varchar(50) not null default ", addr varchar(80) not null default", tel varchar(20) default ", mail varchar(40) default ", course varchar(30) default ", nums integer default 0, PRIMARY KEY (book_id) ) ENGINE=MyISAM DEFAULT CHARSET=utf8;
現在 100万件程ある データから ・date( 作成日時 ) で縛り ・int( 0 から 5 ) の出現数を カウントする 命令を実行しているのですが、どうも下記では効率悪く思われてなりません。 SELECT 　　COUNT( int = 0 OR NULL ) AS r0, 　　COUNT( int = 1 OR NULL ) AS r1, 　　COUNT( int = 2 OR NULL ) AS r2, 　　COUNT( int = 3 OR NULL ) AS r3, 　　COUNT( int = 4 OR NULL ) AS r4 FROM 　　table WHERE 　　date BETWEEN '2013-08-13' AND '2013-08-13' 他に良い方法はないでしょうか。 また ゆくゆくは intの部分を 0 から 5 の固定ではなく 可変( '2013-08-13' にある 数字を調べて それぞれの出現数を 数える ) にしたいとも思っています。 しかし その方法は さっぱり見当もつかないので 合わせて 教えて貰えたら嬉しいです。 宜しくお願いします。
　現代版のXAMPP Control Panel v3.2.1 セットアップしました。 　教本の内容は古くて、xampp-win32-1.7.3.exeとの内容で書かれています。 　 　すると、php.iniのプログラムの中身と教本と書いてあることが違います。 　 　「php.ini」ファイルで795行目あたりですが 　 ; Windows: "\path1;\path2" include_path=".;C:\xampp\php\PEAR" C:\xampp\php\includes" 以上のプログラムで\PEAR"の最後に"ダブルクォーテーション(") で区切られています。 　 しかし、教本には \PEAR;の最後はセミコロン（;）にと印刷されています。 セットアップしたての(")か、教本の（;） どちらが正規でしょうか 　実際のphp.iniが以下で見れます。 最後のアドレスかは、php.iniをZIPで圧縮したファイルが取れます。 参考にされてください。 　http://homepage3.nifty.com/mtaiyo/php.ini http://homepage3.nifty.com/mtaiyo/php.zip
MYSQLで複数のユーザーと、複数のアイテムがあり、アイテムには表示順序を設定できるとします。 レコードの例は次のようになっています。 「ユーザーID / アイテムID /表示順序」 例： ユーザー1 / アイテムA / 1 ユーザー1 / アイテムB / 2 ユーザー1 / アイテムC / 3 表示順序は1から始まる連番で管理されていて、数字の大きなものから順に並びます。 各ユーザーが持つアイテムの種類はバラバラで、何も持っていないユーザーも存在します。 上の例の場合ユーザー1はアイテムABCを持ち、表示順序はCBAです。 そこで、あるユーザーのアイテムの順序を振り直す場合、一度そのユーザーのレコードを全て削除してから新規に振り直そうと思っていますがこのやりかたは正しいでしょうか？ それともUPDATEをうまく使って書き換えるほうがいいのでしょうか？
mysqlのデータの表示順番を変えたいのですが、 思うようにいかず悩んでいます。 例えば、顧客データで　東京在住で入会年月日順の出力をして、 その後に、名古屋在住でID順に出力させたいとします。 下記のように書けば、nagoyaのほうがid順になりません。 考え方が違うのでしょうか？ よろしくお願いします。 SELECT ～ FROM ～ WHERE ～ ORDER BY tokyo,nyukai ASC,nagoya,id ASC,
WordPressを使ってHP制作をしたく思っています。 FTPでうちの会社のサーバーへwordpressの解凍ファイル一式を送り、アクセスすると、データーベース情報を設定する画面になり、ここでつまずいています、 ユーザー名、パスワード等は分かるのですが、データベース名というのが分かりません、 調べてみますとMySQLというものの設定が必要との事ですが、知識等未熟な当方の頭ではどうアクションすればいいのか分かりません。 MyQSLはソフトと言うよりはサーバーの機能のようなものでしょうか、データベースというものがよく分かっておりませんしwebで調べても恥ずかしながらちんぷんかんぷんでありました、 お手数をおかけしますが、解決に向けて分かりやすい説明を頂ければ幸いです。 使ってるPCはMacOS10.6です、
My SQL バージョン5.5です。 学校で習っている時に 追加で、　not nullを設定しようと思い、 modify文を色々試して使いましたが Syntaxのエラーが出て、 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' c_pass not null' at line 1 （※c_pass　はカラム名です） change　型名（桁数）を使うと変更できました。 なぜmodifyなどでは追加変更出来なかったのか、原因がわかる方はいらっしゃいますか？ バージョンの問題ですか？
http://okwave.jp/qa/q8209284.html 　以上の質問で、まだ解決には至っていません！？ 　御回答をいただいたのですが、私にはその意味が分かりませんでしたので 再度質問しました。 　初めてすることは、手探り状態なので、苦労しています_ _! 　教本を読んでも、エラー対策などは 、何も書かれておらず、ネットで一生懸命、状況を説明して、解決するしか、方法 はないので、宜しくお願致します。 　 　それで、エー・っと　 　 　#1007 - Can't create database 'xmas'; database existsの ”エラーメッセージ”をGoogle翻訳で直訳したら 　 ”＃1007 - データベース'クリスマス'を作成できません、データベースが存在している” 　とでて、原因として、”データベースが存在している”からできない！？ 　 　うーん　よく分かりませせん どなたか、こうゆう場合の解決策として、代替でいいですので、手順を箇条書きにして、教えて もらっていいでしょうか！＾＾ 　１）・・・ 　２）・・・ 　３）・・・ 　以上宜しくお願いします。
SQLが上手く作れないためお知恵をお貸し頂ければ幸いです。 articleテーブルに存在するユーザの一覧に、記事の投稿件数、記事に含まれるsizeの最大値、最大値が投稿された記事の登録日時、記事のタイトルを加えたものを抽出したいです。 [ article ] article_id user_id size insert_unixtime title ---------------------------------------------------------- 1 100 18 20130101 aaaaaaaaaaaa 2 100 10 20130102 bbbbbbbbbbbb 3 100 18 20130103 cccccccccccc 4 200 11 20130201 dddddddddddd ↓↓希望する抽出結果↓↓ article_id user_id count max_size insert_unixtime title ---------------------------------------------------------- 3 100 3 18 20130103 cccccccccccc 4 200 1 11 20130201 dddddddddddd 自己結合等で、ユーザ毎の最大sizeを抽出してそれに該当するレコードを探すことであるていどはできたのですが 最大sizeが複数あった場合に、両方のレコードを取得してしまいます。（上記の例では、article_id 1と3を抽出してしまう。 ※最大sizeが複数会った場合はinsert_unixtimeが大きい方のタイトルを表示したい。 うまく1SQLで抽出できないでしょうか。
こんにちわ。PHPとMysqlで色々やろうとしている者です… すっごい初心者です。 こんな感じのテーブルがあって… tagsテーブル [int id(PK)(A_I)][varchar tag(index)][int u_id] 1、うどん、5 2、そば、5 3、うどん、2 4、ラーメン、2 5、そうめん、1 6、そば、3 ....（つづく） こんな文があります… SELECT u_id, count(CASE WHEN tag = "うどん" or tag = "そば" THEN 1 ELSE NULL END ) AS `agr` FROM tags GROUP BY u_id ORDER BY agr DESC 結果は [u_id][agr] 5、2 8、2 4、1 3、0 ....（つづく） tagが「うどん」or「そば」のu_idを集計して多い順にソートするんですが これの結果を「うどん」and「そば」の結果だけを出力したい（この場合agrの結果2のみ） …要するにtagをandで検索したいという事です… 回答よろしければお願いします…
MySQLで10,000を超えるデータが有り、その中から最大6件まで指定して表示するプログラムを作る予定です。 6つの枠が有りそれぞれの枠にデータを選んでセットしていく形式です。 この場合データのテーブル側に枠にセットされていることを示すフラグのようなものを付けてそれをもとに抽出するか、別のテーブルにデータIDの記入された data1～data6 のカラムを作ってそれをもとに抽出するかどちらが速度・構造的に良いのでしょうか？
お世話になります。 表題のとおり、MySQLの特定のカラムの全データを削除したいのですが、ググるとテーブル全削除やWHEREで「30以下を削除」などの条件付きはすぐに出てくるのですがカラムの一行だけを空にする方法が見つけられません。 phpmyadminのSQLタブから実行しています。 ご達人の諸先輩方、どうぞお知恵をお貸しください。 phpmyadminのSQLタブに記載するSQL文をお教え願えますでしょうか。 宜しくお願いします。 MySQL、Window7 64bit Apacheサーバ　phpmyadmin
SQLに関して質問させて頂きます(MySQLを使用しています)。 下記のようなデータを使用して、賞味期限に設定した日付が、24時間以内にせまったレコードの危険フラグを1にしたい場合、どのようなSQLを記述すれば良いでしょうか？ SQLの実行は1回でも2回に分けてもらってもよいので、効率的な方法があればよろしくお願いします。 ※必要であればPHPを使用して下さい。 ＜カラム＞ ｜商品名｜賞味期限｜危険フラグ｜ ＜例＞ | 魚　 | 2013-07-31 21:30:00 | 0 | | 肉　 | 2013-08-01 21:00:00 | 0 | | 野菜 | 2013-08-02 21:30:00 | 0 | SQLを実行した時の時刻が「2013-07-31 19:00:00」であれば、肉の賞味期限が24時間以内に迫っているので、危険フラグを1にしたいと考えています。 よろしくお願いします。
かなり初心者です。もしかしたら妙な事を訊いているのかもしれません。 php5.4.16とmysql5.5.32でSNSのフレンドリストのような機能を作ろうと思います。 フレンド最大数は1000とします。この場合、1000個もカラムを作るのでしょうか？ それとも、会員個別にテーブルを作ってそこで管理するのでしょうか。 もしくは、テーブルは一つとし、会員番号のカラムを二つ用意、関係性を示したテーブルを作るのでしょうか？ もしくは、カラムは一個で文字列で操作したりするのでしょうか？（カンマで区切る等） パフォーマンス的にどの設計が正しくて、どの設計が間違いなのでしょうか… 回答よろしくお願いします。
MySQL ver.5.0.95です。 PHPからSQL文を作ってDBへインサートしているのですが 重複した値が合った場合はupdateするように書いています。 TBL1には |id　　　|string　　　|count 1　　　　aaa　　　　0 2　　　　bbb　　　　3 3　　　　ccc　　　　1 TBL2には |id2　　　　|string2　　　　|count2 1　　　　　 aaa　　　　　　0 2　　　　　 bbb　　　　　　2 3　　　　　 ccc　　　　　　1 実際はもう少し複雑ですが、こういう感じでデータが入ってるとします。 このとき、TBL1のそれぞれをインサート若しくはアップデートするのに TBL2の同一IDのものの、count2の状態によって場合分けしたく 同一IDのcount2が1以上なら変更しない、という風にするため以下のように書いたのですが insert into TBL1 values (1, "aaa", 3), (2, "bbb", 3), (3, "ccc", 3), (4, "ddd", 3) on duplicate key update count = CASE WHEN (select count2 from TBL2 where id2 = values(id)) >=1 THEN count ELSE count + values(count) END; #1064 - You have an error in your SQL syntax;というエラーになって出来ません。 WHENの中のサブクエリで、where id2 = values(id)　恐らくこの文がダメなようです。 例えば決め撃ちで1つ1つ書くと通ります。 insert into TBL1 values(1, "aaa", 3) on duplicate key update count = CASE WHEN (select count2 from TBL2 where id2 = 1) >=1 THEN count ELSE count + values(count) END; insert into TBL1 values(2, "bbb", 3) on duplicate key update count = CASE WHEN (select count2 from TBL2 where id2 = 2) >=1 THEN count ELSE count + values(count) END; insert into TBL1 values(3, "ccc", 3) on duplicate key update count = CASE WHEN (select count2 from TBL2 where id2 = 3) >=1 THEN count ELSE count + values(count) END; insert into TBL1 values(4, "ddd", 3) on duplicate key update count = CASE WHEN (select count2 from TBL2 where id2 = 4) >=1 THEN count ELSE count + values(count) END; これをエラーになったような文に変えて1文にまとめたいのですが、無理でしょうか？ あとそもそもこれをまとめたほうが速いと思ってそうしたいのですが、 変わらないのなら1文1文;でつなげて書くやり方でいこうと思っています。 まとめると速くなることはあるでしょうか？
MySQL　初心者です。 テーブルを作成して、いろいろとデータを入れ込もうと思うのですが、 CURRENT_TIMESTAMP を指定すれば、データを入れた瞬間にその時の日付が登録されると思うのですが、 それとは別に勝手に連番をつけていくような機能はないのでしょうか？
MYSQLを勉強中です。 下記のようなテーブルがあります。 【クライアトテーブル】： クライアントID 1 | A社 2 | B社 3 | C社 4 | D社 【お問合せテーブル】： お問合せmail |お問合せ先のクライアントID|お問合せ日時 aaa@aaa.com |1 |2013-02-01-10:00:00 aaa@aaa.com |2 |2013-03-01-10:00:00 bbb@bbb.com |3 |2013-04-01-10:00:00 ccc@ccc.com |4 |2013-04-02-10:00:00 aaa@aaa.com |1 |2013-04-03-10:00:00 ここで、 クライアント毎に、4月分の問合せ数を表示したいのですが、 4月1日～4月末日に問合せのあったメールアドレスと、 2月1日～3月末日に問合せのあったメールアドレスを比較して、 下記のように重複分をクライアント毎にカウントしたいです。 問合せ数： A社：1件　重複1件 C社：1件　重複1件 D社：1件　重複0件 クライアントIDを個別で指定すれば正しく表示できるのですが、 クライアント一覧を取得するのはどのようなSQLを書けばよいのでしょうか。。。 もう１ヶ月悩んでおります。 すみませんが、教えて頂けますと幸いです。
MySQLで、「GROUP_CONCAT」を「複数列」に適用させ、それぞれ異なるレコードを1つにまとめようとしたのですが、 取得出来る結果が、多い方の数に引き連られてしまいます。 ざっくりとした質問でアレなのですが、これは結合の仕方が悪い、 と推測されるでしょうか？ そもそも「GROUP_CONCAT」を複数列に適用させる場合、それぞれ異なるレコード数をまとまることはできるのでしょうか？。 ■期待した取得結果 [テーブルAカラムc] => tokyo,osaka [テーブルAカラムd] => japan,japan [テーブルBカラムe] => windows [テーブルBカラムf] => man ■実際の取得結果 [テーブルAカラムc] => tokyo,osaka [テーブルAカラムd] => japan,japan [テーブルBカラムe] => windows,windows [テーブルBカラムf] => man,man 「テーブルB」の取得結果が、「テーブルA」取得結果数に引き連られてしまいます ■SQL(抜粋) SELECT 　GROUP_CONCAT(a.c) AS c, 　GROUP_CONCAT(a.d) AS d, 　GROUP_CONCAT(b.e) AS e, 　GROUP_CONCAT(b.f) AS f FROM hoge h LEFT JOIN テーブルA a ON (h.id = a.hoge_id) LEFT JOIN テーブルB b ON (h.id = b.hoge_id)
http://ponk.jp/php/basic/php_mysql すいません。データベースを初めて勉強中なのですが、上記のサイトに書いてあるように文字をphpで表示させた場合日本語が???に文字化けします。いろいろググってみたのですが解決できず先に進めません・・。 照合順序などはutf8_general_ciとなっていまして、phpの方も<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />とutf-8が指定してありますので問題ないと思います。 考えられる原因というのはどんなものがありますか？ テーブル表 CREATE DATABASE men; USE men; CREATE TABLE udon(name TEXT, price INT); INSERT INTO udon VALUES('たぬきうどん', 340); INSERT INTO udon VALUES('てんぷらうどん', 440); INSERT INTO udon VALUES('カレーうどん', 420); INSERT INTO udon VALUES('うどん定食', 520); 表示プログラム <table border="1"> <tr><th>名前</th><th>価格</th></tr> <?php $pdo = new PDO("mysql:dbname=men", "root"); $st = $pdo->query("SELECT * FROM udon"); while ($row = $st->fetch()) { $name = htmlspecialchars($row['name']); $price = htmlspecialchars($row['price']); echo "<tr><td>$name</td><td>$price 円</td></tr>"; } ?> </table>
データベースにチェックボックスのON、OFF状態を 保存しようとしているのですが、 やり方が色々あり、どのやり方が一番いいのかわかりません。 調べたところ、大きく以下の４つがあることがわかりました。 ----------------------------------------- 方法１　チェックボックス分カラムを用意する ----------------------------------------- 例 id　name　flag4　flag3　flag2　flag1 15　なまえ　１　　　１　　　０　　０ ----------------------------------------- 方法２　ビット演算を使う ----------------------------------------- id　name　bit 15　なまえ 12 ----------------------------------------- 方法３　カンマで区切ってデータを入れる ----------------------------------------- id　name　check 15　なまえ 3,4 ----------------------------------------- 方法４　チェックボックス管理テーブルを作る ----------------------------------------- main_tb id　name 15　なまえ check_tb id　check 15　4 15　3　 それぞれ、一長一短があると思うのですが それぞれのメリット・デメリット、一般的にどの方法が好まれているのか等 アドバイス頂けると嬉しいです。
お世話になります。 現在、DB内のindividualというテーブルのname_enというフィールドにおいて、 日本人の名前が英語表記で登録されています。 ただし、一般的な表記でなく、「姓, 名」というようになっています。 例えば、玉木宏さんであれば、 Tamaki, Hiroshi となっています。 これを一般的な Hiroshi Tamaki に一発で置換するようなSQL命令文がありましたら教えていただきたいのですが、 如何でしょうか。 何卒よろしくお願いいたします。 バージョン情報などは下記の通り引用します。 MySQL Server: Localhost via UNIX socket Server version: 5.1.67 Protocol version: 10 MySQL charset: UTF-8 Unicode (utf8) Web server Apache/2.2.23 MySQL client version: 5.1.67 PHP extension: mysqli phpMyAdmin Version information: 3.3.10.5
「去年の登録者」「今年の登録者」というテーブルがあるとします。 カラムは両方とも「名前」「性別」「年齢」があり、人物の情報が入ってます。 両方にデータが入ってる人もいれば、片方にしかデータが入ってない人もいます。 この2つのテーブルから男性のデータを引き出し 名前　去年の年齢　今年の年齢 太郎　21歳　　　　22歳 二郎　24歳　　　　データなし 三郎　データなし　20歳 このようにしたいのですがsql文が思いつきません。 アドバイスをください。
1つのテーブルから重複したデータを取り除いて表示するときに使う 【select distinct カラム名 from テーブル名;】 がありますよね。 それと同じようなことを複数のテーブルをまたいで行いたいのですがうまくいきません。 ちなみに両方のテーブルのカラム名は同じです。 【select distinct カラム名 from テーブル1 union select distinct カラム名 from テーブル2;】 としても重複を取り除いた後にテーブルを結合してるので結果的に両テーブルの重複した値を取り除くことができず。 そこで 【select distinct T1.カラム名, T2.カラム名 from テーブル1 T1. テーブル2 T2;】 としてみたのですが、クエリを実行中のまま反応がないので悩んでます。 ちなみに2つのテーブルのデータはそれぞれ2万件ほどです。 こういう時どういうsql文を組むのが正しいのでしょうか？
初めて質問させていただきます。 タイトルはなんとつけたらよいか分からなかったので的外れだったらすみません。 PHP5とMySQL5でプログラムの練習を始めました。 しかしどうしても躓いて分からないところがあり、質問させていただきました。 従業員のデータの入ったテーブル、職種のテーブル、従業員と職種を結ぶテーブルがあるとします。 例えば以下のようなものです。 従業員テーブル +-----------+---------+-----+ | worker_id | name | age | +-----------+---------+-----+ | 1 | hiroshi | 20 | | 2 | seiya | 30 | | 3 | akane | 18 | | 4 | yukari | 18 | +-----------+---------+-----+ 従業員職種テーブル +-----------+--------+ | worker_id | job_id | +-----------+--------+ | 1 | 1 | | 1 | 2 | | 1 | 3 | | 1 | 4 | | 2 | 1 | | 2 | 2 | | 3 | 2 | | 3 | 3 | | 3 | 4 | | 4 | 1 | +-----------+--------+ 職種テーブル +--------+----------+ | job_id | job_name | +--------+----------+ | 1 | hole | | 2 | kitchen | | 3 | delivery | | 4 | cleaning | +--------+----------+ ここで職種cleaningに属する従業員を除いた従業員のデータ一覧を、表示するようなことがしたいと考えています。 このテーブルでいうとhiroshiとakaneはcleaningに属するので除いて、seiyaとyukariのデータが一覧で表示されるという感じです。 select 従業員職種テーブル.worker_id, 従業員テーブル.name, 従業員テーブル.age GROUP_CONCAT(職種テーブル.job_name order by 職種テーブル.job_id) from 従業員職種テーブル left join 従業員テーブル on 従業員職種テーブル.worker_id=従業員テーブル.worker_id left join ot_dow on 従業員職種テーブル.job_id=職種テーブル.job_id group by 従業員職種テーブル.worker_id order by 従業員職種テーブル.worker_id このようなSQLで従業員の職種まで含めたデータを一覧にすることは出来たのですが、対象を除外するような方法が分からずじまいです。 SQLでできるのではと思っていますが、もしかしてPHPでやらなければいけないとかのことも含め、教えていただければ助かります。 よろしくお願いいたします。
現在VB.NET 2008を用いて、システムを作成しています。 Access2008の.accdb内のデータと、MySQL内のデータをinner joinして取得したいと考えていますが、 可能でしょうか? 可能であればどのようにすればよいでしょうか?
下記の'←追加'と書いた部分を追加して実行しましたが、動いてくれません。 ご教授お願いします。 ("SELECT song.song_ID, song.song_name, song.song_name_yomi, kashu.kashu, ka2.kashu as kashu2, ka3.kashu as kashu3, ka4.kashu as kashu4, ka5.kashu as kashu5, ka6.kashu as kashu6, ka7.kashu as kashu7, ka8.kashu as kashu8, ka9.kashu as kashu9, ka10.kashu as kashu10, kashu.kashu_yomi, sakushi, sakushi_yomi, sakkyoku, sakkyoku_yomi, hennkyoku, hennkyoku_yomi, tie_up.tie_up, ti2.tie_up as tie_up2 kashu_yomi, ←追加 ky2.kashu_yomi as kashu_yomi2 ←追加 FROM (((((((((((((((( song left JOIN kashu ON song.kashu_1_ID = kashu.kashu_ID) left JOIN kashu_yomi ON song.kashu_1_ID = kashu.kashu_ID) ←追加 left JOIN kashu_yomi ky2 ON song.kashu_2_ID = ky2.kashu_ID) ←追加 left JOIN kashu ka2 ON song.kashu_2_ID = ka2.kashu_ID) left JOIN kashu ka3 ON song.kashu_3_ID = ka3.kashu_ID) left JOIN kashu ka4 ON song.kashu_4_ID = ka4.kashu_ID) left JOIN kashu ka5 ON song.kashu_5_ID = ka5.kashu_ID) left JOIN kashu ka6 ON song.kashu_6_ID = ka6.kashu_ID) left JOIN kashu ka7 ON song.kashu_7_ID = ka7.kashu_ID) left JOIN kashu ka8 ON song.kashu_8_ID = ka8.kashu_ID) left JOIN kashu ka9 ON song.kashu_9_ID = ka9.kashu_ID) left JOIN kashu ka10 ON song.kashu_10_ID = ka10.kashu_ID) left JOIN sakushi ON song.sakushi_ID = sakushi.sakushi_ID) left JOIN sakkyoku ON song.sakkyoku_ID = sakkyoku.sakkyoku_ID) left JOIN hennkyoku ON song.hennkyoku_ID = hennkyoku.hennkyoku_ID) left JOIN tie_up ON song.tie_up_1_ID = tie_up.tie_up_ID) LEFT JOIN tie_up ti2 ON song.tie_up_2_ID = ti2.tie_up_ID where song_name like '%%'" ))
【名字、名前、昨日のメモ、今日のメモ】というカラムがあります。 名字、名前、昨日のメモは過去のデータなので、新しく今日のメモを追加したい場合どうしたらよいでしょう？ また、一括でデータを挿入するときに、名字・名前の両方一致するものがないデータがあれば新しくレコードを作るという風にしたいのですが、可能でしょうか？ なお、同姓同名は存在しないものとします。
お世話になっております。4つのテーブルの結合について質問させて下さい。（MySQL5) データベースの内容は販売に関するもので、以下のような４つのテーブルがあります。（不必要なカラムは省略しています） テーブル名：goods（商品 goods_no　｜　goods_name 1　　　　　　　りんご 2　　　　　　　みかん 3　　　　　　　いちご テーブル名：member（顧客データ） member_no　｜　member_name 1　　　　　　　　　　鈴木 2　　　　　　　　　　佐藤 3　　　　　　　　　　小林 4　　　　　　　　　　斉藤 テーブル名：slip（伝票番号） slip_no｜sales_member_no｜sales_date 1　　　　　　　2　　　　　　　　2013-6-1 2　　　　　　　4　　　　　　　　2013-6-1 3　　　　　　　1　　　　　　　　2013-6-2 4　　　　　　　3　　　　　　　　2013-6-3 ※slip.sales_member_no = member.member_noです。 テーブル名：sales（売上から入金までのデータを時系列で登録） sales_no｜sale_slip_no｜sales_goods_no｜sales_goods_price｜sales_goods_cnt｜request｜receipt 1　　　　　　　1　　　　　　　　　2　　　　　　　350　　　　　　　　5　　　　　　1750 2　　　　　　　1　　　　　　　　　3　　　　　　　400　　　　　　　　3　　　　　　1200 3　　　　　　　2　　　　　　　　　1　　　　　　　200　　　　　　　　5　　　　　　1000 4　　　　　　　2　　　　　　　　　3　　　　　　　400　　　　　　　　4　　　　　　1600 5　　　　　　　1　　　　　　　　receipt　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　2950 6　　　　　　　2　　　　　　　　receipt　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　2600 7　　　　　　　3　　　　　　　　1　　　　　　　200　　　　　　　　8　　　　　　1600 8　　　　　　　4　　　　　　　　2　　　　　　　350　　　　　　　　5　　　　　　1750 9　　　　　　　3　　　　　　　　receipt　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　1600 10　　　　　 　4　　　　　　　　receipt　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　1750 ※sales.sale_slip_no=slip.slip_noです。 sales.sales_goods_no=goods.goods_noです。 以上のようなテーブルがあり、4つのテーブルを結合して、 伝票単位で、売上詳細（sales）、商品名(goods）、顧客名（member）を以下のように伝票番号順で一覧で表示したいと考えていますが、エラーだったり、期待している結果を得ることが出来ません。 どのようにすれば宜しいのかアドバイスのほど頂戴出来れば幸いです。 slip_no　　商品名　個数 単価　　請求額　入金額 1　　　　　みかん　　5　　　350　　1750 1　　　　　いちご　　3　　　400　　1200 1　　　　　　　　　　　　　　　　　　　　　　　　　2950 2　　　　　りんご　　5　　　200　　1000 2　　　　　いちご　　4　　　400　　1600 2　　　　　　　　　　　　　　　　　　　　　　　　　2600 3　　　　　りんご　　8　　　200　　1600 3　　　　　　　　　　　　　　　　　　　　　　　　　1600 4　　　　　みかん　　5　　　350　　1750 4　　　　　　　　　　　　　　　　　　　　　　　　　1750 以上、お忙しい中恐縮ですが、宜しくお願い申し上げます。
MYSQL初心者です。 簡単なメッセ機能を作りたいと思っています。 MyISAMテーブルを使おうとしています テーブルロックならしようとおもえばなんとかできます 質問（ロックしなかった場合） 複数の人が同時に書き込んだ(INSERTした)ときにどんな壊れ方をするんでしょうか? 一番最後の書き込まれた行だけ壊れるんですか？ 壊れ方はどんなふうになるんですか？書き込まれないだけですか？ 壊れた後でも、書き込みはできますか？ テーブルロックしておけば重複したINSERTはふせげますか？
mysqlで表の結合。 下記のように書きましたが、うまく動きません。 「left JOIN kashu ka2 ON song.kashu_2_ID = ka2.kashu_ID」 「ka2.kashu as kashu2」 ↑この部分、2つを追加しました。 何も表示されませんでした。 上の二つを削除すると動きます。 何がいけないのでしょうか？ mysql_query("SELECT song.song_ID, song_name, song_name_yomi, kashu, kashu_yomi, sakushi, sakushi_yomi, sakkyoku, sakkyoku_yomi, hennkyoku, hennkyoku_yomi, tie_up.tie_up, ti2.tie_up as tie_up2, ka2.kashu as kashu2 FROM (((((( song left JOIN kashu ON song.kashu_1_ID = kashu.kashu_ID) left JOIN kashu ka2 ON song.kashu_2_ID = ka2.kashu_ID) left JOIN sakushi ON song.sakushi_ID = sakushi.sakushi_ID) left JOIN sakkyoku ON song.sakkyoku_ID = sakkyoku.sakkyoku_ID) left JOIN hennkyoku ON song.hennkyoku_ID = hennkyoku.hennkyoku_ID) left JOIN tie_up ON song.tie_up_1_ID = tie_up.tie_up_ID) left JOIN tie_up ti2 ON song.tie_up_2_ID = ti2.tie_up_ID where song_name like '%%'");
SELECT MAX文で、フィールドの最大値を出しています。 これまで、何の問題もなく動作していたのですが、フィールドの数値が9999を超えたとたん、10000、10001などの数値があっても常に9999を最大値として返してくるようになりました。 どうしてでしょうか? 【説明】 A. 例文は次のようなものです。 SELECT MAX(`idc`) from testinvoice; B. `idc`は長さ13のVARCHERです。整数がLatin1で収納されています。 C. `idc`に収納されているデータは、1580からはじまって、9998、9999、10000、10001まで続く約8500件の連番(整数)です。 D. これまで何年も問題なく最大値を出してきました。 とても不思議です。
こんにちは！みなさんのお知恵をお借りしたいと思っています。 下記の要件を満たすDB設計をしたいです。 MySQL5.5 + Java 5で実装予定です。 システム概要 (1)ユーザはWebサイトにて、ポイントを購入し、ポイントを使用することでアイテムが購入できる。 (2)ポイントは常時、購入することが可能で、アイテムも同様に常時、購入可能である。 (3)ポイントには有効期限があり、購入日から有効期限(1年)が過ぎたポイントは無効となる。 (4)購入するポイント数はユーザが任意の値を入力することができる。 (5)アイテムを購入する際に必要なポイント数は、アイテムによって異なる。 (6)ポイントが消失するのは月末である。 (例.2013年7月に購入したポイントは2014年8月1日になると消失する) (5)ユーザー数は300万程度 満たしたい要件 ・現在のポイント残高はWebサイトにて常時閲覧可能としたい。 ・当月に無効となるポイント数は常時閲覧可能としたい ・Webサイトをメンテナンスにして、バッチを流すなどの処理はなるべく避けたい。 お知恵を貸して頂けると幸いです。よろしくお願いします！
■phpMyAdminでint型フィールドへインポート int型のフィールドへcsvファイルからインポートする際に、元データが空白の場合にインポートするとそのフィールドに勝手に「0」が入ってしまいます。 勝手に「0」が入らないようにするにはどのようにしたらいいのでしょうか。 宜しくお願いします。
XAMPPを再インストールして パスワードなどを設定して phpmyadminを起動させると 見覚えのない赤字のビックリマークが出現していました 何が原因なのでしょうか？よろしくお願いします。
下記のようなSQLについてご指南頂きたく思います。 下記のようなテーブルがあり、 商品毎の売上を販売店毎に 売れた順に格納しています。 ＜販売テーブル＞ No　|　商品コード　|　販売個数　|　販売店コード --------------------------------------------- 1　　|　商品A　　　|　　　1　　|　1 2　　|　商品A　　　|　　　1　　|　2 3　　|　商品A　　　|　　　1　　|　3 4　　|　商品B　　　|　　　2　　|　1 5　　|　商品B　　　|　　　2　　|　2 6　　|　商品B　　　|　　　1　　|　3 7　　|　商品A　　　|　　　3　　|　1 8　　|　商品A　　　|　　　4　　|　2 9　　|　商品A　　　|　　　1　　|　3 　 上記のテーブルを使って下記のようなデータを取ってきたく考えております。 　　|商品コード|販売個数　　　　　　　　　　　　　　|販売店コード　|商品コード毎販売個数合計 　　|　　　　　　　|※ある商品の店毎の販売総数|　　　　　　　　　　|※ある商品の販売総数 　　-------------------------------------------------------------------------------- 　　|　商品A　　|　　　4　　　　　　　　　　　　　　　|　1　　　　　　　　|　11 　　|　商品A　　|　　　5　　　　　　　　　　　　　　　|　2　　　　　　　　|　11 　　|　商品A　　|　　　2　　　　　　　　　　　　　　　|　3　　　　　　　　|　11 　　|　商品B　　|　　　2　　　　　　　　　　　　　　　|　1　　　　　　　　|　　5 　　|　商品B　　|　　　2　　　　　　　　　　　　　　　|　2　　　　　　　　|　　5 　　|　商品B　　|　　　1　　　　　　　　　　　　　　　|　3　　　　　　　　|　　5 　　----------------------------------------------------------------------------- 　　やり方としては下記の(1)と(2)の結合ができれば良いと考えております。 　　一回のSQLで上記の結果を得られるようにしたいと考えております。 　　どなたかアドバイス頂ければと思います。 　　宜しくお願い致します。 (1)下記のようなSELECT文で商品コード毎の集計はできました。 　　　SELECT　商品コード,SUM(販売個数)　FROM　販売テーブル　group　by　販売テーブル.商品コード; 　　|　商品コード　　|販売個数　　　　　　　　　　 　　|　　　　　　　　　|※ある商品の店毎の販売総数 　　--------------------------------------- 　　|　商品A　　 　　|　　11　　　　　　　　　　 　　|　商品B　　 　　|　　　5　　　　　　　　　 (2)また、下記のようなSELECT文で販売店、商品コード毎の集計もできました。 　　　SELECT　商品コード,　SUM(販売個数),　販売店コード　FROM　販売テーブル　 　　　　　　　　　　　　　　　　　　　　　GROUP　BY　CONCAT(商品コード,'and',販売店コード)　; 　　|　商品コード　|販売個数　　 　　　　　　　　　　　|販売店コード 　　|　　　　　　　　|※ある商品の店毎の販売総数　|　　　　　 　　---------------------------------------------------- 　　|　商品A　　　|　　　4　　　　　　　　　　　　　　　　|　1　　　　 　　|　商品A　　　|　　　5　　　　　　　　　　　　　　　　|　2　　　　 　　|　商品A　　　|　　　2　　　　　　　　　　　　　　　　|　3　　　　 　　|　商品B　　　|　　　2　　　　　　　　　　　　　　　　|　1　　　　 　　|　商品B　　　|　　　2　　　　　　　　　　　　　　　　|　2　　　　 　　|　商品B　　　|　　　1　　　　　　　　　　　　　　　　|　3　　　　 　　----------------------------------------------------
2つのテーブルで、同じユーザテーブルを参照してデータ取得したいのですが、 どうやって結合すれば良いのでしょうか？ ■概要 ・ユーザがアクションに挑戦すると、結果を表示 ・その際、「アクション作成者」と「アクション挑戦者(ユーザ)」を表示したい ※「作成者」「挑戦者」は、同じ「user」テーブルで管理したい ■3テーブル ・「result」「action」「user」 ・「result」「action」テーブルには、それぞれ「user_id」カラムがある ・「result」テーブルには、「action_id」カラムがある。1対多？ ■知りたいこと ・一気にまとめて一覧として取得する方法 ・最終的に「結果」と、「result」「action」それぞれに対応した「user」テーブルの「name」カラムを取得したい ■試してみたこと ・これだと「挑戦者名」が取得できない 　　　　　　SELECT * 　　　　　　　FROM result r 　　　　　　　　LEFT JOIN `action` a ON r.`action_id` = a.`id` 　　　　　　　　LEFT JOIN `user` u ON r.`user_id` = u.`id` ・これだと「挑戦者」のユーザIDしか取得できない 　　　　　　SELECT *,a.user_id AS actionuser_id 　　　　　　　FROM result r 　　　　　　　　LEFT JOIN `action` a ON r.`action_id` = a.`id` 　　　　　　　　LEFT JOIN `user` u ON a.`user_id` = u.`id`
MySQLの「 INT」型と「 DATETIME」型の違いを教えてください。 ・「 DATETIME」型とは、単に日付形式を担保してくれる型に過ぎないのでしょうか？ ・日付形式(フォーマット)以外を挿入すると、「0000」になってしまうということでしょうか？ ■「 DATETIME」メリット ・データ内容が見た目で分かる以外、何があるのでしょうか？ ■「 INT」メリット ・早い？
●質問の主旨 phpMyAdminのMySQLで ストアドプロシージャの動作確認をしています。 試しに、 delimiter // create procedure pr30() begin select * from tb; select * from tb1l; select * from tb1; end // delimiter ; というプロシージャを作成して、 実行を押しても、画面が全く変化しません。 エラーの表示さえされません。 （もちろんデータベーステーブルのtb、tb1l、tb1が 存在することは確認済みです） また、作成している最中に、 命令文が勝手に消えることもあります。 普通に select * from tb; と、書いていても消えることはないのですが…。 この現象や対策についてご存知の方がいらっしゃいましたら、 アドバイスをお願いします。 ●環境 windows8 xammp1.8.1 phpMyAdmin3.5.2.2 MySQL5.5.27
現在MySQL Adminにアクセスしています。 選択できるデータベースが多数あります。 このデータベース内の特定のテーブルの最終更新日が1ヶ月以内のものが何があるのか調べたい時どのような方法がありますか？
次の２つのテーブルがあります。 テーブル master 形式kata 客先kyaku コードcode テーブル data 形式kata 客先kyaku 発行年月hakko 数量suryo 発行年月が201303と201305の両方があるマスタを抜き出したいため、次のＳＱＬを考えました。 select m.kata,m.kyaku,m.code from master m join data d on m.kata=d.kata and m.kyaku=d.kyaku where 201303 in (select d.hakko from data d where m.kata=d.kata and m.kyaku=d.kyaku) and 201305 in (select d.hakko from data d where m.kata=d.kata and m.kyaku=d.kyaku) 無駄があるようで、また速度向上したいのですが、どう記述していいか分かりません。 教えてください。
■環境 ・PHP+MySQL ■質問 ・「順位データ」の持ち方について教えてください ・「順位データ」はデータベース側で保存するものでしょうか？ ・あるいはPHPで都度処理するのでしょうか？ ・ケースバイケース？ ■データベース側で保存する場合 ・「通常データ」だと、該当レコードを「挿入」もしくは「更新」すればそれで済みますが、「順位データ」だと1件データを「挿入」もしくは「更新」するだけで、全レコードに影響を及ぼす可能性があります ・この場合、1レコードでもデータを変更したら、全レコードに変更処理をかけるしかないのでしょうか？
LAMP環境で開発をしています。 SQL文でCOUNTを求める際に、まとめて結果を求めようとして上手く行きません。 状況としては以下です。 テーブルdはidをkeyにa,b,c３つのテーブルとjoinしています。 id = 1の場合、テーブルa,b,cにマッチするレコードがそれぞれに４個、１個、０個あります。 ひとつひとつを SELECT COUNT(CASE WHEN a.name IS null THEN 1 ELSE null END) as a_count FROM d INNER JOIN a ON a.id = d.id WHERE d.id = 1 として結果を求めると4,1,0と出るのですが、まとめて SELECT COUNT(CASE WHEN a.name IS null THEN 1 ELSE null END) as a_count, COUNT(CASE WHEN b.name IS null THEN 1 ELSE null END) as b_count, COUNT(CASE WHEN c.name IS null THEN 1 ELSE null END) as c_count FROM d INNER JOIN a ON a.id = d.id INNER JOIN b ON b.id = d.id INNER JOIN c ON c.id = d.id WHERE d.id = 1 とすると28,5,0という値が返されます。 どのように書けば正しい4,1,0を得られるのでしょうか？ よろしくお願いします。
Mysql+phpで日報システムを作っています。 独学でWebサイトの情報を見ながら作っているのですが、 更新系の処理に手間取っています。 環境は以下の通りです。 PHP:5.2.4 OS:WindowsServer2003 SP1 MYSQL:5.1.41 元画面から、ボタンを押してDBの更新処理を行うと、画面が真っ白になってしまい固まった状態になります。 MYSQLの問題かなと当初は思ったのですが、更新自体もされてはいますので、PHPの問題ではと思い投稿させて頂きました。 他の参照系のスクリプトは正常に動作します。 ちなみに、この現象はIEでしか出ません。 FFやChromeでは正常に動作します。 ポップアップブロックも外し、IEのアドインを全部外してみましたが、結果は同じでした。 同様の事態を経験された方、考えられる原因を御存じの方がおられましたら、コメント頂ければ幸いです。 更新スクリプトの内容は以下の通りです。 <?php // MySQL 接続 if (!($cn = mysql_connect("192.168.*.***", "user", "password"))) { die; } // MySQL DB 選択 if (!(mysql_select_db("mydatabase",$cn))) { die; } 　　（中略） $SQL="UPDATE NIPPO SET = ***** "; 　　（中略） print $SQL; // ***** この内容が出ずに固まっている ****** $sts = mysql_query($SQL,$cn); if (!$sts) { print "<br><img src='img/error.jpg' width=32 height=32>"; print "更新に失敗しました。"; print "<br><A HREF='javascript:history.back()'>前のページに戻る</A>"; } else { print "<br><img src='img/inf.jpg' width=32 height=32>更新しました。"; print "<br><A HREF='moto.php'>前のページに戻る</A>"; } } ?> </body> </html>
今回、InnoDBとMyISAMの Auto Increments(以下AI）の挙動に対する 対処方法についての質問になります。 以前は5.1のMySQLを使用していましたが、 最近利用しているホスティング会社の方で変更があり、 MySQL5.6へのバージョンアップが行われ、 そこから発生している問題です。 例えば testtb ------------- id item ------------- 1 aaa 2 bbb 3 ccc ------------- というテーブルがあります。（InnoDB） idはプライマリーキーでAIが設定されています。 基本的にこのテーブルでは itemのアップデートくらいで、 レコードを削除するような動作は起こりません。 ところが管理者サイドのテストの際に 下記のように、でMAX(id)を抽出してそのレコードを削除し、 AIの値を削除したMAX(id)に変更するという動作が稀に発生します。 $sql = "SELECT max(id) FROM testtb "; $result = mysql_query($sql, $con); $maxid = mysql_result($result, 0); $sql = "DELETE FROM testtb WHERE id = '{$maxid}' "; mysql_query($sql, $con); $sql = "ALTER TABLE testtb AUTO_INCREMENT = {$maxid} "; mysql_query($sql, $con); 要するにテストで登録した最新idのレコードを削除し、 AI値も元に戻してテスト前の状態に復旧するという内容です。 以前のMySQLのバージョンでは これが問題なく動作していましたが、 MySQL5.6に変わってから InnoDBの場合には、 ALTER TABLE testtb AUTO_INCREMENT = {$maxid} このSQL文を実行しても結果が全く反映されません。 phpmyadminからも実行してみましたが 実行結果にエラーはでないのですが、 同様に結果は反映されず、AI値の変更が行われません。 少しググってみて、innodb_autoinc_lock_mode の設定が関係しているのではと思い見てみると innodb_autoinc_lock_mode = 1になっていました。 ちなみにこの値は共有DBのため、 ホスティング会社の方での固有の設定で 私の方で変更はできません。 上記の問題はMyISAMでは発生しませんので、 InnoDB固有の特徴によるものかと思います。 innodb_autoinc_lock_modeの設定変更なしで 上記を解消する方法はありますでしょうか？ もうMyISAMで運用するくらいしか方法が見つかりません。 それからこれに関連する内容で もう一つ質問があります。 これはphpmyadminに関する質問なのですが、 以前ですと、テーブルを選んで 上メニューの「操作」という箇所から AIの値が確認できて変更もできたかと思うのですが 現在はAIの値を操作する箇所が全く見当たりません。 確認のためにSHOW TABLE STATUSを実行する以外に 確認・変更のできる場所はありませんでしょうか？ ちなみにphpmyadminのバージョンは4.0.0です。 よろしくお願いいたします。
INDEXが着いていないカラムをSELECTで検索しても他のカラムにプライマリーキーがあれば、検索は高速になるのでしょか? テーブル ID、NAME IDにプライマリーキーが付いていて、NAMEのカラムのみを検索するときにも高速になるのでしょうか？
「INT」でかつ「AUTO_INCREMENT」のカラムに0をINSERTしようとするとうまくいかないのですが、 「AUTO_INCREMENT」では0はダメなのでしょうか？ それとも「INT」だから？
データーベースが下記の様にあります、 PHPファイル内で、 この様なSQLを実行して下記の様にprintしてみましたが、 tie_upの部分、AIRとしか表示されません。 このPHPファイル内のprint($row['tie_up']);部分が怪しそうですが、 解決策が思いつきません。 もちろん、外部キーの設定も済んでいます。 --下記、SQL文-- SELECT * FROM ((((( song left JOIN kashu ON song.kashu_ID = kashu.kashu_ID) left JOIN sakushi ON song.sakushi_ID = sakushi.sakushi_ID) left JOIN sakkyoku ON song.sakkyoku_ID = sakkyoku.sakkyoku_ID) left JOIN hennkyoku ON song.hennkyoku_ID = hennkyoku.hennkyoku_ID) left JOIN tie_up ON song.tie_up_1_ID = tie_up.tie_up_ID) LEFT JOIN tie_up ti2 ON song.tie_up_2_ID = ti2.tie_up_ID --SQL文、終わり-- --下記、phpファイル内のprint文-- while ($row = mysql_fetch_assoc($result)) { print($row['tie_up']); } --print文、終わり-- --データベース-- song +-----------+--------------------+--------------------+--------------------+ |　ID　　　|　song_name　｜　tie_up_1_ID　|　tie_up_2_ID　| +-----------+--------------------+--------------------+--------------------+ |　0　　　|　鳥の詩　　　　|　0　　　　　　　|　0　　　　　　| +-----------+--------------------+--------------------+--------------------+ |　1　　　|　青空　　　　　|　1　　　　　　　|　0　　　　　　| +-----------+--------------------+--------------------+--------------------+ tie_up +----------------+--------------------+------------------------+ |　tie_up_ID　|　tie_up　　　　｜　tie_up_yomi　　| +----------------+--------------------+------------------------+ |　0　　　　　|　AIR　　　　　|　エアー　　　　　　| +----------------+--------------------+------------------------+ |　1　　　　　|　CLANNAD　　|　クラナド　　　　　| +----------------+--------------------+------------------------+ --データベース、終わり--
関係有りそうな部分だけ抜粋します。 mysqlで外部キーを設定して、 下記のようなSQLを実行してみましたが、 #1066 - Not unique table/alias: 'tie_up'と エラーメッセージが表示されました。 何がおかしいのでしょうか？ 外部キーは「song」テーブルの「tie_up_1_ID」、同「song」テーブルの「tie_up_2_ID」、 それと「tie_up」テーブルの「tie_up」です。 SQLを触るの5年振りなんで・・・。 SELECT * FROM ((((( song left JOIN kashu ON song.kashu_ID = kashu.kashu_ID) left JOIN sakushi ON song.sakushi_ID = sakushi.sakushi_ID) left JOIN sakkyoku ON song.sakkyoku_ID = sakkyoku.sakkyoku_ID) left JOIN hennkyoku ON song.hennkyoku_ID = hennkyoku.hennkyoku_ID) left JOIN tie_up ON song.tie_up_1_ID = tie_up.tie_up_ID) left JOIN tie_up ON song.tie_up_2_ID = tie_up.tie_up_ID;
jspファイルを実行するとカラムが見つかりませんというエラーが出ました。 対象のテーブルにoniカラムは置いてあります。 どこを見直せば良いのでしょうか？よろしくお願いします。 java.sql.SQLException: Column 'oni' not found. at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1078) at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:989) at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:975) at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:920) at com.mysql.jdbc.ResultSetImpl.findColumn(ResultSetImpl.java:1167) at com.mysql.jdbc.ResultSetImpl.getInt(ResultSetImpl.java:2851) at org.apache.tomcat.dbcp.dbcp.DelegatingResultSet.getInt(DelegatingResultSet.java:275) at org.apache.tomcat.dbcp.dbcp.DelegatingResultSet.getInt(DelegatingResultSet.java:275) at suika.SuikaDAO.findKeisanByID(SuikaDAO.java:134) at suika.SuikaServlet.doPost(SuikaServlet.java:39) at javax.servlet.http.HttpServlet.service(HttpServlet.java:647) at javax.servlet.http.HttpServlet.service(HttpServlet.java:728) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210) at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222) at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123) at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472) at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171) at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99) at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:953) at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118) at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:408) at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1023) at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589) at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) at java.lang.Thread.run(Thread.java:722)
下記のようにテーブルが有り、外部キーの設定も済んでいますが、 PHPファイル内で「select * form song WHERE song_name LIKE '%%'」と実行すると 「0,眠り姫,0」と表示されます。 このsql文を実行した上の結果の一番右側を「0」でなく「栗林みな実」と出力したいのですが、 なにぶん最後にsqlを扱ったのが5年以上前で、 全部頭から抜けてしまっていますorz 外部キーは「song」テーブルのkashu_IDと「kashu」テーブルのkashu_IDに設定してあります。 mysqlのバージョンは5.1.69
（テーブルA）と（テーブルB）をleft joinした際の結合条件について 詳しい方に伺いたいのですが、 on以下の部分は、（テーブルAの中にあるカラム）と（テーブルBの中にあるカラム）を 比較するような文でなければいけないですか？ 例えば、、、 ------------------------------------------------------------------------- SELECT* FROM 　timeTpl2 AS t LEFT JOIN booked AS b ON 　t.start = b.startTime AND 　b.settingDay = $day ------------------------------------------------------------------------- 上記の最後の部分（b.settingDay = $day）は テーブルbにしかない要素を変数（$day）と比較しています。 ◆疑問 記述としてだいじょうぶかどうかを知りたいです。 つまりon以下結合条件は必ず左右のテーブルの、存在するカラム のみしか比較する事ができないかどうかが知りたいです。 よろしくお願いします。
先日問い合わせたSQLの高速化についてEXPLAINについて教えて頂きました。 そのEXPLAINについて調べながら試していくと、同じphpファイル内で動かしている いくつかのSQL文に対してEXPLAINのtypeがALLとなっていたので対応すべき SQLだとは分かったのですが具体的にどのようなSQL文に書き換えればいいか 分からなかったので再度質問しました。 前提としてWORDPRESSでＳＱＬをＰＨＰファイル内で$wpdb->get_results関数を使って 実行しています。 (例1)　条件一致した件数を求めるSQL SELECT a_mst.a_id FROM a_mst WHERE a_mst.a_price >= 100 AND a_mst.a_price <= 200 AND a_mst.a_print_flg = 0 SQLのSELECT にCOUNT等は使わない方がいいようなので主キーのみを出力させて count関数で件数を求めています。 このＳＱＬ文をEXPLAINでphpMyadminで実行すると id=1　　　　　　　select_type=SIMPLE　　　table=a_mst type=ALL　　　　possible_keys=NULL　　　key=NULL key_len=NULL　　ref=NUL　　　　　　　　　　rows=a_mstに登録してある件数 Extra=Using where でした。SQL文自体はあるマスタにあるデータから値が１００～２００のもので、フラグが０のものを 出力するというシンプルなSQL文なのでどう改善すればよいのでしょうか？ (例２)　２つのテーブルを結合させて条件一致したデータをそれぞれテーブルから出力 SELECT a_mst.a_name, a_mst.a_price, b_mst.b_data FROM a_mst, b_mst WHERE a_mst.a_id = b_mst.b_id AND a_mst.a_price >= 100 AND a_mst.a_price <= 200 AND a_mst.a_print_flg = 0 ORDER BY a_mst.a_price , a_mst.a_id asc LIMIT 20 OFFSET 0 です。a_mstとb_mstをidで結合させて条件一致したあとにそれぞれの テーブルデータをSELECTしています。実際のSQL文はSELECT させている項目数は多いです。 このＳＱＬ文をEXPLAINでphpMyadminで実行すると ＜１行目＞ id=1　　　　　　　select_type=SIMPLE　　　　table=b_mst type=ALL　　　　possible_keys=PRIMARY　key=NULL key_len=NULL　　ref=NUL　　　　　　　　　　rows=a_mstに登録してある件数 Extra=Using temporary; Using filesort ＜２行目＞ id=1　　　　　　　　select_type=SIMPLE　　　　table=a_mst type=eq_ref　　　　possible_keys=PRIMARY　　key=PRIMARY key_len=NULL　　　ref=b_mst.b_id　　　　　　　rows=1 Extra=Using where でした。 EXPLAINを使ったチューニングなどしたことないSQL低級者なのでどのようなSQL文にすればtypeがALLの場合や、ExtraからUsing temporary; Using filesortを消すことができるのか分からないので教えて下さる方がいましたらよろしくお願いします。 ちなみに、a_mstとb_mstはphpMyadminにてそれぞれのテーブルの「構造」を見ると 「インデックスサイズ」のところで、それぞれの主キーであるa_idとb_idがPLIMARY で登録させています。編集ボタンを押したら「インデックスを修正する」画面に変わるので一応それぞれインデックス登録はされているのかな？と思います。
idの順位を取得する方法はありますか？ voteが一番多い順にソートして指定したidの順位を取得したいです もしくは、指定したidが3番以内に入っているかどうか調べたいです テーブル id　vote 1　5 2　6 3　3 4　1 5　12 ソートした後のテーブルのイメージ　id3の順位を指定した場合、4番目なので4を取得したいです id　vote 5　12 2　6 1　5 3　3 4　1 よろしくお願いします
二つのテーブルの行数は同じとします 1行に10カラム以上あるテーブルから1カラムだけ取得するのと idとvoteだけの2カラムで作ったテーブルから1カラムだけ取得する場合の処理スピードは速くなりますか? updateで更新する時のスピードもカラム数が多いと違いが出ますか？ よろしくお願いします sprintf("SELECT vote FROM hoge WHERE id=%d", $id );
XAMPPでｍｙｓｑｌを使ってます。 CSVをインポートするとUTF-8が文字化けしてしまいます。詳しくわかる方いましたらお知恵をお貸しください。 まず、ｍｙｓｑｌの設定ですが show variables like 'char%'; をおこなうと +--------------------------+--------------------------------+ | Variable_name | Value | +--------------------------+--------------------------------+ | character_set_client | utf8 | | character_set_connection | utf8 | | character_set_database | utf8 | | character_set_filesystem | binary | | character_set_results | utf8 | | character_set_server | utf8 | | character_set_system | utf8 | | character_sets_dir | C:\xampp\mysql\share\charsets\ | +--------------------------+--------------------------------+ 8 rows in set (0.05 sec) となっています。 次に、アップロードするCSVですが、 １回目は、terapadを愛用しているので、terapadの機能でUTF-8に変換して保存したのですが、インポートすると文字化けしてしまいました。 次は、エクスプローラーでUTF-8に変換したファイルを読み込むと文字化けしており、エクスプローラーのエンコードで文字コードをUTF-8に変換し保存したものを、CSVに変換してインポートしたのですが、やっぱり文字化けしてしまいました。 私の知識ではこれ以上手がないのでなにかあたらしい突破口や間違いがあれば教えてください。
テーブルで一番古いレコードだけをSELECTしたいのですが、どうすれば良いでしょうか？ ■背景 ・テーブルからデータを取得しようと思ったら、「id」及び「autoincrement」に該当するカラムがありませんでした ・日付に該当するカラムもありません ・「phpMyAdmin」で確認すると、いつも同じ並び順で表示されるので、格納したレコード順で表示されているのではないかと思いました ■質問 ・この時、そのテーブルで一番古いレコードだけをSELECTしたいのですが、どうすれば良いでしょうか？ ・where?
mysq初心者です 値の取得する順番を変えないで、値を取得する方法はありますか？ 会員IDが5、1、3で取得したいのですが1、3、5に並び替えられてしまいます テーブルはIDとNAMEのみ、重複なしで、ID番号と名前番号が一致しています sprintf('SELECT id FROM hoge2 WHERE name="%s" or name="%s" or name="%s" ', ほげ5, ほげ1, ほげ3 ); $recd = array(); while ($rec = mysql_fetch_assoc($sql2)) { $recd[] =$rec['id']; }
XAMPPのv3.1.03.1.0をインストールした直後、Apacheがまず作動しなくなりました。 使用するポートを80→8080に変更したところ、なんとか正常にもどったのですが、今度は入れ替わるようにMySQLがスタートしなくなってしまいました。 再びポートを調べましたが、3306が他で使用されている様子はないため、Apacheの設定を上記のように変更したことと関係があるのでしょうか？ ■PCの状況 ・「Windwsファイヤーオール」では、MySqldは許可された状態。 ・「Skype」はアンインストール済み。「IIS」も切っている。 ・過去にMySQLもXAMPPもインストールしたことはない。今回初。 ・3306を他ポートが使用している様子はない。 Apacheの設定を変更したら、連動して必要な動作があるのでしょうか？ 勉強をはじめたばかりの初心者なもので、基本的なことも分からずすみません。 また、ほかの方のアドバイスを拝見しているとMySQLを再インストールする方法もあるようですが、その際はまたApacheのポート変更も必要なのでしょうか…？ お手数ですがご教授いただけると助かります。 参考までに…コントロールパネルには下記のようなエラーメッセージが出ています。 2:03:51 [mysql] Error: MySQL shutdown unexpectedly. 2:03:51 [mysql] This may be due to a blocked port, missing dependencies, 2:03:51 [mysql] improper privileges, a crash, or a shutdown by another method. 2:03:51 [mysql] Check the "/xampp/mysql/data/mysql_error.log" file 2:03:51 [mysql] and the Windows Event Viewer for more clues
DBに以下のようなデータが格納されているとします。 | id | name | | 01 | apple | | 01 | banana | | 02 | onion | | 02 | potato | | 02 | carrot | | 02 | radish | | 03 | beef | | 03 | chicken | | 03 | pork | GROUP_CONCATという関数を使えば、 | id | name | | 01 | apple,banana | | 02 | onion,potato,carrot,radish | | 03 | beef,chicken,pork | と、まとめられることは分かっているのですが、 データ個数を指定または最大値に合わせることは可能でしょうか。 実現したい例を以下に記載します。 | id | name | | 01 | apple,banana,NULL,NULL, | | 02 | onion,potato,carrot,radish | | 03 | beef,chicken,pork,NULL | ※「id:02」の最大値「4データ」に合わせるまたは「4」を指定する GROUP_CONCATの引数にはこのような機能はないように見受けられました。 他の手法でも構わないのですがこのような内容を実現できる方法がありましたら ご教授頂ければ幸いです。 どうぞよろしくお願いします。
自分ではすぐに浮かばないのですが、結構急ぎのことなのでお時間がある方でご存知の方がいらしたら教えて下さると嬉しいです。なので、途中で解決していたり質問を途中で消しているかもしれませんがよろしくお願いします。 SQLで自分が書いた文を高速化したいのですが、一般的にこうすると遅いからこうする方が良いというのがあれば教えてください。 一応自分でも調べててWHERE句では結合よりも先に条件を記載する方が良いとか書いてました。 あと、IN演算子がちょっと問題な演算子ということが。 確かにSQL文を書いているソースではいくつかSELECT文があって、それぞれでIN演算子を使っています。 調べてるとIN演算子をEXISTS演算子に書き換える方が良くなるとあったのですがEXISTS演算子はカッコ内で再度SELECT文を作るんですよね？ 今使っているIN演算子では、ほぼカッコ内に数字のいくつかの候補があってそこから該当する数字を選ばれるという形の方。 WHERE　ＡＡＡ　ＩＮ　（'122','244','366'） といった形です。 あるＳＥＬＥＣＴ文でＩＮ演算子を使って絞った値データを次のＳＥＬＥＣＴ分のＩＮ演算子の値候補として使用しています。 つまり、上記のような文１２２と２４４のデータが見つかってＳＥＬＥＣＴされると次のＳＥＬＥＣＴ文のＩＮ演算子の候補として１２２と２４４が入るという形です。 ちなみにこの処理のメインとなるテーブルでは一つの項目の値を木構造で分けているのでその辺りも考えないといけません。 以前、こちらのサイトで教えて貰った方法で動いている GROUP BY ＡＡ．Ａ１ HAVING COUNT(*) >= 0 といった処理も重くしてしまうのでしょうか？
まだデーターベースを独学で始めて数ヶ月の初心者です。 以下（３行目のleft join）の記述では動かないのですが、どのように 記述したらよいのでしょうか？ やりたい内容は３行目にあるようにbookedというテーブルの中のdateが 2013-06-05だけ抽出した形のテーブルを、timeTplというテーブルとleft join させたいです。 1 "select * 2 from 3 timeTpl as t left join (SELECT * FROM booked where date ="2013-06-05") as b 4 on 5 t.start >= b.startTime and t.start < b.finishTime || 6 t.finish > b.startTime and t.finish <= b.finishTime 7 where 8 t.time > 9 (select start 10 from class as c left join member as m 11 on c.className = m.class 12 where m.name = '$name') 13 ) 14 "; よろしくお願いします。
作成したcsvファイルを使って、社員のマスター検索を行いたいです。 ＳＱＬを使って行いたいのですが、それにともない作り方の流れを教えていただきたいです。
値を1レコードに詰め込む必要があり30個近くになってしまいました。 SELECTやINSERTのときの速度が気になるのですが、問題ありませんででしょうか？ また、問題があれば、どのような回避策がありますでしょうか？ 宜しくお願いします。
質問失礼いたします。 下記のSQL文を使って、「table1」をメインとして「table2」、「table3」を表示しています。 ★現在の状態 【SQL文】 SELECT table1.*, table2.id as t2id, table2.title as t2title, table2.title as t2url, table3.id as t3id, table3.title as t3title, table3.title as t3url, from (table1 left JOIN table2 ON table1.id = table2.id) LEFT join table3 on table1.id = table3.id 【table1】 id　 name　... 01　東京　... 02　栃木　... 03　埼玉　... 【table2】 id　title　　　　　　　　　　url 01　レストラン東京　　　http://~ 01　ファミレス東京　　　http://~ 02　ファストフード栃木　　　http://~ 03　喫茶さいたま　　　http://~ 【table3】 02　麺所　　　http://~ 03　ら～麺　　　http://~ 【表示】 +───+───────────+───────+ │地域│洋食　　　　　　　　　　　　　│ラーメン店　　　│ +───+───────────+───────+ │東京│レストラン東京http://~　　│　　　　　　　　　│ +───+───────────+───────+ │東京│ファミレス東京http://~　　│　　　　　　　　　│ +───+───────────+───────+ │栃木│ファストフード栃木http://~│麺所http://~　│ +───+───────────+───────+ │埼玉│喫茶さいたまhttp://~　　　│ら～麺http://~│ +───+───────────+───────+　　 ※「http://~」には全てリンクを貼っています サブの「table2」(または、「table3」)に2つの情報があると、 表示した際にレコードが2行になります。 その為、下記の通り情報が複数ある場合は1行にまとめたいと思っています。 ★希望する状態 【表示】 +───+───────────+───────+ │地域│洋食　　　　　　　　　　　　　│ラーメン店　　　│ +───+───────────+───────+ │東京│レストラン東京http://~　　│　　　　　　　　　│ │　　　│ファミレス東京http://~　　│　　　　　　　　　│ +───+───────────+───────+ │栃木│ファストフード栃木http://~│麺所http://~　│ +───+───────────+───────+ │埼玉│喫茶さいたまhttp://~　　　│ら～麺http://~│ +───+───────────+───────+　　 なにか方法などありましたら、教えて下さい。 宜しくお願い致します。
お世話になっております。 勉強がてらネットショップを作っているのですが、売上一覧を表示すべくところで立ち止まってしまいました。 以下にテーブルの構成および得たい結果を書き残しますので、ご教示頂けた幸いです。（MySQL5) テーブル名：member member_no　　name1 　1　　　　　　佐藤 　2　　　　　　小島 　3　　　　　　石田 　4　　　　　　鈴木 テーブル名：sales sales_no　sale_slip_no　sales_date　　member_no　goods_name　request_money　receipt_maney 　1　　　　　1　　　　　2013-6-6　　　　　2　　　　　キュウリ　　　　　　5250 　2　　　　　1　　　　　2013-6-6　　　　　2　　　　　イチゴ　　　　　　　3150 　3　　　　　1　　　　　2013-6-6　　　　　2　　　　　バナナ　　　　　　　8400 　4　　　　　2　　　　　2013-6-7　　　　　1　　　　　りんご　　　　　　　5250 　5　　　　　2　　　　　2013-6-7　　　　　1　　　　　　　　　　　　　　　　　　　　　　　　　3000 　6　　　　　3　　　　　2013-6-8　　　　　4　　　　　ほうれん草　　　　　9450 　7　　　　　3　　　　　2013-6-8　　　　　4　　　　　しいたけ　　　　　　2100 　8　　　　　4　　　　　2013-6-8　　　　　3　　　　　マンゴー　　　　　　6300 ・各テーブルにあるmember_noカラムは対となる紐付くデータです。 ・sale_slip_noは伝票番号です。 ・request_moneyは商品単位での小計金額です。 ・receipt_maneyは入金金額（またはポイントが支払いに使われた時の金額）です。 ・質問と無関係と思われるカラムは省略しています。 以上のような構成のテーブルがありますが、以下のように伝票番号毎に別け、かつ伝票毎の合計額を求めたいと考えています。 sale_slip_no　sales_date　　name　　request_money 　4　　　　　　2013-6-8　　　石田　　　　6300 　3　　　　　　2013-6-8　　　鈴木　　　　11550 　2　　　　　　2013-6-7　　　佐藤　　　　2250 　1　　　　　　2013-6-6　　　小島　　　　16800 以上ですが、join group sumの組み合わせになるのかな・・と考え調べ、試行錯誤を繰り返していますが、描いている結果を得ることが出来ません。どのようなSQLになるのかご教示いただければ幸いです。 また、売上データとして蓄積させるテーブル構成を作ったのは初めてですが、もっと適切なものがあれば、こちらも併せてアドバイスを頂けると幸いです。 お忙しいなか恐縮ですが、宜しくお願い申し上げます。
PHPとＭＹＳＱＬをつかっています 会員情報から友達の名前を登録できるようにしました postで受け取った情報は友達の名前のみです 友達の名前から友達のID番号を取得したいのですが、15人分まとめて取得する方法はありますか？ 調べるテーブルのカラムにはidとnameがあります(idとnameに重複はありません) ｈｔｍｌフォームは(input=text)が15個ほどあって、何も記入されていない欄もあります（fre3に書き込んであってfre2が空白の場合があります） $fre1 = $_POST['fre1']; $fre2 = $_POST['fre2']; $fre3 = $_POST['fre3']; 　　　・ 　　　・ 　　　・ $sql = sprintf("SELECT id FROM friend WHERE name LIKE '%s'",$fre1); $recordSet = mysql_query($sql); $data = mysql_fetch_assoc($recordSet);
tbというテーブルのbangというカラムに4が含まれていれば表示というのは select * from tb where (bang) like '%4%' ; という形になりますが、このtbテーブルにさらにname,tukiというカラムがあったとして カラムに関係なくレコードのどこかに４が入っていれば抽出するというSQL文が書きたいです。 select * from tb where bang like '%4%' or name like '%4%' or tuki like '%4%' ; と書くことで何とか今まではやってきたのですが、カラム数が増えてきてしまったので、ものすごく長いSQL文なってしまいました。 もう少しスマートにする方法はありませんか？
http://oshiete.goo.ne.jp/qa/1599858.html この質問に疑問があります。 回答２で where (column1 || '/' || column2 ||'/' || column3) like '%word1%' ; というアドバイスに対して質問者は where　( concat( column1 , column2 , column3) like '%word1%' ) でできたと返しています。 なぜ、質問者はwhere ( concat( column1 , column2 , column3) like '%word1%' ) というSQL文にいたったのでしょうか？ where　( concat( column1 , column2 , column3) like '%word1%' ) では、だめだったのでしょうか？
すいません。現在phpを勉強中で、その際データベースが必要で、初心者サイトを見ながら初めてsqlをさわったのですが Admin自体に接続できなくなり困っています。 （最初は接続できたのですが、PCをシャットダウンして再度接続しようとしたらできなくなりました） エラーメッセージは #2002 - サーバが応答しません (あるいはローカルサーバのソケットが正しく設定されていません)。 設定ファイルに定義されている管理ユーザ(controluser)での接続に失敗しました。 と表示されました。 他の教えてgooの質問や、ググったりしてそれらしい解決方法は読んでいるのですが、専門用語だらけでほとんど分かりません。 接続ができないと何もできませんし、どなたか具体的にどういった解決方法があるか教えてもらえませんでしょうか・・。（ここの設定を見なおせ・・というアドバイスはありがたいのですが、具体的にその 設定画面までいける方法も教えてもらえると助かります。とにかくどの名前のファイルを開けるのかを教えてほしいです）
お世話になっております。 PHPにてMySQLのデータを取得するスクリプトを制作しています。 （MySQL5) 日付データ（DATE型）カラムを持つテーブルがあり、現在から直近日を取得したとき、そのデータが現在より1ヵ月以内のデータであるか否かを分別したいと考えています。 そこでお聞きしたいのは、データを参照する際、MAX()にて直近日を取得し、そのデータが1ヵ月以内であるか確認するパターンと、max()を使わず、WHERE（条件）にて、1ヵ月以内に収まる日付データがあるか確認しるパターンと、どちらが処理が速く済むのでしょうか？ 他の処理を行うための条件なので、これら処理によりデータを取得する必要はなく、該当する日付があるか否か、という確認だけのものです。 お忙しいなか恐縮ですが、アドバイスのほど頂戴出来れば幸いです。 宜しくお願い致します。
ちょっと壁に当たったので、わかる範囲でお答え頂きたいのですが、 以下のようなテーブルがあったとします。 id　user　price　date 1　A　1000　2013/5/31 2　A　1200　2013/6/1 3　B　1000　2013/5/20 4　A　1500　2013/5/12 5　C　1300　2013/5/31 6　C　1400　2013/5/14 7　C　1000　2013/5/6 8　B　1100　2013/5/24 9　B　1200　2013/5/30 10　B　1100　2013/5/4 11　A　1800　2013/4/12 12　C　900　2013/4/6 ・・・ 次に取得したいのは、 A　1200　2013/6/1 A　1000　2013/5/31 A　1500　2013/5/12 C　1300　2013/5/31 C　1400　2013/5/14 C　1000　2013/5/6 B　1200　2013/5/30 B　1100　2013/5/24 B　1000　2013/5/20 このようなデータなのですが、 条件： １．userでグループ化したうちの日付降順で並べる ２．そのuserのデータの中で、日付降順で並べる ３．userのデータが複数あっても、取得するのは新しいものから3件のみ この条件を満たすSQL文はどのように記述すればよいか、お知恵をお貸し下さい。 よろしくお願いします。
■質問 ・MySQL予約語名でもカラムを作成できるのでしょうか？ ■背景 ・文法エラーSQL文の原因を調べると、どうやら予約語を利用したためだと分かりました ・予約語と知っていたら初めから利用しなかったのですが、その名前で普通にカラムを作成できたので、てっきり使えるものだと思い込んでしまいました ■知りたいこと ・予約語を回避するには、ここをチェックするしかないのでしょうか？ ▽MySQL 5.1 リファレンスマニュアル :: 8.3 MySQLでの予約語の扱い 　 http://dev.mysql.com/doc/refman/5.1/ja/reserved- … ・予約語による影響を受けるのはどんな時？(CREATEは関係ない？)　予約語によって異なる？
さきほどバグがあがってきて対策をしています。 現状、恥ずかしながらテンパってしまっていて 急ぎで、対策するまでの間やりたいことがあるんです・・・。 それは、 「複数あるテーブルすべての、あるカラムの値が０であるすべての行のカラムの値を９に変えたい」です。 もう少し具体的に書きます。 [KOKYAKU_TABLE] [TYUMON_TABLE] [GAZOU_TABLE] という複数のテーブルがあって、 その複数のテーブルには<id>というカラムがあります。 （<id>で関連付けしてあるんです) 全てのテーブルから、<id>の値が「0」になっている行を検索し、 その値を「9」に書き換えたいんです。 何分テンパっていて、 改修作業中にいじられちゃったりしてさらにテンパってます、ごめんなさい よろしくお願いいたします＞＜
MySQLの抽出時間を短縮できないため困っております productテーブル product_id,test_id 86009,'10701,8545' 84334,'12610,9505,13326,9024,1020747,6787,3737,5266' 85078,'1001182,1002129,1003064' 84082,'24723,23417,1002357,1000683,1002258,1003501,25426' 85072,'1008167,1007194,1006309,5240,1009347,30212' 85071,'28079,1007881,1000733,1002367,27836,25141,29863' 86014,'23988,17802,26440,1005928,22668,28372,28135' 83762,'1010127,1010436,1011554,1013949,1014307' test_masterテーブル id,initial_kana 10701,'あ' 21122,'あ' 1002129,'あ' 1002357,'い' 2291,'い' 29863,'い' 23988,'う' 1010436,'え' 22299,'え' 上記の２つのテーブルがあります。 内容は下記のようになります。 productテーブルの product_id：一意のID test_id：test_masterテーブルの一意のID(test_master.id)のカンマ区切りで接続した文字列 実際のレコード数：86,688件 test_masterテーブルの id：一意のID initial_kana：全角一文字のみ 実際のレコード数：14,602件 【やりたいこと】 （１）test_masterテーブルのtest_master.initial_kanaカラムに対応する文字（例えば'あ'）に対応するtest_master.idを取得する （２）（１）で取得したtest_master.id群を元に、productテーブルのtest_idに 　　　該当する（product.test_id文字列の中にtest_master.idが入っているもの）もののproduct.product_idを取得する ということをしたいのです。 （３）例えば、test_master.initial_kana='あ'を取得したい場合、productテーブルのproduct.product_id=86009,85078が取得される 私の作ったSQLは下記のものになります limitとoffsetに関しては、都合上消すことはできません。 ・test_masterテーブルから、test_master.initial_kana='あ'のものを抽出 ・productテーブルから、product.test_idがNULLでないものを抽出 ・上記二つから、FIND_IN_SETで、test_master.idに該当するproduct.test_idの文字列の中から抽出 --------------------------------------------------------- selectp.product_id as product_id, am.id as id from (select id from test_master where initial_kana = 'あ' ) as am, (select product_id,test_id from product where test_id is not null ) p WHERE ( FIND_IN_SET(am.id, p.test_id)!=0 ) group by am.id limit 20 offset 0 --------------------------------------------------------- このSQLを実行すると件数が多いためか 30秒ほど掛かってしまい実用に耐えられない状況です。 すみませんが、SQLに詳しい方がいらっしゃいましたら ご教授をお願いできますでしょうか。 検索が5秒くらいまで短縮できれば万々歳なのですが… よろしくお願いいたします
php初心者です。 （DB：mysqlをphp（PDO）で操作） 最近PDOの勉強をし始めましたが、記述の際に （接続に関する部分）と（クエリに関する部分） の記述位置に関してのルールがはっきりしません。 上記２つを続けて記述をすれば問題なく動くのですが、例えば、 ----------------------------------------------------------------------- try{ $link = new PDO($db, $user, $pass); }catch(PDOException $e){ echo 'データーベースに接続できません。' . $e->getMessage(); } ----------------------------------------------------------------------- だけ先に記述しておき（接続しておいて）、その後htmlやphpの記述をはさみ、 必要な部分で以下のように（クエリ）の記述をした場合、動きません。 <?php $stmt = $link->query('SELECT * FROM booked order by rsvTime asc'); ?> <table border="1"> <tr> <th>予約時間</th> <th class="wdt_at">施術開始</th> <th class="wdt_at">施術終了</th> <th>予約未、済</th> </tr> <?php if (!$stmt) { $info = $link->errorInfo(); exit($info[2]); } 　　　　　　　　 　　　　　　（※ここでクエリしたものを使用） 　　　　　　　　　　　　↓ while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) { print "<tr>\n"; print "<td>".htmlspecialchars($row["rsvTime"])."</td>\n"; print "<td>".htmlspecialchars($row["startTime"])."</td>\n"; print "<td>".htmlspecialchars($row["finishTime"])."</td>\n"; print "<td>".htmlspecialchars($row["kafuka"])."</td>\n"; print "</tr>\n"; } print "</table>"; ?> ■質問内容 そこで質問です。PDOの接続とクエリの記述位置やその他のルールを 詳しく教えて下さい。 よろしくお願いします。
php+mysqlでシンプルな会員登録を作りたいのですがパスワードは暗号化したほうがいいですか？ パスワードを簡単に暗号化できる方法はありますか？ postされたpassと暗号化されたpassのチェック方法がわかりません ログイン if ($_POST['id'] !='' && $_POST['pass'] !='') { $sql = sprintf('SELECT * FROM hoge WHERE id="%s" AND pass="%s"', mysql_real_escape_string($_POST['id']), mysql_real_escape_string($_POST['pass']) ); $record = mysql_query($sql) or die(mysql_error()); if ($table = mysql_fetch_assoc($record)) { $_SESSION['id'] = $table['id']; $_SESSION['name'] = $table['name']; } else { //エラー }
会員の名前の更新するときに、会員以外の重複がないか調べたいです 会員以外のidと名前の一致を取得しようとしましたがうまくうごきません やりたいことは 会員以外の名前と入力した名前が重複してないか調べたいです $id = mysql_real_escape_string($_POST['id]); $name = mysql_real_escape_string($_POST['name']); $name3 = mysql_query("SELECT name FROM hoge2 WHERE NOT id='.$id.' AND name='".$name."'");
MySQLの外部結合について教えてください 「結合の対象となっているカラムの値が一致」は必須なのでしょうか？ ■やりたいこと ・Aテーブルaカラム内にある「デリミタの先頭文字列」を抽出して、Bテーブルのidカラムと結合したい ■最終的にやりたいこと ・上記一致条件で、両テーブルデータをSELECTしたい ■試したこと ・「SELECT SUBSTRING_INDEX」で「デリミタの先頭文字列」を抽出できたのですが、そこで行き詰まりました ■質問 ・そもそもやろうとしていることが無謀なのでしょうか？ ・テーブル構成を見直した方が良いのでしょうか？
検索対象項目が http://www.AAA.com/中略/0109.html http://www.AAA.com/中略/acb.html や http://www.AAA.com/中略/0110-1.html であったとき 文字列の右から判断して 0109.html 0110-1.html のように数字が入っている場合のみ、検索結果の対象としたいと考えてます。 上記に関する、SQL文の書き方を教えていただけないでしょうか？ 以前、 SELECT * FROM テーブル名 WHERE フィールド名 REGEXP '/[0-9]+\\.html$' と教えていただいたのですが、対象テキストに「-」が入っているケースが増えてしまったので 改めて質問となります。 正規表現の箇所次第なのかと思うのですが、、どうもわからりません。。 よろしくお願い致します。
IF もしくは CASE文(？)を利用して、FROM 箇所を変更することはできるでしょうか？ ■やりたいこと ・「hoge_id」カラムが0だったら、普通に「redult」カラムからデータ取得 ・「hoge_id」カラムが0以外だったら、「hoge_id」」「id」カラムで自己結合したテーブル(ビュー？)から「result」カラムデータ取得
ただいま『基礎からのmysql」という本で、ＭＹＳＱＬの勉強をしています。 本の中の、18-03という問題で <?php $s=mysql_connect("localhost","root","PASS") or die("失敗です"); print "成功しました。<br />"; mysql_select_db("db1".$s); mysql_query("INSERT INTO tb1 VALUES('k888','エスキュ',25)"); $re=mysql_query("SELECT * FROM tb1"); while($kekka=mysql_fetch_array($re)){ print $kekka[0]; print ":"; print $kekka[1]; print ":"; print $kekka[2]; print "<br />"; } mysql_close($s); ?> このような文章があるのですが、うまく動きません。 ----------------------------------------------- 成功しました。 Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in C:\xampp\htdocs\sounyu_hyouzi.php on line 9 ----------------------------------------------- ↑のエラーを返すのですが、 スペルミスなどはなく、さっぱり原因がわかりません。 line9ということなので、 while($kekka=mysql_fetch_array($re)){ に問題がありそうな気もするのですが、見当もつきません。 ちなみに、 コマンドプロンとで、SELECT * FROM tb1をやると +------+-----------+------+ | bang | nama | tosi | +------+-----------+------+ | A101 | SATOU | 40 | | A101 | SATO | 40 | | A101 | NAKAGAWA | 40 | +------+-----------+------+ と表示され、 show databases;でも +--------------------+ | Database | +--------------------+ | information_schema | | cdcol | | db1 | | db21 | | db511 | | mysql | | performance_schema | | phpmyadmin | | test | | webauth | +--------------------+ このように表示されますので、データベースやテーブルの問題ではないのかと思います。 なにかピンとくる方おられましたらよろしくおねがいします。
お世話になります。 MySQLでテーブルのカラムを編集(追加・修正・削除)するのに、 CUI以外で行う管理ツールはあるのでしょうか。 初心者なのでコマンド操作に戸惑っております。 どうぞよろしくお願いします。
mysqlで ■address_book +------+------+------+ | code | tel | name | +------+------+------+ | 41 | 012| android | +------+------+------+ ■customers +------+------+------+ | code | title | name | +------+------+------+ | 41 | abc| android | +------+------+------+ SELECT * FROM address_book NATURAL JOIN customers; で自然結合を行って、 その結果 +------+------+------+------+ | code | title | name |　tel | +------+------+------+------+ | 41 | abc| android | 012| +------+------+------+------+ と結果が出て、 この結果を +------+------+------+ | title | code | name | +------+------+------+ | abc | 41 | android | +------+------+------+ の順に表示させる様に、SQLを実行したいのですが、 SELECT * FROM address_book NATURAL JOIN customers; SELECT title, code, name FROM address_book; と連続でコマンドを実行できる方法はないのでしょうか？ phpmyadmin でSQLを実行しています。 お分かりになられる方、ご教授お願い致します。
MEMORY エンジンの説明にはテーブルサイズ制限の記載がないようですが、 InnoDBと同様に64TBまで、という解釈で良いでしょうか。 （現実にはそんなにメモリを搭載した環境はないと思いますが） 今検討しているデータベースではデータ容量の見積が最大100GBなので、 メインメモリ128GBのサーバで max_heap_table_size=110G とすれば データ全体をメモリ上に収容できると考えて良いでしょうか。
新規登録の時の重複をチェックしたいです テーブルのカラムはシンプルにidとnameとpassだけです nameに同じ名前の人がいると困るので、HTMLフォームから送られた名前と登録してある名前の重複がないかチェックするようにできますか？ やってみましたが動きません(ーー；； $name = mysql_real_escape_string($_POST['name']); $name3=array(); $name2 = mysql_query('SELECT name FROM hoge2 WHERE name=$name'); while($data = mysql_fetch_assoc($name2)) { array_push($name3, $data['name']); } if(isset($name3)){ print "重複があります"; }else{ //ここからsql $sql = sprintf('INSERT INTO hoge2 SET name="%s", pass="%s"', $name, mysql_real_escape_string($_POST['pass']) ); //ここまで mysql_query($sql) or die(mysql_error()); }
初心者です。 ユニークキーでここのレコードにコード番号をつけたいのですが、AUTO_INCREMENTでは数字しか対応してもらえず、A101.A102のようなコード番号を自動でつけることができません。 最終的にはAテーブル　Bテーブルというかたちで作っていき、場面場面でグループ化などしたいので、アルファベットがほしいのですが、そういう場合はどのようなやり方をするのが主流なのでしょうか？
すでに作ってしまったテーブルにユニークキーを付けたいと考えています。最悪の場合、新しくカラムを作っての追加でもかまわないのですが、いろいろ試してもエラーが返されてしまいます。 codeというカラムにユニークキーを設定したいのですが、 alter table テーブル名 modify unique code; alter table テーブル名 add unique code2; alter table テーブル名 modify code unique; alter table テーブル名 add code2 unique; alter table テーブル名 modify code test unique; alter table テーブル名 add code2 test unique; alter table テーブル名 modify unique code test; alter table テーブル名 add unique code2 test; alter table テーブル名 modify (code unique); alter table テーブル名 add (code2 unique); alter table テーブル名 modify (code text unique); alter table テーブル名 add (code2 text unique); など、思いつく限り試し、グーグルで調べる限り調べたのですが、出てきたものをためしてもダメでした。 テーブルを作成した後、カラムにユニークキーを設定した経験のある方、どのように変更をしたのでしょうか？
予約システムの時間を管理するような部分の記述がわかりません。 時間を比較するにあたり、ある値から1時間引いた値を利用したい ですが、その１時間を引くという記述がわかりません。 以下の５行目の一番最後の部分はどう記述したら良いですか？ 1: "select *from 2: timeTpl as t left join booked as b 3: on t.bookTime>=b.rsvTime and t.bookTime<b.finishTime 4: && 5: t.bookTime<b.rsvTime and t.bookTime<'b.rsvTime - 01:00:00' 6: where b.rsvTime is not null"; 　↑ うまくうごきません。 [db] ・timeTpl : 予約時間の候補を納めたテーブル 　　（ex.10:30,11:00,11:30,12,00・・・・） ・booked : すでに予約済みのデーターを収めたテーブル （予約時間rsvTime=（来店時間）、矯正時間startTime、矯正終了時間finishTime） ※時間の関係する部分は"time型"となってます。 ちなみに最終的に行いたいことは・・・ コースごとに取得できる予約時間が決まっています。（timeTpl) 予約時間の３０分後から矯正が始まり、その１時間後に終了します。 timeTpl（予約候補時間）の中から、予約可能なものだけを表示したい。 よろしくお願いします。
こんにちは。 最近仕事でmysqlを使い始め、データベースの操作自体はなんとかなっているのですが、phpのチェックボックスでデータベースから検索し、一覧として表示する際、カテゴリ毎に分けて表示したいと考えているのですが、うまいやり方がわかりません。 こういう感じです。 ケーキ（大カテゴリ） 　　チョコ（中カテゴリ） 　　　　商品1 　　　　商品2 　　　　商品3 　　ミルク（中カテゴリ） 　　　　商品4 　　　　商品5 　　　　商品6 アイス（大カテゴリ） 　　チョコ（中カテゴリ） 　　　　商品7 　　　　商品8 　　　　商品9 　　ミルク（中カテゴリ） 　　　　商品10 　　　　商品11 　　　　商品12 この際、それぞれの商品には大カテゴリ、中カテゴリが設定されています。 また、検索の仕方によっては、いきなり2つめの大カテゴリから始まることもあります（ケーキカテゴリが1件もヒットしない）。 mysql_fetch_assocを使って呼び出そうと思うのですが、その中でさらに条件で分けて書く方法がありましたら教えていただきたいです。 自分でも状況があまり分かっていないので、何か情報が足りないと教えていただければ追記いたします。 よろしくお願いします。
MySQLで複数テーブルからデータ取得する際、 FROMの後に、テーブル名を2つ書いて、「WHERE」で繋げる書き方と、 「JOIN ★★ ON」で繋げる書き方では、何が違うのでしょうか？ ・「INNER JOIN」と同じ意味でしょうか？ ・書き方によっては、「LEFT OUTER JOIN」みたいにも書けるのでしょうか？ ・普通は、どちらの書き方で書くとか、そういうお作法的な暗黙の了解はあるでしょうか？ ・例えば「WHERE」だと3つ以上繋げられない(？)から、奨励されていない、とか…
php独学（数ヶ月）の初心者です。 予約を管理するプログラムを自分でつくっています。 調べても調べてもどの関数をどのように使えば 良いかわからないまま数日がたってしまいました。 （初心者のため知らずに勉強し始めてしまった非推奨のmysql関数等を とりあえずまだ使用しています。mysql関数で教えていただければと思います。 ある程度理解を深めた時点できちんと勉強しなおします） ■予約の概要 コースごとに取得できる予約時間が決まっています。 予約時間の３０分後から矯正が始まり、その１時間後に終了します。 （予約時間に来店、30分間マシーンに乗り、その後先生の矯正が １時間ある。） ■作成したDB [DB01]予約時間テンプレート：time1 コースごとに取得できる予約時間が決まっています。 （以下はあるコースの予約可能時間のテンプレです。） id, time（time型） 1,10:15 2,11:45 3,14:30 4,16:00 5,17:30 6,19:00 [DB02]予約済みを貯めたDB：booked (時間はすべてtime型） id,name,time,start,finish,course 203,tanaka,10:00,10:30,11:30,a 101,abe,14:30,15:00,16:00,a 112,yoshida,17:00,17:30,18:30,c ■質問 [DB01]のうち予約可能な時間のみ<select>文で表示させたい。 ちなみ（予約可能な時間）は、11:45,16:00,19:00の３つです。 色々考えましたが、今の自分の実力では上記を実行させるコードが断片的に しか分からずお手上げとなりました。 よろしくお願いします。
mysql素人です group_idが登録者番号で5000以上の情報を持たせたいのですがテーブル設計がわかりません 才能ないなりに考えたのですがこんなテーブルしか思い浮かばないです・・・どんどんインサートしていく感じで考えたのですが良く考えたら、登録者が1万人くらいになったら1千万行くらいになって重くなる気がしました。もっと効率の良いテーブル設計ないでしょうか？ id group_id valu idは単なる行の番号、valuが点数の情報です
PHP（４.3.11）でMYSQL（5.0.81）に接続しようとすると接続できず、 Client does not support authentication protocol requested by server; consider upgrading MySQL client というエラーになります。 PHP文はこのように記述しています。 <?php $con = mysql_connect("localhost","root","password"); if (!$con) { print(mysql_error()); exit('データベースに接続できませんでした。'); } ?> my.cnf　に　old_passwords=1　を記述し、mysqlを再起動したのですが同じエラーでした。 他に設定しなければならない事があるのでしょうか？
ブログの1エントリーを、複数カテゴリーに属するようにしたいです。 ■テーブル構成？ ・「エントリーテーブル」「カテゴリーテーブル」 ・エントリーテーブルの1カラムで、属する「カテゴリーid」を保存するのでしょうか。例えば「2,3」みたいに ・この時、あるカテゴリーに属するエントリーをSELECTするにはどうすれば良いでしょうか？
テーブル作成について勉強しています。 将来、フィールドが増えてもいいようにテーブルをつくるには、 どのように作るべきでしょうか。 例えばですが、現時点で必要なフィールドは２つだけ（id,name）ですが、 今後、５つぐらいフィールドが増えても問題ないようにしたいです。 ご教授いただけませんでしょうか。 宜しお願い致します。
mySQLを使ってます。 SQL文で以下のことが実現したいです。 フィールドに登録されている文字列が http://www.AAA.jp/BBB/CCC/08191.html/?cp=waribiki http://www.AAA.jp/shop/DDD/EEE/08191.html http://www.AAA.jp/shop/DDD/EEE/ZZZ.html というタイプがあります。 SQL文で検索結果を表示したいのは、 http://www.AAA.jp/shop/DDD/EEE/数字.html のように右から「数字.html」の場合のURLパスだけを抽出したいです。 SELECT * FROM `テーブル名` WHERE `フィールド名` LIKE '%html' とやってみましたが、 http://www.AAA.jp/shop/DDD/EEE/ZZZ.html というものもヒットしてしまうため 右から「数字.html」の場合だけのSQL文の書き方を教えていただけないでしょうか？ よろしくお願い致します。
mysqlとperlを勉強中です 2つのテーブルから同じIDの情報を取得したいです。 hoge1テーブルとhoge2テーブルのIDは共通で一致しています。 （実際にはフィールドはもっと多いですがわかりやすくしています） hoge1テーブルは3つフィールドがあります ID　INT1　INT2 hoge2テーブルは3つフィールドがあります ID　TEXT1　TEXT2 hoge1テーブルで取得するのは数字が一致したIDです SELECT id FROM hoge1 WHERE int1=10 or int2=10 ORDER BY id hoge2テーブルで取得したいのはhoge1テーブルで取得したIDのTEXTです。やりたいことはこんな感じです SELECT TEXT1,TEXT2 FROM hoge2 WHERE id=hoge1テーブルで取得したID ORDER BY id; while (my $rec = $sth->fetchrow_array) { push(@recs, $rec); } perlでは配列で取得して後で、foreachで100個ほどprintしています。 hoge2も同じように取得したいのですが、hoge2はフォームを空白で送信できるようになっているので値がなにもないときがあります 配列に入れてしまうと空白のレコードがあるとその分、配列がずれてしまいます hoge1テーブルで取得したIDとhoge2テーブルで取得したテキストのIDを一致させる方法はありますか？ やりたいのはこうゆうことです。 テーブル1で値が一致しているIDを取得する テーブル2でテーブル1で一致したIDのテキストを取得する リレーションも考えましたが素人なのでピンときませんでした テキストのほうも配列で取得して100個ほどprintしたいのです よろしくお願いします
お尋ねします。 ＭｙＳｑｌのINNODBのファイル容量を削減する方法は、 １．mysqldump -A -u root -p パスワード --opt > ダンプファイル名　でダンプ ２．ＤＢファイルを”ｒｍ”で削除（あるいは、別フォルダに退避） ３．CREATE DATABASE データベース名 CHARACTER SET utf8;　でＤＢ再構築 ４．mysql -u root -p パスワード < ダンプファイル名　でリストア で、良いんでしょうか？（＾＾；
お世話になっております。 データベース名:payment_daibiki（MySQL 5.1） daibiki_no　postage_price_min　postage_price_max　daibiki_price 1　　　　　　　0　　　　　　　　9999　　　　　　　　315 2　　　　　　10000　　　　　 　29999　　　　　　　　420 3　　　　　　30000　　　　　　 99999　　　　　　　　630 4　　　　　 100000　　　　　　300000　　　　　　　 1050 という内容のテーブルがあります。 これは商品を発送する際の代引手数料が格納されているのですが、 postage_price_minと、postage_price_maxを参照して、この範囲内の手数料を 抽出するというものです。 例えば、発送する商品の代金が、2240円の場合、 postage_price_minより多きく、postage_price_maxより小さいものを参照するので、 求める手数料は315を返したいと考えています。 そこで質問なのですが、 SELECT * FROM payment_daibiki WHERE postage_price_min <= '2240' AND postage_price_max >= '2240' とSQLを実行させると、該当するデータはないと返されてしまいます。 初歩的な質問ですが、どこに誤りがあるのでしょうか？ また、一番小さな手数料を求めるため、 SELECT * FROM payment_daibiki ORDER BY daibiki_price DESC LIMIT 1 と実行させると、630が返ってきてしまいます。 初歩的な事とは重々承知していますが、色々と設定を変えても返ってくるデータが どれも予想を反するもので、どこに誤りがあるのか分からなくなってきました。 以上ですが、このような状況、どういったことが考えられるのでしょうか？ お忙しいなか恐縮ですが、アドバイスのほど頂戴出来れば幸いです。 宜しくお願い申し上げます。
はじめまして、私は、本業は3DCGで趣味でWeb系のツール開発をしている者です。 localhostでうまくページを表示できなくて困っています。 作っているものがCG用の開発ツールで外部に公開するものではなく、 ローカル環境のみでの使用になります。 開発環境はwindows7 64bit PHP5.3.23　Apache2.2 MySQL5.5になります。 個人で取得しているドメインのサーバーにデータをアップして見ると正常にページが 表示されますので記述したコード自体には問題はなさそうです。 昔WindowsXPで構築したマシーンのlocalhostでも正常表示されます。 以下、Windows7のlocalhostでの挙動になりますが、 (1)phpinfoのページは正常に表示されます。 (2)PHPからのMySQLへの接続とデータの取得もうまくいきます。 (3)しかし、MySQLのデータを取得し、formのselectを用いて <option value='<?=$c[$i]?>'><?=$c[$i]?></option> と記述するとルックアップメニューには空文字が入力されてしまいます。 (4)そこであえて(3)の記述を <<option value='<?php echo $c[$i]?>'><?php echo $c[$i]?></option> のように書くとなんとかメニューにMySQLのデータが入ってきます。 (5)しかし、以下のように $cate=$_GET[cate];　 などのような文を記述するだけでエラーが起きてしまいまして どう対処してよいかわかりません。 localhost環境で何か設定すべきところをしていないのか、 windows7のセキュリティの問題なのかわかりませんが、 どうしたら解決しますでしょうか。 当方、Web系は中規模ネットショップを独学で構築したレベルで実務経験はありません。 そのため難しい表現をされると理解できませんので、 あくまで初心者むけということで指導していただけると幸いです。
お世話になります。 ネットショップでの送料の計算を行いたいのですが、どのようなSQL文が適切なのか、アドバイスを頂戴したく質問させて頂きます。 以下のようなテーブルがあり、都道府県、サイズ、送料が登録されています。 no　　addr　　size　　price 1　　大阪府　140　　630 2　　大阪府　160　　840 3　　福岡県　140　　735 商品毎に商品サイズ、および発送先（都道府県別）によって、送料を抽出したいと考えているのですが、 １．同じ都道府県の登録、かつ不注意により同じサイズが登録されている。 ・・・この場合は、LIMIT　1として抽出。 ２．該当するサイズが登録されていなかった。 ・・・この場合は、同じ都道府県から一番大きな金額を抽出。 ３．該当する都道府県が登録されていなかった。 ・・・この場合は全てから一番大きな金額を抽出。 と、考えられる想定を事前に施しておきたいのですが、この場合どのようなSQL文になるのでしょうか？ PHPで制作しているのですが、１つのSQL文が思いつかずTRUEとFALSEで処理する形になってしまい、該当する都道府県がなかった場合は、結果、3度もDBに問い合わせてしまう形になっています。 お忙しいなか恐縮ですが、アドバイスなど頂戴出来れば幸いです。 申し遅れましたが、DBはMySQLの５を利用しています。 宜しくお願い致します。
イメージ的にはこのような感じです。 SELECT * from table where REPLACE(name,'★','') like %佐藤%; 例えばnameが★佐★藤★というレコードがあった場合、like %佐藤%ではヒットしませんが、★を消去して検索すればヒットします。 ★を消去して佐藤が含まれる文字列を検索したいのですが、どのようなsql文にすればよいのでしょうか？ ご教示いただけると幸いです。 宜しくお願い致します。
mysqlを使用しております。 下記のようなテーブルを作りたいと思っているのですが、 親通し番号が同じ行についてのみ1からオートインクリメントすることは出来るのでしょうか？ どなたかアドバイス頂ければと思います。 -------------------------------------------------------------------------------------- column1：親番号 column2：子通し番号 　　・ 　　・ 　　・ column1：1 column2：1　←カラム1が同じ値のとき、カラム2はinsertされた順に増えていく column1：1 column2：2 column1：1 column2：3 column1：2 column2：1　←カラム1が増えたとき、カラム2は1に戻りインクリメントされていく。 column1：2 column2：2 column1：2 column2：3
テーブル１をテーブル２で設定したのを基に並び替えをしたいんですがどうすればいいんでしょうか たとえばテーブル１のフィールド１に名前　２に年齢があり テーブル2の１に名前　２にふりがな テーブル２で設定したふりがなを基にテーブル１を並びかえる
hoge_●● hoge_★★ など、テーブル名が「hoge_」で開始するテーブルを、削除するSQL文を教えてください
プログラム素人です。 初心者なのでこんなテーブルを思いつくのですが、これってカラムをいちいち作らないといけないので後のメンテが大変な気がします CREATE TABLE hoge( id INT PRIMARY KEY, item1 VARCHAR(255), value1 INT, item2 VARCHAR(255), value2 INT, item3 VARCHAR(255), value3 INT ); こんな感じのテーブルにどんどんINSERTしていきたいのです CREATE TABLE hoge( id INT PRIMARY KEY, item VARCHAR(255), value INT ); 聞きたいこと MYSQL側 IDにPRIMARY KEYが付いているのですが2つ同じPRIMARY KEYはINSERTでききませんよね？どうすればいいでしょうか？ perl側 IDごとにまとめて取得して配列に入れる方法はありますか？ idが1のアイテムを全部取得して配列に入れる方法がわかりません（他にいい方法があったらお願いします） よろしくお願いします
●質問の主旨 コマンドプロンプトでMySQLを呼び出し、 SELECT * FROM db1.tb1; とデータベースとテーブルの全内容を呼び出すと、 文字化けがします。 普通に日本語を表示させるためには、どうしたら良いでしょうか？ ご存知の方、よろしくお願いします。 ●質問の補足 先日から、他の質問でも、文字化けが発生しています。 対応するために、「あれこれ」いじっているうちに、 MySQLでも文字化けが起こりました。 「あれこれ」いじった内容は、記憶が定かではありません。。 ●関連質問 eclipseの文字化けについて（PHPファイル) http://okwave.jp/qa/q8068188.html なぜ何も表示されないのか？ http://okwave.jp/qa/q8065031.html ●開発環境 windows8 xammp1.8.1 (phpmyadmin)
ＤＢ名に"-"を使いたいと思います。 ところが、コマンドから入れると、下記のようにエラーになってしまいます。 mysql> create database a-test; ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '-test ' at line 1 しかしながら、ｐhpMyAdminの方からは、作成することが出来ます。 コマンドの方からa-testと言ったＤＢを作成するのにはどうしたらいいのでしょうか？ 尚、バージョンは5.5.27です。 宜しくお願いします。
mysqlのtext型の文字数は何文字くらいまで入るのですか? 例えばひらがなの「あ」で何文字くらい入りますか? 200文字くらいの誤差はあってもいいのです 日本語を入れる場合は何文字くらいに制限するのがいいでしょうか？ よろしくお願いします
すいませんphpとmysqlの処理のしくみがわかってないです phpの処理の中でmysqlからSELECTで値を取得する場合 mysqlが大量のデータで処理に時間がかかった場合は、SELECTの処理に5秒くらいかかっても、phpの処理の中でそこで待ってくれているんですか？ SELECTの処理が何秒かかったとしても終わってから次のphpの処理にいっているんですか？ phpって速いのにmysqlのスピードが遅かったらちゃんと読み込まれないんじゃないかと心配になっています
SSHを使ったmysqlのエクスポート方法を教えてください LinuxコマンドもMysqlも初心者ですが、最近SSHを使ってレンタルサーバーに接続をしていろいろと試してみています。 以下を試してみましたが、エラーが出てでエキスポートできませんでした。 1. $mysql -h サーバー名 -u ユーザ名 -p 2. mysqlのパスワードを入力してmysqlにログイン 3.mysql> mysqldump -u サーバー名 -p データベース名 > testdump.sql; ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'mysqldump -u サーバー名 -p データベース名 > testdump.sql' at line 1　というエラーができてエクスポートできません。 mysql> mysqldump --user=ユーザ名 --password=パスワード名 データベース名 < testdump.sql も試してみましたができませんでした。 以上のものは全てweb上で見つけたコマンドです。 よろしくお願いいたします。
以下の2テーブルの構成で、from_uid毎のto_uidへの在庫移動個数(val)を集計したいと考えています。 ユーザテーブル(user)：uid(int), name(string) 在庫移動管理テーブル(zaiko)：id(int), from_uid(int), to_uid(int), val(int) たとえば、それぞれ以下のようなレコードがあった場合、 <user> uid, name 1 aaa 2 bbb 3 ccc <zaiko> id, from_uid, to_uid, val 1 1 2 3 2 1 2 5 3 2 1 1 4 3 1 4 結果として、以下を得たいと考えています。 uid=1で検索した場合 to_uid, val 1 0 2 7 3 -4 uid=2で検索した場合 1 -7 2 0 3 0 uid=3で検索した場合 1 4 2 0 3 0 （イメージとしては、対戦表？の以下のような表を一行ずつ取得する様な感じです。） ___1__2__3 1__0__7_-4 2_-7__0__0 3__4__0__0 上記のような結果を得たい場合、どのようなSQLを書けばよいのでしょうか。 内容について、わかりづらい点等がありましたらご指摘ください。
ズブの素人です。 わけあって素人である私がssh接続でサーバーをいじらねばならず、 データを直接書くことの恐さだけは知っているため、非常にビクビクしています。 教えてくれる人もおらず、大変困っております； どうしてこんなことになってしまったか、それが一番の問題なんですが、 直下の問題に対応するため、何卒知恵を頂戴いただけますと幸いです。 本当に素人なので稚拙な質問になってしまうと思いますが、 何卒教えていただけますと幸いです。 （mysqlに触るのも、SSHログインするのも人生初です） ■やりたいこと 『_utf8』というデータベースの中に『blog』のテーブルがあり、その中にブログがたくさん入っています。 ブログには作成者の項目が紐づいており、また、公開/非公開を決めるフラグ（0で公開、１で非公開）がついています。 今とある作成者（仮にtanaka）が書いたブログの中で、 2013/1/1までに書かれたブログを非公開にしたい（非公開フラグを１にしたい）です。 ■自力で調べたところまで 自分で調べた結果が下記のmysqlなのですが、 フラグを１にする、UPDATEの文章と 範囲を指定する、SELECTの文章の紐付けが 全く自身がありません。。。 ＝＝＝＝＝＝＝＝＝ UPDATE `blogdb_utf8`.`blog` SET `blog_trash` = '1' SELECT * FROM `blog` WHERE `user_id` LIKE 'tanaka' AND `send_time` <= '2013-01-01 00:00:00' ＝＝＝＝＝＝＝＝＝ 正直絶対どこか間違っているという 逆の自信だけございます。 ■さらに御聞きしたいこと teratermからsshログインというものを人生初しました。 ログインしたあと、ここからどこにcdして、上記の実行文を入れたら良いかがわかりません。。。 おそらく非常に初心者な質問をしているのだろうと自覚しておりますが、 何卒よろしく御願い致します
コマンドラインが使えない共有レンタルサーバーを使用しております。 大きなmysqlファイルでもインポートできるbigdumpというものを見つけましたが、こちらはインポート用のみのようです。 http://www.ozerov.de/bigdump/ 現在、レンタルサーバー上のmysqlが大きくなり過ぎて一括ではエクスポートもできなくなっております。 そこで質問なのですが、テーブルを分割してエクスポートする以外に、大きなmysqlでもエクスポートできる何かbigdumpのようなものは存在するのでしょうか？ よろしくお願いいたします。
今現在、PHP MySQLにてDB＆簡単なCMSを作成中です。 仕入テーブル(id, date_y, date_m, id_cost, price, etc...)と勘定項目テーブル(id_cost, name_cost)をid_costをキーにして連結し、月々の勘定項目ごとの集計画面を作成したいのです。 SELECT 仕入テーブル.date_y, 仕入テーブル.date_m, 仕入テーブル.id_direct_cost, 勘定項目テーブル.name_cost, SUM(仕入テーブル.price) AS sumcost FROM 仕入テーブル NATURAL JOIN 勘定項目テーブル WHERE 仕入テーブル.date_y="'.$y.'" AND 仕入テーブル.date_m="'.$m.'" AND 仕入テーブル.typecost="direct" AND 仕入テーブル.id_direct_cost=勘定項目テーブル.id_cost ※$y, $mは集計画面で選択された年月です。 とすると、月々の合計が抽出され、勘定項目ごとの集計ができません。 当方、半年くらい学校にてPHP MySQLを習ったのですが、まだまだ未熟者のため解決できません。 お力をお貸しいただけますと大変ありがたく存じます。 どうぞよろしくお願い致します。
●質問の主旨 下記のサイトを見ながら、データベースのテーブルを インポートしようとしていますが、エラーが出ます。 この場合、phpmyadminのどこを確認すればよいでしょうか？ ご存知の方、ご教示願います。 http://www.dbonline.jp/phpmyadmin/export-import/ … ●開発環境 windows8 xammp1.8.1 ●エラーの内容（添付画像） エラー 実行した SQL: -- -- データベース: `mydb10` -- CREATE DATABASE `mydb10` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci; MySQL のメッセージ: #1007 - Can't create database 'mydb10'; database exists ●インポートの内容(mydb.sql) -- phpMyAdmin SQL Dump -- version 3.5.2.2 -- http://www.phpmyadmin.net -- -- ホスト: 127.0.0.1 -- 生成日時: 2013 年 4 月 20 日 08:27 -- サーバのバージョン: 5.5.27 -- PHP のバージョン: 5.4.7 SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO"; SET time_zone = "+00:00"; /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */; /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */; /*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */; /*!40101 SET NAMES utf8 */; -- -- データベース: `mydb10` -- CREATE DATABASE `mydb10` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci; USE `mydb10`; -- -------------------------------------------------------- -- -- テーブルの構造 `db10` -- CREATE TABLE IF NOT EXISTS `db10` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` text NOT NULL, `address` text NOT NULL, `tel` text NOT NULL, PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT=4 ; -- -- テーブルのデータのダンプ `db10` -- INSERT INTO `db10` (`id`, `name`, `address`, `tel`) VALUES (1, 'あああ', 'いいい', '111'), (2, 'ううう', 'えええ', '222'), (3, 'おおお', 'かかか', '333'); /*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */; /*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */; /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
SSH接続によりTera Termを使ってmysqlに接続しています。 今までmysqlにはphpmyadminでしかアクセスしたことがなく、初めてコマンドで挑戦中です。 mysql> show databaces　というコマンドを打つと ->　　　 という表示がされて、それ以降何を打っても　-> しかでてきません。 ->というのはどのような意味なのでしょうか？ また、どうのように mysql>　の表示に戻せるのでしょうか？ よろしくお願いいたします。
CentOS6.3(64bit)にmysql-serverとmysql-develをインストール後 mysql>　の状態の時に mysql> mysql -u root -p　と入力したところ mysql> mysql -u root -p -> 上記の画面になり 抜けようとして「quit」「bye」「exit」やら打ち込んでenterしても -> の文字がずーと出続けます。 mysql> mysql -u root -p 　　　-> quit 　　　-> bye 　　　-> quit こんな状態です。 抜ける「キャンセル」したいのですがどのようにすればよいのでしょうか。
col1|col2|col3|col4|col5 1001|1003|20|15|5 1002|1001|23|20|3 1003|1002|40|36|4 1003|1003|40|32|4 1003|1003|30|28|4 1004|1003|20|15|5 1004|1004|14|10|5 1005|1004|23|17|6 1006|1005|20|13|7 のようなテーブルを作成し、col1に対してcol2は、行ずれで入力されています。 col1とcol2が違う場合、col3-col5をcol4へ 。 col1=col2の場合、1行上のcol4-col5としています。 EXELでは　=IF(A3=B3,D2-E3,C3-E3)　として出力でるのですが、 Mysqlでこれを実現するにはどうしたら良いでしょうか。 col1とcol2がマッチしない場合は、通常処理としてcol3-col5をcol4に行い、 マッチする場合は、通常処理で行われたcol4-col5をcol4へ出力します。 マッチが連続すれば、col4-col5が繰り返されるイメージです。 よろしくお願いします。
Access初心者で、独学で頑張っています。 どうしても一人で解決できないので、教えてください。 下記のようなコードを書きましたが、＃１で　『PARAMETER句の構文エラーです』　となります。 Dim qd As DAO.QueryDef Dim rs3 As DAO.Recordset Dim mySQL As String Set qd = CurrentDb.CreateQueryDef("") mySQL = "PARAMETERS [ParaヘッダーID] COUNTER;" mySQL = mySQL & "SELECT [テーブルA].[明細ID], [テーブルA].[ヘッダーID] " _ & "FROM テーブルA " _ & "WHERE ((([テーブルA].[ヘッダーID])='ParaヘッダーID'));" With qd .SQL = mySQL 　 '　#1　ここで『PARAMETER句の構文エラーです』　となる .Parameters("ParaヘッダーID") = [TempVars]![tempヘッダーID] Set rs3 = .OpenRecordset() End With （この後、処理を続ける） やりたいことは、 「テーブルA」から、「ヘッダーID」が一時変数[TempVars]![tempヘッダーID]と一致するデータを抜き出し、後続の処理に使いたいのです。 なお、ヘッダーIDは長整数型で、[TempVars]![tempヘッダーID]をウォッチで確認すると整数が入っていました。 SQLについて、いろいろ調べて試しましたが、なかなか上手く行きません。 どこが違うのかご教授お願いします。
恐れ入ります。 Mysqlにて、ひとつ上のレコードを参照し、 真であれば○○偽であれば××という処理をしたいのですが、どのような方法がありますでしょうか。 EXELで行うと、=if(A1=A2,"1","0") のような処理になります。 昇順で並び替えて、重複レコードについて処理を行いたいです。 よろしくお願いします。
MySQL 5.6 なのですが・・・・ ＤＢの文字コードはＤＢ作成後にデータを登録した後に、途中で文字コードを変更した場合、ＤＢに登録済みの全角文字はどうなりますか？ 文字化けする場合、変換ツールのようなものはあるのでしょうか？ また文字コードの変更は ini ファイルを変更してMySQLを再起動するだけでいいのでしょうか？
MySQL勉強中です。Windows7のコマンドプロンプトでデーターを入力したいのですが、日本文字がエラーになります。 コマンドプロンプトの文字コードがシフトJISになっているので、chcp65001でutf-8にコード変換しました。しかし、日本文字が表示されません。 MSゴシックにフォント設定をしてから再度utf-8に変換しましたが、やはり日本語選択が出来ません。 ネットの情報によると、最初にMSゴシックに設定しないでコード変換してしまうと、次からは設定項目に表示されないとのことです。 さて、その対処法をお教え願えないでしょうか。 MySQLのバージョンは5.1です。 よろしくお願い致します。
恐れ入ります。mysqlで右端のカラムにデータを次々とupdateしたいのですが sql文はどのようにすれば良いでしょうか。 右端のデータの無いカラムのを探してupdateするイメージです。 よろしくお願いします。
よろしくお願いします。 OS：Redhat Enterprise Linux 6 DB：MySQL5.6 OSでrootで作業をしており、MySQLをrpmパッケージからインストールすると、 実行ユーザがrootになってしまうことを危惧しています。 サービスをrootで起動することはセキュリティ上 望ましくない、と聞きました。 別途「mysql」というユーザを作成しました。 このmysqlユーザをサービスの起動ユーザとしたいのですが、 どういった手順でそれを実施すれば良いでしょうか？。
mysqlに「１－１－１」という文字をUTF8で登録しました。 sjisで書かれたphpファイルでこの文字を表示するために、sjisに変換したのですが 「１?１?１」となってしまいます。 うまく表示するにはどうすれば良いでしょうか？
order byする際、2カラムの先頭1文字で判断して、並べ替えることは可能でしょうか？ ■想定 ・titleカラム ・yomiカラム ※運用案 案1 「titleカラム」先頭1文字目に漢字が入っているときだけ、yomiカラムにカタカナでフリガナを振る 案2 「titleカラム」先頭1文字目に漢字が入っているときは必ず、yomiカラムにカタカナでフリガナを振る
「さくら」のレンタルSVを利用しています。 そのSVのphpMyAdminで特定のレコードの検索方法について教えてください phpMyAdminのバージョンは3.3.10.5となっています テーブルはフールド数200程度、レコード数2000程度のDBがあります その中から、ある特定のレコードを抽出して特定のフィールドのデータ 修正をしようとしています phpMyadminにログインし該当のテーブルを指定してデータを全件表示します。 例えばフィールドが、a1,a2,a3,a4・・・とあったとします a1に"abcde"があることを確認した後(試験のためで本来は必要なし)、 phpMyadminの検索メニューをクリックして検索画面に進みます その画面でフールドa1のところに"abcde"を打鍵して「実行」ボタン を押下したら、本来は該当のデータが出てくると思うのですがエラー画面がでます 内容は 実行したSQL: select'a1','a2','a3'・・・・ from 'テーブル名' where 'a1'=abcde order by limit 0,30 MySQLのメッセージ #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'LIMIT 0, 30' at line 2 とこのようなメッセージがでます ちなみに 次のSQLのselectの所を全て選択するのでなく*で記載すると該当のレコード を抽出できます select　* from 'テーブル名' where 'a1'=abcde phpMyAdminの検索画面の最下段にオプションがあり該当のフィールドを 1つ以上選択できる画面があるのですが、10件程度の選択なら抽出します 全件を選択したり20件だとエラーとなります このオプションでの選択数は限度があるのでしょうか あるいは、別に何か選択する方法があるのでしょうか どなたか、上記の操作で検索ができるようにする方法を教えて いただけませんか よろしくお願いします。
恐れ入ります。 Mysql で、２つのテーブルがあり、 １つが1000レコード 2つめが1500レコードあります。 プライマリーコードを参照して、 1つめの1000レコードに、2つめのテーブルを揃えたいのですが、 うまくいきません。 delete from t2 left join t1 on t2.num=t1.num where t1.num IS NULL; としましたがうまくいきませんでした。 1つめのテーブルのレコードにマッチしたもの以外を2つめのテーブルから削除みたいな感じです。 よろしくお願いします。
カラムはidとnameです AUTO_INCREMENTをidにつけました googleで検索したら、「AUTO_INCREMENTをつけた場合はindexをつけなくてはいけない」 と書いてあったのですが、なぜindexをつけないといけないのでしょうか？indexなしだとよくないですか？ 今あるidのカラムにsqlでindexを付けることはできますか？ よろしくお願いします
レンタルSV(「さくら」スタンダード)でMySqlを利用しています phpMyadinで作成したフールド数200程度、レコード数2000程度のDBがあります 今回、ある特定のレコードを抽出して特定のフィールドのデータ 修正をしようとしています phpMyadminにログインし該当のテーブルを指定してデータを前件表示します。 例えばフィールドが、a1,a2,a3,a4・・・とあったとします a1に"abcde"があることを確認した後(試験のためで本来は必要なし)、 phpMyadminの検索メニューをクリックして検索画面に進みます その画面でフールドa1のところに"abcde"を打鍵して「実行」ボタン を押下したら、本来は該当のデータが出てくると思うのですがエラー画面がでます 内容は 実行したSQL: select'a1','a2','a3'・・・・ from 'テーブル名' where 'a1'=abcde order by limit 0,30 MySQLのメッセージ #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'LIMIT 0, 30' at line 2 とこのようなメッセージがでます ちなみに 次のSQL文を直接たたくと表示されます select'a1','a2','a3'・・・・ from 'テーブル名' where 'a1'=abcde どなたか、上記の操作で検索ができるようにする方法を教えて いただけませんか よろしくお願いします。
●質問の主旨 kensaku.htmlから数字（データベースのコード番号）を入力・検索して、 PHPMyAdminにあるデータベースから、特定のレコードを取り出したいのですが、 データベースにあるすべてのデータが返されます。 検索窓に入力した特定のレコードの内容だけを 返すためには、下記のichiran.phpをどのように直せばよいでしょうか？ ●プログラムの流れ 1．kensaku.htmlの検索窓に番号を入力・送信 2．PHPMyAdminにあるデータベース（aketo)にアクセス 3．ichiran.phpで検索結果を表示 ●プログラムコード （kensaku.html) <!DOCTYPE html> <html lang="ja"> <head> <meta charset="UTF-8"> <title>PHPの基礎</title> </head> <body> <form method="post" action="kensaku.php"> ご意見コードを入力してください。<br/> <input name="code" type="text" style="width:100px"><br/> <br/> <input type="submit" value="送信"><br/> </body> </html> （ichiran.php） <!DOCTYPE html> <html lang="ja"> <head> <meta charset="UTF-8"> <title>PHPの基礎</title> </head> <body> <?php $code=$_POST['code']; $dsn = 'mysql:dbname=phpkiso2;host=localhost'; $user = 'root'; $password = ''; $dbh = new PDO($dsn,$user,$password); $dbh->query('SET NAMES UTF-8'); $sql = 'SELECT * FROM anketo WHERE code='.$code; $stmt = $dbh->prepare($sql); $stmt->execute(); $stmt->execute(); while(1) { $rec = $stmt->fetch(PDO::FETCH_ASSOC); if($rec == false) { break; } print$rec['code']; print$rec['nickname']; print$rec['email']; print$rec['goiken']; print'<br/>'; } $dbh = null; ?> </body> </html> ●開発環境 windows8 xammp1.8.1 MySQL(PHPMyAdmin)
●質問の主旨 wordpressのデータベースに接続しようとしたら、 「接続確立エラー」が表示されます。 （添付画像） Google検索などで自分で調べて対策を講じてみましたが、 次の画面に進めません 他に何か対策をご存知の方、よろしくお願いします。 ●状況 1．xampp1.8.1をアンインストールした後、 再インストール ↓ 2．wordpressをダウンロード ↓ 3．wordpressフォルダ内にある wp-config-sample.phpを書き換え ↓ 4．wordpressフォルダをC\xammp\htdocsの下に配置 ●書き換えたwp-config-sample.phpの参考サイト 「MySQL 設定」部分の書き換え。 http://39kn.com/2011/05/17/5366/ 「ホスト名」の書き換え http://hryksbt.b.sourceforge.jp/archives/338/
●質問の主旨 phpMyAdminのデータベースを削除したら画面の左側に エラーが出ました。この表示を消すためにはどうすればよいでしょうか？ 昨日、はじめたばかりでまだよく分かっていません。 ご存知の方よろしくお願いします。 ●質問の補足（エラーの状況） 1．データベースにチェックを入れる 2．削除ボタンをクリック 3．エラーが表示 4．このあと新規でデータベースを作成しても、 フィールドの設定をするとエラーが出る ●開発環境 windows8 xammp
mysqlを使おうと勉強中です mysqlに同時書き込みした場合についての質問です 例えば,5人のユーザーが同時に書き込んだとします。書き込むレコードは全て違います ユーザー1がレコード1行目に書き込み ユーザー2がレコード2行目に書き込み ユーザー3がレコード3行目に書き込み ユーザー4がレコード4行目に書き込み ユーザー5がレコード5行目に書き込み この場合は、普通のtableで処理できますか？
現在、mysql＋phpを使ったwebシステムの開発を行っているのですが、日本語の文字化けに 苦戦しています。 mysqlのコマンドでselect * from テーブル名　と打ったところ、insertコマンドで投入した要素名で 日本語で入力したものが、?????で表示されてしまいます。 しかし、create tableコマンドでField名を日本語で入力したのですが、こちらは正しく表示されて います。 my.iniの内容を変更したりしていますが、状況に変化がありません。 どうすれば、直りますか？ 以下に、show valiablesの結果を記載します。 +--------------------------+------------- | Variable_name | Value | +--------------------------+--------------- | character_set_client | cp932 | | character_set_connection | cp932 | | character_set_database | utf8 | | character_set_filesystem | binary | | character_set_results | cp932 | | character_set_server | utf8 | | character_set_system | utf8 | | character_sets_dir | C:\xampp\mysql\share\charsets\ | +--------------------------+-----------------
PHPで、「htmlタグを含んだ文字」を、 データベースへ読み書きする安全な方法を教えて下さい。 リンクタグや、フォントタグなどは、 そのまま使用できるようにしたいです。 ■追加する時 htmlフォームからデータベースに保存（SQLインジェクション） ■編集する時 データベースからデータを読み出す（htmlエスケープ） htmlフォームで再編集し、データベースに保存（SQLインジェクション） こういう作業になるかと思いますが、 どのように処理したら、htmlタグを使いつつ、 安全に更新ができるでしょうか？ 教えてくださいm(_ _)m
このようなSQL文は危険でしょうか？ $sql = "delete テーブル名 where id = :id"; $stmt = $dbh->prepare($sql); $stmt->execute(array(":id" => $_POST['id'])); 上記の例だと、$_POST['id']は、 ちゃんとエスケープできているのでしょうか？
始めたばかりの初心者です。 よろしくお願いします。 phpmyadminの事で質問があります。 ◇型の設定で、桁数を決める際にINTで（６）としても 試しに１０桁を入れても（phpmyadminで直接） 入ってしまいます。試しにと思ってINTのところに ”あいうえお”を入れても入ってしまいます。 どういう事でしょうか？ ◇またINTの上限数値って4294967295だとすると 桁数の設定は（10）までは意味があっても、(11)以上に しても意味がないのでしょうか？ ◇INT（１１）に上限数値の4294967295をいれると 何が起こるのですか？ ◇最後にもうひとつ テーブル作成の際にphpmyadminの（sqlタブ）でつくるとき 以下のような記述をするとそのやり方を習ったのですが、 　（サンプル） 　　Name` varchar(32) NOT NULL default '', この記述の意味がイマイチ理解しきれません。 NOT　NULLとは、ヌル値は認めないというのに、 defaultは””（ヌル）で設定ができてしまう。って 矛盾してませんか？それとも私の解釈が間違っていますか？ たくさん質問してしまいましたが、よろしくお願いします。
◆やろうとしていること 現在エクセルで管理している40個ほどのドメイン情報を、Webで管理(検索・更新・削除)する簡易システムをデータベースとPHPの勉強をかねて構築しようとしています。 ※環境は、LAMPで構築しようとしております。 ◆知りたいこと ドメイン情報管理テーブルを作ろうとしているのですが、その作成の仕方について、アドバイスしていただけたらと思っています。（正規化の方法？？） ◆疑問点 管理対象のドメイン情報は、重複が多いデータです。 ・同一のネームサーバで複数のドメインを管理している ・同一の業者が複数ドメインのレジストラとなっている ・同一の担当者が複数案件の担当者となっている ・同一IDで複数ドメインの管理を行っている たとえば、次のような感じです。 例） ドメイン名　　　　　　レジストラ　　　　　　ネームサーバ　案件担当者　 ID　　　　　　　　案件情報　　　　　　　　　　　 hoge.com お名前.com 　　　ns.bbb.jp 東京一郎　　a0002　自社ECサイト hoge.jp　 　　お名前.com　　　　　 　ns.bbb.jp　　 東京一郎　　a0002　　自社コーポレイトサイト test.jp さくらインターネット ns.bbb.jp　　 京都一郎　　a0003 あいう社コーポレイトサイト aaa.jp さくらインターネット ns1.bbb.jp　　大阪一郎　　a0004　　かきく社コーポレイトサイト aaa.net ムームードメイン ns1.bbb.jp　　東京一郎　　a0005 さしす社blogサイト bbb.net ムームードメイン ns1.bbb.jp　　東京一郎　　a0005 たちつ社ECサイト　 現在、エクセルで上記のような情報を管理しています。 これを初学者の私なりに正規化してみると ・ドメインリストテーブル（主キーとドメイン名だけが入っているテーブル） ・案件担当者リストテーブル（主キーと案件担当者だけが入っているテーブル） ・レジストラリストテーブル（主キーとレジストラだけが入っているテーブル） ・ネームサーバリストテーブル（主キーとネームサーバだけが入っているテーブル） ・IDリストテーブル（主キーとIDだけが入っているテーブル） ※各テーブルの主キーは、ドメインリストテーブルの主キーを設定 と、知識と経験が無いため、テーブルをいちいち細かくすることしかできないのです。 そこで、このようなデータを管理するテーブルを作る場合の一般的な考え方・注意事項・コツ・ポイントなどを踏まえアドバイスをいただけたらと思い質問いたしました。 具体的に、俺だったら、こういうテーブルに分割してドメイン情報を管理する。その理由は云々、といったかたちでアドバイスいただけますと大変助かります。 よろしくお願いします。
mysqlの危険回避の質問です。 （私がした１つ前に質問したものでは、解決しなかったので再度表現を変えて行います。） mysqlでwhere句の値に 1 OR effective=0 が入ると危険であり、シングルクオテーションで回避できる、とあるサイトでみました。 それを踏まえ、それまで以下の(1)で動いていたものを(2)にしたら、動かなくなりました。 そこで質問です。 （初めてphpに触れた人に教えるレベルで、かなり噛み砕いて教えていただけたら幸いです。） ■(1)はそのままでは危険という認識でよろしいですか？ ■(2)はなぜ動かないのでしょうか？ ■(1)を危険のない（もしくは可能な限り危険のない）書き方をするとしたらどうしたら いいでしょうか？（PDOで書く事！やmysqliがいい、というのは知っています。 どうしてもmysql_real_escape_stringを使わなくてはいけないという条件があったと 想定して強引にやるとしたらどうか、という事でお答えをいただければと思います。） (1) $sql = sprintf("SELECT id , password FROM `adminDatabase` where id = '%s' and password = '%s' order by id", mysql_real_escape_string($id),mysql_real_escape_string($password)); (2) $id = "'" . mysql_real_escape_string($id) . "'"; $password = "'". mysql_real_escape_string($password) . "'"; $sql = sprintf("SELECT id , password FROM `adminDatabase` where id = '%s' and password = '%s' order by id",$id , $password ); よろしくお願いします。
MySQLで、テーブルに書籍名リストが入っているとします。 このとき、列「書名」には、以下のような、書名の後に1から11までの連番がついたデータが順不同で入っています。 国語辞書 1 国語辞書 2 国語辞書 3 ・・・ 国語辞書 11 このテーブルに対して、「ORDER BY 書名 ASC」でSELECTをかけると、 「国語辞書 11」が一番最初に来て、その後１から順番に並びます。 これを自然な並び（１１で始まるのではなく、１～１１の順で整列）にするには、どうしたらよいでしょうか？
独学数ヶ月の初心者の質問で恐縮です。 もろもろの事情で仕方なくmysql_real_escape_stringを 以下(1)のように使用しなくてはならないと仮定し、 セキュリテイの面で(2)のようにシングルクオテーションつける 事で危険を回避できますか？ またシングルクオテーションは(2)のようにつけてはいけない とかありますか？（記述の基本が曖昧なため、ただの確認の質問） (1) $sql = sprintf("SELECT id , password FROM `adminDatabase` where id = '%s' and password = '%s' order by id", mysql_real_escape_string($id), mysql_real_escape_string($password)); (2) $sql = sprintf("SELECT id , password FROM `adminDatabase` where id = '%s' and password = '%s' order by id", ’mysql_real_escape_string($id)’, ’mysql_real_escape_string($password)’); よろしくお願いします。
php初心者です。独学で現在勉強していますが、環境に 関する本当に基本的な事がぜんぜん理解できていない事に 気づきました。 質問をする上でちょって変な表現をしてしまうかもしれませんが お許しいただき、また子供に教えるように噛み砕いてお答え いただければ幸いです。 質問 ■mysql mysqlそのものがいったいなんだかがよくわかりません。 （はじめは、htmlやJavaなどコンピューター言語の１つ なのかと思っていました。） ・mysqlとはDBのシステムの１つと考え、それはパソコンで いうところのOSみたいな通常はあまり意識する事が ない存在という事なのでしょうか？ ・lolipop（サーバー）を利用しているのですが、通常は mysqlというものをインストールしないと動かないものが はじめから用意されているからmysqlを意識せずにいられる のでしょうか？ ■mysqlが非推奨？？ ネットであれこれ情報を集めていたら、mysqlが今後非推奨に なるのか？mysqlの関数が非推奨になるだの、PDOやらmysqli がいいだのとありましたが、まだ全体の知識が浅いため いっている内容がさっぱり理解できません。 ・もしphpのバージョンによりmysqlを使えないと仮定した場合 サーバー上ではどんな設定が必要で、ソースの書き方はどうなって しまうのでしょうか？ （自分の理解） (1)サーバーにmysqli（これってシステム？言語？なのかすらよく 理解できていません）をインストール (2)phpでデーターを呼び出す時は、mysqliの記述の仕方で呼び出す ■これからどういう順序で何を勉強したら良い。 時間とお金がないので可能な限り効率的な順序で勉強をしたいのですが、 これからPHPとDBを扱うには何をどういう順番で勉強すると いいのでしょうか？また他にアドバイスがあればよろしくお願いします。 （クラスだの、オブジェクト指向だのが全くわかりません、またフレーム ワーク、その他難しいことは、基礎を覚えた後にやらないと結局痛い目に あうものでしょうか？などなどに対するアドバイス等） 長々となってしまいましたが、頭が混乱しているので、 頭の中の整理をお付き合いいただける方、よろしくお願いします。
当方、初心者です。 訳あって、古いバージョンのMySQLをインストールすることになりました。 MySQLのサイトからバージョンが5.1.68の mysql-server mysql-client mysql-devel mysql-shared をダウンロードして、 #rpm -ivh mysql-server-5.1.68-1.glibc23.x86_64.rpm #rpm -ivh mysql-client-5.1.68-1.glibc23.x86_64.rpm #rpm -ivh mysql-devel-5.1.68-1.glibc23.x86_64.rpm #rpm -ivh mysql-shared-5.1.68-1.glibc23.x86_64.rpm とコマンドをうちました。 それぞれ100％となり、エラーメッセージは出ませんでした。 その後 #rpm -qa │ grep mysql と打っても何も表示されませんでした。 /etc/init.d/にmysqlはありますが、mysqldはありません。 mysql startとうつとOKと表示され showdatabaseもできました。 これでインストールは完了しているのでしょうか？ OSはCentOS5.9です。 構成管理のパッケージソフトをインストールするために 前提としてMySQLが必要と記載されていたのみなので どのMySQLをインストールすれば良いかもわかりません。 心優しい方のアドバイスをお待ちしております。
いま、英字新聞で、『ウィキペディア』に関する記事を読んでいます。 その中で、「ウィキペディアを編集するためには、ウィキシンタックス(wiki syntax） を学ばなければならない。」とあるのですが、ウィキシンタックスとは、何ですか。 また、日本語に訳したら、何て言うのでしょうか。（「ウィキシンタックス」でいいのでしょうか。） どなたか、教えてください。
あるテーブルのデータをダンプしてエクスポート(export_utf8.sql)しました。 それを他のMysqlへインポートしようと以下のコマンドを実行したところ、 mysql -p --default-character-set=utf8 db < export_utf8.sql 以下のエラーが出力されました。 Unknown MySQL server host 'border="1"' (1) おそらく、エスケープ関連でコケているものかと思いますが、 どうすればインポートできるのかわかりません。 ご存知の方、宜しくお願いします。
UNIONする際、片方のテーブルしかないカラムも利用したいのですが、どうすればよいでしょうか？ ■現状 SELECT tablename, id, level 　FROM ( 　　SELECT \'A\' tablename, s.id, s.level FROM A s 　　　UNION ALL 　　SELECT \'B\' tablename, r.group_id, r.level FROM B r 　) as UNI ■やりたいこと ・テーブルAにしかないカラム「age」も一緒にSELECTしたいのですが、どうすれば良いでしょうか？ ・UNIONしたいわけではなく、UNIONした後のレコード同様、「age」カラムもSELECTしたい、という意味です ・UNIONの外側で何かやればいいのかな、と思い試したのですが、うまくいきませんでした
いつも楽しく勉強させていただいております。 環境はWin7、Office2007、MySQL5.5.28です。 データはMySQL上にあり、それを集計した結果をExcelまたはcsv形式で取り出すプログラムを開発中です。 集計の表側（ブレークダウン）や絞込みの条件は可変なので、AccessでMySQLに渡すコマンドを編集し、テキストファイルとして出力します。 このテキストファイルを実行するのに目下のところ次の二通りで行っています。 １．MySQLのクライアント画面から下記のように実行 source C:\Users\meglin\Documents\サマリー.sql ２．コマンドプロンプト画面から下記のように実行 "C:\Program Files\MySQL\MySQL Server 5.5\bin\mysql" -u root -D meglindb -proot < C:\Users\meglin\Documents\サマリー.sql どちらの方法でも快適に動きます。 近々そのプログラムを運用ベースに乗せたいのですが、オペレーションをする上司が「あの黒い画面（MySQLのクライアント画面/コマンドプロンプト画面）を触るのがコワイ。すべてAccessから対応できないか」と言います。 要するに上記コマンドのサマリー.sqlをAccessの中から起動したいのです。 できますでしょうか。 おそらくShell関数を使うのだと思って下記のように書いてみたのですが、うまく動いてくれません。 Shell("""C:\Program Files\MySQL\MySQL Server 5.5\bin\mysql"" -u root -D meglindb -proot < C:\Users\meglin\Documents\サマリー.sql") どうしたらいいでしょうか。 最初はAccessからMySQLにODBC接続とADOで１行ずつ実行してみたのですが、集計の列と行が多いので処理時間がかかり実用的ではありません。
恐れ入ります。 Mysql をつかって、2つのテーブル（同一並びのカラム）の、各々のレコードを足したいのですが、 どのようにしたらよろしいでしょうか。 table1 ------------ col1|col2|col3 20 |30 |40 40 |40 |50 10 |20 |20 ------------ table2 ------------ col1|col2|col3 10 |10 |20 20 |20 |20 10 |20 |20 ------------ 処理後 ------------ col1|col2|col3 30 |40 |60 60 |60 |70 20 |40 |40 ------------ のようにしたいです。よろしくお願いします。
http://oshiete.goo.ne.jp/qa/7944235.html の件に引き続きどうSQL文を書いてよいかわからず困っています。 create table team(team_id int not null primary key,team_name varchar(30),year int(4), leagueid int(32) ); insert into team values(1,"A",2012,1),(2,"B",2012,1),(3,"C",2012,1),(4,"D",2012,1),(5,"A",2012,2),(6,"B",2012,2),(7,"C",2012,2),(8,"D",2012,2),(9,"A",2011,1),(10,"B",2011,1),(11,"C",2011,1),(12,"D",2011,1); create table taisen(id int not null primary key auto_increment,hometeam int,homepoint int,awayteam int,awaypoint int); insert into taisen (hometeam,homepoint,awayteam,awaypoint) values(1,3,2,2),(3,1,4,0),(1,0,3,2),(2,2,4,2),(1,1,4,2),(2,0,3,0),(2,1,1,2),(4,1,3,3),(3,5,1,2),(5,3,6,3),(5,1,7,1),(7,1,8,1),(9,1,10,1),(11,1,12,3); とあり、 taisen.hometeamとteam.idとtaisen.awayteamとteam.idを結合し、taisenテーブルにteamのyear、leagueid、team_nameが表示されればと思っています。 通常のjoinであればできるのですが、どのようにsql文をかけばよいのかわからず困っています。 taisen.hometeamとteam.idとtaisen.awayteamとteam.idを結合したときに | taisen.hometeam | ホームチーム名 | taisen.homepoint | taisen.awayteam | アウェイチーム名 | taisen.awaypoint | team.year | team.leagueid で結果がとれるようにしたいのですが、どのようにしたらよろしいでしょうか？
phpmyadmin上の異なるデータベース間のテーブルでリレーションをかけたいのですが、うまくいきません。 new_linkフラグをtrueにすることで異なるデータベースを開くところまではできました。 アドバイスいただけないでしょうか。 ※DB1の中にtable1が、DB2の中にtable2がある //失敗する $con1 = mysql_connect("localhost",username,pass); mysql_select_db('DB1',$con1); $con2 = mysql_connect("localhost",username,pass,true); mysql_select_db('DB2',$con2); $sql = "select * from table1,table2 where table1.id = table2.id"; $result = mysql_query($sql) or die(mysql_error()); メッセージ⇒Table 'DB2.table1' doesn't exist //これは成功する $con1 = mysql_connect("localhost",username,pass); mysql_select_db('DB1',$con1); $con2 = mysql_connect("localhost",username,pass,true); mysql_select_db('DB2',$con2); $sql1 = "select * from table1"; $result1 = mysql_query($sql,$con1) or die(mysql_error()); $sql2 = "select * from table2"; $result2 = mysql_query($sql2,$con2) or die(mysql_error());
タイトルが意味不明ですみません 実現したいことはちょっと複雑なのですが 1．表面テーブル(view?）は1つのテーブルであり、そこにSELECTやINSERT、UPDATE、DELETEを発行。 2．裏は更新系テーブルと参照系テーブルに分かれている。 【更新】表系テーブル（view可）に発行した更新系コマンドで更新系テーブルを更新し、トリガー等でリアルタイムに参照系テーブルに反映。 【参照】表系テーブルにたいして発行したSELECT文は参照系テーブルをみる。 条件として入り口を分けることはできません。
MySQLにフォームでインサートすることに悩んでいます。 INSERT INTO table (id,date) VALUES ('1234',CURDATE()) とするとmySQLにユーザーIDと本日の日付を入力できます。 これをフォームから下記の形で入力しようとすると、日付が入力されず、0000-00-00 になってしまいます。 <form action ="insert.php"> <input type="hidden" name="id" value='1234' > <input type="hidden" name="date" value="<?php print(CURDATE()); ?>" > <input type="button" value="submit" name="入力"> </form> value=""の中で本日の日付を指定する場合はどうすればいいかをご教示願います。
order byで複数カラム指定(?)したいのですが、どうすればよいでしょうか？ 具体的には、カラムが空の場合は別カラム指定したいのですが、可能でしょうか？ ■前提 ・titleカラム、yomiカラム ■最終的にやりたいこと ・titleカラムを五十音で並べ替えたい ■運用例(案) ・titleカラムが「漢字」の場合は、yomiカラムにひらがな、を入力 ・titleカラムが「ひらがな」の場合は、yomiカラムは空 ・titleカラムが「英字」の場合は、yomiカラムは空 ・titleカラムが「先頭数語がひらがなもしくは英字で、最後が漢字」の場合は、yomiカラムは空？ ■分からないこと ・漢字対策として、「yomiカラム」作成したけど、すべてのレコードに対して、「yomiカラム」を埋める必要があるでしょうか？ ・「ひらがなだけ」、「英字だけ」、あるいは、「先頭数語が英字で最後の方だけ漢字」なタイトルは、わざわざ「yomiカラム」を埋めなくてもよい？ ■知りたいこと ・全ての「yomiカラム」を埋めなくても、「titleカラム」を五十音で並べ替える方法があれば、教えてください ※件数が多くてちょっと面倒なため、何かいい方法があればと思い、質問しました。「yomiカラム」全部埋めた方がいい、のであれば、その方向で検討しようと思います
namesテーブルのcontentsカラムにねこを含むレコードのうち、 現在までに書き込まれたものを新しいものから抽出したいと思います。 contentsはverchar(255)、unixtimeはint(11)です。 しかし、 SELECT * FROM names WHERE MATCH (contents) AGAINST ('+ねこ' IN BOOLEAN MODE) AND BETWEEN unixtime < 1360850220 ORDER BY `unixtime` DESC limit 1,50 ; が出力されません。 このSQL文はどこが間違っているのか、ご指摘ください。 SELECT * FROM names WHERE MATCH (contents) AGAINST ('+ねこ' IN BOOLEAN MODE) ORDER BY `unixtime` DESC limit 1,50 ; だと出力されるので AND BETWEEN unixtime < 1360850220 が怪しいと思うのですが、どう訂正したらいいのかわかりませんでした。 よろしくお願いいたします。
MySQL 5.6を最近使い始めました。 大量のcsvファイルで保存されているデータを読み込んで、データベースとして扱いたいのですが、どうすれば良いでしょうか？ ファイル名は、 data1_1.csv data1_2.csv data1_3.csv data2_1.csv data2_2.csv といった形で、規則正しく並んでいるのですが、大量にあるため、ループを使って自動化したいと思っております。そのために、LOAD DATA INFILE ファイル名　を使って、このファイル名を順次変えて繰り返す方法がわかりません。 まず、ファイル名に変数が使えるのかと思って @file="data1_1.csv"としてファイル名を置き換えてみたのですが、エラーでした。これでは、この1_1を順次動かす以前に変数が無理なのかも？と思っています。 何かやり方があるようでしたら、どなたかお教えください。 どうぞよろしくお願いいたします。
create table team(team_id int not null primary key,team_name varchar(30),year int(4), leagueid int(32) ); insert into team values(1,"A",2012,1),(2,"B",2012,1),(3,"C",2012,1),(4,"D",2012,1),(5,"A",2012,2),(6,"B",2012,2),(7,"C",2012,2),(8,"D",2012,2),(9,"A",2011,1),(10,"B",2011,1),(11,"C",2011,1),(12,"D",2011,1); create table taisen(id int not null primary key auto_increment,hometeam int,homepoint int,awayteam int,awaypoint int); insert into taisen (hometeam,homepoint,awayteam,awaypoint) values(1,3,2,2),(3,1,4,0),(1,0,3,2),(2,2,4,2),(1,1,4,2),(2,0,3,0),(2,1,1,2),(4,1,3,3),(3,5,1,2),(5,3,6,3),(5,1,7,1),(7,1,8,1),(9,1,10,1),(11,1,12,3); データベース内にデータがあったときに年やleague_idごとに順位表を作りたいのですが、どのようにSQL文を書いてよいかわからず困っています。 理想はこのような感じです。 http://soccer.yahoo.co.jp/ws/standing/?l=52 お分かりの方がいらっしゃいましたらご教授お願いいたします。
お世話になります。質問がふたつあります。 このような、IDとTypeのふたつのカラムで重複しているレコードが多いテーブル「tb」があるとします。 ID Type age 1 1 20 1 2 35 1 3 42 1 2 31 1 3 45 1 2 33 2 1 21 2 3 41 2 1 26 2 2 31 2 1 25 2 1 28 これを、以下のようにしたいのです。 ID Type age 1 1 20 1 2 35 1 3 42 2 1 21 2 2 31 2 3 41 group by ID, Typeとしたところ、 似たような形にはなったのですが、IDとTypeが重複した ID Type age 1 2 35 1 2 31 1 2 33 のうち、group byによってどのような基準でひとつが選択されるのでしょうか？ レコードの追加が新しいものが選ばれるのでしょうか？ また、ageをランダムでひとつを選択するような書き方はできるのでしょうか。 よろしくお願いします。
id　　　　　field1　　　　　field2 1　　　　　　1　　　　　　　　A 2　　　　　　1　　　　　　　　A 3　　　　　　1　　　　　　　　B 4　　　　　　2　　　　　　　　A 5　　　　　　2　　　　　　　　B 6　　　　　　2　　　　　　　　C 7　　　　　　3　　　　　　　　D 8　　　　　　3　　　　　　　　D 9　　　　　　3　　　　　　　　D field1とfield2の値が他のレコードのfield1とfield2と重複している場合はひとつのデータとして返したいです。 id1.2はfield1とfield2の値が同じなので、ひとつのデータしか返しませんが、id3はfield2が異なるので返します。 id4.5.6はいずれもfield2の値が異なるので4.5.6全てを返します。 id7.8.9はfield1とfield2が同じ値なのでひとつのデータしか返しません。 id 1 3 4 5 6 7 該当するレコードは上記のように6個となるようにするにはどのようなsql文を発行すれば良いでしょうか？ ご教示頂けますと幸いです。 宜しくお願い致します。
SQLでVIEWを作成し、そのVIEWに対してSELECT文を書くときに、そのVIEWに対してWHERE句をつけるのは、パフォーマンスを必ず下げることになるのでしょうか？勝手な認識ですが、VIEWにWHERE句をつけると遅くなる場合があると聞きました。VIEWの組み方にももちろんよると思いますが、VIEWは消極的に使い、出来る限りJOINなどして結合したSQLを書くほうが無難なのでしょうか？よろしくお願いいたします。
http://codecanyon.net/theme_previews/3101958-sto … 上記システムをmysqlでインポートしようとした所エラーメッセージが出てきてしまいます。 対処法が解りません。 解る方よろしくお願いします。 -- -- Table structure for table `store` -- CREATE TABLE IF NOT EXISTS `store` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE latin1_general_cs NOT NULL, `address` varchar(255) COLLATE latin1_general_cs NOT NULL, `number` varchar(255) CHARACTER SET latin1 NOT NULL, `latitude` varchar(255) COLLATE latin1_general_cs NOT NULL, `longitude` varchar(255) CHARACTER SET latin1 NOT NULL, PRIMARY KEY (`id`) ) ENGINE=MyISAM DEFAULT CHARSET=latin1 COLLATE=latin1_general_cs AUTO_INCREMENT=14 ; エラーメッセージが出てきてしまいます。↓ MySQLのメッセージ: ドキュメント #1064 - You have an error in your SQL syntax. Check the manual that corresponds to your MySQL server version for the right syntax to use near 'COLLATE latin1_general_cs NOT NULL, `address` varchar(255) CO
どのように質問すれば、良いのか自体あまりわかっていないのですが、 今後システムの仕事をすることになり、現在、ＤＷＨの導入を検討しております。 ＤＷＨの導入を考えているのですが、インポートしたいテーブル数が500超えてしまい、「500は多すぎる、これでは処理時間に1日かかってしまう。」と言われてしまいました。 元のシステムでオラクルのＤＢを使用しており、そのデータをＤＷＨ用のオラクルＤＢに写し、ＤＷＨにデータを入れるようにしようと考えております。 出来れば、3時間から4時間くらいで、インポートしたい（エンドユーザーがデータを確認できるように）のですが、一般的に、ＤＷＨへのインポートできるテーブル数はどのくらいなのでしょうか？また、500くらいのテーブルを希望の時間でインポートしたい場合にやりようはないのでしょうか。 分かる方いらっしゃいいましたら、ご教授ください。
ステートメントベースのレプリケーションをしている時に、 UPDATE 文でLIMIT 句を使用すると以下の様な警告が出ます。 [Warning] Unsafe statement written to the binary log using statement format since BINLOG_FORMAT = STATEMENT. The statement is unsafe because it uses a LIMIT clause. This is unsafe because the set of rows included cannot be predicted. Statement: DELETE FROM `__TABLE__` WHERE `user_id` = 1234 LIMIT 1 データ更新時にRAND()を使ったりした場合、 ORDER BYの結果が異なってしまうのが理由だと思うのですが、 ORDER BYしていないQueryに対してもwarnが出ています。 それとも何かほかに理由があるのでしょうか？
「MySQL」「PHP」、何れでも出来るような処理はどちらでやる方が良いのでしょうか？ ■例1 … 取得データを正規表現で加工して利用したい場合 ・SQL重視 … 正規表現等を駆使したSQLで、後々利用しやすい形で取得 ・PHP重視 … 普通に取得して、PHPで正規表現を利用して加工 ■例2 … データ取得がヤヤコシイ場合 ・SQL重視 … (例えそれがどんなに長くなっても)SQL文をキチンと組み立て、一度にデータ取得 ・PHP重視 … 簡単なSQL文で一旦データ取得後、PHPのループ文内等処理で、再度DBアクセスしデータ取得 ・ちょっと例えが微妙かもしれないのですが、そもそもデータ取得する際、どのように考えるのが正しいのでしょうか？ 1.なるべく利用予定に近い形でデータを取得 2.後で色々加工するかもしれないので、取得時点ではあまり加工せず、そのまま取得 ※要は、頻繁にDBへアクセスしてデータ取得するより、「DBへアクセスするのは極力避け、取得したデータはなるべく使い回す」方が良いのでしょうか？ ・それとも、ここら辺はケースbyケースなので、一概には言えないのでしょうか？ ・あるいは、別にどっちでもいい？　あまり、気にしなくても良い？
PHPとデータベースを使い、 顧客の条件に合った物件をメールに記載して送る処理を行っています。 その際、物件を記載する処理[下記(1)]の部分で同じ物件が記載されてしまいます。 (顧客によっては記載されない) データベース上に重複する物件は存在しないので、なぜ二重に記載されてしまうのかわかりません。 どこを疑えば良いでしょうか。 メール記載例：物件１、物件２、物件３、物件１、物件４、物件２、物件１、物件３、物件３ (二重記載される際のパターンは見つかりません) コード(簡略化) ---------------------------------------------------------------------- データデース１：顧客リスト データベース２：物件リスト //顧客取得 $sql_user = SELECT 条件 FROM 顧客リスト $result_user = mysql_query($sql_user) for($i = 0; $i < mysql_num_rows($result_user); $i++){ 　　$arr_user= mysql_fetch_array($result_user); 　　//顧客の条件に合った物件を取得するSQL文 　　$sql_match = SELECT * FROM 物件情報リスト WHERE～条件～ 　　$result_match =mysql_query($sql__match); 　　for($i = 0; $i < mysql_num_rows($result_match); $i++){ 　　　　$arr_match= mysql_fetch_array($result_match); 　　　　[(1)]物件を記載する処理 　　} １ユーザー分のメールを送る処理 } ---------------------------------------------------------------------- うまく説明できていなかったらすみません。
Windows版のMySQL v5.5.27です。 電話帳アプリを考えていますが、氏名、ヒラガナ、電話番号などなどのフィールドがあります。 そこでヒラガナが「か」から始まるレコードを選択したいと思っていますが、SELECT文が思いつかないのでご教授願います。 特に「か」だけではなく　あ・か・さ・た・・・ というレコードを選択です。 単純に「あ」、「か」、「さ」・・・と選択して蓄積しても良いのですがスマートなSELECTを書きたいと思って質問しました。
こういうテーブル「tb」があるとします。 「tb」 bang　nama　tuki A103　佐藤　4 A102　高橋　5 A104　鈴木　4 A101　中川　4 A103　渡辺　5 A101　西沢　5 A102　中村　6 A104　田中　5 A103　村井　6 A107　吉田　6 A101　小林　4 これを、実行後に、 bang　4月　5月　6月 A101　中川　西沢　NULL A102　NULL　高橋　中村 A103　佐藤　渡辺　村井 A104　鈴木　田中　NULL A107　NULL　NULL　吉田 このように、共通するbangで並べ替えたいのです。 A101の4月は、「中川」と「小林」で重複していますが、 このときはひとりだけが選択されてほしいです。 SELECT CONCAT(CASE WHEN tuki='4' THEN name ELSE IFNULL(null,'') END) AS '4月', ~ GROUP BY bang ~ としても、 bang　4月　5月　6月 A101　中川　 　 　 となってしまい、5月と6月が上手く表示されません。 よろしくお願いします。
SELECTする際、特定カラムの特定文字列がある場合に、そのレコードを弾いた結果を取得したいのですが、 どうすれば良いでしょうか？ ■前提 ・「urlpathカラム」に、「/tokyo/officeedit/261」みたいなパスが1つ入っています ■知りたいこと ・SELECTする際、「urlpathカラム」の中で、指定パスを含むレコードは除く、という条件を付けたいのですが、どうすれば良いでしょうか？ ■弾きたいパス例 ・「/tokyo/officeedit/★★」 ・「/tokyo/houseedit/★★」 ・「/site/login」
はじめまして、よろしくお願いします。 職場環境がかわり、はじめてmySQLを使用しています。 ３つのテーブルから情報を検索したいのです。 [テーブル名: cast] name　　　　　　　　　　　　　// PRIMARY KEY age (例 なまえ１,　22 なまえ２,　28 なまえ３,　25 [テーブル名: photo] name order　　　　　　　　　　　　　// 写真表示順 (INT) url　　　　　　　　　　　　　　　// 写真格納先URL (例 なまえ１,　0,　http://なまえ１A.jpg なまえ１,　1,　http://なまえ１B.jpg なまえ１,　2,　http://なまえ１C.jpg なまえ３,　0,　http://なまえ３A.jpg [テーブル名: schedule] name workday　　　　　　　　　　　// 出勤日 (DATE) starttime　　　　　　　　　　// 出勤時間（TIME) finishtime　　　　　　　　　　// 退勤時間(TIME) (例 なまえ３,　2013-02-04,　 9:00,　17:00 なまえ２,　2013-02-05,　10:00,　18:00 なまえ２,　2013-02-06,　10:00,　18:00 なまえ２,　2013-02-07,　10:00,　18:00 キャスト情報(cast)とそのキャストの写真格納先URL(photo)とキャストの出勤時間(schedule)のテーブルです。 ※キャストは何枚でも写真を登録できます。登録していない場合もあります。 キャストのリストを表示したいです。 表示したい項目は cast.name,　cast.age,　photo.url,　schedule.starttime,　schedule.finishtime になります。 期待する結果は（２月５日の場合) なまえ１,　22,　なまえ１A.jpg,　NULL,　NULL なまえ２,　28,　NULL,　　　　　10:00,　18:00 なまえ３,　25,　なまえ３A.jpg,　NULL,　NULL すべてのキャストを表示します。 photo.urlはphoto.order=0のもの（photo.order=0の写真をサムネイル表示に使っています) ２月５日に出勤情報があれば表示 いろいろ考えたのですが、どうしても photo にデータがない（"なまえ２"）のところでつまづいてしまって、どうにも。。。 とりあえずPHPでそれぞれのテーブルの情報を取得して 自分で UNION、 USING('name') みたいな処理してますが、ソースがとっても恰好悪いです。 ズバッとしびれるSQL文をどうかご教示していただきたく、投稿しました。 よろしくお願いいたします＞＜
MySQLのMEMORYエンジンを使用したテーブルについて質問です。 varcharは可変長の認識だったのですが、MEMORYエンジンの場合、固定長として扱うのか・・・ InnoDBの時は2GB程のレコードだったのがMEMORYに変更したところmax_heap_table_size=7GBを超えてしまいました。 質問の内容は以下です (1)．varcharはMEMORYテーブルでは値の長さに関わらず領域を確保するのでしょうか (2)．MEMORYテーブルで可変長を扱う方法はあるのでしょうか MySQLのバージョンは5.5.28です。 難解な文章で申し訳ないですが、ご存知の方いらっしゃいましたらご教授のほどよろしくお願いいたします。
mysql php 超初心者です。 mysqlで連結先のテーブルのカウントを取得したいと思っています。 以下のような a_tblと b_tbl があり、 a_tbl の a_index と b_tbl の ab_no を 結合して b_tbl の ab_no のカウント数を 理想結果表に表示したいと思っています。 どう書いたら b_tbl の ab_no をGROUP(?) COUNTして 理想結果表の様にbテーブルのab_noのcount数を表示できるのでしょうか？ -a_tbl- a_index | a_data 1 |　りんご 2 |　信号 3 |　空 4 |　カラス -b_tbl- b_index | ab_no | b_data 1 |　 1 | 青 2 |　 1 | 赤 3 |　 2 | 青 4 |　 2 | 赤 5 |　 2 | 黄 6 |　 3 | 青 7 |　 3 | 白 8 |　 3 | 黒 9 |　 4 | 黒 -理想結果表- a_index |a_data 　　| bテーブルのab_noのcount数 1 | リンゴ 　　| 2 色 2 | 信号 　　| 3 色 3 | 空 　　| 3 色 4 | カラス　　| 1 色 私が見よう見まねで考えた式ですが、やはりこれでは表に2しか出ませんでした。 $sql = "SELECT Count(*) AS cnt FROM b_tbl LEFT JOIN a_tbl ON b_tbl.ab_no = a_tbl.a_index GROUP BY b_tbl.ab_no"; 質問の仕方もよくわからないのでわかりにくいかも知れませんが どうかご教授の程よろしくお願い致します。
SELECT a.num b.num FROM 　　サブクエリA(いろんな処理 WHERE a_id=ANY(サブクエリC(いろんな処理)) ) AS a, 　　サブクエリB(いろいろ処理 WHERE b_id=ANY(サブクエリD(いろんな処理)) ) AS b このような処理をしているのですが、サブクエリCとサブクエリＤは一字一句違わない全く同じ処理をしています。 ２回全く同じ処理をするのは処理コストが無駄にかかりますし、同じ内容を示す表記が２度出てくるのは保守性も悪くします。 サブクエリCとＤを共通化して一つにまとめる方法はありますでしょうか。
データを入力している最中、誤ってオートインクリメントのIDカラム(int 11)を削除してしまいました。 このテーブルのそれぞれのレコードに再度IDを割り振りたいです。 まだこのデータを使って何か使っているわけではないので、 IDの値自体は元のものでなくてもかまいません。 ID name 1 aaa 3 bbb 6 ccc 7 ddd : などでしたら、 ID name 1 aaa 2 bbb 3 ccc 4 ddd : と、そとりあえず個々のレコードに適当なIDを設定することができれば十分です。 このような設定を行う方法をご教示ください。 よろしくお願いいたします。
いつもお世話になっております。 この度、皆様に教えて頂きたい事象が発生しました。 内容は以下の１点です。 現在Linux上にデータベース（MySQL）があります。 通常MySQLの操作を行うには (1)rootユーザ (2)一般ユーザ (3)匿名ユーザ 等でログインして操作を行うかと思われます。 しかし、ここであえてMySQLでのユーザで操作するのではなくOS上のユーザ（root）で操作することは可能でしょうか？ 教えて頂きたいことをまとめると 【質問】 Linuxにログインする際のユーザ（OSのrootユーザ権限）でMySQLのエクスポートやインポートを行うことは可能かどうか？ *補足 MySQLのrootのPWを忘れたからこういうことをやりたいのか？ ⇒ いいえ、違います。PWを忘れた際の対処法は知っております。 　　単純に、Linux（OS）全体を扱っているrootユーザ権限で、データベースをいじれるかどうか（エクスポート、インポートが可能か）を知りたいのです。 サーバ系の知識が豊富な玄人の方々、アドバイス等頂けましたら幸いです。 *無理という回答でも結構です。 できるか、できないかが知りたいのです。 よろしくお願い致します。 以上
お世話になります。 phpmyadminのSQLで、 ブックマークの変数を利用する形で、 select文を実行したいのですが、 その際、 select文内に対して、 どのように、ブックマークの変数を記述すればよいのでしょうか？ 以上になります。 よろしくお願いします。
最終的に1億行になるであろうテーブルを含むデータベースを作っています。 テスト環境はCentOS6.3 MySQL5.5 CPU QuadCore 2.4GHz 2GBメモリです。 テスト環境を作るために10万件づつのCSVファイルをインサートしていったところ最初の10万件は数秒でインサートできたのですが、だんだん重くなり、1000万件近くになると「10万件の登録に1分半」もの時間が掛かっています。 (1000万件のデータはinnoDB上で1.2GB) サーバーを公開した場合、最大で1分間に数万件のインサートが見込まれていますので、今の環境だとテーブル内データ1千万件が限界の感じであり、現在予想している1億行では使い物にならないと危惧しています。 そのような中、調査していくとディーエヌエーの松信氏の発言で http://www.slideshare.net/kaminashi/db-6636154 18. インメモリでINSERTを完結する 　　インメモリでのINSERT性能 InnoDBの場合秒間15000 insert/s超え という記載を発見しました。 しかし、インメモリでのインサートの方法というのが分かりません。 話の筋やInnoDBという単語から言って、松信氏の言う「インメモリでINSERTを完結する」と「インメモリー・データベース」とは違うと考えております。 実メモリの範囲内という考えなら、現在のテスト環境でも1.2GBのデータを2GBメモリのマシンで展開しているわけなので、「10万件の登録に1分半」かかる理由が分かりません。 秒間15000 insert/s超えを達成させる「インメモリでINSERTを完結」させる方法について具体的にご教授いただけませんでしょうか? 宜しくお願い致します。
はじめまして。 voteというテーブルにcategory_id、individual_id、timeという３つのフィールドがあります。 (1)category_idは名前の通りカテゴリーのIDで、0～100まであります。 (2)individual_idはcategory_idごとに0～100まであます。 (3)timeは行が挿入された時間が記入されています。投票されるたびに行が挿入されます。 (4)category_idとindividual_idとdateでユニークキーを構成しています。 (5)category_idとindividual_idの２つで、個人が特定されます。 select categry_id, individual_id, count(*) from vote group by category_id, individual_id という命令文で、誰に何票voteされているかが分かります。 この先ですが、各カテゴリの中で最も多く投票されている3人ずつを表示したいのですが、どのようなSQLを書けばよいでしょうか。 似たような質問もあり、自分なりに四苦八苦して試してみたのですがうまくいきませんでした。 回答いただけると助かります。よろしくお願いいたします。
今、mac PCで　独自の認証局を作成し、自作の証明書発行をしようとしています。 今現在下記のサイトにて設定をしています。 ・http://homepage1.nifty.com/glass/tom_neko/web/we … 「起動時のパスフレーズ要求をなくす。」まで設定が終わり、 「httpd.confの設定」ができません。 できない内容 #LoadModule ssl_module libexec/httpd/libssl.so　 （↑は９５行にあり、設定ができました。） #AddModule mod_ssl.c （↑検索をかけましたが、見当たらないため設定が出来ません。） #Port 80 （↑検索をかけましたが、記述がないので設定ができません。。） それ以降は、解決しないと進めないのでやっていません。 解決方法はありますでしょうか？ 開発環境 MacBook Air Mac OS X バージョン　10.7.5 MySQLを使用 宜しくお願い致します。
データベースの考え方、で教えてください。 路線検索と、路線にひもづく駅名の時刻表を表示させる、データベースを作りたいと思っているのですが、 その場合、考え方としては、以下のような感じになるのでしょうか？ 路線名のtbl sql文: create table transit ( id integer not null, name varchar(20) not null ); 路線名tblにひもづく、駅名tbl sql文: create table station ( id integer not null primary key, transit_id integer not null, name varchar(20) not null ); 駅名tblにひもづく、時刻表tbl sql文: create table timetable ( id integer not null primary key, station_id integer not null, hour integer not null, minute integer not null ); 表示パターンとしては、 ================================= ○○線：　XX駅 6:10 20 7:30 55 . . . . . . 22:15 36 ================================== のような感じです。 よろしくお願いします。
mysql初心者です。 phpmyadmin で検索と置換のクエリ文の書き方に関して質問させて頂きます、宜しくお願いいたします。 データベース: koneko_nyan テーブル: wp_postmeta フィールド：meta_id、post_id、meta_key(varchar(255))、meta_value(longtext) があります。 フィールドmeta_valueの中の"お魚"という文字列を"焼き魚"に置き換えたい。 ただし、meta_valueフィールド全体ではなくて、meta_keyフィールドに"koubutsu"という文字列が含まれている行のmeta_valueに対してだけ置き換えを実行したいと考えています。 この場合、どのようなクエリを送れば、うまく置換できるのでしょうか？ 詳しい方いらっしゃいましたら、ご教示頂きたく存じます。
MySQLのロックレベルはテーブルロックのようなのですが、行ロックに変更するって可能でしょうか バージョンは5.5です
sqlで insert into tb1 values('○○(番号)','○○(名前)',○○(歳))； と入力して作ったデータを select bang,name,tosi from tb2; で表示したのですが、 nameのところが「??」と表示されます。 入力方法が違うのでしょうか？ それとも設定を変えないといけないのでしょうか？ 回答をよろしくお願いします。
チューニングについて質問です。 1. SQLの純粋な実行速度を知るにはどうしたらよいか 2. SQLの叩かれる回数が多い場合にレスポンスが遅くなるのはどう対応すればよいか 1については、純粋に単体での実行時間が知りたいのですがSQLのキャッシュが残っているせいか、高速に処理されてしまうために、なかなか正確な時間が分かりません。 どのようにしたら単体での実行速度を計測できるのでしょうか。 2については、SQL単体ではなかなかの速度が出せているのに、そのSQLが短時間に大量に呼び出される場合に、サーバの負荷があがり、レスポンスが遅くなってしまう場合はどう対処すればよいのかを聞きたいです。 よろしくお願い致します。
教えてください。MySQL初心者です。MySQLサーバがインストールされているサーバのコンピュータ名を変更します。変更によって何か影響することがありますでしょうか？ mysql.userなどのテーブルにhostのデータがあるようなのですが。よろしくお願い致します。
みなさん初めまして。 SQLについて只今勉強中の者です。 EclipseとMySQLを接続したいのですが、どうしても接続できません。 利用環境 apache-tomcat-6.0.36 MｙSQL5.5 Windowsはｘｐです。 apache-tomcat-6.0.36を利用しており、JDBCドライバをダウンロード後、Tomcat内のcommon\lib内にmysql-connector-java-5.1.22-binを導入し、環境変数でパスを通しています。 TomcatとEclipseの接続は確認しています。 また、MySQLについては起動確認や、データベース作成は行えました。 原因のjava.lang.ClassNotFoundException: com.mysql.jdbc.Driverから、JDBCドライバにパスが通っていないため接続が出来ていないと考えております。 初歩的な質問かもしれませんが宜しくお願い致します。 以下は実行した際に表示された内容です。 HTTPステータス 500 - -------------------------------------------------------------------------------- type 例外レポート メッセージ 説明 The server encountered an internal error () that prevented it from fulfilling this request. 例外 org.apache.jasper.JasperException: javax.servlet.ServletException: java.lang.ClassNotFoundException: com.mysql.jdbc.Driver org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:500) org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:410) org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313) org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260) javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 原因 javax.servlet.ServletException: java.lang.ClassNotFoundException: com.mysql.jdbc.Driver org.apache.jasper.runtime.PageContextImpl.doHandlePageException(PageContextImpl.java:865) org.apache.jasper.runtime.PageContextImpl.handlePageException(PageContextImpl.java:794) org.apache.jsp.admin_jsp._jspService(admin_jsp.java:108) org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70) javax.servlet.http.HttpServlet.service(HttpServlet.java:717) org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386) org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313) org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260) javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 原因 java.lang.ClassNotFoundException: com.mysql.jdbc.Driver org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680) org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526) org.apache.jasper.servlet.JasperLoader.loadClass(JasperLoader.java:128) org.apache.jasper.servlet.JasperLoader.loadClass(JasperLoader.java:66) java.lang.Class.forName0(Native Method) java.lang.Class.forName(Class.java:186) org.apache.jsp.admin_jsp._jspService(admin_jsp.java:66) org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70) javax.servlet.http.HttpServlet.service(HttpServlet.java:717) org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:386) org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313) org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260) javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 注意 原因のすべてのスタックトレースは、Apache Tomcat/6.0.32のログに記録されています -------------------------------------------------------------------------------- Apache Tomcat/6.0.32 以上です、宜しくお願い致します。
My SQLで複数の条件での絞り込み検索をしたいのです。 TABLEAのSHOHINCDという項目をキーにして、 TABLEBにて上記で抽出したSHOHINCDを LIKE IN で抽出したいのですがどう記述したらよいのでしょうか。 初歩的な質問ではありますが、宜しくお願い致します。
以前、知り合いからデータベースのINT型の項目には出来ればNULLを許可しない（NOT NULL）方がいいと聞いたことがあるのですが、本当でしょうか？ 現在不動産の物件データを登録するためのシステムを作成しており、 データベースの設計を行なっている最中なのですが、 例えば金額や面積など数字しか入力されない項目はINT型にしたいと考えています。 ※データベースはMySQLになります。 ただし、 物件データ登録時に数字項目に何も入力されなければ「NULL」、 0以上の数値を入力されている場合にはそのままその数値をデータベースに登録したいと考えています。 ※0を入力されている場合には「0」をそのまま入れたいです。 INT型の項目にはNULLを入れるのを避けた方がいい場合には、0を入れるような仕様に変更しようと考えているのですが、その辺のことについて教えて頂けると助かります。 ざっくりとした質問で申し訳ございませんが、宜しくお願い致します。
正規化が分かりません。 冗長性を排除したい、という意図だけは分かるのですが… 例えば、リンク先で回答されているケースは、それぞれ第何正規化に該当するのでしょうか？ ＞個人IDがあり、住所情報を正規化するとしましょう ＞項目は「郵便番号」「都道府県」「市区町村」「番地」「電話番号」「メールアドレス」としますよ ＞個人IDを主キーとする「郵便番号テーブル」を作る ＞個人IDを主キーとする「都道府県テーブル」を作る ＞個人IDを主キーとする「市区町村テーブル」を作る ・これは第1正規化ですか？ ＞個人IDを主キーとする「番地テーブル」を作る ＞個人IDを主キーとする「電話番号テーブル」を作る ＞個人IDを主キーとする「メールアドレステーブル」を作る ・この内容は重複しないと思うのですが、分けると、正規化したことになるのでしょうか？ ・また、その場合は、第何正規化に該当するのでしょうか？ ▽DBの「非正規化」について 　 http://oshiete.goo.ne.jp/qa/5776795.html
以下のようなデータがあります。 id　顧客コード　日付　金額 1　A001　2012/12/25　100 2　B001　2012/12/24　200 3　A001　2012/12/24　100 4　C001　2012/12/23　500 5　A001　2012/12/23　300 6　B001　2012/12/23　100 このデータを、顧客毎に最新順で表示したいのです。 順番は、 １．最新の日付順に顧客がまず並ぶ ２．その顧客の並び順で、顧客毎に日付が新しい順に各データが並ぶ 説明が下手ですが、下の様に 1　A001　2012/12/25　100 3　A001　2012/12/24　100 5　A001　2012/12/23　300 2　B001　2012/12/24　200 6　B001　2012/12/23　100 4　C001　2012/12/23　500 A001、B001、C001の中で、最新の日付を持っているのがA001→B001→C001なので、その順で並ぶ。 （SELECT 顧客コード, MAX(日付) FROM tbl GROUP BY 顧客コード　かな？） さらに、その顧客の中で日付順にデータが並ぶ。 このように抽出するには、どのようなSQL文で行うのでしょうか。 サブクエリを使うのかなとは思うのですが、あまり理解できていないため思いつきません。 わかるかたよろしくお願いします。
以下のように、10秒ごとにユーザごとの金額データが登録されるテーブルがあるとします。 このテーブルから、ユーザごとの最新のデータを抽出するSQLを教えて頂けないでしょうか？ 出来れば、WHERE条件で時間を指定する方法ではなく、MAXを使った方法がいいのですが…。 【ユーザ情報テーブル登録内容】 年 | 月 | 日 | 時 | 分 | 秒 | ユーザ| 金額 2012 | 01 | 14 | 10 | 00 | 00 | 00001 | 100 2012 | 01 | 14 | 10 | 00 | 00 | 00002 | 200 2012 | 01 | 14 | 10 | 00 | 00 | 00003 | 100 2012 | 01 | 14 | 10 | 00 | 10 | 00001 | 100 2012 | 01 | 14 | 10 | 00 | 10 | 00002 | 200 2012 | 01 | 14 | 10 | 00 | 10 | 00003 | 100 2012 | 01 | 14 | 10 | 00 | 20 | 00001 | 100 2012 | 01 | 14 | 10 | 00 | 20 | 00002 | 200 2012 | 01 | 14 | 10 | 00 | 20 | 00003 | 100 2012 | 01 | 14 | 10 | 00 | 30 | 00001 | 100 2012 | 01 | 14 | 10 | 00 | 30 | 00002 | 200 2012 | 01 | 14 | 10 | 00 | 30 | 00003 | 100 【抽出対象】 年 | 月 | 日 | 時 | 分 | 秒 | ユーザ| 金額 2012 | 01 | 14 | 10 | 00 | 30 | 00001 | 100 2012 | 01 | 14 | 10 | 00 | 30 | 00002 | 200 2012 | 01 | 14 | 10 | 00 | 30 | 00003 | 100 ご教示のほど、よろしくお願い致します。
php・MySQL初心者です。 何とかここまで自力でやってこれたのですが、もうお手上げで…。 サンプルコードを解析し、部分的に理解しながら進んでる状態です。 やりたいことは、 「ユーザーが入力した文字列の最後の1文字だけを抜き出し、データベースに代入する」です。　←(2) ちなみに、 「ユーザーが入力した文字列をそのまま、データベースに代入する」はできました。←(1) 参考に、(1)のソースコードの一部を書きます。 ------------------------------------------- 『main.php』 <form action="result.php" method="POST" enctype="multipart/form-data"> <input type="hidden" name="MAX_FILE_SIZE" value="<?= $file_maxsize ?>"> タイトル：<INPUT type="text" name="title" size="50"><br> コメント：<INPUT type="text" name="comment" size="50"><br> <input type="submit" value="送信"> </form><hr> ------------------------------------------- 『result.php』 $comment = @trim($_REQUEST['comment']); //※ $query = "insert into main_t (comment, last)" . " values ('$comment', '$last')"; $result = mysql_query($query); ------------------------------------------- だいたいこんな感じで(1)は出来ました。 (関係がありそうなところだけを抜き出したつもりです…) 『main.php』で出力して確認もしました。 (2)の現状の私のコードを書きます。 ------------------------------------------- 『result.php』 $x = mysql_query("select right('$title', 1)"); $last = mysql_fetch_assoc($x); ------------------------------------------- これを(1)の //※ 　の部分に記述してみましたが、うまくいきません。 出力するとなぜか「Ar」と出てきます…泣 『select right('いちもじ', 1)』で『じ』とちゃんと右一文字が取り出せるのをbatファイル？みたいなので確認しました。 このSQL文をPHP内で行いたいのですが、やり方がわかりません…。 (そもそも根本的に間違っているのでしょうか…) $x = mysql_query("select * from ○○ where 条件"); $last = mysql_fetch_assoc($x); みたいにfromで検索先や条件を指定して得た「配列」を取得し、表示する方法はネット検索で沢山見つかったのですが、fromやwhereを使わず、結果も配列ではなく1つだけ得られるような場合は、どうすればよいのでしょうか？ わかりづらい文章ですみません； 難しい質問かとは思いますが、PHPやMySQLに詳しい方がいましたら、是非ともご教授いただけたらと思います。 よろしくお願いいたします。
MySQLの初級者です。 下記のようなテーブル構造があります。 article_flag -------------　------------- 　aid　　　　display -------------　------------- 　1　　　　　1 -------------　------------- 　2　　　　　1 -------------　------------- 　3　　　　　1 -------------　------------- 　4　　　　　2 -------------　------------- ...Primary(aid)、INDEX(display) category -------------　------------- 　cid　　　　name -------------　------------- 　1　　　　　カテゴリ1 -------------　------------- 　2　　　　　カテゴリ2 -------------　------------- 　3　　　　　カテゴリ3 -------------　------------- 　4　　　　　カテゴリ4 -------------　------------- ...Primary(cid)、INDEX(name) article_category -------------　------------- 　aid　　　　cid -------------　------------- 　1　　　　　1 -------------　------------- 　1　　　　　4 -------------　------------- 　2　　　　　1 -------------　------------- 　2　　　　　2 -------------　------------- 　2　　　　　4 -------------　------------- 　4　　　　　1 -------------　------------- 　4　　　　　2 -------------　------------- ...INDEX（cid aid) このような構造の中で、 下記のような出力を行いたいのです。 カテゴリ1　【関連記事 2件】 カテゴリ2　【関連記事 1件】 カテゴリ4　【関連記事 2件】 非表示中の記事（display = 2）は関連記事に上がらず、 関連記事の存在しないカテゴリは出力しないという仕様です。 この場合、どのようなSQL文で対処すればよろしいでしょうか？ 現状では、 SELECT c.cid, c.name FROM category as c INNER JOIN article_category as ac ON c.cid = ac.cid INNER JOIN article_flag as af ON ac.aid = af.aid and af.display = '1' GROUP BY c.cid ORDER BY c.name ASC limit 10; というSQL文でまずは抽出してから、 抽出後のPHPのループ内で、 SELECT count(ac.cid) FROM article_category as ac INNER JOIN article_flag as af ON ac.aid = af.aid WHERE af.display = '1' and ac.cid = '{取得したcid}'; とカウントして関連記事数を出すという 回りくどいやり方しか思いついていません。 また例では件数が少ないですが、 実際には、article_flagが500件、categoryが200件あり、 一つの記事に平均で10個近いカテゴリが割り当てられているため、 article_categoryの件数は5000件近くあります。 そのため、最初のSQLクエリがとても遅く、 早くても10秒くらいかかります。 基本的にはlimit 10で10件限定の表示のため、 2番目のクエリは特に重さを感じません。 1つ目のクエリで一度に関連記事数まで取得できれば最善ですが、 難しい場合には、1つ目のクエリでは、 関連記事が存在するかどうかの判定だけでも良いので、 何とか良い方法をご教授の程お願いいたします。
MySQLを使っていて、下記条件で結果がemptyになります。 どうすれば正常に取得できるようになるでしょうか。 SELECT `hoge`, `fuga`, `piyo` FROM `table` WHERE `moge` = 'moge' ORDER BY `fuga` DESC LIMIT 0, 5 ・`moge`と`piyo`にはインデックスが貼られています。 ・DESCを消すと正常に取得できます。 ・WHERE句を消すと正常に取得できます。 ・LIMITの数値を大きくすると正常に取得できます。（'moge'によってどれくらい大きくすればいいかの数値は違う） ・LIMITのoffsetを1以上にすると正常に取得できます。 1ヶ月ほどはちゃんと動作していたのですが、`fuga`をUPDATEしたタイミングからこのような現象となりました。 環境 ・Ubuntu 12.04.1 LTS ・MySQL 5.5.28 ・エンジン mroonga ・groongaのバージョン2.0.9 足りない情報があれば補足致します。 宜しくお願い致します。
最終的には以下のような「FLG1」、「FLG2」というカラムを追加したいです。 先頭はカラム名で、Excel上だと 　FLG1には　=IF(MOD(A2,2)=0,1,0) 　FLG2には　=IF(A2>=20,"L",IF(A2>=10,"M","S")) という数式が入っています。 V1FLG1FLG2 121M 50S 290L 301L 150M MySQLのデータベース上には、元々「tbl1」というテーブルに「V1」のカラムだけがある。 その「tbl1」に対して、新たに「FLG1」と「FLG2」というカラム（フラグ列）を追加したい。 というのが目的です。 現状だと（まだMySQL初心者のため）「V1」をそのままコピーし、UPDATEを使って、1つずつ条件判定して値を上書きしていく方法しかわかっていません。。。 例えばFLG2については以下のように（汗） UPDATE tbl1 SET FLG2='L' WHERE V1>=20 UPDATE tbl1 SET FLG2='M' WHERE V1>=10 AND V1<20 UPDATE tbl1 SET FLG2='L' WHERE V1>=0 AND V1<10 たぶんいくつかの方法があると思うのですが、基本的なものから難しい（ちょっとテクを必要とする）ものまで幅広く教えていただけるとありがたいです。そうすれば、それを今後勉強していけるので。
こんにちは、 A,Bテーブルがあり、Aテーブル.ID = Bテーブル.IDの状態で ＩＤごとの最新の更新時間を一件づつ取得したいのですが SQLで抽出することは可能でしょうか？ 取得したい例------------------ ＩＤ、ＴＩＭＥ(タイムスタンプ) １、1356200000 ２、1356228139 Aテーブル---------- ＩＤ 1 2 Bテーブル---------- ＩＤ、ＴＩＭＥ(タイムスタンプ) １、1350000000 １、1356200000 １、1300000000 ２、1356228139 ２、1356000000
あるカテゴリーの商品詳細ページで前後詳細ページへのリンクを設けたいのですが、 後ろページの取得は上手くいきますが、前のページの取得がうまくいきません。 カテゴリーと商品は別テーブルで関連付けテーブルで紐づけさせてます。 PHP+MySQLで構築中です。 ・カテゴリー関連付けテーブル(catgory_term) --------------- | category_id | id | --------------- ・商品テーブルテーブル（items） ----------------------- | id | title | url | ・・・・・・・・・ ----------------------- SQL文は下記のような感じです。（並び順でもSQL内容は変わります.。下記の例は商品ID降順） SELECT items.title,items.id,items.url,MIN(items.id) FROM category_term Left JOIN items ON category_term.id = items.id WHERE category_term.category_id = 'カテゴリーID' AND items.status = 'publish' AND items.id > '商品ID' お手数をおかけしますがご教授いただける幸いです。
2つのテーブルのレコード数をカウントする方法を教えてください。 $sql = "SELECT * FROM テーブル1 and テーブル2"; $res = mysql_query($sql,$myLink); $num_k = mysql_num_rows($res); こんな感じでカウントできるかと思ったのですが出来ませんでした。 宜しくお願い致します。
MySQLのSET型のそれぞれの値に JOINする方法はありますでしょうか？ 内容は下記のような感じです。 < shohin > group(varchar) | item(SET) ------------------------------------- 果物群A | 1,3 ------------------------------------- 果物群B | 2,4 ------------------------------------- < kudamono > id(INT) | kudamono(varchar) -------------------------------- 1 | りんご -------------------------------- 2 | オレンジ -------------------------------- 3 | いちご -------------------------------- 4 | メロン -------------------------------- このような構造の中で 果物群A ... りんご, いちご 果物群B ... オレンジ, メロン とphpで出力したいという内容です。 現状ではshohinからselectでitemの値を呼び出し、 一度、explodeで配列化して、それをfor文でSELECTをかけて、 さらにそこから得られたkudamonoを再度implodeする という回りくどい方法しか考え付きません。 よろしくお願いいたします。
Mysqlで大文字と小文字を区別するように、特定のカラムにBINARYを設定しましたが、逆に、それを解除(削除)する方法はありますでしょうか？ BINARYの設定の方法は多くのサイトで見つけられましたが、削除の方法は分かりませんでした。 どなたかよろしくお願いします。
mysql初心者です。 検索語句（search）で部分一致するものを、名前(name）と更新日（update）でユニーク指定し、修正日(time)が最新のものだけを表示させたいのですが、望む結果が得られません…。 　SELECT * FROM db WHERE name LIKE \"%{$search}%\" GROUP BY name,update までは正しいと思うのですが、さらにtimeの最新を指定する方法を教えていただけませんか？ よろしくお願いします。 いろいろ探して試行錯誤し、以下に行きついたのですが、部分一致がうまく機能しない時があります。（情報不足などあればご指摘ください。） SELECT * FROM db where (time) in (SELECT MAX(time) FROM db WHERE name LIKE \"%{$search}%\" GROUP BY name,update) （中略・件数を取得しページャーに使っています） SELECT * FROM db where (time) in (SELECT MAX(time) FROM db WHERE name LIKE \"%{$search}%\" GROUP BY name,update) ORDER BY time DESC LIMIT $start,10 （中略・whileとmysql_fetch_arrayで表示させています）
社員の生年月日から、今日から、１ヶ月間の誕生日対象者を、誕生日順に出力したいです。 SELECT memname, REPLACE(membirth, "-", "/") as mbirth, REPLACE(RIGHT(membirth, 5), "-", "") as cdate, DATE_FORMAT(membirth, "%c月%e日") as birday FROM MEMDB ORDER BY cdate membirthは、生年月日（例1989-01-01) cdate順にsortしたら、１２月の人より、１月の人が先に出ます。 １２月の人の次に１月の人が出るようにしたいですが。。。 あと、 検索条件も WHERE RIGHT(CURDATE(),5)=RIGHT(mbirth,5) OR RIGHT(DATE_ADD(CURDATE(), INTERVAL 1 DAY),5)=RIGHT(mbirth,5) OR RIGHT(DATE_ADD(CURDATE(), INTERVAL 2 DAY),5)=RIGHT(mbirth,5) OR ... みたいに、INTERVAL 30　DAYまででチェックしてますが、 正しい方法があれば、お教えてください。
検索する文字列のデータが空の場合もその対象にするには、 SELECT * FROM `table` WHERE 1 AND `s1`='あああああ' AND `s2` IN('いいいいい',NULL) のようにするのでしょうか？ 数値の場合はデータが無いのを0で表現すれば、 SELECT * FROM `table` WHERE 1 AND `m1`<=100 AND `m2`<=250 で良いですよね？
MySQL 5.5.27, mysql-connector-java 5.1.12を用いて，MySQLにアクセスしています． しばらくは動いているのですが，時間が経つと，以下のようなエラーを吐いて止まってしまいます． 関連するコードは以下の通りです． https://gist.github.com/4243576 どなたか解決法が分かる方がいらっしゃいましたら，よろしくお願い致します． ----以下エラーコードです (行数はコードと対応しておりません． エラーコードの39行目に当たるのがgistの35行目， 287行目に当たるのがgistの46行目 291行目に当たるのがgistの50行目 になります．) com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link fai lure The last packet sent successfully to the server was 0 milliseconds ago. The driv er has not received any packets from the server. at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Sou rce) at java.lang.reflect.Constructor.newInstance(Unknown Source) at com.mysql.jdbc.Util.handleNewInstance(Util.java:409) at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1 122) at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2260) at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:787) at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:49) at sun.reflect.GeneratedConstructorAccessor10.newInstance(Unknown Source ) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Sou rce) at java.lang.reflect.Constructor.newInstance(Unknown Source) at com.mysql.jdbc.Util.handleNewInstance(Util.java:409) at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:357) at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java :285) at java.sql.DriverManager.getConnection(Unknown Source) at java.sql.DriverManager.getConnection(Unknown Source) at botan.DBManager.connect(DBManager.java:39) at botan.DBManager.insertStatusIdsLong(DBManager.java:287) Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communicatio ns link failure The last packet sent successfully to the server was 0 milliseconds ago. The driv er has not received any packets from the server. at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Sou rce) at java.lang.reflect.Constructor.newInstance(Unknown Source) at com.mysql.jdbc.Util.handleNewInstance(Util.java:409) at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1 122) at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:344) at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2181) ... 16 more Caused by: java.net.SocketException: No buffer space available (maximum connecti ons reached?): connect at java.net.PlainSocketImpl.socketConnect(Native Method) at java.net.PlainSocketImpl.doConnect(Unknown Source) at java.net.PlainSocketImpl.connectToAddress(Unknown Source) at java.net.PlainSocketImpl.connect(Unknown Source) at java.net.SocksSocketImpl.connect(Unknown Source) at java.net.Socket.connect(Unknown Source) at java.net.Socket.connect(Unknown Source) at java.net.Socket.<init>(Unknown Source) at java.net.Socket.<init>(Unknown Source) at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.ja va:256) at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:293) ... 17 more Exception in thread "main" java.lang.NullPointerException at botan.DBManager.insertStatusIdsLong(DBManager.java:291)
selectで抽出したデータの特定カラムのデータを空にしたいのですが、どのような方法がありますでしょうか。 以下のようなofficeテーブルがありまして、データは1万件あったとします。 id　name　place　 1　浅谷　大阪 2　亀山 東京 3　武本 名古屋 placeカラムに東京を含むidが5000未満のデータを抽出し、そのデータのplaceカラムをすべて空に（削除）したいと思っています。 SELECT * FROM office WHERE place like '%東京%' and id < 5000 order by id asc; 上記のselect構文で希望データを抽出することはできたのですが、その抽出したデータのplaceカラムを空に（データを削除）する方法が分かりません。 アドバイス頂けると助かります。 よろしくお願いいたします。
データを年度の古い順に保存。 誤っているデータは、noを修正したい。 ●現在のデータ codenoyear --------------- 10112012 10122008 10132010 ↓ 正しくは、 ●正しいデータ codenoyear --------------- 10112008 10122010 10132012 この場合、誤ったデータを検索するSELECT文はどのように書くのが良いでしょうか？ 誤ったデータがある、codeを検索。 noの数字を修正、となります。 わかる方がいましたら教えて下さい。
はじめまして 皆様の知恵を貸してください mysqlでの質問なのですが、 簡潔にいうと日付が比較できません。 どういうことをしたいのかというとsqlからwhere文で今の日付より大きいもデータを抽出するということです データベースの構造は id int型 endtime datetime型 で構成されています endtimeには既にいくつかのdatetime型の値が入っています 例えば　2012-12-14 09:18:00 のように入っています でGETDATE()関数を使って今現在の時刻より未来のものだけ抽出するために convert関数を使って一度varchar型に変換することで比較しようとしました 色々インターネットで調べた結果次のような文なのではないかと考えました select id,endtime from [データベース名] where CONVERT(VARCHAR,endtime,121)>=CONVERT(VARCHAR,getdate(),121); しかし実行ができません 比較する方法を教えて欲しいです
下記条件を満たすSQL文を知りたいのですが、どう書けばよいでしょうか？ ■構成 Aテーブル ・「id」カラム ・「created_at」カラム … datetime型 ・「area」カラム Bテーブル ・「a_id」カラム ・「created_at」カラム … datetime型 ■前提 ・Aテーブルの1レコード(「id」カラム)に対して、0～複数のBテーブルレコード(「a_idカラム」)がある ・A.id = B.a_id ■欲しい内容 ・「Aテーブル」「Bテーブル」それぞれのカラム内容全部。※条件あり ▼条件1 Aテーブル「id」カラムに対応したBテーブルの「a_id」が複数ある場合には、該当Aテーブル内容＋ Bテーブル「created_at」カラムの値が一番新しいレコードを返す(取得レコード数は常に1) ▼条件2 Aテーブル「id」カラムに対応したBテーブルの「a_id」がなかった場合には、該当Aテーブル内容＋ Bテーブル側は何も返さない ▼条件3 ※同名カラムを取得する際には、カラム名先頭にそれぞれa、bを付与(「acreated_at」「bcreated_at」) ・後で、それぞれのテーブルカラムとして利用したいだけなので、それが出来れば形式にこだわりはありません
アクセスログの分析のため月ごとで、データをlog_siteというテーブルに入れ込んでいます。(データ量は約4500万件) ※実際はもっと項目(リクエストURL、HTTPステータス、UAなど)がありますが、 ここでは省略しています。 +----+-----------------+--------------------+----------+----+------+ + No | IP | DATETIME | YYYYMMDD | HH | HHMM | +----+-----------------+--------------------+----------+----+------+ + 1 | XXX.XXX.XXX.XXX | 2012-11-14 18:50:11| 20121114 | 18 | 1850 | + 2 | XXX.XXX.XXX.XXX | 2012-11-14 11:44:04| 20121114 | 11 | 1144 | + 3 | XXX.XXX.XXX.XXX | 2012-11-14 17:16:06| 20121114 | 17 | 1716 | + 4 | XXX.XXX.XXX.XXX | 2012-11-03 16:47:01| 20121103 | 16 | 1647 | + 5 | XXX.XXX.XXX.XXX | 2012-11-05 19:35:18| 20121105 | 19 | 1935 | + 6 | XXX.XXX.XXX.XXX | 2012-11-03 16:52:39| 20121103 | 16 | 1652 | + 7 | XXX.XXX.XXX.XXX | 2012-11-04 15:19:40| 20121104 | 15 | 1519 | + 8 | XXX.XXX.XXX.XXX | 2012-11-12 12:34:58| 20121112 | 12 | 1234 | + 9 | XXX.XXX.XXX.XXX | 2012-11-09 09:50:53| 20121109 | 09 | 0950 | + 10 | XXX.XXX.XXX.XXX | 2012-11-09 13:08:53| 20121109 | 13 | 1308 | + 11 | XXX.XXX.XXX.XXX | 2012-11-08 06:57:31| 20121108 | 06 | 0657 | + 12 | XXX.XXX.XXX.XXX | 2012-11-13 11:12:14| 20121113 | 11 | 1112 | + 13 | XXX.XXX.XXX.XXX | 2012-11-05 10:22:42| 20121105 | 10 | 1022 | +----+-----------------+--------------------+----------+----+------+ 各項目は以下のように定義しています。 `No` int(11) NOT NULL AUTO_INCREMENT, `IP` varchar(15) DEFAULT NULL, `DATETIME` datetime DEFAULT NULL, `YYYYMMDD` varchar(8) DEFAULT NULL, `HH` varchar(2) DEFAULT NULL, `HHMM` varchar(4) DEFAULT NULL, やりたいこととしては、1分または1時間単位でアクセスを集計しグラフを書こうとしています。 グラフに対しては、43,56,35,・・,5といった状態で渡せばグラフを書いてくれるのですが、 そのデータを取り出すため以下のようなSQLを書いて、各1分単位でそのカウントをして見ました。 select HHMM, count(IP) from log_site where YYYYMMDD='20121101'and ( (HHMM='0000')or(HHMM='0001')or(HHMM='0002')・・・・(HHMM='2359') )group by HHMM; +------+-------+ + HHMM | count | +------+-------+ + 0001 | 43 | + 0002 | 56 | + 0003 | 35 | (----省略----) + 2359 | 5 | +------+-------+ アクセス時間については、DATETIMEの項目にデータを入れているのですが 1分ずつ、1時間ずつ集計するのに日時や秒の情報が邪魔だったので YYYYMMDD、HH、HHMMといった内容で情報を持たせています。 実行した結果、取得できるのに300-400秒必要なのですが、 1日を取得するだけで、5-7分要するのは、なんとかならないでしょうか？ 最低でも3日、最高で7日間ぐらいのデータは取得したいと考えているため、 この時間はかかりすぎなのです。 やはりログデータ量が約4500万件あるという多さから予め日ごとで集計された 数字を別テーブルに持たせることを考えていたのですが、 引っ掛けたいリクエストURLや、HTTPステータス、UAなど他の項目でも アクセス傾向が知りたいため、予め日ごとで集計された結果を別テーブルに持つ ということは出来ないので、予め集計された結果を持っておく訳にも行かず困っています。 もし今の状況でどのようなＳＱＬだったら、データをスムースに取得できるのでしょうか？ またスムーズにデータを取得するためにデータ構造の見直しが必要としたら どのように変えて、かつどのようにｓｑｌを組んで取得すればよいのでしょうか？ （仮に、日ごとでテーブルを作った場合は1日あたり150万程度になりますが 日をまたぐ場合は、どのようなSQLになるのでしょうか？） もっといい方法があれば教えていただければと思います。 よろしくお願いいたします。
恐らくそれほど複雑なSQLではないと思いますが、中々SQLが作成できず困っています。 回答いただければ嬉しいです。 以下のテーブルがあったと仮定します。 テーブル名： 　売上げ明細 カラム： 　・商品ID　…　売上げ明細なので一意ではありません 　・単価　…　同じ商品IDでも、レコードによって単価は異なります 　・数量　…　1～5の整数のみとします 実際のデータは以下の通りです。 商品ID,単価,数量 1001,50,2 1001,60,5 1002,90,3 1003,60,5 1003,80,4 1003,90,1 1004,60,3 上記データを以下の通り抽出するには、どのようなSQLを組めばいいでしょうか？ １．まず各商品IDの中から単価が最大のレコードだけを取り出す 商品ID,単価,数量 1001,60,5 1002,90,3 1003,90,1 1004,60,3 ２．次に数量でgroup by して、件数をカウントする 数量,件数 1,1 3,2 5,1 １つのSQL文で２の結果が得られれば、途中の抽出条件は特に問いません。 ちなみにMySQL5を使っています。 よろしくお願いします。
グルーピング内で、あるカラムの最大値のレコードで絞り込む方法は、 以下のサイトで知ることができましたが。 http://www.yokablo.com/20120905717.html tb_score +-------+-------+-------+ | c_name | game | c_score | +-------+-------+-------+ | 山田 | 高飛び | 90 | +-------+-------+-------+ | 山田 | 徒競走 | 85 | +-------+-------+-------+ | 山田 | 玉入れ | 90 | +-------+-------+-------+ | 鈴木 | 徒競走 | 85 | +-------+-------+-------+ | 鈴木 | 騎馬戦 | 50 | +-------+-------+-------+ | 室伏 | 綱引き | 100 | +-------+-------+-------+ | 室伏 | 玉入れ | 10 | +-------+-------+-------+ SQL文： SELECT * FROM tb_score INNER JOIN ( SELECT c_name, MAX(c_score) AS MAXSCORE FROM tb_score GROUP BY c_name ) AS TBDUMMY1 USING (c_name) WHERE c_score = MAXSCORE 私の場合、t_score の親テーブル名`t_company`と、 子テーブル`t_items`がありまして、 以下のようなことをやりたかったのですが、エラーとなります。 上記SQL をサブクエリにします。 select * from ( SELECT * FROM tb_score INNER JOIN ( SELECT c_name, MAX( c_score ) AS MAXSCORE FROM tb_score GROUP BY c_name ) AS TBDUMMY1 USING ( c_name ) INNER JOIN t_company ON t_company.c_name = tb_score.c_name WHERE c_score = MAXSCORE ) as T1 , t_items where T1.id_score = t_items.id_score 結果エラーメッセージは、 #1060 - Duplicate column name 'c_name' でした。 エラー箇所が、 GROUP BY c_name　か、 USING ( c_name )　か、 INNER JOIN t_company ON t_company.c_name = tb_score.c_name なのか、分かりません。 SQL の規則としてやってはいけないことをやっていると想像してますが、 ご指摘・ご指導いただけると大変に助かります。 よろしくお願いします。
以下のようなテーブルがあった場合、PARENT が 0 のものを抜き出して、且つそれに紐づいてるカラムの個数を取得したいのですが、どのようにしたらいいでしょうか？ +---+----+--------+ + ID | XXX | PARENT | +---+----+--------+ + 1 | *** | 0 | +---+----+--------+ + 2 | *** | 1 | +---+----+--------+ + 3 | *** | 4 | +---+----+--------+ + 4 | *** | 0 | +---+----+--------+ + 5 | *** | 1 | +---+----+--------+ + 6 | *** | 0 | +---+----+--------+ + 7 | *** | 4 | +---+----+--------+ + 8 | *** | 4 | +---+----+--------+ *PARENT には、ID に紐づいた値が入ります 出力例 +---+----+--------+ + ID | XXX | COUNT | +---+----+--------+ + 1 | *** | 2 | +---+----+--------+ + 4 | *** | 3 | +---+----+--------+
Mysqlの命令文作成で完全に詰まってしまって途方に暮れています。 添付画像にあるように、テーブルAのanwserの値とテーブルBのuser_answerの値が同じ場合に、テーブルBのanswer_flagを0から1に変更するというMYSQLの命令文を書きたいのですが、上手く行きません。。。 UPDATE tbl_quiz_log SET answer_flag = 1 WHERE user_answer = ANY( SELECT tbl_question.anwser FROM tbl_question INNER JOIN tbl_quiz_log ON tbl_quiz_log.question_id = tbl_question.question_id ) 何が間違っているのでしょうか？ どなたかお力をお貸し頂けませんでしょうか？ どうぞよろしくお願い致しますm(_ _)m ●補足 ※1 キャプチャー画像のカラムは一部のカラムのみ表示している状態です。 ※2 ちなみに、テーブルAのanswerがスペルミスなのは把握しております。
MySQL5.5.27, mysql-connector-java-5.1.12を用いて、DBにアクセスしています。 DBに登録されたテーブル名を取得しようと思い、以下の様なメソッドを作成しました(テーブル名は全て数字です)。 https://gist.github.com/4146754 しばらくは順調に動いていたのですが、DBに登録されたレコード数が25万を超えたあたりで、動かなくなってしまいました。 デバッグをして原因を調べたところ、 metadata.getTables(null, "%", "%", null); の実行時に、メソッドを呼び出したまま固まってしまっていることが分かりました。 同じコードを、別のDBに対して作用させたところ、問題なく動いたため、レコード数が多いのが原因ではないのかと考えたのですが、何かよい対処法はありますでしょうか？ よろしくお願い致します。
誰か助けて下さい！！ さくらインターネットのデータベースで、 MySQLのヴァージョンが低くて、 設置不能のブログ（ワードプレス等）があったので、 ヴァージョンを最新する方法を探していました。 「一回消して再登録する」という記事を読んで、 バックアップも取った上で再登録したのですが、 データをインポートできません。 以前のものは mysql24.db.sakura.ne.jp 今回のは mysql443.db.sakura.ne.jp です。 エクスポートしたデータは「SQL」 「SQL圧縮」「 CSV 」の3つで保存してあります。 再度データベースを作るときにデータベース名を入力する欄がありましたが 以前使っていたものには、そんな入力は要求されなかったような気がします。 もしかしたら、それが原因かも…と思っているのですが、 お分かりになる方いらっしゃいませんでしょうか。 エラーはこちら *-------------------------* エラー 実行した SQL: -- -- データベース: `aaa_01` -- CREATE DATABASE `aaa_01` ; MySQLのメッセージ: #1007 - Can't create database 'aaa_01'; database exists *------------------------------*
初めましてphp,mysql共に初心者です。 現在以下のような問題で頭を抱えています。 映画のデータベースを使った映画の検索システムを考えています。 フィールドはid,sakuhinmei,cast1,cast2,cast3,kantokuの６つです。 検索方法として作品名やキャストなどを一つのフォームを用いて検索する複数条件を用いたシステムを考えています。 そこで以下のようなソースを作りました。 <?php $dsn='mysql:dbname=testdb;host=localhost'; $user='root'; $password='koro0401'; $dbh=new PDO($dsn,$user,$password); $dbh->query('SET NAMES UTF-8'); $kensakuwords=$_POST['kensakuwords']; $sql="SELECT * FROM eiga WHERE (sakuhinmei=.'$kensakuwords'.) OR (cast1=.'$kensakuwords'.) OR (cast2=.'$kensakuwords'.) OR (cast3 =.'$kensakuwords'.) OR (kantoku=.'$kensakuwords'.)"; $stmt=$dbh->prepare($sql); $stmt->execute(); while(1) { $rec=$stmt->fetch(PDO::FETCH_ASSOC); if($rec==false) { break; } print$rec['id']; print$rec['sakuhinmei']; print$rec['cast1']; print$rec['cast2']; print$rec['cast3']; print$rec['kantoku']; print'<br/>'; } $dbh=null; ?> 実行してみるとエラーはでないのですが、何も表示されません。いろいろネットで調べてためしてはみたのですが、自分では何が違うのかわかりませんでした。 どうかｐｈｐ、ｍｙｓｑｌに詳しい方々、お力添えお願いします。 初心者でもわかりやすい解答をお願いします。
まだphpMyAdminを勉強中のものです。どなたか教えてください。 phpMyAdminでMySQLデータのエクスポートはオンラインのままでも実行できるのでしょうか？ 色々とサイトを見てみたのですがはっきり書いているものがありませんでした。 初歩的な事ですみません。よろしくお願いします。
さくらサーバのMysql、phpMyadminを利用しています SQL文を勉強してSQL文で書けばいいのでしょうが phpMyadminlのマンマシンインターフェースが便利なのでいつもそれを 利用しています 今回、あるテーブルからある条件に合致するレコード約2000件を 一度に削除しようとしています phpMyadminの検索タブを利用してある条件を指定して、条件に合致する レコードは2000件表示されてきます その抽出された2000件のレコードを一挙に削除したいのですが・・・ phpMyadminでは抽出レコードの表示について、初期値では1画面、 30件毎に表示されるようになっています その画面毎に一番下にメニューがあり各レコードごとにチェックボックス があり、レコード毎にチェックして、チェックがついたレコードを削除 できるようになっていますが 1レコードずつ全部をしていくのは大変のため、画面下にある「すべてのレコード にチェック」をつけるメニューがあります 2000件のテータ消去をするためには 初期値の1画面30件の表示では、70回弱の操作が必要となるため大変です このため、1画面2000レコード表示に指定すると、表示はしてくるのですが 30表示の場合に一番下に出ていた、「すべてチェックする」表示が出て きません Sql文でなく、マンマシンインターフェースで簡単に抽出してきた2000件の レコードを削除する方法はないでしょうか あれば教えていただきたいのですが・・
さくらサーバのMysql、phpMysqlを利用しています SQL文を勉強してSQL文で書けばいいのでしょうが phpMysqlのマンマシンインターフェースが便利なのでいつもそれを 利用しています 今回、あるテーブルからある条件に合致するレコード約2000件を 一度に削除しようとしています phpMysqlの検索タブを利用してある条件を指定して、条件に合致する レコードは2000件表示されてきます その抽出された2000件のレコードを削除したいのですが・・・ phpMysqlでは抽出レコードの表示について、初期値では1画面、 30件毎に表示されるようになっています その画面毎に一番下にメニューがあり各レコードごとにチェックボックス があり、レコード毎にチェックして、チェックがついたレコードを削除 できるようになっていますが 1レコードずつ全部をしていくのは大変のため、画面下にすべてのレコード にチェックをつけるメニューがあります 初期値の1画面30件の表示では、70回弱の操作が必要となるため大変です このため、1画面2000レコード表示に指定すると、表示はしてくるのですが 30表示の場合に一番下に出ていた、「すべてチェックする」表示が出て きません Sql文でなく、マンマシンインターフェースで簡単に抽出してきた2000件の レコードを削除する方法はないでしょうか あれば教えていただきたいのですが・・
書き込みさせて頂きます。 今までは、Dreamweaverを使用してhtmlを修正していました。 しかし、phpを使用しているページが出来てしまい、うまく表示できなくなりました。 そのため、XAMPPをインストールしてファイルを表示できるようにしたいです。 ※データベースは使いません。 ※修正後、ファイルをFTPソフトでアップロードします。 しかし、XAMPPのページを見ていると http://www.apachefriends.org/jp/xampp-windows.ht … セキュリティに深刻なリスクとなり得ます。等が書いてありますので インストールしようにも何だか怖くて躊躇しています。 上記のような使い方をする場合、セキュリティに何か問題が出てくるのでしょうか。 個人ではなく会社のサイトなので、心配で書き込みいたしました。 もし問題がある場合は、どのような問題があるものですか？ また、会社にはネットワーク管理者がいるのですが XAMPPをインストールする旨を伝えたほうが良いものでしょうか？ あまり交流のない部署なので…伝えなくても良いものであれば そのままインストールしたいのですが；； よろしくお願いします。
2度目の質問となり恐縮しております。 生徒の成績の得意不得意をあらわすSQLを考えています。(mySQL 5.5 centOS6.3) テストの成績をもとに 「kamedaの一番の得意科目(クラスでの相対順位が最上位)は英語で、クラス2位である」 「kamedaの二番の得意科目は数学で、クラス4位である」 「kamedaの三番の得意科目は国語で、クラス7位である」 ということが分かるようにする予定です。 当初私が考えた案ではlimit句を使った方法を考えており、limit後の値を変更することにより2位、3位を出す予定でしたが、私の方法ではうまくいかなかったためこのサイトで質問をさせて頂いたところ、minを使った方法を紹介れました。 (私の質問方法が「クラスの最上位を求める」というように省略して記載していたためmin句での回答を頂くことになりました) この回答をベースに当方で2番目を抽出出来るよう改造に着手しましたがうまく出来ません。 ●min句ベースではminから2番目というものをどうしても取ることが出来ませんでした。 ●このmin句ベースのものをlimit句のSQLに改造しようとトライしたのですがどうしても改造することが出来ませんでした。 何度もこの場をお借りして恐縮ですがお知恵を拝借したくお願い申し上げます。 **************************************************** ベースとなるデータ CREATE table seiseki2 (usr_id TEXT,kyoka_name TEXT,point INT); CREATE table point_rank (p_usr_id TEXT,1st_kyoka_name TEXT,1st_rank INT); INSERT INTO seiseki2 (usr_id,kyoka_name,point) values ('kameda','数学',85),('suzuki','数学',71),('kaneko','数学',32),('yosida','数学',61),('tanita','数学',70),('suyama','数学',80),('kisida','数学',61),('komine','数学',99),('tomita','数学',89),('sugita','数学',75),('kameda','国語',80),('suzuki','国語',46),('kaneko','国語',52),('yosida','国語',89),('tanita','国語',77),('suyama','国語',67),('kisida','国語',81),('komine','国語',89),('tomita','国語',69),('sugita','国語',70),('kameda','英語',94),('suzuki','英語',86),('kaneko','英語',50),('yosida','英語',59),('tanita','英語',48),('suyama','英語',97),('kisida','英語',74),('komine','英語',82),('tomita','英語',59),('sugita','英語',60); INSERT INTO point_rank (p_usr_id,1st_kyoka_name,1st_rank) values ('kameda','',''),('suzuki','',''),('kaneko','',''),('yosida','',''),('tanita','',''),('suyama','',''),('kisida','',''),('komine','',''),('tomita','',''),('sugita','',''); ***************************************************** この場で回答頂きましたSQL 下記はmin句を使用して最上位の教科を出すことが出来ます。 今回の質問は下記を改良し、2番目の教科、3番目の教科を出したいと考えています INSERT INTO point_rank (p_usr_id, 1st_rank, 1st_kyoka_name ) SELECT d1.id , min(d1.rank) AS top_rank , (select GROUP_CONCAT( kyoka ) from (SELECT t1.usr_id as id , t1.kyoka_name as kyoka ,( SELECT count( * ) +1 FROM seiseki2 AS t2 WHERE t2.point > t1.point AND t2.kyoka_name = t1.kyoka_name ) AS rank FROM seiseki2 AS t1 ) as d2 where d2.id=d1.id and d2.rank= min(d1.rank) group by d2.id ) AS kyoka FROM ( select t1.usr_id as id ,( SELECT count( * ) +1 FROM seiseki2 AS t2 WHERE t2.point > t1.point AND t2.kyoka_name = t1.kyoka_name ) AS rank FROM seiseki2 AS t1 ) as d1 group by d1.id ; ********************************************* ご参考 私が当初考えたSQL　順位は出ますが教科が出せません UPDATE point_rank SET 1st_rank= (SELECT ( SELECT count( * ) +1 FROM seiseki2 AS t2 WHERE 1 AND t2.point > t1.point AND t2.kyoka_name = t1.kyoka_name ) AS rank FROM seiseki2 AS t1 WHERE t1.usr_id = point_rank.p_usr_id ORDER BY rank ASC LIMIT 0 , 1)
サイト上のデータから構築したデータベースがあります。 サイト上のデータが更新された場合に、連動してデータベースが更新したいと思っています。 現状は、ChromeのPage　Monitorに更新が上がってきたら、目視で確認して、SQL文を叩いてinsertするという流れでやっています。 更新を少しでも自動化できればと思います。 とはいえ、当方はPHPとMySQLが少しできる程度の初心者なので、あまり複雑なことはできませんが。。。 初めにデータベースを構築した時は、Simple HTML DOM Parserを使ったので、これを使って更新を少しでも自動化できればと思いますが、勿論これを使わなくても構いません。 なお、サイト上のデータは、新しいものが下に来るとは限りません。 【更新前】 hoge1 hoge2 hoge3 【更新後】 hoge1 hoge4 New! hoge2 hoge3 上記のように追加されたものが途中に来る場合もあります。 一方、データベースの方では、ID管理しており、追加されたものは次のIDになるようにしたいです。 id　　　　　name 1　　　　　hoge1 2　　　　　hoge2 3　　　　　hoge3 4　　　　　hoge4 なお、マルチプライマリーキーを使っている関係で、idカラムにはauto_incrementは使っていません。 以上、情報が不足しているかもしれませんが、アドバイスいただければ幸いでございます。 （不足があればおっしゃってください。補足いたします。） また、サイト管理者には手間をかけない約束になっているので、APIで提供してもらうとかFTPで送ってもらうとか、そういうのはナシでお願いします。
カラムの合計数値を検索対象にしたいのですがどう記述すればいいでしょうか？ [TABLE_A] |ID|No1|No2|No3| |A |10 |10 |10 | |B |5 |15 |10 | |C |5 |5 |10 | |D |10 |5 |10 | |E |10 |5 |5 | 例えば上記の様なデータがある場合、No1,No2,No3の合計が30以上のレコードを抽出したい場合はどう記述すればいいでしょうか？ アドバイスよろしくお願いします。
お世話になります。 mysql 超初心者です。 Count( a) AS b FROM tblで aをCountするのはnull値以外で空白もCountしてしまいます。 これを空白もnull値と同じにCountしない方法はどうするのでしょうか？ または空白のみをCountする書き方等あるのでしょうか？ 色々調べてもググってもよくわかりませんでした。 初期値のnull値が一回書き込まれたデーターを削除すると 空白になってCount( a) でCountされて困っています。 初心者なのでなるべく具体的な回答をお待ちしています。 どうかよろしくお願いいたします。
phpMyadmin3.3.10を利用しています それを利用しての検索・削除について質問させてください あるテーブルを選択してそのデータを表示します そして表示されている画面の上にある「検索」メニュー を指定すると何のフィールドで検索するか聞いてきます 必要なフィールドに検索ワードを入れて(例えば「会社」=○○) 実行するとその検索に該当するデータが表示されます ここまではそれでいいのですが 例えば検索結果のデータが900件あったとした場合、現在は1画面に 30件ずつ表示されています 今回、この検索結果で表示された900件すべてを削除したい のですが、画面の下にある「すべてチェックする」という表示 をクリックすると、1画面(30件)しかチェックしないのでこれを チェックして削除にしても、30件しか削除できません。 このように1画面毎チェックして削除する操作となると30回の操作 をする必要があります 1画面100表示にしても、9回操作する必要があります 画面全部(表示されていない画面の分を含めて・・)をチェック して削除する方法はないでしょうか
「さくら」のレンタルサーバを利用しています そのサーバのデータベースはMySql　5.1を使っているようですが さくらが用意している管理ツール(phpMyadmin)を利用して データをCSVデータとしてエクスポートしたいのですが 日本語が文字化けします ダンプ表示には (1)CSV (2)MS Excel用のCSV (3)・Excel 97-2003 XLS workbook (4)Excel 2007 XLSX Workbook 等々の形式があるのですがいずれも文字化けします 一番下に文字コードを選択する項目があり ・non ・EUC ・SJIS のいずれもやってみたのですが結果は文字化けしてしまいます サーバ側の文字化けしないでエクスポートするためには どのように設定すればよいのでしょうか 教えていただければ幸いです
Wordpressで作られたサイトを まるごと別サーバーへお引越しする時に MySQLのデータをphpmyadminでエクスポートしています。 データベースのことはよく分からないのですが 下記サイトなどを見ながら、見よう見まねでやっています。 http://crushpow.com/archives/449.html http://memocarilog.info/wordpress/1268 http://word-express.net/wp-17#2 しかし、構造のところの 「IF NOT EXISTSを追加」 とデータのところの 「完全なINSERT文を作成する」 「長いINSERT 文を作成する」 という項目にチェックを付けている人と付いていない人がいます。 これは何が違うのでしょうか？ 自分の場合は、３箇所ともチェックを入れてエクスポートして 特にトラブルなく移行できているのですが、 とても気になりましたので、質問しました。 よろしくお願いします。
先ほど質問させていただいたものです． http://oshiete.goo.ne.jp/qa/7800181.html MySQLではwith rollupを使用して,希望の結果を得ることが可能だったのですが, 次に,Accessで同じSQLを実行したところ,エラーになってしまいました．(AccessにはWith Rollupがないようでした．) AccessでMySQLのWith Rollupの代わりになるような機能はありますでしょうか? 何度も申し訳ありませんが,宜しくお願い致します．
現在,MySQLを使用して,データベースを作成しています． 品番と,指定した期間以前のデータの数量を合計しようと思い,下記のようなSQLを実行してみました． select 品番,期間,sum(数量) as sumQuantity ftom 履歴 where 品番 = 'A' and 期間 <= '1302' group by 品番,期間 (期間は2013/02なら12/11になり,さらに / を除去した値です) 結果が添付図のようになりました． さらに,この結果のsumQuantityの合計を求めるにはどのようなSQLを記述すればよいでしょうか? サブクエリを使用するのかな?と思いましたが,うまく記述できませんでした． お分かりになられる方がいらっしゃいましたら,ご教授お願い致します．
MySQLで全文検索を行いたく、色々と調べ、試行錯誤をしたのですが どうしてもできないので、mysqlでの全文検索のやり方がわかるかたがいらっしゃいましたら お教え願えますでしょうか。 私がやったこと ０。Mysqlのバージョン　5.5.23をインスコ　　my.confにft_min_word_len=1を追加　mysql再起動 １。MyISAM型のbookテーブルを作成（utf8_general_ciでとりあえず idとsearch_wordsという２カラムのみ idをprimaryに設定） ２。検索対象であるsearch_wordsをFulltext型に変換 　　sql> alter table book add fulltext( search_words ); ３。データを登録 　　insert into book (id, search_word) value (1, '夏目漱石 こころ natsume souseki kokoro BOOK-NO-012 時は明治末期。夏休みに鎌倉へ旅行をしていた「私」は鎌倉に来ていた「先生」と出会い交流を始め東京に帰った後も先生の家に出入りするようになる。先生は奥さんと静かに暮らしていた。先生は私に何度も謎めいた、そして教訓めいたことを言う。私は、先生に過去を打ち明けるように迫ったところ来るべき時に過去を話すことを約束した。'); ４。mecabで分かち書きした、「夏目」「漱石」をスペースで区切った文字で検索 　　っがしかし、検索結果が帰ってこない 実行してみたSQL 　　select * from book where match( search_word ) against( '夏目 漱石' IN BOOLEAN MODE); 　　select * from book where match( search_word ) against( '+夏目 +漱石' IN BOOLEAN MODE); 　　select * from book where match( search_word ) against( '"夏目 漱石"' IN BOOLEAN MODE); 　　select * from book where match( search_word ) against( '"+夏目 +漱石"' IN BOOLEAN MODE); 　　select * from book where match( search_word ) against( '"+夏目 +漱石"' IN BOOLEAN MODE); 　　select * from book where match( search_word ) against( '"*夏目 *漱石"' IN BOOLEAN MODE); 　　select * from book where match( search_word ) against( '"*夏目* *漱石*"' IN BOOLEAN MODE); 　　「夏目漱石」とひとくくりにした文字列で検索すると、レコードが帰ってきます 　　　また、against( 'natsume souseki' IN BOOLEAN MODE);　も帰ってきます 実際にやってみたいことは、上記の文章で「先生」「鎌倉」「私」「夏目」の４語で検索すると 上記のレコードが帰ってくるということがやりたいですのですが、 select * from book where match( search_word ) against( '夏目 先生 鎌倉 私' IN BOOLEAN MODE); のSQLや対象文字列に＋や＊を付けたものを実行しても引っかかりませんでした。 私が行った設定／sqlに不備がございましたらご指摘／ご指導いただけませんでしょうか。 よろしくお願いいたします。
東京都の学校別のランクを作っています。 現在、name school pointまでは記載されています。 この後、SQL構文で、rank欄に学校内順位を入れ、city欄にtokyoを入れたいと考えています。 完成形は下記のようなものです。 （同点2位が2人いたら、いずれも2とし、その次の人は4となる) table name__school__city___point___rank kameda__1高__tokyo___345____ 1 suzuki__2高__tokyo___341____ 1 kaneko__3高__tokyo___332____ 1 yosida__2高__tokyo___321____ 2 tanita__1高__tokyo___310____ 2 suyama__1高__tokyo___310____ 2 kisida__2高__tokyo___301____ 3 komine__1高__tokyo___299____ 4 tomita__2高__tokyo___289____ 4 sugita__1高__tokyo___275____ 5 下記のreplace文を考えたのですが、学校別の順位ではなく全体順位の入力となってしまいます。 REPLACE INTO table(rank,city) SELECT ( SELECT COUNT(t2.poit) FROM table t2 WHERE t2.poitn > t1.point AND t2.school = t1.school GROUP BY t2.school ) + 1 AS rank,tokyo FROM table t1; 学校別の順位を入力するためにはどのように改良すればいいでしょうか? SQLはmySQL5.5 CentOS6.3です。 よろしくお願いいたします。
Windows環境でのMySQLのデータベースバックアップで、以下のように文字コードを指定してバックアップが行われています。 mysqldump -uユーザ名 -pパスワード --default-character-set=sjis データベース名 > ****.sql バックアップからリストアするのですが、同じサーバ上で既存の同じデータベース(名)があるので 一度DROP DATABASE データベース名；してからCREATE DATABASE データベース名；を行うつもりです。 以下の２点について教えてください。 (1)create databaseする際に文字コードを指定する必要がありますでしょうか？ create database データベース名 CHARACTER SET sjis; (2)リストア実行時に文字コードを指定する必要がありますでしょうか？ mysqldump -uユーザ名 -pパスワード --default-character-set=sjis データベース名 < ****.sql 因みに ※my.iniには文字コードの指定で、sjis指定の表記がありました。 ※Moveble TypeでMySQLをデータベースとして使用しています。　 よろしくお願いします。
複数カラム検索をしたいと思い、リンク先の通り、 WHERE concat(field1,char(0),field2) LIKE "%検索語%" としたらうまくいったのですが、 そのページに書いてあることが気になるので、教えてください ▽MySQLで複数フィールドから同一語を検索するには・・・ - MySQL - 教えて！goo 　 http://oshiete.goo.ne.jp/qa/2634613.html ・char(0)て何でしょうか？ ＞%データ%は全件を検索するため効率うんぬんを論ずるような仕組みではない ・どういう意味でしょうか？ ・全件検索する際は、LIKE検索を使わないのでしょうか？ 全文検索エンジン(?)を利用するのでしょうか？ ・全件検索しなければ(例えば2カラムだけ)、LIKE検索を利用しても良いのでしょうか？ ・あるいは、データ規模が少なければ、LIKE検索を利用しても良いのでしょうか？ ＞本番ではこんなことはしませんがあくまでも遊びということで ・どういう意味でしょうか？ ・concatで LIKE 検索を普通はしない、ということでしょうか？ ・それとも、LIKE 検索で、char(0)などのセパレータを挟まない、ということでしょうか？ ・あるいは、全件検索でLIKE検索を普通は使わない、ということでしょうか？
table a ------ user_id ------ user1 user2 user3 user4 user5 ------ table b --------------- user_id role_id --------------- user1 role1 user2 role1 user3 role1 user2 role2 user4 role2 --------------- とします。 １つのＳＱＬ文で、a のすべてのユーザそれぞれが指定role_id に属しているかどうかを検索したいです。 例えば、すべてのユーザそれぞれが　role1 に属しているかどうかを検索します。 欲しい結果は以下の通りです。 ------------ user1 true user2 true user3 true user4 false user5 false ------------ ＬＥＦＴ　ＪＯＩＮ　だと思いますが、うまくいきません。 SELECT a.user_id, b.role_id FROM a LEFT JOIN b ON a.user_id = b.user_id WHERE b.role_id='role1'; 結果は以下になります。 ------------ user1 role1 user2 role1 user3 role1 ------------ ＃Ｗｈｅｒｅで絞って、当然の結果です ＳＱＬをどうかければよいでしょうか。 よろしくお願いします。
お世話になります。 スキーマが二つあります。db1とdb2です。 それぞれ、同じ構造のテーブルを持っていて、格納しているデータだけが違います。 db1にdb2をマージしようとしているのですが、上手くいきません。 手順としては、以下のとおりです。 （１）まず、db1のダンプを取りました。 　　（インポート先でテーブルをドロップしないようにオプションを付加） 　　　c:\>mysqldump -u root --add-drop-table=false -p db1>db1.sql （２）次に、db2に接続してダンプしたファイルをインポートしました。 　　　mysql>\. db1.sql インポートの前後で、テーブルの件数を見たのですが、 変わらないのでマージできていないようです。 以下は当方の使用環境です。 Windows7 Pro 64Bit MySQLServer 5.1（mysql-5[1].1.28-rc-win32） 他に必要な情報があればお聞かせください。 よろしくお願いします。
会員サイトでは10個の資料を掲載しており、 会員の方が資料を開いた際にその会員は資料を確認済みという情報を DB上で管理を行いたいのですが、どのようにテーブルを設計したらよいか ご教示いただきますようお願いたします。 視聴済みの判断としては現在から90日以内に1回以上資料を開いた場合としたいです。
MySQLの公式サイトのリファレンスマニュアルに、そもそもの見方が説明されているページは用意されていますか？ 探したのですが、見当たらなかったので質問させていただきました。 特に斜体の部分が説明がなされているページがあれば大変助かります。 斜体の部分とは、例えば、以下のページのtable_references等です。 http://dev.mysql.com/doc/refman/5.1/ja/update.html 英語の意味からざっくり予想することはできるのですが、直訳してもよく分からないものもあるので。 ご教示のほど、なにとぞよろしくお願い申し上げます。
MySQL初心者です。 基本的な質問ですが、教えてください。 MYSQLデータベースのバックアップは、コマンドラインからmysqldumpでバックアップを行うと思います。 CMD>mysqldump -u(ユーザーグループ) -p(パスワード) (データベース名)　> (バックアップファイル名).sql バックアップSQLを使って再度リストアで入れなおす場合は、 drop database (データベース名);と create database (データベース名); を実行してから行う必要があるのでしょうか？ (バックアップファイル名).sqlの中身を見てみると、 CREATE TABLE '(テーブル名)' (・・・・ ・・・）の前に DROP TABLE IF EXISTS '(テーブル名)'; のようにテーブルのdropをしてからの処理はあるのですが。
MySQL5.5の準同期レプリケーションを使って、マスターサーバー(insert用)とスレーブサーバー(select用)を組み合わせたサイトを作る予定です。 マスター側のサイトはトリガーとイベントを多用しております。(トリガー13個、イベント8個) 当初、マスター側にもスレーブ側にもどちらにもトリガーとイベントを組み込んでいましたが、テストして分かったことは、イベントがエラーを起こすということでした。 マスター側でイベントが始まり結果をスレーブ側に送ることになるわけですが、同時間にスレーブ側のイベントも始まるわけなので、マスターの結果が送られてきたときにはスレーブのテーブルには計算後の数値が記載されており、結果エラーになってしまうことがわかりました。 そのため、スレーブ側のイベントは削除して構築しています。 問題はトリガーについてです。 マスター側にはAテーブルにインサートするとBテーブル、Cテーブル、Dテーブルが連鎖的に変更されるトリガを組んでおり、スレーブ側も同様のトリガを組んでいます。 幸い、いままでのテストでは、トリガーで計算した値が連鎖的に伝わってもエラーになっていません。 ただ、マスター側に高負荷が掛かり、マスターのトリガの計算よりもスレーブ側の計算のほうが早く終了した場合、イベントの時に起こったエラーが出ないか懸念しています。 テストで壊れるのはいいですが、実際に運用した後で壊れることは許されません。 質問としては、「実際にトリガーを使った高負荷サイトを構築されている方でスレーブサーバーを準同期で設定している方」から、どのように組めばよいかのアドバイスを頂きたいというものです。(こんな高負荷サイトで運用しているがトリガを組んでて問題ないなどという例があるとうれしいです) よろしくお願いいたします。 スレーブのトリガーを外すのが一番簡単な方法なのですが、万一マスターがハングアップした際にはスレーブを昇格させる予定ですので出来る限りトリガーはそのままにしたいと考えておりますが、スレーブ側にトリガを組んだままというのは常識的にあり得ないというアドバイスであればそれでも結構です。 これはお願いなのですが、「他のサイトを調べて回答する」という方は申し訳ございませんがご遠慮願います(私も簡単なテストは済ませており低負荷では問題が生じないことまでは分かっております。ブログに落ちているような経験値はこれと大差ありません。この程度ではアドバイスにならないと感じています。) 実際に運用経験があり、正確な知識をお持ちの方にアドバイス頂きたいと思います。 よろしくお願いいたします。 構成はCentOS 6.3 MySQL 5.5.28です。
スクリプト言語「PHP」とGUI 、 データベース言語「SQL」とCUI は無関係？
実習の考察で困ってます。 スクリプト言語「PHP」からデータベース言語「SQL」を使用し、データベースを扱う標準関数を利用してデータベースへの「接続」「問い合わせ」「切断」を行うというものです。 私の書いた考察は、「GUIの説明・利点欠点。CUIの説明・利点欠点。」です。 画像のようなことを実習中にメモしGUIとCUIについて書きました。 この考察を今回の実習に関連付けたいのですが、どうしたらいいですか？
下記のようなカラムがある時、DBから取得した値を、引数(並べ替え順)に応じて、(同じカラムを)更新するSQL文を教えてください ●カラム id1　sex1　age1　id2　sex2　age2　id3　sex3　age3　id4　sex4　age4　 ●引数例 3 1 2 ※1番目が3、2番目が1、3番目が2 ・「1の数字が付いたカラムの値」を、「3の数字が付いたカラムの値」で更新したい ・「2の数字が付いたカラムの値」を、「1の数字が付いたカラムの値」で更新したい ●質問 ・MySQLだけで処理可能でしょうか？ UPDATE テーブル名 SET id1=(SELECT id3 FROM テーブル名 WHERE id1=id3値),sex2=(SELECT sex3 ……; ・それとも、一度、全ての値を取得して、PHP等で処理するのでしょうか？ UPDATE テーブル名 SET id1=id3値,sex1=sex3値,age1=age3値,id2=id1値 ……; ・他に何か良い方法はあるでしょうか(一旦別テーブル作成後、戻す等) ●環境 MySQL5.1
MySQL5.5でレプリケーション(準同期)を構築しています。 http://it.sifr.me/mysql-semi-synchronous-replica … 上記のサイトを参考に、マスターサーバー(192.168.100.101)からスレーブサーバー(192.168.100.105)にレプリケーションの予定です。 上記サイトをもとに構築していたのですが、レプリケーションの前の段階の 「SFTPで/var/lib/mysql/に接続、PUT」するという単純なことが出来ません。 下記のように192.168.100.101にあるSQLをスレーブサーバー192.168.100.105にSFTPで接続してPUTするという作業をしたころ Couldn't get handle: Permission denied になってしまっています。 [root@sv1 ~]# cd /var/lib/mysqll　　　　　　//192.168.100.101のマスターサーバー上でcd [root@sv1 mysql]# sftp -oPort=22 replica@192.168.100.105　//スレーブに接続 Connecting to 192.168.100.105... replica@192.168.100.105's password: sftp> cd /var/lib/mysql　　　　　　//192.168.100.105のスレーブサーバー上でcd sftp> put master-mysql-data.tar.gz　　　//192.168.100.105のスレーブサーバーにput Uploading master-mysql-data.tar.gz to /var/lib/mysql/master-mysql-data.tar.gz Couldn't get handle: Permission denied　　//エラー sftp> 現在のユーザー設定は以下の通りです。 ユーザー名はいずれも　replica で 192.168.100.101(マスター) ●linuxユーザー(ユーザー名　replica) ●mySQLユーザー(ユーザー名　replica) 　　　ホスト192.168.100.105 スレーブレプリケーションの許可 192.168.100.105(スレーブ) ●linuxユーザー(ユーザー名　replica)(グループ　mysql) ●mySQLユーザー(ユーザー名　replica)　 　　　ホスト192.168.100.101 　　　スレーブレプリケーションの許可&クライアントレプリケーションの許可 と設定しています。 尚、PUT先の192.168.100.105　の/var/lib/mysql/の所有者はユーザー、グループともmysqlです。 mysqlユーザーで行えばput可能のでしょうが、どのサイトを見てもreplication専用ユーザーを作って対応することとなっており、安全上の面からも機能限定のユーザーでputしたく考えております。 対応方法についてご教授いただきたくお願いいたしします。
SQL文の文法エラーの原因が分からないので、ご教示ください。 ものは、掲示板になります。 PHPからSQLを実行しています。 テーブルの中身とSQL文とエラー文は以下の通りです。 【テーブル】 category_id | tinyint(3) unsigned shop_id | tinyint(3) unsigned id | int(10) unsigned name | varchar(255) 【SQL文】 $sql="insert into テーブル名 value(".$_SESSION['category_id'].",".$_SESSION['shop_id'].",".$_SESSION['thread_id'].",'".$_SESSION['name']."')"; 【エラー文】 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ',testname)' at line 1 エラー文中の「testname」は、テストのために、カラム「name」のところにこちらで入れたものになります。 情報に不足があれば、補足するのでおっしゃってください。 以上、よろしくお願い申し上げます。
MySQLでfieldを2916個作ろうと思ったのですが、上限が1000個なのか、1001個目を作ろうとすると下のようなエラーが出ます。 ERROR 1005 (HY000): Can't create table 'features.#sql-1664_18' (errno: 139) featuresというのはデータベース名です。上限をなくす、または大きくする方法があれば教えて下さい。よろしくお願いします。
初めまして。PHP・MySQLの初心者で大変恐縮ではございますが、 ご質問させていただきます。 MySQLに画像を保存する際に、方法としてDBに 直接登録する方法（BLOB型）とディレクトリに画像を 格納する方法とがあると思うのですが、 画像を呼び出す際に、この二つの方法によって できる事やできない事、またメリットやデメリットというのもは どういったものなのでしょうか？ 当方の目的としましては、フリーワード等での検索や商品の比較、 買い物かごの制作等を今のところ視野に入れていますが、 この３つの目的以外にも、今後制作して行く上での 参考にできればと考えております。 お力を貸していただければ大変嬉しく思いますので、よろしくお願いいたします。
お世話になります。 ACCESS下記の通りにSQL又はVBAで文字を追加するにはどうすれば良いでしょうか。いい方法があればお手数ですが、教えてください。よろしくお願い致します。 あるテーブルのフィールドに県名があり、例えば青森、岩手、秋田、宮城など記入されている箇所の頭に"東北"と追加し、東京、埼玉、群馬などには"関東"と文字を一括で追加したいのですが、どうすれば良いでしょうか、条件により一括でという方法を調べていたのですが、中々良い方法が分かりませんでした。良い方法を知っている方いらっしゃいましたらよろしくお願い致します。
日付、天気、気温が並んでいるテーブルがあるとします。 そこからデータを抽出して天気ごとにグループ化し、 「天気」「最高気温」「最高気温が出た日付(複数あれば新しいほう)」「20℃以上になった最新の日付」 というビューを作りたいのですが、書き方がわかりません。 単純にグループ化すると最高気温はmaxで出せますが、日付もmaxにすると気温と関係のない最新の日付になってしまいます。 条件をつけたい場合どのようにすればいいか教えてください。
既にあるカラムをコピーして、新たなカラムを作成したいのですが、うまくいきません。 どうしたらいいでしょうか？ INSERT INTO `rtable`.`3_column` SELECT * FROM `rtable`.`2_column` 実行すると、下記エラーになります。 #1142 - INSERT command denied to user 'DBユーザー名'@'localhost' for table '3_column' 通常のINSERTなら出来るのですが、この場合のINSERTは、何か特別な実行権限になるのでしょうか？ 環境:レンタルサーバ ちなみに、テーブルをコピーして、新規テーブル作成するのは、下記で出来たのですが、 「テーブルコピー」と「カラムコピー」では、何が違うのでしょうか？ INSERT INTO `データベース名`.`newtable` SELECT * FROM `データベース名`.`oldtable` ;
テーブル作成後に複数のカラムを対象にしたプライマリーキー制約を設定することはできるのでしょうか。 テーブル作成時であれば、次の方法により設定することができます。 ※col_name1及びcol_name2に設定したい場合 CREATE TABLE tbl_name (col_name1 int NOT NULL, col_name2 int, col_name3 varchar(255), PRIMARY KEY(col_name1, col_name2)); しかし、一旦テーブルを作成した後に、プライマリーキー制約を設定し忘れたことに気が付き、設定したい場合は、いかなる方法によりできるのでしょうか。 次の方法にて試みたものの、エラーが生じました。 【SQL文】 ALTER TABLE tbl_name MODIFY col_name1 int, col_name2 int, PRIMARY KEY(col_name1, col_name2); 【エラー内容】 ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'col_name2 int, PRIMARY KEY(col_name1, col_name2)' at line 1 テーブルを削除し、再作成時にプライマリーキー制約を設定する方法によっても対応できますが、削除しなくてもこれを行える方法があるのか否かを知りたく、質問させていただきました。
以下のようなテーブルが3つある場合に2つのテーブルにあるポイントを合計して取得したいと思っています。 ただ、外部結合しているtable_cに条件を与えるとうまく取得できません。 table_cにcdがある場合は条件を指定し、 ない場合は条件を指定しないようにするにはどうすればいいのでしょうか。 【table_a】 id　　　　name ------------------ a1　　　　aaa a2　　　　bbb a3　　　　ccc 【table_b】 b_id　　　　 a_id　　　user_id　　　　point --------------------------------- b1　　　　　a1　　　　00001　　　　5 b2　　　　　a1　　　　00002　　　　2 b3　　　　　a3　　　　00007　　　　10 b4　　　　　a2　　　　00356　　　　10 【table_c】 c_id　　　　user_id　　　　cd　　　　　bonus_point ------------------------------------------------ c1　　　　　00001　　　　cd_1　　　　1 c2　　　　　00007　　　　cd_2　　　　1 c3　　　　　00356　　　　cd_1　　　　1 SELECT table_b.user_id as user_id , (ifnull(table_b.age_count) + ifnull(table_c.bonus_point, 0)) as total_point FROM table_a INNER JOIN table_b ON (table_b.a_id=table_a.a_id) 　　　LEFT JOIN table_c ON (table_c.user_id=table_b.user_id) WHERE table_c.cd = 'cd_1' ORDER BY total_point desc ■結果 user_id　　　　total_point ----------------------------- 00356　　　　　11 00001　　　　　 6 ■求めたい結果 user_id　　　　total_point ----------------------------- 00356　　　 　11 00001　　　 　 6 00002　　　　　2 よろしくお願いします。
以下のようなuser_idとuser_pwのtableがあります。 |id(ai)|user_id|user_pw|flg| |1|AAA|111|0| |2|BBB|222|0| select id from table where user_id = AAA をされると 1 を返し、 update table set flg = 1 where id = 1　かまたは update table set flg = 1 where user_id = AAA を発行したいと思っています。 ただ、sql 発行元から2個のsqlを出せない事情があり、DB側で対応しなければなりません。 トリガはselectでは使えませんよね？　 最悪、query_logを監視しながらselectが来たら自分でupdateを発行するスクリプト しかないのかと考えています。 アドバイスお願いします。
データベースを用いたWEBサービス（趣味であり、商用でない）を作り始めたのですが、相談相手もいない素人が超初心者向けの本を片手に一人で作っているので、オリジナリティ溢れる珍妙な運用になっていないか相談させていただきたくお願い申し上げます。 以下、私の行っている運用の概略について記します。 レンタルサーバーを借りて、そこにPHPファイルやCSSファイルやHTMLファイルやデータベースを置いています。 私のPCにも同じものを置いています。 ローカルで更新して、問題がなさそうなら、レンタルサーバーの方も更新しています。 レンタルサーバーに置いてあるものは、WEB上で公開するためのものです。 ローカルがテスト用といった感じです。 PHPファイルや、CSSファイルはFileZillaを使ってアップロードしているのですが、データベースの方をどのように更新すれば、効率的かが分かりません。 これまで（といっても最近始めたばかりですが）は、レンタルサーバーの方のテーブルを削除して、ローカルでエクスポートしたSQLファイルを、レンタルサーバーにインポートしていました。 これは流石に非効率すぎだろということは、素人の私でも気が付くので、この度、相談させていただく次第でございます。 なお、レンタルサーバーは無限サーバーというところのものを使っています。 http://mugenserver.jp/ phpMyAdminが使える環境です。 それぞれのphpMyAdminバージョンは以下の通りでございます。 レンタルサーバー：3.4.10.1 ローカル：3.4.5 MySQLのバージョンは確認の仕方がよく分かりませんでした。 必要であれば、調べた後、補足欄に書き込みますのでご指示ください。 データベースについて、どのような運用を行うべきでしょうか？ 素人の私でも可能な現実的な運用をお示しいただければ大変助かります。 素人ですがやる気はありますので、よろしくお願いします。 その他、アドバイスに際して必要な情報があれば、お申し付けください。
教えてください。 DBサーバ(Windows2003)にログインし、コマンドプロンプトで >mysql -u(ユーザ）-p(パスワード) を実行し、mysqlモードに入ってから select * host,user from mysql.user; をしたところ、hostの一覧で"%"というマークが表示されています。 これはhostが特定されていないという意味でしょうか？
3フィールド以上からなる zaikoテーブルに商品情報を登録しています。 このshohinフィールドのshohin ごとにkazu を取りだしたいのですが、 　　SELECT shohin, COUNT(*) AS kazu FROM zaiko GROUP BY shohin;　は +--------+------+ | shohin | kazu | +--------+------+ | A | 1 | | B | 3 | | C | 5 | | D | 7 | +--------+------+ と出ます。 　　SELECT COUNT(*) AS kazu FROM zaiko GROUP BY shohin; もデータが返りますが、A商品だけを取り出そうと 　 SELECT COUNT(*) AS kazu FROM zaiko GROUP BY shohin WHERE shohin='A'; とすると、ERROR 1064 (42000): が出てしまいます。 Aだけを取り出すsql 文はどのように書けばよいでしょうか？
■知りたいこと ブログカテゴリー(親・子) を取り扱う際、普通は「1テーブル」でいくのでしょうか、それとも、親と子の2テーブルを作成するのでしょうか？ ・それぞれのメリットデメリットは？ ・「ケースバイケースによるので一概には言えない？」or「どちらでも同じ？」 ・また、「2テーブル(親子)」に分けることを正規化というのでしょうか？ ■現状 ・1テーブルで運用(parent_idカラム利用) ・子カテゴリー数が多くなると、phpMyAdmin等で目視する際、カテゴリーテーブルから親カテゴリーIDを探しづらくなる(条件で抽出するので、大きな問題ではないですが)
次のような表があるとします。 科目　点数 英語　93 英語　96 英語　88 独語　95 独語　83 仏語　84 仏語　89 たとえば90点以上取った回数を調べたいだけなら、 select 科目,count(科目) as 回数 from テーブル where 点数>=90 group by 科目; とすればよいのですが、 科目、85点以上の回数、90点以上の回数、95点以上の回数 というふうにまとめたいとき、上記SQL文の数字を変えたものをjoinするしかないのでしょうか？ 簡単なやり方があったら教えてください。
以下のエラーが出ました。 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '?') + 1).split('&'); for(var i = 0; i < hashes.length; i++) { hash =' at line 1 ) You～nearまではいつもどおりなので分かるのですが、その後が何やらよく分からないので、見方を教えていただけないでしょうか？ なお、SQL文は以下の通りです。 select カラム名1 from テーブル名 where カラム名2=$i
以下のようなSQLがあるとき、「best」カラムだけ、後で利用する際、「セレクト１」「セレクト２」何れのカラムから(どちらのテーブルから)取得したか知りたいのですが、どうすれば良いでしょうか？ ＜SQL文例＞ SELECT id, tom, best, center, dragon 　FROM ( 　　SELECT m.id, m.tom, m.best1, m.center, u.dragon FROM main m　←セレクト１ 　　　LEFT JOIN usa u ON m.usa_id = u.id 　　UNION ALL 　　SELECT s.red_id, s.red_title, s.best2, s.center, u.dragon FROM sub s　←セレクト２ 　　　LEFT JOIN usa u ON s.usa_id = u.id 　) as PIYO ＜希望＞ 「id, tom, best, center, dragon」ではなく、 「id, tom, best1, center, dragon」＋「id, tom, best2, center, dragon」で取得したい ＜質問＞ ・SQL生成の方法がおかしいのでしょうか？ ・「セレクト１」「セレクト２」を2回実行して、どーにかして足せば良いのでしょうか？ ・そもそもSQL側で足す、という考えが間違っているのでしょうか？ この場合は2回実行して、スクリプト側で処理すべきなのでしょうか？ ＜最終的にやりたいこと＞ ・「main」「sub」テーブルよりLIKE検索を行い、それぞれでヒットした該当レコードを取得したい ※UNIONを利用し、検索結果を両テーブルより取得表示するとこまでは出来たのですが、「main」「sub」何れから取得したか判断出来ないため、そこからリンクが貼れず、再考しています
ｐｈｐＭｙＡｄｍｉｎでデータベースの照合順序を変更したいのですが、危険なのでしょうか？ 色々調べましたが、難しくてよくわかりません。 ワードプレスのプラグイン部分の文字化けを修正するため、 ・プラグインのテーブルの照合順序 ・プラグインのテーブルのカラムの照合順序 ・データベースの照合順序 を「utf8_general_ci」に変更しようとおもうのですが、 合っておりますでしょうか？不要なものはありますか？ データベースについてはバックアップをとる必要があるのでしょうか？ プラグイン自体の過去の登録内容は消えてもＯＫです。 詳しい方、ご意見をいただければと思います。
以下SQL文で、「hoge」「red」をそれぞれ、「h」「r」として、「h.id」「r.red_id」とかって書きたいのですが、 どう修正したら良いのでしょうか？ (コピペしているので、LEFT JOINの後にテーブル名が来ないとき、どうしたら良いか分かりません) SELECT id, century, tom, best, center, dragon 　FROM ( 　　SELECT hoge.id, c.century, hoge.tom, hoge.best, hoge.center, u.dragon FROM hoge　 　　　LEFT JOIN usa u ON hoge.usa_id = u.id 　　　LEFT JOIN century c ON hoge.century_id = c.century_id 　　UNION ALL 　　SELECT red.red_id, c.century, red.red_title, red.best, red.center, u.dragon FROM red 　　　LEFT JOIN usa u ON red.usa_id = u.id 　　　LEFT JOIN century c ON red.century_id = c.century_id 　) as PIYO
はじめまして、SQLもMYSQLも初心者です。　独学で、1，2か月といったところでしょうか MYSQL5.5.を使用しています。 早速ですが質問です。 自己結合のもとになるクエリが複雑？な場合どうすれば負荷の少ないクエリが組めるでしょうか？ 自己結合したいクエリが、相関サブクエリをつかっているためViewが作れないので 素人考えで、もととなるクエリをSQL中に何回も記述してみましたが、 メモリがオーバーフローしてしまいます。 複雑なクエリをスマートに自己結合する方法はないのでしょうか？ それとも、そもそも、最初に自己結合や外部結合でめいいっぱいデータを展開し、それを相関サブクエリ.etcで、漸次、絞り込んでいくほうが、SQLの手段としては正しいのでしょうか？ 他で上記のクエリのかなりの部分を使用するので、再利用できないかと思って組んでみましたが 行き詰まり、色々と自信がなくなってきました、アドバイスをお願いします。 以下やりたいことです 暇だったら見てください。 勉強も兼ね、カレンダーアプリで担当者ごとの抱えているプロジェクトと、忙しさ、割ける時間、効率性 を可視化することを目的としたソフトをつくろうと思っています。そこで、日にちごとに、不特定の時間帯から、時間の重複を許して、複数の時間帯を除した、あまりの時間を求めるクエリを組もうと思い、web上で勉強して、相関サブクエリと、自己結合とHAVING文などを組み合わせれば、実現可能なことがわかりました。そこで、相関図を書いて、実際に作って見たのですが、上記のようになった次第です。ぜひ、皆様のお知恵を拝借したいしだいです。よろしくお願いします。
テストサイトと本番サイト２つのサイトがあります。 それぞれに使用しているファイルはすべて同じものです。 ドメイン名は違いますが、同じサーバにアップされています。 MySQLのデータを読み込んで表示させる作りなのですが、両方とも同じMySQLからデータを読み込んでいます。 MySQLのクライアントのバージョンは5.0.77と書いてありました。 $dsn = "mysql:host=example.com;dbname=test"; $user = "test"; $pas = "aaaaaa"; $db = new PDO($dsn,$user,$pas); $db->exec("SET NAMES utf8"); $db->setAttribute(PDO::ATTR_CASE, PDO::CASE_LOWER); #SQLの生成～実行 $sql = 'SELECT `a`,`b` FROM `xyz`'; $result = $db->query($sql); while($row = $result->fetch(PDO::FETCH_ASSOC)){ $hoge[] = $row; } というふうな感じでデータを拾いだして読み込んでいます。 コミットというのは、よく分かっていないので、使っていません。 （これが原因？） 今まではうまく表示されていたのですが、急に表示されなくなりました。 とりあえず、サイト閉鎖状態を解除したいので、読み込みを正常にしたいのですが、どのようにすれば良いでしょうか。 知識不足でお恥ずかしいのですが、ほんとに困ってます！助けてください！ どうかご教授よろしくお願いいたします。
複数テーブルからLIKE検索を行いたいのですが、うまくいかないので教えてください ■やりたいこと ・一つのキーワードで、MAINテーブル「hoge」カラムと、SUBテーブル「hoge」カラムを検索して、該当したレコードを表示したい ■テーブル構成 ・MAIN … 「id」「main1」「hoge」… ・SUB… 「sub_id」「main_id」「sub1」「hoge」… ・1つの「id」に対して、対応する「sub_id」が複数(「id」1は一つだけ。対応する「sub_id」1は複数あります) ■試したこと1 SELECT a.* , r.* FROM main a LEFT JOIN sub r ON a.id = r.main_id WHERE ( a.hoge LIKE '%キーワード%' OR r.hoge LIKE '%キーワード%' ) とやると、2件ヒットするはずなのに、1レコードしか取得できません(1レコードに「hoge」カラムが2つ入ります) ■試したこと2 SELECT a.* , r.hoge as rhoge FROM main a LEFT JOIN sub r ON a.id = r.main_id WHERE ( a.hoge LIKE '%キーワード%' OR r.hoge LIKE '%キーワード%' ) とやると、2件ヒットするはずなのに、1レコードしか取得できません(1レコードに「hoge」と「rhoge」カラムになります) ■試したこと3 FROMで2箇所指定するのかと思ったのですが、 SELECT a.* , r.* FROM (main a,sub r) LEFT JOIN r ON a.id = r.main_id WHERE ( a.hoge LIKE '%キーワード%' OR r.hoge LIKE '%キーワード%' ) 結果は、#1066 - Not unique table/alias: 'r'になります ■試したこと4 LEFT JOINがいらないのかと思い、削除したら、2件ヒットするはずなのに、たくさんヒットしてしまいます ■質問 欲しいのは、キーワード検索した際、該当カラムにヒットした数だけのレコードなのですが、どうすれば良いのでしょうか？ ■例 ・東京で検索 ・MAINテーブル「hoge」カラム(2レコード)で2ヒット ・SUBテーブル「hoge」カラム(3レコード)で3ヒット ・ヒットした該当5レコードを取得したい
table1、table2、table3というテーブルがあり このそれぞれをidというカラムで並び替えたものを結合するので考えました。 SELECT * FROM `table1` UNION ALL SELECT * FROM `table2` UNION ALL SELECT * FROM `table3` ORDER BY `id` にすると全てを結合したものを並び替えるので SELECT *, '1' AS tbl FROM `table1` UNION ALL SELECT *, '2' AS tbl FROM `table2` UNION ALL SELECT *, '3' AS tbl FROM `table3` ORDER BY `tbl`,`id` という風に書いてみました、結果としてはよさそうですが 方法としては間違ってないでしょうか？ 他にいい方法があればアドバイスをお願いします。
PHPで以下のような構文でデータベースから読み出しています。 $sql = "SELECT * FROM table_name1 WHERE key = '111' "; $result = mysql_query($sql,$con); while($row = mysql_fetch_array($result,MYSQL_ASSOC)) { ～ } このtable_name1はMyISAMでインデックスが２つで主キーidとkeyを設定しています またこの主キーが昇順になっています。 （直接コマンドで同じクエリーをすると昇順で帰って来ます） つまり以下の様な結果が帰って来ます。 +-----+------+------+ | id | key | data | +-----+------+------+ | 1 | 111 | aaa | | 5 | 111 | bbb | | 7 | 111 | ccc | +-----+------+------+ しかし table_name1をMEMORYに変換した場合（ALTER TABLE `table_name1` ENGINE = MEMORY） 同じSQL分で +-----+------+------+ | id | key | data | +-----+------+------+ | 7 | 111 | ccc | | 5 | 111 | bbb | | 1 | 111 | aaa | +-----+------+------+ という結果になってしまいます、直接コマンドで同クエリーをうつと昇順のまま なのにPHPでの結果のみ逆になります、原因が良くわからないのですが 設定か仕様があるのでしょうか？ よろしくお願いします。
AccessとMysqlを用いてデータベースシステムを作成しています。 添付図の左の表から,右の表の品番と枝番が一致するデータを削除する場合(今回はaaaの2と6)は,どのようにSQL文を記述すればよいでしょうか? Do Untilで1行毎に比較して削除する方法では時間がかかり過ぎたため,SQL文で一度で処理できないかと考えたのですが,SQL文をどのように記述すればよいかわかりませんでした... お分かりになられる方がいらっしゃいましたら,ご教授宜しくお願い致します。
MySQL初心者です。よろしくお願いします。 以下のようなテーブルがあったとして、UPDATEでレコード1つだけnumberから特定の数をマイナスしたいのですが、どうもやり方がわかりません。 id | name | number 1 aaa 100 2 bbb 200 3 ccc 300 3 ccc 300 2 bbb 200 例えば、id=2のレコードの中から1つだけ、numberからマイナスするといった処理を行いたい場合、以下のSQL文だとidが2のものすべてから数がマイナスされてしまいます。 UPDATE table SET number = number-50 WHERE id=2; すべてのレコードからマイナスするのではなく、id=2のレコードの中から1つだけマイナスしたいんです。。。 これをid=2の中で1つ目のレコードからだけマイナスする、といったようにうまく1つのレコードからマイナスする方法をご教示いただけるとありがたいです。 つたない文章で恐縮ですが、どうぞよろしくお願いいたします。
Ｍｙｓｑｌを使ってwebアプリ開発を行っています。 ユーザ情報として趣味を最大5件（3件は必須）で入力できるようにしたいのですが、 その場合のデータの持たせ方を以下のように考えていますが問題ないでしょうか。 もっとよい方法などがあればご教示をお願いします。（下記は一部だけ抜粋したテーブル定義です） ■テーブルＡ（ユーザデータ） ・ユーザＩＤ ・ユーザ名 ・趣味ＩＤ１ ・趣味ＩＤ２ ・趣味ＩＤ３ ・趣味ＩＤ４ ・趣味ＩＤ５ ■テーブルＢ（趣味マスタ） ・趣味ＩＤ・・・テーブルＡの趣味ＩＤ１～５と紐づく ・趣味名 ■補足事項 ・ユーザは５つの入力ボックスに自由に入力できる。 ・値が入力されて登録ボタンが押された際に、入力値でテーブルＢを検索し検索がヒットすれば そのＩＤをテーブルＡに登録。検索がヒットしなければテーブルＢにその値を新規登録し、テーブルＡにもそのＩＤを登録。 またこのようなデータ構造にした場合、 データ（ユーザ名、趣味１～５の趣味名）を一覧表示する場合どのようなＳＥＬＥＣＴ文でデータを取得すればよいでしょうか？テーブルＡとテーブルＢをJOINで結合すればよいと思いますが、結合させたいカラムが複数ある場合にどのようなクエリにすればよいのかがいまいちわかりません。 よろしくお願いします。
質問失礼します。 下記のSQL文にて条件に合うものを表示しています。 select table.*, group_concat(table2.title separator '') as title1, table2.non from table2 join table on table.non = table2.non WHERE table.hiduke = '2012-09-21' AND table.genre LIKE '%ポップス%' group by table2.non すると、table.non　はあるが　table2.non　がない場合、表示されなくなります。 table2.nonはなくてもtable.nonを表示させたいのです。 ご教授お願い致します。
4種の複数製品を組み合わせて金額を提示したいのですがうまくいきません 組み合わせテーブル　　　製品テーブル セットno　組み合わせ　種類　　　　　　名前　種類　金額 1　　　　　　1　　　　　　　　 a 　　　　　　　1 　　a 　　100 2　　　　　　2 　　　　　　　　a 　　　　　　　2 　　b 　　260 2　　　　　　3　　　　　　　　 c　　　　　　　 3 　　c 　　244 3　　　　　　4 　　　　　　　　a 　　　　　　　4 　　d 　　300 3 　　　　　 5　　　　　　　　 b　　　　　　　 5 　　a 　　400 3　　　　　　6　　　　　　　　 b　　　　　　　6 　　b 　　 200 3　　　　　　7 　　　　　　　　b 　　　　　　 7 　　b 　　 240 4　　　　　　8 　　　　　　　　a 　　　　　　 8 　　a 　　 333 4　　　　　　9 　　　　　　　　b 　　　　　　 9 　　c 　　 300 4　　　　　　10　　　　　　　　b 　　　　　　10 　　a 　　600 これを結合させてセットnoで纏めて合計で金額をだすと種類すべての合計がでてしまいます。 全てではなく1セットごとの値段を出すようできないでしょうか？ またできれば商品名の組み合わせが分かるようにしたいのですがいい案はないでしょうか？ よろしくお願いします。
■質問1 PHPを使ってMySQLに接続しているのですが、 「AUTO_INCREMENT」指定しているIDの次の値を取得したいのですが、 どうすれば良いでしょうか？ 用途としては、レコードを挿入する際、画像ファイルにレコードID名を付与したパスをつけたいのです。 ＜やりたいこと＞ 1.AUTO_INCREMENT指定しているIDの次の値を取得 2.画像ファイル名に付与 3.レコード挿入 この1を、どうやるか知りたいです ■質問2 「AUTO_INCREMENT」指定はどこに保存されているのでしょうか？ 例えばレコードを削除した後、新たにデータ挿入する場合、 次の「AUTO_INCREMENT」値ではなく、削除した一番若い番号を利用することは可能でしょうか？ ■質問3 質問2に関連しているのですが、DUMPデータを移行した際など、次の「AUTO_INCREMENT」値も新しいDBへ引き継がれるのでしょうか？
テーブルのデータを抽出したいのですけど テーブルに idと対応するpassワードがあったとすると 入力フォームみたいのを作って 認証したいidとpassワードを入力してもらって それをテーブルにあるのか確認したい場合どうしたらいいでしょうか？ 入力フォームはこうなっています <html> <head> <title>ユーザ認証</title> </head> <body> ユーザ認証<br> <form action="ninsyou.php" method="post" name="form1"> ユーザ名： <input name="id" type="text" id="fUserName"> <br> パスワード： <input name="pass" type="password" id="fPassWd"> <input type="submit" name="Submit" value="認証"> <input type="reset" name="Submit2" value="クリア"> </form> </body> </html> わかりにくい質問ですみません。
入力フォームをhtmlに作って それをidとpassを入力して それをmysqlに登録したいのですが うまくできません <html> <head> <meta http-equiv="Content-Type"content="text/html;charset="utf-8"/> <title>登録</title> </head> <body> <form action="touroku.php"method="post"> 登録id :<br /> <input type="text"name="id"size="10"value="" /><br /> パス:<br /> <input type="text"name="pass"size="10"value="" /><br /> <br /> <input type="submit"value="登録する" /> </form> </body> </html> という感じに 入力フォームは作ったのですが それからそれをmysqlにどうやって登録をするのかわかりません 詳しく解説されてわかりやすいサイトなどを教えてください もしくは教えてください
始めたばかりの超初心者です。オープンソース等を利用して phpとmysqlでブラウザ上にデーターベースを作成中ですが my sql のデータ数が多くブラウザの検索待ち時間が気になります。 ３０万件以上のデーターを 検索する時の待ち時間に ちょうどこのOKWaveのロード待ち時間のような 「読み込み中です。」のような画面を作りたいのですが、 javascript になるのでしょうか？ どのよう方法で実装できるのか、また 簡単に実装できそうなオープンソース等あれば教えて下さい。 どうぞよろしくお願いいたします。
MySQLにてCOUNTした値を、更にCOUNTする事を1回のSQLにて実行する事は可能でしょうか？ ※2回のSQL、プログラミングを介する、EXCELで再集計する等でならCOUNTのCOUNTは求められるのですが…1回のSQLでの回答お願いします。 ユーザーIDと課金額のカラムからなる、以下のようなテーブルがあるとします。 buyテーブル user_id,coin 1,100 5,100 10,200 5,200 5,200 17,100 1,100 2,200 23,500 ユーザー毎の課金回数は下記にて求められますが、 SELECT user_id,COUNT(coin) FROM buy GROUP BY id user_id,count(coin) 1,2 2,1 5,3 10,1 17,1 23,1 count(coin)毎の人数というのはどのように求めればいいでしょうか？ いわば下記のような集計結果が理想です。 ※このような結果を1回のSQLにて出力するSQLをズバリ今回の例に沿って知りたいです。 count(coin),count(count(coin)) 1,4 2,1 3,1 ■環境 Apache2 MySQL5 PHP5 ご教授よろしくお願いします。
Mysqlでの日本語文字化け対策がうまくいかなくて困っています。 いくつもの参考ページを検索で探し、実行してみたのですが、どうにもうまくいきません。 insert into tbl values('あああ');のように、cmdに打っている時点では日本語は表示できています。 しかしselectで呼び出すと、'?f?u???'といった表記に化けてしまいます。 phpMyAdminでの表記も同様に化けます。 下記に環境と施した対策を記しますので、原因がわかる方のアドバイスをお待ちしております。 window7 64bit Xampp1.8.0 Apache 2.4.2 MySQL 5.5.25a PHP 5.4.4 phpMyAdmin 3.5.2 参考記事 http://blog.livedoor.jp/ryo511-web/archives/4915 … cmd上でshow variables like "char%"でキャラクタセットを確認したところ character_set_client utf8 character_set_connection utf8 character_set_database utf8 character_set_results utf8 character_set_server utf8 character_set_system utf8 と、表示上は意図したとおり、utf-8になっているようです。
Table t1には t1code｜t1type ------------------ 花子｜1 太郎｜1 一郎｜2 次郎｜2 五郎｜2 Table t2には t2code｜date ----------------- 太郎｜2012-05-30 太郎｜2012-05-30 花子｜2012-05-10 花子｜2012-05-10 次郎｜2012-03-20 五郎｜2012-04-10 一郎｜2012-03-01 と登録されている場合に t1type毎に一番新しいdateをもつt2codeを抽出したいのです。 そこで、 select t2code,max(date) from t1 inner join t2 on t1code = t2code where (t2code,date) in (select t2code,max(date) as d from t2 group by t2code) group by t1type としたところ、 +--------+------------+ | t2code | max(date) | +--------+------------+ | 太郎 | 2012-05-30 | | 次郎 | 2012-04-10 | +--------+------------+ となります。 本来は、次郎→五郎になってほしいのですが、 どこが悪いのでしょうか？ よろしくお願いします。
MySqlには不慣れな者です。 来店table id|text_date |name 1 |20120101010101|山田 2 |20120222001227|鈴木 3 |20120309035932|福田 4 |20120309035932|館山 5 |20120713121211|大沢 6 |20120822120127|矢島 といったテーブルがあるとします。 カラムtext_dateはCHARで、日時データを持っています。 （ちょっと解り辛いサンプルで失敬） SELECT text_date, count(*) FROM 来店table WHERE text_date >= "20120101010101" GROUP BY text_date; とするとid 3・4の同日時のみカウント2として以外はカウント1で出ると思います。 希望ですが、カラムtext_dateの時間部（8・9番目の数字）でカウントを取りたいのですが。 GROUP BY の指定方法でそのような事はできるのでしょうか？ MySqlのリファレンスを色々探し回っているのですが、見つけることができません。 ご助力いただけると助かります。
Windows7 ProfessionalにWindows Virtual PCをインストールし、WindowsXPを動かしています。 Virtual PC上のWindowsXPでMySQL DBを作成し、そのDBをネットワーク上に接続されたWindows PCからODBC経由で アクセスしようとしましたが上手くいきません。 MySQLのODBC/Connectorの設定を、ホストPCであるWindows7マシンにではなくVirtual PCに対して行いたいのですが どのようにすればよいのでしょうか。 (Virtual PCをネットワークに接続するために、Windows7のIPアドレスとは別のプライベートIPアドレスを割当てています。)
提示版に投稿した各ユーザーの ユーザータイプを取得したいのですが分かりません。 以下のテーブルがあります。 「bbsTable」(投稿された提示版のデータを保存するテーブル) フィールド：postUserName, postTitle, postText, postTextIndex, postDate 「userTable」(会員ユーザーのデータを保存するテーブル) フィールド：userId, userName, userType, date 今までは以下の様に提示版の投稿データを「postDate」の降順で取得していました。 select postUserName, postTitle, postText, postDate from bbsTable order by postDate desc; ですが提示版に投稿した会員ユーザーのタイプ(userType)も 一緒に取得する必要が出てきたので select postUserName, postTitle, postText, postDate, '' as postUserType from bbsTable order by postDate desc; (このSQL文をどの様に変化させたらいいのか分かりません) の様に('' as postUserType)で擬似フィールドを作成し、 選択された各レコード中の postUserName(投稿ユーザー名：bbsTable)を元に userType(ユーザータイプ：userTable)をデータとして取得し、 その擬似フィールドの部分から参照して 他の提示版データ(postUserName, postTitle, postText, postDate)と 共に取得するにはどうすればいいのでしょうか？
Visual Studio (C++)で作成したモジュールの使用状況を収集するために、 アプリを起動する度に、サーバに接続し、そのサーバにログを残す という仕組みを作りたいと考えています。 (本屋で物色したのですが結局、該当する本はわかりませんでした) セキュリティや拡張性などを考えると おそらく実現の方法はいろいろあると思われますが、 まずは”動かす”を第一に考えています。 １．アプリからサーバにアクセスするのは、どういった仕組みを利用するのが ２．サーバ側はどのような構成になるのでしょうか。 ３．サーバ側で受け取った情報をDBに書き込むにはどのようにするのか ネットや書籍で調べてみると 　　サーバとDBとの接続は 「TomcatからJDBCを使用してデータベースMySQLにアクセスする」や 　　「PHPからMySQLにアクセスする方法...」 　　等々なんらかの情報があるのですが、 　　アプリからサーバへのアクセスの方法は、 　　自分にはどれがそうなのかわかりませんでした。 　　 　　的外れのことをいっているかもしれませんが、教えていただけますとありがたいです。
＜やりたいこと＞ ・(ブログの)エントリーデータを元に、「categoryテーブル」より、親カテゴリー内容と、子カテゴリー内容を抽出したい ＜テーブル構成＞ ■categoryテーブル ・category_idカラム ・parent_idカラム ・その他色々カラム ＜現状＞ 1.　SELECT * FROM category where category_id = :category_id 2.　1で抽出したデータのparent_idを取り出して、再度、SELECT 　　SELECT * FROM category where category_id = :parent_id ＜質問＞ ・2回SELECTしているのが冗長な気もするのですが、普通はどう書くのでしょうか？ ・もっと良いテーブル構成があれば教えてください ※内容 … ブログの「メイン」「サブ」カテゴリー。1つのメインカテゴリーにつき、サブカテゴリーが複数
開発環境はXamppで、OSはWindowsです。 データベースを使いたいと考えていますが、初心者で非常に困っています。 <?php $dsn = 'mysql:dbname=testdb1; host=127.0.0.1'; $usr = 'ユーザー名'; $passwd = 'パスワード'; try { $db = new PDO($dsn, $usr, $passwd); print '接続に成功しました'; $db = NULL; }catch (PDOException $e) { die("接続エラー:{$e->getMessage()}"); } 上記のファイル、connect.phpを実行しても、 Parse error: syntax error, unexpected T_VARIABLE in C:\xampp\htdocs\connect.php on line 3 と表示されてしまいます。 構文エラーだと思い、自分で出来る限りなおしたのですが解決できません。 どなたかアドバイスよろしくお願いいたします。
var $user_details = array( 'id' => array('type' => 'string', 'null' => false, 'default' => NULL, 'length' => 36, 'key' => 'primary'), 'user_id' => array('type' => 'string', 'null' => false, 'default' => NULL, 'length' => 36), 'position' => array('type' => 'float', 'null' => false, 'default' => '1'), 'field' => array('type' => 'string', 'null' => false, 'default' => NULL, 'key' => 'index'), 'value' => array('type' => 'text', 'null' => true, 'default' => NULL), 'input' => array('type' => 'string', 'null' => false, 'default' => NULL, 'length' => 16), 'data_type' => array('type' => 'string', 'null' => false, 'default' => NULL, 'length' => 16), 'label' => array('type' => 'string', 'null' => false, 'length' => 128), 'created' => array('type' => 'datetime', 'null' => true, 'default' => NULL), 'modified' => array('type' => 'datetime', 'null' => true, 'default' => NULL), 'indexes' => array('PRIMARY' => array('column' => 'id', 'unique' => 1), 'UNIQUE_PROFILE_PROPERTY' => array('column' => array('field', 'user_id'), 'unique' => 1)) ); var $users = array( 'id' => array('type' => 'string', 'null' => false, 'default' => NULL, 'length' => 36, 'key' => 'primary'), 'username' => array('type' => 'string', 'null' => false, 'default' => NULL, 'key' => 'index'), 'slug' => array('type' => 'string', 'null' => false, 'default' => NULL), 'password' => array('type' => 'string', 'null' => true, 'default' => NULL, 'length' => 128), 'password_token' => array('type' => 'string', 'null' => true, 'default' => NULL, 'length' => 128), 'email' => array('type' => 'string', 'null' => true, 'default' => NULL, 'key' => 'index'), 'email_verified' => array('type' => 'boolean', 'null' => true, 'default' => '0'), 'email_token' => array('type' => 'string', 'null' => true, 'default' => NULL), 'email_token_expires' => array('type' => 'datetime', 'null' => true, 'default' => NULL), 'tos' => array('type' => 'boolean', 'null' => true, 'default' => '0'), 'active' => array('type' => 'boolean', 'null' => true, 'default' => '0'), 'last_login' => array('type' => 'datetime', 'null' => true, 'default' => NULL), 'last_action' => array('type' => 'datetime', 'null' => true, 'default' => NULL), 'is_admin' => array('type' => 'boolean', 'null' => true, 'default' => '0'), 'role' => array('type' => 'string', 'null' => true, 'default' => NULL), 'created' => array('type' => 'datetime', 'null' => true, 'default' => NULL), 'modified' => array('type' => 'datetime', 'null' => true, 'default' => NULL), 'indexes' => array('PRIMARY' => array('column' => 'id', 'unique' => 1), 'BY_USERNAME' => array('column' => array('username'), 'unique' => 0), 'BY_EMAIL' => array('column' => array('email'), 'unique' => 0)) ); } というスキーマ定義をしたところ、 user_detailsだけ、 user_details: SQLSTATE[42000]: Syntax error or access violation: 1071 Specified key was too long; max key length is 767 bytes というエラーが出てしまいます。キー長がオーバーしているらしいのですが、具体的にどこをどう修正すれば７６７バイト以下になるのかわかりません。 色々試して見たのですがわかりませんでした。 ご教示頂ければ幸いです。よろしくおねがいいたします。
VARCHAR型のカラムに「改行を含むテキスト」をデフォルト値に設定したいのですが、どうやればできるのでしょうか？
次のmysql文を実行しているのですが、no database selectedと出てしまいます。 データベースのデータはphpmyadminを利用しています（添付画像参照） データベース名をzから始まるサーバー名のようなものを除いたものにしても ダメです。アドバイスいただけませんでしょうか。 （下の分の前後にはサーバーへの接続と切断のリクエストが入り、どちらも 無事接続、切断されています） mysql_select_db("z****_data1"); $re=mysql_query("SELECT * FROM simple_board ORDER BY bang"); echo mysql_error($s); while($kekka=mysql_fetch_array($re)){ print $kekka[0]; print " : "; print $kekka[1]; print " : "; print $kekka[2]; print "<br />"; }
＜前提＞ ■oldテーブル ・idカラム ・createdカラム ・modifiedカラム ・その他色々カラム ■newテーブル ・idカラム ・createdカラム ・modifiedカラム ・その他色々カラム ＜やりたいこと＞ 両テーブルのidが一致するとき、 newテーブルの「created」「modified」カラムの値で、oldテーブルの同カラムを上書きしたい SQL文を教えてください
CentOS6.xのhttpdにphpMyAdminをセットアップし、別マシンにおいてあるMySQLに接続しようとしています。 外部マシンにtcpで接続するため、内部ソケットは使用しないと考えておりますが、アクセスしますと、なぜか#2002 Can't connect to local MySQL server ...というエラーメッセージが出ます。 お心あたりがあれば、ご教授ください。 ちなみに、別マシン上(CentOS5.x)で同様にphpmyadmin-2.11.11.3-2を稼動させておりますが、こちらは問題なく稼動しております。 要は、現在稼動しているphpmyadmin2をDBを含めphpMyAdmin3にマイグレーションしたいと考えているわけです。 (DBは現行稼動のものをバックアップして別マシンに再構築しています) 諸元値(関連あると思われるもの抜粋) OS=CentOS6.3 phpMyAdmin-3.5.2-1(EPELからyum) php-5.3.3-14(CentOS BASEよりyum) php-mysql-5.3.3(同上) mysql-5.1.61-4(同上) mysql-libs-5.1.61-4(同上) mysqlクライアントでは問題なくアクセスが可能です。 ※アクセスしたときのエビデンスは以下 # mysql -u root -h 10.9.1.7 -p Enter password: Welcome to the MySQL monitor. Commands end with ; or \g. Your MySQL connection id is 74 Server version: 5.1.61 Source distribution Copyright (c) 2000, 2011, Oracle and/or its affiliates. All rights reserved. Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. Type 'help;' or '\h' for help. Type '\c' to clear the current input statement. mysql> config.inc.phpには以下のように設定してあります。 /* Authentication type */ $cfg['Servers'][$i]['auth_type'] = 'cookie'; /* Server parameters */ $cfg['Servers'][$i]['host'] = '10.9.1.7'; $cfg['Servers'][$i]['connect_type'] = 'tcp'; $cfg['Servers'][$i]['compress'] = false; /* Select mysql if your server does not have mysqli */ $cfg['Servers'][$i]['extension'] = 'mysqli'; $cfg['Servers'][$i]['AllowNoPassword'] = false; ※ちなみにphpmyadmin2では、hostとextensionが異なるのみ /etc/httpd/conf.d/phpMyAdmin.confの内容は以下 Alias /mysql /usr/share/phpMyAdmin <Directory /mysql> Order deny,allow Deny from all Allow from all </Directory> ※現在はテスト中なのでInetから切断されたネットワーク環境においてあります /etc/my.conf [client] socket=/var/lib/mysql/mysql.sock port=3306 host=10.9.1.7 user=mysql -- この状態で、httpdを起動し、phpmyadminのフォルダをアクセスすると、userとpassword入力画面まで行きます。 そこで、先にmysqlクライアントで接続可能であったユーザとパスワードを指定すると、冒頭のエラーメッセージが表示されるという具合です。 ちなみに、phppgadminもセットアップしておりますが、こちらは良好に動作しております。 よろしくお願いします。
MAMPにてMYSQLを導入しています。 Mac os x snow leopard10.6.8 php5.3.6 mysql5.5.9 apache2.2.21 文字コードを確認すると最初はlatin1となっているため、ネットで調べ対処してみました。 対処した内容としては、以下になります。 (1)/MAMP/db/mysql/ にリネームしたmy.confを置く。 (2)[mysqld]に、character-set-server=utf8とskip-character-set-client-handshakeを追加。 (3)[mysql]に、default-character-set=utf8を追加。 その後再起動し、文字コードを確認してみたところ、以下の２つがどうしてもlatin1のままです。 character_set_database character_set_server 他にも対処してみたのですが、どうしてもこの２つだけがlatin1のままです。 どういった対処をすれば文字化けを解消できますか？ どうが、解消法をご教示戴けないでしょうか。 宜しくお願いします。
DB内データの<a>タグを、全て[url]タグへ変更したいのですが、どうすればよいでしょうか？ ＜経緯＞ ・ブログを移行したのですが、新しいブログでは、<a>タグを全てエスケープするので、該当データを[url]タグへ一括変換して、リンク表示させたい ＜変換したいこと＞ ・対象DB指定カラム(entry)内の、全ての「<a href="○○">△△</a>」を、「[url=○○]△△[/url]」へ変更したい ＜質問＞ ・どうやって、やるのでしょうか？ ・UPDATE文を利用して、正規表現とかでやるのでしょうか？ ・それとも、ＤＵＭＰデータを取得して、秀丸で正規表現とかでやるのでしょうか？ その場合は、どう書けば良いでしょうか？ ＜環境＞ ・MySQL
MAMPにてMYSQLを導入しています。 Mac os x snow leopard10.6.8 php5.3.6 mysql5.5.9 apache2.2.21 文字コードを確認すると最初はlatin1となっているため、ネットで調べ対処してみました。 対処した内容としては、以下になります。 (1)/MAMP/db/mysql/ にリネームしたmy.confを置く。 (2)[mysqld]に、default-character-set=utf8とskip-character-set-client-handshakeを追加。 (3)[mysql]に、default-character-set=utf8を追加。 その後再起動し、文字コードを確認してみたところ、以下の２つがどうしてもlatin1のままです。 character_set_database character_set_server 他にも対処してみたのですが、どうしてもこの２つだけがlatin1のままです。 どういった対処をすれば文字化けを解消できますか？ どうが、解消法をご教示戴けないでしょうか。 宜しくお願いします。
例えばこのようなサイト。 http://www.fimosw.com/ 左上にID（メールアドレス）パスワード その下に新規会員登録とありますが、 この、新規会員登録のシステムを自分で制作して、IDパスワードを入力して 自由にログインできるサイトを作りたいと思ってます。 ちなみに、CMSはWordPressを利用します。 私はhtml・css・phpは理解してますが、データベース(mysql)に 関しては疎く途方にくれてます... どなたか、作り方の概要だけでもいいので教えていただけ ないでしょうか・・・？ または、参考になるような書籍でも.... お願いします(。・ω・。)
PerlとMysqlでWebアプリケーションを構築しています。 その中で銀行口座のような入金・出金・残高・日付・摘要のような項目があります。 実際はお金ではなく、ポイントなので 入ポイント・出ポイント・残高ポイント・摘要です。 （日付・摘要はここでは問題ではありません） そこで本題なのですが、こういったDBを設計する際にフィールドは 入ポイント・出ポイントの２つにして、残高は出力する際に計算するのがいいのか それとも 入ポイント・出ポイント・残高ポイントの3つにして、インサートするさいに 毎回前残高を取得して、計算後インサートするのがいいのでしょうか？ ※ちなみに会員用のシステムなのでその他にIDフィールドなどがあるのはここでは割愛しております。 不明な点や不足情報があればご指摘ください。 恐れ入りますがよろしくお願いいたします。
MySQLの事で質問です。 テーブル１～４を結合してフィールド「comment」を検索 する時にフィールド「postDate」の降順でソートしたい のですがエラーが出ました。 「SQLコマンド」 select text from table1 union all select comment from table2 union all select comment from table3 union all select comment from table4 where match(commentIndex) against("検索ワード" in boolean mode) order by postDate desc; 試しに union all select comment from table2 union all select comment from table3 union all select comment from table4 の部分を削除して実行してみた所、成功しました。 後、order by postDate desc;のみ削除した場合でも成功しました。 エラーの内容はこれです↓↓ Unknown column 'postDate' in 'order clause' フィールド「postDate」は存在します。 (varchar型何ですが、それがいけないと思い date型やdatetime型と変えてみましたがダメでした) 何とかソートしたいのですがどうすればいいのでしょうか？
xamppを自分のPCに入れて、MySqlを起動しようとしましたが、 「Start」を押して「Running」が一瞬アクティブになりますが、すぐに消えます。 対処方法をよろしくお願いします。 ■PCの環境 ・OSはwindowsXP。 ・Skypeはインストールしていない。 ・OSは最近リカバリーしており、日が経っていない。 ■xamppの環境 バージョン1.7.4を使用。 ■現在までに試みた事(結果、改善しませんでした)。 ・コマンドプロンプトで、「netstat -an -o」を実行して確認したが、 他に３３０６のポートを使用している形跡がない。 ・ファイヤーオール及びウイルスソフトを停止。 ・「Windwsファイヤーオール」画面の「例外」で、MySqlを追加。
現在Webアプリを制作しています。 そこで検索機能を作成するにあたり FullTextで全文検索を行う処理を考えています。 Like文を使って検索するより速いらしいのですが、 insert/update文を実行しデータベースにデータを挿入/更新する際 FullTextで全文検索を行う場合だとインデックスを再構築する必要が あるみたいです。 http://melrose.jugem.cc/?eid=323 このインデックスの再構築についてよく分からないのですが、 上記のサイトではインデックスの再構築には REPAIR TABLE [テーブル名] QUICK; を実行とありました。 データの挿入/削除 処理後の検索インデックス修復には innsert 又は update文の直後にREPAIR TABLE [テーブル名] QUICK; を 実行するという事でいいのでしょうか？
　MySQLのFOREIGN KEYについて質問です。 下記のようにitemテーブルを作ってからarrivalhistoryテーブルを作ろうとすると ERROR 1005 (HY000): Can't create table 'xxx_db.arrivalhistory' (errno: 150) というエラーが出てしまいます。 自分でもForeign keyの作り方等調べてはみたのですが、 上手く解決することができません。 どなたかアドバイス下さい。お願いします。 ・親 create table item ( id bigint not null primary key, itemno VARCHAR(50) ) engine=InnoDB; ・子 create table arrivalhistory( id int primary key, itemno varchar(50), arrivaldate date, index(itemno), foreign key(itemno) references item(itemno) on update cascade on delete cascade ) engine=InnoDB;
mySQLでデータベース内の全てのテーブルに対するクエリーに関して質問があります(mySQL 5.5)。 仮に 「ichinensei」というデータベースにテーブル「1_kumi」「2_kumi」「3_kumi」 .....と複数のテーブルがあるとします。 テーブルは全て同じデータ形式で仮に name (char) | weight (int) という名前と体重の情報が登録されているとします。 やりたいことは全てのテーブルに対しweightを検索キーとして該当するレコードのnameをとってくる、という操作です。 weight（体重）が41,42,43,50,51であるレコードの名前を列挙するためには SELECT name FROM (全てのテーブル)　WHERE weight IN (41,42,43,50,51) 上記のようなクエリ文が考えられますが（全てのテーブル）に対する検索を１文で済ます方法が分かりません。 実際の作業ではテーブル数が数十個なのでなるべくunionなどを使ってテーブルの数分クエリ文を書くというのは避けたいと考えています。 このような場合どのようなクエリ文が使えるのでしょうか？
＜前提＞ ・created_at 登録日時カラム … 必ず値がある ・modified 更新日時カラム … nullの場合もある この時、更新日時カラムの値があれば、更新日時カラムを選択、 更新日時カラムがnullなら、登録日時カラムを選択した状態で、 降順表示させたいのですが、どうすれば良いでしょうか？ やりたいのは、こんな感じです ORDER BY 更新日時カラムの値があれば、modified 更新日時カラムがnullなら、created_at DESC
下記のDDL文を出力し実行したところ、ERROR 1064となりました。 どのように修正すればいいでしょうか？ よろしくお願いします。 create table summary_type ( summary_type_id INT not null comment 'summary_type_id' , summary_type_name VARCHAR not null comment 'summary_type_name' , summary_type_order INT not null comment 'summary_type_order' , constraint summary_type_PKC primary key (summary_type_id) ) comment 'summary_type' ;
MySQL5.5を使っています。 日時データを格納するカラムについて ・Insert時、自動的に日時データを取得する ・Update時、日時データを自動更新しない という設定ができる型はありますでしょうか？ Timest_ampだとUpdate時に日時データを自動更新してしまうのでしょうか。 どなたかご存知の方がいらっしゃいましたらお願いいたします。
２４年度春の午後問題で質問があります． $ select * from meisaihyo; +----------------+--------------+-------+ | seisancode | ryoricode | dish | +----------------+--------------+-------+ | 3100186　|　　　　　1 |　　1 | | 3100186　|　　　　　2 |　　1 | | 3100187　|　　　　　1 |　　1 | | 3100187 　|　　　　　2 |　10 | +----------------+--------------+-------+ $ select * from ryorihyo; +--------------+---------------+--------+------+ | ryoricode | ryoriname | price | cal | +--------------+---------------+--------+------+ | 1　　　　　| rice　　　|　100 |　500 | | 2　　　　　| meat　　|　280 |　1000| +--------------+---------------+--------+------+ この２つのテーブルがあり，各料理の枚数多い順に表示するものです． 選択肢から２択まで絞れたんですが，以下の２つの違いがわかりません． 複数のテーブルを結合する場合，列の値を一致させる必要がありますが， table1.hoge = table2.hogeと書こうが，table1.hoge in (select hoge from table2)と書こうが一緒だと思います．なぜなら，inを使うとtable1.hogeと同じ行しか対象にならないと思いからです． 解説をお願いします．．．． (1) $ select ryorihyo.ryoriname, ryorihyo.cal, sum(meisaihyo.dish) as dish from ryorihyo, meisaihyo where ryorihyo.ryoricode=meisaihyo.ryoricode group by ryorihyo.ryoriname order by dish desc; +-------------- +------+------+ | ryoriname | cal | dish | +---------------+------+------+ | meat　　　| 1000| 11 | | rice　　　　| 500 | 2 | +---------------+-------+-----+ (2) $ select ryorihyo.ryoriname, ryorihyo.cal, sum(meisaihyo.dish) as dish from ryorihyo, meisaihyo where ryorihyo.ryoricode in (select meisaihyo.ryoricode from meisaihyo where meisaihyo.dish is not null) group by ryorihyo.ryoriname, ryorihyo.cal order by dish desc; +---------------+------+------+ | ryoriname | cal | dish | +---------------+------+------+ | rice　　　　| 500 | 13 | | meat　　　|1000| 13 | +---------------+-------+-----+
C言語でMySQLを操作することを考えて勉強を始めたばかりなのですが、データベースのフィールドの数を表示するプログラムを作ったところ、エラーが出てしまいます。以下がコードです。 #include<windows.h> #include<stdio.h> #include<mysql.h> int main(int argc, char **argv) { MYSQL *mysql; MYSQL *con; MYSQL_RES *result; mysql = mysql_init(NULL); if(NULL==mysql){ printf( "SQLの初期化に失敗しました．\n" ); exit(1); } const char *sever ="localhost"; const char *user = "root"; const char *password = "*******"; const char *database = "features"; unsigned int portnumber = 0; unsigned int num_fields; con = mysql_real_connect(mysql, sever, user, password, database, portnumber, NULL, 0); if(NULL==con) { printf( "SQLのオープンに失敗しました．\n" ); exit(1); } result = mysql_store_result( mysql ); num_fields = mysql_num_fields( result ); printf("fieldの数は%dです。",num_fields); mysql_close( mysql ); printf( "SQLをクローズしました．\n" ); return 0; } ビルドは正常終了するのですが、 これでF5を押すと、 mysql.exe の 0x5b8a8f04 でハンドルされていない例外が発生しました: 0xC0000005: 場所 0x00000048 を読み込み中にアクセス違反が発生しました とエラーが、Ctrl+F5を押すと、 mysql.exe は動作を停止しました と出る状態です。 試しにmysql.exeを直接起動してみるとやはり、エラーの画面が出ます。 MYSQL_RES *result; unsigned int num_fields; result = mysql_store_result( mysql ); num_fields = mysql_num_fields( result ); printf("fieldの数は%dです。",num_fields); を消せば、正常に終了して、 SQLをクローズしました． と出ます。 環境は、Windows 7 ultimate、OSは64bit 開発環境は、Microsoft Visual C++ 2010 Express です。 MySQLはMicrosoft Visual C++ 2010 Expressで動くように32bit版を入れています。 どこが原因でエラーが起こっているのでしょうか？ よろしくお願いします。
教えてください。 grant all on データベース名.* to ユーザー @外部IPアドレス identified by 'パスワー'；を実行しましたが、本当にこの外部IPアドレスでgrantされているかの確認をしたいのですが、何か確認コマンドはありますでしょうか。この外部IPアドレスが表示されていればOKです。 あと1点質問ですが、mysql>use データベースしてから確認する必要がありますでしょうか。 宜しくお願いします。
Windows2008 Hyper-VゲストOS上にWindows2008 + MySQL5.5にてDB環境を構築しています。 そのMySQL環境にて下記２つのテーブルからviewテーブルを構築しています。 ○テーブル１（1,000行） CREATE TABLE `testdb`.`mst` ( `KBN` char(10) COLLATE cp932_bin NOT NULL, `NM` char(48) COLLATE cp932_bin DEFAULT NULL, `MSTDATE` int(10) DEFAULT NULL, PRIMARY KEY (`KBN`), KEY `idx_bookkbn_spdate` (`DATE`) ) ENGINE=InnoDB DEFAULT CHARSET=cp932 COLLATE=cp932_bin; ○テーブル２（145,000行） CREATE TABLE `testdb`.`dt` ( `KEYID` int(10) NOT NULL, `KBN` char(10) COLLATE cp932_bin NOT NULL, `MEMO` varchar(1024) COLLATE cp932_bin DEFAULT NULL, `SUBC01` char(128) COLLATE cp932_bin DEFAULT NULL, `SUBC02` char(128) COLLATE cp932_bin DEFAULT NULL, `SUBN01` int(10) DEFAULT NULL, `SUBN02` int(10) DEFAULT NULL, PRIMARY KEY (`KEYID`,`KBN`), KEY `idx_dt_keyid` (`KEYID`), ) ENGINE=InnoDB DEFAULT CHARSET=cp932 COLLATE=cp932_bin; ○view CREATE OR REPLACE ALGORITHM=UNDEFINED DEFINER=`test`@`%` SQL SECURITY DEFINER VIEW `viewdtmst` AS select distinct `dt`.`KEYID` AS KEYID, `dt`.`KBN` AS KBN, `dt`.`MEMO` AS MEMO, `dt`.`SUBC01` AS SUBC01, `dt`.`SUBC02` AS SUBC02, `dt`.`SUBN01` AS SUBN01, `dt`.`SUBN02` AS SUBN02, `mst`.`NM` AS NM, `mst`.`MSTDATE` AS MSTDATE, from (`dt` left join `kmst` on((`dt`.`KBN` = `mst`.`KBN`))); ■ここからご相談となります。 上記viewdtmstに対して下記の様なクエリーを実行すると 処理時間が12.5426sとかなり時間がかかり改善したいと考えています。 -------------------------------------------------------------- 検索クエリー -------------------------------------------------------------- SELECT * FROM viewdtmst WHERE KEYID = 10010 ORDER BY KEYID,MSTDATE DESC,KBN; -------------------------------------------------------------- 上記クエリーのexplain結果 -------------------------------------------------------------- id, select_type, table, type, possible_keys, key, key_len, ref, rows, Extra 1, 'PRIMARY', '<derived2>', 'ALL', '', '', '', '', 143906, 'Using where; Using filesort' 2, 'DERIVED', 'dt', 'ALL', '', '', '', '', 150813, 'Using temporary' 2, 'DERIVED', 'mst', 'eq_ref', 'PRIMARY', 'PRIMARY', '20', 'testdb.dt.KBN', 1, 'Distinct' viewを介せず直接下記のクエリーを実行すると 処理時間0.0024sで検索結果がもとまります。 -------------------------------------------------------------- viewを使わないクエリー -------------------------------------------------------------- select distinct `dt`.`KEYID` AS KEYID, `dt`.`KBN` AS KBN, `dt`.`MEMO` AS MEMO, `dt`.`SUBC01` AS SUBC01, `dt`.`SUBC02` AS SUBC02, `dt`.`SUBN01` AS SUBN01, `dt`.`SUBN02` AS SUBN02, `mst`.`NM` AS NM, `mst`.`MSTDATE` AS MSTDATE, from (`dt` left join `kmst` on((`dt`.`KBN` = `mst`.`KBN`))) where KEYID = 10010 order by KEYID,MSTDATE DESC,KBN; -------------------------------------------------------------- viewを使わないクエリーのexplain結果 -------------------------------------------------------------- id, select_type, table, type, possible_keys, key, key_len, ref, rows, Extra 1, 'SIMPLE', 'dt', 'ref', 'PRIMARY,idx_dt_keyid', 'PRIMARY', '4', 'const', 10, 'Using temporary; Using filesort' 1, 'SIMPLE', 'mst', 'eq_ref', 'PRIMARY', 'PRIMARY', '20', 'testdb.dt.KBN', 1, '' なんとかviewを使って処理速度改善を図りたいのですが、ご意見いただけないでしょうか。 よろしくお願いいたします。
こんにちは、データベース初心者です。 ―――― id | tag ―――― 1 | 1002 1 | 1004 1 | 4005 2 | 3001 というような、IDに複数の検索用タグが付いているテーブルに対して、 select TB2.id from tb as TB1 inner join tb as TB2 on TB2.id=TB1.id where TB1.tag=1002 and TB2.tag=1004 limit X,Y; というような、任意の数（例は2個）の指定したtagを全て含むIDを検索するクエリがあります。 （指定が3個の場合は単純にinner join を増やしています） で、指定のtagが1つの場合は一瞬で返されるのですが、 複数指定の場合に何秒もかかるときがありまして、 一瞬で返させるには一体どこを直せばよいのかがわからないのです。 クエリを変えるのか、テーブル構成を変えるのか、マシンを変えなきゃ無理なのか、 こういった場合のセオリーなど、ご指導願いたいのです。 ２つ目の質問として、 order by が無い場合というのは、データに大きな変更が無い期間中は、 同じクエリであれば同じ順序で返ってくると考えて良いのでしょうか？ というのも、上記クエリにorder byを付けたかったのですが、 ソート項目が多数あり断念しまして、ただページング機能は付けたく思いまして。 環境は、ローカルで、winXP、MySQL 5.1、PHP経由で、ブラウザから操作・表示しています。 id数が約1000万、tagは500種ほどあり、1idに対して1～30個ほどで平均8個くらい付いており、 テーブルのレコード数は約8000万となっています。 素人質問で恐縮ですがよろしくお願いします。
空が返ってきます。 空の場合、0になるようにするにはどうしたら良いでしょうか？ UPDATE `table` SET paidy = (select sum(totaly) from `SUBTABLE`) サブテーブルのデータを元にデータを更新するのに利用しています。 ご存知の方何か良い解決方法を教えて下さい。
PHPプログラムを作りながらMySQLクエリをしていました。MySQLのクエリの過程でviewを作っていましたが開発中なので、createはしたもののdropしないというのをくりかえしてました。 プログラムができたので、createしたら終了時にdropして始末できるようにしました。 そこで、開発過程で残ってしまったviewを、phpMyAdminやコマンドで削除しようとしましたが削除できません。 強制的でもいいので削除する方法を教えてください。
in('3eiklあいうeE','3rrEき134','３我Ea','３ｅ','3Ｅ','3　E',・・・) というようにパターンごとに入れるのは無理なので、 正規表現のような使い方をして、あるカラムに含まれる、いくつかの条件を基準にして、 どれか１つでも条件に一致すれば値を取得するようにしたいです。 ・in句の中は１つ以上９以内です。 １つのときはin('5iosde')のように使います。 ・最初の数値は「1～9」を扱いたいです。 ・2番目に数値がくることはありません。 ・使う文字は、数値・英字・日本語文字列・漢字・記号などあらゆる文字です。 ・使う文字は全て全角半角の両方に対応 ・全体的な数値と文字列の割合はバラバラです。 ・空白から始まっても× ・文字数制限は特にありません。 たとえば「3」から始まり「e」を含むとき ○：取得する ×：取得しない 3eiklあいうeE（←○） 4yyte（←3から始まっていない×） 3rrEき134（←○） Eresry（←3から始まっていない×） ３我Ea（←○） 3aaaa（←eがない×） ３ｅ（←○） 5Eお（←3から始まっていない×） 3Ｅ（←○） 3　E（←○） 　3E（←空白から始まっている×）
MySQLとJavaどちらに投稿しようか迷ったのですがこちらに投稿させていただきます。 Javaでファイルのアップロードを扱おうとしています。 ファイルをMySQLにBLOB型として格納したいのですが、JDBCを利用してストリームとして渡してもByte配列にしてしまうようでたしかに100MB以上のファイルをアップロードしようとするとOutOfMemoryになってしまいました。 調べるとストレージエンジンとしてBlob streamingやPBXTを使えば解決するらしいのですがダウンロードしようと思ってSorceForgeなどを見に行ってもファイルが存在しませんでした。 もう、これらは手に入れることはできないんでしょうか？ 手に入れられないとするとどうやって解決するのでしょうか。最新のバージョンだとストリーミングに対応しているとかあるんでしょうか。 回答よろしくおねがいします。
お世話になります。 現在MySQL5.0.45を使用しているのですが、5.5.25にアップグレードしようと思っています。 直接5.0→5.5にアップグレードはできるのでしょうか？ 検索すると一回5.1にアップグレードしてから5.5を入れるみたいなことを書いてるサイトもあったので質問させていただきました。 また、5.0で使用しているデータベースやSQL文等は5.5でも問題なく使えるんでしょうか。 よろしくお願いいたします。
MySQL初心者です。 すみません。教えてください。 mysqldump -u(ユーザー) -p(パスワード） --default-character-set=sjis （データベース名） > (ファイル名).sqlでバックアップを実行すると自動的に１つのsqlファイルに全テーブル分、以下のように生成されているのですが、リストアする時は既存のデータベースを削除（drop database データベース名;) する必要がない。又、権限付与（grant）もする必要が無いということになりますでしょうか？ 逆にdatやdumpファイルとしてバックアップしているものについては、データベースの削除＆権限付与等行う必要があるということになりますでしょうか？ DROP IF EXISTS 'テーブル名' ； CREATE　TABLE 'テーブル名' ( ) INSERT INTO 'テーブル名' VALUES ( )
Hyper-VのゲストOS上に、Windows Server 2008 R2 ＋　MySQL5.1を利用してDBを構築しています。 今回このMySQL環境に、MSSQL2005よりデータを移行したいと思っていますが上手く移行できないデータがありご相談いたします。 ■相談点 SQL Server 2005からの移行データにMAC外字の文字コード（0x8540～0x889E）が保存されおり、 そのデータをMySQL Migration Toolkit（Version1.1.17）を利用し移行すると異なる文字コードへ変換されてしまう。 例：0x8646 → 0x8145 ■MySQL環境 MySQL5.1の設定、および移行先のテーブル作成構文は下記の様にしています。 [mysql] default-character-set=cp932 [mysqld] character-set-server=cp932 テーブルCreateSQL構文 CREATE TABLE `TBL01` ( `ID` int(10) NOT NULL, `NAME` char(40) COLLATE cp932_bin DEFAULT NULL ) ENGINE=InnoDB DEFAULT CHARSET=cp932 COLLATE=cp932_bin' ■MySQL Migration Toolkitの指定 ・MSSQL接続方法 　jdbc:mysql://192.168.1.1:3306/?user=test&password=test&useServerPrepStmts=false&characterEncoding=cp932 ・MySQL接続方法 　jdbc:mysql://192.168.1.2:3306/?user=test&password=test&useServerPrepStmts=false&characterEncoding=cp932 対処方法をご存じの方がいらっしゃいましたら、教えて頂けないでしょうか。 よろしくお願いいたします。
■最終的にやりたいこと ・なるべくコード(SELECT文など)を見ずに、「DB」「テーブル定義者」「ER図」等からテーブル間の関係性を把握したい ■具体例 ・投稿一覧。「userテーブル」「postテーブル」 ・「postテーブル」の「user_id」カラムは、「userテーブル」の「id」カラムに対応 ※簡易な場合はある程度想像は付くのですが、ちょっと複雑な構成になると途端に苦労するので、何か良い方法はないかと思い、質問しました ■質問 ◆「リレーションシップを組む」際、「外部キー制約」はかけるのでしょうか？ 例えば、上記「投稿一覧」DBを構築する際では、どうするのでしょうか？ 1.普通、「外部キー制約」をかける 2.普通、「外部キー制約」をかけない 3.どちらでも良い ◆「外部キー制約」は何の為にかけるのでしょうか？ ・「SELECT＆JOIN」でデータ取得出来るのであれば、「外部キー制約」と「リレーションシップ構築」に関係性はないと思うのですが、そういう認識で合っているでしょうか？ ・参照先データが削除されたら整合性がとれなくなる場合のみかけるものでしょうか？ ◆「リレーションシップを確認」する目的で、「外部キー制約」をかけても良いのでしょうか？ ・「データ削除の整合性」ではなく、「リレーションシップを確認」する目的で外部キー制約」をかけても良いのでしょうか？ ◆「外部キー制約」以外に、「リレーションシップを確認」する方法はあるのでしょうか？ ・コード(SELECT文など)を見ずに、テーブル間の「リレーションシップを確認」する方法としては、「外部キー制約」以外に何かあるのでしょうか？ ・そもそも、「外部キー制約確認」＝「リレーションシップ確認」という考えは正しいのでしょうか？
現在サーバを設定中なのですが、トラブルが解決出来なく、ご教授願えればと思います。 OSはCentOS 5.8 x86_64です。 MySQLは 5.5.25-1.el5.remi x86_64です。 管理ソフトHDE ISP 6.0です。 毎週日曜日の4:02にMySQLが終了します。 最初から設定されているcronを見ると 4:02に毎日のcronが有ります。 週に一度のcronは4:22に設定されているのでMySQLが終了する時間と違います。 MySQLのログには下記の様になっています。１８日に気がついてMySQLを起動しました。 120715 4:02:08 [Note] /usr/libexec/mysqld: Normal shutdown 120715 4:02:08 InnoDB: Starting shutdown... 120715 4:02:09 InnoDB: Shutdown completed; log sequence number 8651178 120715 4:02:09 [Note] /usr/libexec/mysqld: Shutdown complete 120715 04:02:09 mysqld_safe mysqld from pid file /var/run/mysqld/mysqld.pid ended 120718 15:37:02 mysqld_safe Starting mysqld daemon with databases from /var/lib/mysql 4:02のcron(cron.daily)は下記の１０個のファイルがあります。テキストエディタで内容を見てもMySQLを終了させるような文字は見当たりませんでした。 ●certwatch ●hde-webalizer.cron ●makewhatis.cron ●0anacron ●tmpwatch ●rpm ●logrotate ●mlocate.cron ●00webalizer ●zz-hde-logsurfer 何をこれから調べれば良いのかご教授下さい。
MySQL初心者です。教えてください。一度コマンドラインからdumpファイルをインポートしたのですが、再度バックアップで生成されたdumpでインポートし直す場合、drop database(ドロップするデータベースを指定)のような事をしてから、もう1回インポートコマンドを流すようなことをするのでしょうか？Oracleの場合、確かdrop userというようなことをしてからインポートし直したことがあると思うのですが。
カラムに同じデータしか入れない場合（Aカラムの全てのレコードの値は’テストです’しか入ってない） とバラバラに入れる場合、実行後の速度の結果は変わるのでしょうか。 実行速度の検出をするときはデータをバラバラに入れた方がいいでしょうか。 同じデータの場合は、updateで各カラムの値を１つセットで全てのレコードを更新するだけでよいですが、バラバラの場合は、上記の他にレコードを細かく範囲を分けてデータを入れたり、ランダムを使って数字を作ったり…といろいろすることになり面倒です。
・論理名とコメント構文が分からないので、教えてください ■論理名 ・論理名は、内容を分かりやすくするために付ける日本語表記、と思っているのですが、そういう認識で合っているでしょうか？ ・論理名は、どこに付けるのでしょうか？ テーブル定義書などの設計書にだけ表記するのでしょうか？　それとも、SQLの中で「論理名」を付ける場所は決まっているのでしょうか？ ・MySQLのコメント内に、「論理名」を記述しても良いのでしょうか？ ・「論理名」を付与する場合、一般的に、どこに記述するのか？ SQLの中でも記述するのか？ について、教えてください ■コメント ・「コメント構文」と、「COMMENT オプション」では、何が違うのでしょうか？ ・SQLステートメントの構文解析とは、具体的に何を指すのでしょうか？ ・両者の使い分け(どういう時にどちらを用いるのか等)について、教えてください ▽MySQL :: MySQL 5.1 リファレンスマニュアル :: 8.5 コメント構文 　 http://dev.mysql.com/doc/refman/5.1/ja/comments. … ＞記述されたコメント構文はmysqldサーバによるSQLステートメントの構文解析に適用 ▽MySQL :: MySQL 5.1 リファレンスマニュアル :: 12.1.8 CREATE TABLE 構文 　 http://dev.mysql.com/doc/refman/5.1/ja/create-ta … ＞カラムのコメントは、255文字の長さまでで COMMENT オプションで指定できます。コメントは SHOW CREATE TABLE と SHOW FULL COLUMNS ステートメントによって表示
IN('xxx','sss',～)と複数データを指定するのがIN句の使い方ですが、 SELECT * FROM `tabledate` WHERE ～ ff IN('xxx')　～; というように１つだけ指定でも問題はありますか？
php、mysql、google maps apiを使ったウェブサイトを作成したいと考えています。 php→mysqlの段階まではクリアできていますが、mysql→google mapのプロセスで妻づいているため、このカテゴリで質問させていただきました。 phpを使ってmysqlに緯度経度等の情報を格納し、格納された情報google mapに反映（mysql内の各情報についてmap上にマーカーを付ける）させた上で、サイト上に表示させることは可能でしょうか？ phpからmysqlへ情報を格納するところまでは実際に作ってみてできたのですが、mysqlの情報が付加されたgoogle mapをサイトに表示させるところがどうしてもわかりません。 ヒントになるようなサイト等ありましたら教えていただけないでしょうか？
mysqlのMyISAM型でこういったデータの取得は適切なやり方でしょうか。 ・件数は700前後 ・インデックスは主キー以外に使っていません ・トランザクションや外部キーも使っていません SELECT * FROM tabledate WHERE 100<a AND 200>a AND 300<b AND 1000>b AND c='てすと' AND d='テテテ' AND e='testtest' AND f='ttt' AND g IN('123','456','789','122','333','4566','888') AND h IN('666','777') AND ・・・ANDが１０個続く・・・ ORDER BY year_manth_day DESC コマンドプロンプトで実行すると結果は0.12secでした。 自分のパソコンの中だけで動かしているのですが、 この実行時間は充分でしょうか。
A5:SQL Mk-2 でレンサバMySQLへ接続したい ■最終的にやりたいこと ・レンタルサーバMySQLのER図を、今あるDBデータより作成したい ■使う予定のツール ・A5:SQL Mk-2 ・poderosa(別に何でも良いのですが、これしか使ったことがないので) ■環境 ・ローカル … Win7 ・レンタルサーバ … Linux ・SSH接続 … 可 ■分からないこと ・「A5:SQL Mk-2」でレンタルサーバのMySQLへ接続出来るのでしょうか？ ・「SSHトンネル」とは何のことですか？ 「SSH接続」したら、「SSHトンネル」が出来たことになるのでしょうか？ ▽A5:SQL Mk-2 から SSHトンネルを利用して MySQL へ接続する 　 http://www.wind.sannet.ne.jp/m_matsu/developer/a … ・「SSH接続」「SSHトンネル」「SSH ポートフォワーディング」は、何が違うのでしょうか？　「SSH接続」出来る環境にあるからと言って「SSH ポートフォワーディング」出来るとは限らないのでしょうか？ ▽Poderosa を用いた SSH ポートフォワーディング 　 http://www.kuins.kyoto-u.ac.jp/news/50/poderosa. … ・このページの中で名前がなかったのですが、Poderosaでは、sshトンネルは出来ないのでしょうか？ ・また、仮にPoderosa以外を選択する場合、下記ページに掲載されているツールなら、基本的にどれを利用してもsshトンネル出来る、ということなのでしょうか？ ▽そーだいなるらくがき帳: ssh経由でデータベースに繋ぐ方法 　 http://soudai1025.blogspot.jp/2012/07/ssh.html
ID　カラム １　データ ２　データ ３　データ 上記のID２削除して、下記のような順番にするにはどのようにすればよろしいでしょうか？ ID　カラム １　データ ２　データ
自分のウェブサイトに検索フォームを設置したいです。 Mysqlとphpを利用して作ると言うことは解ったのですが、 Mysqlを利用しなくても、外部csvファイルなどをサーバーにアップし、 それを読み込んで一致条件から検索結果を出力することも可能 なのかなと思います。 お伺いしたいのですが、わざわざmysqlを利用するメリットって なんなのでしょうか。 ちなみに作りたい検索フォームは、テキスト＋チェックボックスで、条件の and/orも付けてやる予定です。 CSSやphpを利用した問い合わせフォームなど基本的な事が一通り出来るレベルです 宜しくお願いいたします。
テーブル名：HOGE ID　　DATE1　　　　　DATE2　　　　　FLG ------------------------------------------------------------ 001 　2012-07-01 　2012-07-15　　0 002 　2012-07-10 　2012-07-20　　0 003 　2012-07-01 　2012-08-01　　0 004 　2012-07-05 　2012-07-19　　1 005 　2012-07-20 　2012-07-31　　0 006 　2012-07-07 　2012-07-15　　0 で、本日の日付(2012年7月9日)がDATE1～DATE2に入る、かつFLGが0のレコードだけ抽出したいです。 上記の場合、 ID 001 003 006 この様に抽出したいのですが、宜しくお願い致します。
WordPress上で、例えば自作のCDコレクションのデータベースの検索はできますか？
SELECTで複数テーブルから、全カラム値を取得する際、同名カラムがあったとき、指定テーブルの値を取得したいのですが、どうすれば良いでしょうか？ ◆前提 ・テーブル「r1」 ・テーブル「t1」 ・テーブル「u1」 ※「r1」「u1」には、同名カラム「z2」あり ◆やりたいこと ・条件一致する全てのデータを取得したい ・但し、「z2」カラムの値は、「r1」テーブルの値を取得したい ◆現状 $sql="SELECT * FROM (`r1`) JOIN `t1` JOIN `u1` ON `r1`.`tid` = `t1`.`tid` And`r1`.`uid` = `u1`.`uid`"; ◆疑問 3つのテーブルから条件一致するデータを全て取得しているのですが、 「r1テーブル」「u1テーブル」に同じカラム名(z2)があるためか、 取得結果のz2内容が、「u1テーブル」の「z2カラム」値となっています(多分…)。 この時、「r1テーブル」の「z2カラム」を取得するには、どうすれば良いでしょうか？ (「r1テーブル」の「z2カラム」だけを単独で取得したいわけではなく、「SELECT * 」結果した際の「z2カラム」の値を「r1テーブル」のものにしたいです)
検索サイトなどでカタカナで[スーパーカー]と入力し検索すると、英語表記の[Super Car]が検索結果の一部に表示されます。これDBで実現するにはどうすればよいのでしょうか?
テキストを参考にMySQL5.5の勉強をしているのですが、 テキスト通りに操作してテーブルを作ろうとしたところで次のエラーが出てしまいます。 「ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 12」 操作の手順は全てテキスト通りで、MySQLターミナルに 「CREATE DATABASE aliendatabase;」 と入力してデータベースを作り、 「USE aliendatabase;」 でデータベースを選択したまではいいんですが、 「CREATE TABLE aliens_abduction ( last_name VARCHAR(30), first_name VARCHAR(30), when_it_happened VARCHAR(30), how_long VARCHAR(30), how_many VARCHAR(30), alien_description VARCHAR(100), what_they_did VARCHAR(100), fang_spotted VARCHAR(10), other VARCHAR(100), email VARCHAR(50), );」 でテーブルを作ろうとしたところで先ほどのエラーが出ます。 原因は何なんでしょうか？ このテキストはMySQL5.5が出る前の2010年3月に出版されたものなのですが、 それが原因でしょうか？ また、2010年3月に出版されたテキストでMySQL5.5を学ぶのは難しいでしょうか？
こんにちは group_concatを複数列に設定すると、グルーピングした結果が1行に繰り返し表示されてしまいます。 どのように解決すればよろしいのでしょうか？ 例)カラムCOL1が主キーのテーブル MAIN_TABLE ----------- COL1| AAAA| SUB_TABLE1 ----------- COL1|VALUE AAAA|111111 AAAA|222222 SUB_TABLE2 ----------- COL1|VALUE AAAA|xxxxxxx AAAA|yyyyyy 上記のテーブルを下記のSQLで連結 SELECT M..COL1 ,group_concat(S1.VALUE,'/') AS GS1 ,group_concat(S2.VALUE,'/') AS GS2 FROM MAIN_TABLE AS M LEFT OUTER JOIN SUB_TABLE1 AS S1 ON M.COL1=S1.COL1 LEFT OUTER JOIN SUB_TABLE2 AS S2 ON M.COL1=S2.COL1 GROUP BY M.COL1 抽出結果が COL1|GS1 | GS2 ------------------------------------------------------------- AAAA|111111/222222/111111/222222|xxxxxxx/yyyyyy/xxxxxxx/yyyyyy と表示されてしまいます。カラムGS1とCS2に表示されているグループの繰り返しを削除し、 抽出結果を COL1|GS1 | GS2 --------------------------------- AAAA|111111/222222|xxxxxxx/yyyyyy にするにはどうすればよいのでしょうか？
userテーブルを追加(AUTOINCREMENT)していき、IDが1～10までできたとします。 その後5人削除して、再度1人を追加するとIDが11から追加されると思います。 空いた番号5～10を利用するのは適切でしょうか？ また、利用するにはどのようにしたらAUTOINCREMENTされますでしょうか？ ※ID番号を隙間なく、埋めていきたい（利用したい）と考えております。
MySQLを利用出来るレンタルサーバ借りる検討をしています。 機能を確認すると、MySQLの設置可能数にコースで制限があります。 希望としては、WordPress、Movable Type Open Source、EC-CUBE 等設置して動作確認等色々学びたいと思っています。 上記場合、MySQLを3個設置する必要があるのでしょうか。 もしくは、MySQLの設置は１個でも、テーブルを分ける事で、複数サービスを動かす事が出来るのでしょうか。 イメージが出来ない為、アドバイスを頂ければと思います。
mysqlの5.0.51aを使っています。 Ａテーブル（MyIsam型） １フィールド、２フィールド、３フィールド、４フィールド、５フィールド Ｂテーブル（MyIsam型） ６フィールド、７フィールド、８フィールド、９フィールド、１０フィールド ↓↓↓↓↓↓ Ａテーブルの２フィールドと４フィールドをＢテーブルに移動し、 Ｂテーブルの１０フィールドをＡテーブルに移動する。 ↓↓↓↓↓↓ Ａテーブル １フィールド、３フィールド、５フィールド、１０フィールド Ｂテーブル ６フィールド、４フィールド、７フィールド、８フィールド、９フィールド、２フィールド このように他のテーブルにフィールドを移動する方法はありませんか？
素人質問で申し訳ありません。 複数条件で、視認性を上げるためにINを使ったりしますが INはOR検索ですよね、このような感じのAND条件を書く方法はないでしょうか？ field=1 AND field=2 AND field=3 ↓ ○○ (1,2,3) のように書きたいのです。 お願いします。
MySQL初心者です。 ぐぐって見たのですが、良く分からなかったので質問します。 フィールドが最大5桁の数字で構成された社員IDナンバーの場合、データ型は int（5）、varchar(5)、char(5)、numeric(5) のどれになるのでしょうか？numericで試したところ、テーブルを作成すると社員IDのデータ型がdecimal(5,0)になったので、おそらくそれは無いと思うのですが。 回答、お願いします。
以下の条件 カラム「C1」が主キーのテーブルがAとB↓ テーブルA C1| --- AA| テーブルB C1|C2| -----| AA|11| AA|22| AA|33| とあった場合に、抽出結果を C1|C2 | ---------| AA|112233| にするためにはどのようなSQLを組めばいいのでしょうか？
フィールドがいくつかあるテーブルがあります。 主キーが78532456から始まり、1ずつ増加します。 これを1万行追加したいです。 MYISAMでやっています。 どのようにすれば、重複な値を出さずに追加できますか。
mysql> delimiter $$ mysql> create trigger trigger_update after update on user for each row -> begin -> update address set name = new.name where name = old.name; -> end; -> $$ mysql> delimiter ; こちらをphpmyadminでどのようにしたら使うことができますか。
データが重複しないSQL文の書き方を教えてください。 下記のような2つのテーブルがあり、「管理番号」でOnして「使用数」をJoinさせ、かつ重複しないようにSQLを作成したいのですが、MySQLで可能でしょうか？ ※0002に関しては、テーブル２の方がデータ数が多いため、Join後は2行になって「使用数」は重複せず、「数」の部分には０が入ればベストです 【テーブル１】 日付　　　　品番　　管理番号　数 2012/6/12A987　0001500 2012/6/14A987　0001300 2012/6/16A987　0001400 2012/6/18A987　0001800 2012/6/12A987　0002750 2012/6/12A987　0003540 2012/6/14A987　0003740 2012/6/16A987　0003840 2012/6/18A987　0003240 2012/6/20A987　0003640 【テーブル２】 日付　　　　品番　　管理番号　使用数 2012/7/10A987　0001160 2012/7/11A987　0001260 2012/7/10A987　0002220 2012/7/12A987　0002320 2012/7/20A987　0003530 2012/7/22A987　0003430 2012/7/24A987　0003830 【テーブルJoin】 日付　　　　品番　　管理番号　数　使用数 2012/6/12A987　0001500160 2012/6/14A987　0001300260 2012/6/16A987　00014000 2012/6/18A987　00018000 2012/6/12A987　0002750220 2012/6/12A987　00020320 2012/6/12A987　0003540530 2012/6/14A987　0003740430 2012/6/16A987　0003840830 2012/6/18A987　00032400 2012/6/20A987　00036400
phpmyadmin 文字化けを開きテーブルを見ると日本語が化けてしまいます。 php のプログラムからは読み書き、表記は正しくできます。 いろいろ調べ以下をやったのですがだめでした。 「MySQLの設定」 # vi /etc/my.cnf [mysqld] datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock user=mysql old_passwords=1 default-character-set = utf8 character-set-server = utf8 collation-server = utf8_general_ci init-connect = SET NAMES utf8 #skip-character-set-client-handshake ※最終的にコメントアウト [mysql] default-character-set = utf8 [mysqldump] default-character-set = utf8 MySQLをリスタートする。 # /etc/rc.d/init.d/mysqld restart 「phpMyadminの設定」 # vi /var/www/phpmyadmin/config.inc.php $cfg['DefaultLang'] = 'utf-8'; $cfg['DefaultConnectionCollation'] = 'utf8_general_ci'; $cfg['FilterLanguages'] = ''; $cfg['DefaultCharset'] = 'utf-8'; $cfg['AllowAnywhereRecoding'] = TRUE; ａｐａｃｈｅ再起動 何か足りない点はありますでしょうか？ 環境は以下です。 phpMyAdmin •バージョン情報: 3.5.1 (最新版) •サーバ: Localhost via UNIX socket •ソフトウェア: MySQL •ソフトウェアバージョン: 5.1.61 - Source distribution •プロトコルバージョン: 10 •ユーザ: root@localhost •サーバの文字セット: UTF-8 Unicode (utf8)
バックアップする方法は何がありますでしょうか？
DELETE tbl1,tbl2,tbl3 FROM tbl1,tbl2,tbl3; DROP TABLE tbl1,tbl2,tbl3 FROM tbl1,tbl2,tbl3; 以外で簡単に複数あるテーブルを削除する方法ってありますでしょうか？
首記、InnoDBであれば1000、MyISAMであれば4096という仕様かと思いますが、CREATE TABLEを実行するとカラム数1500くらいから #1117 Too many columns のエラーが出てしまい、カラム数の多いテーブル追加ができない状況です。 こちら、事象や考えられる原因、対処方法などご存じの方がいれば教示いただけますか。 またVARCHARの64K制限があるため多くのカラムはTEXTにしています。
同一テーブル内のデータを参照してのUPDATEを行いたいです。 データは以下のとおりです。 ID1，ID2，Value １，１，在校生 １，２，10期生 ２，１，在校生 ２，２，11期生 ３，１，在校生 ３，２，12期生 そして、UPDATEしたいデータは ID１が同一で、 ID2が２でValueが「10期生」の場合に ID1が１のValueに「卒業生」と入れたいのです。 この場合に書くべきSQLはどう書けばいいでしょうか？
CENTOS5.6でMYSQL5.5.22を入れて使用しています。 テスト用プログラムを作っていて、MSYQLへのデータ挿入が止まらなかったためMSYQLをリスタートしました。 すると、起動後おそらく接続できないとのメッセージが出ています。 postfixをMysqlで使用して使っているため、メールができなくて困っています。 下記エラーメッセージがmysqlのログにありました。 120626 14:15:57 [Warning] Unknown character set: 'utf8a' 120626 14:15:57 [Warning] Aborted connection 131 to db: 'postfix用のDB名' user: 'postfix用のユーザー名' host: 'localhost' (init_connect command failed) 120626 14:15:57 [Warning] Unknown character set: 'utf8a' 120626 14:15:57 [Warning] Aborted connection 132 to db:'postfix用のDB名' user: 'postfix用のユーザー名' host: 'localhost' (init_connect command failed) 120626 14:15:57 [Warning] Unknown character set: 'utf8a' 120626 14:16:58 [Warning] Aborted connection 133 to db: 'postfix用のDB名' user: 'postfix用のユーザー名' host: 'localhost' (init_connect command failed) 120626 14:16:58 [Warning] Unknown character set: 'utf8a' 120626 14:16:58 [Warning] Aborted connection 134 to db: 'postfix用のDB名' user: 'postfix用のユーザー名' host: 'localhost' (init_connect command failed) 120626 14:16:58 [Warning] Unknown character set: 'utf8a' 120626 14:16:58 [Warning] Aborted connection 135 to db: 'postfix用のDB名' user: 'postfix用のユーザー名' host: 'localhost' (init_connect command failed) 120626 14:16:58 [Warning] Unknown character set: 'utf8a' Aborted connection の部分を色々調べたのですが、情報が少なく解決策がわかりませんでした。 Mysqlの再起動やサーバー自体の再起動を行ったのですが解決できませんでした。 何かヒントになるような事がありましたら、教えていただけないでしょうか？ 宜しくお願いします。
http://hoge.jp/data.php?id=7203をクーロンで叩くと、 その時間の株価情報を拾ってきて、WEB上に「7203,トヨタ,3080」 と表示される仕組みを作りました。(株価番号,社名,株価) この結果をmySQLのテーブルに継続的にインサートすることを考えました。 私が考えた方法は下記の通りなのですが、<?php ?> の中に<?php ?>が 含まれる形になるためか下記の方法ではインサートできません。 どのようにすればインサート出来るかご教授頂けませんでしょうか? 尚、「7203」「トヨタ」「3080」を別々に取得することはできず 「7203,トヨタ,3080」のようにまとまった形でしか取得できません。 宜しくお願い致します。 <?php $con = mysql_connect("localhost","root","password"); if (!$con) { die('Could not connect: ' . mysql_error()); } mysql_select_db("db", $con); mysql_query(" INSERT INTO table (id,company,stock_price) values (<?php echo file_get_contents('http://hoge.jp/data.php?id=7203'); ?>) "); $close_flag = mysql_close($con); ?>
MySQLで複数のデータベースを稼働していますが、サーバーの物理メモリ量が不足しているため現在使用していないデータベースをオフラインにしたいと思います。 削除はしたくないので SQL Server でいうところの「デタッチ」をしたいのですが、方法をご存じの方がいらっしゃいましたら教えて頂けないでしょうか？ 宜しくお願い致します。
PHPからmysqlのテーブルを開こうとした際に Fatal error: Call to undefined function mysql_connect() という一文が出ました。 php.iniのextension_dirのパスは一字一句間違っておりませんし、 extension=mysql.so extension=mysqli.so の二文も追加しました。また、その二つのファイルがあることも確認済みです。 また、phpファイルの構文は以下のとおりになっています。 $link = mysql_connect('ローカルホスト', 'ユーザー名', 'パスワード'); if (!$link) { die('接続失敗です。'.mysql_error()); } print('<p>接続に成功しました。</p>'); こちらもいろいろ調べまして、php_mysql.soとphp_mysql.soがないためではないかなどとかんぐっておりますが、そういった記述は私が調べた限りにおいては見かけませんでした。 php_mysql.soとphp_mysql.soというファイルはなくても、mysql.soとmysqli.soというファイルがあれば動くのでしょうか？ 仮にphp_mysql.soとphp_mysql.soというファイルがないと動かない場合、何をインストールすればよいのでしょうか？ ご回答よろしくお願いします。 また、PHPとMySQLはソースファイルを/usr/ports/distfilesディレクトリにコピーした上でポートからmake、make　installしました。 マシンスペック OS…FreeBSD6.4 Apache…1.3.14 PHP…5.2.8 MySQL…5.0.92 都合上、バージョンを他のものに変更することはできません。 追記してくれということがありましたらよろしくお願いします。
パスワードを暗号化するにはphp関数などでハッシュ化させてからINSERTするしかないのでしょうか？ MYSQL自体に現在INSERTされている文字列をハッシュ化させる方法はないでしょうか？
テスト用のテーブルを作りたいと思っています。しかし、主キーの部分が実際とはかけ離れた状態になってしまいます。 フィールド数が複数あり、同じ値でも構わないので1万件分のレコードを追加したいです。 やり方としては、 ＜１＞主キーのフィールド以外の全部のフィールドを作ってデータを入れます。 ＜２＞そしてから、INSERT INTO `aaa` SELECT * FROM `aaa`を1万件超えるまで繰り返し実行。 ＜３＞主キーのフィールドをauto_increment指定して追加します。 ＜４＞1万を超えるフィールドを削除するためにDELETE FROM `aaa` WHERE id>10000を実行 ※実際には主キーにauto_incrementを入れません。 ※実際には主キーのデータは数千万～億単位(89234521や000455839)の数字（型はBIGINT）で、増加の仕方はまちまちです。 auto_incrementを使わず、数千万単位の数字で、増加の仕方もまちまちな主キーのデータを追加する方法はないでしょうか。
WordPressのデータベースでテーブル2つを結合して以下の情報を取得しようとしています メール(wp_users.user_email)|名前(wp_usermeta.meta_value)|登録日時(wp_users.user_registered ) 123@a.com,山田,2012-06-17 12:33:44 456@b.jp,田中,2012-06-21 07:26:54 789@c.ne.jp,\N,2009-08-11 12:19:00 1234@d.ne.jp,\N,2009-08-11 12:19:00 321@x.ne.jp,\N,2009-08-11 12:19:00 ・ユーザーはwp_usersテーブルにeメール情報(user_email)を必ず持ている ・ユーザーの名前はwp_usermetaテーブルのwp_usermeta.meta_keyがuser_nameなレコードに保存されているが、ユーザーによってあるものとないものがある。無い場合はNULLにする。 テーブル構造は添付した画像に記載されています。 ■ユーザ数 mysql> SELECT COUNT(*) FROM wp_users; 18290 まずwp_usersとwp_usermetaをLEFT JOINしてmeta_key = 'user_name'なレコードを取得しようとしましたが、user_nameを持っているユーザーのみしか取得できませんでした。 ■user_nameを持っていないユーザーが取得できない SELECT u.user_email, m.meta_value FROM wp_users AS u LEFT JOIN wp_usermeta AS m ON u.ID = m.user_id WHERE m.meta_key = 'user_name'\G 2075 rows in set (0.00 sec) 次にサブクエリをJOINしました。結果は正しいものを取得できたのですが、実行時間が40秒以上かかってしまい実用性がありません。 ■欲しい結果（速度が遅い） SELECT u.user_email, a.meta_key, a.meta_value, u.user_registered FROM wp_users AS u LEFT JOIN (select * from wp_usermeta where meta_key = 'user_name') as a ON u.ID = a.user_id; 18290 rows in set (45.45 sec) この結果を取得できる、正しいSQLを教えてください。よろしくお願いします。
恐れ入ります。 MySQLで、 perlを使ってfrorm送信してデータを保存する際に、 フォーム上にコードを入力すると、 そのコードに付随したその他情報が、いくつかのフォーム上に現れるようにしたいのですが、方法はありますか？ 04343 を入力 ↓ MySQL上の、04343番に紐づいたデータをその他input フィールドに表示 ↓ 送信 よろしくお願いします。
テーブル名：HOGE ID　　USER --------------- 001 　A 002 　C 003 　A 004 　B 005 　A 006 　C 007　 A 008　 C 009　 D 010　 D で、下記のような結果が出したいです。 A　４ C　３ D　２ B　１ 件数の多い順に並べたいです。 宜しくお願い致します。
phpMyAdminにてテーブルが見えません。 SQLファイルをインポートしたのですが、テーブルが見えません。 コマンドライン上から show tables とやると見えます。 なぜでしょうか？？ お詳しい方、ご教授願えませんか？
何か方法があれば教えて頂きたのです。 ＳＱＬで一致したデータの項目同同士を繋げることができるかどうか。 具体的には以下のような。 ＩＤ　　　名前 ------------ A1 SQL A1 My A2 Server のような結果が出るようなＳＱＬ文を作ったとして ＩＤ　　　名前 ------------ A1 SQL,My A2 Server みたいな同じＩＤの名前を例のようなカンマとかスラッシュ 等を間に入れてつなげていくなんてことできますか？ 実際にはＳＱＬ文で出たデータを各配列にそれぞれデータに入れて使う のでＳＱＬ文の中で仮に出来なくても結果に対してそのようにつなげることが可能かどうか。
MySQLでインポートするときに次のようなエラーが出ました。 　MySQLのメッセージ: 　#1449 - The user specified as a definer ('XXXX'@'%') does not exist 　（XXXXはデータベース名です） sqlファイルをアップロードしてインポートする形をとっています。 エラーの意味や、どうやったら解決できるか、ご存じの方いましたら ご教授願えますでしょうか？ よろしくお願いいたします。
| Field　　| Type | Null | Key | Default | Extra | +-----------------+--------------+------+-----+---------+----------------+ | page_id　| int(10) | NO | PRI | NULL | auto_increment | | site　　　| varchar(255) | YES | MUL | NULL | | ... ... ... このようなテーブルがあり、以下の様なSELECT文を発行してもEmptyとなってしまいます。 > SELECT `page_id` FROM `table` WHERE `site` = 'hoge'; 自分なりに色々と調べてみたところ、 > UPDATE `table` SET `site` = 'fuga' WHERE `page_id` = 1; > SELECT `page_id` FROM `table` WHERE `site` = 'fuga'; とするとちゃんと1件返ってきます。 ですが、また > UPDATE `table` SET `site` = 'hoge' WHERE `page_id` = 1; > SELECT `page_id` FROM `table` WHERE `site` = 'hoge'; とするとEmptyとなってしまいます。 どうやら、INSERTしたレコードをWHERE `site` = 'hoge'するとEmptyとなるような気がします。 何度も試したので、単純に`site` = 'hoge'の文字列自体が間違っている、などのことは無いはずです。 以下の点も合わせて、どのような原因が考えられるでしょうか。 ・レコードのINSERTは、クローラーによって行われていています。 ・他のフィールドは通常通りSELECTすることができます。 ・ストレージエンジンはmroongaです。 どなたか解決策がわかる方いらっしゃいましたら、ご回答頂ければ幸いです。 宜しくお願い致します。
あるカラムに以下のデータが入っています。 { "AAA" : [ { "id" : 1, "age" : 100, }, ], "BBB" : { "id" : 2, "age" : 200, } } ＢＢＢのageを値を取り出すにはどうすればよろしいでしょうか？
$device = 'a'; $Field = $device.'_type'; $sql = 'select "'.$Field.'" from table where member_id = "'.$id.'"'; $res = mysql_query($sql); $row = mysql_fetch_assoc($res); if ($row){ echo $row[$Field]; } $row[$Field]をechoで表示すると『a_type』と表示され、中身が表示されません。 フィールド名を変数ではなくa_typeと直接入力すると正常な結果が表示されます。 ちなみにtableにはa_type、b_type、c_typeテーブルが存在します。 ドコモからのアクセスはa_type、auからはb_typeと、ユーザーエージェントによって分けています。 フィールド名を変数で指定して値を取得するには、どのようにすればよいでしょうか？ 宜しくお願いいたします。
列１、列２ ２、name 　１、name インサート後に上記のようになっています。 列１を１、２の順番に自動にする方法はなにかありますでしょうか？
SELECT * FROM database WHERE col001=32 AND col002=223 ORDER BY id; 結果は0.5秒 ローカルPCにmysqlサーバをインストールし、ローカル内だけで使用しています。 そのうち共有のレンタルサーバーを借りようと考えています。 ローカル内だけの実行はネットの通信速度は無関係ですが、 レンタルサーバーで実行する場合は通信速度が関係してくると思います。 クエリの実行速度は通信速度に影響し、 上記の結果速度が、例えば0.5秒から1.7秒まで遅くなる。 といったようなことは起きませんか？
初歩の初歩の質問で申し訳ありません。ですが非常に困惑しています。 留学先の学校の夏期講習で、ＳＱＬのクラスをとることになったのですが、一体どんな方法（何を使って）で記述?を書いていけばよいのか分かりません。 過去ＶＢとHTML/CSSのクラスをとりましたが、VBならVS2010を、HTMLならメモ帳などを使って記述していくことを教科書にも書いてありましたし、シラバスでも書いてありましたので問題ありませんでした。しかしSQLの場合何を使えばいいのかさっぱりわかりません。 ググっても、SQLの講座的なものは行き成りSELECTやFROMなどのコード文の説明を書いており、開発環境のことには触れてなかったりで・・。使う予定の教科書にも何もそれっぽいものは書いて無いし（まだイントロ部分と1章を流しで読んだだけですが）、 開講は現地時間で6/18からで、まだ学校のポータルサイトの履修コースのところが開いておらず、シラバスはまだ見れません。おそらく当日になれば見れると思うのですが・・。簡単なクラス概要ならわかります。こんな感じです。（英語で申し訳ありません。変に訳すよりはと思い、とりあえず原文載せてみました。） CSDB 10 Introduction to SQL Intended for individuals who want to learn how to search for and manipulate data in a database, create tables and indexes, handle security, control transaction processing, and learn the basics of how to design a database. MySQLやSQL Serverがあるみたい(他にもある・・？)ですが、そのいずれかを使うのでしょうか？何だかよく分かりません。 言語のハンデや頭の回転の遅さがある分いつも早め早めの行動を心がけているので、開講前には準備万端にしておきたかったのですが。。 どなたか教えてください。
MyISAMのメリット・デメリットは http://d.hatena.ne.jp/yutakikuchi/20110131/12964 … を参照にしました。 MYSQL5でMyISAMを使うべきか迷っています。 共有のレンタルサーバーを使っています。 用途は、 [1]PHPで接続してDBから絞込・並べ替えたデータを抽出してWEBページに反映させる。 [2]テーブルは５～１０個、フィールド数は合計で100以内、レコード数は1000程度 [3]データの追加と更新はphpmyadminを使用。関わるのは1クライアントのみ。 MyISAMのデメリットは、 ・更新系処理が重い →WEBページから更新させるような機能もなく、1クライアントのみなので問題ないと思います。 ・トランザクションが使えない →全ての作業で一貫して正常に終了しなかった場合にエラーにする機能 →この機能が使えないと、phpmyadminでDBを更新したときにクライアントの入力は正確でも →プログラム側のミスで誤った情報が格納される、なんてことも起こるのでしょうか。 ・テーブルロックをかけるので、複数のクライアントからの同時更新でロックが発生する。 →更新を複数のクライアントでやる用途に変更した場合に、どんなエラーが発生するのか不安。 →同じテーブルを1クライアントしか更新できず、 →その間に他のクライアントが更新することはできない。 →更新中のクライアントの作業が終了することでロックが解除されるため、 →ロック解除後に他のクライアントが更新できるようになる →という機能でしょうか。 ・外部KEY制約を使うことが出来ない。 →便利そうな機能ですが、更新時に注意すればよいので使わないと思います。 ・リカバリが面倒。 →このデメリットが一番心配です。 →MYSQLがクラッシュするとデータが消え、手動で復旧する必要がある。 →phpmyadminにエクスポートでバックアップファイルを作る機能がありますが、 →その機能を使い定期的にバックアップファイルを作り、 →クラッシュ後にそのバックアップファイルをphpmyadminでインポート。 →これでリカバリは万事解決するのでしょうか。
全てのカラムを対象にソートや絞り込みをする、また、テーブルを分割する必要がない場合、 全てのカラムにインデックスをつけるしかないと考えていましたが、 http://www28.atwiki.jp/lucier/pages/55.html 「MySQLでは1000件以下のデータの場合はインデックスを作成しないほうが 速い」 1000フィールドならカラムの数に関係なくインデックス不要で カラムの数が10の場合と、 カラムの数が50の場合 それぞれ負荷はかわらないということでしょうか。
初心者です。 いろいろ検索して改善していったつもりですが、なぜ動かないのかどうしてもわからないところがあったので質問させていただいてます。 /* サーバーへの接続 */ $link=mysql_connect($server,$user,$passwd); /* データベース内のテーブルの名前を$tablesに配列で格納 */ $STS = "SHOW TABLE STATUS"; $mytables = mysql_query($STS); while($r = mysql_fetch_array($mytables, MYSQL_ASSOC)){ $tables[] = ($r["Name"]."<br>\n"); } /* 全テーブルのレコードを全てプリント */ foreach($tables as $value){ $results = mysql_query("select * from " . $value, $link); while ($row = mysql_fetch_array($results, MYSQL_ASSOC)) { print_r($row); print("<br>\n"); } } mysql_close($link); foreachの部分を for($i = 0; $i < 2 /*$tables[$i] != 0*/; $i++){ $results = mysql_query("select * from " . $tables[$i], $link); $row = mysql_fetch_array($results, MYSQL_ASSOC); print_r($row); } でもやってみました。 これを利用して、何とか表形式でデータベースのテーブルのレコードをwebページに出力させようと思っています。 実行するとprint_r($row)の出力がでず、いろいろ試してみた結果、$resultsもしくは$rowに問題があることがわかりました。 var_dump($row); でNULLが出力されました。 var_dump($results); もやったのですが、うろ覚えなのでここには書きません。 $results = mysql_query("select * from gutaiteki_table", $link); としたら動いたので、select * from の後に変数を続けているからだめなのかなと思いましたが、私にはどうにもしようがありません。 これを正常に動作させる方法、他にうまいやり方があればその方法を教えてほしいです。 （私はデバッグのやり方がわからないので、「改変してwebのページを更新する」というのを繰り返してプログラムを作成していますが、他に方法があればそれも併せてご意見ほしいです。これは余裕があったらで構いません。）
以下のようなテーブル(test)があるとします。 id　type　　age --+----+----- 1　　A　　　15 2　　B　　　21 3　　C　　　32 4　　A　　　18 5　　A　　　16 6　　D　　　34 7　　A　　　55 8　　C　　　22 このテーブルを「SELECT * FROM test where type = 'A' order by id」で抽出すると、 id　　type age --+-----+--- 1　　A　　　15　---(1) 4　　A　　　18　---(2) 5　　A　　　16　---(3) 7　　A　　　55　---(4) となると思いますが、phpからは「typeAで４番目に登録したもの」としてとしてクエリが 送られてくるので、id7のデータを4として抽出したいのです。 (search.php?type=A&no=4　という感じです) スマートに１文でいけますでしょうか？ MySQLのバージョンは4.0.27です。 お詳しい方、どうぞ宜しくお願い致します。
phpからmysqlのクエリを作りコンテンツを検索・絞り込みさせようと考えています。 説明するのが苦手なため画像での説明になってしまいますが、 データベースの構造 http://blog-imgs-54.fc2.com/s/k/s/sksfiosjdijf34 … 絞り込みページのイメージ http://blog-imgs-54.fc2.com/s/k/s/sksfiosjdijf34 … 種類テーブルだけは「名前」が決まれば「仲間」と「原産地」が決まるので正規化することができましたが、他はできないと思います。 現在所在地テーブルはできそうですが、市によって町名が重なってしまうところがあるので正規化していません。 特徴テーブルは、種類による一般的な特徴よりも実際の特徴を優先しているので、同じ種類でも特徴がそれぞれ違います。 テーブルを分けている理由は、その方が管理しやすいと思ったからです。 特徴テーブル、日付テーブルも同じ理由です。 コメントテーブルのデータは検索しません。 「番号」には主キーを、種類テーブルは「名前」のみ、その他のカラムには全てインデックスをつけます。コメントテーブルはつけません。 そして、絞り込みページでは、 それぞれのカラムでソートさせる機能もあります。 「絞り込み」を押すと選択した条件に全て一致するコンテンツを絞り込みます。 「詳細へ」を押すと詳細のページに入り、 詳細のページでは、そのフィールドの全てのカラムのデータを表示させます。 もっと早く検索でき、効率的な構造にしたいのですが、アドバイスをいただけないでしょうか。
私の持っている参考書の中に、次のように、 変数をダブルコーテーション、シングルコーテーション、およびピリオドで囲んでいるSQL文があるのですが、 この場合、なぜ、ダブルコーテーション、またはシングルコーテーションのみでは駄目なのでしょうか？ ［参考書の記載］ where カラム名>="'.変数.'" ※変数は日付が入ります。varchar型です。
具体的には以下のテーブルがあるとします。 コード１　　　　コード２ -------------------- 　001　　　　　　A001 　001　　　　　　B001 　001　　　　　　C001 　002　　　　　　A001 　002　　　　　　B002 　002　　　　　　C001 そして、コード２がＡ００１とＢ００１を持ったコード１を抽出したいのです。 結果としては コード１　 ------- 　001　　 となりたいんです。 条件で単に　コード２＝Ａ００１　ＡＮＤ　コード２＝Ｂ００１　と書いただけでは無理でした。 もし、ＯＲだったら仮に重複を省いても コード１　　 --------- 　001　　 　002　　 となって、００２はＢ００１がないにもかかわらず選ばれてしまうので意味がありません。 最終的には コード２　IN (A001,A003) ＡＮＤ　コード２ IN (C001, C002)のような条件にするのですが 上記の段階で上手く行ってないので質問させて頂きました。
例えば極端な例ですが、5000万人の会員のデータがmemberテーブルに入っていた場合 5000万行の中から特定の会員のレコードを探すのは時間が掛かると思うので select * from member where user_id = $user_id; 50万人ごとにテーブルを新たに作ってデータを格納した方がクエリの実行時間も早くなり負荷軽減に繋がるといえますでしょうか？ user_idが1～50万は テーブルmember_1 $table = member_1; user_idが50万～100万は テーブルmember_2 $table = member_2; select * from $table where user_id = $user_id; 大手会員制サイトは、膨大な会員データをどのように格納しているのでしょうか。 ご教示頂けると幸いです。 宜しくお願い致します。
検索対象のカラムがid(主キー)、bc1～bc40と41個あります。 １つのテーブルに41個のカラムを作り検索させると非常に時間がかかります。 それにインデックスを全部に付けたいですが16個までしかつけられないです。 なので、５つのテーブルにカラムを分けて全部のカラムにインデックスをつけて それぞれを検索させようと思っています。 テーブルが１つだけなら SELECT * FROM `bc` WHERE `bc1`='あいうえおかき' AND `bc2`='あいうえおかき' AND `bc3`='あいうえおかき' AND ・・・ `bc39`='あいうえおかき' AND `bc40`='あいうえおかき' ORDER BY `bc33` DESC LIMIT 0,50; のようにできますが、テーブルが複数の場合はどうしたらよいのでしょうか。 検索を試す前に下記ができるか試してみました。 SELECT COUNT(*) FROM (((`ccc` INNER JOIN `bbb` ON `ccc`.`id`=`bbb`.`id`) INNER JOIN `aaa` ON `ccc`.`id`=`aaa`.`id`) INNER JOIN `ddd` ON `ccc`.`id`=`ddd`.`id`) INNER JOIN `eee` ON `ccc`.`id`=`eee`.`id` エラーにはなりませんがカウント数が0になってしまいました。 SELECT COUNT(*) FROM (`ccc` INNER JOIN `bbb` ON `ccc`.`id`=`bbb`.`id`) INNER JOIN `aaa` ON `ccc`.`id`=`aaa`.`id` これは正確にできてカウント数100000 SELECT COUNT(*) FROM ((`ccc` INNER JOIN `bbb` ON `ccc`.`id`=`bbb`.`id`) INNER JOIN `aaa` ON `ccc`.`id`=`aaa`.`id`) INNER JOIN `ddd` ON `ccc`.`id`=`ddd`.`id` ４つ目のテーブルを入れたところから無理なようです。 他に良い方法はないのでしょうか。
idはintでプライマリー a5はchar(10)で日本語文字列を格納 データを取得しようとすると#1054エラーがでます。 admin-------- SELECT * FROM `aaa` WHERE `a5`=`あいうえおかき` #1054 - Unknown column 'ã moniter-------- mysql> SELECT * FROM `aaa` WHERE `a5`=`あいうえおかき`; ERROR 1054 (42S22): Unknown column '縺ゅ＞縺・∴縺翫°縺・ in 'where clause' `あいうえおかき`の日本語に問題があると思い半角データを1行だけ更新しました。 admin-------- SELECT * FROM `aaa` WHERE `a5`=`abcde` #1054 - Unknown column 'abcde' in 'where clause' moniter-------- mysql> SELECT * FROM `aaa` WHERE `a5`=`abcde`; ERROR 1054 (42S22): Unknown column 'abcde' in 'where clause' admin-------- moniter-------- SELECT * FROM `aaa` WHERE `a5` SELECT `a5` FROM `aaa` WHERE 1 SELECT * FROM `aaa` WHERE `id`=89584 成功
phpmyadminの画面上には サーバのバージョン: 4.1.22-Max MySQL クライアントのバージョン: 5.0.83 と表示され、 phpinfoでは Client API version 5.0.51a と表示されます。 この３種類は何か分かりませんが、 バージョンが全部違うのは問題ですか？ Client API version 5.0.51aは少し低めですが、 あとの２つも少し低めですか？
たとえば、こちらに「こだわり条件で絞り込む」という機能があります。 http://www.athome.co.jp/bklist?ITEM=ks&ART=13&AR … MYSQLでこのような機能を実現する場合、 1項目1カラム、全てにインデックスを設定。 または 該当する項目を1カラムにまとめて格納し（CS,CATV,グルニエ,…）、その中に一致する文字の有無を判断させる。 どのような構造だと効率的に動くようになるのでしょうか？
２００７年１２月３１日付けでEmployeesテーブルのA型の人にだけ特別給料５０００円を追加するというもので Employeesテーブルには血液型（BloodType）があり給料(Amount)や支払月（PayDate）は、Salaryテーブルにあります。 UPDATE Salary INNER JOIN Employees ON Salary.EmployeeID = Employees.EmployeeID SET Amount = Amount + 5000; AND SET PayDate = '2007-12-31' FROM Salary WHERE BloodType = 'A'; ネットなどで調べて上記のコードを書いて試してみたんですがうまくいきませんでした。 どのようなコードを書くと正しく実行できるのでしょうか？
スロークエリログで、特定のクエリが遅いことが分かりました。 テーブル構成は以下のような感じです。 テーブル：shoptable データ数：200件（店舗数）ぐらい id　category shopname　　 area 1　　　2　　　佐藤商店　　東京都 2　　　1　　　田中衣服　　北海道 3　　　5　　　柴田ホーム　名古屋 テーブル：goodstable データ数：25万件（商品数）ぐらい id　shopid　goods　　　　date 1　　2　　　帽子　　　　2012-06-01 03:06:56 2　　2　　　ジャケット　2012-06-01 03:10:12 3　　1　　　ライター　　2012-06-01 03:15:22 4　　3　　　くぎ　　　　2012-06-01 03:55:07 このような状況で、categoryが2のお店の商品を日付順に100コ目以降から10コだけ表示したく、こんなqueryを試したのですが、 select * from goodstable as g left join shoptable as s on g.shopid = s.id where category='2' order by g.date desc LIMIT 100,10; 表示されるまでに時間がかかってしまいます。 expainで見たところrowsで25万件すべてをチェックしているようなので、それが原因かなと思っているのですが、どのようなqueryにしたらもっと早く結果を得れることができるでしょうか。
質問失礼します。 下記のような3つのデータベースがあるとします。 【main】 +---+--------------+------+------+ │id│title │artist│season│ +---+--------------+------+------+ │1│winter again │1　　　│4　　　│ +---+--------------+------+------+ │2│すみれ9月LOVE│2　　　│3　　　│ +---+--------------+------+------+ │3│HOWEVER │1　　　│4　　　│ +---+--------------+------+------+ │4│Boy Meets Girl │3　　　│1　　　│ +---+--------------+------+------+ │5│いつか │4　　　│2　　　│ +---+--------------+------+------+ │6│夏色 │4　　　│2　　　│ +---+--------------+------+------+ 【artist】 +---+--------+ │id│artist │ +---+--------+ │1│GLAY │ +---+--------+ │2│SHAZNA│ +---+--------+ │3│TRF │ +---+--------+ │4│ゆず │ +---+--------+ 【season】 +---+------+ │id│season│ +---+------+ │1│春 │ +---+------+ │2│夏 │ +---+------+ │3│秋 │ +---+------+ │4│冬 │ +---+------+ この3つのデータベースを最終的に1つにまとめて PHP上で下記のように表示することは可能でしょうか？ 【例.php】 +---+--------------+-----------+------+ │番号│曲名　　　　　│アーティスト│季節　│ +---+--------------+-----------+------+ │1│winter again │GLAY　　　　│冬　　│ +---+--------------+-----------+------+ │2│すみれ9月LOVE│SHAZNA　　│秋　　│ +---+--------------+-----------+------+ │3│HOWEVER │GLAY　　　　│冬　　│ +---+--------------+-----------+------+ │4│Boy Meets Girl │TRF　　　　　│春　　│ +---+--------------+-----------+------+ │5│いつか │ゆず　　　　　│夏　　│ +---+--------------+-----------+------+ │6│夏色 │ゆず　　　　　│夏　　│ +---+--------------+-----------+------+ 最初から【main】のデータベースにまとめておけばよいとは思うのですが、 データ数が数十万あり、【artist】や【season】を編集するだけでも大変になったため、 別でデータベースを作り、このような形にできないかと思っております。 また、もしできるとしたら、このような形は、 ページの表示速度が落ちたりするのでしょうか。 ご存じの方いらっしゃいましたら、ご教授お願い致します。
MySQLで年齢検索して該当する人を一覧表示したいのですが、どのようにしたらいいでしょうか？ テーブルには生年月日(birthday)を持っていて年齢に相当するカラムはありません。 管理画面で年齢をセレクトボックスで指定して検索ボタンを押すと該当の年齢の人が一覧表示させたいです。下記のように書いたのですが、ageがありません。というメッセージでダメです。 どのようにしたらいいでしょうか？ 教えてください。PHPとMYSQLです。 SELECT ( YEAR( CURDATE( ) ) - YEAR( birthday ) ) - ( RIGHT( CURDATE( ) , 5 ) < RIGHT( birthday, 5 ) ) AS age FROM member where age=36
MySQLで、perlを使ってチェックボックスでデータを送信するのですが、 カラムを分けずに、チェックボックスで複数選択されたデータを、；などの仕切りで同一フィールドへ記録したいのですが、やり方がわかりません。 <input type = checkbox name = col1 value="1"> <input type = checkbox name = col1 value="2"> <input type = checkbox name = col1 value="3"> <input type = checkbox name = col1 value="4"> 結果 col1 |col2 | +-------------- 1;2;3;4| | のような感じです。よろしくお願いします。
自宅PC環境にてMySQLの学習を始めたのですが、 UTF-８の日本語表示で躓いてしまいました。 コマンドプロンプトでUTF-８を表示させるため、 レジストリエディターで、 TrueTypeFontの値のデータを「*MS ゴシック」にすることを試みたのですが、 私の環境下では上手くいきませんでした。 （OSはWindows7の64bitです。） ですので、コマンドプロンプトでUTF-８を表示させる方法か、 もしくは、その他のターミナルソフトをご教示いただきたくお願い申し上げます。 なお、今はphpMyAdminを使って凌いでいますが、 使っている参考書が、コマンドプロンプトを使うことを前提に解説されているため、 まずは、phpMyAdminに頼らずに、MySQLをマスターしたいと考えております。 よろしくお願いいたします。
レンタルサーバーのMysqlデータをバックアップしたいと考えていまして コマンドプロンプト ↓ telnetでログイン ↓ mysqldump...... と考えていたのですが、telnetが許可されていませんでした。 mysqldumpを実行するには他にどのような方法がありますか。 宜しくお願いします。
phpでサイト構築を考えておりますが、データベースをmysqlかpostgresのどちらが早いのか検討しています 一日のデータの件数を5万件入れて、そのデータをselect、insert、updateなどするときに mysqlかpostgresのどちらが早いのか、良くわからなくて、皆様の知恵をお借りしたいです。 自分で、調べた範囲では　mysqlは、ある一定を超えると極端に遅くなるとかあったのですが・・・トリガーなどは考えないで シンプルに、データの件数での処理の速さで考えております。 宜しくお願い致します
SQLで名前の属性に「様」をつけて取り出したい場合はどうしたらいいのですか。 参考書に書いてあるようにやったのですが、そうすると0が出力されてしまいました。(もとのテーブルにはちゃんと名前が入っています) よろしくお願いします。 mysql> select customername ||　'様' as お名前 from customers; +--------+ | お名前 | +--------+ | 0 | | 0 | | 0 | | 0 | | 0 | | 0 | | 0 |
こんにちは。データベースを勉強中です。 金額を入れるカラムがあり、型をDecimal（10,1）としているのですが、小数点がない場合はコンマ以下を表示したくありません。 例えば、25.5であればそのまま、100.0であれば"100"とだけ表示する簡単な方法はないでしょうか。 データはテキストファイルからLoad Dataで入れています。ファイル自体には 25.5、100などと小数点以下の桁はそろっておらず、最大でも第一までです。　 今はデータを入れる際、100は100.0と変換されて入りますが、ファイルの内容がそのまま入るように出来たらと思います。 これを条件などで設定するのでなく、オプションか何かで設定することはできませんでしょうか。 MYSQL v5.1 以上、何かアドバイス頂けますと大変助かります。 お手数ですが宜しくお願いします。
いつもお世話になっております。 またまたmysqlについて質問させていただきます。 下記のようなテーブルがあります。 tabel A | type_id | member_id | date| | 2 | 45| 2012-6-21 | | 2 | 46| 2012-6-22 | | 2 | 47| 2012-6-19 | | 2 | 48| 2012-6-10 | | 4 | 49| 2012-5-23 | | 4 | 50| 2012-5-24 | | 4 | 51| 2012-5-21 | | 4 | 52| 2012-5-22 | | 3 | 53| 2012-7-25 | | 3 | 54| 2012-7-26 | | 3 | 56| 2012-7-23 | | 3 | 57| 2012-7-24 | | 1 | 58| 2012-8-17 | | 1 | 59| 2012-8-18 | | 1 | 60| 2012-8-25 | | 1 | 61| 2012-8-26 | table B | type_id | name | | 1 | aaaa | | 2 | bbbb | | 3 | cccc | | 4 | dddd | 下記の条件で値を取得するSQLをご教授いただけますでしょうか １．type_idでまとめたものを3件ずつ取得 　　（三件の中で一番直近のdateを持っているもの順にtype_idを並べる） ２．type_idのまとめた三件がdateの直近順 ３．type_idのそれぞれのnameをくっつける 結果として | type_id | member_id | date|name | 4 | 51| 2012-5-21 |dddd | 4 | 49| 2012-5-23 |dddd | 4 | 50| 2012-5-24 |dddd | 2 | 48| 2012-6-10 |bbbb | 2 | 47| 2012-6-19 |bbbb | 2 | 45| 2012-6-21 |bbbb | 3 | 56| 2012-7-23 |cccc | 3 | 57| 2012-7-24 |cccc | 3 | 53| 2012-7-25 |cccc | 1 | 58| 2012-8-17 |aaaa | 1 | 59| 2012-8-18 |aaaa | 1 | 60| 2012-8-25 |aaaa 説明が下手ですみません…分かりにくければ補足説明いたします…
添付画像のようなデータがあります。 これを部署単位でデータをまとめたいです。 お知恵を拝借出来れば幸いです。 所属者の最小数は1で最大数は81名でした。
kid | id | name | day | tday | 1 | 1 | 松　|　25 | 1 | 2 | 谷　 | 15 | このようなデータがあったとして、それぞれのMAX（day）を出力する場合どうしたらいいでしょうか？？ $sql2 = 'SELECT kid,id,name,MAX(day),tday FROM em WHERE kid='.$_SESSION["kid"].'' ; これだと松さんのデータしか出力されないし、MAXを外すと、例えば松さんのデータが二個あり出力した場合、松（25）松（18）谷（15）と出力されてしまいます。 希望は 松（25）谷（15） それぞれの最大値です。
サーバ変更に伴い、Wordpressの移行を試みていますが、Mysqlのインポートの際に下記のエラーが出てしまいかなり困っています... Mysqlのヴァージョンは、5.1.x系。 php/SQL共に初心者レベルなのですが、ご指導ください 実行した SQL: { \ rtf1 \ ansi \ ansicpg932 \ cocoartf1038 \ cocoasubrtf320{ \ fonttbl \ f0 \ fswiss \ fcharset238 Helvetica; MySQLのメッセージ: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '{\rtf1\ansi\ansicpg932\cocoartf1038\cocoasubrtf320 {\fonttbl\f0\fswiss\fcharset2' at line 1 ■補足 現在、データベースからWordpressを復元させようとしています。 手元にあるデータは、 ・FTPからダウンロードしたWordpress含む全データ ・旧Mysqlログイン情報 ・新Mysqlログイン情報 となります。 質問日時：2012/5/26 05:34:02 残り時間：7日間 補足日時：2012/5/26 05:49:34
初歩的な質問で、既に質問されている内容でしたらすいません。 不動産のデータベースでひとつのテーブル内に、最寄り沿線が３つ記録されています。 ３列のデータをまとめてグループ化し、沿線名ごとのカウントを取るにはどうすれば良いでしょうか？テーブルの詳細は、添付画像をご確認ください。 １列ごとのやり方はわかるのですが、３列まとめてカウントする方がわかりません。 どなたか教えて頂けませんでしょうか。
お世話になります。 以下のようなクエリで、変数にNULLが入ります。 何が悪かったのでしょうか、ご教示ください。 SELECT @change := MAX( 購入日 + INTERVAL 2 YEAR ) as 交換日 FROM テーブル WHERE @change > '2012-04-24' お願いします。
DVDで画像スライドショーを作りたいのですが、作り方がいまいち分かりません。 回答至急よろしくおねがいします！！
すみません、質問文もどう書いていいか分からないのですが； 以下のような結果を出したい場合 id,　商品名,　購入日,　壊れる日 (商品の壊れる時期を知りたい) ------------------------------------------------------ テーブルリスト： 商品テーブル（商品の内容）　・商品性能テーブル（商品の耐久年数） SQL： SELECT 商品名,購入日, 購入日+INTERVAL (SELECT 壊れる日 FROM 商品性能 WHERE △△) YEAR FROM 商品テーブル ------------------------------------------------------ 馬鹿な頭で考えた結果、 商品を全てリストアップし、その購入日に耐久年数を足した値が欲しい 例： 商品名　、購入日　　　、壊れる日 ストーブA、2012/01/01、2014/01/01 つまり、購入日にストーブAの持ってる耐久年数を足したいのですが 私の考えるクエリでは、△△の部分が分かりません。 そもそも、このようなクエリではないのでしょうか？ どうか、ご教示くださいT-T
こんにちわ。今MySQLを使ってテーブルの作成をしているのですが、やり方に自信がないため質問させていただきます。 test.txtに以下の情報が入っているとします。(ゲノムの情報になります） ***** id count start_position end_position 1 2 51091076,51101385,51091253,51102009, 2 3 112644827,112647824,112648979,112645084,112647981,112649152, 3 3 30103583,30105062,30106006,30103918,30105414,30106086, ***** countのコラムにはstart_position, end_positionに何個の値が入るのかを示しています。 ここから、test_tableというのをつくり、以下の形にしたいのです。 id start_position end_position 1 51091076 51091253 1 51101385 51102009 2 112644827 112645084 2 112647824 112647981 2 112648979 112649152 3 30103583 30103918 3 30105062 30105414 3 30106006 30106086 test.txtを使って. LOAD DATA INFILE 'test.txt' INTO TABLE test_table FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n'; と全体のテーブルを作りました。この際、start_position, end_positionの値にはカンマが入る形になってしまいます。 上記のテーブルを作成するため、まず、idだけのテーブルを作ろうと思い、 SELECT REPEAT(CONCAT(id, '\r'), EXONCOUNT) FROM test_table INTO OUTFILE 'id_count.txt'; LOAD DATA INFILE 'id_count.txt' INTO TABLE id_count LINES TERMINATED BY '\r'; を実行し、 positionだけのテーブルも以下のように用意しました。 SELECT REPLACE(start_position, ',', '\r') FROM test_table INTO OUTFILE 'start.txt'; LOAD DATA INFILE 'start.txt' INTO TABLE start LINES TERMINATED BY '\r'; そうすると、 id_countテーブルは *** | 1 | | 1 | | 2 | | 2 | | 2 | | 3 | | 3 | | 3 | *** と表記され、 startテーブルは ********** | 51091076 | | 51101385 | | 0 | | 112644827 | | 112647824 | | 112648979 | | 0 | | 30103583 | | 30105062 | | 30106006 | | 0 | ********** と0が入ってしまいます。 start_positionとend_positionの値の最後のコンマを外してからやればできるのかもしれませんが、ほかに方法がありましたら教えていただけると嬉しいです。 わかりにくい点があるかもしれませんが、お願いいたします。
Win7でテスト用のwebサーバを構築していますが、phpMyAdminを使えない状態になっています。考えられる原因と対処法をお教え願います。 ==== 環境 ==== OS：Windows7 Ultimate 32bit webサーバ：Apache2.2 php：5.2.1 mysql：5.1 phpMyAdmin：3.5.1 インストール先はそれぞれ apache…c:\apache2.2 php…c:\PHP mysql…c:\MySQLServer5.1 phpMyAdmin…c:\MySQL\phpMyAdmin3.5.1 ==== 状況 ==== 1. http://127.0.0.1/phpMyAdmin/index.php でユーザ名とパスワードの入力はできる。 2. パスワード入力後に表示されるデータベース一覧（？）が表示されない。（ブラウザに表示されるエラーメッセージは下記のとおり） 3. 上記の状態で1440秒以上時間を置いて再度 http://127.0.0.1/phpMyAdmin/index.php を行うとユーザ名とパスワードの入力画面になる。1440秒以内だと、エラーメッセージが再度表示される。 4. 127.0.0.1をlocalhostとしても同じ結果になる。 ========================================== 各ブラウザに表示されるメッセージは下記のとおり IE： Internet Explorer ではこのページは表示できません Fire Fox： 　接続がリセットされました 　ページの読み込み中にサーバへの接続がリセットされました。 chrome： 　このウェブページにアクセスできません 　127.0.0.1 との接続が中断されました。 　エラー 101 (net::ERR_CONNECTION_RESET): 接続がリセットされました。
データベースに詳しい方！一つのフィールドに複数の情報を持たせたいです。 例えば複数のユーザを管理するテーブルにあるID（フィールド）を 複数個をデータベースに保存する場合どうすればいいのでしょうか？ 言語はJavaで、データベースはMySQLを使っています。 ↓↓各フィールド(例) -------------------------- || userName || userID || ○○ID || -------------------------- 上記の 「○○ID」というフィールド に複数の値を持たせたいのです。 String型の配列、もしくはXMLをMySQLの一つのフィールドに保存する 事はできるのでしょうか？ （もし出来るのならこちらを採用したいです） それとも○○IDに関連するテーブルを作成する(？) それか最悪の場合、ユーザが増えるたびにテーブルを一つ作成 して管理するか・・・・（避けたいです） 宜しくお願いします。
チェックボックスで、複数の項目をフラグとして扱うにあたって ビット演算を使いたいと思っています。 この時、チェックボックスを作成するフォームの値は <input type="checkbox" name="category[]" value="1" />ライフ <input type="checkbox" name="category[]" value="2" />デジタルライフ <input type="checkbox" name="category[]" value="4" />趣味 <input type="checkbox" name="category[]" value="8" />エンターテイメント . . . と、valueの値をべき乗づつ増やしてくもしくは、あるいは value　の値を１２３４としてやってあとでx2するかして それらの合計（例えばチェック状態が00101　なら　５）を DBに保存してやるというロジックでいいのでしょうか？ 他のポータルサイトのソースをみても、そんなやり方してるサイトをみかけないので はたしてこれで合ってるのか不安になってきて質問させて頂きました。
さくらのレンタルサーバーで、Mysqlを4から5.5に変更するために 一旦ワードプレス2.6（Wordpress2.6）のデータをエクスポートして、Mysql5.5に切り替えてから インポートしたのですが、ワードプレスにログインしようとしたら、 「ワードプレスこのページにアクセスするための十分なアクセス権がありません。」 と表示され、ログインできなくなりました。 同じような状況を検索したのですが、文字コードもプレフィックスも 変更していないのです。 原因が他にあると思われますが、分かる方は教えて下さい。 よろしくお願いします。
mysqlを使用してデータベースを作成しているのですが データベースでテーブルを分けるときって 【アカウントテーブル】 ID アカウント 名 アカウント　パスワード 名前 住所 電話番号 職業 【職業テーブル】 職業ID 職業名 というような１対多というのはよく組むとおもうんですが 下記のような 【アカウント情報テーブル（アカウント情報）】 アカウントID アカウント 名 アカウント　パスワード 【アカウント情報テーブル（プロフィール情報）】 アカウントID 名前 住所 電話番号 職業 １対１の関係でテーブルをジャンル（エンティティ）ごとに複数にわけて あとでリレーションして一個にまとめるというのはデータベース的にあまりよろしくないのでしょうか？ 何故、こんなことしたいかというと、１テーブルあたりのカラム数がかなり多くなってくると PHPでデータベースを書き込んだり呼び出したりする時に毎度多くのカラムを取り扱わなければならず SELECTで、カラムを一個一個選んで行かないといけません。 しかし、取り扱いたいカラムは大抵の場合あるジャンルだけなので リレーションするかしないかで、あるジャンルのデータだけを取り扱えれば 効率がよくなるのでは？　というのがあります。 また、視覚的にカラムの把握もしやすくなります。 この１対１テーブルは、DB設計的にどうなでしょうか？
よろしくおねがいします。 mySQLを学習中です。データベースの専門書も何冊かよんできていますが、実務経験のない私にはどうも実感や深い理解ができません。 そこで、テスト環境を作って、インデックスの効果や処理が煩雑になったときのトラブルを１つでも多く経験したいと思いました。 ご教授ねがいたいのは、 1.大規模データベースの作り方 と 2.そこへのアクセスを多くする（実験をする）方法 です。 2.については自分のみのアクセスでシステムトラブルを起こすのは難しいのではと思い、ネットに公開する形でアクセス数を稼いだ方がテスト環境的にはよいのではと考えての質問です。ですが、どういうサイトにすればいいのか思い至りません。単に閲覧だけやselect するだけの場合と、insert文発行等をする場合ではシステムトラブルの確率は全く違いますでしょうか？それによってもどういうサイトにすべきかが変わってきます。 1.については、どうやって多量のデータを作成すればいいのか見当がつきません。2．との兼ね合いがあってシステムトラブルの可能性を上げないといけませんが、単に100行程度のデータを100×１00×100にコピペして作成する程度では結局100行のデータを処理するのとあまり変わらなくなってしまうのではと悩んでいます。 １、２についてご教授おねがいします。
こんにちは。 初歩的なことだと思うのですが、複数テーブルからのレコード摘出で躓いてしまったのでご教授ください。 以下のような２つのテーブルがあったとして、 table_a ---------------- acount_no / name 1 / aaa 2 / bbb table_b ---------------- acount_no / value / update_at 1 / 0000 / 2012-05-12 2 / 3333 / 2012-05-12 1 / 1111 / 2012-05-13 2 / 5555 / 2012-05-13 table_aのacount_noとnameは必ず必要で、table_bのupdate_atに対応するvalueを条件付けで取り出したい場合はどのようにしたら良いのでしょうか。 レコードに存在しない日付を指定したときには、空欄で欲しいのですが・・・、 acount_no / name / value 1 / aaa / null 2 / bbb / null 例えば、 select a.acount_no,name,value from table_a as a LEFT JOIN table_b as b ON a.acount_no = b.acount_no where b.update_at = '2012-05-14' order by a.acount_no asc とすると結果が０行になってしまいます。 外部結合の使い方が間違っているのでしょうか・・・。 お力添えの程、宜しくお願い申し上げます。
MYSQL初心者ですが、よろしくお願いします。 MYSQL(ver5.5)でストアドプロシージャを作成しようと思います。 WEBの検索画面に入力された条件に応じて、WHERE句を動的に作成したいのです。 例えば、WEBの検索画面の検索条件に、 (1)氏名 (2)住所 (3)電話番号 があり、(1)と(3)に入力された場合は、 あるテーブルの検索条件を WHERE　氏名=入力氏名　AND　電話番号=入力電話番号 のように動的にSQLを作成したいです。 （条件に応じて、静的なSQLを使い分けるやりかたはしたくない） このような動的なSQLはストアドプロシージャで作成できのでしょうか？ よろしくお願いします。
いつもお世話になっております。 すごく幼稚な質問で申し訳ないですが、よろしくお願い致します。 phpmyadminにて、テーブルを作成しました。 テーブル名はtest　で、中に4つのフィールドがあります。それぞれ、id、shozoku_id、name、data　となっています。 idには0～の値が入ります。 shozoku_idには0～値が入ります。 nameには名前が入ります。 dataには0か1のみ入ります。 このテーブルには同じidを持つ人が、複数のshozoku_idとdataを持っています。 行いたいことは、 任意のid　を持つ人で、dataの値が0の人を、1に書き換える処理　です。 どうぞ、よろしくお願い致します。
phpから利用するMySQLの効率的な活用方法 を学べるようなおすすめ参考書はありますか？ このようにするとパフォーマンスが上がる。 こういう作り方はよろしくない。 といった感じで、雰囲気としては http://d.hatena.ne.jp/kiyo560808/20101117/128995 … http://phpspot.org/blog/archives/2006/11/mysql84 … こんな感じです。よろしくお願いします。
phpを独学し始めた初心者です。 よろしくお願いします。 以下のphpファイルを実行するとエラーが出ない にもかかわらず、データーベースの表示で確認すると 日本語のみがすっぽり空いた状態で、その他はphp通り データーが挿入されます。 つまり 『item_name』に『もも』 『keyword』に『缶詰,ピンク,甘い』 という文字が入りません。 （ともに状態はTEXTになっています。） なぜでしょうか？ （環境）------------------------------------- phpエディターでphpファイルをつくり phpMyAdminでデーターベースを編集してます。 ローカルホストです。 --------------------------------------------- <?php mysql_connect('localhost', 'root', '') or die(mysql_error()); mysql_select_db('mydb') or die(mysql_error()); mysql_query('SET NAMES UTF8'); mysql_query ('INSERT INTO my_items SET maker_id=1, item_name="もも", price=480, keyword="缶詰,ピンク,甘い", sales=0, created="2010-10-10", modified="2012-05-05"') or die(mysql_error()); echo 'データー挿入完了'; ?> どうぞよろしくお願いします。
MySQLのインデックスキーを設定するとプライマリーキーが設定されてしまいます。 phpMyAdminを使用しています。 localhostページの一番下には、下記２つの注意が発せられています。 ■phpMyAdmin の新しいバージョンが提供されています。アップグレードの検討をお奨めします。最新バージョンは 3.5.1 で、2012-05-03 にリリースされています。 ■phpMyAdmin 環境保管領域が完全に設定されていないため、いくつかの拡張機能が無効になっています。理由についてはこちらをご覧ください。 localhostページの右側にあるバージョン情報は、 ＜データベースサーバ＞ ソフトウェア: MySQL ソフトウェアバージョン: 5.0.96-community-nt - MySQL Community Edition (GPL) プロトコルバージョン: 10 サーバの文字セット: UTF-8 Unicode (utf8) ＜ウェブサーバ＞ Apache/2.4.1 (Win32) PHP/5.2.17 データベースクライアントのバージョン: libmysql - 5.0.51a PHP 拡張: mysqli ＜phpMyAdmin＞ バージョン情報: 3.5.0, 最終安定バージョン: 3.5.1 現段階は、下記のようなテーブル構造になっています。 下記は質問用にデータをコピーするためにMySQL monitorを使いました。 フィールドの追加やキーの追加と削除はphpMyAdminで行っています。 （１）テーブルの構造 mysql> SHOW FIELDS FROM `infotable`; +----------+---------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +----------+---------+------+-----+---------+-------+ | id | int(11) | NO | PRI | NULL | | | name | text | NO | | NULL | | | kudamono | text | NO | | NULL | | | coment | text | NO | | NULL | | | tes | int(11) | NO | | NULL | | +----------+---------+------+-----+---------+-------+ （２）`tes`にインデックスキーを設定 phpMyAdminの「構造」画面でtesフィールドの「操作」欄の「その他」ドロップダウンから「インデックスを追加する」をクリック phpMyAdminの画面に ALTER TABLE `infotable` ADD INDEX ( `tes` ) と表示され`tes`にインデックスキーを設定しました。 （３）インデックスキー設定後のテーブルの構造 mysql> SHOW FIELDS FROM `infotable`; +----------+---------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +----------+---------+------+-----+---------+-------+ | id | int(11) | NO | PRI | NULL | | | name | text | NO | | NULL | | | kudamono | text | NO | | NULL | | | coment | text | NO | | NULL | | | tes | int(11) | NO | MUL | NULL | | +----------+---------+------+-----+---------+-------+ ここでMULという文字が出てきて調べてみると、 プライマリーキーの重複を表す文字で、 インデックスを設定したはずなのに プライマリーキーが設定されてしまいました。 （４）text型のnameフィールドにもやってみます。 text型の場合は、tesフィールドと同じ方法ではできなかったので、 「SQL」画面で ALTER TABLE `infotable` ADD INDEX (`name`(10)) を実行しました。 mysql> SHOW FIELDS FROM `infotable`; +----------+---------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +----------+---------+------+-----+---------+-------+ | id | int(11) | NO | PRI | NULL | | | name | text | NO | MUL | NULL | | | kudamono | text | NO | | NULL | | | coment | text | NO | | NULL | | | tes | int(11) | NO | MUL | NULL | | +----------+---------+------+-----+---------+-------+ text型も同じ状態になってしまいます。 なぜMULになってしまうのでしょうか。 インデックスを追加するにはどうしたらよいでしょうか。 ちなみに ALTER TABLE `infotable` DROP INDEX `tes` を実行後はtesのMULは消えます。
お世話になっております。 質問内容は基本的な事かもしれませんがご容赦ください。 あるテーブルにDateTime型のフィールドがあり、Insertした日時を保存しています。 このフィールドに対して、日付のBETWEENや時間のBETWEENで検索かけるにはどうしたら良いのでしょうか。 例えば、 時間は未指定だけど、1月1日から1月31日までのデータを検索 SELECT * FROM table WHERE insertDT BETWEEN '01-01' AND '01-31' 日付は不明だけど、７：００から１２：００までのデータを検索する等です。 SELECT * FROM table WHERE insertDT BETWEEN '07:00' AND '12:00' これら試しましたが、正常な結果が得られず困っています。 不明な部分の代替文字でもあるのでしょうか。 SELECT * FROM table WHERE (insertDT >= '07:00' AND insertDT <= '12:00') これも試しましたがやはりダメでした。 どなたかご教示の程、よろしくお願い致します。
現在、ホームページ（架空サイト）を制作をしています PHPでショッピングカートやメルマガなどを作成し、 データベースはMySQLを使用しています この状態でレンタルサーバー等にアップロードした場合、 ショッピングカート等は機能しますか？ 機能しない場合、機能させるためにはどうのような環境を 用意したらいいでしょうか？ 制作やプログラムを始めたばかりの初心者です 皆様、是非ともご教授願います 宜しくお願い致します
MySQLでabevというテーブルにデータを挿入しようと INSERT INTO abev SET name='名前', story=10, music=10, voice=10, character=10, graphic=10, comment='コメント'; というSQL文を打ったのですが、 #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'character=10, graphic=10, comment='コメント'' at line 1 というエラーがでます。 idはオートインクリメントしてあるので省いています。 フィールド名のつづりも間違ってません。 いったいどこが悪いのでしょうか？
よろしくお願いします。 さくらインターネットサーバーで無料お試しで登録しているのですが、 phpMyAdminから自分のパソコンのデータをインポートしようとするのですが、エラーになってしまいます。 データは大きくないです。 サーバのphpMyAdminのバージョンは「3.3.10.3」となっています。 パソコンに入っているものは「3.1.3.1」と「3.4.5」です。（XAMPPからダウンロードしました） エラーの内容は「#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '? ' at line 1」 です。 後は文字化けしまって読めないものが2行ほどあります。 ｐｈｐのバージョンは、サーバが「5.2.17」でパソコンは「5.2.9」と「5.3.8」です。 どちらのバージョンでためしてもエラーがでました。 それから MySQLにはSHIFT＿JISで設定していますが、サーバのMｙSQLはUTF-8となっていますが、 そのせいで文字化けしているのでしょうか？データもすべてUTF-8に変えた方が良いのでしょうか？ インポートできないので、さくらサーバーのphpMyAdminで入力したデータはShifｔ_JISで設定しましたが それは文字化けしていません。 それから、サーバのデータベース（phpMyAdmin画面）へのログインが、よくエラーになります。 サーバで調べてもらったのですが、異常はないそうです。 でも、ログインを試みて半分はエラーになってログインできませんでした。 これも同じ原因なのでしょうか？ これが解決しないとお試し期間が終わっても契約出来ないので急いでいます。 よろしくお願いします。
PHP5.2 MySql5.1.34 文字コードSJIS MySqlに登録したデータを更新すると文字化けします。 回答をよろしくお願い致します。 // MySQLのクライアントの文字コードをsjisに設定 mysql_query("SET NAMES 'sjis'") or die("can not SET NAMES sjis"); // データを取り出す $sql = "SELECT created_at, mes, url FROM message WHERE (id = ".$_POST["id"].");"; $res = mysql_query($sql, $conn) or die("データ抽出エラー"); $row = mysql_fetch_array($res, MYSQL_ASSOC); // 取り出したデータを表示する print "<form action=koushin.php method=post accept-charset=\"Shift_JIS\">"; print "日付：<input type=text size=30 name=created_at value=" . $row["created_at"] . "> "; print("<br>"); print("<br>"); print "メッセージ：<input type=text size=50 name=mes value=" . $row["mes"] . "> "; print("<br>"); print("<br>"); print "URL：<input type=text size=80 name=url value=" . $row["url"] . "> "; print "<input type=hidden name=id value=" .$_POST["id"]. ">"; print("<br>"); print("<br>"); print "<input type=submit value=更新>"; print("<br>"); print("<br>"); print "</form>"; koushin.php <?php $sv = "サーバ"; $dbname = "データベース"; $user = "ユーザー"; $pass = "パスワード"; $conn = mysql_connect($sv, $user, $pass) or die("接続エラー"); mysql_select_db($dbname) or die("接続エラー"); $id = $_POST["id"]; $created_at = $_POST["created_at"]; $mes = $_POST["mes"]; $url = $_POST["url"]; $sql = "UPDATE message SET updated_at = now() , created_at = '{$created_at}' , mes = '{$mes}' , url = '{$url}' WHERE id = $id"; $res = mysql_query($sql, $conn) or die("更新エラー"); mysql_close($conn); ?>
PHP5.2 MySql5.1.34 文字コードSJIS \' の2つを含む文字を登録できません。 /".!% は登録できます。 <?php if(!$_POST['mes']){ print <<< html ブログ記事を投稿 <form action="$PHP_SELF" method="post"> <table border="1"> <tr> <td>日付</td> <td> <textarea rows="3" cols="20" name="created_at"></textarea> </td> </tr> <tr> <td>タイトル</td> <td> <textarea rows="3" cols="40" name="mes"></textarea> </td> </tr> <tr> <td>URL</td> <td> <textarea rows="3" cols="60" name="url"></textarea> </td> </tr> <tr> <td colspan="2"> <input type="submit" value="書き込む"> </td> </tr> </table> </form> html; }else{ $dbcon = mysql_connect("サーバ","ユーザ名","パスワード"); mysql_set_charset("sjis",$dbcon); mysql_select_db("データベース名"); $today = date("Y/m/d H:i:s"); $created_at = str_replace("\r\n", "", $_POST['created_at']); $mes = str_replace("\r\n", "", $_POST['mes']); $url = str_replace("\r\n", "", $_POST['url']); $sql_mes = "insert into message(updated_at,created_at,mes,url) values('" . $today . "','" . $created_at . "','" . $mes . "','" . $url . "')"; $result_mes = mysql_query($sql_mes); mysql_close($dbcon); print "記事の投稿が完了しました。<br>"; } ?>
phpを独学し始めた初心者です。 よろしくお願いします。 以下のphpファイルを実行すると エラーが出ないにもかかわらず、 データーベースの表示で確認すると 『item_name』に『もも』という文字が入っていません。 その他はphp通りデーターが挿入されます。 なぜでしょうか？ （環境）------------------------------------- phpエディターでphpファイルをつくり phpMyAdminでデーターベースを編集してます。 ローカルホストです。 --------------------------------------------- <?php mysql_connect('localhost', 'root', '') or die(mysql_error()); mysql_select_db('mydb') or die(mysql_error()); mysql_query('SET NAMES UTF8'); mysql_query ('INSERT INTO my_items SET maker_id=1, item_name="もも", price=480, keyword="缶詰,ピンク,甘い", sales=0, created="2010-10-10", modified="2012-05-05"') or die(mysql_error()); echo 'データー挿入完了'; ?> どうぞよろしくお願いします。
REPLACEクエリで条件文を使用するには？ 以下で、bannedカラムがtrueの時だけfalseに変更しないようにするにはどうすればいいでしょうか？ /*テーブルを作成*/ CREATE TABLE test (name CHAR(100) UNIQUE, banned BOOLEAN DEFAULT FALSE NOT NULL); /*bannedカラムにfalseを注入*/ REPLACE INTO test (name) VALUES('鈴木'); /*bannedカラムをfalseからtrueに変更*/ REPLACE INTO test (name,banned) VALUES('鈴木',true); /*このクエリを実行してもbannedカラムをtrueからfalseにしないようにするには*/ REPLACE INTO test (name) VALUES('鈴木');
検索ページから下記のソースに検索結果を表示させようと思っておりますが、スペース区切りにして検索をかけるとヒットしません。 こちらのソースのどの部分にどの様なSQL文を書けば実装出来ますでしょうか？ 宜しくお願いします。 <?php require_once('Connections/tm.php'); ?> <?php if (!function_exists("GetSQLValueString")) { function GetSQLValueString($theValue, $theType, $theDefinedValue = "", $theNotDefinedValue = "") { if (PHP_VERSION < 6) { $theValue = get_magic_quotes_gpc() ? stripslashes($theValue) : $theValue; } $theValue = function_exists("mysql_real_escape_string") ? mysql_real_escape_string($theValue) : mysql_escape_string($theValue); switch ($theType) { case "text": $theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL"; break; case "long": case "int": $theValue = ($theValue != "") ? intval($theValue) : "NULL"; break; case "double": $theValue = ($theValue != "") ? doubleval($theValue) : "NULL"; break; case "date": $theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL"; break; case "defined": $theValue = ($theValue != "") ? $theDefinedValue : $theNotDefinedValue; break; } return $theValue; } } $colname_search = "-1"; if (isset($_GET['search'])) { $colname_search = $_GET['search']; } mysql_select_db($database_tm, $tm); $query_search = sprintf("SELECT * FROM posts WHERE title LIKE %s ORDER BY modified DESC", GetSQLValueString("%" . $colname_search . "%", "text")); $search = mysql_query($query_search, $tm) or die(mysql_error()); $row_search = mysql_fetch_assoc($search); $totalRows_search = mysql_num_rows($search); ?> <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitio … <html xmlns="http://www.w3.org/1999/xhtml"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>無題ドキュメント</title> </head> <body> <table width="583" border="1"> <tr> <th width="82" scope="col">タイトル</th> <th width="113" scope="col">メッセージ</th> <th width="111" scope="col">開始時間</th> <th width="105" scope="col">名前</th> <th width="138" scope="col">詳細</th> </tr> <tr> <td height="20"><?php echo $row_search['title']; ?></td> <td><?php echo $row_search['message']; ?></td> <td><?php echo $row_search['modified']; ?></td> <td><?php echo $row_search['n_name']; ?></td> <td><a href="request_list.php?recordID=<?php echo $row_search['id']; ?>">詳細</a></td> </tr> </table> </body> </html> <?php mysql_free_result($search); ?>
お世話になります。 早速ですが １、トランザクション ２、テーブルAにインサート ３、テーブルBにインサート ４、テーブルCにインサート ５、コミット のような処理の時に、テーブルAでインサートしたレコードの IDをテーブルBとCに入れたいので、テーブルBに入れる時に LAST_INSERT_ID()を使うと思い通りの処理になりました。 しかし、テーブルCにインサートする時にはLAST_INSERT_IDの 値はテーブルBのインサート時のIDとなり、テーブルAのIDでは ありません、当然ですが。。 こういった場合、テーブルAのインサートIDを取得保持するには どのようにすればいいのでしょうか？ どうか、ご教示ください。
　 http://okwave.jp/qa/q7386074.html にて、類似の質問になりますが、 Mysqlのクエリで値を重複なく分割置換したい場合はどうすればよいのでしょうか？ foreach($sample as $test){ $data=explode(' ',$test['data']); foreach($data as $token){ echo "<li><a href=\"\">{$token}</a></li>\n"; } } だと、各クエリの値が 「あああ　いいい　ううう　えええ」 「いいい　あああ　おおお」 「ううう　おおお」 だとすると クエリの値が、「あああ　いいい　ううう　えええ　いいい　あああ　おおお　ううう　おおお」 となってしまいます。 「あああ　いいい　ううう　えええ　おおお」 という形式に重複を排除していのですが、有識者の方、助言をお願いします。
SELECT * FROM table1,table2 WHERE table1.id=table2.data_id; phpmyadminにて、上記のようなSQL文を実行してtable1とtable2のデータを リレーションにより表示します。 この時に表示した内容のテーブルを新規作成するにはどうすれば良いでしょうか？
検索フォームを作成し、結果を別ページに表示したいと思っておりますが、うまくいかないので質問させて頂きます。 ・状況 検索ワードが部分一致での結果は表示できるのですが、Yahooのように複数検索すると結果が表示されません。 また、検索ワードの前後に半角スペースや全角スペースなどを入れても同様です。 ・ソース 検索フォーム側 <form id="form1" name="form1" method="get" action="search.php"> <label for="textfield"></label> <input type="text" name="title" id="textfield" /> <input type="submit" name="button" id="button" value="検索" /> </form> 検索結果側（search.php） <?php require_once('Connections/tm.php'); ?> <?php if (!function_exists("GetSQLValueString")) { function GetSQLValueString($theValue, $theType, $theDefinedValue = "", $theNotDefinedValue = "") { if (PHP_VERSION < 6) { $theValue = get_magic_quotes_gpc() ? stripslashes($theValue) : $theValue; } $theValue = function_exists("mysql_real_escape_string") ? mysql_real_escape_string($theValue) : mysql_escape_string($theValue); switch ($theType) { case "text": $theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL"; break; case "long": case "int": $theValue = ($theValue != "") ? intval($theValue) : "NULL"; break; case "double": $theValue = ($theValue != "") ? doubleval($theValue) : "NULL"; break; case "date": $theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL"; break; case "defined": $theValue = ($theValue != "") ? $theDefinedValue : $theNotDefinedValue; break; } return $theValue; } } $colname_search = "-1"; if (isset($_GET['title'])) { $colname_search = $_GET['title']; } mysql_select_db($database_tm, $tm); $query_search = sprintf("SELECT * FROM posts WHERE title LIKE %s ORDER BY title DESC", GetSQLValueString("%" . $colname_search . "%", "text")); $search = mysql_query($query_search, $tm) or die(mysql_error()); $row_search = mysql_fetch_assoc($search); $totalRows_search = mysql_num_rows($search); ?> <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "ttp://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="ttp://www.w3.org/1999/xhtml"> <head> <meta ttp-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>無題ドキュメント</title> </head> <body> <table width="725" border="1" cellspacing="0" cellpadding="0"> <tr> <th width="120" scope="col">タイトル</th> <th width="120" scope="col">内容</th> <th width="120" scope="col">名前</th> </tr> <tr> <td><?php echo $row_search['title']; ?></td> <td><?php echo $row_search['message']; ?></td> <td><?php echo $row_search['n_name']; ?></td> </tr> </table> </body> </html> <?php mysql_free_result($search); ?> ※検索結果側はテスト段階のため、まだ結果を一件のみ表示されるだけとなっています。 ネットで調べると ・全角スペースを半角に揃える ・orやandを使用する らしき所までしか分かりませんでした。。。 出来れば詳しいソースや参考サイト等がありましたらご伝授をお願い致します。
よろしくお願いします。 会員情報登録時などで、emailを入力させる場合、一意にすべきでしょうか？ 私はuniqueにしたいのですが、phpの書籍を１０冊近く読んできましたが、emailを一意に するようなコーディングをしている例はなく、emailについては一意性の制限はまったくかけていない例ばかりでした。 実際、一意でバリデートするとなにか問題があるのでしょうか？ アドバイスをお願いします。
XAMPPを使って、AppacheとMySQLなどをインストールしました。 MySQLは順調に動いていたのですが、 rootユーザーにpasswordを設定するつもりで、mysqlデータベースのuserテーブルのlocalhost/rootのレコードにパスワードを設定して、flush privilegeを実行しました。 一度、xamppコントロールパネルからmysqlAdminを再起動したところ、今まで使っていたデータベースが使えなくなりました。 どうすれば使えるようになりますか？　初心者です。すみません。よろしくお願いします。
100以上テーブルがあり、どのテーブルに新しくレコードが追加された若しくはアップデートがあった、テーブルのレコードを知りたいのですが、このような場合、どのようにすればその情報を表示することができますでしょうか？ 全てのテーブルにはcreated_atとupdated_atフィールドが用意されています。 ご教示頂けると幸いです。 宜しくお願い致します。
以下のようなスクリプトをcron起動で実行し、Amazon RDS上のMySQLデータベースのバックアップを取ろうとしています。 ---------------------------------------- #!/bin/sh MYSQLDUMP=/usr/local/bin/mysqldump BACKUPDIR=/home/backup DATE=`/bin/date +%F` $MYSQLDUMP -u xxx --password="yyy" --host=mysqlsdb.zzz.rds.amazonaws.com --ssl-ca=mysql-ssl-ca-cert.pem xxx > $BACKUPDIR/xxx_$DATE.sql gzip $BACKUPDIR/*_$DATE.sql find $BACKUPDIR -mtime +7 -exec rm -f {} \; ---------------------------------------- コマンドでスクリプトを実行すると正常に実行されるのですが、cron起動で実行されると、dumpファイルは作成されるのですが、中身が空になります。 cronだと動かないというケースはよく見るのですが、今回の場合、スクリプトが実行されているようです。 何がいけないのでしょうか？
レコード数が多くなると検索を返すのが遅くなりますが 1レコード内のデータ数が増える事で検索結果は遅くなりますか？ 例えば YESかNOの２拓を記録するデータベースがあったとします 　　　　　　　　問1　　　問2　　　問3　　　問4　　　問5 ○○さん　　YES　　　NO　　　YES　　　NO　　　YES □□さん　　NO　　　 YES　　　NO　　　NO　　　YES と記録するか 　　　　　　　　問1　　　問2　　　問3　　　問4　　　問5 ○○さん　　　Y　　　　　　　　　　Y　　　　　　　　　Y □□さん　　　　　　　　Y　　　　　　　　　　　　　　　Y と記録するかで迷っています。 レコード数は変わらないけど、1レコード内に記録される文字数(データ)の量がだいぶ変わります。 数万件のレコード数になった時に、検索結果の返しに変化が無いのであれば 前者の方が、CSVで出力した時とかの見栄えが良いので採用しようと思っています。
MySQL5にて、あるテーブルの特定フィールドの数（つまりcount値）が一定値以上であれば、間引きのため別のフィールドの値で最大値をもつ行を削除するSQLを考案中です。 イメージとしては以下の通りですが、SQLとしては誤っており、また、冗長です。 DELETE FROM table WHERE id={$id} AND (SELECT COUNT(*) FROM table WHERE id={$id}) > 5 AND begin = (SELECT MAX(begin) FROM table WHERE id={$id}); よい知恵をお授けください。
テーブルAにフィールドBとフィールドCがあります。 phpmyadminを使って、フィールドBの値が一致するが、フィールドCの値が不一致のレコードを検索したいと思っています。 このような場合はどのようなクエリを書けばよろしいでしょうか？ よろしくお願いいたします。
お世話になります。 type="file"でアップし、$_FILEで取得したファイル情報をMYSQLに格納、ファイルの実体はサーバー上のフォルダに保存するというシステムを助けてもらいながら作りました。 今度はそれでアップしたファイルをIDとファイル名をキーにして、検索し、ブラウザに表示したいと思っています。行き詰ったので、ネットで調べると、header('Content-type: application/pdf');を使うことは分かったんですが、その他の処理の書き方が分かりません。 どなたか、サンプルを書いていただけないでしょうか？
お世話になります。 全角文字のファイル名のファイルをアップロードすると空白になります。 どうすれば、表示できますか？ mb_convert_encodingを使うんじゃないかとは思っているんですが、どう使えばいいか教えていただけると幸いです。
サブクエリで抽出したカラムを 本クエリでの結果と一緒に表示したいのですが どのように実現してよいかわからず困っております。 詳細としては、下記のようなことをしたいと考えております。 文中の１）と２）は文章下部にあるSQLを指しております ----------------------------------------------------------- 最初は、１）のように凄く単純なSQLでよかったのですが 仕様が変わり、TBL2で取得した新しいカラムも一緒に 本クエリでの結果として取得できれば、SQLを2回実行せずに済むなと考えたのですが、 ２）のように色々と試行錯誤したのですが、実現できません。 (２）は単なる空想ですが…) そこで、わかる方にお伺いしたいのですが、 副問い合わせで取得した複数カラムの中の1つのカラム【２）でいうところのTBL2.X】 を ２）のように"select TBL1.A , TBL2.X"として、結果を得ることは可能でしょうか。 ただし、 TBL1のカラムAは、TBL2に存在しない TBL2のカラムXは、TBL1には存在しない カラムBは、TBL1、TBL2に存在する の条件となっております 環境はMysqlです テーブル結合の方法も考えたのですが、 TBL2で、日付でソートし、その上位100件だけを 持ってきたいと思ったので、副問い合わせで一気に抽出しようとこの方法を考えまし た お分かりになる方がいらっしゃいましたらよろしくお願いします １）SQL ------------ select TBL1.A from TBL1 where TBL1.B in ( select TBL2.B from TBL2 where 条件 ) ２）想像SQL（こんな感じの事をしたい） -------------- select TBL1.A , TBL2.X from TBL1 where TBL1.B in ( select TBL2.B , TBL2.X from TBL2 where 条件 order by TBL2.日付 desc limit 100 )
xamppをインストールしました。mysqlの動作確認をしようとしてmysqladminをクリックしたところ下記のように表示されました。解決方法が分かりましたら教えてください。 MySQLのメッセージ: #1045 - Access denied for user 'root'@'localhost' (using password: NO) MySQL サーバに接続しようとしましたが拒否されました。config.inc.php のホスト、ユーザ名、パスワードが MySQL サーバの管理者から与えられた情報と一致するか確認してください
id name day 　　　st　sh tday 　　　tt th go 2 タモリ 2012/4/18 9 00 1 つるべ 2012/4/16 9 00 2012/4/17 9 09 12 　2 タモリ 2012/4/17 9 00 　1 つるべ 2012/4/17 9 30 上記のようなテーブルがあり、それぞれの最新のdayだけ表示したいです。 理想はこうです。 　1 つるべ 2012/4/17 9 30 2 タモリ 2012/4/18 9 00 現在SELECT a.id,a.name,a.ji,a.pass,b.id,b.name,b.day,b.st,b.sh,b.tday,b.tt,b.th,b.go FROM time AS a, timem AS b WHERE a.id=b.id ORDER BY b.day DESC と命令したら 四つ全部でてしまい、group by a.idを足しても上手くいかないです。 それぞれの新しい日付のものを一件だす方法を教えてください。
お世話になります。 会社名と会社名フリガナがフィールドに存在しています。 そこで、”あかさたなはまやらわ全”で該当するレコードを 検索したいのですが、どのようなクエリを発行すればよいのか 解りません。 どなたか、ご教示いただけませんでしょうか。 よろしくおねがいしますT-T 例： フォームには、”あかさたなはまやらわ全”11個のボタンが付いて おりクリックすると、検索結果が表示される。 環境： C#,MySql
mysql5.1を利用してデータベースを作成しています。 テーブルに年と月を別々で収納しているのですが、 そのテーブルの中のデータから「今月を過ぎていなければ」という条件で抽出したいのですが、 ＳＱＬの書き方がわかりません。 私のＳＱＬの基礎の基礎しか教えてもらっておらず、 あとは独学で、現在のレベルはようやく少しサブクエリを書き出した（学びだした）レベルです。 しかもwindows上のNavicat Lite（アプリ）上で書いてる状態です。 自分のイメージ的には下記のような感じなのですが、動きません。 どなたか教えていただけないでしょうか。 よろしくお願いします。 hoge_tblテーブルからＢカラムが'hoge'かつ、 hoge_tblテーブル内のYEARカラムとMONTHカラムの値を今月と比較して、 「今月を過ぎていなければ」といった条件を付けたいと考えております。 select A from hoge_tbl where B = 'hoge' and (select date_format(now(),'%Y%m') as NOW) < (select date_format('(select YEAR,MONTH from hoge_tbl )’,'%Y%m') as END)
188ページのPHPとDBで本格的なwebシステムを作るというところを勉強しているのですが、PHPをMｙSQLに接続したいのですがサーバーにアップするとWarning: mysql_connect() [function.mysql-connect]: Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2) in /home/sites/heteml/users…/・/・/・/…/web/index.php on line 2 Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2) と出てきます。どのようにしたらアップできるのでしょうか？ 使用しているサーバーはhetemlで動作環境はXAMPPです。localhostでは動きます。 どなたか詳しいかたご教授お願いいたします。宜しくお願い致します！
PHP+MySqlにて会員サイトを作っています。 テーブルに記事を登録して、日付を指定して掲載したいと考えておりますが、うまくいかず困っております。 例えば、2012/06/01～2012/06/15までの期間、特定の記事を掲載したい場合、sql文はどの様に書いたらいいでしょうか？ 2012/06/16以降に、「この記事の記載は終了しました」などの文章も表示させたいです。 +-----+----------+-----------+ |report | start_date |　　last_date | +-----+----------+-----------+ | 記事1| 2012-06-01| 2012-06-15 | | 記事2| 2012-06-16| 2012-06-30 | +-----+------------+---------+ このような感じのテーブルです 勉強不足で質問の意図が分かりにくいと思いますが宜しくお願いします。
初心者で申し訳ないですが、 レンタルサーバで、何故か急にphpMyAdminが消えてしまい（後述）、 マニュアルに沿って再インストールしました。 しかし、mysqli拡張がない。というメッセージが表示され、ログインが出来ません。 mysqli拡張は、どのようにインストールすればよろしいのでしょうか？ （仕様と経緯） ラピッドサイト（RV752　VPS） Red Hat Linux PHPバージョン 　　　　：5.2.9 phpMyAdminバージョン：3.5.0（元々のバージョンは不明です。4年ほど前からのバージョンだったと思います） 数ヶ月前に、Apacheの不具合で、ラピッドサイトのサポートに電話をかけ、調査してもらっている途中から、phpMyAdminが開けなくなりました。 サポートに確認を入れても、「こちらで確認すると、ログインページが表示されている」という返答で、 私自身もサーバにはあまり知識がないため、電話の時にすぐにわかりませんでしたが、 phpMyAdminのディレクトリそのものが全て無くなっていました。 （常識的に考えて、ログインページが出るはずはないです。） 調査確認の際に何らかの操作で消されてしまったのかと思いますが、水掛け論になるのは明白だったため、ラピッドサイトのマニュアルに沿って自分でインストールしましたが、 上記のような症状になり、「せめて考えられる要因を教えて欲しい」と再度電話しましたが、断られました。 DBは問題なかったので、SQLbuddyを代用で入れましたが、 こちらはなぜかどうしても日本語環境に出来ません。（日本語が全て文字化けする） 英数字の部分だけでデータ内容を判断している状態です。
Mysql5.5.22にTomcat7を使用し接続を行っているのですが mysql-connector-java-5.5～.jar というようなJDBCドライバファイルが見つからずに mysql-connector-java-5.1.13-bin.jarを使用しているのですが問題ないでしょうか。 また、mysql-connector-java-5.5.22等は存在しないのでしょうか？ よろしくお願いします。
教えて下さい。 ＭＹＳＱＬではＯＲＡＣＬＥのように、階層構造を検索するような"CONNECT BY" という コマンドは存在しないのでしょうか？？？ 存在しない場合、何か他の方法で階層の上限関係を検索する方法はないでしょうか。。。 教えて下さい。 よろしくお願いします。
phpMyAdminを起動すると お使いになっている PHP の MySQL ライブラリのバージョン 5.0.51a が MySQL サーバのバージョン 5.5.22 と異なります。これは予期しない不具合を起こす可能性があります。 といったエラーメッセージが表示されてしまいます。 Apache 2.4 PHP Version 5.2.17 phpMyAdmin 3.5.0 MySQL Server 5.5 です。 いろいろ調べたのですが、解決策が見つかりませんでした。 ご教示を頂けないでしょうか。お願い致します。
30万件ほどデータがあるテーブルtableがあります。 フィールドyearにそのデータが作成された西暦が4桁のint型で記されているのですが、 これを1年ごとに分割してテーブルを生成したいです。 ---------- table (id はオートインクリメント) id name year info 1 aaaa　2011　aaaaaaaa　　 2 bbbb　2012　bbbbbbbb 3 cccc 2010　ccccccc 4 dddd 2012 　dddddddd 5 eeee 2011 　eeeeeee ： ： ↓ table2010 id name year info 1 cccc 2010　ccccccc ： ： table2011 id name year info 1 aaaa　2011　aaaaaaaa 2 eeee 2011 　eeeeeee ： ： table2012 id name year info 1 bbbb　2012　bbbbbbbb 2 dddd 2012 　dddddddd ： ： ------------ データが数十件ならphpmyadminを駆使するのですが、今回はデータ量が多いこともあり、 これらを上手に分ける方法となると現在の私の力では難しいです。 このような形でテーブルを分割する方法を教えてください。 よろしくお願いします。
pdfファイルの管理システムを作っています。 ファイルの置き場をきめて、ファイル名を任意に置き換え、 ファイルの情報だけDBに登録したいのですが、簡単にサンプルphpスクリプトを書いてもらえませんか？
サブクエリの条件で取得したデータの総数と、更にのその中でフラグ(カラム)が1のデータ数を同時に知りたいです。 SELECT count(flag) as flagNum FROM info WHERE flag = 1 AND id = (サブクエリ); これだと条件一致データ数はわかりますが、フラグがいくつであろうと関係ない総数がわかりません。 また別個にcount(*)する手もありますが、単純なデータの総数でなくサブクエリが絡んできますので、同じようなクエリを２回やるのは可能なら避けたいです。 SQL_CALC_FOUND_ROWSとFOUND_ROWS()を使ったパターンも試してみたのですが、うまくいく手を見つけられませんでした。 何かいい方法がないものでしょうか。
テーブルUserにCreatedフィールドとUpdatedフィールドがあります。 合計1000レコードあり、それぞれのレコードのCreatedの値をUpdatedにコピーしたいのですが コマンドはどのようになりますでしょうか？ phpのwhile関数を使なければ不可能でしょうか？ ご教示頂けると幸いです。 宜しくお願い致します。
htmlのフォームタグ内で、input type=file で受け取ったPDFファイルを phpスクリプトで、MYSQLのデータベースへ保存したいのですが どのように書けばいいのかわかりません。 保存する型はBLOB型でよいといくつかのサイトで書いてあるのですが、 SQL文の書き方や、フォームから受け取ったデータの処理の仕方などの詳細が わかりません。 フォームで受け取ったファイルをデータベース（mysql）へ保存する 簡単なサンプルコードなどが知りたいです。 よろしくお願いいたします。
MySQL 5にて以下のテーブルがあると仮定します。 ----- |A|B| ----- |1|1| |1|2| |1|4| |2|1| |2|2| |3|2| |3|4| |4|1| |4|3| |4|5| ----- ここで、Aが特定の番号の時、B値のいずれかを持つ列のA値を取得したいと考えています（たとえばA=4のとき、[1,3,5]のいずれかが含まれているA=[1,2]が返ります）。これを実装するにはどのようなクエリを記述すればいいでしょうか。
vertualboxで仮想サーバーを作り、そこでmysqlを動かしていました。 mysqlをアンインストールにあたり、間違えてvertualbox を先にアンインストールしてしまいました。 この場合、mysqlはそのまま一緒にアンインストールされている状態になるのでしょうか？ 御教示お願いします。
ＭｙＳＱＬでorder by句を使った並び替えができず困っています。 Mysqlバージョン　5.0．77 エンコード　euc-jp 全角カタカナでフリガナが入っているフィールドがあり、その項目でソートをかけようとしていますがうまくいきません。 /etc/my.cnfの[mysqld][client]にはそれぞれ default-character-set=ujis を設定しています。 それ以外に何か設定しなくてはならない項目があるのでしょうか? 設定以外でも何か上手くソートできる方法があれば教えてください。 よろしくお願いいたします。
商品検索、レビュー検索、仕事検索と 多くの検索サイトがあると思います。 DBを使用しないで そのようなサイトを作成した場合 情報の管理は、手入力になるのでしょうか？ (CSVとかも可能かとは思いますが…) やはり、普通検索サイトの構築には DBを使用すると考えてもよいのでしょうか？
これまでとは異なる新規掲示板へデータ移行したいのですが、 データベース(MySQL)のカラム構成が違うため、 どうすればスムーズに移行できるか、やり方が分かりません。 普通は、どうやるのでしょうか？ 案1.全データをdumpして、どうにかして加工した後、全データを入れる 案2.dumpする時点で、どうにかして加工した後、全データを入れる 案3.1カラムずつdumpして、1カラムずつ入れる 案4.何かツールを使う(もしあればですが…) 案5.その他 データ加工(?)を これまで一度もやったことがないため、 どう取り組んだら良いか、分かりません…
MYSQL・PostgreSQLにてデータベースを作成できる権限をもつユーザを作成することは可能でしょうか？ やりたいことは、ユーザAとユーザBを作成し、それぞれ新規にデータベースを作成してもらいます。 ユーザAの作成したデータベースは、ユーザAは自由に操作できますが、 ユーザBでは見ることも触ることもできない状態にしたいのです。 いろいろググってみたのですが、データベースに対して権限を与えるようなものしか見当たりませんでした。 よろしくお願いします。
select table1.*, table2.no from table1 inner left outer join table2 on table1.id = table2.no 上記の文を使って、一致した値がなくても、 すべて表示させた表を完成させたいのですが、 エラー #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'left outer join table2 on table1.id = table2.no～ が出てしまいます。 何がいけないのか、LEFT OUTERなしでやってみると、 きちんと値が返ってきました。 詳しい方いらっしゃいましたら、どうかお知恵を貸してください。 お願いいたします。
sennaの全文検索について質問です。 Tritonn（senna+MySQL）を導入しました。 http://qwik.jp/senna/FrontPageJ.html A、B、C、D、E、Fを日本語の単語とします。 次のキーワードをすべて含む：A、B 次のキーワードのいずれかを含む：C、D 次のキーワードを含まない：E、F という条件で抽出を行いたいです。 この検索の結果、AかつBかつ（CもしくはD）を含むデータのうち、EとFを含まないものを抽出します。 このようなクエリはどのように書けばいいのでしょうか。 AND、OR、NOT単体でしたら書くことができますが、これらの複合文は文例がなかったのでわかりませんでした。 よろしくお願いします。
次のような場合は、ライセンスはどうなるのでしょうか？ お客様のサーバ（Ａサーバ）に、MySQL Community Serverがインストールされています。 Ａサーバに、開発会社が作成したＷｅｂシステム（MySQL利用）を導入した場合、 ライセンス費用はどのように考えたらよいでしょうか？
サーバが高負荷になると、まず、サイトにアクセスできなくなり最終的にはサーバが落ちてしまいます。 エラー内容を、検索サイトにて検索してもでてきません。 環境としましては、OSにCentOS6.2を使用し、OpenPNE3.6をApache経由で使用しています。 高負荷時には、ＣＰＵ使用率は1～３％と低いです。 2GBある物理メモリの使用率は85%程度、ＳＷＡＰの使用率は70%程度です。 Apacchのerror_logの中身はこのようになっていました。 どなたか対象方法がわかる方がいたら教えていただけませんか？ よろしくお願いいたします。 2358 [Mon Mar 12 07:36:06 2012] [error] [client ...] PDO Connection Error: SQLSTATE[HY000] [2013] Lost connection to MySQL server at 'waiting for initia l communication packet', system error: 95$ 2359 [Mon Mar 12 07:36:07 2012] [error] [client ...] PDO Connection Error: SQLSTATE[HY000] [2013] Lost connection to MySQL server at 'waiting for initia l communication packet', system error: 95$ 2360 [Mon Mar 12 07:36:11 2012] [error] server reached MaxClients setting, consider raising the MaxClients setting$ 2361 [Mon Mar 12 07:36:20 2012] [error] [client ...] PDO Connection Error: SQLSTATE[HY000] [2013] Lost connection to MySQL server at 'waiting for initia l communication packet', system error: 95$ 2362 [Mon Mar 12 07:36:10 2012] [error] [client ...] PDO Connection Error: SQLSTATE[HY000] [1040] Too many connections$ 2363 [Mon Mar 12 07:36:48 2012] [error] [client ...] PDO Connection Error: SQLSTATE[HY000] [1040] Too many connections$ 2364 [Mon Mar 12 07:36:52 2012] [error] [client ...] PDO Connection Error: SQLSTATE[HY000] [2013] Lost connection to MySQL server at 'waiting for initia l communication packet', system error: 95$ 2365 [Mon Mar 12 07:36:26 2012] [error] [client ...] PDO Connection Error: SQLSTATE[HY000] [2013] Lost connection to MySQL server at 'waiting for initia l communication packet', system error: 95$ 2366 [Mon Mar 12 07:38:07 2012] [error] [client ...] PDO Connection Error: SQLSTATE[HY000] [2013] Lost connection to MySQL server at 'waiting for initia l communication packet', system error: 95$ 2367 [Mon Mar 12 07:37:17 2012] [error] [client ...] PDO Connection Error: SQLSTATE[HY000] [2013] Lost connection to MySQL server at 'waiting for initia l communication packet', system error: 95$ 2368 [Mon Mar 12 07:38:24 2012] [error] [client ...] PDO Connection Error: SQLSTATE[HY000] [2013] Lost connection to MySQL server at 'waiting for initia l communication packet', system error: 95$ 2369 [Mon Mar 12 07:38:37 2012] [error] [client ...] PDO Connection Error: SQLSTATE[HY000] [2013] Lost connection to MySQL server at 'waiting for initia l communication packet', system error: 95$
最近phpmyadminを使い始めたmysqlの初心者です。 テーブルAにはフィールドC（int(10)）とフィールドD（varchar(32)）があります。 テーブルBにはフィールドE（int(10)）とフィールドF（text）があります。 フィールドCとフィールドEは同じキーです。（申し訳ありません。正しい表現方法がわかりません。） テーブルAのレコードの中でフィールドDの値がXYZのものであるときのみ、フィールドCをフィールドEに入れたレコードをテーブルBに作りたいと思っています。この場合、どのようなクエリを書いたらよろしいでしょうか？ よろしくお願いいたします。
２つのテーブルからデータを取得します。 FKがstaff_idになります。 ●staff_tbl staff_id　staff_name　staff_group 1　　　　　田中　　　　　A　 2　　　　　鈴木　　　　　A 3　　　　　森田　　　　　B ●value_tbl staff_id　value_name　value 1　　　　　area　　　　　大阪 1　　　　　year　　　　　　5 1　　　　　pay　　　　　　1000 2　　　　　area　　　　　奈良 2　　　　　year　　　　　　2 2　　　　　pay　　　　　　900 テーブルのサンプルはこのようなイメージです。 結果を下記のように取得したいのですが。。。 1 田中 A　大阪　 5　1000 2 鈴木 A　奈良　 2　900 サブクエリを使うのか？TOを使うのか、ググって何度か試したけども いまいちわかりませんでした。 どのようなSQLになるんでしょうか？ すいませんが、よろしくお願いします。
恐れ入ります。 input 送信で、perl にてレコードをinsertしたいのですが、なかなかうまくいきません。 <form action="./xxx.cgi" method="post"> <input type ="hidden" name=num></input> <input type="text" name="col1"></input> <input type="text" name="col2"></input> <input type="text" name="col3"></input> <input type="submit" value="登録"> </form> として送信して、 $sql = "insert into kensou(num,col1,col2,col3) "; $sql.="values('$form{num}','$form{col1}','$form{col2}','$form{col3}')"; # SQL実行 $sth = $db->prepare($sql); if(!$sth->execute){ print "SQL失敗\n"; exit; } で受け取ろうとしているのですが、うまくいきません。 どなたかご教授いただけないでしょうか。
あるデータベースの中に、テーブルAとテーブルBがあります。 テーブルAにはレコードが600件ほど登録されています。 テーブルBは、テーブルAと同じ構造を持ち、レコードが100件ほど登録されています。 この２つのテーブルについて、次のような動作を行うSQL文が知りたいです。 ---------------------------------------------------- テーブルBの任意のレコードについて、「そのレコードのURLの値」と同じURLの値を持つレコードがテーブルAに登録されてない場合、レコードをAに登録する。 なお実行の際、比較するのはURLの値のみであり、URLが同じなら他の値が異なっても登録しないものとする。 ---------------------------------------------------- たとえば、 テーブルA NAME URL　（フィールド名） a aaa.com b bbb.com c ccc.com d ddd.com e eee.com テーブルB NAME URL　（フィールド名） d ddd.com y eee.com f fff.com g ggg.com としたとき、そのSQL文を実行すると、 テーブルA NAME URL　（フィールド名） a aaa.com b bbb.com c ccc.com d ddd.com e eee.com f fff.com g ggg.com となります。 最初はテーブルBをPHPで読み込み、レコード一つ一つを登録済みかチェックしてテーブルAに登録する、という方法を考えました。 しかし、SQLを使っている以上、もっといい方法があるのではないかと思い、質問させていただきました。 このような動作を行うSQL文をどなたか教えてください。 よろしくお願いします。
下記の手順に従って、Windows2008からWordPressをインストールしました。 http://www.sa-sa-ki.jp/blog/2010/01/windows-web- … サーバー...Windows 2008サーバー My SQL...5.1 IIS...7.5 PHP...PHP 5.2.12 です。 社内でのイントラネットとしていて、運用上まったく問題ないのですが。 WordPressですが、新規投稿から日本語ファイル名をアップしますと文字化けします。 具体的には、 1) 「hoge.xls」というファイルをアップします。 2) 【blog\wp-content\uploads】に「hoge.xls」というファイルがアップされます。 3) 閲覧画面からは、そのファイルを選ぶと、 http://server-name.com/blog/wp-content/uploads/2 …にリンクして、問題なくダウンロードできます。 ところが 1) 「日本語.xls」というファイル名をアップすると、 2)【blog\wp-content\uploads】には、「日本語.xls」ではなく「繧鍋畑.xls」というファイル名でアップされます。 3) 閲覧画面からそのファイルを選ぶと、そのリンク先は、http://server-name.com/blog/wp-content/uploads/2 …日本語.xls になり、ダウンロードを試みると当然404エラーになります。 4) なんで【blog\wp-content\uploads】内の文字化けしたファイルを「日本語.xls」に変えて2)から再度ダウンロードを試みると問題なくダウンロードできます。 つまり、アップのときの文字化けする問題が克服できれば、解決できます。 どなたかご教授いただけまでんでしょうか。
テーブルphonelistのsiteurlフィールドにURLが多数入っています。 URLの末尾はhttp://xxx.com/などとスラッシュで終わることを前提としていますが、データのいくつかはhttp://xxx.comなどとスラッシュで終わらないものがあるようです。 現在、このテーブルのデータを基にPHPを動作させたのですが、スラッシュで終わらないもののみ正常に動作しなかったようです。 もう一度プログラムを動かすために、末尾がスラッシュで終わらないデータのみ抜き出したいですが、自分ではうまくいきません。 SELECT * FROM phonelist WHERE NOT siteurl LIKE "*\/$"; みたいに、私も上のようなSQLをいろいろと試しましたが、どうやってもsiteurlの登録データのすべてが検出されてしまいます。 どなたか末尾がスラッシュではないURLのみを抜き出すSQL文を教えてください。 よろしくお願いします。
MySQL + PHPのAUTH認証で会員制サイトを作成しています。 一度ログインすると、 ◎　●●さんようこそ。と会員名で表示される。 ◎　会員サイトのどのページに移動しても、会員名、会員IDをキャッシュとして持ち 　　歩くことが出来、サイト内の掲示板では自分のユーザー名を入力することなしに、 　　自分のIDが自動で記入される ようにしたいと考えています。 PEAR:AuthやcodeigniterのTank Authのようなフレームワークにはこのような機能 が備わっておりますが、今回のサイトは軽さを重視しているため、これらを利用する 気になれません。(cakePHPなどその他のフレームワーク含) 「MySQL + PHPのAUTH認証」で、PEAR DBやフレームワークを使わないやり方で、 ログインしたID名やハンドル名をキャッシュとしてサイト内で持ち歩くように出来る 方法は御座いませんでしょうか? postgreSQLにはあるようなのですが、MySQLではWEBで見つけることができません でした。 宜しくお願い致します。
お世話になります。 いくら考えても正解が出てこないので、どうかご教示願えますでしょうか ▄█▀█● 使用SQL： MySQL 要件： 現在時刻が、設定した時間内かどうかを判定したい。 例： (1)１～１６時の設定 ：現在１４時なら該当 (2)１４時～１時の設定：現在０時なら該当 そもそも時間の”型”も、どれにすれば良いか解らず、現在”TIME”です。 start_time 14:00 end_time 01:00 (1)のように、範囲が≦で囲める場合は問題ないのですが （１時＜１６時） (2)のように、≧の場合、どのように条件を書けば良いか分かりません。 （１４時＞１時） では、(2)をTimeStampで設定した場合 start_time ０日14:00 end_time １日01:00 のようになるかと思いますが、抽出時は何時になるのでしょうか？ 例えば、上記設定がされているレコードに対し現在時刻が1:00の場合 start_time ≦ 1:00 ≦ end_time とするかと思いますが、1:00というのは０日ですか１日ですか？？ そうこう考え始めると何が何やら理解できなくなりました。 どうかヘルプください。。
初学者で、ドットインストールと言うサイトで勉強しています。 vertual box hoster cyber duck でローカル環境を構築しました。 mysqlをこれから始めようと思うのですが、上記のソフトで構築した環境をまず起動した上でmysqlを起動するのだと思います。 ローカル環境構築をしたのはいいのですが、mysqlをスタートするに当たりどういう手順でどう起動させればいいのかいまいちよくわかりません。 ローカル環境を起動する段階からどういう手順を踏みmysqlの起動をすればいいのか、御教示ください。
以下の様な3つのテーブルがあり、それぞれのテーブルを連結して結果を取得したいと思っております。 この場合のSQL文をご教授いただけないでしょうか？ 拙い説明でお分かりに難いかと思いますが、何卒、宜しくお願いします。 ●テーブル T1(科目テーブル) 科目ID, 科目名 T2(生徒テーブル) 生徒ID, 生徒名 T3(科目選択テーブル) 科目ID, 生徒ID（科目ID, 生徒IDで連結キー） ●期待出力結果イメージ ※例1）生徒ID=1の場合 科目ID | 科目名 | 生徒ID | 生徒名 ------------------------------------- 1 | 国語 | 1 | 山田太郎 ------------------------------------- 2 | 算数 | 1 | 山田太郎 ------------------------------------- 3 | 理科 | null | null ------------------------------------- 4 | 社会 | null | null ------------------------------------- 5 | 英語 | 1 | 山田太郎 ※例2）生徒ID=2の場合 科目ID | 科目名 | 生徒ID | 生徒名 ------------------------------------- 1 | 国語 | null | null ------------------------------------- 2 | 算数 | null | null ------------------------------------- 3 | 理科 | null | null ------------------------------------- 4 | 社会 | null | null ------------------------------------- 5 | 英語 | 2 | 鈴木花子 ●出力条件 科目テーブルの科目ID, 科目名は全て表示する。 T3(科目選択テーブル)に存在する生徒IDがあれば、その生徒ID、生徒名を表示する。 存在しない場合は、それぞれ「null」として表示する。 出力は生徒IDを条件とする。 何卒、宜しくお願いします。 ※因みに使用DBはMySQL5.1.44です。
地域別職業別電話帳を作っています。 テーブルは下記の3つです。 市町村テーブル 01city(a1 INT NOT NULL PRIMARY KEY,a2_pre_id INT,a3_pre_name TEXT,a4_city_id INT,a5_city_name TEXT,a6_city_name_kana TEXT); 職業テーブル 03works(c1 INT NOT NULL PRIMARY KEY,c2_work TEXT,c3_aiu TEXT,c4_aiu_id INT); 会社名テーブル tokyo(company TEXT NOT NULL,zip TEXT,address TEXT,tel text,fax TEXT,freedial TEXT,industryA TEXT,hp TEXT,mail TEXT,comment1 TEXT,coid INT NOT NULL AUTO_INCREMENT PRIMARY KEY,industry1 TEXT,zip_id INT,pre_name TEXT,city_name TEXT,induid INT,cityid INT); 会社名の表示については下記のような表示により、13101(千代田区)の104(ラーメン)屋リストを表示出来るようには設定しました。 (クエリー表示を　/13101/104/ で表示出来るように　.htaccess で指定しています。) http://127.0.0.1/ccs/result/13101/104/ 次に、これを指定するためには、ユーザーが、千代田区(13101)　ラーメン(104)　と指定したら、http://127.0.0.1/ccs/result/13101/104/のURLが表示出来ることにすれば完成となりますが、ここで躓いてしまいました。 千代田区の職業別一覧なら SELECT * FROM `01city` WHERE a4_city_id = 13101" で表示可能です。 東京のラーメン屋だけなら、 SELECT * FROM `03works` WHERE c1 = 104" で表示な可能です。 しかし、千代田区のラーメン屋になると、拾ってくるID(a4_city_id、c1)のテーブルがそれぞれ別のテーブル(01city、03works)のため、http://127.0.0.1/ccs/result/13101/104/のように並べて表示させることができません。 join関数は、２つのテーブルにキーとなる同じデータがあって初めて結合が可能ですが、今回の場合は、キーとなる同じデータがありません。 普通にありそうな例なのですが、どうすれば可能でしょうか? 基礎的な部分なのかもしれませんが、どうぞ宜しくお願い致します。
恐れ入ります。 以下のようなデータがあり、 id 　t1 　 1 |500000| 2 |300000| 3 |200000| ・　　・ ・　　・ ・　　・ ・　　・ これを、id1-2=3 をt1カラムで実施したり、 id 3から　12までのt1を合計したりということをしたいのですが、 可能でしょうか。よろしくお願いします。
最近インデックスについて学びはじめ、まだ理解が浅いのでお伺いしたいです。 携帯会員制サイトを例に質問させてください。 ユーザーは会員登録時に固体識別番号を登録し、この情報はUIDというフィールドに記録され、既に100万レコード存在したとします。 ドコモの固体識別番号は35から始まり AUは05もしくは07からはじまり ソフトバンクはSNから始まります。 全てのユーザーの最初の2文字の固体識別番号は4通りのいずれかとなってしまいます。 固体識別番号を登録する時点で、暗号化し、最初の一文字目をa-zA-Z0-9の62種類にした方が、簡単ログイン時の処理速度は速くなるといえるでしょうか？ ご教示頂けると幸いです。 宜しくお願い致します。
以下のようなデータがあって、分単位での統計情報を出すにはどうすればいいのでようか。 time（Unix_time)　 　count_1 count_2 count_3 ----------------------------------------- 2012-02-23 13:01 　　0 　 2 　 0 2012-02-23 13:01 　　1 　1 　 0 2012-02-23 13:01 　　2 　2 　 3 2012-02-23 13:01 　　0 　2 　 0 2012-02-23 13:01 　　1 　5 　 2 2012-02-23 13:02 　　1 　2 　 2 2012-02-23 13:02 　 　0 　1 　 2 2012-02-23 13:02 　　1 　1 　 0 ↓　↓　↓ 以下のように出力させたい time（Unix_time)　 　count_1 count_2 count_3 ----------------------------------------- 2012-02-23 13:01 　　4 　 12 　 5 2012-02-23 13:02 　　2 　 4 　 4 よろしくお願いします。
IDint(10)UNSIGNED STAFFint(10)UNSIGNED SUBJECTvarchar(128) MSGtext RCVdatetime と言うテーブルがあります。スタッフは外部キーで、複数のレコードに同一のスタッフが存在します。 このテーブルから、スタッフでGROUP BYしてRCVが直近のものを取り出すSQLはどう書けば宜しいでしょうか？ 宜しくお願い致します。
SQLで、ある特定のフィールドの値を一斉に変更する方法はあるでしょうか。 NAMEフィールドがあるとして、その値を問わずすべての行のNAMEフィールドに文字列checkを代入したいのです。 NAME　 URL　（←フィールド名） check　aaa.com nochk bbb.com check　ccc.com NULL　ddd.com nochk　eee.com ： みたいなテーブルだと NAME　 URL　 check　aaa.com check bbb.com check　ccc.com check　ddd.com check　eee.com ： に一括変更するような方法です。 NAMEの中には既にcheckと記入されたものもあります。またcheck以外にのnochkと入力されたものもあり、NULLもあります。 300行ほどあり、すべてにUPDATEを適用するのは難しいので、何かしらよい方法があれば教えていただきたいと思い、質問させていただきました。 よろしくお願いします。
環境はLinux CentOS5.7 Apache MySQL5 PHP 会社のシステム管理者からこうなったらどうしますか？と聞かれたのですが システムの事はよくわかっていないのでご教示お願い致します。 私は興味があると、つい聞いてしまって逆に質問されて困っています。 PHPで動いているソフトがありまして そのソフトというのは、企業情報の一覧で出てきて そこに一件一件電話営業をかけて 商談の結果等を打ち込んでいくというものですが 企業情報や商談結果がMySQLのデータベースに収められています。 そこで聞かれた事が 毎朝9時にMySQLのバックアップを取っているとして AM9時から11時まで従業員が電話をして打ち込んだ商談結果があったが 何らかの原因でデータが壊れてしまった。 その間のバックアップは取っていない。 9～11時までのデータはどうやって戻せるででしょうかというものです。 9時に取っているバックアップを復元してしまうと9～11時までの商談データは 消えてしまいますよね。 バックアップを取っていないデータを戻す方法ってあるのでしょうか。
select 1000 - sum(縦 * 横 * 高さ * table1.個数 * 10) As SIZE1, 2000 - sum(縦 * 横 * 高さ * table1.個数 * 10) As SIZE2, 3000 - sum(縦 * 横 * 高さ * table1.個数 * 10) As SIZE3 from table1 といったようなSQL文があったとします。 ○　- sum(縦 * 横 * 高さ * table1.個数 * 10)の中の、 sum(縦 * 横 * 高さ * table1.個数 * 10)は共通です。 この部分を共通化させる方法はあるのでしょうか？ 例えばイメージとして、 string X = "sum(縦 * 横 * 高さ * table1.個数 * 10)" 1000 - X とやれば見やすいです。 SQLで上記のような方法が使えないのはわかるのですが、何か上手なやり方はあるでしょうか？ 環境はMYSQL5.5 Win 7です。
select UserNAME, Joined from tUser where UserNAME = testname; 上記のtUserテーブルのレコード数が数百万あった場合は testnameというユーザーネームを探すのに数百万行全てを検索して時間が掛かってしまいますが、 ユーザーの登録日であるJoinedが本日の日付を表しているレコードのみを検索対象とし、速度を早くしたいです。 今日登録されたユーザーの中から情報を取得したいので、過去の登録情報まで検索対象として無駄な負荷を掛けたくないのです。 ORDER BY Joined DESC　でJoinedを降順にして本日登録のあったデータをトップに持ってこれば良いと思うのですが、その後がわかりません。 日付が本日以外になった場合検索を終了させたいです。 ご教示頂けると幸いです。 宜しくお願い致します
＿＿＿＿＿＿ name　　age a　　　　　16 b　　　　　20 c　　　　　56 d　　　　　99 ＿＿＿＿＿＿ 上記のようなDB名A、TB名Bがあるとします。 php側で name b　の age を変数に 代入したいのですが、どうしたらできますか？
サブクエリについてお教え下さい リレーションの事がしっかりわかっていないでおうかがいします。 下記のようなデータがあります。 T_ANIMALとT_SIZEの間にはリレーションがありません。 テーブル名 T_ANIMAL ID,NAME 001,猫 002,犬 003,猿 テーブル名 T_SIZE SIZE_ID,SIZE A,100 B,200 C,300 下記のSQLを実行しましたが、シンタックスエラーと出ました。 Select ID,NAME, (Select SIZE from T_SIZE where SIZE_ID = 'A') from T_ANIMAL 下記のような出力希望結果を出すのは無理なのでしょうか？ 出力希望結果 001,猫,100 002,犬,100 003,猿,100 リレーションが無いテーブルから情報を引っ張ってきて表示したいです。 よろしくお願いいたします。 環境はWin 7 HomeとMYSQL5.0です。
ERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES) 久しぶりに使おうと起動したところ、mysqlにログインできなくなっていました。 以前は動いており、テーブルを作っていました。パスワードは保存していましたので、間違いはないと思います。phpやapacheは最初からマシンに入っているもの、mySQLは直接最新のソースを取ってきてインストールしていたものです。lamp？とかそういうのではないです。 ほとんどのコマンドが上記のエラーを発します。 MySQLのlocalhostの設定の確認＆変更の方法などはあるのでしょうか？ （関係あるかどうかわかりませんが、ローカルのAPACHEはPHPも処理できます。問題なく動いています。） MySQLのルートユーザのパスワードを一から設定しなおそうとも試みて、mySQLの公式サイトの指示通りにcnfファイルにオプションを追加してから再起動し、 mysqladmin -u root password 'mynewpassword' を実行しましたが、 これも冒頭のエラーが出て受け付けてくれません。 その他エラーが出るケース ・mysqladmin ping -u root -p 　Enter password: （パスワード入力すると） 　mysqladmin: connect to server at 'localhost' failed 　error: 'Access denied for user 'root'@'localhost' (using password: YES)' よろしくおねがいします。
XAMPPでPHPとMySQLを使っています。 しかし、そのまま使うと文字化けが起きてしまいます。調べると「UTF-8」にすることで文字化けが起こらないとのことなので変更をし、以下のように全てutf-8に書き換えることができました。 mysql> show variables like 'char%' -> ; +--------------------------+----------------------------------------+ | Variable_name | Value | +--------------------------+----------------------------------------+ | character_set_client | utf8 | | character_set_connection | utf8 | | character_set_database | utf8 | | character_set_filesystem | binary | | character_set_results | utf8 | | character_set_server | utf8 | | character_set_system | utf8 | | character_sets_dir | D:\program\xampp\mysql\share\charsets\ | +--------------------------+----------------------------------------+ しかし、それでも文字化けは直りませんでした。以下のコマンドで原因を確かめてみました。 mysql> use testdb; Database changed mysql> status -------------- Server characterset: utf8 Db characterset: latin1 Client characterset: utf8 Conn. characterset: utf8 Db characterset: latin1が原因だと思い、以下のコマンドを実行しました。 alter database testDB character set utf8; そしてもう一度テーブルを作りなおすと今度は文字化けどころか空白になってしまいました。 なにが原因で文字化け等が起こっているのか分かりません。助けてください。 ＯＳは Windows Vista です。 バージョンは ApacheFriends XAMPP version 1.7.7 + Apache 2.2.21 + MySQL 5.5.16 (Community Server) + PHP 5.3.8 (VC9 X86 32bit thread safe) + PEAR です。 回答よろしくお願いいたします。
下記の2つのテーブルより、各顧客が最後に売れた日を抽出したいのですがうまくいきません。 顧客テーブル kokyaku_id kokyaku_name 1 aaa 2 bbb 3 ccc 4 ddd 売上テーブル uriage_date kokyaku_id kingaku 2000-1-1 1 100 2011-12-1 2 200 2010-2-2 2 300 2009-3-1 1 50 2006-5-29 3 300 2007 3 400 2012-9-20 3 100 kokyaku_name | uriage_date aaa | 2009-3-1 bbb | 2011-12-1 ccc | 2012-9-20 顧客dddは売上がないので当然結果には出てこなくてOKです。 何結合でどのようなクエリにすればよろしいでしょうか。 まだDBを初めて2週間なので、ご教示お願い致します。
MySQLで複数のデータベースを一つにまとめる方法はありますか？ 複数のデータベースは、それぞれ違うデータが入っています。
現在mySQLを使って、SQL文の勉強をしているのですがわからないことがあり、質問させていただきました。 テーブル同士をINNER JOINして結果を取得して、これに対してさらに別の処理（Whereなど)を行いたいのですが、うまくやり方がわかりません。 具体的にSQL文でいうとこんな感じです（ただしエラーが出て動きません）。 SELECT cmaster.comic_id,tags,title FROM mysql.comic_tag as ctag INNER JOIN mysql.comicmaster as cmaster ON ctag.comic_id = cmaster.comic_id AND WHERE tags = 'aa' この処理でやりたいことを説明するとcomic_tagとcomicmasterを結合して、その結果に対してさらにWhereでデータを絞るということしています。 このような場合はどのように処理をしたらいいんでしょうか？またjoinした後のデータを、既存のテーブルのように扱いたいのですが、なにか方法はないのでしょうか？
SQLのinner joinについてお教え下さい。環境はWin 7 MYQL5です。 t1テーブルのデータ ID,在庫 001,22 t2テーブルのデータ ID,出庫 001,17 001,3 SELECT Sum(t1.stock) AS `在庫` FROM t1 where id = '001' 上記SQLの結果は22と表示されます。 SELECT Sum(t1.stock) AS `在庫` FROM t1 INNER JOIN t2 on t1.id = t2.id where id = '001' とやると、結果が44になってしまいます。 なぜそんな結果になってしまうのでしょうか？ 結果はt1.stockは在庫22なので、22と表示するようにしたいです。 よろしくお願いいたします。
データベースに関してまったくの素人なので教えてください。 簡単にショップを作れるというサイト構築アプリがあるのですが、 「データベースを使えるサーバーで動作します」となっています。 とりあえずロリポップのロリポプランでサーバーを借りて１サイト作ってみました。 ロリポプランは、使えるデータベースは１つです。 そこで、このアプリを使って何個もサイトを作る場合、 データベース１つで何個もできるものなのでしょうか？ それとも、データベース１つにつき１サイトですか？ データベースがどういうものか全然わかってないもので・・・＾＾； サーバーのプランを変更しなければいけないのかどうか知りたいので、教えてください。
トランザクション無しのDBを作成後 create table test(a timestmap, b timestamp); テーブルを作成し insert into test values(now(),now()); データを挿入 update test set a = now(); で更新するのは大丈夫（a>b）なのですが update test set b = now(); を実行するとaにbにコピーされて同じ(a=b)になってしまいます これはDBの仕様ですか？回避方法があれば教えてください windows vista sp1 mysql 5.1
SQL文で、いわゆるIF文のような動作を行いたいのですが、 調べてもいまいちわからなかったので質問させてください。 name、mail、ageフィールドがあり、いくらかのレコードが入っています。 sa　　sa@a.com　11 si　　sa@a.com　12 su　　sa@a.com　13 se　　sa@a.com　14 so　　sa@a.com　15 ここに、次の3つのレコード（nameはnull） 　　　sa@a.com　21 　　　si@a.com　22 　　　su@a.com　23 を挿入しようと思います。 挿入レコードのmailフィールドの値が、すでに登録済みのあるレコードの値と同じなら、 このレコードに対して、新しいデータをUPDATEします。 登録済みのレコードに対して、 挿入するレコードにあるデータ（この場合はage）はUPDATEし、 挿入するレコードにないデータ（この場合はname）はそのまま更新します。 mailが違うなら、そのままINSERTを行います。 上の例だと実行結果は sa　　sa@a.com　21 si　　si@a.com　22 su　　su@a.com　23 se　　se@a.com　14 so　　so@a.com　15 となるのですが、このようなSQL文を教えてください。
MySQLでのアップデートがうまくいかないので質問させていただきます。 やりたいこととしては、ログイン後、ID（customer_code)がDBにあれば、該当する行のデータを画面に表示させ、もし入力値を変更する場合は画面上で変更、「更新」ボタンを押すと、そのままDBに反映させる（update)という動きです。 未ログイン時の動きは思ったように実現できています。 var_dump( $res );　としたところ、bool(false)がかえってきたため、SQLの値がうまく戻ってきていないことがわかりました。 また、print mysql_error($conn); としたところ、「You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'comment = 'XXXX', university = 'XXXXX', favorite_sports = 'XXXXX', ' at line 1 」というようなエラーがかえってきました。 ※XXXの所は、画面で入力した文字が入っています。 1点気になっているのは、comment = 'XXXX', university = 'XXXXX', favorite_sports　以外に　seibetsu　などの値も変更しているのに、上部のエラー内容にのってこないこと　です。 （的を得ているかわかりませんが・・。） もともとのコードは、正常に動くものからコピーをし、値の部分を適当なものに変えています。 カンマなどが間違っているのかと思い、何度か最初から試してみましたが、いっこうに変化がないため、質問させていただいた次第です。 以下のupdateのコードで何かおかしな所があればご教授いただければと思います。 よろしくお願いします。 /**----------------------------------------------------------- * * 会員登録画面で「更新」ボタンがクリックされた時の処理。 * ログイン状態に応じて、UPDATE または INSERT を実行する。 * ------------------------------------------------------------*/ if( $_REQUEST["cmd"] == "regist_member" ) { if( $_SESSION["customer_code"] != "" ) { // ここに、ログイン済の場合の処理を記述。 $sql = " update DBpractice set "; $sql .= " customer_code = '" . $_REQUEST["customer_code"] . "',"; $sql .= " pass = '" . $_REQUEST["pass"] . "',"; $sql .= " name = '" . $_REQUEST["name"] . "',"; $sql .= " mail = '" . $_REQUEST["mail"] . "'"; $sql .= " comment = '" . $_REQUEST["comment"] . "',"; $sql .= " university = '" . $_REQUEST["university"] . "',"; $sql .= " favorite_sports = '" . $_REQUEST["favorite_sports"] . "',"; $sql .= " seibetsu = '" . $_REQUEST["seibetsu"] . "',"; $sql .= " where customer_code = '" . $_SESSION["customer_code"] . "'"; $res = mysql_query( $sql ); print mysql_error($conn); var_dump( $res ); } else { // ここに、ログイン未の場合の処理を記述。 $sql = "insert into DBpractice( customer_code, pass, name, mail, comment, university, favorite_sports, seibetsu, del_flag, reg_date ) "; $sql .= "values( "; $sql .= " '".$_REQUEST["customer_code"]."', "; $sql .= " '".$_REQUEST["pass"]."', "; $sql .= " '".$_REQUEST["name"]."', "; $sql .= " '".$_REQUEST["mail"]."', "; $sql .= " '".$_REQUEST["comment"]."', "; $sql .= " '".$_REQUEST["university"]."', "; $sql .= " '".$_REQUEST["favorite_sports"]."', "; $sql .= " '".$_REQUEST["seibetsu"]."', "; $sql .= " '0', "; $sql .= " now() ) "; $res = mysql_query( $sql ); } }
チェックボックスの複数項目をDBにインサートしたいのですが、DBのフィールドを見ると、チェックボックスの値だけ空になってしまいます。 プログラミング初心者のため、基本的なところでつまずいている可能性も高いのですが、正しいコードがわかる方がいらっしゃいましたらご教授ください。 よろしくお願いします。 ■DBの構造 以下のようなフィールド構造にしており、一人につき１行でデータを持ちたいと思っています。 フィールド　　　name/ mail/comment/kokugo/sugaku/rika/syakai/eigo/・・・ ●　実際のデータの持ち方（以下のようにしたいです。） 例　太郎/ taro@/hello/ 国語/数学/ / /　　 次郎/ jiro@/ nice/ / 数学/ /社会/　英語 ※太郎は、国語と数学をチェックボックスで選択 ※次郎は、数学と社会と英語をチェックボックスで選択 ■チェックボックス画面html（一部抜粋） ---- <form action="regist.php" method="post"> 名前：<br /> <input type="text" name="name" size="30" value="" /><br /> メールアドレス：<br /> <input type="text" name="mail" size="30" value="" /><br /> コメント：<br /> <textarea name="comment" cols="30" rows="5"></textarea><br /> 科目<br /> <form name="kamoku" method="post" action="regist.php"> 国語<input type="checkbox" name="kokugo" value="国語"> 数学<input type="checkbox" name="sugaku" value="数学"> 理科<input type="checkbox" name="rika" value="理科"> 社会<input type="checkbox" name="syakai" value="社会"> 英語<input type="checkbox" name="eigo" value="英語"> <br /> ----- ■phpのファイル（regist.php） ※該当部分だけ記述させていただきます。 ---- <?php // $checkboxの中身は配列 $checkbox = $_REQUEST["chk"]; ?> <html> <head> <title>DB登録練習</title> </head> <body> // 選んだ科目を画面に表示させる <tr> <td>科目</td><td><?php for($i=0; $i<sizeof($checkbox); $i++){ print "${checkbox[$i]}<br>"; } ?></td> </tr> // DB登録部分 <?php $name = $_REQUEST['name']; $mail = $_REQUEST['mail']; $comment = $_REQUEST['comment']; $kokugo = $_REQUEST['kokugo']; $sugaku = $_REQUEST['sugaku']; $rika = $_REQUEST['rika']; $syakai = $_REQUEST['syakai']; $eigo = $_REQUEST['eigo']; $del_flag = $_REQUEST['del_flag']; $reg_date = $_REQUEST['reg_date']; $result = mysql_query("INSERT INTO DBpractice(name, mail, comment, kokugo,sugaku,rika, syakai, eigo,del_flag,reg_date) VALUES('$name', '$mail', '$comment','$kokugo','$sugaku','$rika','$syakai','$eigo','0', now())", $conn); if (!$result) { exit('データを登録できませんでした。'); } ---- チェックボックスで選択した複数科目をブラウザ上で表示させるところは上手くできるのですが、DBに挿入するときのみ、科目のみがうまく入りません。(他の項目は挿入されています。） よろしくお願いします。
NAME　　MAIL　　　　　　←フィールド名 Mike　　　1@mail.com Jackson　1@mail.com Juli　　　　2@mail.com Samon　　2@mail.com というデータがあります。MAILに重複がある場合、 たとえば上のデータの場合は、実行後、 Mike　　　1@mail.com Juli　　　　2@mail.com のように表示されるSQL文を書こうと思います。 MAILフィールドの値が同じで、他フィールドの値が違う場合、任意に一つのデータを残し、そのほかのデータは削除したいのです。 MAILがかぶっているデータは、他の値が何であれ一つだけにする、というのが目的なので、実行後に表示されるものは Jackson　1@mail.com Juli　　　　2@mail.com や、 Mike　　　1@mail.com Samon　　2@mail.com などでもかまいません。 このような操作を実現するSQLのコマンドを、どなたか教えてください。 よろしくお願いします。
sqlite3を使って学習しています。 コマンドプロンプトの設定について教えて下さい。 sqlite> select * from goods; 1|デジタルカメラ|35000 2|ノートPC|72000 3|プリンター|27500 sqlite> では、カラム名などの情報が表示されず見ずらいです。 なので起動するたびに下記のようにしています。 sqlite> .header on sqlite> .mode column sqlite> select * from customer; id name old address ---------- ---------- ---------- ---------- 1 aaa 52 bbb 2 谷 26 名古屋 2 近藤 32 東京 4 山下 18 大阪 5 長谷川 26 大阪 2 萩野 22 東京 1 aaa 52 bbb 4 廣瀬 12 山口 sqlite> 常にこの設定のままにしておきたいです。 いろいろ調べてみたのですが解決しませんでした。 設定を保存しておく方法はないのでしょうか。
SQL文にて上表のような２つのテーブルから下表のように mysql_fetch_arrayなどでデータを取り出したいのですが、 構文がさっぱりわかりません。 このような操作は可能なのでしょうか。 よろしくお願い致します。
mysqldump 　–default-character-set=utf8 でバックアップしてたsqlファイルを mysql　–default-character-set=utf8 でインポートしWEBを開いてみたら 一部の外字が文字化けしてしまいました。 nkfでバックアップのsqlファイルの文字コード調べてみると、EUCJP-winとなっていました。 既に元のDBはサーバークラッシュの為無い状態です。 どなたかご教授お願い申し上げます。 ＜元DBの環境＞ OS:Windows2003Server DB:MySQL5.0 PHP:5.0 ＜リストアするDBの環境＞ OS：windowsXP DB:MySQL5.0 PHP:5.2
MySQL 5.1 (win)で以下の流れで「オートインクリメントをリセット後」、レコード移動したいです。 ※idはauto_incrementしています。 １．既存のレコード一覧からレコード２を削除 id　name　comment 1　tanaka　こんにちは ※削除 3　suzuki　こんにちは 4　nakamura　こんにちは　 5　kimura　こんにちは ２．この後、idのAUTO_INCREMENTを「１」にリセット。 ３．新規レコードを追加 id　name　comment 1　tanaka　こんにちは 3　suzuki　こんにちは 4　nakamura　こんにちは　 5　kimura　こんにちは 2　sato　こんにちは　←idが空き番の２から始まり、このようにレコードが最後に追加されますよね？ この後これをレコード１とレコード３の間に移動させたいのですがそんなＳＱＬ文はありますか？ ***最終結果*** id　name　comment 1　tanaka　こんにちは 2　sato　こんにちは　←ココに移動 3　suzuki　こんにちは 4　nakamura　こんにちは　 5　kimura　こんにちは よろしくお願いします
SQLのIN文の用途に関する質問です。 普段は SELECT columns FROM tables WHERE column1 in (value1, value2, .... value_n); のように使いますが、 WHERE value1 in column1; のようにすればできないのでしょうか？ column1の値は 1,4,7,3というような内容になっています。 その中にvalue1が含まれているかどうかを判定したい場合はどうすればいいのでしょうか？ PHPかSQLでこのような問題を解決する方法をおわかりの方がいらっしゃいましたら、教えていただけないでしょうか？ よろしくお願いします。
教育関連機関にてＳＥをしております。 この度、学事システムをリプレイスしようと考えておりますが、 その際、学生や教員の住所情報（現住所）の持ち方について悩んでおります。 現在、「住祖コード」、「郵便番号７桁」、「都道府県名」、 「市区郡名」、「町名」、「方書名」という 持ち方で学生や教員の住所情報（現住所）をデータベースへ登録しています。 もちろん住所マスタにも同じような持ち方で登録されております。 郡の廃止や市の統合などで、市区町村名が変更された場合、 当然住所マスタの更新を行なうと思うのですが、 その際、教員や学生の住所情報（現住所）も更新する必要がでてきます。 ただ、個人の住所情報に市区郡名を持たずに、照会画面等では 常にマスタ参照とすればマスタのみの更新ですむのでは？ と考えてしまいますがどうでしょうか？ 住所の履歴情報も持たせる場合は、そうはいかないと思いますが、 現住所に関しては「住所コード」、「郵便番号７桁」、「町名」以下の情報さえ 持っていればよい気がします。 ケースバイケースだとは思いますが、情報処理関係の諸先輩方々のご意見を お聞かせいただけたらと思います。 何卒よろしくお願いします。
複数テーブルの総行数（count値）を取得したいのですが、下記だとテーブルA,B,Cの結果が バラバラに出力されてしまいます。 【入力条件】 mysql> select COUNT(*) AS 列ID from テーブルA 　　　　　union all 　　　　　select COUNT(*) AS 列ID from テーブルB 　　　　　union all 　　　　　select COUNT(*) AS 列ID from テーブルC; 【出力結果】 　　　　　　+-----+ 　　　　　　| 列_ID | 　　　　　　+-----+ 　　　　　　| 　1　　| ←テーブルAの合計：行数 　　　　　　|　 2　　| ←テーブルBの合計：行数 　　　　　　|　 3　　| ←テーブルCの合計：行数 　　　　　　+-----+ 総行数：6を一発で取得するには、どのようにしたらよろしいのでしょうか？ 大変恐縮ですが、ご教授よろしくお願いいたいます。 <<MySQLのverは5,5です。
テーブルTに対し、データ抽出に数分かかるようなSELECT文を実行しているとして、 そのSELECT文の実行中にInsertしたらどのような挙動になるでしょうか。 （INSERTした瞬間にエラーが発生する？） また、SELECT文の実行中にInsertしたら、 「SELECT文が実行終了するまで待って、そのあとにINSERTする」 という動きにしたい場合、どのように設定（or SQLを書けば？）すればよいでしょうか。
ＭyＳＱＬでデータベースの勉強をしています。 先頭からレコードを1件ずつシーケンシャル処理を行う時、カーソル定義をすればFETＣHが使えそうです。 でもＭySQLにはカーソルがないようです（SQLポケットリファレンス　技術評論社　平成17年版） ではどのような方法があるのでしょうか。 或いは最新版のMySQLではカーソル変数定義できますか？
mysqlでenum型の値に対応するインデックスを取り出すのはどうしたらよいでしょうか。 例） テーブル１の要素定義：enum("0ne","Two") テーブル１に入っているデータ 行１："One" 行２："Two" やりたいこと： SELECTで"One"という値を取り出して、そのインデックス（この場合は１）を知りたいのです。 よろしくお願いいたします。
MySQLのトリガについて教えてください。 投票システムを作っています。 テーブル名　abc ( abc1_id（プライマリ) , abc2_vote_volume(INT) ) テーブル名　def ( def1_id（プライマリ) , def2_vote_volume(INT) ) があります。 テーブル名　abc にある abc2_vote_volume(INT)にはユーザーが1票づつ投票します。 abc2_vote_volume(INT)が49までのうちは何も起こらず、 abc2_vote_volume(INT)が50を超えたら「テーブル名　def 」に全てをコピーしていくトリガの作成を考えました。 私が考えたのは下記の表現なのですが、エラーとなります。 FOR AS IF UPDATE 49<NEW.adc2_vote_volume　が見るからに怪しいのですが、改定方法が分かりません。 詳しい方、ご教授頂けますようお願いいたします。 DELIMITER // CREATE TRIGGER a_ref AFTER UPDATE ON abc FOR AS IF UPDATE 49<NEW.adc2_vote_volume INSERT INTO def SET def1_id =NEW.abc1_id,abc2_vote_volume=NEW.abc2_vote_volume ON DUPLICATE KEY UPDATE def1_id =NEW.abc1_id,abc2_vote_volume=NEW.abc2_vote_volume; END; // DELIMITER
$sql = "SELECT a.jyusyo,a.name,a.gazou,avg(b.hyouka) FROM iza AS a, iza2 AS b WHERE a.id=b.id"; これだと全てのhyoukaカラムの平均を出してしまいます。 b.idに id hyouka 0　　5 0　　3 0　　2 1　　5 1　　5 あるとしたら id0の平均、id1の平均とid事に分けたいんですがどうしたらいいでしょうか？？
お世話になっております。 早速ですが、ＳＱＬをどう書けばいいかで悩んでおります。 テーブルの文字列（varchar）の列をl検索します。 テーブルＡ------------------------ ID value 1 abc 2 defghijklmnopqrstu 3 vwxyzabcdefg 上記のようなテーブルです。 このテーブルのvalue列で、以下の文字列をもっともたくさん 含むものから優先で取得したいのです。 "abc"、"fg"、"vw"、"pqr"、"xyz" この場合、 IDが１の列は"abc" IDが２の列は"fg"、"pqr" IDが３の列は"fg"、"abc"、"xyz" のようにそれぞれ1個、2個、3個と含んでいますから。 ＳＱＬの結果セットにIDが３，２，１といった順番で含まれるように 取得したいのです。 where句にlikeを使うくらいはわかるのですが、それから先が 思い浮かびません。 どうかお知恵をおかしください。
1.以下テーブルを作成しました 　CREATE TABLE n_tables ( 　i integer NOT NULL); 2.作成したテーブルの構造について 　SHOW FIELDS FROM number_tables; 　 　<結果> 　 Field|Type　　|Null　|Key|Default|Extra 　============================= 　| i 　　| int(11) | NO | 　　 | NULL| 　　　　 | 質問： 　1で、NOTNULLで　i列を作成したのですが、Show fields　を確認したときに 　なぜ、DEFAULT列は　NULLになっているのでしょうか。 　NULL列がYES(NULL格納可能)で、DEFAULT値がNULLなら、DEFAULT列が 　NULLなら納得できるのですが。 　そういう仕様なのでしょうか。 　MySQL　Verは、5.1.33です。
MySQLのデータベース削除について、初心者のUserが、ハイフン(-)入りの データベースを作ってしまい、削除出来なくて困っています。 DROP DATABASE　'データベース名'　　・・コマンドを使っても削除にならず > が出て、それ以上、進めません。　 安全に強制削除出来る方法がありましたら、教えて下さい。 よろしくお願いします。
データベースを使ったウェブサイト。 POSTを使ったformタグより、textareaにてテキストをsql文にて、 MySqlにinsertし、（このときにmysql_real_escape_string） 読み出すときにhtmlspecialcharsしてprint。 これが一般的な流れなのですが、 上記のまま行うと、改行（\r\n）がウェブ上に見えてしまいます。 ですので、 1：print preg_replace("/\r\n/","<br />", htmlspecialchars($ans['Pt_txt1'], ENT_QUOTES, 'UTF-8')); 2：print nl2br(htmlspecialchars($ans['Pt_txt1'], ENT_QUOTES, 'UTF-8')); などをやって消そうとしているのですが消えません。 ためしに、 $aaa ="適当な文字"; 1：print preg_replace("/\r\n/","<br />", htmlspecialchars($aaa, ENT_QUOTES, 'UTF-8')); 2：print nl2br(htmlspecialchars($aaa, ENT_QUOTES, 'UTF-8')); のように、MySqlを介さずに直接出力した場合、 ちゃんと改行コードは<br />に変更してくれましたので ソースの記述ミスではないと思うのです。 原因はなににあるでしょうか。 なお、現状phpmyadminで覗くと、 「フィールドA」（mysql_real_escape_stringを通してinsert） ----- あいうえお\r\nかきくけこ ----- 「フィールドB」（mysql_real_escape_stringを通さずにinsert） ----- さしすせそ たちつてと ----- となっているフィールドがありますが、 それらがhtmlで出力されたもののソースを見ると、 ----- A：あいうえお\r\nかきくけこ B：さしすせそ<br />たちつてと となぜかBのほうが希望通りの動きをします。 ｃを通さずにDBに入れてしまったほうが希望通りに動きます。 さっぱり困りました。
下記のようなsqlを実行したいのですが結合方法がわかりません。 どうぞご教授お願いします。
MySQLかSQLiteのどちらを学ぶべきか迷っています。 下記機能を実装したページを実現する場合、 MySQLの代わりにSQLiteでも問題はないでしょうか。 よく不動産サイトで使われているもので、 条件を指定して検索して物件を絞り込んだり、 合計何物件が見つかりました、 3日以内に公開された物件は、 価格順や土地面積順に並び変える、 各エリアの公開物件数の一覧 サイト内検索 チェックした物件をまとめてお問い合せ この物件をお気に入りリストへ登録 などの機能があり、物件を公開すると自動的に上記機能をその物件に対して扱えるようになる。 などの機能をAjaxを使って実現を目指したいと思っています。 全国区の有名な不動産サイトでは数万物件と膨大ですが、 自分が扱おうと思っているデータ量は1000物件より少ないです。
mySQLへの更新・登録アクセスが増えた場合、mySQLの負荷を軽減する方法で一般的な方法は何ですか。
テーブルAccessにあるフィールドuser_idの値が$userであるフィールド数を取得したいのですが、 同テーブルのフィールド　ip　もしくは　uid の値が重複しているものを省いた数を取得したいです。 ipとuidの値が他のフィールドに存在していないuser_idだけカウントしたいです。 このようなカウントをすることは可能でしょうか。 クエリ文をご教示頂けると幸いです。 よろしくお願い致します。
通常はApacheとPHPをインストールしただけではSQLを使うことはできないと思いますが、 http://www.dbonline.jp/sqliteinstall/ こちらのページで「PHP5以降では標準でインストールされて利用できるようになりました。」 という説明がありますが、 Apache 2.4.0、PHP 5.3 (5.3.9)ではどのようにすればsqlを使えるのでしょうか。 http://www.dbonline.jp/sqlite/ こちらの入門サイトを参考にいろいろ勉強していきたいと思っています。
mySQLが起動しなくて困っています。環境はwindows7です。 以下にエラーまでの手順を書かせていただきます。 (1)コマンドラインでmysqldを実行する (2)ログファイルにエラーをはいて終了する。 以下にエラーログを貼り付けさせていただきます。また簡単なコメントも付加させていただきます。 120123 9:22:02 [Note] Plugin 'FEDERATED' is disabled. MySQL: Table 'mysql.plugin' doesn't exist ・・・(1) 120123 9:22:02 [ERROR] Can't open the mysql.plugin table. Please run mysql_upgrade to create it. ・・・(2) 120123 9:22:02 InnoDB: The InnoDB memory heap is disabled 120123 9:22:02 InnoDB: Mutexes and rw_locks use Windows interlocked functions 120123 9:22:02 InnoDB: Compressed tables use zlib 1.2.3 120123 9:22:02 InnoDB: Initializing buffer pool, size = 128.0M 120123 9:22:02 InnoDB: Completed initialization of buffer pool 120123 9:22:02 InnoDB: highest supported file format is Barracuda. 120123 9:22:02 InnoDB: Waiting for the background threads to start 120123 9:22:03 InnoDB: 1.1.8 started; log sequence number 1647042 120123 9:22:03 [ERROR] Fatal error: Can't open and lock privilege tables: Table 'mysql.host' doesn't exist (1)これはデフォルトで出るものらしいので問題ないと思います (2)ここが主な原因だと思われます。また、ここに書かれているmysql_upgradeを実行するためにはmySQLを起動させなければいけないため、実質実行不可能です。 以上です。何かお気づきの点がありましたら助言いただけると幸いです。
| id | phonenumber |status | ----------------------- | 1 |1111111111111| OK | | 2 |2222222222222| OK | | 3 |3333333333333| NG | | 4 |1111111111111| NG | | 5 |2222222222222| OK | | 6 |3333333333333| OK | | 7 |1111111111111| NG | | 8 |1111111111111| OK | | 9 |3333333333333| NG | このようなSQL文があるとき、各phonenumberごとの最新のデーターを抜き出したいと思っています。 その時のSQL命令文を教えてください。 イメージ的には、 | 5 |2222222222222| OK | | 8 |1111111111111| OK | | 9 |3333333333333| NG | を抜き出すようなイメージになります。 ご教授お願いいします。
現在、下記サイトを利用してSQLの勉強をしています。 http://www.techscore.com/tech/sql/index.html/ ez-HTMLを使ってHTMLやCSS、JavaScriptの編集をしています。 http://www.w-frontier.com/software/ezhtml.html サーバーへのアップロードにはFFFTPを使っています。 http://www.forest.impress.co.jp/lib/inet/servern … サーバーはApache2.2.21 PHP 5.3 (5.3.9)です。 ez-HTMLでSQLの編集と実行をしようと思ったのですが上手にできませんでした。 SQLは別に下記のような専用のソフトが必要なのでしょうか。 必要な場合 Common SQL Environment http://www.vector.co.jp/soft/win95/business/se18 … か SQL Studio http://kuronekosoft.ewinds.net/sqlstudio.aspx どちらの方がおすすめでしょうか。
株の購入履歴をトリガー内部で計算したいと考えています。 buying_stockの購入をすると、トリガーで最新の数量を計算しnow_stockテーブルに最新情報を記入、更新します。 テーブル ●buying_stock d1(プライマリ),d2_usr_id,d3_stock_id,d4_buy_stock_volume, ●now_stock f2_stock_id(プライマリ),f3_stock_name,f4_latest_stock_volume トリガ DELIMITER // CREATE TRIGGER a_ref0 BEFORE INSERT ON buying_stock FOR EACH ROW BEGIN INSERT INTO now_stock SET f2_stock_id=NEW.d3_stock_id,f3_stock_name=f3_stock_name,f4_latest_stock_volume=f4_latest_stock_volume+NEW.d4_buy_stock_volume ON DUPLICATE KEY UPDATE f2_stock_id=NEW.d3_stock_id,f3_stock_name=f3_stock_name,f4_latest_stock_volume=f4_latest_stock_volume+NEW.d4_buy_stock_volume; END; // DELIMITER ; ここまでは出来ました。 ただ、これでは最新価格は残りますが、購買履歴が残りません。 そこで、下記のトリガーを作成しました。 テーブル ●stock_history g1(プライマリ),g2_stock_id,g3_stock_name,g4_latest_stock_volume トリガー DELIMITER // CREATE TRIGGER a_ref000 BEFORE INSERT ON now_stock FOR EACH ROW BEGIN INSERT INTO stock_history SET g2_stock_id=NEW.f2_stock_id,g3_stock_name=NEW.f3_stock_name,g4_latest_stock_volume=NEW.f4_latest_stock_volume; END; // DELIMITER ; しかしながら、g3_stock_nameとg4_latest_stock_volumeがNULLになってしまいます。 古い購入履歴と最新の購入数は別物として捉えられているようです。 一方、同一のものとして指示するために、テーブルをg2_stock_id(プライマリ),g3_stock_name,g4_latest_stock_volumeとすると、Duplicate違反を指摘されます。 トリガーで計算した後の履歴を残すためにはどのような方法があるでしょうか? テーブルには ●stock_name a1(プライマリ),a2_stock_id,a3_stock_name, というものもございますので、これを使用すれば出来るのかもしれません。 ご指導いただきたくお願いいたします。
CentOS を使用しています。 ユーザを他のホストからのアクセスも許可して mysql_connect すると 接続出来るのですが、同じサーバー内で localhost から試すと以下のようなエラーが出ます。 Access denied for user 'user'@'localhost' (using password: YES) こちらも出来ませんでした。 $link = mysql_connect(':/var/lib/mysql/mysql.sock', 'user', 'pass'); httpd.conf で Listen の行はこちら。 Listen 80 /etc/hosts の内容は以下でした。 # Do not remove the following line, or various programs # that require network functionality will fail. 127.0.0.1 localhost.localdomain localhost ::1 localhost6.localdomain6 localhost6 素人な質問で大変恐縮ですが、アドバイス頂けると助かります。
現在、MySQLでselectを行うと、追加した順序で表示が行われています。 そこで、新たにレコードを先頭にinsertしたいと思うのですが、可能でしょうか？ 本来はorder byなどでソートすべきで、邪道であることは承知ですが、 もし可能な方法があれば教えていただきたいです。 よろしくお願いします。
PHPとMySQLを使っています。 下のようなSQL文を作成し、値を引き出そうとしています。 <SQL文> SELECT * FROM table_name WHERE A = "あ" AND B='い' <DBに登録済みの取り出したいデータ> あ、い、う、え、お ところが、戻ってくる値が、 あ、あ、い、い、う、う、え、え、お、お のように、値が重複して戻ってきます。 いろいろ調べましたが、原因がさっぱりわかりません。 ご存知の方、教えていただけると助かります。 よろしくお願い致します。
いつも参考にさせてもらっています。 ＭｙＳＱＬ初心者ですが、よろしくお願いいたします。 varchar（５０）のpos列に下記のようにデータの更新をかけます。 UPDATE t_collo SET pos="001110000" データベースを確認すると実際には"1110000"となって、先頭の ゼロがなくなっています。 恐らく基本的なところかと思うのですが、グーグル先生に聞いても 当方の力量不足なのか、よくわかりませんでした。 ご教示いただけますと助かります。
MYSQLで株の履歴を作っています。 テーブルとしては、株を購入するユーザー書き込み用のa_nowstock、最新の保有株を記録するa_lateststockとなります。 テーブル a_nowstock　　　　(a1_id(自動取得),a2_user_id,a3_buy_stock_volume) a_lateststock (d2_user_id(PRIMARY),d3_latest_volume) a_nowstock　が入力されたら、最新数量を足し算してa_lateststockの中のd3_latest_volumeを更新します。 これをTRIGGERで処理するために下記のようにSQLで指示してみました。 DELIMITER // CREATE TRIGGER a_ref BEFORE INSERT ON a_nowstock FOR EACH ROW BEGIN INSERT INTO a_lateststock SET d2_usr_id = NEW.a2_usr_id, d3_latest_volume = NEW.a3_buy_stock_volume ON DUPLICATE KEY UPDATE d2_usr_id = NEW.a2_usr_id, d3_latest_volume = d3_latest_volume　+ NEW.a3_buy_stock_volume; END; // DELIMITER ; しかしながら、下記の通りエラーとなります。 #1054 - Unknown column 'd3_latest_volume　' in 'field list' d3_latest_volumeをold.d3_latest_volumeとして指示しても同様です。 #1054 - Unknown column 'old.d3_latest_volume　' in 'field list' WEB上のMySQL リファレンスマニュアルの記載(UPDATE persondata SET age=age+1;)を見る限り足し算は可能と考えています。 どこに問題があるか詳しい方ご教授頂けましたら幸いです。 どうぞよろしくお願いいたします。
以下のような状況で、 a[id、あ、い] b[id、う、え]、[id、お、か] c[id、き、く、け]、[id、こ、さ、し] （idはすべて同じ値とします） というデータがあったとしたら、取得したいのは [id、あ、い、う、え、き、く、け] というデータです。 INNER JOINを使うと、idが重複した行まで取得されてしまうため、解決策を探しています。 MySQLの構文では、どのようなクエリにすればよろしいでしょうか。 よろしくお願い致します。
1．DBの設定。 [mysqld] default-character-set = utf8 skip-character-set-client-handshake [mysqldump] default-character-set = utf8 [mysql] default-character-set = utf8 2．コマンドプロンプトより接続(musqldがUTF設定のため、SJIS変換) SET NAMES SJIS; 3．表の作成 create table table1( id int, name varchar); 4．表に追加 INSERT INTO table1(item,name) VALUES("1","表"); INSERT INTO table1(item,name) VALUES('1','表'); ⇒どちらのSQL分でもDBには、表　という文字がNullで格納されます。 　(1　は格納されています。) 質問1 "表"はSJISで文字化け？するというのをどこかで見た覚えがあるのですが '表'でもInsはできないものなのでしょうか。 "であろうと'であろうと、表は　SJIS環境ではエラーになるのでしょうか。 質問2 このままでは、コマンドプロンプトから文字化けする？ため 「表」という文字を含むInsert検証ができません・・・。 コマンドプロンプト以外で、ターミナルに使えるツールがあれば ご教授お願いします。(phpMyAdminも除外でお願いします。)
SQL文のみを用いて値の検索結果を元にまた検索を行い、さらにその結果をもとに検索結果の中身を参照して比較する方法を探しています。 例として、データベース内に図のような4つのテーブルがあるとします。 地域情報Aと都道府県名A、地域情報Bと都道府県名Bはセットと考えます。 地域情報には、地域ごとに対応する番号があり、都道府県名には地域情報の番号と、それに対応した件名が記述してあります。 （例えば、東北は001番で、001番(東北)には青森・岩手が存在する、と読みます） このようなデータベースがあるとき、入力として「中部」「北陸」があったとします。 すると、1つ目の入力（中部）は地域情報Aからその番号を探し，その番号を元に都道府県名Aから県名を探します。 同様にして、2つ目の入力（北陸）もBのテーブルから値を検索します。 すると、1つ目の入力に対して「愛知・福井」、2つ目の入力に対しては「福井・石川」が出力されます。 最後に、1つ目の出力結果と2つ目の出力結果を比較して、同じ都道府県名が含まれていれば 1 を、含まれていなければ -1 を出力します。 ここではどちらも「福井」が含まれているので、最終的な出力結果は「1」になります。 ということをやりたいと思っています。 現在、C言語で、2つの出力結果（県名）をそれぞれ配列に格納して、2つの配列の中身を比較、for文とstrcmpで配列に一致する県名があるかを確認、ということをしていますが、 入力に応じてSQL問い合わせが4回と配列の中身の一致比較のためにfor文を2重に回しているため、実行速度が遅いのが気になります。 これをC言語を使わず、SQL文のみで完成させるには、どういったSQL文を書けば良いのでしょうか？ また、実際に実行するとして、データ検索にSQL・一致比較にC言語を使う場合、全てSQLのみで実行する場合　ではどちらが処理時間が短くなるのでしょうか？ ただし、実際は地域情報A・Bにはレコードが1000件以上、都道府県名A・Bには各地域ごとにレコードが5件程度あることを想定しています。 今回は例のためこのような書き方になっていますが、実際に扱うデータに文字列はなく、すべて数値データです。 長文になってしまいましたが、対応の仕方を知りたいと思っています。 よろしくお願いします。
普通のホームページは作成した事があります ただ、「CGI」などを用いた事はありませんが、少しだけプログラムは勉強したことがあるので、「CGI」がどういうものかは少しだけわかります。サーバーに関しても、少しだけ分かります。 http://www.tanken.ne.jp/cate/okasi/rank/ このページですが、他サイトからクリックがあれば、サーバーに「IN」カウントとしてデータが蓄積され、それに基づいて順位付けがなされているようです ただ、ページを読みこんだ都度ページが作成されているようではなく、あらかじめ作られたページを読み込んでいるようなのです http://www.tanken.ne.jp/cate/okasi/rank/ に index.html を入力しても、表示されたので、そのように判断したのですが、、、 そこで、質問です サーバーのデータから「HTML」を作成するソフトなどがあるのでしょうか？ それとも、、、、 どのような仕組みになっているか分かる方、是非、ご回答をお願いします 書籍、サイトなど理解に役立ちそうなものがあれば、教示していただければ、尚助かります よろしくお願いいたします
お世話になります。 【前提】 Aテーブル |key|hoge|int1|int2| （keyはユニーク） Bテーブル |key|hogehoge| （keyはユニーク） 上記のテーブルを、下記のSQLで結合。 SELECT `A`.`key`,(`A`.`int1` / `A`.`int2` ) as `kekka`, `B`.`hogehoge` From `A` left join `B` on `A`.`key` = `B`.`key` 【目的】 ユニークではない`A`.`hoge`の重複を省き、かつ、`kekka`が最大のものを選びたい。 【考え方】 `A`.`hoge`でグループ化し、max(`kekka`)を選ぶ。 【そのために】 SELECT `A`.`key`,(`A`.`int1` / `A`.`int2` ) as `kekka`, `B`.`hogehoge` From `A` left join `B` on `A`.`key` = `B`.`key` IN(SELECT max(`kekka`) FROM `●●` GROUP BY `A`.`hoge`) ★質問です。 １）根本的に足りてない知識は何でしょうか？ ２）上記の考え方で間違っていませんか？ ３）●●には何を入れればよいでしょうか？ （`A`を指定してみましたが、Unknown column 'kekka' in 'field list'といわれてしまいました） MySQLのバージョンは5.1.57です。
１年くらい前のモバゲーなどはあれだけのユーザとクエリをMySQLサーバ600台位で処理しているそうですが（レプリケーションを考えると実質1/3くらいでしょうが）、どのような工夫がほどこされているのでしょうか？ SELECTよりも処理の重いINSERT、UPDATEも1秒間にもの凄い数が来ると思います。 並行処理プログラム等にてDBにアクセスを同時に大量に行う場合等にはどのようなハード構造や、システム設定にすればいいのでしょうか？ 1台のDBサーバに複数のMySQLを入れたり、仮想化してOSを複数入れて、とかで対処しているのでしょうか? それとも特にそのような事をしなくても（特に更新系の）大量同時クエリを裁くだけの実力がMySQLにはあるのでしょうか？ 宜しくお願いします。
www.○○○.com/のあとにいれていたwordpressを www.○○○.com/△△/にもっていきたかったので移動させたいのですが、 インストールできません。 サーバーはサクラインターネットを使っています。 wordpressを一度アンインストールしないといけないのかなと思い mysqlも1度以前つかっていたデータベースの中身を全部削除して 再設定しました。 wp-config.php の編集は以前のままでffftpにアップしてあります。 最後のhttp://.○○○.com/△△/wordpress/wp-admin/install.phpに接続されないのですが 原因がわかりません。 詳しい方、教えてください。
my.iniとSET NAMES SJIS　 について教えていただきたいことがあります。 my.iniに以下設定を追加で行いました。 　[mysqld] 　character-set-server=utf8 　[mysqldump] 　default-character-set = utf8 　[mysql] 　default-character-set = utf8 データベースのAテーブルには、 No　　商品　　　　価格 1　　　冷蔵庫　　1000 2　　　エアコン　　800 というレコードが入っております。 コマンドプロンプトより、 1.　cd C:\xampp\mysql\bin 2.　mysql -u root -pnazonazo の二つのコマンドを実行後、 mysql> Select * from A; を実行したところ、日本語の商品列が文字化けしました。 　No　　商品　　　　価格 　1　　　文字化け　1000 　2　　　文字化け　　800 そこで、色々調べて 1. mysql> SET NAMES SJIS; 2. mysql> Select * from A; を実行したところ商品名の文字化けが直って表示されました。 　No　　商品　　　　価格 　1　　　冷蔵庫　　1000 　2　　　エアコン　　800 質問1：SET NAMES SJIS;により、コマンドプロンプトでの文字化け原因が 解消されたと思うのですが、なぜだか理由が分からないのです。 「my.ini」とどのような関係があるのでしょうか。 情報を見つけたページでは、おまじないということで書かれていたのですが 解決された理由を知りたいのです。 質問2：PHPでも、SET NAMES SJIS;　を使用するときがあるみたいなのですが 同じ効果があるのでしょうか。 どなたかお分かりのかたがいらっしゃいましたら ご教授お願いします。
「HTTP500内部サーバーエラー」のメッセージが表示されて、サイトが開かなくなったので、 wp-config.phpを再設定する作業をしました。すると、インストール出来ない理由として、 mysqlのデーターベースにユーザーとして使用権限がないことが原因らしいとわかりました。 xserverのmysqlのユーザーをチェックしたら、別のサイトでwordpressをインストールするときに、 間違ってユーザーの一つを削除していたことを思い出し、元のユーザーを追加。 wp-config.php の設定もうまくいき、無事インストールとなりました。 しかし、これが間違いだったようで、 サイトは表示されたものの、全くの初期段階で、今まで投稿してきたコンテンツを全く表示されてくれません。 この状態で、元のコンテンツを復活させる方法はあるでしょうか？ xserver内のmysql関連のファイルは何もいじっておりません。 ご指導のほどよろしくお願いします。
下記のように、時刻がカラムに分かれたテーブルがあるとき、 現在時刻(もしくは現在日)より、7日以内のレコードだけを取得したいのですが、 どう書けば良いのでしょうか？ カラム1　カラム2　min　hou　day　mon　yea 内容1　　内容2　　0　　4　　6　　1　　2012 内容3　　内容4　　3　　2　　1　　5　　2011 内容5　　内容6　　1　　3　　4　　2　　2011 ビューとかを使うのでしょうか？ それとも一旦全部取り出した後、スクリプト(PHP)で何とかするのでしょうか？ 一番知りたいのは、具体的なSQL文なのですが… ＜環境＞ MySQL5 時刻関係カラムの属性は全て、UNSIGNEDでデフォルト値0 min　tinyint(3) hou　tinyint(3) day　tinyint(3) mon　tinyint(3) yea　smallint(5)
現在 id-日付-入金-出金-残高 という５項目あるデータベースがあります。 入出金額を変更した際など、日付でソートをして、すべての行の残高データを再計算し、データを更新したいのですが、どのようなSQL分を使えばよろしいのでしょうか。 ご教授願います。
$result = $db->query("SELECT カラム名 FROM テーブル名 WHERE カラム名 <> ''"); PHPでSQL文を作成しているサンプルがあるのですが、「WHERE カラム名 <> ''」の意味が分かりません。カンマ二つで空文字？ これはどういう意味でしょうか？ また、<>は何と読むのでしょうか？(検索したいので)
テーブルAに以下列があります。 No(B列)、名前(C列)、生年月日(D列)、住所(E列) １　　　　　伊藤、　　　1970　　　　　　　、秋田 2　　　　　山形、　　　1950　　　　　　　、宮城 3　　　　　市川、　　　1960　　　　　　　、新潟 ： ： そこで、昔どこかのページでチラッと見た記憶だけあるのですが CREATE　VIEW　と　UNION？を使って A列に、B列～E列の結合した文字列を吐き出して、Likeで検索すれば一括検索が出来る。 というのを見た気がするのです。 ・CREATE　VIEW　UNION? 結合列(A列)、　　No(B列)、名前(C列)、生年月日(D列)、住所(E列) 1伊藤1970秋田　１　　　　　伊藤、　　　1970　　　　　　　、秋田 2山形1950宮城　2　　　　　山形、　　　1950　　　　　　　、宮城 3市川1960新潟　3　　　　　市川、　　　1960　　　　　　　、新潟 ： ： 知り合い、HPも色々あたってみたのですが、SELECT結果の合体しか分からず困っております。 どなたか、解決方法をご存知の方がいらっしゃいましたらご教授お願いします。 MySQLサーバー(XAMPP1.7.7 )で、実行する予定です。
バージョンはMySQL4.1です。 下図のような、各都道府県の人口が格納してあるデータベースがあります。 【データベース x001】 ｜　　　Pref　　｜popu｜ ｜＿＿＿＿＿＿＿＿｜ ｜北海道　　　｜568 ｜ ｜青森県　　　｜147 ｜ 　　　・・・・ ここから、それぞれの都道府県の人口の割合（都道府県人口÷各人口の合計　%表示）を表示させたいのですがうまくいきません。 （こんな感じに表示させたいのです↓） ｜　　　Pref　　｜popu｜percent｜ ｜＿＿＿＿＿＿＿＿｜　　　　　｜ ｜北海道　　　｜568 ｜　　4.4　｜ ｜青森県　　　｜147 ｜　　1.7　｜ SELECT Pref, popu, popu/SUM(popu) from x001; だと、北海道1件の結果しか表示されません。 どなたか解説して頂けないでしょうか。
MySQL5.1.46でFedora release 11なのですが、テーブルをMyISAMからMEMORYへ変更しているのですが、何個かのテーブルを変更した時点でOut of memoryエラーになってできなくなります、バッファサイズや色々見直したのですが同様です、テーブル単独のサイズでの制限はクリアしました。 メモリーは8GBなのですが32bitOSの２GBの制限に引っかかったのでしょうか？しかしFreeで見ると8GB認識しています、mysqldプロセス全体の制限ですがMEMORYテーブル全体の容量になるのでしょうか？64bitＯＳに入れ替えないと駄目なのでしょう、なにか設定や方法でアドバイスがあればよろしくお願いします。
練習でショッピングサイトを制作しています。 このサイトでは会員サービスもありますが、会員登録せずに商品を購入することもできます。 会員の場合、受注テーブルに会員コード(会員を一意に表す)があれば、それを元に会員テーブルから発送に必要な情報を取り出すことができます。 しかし非会員は会員テーブルに情報がないため、発送に必要な情報が別途必要になります。 非会員の情報はどこで管理するべきでしょうか？
たとえばvarchar属性のフィールドがあるとします、格納されているデータから一番長いものを抽出するクエリーはどうすればいいのでしょうか？ 最長値から長さ（値）を調整したいのですが、他に方法があれば教えていただきたいのですが、よろしくお願いします。
テーブルをMyISAMからMEMORYへ変更するとテーブルサイズが肥大します、 サイズが10倍くらいになってしまうのですが何か解決法はないのでしょうか？ アドバイスのほどよろしくお願いします。
MySQLのTIMEDIFFのバグについて教えて下さい。 環境：MySQL　5.0.77 MySQLのテーブルにdateというtimedate型のカラムを作ります。 カラムには　2011-01-01 00:00:00 とう形でデータが登録してあります。 現在の時刻と登録してあるdateの差を出したいと思い、 TIMEDIFF(NOW(), date) を使うと 「838:59:59」という値が返ってきてしまいます」 下記のホームページに　MmySQLのバージョンが4.1のバグと記載されていました。 http://onlineconsultant.jp/pukiwiki/?MySQL%204.1 … バージョン5でも同じような症状が出るのでしょうか？ 解決策はどのようにすればよいのでしょうか？ 複数のサーバーで実験できる環境があるのですが、MySQL5.0.77でちゃんと計算される場合と、上記のような変な数字になってしまう場合があります。
同一のファイルからフォームアクションでデータを渡して、$_POSTで受け取る場合、データベース上では正常に動作が行われているのですが、ブラウザで表示されるページには実行される前のデータが表示されます。 ファイル名はtest.php countの初期値は10 if(isset($_POST['memberid'])){ $memberid = $_POST["memberid"]; mysql_connect('localhost',_id,_pass); mysql_select_db(_db); $SQL = "update member set count = count -1 where id = $memberid"; mysql_query($SQL); } echo "現在の数値は" . $count; //現在のcount数を表示 <form method=post action="test.php"> <input type=hidden name="memberid" value="getMember()->memberid"> <input type=submit value="実行"> </form> formボタンの実行を押すごとにmemberテーブルのcountフィールドが1減るという動作なのですが、 実行して表示されるtest.phpには実行する前のcount数である10が表示されます。 再読込みすると9と表示されるのですが、データベース上では8になっています。 どのような記述をすれば正常に反映されますでしょうか？ ご教示いただけると幸いです。 宜しくお願い致します。
MySQL＋phpMyAdmin＋PHPで開発を行っています。 テーブル項目の照合順序をutf8_binで使いたいと思っています。 PHPでのデータのやり取りでは文字化けは発生しないですが、唯一、phpMyAdminの表示でデータを見た時だけ、日本語が文字化けというか16進数の数値がズラズラと表示されます。テーブル項目をutf8_unicode_ci に変更すれば、日本語の文字化けは発生しません。 phpMyAdminの一般設定で照合順序をutf8_binにしても同じです。 utf8_binで定義した場合、phpMyAdminで日本語化け（16進数の数値がズラズラ）が発生しない方法はないのでしょうか。 よろしくお願いします。
PHPでMySQLを利用し開発を行っています。 検索ボックスにキーワードを入力して検索をしたいのですが、期間を指定して検索できるようにする方法が分かりません。 さらに1ページに五件ずつ表示するようにしています。 下記はキーワード検索として動いているプログラムです。 例は２つのフィールドから検索しています。 SELECT * FROM テーブル名 WHERE フィールド名１ LIKE '%$search%' OR フィールド名２ LIKE '%$search%' LIMIT 0, 5; これに　BETWEEN 期間1　AND　期間2 　を追加して完成させようと思っているのですが、 どうも上手くいかないので、どのように書けばよいか教えて下さい。 よろしくお願い致します。
現在mySQLの勉強中です。 テーブルtableにidとnameとunixtimeが格納されています。 登録件数30000件。idは、登録申請時に順に割り振られています。 unixtimeはnameに対応する人間の登録確定時を表したものです。 したがって、idとunixtimeの順番は必ずしも一致しません このデータから、PHPを使って登録確定日別でid、nameのリストをhtmlで作成したいと思います。 たとえば20001224.htmlには2000年12月24日に登録確定した人のリストが入っているようにしたいです。 このような出力を効率的に行うために、unixtimeからyearとmonthとdateを作成しました。データ型はすべてintです。 あるデータのunixtimeが2011/12/31の場合、yearは2011、monthは12、dateは31となります。 htmlを作成するにあたり、データベースからデータを出力しなければいけません。そのため、 まずdateが条件に一致するデータを抽出して配列にidとmonthとyearを格納し、 次にmonthが条件に一致するものを抽出して配列にidとyearに格納し、 最後にyearが一致するデータのidを抽出し、idに該当するデータをechoしようと考えています。 が、この方法は正しいのでしょうか。 SQLは検索にいろいろテクニックが必要で、方法を誤ると途端に検索速度が速くなったり遅くなったりすると聞きました。 列を増やすことで、メモリの使用量が増えて検索が遅くなったり、もしかしたらunixtimeで上手に検索する方法があるのかもしれないと思います。 どなたかこういう時はどういう検索を行うのが正しいのか、ご教示ください。 どうかよろしくお願いします。
cpu: Xeon 2.93G x 2 mem: 4GB OS: Windows Server 2003 standard rc2 MySQL: 5.0　（ＭｙＩＳＡＭ） 画像を保存する巨大サイズデータファイル一つあります、現在650ＧＢ。 検索の場合時間30秒ぐらいかかるます。しかしエラーメッセなく最後は 結果が表示されます。 slow_logに出力があるが、なぜ時間かかっているか errorログ等全てみても、特に遅いに関する情報ありません。 何か考えられますでしょうか？ よろしくお願い致します。
AtableというテーブルとBtableというテーブルのTypeフィールドをupdateする場合、テーブルが異なるごとにmysql_queryを使っているのですが、この場合、ひとつにまとめられないものでしょうか？ このような使用方法が通常ですか？ よろしくお願い致します。 $ASQL = "update Atable set Type = 1 where id = $a"; $BSQL = "update Btable set Type = 1 where id = $b"; mysql_query($ASQL); mysql_query($BSQL);
こんにちは。 mysqlのselect文なのですが、LEFT OUTER JOIN した右側をgroup byし、そのなかで最大値を持つものを結び付けたいのですが、四苦八苦やってみたところ２日ほど解決できず・・・。 どなたかご教授いただけますと助かります。 テーブルなどは以下の通りです。 ---tableA----(テーブル名) user / supplier（カラム名、以下レコード） 1 / 1 1 / 2 1 / 3 2 / 1 2 / 3 ---tableB--- skuno / supplier / update_at 1 / 1 / 2011-12-12 2 / 1 / 2011-12-13 3 / 1 / 2010-11-10 検索の目的は、特定のカラムuserに対応する(例えばuser = 1)supplieｒの値(1,2,3)を取り出し、tableBにおいて、それぞれの値に結びつくskunoのうち最新のupdate_atを持つskunoを取り出したいというものです。 上記の例の場合、希望する検索結果は以下のような想定です。 supplier / skuno 1 / 2 2 / null 3 / null 私が検討してみたsql文は以下の通りなのですが、 select supplier,skuno from tableA LEFT JOIN tableB ON tableA.supplier = tableB.supplier where tableA.user = 1 and tableB.update_at IN (select max(update_at) from tableB group by supplier) group by tableA.supplier; この場合だと、右側がnullだとsupplierの値が表示されず、 supplier / skuno 1 / 2 となってしまいます。 select supplier,skuno from tableA LEFT JOIN tableB ON tableA.supplier = tableB.supplier where user = 1 group by supplier; だと右側のテーブルの値が指定できず・・・ ここからどのように条件付けをしたらよいのか、お力添えをいただけますと幸いです。 よろしくお願い申し上げます。
MySQLを使いselect文を作成しているのですが、 どうしても自分が意図しているクエリが作成できないので質問させていただきます。 | col1 | col2 | col3 | col4 | col5 | col6 | | 3 | 1 | 0 | 5 | 4 | 12 | | 2 | 5 | 6 | 0 | 1 | 8 | 以上のようなカラムが存在するテーブルで 複数の検索条件のうち３つが該当すればそのレコードを取得するような クエリを作成したいのですが、どなたか教えていただけないでしょうか。 イメージとしてはA,B,C,D,E,Fという６つの条件のうち ABC、ABF、ADF、DEF・・・・等、LOTO6でいう5等の結果だけが 取得できるようなクエリです。 よろしくお願いいたします。
お世話になります。 php+MySQLの環境でレコードが何行目になるかを 知る方法を教えてください。 まず下記のようなテーブルがあるとします。 |　　id　　|　　name　　| -------------------- ｜　　1　｜　 山田　　｜ ｜　　2　｜　 田中　　｜ ｜　　3　｜　 中村　　｜ ｜　　5　｜　 山本　　｜ idはAutoIncrementで振っています。 nameは重複することはありません。 レコードは更新状況により削除されることがあるため、 idは必ずしも連番になっているわけではありません。 このような状況で上のテーブルの「山本」を ORDER BY id ASC で取得する際に「山本は4行目である」 ということがわかる方法を教えてください。 よろしくお願いいたします。
お世話になっております。 MYSQLで sql_id (int PK) sql_data (text) のようなテーブル(sql_db)を持ち select sql_id from where (sql_data をsqlとして実行した結果 ) > 200 のように、フィールドから取得した値をSQLとして実行したりする方法はございますでしょうか。 ご教授よろしくお願いいたします。
【質問内容】 出稿した求人広告に関する情報を収めたデータベース内に、以下の2つのテーブルがあります ※以下の文章を読むより、添付画像をご覧頂いたほうが分かりやすいと思いますが 1.出稿した求人広告の情報 テーブル名：ad_info id　ID plan　広告プラン名 date_from　DATE 広告開始日 2011-12-16 date_until　DATE 広告終了日 2011-12-31 price　広告料金 2.求人サイトへのアクセス情報（広告掲載期間のみ毎日2時間おきに収集） テーブル名：daily_access id ID created_at DATETIME　クローリングした日時 2011-12-16 17:00:00 pv プレビュー数 applicants 応募者数 occupation_ranking 職種別画面での自社の掲載順位 newly_ranking 新着企業画面での掲載順位 この2つのテーブルからad_infoの広告ごとに（その掲載期間ごとに）、daily_accessのデータを集計したいと思っています。しかしそのためのSQL文がうまく書けず、詰まっています。 どうか良い方法を教えていただけませんでしょうか。 あるいは「テーブル構造自体を変えたほうがいいよ」、「SQL文の書き方が良くないよ」など直接関係のないことでも大歓迎です。 よろしくお願いします。 【MySQLバージョン情報】 $ mysql --version mysql Ver 14.14 Distrib 5.5.16, for Linux (x86_64) using EditLine wrapper 【テーブル作成文】 CREATE TABLE `ad_info` ( `id` INTEGER NOT NULL AUTO_INCREMENT, `plan` VARCHAR(30) DEFAULT NULL, `date_from` DATE DEFAULT NULL, `date_until` DATE DEFAULT NULL, `price` INTEGER DEFAULT NULL, PRIMARY KEY (id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; CREATE TABLE `daily_access` ( `id` INTEGER NOT NULL AUTO_INCREMENT, `created_at` DATETIME NOT NULL, `pv` INTEGER DEFAULT NULL, `applicants` INTEGER DEFAULT NULL, `occupation_ranking` INTEGER DEFAULT NULL, `newly_ranking` INTEGER DEFAULT NULL, PRIMARY KEY (id) ) ENGINE=InnoDB DEFAULT CHARSET=utf8;
bテーブルにc=a.cのデータが存在しない、あるいはc=a.cに一致するフィールドdの時刻が10分経過している場合にUPDATEを実行するクエリを考案中です。ベタ書きすると以下のようになると思うのですが、同じSELECT文が2回出てきます。これらをまとめることは可能でしょうか。 UPDATE a SET foo=? WHERE id=? AND (NOT EXISTS(SELECT d FROM b WHERE c = a.c) OR TIMEDIFF((SELECT d FROM b WHERE c = a.c), NOW()) > '00:10:00');
今、卒業研究でホームページ作成をしています。accessのデータをホームページに反映させるためにjavascriptを使用しているのですが知識がなくエラーがたくさん出ます。ソースを貼りますので誰かわかる方教えて下さい エラーの内容は「～はnullまたはオブジェクトではありません」というものです。 var database; var r01; var r02; onload = init; onunload = dbClose; function init(){ dbConnect(); dataDisp(); } //データベースに接続 function dbConnect() { database = new ActiveXObject("ADODB.Connection"); database.Open("Driver={Microsoft Access Driver (*.mdb)}; DBQ=F:\\ikumi\\SampleDB010\\SampleDB010.mdb;"); alert("データベースに接続しました。"); } //データベースを切断 function dbClose() { database.Close(); database = null; alert("データベースを切断しました。"); } function focus(obj){ obj.style.backgroundColor = "#ffff00"; } function blur(obj){ obj.style.backgroundColor = "#ffffff"; } //データ表示 function dataDisp() { if (r01[0].checked){ var mySql = "SELECT * FROM 1 WHERE [1].station='大分'"; alert("SQL"); var recordSet = database.Execute(mySql); var tempHtml=""; document.getElementById("disp").innerHTML = ""; while (!recordSet.EOF){ tempHtml = tempHtml + recordSet(0) + "; " + "<br />"; recordSet.MoveNext(); } document.getElementById("disp").innerHTML = tempHtml; recordSet.Close(); recordSet = null; /**/; var mySql = "SELECT * FROM 1 "; var recordSet = database.Execute(mySql); var tempHtml=""; document.getElementById("disp").innerHTML = ""; while (!recordSet.EOF){ tempHtml = tempHtml + recordSet(0) + "; " + "<br />"; recordSet.MoveNext(); } document.getElementById("disp").innerHTML = tempHtml; recordSet.Close(); recordSet = null; /**/}; } SQL文がいまいちよく分からないので、 多分SQLの部分のエラーだと思います。
Mysqlで以下のような条件のSQL文がわかりません。 hogeというフィールドの値に１があればそのレコードを取得 hogeに1という値のフィールド値をもったレコードがないならhogeが空のレコードを取得したいのですが方法がわかりません。 SELECT * FROM `tebleA` where (`hoge` = '1') or `postageFee_memId` = '' LIMIT 5 上のSQL文ではどうしても「`postageFee_memId` = '' 」のほうが優先されます。 （優先されるのはオートインクリメントIDが小さいから当然ですが・・） 「`hoge` = '1'」が絶対優先されるようにしたいのです。 いわゆる 「`hoge` = '1'」がない場合だけ「`postageFee_memId` = ''」が実行できればと思います。 ifとかを使って条件文をかけばいいのでしょうか？ 足らずの情報があればおっしゃってください。 何卒ご教授お願いいたします。
MySQLに携帯番号を登録すると頭の0が消えてしまいます。 消えない方法や設定があれば教えてください。 例）登録情報　090-111-1111→MySQL内データ　90-111-1111 すいませんが教えてください。
CREATE TABLE `ip` ( `ip` varchar(100) COLLATE utf8_unicode_ci NOT NULL, `date` datetime NOT NULL, PRIMARY KEY (`ip`), KEY `date` (`date`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci このようなMySQLのテーブルがあり、サイトに訪問者がアクセスしてきたら SELECT ip FROM ip WHERE ip = "{訪問者のIP}" のようにしてIPが記録されているかを確認し、もし記録されていなければ INSERT INTO ip VALUE ('{訪問者のIP}','{現在のタイムスタンプ}') のようにしてIPとタイムスタンプを記録し、その上で DELETE FROM ip WHERE date < '{7日前のタイムスタンプ}' のようにして古いIPを消す、みたいなプログラムがあります。 このようなプログラムで記録するIPが数万、数十万と増えてきたとき、 負荷削減などを考えるとMySQLを使わずに、 INSERTの代わりにファイル名がIP、内容が空のファイルを生成し、 SELECTの代わりにファイルが存在するかをチェックし、 DELETEの代わりにファイル生成時間が7日前以前のファイルを削除する、 というようなプログラムにしたほうがいいのかと疑問を抱えています。 IPの1文字目、2文字目などから適宜ディレクトリ分けし、 １ディレクトリ内のファイル数が多くならないように調整するようにと考えています。 MySQLを使うのと使わないのとで、 一般的にはどちらのほうが高速に処理できますか？ よろしくお願い致します。
次のようなテーブルをidでカウントし「4」という結果を得たい (重複したものはカウントしない)のですがどのような式を 書いたらよろしいのでしょうか？ 回答よろしくお願いします。 id　| char 1 | A 1 | B 1 | C 2 | A 2 | B 3 | A 4 | B 4 | C
MySQLのDatetime型で　時間部分が00：00：00のデーターだけを抽出する方法を教えてください。 MySQLのデータ（列：Datetime型） 2011-12-01 00:00:00 2011-12-01 20:15:45 2011-12-01 20:46:45 2011-12-02 00:00:00 2011-12-02 11:11:11 2011-12-03 22:22:22 2011-12-04 00:00:00 このようなデータの中から時間部分が「00：00：00」のものを抽出したいと思います。 求める結果は 2011-12-01 00:00:00 2011-12-02 00:00:00 2011-12-04 00:00:00 です。 期間で抽出するのであれば SELECT * FROM `テーブル名` WHERE date>='2012/12/05 00:00:00' AND date<='2012/12/07 23:59:59' のようなクエリで良いと思うのですが、「00:00:00:」が含まれるものだけを抽出しようと思うとうまくいきません。 LIKE 00:00:00 でできるかもしれないと思いましたがダメでした。
カラム名を指定してデータを挿入するのがうまくいきません。 テーブル（tb1）作成後、たとえば、 insert into tb1(number, name, age) values(A104, '渡辺', 23); と入力すると、 '> と出力されてしまいます。 何が間違っているんでしょうか？ よろしくお願いいたします。
MySQL超初心者です。 ＸＡＭＰＰをインストールしてMySQLの勉強を始めたばかりです。 コマンドプロンプトで日本語入力ができません。 「基礎からのMySQL」という本の内容にそって進んでおり、文字コードの設定 character-set-server = sjis #collation-server = latin1_general-ci skip-character-set-client-handshake もやりましたが、日本語が全く入力できません。 そもそもインストールやセットアップの段階で、画面に表示される日本語が文字化けして読めない状態でした。（ブラウザで日本語のウェブサイトを閲覧する際にもよく文字化けがおこります。グーグルクロームを使っています。）海外で購入したパソコン(eMachines, Windows XP)であることが問題なのでしょうか？何か設定が必要なのでしょうか？ コントロールパネルから言語の設定にて、日本語でキーボード入力できるようにしたので（Microsoft IME)、日常メールをするときなどの日本語入力の問題はありません。 以上よろしくお願いいたします。
現在「基礎からのMySQL」という本を購入して勉強を始めたばかりの超初心者です。 XAMPPをインストールし、パスワードを設定しようとしコマンドプロンプトで、>の後ろに「mysqladmin -u root PASSWORD 1234」と打つと、以下のような表示が出ます。 「’mysqladmin’は内部コマンドまたは外部コマンド、操作可能なプログラムまたはバッチファイルとして認識されていません」 'mysqladmin' is not recognized as as internal or external command, operable program or batch file. Windows XP を使用しています。 原因は何でしょう？インストールにおいて何かが間違っていたのでしょうか？ どのように解決すればよいのでしょうか？ すでに投稿された類似の質問もチェックしてみたのですが依然としてよく分かりません。 よろしくお願い致します。
Connection　cn = DriverManager.DriverManager.getConnection(dsn); 引数のdsnには以下のように入力するとありました。 jdbc:mysql://ホスト名/データベース名[?属性情報] ホスト名ってなんですか？ データベース名はcreate table文で作ったtableの名前ですか？それともmysqlのことですか？ 非常に初歩的な質問かと思いますが、宜しくお願いします。
MySQL5で、 TIMESTAMP型のカラムに格納されるのは、UTCでしょうか。 それともローカルタイムゾーンなのでしょうか？ あるいは、設定による、のでしょうか？ ＞TIMESTAMP カラムの値は、ストレージでは現在のタイム ゾーンから UTC へ、読み出しでは UTC からカレントのタイム ゾーンに変換します。 http://dev.mysql.com/doc/refman/5.1/ja/time-zone … と書いてあったのを見て、TIMESTAMP型のカラムに格納されるのは、UTC(日本時間-9)だ、と思ったのですが、 実際にカラムの中を確認してみると、その時点の日本時間が格納されています。 ＞TIMESTAMP 値は、現在のタイムゾーンから変換されて格納され、また検索された時に現在のタイムゾーンに再変換されながら、ＵＴＣに格納されます。 http://dev.mysql.com/doc/refman/5.1/ja/timestamp … こちらでも、「ＵＴＣに格納されます」って書かれているのですが、 これは、「現在のタイムゾーンをそれぞれの接続ごとに設定した場合」に限っての話なのでしょうか？ それとも、ストレージでは、って書かれているので、 ストレージのことが絡んでいるのでしょうか？(ストレージって何のことですか)
例えば「2ちゃんねる」の全スレッドを、一つのテーブルで管理するといったことは可能でしょうか？ （レコード数は仮に40万件程度として、常時読み書きが行われるとします） ざっくり調べた感じでは、レコード数が100万程度でも、インデックスさえ適切なら パフォーマンスを保ちつつ運用できそうな感じでしたが、どうなんでしょう。 もし問題があるとしたら、その問題点についても教えて頂けるとあり難いです。
MYSQLの質問です。 <データ> |--|----------|---------| |ID|FOLDER1 |FOLDER2 | |--|----------|---------| |01|AAAAA1 |NULL | |02|AAAAA2 |AAAAA1 | |03|AAAAA3 |AAAAA2 | |04|AAAAA4 |AAAAA3 | |05|AAAAA5 |NULL | |06|AAAAA6 |AAAAA5 | |07|AAAAA7 |AAAAA6 | |08|AAAAA8 |AAAAA7 | |09|AAAAA9 |AAAAA8 | |10|AAAAA10 |AAAAA9 | ---|----------|---------- <条件> FOLDERがNULLでない場合、処理を繰り返す <処理> 同一テーブル上で、 FOLDER1とFOLDER2を比較して同じであればFOLDER1のデータを保持し、 "/"を追加して次に取得した結果に接続する <取得したい結果> AAAAA1/AAAAA2/AAAAA3/AAAAA4/AAAAA5 AAAAA5/AAAAA6/AAAAA7/AAAAA8/AAAAA9/AAAAA10 上記を１回で検索するSQLがご存知の方がいらっしゃいましたら、ご教授ください。
恐れ入ります。 異なるデータベース上、例えば、 database1上のtable1 database2上のtable2 をPerlを使って、table1のcol1 と、table2のcol1の共通IDで結合し、 Web上でデータを表現したいのですが、なかなかうまくいきません。 ご教授いただける方いらっしゃいますでしょうか。 よろしくお願いします。
sql初心者です。 複数テーブルからselectする書き方が解らず質問です。 ユーザーtable user_code | name | address ------------------------------- 1 | 山田 | 北海道 2 | 高橋 | 東京 3 | 鈴木 | 仙台 4 | 岡田 | 北海道 来店table raiten_code | user_code | raiten_date ------------------------------- 1 | 1 | 2011/05/23 2 | 3 | 2011/08/05 3 | 4 | 2011/08/05 4 | 2 | 2011/08/05 5 | 1 | 2011/10/09 6 | 1 | 2011/08/05 とテーブルがあったとして、 北海道に住むお客様 + 2011/08/05の日付指定で来店記録を拾いだしたいと思っています。 (5日に来店の北海道の方) SELECT * FROM ユーザーtable WHERE address='北海道' union SELECT * FROM 来店table WHERE visit_date ='2011/08/05'; unionにマージとあったので、多分違いそうだなと思いつつ、試してみましたが、うまくいかずにいます。 mysqlのリファレンスマニュアルなども色々見ているのですが、答えにたどり着けません。 なにかヒントのようなものでもかまいませんので、お助けいただけると助かります。
同じ構成のテーブルがテーブル1～テーブル6まであり、6つのテーブルを集計するSQLを作成しています。 カラムは ID、名前、日付1、日付2、ステータス1、ステータス2 です。 IDがプライマリーキーになっており、テーブル1にしかないIDや全てのテーブルに登録されているIDなどもあり、IDの一覧を作成したいです。 IDが重複していた場合、名前はどれを残しても構わないのですが(どのテーブルか指定する必要があるのならばとりあえずテーブル番号が若い方の名前を残すようにしてください。) 日付1は最古の日付 日付2は最新の日付 ステータスは共に優先順位が1>2>0>nullとなっており優先順位が高いほうを残すようにし、ステータスが両方nullの場合は集計しないようにしたいです。 テーブル1 ID、名前、日付1、日付2、ステータス1、ステータス2 111、あああ、2001/1/1、2001/1/1、2、2 222、いいい、2001/1/1、2001/1/1、2、2 333、ううう、2001/1/1、2001/1/1、null、null 555、おおお、2001/1/1、2001/1/1、2、2 テーブル2 ID、名前、日付1、日付2、ステータス1、ステータス2 111、aaa、2002/2/2、2002/2/2、0、null 222、iii、2002/2/2、2002/2/2、1、0 333、uuu、2002/2/2、2002/2/2、null、null 444、eee、2002/2/2、2002/2/2、1、1 結果 ID、名前、日付1、日付2、ステータス1、ステータス2 111、あああ、2001/1/1、2002/2/2、2、2 222、いいい、2001/1/1、2002/2/2、1、2 444、eee、2002/2/2、2002/2/2、1、1 555、おおお、2001/1/1、2001/1/1、2、2 このようなことを6つのテーブルを集計して行いたいです。 SELECT t1.id,MIN(t1.日付1)as 日付1,MAX(t1.日付2)as 日付2,CASE When t1.ステータス1="1" then "1" else t1.ステータス1 end ,CASE When t1.ステータス2="1" then "1" else t1.ステータス2 end FROM( SELECT * FROM テーブル1 UNION All SELECT * FROM テーブル2 UNION All SELECT * FROM テーブル3 UNION All SELECT * FROM テーブル4 UNION All SELECT * FROM テーブル5 UNION All SELECT * FROM テーブル6 )as t1 WHERE NOT(t1.ステータス1 IS null AND t1.ステータス2 IS null) GROUP BY id 日付は出来ていると思うのですが、ステータスで1の優先がまだ出来ていないので修正お願いいたします。
phpMyAdimnとコマンドラインで現在の文字コードを取得すると結果がことなる。 文字コードを調べる為に「show variables like 'char%';」を phpMyAdminLとコマンドラインで上で流したのですが結果がことなります。 phpMyAdmin character_set_client utf8 character_set_connection sjis character_set_database latin1 character_set_filesystem binary character_set_results utf8 character_set_server sjis character_set_system utf8 character_sets_dir /usr/share/mysql/charsets/ コマンドライン character_set_client | sjis | character_set_connection | sjis | character_set_database | sjis | character_set_filesystem | binary | character_set_results | sjis | character_set_server | sjis | character_set_system | utf8 | character_sets_dir | /usr/share/mysql/charsets/ my.cnfで下記の設定を行っております。 [mysqld] character-set-server = sjis collation-server = ujis_japanese_ci skip-character-set-client-handshake [mysql] default-character-set=sjis [client] default-character-set=sjis 日本語文字も正しく登録、更新できphpMyAdminでも正しく表示されていると思うのですが phpMyAdminで結果が異なるのが気になり質問させていただきました。 phpMyAdminでの結果は無視しても問題ないのでしょうか。 環境 CentOs 5.7 Mysql 5.5.17 phpMyAdimn 3.4.7 php 5.3
SQL初心者です。 製品ID　使用部品 A　　　　　1 A　　　　　2 A　　　　　3 B　　　　　1 B　　　　　2 C　　　　　1 というテーブルから、 指定した部品を使用している製品IDを取り出したいです。 例えば、1と2を指定した場合に、AとBを返して欲しいのですが、 どういったクエリを書けば良いのでしょうか？ select 製品ID from TB where 使用部品=1 or 使用部品=2 とすると当然ながらCまで返してきてどうしたら良いかわかりません。 宜しくお願いします。
select * from data_table order by case status when 'status1' then 1 when 'status2' then 2 when 'status3' then 2 when 'status4' then 3 else 4 end , 登録日 DESC 上記は、status1>status2,status3>status4の優先順位で登録日順にSQLを取得しています。 このSQL文を改良し、status1の場合のみ登録日ではなく更新日順に並び替えた状態で 取得を行いたいです。良い方法はありませんか？
いつもお世話になっております。MySQLを利用しておりまして質問です。 同じ構成のテーブルが5つあり、選択されたテーブルを集計するSQLを作成しています。 カラムを簡単に構成を書くと ID、名前、ステータス1、ステータス2 のような形です。 テーブル1、2、3が選択された場合 テーブル1と2でIDの重複のない一覧を作成し、IDが被っていた場合はステータスをそれぞれ大きいほうを保持するようにします。 そして次にテーブル1、2を合わせたテーブルとテーブル3で同じように集計をしたいのですが、ここがうまく出来ません。 実際の環境ではなく簡素化したものなのでおかしな点があるかもしれませんがこのようになっています。 SELECT TTT1.id,TTT1.名前,TTT1.st1,TTT1.st2 FROM( 　　　　SELECT id,名前,ステータス1 as st1,ステータス2 as st2 　　　　FROM( 　　　　　　　SELECT * 　　　　　　　FROM テーブル1 T1 　　　　　　　WHERE T1.id NOT IN(SELECT T2.id FROM テーブル2 T2) 　　　　　　　UNION All 　　　　　　　SELECT * 　　　　　　　FROM テーブル2 T2 　　　　　　　WHERE T2.id NOT IN(SELECT T1.id FROM テーブル T1) 　　　　) as TT1 　　　　UNION 　　　　SELECT id,名前,st1,st2 　　　　FROM( 　　　　　　　　SELECT T1.id,T1.名前, 　　　　　　　　(CASE T1.ステータス1 or T2.ステータス1 WHEN "2" THEN "2" WHEN "1" THEN "1" WHEN "0" THEN "0" ELSE null END) as st1, 　　　　　　　　(CASE T1.ステータス2 or T2.ステータス2 WHEN "2" THEN "2" WHEN "1" THEN "1" WHEN "0" THEN "0" ELSE null END) as st2, 　　　　　　　　FROM テーブル1 T1,テーブル2 T2 　　　　　　　　WHERE T1.id = T2.id AND NOT(T1.st1 IS null AND T1.st2 IS null AND T2.st1 IS null AND T2.st2 IS null) ) as TT2 )as TTT1 /* UNION ALL SELECT id,名前,st1,st2 FROM (TTT1とテーブル3を比較したもの)as TTT2 */ /**/で囲ったところでTTT1が呼び出せれば、テーブル1のところをTTT1にし、テーブル2をテーブル3にすれば出来ると思うのですが、そういうことは無理なのでしょうか？ また集計するテーブルの数が不特定なので一つずつ集計をする形を取りましたが、 もっとこういう風にやればいいと言う方法はございますでしょうか？ よろしくお願いいたします。
こんにちは、はじめまして。phpとmysqlで以下のような処理をしたいのですが どうすればよいか分からず、ご質問させていただきました。 前提として、下記のような「アイテム」、「ユーザー」、「画像」を管理する３つのtableが あり、「画像」テーブルでは、どのアイテムに（item_id）どのユーザーが（user_id）その 画像を投稿したかを管理するtableが存在します。 そこで、画像が投稿された際に、アイテムtableの、「item_image」のカラムに item_idと、user_idがマッチする【image_id】をupdateしたいのですが ※item_idと、user_idの値については保持しており、データがあります。 　また、item_idと、user_idの組み合わせはユニークで、画像table内に１つしかありません。 image_idをどのように抽出すればいいか分からずご相談させていただきました。 ※ちなみに、item_id,user_id,image_idは、PRIMARY KEYです。 環境など補足が必要でしたらご連絡いただけますと幸いです。 どうかよろしくお願いいたします。 ■アイテムtable item_id　｜item_name ｜ item_image・・・ ------------------------ １　　　　｜aaa　　　　　｜4 ■ユーザーtable user_id | user_name ------------------------ 3 　　　｜ aaa ■画像table image_id ｜　item_id　｜ user_id ------------------------ 4　　　　　｜ 1 ｜ 3
分からない感満載で質問しますが、何卒ご容赦を。 mysqldは複数起動ができますが、この複数起動の使いどころが疑問です。 テスト的な使い方や、レプリケーションでの利用は想像できるのですが、不特定多数のユーザー数分起動するといった使い方は果たして現実的でしょうか？ たとえば、不特定多数のユーザーに向けてゲームなどのサービスを提供する場合、ユーザー管理をテーブル単位、データベース単位、mysqld単位でできそうですが、パフォーマンスを考えずに利用するならmysqld単位で管理するほうが幅があって便利そうに思えます。 ご存知であれば、mysqld複数起動運用のメリット・デメリットを伺えたらと思います。 個人的な予想としては、メモリを大量に消費するのではないかと思っているのですが。どうなんでしょう。
いつもお世話になっております。 MySQLで以下のようなSQL文を発行しています。 select * from table where (INSTR(`table`.`name`,'キーワード')<>0 OR INSTR(`table`.`keyword`,'キーワード')<>0) nameカラムとkeywordカラムのどちらのカラムから検索されたのか知りたいのですが どのようにしたらよろしいでしょうか。 （「キーワード」文字列がどちらのカラムに入っているのか知りたいです。） ［環境］ 　MySQL：5.5.16 よろしくご教示お願いいたします。
恐れ入ります。 Mysqlを使ってランキングサイトを作成しようと思っています。 num,name,url,comment,in,out としてカラムを作成して、 ランキング表示をする感じです。 IN OUT カウントをデータベースに回数を保存するにはどのようにしたら良いでしょうか。 よろしくお願いします。
とあるデータベース（mysql）に以下の２つのテーブルがあります。（【テーブル名】カラム名となっています） 【ブログ管理テーブル】 ブログID　ブログカテゴリ　ブログサイト名　ブログサイトURL　 【記事管理テーブル】 記事タイトル　記事URL　記事フィード この２つのテーブルから次のような値を取り出したいと思っています。 ブログカテゴリ　記事タイトル　記事URL　記事フィード 複数のテーブルから値を取り出すには、テーブル同士を結合しないといけないということが分かり結合させてみたのですが、なぜか取り出すことができません・・・しかも、記事が重複して表示されてしまう・・・ 一体どのようなプログラムが必要でしょうか？ 以上よろしくお願いします。
(状態)-(分類) 状態a-03 状態a-02 状態a-01 状態b-01 状態c-02 状態b-03 状態d-04 状態e-01 状態e-02 状態e-03 mysql上のデータを上記のように並べたいるために、 まず(状態)をまとめるために次の通りorder by caseを使いました。 select * from data order by case 状態 when '状態a' then 1 when '状態b' then 2 when '状態c' then 2 when '状態d' then 2 when '状態e' then 3 else 4 end しかし、分類が状態aの場合と(状態bからd)の場合で (分類)の値に対する並び替えを変更することができません。 どうやったら、上記の並び替えができるのか、教えていただけると幸いです。
perlとmysqlを使っています。 htmlのformタグからえたテキストをCGIに送って データベースに保存しているのですが、送信ボタンを押すと２回データベースに 保存されてしまいます。 同じデータがふたつ保存されるのではなく、 一つ目はすべてNULLのデータが保存され 二つ目にｍformの内容が保存されます。 CGIのほうのSQL文はひとつしか書いていません。for文も使っていません。 ＜－－－－－以下form部分のソースーーーーー＞ print "<form method=\"POST\" action=\"./CGI/save_DB.cgi\" name=\"saveform_2\"target=\"subwindow\" onSubmit=\"openwin();\">"; print "<div>タイトル：<input type=\"text\" name=\"TITLE\" autocomplete=off value='"; print "$TITLE\'></div>"; print "<input type=\"submit\" value=\"保存\">"; print "</form>"; ＜－－－－－以下save_DB.cgi　SQL実行部分のソースーーーーー＞ my $TITLE = $cgi->param('TITLE'); my $dbh = DBI->connect("DBI:mysql:host=${db_host};database=${db_name}", $db_user, $db_pass); my $sth = $dbh->prepare("INSERT INTO テーブル名 ( `title`) VALUES (＄TITLE); my $rv = $sth->execute(); データベースへの接続などの問題はありません。 ブラウザはクロームですが、IEで試しても同じ現象がでました。 考えられる原因、おもいあたる原因がありましたら、教えてください。 また、原因がわからなくても、回避できそうなやり方があれば教えてください。 よろしくお願いいたします。
SQL文にPHPの変数のように変動する値を指定することはできますでしょうか。 データベースから特定のレコードを拾ってきて PHPのPOSTメソッドでその値を送信するシステムを作ろうとしています。 具体的には、データベースに名簿（IDと名前だけの簡単なものです）を 予め作っておき、送信ボタンをクリックしたユーザーのIDと紐付いている 名前を送信したいと考えています。 [MySQL] table:meibo id | name ------------ 1 | itou 2 | yamada 3 | suzuki [PHPソース]（一部抜粋） ------------ $sql = mysql_query('SELECT * FROM meibo where id=【ここを変動させたい】', $connect); $sql = mysql_fetch_array($sql); $req->addPostData("user_name", $sql['name']); ------------ $idに操作しているユーザーのIDが代入されているとして 以下のようにmysql_queryの中で実行しているSELECT文に$idを利用することは可能でしょうか。 SELECT * FROM meibo where id=$id もし上記のような方法が無理な場合、 代替案をご提案いただけると非常に助かります。 読みにくい文章で恐縮ですが、 どうかお助けください。 よろしくお願いします。
mysqlのデータベースから、列の最大値を取り出したいのですが、 以下のように書いているのですが、取得される値が１しか返ってこないです。 間違っているところはあるでしょうか？ perlで書いています。 my $dbh = DBI->connect("DBI:mysql:host=${db_host};database=${db_name}", $db_user, $db_pass); my $sth = $dbh->prepare("SELECT MAX(列名) FROM テーブル名"); my $rv = $sth->execute(); print "$rv";
下記の場合、どのようなsqlを書けばいいのでしょうか？ 以下のようなテーブルがあるとします。 apple ←　テーブル名 name1,　name2,　name3,　hide←カラム 日本,　おいしい,　赤りんご,　1←ここからデータ アメリカ,　りんご,　い,　0 りんご,　まずい,　高い,　0 ------------------------------------ 【条件】 name1, name2, name3 のどれかが”りんご”が含まれている かつ　hide が 0 どのようにすればいいのでしょうか？ ためしに、 select * from apple where hide=0 and name1 lile %りんご%　or name2 like %りんご% or name3 like %りんご% で試してみましたが、希望した結果が出ませんでした。 どうぞよろしくお願いします。
こんにちは、 データベースにはTABLE1とTABLE2の二つのテーブルがあって、TABLE1からTABLE2に、一つのフィールドを除いてほかのすべてのフィルードを移すには、どうすればいいのでしょうか INSERT INTO TABLE2 SELECT * FROM TABLE1 WHERE field_name != ID みたいなものがないのでしょうか IDフィールド以外にほかのすべてのフィールドを移したい。 TABLE 2の構造は IDフィールド COL2 COL3 COL4 ... COL50 つまりCOL2からCOL50までのデータを移したいのですが、できればフィールドを一つ一つ書くのを避けたいのです。 詳しい方がいらっしゃいましたら。ご回答をよろしくお願いします。
SQliteの日付検索について教えてください。 現在、SQLiteでデータベースを作成しています。 日付で範囲を選択してデーターを抽出したいのですが、方法がよく分かりません。 （例：2011-08-20から2011-08-27までの日にち分のデータを抜き出したい） どなたか教えてください。 ちなみにデータベースにはDATE型でdateのcolumに”2011-08-20”という風に保存してあります。
このジャンルでお願いします。 よくアクセスログの解析を無料で（リンクを貼ったりして）行ってくれるサービスがありますが、 そのデータベースの構造というかテーブルの構造はどのようになっているのでしょうか？ 例えば、膨大なレコード数になると思うので それを利用するユーザー毎にテーブルを分けるとかするのでしょうか？ あるいはユーザー毎、年毎、月毎、日毎、に分けるとか？ 本来ならテーブルを分割したりするのは違うんじゃないかなぁと思ったりするのですが、 なので次のように、 CREATE TABLE `accesslog` ( `id` int NOT NULL auto_increment, `user_id` varchar(16), `created` datetime, `ip` varchar(64), FOREIGN KEY(`user_id`) REFERENCES `user`(`id`) ); ユーザーも全ての期間のデータも1つのテーブルで管理するのが普通だとは思うのですが、 アクセスログだけは利用するユーザー数にもよりますがやはり膨大になりますよね？ そうすると1つのテーブルだと無理があると思うのです。 あるいは単にテキストファイルとして保存する方法もあるのかな？と思うのですが、 やはりなにかとＳＱＬで操作したいのでMySQLなどのテーブルの設計が知りたいです。
■下記SQL文の意味を教えてください SELECT a.*, b.being_name FROM alive a 　LEFT JOIN being b ON a.hoge_id = b.id 　LEFT JOIN call c ON c.call_id = a.hoge_id 　　AND f.hoge_id = 12 　WHERE f.hoge_id = 12 OR b.id = 12 ※12の部分は動的に切り替わります ・LEFT JOINが2つあるので、3つのテーブルを結合しているのでしょうか？ ・左テーブルは「alive a」で、この右側に2つのテーブルが結合している、という認識でよいでしょうか？ ＞SELECT フィールド名 FROM テーブル名 WHERE 条件式1 AND 条件式2 ＞「AND」は２つの条件式の論理積 ・上記内容をネットで見かけたのですが、「AND」は、「WHERE」の前に来てもいいのでしょうか？ それともこのSQLの「AND」は違う使い方をしているのでしょうか？ 何か、LEFT JOINに関係しているのでしょうか？
さくらのVPSを借りて構築を行っています。 基本的にMySQLだけを導入して運営させていてしばらく問題もなかったのですが、 最近、Perlなどを導入して権限周りに色々悩まされていました。 で、何が原因かはわかっていないのですが、MySQLが起動できなくなりました。 /etc/rc.d/init.d/mysqld restart を行うと、停止は出来るのですが起動に失敗します。 /var/log/mysqld.log　を見てみると、 InnoDB: The InnoDB memory heap is disabled InnoDB: Mutexes and rw_locks use GCC atomic builtins InnoDB: Compressed tables use zlib 1.2.3 InnoDB: Using Linux native AIO InnoDB: Initializing buffer pool, size = 128.0M InnoDB: Completed initialization of buffer pool InnoDB: highest supported file format is Barracuda. InnoDB: Waiting for the background threads to start InnoDB: 1.1.8 started; log sequence number 1595675 [ERROR] /usr/libexec/mysqld: Error writing file '/var/run/mysqld/mysqld.pid' (Errcode: 28) [ERROR] Can't start server: can't create PID file: No space left on device mysqld_safe Number of processes running now: 0 mysqld_safe mysqld restarted [Note] Plugin 'FEDERATED' is disabled. と書かれており、権限で起動が出来なくなってるのかと思い、 ls -ld /var/run/mysqld/　で調べてみると、 drwxr-xr-x 2 mysql mysql 4096 11月 1 23:52 /var/run/mysqld/ と、MySQLをインストールした時と同様に、ユーザーはmysqlのままでした。 一応、chown -R mysql:mysql /var/run/mysqld/　でもう一度設定しなおして再起動を試みましたが、起動のみやはり失敗して、同じエラーログとなっています。 Apacheの起動・停止は問題ありません。 OSはCentos5.7でApache2.2ですが、どうも権限周りの設定が良くわかっておりません。 どうにか再インストール無しでMySQLを起動させたいのですが、ご教示頂けますと幸いです。 宜しくお願い申し上げます。
SQLの操作についての問題について 今、データーベースについて勉強中なのですが何度やっても文法エラーなり困っております。 わかります方、アドバイスください。 自分で考えてやったのが INSERT INTO History(h_aid,tdate,delta) VALUES('B0010','2008-11-11-9:00:00',10000); UPDATE Accounts SET abalance=10000 WHERE aid='B0010'; わかりにくいのですがここからが問題です。 ２つの表「History」と「Accounts」に次の操作を行いなさい。 ・「History」表の，h_aid へ B0010，tdate へ 2008-11-11 9:00:00，delta へ -10000 を入力 ・「Accounts」表の，aid が B0010 の行の abalance を 10000 へ更新 ▼Accounts aid char(5) (主キー) owner varchar(30) (NULL不可) abalance INTEGER A0010 Alexander 15000 B0010 Caesar 20000 C0010 Maximilian 30000 ▼History h_aid char(5) (主キー) tdate TIMESTAMP (主キー) delta INTEGER A0010 2008-11-10 14:00:00 5000 本当に困っていまして、わかります方アドバイスよろしくお願いいたします。
素人ながらの質問で恐縮です。 検索してもいまいちよく概念がわかっていないので、解答頂けたら幸いです。 質問 １、phpmyadminに関してですが、Xampp上からしか機能しないんですかね？つまりローカルって事です。 ２、本物のサイトの管理において、phpmyadminは利用出来ますか？ ３、色々なサイトがphpmyadmin上の解説ではなくて、コマンドプロンプト上からの操作の解説です。何故でしょうか？phpmyadminの方が簡単ですし、Sql文も打てますよね？ ４、phpmyadminとコマンドプロンプトでは出来る事に違いがあるんでしょうか？
使うとしたら、どちらの方がいいんでしょうか？ phpmyadminは素人向きですか？ コマンドからの入力がふつうでしょうか？ どういう風に勉強していったらいいてしょうか？
質問失礼いたします。 1つのカラムから一致している単語が何個あるか数えたい のですが、可能かどうかもわからずの状況で、質問させていただきました。 下記のように1つのカラムがあるとします table1 ┼──────────┼ │kaisai　　　　　　　　　　　│ ┼──────────┼ │東京、福岡、広島、愛知│ ┼──────────┼ │東京、北海道、大阪　　│ ┼──────────┼ │広島、福岡、沖縄、愛知│ ┼──────────┼ │広島、福岡、愛知　　　　│ ┼──────────┼ その中から'東京''福岡''愛知'に一致する数を調べ 下記のような結果にしたいのですが、 table1 ┼──┼ │kaisai│ ┼──┼ │3　　│ ┼──┼ │1　　│ ┼──┼ │2　　│ ┼──┼ │2　　│ ┼──┼ このようなことって、可能なのでしょうか？ ご存じの方いらっしゃいましたら、恐れ入りますがSQL文と共にご回答いただければ幸いです。
すいません、先ほど「条件が複雑なSQL文」の質問を立てさせてもらったのですが、 あとから自分で考えてもおかしな（どうやっていいのか分からないというか・・・） 部分がありましたので、今回はそれよりは簡潔（？^^;））な内容の質問なのですが、 例えば、「abcd」という文字列が、あるテーブルのnameに含まれてるかを調べたいとします。 そしてマッチした割合やあと何文字でマッチするか？のデータも欲しいのです。 この場合のSQL文はどのように記述すれば良いのでしょうか？ 【調べる文字列】 abcd [tbl] id　　name 1　　　ab 2　　　abcd 3　　　abcdefgh 4　　　xyz 【得たい結果（マッチした割合％の降順）】 [tblのid]　[nameにマッチした割合％（パーセント）]　[nameにあと何文字でマッチするか？] 　　2　　　　　　　　　　100　　　　　　　　　　　　　　　　　　　　　　　　0 　　3　　　　　　　　　　　50　　　　　　　　　　　　　　　　　　　　　　　　4
WIN２０００SP4・IE６SP１の環境でMYSQL５．５．１７をインストールしようとしましたが START　SERVICEエラーとなってしまいます（DLLが足りない） MYSQL５．５．１７がWIN２０００に対応していないとおもいますが WIN２０００に対応したMYSQLのVERSIONおよびダウンロードURL等 ご教授お願いいたします
BLOB型にPDFファイルが格納されているテーブルの列を、select文で抽出して、拡張子にpdfをつけてファイル出力したのですが、BLOBで定義している最大サイズで必ず出力されてしまいます。 pdf のファイルをテキストで開いてみると、エンド（%%EOF）以降が空欄でBLOBのサイズの大きさまで充填されていました。 BLOB型にPDFファイルを格納してある場合の出力方法はどうすればいいのでしょうか？
php+mysqlにてある予約システムを作っている者です。 mysqlのクエリ作成で行き詰ってしまったので、ご質問させていただきます。 予約テーブルにはカラムid(key)、roomID(部屋番号),startTime(予約開始日時)、endTime(予約終了日時)があります。 部屋テーブルにはカラムid(部屋番号)、部屋名等があります。 実現したいのは、予約日時が被っている部屋id、予約テーブルのidの抽出(重複した予約)です。 一覧画面にて、予約に対して重複があるかないかを表示したいです。 予約テーブルのstartTimeが他の予約開始日時から予約終了日時までの間になければ、 重複予約はないということになると考えています。 しかし行き詰ってしまった原因は、検索対象がない？？ことです。 仮に開始時間だけでもWHERE句に入れられれば、 $検索対象予約開始日時 BETWEEN startTime AND endTime で検索できそうだと想像つくのですが、 その検索対象開始日時は予約テーブル内全部の予約開始日時なのです。 単純に考えると、予約テーブルのidとstartTimeを1件ずつ取得し、全件をBETWEENで検索ループなのでしょうが、 なんとかSQL1文で済ませられないかと思い、質問させていただきました。 疑問点が伝わるか不安な文章で大変申し訳ありませんが、お知恵をお貸しください。
こんにちは。 グループ化した後に条件で摘出する方法について教えて頂けますでしょうか。 例えば、以下のようなテーブルを作ったとして、 テーブル id tag_no 1 5 1 6 1 7 1 8 1 9 2 5 2 10 2 11 3 5 3 9 3 10 指定したtag_noを持つidを摘出したいのですが、tagnoを複数指定するのにはどのようにしたらよいのでしょうか・・・。 select table from group by id having tag_no = 5 and tag_no = 9;　として、 idの1と２を取り出す・・・といったことをやりたいのですが、 実際にやってみるとempty setとなります。 このテーブルで無理ならテーブルの変更もありなのですが、 一晩悩んでも思い浮かばず・・・。 mysqlはvar5.5です。 お力添えをよろしくお願い申し上げます。
こんにちは。mySQL初心者です。 例えば、「sample」というDBに以下の3つのフィールドのあるテーブル「text」があるとします。 （実際には、DATETIME型のフィールドも含めて20列あります） key => 整数型で、プライマリキー＆オートインクリメントを設定 status => テキスト型（UTF-8） note => テキスト型（UTF-8） ここで、「SELECT * FROM text WHERE key=1」というSQLで1つ目のレコードを取得しようとすると、「#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'key=1 LIMIT 0, 30' at line 1」というエラーが出てしまいます。 「SELECT * FROM text WHERE status='sample_01'」や「SELECT * FROM text WHERE note='test entry'」というSQL文ならちゃんとデータを取得できるのですが、「WHERE key=1」のようにプライマリキーで検索しようとするとエラーになるのは何故でしょうか。 どなたか見当が付くかたがいらっしゃいましたら、教えていただけないでしょうか。 よろしくお願いします。 ＜環境＞ XAMPP Ver.1.7.4で、mySQLは　Ver. 5.5.8です。
mysqlで同じデータが重複してしまっていて、それを１つにまとめたいのですが、適切な操作の方法が分かりません。ご教授いただけるとうれしいです。 table名:test name area number ken tokyo 1 jhon aichi 2 aiko osaka 3 ken tokyo 1 jhon aichi 2 aiko osaka 3 上のデータベースを例として重複データを削除するSQL文の書き方が知りたいです。 上の例でいくと下３行が削除できればいい形になりますね。 お手数ですがよろしくお願いします。
mysqlを使用しています。WEBから必要なデータを入力し、webで表示させるプログラムを作っています。１テーブル１のみ作り、その主キー（例えば学生番号）を入力するとその学生番号に関する学 の名前や住所などテーブルに入力した内容が出力できるプログラムを作りました。しかし、それはテーブル１のときのみ有効で、テーブルが２つ以上あるときはエラーがでてつかえません。 ２つ以上テーブルを作り、例えばテーブル２には、その学生番号に対する学生の趣味や特技などが書いてあるとします。そのWEBで入力した学生番号に対する全てのテーブル内容のデータ（名前、住所、趣味、特技など）を一括出力するプログラムはどのようにしたらいいのでしょうか？ 初心者な私にどうかご指摘お願いします。 大変困っています。よろしくお願いします。 以下のプログラムはテーブルが１つのときのみ有効なプログラムです。 //WEBで入力するプログラム sb.append("<p>Show the designated row in all the tables<br>\n"); sb.append("<script language=\"JavaScript\"><!--\n"); sb.append("function idButton(){\n"); sb.append("rowNo = document.idInput.inId.value;\n"); sb.append("location.href = \"/abc/retrieve/\"+rowNo;\n"); sb.append("}// --></script>\n"); sb.append("<form name=\"idInput\">\n"); sb.append("Enter Row No.\n"); sb.append("<input type=\"text\" size=\"5\" name=\"inId\">\n"); sb .append("<input type=\"button\" value=\"ok\" onclick=\"idButton()\">\n"); sb.append("</form><br>\n"); ・ ・ ・ @GET @Path("/retrieve") @Produces("text/html") public String retrieve_table(@QueryParam("name") String tablename) { // ▲▲指定されたテーブル名の内容表示 ・ ・ ・ try { // ドライバクラスをロード ・・・ // MySQLへ接続 ・・・ // ステートメントオブジェクトを生成 Statement stmt = con.createStatement(); String sql; sql = "SELECT * FROM " + tablename; // クエリーを実行して結果セットを取得 ResultSet rs = stmt.executeQuery(sql); ・ ・ ・
WEBアプリ上の、MySQLのトランザクションについて質問です。 トランザクションは、データの挿入に矛盾がない場合commitすることによって データの挿入等を確定する機構だとおもいますが、 この仕組みって、トランザクション中は作業対象のテーブルは実行中のクライアント以外 アクセスできなくなる（※つまりロック？がかかっている？）のでしょうか？ そうじゃないと、意味がないですよね？やっぱり。。。 また仮にですが、例えばAというクライアントがWEBサイトにアクセス中に Bというクライアントが待ったく　同じ動作を同じタイミングでアクセスした場合ってどうなるのでしょうか？ 実際、WEBアプリでそこまでの例外というか処理って行うものでしょうか？ また、ちなみにMySQLの場合、 "START TRANSACTION"　というSQL文だけでなく AUTOCOMMIT =　0　として、自動コミットをオフにしつつ　beginという式で トランザクションを開始する方法があるようですが、実際はどちらの方が当たり前のほうほうなのでしょうか？ 識者の方ご教授ください。
数値をTIME型に変換して抽出したい 少数を含む数値を次のようにTIME型に変換して抽出したいのですが、 CREATE TABLE timetbl ( id INT PRIMARY KEY AUTO_INCREMENT, time double ) ENGINE=InnoDB; [timetbl] id　　time 1　　　3601.999 【得たい結果】 [timetblのid]　[timetblのtimeをTIME形式に] 　　1　　　　　　　　　01:00:01.999 どのようなSQL文を記述すれば良いのでしょうか？
お世話になります。 parent_idという親テーブルのIDを格納するフィールドと idという自分のIDを格納するフィールドと データを格納するdataというフィールドがあるtbl01というテーブルがある場合に update tbl01 set data = 'xxx' where parent_id = 1 and id = 1 update tbl01 set data = 'yyy' where parent_id = 1 and id = 2 update tbl01 set data = 'xyz' where parent_id = 1 and id = 3 ※dataに格納するデータは親テーブルとは関係ない独立したデータです。 という感じにparent_id = 1が格納されているレコードにデータを次々と更新していきたいのですが 1回のupdate文でまとめて発行するやり方はあるのでしょうか。 1回1回発行するのは時間がかかるためできれば1回でまとめて発行したいのです。 update tbl01 set data in ('xxx', 'yyy', 'xyz') where parent_id = 1 and id in(1, 2, 3) イメージとしてはこんな感じです。 よろしくお願いいたします。
次のようなテーブル構成で、 CREATE TABLE tbl1 ( id int PRIMARY KEY AUTO_INCREMENT ) ENGINE=InnoDB; CREATE TABLE tbl2 ( id int PRIMARY KEY AUTO_INCREMENT, name VARCHAR(32) ) ENGINE=InnoDB; CREATE TABLE tbl1_tbl2 ( id int PRIMARY KEY AUTO_INCREMENT, tbl1_id int, tbl2_id int, FOREIGN KEY(tbl1_id) REFERENCES tbl1(id), FOREIGN KEY(tbl2_id) REFERENCES tbl2(id) ) ENGINE=InnoDB; CREATE TABLE tbl3 ( id INT PRIMARY KEY AUTO_INCREMENT, tbl1_id int, created datetime, FOREIGN KEY(tbl1_id) REFERENCES tbl1(id) ) ENGINE=InnoDB; [tbl1] id 1 2 3 [tbl2] id　　name 1　　　a 2　　　b [tbl1_tbl2] id　　tbl1_id　　tbl2_id 1　　　1　　　　　　1 2　　　1　　　　　　2 3　　　1　　　　　　2 4　　　2　　　　　　1 5　　　3　　　　　　1 6　　　3　　　　　　2 [tbl3] id　　tbl1_id　　created 1　　　1　　　　2011-10-17 01:51:39 2　　　1　　　　2011-10-17 02:51:39 3　　　3　　　　2000-10-17 01:51:39 ここから次のような「tbl1のid」「tbl2の個数」「tbl3の最新のcreated」を基準とした （下の例は「tbl1のid」を昇順にした結果です） それぞれの並べ替た結果を得たいのですが、どのようなSQL文を記述すれば良いのでしょうか？ [tbl1のid]　[tbl2のnameのリスト]　[tbl3の最新のcreated] 　　1　　　　　　　　　a,b,b　　　　　　2011-10-17 02:51:39 　　2　　　　　　　　　a　　　　　　　　 　　3　　　　　　　　　a,b　　　　　　　2000-10-17 01:51:39
こんにちは。Accessをいままで利用していましたが、ファイルサイズが重くなってきたために、MYSQLを勉強しようと思っています。 Accessの時はテーブル名やフィールド名に普通に日本語を使っていました。MYSQLなどでも日本語のテーブル名やフィールド名を作ることができました。しかし、日本語でAccess感覚でつけるのはまずいのかな？と思いだしましたが(なんとなく)、日本語で続けると将来的にまずいことなどはおこらないでしょうか？ MYSQLはWin XP SP3にインストールしています。レベルとしてはVBAを少しかけるくらいで本格的なDBMSは使ったことがありません。 以上、よろしくお願いします。
データベース、テーブルを新規に作成する時、 現在 phpmyadminを使用しているのですが phpmyadminでDBやテーブルを作成するというのは一般的なのでしょうか？
下記のサイトに従って、一番下の「ログインできました。」まで設定しました。 http://www.sa-sa-ki.jp/blog/2010/01/windows-web- … さてこれを社員に公開したいのですが。。。 このアドレス「http://localhost/blog/wp-admin」は、ローカルのアドレスですので、他のPCからアクセスできません。 あくまでもこのサーバー自身のIEでしか開けません。 これを他のPCからアクセスするにはどうしたらいいでしょうか？ できたらIISでURLをひもづけたいです。 http://IPアドレス.indexでもいいです。 外からは閲覧する必要がありません。 教えて下さい。
phpとphpmyadminを連携しており、フィールドはid(AUTO_INCREMENT)を含め、１１項目作成しています。 phpでは9つのフォームがあり、入力された値が2～10つ目のフィールド(すべてint(10))に格納され、11こ目のフィールドはdateで取得した値が入ります。 php上で、生成されたsql文をechoで表示させると、入力したとおりになっているのですが、phpmuadminの中身を見てみると、10桁フルで入力した値が、決まって「2147483647」となっており、困っています。 変数もechoで細かく見てみましたが、どこもおかしなところはありません。 ＤＢに格納された数字のみがおかしなことになっています。 さらに、いろいろ試してみたところ、 1234564757はそのまま 2222222222は2147483647 2222222229は2147483647 4545454545は2147483647 1111111112はそのまま 1111111111はそのまま 2222はそのまま(9桁までの数字の連続なら正常) のような感じで、1の場合は10桁でも変な数字にならず、ほかの数字が連続するときまって2147483647になるようです。 11桁からはプログラムによりエラーが出て再入力を求めるようにしており、11桁以上の場合は正常にエラーが出るので、おかしくなるのは、10桁のときのみです。 格納寸前の変数も直後の変数や$sqlもおかしなところは全くないので、何が狂わせているのかがわからずにいます。 php：5.3.8 mysql：5.5.16 phpmyadmin：3.4.5 Apache：2.2.21 (Win32) つたない説明で分かりづらいかもしれませんが、大変困っておりますので、 何かアドバイス等があれば是非ご教授いただければ幸いです。
phpMyAdminでCSVデータのインポートを行ったのですが、文字化けしてしまいます。 　(正) 17:00～5:00⇒(化け) 17:00ï½ž5:00 CSV、MySQLともに文字コードはutf8です。 phpMyAdminの画面から直接日本語レコードを追加すると文字化けせずに表示されます。 --手順-- エクセルで手動で作成したデータをCSV形式で保存した後、テキストエディタでutf8で保存。 phpMyAdminの「インポート」より「LoadDATA文を使用したCSVの読み込み」を選択し、 区切り文字はカンマを選択⇒「エンコーディングの変換」は「なし」を選択⇒実行。 --環境-- WindowsXP XAMPP1.7 MySQL5.5.16 phpMyAdmin3.4.5 どなたか詳しい方いらっしゃいましたら知恵をお貸しください。 よろしくお願いします！
Warning: mysql_num_rows(): supplied argument is not a valid MySQL result resource in と、phpでエラーが出ます。調べた結果クエリに問題があるということです。 クエリは $query = "select name,jyusyo,kakaku,gazou,link from kensaku order by kakaku asc"; です。なにがおかしいのでしょうか？？カカクカラムを昇順に呼び出したいのですが。。。
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '"8cb2237d0679ca88db6464eac60da96345513964", created"2011-10-05 15:16:04"' at line 1 PHPをブラウザで開いて動作確認すると上記のようにエラーがでてしまいます。 dbはこんな感じで作りました。 CREATE TABLE `class_orms`.`members` ( `id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY , `name` VARCHAR( 255 ) NOT NULL , `email` VARCHAR( 255 ) NOT NULL , `password` VARCHAR( 100 ) NOT NULL , `created` DATETIME NOT NULL , `modified` TIMESTAMP NOT NULL ) ENGINE = MYISAM ; CREATE TABLE `class_orms`.`posts` ( `id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY , `message` TEXT NOT NULL , `member_id` INT NOT NULL , `reply_post_id` INT NOT NULL , `created` DATETIME NOT NULL , `modified` TIMESTAMP NOT NULL ) ENGINE = MYISAM ; SQL側の1行目でエラーがあるということなのでしょうか？ どなたか回答よろしくお願いします。 動作環境------------------- Apache/2.2.14 (Win32) DAV/2 mod_ssl/2.2.14 OpenSSL/0.9.8l mod_autoindex_color PHP/5.3.1 phpMyAdmin バージョン情報: 3.2.4
お世話になります。 PHP 5.2.13 MySql 5.5 $date = convert('20111001', DATE);　　…（１） を実行すると下記のエラーが出ます。 Fatal error: Call to undefined function convert() MySQL Command Line Clientで select convert('20111001', DATE) は問題なく出来るでの、PHPがこの関数を認識していないのかと思いphpinfo()の後に(1)のコードを加えてみた所同じエラーが出ました。 php.iniファイルの設定は extension_dir = "c:\php\ext" extension=php_mysql.dll　(セミコロン削除済み） c:\php\ext\php_mysql.dll も存在します。 Windowsの環境変数には C:\PHP が設定済みです。 問題点・解決法をご存知の方がいらっしゃいましたら、どうかご教授の程よろしくお願い致します。
MySQL ver.5.1を使用。 メールアドレス帳（数千件）より、宛名に特定のキーワードが含まれる行のみ選択したいと考えてます。 対象となるキーワードが多数ありすぎるため、別テーブルに格納してあります。 副問い合わせ（IN）を使用して、 下記テーブル：mail_listのname列のうち、 テーブル：keywordの値を含む行のみ抽出したいと思います。 完全一致『受付』⇔『受付』といったようなものであれば、 SELECT * FROM mail_list WHERE name IN (SELECT name FROM keyword); で結果が得られるのですが、 『技術部』⇔『部』、『営業部』⇔『部』 のように部分一致させるという条件の場合、方法がなかなか思いつきません。 どのようなSQLで実現できますか。 ご教示くださいませ。 ■テーブル：mail_list id | name | address | ―――――――――――――― 1 | 技術部 | aaa@aaaa | 2 | 営業部 | bbb@bbbb | 3 | 駐車場 | ccc@cccc | 4 | 受付 | ddd@dddd | 5 | 社長室 | eee@eeee | ■テーブル：keyword name | ―――― 受付 | 部 | ×× | ○○ | △△ |
Fatal error: Call to undefined function shal() in C:\xampplite\htdocs\HP2\join\check.php on line 14 とエラーがでてきます。 原因がわからなくて困っています。 どなたか回答よろしくお願いします。 if (!empty($_POST)) { //登録処理をする $sql = sprintf('INSERT INTO members SET name="%s", email="%s", password"%s", created"%s"', mysql_real_escape_string($_SESSION['join']['name']), mysql_real_escape_string($_SESSION['join']['email']), shal(mysql_real_escape_string($_SESSION['join']['password'])), date('Y-m-d H:i:s')); mysql_query($sql) or die(mysql_error()); unset($_SESSION['join']); header('Location: thanks.php'); } ?>
例えば、次のようなテーブルがあって、mojiretuカラムにおいて 他の行の文字列と2文字以上の重なっている部分の文字列を取得したいのです。 ただし条件があって下の場合だと、「ab」は1、2行目で重なっているのですが、 2行目の「ab」はそれで全ての（終結している）文字列なのでマッチさせないようにしたいです。 なので、このテーブルから取得したい文字列は 「cd」「bcd」「abc」「bc」「de」になります。できれば重なっている回数も含めて取得したい （「cd」２回、「bcd」１回、「abc」１回、「bc」１回、「de」１回、） のですが、どのようなSQLを記述すれば良いのでしょうか？ [テーブル] mojiretuカラム abcd ab cde abcde xy
mySQLの日本語表示について質問があります。 OSがvistaであるPCにxampp1.7.7をインストールし、必要なセットアップをすませました。 そこで、コマンドラインより適当なデータベース(workdb)に create table tab1(number int(8) unique not null, city varchar(10), country varchar(10)); として、テーブル(tab1)を作成し、 insert into tab1 values(1, '東京', '日本'); とtab1にデータを挿入し、 select * from tab1; で、tab1の内容を表示したところ +-------+----+-------+ | number | city | country | +-------+----+-------+ |　　　　　1|　　　|　　　　　　| +-------+----+-------+ と、日本語で挿入した物だけ表示されませんでした。 status より、charactersetを確認したところ Server,Db,Client,Conn 全て utf8 となっていました。 また、 show variables like "char%"; より、Variable_nameも確認したところ character_set_client,character_set_connection,character_set_database,character_set_result,character_set_server,character_set_system は全てutf8になっており、character_set_filesystemのみbinary となっていました。 この『日本語のみ表示されない』原因はどういったものが考えられるのでしょうか？ character_set_filesystem　が原因なのでしょうか？ 原因をネットで探してみましたが、『日本語が文字化けする』といったものばかりがヒットし、また上記のVariable_nameがutf8になっていないといった内容が多く、自分に生かす事ができませんでした。 わかる方がいらっしゃればお手数おかけして大変申し訳ないのですが、是非ご教授お願いしたいと思っています。 よろしくお願いいたします。 質問に必要な情報が足りていない場合、教えていただければと思います。
Linux + mysql4.1.22を使っています。 先ほど気が付いたのですが、テーブルsampleにフィールドid(int)がある時、 SELECT * FROM sample WHERE id='1a' とすると、id=1のデータが取得できてしまいました。 どうしてなんでしょう。ご存知の方、ご教示下さい。
お世話になります。 winXP,MySQL5.0で開発を行っています。 テーブル名　usr_tbl フィールド名　company とした場合、companyの内容として、 「株式会社サンプル商事」 「(株)さんぷる」 など、株式会社、有限会社等がマチマチの方法で入力されています。 今回、companyでソートをかけて抽出したいのですが、 このとき、株式会社などの記号を省いた状態でソートしたいのです。 上の例だと 「サンプル商事」 「さんぷる」 としてソートしたいです。 このようなことが出来るのでしょうか？ 全件抽出後に、独自でソートしたほうが速いのでしょうか？ よろしくお願いいたします。
すみませんが、Linuxでmysql.sockの位置を変えたいのですがどのようにすればいいのでしょうか? ソースからのデフォルトは/tmp/mysql.sockですが、 MySQL5.1.58の場合、./configureのオプションにて--with-unix-socket-path=/var/lib/mysql/mysql.sockを指定してインストールし、my.cnfに [mysqld] socket=/var/lib/mysql/mysql.sock [client] socket=/var/lib/mysql/mysql.sock を記述しても Starting MySQL.......Manager of pid-file quit without updat[失敗]le. とか /usr/local/mysql5.1/bin/mysqladmin: connect to server at 'localhost' failed error: 'Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2)' Check that mysqld is running and that the socket: '/var/lib/mysql/mysql.sock' exists! と出てダメです。 勿論、/var/lib/mysql/mysql.sockというファイルは存在しません。 Snort、innotopなど色々なツールを使用する際に、/tmp/mysql.sockではどうしても上手くいかず、socketの位置を変えようと思ったのですが。 マニュアル読んだり、Webで検索しても分かりませんでした。 そもそも皆さんは他のソフトとの連携で問題がなく、自分だけの問題なのかなとも思ったりもしました。
以下のようなSQLを発行すると、mysqlの処理時間が非常に多くかかるため、なんとか最適化を行いたいと考えています。 どのような方法があるのか教えていただけませんしょうか。 SELECT user_id,comment,comment_id,date,study_time,study,source FROM data_temp t1 WHERE NOT EXISTS (select comment_id from data t2 where t1.comment_id = t2.comment_id) ■補足 ・dataとdata_tempのテーブル構造は全く同じです。 ・SQLで実現したいことは、両テーブルのcomment_idをキーとして、dataに含まれないdata_tempの差分データを表示させたい。 なお、以下のインデックス作成は行いましたが、結果変わらずでした。 alter table data t1 ADD INDEX_t1 (user_id,comment,comment_id,date,study_time,study,source); alter table data_temp t1 ADD INDEX_t1 (user_id,comment,comment_id,date,study_time,study,source); よろしくお願いします。
アクセスの台数制限について お客様様からからの問い合わせを アクセスに入力してデータベース化したいのですが 入力するPCが40台あります。 そのため、バックエンドとフロントエンドに分けて動作させようと思いますが バックエンド１に対して フロントエンド40は可能ですか また可能であってもレスポンに問題がでますでしょうか 教えてください
1つのデータの前後のデータを取得する場合、何か簡単に取得するselect文はありますでしょうか？ 例） no　name　adress 1　　山田　　東京 3　　山本　　名古屋 6　　田中　　大阪 7　　高橋　　福岡 上記のようなテーブルがあった場合で、noが6の前後のデータを取得する場合、以下のように考えてみましたが他に簡単にデータを取得する方法はないでしょうか？ なお、noが６の前後の数字(３や７)は変更される場合がある為、select文の際にno=3やno=7と固定する事は出来ません。 ・noが6の前のデータ(noが3)のデータを取得する場合 select adress table where no<6 oder by no limit 1 ・noが6の次のデータ(noが7)のデータを取得する場合 select adress table where no>6 oder by no limit 1 分かりにくい説明で申し訳ありませんが、どなたかよろしくお願いいたします。
CREATE TABLE `db31_dev`.`db31_dev` ( `keyword_id` SERIAL NOT NULL , `bc_guid` VARCHAR( 255 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL , `bc_wbs` VARCHAR( 255 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL , `keyword_h1_url` VARCHAR( 255 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL , `keyword_wording_in_bc` VARCHAR( 255 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL , `keywords` VARCHAR( 511 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL , `description` VARCHAR( 255 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL , `last_modified` DATETIME NOT NULL , `changefreq` VARCHAR( 15 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL , `pri` INT( 5 ) NOT NULL , `noLocalNavi` BOOLEAN NOT NULL , PRIMARY KEY ( `keyword_id` ) , UNIQUE ( `bc_guid` , `bc_wbs` , `keyword_h1_url` , `keywords` , `description` ) ) ENGINE = InnoDB CHARACTER SET utf8 COLLATE utf8_general_ci; とphpmyadminでうったら（正確にはテキストボックスに入力） priの部分がエラーと言われて、 MySQLのメッセージ: ドキュメント #1071 - Specified key was too long; max key length is 767 bytes だそうです。 どうすればいいのでしょうか？ よろしくお願い申し上げます。
下のようなテーブル構成の場合に、[tbl1_tbl2テーブル]の検索で 「tbl2_idカラムが1と2両方を保持する行のtbl1_id」を取得（この場合だと1と3を取得）したい のですが、どのようにSQLを記述すれば良いのでしょうか？ [tbl1テーブル] id 1 2 3 [tbl2テーブル] id 1 2 3 [tbl1_tbl2テーブル] tbl1_id　tbl2_id 1　　　　　1 1　　　　　2 3　　　　　1 3　　　　　2 2　　　　　1
親のidを保持するテーブルです。 CREATE TABLE `tbl` ( `id` int PRIMARY KEY, `parent_id` int, FOREIGN KEY(`parent_id`) REFERENCES `tbl`(`id`) ) ENGINE=InnoDB; このテーブルで「parent_idがNULLで、かつ、子を持たない（親というか子でもないというか）行」 を検索したいのですが、どのようなSQLを記述すれば良いのでしょうか？
さくらインターネットのＭＹＳＱＬのＤＢに大容量（約１３ＭＢ）のＣＳＶファイルをアップロードする方法を教えて下さい。 下記(1)～(3)のようにいくつかの方法を試しましたが、結果的に全件をアップロードができていません。 (1)最初にレンタルサーバーのさくらインターネットでサーバーを借りましたが、phpMyAdminにＣＳＶファイルをアップロードしようしました。 kuin_mstという名前のテーブルを作成後、このテーブルを選択してインポート画面からインポートするＣＳＶファイルを選択し、設定として「ファイルの文字セット」をutf8に、 「インポートするファイルの形式」のＣＳＶ形式のフィールド区切り記号をカンマに、フィールド囲み記号を空白に指定しました。 そして、実行を押すと、しばらくして「Internet Explorerではこのページは表示できません。」が表示されました。 これに対してＦ５キーを押して再実行すると元の画面に戻り、kuin_mstテーブルの件数を見ると、122915件中58114件がアップロードされてました。 他のインポートするファイルの形式の「LOAD DATA する CSV」や「ＳＱＬ」も試しましたが、結果として何もアップロードされませんでした。 考察：１３ＭＢのデータを３回分に分割してこの作業を行えば目的が達成できるように思いますが、結果として入れるべき全件のデータがアップロードされたのかを検証する方法が分かりません。 (2)さくらはSSHが使えるのでpoderosaをダウンロードしてサーバーにアクセスしましたが、ＳＱＬのみ記述されたtest1.txtをアップロードするコマンドを次のように投入したら テーブルの削除や作成は成功しエラーが発生しませんでした。 コマンド 「mysql -h mysql○○○.db.sakura.ne.jp -u アカウント名 -p ＤＢ名 < test1.txt」 しかし、このtest1.txt内に「LOAD DATA INFILE './KEN_ALL.CSV' INTO TABLE kuin_mst FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '\n';」 の一行を加えて実行すると「ERROR 1045 (28000) at line 2513: Access denied for user 'ユーザー名'@'%' (using password: YES)」というエラーが発生します。 このエラーを調べると「コンソールからデータベース接続する時にパスワードが間違っている」と説明しているサイトがありましたが、何度確認しても間違えていませんし、間違えていたら「LOAD DATA ～」の行を 追加していない状態の処理で同じエラーが出るはずです。 ちなみに、自宅ＰＣのＷＥＢサーバーで、「LOAD DATA ～」を追加したtest1.txtをコマンドプロンプトで実行するとアップロードが正常に行われるのでＣＳＶファイル自体は問題がないはずです。 ※KEN_ALL.CSVファイルは、郵便番号-住所データ（utf-8保存で約13MB）でレコードはカンマ区切り（例として1レコード抜粋→640941,ホッカイドウ,サッポロシチュウオウク,アサヒガオカ,北海道,札幌市中央区,旭ケ丘） となっています。 ※test1.txtとKEN_ALL.CSVの両ファイルは/home/アカウント名の階層に置いてこの処理を実行しました。 結果として何が原因でアップロードができないのかがよくわかりませんでした。 (3)ＢＩＧＤＵＭＰという大容量ファイルを分割してＤＢにアップロードできるツールを見つけたので、いろいろと説明があるサイトを参考にブラウザにて実行したらKEN_ALL.CSVファイルがFilenameの欄に表示されました。 同画面でstart import1をクリックしましたが、「You have to specify $csv_insert_table when using a CSV file. 」というメッセージが出てきました。 結果として、この意味がよくわかりませんでしたが、カンマ区切りのみのＣＳＶファイルだけをアップロードすることはできないのかもと思いました。 以上、悪戦苦闘しても解決できないのでどうかアドバイスを下さい。 宜しくお願いします。 ■環境 UNIX系 OS FreeBSD Apache 1.3.x PHP 5.2.17 phpMyAdmin 3.3.10.3 MySQL 5.1 MySQL 文字コード UTF-8 bigdump ver.0.34b
現在ホームページにスポーツチームの日程表を作っていて、 これをHTMLソースに直打ちしています。 しかし、過去10年分ほどの日程表があり、 サイトのデザインを変更する際に、10年分をソースに直打ちするのは億劫なので、 データベースから取得して表示させたいと考えています。 ですが、その方法がわかりません。 まずどう準備して、どういう方法でやる必要があるのか、教えてください。 XAMPPを入れており、PHPMｙAdminを少し触ったことはあります。
PhqのフォームからMYSQL のデータベースの入力した文字データは多言語できますか 例えば同じデータベースの同じテーブルに名前の文字を日本語、韓国語、中国語、で入力したり する事はできますか、人の名前はその人の属する国の言語で入力。 同じページに違う国の言語で人の名前を表示することは可能ですか もしできるならやり方を教えてください
こんばんは。 既存のテーブルのカラムを削除することになりまして、 以下の手順で変更をかけました。 環境：mysql_5.5 mysql>begin; mysql>alter table test_table drop column test_column; mysql>desc test_table; mysql>rollback; mysql>desc test_table; しかし、ロールバックをかけても元に戻らなかったのですが、 http://dev.mysql.com/doc/refman/5.1/ja/cannot-ro … の記述にあるようにバージョン5.5でもalterでのロールバックは出来ないのでしょうか。 英語のサイトを見たのですが、ただしく訳せませんでした。 http://dev.mysql.com/doc/refman/5.5/en/implicit- … 回避方法があったら、教えてください。
MYSQLの勉強をはじめたいのですが 1番重要な所を教えてください
mysqlでviewを作ろうと考えています。 書籍を調べて3日くらい格闘していましたが挫折してしまい アドバイスをいただきたく、質問いたします。 テーブル名: kamoku kamoku_id name ------------------ 001 国語 002 算数 003 理科 004 社会 テーブル名: siken siken_id siken_name kamoku_id1 kamoku_id2 kamoku_id3 ------------------------------------------------------- 000011 試験1回目 001 002 003 000012 試験2回目　 001 003 004 000013 試験3回目 001 002 004 000014 卒業試験 003 004 null この2つのテーブルからVIEWを作りたいと考えています VIEW名　siken_kamoku siken_id siken_name kamoku_id1 kamoku_id2 kamoku_id3 ------------------------------------------------------- 000011 試験1回目 国語 算数 理科 000012 試験2回目　 国語 理科 社会 000013 試験3回目 国語 算数 社会 000014 卒業試験 理科 社会 科目名を一回で取得できるようなViewを作りたいのですが CREATE VIEW view_siken_kamoku ( siken_id, siken_name, kamoku_name1, kamoku_name2, kamoku_name3 ) AS SELECT siken.siken_id, siken.siken_name, kamoku.kamoku_name, kamoku.kamoku_name, kamoku.kamoku_name WHERE siken_kamoku_id1 = kamoku.kamoku_id AND siken_kamoku_id2 = kamoku.kamoku_id AND siken_kamoku_id3 = kamoku.kamoku_id; 以上の文ですとエラーがでます。 どのような文にすれば、上記のようなVIEWがえられますでしょうか おたすけてください
PhqのフォームからMYSQL のデータベースの入力した文字データは多言語できますか？ 例えば同じデータベースの同じテーブルに名前の文字を日本語、韓国語、中国語、で入力したり する事はできますか、人の名前はその人の属する国の言語で入力。 同じページに違う国の言語で人の名前を表示することは可能ですか もしできるならやり方を教えてください
COUNT関数が上手く設定できなくて困っています。 DBに案件テーブルと担当者テーブルを設定し、案件に紐付く担当者を検索できるようにしようと思っています。 案件に対して複数の担当者が担当になることがあり、案件テーブルに担当者テーブルをLeft Joinして、最後にGroup byでグルーピングすることによって案件自体は検索できるのですが、ページネーションのためCOUNT関数を使って案件数を求めようとすると、正しい数値が得られません。 select count(a.id) counts // ここをa.* とすることで案件情報を検索することはできます。 from ANKEN a left join TANTOU t on a.id = t.id where flag = 0 group by a.id 正しい件数を取得するにはどのようにすれば良いでしょうか？
MYSQLについて教えてください 今、XAMPPとMYSQLで簡単なデータベースを作ってます。実際レンタルサーバー等にアップして外部からも使えるようにした場合 MYSQLに入っているデータをどうやってアップするのですか いまいち仕組みが分かりません
初心者ですみません。 これからPHP＋MySQLで掲示板を作ろうと思うのですが、データベースは初めてです。 PHPやサイト作成は経験があります。 いろいろなサイトを検索してみたのですが、なかなか詳しくPHP＋MySQLで掲示板を作る解説があるサイトがありません。 そこで書籍を買ってみようと思ったのですが、軽く掲示板を作るような書籍はあっても本格的に掲示板を作ることが目的の書籍がありませんでした。 唯一、廃盤になったと思われる「Web掲示板作成で学ぼう!PHP4実践ガイド―PostgreSQL対応 」というのがあったのですが、MySQLではなくPostgreSQL対応版でした。 中身は見ていないのですが、経験者の皆様が予想するとした場合、この書籍を見ながらPostgreSQLのソースをMySQLで代用できると思いますか？ ちなみにMySQLにしたい理由は単に借りているサーバーがMySQLにしか対応しておらず、自分のPCにはXAMPPが入っているからです。どちらが優れているとかはわかりません。 あと、何かの書籍で見たので記憶が曖昧ですが、MySQLとPostgreSQLのどちらでも使えるクラス群？関数群？みたいなライブラリがあるようなのですが、このライブラリを使えば上記書籍のPostgreSQLでもMySQLで対応できると考えて良いのでしょうか？ ライブラリ名とか覚えてなくてすみませんが・・・。 お手数ですがよろしくお願い致します。
先日、MySQLの入門書を図書館で見つけて借りてきてみました。 勉強するにあたって、まず、MySQLがなんなのかを調べてみると データベース管理システムとあり、入力された情報などを管理するシステムだとありました。 しかし、どうしてそうしたものが必要になったのかが分かりません。 情報を管理するのであれば、普通にテキストファイルに書き出して、 その場所を明記しておけばいいと思えますし、 情報を取り出したり探したりするのであれば、該当ファイルにgrepなどをかければすむように思えます。 MySQLなどのデータベース管理システムがどうして開発され、使われ続けるのか、 どういった利点があるのか、わかりやすく教えてください。
mysqlサーバーにLAN内のリモートホストから接続するとき、 mysqlサーバーの/etc/mysql/my.conf 内の bind-address = xxx.xxx.xxx.xxx を削除すれば接続できますが、 LAN（192.168.1.0/24）内のリモートホストとサーバー自身からの接続に限定しようとして /etc/mysql/my.confに bind-address = 127.0.0.1 bind-address = 192.168.1.0/24 を記述すると、mysqlが起動しません。 ( Ubuntu/LInuxで、# service mysql restart や # /etc/init.d/mysql を実行したらプロンプトに戻らない） bind-address = 127.0.0.1 bind-address = 192.168.1.1 と記述しても起動しません。 bind-address = 127.0.0.1 192.168.1.0/24 と記述すると、起動はしますがlocalhostからしか接続できません。 localhostと特定のリモートホストに接続を限定する方法はないでしょうか？ 2011年9月6日
システム初心者のものです。助けが必要です、宜しくお願い致します。 外部データ（例えば、購買情報）をリアルタイムに大量に取り込まなければ ならない場合に、エクセルやアクセス以外に高速にデータを取り込む方法は ありますか？ （MYSQLやポスグレやSQLSERVERで可能なのでしょうか？） リアルタイムに大量にデータがくるらしいので、 どうしたらいいのか困っております。 どんな商品及びサービスがいいのか、またどんなソフト？ハード？を そろえなくてはいけないのでしょうか？ 大変困っていますので、アドバイスを宜しくお願い致します。 大量のデータと、どのくらいかわからないが、とくにく大量にデータがくるらしいです。 １秒に数1万件は数字データがくると思います。
DBに格納されたデータが10万行などのボリュームになった場合、そのデータ移動はできるとするとどのような方法がありますでしょうか？
<?PHP $con = mysql_connect('******.jp', '*********', '******'); if (!$con) { exit('データベースに接続できませんでした。'); } $result = mysql_select_db('******', $con); if (!$result) { exit('データベースを選択できませんでした。'); } $result = mysql_query('SET NAMES utf8', $con); if (!$result) { exit('文字コードを指定できませんでした。'); } $arr1 = array(); foreach($_POST['tiiki'] as $tiiki){ $arr1[] = " tiiki = '$tiiki' "; } $arr2 = array(); foreach($_POST['syoku'] as $syoku){ $arr2[] = " syoku = '$syoku' "; } $arr3 = array(); foreach($_POST['koyou'] as $koyou){ $arr3[] = " koyou = '$koyou' "; } $a = implode(" OR ",$arr1); $b = implode(" OR ",$arr2); $c = implode(" OR ",$arr3); $sql = "select * from kensaku where ($a) AND ($b)AND ($c) order by date desc"; print $sql; ?> <?php $con = mysql_connect('*****.jp', '******', '******'); if (!$con) { exit('データベースに接続できませんでした。'); } $result = mysql_select_db('*******', $con); if (!$result) { exit('データベースを選択できませんでした。'); } $result = mysql_query('SET NAMES utf8', $con); if (!$result) { exit('文字コードを指定できませんでした。'); } $result = mysql_query('SELECT * FROM kensaku', $con); while ($data = mysql_fetch_array($result)) { echo '<p>' . $data['tiiki'] . ':' . $data['syoku'] . ':' . $data['koyou'] . ':' . $data['kai'] . "</p>\n"; } $con = mysql_close($con); if (!$con) { exit('データベースとの接続を閉じられませんでした。'); } ?> これで表示されるのが、 select * from kensaku where ( tiiki = '豊岡市' ) AND ( syoku = '飲食' )AND ( koyou = 'バイト' ) order by date desc 豊岡市:飲食:バイト:オシイそば 豊岡市:製造:正社員:オシイ運輸 養父市:飲食:バイト:オシイ物産 です。一番目のphpデータはPOST文を受け取っただけでデータベース内から検索してくれないし、二番目のphpデータはデータべスにある情報を全て受け取っただけです。 僕はチェックされた情報をPOSTで受け取り、チェックされた内容に該当するデータだけデータベースから受け取り表示させたいんですが、どうすればいいですか？非常に困っています！！！！！！！！！！！！！！！！！！！！！！！！！
◆PHPバージョン 5.3.3 ◆mysqlバージョン 4.1.22 ◆テーブル情報 `no` int(11) NOT NULL auto_increment, `name` text NOT NULL, `mail` text NOT NULL, `memo` text NOT NULL, `updating` timestamp NOT NULL default CURRENT_TIMESTAMP, PRIMARY KEY (`no`) ENGINE=MyISAM DEFAULT CHARSET=utf8 ◆SQL (1)insert into test(name, mail, memo) values ('abc','abc@test.com','abc') (2)insert test set name='abc', mail='abc@test.com', memo='abc' ◆処理概要 $conn = mysql_connect(ホスト、ユーザ、パスワード); mysql_query("set names utf8"); $rs = mysql_select_db(DB名, $conn); $result = mysql_query(SQL, $conn); ◆登録情報 (1, 'abc', 'abc@test.com', 'abc', '2011-09-02 16:28:57'), (2, '', '', '', '2011-09-02 16:28:57'), 【問題】 上記SQL(1)、(2)どちらでDBに登録しても、登録情報のように同時に空データも同時に登録されてしまう 全く原因の検討がつかないので、何か手がかりがありましたらご教授頂けたらと思います。 どうぞよろしくお願いします。
DBの初心者のものです。 MYSQLについて調べましたが、 いまいち特徴がわかりません。 とくに知りたいことが、 MYSQLは、１秒間あたりにどのくらいの 件数まで処理できるのかということです。 どなたかMYSQLについて 詳しい知識をお持ちの方、 ご連絡頂ければ幸いです。 宜しくお願い致します。
15枚の写真をアップ可能のアップローダーを作成しました。 中に２枚だけよく不具合がおきる。 ファイル名が存在するが、中身が消えてしまったり、アップロードできなかったり 毎回ではないですが、たまにおきる。 原因を教えていただけますでしょうか？
SQLの中にif文を使いたいですが、 うまくいきません。 やはりwhereの中で使えないですか？ アドバイスお願いします。 実際のSQL文： $sql = "select * from room"; 　　　　$sql = $sql . " WHERE ((Keisai = 1)"; if(Chinryou1>0){ $sql = $sql . " and (Chinryou1 <= {$rent1})"; 　　　　}else if(Chinryou1==0){ $sql = $sql . " and (Chinryou2 <= {$rent1})"; 　　　} $sql = $sql . ")"; $sql = $sql . " order by Narabijun desc, Name"; $sql = $sql . ";"; $result= mysql_query($sql, $conn); $num= mysql_num_rows($result);
バッチでコマンドの実行結果をテキスト出力しているのですが、 出力したテキストに次のように、・ソ　が入っている行があります。　 ・ソ<?xml version="1.0"?> バッチファイルや出力用テキストファイルを SJISで保存しても、BOMなしのUTF-8で保存しても結果は同じです。 どうしたらよいか教えていただけますか？
はじめまして。 MySQLでエラーが出てしまい改善するのに困っています。 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near... とでます。 「よくわかるPHPの教科書(P202)」という本を見ながらすすめているのですが、 このエラーが言っているのは、 「サーバーのバージョンが本と異なるから、あなたのサーバーにあわせたコマンド入力をしなさい」 ってことなのでしょうか？ よろしくお願い致します。
MySQLで複数の端末で開発をする際、どうすれば同期を取りながら開発できるでしょうか？ソースであれば、バージョン管理システムを使うと思うのですが。
どうにもSQLになじめず困っている初心者です。宜しくお願い致します。 tableAとtableBがあり，それぞれ6つの列があります。両方とも，英語の人名を入力したものです。 tableAは添付した画像のようになっていて， A_ID, A_Key, A_firstname1, A_firstname2, A_lastname1, A_lastname2 と6つの列があります。要は英語の人名のデータなのですが，別名や綴り違いがあるためにfirst nameもlast nameも2列ずつあります。tableAは，これが数百行あります。 tableBも同様に， B_ID, B_Key, B_firstname1, B_firstname2, B_lastname1, B_lastname2 と6つ列があります。ただしこちらは数万行あります。 やろうとしていることは，名前の綴り違いなどを考慮して，tableBの中にtableAの人名が何回出てくるか数えて，その数字をA_IDと一緒に表示するViewを作る，というものです。 そこで，以下のようなクエリを書きました。DBMSはMySQL 5.2を使っています。 Create View NewView as select tableA.A_ID, count(*) as Num from tableA join tableB on (tableA.A_firstname1 in (tableB.B_firstname1, tableB.B_firstname2)) and (tableA.A_lastname1 in (tableB.B_lastname1, tableB.B_lastname2)) group by tableA.A_ID ところが，出力されたViewはどうも思っていたものとは違い，名前が一致していないものもカウントされてしまいます。どこが間違っているのでしょうか。 お詳しい方のお知恵を拝借できたらと思います。どうか宜しくお願い致します。
バッチで、select文が２つ書かれたsql文を実行し、テキストファイルに出力しているのですが、 各select文の実行結果の終わりと始まりが連続行になっていて 結果が見にくいので、空白行を入れたいのですが、どうしたらよいのでしょうか？
PHP5.1.6 MySQL5.5 PostgreSQLからMySQLへの移行作業を行っているのですが、以下のSQLをMySQL用に変換したいと思っています SELECT (case when (volume + floor(extract(epoch from (current_timestamp - check_time)) / 900)) < volume2 then (volume + floor(extract(epoch from (current_timestamp - check_time)) / 900)) else volume2 end) as volume FROM table MySQLにPostgreSQLのepoch fromに当たる関数はありませんでしょうか？
テーブルAとテーブルBで、idが一致したデータのみ、 テーブルAのフィールドにテーブルBの値を入れたいです。 tera termを使用して、 UPDATE tableA as a, tableB as b SET a.value = b.value WHERE a.id = b.id 上記のupdate文を流すと一行目の[as a]からsyntaxエラーが出ます。 ERROR 1064: You have an error in your SQL syntax near 'as a, tableB as b SET ～' at line 1 書き方が悪いのでしょうか？ どのように記述すればb.valueをa.valueにsetできますか？
バッチの実行結果の件数%count%を、5桁の右寄せ（結果が１桁のばあいは、スペース４桁を頭に入れてる）でテキストファイルresult.txt に出力したいのですが、下記のように書くと、 table1 : ("d\n",0) 件 　と出力されてしまいます。 table1 : 　　　0 件　　　と出力されるようにするにはどうしたらよいのでしょうか？ for /f %%i in ('mysql -u root -p ^< "c:\bat\test.sql"') do set count=("%5d\n",%%i) echo table1 : %count% 件 >> "c:\bat\result.txt"
複数のテーブルのデータ件数を取得して変数に入れ、result.txtに結果を出力したいのですが、下のように書くと、１つのテーブルのデータ件数しか出力されません。複数の結果を出力するにはどうしたらよいか教えてください。 for /f %%z in ('mysql -u root -p ^< "c:\bat\test.sql"') do set count=%%z echo result： %count% >> "c:\bat\result.txt" test.sqlの中身を、 select count(*) from table1; select count(*) from table2; select count(*) from table3; とすると何も出力されず、 select count(*) from table1; とすると、１つの結果だけ出力されます。
システム初心者のものです。 データベースについて今調べています。 オラクルとかMYSQLとか有料のもの無料のもの等です データベースを金融機関向けのサービスで利用したいと考えていますが、 リアルタイムに大量のデータを処理するには どんなデータベースが最適なのでしょうか？ NOSQLというものも２０１０年ごろから流行りだしていることもわかりましたが、 （できるだけ無料のものを利用したいと考えています） どのデータベースがお勧めで、なぜそれがお勧めなのか等を伺いたく 質問させて頂きました。 データベースに詳しい方に伺えればと考えています。 お手数をおかけいたしますが、宜しくお願い致します。
先日からMYSQL＋PHPの勉強をはじめました。 データベース構築の際、以前作成したCSVファイルをMYSQLのテーブルとして 利用したいと考えております。 そこで、MYSQLコマンドより、 LOAD DATA LOCAL INFILE 'ファイル名.csv' INTO TABLE テーブル名 FIELDS TERMINATED BY ',' LINES TERMINATED BY '\r\n'; Query OK, 0 rows affected (0.04 sec) Records: 102 Deleted: 0 Skipped: 102 Warnings: 0 とCSVファイル自体が悪いのかSQL文に問題がるのかインポートがうまくいきません。。 ちなみにCSVは　 0,2011/6/2 0:00,80.94,81.32,80.55,80.92 0,2011/5/25 0:00,81.94,82.17,81.8,81.95 0,2011/5/23 0:00,81.77,82.04,81.32,81.99 環境はphpdevで一括でインストールした phpadmin: バージョン2.3.2 MYSQL: MySQL4 apache: 1.3.27 初心者で基本的な質問かもしれないですがどうかご教授お願いします。
すみません、SQL初心者です。 joinで結合元の複数のカラムから結合先の同一のカラムの値を参照する方法がわかりません。 以下の場合、どうすればいいでしょうか。 テーブルseisekiとsimeiがあります。 seisekiにはテストIDとテスト毎の英語と国語のトップの生徒の生徒番号のカラムがあります。 simeiには生徒番号と生徒名カラムがあります。 ２つのテーブルをjoinしてテストIDから英語と国語のトップの生徒の氏名を求める場合のselect文はどう書けば良いでしょうか？
多分、設定の問題ではないかと思うのですが、 DB種別とテーブル種別が異なるデータベースがあるのですが、 想定されるメリットとデメリットを教えてください。 ・DB種別 … InnoDB ・DB内のすべてのテーブル種別…MyISAM ちなみに、照合順序は、 DBだけが、latin1_swedish_ciで、 中のデーブルはすべて utf8_unicode_ci になっています MySQL…5.5
コマンドで空白行を作りたいのですが、 次のどれを試しても、出力したファイルを見ると、空白行ができていません。 どうしたらできるのでしょうか？ echo. echo; echo:
MySQLでレプリケーションを行っております。 例えば マスター1台で スレーブ10台のサーバへレプリケーションをおこなっているとした場合 1.マスターへの負荷はスレーブ1台の時よりかなり増大するものでしょうか？ 　それとも気にする程でもない程度でしょうか？ 2.レプリケーション遅延はスレーブ1台の時より大きくなりますでしょうか？ もちろんいろんな状況によって変化するとは思いますが 一般的に考えて、もしくは私見でもよいのでお教え頂けますでしょうか。 MySQLバージョン：5.5.15 1日のページビュー：500万PV 同時アクセス数：200 select と insert,update の比率は同じくらいです。
MySQL5.5です PostgreSQLからMySQLへ移行作業をしています PostgreSQLの配列型(文字)をMySQLのBLOB型にして格納しています {"ABC", "EFG"}といった形式で格納しているのですが 以下のSQL文をMySQLで使用できる形にしたいのです SELECT * FROM table WHERE Test[1] LIKE '%%' TestがPostgreSQLでの配列になります エラーメッセージは以下の通りです db_query error. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '[1] like '%%' 以下のようにAS句で適当な名称を与えて引き出せないかと考えたのですが、「Unknown column 'tst'」となり取得することはできませんでした SELECT *, REPLACE(SUBSTRING(Test, 1, LOCATE(',',Test) - 1), '{', '') AS tst FROM table WHERE tst LIKE '%%'; 何か良い方法などありましたら教えてください、よろしくお願いします
SLIP +----------------------+----------------------------------+----------------------------------+ | SLIP_ID | STORE_ID |AGGREGATE_BALANCE | +----------------------+----------------------------------+----------------------------------+ | 10001 | 10000 | 25000 | | 10002 | 10000 | 150000 | +----------------------+----------------------------------+----------------------------------+ SLIP_PAY +----------------------+----------------------------------+----------------------------------+ | SLIP_ID | PAY_DATE | PAY_MONEY | +----------------------+----------------------------------+----------------------------------+ | 10001 | 2011-08-16 | 5000 | | 10001 | 2011-08-16 | 1000 | | 10001 | 2011-08-16 | 5000 | | 10002 | 2011-08-16 | 2000 | +----------------------+----------------------------------+----------------------------------+ 下記のＳＱＬを発行すると、テーブル(1)が帰ってきますが、 テーブル(2)のような結果を返すようにするには、 ＳＱＬをどう記載すればいいでしょうか？ どうかご教授お願いいたします。 SELECT slip.STORE_ID, SUM( slip_pay.PAY_MONEY ) , slip.AGGREGATE_BALANCE FROM SLIP AS slip, SLIP_PAY AS slip_pay AND slip.SLIP_ID = slip_pay.SLIP_ID AND slip_pay.PAY_DATE LIKE '2011-08%' GROUP BY slip.SLIP_ID DESC ORDER BY SUM( slip_pay.PAY_MONEY) DESC テーブル(1) +---------------+------------------------------------------+-----------------------------------+ | STORE_ID | SUM( slip_pay.PAY_MONEY ) | AGGREGATE_BALANCE | +---------------+------------------------------------------+-----------------------------------+ | 10000 | 11000 | 25000 | | 10000 | 2000 | 150000 | +---------------+------------------------------------------+-----------------------------------+ テーブル(2) +---------------+------------------------------------------+-----------------------------------+ | STORE_ID | SUM( slip_pay.PAY_MONEY ) | AGGREGATE_BALANCE | +---------------+------------------------------------------+-----------------------------------+ | 10000 | 13000 | 175000 | +---------------+------------------------------------------+-----------------------------------+
ちょっとクエリーを組むのに悩んでいます。 下記のようなデータがあった場合に 項目１のグループ毎の最大の日付順に並べ、 項目２の番号順に並べたいのですが、 どういうクエリーを書いたらいいのか悩んでいます。 何かいい方法はないでしょうか？ 元データ 項目１、項目２、日付 １、０、2011/8/15 １、１、2011/8/17 １、２、2011/8/20 ２、０、2011/8/16 ３、０、2011/8/18 ３、１、2011/8/19 出力結果 項目１、項目２、日付 １、０、2011/8/15 １、１、2011/8/17 １、２、2011/8/20 ３、０、2011/8/18 ３、１、2011/8/19 ２、０、2011/8/16
WindowsServer2008にMySQLをインストール後、Could not start the service MySQL. ... MySQL サーバに接続できないのです。　Net等を調べましたが、解決しませんでした。よろしくお願いします。
MySQLの文字コードについて、質問2点あります 環境は、Windows7 ・MySQLサーバのバージョン: 5.5.8 ・MySQL クライアントのバージョン: mysqlnd 5.0.7-dev - 091210 ＜質問1＞ skip-character-set-client-handshakeせずに、 MySQLのClient charactersetを、utf8にしたいのですが、 my.iniへ、 [mysql] default-character-set=utf8 [client] default-character-set=utf8 と追記しても、 statusで確認すると、 Client characterset: cp932 と表示されてしまいます。 skip-character-set-client-handshakeと書かずに、 Client characterset: utf8 とするには、どうすればよいでしょうか。 ＜質問2＞ Client characterset: cp932のメリットについて Client charactersetを、 utf8じゃなくて、cp932にするメリットとしては、 何があるのでしょうか？ コマンドラインで日本語表示できることぐらいしか思いつかないのですが… そもそも、「MySQLのClient characterset」の意味がよく分かっていないので、 教えてください
mysql> grant all privileges on *.* to dice@"%" identified by '★★★★★' with grant option; Query OK, 0 rows affected (0.00 sec) mysql> flush privileges; とやって、MySQLODBCを上の通りに設定して、access2010の外部リンクテーブルとして、VPSのＤＢに接続しようとしたら、 ＯＤＢＣ：接続に失敗しました、とでます。 なお、accessを使わず、odbcも使う必要がない、database manager なるソフトでＶＰＳのＤＢに接続しようとしても、 接続が拒否されました、と言われます。 なぜなのでしょうか？ まだ、ほかに、接続を拒んでいるものがあって、それをとりのぞかなければならないのでしょうか？ よろしくお願いします。
こんな感じで↓ SELECT concat( `sation_name`, '駅' ) AS `sation_rename` FROM `table_name` WHERE `sation_rename` = `帷子ノ辻駅` カラム名をリネームした後、 そのカラム名をWHEREの中に組み込みたいのですが "そんなカラムは無い"とエラーになってしまいます。 as　でリネームしたカラム名は WHEREで使うことはできないのでしょうか。
テーブルのデータを移植したいと思っています PostgreSQL8.4から出力したCSVをMySQL5.5で取り込みたいのですが、COPYコマンドを使用すると以下のようなエラーが出ます ERROR 1262 (01000): Row 1 was truncated; it contained more data than there were input columns PostgreSQLはtext[]型で"{A_1,A_2}"といったデータを出力します MySQLはPostgreSQLの配列に相当する型がないようなのでBlob型で格納しようと思っています おそらくデータ内のカンマが原因なのはわかっているのですが、上手くエクスポート・インポートする方法はありませんでしょうか？
こんにちわ。 mysqlで複数のことなるテーブルの文字列を一括置き換えしたいと考えています。 ひとつのテーブルなら update テーブル名 set `カラム` = replace(`カラム`,'置換前','置換後') でできました。 table1 table2 table3 と構造が同じテーブルがたくさんある場合に、一括で置き換えができれば便利だと思っています。 どなたかご存知の方いらっしゃれば教えてください。 お願いします。
mysqlのSELECT文でWHEREを使い条件を指定する時、指定する条件が数十件～数百件合った場合どうすればよいのでしょうか？ 例えば、 以下のような感じで名前カラムと住所カラムがあったとします name　 address 田中　　東京都 鈴木　　大阪府 佐藤　　北海道 加藤　　沖縄県 中村　　群馬県 小林　　岐阜県 高橋　　東京都 渡辺　　大阪府 伊藤　　北海道 山本　　沖縄県 斎藤　　群馬県 阿部　　岐阜県 　　 　・ 　　 　・ 　　 　・ そこで、東京都と大阪府と北海道の人だけをSELECT文で選択したいのですが、 WHERE `address` = '東京都' OR `address` = '大阪府' OR `address` = '北海道' というように、一つづつ記述していかなければならないのでしょうか？ この例の場合だと3件だけの指定ですが、もしもっと膨大な量を指定したいとなったとき、とても効率が悪いように思います。 なにか良い方法はないのでしょうか？ ちなみにPHPからMySQLを利用しているのですが、現在 $where = array(); foreach($address as $value){ $where[] = "`address` = '${value}'"; } $where = implode(' OR ', $where); としておいて、 mysql_query("SELECT * FROM table WHERE ${where}"); とする方法しか思いつきません。 もっとスマートな方法があれば教えて下さい。よろしくお願いします。
こんにちは、mysqlでJOINした後、値を取得したいのですが、 2つのテーブルに値があり、片方を指定して取得する方法がわかりません。 いろいろ調べてみたのですがわかりませんでした。 どなたかご存知の方がいたら教えてください。 c_diary　テーブルと　c_member　テーブルには、両方にr_datetimeという列があります。 それを別々の変数に代入したいのですが、うまくいきません。 SELECT * FROM c_diary left join c_member on c_diary.c_member_id = c_member.c_member_id $rs = mysql_query($sql); while ($item = mysql_fetch_array($rs)) { $c_diary_r_datetime = $item['c_diary.r_datetime']; $c_member_r_datetime = $item['c_member.r_datetime'] echo $c_diary_r_datetime."/".$c_member_r_datetime; } とやっているのですが、値が入らず空白となってしまいます。 どなたか、解決法をご存知の方がいたら教えてください。
専門学校の制作でデータを格納・表示するものを作っています。 とはいっても、ブログみたいなアルゴリズムなので難しくはないです。 ただ、mysqlの構造をかんがえる時に疑問があります。 item table構造 id title body categoryid category table構造 id title 例えば、1000万件のデータを格納する時、 (1)1つのitem tableに1000万件のデータを格納して、 該当カテゴリーのもの一覧表示したり、 該当アイテムのものを表示したりする場合。 (2)item tableをカテゴリーごとに分ける。 cate1_item_table cate2_item_table 1つのtableには100万件のデータが入り、 cate**_item_tableは10個存在する。 この時、どちらのほうが負荷がかからないでしょうか。 どなたか詳しい方要らしゃれば教えていただけないでしょうか。 どうぞよろしくお願い致します。
Java初心者です。（SQLも初心者ですが…） Javaからデータベースの値をResultSetクラスのgetStringメソッドで 持って来ようと思ったのですが、持ってこれなかった。 調べたところ、値が0の項目だったのですが（これはidがゼロということで正しい） getStringで持ってきた値を見たところ、空白でした。 （空白なのかnullなのかはよく分かりません） 環境： OS：Windows7 DB：MySQL 5.1.57-community Community Server (GPL) 開発環境：Eclipse3.7 JDBCドライバ：mysql-connector-java-5.1.17-bin.jar SQL文： create table entry(id char(3),provider char(50),url char(255),blogid char(20),account char(20),password char(20)); ※blogidのところに0が入ります。 insert into entry values ('002','goo','http://blog.goo.ne.jp/xmlrpc.php','0','実際のアカウントIDが入る','実際のパスワードが入る'); Java： Connection users = SQL.getConnection(); Statement state = users.createStatement(); ResultSet result = state.executeQuery("select * from entry"); String id = result.getString("id"); String provider = result.getString("provider"); String url = result.getString("url"); String blogid = result.getString("blogid"); String account = result.getString("account"); String password = result.getString("password"); ※System.out.printlnで確認すると、何も入ってない。 そこで質問ですが、 １．値が0だけ持って来れない（0以外の数値なら持ってこれた）原因は何でしょうか？ ２．また、対処方法としては何が考えられるのでしょうか？ すみませんが、よろしくお願いします。
PHPでmySQLを作成しています。 現在学習中なのですが、自己解決できない問題が発生したのでどうかお知恵をお貸しください。 --- 同じデータベースにTableAとTableBがあります。 中身は下記のようだとします。 TableA　　　　　　|　　TableB id　　name time　|　name　time ：　　　：　　　：　　|　 C1　　　D2 101　A1　　B1　 |　　C2　　　D2　　　 102　A2　　B2　 |　　　：　　　　： 103　A3　　B3　 |　　C20　　C20 --- テーブルＡのカラムid、name、timeの３カラム、テーブルBはname、timeの２カラムです。 これを --- TableA　　　　　　　　TableB id　　name time　　name　time ：　　　：　　　： 101　A1　　B1 102　A2　　B2 103　A3　　B3 104　C1　　D1 105　C2　　D2 ：　　　：　　　： 123　C20　　D20 --- とするような方法を教えてください。（TableBはレコードなし） テーブルの結合ではIDが割り当てられず、上手な方法が思いつきません。 どうかご教示のほど、よろしくお願い致します。
タイムスタンプ型を抽出条件に指定した場合、どの様なSQL文を指定すれば良いでしょうか？ 該当するレコードは確かに存在していますが、以下のSQL文では「空」になってしまいました。 【実行したSQL文】 SELECT フィールド FROM テーブル WHERE タムスタンプ型フィールド BETWEEN '2011-08-05 20:00:00' AND '2011-08-06 19:59:59' 何卒、ご教授頂ければと存じます。 宜しくお願いします。
何度もお問い合わせし申し訳ありません。本日２度目の問い合わせです。 MySQL + PearDBでコンテンツを作っています。 テーブルのカラムは「ID、都道府県名(pre_name)、都道府県ID(pre_no)、市町村名(p_name)、市町村ID(p_no)、会社名(company).....」です。 完成イメージは下記です。 ●ユーザーは都道府県IDをGETする。 ●都道府県名がヘッダーのタイトルに掲載される。 ●指定した都道府県下の市町村の一覧が表示される ●その一覧にあるリンクをクリックすると、市町村内のホテル一覧に飛ぶ そこで作ったのが下のソースです。 ヘッダーでは、GETされた任意のpre_noに基づき、抽出されたpre_nameを1つだけ表示する。 本文では、GETされた任意のpre_noに基づき、抽出された市町村名を1回だけ表示する（その市町村名にはリンクが張られており市町村ごとのホテルページへ飛ぶことが可能) 【結果】 【ソース１】の場合 市町村名へのリンクが、登録会社の数だけ出現! (表示数を指定しないためここまでは当たり前です) ここから、繰り返しさえ制御できれば完成のはずです。 ここで対策としてfetchOneを使おうとしたのですが、fetchOneはMDBからの機能のようでpearDBでは使えません。 ということで、【ソース２】の表示数を指定することにしました。 $rs=$db->limitQuery("SELECT * FROM reform_co where pre_no = '" .addslashes($_GET['pre_no'])." ORDER BY p_no ASC",1,1); しかし今回の使用用途では何故か Parse error: syntax error, unexpected $end in になります。 どなたか、私の間違いをご指摘いただけますでしょうか? ************************************************************ 【ソース1】（市町村名がホテルの数だけ出現) <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitio … <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja"> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <?PHP // サーバー情報接続 require_once '../../config_n_reform.php'; require_once '/usr/share/pear/DB.php'; $db = DB::connect($dsn); if (PEAR::isError($db)) { die($db->getMessage()); } print('接続に成功しました<br>'); $db->query('SET NAMES UTF8'); if (PEAR::isError($db)) { die($db->getMessage()); } //////GET URL表示 if(isset($_GET['pre_no'])){ $sql = "select * from reform_co where pre_no = '" .addslashes($_GET['pre_no'])."'"; } $res =& $db->query($sql); if (PEAR::isError($res)) { die($res->getMessage()); } //////タイトル表示 print<<<EOF <title> EOF; $i = 0; while ($row =& $res->fetchRow(DB_FETCHMODE_ASSOC)) { if ($i == 0) { print($row['p_name']); print<<<EOF のホテルのご紹介 </title> </head> <body> EOF; } $i++; //////ホテル名1回のみ表示 $rs=$db->limitQuery("SELECT * FROM reform_co where pre_no = '" .addslashes($_GET['pre_no'])." ORDER BY p_name ASC",1,1); while ($row =& $res->fetchRow(DB_FETCHMODE_ASSOC)) { print($row['pre_no']); //市町村へのリンク　ここは機能しています //print '<a href="http://hoge.com/index1.php?p_no='; //print($row['p_no'].''); //print '">'; //print($row['p_name'].'<br>'); //print "</a><br><br>"; } $db->disconnect(); ?> </body> </html> **************************************************** **************************************************** 【ソース２】　繰り返しを制御したはずなのですが、エラー <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitio … <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja"> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <?PHP // サーバー情報接続 require_once '../../config_n_reform.php'; require_once '/usr/share/pear/DB.php'; $db = DB::connect($dsn); if (PEAR::isError($db)) { die($db->getMessage()); } print('接続に成功しました<br>'); $db->query('SET NAMES UTF8'); if (PEAR::isError($db)) { die($db->getMessage()); } //////GET URL表示 if(isset($_GET['pre_no'])){ $sql = "select * from reform_co where pre_no = '" .addslashes($_GET['pre_no'])."'"; } $res =& $db->query($sql); if (PEAR::isError($res)) { die($res->getMessage()); } //////タイトル表示 print<<<EOF <title> EOF; $i = 0; while ($row =& $res->fetchRow(DB_FETCHMODE_ASSOC)) { if ($i == 0) { print($row['p_name']); print<<<EOF のホテルのご紹介 </title> </head> <body> EOF; } $i++; //////ホテル名表示 $rs=$db->limitQuery("SELECT * FROM reform_co where pre_no = '" .addslashes($_GET['pre_no'])." ORDER BY p_name ASC",1,1); while ($row =& $res->fetchRow(DB_FETCHMODE_ASSOC)) { //市町村へのリンク print '<a href="http://hoge.com/index1.php?p_no='; print($row['p_no'].''); print '">'; print($row['p_name'].'<br>'); print "</a><br><br>"; } $db->disconnect(); ?> </body> </html> ********************************************************
どう頑張っても思いどうりにDBからデータがとれず困ってます... 例えばこんなテーブルがあったら（テーブル名が"test"、カラムが"name"と"id"） table test name | id ---------- aa | 1 aa | 1 aa | 1 bb | 1 bb | 1 aa | 0 aa | 0 cc | 0 カラム"id"が0の時は、カラム"name"のgroup byせず カラム"id"が1の時だけ、カラム"name"のgroup byするには、どうすればいいのでしょう？ このような感じにデータを取り出したいのです。 name | id　 | COUNT ---------- aa | 1 | 3 bb | 1 | 2 aa | 0 | 1 aa | 0 | 1 cc | 0 | 1 よろしくお願いします。
Mysql5.0.51で文字セットをShift_JIS(sjis)で運用しておりますが、 特定の漢字を入力すると、”&#33620”などと変換されて記録されます。 Web上で利用する場合はブラウザがもとの漢字に変換してくれているようですが、 pdfで表示する際には、”&#33620”と表示されてしまいます。 これを回避したいのですが、私は何を勉強すればよいでしょうか？
| id | no | date |　　content | | 01 | 01 | 2011-05-11| A | | 01 | 02 | 2011-03-09| B | | 01 | 03 | 2011-05-11| G | | 02 | 01 | 2011-02-11| Q | | 02 | 02 | 2011-04-15| F | | 02 | 03 | 2011-06-21| Z | | 02 | 04 | 2011-05-11| D | | 02 | 05 | 2011-06-21| C | というテーブルから | 01 | 03 | 2011-05-11| G | | 02 | 05 | 2011-06-21| C | というデータを取り出したいのですが、 MAXやWHEREでのサブクエリを使用してもいまいちうまく取り出せません。 要は、各ID毎に、dateが一番新しいものの中で、noが大きい行をそれぞれ取り出したいです。
ssh接続先から接続元にMySQLDBのバックアップをとるにはどうすればいい分かりません。 自宅PCからVPSサーバーにSSH接続をして、リモートコントロールしています。 サーバー側にあるMySQLのデータベース(MyISAM)のバックアップをとるために以下のコマンドを実行しました。 「sudo mysqlhotcopy -u root -p 'パスワード' データベース./テーブル/ ~/mysqlBackUp」 バックアップを「~/mysqlBackUp」ディレクトリにとれたのですが、容量が足りないためにすべてのテーブルのバックアップは取れませんでした。 すべてのテーブルのバックアップを取るために、自宅PCに直接バックアップを取りたいのですがやり方が分かりません
[環境] OS：CentOS 　　　⇒メモリ：4G 　　　⇒CPU：2コア(種類はわかりませんでした) DB：MySQL5.1.52 クライアント：Flex サーバー：php, Apache お世話になっております。 とあるSQL文を実行すると、1秒で結果が返ってくる時と、 20秒近く結果が返ってこない時があり、 原因が何なのか分からず質問させていただきました。 =以下詳細= 40万件と30万件レコードが存在する2つのテーブルを結合し、 結果を表示しているプログラムがあります。 この実行結果で、1秒で結果が返ってくる時と、 20秒近く結果が返ってこない時があります。 　※全く同じ条件で検索しています。 　※急にデータ量が増えたのではありません。 20秒近く結果が返ってこなくなる時間はだいたい30分くらいです。 30分過ぎると、1秒で結果が返ってくるようになります。 20秒近く結果が返ってこない時間帯になると、 他のプログラムのSQL文にタイムアウトが発生します。 基本的には1秒で結果が返ってきていますので、INDEXは正しく設定されていると思います。 同じ条件のSQL文で処理時間が違う原因として、考えられることはございますでしょうか？ どなたかお分かりになる方いらっしゃいましたら、 ご教示いただければと思います。 よろしくお願い致します。
ダンプデータのファイル名にアンダースコアがあると取りこめないのですが、 そういう決まりなのでしょうか？ ファイル名を変更すると(アンドースコアを外すと)、普通に取り込めます。 環境は、Windows7です
Windows7にxampp1.7.3をいれています。MySQLはSever version 5.1.41です。 my.iniは[mysqld][mysqldump][mysql]に default-character-set = utf8 を追加しました。 UTF-8でテーブルの作成（create文）とレコードの追加（insert文）を書いたテキストファイルを作り、 windowsのコマンドプロンプトから mysql -u root -p （パスワード） で入り、 source　(上のテキストファイル); で読み込ませ実行し、phpでそのデータベースに接続して使おうとしました。 しかし、特定の文字だけ化ける現象が表れます。 上のsource　(上のテキストファイル);を実行したときも、 1 row affected (0.00 sec)という中にいくつか（たぶん文字化けのところに） 1 warning (0.00 sec)が表れました。 化けた文字は「店」「局」「展」「　（全角スペース）」「く」などです。 それ以外の文字はPHPを使って見たときは正常に表示されます。 （もちろんコマンドプロンプトでselect文でテーブル表示したときなど 全部文字化けしますが） 自分では 店（E5BA97)、局(E5B180)、展(E5B195)、全角スペース(E38080)、く(E3818F)、から UTF-8で「E5B」「E38」から始まる文字が化けるように思っています。 そもそもsourceを使ってレコードを挿入する時に問題があると考えているのですが、 どのようにしたら解決するのでしょうか？
Query OK, 0 rows affected (0.00 sec) が、MySQLに与える影響について、教えてください。 この場合、「0 rows affected」て書いてあるので、 MySQLに与える影響はない、と考えてよいのでしょうか？ それとも、何らかの場合(例えばrows以外)では、 コマンドによっては、 この表示が出ても、 MySQLの設定とかが変更されることはあるのでしょうか？ 知りたいのは、 この表示が出てきたとき、 打ったコマンドが 「100%失敗だった」か、あるいは、「必ずしもそうとは限らない」、かについてです。
よろしくお願いします。 PHP5、MySQL5、 PEAR DB、Smarty　にて開発しております。 標題にもありますように、LEFT JOINを使ってUPDATEできる方法を探しております。 ●Ａテーブル（親） id ｜ del_flag ----------------- 1 ｜ 0 2 ｜ 0 3 ｜ 0 4 ｜ 0 ●Ｂテーブル id ｜ del_flag ----------------- 1 ｜ 0 3 ｜ 0 4 ｜ 0 ●Ｃテーブル id ｜ del_flag ----------------- 1 ｜ 0 2 ｜ 0 3 ｜ 0 4 ｜ 0 上記のような３つ、またはもしくはそれ以上テーブルがあったとします。 そこで、 Ａテーブルの id 2 のdel_flagを1　とアップデートしたときに、 同時に全てのＢ、Ｃのテーブルの id 2 のdel_flagも　1　としたく思います。 Ｂテーブルには、id 2 が存在しないため、結果的にはＣテーブルだけが更新されますが、 Ａ、Ｂ，Ｃともに同一のid値　がある場合も考慮して、 アップデートしたいと思います。 そこで、PHP内で、一つ一つのテーブルを地道にアップデートすることは可能だとおもいますが、 一度のＳＱＬでdel_flagの値を１とできる方法はございませんでしょうか？ お手数ですが、 具体的なクエリを書いていただけると、大変助かります。 いろいろ調べましたが、なかなか上手くいかず・・・・。 よろしくお願いいいたします。 　
携帯、PC、両方で使えるサイトをMySQLで構築中です。 当初、UTF8で構築していましたが、「auブラウザ、いまだにUTF-8が使えず！」という記事発見したことにより、急遽、EUCに変更しました。（http://symple.jp/113.html） ところが、EUCの場合、漢字がGETコマンドで正しく送信できないことが判明しました。 （FORMタグに accept-charset="euc-jp,us-ascii" を付けても、JIS X0208.1990 の6878文字中、2743文字の文字エンコーディングが正しく検出されず、UTF8と誤認識される。実際にテストで経験済み） http://www-ise3.ist.osaka-u.ac.jp/miura/?PHP%20G … 私が作りたいサイトは日本語で検索できる必要があるため、やはりUTF8で作らなければならないようです。 質問です。 サーバー側はUTF8で作らなければならないようです。 でも、そうすると、「auブラウザ、いまだにUTF-8が使えず！」に引っかかってしまいます。 このようなサイトは決して少なくないと思いますが、UTF8にも関わらずでAU携帯でも問題なく見れるサイトはどのような工夫をされているのでしょうか? ●MySQLサーバーのデフォルト文字コード ●MySQL の接続照合順序:の文字コード ●テーブルの文字コード ●テーブルの接続照合順序:の文字コード ●フォームの文字コード をどう設定しているのでしょうか? またPHPのソースに何かを追加するのでしょうか? 情報提供、宜しくお願い致します。 現在の検索ソースは下記となります。 （県名を漢字で入力し、住所群から対象の住所録を抽出する) search.php <?PHP // サーバーデータベース記録情報接続 require_once '../../config_n_reform.php'; require_once '/usr/share/pear/DB.php'; $db = DB::connect($dsn); if (PEAR::isError($db)) { die($db->getMessage()); } print('接続に成功しました<br>'); $db->query('SET NAMES UTF8'); if (PEAR::isError($db)) { die($db->getMessage()); } $sql = 'select * from city_code'; if(isset($_GET['pre_name'])){ $sql = "select * from city_code where pre_name = '" .addslashes($_GET['pre_name'])."'"; } $res =& $db->query($sql); if (PEAR::isError($res)) { die($res->getMessage()); } while ($row =& $res->fetchRow(DB_FETCHMODE_ASSOC)) { print($row['pre_name'].'<br>'); print($row['city_name'].'<br>'); print($row['city_kana'].'<br>'); print($row['kyuu_cho'].'<br>'); } $db->disconnect(); ?> フォーム <form name="form2" action="search.php" method="get"> <input type="text" name="pre_name" size="25"> <input type="submit" name="search" value="検索"><br /> <input value="pre_name検索開始" type="submit" /> </form>
自分がフォローしている人のつぶやきと、じぶんの呟きを含めて、日付順で表示するSQLを検討しています。 MYSQLの構文がかなり複雑になってしまったために、 もっと簡単に高速にSQLで記述する方法がありましたら教えて頂けませんでしょうか。 長文になり申し訳ございませんが、アドバイスいただけると幸いです。 テーブルは以下の3種類です。 ●cutomer：登録者名を記録 <構造> id（auto increment,key）,name（名前） <サンプルデータ> 0,"太郎" 1,"次郎" 2,"三郎" 3,"四郎" ●follow：誰が(my_user_id)、誰をフォローしているか(target_user_id)を記録 <構造> id（auto increment,key）,my_user_id,target_user_id <サンプルデータ> 0,1,0 0,1,2 ●tweet：つぶやきを記録 <構造> id（auto increment,key）,user_id,tweet_comment（つぶやき）,date(つぶやき日時) <サンプルデータ> 0,1,"次郎のつぶやきです","2011-01-01 00:00:00" 1,2,"三郎のつぶやきです","2011-02-01 00:00:00" 2,0,"太郎のつぶやきです","2011-03-01 00:00:00" 3,1,"次郎のつぶやきです","2011-04-01 00:00:00" 4,3,"四郎のつぶやきです","2011-05-01 00:00:00" 上記のサンプルデータを用いて、期待する出力結果をご説明します。 例として、入力値を「次郎」とすると、 「次郎」のつぶやきと、次郎がフォローしている太郎と三郎の呟きを表示したいです。 "次郎","次郎のつぶやきです","2011-01-01 00:00:00" "三郎","三郎のつぶやきです","2011-02-01 00:00:00" "太郎","太郎のつぶやきです","2011-03-01 00:00:00" "次郎","次郎のつぶやきです","2011-04-01 00:00:00" 現状は、次郎とつぶやきselectと、次郎がフォローする太郎と三郎のつぶやきselectを unionで結合する形式なっており、もうちょっと賢くできないものかと悩んでいます。 なお、対象の次郎のuser_id（サンプルでは"1"）は予めわかっているものとします。 ( select customer.name,tweet.tweet_comment,tweet.date from customer,tweet where customer.id = 1 and customer.id = tweet.user_id ) union ( select customer.name,tweet.tweet_comment,tweet.date from customer,tweet,follow where follow.my_user_id = 1 and follow.target_user_id = tweet.user_id and tweet.user_id = customer.id ) order by table_tweet.date asc
テーブルを他のハードディスクにストライピング出来ません ハードディスクが「HD20G」と「HD10G」の二つに分かれている、さくらVPS１Gプランのサーバーを使用しています。 システムファイルは「HD20G」の方に入っていて、MySQL（MyISAM、5.1.41-3ubuntu12.10）もここに入っています。 システムファイルに作成した「/data」には「HD10G」のシンボリックリンクをはっているのですが、ここにMYSQLのテーブルをストライピングさせようと、MySQLにログインしたユーザーから以下のコマンドを実行しました。 「create table Testriping ... DATA DIRECTORY = '/data';」 するとこのようなエラーが発生しました。 「ERROR 1 (HY000): Can't create/write to file '/data/Testriping.MYD' (Errcode: 13)」 エラーを調べてみると権限がないために実行が出来ないらしいので、以下のコマンドを打ちました。 「sudo chmod 777 /data」 これでもう一度やってみたのですが、同じエラーが発生します。 ただこれと、権限が同じ「/tmp」ファイルだけはなぜか作成できてしまいます。
種別：Decimal（18,2） 属性：UNSIGNED NULL：はい デフォルト値：NULL のフィールドがあります。phpMyAdminを通じてデータを入力しております。Null値のチェックを入れれば良いのですが、空白のまま残したおいた場合には、デフォルト値であるNull値が格納されるものと思っておりましたが、空白ですと0.00に変換されてしまします。 また、同時に、スクリプトの方ではjqGridを使用しているのですが、こちらの方でデータ編集をする際には、Null値のチェックボタンはありませんので、空白のままで更新しなければなりません。上記と同様に、空白にしておくと、0.00に変換されてしまいます。 Null値を入れるためには、どのような方法があるのでしょうか？ よろしくお願いします。
ｃドライブのaフォルダを、フォルダごと、cドライブのbフォルダの中にコピーしたいのですが、 mysqlで、コマンドプロンプトから xcopy c:\a c:\b\ /e; と入力してEnterを押すと、次のようなエラーが出ます。 unknown command '\a'. unknown command '\b'. unknown command '\'. どうしたらxcopyができるのか教えてください。
Excelで作成したcsvファイルをphpmyadminの管理画面よりインポートしても日本語が文字化けしてしまいます。 ファイルの文字セットなどをいろいろ変化させてみたのですが、どれもダメでした。。。 何が原因なのかわかりません。 Windows7でExcelを操作 さくらインターネットのphpmyadminを使用 わかる方いましたら教えてくださいm(_ _)m
「mysql -h localhost -u root -p」と、「mysql -u root -p」の違いについて、 教えてください。 mysqlのrootパスワードを設定したのですが、 「mysql -u root -p」では、パスワードを入力すればログインできるのですが、 「mysql -h localhost -u root -p」だと、パスワードを入力してもログインできません。 何が違うのでしょうか？ 環境 ・Windows7のローカルPC ・Eclipse 3.7 「Pleiades All in One PHP」ＸAMPP1.7.4
Mysql5でphpmyadminを利用しています。 （phpmyadminのバージョンはいろいろあるので、とりあえず限定しません） 自分がどのくらい（何メガ）データベースを利用しているのか？ をphpmyadminで調べたいと考えております。 方法について、ご存知の方、お教えくださいますよう よろしくお願いします。
PHP + MySQLのINSERTについて、不可解な現象が出ましたので、知っている方がいたら教えてください。 PHPでMySQLのデータ読み書きのプログラム(コマンドラインではなく、ブラウザで表示する)を書いたところ、PHPのプログラムの流れよりも、MySQLの書き込みが済んでしまっているような現象が発生しました。 プログラムソースの抜粋を以下に記述します。 ################# PHPのプログラム抜粋開始 ########## ～　DB接続処理　～ //================================================== // ＳＴＥＰ１：既に存在するデータを表示 //-------------------------------------------------- $sqltable= 'test'; $sqlcommand= "SELECT datadayo FROM $sqltable"; $sqlresult= mysql_query($sqlcommand, $sqllink) or die('ERROR'); while($tmpsqlread = mysql_fetch_array($sqlresult)) { echo "$tmpsqlread[datadayo]<br>"; } //================================================== // ＳＴＥＰ２：データ追加 //-------------------------------------------------- $sqlcommand= "INSERT INTO $sqltable (autoid,datadayo) VALUES (NULL,'書き込んだデータ')"; $sqlresult= mysql_query($sqlcommand, $sqllink) or die('クエリの送信に失敗しました。'); ～　DBクローズ処理　～ ################# PHPのプログラム抜粋終り ########## フローとしては、最初にＳＴＥＰ１が処理されてＳＴＥＰ２が処理されるはずです。 ■プログラム開始の時の条件 データベースをCREATEした直後にこのプログラムを流す。（つまり空の状態） ■予想した結果 １．ＳＴＥＰ１において、まだデータベースは空の状態なので、echo文では何も表示されない。 ２．ＳＴＥＰ２において書き込まれる。 ３．再度このプログラムを流す ４．ＳＴＥＰ１において、上記２で書き込んだデータが表示される。 ■実際の結果 ＳＴＥＰ１において、まだデータベースは空の状態のはずなのに、echo文で「書き込んだデータ」が表示される。 今まで、何度もこの手のプログラムを作成しましたが、このような現象は初体験です。 書き込みタイミングの遅延による現象ではなく、むしろ書き込みが早すぎる事による（PHPの処理が来る前にMySQLが処理されている）現象です。 PHPのバージョンは PHP 5.2.11 with Suhosin-Patch 0.9.7 (cli) MySQLのバージョンは Ver 14.14 Distrib 5.1.39 です。 どなたか、ご存知の方、ご教授いただけたら幸いです。
部屋の入り口にあるICカードチェッカーのログを利用してレポート作成を行う予定です。 DBはMysql5.1を利用しています。 mysql> select * from t1 ; +------+---------------------+ | id | jikan | hito | inout | +------+---------------------+ | 1 | 2011-07-20 12:50:01 |hiro|in| | 2 | 2011-07-20 13:23:37 |misa|in| | 3 | 2011-07-20 14:08:41 |hiro|out| | 4 | 2011-07-20 15:27:02 |sasato|in| | 5 | 2011-07-20 16:31:38 |misa|out| | 6 | 2011-07-20 17:42:19 |hiro|in| | 7 | 2011-07-20 18:19:09 |hiro|out| | 8 | 2011-07-20 19:07:12 |misa|in| +------+---------------------+ （jikanはdatetime形式） レポート形式は下記を予定 ｜入室日時｜退室日時｜名前｜ ☆考え方 1.whereで「in」を指定して別テーブルB1を作成 2.whereで「out」を指定して別テーブルC1を作成 とここまで考えたのですがココから先がおもいつきません。 テーブルB1とC1のjikanを比較？ B1テーブルのhiroが12:50にinした時間を基準にC1テーブルの hiroのout時間のtimediffが小さいものを探す・・・？ どなたか妙案がありましたらご教授いただきたく。 よろしくお願いします。
ユーザーを削除する際、そのユーザーが存在すればという条件をつけたいのですが DROP USER IF EXISTS testuser@localhost; とすると、エラーになります。どう書けばよいですか？
XAMPP内データを、旧PCから新PCへ移行しようとしてます。 作成したデータベース自体は移行できたのですが、 旧PCにおける、MySQLでの「管理者アカウントのパスワード設定」とか、 ユーザーアカウント設定とかは、どのファイルに書き込まれているのでしょうか？ 新PCで設定すればいいだけの話かとは思いますが、 以前からどこに設定が保存されているか疑問だったため、 教えてください
バッチファイルを実行してｍｙｓｑｌに接続し、データベースを操作しています。 mysql -u root -p < a.sql mysql -u root -p < b.sql ｍｙｓｑｌに接続する際のrootのパスワードの２回目以降の入力を、省略したいのですが、１回目の入力値をとっておいてそれを流用する方法はありませんでしょうか？
my.ini 内の [mysql]、[mysqld]、[mysqldump] の部分を変更したのですが、文字化けが直りません。 文字化けします。 対応：my.ini 内の [mysql]、[mysqld]、[mysqldump] の部分 ↓ [mysqld] default-character-set=utf8 skip-character-set-client-handshake [mysqldump] default-character-set=utf8 [mysql] default-character-set=utf8 に変更しましたが コマンドプロンプトで mysqlに接続後、statusと打ち込んで状態を確認しても Client characterset:latin1 Server characterset:latin1 となったままです。 とうすればよろしいでしょうか？ 何卒よろしくお願い致します。
まず最初に開発環境から xampp1.7.4 php Version 5.3.5 mysql ver5.5.8 Apache/2.2.17 (Win32) です 困った内容は開発してエラーが返りました エラーはこのとおりです⇓ #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''SHAINMEI, 200000or300000 FROM SHAIN WERE`kyuyo`BETWEEN' at line 1 調べたら構文の記述が間違って返るエラーだと知ったんですけどどの構文が間違っているのかわからない状態です 宜しくお願いします。
初心者です。 ちょっと伝えずらいのですが、 下記のようなテーブル構造になっています。 ■tableA +----+-------------------+------------------------------------------+ | id | title | body | +----+-------------------+------------------------------------------+ | 1 | test1 | aaaaaaaaaa | | 2 | test2 | bbbbbbbbbbbb | +----+-------------------+------------------------------------------+ ■tableB +----+-------------------+------------------------------------------+ | id | name | sex | +----+-------------------+------------------------------------------+ | 1 | taro | men | | 2 | yoko | women | +----+-------------------+------------------------------------------+ ■tableC +----+-------------------+------------------------------------------+ | id | num | order_id | +----+-------------------+------------------------------------------+ | 1 | 33 | 1 | | 2 | 66 | 2 | +----+-------------------+------------------------------------------+ ■tableD +-------------------+------------------------------------------+ | icons | order_id | .+-------------------+------------------------------------------+ | 1 | 1 | | 2 | 1 | | 3 | 1 | | 5 | 1 | | 1 | 2 | | 3 | 2 | +-------------------+------------------------------------------+ tableA,B,Cのidを軸にデータを表示したいのですが、 --------------------------------------------------------- tableA.id , body , name , sex , num , order_id FROM tableA , tableB , tableC WHERE tableA.id = tableB.id AND tableA.id = tableC.id ---------------------------------------------------------- で出力できました。 で、tableDのiconsの内容も出力したいのですが、 --------------------------------------------------------- tableA.id , body , name , sex , num , order_id , icons FROM tableA , tableB , tableC WHERE tableA.id = tableB.id AND tableA.id = tableC.id AND tableC.order_id = tableD.order_id ---------------------------------------------------------- でやると、2行しかデータがでないはずなのですが、 6行出力されてしまいます。 たぶん、tableDのデータの持ち方が、 ひとつのidに複数のiconsがある場合は、 行ごとにレコードを分けているためだと思いますが・・・ tableDの行分、6行でているのです。。 なので、期待する結果は、 ちゃんとidの数分だけ出力されて、 同order_idにiconsが複数ある場合は、 行ごとに分かれるのではなく、 ひとつのカラム？にカンマ区切りなどで 入れたいのですがどうしたらよいでしょうか？？ ↓期待する結果 ----------------------------------------------------------------------- +----+-------------------+------------------------------------------+ | id | title | body | order_id | icons +----+-------------------+------------------------------------------+ | 1 | test1 | aaaaaaaaaa | 1 |1,2,3,5 | 2 | test2 | bbbbbbbbbbbb | 2 | 1,3 +----+-------------------+------------------------------------------+ ※カンマじゃなくてもいいです わかりづらくて申し訳ありませんが、 ご教授お願いいたします。 MySQL 5.0.90-log ちなみにec-cubeの高度な設定の csvを吐き出す部分で使用しています。
いろいろと調べたのですが分からなかったので質問させて下さい。 あるMysqlのデータベースにこのようなデータがあるとき、 ID date point ------------ 1 2011-06-12 10 1 2011-06-13 5 1 2011-06-14 10 2 2011-06-09 5 2 2011-06-10 10 2 2011-06-15 5 3 2011-06-09 10 3 2011-06-10 10 3 2011-06-14 5 3 2011-06-15 10 3 2011-06-16 5 ここから各IDごとの最大の連続日数数を抜き出す方法はありますでしょうか？ 結果として ID 連続日数 ----------- 1 3 2 2 3 3 といったものを求めています。
mysqlのあるデータベースの中に、既にcreateしたはずのfunctionが、 show tables from [db.name]; で表示された中にありませんでした。 show function from [db.name]; のような働きをするコマンドはありませんでしょうか？
ｍｙｓｑｌで、複数のファイルをコピーするにあたって、copyコマンドをバッチファイルに書いて作ると、コピー元とコピー先を指定しなければならず、できれば、バッチファイルを実行する人が自由に、コピー元とコピー先を指定できるようにしたいのですが、会話式なものを作るにはどうしたらよいか、また、EXEにするにはどうしたらよいか教えていただけますか？
ｍｙｓｑｌで、テーブルの作成と初期値の登録をバッチファイルをダブルクリックして実行しています。しかし、あっという間に黒い画面が閉じてしまい、うまくいったのエラーになったのかさっぱり分かりません。 ログを出力したいのですが、 echo error message >> C:\log\result.log と書くと、指定の場所にresult.logは出来ているのですが、そのファイルを開くと、 error message としか書かれていません。 どうしたらよいのか教えてください。
MYSQLのデータベースの、IDという項目が主キーのTESTというテーブルに、データをに登録する際、 既に主キーが同じデータがない場合に、という条件をつけたいのですが、 下のように書くと、エラーになってしまいます。 INSERT INTO TEST (ID, NAME) VALUES ('a', 'abc') WHERE NOT EXISTS (SELECT * FROM TEST WHERE ID = 'a'）; どうしたらよいか教えてください。
データベースを作ろうと create database sample; をしたところ ERROR 1044 (42000): Access denied for user 'user'@'localhost' to database 'sample' というエラーが出て、データベースが作成できません。 いろいろ探して同じような質問を見つけ、やってみたのですが解決できません・・・。 mysqlには mysql -uuser -p で入っています。 よろしくお願いします。
mysql で、a というデータベース名のデータベースが存在した場合、そのデータベース a を削除する。という処理を、バッチファイルに記述したいのですが、色々例を見ましたが、 if exist [ファイル名] コマンド　 という構文はあるのですが、データベースの存在を条件に入れる例が見つかりません。 どう記述したらよいのか教えてください。
現在試合結果ページを作成しています。 参考サイト：http://www.so-net.ne.jp/antlers/games/484 上記が参考サイトであり、各表組み(レイアウト)は完成しています。 マッチレビューから下は作っていませんので省きます。 残りは上から順にスコア、得点者、各詳細(シュートの本数など)、警告者、メンバー(スタメンとサブ)。 Mysqlにて1.試合日程 2.試合結果のテーブルを作りました。 テーブル内の構図は 1.試合日程のテーブル id、日付、対戦相手、場所など 2.試合結果のテーブル id、試合日程id、得点、失点、各詳細 を作りました。 ここからが困っており、得点者、警告者、メンバー(スタメンとサブ)の構図なんですが、 各項目ごとにテーブルを作った方がよいのか、試合結果テーブルに入れた方がよいのか迷っています。 自分が考えていたのは 3.得点者テーブル id、試合結果id、ホームの得点者、アウェイの得点 4.警告者テーブル id、試合結果id、ホームの警告者、アウェイの警告者 5.メンバー(スタメンとサブ)のテーブル id、試合結果id、ホームのスタメン、ホームのサブ、アウェイのスタメン、アウェイのサブ として作ることを考えていたのですが、いかがでしょうか？ 一番効率がよく早く出来る方法を教えていただけないでしょうか？ 宜しくお願いします。
こんにちは。MYSQL5.5を使用しています。固定長のテキストファイルを各フィールドにインポートしたいと思っています。 例えば、１０文字目から２０文字目は空白(半角スペース)だとします。フィールドXに半角スペース10個をインポートしたいのですが、挿入後の結果を見るとNULLになっています。 これを、半角スペース10個挿入するにはMYSQL側でどのような設定を行う必要があるでしょうか？
下記のようなテーブルがあり、idの値を渡すと、下記のレコードを取得したいと思います。 1. 渡されたid=idのレコード 2. 渡されたid=parent_idのレコード 3. 渡されたid=parent_idのid=parent_idのレコード 【テーブル】 CREATE TABLE IF NOT EXISTS `tbl` ( `id` varchar(4) NOT NULL, `name` varchar(100) NOT NULL, `parent_id` varchar(4) NOT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO `tbl` (`id`, `name`, `parent_id`) VALUES ('0001', '親１', '0'), ('0002', '親２', '0'), ('0011', '子１－１', '0001'), ('0012', '子１－２', '0001'), ('0021', '子２－１', '0002'), ('0022', '子２－２', '0002'), ('0101', '子１－１－１', '0011'), ('0102', '子１－１－２', '0011'), ('0103', '子１－１－３', '0011'), ('0121', '子２－１－１', '0021'); 下記はそのソースとなり、やりたい事は出来ているのですが、SQLを3回実行しています。 多分2回目の$idに1回目の結果の$row["id"]、3回目の$id[$cnt]に2回目の結果の$s_idをセットすることが出来れば、1回のsql文で記述できるのではと思いましたが、 どのようなSQL文を書けば良いか分からなかった為、アドバイスいただける方がいらっしゃいましたら、ご教示の程よろしくお願いします。 【ソース】 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitio … <html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja" dir="ltr"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <title>title</title> </head> <body> <?php $link = mysql_connect('MySQL サーバ','ユーザー名','パスワード'); if (!$link) { die('接続できませんでした:' . mysql_error()); } if (!mysql_select_db('データベース名', $link)) { die ('データベースの選択失敗'); } $hairetsu = array(); $f_id = array(); $f_name = array(); $f_parent_id = array(); $s_id = array(); $s_name = array(); $s_parent_id = array(); $t_id = array(); $t_name = array(); $t_parent_id = array(); // 1回目 $query = mysql_query("SELECT * FROM tbl where id = '0001'", $link); if (!$query) { die(mysql_error()); } $row = mysql_fetch_array($query); $hairetsu["f_id"] = $row["id"]; $hairetsu["f_name"] = $row["name"]; $hairetsu["f_parent_id"] = $row["parent_id"]; $id = $row["id"]; // 2回目 $query = mysql_query("SELECT * FROM tbl where parent_id = $id", $link); if (!$query) { die(mysql_error()); } while ($row = mysql_fetch_array($query)) { array_push($s_id, $row["id"]); array_push($s_name, $row["name"]); array_push($s_parent_id, $row["parent_id"]); } $hairetsu["s_id"] = $s_id; $hairetsu["s_name"] = $s_name; $hairetsu["s_parent_id"] = $s_parent_id; $id = $hairetsu["s_id"]; // 3回目 for($cnt=0; $cnt<count($id); $cnt++) { $query = mysql_query("SELECT * FROM tbl where parent_id = $id[$cnt]", $link); if (!$query) { die(mysql_error()); } while ($row = mysql_fetch_array($query)) { array_push($t_id, $row["id"]); array_push($t_name, $row["name"]); array_push($t_parent_id, $row["parent_id"]); } } $hairetsu["t_id"] = $t_id; $hairetsu["t_name"] = $t_name; $hairetsu["t_parent_id"] = $t_parent_id; echo "<pre>"; var_dump($hairetsu); echo "</pre>"; mysql_close($link); ?> </body> </html> 以上、宜しくお願いします。
MysqlでSQlServerのようにデータベースのリンクはできますか？ 異なるPCに存在する別々のMysqlのデータベースを同じコネクションで処理を行いたいです。
環境はmysql5.2です。 例えば以下のようなテーブルがある時 pref　　　city　　town ---------------- 東京　　港区　　A町 東京　　南区　　C町 大阪　　北区　　D町 大阪　　北区　　E町 愛知　　南区　　F町 愛知　　南区　　G町 prefのみが重複しないように、全てのカラムを取得しようと思っているのですが、 select distinct pref, city, town … とすると当然全て取得されます また、 select disitinct pref　… とするとたしかにprefは重複せずにすむのですが、cityとtownを取得することが出来ません。 どのようにすればprefだけは重複させずに全てのカラムを取得することが出来るのでしょうか。 ご存じの方がいらっしゃればご教授お願いします。
サンプルのCREATE TABLE文 の中に、 UNIQUE KEY user_name_index(user_name) とあったのですが、意味を教えてください。 　自分で調べた限りは、UNIQUEというのはあったのですが、 　UNIQUE KEY が見つかりませんでした。 　UNIQUE KEY は、UNIQUEと同義なのでしょうか？ 　あるいは、こういう書き方があるのでしょうか？ 　また、CREATE TABLEの中で、user_nameカラムを作成しているのですが、 　user_name_index(user_name)では、何をしているのでしょうか？ 　user_name_indexと別の名前でUNIQUE KEYに設定しているのでしょうか？ 　それとも、_indexとついてるので、 　この書き方だけで、ユニークインデックスなるものにしているのでしょうか？
数万人規模のコミュニティサイトをxoopsで立ち上げようと考えました。 データベースの使用は初めてです。 この数万人のユーザーは、過去の自分の行動の履歴を自由に見れるようにします。 一日の書き込みは1万～2万と想定しています。 従来、cgiで同様のシステムを組んだ時にはmakefileでユーザーごとのファイルを用意し ユーザーが過去の履歴を参照する場合は自分のファイルを見に行けば参照できました。 （個々のファイルであればせいぜい数千行です) 今回、SQL + xoopsで立ち上げることを考え、xoops用のフリーモジュールを研究してみたの ですが、買い物かごなど不特定多数のユーザーが利用するモジュールを見ても、 「cgiでユーザー登録ごとにmakefileとしてユーザーファイルを作成した」ことに相当する 「ユーザーごとにテーブルを作成、用意する」という形にはなっていないようです。 ということは、SQLの場合、ユーザーの行動に対しては、全てひとつのテーブル内に延々記録 していくのだと思います。 （ID 32003の書き込み。ID　12045の書き込み。 ID 23102 の書き込み」というのがたった 一つのテーブルに記録される) この形だと1日に1万の書き込みがあるとすると、100日で100万行になってしまいます。 掲示板であれば、「上から20個参照しあとは不要」というプログラムを組めば問題ありませんが、 過去の履歴をユーザーごとに表示させるとなると、ユーザーのリクエストのたびに「100万行の 中からID32003をサーチする」プログラムを組むことになります。 これが数万人規模のユーザーから行われたらどんな高スペックのサーバーであっても足りない ように思えます。 一方、MixiもMySQLで出来ていると聞いています。 大規模なSQLというのは、このような場合、どうやって解決しているのでしょうか? （単に「サーバー増強が不可欠よ。」ということであればcgiでmakefileの方が簡単な気がします) SQLの優位性がさっぱり分からなくなった私に、どうかご教授を願います。 makefile　より、こういう点でSQLが有利だよということでも構いません。 複数の方のアドバイスを頂けると嬉しいです。 宜しくお願い致します。
MySQLを使用して、tableAというテーブルのデータを tableB,tableC,tableDというテーブルに振り分けたいと思っています。 1日1回、自動的に行いたいと思っています。 たとえば、tableAのテーブル構成が下記のようなもので ================== name sex birth address phone email company ================== name,address,phoneはtableBに name,sex,birthはtableCに name,companyはtableDに分けるというような イメージです。 私の考えでは、下記のようなSQL文をPHPから呼び出して、タスクで 実行させてそれぞれ別のテーブルに振り分けようと思っている のですが、、もっと良いツールや方法があればお教えいただけ ませんでしょうか。 宜しくお願いいたします。 ---------------------------------------------------------------------------------------------------- INSERT INTO tableB (name,address,phone) SELECT tableA.name,tableA.address,tableA.phone FROM tableA AND INSERT INTO tableC (name,sex,birth) SELECT tableA.name,tableA.sex,tableA.birth FROM tableA AND INSERT INTO tableD (name,company) SELECT tableA.name,tableA.company FROM tableA; ----------------------------------------------------------------------------------------------------
複数のテーブルから値を合計出力するSQLについて 以下の様な3つのテーブルがあり、それぞれのテーブルから値を合計した結果を取得したいと思っております。 この場合のSQL文をご教授いただけないでしょうか？ 拙い説明でお分かりに難いかと思いますが、何卒、宜しくお願いします。 ●テーブル t1(テーブル1) id, 会員ID, 日付, 金額 t2(テーブル2) id, 会員ID, 日付, 金額 t3(テーブル3) id, 会員ID, 日付, 金額 ●期待する結果 上記、テーブル内の会員ID、日付が同じものの金額を合計して取得。（1行で出力） いずれかのテーブルに「会員ID」が一つしか存在しない場合も、「日付」、「金額」を取得して「合計金額」に反映。 もし、各テーブル、レコードの「金額」が「0」または「null」の場合は「0」として処理する。 ●期待出力結果イメージ 会員ID | 日付 | 合計金額 | -------------------------------- m001 | 2011/07/20 | 1500 | -------------------------------- m001 | 2011/06/10 | 2000 | -------------------------------- m002 | 2011/06/05 | 1000 | -------------------------------- m003 | 2011/05/25 | 0 | -------------------------------- m001 | 2011/03/05 | 3000 | ※「合計金額」は、「t1(テーブル1)」～「t3(テーブル3)」の中に含まれていた金額の合計。
ＰＨＰとＭｙＳＱＬとＪＡＶＡスクリプトで作成しましたデーターベースについてお尋ねします。 ＰＨＰとＭｙＳＱＬで作成したデータベースの検索したり、読み込みを普通に可能ですが、書き込み及び、削除が出来ません。 ＰｈｐＭｙＡｄｍｉｎでは書けます（データー入力出来ます）が、ＰＨＰプログラムからはデーターを入力したり、削除を行うことが出来ません。 そして、全くエラーも出ません。 ＰＨＰ上では「書き込みました」と、いかにも正常なようなメッセージが返ってきます。 が、中身は空です。 システムが出来上がって問題なく３年以上使用していたのですが、自宅のＬＩＮＵＸサーバーのＨＤＤが壊れましたので、再度システム構築をやり直しました。 ＭｙＳＱＬとＰＨＰも再インストールを行い再構築を行いました。 その後上記症状が出て書き込み、削除が出来なくなりました。 ＰＨＰのプログラムは全く触っておらず、変更も更新もしておりません。 念のためプログラムのチェックも何度もしておりますが、勿論これといって問題は見あたりません。 ＰＨＰ．ＩＮＩ等の設定ファイルに問題があるのでしょうか。 それとも、ＭｙＳＱＬに問題が有るのでしょうか。 宜しくご教授の程お願い致します。
PHPのサンプルにテーブルロックがあったのですが、 使いどころが分からないので、教えてください。 どういう時にテーブルロックを使用するのでしょうか。 サンプルの解説だと、 「LOCK TABLES」構文を使って会員と管理者が同時に実行する可能性がある更新と削除で テーブルをロックします、 とあるのですが、 例えば、：INSERTとかでは、テーブルをロックしなくてよいのでしょうか？ これまで、気にしたことはなかったのですが、 例えば、(テーブルロックをしていない)掲示板で、たまたま同時に書き込みをしたり、しても、特に問題ないのでしょうか？ どういう時に、テーブルロックをして、 どういう時にテーブルロックをしなくてよいか、分かりません。 例えば、同じ掲示板の機能を保持するサイトが複数あった場合、 テーブルロックというのは、 大体、処理別でこういう風にする、と決まっているようなものなのでしょうか？ あるいは、データの持ち方によって、 それこそサイト毎に、実装(どこでロックするか等)はそれぞれ変わってくるようなものなのでしょうか？
こんにちは。 データベース設計をするにあたり、迷っています。 言語はRuby on rails、DBはMysqlです。 たとえば日記サイトを作るとして (1)テーブル : users , diariesがあって、それぞれのidはuser_diaries というリレーション用のテーブルを作って持たせる (2)テーブル : users , diariesがあって、diaries にuser_id というカラムを持たせる というような作り方ができると思うのですが、どちらが優れていると言えるでしょうか？ 決めの問題でしょうか？ 将来的に大きなサイトになっても大丈夫なようにしておきたいです
例えば、テーブルが以下 <<T_BOARD（掲示板テーブル）>> ・id（スレッドID） ・parent_id（親スレッドID） ・created（作成日） データが以下（親スレッドはparent_id = 0） （id,parent_id,created） 1,0,2011/5/10 2,1,2011/4/11 3.0.2011/1/13 4,3,2011/5/20 5,0,2011/6/23 のようにあるとしたら、 スレッドを親スレッドごとに取得し、作成日の降順に取得したいです。 （id,parent_id,created） 5,0 （親スレッド自身が最新） 3,0（id2が2011/5/20） 1,0（id4が2011/4/11） 現在は select buid_id,created from T_ROOM where parent_id = 0 order by created; これだと、親スレッドの作成日降順にしかとれないので、 5,0 2011/6/23 1,0,2011/5/10 3.0.2011/1/13 となってしまいます。
id 　 hoge 　 num 01 　 AAA 　 0 01 　 BBB 　 1 02 　 AAA 　 1 03 　 BBB 　 0 というテーブルがあったとします。 select id from table where hoge='AAA' and num=0 のような条件で検索するのは普通ですが、 カラムではなくレコード単位で見て hogeの値がAAAとBBBの両方である場合のデータとして「01」というidのみを抽出する方法はないものでしょうか。 よろしくお願いします。
MySQLでテーブル、データベースを作成したのですが、 OS上から作成したテーブル・データベースが保存されているファイル（データファイル？） が見つけられません。 テーブルにデータをインサートしてコミットして、 セレクトを行ってデータは反映されていることは確認しています。 OSはWindows 7 MySQLのバージョンは5.5です。 user_dbというデータベースを作成し、 show databasesを行った結果、 information_schema mysql performance_schema test user_db が表示されることから、データベースuser_dbは正常に作られていると思います、 user_dbに対して、インサートは可能で、一度データベースを停止して、 再起動後、インサートしたデータがみれています。 しかし、インストールフォルダのMy.iniのdatadirで指定されているフォルダには mysql performance_schema のフォルダしかない状態です。（ここにuser_dbフォルダが作成されると思うのですが） どこにデータが保存されているのでしょうか？
こんばんは。MYSQLのTABLE_Aに下記の３つのフィールドがあります。 日時(DATE),商品名(VARCHAR),売上(INT) 2010/01/01,商品A,100 2010/01/30,商品B,200 2010/03/10,商品C,300 2010/03/20,商品D,400 最終的に欲しいのは、１月は１月の集計(300)、３月は３月の集計(700)など、月でまとめたいと思っています。 groupでまとめるにも日付まではいっているので、月でまとめるにはどうしたらいいのか悩んでいます。よろしくお願いします。利用MYSQLは５．５です。
| ID | name | weight | height | | 1 | 佐藤 | 80 | 160 | | 2 | 太郎 | 90 | 160 | というテーブルから 佐藤と太郎の身長と体重 体重 佐藤:80Kg / 太郎:90Kg 身長 160cm というようにブラウザで表示したいのですが、 どのようにすればよいかわかりません。 現在はphpで $sql .= " SELECT "; $sql .= " GROUP_CONCAT(CONCAT(name, '：', weight, 'kg') SEPARATOR '/') AS weight "; $sql .= " GROUP_CONCAT(CONCAT(name, '：', height, 'cm') SEPARATOR '/') AS height "; $sql .= " FROM "; $sql .= " ex_table "; $rs = mysql_query($sql, $conn); $box =<<<EOM <table> <tr> <td cowspan="2"> 佐藤と太郎の身長と体重 </td> </tr> EOM; while($rec = mysql_fetch_array($rs)){ $box .= "<tr> "; $box .= "<td>体重</td>"; $box .= "<td>{$rec['weight']}</td>"; $box .= "</tr>"; $box .= "<tr> "; $box .= "<td>身長</td>"; $box .= "<td>{$rec['height']}</td>"; $box .= "<tr>"; } $box .= "</table>"; としていますが、これだと 佐藤と太郎の身長と体重 体重 佐藤:80Kg / 太郎:90Kg 身長 佐藤:160cm / 太郎:160cm となります。 同じ値のものは、そのまま数値だけを表示したいのですが、 SQL文で何かうまくする方法はないでしょうか。
MySQLで、DATETIME型のカラムから、指定した日数分の、データが存在する日付を取得することは可能でしょうか？ 例えば、下記 table_a から最近3日分のデータが存在する日を取得したい場合、 2011-06-18 2011-06-16 2011-06-12 が最近3日のデータが存在する日なので、結果に示すようなものが取得したい内容となります。 （下記結果では、各日付けの最後の時刻が取得されていますが、時刻はどれでも構いません） もしそのようなことができるSQL構文がありましたら、ご教示ください。 よろしくお願いします。 (table_a) +---------------------+ | date | +---------------------+ | 2011-06-09 09:00:00 | +---------------------+ | 2011-06-09 15:00:00 | +---------------------+ | 2011-06-10 09:00:00 | +---------------------+ | 2011-06-11 09:00:00 | +---------------------+ | 2011-06-12 07:00:00 | +---------------------+ | 2011-06-12 09:00:00 | +---------------------+ | 2011-06-16 09:00:00 | +---------------------+ | 2011-06-18 09:00:00 | +---------------------+ | 2011-06-18 12:00:00 | +---------------------+ | 2011-06-18 20:00:00 | +---------------------+ (結果) +---------------------+ | date | +---------------------+ | 2011-06-18 20:00:00 | +---------------------+ | 2011-06-16 09:00:00 | +---------------------+ | 2011-06-12 09:00:00 | +---------------------+
ＸＡＭＰＰをインストールし Ａｐａｃｈｅ／Ｍｙｓｑｌを起動ｐｈｐｍｙａｄｍｉｎにアクセスしたところ エラー 『#2003 - Can't connect to MySQL server on 'localhost' (10061) 』 設定ファイルに定義されている管理ユーザ(controluser)での接続に失敗しました が出て、正常にアクセスできません。 何が原因でできないのでしょうか？ よろしくお願いします。 config.inc.php の内容は以下の通りです。 <?php /* * This is needed for cookie based authentication to encrypt password in * cookie */ $cfg['blowfish_secret'] = 'xampp'; /* YOU SHOULD CHANGE THIS FOR A MORE SECURE COOKIE AUTH! */ /* * Servers configuration */ $i = 0; /* * First server */ $i++; /* Authentication type and info */ $cfg['Servers'][$i]['auth_type'] = 'http'; $cfg['Servers'][$i]['user'] = 'root'; $cfg['Servers'][$i]['password'] = 'root'; $cfg['Servers'][$i]['AllowNoPassword'] = true; /* Server parameters */ $cfg['Servers'][$i]['host'] = 'localhost'; $cfg['Servers'][$i]['connect_type'] = 'tcp'; $cfg['Servers'][$i]['compress'] = false; /* Select mysqli if your server has it */ $cfg['Servers'][$i]['extension'] = 'mysqli'; /* User for advanced features */ $cfg['Servers'][$i]['controluser'] = 'pma'; $cfg['Servers'][$i]['controlpass'] = ''; /* Advanced phpMyAdmin features */ $cfg['Servers'][$i]['pmadb'] = 'phpmyadmin'; $cfg['Servers'][$i]['bookmarktable'] = 'pma_bookmark'; $cfg['Servers'][$i]['relation'] = 'pma_relation'; $cfg['Servers'][$i]['table_info'] = 'pma_table_info'; $cfg['Servers'][$i]['table_coords'] = 'pma_table_coords'; $cfg['Servers'][$i]['pdf_pages'] = 'pma_pdf_pages'; $cfg['Servers'][$i]['column_info'] = 'pma_column_info'; $cfg['Servers'][$i]['history'] = 'pma_history'; $cfg['Servers'][$i]['designer_coords'] = 'pma_designer_coords'; /* * End of servers configuration */ /* * Directories for saving/loading files from server */ $cfg['UploadDir'] = ''; $cfg['SaveDir'] = ''; $cfg['AllowAnywhereRecoding'] = true; $cfg['DefaultCharset'] = 'utf-8'; $cfg['DefaultLang'] = 'en-utf-8'; $cfg['DefaultConnectionCollation'] = 'utf8_general_ci'; $cfg['MySQLManualBase'] = 'http://dev.mysql.com/doc/refman/5.1/en'; $cfg['MySQLManualType'] = 'searchable'; ?>
mysql初心者です。宜しくお願い致します。 PHP+Mysqlで以下のスクリプトを組んでいます。 変数aを一旦決めておき、カウント結果次第で変数aの値を広げるというものです。 これをSQL文一発にまとめたいのですが、可能でしょうか？ mysqlのバージョンは5.1.34です。お詳しい方、ご教授お願い致します。 $a = 10;　//仮に10 $query = "SELECT COUNT(*) AS cnt FROM mydb WHERE col_a BETWEEN ( 100 - $a ) AND ( 100 + $a ) AND col_b BETWEEN ( 100 - $a ) AND ( 100 + $a )"; $result = mysql_query($query); $row = mysql_fetch_array($result); if($row[cnt] < 10){$a = 20;} //件数が10件以下ならaの範囲を広げて結果取得 $query = "SELECT * FROM mydb WHERE col_a BETWEEN ( 100 - $a ) AND ( 100 + $a ) AND col_b BETWEEN ( 100 - $a ) AND ( 100 + $a )"; $result = mysql_query($query);
xampp（zipバージョン）をいれて、 xampp_start.exe をたたいだら、my.iniがないのでmysqlを起動できませんと言われました。 my.ini は自分で作らないといけないのでしょうか？ また、もしそうだとしても、my.iniの書き方がわからないのでおしえていただけますでしょうか？ 以上、よろしくお願いいたします。
いつも回答ありがとうございます。 MySQL＆PHPを利用しております。 下記のように書いたのですが、フィールド追加できません。 $today = date("ymd"); $sql = "ALTER TABLE book1 ADD $today TEXT NOT NULL"; $query = mysql_query($sql, $link); $todayの所を、 $today = "d" . date("ymd"); のように文字を先頭に置くなどするとフィールドを追加できました。 日付はフィールド名として指定できないのでしょうか？ CRONで毎日、日付のフィールドを追加して、データの変化を見ていきたいと考えています。 わかる方お願いします。
映画テーブル id、タイトル、　　　画像、　制作年、　あらすじ 1　あいうえお　　　　　　　　2007　　　これは・・・ 批評テーブル タイトルid、　感想、　　　点数(10点満点) 　　　１　　　とても・・・　　　　　８ ジャンルテーブル(このテーブルには最初から全ジャンルが入っています) タイトルd、　ジャンル1、　　ジャンル2 　　　１　　　アクション　　　サスペンス 人物テーブル(名前が追加されていき、重複のないリストになる) id、　　名前 1　　　ブラピ 2　　　レオナルド 3　　　ジョージ 4　　　ミラ 映画関係者テーブル タイトルid、 　　１ 監督id(人物テーブルから該当するidを取得)、 　　3 キャスト1id(同じく人物テーブルから該当するidを取得)、 　　1 キャスト2id(同じく人物テーブルから該当するidを取得)、 　　2 キャスト3id(同じく人物テーブルから該当するidを取得)、 　　4 というようなテーブルを5個作成しました。 select時に取り出したいデータは、 タイトル（あいうえお）、画像、制作年（2007）、あらすじ（これは・・・）、感想（とても）、点数（8）、 ジャンル1（アクション）、ジャンル2（サスペンス）、監督名（ジョージ）、キャスト1名（ブラピ）、 キャスト2名（レオナルド）、キャスト3名（ミラ） の12個です。 しかし、ネットや専門書で調べても３個までのテーブル結合しか掲載されおらず、5個のテーブル結合の方法が分かりません。 苦戦しているのは、人物テーブルと映画関係者テーブルを結合しての監督等の名前だけをとりだす方法です。ここだけ、別途で選択したほうがいいのでしょうか？ 一度の処理で、全てのデータを取り出すのが理想なのですが、やはり、このテーブル構成自体に無理があるのでしょうか？ 土曜、日曜と調べたのですが、ヒントすら探し出すことができませんでした。 よろしければ、テーブル結合の仕方を教えてください。 お願いします。
映画テーブル id、タイトル、画像、制作年、あらすじ 批評テーブル タイトルid、感想、点数(10点満点) ジャンルテーブル(このテーブルには最初から全ジャンルが入っています) タイトルd、ジャンル1、ジャンル2 映画関係者テーブル(名前が追加されていき、重複のないリストになる) id、　　名前 1　　　ブラピ 2　　　レオナルド 3　　　ジョージ 4　　　ミラ 映画関係者テーブル タイトルid、 監督id(映画関係者テーブルからidを取得)、 　3 キャスト1id(同じく映画関係者テーブルのidを取得)、 　　1 キャスト2id(同じく映画関係者テーブルのidを取得)、 　　2 キャスト3id(同じく映画関係者テーブルのidを取得)、 　　4 というようなテーブルを5個作成しました。 select時に取り出したい内容は、タイトル、画像、制作年、あらすじ、感想、点数、 ジャンル1、ジャンル2、監督名、キャスト1名、キャスト2名、キャスト3名 の12個です。 しかし、ネットや専門書で調べても３個までのテーブル結合しか掲載されおらず、5個のテーブル結合の方法が分かりません。 土曜、日曜と調べたのですが、ヒントすら探し出すことができませんでした。 やはり、このテーブル構成自体に無理があるのでしょうか？ よろしければ、テーブル結合の仕方を教えてください。 お願いします。
update `dtb_products` SET `main_comment` =REPLACE(main_comment ,"http://user_data","/user_data") と言うクエリを実行したところ、対象が0件となるのですが、 何か使い方間違ってますか？
mysql初心者です。以下のデータから勤務時間（end_time-start_time-break _time）が８時間以上、かつ終了時間が２２時以降の場合、（end_time-22:00）を深夜残業時間として、深夜残業時間を計算したいのですが、case文で場合分けしてAかつBの場合というような書き方はどのように書いたらいいでしょうか。よろしくお願いします。 name　　start_time　　end_time　　break_time 田中　　　9:00　　　　　　22:30　　　　1:00 佐藤　　　9:00　　　　　　21:00　　　　1:00 渡辺　　　１0:00　　　　　24:00　　　　1:00 藤原　　　9:00　　　　　　18:00　　　　1:00
こんにちは。Windowsに最新のMYSQLをインストールして使っています。デスクトップ専用で私個人で使用しています。 ダンプすると2.5時間かかり、３Gのファイルがはかれます。私のデスクトップは１Tの容量があります。 いまのところ、検索なども遅いと感じず便利に使えています。 そこで、何GくらいまでMYSQLって保存できるんだろう、どのくらいの容量になると動作がおそくなるだろうという疑問がわいてきました。 レベルはMYSQLはど素人でAccessとSQLがわかる程度です。 質問としましては、どのくらいのMYSQLでデータを保存すると動作がおそくなってくるのでしょうか？
よくSQLインジェクションの攻撃で、改竄されたWEBページからウイルスを仕込まれた。 等という話を耳にしますが、この攻撃でどうやって改竄するのですか？ 私が知ってる範囲だと、この攻撃では入力フォームに必ず条件マッチするようなSQLを入れて 情報を取り出したり、DBの情報を書き換えたり、情報を消したりくらいしか出来ない気がするのですが・・ あと、SQLインジェクションの紹介でよく見る、ログイン画面で「' 1=1;--」みたいな入力は誰でも思いつくと思うのですが、DBの情報を書き換えたり消したりするのって そのDBのカラム名とかが分からないとできないですよね。 攻撃者はこれらを推測して行っているのですか。 それともカラム名とかを知り得る攻撃手法があるのでしょうか。 また、SQLインジェクションとは関係ないのですがXSSという攻撃手法もありますよね。 こっちはクッキー情報を盗まれるのが一番大きな被害とありますが クッキー情報を盗まれると具体的に何がまずいのでしょうか。 サーバー側でクッキーに個人の名前とかメアドとかを入れてる場合があるという事ですか？
MySQL5.1.22& Perl5.8の環境にて、とあるサイトの作成（風俗店の従業員出席表）をしております。 MySQL5.1.22& Perl5.8の環境にて、とあるサイトの作成（風俗店の従業員出席表）をしております。 そのサイトで「従業員の出勤時間」(work_start、work_end（time型））をあらかじめセットしておき、現在時刻がその範囲内（つまり出勤中の時間帯）に、該当従業員のprofileテーブルを読み込む処理を行いたいのですが、苦戦しております。 また可能であれば「出勤時間内に、お客様が入った場合に「利用されたプラン（60,90,120など）を「残り時間」として表示させる仕組みについて（MySQLの構文のみで実現可能であれば、その構文、複合的な処理になるのであればその処理方法）をお教えいただければ幸いです。 【全体の流れ】 【スケジュール設定】(営業日当日にサイトへ表示) →【出勤】(出勤中表示) →【サービス開始】( サービス残り時間表示)→【サービス終了】(出勤中表示) →【退勤】(本日は終了の表示) テーブルの内容は下記の通りです。 出勤スケジュールテーブル(schedule) ---------------------------------------------------------------- カラム名|staff_id|work_day |work_start|work_end|service_start|service_end| ---------------------------------------------------------------- 型 | int | date | time | ---------------------------------------------------------------- 内容 | 1 | 2011-06-08|18:00:00 |06:00:00| ＊＊ | ---------------------------------------------------------------- 従業員プロフィールテーブル(profile) ---------------------------------------------------------------- カラム名|staff_id| name | 3size |comment | ---------------------------------------------------------------- 型 | int |varchar(15)| varchar(30) | varchar(100) | ---------------------------------------------------------------- 内容 | 1 | 従業員名 |T:150/B:200/W:200/H:200 |従業員コメント | ---------------------------------------------------------------- 複雑なご質問となりすみませんがどなたかご回答お願いいたします。
市区町村|コード| 杉並区 |22222| 杉並区 |22222| 杉並区 |77777| 豊島区 |88888| SQL文で、上記のデータから重複するコードは一つのカウントとしてまとめ、下記のように杉並区のデータを取得したいのですが、うまくいきません。どのように書けば良いでしょうか。 市区町村|CNT| 杉並区 |2 | 失敗SQL select DISTINCT 市区町村,コード, COUNT(*) as CNT from テーブル WHERE 市区町村 = '杉並区' GROUP BY 市区町村,コード
初歩的な質問ですみません table:A +------------+-------------+ | id | status_id| +------------+-------------+ | 1 | 1 | | 2 | 2 | | 3 | 1 | | 3 | 2 | +------------+-------------+ table:B +------------+-------------+ | status.id | name| +------------+-------------+ | 1 | そば | | 2 | うどん | +------------+-------------+ みたいなテーブルがあるとすると、 +------------+-------------+------+ | A.id | B.status_id| B.name | +------------+-------------+------+ | 1 | 1 | そば | | 1 | 2 | NULL | | 2 | 1 | NULL | | 2 | 2 | うどん | | 3 | 1 | そば | | 3 | 2 | うどん | +------------+-------------+------+ 結合して上の表のようにしたいのです どうかお力をお貸しください
現在レンタルサーバーにて、不動産検索サイトの簡易的なようなものを運営しています。 phpとmysqlで動かしているのですが、新たに不動産を追加するときはあらかじめsql文作成ページで必要事項を打ち込むことで生成しておいたinsertのsql文を（一度に何行も作成しておいています）、手動で一定時間ごとにphpmyadminに直接放り込んでいます。 このあらかじめ何行も作成してあるinsertのsql文を一定時間ごとに一行一行放り込む作業を自動化したいのですが、どのようにすればいいでしょうか？ もしくはこれは根本的にできないことなのでしょうか？ よろしくお願いします。
table_A ---+------ id | count ---+------ 1 | 5 ---+------ 2 | 6 ---+------ 3 | 7 ---+------ table_B ---+----- id | sub_count ---+----- 1 | 2 ---+------ 2 | 2 ---+------ 3 | 5 ---+------ 1 | 3 ---+------ 2 | 4 ---+------ このようなテーブルで table_Aのcountと、table_Bのidでまとめたsub_countの合計が 一致しないidだけを抽出するために、 SELECT table_A.id FROM (SELECT sum(table_B.sub_count) FROM table_B GROUP BY table_B.id) AS B, table_A, table_B WHERE table_A.id = table_B.id AND table_A.count != sum(table_B.sub_cout) と書いてみましたが、うまくいきません。 ERROR 1111 (HY000): Invalid use of group function 何が悪いのでしょうか？ mysqlも投稿も初心者です。 よろしくお願いします。
mysqlで 駅１から徒歩何分、駅２から徒歩何分 というカラムがあり、 駅から近い順に並び替えるというものを作っているのですが 駅から何分を入力するところが駅１と駅２と２つカラムがあるため それらを合わせて、ソートしたいと考えています。 理想のレコードとして　 駅１　徒歩２分 駅２　徒歩２分 駅２　徒歩３分 駅１　徒歩５分 駅２　徒歩６分 こんな感じにしたいのですが、 これを実現するにはどのようなソートを組めばよいのでしょうか？
同じ構造の、 　A_table　と　B_table　があります。 それぞれに 　id　date　name　address　mail　comment という、6つのカラムがあります。 変更があった際に、　A_table　にcsvで全データをインポートし、 　B_table　に変更のあったカラム（　date　name　address　mail　）の列だけをコピーしたいと思っています。 （　id　）は　A_table　と　B_table　共通にし、変更しないことを前提としています。 （　comment　）は外部から編集できるため、csvデータが最新の情報とは限りませんので、 csvデータでの変更は考えておりません。 レコード数としては、多い方だと思います。 上記の作業をしようと思っているのですが、 >>　B_table　に変更のあったカラム（　date　name　address　mail　）の列だけをコピー する方法をご存じの方がいらっしゃいましたら、何卒、ご教授お願い致します。 また、 変更したいカラムだけ、csvデータとidを共通にすればインポート可能かな…と探してはみたのですが無いようで、こちらはできないと考えても大丈夫なのでしょうか。 （phpmyadminを利用しておりますが、カラム名を指定してインポートはできるのですが、 　指定しないカラムは空白になって上書きされてしまいます。） ついでで申し訳ないですが、宜しければアドバイスをいただければと思います。
xampp 1.7.3 with mysql 5.1.41です。my.ini を次のように設定しました。 [mysqld] セクションに追加 default-character-set = utf8 skip-character-set-client-handshake character-set-server = utf8 collation-server = utf8_general_ci init-connect = SET NAMES utf8 [client] セクションと [mysql] セクションと [mysqldump] セクションに追加 default-character-set = utf8 これでコマンドラインからテーブルのデータを　select すると日本語が文字化けするのです。 サイトを検索すると、上記設定で文字化けが解決するという記事は見つかるのですが・・・・・・。 何が不調の原因でしょうか？　解決策お分かりの方がおられたら、よろしくお願いします。
山田と申します。 現在自宅PC上のMySQL5.1にWikipediaのSQLダンプデータをインポートしようとしているのですが、 データが大量なせいかどうしても時間がかかってしまっています。 多少ウェブ上で調べた中から、ダンプデータのテーブル定義からuniqueを外したり、InnoDBをMyISAMに変えたりしたのですが思った程効果が実感できませんでした。 そこで、以下の点についてご存知の方がいらっしゃいましたら教えて頂けないでしょうか？ ・MySQLのチューニングに関する情報 ・大量データをインポートする際の注意点やコツ ・大量データのインポートに関するベンチマーク等のデータが見れるページ よろしくお願いします。
お世話になります。 Windows7 Pro 32bit SP1内に、 MySQL Ver5.5.12と、 phpMyAdmin Ver3.3.10.1を入れています。 （ほかに、 　Apache HTTP Server 2.2.19(VC9)、 　Apache Tomcat 6.0.32、 　PHP 5.3.6(VC9 x86 ts)、 　Eclipse3.6(Helios) pleiades-All-In-One(Java)なども） この開発環境で、 phpMyAdminを開いて、 文字コードとしてUTF-8（３バイト以内の文字）では、 SQL文のUPDATE処理等が、 問題無く動作していることを確認済です。 そこで、質問内容ですが、 UTF-8で4バイトになる文字(JIS X 0213の漢字第3・第4水準の一部が4バイトになる)、 「JIS X 0213(１面)(漢字第3水準)」 Unicode：U+2000B UTF-16 ：0xD840 0xDC0B の文字である、"
SQLのSELECT文に *(ワイルドカード)を使うのはあまりよろしくないと http://oshiete.goo.ne.jp/qa/6276536.html で掲載されています。 基本的に　”使う分だけ” カラムを一個一個指定していくのが定石でしょうか。 使いたいカラムが増えたら、その都度SELECT文にも項目を 足していくのでしょうか。 よろしくお願いします。
ID A B C D E F G 1 yx bc 1 1 2 0 4 2 yx db 0 1 1 1 0 3 wr ky 4 0 2 1 1 ↑の様なテーブルで、C～Gまでの合計値が5以上のみ検索する事は出来ますか？ 結果が上記例ではID1と3になる様にしたいのです。
宜しくお願いします。 MYSQL を ACCESS にて操作しているのですが、データ型について困っています。 MYSQL に bigint のフィールドがあります。そこに数値（金額）のデータがあります。 ACCESS　で参照すると、テキスト型と表示されてしまい、access側で計算式が出来ません。 どのようにすれば、数値（金額）と認識させることが出来るでしょうか？
現在さくらのレンタルサーバを使用しています。 MysqlをPDOからアクセスしているのですが、日本語入力をすると文字化けしてしまいます。 検索した結果、文字コードの問題が多く報告されていたため、 以下のサイト等を参考に、PHPMyAdminで文字コードをutf8_general_ciにして PDOでも文字コードをutf8にしてみました。 しかしながら、PDOから日本語をinsert等するとDB上で「？？」が表示されてしまします。 http://d.hatena.ne.jp/sdhr/20100806/1281095806 非常に困っているので、どなたか解決策をご存知でしたらご教授お願い致します。
例としまして、 TABLE名：table3 カラム名：c_honbun [c_honbun]のカラムのとあるレコードにある文章： 極寒の候ではございますが、皆様にはますますご繁栄の事とお喜び申し上げます。何かとお心にかけて下さいましてありがとうございます。 上記の文章の中にある、「す」というひらがなの数を計算したい。 というようなことは、可能なのでしょうか？
WEBサービスの動作確認用に自宅PCにテスト環境を構築しました。システムのバージョンは下記の通りです。すべて、同一マシンのCドライブのデフォルトのフォルダにインストールされています。 OS:WindowsXP sp3 Apache2.2 PHP5.2 MySQL5.5 先ず、phpinfo()で確認したところ、図の通りmysql,mysqli関係のエクステンションは読み込まれています。 次に、MySQL自体はサービス一覧でも起動しているし、コマンドプロンプトからも起動できます。 ポートはmy.iniで3306に設定していますが、XPのファイヤーウォールは例外設定しているし、ファイヤーウォール機能のあるアンチウイルスソフトはインストールしていません。 MySQLフォルダの中にあるmy-small.ini～my_huge.inを確認したところ、"#skip-networking"とコメントアウトされています。 試しに、"telnet localhost 3306"をやると、謎の文字列が出てきて、しばらく後に「接続が切断されました」となります。これって繋がってるって事ですよね？ PHPスクリプトは下記の通りです。 <?php $link=mysql_connect('localhost','root','root')or die("MySQLと接続できません"); ?> ところが結果は、下記の通りのエラーが出て繋がりません。 Warning: mysql_connect() [function.mysql-connect]: Can't connect to MySQL server on 'localhost' (10061) in C:\Program Files\Apache Software Foundation\Apache2.2\htdocs\myconnect_test.php on line 2 MySQLと接続できません 英語のドキュメントを含めて、ネット上をかなり捜しましたが、他に原因となるような事は見つかりませんでした。 これまで過去のバージョンを含め、MySQLやPHPを何度かインストール/アンインストールを繰り返したので、昔の設定ファイルが残っているのか？とも思いましたが、WINDOWSフォルダにそれらしいものは見つかりませんでした。 もうお手上げ状態ですが、何か見落としていますでしょうか？
root権限を持たないVPSサーバにSSH接続しMySQLデータベースのバックアップをとりたいのですが、コマンドの書き方がおかしいのか、いっこうにmysqldumpが行われるようすがありません。SSHでの接続は正常に行われデータベース一覧等も取得できてはいます。 しかし、以下のようにコマンドをうってみても、何か入力をそくしているのかなんなのかリターンキーを押すそばから「-> 」が表示され、先に進みません。 これはどうなっているのでしょうか？、何か入力間違いがあるのでしょうか？ また保存場所はどこになるのでしょうか？ 不慣れな環境の中SSH接続でのMySQLメンテナンスで頭を抱えています。 データベース：mydb ユーザー名：root パスワード：n*****S mysql> mysqldump --default-character-set=binary -u root mydb --password=n*****S > mydbdump.sql
自宅のXPマシンにテスト用のWEBサーバーを立ち上げました。インストールしたのは、apache2.2 とphp5.2そしてMySQL5.5です。 ブロードバンドルーター(AtermWR8370N)の電源を切ると、それまで出来ていたコマンドプロンプトからMySQLへの接続が出来なくなります。「サービス」一覧を見るとMySQLは「開始」となっています。localhostにアクセスしているだけで、外部とのやり取りはしていないのに、ルーターが関係あるのでしょうか？
宜しくお願い致します。 MySQLのselect検索時にフリーワード検索をしています。 DB上には半角・全角文字が混在しており、検索窓に入力した文字の全角・半角を区別せずに検索しております。 文字コードがUTF-8なので、SQL文のwhere区で「collate utf8_unicode_ci」を指定して全角・半角の区別無しで検索しております。 しかし、半角濁音文字、たとえば「ベルト」や「パワー」等の文字列がDB上に半角カタカナで入っている場合に検索窓に全角で入力しても検索できません。 原因はDB上では半角の「ヘ」と「濁音記号」として認識しており、検索窓に入れた文字列は、そのまま「ベ」という1文字として認識しているので検索できないと思われます。 この問題を解決する方法が無くて悩んでおります。 どなたかご教授の程、宜しくお願いいたします。
お世話になります。 SQLでIN句やサブクエリではなく、HAVING句＋MAX関数を使用して最大値を含むレコードを抽出することはできるのでしょうか。 id | name | value --------------- 1 | aaaa | 2000 2 | aaaa | 1000 3 | bbbb | 1000 上の表でいうとnameフィールドでグルーピングしてidの１と３が抽出対象になります。MySQLを使用しておりますが、 標準SQLでお願いしたいです。 よろしくどうぞ。
宜しくお願いします。 現在、mysql（PHPMYAdmin）　を　access から操作しているのですが、以下の事がわかりませんでした。 PHPMYAdmin のテーブル　a　と　b　に　int型・AUTO_INCREMENT　の a_auto　 b_auto を作成しています。それを access クエリで統合し、フォームを作成しました。 フォームで入情報を入力していると、　a_auto と b_auto が異なる値で保存されてしまいます。 これを同じ値で保存したいのですが、どうすればいいでしょうか？
以下等のページを参考にしてMySQLのテーブルをAccessで表示することを試みました。 http://mysqlweb.net/category/4062977-1.html が、しかし、改行の入っている文字列はAccessでは表示されません。 (文字列はMySQLで、VARCHARで指定しています) これは致し方ないものなのでしょうか。
name　| keyword　　 --------------------- イチゴ |　果物,赤,甘い,春 レモン |　果物,黄色,酸っぱい,種あり,柑橘類 ミカン |　果物,橙,甘い,酸っぱい,柑橘類,冬,こたつ ブドウ |　果物,紫,甘い,皮あり,種あり,ワイン 人参　 | 野菜,橙,固い 大根 |　野菜,白,おでん,冬 このように、キーワードをコンマで分けているテーブルがあるとします。 例えば「果物」「甘い」「種あり」の三つのワードでkeywordを検索した時 name ------- ブドウ　　（3ワード一致） イチゴ　　(2ワード一致) ミカン　　(2ワード一致) レモン　　(1ワード一致) 上のように一致するキーワードが多い順に表示させたいのですがうまくいきません select name from tb where keyword like '%果物% or keyword like '%甘い% or keyword like '%種あり% order by count(name); これだと上手くいきませんが、意味的にはこのようにしたいと思ってます。 joinで同じテーブルを結合しても思うように行きませんでした。 何か良い方法があればご教授お願いいたします。
csvファイルからMySQLにデータを取り込む際に、Date型やint型にNULLを設定するにはどうしたらよいでしょうか。 以下のようなテーブルに | tTest | CREATE TABLE `ttest` ( `ID` bigint(20) NOT NULL, `title` text NOT NULL, `naiyou` varchar(100) DEFAULT NULL, `kaishi` date DEFAULT NULL, `owari` date DEFAULT NULL, `peirod` bigint(20) DEFAULT NULL ) ENGINE=InnoDB DEFAULT CHARSET=sjis | 以下のようなcsvファイルを読み込んだとき(*)、 10,テスト,2008-04-05,2009-04-23,43 11,テスト,2008-04-05,NULL,43 12,テスト,2008-04-05,2009-04-23,NULL ２行目のNULLで ERROR 1292 (22007): Incorrect date value: 'NULL' for column .... とエラーが発生します。 ３行目のNULLでもint型ですが同様にエラーとなります。 一方、insertで行の追加以下のようにした場合は成功します。 insert into tTest values (12,テスト,'2008-04-05',NULL,NULL) 外部ファイルから読み込んだ場合にNULL値を設定するにはどのようにしたらよいのでしょうか。 (*)以下のコマンド LOAD DATA INFILE "E:\\work\\MySQL\\sample.csv" INTO TABLE tTest FIELDS TERMINATED BY "," LINES TERMINATED BY "\r\n";
xampp-win32-1.6.4-installer.exeをインストールしました。 パスワードを設定をしようと コマンドプロンプトを起動して、＞の後にmysqladmin -u root password 1234 と入力してｅｎｔｅｒを押すと、エラーが発生します。 内容は、 mysqladmin:connect to server at'localhost'failed error:'access denied for user 'root'`'localhost'(using password :no)' です。 どうすればパスワード設定ができますか？ 初心者なのでわかりやすく教示していただくとありがたいです。 パソコンはWindows７です。 よろしくお願いします。
MYSQLの差集合について MYSQLの差集合についてお教えください。OracleにはMinus、Postgres等はexceptがあります。MYSQLで同等の関数がないか調べましたが、無いのか検索がヘタなのかヒットしません。下記のようにSQLを書けばexceptと同じ効果があるのはわかりますが、exceptみたいにかけたら簡単かなと思います。そのような関数がありましたら、お教えください。よろしくお願い致します。 mysql> SELECT table1.* FROM table1 -> LEFT JOIN table2 ON table1.id=table2.id -> WHERE table2.id IS NULL;
お世話になります。MySQL４のデータベース上に２つのテーブルがあるのですが、 片方のテーブル(a)にあるフィールド(b_id)の値を参照し、もう片方のテーブル(b)のレコードを消していきたいのです。 具体的には以下のようなテーブル（a）とテーブル（b）があります。 TBL: a =========================== id　　　　b_id　　　　category =========================== 0 　　　　1　　　　　　　3 --------------------------- 1　　　　 2　　　　　　　1 --------------------------- 2　　　　 3　　　　　　　2 --------------------------- 3　　　　 4　　　　　　　2 --------------------------- TBL: b =========================== id　　　　name　　　　price =========================== 0　　　　goodsA　　　1,000 --------------------------- 1　　　　goodsB　　　500 --------------------------- 2　　　　goodsC　　　250 --------------------------- 3　　　　goodsD　　　2,500 --------------------------- 4　　　　goodsE 　　　1,800 --------------------------- やりたいことは、テーブル（a）の「category」フィールドが「2」以外であれば、 そのレコードの「b_id」にある数値を「id」にもつ、テーブル（b）のレコードを消していきたいのです。 上記の例だと、テーブル（a）のid「0」と「1」がcategoryに「2」以外を持っています。 この２つのレコードのb_idは「1」と「2」ですので、テーブル（b）のid「1」と「2」を消したいと思っています。 SQLについて知識がなく、困っています。どなたかご存知の方がいらっしゃいましたら、お知恵をお貸しください。 よろしくお願いします。
ジャンル 　idジャンル名日数id ----+---------------+--------------+---------+------- 001ワンピース2011051810a001 001ワンピース201105186a002 002アクセサリー201105185b002 仮に、このようなデータがあったとします。 数時間後には、↓のように変更がかかって送られてきます。 001ワンピース201105197a001 001ワンピース201105186a002 002アクセサリー201105199b002 データ配布元の問題で、内容が更新された時点で、まだデータが確定していないものは、前日のデータが混ざって送られてきます。 この仕様を改良することは、残念ながら全く不可能です。 しかし、このデータをそのままテーブルに取り込んでしまうと、当然、2行目が重複してテーブルに収まってしまい、その後のデータ抽出に支障がでます。 例の場合でいえば、既に存在している2行目のデータを捨て、1行目と3行目のみを抽出する方法を探しています。 そこで、全部のデータを持つのをテーブル１とし、新しく着いたデータ（0519を含む方）をテーブル２に一時保管て、 SELECT テーブル2.ジャンルid, テーブル2.ジャンル名, テーブル2.日, テーブル2.数, テーブル2.ID FROM テーブル2 LEFT JOIN テーブル1 ON (テーブル2.ID = テーブル1.ID) AND (テーブル2.数 = テーブル1.数) AND (テーブル2.日 = テーブル1.日) AND (テーブル2.ジャンルid = テーブル1.ジャンルid) WHERE (((テーブル1.ジャンルid) Is Null)); と不一致SQLをAccessで行ったところ、1行目と3行目までが抽出できました。 ジャンルid、日、数、id　が一致しないものを取りだすという不一致クエリの改造です。 ところが、同じSQLを、本番であるMySQLで行ったところ、データが抽出できす、反応が無くなってしまいます。 サンプルでは件数を絞りましたが、実際には1回分のデータが1万件近くあり、さらにメインテーブルは60万件ほどになるため、量が多すぎるためとも思いますが、4時間経ってもクエリの結果が返って来ないのは、MySQLとなにか合わないのではないかと思います。 MySQLで、上記と同じく、ジャンルid、日、数、id　の全てが一致しないデータを抽出する事は可能でしょうか？ ちなみに、MySQLテーブルでは、idの前にインクリメントのフィールドを置き、インデックスもインクリメントのフィールドで作成してあります。 よろしくお願いします。
PHP、phpmyadmin使用可能なwebサイトが作りたいです。 PODBOYで、サーバーは貸してもらえました。 （ドメインを取得する前にサーバーGET） ドメインを取得してDNSの設定をしたいのですが、 プログラム使用可能で無料のドメインってありますか？ 一緒にDNSの設定も教えていただけたら助かります。 よろしくお願いします。
CREATE TABLE media ( id INT DEFAULT 0 primary key, media_name VARCHAR DEFAULT '', others text DEFAULT '', regis_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP, update_date TIMESTAMP ); をMySQL 5.0.77で実行したところ ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' regis_date TIMESTAMP, update_date )' at line 3 のエラーが出てきてしまいます しかしMySQLを使い始めたばかりで今一理解が出来ず また、 text DEFAULT '' を使った他のテーブルは作成できています どこがおかしいのか教えていただけませんでしょうか、お願いします
MySQL5.5.9(RHEL)なのですが、以下のSQL文の間違いがわかりません。 どなたかオシエテいただけませんでしょうか？ SQL ================= CREATE TABLE IF NOT EXISTS `seo` ( `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT, `parentid` bigint(20) unsigned NOT NULL, seq decimal(10,5) unsigned NOT NULL, `urlpath` varchar(64) CHARACTER SET utf8 NOT NULL, `breadcrumbs` varchar(64) CHARACTER SET utf8 NOT NULL, `h1_title` varchar(64) CHARACTER SET utf8 NOT NULL, `keyword1` varchar(128) CHARACTER SET utf8 NOT NULL, `keyword2` varchar(128) CHARACTER SET utf8 NOT NULL, `keyword3` varchar(128) CHARACTER SET utf8 NOT NULL, `description` varchar(128) CHARACTER SET utf8 NOT NULL, `updatetime` datetime NULL, `en_urlpath` varchar(64) CHARACTER SET utf8 NOT NULL, `en_breadcrumbs` varchar(64) CHARACTER SET utf8 NOT NULL, `en_h1_title` varchar(64) CHARACTER SET utf8 NOT NULL, `en_keyword1` varchar(128) CHARACTER SET utf8 NOT NULL, `en_keyword2` varchar(128) CHARACTER SET utf8 NOT NULL, `en_keyword3` varchar(128) CHARACTER SET utf8 NOT NULL, `en_description` varchar(128) CHARACTER SET utf8 NOT NULL, `en_updatetime` datetime NULL, `multi_version` init(10) unsigned NOT NULL, `multi_flag` smallint(6) NOT NULL DEFAULT '1', `multi_memo` text CHARACTER SET utf8, UNIQUE KEY `id` (`id`), UNIQUE KEY `urlpath` (`urlpath`), UNIQUE KEY `h1_title` (`h1_title`), UNIQUE KEY `keywords` (`keyword1`,`keyword2`,`keyword3`) UNIQUE KEY `description` (`description`) UNIQUE KEY `en_urlpath` (`en_urlpath`), UNIQUE KEY `en_h1_title` (`en_h1_title`), UNIQUE KEY `en_keywords` (`en_keyword1`,`en_keyword2`,`en_keyword3`) UNIQUE KEY `description` (`en_description`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ; ======================================== エラーメッセージ(phpmyadmin) #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'init(10) unsigned NOT NULL, `multi_flag` smallint(6) NOT NULL DEFAULT '1', ' at line 23 ＝＝＝＝＝ よろしくお願いします。
SELECTで関数を使うことで、ある程度の計算や変換が出来るようなのですが、 ・６２進数→１０進数への変換 ・アルファベット大/小文字の相互変換（大/小文字を逆にする） はSQLだけで処理が出来ますか？ MySQLのバージョンは問いません。
イベント情報をキーワード検索できるページを制作しており、下記テーブルからデータを取得したいのですが、日付関係の条件指定の方法が分かりません。 下記のような条件で取得したい場合どのようにすればよいでしょうか？（キーワード検索の部分はわかります） テーブル event 　date_s：開始日（Ymd形式の8桁 もしくは md形式の4桁） 　date_s_year：開始日の年（Y形式の4桁 もしくは NULL値） 　date_s_month：開始日の月（m形式の2桁） 　date_s_day：開始日の日（d形式の2桁） 　date_e：終了日（Ymd形式の8桁 もしくは md形式の4桁 もしくは NULL値） 　date_e_year：終了日の年（Y形式の4桁 もしくは NULL値） 　date_e_month：終了日の月（m形式の2桁 もしくは NULL値） 　date_e_day：終了日の日（d形式の2桁 もしくは NULL値） 　※複数日に渡って行われるイベントには終了日が入っていて、単日のイベントの終了日はNULL値です。 　※その年だけに行われる単発のイベントには年と月と日がすべて入っています。毎年決まった日に行われるイベントには月と日のみが入っており、年はNULL値です。 ・検索対象は今日から1年先までのデータ ・開催中（開始日が本日以前で終了日が本日以降）のイベント → 開始日が今日に近いイベントという順番で並べたい。 MySQL：5.1.22-rc PHP：5.2.5 説明が分かりにくいかもしれませんが、アドバイスをいただければ幸いです。
MYSQLにて（PHPMYADMIN上でテスト） ●レコード挿入（追加・新規作成）時は、 「Pt_create」と「Pt_update」の2つのフィールドに自動で現在時刻を作成 ●レコード編集時は 「Pt_update」のみ自動で現在時刻を上書き というありがちで申し訳ないですが、実行したいです。 現在調べたところ、 一番スマートでない方法は、 ******************************* Pt_createのほうに、種別：DATETIME Pt_updateのほうに、種別：DATETIME PHP側にて、$today = date("Y-m-d H:i:s");を取得して、 新規作成時・・・ $sql = INSERT INTO (`Pt_create`,`Pt_update`) VALUES ('".$today."','".$today."')・・ 編集時・・・ $sql = UPDATE SET Pt_update= '".$today."'・・ ******************************* ですよね？ できたらSQLのほうで自動でやれるだけやってほしいのですが、 今は、 ******************************* Pt_createのほうに、種別：DATETIME Pt_updateのほうに、種別：TIMESTAMP、属性：on update CURRENT_TIMESTAMP PHP側にて、$today = date("Y-m-d H:i:s");を取得して、 新規作成時・・・ $sql = INSERT INTO (`Pt_create`) VALUES ('".$today."')・・ ******************************* ここまで省略できました。 これが限界でしょうか。 種別：TIMESTAMPを2つ設置したらうまく動作しなかったもので。
mysqlで特定のクエリーが遅いのですが、どのようにしたら改善されるでしょうか。 問題のクエリは下記になります。 mysql_query("select i.id AS id,i.name AS iname,i.price AS iprice,v.id AS vid,v.vote AS vvote,SUM(IF(v.vote='10',1,0)) AS totalvote from item AS i LEFT JOIN vote AS v ON i.id=v.id GROUP BY i.id order by totalvote desc;",$conn); 「itemテーブルのid」と「voteテーブルのid」と「voteテーブルのvote」にはindexを作成しています。 ウェブサイトから商品に対して投票できるようにしています。 投票は1（最低点）から10（最高点）までになっています。 最高点のみの投票数を合計して、その合計投票数が大きい順に商品をソートできるようにしています。 SUM(IF(v.vote='10',1,0)) AS totalvote がいけないのかなと思っているのですが、他にどのようなクエリの書き方があるでしょうか。 どなたかアドバイス頂けると幸いです。よろしくお願い致します。
かなりの初心者です。 xamppを使っています。 phpmyadminをクリックすると 「エラーが出たためセッションを開始できませんでした。PHP やウェブサーバのログファイルに出ているエラーを確認して、PHP を正しく設定してください。」と表示されて、どうすればいいのか分かりません。 さっきまで、開いていました。 開いていたときに 画面下のほうに、「コントロールユーザーが接続されてません」などエラーも出てました。 そこでconfig.inc.phpをエディタで開いて、見てたんですが。。さっぱり。。 /* Authentication type and info */ $cfg['Servers'][$i]['auth_type'] = 'cookie'; // Authentication method (config, http or cookie based) $cfg['Servers'][$i]['host'] = 'localhost'; $cfg['Servers'][$i]['connect_type'] = 'tcp'; $cfg['Servers'][$i]['compress'] = false; $cfg['Servers'][$i]['user'] = 'root'; $cfg['Servers'][$i]['password'] = 'パスワードかいてます。'; $cfg['Servers'][$i]['extension'] = 'mysql'; $cfg['Servers'][$i]['AllowNoPassword'] = true; /* User for advanced features */ $cfg['Servers'][$i]['controluser'] = 'pma'; $cfg['Servers'][$i]['controlpass'] = ''; /* Advanced phpMyAdmin features */ $cfg['Servers'][$i]['pmadb'] = 'phpmyadmin'; $cfg['Servers'][$i]['bookmarktable'] = 'pma_bookmark'; $cfg['Servers'][$i]['relation'] = 'pma_relation'; $cfg['Servers'][$i]['table_info'] = 'pma_table_info'; $cfg['Servers'][$i]['table_coords'] = 'pma_table_coords'; $cfg['Servers'][$i]['pdf_pages'] = 'pma_pdf_pages'; $cfg['Servers'][$i]['column_info'] = 'pma_column_info'; $cfg['Servers'][$i]['history'] = 'pma_history'; $cfg['Servers'][$i]['designer_coords'] = 'pma_designer_coords'; このどこかを変えるんでしょうか。。。
MySQLで新規データベース作成時、エラーが表示されてしまいます。 初歩的な質問になりますが、MySQLをセットアップしたのち、新規にデータベースを作成 するところでつまずいています。 新規作成する際、エラーが表示されてしまい、新規にデータベースを作成することができま せん。 どのようにすればよいのかわからずに困っております。どのようにすればよいかご存知の 方がいらっしゃいましたら教えてください。 なお、操作手順と使用環境は下記になります。 ■操作手順 MySQL Command Line Client からでも、コマンドプロンプトでも同じ結果になるのですが、 まずrootでログインします。 インストール時にパスワードを付けてないので、パスワードなしでログインしてます。 その後、>show databases; を打ち込みますと、既存のデータベース（インストール時のサ ンプル）が表示されます。もちろん、その中のテーブルも見れます。 この状態で「 samplebd 」という名称のdbを新規に作成しようとして、 >create database sampledb; としますと、下記のようなエラーが表示されてしまいます。 ■エラーメッセージ ERROR 1044 (42000): Access denied for user ''@'localhost' to database 'samplebd' ■環境 Windowsserver2008 Apach，PHP，MySQL を構築してあります。 クライアントPC（Win7）からリモートデスクトップでアクセスしたり、直接サーバで操作を 行ったりもしますが、現象は変わらずエラーがでます。 よろしくお願いいたします。
データの件数を集計して、その結果からもっとも件数が多いものだけを抽出する SQL について教えてください。 例えば以下のようなテーブルがあります。 ▼テーブル 名前 |交通手段|日付 -----+--------+---- Aさん|バス |5/1 Aさん|バス |5/2 Aさん|バス |5/3 Bさん|バス |5/1 Bさん|電車 |5/2 ※「日付」については、本質問に直接の関係はありません。 このテーブルにクエリを発行して、以下の結果を取得したいと考えています。 ▼取得したい結果 (ある交通手段をもっとも使った人を抽出) 名前 |交通手段|回数 -----+--------+---- Aさん|バス |3 Bさん|電車 |1 ※回数が同数の人がいる場合は、「ユーザID」が一番若い人を採用します。 　「ユーザID」はこのテーブル例には含まれておりませんが、 　「名前」が「ユーザID」であると読み替えてください。 なお、以下の結果を取得するクエリは 質問番号:6719239 にご協力いただけたおかげで解決しました。 SELECT 名前, 交通手段, COUNT(*) AS 回数 FROM テーブル GROUP BY 名前, 交通手段; 　↓ 名前 |交通手段|回数 -----+--------+---- Aさん|バス |3 Bさん|バス |1 Bさん|電車 |1 今回、この結果から 1件目 と 3件目 を抜き出したいと考えております。 プログラム側で対処はできるのですが、SQL の方がスマートに書けそうだと思っております。 なおレンタルサーバ上 (MySQL 5.0.77) で稼働させるため、 なるべく高速な SQL を希望いたします。
データの件数を集計するための SQL について教えてください。 例えば以下のようなテーブルがあります。 ▼テーブル 名前 |交通手段|日付 -----+--------+---- Aさん|バス |5/1 Aさん|バス |5/2 Aさん|バス |5/3 Bさん|バス |5/1 Bさん|電車 |5/2 ※「日付」については、本質問に直接の関係はありません。 このテーブルにクエリを発行して、以下の結果を取得したいと考えています。 ▼取得したい結果 名前 |交通手段|回数 -----+--------+---- Aさん|バス |3 Bさん|バス |1 Bさん|電車 |1 当方がイメージしている流れは以下の通りです。 SQL は苦手でして、これをひとつにまとめることができません。 1) GROUP BY で束ねる SELECT 名前, 交通手段 FROM テーブル GROUP BY 名前, 交通手段 2) 1)の結果の1件目をSELECTする SELECT COUNT(*) FROM テーブル WHERE 名前='Aさん' AND 交通手段='バス' 3) 1)の結果の2件目をSELECTする SELECT COUNT(*) FROM テーブル WHERE 名前='Bさん' AND 交通手段='バス' 4) 1)の結果の3件目をSELECTする SELECT COUNT(*) FROM テーブル WHERE 名前='Bさん' AND 交通手段='電車' なおレンタルサーバ上 (MySQL 5.0.77) で稼働させるため、 なるべく高速な SQL を希望いたします。
　はじめまして。ゴールデンウィークの中、お忙しい所、どなたかご存知の方がいたら、教えてください。 　質問内容は、プログラミング言語のPHPとデータベースのMySQLに関してです。 　XAMPPというソフトをインストールして、「XAMPP Control Panel」をクリックし、その中の「Apache」と「MySQL」をStartさせ「Running」と緑色の状態にしました。 　 その後、http://localhost/xampp　のページにアクセスしたところ、「おめでとうございます: システム上にXAMPPが正しくインストールされました！」とxamppの画面がうまく表示されます。 　しかし、「PhpMyAdmin」をクリックすると、以下のようなエラー画面が出てしまいます。 MySQLのメッセージ: #1045 - Access denied for user 'root'@'localhost' (using password: NO) MySQL サーバに接続しようとしましたが拒否されました。config.inc.php のホスト、ユーザ名、パスワードが MySQL サーバの管理者から与えられた情報と一致するか確認してください 何をどうしたらいいのでしょうか？config.inc.phpというファイルに問題があるのでしょうか？どなたかご存知の方がいたら教えてください。よろしくお願いします。
http://www.yc.tcu.ac.jp/~yamada/doc/mysql/win/06 … のサイトを参考に以下のような「データベースの内容を表示させる」プログラムを書いたのですが、うまく表示されません。（webブラウザで確認したところまっさらなページで何も表示されません） ちなみに、私はレンタルサーバを借りており、その中で作成したデータベースにphpMyAdminにてテーブルやカラムの作成を行いました。以下のプログラムは「db_sample.php」という名前で保存（エンコード：utf-8）し、レンタルサーバーの公開しているフォルダ「httpdocs」にffftpにてアップロードしています。バージョンは、phpMyAdmin2.11.11.3と、php4.1?(最新の5.2よりひとつ前のもの) ここでは仮に ホスト名：aaa.com （←これは独自に作成したドメイン名でいいのかな？） ユーザー名：user パスワード：pass データベース名：db テーブル名：person とします。 ----------以下プログラム------------ <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitio … <html xmlns="http://www.w3.org/1999/xhtml"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <meta http-equiv="Content-Style-Type" content="text/css"> <meta http-equiv="Content-Script-Type" content="text/javascript" /> <title></title> </head> <body> <?php //データベースサーバ名の設定 $db_host = "aaa.com"; //ユーザ名の設定 $db_user = "user"; //パスワードの設定 $db_passwd = "pass"; //データベースサーバへの接続 $db = mysql_connect($db_host,$db_user,$db_passwd); //データベース名の設定 $db_name = "db"; //データベースの選択 mysql_select_db($db_name,$db); //SQL文の設定 $str_sql = "select * from person"; //SQL文の実行 $rs = mysql_query($str_sql,$db); //結果セット内の各レコードを順次参照し、連想配列に代入 while($arr_item = mysql_fetch_assoc($rs)) { //レコード内の各フィールド名と値を順次参照 foreach($arr_item as $key => $value) { //フィールド名と値を表示 print "[{$key}] = {$value}<br>\n"; } print "<br>\n"; } //データベースサーバへの接続の切断 mysql_close($db); ?> </body> </html> ------------------------------------------ わかる方いらっしゃいましたらご教授願います。
プロフィールサイトの作り方 類似質問がなかったので質問させて頂きます。 プロフィールサイト（前略プロフィール）のようなものを作ろうと思っているのですが、PHPやMYSQLは初心者です。 そこでフリーのプログラムや似たプログラムを作成している方がいないか探したのですが、全く見つからなかったのでご存じの方がいましたら是非、教えて下さい。 またCMSでもあるか教えて下さい。 ほしい機能としては、 ・携帯に対応している ・管理者画面からプロフィールの編集ができる ・画像を1枚でも表示できる。 前略や無料のプロフサイトで代用することは考えていません。 WEB知識もそこまでなく的外れなことを言っているかもしれませんが、よろしくお願いします。
Coreserver mini (PHP5.2.5 MySQL5.1.22)でMySQLへの書き込みプログラムをPHPで作ったのですが、書きこまれたデータを見てみると見事に文字化けしています・・・。 調べてみると、いろんな方がこの症状に悩まされているようでして、解決方法は乗っているのですが、何れも自作サーバーでの解決策等でして、phpMyAdmin(ブラウザ上)での解決方法がわかりません・・・。　文字化けを解決するにはコマンドからやる他ないのでしょうか？ (当方の環境はMacOSXです) この手の質問に慣れていないので必要な情報があれば追記します。 よろしくお願いします。
下記の場合で検索時にtagがaかつbを持つnoを返したい場合どのようなSQLを記述すれば良いのでしょうか。この場合だと１と３が返ってくるようにしたいです。 ----------- no | tag ----------- １ | a １ | b １ | c ２ | b ２ | c ３ | a ３ | b -----------
MYSQLでタイ語の登録をする場合utf-8のどれに文字コードを設定すればいいのでしょうか。
いつもお世話になっております。 xamppをインストールし、開発を行っております。 formでsubmitし、DBに登録すると文字化けを起こします。 MySQLは下記項目を追加しました。 C:\xampp\mysql\bin\my.ini -------------------------------------------------- [client] default-character-set = utf8 [mysqld] skip-character-set-client-handshake character_set_server=utf8 init-connect=SET NAMES utf8 （ここに default-character-set = utf8 を追加するとMySQLが起動しなくなります。） [mysqldump] default-character-set = utf8 [mysql] default-character-set = utf8 php.iniは下記のように設定してあります。 php.ini -------------------------------------------------- mbstring.detect_orderauto mbstring.encoding_translationOff mbstring.func_overload0 mbstring.http_inputUTF-8 mbstring.http_outputUTF-8 mbstring.http_output_conv_mimetypes^(text/|application/xhtml\+xml) mbstring.internal_encodingUTF-8 mbstring.languageJapanese mbstring.strict_detectionOff mbstring.substitute_characterno value 日本語が正しく登録されていれば、表示は正しくされます。 おかしな部分、足りない部分等ありましたら、ご教示ください。 よろしくお願いいたします。 ［環境］ 　MySQL：5.5.8 　PHP：5.3.5 　xampp：1.7.4
ごく最近PHPとmysqlを勉強しだした初心者です。 PHPでDBの検索フォームを作ろうとしているのですが、どうしてもわからないので質問させていただきました。 検索フォームに電話番号を入れると、該当する人の情報を表示させるようにしたいと思ってます。 私の持っている本では、SQLの検索を行うにはSELECT句を使い 　　SELECT フィールド名 FROM テーブル名 WHERE 条件文； という風にあって、条件文がid=1とかの定数で指定したものしかありません。 検索フォームに入力された数値（$_POSTの値）を条件文にいれて、検索フォームで入力された電話番号を検索するようにできますか？ もしできないなら、どのような形で作ればよいでしょうか？ 贅沢ですが、できれば簡単に解説もしていただけると非常に助かります。 ご教授の程、何卒よろしくお願い致します。
マスターテーブル1つと、子テーブルが複数存在して子テーブルにはマスターテーブルのidを格納するフィールドがあり参照しなくなったときにはそのidを消去するといったデータベースがあったときにマスターIDごとに子テーブルのどれか1つでも参照していればカウントするみたいなSQLをつくりたいんですが select count(m.id) from master m inner join a on m.id = a.m_id inner join b on m.id = b.m_id inner join c on m.id = c.m_id group by m.id みたいなSQLだとAにデータが存在しなければB以降に存在しても期待した結果が出力されません。A、B、Cいずれかのm_idとマスター側のIDが等しければカウントするという出力をするためにはどのように書けばいいんでしょうか。 わかりづらい説明で申し訳ありませんがよろしくお願いします。
MySQLサーバのバージョン: 5.1.41 を使ってます。 ・やりたいこと テーブル名：test id | photo | 1 /aaa/aa.jpg 2 /bbb/bb.jpg : : となっているテーブルに対して　フィールド名「photo」に格納されている文字列の先頭に 「　http://www.test.com 」　を全てのレコードに対して追加したいと考えております。 希望する結果 テーブル名：test id | photo | 1 http://www.test.com/aaa/aa.jpg 2 http://www.test.com/bbb/bb.jpg : : 説明不足などございましたら、再度補足させていただきます。 アドバイスのほどよろしくお願い致します。
教えてください。 id(主)｜u_id｜date｜field1｜field2｜ と言うフィールドを持つテーブル[tbl_1]があります。 ポストするデータのu_idとdateがテーブルのレコードと一致する場合、 field1及びfield2のデータを置換　若しくは、挿入し、 u_idとdateが一致しない場合、新しいレコードを挿入したいと 思うのですが、これをひとつの命令文として行うことはできるでしょうか。 以下、試してみたことです。 replace into tbl_1(field1,field2) value(1111,2222) where u_id='1' and date='20110420' 上記では、シンタックスエラーが返ってきました。 次に、 replace into tbl_1(u_id,date,field1,field2) value(1,20110420,1111,2222) としたところ、u_idとdateが一致するレコードがあっても、 新規レコードとして挿入されました。 1回の命令文で処理を行いたいと思うのですが、 やはり、処理は分けた方が良いのでしょうか。 ご回答よろしくお願いいたします。
はじめまして、初心者ですのため説明不足がありましたら申し訳ございせん。。 ■質問内容 MySQLを使ってます。 新規テーブルを作ったあと、以下のような事をしたいのですが、 そのSQL文を教えていただけないでしょうか？ テーブル名：test フィールド id | name という新規テーブルがあった際 フィールド id | name 1 2 3 : : 100 のように、　フィールドIDだけに対して指定した100番まで番号を振りたいのですが、 そのSQL文を教えていただけないでしょうか？ よろしくお願い致します。
vb.net＋mysql（OS:WindowsXP）で趣味のコーディングをしています。 動かしているのは、毎日２０時間程度かけて実行しているバッチ処理です。 各テーブルに、最大で数百万～１千数百万レコード程度を格納しています。 最近、プログラム内で、mysqlが何の例外も吐かずに止まってしまう（もしくは落ちている？）という現象が多発しています。 現象が起きるSQL文は毎日違い、同じSQLでも、値が返ってくる日と返って来ない日があります。 mysqlの全体的なチューニングが必要なのだろうと思っているのですが、 とりあえずmysqlの各種パラメータの監視をする必要があるのだろうなと思っています。 何か典型的な手法などはあるでしょうか。 （show status で返ってくる値を監視しときゃいいんだよ、とどこかで見た気がするのですが、 　それってみんな自分でイチから監視プログラムをハンド作成しているのでしょうか？） よろしくお願いします。
Mysqlで登録された日付の10日後以降全てを取得したいです。 SELECT * FROM table1 WHERE clum1 ・・・ 続きを教えてください。
xamppでインストールしたphpadminが起動しません。win　XPにインストールしました。 エラーメッセージは，次のようなものです。 <<<エラー MySQLのメッセージ: #2002 - サーバが応答しません (あるいはローカルの MySQL サーバのソケットが正しく設定されていません) 設定ファイルに定義されている管理ユーザ(controluser)での接続に失敗しました>>> phpadminフォルダ内の，「config.inc.php」を見ると， $cfg['Servers'][$i]['controluser'] = 'pma';　　と設定されており，pmaというcontroluserが設定されているようです。このcontroluserでの接続に成功するにはどうすれば良いのでしょうか？ または，サーバーのソケットなるものが無いのでしょうか？ xamppコントロールパネルを見ると，apacheもMYSQLもrunningになっています。 どうかよろしくお願いいたします。
movabletypeでＥＣサイトやビジネスサイトを制作しようとしている初心者です。 Wordpressである程度ＣＭＳについて学んでいたのですが、全く分からないところが 出てきてしまい質問させていただきます。 最初にＭｏｖａｂｌｅｔｙｐｅ5を入れてデザインのスタイル変更を行っておりまして、 適用、再構築とやると反映されると思うのですが、 再構築エラー: テンプレート「ブログ記事」の再構築中にエラーが発生しました: &lt;mtInclude&gt;タグでエラーがありました: error in module ヘッダー: テンプレート「ヘッダー」の再構築中にエラーが発生しました: 不明なタグです: BlogParentWebsite のように出てしまいます。これはどういう問題なのでしょうか。 また、ＭＴ４を入れてブログを創って試して見たのですが、 保存とやると 再構築エラー: テンプレート「ブログ記事」の再構築中にエラーが発生しました: &lt;mtInclude&gt;タグでエラーがありました: error in module ヘッダー: テンプレート「ヘッダー」の再構築中にエラーが発生しました: 不明なタグです: BlogParentWebsite 確認とやると 日付アーカイブ「Monthly20110401000000」の再構築中にエラーが発生しました: テンプレート「ブログ記事リスト」の再構築中にエラーが発生しました: &lt;mtInclude&gt;タグでエラーがありました: error in module ヘッダー: テンプレート「ヘッダー」の再構築中にエラーが発生しました: 不明なタグです: BlogParentWebsite と出てしまいます。 (1)不明なタグというのは消去してしまって宜しいのでしょうか？ (2)インストールを再度したのですが、【最初のウェブサイト制作】という画面に行かず、ユーザーＩＤとパスワードを求められる画面になります。 その際元のやつを入れるとエラーが出るものの中に入るので、一から消してやりたい場合は どのように消せば良いのでしょうか？ ※ＦＴＰのところでフォルダを削除はしてますが、データベースの中に残っている？みたいです。 【参考資料】 movable type 5 実践テクニック
MYSQL5.5でCONCAT以外で文字列連結できるでしょうか？ 調べてみると他のDBは「||」が使えるみたいですが、mysqlは使えません。 何かCONCAT以外で代替きかないかなと思い質問させて頂きました。 よろしくお願いします。
SHOW COLUMNSで特定テーブルのカラム名などを取得しています。 テーブルとビューとを区別したいのですが、区別情報を取得するにはどうしたらいいのでしょうか。
MySQLのＳＱＬ文です。 TblAのID、Nmがあり、TblBにID、Adrsがあるとします。 次の２つのＳＱＬ文の結果は同じになります。 そもそもこの２つの書き方には何か違う意味があるのでしょうか。 CREATE View TblC1 as SELECT TblA.ID, TblA.Nm, TblB.Adrs FROM TblA INNER JOIN TblB ON TblA.ID = TblB.ID; CREATE View TblC2 as SELECT TblA.ID, TblA.Nm, TblB.Adrs FROM TblA ,TblB where TblA.ID = TblB.ID; また、TblAにはありTblBには含まれないレコードを出すときは CREATE View TblC3 as SELECT TblA.ID, TblA.Nm, TblB.Adrs FROM TblA LEFT JOIN TblB ON TblA.ID = TblB.ID; 逆にTblBにありTblAには含まれないレコードを出すときは CREATE View TblC4 as SELECT TblA.ID, TblA.Nm, TblB.Adrs FROM TblA RIGHT JOIN TblB ON TblA.ID = TblB.ID; としています。 これをwhereを使った書き方ではできないのでしょうか。
データベース名をsampleとしますとバックアップのコマンドは mysqldump --password='xxxxx' sample > backup.sql となるのですが、このデーターベースの特定のテーブルを除いたものをバックアップしたいのですが どうすればいいのでしょうか？ 以下のようにテーブルを個別に指定してひとつひとつコマンドを発行するしかないのでしょうか？ mysqldump --password='xxxxx' sample tableA > tableA.sql mysqldump --password='xxxxx' sample tableB > tableB.sql mysqldump --password='xxxxx' sample tableC > tableC.sql よろしくお願いします。
このたび自宅のPCにWAMPserverというアプリケーションでApache,MySQL,PHPを導入しました。 そのうち、MySQLでroot以外でのユーザでのログイン方法がわかりません。解説本を参考に GRANT ALL PRIVILEGES ON *** TO ***@*** IDENTIFIED BY '***'; にて新ユーザを追加することはできたのですが、MySQLを開くとすぐに　ENTER PASSWORDを要求されてしまい、別ユーザでのログインがうまくできません。 初歩的な質問で申し訳ありませんが、ご回答いただけると助かります。よろしくお願いします。
MYSQLについてお教えください。 THIS_TABLE_AとTHIS_TABLE_Bの２つのテーブルがあります。 THIS_TABLE_Aのフィールドには、CODEがあります。 THIS_TABLE_Bのフィールドにも、CODEがあります。 THIS_TABLE_AのCODEは5桁で表示されています。 例）ABCED,AKDIL,IETKL THIS_TABLE_BのCODEは8桁で表示されています。 例）000ABCED,000AKDIL,000IETKL THIS_TABLE_BはTHIS_TABLE_Aとほぼ同じですが、ゼロが頭に3つ ついています。 THIS_TABLE_AとTHIS_TABLE_Bを結合させたいのですが、1回で 結合させる方法はあるでしょうか？ テンポラリーのテーブルをつくって、そこでTHIS_TABLE_AのCODEの値を lpad関数をもちい、8桁にしたのち、テンポラリーテーブルと THIS_TABLE_Bと結合させればできるのはわかりますが、 1回でできるのかなと思い質問させて頂きました。 よろしくお願いします。
EXCELについての質問です。列に名前が入っています。A列 B列が同じ名前で並ぶようにしたいのです。ただAとB全てが同じ名前じやなく違う人の名前もはいっています。いい方法ありませんか？
mySQL server 5.1　でのindex作成について質問です かなり大きいデータ数(1000億)のテーブルを扱う必要があり検索速度向上のためにindexを作成しようとしています。テーブルのdouble型のカラムに対してインデックス作成コマンドを入力しましたが（create index）、数日経ってもまだインデックス作成が終わりません。長すぎて何か問題でも起きているのでは、と思ってのですが同様の形式のサイズの小さいデータベースに対して同様の処理を行うと問題なく終わります。 なんらかの方法でインデックス作成のスピードを上げることは可能でしょうか？たとえばint型のデータ型に変換するとスピードが向上するなどはあるでしょうか？
MYSQLのUPDATEについて こんにちは。MYSQLを最近勉強しはじめました。従来はACCESS2003を使っています。 全く同じテーブルをMYSQL側とACCESS側で用意しました。 あるフィールドに対し、UPDATE文をかけたら、MYSQLとACCESSではアップデートされた数に差がありました。 データ型も全て同じなのに、なぜ差がうまれるのか考えました。 例えば、「数量」という列にアップデートをかけるとします。 アップデート前のある行の数量が「０」とします。 アップデートしたい数量も「０」とします。 Accessはアップデート前、アップデート後、同じ数量でアップデートする場合もカウントする。 MYSQLはアップデート前とアップデート後の数量が同じであれば、アップデートしない。 と考えましたが、この考えは正しいでしょうか？
データベースの定義を取得するＳＱＬ文を教えてください。 データベースはAccessとMySQLです。 得たい情報はデータベースにあるテーブルとカラムです。 例えば、テーブルがTblAとTblBがあって、 それぞれに整数型のFld1と文字型のFlb2があるとします。 この定義情報を取得したいのです。 テーブルだけでなくクエリ（ビュー）の定義情報も取得できるでしょうか。
よろしくお願いいたします。 商品のデータベースサイトを運営しております。 発売日ごとに商品を並ばせているページがあります。 過去に発売したもの、発売日が決定しているものについては、 date型に日付を入れてDBに登録しているのですが、 発売日が若干曖昧なもの、（2011年夏、や2011年4月下旬など）の商品も今後登録し、 可能ならば意味合い的に並ばせればいいなあと思っています。 こういうことは、mysqlかphpをどういじれば実現できるのでしょうか？ 下記に具体的なイメージを載せます。 もしお分かりになる方がいらっしゃいましたら、よろしくお願いいたします。 テーブル title , hatsubai セブン , 2010-7-30 タイタニック , 2005-2-5 パイレーツ , 2011年4月下旬 ファイトクラブ , 2008-3-14 トロイ , 2011-9-8 ナルニア , 2011年冬 吐き出したい並び（上と一緒） タイタニック , 2005-2-5 ファイトクラブ , 2008-3-14 セブン , 2010-7-30 トロイ , 2011-9-8 パイレーツ , 2011年4月下旬 ナルニア , 2011年冬 ※自分が作っているテーブルはもうちょっと複雑なので、 新しいカラムを追加してそこにidをつけて並ばせる、というのではなく、あくまで日付で並ばせたいです。 いま吐き出しているphpは、 while ($row = mysql_fetch_array で出しています。 曖昧な表現や、ここがわからない、などあればご指摘ください。 よろしくお願いいたします。
プログラミング経験がほとんどないのですが、最近mysqlに携わり、検索時のSQL文の記述方法で分からないことがあるので誰か教えてください。 【説明】 地域テーブル、県テーブル、町テーブル、住所テーブル、存在管理テーブルの合計５つのテーブルが存在します。 地域テーブルには地域名と地域コードのカラムがあります。 県テーブルには県名と県コードのカラムがあります。 町テーブルには町テーブルと町コードのカラムがあります。 住所テーブルには地域コード、県コード、町コードと建物の名前のカラムがあります。 存在管理テーブルには、削除フラグというカラムがあります。 ここで削除フラグは、存在しない住所になると削除フラグに１を設定し、検索時には削除フラグに１が立っているものは検索できないようにするためのものです。普段は削除フラグは０になるように設定しています。 地域と県名と町名はプルダウンで選択できるようになっています。 【質問内容】 地域のプルダウンにある「関西」を選択すると選択された地域に該当する県名や町名、建物名が検索される。 また県名、町名についても同様に検索される。 地域、県名に「関西」「大阪」選択すると「関西」「大阪」に該当する町名、建物名が検索される。 さらに建物の名前の前方一致検索もできる。 ちなみにこれを１文で書きたいです。 以上のSQL文はどのようになるでしょうか。 mysqlのバージョンは４．０です。 どなたかお教えください。
MySQLで開発をしています。 １回のSQLで、下記テーブルの内容を日付・ユーザ番号毎（日付・ユーザ番号が同じ時に同じレコード）に、 型番1個数、 型番2個数、 その他が2か3で型番2・品番1個数、 その他が2か3で型番2・品番1個数、 その他が2か3で型番2・品番1での売上小計、 その他が2か3で型番2・品番2個数での売上小計、 売上合計、 以上の各カラムを持つテーブルに再編して返したいのですが、 効率の良いやり方がわかりません。 どなたかよろしくお願いします。 テーブル ユーザ番号　日付　　　型番　　品番　　　売上　　その他 －－－－－　－－－　－－－　－－－　－－－　－－－ 　001　　　　　3/10　　　　1　　　　2　　　　　500　　　　1 　001　　　　　3/10　　　　2　　　　1　　　　　　0　　　　1 　003　　　　　3/11　　　　2　　　　1　　　　　100　　　　2 　004　　　　　3/12　　　　1　　　　1　　　　　100　　　　2 　005　　　　　3/12　　　　2　　　　2　　　　　　0　　　　　2 　001　　　　　3/13　　　　1　　　　2　　　　　500　　　　1 　003　　　　　3/13　　　　2　　　　1　　　　　100　　　　2 　003　　　　　3/13　　　　2　　　　1　　 　　　0　　　　　3 　002　　　　　3/14　　　　1　　　　1　　　　　100　　　　3 　005　　　　　3/15　　　　2　　　　2　　　　　0　　　　　　1
date型のカラムに”2010-04-02"のようにレコードが登録されています。 月だけで検索する方法がわかりません。 上記でいえば、04を条件としたいです。 よろしくお願いします。 環境は、MySQL　4.1.22です。
MySQLの学習を始めたばかりです。 あるselectで抽出された結果の前に、１行２列で、その日時を 出力したいと思い select '出力日時：',now(); としましたが、 出力日時： now() 出力日時：　　xxxx-xx-xx xx:xx となります。 select now() は now() xxxx-xx-xx xx:xx とという結果だからそうなるのもうなずけますが、 ではどうしたら 出力日時：　　xxxx-xx-xx xx:xx の一行だけの結果になりますか？ 教えてください。
ＤＢの入れ替え（4.0->5.x）をやろうと思っています。 で、現在、文字コードSJISで使用しているＤＢがあるのですが、 これを次のＤＢでＵＴＦ８に変更する方法はあるのでしょうか？ （sql_dumpで抜いて、そのまま新しいＤＢに投入しようと思っています。このときに文字コード変換が出来れば幸いなのですが。。） よろしくお願いします。
MySQLv5.1＋InnoDBエンジンのDBで質問です。 テーブルの最終更新日時とかを取得して、一定時間更新の無いテーブルを 見つける仕組みを作ろうと考えています。 （OracleだとUSER_TABLESなどのLAST_DDL_TIMEを見たい） 既に、「SHOW TABLE STATUS で出てくる、Update_time の項目を見る」 は試してみたんですがNULLになっていて見られないです・・ （InnoDBはUpdate_timeに非対応？） 代替の方法など、もしあれば教えてください。 よろしくお願いします。
宜しくお願いします xamppとレンタルサーバーを両方使用していましたが、 xamppの方がエラー検出機能などがあって、分かりやすいので、 主な部分はTerapadを使って、xamppでチェックした後、ＦＴＰでサーバーにアップしていました。 しかし、ＭｙＳＱＬの問題が生じました。 xamppは、ユーザー名root　パワスードなし レンタルサーバーの方は、　ユーザー名user パスワードpass（値は適当です） にしています。 xamppから、レンタルサーバーのＭｙＳQLに接続しようとしたら、 Can't connect to MySQL server on '172.16.10.189' (10060) in C:\xampp\htdocs\private\sql_info.php on line 9 というエラーが出ました。 xamppのエラー検出は非常に便利で使いたいのですが（Eclipcseは余計に難しくなりました） 、xamppからでもレンタルサーバーのMysqlに接続できる方法か、 もしくは、エラー検出やコード補完（デバッガー）というのでしょうか、 そういうものがありました教えて頂きたいです。 宜しくお願い致します。
例えば以下のテーブルがあったとします。 [makerTbl] | makerKey | maker | | 1 | トヨタ | | 2 | 日産 | | 3 | マツダ | | 4 | 本田 | [carsTbl] | carKey | carName | | 1 | アルファード | | 2 | ヴェルファイア | | 3 | ヴォクシー | | 4 | エスティマ | | 5 | フェアレディZ | | 6 | スカイライン | | 7 | デミオ | | 8 | NSX | [carsMakerTbl] | key | makerKey | carKey | | 1 | 2 | 6 | | 2 | 4 | 8 | | 3 | 1 | 2 | | 4 | 1 | 1 | | 5 | 3 | 7 | | 6 | 1 | 4 | | 7 | 2 | 5 | | 8 | 1 | 3 | 上記のような自動車メーカー（makerTbl）とラインナップ（carsTbl）、それを関連付けるテーブル(carsMakerTbl)が あったとします。 ここからトヨタのみのデータを以下の形式で欲しい場合 | makerKey | maker | cars | | 1 | トヨタ | アルファード,ヴェルファイア,ヴォクシー,エスティマ | select `makerTbl`.*, GROUP_CONCAT( `carsTbl`.`carName` ) as cars from `makerTbl` inner join `carsMakerTbl` on `makerTbl`.`makerKey`=`carsMakerTbl`.`makerKey` inner join `carsTbl` on `carsMakerTbl`.`carKey`=`carsTbl`.`carKey` where `makerTbl`.`makerKey`=1 group by `makerTbl`.`makerKey` こんな感じで取得できる思いますが、 上記はメーカーのキーがわかっている場合です。 しかしこの構成で、carKeyのみがわかっていた場合 つまり、where `carKey`.`key`=1 に変更した場合は当然うまくいきません。 所持している情報がcarKeyのみの場合にも同じような形式で取得できる方法はないでしょうか？ 長々と申し訳ありません。 どうしてもいきずまってしましまして、断念してしましました。宜しくお願いいたします。
update tUser set ACount = ACount + 1 where UserCD = '5' 上記はテーブルtUserのUserCD=5のACountを1プラスするクエリですが 同時にBCountも1プラスさせたいのですが、1行でまとめるにはどのようなsql文になるでしょうか？ ご教示頂けると幸いです。
例えば、データが1000万件以上あったとします。 質問なのですが、データを操作する際の負荷や高速化において以下の場合どちらがいいのでしょうか。どちらも必要なフィールドにインデックスを使用します。 (1) テーブル（hoge1）1つの中にデータを全て入れて操作する方法。 (2) データを複数のテーブル（hoge1(300万件)、hoge2(200万件)、hoge3(100万件)・・・）に分けていれて操作する方法。 イメージ的には(2)の方が、それぞれのテーブル内のデータが少ないのでデータを操作する場合に速いし、負荷も少ないような気がしますが、正確にインデックスを使用した場合にはどちらも特に違いはないのでしょうか？ ご存知の方、ご教授いただけますようお願いいたします。
2011,600 2011,500 2011,450 2011,750 2010,450 2010,540 2010,350 2010,800 2010,700 例えばこのようなデータを年ごとにベスト３までとって次のようにするSQLはありますか 2011,750 2011,600 2011,500 2010,800 2010,700 2010,540
開発環境は以下になります。 ・PHP Version 5.2.11 ・MySQL (5.0) そして、以下のデータがDBに格納されていると仮定します。 TABLE `hogehoge` CHIIKI,GENRE,CNO 特殊地帯,コンビニ,TOSI001 特殊地帯,八百屋,TOSI001 駒込,デパート,TOSI002 池袋西口,ドンキホーテ,TOSI002 駒込,店舗型エステ日本人,TOSI002 巣鴨,魚屋,TOSI002 池袋東口,スーパー,TOSI002 池袋東口,赤札堂,TOSI002 池袋東口,フリーマーケット,TOSI002 巣鴨,ドンキホーテ,TOSI002 その他,質屋,TOSI003 その他,コンビニ,TOSI003 池袋西口,スーパー,TOSI002 池袋西口,赤札堂,TOSI002 特殊地帯,質屋,TOSI001 池袋西口,デパート,TOSI002 池袋東口,ドンキホーテ,TOSI002 目白,コンビニ,TOSI002 このようなテーブルがあるとします。 そこで、 SELECT `CHIIKI` , `GENRE` , `CNO` , COUNT( `CHIIKI` ) AS CNT FROM `hogehoge` GROUP BY `CHIIKI` , `GENRE` , `CNO` ORDER BY `CNO` ASC , `CHIIKI` ASC , `CNT` DESC としますと、以下のような状態に並び変わります。 CHIIKI,GENRE,CNO,CNT 特殊地帯,コンビニ,TOSI001,18 特殊地帯,質屋,TOSI001,16 特殊地帯,八百屋,TOSI001,15 目白,コンビニ,TOSI002,1 駒込,デパート,TOSI002,1 駒込,店舗型エステ日本人,TOSI002,1 巣鴨,魚屋,TOSI002,3 巣鴨,ドンキホーテ,TOSI002,1 池袋西口,スーパー,TOSI002,37 池袋西口,赤札堂,TOSI002,23 池袋西口,ドンキホーテ,TOSI002,18 池袋西口,デパート,TOSI002,13 池袋東口,ドンキホーテ,TOSI002,17 池袋東口,スーパー,TOSI002,15 池袋東口,赤札堂,TOSI002,11 池袋東口,フリーマーケット,TOSI002,3 その他,質屋,TOSI003,4 その他,コンビニ,TOSI003,2 これは、まず「特殊地帯」は必ず一番上、「その他」は一番下、それ以外は各「CHIIKI」の合計が多い順に並べたいというのが希望です。 しかし、CHIIKIの合計で並び替えの方法がわからず困っております。 本来は以下のような状態に並び替えたいのです。 CHIIKI,GENRE,CNO,CNT 特殊地帯,コンビニ,TOSI001,18 特殊地帯,質屋,TOSI001,16 特殊地帯,八百屋,TOSI001,15 池袋西口,スーパー,TOSI002,37 池袋西口,赤札堂,TOSI002,23 池袋西口,ドンキホーテ,TOSI002,18 池袋西口,デパート,TOSI002,13 池袋東口,ドンキホーテ,TOSI002,17 池袋東口,スーパー,TOSI002,15 池袋東口,赤札堂,TOSI002,11 池袋東口,フリーマーケット,TOSI002,3 巣鴨,魚屋,TOSI002,3 巣鴨,ドンキホーテ,TOSI002,1 駒込,デパート,TOSI002,1 駒込,店舗型エステ日本人,TOSI002,1 目白,コンビニ,TOSI002,1 その他,質屋,TOSI003,4 その他,コンビニ,TOSI003,2 どうすれば、SELECT文で並び替えが出来るのか、何卒ご教授ください。 宜しくお願い致します。
mysqlを使って顧客管理ツールを作ろうと思っています。 それでmysqlのフィールドに、必要であろう項目を英語名で 作成しようと思います。 そこで質問は2点あります。 1.顧客（企業）をＰＣで管理する場合に最低限必要な情報はなにがあるか。 2.そのためのフィールドをmysqlに作るための英語名としてはどんなモノが適当か 以上の2点が知りたいです。 よろしくおねがいします。
全くの初心者ですがphpとmySQLの英語のフリーソースをxamppで変更しようとしています 以下の式で $sql = "INSERT INTO tbl_user (user_name, user_password, user_url, user_tel, user_regdate) VALUES ('$userName', md5('$password'), $userurl, $usertel,NOW())"; user_nameには漢字やカナが入るのですが、user_url, user_telには数字しか入りません。 また10-2と入力すると計算されて8となってしまいます。 user_url, user_telに英語（hoge)を入力するとmySQLからUnknown column 'hoge' in 'field list'とエラーが出ます。(数字ですとmysqlにちゃんと入力されています。） またphpmyadmin側から英語を入力することはできます。（が日本語は文字化けしていました。） user_url,には英語で入力を user_telには-付きの電話番号を入力したいと思っていますが これはどのような原因が考えられますでしょうか？ どうかよろしくお願い致します。
こんにちわ、ワードプレス初心者です。 ワードプレスを使って、大規模ネットショップを構築しようと考えています。 最初の設定の時、 wp-config-sample.php というファイルの書き替えを行いますが、 「データベース名」や「MySQLのユーザー名」等の項目が、 何を指すのか分かりません。 普段、ＣＳＶファイルを使って、ネットショップの商品を一括管理していますが、 ワードプレスでの設定はMySQL等の知識が無いと難しいものなのでしょうか？
私は現在データベースの勉強をしている学生です。 開発環境はJDBCを使い、SQLiteにデータを入れています。 最終的には画像データ（byte）をデータベースに中に入れようと思っているのですが、まずは手始めに数字を、binaryで宣言したデータベースの中に入れたのですが、おもうような結果が得られず困っています。 具体的にソースで説明させていただくと、 String sql1 = "create table Pointing (B binary)"; statement.executeUpdate(sql1); byte[] b = new byte[2]; b[0] = 3; b[1] = 2; String sql2 = "insert into Pointing values(" + b[0] + b[1] + )"; statement.executeUpdate(sql2); ResultSet rs2 = statement.executeQuery("select * from Pointing"); while(rs2.next()) { byte[] b2 = rs2.getBytes("B"); System.out.println("B = " + b2[0]); } この結果が51となってしまいます。 正直、入れ方や取り出し方も全部いろんなサイトから引っ張ってきたり、憶測等で書いたものなので、やり方があっているとはおもっていません。なので正しい方法を知りたく書かせていただきました。 ご回答お待ちしております。
MySQLの更新系負荷分散でできるだけ安く構築するにはどのように構築すればいいのでしょうか。
MYSQLについて MYSQLで insert into syouhin values(3,'ブラックコーヒー',120) で実行するとうまく入力されません charsetもsjisでしてますし、なにがいけないのでしょうか？？おしえてくださいお願いします。
の、それぞれのやりかたはどうすればいいのでしょうか？ できれば、SQLでのやり方と、phpmyadminでのやり方をお教えください。 どうぞよろしくお願いします。
MySQLのテーブルに、 CSV形式のデータを、まとめてinsertしたいのですが、どうすればいいのでしょうか？ なお、レンタルサーバは、VPSで、 host guestともRHELです。 phpmyadminも使えまして、それでできるかどうかわかりませんが、 簡単でかつ待ちがわない方法を知りたいです。 できれば、大量のデータをいっぺんにinsertしたいです。 以前、、つみきCSEや、Access（XP?)でやろうとしたことはあります。 ただ、データを大量に１度はできなかったきがします。 ＝＝＝＝ あと、これが簡単かどうかわかりませんが、コマンドラインからできますでしょうか？ よろしくお願い申し上げます。
下記のデータベースで『nameフィールドに値がセットされているもののみ』、別の文字に置き換えたいと思いますが、例えば『UPDATE `test` SET `name` = "かきくけ";』のような書き方ではnameフィールドのすべてのレコードを更新してしまいます。 その為、上記SQL文のSET以降で『nameフィールドに値がセットされているもののみ』という条件を付加すれば良いと思ったのですが、どのようなSQL文を書けば良いか分からなかった為、アドバイスいただける方がいらっしゃいましたら、ご教示の程よろしくお願いします。 CREATE TABLE IF NOT EXISTS `test` ( `id` int(10) unsigned NOT NULL AUTO_INCREMENT, `name` varchar(64) NOT NULL, PRIMARY KEY (`id`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 AUTO_INCREMENT=6 ; INSERT INTO `test` (`id`, `name`) VALUES (1, 'あいうえお'), (2, ''), (3, 'さしす'), (4, ''), (5, 'ab'); 以上、よろしくお願いします。
mysqlのフィールド名に"event_num","event-num"のように英字の間に'_'や'-'を使うことはできますか？ もし使えない場合、ほかに使用できる記号があれば教えてください。
ユーザーの会員登録認証用メールに、そのユーザのDBのレコードの ID(MySQLのAUTO_INCREMENTの値)を表示しようとしたところ、上司 からセキュリティの危険性を指摘されました。 自動採番のIDをメールに表示することは、危険なのでしょうか？ メールには、ランダム生成の文字列も格納してあり、本人認証はそちらで 行うようにしています。
私はデータベースを本で勉強していたのですが物にするため、実際にデータベースのプログラムをくんでみようと設計を考えたのですが、疑問があります。 私はデータベースに、プログラム上で取り扱っているサイズがことなる複数の配列内のデータを格納したいのですが、これはデータベースにどのように格納すればよいのか分からず困っています。 図で説明すると 例えば {1} {12 33 24 21} {13 56 0 1} という３つの配列を同じデータベースに入れようとした場合 ID int1 int2 int3 int4 1 1 null null null 2 12 33 24 21 3 13 56 0 1 という形で入れる事になると思いますが、ここにサイズが５の配列をいれようとした場合は列が増えることになってしまいます。すると色々めんどくさいことになるのではないかと思います。 このようなデータベースに入れるデータのサイズが分からない場合は、どのようにするべきなのでしょうか？（なおJDBCを使い、SQLiteに入れています） やや抽象的かつ、意味がわかりにくい質問ですが不足な点は説明させていただきますので、ご回答よろしくお願いします。
現在MySQLデータの移行テストをしています。 移行元サーバは4.0.27 EUC-JP 移行先サーバは5.1.55 UTF-8です。 mysqldumpでダンプデータを作り、terapadで文字コードをEUCからUTF-8Nに変換しています。 移行先サーバにデータを復元しようとすると、改行コード（\r\n）が含まれているレコードをINSERTするところで、エラーになってしまいます。（エラー内容はIncorrect database nameやUnknown MySQL server hostなどまったく関係のないものです） どなたか解決方法がお分かりでしたらよろしくお願いいたします。
mysql5で2番目（またはN番目）に小さい（または大きい）引数を返す関数はありますか 例えば、 func(2番目, 2, 15, 7) のようにして7を返してくれるような関数はありますか または真ん中の数を返してくれる関数はありますか func(2, 15, 7) で7が返る これはさすがにないか・・・
ウェブをMySQLで更新すると聞きました。そこでウェブでMySQLなるものを調べたのですが、データベースやらマルチユーザーやら、なんやらチンプンカンプンです。 FTP経由でウェブ更新するのと、何が違うのでしょうか？何がFTPのウェブ更新よりも優れているのでしょうか？ 詳しいことは知りたいと思わないので、簡単にお教えください
MySQLのデータベースの設計についての質問です。 AとBの2つのカラムがそれぞれ一致する項目を選びたいのですが、この際AとBの文字列をハッシュにするなどし、これを新たにカラムにしインデックスにしたほうが高速でしょうか？ ちなみに、常に、決まったAとBをセットにし選ぶつもりです。 よろしくお願い致します。
NO.,属性,種別,ID,所属,ジャンル,タイトル,URLのフィールドを持ったテーブルを作成し、そこにSQL文でレコードを追加したいのですが、エラーが出て追加されません。　SQL文とエラー文は下記の通りです。 SQL文は、 INSERT INTO jobsite (NO.,属性,種別,ID,所属,ジャンル,タイトル,URL) VALUES('0','a','a','a','a','a','a','a'); エラー文は、 #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'a±?a?§,c¨Ra?\,ID,a‰?a±?,a?，a?￡a?3a?≪,a??a??a??a?≪,URL) VALUES('0','a','a','a','' at line 1 です。 原因は文字化けのような気がしますが、解決策は分かりません。 よろしければ、教えてください。お願いします。 ちなみに、テーブル自体では文字化けをしておりません。
レンタルサーバーでMYSQLとPHPを使用したいのですが、PHPからINSERTした文字が、phpmyadminの画面だけで文字化けしてしまいます。 MySQLの文字コード設定は UTF-8 Unicode (utf8) で、照会順序も utf8_unicode_ci　です。 INSERTする文字もINSERT直前に文字コードを変更し、確認したところutf8になっています。 コードは以下のとおり。 <?php $sql = mb_convert_encoding("$info","UTF-8"); $mojicode = mb_detect_encoding($info,mb_list_encodings()); print "$info の文字コードは $mojicode です。"; ?> PHPでMySQLからデータをSELECTで表示させた際は、文字化けせずに表示されます。 表示させるサイトの文字コードはutf-8です。 表示させる前に文字コードを変換させています。 スクリプトは以下のとおり。 <?php //文字コード $enc_disp = "utf-8"; $enc_db = "utf-8"; //データの文字コードを変換する関数 function cnv_enc($string, $to, $from) { //文字コードを変換する $det_enc = mb_detect_encoding($string, $from . "," . $to); if ($det_enc and $det_enc != $to) { return mb_convert_encoding($string, $to, $det_enc); } else { return $string; } } //データベースに接続 $conn=mysql_connect($sv, $user, $pass) or die("接続エラー"); mysql_select_db($dbname) or die ("接続エラー"); //データを取り出す //取りだすレコードの開始位置 $st=0; //取りだす最大レコード数 $lim=5; $sql = "SELECT number,date,info FROM info ORDER BY date DESC LIMIT $st,$lim;"; $res = mysql_query($sql, $conn) or die ("データ抽出エラー"); //mysql_query()関数でデータを取り出すSQLを実行する //取り出したデータを表示する echo "<table border=\"0\" id=table>"; while ($row = mysql_fetch_array($res, MYSQL_ASSOC)) { echo"<tr>"; echo"<td colspan='2'>".' ・ '.$row["date"].' / '.cnv_enc($row["info"], $enc_disp, $enc_db)."</td>"; echo"</tr>"; } echo "</table>"; ?> なお、表示する際、文字コードを変更する前にデータの文字コードを調べたところ、ASCIIとなっていました。 phpmyadminに入った際にASCIIになったのでしょうか？ 解決策がわからず困っています。 どなたか解決策を教えていただけないでしょうか。 よろしくおねがいします。
私は、会社で運営しているサイト情報の整理を任されることになり、これを気に独学でのXAMPPのMySQLを使ったデータベース作成をはじめました。 しかし、運営しているサイトの量が300個近くあり、１個ずつサイトの情報を追加していくと、きりがありませんので一括で全サイトの情報を追加していく方法はないのかと調べましたが、良い方法が見つかりません。 よろしければ、その方法を教えてください。 ちなみに、サイトの情報は、(1)番号、(2)サイト属性、(3)種別(PCかモバイルか)、(4)サイトID、(5)ジャンル、(6)タイトル、(7)URLの７個で、excelファイルで全サイト情報を持っています。MySQLでテーブルも作成済みです。 長くなりましたが、教えていただきたいのは、大量のデータを一括で挿入する方法です。お願いいたします。
MySQLでForeign Keyを作成しようと、以下のSQLを実行したところ、 テーブルは作成されず、エラーが発生しました。 エラーメッセージは 　Can't create table 'test.user' (errno: 150) です。 また、 INDEX (CompanyID), FOREIGN KEY (CompanyID) REFERENCES m_Company(CompanyID), の2行を外すと通常通りテーブルは作成できます。 どうやったら、Foreign Keyを設定できるでしょうか。 テーブル作成後に、後付でForeign Keyを設定しようと心みましたが、 それも失敗しました。 -------------------------------------------------------- CREATE TABLE user ( `Seqno` int(11) NOT NULL AUTO_INCREMENT, `UserID` varchar(8) NOT NULL DEFAULT '', `Password` varchar(8) DEFAULT NULL, `Mail` varchar(100) DEFAULT NULL, `Valid` tinyint(4) DEFAULT NULL, `CompanyID` int(11) DEFAULT NULL, INDEX (CompanyID), FOREIGN KEY (CompanyID) REFERENCES m_Company(CompanyID), PRIMARY KEY (`Seqno`,`UserID`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; --------------------------------------------------------
テーブル(UserM)には5000ほどのユーザー情報のレコードが存在します。 この内の1割のレコードのフィールド(Type)がNULLとなっているのを1に置換したいです。 UPDATE UserM SET Type = 1 WHERE Type = NULL; と入力したのですが、変換されませんでした。 正確にはどのような記述が必要でしょうか？ 宜しくお願い致します。 MySQL - 5.0.45
MySQL5.1で、Table a ,Table b から、Table cのように取り出したいのですが、 SQLでSELECTする方法がわかりません。 Table b優先だけど、Table aにしかデータがない場合もあるといった感じです。 Table a No　　Name 1加藤 2佐藤 3田中 Table b No Name 2佐藤先輩 4田辺先輩 Table c No Name 1加藤 2佐藤先輩 3田中 4田辺先輩 どうか、よろしくお願いします。
現在、mysqlの検索方法で悩んでいます。一番スマートな方法を教えていただけたらありがたいです。 内容)巨人一軍と巨人二軍の各試合結果を格納しているテーブルがあります。ここから、2011年の巨人二軍の勝敗を集計する。 テールブル） ■チームテーブル(id,チーム名) 1,巨人一軍|2,巨人二軍|3,・・・とデータが入っている。尚、idはプライマリーキー ■試合結果テーブル(r_id,自チームid、相手チーム、自チーム得点、相手チーム得点、試合年月日） 1,1,阪神一軍,2,3,2011-05-01|2,1,阪神一軍,5,10,2011-06-01|3,2,広島二軍,1,0,2011-05-02|・・・とデータが入っている。尚r_idはプライマリーキー このデータベースから2011年の巨人二軍の勝敗(○勝□敗）及び勝率（0.55等)をスマートに算出するには、どう行いますか？ mysql 5.0.75-0 ubuntu Apache/2.2.11 (Ubuntu) PHP/5.2.6-3ubuntu4.6
phpMyAdminのバージョンが変わりデータを移行したのですが、PHPからphpMyAdminに接続する際、mysql_query("SET NAMES utf8") or die("can not SET NAMES utf8");のところでエラーが発生してしまうようになりました。古いバージョンではこの関数が使えないのでしょうか？代わりになるコマンドはありますか？
レコード数かけるフィールド数が何万とあるデータベースのデータの中で 半角カナの部分だけを全角カナに変えたいのですが、何かよい手はありますでしょうか？ 半角数字と半角記号（ハイフンやスラッシュなど）はそのままにしておきたいのですが。 xamppの1.7.3を使用しており、MySQL5.14、PHP5.31です。 ご存知の方いらっしゃればアドバイスお願いします。
いつもお世話になっております。 以下のようなテーブルがあります。 ---------- CREATE TABLE IF NOT EXISTS `students` ( `id` int(11) NOT NULL AUTO_INCREMENT, `student_number` bigint(20) DEFAULT NULL, `name` varchar(20) COLLATE utf8_unicode_ci DEFAULT NULL, PRIMARY KEY (`id`) ) ---------- CREATE TABLE IF NOT EXISTS `student_upload` ( `student_number` bigint(20) NOT NULL, `upload_id` int(11) NOT NULL ) ---------- データは以下のように登録されています。 students ---------- id｜student_number｜name 1 ｜11111　　　　 ｜いちろう 2 ｜22222　　　　 ｜じろう 3 ｜33333　　　　 ｜さぶろう student_upload ---------- student_number｜upload_id 11111　　　　 ｜1 11111　　　　 ｜2 22222　　　　 ｜1 22222　　　　 ｜2 ---------- student_upload.upload_id=1 のデータを取得したいので 下記のようなSQL文を発行しているのですが、student_upload.upload_id=2 の データも取得されてしまいます。 select * from students s, student_upload up where up.upload_id=1 and up.student_number=s.student_number よろしくご教示お願いいたします。 ＜環境＞ 　PHP：5.3.5 　MySQL：5.0.7
MAX関数でmysql5のENUM列の内部番号が最大の値を取得したいのですが、文字列としての最大値が取得されてしまいます (x_x) enum( '牡2','牡3','牡4','牡5','牡6','牡7','牡8','牡9','牡10','牡11', '牝2','牝3','牝4','牝5','牝6','牝7','牝8','牝9', 'せん2','せん3','せん4','せん5','せん6','せん7','せん8','せん9','せん10' ) 例えば上の列の場合max関数は'牡9'を返しますが、どうにかして'せん10'を返すようにできないでしょうか・・・ ORDER BY DESCでは'せん10'が先頭になるので、max()も、どうにかすればできるのではと思った次第です
PHPとMYSQLを使用して、従業員のシフト管理のシステムを作ろうと思っています。 テーブルには、従業員ID、日付、出勤時間、退勤時間のカラムを持たせるつもりです。 そこから日付を指定して、その日に出勤する従業員を一覧にしたり、従業員を指定して、その従業員の一週間分のシフトを一覧にしたいと考えています。 そこで、データをPHPでMYSQLに入力したいのですが、一日ずつデータをデータベースに入力することはできるのですが、一週間分のシフトをまとめてMYSQLに入力する方法がわかりません。 何かよい方法はありませんか？ ヒントになるような言葉、参考になりそうなウェブサイト、書籍、ささいなことでもアドバイスいただけたらと思います。よろしくお願いします。 イメージとしては、従業員ごとに日付の欄が一週間分あり、その日付の欄ごとに出勤時間、退勤時間を入力できる欄があり、そのフォームを入力してから送信ボタンを押すと入力した一週間分のデータがMYSQLに入力されるようにしたいです。 わかりにくいかもしれませんが、よろしくおねがいします。
mysqldumpを使用して日次バックアップを取得しているのですが、 新しいサーバに変えたあとにDump時間が長くなっています。 MySQLバージョン：v4.0 サーバスペック： 　　新サーバのほうが高い（メモリは16GB→60GB） 　　InnoDBのバッファプールサイズを12GB→45GBに増やしました。 現象： 　　新サーバ以降後に、Swap in/outが頻繁に発生しています。 　　freeやvmstatで見る限り、メモリ空きは0ではない状況です。 mysqldump指定オプション： 　　--opt や　--quickを指定してもdump時間は短縮されませんでした。 InnoDBのバッファプールサイズの指定が大きすぎたのでしょうか。 何か解決策はないでしょうか。
CREATE TABLE IF NOT EXISTS `events` ( `id` int(10) unsigned NOT NULL AUTO_INCREMENT, `start_on` date NOT NULL, `end_on` date DEFAULT NULL, PRIMARY KEY (`id`) ) ; INSERT INTO `events` ( `id` ,`start_on` ,`end_on` ) VALUES ( NULL, '2011-02-10', '2011-12-28' ); INSERT INTO `events` ( `id` ,`start_on` ,`end_on` ) VALUES ( NULL, '2011-03-01', NULL ); INSERT INTO `events` ( `id` ,`start_on` ,`end_on` ) VALUES ( NULL, '2011-04-01', NULL ); INSERT INTO `events` ( `id` ,`start_on` ,`end_on` ) VALUES ( NULL, '2011-04-10', '2011-05-10' ); INSERT INTO `events` ( `id` ,`start_on` ,`end_on` ) VALUES ( NULL, '2011-01-10', '2011-02-15' ); '2011-03' を渡したら２件帰ってくるような SQL 文を書きたいです。 （３月にやってるイベントの一覧を取得したい。） WHERE `start_on` BETWEEN '2011-03-01' AND '2011-03-31' だと１行目が取得できませんでした。 すみません。よろしくお願いします。
現在、PHPとMYSQLを使用してシフト管理システムを作ろうと考えているのですが、どのようなテーブル構造にするかで悩んでいます。 どなたかアドバイスをいただけるとありがたいです。 よろしくお願いします。 ・シフト管理でやりたいこと。 日付を指定すると、その日に出勤する従業員の写真、出勤時間、退勤時間が一覧になって表示される。 従業員を指定すると、その従業員の一週間分のシフト（出勤時間、退勤時間）が表示される。 ウェブサイトで内容を表示、編集できるようにする。 尚、従業員のテーブル"juugyouin"（カラムはnumber,name,age,・・・等）は別に作成済みです。 また、他にこのようなシステムを作るにあたっての注意事項などアドバイスいただけたらと思います。 よろしくお願いします。
MYSQLの中のデータをPHPで一覧にして表示し、フォームの内容を変更してから変更ボタンを押すと変更を反映した内容が一覧になって表示されるようにしたいのですが、うまくいきません。 コードは以下のとおりです。 <?php //接続設定 $sv="localhost"; $dbname="****"; $user="****"; $pass="****"; //文字コード $enc_disp="shift-jis"; $enc_db="shift-jis"; //データの文字コードを変更する function cnv_enc($string, $to, $from) { //文字コード変換 $det_enc=mb_detect_encoding($string, $from . ", " . $to); if ($det_enc and $det_enc != $to) { return mb_convert_encoding($string, $to, $det_enc); } else{ return $string; } } //データをSQL用に変換 function cnv_sqlstr($string) { if (get_magic_quotes_gpc()) { $string = stripslashes($string); } $string = htmlspecialchars($string); $string = mysql_real_escape_string($string); return $string; } //データベース接続 $conn=mysql_connect($sv,$user,$pass) or die("接続エラー"); mysql_select_db($dbname) or die ("接続エラー"); //編集するデータを取得する if (count($_POST) >0) { $number=$_POST["number"]; $name=$_POST["name"]; //データが送信された時にはデータを変更する if (strlen($number) and strlen($name)) { //データを変更する $sql = "UPDATE customer SET number = ".cnv_sqlstr($number).", name = '".cnv_sqlstr(cnv_enc($name, $enc_db, $enc_disp))."', WHERE (number = ".cnv_sqlstr($number).");"; mysql_query($sql, $conn) or die("データ変更エラー"); } } //データを取り出す $sql = "SELECT number,name FROM テーブル名 ORDER BY number ;"; $res = mysql_query($sql, $conn) or die ("データ抽出エラー"); //取りだしたデータを表示する echo "<table border =\"1\">"; echo "<tr>"; echo "<td> </td>"; echo "<td>名前</td>"; echo "</tr>"; while ($row =mysql_fetch_array($res, MYSQL_ASSOC)) { echo "<form method=\"POST\" action=\"".$SERVER["PHP_SELF"]."\">"; echo "<tr>"; echo "<td><input type=\"submit\" value=\"変更\"></td>"; echo "<input type=\"hidden\" value=\"".$row["number"]."\" name=\"number\">"; echo "<td><input type=\"text\" name=\"name\" value=\"".cnv_enc($row["name"], $enc_disp, $enc_db) . "\"></td>"; echo"</tr>"; echo"</form>"; } echo"</table>"; //接続を解除する mysql_close($conn); ?> 現在は内容を変更して変更ボタンを押すと、「変更エラー」が表示される状態です。 何が原因かわからず行き詰っています。 よろしくお願いします。
MAMPにてスタート画面からMyadminにてデータベースを本を見ながら作成してみました。 一応完成したかと思うのですが、本のリソース制限についての記載があり 特権項目編集でユーザー名とパスワードを変更し その下の項目が４個ぐらいあったのですが　一番下の項目にチェックを入れてしまい 多分　今までのパスワードが使えなくなる感じの項目だったと思うのですが その後MAMPスタート画面がError: Could not connect to MySQL server!と なってしまい　半泣き状態になってしまいました。 元に戻す為には　どういう作業が必要なのでしょうか？ 意味が分からず　いじってしまい後悔しております。 どなたか　良い　アドバイスをお願い致します。
ＨＤ容量が足りなくなった場合、どのような対処方法があるのでしょうか？ 現在、画像や映像データを扱うＤＢの構築を考えており、将来的にデータが増えた場合、 どうしたら良いのか、と思い、質問させて頂きました。 ＮＡＳやＯＳなんかで対応できるのかも・・などとも思っていますが、 知識が無いため、何をどう調べて良いのか、とっかかりがない状態です。 MySQLの設定でなくても構いません。 物理デバイスを増やしても、論理デバイスは１つとみなせるような仕組みは何かあるのでしょうか？ よろしくお願いします。
SQL文についての質問です。 仕様にあわせたテーブルを作ろうとしていますが、エラーが発生します。 申し訳ありませんが、どなたか教えて下さい。 以下がSQL文です。 -------------------- mysql> CREATE FULLTEXT INDEX search_data_idx SPLIT_ALPHA, SPLIT_DIGIT, SPLIT_SYMBOL, 2048 ON chrono_table(search_data); -------------------- 以下がエラーです。 -------------------- ERROR 1064 (42000) at line 28: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'USING NGRAM, SPLIT_ALPHA, SPLIT_DIGIT, SPLIT_SYMBOL, 2048 ON chrono_table(search' at line 1 -------------------- よろしくお願いいたします。
MySQLで以下のようなテーブルがあります 【テーブル名】table_title id　│　title ───── 1　│　あ 2　│　い 3　│　う 4　│　え 5　│　お 【テーブル名】table_data id　│　data ───── 1　│　a 2　│　i 3　│　u 4　│　e 5　│　o 【テーブル名】table_cat id　│　cat ───── 1　│　1 1　│　2 1　│　3 2　│　1 2　│　3 3　│　2 3　│　5 4　│　2 4　│　3 5　│　1 5　│　2 5　│　3 ここからPHPで以下のような配列にしたいのですが、可能でしょうか？ Array ( [0] => Array ( [id] => 1 [title] => あ [cat] => Array ( [0] => 1 [0] => 2 [0] => 3 ) ) [1] => Array ( [id] => 2 [title] => い [cat] => Array ( [0] => 1 [0] => 3 ) ) [2] => Array ( [id] => 3 [title] => う [cat] => Array ( [0] => 2 [0] => 5 ) ) [3] => Array ( [id] => 4 [title] => え [cat] => Array ( [0] => 2 [0] => 3 ) ) [4] => Array ( [id] => 5 [title] => お [cat] => Array ( [0] => 1 [0] => 2 [0] => 3 ) ) )
例えば、あるテーブルに1000件データがあり、その1000件中の日付が2/1のみをCSVに出力するにはどのようにすればよろしいでしょうか？ テーブル毎やデータベース毎のやり方は分かったのですが、特定のデータのみのやり方が分かりません。 どなたか教えていただけないでしょうか。 よろしくお願いいたします。
例えばstart_dateとend_dateというカラムを作って start_date～end_dateの期間がuniqueになるように制御できたりするものでしょうか？ ex. start_date end_date 2010-10-11 2010-12-31 が入ってた時に 2010-11-12 2010-01-01 ×insertできない 2010-01-01 2010-01-31 ○insertできる
MySqlのパスワードに「"」が含まれています。 このMySqlをWindowsから呼び出す方法を教えてください。 パスワード部分を対話式で入力するのはできます。 バッチ処理でアクセスする方法が知りたいです。 なお、シェル（バッチ）ファイルにパスワードを記述するのはセキュリティ的に云々の話は結構です。 例 ユーザー:user1 パスワード:aa"bb データベース:database1 　↓このようなパスワードがセットされています。 SET PASSWORD FOR user1@localhost=PASSWORD('aa"bb'); linux(bash)からは普通にアクセスできます。 　mysql --database database1 -u user1 --password='aa"bb' Windows(dos)からはエラーになります。 　mysql --database database1 -u user1 --password='aa"bb' というかそもそも「abcd」のような普通のパスワードもシングルクオートするとダメです。 　mysql --database database1 -u user1 --password='abcd'　・・・　× 　mysql --database database1 -u user1 --password=abcd　・・・　○ なので裸で記述してみますが 　mysql --database database1 -u user1 --password=aa"bb これは当然ダメです。 こんなことしてみましたが 　mysql --database database1 -u user1 --password=aa^"bb ダメでした。 何か方法ありませんか？
MySQLの導入を検討しています。 そこで、MySQLにはCommunityServerとEnterpriseServerがあることは 分かりました。 XAMPP等をダウンロードした場合、MySQLも一緒に入っていますが、 この場合のMySQLはどちらになるのでしょうか？
お世話になります。 Webプログラム上で、 （CentOS5.5（メモリ1GB）、Apache2.2、MySQL5.1、JSP、Java6、Tomcat6、JavaScript 　　等の環境です） で、同時ログイン数（セッション数）が40件ほどの システムビジー(Busy)時に、 UPDATEされたレコードにおいて、 一部の複数フィールド値だけが正しく更新されていて、 それ以外の、 別の一部の複数フィールド値に対して、全て ”undefind”という文字列がセットされて更新されてしまいました。 （なお、ビジー(Busy)時以外の通常安定運用時には、 　　このundefinedがセットされたことはありませんでした） そこでご質問内容ですが、 （１） ビジー(Busy)時、UPDATEした際に、 ”undefind”という文字列がフィールド内に文字列として セットされてしまうケースは、 よくあることなのでしょうか？ （２） もし、そうでしたら、 今後、 ”undefind”という文字列がフィールド内に文字列として セットされないようにする改善方法としては、 ハードウェアのメモリを増やすなど、 ハードウェア側の改善しかないのでしょうか？ （３） ソフトウエア側の方でも、改善の可能性があるような テクニック方法などございますでしょうか？ 以上３点になります。 何か情報をお持ちの方がいらっしゃいましたら、 ぜひ教えてください。 宜しくお願いいたします。
現在会社で使っているサーバーからデータベースのバックアップを取りたいのですが、サーバーを設置した当時の担当者が退職してしまっていて、説明書や仕様書なども見当たりません。 サーバーには名簿を管理するソフト（PHP）と、その名簿のデータベースがはいっています。 IPアドレスは分かるのですがMySQLなのかpostgreSQLなのかも分かりません。 どうにかバックアップをとる方法はないのでしょうか。 サーバーはLinux系のOSでApacheが入っています。 分からないことずくめで申し訳ないのですが、宜しくお願いします。
データ(テーブル名：os) id,name_a,name_b 1,マイクロ,ソフト 2,マッキン,トッシュ 3,リ,ナックス というテーブルがあり <?php $sql = mysql_query("SELECT * FROM os WHERE name_b LIKE 'ソフト'"); while($ck = mysql_fetch_assoc($sql)){ } ?> とした場合 whileの中では、echo $ck[name_a];　とすればこの場合「マイクロ」と表示されますが whileの外でも表示させたい場合はどうすれば効率がいいでしょうか？ 一つは、whileの中で$a = $ck[name_a]; $b = $ck[name_b]・・・と入力すればいいのですが フィールド数が結構な数ある為に効率が悪いです。 また、 list($ck2[],$ck2[],…) = $assoc; というようにlistを使ってもつらつらと書かなければなりません。 もしくは、mysql_fetch_assocをrowに書き換えて for($i=0;$i<count($ck);$i++){ $ck2[$i] = $ck[$i]; } としてしまうか、 現在htmlで作業しているのですが <?php while(){ ?> <?php echo $ck[name_a]; ?> <?php } ?> がいいかな。と思ったりするのですが なにぶん素人の考えなので、実際に仕事等で利用されている方は どのようにして使用しておられるのか教えて頂けると幸いです。 宜しくお願いします。
Access 2003を使っています。クエリに対し、さらにクエリでデータを抽出するといったことをしたりします。 話し変わって、MYSQLのような本格RDMSを学ぼうと思っています。そこで、ふと思ったのですが、クエリに対し、クエリすることはできるんでしょうか？ビューに対し、ビューするといったほうが正しいのでしょうか？ よろしくお願いします。
いつもお世話になっています。 XAMPP 1.7.4 経由でmySQLを立ち上げようとしているのですが、 パスワードを作成したにも関わらず セキュリティで（対象）「MySQLユーザルートにパスワードがありません」（セクション）「要注意」と表示されています もう一度パスワードを作成し、mySQLを一度とめて、再度動かしても上記のような表示をされています。 後、mySQLのshellボタンが表示されなくなっています。 どなたかご回答願います。
MySQL 5.1.32-community ---------------- no | date | ---------------- 1 | 2011/1/25 | ---------------- 1 | 2011/1/28 | ---------------- 1 | 2011/1/29 | ---------------- 2 | 2011/1/25 | ---------------- 2 | 2011/1/28 | ---------------- 上記から取り出したいデータは下記の通りです。 ---------------- no | date | ---------------- 1 | 2011/1/29 | ---------------- 2 | 2011/1/28 | ---------------- noは動的(3,4,5・・・)に増えていき、その中で最も新しいdateを取り出そうという感じです。 知り合いからは1件ずつ取り出すのは可能だがまとめては無理だと言われました。 やはり無理なのでしょうか？ 知っている方がいましたらご教授お願い致します。
sqliteやmySqlを使い掲示板を何個か作りました。 基本コマンドからテーブルロックくらいまでで掲示板は作れたので、 MySQLの他の機能に意識しませんでしたが、下に書いた制約からレプリケーションまで機能が どのよな場面で使うのか知りたくなりました。 どのようなところで使うのか知りたいと思っています。 どなたかご存知でしたらどのような場面で使うのか簡単でいいので教えてもらえませんか？ よろしくお願いします。 制約　整合性制約定義　～　レプリケーション 質問項目） 必須なもの 頻繁に使うもの どういう場面で使うのか？ プロジェクトの規模　大～小規模 何万行のデーター量か？ データーベースの数テーブルの数 項目を参考にしたサイト ttp://kozy.heteml.jp/pukiwiki/index.php?FrontPage#o2834729 基本コマンド コマンドラインツール データ型 テーブル作成 select insert update／delete トランザクション テーブル　表結合(join)、単純結合、等価結合 テーブルロック 制約　整合性制約定義 テーブル　再帰結合 インデックス ストアドプロシージャ ストアドファンクション トリガ 外部キー ユーザ変数 フォルダ構造 設定ファイル ログファイル ユーザー管理 バックアップ レプリケーション
PHPとMYSQLにて検索システムを作りたいのですが、http://www.nighkyaba.jp/cast/index　このような場合、テーブルのレコードやフィールドの数、PrimeryKeyなどどのようにして作れば良いのでしょうか？ 基本的には、検索する条件（地域・年齢等）の数だけ（ここでは10個程）フィールドをつくるという事なのでしょうか？ また、データベースをサイトからではなく直接ファイルに記録するにはコマンドプロンプト以外に便利なフリーソフトはありますでしょうか？ WEB制作の社員で、MYSQLは初心者です。何卒宜しくお願い致します。
現在MySQLにてシステムの構築を考えていますが、 SQLの組み立てについて壁に当たったので、質問させて頂きます。 線分の座標を表す以下のようなテーブルが存在するとします。 線分テーブル「tblLine」 項目： 　開始X座標[SX], 　開始Y座標[SY], 　終了X座標[EX], 　終了Y座標[EY] このテーブルから任意の座標点(PX,PY)に 近い線分を抽出しようと考えております。 具体的には、上記座標点のX座標、Y座標を プラスマイナス10して出来る以下の4点 (PX-10,PY-10) (PX+10,PY-10) (PX-10,PY+10) (PX+10,PY+10) からなる四角形に、線分の一部でも属すものを すべて抽出できればと考えています。 線分の一部でも属すもので、考えられるパターンは (1)線分すべてが四角形に含まれる。 (2)線分の開始点or終了点のどちらかが四角形に含まれる。 (3)線分の開始点or終了点を除く一部が四角形に含まれる。 になると思います。 (1)、(2)については、開始点と終了点の座標のどちらかが PX-10～PX+10とPY-10～PY+10の条件を満たすものとして 抽出すればよい為、SQLを組み立てるのは難しくないですが、 (3)についてはどのようにSQLを組み立てればよいのかが わかりません。 ちなみに、範囲を四角形にしたのは、 SQLを簡素に、重くならないように考えてのことです。 円(点からの距離)のが簡単or速いということであれば その方法をご教授願いたいです。 ご回答、またはアドバイスをよろしくお願い致します。
mySQL+PHPを使い、社内の支店間で不良在庫を融通するシステムを考えています。 （注）実際には、商品名や支店名に対してマスターテーブルを使いコード化するのでしょうが、 　　　説明のため簡略化しています。また項目名も説明のため日本語にしています。 不良在庫テーブル（dt_stock） 項目名： 在庫コード、商品名、在庫数量、在庫支店名　 　　　　　※在庫コードは自動発番 各支店が不良在庫の商品名と数量を入力します。 発注テーブル（dt_order） 項目名：発注コード、商品名、発注数量、発注支店名、在庫支店名 　　　　　※発注コードは自動発番 各支店が、他支店の不良在庫合計を検索し、そこから支店で必要な商品を発注します。 処理手順 各支店は、個々の在庫を知る必要はなく、商品別の在庫合計を見て必要な発注数量を決めます。 そして、別のプログラムで、発注の合計を各支店の在庫数量に自動分配します。 分配が終われば、発注分だけ在庫を減らし、発注データは既発注としてテーブルから削除されます。 問題点 当初は、dt_stockから商品ごとの在庫合計を表示するクエリー 　　　　　　dt_orderから商品ごとの発注合計を表示するクエリー　をそれぞれ作成し、 これらのクエリを結合して、商品ごとの在庫と発注の合計をリストにするクエリーを作成しました。 （当然のことながら、各支店の在庫と発注の合計を表示するクエリーなので、当然、在庫支店や発注支店の情報は含まれていません） しかし、よく考えると、ある支店で不良在庫として計上している商品に対しては、発注をかけることはありえないので、誤って発注を掛けられないように、商品ごとの在庫と発注の合計をリストにするクエリーで、自分の支店の在庫が入力されている商品のデータを除外するようにはできないでしょうか。 私は、mySQLを使うのは初めてですが、ACCESSの経験はあります。「パラメータクエリーを使えば出来るのかな」とも思いますが、外しているかもしれません。 なんとかヒントだけでもいただければありがたいです。
PHP&MYSQLでチェックボックスを使用した絞込み検索システムを制作しようと思っています。 検索機能の内容は □居酒屋□レストラン□美容室 のチェックボックスに複数また、いずれかにチェックをして該当されたお店の写真（一枚）と説明文を1ページ20店舗ずつ表示したい思っています。 現在、MYSQLにデータベース、テーブルをつくりそれをチェックボックス用のHTMLとデータ取得用のPHPでMYSQLに接続、データを読み出すことはまでは出来たのですがチェックボックスで絞込みが出来ない状態で作業がとまっています。どなたかにご教授お願いしたいと思い質問させていただきました。よろしくお願い致します。 また、画像はどこに格納しておくのが良い方法なのでしょうか？ ソースは select.html <body> <form name="form" action="search.php" method="post"> <input name="key[1]" value="居酒屋" type="checkbox" />居酒屋<br> <input name="key[2]" value="レストラン" type="checkbox" />レストラン<br> <input name="key[3]" value="美容室" type="checkbox" />美容室<br> <p><input value="検索開始" type="submit" /></p> </form> </body> search.php <?php $link = mysql_connect('localhost', 'root', 'pass'); if (!$link) { die('接続失敗です。'.mysql_error()); } $db_selected = mysql_select_db('mysqltest', $link); if (!$db_selected){ die('データベース選択失敗です。'.mysql_error()); } if($debug) print_r($HTTP_POST_VARS); //クエリ生成 $query = "SELECT id,name,state FROM personal_info "; mysql_set_charset('utf8'); //検索条件生成 //名前 if(!empty($name)) { $value = addslashes($value); $where = "value = '$value' && "; } if(!empty($where)) { $where = substr($where, 0, -4); $where = "WHERE " . $where; } $query .= $where; if($debug) { print "<BR><BR>"; print $query; } $result = mysql_query($query); $num_rows = mysql_num_rows($result); if($num_rows == 0) $message = "該当するデータはありませんでした"; else $message = $num_rows . "件ヒットしました"; ?> 検索結果<br> <?=$message?> <table border=0> <? while($row = mysql_fetch_assoc($result)): ?> <tr><td><?=$row[name]?></td></tr> <? endwhile; ?> </table> <a href="select.html">再検索</a> 環境 XAMPP 1.3.0.1 PHP 5.2.9.9 MYSQL 5.1 また、この検索システムに関する書籍やサイトがありましたら教えて頂けたらうれしいです。
お世話になります。 MySQL5をphpMyAdminで利用しています。 フィールド項目の属性が文字列（VARCHAR）の際には表示ＯＫなのですが、 以下のような数値フィールド属性（BUN_CODE、およびBUN2_CODE）だと、 SELECT文を実行した際に もともと入っている正しい数値ではなく、 なぜか、別の長い数値（意味不明の長い数値）に、 変換されて表示されてしまいます。 SELECT concat( 　case when 　a.`BUN_CODE`<>b.`BUN_CODE` then "" 　else a.`BUN_CODE`　 　end, 　 　case when 　a.`BUN2_CODE`<>b.`BUN2_CODE` then "" 　else a.`BUN2_CODE`　 　end　 ) AS DMYDATA FROM ( 　SELECT * FROM `DMY_TABLE` 　WHERE `ID_CODE`=12345 ) AS a, ( 　SELECT * FROM `DMY_TABLE` 　WHERE `ID_CODE`=67890 ) AS b; 質問内容ですが、 数値属性のフィールドに対しては、 何か付け加えないと、上記の場合には、 正しい値を表示出来ないのでしょうか？ 以上になります。 情報をお持ちの方がいらっしゃいましたら、 ぜひ教えてください。 よろしくお願いいたします。
MySQL+PHPの初心者です。 特定レコードの変更または新規作成のサンプルなどあればお教えいただけるでしょうか。 例えば特定商品の単価のレコードがあれば新しい単価に変更と そのレコードが無ければ新規にレコードを作成するようなケースになります。 ＶＢＡなどでは検索のSQL文からレコードセットを作成し レコードが無い場合は　レコードセット名．ａｄｄｎｅｗで必要なフィールドに 値をセットし　レコードセット名．ｕｐｄａｔｅ 該当するレコードがあった場合は　レコードセット名．ｅｄｉｔ　で必要なフィールドに 値をセットし　レコードセット名．ｕｐｄａｔｅなど簡単な処理なのですが MySQL+PHP の場合データの検索と新規レコードの単純な記述は ある程度はわかるのですが上記のようなケースは実際どのように 書かれているのかお教え願えると幸いです。 商品単価テーブルには商品コードと単価のフィールドになります。 よろしくお願いいたします。
mysqlのdatadirを以下の手順で変更するのですが、mysqlが起動しません。 datadirの変更方法を教えてください。 -- centosにyumコマンドでmysqlをインストールしました。 datadirを変更するため、/etc/my.cnfの[mysqld]セクションに以下の行を追加しました。 [mysqld] #datadir=/var/lib/mysql datadir=/opt/mysql /opt/mysqlには、mysqlユーザ、グループに権限を与えています。 mkdir -p /opt/mysql chown -R mysql:mysql /opt/mysql chmod -R 775 /opt/mysql 変更後、起動するのですが、mysqlが起動しません。 /var/log/mysqld.logには、次のように出力されています。 110121 14:15:18 mysqld started 110121 14:15:18 [Warning] option 'max_join_size': unsigned value 18446744073709551615 adjusted to 4294967295 110121 14:15:18 [Warning] option 'max_join_size': unsigned value 18446744073709551615 adjusted to 4294967295 110121 14:15:18 [Warning] Can't create test file /opt/mysql/localhost.lower-test 110121 14:15:18 [Warning] Can't create test file /opt/mysql/localhost.lower-test 110121 14:15:18 InnoDB: Operating system error number 13 in a file operation. InnoDB: The error means mysqld does not have the access rights to InnoDB: the directory. InnoDB: File name ./ibdata1 InnoDB: File operation call: 'create'. InnoDB: Cannot continue operation. 110121 14:15:18 mysqld ended よろしくお願いします。
いつもお世話になっております。 MySQL5テーブル内で、 MEDIUMINT属性フィールド（仮にID_CODEという1箇所のフィールドとして・・・）の、 数値990010、990020、992030が、すでに 登録されているレコード３件に対して、 phpMyAdminなどから、 １回（もしくは出来るだけ少ない回数）のSQL文実行で、 頭2ケタの”99”だけを、”91”という値に変更して、 その後の4桁は、元の値を残したままで、 値を置き換えたいのです。 （期待する更新結果：910010、910020、910030） 上記例は、レコード３件だけでしたが、 実際には数百件ある為、 可能な限り、SQL文を利用して一気にデータ内容を 更新したい状況です。 以上になります。 情報をおもちの方がいらっしゃいましたら、 よろしくお願いいたします。
windowsXP で、 XAMPP を使ってMySQLをGドライブにインストールしています。 データベースを１０個ほど、デフォルトのGドライブに作成しているのですが、 そのうちの１つの負荷が極端に高く、 ボトルネックがディスクアクセスであることが確認できたので、 そのデータベースだけ、Eドライブに置くようにしたいと思っています。 （残り９個のデータベースはGドライブに置いたままにしたいです。） どのように作業すればそのように設定できるでしょうか。 ご回答よろしくお願いします。
user_table ---------------------------- id | group_id | sequence| name | ---------------------------- 1 | 1 | 1 | emi | ---------------------------- 2 | 1 | 2 | shun | ---------------------------- 3 | 2 | 1 | yumi | ---------------------------- 4 | 1 | 5 | jo | … group_idごとにシーケンス番号（グループ内のユニーク番号）を振っています。 shun(group_id=1,sequence=2)のページでシーケンス番号の前後を取りたいのですがどうすればいいでしょうか？ すでに辞めたユーザもいるためシーケンス番号は必ず連続しているとは限らず、抜けている場合もあります。 例として、shun（group_id=1,sequence=2）の前後を取る場合はemiとjoのシーケンス番号を取得したいのです。 下記で出来ましたがサブクエリなしでもできそうなのとあまりきれいでないのでご教示お願いいたします。 select (select min(sequence) from t_files where album_id=1 and sequence>2) next,( select min(sequence) prev from t_files where album_id=1 and sequence<2) prev;
大きなテーブルをバックアップしてリストアしようとするのですが mysql -u root -p database < backup.sql 以上のコマンド入力後に以下のエラーが表示され途中で止まってしまいます タイムアウトを回避するにはどの設定を変更すればいいのでしょうか。 ERROR 1064 (42000) at line 4045208: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '<br /> <b>Fatal error</b>: Maximum execution time of 300 seconds exceeded in <b' at line 124 よろしくお願いします。
phpmyadminの左フレームがすごく狭くなってしまい、困っています。 画像をご参照ください。 この左フレームの幅を広げるにはどうしたらよいでしょうか。 なお、レンタルサーバ上のphpmyadminなので、あんまり自由は利きません。。。 ご回答よろしくお願いします。
作る時にちゃんと考えれば良かったのですが、、、 日付＠文字列カラム（yyyy/mm/dd hh:ss:mm）に対して、 集計作業をするために、PHPでループさせ、 SQL文を発行し結果を取得しています。 ループ内の処理が軽いうちや、 ループ回数が少ないうちは、実行結果表示までの速度が、 気にならないのですが、出来ればもっと簡潔に書き、 処理が増えた時でも遅くならないようにしておきたいと思いまして・・・。 調べた限りでは、出来ないようですが、 IN句を使って、LIKE検索のようなことが出来れば、 ループを無くして、より早く結果が取得出来るかと思うのですが、 このような場合、プロの方はどのようなコードを書かれるのでしょうか？ 環境は、 ----------- mysql：5.0.77 php ：5.1.6 ----------- 現状は、 -------------------------------- SELECT * FROM `order` WHERE `time` LIKE '[日付変数]%' -------------------------------- というようなSQL文をループを回して発行し、 都度返り値を配列に入れ、表示しています。 サンプルコードは以下、 -------------------------------- //日付の取得処理 $start_day = $_REQUEST['start_day']; $end_day = $_REQUEST['end_day']; //日付の間隔取得 $day_span = ( (strtotime($start_day)-strtotime($end_day) ) / 86400 ) +1; //集計値配列セット $counts = array(); //集計値取得 for($a = 0; $a < $day_span ; $a++) { 　　//日付変数 　　$days = date( "Y/m/d",strtotime($start_day) + (86400 * $a) ); 　　//SQL文生成 　　$GET_Query = " 　　　　SELECT count(*) 　　　　FROM `order` 　　　　WHERE time = LIKE '$days%' 　　"; 　　//SQL文実行 　　$res = mysql_fetch_row($GET_Query); 　　$counts[] = $res[0]; 　　$res = array(); } echo '<pre>'; var_dump($counts); echo '</pre>'; exit(); -------------------------------- 意見をいただきたいのが、 WHERE句に日付＠文字列カラム（yyyy/mm/dd hh:ss:mm）の条件を 指定する場合、 -------------------------------- SELECT * FROM `order` WHERE `time` LIKE '[日付変数]%' OR `time` LIKE '[日付変数]%' OR `time` LIKE '[日付変数]%' OR … -------------------------------- -------------------------------- SELECT * FROM `order` WHERE `time` LIKE '[日付変数]%' をループで回す -------------------------------- などとする以外の方法があるか。 また、それは上記より実行速度が早いのかどうか。 についてご意見いただければ幸いです。
feedというテーブルには site_name, site_url, feed_name, feed_url, date, count feed_urlがプライマリーの６つのフィールドがあり、 siteというテーブルには site_name, site_url, first_date, last_date site_urlがプライマリーの４つのフィールドがあります。 feedテーブルのsite_urlとsiteテーブルのsite_urlには全く同じものが入っています。 この二つのテーブルを用いて、以下のような条件でレコードを取り出したいです。 ・site_urlごとのfeed.countの平均値を取得 ・取得した平均値をソート(DESC) ・一週間前までのfeed.dateの中から ・site_urlとsite_nameとfirst_dateとlast_dateと算出した平均値を取り出したい 以下のようなSQL文を作ってphpMyAdminから実行してみたのですが、２秒ほどかかってしまいました。より高速に取り出すことはできますでしょうか？ //0.5程度で終わる //これプラスsiteテーブルのfirst_dateとlast_dateも取り出したい。 SELECT site_name, site_url, AVG( count ) FROM `feed` WHERE DATE > '2011-01-10 00:00:00' GROUP BY site_url ORDER BY AVG( count ) DESC LIMIT 0 , 30 //2秒ほどかかる //目的のレコードが取り出せる。 //このSQLを高速化したい。 SELECT site.first_date, site.last_date, feed.site_name, feed.site_url, AVG( feed.count ) FROM `feed` , `site` WHERE feed.date > '2011-01-10 00:00:00' AND feed.site_url = site.site_url GROUP BY feed.site_url ORDER BY AVG( feed.count ) DESC LIMIT 0 , 30 できれば１秒以内が理想なのですが、そこまで高速にすることは可能でしょうか？ もし可能な場合は、そのSQL文を教えて頂ければ幸いです。（１秒以内でなくても高速になれば嬉しいです。） よろしくお願いします。
　JavaScriptで、ウェブページ上でユーザーが選択した文字列をMySQLのテーブルに送って登録する、というプログラムを作りたいと考えているのですが、どのようにすれば出来るのか思いつかないので質問させていただきます。 　このようなプログラムは作成することは可能なのでしょうか？　また、可能でしたら方法を教えていただきたいと思っています。 　どうか、よろしくお願いします。
お世話になります。 現在、1テーブル内をログテーブル用として利用しています。 JSPでフォームを作成して各フィールド値を、 Webサイト画面上から変更可能なつくりにしており、 複数あるいずれかのフィールドの値を１つ以上変更してから、 [保存]ボタンを押下した際に、 　　↓ その変更前のレコード１件と、 変更後のレコード１件を、 同じログ用テーブル内へフラグ（変更前：0、変更後：2）を それぞれ変えて、 INSERT INTOでレコードを計２件追加しています。 （あわせて、追加時のタイムスタンプをセットするフィールドもあるので、 　どんどんレコードを追加可能な仕様です） そこでご質問なのですが、 この２つのレコードのみを比較して、 値が異なるフィールド名のみを、 （ときには複数フィールドにおいて値が異なるケースも有ります） SELECTなどで表示させるようなSQL文の 作り方をご存じの方がいらっしゃいましたら、 ぜひ教えてください。 なぜこのようなご質問をさせていただいたかと申しますと、 ログテーブル内の上記した２件のレコードを比較して、 どこのフィールドの値が変更されたか？ を確認する際に利用したい為です。 （確認時には、phpMyAdminツールなどで直接SQL文をたたいて実行予定です） 以上、宜しくお願い致します。
レンタルサーバでphpMyAdminもレンタルしています。 csvファイルをインポートしているのですが、 どうやらちょっとずつ文字化けしているようです。 やっと分かったのは 【１】 「ソ」が「ャ」になり、「ソ」以降のカタカナが文字化けしています。 （ソがない場合は、上記ソ以降の文字はきちんと表示されます） また、「予感」という字も「頼ェ」になっていました。 （テーブル数が少ない場合、上記の文字化けは起こりませんでした 　また、phpMyAdmin上で入力すると、きちんと表示されます） 【２】 また、データに「─」や「圭」が入っていると、「CSV 入力のフィールド数が不正です」 というエラーが発生します。 【３】 こちらは、phpで作ったフリーワード検索ですが、 POST送信した際、「メ」→「ƒ」、「ー」→「[」と変換されます。 インポートするカタカナは、全角カタカナしか使っていません。 ───────────────────── MySQL： サーバのバージョン: 5.0.77-log プロトコルバージョン: 10 MySQL の文字セット: UTF-8 Unicode (utf8) Web サーバ Apache MySQL クライアントのバージョン: 5.0.45 PHP 拡張: mysqli phpMyAdmin：バージョン 3.2.4-rc1 ───────────────────── 文字コードはシフト-jisに統一しています。 （色々試しましたが、UTF・EUCでは、インポートした時点で主に「????」の文字化けが発生） 本当に行き詰ってしまい、テーブルデータなどを全て消して1から作り直したのですが…同じでした。 データ数が大変多いので、文字化けしているところを1つずつ直すというのはできません。 初歩的なミスなのかもしれませんが、思い当たらず質問をさせていただきました。 どなたかご存じの方がいらっしゃいましたら、ご教授お願い致します。
MySQLをインストールしたら、phpMyAdminの「特権」タブを見ましたら、 ユーザ　　ホスト　　パスワード すべて　　　%　　　　-- すべて　sql.localhost　いいえ すべて　localhost　　　いいえ root　　127.0.0.1　　　いいえ root　　sql.localhost　いいえ root　　localhost　　　はい --------------- と6つのユーザがいるのですが、これはroot/localhost/パスワードあり 以外全部削除しても大丈夫なのでしょうか？ よろしくお願いします。ｍ（＿＿）ｍ
ある値が規定値を下回った場合に、ある処理(insert文の実行など)を動かすということは可能なのでしょうか？ 今は、PHPで無限ループを作り、その中でselect文を実行し値チェック後、処理起動とすることで常時監視しようかと思っているのですが効率が悪い気がするので何かいい案があれば教えていただければと思います。 よろしくお願いします。
MySQLやPorstgresなどのサーバー型DBMS こんにちは。Accessを使っているのですが、今後C/Sでサーバー側にMySQLなどをインストールしようと考えています。 そこで1点わからないので教えてください。 Accessはファイルなので、使いたいときはそのファイルを開けばいいのはわかります。 ネットワーク内のサーバーにMYSQLをインストールしてクライアントから接続する場合。 何をもとに、どうやってサーバーにクライアントは接続しにいくのでしょうか？ IPアドレスでサーバーを特定すると思うので、クライアントではサーバーのIPが必要なのはわかります。 それ以外にmysqlのユーザーIDとパスワードは必要なのはわかりますが、MYSQL自体に接続するにはどうしたらいいのでしょうか？ できれば、VBで接続しようと考えています。 よろしくお願い致します。
mysql3.23で、以下のようなテーブルでリスト形式の番号を、対応する他のテーブルのデータにマッチさせて代入する方法を教えてください。 [テーブル1] 'id' | 'type' 1 | 1,2 2 | 1,3,5 3 | 2,4 [テーブル2] 'id' | 'name' 1 | red 2 | blue 3 | yerrow 4 | green 5 | pink [このように出力したい] 'a.id' | 'b.name' 1 | red,blue 2 | red,yerrow,pink 3 | blue,green サブクエリなど使えばできるのだと思いますが、 ずっとmysql3.23なので、今まではプログラム側でループさせて出力していましたが、 今回テンポラリーテーブルに挑戦しようと思ったので、テンポラリーテーブルを使って取得する方法があれば、ぜひやり方を教えてください。 お願いします。
こんにちはurudakaraといいます。よろしくお願いします。 私はSQLに関する知識がほとんどありませんがよろしくお願いします。 私はopenofficeをubuntu10.04上で使っています。 業務上データが大量になったためopenofficeについているHSQLというデータベースエンジンでは動作が遅くなったので、データベースエンジンをMySQLに変えました。 するとHSQLでは問題なく結果が出ていたクエリが違う数値を出すようになりました。 まずopenofficeのbaseのテーブルで 識別番号(MySQL Administrator で見るとData Type は　VACHAR(50)となってます。) 区分(MySQL Administrator で見るとData Type は　DECIMAL(50,0)となってます。) というフィールドがあります。 この状態でopenofficeのクエリのデザイン画面でフィールド欄に "識別番号"+"区分" としてました。 "識別番号1234"+"区分5"の場合　 HSQLの場合は結果が　12345 MySQLの場合は結果が　1239 となります。 MySQLでもHSQLの時と同じように結果を出すようにするにはどうSQL文を書けば良いでしょうか? 初心者で分からない事ばかりですが、よろしくお願いします。
教えてください。 下記のようなデータを 結果のようなデータにもっていくには アクセスでどのようなSQLを書いたらいいのでしょうか？ groupbyで人とバスケットを両方やってしまうと、 結果としては Aさん　バスケット１　6個　850円 Aさん　バスケット２　2個　900円 Bさん　バスケット１　　5個　1400円 Bさん　バスケット３　　1個　300円 となってしまいます。 おそらく、副問い合わせをつかって 2段階にわけないとできないのかな？と思うところまではわかったのですが、 構文がよくわかりません・・・。 宜しくお願いします。 例 人　　　バスケット数　個数　金額 Aさん　バスケット１　　1個　100円 Aさん　バスケット１　　3個　300円 Aさん　バスケット１　　2個　450円 Aさん　バスケット２　　2個　900円 Bさん　バスケット１　　5個　1400円 Bさん　バスケット３　　1個　300円 ＜結果＞ Aさん　バスケット２つ　8個　1750円 Bさん　バスケット２つ　6個　1700円
今PHPからmysqlへのデータの更新や追加などを独学で勉強しているのですが行き詰まったのでアドバイスをお願いしたいのですが、何とかPHPからmysqlへの追加及び削除までは出来るようになったのですが今度はmysqlのデータをPHPへ表示させたいと思っていて色々本や入門書を見てもなかなか出来なかったので教えてください select.php <?php $url = "localhost"; $user = "test1"; $pass = "take1118"; $db = "test2"; // MySQLへ接続する $link = mysql_connect($url,$user,$pass) or die("MySQLへの接続に失敗しました。"); // データベースを選択する $sdb = mysql_select_db($db,$link) or die("データベースの選択に失敗しました。"); // クエリを送信する $sql = "SELECT * FROM test"; $result = mysql_query($sql, $link) or die("クエリの送信に失敗しました。<br />SQL:".$sql); //結果セットの行数を取得する $rows = mysql_num_rows($result); // MySQLへの接続を閉じる mysql_close($link) or die("MySQL切断に失敗しました。"); ?> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=SHIFT-JIS"> <title>全件表示</title> </head> <body> <h3>全件表示</h3> <table width = "200" border = "0"> <tr bgcolor="##ccffcc"><td>user_siten</td><td>user_name</td></tr> </table> </body> </html> このようにテーブルにして表示させようとしています。 初心者なのでプログラム的におかしな部分があるかも知れませんがお願いします。
フォームで入力された値をINSERT文でMYSQLへ保存しようとしているのですが、 以下のように記述して実行し、phpmyadminでテーブルを確認しても データが入力されておらず空のテーブルとなっています ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー <?php $SCR = $_POST['junni']; $Name = $_POST['namae']; $Day = $_POST['hiduke']; $conn = mysql_connect($url,$user,$pass); $sdb = mysql_select_db($db,$conn); $sql = "insert into `seiseki`(`name`,`day`,`score`)values('$Name','$Day','$SCR')"; $res = mysql_query($sql,$sdb,$conn); mysql_free_result($res); mysql_close($conn); ?> ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー 補足として、 実行後、 Warning: mysql_query() expects at most 2 parameters, 3 given in　「phpの場所とファイル名」　on line 26 Warning: mysql_free_result() expects parameter 1 to be resource, null given in 「phpの場所とファイル名」 on line 28 という表示がされます また、$conn =のあとに print ($Day"); print ($Name"); などを入れると値は表示されているため、受け渡しは問題ないかと思います また、$url,$user,$pass,$dbは、$SCR = $_POST['junni'];以前に $url = "localhost";というような形で代入しており、入力ミスなどは何度も確認しましたがありません 知識がほとんどありませんので、説明足らずかもしれませんが、 文法、入力間違いや解決策がありましたらよろしくお願いいたします
環境は Windows7 mysqlはmysql-5.5.8-win32.msi です。 データベースを作成しテーブルも作成しています。 INSERT INTO でテーブルにレコードを追加しようとすると日本語が追加できません。 このようなエラーがでます。 MySQL]ERROR 1366 (HY000): Incorrect string value 僕なりにいろいろ調べて 文字コードの設定も my.iniないの設定も #default-character-set=utf8 default-character-set=sjis に変更もしました。 しかし コマンドブロンブスで show variables like '%char%'; で確認したらやはり character_setがすべてutf8になっていて日本語が入力できません。 対処法を教えてください。
会員制の小さなサイトを運営しています。 会員は会員IDで管理しているのですが、テーブル設計が適切であるか判断できず、助言を頂きたく書き込みさせて頂きました。 現在、会員情報テーブル(info)というテーブルが全ての基本となっています。 このテーブルには、会員IDの他、名前や性別、住所、自己紹介文などほとんど全ての会員情報が含まれています。 このほかに会員同士の交流用のテーブル(koryu)がいくつかあり、 そこには、会員IDとその会員が行った内容が記録されています。 で、現状、交流用テーブルを使用する場合、常に会員の名前を会員情報テーブルから引っ張ってきており、これが、処理的に重いのでは無いか、と思っています。 以下はたとえばの例ですが、 　select koryu.id, info.name, koryu.contents from info,koryu where koryu.id=info.id のように、毎回、（ほぼ）名前だけを引っ張ってきています。 引っかかっているのは、この「名前だけ」というところで、例えば、会員IDと名前しかないテーブルを作成すれば、もしかしたら、処理が軽くなるのでは・・と思っているのです。 ２０カラムあるテーブルと関連付けを行う場合と、２カラムのテーブルと関連付けを行う場合、 ２カラムのテーブルのほうが、処理は軽くなるのでしょうか？また、軽くなる場合、そうしたほうが良いのでしょうか？ （現在、１０００名くらいしか会員がいないため、処理が重いということは無いのですが、 安いサーバを使用しているため、処理はなるべく軽くしておきたいと思っています。） よろしくお願いします。
各カテゴリ内で最大の番号を持っているものの詳細を表示したいと思っていますが、以下のクエリではエラーがでてしまいます。 SELECT * FROM favorite WHERE no = (SELECT max(no) AS max_no FROM favorite GROUP BY category) 何が悪いのでしょうか？ぜひアドバイスをお願いします。
下記のURLを参考にページを作ろうと考えています。 http://av.watch.impress.co.jp/docs/dvdship/ 参考にしたいところは、 　・画面真ん中あたりの検索フォーム 　・タイトルや、販売元のテーブル 　・最初に表示させるテーブルの項目や、発売元にリンクを貼ったりと、検索・テーブルはほぼ同じですが、周りの広告はいりません。 　・「最近1週間で検索数が多いキーワード」は必要ないですが、しくみは知りたいです… ご教授願いたいことは、 　・上記のようなページにするには、どのような知識が必要か 　　（PHP+JavaScript+MySQL…かなと思うのですが…） 　・参考になるサイトをご存じではないでしょうか? 　　（各、入門はほぼ読みました。また、phpMyAdminにてデータベースはなんとか準備しました。phpからの接続・サイトでの公開はできました） 　・どんな用語で参照サイトを探せば良いのでしょうか 　　（htmlでは'リンク'と言っていましたが、PHPからMySQLへは'接続'と言ったり、微妙なことでググってもなかなか見つからないのかと…） 各基本は少し理解できているとは思うのですが、つなげて1つのページを完成させるまでなかなかたどりつけない状況です。 少しでも作りたいものに近づけるヒントだけでもと思い…不躾な質問とは思いますが、宜しくお願い致します。
はじめて質問させて頂きます。 MySQL、PHPともに初心者です。 MAMPを使用しています。 ローカルではほぼ問題無く動作していたphpファイルをウェブ上にアップロードしたところ、以下のようなエラーが出てしまいました。 Warning: mysql_connect() [function.mysql-connect]: Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2) in～ ネットやこちらの過去ログで調べたところMAMP使用下ではよくあるエラーらしく解決法も載っていたのですが、どれを試してもなぜかエラーが消えてくれません。 ソケットもMySQLサーバー側とクライアント側で同じもの(/Applications/MAMP/tmp/mysql/mysql.sock)を参照していると思うのですが・・・ php.iniの中でも、 mysql.default_socket = /Applications/MAMP/tmp/mysql/mysql.sock と指定されてあります。 何か他に原因があるのでしょうか。 ド素人のため質問がすでにおかしいかもしれませんが、お知恵をお貸しください。 よろしくお願い致します。
MySQLにて、勤怠プログラムを作成しているのですが、例えば出勤時間と退勤時間をそれぞれdatetime型で保持していたとして、「1ヶ月間の勤務時間の合計を算出」と言った形であれば SEC_TO_TIME(SUM(TIME_TO_SEC(TIMEDIFF( '退勤時間', '出勤時間' )))) AS WORK_TIME FROM 'テーブル名' のような形で算出できるかと思いますが、例えば、「1ヶ月間の残業時間の合計を算出」といったことはSQL文のみで実現可能なのでしょうか？ちなみに残業時間の定義は「平日の18時以降、土日出勤時間は除く」となります。 よろしくお願いします。
教えて下さい。 プログラムしたＥＸＥファイルをクライアントに置き、社内にあるＭｙＳｑｌのサーバへアクセスを 使用としたところ、以下のようなエラーでアクセスできません。 自開発環境（ＭｙＳｑｌサーバとは別環境）では問題なくアクセスができます。 《エラー内容》 ************** 例外テキスト ************** MySql.Data.MySqlClient.MySqlException: Unable to connect to any of the specified MySQL hosts. ---> : 型 'System.Net.SocketPermission, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' のアクセス許可の要求に失敗しました。 何がおかしいのかさっぱり掴めません。。。。 教えて下さい。　よろしくお願いします。
教えて下さい。 Ｃ＃で作成したプログラムを自分の開発環境以外のクライアントで実行したところ、 エラーでＭｙＳｑｌへ接続ができませんでした。 自身の開発環境では、アクセスできますが、そのＥＸＥファイルを他クライアント から実行するとエラーとなってしまいます。 各クライアントへは、自開発環境と同じく、"mysql-connector-net-6.1.5"をインストール してあります。 ちなみにソース上の記述は以下のようになっています。 《記述内容》 using MySql.Data.MySqlClient; string sqlcmd = "userid=root;" + "password=000000;" + "database=db_name;" + "Host=999.999.999.999"; string cmdstr; cmdstr = "select * from t_user ;"; MySqlDataReader reader = null; MySqlConnection conn = new MySqlConnection(sqlcmd); //MySQLコマンド MySqlCommand selcmd = new MySqlCommand(cmdstr, conn); エラーの内容は、 　　"アプリケーションのコンポーネントで、ハンドルされていない例外が発生しました。[続行」 　　をクリックすると、アプリケーションはこのエラーを無視し、続行しようとします。[終了] 　　をクリックすると、アプリケーションは直ちに終了します。 　　ファイルまたはアセンブリ'MySql.data,Version=5.0.9.0,Culture=neutral,PublicKeyToken =C5687fc88969c44d'、またはその依存関係の１つが読み込めませんでした。　指定されたファイル 　　が見つかりません。" と表示されます。 原因を教えて頂きたく。。。。 よろしくお願いします。　
phpMyAdminを更新するシステム入力画面を作成しています。 テキストエリアに入力したテキストにaタグでリンクを貼り付けて、 SQL文で更新をかけたいのですが、うまくいきません。リンクを貼れる 設定にするには、何か指定が必要でしょうか？
mysqlの命令文等いろいろと試行錯誤しています。 添付画像のように、attachment_nameは画像なのですが、item_idが重複されていますので どれでもよろしいですので、各一つづつ表示させたいです。 mysql文はいろいろと結合していますが、下記の通りです。 function getfeatured01($sales_type='rental'){ $db = Database::instance(); //$rsfeat = $db->query("select item_id from items"); $sql = "SELECT *, attachment.name as attachment_name, ldk_type.id as ldkid, ldk_type.name as ldkname, caution_money_num.name as cautionmoneynum_name, reward_num.name as rewardnum_name FROM items INNER JOIN ldk_type ON ldk_type.id = items.ldk_type INNER JOIN caution_money_num ON caution_money_num.id = items.caution_money_num INNER JOIN reward_num ON reward_num.id = items.reward_num INNER JOIN attachment ON attachment.item_id = items.item_id WHERE sales_type = 'rental' and status = '1' order by price asc LIMIT 0,20 "; $rsfeat = $db->query($sql); return $rsfeat; } いろいろと検索してみますが、基本がなっていないせいか、理解ができません。 今回MySQLをご指導いただきたく質問いたしました。 申し訳ございませんが、ご指導のほど、宜しくお願いいたします。
TeraTermを使ってMySQLを操作する際にTabをおしたら候補を出してくれるようにする設定はどうすればいのでしょうか？ ex. mysql> SELECT *FROM hog　←ココでtabを押す hoge hogehoge mysql>SELECT *FROM hoghoge 自鯖でやっているのですが、tabを押しても何も表示されないのですが、これを適当なところでTabを押すと候補が出るようにするにはどうしたらいいのでしょうか？
MySQLで検索をすると濁点や半濁点もヒットしてしまいます。 「%カルビ%」で、「カルビスープ」も「カルピス」もヒットしてします。 照合順序は「utf8_unicode_ci」ではダメで「utf8_bin」でもダメでした。 PHPにて「%カルビ%」の検索結果から「カルピス」を除去すればいいのですが、 MySQLにて検索で濁点や半濁点をヒットさせない方法はありますか？
PHPもMySqlも学校の授業で数週間触った程度の素人です。 小論みたいな長さの（2千-4千文字）html形式の文書を300ページくらいを自分のウェブサイトで必要に応じて表示したいのですが、PHPとMySqlは技術的に適しているのでしょうか？ レンタルブログとか漁ってみたんですが、気に入ったものが見つかりませんでした。 スクリプト言語はもう少し掘り下げてみたいと常々思っていたので、これを口実にPHP/MySqlに取り組んでみたいと思っています。が、1データのサイズとして小論文並みの文字数+体裁を整えるhtmlタグって大きすぎるのか？とふと疑問に思いました。 もし1データとして大きすぎる場合、他の技術を使ったほうが良いのでしょうか？ サイトはレンタル（ハッスルサーバ）で、アクセス数は一日平均200件以下という小規模な物です。 htmlからDB管理（か似たような一括管理）に移行したい理由は、ページ数が増えてきた事と、それらに個別のタイトル<title>、ジャンプリンク、解析タグを挿入するのが煩雑になってきた、ということです。 上記の要素以外の本文はどれも同じ構造なので、DBで本文を管理して、体裁と前後リンク、解析タグの自動生成をPHP（の類）で出来ないかと思ったわけです。 まだ仕様の下書きみたいな段階で漠然とした質問ですが、アドバイスいただけたら幸いです。 もし全部の条件を満たすのが無理でも、PHPとMySqlを触ってみたいので、スケールを下げた物でアドバイスいただくのでも有難いです。よろしくお願いします。
MysqlへVisual Studio 2008 のＣ＃で接続しようとしています。 接続方法としては、クライアントから"mysql-connector-net-6.1.5"をインストールして ODBCを使わずに接続しようとしています。 参照設定で、"MySql.data"を指定し、以下のように記述しましたが、どうしても下記の ようなエラーが出力されてしまいます。 原因がわかりましたら教えて頂きたいと思います。 《記述内容》 using MySql.Data.MySqlClient; string sqlcmd = "userid=root;" + "password=000000;" + "database=db_name;" + "Host=999.999.999.999"; string cmdstr, cmdcnt; cmdstr = "select * from t_user ;"; MySqlDataReader reader = null; MySqlConnection conn = new MySqlConnection(sqlcmd); //MySQLコマンド MySqlCommand selcmd = new MySqlCommand(cmdstr, conn); //MySQL接続 conn.Open(); この　conn.Open(); のところで下記のエラーが出てしまう。 //エラー内容 Unable to connect to any of the specified MySQL hosts. よろしくお願いします。
親に対して複数の子供がいるようなデータ構造の場合、一つのＳＱＬで取得する方法がわかりません。 例：楽天のようなモールサイトでの商品検索 テーブルは【店舗】と【商品】と【店舗支払方法】 ■キー 【店舗】.店舗番号 １つ 【商品】.店舗番号、商品番号 ２つ 【店舗支払方法】.店舗番号、支払方法コード（ ２つ 店舗は複数(n) 店舗に対して、商品は複数(n) 店舗に対して、支払方法は複数(n) 取得したい結果としては、各店舗の商品一覧です。各商品には店舗支払い方法（代引き、クレジット）がどのようなのがあるかです。 出力結果例としては以下のように表示したいです。 １：店舗Ａ、商品１、代引き、クレジット、銀行振込み ２：店舗Ａ、商品２、代引き、クレジット、銀行振込み ３：店舗Ｂ、商品１、代引き、クレジット ４：店舗Ｂ、商品２、代引き、クレジット ５：店舗Ｃ、商品１、クレジット ６：店舗Ｃ、商品２、クレジット 支払い方法がないのであれば、【店舗】.店舗番号 = 【商品】.店舗番号 というような結合条件でいいのでしょうが、支払い方法が入ってくると別になってきます。 何も考えずにやるのであれば、、【店舗】.店舗番号 = 【商品】.店舗番号 上記の結合で、商品の一覧を取得し、取得した数だけ【店舗支払方法】のテーブルと結合したＳＱＬを実行して、レコードに対して情報を付加してあげれば出来るとは思いますが・・・。 １回で取得する方法はありますか？ 環境はMYSQL5.0とＰＨＰ５です。 そもそもテーブルがうまく正規化出来ていないなのがあれば、教えてください。 以上、よろしくお願い致します。
mydbというDBに table1とtable2二つテーブルがあります。 table1 no name sex 1 yuki 女性 2 hana 女性 3 mie 女性 4 sora 女性 table2 no name sex 1 akira 男性 2 genn 男性 3 hite 男性 4 tuba 男性 一回目は、table1に上記のデータが格納されます。 二回目は、table2に上記のデータが格納されます。 やりたいことは、 二回目に、下記のようにtable2にtable1のデータも入れたいです。 table2 no name sex 1 yuki 女性 2 hana 女性 3 mie 女性 4 sora 女性 5 akira 男性 6 genn 男性 7 hite 男性 8 tuba 男性 ぜひよろしくお願いいたします。
そのままですが、なんと発音するのが一般的なのでしょうか？
menu テーブル ID 1 / NAME ご飯 ID 2 / NAME 味噌汁 ID 3 / NAME 焼しゃけ ID 4 / NAME 焼さば ID 5 / NAME 肉じゃが であり setmeny テーブル ID 1 / NAME 焼しゃけ定食 / M1_ID 1 / M2_ID 2 / M2_ID 3 ID 2 / NAME 焼さば　定食 / M1_ID 1 / M2_ID 2 / M2_ID 4 ID 3 / NAME 肉じゃが定食 / M1_ID 1 / M2_ID 2 / M2_ID 5 とデータを入力してあるとき 1 / 焼しゃけ定食 / ご飯 / 味噌汁 / 焼しゃけ 2 / 焼さば　定食 / ご飯 / 味噌汁 / 焼さば 3 / 肉じゃが定食 / ご飯 / 味噌汁 / 肉じゃが という表を取り出す方法はありますか？ select setmenu.ID, setmenu.NAME, menu.NAME from setmenu join enu where setmenu.M1_ID = menu.ID; で 1 / 焼しゃけ定食 / ご飯 2 / 焼さば　定食 / ご飯 3 / 肉じゃが定食 / ご飯 までは出せるのですが。 / 味噌汁 / 焼しゃけ / 味噌汁 / 焼さば / 味噌汁 / 肉じゃが をどう出して良いかわかりません。 またはもっと効率が良い方法あるのでしょうか？
まだ初心者なんです。よろしくお願いいたします。 テーブル$tbl_nameに日付date コラムに (2009-11-3 14:25:06).(2009-11-3 11:25:06). (2009-11-5 12:25:06).(... ....と年齢 ageコラムに (18)(19)(20)... 性別コラムage に　(danshi)(jyoshi)　が入っています。 これを日付別　に内容が存在するだけ出力したいのです。 出力内容は（18）→25、（19）→13、（20）→7、の数だけ、 同様に（danshi）→20、（jyoshi）→25、というように 〇月〇日18才は25人、19才は13人、20才は7人、 男子は20人、女子は25人と出したいのです。 $sql = "SELECT 'age',count(age) FROM $tbl_name group by 'date'"; $result = mysql_query($sql, $db) or die("クエリの送信に失敗しました。<br />SQL:".$sql); while ($row = mysql_fetch_assoc($result)){ $age .=$row;} 等記入しているのですが、何とも動きませんのです。 どうしたらよろしいものでしょう。よろしくお願いいたします。
添付ファイルのようなフォルダ構成の追加・更新・並び替え・削除をデータベースで実現したいと思います。 そのため、データベースに下記の項目を格納すれば良いのではと思いました。 1. フォルダID 2. フォルダ名 3. 親フォルダID 4. 並び順 ただ上記では並び替えの際に、多くのレコードの更新が必要になりそうで、 考え方として間違っているのではないかと思いました。 そのため、添付ファイルのようなフォルダ構成をデータベースで実現する場合、 どのようにするのが良いかご教示いただければと思います。 以上、よろしくお願いします。
mysqlのデータベースAとBが存在するとして、 Aをuseしている状態で、Bのデータベースのテーブルをselectするには、どのような構文でSQLを実行すればよいでしょうか。
初心者です。よろしくお願いいたします。 データを入れたいのですが、エラーとなってしまいます。 以下でデータベースとテーブルを作成し、 <?php $db_name="tori"; $tbl_name = "hato"; $db = mysql_connect('localhost', 'root', ''); if (!$db) { die('接続できません: ' . mysql_error()); } $sql = 'CREATE DATABASE tori'; if (mysql_query($sql, $db)) { echo "データベースtori の作成に成功しました\n"; } else { echo 'データベースtoriの作成に失敗しました: ' . mysql_error() . "\n";} mysql_select_db($db_name,$db) or die("データベースへの接続エラー"); $query ="create table {$tbl_name} ( id char(8) primary key, date TEXT, sex TEXT, age TEXT )TYPE=MyISAM"; mysql_query($query); $query ="INSERT INTO `houzingpark`.`hatogaya` ( id , date , sex , iro ) VALUES ( '2', 'uu', 'ii', 'po' )"; mysql_close($db); ?> 以下で入れ込みたいのですが、出来ないのです。 <?php $db_name="tori"; $tbl_name = "hato"; $db = mysql_connect('localhost', 'root', ''); if (!$db) { die('接続できません: ' . mysql_error()); } mysql_select_db($db_name,$db) or die("データベースへの接続エラー"); $sql="INSERT INTO hatogaya ( id , date , sex , iro ) VALUES ( 3, 2005-12-3, mesu, cya )"; mysql_query($sql); if(!$result){print 'INSERT Error!';} echo $sql; mysql_close($db); ?> でINSERTしようとするのですが、INSERT Error！と表示されてしまいます。 Adminで見るとデータベースとテーブルは出来ているのですが、どうしてもINSERTできないのです。 もう何時間も悪戦苦闘しております。 どなたかご指導よろしくお願いいたします。
教えてください。 データは、 日付　　　　　　　　　　購買日 2010/01/01　　　　　2010/03/01 ともっているのですが、 クエリで、　 日付から購買日までが何日かかったかがとりたいです。 select 購買日-日付　ではだめですよね？ 初歩的ですみませんが、お願いします。
ID日付　　　　　　金額 test20100101100 test20100103200 test120100105300 のように、同じIdで複数存在している場合、 この中で日付が一番古いものだけをとってきたいときのクエリをおしえてください。 回答としては test20100101100 test120100105300 だけもってこれればいいのですが・・・ お願いします。
LAMP環境でWEBシステムの設計中です。 select文のwhere句の検索条件となるカラムにおいて、 データ型による検索速度に差があるのか？についてご教示いただけたら幸いです。 例えば顧客データのようなテーブルで「都道府県」カラムを持っているとして、 その中に格納するデータをintの1～47にした方が良いのか、それともvarcharで 北海道～沖縄県にした方が良いのか、パフォーマンスの観点から悩んでいます。 各ケースにおいて検索速度に差はあるのでしょうか？ データ件数は5000超程度です。 以上、よろしくお願いいたします。
DBに登録されている値を表示することはできました。 しかし、置き換えて出力することができません。 "あいうえお"と登録されていたら"かきくけこ"と表示させたいと思っています。 記述コードをサクッと書いていただけると助かります。 よろしくお願いいたします。
1つのサーバーにxoopsのようなEUCを使用するフレームワークと他のUTFを使用するフレームワークを利用した場合、どのようにデータベース設計すればよろしいでしょうか。 そもそも可能なものなのでしょうか。 また、分けるとすれば、どのような構成が考えられますでしょうか。
PHPを勉強中で、入門書をつまづきながら読むくらいのレベルの者です。 例えば、PHP+MySQLでブログのようなシステムを作るとしたとき、本文にあたる短ければ数百字、長くて数千字のテキストを扱う場合にどのような方法をとればいいのか悩んでいます。 1. テキストファイルとして保存してデータベースにファイル名を保存し、ファイル名からPHPのテキストファイルを読み込む関数で読み込む 2. TEXT型（あるいはVARCHAR型？）でそのままデータベースに保存する の2つの方法のいずれかを考えており、 テキストの利用方法として、 1. そのままHTMLに出力して表示する。その際、データベースの同じテーブルに入っている記事タイトルなどのデータも利用する。 2. 複数ファイルから特定の文字列を含むもののみを選び出す（行番号などの情報は不要）。この際は他のデータは利用せず、例えば記事IDのようなものの配列が得られればよい。 のことをしたいと思っており、 また、その他の条件として 1. 動作が高速な方がいい（特に複数ファイルからの検索） 2. 直接テキストファイルのURLを指定して内容を読まれても、まあOK 3. 最大文字数は多分8000字程度で固定（書き込み時にチェック） を考えております。 総合的に考えてどちらの方法が優れているでしょうか？　また、それぞれの方法で知っておいた方がいい制限事項などはありますか？　特に、正直なところVARCHAR型、TEXT型がどのようなアクセス速度など特徴を持つのかをまったく分かっていません。 ご教授宜しくお願いします。
「set names utf-8」は、「set names utf8」ですよね？ MySQLの文字化けの質問の回答に「set names utf-8」 と教えているページがありました。 http://oshiete.goo.ne.jp/qa/3749280.html 「set names utf8」ですよね？ 「set names utf-8」で解決するのでしょうか？ 質問が閉じていたので質問させていただきます。
SELECT * FROM `sample_table` WHERE 'test' REGEXP '^[0-9]+$' と記述し、「test」内の値が数字のもののみを取り出そうと思いましたがうまくいきません。 1や2、3などの数字だけの値があるにもかかわらず、返り値が空になります。 WHERE NOTとすると全ての列が表示されるので、REGEXPが上手く宣言できていないのかとも思いますが、原因・対策共にわかりません。 どのようにすれば、数字のもののみを取り出すことができるのでしょうか。
phpとmysqlを勉強中不動産のサイトの検索のようなもの（データベースから複数条件一致で検索）をやろうと考えています。 ちょうど http://www.asakusa-chintai.com/list.php?foot_sta … このサイトの様なものを作りたいと思っています。 現在検索結果がみれるまではできるようになったのですが、その検索結果一つ一つにリンクを貼り、その物件の詳細がみれるようにする上手い方法がわからなくて困っています。 これは一つ一つの物件のデータに対して一つ一つのhtmlのページ（phpでデータベースからデータを引っ張ってきて、テンプレートにはめ込むようなもの）をあらかじめ作っておかなければならないのでしょうか？ できれば検索結果からのリンクをクリックすれば、自動的にその詳細のページが生成されるようにしたいのですが、そんな方法、またはそれに準ずるような上手い方法はないでしょうか？
MySQLで、UPDATE tablename SET hoge = ? WHERE id = ? (どっちの?もランダムな数値)で、UPDATEのベンチマークをとったのですが、idにインデックスがついている状態だと高速に処理できました。500プロセスで1000回実行しましたが1000QPSでした。 ちなみに100万レコード入ってます。カラムは20程度でintとvarcharしかありません。 単純にUPDATEもレコード検索するからインデックス使うということなんですかね??? どなたか詳しい方この現象について詳しく教えて頂けないでしょうか。 よろしくおねがいします。
下記のテーブルの中で、 b_tableテーブルのidフィールドの値が1つしかない(重複していない)フィールドを抽出したいと思います(この場合ですが、3002と3004を抽出したいです)。 その際、抽出条件を下記の【※※※ここに記述を追加※※※】に記述することで実現したいと思ったのですが、その場合どのようなsql文を書けば良いか分かりませんでした。 その為、このような場合、どのようなsql文を書けば良いかご存知の方がいらっしゃいましたら、ご教示の程、よろしくお願いします。 なお、【※※※ここに記述を追加※※※】に記述を追加したい理由ですが、既存のSQL文にこの条件を追加したいのですが、WHERE以前は別の部分に記述されており、その部分が変更できない為です。 なお、下記のWHERE以前の記述はあくまでサンプルであり、重複していないフィールドを抽出するSQL文と直接関係のない記述でしたら、変更していただいても大丈夫かもしれません(この点曖昧で申し訳ございません。移植元の記述ではテーブルを連結しているように見受けられたため、連結の仕方が多少変わる分には問題ないのかなと思っています。この点については実際にソースをご提示いただければ、それを元に移植させていただいた上で、ご回答差し上げたいと思います)。 ■SQL文 SELECT a.id FROM `a_table` AS a LEFT JOIN `b_table` AS b ON a.id = b.id WHERE 【※※※ここに記述を追加※※※】 ■a_tableテーブル CREATE TABLE IF NOT EXISTS `a_table` ( `auto_id` int(3) NOT NULL, `id` varchar(4) NOT NULL ) ENGINE=MyISAM DEFAULT CHARSET=utf8; INSERT INTO `a_table` (`auto_id`, `id`) VALUES (101, '3001'), (102, '3002'), (103, '3003'), (104, '3004'); ■b_tableテーブル CREATE TABLE IF NOT EXISTS `b_table` ( `auto_id` int(3) NOT NULL, `id` varchar(4) NOT NULL, `no` varchar(1) NOT NULL ) ENGINE=MyISAM DEFAULT CHARSET=utf8; INSERT INTO `b_table` (`auto_id`, `id`, `no`) VALUES (101, '3001', '1'), (102, '3001', '2'), (103, '3001', '3'), (104, '3002', '2'), (105, '3003', '1'), (106, '3003', '2'), (107, '3004', '1'); 以上、よろしくお願いします。
load data local infileでcsvをインポートしているのですが ヘルプなどを見ても特定のフィールドのみを選択する方法がよく分かりません たとえば csv：フィールドA、フィールドＢ、フィールドＣ、フィールドＤ、フィールドＥ、フィールドＦ MySQL：カラム1、カラム2、カラム3、カラム4、カラム5 だとします、それを フィールドA→カラム2 フィールドC→カラム3 フィールドD→カラム4 フィールドF→カラム5 という風に選択したいのですがどういう風に指定したらいいのでしょうか？ よろしくお願いします。
該当レコードなしのときは挿入、該当レコードがあるときは更新する方法を教えてください データベース初心者です 該当レコードなしのときは挿入(INSERT)、該当レコードがあるときは更新(UPDATE)する方法を教えてください。 MySQL 5.0.67 レコードは下記のようになります。 desc table; +----------+----------------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +----------+----------------------+------+-----+---------+-------+ | val1 | smallint(6) | NO | PRI | 0 | | | val2 | smallint(6) | NO | PRI | 0 | | | val3 | smallint(6) | NO | PRI | 0 | | | date_y | char(4) | NO | PRI | | | | date_m | char(2) | NO | PRI | | | | pre | bigint(19) | NO | | 0 | | | now | bigint(19) | NO | | 0 | | +----------+----------------------+------+-----+---------+-------+ 下記のSQL文で更新を行いました。 UPDATE table as c, ( SELECT val1, val2, val3, now FROM table WHERE date_y='2010' and date_m='10' ) as n SET c.pre=n.now, c.now=n.now WHERE c.val1=n.val1 and c.val2=n.val2 and c.val3=n.val3 and c.date_y='2010' and c.date_m='11'; このSQL文をINSERT～ON DUPLICATE KEY UPDATEにした場合、どのようなSQL文になるのかをご教授頂ければ幸いです。 一応、下記URLを参照したのだけど、うまくSQL文が書けませんでした。 12.2.4.3. INSERT ... ON DUPLICATE KEY UPDATE 構文 http://dev.mysql.com/doc/refman/5.1/ja/insert-on … 以上、宜しくお願い致します。
レコードなし、もしくは該当レコードなしでエラーを発生させない方法を教えてください データベース初心者です レコードなしもしくは該当レコードなしの状態で検索を行うとエラーが発生します。 エラーを発生させずに検索を行う方法があれば教えてください。 MySQL 5.0.67 レコードは下記のようになります。 desc table; +----------+----------------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +----------+----------------------+------+-----+---------+-------+ | val1 | smallint(6) | NO | PRI | 0 | | | val2 | smallint(6) | NO | PRI | 0 | | | val3 | smallint(6) | NO | PRI | 0 | | | date_y | char(4) | NO | PRI | | | | date_m | char(2) | NO | PRI | | | | pre | bigint(19) | NO | | 0 | | | now | bigint(19) | NO | | 0 | | +----------+----------------------+------+-----+---------+-------+ 下記のSQL文で検索を行いました。 SELECT t.date_y, t.date_m FROM table t, ( SELECT date_y,max(date_m*1) as date_m FROM table WHERE date_y= ( SELECT max(date_y*1) as date_y FROM table WHERE (now - pre) > 0 ) ) s WHERE t.date_y=s.date_y and t.date_m=s.date_m; レコードなし、もしくは該当レコードがないとWHERE文のdata_yにnullが代入され、 本SQL文でエラーが発生します。 いろいろ調べて「EXISTS」「NOT EXISTS」「NULLIF」を利用するのかな？ と思ったのだけど、下記URLを参照しても、うまくSQL文が書けませんでしたので、ご教授頂ければ幸いです。 6.4.2.6. EXISTS と NOT EXISTS http://dev.mysql.com/doc/refman/4.1/ja/exists-an … 6.3.1.4. フロー制御関数 http://dev.mysql.com/doc/refman/4.1/ja/control-f …
スケジュール管理のできるWEBアプリケーションを作成しようと考えています。 下記構成において、２つのテーブルを連結させるクエリの書き方について教えて頂きたいです。 よろしくお願いします。 ▼DB内容 CREATE TABLE a ( id int primary key autoincrement, year varchar(4), month varchar(2), day varchar(2) ); CREATE TABLE b ( id int （※aテーブルとidで連結させたい） sche1 varchar(10), sche2 varchar(10), sche3 varchar(10), ) ・a +--+----+-----+---+-----+ | id | year | month | day | week | +--+----+-----+---+-----+ | 1 | 2010 | 11 | 20 | 土 | | 2 | 2010 | 11 | 21 | 日 | | 3 | 2010 | 11 | 22 | 月 | | 4 | 2010 | 11 | 23 | 火 | | 5 | 2010 | 11 | 24 | 水 | | 6 | 2010 | 11 | 25 | 木 | | 7 | 2010 | 11 | 26 | 金 | | 8 | 2010 | 11 | 27 | 土 | | 9 | 2010 | 11 | 28 | 日 | | 10 | 2010 | 11 | 29 | 月 | +--+----+-----+---+-----+ ・b +--+-----+------+ | id | sche1| sche2 | +--+-----+------+ | 1 | 空き | 空き | | 2 | 空き | 空き | | 3 | 仕事 | 空き | | 4 | 仕事 | 空き | | 5 | 仕事 | 空き | | 6 | 仕事 | 空き | | 7 | 仕事 | 空き | | 8 | 空き | 空き | | 9 | 空き | 空き | | 10 | 仕事 | 空き | +--+-----+------+ ▼ページ内容 ＜ユーザ側＞日付選択画面 ・calendar.jsp +----------------------+ | << 2010 11月 >> | 日 月 火 水 木 金 土 | ___ _１ _２ _３ _４ _５ _６ | _７ _８ _９ 10 11 12 13 | 14 15 16 17 18 19 20 | 21 22 23 24 25 26 27 | 28 29 30 +----------------------+ ＜ユーザ側＞表示処理画面 ・sche.jsp +----------------------+ |2010 11 23 火 のスケジュール | |sch1 仕事 |sch2 空き | +----------------------+ ＜管理側＞日付選択画面 ・m_calendar.jsp +----------------------+ | << 2010 11月 >> | 日 月 火 水 木 金 土 | ___ _１ _２ _３ _４ _５ _６ | _７ _８ _９ 10 11 12 13 | 14 15 16 17 18 19 20 | 21 22 23 24 25 26 27 | 28 29 30 +----------------------+ ＜管理側＞編集処理画面 ・m_sche.jsp +---------------------------+ |2010 11 23 火 のスケジュール | |sche1 | +--+-----+ | | ▼ | 仕事 | ※←プルダウンメニュー | +--+-----+ | |sche2 | +--+----+ | | ▼ | 空き | | +--+----+ | | | [登録ボタン] | +------------------+ ※ユーザ側の閲覧は携帯端末を考えてます。 ※値の保持や呼び出しは全てDBで管理しようと思います。 ※使用しているのはMySQL5.1です。
table_aに存在するidのうち、table_bには存在しないidを抽出するSLQ文を作成したいと思ったのですが、抽出方法が分からなかったので、アドバイスいただける方がいらっしゃいましたら、ご教示いただけたらと思います。 下記の例では、table_aには、101～106までのidがあるのに対し、table_bには101,102,104のidがあるため、103,105,106を抽出したいと思います。 CREATE TABLE IF NOT EXISTS `table_a` ( `auto_id` int(11) NOT NULL, `id` varchar(7) NOT NULL ) ENGINE=MyISAM DEFAULT CHARSET=utf8; INSERT INTO `table_a` (`auto_id`, `id`) VALUES (1, '101'), (2, '102'), (3, '103'), (4, '104'), (5, '105'), (6, '106'); CREATE TABLE IF NOT EXISTS `table_b` ( `auto_id` int(11) NOT NULL, `id` varchar(7) NOT NULL ) ENGINE=MyISAM DEFAULT CHARSET=utf8; INSERT INTO `table_b` (`auto_id`, `id`) VALUES (1, '101'), (2, '102'), (3, '102'), (4, '102'), (5, '104'), (6, '104'); 以上、よろしくお願いします。
MYSQLで右埋めで指定回数分、半角スペースを埋めることは可能でしょうか？ オラクルでは　RPAD(文字列 , 指定桁数) 　可能ですが、 MYSQLでは？
テーブルを作りたいのですが、思い描くテーブルが作れず、困っています・・・ 例えばMさんがA→B→C→Dと旅行に行ったとします。 そのとき、行った場所によって日付が登録されるようにしたいと思っています。 このように、別な人もいろいろと旅行し、それぞれの日付があり、どんどんと格納していきます。 最初に ID id 日付 date 場所 point （名前はとりあえず、IDとします） でテーブルを作ろうとしましたが、これだとID一つにつき、日付と場所も一つずつしか入りませんよね？ どういったテーブルを作ればいいでしょうか？ 思い描くテーブルは下記のような感じです。 ID 　　　　日付 　　　　　場所 －－－－－－－－－－－－－－ １ 　｜2010/10/06 ｜　 A 　 ｜2010/10/14 ｜　　B 　 ｜2010/10/20 ｜　　C 　 ｜2010/10/25 ｜　　D -------------------------- ２　 ｜2010/10/23 ｜　　B 　 　｜2010/10/24 ｜　　A 　 　｜2010/10/25 ｜　　D 　 　｜2010/10/27 ｜　　C -------------------------- ３　 ｜2010/10/25 ｜　　D 　 　｜2010/10/27 ｜　　C 　 　｜2010/11/03 ｜　　B 　 　｜2010/11/04 ｜　　A 　 　｜2010/11/07 ｜　　D 　 　｜2010/11/10 ｜　　C ------------------------- ４　 ｜2010/11/10 ｜ B 　 　｜2010/11/15 ｜　　A 　 　｜2010/11/16 ｜　　D ・・・・・・・・・・・・・・・ このように一つのIDに対して、日付と場所がランダムの数で格納したいのですが、これって可能でしょうか？ テーブルを２つ（以上）作り、外部キーを使ってもかまいません。 また、足りなければ違うIDなどでカバーしてもかまいません。 実際は、このようなテーブルを作り、一人毎の動線を調べるために活用したいと思っています。 Mさん：今日はAに行って、明日はBに行き、明後日はCに行った。すなわち動線は・・・のような感じです。 SQL文でテーブルを作ってください。 補足事項等ありましたらご指摘下さい。追加いたします。 よろしくお願いします。
MYSQLインストールの最後に添付ファイルのようなエラーが出てしまいます。どういった原因が考えられ、どのような対策をすればよろしいでしょうか。よろしくお願いいたします。 以下エラー内容の英訳 ・接続失敗、セキュリティーはDB適用されないかも ・エラーNr.1045。ユーザアクセスは''localhost'(パスワードを使用します: はい)のために不可 ・パーソナルファイアウォールが起動している。AfterにTCPポート3306を開けなかったの確実に。 ・MYSQLサーバをアンインストールした後に再インストールしているならデータ登録簿は自動的に取り外されませんでした。最後のインストールからの古いパスワードがサーバ接続にまだ必要
以下のようなbatでunhex(`idm`)を使って変換しているのですが、出力されるデータが他のところも変換されて出力されます。どうしてでしょうか？ characterの設定か、SQLがだめなのでしょうか？ ECHO OFF SET MYSQLPATH="C:\Program Files\MySQL\MySQL Server 5.0\bin" SET character SET sjis;>create_sql.sql ECHO select unhex(`idm`),a.emp_code,a.emp_name_kana from a,b where b.emp_code=a.emp_code into outfile "C:/master.csv" fields terminated by ',';>>create_sql.sql %MYSQLPATH%\mysql.exe -u root -proot test<create_sql.sql exit
ＭＹＳＱＬでSELECTして以下のテーブルのＣＯＤＥカラムからバイナリーデータに変換してデータを取得したいのですが、どうしたら良いでしょうか？ SELECT CODE FROM TABLE_NEME WHERE ID='XXX' ＜テーブルデータ＞　ＣＯＤＥ（varchar型） 011A00046D0ADC4B
以下のようなテーブルがあります。 IDとnameは複合ユニークキーとなっています。 ID | name 1 | foo 2 | foo 1 | bar 3 | foo 2 | hoge 3 | bar このテーブルから、nameにfooとbar両方を持つIDを抜き出すSQL文が分からずに困っています。 つまり、fooとbarで検索するとID 1とID 3が、fooとhogeで検索するとID 2がヒットするようなSQL文を知りたいのです。 初歩的な質問なのかもしれませんが、どうしてもSQL文が思いつかず大変困っています。 どうぞよろしくお願いします。
いつもお世話になってます。 PHP＋MySQLを使用しています。 下記のような操作を行いたいのですが、 MySQL文を教えて頂けませんでしょうか。 table名：person person_id : name : email 1 : tanaka : aaaaa 2 : suzuki : bbbbb 3 : sato : ccccc 4 : saito : ddddd 5 : takahasi : eeeee 上記のようなテーブルがあったとして、 例えば、person_idが2,4のものを抽出して、 table名：sendmail send_id : name : email : ticket 1 : ito : fffff : 10-20 2 : huruka : eeeee : 11-01 3 : suzuki : bbbbb : 11-19 4 : saito : ddddd : 11-19 上記テーブルに追加(send_idの3,4）したいのです。 ticketカラムは、send_idの3,4で同じ値(文字列)を使います。 SQL文だと、 INSERT INTO sendmail (name,email,ticket) SELECT name,email,'11-19' FROM person WHERE person_id IN ( 2 , 4 ) で大丈夫なのはわかりました。 これをプリペアドクエリに変換する方法がわかりません。 $para01="11-19"; $para02="2,4"; $db = new mysqli("xxxxx","yyyyy","zzzzz","wwwww"); $presql = $db->prepare("INSERT INTO sendmail (name,email,ticket) SELECT name,email,? FROM person WHERE person_id IN ( ? )"); $presql->bind_param("ss",$para01,$para02); $presql->execute(); 上記で実行してみましたが、$para02は"2"と判断されて、 table名：sendmail send_id : name : email : ticket 1 : ito : fffff : 10-20 2 : huruka : eeeee : 11-01 3 : suzuki : bbbbb : 11-19 になります。（person_idが4のものが抽出されない。） 大変お手数ですが、上記内容にてご教授願います。
いつもお世話になってます。 PHP＋MySQLを使用しています。 下記のような操作を行いたいのですが、 MySQL文を教えて頂けませんでしょうか。 table名：person person_id : name : email 1 : tanaka : aaaaa 2 : suzuki : bbbbb 3 : sato : ccccc 4 : saito : ddddd 5 : takahasi : eeeee 上記のようなテーブルがあったとして、 例えば、person_idが2,4のものを抽出して、 table名：sendmail send_id : name : email : ticket 1 : ito : fffff : 10-20 2 : huruka : eeeee : 11-01 3 : suzuki : bbbbb : 11-19 4 : saito : ddddd : 11-19 上記テーブルに追加(send_idの3,4）したいのです。 ticketカラムは、send_idの3,4で同じ値(文字列)を使います。 大変お手数ですが、上記内容にてご教授願います。
ttp://dev.mysql.com/doc/refman/5.1/en/connector-cpp.html MySQL Connector/C++についてなんですが、 Connector/Cでいう mysql_options(&mysql, MYSQL_SET_CHARACTER_NAME, "sjis") に相当するものは無いでしょうか? sjisで文字を扱いたいんですが…
いつもお世話になっております。 ウェブサイトを作っているのですが、以下のようなデータを表示するのに良いSQL文が分からず悩んでいます。 ID | DATE　　　　 | DATA --+----------+----- 1 | 2010-11-11 | aaa 2 | 2010-11-11 | bbb 1 | 2010-11-10 | ccc 3 | 2010-11-12 | ddd 3 | 2010-11-11 | eee 4 | 2010-11-10 | fff 1 | 2010-11-12 | ggg 2 | 2010-11-12 | hhh 1 | 2010-11-12 | iii 3 | 2010-11-12 | jjj 1 | 2010-11-09 | kkk 1 | 2010-11-09 | lll 1 | 2010-11-08 | mmm 1 | 2010-11-08 | nnn 1 | 2010-11-07 | ooo 1 | 2010-11-07 | ppp 1 | 2010-11-06 | qqq 3 | 2010-11-05 | rrr 2 | 2010-11-13 | sss 5 | 2010-11-08 | ttt 6 | 2010-11-05 | uuu 7 | 2010-11-04 | vvv 8 | 2010-11-03 | www 9 | 2010-11-02 | xxx 10| 2010-11-01 | yyy 11| 2010-10-30 | zzz 上のようなテーブルから、各IDを10件まで日付順に取り出すことはできるでしょうか？ 具体的には、1つのページに以下のように表示したいのです。 2 | 2010-11-13 | sss 2 | 2010-11-11 | bbb 1 | 2010-11-12 | ggg 1 | 2010-11-11 | aaa 1 | 2010-11-10 | ccc 1 | 2010-11-12 | iii 1 | 2010-11-09 | kkk 1 | 2010-11-09 | lll 1 | 2010-11-08 | mmm 1 | 2010-11-08 | nnn 1 | 2010-11-07 | ooo 1 | 2010-11-07 | ppp 3 | 2010-11-12 | ddd 3 | 2010-11-11 | eee 3 | 2010-11-05 | rrr 4 | 2010-11-10 | fff 5 | 2010-11-08 | ttt 6 | 2010-11-05 | uuu 7 | 2010-11-04 | vvv 8 | 2010-11-03 | www 9 | 2010-11-02 | xxx 10| 2010-11-01 | yyy ・各IDのうち、最も新しい日付のものが上にくる ・表示するIDは10件まで ・表示はIDごとにまとめて行う ・一つのIDに属するデータは10件までしか取り出さない 上記のことを実現する方法をご教授ください。 よろしくお願い致します。
現在、MySQLにて日時情報を文字列として格納しているのですが、 日時の計算を行うために、datetime型に変換した上で 格納しなおしたいと考えています。 どのようにすれば良いでしょうか？ よろしくお願い致します。
MysqlとPHPを使用して、データーベースのテーブルの 同じ行に11と12のペア(id1,id2のどちらかに11か12が入っていたらよい)が いくつ入っているか調べたいのですがどのようにしたらいいのでしょうか？ 下のテーブルだったら11と12のペアは2件と表示したいのですが… 一応、COUNTを使うのではと思っているのですが条件文が思い浮かびません。 回答お待ちしています。 ------------ id1 | id2 ------------ 11 | 12 22 | 23 33 | 34 12 | 11
テーブル名：table1 name | email | date ------+------------+------------- tanaka | aaaaaaaaaaa | 2010-11-01 sato | aaaaaaaaaaa | 2010-11-15 suzuki | bbbbbbbbbbb | 2010-11-10 上記のようなテーブルがあった時、同じemailの場合、 日付の新しいカラムで抽出して、下記の様な結果を得たいです。 name | email | date ------+------------+------------- sato | aaaaaaaaaaa | 2010-11-15 suzuki | bbbbbbbbbbb | 2010-11-10 この様な結果を得る為のMySQL文を教えて下さい。 初歩的な質問で申し訳ありません。お願い致します。
CentOS5.3 + ｐｈｐ5.1.6 + MySQLServer version: 5.0.77の環境です。 下記のスクリプトを書きましたが、点数を書いてsubmitすると、「登録できませんでした」が表示され、データの書き込みができません。 var_dump($sql); で＄ｓｑｌの内容も表示されますし、echo($conn)　も Resource id #2が返ります。 .MYD, .MYI,.frm のパーミッションは777です。 どこが不具合の原因でしょうか？　データを登録するためには、どのように修正すれば良いでしょうか？　ご教示願えれば幸甚です。 [tensuform.php] <HTML><BODY> <H1 ALIGN="CENTER">点数</H1> <TABLE BORDER="1" ALIGN="CENTER" CELLSPACING="0"> <FORM action="tensuinst.php" METHOD ="POST"> <TR><TD BGCOLOR="#CCCCCC">点数</TD> <TD><INPUT TYPE="TEXT" NAME="tensu" value="" maxlength="3"></TD></TR> <INPUT TYPE="SUBMIT" NAME="SUBMIT" VALUE="　書　込　"> <INPUT TYPE="RESET" VALUE="　ク リ ア　"></TD> </TR></TABLE></FORM></BODY></HTML> [ tensuinst.php] <HTML><BODY> <?php $tensu=$_POST['tensu']; print $tensu."<br/>"; if($tensu ==" "){ echo ("点数が書き込まれていません。"); ?> <a href="tensupoform.php">"こちらからデータを書き込んで下さい。"</a><BR> </BODY></HTML>); <?php exit(); }elseif(!$conn = mysql_connect('localhost', "abcd", "efgh")){ die("データベース接続エラー.<br />"); }else{ mysql_select_db("wxyz", $conn); $sql = "INSERT INTO kokugo('tensu') VALUES('$tensu')"; // var_dump($sql); echo("<br>"); // echo($conn)."<br>"; mysql_query($sql, $conn) or die("登録できませんでした" ); mysql_close($conn); print("登録しました。"); } ?>
利用サーバ：さくらインターネットのレンタルサーバ 利用データベースのバージョン：MySQL 5.1 PHPのバージョン：PHP 5.2.×× PHPMyAdminに記載のMySQL の文字セット: UTF-8 Unicode (utf8) PHPMyAdminに記載のMySQL 接続の照合順序: utf8_general_ci htmlやPHPファイルを、EUC-JPからUTF-8に、全て変えたためなのかは分かりませんが、 データベースに格納されている日本語（というか全角文字？）データを、 PHPで取り出せなくなってしまいました。半角英数字のデータは取得できます。 そのためDBから取得して表示させている文字データのうち、日本語のみが表示されません。 【php.iniファイルの中身】 register_globals = "On" mbstring.language = "Japanese" mbstring.internal_encoding = "UTF-8" mbstring.encoding_translation = "On" default_charset = "UTF-8" output_buffering = "Off" mbstring.http_input = "auto" mbstring.http_output = "pass" mbstring.detect_order = "auto" mbstring.substitute_character = "none" 情報は足りますでしょうか？どなたか、よろしくお願いいたします。
あるカラムにUNIQUE制約を設定するのとUNIQUE INDEXを設定するのとでは何がどうちがうのでしょうか？
Create Eventで１秒毎に繰り返し、更新を行うようなイベントを作成したいのですが、 下記のようにSQLを記述しましたが、実行されていないようです。 mysql.eventテーブルを調べてみたところ、startsが９時間ずれています。 単純に、select NOW()で時間を見てみると時間はずれていないのですが、 Create Event内でNOW()関数を使うとずれてるようです・・・・ 解決策がわからず困っております。 ご教授の程よろしくお願いします。 mysql> Create Event Test.MyEvent On Schedule Every 1 SECOND STARTS NOW() Do Update Test.TestTable Set b = b + 1 Where a = 2; Query OK, 0 rows affected (0.00 sec) mysql> select * from mysql.event\G *************************** 1. row *************************** db: Test name: MyEvent body: Update Test.TestTable Set b = b + 1 Where a = 2 definer: root@localhost execute_at: NULL interval_value: 1 interval_field: SECOND created: 2010-11-16 22:44:32 modified: 2010-11-16 22:44:32 last_executed: NULL starts: 2010-11-16 13:44:32 ends: NULL status: ENABLED on_completion: DROP sql_mode: comment: originator: 0 time_zone: SYSTEM character_set_client: utf8 collation_connection: utf8_general_ci db_collation: utf8_general_ci body_utf8: Update Test.TestTable Set b = b + 1 Where a = 2 1 row in set (0.00 sec) mysql> select NOW(); +---------------------+ | NOW() | +---------------------+ | 2010-11-16 22:44:32 | +---------------------+ 1 row in set (0.00 sec)
MySQL 5.1の CHAR(M)型のMは「文字数」でしょうか？それとも「バイト数」でしょうか？ 教えて頂けませんか？ 自分の認識では「文字数」と思っているのですが、下記のような現象が発生しております。 mysql> mysql> mysql> mysql> mysql> SHOW CREATE TABLE TEST\G; *************************** 1. row *************************** Table: TEST Create Table: CREATE TABLE `TEST` ( `MOJI` char(6) DEFAULT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8 1 row in set (0.01 sec) ERROR: No query specified mysql> mysql> SELECT * FROM TEST; Empty set (0.00 sec) mysql> mysql> INSERT INTO TEST (MOJI) VALUES ('ああああ'); Query OK, 1 row affected, 1 warning (0.00 sec) mysql> mysql> SELECT * FROM TEST; +--------+ | MOJI | +--------+ | ああ | +--------+ 1 row in set (0.00 sec) mysql> mysql> INSERT INTO TEST (MOJI) VALUES ('abcdef'); Query OK, 1 row affected (0.00 sec) mysql> mysql> SELECT * FROM TEST; +--------+ | MOJI | +--------+ | ああ | | abcdef | +--------+ 2 rows in set (0.00 sec) mysql> mysql> mysql> mysql> 環境はCentOS 5.5 で、OSの文字コードもMySQLの文字コードも「utf8」としています。 どうかご教授下さい。
phpMyAdmin テキストインポートエラー いつもお世話になっております。 php,MySQL,phpMyAdmin 初心者です。 ゆうちょ銀行のHPから郵便番号データを入手し、phpMyAdminを利用してMySQLへインポートしたいのですが、 エラーになってしまいます。 ●環境・設定 phpMyAdmin-2.11.6 MySQL 5.0.45 MySQL の文字セット: UTF-8 Unicode (utf8) ■実行手順 (1)郵便番号データ入手 (2)Access2003にインポート（テーブル化） (3)必要フィールドを選択しテキスト変換（エクスポート） (4)テキストをUTF-8で保存 (5)phpMyAdminのインポート機能を実行 (6)結果（以下エラー内容） 実行した SQL: "2770023", "チバケン", "カシワシ", "チュウオウ", "千葉県", "柏市", "中央" "2770831", "チバケン", "カシワシ", "ネド", "千葉県", "柏市", "根戸" MySQLのメッセージ: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '"2770023","ï¾ 何か良い解決策がありまいたらご教授いただければと思います。 宜しくお願い致します。
SQLiteの中身を見たいと思って、ファイルを開いたら、文字化けしてるような感じでした。 しょうがないので、PHPで動くGUIツールをインストールして、 中身を確認することはできたのですが、 どうしてDBファイルの中身を、直接見ることはできないのでしょうか？ DBを作成するってことは、コンパイルか何かをしているのでしょうか？ また、GUIツールを経由すれば、なんで見れるのでしょうか？ そこでは、どんな処理が行なわれているのでしょうか？
１つのSQLにしたいです 以下のSQLを1つにしたいです。 select a, b, c, '1' event_type from sample where type = '1' select a, b, c, '2' event_type from sample where type = '2' select a, b, c, '3' event_type from sample where type = '3' ポイントはselect分に結果によって'1'、'2'、'3'といれたいです。 初心者的質問で申し訳ありません。 よろしくお願いします。
下記のような３種類のテーブルがあります。 これを集計して、指定したユーザーの指定月のアクセス日時と売上げ金額を表にしたいと思っています。 こんな感じに。 +--+--------+----------+-------+-----+ | id | username| date 　 | access | sales | +--+--------+----------+-------+-----+ | 1 | admin | 2010-11-13 | 　 2 |　5000 | | 1 | admin | 2010-11-14 | 　 2 |　5000 | | 1 | admin | 2010-11-15 | 　1 | 20000 | +--+--------+----------+-------+-----+ SELECT u.id AS id, u.username, DATE(a.created_at) AS date, COUNT(*) AS access, SUM(s.amount) AS sales FROM sf_guard_user u INNER JOIN sales s ON u.username = s.user_id LEFT JOIN access_log a ON u.username = a.user_id WHERE (u.username = 'admin' AND a.created_at > '2010-11-01 00:00:00' AND a.created_at < '2010-11-30 23:59:59') GROUP BY date ORDER BY a.created_at; とやってみたのですがダメでした；； ■ユーザー情報テーブル mysql> select id,username from user; +--+---------+ | id | username | +--+---------+ |　1 | admin 　　| +--+---------+ ■アクセスログテーブル mysql> select * from access_log; +--+-------+--------+------------------+ | id | user_id | ip　　　　 | created_at　 　　　　| +--+-------+--------+------------------+ |　1 | admin　 | 127.0.0.1 | 2010-11-13 21:56:54 | |　2 | admin　 | 127.0.0.1 | 2010-11-13 21:56:54 | |　3 | admin　 | 127.0.0.1 | 2010-11-14 21:56:54 | |　4 | admin　 | 127.0.0.1 | 2010-11-14 21:56:54 | |　5 | admin　 | 127.0.0.1 | 2010-11-15 21:56:54 | +--+-------+--------+------------------+ ■売上げ金額テーブル mysql> select * from sales; +--+-------+------+------------------+ | id | user_id | amount| created_at　 　　　　| +--+-------+------+------------------+ |　1 | admin　 |　 5000 | 2010-11-13 21:56:54 | |　2 | admin　 |　 5000 | 2010-11-14 21:56:54 | |　3 | admin　 |　 5000 | 2010-11-15 21:56:54 | |　4 | admin　 |　 5000 | 2010-11-15 21:56:54 | +--+-------+------+------------------+
SQLの得意な皆様、教えてください！ 以下のようなデータがあったときに、mysqlで1回で期待するデータを出力することは可能なのでしょうか。 出力したいデータは、name毎に最もdateが最近のデータを抽出したいです。 groupby句やDISTINCTを試して、nameでまとめる作業はできたのですが、各nameの最も最近のデータを抽出する作業がうまくいきません。 ■入力データ(input_date) id,name,date 1,userA,10/29 2,userB,10/27 3,userA,10/25 4,userB,10/28 5,userC,10/2 ■出力したいデータ id,name,date 1,userA,10/29 4,userB,10/28 5,userC,10/2
アクセス集計について困っています。 mysql> desc access_log; +------------+-------------+------+-----+---------+----------------+ | Field | Type | Null | Key | Default | Extra | +------------+-------------+------+-----+---------+----------------+ | id | bigint(20) | NO | PRI | NULL | auto_increment | | user_id | varchar(50) | YES | | NULL | | | ip | varchar(15) | YES | | NULL | | | created_at | datetime | NO | | NULL | | | updated_at | datetime | NO | | NULL | | +------------+-------------+------+-----+---------+----------------+ 5 rows in set (0.02 sec) mysql> select * from access_log; +----+---------+-----------+---------------------+---------------------+ | id | user_id | ip | created_at | updated_at | +----+---------+-----------+---------------------+---------------------+ | 1 | admin | 127.0.0.1 | 2010-11-13 21:56:54 | 2010-11-13 23:07:27 | | 2 | admin | 127.0.0.1 | 2010-11-13 21:56:54 | 2010-11-13 23:07:27 | | 3 | admin | 127.0.0.1 | 2010-11-14 21:56:54 | 2010-11-13 23:07:27 | | 4 | admin | 127.0.0.1 | 2010-11-14 21:56:54 | 2010-11-13 23:07:27 | | 5 | admin | 127.0.0.1 | 2010-11-15 21:56:54 | 2010-11-13 23:07:27 | +----+---------+-----------+---------------------+---------------------+ 5 rows in set (0.00 sec) 上記のように定義したテーブルがあります。 SELECT a.id, a.user_id, COUNT(*), DATE(a.created_at) AS date FROM access_log a WHERE (a.user_id = 'admin' AND a.created_at > '2010-11-01 00:00:00' AND a.created_at < '2010-11-29 23:59:59') GROUP BY date ORDER BY a.created_at; のようにして日別のアクセス数の集計をしています。 ここから、同じ日の同一IPのアクセスは1アクセスとして計算したいのですが、 どのようにSQLを書けばよいでしょうか？ よろしくお願いいたします。
お世話になっております。UNIONについて伺いたいことあり質問させていただきます。（MySQL5.1系） 2つのテーブルがあり、縦に？検索したくUNIONを使ってSQL文を作ってみました。 この検索対象となる2つのテーブルは構成も違えば、カラム名も違うのですが、 SELECT　name,　address　FROM　member UNION SELECT　c_name,　c_address　FROM　class とこのようにしたら欲していた結果を得ることが出来ました。 そ、ここで質問なのですが、今回、UNIONを使うのは初めてなのですが、色々と調べていると、 UNIONを使うときは、カラム名が同一なものが条件のように書かれているものが多くあり、 多くのサイトのサンプルソースを見てみると、以下のようにカラム名が同一なものばかりと、 そんな印象があるのですが、UNIONを使う場合は、カラム名が同一でないと駄目なのでしょうか？ SELECT　name,　address　FROM　member UNION SELECT　c_name,　c_address　FROM　class また、もう1点伺いたいのですが、UNIONを使い、ORDER BYを場合、以下のように SELECT文ごとにカッコで括るとも調べたのですが、結果は何も変わらない状態になっています。 (SELECT　no,　name,　address　FROM　member　ORDER　BY　no　desc) UNION (SELECT　c_no,　c_name,　c_address　FROM　class　ORDER　BY　c_no　desc) 上記にあるように、テーブル名classのORDER　BY　c_no　descが利くようにするには どのようにすべきなのでしょうか？ お忙しい中恐縮ですが、宜しくお願い申し上げます。
AのSQLでヒットし、BのSQLでヒットしないレコードを抽出したいと思います。 イメージとしては、内線(tel)30..のみを使用している社員(employee)を抽出したいと思います。 【AのSQL(内線(tel)30..を使用している社員(employee))】 SELECT `employee` FROM `w_table` WHERE `tel` REGEXP '30..' 【AのSQLの結果】 employee 10001 10001 10002 10002 【BのSQL(内線(tel)30..以外を使用している社員(employee))】 ※※※１．ここの書き方が分かりません。※※※ 【BのSQLの結果】 employee 10001 10003 【CのSQL(AのSQLを満たし、BのSQLを満たさない社員)】 ※※※２．ここの書き方が分かりません。※※※ 【CのSQLの結果】 employee 10002 上記の場合、 社員番号10001は内線30..と内線30..以外を使用しています。 社員番号10002は内線30..のみを使用しています。 社員番号10003は内線30..以外を使用しています。 この場合、社員番号10002のみを抽出したいと思います。 その為、【CのSQL】を記述しようと思ったのですが、 どのように SQL 文を記述すればよいか分からなかったので、 記述方法についてアドバイスいただける方がいらっしゃいましたら、 ご教示の程、よろしくお願いします。 なお、【AのSQL】【BのSQL】を書かず、 直接【CのSQL】一回で済む物であれば非常に助かります。 以上、よろしくお願いします。
なぜ MySQL の substring は、 1 からなのでしょうか？ perl や php は、 0 からですよね？
ADOを利用したデータベース接続についてなのですが たとえばcsvファイルにアクセスする場合以下の三つのやり方があると思います。 Connectionのopenメソッドに １． "Provider=Microsoft.Jet.OLEDB.4.0;...." とOLEDBプロバイダ名を指定する接続文字列を使う方法 2． "Driver={Microsoft Text Driver (*.txt; *.csv)}....." とODBCドライバを指定する接続文字列を使う方法 3.. "DSN=[データソース名]......" とODBCのデータソース名を指定する方法 この三つの処理の違いがわかりません。 特に2.と3.の違いがまったくわかりません。 どなたか詳しい方、教えていただけませんか？
MYSQLのユーザ作成についてご質問させて頂きます。 管理者権限のあるユーザにてmysqlデータベースに接続し、 /usr/bin/mysql mysql -u admin -D mysql -p ユーザを作成しました。 GRANT SELECT,INSERT,UPDATE,DELETE,CREATE ON DB名.* TO ユーザ名@localhost IDENTIFIED BY 'パスワード'; さまざまなサイトに記載されているとおり FLUSH PRIVILEGES; も行い、ユーザ一覧を確認してみると select * from mysql.user \G 権限が付与されていません。 Select_priv: N と表示されています。 エラー文が出てくるわけではないのでエラーではないと思いますが なぜなのでしょうか？ ご教示ください。 よろしくお願い致します。
Mysqlレプリケーションは負荷分散というより冗長化だと思いますが、では負荷分散をするにはどのような方法が一般的でしょうか？スケールアップしかないのでしょうか？ （スケールアウトするにはデータの整合性にかなり難があるように思えます。） Webアプリの対象はポータルサイトです。YahooやGoogleはどのように対策しているのでしょう？
mysql でdate型のフィールド「UPDATE_DATE」があり、 このフィールドの日数が、現在から14日以上前だったら 「FLAG」フィールドを0にしたいと思っております。 どなたかご教授ください。 宜しくお願いいたします。 mysql> select*ARTICLE; +-----+---------------------+------+ | UPDATE_DATE | FLAG | +---------------------+------+ | 2007-07-05 14:35:35 | 1 | | 2007-07-05 14:42:20 | 5 | | 2008-07-06 00:01:20 | 12 | | 2009-07-06 13:38:16 | 13 | | 2009-07-06 13:47:45 | 13 | | 2011-07-06 13:54:10 | 2 | +---------------------+------+
下記のテーブルの中で、 no1 フィールドが重複していない列(この場合ですが、200003のみ)を抽出したいのですが、どのような sql 文を書けば良いか分かりませんでした。 その為、このような場合、どのような sql 文を書けば良いかご存知の方がいらっしゃいましたら、 ご教示の程、よろしくお願いします。 【w_tblテーブル】 ―――――――――― ｜key｜ no1 ｜no2｜ ―――――――――― ｜1　｜200001｜1　｜ ｜2　｜200002｜1　｜ ｜3　｜200001｜2　｜ ｜4　｜200002｜2　｜ ｜5　｜200001｜3　｜ ｜6　｜200003｜2　｜ ―――――――――― 【SQL文】 SELECT `no1` FROM `w_tbl` 【結果】 200001 200001 200001 200002 200002 200003 【SQL文】 SELECT DISTINCT `no1` FROM `w_tbl` 【結果】 200001 200002 200003 【SQL文】 ※※※ここの書き方が分かりません。※※※ 【結果】 200003 以上、よろしくお願いします。
"where旬"　てなんて読むのでしょうか？
mysqlのmatch() against()で検索結果が取得できません。 select * from fulltexttable where match( a )　against( '+ほげ' in boolean mode ) で検索結果は0件ですが、 select * from fulltexttable where a like '%ほげ%' だと検索結果は取得できます。 aカラムにはフルテキストインデックスは貼ってあります。 mysqlのバージョンは5.0.77 hogeテーブルはMyISAM どなたか助けてください。
ストアドプロシージャでトランザクション処理をするにはどうすれば良いのでしょうか？ 複数のテーブルの行をストアドプロシージャで一括削除したいのですが、 エラーが発生した場合は、ロールバックしたいと思っています。 たとえば、 create table A (id INT, name VARCHAR(32)); // idと名前を持つテーブルA create table B (id INT, address TINYTEXT); // idと住所を持つテーブルB の二つのテーブル（idで紐付け）で、 Aの行が削除されたらBの行を削除するが、Bの削除でエラーが出た場合はAの削除をロールバックする。 という処理を行いたいのです。（ロールバックが可能であれば、ストアドプロシージャでなくても構いません。） どのように書けば良いのでしょうか？ よろしくお願いします。
MySQLのインデックスの使い方を教えてください。 どうやら、検索性を上昇させるためのもののようですが… phpMyAdminで「構造」タブを開くと、【ユニーク】【インデックス】【全文】というアイコンがありますよね。 【ユニーク】を押すと 種別　　　　：BTREE ユニーク　　：はい 圧縮　　　　：いいえ フィールド　：(チェックを入れた各フィールドの名前) 一意な値の数：(チェックを入れたうち、なぜか最後のフィールドだけはレコード数が表示されるけど、他のフィールドは0になる。どれかひとつをキー的に扱えば充分ということでしょうか。どれでも大して変わらない？) 照合順序　　：A 【インデックス】を押すと 種別　　　　：BTREE ユニーク　　：いいえ 圧縮　　　　：いいえ フィールド　：(チェックを入れた各フィールドの名前) 一意な値の数：0 照合順序　　：A 【全文】を押すと 種別　　　　：FULLTEXT ユニーク　　：いいえ 圧縮　　　　：いいえ フィールド　：(チェックを入れた各フィールドの名前) 一意な値の数：0 となるようですが… (インデックス名は、チェックを入れたフィールドのうち先頭にあるものの名が勝手に採用されますが、後から変更できるみたいですね) 「複数のフィールドにいっぺんにチェックを入れてからアイコンを押す」のと、「ひとつのフィールドずつアイコンを押す」ので結果が違って、なんだか気持ち悪いです。 バラバラのインデックスを作るのと、ひとつのインデックスにまとめるのでは、どう違うのでしょう？ 普通はどうするものでしょうか？ 例えば no　ryaku　　cctld　　ei　　　seisiki 1　日本　　　.jp　　japan　　日本国 2　アメリカ　.us　　U.S.A　　アメリカ合衆国　　　 3　中国　　　.cn　　China　　中華民主主義人民共和国 のように、すべて（あるいはほとんど）のフィールドが一意である場合の例が知りたいです。
Web系の仕事‥ Web系の仕事について、近い将来Webデザイナー・Webプログラマーとして働きたいと思っています。 バイトする傍ら素人からの出発なので、勉強するに当たり低コスト且つ、無駄の無い最短ルートの勉強法が知りたいです！ 出来るだけ経験者様、（現在Web系の仕事をされている方！）の回答が多くほしいです！
行と列の入れ替え検索（行は可変で項目を固定にしたい）のSQL文が出来ない 以下のテーブルがあります。 ＜テーブルA> UID　　name --------------- 1　　　伊藤 2　　　鈴木 3　　　高橋 4　　　佐藤 ＜テーブルB＞ no　UID　key　　　value ------------------- 1　　1　　telno　　001-01-0001 2　　1　　faxno　　001-01-0002 3　　1　　nickname　itochan 4　　2　　telno　　111-11-1111 5　　2　　faxno　　111-11-1112 6　　3　　nickname　hashi この２つのテーブルがあります。 ・テーブルAにあるUIDはテーブルBにない場合もあります。 この場合、以下のように出力して、csvファイルにしたいのですが、可能でしょうか？ 申し訳ありませんが、よろしくアドバイスお願いいたします。 UID　　name　　telno　　　　faxno　　　　　nickname ------------------------------------------------- 1　　　伊藤　　001-01-0001　001-01-0002　　itochan 2　　　鈴木　　111-11-1111　111-11-1112 3　　　高橋　　　　　　　　　　　　　　　　　　hashi 4　　　佐藤 （経緯：wordpressのユーザの一覧(users,usetmetaテーブル)をユーザ一覧としてCSV形式にして保管したいのです。抽出＆登録できるプラグインがなかったので）
まとめてUPDATEしたいのですが。 下記のようなUPDATE文を実行したいのですが、思ったとおりの動作をしません。 UPDATE table1 AS TB1 INNER JOIN table2 AS TB2 ON TB1.table2_id=TB2.id SET TB2.point = TB2.point - TB1.remainder_point, TB1.remainder_point = 0 WHERE TB1.remainder_point > 0 最初の1レコード目だけ「TB2.point = TB2.point - TB1.remainder_point」が実行されますが、 その後のレコードが「TB1.remainder_point = 0」で値が全て0になるらしく、減算処理が行われません。 上手くまとめて実行できる良い書き方は無いでしょうか。
さくらマネージドサーバーで　PHPスクリプトを動かしているんですが、 文字化けして困っています。 プラウザでは表示の切り替えで文字エンコーディングをUTF-8にすれば文字化けしないので正常に稼動していると思います。 普通に日本語（SIFT-JISなど)でみたいと思ってます。 PHPの文字コードはUnicode(UTF-8)です。 さくらのサーバは基本ECU-JPと聞いておりますが、 データベースごとに文字コードを設定しており、もちろんUTF-8にしております。 どうすればいいでしょうか？ どなたか詳しく教えていただけないでしょうか？ よろしくお願いします。
SELECT文で、指定カラム以外の全カラムを一括指定って可能でしょうか？ MYSQLサーバのバージョンは5.0.77です。 下記のように「*」を使用して指定テーブルの全カラムを表示する方法がありますが、 SELECT TableName.* FROM TableName 上記の逆で、指定テーブルの指定カラム以外の全カラムを一括指定って可能でしょうか？ 例えば下記のような「^」みたいな、又は同等な書き方があれば良いなと思ってまして。 SELECT TableName.^ColumnName1 FROM TableName ちなみに、下記のように一つ一つ表示したいカラムを指定する方法以外です。 SELECT TableName.ColumnName2 , TableName.ColumnName3 FROM TableName よろしくお願いします。
SQLiteでご教示願います。 DB(MyTable)を 商品名(Koumoku) | 価格(Nedan) | 登録日付(Hizuke) の項目で記録していると仮定して、１日分だけのデータを取り出す際、 もし、今日が2010年10月26日なら select sum(価格) from MyTable where Koumoku ='商品名（ごはん等）' and Hizuke = '2010-10-26' とすれば１日分取得できますが、 日々１日分だけ取得して表示したいと思っています（26日だけ、27日だけと１日から３０日まで）。 そのため、'2010-10-26'の部分をPC等のシステムの日付から取得するようにしたいのですが、date(now)等を使ってもうまく行きません。 よろしくお願いいたします。
sqlについて質問です。 「timeカラムの新規５件以外を削除する」 というsqlを書きたいのですが、どのように書けばよいのでしょうか。 delete from [table] where time != tile desc limit 5 はちょっと違いますよね・・・
PHPとMySQLを使い、画像データベースを構築しています。 以下までできたのですが、SQL syntaxエラーが発生してしまい、UP出来ませんでした。 画像を指定しない場合は、成功します。 <form method="post" action="addinfo.php" enctype="multipart/form-data"> Place Name(*)<br> <input type="text" size="50" maxlength="100" name="place_name"><br> Address(*)<br> <input type="text" size="50" maxlength="100" name="address"><br> Pictures<br> <input type="file" size="50" name="picture1"><br> <input type="file" size="50" name="picture2"><br> <input type="file" size="50" name="picture3"><br> <input type="reset" value="Reset" name ="reset"> <input type="submit" value="Submit" name="submit"> </form> <?php if ($_POST["submit"] != "") { // Connecting DB require 'lib.php'; //img1 if ($_FILES["picture1"]["tmp_name"] != NULL) { $fp = fopen($_FILES["picture1"]["tmp_name"], "rb"); if (!$fp) { print("Cannot open the uploaded file <BR>\n"); exit; } $img1 = fread($fp, filesize($_FILES["picture1"]["tmp_name"])); fclose($fp); } ----------------------------------------------------------- img2, img3についての処理もimg1と同じなので、文字数の関係で省略します ----------------------------------------------------------- // Insert Query $sql = "INSERT INTO places (place_name, address, `picture1`, `picture2`, `picture3`) VALUES('{$_POST["place_name"]}','{$_POST["address"]}', '{$img1}', '{$img2}', '{$img3}') "; $result = mysql_query($sql); if (!$result) { print("QUERRY ERROR<BR>\n"); print(mysql_errno() . ": " . mysql_error() . "<BR>\n"); exit; } echo "UPLOAD SUCCESSFULL "; ご教授お願いいたします
xampp（php,apache,mysql)で勉強しています。 データーベースにつなぐときに、コマンドプロンプトやphpmyadminから接続すると つなぐことができるのですが、phpのソースからmysqlに接続しようとすると、 Access denied for user 'ODBC'@'localhost' とのエラーがでます。 grantコマンドを使って権限の設定はしています。どうすればエラーが出なくなる でしょうか？
データベース名を変更する方法を教えてください。 バージョンは、5.1.41です。 RENAME は試しましたが、このバージョンでは既に削除されているらしく、うまくいきませんでした…
CentOS(Linux)上の/var/lib/mysqlディレクトリ上（MySQLデフォルトのデータディレクトリ）へ、 CSVファイル「Test.csv」(文字コードWindows-31J(CP932))を、 アップロードしてから、 以下のJavaプログラム（エラー処理内容だけは省略していますが・・・） 　↓ final Runtime rt = Runtime.getRuntime(); final Process pr = rt.exec("chown mysql:mysql" + " " + "/var/lib/mysql/Test.csv"); try { pr.waitFor(); final int intRet = pr.exitValue(); if (intRet != 0) { return; } } catch (final Exception ex2) { return; } を実行して、 アップロード後の「Test.csv」ファイルの「所有者」、および「グループ」を、 元々の「root」から、「mysql」に変更させて、 その後、 MySQLコマンドの「LOAD DATA INFILE」を実行すると、 なぜか、 以下のエラーが発生します。 　↓ java.sql.SQLException: Access denied for user 'SYSASA'@'localhost' (using password: YES) なお、別のやり方として以下のテストも試してみました。 　↓ 上記のJavaプログラムを実行せずに、 アップロード後のファイルを直接、 CentOS上から手作業（プロパティ）で、 アップロード後の「Test.csv」ファイルの「所有者」、および「グループ」を、 元々の「root」から、「mysql」に変更させてから、 その後、 MySQLコマンドの「LOAD DATA INFILE」を実行すると、 問題無く、インポート出来ています。 そこで、 ご質問内容なのですが、 Javaプログラムを利用しているか、していないか だけの違いで、 なぜか、上記致しましたJavaプログラムで、 アップロード後の「Test.csv」ファイルの「所有者」、および「グループ」を、 元々の「root」から、「mysql」に変更させてから、 MySQLコマンドの「LOAD DATA INFILE」を実行すると、 上記のエラーになります。 何がエラーの原因なのでしょうか？ もしお気づきの点などございましたら、 ぜひ教えてください。 お世話になります。 以上、宜しくお願い致します。
MySQL version 5.0.51とcseついて。 cseというフリーのデータベース接続ツールを使用してMySQLに接続しているのですが、 その際、varchar(32)という項目に「あいうえおかきくけこ」を入力しようとすると 「あいうえおかきく」までしか登録されません。 データベースの文字コードはUTF8を設定しているので全角1文字3バイトだと思うのですが cseだと1文字4バイトで認識されているのでしょうか？ この事象を調べている最中に、Oracleではvarchar(X)でXバイトだが、 MySQLだとX文字という記述を見つけ、そうだとしたら32文字登録可能なのに 8文字しか登録されない？？ と迷走しております。どなたかご存知の方ご回答いただければ幸いです。
MySQLのインデックスについて 以下のSQLにてお聞きしたいことがあります。 SELECT * FROM table1 WHERE num = '1' numはint型でインデックスを作成済の列なのですが、 問い合わせでは'1'のように文字列型で条件指定しています。 この場合、numに対するインデックスは効くでしょうか？ よろしくお願い致します。 追伸 なぜこのような質問をさせて頂くかと申しますと、 私は開発環境でZend Frameworkを使用しておりまして、 その中のZend_Dbを使用しているのですが、 名前つきパラメータを使用してSQLを実行した場合に、 実際の実行されているSQLではどのパラメータも、 シングルクォーテーションで囲われているのではと思うんです。 以前、SQL実行に失敗して出力されたエラーメッセージの一部に、 実際に実行されたSQLが記述されていたのですが、 数値型の列もシングルクォーテーションで囲われていたんです。 もしかしたら名前つきパラメータを使用すると、 すべてのパラメータが文字列型扱いされているのではと思い、 こちらに投稿させて頂きました。
来週の金曜までにPHPでアルバムシステムを作成しなければならないんですが、phpMyAdminをデータベースで使わなければなりません。 調べてみたんですが、全然設定や使い方が分からず困っています。 ＊自分はPHPを少し使ったことある程度の知識です。 回答お願いします。
GROUP BYで集約されるときのソートを変えたい MySQLの5.1を使用しています。 テーブル"tbl"には、"no","id","score"の3つのフィールドがあり、 "no"は主キーです。 +---+----+-------+ | no　|　id　|　score　| +---+----+-------+ |　1　|　10　|　10002　| |　2　|　10　|　10000　| |　3　|　10　|　10008　| |　4　|　11　|　10004　| |　5　|　12　|　10006　| +---+----+-------+ 上記の表から、 scoreの値が高い順にグループ化してソートしたいのですが、 以下のSQL文ではscoreが最初に登録されたものに集約されてからグループ化されてソートしてしまうため、 思い通りの結果が得られずに困っています。 ↓具体例 SELECT no, id, score FROM tbl ORDER BY score DESC GROUP BY id; +---+----+-------+ | no　|　id　|　score　| +---+----+-------+ |　5　|　12　|　10006　| |　4　|　11　|　10004　| |　1　|　10　|　10002　| +---+----+-------+ ↓欲しいソート順 +---+----+-------+ | no　|　id　|　score　| +---+----+-------+ |　3　|　10　|　10008　| |　5　|　12　|　10006　| |　4　|　11　|　10004　| +---+----+-------+ テンポラリテーブルはなるべく使用せずソートしたいのですが、 このような事は可能なのでしょうか？ ご存知の方がいらっしゃいましたら教えていただけると助かります。 よろしくお願いします。
文字コードMS932（Windows-31J）のテキストファイル（CSVファイル）を、 MySQLのLOAD DATA INFILEでインポートしたところ、 漢字などの全角文字が文字化けしてしまいました。 その後、MySQL上で「show variables like 'character_set_database'」を SQL実行したところ、「utf8」と表示された為、 試しに、 元のCSVファイル自体の文字コードを、 テキストエディタで「UTF-8」に変換したCSVファイルを、 MySQLのLOAD DATA INFILEでインポートしたところ、 うまくインポート出来ました。 そこで、ご質問内容ですが、 MySQLのLOAD DATA INFILEでインポートする際に、 文字コードMS932（Windows-31J）のテキストファイル（CSVファイル）を、 直接、文字コードUTF-8のテキストファイルとして、 読み込ませながらインポートするような方法が、 もしございましたら、ぜひ教えてください。 もし、それが無理でしたら、 上記の文字コード変換する方法として、 どのような方法があるかなどをアドバイスいただけましたら幸いです。 お世話になります 宜しくお願い致します。
xamppで公開前のワードプレスサイトを自作中です。（ちなみに初心者です） jqueryをダウンロードし、xamppフォルダに保存し、phpMyadminから制作中のサイトデータベースにjqueryをインポートしようとしたのですが、以下のエラーが出てうまくいきません（泣）。 -------------------------以下、エラー内容------------------------------ エラー 実行した SQL: /*! * jQuery JavaScript Library v1.4.3 * http://jquery.com/ * * Copyright 2010, John Resig * Dual licensed under the MIT or GPL Version 2 licenses. * http://jquery.org/license * * Includes Sizzle.js * http://sizzlejs.com/ * Copyright 2010, The Dojo Foundation * Released under the MIT, BSD, and GPL Licenses. * * Date: Thu Oct 14 23:10:06 2010 -0400 */( FUNCTION ( E, A ){ FUNCTION U( ){ RETURN false} FUNCTION ba( ){ RETURN true} FUNCTION ja( a, b, d ){d[0].type = a; MySQLのメッセージ: ドキュメント #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '* jQuery JavaScript Library v1.4.3 * http://jquery.com/ * * Copyright 2010, J' at line 2 ------------------------以上、エラー内容----------------------- そもそものやり方が間違っていますか？ どのようにしたらよいのでしょうか。初心者です。よろしくお願いします。
売上げ件数順のSQLについて ユーザーごとに、日別の売上データを下記のSQLで集計しています。 これを、グループ化を保ったまま、全期間での売上げ件数合計の多いユーザー順に並び替えるにはどうすればよいでしょうか？ select w.user_id as user_id, DATE_FORMAT(w.created_at,"%Y-%m-%d") as days,w.type as type, count(*) as num from uriage w group by user_id,type,days order by user_id,days,type; +---------+------------+-----------------+-----+ | user_id | days　　　 | type　　　　　　| num | +---------+------------+-----------------+-----+ |　　　 1 | 2010-10-15 | カテゴリ１　　　|　 1 | |　　　 1 | 2010-10-15 | カテゴリ２　　　|　 1 | |　　　 1 | 2010-10-15 | カテゴリ３　　　|　 5 | |　　　 1 | 2010-10-16 | カテゴリ２　　　|　 1 | |　　　 1 | 2010-10-16 | カテゴリ３　　　|　 1 | |　　　 2 | 2010-10-15 | カテゴリ１　　　|　 1 | +---------+------------+-----------------+-----+
MySQL UPDATE SETが失敗なのに１が返る いつもお世話になります。 MySQL5.0 PHP5 PEAR(DB)にて開発中です。 "UPDATE master SET xxx={$xxx}+1 WHERE id={$id} AND xxx={$xxx}" 上記クエリを実行し、 WHERE以下に該当しないない場合は、該当データー無しとして別の処理を行う予定です。 該当すればそのままUPDATEでいいのですが、 ここで該当無しとなれば、通常UPDATEの場合は返り値として0が戻るはずなのでが、 どうしても1が戻ってしまいます。 その為、if($res==0)　として判定できず困っております。 ※もちろん、該当無しのUPDATEの場合は、テーブル内のデーターは変更されていません。 どなたか回答をお寄せ下さい。 宜しくお願いします。
キーワード　\P　が部分一致で検索できない。 mysqlをutf8_unicode_ciで使っています。 検索キーワードに\Pと入力し、部分一致で検索すると、OMP,EEP等\Pと部分一致していない データも検索結果に表示されてこまっています。 \(バックスラッシュ)は特別な文字なので、\Pと入力しても、\(バックスラッシュ)は無視され、キーワード　「P」で検索されているようです。 今しようとしていることは、 検索キーワードを暗号化し、暗号化したキーワードで検索する処理です。 暗号化したキーワードはかなりの確立で\(バックスラッシュ)が含まれるので、 \(バックスラッシュ）を普通の文字列として検索したいです。 具体的には select * from testtbl where test like '%\\P%' このようなSQL分を実行した時、OMPやEEPが合致しないようにしたいのです。 よくわからなくなってきたので、アドバイス宜しくお願いします。
タグを記録したテーブルの書き換えに関する質問です。 このようなテーブルがあるとします。 tag_table id | tag | entry 1 | foo | 1 2 | bar | 1 3 | hoge| 1 4 | foo | 2 5 | foo | 3 6 | bar | 3 entry1に付けられたタグは"foo","bar","hoge"、entry2に付けられたタグは"foo"、entry3に付けられたタグは"foo"と"bar"という状態です。 entryについて記録したテーブルは当然別にあります。 質問は、こうしたテーブル設計において、tag_tableの書き換えはどのように行えばいいかについてです。 例えばentry1が編集され、タグが「foo」「bar」「hoge」から「foo」「bar」に変更されたとします。 この時、考えられる処理はどういうものになるでしょうか？ 私が思いついたのはentry1のレコードはいったんすべて削除してしまい、それからまた新たに編集後のタグをINSERTするというものでした。 つまりどういう処理内容だったとしても、既存のレコードはいったんすべて削除してしまい、それから再びINSERTし直すというような方法です。 これが妥当なのかどうか、他にもっとも良い方法があるのならそれを教えていただきたいのです。 どうぞよろしくお願い致します。
SELECT クエリーの OR の使い方を教えてください。 複数テーブルから条件に合ったものを取り出したいのですがうまくいきません。 クエリは下記のように書いています。 $query = "SELECT pa.options_values_id, pa.options_id, pov.hc_options_values_id 　　　　　FROM products_attributes pa, products_options_values pov 　　　　　WHERE pa.products_id = '" . $key . "' 　　　　　AND pa.options_id = '1' 　　　　　AND (pa.options_id = '2' OR pa.options_id = '4') 　　　　　AND pov.products_options_values_id = pa.options_values_id"; 希望としては、products_id が $key のものは複数あるのでその中の・・・ options_id が '1'は必ずあるので取得 options_id が '2' か options_id が '4' のものはどちらかが、必ずあるのである方を取得 その中の products_options_values_id が options_values_id のものを最終的に取得したいのですが・・・ クエリーを2個に分けて・・・ $query = "SELECT pa.options_values_id, pa.options_id, pov.hc_options_values_id FROM products_attributes pa, products_options_values pov WHERE pa.products_id = '" . $key . "' AND pa.options_id = '1' AND pov.products_options_values_id = pa.options_values_id"; $query = "SELECT pa.options_values_id, pa.options_id, pov.hc_options_values_id FROM products_attributes pa, products_options_values pov WHERE pa.products_id = '" . $key . "' AND (pa.options_id = '2' OR pa.options_id = '4') AND pov.products_options_values_id = pa.options_values_id"; のようにすると、うまくいったのですが出来ればまとめたいのでよろしくお願いします。
mysqlに格納されている日付のデータから重複なしで年を取得する方法 を検討しているのですが、どなたかご教授していただければと 思います。 下記のデータベースの場合 2007 2008 2009 2011 といった値を抽出したいと考えております。 どうぞよろしくお願いいたします。 mysql> select*LOGS; +-----+---------------------+------+ | UPDATE_DATE | ITEM_NO | +---------------------+------+ | 2007-07-05 14:35:35 | 1 | | 2007-07-05 14:42:20 | 5 | | 2008-07-06 00:01:20 | 12 | | 2009-07-06 13:38:16 | 13 | | 2009-07-06 13:47:45 | 13 | | 2011-07-06 13:54:10 | 2 | +---------------------+------+
以下のテーブルa,bから目的とする、ＳＱＬ実施結果を得たいのですが、ＳＱＬ構文が判りませんでした。 申し訳御座いませんが、ご指導頂けませんでしょうか？ ※table a と b は IDでひもづいております。 teble a -------------- ID |概要　　 | -------------- 1　|設計開始 | -------------- 2　|製造開始 | -------------- teble b ---------------- ID |内容　　|値　| ---------------- 1　|開始日　|10/1| ---------------- 1　|終了日　|10/5| ---------------- 2　|開始日　|12/1| ---------------- 2　|終了日　|12/5| ---------------- SQL実行結果 -------------------------------- ID |概要　　　|開始日　|終了日　| --------------------------------- 1　|設計開始　|10/1　　|10/5　　| --------------------------------- 2　|製造開始　|12/1　　|12/5　　| ---------------------------------
Excel（Excel2002を利用しています）の拡張子CSVのファイルを、 MySQLのテーブルへ JavaサーブレットやJSP、JavaScript等で、 インポートするプログラミング方法を教えてください。 （もしくは参考になる、いずれかのWebサイトをご紹介いただくだけでも助かります） お世話になります。 宜しくお願い致します。
update文に条件をつける場合 初心者です。よろしくお願いします。 update TABLE set HOGE = replace(HOGE,'文章','ブンショウ') こちらのupdate文にもう一つ条件をつけたいのですが、WHERE句をいれるとエラーがでてしまいます。 update TABLE set HOGE WHERE XXX = "YYY" = replace(HOGE,'文章','ブンショウ') update TABLE set HOGE WHERE XXX = "YYY" AND replace(HOGE,'文章','ブンショウ') エラーがでてしまいます、、、、WHERE XXX = "YYY"のような条件をだしたい場合はどのようにしたら良いでしょうか。 よろしくお願いします。m(_ _)m
mysqlのselectについて selectがおかしいです。 select * from hoge where a = 'あ'; とすると、 |"あ" |"hoge" | null | |"あ" |"hohi" | null | ... って感じで出力されるはずなんですが、 　| |"hoge" | null | 　| |"hohi" | null | ... って感じで"あ"のとこが押しつぶされて出力されてしまいます。 何がどうなってるんでしょうか...? 文字コードはsjisで、あってるはずなんですがなんか動きません
MySQLの検索について id | name | price 1 | A | 100 2 | B | 1200 3 | A | 150 4 | A | 175 5 | B | 1150 6 | C | 500 7 | C | 600 8 | D | 300 仮にこのようなテーブルがあったとします。 このテーブルを、以下の形で出力したいのです。 A | 100 A | 150 A | 175 B | 1150 B | 1200 C | 500 C | 600 next page（D以下は次のページ以降で表示） つまり、nameの項目は指定した項目数だけを出力。 1ページに表示するnameの数は決まっている。 ただし、表示されるnameにあたるレコードは数に関係なく全て出力し、nameごとにpriceでソートする。 クエリーを2回発行し、プログラム側での処理を交えれば実現できるのですが、できればDBに問い合わせる回数は減らしたいと考えています。 上記の事を1度で実現するSQLが存在する、あるいはより優れたやり方があるのでしたら、ご教授いただければ幸いです。
検索について SELECT * FROM テーブル名 WHERE 列名 LIKE '条件' を使って検索できるプログラムを作りました。 これにORの条件で列名を追加したいのですが可能でしょうか？ 「条件が列名1と列名2のどちらかにあてはまる」といったような。 回答お待ちしています。
phpMyAdmin を使って以下のSQL文を記載してテープルの追加をしたいのですが エラーがでます。 phpMyAdminの操作方法やSQLの知識も乏しいので　EC-CUBEのテキストに従って操作しているのですが、、、、。 -------　ここから　---------- CREATE TABLE dtb_contact ( contact_id serial NOT NULL, name text, name_f text, zip01 text, zip02 text, pref integer, addr01 text, tel01 text, tel02 text, tel03 text, email text, message text, create_date timestamp without time zone, del_flg integer DEFAULT 0, customer_id integer, status integer DEFAULT 0 ); ALTER TABLE ONLY dtb_contact ADD CONSTRAINT dtb_contac_contact_id_key UNIQUE (contact_id); －－－－－ここまで------------- 実行すると下記のようなエラーがでます ▼MySQLのメッセージ: ドキュメント #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'without time zone, del_flg integer DEFAULT 0, customer_id in MySQL　の　バージョンは　MySQL 5.0.45なのですが 文法的にどこか間違っているのでしょうか？ ご多忙のところ恐縮ですが ご教授いただければ幸いでございます。
リンクステーション（LS-VL)の機能の、 MySQLサーバを使いたいのです。 マニュアルには、「MySQLデータベースを設置する。」と書いてあるのですが、 具体的に、何を使って、どのように、MySQLデータベースを設置すれば良いのでしょうか？ 具体的に教えてください。
テーブル設計について。 DBから集計して、このような表を出しているのですが、 現在、レコードが10万件ほどあり、集計のクエリが終わるまで7秒近くかかっています。 ※以下、タブ区切りにしてありますので、エディタなどに貼り付けて頂くと見やすいと思います。 【表】 質問グループ質問タグ答えOK数答えNG数 Aa21 Ab20 Ba12 【DB】 テーブル：test idanswergrouptag 1OKAa 2NGAa 3OKAa 4OKAb 5OKAb 6OKBa 7NGBa 8NGBa 【クエリ】 SELECT group, tag, SUM(CASE WHEN answer='ok' THEN 1 ELSE 0 END) AS ok, SUM(CASE WHEN answer='ng' THEN 1 ELSE 0 END) AS ng FROM test GROUP BY group, tag; ※「id」をprimaryキー、「group、tag、answer」をまとめてuniqueとしてインデックスを貼ってます ok数とng数の集計に時間がかかってしまっているのですが、 他に良い方法があれば教えて下さい。 また、そもそものテーブル構成を以下のようにすればいいのでは？ とも思ったのですが、どうなんでしょうか？ この形に変えると、集計は一瞬で終わるはずなのですが、 ok と ngを別カラムにするという考え方がしっくりきません。 テーブル構成の考え方としてどうなのか知りたいです。 下のようにすると、okカラムとngカラムの片方にしか値は入らなくなってしまうので、 それだったら最初の構成のように、answerカラムにokかngのどちらかが入るといった方が好ましいのかなとも思い・・ それと今回はたまたまok と ngの固定２つですが、複数になるような場合もあると思うのです。 テーブル：test idgrouptagokng 1Aa1NULL 2AaNULL1 3Aa1NULL 4Ab1NULL 5Ab1NULL 6Ba1NULL 7BaNULL1 8BaNULL1 SELECT group, tag, sum(ok), sum(ng) FROM test GROUP BY group, tag; ご教示下さい。
複数条件の検索について お世話になります。 MySQL上の以下のテーブルからのデータ抽出に困っています。 SUM関数・COUNT関数およびGROUP BYを使い、また、内部結合・外部結合など考えられる手法は試したのですが、構文が悪いのか欲しい結果が得られません。正しい構文についてご教授いただけると大変助かります。 テーブル名：スコア ID 得点 -- ---- 1　　10 2　　15 1　　　5 2　　25 欲しい結果： ID 　合計得点 　10点以上～30点未満の件数 -- 　-------- 　------------------------ 1　　　　15　　　　　1 2　　　　40　　　　　2 宜しくお願いいたします。
文字コードの設定 こんばんは、いつもお世話になります。 おそらく初歩的な質問なのですが、なかなか自己解決できないので、質問させてください。 サーバーによって「set names」を出入力の際に必ずしなければ化けてしまうところと、 なにもしなくても、phpmyadmin上、出入力双方まったく化けないところとがあります。 照合順は同じ条件なのですが、この両者の違いはなんなのでしょうか？ 設定か何かなのでしょうか？ 「set names」をコネクト毎デフォルトで発行してるのでしょうか？ 自動で文字コード判別してたりできるものなのでしょうか？
１つのVARCHAR属性のフィールドに対して、SQL文のLIKE等を 利用して、”全角文字”が1つ以上存在しているレコードのみを、 SELECTで抽出する方法をご存知の方がいらっしゃいましたら、 ぜひ教えてください。 お世話になります。 宜しくお願い致します。
ＭＹＳＱＬからphpで取り出したハイパーリンクのタグが文字列化してしまい機能せず困っています。 キーワードを変えて散々ググったりヤフったりしたのですが、キーワードが悪かったのか答えは在ったのに気付かなかったのか解決策が見つけられませんでした。 phpMyAdminのバージョン3.2.4を使用しています。 取り出したURLはこのようなものです。 <a href="http://www.～">作品名<img src="http://www～" width="" height="" border="" alt="" /></a> これがHTMLソースでは &lt;a href=&quot;http://www.～&quot;&gt;作品名&lt;img src=&quot;http://www～&quot; width=&quot;&quot; height=&quot;&quot; border=&quot;&quot; alt=&quot;&quot; /&gt;&lt;/a&gt; こうなっているのが問題だと思うのですがどのように解決したらよいのでしょうか。 質問慣れしていないため回答に必要な情報を出せていないかもしれません そういった場合もお手数ですがご指摘いただけるとありがたく存じます。。 ソース <?php require_once '../Encode.php'; try { $db = new PDO('mysql:host=localhost; dbname=php10', 'phpusr', 'phppass'); $db->exec('SET NAMES utf8'); } catch(PDOException $e) { die('エラーメッセージ：'.$e->getMessage()); } $stt = $db->prepare('SELECT * FROM games ORDER BY fee'); $stt->execute(); ?> <tbody> <?php while ($row = $stt->fetch(PDO::FETCH_ASSOC)) { ?>> <tr> <td colspan="3" height="22">作品名<?php e($row['title']); ?></td> </tr> <tr> <td width="115" rowspan="2">バナー<?php e($row['bannar']); ?></td> <td width="644" height="125" colspan="2">説明・解説<?php e($row['main']); ?></td> </tr> <tr> <td width="321" height="20">その他情報<?php e($row['cost']); ?></td> <td width="321" height="20"><a href="games_edit.php?sid=<?php e($row['sid']); ?>"> 編集</a></td> </tr> </tbody> <?php } ?> </table>
MySQLでのランキングの生成方法に関してなのですが、 下記の例にてid別にflgが1のモノの数でランキングをする方法はありますでしょうか？ (同率は同じ順位とします) (毎日ミニテストを行って合格したらflgが1となるようなイメージです) (MySQLのみで行える方法を探しています) MySQL5.0.51を使用しています。 testテーブル id flg 1 1 1 0 1 1 1 1 2 1 2 1 2 1 2 0 3 0 3 0 3 0 3 0 4 0 4 0 4 0 4 0 5 1 5 0 5 0 5 0 ランキング 1位 1 1位 2 3位 5 4位 3 4位 4 ご教授よろしくお願いします。
現在コマンドプロンプト上でMySQLを勉強しているのですが、コマンドプロンプトのclsコマンドのような画面情報を消すようなコマンドはあるのでしょうか？ 回答よろしくお願いします。
MySQLの文字化けが直りません。 CentOS5.4+Apache2.0+ PHP 5.1.6 MySQL Server, Client とも 5.0.77 を使用しています。 設定は次の通りですが、Windows7 のクライアント機から見ると文字化けしてしまいます。 # mysql -p root -p***　（エラーを生じさせてみる） ERROR 1049 (42000): 'root' 、ハ、?ニ・ヌ。シ・ソ・ル。シ・ケ、マテΤ熙゛、サ、・ ************************************************** mysql> status Server characterset: utf8 Db characterset: utf8 Client characterset: utf8 Conn. characterset: utf8 -------------- php.ini は次の設定です。 1123 [mbstring] 1125 mbstring.language = Japanese 1130 mbstring.internal_encoding = UTF-8 1133 mbstring.http_input = auto 1137 mbstring.http_output = UTF-8 1144 mbstring.encoding_translation = Off 1148 mbstring.detect_order = auto 1152 mbstring.substitute_character = none; 文字化けを直すにはどのようにすれば良いでしょうか？
Mysqlで最新の日付を持つデータを取得するSQLを書きたい 管理テーブル(MySql) 日　付｜食べたもの －－－－－－－－－－－ 4月1日｜パン 4月2日｜ご飯 4月3日｜パン 4月4日｜パン 4月5日｜ご飯 4月6日｜カレー と言ったデータがあったとき パンを食べた最新の日付を取得したいとき どんなSQLを書けばいいのでしょうか？ SELECT * FROM 管理テーブル WHERE 食べたもの = パン ORDER BY 日付 DESC LIMIT 1; とすれば、思うような結果が出ましたが LIMITは使いたくありません また 日　付｜食べたもの －－－－－－－－－－－ 4月4日｜パン 4月5日｜ご飯 4月6日｜カレー 上記のように 食べたのもそれぞれの最新の日付を表示して 一覧にしたいとき(表現ベタですみません） どんなSQLになりますか？
phpからmysqlを使う入門サイトを探しています。 phpからmysqlを使う入門サイトをいくつか見ますと、コマンドラインからデータベースを作成して、その後phpでそのデータをみるところからスタートするのですが、当方の環境にはコマンドラインがないために、「その後phpでそのデータをみる」が出来ずに、学習が進んでおりません。 コマンドラインを一切利用しないphpからmysqlを使う入門サイトはないでしょうか？
phpからMySQLに接続について 自宅サーバーにMySQLをインストールしたのですが、 phpからMySQLに接続がうまくできず、困っています。 [test.php] <?php mysqli_connect("localhost","root","qwertyui") or die("Error MySQL First Test"); echo "Success MySQL First Test"; ?> [エラーログ] PHP Fatal error: Call to undefined function: mysqli_connect() in ~~~test.php on line 2 コマンドラインでは正常に動作しているのでインストールは問題ないと思います。 PHPの設定だと思うのですが、考えられる原因を教えていただければ幸いです。 環境 VineLinux 4.2 PHP 4.4.8 MySQL 5.0.27 よろしくお願いします。
MySQLにおいてデータフォルダの変更が以下の対処を実施したのですが変わりません。変わっていないことは旧フォルダに適当なフォルダ(aaaa)を作りshow databases実行するとaaaaがリストされるからそのように考えています。 申し訳ありませんが、どなたかご教授ください。 【実施した対処】 ・my.iniファイルのdatadirに新ディレクトリを指定。 ・mysqlを再起動 【環境】 ・Windows Vista SP2 ・MySQL 5.0
コンピュター技術者様へ サーバー移転しましたら ドメインは正常に移動できたようですが フオルダーと言うのか良くわかりませんが サーバー上でダウンして404エラーとなって困っています。 現在「旧」サーバーのホステイング会社にお願いして 元に戻してシステムは正常に動作していますが 新しいサーバのほうに足りないものが何で有るかが わからず徹夜続きで解明勉強に努力しています。 どなたか、アドバイスいただけるよう 宜しくお願いします。
お世話になります。 CSV取り込みに関しての質問です。 以下の記述したphpファイルにてCSVの取り込みを行ったのですが、 $ld="LOAD DATA INFILE 'filepass/test.csv' INTO TABLE tablename FIELDS TERMINATED BY ',' "; $ld2=mysql_query($ld); $inita=True; 読み込みが出来ません。 エラー文など一切出ません。 CSVファイルの場所は問題ありません。 またmysqlのテーブルのフィールド数も問題ないと思います。 mysqlへのログインも問題ないと思います。 何が問題か正直それすら思い浮かばず質問致しました。 何が原因で読み込みが出来ないのでしょうか？ 思い当たることは一通り試しました。 どうかよろしくお願い申し上げます。 mysql ver 5.0.51a
お世話になります。 #mysql -u root -p でEnter押すと通常はパスワードを聞かれますが 何も行われず #mysql -u root -p # となります、 つまりコンソールに入れないのです。 原因がさっぱりわかりません。 phpMyAdminでdbの操作は出来るのでMySQL自体は動いています。 どなたかご教授お願いいたします。 情報足りない場合捕捉しますのでよろしくお願いいたします。
MySQL のデーターフォルダー見当たりません。 MySQL 5.1.50-win32 をインストールしました。サンプル・データは確認できましたが、データーフォルダーが見当たりません。XPにもWin-7にもインストールしたのですが、結果は同じです。同様な質問をされた方の回答も参考にしたのですが、該当するものはありませんでした。 MySQL Server 5.1の下にあるフォルダーとファイルは下記の通りです。 bin Docs lib ? この下に Plugin ? debug, ha_innodb.plugin share COPYING Exceptions-Client my my-huge my-innodb-heavy4G my-large my-medium my-small my-template 希望の場所にデーターフォルダーを作成することができますか？ TerPadなどで簡単に 変更して作成できればその書き方もご教示ください。教材のCDにあるデーターを 一括してコピーする予定です。
勉強でSNSを作っています。 タグの実装をどうするかで分からないことがあったので質問させてください。 一つのエントリに、複数のタグが付く設計なのですが、それをデータベースにどう格納するかで迷っています。 a.一つのレコードにまとめて格納 entry | title | tag 1 | foo | tag1,tag2,tag3 2 | bar | tag4,tag5 b.別のタグテーブルを用意して格納 entry | tag 1 | tag1 1 | tag2 1 | tag3 2 | tag4 2 | tag5 自分で考えたのは上記の2パターンです。 どちらがいいか、あるいはこれ以外に良い設計があればアドバイスしてください。 また、なぜその方法が良いかの理由も教えていただければ幸いです。
他のＰＣにあるmysqlにDOSで接続。 他のＰＣにあるmysqlにDOSで接続するにはどうしたらいいのでしょうか？ 今java、PHPからはアクセスしたり、変更削除なども出来ています。 ですがコマンドプロンプトからはどうやってアクセスしたらよいのか分かりません。 DOSからのアクセスはできないのでしょうか？ 分かる方、いましたらお願いします。
MySQLのログインを暗号化できますか？ connectを張るときに"user id=○○; password=××; database=△△;Data Source=■■" をインターネット経由で送ってます。 この部分はオラクルだとデフォルトで暗号化されてるが、 MySQLでは平文のままだという話をききます。 1.平文のまま流れてるというのは本当なんでしょうか？ 2.もし、平文のままなんだとすると、SSLみたく暗号通信化する方法は MySQL自体に実装されてるんでしょうか？ それとも自前でトンネルを掘る必要があるんでしょうか？ 平文のまま流れてるなら、いつかは盗聴されるように感じています。 上記について、ご存知の方おられましたらよろしくお願い申し上げます。
ある項目（数値）に加算したものでソートしたい。 下のようなテーブルがあります。 そのpointに加算した結果でソートしたいのですが、可能でしょうか？ テーブル name　　｜ point ああAAA｜ 100 ああBBB｜ 400 いいCCC｜ 300 ううDDD ｜ 200 おおCCC｜ 500 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝ ふつうにORDER BY point DESC でソートすると下記のようになります。 おおCCC｜ 500 ああBBB｜ 400 いいCCC｜ 300 ううDDD ｜ 200 ああAAA｜ 100 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝ そこでpointに加算した結果（dbには反映させず、あくまで表示上のみ） name［ *CCC］にはpointに80％加算 いいCCC　300→540 おおCCC　500→900 ソート結果 おおCCC｜ 900 いいCCC｜ 540 ああBBB｜ 400 ううDDD ｜ 200 ああAAA｜ 100 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝ このような事は可能でしょうか？
ODBCデータソースが削除できません。 以下の環境でデータベースを作成しました。 OS:Windows vista Home Premium sp2 DB:MySQL 5.1 ODBC接続を行いたかったので、 コネクタ「mysql-connector-odbc-5.1.7-win32」のインストールもしました。 コントロールパネル→管理ツール→データソース(ODBC)から ユーザDSNにデータソースを追加しました。 設定を確認しようと、構成ボタンを押しましたが以下のエラーが表示されてしまいました。 タイトル：ドライバのConfigDSN、ConfigDriver、またはConfigTranslatorが失敗しました。 検出されたエラー： Invalid attribute string このエラーはどのように回復できるのでしょうか？
お世話かけますが、エラー内容で理解者 指導いただきたく宜しくお願いします。 SEが現在療養で外国へ行っていて困っています。 復帰できましたと伝えた後又ダウンしています。 下記エラーです。指導宜しくお願いします。 404 Error - Not Found 申し訳ございません。 指定されたファイルまたは ディレクトリーは存在いたしません。 考えられる原因としては、以下の通りです。 指定されたファイルまたは ディレクトリーがサーバー上に 存在しません。 指定されたファイルまたは ディレクトリーの名前が 変更されています。 指定されたファイルまたは ディレクトリーが現在利用できません。
初心者です。。XAMPPをダウンロードした後、MYSQLのパスワードを変更したいのですが・・・。 http://www.apachefriends.org/jp/faq-xampp-window … 上記の中の（方法１）でパスワードの変更を行おうとmysqladminアイコンをダブルクリックしたら一瞬黒い画面が出て消えてしまいます。 何か設定、あるいはやり方が間違っているのでしょうか？ ちなみに当方、Windows7を使用しています。 XAMPPのコントロールパネルからMYSQLはスタートすることができる環境ではあります。一瞬黒い画面が出て消えるのはMYSQLを起動している状態であろうが、停止していようが同じです。 何かお分かりになる方いらっしゃったらご教授お願いいたしますm(_ _)m
PHPとMySQL、INSERTの動作についての少し疑問点。 現在、PHPとMySQLを使ってHPを作成しています。 会員登録のページが存在し、会員情報をDBに書き込む時にINSERT文を使用しているのですが この動作を複数の人が同時に行った場合、どうなるのでしょうか？ DB・PHP・MySQL的にエラーが出るのであれば 『書き込み処理中は時間差で実行する』等の 何か回避策をしなければならないのですが・・・。 その辺りが少し疑問に思ったのでお伺いしたく思います。 初歩的な質問になりますがお教え頂ければ幸いです。 よろしくお願い致します。
access で結果の出るSQLが、MySQLではできなくて困っています。 普段、ちょっと古いですが、Access2002を使用しています。 どうしても、Linuxサーバー上でデーターベースを利用する必要がでて、Fedora13に、mysql　5.1.48　をyamでインストールしました。 ところが、必要なSELECT検索が出来ず、困っています。 次のようなテーブル構造だと思ってください。 table A id｜No －－－－ a1｜01 b1｜11 c0｜20 table B No｜option1｜option2 －－－－－－－－－－ 01｜Ｌ　　　｜Red 01｜Ｓ　　　｜Red 01｜Ｌ　　　｜Green 01｜Ｓ　　　｜Green 11｜Ｓ　　　｜(値なし) 11｜Ｌ　　　｜(値なし) このNoとオプション１、２から、IDを割り出したしたいのです。 オプション１，２は、存在していないデータもあります。 Accessなら、table A　の　No　と　table Bのoption1、option2　を　&で結んで、結合プロパティをtable Aの全レコードに指定したＳＱＬ SELECT A.id, [A].[No] & [B].[option1] & [B].[option2] AS test FROM A LEFT JOIN B ON A.[No] = B.[No] WHERE ((([A].[No] & [B].[option1] & [B].[option2])="01LRED")); とすれば、a1　と結果が返ります。 table B　にオプション値の登録のないものでも、 SELECT A.id, [A].[No] & [B].[option1] & [B].[option2] AS test FROM A LEFT JOIN B ON A.[No] = B.[No] WHERE ((([A].[No] & [B].[option1] & [B].[option2])="20")); とすれば、C0が返ってくれます。 ところが、同じテーブル構成をMySQLに作成し、 SELECT A.id, A.No & B.option1 & B.option2 AS test FROM A LEFT JOIN B ON A.No = B.No WHERE A.No & B.option1 & B.option2 = "01LRED"; を入力してみましたが、結果が出ません。 エラーらしきものといえば、 Empty set, 5 warnings (0.00 sec) が表示されています。 結合の方法が違うのかと思い、Googleで調べ SELECT concat(A.id, A.No & B.option1 & B.option2) AS test FROM A LEFT JOIN B ON A.No = B.No WHERE (A.No & B.option1 & B.option2) = "01LRED"; と、concat　を使ってみましたが、だめでした。 MySQLで、上記のように複数のテーブル／フィールドを結合して、その値をもとに検索することはできないでしょうか？ よろしくお願いいたします。
Groupの中の条件に合致するデータを抜き出したい いくつかのテーブルからGroupでくくったデータを抜き出しました。 その中から条件に合致するデータに絞りたいのですが、 思った結果となってくれません。 DB:MySQL　5.1.50 以下のようなことをしたいと考えています。 [元のデータ] ID　　　｜　日付　　　｜　担当　　　｜　金額 A-01　　｜2010-09-01　｜Angas　　　 ｜1000 A-01　　｜2010-08-31　｜Mayor　　　 ｜1500 A-01　　｜2010-08-25　｜Angas　　　 ｜2000 B-01　　｜2010-08-30　｜Roger　　　 ｜1350 B-01　　｜2010-09-01　｜Angas　　　 ｜2000 B-01　　｜2010-08-20　｜Roger　　　 ｜1350 [結果として欲しいデータ] ID　　　｜　日付　　　｜　担当　　　｜　金額 A-01　　｜2010-09-01　｜Angas　　　 ｜1000 A-01　　｜2010-08-31　｜Mayor　　　 ｜1500 B-01　　｜2010-08-30　｜Roger　　　 ｜1350 B-01　　｜2010-09-01　｜Angas　　　 ｜2000 ちょっとデータ例が貧弱ですが・・・ IDと担当でグループ化した中で、日付が最も大きいレコードを抜き出したい。 というのが目的です。 どのようにSQLを書くと良いのでしょうか？ IDと担当でグループ化までは書けたのですが、 「グループのデータの中で日付で降順としたものの最新」というのを どのように書いたものか悩んでいます。 PS．こういうSQLの書き方で悩んだ時に、どうやって情報を集めると 良い情報に出合えるかの助言も頂ければ助かります。 よろしくお願いします。
mysqlの質問です。 select T1.ID,T1.NM from ID.FORM T1 WHERE・・・ というクエリを見かけたのですが 「ID.FORM」こういった形でテーブルを記述することは可能なのでしょうか。 今までに見たことがなく、また検索しようとおもってキーワードが思いつきません。 どなたかお教えいただけませんでしょうか。
mysqlのalter table中のロックについてです。 下記のように、alterでテーブルを再構築中に同じテーブルにinsertが実行された場合、 接続Bのinsertはブロックされるかと思うのですが、テーブルが大きくalterに時間がかかる場合、 タイムアウトなどは発生するのでしょうか。 またもし発生する場合、タイムアウト値の設定などの確認方法はあるのでしょうか。 1.接続A 　alter table table1 add columnB int(11) ; 2.接続B（接続Aのalter実行中） 　insert into table1(columnA) values('aaa');
phpからMySQLへの日本語文字化けについて こんにちは。お分かりの方は教えてください。 現在、「ハッスルサーバー」を利用しwebのphpからMySQLサーバーへの 情報登録画面を作成しています。 登録内容で数値やメールアドレスなどの「1バイト文字」ですと 問題ないのですが、日本語の「2バイト文字」ですと文字化けが 発生してしまいます。 phpやMySQLに知識が無いため色々と調べて試したのですが 正しく登録できませんでした。 試した結果とサーバー/DBの状況は以下の通りです。 ※サーバー/DB ・バージョン:5.0.90-log ・文字セット：UTF-8 Unicode (utf8) ・接続照合順序：utf8_general_ci ・種別：MyISAM ・Variable_name：Value ・character_set_client：utf8 ・character_set_connection：utf8 ・character_set_database：utf8 ・character_set_filesystem：binary ・character_set_results：utf8 ・character_set_server：utf8 ・character_set_system：utf8 ・character_sets_dir：/usr/local/share/mysql/charsets/ ※phpファイルにて試した設定 //接続 $objCon = mysql_connect(C_SERVER, C_USER, C_PASSWORD); //文字コード // mysql_query("SET NAMES SJIS"); ←文字コードを左の２パターンで // mysql_query("SET NAMES UTF8"); ←どちらかに切り替えて実行しました。 //データベース $objSecDB = mysql_select_db(C_DB_NAME); //**********SQL(Insert)**********// $strSql = ""; $strSql = $strSql . "Insert Into XXXXX "; $strSql = $strSql . "("; $strSql = $strSql . "KeyNo,"; $strSql = $strSql . "E_Mail,"; $strSql = $strSql . "Title"; $strSql = $strSql . ") "; $strSql = $strSql . "Values "; $strSql = $strSql . "("; $strSql = $strSql . " " . mysql_real_escape_string($intKeyNo) . ", "; //KeyNo $strSql = $strSql . " " . mysql_real_escape_string($strEmail) . ", "; //E_Mail $strSql = $strSql . "'" . mysql_real_escape_string($strTitle) . "' "; //Title $strSql = $strSql . ")"; //SQL発行 $blnRet = mysql_query($strSql); ・上記のソース内に記しましたが文字コードを２パターン切り替えて 　実行しましたが文字化けや空文字が登録されました。 どなたか対処方法をお分かりの方はお教えください。 よろしくお願いします。
phpmyadmin 2.6.4-pl4 (MySQL3.23.58, php4）を使っています。 登録レコードの主キーに応じて、特定のカラムの値を更新したい場合、phpmyadminで操作可能でしょうか。 たとえば、 primary_key=001 , product_key=あ primary_key=002 , product_key=い primary_key=003 , product_key=う を、 primary_key=001 , product_key=A primary_key=002 , product_key=B primary_key=003 , product_key=C というように更新したいのですが・・・。 primary_keyと（更新したい）product_keyの対応表はテキスト形式でもっています。 実現可能でしょうか。ご教示よろしくお願いします。
phpMyadminでどうしてもinnoDBが有効になりません。 ローカル環境 phpMyAdmin - 2.11.4 MySQL クライアントのバージョン: 5.0.51a ストレートエンジンをMyISAMで開発を行っていましたが、 innoDBに変更することにしました。 色んなサイトを拝見しましたが、どうも有効になってくれません。 対処した項目を書きます。 (1)　my.cnf内のskip-innodbをコメントアウト (2)　数回XAMPPのコントロールパネルからMySQLを再起動 (3)　ログファイルib_logfileの確認　＜無し＞ 　　（ログファイルが生まれていれば、xampp/mysql/data/ ←　この中に生まれますよね？） (4)　(3)のログファイルがあれば、それを削除しようと思いましたが見つかりませんので、 　　無視しました。このログファイルは、my.cnf内のinnodb_log_file_size =　デフォルト値を 　　変更した場合、既に生まれているログファイルのサイズと異なっていらば、エラーとなるらしく、 　　まあ、一度もinnoDBにてテーブルを作成していないので、ログが生まれるはずもなく・・・ 　　　一応ケアーしてみました。 いかがでしょうか？ これら以外に、innoDBがphpMyadminで有効になってくれない理由がありますでしょうか？ かなりハマッてます・・・。お助け下さい。。
GROUP BY/ORDER BYの併用で期待するORDERが得られません。 データベース初心者です。よろしくお願いいたします。 table id group_id name 1 1 冷蔵庫1 2 2 カメラ1 3 2 カメラ2 4 2 カメラ3 5 3 テレビ1 のようなテーブルを、group_idでグループ化し、idの大きい順に並べた以下のようなデータ id group_id name 5 3 テレビ1 4 2 カメラ3 1 1 冷蔵庫1 を取得しようとして悩んでおります。 SELECT MAX(id) AS max_id, id, group_id, name FROM table GROUP BY group_id ORDER BY max_id DESC というクエリですと max_id id group_id name 5 5 3 テレビ1 4 x 2 y 1 1 1 冷蔵庫1 という結果が得られますが、xとyところが、期待するx=4、y=カメラ3とならないケースがあります。 いくつかのテーブルで試しましたが、期待する結果になるものとならないものがありました。 例えばこれを自己結合することも考えたのですが、WHERE句にASで命名した「max_id」が含まれると「max_idが不明」というエラーが出ます。 MySQLのバージョンは4.0.xでして、サブクエリーが使えません。 このような状況で、何か方法がございましたらご教授のほどお願い申し上げます。 「期待する結果がクエリ1回で得られない」ということを知れるだけでも構いません。 どうぞよろしくお願いいたします。
fetch_arrayでのエラー はじめまして。初心者ですが、ご教授頂きたいです。 PHP,mysqlでサイトを作っていますが、 while ($row = mysqli_fetch_array(mysql_query($dbc,"SELECT userid FROM user_a"))) { $data = $row['userid']."member"; //テーブル名 mysqli_query($dbc,"DELETE FROM $data WHERE USERID = 'xxx'"); } このように書いたところ、 Warning: mysqli_fetch_array() expects parameter 1 to be mysqli_result, boolean given in とエラーが返ってきてしまいます。 テーブル user_a の中にある "userid" を一つずつ取り出し、 それぞれの userid.member というテーブルに xxx がある行を削除していきたいのが目的です。 ネットで探しても、このエラーに関して解決策が書かれているサイトが見当たらなく 途方に暮れている次第です。 どうかお助けください。宜しくお願い致します。
列名を式で指定することはできますか。 例えば、 SELECT `CONCAT('名', '前')` FROM `顧客` みたいなことがしたいです。
Mysqlで掲載開始日と掲載終了日が設定されている商品レコードを抽出したい Perl+Mysqlでデーターの抽出する際に困っております。 商品テーブル(item)がありその中には、date型のstart_dateとlast_dateのカラムがあります。 +-----+----------+-----------+ |itemid　| start_date　|　　last_date 　 | +-----+----------+------------+ | a001　| 2010-08-31 | 2010-09-31　 | | a002　| 2010-09-01 | 2010-09-21 　| | b002　|　 NULL　　　　| 　 NULL 　　 | | c003　|　 NULL　　　　|　 2010-09-03 　| +-----+------------+------------+ まず、本日が2010/08/30だったとしたばあい、b002とc003は表示されるようにしたいのです。 Perl上で start_date とlast_dateの期間内であればprintすればいいというこではなく、 あくまでslq文上一回のQueryでそれを実現したいのです。 といいますのも、ページ送り（ページャー）を表示させるために予め 抽出条件の全レコードの件数を取得する必要があります。 大変恐れ入りますが、ご教授お願いいたします。
レコードの順番 全体の昇降を変更することはできるのですがレコードの行を一つ上にあげることは可能ですか？ SQL文があれば教えてください。
phpMyAdminでのInnoDB設定について mysqlでInnoDBを使用するため、各テーブルの種別をInnoDBに設定しました。 しかし、phpMyAdminで、データーベースの構造を見ると テーブル |昇順|操作|レコード数| 種別 |照合順序|サイズ|オーバーヘッド hoge　　　　　　　　　　　　　|InnoDB| hoge2　　　　　　　　　　　　 |InnoDB| 2テーブル|　　|合計|1,726 |MyISAM| というように、テーブルの種別はInnoDBとなっているのですが、 最後の行にある、各テーブルの合計値が表示されている場所には、 MyISAMと表示されています。 InnoDBを使用する上で、これは問題ないのでしょうか？ 教えて頂ければ幸いです。 宜しくお願いします。
PHP+MySQLで、MySQLデータをブラウザで表示→ブラウザからデータをアップデート→ブラウザを更新して再表示したいのですが、データをアップデートしたあと、ブラウザで表示してもすぐに反映されません。 「あれ？」と思ってmysqladminでDBを見ると、アップデートはされています。そしてしばらくして再度ブラウザを更新すると、アップデートが反映された状態で表示されます。 すぐにアップデートを反映させたいのですが、どうすればよいでしょうか。 phpで、update処理の後、 mysql_close($conn); と書いていますが、これだけではいけないのでしょうか。 よろしくお願い致します。
Mysqlで複数テーブルの参照 お世話になります。Mysqlについて質問させてください。 現在、それぞれnameとdateとflagの３フィールドをもつテーブルが、２つあります。 もともと別の用途で準備したものなのですが、 ２つのテーブルのflagを参照して、1のものだけdate順に並べることが出来るでしょうか？ ■テーブル１ ----------------------------- 　name　｜　　date　　｜flag｜ ----------------------------- 　田中　｜ 2010-06-01 ｜ 1 ----------------------------- 　山田　｜ 2010-09-01 ｜ 1 ----------------------------- 　田辺　｜ 2010-10-01 ｜ 2 ----------------------------- 　田所　｜ 2010-11-01 ｜ 2 ----------------------------- ■テーブル２ ----------------------------- 　name　｜　　date　　｜flag｜ ----------------------------- 　加藤　｜ 2010-10-01 ｜ 1 ----------------------------- 　佐藤　｜ 2010-07-01 ｜ 1 ----------------------------- 　織田　｜ 2010-12-01 ｜ 2 ----------------------------- 　斎藤　｜ 2010-01-01 ｜ 2 ----------------------------- ■求める結果 ----------------------------- 　name　｜　　date　　｜flag｜ ----------------------------- 　田中　｜ 2010-06-01 ｜ 1 ----------------------------- 　佐藤　｜ 2010-07-01 ｜ 1 ----------------------------- 　山田　｜ 2010-09-01 ｜ 1 ----------------------------- 　加藤　｜ 2010-10-01 ｜ 1 ----------------------------- 具体的なSQL文でなくとも構いません。参考になるような情報、サイトをご存じでしたら、教えてください。 よろしくお願いします。
MySQL5.1で varchar(100)のものを varchar(90)にする予定です。 （後ろの10バイトは無条件になくなっても構いません） 通常の手順ではalter tableを使います。 今回は、他の項目も変更（auto_incrementやキーの追加）するので 一度 mysqldumpでSQLを吐き出して、 CREATE文の以下を変更 varchar(100) → varchar(90) auto_incrementやキーの追加 そして、mysqlでリストアします。 この方法は、アリでしょうか？ 他のデータベース(PostgreSQL, SQLServer, Oracle)でも使える手法でしょうか？ 皆さんのvarchar(100) → varchar(90)する方法が知りたいです。
いつもお世話になっております。 phpの練習をするためにXAMPPをインストールしました。 「作って覚えるPHP+MySQLアプリケーション」というテキストを買って進めています。 テキストとはインストールしたバージョンが少し違っていましたがなんとか下記のは動いています。 XAMPP:1.7.3 mySQL:5.1.41 PHP:5.3.1 phpMyAdmin:3.2.4 使用マシン:WIN XP 使用ブラウザ:Firefox ところが、PEARでデータベースにアクセスすることができません。 コマンドプロンプト　pear list で調べると、 PEARもMDB2もstableです。 phpファイルを作って実行させるとソースがそのままブラウザに表示されます。 （テキストではP.55～56の部分です。） 素人でどう質問したらいいのかわからないのですが、 実行するphpファイル内で「MDB2クラスの組み込み」はできてるようですが、 DSNの設定以降のソースがブラウザにそのまま表示されています。 正確には、 $dsn = array( 'phptype' => は表示されておらず、以降の　mysql　から全部表示されています。 いろいろネット検索してるのですが、対処がわかりません。 説明もフラフラですが、助けてください。 よろしくお願いします。
副問い合わせの限界値はどれくらいなのでしょうか？　 現在下記のようなＳＱＬを考えています。 SELECT * FROM A_TABLE WHERE a_field in ( SELECT a_field FROM B_TABLE WHERE b_field := ?c ) ; ※（便宜上、外部変数の指定を[:= ?c]としました） B_TABLEの検索に引っかかったデータをinの条件にしてA_TABLEを検索するのですが、 B_TABLEの検索で出力される結果（サブクエリで出力される件数）が 現在の理論値は平均でおおよそ1000件、最大10万件になる予定です。 これに対し、10万件での問い合わせに副問い合わせの実行はmysqlで可能なのでしょうか？　 現状のテスト環境では10万件のテストデータを用意できない状況です・・・。 また、どなたか副問い合わせでのサブクエリ出力件数の限界値をご存知の方がいらっしゃいましたらご教授頂ければ幸いです。 宜しくお願い致します。
InnoDBの利用 「show engines」を実行したら、InnoDBが出てきませんでした。 InnoDBを登録するには、どうすれば良いのでしょうか？ my.iniは、my-innodb-heavy-4G.iniをコピーして使っています。 よろしくお願いします。 環境：mysql5.1.41-community+Windows2008
日付検索で0000-00-00 00:00:00を除外したい mysql5.0　データ型はdatetimeで日付検索をしたのですが、 日付が"0000-00-00 00:00:00"で登録されているデータも 検索結果に表示され困っています。 例えば、 SELECT * FROM user_tbl WHERE (DATE( hizuke ) <= '20100505') →これだと、hizukeが0000-00-00 00:00:00のデータも表示されてしまいます。 日付が0000-00-00 00:00:00で登録されているデータを除外するため 自分もいろいろしてみたのですができません。どなたか教えていただけないでしょうか。 参考までに、自分が試したsql文を書きます。↓ SELECT * FROM user_tbl WHERE (DATE( hizuke ) <= '20100505') and (hizuke != '0000-00-00 00:00:00') SELECT * FROM user_tbl WHERE (DATE( hizuke ) <= '20100505') and (hizuke <> '0000-00-00 00:00:00') SELECT * FROM user_tbl　WHERE (DATE( hizuke ) <= '20100505') and (hizuke not in ('0000-00-00 00:00:00')) →上記載のsqlはすべて検索件数が0になってしまいました。 もうわからなくなってしまったので、アドバイスお願いします。
インデックス名の重複(MySQL5.1+Windows2008) テーブルを次のSQLでコピーしました。 mysql>create table 新テーブル名 like 元テーブル名; インデックスもコピーされたのですが、インデックス名が重複します。 これは、問題ないのでしょうか？ 新テーブルにも、同じインデックスを張りたいので、問題がなければこのままにしておきたいと思っています。 よろしくお願いします。
PHPから中国語ファイルを読み込み、MySQLにデータを保存する。 PHPで中国語が書いてあるtxtファイルを読み込み、データベースに登録させたいのですが中国語が「?」になってしまいます。 txtファイルは中国語のエンコードGB2312で保存し、PHPでsql文をechoさせるとブラウザ（ローカル）上ではちゃんと中国語で表示されています。 しかし、phpmyadminでカラムの中身を見てみると中国語であるはずの部分が全て「?」と表示されてしまいます。 色々試してみてもどうにもなりません。 大変恐縮ですがどのようにすれば中国語をファイル読み込みからデータベースに入れる事ができるのか、ご教授お願い致します。 ちなみに、phpmyadminから中国語を含むSQL文を直接入力すると中国語でちゃんカラムに入れる事はできました。
困ってます エクセル２００７です、外部データーの読み込みの件でお尋ねします。 手順で メニューの データ・既存の接続・このコンピュータ上の接続　等々で作成した表で数字部分がテキスト形式で表示されます、これを数字に変換する方法がありますか、この表でいろいろ計算をしたいのですが、なにか方法がありますかお教えてください。
MySqlの物理ファイルの安全性について 以前古いMySqlを利用して驚いたのが、 管理者ユーザのパスワードが分からなかったが、 別のPCで作成したMySqlに『*.MYD』『*.MYI』『*.frm』といったファイルをコピーする事でデータが見れたことです。 最近のバージョンではどうなのでしょうか？
mysql、phpを使ってデータがあるときだけ表示させたい 初歩的な質問で恐縮です。 mysql、phpを使ってデータがあるときだけ、それを表示させたいと思っています。 ------------------------------------------------------------------- データベース ↓↓ name　　　　　　　　blog　　　　　 クリリン　　　　http://www.111.jp　 ヤムチャ　　　　http://www.222.jp ブルマ ------------------------------------------------------------------- ------------------------------------------------------------------- 表示させたいこと ↓↓ クリリン 　クリリン公式ブログ（リンク） ヤムチャ 　ヤムチャ公式ブログ（リンク） ブルマ ------------------------------------------------------------------- ------------------------------------------------------------------- 実際にソース組んでみたやつ　（何も出てこなかった。。クリリンの場合） $blog_sql = "select blog from ****"; $res = mysql_query($blog_sql); $blog = mysql_result($res,0); if ($blog > 0 ) { echo "<p><a href=\"$blog\">クリリン公式ブログ</a></p>"; } ------------------------------------------------------------------- です。 ソースの部分は若干はしょってありますが、 ifを使わないでやるとちゃんと表示されるので、細かいところは問題ないはずです。 ただ、ifを使わないとブルマの項目にも「ブルマ公式ブログ」とリンクＵＲＬが入っていない状態で出てしまうので、ブログＵＲＬが入っていないものを表示させたくない、というものです。 何かご不明な点などあればおっしゃってください！ よろしくお願いします！
mysqlが起動しなくて困っています。 psコマンドで確認したところ、mysqldが起動していませんでした。 どなたか解決方法を教えてください。お願いします。 環境： FreeBS8.0 mysql5.1 ログの内容 100814 20:03:29 [Warning] '--skip-locking' is deprecated and will be removed in a future release. Please use '--skip-external-locking' instead. 100814 20:03:30 [Note] Plugin 'FEDERATED' is disabled. 100814 20:03:30 InnoDB: Started; log sequence number 6 317413989 ^G/usr/local/libexec/mysqld: File './mysql-bin.000005' not found (Errcode: 2) 100814 20:03:30 [ERROR] Failed to open log (file './mysql-bin.000005', errno 2) 100814 20:03:30 [ERROR] Could not open log file 100814 20:03:30 [ERROR] Can't init tc log 100814 20:03:30 [ERROR] Aborting 100814 20:03:30 InnoDB: Starting shutdown... 100814 20:03:35 InnoDB: Shutdown completed; log sequence number 6 317413989 100814 20:03:35 [Note] /usr/local/libexec/mysqld: Shutdown complete
CDの曲をパソコンに入れるには？ そしてパソコンの曲をmaikuroに入れるにはどうしたらいいでしよう？
phpmyadminを使って商品のカテゴリ分けをしたい。 現在ネットショップのサイトを構築しています。 商品が5万件以上あるため、どうしてもカテゴリ分けをしないといけないのですが。。。 データベースに商品の情報を登録して、ＰＨＰで呼び出せるようにしておけばいいと漠然と考え、いろいろ調べてみたのですがＰＨＰ・phpmyadmin共にほぼ触った事すらないため苦戦しております。。。 EC-CUBEなどのシステムを使えば簡単にできるそうなのですが、勉強のためにも自分の手で作りたいと思っております。 細かく説明させて頂くと、例えば「食品」というカテゴリをクリックすると「食品」に関する商品ページがズラッと並ぶページ（ＹＡＨＯＯオークションのような）が作りたいと思っているのですが、そうなるためにどんな内容のデータベースを作ればいいのかわからないという感じです。 因みに現在手元にある資料として、全商品の商品ページと全商品のデータが入ったＣＳＶファイルがあります。 汚い文章で申し訳ありませんが、お解かりになる方、是非回答お願いします。
php+mysqlで複数選択削除について いつもお世話になっておりますm(_ _)m 今回の質問なんですが チェックボックスで複数選択したものを一括で削除したいのですが、検索しても見つからないので質問しました!! 例) // $_POST["id"] ← チェックボックスより選択されたデータ // test ← テーブル名 foreach($_POST["id"] as $del){ delete test where id = $del; } 簡単にですいません;; 普通は上記のようにループさせながら削除すると思うのですが、ループさせないで一括で削除したいのですが可能でしょうか? 下記の様にカンマ区切りで一括削除は可能でしょうか? $sql = "delete test where "; foreach($_POST["id"] as $del){ $sql .= "id = $del, "; } クエリ発行
質問です。 ・DBMS名とバージョン 　　MySQL5.1.42 ・テーブルデータ 商品統計みたいの ID CREATED --+--------------------- user1 | メーカー1 | 商品名1 user2 | メーカー2 | 商品名2 user3 | メーカー1 | 商品名1 user4 | メーカー2 | 商品名1 user5 | メーカー1 | 商品名2 ・質問 商品コードがないので、メーカー名と商品名のマッチだけで統計をとりたいです。 同カウントの場合の順番は特にこだわらないです。 どうしたらいいでしょうか？ ・結果例 カウント | メーカー名 | 商品名 ------------------------- 　 2　　　| メーカー1　| 商品名1 　 1　　　| メーカー1　| 商品名2 　 1　　　| メーカー2　| 商品名1 　 1　　　| メーカー2　| 商品名2
DBに'no'というint型のフィールドがあってレコードは歯抜けになっています。 このとき、一番小さい数字の「4」を取得したい場合、どのような方法がよいのでしょうか？ レコード数から、ひとつひとつ見ていくのは余りに非効率だと思いましたが、よい案が浮か びません。アドバイスを頂けないでしょうか。 no ID 1 aaa 2 bbb 3 ccc 10 abc 11 efg
mysqlのｓｑｌ文について教えて下さい 下記のようなテーブルとデータがあった場合に どうやれば 2,次郎だけを抽出できますか？ 本日日付（2010-08-06）が 既にテーブルBにdateが存在する場合は 3,1,2010-08-04 3,1,2010-08-06を 対象外にしたいです。 Aテーブル id,user 1,太郎 2,次郎 3,３郎 Bテーブル targetid,homonid,date(datetime型) 3,1,2010-08-04 3,1,2010-08-06 3,2,2010-08-05 下記だと2010-08-04にヒットしてしまい（当たり前？）動作しません。 select distinct a.* from tblA a, tblB b where date_format(b.date, "%Y-%m-%d") <> "2010-08-06" ;
複数のtableから条件に一致するデータを取り出す方法 2つのテーブルから条件に一致するレコードだけを取り出したいです。 MySQLのバージョンは5.0.77です。 ------------------------------------------------------------------- 「テーブル1」 [itemNo] int型 auto_increment [itemName] varchar型 itemNo　itemName　　　　flag 1　　　　apple　　　　　0 2　　　　orange　　　　　1 3　　　　grape　　　　　0 4　　　　strawberry　　　1 5　　　　melon　　　　　1 「テーブル2」 [logNo] int型 auto_increment [itemNo] int型 [date] date型 [itemLog] int型 logNo　itemNo　date　　　　itemlog 1　　　4　　　2010/07/28　　1 2　　　2　　　2010/07/28　　2 3　　　2　　　2010/08/03　　1 4　　　1　　　2010/08/04　　1 5　　　4　　　2010/08/05　　2 ----------------------------------------------------------------------- ・テーブル1の「itemNo」とテーブル2の「itemNo」は同じ番号が入ります。 ・テーブル2は1商品に対する履歴用のテーブルなので、同じ「itemNo」が複数存在します。 「検索条件」 1.テーブル1の[itemNo]とテーブル2の[itemNo]が一致 2.テーブル1の[flag]が１のデータのみ表示 2,テーブル2に同一の[itemNo]が複数あった場合、[logNo]が新しい最新のものを取り出す 3.テーブル2に[itemNo]が存在しなくても、flagが1なら取り出す SELECT * FROM `テーブル1` LEFTJOIN `テーブル2` ON (テーブル1.itemNo = テーブル2.itemNo) WHERE `flag` == 1 ORDER BY テーブル1.itemNo DESC; 「実行結果」 itemNo　itemName　　　flag　logNo　itemNo　date　　　　itemlog 2　　　orange　　　　1　　　2　　　2　　　2010/07/28　2 2　　　orange　　　　1　　　3　　　2　　　2010/08/03　1 4　　　strawberry　　1　　　1　　　4　　　2010/07/28　1 4　　　strawberry　　1　　　5　　　5　　　2010/08/05　2 5　　　melon　　　　　1　　　 「求める実行結果」 itemNo　itemName　　　flag　logNo　itemNo　date　　　　itemlog 2　　　orange　　　　1　　　3　　　2　　　2010/08/03　1 4　　　strawberry　　1　　　5　　　5　　　2010/08/05　2 5　　　melon　　　　　1　　　 ご存知の方がいましたら、教えていただけると幸いです。 何卒よろしくお願い致します。
insertを用いてテーブルにレコードを追加することができるのにもかかわらず、load data infile を用いるとerror1366と表示されてしまいます。解決方法を教えてください。 Windows7 mysqlは最新版を使っています。 インストールしたそのままの状態だと、insertを用いて日本語を挿入しようとするとerror 1366と出てしまってましたが、my.iniを書き換えることによってinsert table1 values (1,'ああ');といった操作でエラーが出ることはなくなりました。 しかしcsvファイルをload data infileを用いてインポートしようとすると、またerror 1366が出てしまいました。 インポートしようとしたファイルには日本語が書かれています。 英字だけのファイルを同様にインポートすると、エラーは出ませんでした。 <table1> id int(15) name varchar(255) 1,a 2,b 3,asdf … はインポート可能 。また insert table1 values (1,'あ'); も正常に動作。 1,あ 2,い … をインポートするとエラー。 これができないと先に進めません・・・ ご教授お願いします。
2つの列を合わせてソートしたい。 table名：test 【name】　【area】　【ground】　【bldg】 　aaa　　　　3　　　　65.12　　　84.94 　bbb　　　　1　　　　24.6　　　　35.14 　ccc　　　　3　　　　112.58　　114.5 　ddd　　　　2　　　　54　　　　　83.14 　eee　　　　4　　　　89.25　　　41 　fff　　　　　3　　　　74.5　　　　99.10 「ground」と「bldg」はfloat型で、整数と小数点の数値が入っています。 やりたいことは「ground」と「bldg」の２つの列で数値が大きい順でソートしたい。 SELECT * FROM `test` ORDER BY `ground` DESC,`bldg` DESC; こうすると、当たり前な話ですが、「ground」でソートされた後に「bldg」でソートされてしまいます。 そうではなくて、「ground」と「bldg」を合わせて、ソートしたいのです。 【求める実行結果】 【name】　【area】　【ground】　【bldg】 　ccc　　　　3　　　　112.58　　114.5 　fff　　　　　3　　　　74.5　　　　99.10 　eee　　　　4　　　　89.25　　　41 　aaa　　　　3　　　　65.12　　　84.94 　ddd　　　　2　　　　54　　　　　83.14 　bbb　　　　1　　　　24.6　　　　35.14 色々と試してみましたが、うまくいかず前に進まない状態です。 何かいい解決法をご存知の方がいらっしゃいましたらご教授お願い致します。
mysqlのカラムaaaに、英文があり、そのなかに「ＪＵＳＴ」という全角の文字列が両方にあるとします。 select * from TABLE where aaa like "%ＪＵ%"（JUは全角） なら、該当行が表示されるのに、 select * from TABLE where aaa like "%ＵＳ%"（USは全角） という検索をphpmyadminで行っても、検索されません。 これはなぜなんでしょうか？全角が半角文字コードに変わるときに関係しているのでしょうか？ これを検索するようにする方法はあるでしょうか？ ちなみに、ＵＳを半角にすると、半角で登録されている行はちゃんと検索されます。
さくらのレンタルサーバで文字化けが発生します。 Mysqlの仕様は以下の通りです。 * サーバ: mysql110.db.sakura.ne.jp via TCP/IP * サーバのバージョン: 5.1.42 * プロトコルバージョン: 10 * ユーザ: * MySQL の文字セット: UTF-8 Unicode (utf8) perlスクリプトをUTF-8に変換してアップロードしています。 perlスクリプトからヒアドキュメントで出力されるコードはおよそ以下の通りです。 <?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitio … <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja"> <head> <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" /> <meta name="ROBOTS" content="INDEX,NOFOLLOW" /> <title>タイトル部分(文字化けしません)</title> </head> <body> <h1>ここは文字化けしません</h1> <p>ここが文字化けします</p> </body> </html> ここでtitleタグ、h1タグは正常に表示されます。 そして、Pタグの文字がデータベースから引っ張ってきた文字なんですが、この文字はUTF8で記録されたものですが、ここが文字化けします。 PHPMyadminからSHOW VARIABLESを実行して、文字コードが関連されていると思われる結果部分は以下の通りです。 character_set_client utf8 character_set_connection utf8 character_set_database utf8 character_set_filesystem binary character_set_results utf8 character_set_server ujis character_set_system utf8 character_sets_dir /usr/local/share/mysql/charsets/ collation_connection utf8_general_ci collation_database utf8_general_ci collation_server ujis_japanese_ci 以上の事から文字化けを直す方法をご教授いただければと存じます。 宜しくお願いいたします。
ロールバックが動作しない。 以下の文をSQLクライアントで実行するとテーブルに登録されてないはずなのですが、 なぜか登録されています。解決方法を教えてください。 ---------------------------------------------- SET AUTOCOMMIT=0; begin; INSERT INTO テーブル (カラム)VALUES ('ＡＡＡ'); rollback; -----------------------------------------------
mysqlに格納したエクセルファイルの、シート内の文字列を検索したいのですが上手くいきません。 半角英数の文字列なら、以下のSQL文で引っ張ってくることができました。 SELECT * FROM テーブル名 WHERE 列名 LIKE '%abc%'; mysqlのバージョンは5.1です。 検索はPHPで行おうと思っています。 どなたか知っている方いらっしゃいましたら、よろしくお願いします。
DBの最大数 `create database ○○;`で作成できるDBの最大数っていくつなのでしょうか。 詳しい方いましたら、ぜひご教授いただければと思います。 よろしくおねがいします。 mysql 5.1.36
ROUND関数で、四捨五入ができない。 カラムの値が'8.5'の場合'9'になるはずなのですが、'8'となってしまいます。 解決方法ありますでしょうか？ '4.5''6.5'の場合でも、四捨五入ができないです。 SELECT カラムＡ,ROUND(カラムＡ) FROM テーブル ---------------------------------------- 　カラムＡ　|　　ROUND(カラムＡ) ---------------------------------------- 　　5.5　　　|　　　6　　　　　　　　　　←四捨五入ができている ---------------------------------------- 　　8.5　　　|　　　8　　　　　　　　　　←四捨五入ができない ---------------------------------------- 　　4.5　　　|　　　4　　　　　　　　　　←四捨五入ができない ---------------------------------------- XAMPP 1.7.3の MySQL 5.1.41を使用しています。
ログファイルのファイルサイズについて my.iniで、 log=mysql.log と指定し、ログファイルを出力しているのですが、 バイナリログだとファイルサイズの指定が出来ると思うのですが、 普通のログファイルのサイズ指定をする方法はないのでしょうか？ 環境：Windows2008+Mysql5.1.34
VIEWの元のテーブルのindexって有効なのでしょうか？ MYSQLサーバのバージョンは5.0.77です。 どうぞよろしくお願いします。
ＭＹＳＱＬ5.0 ＳＱＬについて教えて下さい。 会員検索のページを作成していますが、どのように書いたらよいのか分からない検索条件の ＳＱＬを教えて欲しいのです。 テーブル(USER_TBL)には、ユーザーＩＤ(USER_ID)、趣味１(SYU1)、趣味２(SYU2)、趣味３(SYU3)、趣味４(SYU4)、趣味５(SYU5) の列があります。ユーザーＩＤは会員の各会員のＩＤを表しています。趣味の１～５は、趣味の種類で、それぞれ「0」か「1」の値が格納されています。 ちなみに「1」が趣味ありという意味です。 USER_TBL -------------------------- USER_ID CHAR(5), SYU1 SMALLINT, SYU2 SMALLINT, SYU3 SMALLINT, SYU4 SMALLINT, SYU5 SMALLINT 検索画面には趣味１～５のチェックボタンを用意します。（複数選択可） 画面でチェックした趣味と一つでも合致する会員を対象に 趣味が合致する数が多い順に３名を抽出するSELECT文を教えて下さい。 （例）テーブル(USER_ID)の全会員の中で趣味１か趣味２か趣味３か趣味５が「1」の会員を対象に 趣味１～３と趣味５の合計が大きい順に３名をSELECTする。 USER_TBL ---------------------- USER_ID SYU1 SYU2 SYU3 SYU4 SYU5 00001 0 0 0 1 0 00002 0 0 0 0 1 00003 1 1 0 1 1 00004 1 1 1 1 1 00005 0 0 1 1 1 画面（検索条件） ---------------------- 趣味１ ? 趣味２ ? 趣味３ ? 趣味４ 趣味５ ? 結果 ---------------------- USER_ID SYU1 SYU2 SYU3 SYU4 SYU5 00004 1 1 1 1 1 00003 1 1 0 1 1 00005 0 0 1 1 1 どうか宜しくお願いします。
MySQLでの近似値順での値の取得について質問させてください。 現在 store テーブルに、 店名　 番号 hanaya 138 sakaya 150 denkiya 140 honya 125 biyouin 166 izakaya 179 hotel 191 上記のようなフィールドとレコードがあります。 ここの番号フィールドから"141"という値に近い順に並べ替えて結果を取得したいと思っています。 ※141に近い順に並び替え denkiya 140　（-1なので一番近い） hanaya 138　（-3なので二番目に近い） sakaya 150　（+9なので三番目に近い） honya 125　（-16なので四番目に近い） biyouin 166　（+25なので五番目に近い） izakaya 179　（+38なので六番目に近い） hotel 191　（+50なので七番目に近い） 上記のような結果にしたいです。 この結果を得るにはどのようなSQLを書けば良いのでしょうか？ よろしくお願いします。
SQLだけでselect結果に定数を加算して別TBLに保存可能？ 似たようなケースを見つけられず、質問させていただきます。 MYSQL5＋PHP5の環境です。 「A_TBL」から特定条件でselectした結果を、「B_TBL」へ追加更新するSQLですが、「B_TBL」への追加時に一律、[gid]に「10」を加算して保存を行いたいのですが、sqlだけで可能でしょうか。 難しいようであれば、PHPで1行づつ処理を考えております。 REPLACE INTO B_TBL(gid,uid) SELECT gid,uid FROM A_TBL WHERE flg != 1; A_TBL、B_TBLのgid、uid共にint項目です。 よろしくお願いします。
MYSQLでSQLSERVERのリンクサーバーのようなことは可能ですか？ AとBのMYSQLサーバーがあり、AのDB接続からBのDBを参照したいのですが、方法はありますでしょうか？ 一つのSQL文にて下記のようなことを実現したいです。 SELECT * FROM servernamea.dbname.tablename LEFT JOIN servernameb.dbname.tablename ON servernamea.dbname.tablename.id = servernameb.dbname.tablename.id どなたかよろしくお願いします。
MySQLのチューニングについて パソコンのスペック ・windows Vista Home Premium ・プロセッサ Intel(R) Core(TM)2 CPU 4300 @ 1,80GHz 900 MHz ・メモリ（RAM) 2.00 GB ・システムの種類 ３２ビットオペレーティングシステム XAMPP ・PHP Version 5.2.3 ・Apache 2.2.4(Win32) ・MｙSQL 5.0.45 phpmyadmin ・フィールドが「名前」「郵便番号」「電話番号」「住所１」「住所２」「住所３」の６つです。 種別がすべてvarchar(30)、照合順序がutf8-unicode-ci, ディスクの使用量が、データが６００MB、インデックスが１０００バイト。 ７００万行あります。今後、行数を増やす予定です。 MySQLの設定について（my.cnf) # The MySQL server [mysqld] default-character-set=utf8 skip-character-set-client-handshake basedir="C:/xampp/mysql" tmpdir="C:/xampp/tmp" datadir="C:/xampp/mysql/data" old-passwords character-set-server = utf8 collation-server = utf8_general_ci init-connect = SET NAMES utf8 skip-locking key_buffer = 500M max_allowed_packet = 1M table_cache = 256 sort_buffer_size = 64k read_buffer_size = 256k read_rnd_buffer_size = 256k net_buthread_stack = 64k thread_stack = 64k [mysqldump] default-character-set = utf8 quick max_allowed_packet=100M [mysql] default-character = utf8 no-auto-rehash # Remove the next comment character if you are not familiar with SQL #safe-updates [isamchk] key_buffer = 500M sort_buffer_size = 8M [myisamchk] key_buffer = 500M sort_buffer_size = 8M [mysqlhotcopy] interactive-timeout 上記のような状況です。 検索速度を速くするために、チューニングが必要だと思われますが、 どこをどう修正したらよいか教えてください。
mySQL 3.23 インストールをする際の、ミラーサイトを探しているのですが、どなたかご存じありませんでしょうか。 以前同様のご質問がございましたが、ミラーサイトが閉鎖されておりましたので、再度ご質問致します。 ご存じの方、お手数をお掛けいたしましたら教えていただけましたら幸いです。 どうぞ宜しくお願いいたします。
速度向上。 Select A,B,C, (Select Count(*) FROM T_A WHERE SOME_ID = A.SOME_ID ) COUNTER , (Select MAX(REGISTER_TIME)FROM T_A WHERE SOME_ID = A.SOME_ID)MAX_REG_TIME FROM T_A as A WHERE ID LIKE '%1%' GROUP BY ID ORDER BY MAX_REG_TIME; テーブルT_AからIDに1が含まれるデータを全て抽出し、かつそれぞれのカウントを抽出し、かつ最新更新日でソートしたいと思います。 データ数が2000程度のテーブルで30秒ほどの時間がかかります。 より速くする良い方法はありますでしょうか？
DBサーバのSlaveサーバへの自動切換えの手法について こんばんわ。 会社でDBもろくに触ったことがないのに以下の要件でDBサーバを構築してほしいと頼まれました。 【要件】 2台のDBサーバを構築して、1台をmasterもう一台をslaveに設定する。 その2台はレプリケーションされているものとする。 masterのディスク障害時にslaveをmasterに「自動で」昇格させる。 共にOSはcentOSで、MySQLのバージョンについては指定されていません。 以下のサイトを見ると自動ではできないように見受けられるのですがいかがでしょうか？ http://www-jp.mysql.com/products/enterprise/high … なにぶんLinux、DBの知識が浅いためサイトを漁っても理解が追いつかないのが現状です。 何か上記の要件で構築するにあたり参考になるサイトがあればご教示いただけると幸いです。 なお、このDBサーバは商用ではなく検証用です。
mySQLのカラムの並び順によるデータ領域確保について http://d.hatena.ne.jp/yarb/20090519/p2 のような4バイト単位で領域を確保するのでしょうか？ 同じテーブルでも並び順は、4バイト単位を意識して、 パターン１で作成した方が効率は良いのでしょうか？ ■パターン１ tinyint(1) tinyint(1) tinyint(1) char(1) int int int ■パターン２ tinyint(1) int tinyint(1) int char(1) int tinyint(1)
演算子の件です。 例えば、 a.field と b.fieldが等しいデータと抽出 SELECT * FROM tablea AS a, tableb AS b WHERE a.field = b.field はOKなのですが、 a.field に b.fieldが含まれるデータと抽出 SELECT * FROM tablea AS a, tableb AS b WHERE a.field like %b.field% は駄目でした。 値であれば %atai% でOKだと思うんですが、フィールドを指定した値で 任意文字等を指定することは可能なのでしょうか？
普段、オラクルを常用しているものです。 mySQLを少し触ってみたところ、えらく簡単だし速いしで乗換えを検討しています。 ただ、オラクルの堅牢性がこのmySQLではどの程度なのか？という点を懸案してます。 InnoDBをいじってみた感触として「オラクルほど堅くはないんだろうが、MSのAccessよりはずいぶんまし」と感じてます。 実際に運用している方の肌感覚みたいなのを、教えていただければ幸甚です
SELECT文で抽出時に複数カラムのソート方法についてご質問します。 開発環境は以下になります。 ・PHP Version 5.2.11 ・MySQL (5.0) そこでやりたいことです。 レストランの開店時間が、バラバラに入力されるとして 以下のデータがDBに格納されています。 TABLE `reserve` ID,NAME,DATE1,FLAG1,OPEN1,DATE2,FLAG2,OPEN2,DATE3,FLAG3,OPEN3 1,Ａ店,2010-07-05,0,10:00,2010-07-06,1,12:00,2010-07-07,1,10:00 2,Ｂ店,2010-07-06,1,13:00,2010-07-07,1,13:00,2010-07-08,1,13:00 3,Ｃ店,2010-07-06,0,11:00,2010-07-07,0,11:00,2010-07-08,1,16:00 4,Ｄ店,2010-07-04,1,10:00,2010-07-05,0,10:00,2010-07-06,1,10:00 5,Ｅ店,2010-07-06,0,13:00,2010-07-07,1,11:00,2010-07-08,0,13:00 5,Ｆ店,2010-07-07,1,10:00,2010-07-08,0,10:00,2010-07-09,1,10:00 ・ ・ ・ 種別は ID：主キー NAME：VARCHAR DATE1～3：DATE FLAG1～3：INT OPEN1～3：TIME ※FLAG1～3は、0=店休日、1=営業日です。 ここから毎日の開店状態を、早い開店から順番に表示したいのです。 7月7日の開店状態を表示する場合の結果は 2010年07月07日 Ａ店：10:00開店 Ｆ店：10:00開店 Ｅ店：11:00開店 Ｂ店：13:00開店 ・ ・ ・ このように、開店時間が早い順からソートして出力となります。 そこで以下のセレクト文で呼び出してみると抽出はうまくいきました。 SELECT * FROM `reserve` WHERE `DATE1` = '2010-07-07' AND `FLAG1` =1 OR `DATE2` = '2010-07-07' AND `FLAG2` =1 OR `DATE3` = '2010-07-07' AND `FLAG3` =1 しかし、ソートがうまくいきません。 ORDER BY `TIME1` , `TIME2` , `TIME3` ASC ORDER BY `TIME1` ASC , `TIME2` ASC , `TIME3` ASC ORDER BY `TIME1` `TIME2` `TIME3` ASC そこで、TIME1～TIME3をまとめてインデックスにしてみました。 でもうまくいかないです。 色々と試してみましたがうまくいきません。 根本的に間違えているのでしょうか？ データを取り出してから、PHPでソートをかける方が良いのでしょうか？ PHPでソートをするには、DBから取り出したデータを、連想配列に変換して ソートしてとなると思いますが。 抽出したデータを表示後、さらに店名でソートして再表示したりという ことを考えているので、出来ればSELECT文で実現したいと思い、 質問させていただきました。 ご教授いただければ幸いです。 何卒よろしくお願い致します。
1対1のリレーション（主キー同士）はどういった時に使うものなのでしょうか？ 意味が無いように思えるのですが、メリットやデメリットがあれば合わせて教えていただけないでしょうか？ データベース初心者です。ご教授お願いいたします。
LEFT JOIN とRIGHT JOINの合体版のような結合方法。 使用DBはMySQL5.0.45です。 ２つのテーブルの結合方式で、結合条件に合致しなかった場合、 両方のデータを結果セットに含めることはできますか？ LEFT JOINだと、左側のテーブルのデータは結果に返ってきて、右側のデータはNULLになります。 RIGHT JOINだと、右側のテーブルのデータは結果に返ってきて、左側のデータはNULLになります。 これを「左側データあり右側NULL」「左側NULL右側データあり」というレコードを混ぜて結果として返したいです。 具体的には、 以下二つのテーブルがあるとします。 table : test1 value　　id ------------------- ああ　　　3 いい　　　4 うう　 　 　5 table : test2 value　　id -------------------- AAA　　　1 BBB　　　2 CCC　　　3 DDD　　　4 id を結合条件のキーとして、以下のような結果を得たいです。 NULL　　NULL　　AAA　　　1 NULL　　NULL　　BBB　　　2 ああ　　　3　 　　　CCC　　　3 いい　　　4　 　　　DDD　　　4 うう　 　　5　　　　NULL　　 NULL LEFT JOINだと以下の結果に、 SELECT * FROM test1 LEFT JOIN test2 ON test1.id=test2.id ああ　　　3　 　　　CCC　　　3 いい　　　4　 　　　DDD　　　4 うう　 　　5　　　　NULL　　 NULL RIGHT JOINだと以下の結果になってしまいます。 SELECT * FROM test1 RIGHT JOIN test2 ON test1.id=test2.id NULL　　NULL　　AAA　　　1 NULL　　NULL　　BBB　　　2 ああ　　　3　 　　　CCC　　　3 いい　　　4　 　　　DDD　　　4 以上、ご教示お願い致します。
ユーザー名にアンダーバーを含む場合のデータベース作成について mysql > create database demo_demo; mysql > grant all on demo_demo.* to demo_demo@localhost 上記のSQL を発行した場合、「demo_demo」というデータベースと、ローカルから「demo_demo」データベースにALL の権限の範囲内でアクセスできる「demo_demo」というユーザーが作成されると思います。ここで２点教えてください。 質問１： ALL権限には「create database」を許可するCREATE権限が含まれますが、上記「demo_demo.* 」のように、grant 時に特定のデータベースに対してのみALL権限を与えた場合の「create database」を許可するCREATE権限とはどういう意味を持つのでしょうか？ 質問２： mysql > create database `demotdemo`; など、ユーザー名のアンダーバー部分に任意文字を当てたデータベースが無限に作成できてしまいます。アンダーバーがSQL的に「任意の一文字」に相当するとは理解していますが、「demotdemo」などのデータベースが作成できてしまうのはmysql の仕様でしょうか？また、ユーザーが「create database」可能かでないかの判定はどの権限で制御されているのでしょうか？ 参考資料でもよいので教えてください。お願いします。
フィールドを連結しグループ化した時の値の枝番の最大値を常に表示 すいません。MYSQLでこんなことができるのかお教えください。 mysqlバージョンは、5.0.45を使用しています。 1.以下のような図面を管理するテーブルがあるとします。 例 テーブル：a(図面管理) a_id(id) a1(図番) a2(種類用紙サイズ) a3(枝番) a4(図面名) a_id　a1　a2 a3　a4 1　　　1　3P　0　aaaa 2　　　2　3P　0　bbbb 3　　　2　3P　1　bbbb 4　　　1　4P　0　cccc 5　　　1　4P　1　cccc 6　　　1　4P　2　cccc 2.このテーブルのa1とa2を連結したとします。(連結フィールド：ren) ※a1とa2を連結した名称を図面名として使用しています。 ※a3が枝番で図面のマイナーチェンジのバージョンだとお考えください。 a_id　a1　a2 a3　a4　　ren 1　　　1　3P　0　aaaa　13P 2　　　2　3P　0　bbbb　23P 3　　　2　3P　1　bbbb　23P 4　　　1　4P　0　cccc　14P 5　　　1　4P　1　cccc　14P 6　　　1　4P　2　cccc　14P 3.この連結したフィールド(ren)の枝番(a3)の最大値(max_a3)をSQLで表示させたいのですがどのようにしたらいいのでしょうか？ このような結果は求められるのでしょうか？ 最終的な結果表示 a_id　a1　a2 a3　a4　　ren max_a3 1　　　1　3P　0　aaaa　13P 0 2　　　2　3P　0　bbbb　23P 1 3　　　2　3P　1　bbbb　23P 1 4　　　1　4P　0　cccc　14P 2 5　　　1　4P　1　cccc　14P 2 6　　　1　4P　2　cccc　14P 2 説明がへたかもしれませんがよろしくお願いします。
MySQLのストアドプロシージャーでの引数に日本語が使えますか 自分なりに調べてみましたがはっきりとした結論が得られませんでした。 MySQLのストアドプロシージャーの引数に日本語（２バイト文字）を使うことは可能でしょうか？ どのバージョンでも構わないのですが、ストアドプロシージャーを使用するのでVer5.～の最新のバージョンを使うことになるでしょうか。 文字エンコードは全てUTF８を想定しています。
mysqlでyahooやgoogleのような検索スピードを出したい yahooやgoogleで検索するとどんなキーワードを入れても1秒以内に結果が返ってきます。 mysqlでデータ1000万件程度を想定してるのですが、いくらネットで調べて最適化したインデックスを貼っても全文検索にしてもyahooやgoogleのようにはいきません。 これは主にハード構成が主因となってるのでしょうか？ サーバーを並列化するとかってのをネットで見ることもあるのですが具体的にどうなってるから速いのかよくわかりません。 そのあたりのご教授お願いします。
mysqlの型について質問です。 mysqlでvarchar(1) nullという使い方はどのような時に使用するのでしょうか？ 可変長文字列で1文字でnullが有効と言うことは char(1) nullで良かったりするのでしょうか？
簡単なCMS 一番簡単に操作できるCMSはなんですか。 Joomla、xoops、zencartなどいじってみましたが、あまりなじめませんでした。 記事が書けて。会員制にできて、newsletterが発行できれば、それだけでよいのですが。 よろしくお願いいたします。
MySQLのインデックスについて 検索画面で検索条件となるテキストフィールドが5つ(仮に住所、年齢、名前、電話番号、メールアドレス)あった場合全てのテキストに値を入力すると WHERE 住所 = 'XXXXX' AND 年齢 = XX AND 名前 = 'XXXX' AND 電話番号 = XXXX AND メールアドレス = 'XXXX' (Xは入力値) といった具合のSQL文になります。 最低でもどこかのテキストフィールドの1つが必須入力の場合、インデックスを貼るのであれば5つのフィールドのあらゆる組み合わせのインデックスを作成しなければならないので膨大なデータ量(1億件)がある場合はインデックスサイズも大きくなりますし、既に存在するデータに対してインデックス作成するのでそれだけで相当な時間がかかります。 しかしインデックスがないと検索に相当な時間がかかるのでインデックスはどうしても必要です。 こういった場合の対処法を教えてください。 MySQLはMyIsamを使ってます。 よろしくお願いします。
MySQL Serverへのリモート接続について 似たような質問がいくつかありましたので確認させていただきましたが 解決できなかったので質問させていただきます。 今回、新しくWindows2008Serverを立ち上げて、そこにMySQLserverをネットを頼りに設定したのですが、そのserverがローカルの域を出ず、リモートで接続することができません。 一応、過去の質問からリモート権限をもったユーザを作成し、そのユーザでクライアントPCからMySQL Administratorで接続を試みたのですがだめでした。 また、過去の先輩が設定したリモート接続できるMySQLserverがあるので、 MySQL Administratorでステータスを見比べてみると Server InformationのNetwork NameやIPが指定したDNSになっておらず 127.0.0.1になっていました。 (2008サーバにはちゃんとDNSがありリモートデスクトップで操作できます) どうすればMySQLserverをリモートから操作できる(127.0.0.1ではなくきめられたIPに設定できる)ようになるのでしょうか。 初心者で意味不明な文章も多々あるかと思いますが、 どうかご教授願えないでしょうか。 失礼いたします。
わり算の結果が整数でも小数点以下4桁まで表示されてしまう！ 同じような質問で恐縮なのですが、 例えば、100、101というデータをMySQLの算術演算子/を使って2で割ると、 50.0000、50.5000のように、整数だろうが小数だろうが、小数点以下4桁まで出てしまいます。 これを、いろんな関数を駆使して50、50.5にすることはできますか。 50、51または50.0、50.5のように小数点の位置を同じずつ動かすことはできるのですが、これでは嫌だなぁと思った次第です
バージョンの違うMySQLのリモート接続について ｍｙｓｑｌのリモート接続について。 質問させて頂きます。 サーバー側はＭＹＳＱＬ5.0　　ＯＳ　ＸＰ_PRO クライアント側はＭＹＳＱＬ4.0　ＯＳ　Ｗｉｎ９８ クライアント側からサーバ側のＭＹＳＱＬに接続させたいのですが、 ＭＹＳＱＬ　-u root -p -h ＩＰアドレスとコマンドを打つと ERROR 1251: Client does not support authentication protocol requested by server; consider upgrading MySQL client と表示され接続できません。 MYSQLのバージョンが違うためサーバ側とクライアント側の ＭＹＳＱＬのパスワードの形式が違うため接続できないとエラーが表示されます。 バージョンの違う、ＭＹＳＱＬ同士ではリモート接続できないのでしょうか？ 解決方法等ございますでしょうか？ よろしくお願いします。
PHP/MySQL INSERT文について。 こんばんは。 PHP・MySQLでデータベースへデータの書き込みを試行錯誤しております。 そこで一つどうしても解決出来ない問題(謎)があるので質問させて頂きます。 簡易的な質問内容としては 全てのカラムに対する値の挿入は可能なのに カラムを指定して値を挿入しようとしたらエラーが出ます。 データベースの設定はテーブル名【TESTtable】 フィールド種別NULL属性/その他 AAAint(6)NoUNSIGNED ZEROFILL / auto_increment BBBint(4)Yes CCCint(4)Yes DDDint(4)Yes PHPでのSQL実行文をしてはの記述としては(値は全て可変で数値を代入します。) INSERT INTO TESTtable VALUES (last_insert_id(),50,600,50) とした場合は問題無くテーブルに書き込みされますが カラムを指定して INSERT INTO TESTtable (AAA,BBB,CCC,DDD) VALUES (last_insert_id(),50,600,50) とした場合、書き込みが行われません。 INSERT INTO TESTtable ('AAA','BBB','CCC','DDD') VALUES (last_insert_id(),50,600,50) INSERT INTO TESTtable (AAA,'BBB','CCC','DDD') VALUES (last_insert_id(),50,600,50) INSERT INTO TESTtable ('AAA','BBB','CCC','DDD') VALUES (last_insert_id(),'50','600','50') 等、色々試してみましたが不可能でした。 カラムAAAはauto_incrementにりますので毎回書き込みされますが BBB、CCC、DDDは書き込みが不要の場合もあるので カラム指定の書き込みは必須となるのですが・・・行き詰ってしまいました・・・。 ご教授頂ければ幸いです。 どうぞ、宜しくお願い致します。
ヌル値は記憶容量を必要としないのか？？？ 例えばTINYINT列は1行につき1バイトの記憶容量を必要としますが、ここにヌル値を格納した場合は0バイトとなるのでしょうか。 もしそうなら、値0よりもヌル値を多用した方が、ディスクの節約になるのかなと^^
名簿のテーブルから「名前」か「読み」が一致する人を抽出したいと思っています。 $namekey = "佐藤"; $yomikey = "さとう"; mysql_query("SELECT * from meibo where name = '$namekey' or yomi = '$yomikey'); このようにしたところ、検索ワードである「佐藤」「さとう」もいっしょに抽出してしまいました。 検索ワード以外だけを抽出したい場合はどのような方法があるのでしょうか。
小数点以下桁数が最大の値に小数点以下桁数を揃えるにはどうしてますか 例えばSELECT文で取ってきた値が、 0.05と0.1だった場合は、0.1を0.10としたいです。 0.5と2だった場合は、2を2.0としたいです。 1と2だった場合は、1も2も、そのままとしたいです。
MySQLのバックアップについて フルテキストインデックスを使用したレコード数15万行、総容量500MBのテーブルと、 その各レコードに対応する細かいデータを格納しているレコード数15万行、容量3MB程度のテーブル3つがあります。 各テーブルでレコード数が毎日約300行、1ヶ月約1万行ほどのペースで増え、古いレコードも頻繁に更新されます。 このようなテーブルを定期的にバックアップしたいのですが、 どのように行うのが良いのでしょうか？ サーバーの仕様を確認したところ、mysqldumpは使用できるようです。 3つのテーブルを1つのファイルにmysqldumpしgzipしたところ容量は70MBでした。 mysqldumpした結果をphp等からGmail(Googleの大容量メールサービス)に送信し、 30日経ったら自動で削除されるように設定するのが良いという説明を読んだのですが、 Gmailの添付ファイルの容量制限は25MBだそうです。 ちなみに、レンタルサーバーのメールボックスの容量制限は30MBでした。 通常のメールに送り、Outlook等で定期的に削除する設定を行った場合、 すぐに(と言うか1回未満で)容量制限をオーバーしてしまうということなのでしょうか？ そもそも500MBのテーブルのmysqldumpやそれを添付したメールの送信には サーバーにどれくらいの負荷がかかっているのでしょうか？ 毎日1回実行しても良い程度の負荷なのでしょうか？ （データベース容量制限3GBの共有サーバーを使用しています） 以上、よろしくお願いします。
phpとmysqlでデータの一覧表示をしたいと思っています。 ずらーっと並べるだけでなく、1ページに100件した場合には 10行毎に<hr>や<br>などのタグを挿入して間隔を空けたいのですが どのようにしたらいいのか悩んでいます。 現在は下記のようにLIMITで何度もqueryを発行しています。 できれば1回のqueryで処理したいのですが 他にどのような方法があるでしょうか。 $rs = mysql_query("select * from data order by id desc LIMIT 0,10 ;",$conn); while($rec = mysql_fetch_array($rs, MYSQL_ASSOC)){ $site = $rec['site']; $url = $rec['url']; echo '<a href="'.$url.'">'.$site.'</a>'; } $rs = mysql_query("select * from data order by id desc LIMIT 10,10 ;",$conn); while($rec = mysql_fetch_array($rs, MYSQL_ASSOC)){ $site = $rec['site']; $url = $rec['url']; echo '<a href="'.$url.'">'.$site.'</a>'; } $rs = mysql_query("select * from data order by id desc LIMIT 20,10 ;",$conn); while($rec = mysql_fetch_array($rs, MYSQL_ASSOC)){ $site = $rec['site']; $url = $rec['url']; echo '<a href="'.$url.'">'.$site.'</a>'; } よろしくお願い致します。
DB:　MySQL　バージョン：5.0.45 条件： NOのデータ型は、Varchar NOは、1から11まで存在しているとします。 １）Select MAX(NO+1)　は、12が取得されます。 ２）Select MAX(NO)+1　は、10が取得されます。 上記のような１）、２）のような違いがでる理由が知りたいです。 １）は、MySQLの仕様？で自動でint型に変換されているため、最大値11を取得し、+1をしているのでしょうか？ よろしくお願い致します。
テーブル設計の主キーについて質問があります。 マスタを物理削除せず、論理削除するデータベースを考える時、 削除日時を主キーに持ってきたりするレイアウトはよくありますでしょうか。 DBはmysqlです。 例） ＜会社マスタ＞ （PK)会社コード （PK)会社支店コード （PK)削除日時 　　　会社名 　　　住所 主キーにNULL値は入れられないと思うのですが（←あっていますでしょうか）、 削除日時を無理やりNULL以外のものを入れたとします。 そしてアプリケーションで検索を考えた時に、”削除になっていないもの” を対象にレコードを探します。 インデックス（この場合は主キーですが）が検索高速化に有効に使われるのは、 なるべく対象が少なくなるものと思います。 以上を考えれば、 割合が多い削除日時を主キーにもってくるのはいかがなものかと思うのですが、 どうなのでしょうか。 宜しくアドバイスお願いいたします。
PHPで外部サーバーのデータベースにアクセスは可能でしょうか？ データ量が多すぎて複数のデータベースに分けております。 またサーバーも変える必要があるためサーバーも複数に分けております。 サーバー１にデータベース１ サーバー２にデータベース２ サーバー３にデータベース３ がある状態で、サーバー４からPHPプログラムでデータベースにアクセスして、サーバー4に設置してあるホームページにデータを表示するプログラムを作りたい。 このような事が出来るのでしょうか？ PHPプログラムが置いてある同一サーバー上のデータベースへのアクセスは出来たのですが、外部サーバーへのアクセスの仕方が解りません。。。 サーバーはXrea、さくらインターネットを使用しています。 PHPとMySQLを使用。 よろしくお願いします。
データベースの設計について教えてください。 基本的な質問ですみません。宜しくお願いいたします。 単純なテーブルで表現しますが、 パターンA、Bのどちらのテーブルで設計するのが良いのでしょうか。 DBはmysqlで5000万件のデータで検索のみのデータベースです。 【前提】 ユーザは複数のメールアドレスを持ちます。 画面から、このユーザのもつメールアドレスを表示させる仕様だとします。 【userマスタ】 (PK)ユーザID 　　ユーザ名 　　会社名 ＜パターンA＞ 【mailテーブル】 (PK)ユーザID (PK)ユーザメールアドレス 　　モバイル用アドレス ＜パターンB＞ 　【mailテーブル】 (PK)ユーザメールアドレス 　　モバイル用アドレス 　　ユーザID　←インデックスをはります。
ENUM列に列挙されていない値を挿入しようとしたときエラーにすることはできますか 例えば、 ENUM('-10', '-5', 'なし', '+5', '+10') と定義した列に対して、'+2'を挿入しようとした場合はエラーにしたいです。 現状では、'+2'を挿入しようとすると、2番目の値と解釈され、'-5'が挿入されてしまうようです。 バッチ処理が、やっとこさ終わったと思いきや、データを確認してみてビックリですx_x
MySQLでのあいまい検索について、教えてください。 長いですが、最後までお付き合いください。 今、入っている全データは、以下の通りです。 fieldはnum,nameです。 1 あいうえお 1 かきくけこA 1 さしすせそB 1 たちつてとC 1 まみむめもF 2 あいうえお 2 かきくけこA 2 さしすせそB 3 わおん 3 らりるれろA 3 たちつてとC 3 なにぬねのD 4 かきくけこA 4 はひふへほE 4 まみむめもF 5 Aあいうえお 6 あいAうえお 7 あい A うえお ここから、あいまい検索でnameに「A」を含むものを抽出したいので、 select num, name from ○○ where name like '%A%' order by num; としました。すると出てくるのは、 1 かきくけこA 1 たちつてとC 1 まみむめもF 2 かきくけこA 3 らりるれろA 3 たちつてとC 4 まみむめもF 4 かきくけこA 5 Aあいうえお 6 あいAうえお 7 あい A うえお が出てきてしまいます。「A」が含まれる物は全て出ますが、それ以外の物まで出ます。 また、「C」で同じことをすると、 1 たちつてとC 3 らりるれろA 3 たちつてとC 「E」では、 3 らりるれろA 3 なにぬねのD 4 はひふへほE 「D」でも別の物が出てきます。しかし「B」「F」は正常に出ます。 他にも、ひらがな「に」でやってみても、 3　らりるれろA 3　なにぬねのD と出ます。 なぜ、このようになってしまうのでしょうか？ あいまい検索の仕方を間違っているのでしょうか？ よろしくお願い致します。
ＭｙＳＱＬとＳＱＬｉｔｅの違いについて。 ちょっと調べたところによると、ＳＱＬｉｔｅはアプリケーションに組み込んで使い、 ＭｙＳＱＬはサーバーとして使うそうですが、その意味がいまいちわかりません。 それは、ＭｙＳＱＬは複数のクライアントの共有データベースとして使うけど、 ＳＱＬｉｔｅは個人ユーザーの単体データベースとして使うということでしょうか？ よろしくお願いします。
MySQLのクエリーについての質問です。 PHP4.2 MySQL4.xxを使ってる素人です・・・ 会員管理システムを構築して新規会員紹介の欄に以下のクエリーで情報をDBから引っ張ってました。 select * from member order by entry_date desc limit0, 10 entry_date は登録した日時です。 新しく登録された情報は10件まで表示されるようにしていました。 最近クライアントから「登録の新しい人に加えて、最近更新した人も表示させて欲しい。」と 言われました。 会員情報は編集できるようになっていた編集した際update_dateというフィールドに 時間が保存されます。 新規の時間と変更された時間を全て含めて新しい時間順に10件表示するにはどのようなクエリー書いたらいいでしょうか？ select * from member order by (entry_date and update_date) desc limit0, 10 とかありえますか・・・？ それか常にupdate_dateの新しい順に並べるようにして 新規登録した際にはentry_date と update_date　の両方に同じデータを書き込むしかないでしょうか・・・？ 何とかクエリー的に解決したいところです・・・ どうかお知恵をかしてください！ よろしくお願いします。
perlのDBIよりMysqlにアクセスすると DBD::mysql::db do failed: Data too long for column...のエラーが発生します。 つまり長すぎるデータを格納しようとしてエラーが出ているようです。 格納するデータの文字コードはutf-8です。 カラムは試しにvarchar(255)にしていますので、おそらく文字コードが原因ではないかと推測しています。 phpMyAdminから　SHOW VARIABLES;コマンドを実行したところ 文字コード関係は以下の設定です。 character_set_client utf8 character_set_connection utf8 character_set_database utf8 character_set_filesystem binary character_set_results utf8 character_set_server sjis character_set_system utf8 character_sets_dir C:\Program Files\MySQL\MySQL Server 5.0\share\char... collation_connection utf8_general_ci collation_database utf8_general_ci collation_server sjis_japanese_ci 開発環境は MySQL - 5.0.24-community-nt phpMyAdmin - 2.8.2.2 MySQL クライアントバージョン: 4.1.7 OS;WIN_XP Active Perl 5.8.8 です。 お気付きの点がございましたらご指摘宜しくお願いいたします。
Mysqlでエラーが出ています。 100603 23:11:28 [ERROR] /www/local/mysql/libexec/mysqld: Out of memory (Needed 1048584 bytes) どのメモリを増やせばいいかよく分かりません。 教えてください。
集計表が作れない お世話になります あるレンタルサーバーでウェブページを作成しています 環境はWin vista PHP5 apache2.2 mysqlです。レンタルサーバーの都合によりViewが作成できませんので ＰＨＰで集計表を作成しようと思っています。一覧のcolumn列の総数を求めようというものです。 下記のコードのようにしたのですがうまく表示できません。よろしくご教示願います。 これより上省略ーーーーーーーーーーー <table border=1> <tr> <th>合計</th> </tr> <?php while($row = mysql_fetch_assoc($result)) { $mino = $row['suu']; $goukei = $row['kei']; $row['kei'] = sum($mino);//←ここがうまく書けていない？ $data_id = $row['id']; echo '<tr>'; echo '<td><input type="radio" name="select" value='.$data_id.'></td>'; echo '<td>'.$data_id.'</td>'; echo '<td>'.$row['kei'].'　</td>'; echo '</tr>'; } ?> </table> <input type="submit" value="詳細を見る"> </form> <?php
データベース一覧の表示について mysqlshow すると +--------------------+ | Databases | +--------------------+ | information_schema | | mysql | +--------------------+ のようにフォーマットされて表示されるのですが、これを information_schema mysql のようにデータベース名だけを表示させることは できないでしょうか。 スクリプトで不要な部分をカットする、DB アクセスプログラム をくみデータベース名を抽出するなど、方法はいろいろあると 思いますが、手軽な方法を探しています。
MySQL5で、SUMした値を新たにカラムとして追加したビューを作成したいのですが、どういうSQLを書けばよいかわかりません。 今、Aというテーブルがあり、f1,f2,f3というカラムがあります。 このテーブルを元にvwAというビューを作成したいのですが、その際、f1でGroup Byしたf2のSUMをf2Keiというカラム名で追加し、最終的にf3とf2Keiという２つのカラムを持ったビューにしたいです。 create view vwA as select f3,select SUM(f2) as f2Kei from A GROUP BY f1 from A; と書いてみましたがエラーを返されました。 どのようなSQLを書けばよいか、ご教授ください。
SQLの問題について Student(snum: integer, sname: string, major: string, level: string, age: integer) Class(name: string, meets at: time, room: string, fid: integer) Enrolled(snum: integer, cname: string) Faculty(fid: integer, fname: string, deptid: integer) これらが定義されており、主キーはStudentはsnum、Classはname、Enrolledはsnumとcname、Facultyはfidという風になっています。 1. Find the names of all Juniors (level = JR) who are enrolled in a class taught by I. Teach. 2. Find the age of the oldest student who is either a History major or enrolled in a course taught by I. Teach. の問題があるのですがどうSELECT文を書けばいいかわかりません。 教えていただけると本当にありがたいです。 よろしくおねがいします。
テーブルを結合する構文はUNIONやJOINがありますが この場合クエリー速度は１本のテーブルと複数のテーブルではどの程度 違うのでしょうか？ また物理的に複数のテーブルを１つにしたい場合に何かいい方法は ないでしょうか。
Mysql でレコードを追加した時間はMysql側で自動的に保存していて それを取得できるようになっていますでしょうか？ それとも入力する側が気をまわして入力時間を保存するしかないでしょうか？ ご存知の方教えていただければ幸いです。
エクセルへの出力について 出力ボタンを押したら、エクセルに連続した番号とそれに紐づくIDを、HSSFWorkbookを使って30万件出力させたいのですが〔50000件×６シート〕14万件でアウトオブメモリーで落ちてしまいます。いろいろと試行錯誤はしてみたのですが、ダメでした。 なにか良いアイデアはないでしょうか！？！？ ちなみにDBはMySQLを使っています。 evictは使いましたが、やはりダメでした。 すみません助けてください。
業務用データベースの開発費 バックエンド：MySQL（30テーブル、200カラム、テーブル単位でのGRANT5種、5～20ユーザ程度） フロントエンド：MS ACCESS（50～60フォーム＋適当なVBA） ざっとこのくらいで、外注するとどの程度費用がかかるものなのでしょうか？ 適当で良いので教えて下さい。 よろしくお願いします。
mysqlでdate型のカラムに今日から1年分の日付を挿入するSQLは書けますでしょうか ・テーブル 　T_TEMP ・カラム 　M_DATE (DATE型) ・SQL 　insert into T_TEMP (select ???); 以上、よろしくお願いいたします。
MySQLを使ったWebアプリケーション(PHP)を作っているのですが、特定のカラムだけ文字化けして保存されてしまいます。 name1 name2 ?????? 太郎 上記ではカラムname1は文字化けしているのに対し、カラムname2は文字化けしていません。 ブラウザでの表示は文字化けしません。 何が原因だと考えられますか？
windows7でのmysql ODBCの設定について PC勉強中の者です。 windows7でのmysql ODBCの設定について mysqlのサイトから「mysql-connector-odbc-noinstall-5.1.6-winx64」を ダウロードしてきましたがここからどうすれば宜しいのでしょうか。 スペック windows7 64bit
phpmyadminでデータベースを見た場合各テーブルの種類はInnoDBなのに合計のところの種類がMyISAMになっています。コマンドプロンプトからコマンドを打って合計の種類をInnoDBに変更するにはどのようにコマンドを打てばいいのでしょうか。
MySQLで特定の条件のレコードをテーブルから検索するクエリ文がわかりません。 テーブルの構造は以下のとおりとします。 member_id INT post_no INT goods_no INT 上記のテーブルから、複数のgoods_noが指定された時（指定されるgoods_noは１個から１０個までの間とします）それらの指定された値をすべて含むmember_idとpost_noの組み合わせをすべて検索したいのです。 よろしくお願いします。
XAMPPのMySQLで削除済みレコードが表示される XAMPP1.7.3をWinXP Proにて運用しています。 PHPにてselectのSQLを実行したところ、削除済みのレコードが表示されるため困っています。 これまでの経緯は １．phpMyAdminにてDBとテーブルを作成し、サンプルデータを4件登録 ２．PHPからselectで条件なしで全レコードが表示されるのを確認 ３．条件をつけてselectし、それぞれの条件にマッチしたレコードが表示されるのを確認 ４．phpMyAdminにて1レコードを削除 ５．条件をつけてselectし、削除したレコードが表示されるのを発見 ６．phpMyAdminのSQLで同じ条件のSQLを実行し、削除レコードが表示されないのを確認 ７．PHP側のselect後にDBCloseをしているかの確認 ８．phpMyAdminにてテーブルの修復、最適化などを実行 ９．MySQLの再起動 以上の操作をしてみましたが、やはりPHPからのSQLの結果に削除されたレコードが表示されてしまいます。 色々なサイトで同じような現象のTipsがないか探しましたが、見つけきれず質問させていただきます。 同じような現象に対しての対応を紹介したサイトや、対処方法をご教授下さい。 よろしくお願いします。
Index の使い方、where a.カラム1 LIKE CONCAT(b.カラム2,'%') お世話になります。 テーブルA： idphone ----------------------------------- 1819011112222 2819022223333 381312345678 4651112222 58699998888 6819011112222 テーブルB： idName Pref --------------------------------------------------- 1Japan-18131234 2JP-Mobile8190 3China-1869 4China-2868 5Japan-2813 6Japan81 7Singapore65 このようなテーブルで、テーブルBはレコード数が数千件あります。 数千件でしたし、データを取るのに遅いとは思いますが、 なんとか耐えらえた範囲なので下記のように実行しておりました。 select a.*,b.Name,b.Pref FROM テーブルA a, テーブルB b where a.phone LIKE CONCAT(Pref,'%') group by a.id; 結果 idphoneName ---------------------------------------------------- 1819011112222JP-Mobile 2819022223333JP-Mobile 381312345678Japan-2 4651112222Singapore 58699998888China-1 5862223333China-2 6819011112222JP-Mobile テーブルB Prefに対してIndexを作成していますが、どうも作動していないようです。 Indexに関してよく理解できていなかったので、気にしていなかったのですが、今回早さを比べる為に Indexあり、なしで試しみても大して変っていませんでした。 今のところ、Indexを使えていなくても問題ないのですが、今後テーブルBのデータが数万件に増えてしまい、今までのやり方が通用しません。 効果的に使用する方法をアドバイス頂けませんでしょうか。 よろしくお願いします。
データベースの設計について少し疑問が出たので投稿しました。 数千万レコードを取り扱う場合、以下のどの構成が一番クエリを早く実行できるのでしょうか？ １．１つのデータベースに１つのテーブルを構築して全てのレコードを格納。 ２．１つのデータベース内に複数のテーブルを構築して、レコードを分散して格納。 ３．複数のデータベースにそれぞれ１つのテーブルを構築して、レコードを分散して格納。 データベースはMySQLです。 参考までに、ご意見をお聞かせいただければと思います。 宜しくお願いします。
IFとか条件分岐するSELECT文 mytableというテーブルを設け、好きな家電メーカーを３つ挙げてもらい、kaisya1、kaisya2、kaisya3にInsertしました。 また、３つのうち、一番好きなメーカーを社名フラグ（kaisyaFlg；0か1か２で）にInsertしました。 これらの４フィールドを参照し、「一番好きなメーカーリスト」を出すselect文をご教示ください。 PHP側でやるなら、こうなるのでしょうが、MySQL側で「スマートに（？）」処理できないでしょうか。 if ($kaisyaFlg = 0) { $kaisya = $kaisya1; } elseif ($kaisyaFlg = 1) { $kaisya = $kaisya2; } elseif ($kaisyaFlg = 2) { $kaisya = $kaisya3; } echo "一番好きなメーカーは、" . $kaisya;
[MySQL]LOAD DATA INFILE一部レコードがスキップされてしまう。 いつもお世話になっております。selfesteemです。 今回はMySQLについての質問です。 仕事である機関が提供するデータをMySQLで扱うのですが、上手くいかなくて困っています。 テキスト形式での提供で、読み込み用スクリプトが付属していました。 LOAD DATA LOCAL INFILE "ファイル名" INTO TABLE "テーブル名" ～ で読み込むのですが、一部の行がスキップされてしまいます。 Query OKとは出てきているのですが、すべてのレコードがどうしてもインポートできず、 Skipped: ～ のようにスキップされた旨のメッセージが表示されています。 いろいろ試行錯誤してみたのですが、どこに問題があるのかいまいちつかめないでいます。 このLOAD DATA INFILE～で読み込む場合にスキップされるケースというのはどのような場合が考えられるのでしょうか？ また、何行目がスキップされたのかや、スキップされた理由を詳しく調べることはできますでしょうか？ 無知ですみませんが、本当に困っているので教えていただけると助かります。 よろしくお願いいたします。
MySQLからDB2のデータベース参照についてです。 linuxサーバー上のMySQLを利用して、Windows サーバー上のDB2のデータベースを参照したいと思っています。実際できるかどうかも分からず、できるとすればどのような方法があるのでしょうか？
複数インスタンス サーバーマシン1台につき1インスタンスに出来れば良いんですが、コストの関係上、 サーバーマシン1台に複数のインスタンスを作成しようとしています。 Oracleでは複数インスタンスでの運用はパフォーマンスに大きく影響するので あまりやらない方が良いと聞きますが、MySQLではどうでしょうか？ また、MySQLのWindows版、Linux版で、この点について違いはありますでしょうか？
sqlのJoinでこんなこと出来ますか、 当方初心者につき宜しく御願いします。 テーブルAにはIDがありIDはユニークです。テーブルBにはIDと項目がありIDは複数件存在します。項目には「あ」又は「い」、「う」、「え」、「を」が入っています。idに対して「あ」だけの時もあれば、「い」、と「う」が存在する時もあります。１件または複数件存在します。 条件に「あ」を抽出するようにして、「あ」がないときは存在するがテーブルBには存在するという結果を作りたいのです。 ID＝１、あ ID＝２、NULL という結果を作りたいのです。テーブルの双方に存在して、かつ「あ」であれば「あ」以外はNULLのレコードを作りたいのです。 説明が悪くて申し訳ありませんが宜しく御願い致します。
データベースのインポート方法。 wordpressを使用していてサーバが度々落ちるので、新しいサーバに移行したいと考えています。 ですが、新しいサーバへのデータベースのインポート方法に手間取っています。 エラーは以下のように出ます。 ↓↓↓ エラー 実行した SQL: -- -- Table structure for table `○○○` -- DROP TABLE IF EXISTS `○○○` ; MySQLのメッセージ: ドキュメント #1046 - No database selected ↑↑↑ phpMyAdminと言うものを使用しております。 ・データベースに新しいテーブルを作成する ・文字コードを合わせる 辺りなのかと思っておりますが、テーブルのフィールド数と言うものが良く判りません。 文字コードは移行前サーバはECU-JPと書かれていますが、移行先の文字セットeucjpmsと言うものでよいのでしょうか？ 原因が解りましたらご教授お願い致したく書き込みました。 宜しくお願い致します。
mysqlのインデックスについて質問です。 http://archiva.jp/web/server-side/sql_02.html に、 『mysqlでは1つのクエリ実行で、1つのテーブルにつき1つのインデックスしか使用できない』 とあります。 よく以下のようなテーブル定義を見かけますが、 CREATE TABLE IF NOT EXISTS `data` ( `id` int(10) NOT NULL default '0', `user_id` int(10) NOT NULL default '0', `file_id` int(10) NOT NULL default '0', `name` text collate utf8_unicode_ci NOT NULL default '', PRIMARY KEY (`id`), KEY `user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; idとuser_idを条件にするクエリであれば、上記制約を満たすため、 KEY `id_user_id_idx` (`id`,`user_id`) の複合クエリを定義すれば良いのでしょうか？ また、idとuser_idとfile_idを条件にするクエリも考慮に入れた場合、 テーブル定義は以下のようにするのでしょうか？ CREATE TABLE IF NOT EXISTS `data` ( `id` int(10) NOT NULL default '0', `user_id` int(10) NOT NULL default '0', `file_id` int(10) NOT NULL default '0', `name` text collate utf8_unicode_ci NOT NULL default '', PRIMARY KEY (`id`), KEY `user_id` (`user_id`), KEY `id_user_id_idx` (`id`,`user_id`), KEY `id_user_id_file_id_idx` (`id`,`user_id`,`file_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; 最後に、create table 時のインデックスの指定は、 INDEX `user_id` (`user_id`), のようにもできますが、INDEXとKEYの違いは何かあるのでしょうか。
SQLの質問です。 MAX()という関数に引数として、 文字列を指定できるとありました。 （参考）さすけのプログラミング入門 http://sasuke.main.jp/max.html そこで、 実際にMAX(県名)として SELECT MAX(県名) FROM 表 などとして実行すると たしかに北海道などと返ってきます。 この場合、どういう理由で北海道が MAXとされているのか 教えていただけますでしょうか。 ちなみにその他のフィールドにある県ID（数字列）で 判断しているわけではないです。
MYSQLのログにつきまして mysqlでPostgresqlのpg_logのようにsqlの実行時エラーなどを出力する方法はありますか？ --logオプションで起動しても実行されたクエリーがログに出力されるのみで肝心な実行結果ログが出力されず困っています。 phpmyadmiinで誤ったsqlを実行した時に出るエラーのような出力を出せないかと思っています。 以上、宜しくおねがいします。
MySQLで辞書を作っています。データ量と検索スピードについて質問です。 はじめて質問します。 今、PHPとMySQLで辞書システムを作っています（初心者です）。日本語と（恥ずかしながら）中国語の辞書なのですが、単純に単語を検索する機能と、検索した文字列（＝単語）を含む例文を表示する予定です。ついでにその単語が属するカテゴリーがあり、そのカテゴリーに対応したアフィリエイト広告を表示させるのですが、データ件数が増えた場合、MySQLのスピードがどうなるのかが気になります。 具体的には、将来的に日本語単語が15万語、それに対応する中国語単語が15万語、さまざまな例文が20万件くらいになった場合、MySQLの検索スピードは明らかに体感できるほど落ちるものでしょうか。合計1万件程度の時と比べてどうでしょうか。 よろしくお願いします。
SJISのCHAR(8)に入れられる文字数について MySQLのver 5.0にて、文字コードをSJISにして、カラムをCHAR(8)で設定した場合、 英数字１バイト文字の場合、１６文字まで入れられるのでしょうか？ それとも、単純に文字数で弾かれるのでしょうか？ 現在、ver 4.0.24（文字コードは全部Ｃでいうところのchar１バイトで扱う）から、ver 5.0台に移行を考えており、移行するとした場合、PHPなどのプログラムをどの程度変更しなければならないかを考えています。 たとえば、CHAR(8)のカラムへデータを入れる場合、PHPで if( strlen($hoge) <= 16 ){ $hogeをCHAR(8)のカラムへINSERT処理 } とすると、$hogeが英数字だった場合、16文字まで、INSERT文にかかってしまうのですが、これで問題なく16字までINSERT出来るのかどうか知りたいのです。 以上、よろしくお願いします。
XAMPPでPHP、MySQL、Smartyを使用してHPを作成しました。 PHPなどは元々あるサンプルをいじって作った程度の素人です。 localhostで動作も確認できましたが、レンタルサーバへのアップのやり方がまったくわかりません・・・。 レンタルサーバはさくらインターネットです。 （htdocs、templates、libs等ファイルをどこにどのような状態で設置するのか・MySQLは同一サーバ内のものを使わないとダメなのか・パスの変更等←素人なので表現も間違っているかもしれません・・・） わかりやすいマニュアル等ございましたら、教えていただけませんでしょうか？ 試行錯誤しながらやっとのことで作成したHPですので、最後までやり遂げたいです・・・。 ざっくりした質問で申し訳ないですが、よろしくお願いします。
mysqlのユーザパスワードについて こんばんわ。mysql初心者です。 現在、サーバ（Linux Fedora11）でyumコマンドからmysql（Server version: 5.1.45 Source distribution）をダウンロードしてインストールしています。 新しいユーザーを作って接続を試みたのですが出来ません。 原因を調査した結果、パスワードが設定出来ていないようです。 一連の作業を例として下記の通りです。 例）------------------------------------------------------------------------------- [root@fedora user]# mysql -u root mysql> grant all privileges on *.* to user@"%" identified by 'user' with grant option; mysql> grant all privileges on *.* to user@localhost identified by 'user' with grant option; mysql> select user,host,password from mysql.user; +----+-----------------+-----------------+ | user | host　　　　　　　　　　 | password　　　　　　　 | +----+-----------------+-----------------+ | root | localhost　　　　　　　　|　　　　　　　　　　　　　| | root | fedora.fedorasrv.com |　　　　　　　　　　　　　| | root | 127.0.0.1　　　　　　　　|　　　　　　　　　　　　　| | user | localhost　　　　　　　　| 1a486e7929011a28 | | user | #　　　　　　　　　　　　　| 1a486e7929011a28 | +----+-----------------+-----------------+ mysql> exit; [root@fedora user]# mysql -u user -p 1a486e7929011a28 Enter password: ERROR 1045 (28000): Access denied for user 'user'@'localhost' (using password: NO) [root@fedora user]# mysql -u user ERROR 1045 (28000): Access denied for user 'user'@'localhost' (using password: NO) [root@fedora user]# mysql -u user -p user Enter password: ERROR 1045 (28000): Access denied for user 'user'@'localhost' (using password: NO) ---------------------------------------------------------------------------------- userユーザのパスワードが保護（？）なのか設定した内容と違います。 保護されたパスワードで打ってもノーパスワードで打っても設定したパスワードでも接続出来ません。 ちなみに他のユーザで作成しても保護されたパスワードです。 どのようにしたら設定した通りのパスワードが作成されるかご教授願います。
mysqlのユーザパスワードについて こんばんわ。mysql初心者です。 現在、サーバ（Linux Fedora11）でyumコマンドからmysql（Server version: 5.1.45 Source distribution） をダウンロードしてインストールしています。 新しいユーザーを作って接続を試みたのですが出来ません。 原因を調査した結果、パスワードが設定出来ていないようです。 一連の作業を例として下記の通りです。 例）------------------------------------------------------------------------------- [root@fedora user]# mysql -u root mysql> grant all privileges on *.* to user@"%" identified by 'user' with grant option; mysql> grant all privileges on *.* to user@localhost identified by 'user' with grant option; mysql> select user,host,password from mysql.user; +----+-----------------+-----------------+ | user | host　　　　　　　　　　 | password　　　　　　　 | +----+-----------------+-----------------+ | root | localhost　　　　　　　　|　　　　　　　　　　　　　| | root | fedora.fedorasrv.com |　　　　　　　　　　　　　| | root | 127.0.0.1　　　　　　　　|　　　　　　　　　　　　　| | user | localhost　　　　　　　　| 1a486e7929011a28 | | user | #　　　　　　　　　　　　　| 1a486e7929011a28 | +----+-----------------+-----------------+ mysql> exit; [root@fedora user]# mysql -u user -p 1a486e7929011a28 Enter password: ERROR 1045 (28000): Access denied for user 'user'@'localhost' (using password: NO) [root@fedora user]# mysql -u user ERROR 1045 (28000): Access denied for user 'user'@'localhost' (using password: NO) [root@fedora user]# mysql -u user -p user Enter password: ERROR 1045 (28000): Access denied for user 'user'@'localhost' (using password: NO) ---------------------------------------------------------------------------------- userユーザのパスワードが保護（？）なのか設定した内容と違います。 保護されたパスワードで打ってもノーパスワードで打っても設定したパスワードでも接続出来ません。 ちなみに他のユーザで作成しても保護されたパスワードです。 どのようにしたら設定した通りのパスワードが作成されるかご教授願います。
mysqlへ編集の為に、NOとpasswordを送信したいのですが! ■送信 1.<FORM method="POST" action="upd3.php?no=<?= $no ?>" enctype="multipart/form-data"> 2.<TABLE border="0" cellpadding="2"> 3. 4. 5.<TR> 6. <TD valign="top" bgcolor="#6687cc"> 7. <FONT color="#ffffff" size="-1">パスワード</FONT> 8. </TD> 9. <TD valign="top"> 10. <FONT size="-1">半角8文字まで（英数のみ）</FONT><BR> 11. <INPUT size="17" type="password" maxlength="8" name="password" value="<?= $password ?>"> 12. </TD> 13.</TR> 14. <TR> 15. <TD align="center"> 16. <BR> 17. <INPUT type="button" value=" 戻る " onclick="history.back()"> 18. <INPUT type="submit" name="upd3" value=" 登録 "> 19. </TD> 20. </TR> 21.</TABLE> 22.</FORM> ■受信 //データベースを選択します $selectdb = mysql_select_db($DBNAME, $con); //パラメータnoのレコードだけを抽出するSQL文を組み立てます $sql = "select * from fro where no = $_POST[no]"; //結果セットを取得します $rst = mysql_query($sql, $con); //結果セットからデータを読み込みます $col = mysql_fetch_array($rst); ■Warning: mysql_fetch_array(): supplied argument is not a valid MySQL のエラーとなります。 ご指導下さい
wp-config.php が作成できない。XREAサーバにて。 クライアントからの依頼により、WordPressでブログを作成したいとの件を請けました。 クライアントが使用しているサーバは”XREA”のものを使用しているのですが、初期設定の段階、”wp-config.php”を作成しようとすると、下記のようなエラーメッセージがでてきてしまいます。 ?ユーザー名とパスワードに間違いはありませんか ? ?ホスト名に間違いはありませんか ? ?データベースサーバーは動いていますか ? ユーザ名・パスワードは合致、ホスト名（これって変える必要はないですよね？）も大丈夫だと思います。 (記載は下記のような感じだと思いますが、大丈夫でしょうか？？) http://s-oh.sakura.ne.jp/wp.png ”wp-config.php”の手動作成も試してＵＰすると、”Web サイト側でページを表示できません”との表示が。。 う～ん、記述が甘かったのでしょうか？？ ちなみにＦＴＰパーミッションはフォルダ全て"777"です。 セーフモードも試してます。 一度さくらサーバで作成したのですが、その際は上手く行ったので、もどかしい限りです。 どなたか詳しい方、是非ともご教授願えればと思います。 何卒、宜しくお願い致します。
まだSQL初心者なので、よくわかっていないようです。 Viewの作り方がうまくいきません。 各テーブルの数値（PLAYCNT）の合計数を出力する VIEWを作成したいだけなのですが。。 これ↓を実行すると、mysqladminがフリーズしたようになって レコード数に~02(2は乗数) という変な数字が入ってしまいます。 これはいったいどうしてなのか分からず困っています。 CREATE VIEW ALLPLAY_TBL AS SELECT SUM(A.PLAYCNT) NORMAL_CNT, SUM(B.PLAYCNT) HARD_CNT, SUM(C.PLAYCNT) SPECIAL_CNT, SUM(D.PLAYCNT) MANIAC_CNT FROM NORMAL_TBL A, HARD_TBL B, SPECIAL_TBL C, MANIAC_TBL D
カウント結果を１レコードの中で横に並べたい 以下のテーブルを、 test_table id　　　group　　name 1　　　　100　　　テスト１ 2　　　　100　　　テスト１ 3　　　　100　　　テスト１ 4　　　　200　　　テスト１ 5　　　　200　　　テスト１ 6　　　　200　　　テスト２ 7　　　　200　　　テスト２ 8　　　　200　　　テスト２ 9　　　　200　　　テスト２ nameごとのカウント、更に100だけのカウント、200だけのカウントといったように、 以下のように横に並べることは可能でしょうか？ name　　　合計　　100計　　　200計 テスト１　 5　　　　3　　　　　 2 テスト２　 4　　　　0　　　　　 4 まず、nameごとの合計を取得するクエリを作って、 それに、100計列、200計列の部分をサブクエリでもってきたのですが、 これで動くには動くんですが、このやり方しかないものでしょうか。 ご教示おねがいします。 SELECT t.name, COUNT(*) as '合計', (SELECT COUNT(*) FROM test_table as t1 WHERE t1.name = t.name AND t1.group = '100' ) as '100計', (SELECT COUNT(*) FROM test_table as t1 WHERE t1.name = t.name AND t1.group = '200' ) as '200計' FROM test_table as t WHERE 1 GROUP BY t.name;
データベース単位でのCSV出力方法について phpからデータベースのバックアップ機能として、 データベース単位でCSV出力を行いたいと思っています。 テーブル単位で出来る記事は見受けられるのですが、 上記の方法は可能でしょうか？ それともう一つお聞きしたいことがあります。 SQL文が格納された変数をexec関数で実行しているのですが、 直接phpmyadminでは成功するのにもかかわらず、 csvファイルが生成されません。 下記にSQL文を記しておきます。 --SQL文-- select * from users into outfile "C:/works/～中略～/dump_0426.csv" fields terminated by ',' ENCLOSED BY '"' ご教授よろしくお願い致します。 【環境】 DB:mysql5.0.51b-community PHP:5.2.6
MySQLで項目の反復定義（COBOLでいうところのOCCURS）はありますか？ 今は AAA1 varchar(10) not null BBB1 int(6) not null CCC1 int(2) not null AAA2 varchar(10) not null BBB2 int(6) not null CCC2 int(2) not null 　： 　： AAA30 varchar(10) not null BBB30 int(6) not null CCC30 int(2) not null みたいに書いています。 XXX OCCURS 30 AAA varchar(10) not null BBB int(6) not null CCC int(2) not null のような書き方があればと思ったのですが。。 ご存知の方いらっしゃいましたら、 また他に良い方法をご存知の方いらっしゃいましたら ご教示願います。 宜しくお願い致します。
日付演算で月を加算したい場合 例として、下記構成で顧客訪問日に所定の月数を加算して、次回の訪問予定日を表示したいです。 データベース1 テーブル1　=　主キー：顧客番号（int）,訪問日（date） INTERVALを使えばいいのでしょうか？ また顧客ごとに訪問間隔が違うのですが、その場合どうしたらいいでしょうか？ SQL例をご教示いただければ幸いです。
質問させてください。 学校の授業で、phpとMySQLでネットショップを作成しています。 複数のユーザーからMySQLのデータベースに書き込みを行う際に、phpで明示的に排他制御命令を指示する必要はあるのでしょうか？ 学校の先生は必要みたいなことを言っているのですが、ネットで調べる限りはMySQL内で自動的に行っているように思えます。 使用しているエンジンはMyISAMです。 以上よろしくお願いいたします。
MySQL - 5.0.45に関しての質問です。 テーブルMediaの中にフィールドMediaCDとClassがあります。 100以上200未満のMediaCDのClassを4に変更したいのですが UPDATE Media SET Class = 4 WHERE 200 <= MediaCD >= 100; 上記のSQL文を実行したらエラーはでないのですが、変更はされてませんでした。 何か間違っておりますでしょうか？ ご教授頂けると幸いです。 宜しくお願い致します。
MySQL5.xで発生している問題について質問します。 CREATE TABLE click ( IP varchar(20) default NULL, time date default NULL ) ENGINE=MyISAM; 上記のようなテーブルを作成しました。 このテーブルからIPにIPアドレスを指定してデータ取得を試みると SELECT * FROM click where IP = '000.000.000.000' とした際には、5000件　取得できるのですが、 (000.000.000.000 はIPアドレスです) SELECT * FROM click where IP = '000.000.000.000' order by click.time desc (000.000.000.000 はIPアドレスです) とした場合には　4件しか取得できません。 MySQL4.x では発生しなかった現象で、MySQL5.x にバージョンアップして発生した 現象で対応に困っています。 上記の現象に対応する方法をご存知の方がいらっしゃればお教えください。 ※諸事情でMySQL4.x MySQL5.x と正確なバージョンが見られない状況で申し訳ありません。
Windows Vistaを使っています。 起動時にMySQLをリストアするバッチファイルを書いてタスクによって自動実行させたいのですが、 mysql -u root -p データベース < データベース.sql というバッチファイルではパスワードが標準入力で求められるので うまくいきません。 パスワードも自動的に付加する方法はありますか？
phpからMYSQL5に接続して以下のようなデータベースを作りました。 no name comment　←カラム名 1　 山田　起きる 2 　山田　叫ぶ 3 　山田　寝る これを上書きして、 no name comment 1　 山田　食べる 2 　山田　遊ぶ 3 　山田　寝る というようにレコードを更新したいのです。 しかし、どうやっても1、2、3の後に4、5、6と続いてしまいます。 「no」カラムにはauto_increment＋primary keyを設定しています。 phpで構文を送る前に mysql_query("alter table db1 auto_increment=0"); を設定してみたり、 mysql_query("insert into db1 (name,comment) value ('山田','$comment')"); や mysql_query("replace into db1 (name,comment) value ('山田','$comment')"); を試してみましたが、上手く行きませんでした。 現在は、 mysql_query("delete from db1"); mysql_query("alter table db1 auto_increment=0"); ---php処理--- mysql_query("insert into db1 (name,comment) value ('山田','$comment')"); というように、二度目の書き込みを行う前に一旦テーブル内のレコードを すべて削除して書きなおすという方法を取っています。 しかし、数が多くなると一旦削除する作業を行うと処理が遅くなってしまうと思いますので、上書きしてデータベースを更新したいと思っているのですが、どのようにすればよいでしょうか？
MySQLの書き込みで同時アクセスがどのくらい以上になるとパフォーマンスが低下するのでしょうか。
【ブログのデータを復活させたい】 nucleusのブログを利用しています。 先日SQLのデータベースをいじっていたところ、 誤ってブログで利用しているデータベースを消してしまいました。 サーバーの都合上、同じデータベースを再度つくることができないようなので、 新しくデータベースを作り、 nucleusの「config.php」の設定を新しいものに変更しました。 しかし「要求されたMySQLが有効ではありません」といった内容のエラー表示が出てしまいます。 当方、ウェブにそれほど詳しいわけではないので、別な手段を考え、 新しくnucleusでブログをつくり、 中のデータを以前のブログのデータに書き換えれば、 以前のブログが複製できるかと思ったのですが、（アドレスは変わりますが） それもダメでした。 ブログのデータを上書きしても、新しく作成したブログの投稿が表示されます。 （本文は別の場所に保管されているのでしょうか？） アドレスは変わってもいいので、 どうにか以前のブログデータを復活させる方法がありましたら、 ご教授いただけないでしょうか？ よろしくお願いします。
ユーザデータベースを作っているのですが ユーザが自分の情報しか確認できない状態でないと 他の人に情報を確認されてしまいます。 行ごとにアクセス制限は設けられますでしょうか？ また、通常は違う方法で制限するのでしょうか？ ご存知の方アドバイスいただければ幸いです。
set names latin1;を最初に実行しないと日本語が化けます。 phpmyadmin側で↑をデフォで実行させる方法はないでしょうか？ サーバーの設定を変更しないとだめですか？
図面管理のデータベースをつくっています。 連結したフィールドでグループ化し、他のフィールドの最大値のレコード全体を抽出したいのですが どのようにしたらいいのでしょうか？ いろいろ調べたのですがなかなかよい結果が出ません。 お知恵をおかしください。よろしくお願いします。 mysqlバージョン：5.0.45 例 テーブル：a(図面管理) a_id(id) a1(図番) a2(種類用紙サイズ) a3(枝番) a4(図面名) a_id　a1　a2 a3　a4 1　　　1　3P　0　aaaa 2　　　2　3P　0　bbbb 3　　　2　3P　1　bbbb 4　　　1　4P　0　cccc 5　　　1　4P　1　cccc 6　　　1　4P　1　cccc このテーブルのa1とa2を連結します。(連結フィールド：ren) a_id　a1　a2 a3　a4　　ren 1　　　1　3P　0　aaaa　13P 2　　　2　3P　0　bbbb　23P 3　　　2　3P　1　bbbb　23P 4　　　1　4P　0　cccc　14P 5　　　1　4P　1　cccc　14P 6　　　1　4P　2　cccc　14P 連結したもの(ren)をグループ化しますこのとき、枝番の値が高いレコードだけ抽出します。 a_id　a1　a2 a3　a4　　ren 1　　　1　3P　0　aaaa　13P 3　　　2　3P　1　bbbb　23P 6　　　1　4P　2　cccc　14P この最終的な結果を出す方法をお教えください。 おねがいします。
同時に3000人のユーザーがMySQLにデータを書き込んでもすべてのユーザーの登録が問題なく登録できる方法ありますか。
フォームから送信されたデータを配列として取得し、その配列の１つの要素に対してそれぞれmysqlにselectで問い合わせてageというカラムの値を取得したいと思っています。 配列の要素の数がその都度変わるので、要素が５つある場合には５回selectでデータベースに問い合わせてデータを５つ取得したいのですが、それは可能でしょうか？ ためしに下記のようにしてみたのですが、うまく取得できませんでした。 $hairetu = $_POST; for($i=0; $i< count($hairetu) ; $i++){ $sql = "SELECT * FROM member where age = '$hairetu[i]';"; $res = mysql_query($sql, $conn) or die("エラー"); $row = mysql_fetch_array($res, MYSQL_ASSOC); $age = $row["age"]; echo $age; } $ageの値をcount($hairetu)の回数分表示したいのですが、どのように処理していいのか分かりません。 また、根本的におかしな点もあると思いますがよろしくお願いします。
初心者です。 cseでxamppのmysqlが見たいのですが、設定方法がわかりません。 ご教授願いますでしょうか。 ここに質問を載せる前に調べたのですが、odbcを設定し、cseで繋げるところまでは分かりました。 具体的には、 odbcを設定する際にサーバー名など（各項目に）何を入れればいいのかわからない。 ということです。 すでにxamppはインストールしてあり、コマンドプロンプトでは正常に起動し、操作できる状態です。
複数のフィールドから、合計数を求めたい テーブルに複数フィールドがあり、その複数フィールドから、 使われている内容合計数を求めたいと思っています。 例として、 id, s1, s2 というフィールドがあり、 id s1 s2 1　A D 2　A G 3　C 空 4　D G この s1 と s2 からユニークな文字列でグループ分けをし各々の合計数を数えたいです。 （Aは2 Cは1 Dは2 Gは2 といったデータ） １つのフィールドならば、 SELECT s1, COUNT(s1) FROM table GROUP BY s1 といったクエリでグループ分け及び合計数が求められるのですが、 これを複数のフィールドから行いたい場合の記述方法がわかりません。 宜しくお願いします。 ----------------- 環境 　MySQL 5.1.22
お世話になっております。 データベースにあるデータをCSV形式のファイルとしてダウンロードすべく、以下のようなソースを記述しておりますが、そのデータに項目名（カラム名）を共に表示（挿入）させようとすると、項目名が行単位で表示されてしまいます。 //$str .= "ID,E-Mail,password,氏名,郵便番号,都道府県,住所,TEL,FAX,URL\n"; $sql= "SELECT * FROM member order by id"; $res = mysql_query($sql, $con) or die("検索に失敗しました"); while($row = mysql_fetch_array($res, MYSQL_ASSOC)){ $str = $row["id"].",".$row["mail"].",".$row["pass"].","; $str .= $row["name"].",".$row["post_no"].","; $str .= $row["address1"].",".$row["address2"].","; $str .= $row["tel"].",".$row["fax"].",".$row["url"]; 1行目だけに項目名を表示させたいので、whileの始まる前にカラム名を$strに代入したのですが、考え方として他にどうすれば宜しいのでしょうか？ お忙し中恐縮ですが、アドバイスのほど頂戴出来れば幸いです。宜しくお願い申し上げます。
PHP＋MySQLでシステムを組んでいます。 （PHP5.x MySQL5.1.34　サーバーLOLIPOP） 簡単なショッピングカートです。 PHPで作成した管理画面から文字を入力すると管理画面上でも エンドユーザー向け画面上でも文字化けせずに意図したとおりの 文字列が表示されます。 しかし唯一PHPMyAdmin上のみ文字化けしてます。 例としては「洗える着物」が「&Agrave;&ouml;&curren;¨&curren;&euml;&Atilde;&aring;&Ecirc;&ordf;」となっています・・・ これはインサートする時の文字コードに問題があるのか？ MySQLの文字コードの設定なのか？ php.iniの文字コード、エンコーディングの設定の影響なのか 分かりません。 同じような現象を体験された方アドバイス頂けましたら幸いです。 どうぞよろしくお願いします。
Mysqlレコード集計について 以下のようなテーブルがあります。 勝った試合は[win]に1が入っています。 |seq| date |win| | 1|2010/04/01| 1| | 2|2010/04/02| 0| | 3|2010/04/03| 1| | 4|2010/04/04| 1| | 5|2010/04/05| 1| [date] ASC 3連勝以上した回数をsqlで集計したいです。 sqlをいろいろ調べてみましたが、わかりませんでした。 わかる方いらっしゃれば教えてください。 よろしくお願いいたします。
MySQL サーバ: cgidb05.gmoserver.jp (cgidb05.gmoserver.jp via TCP/IP) サーバのバージョン: 5.0.51a-log プロトコルバージョン: 10 ユーザ: sd_dba_MTA0NzUz@cgi07.unix.internal-gmo MySQL の文字セット: UTF-8 Unicode (utf8) Web サーバ Apache/2.2.9 (Unix) mod_ssl/2.2.9 OpenSSL/0.9.8l MySQL クライアントのバージョン: 5.0.67 PHP 拡張: mysqli phpMyAdmin　バージョン情報: 3.3.1 select.php文 <?php $url = "cgidb05.gmoserver.jp"; $user = "sd_dba_MTA0NzUz"; $pass = "ifsaBUD8"; $db = "sddb0033532200"; // MySQLへ接続する $link = mysql_connect($url,$user,$pass) or die("MySQLへの接続に失敗しました。"); // データベースを選択する $sdb = mysql_select_db($db,$link) or die("データベースの選択に失敗しました。"); // クエリを送信する $sql = "SET NAMES utf8"; $sql = "SELECT * FROM kanri"; $result = mysql_query($sql, $link) or die("クエリの送信に失敗しました。<br />SQL:".$sql); //結果セットの行数を取得する $rows = mysql_num_rows($result); //表示するデータを作成 $sql = "SET NAMES utf8"; if($rows){ while($row = mysql_fetch_array($result)) { $tempHtml .= "<tr>"; $tempHtml .= "<td>".$row["mailadd"]."</td><td>".$row["pass"]."</td><td>".$row["name"]."</td>"; $tempHtml .= "<td><a href=\"update.php?cd=".$row["mailadd"]."\" target=\"_self\">更新</a></td>"; $tempHtml .= "<td><a href=\"delete.php?cd=".$row["mailadd"]."\" target=\"_self\">削除</a></td>"; $tempHtml .= "</tr>\n"; } $msg = $rows."件のデータがあります。"; }else{ $msg = "データがありません。"; } //結果保持用メモリを開放する mysql_free_result($result); // MySQLへの接続を閉じる mysql_close($link) or die("MySQL切断に失敗しました。"); ?> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <title>全件表示</title> </head> <body> <h3>全件表示</h3> <?= $msg ?> <table width = "300" border = "1"> <tr bgcolor="##ccffcc"><td>mailadd</td><td>pass</td><td>name</td><td colspan="3">EDIT</td></tr> <?= $tempHtml ?> <form action="insert.php" method="post"> <tr> <td><input type="text" name="cd"></td> <td><input type="text" name="name"></td> <td><input type="text" name="name"></td> <td colspan="3"> <input type="submit" name="submit" value="追加"><input type="reset" value="リセット"> </td> </tr> </form> </table> </body> </html> csvには漢字、かな　共に吐き出し正常。PDF、ブラウザだと？？？になります。 どなたかよろしくお願いします。
MySQLのデータをCSVに定期的に自動出力する方法について 初心者で本当に恐縮ですが助けて頂ければ幸いです。 MySQLのデータをCSVに出力したい。 かつ、例えば毎時０時に自動出力したい、と考えております。 使用しているレンタルサーバーはcronが使えません。 cronを使用してどうにかなるものなのかもよくわかりませんが、 当方の検索力不足のせいで調べてもヒントらしいヒントが見つかりません。 何か良い方法がありましたらご教授頂けませんでしょうか。
phpmyadminでshift-jisのカラムが文字化けして表示されます。 $cfg['Lang'] = 'ja-sjis'; ↑他のサイトを調べた限り、この設定でshift-jisが表示できる？と あったので設定したのですが、 「言語ファイルが登録されていません: ja-sjis」と 出て、utf-8で表示されてしまいます。 言語ファイルを別にダウンロードする必要があるのでしょうか？ 可能ならあわせて以下の設定も教えてください。 （ご存知の方は意味も・・） $cfg['DefaultLang'] = 'en-utf-8'; $cfg['DefaultConnectionCollation'] = 'utf8_general_ci'; $cfg['DefaultCharset'] = 'utf-8'; すみませんが、どなたかご存知の方・・教えて頂けますと大変助かります。
MYSQLで読替え（SELECT～CASE)をし、CSVを作成したい MYSQLは４シリーズを、PHPは５を使用しています。 データベースの値をCSV出力しようとしておりまして、 下記のようなソースを書いています。 現在このソースで作成されるCSVは 日付｜行先/要件｜交通機関｜往/復｜証票｜金額 2010/4/5｜test｜　1　｜　1　｜　2　｜　14480 と、言った感じのものなのですが 交通費（USAGE)や往復（ROUND）、証票（CERTIFICATE） は取得できる数値によって読み替えを行いたいのです。 SELECT～CASE WHEN～END　文で実現できると考え、 phpmyadminで色々ためしているのですが エラー内容は常に #1064 - You have an error in your SQL syntax; で、 ASで項目名を変えている場合、 CASE読み変えはできないのかな等と考えています。 CSVを 日付｜行先/要件｜交通機関｜往/復｜証票｜金額 2010/4/5｜test｜　1.電車　｜　1.片道　｜　2.無し　｜　14480 と、表示させるにはどう読み替えを行えばよいのでしょうか？ 単純にSQL分のミスなのか、そもそもできない事をやろうとしているのか、 いきずまっています。 ---ソースここから--- <?php header("Content-Type: application/octet-stream"); ?> <?php header("Content-Disposition: attachment; filename=output.csv"); ?> <?php $csv_flg = 1; $doc_id = 1; //接続情報 　$srv = "localhost"; 　$id = "aaa"; 　$passwd = "bbb"; 　$dbn = "ccc"; /* USAGE は0:未選択，1:電車，2:タクシー */ if($csv_flg == 1){ $sql = "SELECT `REC_DATE`as`日付`, `USAGE`as`行先/要件`, `LINE`as`交通機関`, `ROUND`as`往/復`, `CERTIFICATE`as`証票`, `COST`as`金額` FROM transportation WHERE SEISANSHO_ID = '".$doc_id."' ORDER BY LINE_NO "; $db=mysql_connect($srv,$id,$passwd); mysql_select_db($dbn,$db); $rs=mysql_query($sql,$db); for($i=0; $i<mysql_num_fields($rs); $i++){ print(mb_convert_encoding(mysql_field_name($rs,$i),"SJIS","UTF8").","); } print("\n"); for($j=0 ;$j<mysql_num_rows($rs); $j++) { for($k=0; $k<mysql_num_fields($rs); $k++) { $str=mysql_result($rs,$j,$k); print(mb_convert_encoding($str,"SJIS","UTF8").","); } print("\n"); } mysql_close($db); } ?>
phpMyAdminのログインユーザー追加 いつもお世話になります。m(__)m phpMyAdminへのログイン時、今はrootユーザーでログインしています。 データベース数も増え、DBごとにユーザーを作成(データベース個別の特権で)していますが、phpMyAdminの特権で作成したユーザーは、phpMyAdminにログインできないのでしょうか？ 例えば、データベースが「A」「B」「C」と3つあるとします。 管理者(root)は、すべてのDBに対して操作できる特権を設定しています。 UserAは、データベースAのみ、管理等の固有の特権を設定しています UserBは、データベースBのみ、管理等の固有の特権を設定しています UserCは、データベースCのみ、管理等の固有の特権を設定しています なお、UserA,UserB,UserCはグローバル特権は一切ありません。 現状、phphMyAdminに、UserAのユーザーIDとパスワードでログインしようとしても、「MySQL サーバにログインできません」というエラーが出てログインできません。 したい事のイメージとして (1)管理者(root)は、全てのDBを使える (2)他のユーザーは、そのユーザー専用のDBのみ使える …ここまでは今まで通りですが (3)他のユーザーも、phpMyAdminへログインできる(特権設定時のユーザー名とパスワード) (4)ログイン後、固有の特権で設定されているデータベースのみ使える お詳しい方、何卒ご教授のほど、宜しくお願い致しますm(__)m バージョン ・phpMyAdmin：2.11.10 ・MySQL：4.1.22
利用していた幾つかのテーブルの中身だけを消去してしまいました。 ダンプデータを取ってあったので、復元させようとしたら、 下記エラーとなりました。何回か試している内、最終的にはうまくいったのですが、下記エラーは、どういう意味だったのでしょうか。 #1062 - Duplicate entry '1' for key 'PRIMARY' ＜補足＞ ・テーブル自体は消失していなかったので、データが消失したテーブル部分のみ、phpMyAdminのSQL欄にSQL文を書いて、テーブルごとにINSERT 文を実行した。 ＜知りたいこと＞ ・エラーの意味
MySQL5.0を使ってアプリを開発しています。 たとえば以下のようなテーブル（またはビュー）があったとき、 goods_idの値に55,44,100のすべてをその順番に持っていてその他の値は持っていない member_idとpost_noの組み合わせがいくつあるかを知りたいような場合、 SQLを使ってどのような処理をすればよいでしょうか？ member_id ,post_no ,box_no , goods_id ----------------------------------------------------------- 1 ,1 ,1 ,40 1 ,1 ,3 ,55 1 ,1 ,6 ,100 1 ,2 ,5 ,40 1 ,2 ,10 ,100 2 ,1 ,2 ,55 2 ,1 ,9 ,40 2 ,2 ,2 ,55 2 ,2 ,6 ,40 2 ,2 ,9 ,100 2 ,3 ,1 ,55 2 ,3 ,4 ,40 2 ,3 ,6 ,100 2 ,3 ,9 ,60 上記の例の場合ですと、member_idが2でpost_noが2の場合のみ 55,44,100をこの順番で持っていて、かつ他の値はありませんので、 正解は１件になります。 ちなみにbox_noの値は、1から10までに限られています。 よろしくお願いします。
テーブルの結合について質問です。 テーブル名：SHOSAI SELECT T1.TIMESTAMP AS 登録, T1.UPDATE AS 更新, T2.CONTENT AS コード, . . . FROM SHOSAI T1 LEFT OUTER JOIN X_CODE T2 ON T1.Y_CODE = T2.CODE テーブル名：SHOSAI SELECT T1.TIMESTAMP AS 登録, T1.UPDATE AS 更新, T2.CONTENT AS コード, T1.BANGO AS 番号, T3.CONTENT AS 曜日, . . . FROM JOHO T1 LEFT OUTER JOIN X_CODE T2 ON T1.Y_CODE = T2.CODE LEFT OUTER JOIN H_CODE T3 ON T1.J_CODE = T3.CODE . . . この２つのテーブルを結合したいのですが それぞれのデータ数が３００あり SELECT*で呼びだしてもCSEはエラーとなってしまいます。 項目名を選定してプログラムを組んでもうまくできません。 良い方法があれば教えてください。
まったくの初心者で見よう見まねでmysql php をやっています。 恥を忍んで質問させていただきます。 comment9 フィールドで%当たり%'と書かれたレコードのみを 日付レコードにまとめて取得したいと思い下記のような文を考えました。 あたりまえだと思いますが、どちらか一方しか動作しません。 またアホなりにAND等でまとめようとしましたが式が悪いのか全く動いてくれません。 どうしたらできますでしょうか？どうかよろしくお願いいたします。 　 $where = " WHERE (comment9 Like '%当たり%')"; $where = " WHERE regdate = (\"$regdate\")"; 例です。　 regdate　comment9　comment8 comment7~ 20100401 外れ　　　　ほげ　　　はげ 20100401 当たり　　　はげ　　　ほげ 20100401 外れ　　　　リンゴ　　リンゴ 20100331 当たり　　　バナナ　　リンゴ 20100329 当たり　　　バナナ　　リンゴ 20100329　外れ　　　　バナナ　　リンゴ 20100428 当たり　　　　バナナ　　リンゴ
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'NULLL' at line 3 eclipseのデータベース開発を行ったところ上記のエラーがでました。 まったっくわからずｐｃの前でかたっまってます。 どなたかご指導お願いいたします。
次のような状況で、次のようなテーブルを用意しています。 ・状況 あるユーザーが○人の募集を募り 他のユーザーはその募集を見て参加をする。 ・募集テーブル 募集ID、募集者ID、募集人数、募集日時 ・参加テーブル 参加ID、募集ID、参加者ID、参加日時 ・質問内容 ある募集（募集IDを1、募集人数を10とする）に関して 参加しようと思った場合 まず、参加テーブルで募集IDが1の数を数える。 数が10未満だったらINSERTを行う という処理をしたいのですが、これを1行のSQLで実現は出来ますか？ 出来ない場合は次の手順でSQLを実行すれば問題は起きないですか？ 1.共有ロックを参加テーブルにかける 2.募集IDが1の参加レコードの数を数える 3.PHPなどで2の戻り値が10未満かどうかで分岐させる 4.10未満なら募集テーブルにINSERTする 5.ロックを解除 宜しくお願いします。
お世話になります。 最後の日にちを含むレコード全ての抽出方法がどうしてもわかりません。 id name date amount 1 AA 3/1 5 2 BB 3/1 5 3 CC 3/1 5 4 AA 3/2 7 5 BB 3/2 4 6 AA 3/3 1 これを、select * from テーブル group by name とすると、 id name date amount 1 AA 3/1 5 2 BB 3/1 5 3 CC 3/1 5 select id, name, max(date),amount from テーブル group by name とすると、 id name date amount 1 AA 3/3 5 2 BB 3/2 5 3 CC 3/1 5 望んでいる結果はこうです。最後のdateを含むレコード全てです。 id name date amount 3 CC 3/1 5 5 BB 3/2 4 6 AA 3/3 1 select * from テーブル as a where a.date=(select max(b.date) From テーブル as b where a.id=b.id); このようにしましたが、データの数が膨大なのですごく時間がかかってしまいます。 他、シンプルな方法はないでしょうか。 よろしくお願いします。 MYSQL バージョン5.0.45
drop userコマンドを使って、MySQLのrootユーザを削除してしまいました。ちなみに、OSはwindowsvistaです。 rootユーザーを削除してしまったがために、新たにデータベースを作成したりといったことができなくなってしまい非常に困っています。 どうすればいいかを教えて頂けますと幸いです。
お世話になっております。 MS-SQLServer2008からMySQL5.1への移植を行っています。 MYSQLの知識がまったくなく、調べながら行っているのですが、 TriggerがどうしてもCreateでエラーになってしまいます。 CREATE TRIGGER tgrMデータ AFTER UPDATE ON M_データ FOR EACH ROW BEGIN UPDATE M_データ SET `DATA切替日` = now(), `使用区分` = 'Regular' where (`使用区分` <> 'Trial' or `使用区分` is null) and `DATA切替日` is null and `ステータス` = '1'; END; phpMyAdminというツールのSQLをデータベースに対し 発行するSQLの箇所で上記を実行しています。 エラー内容がよく理解できず、何がおかしいのか まったくわかりません。 お忙しい中とは存じますが、ご教授願えませんでしょうか。
今趣味でかんたんなシステムを作ってみています。 その中でメール配信を行う部分があるんですが、 指定した時間帯はメール配信が行われないようにしたいです。 とりあえず、ユーザごとに配送しない開始時間と終了時間を持たせて(time型hh:mm:ss)やろうとおもいましたが、sqlでうまく範囲指定ができません。 23(end)－7(sta) とかだったら sta <= now <=end で簡単なんですが、 1(end)-7(sta)だと うまくいきません。 それぞれの時間帯ごとの可否フラグをもつしかないですか？
ＭｙＳＱＬにおいてバッチ処理でデータベースを構築する際のトラブル ＭｙＳＱＬに関しては素人です。 バッチ処理でデータベースを構築したいとおもって、バッチを指示通りの場所において、 net start mysql と打って、それから、 mysql -u root -p SampleDB040 < "C:\mysql\data\sampledb040\ファイル名.sql" として、パスワードを入れて、データベースを構築したいと思ったのですが、エラーが出て出来ません。 このエラーをどうすれば解消できるのか教えてください。 以下のようなメッセージが出ています。 ERROR 1005 (HY000) at line 10: Can't create table 'sampleDB040.t01prefecture' (errno: 121) 以上 ちなみに、同一ファイル内に同じ名前のファイルはありませんし、他のデータベースにもありませんでした。 よろしくお願いします。
MySQLのテーブルデータ（いくつかある）の中身を、テーブルを残したまま中のデータのみリセットを行いたいのですが、わかりません。 myisamchk -r とかのようにコマンドで出来るものなんでしょうか？ 中身のデータのリセット方法があれば教えてください。 よろしくお願いします。
お世話になります。 タイトルの通り、http://ホスト名/phpmyadmin/ にアクセスすると、 「mysql 拡張をロードできません。PHP の設定を確認してください」 とエラーメッセージが出てきてしまいます。 環境は以下の通りです。 CentOS 5.3 Apache 2.2.3 MySQL 5.0.77 php 5.1.6 phpmyadmin 2.11.9.4 httpd、mysql、phpはyumにてインストールを行っており、phpmyadminはsvn checkoutでインストールを行っております。 このエラーについては、php-mysqlをインストールする事で解決する事が多いようですが、 yum -y install php-mysql と打ち込んでインストールを行っても、同じエラーが出てきてしまいます。 また、エクステンションの参照先が間違っている可能性もあるため(と言うよりそうエラーで言われているので…)調べてみました。 php.iniのextension_dirの参照先にはmysql.soがちゃんと入っておりまして、 mysql.iniにはextension=mysql.soと記述されている状態です。 試しにphp.iniにextension=mysql.soと記述したり、mysql.soでなくmysqli.soに変えてみたりしましたが、 それでもエラーが出たままとなっております。 詳しい方がいらっしゃいましたら、是非ご教授いただきたいと思います。 宜しくお願いいたします。
現在、PerlのDBIを使用し、MySQLの処理をするバッチ プログラムを開発しております。 データが1万件ほどあるのですが、1万データに対して、 1日1回ステータス等の反映処理を行わなければいけま せん。 これを現在ではfetchrowを使用し1万データを回して 各種updateをかけているのですが、非常に時間がかかるため、 何かまとめてupdateがかけられる方法がないかと質問さ せていただきました。 よろしくお願いいたします。
レンタルサーバー上のMySQLに外部からODBC接続する場合についてです。 殆どのレンタルサーバーで、その様な接続を許していません。 「セキュリティ上の関係で・・・」という説明がされていますが、 認証や権限の設定を適切に行ったとしても、 根本的に何か危険な要因があるのでしょうか？ 多くのレンタルサーバーが禁止しているという事は、 きっと、それなりの理由があると思うのですが、 今自分が実現したいシステムの都合上、この接続環境が必要で 大変心配です。どなたか、詳しい方　教えて下さい。
どうしても答えが出てこないため、質問させてください。 先日、DB構成表を上長へ渡したところ、「設計が完全に完了して からパフォーマンスを考慮して非正規化をする事を考えるように」 と構成表も見ずに言われました。 ここで指す「非正規化」とは、何を指すのでしょうか？ ご教示いただけますと幸いです。
MySQLに良いCPUスペックは？ MySQL専用にサーバーを稼動させていますが、スペックの良いサーバーに変えようと思います。 ただ、「MySQLは１プロセスで動作するので、CPUのコア数が多くしても効果が出ない」と聞いた気がしますが、本当でしょうか？ 確かに、現在MySQL専用に使っているサーバーでは、CPU使用率が一つのCPUのみに偏って高くなっています（CPUを使い切れば均等になるのかもしれませんが、実際の使用感は重いです）。 通常の用途で考えるとコストパフォーマンスは悪くなりますが、1コア1CPUでなるべく高いスペックのCPUのサーバーを探すべきでしょうか？ いまどきマルチコアでないサーバーもなかなかないのでは…? ちなみに現在の利用環境は、 　　CentOS 5 　　MySQL 5.0 です。
お世話になりますm(__)m SELECT文でJOINした時の抽出結果を出す方法がわかりません(>_<) たとえば、以下の2つのテーブルがあり、 求めている（欲しい）結果を記します。 テーブル：table_a id｜genre｜ 1 ｜和食 ｜ 2 ｜中華 ｜ 3 ｜イタリアン｜ 4 ｜フレンチ｜ テーブル：table_b table_a_id｜etc1｜etc2｜ 123 ｜aaa ｜ああ｜ 23 ｜bbb ｜いい｜ 1 ｜ccc ｜うう｜ 2 ｜ddd ｜ええ｜ 求めている（欲しい）結果 id|genre |etc1｜etc2｜ 1 |和食,中華,イタリアン |aaa ｜ああ｜ 2 |中華,イタリアン ｜bbb ｜いい｜ 3 |和食 ｜ccc ｜うう｜ 4 |中華 ｜ddd ｜ええ｜ 上記のような抽出結果を導き出すことは可能なのでしょうか？？ 非常に汚い書き方で見にくく申し訳ありませんが、お詳しい方、是非ともご教授のほどお願いしますm(__)m
SSH（puttyjp）のコマンドプロンプトから mysql> select host, user, password from mysql.user; のように指定してuserテーブルに表示される各ユーザーのパスワードの表示画が、自分で設定したパスワードと異なっています（userテーブルに表示される各ユーザーのパスワードは、自分で設定したものより長く複雑です。）。 １）どうなっているのでしょうか（問題ないのでしょうか？）？ ２）どのようにすれば、自分で設定したパスワードがSSH（puttyjp）のコマンドプロンプトから“そのままの表示で”確認できるのでしょうか？ よろしくお願いします。
下記のSQL文があります。 tableA内で、tableA.id（A.id）は重複があります。 tableA内でのtableA.id（A.id）の重複レコード数をcount関数などでSELECTしたいのですが、 下記SQL文からどのように付け加えたらいいのか、お分かりの方いますでしょうか？ SELECT A.id as id, A.xxx as xx, A.yyy as yy, B.zzz as zz FROM tableA A, tableB B WHERE A.id = B.id AND A.xxx = x AND A.yyy = y なお、「A.yyy = y」という条件は、tableA.idの重複レコード数をカウントする上で必要な条件なのですが、 「A.xxx = x」という条件は、tableA.idの重複レコード数をカウントする上で、不要な条件です。 以上、よろしくお願いいたします。
ローカルのパソコンにXAAMPをインストールし そのなかでPHPを使用してとあるデータの処理を行っています。 # MySQL 5.1.41 + PBXT engine # PHP 5.3.1 # phpMyAdmin 3.2.4 使用しているテーブルの概要は以下のような形になっています。 id | URL | DATA | DATE 処理の内容としては PHP上でURLにアクセスしデータを取得、一部のデータを抽出しDATAに挿入（UPDATE）するという形をとっています。 処理の対象となるデータが10万行以上に及ぶため、効率良く処理を行うための様々な方法を探していたのですが、テーブルをMyISAMから行単位のロックが可能なInnoDBに変更し処理を実行しているPHPに複数のコネクションからという考えにいたりました。 私自身あまり理解していないのですが 1.現状のMyISAMではたとえ複数のコネクションからアクセスし、update処理を行ってもテーブル全体にロックがかかっているため単体のコネクションからのアクセスと比べて処理の速度はかわらない。 2.InnoDBは行単位でのロックが可能なため、UPDATE対象の行以外はロックが行われず、複数からのコネクションでアクセスすればより高速に処理が可能 というえ考えで間違いないでしょうか？ また、この考えが間違いでないという前提の質問なのですが、実際InnoDBに変更して同じ処理を行ったのですが処理速度はまったく変化ありませんでした。単純にInnoDBに変更しただけではダメなのでしょうか？ SQL文自体になにか変更を加える必要があるのでしょうか？ わかりにくい質問かもしれませんが よろしくお願いいたします。
以下のSQL文を実行したのですが、MySQL server has gone awayというエラーが発生してしまいます。 さまざまなサイトを確認したのですが間違いが分からないため質問をさせていただきました。 よろしくお願いします。 SELECT * FROM t1 WHERE f1 = ANY (SELECT f1 FROM t2 WHERE group = '1'); (SELECT f1 FROM t2 WHERE group = '1')では30件程度が該当し、t1は5万行前後です。 MySQL クライアントのバージョン: 5.1.22-rc
A(contenthead）をベースにAがBに存在せずかつCに存在しないデータをを作りたいのですが上手く行きません。以下を実行すると SELECT a.contentid, b.contentid, d.contentid From (contenthead as a LEFT JOIN group as b on a.contentid = b.contentid) left join (contenthead as c LEFT JOIN ouser as d on c.contentid = d.contentid) on a.contentid = c.contentid 表示結果は １、１、NULL ２、NULL、Null ３、NULL、３ ４、NUL、４ と出て来ます。従って両方にないのは２だけということになります。 実際のデータもそうなっています。 そこで、 WHERE ((b. contentid) is null) and ((d. contentid) is null)を上記SQLに付加するとなぜか ２、NULL、Null ３、NULL、null ４、NUL、NULL と表示されます。 教えて頂きたいことお分かり戴けますでしょうか宜しく御願い致します。
シェルの超初心者です。 現在MySQLの特権ユーザー（root）にパスワードが設定されているかどうか知るには、どのようなコマンド（方法）を使えばよいのですか？ サーバは、レンタルサーバです。 CentOS 5.3（Red Hat Enterprise Linux 5と別コマンドになる場合は、Redhatのコマンドも教えて下さい。） PHP 5.1.x MySQLの特権ユーザー（root）にパスワードを設定する方法は、下記サイトでわかりました。 http://y-kit.jp/saba/xp/mysqlsetup.htm#root よろしくお願いします。
PHPを使ってMySQLを検索するアプリを開発しています。 Select文の検索で以下のように検索条件を指定しています。 $query= "SELECT * FROM registration_tbl WHERE DATEDIFF(LAST_DAY(".$previousyear."),date) > 0 AND delete_flg = 0 ORDER BY date ASC ;" ; $res = $db->query($query); 上記の$query文字列の中の$previousyearには日付データが格納されています（確認済）。 意図としては$previousyearが示す月の月末日と、registration_tblのdateカラムとを比較して、dateの方が時期的に遅い（現時点に近い）レコードをselectしたいわけです。 なぜかこのクエリ文をMySQLに投げてもレコードがまったく検索できません。 もちろん該当するデータは１０以上あることはphpMyAdminで確認すみです。そして、他の検索条件の場合にはちゃんと検索します。 よろしくお願いします。
今MySQLをインストールしているんですが、 MySQL Server Datafilesというのは何でしょうか？
phpMyAdmin で、1つのサーバーに複数ドメインがあり、 それぞれのドメインに、データベースユーザーを割り当てて、 それぞれに、phpMyAdmin を利用できる様にするには、どうすればいいのでしょうか？
【mysql】テーブルにコメントはいれれませんか？ カラムにコメントを入れることができるように テーブルにコメントをいれることはできないでしょうか？ そのテーブルが、なんのテーブルなのか、親テーブルなのか子テーブルなのかを 後から別の人が見ても分かるようにしておきたいのです。
MySQLでのバイナリデータ削除方法 現在、PHPとMySQLでデータベースを作っている初心者です。 MySQLに登録したBLOB型のバイナリデータ（jpeg画像）を削除することはできるのでしょうか。 PHPMyAdminではレコード自体は消せますが、バイナリデータについては編集不可となっています。このフィールドのみ空にすることはできるのでしょうか。 考え方、方法などご教示ください。 上書きでNULLをインサートする？？のかとも思うのですが、よくわかりません。 MySQL　5.1.34 PHP 5.2.6
フィールド表示順序は、機能には影響しないと思いますが、できれば変更したいと考えています。phpMyAdmin等で、手軽に変更するにはどうしたらよいのでしょうか？ ▽経緯 phpMyAdminで、テーブルを眺めていたら、「テーブル定義書」と「フィールドの表示順序」が異なる箇所があることに気が付きました。テーブル定義書の方へあわせたいと考えています。 ▽思いついたやり方 phpMyAdminで、構造とデータを全てエクスポートした後、 テーブル定義書通りの順番通りに一つ一つ手作業でsql文を修正して、再度インポートする方法 ▽相談内容 「一箇所フィールドの表示順番が逆」、となっているだけなのですが、 もっと手軽にできる方法としては、どんな方法があるのでしょうか？
MySQLで複数条件指定での抽出 いつもお世話になりますm(__)m MySQLで複数の条件を指定して、グループ化(合計)した結果を出す方法がわかりません(>_<) たとえば、以下の2つのテーブルがあります。 テーブル：仕入先マスタ 仕入先ID｜仕入先名｜締日｜支払区分｜支払日｜ 0001｜あいうえお｜20｜1｜20｜ 0002｜かきくけこ｜99｜2｜99｜ 0003｜さしすせそ｜20｜2｜99｜ テーブル：仕入テーブル 仕入日｜仕入先ID｜商品名｜仕入金額｜ 2010/02/10｜0001｜商品A｜10,000｜ 2010/02/25｜0001｜商品B｜20,000｜ 2010/02/20｜0002｜商品C｜30,000｜ 2010/02/25｜0002｜商品D｜40,000｜ 2010/03/10｜0002｜商品E｜50,000｜ 2010/03/15｜0002｜商品F｜60,000｜ 2010/02/12｜0003｜商品G｜70,000｜ 2010/02/19｜0003｜商品H｜80,000｜ 2010/03/12｜0003｜商品I｜90,000｜ 上記から抽出条件として 条件１ 　仕入テーブルの仕入日：2010/02/01～2010/02/28 　仕入先マスタの締日：20 結果１ 　仕入先ID｜仕入先名｜仕入金額合計｜ 　0001｜あいうえお｜30,000｜ 　0003｜さしすせそ｜160,000｜ 条件２ 　仕入テーブルの仕入日：2010/03/01～2010/03/31 　仕入先マスタの締日：99 結果２ 　仕入先ID｜仕入先名｜仕入金額合計｜ 　0002｜かきくけこ｜110,000｜ という結果が出したいのですが、どのようなSELECT文を書けばいいのでしょうか？ 非常に汚い書き方で見にくく申し訳ありませんが、お詳しい方、是非ともご教授のほどお願いしますm(__)m
PHP + MySQLにて テーブルからフィールド名だけを取得し、さらに一部のフィールド名を除外したいです。 レコードじゃないのでis not構文は使えませんでした。 何かいい方法があれば教えてください。 $sql = "select * from table"; //tableテーブルからフィールド名を取り出し $rs = mysql_query($sql); $fields = mysql_num_fields($rs); $column = array(); for ( $i=0; $i<$fields; $i++ ) { $column[$i] = mysql_field_name($rs, $i); }
show databases; と入力 自分のデータベースを use me; と入力 show tables;　　と入力してからが問題なのですが・・・。 テーブルを作りたいのに、CREATEをしても作れないんですorz ↓↓入力した内容は以下のとおりです↓↓ CREATE TABLE cake ( code char(3), name varchar(10) NOT NULL, tanka char(8), from varchar(20) NOT NULL , drink varchar(10) NOT NULL , PRIMARY KEY (code) ); と、入力するとエラーで・・・ ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from varchar(20) NOT NULL, drink varchar(10) NOT NULL, PRIMARY KEY (code) )' at line 5 と出てくるのですが、よくわかりません。 昨日までは作れていたのになぜかわからず質問してみました。 code char(3) , を　code int(3),　としてもできませんでした。 これから作業で使うので、困ってます＞＜！ ご回答のほどよろしくお願いいたします。
MySQLの日付について教えて頂けませんでしょうか。 月間のデータを抽出しようと思うのですが between '2010-02-01' and '2010-02-28 23:59:59' →これだと59から00の1秒が抜ける様に思いますが、認識違いでしょうか？ reg_date >= '2010-02-01' AND reg_date < '2010-3-01' →これでも大丈夫なようですが、他の表現方法がありましたら是非アドバイス宜しくお願い致します。
PHP+MySQLで簡単な商品の検索サイトを作ってます。 商品数が5万件程度なら一つのテーブルで問題ないのですが、 30万件とか100万件とかになると、処理に時間がかかってしまいます。 処理を早くするために普通はどのよに対処するのですか？ 例えば、10万件毎にテーブルを分けていくのですか？
１行目は１、２行目は１～２、３行目は１～３ DBの中に 1,'item1',10 2,'item2',5 3,'item3',8 4,'item4',12 みたいなデータが入っていて、 そこからデータを引っ張ってきた時に 1,'item1',10 2,'item2',15 3,'item3',23 4,'item4',35 といった感じのデータの取り出し方というのは可能でしょうか？
データをINSERTする際にすでにレコードがある場合、mysqlで ON DUPULICATE UPDATEで更新処理が出来ると思うのですが なぜかINSERTされてしまいます…。 ID TABLE_ID COUNT 1 1 1 2 2 2 3 3 3 INSERT INTO TABLE_A SET TABLE_ID = 2, COUNT = 1 ON DUPULICATE UPDATE ID = 1 この構文をした場合に以下のようにしたいのですが 何がいけないのでしょうか…。 お分かりになる方よろしくお願い致します。 ID TABLE_ID COUNT 1 2 1
お世話になっております。 以下のような構成のテーブルがあり id　　type　　name 1　　　　1　　データベース 2　　1001　　MySQL 3　　1002　　PostgreSQL 4　　1003　　Oracle 5　　　　2　　パソコン 6　　2001　　富士通 7　　2002　　NEC 8　　　　3　　車 9　　3001　　トヨタ 10　3002　　日産 11　3003　　ホンダ typeが1桁のものは、大カテゴリ。 4桁のものは小カテゴリとして、4桁目と大カテゴリの数値を比較して一致した物をそのグループの小カテゴリとしています。 ※idはauto_incrementですが、この例は分かり容易くカテゴリ毎に並べていますが、カテゴリの追加を考えた場合、カテゴリの並び順もバラバラになります。 これらデータを呼び出す際、以下のようにしたいのですが（スクリプトはPHPで記述しています）、どのようなSQL文が適切なのでしょうか。 データベース 　　MySQL 　　PostgreSQL 　　Oracle パソコン 　　富士通 　　NEC 車 　　トヨタ 　　日産 　　ホンダ 以上、お恥ずかしいことかもしれませんが、上記のように振り分けるには、一度、 大カテゴリになる部分だけど抽出・変数格納 →再度データ呼び出し・・ などのようなことまで考えている次第です。 お忙しいなか恐縮ですがアドバイスのほど頂戴出来れば幸いです。 （ローカル上ではMySQL4を使っていますが、ウェブサーバーは5なので共に使えるようなものが形が望ましいです）
DISTINCTROWについてです。 DISTINCTROWが有効になるのは、FROM句に記述したテーブルが複数の場合と理解していました。しかし、次のような例をあるサイトで目にし、DISTINCTROWの有無でテストしてみて結果は同じでした([日付]、[使用量]フィールドのデータが同じレコードを2件入れて行いました)。 [電気管理]テーブルのフィールドは[日付]と[使用量]のみです。この例では、DISTINCTROWは有効なのでしょうか？ strName = "月別電気使用量" mySQL = "SELECT DISTINCTROW Format([日付],'yyyy/mm') AS 月別, " mySQL = mySQL & "Sum(Format([使用量],'0.0')) AS 合計 INTO [" & strName & "] " mySQL = mySQL & "FROM 電気管理 " mySQL = mySQL & "GROUP BY Format(電気管理.日付,'yyyy/mm');"
テーブルtbl(c1,c2,c3)に対して、 select c1, c2, count(distinct c3) from tbl where group by c1,c2; というクエリの高速化をしたいのですが、どのようなインデックスを張れば良いでしょうか。（あるいは、もっと良いクエリの書き方はありますか？）
バックアップをしないでUpdate文でテーブルを更新したのですが Update前に戻すことは可能ですか？
Select文で結合した時に、重複カラムが存在するのでテーブル名を先頭か末尾に自動でカラム名に付与して表示したいのですが、いい方法はないでしょうか？ (asで1個1個変えるのではなく・・・) SELECT TABLE_A.*,TABLE_B.* FROM TABLE_A LEFT JOIN TABLE_B ON TABLE_B.ID = TABLE_A.ID 表示 : TABLE_A_ID | TABLE_B_ID みたいのを考えています。
さくらサーバー 専用サーバ アドバンスド NEC i110Rb-1h Core2Duo OS Red Hat Enterprise Linux 5 Server メモリ 1G HDD 250G MySQLバージョン: 5.0.45 開発言語　PHP5 上記のサーバーで運用しています。 一週間、サーバーが異常に重く、全く開かない状態でした。 phpMyAdminを調べていた所、InooDB free 300000kB(約ですが) となっている事に気づきました。 そこで、不要なデータを削除し、free 450000kB　となるぐらいまで にしたところ、ウソの様に、サクサク動くようになりました。 しかし、データは毎日大量に蓄積されて行きます。 近いうちに、free領域がなくなっていく事は目に見えています。 そこで質問です。 MySqlの使用状況は、 データベースA テーブル数は約70　データサイズ 17M データベースB テーブル数は約120　データサイズ 231M たったこれだけのデータです。 １．Mysqlでのデータ保存の領域はどれくらいでしょうか？ 　　調べる方法はありますか？ 　　OSなどにもよるが、テラサイズまで格納出来るとあちこちで 　　見かけますが、なぜこんなデータ量で固まってしまうので 　　しょうか？ 　　とにかく、至急領域を増やす必要があります。 　　方法をお教えいただけないでしょうか？ ２．リファレンスから引用 　　もし全ての(非システムの)テーブルを InnoDB テーブルとして 　　作成したければ、サーバ オプション ファイルの [mysqld] 　　 セクションにライン default-storage-engine=innodb を 　　追加するだけでよいです 　　この様に記載されていますが、テーブルの約90%は 　　トランザクションが必要なので、InooDBです。 　　いっその事、全てのテーブルをInnoDBにしてしまえばと思うの 　　ですが、その事により生じるデメリットは？ 　　また、上記の設定により、MyISAMは作ってはいけなくなると 　　いう事でしょうか？ 将来的に、G単位のデータを格納する事になります。 この程度のデータ量で、サイトが重くなるようでは どうしようもありません。 現在、MySqlの設定はデフォルトですので、何もいじってません。 もちろん、今後チューニングも必要かと思いますが、まだ知識がなく 恐くていじる事が出来ていません。 何とぞ、ご教示お願い致します。
LAMPでシステムを構築しています。 データベースサーバは2台でMySQL-Cluster-gpl-7.0.9(RPM)で構成。 2台とも想定どおりの稼動をしています。 このデータベースにPHP(ZendFrameWork)を用いてアクセスを試みたところアクセスできませんでした。 調査の結果、接続ドライバとしてPDOを使用していうことがわかり、モジュールを導入するべく php-mysqlパッケージをインストールしたいのですが、mysqlと依存関係がある上、 mysqlはMySQL-Clusterと競合してしまいます。 そこで知恵をお借りしたいのですが、接続ドライバにPDOを用いた場合、どうすれば MySQL-Clusterで構築されたデータベースにアクセスできるようになるでしょうか。 PDOに限らず同じphp-mysqlパッケージに含まれるmysql_connect()も同様の結果になります。 おそらく同じ原因だと思われます。 データベースサーバは2台、これと同じサーバにWEBサーバ（Apache)が乗っています。 以下必須条件 OS:　CentOS 5.3 AP:　PHP（ZendFrameWork) DB:　MySQL-Cluster 変更できる点 パッケージの導入手段（tarからコンパイルでも、RPMで導入でも）。 よろしくお願いします。
MySQLていろいろ種類があるのでしょうか。
MySQLのバージョンアップで、4.0⇒5.0を行っています。 MySQL4.0の環境のダンプファイルを、 MySQL5.0にインポートしたいのですが、 MySQL4.0がインストールしているパソコンから、 cd mysql\bin より MySQL5.0環境にインポートが可能でしょうか？ MySQL4.0は自分のパソコンにインストールされていて、 MySQL5.0はO別サーバになっています。 mysql -h （サーバIPアドレス） -u （ユーザ） -p （データソース名） --default-character-set=sjis< C:/Dump.sql のようなことを考えています。
データベースの設計をしています。 ユーザマスタというテーブルがあり、 その中には、個人または企業のデータが入ります。 マスタ登録時に個人と企業は微妙に必須項目が違います。 (例えば、企業の場合は代表者名が入る、など) 要件としては、「企業だけを検索したい」というものもあります。 ここで質問なのですが、 (1)ユーザマスタに「企業フラグ」をつけて、それが「1」のものと検索する (2)代表者名に値が入っているものを検索する この場合、(1)と(2)ではどちらが検索が速いのでしょうか。 (1)の方が、気分的に(なんとなく、です)速い気がするのですが、 (1)だと、余分にカラムを持つことになり、もし(1)も(2)も同じ速さOR(2)の方が速い場合には 無駄だなあ、と思って困っております。 どなたかお詳しい方がいらっしゃいましたら、 どうぞよろしくお願い致します。
MySQLの「Version4」のダウンロード先を探しているのですが、 なかなか見つけることができません。 英語サイトを巡回して、それっぽい箇所 http://dev.mysql.com/doc/refman/4.1/en/news-4-1- … の 「Version 4.1 of the MySQL server includes many enhancements and new features. Binaries for this version are available for download at http://dev.mysql.com/downloads/mysql-4.1.html. 」 のリンクを踏んでみたのですが、ここでも最新版「Version5.1.44」しか置いていませんでした。。 Version4のダウンロード先が分かる方おられましたら、ご教示頂けませんでしょうか。
１つのデータベースしか設定できないサーバーに ワードプレスを２つインストールできますか？ 同じデータベースを使うとどのような不具合が起こるのでしょうか・・・
WindowsXP SP2 にて、インストーラー「mysql-essential-5.1.44-win32.msi」 を実行し、MySQLをインストールしようとしたのですが、 添付図のようなエラーが出てしまい、正常に終了させることができません。 過去にMySQLをインストールした際には、このようなエラーは出なかったと思うのですが。。 解決法をご存知の方おられましたら、ご教示お願い致します。 ちなみに過去インストールしたものについては、既にアンインストールしてあった状態です。 自分で調べて行った対策としては、下記の通りです。 ・「C:\Program Files\MySQL」下に残っていたフォルダを削除してインストール実行した。 ・「C:\WINDOWS」下の「my.conf」を削除し、インストール実行した。
FreeBSD7.2 release mysql 5 php 5 apache 2.2 でサーバを立てようとしています。 phpの文字化けを解決しようといろいろ調べていて、 「skip-character-set-handshake」 をmy.cnfの[mysqld]の部分に追加すれば良いらしいと考えました。 しかし、追加してmysqlを再起動すると /tmp/mysql.sockが無くなってしまい、mysqlにつながらないというエラーが出ます。 「skip-character-set-handshake」をコメントアウトした状態で mysqlを再起動すると、/tmp/mysql.sockは存在していて、 mysqlにはつながりますが、文字化けします。 「skip-character-set-handshake」は使わなくてもいいなら、その他の方法で文字化け解消を、また、 「skip-character-set-handshake」を使わなければ行けない場合は /tmp/my.sockの問題を解決しないといけません。 お詳しい方からの情報をお待ちしております。
SQLでできますか？ INSERT INTO test (A) VALUES (B)というSQLを発行したいのですが、このSQLのVALUESのBにあたる部分を正規表現的に指定して、一度のクエリで以下のような結果を得たいのです。 1.テーブルhogeのpiyoカラムの値の先頭がappleになっている行を探す。 2.(1.)で抽出した行のidの値をBとする。 例えば、以下のようにです。 ■皆様が回答してくださるSQL文(1クエリで行いたい) ？？？？？？？？？？？？ ■皆様が回答してくださるSQL文と同等の意味を持つSQL群 INSERT INTO test (A) VALUES (100) INSERT INTO test (A) VALUES (101) INSERT INTO test (A) VALUES (102) ■テーブルhoge _____id_____piyo__________created 1. 100 applebanana 2009/01/02 2. 101 apple_12345 2009/01/03 3. 102 appleXXXXXX 2009/01/04 4. 103 bananananan 2009/01/05 5. 104 ringogogogo 2009/01/06 分かりにくい説明ですが、お詳しい方、どうかご回答の程を宜しくお願いいたします。
WEBサーバーとDBサーバーに別れているサーバーでWEBサーバーにLinuxのOSを入れた場合DBサーバーはMySQLのみ入れLinuxのOSは入れないでいいのでしょうか。
mysqlの超初心者です。テーブルにデータの直接入力はできるのに下記の手順で.sqlファイルのデータを流し込もうとするとどうしてもエラーが出てしまいます。何がいけないのか分かりません。誰か教えてください！ コマンドプロンプトで下のコマンドでログイン d:\mysql\店舗データ>mysql -u root -p create database db_shouhin_kanri 成功 mysql> use db_hanbai_kanri; Database changed mysql> create table tbl_shouhin_hyou -> ( -> shouhin_code char(4), -> shouhin_name char(16), -> tanka integer, -> primary key(shouhin_code) -> ); 成功 set names sjis; 成功 mysql> insert into tbl_shouhin_hyou -> ( -> shouhin_code, -> shouhin_name, -> tanka -> ) -> values -> ( -> '1000', -> 'イチゴ味', -> 300 -> ); データの直接入力成功。 メモ帳で以下の様にデータを打ち込み 店舗データフォルダー（d:\mysql\店舗データ）にshouhinlist.sqlで保存 INSERT INTO tbl_shouhin_hyou (shouhin_code,shouhin_name,tanka) values ('1001','リンゴ味',400); INSERT INTO tbl_shouhin_hyou (shouhin_code,shouhin_name,tanka) values ('1002','グレープ味',500); mysql>\. shouhinlist.sql 流し込みをしようとすると ＥＲＲＯＲ 1064（42000）: You have an error in your syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near'■■i' at line 1 となり、うまく流し込みが出来ないです。 何がいけないんでしょうか。 また入力中に mysql> create table tbl_shouhin_hyou -> ( -> shouhin_code char(4), -> shouhin_name char(16. -> 例えばこのように文を間違えてenterした場合、一つ上の行に戻って書きなおすにはどうすればいいですか？ 毎回\cで初めから書き直すのは大変でしょうがないので誰かアドバイスをお願いします！！
FOREIGN KEYの追加について。 MySQL5.1.37 CREATE TABLE `goods` ( `id` int NOT NULL AUTO_INCREMENT, `num` int NOT NULL DEFAULT '1', PRIMARY KEY (`id`), index (`num`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; CREATE TABLE `sales` ( `id` int NOT NULL AUTO_INCREMENT, `num` int NOT NULL DEFAULT '1', PRIMARY KEY (`id`), index (`num`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; 上記のようなテーブルを作り、salesテーブルにCSVファイルからデータをインポートしたのち、FOREIGN KEYを子テーブルに追加したいのですが、下記のようなエラーになります。 ALTER TABLE `sales` ADD FOREIGN KEY ( `num` ) REFERENCES `test`.`goods` ( `num` ) ON UPDATE CASCADE ; MySQLのメッセージ: ドキュメント #1452 - Cannot add or update a child row: a foreign key constraint fails (`test`.`#sql-561_cf`, CONSTRAINT `#sql-561_cf_ibfk_1` FOREIGN KEY (`num`) REFERENCES `goods` (`num`) ON UPDATE CASCADE) データをインポートしたのちにFOREIGN KEYを追加するにはどのようにしたらいいのでしょうか？
すみません。教えてください。 ほぼMYSQLのMySqlDataReaderあたりのサンプルなのですが Public Class Form1 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click ReadMyData("server=localhost;user=root;database=hoge;port=3306;password=xxxx;") End Sub Public Sub ReadMyData(ByVal myConnString As String) Dim mySelectQuery As String = "SELECT OrderID, CustomerID FROM Orders" Dim myConnection As New MySqlConnection(myConnString) Dim myCommand As New MySqlCommand(mySelectQuery, myConnection) myConnection.Open() Dim myReader As MySqlDataReader myReader = myCommand.ExecuteReader() ' Always call Read before accessing data. While myReader.Read() Console.WriteLine((myReader.GetInt32(0) & ", " & myReader.GetString(1))) End While ' always call Close when done reading. myReader.Close() ' Close the connection when done with it. myConnection.Close() End Sub 'ReadMyData End Class でWhile myReader.Read()あたりで呼んでコンソールに書いていっていると思うのですが、これをDataGridView1へ出力したいと思っています。 調べても、いろいろ試してもできません。 どなたかわかる方お教え願います。 MYSQL5.0で VB2008ExpressEditionです。
データベースでのロック処理に関する初歩的な質問です。 とあるテーブルのとある行をSELECTして、しかる演算処理の後に同じテーブルにUPDATEするときには、ロック処理が必要であることは理解できるのですが、 単純に独自のデータをテーブルにINSERTする場合、ロック処理は必要なのでしょうか? このテーブルには頻繁にユーザーがアクセスしてSELECTもUPDATEも走っている状態です。
ver3.23のMySQLとPerlでデータベースを作っています。 検索方法でちょっと詰まってしまったので、 質問させていただきます。 以下のようなテーブルがあるとします。 tableA(基本名簿) AID　name sr 1　　aaa　100 2　　bbb　100 3　　ccc　100 4　　ddd　100 5　　eee　100 6　　fff　200 tableB（対応履歴） BID　cr 1　　40 1　　50 1　　60 3　　40 3　　50 3　　60 AIDはBIDに対応します。 ここでやりたいのは、 「'sr'が100であり、なおかつ'cr'が40ではない（結合後のテーブルにおいてnullである）tableAのレコードを取り出す」 ということです。 以下のような結果が理想です。 AID name cr 　sr 2 　bbb　null 100 4 　ddd　null 100 5 　eee　null 100 いろいろ試した結果、 AID name cr　 sr 1 　aaa　40　 100 2 　bbb　null 100 3 　ccc　40　 100 4 　ddd　null 100 5 　eee　null 100 このような結果が出る段階まではたどり着きました。 以下がそのコードです。 SELECT * FROM tableA as A left join tableB as B on A.AID = B.BID and cr =40 WHERE sr = 100 order by AID 以上のような結果が出たので、 三行目に"and cr != 40"や"and cr = null"などを足してみたのですが、 結果はemptyでした。 NOT EXISTSを最初は試みたのですが、 よく読んだらバージョンが古くて使えませんでした。 混乱しすぎて何か基本的な事をおろそかにしている気もするのですが… わかる方いらっしゃいましたらぜひご教示くださいませ。
テーブル名 dog_table フィールド id tosi（8など） name（まさお） sumai（東京） seibetu（オス） birthday（20010602） このようなテーブルがあります。 そして実際にはこのようにデータは入っています。 tosi 　　name 　　ookisa 　　sumai 　seibetu birthday 8 　　まさお 　　中 　　東京 　　オス 20010602 7 　　かおり 　　大 　　大阪 　　メス 20050906 8 　　トシ 　　大 　　大阪 　　オス 20020615 10 　　へん 　　少 　　東京 　　オス 20050101 8 　　まつり 　　大 　　東京 　　メス 20060509 ・ ・ ・ やりたいことは、、、 8歳の犬の名前、住まい、誕生日だけ phpで以下のようにHTMLで出力させたいです。 まさお 東京 20010602 トシ 大阪 20020615 まつり 東京 20060509 皆様どうぞご教授のほどよろしくお願いします！！
ロリポップ経由でWordpressを使用しているのですが、 謝ってMySQLのデータベースを削除していました。。 一応FTPサーバ上のファイルは3日前にすべてバックアップしていたのですが、データーベース上のファイルは復旧することはできるでしょうか？ FTPサーバを見たところ、プラグインのファイルなどはそのままだったので、一応全部バックアップしておきました。 ロリポップのデータベース上のデータと、FTPサーバのデータがまったく別物な場合、これまでの投稿データなどすべて消えてしまうことになるので絶望的です。。
MySQLで使用頻度の多い文字列を抜き出すことは可能でしょうか。 MySQLで、ある条件にあったTwitterでのつぶやきをDBに記録しています。 ダメ元でお伺いするのですが、記録されている文字の羅列から、使用頻度の多い言葉を使用数順に出すような機能はあるのでしょうか。 まさにTwitterにはそのような機能があります。 ハッシュタグとは別に、使用頻度の高いワードを抽出し、 「今話題のワード」を並べているようです。 これを自前のMySQLでも出来るならかなり便利だと思っています。 もし可能でしたら方法を教えて頂けますと嬉しいです。 よろしくお願いします。
JSP/サーブレットからMySQLに繋いで、データを登録しようとしています。 JSPの画面でアップロードした画像を、MySQLのテーブルに登録したいのですが、可能でしょうか？ ネットで色々調べているんですが、見つからず困ってます。。
Linux、PHP、MySQL構築の商用サーバーで登録用DBサーバーと参照用DBサーバーのあるサーバーでは、DBにデータを格納するハードディスクなど設置するのが普通なのでしょうか。ハードディスクを使う場合商用でよく使うハードディスクの製品名が知りたいのですが何方か知りませんか。
Linux、PHP、MySQL構築の商用サーバーで登録用DBサーバーをアクティブ系とスタンバイ系の多重化、参照用DBサーバーにスレーブDB10台を使用する場合、登録用DBサーバーのアクティブとスタンバイを制御する製品の製品名とスレーブDBを負荷分散する製品の製品名が知りたいのですが何方か知りませんか。
MySQLを最近学び始めました。 非常に低レベルな質問かと思いますが、どうぞよろしくお願いします。 下記のような投票アンケートを作りたいと思っています。 ：性別 「男　or 女」 ：一言お願いします 「コメント欄」 この場合、全体投票人数をcountするフィールドを追加して、 フィールド数は全部で下記のようになりました。 count(int),male(int),female(int),comment(txt) この時、commentフィールド以外は常に　update で数字を増やしていくだけなのですが、 コメント欄だけはupdateをすると、以前のコメントに上書きされてしまい使えません。 かといって、insertでコメントを追加すると、他の数値形式のフィールドは全部０なのに、 無駄に縦長のデータテーブルができてしまいます。 下記のような形です。 count|male|female|comment 3| 2| 1| ok 0| 0| 0| test 0| 0| 0| iine comment欄だけはファイル形式で保存したほうがよいのかなと思いましたが、こういう場合どういった方法がよいのでしょうか？
以下のようなテーブルがあったとして、 id　　　name －－　－－－－ 10　　　HOGE**1AA 11　　　H**1GE222 12　　　H*OGE*0AA 1.「HOG」で検索した場合、idが 10 と 11 のデータをヒットさせたい。 2.「HOGE321AA」で検索した場合、idが 10 のデータをヒットさせたい。 3.「H1O」で検索した場合、idが 11 と 12 のデータをヒットさせたい。 こんな事って可能でしょうか？
お世話になります。 現在、PHPで作成し運営しているサイトでキーワード検索を設置しているのですが、「野」や「三」など漢字一文字で検索すると You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AND ××× = AND ○○○ =' at line 3 というエラーになってしまいます。 別の漢字でエラーにならない場合もありますが、多くの漢字でエラーになってしまい、ググってみたものの対処法がわからず困っています。記述は下記の通りです。 $key = addslashes($_POST["keyword"]); $db= new mysqli($host, $username, $password, $database); if(mysqli_connect_errno()) 　die("Can't connect database : " . mysqli_connect_errno()); if(!$db->query("SET NAMES 'utf8'")) 　die(mysqli_error($db)); $query = <<< EOS SELECT * FROM {table} WHERE name LIKE '%{$key}%' AND kana LIKE '%{$key}%' EOS; if(!$result = $db->query($query)) die(mysqli_error($db)); 色々と検証し、kanaのフィールドは問題なくnameのフィールドで エラーが発生しているということが分かりました。また「LIKE '%{$key}'」は問題なく「LIKE '%{$key}'」の前方一致でエラーが起きているみたいです。 ちなみにREGEXPでも試してみたのですがダメみたいです。 対処法をご存知の方がいましたら、よろしくお願いいたします。
はじめまして。 MySQLで作ったユーザー「a」でログインするのに、 mysql -u a -p password:12345 でログインしようとすると、 ERROR 1045 (28000): Access denied for user 'a'@'localhost' (using password: YES) と表示されてしまいます。 パスワードは設定した通りなので間違いないのですが、ネットでも調べてもパス違いでしか載ってないので、他に原因がわかる方いましたらお教え頂ければと思います。 rootユーザーではログインできる。 バージョンは5.0.77 以上、よろしくお願いします。
年度毎に東京とその他の人数を表示したい場合 年　　　東京　その他 -----　-----　------- 2010　　14　　35 2009　　12　　28 2008　　20　　41 2007　　10　　32 SELECT year, sum(field(area,'東京')) 東京, sum(field(area,'千葉') or field(area,'埼玉') or ..) その他 FROM `table` GROUP BY year ORDER BY year DESC その他の記述でsum(field(area,'千葉') or field(area,'埼玉') or ..)とそれぞれを足す以外に簡単に記述出来る方法はありますか？ もし知っている方がいましたら教えて下さい。
Movable Typeを使用して個人的にブログサイトを運営しています。今回、Movable Typeのデータを移行するために作業を実施しているのですが、日本語文字コードのところで行き詰まっております。 ○移行元 OS : Fedora Core 3 Movable Type : 3.31 phpmyadmin : 2.11.6 mysql : 3.23.58 MySQL の文字セット: Shift-JIS Movable Typeのmt-config.cgiに以下の記載がされている PublishCharsetShift_JIS ○移行先 OS : Fedora 12 Movable Type : 5.01 phpmyadmin : 3.2.5 mysql : 5.1.4.2 MySQL の文字セット: UTF-8 Unicode (utf8) ○作業内容 1.移行元でphpmyadminによりデータベースのエクスポート 　データベース名をクリックして、『エクスポート』をクリック。 　全選択をクリック、SQLを選択し、『DROP TABLEを追加』をチェックし、『ファイルに保存する』をチェックする。その下は「non」のままで実行するをクリックして、データベース名.sqlというファイル名で保存する。保存したファイルの文字コードはSHIFT-JISになっている。 2.移行先の設定 Movable Typeのmt-config.cgiのPublishCharsetは記載なし。 文字コードをUTF-8としてデータベース作成 $ mysql -u root -pXXXXXX mysql> create database mt character set utf8; mysql> grant all on mt.* to mtuser@localhost identified by 'mtpasswd'; 3.移行先でphpmyadminによりデータベースのインポート 　データベース名をクリックして、『インポート』をクリック。 　インポートするファイルに移行元で作成した、データベース名.sqlを選択し、ファイルの文字セットをsjisし、その他は変更せずに実行するをクリックする。 　その後、Movable Typeのmt/mt.cgiよりサインインをするとデータベースのアップグレードが実施される。 　ブログが新しくできているが、日本語が一切表示されていない。 インターネットの検索でいろいろと調べてみたのですが、結局原因が分からず、行き詰まっております。 お手数ですがよろしくお願い申し上げます。
はじめまして。 MYSQLのテーブル作成について質問があります。 今WEBサイトからユーザにレシピを入力してもらうシステムを作っているのですが、『必要な材料』のような数がユーザの入力に依存するような場合どのようにしてテーブルを作成するべきなのでしょうか？ 考えたのは １）そのrecipeというテーブルを作って一つのcolomnに『ingredient』をつくってその中にすべてまとめて入力 ２）recipeの他にingredientsというテーブルを作りその中でrecipe_idなどでレシピを表示するときに一緒に引き出せるようにする。 レシピの数が増えたり、材料の数が増えた場合、どちらのほうが結果的によいのでしょうか？ よろしくお願いします。
MYSQLのcsvインポートについての質問です。 myadminからEXCELのcsvのインポート作業を行っております。 日本語等は、sift-jisに変換して正常に表示されます。 しかし、電話番号が表示されません。 インポートは正常に行われていると思います。（インポートの際に表示されるコメントで確認） ページの遷移の際には一瞬データが見えます。 また、SQLでデータ追加を行った場合には正常に表示されます。 電話番号のデータは123-123-1234です。 フィールドはvarchar(16)です。 どなたか、お分かりになる方よろしくお願いいたします。
MySQL4の時には問題なく動いていた以下のPHPプログラムが、 MySQL5にDBをアップデートしたら動かなくなりました。 $db = DB::connect("mysql://hoge:pass@mysql123.db.sakura.ne.jp/hoge"); if (DB::isError( $db )) { die($db->getMessage()); } 正確に言うと、さくらインターネット上で MySQL4で全テーブルをエクスポートして、DBを削除し MySQL5のDBを新規作成して、データをインポートしました。 DBの名前や接続のためのパスワードは変わっていません。 また、さくらインターネットでは、DBがWEBとは別サーバーに なっていますので、MySQL5 でDBを作り直した時に、上プログラムの DBのURLも新しい物に変更してあります。 どのように対応すればよろしいのでしょうか？
MySQL5.0を２つの環境に構築をして、 それぞれPHPからDBアクセスをしています。 そのときにvarcharに登録できる文字数に違いがあり、 原因をしてもなぜ違いがでるか不明でした。 （１）同一マシン内に以下を構築 ・Windows2003Server（IIS） ・PHP5.2.12 ・MySQL5.0 （２）同一マシン内に以下を構築 ・WindowsXP（IIS） ・PHP4.4.2 ・MySQL5.0 があります。 varchar(100)に対して、超過するような文字500文字などを登録しようとすると、 （１）の環境では登録エラーとなり、DB登録できませんでした。 （２）の環境ではDBのサイズまで登録されて、超過分は破棄された状態で、DB登録がされていました。 MySQLの構築方法は同じですが、 呼び出し元のPHP（IIS？）による影響でしょうか？
SELECT name FROM category WHERE id = ? の=?てどんな意味があるのでしょうか。
IIS上で動いているPHPよりMySQLを呼び出して、 ファイル（PDFやExcelやWordなど）をMySQLに登録することは可能でしょうか？ 画像ファイルなどは、BLOBに保存しています。とネットでよく見かけるのですが、 他のファイルは可能でしょうか？ （もちろん取得もいたします。） PHPは、 windows2003Server（IIS）で動いていて、 MySQL5.0は、Linux・unix上を考えています。 PHP：5.2.12 MySQL：5.0.60sp1 になります。 もし登録が可能であれば、どれくらいのファイルサイズまで可能でしょうか？
　WebからMysqlに入力します。それをWebで表示します。日本語を入力し、日本語が表示されます。 　そこで質問です。Localで同様のことを実施します。当然出来ます。唯、日本語の部分をSqlでみると化けているようです。 　問題はサーバからテキストファイルにデータを落としてLocalにインポートすると文字化けしてしまいます。 　Mysqlの設定はUTF8です。データは見えなくても良いのですがインポートを上手くやる方法はないでしょうか、インポートのテキストは「insert 日本語」になっています。 　当方、初心者です。宜しくお願い致します。
PHP5+mysql4で本の検索サイトを作成している初心者です。 漢字で入力しているデータ（タイトルや作者名など）を検索したいのですが、ひらがな・カタカナ・漢字のどれを入力しても同じ結果を得る場合はどうすれば良いのでしょうか。 読みもデータとして入力しておかなければいけないでしょうか。 よろしくお願いします。
TwitterAPIで取得したデータ内のハッシュタグをタグクラウド化したい と考えておりまして、質問いたします。 現在、TwitterAPIを利用して条件にあったフィードを取得し、MySQLに格納しています。 例のように、テキストには一部、「#」の文字列がついたハッシュタグがついてます。 ━━━━━━━ ▼例 id| text 1 | こんにちは　はじめまして　#aaa 2 | こんにちは　さようなら　#bbb 3 | ありがとう　さようなら　#aaa 4 | どうもどうも #aaa #bbb #ddd 5 | ありがとう 6 | おはようございます #ccc ━━━━━━━ 例を見れば、 #aaa は3つ #bbb は2つ #ccc は1つ #ddd は1つ であることが分かりますが、 これをタグクラウド化するために、 MySQLで「ハッシュタグごとにその数を多い順に抽出する」事は可能でしょうか？ つまり、SQLを投げる事で、下記のようなデータが帰ってくる方法を知りたく思います。 ━━━━━━━ TAG | COUNT #aaa | 3 #bbb | 2 #ccc | 1 #ddd | 1 ━━━━━━━ ハッシュタグが複数同じデータの中にある場合が悩ましい所です。 良い方法をご存知の方がいらっしゃいましたらご教示の程お願い致します。 よろしくおねがいします。
MySQLバージョン　サーバ5.0.45、 クライアント　3.23.49 Apache2.0.61 (Win32) PHP4.4.7 の環境下で、 名称 member, id int(10) unsigned not null auto_increment、 name, varchar(20) not null, mail　varchar(30) not null　のテーブルを作りました。　　　　　　　　　 次のスクリプトを書いて <?php session_start(); $name = $_POST["name"]; $mail = $_POST["mail"]; print_r($_POST); $conn = mysql_pconnect("localhost", "ABC", "XYZ") or die("Can't connect"); mysql_select_db("SIMEI", $conn) or die("db error") ; $query = "INSERT INTO member (name, mail) VALUES ('$name','$mail')"; $result = mysql_query($query, $conn); //$oid = 'mysql_insert_id($result)'; //''で括ってみる $oid = mysql_insert_id($result); // ← 11行 $result = mysql_query( "SELECT id FROM member WHERE oid = $oid", $conn); if($result){　print("insert OK");} 　echo "Can't　insert "; $_SESSION['id'] = mysql_result($result, 0); // ←　14行 mysql_close($conn); ?> これを実行すると、 データはmysql DB に登録されますが、下記のエラーが出て、id を取得できません。 何故でしょうか？　どうすれば不具合を解決することができるでしょうか？ Warning: mysql_insert_id(): supplied argument is not a valid MySQL-Link resource in C:\・・・・\insert.php on line 11 Warning: mysql_result(): supplied argument is not a valid MySQL result resource in C:\・・・・・\insert.php on line 14
テーブルＡ（ID、A,B,中身） テーブルa（A、コードの名前１） テーブルb（B、コードの名前２） ID、A、コードの名前１、B、コードの名前２、中身という風に結果を得たいのですが、Aがテーブルaに存在する、又はBがテーブルbに存在するものを出力したいのですがJoinが良く分かりません。aまたはbに存在しない時はコードの名前はNullにしたく、また抽出されテーブルAのレコードが重複しないようにしたいのですが、考えても分かりません。ご教授下さるようお願い致します。
初心者です。 近日XAMPP Mac OS X 1.7.2aをMac OSX 10.6にインストールしました。 インストールガイドどおりに/Applications/XAMPP/xamppfiles/xampp security を実行してセキュリティ問題を修正しました。MySQL も外部からアクセスできなくなりました。どうやって元に戻れますか？ 私はWindowsのリモートデスクトップとかも使ってるので、DNSサーバのドメイン名も持ってるし、ルータとファイアウォールの設定も大丈夫だと思います。 localhost:3306をPHPファイルに記述してMySQLを繋げば問題なく動作しますが、xxxxx.no-ip.org:3306（No IPのドメイン名）ならだめです。以下のエラーが出ます。 Warning: mysql_connect() [function.mysql-connect]: Lost connection to MySQL server at 'reading initial communication packet', system error: 61 in /Applications/XAMPP/xamppfiles/htdocs/Test/test.php on line 18 XAMPPを再インストールすればデフォルトの設定で外部から接続できるはずですが、データーベースにはもうたくさんデータが存在するのでできれば再インストールしたくないんです。 どうやって元の設定(インターネット経由で外部から接続できる)に戻れますか。 よろしくお願いいたします。
MYSQLチューニング初心者です。 MYSQLでEXPLAINでチューニングをしている際以下の壁にぶち当たって打開方法がないか模索しております。 テーブル構造はダミーですがたとえばa1,a2,a3というテーブル下記記載 SELECT * from a1 left join a2 on a1.id = a2.id left join a3 on a3.id = a1.mailbox_id \G a1.id: INT 主キー a1.mailbox_id: INT INDEX a1.title: varchar(50) a1.body: text a1.created_at: datetime a2.id: INT 主キー a2.mail_address: varchar(50) INDEX a3.id: INT 主キー a3.priority: INT a3.mail_box_name: varchar(50) 上記テーブル構造にて（EXPLAIN SELECT a1.id as id,a1.title,a1.body,a1.created_at,a2.mail_address,a3.mail_box_name FROM a1 left join a2 on a1.id = a2.id left join a3 on a3.id = a1.mailbox_id WHERE a2.mail_address = 'hogehoge@test.jp' order by created_at DESC;）を行うと、 Using temporary; Using filesort；が必ず出てきて対処方法に詰まっています。 order句のcreated_atをINDEXにすればよいのかな？と思いつけてみたのですが、a1.idのプライマリキーが優先され、結局同じ症状が出ます。 マルチインデックスでa1.id,created_atを付加し、FORCE INDEXをしたときはUsing temporary; Using filesortは消えますが、ExplainのrefがNULLになってしまいます。 方向性としてはtemporaryを使わない、indexでのsortを可能にする方法です。 まとまっていない文章で申し訳ございません。どうぞご教授のほどよろしくお願いします。 ＞＞データ量としてはa1・a2は50万レコード　a3は10件ほどです。 ＞＞mysql Ver 14.14 Distrib 5.1.40, for redhat-linux-gnu (i686) using readline 5.1
WordPress（ワードプレス）を設置しましたが、正直なところ、私には使いこなせません。 良い、解説書を探していますが、これまた多くて、どれにしようか迷っています。 おなじような経験の方、良い解説書はどれがいいでしょうか？
MySQLのあいまい検索について いつもお世話になっております。 本日はMySQLのあいまい検索について質問させていただきます。 あいまい検索といっても like での検索ではなく バとヴァ・ブとヴ・全角ハイフンと半角ハイフンなどを 同じとみなして検索することはできるのでしょうか。 たとえば、データベースには「ラブ」と登録されているが 検索キーワードは「ラヴ」と入力された場合、検索結果に「ラブ」の行を表示したいです。 PHPとMySQLで開発をするのですが、MySQLではなくPHPの処理になるのでしょうか。 カテゴリ違いでしたら申し訳ありません。 よろしくご教示お願いいたします。 ［環境］ 　MySQL：5.0.45 　PHP：5.1.6
お世話になります。 現在、データベースに画像を保存する手法を勉強しているのですが、分からないことがあり質問しました。 バイナリ画像自体をDBにアップする方法とパス名のみを保存して画像は別の場所から呼び出す方法があると思いますが、どちらも実践し、速度を測りました。 軽いデータから重いデータまで何回も計測して統計を取ったのですが、パス名を指定して画像本体は別の場所ら呼び出す方法が速度が早い事がわかりました。 直接呼び出しに比べて、パス指定は別の保存先からデータを取り出す時間などがあり速度は遅くなると予想していただけに驚いています。 直接DBに登録するよりパス指定をした方が速度が速い理由をご教示ください。 宜しくお願いします。
Linuxサーバが、コマンドを受け付けない状態でしたが、Mysqlを使用したwebアプリは動作していました。 データの新規入力、更新、検索なども行えていました。サーバーをリブートしたところ、コマンドを受け付けなくなった時間帯からsyslogの記録がなくなっており、また、Mysqlの新規登録データも登録されていませんでした。 データが登録されなかった原因として、何が推測され、どういう対処をとったらよろしいでしょうか。 ご教示ください。よろしくおねがいします。
MySQLでは、OracleのEXCEPTION 文による例外処理のようなことはできないのでしょうか？ 自分なりに調べてみたところ、MySQLではDECLARE ハンドラを使用して例外処理を行うと知りました。 ■MySQL :: MySQL 5.1 リファレンスマニュアル :: 17.2.8.2 DECLARE ハンドラより http://dev.mysql.com/doc/refman/5.1/ja/declare-h … ■例外処理(DECLARE ... HANDLER) - bnoteより http://www.bnote.net/mysql/appendix/exception.sh … しかし、この場合だと、特定のSQLSTATE以外のエラーが発生した場合に、例外処理を行えなくて困っています。 特定のSQLSTATE以外の不足のエラーが起こった場合でも、例外処理を行いたい場合はどうすればいいのでしょうか？ご教授下さい。
MySQLで会員番号(16桁)と名前だけのフィールド数の場合最大何レコードぐらい問題なく登録できるのでしょうか。
PLAYERS表 PID（選手ID)　　PNAME(選手氏名） M001 　　　　　　JUMBO OZAKI M002 　　　　　　KING KAZU 主キーは、PID で、プログラムを作成するのですがエラーが出ます。 create tabre PLAYERS ( PID char(4), PNAME varchar(15), primary key (PID) ); と、入力すると ERROR 1050 (42S01):table "players" already exists と表示されます。
MySQL操作はCUI派、それともGUI派 データベースを管理する際、CUIかGUIのどちらを管理していますでしょうか。 良かったら、その理由を教えてください。
MySQLを使ってフィールドにid、name、age、genderを持つデータベースを作りました。idは、主キーでauto_incrementです。中身は空です。 ここにPHPで <?php $conn = mysql_connect("localhost", "user", "pass") or die("MySQLに接続できません"); mysql_query("SET NAMES 'sjis'", $conn); mysql_select_db("sample4", $conn); mysql_query("INSERT INTO sample4 (id,name,age,gender) VALUES ('田中',18,1)", $conn); mysql_query("INSERT INTO sample4 (id,name,age,gender) VALUES ('鈴木',24,1)", $conn); mysql_query("INSERT INTO sample4 (id,name,age,gender) VALUES ('加藤',20,0)", $conn); mysql_close($conn); echo "初期化終了<BR>"; ?> をブラウザ上で実行したんですが、MySQLには接続でき、エラーもなく初期化完了とは出るんですが、MySQLで中身を確認してみると、 mysql> select * from samplet4; Empty set (0.00 sec) と出て空の状態です。何故でしょうか・・・。 よろしくお願いします。
mysql5.1.33を使用しています。 次のような構成で、 テーブル「tbl1s」 id int(11) テーブル「tbl2s」 id int(11) name varchar(30) テーブル「tbl1s_tbl2s」 id int(11) tbl1_id int(11) tbl1sの外部キー tbl2_id int(11) tbl2sの外部キー テーブル「tbl1s」 +------+-------+ |　　id　　|　club　| +------+-------+ |　　1　　|　野球　| +------+-------+ |　　2　　|　テニス| +------+-------+ |　　3　　|　サッカー| +------+-------+ +------+-------+ テーブル「tbl2s」 +------+-------+ |　　id　　|　name　| +------+-------+ |　　1　　|　sato　　| +------+-------+ |　　2　　|　suzuki　| +------+-------+ |　　3　　|　tanaka　| +------+-------+ テーブル「tbl1s_tbl2s」 +------+-------+-------+ |　　id　　| tbl1_id　|　tbl2_id　| +------+-------+-------+ |　　1　　|　1　　　　|　1　　　| +------+-------+------+ |　　2　　|　1　　　　|　2　　　| +------+-------+------+ |　　3　　|　3　　　　|　1　　　| +------+-------+------+ というテーブル構成で、「tbl1s」テーブルの行を 「tbl1s」のclubかない場合には「tbl2s」のnameを検索条件にして取得したいのですが どのように記述すれば良いのでしょうか？ 例えば「テニス」を条件にした場合は、「tbl2s」のnameにはないですが「tbl1s」のclubには合致するのがあるので テーブル「tbl1s」 +------+ |　　id　　| +------+ |　　2　　| +------+ を取得したいです。
MySQLでページ毎にログを取りたい ex) +----+------+ | id | name | +----+------+ | 01 | aaa | | 02 | bbb | | 03 | ccc | +----+------+ のようなテーブルがあったとして、id を使って動的ページを生成しています。 id は数万件あります。 そこで各 id ごと（各ページ毎）にアクセスログを取りたいのですが、 例えば１つの id につき最新10000件までのログを取るとします。 この場合、以下のように id 毎にテーブルを作成すると、当然ながらテーブル数が膨大になってしまいます。 ex) id XX のテーブル +------+----------------------------+----------+ | date | addr　　　　　　　　| ref | +------+----------------------------+----------+ | 0000 | XXX.XXX.XXX.XXX | http://~ | | 0000 | XXX.XXX.XXX.XXX | http://~ | | 0000 | XXX.XXX.XXX.XXX | http://~ | +------+----------------------------+----------+ （10000レコードまで） テーブル数が数万というのは MySQL では珍しくないものなのでしょうか？ それとももっと他に良い設計方法などあるのでしょうか？ （またはこういうデータを取るのにMySQLは向いていない？） なおアクセスログとはいえ、その集めたデータを元に、利用者にアウトプットを同期して行いたいので、頻繁に参照・書込があることを想定しています。
MY SQLでプログラムを作成してますがうまくいきません。 PLAYERS表 ーーーーーーーーーーーーーーー l PID(選手ID)ｌPNAME(選手名）ｌ lーーーーーーーーーーーーー--ｌ 　主キーはPID で、 create table PLAYERS ( PID char (4), PNAME varchar, primary key(PID) ); と入力するとエラーが出ます。 エラーメッセージは、 ERROR 1064(42000):You have an error in your SQL syntax,check the manual tthat corresponds to your my SQL server version for the right syntax to use near'primary key(PID) )' at line 4 と表示されます。 自分では、ちゃんと表の定義をして正しいと思うのですが？
userテーブルのu_idを主キーとしており、 他でもu_idを主キーとしてあるテーブルがあります。 delete from user where u_id = 2　 で、u_id = 2　のレコードを削除させようとしたのですが、 Cannot delete or update a parent row: a foreign key constraint fails (`aaaaa`.`message`, CONSTRAINT `message_ibfk_2` FOREIGN KEY (`m_guid`) REFERENCES `user` (`u_id`) ON UPDATE CASCADE) のようなエラーがでます。 どのような意味でしょうか？また、これを改善するには設定、sql文はどのようにしたらよいでしょうか？ ご回答お願いいたします。
インストール・初期化後、初起動でエラー OS : CentOS 5.3 MySQL 5.0.89 をソースからインストール rootユーザにて # /usr/local/mysql/bin/mysqld_safe --user=mysql & [root@localhost mysql]# Starting mysqld daemon with databases from /usr/local/mysql/var STOPPING server from pid file /usr/local/mysql/var/localhost.localdomain.com.pid 100114 20:02:07 mysqld ended エラーログをみる # cat var/localhost.localdomain.com.err ... /usr/local/mysql/libexec/mysqld: Can't create/write to file '/usr/local/mysql/var/ib6TIfDM' (Errcode: 13) 100114 20:02:07 InnoDB: Error: unable to create temporary file; errno: 13 100114 20:02:07 [ERROR] /usr/local/mysql/libexec/mysqld: Can't create/write to file '/usr/local/mysql/var/localhost.localdomain.com.pid' (Errcode: 13) 100114 20:02:07 [ERROR] Can't start server: can't create PID file: Permission denied 100114 20:02:07 mysqld ended /usr/local/mysql/var の所有者・権限は、mysql:mysql 700で "# /usr/local/mysql/bin/mysqld_safe --user=mysql &" は mysqlユーザで起動するという意味ですよね（？） /usr/local/mysql/my.cnf の [mysqld] には、 tmpdir = /usr/local/mysql/var/ を書いてます。 my.cnf は /etc/my.cnf にあります。 なぜ書き込めないのでしょうか？ どなたかご教示お願い致します。 因みに、これは関係ないと思いますが、 /usr/local/mysql の所有者・権限は root:mysql 700 です。
一部だけ重複しているレコードの削除について教えてください。 検索したのですが、よくわかりませんでした。 f1　　　　　　　f2　　　　　　　f3　　　　　　　f4 　　　　　　　f5 -----　　　　-----　　　　-----　　　　----- 　　　　----- 1　　　　　　　2005　　　　　T 　　　　　20 　　　　 　A 2　　　　　　　2007　　　　　S 　　　　　20 　　　　　B 3　　　　　　　2003　　　　　S 　　　　　20 　　　　　C 4　　　　　　　2008　　　　　T 　　　　　30 　　　　　A 5　　　　　　　2005　　　　　T 　　　　　30 　　　　　C 6　　　　　　　2008　　　　　N 　　　　　30 　　　　　B 7　　　　　　　2007　　　　　T 　　　　　20 　　　　　D というようにあったとき、f3とf4が同じであった場合はf2の値がもっとも大きいもの一つを残して他のレコードを削除するというSQL文を考えています。 つまりこの場合にはf1が2,4,7のものを残したいのです。 この時のSQL文はどのようになるのでしょうか。 よろしくお願いします。
ＡＣＣＥＳＳからＯＤＢＣ経由でmysql　へデータをインポートしました。 結果、ｐｈｐｍｙａｄｍｉｎで参照した時に、案の定文字化けしていました。 ＭｙＳＱＬの文字セットは　UTF_8 Unicode(utf8) ＭｙＳＱＬの接続照合順序　utf8_general_ci で、テーブル上の各項目の照合順序は　utf8_general_ci　となっています。 config ファイル等を変更しなければならないかと思いますが、どのように変更すれば良いか教えて頂きたいと思います。 あるいは、そもそもＡＣＣＥＳＳからインポートする時に何か設定をしなければならない？？？ よろしくお願いします。
MySQLで、最新のものからデータを10件づつ昇順で並べたいと思っています。 最新のデータを1ページ10件ごとに収めていきたいので（最初のページを半端にしたくないので）、データを降順に取り出し、それぞれ取り出した10件ごとに昇順で並べ変えることが出来ないかと、いろいろ工夫をしましたが行き詰っています。PHPスクリプト（一部ですが）は次のように書いています。 $from = ($page-1)*10; $query = "SELECT * FROM table ORDER BY age DESC, sinchou DESC, taijyuu DESC LIMIT 10 OFFSET $from"; １．降順で取り出したデータ10件を昇順に並べ替えるにはどのようにすれば良いでしょうか？ ２．最新のものからデータを10件づつ昇順で並べるための良い方法が、上記の他にありますでしょうか？ なにかご示唆を頂ければ有難いです。よろしくお願い致します。
初めての投稿です、よろしくお願いします。 MySQLについて質問したいです。全くの初心者で質問自体がおかしいかもしれませんがよろしくお願いします。 MySQLサーバーにテーブルを作成し、 自動的に新規案件番号を取得するようになっております。 2009年12月31日まで自動取得ができておりますが2010年になってからは 最初の1番だけは正しく取得できました 例 １００１００１(10年01月001番) 次の2番からは １０００２になって月が抜けることになっております。 PHPソースを確認したけど解決まで至らず困っております。 ご教示お願いします。
連番を下記の様に付けたいのですが、どなたかご教授ください。 参考になるURLでも結構です。 【環境】 ・MySQL バージョン: 5.1.41 ・PHP バージョン： 5.3.1 【現状】 ○親テーブル：nou_itiran ・entry_id　[int(11)][auto_increment]主 ・その他カラム ○子テーブル：nou_ko ・ko_id　[int(11)][auto_increment]主 ・entry_id　[int(11)]←親テーブルの主キー値が入る ・その他カラム 2つのテーブルを作成しています。 親テーブルのカラム[entry_id]に対して、子テーブルの[ko_id]に 副番号をつけたいのですが、考え方がまとまりません。 現在は、 [親entry_id]/[子ko_id] 456/1 456/2 457/3 457/4 458/5 458/6 459/7 ・ ・ のように、[親entry_id]と[子ko_id]は個々に連番が発生します。 *********** 【達成したい内容】 456/1 456/2----★ 457/1 457/2----★ 458/1 458/2 459/3----★ [親entry_id]に対して、何番まで使われたか（★）を他のテーブルで 保持しておけばよいのかも？？と思うのですが、 具体的な手法がわかりません。 ************* MySQLへのセレクト、インサートはPHPから行っております。 宜しくお願いいたします。
MySQL5.0を使用して下記の事が可能なのか教えて頂けないでしょうか？ ■実現したい事 当方の支店に設置したサーバにはMySQLが導入されており、日々の業務データを保持しています。 また、支店は複数あり同じデータベース構造となっています。 そこで、本店にも１台のサーバを設定し、これにMySQL導入し各支店のMySQLとレプリケーション機能を用いてバックアップを行いたいのです。 支店で保持している各テーブルには支店IDをキーとして持っているので、各支店のデータをまとめても重複は発生しません。 ネットでレプリケーション機能の説明を読んだのですが、複数のマスタとスレーブを設定する例を見つけられなかったので質問させて頂きました。 以上、よろしくお願いします。
MySQLのパスワードを忘れてしまいました。 パスワードなしで使用するにはどうしたらいいのでしょうか。 分かる方、どうか教えてください。 (できるだけ細かく、詳しく教えていただけるとありがたいです。) 一度、アンインストールして、再度、インストールしたのですが、前の設定が残っているようで、パスワードの入力を求められてしまいます。
table a に以下のレコードが3件あるとします。 id| name 1 | 1-6-104-1 2 | 1-6-104-2 3 | 2-1-6-104 この状態で、1-6-104の部分だけを1-6-103へ置換し、 以下のようにUPDATEしたいのですが１つのSQLで可能でしょうか？ id| name 1 | 1-6-103-1 2 | 1-6-103-2 3 | 2-1-6-104 MySQLのバージョンは5.1です。よろしくお願いします。
mysql5.1.33を使用しています。 次のような構成で、 テーブル「tbl1s」 id int(11) テーブル「tbl2s」 id int(11) name varchar(30) テーブル「tbl1s_tbl2s」 id int(11) tbl1_id int(11) tbl1sの外部キー tbl2_id int(11) tbl2sの外部キー テーブル「tbl1s」 +------+ |　　id　　| +------+ |　　1　　| +------+ |　　2　　| +------+ |　　3　　| +------+ テーブル「tbl2s」 +------+-------+ |　　id　　|　name　| +------+-------+ |　　1　　|　sato　　| +------+-------+ |　　2　　|　suzuki　| +------+-------+ |　　3　　|　tanaka　| +------+-------+ テーブル「tbl1s_tbl2s」 +------+-------+-------+ |　　id　　| tbl1_id　|　tbl2_id　| +------+-------+-------+ |　　1　　|　1　　　　|　1　　　| +------+-------+------+ |　　2　　|　1　　　　|　2　　　| +------+-------+------+ |　　3　　|　3　　　　|　1　　　| +------+-------+------+ 「tbl1s」テーブルの行を「tbl2s」テーブルのnameを検索条件にして取得したいのですが どのように記述すれば良いのでしょうか？ 例えば「sato」を条件にした場合は、 テーブル「tbl1s」 +------+ |　　id　　| +------+ |　　1　　| +------+ |　　3　　| +------+ を取得したいです。
MAINテーブルとITEMテーブルの２つがあります。両方のテーブルともIDが主キーです。 MAINテーブル Field #01: Alias:ID Type:INTEGER Field #02: Alias:CDATE Type:TIMESTAMP ※他にもいくつかフィールドが存在するが割愛 ITEMテーブル Field #01: Alias:ID Type:INTEGER Field #02: Alias:ITEM Type:STRING(20) Field #03: Alias:INCOME Type:NUMERIC(18,4) Field #04: Alias:OUTGO Type:NUMERIC(18,4) Field #05: Alias:REFID Type:INTEGER ここから、特定の年月を持つMAIN.CDATEのMAIN.ID（複数個存在する場合あり）とITEM.REFIDが一致するデータより、ITEM.INCOMEの総計からITEM.OUTGOの総計を差し引いた値を取得するSQL文を１回のクエリーで実装したいと考えています。 文章ではなかなか説明しづらいのですが、下記のようなSQL文をイメージしています。もちろんこれは正しい結果を返しませんので、どのようにＳＱＬ文を記述すれば正しい結果を得られるかの知恵をお貸しください。 /* 2010年1月の収支 */ select SUM(income) - SUM(outgo) from item where id = (select id from main where extract(year from cdate) = 2010 AND extract(month from cdate) = 1);
商品を販売しているページで、URLが下記のようなものをよく見かけます。 /product/detail.php?id=XXXXX これはMySQLを使用しているのでしょうか？ 同様のシステムを構築したいと考えております。 どこか参考になるサイトや、書籍、またこのようなものがパッケージ販売されているのでしたらお教え下さい。 よろしくお願いいたします。
MySQL Workbench で、テーブル定義書を出力するやり方を教えて下さい。 commentも表示されるような形で出力できると非常に嬉しいのですが・・・ ご回答よろしくお願い致します。
下記の「テーブル１」から、 テーブル１ 商品名｜価格 ------------ AAAAAA｜1000 AAAAAA｜1200 AAAAAA｜1500 BBBBBB｜2100 BBBBBB｜2600 CCCCCC｜2000 DDDDDD｜3000 EEEEEE｜6000 EEEEEE｜6000 EEEEEE｜7000 EEEEEE｜7500 下記のように出力するにはどのようにSQLを書いたらいいでしょうか。 商品名｜価格｜通番 ------------------ AAAAAA｜1000｜１ AAAAAA｜1200｜２ AAAAAA｜1500｜３ BBBBBB｜2100｜１ BBBBBB｜2600｜２ CCCCCC｜2000｜１ DDDDDD｜3000｜１ EEEEEE｜6000｜１ EEEEEE｜6000｜２ EEEEEE｜7000｜３ EEEEEE｜7500｜４ 要するに、「商品名」ごとに、「価格」で昇順にソートして「通番」をつけたいのです。 なお、上記「EEEEEE」には価格が6000のレコードが２つありますが、「通番」はそれぞれ１と２をふっています。 このように、価格が同じレコードがある場合にもカウントアップさせて通番を付与したいです。 ご回答よろしくお願い致します。
カレンダーのようなものを作ってスケジュールの管理をしたいと思い、 start_at datetime end_at datetime sunday boolean monday boolean tuesday boolean ... のように予定の開始・終了時間と、定期的な予定用に曜日のフラグを立てるためのフィールドを用意しました。 データ作成時にすでに登録してある予定と被っているものを抽出したいのですが、 たとえば 毎週月・水・木曜 10:00～12:00 のデータが登録してあり、 1/4 14:00 ～ 1/10 10:00 みたいなデータを新たに登録しようとした場合にどういう風にSQLを書けばいいのかがよくわかりません。 日付から曜日を割り出して、たとえば0なら日曜のフラグがたっているものを抽出するみたいなSQLをかけるのでしょうか？ できれば1回のSQLでできればいいのですが…… 聞きたいことがうまく伝わらないかもしれずもうしわけないです。 よろしくお願いします。
お世話になっております。 ■CGI、PHP、 MySQL が使用可能な無料レンタルサーバーでphpMyAdminをセットアップする方法を教えていただけないでしょうか？ phpMyAdminをダウンロードし、http://ドメイン名/public.htmにFTPソフトでアップロードしたんですが、http://ドメイン名/phpMyAdminにアクセスしたがエラーになります。 素人で申し訳ございませんが宜しくお願いいたします。
使用OS:Windows7 現在XAMPPを利用してMySQLとPHPとApacheでWebデータベースを作りたいと考えています。ところが文字コードで問題が発生し、困っております。 MySQLにデータを入れようとしたところ「5C問題」が原因で文字化けしてしまいました。そこでutf-8にしてデータを入れたんですが、次は日本語のデータが反映されませんでした。 そこでEUC-JPを使用したいと思っているのですがなかなかターミナルソフトが選択できずとりあえずEUCに対応しているという「RLogin」というターミナルソフトを使ってみました。しかしターミナルソフトからMySQLに接続する方法が分かりません。 どなたかMySQLを使用する際にオススメのターミナルソフト、そしてターミナルソフトを利用してMySQLに接続する方法を教えてください。 よろしくお願いします。
WEBサイトからのMySQLの登録閲覧で同時アクセスが負荷が増えサーバーがダウンしないようにする一番有効な対策てなんでしょうか。
Mysql（5.1）を利用してWebアプリケーションを作成しているのですが、ユーザマスタのテーブルを作成する時に、カラム　ユーザIDにAUTO_INCREMENTにした場合、他のカラム　登録者ユーザID　ENTRY_USER_ID、更新ユーザID　UPDATE_USER_IDにもAUTO_INCREMENTを指定したいのですがエラーになってCREATEできません。 エラーが表示されます。 ERROR 1075 (42000): Incorrect table definition; there can be only one auto column and it must be defined as a key ぐぐって見たのですが、プライマリーキーなどといっしょに指定するみたいなのですが、SQL文は、create table USER_MST ( USER_ID INTEGER(10) AUTO_INCREMENT, NICKNAME VARCHAR(12) NOT NULL, ENTRY_USER_ID INTEGER(10) AUTO_INCREMENT, UPDATE_USER_ID INTEGER(10) AUTO_INCREMENT, ENTRY_YMD TIMESTAMP NOT NULL, UPDATE_YMD TIMESTAMP NOT NULL, DELETE_YMD TIMESTAMP NULL, PRIMARY KEY ( USER_ID ,ENTRY_USER_ID,UPDATE_USER_ID) )ENGINE=InnoDB CHARACTER SET UTF8; を実行しているのですが、うまくいきません。 ご教授お願いします
ついこないだ迄動いていたMysqlが動かなくなりました。唯、ODBCからはデータが見えるし、おかしくないのですがDOSから動かすとエラーになります。 １．net start Mysql 　　Mysqlが動きます ２．mysql -u root -p -b 　　Mysqlは内部コマンド、外部コマンド 　操作可能なプログラム又はバッチファイルとして認識されていません。 と出てしまいます。 　どなたか、ご教授下さるようお願い致します。
「1,2,3,5,10…」のようにカンマ区切りになっている文字列が格納されているカラム(number)があり、その文字列に含まれている数字と検索用配列「1,2,3」と比較して存在すれば抽出するみたいなことがやりたいのですがよくわかりません。 カンマ区切りではなく単一の数字であれば select * from tests where number IN(1,2,3); みたいな感じでnumberがIN()のなかにあるかどうかで抽出できると思うのですが、この場合はどのようにすればよいのでしょうか。 ちょっと説明が下手でわかりづらいかと思いますがよろしくおねがいします。
id,urlというテーブルにおいて、url中のファイル名が同じものを抜き出したい。 こんなテーブルがあります。 id url 1 http://okwave.jp/test/abc.wav 2 http://okokok.jp/456.jpg 3 http://okokok.jp/abc.wav ......続く urlは必ずファイル名.拡張子で終わっています。 これらのURL中のファイル名.拡張子が同じもの(上のid1とid3などが例です)を抜き出して、 SELECT ファイル名,COUNT(同じだった数) というふうに表示させたいのですが、どのようなSQLを組めばよいでしょうか？ PHPでも構いません。 ご教授願います。
LIKEは類似一致検索なのでしょうか？ "%Allegro%"で検索すると、「関係ない文字～アレグロ～関係ない文字」がヒットします。 といっても、MySQLがシソーラス辞典を持っているなんて思えませんし… 理由をご存じの方、ご教授ください。
2つのテーブルにあるIDを1つのID(item_id)？にしたいです。 このやり方は間違ってますか？ ご指摘よろしくお願いします。 車テーブル car_id name 　maker price 1　　　スープラ　トヨタ 100 2　　　スカイライン 日産 100 食べ物テーブル food_id name price 1 リンゴ　100 2　　　バナナ　100 アイテムテーブル item_id car_id(外) food_id(外) 1 1 NULL 2 2 NULL 3 NULL 1 4 NULL 2
MySQLのデータベースを呼んで日付表示をする点で困っています。 フィールド名：k_pvm 型：DATE データ：2009-12-21 phpでキーを元に呼び出して表示しています。表示形式は、d-m-Yで21-12-2009と表示させたいのですが、うまくできません。 echo "<tr><td>Rekisteri: </td><td><input type='hidden' name='kpv'>" . date('d-m-Y', $row['k_pvm']) . "</td></tr>";　表示＞　01-01-1970 以下、日付データ部分を変えて試してみました。 date($row['k_pvm'])　＞　2009-12-21 $row['k_pvm'] ＞　2009-12-21 date('d-m-Y')　＞　2009-12-22　（試した当日の日付） 試した3点については理解できますが、呼び出したデータに表示形式を指定するとどうして、01-01-1970を表示するのか解りません。直接dateで表示するのではなく、何か手順を踏まないといけないのでしょうか。
mysqlのクエリについて mysqlのバージョンが4.0ですので副問い合わせは利用できません。 select * from a_table; i| group | no 1| test1 | NULL | 2| test1 | NULL | 3| test2 | NULL | 4| test2 | NULL | 5| test2 | NULL | 6| test2 | NULL | 7| test3 | NULL | 8| test4 | NULL | このようなテーブルとデータがあったとき i| group | no 1| test1 | 1 | 2| test1 | 2 | 3| test2 | 1 | 4| test2 | 2 | 5| test2 | 3 | 6| test2 | 4 | 7| test3 | 1 | 8| test4 | 1 | というようにupdateしたいのですが どのようなクエリをかけば宜しいのでしょうか。 すみませんがお教えください。
重複データを除いてカウントしたい お世話になります。 PHP＋MySQLでWEBサイトを作ろうとしている者です。 どうしても自分ではわからないことがあって質問いたします。 以下ような2つのテーブルがあり、 レンタルした顧客の都道府県が 月別にカウントされるようにしたいと考えています。 テーブルA(顧客情報) 顧客名　　都道府県 （name）　（prefec） Aさん　　　東京都 Bさん　　　千葉県 Cさん　　　神奈川県 Dさん　　　東京都 Eさん　　　千葉県 テーブルB(レンタル・レンタル品目情報) 顧客名　　　　期間(開始月・返却月)　　レンタル品目 （name）　　　（start）（end）　　　（item） Aさん（東京）　　1月　　　6月　　　　自動車 Aさん（東京）　　1月　　　6月　　　　オートバイ Aさん（東京）　　2月　　　6月　　　　チャイルドシート Bさん（千葉）　　3月　　　5月　　　　自動車 Bさん（千葉）　　3月　　　5月　　　　チャイルドシート Cさん（神奈川）　1月　　　2月　　　　自動車 Cさん（神奈川）　2月　　　3月　　　　オートバイ Dさん（東京）　　2月　　　4月　　　　自動車 Eさん（千葉）　　3月　　　6月　　　　オートバイ 想定する結果は 1月は 東京(1人)　千葉(0人)　神奈川(1人) 2月は 東京(2人)　千葉(0人)　神奈川(1人) 3月は 東京(2人)　千葉(2人)　神奈川(1人) となります。 品目数であれば以下の式でカウントできるのですが、 顧客数をカウントしようとすると重複が発生して うまく顧客数だけに結果を導くことができません。 SELECT prefec,COUNT(name) AS cnt FROM tbla INNER JOIN tblb USING(name) WHERE (指定月 BETWEEN start AND end) GROUP BY prefec 参考までに上の式では 1月は +----------+-----+ | prefec | cnt | +----------+-----+ | 東京都 | 2 | | 神奈川県 | 1 | +----------+-----+ 2月は +----------+-----+ | prefec | cnt | +----------+-----+ | 東京都 | 4 | | 神奈川県 | 2 | +----------+-----+ 3月は +----------+-----+ | prefec | cnt | +----------+-----+ | 千葉県 | 3 | | 東京都 | 4 | | 神奈川県 | 1 | +----------+-----+ となります。 この場合、どのような式にしたら想定する結果が導き出せるのでしょうか。 よろしくご教授をお願いいたします。
初心者です。申し訳ありません。 教えて頂けますか？ paypal IPN の支払い日時の項目が、 22:21:15 Dec. 20, 2009 PST というフォーマットでした。 これは、datetime でも timestamp でもありませんよね？ datetimeに変換する方法はありますか？
初心者です。 よろしくお願いします。m(_ _)m サーバーをsakuraインターネットから海外のbluehostに変更しました。 mysqlのデータが文字化けしてしまって困っています。 sakuraではUTF-8で使用していましたので、bluehostでは照合順序をutf8_general_ciに設定してデータをインポートしました。 phpmyadminの中では問題なく文字化けも起こしていないのですが、WEB側で表示（charset=utf-8）させると、日本語が全部????????????と文字化けを起こしています。 非常に困っています。 どうぞよろしくお願い致します
お世話になります。PHP+MySQLでシステムを作っています。 商品のカテゴリーのテーブル・・・hametome_category（主キー：category_id ） 商品のテーブル・・・hametome_item（主キー：item_id ） 注文のテーブル・・・hametome_order（主キー：order_id ） 上記の3つのテーブルがあります。各テーブルにはそれぞれ、下記のようなデータを格納していて（）内のカラムが含まれています。 hametome_category・・・カテゴリー名（category_id） hametome_item・・・商品名、単価など（category_id、item_id） hametome_order・・・注文内容等（category_id、item_id） この3つのテーブルを使い、カテゴリーごとの商品の一覧表を作り、一覧表の中に商品ごとの注文数量の累計を表示させたいと思っています。 【作りたい表のイメージ図】 　　　　単価　在庫数　注文数累計 商品A　 100 1500 11000 商品B　 120 1000 13000 商品C　 130 1700 18000 　・ 　・ 　・ 表がずれていたらスイマセン＾＾； SELECT文を使ってデータを抽出するのですが、この際、 $sql="select * from hametome_category c,hametome_item i where i.category_id = $id and c.category_id = i.category_id ORDER BY item_id"; このようにすると任意のカテゴリーに属する商品の一覧表を出力する事は出来るのですが（$idは前ページからPOSTされてきます。）、これに注文内容のデータ抽出を組み合わせようとするとうまくいきません。 この表に注文内容（hametome_orderに登録されているデータ）をitem_idでグループ化し合計したものを表示させたいです。 $sql="select *,SUM(order_amount) AS goukei from hametome_order GROUP BY item_id"; とすれば、注文数の累計をitem_idで合計しグループ化する事は出来るのですが（『order_amount』はhametome_orderテーブルに登録されている注文数です。）、この内容を最初のSELECT文にうまく組み込む事が出来ません。 どのようにすれば思うような結果を得られるでしょうか？ご教授のほどよろしくお願い申し上げます。
テーブルA　 id phone ---------------- 1 8199992222 2 8211113333 3 8211114444 4 85233334444 テーブルB id Prefix name ------------------------- 1 81 Japan 2 82 Korea 3 852 Hong Kong テーブルBは使わず、 SELECT a.id, a,Phone, Case when a.Phone like '81%' then 'Japan' when a.Phone like '82%' then 'Korea' when a.Phone like '852%' then 'Hong Kong' else null end FROM テーブルA as a とすると、下記のようになると思いますが、”like '82%'” の部分がたくさんあり、１つづつ全て書くことができません。 一覧が テーブルBにあるPrefiｘ なので、こちらを使って効率よくできませんでしょうか。 id phone name -------------------------------- 1 8199992222 Japan 2 8211113333 Korea 3 8211114444 Korea 4 8523334444 Hong Kong MYSQL ver: 5.0.51a 他必要な情報があればお知らせください。 宜しくお願いします。
xamppをインストールしMySQLを使おうとしたのですが、日本語をinsertしようとすると？で格納されてしまいます。 my.iniの設定を以下のように変えてみましたがうまくいきません。 [client] # 追加 default-character-set = utf8 [mysqldump] # 追加 default-character-set=utf8 [mysqld] # 追加 skip-character-set-client-handshake default-character-set = utf8 character-set-server = utf8 collation-server = utf8_general_ci init-connect = SET NAMES utf8 [mysql] # 追加 default-character-set=utf8 STATUS;コマンドで確認すると Client characterset: utf8 Server characterset: utf8 とってなっており、SHOW VARIABLES LIKE 'char%';を実行してもcharacter_set_filesystem以外はutf8になっています。 xampp等のバージョンは以下の通りです。 xampp　1.7.2 MySQL　5.1.37 PHPからのクエリ発行、phpmyadminというツールからのクエリ発行どちらも？で格納されてしまいます。 もうどこが問題なのか見当が付きません。 よろしくお願いします。
MySQL5.1.33-communityをWindows上のXAMPPにて使用しています。 操作端末としてphpMyAdmin3.1.3.1を使用しています。 約90個のテーブルがあり、それらの照合順序が意に反してlatin1_swedish_ciになっており、これらを全てujis_japanese_ciに変更したいと思っています。 この場合、ALTER TABLE 文で行えばいいというのはわかるのですが、 ALTER TABLE `テーブル名` CONVERT TO CHARACTER SET ujisとして1つずつテーブル名を指定しなければできないのでしょうか。 まとめて一撃で行う方法はありませんか? ALTER TABLE * CONVERT TO CHARACTER SET ujis とやってみても通りませんでした。 DROP TABLEの場合、テーブル名をコンマで区切って列挙して複数テーブルを一撃でDROPできたのですが、ALTER TABLEの方ではどうも通りませんでした。 普段はPostgreSQLを使っているのでMySQLについてははじめての経験です。詳しい方、よろしくご教示ください。
私は、MySQLとPHPを使って、情報検索サイト (Webアプリケーション)をつくりたいのですが、 MySQLおよびPHPのコマンド入力画面を立ち 上げるには、どのようにすればよろしいので しょうか? 私は、MySQL／PHPについてはまったくの 初心者で、何をどのようにすればよいのか、 さっぱりわかりません。 具体的な手順を教えていただけたら幸いです。 ---------------------------------------- レンタルサーバーは、paperboy&co.の「チカ ッパ！」を使用しています。 「チカッパ！」には、MySQL／PHP／phpMyAdmin がインストールされていて、 データベース名やID、パスワード等を、「チカ ッパ！」の管理画面で設定すれば、 MySQL／PHP／phpMyAdmin が使えるように なるのだと思いますが、 ID等を設定した後、次に具体的にどのように すれば、実際に使えるようになる(=コマンド 入力ができるようになる)のかが、わからない のです。 「チカッパ！」では、MySQL／PHP／phpMyAdmin の使い方のサポートはしないそうです。 以上、よろしくお願い致します。
任意の上位の集計を取得するにはどうしたらよいかわかりません。初めての質問なので、うまく表現できないことをご容赦ください。 例としてテーブルを記させていただきました。 testというテーブルに以下のようにデータが入っているtestというテーブルを想定しています。u_0で降順で上位3つのu_0とa_0を取得したいのですが、 select sum(u_0),sum(s_0) order by u_0 desc limit 0,3 では当然全集計となりますので意図したものとの結果になりません。 是非、ご教授いただければ幸いです。 +--------+------+ | u_0 | s_0 | +--------+------+ | 510 | 1 | | 1701 | 9 | | 22454 | 91 | | 43271 | 148 | | 2979 | 9 | | 618 | 8 | | 161148 | 420 | | 6657 | 21 | | 12562 | 17 | | 7619 | 25 | +--------+------+ sum(u_0)=161148+43271+22454 sum(a_0)=420+148+91 取得したいのは +----------+----------+ | sum(u_0) | sum(s_0) | +----------+----------+ | 226873 | 659 | +----------+----------+ ということなのですが、よろしくお願い申し上げます。
こんばんは。 spotテーブル spot_id(主) spot_name 1 　　札幌ラーメン横丁 2 　　函館公園 3 　　清水寺 4 　　金閣寺 5 　　嵐山 cityテーブル city_id(主) city_name 1 　　北海道 2 　　京都府 relationテーブル s_id(外) c_id(外) 1 1 2 1 3 2 4 2 5 2 SELECT spot.spot_id, city.city_id, spot.spot_name, city.city_name FROM city INNER JOIN (spot INNER JOIN relation ON spot.spot_id = relation.s_id ) 　　ON city.city_id = relation.c_id 上記のように３つのテーブルをつくり結合させました。 そして、PHPを用いて出力させると下記のような結果になりました CitySPOT 北海道 札幌ラーメン横丁 北海道 函館公園 京都府 清水寺 京都府 金閣寺 京都府 嵐山 望むのは下記のようにまとめたいのですが、どうすればいいのでしょうか？ CitySPOT　　　　　　　　？ 北海道 札幌ラーメン横丁　函館公園 京都府　清水寺　　　　　　 金閣寺　　嵐山 GROUP BY を使うのかなと思い、GROUP BY city.city_id　としたのですが、 CitySPOT 北海道 札幌ラーメン横丁 京都府 清水寺 あらら・・・　函館公園と金閣寺と嵐山が消えてしまっって・・・ 希望通りにできません。 ご指摘よろしくお願いします
MySQLのログについて質問です。 現在、MySQL Administratorを使用して、遠隔でデータベースサーバにログインしようとしたところ以下のようなエラーが発生しました。 ■エラー内容（クライアントに表示されたもの） MySQL Error Number 1130 Host 'host名' is not allowd to connect to this MySQL server ちなみに、このエラーはデータベースのアクセス権を付与する事で回避でき、無事にデータベースへ接続は出来たのですが、データベースサーバの方に、このようなアクセスしてきたログは残っていませんでした。 そこで、上記のようなエラーが発生した場合、サーバ側のログに出力させる事は可能でしょうか？ ちなみに、/etc/my.confのログ設定内容は以下の通りになっています。 ■サーバ側のmy.confに記述してあるログ設定内容 log-error=/var/log/mysqld.log log=/var/log/mysqld.log mysqld.logは、オーナー、グループ共に「mysql」です。 Error Number 1045などは、アクセス時にパスワードが無いというログが、mysqld.logに出力されるのですが、Error Number 1130が残りません。 どうにかして、サーバ側でこのようなアクセスがあった事を確認する方法（ログの出力方法など）はありませんか？ 是非とも、ご教示よろしくお願いいたします。
テーブル A と テーブル B は同じ構造です。 A のレコードを B のレコードで更新するにはどうすれば良いのでしょうか？ UPDATE a Set( a.id = b.id, a.dat = b.dat ) FROM a INNER JOIN b ON a.id = b.id #1064 - You have an error in your SQL syntax; the right syntax to use near '( a.id = b.id, a.d = b.d ) FROM a INNER JOIN b ON a.id = b.id' at line 1 MySQL 5.1.33 CREATE TABLE `a` ( `id` INT NOT NULL , `dat` INT , PRIMARY KEY ( `id` ) );
いつもお世話になっております。 Linuxの環境構築を行っているのですが、MySQLをインストール後、Postfixをインストールしたところ、MySQLが起動しなくなってしまいました。 具体的な手順としては、 mysqld_safe & として、MySQLサーバを起動し、その後確認のために mysqladmin ping とコマンドを入力してみると、 mysqladmin: connect to server at 'localhost' failed error: 'Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (111)' Check that mysqld is running and that the socket: '/var/lib/mysql/mysql.sock' exists! とのエラーメッセージが出力されます。 自分なりに調べたところ、Postfixをインストールすると、/etcの中に勝手にmy.cnfが出来るらしかったので、とりあえずmy.cnfを別の名前にして、Linuxを再起動してみたのですが、同じ現象でした。 何か解決策がお分かりでしたら、教えて下さい。 宜しくお願い致します。 環境は、以下のとおりです。 OS：CentOs 5.3 MySQL：5.1.35 Postfix：2.3.3 MySQLはソースファイルから、Postfixはyumコマンドにてインストールしました。
mysql5.1.33を使用しています。 次のような構成で、 テーブル「tbl1s」 id int(11) テーブル「tbl2s」 id int(11) テーブル「tbl1s_tbl2s」 id int(11) tbl1_id int(11) tbl1sの外部キー tbl2_id int(11) tbl2sの外部キー テーブル「tbl2sbelongs」 id int(11) tbl2_id int(11) tbl2sの外部キー count int(11) テーブル「tbl1s」 +------+ |　　id　　| +------+ |　　1　　| +------+ |　　2　　| +------+ |　　3　　| +------+ テーブル「tbl2s」 +------+ |　　id　　| +------+ |　　1　　| +------+ |　　2　　| +------+ |　　3　　| +------+ テーブル「tbl1s_tbl2s」 +------+-------+-------+ |　　id　　| tbl1_id　|　tbl2_id　| +------+-------+-------+ |　　1　　|　1　　　　|　1　　　| +------+-------+------+ |　　2　　|　1　　　　|　2　　　| +------+-------+------+ |　　3　　|　3　　　　|　3　　　| +------+-------+------+ テーブル「tbl2sbelongs」 +------+-------+-------+ |　　id　　| tbl2_id　|　count　| +------+-------+-------+ |　　1　　|　1　　　　|　3　　　| +------+-------+------+ |　　2　　|　2　　　　|　10　　| +------+-------+------+ |　　3　　|　3　　　　|　15　　| +------+-------+------+ SELECT * FROM `tbl1s_tbl2s` AS `Tbl1sTbl2` INNER JOIN (SELECT *, sum(Tbl2sbelong.`count`) as sum FROM `tbl2s` AS `Tbl2` INNER JOIN `tbl2sbelongs` AS `Tbl2sbelong` ON (`Tbl2`.`id`=`Tbl2sbelong`.`tbl2_id`) WHERE 1 = 1 GROUP BY `Tbl2`.`id` ) AS `SUB` ON (`Tbl1sTbl2`.`tbl2_id`=`SUB`.`id`) WHERE 1 = 1 GROUP BY `tbl1_id` を実行すると、 「SQL Error: 1060: Duplicate column name 'id' 」 というエラーが出てしまいます・・・ おそらくカラムのidが結合の中で重複しているという内容だと思うのですが、 ３つもテーブルが絡んでくるとどれのidがというのが分からないのですが、 これは何が原因なのでしょうか？ ちなみにサブクエリの SELECT *, sum(Tbl2sbelong.`count`) as sum FROM `tbl2s` AS `Tbl2` INNER JOIN `tbl2sbelongs` AS `Tbl2sbelong` ON (`Tbl2`.`id`=`Tbl2sbelong`.`tbl2_id`) WHERE 1 = 1 GROUP BY `Tbl2`.`id` この段階までは実行できます。 最終的には、「tbl2sbelongs」テーブルの「count」の値によって、「tbl1s」を降順に並べ替えたいと思っています。 この例だと テーブル「tbl1s」 +------+ |　　id　　| +------+ |　　3　　|count ＝ tbl2_id「3」の15 ＝ 15 +------+ |　　1　　|count ＝ tbl2_id「1」の3 ＋ tbl2_id「2」の10 ＝ 13 +------+ |　　2　　|count ＝ 0 +------+
現在、PHPとMySQLにて、会員登録のシステムを構築しています。 初歩的なことかとは存じますが、以下のような場合どのような形にするのが良いのかアドバイスいただけますでしょうか。 データベースのテーブルのフィールドに、 メールアドレス登録用のフィールドがあり、 デフォルトはNULLとしています。 メールアドレス自体は任意の入力項目となっており、 空の場合もあります。 入力が空の場合は、データ追加あるは更新の際、 メールアドレスのフィールドには空文字を入れるのが良いのでしょうか。あるいは「NULL」としておく方が良いのでしょうか。 よろしくお願いします。
金額100円～300円 というデータがそれぞれテーブル(test1)のカラムに pay_under：100 pay_limit：300 という形で入っています。 これを検索画面で 金額：「　　」 の中に 100から300の値を入れて検索した場合に 上のデータが抽出されるSQLの書き方を教えてください。 例） 金額：「150」→　抽出 金額：「300」→　抽出 金額：「60」 →　抽出されない
MySQLとPHPを組み合わせて、時刻表(電車、バス等)のデータベースを作成 しようと思っています。 最終目標としては http://transit.jp.msn.com/ こんな感じにしたいのですが、私個人でやる分には時間がかかりそうなので、 http://miztools.so.land.to/php5_list/rosen/rosen … こんな感じで完成すればいいかなって思っています。 そこで3つほど質問なのですが、 1, PHPとMySQLについて述べてあるお勧めの本は? 2, よくネットで見かける駅探などの時刻表検索システムの仕組みは? 1についての補足。超初心者のため、書籍を購入しようと思っております。できれば、サンプルが載っているものがいいです。そうでなくとも、検索システムについて詳しく分かるものでも構いません。 2についての補足。駅探等もPHP+MySQLのように、私が行おうとしているものと同じ考え、同じプログラミング言語で設計できるのか?ということ。 ちなみにPHP、MySQLともに超初心者です。C言語はある程度できます。 OS : Windows XP phpdev423をインストール済み
重複データを抽出して、重複しているデータ分だけを一括で削除する事は可能でそうか。 SELECT hoge,count(*) AS count FROM テーブル GROUP BY hoge HAVING count>1 このように出せば重複データを出せたのですが、500件ほどレコードがあり、手作業では辛いです。 お力お貸しくださいませm（_ _）m よろしくお願いします。
こんばんわ。 今少し書き方がわからないSQL文があって困っています。 テーブルA(データが入ってるテーブル)に 新規でカラムを追加したので、 今UPDATE文を使いたいと思っています。 膨大なので、１つ１つする訳にはいかないので、 条件指定して、あるカラムにあるとある条件に合致するものは 新規カラムの値が４とか ある条件なら、新規カラムの値が６などと入れたい感じです。 自分なりに調べて UPDATE テーブル名 SET 新規カラム = 値 WHERE (SELECT * FROM 同じテーブル名 WHERE 条件) だと思って色々書いたり試行錯誤したのですが、 全然できませｎ。 どのように書けばよろしいのでしょうか？ またUPDATEをかける際の条件指定に２つの違った 条件(同じカラムの違う条件、または別カラムの条件) を入れることは可能でしょうか？ 回答いただけるとありがたいです。 よろしくお願いします。
PHP+MySQLで AUTO_INCREMENTを使用してidを管理したいんですが 複数テーブル（test1,test2）に 同じ「tourokou_id」というカラムが あります。 両方のtourokou_idをAUTO_INCREMENTすると test1 1 2 3 4 　・・・・・ test2 1 2 3 4 　・・・・・ となってしまいますよね。 これを test1 1 3 4 　 ・・・・・ test2 2 　 5 ・・・・・ という風にしたいんですがどのようにすればいいんでしょうか？ そもそもできるんでしょうか？
コンビニのリアルタイムの会計データや電車のリアルタイムな予約システムの登録更新にMySQLを使用しても問題なく使うことは出来ますか。
Datetime型とTimestamp型ではどのように使い分けるのが一般的なのでしょうか？ とりあえず、表示日時や諸費バイト数に差があるのはわかったのですが、その他にDatetime型とtimestamp型でメリットデメリットが何かあるのでしょうか？
mysql5.1.33を使用しています。 テーブル「tbl1」 id int(11) テーブル「tbl2」 id int(11) num1 int(11) テーブル「tbl1_tbl2」 id int(11) tbl1_id int(11) tbl1の外部キー tbl2_id int(11) tbl2の外部キー テーブル「tbl1」 +------+ |　　id　　| +------+ |　　1　　| +------+ |　　2　　| +------+ |　　3　　| +------+ |　　4　　| +------+ テーブル「tbl2」 +------+------+ |　　id　　| num　| +------+------+ |　　1　　|　5　　| +------+------+ |　　2　　|　10　　| +------+------+ |　　3　　|　50　　| +------+------+ |　　4　　|　100　| +------+------+ テーブル「tbl1_tbl2」 +------+-------+-------+ |　　id　　| tbl1_id　|　tbl2_id　| +------+-------+-------+ |　　1　　|　1　　　　|　2　　　| +------+-------+------+ |　　2　　|　1　　　　|　3　　　| +------+-------+------+ |　　3　　|　2　　　　|　1　　　| +------+-------+------+ |　　4　　|　4　　　　|　4　　　| +------+-------+------+ というテーブル構成で、tbl1の所有するtbl2のnum1の平均値によって降順にソートしたいのですが どのようなSQL文になるのでしょうか？ 例えばこの場合では、 tbl1のid「1」は、（tbl1_tbl2のid1「1」のtbl2_idのnum（10）＋　tbl1_tbl2のid1「2」のtbl2_idのnum（50））÷2＝30 tbl1のid「2」は、（tbl1_tbl2のid1「3」のtbl2_idのnum（5））÷1＝5 tbl1のid「3」は、tbl1_tbl2にないので＝0 tbl1のid「4」は、（tbl1_tbl2のid1「4」のtbl2_idのnum（100））÷1＝100 なので テーブル「tbl1」は +------+ |　　id　　| +------+ |　　4　　| +------+ |　　1　　| +------+ |　　2　　| +------+ |　　3　　| +------+ に並べ変えられた結果が得たいです。
MySQL5の文字化けについて linuxもデータベースも初級の素人です。 my.iniをデフォルトのままwindowsからTeraTermでサーバに接続し SQLを発行していたのですが、そのときは日本語が文字化けしませんでした。 しかしphpmyadminを利用しようとmy.iniを変更すると、変更したが為に日本語文字化けするようになってしまいました。 修正後はMySQLは再起動しており、再起動後、新たにテーブルを作成し、 データの挿入をしてテストしています。それでもうまくいきません。 修正後のmy.iniのどこがおかしいのでしょうか？ [サーババージョン] OS:CentOS5.4 (ＯＳの文字コード：UTF-8のまま変更なし) MySQL5.0.77 [テスト環境] windowsマシンからTeraTermProでログイン ・TeraTermの設定：文字コード送受信ともに「UFT-8」を指定 ****************** [ 変更前のmy.ini ] *********************** [mysqld] datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock # Default to using old password format for compatibility with mysql 3.x # clients (those using the mysqlclient10 compatibility package). old_passwords=1 user=mysql [mysqld_safe] err-log=/var/log/mysqld.log pid-file=/var/run/mysqld/mysqld.pid *************************************************************** ****************** [ 変更後のmy.ini ] *********************** [mysqld] datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock # Default to using old password format for compatibility with mysql 3.x # clients (those using the mysqlclient10 compatibility package). old_passwords=1 default-character-set=utf8 init-connect=SET NAMES utf8　（←これがいるのがよく分からない） skip-character-set-client-handshake [mysql.server] user=mysql basedir=/var/lib [mysqld_safe] log-error=/var/log/mysqld.log pid-file=/var/run/mysqld/mysqld.pid [mysql] default-character-set=utf8 [mysqldump] default-character-set=utf8 [client]　←　（これもいるのかよく分からない） default-character-set=utf8 ************************************************************* ********* TeraTermで接続しSQLを発行したときのSQL文 ********** mysql> create table account (ID integer primary key, NAME varchar(100), MONEY varchar(100) ); mysql> insert into account values (1,'ボブ',1000), (2,'パトリック',2000), (3,'サンディー',3000), (4,'イカルト',4000) ; ************************************************************* かなりテンパってます。。 よろしくお願いします。
こんばんわ。プログラミング、データベース初心者です。 皆さんにどうしても教えて欲しいSQL文があります。 テーブルが３つあったとして、 １つはカラムに市町村のコードと名前が入ってるテーブルA、 ２つめはカラムに色々なジャンルのコードと名前が入ってるテーブルB、 そして３つめにそれらのコードのみが入っていて、 色々カラムに他の情報が入ってる実際に使いたいテーブルCがあります。 例えば市町村名や町域で検索をかけた場合、 それを変数に入れて、 テーブルAでwhere句にてLIKE検索してコードを取り、 そのコードで紐づいたテーブルCからの情報を全部取りたいです。 一度に済ますにはどのようにSQLを書けばいいのでしょうか？ 色々調べてみたのですが、全然わかりません。 回答いただけると大変ありがたいです。 よろしくお願いします。
innoDBでコミットする前の更新データに関してなのですが。 insert等をするとメモリ上のバッファに書き込まれて、コミットと同時にログに書き込まれると思うのですが、 コミット前に大量のinsert等をするとバッファからあふれたデータはどうなるのでしょうか。 多分ファイルに退避されるのだと思うのですが、どこに退避されるのでしょうか。 マニュアルなどを調べましたがわかりませんでした。 よろしくお願いいたします。
お世話になっております。 MYSQL5を利用しております。 この度、別サーバーのDB同士を結合することは可能かどうか、もし可能であればサンプルを頂けないかと思い、投稿させて頂きました。 [現在使用しているDBサーバ] kagoyaサーバーのDB(MYSQL) sakuraサーバーのDB(MYSQL) [上記DBを結合させるコードを記述したファイルを置くサーバー] kagoyaサーバー 現在kagoyaサーバーにてそれぞれのDBからそれぞれのDBにアクセスして値を取得するところまでは出来ております。二回SQLを書いているのですが、これを一度でどうしても済ませたいと思い、JOINを使用して結合できないか調べてみました。 http://q.hatena.ne.jp/1178781253 http://detail.chiebukuro.yahoo.co.jp/qa/question … 上記URLのように、同サーバー内なら可能のようですが、実際にやってみたのですが、「mysql_query($sql, $db);」の第二引数でどちらのDBに接続すればいいかわからず、両方試してみましたがダメでした。(自分が書いたソースを破棄してしまったためうろ覚えなのですが、返ってきたresource はresource #13でした。) 結局できるのかできないのかわからないままの状態です・・・。もしわかる方がいましたら、どうかご教授下さい！よろしくお願い致します！
MySQLで、グループごとの最高得点者一覧を取得する方法を教えてください。 例えば、「生徒番号」「学年」「組」「成績」というカラムを持ったテーブルがあるとき、各クラス (「学年」と「組」のペア) から一人ずつ、最高得点を取得した生徒の「生徒番号」と「成績」を取得しようとしています。このとき「生徒番号」は一意ですが、「成績」は一意とは限りません。 また、同じクラスで最高得点者が二人以上いる場合、すべて取得か条件を指定して一人に絞るかを選べたらなおありがたいです。 【だめだった例】 SELECT 生徒番号, 成績 GROUP BY 学年, 組 ORDER BY 成績 DESC ⇒ 「GROUP BY 成績」なので「生徒番号」を SELECT できない SELECT 生徒番号, 成績 GROUP BY 学年, 組 HAVING MAX(成績) ⇒ 同じく SELECT 生徒番号, 成績 WHERE 成績 IN ( SELECT MAX(成績) FROM テーブル GROUP BY 学年, 組 ) ⇒ 「成績」は一意ではないので、余分な行 (他のクラスで成績が同じ者) が取得される
お世話になります。 Fedora10をベースにして、yumでMySQLをインストールして動かしています。2～3日前、突然MySQLが起動しなくなり、下記のメッセージが出てストップします。findでmysql.sockを探しても、どこにも見当たりません。どなたか、mysql.sockの復旧方法などお教えいただければ、助かります。エラーメッセージおよび環境などは下記です。 ERROR2002: Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock'(2) 環境 OS: Fedora10 MySQL Version: 5.0.84---phpinfo()で参照したClient API version 以上
MySQL 5.0.77を使用しています。 以下の通り、クエリーキャッシュを使用する設定にしているにも関わらず、全くキャッシュされません。 原因に心当たりのある方はいらっしゃいますか？ +------------------------------+------------+ | Variable_name | Value | +------------------------------+------------+ | have_query_cache | YES | | query_cache_limit | 102400 | | query_cache_min_res_unit | 4096 | | query_cache_size | 102400 | | query_cache_type | ON | | query_cache_wlock_invalidate | OFF | | version | 5.0.77-log | +------------------------------+------------+ | Binlog_cache_disk_use | 0 | | Binlog_cache_use | 0 | | Qcache_free_blocks | 1 | | Qcache_free_memory | 93832 | | Qcache_hits | 0 | | Qcache_inserts | 0 | | Qcache_lowmem_prunes | 0 | | Qcache_not_cached | 6378114 | | Qcache_queries_in_cache | 0 | | Qcache_total_blocks | 1 |
次の場合どのようにするとよいか教えてください。 ■フォーム name="hoge[]"のチェックボックスが10個あります。 値は1～10とします。 ユーザーはそのうち好きな3つまでチェックできます。 例えば1,5,6など。 そのチェックされた値をデータベースに格納しておきます。 ■やりたいこと データベースからユーザーがチェックした値の中で多いものBEST3を取り出す。 例えば1:5人、2:3人、3:10人、4～10：0人なら、3,1,2が取り出されるような感じです。 ■試したこと フォームから渡された値をSET型の一つのフィールドに入れてみました。 しかし、BEST3を数える場合に、1が何人、2が何人と数えることを一度にできるSQLが思いつきませんでした。 SELECT COUNT(*) FROM テーブル名 WHERE FIND_IN_SET('数字',フィールド名)>0 （数字はこの場合1～10が入る） とやれば1つずつはカウントできますが面倒です。 これをスマートに解決する方法はありますか？ チェックボックスの種類分（この場合10種類分）フィールドを作ったほうが賢いでしょうか？
失礼します。 データベースの勉強をしようと思い, 参考書(「基礎からのMySQL」)に付属してあるCD-ROMからXAMPPを参考書手順に沿ってインストールを行いました。 しかし, サービスでApacheもインストールしたところ完了した後に「ポート80または443（SSL）はすでに利用されています。Apache2.2をサービスとしてインストールするのに失敗しました」という状態になってしまいました。 Skypなどはまったく使用してないのですが・・・・ このようなことに関して知識がほぼない状態なので, 原因が正直わかりません。 ちなみにOSはwindows7です。 よろしくお願いします。
　愚生は全くのシロウトでございます。若干C言語をかじったことがある程度です。 　そこで質問なのですが、MYSQLが他のデータベースソフト SQL SereverやORACLEに比べ、何か利点があるのでしょうか？ 　操作性、速度等何でも結構でございます。 　ご意見をお聞かせいただければ、幸いでございます。 　それではよろしくお願い申し上げます。
id name age 1 Jone 22 2 Jone 21 3 Kelly 20 このケースで同名Joneは２人いるので、２人目のJoneは無視して、 Jone 22 Kelly 20 といったデータを取得したいのですが、方法はございますでしょうか？ Jone 21 Kelly 20 でもかまいません。DISTINCT使っちゃうと Jone Kelly しか取得できないし、どうしてもわかりません。ご教示お願いいたします。
mysql5を使用しております。 下記のようなテーブルがあるのですが、そのテーブルから、条件を元に値を取得したいのですが、どうすればいいかわからず質問させて頂きました。。 わかる方がいましたらヒントだけでも構いませんので、どうかよろしくお願いいたします！ ============================= ▼現在のテーブルの構成▼ ============================= P_id　　user_id　　item 1　　　　　1　　　　下駄 2　　　　　1　　　　下駄 3　　　　　1　　　　スニーカー 4　　　　　1　　　　スニーカー 5　　　　　1　　　　長靴 6　　　　　2　　　　スニーカー 7　　　　　2　　　　下駄 8　　　　　2　　　　長靴 9　　　　　2　　　　長靴 10　　　　　3　　　下駄 11　　　　　3　　　　スニーカー 12　　　　　3　　　　スニーカー 13　　　　　3　　　　スニーカー 14　　　　　3　　　下駄 15　　　　　4　　　下駄 16　　　　　4　　　下駄 17　　　　　4　　　長靴 18　　　　　5　　　長靴 19　　　　　5　　　長靴 20　　　　　5　　　長靴 ============================= ▼条件▼ ============================= ・各ユーザー(user_id)がアイテム(item)をそれぞれ何個持ってるかカウントしたい。 ============================= ▼取得後の理想▼ ============================= user_id　　item　　　　　count 1　　　　　下駄　　　　　2 1　　　　　スニーカー　　2 1　　　　　長靴　　　　　1 2　　　　　スニーカー　　1 2　　　　　下駄　　　　　1 2　　　　　長靴　　　　　2 3　　　　　スニーカー　　3 3　　　　　下駄　　　　　2 4　　　　　下駄　　　　　2 4　　　　　長靴　　　　　1 5　　　　　長靴　　　　　3 ※itemは実際は別テーブルと紐付けられておりitem_id(int型)が入っております。 以上になります。 GROUP BY句を使うのだろうとは分かっているのですが、単純に使っても「user_id」もしくは「item」が各idでまとまってしまい(これも説明がうまく出来ないのですが・・)どのように使えばいいかわかりません。 よろしくお願いいたします！
MySQLを利用しています。 テーブルにIntegerでそのレコードの内容の優先度を書いていますが、 これを早く交換するのにはどのような書き方がよいのでしょうか。 例えば、 ｜No｜YUSEN｜NAIYO | ｜01｜ 1｜自動車｜　　　←ここと ｜02｜ 2｜飛行機｜ ｜03｜ 3｜船舶　｜　　　←ここのYUSENの値を交換したい 　　　　　↓ ｜No｜YUSEN｜NAIYO | ｜01｜ 3｜自動車｜ ｜02｜ 2｜飛行機｜ ｜03｜ 1｜船舶　｜ と行った具合です。 よろしくお願い致します。
ＳＱＬ初心者です。こちらのサイトを参考に http://mysqlweb.net/category/3971191-1.html MySQL5.1.41をWindows7にインストールしました。Windowsサービスからは問題なく起動できるのですがコマンドプロンプトから「net start mysql」と入力して起動しようとすると システムエラー５が発生しました。 アクセスが拒否されました。 と出てWindowsサービスで確認してもサービスは停止したままです。なおWindowsサービスから起動した後は特に不具合はなさそうです。何か設定に誤りがあるのでしょうか？よろしくお願いいたします。ｍ(　 )ｍ
オレはPostgreSQLが好きなのですが、 世間ではどうもMySQLの方が人気を集めているように思えます。 いったいMySQLのどういった点がPostgreSQLに比べて優れていたり、 好ましく思われているのでしょうか。
お世話になります。 度々申し訳ないのですが、質問させてください。 現在mysqlに格納したデータの一覧を表示するページを作っているのですが、表示結果が思うようにいかず困っています。 環境：Mysql 5.1.22-rc,PHP　 5.2.5 データベース：test01 main -------------------------------------------------------- id name kana 1 太郎 たろう 2 次郎 じろう 3 花子 はなこ -------------------------------------------------------- sub2 -------------------------------------------------------- id a_sakuhin　　　title 1 data_1 　 青空 　 1 data_2 　 夕日 1 data_3 　 流星 　 3 data_1 　 町並み 3 data_2 　 列車 　 -------------------------------------------------------- というテーブルがあります。 それを一覧表示で ・太郎 (3) ・次郎 (0) ・花子 (2) という具合にしたいのですが、どうしても（）の中が全件合わせた結果になり ・太郎 (50) ・次郎 (50) ・花子 (50) という様になってしまうのです。 どういったsql文を書けばよいのかアドバイスを頂けると嬉しいです。 よろしくお願いいたします。
Mysqlがサーバにあります。Localでは以下の措置でデータの削除が出来たのですがサーバー上のデータをphpMyAdminにて同様の処置が出来ません。 SET FOREIGN_KEY_CHECKS=0; DELETE FROM contenthead WHERE (((contenthead.ClientID)=2)); SET FOREIGN_KEY_CHECKS=1; 恐らくphpMyAdminでSET FOREIGN_KEY_CHECKS=0;というSQLを投げるとOkayに なるのですがDelete命令でエラーになってしまいます。 何か上手い手はないでしょうか 宜しくご教授の程お願いします。 当方全くの初心者です。
お世話になります。MySQLに関する質問です。 TABLE1とTABLE2の２つのテーブルからレコードを抽出する際、 TABLE1からは全項目のデータを取得し、TABLE2からは一部の項目の データを取得したいと考えています。 条件は、TABLE1とTABLE2を[No]という項目の値で紐(ひも)づけます。 (1) SELECT * FROM TABLE1 (2) SELECT COL_A, COL_B, COL_C FROM TABLE2 上記(1)(2)のレコードを１つのSQLで取得する方法について、どなたかご教授願えますか？
ＰＨＰとＭｙＳＱＬを使ってやっています。 以下のように予約テーブルとエージェントテーブルがあります。 予約テーブル　　　　　　　　　　　　　　　　　　　　　　　　 予約ID　　名前　　　電話番号　エージェント　　人数　 　　11　　鈴木　　　********　　　１１　　　　１　　 　　12　　佐藤　　　********　　　１２　　　　５　　 　　13　　田中　　　********　　　１２　　　　２　　 　　14　　木村　　　********　　　１３　　　　３　　 　　15　　伊藤　　　********　　　１４　　　　４　　 　　16　　山田　　　********　　　１１　　　　８　　 エージェントテーブル　　　　　 エージェントID エージェント名 　　　　　　11　　ＪＴＢ　　 　　　　　　12　　ＨＩＳ　　 　　　　　　13　　ＫＮＴ　　 　　　　　　14　　ＨＮＫ　　 　　　　　　15　　ＫＫＫ　　 こちらのデータから以下のような検索結果を得たいのですが、 どうすれば宜しいでしょうか？ 表示結果　　　　　　　　　　　　　　　　　　　　　　　　　 　ＪＴＢ　　ＨＩＳ　　ＫＮＴ　　ＨＮＫ　　ＫＫＫ　 　　　　９　　　　７　　　　３　　　　４　　　　０ 宜しくお願いします。
windowsXPにてphpmyadminのインストール及び初期設定を行っており、 下記事象が発生し、ログインできません。 何か設定等に不備、不足があるのでしょうか。 バージョンはphpmyadmin3.2.3です。 ・事象内容 (1)phpmyadminのログイン画面で、ユーザ名、パスワードを入力し、「実行する」を押下 (2)「問題が発生しため、Apache HTTP Serverを終了します。」という内容のポップアップ（ＩＥが異常終了するときのような子画面です）が表示される (3)(2)で「エラー報告を送信する」「送信しない」というボタンがあるので、「送信しない」を押下すると、再度表示され、同様に、「送信しない」を押下すると、画面が切り替わり「Internet Explorer ではこのページは表示できません」となる。 同様の事象を探したのですが、見つからずに、質問させて頂いております。 よろしくお願いします。
色々と試行錯誤してやっていますが、なかなか自分の 思うような結果が得られないためご質問させて下さい。 テーブルが全部で3つあります。 テーブルA id name 1 巨人 2　　 西武 テーブルB id name 1 小笠原 2 ラミレス 3 中島 4　　片岡 テーブルC id テーブルAID テーブルBID 背番号 1 1 1 30 2 1 2 10 3 2 3 3 4 2 4 8 テーブルを結合し、テーブルCにある 背番号をテーブルAid,テーブルBidを元に sumしたいのですがうまくいきません。 以下がそのSQLになります。 (1)サブクエリーを使ったSQL この場合値が重複されて表示されてしまいます。 select a.name,b.name,c.name, (select sum(背番号) from tableC c where c.テーブルAId = a.id group by c.テーブルAid ), (select sum(背番号) from tableC c where c.テーブルBid = bid group by c.テーブルBid ) from tableC c inner join tableA a on a.id = c.テーブルAid inner join tableB b on b.id = c.テーブルBid (2) select a.name,b.name,c.name, (select sum(背番号) from tableC c where c.テーブルAId = a.id ), (select sum(背番号) from tableC c where c.テーブルBid = bid ) from tableC c inner join tableA a on a.id = c.テーブルAid inner join tableB b on b.id = c.テーブルBid group by c.テーブルAid 重複はされないのですが、group byが一つのみなので ちゃんとした出力がされません。 　　　他にやり方があるのかもしれませんが、お分かりになる方が 　　　いらっしゃいましたら、ご教授お願い致します。
お世話になります。 mysqlとphpでサイトを構築しています。 複数テーブルの情報を一つのページで使いたいのですが、どうも上手くいきません。 どうかよろしくお願い致します。 環境：Mysql 5.1.22-rc,PHP　 5.2.5 データベース：test01 main -------------------------------------------------------- id name kana 1 太郎 たろう 2 次郎 じろう 3 花子 はなこ -------------------------------------------------------- sub1 (実際には8カラムあります) -------------------------------------------------------- id age　　 cat　 home　 1 26 A 東京 2 24 B 千葉 3 31 O 大阪 -------------------------------------------------------- sub2 -------------------------------------------------------- id a_sakuhin　　　title 1 data_1 　 青空 　 1 data_2 　 夕日 1 data_3 　 流星 　 3 data_1 　 町並み 3 data_2 　 列車 　 -------------------------------------------------------- sub3 -------------------------------------------------------- id b_sakuhin title　 1 data_1 犬 2 data_1 猫 2 data_2 牛 3 data_1 ネズミ 3 data_2 象 -------------------------------------------------------- 上記のような構成になっており、 htmlのページ上では下記の様に表示したいと考えています。 -------------------------------------------------------- ＊id=1 の人間のページ ───────────────────────── header ───────────────────────── ───────────────────────── テーブルmainとテーブルsub1の内容 ───────────────────────── ───────────────────────── テーブルsub2の内容をデータがあるだけ繰り返す ───────────────────────── ───────────────────────── テーブルsub3の内容をデータがあるだけ繰り返す ───────────────────────── ───────────────────────── footer ───────────────────────── -------------------------------------------------------- このようにしたいのですが、上手くいきません。 現在は <?php //データベースへ接続 $dbname = "test01"; $user = "hoge"; $passwd = "**********"; $host = "hogehoge"; $db = mysql_connect("$host", "$user", "$passwd"); if (!$db){ echo "データベースの接続でエラーが発生しました<br />\n"; exit; } mysql_select_db($dbname); $sel = mysql_query("SELECT * FROM main LEFT JOIN sub1 ON main.id = sub1.id WHERE main.id = '1'"); if (!$sel) { echo "検索でエラーが発生しました<br />\n"; exit; } ?> <?php while ($row = mysql_fetch_array($sel, MYSQL_BOTH)) { ?> <dl> <dt>名前</dt> <dd><? echo $row["name"]; ?></dd> </dl> <dl> <dt>ふりがな</dt> <dd><? echo $row["kana"]; ?></dd> </dl> <dl> <dt>年齢</dt> <dd><? echo $row["age"]; ?></dd> </dl> <dl> <dt>出身</dt> <dd><? echo $row["home"]; ?></dd> </dl> <?php } mysql_free_result ($sel); mysql_close($db); ?> のようにしています。 この下にさらにsub2とsub3の内容を繰り返しで入れたいです。 while文を追加してみたり、for文を入れてみたり試しましたが何度やってもエラーがでてしまいます。 テーブルを4つ連結させるのがいいのか、別々に呼び出すのがいいのか… phpの記述がおかしいのか。そもそも、テーブルの設計から間違っているのか。 何が悪いのか、またphpの記述方法などご教授頂ければと思います。 すみませんが、よろしくお願いします。
mysql5.1.33を使用しています。 例えば、ユーザ情報を格納するuserテーブルがあって ユーザが決める半角英数字からなるIDを格納するuser_idカラムがあるとします。 そしてAuto Incrementなカラムも付け足すと、 [user] seq INT(11) NOT NULL AUTO_INCREMENT, user_id varchar(16) PRIMARY KEY (seq) UNIQUE KEY user_id (user_id) この場合はseqカラムが主キーになるわけですが、 一般的にはカラム名はseqではなくてidですよね？ なんで自分はseqにしたかというと、 user_idカラムのidには文字（半角英字）のIDを、 seqは連番を意味づけさせたいと思いました。 つまり seqがつくカラム名は連番で idがつくカラム名は文字列 と直感的に分かりやすくなるだろうと思ったからなのですが、 みなさんはこのケース（そもそもこのカラム構成が正しいかは分かりませんが・・）の場合は、 どのようなカラム名を付けますか？
マイクロソフトのアクセスで作ったデータベースをｍｙＳＱＬに変換することはできますか？出来るのでしたら、その方法を教えてください。 逆は出来ると聞いたことがありますが、初心者で検索かけてもよくわかりません。 どうぞ宜しくお願いいたします。
こんにちは。 予約システムのようなイメージの時間比較についての質問です 曜日と開始時間・終了時間を一組に、すべての条件が現在日時に 含まれている場合にTRUEという条件を作りたいのですが 間隔をあけて、同日に二つの条件が存在することもある場合 問い合わせに時間がかかってしまい、どうにかならないかと 思いまして質問に参りました 具体的な条件（今が水曜日の15：00とします） Aさん：(1)水曜、10：00～12：00 と (2)水曜、15：00～18：00 Bさん：(1)水曜、09：00～16：00 と (2)木曜、09：00～16：00 Cさん：(1)火曜、10：00～12：00 と (2)水曜、10：00～12：00 Aさんは(2)、Bさんは(1)、Cさんは(2)でHITします 私が組んだ問い合わせの具体的な内容が 曜日の部分がTRUE かつ、開始時間と現在時間の差分が0以上 かつ 終了時間と現在時間の差分が0以下（TIMEDIFFを使ってます）という 条件を1セットに、二つ目の条件は ORで同様の文を繋いでます 一セットの条件だとすぐに抽出が完了するのですが、ORで二個目を 繋いだ場合、すごく時間がかかってしまうので、他にいい方法があれば 教えて頂けますでしょうか 実コードは以下のような感じです。（1セット分です） (week01.".$week." = '1' AND TIMEDIFF('".$date."',stime01) >= '00:00:00' AND TIMEDIFF('".$date."',IF(etime01 <= stime01,ADDTIME(etime01,'24:00:00'),etime01)) < '00:00:00') ※ $week は テーブル名となる曜日の略字（Wedなど） ※ $date は 現在日時 何か良いアドバイスがあれば、よろしくお願いします MySQL クライアントのバージョン: 5.0.45です
id：自ID p_id：親ID sort：同じ親ID毎のソート順 の以下データを持つテーブルaがあるとします。 id|p_id|sort 1|0 |1 2|1 |2 3|1 |3 4|0 |2 5|4 |3 6|4 |2 7|5 |1 上記テーブルaから、SELECT文だけで 以下のような表示を行う事は可能でしょうか？ 1 +-+-2 | +-3 4 +-+-6 +-5 +-7 並び順だけでも上記のように上から123465の順で取得できることでもOKです。
はじめて質問させていただきます。 現在、MySQLを使って会員管理用DBを作成しており、以下のようなテーブルを作っています。 ID | Name | Address | UpdateDate 1 | A | 東京 | 2009-10-10 1 | A | 福岡 | 2009-10-11 2 | B | 東京 | 2008-09-02 このようなID毎に複数のデータがある状態で、各IDの最新のデータのみを取得したいのですが、方法がわからずにいます。 大変初歩的な質問かもしれませんが、方法をご存じの方どうかご教授ください。 また、素人なもので、質問の方法が悪いかもしれません。その場合、ご指摘いただければ幸いです。 よろしくお願いします。
通常SELECT命令では、WHERE句で指定した条件と一致したレコードを取り出しますが、WHERE句で指定した条件と一致するレコードが有るか無いかだけ（TRUEかFALSEを返す）を調べる方法はありますでしょうか？ ご存知の方がいらっしゃいましたらお教えいただければと思います。
MySQL5.1で、500万件あるテーブル a に対し、 100万件ずつ５種類のフラグを付けようと思います。 update a set flg = 1 limit 1000000; まではうまくいったのですが、 update a set flg = 2 limit 1000000,1000000; はSyntaxエラーとなりました。 select で一旦範囲指定し、キーを取得してから UPDATEをかける方法しかないでしょうか？
例として、id,count というフィールドを用意し、下記のようなデータを使用します。 id count A　5 B　2 C　3 このデータから、Aは ORDER BY count DESC で何番目なのか、Bは、Cは、といった形で、各々が何番目なのかを取得することは可能ですか？ また、可能でしたらどのような方法が考えられるでしょうか。 単純な例で言うと count で降順にソートした際の、id A と id C の番目を取得したい。 （Aは0・Cは1、番目が1からの場合 Aは1・Cは2といったデータ） といったピンポイントでピックアップしていくような使い方をしたいと思っています。 また、取得後はPHPでデータを利用します。 少ないデータなら、全てのデータを取得してからPHPで振り分けも可能ですが、大量のデータがある際に効率的にできないかと質問させていただきました。 よろしくお願い致します。 ----------------- 環境 　PHP 5.2.5 　MySQL 5.1.22
巨大テーブルのINDEXを複数削除したいのですが、 MySQLでインデックスを削除すると、 テンプテーブルを作成してしまうので、 テンプテーブルが作られるのを1度で済ませたいのですが、 DROP INDEX構文で、複数のINDEXを指定する事は無理でしょうか？
MySQLのUPDATE文にIFは使えないのでしょうか？ 例えば、 テーブル名：item 主キー：id フィールド名：stock、他 として、以下の文 UPDATE item SET stock = stock - 1 WHERE id = 20; を行う際に、「stock > 0」という条件を付け加える場合は、どのようにしたらいいでしょうか？ ※以下の文 UPDATE item SET stock = stock - 1 IF stock > 0 WHERE id = 20; ではだめのようでした よろしくお願いします。
いつもお世話になっております。 MySQLのデータに移行について質問させていただきます。 サーバの移転に伴い、データベースも移行することになりました。 MySQLの文字コードが変わっているため、新しいサーバで文字化けを 起こしてしまいます。 １）データのダンプ 　　$ mysqldump --user=root --password --default-character-set=latin1 DB名 > dump.sql ２）新しいサーバで文字コード変換 　　$ perl -pi -e 's/utf-8/latin1/' dump.sql ３）インポート 　　$ mysql --user=root --password DB名 < dump.sql 上記の方法で問題がありますでしょうか。 ご教示よろしくお願いいたします。 ＜旧サーバ＞ 　MySQL：3.23.58 　文字コード：euc-jp ＜新サーバ＞ 　MySQL：5.0.45 　文字コード：utf-8
MySQLServer 5.1.38でInnoDBを使を使いたい。 centosでMySQLServer5.1.38をインストールして既存のサイトのバックアップデータを移してphpMyadminで確認していたんですけど「InnoDB 」形式のテーブルを読み込めていないようで「#1286 - Unknown table engine 'InnoDB' 」とエラーメッセージが出ます。 「InnoDB 」形式を扱えるようにするにはどのような設定またはインストールが必要なのでしょうか？ よろしくおねがいします。
MySQLってコード書くのが難しくて大変なんですが、だいたいどれくらいの頭の良さが必要なのでしょうか。 高校入試の偏差値が55くらいの人では難しいでしょうか。 やっぱり70くらいないとだめそうですか？
わかりにくいかもしれませんが、お付き合いお願いします。 現在、会社でOCNのメール&ウェブPro2サーバーを利用しています。 このサーバーは利用者が自由に利用できるというのがウリのサーバ（詳細は省略させていただきます）となっております。 そこで、MySQLやPHPは手動でインストールしないと駄目みたいで、インストールはマニュアルの手順どおりやれば出来るのですが、 設定の方法がまったくと言っていいほどわかりません。 サポートに電話した所、設定はサポート外の一点張りでMySQLが初期の状態です。 色々、ネットで検索してもwindows上での特にXAMPPの設定が主でわからない状態となっております。 linuxでの設定の変更方法などが記載しているHPまたは書籍がありましたら教えてください。 ここで言う設定方法は個人向けにサーバーを提供しているロリポップなど、 何も設定しなくてもMySQLが使える状態にしたいと言うことです。（日本語設定など） サーバー：Linux（OSの種類を調べたのですが、探せませんでした。） PC：Windows XP Pro サーバー変更すればと言われるかもしれませんが、すでに会社がOCNと契約して変更する気はなく 使えるようにしろと言われる状態です。
今まで、以下のような記述でレコード数を取得していました。 $cnt = $dbh->selectrow_array("SELECT count(*) from table_hoge"); しかし、以下のようにしないとエラーになるサーバがあります。 ($cnt) = $dbh->selectrow_array("SELECT count(*) from table_hoge"); 違いとしては、上はMySQL5.0系、下はMySQL5.1系です。 バージョンによる違いかどうか、はっきりしていないのですが、 このような仕様の変更があったのでしょうか？ もしくは、上の書き方はそもそも間違いだったのでしょうか？
お世話になっております。 LEFT JOINの記述の仕方でご確認したい事があります。 ご教授頂けますようお願いいたします。 【ご質問内容】 以下のようなSQLをLEFT JOINを使用して記述する場合、 どのように記述すればよろしいのでしょうか？ SELECT A.* FROM A B C WHERE A.COLUMN1 = B.COLUMN1 AND B.COLUMN2 = C.COLUMN2(+) AND B.COLUMN3 = C.COLUMN3(+) AND A.COLUMN4 = C.COLUMN4(+) ;
初心者なのですが、すみませんが質問させてください。ネット上でいろいろ調べましたところ、MySQLのログには、エラーログや一般クエリログ、バイナリログ、スロークエリログがあると思いますが、これらのログ内容(全種類、あるいはその中のどれかのログ内容だけでもよいのですが)を、syslogに出力させる方法はありますでしょうか。(MySQLのクラスタ関連でしたら、ログをsyslogファシリティに送る事ができる...という情報を見つけたのですが、とりあえず調べたいのはMySQLクラスタ関連ではないのです。) 恐れ入りますが宜しくお願いします。
よろしくお願いします！ タイトルがイミフで申し訳ございません。 ある動的サイトを運用していて、何とはなしにURLをチェックしていたのですが、ある番号のidを入れると、なぜかページが開かずにそのphpファイルがDLされるようになってしまっています！！ そのファイルには、ぼくのDBのパスワードなども書いてあるので、正直非常に困っています。 ちなみに、URLは、例として、 http://www.***.com/***.php?***id=5000 という感じのURLで、ある数字を入れるとファイルのDLがされてしまいます。。 そのid（例えば100）のデータベースの欄を見ても、他のidとものと何ら変わりはありませんでした。 また、「こりゃいかん！対応策が見つかるまで削除じゃ！！」と思ってそのidの欄をデータベースから削除しても、やはりDLがされてしまいます。。 どうしたらよいのでしょうか？？ どなたか原因や対策などご助言いただけますと幸いです！！ また、このあたりの情報が不足している！ などございましたらおっしゃってください！！ よろしくお願いいたします！
これからmySQLを始めようとしている者です。 第1歩でつまづいています。 mySQLのサイトをたどって、次のところへは行けます。 http://dev.mysql.com/downloads/mysql/5.0.html#wi … しかし、Downloadのボタン（下記）を押しても、 Windows Essentials (x86) 5.0.87 29.6M http://dev.mysql.com/get/Downloads/MySQL-5.0/mys … 「Internet Explorer ではこのページは表示できません」返され、 アクセスができないのです。 小生のコンピュータの問題なのか、或いは、皆さんも同じなのか、 確認していただけないでしょうか？ 宜しくお願いします。
Java（Servlet,jsp)、MySQL、Tomcatを使用して開発をしています。 INSERTを行う際に別の表のデータを使用したいのですが、 上手くいきません。 ご教授願いただけますと幸いです。 ■テーブル名：A_mst ■カラム 名前： Name 誕生日： Birthday 都道府県コード： Prefecture_Cd 住所： Address ■テーブル名：B_mst ■カラム 都道府県コード： Prefecture_Cd 都道府県名： Prefecture_Name ■処理内容 パラメーターから取得した「名前、誕生日、都道府県、住所」をA_mstに登録する。 ※A_mstには都道府県列はないため、B_mstから都道府県コードを取得しなければなりません。 String sql = "INSERT INTO A_mst" +"SELECT Prefecture_Name FROM B_mst" +"WHERE Prefecture_Name = Prefecture_Name" +"(Name,Birthday,Prefecture_Cd,Address)" +"values('#1','#2','#3','#4')"; sql = sql.replaceAll("#1",strNname); sql = sql.replaceAll("#2",strBirthday); sql = sql.replaceAll("#3",strPname); sql = sql.replaceAll("#4",strAddress); バージョンは以下になります。 jdk1.6.0_16 Tomcat 6.0 MySQL Server 5.1 何卒よろしくお願いいたします。
MYSQL5.0.77で DBをつくり テーブル１のAフィールドのデータから テーブル２のAフィールドのデータ、 テーブル３のAフィールドのデータ、 テーブル３のAフィールドのデータ、 のいずれにも重複しないデータのみ 抽出したいと思っています。 どのようなSQL文を書けばよいでしょうか？ じぶんでいろいろ試しましたがどうしても出来ません。 どなたかご教授願います。
PHP+MySQLで 普通科A ---------------------- 普通学生番号 名前 住所 電話番号 得意科目1 得意科目2 平均点 進学希望1 進学希望2 普通科B ------------------------ 普通学生番号 名前 住所 電話番号 得意科目1 得意科目2 平均点 就職先1 就職先2 補習科 ---------------------------- 補修学生番号 名前 住所 電話番号 国語点数 数学点数 英語点数 物理点数 というような項目を追加、更新、削除、検索というwebアプリを作成したいんですが、テーブル構成はどのようにするのが一般的なんですか？ これは例なのでフィールド数は少ないですが、共通する部分がたくさんある場合、 table_1 普通科ABに共通するフィールド table_2 普通科Aの残り table_3 普通科Bの残り table_4 補習科のフィールド という風に分けたほうがいいんでしょうか？ 普通科A、普通科Bの登録フォームから INSERTする時など 「普通学生番号」の管理が大変そうなんですが。 技術が無い場合、普通科A、普通科B、補習科と ３つのテーブルにして全部入れて処理したほうがいいんですかね。
はじめて利用させていただきます。 知人から、ウェブサイトの移管をお願いされて引き受けたものの、 DBの知識が乏しく困っております。 お助けいただけますと幸いです。 既存のウェブサイトは、MySQLでDBを利用していたようで、 SQLのフォルダ内のデータを丸ごといただきました。 （.frmや.MYDや.MYIなどのファイルです） 「そのまま、移設先のフォルダ内に入れてもらえれば認識する」 といわれたのですが、 移設先のサーバが、Tsukaeru.netのVPSサーバなのです。 SQLのディレクトリが見当たりません。 何かしらの転送手法を利用するなどして実行することは、可能なのでしょうか？ FTPやウェブ上の管理画面上では、確認ができませんでした。 大変、恐縮なのですが、ご教授いただけますと幸いです。 上記サーバで困難な場合、別のサーバを用意しようと思っています。 SQLの問題がクリアできて、低価格で、オススメのサーバが ございましたら教えていただけますと幸いです。 よろしくお願いいたします。
ＳＱＬのＳＥＬＥＣＴ文について DB：MYSQL5.0 テーブルＡとテーブルＢを結合して テーブルＡの項目と一緒(横)にテーブルＢを抽出したいです。 どのようにすると実現できるのでしょうか？ よろしくお願いします。 Ａテーブル ID　ITEM1 １　11111 ２　22222 ３　33333 ４　44444 Ｂテーブル ITEM1　CNT　KBN 11111　１ 　　　1 11111　２　　　 2 11111　３ 　　　3 22222　４ 　　　2 22222　５ 　　　3 33333　６ 　　　3 出力結果 ITEM1　KBN1　KBN2　KBN3 11111　　１　　　２　　　３ 22222　　０　　　４　　　５ 33333　　０　　　０　　　６ 44444　　０　　　０　　　０
レンタルサーバ標準のデータベース(MySQL)が１つなのですが、 複数のサイト(CMS)を運営しようと思っています。 それ自体は可能である聞いたのですが、 注意点などがあれば教えて下さい。 見当違いかも知れませんが、「最初にこうしておいたほうがいいよ」とか、 「やめておいたほうがいい」などの アドバイスがありましたらお願いします。 バックアップがややこしかったりするのでしょうか？ （これまでにCMSを使った事がありますが、 バックアップがよく分からなく、やったことがありません…） データベースの容量は５００MBで、 両サイトとも比較的小規模のサイトになる予定です。 ちなみに、オプションでデータベースを増やすことは可能ですが、 知人の店のサイト(×２)を無料で作ってあげるので経費はかけられないのです。 (自分で更新できるようにCMSを選択しました) よろしくお願いします。
漠然としたタイトルで申し訳ありません。 PHPを使用して、フォームに入力された内容をデータベースに書き込もうと思っています。 書き込む内容としては、施設名や(施設名の)都道府県、住所、電話番号、メールアドレスなどです。 データベースを作る際に、上記の情報を一つのテーブルに全て書き込むべきではないのでしょうか？ 都道府県は重複する可能性はありますが、他のデータは重複する事は無いと思います。 運用やセキュリティの観点から見ると、テーブルの個数を増やしたほうが良いのでしょうか？ 無い知識で質問させて頂きました。 こんなキーワードで調べると良いよ、というご回答でも頂ければうれしいです。 よろしくお願いします。
PHPでINSERTしたものをphpMyadminで確認すると 日本語が文字化けしています。 コマンドプロンプトでテーブルを見てみると文字化けは起こっていません。どこを変えればいいのでしょうか？ いろんなサイトを参考にmy.iniを直してみてもだめでした。 ----- my.ini ------ [mysqld] default-character-set = utf8 skip-character-set-client-handshake character-set-server = utf8 collation-server = utf8_general_ci init-connect = SET NAMES utf8 skip-character-set-client-handshake [mysqldump] quick max_allowed_packet = 16M default-character-set = utf8 [mysql] no-auto-rehash # Remove the next comment character if you are not familiar with SQL #safe-updates default-character-set = utf8 ----- phpMyadmin ----- テーブルの照合順序 utf8_general_ci mysql> \s Server characterset: latin1 Db characterset: latin1 Client characterset: latin1 Conn. characterset: latin1 バージョンは以下のとおりです。 XAMPP 1.7.1 MySQL 5.1.33 PHP 5.2.9 phpMyadmin
MYSQLの検索について テーブルAAAのitemには半角の「0000」が入っています。 しかし、下記のＳＱＬを実行すると検索されます。 なぜ全角文字を半角として処理するのでしょうか？ 検索しないようにするには、どう対処すればよろしいのでしょうか？ テーブル構成 TABLE名：AAA id int(11); item　varchar(4) utf-8 -> '0000' ＳＱＬ文 SELECT * FROM AAA WHERE item = '００００'
以下の様な場合には、データベース上では 何の文字コードで登録されているのでしょうか？ (1)WEB画面上はEUCで入力 (2)(1)で入力した情報をMySQLに登録する。 　この際、MySQL環境では文字コードがujisで設定されている。
単純なことかもしれませんが、詰まってしまったので宜しくお願い致します。 ユーザ uid/user_name tanaka / 田中 / ikeda / 池田 / yamamoto / 山本 / 趣味 hid/ hno /uid 1 / 1 / tanaka 2 / 2 / tanaka 3 / 3 / tanaka 4 / 2 / ikeda 5 / 3 / ikeda 6 / 3 / yamamoto 趣味マスタ hno/hobby_name 1 / 野球 2 / サッカー 3 / テニス 上記のようなテーブル構成の場合に 趣味が「野球」だけのユーザの一覧を取得したいのですが 可能でしょうか？ 宜しければご教示願えれば幸いです。 宜しくお願い致します。
はじめまして。 フォームから複数の項目を受け取り、 値のある部分だけ（テキストが書かれてある項目のみ）登録する・・・ 値のない部分はそのままにしておく このような場合、クエリ文はどのように書いたらよろしいでしょうか。 よろしくお願いいたします。
宜しくお願いします。 DATA d_id/user_id/title 1 / aaa / 海 2 / bbb / 山 3 / ccc / 河 COMMENT c_id/d_id 1 / 2 2 / 3 3 / 3 上記２つのテーブル。 DATAはユーザーの掲示板です。 COMMENTはDATAにある掲示板へのコメントです。 DATAをSELECTしながらコメント数も同時にカウントしたい場合のSQL文をご教授して頂けないでしょうか。 上記データなら、海(0件)、山(1件)、河(2件)となります。
http://www.makizou.com/archives/1662 のデータを使って、経路列挙モデルのSQLで 以下のようなnameに親の名前から全ての名前を付けた結果を 出力したいのですが可能でしょうか？ +---------+----------------------------+-----------+ | node_id | name | path | +---------+----------------------------+-----------+ | 1 | Apple | .1. | | 10 | Apple/ソフトウェア | .1.10. | | 2 | Apple/コンピューター | .1.2. | | 3 | Apple/コンピューター/デスクトップPC | .1.2.3. | | 4 | Apple/コンピューター/デスクトップPC/タワー型 | .1.2.3.4. | | 5 | Apple/コンピューター/デスクトップPC/一体型 | .1.2.3.5. | | 6 | Apple/コンピューター/ラップトップPC | .1.2.6. | | 7 | Apple/コンピューター/ハンドヘルドPC | .1.2.7. | | 8 | Apple/デジタル音楽プレーヤー | .1.8. | | 9 | Apple/携帯電話 | .1.9. | +---------+----------------------------+-----------+
データベースのテーブルを作る際の正規化がわかりません。 テーブルを作る際に非正規化の状態で使うとどのような弊害があるのでしょうか？ 例えば、 物件ID, 物件種別（戸建・土地・マンション）, 新築・中古, メインコピー, 物件名称, 路線１, 駅名1, バス停まで1, バス停名1, 徒歩1, 路線２, 駅名2, バス停まで2, バス停名2, 徒歩2, 路線３, 駅名3, バス停まで3, バス停名3, 徒歩3, 郵便番号１, 郵便番号２, 都道府県, 市区町村, 番地, 番地表示・非表示切替, 建物名,物件価格１, 物件価格２, 物件価格３（税込・税抜）, 土地面積１, 土地面積２, 土地面積３（備考）, 建物面積1, 建物面積2, 建物面積3（備考）, 間取１, 間取２, 間取詳細, 販売戸数, 構造規模１, 構造規模２, 構造規模３, 構造規模４, 築年月, 建築確認番号, 建築条件, 用途地域, 地目, 現況, 建蔽率, 容積率, 土地権利, 都市計画, 管理費, 修繕積立金, 管理形態, 引渡日, 学区1, 学区2, 接道状況, 駐車場, 設備, 備考, 特記事項, 取引様態, 画像ファイル１, 画像１コピー, 画像ファイル２, 画像２コピー, 画像ファイル３, 画像３コピー, 画像ファイル４, 画像４コピー, 画像ファイル５, 画像５コピー, 担当, 以上のような項目を使って正規化をするならどのようにすればいいのでしょうか。 路線, 駅名, バス停まで, バス停名, 徒歩は第１正規化できると思うんですがそれ以上先に進めません。 このような質問の仕方で申し訳ありませんが、 この内容からでも答えていただける方、よろしくお願いいたします。
MySQLのTimestamp(14)型のフィールドに YYYY/MM/DD hh:mm形式のデータをインサートするには どのようにしたらよいのでしょうか？ ＭｙＳＱＬ　の Timestamp(14)型（YYYY-MM-DD hh:mm:ss）のフィールドに YYYY/MM/DD hh:mm　形式のデータ（ssに該当するデータがない）を インサートするには、 ＰＨＰでどのようにしたらよいのでしょうか？ できれば、インサートの際にssに自動的に00をつけたいです。 現在、ＰＨＰでinsert文を実行すると、データの桁数が足りないため、 フィールドの値は、0000-00-00 00:00:00になってしまいます。 同じ形式（YYYY/MM/DD hh:mm）のデータをphpMyAdminで インポートすると、自動的にssに00がつき、 YYYY-MM-DD hh:mm:ss（例　2009-10-20 12:10:00） となってくれます。 ＰＨＰでもphpMyAdminと同じ処理をしたいのですが、 インターネットで検索してもやり方が見つからず、 どのようにしたらよいのか、わかりません。。。 インサートするデータサイズが８３ＭＢと大きいので、 ＰＨＰで処理したいと思っています。 （phpMyAdminは８ＭＢまでなので） ご存知の方がいましたら、教えていただけると、 助かります。m(_ _)m レンタルサーバー：さくら インサートするファイル：ＣＳＶファイル PHP 5.2.x MySQL 5.1 phpMyAdmin 3.1.3.1
phpMyAdminのコントロールパネルの各選択部、入力部等の意味や目的（例：チェックボックスにチェックを入れるとどうなるのか）について詳しく解説されている資料、サイト等を教えて下さい。現時点では、データのバックアップ（エクスポート）を行なう場合でも、他のサイトのインストラクションを「なぜそうするのかもわからないまま」実行している状態です。 例えば、「エクスポート」タブからデータをエキスポートするような場合でも、「ファイルに保存する」項目の「ファイル名のテンプレート」入力欄の意味が分かりません（初期値では、[__DB__]となっています。）。 自分で書籍なども探しましたが、phpMyAdminの専門書などは見つけることができませんでした。
MySQL勉強中のものです。 初歩的な質問ですいませんが、 以下のような3つのテーブルがあります。 テーブルA（店名） A店 B店 C店 D店 テーブルB（販売品目） パソコン ビデオ 冷蔵庫 液晶テレビ デジカメ テーブルC（支払い方法） クレジットカード 銀行振り込み 代引き このデータから、テレビとビデオを販売していて かつクレジットカードに対応しているお店を検索したいと思うのですが、 どうもうまくいきません。 この場合、どのようにSQL文を組み立てればよいのでしょうか。 LEFT JOINで1つに結合すると、カラムごとにレコードが重複して GROUP BYでうまく絞り込めません。 そもそもテーブルの作り方を間違えているのでしょうか。 考え方のヒントだけでも結構ですのでよろしくお願いいたします。
PHPで、データベースから、条件にあうレコードだけを取り出そうとしています。 しかし、条件に合うレコードがあるはずなのに、 mysql_query()で条件を指定したSELECT文を渡して、mysql_num_rows()を出力すると0となってしまいます。 その条件とは、ある列の内容が、指定した文字列と完全に一致したら取り出すというものです。 データベースに情報を登録するときに、前後の空白は取り除いてあります。 また、文字コードは、HTML上部でutf-8に設定し、MySQLのクライアント側の文字コードも、mysql_set_charset()でutf-8に設定しています。 ファイルを保存するときの文字コードセットもutf-8にしてあります。 文字コードについては、あまりよく分からないのですが、それ以外の ところでの、文字コードの設定がutf-8以外になっているから、条件に合わない事になってしまうのでしょうか？ どなたか分かる方、回答をお願いします。
Mysql勉強中のものです。 どうしてもわからないことがあって、質問いたします。 ID　　　　販売品目 A店　　　1．パソコン A店　　　2．ビデオ A店　　　5．冷蔵庫 B店　　　1．パソコン B店　　　3．液晶テレビ C店　　　1．パソコン D店　　　2．ビデオ D店　　　4．デジカメ E店　　　1．パソコン E店　　　2．ビデオ F店　　　4．デジカメ F店　　　5．冷蔵庫 結合後、このようになるテーブルがあります。 ここからパソコンとビデオを販売する店舗（結果的にはA店とE店）に 絞り込むにはどのようなSQL文を書けばよいのでしょうか。 SQL文 　－結果－ A店 E店 半日以上悩んだのですが、どうしてもわかりません。 もしこれを解決できる方がいましたらぜひご教授ください。 面倒ならヒントだけでもかまいません。 どうぞよろしくお願いいたします。
さくらでMySQLを使いたいのですが、文字コードをUTF-8からSJISにしたいのです。 無知識で初め、検索やログを頼りにチャレンジしたのですがいまいち設定がわかりません。 my.cnfに [mysqld] default-character-set=sjis skip-character-set-client-handshake と、書けばいい、などの情報もあったのですが、そもそも「my.cnf」がどこに存在するのかすら分かりません。どなたか教えていただけませんでしょうか。 MySQL 5.1
いつもお世話になっています。 レンタルサーバー(サクラインターネット)で、 MySQL5.1を設定し、データベースを使ったwebサイトをアップしたのですが、 PHP部分の一部に文字化けしてしまいます。 文字コードは、htmlの上部で、UTF-8に設定しています。 システムは、PHPとMySQLで組んであります。 ローカルでは正常に動いているために、理由がわかりません。 どなたか解決方法があれば、教えて下さい。 宜しくお願いします。
データ自体ではなくてファイルのパスをデータベースで管理したほうが 楽なのですが、パフォーマンス的にどうなのでしょうか？ 別にちゃんとした商用サイトを作るわけではありません。 何十万件もの画像を扱うサイトでは画像ファイルをデータベースで管理しているのですか？
２つのテーブルに存在しているデータを参照し、 取得したデータの結果を３つ目のテーブルに保存する処理をしているのですが // USERのUNIQUEとGAMEのGAME_NOはプライマリーキー select RATE from USER where UNIQUE = xxx select POINT from GAME where GAME_NO = yyy insert into HISTORY set COIN = RATE * POINT 今は一つの保存に対して３つのSQL文を使わなければいけないのですが、 うまいことこの３つのSQL文を一つか二つにつなげるということは出来ないものでしょうか？
wordpressにアップした画像が一部表示されません。 ・バージョン/WordPress 2.8.4 ・サーバー/000webhost.com/ ・状況 　全部で5つの画像があり、2枚（jpg・gif）が表示されるが 　あと3枚（png・gif）が表示されない。 　画像のアドレスにアクセスすると500エラーになる。 　gifが表示されたりされていなかったりと拡張子によって 　表示の差があるわけでもないようだ。 　重さも一番重いjpgの画像が表示されていることから、 　関係ないのかと思われる。 　再度アップしてみたが変化は見られない。 wordpressをはじめてインストールし、右も左も分からず 困っています…どなたか、分かる方はいらっしゃいませんか？
id、氏名、年月日(date)、点数（tensu）の列を持つテーブルseiseki があります。 <?php $conn_id = mysql_connect("localhost","root","*****") or die('Error connecting to MySQL'); mysql_select_db('******',$conn_id); $query ="SELECT date,tensu from seiseki; $result = mysql_query($query,$conn_id) or die($query.'failed('.mysql_error().')'); $date = array(); $tensu = array(); while($row = mysql_fetch_array($result)){ $date[] = $row['date']; $tensu = $row['tensu']; } print_r($date); echo "<br/>\n";　　　　　　←１５行目 print_r($tensu); echo "<br/>\n";　　　　　　←１６行目 ?> これをブラウザで見ると、 Array ( [0] => 2009-05-01 [1] => 2009-06-07 [2] => 2009-07-24 ・・・・・・ ) Array ( [0] => 80 [1] => 75 [2] => 90 ・・・・・・・ ) となります。 15,16行目をコメントアウトして print_r($row[“date”],[“$tensu”]); とするとエラーになります。 array (array (2009-05-01, 80), array (2009-06-07, 75 ), array (2009-07-24 , 90)・・・・・・・ ); の形式でデータを取得するにはどのようにすれば良いでしょうか？
SQLで Ａテーブル、Ｂテーブルで構造自体まったく同じものですが データが一部違うものがあったとします。 select count(*) as cnt from A, B where A.fld <> B.fld とすると、A,Bテーブル共に異なるフィールドの個数を取得できますが Ａテーブルにはあって、Ｂテーブルにないものは除外して上の条件を満たすクエリはどのように書くのでしょうか？
いつもお世話になっております。 VB6.0でシステムを作成し、DBをMYSQL5.1(MYSQL Administrator1.2.17)を使用しています。 vb側で入力された日付『2009年10月09日（金)』を、MYSQLにDATE型でこのままの形『2009年10月09日（金)』で 保存したいのですが、どうすればDATE型に文字列を指定するすることができるのでしょうか？ 今現在、MYSQL Administrator1.2.17のColumn Name『date』のDatetype欄には、Date(Format ("yyyy年mm月dd日(aaa)")) と入力していますが、だめでした。 まだ勉強をはじめたばかりなので、的外れの質問でしたら、大変申し訳ございません。 大変恐縮ですが、ご教授いただければ幸いです。 よろしくお願いいたします。
カラム1が20バイト以上の場合は...を連結したいのですが下記のSQL文では ...が連結されません。 IF (LENGTH(カラム1)>20, CONCAT(LEFT(カラム1, 20),'...'), LEFT(カラム1, 20)) as comment 宜しくお願いします。
Unix/Linux環境において、ファイルシステムを模したデータベースを設計しています。テーブルは大まかに、ユーザ情報、ユーザグループ情報そしてファイル情報の3つとなり、ユーザとグループの権限に応じて、ファイルの検索が出来るように作っています。PHPを通じて、検索結果を出力します。 今回ご相談したいのは、ファイル情報のテーブルです。ディレクトリの情報とファイルの情報を同じテーブルに入れようか、別なテーブルに分けた方がいいのか、悩んでいます。 テーブルを分けない場合だと、ファイル情報を検索する際、テーブルからファイル情報だけ抽出したテーブルと、同じテーブルからディレクトリ情報だけ抽出したテーブルをSQL関数でつなぐクエリを使えばいいのかなと考えています。 テーブルを分ける場合だと、ファイル情報テーブルとディレクトリ情報テーブルをSQL関数でつなげばいいのかなと思います。 どちらの方が効率がよい＝ウェブサーバのリソースを抑えることができるのか、判断に苦しんでいます。相談に乗っていただけたら助かります。
PHPとMySQLでブログを改造しています。今作りたいのはブログの記事を投稿する度にPHPでMySQLにアクセスして文字列を呼び出すというものです。 [例] MySQLのテーブルのカラム1には連番の数字(1～）がはいっていて、カラム2には呼び出したい文字列がはいっています。ちなみに15件のデータがはいっているとします。それで記事を投稿するたびに上から順番に5件ずつ表示したいんです。それで一周したらまた最初からというのが希望です。 どうソースコードを書いていいのか解りません。解る方がいましたら、教えてください。お願いします。
以下のテーブルがあるとします table1 名前|住所コード|勤務地コード table2 コード|名称 テーブル1の検索結果にテーブル2の名称を引っ張ってきて取得したいのですがどうやるのでしょうか？ SELECT * from table1 INNER JOIN table1.住所コード ON table2.コード INNER JOIN table1.勤務地コード ON table2.コード これではうまくいきませんでした。 SELECT (select 名称 from table2 where table2.コード=table1.住所コード),(select 名称 from table2 where table2.コード=table1.勤務地コード) FROM table1 これは上手くいくのですが重いらしいので、、、
XAMPPでの設定でphpMyAdminの管理画面から特権をクリックすると以下のエラーが出ます。 エラー 実行した SQL: ( SELECT DISTINCT `User` , `Host` FROM `mysql`.`user` ) UNION ( SELECT DISTINCT `User` , `Host` FROM `mysql`.`db` ) UNION ( SELECT DISTINCT `User` , `Host` FROM `mysql`.`tables_priv` ) UNION ( SELECT DISTINCT `User` , `Host` FROM `mysql`.`columns_priv` ) UNION ( SELECT DISTINCT `User` , `Host` FROM `mysql`.`procs_priv` ) ORDER BY `User` ASC , `Host` ASC MySQLのメッセージ: #1017 - Can't find file: 'tables_priv' (errno: 2) このエラーはどこが悪いのでしょうか？ わかる方いましたらご回答お願いします。
insert into文で思ったような結果がでません。SQL文にお詳しい方、ご教授いただけますでしょうか？　SQLは初心者レベルです。 期待している結果： テーブルT-BBSにT-USRのusr-id全リストを入れて、T-BBSのa,b,cには固定の数値を入れたいと思っています。 テーブル例： テーブル名:T-BBS ,カラム：usr-id,a,b,c, テーブル名：T-USR, カラム:usr-id 結果 user-id | a | b | c 2 |1 | 2 | 3 3 |1 | 2 | 3 4 |1 | 2 | 3 7 |1 | 2 | 3 私が考えたSQL文ですが、 INSERT INTO T-BBS(SELECT user-id FROM T-USR,1,2,3) →×（文法エラー） INSERT INTO T-BBS(user-id,a,b,c) VALUES (SELECT user-id FROM T-USR,1,2,3)→× 文法エラー INSERT INTO T-BBS(user-id,a,b,c) VALUES ((SELECT user-id FROM T-USR),1,2,3)→×サブクエリが複数行を含んでいる ちなみにデータベースはH2 Databaseというものみたいですが、mySQLと方言は同じという認識をもってます。 以上宜しくお願いします。
MySQLのLOAD文を使ってCSVファイルの内容をデータベースにインポートしたいと思っています。 そこで、下記のような内容のCSVファイルを作成しました ファイル名：word_list1.csv ↓ファイルの内容↓ 1,apple 2,egg 3,music 4,movie 5,baseball 作成した word_list1.csv の保存場所は C:/hole_problem/word_list1.csv です また、word_list1.csv の内容をインポートするデータベース側のテーブルは下記のコマンドにより定義されています CREATE TABLE word_list( id INT AUTO_INCREMENT, name VARCHAR(50) NOT NULL, CONSTRAINT id_pri PRIMARY KEY (id) ) ENGINE=InnoDB; CSVファイル word_list1.csv とデータベース側のテーブル word_list の準備が整ったところで下記のコマンドを実行しました LOAD DATA LOCAL INFILE "C:/hole_problem/word_list1.csv" INTO TABLE word_list FIELDS TERMINATED BY ','; コマンドはエラーなどなく正常に実行されましたが、実行後にデータベースを参照すると下記のようになっています id name 2 egg 3 music 4 movie 5 baseball 35 apple ここで質問なのですが、なぜ、CSVファイルでの順番とインポート後のデータベースでの順番が異なってきてしまうのでしょうか？ 教えて頂けると助かります。 また、どのようにすれば順番が変わることなくCSVファイルの内容をデータベースにインポートできるのでしょうか？
こんばんわ。お世話になります。 PHPからSQLを発行してLIKE検索をしようとしているのですがうまくいきません。（Xampp MySQL） $keyword = htmlspecialchars($_POST['keyword']); mysql_real_escape_string($keyword); $sql = "select * from master where name like '%{$keyword}%'"; テーブル内の name にマッチするはずの言葉があるのにマッチしません。 ちなみに echo $sql; とSQL文を表示させてPhpMyAdminでそれを実行すると、目的の検索結果が表示されます。 いろいろ検索してみたところ、LikeをLike Binary にする方法などがありましたが、どうにもうまくいきませんでした。文字コードはフォーム側、PHP・SQLともにUTF-8です。 '%{$keyword}%'あたりの書き方が悪いのでしょうか。 お手数おかけいたしますがアドバイスの程お願いいたします。
いつもお世話になっております。 MySQLのカテゴリにて質問をさせて頂きますが、このことに意味はありません。 SQLにおける、INDEXの考え方を知ることができれば良いなと思っております。 SQLについては初心者ですので、分かりやすく教えて頂けると助かります。 では、本題へ。 ------------- あるデータテーブルの検索速度を上げる方法として、 INDEXを設定することもその１つに挙げられるかと思いますが、 あるテーブルにおける、ある列（フィールド）に対しINDEXを設定した場合、 検索時、それはどう利用されるのでしょうか、というのが質問です。 例えば、 会員データベース ・会員番号：id ・年齢：age ※その他、複数のフィールドを持つ、とする。 上記の会員データベースにおいて、 CREATE INDEX idx ON tbl_member(id); という風に、tbl_memberテーブルに対し、 会員番号（id）をINDEXに設定したとします、 idは唯一無二の（ユニークな）データです。 この会員テーブルにおいて、 年齢（age)フィールドをもとに、40歳以上の会員を抽出（検索）したい場合、 INDEX（idが設定されている）はこの検索において、 どういう仕組みで活かされることになるのでしょうか？ ageと無関係のidが、どう役に立つのか分からずにいる、ということです。 ネット上で色々調べたのですが、 あるフィールドをINDEXに設定した場合に、 それが検索時にどう活かされるのかについて説明されているページを 私は見つけることができませんでしたので、質問させて頂きました。 どうぞ、宜しくお願い致します。
phpMyAdminでEUC-JPが使えず、困っています。 環境は php 5 mysql 5 phpMyAdminは下記のバージョンをそれぞれ試しました。 phpMyAdmin-3.2.2-all-languages.zip phpMyAdmin-2.11.9.5-all-languages-utf-8-only.zip 解決策を探し下記の方法を試してみたのですが、 http://blog.kuruten.jp/php/79717 今度は下の通りエラーが出るようになりました。 「エラー 　設定ファイルが秘密のパスフレーズ (blowfish_secret) を 　必要とするようになりました 」 php,sqlはじめ開発環境をEUCで統一したいと思っているため、 何とかphpMyAdminでECU-JPを使いたいと思っています。 どなたか解決策のお分かりになる方がおりましたら、 ぜひご教授のほど、よろしくお願いします。
insert into dtb1 (id,col,name,rank,status) value (1,'image1','フォトギャラリー１',23,1); というように項目を追加しました。rankは２２番の下に入れたかったので２３番にしました。しかし既に２３番が入ってましたから ２３番が２つになりましたが、問題ないんでしょうか？ rank もauto increment にすべきでしょうか？
MySQL 5.0.41で、2月29日をＤＡＴＥ型に入れようと、 "0000-2-29"と指定しましたが、これが入ってくれません。 ちなみに"0000-2-28"は入りました。 "2000-2-29"はＯＫ "1999-2-29"はだめ 西暦が分からない場合に、 どう格納すればよいのでしょう？？
こんにちは、 Mysqlで、例えば"023"という数字をデータベースへinsertした場合、 先頭の"0"が省略されてしまい、"23"となって格納されてしまいます。 データ型はint、textを試しましたが結果は同じでした。 検索してもいまいちこれといった情報が見つからず、 教えていただきたいと思っています。 簡単ではありますが、どうかよろしくお願いします。 環境：windowsOS 　　　xampp 1.7.1 php5を使ってMysqlを操作しております。
こんにちは 連絡をOKの曜日を1、NGを0として0,0,0,0,0,0,0～1,1,1,1,1,1,1 の間の文字列を格納し、WHEREで利用しようと思っていたのですが これはもしや微妙なのでは…と思ってちょっと相談に参りました 最初に考えていたのが、データ抽出を行う日の曜日をdate("w",time()); で取得し、値に対応するn番目のデータが1の場合のみHITという感じで 日,月,火,水,木,金,土の順番にデータを保持させています （カンマ区切りでtext型になっています） ※連絡をしても良い曜日は複数でも可で、たとえば 月水金なら 0,1,0,1,0,1,0,0というデータになります でも良く考えたら、このデータは抽出後にexplodeしないと比較データ としては利用出来ない？と気づいて、SQL文の実行段階でデータを利用 する、いい方法は無いのかなーと思って調べてはいるのですが、どうも 良い検索キーワードが思いつかず足踏み状態です。。。 やりたいことは、月～日の曜日の間で連絡をしても良い曜日を判別して 検索した日の曜日と一致する場合に抽出を行うということです 質問内容をまとめますと 1.データ保持の方法が妥当なのかどうか 2.妥当な場合、比較の処理はSQLで出来るのか PHPで行うのか 3.SQLで出来る場合、関数のヒント 処理イメージをうまく説明出来ず伝わりにくい質問かと思いますので 補足が必要でしたらガンガン要求お願いします 構成や型の変更も何でもOKなので、こういう方法が応用きくよ、など 考え方のアドバイスも頂けると幸いです MySQL クライアントのバージョン: 5.0.45/PHP Version 5.2.6 です。
同じような質問は過去に沢山あり、一通り確認しましたが、解決できないため、質問させてください。 ポート3306へつながらず、MySQLへリモートから接続することができません。 確認した点は、 ・mySQLにリモートからアクセスできるユーザを作成してあること ・my.cnfにbind-addressの記載はない。 （そもそも3306に繋がらないのでここは関係ないと思いますが） ・nmap localhost で「3306/tcp open mysql」となっていること。 ・netstat -anで tcp 0 0 0.0.0.0:3306 0.0.0.0:* LISTEN と表示されること。 ・iptablesでINPUTがACCEPTになっている。 3306へアクセスできない確認は ・http://www.cman.jp/network/support/port.html ・ローカルのコマンドプロンプトで telnet IPアドレス 3306 の2通りで確認しました。 サーバ：Linux　恐らくCentOS5だとだと思いますが、現在サーバ会社に確認中。MySQL 5です。 クライアント：WinXP Pro 恐らく3306の開放ができていないのだと思いますが、他に何を確認すればよいのか判らず。。。 アドバイスいただけると助かります。
mysql5です。 テーブル名pref(都道府県) id,name 1,北海道 2,青森県 3,秋田県 ・・・ テーブル名user(会員) id,pref_flg,addr01,addr02 1,1,市町村,それいかの住所 2,2,市町村,それいかの住所 3,3,市町村,それいかの住所 ・・・ 上記のようなテーブルであるとした場合userをselectしデータを取得します。 SELECT id, CONCAT(pref_flg, addr01, addr02) AS addr FROM user WHERE id = ? この結果addrには『1(※都道府県id)市町村それいかの住所』で取得できるのですが 一度のsqlで都道府県名も取得するにはどうすればできますか？ 具体的には 『1(都道府県id)市町村それいかの住所』 を 『都道府県名市町村それいかの住所』 としてidではなく名称で取得したいです。 単純にuserに都道府県名を入れればできるのですが上記のように複数のテーブルで管理する場合の 方法を教えてください。
Windows環境でお手軽Apache+PHP+MySQLがインストールできる WAMPServer2.0をインストールして使ってみたのですが、MySQLのテーブルのエンジンタイプが InnoDBを指定できない（エラーになります）。 私はMySQLは当然InnoDBが使えると思っていたのですが、WAMPでは無理なのでしょうか？ http://www.forest.impress.co.jp/article/2008/12/ …
度々お世話になっています。 Mysqlのテーブル結合したいと思ってます。 テーブル構成は以下のとおりですのでご参照ください。 ■テーブルA id | name 1 | bind 2 | samba 3 | apache ■テーブルB id | detail 3 | test 3 | test 1 | test ■結合結果 id | count 1 | 1 2 | 0 3 | 2 テーブルA,Bはidコラムで紐づいています。 この際、テーブルBのidごとにレコード数を出力したいのですが、 どういったSQLを流せば良いでしょうか。 ご教示願います。
テーブル'個人' 個人コード、履歴、名前 1 , 1 , 山田 1 , 2 , 木下 2 , 1 , 大木 3 , 1 , 佐田 3 , 2 , 山下 テーブル'会費' 個人コード、日付、 金額 1 , 2009/09/01 , 1000 2 , 2009/09/03 , 2000 3 , 2009/09/04 , 1000 3 , 2009/09/05 , 1000 上記のテーブル2個があります、個人テーブルの履歴は結婚などで名前が変わった方なのですが、最終履歴の名前を出したいのですがうまくいきません、結果は以下のようにしたいのですが、どなたか御教授くださいませ、宜しく御願いします 個人コード、名前、日付、 金額 1 , 木下 , 2009/09/01 , 1000 2 , 大木 , 2009/09/03 , 2000 3　 , 山下 , 2009/09/04 , 1000 3 , 山下 , 2009/09/05 , 1000
phpmyadminでテーブルのエンジンをMyIsamからInnoDBに変えたいのですがどうすればよいでしょうか？
Warning: mysql_num_rows(): supplied argument is not a valid MySQL result resource in XXXXXXXXXXXXXXXXXXXXXXXXXXXXX 表示されるので、phpmyadmin でチェックすると下記のようにでました。 -------------------------------------------------------------- あなたのSQLクエリーにエラーがあります。MySQLサーバーは以下のようにエラーを出します。そこには問題を解決する手助けがあるでしょう。 ERROR: 引用符が閉じていない @ 447 STR: " SQL: select KOKYAKU_T.ID_C,URGENT_C,STAFF_C,DEP_C,NAME1_C,DEST_C,TOUR_CODE_C,NOTICE_C, GET1_HOW_C,GET1_YOTEIBI_C,GET1_DATE_C,GET1_AMOUNT_C,GETGET1_AMOUNT_C, GET2_HOW_C,GET2_YOTEIBI_C,GET2_DATE_C,GET2_AMOUNT_C,GETGET2_AMOUNT_C, GET3_HOW_C,GET3_YOTEIBI_C,GET3_DATE_C,GET3_AMOUNT_C,GETGET3_AMOUNT_C, GA_C,GADATE_C from KOKYAKU_T inner join KEIRI_T on KOKYAKU_T.ID_C = KEIRI_T.ID_C where KOKYAKU_T.DEL_C = 3 order by KOKYAKU_T.REGI_C desc limit ".$tmp.",".($limit+1) 実行されたSQLクエリー : select KOKYAKU_T.ID_C,URGENT_C,STAFF_C,DEP_C,NAME1_C,DEST_C,TOUR_CODE_C,NOTICE_C, GET1_HOW_C,GET1_YOTEIBI_C,GET1_DATE_C,GET1_AMOUNT_C,GETGET1_AMOUNT_C, GET2_HOW_C,GET2_YOTEIBI_C,GET2_DATE_C,GET2_AMOUNT_C,GETGET2_AMOUNT_C, GET3_HOW_C,GET3_YOTEIBI_C,GET3_DATE_C,GET3_AMOUNT_C,GETGET3_AMOUNT_C, GA_C,GADATE_C from KOKYAKU_T inner join KEIRI_T on KOKYAKU_T.ID_C = KEIRI_T.ID_C where KOKYAKU_T.DEL_C = 3 order by KOKYAKU_T.REGI_C desc limit ".$tmp.",".($limit+1) MySQLのメッセージ --> #1064 - You have an error in your SQL syntax. Check the manual that corresponds to your MySQL server version for the right ---------------------------------------------------------------- 引用符が閉じていないとはどこのことかわかりません。 実際のphpは下記の行です。 $sql= "select KOKYAKU_T.ID_C,URGENT_C,----同じ----- limit ".$tmp.",".($limit+1); 是非ご教授ねがいます。
今MySQLの勉強をしているのですが、LIKEを使ったあいまい検索を行うと以下のエラーが吐き出されます。 以下のクエリを実行しました select * from tb where like 'A101'; 【Common SQL Enviromentの場合】 MySQL][ODBC 3.51 Driver][mysqld-5.1.33-community]You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'like 'A101'' at line 1 SQLステータス：37000 【SQLモニタの場合】 ERROR1064（42000） DOSプロンプトなので、コピーできました。すみません。 MySQLユーザー会などで調べてみたのですが、よくわかりませんでした。 SQLステータス：37000でググるとODBCドライバの入れなおしで解消するようなのですが、私の使っているODBCドライバのバージョンは3.51なので問題はないかと思います。 根拠は、多くの方がこのトラブルで3.51を入れなおしているからです。 どなたか、このトラブルの解決法を知っている方がいらっしゃったらご教授ください。
サーバー移転につき、データベースのデータも移動させなければなりませんが、よくMySQL4 → MySQL5 へのデータ移行時に文字化けが発生するとのことですが、これを回避して、スムーズに移行させるには、どうすればいいのでしょうか？ いろいろ自分で調べたのですが、PLESKのデータベース管理ツールから、 エクスポート→インポートでしょうか？ あと、PHPも、PHP4.3からPHP5になるのですが、これは今のPHPスクリプトに何か問題がありますか？ PLESK（7.9？→8.7）同市なら、バージョンが異なっても、スムーズにデータ移動可能なのでしょうか？
Windows環境でMySQL5.1.36のデータベースを使っています。 phpMyAdminで見るとストレージエンジンの種類が６つあります。 1) MEMORY 2) MyISAM 3) BLACKHOLE 4) MRG_MyISAM 5) CSV 6) ARCHIVE 私はInnoDBを良く使うのですがphpMyAdminではどのように設定するのでしょうか？ InnoDBもMySQLのパラメータでバッファを増やすと、MEMORYエンジンと同じように 高速でINSERTのSQLが実行できます。 それを考えると、InnoDBだけ１個エンジンあれば良いと思ってしまうのですが、 なぜphpmyAdminでは６つのストレージエンジンがあるのでしょうか？ それぞれの存在意義が知りたいです。
条件付のDELETEをするときのSQL文ができません。 同じデータのあるテーブル(別テーブル)から データを削除したいのですが、上手くできません。 DELETE tbl_A.* FROM tbl_A INNER JOIN tbl_B ON tbl_A.field01 = tbl_B.field01"; このように書いたのですが、全てのデータが削除されてしまいます。 tbl_Bとtbl_Aにある共通するデータのみをtbl_Aから削除したいのですがどのように書けばよいのでしょうか？ よろしくお願いします。
MySQLを勉強中です。 バージョン：5.x(詳しくはわかりません) エンジン：InnoDB インデックスを指定したカラムに対してLIKE演算"%検索文字%"を実行するとシーケンシャルに検索を行うと聞きましたが、何か回避する方法等はありませんでしょうか？ ※インデックスを指定したカラムの型はchar(255)で、日本語(UTF-8)も含まれます。
mysqlのCSV出力について意見下さい。 mysqlからコマンドで50000万行のURLをCSV出力させるとすぐに出力されますが、ブラウザからダウンロードすると10分近くかかります。ブラウザのダウンロードは遅いものでしょうか？最悪シェルをキックして起動しようとしてます。
おせわになりますっ！ WHERE k like '%$serch%' or b like '%$serch%' AND cate='$cate' これなんですけどぉ・・・。 k と b　カラムより 検索されたキーワード「$serch」に当てはまりかつカテゴリが「$cate」のものをを抽出すると言ったごく単純な事なんですけどぉ・・・。 $cate　に悩まされておりますなのです。 $cate =　「日記」なのですけどこの状態の場合、日記ではない　'%$serch%'　に当てはまるものまで抽出されてしまうのです。 AND と　or　の位置によるものですか。 または句の間違いですか。 　困ってます←
10万件程度レコードをもつ2つのテーブルに対し、下記のようなSQL文を実行します。 （実際のSQL文とは違いますが、だいたいこんな感じです。） SELECT * FROM aaa JOIN bbb USING(key) WHERE ORDER BY ccc LIMIT 50 OFFSET 5000 すると、 CGIから実行→CPU使用率が一時的に60％を超える。1～2秒待たされる。 phpMyAdminから同じSQL文を実行→CPUほどんど消費せず。瞬時に終わる。 のようにCGIからとphpMyAdminからで速度に大きな違いがあります。 こんなに差が付いてしまう理由がわかりましたら教えていただきたく。
お世話になります。 特定の項目に全角文字（＝半角以外のもの全て）が含まれている行を取得、といったことをSQLで行えないでしょうか。 REGEDITを利用した正規表現などで実現できないかと考えているのですが、何を書けばよいのかまったく不明な状態です。 ご存知の方がいらっしゃいましたら、ぜひ教えて下さい。 よろしくお願い致します。 ■環境 MySQL：5.0 文字コード：utf8 OS：LinuxおよびWindows（開発用） ■例 [TABLE_A] id| COL_A | COL_B | --+--------+-------+ 1 | あいう | hoge | 2 | カキク | hoge | 3 | foo | hoge | --+--------+-------+ 【欲しい結果とSQLイメージ】 SELECT * FROM TABLE_A WHERE COL_A ほにゃらら 1|あいう|hoge 2|カキク|hoge
リスト化した文字列が含まれているレコードをグループ化し、 件数を表示したいのですが・・ select nayose,count(*) from test where name like '%田%' だと、田が含まれる件数しか取得できず・・ 例えば、以下のようなnayose_listテーブルがあった場合、 nayose_listの漢字を含む件数を取得できないでしょうか？ nayose_list 田 人 一
mySQL(phpMyadmin)を利用しています。 1つのサイト上に2つのショッピングカート(osCommerce)を公開したいです。 http://www.■■■.com/cgi/shop/ http://www.■■■.com/cgi/shop2/ このときのデータベースの扱いがよくわかりません。 1つのデータベース・2人のユーザーだと無理なような気がするのですが、複数のデータベース・それぞれにユーザー設定だと問題ないでしょうか? 専用サーバを利用しているので複数のデータベースを作ることは可能なようです。
下記のようなテーブルがあるとします。 [table_a] type,name1,name2 ---------------- 1,sato,keiko 2,ito,yoko 2,kishi,hruna 3,yasuda,fumi 上記テーブルに対して下のSQL文を発行すると SELECT type, CONCAT( name1,name2 ) FROM table_a 実行結果 type,CONCAT( name1,'-',name2 ) ------------------------------ 1,sato-keiko 2,ito-yoko 2,kishi-hruna 3,yasuda-fumi 上記のような実行結果が得られるかと思います。 ですが、typeの値が重複したときに一行で出力したい場合は どのようなSQL文を発行するのが良いのでしょうか？ 得たい実行結果は下記となります。 実行結果 type,(連結された値) ------------------------------ 1,sato-keiko 2,ito-yoko　kishi-hruna　　　　←typeの値が同じだったので一行に 3,yasuda-fumi 色々試してはみたのですが、なかなか解決できずにいます。 もしよろしければ、お力添えお願いします。
MySQL5&php5&Apache2.2(OS:XP) で、MyODBC-3.51のドライバを使い、ACCCESS2003からテーブルのリンクを貼っています。 phpMyAdminでは、綺麗に日本語で表示されるのですが、 テーブルのリンクを貼ったACCCESS2003からは「韦겜臣肨ꫨ」のような 幽霊文字で表示されます。 MyODBCのConection Optionで「Charactor Set」で sjisでもutf8でも同じです。 どなたかお分かりの方、教えてください。
このような検索は出来ますでしょうか？ PHP 5.1.6 Mysql5.0.45 で運用しています。 テーブルにemailのフィールドがあります。 名前<***@*******.com> と言う文字列のメールアドレスが テーブルのemailフィールドに有れば、その列をselect したいのです。 宜しくお願いいたします。
ブログみたいな物ですか？？ それとも別な、、、何か？
現在strutsを使用した「検索フォーム」を作成しています。 検索項目は６つあり、それぞれNOT NULLの項目と、NULL可の項目が あります。 全部NOT NULLですと、WHERE句で 「WHERE　項目A　=　'%？%'」 を条件にすればよいと思うのですが、NULL可の場合は 「WHERE　項目B = '%？%' OR 項目 IS NULL 」 となると思います。 しかしこれですと項目Bに検索条件で入力したものと NULL値のものが両方ヒットしてしまいます・・・ うまく文章がまとまらなくてとても恐縮ですが、 うまく構文を作る方法はないでしょうか・・・。 よろしくお願いします。
下記のように空白除去、ソート、重複行削除を行いたいのですが、 なかなかうまくいきません。どなたか力を貸して下さい。 ----------------- name　　　　|　laptime ----------------- 山田太郎　　|　50 鈴木　花子　|　20 山田　太郎　　|　10 齊藤　二郎　｜　60 山田 太郎　 ｜　30 ------------------ ↓ ----------------- name　　　　|　laptime ----------------- 山田太郎　　|　10 鈴木花子　|　20 齊藤二郎　｜　60 ------------------ * laptime が小さい順 * nameの空白除去 * 空白除去後のnameの重複行削除（laptimeが一番小さいものを残す） 下記のようにSQL文を作って発行してみたのですが、 SELECT DISTINCT replace( replace( trim( name ) , '　', '' ) , ' ', '' ) AS name_a, laptime FROM tyouhuku ORDER BY laptime ASC ----------------- name_a　　|　laptime ----------------- 山田太郎　|　10 鈴木花子　|　20 山田太郎　｜　30 山田太郎　|　50 齊藤二郎　｜　60 ------------------ と、空白削除とlaptimeソートまで出来てるのですが、重複行削除ができませんでした。 どなたかご助言、宜しくお願いします！
linkテーブルとcommentテーブルがあります。 下記のようなSQLをPHPから発行すると、 select c.id AS cid, c.pid AS cpid, c.name AS cname, l.id AS id, l.url AS url from comment AS c LEFT JOIN link AS l ON c.pid=l.id order by c.id desc LIMIT 0, 10; $rec['cid'] や $rec['cname'] にはデータがあるのですが $rec['id'] や $rec['url'] にはデータが入っておらずNULLになってしまいます。 ためしに LEFT JOINの左右を下記のように入れ替えみたところ、 select c.id AS cid, c.pid AS cpid, c.name AS cname, l.id AS id, l.url AS url from link AS l JOIN comment AS c LEFT ON c.pid=l.id order by c.id desc LIMIT 0, 10; 今度は $rec['id'] や $rec['url'] にはデータがあるのですが $rec['cid'] や $rec['cname'] にはデータが入っておらずNULLになってしまいました。 どこがおかしいのでしょうか？ MYSQLは5.1.22-rcでレンタルサーバーはcoreserverを利用しています。
データベースに mySQLとFilemaker serverを使う場合の長所・短所を ご存じの方いらっしゃいませんか～？ [内容] 20万件のデータを様々な検索条件で抽出するシステムを作りたいです。 データはExcel又はFilemakerで管理されています。 検索画面は独自に作成します。 [Filemaker server] Filemaker serverでデータベースを 運用すればデータの管理が容易だと思うのですが、 高価です。 [mySQL] レンタルサーバーのmySQLに データのCSVを転送すれば、 検索システムを作れそうな気がします。 そして安い！！ Filemaker serverにはmySQLと違うメリットがあるのでしょうか？
現在、 開発言語「VBA」 データベース「Mysql」 で開発をおこなっています。SQL構文を実行する際、エスケープ文字が入力された場合、致命的エラーが発生してしまいます。 INSERT INTO T_Test VALUES ( '\','\','\','100','2009/09/02 16:03:26') この場合回避策はどのようにおこなうのがいいでしょうか？ 複数画面でSQL文を実行しているところがあるので一番手間のかからない修正方法はないでしょうか？？ VALUESでセットしている値は画面のテキストから入力された値などです。 よろしくお願いします。
社内のFAQシステムを作成しようとしています。 そこで候補のひとつとしてXOOPSというCMSを利用した 「plzxoo」というサービスを利用してみようと検討中なのですが、 このplzxooは社内で運用する目的で利用した時に、料金を払って利用しなければならないのでしょうか。よろしくお願いします。
表題の件について質問させていただきます。 現在、下記のようなテーブルが存在しています。 順位　勝　　負　　勝率 rank　win　lose　　gb 　　　　 3　　 1　　 0.750 　　　 　2 　　1 　　0.667 　　　 　1 　　1 　　0.500 このようなテーブルに対し、php側で順位を勝率順で入力しようとする際、 どのようなsqlを書けば宜しいでしょうか？ なにとぞよろしくお願いいたします。
野球の成績をmysqlで作成しています。 そこで、打率のdb定義を下記のようにしました。 dasu（int） hit （int） average (decimal(4,3)) すると、たとえば、3打数1安打でaverageを　hit/dasuで入力すると、 averageが「0.333」 で入力されます。 しかし、希望は前ゼロを削り、「.333」としたいのです。 この場合、前ゼロを削るにはどうすれば宜しいでしょうか？ 何卒ご教授宜しくお願いいたします。
表題の件について質問させていただきます。 mysqlでカンマつきのＣＳＶファイルからデータをテーブルにインポートする際、 load data infile 'ファイルディレクトリ情報' update table テーブル名 fields terminated by ','; でインポート可能かと思います。 では、このファイルをインポートしたあとに、ＣＳＶのデータを変更して同じコマンドを使用すると、レコードが追加され、「更新」にはなりません。 ファイルからのレコード更新はどのようにすれば宜しいでしょうか？ 例として下記のＤＢ定義、インポートファイルを使用しています。 データベース定義 bang（INT） name（VARCHAR(10)） ten (INT) インポートファイル変更前 1,山本,85 2,木村,58 3,山崎,95 インポートファイル変更後 1,山本,85 2,木村,58 3,今田,95　　　　　　←name変更 何卒よろしくお願いします。
こんにちわ！ お世話になります。 例えばなんですけど、$time を抽出したとします。 $time＝2009-05-01 15:02 の様になっております。 2009-05-01 15:02　→　2009年05月01日 15時02分 の様に「-」「:」を省くにはどのような事をしなければならないでしょうか！ $time = mb_ereg_replace("[-]+://[^<>[:]] = ""; みたいな感じですか！出来ませんトホホ・・・。 ご教授いただけませんか！
先程こちらで質問させていただきました。 http://oshiete1.goo.ne.jp/qa5243225.html ちょっとややこしくなってしまったので簡単な結合（inner join）の使い方等分かるサイトはありませんか。 宜しくお願い致します。
お世話になっております。 ちょっとややこしい質問になります。 「１」 Aと言うテーブルのAAと言うカラムから、$AAAと言うレコードを抽出致しました。ここまでは出来ました。（ここでの抽出結果を$CCCと致します。） 「２」 「１」の抽出結果（$CCC）を元に、Bと言うテーブルのBBと言うカラムから、BBBと言うレコードも抽出し結合したいと考えております。 一番の問題は、「１」で出た結果（CCC）を元に、抽出する事が出来ません。 「１」のソースのみ完成してます。 $rs=$DB->query("SELECT * FROM `A` WHERE AA = '$AAA' ↑の抽出結果＝$CCCを元に↓ $rs=$DB->query("SELECT * FROM `B` WHERE BB = '$CCC' 結合させたいんです！！ セクションしているので結合できないとバラバラになってしまいます。。。。 ご教示お願い致します！ inner join を使うのは分かるのですが・・・進めません。（泣）
こんにちは。 MYSQLver5 PHPver5を使用しています。 例えば３つのテーブルを順番にINSERTするとき 途中でエラーが発生した時の対処をどのように するといいのか迷っています。 同様にDELETEする場合も同じです。 ロールバックの機能はあるのでしょうか？ 何か良い方法がありましたら教えてください。 よろしくお願いします。
各品物の価格変動の履歴と確定値を残す 下のようなテーブル(T_Rireki)があるとします。 |　HinBan　|　Junban　　|　Nedan　　|　Kakuteki　| ---------------------------------------- |　　　A　　　|　　　1　　　|　　　90　　　|　　　0　　　　| |　　　A　　　|　　　2　　　|　　　80　　　|　　　0　　　　| |　　　A　　　|　　　3　　　|　　　70　　　|　　　1　　　　| |　　　B　　　|　　　1　　　|　　　95　　　|　　　0　　　　| |　　　B　　　|　　　2　　　|　　　90　　　|　　　0　　　　| |　　　B　　　|　　　3　　　|　　　95　　　|　　　0　　　　| |　　　C　　　|　　　1　　　|　　　35　　　|　　　0　　　　| |　　　C　　　|　　　2　　　|　　　30　　　|　　　1　　　　| ここから、値段が確定していない( 列 Kakutei の値が 最終的に １ になっていない) 品番を探し（この場合は、B） それをテーブルから削除したいのです。 目的の行の抽出は、 Select * from T_Rireki as T1 Where (select Max(Kakuteki) from T_rireki where HinBan= T1.HinBan) = 0 もしくは、 Select HinBan , Max(Kakuteki) as M_Kakutei from T_Rireki group by Hinban Having M_Kakutei = 0 などによって、 |　HinBan　|　Nedan　| -------------------- |　　　B　　|　　　95　　| |　　　B　　|　　　90　　| |　　　B　　|　　　95　　| の目的の3行を得ることができますが、この3行を削除するためにDelete文に上記のSQLを含もうとするとエラーがでます。 例えば、 Delete from T_Rireki as T1 Where (select Max(Kakuteki) from T_rireki where HinBan= T1.HinBan) = 0 では、うまくいきません。 どのような文にすればいいか、わかる方、どうか教えていただけないでしょうか？
mysqlでテーブル作成したいのですが l_urlのtext型のuniqueは、どうやって作成したらいいのでしょうか？ 後、テーブル作成を実際すると結構つまずくので練習したいのですが 何かいい勉強方法はありますか？ /* リンクデータ用テーブル作成 CREATE TABLE linkdata ( id int NOT NULL auto_increment, l_url text NOT NULL unique, l_title varchar(100) NOT NULL default '', l_comment varchar(255) default NULL, l_date datetime default NULL, PRIMARY KEY (id) ); 実行結果： ERROR 1170 (42000): BLOB/TEXT column 'l_url' used in key specification without a key length mysql>
windowsXPにてphpmyadminのインストール及び初期設定を行っています。 http://andante0727.blog81.fc2.com/blog-entry-104 …のサイトを参考に作業しています。 初期設定のコマンドプロンプトを立ち上げ、 cdコマンドでphpMyAdminをインストールしたフォルダの中の「scripts」というフォルダに移動して、 mysql -u root -p < create_tables.sqlをコマンド入力し、 rootのパスワードの入力を求められるのですが、MySQLでインストール時に設定したrootのパスワードを入力するそうですが通りません。 なぜでしょうか。サイトの内容が間違っているのでしょうか？それとも私の方でどこかが間違っているのでしょうか？
このようなデータ構造で、それぞれデータが入っています。 ----------------- column1 | column2 ----------------- A | B B | A B | C C | D ----------------- column1のAを検索し、AがBとお互いにデータが入っているのを確認するSQLはどのような形になりますか。
Mysqlの特殊文字　`　は何と読むのですか？ ’シングルクォート ”ダブルクォート などありますが、 `　これは何と読むのですか？
windowsXPにてphpMyAdmin をインストールしています。 phpMyAdmin-2.11.9.5-all-languages.zipをダウンロードし、http://www.db.is.kyushu-u.ac.jp/rinkou/mysql/php …のサイトを参考にインストールしているのですが、http://localhost/phpmyadmin にアクセスしても「phpMyhAdmin へようこそ」という画面が出ないのです。 変わりにIndex of /phpmyadminというタイトルで、色々なリンクが一覧で出ている画面が出ます。 どうすれば、「phpMyhAdmin へようこそ」という画面が出せるのでしょうか？ MySQL のインストール、Apacheインストール、PHP のインストールは終えています。 どなたか教えてください。宜しくお願いします！
最新バージョンのphpMyAdminのインストール方法が載っているサイトを探していますが見つかりません。 過去のバージョンのものはたくさんあるのですが、最新バージョン（phpMyAdmin-3.2.1-all-languages.zip）は過去のやり方では出来ないようです。 どなたかご存知の方いらっしゃいましたら教えてください。 宜しくお願いいたします。 2009年8月21日現在
初めてMySQLのインストールをしています。しかし手順の最後でトラブルが発生し、解決できません。 環境はwindowsXPです。 以下のサイトを参考にインストールをしていたのですが、インストール最後の手順、このページで言うと以下のページの最後で、四つの丸にチェックがつけば終わるのですが、「Start service」の箇所でエラー「×」となりインストールが完成できません。 参考：http://www.dbonline.jp/mysqlinstall/install/inde … 様々な解決方法、ウイルスソフトの解除、ファイヤーウォールの設定変更など試しましたが駄目でした。SQLiteが入っているのでそれが原因なんでしょうか？どうすればよいのでしょうか、教えてください。 宜しくお願いします！
当然MySQLなどインストールされていない、winから コマンドプロンプトを使って　リモートのMySQLサーバーに接続するには、どうしたらいいですか？？可能ですか？ よろしくお願いします。
SQL文でテーブルを結合し、insertしたいと思っています。 例） テーブル名：tb1, カラム:A1,A2 テーブル名：tb2, カラム:B1(b1,b2,b3,,,,) テーブル名：tb3, カラム:C1(c1,c2,,,,,,) tb2とtb3を結合させてtb1へinsertしたいと思いますが、 tb2とtb3リレーションを組める要素がありませんし、データの型も違います。 |A1 | A2 __|____|_____ 1 |b1 |c1 _____________ 2 |b1 |c2 _____________ 3 |b2 |c1 _____________ 4 |b2 |c2 _____________ 上記のような結果を作ってtb1へINSERTしたいのですが、UNION結合を使えるのか どうかすらわかりません。ネットで調べたのですが、突破孔を見つけることができ ませんでした。 ちなみにACCESSで結合までの結果を得るのに、SELECT B1.tb2,C1.tb3 from tb2,tb3 という文で出せましたが,mySQLではダメでした。 どなたかご教授おねがいできますでしょうか？
win上のMySQL Administratorというソフトでも 同じことはできるんですが、 それだとdump時の文字コードの指定ができません。 「--default-character-set=binary 」などのオプションを加えて コマンドで実行するといいらしいのですが、 ネットワーク越しのローカルマシン上のファイルに出力するには、パスをどう指定したらいいのかわかりません。 また、普段ＧＵＩのソフトでMySQLサーバーをいじっているため、 win上から、どのソフト(コマンドプロンプトとかでできる？)を使って、まず、どう接続するのか？から分かりません。（普通のＳＱＬ文以外は、コマンドになれていません。） いろいろ調べたんですが、見当がつきません。 低レベルの質問かもしれませんが、よろしくお願いします。
以下の方法で、MySQL-4.0.24からMySQL-5.0.84にバージョンアップを考えています。 問題点、懸念点などを教えて頂ければと思います。 よろしくお願いいたします。 バージョンアップと言っても、稼動中の「4.0.24」を停止して、別ディレクトリにインストールした「5.0.84」を起動するといった感じです。 （「4.0.24」も「5.0.84」もソースからのインストールです） データの移行は、 mysql-4.0.24/var内のDBディレクトリを、mysql-5.0.84/var内に移すというようにしたいと思います。 （ダンプ・リストアの方法は、時間がかかり過ぎるので難しい）
MYSQL5.1を利用しております。 ソート条件で悪戦苦闘しておりまして、何を見てもわからなかったため質問させて頂きます。 ================================================= 【hogehogeテーブル】 ID　　start_time　　　　　　end_time 1　　　2009-8-18 11:00:00　　2009-8-18 16:00:00 2　　　2009-8-18 10:30:00　　2009-8-18 14:00:00 3　　　2009-8-18 09:00:00　　2009-8-18 18:00:00 4　　　2009-8-18 12:00:00　　2009-8-18 20:00:00 5　　　2009-8-18 13:00:00　　2009-8-18 20:00:00 ================================================= 【SQL文】 SELECT 　* FROM　hogehoge ( start_time <= NOW() AND end_time >= NOW() ) DESC, ( start_time > NOW() AND end_time >= NOW() ) DESC, ( start_time < NOW() AND end_time <= NOW() ) DESC; ================================================= DESCの1回目は今の時間がstart_time と end_time の間に入っている場合、 DESCの2回目は今の時間がstart_time と end_time よりも大きい時間の場合、 DESCの3回目は今の時間がstart_time と end_time よりも小さい時間の場合です。 修正したい点は、 DESCの1回目をしたときに、その後すぐ、DESCをしたものに対してのみstart_timeの大きい順(降順)に並べ替えたいのです。 イメージとしては下記のようなものでしょうか・・ ================================================= SELECT 　* FROM　hogehoge ( start_time <= NOW() AND end_time >= NOW() ) DESC, (上でDESCしたものに対してstart_timeの降順に並び替え), ( start_time > NOW() AND end_time >= NOW() ) DESC, ( start_time < NOW() AND end_time <= NOW() ) DESC; ================================================= 色々試してはみたのですが、文法のエラーが出現し、検索してみても本を読んでみても参考に出来るもの見つからず困り果てております。 どうか皆様のお力添えを宜しくお願い致します！
mysqlが設置されたサーバーにXoopsやMT、WordPress等二つ以上のブログ等ソフトをインストールしても平気でしょうか？ 初心者な質問でもうしわけありません、よろしくお願いいたします。
はじめまして。よろしくお願いします。 下記の場合、Using temporary; Using filesort を回避するには どうしたらよいでしょうか。 次の 2 つのテーブルがあります。 CREATE TABLE `test1` ( `f1` int(11) NOT NULL, `f2` int(11) NOT NULL, PRIMARY KEY (`f1`,`f2`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO `test1` VALUES ('1', '2'); INSERT INTO `test1` VALUES ('1', '3'); INSERT INTO `test1` VALUES ('1', '4'); INSERT INTO `test1` VALUES ('2', '1'); INSERT INTO `test1` VALUES ('2', '3'); CREATE TABLE `test2` ( `f1` int(11) NOT NULL, `f2` varchar(20) default NULL, `f3` varchar(20) default NULL, PRIMARY KEY (`f1`), KEY `ix_f2_f3` (`f2`,`f3`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO `test2` VALUES ('1', 'A', 'a'); INSERT INTO `test2` VALUES ('2', 'B', 'b'); INSERT INTO `test2` VALUES ('3', 'C', 'c'); INSERT INTO `test2` VALUES ('4', 'D', 'd'); 次の SELECT を実行すると Using temporary; Using filesort が 現れてしまいます。 explain select test2.f2, test2.f3 from test1, test2 where test1.f1 = 1 and test1.f2 = test2.f1 order by test2.f2, test2.f3; order by ... をなくすと問題ないのですが、ソートは必要です。 複数のキーに対してORDER BYを実行する場合 インデックスを使用できないとあるので ix_f2_f3 は使用されず Using filesort となるのはわかるのですが、 Using temporary となる理由と回避方法がわかりません。 ご教示よろしくおねがいいたします。
例えばあるテーブルに、名前と支払い金額と支払日が記録されているのとします。 Name | Kingaku | ShiharaiBi A | 300 | 2004/03/05 A | 150 | 2002/05/15 A | 270 | 2008/03/22 B | 220 | 2007/02/13 C | 440 | 2009/12/09 C | 370 | 2004/09/18 B | 110 | 2006/11/02 ここから、それぞれの人の最新の（もっとも遅い日付）の 支払い金額を求め、以下のような結果が得たい場合。。。 Name | Kingaku | ShiharaiBi A | 270 | 2008/03/22 B | 220 | 2007/02/13 C | 440 | 2009/12/09 もっとも効率のいい、シンプルなＳＱＬは どう書けばいいのでしょうか？ よろしくお願いします。
使ってるパソコンのサウンドカードとプロバイダ名がわかりませんどこで確認できますか？
ubuntu9.1でapache2、php5、MYSQLをそれぞれインストール、設定し、phpmyadominもインストールし、http://localhost/自己のＩＰアドレス/phpmyadmin/へアクセスしたのですが、ページが見つかりません… 何が問題なのかも分からない状態なので、回答しにくいと思いますが、何とぞよろしくお願いします。
お世話になっております。 XAMPP1.7.1のMYSQL5.1.33のsjis日本語化でトラブっています。 このサイトの質問番号3124108等や、 http://www.adminweb.jp/xampp/mysql/index4.html http://allabout.co.jp/internet/database/closeup/ … 等いくつかのサイトを見て設定したのですがうまくいきません。 my.iniの３５行付近に character-set-server = sjis #collation-server = latin1_general_ci skip-character-set-client-handshake 上記の設定でもだめでした。このバージョンでは言語の設定に関する項目はmy-example.iniに記されています。my-example.iniを修正してmy.iniにしたり、my.iniに上記項目を書き足したりしてみましたがダメでした。mysqlを再スタートし、ログインしstatusコマンドで状態を確認するとserver characterset:等以下がすべてsjisではなくlatin1表示です。ご教授よろしくお願いいたします。
初めまして、宜しくお願い致します。 現在ＰＨＰのサイトを作成しているのですが、 ＰＣサイトからの、顧客情報を記載し送信すると受取る事が出来るのですが、 携帯からでは、白紙で文字を受取る事が出来ません。 宜しければ、ご指導をお願い致します。 できましたら、サイトの確認をお願いします。 www.sumikomi.jp(PCサイト） www.sumikomi.info（携帯サイト） です。
MYSQLとPHPで書籍のデーターベースを構築中ですが、ページの分割表示をさせたくて、色々検索していたら「PEAR::Package::Pager を使わずphpでページング処理ができるpager()関数」というもをみつけました。 がっ！ 組み込み方が、わからない。 賢者の知恵を拝借できれば、幸いです。 ソースは、こちらのを利用させていただいております。 http://www.daito.ac.jp/~ikeuchi/webdb/webdb_3.html これに、下記のところにある関数を組み込みたいのですが http://ryouchi.seesaa.net/article/45846102.html よろしく、お願いします。
初めましてyamaneko_oと申します。 この度は、動物病院で顧客情報の管理をするシステムを開発しようと考えています。 そこで、皆さんのご意見を是非参考にさせてください。 【質問】 出来るだけお金をかけたくないので、MySQL 又はPostgreSQLを使用しようと思っております。（商用で） 皆様でしたら、どちらを使いますでしょうか？ 他にオススメのDBがあれば、是非ご教授ください。 自分でも調べていますが、少しでもまだまだ勉強不足で大変恐縮ですが、 よろしくお願いいたします。 最後までお読みいただきありがとうございました。
$result = mysql_query('SELECT * FROM hoge ORDER BY LPAD(NUMBER, 5, 0)') ; で並び替え（ソート）をすると 1 2 3 4 5 6 7 8 9 a 10 11 12 13 という結果で表示されます。 これを 1 2 3 4 5 6 7 8 9 10 11 12 13 a というように並び替えて表示させたいのですが…orz どのように構文を書けば宜しいのでしょうか?? いろいろ調べてみたのですが、それらしい内容のものが 見つからずに途方に暮れています。 どなたか御教授頂ければ幸いです。 宜しくお願い致します。
こんにちは。 HTMLの入力欄を一つだけ用意して、そこに入れる検索条件の項目は 名前か電話番号 のような状態で抽出を行った場合 データがHITしたときに、どっちの項目でHITしたデータかというのは わかるものでしょうか $moji = $_REQUEST[moji]; //検索条件 SELECT * FROM table WHERE name LIKE '%".$moji."%' OR tel = '".$moji."' のようなSQL文を実行した場合、$mojiが「やまだはなこ」（名前）だと したら「nameでHIT」ということがわかるものかどうか、知りたいです 調べるにも言葉が浮かばず、困難だったので知ってらっしゃる人が いるかもと思い、質問に参りました OR検索で特定がムリなら、条件を一つにしたSQL文を複数書いて実行 という方法しか無いでしょうか MySQL クライアントのバージョン: 5.0.45です
現在JSPとMySQLを使用してシステムを開発しています。 データをMYSQLから呼び出すとき、 多数のテーブルを結合しないと必要な情報すべてを 得ることができません。 そこでMySQLの方で結合したクエリを保存して、 保存したクエリをJSPで参照（呼び出す）形にしたいのです。 丁度Accessのクエリをフォームで使用するイメージです。 MySQLではクエリの保存ができるのでしょうか？ できるのであればその方法を教えてください。 探しても中々いい情報が見つからず、困っています。 どうぞよろしくお願いいたします。
MySQLは5.0を使っています。 1のフィールドに「11,28,33」と言うようにカンマ区切りのデータを保存しています。 下記ページと全くやりたいことが同じだったのですが、 http://q.hatena.ne.jp/1194079682 SELECT * FROM test_db WHERE user_id REGEXP　'^11$' にしても抽出してくれません。 フィールドを「11」のみにすると問題なく抽出してくれました。 カンマ区切りのデータから特定の数字を抽出するためには他になにが必要でしょうか。 フィールドがvarcharなのがいけないのでしょうか。
selectで拾ってきたデータをもとに、ループを使用してupdateを行いたいのですが、やり方がわかりません。 ※MySQLのみでの実行方法が知りたいです。 --updateの内容-- TA(セレクトしたテーブル) TB(アップデートしたいテーブル) TA.id と TB.id が同じ場合、TB.dataにTA.dataを入力したいです。 -- わかりにくくて申し訳ありませんが、方法などを教えていただけると助かります。よろしくお願いします。
MySQL5.0です。(＋VB.NET2003) テーブル名　m_holiday_fixation HOLIDAY_NAMEHOLIDAY_DATESTART_YEAREND_YEAR みどりの日0429　　　　　1989　　　　　2006 みどりの日0504　　　　　2007　　　　　(NULL) このデータは1989年～2006年の4月29日ならびに2007年以降の5月4日は みどりの日という意味です。 この時2004年4月29日の時にみどりの日が戻るようなSQLを考えています。 SELECT HOLIDAY_NAME from m_holiday_fixation where (？？) = '2004/04/29' START_YEAR　と END_YEAR でBetWeenできそうな気がしますがうまく考えれません。 ストアドプロシージャに置き換えてでもいいのでアドバイスをお願いします。
MySQLでデータベースを作成しています。テーブルを以下のように作成しました。 create table table_name ( 　　　　id MEDIUMINT NOT NULL AUTO_INCREMENT, 　　　　aaa text, 　　　　bbb text, 　　　　ccc text, 　　　　PRIMARY KEY (id) ); そして、以下のようなファイル（/root/file）を読み込みます。（尚、ファイルはLinux上で作成しました。） [/root/file] a1,b1,c1 a2,b2,c2 a3,b3,c3 そして、データベース上で以下のようなコマンドを実行しました。 load data local infile '/root/file' into table table_name fields terminated by ',' lines terminated by '\n'; すると、以下のような結果が得られます。 +----+-----+-----+------+ | id | aaa | bbb | ccc　| +----+-----+-----+------+ | a1 | b1　| c1　| NULL | | a2 | b2　| c2　| NULL | | a3 | b3　| c3　| NULL | +----+-----+-----+------+ 以下のようにテーブルを作り直すことなく、 create table table_name ( 　　　　aaa text, 　　　　bbb text, 　　　　ccc text, 　　　　id MEDIUMINT NOT NULL AUTO_INCREMENT, 　　　　PRIMARY KEY (id) ); また、以下のようにファイルを書くことなく、 [/root/file] ,a1,b1,c1 ,a2,b2,c2 ,a3,b3,c3 以下のような結果を出すにはどのようにすればよいのでしょうか。（つまり、自動的に作成される'id'を無視するにはどうすればよいのでしょうか。） +----+-----+-----+-----+ | id | aaa | bbb | ccc | +----+-----+-----+-----+ | 1　| a1　| b1　| c1　| | 2　| a2　| b2　| c2　| | 3　| a3　| b3　| c3　| +----+-----+-----+-----+ よろしくお願い致します。
XAMPP 1.7.1をダウンロードしてMySQL5.1.33をいじってるんですが defaultの文字コードをlatin1からutf8への変更がどうしてもできません。 \XAMPP\mysql\binにあるmy.iniに以下の記述をしました。 [client] default-character-set=utf8 [mysqld] default-character-set=utf8 skip-character-set-client-handshake [mysqldump] default-character-set=utf8 [mysql] default-character-set=utf8 ネットで調べると以上の方法で解決できるとなっていたんですが記述後、再起動してstatusをしてもServer characterset,Db characterset,Client characterset,Conn. charactersetすべてlatin1のままです。 どなたか解決できる方がいましたら是非ともご教授ねがいます。
Mysqlをインストールしてから、mt.cgi　をブラウザから実行すると下記のエラーがでて、movabletypeの管理画面に入れません。 原因がわからず困っております。何卒、知恵をお貸しください。 Got an error: Can't locate object method "install_properties" via package "MT::Tag" (perhaps you forgot to load "MT::Tag"?)
こんばんは。お世話になっております。 質問のタイトルが少し変かもしれませんが、2つのテーブルがあり、 1つはカテゴリ名登録用。１つはカテゴリ別詳細データといった感じのテーブルがあるのですが、データの集計をする際、コンテンツ毎に登録された数を表示させたいのですが、登録のないデータは表示できない状態となっています。 video_category（カテゴリ登録用テーブル） cate_id　　category_name 1　　　　　ハリーポッター 2　　　　　ポケモン 3　　　　　ドラえもん video（カテゴリ別詳細テーブル） no　　category　　title 1　　　1　　　　不死鳥の騎士団 　　 2　　　1　　　　賢者の石 ※categoryは上記テーブルのcate_idと紐づけている このようなデータの場合、 ハリーポッター（2） ポケモン（0） ドラえもん（0） としたいのですが、 $sql = "select SV.`no`, SV.`category`, SV.`title`, SV.`contents`, SV.`image`, VC.`cate_id`, VC.`category_name`, count(VC.`cate_id`) as `count` from `video_category` AS VC right join `video` AS SV on SV.`category` = VC.`cate_id` group by VC.`cate_id` order by VC.`cate_id`"; だと、0値のデータが反映されません。 お恥ずかしい質問かと思いますが、ご指摘いただけると幸いです。
データを間違って消してしまい、サーバーにデータを バックアップ復活したのですが、以下の様なエラーが生じており、 困っております。 MySQLのエラーを解消したいのですが？、知識がなく、どうすればいいのでしょうか？ ・1）Warning: mysql_connect() [function.mysql-connect]: Unknown MySQL Server Host '0net' (1) in /ファイルパス/ファイル.php on line 7 ・2）Warning: mysql_select_db() [function.mysql-select-db]: Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2) in /ファイルパス/ファイル.php on line 8 ・3）Warning: mysql_select_db() [function.mysql-select-db]: A link to the server could not be established in /ファイルパス/ファイル.php on line 8 ・4）Warning: mysql_query() [function.mysql-query]: Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2) in /ファイルパス/index.php on line 5 ・5） Warning: mysql_query() [function.mysql-query]: A link to the server could not be established in /ファイルパス/index.php on line 5 ・6） Warning: mysql_query() [function.mysql-query]: Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2) in /アフィルパス/index.php on line 6 ・7） Warning: mysql_query() [function.mysql-query]: A link to the server could not be established in /ファイルパス/index.php on line 6
IIS5.1 MySQL 5.0.24a PHP 5.2.2 phpMyAdmin 3.0.0 文字コードを全てUTF8に統一したよる簡単な会員管理DBの作り方を勉強しています。 このページを参考に、http://www.tryhp.net/ODBCMySQL.htm ODBCドライバ（mysql-connector-odbc-3.51.27-win32.msi）をインストールし、 MS Access 2003で開いたところ、テーブルへのリンクはうまくいくのですが 日本語部分が文字化けしてしまいます。 テーブルをExcelに落としてリンクさせれば化けないのですけど、何か設定ミスを してますでしょうか。 コントロールパネル→管理ツール→データソース（ODBC）→システムDSNタブ →構成ボタン→Connect Optionsタブ→Chatacter Setは、UTF8にしてあります。
レンタルサーバーで、MySQLを設置しています。 my.iniファイルもサーバーの見えない場所に設置してあります。 ですので、呼び出すphpの置いてある同フォルダに my.iniファイルを置きましたが、うまく読み込んでいないようです。 このような使い方は間違っているのでしょうか。 問題点は、レンタルサーバーでutf8を推奨しているため、 cp932を使いたくても、文字化けしてしまっています。 その為、my.iniファイルを個別に置こうとした次第です。 因みに、phpも同じような現象があり、php.iniをphpファイルが置かれている フォルダに配置し、cp932としたところ、いくつかの文字化け現象が 解消されました。
以下sqlでテーブルhogeを作成し、idを自動キーにしています。 CREATE TABLE `hoge` ( `id` INT NOT NULL AUTO_INCREMENT, ........(省略).......... PRIMARY KEY (id) ) ENGINE=MyISAM DEFAULT CHARSET=sjis; このテーブルのレコード番号4を削除するとテーブルのidは 1,2,3,5(最終)になり, 新しいデータを追加(INSERT)するとidは 1,2,3,5,6(最終)とid番号4が欠番になります。 テーブルのidを1,2,3,4,5と続き番号に再割り当てして、新しいレコードがid番号6の挿入されるようにするにはどのようにすればよいでしょうか? sql文をご教示い頂きたくよろしくお願いします。
いつもお世話になっています。 MySQLモニタについて教えてください。 SQL文を書いていると画面が見づらくなるので、コマンドプロンプトでいうclsのようなコマンドはありませんか？ 宜しくお願いします。
未熟者で恐縮ですが、質問させていただきます。 　mysql-5.1.36-win32.msiをインストールし、Configuration Wizardで設定する際に、最後の「Execute」をクリックすると「Connection Error」という別ウィンドウが表示されます。 そのウィンドウで「リトライ」を押す前にポートを開いてからボタンを押しても再度エラーが出ます。 　以前、xamppとMySQLの古いバージョンを今回使用しているＰＣで使っていたのですが、C:\WINDWS内にある「my.ini」を削除し、あらゆる以前のMySQL関連のファイルは削除してもエラーが出て、設定を終えることができません。 　また、コマンドプロンプトにおいて「sc delete mysql」も行いました。他に何かしら原因はあるのでしょうか？ 　もし無ければ、リカバリするほか手段はないのでしょうか？ 何卒ご教授よろしくお願いいたします。
CSVファイルをインポートしたいと思っているのですが、 複数のファイルをいっぺんに複数のテーブルにインポートする方法が わからず困っています。２００行８列の２０００ファイルを、 テーブル1,テーブル2,テーブル3・・・・テーブル2000にそれぞれ １ファイルずつを一回のSQL文でインポートするやり方です。 毎日ほぼ同じ量のデータをインポートする必要がありますので、 ２０００ファイルをファイル名などの固有の情報を付加し連結して、 １ファイルにしてしまい、１テーブルにインポートする方法だと SELECT文をかけたときに取得する時間がとてもかかってしまうような 気がしますので、、、
お世話になります。 1つのサーバーにドメインを5個設定後、phpMyadminを導入してますが、 それぞれのドメインのphpmyadmin 及び、データベースのユーザーを 振り分けたいのですが、その際、振り分けたユーザーに対して、 ルートなどのメインとなる権限の振り分けは控えたいのですが、 この場合、特権などは具体的に、どこにチェックを入れればいいのでしょうか？ ユーザーを作成して、特権項目にチェックを入れると、作成後の ユーザーでログインすると、root 項目などが閲覧して、これは さすがにまずいと思いました。 phpmyadmin は、2，01です。 つまり、https://abc.com/phpmyadmin/ ※メインのルートユーザー https://tanaka.com/phpmyadmin/　※一般ユーザー https://satou.com/phpmyadmin/　※一般ユーザー
select WorDate,GenName,StrTime,EndTime,SyaNum,JobType,ComName from Denpyo where WorDate like '%2009-7%' and ComName like '%奥井組%' のようなSQL文を投げますが、エラーとなってしまいます。 間違いがありますでしょうか。。。
mySQLのデータベースにhtmlのコードを保存させて、ブログのように管理したいと考えています。けれど、微妙に元のコードが変形してしまって困っています。 フォームを作って、そこに <p style="font-size:18pt;">aiueo</p> このように入力して、そのまんまの形でデータベースに保存させたいのですが、 <p style=\"font-size:18pt;\">aiueo</p> このようにクォーテーションマークの前にバックスラッシュが挿入されてしまいます。 これが原因で、ＣＳＳなどが機能せず困っています。誰か分かる方いますでしょうか？ブログなどはどうやっているのでしょうか？ 助けてください。ヒントになるソースなどでも教えていただけると助かります。 作業環境は、 データベース mySQL サーバー言語 php, ZendFramework それから、フォームの送信時にjavascript（jQuery Form）を媒介させて入力チェックなどを行っています。 windowsXP
MySQLが1つのみのレンタルサーバーの利用を検討しています。 Movable Typeを設置する場合、 複数のブログを生成することは可能でしょうか？ （※1つの管理画面ではなく、各々の管理画面で管理したいです） たとえば、 ＜1つめ＞ 公開URL：http://test00.net/a/ 管理画面：http://test00.net/mt/mt.cgi データベース：test_a ＜2つめ＞ 公開URL：http://test00.net/b/ 管理画面：http://test00.net/mt_b/mt.cgi データベース：test_a　←こちらが使えるかどうか、、、
テーブルのある項目（下記のFIELD-X）は数値とハイフォンで構成する文字列が一つのワードとして表されています。 そのワードは複数個ある場合はカンマで区切られてデータ的には一つの文字列としてFIELD-Xに納められています。 例 NUM Name FIELD-X 1　aaaaa　　1-122,1-3222,22-19-29 2　bbbbb　　0-222,1-222,1-3 3　ccccc　　19-29,5-222,1-3,8-19-29 4　ddddd　　0-11,1-33,22-444 5　eeeee　　22-4444 FIELD-Xに１９－２９と１－３と２２－４４４がある行を抽出する方法はどのようにＳＥＬＥＣＴ文で記述すればいいのでしょうか？ 因みに 上の例では2,3,4の行が抽出対象となることを求めています。 2は1-3がマッチ 3は19-29と1-3がマッチ 4は22-444がマッチ 皆さんよろしくお願いします。 （ＳＱＬ初心者ということで解り易く教えていただきたくお願いします） 尚、FIELD-XをFIELD-１からFIELD-ｎ個のカラムを持つ構成として１フィールド１ワードで作成する方法も考えられます、そのケースの検索方法も解っていません。あわせて教えていただきたくお願いします。 　
初心者と言うより、全く全くわからない状態で質問することご容赦下さい。ブログ調の掲示板で、MySQLを使っておりますが、掲示板内の投稿が10投稿を超えると、古いものから順に削除されていく状態のようで、そのリミットを完全に解除したいと思い、ファイルを探していたら、 //10行超えたら削除していく $result = mysql_query("select * from bbs_data where bbs_user_id='{$urow[id]}' order by id desc limit 9,1") or die(mysql_error()); if(mysql_num_rows($result) == 1){ $row = mysql_fetch_assoc($result); $result = mysql_query("delete from bbs_data where bbs_user_id='{$urow[id]}' and id < '{$row[id]}'") or die(mysql_error()); } という部分がありました。このリミットを解除するにはここのプログラムを変えればいいのでしょうか? その場合、どのようにしたらいいか教えて下さい。
MySQL5.0のストアドプロシージャで引数の使い方がわからなくて困っています。 ストアドプロシージャで IF文で引数の空の判定と、 LIKE '%name%'にその引数を使いたいのです。 どなたかわかるかたいらっしゃいませんか？ □プログラムからコールする strSQL = "CALL buttonaction_proc2(syohinCd, syohinCdLast, name, count) "; □ストアドプロージャ delimiter // CREATE PROCEDURE buttonaction_proc2(IN syohinCd INT(8), IN syohinCdLast INT(8), IN name VARCHAR(40), IN count INT(8)) IF ((syihinCd IS NOT NULL) OR (syohinCdLast IS NOT NULL) OR (name IS NOT NULL)) THEN AND (SYOHIN_CD BETWEEN syohinCd AND syohinCdLast) ELSE (IF syohinCd IS NOT NULL) THEN AND (SYOHIN_CD BETWEEN syohinCd AND count) ELSE IF (syohinCdLast IS NOT NULL) THEN ( AND (SYOHIN_CD BETWEEN 1 AND syohinCdLast) ) IF (name IS NOT NULL) THEN AND NAME LIKE '%name%' END IF END IF ORDER BY SYOHIN_CD; END //
タイトルの通りなのですが、「Could not start the service MySQL」というエラーが出てインストールがど～しても上手くいきません。 OSはWindowsXPを使用しています。 一応googleで調べてみてやってみた対策 ・コマンドプロンプトからMySQLサービスの削除 ・プログラムの追加と削除（アンインストール） ・my.iniの検索＆削除 ・MySQLフォルダの削除 ・Cドライブのクリーンアップ ・C:WINDOWS\Prefetch\の中のMYSQLと名前の付いている.pfファイルを手動で削除 ・Cドライブの隠しファイルの中の(C:Document and Settings/AllUsers/Application Data/MySQL)を削除 ・ファイアーウォールの無効 ・セキュリティソフトの無効 ・アパッチの停止 上記を行ってから再インストールしようとしても同じ箇所で同じエラーが出てしまいます。 原因と思われる事がありましたら、教えて下さい。お願い致します。
現在、会員情報を保持するのに会員テーブルを使っています。 このテーブル、もともと会員IDと会員の名前だけのカラム構成だったのですが、 住所やらメールアドレスやらが増え続け、現在２０あまりのカラムになっています。（これらのカラムは部分従属も繰り返しもありません。） で、悩んでいるのが、カラムが多いと検索や読み出しの速度が落ちるのでは・・・。ということです。 そこでカラムの使用頻度の高いものと低いものでテーブルを分けようと思ったのですが、それはそれで速度が低下するような気がします。 （いちいち紐付けしなくてはいけないので・・・） テーブルを分けたほうが良いでしょうか？
はじめまして。 Mac OSX10.4.11環境にてMySQLをダウンロードしターミナルでPasswordの設定をしようとしています。 しかし、'Access denied for user 'root'@'localhost' (using password: NO)'や、password;を聞いてくるので、自分のPCにログインするときのPasswordを入力しましたがだめで先に進ませてくれません。 MySQLを初期化し再インストール、再起動したのですが、今度はシステム環境設定にあるMySQLアイコンでサーバーが起動してくれないようになりました。 以前はstartボタンで動いていたのですが、押してもrunningになってくれません。 startupitemとprefパネルも再インストールしたのですが、だめでした。 システムのバージョンはMac OS X Version 10.4.11、 ダウンロードしたMySQLは、mysql-5.4.1-osx10.4-powerpc-64bit.dmgと、 mysql-5.0.64の二通り試しましたが同じでした。 何とか構築していきたいのですが、初心者なためどうしていいかまったくわからず困っています。。 どうかご教示お願い申し上げます。
// [ITEMS] ID=商品のID(プライマリーでは無い), NAME=名前, BUY=購入個数 SELECT NAME, COUNT(BUY) AS KOUNYUU, ID FROM ITEMS WHERE ｛入力した条件によって変える｝ CROUP BY ID ORDER BY KOUNYUU ｛ASCかDESCを指定して入れる｝,ID ASC LIMIT 30 OFFSET｛ここも入力した条件によって変える｝ 今はこんな感じでデータを取得して、順位を表しています ここに商品の売上順位の情報を追加したいのですが、やり方を考えても浮かびません。 どのようにしたら追加出来るでしょうか？
初心者です。 教えて頂けますか？ 一つのフィールドにユニークのインデックスを付けたのですが (phpMyadminの)インデックスサイズの一意な値の数とありますが、 何を指すのでしょう？一意（ユニーク）の意味は分かるのですがいまいち意味が分かりません。 何の事でしょう？ よろしくおねがいします。
dataテーブル id name 1 あいう 2 かきく 3 さしす ... .. . というテーブルがあり、nameの値を任意の順番ですべて取り出したいのですが、どのようにSQLを書けばいいのか分かりません。 idは自動連番です。 idの順に取り出すにも並び替えが必要ですし、SQL文以外にも何か良い方法が有りましたらご教授いただけると幸いです。 なお、このテーブルは頻繁では有りませんが順次データが増えていきます。 そのたびに取り出す順番を検討するので、更新時にあまり手間のかからない方法が望ましいです。 データベースのバージョンは5.1です。 よろしくお願いします。
CentOS5.3にphpmyadminをインストールしたのですが、ログインすると左ペインが表示されません。同じ状況で解決されたか方がいらっしゃいましたらご回答宜しくお願いいたします。 環境は、 OS:CentSO5.3 WEBServer:Apache 2.2.11（ソースからコンパイルしてインストール） PHP:5.3.0（ソースからコンパイルしてインストール） MySQL:5.1.36（srpmからリビルドしてインストール） phpmyadmin:3.2.0.1-all-languages（解凍してそのままコピー） です。 ログインは正常にできます。また、エラーメッセージも特にありません。 しかし、右フレームは正常に表示されるのですが、左フレーム（メニューとか）が表示されません。真っ白です。 phpファイルのパーミッションを777とかにしてもダメでした。。。 どなたか同じ状況で解決された方がいらっしゃいましたらご回答宜しくお願いいたします。
とあるテーブルにおいて、datetime型にて登録されている日付データを 別のテーブルに入れたいのですが 登録先のテーブルでは、int(11)型のunix timeで日付データを格納しています。 データ件数が多いため、perl等を介すと時間が掛かるため SQLだけで変換を行いたいのですが いい方法はないでしょうか。
教えて頂けますか？ 経験浅いのでわからないのですが、 pear MDB2からレコードを配列で取得したいのですが、 私が知っているfetchRowでは、一件ずつなので whileで回して配列に入れ直すのでしょうか？ それとも配列として取得出来るメソッドがあるのでしょうか？ どのようにするのでしょうか？ 日本語マニュアルのありかが分からないので 教えて頂ければ助かります。 よろしくおねがいします。
よろしくお願いいたします。 趣味と勉強を兼ねてデータベースのサイトを作っています。 http://www.game-minzoku.jp/index.php ↑このようなゲームソフトのデータベースサイトを作っていて、 今日までの過去30日間に発売したデータだけを抽出して表示させたいと思っています。 「hatsubai」というフィールドに『2009-7-30』というようにデータを入れてあります。　 調べた知識で、 ---------------------------------------------------------------- $sql = "select * from ○○ where TO_DAYS(NOW()) - TO_DAYS(hatsubai) < 30 order by hatsubai desc;"; ---------------------------------------------------------------- と書いてみて、一応過去30日間のデータを抽出できたと思っていたのですが、今日（現在2009/7/6）より先のデータも出てきてしまっている感じです。 今日（現在2009/7/6）より先のデータはここでは抽出しないようにするにはどのように記述すればよいのでしょうか？ またご不明な点や言葉足らずな点などあればビシビシおっしゃってください。 よろしくお願いいたします！
こんにちは、 今mysqlを使用しています。 例えば、tbl_EXというテーブルがあり、 そこにはid,name,flgが入っているとしたときに addという項目を追加したい場合は ALTER TABLE tbl_EX ADD add int NULL DEFAULT 0 などとすれば追加できると思うのですが、 その追加を id, name, (add), flg というように 真ん中に入れたい場合は、どうすればいいのでしょうか？ 一度テーブルをdropして作り替える以外に方法がある場合、 教えてください。
MySQL V4からV5（V5.1を考えています）に移行するに当たって、 ＤＢ接続関数やＳＱＬの変更点を記述している資料を探しています。 何かよい資料はありますでしょうか？ よろしくお願いいたします。
タイトルにあるようにMySQLのrootパスワードを忘れたときの手順について、教えてください。 http://d.hatena.ne.jp/tech_onoue/20070522/117984 … 上記サイトを参考に行っているのですが、一番最初の「mysqld-nt.exeにオプションを入れて起動します。」で、コマンドプロンプトから C:\Program Files\MySQL\MySQL Server 5.1\bin>mysqld-nt --skip mysqld-nt --skiant-tables と入力したところ、 'mysqld-nt' は、内部コマンドまたは外部コマンド、 操作可能なプログラムまたはバッチ ファイルとして認識されていません。 と出て、はじかれて困っています。 ＭＹＳＱＬのバージョンやパスは、自分のに置き換えたのですが、ほかにも置き換えが必要でしょうか？ 他のサイトも参考にしたのですが、どこも似たような手順なので、このサイトを見ています。ＭＹＳＱＬの再インストールもしたのですが、設定が残っているのか、rootパスワードが自分で決められないです。 ＊設定を消したほうが早いというなら、その手順を教えて頂ければそちらを行います。 とにかく、２日ほど、困っていて、絶望的なんでどなか教えてください。 ＯＳは、ＶＩＳＴＡを使っています。
PHPからMySQLを使っています。 MySQLもPHPも文字コードはutf8を使っているのですが、PHPMyAdminから入力した日本語を普通に読み出すと文字化けして「??????」になってしまいます。また、自作コードからの日本語のinsertもできません。 しかし、「set character set utf8」を先に実行しておくといずれも上手くいきます。 これは一体どういうことなのでしょうか？ そもそも全てutf8で統一しているつもりなのですが、MySQLかクライアントのどちらかで他のコードが使われているということなのでしょうか？ MySQLはstatusなどを見てもutf8になっているので、どちらかと言えばクライアントの方が臭うのですが、よくわかりません。 どうか知恵をおかしください。
欲しいデータのみを取得するステートメント (1)select カラム名 from テーブル名 where 条件; という構文を本で見つけたのですが… これの条件をテキスト入力に変更して DBから情報を引っ張ってくることは可能でしょうか?? 可能であればその構文を教えていただけますと幸いです。
日時を保存する型としてベストな型はどれなのでしょうか？ MySQL5.1にて日付を保存するカラムをdatetime型で設計をしていたのですがタイムゾーンを考慮したい場合にはどうするのがベストでしょうか？ タイムゾーンを別カラムで持つ場合、単位を時間で持つと計算が手間のように感じ、それならunixtimeをint型で持って、時差情報も秒で持てば計算がらく、と思ったのですが、、、 こうやってますよ、という事例などありましたら教えてください
MySQLにログインできなくて困っています。 googleで検索しても解決できません。 わかる方いらっしゃいませんか？ Enter password: **** ERROR 1130 (HY000): Host 'localhost' is not allowed to connect to this MySQL server
php,mysqlの連携で中古車サイトを作っています。 まだテーブル校正の段階なのですが早速つまづいてしまいました><; テーブルcar id,name,price,maker_id,icon_flg(実際にフィールド数は30あります) 1,車名1,129.8,1,'アイコン' 2,車名2,109.8,2,'アイコン' 3,車名3,98.9,3,'アイコン' ---略--- テーブルmaker id,name 1,メーカー1 2,メーカー2 3,メーカー3 ---略--- テーブルicon(実際には20のデータがあります) id,name 1,4WD ---略--- 20,ETC テーブルicon_image(実際には20のデータがあります) id,path 1,img/01.gif ---略--- 20,img/20.gif テーブル校正は上記のような形式です。悩んでいる箇所はテーブルcarのicon_flgの値の書き方です。 考えた方法としては 1：『100100111』のようにして1であれば成立0であれば不成立 2：icon1～icon20までのフィールドを用意し1であれば成立0であれば不成立 この2パターンくらいしか思いつかなかったのですがどちらが一般的な方法なのでしょうか？ 1の方法は5個程度の少ないアイコンであれば登録する際に判断も容易なのですが20個と多いので 後々苦労もありそうな気がし2の方法はアイコンのために20個のフィールドを増やすというのに抵抗が・・・ また、両者の場合ともINNER JOINでidを参照するという方法もどう判断していいものかが 判断できない(特に1の場合)のですがどのようなsql文を書けばいいのでしょうか？ php,mysqlどちらも5です。他の方法でも構いませんので詳しい方がいらっしゃいましたら アドバイスをお願い致します！
ヘッダ付きのCSVデータがあります。 テキストファイルとしてエディタで開くとカンマ区切りでした。 エクセルで開くと、うまくヘッダに沿ってデータを確認できます。 そのセルの値の中には、"カンマ"が含まれています。 なぜエクセルは、カンマ区切りのデータで値にもカンマが存在しているのにヘッダに沿って表示できるのでしょうか？ また、このデータをデータベースに登録する時に、 カンマ数で、エラーしました。エクセルのように、 ヘッダに沿ってデータをコピーする方法を教えてください。
初心者でいろいろと調べてみたのですが、どうしてもわかりませんでした。分からないので質問します。 A表 ID | B_ID_1 | B_ID_2 1 | 1 | 5 2 | 2 | 6 3 | 2 | 1 B表 ID | name 1 | 1a 2 | 2b 3 | 3c 4 | 4c 5 | 5c 6 | 6c とあった時　、以下の結果を出力したいのです。 ID | B_ID_1 |ID_1_name| B_ID_2|ID_2_name| 1 | 1 | 1a | 5　 | 5c 2 | 2 | 2b | 6 | 6c 3 | 2 | 2b | 1 | 1a Ａ表のB_ID_1 B_ID_2　からＢ表のＩＤを検索して一つの表にしたいとおもっているのですが、どのようなＳＱＬ文を記述してよいかが分かりません。 また、ＳＱＬ文を勉強するのに良いサイトがありましたらお教えください。 よろしくおねがいします。
重複を除いた結果が欲しいのですが、 DISTINCTだと取得する全てのカラムの内容が一致すると重複と言う扱いになってしまいます。 複数のカラムデータを取得する場合でも、指定したカラムデータが重複したら除くようにしたいのですが、スマートな構文はないでしょうか？
題名の通りです。入力画面上で自動生成させた値（今回はパスワード）を入力したテキストと一緒にデータベースへ送りたいと思ってますが行き詰りました。テキストは無事データベースへ送信されますがパスワードが送信されません。というか送信側の記述方法が分からず何も書いていないので当然ですがさっぱりです(;;)何卒、ご指導お願いします。(なお、プログラムの一部はネット上に公開していた物を使わせていただいております。) 【入力画面側　nyuryoku.php】 <HTML> <HEAD> <META http-equiv="Content-Type" content="text/html; charset=Shift_JIS"> </HEAD> <BODY bgcolor="#FFFFFF" text="#000000"> <FORM name="form1" method="post" action="view.php"> <?php //----------------------// // パスワードを生成する // //----------------------// // パスワードの長さ設定 define(PASSWORD_LEN, 9); // 乱数表シードを決定 srand((double)microtime() * 12345678); // パスワード配列を作成 $pwelemstr = "abcdefghkmnpqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ2345679"; $pwelem = preg_split("//", $pwelemstr, 0, PREG_SPLIT_NO_EMPTY); // ランダムパスワードを生成⇒表示。 print makePassword(PASSWORD_LEN) . "\n"; // ランダムパスワードを生成する関数 function makePassword($length) { global $pwelem; $password = ""; for($i=0; $i<$length; $i++ ) { // パスワード文字列を生成 $password .= $pwelem[array_rand($pwelem, 1)]; } return $password; } ?> <BR><BR> BACK_PASS<BR> <INPUT type="text" name="back_pass"> <BR> FRONT_PASS<BR> <INPUT type="text" name="front_pass"> <BR><BR> <INPUT type="submit" value="送　信"> </FORM> </BODY> </HTML> 【送信側 view.php】 <HTML> <HEAD> <TITLE>view.php</TITLE> </HEAD> <BODY> <?php require_once("DB.php"); $dbUser = "USER";// ユーザー名 $dbPass = "PASS";// パスワード $dbHost = "LOCALHOST";// ホスト名 $dbName = "DATABASE";// データベース名 $dbType = "mysql";// データベースの種類 $dsn = "$dbType://$dbUser:$dbPass@$dbHost/$dbName"; // データベースに接続 $conn = DB::connect($dsn); // 接続に失敗したらメッセージを表示して終了。 if (DB::isError($conn)){ die($conn->getMessage()); } // POSTされたデータを受け取り、エスケープ。 $back_pass= addslashes($_POST['back_pass']); $front_pass= addslashes($_POST['front_pass']); $sql = <<<EOS INSERT INTO passkanri ( back_pass, front_pass ) VALUES ( '$back_pass', '$front_pass' ) EOS; if(preg_match("/Windows/", $_ENV["OS"])){ $sql = mb_convert_encoding( $sql, "SJIS", "EUC-JP"); } // SQL文を発行 $result = $conn->query($sql); if (DB::isError($result)) { die ($result->getMessage()); } $count = $conn->affectedRows(); print "データを" . $count . "件、挿入しました。"; // データベースから切断します。 $conn->disconnect(); ?> </BODY> </HTML>
以下のようにテーブルを作成し、TIMESTAMP型のカラムをキーにUPDATEをしたいと考えています。 create table test(time timestamp, amount int); insert into test values('2008-01-07 19:15:12',0); update test set amount = -1 where time = '2008-01-07 19:15:12'; ところがMYSQLではUPDATE後、TIMESTAMPのカラムが2008年から2009年に変化します。ORACLEで試しましたが、TIMESTAMP型のカラムは変わりませんでした。 +---------------------+--------+ | time | amount | +---------------------+--------+ | 2009-06-30 10:04:53 | -1 | +---------------------+--------+ MYSQLの独自の仕様があるのでしょうか？ MYSQL 5.1.35(mysql-essential-5.1.35-win32.msi) Windows 2003 Server Standard Edition R2 MYISAM
問題のコードです。 何度やっても失敗と表示されます。 接続は問題ないと思います。 お願いします。 $db = mysql_connect("localhost", "user", "user_パスワード", "db1") or die("Connection error"); $query = "select * from menbers"; $result = mysql_query($query, $db); if($result){ echo "成功"; }else{ echo "失敗"; }
質問です。 Mobavle typeをsjisにしようと、my.cnfを下記の用にしましたが、 管理画面の前のログインボタンページだけutf-8で文字化けしています。 解決方法を教えてください。 [mysqld] datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock user=mysql # Default to using old password format for compatibility with mysql 3.x # clients (those using the mysqlclient10 compatibility package). old_passwords=1 default-character-set=sjis skip-character-set-client-handshake # To allow mysqld to connect to a MySQL Cluster management daemon, uncomment # these lines and adjust the connectstring as needed. #ndbcluster #ndb-connectstring="nodeid=4;host=localhost:1186" [mysqld_safe] log-error=/var/log/mysqld.log pid-file=/var/run/mysqld/mysqld.pid [ndbd] # If you are running a MySQL Cluster storage daemon (ndbd) on this machine, # adjust its connection to the management daemon here. # Note: ndbd init script requires this to include nodeid! connect-string="nodeid=2;host=localhost:1186" [ndb_mgm] # connection string for MySQL Cluster management tool connect-string="host=localhost:1186" [client] default-character-set=sjis [mysqldump] default-character-set=sjis [mysql] default-character-set=sjis #language=japanese 以上です。 httpd.confもAddDefaultCharset Shift_JISにせっていしてあります。 画像を用意しました。
大学の授業でコーディングをしている者です 初心者ではありますが，よろしくお願いします． 今回Mysqlで作ったDBの中に画像を保存しなければならないのですが， 全く想像がつきません． 本を見た限りでは,画像の保存は出来るとあったのですがサンプルが なく，悪戦苦闘しています． もしお分かりの方がいましたらお手数ですがご指摘または サンプル構文等を載せていただけましたら助かります．
よろしければお力添えをお願いいたします。 現在、大量のデータをデータベース化しようとしています。 扱うデータは ・種類：csvファイル（txtファイルにも出来ます） ・サイズ:400kb程度/ファイル ・ファイル数：１７万強 これをMySQLでデータベース化しようとしています。 ですが、その前に元のファイルのデータ整理が必要になっています。 具体的に必要な操作は ・空白セルの穴埋め（空白セルには一つ上の行のデータを入れる） ・行、列の削除、および挿入 ・ヘッダーの挿入 ・ファイル名変更 です。 あまりにもデータ数が膨大なので、何かしらのプログラミング言語を使ってデータ整理をしていきたいのですが、こういった場合はどのような言語が向いているのでしょうか。 私はVBAならある程度扱えるので、Visual Basicなら取り組みやすいのではと考えています（VBは触ったことないので完全に妄想ですが...）。 ですが、ファイル・データ操作に対する言語の向き不向きがわかりません。こういった場合はC言語やC++といった言語の方が処理速度は速いのでしょうか。教えてください。 また、csvファイルによるデータ処理が遅いのであれば、txtファイルに変更して処理することも出来ます。 その場合、行の削除、列の削除といったものはC言語で可能なのでしょうか。 長々と質問していまい申し訳ありません。よろしくお願いいたします。
PHPからMySQLを使用しています。 リファレンス等を見ると、DB接続の際mysql_select_dbは成功時に0、失敗時にそれ以外の値を返すらしいのですが、現在問題なくPHPからDBを利用できているにもかかわらず、mysql_select_dbの戻り値が1になっています。 これは何か内部でエラーが起こっているということなのでしょうか？ 起こっているとしたら、どのように調査すればいいのでしょうか？ アドバイスをお願いいたします。
重複しないように連番になるように AUTO_INCREMENTとPRIMARYが設定されているidフィールドがあるんですが、 データを削除したあと連番になりません。 例えばデータを10個作ると自動的にidフィールドに1～10まで番号がふられます。 id10のデータを削除し、新規で追加すると データのidは11になってしまいます。自動的に10に振り分けてほしいのですが可能なのでしょうか？
update TBL set NAMAE='AAA', TOSHI=●● WHERE ID=1 ●●の部分をリテラルでなく、例えばID=2のTOSHIのデータをセットしたいのですが、そのような事は、update１文でできるのでしょうか？ TBLテーブル ID NAMAE TOSHI 1 2 BBB 50 3 CCC 40
TABLE-A　が NO str1 str2 001 aaa AAA 002 bbb BBB ←削除 003 ccc CCC のときに、NO=002を削除後、連番をふり直すために UPDATE TABLE-A SET NO = NO - 1 WHERE NO > 2; というようにしましたが、案の定、003が2となってしまいました。 これを、002とする方法はありますでしょうか。 よろしくお願い致します。
MYSQLのrootユーザーを消してしまい、daemonでいろいろやったのですが、うまくいかんかったので、yum remove しました。 そしてまたイントールしたのですが、DBが残っていました。 そのような事はあるのでしょうか？
phpMyAdminを使用してcsvからデータをインポートしようとしています。 通常の値は問題なくインポートできるのですが、NULL値があるフィールドがどうしても「0」になってしまいます。（そのフィールドはNULL値が入力可で、デフォルト値もNULLです） csvからNULL値をインポートする方法をご教授下さい。 宜しくお願いします。 ※\Nを入力するとNULLになるという情報があったため、 "1";"2";"3";"4";\N "1";"2";"3";"4";"\N" （1.2.3.4は適当な文字で、5番目をNULLにしたい） の両方を試みましたが、入力結果は「0」でした。 phpMyAdmin - 2.10.2 MySQL クライアントのバージョン: 5.0.18 フィールド区切り記号　; フィールド囲み記号　""
MySQLの文字コードを変更について教えてください。 my.iniファイルを開いて [mysqld] の中に ・・・ default-character-set=utf8 skip-character-set-client-handshake [mysqldump] ・・・ default-character-set=utf8 [mysql] ・・・ default-character-set=utf8 と変更したのですが、MySQLを再起動しstatusで確認したのですが、 latin1のままで変更されません。 XAMPPをアンインストールをして再度同じ設定を行ってもlatin1でした。my.iniファイルのほかに何かのファイルを変更しなくてはいけないのでしょうか？ ↓のサイトを参考に設定を行っています。 http://mysqlx01.seesaa.net/です。 教えてください。 宜しくお願いします。
次のようなテーブルがあります。 info{ name varchar(50) release date } 今週の日曜日(6/21)から土曜日(6/27)までの要素を抽出するため 次のようなSQL文を実行しました。 SELECT name FROM info WHERE release BETWEEN DATE_SUB( DATE(NOW()), INTERVAL DATE_FORMAT(NOW(), '%W') DAY ) and DATE_ADD( DATE(NOW()), INTERVAL WEEKDAY(NOW()) DAY ) この構文でエラーがでてしまいます。 BETWEENのand前後の指定は間違っていないと思うのですが どこが悪いのかわかりません。 ご教授願います。
AmazonEC2内でのMysqlCluster設定について質問いたします 何方か分かる方、ご教授お願いいたします。 ネットで方々探し、 その通りに設定を行うのですが、 clusterが一向に出来ません…。 ローカルでのサーバー内同士では上手くいったのですが、 AmazonEC2内ですと、つながってくれません。 Portやファイヤーフォール等の問題かもしれませんが、 原因が分からず苦戦しております。 =================================== 使用OS：debian lenny mysql ：mysql5.0 管　理　ノ　ー　ド：サーバーＡ データ・SQLノード ：サーバーＢ・サーバーＣ 管理ノードから **************************************** ndb_mgm> show Connected to Management Server at: localhost:1186 Cluster Configuration --------------------- [ndbd(NDB)] 2 node(s) id=2 @サーバーＡ (Version: 5.0, starting, Nodegroup: 0) id=3 @サーバーＢ (Version: 5.0, starting, Nodegroup: 0) [ndb_mgmd(MGM)] 1 node(s) id=1 (Version: 5.0) [mysqld(API)] 2 node(s) id=4 (not connected, accepting connect from サーバーＡ) id=5 (not connected, accepting connect from サーバーＢ) **************************************** この状態で、Masterの表示すらされてくれません。 ですが、 各データ・SQLサーバーは認識しており、 Port3306も開いていると確認できております。
PHPとMYSQLにて簡単なネットを介した商品管理システムのようなものを作成するとして、 例えば以下のような加算処理を複数の店舗の担当者が別々のパソコンからほぼ同時に行なった場合 UPDATE drink SET count=count+1 where name='beer' countの数値に狂いが出てしまうということはありますでしょうか あるとすればどのように対処していけばよいのでしょうか どなたかお詳しい方、ご教授の程何卒よろしくお願い致します
現在MySQLについて色々試行錯誤して勉強しています。 タイトルに関して、例えばSELECT構文ならば SELECT * FROM `mytable` WHERE `hoge` = 1 ORDER BY `foo` DESC LIMIT 10 , 20 で、該当の10件目～30件目（20件分）の範囲を取得できますが、 DELETE構文だと、LIMIT に offset （LIMIT 10←これ , 20）の指定が出来ないようで、 自分で考えた方法だと、範囲の決め手となる最小値・最大値を出してから、 WHERE節でその範囲に当てはまるものを消す、 といった形で、MySQLに３回アクセスすることになってしまいます。 またこの方法だと、最小値又は最大値と同じ値があると、 それを消すことができません。 （きっちりやるには他のユニークキーを用意して使用するなど手間がかかりそうです） 例のSELECT構文のように簡略化できないでしょうか。 どうかよろしくお願いします。 ----------------- 環境 　PHP 5.2.5 　MySQL 5.1.22
マッキントッシュのサーバーXserverを使っています．但しほぼ全くの素人です．御容赦下さい． 今回画像データベースを構築することを業者に依頼しました所，Xserverにphp, MySQLが必要という回答が来ました．機械購入時にはそのようなアプリケーションはインストールされていないようです．データベースを依頼した業者はマッキントッシュは不案内とのこと．大学の情報管理の部署もそのようなお手伝いはできないとのこと．器械を買った業者は反応なしで困っております． MySQLとphpというもののインストールの方法を，いちから教えていただくことは出来ませんでしょうか．
今までPostgreSQLを利用していたのですが、MySQLもテストで一回使ってみよと思い触ってみたところ・・・ varchar(20)のカラムに、文字列型で「4571170731101」という値を登録するとDB上では「2147483647」となってしまいます。 int型？とかに解釈されてるんでしょうか。意味がわかりません。 どなたか助けてください。
データベース（以下、DB）は、SQLite2です。 PHPスクリプトの中で利用しています。 なお、本質問はMySQLとして説明して頂いても結構です。 （恐らく、同じような方法で解決できると思いますので。） 考え方が分かりましたら、あとは自分で調べられますので、 その方向性だけを示して下さるというのでも結構です。 さて、質問に移らせて頂きますが、 DBに検索をかけ、ヒットしたレコードを、 ある特定のカラムをもとにソートし、その中の上から指定件数分抽出する ということをしたいと考えています。 例をあげます。 テーブル名（tbl_siritori） id word cate 1 りんご 食べ物 2 ごりら 動物 3 らくだ 動物 4 ダック 動物 5 くり 食べ物 6 リス 動物 7 スイカ 食べ物 8 カメ 動物 9 メロン 食べ物 というDBがあったとして、 このDBに、[cate]に「食」という文字が入っているようなデータを、 [id]順に見て、大きな数字のものを上から３件抽出したい場合、 どのような方法（SQL文）が考えられますか。 ３件のデータを表示した後、 さらにそれに続く３件のデータを次ページに表示、 さらにそれに続く３件も同様にさらに次ページに表示…（略） ということをしようと思っています。 １ページに３件、で、何ページにも渡ってデータを３件ずつ出力していく、ということです。 以上のことを実現可能であるSQL文の中でも、 最も一般的なものを教えて下さい。 $query = "SELECT * FROM tbl_siritori WHERE (cate LIKE '%食%') ～～ごにゃごにゃ～～ ORDER BY id DESC"; というような書き方で、１文で解決できるものと思っていますが、 複数の文で絞り込むような形になるのでしょうか。 以上、よろしくお願いいたします。
PHP4＋MySQLです。 やりたいことがあるのですが、いいSQLが考えつきません。 お知恵を拝借できれば幸いです。 以下のようなテーブルがあるとします。 ID｜ITEMid｜DATE 1｜ 232｜2009-06-14 2｜ 156｜2009-06-14 3｜ 156｜2009-06-14 4｜ 232｜2009-06-14 5｜ 232｜2009-06-14 6｜ 567｜2009-06-14 これを次のように集計したいのです。 （ITEMidの登場回数順にソートして、実際の回数も出す） 232:3 156:2 567:1 サブクエリの使えない環境で、1回のSQLで集計することはできるでしょうか。できる場合実際のSQL文を教えていただければ幸いです。 テンポラリテーブル使えば自分でもできそうな気がするので、できれば使わない想定でお願いします。
ざっくりとした回答で結構ですので、データベース言語のバージョンについては、あえて記載を省きます。 環境：Apatch、Linux、PHP4、SQlite2 バージョンによって動作が異なるのであれば、その場合には適宜補足します。 なお、私はデータベース言語の知識をそれほど持っていませんので、分かりやすく記述して頂けると大変助かります。 --------------------------- では、本題に移らせて頂きます。 現在、PHP4とSQlite2の組み合わせでスクリプトを制作中なのですが、 その際に、データベース（以下、DB）の中のデータを検索・抽出することがあります。 SQliteのコマンドでは、SELECT文を使った記述になります。 （恐らく、MySQLなどでも同様だと思います。） で、知りたいことは、 DBをどう構築したら、「検索・抽出」速度が遅くなりにくいか（高速になりやすいか）。 これが知りたいわけです。 私が考えている方法は、いくつかあって、それらについて、 速い遅いの意見を覗いたいと思います。 また、もっと良い方法がありましたら、そちらも教えて下さい。 想定しているDBは、例として、簡単に以下のものとします。 例：学年の生徒DB クラスがA組～E組まで５クラスあります。 生徒の、 氏名、性別、クラス、出席番号、生年月日、所属している部活名、担当委員、欠席数 のようなものを記録するDBだと思って下さい。 さて、この例において、以下のどの形式が良さそうでしょうか。 方法１： （DBファイルを１つ用意） DBをCREATEするときに、TABLE名を　tbl_all という風に１学年全体で記録するような形式。 方法２： （DBファイルを１つ用意） DBをCREATEするときに、TABLE名を　tbl_a　～　tbl_e という風に分け、それぞれのテーブルに各クラスの生徒データを記録するような形式。 方法３： （DBファイルを複数用意） DBをCREATEするときに、クラスごとに、DBファイルを「db_a.sqlite2」～「db_e.sqlite2」のように作成し、それぞれにおいて、TABLEを１つ作り、そこにクラス内の生徒のデータを記録する形式。 どの形式のDBが、速く（もちろん正確に）検索・抽出（SELECT）できるでしょうか。 一般論でも結構です。 また、データ数が多くなるにつれ、速度が逆転するというような場合には、そちらも教えて下さい。 この例では、クラス数が５なので、比較的データは少ないですが、 私が構築しようとしているDBでは、データを１万件以上扱う可能性が高いので、その点も考慮して、アドバイスして頂けると嬉しいです。 以上、よろしくお願い致します。
打率などを表示させたいとき、 .360 などはデータ型は何を定義すればよいでしょうか？ ご教授いただける方宜しくお願いします。
MYSQL5.0.33を使用しています。 今「ID(primary key)」「name」の二つのカラムのテーブルがあり、そのレコードの中から2の倍数と3の倍数のレコードをそれぞれ取得したいのです。 しかし、レコードが削除される可能性があり、なるべく均等に取得することができません。 ================= (例) 1 佐藤 2 鈴木 3 (削除されたレコード) 4 田中 5 小林 6 (削除されたレコード) 7 阿部 8 吉田 9 (削除されたレコード) ================= 上記のような状態ですと、3の倍数のレコードは一つも取得できません。 素人の感覚的な話になってしまうのですが、 ================= (例) 1 佐藤 2 鈴木 3 田中 4 小林 5 阿部 6 吉田 ================= このような感じにして、 「2の倍数は『鈴木』『小林』『吉田』」 「3の倍数は『田中』『吉田』」 で取得はできないものかと思い質問させて頂きました。 できなければ、何か方法や苦肉の策等ありましたらご教授頂けませんでしょうか。 どうか宜しくお願い致します！
環境はMYSQL 5.0です。 既存のテーブルでたとえば **************************** ○Aテーブル 　No INT(5) 　Name VARCHAR(5) **************************** 上記のようなテーブルが存在しており、そこに MySQL Query Browserなどのツールを使用し 追加でMEDIUMBLOB型の項目を追加しました。 **************************** ○変更後Aテーブル 　No INT(5) 　Name VARCHAR(5) 　Image MEDIUMBLOB **************************** その後、PG(VB2008)よりjpg画像ファイル登録するため INSERTするとエラーが発生してしまいます。 エラー内容は 「ERROR 1064: You have an error in your SQL syntax. Check the manual that corresp onds to your MySQL server version for the right syntax to use near （ここは文字化け） at line 1」 といった感じです。 INSERT実行自体には問題がないため、 一度MYSQL5.0をアンインストール、再インストール後に初めからBLOB型を含んだAテーブルCREATEを行い 再度同じようにPG実行でINSERTによるjpg画像の登録を行ったら 正常登録されました。 このことよりおそらくMYSQLの既存のデータサイズ設定？に問題が あるのかなぁと思っています。 そこで質問なのですが、MYSQLのアンインストールなど行わずに 既存のままテーブルにBLOB型を追加し、データサイズ（Data Length？）を変更する方法をご存じの方いらっしゃいますでしょうか？ また、原因自体違う！というのがありましたらご指摘いただきたいです。 複数の場所でこのBLOB追加作業が必要になってきており、困っております。 よろしくお願いいたします。
MYSQLはSJISに対応という事で、 ポスグレから乗り換えようと思うのですが、 MySQLでもpgAdmin3みたいなソフトはありますか？
MySQLのログについておしえてください. (http://oshiete1.goo.ne.jp/qa5031135.html　で現在質問でログの出力方法が判らずに悩んでおります。） 「どのようなクエリ（SQL文の発行があったのか？）を確認するために、MySQLのログを有効にしたいのですが、設定の手順が良くわからずに困っています。 【参考にしたＵＲＬ】 http://variable.jp/?p=581 （いまいち設定がわからずに悩んでいます＾＾；） MySql：Ver 5.0 MySQLのログ出力させたいのですが、 どういった手順を実行することでMySQLのログがどこに出力されるようにできるのでしょうか？
MySQLのオプティマイザはルールベースでしょうか？コストベースでしょうか？ 取得するカラムが違うだけで、EXPLAINの使用するindexが変わったりするので（ver 5.1）、コストベースかと思っていたのですが、そのような記述が見つかりません。 ご存知ありませんか？
MySQLで以下のようなテーブルの場合 test_1 id name test_2 test_1_id name このような構造の場合、test_1からtest_2のselectでtest_1.id=test_2.test_1_idでjoinした場合に、 test_2にデータが存在していなかった場合、 test_1テーブルのnameを返すようなsqlはどのように記述すればよいでしょうか、、
あるテーブルには時系列のデータが100万レコード格納されています。そのテーブルから時系列順にデータを抽出するプログラムがあります。前半の処理はとても早いのですが後半はものすごく遅いです。確認したところ、特定の日時をSELECT文で抽出する場合７～８秒かかっています。それ以外は0秒以内で抽出できます。なぜこんなことが起こるのでしょうか？ ひとまずデータベースをrepair tableしてみたのですが不可。mysql再起動も不可。マシンごと再起動しても不可。どうすればいいのでしょうか？ そのプログラムが参照するテーブルは1個だけです。キャッシュのヒット率も高くmy.cnfも問題ないと思うんですが、同様のケースに遭われた方はいませんか？ Windows 2003 server mysql 5
以前MySQLをインストールしたのですが、パスワードを忘れてしまいました。 まずパスワードの再設定にトライしました。しかし駄目でした。 その後、MySQLを削除し、再インストールを試みました。 しかし、Passwordを入力する項目が３つになっていて、 Current Password という入力欄が出来てしまいました。 もちろん、未入力で進めるとエラーになります。 Program Filesの中にあるMySQLのフォルダは完全に削除してから再インストールを行ったのですが、他にもどこかに設定データが残っていたのでしょうか？ よろしくお願いします。 windowsXP MySQL(5.1.35)
お世話になります。 早速ですが、ストアドプロシージャを使用する際に 戻り値で配列を使用することは可能でしょうか？ 検索方法が悪いのか、なかなかそれらしい結果が見つけられませんでした。 ご教示の程よろしくお願い致します。
MYSQLとPHPで野球チームのデータ管理、WEBで表示　というサイトを作成しようと思っております。 そこで一連の流れについて質問があります。 例えば、打数１００　安打数３０　の選手がいたとし、 カラムＡ（打数）　　　カラムＢ（安打）　　　打率　 １００　　　　　　　　　３０　　　　　　　．３００ というのをWEBで表示する場合、 ＤＢにデータをインポートする際、カラムＡとＢのみインポートし、 打率はmysql側で計算してインポートしてくれるようなことは出来るのでしょうか？ 可能な場合、どのような処理を行えばいいのでしょうか？ ご教授いただける方、何卒宜しくお願いします。
とても基本的なことだと思うのですが、以下のようなテーブルがあるとします。 create table test ( id numeric primary key, name varchar(45), age numeric ); これに例えば以下のようにデータを詰めたとします。 +----+----------+------+ | id | name | age | +----+----------+------+ | 1 | takeshi1 | 50 | | 2 | takeshi2 | 25 | | 3 | takeshi3 | 30 | | 4 | takeshi4 | 35 | | 5 | takeshi5 | 40 | | 6 | takeshi6 | 45 | +----+----------+------+ ここで最年少のレコードを取り出したいだけなのですが mysql> select id, name, min(age) from test;とすると +----+---------+----------+ | id | name | min(age) | +----+---------+----------+ | 1 | takeshi1| 25 | +----+---------+----------+ 年は最年少が取り出されますがidとnameは一行目が取り出されているようです。どのようなSQLを書けば以下のようになるのでしょうか。 +----+---------+----------+ | id | name | min(age) | +----+---------+----------+ | 2 | takeshi2| 25 | +----+---------+----------+
お世話になります。MySQL勉強中の初心者です。 環境： MySQL5.1 OSX10.4 ターミナル (Winでいう「cmdプロンプト」です) 問題： LOAD DATA INFILE　でコマンドは通るのですが、select*from でチェックすると第一カラム(左端)だけは正常にロードされるんですが、残りのカラムがすべて NULL となってしまって切ないです。 ロードしたデータの例： 1011janc001a01 1012janc001a01 1013janc002a03 構造としては、こんな感じです。↓ 文字列[tab]文字列[tab]文字列[tab]文字列[空白スペース？] 現在の結果： | 1011 | NULL | NULL | NULL | | 1012 | NULL | NULL | NULL | | 1013 | NULL | NULL | NULL | 今は小規模なデータだけなのでやむなく手打ちでガコガコ入れてますが、原因を解明したいと思います。 どなたかアドバイス頂けると幸いです。宜しくお願いします。orz れざ
PHPとMySQLの環境です。 複数行のクエリを、まとめて送って取得したいと考えています。 ですが、今試行錯誤しているのですが、うまく行かない状態で、クエリをきちんと実行できません。 処理の流れとしては、 [DBにアクセス]→[２つのクエリの実行]→[データ取得]→[DBをクローズ] でいいのではないかと思ってやっているのですが、 ２つのクエリを実行するのはなにやら無理なような記述もウェブ上で拝見しました。 その場合、同じＤＢの同じテーブル内の異なるデータを取得したいだけなのに、 わざわざ、一度DBにコネクトして、切断、そしてまたコネクトして、切断ということを繰り返さないとダメなのでしょうか。。？ そもそも同一PHPファイル内で二度も接続、切断はすべきではないですか？ ちなみに、 一つ目のクエリでは、テーブル(table_a)のレコード数をカウントしてPHP側で取得するという流れの処理です。 $query = "SELECT count(*) FROM `table_a`"; もう一つのクエリは、テーブル(table_a)の最新のレコードの、idカラムのidを取得するだけのものです。 $query = "SELECT arrayset FROM `table_a` ORDER BY id DESC LIMIT 1"; この処理を一度のクエリで入れ込むことは可能でしょうか。 それぞれ単独では実行できます。 ＰＨＰでこのような関数 mysqli_multi_query() を見つけて色々調べているのですが、 いまだに使用方法がきちんとつかめない状況です。 これで複数のクエリを送ることは可能でしょうか。 アドバイス宜しくお願いします。
この度、 mysqlとphpで野球チームのデータ管理サイトを作成しようと思っています。（javascriptも使用予定） お恥ずかしいですが当方の知識としてはmysql＋phpの入門書を２週間読んだ段階です。 そこで質問です。 ---------------------------------------------- 例えば、打率を表示したい場合、 計算式は　安打数／打数 ですが、 mysqlで、a（打数）、b（安打数）、c（打率） というカラムがあった場合、 cには (1)mysql上で計算値をinsertするのでしょうか？ (2)それともphpスクリプトで計算値をHTMLに吐き出すのでしょうか？ ご教授願います。 できれば簡単でいいので手法を教えていただけたらと思います。
データベースに文字列を保存する際、既に同じ文字列が保存されていないか事前にチェックをかけているのですが、この時半角スペースが入った文字列と、全角スペースが入った文字列を同じものと認識してしまい、これを区別したいのですが、どういった方法があるのでしょうか。 具体例を出しますと、 「AAA　BBB」（間の空白は全角スペース）を入力する際、同じ文字列が同じフィールドに保存されていないか、SQLのWHERE句で「フィールド名="AAA　BBB"」を指定して検索し、同じ文字列があれば警告を出しているのですが、「AAA BBB」（間の空白は半角スペース）にも検索でマッチしてしまいます。 この検索の時に「AAA BBB」をマッチさせないようにしたいのです。 OS:Linux MySQLバージョン:5.1.22 文字コード:UTF-8 です。 よろしくお願いします。
以下のようにしているのですが取得できるデータは1回目のselectのみで2回目のデータが 何度やっても取得できません。 $sql1 = 'SELECT //ここのデータは取得できてます。 products_id, name, products_flag, IF("' . $products->beforedays . '" < DATE(create_date), "1", "0") as new FROM products WHERE EXISTS ( SELECT MIN(price1) as min_price1, MAX(price1) as max_price1, MIN(price2) as min_price2, MAX(price2) as max_price2, stock FROM products_class_detail WHERE //1回目のselectで取得したproducts_idを基準に問い合わせ products_class_detail.products_id = products.products_id ) //ここはproductsに存在するフィールドです。 AND status1 = ? AND status2 = ? AND del_flg = ? ORDER BY RAND()'; マニュアルも見てみたのですが取得できない原因がわからない状態におります。 どうすれば取得可能になるでしょうか？宜しくお願い致します。
いつもお世話になります。 アンケート的な質問があります。 datetime型の登録日カラムがあるとします。 普段は登録日時としてCURRENT_TIMESTAMPを使用して インサートしています。 しかし、同様の関数でnow()がありますが、 みなさんはどちらを利用していますでしょうか？ 使い分けがいまいちわかりませんので、質問いたしました。 どうぞ宜しくお願いします。
idと、dataという２つのカラムで構成されたMySQLがあります。 そのidはプライマリキーに設定してあり、auto incrementとして、どんどん数値が増えていく設定です（phpMyAdminを使ってテーブルを作っています） そこで、そのid番号の現在の最新のものを php側から呼び出して取得し、 その次、しばらくすると、PHP側で再びその最新から2番目 （2番目に新しいデータ）を取得する命令を 投げたいと思っています。 そのあとは、同じように、3番目に新しいもの、 4番目、5番目と続けたいと思っています。 その際、毎回、php側で MySQLのデータの読み出し命令を送るわけですが、 その際、最新のもの、2番目に最新のものを 時間差でSELECTしていくには、 どのようにすればいいでしょうか。 PHP側で「いま3番目に新しいものを読んだので次は4番目に新しいもの」というように前回の状態を保持しておくことってできるのでしょうか。 また、このidというのは、途中で消したりしているidもあったりするので、1番から始まっていたとしても、途中の30番とかが抜けていたりして、歯抜け状態ですので、id番号でセレクトするとエラーになる可能性が高いです。 なので、id番号ではなく、 テーブルの上の行から選んでいくという方法が ベストだと思っています。 そのような指定をMySQLの構文で指定することって可能なのでしょうか？ ちなみに、一応、何番のidを読むというのは理解しており、 以下のような感じのSELECT文をphpのqueryで使っていたりします。 table_aから、変数$indexNumの値のidを読むという処理を、 変数$queryに入れている文が以下になります。 $query = "SELECT arrayset FROM `table_a` WHERE id= '$indexNum'"; このあたりのノウハウをご存知の方、教えてくださいますと幸いです。 お願いいたします。
MySQLでスレーブ・マスターの設定をしてレプリケーションができたと思いますが、サーバ等がダウンした際にスレーブ・マスターの関係を逆転させること（今までスレーブだったのをマスターにして、マスターをスレーブに）は出来ますか？ ２台のWEBサーバにそれぞれDBが乗っかっていて、マスターサーバがダウンした際にはDBも切り替えを行いたいのですが・・・ よろしくお願いします。
お世話になります。 MySQL 5.1 で勉強中の初心者です。 外部キーの設定が出来ているらしいのですが、親テーブルを更新しても子テーブルに反映されません。 一応 http://oshiete1.goo.ne.jp/qa3828231.html も見ましたが、MySQLのバージョン(4.0)が違うのが気になります。 持っている教科書には ENGINE=InnoDB の記述がありません。 自分のコード： ---------- 親 ---------- mysql> create table tes1 ( t1_col1 int (4), t1_col2 varchar (10), primary key (t1_col1) )engine=innodb; mysql> desc tes1; +---------+-------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +---------+-------------+------+-----+---------+-------+ | t1_col1 | int(4) | NO | PRI | 0 | | | t1_col2 | varchar(10) | YES | | NULL | | +---------+-------------+------+-----+---------+-------+ mysql> select*from tes1; +---------+---------+ | t1_col1 | t1_col2 | +---------+---------+ | 1 | Upd | | 2 | Upd | +---------+---------+ ---------- 子 ---------- mysql> create table tes2( t2_col1 int (4), t2_col2 varchar (10), t1_col2 varchar (10), primary key (t2_col1), foreign key (t1_col2) references tes1 on update cascade ); mysql> desc tes2; +---------+-------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +---------+-------------+------+-----+---------+-------+ | t2_col1 | int(4) | NO | PRI | 0 | | | t2_col2 | varchar(10) | YES | | NULL | | | t1_col2 | varchar(10) | YES | MUL | NULL | | +---------+-------------+------+-----+---------+-------+ mysql> select*from tes2; +---------+---------+---------+ | t2_col1 | t2_col2 | t1_col2 | +---------+---------+---------+ | 1 | line11 | Upd | | 2 | line22 | Upd | +---------+---------+---------+ これで親の t1_col2 を更新して、子のテーブルを見ると何も変わっていません。何か無茶をしでかしている気はするんですが、いかんせん経験不足で原因が掴めません。どなたかアドバイスいただけると有り難いです。 宜しくお願いします。orz
mysqldumpはDB毎に取得できるのですが、バイナリログは複数のDBの更新情報が一緒に出力されています。 そこで、バイナリログへの出力をDB毎に分けたいのですが、何か方法はあるのでしょうか？ 環境の条件は以下の通りです。 ・OSはCentOS5 ・MySQLは5.0.69 ・物理的に1つのサーバーで、db1とdb2というデータベースが構築されている ・MySQLで使うポートは１つのみ
会社でサーバーの管理を任されている者です。 最近サーバーが重くなったという報告を受け、ターミナルでログインして調べてみたところ、MySQLにプロセスがCPUを30%ほど常時使用している事がわかりました。 これがサーバーが重くなった原因かどうかはわかりませんが、正常ではないような気がします。 ちなみにプロセスに表示されているのは以下のような感じです。 -------------------------------------------------- mysql 2444 30.1 0.8 109756 17332 ? S 21:06 4:00 /usr/sbin/mysqld --basedir=/ --datadir=/var/lib/mysql --user=mysql --pid-file=/v・・・ -------------------------------------------------- CPU使用率は変化しますが、大体30%前後です。 サーバーの再起動をしてみましたが、しばらくするとまたこれぐらいCPUを使用しています。 たまたまプロセスを見たときに、なんらかのクエリーが出ていた可能性はありますが、一ヶ月ほどウォッチしてみましたが、いつも同じような感じです。 これを解消する手だてはないのでしょうか・・・
RSSデータを利用したサイトを制作したいです。 例えば以下のようなサイトです。 ​http://feed.designlinkdatabase.net/​ ​http://affiliate.thumbnailcloud.net/​ ​http://a.guideme.jp/bookmark.php​ 特定のRSSフィードを読み込んで、データベースに格納し、定期的に収集し、それをサイトに表示させるというものです。 この場合、取得したＲＳＳをＭｙＳＱＬにどのように収集し格納すればいいのでしょうか？　 また、この場合のロジックと必要な技術などを教えてください。 勉強をしながら制作したいと思っていますので、 お勧めな書籍なども宜しくお願いします。
MySQLサーバにLOAD DATA INFILEコマンドを使ってファイルを読み込む時，なぜかBit(1)型の列にTrueを入れる際にWarningが無くなりません． オプションには FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\r\n' を選択して　"列1","列2","列3"\r\n　の形式で読み込んでいます． この時，Bit(1)型の列にFalseを入れるときには"\0"や"\n"，""のような値を入れれば問題なくFalseとなるのですが，逆に他の何を入れてもwarningの発行とともにTrueになり，（Trueが入る事ではなく，warningの発行の方に）困っております． 何方か，warningを出さずにtrueを入力する方法を教えて頂けませんでしょうか． 宜しくお願いします．
ゴルフ場の情報をホームページで紹介したいと考えています。 各ゴルフ場につき、(1)ゴルフ場名、(2)住所、(3)距離、(4)写真（５枚ほど）といった情報がいくつかあり、それらの情報が約５０コースあります。 htmlでテーブルを作り、そこへ当てはめていく方法も考えましたが、将来的に「検索機能」を用いたいので、データベースを使ったほうが今後の活用の幅が拡がるだろうと思っています。 そこで質問です。 このような希望に合うデータベースソフトを教えていただけないでしょうか？求めているイメージとしては、あらかじめ用意した（された）所定の管理画面に上記(1)～(4)といった情報を入力すると、ホームページが更新される仕組みです。 できれば、フリーソフト希望です。よろしくお願いします。
お世話になります。IntelMac OSX10.4でMySQLの勉強中の初心者です。 OSX 10.4 (Tiger) MySQL 5.x（つい最近、最新のを入れました-2009年5月） 立ち上げ方： ターミナルから cd /usr/local/mysql/ -u root で、 sudo chown -R mysql /usr/local/mysql/* pwを聞かれるので、マシンのログインで使うのを入れるとスルーします。 ./bin/mysql test と入れると、 Welcome to the MySQL monitor. Commands end with ; or \g. Your MySQL connection id is 3 Server version: 5.1.34 MySQL Community Server (GPL) と出て mysql> となりますが、CREATE TABLE　XX;　とやると ERROR 1044 (42000): Access denied for user ''@'localhost' to database 'XX' が出ます。何かがイケナイんでしょうが、原因が分かりません。ネットも暫く見てみたんですが収穫なしで困っています。どなたか心当たりのある方がいたら知恵を貸してください。宜しくお願いします。m(_ _)m れざ
php+mysql会員制サイトを運営しているのですが レコード数が50000を越えたあたりから容量がでかすぎるためか エクスポートができなくなってしまいました zipで圧縮を選んでもエクスポートすることができません。 現在レコード数は100000なのですが、複数に分割してエクスポートすることでユーザーの登録情報をバックアップしています。 このようにレコード数が増えすぎてしまった場合でも一度にエクスポートするにはどうしたらよいでしょうか？ ご教授頂けると幸いです。 よろしくお願い致します。
複数のフィールドで、指定した数字が入ってる回数を得るSQLの書き方が分かりません。 具体例を書きますと、フィールド名がそれぞれ id,name,kokugo,sugaku,shakai,rika,eigo,created_date となっており、入ってるデータが 1,YamadaTarou,80,100,100,74,100,2009-05-27 となってる場合、このうち「kokugo,sugaku,shakai,rika,eigo」のフィールドに100が入ってる回数を得たいのです（具体例の場合、3を得たい）。 よろしくお願いします。
お世話になっております。 以下のようなテーブルがあったとして、table1,table2の値を参照して加算し、master_tableの値を変更するようなSQLは一つの文で書く方法はありますでしょうか？ 例えば、あるSQLを実行すると、master_tableのid1のscoreが500になるようなSQLです。 どなたかご教授ください。 master_table id | score 1 | 0 2 | 0 table1 id | score 1 | 100 2 | 300 table2 id | score 1 | 400 2 | 100
よろしくお願いします MySQL5を使用しています 現在、レコードに7件入っていて PHPから取り出すときに 10件取り出したいです。 重複していいので7件しかないデータを重複ありで10件をランダムで取得 というのはSQL文で可能なのでしょうか？ それともPHPから制御するしかないのでしょうか？ 以上よろしくお願いします
x86_64環境のMySQLversion3.23.58の入手先を教えて頂きたいです。 さんざん探してみたものの見つからなくて困っております。 ネット上のみでなく、書籍に付属しているCDに入っているものなどが あるようでしたらそちらも教えて頂きたいです。 どうかよろしくお願い致します。
レンタルサーバーのロリポップを使っているのですがmysqlの対応がバージョン4.0.24なのですが現在入手できるサイトございましたら紹介お願いします。探しているのですがなかなか見つかりません。 またバグ管理ソフトのmantisを使おうと思っています。 mantisに詳しい方もおりましたら詳しい設置方法も教えてくださると助かります。宜しくお願いします。
MySQL4.1.21です。 データベースを別のサーバに移しているのですが、dump→dumpファイルのリストアが上手くいきません。 移すほうのサーバでデータベースを作り、 mysql -u [ユーザー名] -p[パスワード] [データベース名] > [dumpファイル名] としたのですが、それを実行するとdumpファイルが空(サイズが0KB)になってしまうのです。 以前はこの方法で問題なく移せたのですが・・・。原因の分かる方おられましたらご教示お願いいたします。
CentOS5.2,　MySQL version: 5.0.45 を使用しています。 現状のユーザ権限は次のようになっています。 mysql> use mysql Database changed mysql> select host, user, select_priv, insert_priv, update_priv, delete_priv from user; +-----------+---------+-------------+-------------+-------------+-------------+ | host | user | select_priv | insert_priv | update_priv | delete_priv | +-----------+---------+-------------+-------------+-------------+-------------+ | localhost | root | Y | Y | Y | Y | | abcd | taro | N | N | N | N | +-----------+---------+-------------+-------------+-------------+-------------+ これを　スーパーユーザで入り、 mysql> grant all privileges on DB.* to 'taro'@'abcd' identified by 'password' with grant option; Query OK, 0 rows affected (0.00 sec) mysql> flush privileges; Query OK, 0 rows affected (0.00 sec) として終了し、クライアントから接続しなおしましたが、taroの権限が Y になりません。 どうすれば　Y にすることができるでしょうか？
DBの勉強中です。課題の補助的にこちらで質問しているので、ヒント、キーワードだけいただけると有り難いです。 MySQLのスキーマ(INFORMATION_SCHEMA)と同じ、あるいは類似した機能がMySQL*以外*のDBMSにあるか知りたいのですが、今のところ手がかりが掴めません。DBMSの名称とか該当する機能の名前など、ご存じでしたら教えてください。(課題はその先の比較と考察を要求しているので、そこは自力でやります。) どうぞ宜しく。 れざ
phpMyAdminをインストールし、rootにもパスワードを付与したのですが、root以外phpMyAdminでどんなIDでもログインできてしまいます。 でたらめなIDを入力しログインを押すと問題なくログインできてしまいます。 どのようにしたらrootや作成したユーザーのみログインできるようにすることができるのでしょうか？
はじめまして。 早速ですが、とても困ってます。 テーブル「tbメール文」 | field | type | null | key | defult | Extra | | 送信ID | bigint(20) | × | pri | null |auto_increment| | 送信文 | TEXT | × | | null | | テーブル「tbメールアドレス」 | field | type | null | key | defult | Extra | | Eアドレス |varchar(64) | × | pri | null | | | 登録日 |timestamp | × | | null | | テーブル「tb送信リスト」 | field | type | null | key | defult |Extra| | 送信ID |bigint(20) | × | pri | null | | | Eアドレス|varchar(64)| × | pri | null | | (1)メールを誰にアドレスに送ったか管理したいです。（「tb送信リスト」を作りたい） (2)「tbメールアドレス」の登録日を固定値で検索にかけ（プログラム処理）、引っかかった複数レコードをSELECTします。 (3)送信IDは「tbメール文」の送信IDの最大値を固定ですべて(2)で作った全レコードに紐付ます。 (1)(2)(3)を踏まえ、「tb送信リスト」にINSERT～SELECTで一気に入れたいです。 出来るだけやったSQL文載せます。 INSERT INTO tb送信リスト (送信ID, Eアドレス) SELECT MAX(tbメール文.送信ID), tbメールアドレス.Eアドレス) FROM tbメール文, tbメールアドレス よろしくお願します。
例えば、「example.sql」というファイルに以下の二行が書いてあるとします。 create database aaa; create database bbb; これらをmysqlコマンドラインではなく、linuxのコマンドラインから「example.sql」を読み込んで、まとめて実行するにはどうしたらいいでしょうか。
例えばこんな感じでクエリを書くと、 SELECT id, name, 'xx' FROM test_table WHERE 1 結果は、3列目の'xx'はタイトル行から全ての行の値まで'xx'になります。 id　　name　　xx 1　　 aaa　　　xx 2　　 bbb　　　xx 3　　 ccc　　　xx これを、値のみにしてタイトルには別の文字列を出したいです。 タイトルと値といった形で固定値の指定はできますか？ こういう結果にしたいです。 id　　name　　test 1　　 aaa　　　xx 2　　 bbb　　　xx 3　　 ccc　　　xx
XAMPPでMySQLをインストールしたのですが、設定ファイルのmy.cnfが見あたりません。 Windowsの場合、どこフォルダーにあるのでしょうか？
mysqlで既に入っているDATE型の値を置換したいのですが どうしたらよいのかわからなくて困っています。 行いたい事 2000-11-20　となっている値を 2000-01-01　の様に年をそのままに月日だけを01-01に置き換えたいのです。 そのカラム全てのデータを1月1日に置き換えたいです。 updateとreplaceを用いたら良いのかと思い以下の様なSQL文を作りました UPDATE tablename SET startdate = REPLACE( startdate,"%y-%M-%d","yyyy-01-01"); これで合ってますでしょうか。 多分間違ってると思うんですが、どう間違ってるのかもわかりません。 初心者の教えて君で申し訳ないのですが、お願いします。
※部分一致検索ができなくて困っています。 ※Apache2.0.52 + MySQL 5.0.51a + PHP5.2.8の環境です。 " sprintf "を使った、下記コードで部分一致検索をするには、どのようにしたらい いのか、どなたかご教授いただけないでしょうか。 -------------------------------------------------------------------------- $u_address = $_REQUEST['u_address'];// POSTで送られてきた値を受け取り変換。 検索fieldは、"u_address"です。 -------------------------------------------------------------------------- $query = sprintf("SELECT * FROM dive_free_tbl_ WHERE u_address = '%s' ORDER BY serial DESC", $u_address); ※上記のコードだと、"完全一致"にて検索となります。(部分一致の検索にしたい) 下記のコードに変更して、見たのですがエラーにでダメでした。(WHERE以下を抜粋) WHERE u_address = '%s' ORDER BY serial DESC", LIKE'%$u_address%'); WHERE u_address = '%s' ORDER BY serial DESC", LIKE'[%$u_address]%''); WHERE u_address = '%s' ORDER BY serial DESC", LIKE'{%$u_address}%''); WHERE u_address '%s' ORDER BY serial DESC", LIKE'%$u_address%'); WHERE u_address '%s' ORDER BY serial DESC", LIKE'[%$u_address]%''); WHERE u_address '%s' ORDER BY serial DESC", LIKE'{%$u_address}%''); " sprintf "を使わず、下記のコードでは問題なく部分一致検索ができます。 -------------------------------------------------------------------------- $sql = "SELECT * FROM dive_free_tbl_ WHERE u_address LIKE'%東%'"; -------------------------------------------------------------------------- 何方かご教授いただきたく、よろしくお願いします。 以上
phpとmysqlを連携させデータを取得しています。mysql5です。 現在は2つのテーブルからデータを取得するため以下のように2回のsql文を発行しています。 $sql = 'SELECT products_id, name, products_flag, comment1, IF("' . $products->beforedays . '" < DATE(create_date), "1", "0") as new, FROM products WHERE status = ? AND del_flg = ? ORDER BY create_date DESC'; // 1回目のsqlで取得したproducts_idを参照し下記のsqlを実行 $sql = 'SELECT MIN(price1) as min_price1, MAX(price1) as max_price1, MIN(price2) as min_price2, MAX(price2) as max_price2, IFNULL(price2, price1) as price0, stock FROM products_class_detail WHERE products_id = ?'; これを1回のsqlにまとめる場合どのような書き方になるでしょうか？ 自分なりに下記のようにしてみたところ動作はするのですが複数のデータが条件に 当てはまるはずがminとmaxがあるためか条件に当てはまる最後のデータのみしか 取得されませんでした。 ※試しにmin,maxを外すと複数のデータを取得できました。 $sql = 'SELECT products.products_id, products.name, products.products_flag, products.comment1, IF("' . $products->beforedays . '" < DATE(products.create_date), "1", "0") as new, MIN(products_class_detail.price1) as min_price1, MAX(products_class_detail.price1) as max_price1, MIN(products_class_detail.price2) as min_price2, MAX(products_class_detail.price2) as max_price2, IFNULL(products_class_detail.price2, products_class_detail.price1) as price0, products_class_detail.stock FROM products, products_class_detail WHERE products_class_detail.products_id = products.products_id AND products.status2 = ? AND products.del_flg = ? ORDER BY' . $where_sql; 商品の情報を取得するsqlで最後のorder句は商品の並び順の変更でユーザーの指定した 順番(新着順や価格順等)で表示するためのものです。 2回のsqlの場合は問題なく動作していたのですがで新着順や価格順に並び替えを行うため 1回のでsqlで行いたいと思っております。 新着順の場合は1回目のsqlに条件が入るので問題ないのですが価格順の場合は2回目の sqlに条件が入るので2回のsqlではうまく並び替えができませんでした。 ソースの短縮にもなり可能であれば1回のsqlで完結させたいのですがどうすればいいものか わからずつまづいております。 詳しい方がいらっしゃいましたら宜しくお願い致します。
MySQL+ PHPについて質問です。 商品リスト(テーブルA)から、商品名で関連付けられたユーザー評価（テーブルB）があったとします。 ユーザーが商品ページから評価を5段階でを入れれるようにしました。 商品一覧のページで商品リスト(テーブルA)を表示させ さらにユーザー評価の平均を一緒にテーブルAの商品名から関連付けるように表示させたいのですが、どうやったらいいのでしょうか。 イメージは下記の通りです。 --------------------------------------------------------------- 商品名（テーブルA） ∥ 商品説明（テーブルA） ∥ 商品ランク（テーブルB） --------------------------------------------------------------- オレンジ ｜ おいしい ｜ 評価5 --------------------------------------------------------------- りんご ｜ おいしい ｜ 評価4 --------------------------------------------------------------- 試したSQL文は以下の通りです。 "SELECT title, avg(rank) as avgrank FROM テーブルB group by title join テーブルA テーブルA .title = テーブルB.title"; 残念ながらエラーなのですが、正しくはどう書くのでしょうか。 単純にユーザーが1人であればそのまま結合できるのですが、同じタイトルのものの評価を平均しないといけないため、頭がおかしくなりそうです。
MySQL初心者です。 以下のようなテーブルを作ろうかと考えています（PHP経由） ====================== id　　　filename 1　　　　1.jpg 2　　　　2.jpg 　　・・・ ====================== 要はオートインクリメントで得たidを別のカラムでも活用したいのです。 とりあえず考えたのは、 １）　insert　で　id　を書き込む ２）　last_insert_id()　で　id　を得て　update　で　filename　を書き込む・・・ といったところですが、２段階作業というのが気になります。 「一発で」できる方法があるならそうしたいのですが無理でしょうか。 「無理」という回答でも結構です。 お詳しい方、よろしくお願いいたします。
CREATE TABLE等で出てくる'PRIMARY KEY'と'UNIQUE()'の違いが分かりません。 どちらも他の行と同じ値を登録させないためのものと認識しています。 どのように使い分けるのでしょうか。 あとINDEX()について教えてください。 これは挿入や更新のたびに、INDEXにした列の値の順に整列され、探索が高速になるものと認識しています。 これは'PRIMARY KEY'や'UNIQUE()'の列に対してもやらないといけないのですか。 テーブルは'PRIMARY KEY'や'UNIQUE()'に設定した列の値を基に随時整列されていると思っていたのですが・・・。 あと複数の列へINDEX()を設定することはできるのでしょうか。 その場合、どの列の値が優先的に整列されるのでしょうか。 複数列へINDEX()を設定するCREATE TABLEの書き方を、よろしければ教えてください。
最終的に集計を行いたいのですが、 集計対象のデータの抽出と実際の集計のやり方がいまいちピンときません。 ご教示頂けますでしょうか。 テーブルはこうなっております。 *** test_table ***** id　　order_id　　price　　date 1　　　aaa　　　100　　　2009 4/1 00:00 2　　　aaa　　　200　　　2009 4/4 00:00 3　　　aaa　　　150　　　2009 4/9 00:00 4　　　aaa　　　400　　　2009 5/9 00:00 5　　　ccc　　　900　　　2009 3/1 00:00 6　　　ccc　　　500　　　2009 4/5 00:00 7　　　ccc　　　200　　　2009 4/7 00:00 8　　　www　　　100　　　2009 4/1 00:00 9　　　www　　　200　　　2009 4/9 00:00 １．order_idが同じものの中で一番若いdateが 2009/4/1 00:00-24:00 である order_id の取得 　⇒1行目と8行目が該当するので、「aaa」 と 「www」 を取得。 ２．１のorder_id で、dateが、2009/4/1 00:00 - 2009/4/30 24:00 の期間である price の合計値の取得 　⇒order_id=aaaの時、1～3行目が該当するので、「450」、 　　order_id=wwwの時、8～9行目が該当するので、「300」を取得。 可能であれば、以上２つのことを１つのクエリで発行できるのかということも知りたいです。
mysqlのクライアントから、create procedure文を入力し、表示するとコメントが消えてしまいます。 （例） >delimiter // >CREATE PROCEDURE abc() >BEGIN >#comment >SELECT "A"; >END; >// >SHOW CREATE PROCEDURE abc; >// +-----------+----------+---------------------------------------------------------------------------+ | Procedure | sql_mode | Create Procedure | +-----------+----------+---------------------------------------------------------------------------+ | abc | | CREATE DEFINER=`root`@`localhost` PROCEDURE `abc`() BEGIN SELECT "A"; END | どうしたらコメントが入れられるか、どなたかお知恵をお貸しください。 mysqlのバージョンは 5.1で、OSはRedHat EL5です。 どうぞよろしくお願いいたします。m(__)m
いつもお世話になっております。 PHPとMySQLでアプリケーションの作成をしています。 MySQLでのビット計算で検索結果を表示しようとしています。 ■PHPファイルにはチェックボックスで、約70個の項目が表示されています。 ■データベースには「0」と「1」で以下のように登録されています。 　00011・・・・・1110 ■チェックされた場合は「1」、チェックされていない場合は「0」 　PHPファイルからsubmitされたときに、↑の条件でデータを生成します。 ■一致したものが1つでもあれば検索結果に表示します。 　00011・・・・・1110（データベースのデータ） &00010・・・・・0000（submitされたデータ） ------------------------ 　00010・・・・・0000 上記のようにしたい場合、SQL文はどのように記述したらよろしいでしょうか。 ご教示よろしくお願いいたします。 ＜環境＞ MySQL：4.1.20 PHP：4.3.9
phpMyAdminのみで文字化けするのですが、どういった原因が考えられるでしょうか？ また、そもそもこういうことって、あり得るのでしょうか ＜環境＞ ・MySQL5.1.22-rc ・レンタルサーバー(phpMyAdmin - 2.10.1) ・WindowsXPのパソコン ・PHPの書籍に添付されていたサンプルプログラム ＜経緯＞ １．元々は、EUC-JPで保存されていたPHPのサンプルプログラムなのですが、 UTF-8で保存すれば、mb_convert_encodingしなくてもすむのではないかと思い、、 UTF-8で保存しなおしました。 ２.レンタルサーバーへSSH接続して、「テーブル作成」と「データ流し込み 」のコマンドを実行しました。 ３.ブラウザで、サンプルプログラムの動作確認を行ったところ、日本語で データの新規登録・更新・削除が無事行えました。 また、表示も問題なく行われていました。 ４．phpMyAdminを使い、データベースへアクセスしてみたところ、 何故かデータがすべて文字化けしていました。 ５．phpMyAdminでエクスポートしてみたのですが、データは文字化けしたままでした。 ６．データが壊れたのかと思ったのですが、ブラウザで、サンプルプログラムの 動作確認を再度行ってみたところ、日本語で正常に動作しています。 そういうものなのでしょうか。 ＜その他＞ ▼UTF-8で保存しなおした内容 $sql = mb_convert_encoding( $sql, "SJIS", "EUC-JP");となっていた箇所を削除しました。 また、 <META http-equiv="Content-Type" content="text/html; charset=Shift_JIS">となっていた箇所を <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />へ変更し、 ファイルを自身を、UTF-8で保存しなおしました。 ▼MySQL の文字セット: UTF-8 Unicode (utf8) ▼MySQL の接続照合順序: utf8_unicode_ci
お世話になります、 さくらのレンタルサーバを使っているのですが テーブル更新時に更新対象テーブルにロックを かけようとして、動作確認をしているのですが phpmyadminから lock tables *** writeを実行した後 select文を発行するとそのままselectが 動いてしまうのですが、なにかテーブルロックに 関して間違った理解をしているのでしょうか？ 伝票ＮＯテーブルのようなものは重複を防止する為に 排他かけないと駄目だと思うのですが、 それとも更新クエリが発行された時に自動で 排他制御がかかるのでしょうか？ わからなくなってきました。 宜しくお願いいたします。
ポイントテーブルのPoint.createdをGroupByして 日付毎のPoint.user_idをcountして出しました。 しかし、集計の期間内で重複しないPoint.user_idを countしなければいけなくなったのですが 日付でGroupByした結果から期間内の重複Point.user_idを省いた countは1クエリで可能でしょうか？ ヒントでかまわないのでお助け願います。
お疲れ様です。 いつもお世話になっております。 負荷分散といっても、かなり基本的な話になりますが、よろしくお願いします。 今顧客管理システムAが稼動しており、1000万件のデータがDB_Aに入っています。 このシステムAの基幹部分を使い、類似した別のシステムBを作るのですが、 DB_Aの検索だけで結構負荷が掛かっているので、DB_Bを作って、システムBのデータを入れるつもりです。 システムA,Bと平行稼動し、DB_Aに負荷が掛かっている場合は、DB_Bのレスポンスも自然と悪くなるのでしょうか？ そもそもそれはDBの問題よりサーバースペックの問題になるのでしょうか。 システムAのプログラム的な無駄は考えないものとします。 質問が抽象的で申し訳ないですが、自分が説明できるのはこんな具合です。
MySQL 4.0系(4.0.27)のソースファイル、もしくは、下記のRPMファイルを探しております。 MySQL-shared-compat-4.0.27-0 MySQL-bench-4.0.27-0 MySQL-server-4.0.27-0 MySQL-devel-4.0.27-0 MySQL-embedded-4.0.27-0 MySQL-client-4.0.27-0 ※インストールしたいOSは、FedoraCore2です。 いろいろとGoogleなどで検索したのですが、見つかりませんでした。 どうしても入手したいため、質問させていただきました。 どうぞ宜しくお願いいたします。
PHPとMySQLを組み合わせて、簡単なデーターベースを作っています。 非公開で、それほど多くの人がアクセスするわけではないのですが、同時使用もありえる状況で新規書込みと内容の更新などが同時に発生する状況も考えられます。 通常のphpのシステムとかですと、ファイルロックについて、いろいろと書かれているのですが、MySQLシステムでファイルロックについて（テーブルロック？）探してもよくわからないのです。 だれかがinsertやupdateしていると、自動的に排他状態になったりしているのでしょうか？
MySQL5.1とPHP5を使っています。 phpからmysqlのtestテーブルにアクセスして点数順に生徒名一覧を作成したいと思っています。 イメージとしてはこのような感じです。○○○は名前になります。 90点以上 ○○○ ○○○ 80点以上 ○○○ ○○○ ○○○ 70点以上 ○○○ ○○○ ○○○ ○○○ このような一覧を表示するため、下記のように作成したところ上記のような表示をしてくれました。 しかしながら、同じmysql_queryを何度も使っていますし、DBに負担が掛かりそうな気がします(本当に負荷があるのかは分かりませんが・・・) もっとスマートな書き方はないものでしょうか。 よろしくお願い致します。 echo "90点以上"; $rs = mysql_query("select * from test where kamoku = '1' order by tensu desc LIMIT 0, 100;",$conn); while($res = mysql_fetch_array($rs, MYSQL_ASSOC)){ if ($res['tensu'] >= 90){ echo $res['name']; echo "<br>" ; } } echo "80点以上～90点未満"; $rs = mysql_query("select * from test where kamoku = '1' order by tensu desc LIMIT 0, 100;",$conn); while($res = mysql_fetch_array($rs, MYSQL_ASSOC)){ if($res['tensu'] >= 80 and $res['tensu'] < 90 ){ echo $res['name']; echo "<br>" ; } } echo "70点以上～80点未満"; $rs = mysql_query("select * from test where kamoku = '1' order by tensu desc LIMIT 0, 100;",$conn); while($res = mysql_fetch_array($rs, MYSQL_ASSOC)){ if($res['tensu'] >= 70 and $res['tensu'] < 80 ){ echo $res['name']; echo "<br>" ; } }
MySQL初心者です。ご教授よろしくお願い致します。 外部委託設計した装置PCに蓄積されたデータを利用したいと考えています。DBはMySQLです。 装置PCから大容量HDDにMySQLフォルダ毎コピーを取りバックアップとしています。このバックアップデータを利用し、データを参照したいと考えています。 自PCにMySQL(Ver.5.1)をインストールし、外部HDD(USB接続)のDBに接続しようとしたのですが、どのようにしたら良いのかさっぱり分かりません。ちなみに、ユーザー名、パスワードは分かっています。 外部HDDのディレクトリ構成は下記のとおりです。 E\mysql\data--\mysql 　　　　　　 |-\test 　　　　　　 |-\aaa 上記のaaa内にあるテーブルを参照したいのです。 以上の質問内容では不足があるようでしたら、ご指摘ください。 よろしくお願い致します。
すいません。お教えください。 Mysql5.0.15で以下のテーブルを作成した時、数値の最大値(1010)を抽出したいのですがどのようにすれば抽出できるのでしょうか？お教えください。 テーブル名：B フィールド名,フィールドタイプ,備考 b_id,int(10),auto_increment b1,varchar(10) b_id,b1 1,999 2,1000 3,1000-1 4,1010 5,800 重ねて質問させてください。 select max(b1) from b;とした場合 999としか表示されません。 これもなぜなんでしょうか。
aaa.bbbのように、TABLE名に.（ドット）を使いたいのですが、このままだとエラーが発生してしまいます。 mysql> CREATE TABLE aaa.bbb ( id MEDIUMINT NOT NULL AUTO_INCREMENT, abc varchar(16), xyz varchar(16), PRIMARY KEY (id) ); ERROR 1049 (42000): Unknown database 'aaa' .（ドット）をエスケープするにはどうすればよいでしょうか？ ちなみに\（バックスラッシュ）を.（ドット）に前置してもエラーになってしまいます。
ＳＱＬからＣＳＶで電話番号（03,1111,2222)をダウンロードすると「3」「1111」「2222」のように出力されます。これをCONCAT( tel01 , tel02 , tel03)で結合すると「311112222」のように出力されます。「03-1111-2222」のように出力する方法はありますか？
MySQL5.1がインストールできず、打つ手がなくなり困ってます。 詳細を以下に示しますので宜しくお願いします。 【環　境】 OS　　　：WindowsXP HomeEdition メーカー：FUJITSU FMVシリーズ セキュリティーソフト：ウイルスセキュリティZERO 【問　題】 以前MySQL(バージョン不明）を使用しており、その後FMV付属ツールの「マイリカバリー」を使用してリカバリーをしました。その際にMySQL等のアンインストール等はしていません。 リカバリー後MySQL5.1をインストールしようとしたところ、 Start service のあたりで「Could not start the service MySQL.Error:0」になります。 【対　応】 このエラーの対応として、ネット等で検索して次の方法を試みましたが解決できませんでした。 ・コマンドプロンプトからサービスの削除（"C:Program Files\MySQL\MySQL Server5.1\bin\"mysqld -remove MySQL） ・プログラムの追加と削除（アンインストール） ・my.iniの検索（あれば削除） ・環境変数(MySQL)の削除 ・Cドライブのクリーンアップ ・C:WINDOWS\Prefetch\の中のMYSQLD.EXE-15857137.pfとMYSQLINSTANCECONFIG.EXE-2EBFA1E3.pfを手動で削除 ・Cドライブの隠しファイルの中の(C:Document and Settings/AllUsers/Application Data/MySQL)を削除 ・再起動 以上、上記の作業を行いましたがインストールの完了ができず、困り果てています。 他に解決する方法がございましたら、ご教授願います。
データベースはUTF8でなぜテーブルはsjisで作成しますか？ UTF8で統一して作るとなにか問題がありますか？ PHPなどのファイルはUTF8で作成しているのに、 なぜテーブルデータはsjisで作成するのか意図がわかりません。 簡潔に説明できる方、教えてください。
windows Vista 64bitで　mySQL ver14.14 for 32bit win を最近導入しました。 非常に初歩的なステップなのですが、テキストファイルからテーブルにデータを入れると文字化けが起こってしまい、困っています。 mysql> create database user_db ; mysql> use user_db; mysql> create table mytable( -> name text, -> sex text, -> addr text -> ); テキストファイル(input_data.txt)はutf-8、unix format(これは改行コードのことだと思います)で abcdfemaleamsterdam efghmaledetroit ijklmaletokyo というふうに作成し、 mysql> load data infile 'C:/input_data.txt' -> into table mytable; mysql> SELECT name,sex,addr FROM mytable; とすると +-------+------+-----+ |name___|sex___|addr_| +-------+------+-----+ |???abcd|female|amsterdam |efgh___|male__|detroit |ijkl___|male__|tokyo と一行目のデータのはじめの値の???部分がアルファベット以外の妙な文字３文字に置き換わります。　２行目３行目は問題ないようです。 文字コードの設定はconfig wizardでutf-8としており、 mysql>status で server characterset:utf-8 Db characterset:utf-8 Client characterset:utf-8 Conn. characterset:utf-8 と表示されます。 また、いろいろ試したところテキストエディタで入力ファイルをwindowsフォーマットで保存すると１行目に加え、２行目も文字化けするようです。 改行コードに関係することなのかもしれませんが、原因・解決方法がわかりません。 どなたか解決方法がわかりましたらアドバイスよろしくお願いします。
ロリポップサーバーでMYSQLを使用しております。 オリジナルのブログのようなものを設計し、投稿画面から投稿できるようにしたのですが。 ローカルで問題なくinsertできたテーブルが、サーバー上でinsertしたところentry_idのみが増えその他は空白になります。 不思議なことに同じロリポップでも別のアカウントで取得したサーバーでは問題なくinsertでき、記事の記入ができます。 phpmyadminの設定がおかしいのでしょうか。 同じような症状の方おられれば対処法教えてください。
サーバーAとサーバーBがあって、 rsyncで、サーバーBのMySQLのvarディレクトリ内をサーバーAと同じにしているのですが、 実際にSELECT文などで確認すると、同じになっていません。 このやり方は、不可能なのでしょうか？ レプリケーションは使わない方向で、行きたいのですが。。。 ご教授、宜しくお願いします。
<? include "config.php"; $Data = '<form action=register.php method=post> Login: <br><input type=text name=login><br><br> Password:<br><input type=password name=passwd><br><br> Repeat password:<br><input type=password name=repasswd><br><br> Email:<br><input type=text name=email><br><br> <input type=submit name=submit value="Registration"> </form>'; if (isset($_POST['login'])) { $Link = MySQL_Connect($DBHost, $DBUser, $DBPassword) or die ("Can't connect to MySQL"); MySQL_Select_Db($DBName, $Link) or die ("Database ".$DBName." do not exists."); $Login = $_POST['login']; $Pass = $_POST['passwd']; $Repass = $_POST['repasswd']; $Email = $_POST['email']; $Login = StrToLower(Trim($Login)); $Pass = StrToLower(Trim($Pass)); $Repass = StrToLower(Trim($Repass)); $Email = Trim($Email); if (empty($Login) || empty($Pass) || empty($Repass) || empty($Email)) { echo "All fields is empty."; } elseif (ereg("[^0-9a-zA-Z_-]", $Login, $Txt)) { echo "Login have a incorrect format."; } elseif (ereg("[^0-9a-zA-Z_-]", $Pass, $Txt)) { echo "Password have a incorrect format."; } elseif (ereg("[^0-9a-zA-Z_-]", $Repass, $Txt)) { echo "Repeat password have a incorrect format."; } elseif (StrPos('\'', $Email)) { echo "Email have a incorrect format."; } else { $Result = MySQL_Query("SELECT name FROM users WHERE name='$Login'") or ("Can't execute query."); if (MySQL_Num_Rows($Result)) { echo "Account <b>".$Login."</b> is exists"; } elseif ((StrLen($Login) < 4) or (StrLen($Login) > 10)) { echo "Login must have more 4 and not more 10 symbols."; } elseif ((StrLen($Pass) < 4) or (StrLen($Pass) > 10)) { echo "Password must have more 4 and not more 10 symbols."; } elseif ((StrLen($Repass) < 4) or (StrLen($Repass) > 10)) { echo "Repeat password must have more 4 and not more 10 symbols."; } elseif ((StrLen($Email) < 4) or (StrLen($Email) > 25)) { echo "Email must have more 4 and not more 25 symbols."; } elseif ($Pass != $Repass){ echo "Password mismatch."; } else { $Salt = $Login.$Pass; $Salt = md5($Salt); $Salt = "0x".$Salt; MySQL_Query("call adduser('$Login', $Salt, '0', '0', '0', '0', '$Email', '0', '0', '0', '0', '0', '0', '0', '', '', $Salt)") or die ("Can't execute query."); echo "Account <b>".$Login."</b> has been registered."; } } } echo $Data; ?> 上のスクリプトで登録をしてphpmyadminで登録されたデータを見ると、 パスワードが空になっていたり文字が化けた1文字とかになって書き込まれています。 PHP上で何か問題があるのかと <?php $str = 'test'; if (md5($str) === '098f6bcd4621d373cade4e832627b4f6'){ eco "MD5OK"; exit; } ?> のように書いてみると正常にMD5OKと出ますのでデータベース側に問題があるような気がします。 どうしたら正常に書き込まれるようになるか分かる方いらっしゃいませんでしょうか？
wordpressのデータが多くてインポートが出来なくなりました。 （容量制限） sshでログインをしてあげるといいらしいのですが、無知のためわかりません。 そこでsqlファイルを分割してアップ使用と思いまして、１０万行ぐらいあり手動で分割をすると結構な時間がかかるので、自動で分割してくれるソフトはないでしょうか？ テキストエディタでもかまいません（決まった行数から下を切り取り出来るような機能があればいいです） 分かる方いましたら教えて下さい。 かなり困っています。
現在、PHPでMySQLの操作をテストしています。 Vista上にXAMPPをインストールした環境とXP上にApache,PHPとMySQLを個別にインストールした環境とで検証しています。 どちらの環境でも、テーブルにデータをインサートするところまでは出来ました。 mysql_fetch_array()関数を使ってＳＱＬの実行結果を表示させるところで、XAMPPでは結果を表示できるのですが、個別インストール環境では Warning: mysql_fetch_array(): supplied argument is not a valid MySQL result resource in D:\****\incert.php on line 8 が出てしまいます。 mysql_error()でエラーを表示させたところ No database selected と表示されます。 mysql_select_db("db_name"); でDBはせんたくされていると思う（事実、XAMPPでは選択されている）のですが、何が問題なのでしょうか？
御晩です。 ----------------- <?php //カウント $id= "$k_id"; $id = mb_convert_encoding($k_id,"EUC-JP","SJIS"); $id_count = $DB->getone("SELECT count(*) FROM ".$k_koukoku_log_table." ".$k_koukoku_inp_table." where a_num =$k_id"); ?> カウント数は<?=$id_count?>です。 ----------------- 上記は重複もカウントされてしまいます。 ユーザー個々に広告番号があり（＄k_id）、その広告番号をクリックされた回数を同一人物（重複）を除いてのカウントを表示したいと思っています。
前の質問 http://oshiete1.goo.ne.jp/kotaeru_vote.php3?q=48 … 他の質問コーナー http://okyuu.com/ja/question/6095 MySQLのデータベースを作成するために、csvファイルをつくって、シェルでテーブルに取り込みたいと思っています。前のスクリプトを書き直したので、新規質問という形で書かせて下さい。 【環境】LINUX Fedora10 MySQL5.0 インターネット接続できず、USBメモリでデータを運んでいる。ここのスクリプトもコピペではなく手書き。 #bash torikomi.sh とうつと torikomi.sh: line 19 : syntax error : unexpected end of file とでてきてしまい、うまく処理できません。 ひとまず、Perlなどは使わず、bashのみにて処理を行いたいと思っています。（Perlは知らない言語なので） スクリプト #!/bin/bash set hensu=`cat /home/******/data1.csv` for i in $hensu do set a=`echo $i | awk -F, '{print $1}'` set b=`echo $i | awk -F, '{print $2}'` set c=`echo $i | awk -F, '{print $3}'` mysql --user=root --password=****** db1<<EOF insert into tbl2(aaa,bbb,ccc) values($a,"$b","$c"); EOF done
【環境】LINUX Ferora10 mysql 5.0 インターネット接続できないＰＣ（データはUSBメモリで導入可能） bash/mysql初心者 教えてgooの参考ページ ​​http://oshiete1.goo.ne.jp/kotaeru.php3?q=2219411​​ mysql で db1 というデータベースに、tbl2というテーブルを作成しました。ここにcsvファイルから、データをインサートしたいのですが、うまくいきません。 これはうってみたコマンド #bash torikomi.sh エラーは syntax error near unexpected token '(' insert ～文 とかがでます。 下記にソースを貼るので間違いがあったら、教えていただけないでしょうか？ #!/bin/bash set hensu='cat /home/******/data1'; for i in $hensu do set a='echo $i | awk -F, '{print $1}'' set b='echo $i | awk -F, '{print $2}'' set c='echo $i | awk -F, '{print $3}'' mysql --user=root --password=******* 　　 use db1; insert into tbl2(aaa,bbb,ccc)values(a,"b","c"); exit done できれば、バックグラウンドでMySQLを起動して、いちいちログイン/ログアウトを繰り返さず、 インサート文を打てればいいのですが。
はじめまして。いつも皆さんの質問・回答を見て勉強させていただいてます。 今、DBを使ったJavaの検索システムを構築しており、検索時の効率を上げる為のデータとして、検索時に要した時間を表示させたいと思っております。 また、それは全体（SQL文を実行する）に要した時間ではなく、データ一つを検出するのにどれだけ時間を要したか？という値を知りたいのです。 つまり、クエリ実行の結果ではなく、SQL文1つの結果に「Aichi,Gifu,Tokyo」が該当したとして、それぞれをテーブルから探し出した各々の時間を計りたいのです。 イメージとしては下記のようになります。 データ名　｜　検索時間(sec) Aichi　　　| 1.23 Gifu　　　 | 0.23 Tokyo　　　| 3.53 環境としては Java:jdk1.6.0_13 MySQL:ver5.5 です。 以下の点を考慮しましたが、壁にぶつかってしまいました ・insert文で新たに検索時間を格納するフィールドを作る(検索ごとにデリート、インサートしてたらキリがない) 以上、ご指導よろしくお願いします。
　MySQLを使用してアフィリエイト目的のサイトを作成しようと考えているのですが、商用利用だとやはりライセンス料のようなものが発生するのでしょうか？　 　色々調べてみたのですが、発生する、しない、の他に使用料に関しての意見もまちまちだったため、詳しい人は教えてくれると助かります。 　また、使用料について載っているＵＲＬを教えてくれると、なお助かります。
Webページのフォームを使い，MySQLデータベースにSQLインジェクションを実行しようとしています． 環境はもちろんローカル環境です． テーブルはこのようになっています． mysql> DESC member; +-------+--------------+------+-----+---------+----------------+ | Field | Type | Null | Key | Default | Extra | +-------+--------------+------+-----+---------+----------------+ | no | int(11) | NO | PRI | NULL | auto_increment | | name | varchar(100) | NO | | | | +-------+--------------+------+-----+---------+----------------+ JSPページのソースの一部はこのようになっています． PreparedStatement ps = db.prepareStatement("INSERT INTO member(no, name) VALUES(" + no + ",'" + name + "')"); noに 12 nameに name'); DELETE FROM member; -- という入力を与えると INSERT INTO member(no, name) VALUES(12,'name'); DELETE FROM member; --') となり，テーブルのデータを全て消去できると考えましたが，文法エラーとなるらしく，消去されません． com.mysql.jdbc.exceptions.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '; DELETE FROM member; --')' at line 1 この場合，ソース・フォーム入力内容・データベースなどのどの箇所をどのように修正すれば良いでしょうか？
バージョン管理データベースを作ろうとしています。 Anhttpd 1.42p Anhttpd 1.42o Anhttpd 1.42n 一太郎 10 一太郎 9 最新バージョンのみを絞り込みたいと思い、GROUP BYで抽出を試みました。 バージョンは末尾に英字を含むので文字列型にするしかなく、そうすると最大値のみ抽出とすると10より9が大きいということになってしまいます。 何かよい案はないでしょうか。
select文で、datetime型のカラムを取得する際に、特定の時間を加算して取得したいのですが、どのような書式になりますでしょうか、ご教授お願いします。 例 select ( datetime + '01:00:00') from user 時間単位の加算のみです
mysqlのテーブル単位でのバックアップ／インポートの方法を 教えてください。 mysqlのデータベース　 abc テーブル名 dfg 試しに下記内容をやってみたいですが、コマンドラインからの 方法を詳しい方ご教授頂けませんでしょうか？ abc データベース中のdfgのテーブルのデータを abcのコピーDBのabc2というデータベース中のdfgへインポート更新 させたいのですが、DB単位でのバックアップはわかるのですが、 テーブル単位でのコマンドラインがわかりません。 どなたかわかられる方ご教授頂けませんでしょうか？ よろしくお願いいたします。
MySQLのインサートに関して質問です。 2つの値を登録したい場合、 下記のように対応すれば、 データの挿入は通常どおり完了しますが、 insert into テーブル名 (フィールド1, フィールド2) values (値1, 値2); ￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣ 私の場合は、 「ken_name」と「machi_name」という変数を、 上記でいうところの、 「値1」と「値2」に入力したいと思っています。 変数の指す部分は、 それぞれ30文字程度の英数字です。 プログラム内で、 以下のように、 インサートのクエリー処理を行ってみたら、 DB接続も正常に出来ているし、 エラーとかも一切出ていないのですが、 DB内のテーブルに何も登録されていませんでした。 insert into テーブル名 (フィールド1, フィールド2) values (ken_name, machi_name); ￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣ やり方としては、合っていますでしょうか？ 何かアドバイスいただけると嬉しいです。 宜しくお願い致します。
初心者です。教えて下さい PHP+Pearで検索取得して 文字列型、数値型は表示出来るのですが、 DateTime型の表示がされません。文字列に変換する必要があるのでしょうか？どうすればよいですか？ よろしくおねがいします。 <?php //省略 print("更新日時：" . $data['updateddatetime'] ); //省略 ?>
いいやり方があれば、おしえてください。 テーブルA************** みかん　おいしい　100個　静岡産 りんご　赤い　　　20個　青森産 きゃべつ　春物　　10個　北海道産 テーブルB************* みかん　まずい　30個　静岡産 りんご　赤い　　20個　新潟産 このような二つのテーブルがあるとして、 検索によって、Aテーブルにないもの（きゃべつ）と、 さらにAテーブルとBテーブルの品物名は同じだけど、産地や個数や味評価がことなるものを取り出すSQL構文はありませんか？ （紐付けは品物名でします） 希望する結果はこうです。 結果**** みかん　おいしい　まずい　100個　30個　　NULL(等しいので）　NULL りんご　NULL　　NULL　NULL　　NULL　青森産　新潟産 きゃべつ　NULL　春物　NULL　10個　NULL　北海道産　NULL ちなみに、対象の項目は、本当は100個ほどあるのですが・・・。 どうぞよろしくお願いします。
こんにちは。 MySQLを使い始めたのですが、 テーブルを作成するという初歩的な部分で、 どうしても自分では分からなくなってしまい 質問させていただきます。 create databaseを行った後、 普通にテーブルを作成しようとしただけではあります。 作成しようとしたテーブルは、 keyというカラムとvalueというカラムの 計2つからなるテーブルです。 しかし、 カラム名の1つを「key」ではなく「time_to_get_the_key」で行うと、 正常にテーブルが作成されるのに、 mysql> CREATE TABLE 20090413_put1(time_to_get_the_key VARCHAR(100), value VARCHAR(100)); Query OK, 0 rows affected (0.01 sec) 同じカラム名を「key」でテーブル作成しようとすると、作成ができないでいます。 mysql> CREATE TABLE 20090413_put1(key VARCHAR(100), value VARCHAR(100)); ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'VARCHAR(100), value VARCHAR(100))' at line 1 本来は、 「key」と「value」というカラムで、 それぞれ100文字以内で収まる文字列を カラムに挿入させるつもりでした。 何か御意見いただけるとありがたいです。 宜しくお願い致します。
テーブルA(no) テーブルB(no, type) の二つのテーブルがあるとします。 テーブルAは空です。 テーブルBは、例として 1, A 2, B 3, A 4, B 5, B というデータが入っているとします。 テーブルBでtypeがAになっているnoを全てテーブルAにINSERTしたいです。 この場合、どう書けばいいですか？
PHP5 Mysql5 で、運用しています。 現在は複数のメールアドレスにそれぞれにメールを出していますが、 送信時間を設定できるように変更しています。 【現在】 $sql =" select * from member order by id" ; $rst = mysql_query($sql, $con); ココはテーブルで一覧で出して、[checkbox]で 選択できるようにしています。 while($rows = mysql_fetch_array($rst)) { ・ ・ <input name=\"mailid[{$i}]\" type=\"checkbox\" value=\"".$rows["id"]."\" checked> ・ ・ mb_send_mail($to, $title, $honbun, "From:$from"); } これを発信時間を設定して送りたく変更をしています。 【フォームから受信】 $mailid= $_POST["mailid"]; //チェックボックスにチェックを入れると送信 $title= $_POST["title"]; $honbun= $_POST["honbun"]; $mon= $_POST["mon"]; $day= $_POST["day"]; $time= $_POST["time"]; メールの送信フォームから上記データを送って、もう一度ココで 送信フォームページと同じように　[while] で[mail] を取りだして 送信予定日時、タイトル、本文、送信先メールアドレス をmysql に保存したいのですが、送信先メールアドレスはどのように保存したらいいのでしょうか？ 一つのフィールドに sample@sample.com,sample@sample.com,sample@sample.com,sample@sample.com, このように全部入れていいのでしょうか？ **最大500件ほどになります その後、cron で　php を動かして日時でマッチした列を送信するように しようと思っています。 *このような時にはPHPは使用しないと言うのは読みましたが、PHPしか 　理解できそうに無いので、この方法で実現しようと思っています。 宜しくお願いいたします。
