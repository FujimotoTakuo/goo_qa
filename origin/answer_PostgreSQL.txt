カスタマイズを選ぶと一つのバイオームしか生成できません。 草ブロックの上に、水を敷いて生成させる方法ならあります。 ~~~~~~「-------------------- | 海 |　　　岸 | ________ |_______________ このように生成させる方法はありません。 海バイオームで草原にするという方法はあります。 詳しいことはwikiで。 http://minecraft-ja.gamepedia.com/%E3%82%B9%E3%8 … https://www.google.com/search?q=Minecraft+%E3%83 …
s_cateの型はなに?
エラーではなく、MODを適用したときに出る表示のような気がする。
>オプション→表示→桁　35　OKにしたのですが35文字の約半分の17文字で >折り返されてしまいます。 ちゃんと35字で折り返していますよ。 上に文字数を表すスケーラー出ていますよね？ いわゆる半角換算で35字です。 >指定した文字できちっと折り返すにはどうしたらいいでしょうか？ 全角・半角入り交じりだった場合はどう折り返しするんでしょう？ 画面上の見た目で右端が揃わない折り返しがご所望なんでしょうか？ そういう場合はテキストエディタでは難しいんじゃないですかね。
なぜSEに興味を持っているか、でしょうね。 当然に能力や知識経験（あと体力）が必要ですが どれもこれも本人の「やる気度」が結果に影響する。 もちろん、そっち方向のセンスがない奴はどれだけやる気があってもNGなんだけど ただ単に「保育士という現実」から逃避するためにSEとか言っているならダメでしょうね。 20代で相応のセンスとやる気があると見込まれれば ある程度の試用期間と社内教育を実施するとして 採用している会社もあるとは思いますよ。
http://www.postgresql.jp/document/9.2/html/funct … 正規表現が使えるようなので'[a-zA-Z0-9｡-ﾟ]*'でどうにかすればできそうです。
vacuum fullしてみたらどうだろう。
PostgreSQLではOracleと異なりDDLで自動コミットされないので、基本的にはBEGINとCOMMIT(またはROLLBACK)で囲むのが基本です。 今回のWARNINGは、すでにトランザクションが終了しているのにCOMMIT/ROLLBACKを発行したために発生しています。アプリケーションのコードパスでBEGINとCOMMIT/ROLLBACKが1:1対応になっていない箇所(ROLLBACKしているのにCOMMITもしている、など)があるのではないでしょうか？ また、今回のケースではテーブルが存在しないことが通常ケースとしてあり得るということのようなので、DROP TABLE IF EXISTS <table name>;というDDLを使うのが良いと思います。 ちなみに、PostgreSQLではトランザクション開始後にエラーが発生してもトランザクションは終了せずabort状態に遷移します。この状態では、COMMIT/ROLLBACK以外の全てのSQLがエラーになります。COMMIT/ROLLBACKを実行すると、どちらでもトランザクションはROLLBACKされて終了します。 https://www.postgresql.jp/document/9.3/html/tuto … 参考URL：https://www.postgresql.jp/document/9.3/html/sql- …
PostgreSQL 8.4以降であれば、contribモジュールのcitext型を使うと、大文字小文字の区別のない主キーを定義できます。 【例】 test=# CREATE EXTENSION citext ; CREATE EXTENSION test=# CREATE TABLE ci_sample (key citext PRIMARY KEY, value text); CREATE TABLE test=# INSERT INTO ci_sample VALUES ('abc', 'foobar'); INSERT 0 1 test=# INSERT INTO ci_sample VALUES ('abC', 'foobar'); ERROR: duplicate key value violates unique constraint "ci_sample_pkey" DETAIL: Key (key)=(abC) already exists. PostgreSQLが9.1よりも古い場合は、CREATE EXTENSIONの代わりにSQLスクリプトを実行する必要があります。 【参考】 https://www.postgresql.jp/document/9.0/html/cont … 参考URL：https://www.postgresql.jp/document/9.3/html/cite …
db2 "CREATE TABLE TableA (order_id char(3),product_id char(10), product_name char(20), quantity int)" db2 "INSERT INTO TableA VALUES ('001','product001','商品名１',2),('002','product001','商品名１',1),('002','product002','商品名２',2),('003','product002','商品名２',1),('003','product003','商品名３',1)" db2 "SELECT product_id, max(product_name), sum(quantity), substr(xmlserialize(xmlagg(xmltext(concat(', ',order_id))) as varchar(50)),3) FROM TableA GROUP BY product_id" PRODUCT_ID 2 3 4 ---------- -------------------- ----------- -------------------------------------------------- product001 商品名１ 3 001, 002 product002 商品名２ 3 002, 003 product003 商品名３ 1 003 3 レコードが選択されました。 当方、DB2で実行しています。PostgreSQLで使えればいいのですが。
PostGlSをさわったことがありませんが。 > ST_GeomFromText('POLYGON(( POLYGONのカッコが２重になってますが、1重にしたらどうなります？ 参考URLも見て下さい 参考URL：http://lets.postgresql.jp/documents/tutorial/Pos …
＞　文字列を格納するフィールド型は可変長文字列型にした方がいいのか、固定長文字列型にした方がいいのかです。 varchar 型も可変長文字列なので varchar と text を比べても意味はありません。 固定長と可変長を比べるなら char と varchar を比べなければ行けません。 CPUの性能が良くなり、メモリの搭載量が増え、HDDの読込速度が上がった今となっては、char 型の優位性はあまりないと考えていいでしょう。 データの取扱量が多い環境では、char より varchar の方が資源の有効利用という意味ではメリットが多いかもしれません。 text 型はRDBMSによっては検索時の性能や制限に差があるので、必要最小限にするべきだと思います。 よほど大きな文字列が入る予定が無ければ、varchar(2000) といった感じで varchar 型で大きく取った方が使い勝手がいい場合があります。
postgreSQLのLPAD関数は引数の型が 文字列,数値,不定　となっています。 seq_noが数値なので、文字型でなければ いけないLPADの第1引数に指定すれば、 当然ですが、掲題のようなエラーになります。 関数の意味としては前ゼロを付けて、 shiyo_ketaの示す長さでseq_noを表現 したいのではないかと思います。 lpad()の代わりに、以下の方法を使って 見てください。 to_char(seq_no,repeat('0',shiyo_keta))
INNER JOINに書き換えたのが以下。 q1クエリ SELECT date, Sum(num) AS num, date1, date2 FROM (SELECT Table1.date, Table1.num,Table1.date-1 as date1,Table1.date-2 as date2 FROM Table1 union SELECT Table1.date-1, 0 as num,Table1.date-2 as date1,Table1.date-3 as date2 FROM Table1 union SELECT Table1.date-2, 0 as num,Table1.date-3 as date1,Table1.date-4 as date2 FROM Table1) GROUP BY date, date1, date2; 結果クエリ SELECT q1.date, q1.num+q1_1.num+q1_2.num AS sum_num FROM (q1 INNER JOIN q1 AS q1_1 ON q1.date1 = q1_1.date) INNER JOIN q1 AS q1_2 ON q1_1.date1 = q1_2.date WHERE q1.num<>0;
　……belong_cat_3='10086', belong_cat_4='' ,goods_id='1000402' or …… の部分って 　……belong_cat_3='10086', belong_cat_4='' where goods_id='1000402' or …… だったりしませんか？
month でグループ化しないと、opencoursesテーブルに有る分の行数が出力されますね。 グループ化すると、CASE式を入れ子にする必要が出てきますが。 SELECT month AS 開講日 ,CASE WHEN SUM(CASE WHEN course_name = '経理講義' THEN 1 ELSE 0 END) > 0 THEN '○' ELSE '×' END AS 経理講義 ,CASE WHEN SUM(CASE WHEN course_name = '財務講義' THEN 1 ELSE 0 END) > 0 THEN '○' ELSE '×' END AS 財務講義 ,CASE WHEN SUM(CASE WHEN course_name = '簿記講義' THEN 1 ELSE 0 END) > 0 THEN '○' ELSE '×' END AS 簿記講義 ,CASE WHEN SUM(CASE WHEN course_name = '税理講義' THEN 1 ELSE 0 END) > 0 THEN '○' ELSE '×' END AS 税理講義 FROM OpenCourses AS OC INNER JOIN CourseMaster AS CM ON OC.course_id = CM.course_id GROUP BY month ORDER BY 1 ; 参考URL：http://codezine.jp/article/detail/751
http://www.postgresql.jp/document/9.3/html/sql-s … 名前 as 別名 の as は省略可能です。(こういう記法では、 []でかこった部分は省略可能を意味します) つまり yamato_order_info as yo と同じです。 IN については http://www.postgresql.jp/document/9.3/html/queri … http://www.postgresql.jp/document/9.3/html/funct …
IDが5同士なら名前順ということみたいなので 0rder by MAX_ID DESC，NAME に訂正
pg_hba.confに無線LAN時のPCのIPアドレスを追加してみてはどうでしょう？ （例） host all all 10.0.21.0/24 password 追加後再起動です。
　以前、連続２年上昇を考えたことがありますよね。 　連続２年減少なら、簡単です。前回のＳＱＬの不等号をひっくり返すだけ。 　本当に問題の表現が正確であるのならば、 select sm.year, sm.sale from sales sm where not exists( 　　　　select sc.year, sc.sale 　　　　from sales sc join sales s1 on s1.year = sc.year -1 　　　　　　　　　　　　join sales s2 on s2.year = sc.year - 2 　　　　where s1.sale < s2.sale and sc.sale < s1.sale and sm.year=sc.year) 　で、いけるともおいます。 　サブクエリの中でやっていることは、２年連続で減少しているレコードの一覧の抽出です。前回のＳＱＬと同じ方法ですね。 　これをnot existsで否定しています。 　さて、恒例の問題への条件です。 　今回は、「減少していない」という表現だったので、前年度・前々年度が存在しない場合も含みます。実は、そのために、ＳＱＬが少々複雑な表現になっています。こうしないと、ＮＵＬＬの扱いが面倒なんです。存在しない年度との比較結果は、「減少していません」としています。増加もしていないし、同値でも無いんですけどね。 　yearがきちんと一意であるか一意化できることが前提になるのは、前回の２年連続増加と同じです。
文字コードがおかしいんじゃないでしょうか。 DreamWeaverじゃなくて、例えばサクラエディタで開いてみたらどうでしょう。そして元のファイルはEUC-JPになっているでしょうからそれをUTF-8で保存します。そしてFileZillaのところからやり直してみるといいでしょう。 とにかく、pg_dumpで出力されたファイルの中身をEUC-JPからUTF-8に変換してからpsqlで取り込むと良さそうかと存じます。
select s.year, s.sale from sales s join sales s1 on s1.year = s.year -1 　　　　　　　　join sales s2 on s2.year = s.year - 2 where s1.sale > s2.sale and s.sale > s1.sale order by year で、行けそうな気がしますけど。 　書いてないことで推定した条件は、 　　yearフィールドには重複が無いこと。又は、適切な条件で一意化が出来ること。（この場合は、条件の付加が必要です。） 　　yearが初出又は、２年目の登場の場合には、２年前との比較のしようがありませんので、このような年度は表示しません。 　 　やっていることは単純です。内部結合を使って 　year, sale, year(-1), sale1(-1), year(-2), sale(-2) 　という構造の結合テーブルを構成し、単純に二年前と前年、前年と今年の比較をしているだけです。
"Base Directory"そのものにも空白があります。 そのため、 (略)DO IF "%%A %%B"=="Base Directory"(略) と指定しないと見つからないようです。 "Program Files"の空白の処理が面倒な気がします。 "ProgramFiles"とかにインストールされていると空白の数が違ってきますので。 コマンドプロンプトで REG QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\PostgreSQL\Installations\postgresql-9.0" /v "Base Directory" を実行して結果を見るとわかりやすいです。
No.1です。 追加です ＞#psql --version でバージョンが出力されるなら、 which psql と入力してみてください。psglのある場所が表示されます。 その周辺をみて削除してみてください。 先にも書きましたように使い始めたところでしたら、初期化を強くお勧めします。
LINUXのnkfコマンドを使って、pg_dumpしたファイルをS-JISに変換出来ます。 （例） nkf -s 入力ファイル名 > 出力ファイル名 それ以前の問題として、pg_dumpしたファイルを英訳なんて無茶苦茶ですね。 psqlのcopyコマンドでテーブル毎にCSVファイル出力可能です。 これをnkfコマンドでS-JISに変換し、PCにftpする方が現実的でしょう。 参考URL：http://www.postgresql.jp/document/9.3/html/sql-c …
> Npgsqlではフェッチは使えないのでしょうか？ できますよ。 http://msdn.microsoft.com/ja-jp/library/9kcbe65k(v=vs.110).aspx 別にNpgsqlに限った話ではなく、こういうライブラリはよっぽど独自 実装してない限り、大抵DbCommand、DbDataReaderを使うのと一緒です。 継承元クラスを直接利用するならば、 Dim con As NpgsqlConnection ' コネクションがある前提 Dim command As NpgsqlCommand = con.CreateCommand() Dim r As NpgsqlDataReader = command.ExecuteReader() Do While r.Read() 　Console.WriteLine(r.GetString(0)) Loop r.Close() command.Dispose() こんな感じに。 DB操作がわからないなら、System.Data.Common内のクラスを見るなり、 それぞれのメソッドを見るなり、他サイトでクラスやメソッド単位で調べるなり すれば解決すると思います。 Npgsqlのクラスのほとんどは、このクラスを継承して実装が行われています。 http://msdn.microsoft.com/ja-jp/library/System.D …(v=vs.110).aspx Npgsqlのクラス名を知りたければ、CHMファイルがあります。 http://pgfoundry.org/frs/?group_id=1000140
使ったことは無いのですが、phpPgAdmin 自体が php で動くスクリプトだと思います。 php とついているように。 実際ウエブサーバに置いたりして活用するようですし、ウェブサーバも必要ですね。 私のサイトにスキャンを仕掛けてくる人が定期的に存在しますし。 参考URL：http://www.kkaneko.com/rinkou/postgresinstall/ph …
ストアドファンクションを作ってください。 8.1でもsplit_part関数は使用できるようですから、 これで数値部分を取り出して加算していけばいいかと思います。 まあ、カンマの数が例えば最大で10個とか決まっている場合は、 split_part関数を利用して力技でSELECTだけで完結させることもできそうですね。
http://pgfoundry.org/frs/?group_id=1000140
失礼しました。 COUNT(*)だと表2にレコードが存在しない場合も表1の1件を返してしまうので COUNT(*)　→　COUNT(表2.id_no) に変えてみて下さい。
カーソルというのを使って処理します。 http://homepage3.nifty.com/owl_h0h0/unix/job/ORA …
ひょっとしてカタカナの部分は元々半角文字で、 質問を投稿する際に全角になってしまっているのでしょうか？ そうであれば濁点も半濁点も１文字ですので、 LIKE１回で絞り込むことはできないような気がします。 チルダをつかって正規表現でマッチさせるのではだめでしょうか？ column_1 ~ 'カルヒ([^゛゜].*)?$'
であれば、やはりcommitされていないか、どこかでrollbackされているということぐらいしか思い当たりません・・・ executeBatchではなく、executeUpdateで1件だけInsertした場合はちゃんと登録されるのですよね？
No.1さんの回答でいいと思いますが、記載のSQLのおかしい点を。 IN条件を使うなら、 項目 IN (値のリスト) という感じです。 記載のSQLであれば、 select * from [DB名] where [パスワード] = 'test' and [更新日] IN (select [更新日] from [DB名] where [ユーザID]='1111' order by [更新日] desc limit 3); となると思います。 まぁ、これでは[やりたいこと]には合わないのですが。
> nameの入力が5件あるので、５回同じような検索をする、ということです。 なるほど、意味がわかりました。 それなら5つのnameを一度に検索すれば済みますね。 （発行すべきクエリは＃４の回答がそのままその通りでしょう） そのかわり、ロジックが面倒になると思います。 感覚的に、 　１．SQLを発行してResultSetを取得 　２．SQLの結果を専用クラスかなんかに突っ込んで、それをHashMapなどsnameをキーにして格納 　３．探す時に、２．ので作った変数に対して、HashMap.get(sname)で求める こんな感じになる気がしますが、どうなんでしょう？ ロジック内で余計なループをする必要が出てくるなら、 検索スピードが速くなっても、レスポンスタイムも速いとは限りませんよね。 クエリを投げるよりロジックで頑張る方が遅いっていうのも往々にありますし。 AppサーバとDBサーバが分かれていて、絶対的な制約として、極力ネットワーク通信をしない、 Appサーバの処理性能に任せるというコンセプトならSQL一発ってのが正解かも しれませんが。 こんな些細な部分に、それをやるほどの意義があるのかと言うと甚だ疑問です。 仮にその検索がいちいち遅いとすると、そもそもプログラムではなくDBの問題のような。
tarコマンドで.tar.gzにした、ということは、 tarでアーカイブ(複数のファイルを一つの書庫に入れる。無圧縮ZIPみたいなもの)した後、gzipで圧縮した状態になっています。 pg_restore -U postgres -d (データベース名） < ****.tar.gz では、その圧縮されたままの入力になるので、不正となります。 gunzip -C ****.tar.gz | pg_restore -d (データベース名） これでも、 gzipの展開はされていますが、tar形式のアーカイブになっています。 元のダンプファイルではありません。 pg_restoreで使うためには、アーカイブの中にあるファイルを取り出す必要があります。 GNUtarの場合、 -Oオプションで標準出力に出力、というのがあるので tar -O zxvf ****.tar.gz | pg_restore -d (データベース名） でできるかと思います(実験はしていません) 本来のtar等、標準出力オプションが無い場合は、 tar.gzから元のダンプファイルをファイルに展開→そのファイルをpg_restore となります。 そもそも、tar+gzipでアーカイブして圧縮するのが間違いです。 単にgzipで圧縮すればいいでしょう。そうしていれば gunzip -c ****.gz | pg_restore -d (データベース名） で使えたはずです
おそらくSQL文の間違えになると思います。 update "store_table" set "tenpo_post1" = '123', "tenpo_post2" = '4321', "tenpo_add" = '東京都１－１－１' where "kaiin_no" = '123456'; 上記のように１つ１つ値を設定するような形が、 複数項目をUPDATEする場合の記述になります！
>yumでインストールできるような事を書いているのもありましたが、 >yum list 上にpgadmin3は見当たりません。 epelのリポジトリにあるみたいですが。 epelのリポジトリを追加する方法は…まぁ、難しくないですから検索して調べてみて下さいな。 # epelだけで依存関係がクリアできるかどうかは…試していないので不明ですが。 # CentOS5.xでやっている例だとrpmfusionのリポジトリも追加しているところもありますし。
レプリケーションの状態を確認するためには、 マスタのDBに接続し、 SELECT * FROM pg_stat_replication; のSQLを実行すると、マスタのレプリケーション状態の確認ができます。 その際、stateがstreamingをとっていれば、正常にレプリケーションができていると考えられます。 また、PostgreSQLのデフォルトのログ位置は、 /var/log/postgresql になるようですので、 マスタ、スレーブ両DBのログを確認いただくと、 エラー内容が分かるかと思います。 http://www.postgresql.org/docs/9.1/static/runtim … おそらく上記のどこかでエラーが確認できるかと思いますので、 エラーログにしたがって対処するのがよいかと思います。
CLIENT_ENCODING を指定して PostgreSQL 側で自動文字コード変換させれば良いのでは？ Perlスクリプト側や個々のSQLで文字コード変換をするより楽かと。 例) ------------------------------------------ $query = 'SELECT KEN_ID, KEN_NAME FROM KEN_MASTER'; # ↑個々のSQLに変換処理は必要なし。 $dbi = DBI->connect(・・・ $dbi->do("SET CLIENT_ENCODING TO 'EUC_JP';"); # ← この行を追加 $dsi = $dbi->prepare($query); $dsi->execute(); ---------------------------------------------- http://www.postgresql.jp/document/9.1/html/multi … http://www.postgresql.jp/document/9.1/html/runti …
http://www.itmedia.co.jp/enterprise/0307/18/epn2 … 上記に更新SQLのサンプルが掲載されています。 答えを直接誰かに教えてもらうより、サンプルを見て自分でSQLを組み立てられるようにした方が力がつきますよ。
> 通常のエディタで開くことはもちろん、手作業で行うことは気が遠くなってしまいます。 そういうことでしたら、思いつくのは下記の様な方法でしょうか。 a. pg_dumpall ではなく pg_dump を使ってダンプする 　元のDBに接続でき、現在の状態のリストアでよいならば、この方法が簡単でしょう。 　例) pg_dump -h localhost -p 5432 -U user_hoge -t table_hoge db_hoge > dump.txt; http://www.postgresql.jp/document/9.2/html/app-p … b. スクリプト言語を使って対象のテーブルの箇所を抽出する 　perl や ruby などを使えば、対象部分を抽出するプログラムが割りと簡単に作れるかと思います。 c. サイズの大きいファイルも扱えるエディタを使って抽出する 　例えば、 vim などではサイズが大きくてもさほど不自由なく編集はできたと思います。 　検索機能で該当箇所への移動・選択を行い、新旧の2ファイルを開いてコピーすれば良いかと。
> C:\Tomcat7\lib の中に tomcat-dbcp.jar は有りました。 そうですか。その中に↓は含まれているはずなのですが・・・。 org.apache.tomcat.dbcp.dbcp.BasicDataSourceFactory > e.printStackTrace() で出たメッセージがどこに表示（保存？）されるのかわかりません。 おそらくは、↓の様なファイルが有って、そこに出力されているかと。 C:\Tomcat7\logs\catalina.～～～.log あと、#1で補足して頂いたエラーメッセージ(スタックトレース)は、あれで全部なのですよね？
#1 です。 おー、#2さんのおっしゃる通りでした。 今、試してみました。 全角のまま大文字になるんですね。 勉強になりました。
Windowsクライアントからバックアップするのではなく、 LinuxサーバでDBバックアップしてWindowsクライアントにダウンロードするという方法なら自動化できます。 しかし、私が携わったプロジェクトでは、サーバでバックアップしていましたが、自動化はしていませんでした。 その理由は、バックアップ前にハードディスクの空き容量を確認が必要だったからです。 シェルだけ用意しておいて、空き容量確認後にDBバックアップしていました。 バックアップは自動化してクライアントにダウンロード後にサーバから削除するなら、毎回サーバの空き容量を確認しなくてもいいので、サーバでのDBバックアップを自動化してもいいかもしれません。 私が携わったプロジェクトは月１回のバックアップだったのでサーバの空き容量確認が毎回必須でした。 １．Linux でDBバックアップ ・postgres の所有ユーザで pg_dump を実行する。 　-h, -U といったオプション指定が不要になると思います。 ２．WindowsクライアントにDBバックアップファイル取得 ・WinSCPとかを使ってLinuxサーバにあるDBバックアップファイルをWindowsクライアントにダウンロード ・サーバーのDBバックアップファイルを削除 手順は以上です。ご検討下さい。
PostgreSQL が Windows に直接インストールできるように なったのは、バージョン 8 からです。 バージョン 7 以前は、『 Cygwin (シグウィン) という UNIX ライクな環境を Windows にインストールし、その Cygwin 上で PostgreSQL を動かす』 という、手の込んだことが 必要です。 具体的な方法は以下の参考URLを見てください。 参考URL：http://allabout.co.jp/gm/gc/47344/
sed で行末の区切り文字を取っ払ったものを流し込んでやるのはどうですか？ sed -e 's/[|]$//' hoge.txt | psql -U user_hoge -c "\copy hoge from STDIN delimiters '|';" db_hoge http://itpro.nikkeibp.co.jp/article/COLUMN/20060 … 参考URL：http://www.postgresql.jp/document/9.1/html/app-p …
関数の呼び出し方に問題があります。関数の呼び出し時には IN / OUT パラメータやデータ型の指定は不要です。 /* (1)の正方形について再帰処理 */ SELECT insert_square(kaisuu, count + 1, x1, y1, x3, y3); などと書き換えるとどうなるでしょうか。(2) ～ (4) についても同様です。 また、エラーメッセージが出力されていれば、提供してもらったほうが回答しやすいです。 あと、PostgreSQL には幾何データ型や幾何関数があるので、それらを使ったほうが関数をシンプルにできると思います。例えば、中心の座標を求めるcenterといった関数もあります。 参考URL：http://www.postgresql.jp/document/9.2/html/funct …
PL/pgSQL であれば、INSERT/UPDATE 操作によって更新された新しい行の値を NEW.～～～ という形式で参照できます。 http://www.postgresql.jp/document/9.2/html/plpgs … パーティショニングの際の INSERT に対するトリガーの設定も参考になるかと思います。 http://www.postgresql.jp/document/9.2/html/ddl-p …
DELETEの書き方は下記の方法ですので間違えないで下さい。 DELETE FROM [ ONLY ] table [ WHERE condition ]
最新のバージョン9.2であっても、PL/pgSQL では SELECT INTO は使用できません。(下記ページの注釈参照) http://www.postgresql.jp/document/9.2/html/sql-s … したがって、SELECT INTO の様なことを行う場合は CREATE TABLE AS に書き直してやる必要が有ります。 また、PL/pgSQL 内で動的にSQLを生成して実行する場合は EXECUTE を使う必要性が有るようです。 http://www.postgresql.jp/document/9.2/html/plpgs … 例) BEGIN EXECUTE 'CREATE TABLE ret_val AS SELECT * FROM ' || t_name::regclass || ' OFFSET ' || ofs_num || ' LIMIT ' || lmt_num; END;
＞　取り出したい形式は「ID/名称コード1/名称コード2」ではなく「ID/名称コード1 名称コード2」でした。 問題無くSELECTできますよ。 test=# SELECT id, name || code1 || ' ' || name || code2 FROM test; id | ?column? ----+----------- 1 | A111 A444 2 | B222 B555 3 | C333 C666 (3 rows)
postgreSQLはほとんど触ったことがないのですが、 generate_seriesという関数があるようですね。 http://www.postgresql.jp/document/8.1/html/funct … これを使って、 insert into 名簿 select s.n, '芥川龍之介', 'ほげ太', NULL from generate_series(2,10) as s(n) ; という感じでも出来るかもしれません。
existsを使って、 select * from スキーマA.テーブルA A where exists ( select * from スキーマB.テーブルB B where A.カラム1 = B.カラム1 and (A.カラム2 <> B.カラム2 or A.カラム3 <> B.カラム3 or A.カラム4 <> B.カラム4) ); でもいいと思います。
こういうことでしょうか。 select A.uriage from A inner join B on (A.data like '%' || b.data || '%') where A.month = 1 and b.day = 5;
未テストですが、以下のような感じはどうでしょう？ select case when year >= month then year else (case when month >= hour then month else hour end ) end as money from (select COALESCE(year,0) / 12 as year , COALESCE(month,0) as month , COALESCE(hour,0) * 8 * 20 as hour from table ) order by money desc
SELECT * FROM M_SHOHIN WHERE code = ANY( SELECT code FROM M_SHOHIN WHERE class_code = '01' );
WAL アーカイブを有効にして、ベースバックアップを取得、archive_command でベースバックアップ後の WAL を自動バックアップすればよいようです。archive_command で scp を使ったり、コピー先を NAS にしたりすれば別サーバにバックアップデータを退避できます。 バックアップは復旧できてなんぼのものですから、取得したバックアップデータからきちんと復旧できることも確認してください。 参考URL：http://www.postgresql.jp/document/8.3/html/conti …
http://blogs.yahoo.co.jp/kensinisnek/10176003.html 9. 以下のメッセージが出力されたら、接続は成功ですので、「OK」をクリックしてください。　他のメッセージが表示される場合、何かしら設定に問題があると思われます。 の画面は出ましたか？
もう10日以上前なのでご覧になっていないかも、ですが。 .exeと言う事はDBサーバーはWindowsですね。 SQL Serverでは標準で使える機能ではありますが（推奨はされていませんが）、PostgreSQLのトリガーで使用するPL/pgSQLでは面倒な手順が必要です。 （商用のORACLEの場合も同様） まず、使うのはPL/pgSQL以外に、この場合、C言語も必要です。 C言語関数 http://www.postgresql.jp/document/8.3/html/xfunc … 但し、ご自分で検索されるとわかると思いますが、ほぼ全てのサンプルはUnix/Linuxです。 （と言うかWindowsの例は探せませんでした） DBを操作するアプリケーションを作成されているのであれば、そちらで行った方がよいと思います。 私自身は、PostgreSQLではありませんが、以前、ORACLEで外部コマンドを実行する処理を作った事があります。 （方法は上記リンクと似たような感じで、やはりC言語でライブラリをコンパイルする必要があります） Cに関しては初心者ではありませんが、正直、サンプルレベル以上の、仕事で使えるレベルにするにはかなりハマるな、と思いました。 Windowsだと権限周りも面倒そうなので、更にハマる事、必至だと思います。 （何より事例が少ない） それと、もし 「DBサーバーはUnix/Linuxだが実行したいexeはリモートのWindows上」 と言う事でしたら、もはやトリガ内で何かする、と言うのはあり得ません。 （私が上司なら即座に却下します）
こんなことすると出来るっぽいですよ。 select id, name, array_to_string (array(select b.goal from tbl b where b.id = a.id order by b.goal), '、') as strAgg from tbl a group by a.id http://www.geocities.jp/oraclesqlpuzzle/postgres …
ホストを指定したからソケット接続になり、おそらくユーザ名が違うので ident認証で失敗しているのですよね？ http://www.postgresql.jp/document/9.1/html/auth- … ホストを指定せずにローカル接続で接続すれば良いのでは？ 例) psql -U postgres -f xxxxxx.dump xxxxxx
更新量とメンテナンス時間がとれるかのバランスの問題になります。 週一回日曜などにしかメンテナンス時間が取れないのなら現状のままの運用でいくべきでしょう。 REINDEX中は該当のINDEXは使用できなくなります。 こちらを参考にしてください。 http://dqn.sakusakutto.jp/2011/11/postgresql-rei …
8.3.1 からのアップグレードという事ですよね。 簡単に言うと、8.3.19 へのバージョンアップはバグフィックスのみ、9.1.4 へのバージョンアップは大幅な機能追加・性能改善を含みます。 ■ 8.3.19 への移行 ・バグやセキュリティの改善のみでアプリケーションの動作への影響は無し。 ・機能・性能的な変化も無し。 ・移行作業は楽。今までのデータディレクトリがそのまま使える。 　http://www.postgresql.jp/document/8.3/html/insta … ■ 9.1.3 への移行 ・大幅な機能追加・性能改善がされている。(詳細は最後の方のリンク先を参照) ・デフォルトの動作が変わっている部分もある。 　→ ただし、設定によって8.3系と同じ動作にする事は可能。 　　http://www.postgresql.jp/document/9.1/html/relea … ・移行作業では基本的にデータのダンプ・リストアを行う必要がある。 　http://www.postgresql.jp/document/9.1/html/upgra … 　→ ただし、pg_upgrade というツールを使えば少し時間が短縮できる。 　　http://lets.postgresql.jp/documents/technical/co … 　　http://www.postgresql.jp/document/9.1/html/pgupg … 偶然ですが、私が関わっているシステムも先日8.3系から9.1系にアップグレードしました。 移行作業でデータがきれいになった影響もありますが、目に見えて速くなりましたよ。 ■ 参考 PostgreSQL 8.4 の新機能 http://lets.postgresql.jp/documents/technical/8.4/ PostgreSQL 9.0 の新機能 http://lets.postgresql.jp/documents/technical/9. … PostgreSQL 9.1 の新機能 http://lets.postgresql.jp/documents/technical/9. …
> そのサイト非常に有名ですが、あんまり役に立ちませんでした。 > そのため、質問しました。 #1にも書いたけど、どう役に立たなかったか書いてもらわないと何も回答できない。 サポート掲示板で訊くからここでの回答はいらないってことなんだろうな。たぶん。
1:index作成の目安について 検索の条件になる項目で、重複があまり無い項目を作成すれば良いのでは無いでしょうか。また、テーブル作成時に特定のカラムに対してPKを設定するのであれば、PKには自動的にindexが付与されるので、ベット作成の必要は無いかと思われます。 いったん、テーブルを作ってみて、使いたいSQLをexplain analyzeで実行してみて、処理が遅い部分に関係しているカラムに対してindexを設定して行く方法をお勧めします 2:複合indexのメリット indexサイズが小さくなります。ただ、指定の順番を間違うとindexが使われなくなるときもあります。 3:indexの付与対象について indexはテーブルのカラムに対して付与するので、同一カラム名のindexを他のテーブルに作ったからと言って、違うテーブルで作成しなくて良い訳ではありません。 4についてはご質問の意図がよくわかりませんでした。 私の回答がお役に立てるようであれば幸いです。
replace( to_char(created, 'YYYY年MM月'), '年0', '年') as created_styled
「GPLの場合は、たとえ、組み込まなくてもソー スの開示を必要とするのでしょうか？」 個別のケースについては、…… ……読んで自分で判断して！ としか言えない。。。 参考日本語訳 ※あくまで参考で、英語が正式版。 http://sourceforge.jp/projects/opensource/wiki/l … 組み込まないなら、一般的には、別のソフトウェア。 非公開で組み込めるのが BSD 系ライセンスの使いやすいところ。
ご質問の内容が、一つの重たい処理をしている時に、マルチコアを使いたいというものでしたら、postgresqlの設定ではどうにもなりませんので、処理を分散させ、並列にクエリを投げる様なリクエストに書き直すぐらいしか、もしかしたら対処策が無いかもしれません。
> 上記のSQLでanumとbnumとcnumが同一の時は > 最小のdnumのみ抽出されるということでよろしいでしょうか。 baseが同一のものの中であれば、そうなります。 ただし、 base anum bnum cnum が同じでも no が違えば別々に出力されますが、恐らくそれは問題ない動作ではないのでしょうか？ 少なくとも、ご質問に例示されているデータについては例示されている通りの結果が抽出されます。 VIEW定義内のSELECT文は、特に難しい事をやっている訳ではないので、ご自身で精査されると良いと思います。 1. 2つのテーブルを no が同じもので内部結合 　同じ値の no が両テーブルに存在するものだけが、取り出されます。 　http://www.techscore.com/tech/sql/SQL6/06_02.html/ 2. 1で取り出されたデータを no name code base anum bnum cnum でグループ化 　つまり最終的な出力項目の内の dnum 以外全てが同じものごとに一まとめにしています。 　http://www.techscore.com/tech/sql/SQL5/05_08.html/ 3. 2のデータから no name code base anum bnum cnum と dnum の最小値を出力
#3 に私が書いた条件は合っていたのでしょうか？ 合っていたとして・・・。 > 上記のSQLで可能でしょうか？ 可能ではないですね。 ただし別の方法を使ったSQLでは可能です。かなり冗長ですが。 ---------------------------------------- SELECT * FROM tbl a WHERE EXISTS (SELECT * FROM tbl b WHERE (a.aaa = b.aaa OR a.ccc = b.ccc OR a.ddd = b.ddd OR a.eee = b.eee OR a.ggg = b.ggg) AND a.bbb <> b.bbb) AND NOT EXISTS (SELECT * FROM tbl b WHERE a.aaa = b.aaa AND a.bbb = b.bbb AND a.ccc = b.ccc AND a.ddd = b.ddd AND a.eee = b.eee AND a.ggg = b.ggg AND a.hhh > b.hhh) ORDER BY aaa, bbb, ccc, ddd, eee, ggg ---------------------------------------- NOT EXIST句は aaa,bbb,ccc,ddd,eee,ggg が同じで hhh が小さい行が存在しない、つまり hhh が最小の行という条件を表しています。 また、window関数を使っても同じ事が出来そうです。 蛇足ですが、なかなか回答が付かないからといってマルチポストするのはやめましょう。
100 以上の引数をもった関数を定義できるようにするには、ソースコードを修正してコンパイルしなおす必要があります。 ヘッダファイル src/include/pg_config_manual.h 内の定数 FUNC_MAX_ARGS を修正してください。ソースコードのコメントには約 600 まで増やせるということです。 100 以上の引数をもつ関数を定義すること自体、設計に何らかの問題がありそうなので、そちらを見なおしたほうがよいと思います。 あるいは、引数を配列や複合型で渡すことを考えたほうがいいかもしれません。
性別に関するマスタデータ（台帳，基本データ）ですね。 メタデータではありません。 http://www.sophia-it.com/content/メタデータ
データベースの全てのファイルが欠損または破損していないのであれば、 新しいディスク上の同じディレクトリに展開してあげればそのまま起動 できると思いますが。 ただし、データベースのファイルが１つでも欠損または破損している場合は 過去のバックアップがないと復旧できません。 > 新サーバに同じバージョンのPostgreSQLをインストールして、古いファイルを上書き > すればいいでしょうか？ 実行ファイルとデータベースは別に考えてください。 データベースとは initdb で作成されるファイル群です。 実行ファイルであれば壊れていても上書き再インストールで問題ありません。
どうしても、MS-ACCESS側に全データを取り込んでおく必要があるというのなら （あまり綺麗な方法ではないですが） 毎回大量のリザルトがあるSQLを発行するのではなく、データをACCESS側にキャッシュしておいて、 更新・挿入・削除のあったデータのみをもってきてローカル側で整合させるって方法もありえますね。 これはこれで、アルゴリズムしっかり考えないと、同期とれなくなって データ壊してしまう可能性もありますが。 それを考えると、MS-ACCESSのあるLAN側にもPostgreSQLを立てて、 PostgreSQL同士でレプリケーションを組んでしまったほうが、簡単かもしれません。 もし、PostgreSQL とMS-ACCESSとでレプリケーションが組めるような パッケージなりライブラリがあるなら、そっちを使う方法もあるでしょうけど。
テーブルの結合はJOIN句を使います。 SELECT A.point - B.point RESULT FROM point_1 A INNER JOIN point_2 B ON A.id=B.id　WHERE A.id=1 上記でAやBはエイリアスです。 INNER はAとBの両方にあるものに なります。AにあればBになくてもよい 場合はLEFT、BにあればAになくても よい場合はRIGHT という語になります。 LEFTやRIGHTの場合、存在しない方の 項目はNULLになります。 テーブルの結合は基本的な手法なので よく理解することが大切です。また、DB による方言が多く、以前はOracle、Sybase Accessなどで記述が異なっていました。 今は統一されてきたので、他のDBでも JOIN句でほぼ結合できます。 但し、結果については意図したものと違う ことがあります。 結合が更に増えてLEFT、RIGHTの結合の 場合、例えばA→B→Cです。BがNULLに なった時（AにあってBにない)に単にCも NULLになるDBシステムとクエリが異常 終了するDBシステムがあります。
キャッシュから効いているから ２回目の検索は既にキャッシュ内にあるため、ディスクアクセスが起こらない。
configure時に--enable-nlsとか付けていません？ 付けているのであれば、事前にgettextとlibiconvのインストールが必要です。
1点気になりましたが、複数セッ ションからの同時アクセスに ついての要件はどうなっています でしょうか？ これだと同時アクセスの際に、 運が悪ければ同じ連番になって しまいます。 通常はこの手の場合、シーケンス オブジェクトを使用します。 (重複する事なく、カウントアップ できます) 要件的に許されるのであれば、今 の作りでもよいですが、そうで なければ、シーケンスの使用を 検討してください。
アプリケーションの詳細がわからないので何とも言えないのですが、 販売管理等のアプリでは単純にデータを削除しないほうがいいです。 削除すると経緯が全く分からなくなるので、 マイナスの売上をたてる、もしくは、削除フラグを立てるといった処理の方が賢明です。
補足です。 無理矢理英語にしようとして無駄に長い名前（10文字とか）にすると、打つのも面倒だし、タイピングミス等も起こりやすいので、出来るだけ文字数が少ない名前にすればいいかと。 10文字とかになる場合、ローマ字読みで名前をつけるのもありです。
「windows7にインストールされていたpgAdminIII1.8.？(詳細なバージョン不明)をインストールして使用しておりました。」 「インストールされていた＊をインストールして」という状況が分かりません。 なぜ，あるいはどのように「windows7にインストールされていた」のでしょうか。 なぜ，あるいはどのゆに「pgAdminll1.8.?をインストールし」たのでしょうか。 なぜ，詳細なバージョンがわからないでしょうか。 また ところで，pgAdminll1.8をコントロールパネルからアンインストールした際に，エラーはでなかったのでしょうか？ あるいはpgAdmin1.8を導入（インストール）したときに一緒に導入したソフトはなかったのでしょうか？ 当面考えられるのは3つの方法があります。 1　「pgAdminll1.8.?をインストールし」た状態の前のバックアップに戻す。 2　windows7を導入しなおす。（新規） 3　registryファイルを検索してpgAdminllに関する記述をまめに消す。 3は，pgAdmin, postgresなどの先頭の何文字かで検索していきます。 別のマシンで，postgresを導入する前のregistryファイルを保存しておき pgAdminllを導入した後のregistryファイルの差分をとってみて，その差のところを順に消して行くか，値を変えていけばうまくいくかもしれません。
私のマシンでは pg_dump -U postgres -w データベース名> backup.dat とする事でパスワード無で動きます。
COALESCE(F5,G6.M2) 列名は適宜調整してください。 COALESCE(評価する値,Nullの場合の代替値) 評価する値がNullでなければ、評価する値がそのまま返されます。 評価する値がNullなら、Nullの場合の代替値が返されます。 OracleだったらNVL関数 ACCESSだったらNz関数
select * from　テーブル名 where date_part('hour', 取得時間) between 18 and 19; または select * from　テーブル名 where date_part('hour', 取得時間) >= 18 date_part('hour', 取得時間)　< 20;
PostgreSQLではDELETE文の拡張構文として「USING」が使えます。 DELETE FROM (1) USING (2) WHERE (1).カラムA= (2).カラムA AND (2).カラムB=X マニュアルを参照してください。 http://www.postgresql.jp/document/9.0/html/sql-d …
上記で動きます。WHERE句を取った形で、psql で実行すると次のようになります。 hoge=# create table t (a int, b varchar(64), c varchar(64), d varchar(64)); CREATE TABLE hoge=# insert into t values (1, '111', 'aaa'); INSERT 0 1 hoge=# insert into t values (2, '222', 'bbb'); INSERT 0 1 hoge=# select * from t; a | b | c | d ---+-----+-----+--- 1 | 111 | aaa | 2 | 222 | bbb | (2 rows) hoge=# update t set d = b || c; UPDATE 2 hoge=# select * from t; a | b | c | d ---+-----+-----+-------- 1 | 111 | aaa | 111aaa 2 | 222 | bbb | 222bbb (2 rows) hoge=# update t set d = b || ' ' || c; UPDATE 2 hoge=# select * from t; a | b | c | d ---+-----+-----+--------- 1 | 111 | aaa | 111 aaa 2 | 222 | bbb | 222 bbb (2 rows) hoge=# なお、列名はダブルクォートでくくる必要はありません。必要なのは、大文字と小文字を区別する場合や、通常許されない文字列を列名に使う場合です。 お役にたちましたでしょうか。
to_number('123', '999') では？ http://www.postgresql.jp/document/pg814doc/html/ … より。
とりあえずこちらからインストーラ（exeファイル）をダウンロードしてインストールしてみてください。自動的に「postgres」ユーザーが作られるはずです（途中でpostgresのパスワードの入力を求められます）。 http://www.enterprisedb.com/products-services-tr … 32bit、64bitは環境と相談の上で。
>Bテーブルを調査して、重複となるレコードを ターゲットが違うでしょ。Bには重複レコードは できないんだから・・・ AテーブルからBテーブルのキーとなる項目で グループ化し、そのレコード数が2以上ならば 重複になる。 SELECT 契約番号,ユニット番号,資源番号, 入力日,COUNT(契約番号) AS 件数 FROM Aテーブル GROUP BY 契約番号, ユニット番号,資源番号,入力日 HAVING COUNT(契約番号)>1
CSVのテキストに出力するために COPY TO を使っているのならば、 booleanをintegerにキャストして出力すると 1/0 になります。 COPY (SELECT b::int FROM (VALUES(true),(false)) T(b)) TO 'xxx.csv' WITH (FORMAT 'csv') 参考URL：http://www.postgresql.jp/document/current/html/s …
参考: Let's Postgres「文字列型の使い分け」 参考URL：http://lets.postgresql.jp/documents/technical/te …
> JavaやPerlで作成したWebアプリからのDB操作を行なっていますが、 > プログラム側で意図的にスレッドを作ったりはしていません。 であれば無効にしても問題ないと思います。 Javaに関して言えば、JDBCなので（Type 4、つまりTHINが前提ですが）libpqを 使用しないでしょうし、Perlに関して言えば、そもそもPerl自体がthreadを有効にして コンパイルされている必要がありますし。有効化されていたとしても、勝手にスレッドが 走り出すということは恐らく無いでしょう。
> Undefined first referenced > symbol in file > sched_yield /var/tmp//ccVp73Io.o sched_yieldが見つからないと言っています。 それは、Solarisではsched_yieldがlibc.soにもlibpthread.soにも含まれていないからです。 では、それがどこにあるのか？ librt.soにあります。 なので、LIBSに-lrtを設定してconfigureしてみては如何でしょうか？ $ LIBS=-lrt ./configure --prefix=/usr/local/postgres --without-readline --enable-thread-safety ところで、configureで失敗したテストプログラムは以下ですが、 $(srcdir)/src/test/thread/thread_test.c 222行目の問題箇所を見ると、/* if this is a portability problem, remove it */ と書いてあるので、以下の２行を消してconfigureしてもOKかもしれません。 while (thread1_done == 0 || thread2_done == 0) sched_yield(); あと、余談ですが、psqlを使用することがあるなら、--without-readlineはあまりお勧めしません。
OUTパラメータとRETURNS integerは同時には使えないと思いますが、 以下のような呼び出し方ではいかがでしょう？ OUTパラメータを除いた「IN, INOUT引数だけを持つ関数」として呼び出すのがポイントです。 CREATE OR REPLACE FUNCTION raise_test(in i_data_num numeric, out o_data_num numeric, out o_data_char character varying) /*RETURNS integer*/ AS $$ BEGIN o_data_num := i_data_num + 100; o_data_char := 'XYZ'; END; $$ LANGUAGE plpgsql; DO $$ DECLARE data_num numeric; data_char character varying; BEGIN SELECT * INTO data_num, data_char FROM raise_test(5); RAISE INFO '% / %', data_num, data_char; END; $$; 結果 → INFO: 105 / XYZ
・NEW の値を使う場合には、FOR EACH ROW トリガを使う必要がある。 ・テーブルAに仕掛けたトリガの NEW は、テーブルAの行を表している。 といったあたりがポイントと思われます。 ↓こんな感じでどうでしょうか？ CREATE FUNCTION update_edit_b() RETURNS TRIGGER AS $$ -- (OPAQUE はかなり古い書き方？) BEGIN UPDATE Table_b SET Column_b = true WHERE Table_b.A_id = NEW.id AND NOT Column_b; -- (複数回更新する際に、無駄なUPDATEを避ける) RETURN NEW; END; $$ LANGUAGE plpgsql; CREATE TRIGGER trgger_a AFTER -- (BEFOREのほうが若干効率が良いので、置き換えも検討すべし) UPDATE OF a ON Table_a FOR EACH ROW -- (STATEMENTではなくROWを指定) EXECUTE PROCEDURE update_edit_b; 参考URL：http://www.postgresql.jp/document/current/html/s …
PL/pgSQL から、出力パラメータ (OUT 引数) のある関数を呼び出す場合、 引数ではなく返値として値を受け取る必要があります。 PERFORM ではなく、SELECT INTO を使ってみてください。 CREATE OR REPLACE FUNCTION fn_raise(OUT o_v1 int, OUT o_v2 int) AS $$ BEGIN o_v1 := 123; o_v2 := 456; END; $$ LANGUAGE plpgsql; DO $$ DECLARE v1 int; v2 int; BEGIN SELECT * INTO v1, v2 FROM fn_raise(); RAISE WARNING 'v1=%, v2=%', v1, v2; END; $$; WARNING: v1=123, v2=456
PostgreSQLにはgenerate_seriesという関数があります。これを使うと簡単に連続値が得られます。 後、テーブルＡの件数が少ないか、キー１に索引があれば select a, case when exists ( select 1 from テーブルＡ where テーブルＡ.キー１ = s.a ) then '有り' else '無し' end from generate_series( 100, 109 ) as s(a); も検討してみてください。
まったく同じSQLですか？ ・explain する時間が短縮される ・キャッシュ(ディスクまたはメモリ)にデータや実行計画が残っている ・物理ファイルに対してのアクセスが(キャッシュにより)高速化される ・最初は共有ロックを掛ける時間がかかっている ・メモリがページングされない 等があるのではないかと。 厳密なのはanalyzeしたり統計情報を見るなりした方が良いと思いますけど。
#ANDじゃなくてORだよな。 未検証。 http://www.postgresql.org/docs/9.0/static/functi … >bit_or(expression) ってのは使えるだろうか？ #この関数、他DBで使えるかなあ？極力移植性は高くしておきたいんだけどなあ
あくまで一般論として。 通常、プログラムを作成する際、２重起動を防止するプログラムを入れます。 特に現代は、マルチプロセスですので、２重起動したくないソフトの場合、必ず２重起動防止が入ってると思って問題ありません。 通常に起動したのであれば、作成者の意図としてマルチプロセスによるアクセスを許可しており、問題は発生しないはずです。 その後も問題無く動作してるのであれば、競合による書き換え等も発生していないでしょうから、推定問題無しだと思います。
ソースコードを見る限りマクロで定義した値をそのまま使っていて、 パラメータなどでは変更できないように見えます。 こちらのマニュアル（9.1.1）を見た限りでも、 コンパイル後に変更できないように見えます、 http://postgresql.jp/document/current/html/index … ということで、 > Windows版はどのように設定すれば良いのでしょうか？ ソースコードは公開されているので、どうしてもということであれば 独自にBuild する以外に方法はないように思われます。
名前のテーブルは繰り返して結合すことになるので、一般的には無理です。 ただし、名前のテープルがせいぜい10種類くらいであれば、 outer joinで10個程度をつなげることでは可能です。 新しいバージョンであれば、with recursive では実現可能です。
no int default X'FFFFFFFF'::int みたいな感じで。
SQLの規格としてはUNIQUE制約を指定した時にINDEXを作成するかどうかは決められていませんが（SQL規格にはINDEXの記述がない）、私が知るかぎりはPRIMARY KEY制約、UNIQUE制約を指定した場合はすべてのRDMSでINDEXが暗黙に作成されます。 PostgreSQLも同様です。 ですから、 CREATE INDEX id ON tableA (id); とする必要はありません。PostgreSQLではエラーになりませんが、Oracleなどでは既に索引が作成されている列に同一の内容で索引を作成しようとするとエラーになります。 暗黙に作成されたINDEXも暗黙に作成されたINDEXも同様に使用されますので速度の向上が見込めます。 後、UNIQUE制約ですが Oracle→NULLは複数個許可する。暗黙作成される索引にNULLを含めない。 PostgreSQL,MySQL→NULLは複数個許可する。暗黙作成される索引にNULLを含む。 SqlSERVER→NULLは1個のみ許可する。 DB2→NULLを許可しない と扱いが違うので注意してください。
文字化けはPostgreSQLのインストーラがUTF-8の文字コード出力しているからです。UTF-8に対応したエディタで開いてみてください。 当方では http://www.enterprisedb.com/products-services-tr … から「postgresql-9.1.1-1-windows-x64.exe」をダウンロードしてインストールして見ましたが正常にインストールできました。
EXCLUSIVE MODE のロックと SELECT は競合しません。Oracleと同じ動作です。 「Webアプリのselect」が、更新処理や FOR SHARE/UPDATE 等、 select以外の処理を勝手に追加していませんか？ 参考URL：http://www.postgresql.jp/document/current/html/e …
・トランザクション開始 ・商品テーブルにinsert(nextvalを使用） ・価格テーブルにシーケンスより得られた値を含めてinsert（currvaを使用） ・コミット 要はトランザクションを分割するのが問題なので、ひとつのトランザクションにまとめればいいと思います。
OrangeCup150さんが想定されている意図であるなら・・・ １．PHPにてランダムの半角英数文字列（固定桁長）を生成する（８桁とか） ２．SELECTして１の値と既存との重複チェック ３．重複があれば１と２を繰り返し。なければそれでOK。 serial型などは今どきなら自動でINDEXもつくので、ユーザーID的なものとは別にあってもいいと思いますよ。プライマリキーになるので、他のテーブルとの結合もしやすいし。 ユーザーの情報をいじくったりする時には、そのserial型の値を使って操作してやったほうが速度も出やすいですから。
じゃぁ SELECT a.*, b.*, c.* FROM a LEFT JOIN b ON a.key = b.key LEFT JOIN c ON b.key2 = c.key2; でいいんじゃ
表ごとにくぎる (A INNER JOIN B ON X) INNER JOIN C ON Y が一般的です。 条件ごとにくぎる A INNER JOIN B INNER JOIN C ON Y ON X のはエラーにならなくても分かりにくくなるのでバグの元。 だいたい、こう書くなら A INNER JOIN B INNER JOIN C where Y and X って書いたほうがまだ分かりやすいと思うし、 それをいうなら普通は、 from A,B,C where Y and X と書くでしょう。 ## 外部結合の場合は最後の書き方ができない（かできるけどANSI標準でない）とかありますけど。
↓とかでどうでしょう？ 試してないので微妙に間違ってる部分あるかも？だけれども。 SELECT MAX(sum_buynum) FROM ( SELECT RCT_NO, SUM(BUYNUM) AS sum_buynum FROM TRN_RECEIPT_DETAILS GROUP BY RCT_NO )
PHPが初期設定のままであればエラーは表示されません。 エラーメッセージが /var/log/httpd/error_log に出ていると思いますので確認してみてください。
「データベースで表示算のような計算は可能ですか？」 　可能ですが、どのようなテーブル＆データ構造になっているのかが分からないと、答えようがありません。 　入庫と出庫に在庫のテーブルがあり、商品のID、日付、数量が複数存在するとして、商品のIDと日付でグルーピングして、数量の合計を求めれば、商品ID別に指定した日の入庫数と出庫数が分かります。そこまで来れば、在庫数は、「前日在庫数＋入庫数－出庫数」で計算できます。
psqlのコマンドラインから \d テーブル名 で項目と関連するINDEXが表示されます。
パフォーマンス重視、予約IDに空き番が出ててもいいならシーケンスが一番いいと私も思います。 予約IDに空き番が出ると困るなら、仕方がないので予約IDテーブル（1レコード）を作成し トランザクション開始 UPDATE RETURNNING か UPDATE して SELECT で予約IDを取得 予約テーブルと予約明細テーブルにINSERT COMMIT or ROLLBACK なら後続トランザクションは予約IDテーブルのUPDATEでWAITになるから重複は発生しない。 （その代わりにここがボトルネックになる危険がある）
残念ですがPL/pgSQL内でトランザクション制御はできません。 アプリケーション側でコントロールする必要があります。 私も、PostgreSQLの今後の改善に期待しています。
質問に自分で書いているとおり、-C オプションを指定すると、データベースを作成してそのデータベースに対してリストアを行います、 -C オプションを指定しないと、pg_restore コマンドの -d オプションで指定したデータベースに対してリストアが行われます。 以下のように pg_restore コマンドを実行して -C オプションのあり・なしで SQL がどのように違うかを確認してみてください。 $ pg_dump -F c test > test.dump $ pg_restore test.dump $ pg_restore -C test.dump -C オプションを指定した場合には、CREATE DATABSE コマンドでデータベースを作成した後、\connect コマンドでそのデータベースに接続していることが分かります。
psql コマンドでリストアする plain 形式のダンプファイルの場合には、pg_dump コマンドの実行時に -C オプションを指定してデータベースの作成に必要なコマンドもダンプするようにしてください。 pg_restore コマンドでリストアする custom および tar 形式のダンプの場合には、pg_restore コマンドの実行時に -C オプションを指定してデータベースの作成後にリストアするようにしてください。
ステレオミックスという機能を使います(マイクは使いません). ちょっと長いのですが, 以下のページが詳しいです. http://www18.atwiki.jp/live2ch/pages/151.html 頑張ってください.
普通に考えると、他のユーザーのパスワードは管理者といえども見れないようにできているはずです。もし使い回ししているとしたら、ひとつパスワードが分かってしまえばいたずらし放題になってしまいますからね。 ということで正規の方法ではほぼ見られないと思います。あるかどうかはわかりませんが、非正規のクラックツールのようなものがあれば可能かもしれません。
quote_literal 関数は役に立ちますか? 中の引用符をエスケープするだけでなく、 値を引用符で囲むところまでやってくれるようです。 http://www.postgresql.jp/document/9.0/html/funct …
ひとつはDBにバイナリ型項目を作ってそこに書き込み、読み込みを行う方法。 http://blog.xole.net/article.php?id=425 または、DBには画像ファイルのファイルパスのみ保存し、画像ファイルはファイルシステムで管理するやりかた。 バイナリデータをTEXT（Base64）に変換してDBに保存するやり方 http://neta.ywcafe.net/000774.html などがあります。
リストアしようとしているコマンドはCOPY FROMですか?
メールを送信するスクリプトを作成し、それを failover_command パラメータに指定すれば実現できます。failover_command パラメータはノードの切り離し時に実行するコマンドを指定するパラメータです。 参考URL：http://pgpool.projects.postgresql.org/pgpool-II/ …
~= は幾何データ型の演算子で、位置や形が同じかどうかの比較になります。 幾何データ型の = は面積が同じかどうかの比較になります。 point 型は平面における座標「点」なので、面積を持たないから = が 使えないのではないかと思います。 幾何関数と演算子 http://www.postgresql.jp/document/pg904doc/html/ … > "同じを示す"~=演算子はpoint、box、polygon、およびcircle型に対し通常の等価概念を示すことに注意してください。 > これらのいくつかの型は=演算子を持ちますが、=は面積の等しさのみを比較します。 > その他のスカラー比較演算子（<=など）は同様にこれらの型の面積を比較します。 幾何データ型 http://www.postgresql.jp/document/pg904doc/html/ …
8.4なら「unnset関数」が使えます。 select item,count(*) from ( SELECT unnest(val) as item from sample_tbl ) t group by item order by item;
postgreSQLでは歴史的経緯で「role」が使われていました。 その後「user」が導入されたので意味的には同意です。 Oracleのような「権限を集約した概念」という意味はありません。
># gcc sample.c ># gcc -I/usr/include sample.c ライブラリの指定がないみたいですが……環境変数とかで指定しているのでしょうか？ 「PostgreSQL libpq gcc」で検索して適当に見つかるページですが… http://www.fireproject.jp/feature/postgresql/pro … より… >これをコンパイルするには,ヘッダとライブラリの指定が必要である. >gcc -I/usr/include/postgresql/ -lpq connect.c ということで、-lpqも必要かと思われますがいかがでしょう？
> $sql = "select kaiin_no form store_table where kaiin_no = ".$kaiin_no; > Warning: pg_query(): Query failed: ERROR: syntax error at or near "form" at character 17 あ! すみません。 form がまちがいです。 正しくは from です。 $sql = "select kaiin_no from store_table where kaiin_no = ".$kaiin_no; ANo.3 は全部 form になってますね。。。 偉そうなことを書いておきながら面目ないです。。。
## php、PostgreSQLはさわっていないのであまり答える気はなかったけど。 チェックボックスを利用した質問の複数選択した回答ということなので、 漢字検定3級以上と英語検定3級以上にチェックを入れた場合、 //テーブル作成 ********=> create table sample03( ********(> 資格 int); の「資格」にはなにをいれるのでしょう？ ひょとして、23といれたい？ html上（というかブラウザ上というかそのDOM上ではというべきか？）では、sikaku[]は配列として扱われています。 だから、$sikaku = $_REQUEST["sikaku"];の結果は配列変数を受け取ると思うけど、 ・・・文字列変数として受け取れるのかもしれません。 （ここは私はわかりません。） 配列変数となっているなら$sikaku[0],$sikaku[1],・・・を順につなげる必要あるはずです。 で、SQLですが、 insert into sample03 values('$sikaku') のように''で囲むと文字型になり、数値型の項目に値を入れるときは大抵のデータベースではエラーに なります。（PostgreSQLはよく知りませんけど、タブンエラーになるはず） ここかもしれません。 どちらにしろ、$result にエラーが返ってきているのでは？ $result　か他のエラーコードなどを参照できるようにして確認するほうがいいでしょう。 ## 申し訳ないけど、これの方法は私はわかりませんので他の方の回答待ちしてください。
serial型利用してみてはいかがですか。
(1) スペースキーで 1ページ分進みませんか。 試していないので外してたらすみません。 (2) ググると \pset pager でページャの on/off が切り替えられるようです。 \pset pager off でもよいかな。
まずMySQLの「GROUP BYで指定されていない項目を集計関数なしに指定できる」というのがSQLの規格から外れていることを認識してください。 その上で http://postoro.blogspot.com/2011/03/mysql-group- … にありますけれど、どの行の値が使われるかは保証されません。 もし、MySQLの項目で最小値を表示したいということなら select count(*), a, min(b) from test group by a; にすればMySQL、PostgreSQLともに同一の結果を取得できます。
訂正します。 まずは素直に最終発言を抽出します。 select user_account_pkey,max(update_data) from log group by user_account_pkey これを使って log から必要なレコードをのみを抽出、user_account テーブルと結合して結果を得ます。 select ua.pkey,ua.user,ua.pass,l.comment,l.update_date from log l,user_account ua where l.user_account_pley = ua.pkey and (l.user_account_pkey,update_data) in ( select user_account_pkey,max(update_data) from log group by user_account_pkey ) ※SQLは机上で書きました動作確認はしていません。
>どのように設定したらよいのかわかりません。 手順としては １．ODBC ドライバをダウンロードする http://old.postgresql.jp/interfaces/index.html http://nami.jp/psqlodbc/ これを使うのが早いと思います。 ２．クライアント PC に ODBC ドライバをインストールする ３．接続テストを行う >PostgreSQLサーバに接続できません。 > >お使いのPostgreSQLサーバのバージョンが6.3以上である場合、postmasterの起動オプションに“-i”を指定してください。これを指定しないとpostmasterはTCP/IPによる接続を拒否してしまいます。 > >PostgreSQLサーバのホスト認証設定ファイル（data/pg_hba.conf）は正しく設定してありますか。この設定ファイルで他のホストからの接続を許可してあげてください。デフォルトのままでは他のホストからの接続は拒否されてしまいます。 http://www.interwiz.jp/software/PsqlODBC/faq.html >外部サーバーにあるデータベースにODBCを使用することは可能なんでしょうか？ 技術的には可能ですが、セキュリティ上、許可されていないことが多いと思います。 DB サーバ側のセキュリティ設定が外部からの接続を許可するように設定していること、DB ユーザアカウントが外部からの接続を許可されていること、 TCP/IP 接続が許可されていること、ファイアーウォールの設定で許可されていることなどを確認してみてはどうでしょうか。 まあ、わたしは PostgreSQL の詳細は分かりませんが、参考にしていただければ幸いです。
VACUUMのイメージは下記のページが詳しいです。 http://www.geocities.jp/sugachan1973/doc/funto60 … また、VACUUMはテーブル単位に実行できます。 FULL VACUUMを安全に停止する手段があれば、ファイルの再構成を行っていますから、再実行すれば前回の分はVACUUM済になる理屈ですが、FULL VACUUMを安全に停止する方法わかりません。 下手をしてファイルシステムに不整合を起こしてはなにもなりません。 お使いのPostgreSQLのバージョンはなんでしょうか？ 個人的には現在8.4系列あたりが一番安定している気がします。 VACUUMもバックグラウンドで行ってくれますので。
一応「MSXML2.XMLHTTP」という手段があります。EXCEL VBAからHTTPリクエストを投げてサーバーから結果を受け取るというものです。 http://d.hatena.ne.jp/end0tknr/20081115/1226755041 ただし、問題はあります。 (1)VBAからリクエストされたSQLを処理して結果を返すサーバー側プログラムが必要です。 (2)そして、その場合、最低限認証する仕組みの造り込みとユーザー名、パスワードの暗号化が必要でしょう。 そうしないと、とんでもないセキュリティホールをつくることになりかねません。
クライアントにODBCを入れてみる方法もあります。 （サーバーが外部だと、サーバ側のアクセス権や通信ポート解放等で難しいかもしれません） http://allabout.co.jp/gm/gc/47352/ http://www.postgresql.org/ftp/odbc/versions/msi/
文字データよりも数値データの方が良いと思います。 それも、使い方によるのですが、 アドレスのデータベースを作り、それと関連付けると、 文字データの取得もできるのでそちらの方が良いと思います。 データ容量を減らす意味でも数値データの方が良いです。
安定性から言えば8.4系の方が枯れている可能性が高いと思います。 ただ、pgpoolの頃ですがinsert into ～ select が使えない、シリアル値が保証されないなどの制限事項があったと思います。pgpool-II ではそこのあたりがどうなっているか調査する必要があると思います。 pgpool-IIの長所としてはコネクションプーリング機能があげられます。
SELECT coalesce(MAX(fld), 0) FROM tbl ; ではいかがでしょうか。
私も見たことのないメッセージですがよければエラーメッセージが出るSQLとテーブル構造を教えてください。
http://www.postgresql.jp/ オンラインマニュアル ==> 日本語マニュアル http://www.postgresql.jp/document/ バージョン8.3 ==> PostgreSQL8.3最新版 日本語マニュアル http://www.postgresql.jp/document/8.3/index.html 日本語ドキュメント一式のダウンロード http://www.postgresql.jp/document/8.3/postgres.t …
import.txt、 export.txt のファイルのある場所は psql コマンドを 実行したときのカレントディレクトリになります。 TeraTerm で大学のコンピュータに接続しているのならば、ファイルは 大学のコンピュータ上にあり、自宅のPCにはありません。 エクスポートしたファイルを自宅のPCに転送する必要があります。 Tera Term での接続時にSSHを選んでいるのであれば Tera Term の メニューの[ファイル] → [SSH SCP]でファイルの送受信ができると 思います。 またWinSCP 等のツールでも SCP によるファイル転送ができると 思います。
RHEL 6 に標準でバンドルされているパッケージは 8.4.4 です。 それ以外のリリースをインストールしたいなら野良ビルドする必要があるでしょう。 （他のリリースやディストリでコンパイルされたパッケージを使うのはもってのほか） 普通は Linux がサポートされていて（サポートされています）、かつコンパイルが 通れば（通るはずです）OKとすべきです。 http://www.postgresql.jp/document/9.0/html/suppo … いちいちディストリ/リリース毎にテスト/動作確認なんてしていないはずです。 なので、品質保証の部分は自分でテストを繰り返して向上していく必要があります。
PostgreSQLに限らず、統計情報を取得する場合テーブルやインデックスのアクセスが発生しますから、全く影響がないということはありません。 Oracleなどでは大きなテーブルのanalyzeの点にサンプリングする比率を指定できたりできますけれど。 できるだけDBへの負荷が少ない時間帯を選んで実行するしかないと思います。
「ローカル接続」と書いてありますが、WebサーバーとDBサーバーは別のサーバーインスタンスでしょうか。 そうだとすると、セキュリティグループの設定でPostgreSQLのポート(5432)を許可する必要があると思います。 Amazon Management Consoleですと、「Security Groups」から設定します。
yahoo知恵袋でも回答しましたが、テーブル設計に問題があります。 まず、「正規化」を勉強してください。 チームテーブルと選手テーブルテーブルを分ければ select チームテーブル.team from チームテーブル inner join 選手テーブル on チームテーブル.team=選手テーブル.team where 選手テーブル.name='mori' で行けます。
解決方法というよりはデバッグ方法ですが…。 postgresql.confの #log_destination = 'stderr' を log_destination = 'syslog' に変更してPostgreSQLを再起動してください。 その後、サーバ上で $ tail -f /var/log/message を実行したまま、別口からWebブラウザでpgAdminへのログインを試行してみてください。 messageファイル上に何かログが出るのであれば、そこに原因が書かれていると思います。 ※tailの実行をストップするときはキーボードで「Ctrl+C」を入力してください。
&& 演算子 (重複する, 共通要素を持つ) を使います。 SELECT * FROM (VALUES (ARRAY[1,3,5]), (ARRAY[3,8,9,10]), (ARRAY[2,6]) ) T(arr) WHERE ARRAY[1,2,6] && arr; 参考URL：http://www.postgresql.jp/document/current/html/f …
【No.1 の回答へのお礼での質問】への回答 メモリ上のすべての更新をディスクに反映する処理のことをチェックポイント処理と呼びます。チェックポイント処理は、完了済み WAL ファイルが checkpoint_segments パラメータに指定された個数を超えたとき、または、前回のチェックポイント処理の実行から checkpoint_timeout パラメータに指定された時間を過ぎたときに実行されます。 ただ、チェックポイント処理ですべての更新を一気に反映すると、一時的にディスク I/O への高負荷が発生してしまうので、チェックポイント処理とは別に少しずつディスクに反映させる writer プロセスが動作しています。 また、チェックポイント処理は CHECKPOINT コマンドで手動で実行することもできます。 ディスクに未反映の更新がメモリ上に存在しており、チェックポイント処理が実行されていない場合には、完了済み WAL ファイルとなっておらず、アーカイブ先のディレクトリに保管されません。従って、アーカイブ先のディレクトリに保管する前の WAL ファイルが消失した場合には、その WAL ファイル分の更新は復旧することができません。 参考URL：http://www.postgresql.jp/document/9.0/html/wal-c …
・mysqlにあるAUTO_INCREMENTがなくてOracle流のシーケンスオブジェクトで連番を振る必要がある。 ・データ型はそれなりに異なる。特にDATETIMEがPostgreSQLにないことと、TIMESTAMPの意味が違う（mysqlは自動取得する項目で1レコードに1つしか持てない）。日付演算がかなり違う。 http://kozy.heteml.jp/pukiwiki/MySQL%2520%25A5%2 … http://www.postgresql.jp/document/current/html/d … ・mysqlのinnodbのデフォルトのトランザクション分離レベルはrepeatable read(read committedにも出来る)だが、PostgreSQLはRead Committedがデフォルトなので場合によっては処理結果が異なる場合がある。 ・WITH句による共通表式や、WINDOW関数などが最近のPostgreSQLには実装されているので利用するとパフォーマンスが向上する場合がある。 ・JOINにネステッドループだけではなくHASH JOINも用いるので実行計画には注意した方がいい(書き方によってパフォーマンスに違いが出る)。
以下の SQL でどうでしょうか。 test=> SELECT * FROM test WHERE array_length(xpath('/a/b[c="1" and d="1"]', xml), 1) > 0; xml -------------------------- <a> + <b><c>1</c><d>1</d></b>+ </a> (1 行)
複数結合したいテーブルに異なる別名を付けて結合すれば良いかと。 例) ---------------------------------- SELECT 名前, k1.県名 as 出身県, k2.県名 as 現住所 FROM 人名表 p left join 県名マスター k1 on p.出身県 = k1.コード left join 県名マスター k2 on p.現住所 = k2.コード; -------------------------------------
WindowsVISTA以降は\Program Files内のファイルを直接編集できません(UACのため)。 編集結果を他の場所に保存して、コマンドプロンプトを「管理者として実行」で開き該当のフォルダにコピーしてください。
PostgreSQL自体が正常に動いているようであれば、pgsql.soをmakeし直してみてはいかがでしょう。 PostgreSQLのメジャーバージョンを上げているようなので、その影響があるかもしれませんね。 参考URL：http://d.hatena.ne.jp/bco/20101229/1293627841
initdb コマンドでデータベースクラスタを再作成する必要はありません。 postgres=# CREATE DATABASE test WITH TEMPLATE = template0 ENCODING = 'UTF-8' LC_COLLATE = 'C' LC_CTYPE = 'C'; CREATE DATABASE
1. Linuxのユーザー"database_6"でログインする。 2. psqlを使ってデータベースを"database_6"を、 PostgreSQLのユーザー"postgres"で開く。 psql [オプション] [データベース名 [ユーザー名]] psql database_6 postgres 3. COPYコマンドを実行する。 > ERROR: could not open file "/home/database_6/database_euc_4.csv" for reading: 許可がありませえん Linuxの"database_6"ユーザー以外で操作していませんか？ > -bash: COPY: command not found psqlを使わずに、直接LinuxのコンソールでSQL文を実行しようとしていませんか？
bash: psql: command not found　は psql コマンドにパスが通ってないだけですね。 FATAL: database "postgres" does not exist　は postgres ってデータベースが無いよって言ってます。
# phpPgAdmin を使ったことがないんで参考にならないかもしれませんが。 「特権項目」というのがデータベースオブジェクトに対するアクセス権限のことであれば、データベースの所有者はそのデータベース内のデータベースオブジェクトに対してすべてのアクセス権限を持つので、データベースの所有者でないユーザを作って必要なアクセス権限を与えるようにしてどうでしょうか。
データベースの文字エンコーディングは作成時にしか指定できないので、文字エンコーディングに UTF8 を指定してデータベースを作りなおす必要があります。 createdb -E UTF8 データベース名 データベースの文字エンコーディングはどうでもよくて単に UTF8 の CSV ファイルからデータをエクスポートしたいだけなら、COPY コマンドの実行前に SET client_encoding TO UTF8 でクライアントの文字エンコーディング UTF8 に変更してうまくいかないでしょうか。
7.x の PostgreSQL では COPY コマンドが WITH CSV をサポートしていないようです。 http://www.postgresql.org/docs/7.2/static/sql-co … http://www.postgresql.org/docs/7.4/static/sql-co … には WITH CSV がありません。 http://www.postgresql.org/docs/8.0/static/sql-co … http://www.postgresql.org/docs/8.4/static/sql-co … には WITH CSV があります。 できるだけ安定した新しいバージョンの postgresql-8.x を利用するのが望ましいのですが、 何か理由があって 7.2.3 を使うのであれば、COPY コマンドではない方法を探す必要があります。
http://oshiete.goo.ne.jp/qa/6748718.html のあとに何をやったんですか？ ># rpm -qa|grep postgres >を実行すると、何も表示されません。 rpmパッケージで入れていないのなら当然出てきません。 >/usr/local/pgsql/bin/postmaster ということは、ソースからmakeしたんじゃないんですか？ であれば、make install以外に、自分で設定ファイルをコピーする必要があるのかも知れません。 # 何度か回答していますが…Redhat8.0は手元にありませんし、 # postgreSQLも使っているワケではないので、細かいところは判りません。
>これは、.bashrcで追加した下記内容が読み込まれていないからでしょうか？ どのユーザーの.bashrcに設定しているのか…とかの問題もありそうですが… initdbを実行する前に printenvで設定されている環境変数確認してみてはどうですか？ ちなみに、環境変数に設定しなくても-Dオプションで指定すれば上書きされる(オプション指定の方が優先)のようです。
>$ initdb >-bash: initdb: command not found パスは通っていますか？ 一般ユーザで操作可能ですか？(こちらの場合は別のエラーになるでしょうけど) >postgresでログインしようとしましたが、パスワードの初期設定が分かりませんでした。 rootユーザーからsuコマンドで切り替えれば…そのまま入れませんか？ または、rootユーザでpasswdコマンドでパスワードを設定してみてはどうですか？ # ログインシェルとかホームディレクトリとか設定されている必要があるかも知れませんけど。
NEWに対して動くか試していないので分かりませんけれど 動的にテーブルやカラム名を指定するときは SQL文を文字列の結合||で作って、EXECUTEします。 こんな感じではないでしょうか。 EXECUTE 'INSERT INTO "テーブル名２" VALUES(NEW.' || rec.attname ')'; 動いたら是非教えてください(^^) 参考URL：http://www.postgresql.jp/document/current/html/p …
環境が x86-64 で /opt/prov/pgsql/lib/libpq.so ではなく /opt/prov/pgsql/lib64/libpq.so とリンクしなければならないということはありませんか？ であれば、configure時に適切にLDFLAGSを設定しておく必要があります。 LDFLAGS=-L/opt/prov/pgsql/lib64 \ LD_LIBRARY_PATH=/opt/prov/pgsql/lib64 \ ./configure ...
基本は同じです。 psql コマンドでデータベースに接続できていますか？ ユーザーやテーブルが作成できているなら、そこで COPY tablename FROM '/var/test/testdata.csv' WITH CSV; のようにすればＯＫです。 パスの書き方がWindowsと異なるだけでコマンドの構文はまったく同じです。
>3.でcommand not foundと表示されるため、# yum search postgresqlを実行しましたが、command not foundと表示されます。 そもそも…Redhat Linux 8.0用のyumコマンドが入っているんですか？ http://www.atmarkit.co.jp/flinux/rensai/linuxtip … だと、Fedora Legacyに「あった」ようですが、Fedora Legacy自体が既に終了していてサポートされていないハズですが……。 >postgresql-7.2.2-1 7.2.2が既に入っています。 サポートの終了しているRedhat Linux 8.0でどうにかするのは、もはや無謀…かと思われますが……。 # 自力でビルドするにしても、必要とするライブラリがRedhat Linux 8.0で用意できるかどうかも判りませんし…。 メモリ増設するなりしてもう少し新しいディストリビューションに移行した方がよい…かと思われますが……。 # ただし、実行環境の方も新しいものに置き換えできるのであれば…となりますけど。 閉じられたのでこっちで… >ところで、Linuxの場合、メモリを増設すると自動で認識されるのでしょうか？ たいてい、そのまま認識します。 4Gオーバーの場合はカーネルを換えるなどが必要になる場合もありますが…。
配列でもインデックスを使って検索できます。 CREATE TABLE test=> CREATE TABLE t (c int[]); CREATE TABLE test=> INSERT INTO t SELECT ARRAY[n] FROM generate_series(1, 100000) AS n; INSERT 0 100000 test=> EXPLAIN SELECT * FROM t WHERE c @> ARRAY[1]; QUERY PLAN ------------------------------------------------------- Seq Scan on t (cost=0.00..1986.00 rows=100 width=25) Filter: (c @> '{1}'::integer[]) (2 行) test=> CREATE INDEX t_c_idx ON t USING gin (c); CREATE INDEX test=> ANALYZE t; ANALYZE test=> EXPLAIN SELECT * FROM t WHERE c @> ARRAY[1]; QUERY PLAN ------------------------------------------------------------------------ Bitmap Heap Scan on t (cost=5.05..281.52 rows=100 width=25) Recheck Cond: (c @> '{1}'::integer[]) -> Bitmap Index Scan on t_c_idx (cost=0.00..5.03 rows=100 width=0) Index Cond: (c @> '{1}'::integer[]) (4 行)
最新レコードを抽出するのにnot existsを使う方法もありますね。 そこの部分以外はgacky-79さんのSQLをそのまま使わせていただきました。 SELECT 名前, 点数, 更新日付, CASE WHEN max_a.名前 IS NOT NULL THEN 0 ELSE 判定 END AS 判定 FROM (SELECT * FROM テーブルA AS A1 WHERE NOT EXISTS( SELECT * FROM テーブルA AS A2 WHERE A1.名前 = A2.名前 AND A1.更新日付 < A2.更新日付 )) AS テーブルA RIGHT JOIN テーブルB USING (名前);
ODBC接続なら該当するレジストリの部分を「.reg」ファイルにエクスポートし、各クライアントＰＣでダブルクリックしてDSNを登録することは可能だったと思います。
PostgreSQLの環境がないので試すことができないのですが、 connectby()関数を使ってみてはどうでしょうか。 「PostgreSQL 階層問合せ」などで検索してみるといいと思います。 参考になれば幸いです。
PostgreSQL 9.0 であれば、UNIQUE制約に遅延設定をするのはいかがでしょう？ ALTER TABLE ... ADD { UNIQUE | PRIMARY KEY } (...) DEFERRABLE 参考URL：http://lets.postgresql.jp/documents/technical/9. …
その後、以下のような文書を見つけました。参考になれば。 http://www.unisys.co.jp/tec_info/tr94/9405.pdf
REINDEXをテーブルごとに行っているならば、以下の手順でデッドロックは回避できます。 BEGIN; LOCK tbl IN ACCESS EXCLUSIVE MODE; REINDEX TABLE tbl; COMMIT; ただ、REINDEX中は参照も更新も待たされるため、基本的には、オンライン処理と並行しては実行できません。代わりに CREATE INDEX CONCURRENTLY + 古いインデックスを DROP INDEX というような運用を行うことはよくあります。 参考URL：http://www.postgresql.jp/document/current/html/s …
TEXT型で入っているんだったら、文字列操作でいけるでしょう。 > '10010000' から5桁目の値　'1'　のみを取り出す方法です。 「右から5桁目」=「左から4文字目」ということでしたら、列名XXXに対して、 SELECT … ORDER BY substr(XXX,4,1) DESC で出来るかと思います。 桁数が8桁とはかぎらず「右から5文字目」を見る必要があるなら、 SELECT … ORDER BY substr(XXX,length(XXX)-5+1,1) DESC で。
ウィンドウ関数の lag() を使えばお望みの結果が得られます。 -- tblは得意先マスタと製品マスタの結合結果として SELECT CASE 列1 WHEN lag(列1, 1) OVER (ORDER BY 列1, 列2) THEN NULL ELSE 列1 END, 列2, 列3 FROM tbl; 列1 | 列2 | 列3 -----+--------+----- A社 | A製品1 | A@1 | A製品2 | A@2 | A製品3 | A@3 B社 | B製品1 | B@1 | B製品2 | B@2 | B製品3 | B@3 参考URL：http://www.postgresql.jp/document/current/html/f …
PostgreSQLのバージョンは、何ですか？ 単に「エラーになる」といった提示でなく、具体的にどのようなSQLを書き、どのようなエラーになるのか、メッセージやコード類を提示するようにしてください。 情報を出さず、親切にSQLまで考えて回答してくださった方に、「既に再帰クエリを使ってまして・・・」なんて後出しするというのは、親身になってくださる方に無駄な労力を使わせていることになってしまいます。
亀レスですが。 ps = conn.prepareStatement("SELECT timedate FROM testtb WHERE timedate BETWEEN current_timestamp + cast ( ? as interval ) AND current_timestamp"); ps.setString(1,"-30 days"); 8..4だったらいけました。
何とか 「configure」「make」「mke install」で行けました。 参考にしたのは以下のページです。 http://90h-tech.blogspot.com/2010/02/postgresql. … ただ、ディレクトリィの書き込み権限でエラーが出るなどいくつか修正が必要です。 既に8.4をインストールした環境だとremoveしても、make結果でエラーが発生する可能性はありますね。
SQL2 では DECLARE d_current DATE:= NULL; が不要です。この2行を削除すれば、結果が返ることを確認しました。名前がかぶっているため、OUT パラメータを隠してしまっているようです。
OleDbDataReader.GetDecimal メソッドを使ったらどうなりますか。 http://msdn.microsoft.com/ja-jp/library/system.d …
すでにテーブルが存在する状態で、ダンプファイルからリストアしようとした時のエラーのようです。 「(4)再度、リストア」の時の、データベースの再作成(dropdb/createdb) は本当に成功していますでしょうか。 (3)のODBCで接続した時に、testdbにコネクションが張られた状態となり、 　testdbがdropできず、残ったままで、リストアしているのではないかという気がします。 　(SQL実行中でなくても、コネクションが1つでも張られている限り、 　データベースのdropはできません。） (4)のsudo -u test dropdb testdb　実行後に、psql -l で確認すると、testdbは 　消えておりますでしょうか。 (外していたらすいません)
行統計情報の収集機能を有効にしていますか。 stats_row_level = on また、バージョンが違いますが、下記などが参考になると思います。 http://oshiete.goo.ne.jp/qa/5775824.html
あくまで個人の経験からの話です。 記載されている内容から、 「could not receive data from server: Software caused connection abort(0x00002745/10053)」 の時点でPostgreSQLのサービスが落ちて、サーバー自体の再起動時に、PostgreSQLのサービスが 上がって正常復旧。という状況かと思われます。 障害が起きた時に実行したSQL文は、select文でしょうか。 それならば、キャパシティをオーバーする大量行数のクエリが返るSQLでハングすることはありえても DBMS(PostgreSQL本体)や、データベースがぶっ壊れることはまずないと思われます。 また、select文ならばトランザクションの復旧などは不要です。 PostgreSQL8.1は、Windows版でしょうか。 「アーカイブ形式のバックアップだと一部テーブルのレコードが一切復元されない」のは、 はもともとである気がします。 今回の障害以前に、アーカイブ形式のバックアップ＆リストアは成功した実績はありますでしょうか。 私は、8.1のWindows版で、アーカイブ形式で上手くいったためしがないので、 これは“使えない機能”と判断し、いつも必ずプレーンテキストでダンプしてました。 全テーブルのレコード数一覧をとる方法ですが、私は、 select count(*) from テーブル1; select count(*) from テーブル2; select count(*) from テーブル3; … とSQL文を羅列したファイル(仮にc:\temp\getcnt.sqlとする)を作り、コマンドラインから、psqlで \o c:\temp\res.txt \i c:\temp\getcnt.sql \q のように、ファイル（この場合、c:\temp\res.txt）に実行結果を書き出して、数えています。 （なお、Windows版の場合、psql を使うときは、 　>psql -U postgres <データベース名> 　のように、ユーザ名(postgres)を指定してpsqlに接続する必要があります。） ご心配でしたら、ためしに別の名前のデータベースを作って、そこにダンプをリストアしてみて、 行数をカウントして本番サーバと同じであれば特に問題ないのではと思います。 過去、PostgreSQL(Linux版)のデータベースがぶっ壊れた状態も経験していますが、 その時は、ダンプ時にエラーが出ました。特定のテーブルに差し掛かった時に 読めないと怒られるという状況でした。 ぶっ壊れた原因はメモリ障害でした。SQL文ごときでデータベースがぶっ壊れるというのは まずありえないのではないかと思います。
こんばんは。 インストールログは見ましたか？ ログの内容を補足して欲しいです・・・。 なんか、 secondary logon サービスを自動起動にしておかないとダメだとかなんとか・・・云々。
full outer joinではダメなのでしょうか。
URLを示しておいて自分がちゃんと読んでなかったですね・・ 申し訳ありません。 9.0.3からはvalue PRECEDING、value FOLLOWING という書き方もできるようですね。 ということで、ご自身でも考えていらっしゃるようですが訂正版です。 select 　棚,部品,在庫, 　case 　--累計在庫が引当総数に満たない時は、当該棚から引当てる 　　when 550 /* 引当総数 */ - COALESCE(累計在庫,0) > 0 then 　　　case 　　　　--当該棚から全在庫を引当てると引当総数を越えてしまう場合は、引当総数-累計在庫を引当てる 　　　　when 550 - (COALESCE(累計在庫,0) + 在庫) < 0 then 550 - 累計在庫 　　　　else 在庫 　　　end 　else 0 end 引当 from ( 　select 　　棚,部品,在庫 　　--在庫の昇順に並べ、1行前までの累計在庫を取得 　　/* 訂正 　　,sum(在庫) over(partition by 部品 order by 在庫 　　　rows between unbounded preceding and 1 preceding) 累計在庫 　　*/ 　　,sum(在庫) over(partition by 部品 order by 在庫 　　　rows between unbounded preceding and current row) - 在庫 累計在庫 　from テーブル 　where 部品 = 'A' /* 対象部品 */) order by 棚; うまくいくといいのですが・・
マニュアルから 「区切り文字、QUOTE文字、NULL文字列、復帰、改行文字を含む値の場合、全体の値の前後にQUOTE文字が付与されます。」 すなわち、これらの文字を含まない場合はQUOTEされません。 強制的にQUOTEするには、項目を指定してFORCE QUOTEする必要があります。 http://www.postgresql.jp/document/current/html/s …
pg_class テーブルの relpages と reltuples の比を取ってみると参考になるかと。 例えば、1行当り1000Byte以上使っているテーブルを表示するには下記の様にします。 例) ------------------------------------- select relname, reltuples::int8, relpages::int8, CASE WHEN reltuples > 0 THEN (relpages::int8 * 8192) / reltuples::int ELSE (relpages::int8 * 8192) END as per_row from pg_class where relkind = 'r' AND relpages::int8 >= 2 AND CASE WHEN reltuples = 0 THEN TRUE ELSE (relpages::int8 * 8192) / reltuples::int > 1000 END order by per_row desc; ----------------------------------------- 1行分のデータが少ないはずの無いテーブルが含まれていたら、おそらく更新・削除による不要なデータが溜まっているのかと。 なお、ブロックサイズがデフォルト以外の場合は、8192を実際のブロックサイズに変えて下さい。
>理想原価を抽出したい は、部品と予定購入数みたいな数値を渡すと上記テーブルから記載の条件で原価を取得する、 という意味で合ってますか？ とりあえず、そう考えて書いてみました。 select 部品,原価 from ( 　select t.* 　　　　　--部品ごとに購入数で並べた時、前レコード前が存在するときはその購入数・存在しない時は0 　　　　　,lag(購入数,1,0) over(partition by 部品 order by 購入数) + 1 下範囲 　　　　　--部品ごとに購入数で並べた時、後レコードが存在するときは0・存在しない時は99999999 　　　　　,lead(0,1,99999999/* ※1 */) over(partition by 部品 order by 購入数) 上範囲 　from t) where 部品 = 'A'/* ※2 */ and (310 /* ※3 */ between 下範囲 and 購入数 or 310 /* ※3 */ between 購入数 + 1 and 上範囲) ; ※1にはこれ以上の購入数はありえない、という値を設定してください ※2・※3は検索条件にあたる部品・購入数を設定してください。 ただ、PostgreSQLの環境がないのでOracle10gで試したものですので上手くいかないかもしれません。 PostgreSQL8.4から分析関数が利用できるようなので大丈夫かなと思いますが・・ http://www.postgresql.jp/document/8.4/html/funct …
こんばんは。 多分postgresはウィンドウ関数が使えたはず・・・？ select カテゴリ, 商品名, case when 日付が1月なら（ここの条件がわからん・・・） then 値 else 0 end as 1月, case when 日付が2月なら（ここの条件がわからん・・・） then 値 else 0 end as 2月, sum(値) over(partition by カテゴリ) as カテゴリ合計 以下略・・・ 最近postgresやってないので、SQL忘れた・・・。 考え方はあってると思いますが？
\encoding は、データベースサーバとクライアントとの間で 文字コードを変換することを指示します。 \encoding SHIFT-JIS とすれば、クライアントが扱う文字コードは SHIFT-JIS として、データベースに登録する際は SHIFT-JIS から データベースの文字コードに変換され、データベースからデータを 取り出した場合は、データベースの文字コードから SHIFT-JIS に 変換されて取り出されます。 しかし、これとは別に端末ソフトウェアが扱う文字コードがあります。 ご利用になられている端末ソフトウェアは何でしょうか。 TeraTerm, Putty それとも Linux 上で Gnome 端末でしょうか。 これらの端末ソフトウェアにも文字コードの設定があり、UTF-8 と 設定した端末では SHIFT-JIS に変換されて取り出されたデータは 正しく表示されません。 質問されている例では、端末ソフトウェアの文字コードが UTF-8 と 設定されているのに、データベースからデータを SHIFT-JIS や EUC-JP で取り出しているために化けているのだと思います。
１．user idとして、postgresを作成します。 　　# adduser postgress 　　# passwd postgress 2..インストールディレクトリーの野作成 　　# mkdir -p /usr/local/pgsql 　　# chown postgres.postgres /usr/local/pgsql 　　# chmod 755 /usr/local/pgsql 3.ソースの解凍/インストール 　　% su - postgres 　　% cd /usr/local/pgsql 　　% tar xvf /xxx/xxx/postgresql-8.4.5.tar.gz 　　% cd postgresl-8.4.5 　　% ./configure --with-perl 　　% make all 　　% make install 　　% cd doc 　　% make install デフォルトのインストール先が/usr/local/pgsqlになっているので、これを指定する必要はありません。 4.自動起動設定 　　# cd /usr/local/pgsql/postgresql-8.4.5/contrib/start-scripts 　　# cp linux /etc/rc.d/init.d/postgresql このpostgresqlを修正し、$PGDATAを/home/postgres/dataに変更します。 chkconfigを使って、起動設定をします。 5.シェアードライブラリー設定 　　# cd /etc/ld.so.conf.d 　　# vi postgresql /usr/local/pgsql/lib 　　# ldconfig 6.データベースの初期化 　　% su - postgres 　　% initdb -E UNICODE 7.設定ファイルの初期化 　　下記ファイルに初期設定を追加します。 　　/home/postgres/data/pg_hba.conf 　　/home/postgres/data/postgresql.conf 8.postgrsqlの起動確認 　　# /etc/rc.d/init.d/postgresql start 　　# ps -ef | grep postgres ここで、タスクが5個ぐらい起動していれば、正常です。
条件を''で括り、演算子は、~*を使えば良いと思います。 delete from table_a where a_key ~* '1400 returning *';
設定の問題ではなく、PostgreSQL本体にメモリリークのバグが原因と思われます。徐々にメモリ消費が増えていってしまいます。 9.0.2で修正されているので、アップデートしてみてください。 - Fix long-term memory leak in autovacuum launcher (Alvaro Herrera) バージョンアップしないで対処となると、PostgreSQLサービスを定期的に停止／再起動するくらいしか手がありません。 参考URL：http://www.postgresql.org/docs/9.0/static/releas …
pg_dump --schema-only と --data-only で、スキーマとデータを分けてダンプしてはいかがでしょう？ スキーマのほうにテーブルとインデックスの定義の両方が含まれてしまうため、テキストエディタ等で手作業で分離する必要がありますが、データを含んでいないのでファイルサイズも小さくなり、編集しやすくなるかと思います。 参考URL：http://www.postgresql.jp/document/current/html/a …
MeCab が 00001 を 1 つの単語として切り出してインデックスを作っているので、基本的には 0000 で検索してもヒットしません。 MeCab を使うような分かち書き方式の全文検索では、単語を切り出すときに使う辞書によるので、お望みのようなことを行うには N-gram 方式の全文検索が適しています。PostgreSQL では Senna や Groonga といった N-Gram 方式の全文検索エンジンと組み合わせた textsearch_senna や textsearch_grronga を使うのがいいでしょう。 ただ、PostgreSQL 8.4 以上をお使いのようですので、前方一致であれば MeCab でも 0000 をインデックスを使って検索できます。 SELECT * FROM table1 WHERE tsv @@ to_tsquey('japanese', '0000*');
LINUXにデフラグはありません。 Postgresは追記型なので、Updateを繰り返すと、ファイルがディスク内で細切れになり、遅くなります。 バキュームはホールを無くしてくれますが、細切れになったファイルはそのままです。 遅くなったら、バックアップ後、mkfs.ext3でファイルシステムを作り直して、リストアするしかないですね。 http://www.linuxlic.com/command/mkfs.html それが嫌だったら、ホールを再利用するOracleに乗り換えた方がいいですね。
インストールして一度起動しないと,PostgresのDBが作成されないので、エラーになっているだけでは？
要件に矛盾があります。 > 1 |a |作業中 |1 「No=1」かつ「名称='a'」の行は2行あり、それぞれ「状態」は「作業中」と「準備中」があるので、どの「状態」とすればいいのか決められません。 「作業中」もカウントするというなら、例えば次のようなSQLで実現可能です。 -- sum関数 select "No." ,"名称" ,sum(case when "状態"='作業中' then 1 else 0 end) as "作業中数" ,sum(case when "状態"='準備中' then 1 else 0 end) as "準備数" from "tblA" group by "No.","名称" order by "No." ; -- count関数 select "No." ,"名称" ,count(case when "状態"='作業中' then 1 else null end) as "作業中数" ,count(case when "状態"='準備中' then 1 else null end) as "準備数" from "tblA" group by "No.","名称" order by "No." ;
ドメインを使うといいと思います。 ドメインというのは既存のデータ型に対して制約を加えて別の名前を付けたものです。 CREATE DOMAIN zodiac AS text CHECK (VALUE IN ('Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo', 'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces')); CREATE TABLE t ( c zodiac ); ---- => INSERT INTO t VALUES ('Aries'); INSERT 0 1 => INSERT INTO t VALUES ('foo'); ERROR: value for domain zodiac violates check constraint "zodiac_check" ---- もしくは、列挙型を使ってもいいと思います。こちらのほうがより適切かもしれないです。 CREATE TYPE zodiac AS ENUM ('Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo', 'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces'); CREATE TABLE t ( c zodiac ); ---- => INSERT INTO t VALUES ('Aries'); INSERT 0 1 => INSERT INTO t VALUES ('foo'); ERROR: invalid input value for enum zodiac: "foo" LINE 1: INSERT INTO t VALUES ('foo'); ---- 参考URL：http://www.postgresql.jp/document/current/html/s …
http://oraclesqlpuzzle.hp.infoseek.co.jp/postgre … こちらを参考にさせて頂きました。 --- with recursive rec(id, name, parent, path) as( select id, name, parent, array[id] from testtable where parent = 0 union all select b.id, b.name, b.parent, a.path || b.id from rec a Join testtable b on a.id = b.parent) select id, name, parent, path, array_upper(path, 1) as LV from rec order by path; --- PostgreSQL9.0.1で試したところ、ご要望どおりの結果を取得できました。 参考URL：http://oraclesqlpuzzle.hp.infoseek.co.jp/postgre …
Windowsみたいなので、FINDSTRコマンドを使うといいと思います。 FINDSTR /B [a-zA-Z] 外部ファイル.txt | psql -c "COPY table1 FROM stdin DELIMITERS ' ' NULL ''" FINDSTR /B [0-9] 外部ファイル.txt | psql -c "COPY table2 FROM stdin DELIMITERS ' ' NULL ''" 外部コマンドを使わないんだったら、table1にトリガを定義して英字でなければtable2に挿入するように作り込むという手もありますね。
変数宣言というよりは、重複した制約の宣言を避けるという観点ですが、2案あります。 1. 制約の条件を関数で宣言しておいて、その関数を CHECK 制約で使う方法 CREATE FUNCTION check_policy(integer) RETURNS bool AS 'SELECT $1 in (-3,-2,-1,0,1,2,3,4)' LANGUAGE sql IMMUTABLE STRICT; CONSTRAINT rangeMin check (check_policy(policyMin)) 2. 条件込みの DOMAIN (定義域) を作成し、rangeMin/Max の型に、この DOMAIN を使う方法 CREATE DOMAIN checked_integer AS integer CHECK (VALUE in (-3,-2,-1,0,1,2,3,4)); 参考URL：http://www.postgresql.jp/document/current/html/s …
Perl DBI を利用した DBI-Link というモジュールで、PostgreSQL以外のDBに直接SQLを発行できます。ただ、PL/Perlを使っているため、Perlのインストールが必要です。 参考URL：https://github.com/davidfetter/DBI-Link
参考 URL の幾何データ型に対する演算子を使えばできます。 SELECT * FROM test_table1 WHERE point '(0,80)' <@ ANY (test_lseg); インデックスを使うのは難しい、というかできないと思います。 参考URL：http://www.postgresql.jp/document/8.4/html/funct …
物理メモリーは何メガバイト積んでいるのでしょうか.１GB未満は問題がありますね。 postgres.confの設定はどうなっていますか? ＃ディスクアクセスの高速化設定 fsync = off wal_sync_method = open_sync の設定はしていますか. ＃物理メモリー使用量の設定 shared_buffers = 2048 sort_mem = 1345 vacuum_mem = 8192 ※上記のサイズは、128KByte単位です。 この設定だと、Postgresの物理シェアードメモリーバッファサイズが256MBになります。 でも、8万行程度のインサートは10秒ぐらいで終わると思います。 Postgresは、メモリーをいっぱい積んで、設定を正しく行えば、高速に動作しますよ. 但し、Ver 8.3以降ですが。
情報が少ないんで何とも言えませんが、pgpool-II でレプリケーションを行っており、片方のノードが切り離されるとしたら、何らかの原因でノード間のデータに不整合が発生したものと考えられます。 pgpool-II のログに「kind mismatch among backends」とか出てたらビンゴです。 pgpool-II のバージョンによって異なりますが、serial 型や current_timestamp 関数などを使っているとデータの不整合が発生する場合があります。 まずは pgpool-II のログを取るように設定し、ノードが切り離された際にどんなメッセージが出るかを確認するのがいいと思います。 参考URL：http://pgpool.projects.postgresql.org/pgpool-II/ …
コレーション（lc_collate）と文字型（lc_ctype）は PostgreSQL 8.3 まではデータベースクラスタの作成時にしか指定できないので、pgAdmin III でデータベースの作成時に選択できないようになっているものと考えられます。
>Cent osのデータベースサーバーの選択としてpostgrsqlをインストールしました。 バージョンは？ >いつの間にか/var/lib/pgsql/dataにも出来ています。 CentOS5.5のリポジトリから入るものだと、 /etc/init.d/postgresql で PGDATA=/var/lib/pgsql によって指定されています。 そのままスクリプトを読んでいくと、 /etc/sysconfig/pgsql/postgresql というファイルがあれば、そちらでオプションなどを上書き可能なようですので、 PGDATA=/pgsql と記述すれば切り替えてくれるのではないでしょうか？ # /etc/sysconfig/pgsql/S64postgresql かも知れませんが… あるいは、 rm -rf /var/lib/pgsql ln -s /pgsql /var/lib/pgsql として、シンボリックリンクを張るとか。
提示されたデータ以外に例えば次のようなデータがあった場合、user=f、gが検索される必要があると言うことでいいですか？ insert into "num" values ('f',1100) ,('f',2100) ,('f',2300) ,('g',2300) ; (1) -- idの値が、2200台では2201と2202しか持たないuserを得る select x."user" from "num" as x inner join (select "user" from "num" where "id" between 2200 and 2299 group by "user" having count("id")=2) as y on x."user"=y."user" and x."id" in(2201,2202) group by x."user" ; (2) -- idの値が、2200台を持たないuserを得る (select "user" from "num" group by "user" ) except (select "user" from "num" where "id" between 2200 and 2299 group by "user" ) ; (3) -- 二つのクエリをunionで繋ぐ -- idの値が、2200台では2201と2202しか持たないuserを得る select x."user" from "num" as x inner join (select "user" from "num" where "id" between 2200 and 2299 group by "user" having count("id")=2) as y on x."user"=y."user" and x."id" in(2201,2202) group by x."user" union ( -- idの値が、2200台を持たないuserを得る (select "user" from "num" group by "user" ) except (select "user" from "num" where "id" between 2200 and 2299 group by "user" ) ) ; (2)のクエリで得た結果を(1)にunionで繋ぐため、()が増えていることに注意してください。
select * from pg_catalog.pg_class,pg_catalog.pg_statio_user_tables where relkind='r' and pg_catalog.pg_statio_user_tables.relid=pg_catalog.pg_class.relfilenode ですかね。
pg_dumpの出力は文字列です。 だから、tailとか使えば、エラーが発生した直前のレコード等が見えると思います。
「ポスト・グレス・キュー・エル」みたいですね。 以下↓のページの１番目のFAQに読み方と音声ファイルへのリンクあり。 http://www.linux.or.jp/JF/JFdocs/PostgreSQL-FAQ. … 実際に口に出して言う時は「ポストグレス」または「ポスグレ」って言ってます。
簡単には実現できないです。 データベースの一覧は pg_database を参照すれば取得できますが、スキーマとテーブルの一覧は接続中のデータベース内のものしか取得できません。 接続中のデータベース内のスキーマとテーブルの一覧であれば以下の SQL で取得できます。 SELECT n.nspname, c.relname FROM pg_namespace AS n JOIN pg_class AS c ON (n.oid = c.relnamespace) WHERE c.relkind = 'r'; どうしても別のデータベース内のスキーマとテーブルの一覧を取得したい場合には、dblink などのモジュールを使用する必要があります。 ただ、dblink を使用しても PL/pgSQL 関数などを作成せずに 1 つの SQL で実現するのは困難です (私の技術がないだけかもしれませんが)。 以下の SQL でデータベースの一覧を取得し、各データベースに接続してスキーマとテーブルの一覧を取得するのが簡単だと思います。 SELECT datname FROM pg_database WHERE datallowconn;
pg_toast は TOAST テーブル、pg_temp_xxx (xxx はセッションごとに異なる) は一時テーブルが作成されるスキーマです。 ちなみに TOAST テーブルというのは巨大なデータを内部的に分割して格納するためのテーブルです。TOAST については参照 URL を読んでみてください。 参考URL：http://www.postgresql.jp/document/8.4/html/stora …
データを更新しても即座にチェックポイントは実行されませんが、WAL ファイル (いわゆるトランザクションログ、REDO ログと呼ばれるもの) への書き込みが発生します。 従って、WAL ファイルへの書き込みによってディスク I/O は発生しますが、そのコストはチェックポイントの実行に比べて非常に小さいものです。
結論から言ってしまうと、不要になった WAL セグメントは再利用されるので、一定以上のディスク容量は消費しません。 WAL セグメントはビルド時に明示的に指定しない限り 1 個あたり 16MB であり、通常、セグメント数は (2 + checkpoint_completion_target) * checkpoint_segments + 1 個以下なので、PostgreSQL 8.4 のデフォルトの設定のままであれば 64MB (((2 + 0.5) * 3 + 1) * 16MB) 以下になります。 あと、checkpoint_timeout パラメータは WAL セグメントを作成する間隔ではなく、チェックポイントを実行する間隔を指定するパラメータです。 まず、WAL やチェックポイントが何なのかを理解したほうがいいと思います。 参考URL：http://www.postgresql.jp/document/8.4/html/wal.h …
pg_encoding_to_char関数で文字エンコーディング名に変換できます。 => SELECT datname, pg_encoding_to_char(encoding) FROM pg_database; datname | pg_encoding_to_char -----------+--------------------- template1 | UTF8 template0 | UTF8 postgres | UTF8 (4 rows)
対象となる列が固定なら他の方が回答しているようにCASE式を使用するか、coalesce関数を使用すればNULLでない最初の値を1つのSQL文で取得できます。「タイプ」列についてもCASE式で対応すればいいでしょう。 SELECT CASE WHEN タイプ = 0 THEN coalesce(price_1d, price_2d, price_3d, ..., price_31d) WHEN タイプ = 1 THEN coalesce(price2_1d, price2_2d, price2_3d, ..., price2_31d) ELSE NULL END FROM テーブル;
回答番号: No.2 の続きです。 aForm.getPrefecture() などの戻り値が null ではなく空文字 ("") の場合には、coalesce 関数の 1 つ目に渡している条件式の結果が NULL になりません。空文字の場合には NULL になるように nullif 関数をかませるとうまくいくと思います。 String selectStatement = "SELECT * FROM test,test_list WHERE test.id = test_list.id " + "AND coalesce(prefecture=nullif(?, ''), true) " + "AND coalesce(low_price>=nullif(?, ''), true) " + "AND coalesce(low_age>=nullif(?, ''), true) " + "AND coalesce(sameday_select =nullif(?, ''), true) " + "AND coalesce(terms_select =nullif(?, ''), true)" + "AND coalesce(category=nullif(?, ''), true)"; 値が指定されていない場合に aForm.getLow_price() などの int 型の戻り値がどうなるかが分からないのですが、0 を返すなら nullif(?, 0) などと書き換えてあげる必要があるかもしれません。
ツールとしては、 pgpool-II や PGCluster が思い当たります。 使ったことは無いので詳細は分かりませんが。 参考URL：http://www.techscore.com/tech/sql/replication/1. …
pg_dump コマンドに -F (--foramt) c を指定して出力したバックアップファイルは PostgreSQL 独自の圧縮形式 (単純にテキスト形式を圧縮したものではない) となるので、一般的なアーカイバでテキスト形式に変換することはできません。 もし、テキスト形式に変換したいのであれば、pg_restore コマンドを使用してください。pg_restore コマンドは、テキスト形式以外のバックアップをリストアするためのコマンドですが、-d オプションでリストア先のデータベースを指定せずに実行すると、テキスト形式に変換した結果を標準出力に出力してくれます。
こんにちは。 0x11223344・・・・を数値として保存しようとしたら切り詰められるかと。 文字列として保存する場合はドキュメントに ----------------------------------------- 短い文字列（126バイトまで）の保存には、実際の文字列に１バイト加えたサイズが必要です。 characterでは空白によるパッド分が加わります。 ----------------------------------------- とあります。 Postgres側のデータ型が varcharでいいのかってことですが、ロケールによっては NGの場合があるかもしれないので私でしたら素直に？bytea型にします。 bytea型で文字列リテラルとして入力する方法はドキュメントをご覧ください
pg_dumpコマンドによってデータベース内のデータをファイルに出力する際、とくにオプションを指定しなくてもzlibライブラリによってファイルが圧縮されるということです。 参考URL：http://www.postgresql.jp/document/8.4/html/backu …
zip形式は以下のURLのzip archiveというリンク先からダウンロードできます。 http://www.postgresql.org/download/windows
まず、前置きです。 表の定義情報などが登録先は、RDBMSによりカタログ、ディクショナリなど管理方式や呼称が異なり、その参照方法も独自のコマンドを使ったり、SQLのSELECT文で行えたりします。 各RDBMSごとにバラバラである「定義情報の参照方法」について、標準SQLで情報スキーマ(information_schema) が規定され、各RDBMSによる実装も進みつつあります。 たとえば、標準SQL準拠で情報スキーマを実装しているRDBMSでは、 表名一覧・・・データベース名、スキーマ名などを条件に、information_schema.tables 表を検索 表の構成列一覧・・・データベース名、スキーマ名、テーブル名などを条件に、information_schema.columns 表を検索 を参照すれば、名称などを同じように得られます。 ただし、データベース、スキーマ、ユーザなどのRDBMSにより概念に違いがあるものは、どの表のどの列に情報を入れているかを確認する必要があります。 さて、列名やデータ型ですが、前述のように information_schemaのcolumns表を検索すれば得られます。 ここで問題になるのは、データ型です。 文字型、数値型、日付型など様々なデータ型があり、また長さを指定するものや指定しないものがありますよね。 単純にchar、varchar、integer、dateなどのレベルの情報であれば、data_type 列で得られるのですが、長さなどの情報はdata_type列の内容により、参照すべき列が異なってきます。 どのレベルまで知りたいのか分かりませんが、実際にcolumns表の内容を確認し、得たい情報を自分なりに調べてみてください。 PostgreSQLの information_schema.columns 表 の詳細については、以下を参照してください。 http://www.postgresql.jp/document/pg830doc/html/ … information_schema.columns 表 の検索例は、次のような感じです。 select table_schema as scm ,table_name as tbl ,ordinal_position as "no" ,column_name as clm ,data_type ,character_maximum_length ,character_octet_length ,numeric_precision ,numeric_precision_radix ,numeric_scale from information_schema.columns where table_name in('t1','t2') order by table_name,ordinal_position
「time 定数」で「指定した定数をtime型と認識してね」という構文であり、「time 列名」という構文はありません。 標準SQL準拠の書き方であれば、 CAST(列名 AS TIME) [AS 別名] PostgreSQL独自の書き方であれば、 列名::time といった書き方もあります。
pg_dumpコマンドの引数に -h localhost を追加すればよいと思います。
pg_stat_activity ビューを参照すれば、実行中の SQL とその PID を特定できるので、 test=> SELECT procpid, current_query FROM pg_stat_activity; procpid | current_query ---------+---------------------------------------------------------------- 17288 | <IDLE> in transaction 17287 | UPDATE branches SET bbalance = bbalance + 1487 WHERE bid = 5; スーパーユーザでデータベースに接続し、その PID を指定して pg_cancel_backend 関数を呼び出してあげれば、実行中の SQL をキャンセルしてサーバとの接続を切断できます。 test=> SELECT pg_cancel_backend(17287);
単にselectの時に行番号が欲しいのであればこれでいけると思います。 （あまりスマートではありませんけど） create temp sequence temp_seq; select nextval('temp_seq') as row_num, * from 売上テーブル ; 「みかん＝３行目」という結果が必要だとすると一旦テンポラリテーブルに格納してからselectするといった工夫がいると思います。 流動的なselectの結果に行番号を着けてもあまり使い道がないように思うのですが、 何のためにこういう抽出が必要なのかをご説明いただいたほうが、他の方々から もっと有用なアイディアがいただけるのではないかと考えます。
こんにちは。 >例えばサーバーへODBC＆ADOで接続した場合、 >ワークテーブルの取扱方法（接続方法）が分かりません。 素のPostgreSQLからAccessへの接続する方法はありません。ですから、 基本的には クライアントのAccessからPostgreSQLに接続することになります。 したがって、Jet-SQLの機能でPostgreSQL上のテーブルを外部テーブルとして 処理します。 で、どうするかですが、リンクテーブルが使えなくなってしまったので SQLのIN句を使います。 PostgreSQLからAccessにデータを渡すのは INSERT INTO jettbl (f1, f2, f3) SELECT f1, f2, f3 FROM [ODBC;DRIVER=PostgreSQL35W;SERVER=srv1;DATABASE=db1;UID=xxx;PWD=yyy;].pgtbl; こんな感じでできます。これを参考にされればこの逆は想像できませんか。
ANo.1で回答した者です。 > 今、インストーラを調べたら、8.4.1でした。 このバージョンをアンインストールしてから、あらためて8.4.3をインストールしてみてください。
bash等のB sh系では 変数名=値 コマンド.... とすると、変数に値を(一時的に)設定してコマンドを実行します。 > PSQL='COPY bat_test FROM ' '''/test/test.csv''' ' with DELIMITER ' ''',''' この文ですが、環境変数 PSQL='COPY bat_test FROM ' をセットした状態で '''/test/test.csv''' ' with DELIMITER ' ''',''' を実行する、という意味になります。 'は 2つずつペアになるので ''が空文字列 '/test/test.csv'が/test/test.csv ''が空文字列 となり、 /test/test.csv がコマンドとして実行されます。 が、実際には実行属性が無いので permission denided になります。 (実行属性があったとしても、test.csvが実行できるとは思いませんが) この行全体をPSQL変数に設定したいのなら PSQL="'COPY bat_test FROM ' '''/test/test.csv''' ' with DELIMITER ' ''','''" と、全体をダブルクォートでくくるとか PSQL='COPY bat_test FROM '\ '''/test/test.csv'''\ ' with DELIMITER '\ ''',''' と、スペースを\でエスケープて、単語の区切りとしての意味を無効にします。 ところで、'''を、 'の中に'を入れる目的で使ってませんか? VisualBasic等はそういう書き方をしますが、bashではその意味では使えません。 'のなかに'は書けないので、全体をダブルクォートでくくる PSQL="COPY bat_test FROM '/test/test.csv' with DELIMITER ','" とか、シングルクォートの前でいったんシングルクォートを閉じて、"'"か\'でシングルクォートを単独で使い、再びシングルクォートを始める PSQL='COPY bat_test FROM '\''/test/test.csv'\'' with DELIMITER '\'','\' とかします。 #等幅フォントで見ないとわかりずらいものになってしまいました。
私も同様の症状でインストールに失敗した一人です。 原因はWindows7 OS のセキュリテイ機能にあります。 ポイントは「一般ユーザー」でログオンし実行することです。 対策の手順として以下の通りに実行してみてください。 1.Windows7に管理者ユーザーでログオンして、権限：管理者としてユーザー「postgres」 を追加してください。（必ずパスワードを忘れないように） 2.アンチウィルスソフトの一部に影響を与えるものがある為念のためサービスを一旦停止 します。 ファイヤーウォールは有効のままで大丈夫です。。 3.Windowsを一旦ログオフして、一般ユーザー（管理者権限でない）でログオンし直します。 4.PostgreSQLのインストーラーのダウンロードですが、Windows7のOSに合わせて32ビット 用か64ビット用を選択して実行してください。 5.ダウンロードしたインストーラーを右クリックしてプロパティを表示させます。 「全般」タグの一番下「属性」の部分に「このファイルへのアクセスはブロックされる 　　　　可能性がある・・・」 と表示されている様なら「ブロックの解除」ボタンをクリックして解除してください。 6.インストールの開始でまずインストーラーファイルを右クリックし 「管理者として実行・・・」をクリックして実行します。 「管理者ユーザー」選択のダイアログボックスが表示されたら「postgres」を選択し 登録したパスワードを入力します。 これで正常にインストールが開始されるはずです。 7.途中インストールフォルダの指定する画面が出たらデフォルトの 「C:\Program Files (x86)\PostgerSQL\xxx」を「C:\PostgerSQL\xxx」等の ディレクトリに変更し最後に「postgres」ユーザーのパスワード入力画面では Windows7の「postgres」ユーザーパスワードを入力しインストールを完了してください。 8.最後にWindows7の管理者ユーザーでログオンしなおして「postgres」ユーザーの権限を 管理者から一般ユーザに変更し直して終了です。
VACUUM が適切に実行されずに性能が低下していることを前提として回答します。 更新頻度の高い巨大なテーブルが存在する場合には、自動バキュームの設定をテーブルごとに調整したほうがいいと思います。 デフォルトの設定のままでは、UPDATE や DELETE で不要になった行が 50 行 (autovacuum_vacuum_threshold) + 全行数の 2 割 (autovacuum_vacuum_scale_factor) を超えた場合に VACUUM が実行されます。 例えば、テーブルの行数が 100,000 行の場合には不要な行が 20,050 行を超えると VACUUM が実行されますが、100,000,000 の場合には 20,050,000 行を超えるまで実行されません。同じ 2 割であっても 2 万行と 2 千万行では性能への影響が違います。 PostgreSQL 8.3 であれば、pg_autovacuum テーブルにエントリを追加すればテーブルごとに自動バキュームの設定を行うことができます (参考 URL を見てください)。 あと、その他に気になることとしては、デフォルトでは自動バキュームで同時に起動できる VACUUM は 3 つ (autovacuum_max_workers) までなので、更新頻度の高いテーブルが大量に存在する場合には、自動バキュームが特定のテーブルへの VACUUM につきっきりになってしまい、VACUUM の実行されないテーブルが発生して性能が低下してしまう場合があります。 参考URL：http://www.postgresql.jp/document/8.3/html/catal …
関数を定義してあげれば書くのが楽になるかもしれません。 CREATE OR REPLACE FUNCTION my_substr(text, integer) RETURNS text AS ' SELECT CASE WHEN $2 >= 0 THEN substr($1, $2) ELSE substr($1, length($1) + $2 + 1) END ' LANGUAGE sql IMMUTABLE STRICT; SELECT my_substr('test', 2); my_substr ----------- est (1 row) SELECT my_substr('test', -2); my_substr ----------- st (1 row) Oracle の substr 関数の動作を把握していないので、必要であれば修正するようにしてください。
とりあえず実際にSQLを実行して試していないけど、訪問周期日数をinterval型にキャストして顧客訪問日に足してやればいいんじゃない？ SELECT テーブル1.顧客番号, テーブル1.顧客名, テーブル1.顧客訪問日 + (テーブル2.訪問周期日数 || ' days')::interval FROM テーブル1 JOIN テーブル2 USING (顧客番号); 何かこんな質問がつい最近もあったような気がするけど。 排他制御についてはどんな仕様か言ってもらわないと答えづらい。
一番簡単なのは VACUUM FULL を実際に実行し、その前後のサイズを比較することですね。 VACUUM FULL を実行せずに確認するなら、どの程度の精度で見積もるかによって異なりますが、内部的なこと (8kB のブロック単位にディスクに格納されるとか、ブロックやタプルのヘッダーサイズなど) を知っていないと難しいです。 ヒントとしては、テーブルの行数は pg_class テーブルの reltuples 列、テーブルに定義された列の値の平均サイズは pg_class テーブルの avg_width 列、null の割合は null_frac 列に統計情報 (正確な値ではない) として格納されています。これらの値をもとに計算すればある程度の精度で有効な行以外によって占められてる割合を求めることができます。 こういった計算をするのが面倒なら、contrib モジュールの pgstattuple を使うのがいいと思います (参考 URL)。pgstattuple を使えば有効でない行や空き領域の割合、サイズを調べることができます。 参考URL：http://www.postgresql.jp/document/8.4/html/pgsta …
>INSERT 0 1が大量に表示されて遅いです。 ということはbak.sqlを開いて見ると"INSERT"コマンドが使われているんでしょうか？ もしそうならpg_dumpしたときのPostgresが古いんじゃないですか。 私のはVer.8.3ですがdumpファイルをみるとcopyコマンドが使われています。 ほぼ同じ１GBのファイルですが、数秒で終わりました。
参考になるかわかりませんが。 私は少し前にVB.NETを使用してWindowsアプリケーションの開発をしました。 PostgreSQLとVS2008の接続をnpgsqlを使いました。(初めて使いましたが特に問題なく接続できました) 参考にならなかったらごめんなさい＞＜ 参考URL：http://www.postgresql.jp/document/NPGSQL/index.h …
これでどうでしょう。 Select A + (B || 'm')::interval from hoge
--with-pgport オプションで指定するポート番号はデフォルトのポート番号なので、postgresql.conf ファイルの port パラメータで変更できます。再インストールする必要はないです。
>さきほどSQLをコピー＆ペーストし実行 なんでこんなことやっているの? インポートすれば良いだけ phppgadminでもファイルの「SQL」の画面からファイルアップロードできますけどなぜわざわざコピペを利用する?
定期的にVACUUMを実行しているにも係わらず、時間の経過とともに51件しかデータの格納されていないテーブルのSELECTが遅くなるとしたら、空き領域マップ（FSM）のページ数が不足していることが原因として考えられます。 FSMのページ数が不足していると、VACUUMを実行してもUPDATEで発生したゴミの領域を再利用できるようにならず、どんどんテーブルファイルが大きくなって性能が低下します。 VACUUMの実行時にVERBOSEオプションを指定すると、必要なページ数が表示されます。そのページ数がpostgresql.confファイルのmax_fsm_pagesパラメータの値よりも大きければビンゴです。 max_fsm_pagesパラメータの値を大きくして PostgreSQL を再起動し、テーブルを再作成してデータをリストアしなおすか、VACUUM FULLでテーブルファイルのサイズを小さくしてください。そうすれば性能が改善されるかもしれません。
mimzyさんの言うとおりで、psqlと接続先のPostgreSQLのバージョンが一致しておらず、psqlで解釈される\d（テーブルなどの一覧を表示）などのバックスラッシュコマンドの実行がエラーになる場合があることを警告するメッセージです。とくに大きな害はありません。 psqlを実行したサーバとPostgreSQLが動作するサーバが同じなのにも係わらず警告のメッセージが表示されるとしたら、コマンドのサーチパスが正しく設定されていないのではないでしょうか。 PostgreSQLをソースコードからインストールした場合には、--prefixオプションを指定していないとPostgreSQLのコマンドは/usr/local/pgsql/binディレクトリにインストールされます。デフォルトでは環境変数PATHに/usr/local/pgsql/binディレクトリが含まれていないので、OSの標準的なパッケージとしてインストールされたpsqlが優先されているかもしれません。
演算子~*の~は正規表現に一致する検索、 *は大文字小文字を区別しないという意味 です。 正規表現'.*>[^<]*★.*<.*'について 始めの".*"は任意の文字列を示します。 "."は任意の文字、"*"は0回以上の一致を 表わします。次の">"はタグの終わりを表す 文字です。次の"[^<]*"は"<"でない文字が 0回以上（"*"です）続くことを示します。 "[]"はグループ化、"^"は否定を意味します。 例えば[^0-9]は「数字ではない」ということ。 '.*>[^<]*'は'～>～'ということです。 この後にキーワードが続きます。 ★の後の'.*<.*'はもうお分かりですね。 '～<～'ということです。この記述は ">"と"<"の間にあるキーワードを探すことに なります。但し、<xxx y="aa>bb" z="★">の ようなタグがあると、誤認します。">"が 引用符の中かどうか分かりませんからね。 気をつけていただきたいのはキーワードの中に "."とか"*"のように正規表現上、意味のある 文字を含む場合はエスケープする必要があると 言うことです。 以下を参考にして、試行錯誤してみてください。 http://www.postgresql.jp/document/pg842doc/html/ … 少し前のバージョンでは"+"を正しく解釈して くれませんでした。現バージョンで直っている かどうかは不明です。
古いディスプレイを使っているためか、添付画像がよく見えない状況での回答です。そのため、的を外しているかもしれませんが。。。 PostgreSQLで定義した関数は、あくまでも”SQL中でだけ”利用できる関数です。pgAdminIIIで表示されるのは、PostgreSQLで定義された関数ですから、表示されて当然です。 Visial Studioで管理されるユーザ定義関数は、Visual C/C++ や Visual Basic の命令文レベルで使用できる関数です。
言うまでもないかもしれませんが、VACUUM の実行時に使用されるメモリは postgresql.conf ファイルの maintenance_work_mem パラメータに設定した値（デフォルトでは 16MB）なので、サーバのメモリを増やすとともに、この値も増やしてみてください。
root から su - postgres で postgres ユーザーにスイッチして createdb (適当なデータベース名) psql -f sqlファイル データベース名 もし、ダンプファイルの場合は cat sqlファイル | psql データベース名
> [root@ ~]# su - postgres > -bash: 　LD_LIBRARY_PATH=/usr/local/pgsql/lib: そのようなファイルや> ディレクトリはありません > ・・・・・ > -bash: 　export: command not found > [postgres@ ~]$ > のようなエラーがはかれるようになりました。 シェルの設定がおかしいとかでしょうか？ > 質問内容なのですが、Postgresqlをインストールしたのですが > postgresql.confとpg_hba.confが見つかりません。 initdb されていないからでしょう。
これぐらいなら、マニュアルを見れば分かるので、問題はありません。 MySQL もデータベース名のみ変更できます。 参考URL：http://www.postgresql.jp/document/pg837doc/html/ …
依存性があるとして表示されたパッケージを、あらかじめアンインストールし、 その後、PostgreSQL のアンインストールを行います。 そして最後に、削除したパッケージを、インストールしなおします。
リンク先の情報を見る限りでは開発コストの増大を理由に 8.4 以降では pginstaller を提供されなくなったように見受けられます。 ftp://ftp.postgresql.org/pub/binary/v8.4.1/win32 … http://pgfoundry.org/pipermail/pginstaller-devel …
　このふたつの言葉の違いを、説明するなら・・・ＭＳ（マネージメントシステム）の部分の差ですね。 　こう考えてみればよいかもしれません。 　データベースという世界があります。これは、データを関連づけて保存し、後で検索・運用するためのシステムに関する全般を指す言葉です。（世の中にあるデータベースはリレーショナルデータベースだけではありません。他にもいっぱいあります。） 　データベースの機能を実現するための理論の一つがＲＤＢ（リレーショナルデータベース）です。これは、データを表の形で表し、それを保存・検索するための手段を表した理論です。（例えば、通信の世界のプロトコルとか、プログラミングの世界におけるアルゴリズムとかと対比させるとわかりやすいかな？） 　理論は、実際のコンピュータに実装しないと、役に立ちません。ＲＤＢを実際に実装したもの・または稼働しているＲＤＢを動かすためのプログラムセットをＲＤＢＭＳと言います。世の中で稼働しているオラクル・ＳＱＬ　ＳＥＲＶＥＲ・ＭＹＳＱＬなどが、この一例です。 　まぁ、普通は、こんなに厳密に言い分けることも少ないでしょうし、ＲＤＢ＝ＲＤＢＭＳでも、大きな問題は無いです。あなたが、理論書を書こうとしているなら別ですけどね。
pg_dump -E EUC-JP DB > test.sql でどうでしょうか？
ログに出ているのは pg_class テーブルの reltriggers カラムが無いというエラーですね。reltriggers カラムは8.4から無くなったようです。(参考URL) お使いの接続ソフトが、テーブル・カラムなどのメタ情報を取得しようとして失敗しているのでしょう。 8.4 に対応している接続ソフトを使えばよろしいかと。 参考URL：http://www.postgresql.jp/document/pg841doc/html/ …
一応、PostgreSQL の話ですよね。 イマイチ、ピントがあっていない気がするので ・psql db これですが、コマンドラインで 、データベースに接続しているだけなので、立ち上げているわけではありません。 ・postgresql なら help でコマンドが見られるのでそれを見た方が良いとは思います 普通にDBで使うコマンドは ・create table テーブルを作成する ・select テーブルのデータを検索する ・insert テーブルにデータを追加する ・delete テーブルのデータを削除する ・update テーブルのデータを更新する 普通は、このくらいかな。 SQL でググって探せば、もっと良い答えにめぐり合うでしょう。
SQL のみでやるなら Dodonpa2 さんが回答したように dblink を使う必要がありますね。他の DBMS はよく知りませんが少なくとも PostgreSQL では基本的に接続中のデータベース内のテーブル以外は参照できません。 コマンドラインでの操作が OK なら psql で db1 内のテーブルのデータを COPY で出力した結果を db2 に流し込めば対応できるはずです。
#1です。提示したSQLに誤字がありましたね。失礼しました。 (1)行値式を使用する →where句のスペル誤りを訂正 select * from sample2 where (sarch,sarch2) in(select a,b from sample) ; (2)existsを使用する →where句のスペル誤りを訂正。表の別名での参照に統一 select * from sample2 as s2 where exists (select 1 from sample where a=s2.sarch and b=s2.sarch2) ;
> エンコード SQL_ASCII ASCII って 1バイト文字ですよね。 マルチバイト文字を正しく認識できないのでは？
単価適用日のカラクリを考えると、指定日以前で最大の日付と一致する データが対象となるようですね。 SELECT A.商品名,B.単価 FROM 商品マスタ A LEFT JOIN (SELECT X.* FROM 商品価格 X LEFT JOIN (SELECT 商品ID,商品詳細ID,MAX(単価適用日) 適用日 FROM 商品価格 WHERE 単価適用日<='2009-11-18' GROUP BY 商品ID,商品詳細ID) Y ON X.商品ID=Y.商品ID AND X.商品詳細ID=Y.商品詳細ID AND X.単価適用日=Y.適用日) B ON A.商品ID=B.商品ID AND A.商品詳細ID=B.商品詳細ID
> 私の環境は openSUSE 11.0 なのですが、おそらく autoconf のバージョンの違いが原因なので、Red Hat Enterprise Linux 5.3 でも同じだと考えられます。従って、autolocal を実行してあげればインストールできます。 正しくは aclocal でした。 # 手順では aclocal になっているので問題ないと思いますが。 あなたのシステムにログインできればすぐに解決できそうなのですが、そうもいかないので、config.log や ./configure の実行結果を見せてもらえますか？
　　 --追記-- これだとどうでしょうか？ INSERT INTO nickname VALUES (3,'?');　?は丸数字の２ INSERT INTO nickname VALUES (4,'?');　?は丸数字の８ ってことで(^^ゞ 　　
どうして、わざわざこんな扱いにくいテーブルにしているのでしょうかね。。。 select hob,count(hob) from ( select hob1 as hob from hoge_db where hob1 is not null union all select hob2 as hob from hoge_db where hob2 is not null union all select hob3 as hob from hoge_db where hob3 is not null ) as x group by hob order by hob
>レンタルサーバー屋で専用サーバーを借りていますが >仮想化環境ではディスク自体が レンタルしているのは専用サーバか? それともVPSか? それとも専用サーバをレンタルしてその中で質問者が VPSを構築しているのか?
自分ではやったことないんですが、こんなページ見つけました。 参考になりますか。 http://90h.dip.jp/archives/2007/07/npgsqlpostgre …
再質問の意味が分かりません。 参照整合性は例えばBigに"A","B","C"しかないなら、Midには"D"とか 作れないということですし、Midに"A"がある時はBigの"A"を削除でき ないということです。実際に参照されているかいないかはクエリを 実行しないと分かりません。それと、参照整合を設定していない項目は 変更可能です。これも含めて更新不可能にしたいというのであれば、 やり方を考え直す必要があります。
PostgreSQLのバージョンは、何でしょうか？ また、libpq.dllは、どのバージョンのものを使っているでしょうか？ 日本語対応などで、かなり古いlibpq.dllを使っていると、md5が未対応ということもあったりします。
デッドロックが何かを理解していますか？ デッドロックというのはロックの要求がすくみの状態になって互いにロックの開放を待ち続けてしまう状態です。 例えば、以下のように 2 つのテーブルを作成してデータを挿入し、 CREATE TABLE foo (id integer); INSERT INTO foo VALUES (1); CREATE TABLE bar (id integer); INSERT INTO bar VALUES (1); 2 つの psql を起動します。ここでは 2 つの psql を見分けるために psql1、psql2 と呼ぶことにします。 1. psql1 で foo テーブルの id = 1 の行をロック BEGIN; SELECT * FROM foo WHERE id = 1 FOR UPDATE; 2. psql2 で bar テーブルの id = 1 の行をロック BEGIN; SELECT * FROM bar WHERE id = 1 FOR UPDATE; 3. psql1 で bar テーブルの id = 1 の行をロック SELECT * FROM bar WHERE id = 1 FOR UPDATE; bar テーブルの id = 1 の行は psql2 がロックしているので待たされる。 4. psql2 で foo テーブルの id = 1 の行をロック SELECT * FROM foo WHERE id = 1 FOR UPDATE; foo テーブルの id = 1 の行は psql1 がロックしているので待たされる。 5. psql1 は foo テーブルの id = 1 の行をロックしつつ bar テーブルの id = 1 の行に対するロックが開放されるのを待ち、psql2 は bar テーブルの id = 1 の行をロックしつつ foo テーブルの id = 1 の行に対するロックが開放されるのを待ち、互いにロックが開放されるのを待ち続ける状態になります。これをデッドロックと呼びます。 6. PostgreSQL にはデッドロックを検出する仕組みがあるので、後からロックしようとした psql2 のトランザクションがアボートされます。 ERROR: deadlock detected DETAIL: Process 26267 waits for ShareLock on transaction 709; blocked by process 26261. Process 26261 waits for ShareLock on transaction 710; blocked by process 26267. HINT: See server log for query details. 従って、「デットロックを回避する為に、自動コミットをやめ、手動コミットに変更したいです。」という質問に対する回答としては、手動コミットに変更してもデッドロックは回避できません。デッドロックを回避するにはロックする順序を揃える必要があります。 また、回答番号: No.2 で athanasius さんが回答しているように、明示的にロックしなくても、同じテーブルの同じ行に対して更新しようとした場合には暗黙的に行ロックが取得されるので、先にロックを取得したほうが更新してから、次にロックを取得したほうが更新するだけでデータの不整合は発生しません。 「システム全体を手動コミットに変更するには、どうしたら宜しいのでしょうか？」という質問に対する回答としては、psql によるすべての接続で手動コミットを強制する方法はありません。 ただ、~/.psqlrc に「\set AUTOCOMMIT off」と書いておけば接続時に自動コミットが無効になります。
CentOSのファイアウォールでtcp/5432がブロックされていませんか？ CentOS上で system-config-securitylevel-tui を実行し、 Other portsにpostgres:tcp を追加してみてください
原因の切り分けが必要？！ もう一台端末を構築し、ODBCで接続し問題ないようなら トラブってる端末をＯＳインストールから再構築してみては？ （例えば旧ドライバのレジストリの残骸が悪さしてるとか考えられるため）
根本的な問題の解決には回答番号: No.2 で marimari01 さんが言うようにデータ型を適切なものに変更する必要があります。 ただ、テーブル定義の変更が困難な場合には統計情報のエントリ数を増やして対応できる場合もあります。 PostgreSQL では、データの分布状況などの統計情報をもとに実行計画を作成しますが、データの分布が著しく偏っている場合にはデフォルトのエントリ数 (8.3 までは 10、8.4 では 100) では適切な実行計画を作成できない場合があります。 統計情報のエントリ数を増やすには ALTER TABLE ... SET STATISTICS を実行します。以下の例ではエントリ数を 200 に増やしています。 ALTER TABLE ar06kakh ALTER ar06005 SET STATISTICS 200; エントリ数を増やして ANALYZE を実行後に実行計画を確認して調整するといいと思います。 エントリ数を増やすと ANALYZE の実行時間が長くなるので注意してください。エントリ数を増やしても効果がないようであれば、インデックスが使用されやすくなるようにプランナコスト定数などのパラメータを調整するか、データ型を適切なものに変更するしかないですね。
\(バックスラッシュ) は制御文字です。 SQL文の中で特殊な文字コードを表現するために使われます。 たとえば、\n なら改行を意味します。 今回の場合、 ERROR: invalid byte sequence for encoding "UTF8": 0x00 とのことなので、SQL文の中に "\0" のような文字が 含まれているのではないでしょうか？ 文字として扱いたいなら、必ず"\\"とエスケープする必要があります。
PostgreSQL 本体の機能では実現できませんが、contrib モジュールの dblink を使えばできます。 dblink のインストール方法は PostgreSQL のインストール方法によって異なりますが、RPM パッケージであれば postgresql-contrib というパッケージをインストールし、以下のように dblink の関数などを定義します。 psql -f /usr/share/postgresql/contrib/dblink.sql (データベース名) データベース名には他のデータベースにアクセスしたいデータベース名、例では app1_db を指定します。なお、dblink.sql のパスはパッケージによって異なる場合があります。 dblink をインストールすれば以下のように関数を呼び出して別のデータベース内のテーブルを参照できます。 SELECT * FROM dblink('dbname=common_db', 'SELECT * FROM postcode') AS postcode(postcode text, pref_name text); dblink について詳しくは PostgreSQL のマニュアルを読んでください。 http://www.postgresql.jp/document/pg840doc/html/ … ただ、質問の例にあるデータベース名やテーブル名を見ていると、アプリケーションごとに名前空間を分けたいだけのようなので、それであればスキーマを使ったほうがよさそうな気もします。 参考URL：http://www.postgresql.jp/document/pg840doc/html/ …
【考え方】 in_timeから見て、idが等しく、out_timeがin_timeより大きいものの うち、最小のものがペアとなるout_time SELECT A.id,A.in_time,MIN(B.out_time) outtm 　　FROM (SELECT id,in_time FROM テーブルA WHERE 　　to_char(in_time,'HH24:MI') BETWEEN '07:00' AND '10:20') A LEFT JOIN (SELECT id,out_time FROM テーブルA WHERE 　　to_char(in_time,'HH24:MI') BETWEEN '08:00' AND '11:30') B ON A.id=B.id AND A.in_time<B.out_time GROUP BY A.id,A.in_time 但し、上記を実行すると、下記のように出力される。 id　　in_time　　out_time 　1　　　08:30　　　09:00 　1　　　09:30　　　10:15 　2　　　07:40　　　08:10
テーブルスペースを使えば、データベースクラスタを作成しなおすことなく、新しいディスクにテーブルやインデックスの格納先を移動できます。 具体的には CREATE TABLESPACE で新しいディスク上にテーブルスペースを作成し、格納先のディスクを変更したいテーブルやインデックスに対して ALTER TABLE ... SET TABLESPACE や ALTER INDEX ... SET TABLESPACE を 実行すれば移動できます。 参考URL：http://www.postgresql.jp/document/pg815doc/html/ …
回答番号: No.2 に対して訂正があります。 > 手元の psql で確認した限りでは、トランザクション内で SELECT を実 > 行してコミットしていない状態だと、SELECT の対象となっているテーブ > ルの他にいくつかのシステムカタログに対しても Access Share Lock が > 取得されたままでした。 と書きましたが、これは psql 内でテーブル名などの補完を行ったためで した。 いずれにしてもトランザクション内で SELECT を実行してコミットせずに 放置しているのであれば、対象となるテーブルと、そのテーブルに定義さ れたインデックスにも Access Share Lock が取得されたままとなるので、 トランザクションをコミットするようにしてみてください。 トランザクション内で更新していなければロールバックでも構いません。
質問者さんを差し置いて、回答者同士で会話するようで申し訳ないです。(汗) > ただ、個人的には pg_statio_all_sequences などは統計情報を取得するためのビューなのでシーケンスの一覧を取得するのに参照するのはちょっと気持ち悪いです。 　あーそうなんですか。それは知りませんでした。 　というか、ずーっと以前から「statio」ってなんなんだろうなあ、って思っていて、なんとなく「status I/Oかな？」って思っていたんですが、statisticsだったのですね！ 　やっとナゾが解けました。勉強になりました。 　そうか、statisticsの略だったのか。。。やっとスッキリした。。。
> 全データベースにわたって一気にやる方法はないでしょうか？ その場合は、pg_dumpallコマンドを使用します。 下記URLを参考にして下さい。 http://www.postgresql.jp/document/current/html/a …
こんにちは。 >インストール画面で >ユーザー名、パスワードを入れる欄があり、何度やっても、 >「パスワード」が間違っています、と表示され、先に進めません。 >（何も入力しなくても、passwordと入力しても先に進めません。） パスワードが違ってないとしても、そのパスワードが何のパスワードかが 問題かもしれないです。Windowsのサービスアカウントのパスワードか、 Postgresのスーパーユーザpostgresのパスワードかどちらでしょう。 バイナリ版のインストーラを使ったのでしたら、Windowsサービスアカウントの パスワードはデフォでランダムな値が自動的に割り振られていたと思ったので こちらはそのまま、「次へ」をクリックしたのだろうと想像します。ということで 「password」はスーパーユーザのパスワードと感じますがいかがでしょう？ もし、私の想像が正しければ弾かれているパスワードとはWindowsサービスアカウント のパスワードで、これを記録（メモ）はしているでしょうか？していれば、 それをインストーラで入れてみてください。 もし、記録していなければ、Windowsのサービスアカウント(postgres)を削除してください。 これで再インストールできないでしょうか。 Vistaは所有してないのでXPでの削除法を記載しておきます。 管理者権限でログイン。 コントロールパネル→管理ツール→コンピュータの管理ダイアログ内の 左側のツリービューで ローカルユーザとグループの下のユーザを選択。 右ペインに「postgres」アカウントがあるのでこれを削除。
>副問い合わせは1列のみを返さなければなりませんというErrorが生じます。 >なのでwhere句を追加しましたが、結果は同じです。 where句を追加したということは行と勘違いされているのでは？ 『(select numberStr,TO_NUMBER (numberStr,'000.000') from number)』の部分で 「numberStr」と「TO_NUMBER (numberStr,'000.000')」の2列返しているという意味です。 「numberStr」の方を削除すればエラーにはならないと思います。
こんばんは 書籍でしたら、 まるごと図解 最新SQLがわかる (まるごと図解シリーズ) http://www.amazon.co.jp/%E3%81%BE%E3%82%8B%E3%81 … がお勧めです。 ＳＱＬの基本的な部分を分かりやすく丁寧に説明しています。 ＳＱＬの場合は、色々なことをたくさん覚えるのではなく、基本的なことを覚えたら、後はいかにそれらを使うかが大事になってきます。 ＳＱＬの解説だけでなく、基本的な考え方も学べるのでオススメです。 サイトは（もうご存じかもしれませんが） NPO法人 日本PostgreSQLユーザ会 http://www.postgresql.jp/ が一番参考になると思います。 実際に使っていく上での困りごとは、googleなどで検索すると、色々と事例が見つかります。 という私も、今年の４月にMS-Accessを使ってシステムを作ろうとしたところ、お客様からクライアントの台数分MS-Accessを入れる予算はないといわれ、急遽PHP+Postgresqlを勉強し、納品しました。 今は、別の仕事で、Excel+Postgresqlを検討しています（多分うまくいきそうな感触は得ています）。 …前のケースよりもクライアントが多いために、Accessの導入でも結構なコストになってしまします。また、ユーザーインターフェースはAccessの方が作りやすいのですが、今回の案件では「タッチパネル」に近いユーザーインターフェースを作る必要があります。この場合、ユーザーインターフェイスの制作にはExcelを使ってもAccessを使ってもあまりさはないので、お客様の負担の少ないExcelを選びました。 と色々と申しましたが、、私自身が勉強中の身です。 Postgresqlのファンですので、できる限りのアドバイスはしたいと思います。
telnetではなく、teratermを利用してみてはいかがでしょうか？ とても便利ですよ。 参考URL：http://www.forest.impress.co.jp/lib/inet/servern …
マシン名にすると名前解決のために何らかの処理が発生（それが何なのかはわかりませんが）するためではないでしょうか。
定期的なUPDATEの自動処理はあまりお勧めできませんね・・。 何か別の方法で代用することは不可能なのでしょうか？ トランザクションがかかっているテーブルを引っ張る（別トランザクションをかける）こと自体、トランザクションの概念に反しています。 ちなみにトランザクションはどのレベルでしょう。 http://www.postgresql.jp/document/pg800doc/html/ … こちらを参考に補足いただければと思います。
いま、手元にポスグレがないから確認できないんだけど、 たしか、このSQLが通ったはず。 SELECT ページ名,COUNT(DISTINCT ユーザーID) FROM テーブル GROUP BY ページ名
えっと・・・ない、というのは c:\ProgramFiles\PostgreSQL? 配下にもなかった、って事でしょうか。 タスクマネージャーで見て、 postmaster.exe と postgres.exe と pg_ctl.exe この３つ動いていませんか？ 私は質問者様が使用しているアプリがどんなものか存じません。 表面上DBから引っ張ってこれる状態で動作的にOKならば、 それでOKなのでしょう。 >ポスグレ何とか起動できました。 ってことは、前の段落から考えて”サービス”としてきちんと起動している、ってことですよね。 では、#1さんのおっしゃるとおり、pgADMINIIIを使って、 ”中身のデータベース”がきちんと動作しているかどうかを 確認して下さい。 それで動作しているとしてOKであれば、何も手間と危険を冒してまで 再インストールする必要はないでしょう。 他に何かまたエラーが出た、等あったら、また新規で別に質問されることをお勧め致します。
「利用者が定義したテーブル」という意味でしょうか？ SELECT table_name FROM information_schema.tables WHERE table_schema = 'public'
PostgreSQL日本語ドキュメント http://www.postgresql.jp/document/ Postgresqlの運用をしているのなら、一通り、目を通して置くべきかと思いますが、 読んでみましたか？
こんにちは。 1.サーバのプラットフォームは何でしょう？ 2.PostgreSQLのバージョンは何でしょう？ 3.SQL文1, 2, 3はどんなコマンドでしょう？ 4.PQclearでPGresult構造体を開放する前にPQresultStatusで 結果はどうなっているのでしょう？ 5.4.でエラーになってたらPQresultErrorMessegeなどでどんな メッセージが返ってくるのでしょう？ >この時、SQL文１しか実行されません。最初のPQexecをコメントアウト >するとSQL文２しか実行されません。 6.なぜひとつのコマンドしか実行されてないとわかるのでしょう？
もう解決されましたでしょうか？ 私は、データベース内に画像やバイナリファイルを挿入することをお勧めしません。 なぜなら、データベースが肥大化してしまうからです。 私なら、データベースでは、画像を置くフォルダ名とファイル名だけを管理して、画像は、フォルダに置きます。 フォルダ名とファイル名に規則性を持たせれば、管理は簡単です。 もちろん、ＰＨＰで、ファイルの削除もできますので、データベースの削除時にファイルも削除できますよ。 がんばってくださいね。
こんにちは。 >csvファイルのデータを既存のデータと比較して重複なしで登録する方法を教えて下さい。 普通にやるなら、TemporaryでCREATE TABLEしてそこにCOPY FROMでインポートを してINSERTを発行するストアドを作成すればできるとおもいますが。 ちょっと楽をしようとお思いでしたら、石井達夫さんがつくられたexttableが あるのでそれをお試しになればいかがでしょう。 http://ring.riken.jp/archives/misc/db/postgresql … サーバのプラットフォームがWindowsでしたら、拙作のExtensionsをVectorに 登録しましたので小生のハンドルネームで探してみてください。
こんにちは。 サーバのOSはなんですか？ 真っ先に確認するのはpg_hba.confかと思います。 そのクライアントからの接続を受け付けるようになっていますか？ あと、サーバのOSがWindows系でしたらファイアウォールで5432ポートが ブロックされてたりしませんか？ (UNIX系でしたらちょっとわかりません） 問題を切り分けるためにとりあえず、 コンソールでpsqlで接続してみてはいかがでしょう。 だめなようでしたらネットワークの問題でしょうし、OKということでしたら プログラムの問題ではないでしょうか。
こんにちは。 とりあえず、サーバ側のOSとPostgresのバージョンを お書きください。 クライアントはWindowsですよね。 >パターン(2)の様に引数の記述を行うと結果の取得ができません。 どのようにやってどんなエラーが出てなど、詳細を書かれないと コメントはつきにくいでしょう。 パターン１も２もpsqlとかpgAdminから実行した場合は問題ないのですか？ もしそうならパターン2のVBのプログラムが怪しいので見直してみてください。 第一感はNpgsqlParameterの使い方がまずいのでは？ http://npgsql.projects.postgresql.org/docs/manua … まずは、ここにサンプルもあるのでご自身で研究してみてください。
/etc/init.d/postgresql にも、PGPORTなる個所があるみたいです。 > ポートを変更する必要があり、postgresql.confを > port=5433 と編集し再起動したのですが、 #port=5433 の様に、コメントアウトしたままになってたりしませんよね？
EXISTSを使って商演算を行っていく順序を書いておきます。 SELECT A.番号, A.氏名, A.年齢, A.好物,B.好物 FROM 机1 A,机2 B とすることで、机1と机2の全ての組み合わせが出力されます。 | 番号 |氏名|年齢|　好物　| --------------------------- | １２ | あ | １ | りんご | | １２ | あ | １ |すいか | | ２３ | い | １ | すいか | | ２３ | い | １ | りんご | | ４５ | え | ３ | すいか | | ４５ | え | ３ | りんご | 上の表から机1に含まれないレコードを抽出します。 SELECT A.番号, A.氏名, A.年齢, A.好物,B.好物 FROM 机1 A,机2 B WHERE NOT EXISTS (SELECT * FROM 机1 C WHERE A.番号=C.番号 AND A.氏名=C.氏名 AND A.年齢=C.年齢 AND B.好物=C.好物) | 番号 |氏名|年齢|　好物　| --------------------------- | １２ | あ | １ |すいか | 最後に机1から、番号=１２,氏名=あ,年齢=１　ではない番号、氏名を抽出します データの重複を回避するため、DISTINCTを使用しています。（別に、GROUP BY でも構いません) SELECT DISTINCT D.番号,D.氏名 FROM 机1 D WHERE NOT EXISTS (SELECT A.番号, A.氏名, A.年齢, A.好物,B.好物 FROM 机1 A,机2 B WHERE NOT EXISTS (SELECT * FROM 机1 C WHERE A.番号=C.番号 AND A.氏名=C.氏名 AND B.好物=C.好物) WHERE D.番号=A.番号,D.氏名=A.氏名,D.年齢=A.年齢) 上のSQLだと、少し冗長なのでまとめると、 SELECT DISTINCT A.番号,A.氏名 FROM 机1 A WHERE NOT EXISTS (SELECT 1 FROM 机2 B WHERE NOT EXISTS(SELECT 1 FROM 机1 C WHERE A.番号=C.番号 AND A.氏名=C.氏名 AND A.年齢=C.年齢 AND B.好物=C.好物)) となります。
質問内容に少し不備がありそうな気がしますが、 要点と提示されてるＳＱＬだけを見て判断すると、 select テーブルA.グループコード,count(rtable.評価結果) from (select 店名コード,項目CD,評価結果,MAX(登録日) from テーブルC where 登録日 between '2000-01-01' and '2009-01-01' and 評価結果 = '○' group by 店名コード,項目CD,評価結果)as rtable,テーブルA,テーブルB where テーブルA.グループコード = テーブルB.グループコード and テーブルB.店名コード = rtable.店名コード and テーブルA.グループコード ='AAAA' group by テーブルA.グループコード で良いのではないかと。 rtableのgroup byの条件に登録日が含まれていたために、 登録日が異なると、別レコードとしてカウントしてきていたのが、 想定と、実際の結果が異なっていた理由ではないでしょうか。
#1です。 あらかじめBの排除すべきデータを排除して、改めてBと繋げるというのはどうでしょ。実行してないんで間違ってるかもしれませんがこんな感じで。 select A.グループコード,Count(B.評価結果) from (select 項目ID,店コード,Max(登録日) from B where 登録日 Between '2000-01-01' and '2009-01-01' group by 項目ID、店コード) as rtable join B on B.項目ID = rtable.項目ID and B.店コード = rtable.店コード and B.登録日 = rtable.登録日 join C on B.店コード = C.店コード join A on C.グループコード = A.グループコード where B.評価結果 = '○' and A.グループコード = 'AAAA'
やり方はいろいろありそうだけど・・・。 select id, sum(評価結果) from (select distinct * from TABLE) as b group by id order by id
上記の設定で問題ありません。 敢えて指摘するのであれば必要のないアーカイブログの削除が運用に組み込まれていないようなので、運用を続けていくうちにアーカイブログがディスク容量を圧迫する可能性があります。ベースバックアップを取得した時点でそれ以前のアーカイブログを削除したほうがよいでしょう。 また、アーカイブログの追加が1日に1回程度ということについては、あなかたが管理するデータベースの更新の頻度が比較的低いことが原因だと考えられます。 データの更新によって発生するトランザクションログがアーカイブログとして保存されるタイミングは、メモリ内に蓄積されたデータの更新が実際にディスク上のテーブルファイルに反映され（これをチェックポイント処理と呼びます）、トランザクションログが不要になった時点です。 更新の頻度が低い場合には、PostgreSQLのバージョンによって対応は異なりますがチェックポイントの頻度を高くするか、定期的にトランザクションログをアーカイブログとして保存するようにarchive_timeoutを調整するといいと思います。細かいことを言い出すと切りがないので、不明なことがあれば言ってください。
うーん、類義語検索を*効率的*に行う方法と言われるとけっこう回答に困りますね。 dict_xsynというのは類義語検索を実現するための辞書を構築するためのあくまでサンプルであって、これを使えば簡単に類義語検索が行えると言うものではありません。結局、類義語と言うのは要件によって変化するものなので（例えば、「試合」というキーワードで検索して「勝負」を含む文章がヒットするべきかどうかは要件に依存します）、何を持って類義語と見なすかを定義したデータが必要です。類義語を定義したデータがあれば類義語辞書を作成することも可能でしょうが、少し検索した限りでは適当なデータがなさそうです。
cast( key1 as varchar ) || cast( key2 as varchar ) || cast( key3 as varchar ) でいけると思います。 PostgreSQLは関数インデックス使えるのでインデックスもつくれます。
LIMITで正しいと思います。
CentOSの環境が手元にないのであくまで推測になります。 おそらく起動スクリプト内でpostgresユーザの環境変数が参照されていないことが原因だと思います。まず、/etc/rc.d/init.d/postgresqlの内容を確認してPGDATAの値に何が指定されているかを確認してみてください。多分、以下のような行が含まれていると思います。 PGDATA=/var/lib/pgsql/data ファイルを直接編集してPGDATAを変更してもいいですが、PGDG (PostgreSQL Global Development Group: PostgreSQLの開発元)が配布するパッケージ、もしくはそれをベースにしているパッケージであれば、/etc/sysconfig/pgsql/postgresqlというファイルを作成し、ファイル内に以下のような行を追加するとデータベースクラスタの位置を変更できるはずです。 PGDATA=/usr/local/pgsql あと、日本語のデータを格納するのであればinitdbの実行時に--no-localeオプションを指定したほうがいいでしょう。
No.1です。No.2さんの回答をちょっと変えれば、HAVING句とCASE式の組み合わせでもいけることに気が付きました。 例) --------------------------------------------------------------- SELECT DISTINCT g_id FROM members m JOIN hobbies h USING(h_id) GROUP BY g_id HAVING SUM(CASE WHEN h_name = 'drive' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN h_name = 'book' THEN 1 ELSE 0 END) > 0 ; ------------------------------------------------------------------- 参考URL：http://codezine.jp/article/detail/652?p=1
ここのカテゴリ通り、PostgeSQLを前提としての質問でしょうか？ ここでは、自分なりに調べた結果などを示し、分からない点を具体的に示して質問することがルールです。仕様を提示するので、「テーブル設計してください」、「SQLを作ってください」といったものは、質問ではなく作業依頼といった判断をされ、折角、具体的なアドバイスをしても、削除されてしまう可能性があります。 本題ですが、「社員管理」テーブル、「備品管理」テーブルを作成し、「貸し出し管理」テーブルを作るのが自然な発送ではないでしょうか？ >1レコードで社員番号から借りている備品を抽出したい 要件が分かりませんが、社員番号でgroup byして、sum + case　で備品番号毎とのクロス集計をするというのが、最初に浮かぶ発想ではないでしょうか？ なお、「一括で借り、一括で返却」でなく、追加での借入、部分的な返却があるなら、個数だけの管理では、備品の行方が不明になる可能性があります。 どこまで精密にやるかですが、備品番号＋通番　といった方法で、個々に管理する必要があるのでは？
>>1.レンタルサーバーへの一般的な接続方法 一般的というものはないと思えます。レンタルサーバの方から指定された接続方法を使ってください。 >>2.PHP・Perlを必ず使わないと接続できないか (できればJAVA経由で接続したいです) サーバの方がPHP,Perlで接続してくれといわれています。なので、かなりの高い確率で、できません。 >>3.バージョンは一致しないと無理か 指定された言語での接続方法を使って接続すれば、バージョンの相違は発生しないと思います。ただ、自分のプログラムの記述方法が該当のバージョンでの記述方法と相違がある場合は、プログラムの修正が必要になると思えます。
PostgreSQL 8.2以上、かつ、psqlからパスワードを変更するのであれば、\passwordを使用すると画面に表示されずに履歴などにも残らないのでいいと思います。 もしかしてデータベース上のユーザのパスワードではなくてOS上のパスワードのことかな。
こんにちは。 テーブル空間を作ってはだめですか？
こんにちは。 CREATE TABLE pgtbl ( f1 SELIAL, 　・ , 　・ , ); でテーブルが定義されていたら、f1のシーケンス名は pgtbl_f1_seqとしてpg_classに生成されています。 で、 SELECT last_value FROM pgtbl_f1_seq; ですべてのセッションで割り当てられた最後の値が取得できます。 (データ型(連番型), CREATE SEQUENCEを参照のこと)
下記のページにPostgreSQLのSQLの文字列定数についての説明が有りますので、記述できない文字などについてはここを見ると良いでしょう。 http://www.postgresql.jp/document/pg837doc/html/ … さて、シングルクウォートを含む文字列定数への対応としては下記の3つが考えられます。 1. 文字列中のシングルクウォートとバックスラッシュ(\)を\でエスケープする。 2. ドル引用符を使用する。 3. プレースフォルダを使用する。 2は、$xxxx$ のようなドル記号で囲まれた文字列を引用符代わりに使う、PostgreSQL 独自の機能です。 'hoge' と書く代わりに $xxxx$hoge$xxxx$ の様に書けます。 詳しくは下記のページを見て下さい。 http://www.postgresql.jp/document/pg837doc/html/ … 3は、SQLの定数の位置に?を書き、PreparedStatement の set～～() メソッドを使って値を指定する方法です。下記のページが参考になるでしょう。 http://www.atmarkit.co.jp/fjava/rensai2/webopt11 … http://sdc.sun.co.jp/java/docs/j2se/1.4/ja/docs/ … 参考URL：http://www.postgresql.jp/document/pg837doc/html/ …
ここのカテゴリ通り、RDBMSはPostgreSQLですか？ バージョンは？ >countの速度が行数に比例して遅くなって >行数が増えてもcountの速度が落ちないようにしたいのです。 >CREATE INDEX などは設定してあります。 「件数に比例」ということなら、インデクスを有効利用できていないのでは？ 削除やキー更新が数多く発生しているなら、VACUUMで統計情報を取り直すことで改善できるかも知れません。 ただ、この質問内容では、どういった対処が適切かを、他人には判断できません。 もしもっと具体的なアドバイスが欲しいなら、 (0)RDBMS名とバージョン (1)表の構成列とそのデータ型 (2)インデクスの定義 (3)SELECT文の具体的な内容 といったことを提示してください。
select sum( case when val=9984 then 1 else 0 end ) as cnt1, sum( case when val=1234 then 1 else 0 end ) as cnt2, sum( case when val=9876 then 1 else 0 end ) as cnt3, sum( case when val=4567 then 1 else 0 end ) as cnt4 from テーブル でやるか select val,count(*) from テーブル where val in ( 9984, 1234, 9876, 4567 ) group by val でやるか
PostgreSQL 8.3.7 で試してみました。 SELECT DISTINCT ON (コード) コード , 枝番 , 年月日 FROM テストテーブル WHERE (コード , 年月日) IN (SELECT コード , MIN(年月日) FROM テストテーブル GROUP BY コード ); でどうでしょう。
SJISは、8.3.7でもサーバ内のエンコーディングとしては使用できないので、他のエンコーディング方式にする必要が有るかと。 http://www.postgresql.jp/document/pg837doc/html/ … さて、サーバ内のエンコーディングが違う場合のデータ移行ですが、 pg_dump の出力には「SET client_encoding = ～～～」が入るようですので、特にスイッチなどは無くても大丈夫だと思います。なお、ダンプファイルの文字コードを指定したい場合は「-E encoding」を使います。 ただし、移行元のデータ中に、移行先の文字コードに割当てられないものが存在する場合はエラーになります。 参考URL：http://www.postgresql.jp/document/pg824doc/html/ …
ver7.3で、整数フィールドへの入力に空文字列を指定することが出来なくなったようです。それ以前は空文字列は0と解釈されていたそうです。 参考URLのページの「バージョン 7.3 への移行」節に説明が有ります。 したがって、元のver7.2.2のDBでは、SQLでは空文字列を格納するように記述されていても実際には0が格納されていたのだと思います。 おっしゃる通り、ver8.1.1ではWHERE句で「[数値項目] <> 0」とすることで元と同じ動作をすると思われます。 参考URL：http://www.postgresql.jp/document/pg837doc/html/ …
最新版のKeySQL2009なら、PostgreSQLにも対応しているようですよ。 参考URL：http://www.networld.co.jp/keysql/2009_specificat …
RDBMSは、ここのカテゴリ通り、PostgreSQLですか？ バージョンは？ SQLの勉強中とのことですが、何のためにこんなSQLを作っているのでしょうかね？ 別名ですが、内側のクエリで付けた名前であれば、外側のクエリで使用できると思います。 select ・・・ from (select ・・・ from ・・・) as x -- この中で別名を付けたら、外側で使用可能
なかなか回答がつかないようなのでアドバイスをば。 異なるDB間でSQLを使って差分を抽出することは不可能だと思います。 バックアップは素直にPostgreSQLの機能を使って行いましょう。 その方がはるかに現実的です。 どうしてもVB6.0を使ってやりたいなら・・・ ・A_DBのAテーブルに対する更新(Insert/Update/Delete)履歴を全て保存しておいて、B_DBのBテーブルに同じSQLを発行する。 ・Aテーブルが追加(Insert)しかされない(Update/Deleteがされない)前提であれば、レコードにシーケンス番号を振っておき、前日の処理以降のデータをInsertする。
マニュアルを参考にして http://www.postgresql.jp/document/pg815doc/html/ … 何がよく分からないのか提示してください。 質問の要件のみだったらこんな感じじゃないかな。 # TYPE DATABASE USER CIDR-ADDRESS METHOD host all all 127.0.0.1/32 trust trustのとこはauth-methodから選択してね。
何をやりたいのか、説明及び提示データが少なくて、分かりづらいです。 >できれば、多次元配列の「b.code」の記述順で表示したいのですが、 >下記のSQL文を実行すると「a.code」の記述順で表示されます。 認識に誤りがあります。 データ量が少ない、削除をまったく行っていないといった要因で、「a.code」の記述順のように見えているだけです。実際には、どういう順序で検索されるかは、order by指定がないので、RDBMS側では保証していません。 配列を使う目的は、何でしょうか？ PostgreSQLのマニュアルでも、配列は使用せず、別の表とした方がいいと書かれています。 order by b.code[1:1] を追加すれば、現状の提示された範囲のデータでは、期待の動きになるようです。ただ、もっと多様なデータが格納されていた場合、どういった結果になるのを期待しているのか、提示内容だけでは判断できません。
テーブルAとBは、同じサーバにあるのでしょうか？ CSVファイルなどの媒介は、必要ないのでしょうか？ データ件数は、どのくらいあるのでしょう？ insert ～ selectの1文で可能なのですが、ストアドプロシジャでやりたいでしょうか？ データ件数が多量の場合、select文で条件検索し、何回かに分割して行うこともできます。 insert into B select id,1,bsum1 from A union select id,2,bsum2 from A
「表の格納行数の上限を、行数で利用者が設定」といった機能は、殆どのRDBMSで持っていません。 要件が不明確なのですが、例えばシーケンスを使うか、自前で通番を付け、check制約で値の上限を設定してしまうといった方法も考えられます。 もし、削除が行われない前提なら、これだけで実装可能になります。 もし削除があるなら、次回格納時は、「欠番になっている最小の通番」を再利用するといった仕組みが必要になります。 以上は、「デモ版」ということなら、適用してもいいように思います。
質問に対する直接的な話ではないのですが。。。 WHERE acctnum=11111 AND acctnum = 22222 FOR UPDATE ↓ ANDでなくてOR INにした方が、速い
insert.csvファイルのDATE型となる項目をNULL値にする。 \Nとします。
Linuxのシステム文字コードは、EUCですか。 /etc/sysconfig/i18nファイルの１行目 LANG="ja_JP.eucJP"と設定されていなければ スーパーユーザーで設定変更する。 /etc/bashrcに環境変数を設定する。 export LANG="ja_JP.eucJP" 再ログインして、テーブルのINSERTを再試行してください。
私の担当する顧客のPostgreSQL－DBも120万件以上のデータがあります。 1・お使いのバージョンであれば問題ないはずです。ただし、VACUUM時にSELECTなどのレスポンスは当然落ちます。 2・私の方針（笑）では、キー情報のUPDATEが多くない限り、VACUUM ANALYZEまたはFULLは、多くても１週間に１回しかVACUUMしません。 DBの構造にもよりますが、２～３千件のINSERTで3時間に1回のVACUUMは 多い気がしますが、3時間に1回VACUUMしないとレスポンスが悪いのでしょうか？ このあたりはマシンのスペックによってもかなり影響されるので、はっきりとした答えは出ないでしょう。 検索などのレスポンスが悪い場合は、ANALYZEも有効ですが、やはり 定期的にdump＆restoreするのが一番いい方法なんですがね。 ノンストップ運用なら無理ですが・・・・
英数字の hoge_id が人間にとって有意な文字列なら、変更したい場面があるかも知れませんね。 変更しても結合相手に追従して欲しいなら、結合キーはおっしゃるとおり serial とかの別の項目にするのが良いでしょう。
select 名前 from A union select 名前 from B union select 名前 from C union select 名前 from D
マニュアルを見てみたところ、ALTER TABLEでの既存列のNOT NULLの追加や削除は、PostgreSQL 7.3で実装のようですね。 >テーブルを作り直さずに、既存のテーブルのカラムへの制約の追加、削除をしようとしています。 ALTER TABLEで、NOT NULLを許可しない列の追加などを行うと、内部的にはテーブルの作り直しが行われますよ？
最低限でも、次の情報が必要です。 (1)PostgreSQLのバージョン (2)表の構成列、データ型 (3)インデクスの定義内容 (4)データの母体件数、重複度合い (5)具体的なSQL・・・検索条件、order by、group by、distinctなどの提示は必須 EXPLAINの結果は、見てみましたか？
MySQLは商売に使うとライセンス料が必要だが PostgreSQLは無償。 ただし、MySQLは営利会社が管理しているので 金を払っただけサポートを受けられる。 無責任だが多分。
インストールできますよ、私も両バージョン同時に使ってますので。 確かにポットを変われば良いですね。 pgAdminnIIIについては、自動的に新しいサーバーを追加されます。
postgresql 8.3.5のpsqlで \df roundとしてみると exam=> \df round List of functions Schema | Name | Result data type | Argument data types ------------+-------+------------------+--------------------- pg_catalog | round | double precision | double precision pg_catalog | round | numeric | numeric pg_catalog | round | numeric | numeric, integer (3 rows) round(実数、整数）の場合、実数の型はnumericを受け付けるようです。 なので、double型？のかわりにnumericを使うか x::numeric みたいにキャストしてみてはいかがでしょうか。
読みにくいですけどこれで求められるようです。 試したのは8.3.5 ですが、たぶん7.4でもいけるはず。 select tbl.id1 from ((select id1 as id,id2 as id2_0 from t_tbl where id3 = 12) as t12 left outer join (select id1,id2 from t_tbl where id3 = 8) as t8 on (t12.id=t8.id1)) as tbl where tbl.id2_0 < tbl.id2;
変則的ですが、これでよければidがユニークでなくても大丈夫ですし、集合関数を使わなくてもOKです。 select dm.id,case when ex1.point is null then 0 else ex1.point end from (select ? as id) as dm left join ex1 on dm.id = ex1.id; ?を適当に変えてください。 chukenkenkouさんの発想はこれですよね。
（遅い場合で0.xx秒）が遅いのかどうかは不明ですが・・ 4000万レコード程度あるテーブルのクエリーが0.00xxx秒というのは どういうSQLでしょうか またどうやって測ったのでしょうか？EXPLAIN ANALYZEでしょうか？ 28件のTABLEへはどういったインデックスを張ったのでしょうか？ 条件にある主キーカラムにインデックスを張っていますでしょうか。 主キーカラム以外の条件を取り除くか、もしくはすべての条件カラムを含む 複合索引を張って検索を行ってみてはどうでしょうか。＾＾ ＃EXPLAINでカラム2のIN関数でインデックスを使用しない事があれば ＃(カラム2=bbb OR カラム2=ccc)に置き換えてしてみて下さい。
試していないけれど データベースディレクトリにある postgresql.conf で ログファイルの設定ができるようです。 #log_connections = off というのがあるから log_connections =　on にしてみては? (他にも修正が必要かもしれません。)
詳細な情報が書かれていないが PostgreSQL 8.* の psql内 のことならば configure時に readline を禁止していなければ コマンド履歴は有効です。
ググッただけですが、 PostgreSQL 8.0 で tcpip_socket パラメータは listen_addresses に置き換えられています。 参考URL：http://www.postgresql.jp/document/pg800doc/html/ …
品物管理テーブル・・・・t1 店舗別売り上げランキング管理テーブル・・・t2 とします。 以下でどうでしょうか？ select shop,no as 店内順位,cd,name from ( select shop,1 as no,no1 as rk from t2 union all select shop,2 as no,no2 as rk from t2 union all select shop,3 as no,no3 as rk from t2 ) as v left join t1 on v.rk = t1.cd order by shop,no
select intoまで辿り着いているのだから、簡単に調べられると思うのですが。。。 select 式1,式2,式3 into 変数1,変数2,変数3 from 表名 のように、式と対応する変数を複数書きます。 なお、PostgreSQLでは、8.0前後くらいで構文に変更(into句の位置）があったと思います。質問にある使い方は、変更後の使い方です。
select reloptions from pg_class where relname = 'テーブル名'; では
題意に沿っているかちょっと分かりかねる部分がありますが select distinct l1.first_name, l1.last_name from list l1 where exists ( select 1 from list l2 where l1.no <> l2.no and l1.last_name = l2.last_name and l1.first_name <> l2.first_name )
こんにちわ。 SQLインジェクションに限れば、PQexecParamsやPostgreSQL自身に穴が無いかぎり、出来ると思いますけどね。
サーバ以降準備中だそうです。 先週、メーリングリストに登録した人たちにはメールしようとしたらしいですが、保留状態になっていたらしいです。
#4回答の1箇所訂正。 ＜訂正前＞ (3)(2)のidと、test_person表を結合する ↓ ＜訂正後＞ (3)(2)のidの行のperson_idと、test_person表を結合する ＝＝＝＝＝以下、独り言＝＝＝＝＝ select person_id,max(amount) from test_deal group by person_id ; select * from test_deal as d where id=(select min(id) from test_deal where d.person_id=person_id having d.amount=max(amount) ) order by id ; select * from test_person as p inner join ( select * from test_deal as d where id=(select min(id) from test_deal where d.person_id=person_id having d.amount=max(amount) ) ) as x on p.id=x.person_id order by p.id ;
質問のタイトルが悪すぎます。 簡単な方法としては、別名を付けるクエリを「内側のクエリ」にしてしまい、「外側のクエリ」から別名を参照することです。 SELECT * FROM (SELECT CASE WHEN s = 1 THEN 1 ELSE 2 END AS now_t FROM test) as x WHERE now_t = 1
RDBMSは、ここのカテゴリ通りPostgreSQLでいいのでしょうか？ バージョンは、何でしょうか？ 「情報スキーマ」をSQLで検索することで、情報を得られると思います。 http://www.postgresql.jp/document/pg810doc/html/ …
RDBMSは、ここのカテゴリ通りPostgreSQLですか？ 使用しているバージョンは、何ですか？ >横に、販売車種メーカー別の合計 「合計」とは、行数ということですか？ 「横」とは、最大、何列くらいになるのですか？ 横への広がり（列数）が、5個とか10個とか固定でないと、SQLだけで実装するのは困難です。 列数を固定にすれば、GROUP BY、CASE、COUNTまたはSUMの組み合わせで実装できると思います。 使用RDBMS名、バージョンが不明なので、これ以上は回答しません。
カラム名と同様にカンマ区切りしたほうがいいですよ。 結合方法が良く分かりません ＞　TYPEV1=TABLE1のt1の値 ＞TYPEV2=TABLE1のt2の値
環境はWindowsでしょうか？ アンインストールしても消えるのは本体でデータベースとしてのデータそのものは残ります。 通常のアンインストール後に手動で削除する必要があります。 （デフォルトで使用していたならdataという名前のディレクトリがあります） ちなみにパスワードを忘れてしまった場合には一度削除しなくとも復旧できます。 pg_hda.conf（これも先のdataディレクトリ内にあります）という設定ファイルをメモ帳等のテキストエディタで開いて、 host　all　all　127.0.0.1/32　md5 となっているmd5の部分（ここが認証方法を示す部分でmd5はパスワードをmd5にしたもので認証するということ）をtrustにするとローカルである127.0.0.1からはパスワードを訊かれなくなります。 で、その間にパスワードを再設定してtrustをまた元に戻せばOKです。
データが何件くらいある表を、定義変更しようとしているのでしょうか？ ALTER TABLEで、NULLが可な列の追加なら、格納済の行に影響しませんが、NOT NULL列の追加の場合、格納済の全行が更新されるので、格納済データ数に比例して、処理時間が掛かるようになります。 商用RDBMSでは、NULL可の列だけ追加可能で、NOT NULL列の追加を禁止していたりします。
pg_dump した時エラーメッセージはでてないのかな？ なにかメッセージが出てるならおそらくバグでは無いです。 pg_restore -cでリストアしてはどうでしょうか。
PostgreSQLでは、Oracleに似た「階層問い合わせ」という機能が、標準搭載ではないですが、実装されています。 http://www.thinkit.co.jp/free/marugoto/2/1/23/1. … MySQLでは、まだこの辺の機能は実装されていません。階層を制限した形で実装するとか、ストアドプロシジャで作りこむといった対処になると思います。 標準SQLでは、SQL99で「再帰クエリ」(with句を使用）が規定されており、MySQLでも将来的には実装するのではないかと思います。
エラーを見ると DB の接続に失敗していますね。 以下をご確認ください。 1 PostgreSQL サービスは起動しているか。 2 DB のアクセス権(pg_hba.conf)の確認 3 PostgreSQL の起動オプションに -i が必要かも？ 4 pg_connect の確認（ホスト名、DB名、ユーザ、パスワード） スクリプトで接続に失敗したら pg_last_error を出力させれば何かわかるかも。
できるかできないかは、やってみれば分かる事ですね
メモリ不足かメモリの制限に達しているのでしょうか
いきなり、は難しいのではないでしょうか。 どちらもCSVに落とすユーティリティはあると思うので、というか SELECT文の実行結果が即ち、CSV（区切り文字はともかく）でしょう。 CSV→XMLはググると何件かヒットしますよ。
下のアドバイス、少し訂正。 「totojimaさんが持参したデータを使って、 そのデータをデータベースにロード（格納）して、 totojimaさんが作ったプログラムを テストしましょう」という意味でしょう。
それなら早く言ってよ（笑） to_char(開始時刻, 'HH24:MI') >= '13:30' AND to_char(終了時刻, 'HH24:MI') <= '15:40' http://www.postgresql.jp/document/pg734doc/user/ … 参考URLの文章の中に関連事項のリンクもあったはず。
３ヶ月ずらせば良いのでは？ select date_part('year',date_trunc('year',date - interval '3 month')) as NENDO ,sum(a) as TOTAL_A,sum(b) as TOTAL_B from uriage group by date_trunc('year',date - interval '3 month') date_partやdate_truncはバージョンにより使用できないかも 知れません。こちらの環境は8.2です。
以下は一例です。 SELECT field1 FROM T GROUP BY field1 HAVING MAX((CASE WHEN field2 in (1,2,3) THEN 1 ELSE 0 END) |(CASE WHEN field2 in (101,102,103) THEN 2 ELSE 0 END))=3 その他、サブクエリでAグループ、Bグループを作り、INNER JOINする 方法などが考えられます。
pgAdminIIIではパスワードを入れるとアクセスできるのですから、 パスワードはそれでいいのです。 psql: role "Owner" does not exist　と出るのは、 Windowsのコマンドプロンプトからpsqlでアクセスするときは、 OSのユーザがデフォルトになっているためです。 postgres　ユーザでログインするには、コマンドプロンプトで 明示的に-Uオプションを付け、 psql -U postgres <データベース名> としてログインせねばなりません。
パスワードが表示されていないだけで、入力されているんですよ。 だから、 psql: FATAL: password authentication failed for user "postgre" アクセス権が無い（パスワードが違ってる） paql: fe_sendauth: no password supplied パスワードが入力されていない（Enterを押しただけ） というエラーが返ってきています。 表示されませんから、正確に入力してみましょう。
PHP等で数値に変換しているだけでしょう。 まず、出ているエラーの内容ぐらいは書きましょう。
PgAdminの設定が「パスワードを保存する」になっていませんか。
ちょっとインチキですけど、こんなのはどうでしょうか。 select no, recno, (case when s=1 then 'a' when s=2 then 'b' when s=3 then 'a,b' when s=4 then 'c' when s=5 then 'a,c' when s=6 then 'b,c' when s=7 then 'a,b,c' else '' end ) as names from (select no, recno, sum(case when name = 'a' then 1 when name = 'b' then 2 when name = 'c' then 4 else 0 end) as s from ex5 group by no,recno order by no,recno) as b; いちおう動きます（笑） no | recno | names ----+-------+------- 1 | 1 | a,b 1 | 2 | c 1 | 4 | a 2 | 3 | a,b,c 3 | 5 | b 4 | 6 | a (6 rows)
マニュアルの次の頁は、参照済ですか？ http://www.postgresql.jp/document/pg800doc/html/ …
RDBMSにより、「データベース」の概念が異なっているので、分かりづらい部分ですね。 PostgreSQLでは、「複数データベースの操作」は未実装のようです。 http://www.postgresql.jp/document/pg823doc/html/ … 「サーバに接続しているクライアントは、単一のデータベース、つまり接続要求で指定したデータベース内のデータにしかアクセスできません。」
select id_sub, ( select array_to_string(ARRAY(select id_sub_code from table2 where table1.id_sub=table2.id_sub ), ',') ) from table1; なんて参考になりませんか。
create or replace function trg_b_test() returns trigger as $$ declare i int; begin if old.fall=0 and new.fall=1 then update a set fall0=1 where a.aid = new.aid; end if; select count(*) into i from b where b.fall=0 and b.aid=new.aid; if i = 0 then update a set fall1=1 where a.aid = new.aid; end if; return new; end; $$ language 'plpgsql'; drop trigger trg_b_test on b; create trigger trg_b_test after update on b for each row execute procedure trg_b_test();
SELECT * FROM Ａテーブル LEFT JOIN Ｂテーブル USING("Key1", "Key2") UNION SELECT * FROM Ａテーブル RIGHT JOIN Ｂテーブル USING("Key1", "Key2") で取得できるでしょう。
エクセルで操作するなら、ODBCでエクセルに取り込んでは？ http://allabout.co.jp/internet/database/closeup/ …
>それでもうひとうのことですが、ここでa,b1,b2を作るのはどのような内容 >でしょうか。それが理解できなくてコマンドをわかるまで時間がかかりまし >た。 >select a.id, b1.henkan as q1, b2.henkan as q2 >from table1 a join table2 b1 on a.q1=b1.koumoku >　　　　join table2 b2 on a.q2=b2.koumoku この、from句に使われている　aとか、b1,b2はテーブル名のエイリアスと呼ばれます。日本語で「別名」です。その名の通り、テーブルに別名を着けているだけなのですが、単一のテーブルを複数のパターンで処理する場合に慣れるまでちょっと解釈が面倒かもしれません。 　そこで、慣れるまでは、データベースの内部で一時的にテーブルのコピーが作成され、そのコピーの名前としてエイリアスが用いられると考えてください。今回ですと、table2に対して、b1とb2の二つのエイリアスが登場していますが、これは、b1とb2と言う二つのコピーを作成したと考えるわけです。 　これで、ｓｑｌが少しわかりやすくなりませんか？ 　（ただし、実際にはコピーを作成してまた消して・・・なんてそんな非効率な処理はしていません。単なる考え方ですので。）
ためしていませんが select 年月, sum( case 担当者 when '太郎' then 金額 else 0 end ) as 太郎, sum( case 担当者 when '次郎' then 金額 else 0 end ) as 次郎, sum( case 担当者 when '三郎' then 金額 else 0 end ) as 三郎 from テーブル group by 年月
PostgreSQL 7.x と 8.3 のデータベースを別々の場所に作成し、 かつ TCP の接続ポートも別にすれば可能です。 最初に、PostgreSQL 7.x と 8.3 を configure オプションの prefix を違う内容 (例えば /opt/pgsql74 と /opt/pgsql83 とか) にしてインストール。(パッケージだと /usr とかにインストールされてしまうので) あとは PGDATA を別々の値に設定した状態で initdb して $PGDATA/postgresql.conf の port を変更。(デフォルトは 5432) アプリからの接続時はそれぞれのデータベースに対応する Port 番号を指定すればよいです。
>まず学生テーブルをスキャンし、その各行に対して試験ごとの結果を得る、 >という方法でやってみたのですが遅いので。 どんなSQLか、具体的に提示できませんか？ 「遅い」と言われても、クエリの記述レベルでどうなるものか、母体データ件数などを含めて示してもらわないと判断できません。 >DBへの書き込み権限がないのと、 性能を出すため、インデクスの定義を見直すことはできるのですよね？ そうでないなら、諦めてください。 >同じ試験問題を後から受ける学生がいるため、順位をあらかじめ入れて >おくことができません。 成績表を作成する直前に、順位を入れればいいのでは？ >> 順位を求めるクエリは、自己結合すればできますよね？ > 上記のような方法でやってみました。 具体的にどんなSQLなのか、提示できませんか？ 「遅い」、「そういう方法でやっている」と日本語だけで示されても、そのクエリが適切なものかどうか判断できず、具体的なアドバイスができません。 > それと、RDBMSは、PostgreSQLなのですよね？バージョンは？ > 7.3.18です。 このサイトでは、丸投げは禁止事項ですよ？ 自分で考えた内容を示し、具体的に分からない部分を質問することが規約になっています。仕様を提示して、「SQLを作って」といったものは、「質問でなく作業依頼」などとして、せっかく回答しても削除される可能性があります。 PostgreSQL 7.3.18で動くかどうか分かりませんが、8.0では動くSQL例を示します。 1行内で同じ列名でタイトルを出す、同じ列の値として数値と文字を混在して出したりは、すべて文字にキャストしたりしないと実現できませんから念のため。 -- 成績表 select g.gid, max(case sid when 1 then tokuten else null end) as 試験1, max(case sid when 1 then rk else null end) as 順位1, max(case sid when 2 then tokuten else null end) as 試験2, max(case sid when 2 then rk else null end) as 順位2, max(case sid when 3 then tokuten else null end) as 試験3, max(case sid when 3 then rk else null end) as 順位3, cast(avg(tokuten) as dec(4,1)) as 平均得点 from gakusei as g left join (select gid, sid, tokuten, (select count(*)+1 from shiken where sid=x.sid and tokuten>x.tokuten) as rk from shiken as x) as s on g.gid=s.gid group by g.gid order by g.gid
PostgreSQLのバージョンは何ですか？ >・10行くらいのカラムを追加 10行とは？ 10カラムを追加ですか？ データ件数は何件あるのですか？ >・追加したカラムにデフォルト値をアップデート 格納済の全行に対し、ディフォルト値でupdateしているのですか？ そんなことすれば、物理的な格納位置が乱れて検索などが遅くなって当然だと思います。格納済の行の場合、追加した列はnullで受け取ることに問題があるのでしょうか？
>・データは月次60000件、年間72万件のデータを数年間保持する必要あり 過去のデータについても頻繁にアクセスするのか、稀なのか等によって、設計の仕方が変わってきます。 >何ヶ月、何年と運用を重ねていくながで数十万、数百万のデータによって、アプリケーションの処理が極端に重くなったりデータ容量の上限に 達するといったことはあるのでしょうか？ 設計の仕方によります。 例えば、インデクスを有効利用できない検索条件を指定したり、order by、group by、distinct等で作業メモリ（or ファイル）を使ったソートが発生するようなインデクスの定義、SQLの記述をすれば、当然、データ量が増えるにしたがって性能劣化します。また、多量のデータ更新や削除が発生しているのに、計画的にデフラグしないなら、性能劣化してしまいます。 逆に、インデクス設計とSQLの記述が適切に行われているなら、母体データ量が増えても極端に性能劣化はしません。 >Postgresの容量が2GB 何の容量ですか？ どこで拾った値でしょうか？ 「パーティショニング」、「クラスタ」などのキーワードを調べてみてください。
UPDATE tableA set c = 3 WHERE a1||b1||c||d in (SELECT tableA.a1, tableA.a2, tableA.b, tableA.c FROM (SELECT a1, a2, b, c FROM tableA WHERE tableA.b=1 AND tableA.c=1 ) tableA_v, tableA WHERE tableA_v.a1=tableA.a1 AND tableA_v.b1=tableA.b1 AND tableA.b=0 AND tableA.c=1 ) ;
複数tableを同時に追記するなら transaction内でinsertを呼ぶしかないと思います。 table_AとBの関係性がよくわかりませんが 1つのテーブルにできるなら、table_A、BにあたるViewをつくればいいですが
> /usr/lib/postgresql/8.1/bin/pg_ctl -D /mnt/share/pgsql -l logfile start と明示的にデータディレクトリを指定しているのに postmaster　は > /usr/lib/postgresql/8.1/bin/postmaster -D /var/lib/postgresql/8.1/main -c > config_file=/etc/postgresql/8.1/main/postgresql.conf となっているのですね。 もしかしたら古い postmaster が終了せず残っているのでは ないでしょうか。
どこが具体的に分からないのでしょうか？ >期待結果　a-1　　　a-2　　　b-1　 c-1　 >￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣ >　　　１　　　bbb　　　aaa　　　ddd　 eee >　　　２　　　ggg　　　bbb　　　ccc　　　※ >　　　３　　　bbb　　　mmm　　ddd　　　※ >　　　４　　　ggg　　　aaa　　　ccc　　　qqq >※は空白でもNULLでもよい 4番目の値を間違っていませんか？ 4 ggg mmm ccc qqq　　ですよね？ 1～4の通番も値として持つのですか？ 列名に「-」を使うのですか？ その場合、減算と区別するために、「"」で囲む必要がありますよ？ PostgreSQLのバージョンは何ですか？ あまりに古いと、具体例を提示しても、wanton_dogの環境では実行できないかも知れません。 以下の例は、TABLE1に通番の列（seqno）があるものとします。 -- EX1 -- 簡単なLEFT OUTER JOIN（結合のための列が2個） select seqno, t1."a-1",t1."a-2","b-1","c-1" from table1 as t1 left join table2 as t2 on t1."a-1"=t2."a-1" and t1."a-2"=t2."a-2" ; -- EX2 -- EX1のSQLを、nullの場合、値を置き換える -- nullを判別する関数は複数あったり、RDBMSにより違う。 -- coalesce関数は、主要なRDBMSで実装されている select seqno, t1."a-1",t1."a-2", coalesce("b-1",'BLANK') as "b-1", coalesce("c-1",'BLANK') as "c-1" from table1 as t1 left join table2 as t2 on t1."a-1"=t2."a-1" and t1."a-2"=t2."a-2" ; -- EX3 -- EX1のSQLを、インラインビューから得る形に変える select seqno, t1."a-1",t1."a-2","b-1","c-1" from (select * from table1) as t1 left join (select * from table2) as t2 on t1."a-1"=t2."a-1" and t1."a-2"=t2."a-2" ; -- EX4 -- EX1のSQLを、行値構成子（行値式）を使用する形に変更する。 select seqno, t1."a-1",t1."a-2","b-1","c-1" from table1 as t1 left join table2 as t2 on (t1."a-1",t1."a-2")=(t2."a-1",t2."a-2") ;
ログインid は、何を使っていますか？
> コピーだけ持って来てみるか？ これはいけません。元通りにしてください。 > それとも何か上手い事出来る方法があるのか？ -I オプションは複数書いてもいいことになっています。 ……が、このサンプルの場合 postgres.h はいらなかったりします。 （ディレクトリ名が示すとおり、サーバ側で動作するプログラムが使うものだからです） ソース側の include 命令をカットしてもよいでしょう。
(1)7.2ではvacuum,analyzeに加えreindexも必要、一度すべて試行してからEXPLAINをしてみる。 (2)7.2ではIN関数が不得意なので 　where k3='100' or k3='200'・・・ 　に置き換えるか、PGversionを8.2などに上げてみる
指定していないカラムがnot nullかprimary制約になっていて、 'tenpo_tenpo_no_seq'のnextvalをデフォルト指定しているのでしょう。 つまりtenpo_tenpo_no_seqがないのでNo such tableが出るというだけ。
普通に考えれば、unionを使うと思います。
失礼しました（文面をよく読んでいませんでした）。 半角全角変換関数ですがデータベースがutf8で作成されているのが前提 ですが、plperluを使えば以下のようにできます。 CREATE or REPLACE FUNCTION perl_h2z (varchar) RETURNS varchar AS $$ use utf8; use Unicode::Japanese; my ($a) = @_; if (! defined $a) { return undef; } my $b; $b = Unicode::Japanese->new($a)->h2z->get; return $b; $$ LANGUAGE plperlu; ご参考までに。
RDBMSは、ここのカテゴリ通り、PostgreSQLでいいのですね？ SQL中での正規表現の書き方を、聞いているのでしょうか？ それとも、正規表現を使わない書き方を聞いているのでしょうか？
PostgreSQLでは、バージョンにより違いがあるかも知れませんが、char(n)のnは、バイトでなく文字数です。 これは、全角や半角の文字を実際に格納できるか試してみれば、すぐに分かることです。 ちなみに、MySQLでは4.0まではバイト数、4.1以降は文字数と、仕様変更されています。
Postgre使ったこと無いですが psql -q -c "select * from employ_kanri where 勤務先 = '横浜'" 単にこういう事では？ 外をシングルコーテーションで括っているのに、中でも使ったら そこで終了と見なされると思います。
＞コマンドからではクラスタの指定ができないのですが、クラスタの切り替えは自動で行われているのでしょうか？ SQLの実行サーバーを指定できないという意味でしょうか？ サーバー選択はテーブルやキーでなされるので、明示的にサーバーを指定する意味がありません。 と、ここまで書いていまさら気づいたのですが、PostgreSQLの質問ですね。すいませんうっかり見落としてました。特に詳しい訳じゃないので、データベースの一般論としての回答と思ってください。
Hyper Estraierはいかがでしょうか。 簡単な検索フォームまですでに作ってあります。
>年間データテーブルと年間テーブルから当日だけのViewがある 日本語で説明された上、曖昧な説明になっていますが。。。 「年間データテーブル」と「その年間データテーブルから、当日分だけ見るように条件指定したビュー」があるということですか？ >Viewから検索した方が早くはならないのでしょうか。 なぜ、そういう考えが出てきたのでしょうか？ ビューは、実体のない表で、検索時には基の表から検索されます。したがって、基の表にどういうインデクスを定義していて、ビュー中の検索条件でインデクスを有効利用できる指定になっているかで性能が左右されます。 ただし、一部のRDBMSでは、ビューを「実体のある表」とできたり、「ビューにインデクスを定義する」といった拡張仕様を持っているものもあります。 PostgreSQLでは、そういった拡張仕様を持っていなかったと思います。そればかりか、ビューを使用しての更新禁止という制限があったと思います。
翻訳がおかしいようですね。 原文はそれぞれ ・Will be installed on local hard drive ・Entire feature will be installed on local hard drive ・Entire feature will be unavailable となっています。意訳すると ・インストールする ・いずれ使えるように用意だけしておく ・インストールしない です。
入れ子を使いたくないというのは、どういう理由からでしょうか？ 適切なインデクスを定義しておけば、性能が大幅に劣化はしないと思いますけど？ group byでrollupの指定ができれば可能かと思いましたが、PostgreSQL 8.3でも未実装のようです。
>※ちなみに動的に生成されたＳＱＬはこんな感じになります。 >SELECT col1 >,SUM( CASE WHEN col2 = 1 THEN val END ) AS col_name1 >,SUM( CASE WHEN col2 = 2 THEN val END ) AS col_name2 >FROM t1 >GROUP BY col1 >ORDER BY col1; int,int,intと3個を列として受け渡したいのだから、次のようなユーザデータ型を定義します。 CREATE TYPE test_type -- (INT,INT,INT)の3項目の受け渡し用 AS　 (a INT, b INT, c INT); そして、このユーザ定義型の変数で、受け渡しができると思います。
PostgreSQLに限らず、"(ダヴルクォート)や'(シングルクォート)はエスケープする必要があります。 これはデータベースを操作する「SQL」という言語の一般的な*仕様*です。 他にもエスケープが必要なキャラクタもありますので、以下のページを参照してみるか、検索サイトで「SQL」と「エスケープ」をキーに検索してみると良いかと思います。 http://www.rfs.jp/sb/sql/02/01.html
>SELECT SUM( c2 ) AS sum_c2,SUM( c3 ) AS sum_c3 > FROM t1 > WHERE c2 IS NOT NULL > GROUP BY c1 selectの選択列にc1列も指定しないと、どのc1のc2集計、c3集計かが分からないですよ？ 方法は二つです。 一つは、表の検索しない列に対応する値を、selectの選択列でダミーの定数で指定する方法です。 つまり、次のように指定します。 select null, -- c1列に対応 SUM( c2 ), SUM( c3 ), null -- c4列に対応 from ～ なお、ストアドファンクション中で付けた別名は、呼び出し側には渡らないようです。 そのため、別名で参照したい場合は、 select null as dmy_c1, sum(c2) as sum_c2, sum(c3) as sum_c3, null as dmy_c4 from func1() のように呼び出します。 もう一つの方法は、 select c1,sum(c2),sum(c3) from ～ と、今回の場合、int,int,intの3個の値を列として得たいなら、 create type test_type -- (INT,INT,INT)の3項目の受け渡し用 as 　 (a INT, b INT, c INT); というユーザ定義型を作成し、そのユーザ定義型で受け渡しするストアド・プロシジャを作るというやり方です。 この場合、呼び出しは、 select a as c1, b as sum_c2, c as sum_c3 from func1(); のように行います。
見る限りはinsertに失敗してるような。 日本語文字コード(insertとDBのエンコーディング）などは大丈夫ですか？ insert into Tel(name, tel_num) values ('yamada', '012-345-678'); これでも正常にinsertできませんか？
current_dateとcoalesce関数を使えば、容易に書けます。
php実行でシステム上のメモリーを使いきっているか、(ユーザのメモリ上限とか） もしくは、$sは実際には1Gを超えているとか $r=pg_exec($db,$s); の$sは期待している文字列(文字長)していされているのかな・・？
同じテーブル構成で-d-Dが必要になったことは無いです。 7.4→8.3以降の場合は、移行先の8.3のpg_dumpでdumpする必要があります から、特にバージョンの差異もここでは考えなくて良いのかもしれません
EXPLAIN ANALYZEで比較したらいいかもね 8.3で特有な変更があるなら、8.2にすればいいけど
すごく長いSQLですね。 INやORを使わずにEXISTSで書けばどうでしょうか？ 文字数じゃなくパフォーマンスのせいだと思います。
必要ありません。
UTF-8 TeraTerm Pro with TTSSH2 はいかがでしょうか。 参考URL：http://www.forest.impress.co.jp/lib/inet/servern …
直接の回答ではありませんが、２つのテーブルで重ならないIDが必要なら、ID発行用に一つの SEQUENCE を作っておいて、どちらのテーブルもIDの値はここから取得すればよいのでは？
こんにちは。 >ADOとODBCの違い と >AccessからPostgresのデータをいじる時の利点、欠点はなんでしょうか？ 質問内容が違いますが、何をご質問になりたいのでしょう？ 具体的におっしゃってください。
こんにちは。 >Access上でリレーションが未定義でサブフォームを作成することが出来ません。 実際のエラーメッセージは何でしょう？ サブフォームということは、サブフォームコントロールの リンク子フィールド、リンク親フィールドが設定できないという 理解でいいのでしょうか？ >基本的にCreateTableするときに、なにやらリレーション設定する構文が必要だったのでしょうか？ こちらの環境ではリレーションシップを作成しなくても、上記プロパティを 設定すればできたので特に必要はないと思います。 Access、Postgresのバージョン、テーブルの状態、メイン・サブフォームの レコードソース、メインのサブフォームコントロールのリンク子フィールド、 リンク親フィールドプロパティなど、具体的にアップされるとコメントが つくかもしれません。
　そのダンプがEUC-JPなんではないのかな。（ダンプを取ったときクライアントエンコーディングがEUC-JPになっていた） 　で、入れなおそうとしているFC6のデフォルトエンコーディングは多分UTF-8なのだろうからダンプをUTF-8として（クライアントエンコーディングをUTF-8として）読もうとして失敗しているのではないでしょーか。 　そのダンプを一旦nkfでUTF-8に直してしまうか、psqlのクライアントエンコーディングをEUC-JPに変更して入れてみたらどうでしょ。 　現在のDB（PostgreSQL内の全DB）のエンコーディングを調べるにはpsqlで入って\lとすれば良い、が、サーバーエンコーディングはあまり関係はないと思うよ。クライアントエンコーディングを調べるには同じくpsqlで\encodingだ。
アップグレード元のOSはなんですか？ カスタムインストールであれば、ローカルポリシーの変更は必要ありませんよ。
自分なりに考えたSQLは、ないのですか？ 日付だけで、行は一意に識別できるのですよね？？？ SQL例です。 select 日付,入会数,退会数,(select sum(入会数-退会数) from t1 where 日付<=x.日付) as 累計 from t1 as x order by 日付
1行1行に累計を返すというのは、SQLでやるにはあまり効率的でない（アプリケーションでやった方が、より軽快）ですけどね。 SQL例としては、以下のような方法があります。 select id,売上,入金,(select sum(売上-入金) from t1 where id<=x.id) as 累計 from t1 as x order by id
やり方としては ・トリガを使う ・ビューにする かな。 でも、 「いちいちselectで集計しなくても始めからカラムに集計値が入っていれば楽だなぁ」とはあんまり思いませんね。 トリガにしたら元データが変更になるたびに更新が走るし。 ビューは裏でSELECTするだけですから。
普通のグループ化でよいのでは？ SELECT * FROM (SELECT no,MAX(date1) AS date1,MAX(date2) AS date2 FROM TA GROUP BY no) ORDER BY no,date1,date2
LOBはSQL99で標準SQLに入ったばかりだし、操作するのにアプリケーションを作成する必要があり、RDBMS全体の機能としては局所的なものなので、雑誌や書籍類で取り上げられる機会は少ないと思います。 >ラージオブジェクトを使って、バイナリファイル（ここではPDF）を保管するメリットがあるのか？ メリットとしては、 (1)障害運用を一元化できる (2)セキュリティの管理を一元化できる (3)PDFデータを管理するテーブルのデータと、PDFの内容の不整合を防げる などでしょう。 デメリットとしては (1)PDFの内容を確認したい場合、RDBMS経由でないとダメ。検索や更新用のアプリケーション等を作っておく必要がある。 (2)PDFのデータを管理するのに、RDBMS側でも管理情報が必要になり、DBの容量が増える などです。
サンプルSQL テーブル（TBL）に氏名（Name）、得点（Score）があり、成績順に表示する。 SELECT A.Name,COUNT(A.Name)+1 AS 順位 FROM TBL A LEFT JOIN TBL B ON A.Score < B.Score GROUP BY A.Name ORDER BY COUNT(A.Name); 【解説】 自身のテーブルとJoinし、順位付けする項目で自分より良い成績のレコード数+1が順位です。 上記サンプルではAが主体で、Bは自分より得点の高い人（JOIN句参照）の集団を指します。 自分より高得点の人が10人いれば、自分は11位という理屈です。 最高得点の人は自分より高得点の人はいないので、カウントは0です。 順位=0は不自然なので、+1しています。
再度実行したときひつようなmax_fsmは減りますでしょうか？ おそらく減るのではないかと思いますが、運用上増えるという事も あるかも知れませんからその場合はある程度上げるといいかと
>PL/SQLの勉強をすれば、PL/pgSQLも出来るようになるのかを教えていただけます 独自仕様で実装されている中では、PL/SQLとPL/pgSQLは似ていますが、あくまで「RDBMSの独自仕様」ですから、どちらかを勉強すれば、他方もそのまま使える訳ではありません。ただ、どちらかを修得すれば、他方の修得に役立つとは思います。 ＜PostgreSQLのマニュアルより、PL/SQLからPL/pgSQLへの移行＞ http://www.postgresql.jp/document/pg800doc/html/ … ＜OracleとPostgreSQL間のSQL移行方法例＞ http://www.thinkit.co.jp/free/marugoto/2/1/22/1. …
>create unique index の unique は、たまたまデータがユニークという特 >徴をもっているだけで、ユニークじゃないデータが発生した場合は、(この >ままでは登録できないので) unique を外すことになるということだと考え >ます。 それは違います。 create unique indexは、一意性を保つためにも使用されます。 create tableでのunique指定は、RDBMSによっては実装されていないものもあります。 「uniqueで定義できなければ、uniqueを外す」というのは、テーブル設計に失敗しているということになります。 SQLの標準化では、操作系SQLに比べ、定義系SQLは後回しになっており、各RDBMSで独自仕様が多く含まれる部分です。推測ですが、create tableのunique指定は後から標準SQLに追加されたのではないかと思います。 その一方で、create indexでのunique指定は、標準SQLには入っていなかったものの、商用RDBMSが出始めた頃から、多くのRDBMSに実装されていました。 そのため、古くからRDBMSを使っていた人は、create indexでunique指定することで重複禁止にする方法に慣れていると思います。
考え方としては、時間型の変数を定義して加減算します。 例えば、 current_timestamp + time '04:00:00' を変数で行う場合、以下のようにします。 declare vTime time; vTime:='04:00:00'; current_timestamp + vTime 以下に例を示します。 (1)表定義例 create table uriage_tbl (ymdtm timestamp without time zone, price int); (2)プロシジャ定義例 create or replace function avg_price (pPM char(1), -- '+' or '-' pHour time without time zone) -- 'hh:mm:ss' returns dec(10,2) as $$ declare wAvg dec(10,2); begin raise info 'pPM=%,pHour=%',pPM,pHour; if pPM='+' then select into wAvg -- 標準SQLと語順が異なっている avg(price) from uriage_tbl where ymdtm>=current_timestamp and ymdtm<=current_timestamp + pHour; elseif pPM='-' then select into wAvg -- 標準SQLと語順が異なっている avg(price) from uriage_tbl where ymdtm>=current_timestamp - pHour and ymdtm<=current_timestamp; else wAvg:=null; end if; raise info 'wAvg=%',wAvg; return wAvg; end; $$ language 'plpgsql' ; (3)プロシジャ実行例 select avg_price('+','04:00:00'); select avg_price('-','04:00:00'); ＜注意＞ PostgreSQL 8.2前後で、select intoの語順が変更になっているようです。 PostgreSQL 8.0では、「select into 変数 avg(列名) from 表名」、 PostgreSQL 8.2では、「select avg(列名) into 変数 from 表名」 上記の例題は、PostgreSQL 8.0での記述になっています。
> select replace('山　田　太　郎',' ','') from user_master; replaceの第2引数が半角スペースになっているからでは select replace('山　田　太　郎','　','') from user_master; のように全角スペースで試してみていただけませんか。
こんにちは、angelinaane様 以下のSQLではいかがでしょうか？ SELECT tablea.ID,tablea.name FROM tablea LEFT JOIN tableb ON tablea.id = tableb.id WHERE tablea.name LIKE '%あああ%' AND tableb.kubun = 1 and tableb.naiyo >= 0 UNION SELECT tablea.ID,tablea.name FROM tablea LEFT JOIN tableb ON tablea.id = tableb.id WHERE tablea.name LIKE '%あああ%' AND tableb.kubun = 2 and tableb.naiyo >= 5 UNION SELECT tablea.ID,tablea.name FROM tablea LEFT JOIN tableb ON tablea.id = tableb.id WHERE tablea.name LIKE '%あああ%' AND tableb.kubun = 3 and tableb.naiyo <= 8 単純にUNIONで結合しただけです。 一応、条件通りだと思うのですが、もっと複雑な気がしています。 もしかして、 >区分1のとき内容が0以上　かつ >区分2のとき内容が5以上　かつ >区分3のとき内容が8以下 この条件は可変とか・・・ だとすると、プログラム中でSQLを組むだけなんですけどね。
こんにちは、angelinaaneさん select * from テーブル where substring(項目 from '\,|[0-9.-]+') = 項目 and cast(substring(項目 from '\,|[0-9.-]+') as float8) <= 4 これでいかがでしょうか？
（バックアップファイルを展開しTOCエントリファイル1514行以降に 必要な事をしていないと思えば無視して構わないとは思います） pg_resotre -CでDBも作成しようとしていると思いますが postgresのDBが存在しているか postgres(DB)を作成した時の所有者がmydbと異なっているか またはpg_dumpを旧バージョン(8.1よりまえ）の物を使用しているか 他は不明
はじめまして、titokaniさん SELECT EXTRACT(EPOCH FROM lastdate) FROM table ORDER BY lastdate DESC LIMIT 1 これでいかがでしょうか？ 一応、以下の構成で試しています。 OS:VineLinux4.2 Database:PosgreSQL8.2 pgAdmin3(WinXp) 参考URL：http://osb.sra.co.jp/PostgreSQL/Manual/PostgreSQ …
LASTVAL()は、マニュアルを見る限りPostgreSQL 8.3から登場しているようですが？ $sql = 'SELECT LASTVAL()'; $denpyo_no = $row['LASTVAL()']; 一般的には、 SELECT LASTVAL() AS LV のように別名を付け、 $denpyo_no = $row['LV']; のように別名で参照します。
再三すいません。 「汎用性」というのがどこまでのものなのか把握でききれずに回答していました。 「汎用性」という意味はかなり抽象的ですから。 先ほど記載されたSQL文であれば確かにご希望の値が取得できるかと思います。 こちらこそ、まともなアドバイスが出来ていないようで申し訳ありませんでした。
今回の例では、元々括弧を使う必要はないので、不必要な括弧を書かないようにすればいいのでは？ また、クエリを部分的にビューにしてしまえば、SQLは簡潔にできます。
具体的に何が分からないのですか？ 丸投げは、規約違反ですよ？ ここのカテゴリ通り、RDBMSはPostgreSQLでいいのですか？ ＜SQL例＞ select * from t1 where (A,B)=(select A,B from t1 group by A,B having count(*)>1)
#1です。 #2さんの回答を見て思い出しましたが、PostgreSQLは、サブクエリ内でlimit句を使えましたね。 もしRDBMSがPostgreSQLでなく、MySQLであったりしたら、サブクエリ内でlimit句を使えなかったと記憶していますので、念のため。
こんにちは。 >-iオプションを付けて起動すれば、TCP/IP接続できるようになると知って、 どこからの情報かわかりませんが、postmasterのオプションのことを 指しているのでしょうか？ でしたら、以前のバージョンのドキュメントですが、 ------------------------------------------------------------ リモートクライアントからのTCP/IP（インターネットドメイン） 経由の接続を可能とします。このオプションを設定しない場合には、 ローカルからの接続のみが使用可能となります。 このオプションは、postgresql.conf内のlisten_addressesを設定すること、 あるいは-hを*に設定することと同じ意味を持ちます。 ------------------------------------------------------------ あるので、postgresql.confとpg_hba.confの該当オプションを 適切に設定してみてください。
当方、PostgreSQL 8.0を使っていますが、 select * from t1 as x left join t2 as y on x.c1=y.c1 という別名を使った構文は使えるようです。 また、以下のようにインラインビューにする方法はどうでしょうか？ select * from (select * from t1) as x left join (select * from t2) as y on x.c1=y.c1
お疲れ様です。 where current_date >= to_date( dt, 'yymmdd' ) + 7 で抽出できませんか？
こんにちわ。 「C:\Program Files」内のPostgreのフォルダを消さなければだめだったと思います。
export PGCLIENTENCODING=UNICODE を指定するか pg_dumpallでなくpg_dump "database名"で個別 バックアップ どちらかでうまくいきませんか
>なにか、うまく動かすための裏技などはないのでしょうか？ >保障していなくても動く例は多いので期待してしまいます。 気持ちはわからなくもないですが、ご質問のソフトに限らす Vistaではメーカーが動作保障をしていないものは、インストール自体が出来ても 内部のデータを参照できなかったり、起動しようとしても起動しないとか 起動の動作はするけど、そのままで固まってしまうとか… Vistaが発売されてから１年ほどたちますが、いまだにそういうことは日常茶飯事です。 XPのときには、ここまでひどくなかったんですけどね（苦笑） プログラムメーカーがVista対応のバージョンをだすとか、Vista対応の 修正パッチをリリースするまで待つしかないと思います。 お役に立てなくてすみません。m(__)m
「LEFT OUTER JOIN 」ではなく「INNER JOIN」ならば同じになりますね。 「LEFT OUTER JOIN」は右側のテーブルに合致する行がない場合、その列はすべてNULLになります。ここがミソです。 ( SELECT * FROM テーブルB WHERE テーブルB.列X IS NOT NULL) として、XがNULLの行を除いたつもりでも、 「LEFT OUTER JOIN」で復活してしまう、そんなイメージです。
URLを貼り忘れました。 http://www.postgresql.jp/ また、差が出ているポイントは、テスト環境ではMerge Join、本番環境ではNested Loop さらにloops=38となっている部分だと思います。 具体的に「SQLのどの記述の部分」ということは、インデクスの定義とSQLが分からないと具体的にはアドバイスできません。
実質、丸投げじゃないですか！ >このあとの記述が複雑でわかりません この程度の関数で複雑というなら、自分で関数を作るのは無理なのでは？ と言いつつ、関数の作成例を、以下に示します。 もっと簡略化もできるのですが、逆に分かりにくくなるので、あえてこれ以上、簡略化しません。 １．定義 create or replace function bool2int (pBool bool) returns int as $$ declare vInt int; begin if pBool=true then vInt:=1; elseif pBool=false then vInt:=0; else vInt:=null; end if; return vInt; end; $$ language 'plpgsql' ; ２．実行 select bool2int(true),bool2int(false),bool2int(null);
PostgreSQLの話でいいのでしょうか？ >powergresでalter文でカラムの追加・削除等を行うと PostgreSQLに対しては、どんなalter文が生成されるのでしょうかね？？？ >追加したカラムに紐づくテーブルのデータが消えてしまったりすることはあるのか？　（alter文でカラムを削除した時のデータ以外のデータ） 「紐づく」というのは、いろいろな解釈ができてしまうのですが。。。 列の追加や削除時、そのテーブルの他の列のことですか？ それとも、外部キー等のことでしょうか？ default値がnullの列の追加や削除では、そのテーブルの行削除や他の列が影響を受けることはありません。 一方、default値がnot nullの場合は、全行にdefault値を入れるために、削除＆追加が一時的に発生するようです。 後者は、RDBMSによっては、「格納済の行がある状態でのnot nullの列追加」を禁止しているものもあります。 >・その詳細な理由がほしいです。 「詳細な理由」とは、どういう意味でしょうか？ 標準SQLやPostgreSQLが、そういう仕様になっている理由ということですか？ 「仕様を決めた人に聞いてください」と回答したくなってしまいますが。。。 それとも、「その仕様が書かれているマニュアル等の箇所」という意味でしょうか？ 階層型DBやネットワーク型DBでは、レコードの定義やデータをそのままに残しての列の追加や削除という概念がありませんでした。 RDBでは、定義やデータ移行などの方法を大幅に柔軟にしています。その中の一つということでは？ http://www.postgresql.jp/document/pg820doc/html/ …
こんにちは。 >-I"PostgresSQLインストールDir\include" >-L"PostgresSQLインストールDir\lib" Borland C++はわかりませんが、これは、 インクルードファイル、ライブラリファイルの検索パスを 追加しただけなんではないでしょうか？ 名前解決ができてないところを拝見すると、ライブラリファイルの リンクができてないのかな？と想像しますが、そのへんは 大丈夫でしょうか？
環境変数で解決済みかもしれませんが。。 パスワードファイルと呼ばれる仕組みも用意されています。(参考URL) Webなどから使用する場合は↓ http://ml.postgresql.jp/pipermail/pgsql-jp/2005- … 参考URL：http://www.postgresql.jp/document/pg826doc/html/ …
> これを単純に↓に変えてみたもののもちろんエラーとなり、 そのエラー内容が欲しい。 「単純に変えた結果どうなったか」がこの場面では重要だと思うのさ。今回は既に問題の箇所は出ているので、エラーメッセージぷりーず。 よろしくお願いします。 なんとなく、 「if (pg_num_rows($res) <= 0) { return; } $row = pg_fetch_array($res, PGSQL_BOTH);」 ってしたら動くんじゃねえかなとは思わなくもなきにしもあらず。
PostgreSQLは、別名を、その別名を付けた階層のクエリのorder byでは使用できないようですね。 別名を付けるクエリをインラインビューにしてしまえば、その側のクエリでその別名を使用できるようです。 select * from ( select x.id,sum(x.nedan) as nedan,sum(x.jitubai) as jitubai from (select * from tableA union all select * from tableB) as x group by x.id ) as y order by jitubai IS NULL, jitubai DESC, id ;
>文字コードは、 >ポスグレとソースは「EUC-JP」 >表示は「UTF-8」です。 文字コードが違うということですが、http_outputで変換するように記述されてますか？それとも自前で変換して出力いるのでしょうか？
文章だけでは、いろいろな受け取り方ができます。 得たい結果例、やってみたことを具体的に示しましょう。 time列のデータ型を示すべきだし、PostgreSQLのバージョンも書いておき ましょう。 例えば、以下のように表示したいということですか？ 時間帯___________________件数 2006-12-01 00:00:00 3 2006-12-01 00:00:01 2 2006-12-01 00:00:02 3 2006-12-01 00:00:03 3 timestamp型を使っているなら、to_char関数、group by句,count関数を組み 合わせるとできるのでは？
画面に出てファイルに残らないなら標準出力じゃなくエラー出力なんでしょう。 コマンド >> ログファイル 2>&1
t2.id(t1.id)のIndexが使用されていないのでしょうか。 explain select～で検索方法を確認した方が良いかと思います。
ALTER文でカラムの位置を変更することはできません。 どうしてもカラムの位置を変える必要がある場合、(多くの場合、SELECT文等でデータを抽出する時に順番を整えれば良いと思いますが・・・)ANo.1の方がおっしゃるように一度、テーブル内のデータをバックアップして、テーブルを作り直し、再度データを入れる必要があると思います。 > SQL形式でカラム名指定するモードでバックアップ おそらくpg_dump -D [table_name]の大文字Dオプションのことだと思います。 カラム名まで保持したINSERT文を生成するので、テーブルの順序が変更された場合に対応できます。 参考URL：http://www.postgresql.jp/document/pg826doc/html/ …
#１です。 シーケンスには、CYCLE というパラメータがあるのですね。 早速、これも試してみました。 =========================================================== test=# alter sequence test_id_seq cycle; ALTER SEQUENCE test=# insert into test (data)values(10); INSERT 0 1 test=# select * from test; 　　　　 id　　　　　| data ---------------------+------ 　　　　　　　　　 1 |　　1 　　　　　　　　　 2 |　　2 　　　　　2147483645 |　　3 　　　　　2147483646 |　　4 　　　　　2147483647 |　　5 9223372036854775806 |　　7 9223372036854775807 |　　8 　　　　　　　　　 1 |　 10 (8 行) =========================================================== 1 に戻りました。 id にUNIQUE制約付けてなかったので、登録されました。 過去のバージョンではデフォルトで UNIQUE になるようです。 http://www.postgresql.jp/document/pg732doc/user/ … 引用：PostgreSQL 7.3 より前のバージョンでは、serial は UNIQUE を暗黙指定していました。 10を削除して、UNIQUE制約を試します。 =========================================================== test=# delete from test where data=10; DELETE 1 test=# create unique index id_index on test (id); CREATE INDEX test=# insert into test (data)values(11); ERROR:　duplicate key violates unique constraint "id_index" test=# insert into test (data)values(12); INSERT 0 1 test=# select * from test; 　　　　 id　　　　　| data ---------------------+------ 　　　　　　　　　 1 |　　1 　　　　　　　　　 2 |　　2 　　　　　2147483645 |　　3 　　　　　2147483646 |　　4 　　　　　2147483647 |　　5 9223372036854775806 |　　7 9223372036854775807 |　　8 　　　　　　　　　 3 |　 12 (8 行) =========================================================== 11回目の追加は、UNIQUE制約に引っ掛りエラーです。 12回目の追加は、次の 3 が空いていたので、登録されました。 エラー発生時もカウントは加算されているようですね。 ----------------------------------------------------------- 話が、シーケンスの話になってしまいましたが。 serial型 の話に戻して、簡単にまとめてみます。 serial型 を使ったときに、自動で作られるシーケンスでは、 シーケンスの上限に達する前に、integer の上限でエラーが発生。 （これはリトライしても解決しない。） integer の上限に達する恐れがある場合は、何らかの対処が必要。 シーケンスを修正すれば、integerの範囲で、周回させる事も可能。 しかし、自動で空き番号を選択するような仕組みはない・・・と思います。 繰り返しますが、バージョン8.2.5で確認したので、 他のバージョンや、環境設定により異なると思います。
別のプラットホームにリストアした事はありませんが 8.2形式でバックアップするか、8.0のリストア環境が必要 と思います。 あとはエラーを確認する必要があるかと思います。
例えば、こんな感じ。 SELECT Hinmei, Tani, SUBSTR(hiduke,1,4) as Nen, SUM(CASE SUBSTR(hiduke,5,2) WHEN '01' THEN ryou ELSE 0 END) as "１月", SUM(CASE SUBSTR(hiduke,5,2) WHEN '02' THEN ryou ELSE 0 END) as "２月", SUM(CASE SUBSTR(hiduke,5,2) WHEN '03' THEN ryou ELSE 0 END) as "３月", SUM(CASE SUBSTR(hiduke,5,2) WHEN '04' THEN ryou ELSE 0 END) as "４月", SUM(CASE SUBSTR(hiduke,5,2) WHEN '10' THEN ryou ELSE 0 END) as "１０月", SUM(CASE SUBSTR(hiduke,5,2) WHEN '11' THEN ryou ELSE 0 END) as "１１月", SUM(CASE SUBSTR(hiduke,5,2) WHEN '12' THEN ryou ELSE 0 END) as "１２月" FROM masta WHERE hiduke BETWEEN '200801' AND '200812' GROUP BY Hinmei,Tani,Nen
ところで最終的なレポートを、どのような方法・アプリで見るつもりでしょうか？ 横に多数展開されたレポートは、非常に見づらいですよ？ 縦軸はポート番号、横軸は時刻にした方が見やすいと思うし、この方法ならSQL だけでも実現可能です。というか、#2で既に回答済でしたね。
たとえば、 SELECT column1, column2 FROM table WHERE id = '(ここに値を入力)' という文があったとします この場合 (ここに値を入力) の部分に ' OR 1=1 OR id =' と入力されたらどうなりますでしょうか SELECT column1, column2 FROM table WHERE id = '' OR 1=1 OR id ='' こうなりますね さて、どうしましょう・・・ (＊これは具体的な回答ではありません、自分で考えてみてください)
>ゼロ割りを回避する一般的な関数、方法 case式を使いましょう。 >値が「0」の場合は除算を行わないで、そのまま「0」を返却する 「0」を返却した場合、除算の結果が「0」であった場合と区別ができなくならないですか？nullを返した方がいいのでは？ 除数、非除数も合わせて表示するなら、そういった心配はないでしょうけど。
SELECT A,B,C, 'aaa' as D FROM TEST;
外部結合を利用してはどうでしょう？ select zaiko.*,product_data.* from zaiko RIGHT join product_data on zaiko.nyuko_item_code = product.item_code WHER ZAIKO.NYUKO_ITEM_CODE IS NULL （大文字の部分が変更点）
こんにちは。 普通にpg_dumpでバックアップはとれると思います。
こんにちは。 >気になるのがon,off両方の場合で最初にマスターテーブルを検索している（ >Seq Scan on マスターテーブル名）ようなのです。 例えば、 CREATE TABLE t_base (F1 int, F2 int, CONSTRAINT t_base_pkey PRIMARY KEY (F1) ); でマスタテーブルを定義して CREATE TABLE t_drive1 INHERITS (t_base); CREATE TABLE t_drive2 INHERITS (t_base); ・ ・ とパーティションを作成したとします。 極端な話、t_baseに10万レコードあり、各パーティションに1レコードしかなく、 あるパーティションにある（例えばt_drive2にある)レコードを検索しようとしても 時間的にはほとんどかわりません。 というのは、最適化してもマスタテーブルであるt_baseは必ず検索されるからです。 この場合は(t_baseとt_drive2が検索されると思われます) ですから、マスタテーブルにはレコードを格納しないで、すべて子テーブルに 記録しないとパーティショニングの効果は薄れるかと思います。 このへんはドキュメントにもかかれていますのでご確認ください。
No.1です。 列の属性をtimestampにして実行してみました。 Welcome to psql 8.2.0, the PostgreSQL interactive terminal. farm=# create table testtbl6 (hoge timestamp); CREATE TABLE farm=# insert into testtbl6 values('2007-12-31'); INSERT 0 1 farm=# select * from testtbl6; hoge --------------------- 2007-12-31 00:00:00 (1 row) farm=# select * from testtbl6 where hoge between '2007-01-01' and '2007-12-31'; hoge --------------------- 2007-12-31 00:00:00 (1 row) farm=# select * from testtbl6 where hoge between date '2007-01-01' and date '2007-12-31'; hoge --------------------- 2007-12-31 00:00:00 (1 row) ●時間だけを多少進めたデータを追加してみました farm=# insert into testtbl6 values('2007-12-31 01:00:00'); INSERT 0 1 farm=# select * from testtbl6; hoge --------------------- 2007-12-31 00:00:00 2007-12-31 01:00:00 (2 rows) farm=# select * from testtbl6 where hoge between '2007-01-01' and '2007-12-31'; hoge --------------------- 2007-12-31 00:00:00 (1 row) farm=# select * from testtbl6 where hoge between date '2007-01-01' and date '200 7-12-31'; hoge --------------------- 2007-12-31 00:00:00 (1 row) よって、あなたのDBに登録してあるデータは、2007-12-31と午前０時を少し回っているデータが登録されているため、 検索でヒットしないのではないのでしょうか？
$sql = "insert into m_lecturehistory (lecturecode, lecturedate ) values ('{$line[0]}',"{$line[1]}");"; なぜ、直接入力した場合に、日付を　「'」でかこったのに 変数に代入したときには　「"」でかこったのでしょう '{$line[0]}' の部分と同じ感覚でSQL文つくればいいだけです $sql = "insert into m_lecturehistory (lecturecode, lecturedate ) values ('{$line[0]}','{$line[1]}');"; つまりこうするだけ
PostgreSQL7.4系では、 ALTER SCHEMA name OWNER TO newowner; は定義されていないようです。 8.0から使えるようになったみたいですね。 http://www.postgresql.jp/document/pg800doc/html/ … 参考URL：http://www.postgresql.jp/document/pg746doc/html/ …
リモートデスクトップで該当マシンに接続してインストールしようとしませんでしたでしょうか？ PostgreSQLはリモートデスクトップ接続ではインストールできませんので該当マシンに直接インストールしてください。
http://www.hizlab.net/app/pgsec.html ここらへんをヒントにがんばってください
name1 || name2 as fullname ではいかがでしょうか？
とりあえずpostgreSQLでしたら発行するSQL文の頭にexplainを付けて、QUERY COSTを確認してみてはいかがでしょうか？ cost=の数字が極端に大きくなるところが律速です。
考えたこともなかったです・・・・・ プログラムをCで書くならINTEGER、PHPならどちらでも。 理由は「= =」だけで比較できるから、としか思いつきません。 私はINTEGERに一票
もう解決したかもしれませんが。 pg_dump/pg_restore実行前に export PGCLIENTENCODING=*** で文字コード指定で動作するような気がします
PostgreSQLは最後尾に追加することしかできなかった気がします。 ですので、'AFTER'以降はエラーになると思います。
pgpoolはSQLレベルのレプリケーションを行うだけなので、切り離した後の復帰まではサポートしていないと思います。 障害が発生した場合は、障害機を切り離す縮退運転として切り離した機は復帰させないようにします。障害を解消した場合は、正常機も一旦止めて、両機のデータを完全同期させる必要があります。（データ部分をrsyncする等でよいでしょう） というのも、pgpoolの場合、目的としているのが「不意の障害で運用を止めないこと」ですので、復帰のときに止めなくて済むようにはなっていませんので。もしそのようにしたいのであれば、分散クラスタ（PGCluster）や非同期レプリケーション（Slony-I）とかを検討すべきでしょう。
number型は、Oracle独自のデータ型で、PostgreSQL等では実装されていませんが？
使用しているＯＳの記載がないので憶測ですが、 もしＯＳがＰＣ－ＵＮＩＸ系なら、下記のスクリプトファイルも変更します。 /etc/rc.d/init.d/postgresql か postgres というファイル名の内容 port=5432のままだと思われますので、port=5433 へ同様に変更する。 自分は、上記でＯＫとなりました。 使用しているＯＤＢＣ・ＪＤＢＣ等には、デフォルトの5432しか認めない仕様の物がありますので、 十分注意して下さい。
「何をやったら、こういうメッセージが出てきた」ということを、具体的に示しましょう。 そうでないなら、回答できる人が一人もいない場合もあります。 pg_catalogは、PostgreSQLのシステムのスキーマです。 つまり、システムカタログや組み込み関数などが登録されているスキーマです。
こんにちは。 ヘルプドキュメントでto_timestamp関数を調べるところからはじめてください。
マニュアルで調べないのは、なぜでしょうかね。。。 http://www.postgresql.jp/document/pg800doc/html/ … select * from tbl1 where c2 like '%''%' -- 方法1 order by c1; select * from tbl1 where c2 like '%\'%' -- 方法2 order by c1; select * from tbl1 where c2 like $$%'%$$ -- 方法3 order by c1; select * from tbl1 where c2 like $自分で決めたタグ$%'%$自分で決めたタグ$ -- 方法4 order by c1;
PostgreSQL 8.0を使い、1台のPCでサーバ＆クライアントにして使っています。 私の環境では、以下のように設定していますが、質問者さんの環境ではどうなっているでしょうか？ >頭に「#」があるということは その行は実行されていないということですよね？ そうです。その部分は大丈夫ですね。 (1)pg_hba.conf →IPアドレスは、127.0.0.1になってますか？ 　※cseを使うため、私の環境ではmd5をtrustに変更しています。 # host all all 127.0.0.1/32 md5 host all all 127.0.0.1/32 trust (2)pgAdminIIIを起動し、サーバ名を選択時、ホスト名=localhostとなっていますか？ →もしなっていないなら、「編集」→「プロパティ」で変更してください。
1台のPCを、サーバ＆クライアントにするのですね？ PostgreSQLのサービスは、動いているのですね？ もし、動いていないなら、PostgreSQLのインストールフォルダの\data配下に、 pg_hba.conf postgresql.conf に、IPアドレスを指定している場所があるので、「127.0.0.1」以外になっていないか確認してください。 この二つのファイルは、pgAdminIIIで、メニューバーの「ファイル」から編集できます。 pgAdminIIIだけが繋がらないなら、サーバ名を選択した状態で、メニューバーの「編集」→「プロパティ」で、「アドレス」が「localhost」か「127.0.0.1」以外になっていないでしょうか？
接続できないトラブルの原因は大きく分けて以下の3つ 1.経路が繋がっていない。線が繋がっているように見えても、論理的に切断されている場合もある。 2.接続先(今回はPostgreSQL)が接続を受け付けていない。 3.接続元(今回はPHP5)が接続しにいく設定になっていない。 PHP君は「PostgreSQL君が接続を待ち受けていないよ」と言っている。なので、2番ではないかと考えられる。PHP側でpg_connectにhost=hogehogeを記述していないので正しいマシンに接続にいっていないという3番の可能性もあるにはあるんだけど。 見るべきはPostgreSQLの設定。とりあえず postgresql.confを開いて、 listen_addresses = '*' という風になっているか確認。無ければ次のいずれかに設定する。 listen_addresses='127.0.0.1' listen_addresses='<マシンのIPアドレス>' listen_addresses='*' 上から順番に安全だ。ただし、一番上はPHPとPostgreSQLが同じマシンで動作していなければいけない。 ところで、恐らくここで詰まったという事は、これが解決しても次の段階で詰まると思われる。上のpostgresql.confと同じ場所にあるであろうpg_hba.confもあわせて確認しておきたい。とりあえず設定例だけ掲載しておくので後は検索いただきたい。 host all all 127.0.0.1/32 password sameuser
移動でなくコピーですが (後で A の A1 を DROP すれば良い) テーブルのエクスポートをBにインポートします。 例 一行で書くと $ pg_dump -t A1 A | psql B
>DBに「2007-01-01　00:00:00」で登録してある日付 データ型は、timestamp型ですか？ >「2007/1/1」という形で出力したい ゼロサプレスする必要があるのでしょうか？ 「2007/01/01」では、だめなのでしょうか？ to_char関数を調べてみましょう。
「title like '%天気%'」といった操作方法は、性能を出せない検索の仕方です。 それをorで繋ぐといったことは、性能を出したいシステムでは普通はやりません。 データ件数が1000件以下程度ならいいですが、数万件、数十万件になるなら、設計を見直した方がいいですよ。
$hoge = array ( "07-03-02 20:31", "08-04-06 03:17", "07-06-30 17:52", "07-11-12 06:14", "07-12-01 09:23", "08-01-18 23:09" ); for ( $i=0;$i<=count($hoge)-1;$i++){ $hoge_split = mb_split(" ",$hoge[$i]);// $hoge_date = mb_split("-",$hoge_split[0]);//yy-mm-dd $hoge_time = mb_split(":",$hoge_split[1]);//hh:ii:ss $unix_time = mktime ( $hoge_time[0] ,$hoge_time[1] ,$hoge_time[2] ,$hoge_date[1],$hoge_date[2] ,$hoge_date[0] ); $now_time = mktime ( date("H") ,date("i")+1 ,date("s") ,date("m") ,date("d") ,date("Y") ); if ( $now_time < $unix_time ){ $hogehoge = date ('y-m-d H:i', $unix_time); }//if } データと現在時間をUNIXタイムに変換して比較してます。
recipe_ingredients表のmaster_id列と、vegetables表のvegetable_id列が対応しているのですね？ recipe表の野菜の名前はカタカナですが、vegetables表のname列はひらがななのですか？ などなど、いろいろと引っ掛かる点があるのですけどね。 SQL例を示しますから、実行結果が期待通りか確認すると共に、どういうことをやっているか調べてみてください。 select tR.* from tR inner join (select R_id from tRI inner join tV on M_id=V_id where name in('ズッキーニ','トマト') group by R_id having count(*)=2) as x on tR.R_id=x.R_id order by tR.R_id
スキーマ分けがいいと思いますが、現状そのような設計だとすると使いこなせない可能性も高いので・・・、もう一つ簡単な代替方法を。 データをプログラム側に渡してしまえば、その中で比較処理は出来ます。具体的には、table.idを配列で取るなり、他にも処理があるのであればオブジェクトで取るなりして、table2.idに対し、in句かループ文でupdateしていけばいいです。 ただし件数が多い場合はかなり処理が重くなる可能性があります。やる場合はデータ件数をきちんと考慮してくださいね。
>ACCESSのODBCで参照すると、正しく数値が入っているのですが、 >viewをVBAから参照すると桁が落ちます。 >60000が6になるなど。（不定期に。下４桁のゼロが消えているようです。） ACCESSのODBC経由だと正しくて、VBAだと正しく表示できないなら、VBAの受け 取り変数の宣言や代入、出力方法に問題があるのではないでしょうか？ >vbaからでも正しく数値が吐き出されている場合もあります。 どういうケースで正しかったり、正しくなかったりという切り分けはできないのでしょうか？ 今回の事象とは直接関係しないでしょうが、 >suuchi decimal 一般的には、decimal(m,n)と桁数を明示指定します。nは小数点以下の桁数、mは整数部桁数+nです。 省略した場合、桁数が何桁か、把握した上でこの指定をしていますか？ >sum(suuchi) as v_suuchi >from aaaa >group by sisya,busyo この表定義は、（sisya,busyo）でプライマリキーにしています。「group by sisya,busyo」で「sum(suuchi)」としていますが、各グループの件数は1件なので、sum関数を使う意味はないのでは？
この質問内容で、エラー要因を推測することは不可能であり、もし何らかの例を示せば、それは無責任なアドバイスになってしまうと思います。 >まれにinsertエラーが発生する アプリケーション側で、PostgreSQLからエラーが返った場合、どういう処理をしているのでしょうか？ 普通は、エラー内容を表示してから、ロールバックするなり、異常終了させるなりしますよね？ それとも、アプリケーション側に制御が戻らず、異常終了させられるのでしょうか？ 参考URL：http://www.postgresql.jp/document/pg824doc/html/ …
失礼ながら、いろいろな勘違いをしているようです。 update文で、複数の表を更新することはできません。あくまでも、1表だけです。 他の表の列値で更新することは可能で、サブクエリを使う方法以外に、 update 表1 set 列2=表2.列2 from 表2 where 表1.列1=表2.列1 のように、ジョインで得られた結果で更新可能ですが、更新対象はこの例では表1です。 updateでこの例のように、複数表を指定する構文を持っているRDBMSがあり、RDBMSにより構文が違う場合もあります。 >UPDATE TABLE_A INNER JOIN TABLE_B on TABLE_A.ID=TABLE_B.ID2 複数のRDBMSを知っていますが、このような構文は、見たことがありません。なぜ、このような構文を思いついたのでしょうか？ 外部キー（参照制約）についても、正しく理解されていないようです。 参照制約は、以下の制約で親子間の不整合を防ぎます。これは、階層DBやネットワーク型DBの特性を、RDBMSに取り入れたものです。 親子間の不整合の発生をRDBMS側で防止してくれる一方で、オーバヘッドがあったり、運用上の注意（親の表を削除する場合、子の表を先に削除など）が必要になります。 アプリケーション側で不整合を発生させないようにできるなら、わざわざ参照制約を使う必要はありません。 表定義でのディフォルトの指定（NO ACTION）での動作は、次のようになります。 (1)子のいる親の主キーは、更新できない。 →子の外部キーを一旦、null等に更新し、子のいない状態で親の主キーを更新。その後、子の外部キーを親の主キーと同じ値に更新する。 (2)子のいる親は、削除できない。 →子を削除してから、親を削除 表定義で、「ON UPDATE CASCADE」、「ON DELETE CASCADE」を指定した場合は、次のような動作になります。 (1)親の主キーを更新すると、子の外部キーも自動的に更新。 (2)親を削除すると、子も削除。 どちらの動作をさせたいでしょうか？ それにより、表定義を変えるか、SQLの発行順などが変わってきます。 ＝＝＝＝＝例１(NO ACTION)＝＝＝＝＝ １．定義 create table tbl1 (pkey char(2) primary key, data varchar(10)); create table tbl2 (pkey int primary key, fkey char(2), data varchar(10), constraint tbl1_tbl2 foreign key(fkey) references tbl1(pkey) match simple on update no action on delete no action ) ; create index tbl2idx1 on tbl2(fkey); ２．操作 (1) 子のいない親の主キー更新 update tbl1 set pkey='10' where pkey='04'; (2) 子のいる親の主キー更新 -- 子を更新して、親との関係を一時的になくす update tbl2 set fkey=null where fkey='03'; -- 親を更新 update tbl1 set pkey='05' where pkey='03'; -- 子を親に対応付け update tbl2 set fkey=tbl1.pkey from tbl1 where fkey is null and tbl1.pkey='05'; または update tbl2 set fkey='05' from tbl1 where fkey is null; ＝＝＝＝＝例2(CASCADE)＝＝＝＝＝ １．定義 create table tbl1 (pkey char(2) primary key, data varchar(10)); create table tbl2 (pkey int primary key, fkey char(2), data varchar(10), constraint tbl1_tbl2 foreign key(fkey) references tbl1(pkey) match simple on update CASCADE -- no action on delete CASCADE -- no action ) ; create index tbl2idx1 on tbl2(fkey); ２．操作 (1)親の更新の背景で、子も更新 update tbl1 set pkey='05' where pkey='03'; ※子の表に対する操作は、SQL上はないが、RDBMSにより更新されている。
データは、何件くらい格納していますか？ ANALYZEは、未実行ですか？ 表定義、INSERT文の例を、貼り付けてもらえると、アドバイスする方も助かるのですけどね？ PostgreSQLのバージョンは、何ですか？ PostgreSQLは、データ件数が少ないと、コスト情報を未取得でも、ディフォルト値でインデクスを使用しない場合があるようです。 RDBMSの常識として、インデクスの先頭構成列から順に、インデクスを有効利用できる条件式を指定するほど、インデクスを活用できます。 index siwakedata_indexの先頭～3番目は、order by指定しかなく、4番目以降が条件指定なので、これでは有効利用できません。4番目以降を先頭に持って来た方が、いいのではないでしょうか？
> ERROR: test_id_seq.nextval: you don't have permissions to set sequence wash_h_test_id_seq in test.php sequenceに関する権限が与えられてないって言われてるので、 GRANT ALL ON SEQUENCE wash_h_test_id_seq TO PUBLIC; とすれば動くのではないでしょうか？ 参考URL：http://www.postgresql.jp/document/pg825doc/html/ …
英語の解説サイトですら無いのですが、、PHPというWeb言語の実装の中に参考になりそうなモジュール(PDO_PGSQL)があるので、そのソースコードは良いサンプルになるかもしれません。 http://viewcvs.php.net/viewvc.cgi/pecl/pdo_pgsql … 参考URL：http://www.postgresql.jp/document/pg825doc/html/ …
>その2つのテーブルの差分を知りたいのですが、 >（Ａを基準と考えＢとの差分：つまりＡには存在しないデータ抽出） Aを基準なら、普通は「Aにあり、Bにない」だと思いますが？ 紛らわしいので、「t1にあり、t2にはない」として、SQL例を示します。 -- 例1 not existsを使う select c1 from t1 where not exists(select * from t2 where t1.c1=c1) -- 例2 not inを使う select c1 from t1 where c1 not in(select c1 from t2) -- 例3 left joinを使う select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c1 is null
contans→contains issus\es →issues でしょう。 ”あなたのローカルのAdministratorグループには、Interactive Usersが含まれています。 セキュリティ上の問題を引き起こす共通設定エラーです。” ？というような内容。 TIGRLISというようなアカウントドメインが不明ですが、これは不要な気がいたします。 また、PostgreSQLをAdministratorでインストールしてはいけないと、インストーラのしょっぱなに赤字で警告されていたような。。。
管理者ガイド http://www.postgresql.jp/document/pg653doc/ej/ad … ユーザガイド http://www.postgresql.jp/document/pg653doc/ej/us … こことか http://www.postgresql.jp/document/pg800doc/html/ 概要 http://itpro.nikkeibp.co.jp/members/ITPro/oss/20 … これが初歩の初歩 http://allabout.co.jp/internet/database/closeup/ …
10や3という数値定数を指定すると、データ型がint（整数）と仮定されます。そして10/3も演算の中間結果もint同士の演算なので、データ型はintになるため、ここで小数点以下が切り捨てられます。 これを防止するには、10や3を10.000や3.000のように、データ型にdecが仮定され、小数点以下を保持できるようにします。小数点以下の精度をどのくらい保証できるようにしたいかにより、10.0や10.000あるいは、10.00000のように指定します。 今回のケースでは、 select to_char(10.000/3.000, '99D999'); のように指定すれば、期待した結果を得られます。 他のRDBMSでも細かくは確認していませんが、同じようなことが言えます。またSQLに限らず、プログラミング言語でも演算の中間結果がどういうデータ型になるか注意しないと、演算精度がまったく違うものになります。
できます。 MySQLのデフォルトポートは3306、PostgreSQLのデフォルトポートは5432。 待ち受けポートが重複していなければ問題なく可能です。 （実際に開発用マシンでは、Oracle、MySQL、PostgreSQL、MS SQL Serverのうち複数が同時稼働しています） なお、メモリは多めに積みましょう。
TIME型は24:00:00までしか入らないのですね。 ごめんなさい。 表示時間が0時に掛かる場合の検索条件をORで加えてみてはどうでしょう。 select * from test where (a <= b and a <= CURRENT_TIME AND CURRENT_TIME < b) or (a > b and (CURRENT_TIME < b or a <= CURRENT_TIME)); /* テストデータ */ insert into test values ('21:00:00', '2:00:00'); -- 9時から24時まで表示 insert into test values ('9:00:00', '0:00:00'); -- 0時から9時まで表示 insert into test values ('0:00:00', '9:00:00'); insert into test values ('15:00:00', '20:00:00'); /* 結果（試験時、22時30分）*/ a | b ----------+---------- 21:00:00 | 02:00:00 09:00:00 | 00:00:00 (2 rows) 参考URL：http://www.postgresql.jp/document/pg824doc/html/ …
質問内容が分かりにくいのですが？ 結果で示された内容に、重複はありません。 unionでallを指定しなければ、重複排除されます。その結果を、さらにdistinctするのは、余分な操作です。 それでもなお、「重複のない名前を得られない」というのは、質問者さんの頭の中にあることが、表現できていないことになります。」
少し勘違いがあるようです。 create tableで指定するprimary keyやuniqueは、重複チェックを効率的に行なうために、内部的にインデクスを定義しています。このインデクスだけをdropできてしまうと、矛盾する状態になってしまいます。 primary keyやuniqueで定義されるインデクスを削除するには、alter tableでprimary keyやuniqueの制約自体を削除する必要があります。 primary keyやuniqueで定義されるインデクスは、PostgreSQLの内部処理でインデクスを定義するため、名前も自動的に決められます。 一方、重複可のインデクスは、create indexでユーザが定義し、名前もユーザ側で指定したものになります。
DDL（定義系）SQLでいいなら、PostgreSQLを含め多くのRDBMSでは、 create index文を使います。 create [unique] index インデクス名 on 表名(列名1[,...]) uniqueを指定すれば重複禁止、省略すれば重複可のインデクスになります。 http://www.postgresql.jp/document/pg800doc/html/ …
この質問内容では、「課題の丸投げ」で規約違反になる可能性があります。設問で、SQLに関するヒントが出ている訳ですから、質問者なりのSQLを組んでみてください。それでも、なお分からないなら、分からないところを具体的に示し、質問してください。
こんにちは。 まず、あなたのPHPがPostgreSQLが接続出来る環境にあるか確認してみて下さい。phpinfo()でインストール状況を表示させ、PostgreSQLの項がありますか？ デフォルトではインストールされない場合があります。 あればPostgreSQLのインストールがうまく出来ているか確認して下さい。PostgreSQLは初期設定ではいろいろなアクセス制限がありますので、WEBサーバ（PHP）から接続出来るように設定する必要があります。 ユーザ名、パスワード等がちゃんと設定され、そのユーザに接続権限がある必要があります。
plperl.dllはPostgrSQL側のモジュールなので、 Perlのディレクトリを探してもみつかりません。 PostgreSQLのインストールされたディレクトリを探してください。 > "C:/Program Files/PostgreSQL/8.2/lib/plperl.dll": ここにあると思うんですけど。 5.6のディレクトリを5.8よりも後に登録しておけば 両方をPATHに置くのもできると思いますが、 perl56.dllだけPostgreSQLのディレクトリに 放り込んでおいても動くような気がします。
こんにちは。 以下を参考にしてみてください。 http://kashinya.com/blog/archives/2006/11/postgr … http://www.orca.med.or.jp/receipt/guidance/rebld …
>複数検索で検索した場合その検索値順で取得したい 「検索値順」というのは、非常に曖昧な表現です。「検索条件の値の指定順」といった表現にすべきです。なぜなら、RDBMSは性能を出すために、検索条件を最適化し、物理的なI/Oが出る順にして検索してくれたりするからです。 PostgreSQL 8.2なら、それまではin条件を「or条件」のアクセス計画を作っていたものを、「in条件」のアクセス計画にするようになっていると記憶しています。 前置きが長くなってしまいましたが、ここからが直接的なアドバイスです。 こういったケースでは、case式等でソート順を与えてやる必要があります。 select * from A where id in(7,9,4,6) order by case id when 7 then 1 when 9 then 2 when 4 then 3 when 6 then 4 else 0 end といった書き方になります。
>「エラーになる」、「動作しません」 どういう事象になるのか、具体的に書きましょう。 何かエラーメッセージやエラーコード類は、出ていませんか？ 「WHERE tel LIKE N'090%'」の「N」の意味を知った上で、この書き方をしていますか？
これでどうですか？ substring(id from 1 for length(id)-2) || '-' || substring(id from length(id)-1 for length(id))
あなたが考える正解だと思われるSQLを先に書いてもらえますか？
1.テーブル空間(tablespace)を作成 2.データベース作成時、データベースにテーブル空間を紐付ける という手順で行えます。 CUIからのSQL文がよく分からない場合は、とりあえず 　Windows端末で pgAdmin III を利用し、 　Linuxサーバの PostgreSQL を操作してみてください。 pgAdmin IIIから操作すれば、すぐに概念が理解できると思います。 （pgAdmin IIIには、操作のsql文の表示されますし）
PostgreSQL のホスト別アクセス制御設定ファイル pg_hba.conf　の hostとlocalの行はどうなっていますか？このファイルの設定でhostからアクセスができないようになっているとphpのpg_connect()の引数にhost=****となっている場合アクセスできません。
随分、雑な質問の仕方ですね？ ここの利用規約では、「分からないところを具体的に示し、質問する」ことになっています。自分なりの考えを示さず、仕様を提示してSQL等を作ってもらうことは、「質問でない。作業依頼」として削除される可能性があります。 >例えば、2003-1-11(field1),2003-1-15(field3)。 開始日、終了日ということですよね？ >時期をグループして計算 グループ化ですか？ グループ化すべき項目はないようですが？ Table2に、今回提示された1行のデータしか入っていないor検索条件で絞込み1件しかヒットさせないなら、下記のようなSQLで得られると思います。 select sum(case when sanpi=1 then 1 else 0 end) as 賛成, sum(case when sanpi=-1 then 1 else 0 end) as 反対 from Table1 where exists(select * from Table2 where BgnDate<=T1Date and T1Date<=EndDate) 具体的な仕様が書かれていないので、これ以上の回答は無理です。
追記です。 PostgreSQL-8.2.4 (CentOS 4.5) Access2000 (Windows2000) ODBC PostgreSQL Japanese 7.03.02.60 で試したら改行もそのままコピーできました。
こんにちは。 ２．終了時点でpsqlは実行されているので、３．で再びpsqlを呼び出す 意味がわかりません。もしかして、 >psql -U ユーザー名 -d データベース名　-f　"c:\20070822EXPDAT.db" はpg_restoreの間違い？ あと、 >pg_dump -U ユーザー名 -f %DATE:~0,4%%DATE:~5,2%%DATE:~8,2%EXPDAT.db DB名 <dmp.txt プレーンテキストでダンプしてますけど、これでうまくpg_restoreできましたっけ？ pg_dumpののとき -Fcオプションをつけてダンプしたら、リストアがうまくいかない ですか？
私はいつも、 createdb -U postgres -E EUC_JP hogehoge psql -U postgres hogehoge <ここでパスワード入力> \i c:/files/hogehoge というようにやっています。
#1、#2回答者です。 >仮にhp_body、hp_urlにindexを指定する場合、 >create index hp_table_ix1 on hp_table(hp_timestamp, hp_body, >hp_url) >とすればよいのでしょうか？ 3列でインデクスを構成したければ、そういう指定になります。 インデクスを利用し性能を出すための検索条件等の書き方と、インデクスの定義方法はお分かりですか？ 不必要なインデクスを定義すると、insert、update、deleteでは、オーバヘッドになってしまいます。 なお、primary keyを指定した列には、PostgreSQLがユニークチェックするために内部的にインデクスを定義します。したがって、同じ構成列のインデクスを定義するのは、更新処理等でオーバーヘッドになるだけです。 インデクスの有効利用について、いくつか例を示します。 なお、データ件数が相当に少ない（100件とか）場合は、PostgreSQLに「インデクスを使うより、表データを直接見た方が早い」と判断される場合があります。 また、analyze文等でコスト情報（重複度合いなど）を収集している場合は、以下の説明とは違ってくる場合があります。 ＜例1＞単一列でインデクスを構成 (1)インデクスの定義 create index t1ix1 on t1(c1) (2)インデクスを有効に利用できる検索 　次のような検索で、インデクスを有効利用できます。 select * from t1 where c1='a' -- =条件 select * from t1 where c1 between 'a' and 'z' -- 範囲条件 select * from t1 where c1 like 'a%' -- 前方一致 select * from t1 where c1 in('a','b','c') -- in条件 また、以下のような操作でも、インデクスが活用されます。 select sum(c1) from t1 -- 集合（集計）関数 select * from t1 order by c1 -- ソートやグループの指定 select * from t1 order by c1 limit 100 offset 100 -- limit、offsetは有効利用できるインデクスがないと、表のデータ部を空読みして読み飛ばすことになる。インデクスが利用できれば、インデクス上で読み飛ばしできる。 インデクスを有効利用できる検索条件と、利用できない検索条件があった場合は、インデクスで絞り込んだ後、表の格納データで条件が評価されます。 select * from t1 where c1='a' and c2>100 また、ソート(order by）やグループ指定(group by）、重複排除(distinct）指定時、利用できるインデクスがないと、表データを見てソートが行われることになります。 （検索条件でデータが絞り込まれている場合は、そのデータのみ） select * from t1 order by c2 ＜例2＞複数列でインデクスを構成 (1)インデクスの定義 create index t1ix2 on t1(c1,c2,c3) (2)インデクスを有効に利用できる検索 　次のような検索で、インデクスを有効利用できます。 select * from t1 where c1='a' -- インデクスを構成する先頭列にインデクスを有効利用できる条件あり。 ただし、この検索の場合はc1だけのインデクスがあればいいので、c1～c3でインデクスを構成していた場合、キー長が長くなる分、1個のインデクスページで管理できる情報数が少なくなり、インデクスのI/Oは多くなります。 select * from t1 where c1='a' and c2=100 -- インデクスを構成する先頭列に加え、他の構成列も、インデクスを有効利用できる条件あり select * from t1 where c1='a' and c2=100 and c3>50 select * from t1 where c1='a' and c3>50 -- c2の条件がない場合、インデクスの利用効率はc2の条件がある場合比べ悪い select * from t1 where c1 between 'a' and 'z' order by c1,c2 -- 条件式で絞り込む以外に、ソート指定がインデクス構成列と同じ並び(昇順、降順は、まったく同じor全部逆）であればソート抑止できる。group byやdistinctの背景でもソートが行われるので、その場合も同様。
質問に示されたデータでは、ソートに利用できるキーがないので、 検索結果の順序は保証されませんよ？ ＜SQL例1＞ select case when B='A' then 1 else 0 end as A, case when B='B' then 1 else 0 end as B, case when B='C' then 1 else 0 end as C, case when B='D' then 1 else 0 end as D from t1 上記のSQLを活用すると、次のような検索結果を得ることも可能です。 A B C D 3 1 1 2 上記の結果を得るには、次のようなSQLになります。 ＜SQL例2＞ select sum(A) as A, sum(B) as B, sum(C) as C, sum(D) as D from ( select case when B='A' then 1 else 0 end as A, case when B='B' then 1 else 0 end as B, case when B='C' then 1 else 0 end as C, case when B='D' then 1 else 0 end as D from t1 ) as x
次のSQLを試してみてください。 select (select count(*)+1 from t1 as x where x.c1<y.c1 or x.c1=y.c1 and x.c2<y.c2 or x.c1=y.c1 and x.c2=y.c2 and x.c3<y.c3) as no, c1,c2,c3 from t1 as y order by no;
使用しているOSなどの環境が分かりませんが。。。 情報スキーマのroutines表に、ストアドプロシジャの定義内容が格納されています。 http://www.postgresql.jp/document/pg800doc/html/ … select routine_definition from information_schema.routines where routine_name='ストアドプロシジャ名' 何らかのGUIツール等を使わずにroutine_definition列を見ると、見づらいです。 pgAdminIIIが使えるなら、ファンクション一覧を表示させて、そこから選択した方が、整形して表示してくれます。
select ～ from 表名 where id not in(1,2,30,40) ただし、性能を重視するなら、「～以外」といｔnot系を使うのではなく、その「～以外」のものを肯定の条件で指定した方がいいですよ。 もちろん、インデクスを定義していることが前提です。
PHP4.2からpg_query関数が使えるみたいですのでPHP4.4.1だと 問題ないはずですよね。 そうなるとお使いの環境のPHPでPostgreSQLのモジュールがロード されていないことは考えられませんか？ このへんはOS(WindowsやLinux)によっても違いますし、 WEBサーバ(IISとかApache)によっても設定が違いますので 一概に解決策を言うのは難しいと思います。
インストールしたのは、Windows版のPostgreSQLですか？ Postgresというユーザが、作成されていませんか？ 最初から他力本願では、オープンソースを使いこなすのは難しいですよ？ 参考URL：http://allabout.co.jp/internet/database/closeup/ …
補足をお願いします。 ・商用利用ですか？どれくらいの信頼性が必要なのですか？ ・Linuxを初めそれぞれを準備し、メンテナンスするのにどれくらい予算がかけられるのですか？ ・OSはまだしも、CGIで実現する要件にはどのような機能が必要なのですか？ ・メンテナンスは誰が行い、どれくらいのスキルがあるのですか？ まず一つ目について。 商用利用であれば、商用Linuxを選択したほうが無難でしょう。 信頼性が求められる場合も同様。 構築およびメンテナンスを行う人のスキル等にもよりますけど。 二つ目に関わってきますが、お金がかけられないのであれば商用Linuxはダメってなってしまいますし。 三つ目について。 apacheやPostgreSQLのバージョンを先に決めてしまっても、実現したい機能がないバージョンだと意味がなくなってしまいます。 メンテナンスの件で言えば、商用Linuxを購入して、そのLinuxで提供されているパッケージにあるものを使うのが一番楽でしょう。 四つ目について。 メンテナンスする人にスキルがなければ、それこそサポートのしっかりしている商用Linux使った方がよいとなります。 むしろスキルがないなら、そのへんやってくれる企業に委託したほうが良いでしょうが。
やや手間がかかりそうですが、手順通りやれば簡単にできるのではないかと思います。 参考URL：http://www.yaskey.cside.tv/mapserver/pgis/pgsql_ …
（バックアップをしっかり取っていれば）ログイン後、いきなり実行して問題無いと思います。 PostgreSQLはデータベース毎に文字コードを指定できるので、実行するのは後者 > #データベースを作成するときにエンコードを指定する場合 > CREATE DATABASE test ENCODING 'EUC_JP'; だけで良いと思います。 参考URL：http://www.postgresql.jp/document/pg824doc/html/ …
まず、きちんとしたSQLになっているか確認するのがよいと思います。 var_dump("INSERT INTO aas(number,name) VALUES('$number','$name')"); とやってみるとどうでしょうか。 ダブルクォート("")間は内は文字列として認識されるため、 変数が正しく認識されないかもしれません。 "INSERT INTO aas(number,name) VALUES('$number','$name')" ↓ "INSERT INTO aas(number,name) VALUES(".$number.",'".$name."')" でどうでしょうか。
思いつきですが、 ラージオブジェクトのエクスポートがサポートされている新しいバージョンのpg_dumpコマンドを使ってダンプするとかはどうでしょうか。 (8.2系では差がありすぎるかも知れません。7.1系か？)
>しかし上記のように省略するとエラーが出ます。 具体的には、どういうエラーですか？ 下記の例のように、serial指定列を省略して、格納可能です。 ＜定義例＞ create table t1 (c1 serial, c2 int); ＜格納例＞ insert into t1(c2) values(100); 明示的にnextvalで指定する場合は、連番型につけられた名前を指定する必要があります。この名前は、「表名_列名_seq」という名前になります。 上記の例では、次のようなSQLで格納できます。 ＜格納例２＞ insert into t1 values(nextval('t1_c1_seq'),200); 参考URL：http://www.postgresql.jp/document/pg800doc/html/ …
どんな更新なのかはわかりませんが、8時間とは異常な時間ですね。 PostgreSQL8.0はけっして遅いDBでありません。 全体的に遅く、たいした件数(10万件程度ならたいした件数ではありません)もないのに8時間もかかるならディスクアクセスではなく、 別の原因が考えられます。 考えられる原因 1．PostgreSQLのWindows版が、一部のウイルス対策の影響で激重になることがあります。 2．VACCUM ANALYZEをかけていない。 また、Windows版はデータ保存位置を動かすことはできないと思います。以前ここで質問があった際にいろいろ試しましたが、断念しました。
こんな感じでどうでしょうか？ #Postgre自体のデフォルトエンコードを指定する場合 initdb --no-locale --encoding=EUC_JP #データベースを作成するときにエンコードを指定する場合 CREATE DATABASE test ENCODING 'EUC_JP';
追加情報お願いします。 ・createdb したときの文字コードは何を使っていますでしょうか。 　(psql -l　で確認できます） ・データは、「どこから」入力しておりますでしょうか？ 　ターミナル(端末)ですか？　他のツールですか？　何かのWebアプリ　ケーションの画面？ 　ターミナルならば、ターミナルの文字コードはDBと一緒でしょうか？ たとえば、 $ createdb -E EUC_JP testdb というように文字コード=EUC_JPで作ったDBに、 Fedoraのシステム文字コードであるUTF-8の コンソールからそのままinsert文で日本語を入れようとすると おそらくエラーになるのではと思います。 　
ユーザ名は、「postgres」を使用しているのでしょうか？ 表を作成したユーザ名と、参照しようとしているユーザ名が違うなら、grantでの権限付与が必要ですが、その辺は問題ないですか？ http://www.postgresql.jp/document/pg801doc/html/ … http://www.postgresql.jp/document/pg801doc/html/ …
#1 です <?php タイトル コメントアウト（行頭に//）してますか？ <?php //こんな感じでタイトル
>勤務時間外勤務開始時間を'18:00:00'と言った形で書くと型が合わないと言われてしまいます。 >(timestampは日付まで入力されているので確かにそうなのですが) とおもうのであれば勤務終了時間をcastすればいいだけでは？ （castで上手くいくことは検証済みです）
COPYコマンドにはオプションでカラムを指定できます。指定した順に出力されます。 http://www.postgresql.jp/document/pg803doc/html/ … 「タイムスタンプ部分」は「タイムゾーン」のことですね？ タイムゾーン不要ならCREATE TABLEの時に"without time zone"しておくのが一番簡単です。 http://www.postgresql.jp/document/pg803doc/html/ … 既に定義済みのテーブルからどうしてもタイムゾーン無しのデータをエクスポートしたいのなら、一旦ビューテーブルを作ってそのビューテーブルをエクスポートするとよいでしょう。 cretate view v1 as select cast(col1 as timestamp without time zone),col2 from t1; 参考URL：http://www.postgresql.jp/document/pg803doc/html/
事前にユーザpostgresを作成してから実行していますか？ 一度、/usr/local/pgsql/data以下を全て削除してから、initdbし直してみて下さい。 ユーザpostgresで、データベースpostgresが生成できないと前に進みません。
説明文が不明確だし、ところどころ日本語も変だし、提示されているSQLとも合っていません。 >分類別に売れているTOP10を表示し 提示されているSQLに、「分類別に操作」している部分はないですけど？ >重複部分もあるので最大150個の商品が表示されるようになっています これは、何についての説明ですか？そういうアプリケーションを作っていて、そこからSQL部分だけを抜き出して、この質問をしているということですか？ こういった内容のアドバイスを求める場合は、次のような情報を最低限、示してください。 (1)表と構成列 (2)各表に入っているデータ例 (3)得たい結果 各表のデータ、得たい結果は、「やりたいことのポイントとなる部分」が分かるものにしてください。
>primary key などの制約も同時にコピーする方法 これは1個のSQLでは、できないようです。 >後付で制約をつけるにも、CREATE TABLE時にしかつけることができないみたい これは誤解のようであり、alter tableで行なえます。 私の環境は、PostgreSQL 8.0.0ですが、試しにやってみました。 (1)表の定義 create table t1 (c1 int primary key, c2 int, c3 int); (2)データ格納 insert into t1 values(1,11,111); insert into t1 values(2,22,222); insert into t1 values(3,33,333); (3)表定義＆データコピー create table t2 as select * from t1; (4)primary key追加 alter table t2 add primary key(c1);
ALTキーを押しながら、「半角／全角」を押して切り替えるだけでは？
以下でざっくりは動くと思いますが、SQLインジェクションなどの対応がまったくできていません。 ローカルでお試しになられるのはいいかと思いますが、公開されるのはどうかと思います。 前の方が言っておられるようにHTMLの勉強はもちろん、Webアプリ（この場合PHPとPostgreSQL）の勉強をされたほうがいいと思います。 何か一冊本を買うことをお勧めします。 ---- 1) HTMLページ <? require('../include/init.inc'); $email = $_POST['email']; ?> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=EUC-JP" /> </head> <body> <form action="Test1.php" method="post" name="myFORM"> <INPUT type="checkbox" name="name[]" onclick="chg()" value="aaa">：aaa <INPUT type="checkbox" name="name[]" onclick="chg()" value="bbb">：bbb <INPUT type="checkbox" name="name[]" onclick="chg()" value="ccc">：ccc <INPUT type="checkbox" name="name[]" onclick="chg()" value="ddd">：ddd <INPUT type="checkbox" name="name[]" onclick="chg()" value="eee">：eee <INPUT type="checkbox" name="name[]" onclick="chg()" value="fff">：fff <INPUT type="hidden" name="email" value="<?php echo htmlspecialchars($email); ?>"> <input type=submit value='選択'> </form> </body> </html> >　→ ここで配列のデータを変数に入れる処置が必要？ ここというか、次のPHPで必要になります。 2) Test1.php <? require('../include/init.inc'); $email = $_POST['email']; $name = $_POST['name']; // このままですと $name は配列です // 登録先（keyword）のデータ型はキャラクタなので // 文字列ないし、シリアライズする必要があるでしょ。 // これは、使用ほうほうによって決めるべきです。 // 文字列にする場合（項目をカンマ切りで） // $name = implode(",", $_POST['name']); // シリアライズする場合 // $name = serialize($_POST['name']); // 今回はとりあえず文字列にする // 文字の長さなどチェックが必要 $name = implode(",", $_POST['name']); $sql = "BEGIN; update mailing_list_sentaku set keyword = '" . $name . "' where mailing_list_name = '" . $email . "'; COMMIT;"; pg_query("$sql"); ?> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=EUC-JP" /> <body> SQLを確認<br /> <?php echo htmlspecialchars($sql); ?> </body> </head>
#4です。ほっ、間に合ってよかった。（いえ、独り言です。） 「postmaster」っていうのは、PostgreSQLのデーモンプロセスでもあるわけだから、rootでも操作が出来なくはないはず・・・、といろいろといじっていましたらGUIでの操作方法を発見です。（以下、Fedora Core6[KDE]のばあい。） １．「K メニュー」→「システム」→「Services」より"system-config-services"を起動． ２．「postgresql」の所にチェックを入れてから、「開始」ボタンを押下。 ちなみに、上記と同じことをCUIにて行いたいのであれば、Red Hat 系の場合は、以下のコマンドを実行します。 /etc/rc.d/init.d/postgresql start で、質問者さんの場合では何故できなかったのかに関しては、以下のサイトを参考にしてください。（私自身、詳しくは分かりません。近々、Ubuntuもさわってみようかな～と考えているので、その時までには理解しておこうかなと。） Debianでの起動処理(init)とランレベル(rc.d)の制御 http://park15.wakwak.com/~unixlife/linux/de-init … インストール手順などが載っているサイト上では、よく「起動スクリプトの作成」についての説明があったりしますが、以下の過去ログにもある通り、通常はいちいち作らなくてもいいはず。 「RedHat ES4でPostgreSQLを自動起動したい」 http://oshiete1.goo.ne.jp/qa2848463.html ちなみに、既存の起動スクリプトの場所がどこか知りたいのなら、「ファイル/フォルダを検索」にて名前(N):は「postgres」、参照(I):は「file:///」とすれば、だーっといろいろと出てくることと思う。 最後に、DB管理者さん向けのサイト。 エラー時の対処法 http://mland98.rc.kyushu-u.ac.jp/text/skyboard-2 …
どういうルールで並べるのか、具体的に示してください。質問者さんの頭の中にあるルールは、他人には分かりませんし、SQLの提示のしようがありません。 件数が少なく、データのパターンが明確なら、case式等でソート用に定数を与えるといった方法もあるでしょう。 データに幾つかの群があるなら、その群を別々に検索して、unionでくっつけるといった方法もあるでしょう。
提示したSQLに、条件の漏れがありました。 イベント開催期間が、完全に他のイベントに含まれている場合の条件が抜けていまし た。 id 開始日　終了日 1 6/5 6/10 2 6/10 6/15 3 6/15 6/20 4 1/1 12/31 上記の場合、イベント4を含んで検索できていませんでした。 カッコ内の条件に、以下を追加する必要があります。 「or x.sdate<y.sdate and x.edate>y.edate」 ＜訂正結果を反映したSQL＞ select x.id,y.id as 重複id from t1 as x,t1 as y where (x.sdate between y.sdate and y.edate or x.edate between y.sdate and y.edate or x.sdate<y.sdate and x.edate>y.edate) and x.id<>y.id order by x.id,y.id;
自分で、検索してみましたか？ http://allabout.co.jp/internet/database/closeup/ … http://www.yc.musashi-tech.ac.jp/~yamada/doc/pgs …
エラーの捕捉は可能です。 http://www.postgresql.jp/document/pg823doc/html/ … PL/pgSQLでは、ファイル操作する機能はないようです。PostgreSQLでは、C言語でユーザ定義関数を作成できるので、C言語等で実装する必要があると思います。 http://www.postgresql.jp/document/pg823doc/html/ …
どうしても縦（＝別の行として）に表示したいですか？ 横に並べる形でもいいなら、簡単なSQLで実現可能と思います。 select sum(case syuusi when '収入' then kingaku else 0 end) as 収入, sum(case syuusi when '支出' then kingaku else 0 end) as 支出, sum(case syuusi when '収入' then kingaku when '支出' then -kingaku else 0 end) as 収支 from suitoh_table where hiduke like '2007-5-%' and syuusi in('収入','支出') ;
こんばんは。 ＞configure: error: readline library not found パッケージ版のreadlineを利用して、Postgresqlをコンパイルするのなら、 開発用ヘッダファイルなどを含む、readline-develパッケージもインストールしてください。 (＃４で回答しているのですが。。。） yumコマンドを使えば、ネットからダウンロードしてくれます。 # yum install readline-devel ちなみに、PostgreSQL8.3の正式リリースはまだ先ですので、何か不具合があっても 自己解決してください。
オンラインマニュアルのページは参照されましたか？ 「8章データ型」を参照してみてください 参考URL：http://www.postgresql.jp/document/pg820doc/html/ …
PgAdminIIIでしたら、C++のソースがありますので確認できます。 http://www.postgresql.org/ftp/pgadmin3/release/v … から、 pgadmin3-1.6.3.tar.gz を落としてこれます。 pgadmin3-1.6.3/src/dlg/dlgTable.cpp　あたりでしょうか？ 地道にテーブルやカラム、制約などの情報をそれぞれ取得してきて、プログラムで、CREATE文を整形していますね。
「PostgreSQL」はわからないのですが 「SQL Server 2000」　には DTS　が入っています。 DTSパッケージツールをODBC 経由で操作を行えば「PostgreSQL」 と「SQL Server 2000」はさまざまな操作が可能になると思います。 「SQL Server 2005」では 同様にSSISがあります。 DTSパッケージツールを検討してみてはいかがですか？ 　
#1回答者です。 別名を条件式に指定したい場合は、「インラインビューで参照する形にする」といった方法があります。 select * from (select name,birthday,extract(year from age(current_timestamp,birthday)) as genzai_age from t1) as x where genzai_age between 43 and 44
world99です。 chukenkenkouさんのSQL文の方が綺麗ですね。 そちらをご参考下さい。おかげさまで、私もいい勉強になりました。 ちなみに、私のサンプルにあったSQL文は以下のようになります。 SELECT t1.* FROM t_stock t1 WHERE t1.arrival_date IN( SELECT MAX(arrival_date) FROM t_stock WHERE (item_name like '%○%' OR item_name like '%×%' OR item_name like '%△%') AND sale_date >= '2007-05-01' AND sale_date <= '2007-05-05' ) AND (t1.item_name like '%○%' OR t1.item_name like '%×%' OR t1.item_name like '%△%') AND sale_date >= '2007-05-01' AND sale_date <= '2007-05-05'
失礼しました。 UNLOCK TABLES　は、MySQLでした。
まあ、SQLでやるならの例を示しましたが、No3さんの指摘どおり複数選択（prefecture[]）したSQLが複雑で、SQLが長くなる、1行じゃどうにもならない（prefecture[]の作り方によります。)等の弊害があるのであれば、prefectureした結果を配列に格納してそれを元に動的SQLを作成する方法は有ります。 ケースバイケースですね。
問題の丸投げはネチケット違反ですよ。 ソースコードをいきなり貼り付けられても困ります。 そもそも、何がどのように期待通り動いていないのか、 予想結果と実行結果の相違点はなんなのか教えてもらわないと、 解りません。 気になる点： + "<"td colspan = 2><font color=\"white\"出欠</font></td></tr>"; は + "<"td colspan = 2><font color=\"white\">出欠</font></td></tr>"; か？
>エラーがでてうまくいきません どういうエラーなのか、具体的にメッセージの内容を書きましょう。 havingで集合関数（集計関数）以外を指定する場合は、その列がgroup byで指定されていなければなりません。 havingでなく、whereで指定することを考えてみてください。 SELECT code,COUNT(code) AS cnt FROM test WHERE date(date) >= '30前の日付' GROUP BY code といった感じになりましが、当初のやりたかったことと合致していますか？
>$total_Timeに『10.00』という値が入っているとき >UPDATE work_time_tbl SET total_work = '.10.00.' WHERE id = '1'; >と表示されました。 上記の「'.10.00.'」は「'10.00'」の間違いでしょ？ syntaxエラーでupdate文がロールバックされたため 値が更新できてないだけです。
ANo.2の回答は間違ってました無視してください。 bbbの部署名と商品名がnull表示されているのを見落としていました。 select um.名前,case when hi is not null then b.部署名 else null end,s.商品名,hi from (select m.名前,m.部門,u.商品id,max(u.日付) as hi 　　　　from (売上 as u) right outer join (名簿 as m) on (u.名前 = s.名前 and s.商品id = '1'） 　　　　where m.部門 = '1' 　　　　group by m.名前,m.部門,u.商品id) as um 　　left outer join 商品表 as s on (um.商品id = s.商品id) 　　,部門表 as b where um.部門 = b.部門 ですかねぇ。 テスト環境が無いので実行していませんが、 サブクエリー（またはView)を使用することと、条件分岐の組込み関数を使えばよいかと。
nullを入れる方法を、間違っているだけでは？ >日付を入れない場合は、nullとすると、下記のエラーが出ます。 >Query failed: ERROR: invalid input syntax for type date: "" 具体的に、SQLはどのように記述しているのでしょうか？ >null以外に''も試しましたが、エラーになります。 そんなデタラメをやらずに、自分で調べてみては？ nullを入れるには、 「insert into t1(c1,c2,c3) values(1,'a',null)」 と明示的に格納値としてnullを指定する方法があります。 また、データ型の定義でnot nullにしていないなら、 「insert into t1(c1,c2) values(1,'a')」 と値を明示指定しないで、省略時解釈値として格納する方法などがあります。
#1回答者です。 提示された表定義、データを使って実機確認したところ、私の環境では問題なく検索できました。 PostgreSQL 8.0.0（Windows版）で、pgAdminIIIから操作しています。 ＝＝＝表定義＝＝＝ create table t_nyusatsu (fno bigint not null, id character varying(18) not null); ＝＝＝格納データ＝＝＝ insert into t_nyusatsu values(43,'000000000000216871'); insert into t_nyusatsu values(44,'000000000000216871'); insert into t_nyusatsu values(43,'000000000000999999'); ＝＝＝確認した検索SQL＝＝＝ select * from t_nyusatsu where (fno, id) in ((43, '000000000000216871')); select * from t_nyusatsu where (fno, id) in ((43, '000000000000216871'),(44, '000000000000216871'));
環境変数 CLASSPATH を指定していても、実行時やコンパイル時に -classpath を指定してしまえば、そっちの設定が優先されるようになっていたように思います。 従って、環境変数を有効にしつつ -classpath を使用したいのであれば、 -classpath dir:$CLASSPATH のようにしてあげる必要があるのではないかと思います。 > どちらにすればよいのか、そして、どのようにbash_profile修正するの > かを教えてください。 好みの問題かもしれませんが、書くのであれば .bash_profile よりも .bashrc の方が良いかと。 > 参考書やネットを調べていますと、『rootにはインストールするな』と > いうのもあれば、『rootでインストールしろ』などとあり、情報が交錯 > しています。 PostgreSQL は root でなくてもインストールできるように設計されています。root でなくても使えるものを root でインストールする必要は全くありません。
私も詳しいわけではないのですが，回答がつかないようなので。 http://ossipedia.ipa.go.jp/capacity/EV0603300125 … OSDL DBT-1によるPostgreSQLのVACUUMに関する考察 は参考にならないでしょうか？ DBT-1の設定の詳細(item数やuser数)が不明なので，ご質問の条件に適合しているかどうかわからないのですが，itemテーブルのみだと数秒～数十秒，全テーブルだと数分～十数分のようです。 参考URL：http://ossipedia.ipa.go.jp/capacity/EV0603300125 …
http://www.postgresql.jp/PostgreSQL http://www.postgresql.org/
#1回答者です。 #1で提示したSQLが、「グループ内通番」のSQLになっていたので訂正します。 【SQL例】列c1でユニークになる場合 select (select count(*) from t1 where x.c1>=c1) as rn, c1,c2 from t1 as x order by rn
> 拡張子が.gzとなっているのですがこのままアップロードしていいの > でしょうか？ tar & gzip で複数ファイルがアーカイブされ圧縮されています。アップロードの前に伸張処理が必要でしょう。 gzファイルの伸張に関しては、参考URLを見てください。 サーバ上でtar、gunzip, gzip コマンドが使えるなら、サーバで伸張処理もありです。 参考URL：http://www.csdinc.co.jp/archiver/lib/extents.html
(1)maxキー取得及び+1して格納を、トランザクションの一番最後で行うなど、DBの排他区間を最短になるようにする。 (2)重複エラー時のリトライ処理を作りこむ などは、必須になります。
マニュアルで確認したり、ちょっとやってみればすぐに分かることを何件か質問しているようですが？ 質問中のcase式の構文は目茶苦茶ですが、条件をandやorで結合することはできます。 参考URL：http://www.postgresql.jp/document/pg823doc/html/ …
>MySQLは現在Ver5ですが、８バイトのような型は無いみたいです MySQLにもBIGINTやDOUBLE PRECISIONなど、8バイトで数値を表現するデータ型は存在しますけど？ 参考URL：http://dev.mysql.com/doc/refman/4.1/ja/storage-r …
文字連結です。
initdb を実行する時に -E EUC_JP を指定すればいいでしょう。 あるいは、インストール時に .configure のときに指定してもいいです。
マニュアルで確認したり、ちょっとやってみればすぐに分かることを何件か質問しているようですが？ PostgreSQLでは、case式中にcase式を書けるようです。ただし、質問文中のcase式は対応するendがないし、構文エラーになると思いますけど。 参考URL：http://www.postgresql.jp/document/pg823doc/html/ …
この手の処理は普通は seqence を使うと思います。sequence はロックしなくても同じ値は絶対に取得されることが無いことが保証されています。ロールバックが発生した場合に、値が欠番になってしまうことがあるのですが、これはしかたがないでしょう。
RDBMSはPostgreSQLでいいのですか？ select * from t1 where 単価 between 1000 and 1200 and char_length(商品名)>=5
#1のお礼をみての追加です。携帯なら、UTF8はやめておいた方がいいですよ。理由はPostgreSQLでUTF8では外字がうまくあつかえないからです。たとえばドコモの絵文字がだめです。
マニュアルに「前方一致（'abc%'等）でないと、インデクスは使用しない」と明記されています。 参考URL：http://www.postgresql.jp/document/pg823doc/html/ …
>まず、最初に表示されるエラーですが、 >ERROR: syntax error at or near "部署コード" at character 26 >です。 >実行している文は、 >DELETE from 学生テーブル WHERE 所属コード IN (1001,1002) >になります。 実行している文は「所属コード」で、エラーには「部署コード」となってます。 実行文とエラーはコピペで、間違いないですか？？エラーコードとして ありえないはずなので。。。 あと、××とか○○とかだと、そこの中にエラーの原因あったときにどうにも しようがないので、隠さず全部書いてほしいです。（見たところそれほど機密情報の類ではないので）
PostgreSQLは、オープンソースのデータベースです。 システム開発、運用に携わらないのであれば、知識として不要です。 また、適切なファイヤーウォール設定が成されていれば、そのようなアクセスは、気にする必要もありません。 問題は、ルータからPCに5432ポートでアクセスがある事ですね。 外部から5432ポートにアクセスされても、ルータでブロックしておけば、 何の問題もないのですが、それをPCに通しているとなると、 ファイヤーウォールの役目を果たせていない格好になります。 いわゆるセキュリティホールです。 よって、ファイヤーウォールの設定に不備がある可能性が高いです。 ファイヤーウォールの設定の中で変更した個所（特にDMZ設定など）を見直して下さい。 攻撃者は、サーバがあるとかないとか関係なく無作為に攻撃してきます。 不要なポートは全て閉じておくのが基本です。 参考URL：http://e-words.jp/w/PostgreSQL.html
下の方が示されたページで勉強してもなんとかなると思いますが、 これから先もPostgreSQL関係の作業があるのなら参考書を買ったほうがいいと思います。 参考までに自分が購入した本を紹介しておきますね。 PostgreSQL徹底入門～8対応～ http://www.seshop.com/detail.asp?pid=6143 *老婆心ですが、質問のタイトルには具体的な例を記入されたほうがよろしいかと。
#1回答者です。 Windows版のPostgreSQLに関して、インストール手順等がまとめられた記事がありましたので紹介しておきます。 参考URL：http://allabout.co.jp/internet/database/closeup/ …
PostgreSQL8.1.5文書の中の PostgreSQL8.0 のリリースノートによると、 http://www.postgresql.jp/document/pg815doc/html/ … ＜文中抜粋＞ サーバ設定パラメータlog_pid、log_timestamp、log_source_portが、 より柔軟なlog_line_prefixに置き換えられました。 とありますので、たぶん「log_timestamp = true」の問題だと思います。 ここだけコメントアウトして起動確認をしてみる。 あるいは、log_line_prefix を使用する。 で解決できると思います。 いかがでしょう。 参考URL：http://www.postgresql.jp/document/pg815doc/html/ …
select case when 時間テーブル.makeday + '1 weeks' < now() then 0 else 1 end; でいいと思います。 答えが論理値 t か f でいいならもっと簡単です。 select 時間テーブル.makeday + '1 weeks' >= now()；
ご期待の回答ではありません。 バキュームかけて止まった経験は無いのですが、 経験上、vacuumdb　実行してもゴミがどこまで無くなっているのか疑問です。 処理速度の問題でvacuumdbを掛けるのであれば、 pg_dump　でバックアップとり、dropdb → createdb →　pgsql -e　で作り直すと早くなりますよ。
「マスコットのロゴについて」のページがありました。下記をご覧下さい。 詳細は、右上端にある連絡フォームから問い合わせるのが良いでしょう。 参考URL：http://www.postgresql.jp/npo/logo
currvalで取得出来ます。
＞その記述方法をご教授ください。 $ man dos2unix $man nkf
pg_fetch_arrayは使っていませんが、汎用性があるスクリプトですので、よろしければお試し下さい。 //DB接続（$cnDB）は、省略 $strSQL = "SELECT * FROM hoge"; $rs = pg_query($cnDB, $strSQL); $intFNum = pg_num_fields($rs); $intRNum = pg_num_rows($rs); print ("<TABLE border=1>"); if ($intFNum > 0) { print ("<TR>\n"); for ($i=0; $i<$intFNum; $i++) { print ("<TH>".pg_field_name($rs, $i)."</TH>\n"); } print ("</TR>\n"); } if ($intRNum > 0) { for ($j=0; $j<$intRNum; $j++) { print ("<TR>\n"); for ($i=0; $i<$intFNum; $i++) { print ("<TD>".pg_fetch_result($rs, $j, $i)."</TD>\n"); } print ("</TR>\n"); } } print ("</TABLE>");
PostgreSQL8から、ロールという概念が追加されたのですが、その実はユーザの追加と同じです。 ですから、 Shall the new role be a superuser? (y/n) については、「追加するロール(ユーザ)をpostgres同等にするか？」 ということで、 Shall the new role be allowed to create databases? (y/n) Shall the new role be allowed to create more new roles? (y/n) については、それぞれ、 「あたらしいDBを作る権限を与えるか？」 「新しいロール(ユーザ)を作る権限を与えるか？」 ということです。 ロールという言葉を気にしないでも良いようです。
#1回答者です。 失礼しました。ソース配布版パッケージには、関数として提供されているのですね。 参考URL：http://www.thinkit.co.jp/free/marugoto/2/1/23/1. …
dateフォルダにあるpostgresql.confのclient_encodingの値を変更しておけばいいのではないでしょうか。
マニュアルを読みましょう。 SELECTの背景では、SELECTしか動作させられません。 現在のところ、ON SELECTルールでは1つのアクションしか許されず、それはINSTEADである無条件のSELECTアクションでなければいけません。この制約は、一般のユーザが何をしても、ルールシステムが堅牢であるために必要であり、ON SELECTのルールはビュー同様の動作に限定されます。 参考URL：http://www.postgresql.jp/document/pg821doc/html/ …
データベースがPostgreSQLであれば、参考ＵＲＬにあるconnectbyを 使えば、階層構造をSQL文を１本で取得可能だと思います。 ただし、connectbyは標準では使用できないようなので、 ファンクションの登録が必要なようです。 詳しくは参考ＵＲＬを見てください。 参考URL：http://www.thinkit.co.jp/cert/marugoto/2/1/23/2. …
既にダンプファイルが渡されており（しかも、それしかない） そのままでは取り込むことができないのであれば・・・ まず、SQLServer に空のデータベースを１つ作成します。 ダンプファイルから手作業で以下２つのファイルを用意します。 １．create table, create index 文だけを残して、 　　他の構文を全て削除したファイル 　　（create table だけでも良い） ２．copy文だけを残して、他を全て削除したファイル 　　そのファイルを加工してcsv等、データファイルを作成する。 まず１を利用して、テーブルを復旧し、 次に２を利用して、テーブルデータを復旧できます。 最後に、元のダンプファイルを見ながらその他必要なものを復旧します。 ちょっと時間が掛かりそうですが・・・
存在しないものは、作り出すか、結合するしかありません。 問い合わせ中で作り出すのは、無駄なコストが掛かるだけなので、カレンダー表を作り、結合するのがシンプルだと考えます。
Windows版は使ったことがないので、推測ですが >$con = pg_connect("user='postgres' dbname='test_db' password='grjtf'"); ではなく $con = pg_connect("user=postgres dbname=test_db password=grjtf"); では？ 参考URL：http://jp2.php.net/manual/ja/function.pg-connect …
>ODBCが必要ということでWindowsXP側には入れたのですが、 ↑このドライバーはpostgreSQL用ODBCドライバーでしょうか？（念のため） postgreSQL用ODBCドライバーはpostgreSQL側にインストールする必要はありません。このドライバーをAccess側（windowsXP）にインストールして使うことになる。もちろん、AccessからpostgreSQLにつながるには設定が必要です。 Accessのメニューー＞ファイルー＞テーブルのリンクをクッリクすると、ダイアログが表示される。そこでデーターベース種類をODBCに指定する。次にODBC設定（選択画面）が表示されるので、postgreSQLのホスト情報やデーターベース名前、ユーザ名、パスワードをいれる。
テーブル設計を経験すると分かると思いますが、プライマリキー以外で条件検索、結合、ソートやグループ化という検索が必要になることが少なくありません。 そういう場合に、CREATE INDEXでプライマリキー以外のインデクスを定義します。 また、プライマリキー以外で重複を禁止したいカラムがある場合も、CREATE INDEXでUNIQUEを指定して制約を設けます。 インデクスを無闇に定義すると、更新等でオーバヘッドになります。また、母体データ件数、データ値の種類（個数）なども、インデクスを付けるべきか否かを判断する上で考慮する必要があります。
処理概要の件は了解しました。 /*** MySQL テーブル定義 ***/ １．個人+地域情報関連付けテーブルは不要と思います。 ２．個人情報テーブルのレイアウト変更 →個人ID ---(主キー) →個人名 →地域ID ３．地域情報テーブルのレイアウト現状のまま →地域ID ---(主キー) →地域名 /*** PHP コーディング ***/ １．地域情報テーブル を全件読み込む。 SELECT * FROM 地域情報; ２．地域と関連付けされていない個人情報テーブルを全件読み込む。 SELECT * FROM 個人情報 WHERE 地域ID = ''; ３．選択された地域をチェックされている個人分関連付ける。 UPDATE 個人情報 SET 地域ID = 選択された地域ID WHERE 個人ID IN ('...','...');
何を使って書こうとしていますか？ 普通に考えれば画面上で未入力の項目をチェックして、入力された項目だけが検索対象になるようにSQL文を作成しますが？
すいません、補足です。 UPDATE hoge1 SET name = (select b.name from hoge2 b , hoge1 a where b.id = a.id ) ; の何が悪いか、という点ですが、 副問い合わせの中で「hoge1 (AS) a 」としてるのに、最初にupdate hoge1 としてるのが アウトとなるようです。ただこの場合、AS句のスコープも関係してきますので、 こういう場合は素直にテーブル名を書いたほうがよいです。 http://osb.sra.co.jp/PostgreSQL/Manual/PostgreSQ … 辺りがヒントです。
TO_CHARで変換するかそのまま2006-12-14 09:00:28.853324+09で取り出してからPHPの正規表現で・・・というのでいいでしょう。 まあTO_CHARの方が手っ取り早いでしょうね。 SELECT TO_CHAR(hugehuge,'MM月DD日HH24時MI分') from hogehoge
システムカタログのpg_class表を検索することで、知ることができるようです。 (1)pg_class表を検索して、容量を知る例 http://www.postgresql.jp/document/pg820doc/html/ … (2)pg_class表の列構成 http://www.postgresql.jp/document/pg820doc/html/ …
例えば「09:00～翌日08:59までを一日として扱いたい」といったニーズはあるようですが、マニュアルを眺めた範囲では、そういう機能はない感じですね。 何時までを前日として扱いたいのですか？ 「2006-12-1 26:00:00」と「2006-12-2 02:00:00」は、「同時に存在しない」または「同じ日時として扱う」という制御はできるのですか？
「値 AS 名前」は、クライアントソフトに名前を返したり、表示したり、SQLで操作するために指定しています。 値にNULL定数を指定することも、値や演算に名前を付けることも、SQLの基本機能です。 この場合は、UNIONしている二つの表のうち、最初の表には列「RES_NO」に該当する値がないので、NULLを入れているのでしょう。 UNIONする表は、列数やデータ型が一致している必要がありますからね。
すごく目茶苦茶な状態にしてしまっているような・・・。 すぐに回答できるところだけ、回答しておきます。 「libpq.dll」は、どこかからダウンロードしたものを使用していますか？ CSEはここ何年も開発が停止されているので、古い「libpq.dll」を使用する必要があるようです。更新日時は、「1999/06/29 ～」のようであり、これをCSEをインストールしたフォルダに入れてください。c:\windows\system32の方は、触らないでください。 更新する必要があるconfファイルは、「pg_hba.conf」だけです。「postgresql.conf」は触らないでください。 「pg_hba.conf」を、メモ帳などのテキストエディタで開くと分かりやすいと思います。
pg_dumpall > outfile　　とするだけです。 何をダンプするかについては、引数で調整することができます。 http://www.postgresql.jp/document/pg810doc/html/ … こちらを一読することをお薦めします。 参考URL：http://www.postgresql.jp/document/pg810doc/html/ …
PostgreSQLを組み込んだ製品を販売・サポートしてますが、 VACUUMをまめに実行しても、ディスク使用量は増大しますね。 どの程度のタイミングで実行すべきかはケースバイケースだと思います。 ユーザに「ファイルシステムの空き容量を見て、適宜実行してください」と言ってます。ユーザ自身で実行基準を作ってます。
koumoku3にナル値が入っている場合は、(1)+(2)=(3)とはなりません。 ナル値が入っている行数をxとすると、(1)+(2)+x=(3)になります。
select round(0.2*number) from sample where id=1 とすればいいだけでは？
#1、#2回答者です。 #2の回答は質問内容と合っていませんでした。 無視してください。
今ちょっと時間がなくて申し訳ないのですが、 ポイントインタイムリカバリ（PITR）で対応可能と思われます。 参考ＵＲＬを掲載しておきますので、よかったらどうぞ。 PostgreSQLのバージョンによっては対応していませんのでご注意ください。 参考URL：http://www.postgresql.jp/document/pg813doc/html/ …
「情報スキーマ」を活用してください。 「columns」表で各表の列情報が分かるので、目的のデータベースやスキーマ毎に行数を求めれば、それが列数になります。 【検索SQL例】 select table_catalog,table_schema,table_name,count(*) from information_schema.columns where table_schema='public' group by table_catalog,table_schema,table_name 参考URL：http://www.postgresql.jp/document/pg815doc/html/ …
「"」（ダブルクォーテーション）も文字数に換算されているので、 「"1234567890"」は１２文字のデータをINSERTしようとしてエラーになっているのだと思います。 また、２カラム目はINTEGERとのことなので、そもそもクォーテーションやダブルクォーテーションで囲ったらよくないです。＾＾ ダブルクォーテーションを外して試してみてください。
>別端末からssh接続で操作することが可能でした これはUnixドメインソケットにあたるので、 tcpip_socket = false でも接続できます。 >これは最新のモジュールをダウンロードし．．． FedoraCoreは使ったことありませんが。。 接続先のサーバの更新がしっかりしているのでしたら、 最新版と思っても良いと思います。 ではー
incho0922さんのSQLに補足しいますと、 DELETE FROM A_TABLE AS A_TABLE_1 WHERE ID = ( SELECT ID FROM A_TABLE AS A_TABLE_2 ORDER BY mDate LIMIT 30 ) だと、副問い合わせの文では複数行返してしまいますので"="だとエラーになってしまいます。 ですので、 DELETE FROM A_TABLE AS A_TABLE_1 WHERE ID IN ( SELECT ID FROM A_TABLE AS A_TABLE_2 ORDER BY mDate LIMIT 30 ) ならご希望の結果が得られると思います。
＞考えられる原因を教えてください。 ＞マカフィインターネットセキュリティ 現状与えられた情報ではこれ以外に無いと思います。
数十万件だと毎回実行するにはなかなか厳しい感じですね。 状況から察するに, name にインデックスを張ってもあまり有効に働かないみたいですね。 アプリケーションを考慮して, name と versionの最大値 の組み合わせの抽出が頻繁に行われるようでしたら, name と versionの最大値の二つの列を持つ参照用のテーブルを作成して, そこから参照するようにしてはどうでしょうか。 software_table に INSERT/UPDATE/DELETE が発生したら, 上記のテーブルをトリガを利用して書き換えればよいと思います。 # もちろんプログラム側で対応しても構いません name と versionの最大値の組み合わせの参照がそれほど発生せず, アプリケーション的にも多少時間がかかるのが許されるならば, 副問い合わせやソートのやり方でもよいと思いますよ。
配列の要素を操作する関数が限られている以上, 配列の要素を全部サーチする以外に方法はないかと思います。 配列要素がそれなりに大きくなると負荷もあがりそうですし, 関数やプロシージャはデバッグが大変です ^^; DB側ではなくフロント側で配列を操作するか, 配列データを正規化して別テーブルに分けるかにしたほうがいいかもしれません。
CGI側を変更すればよいのではないでしょうか。 Jcode.pm等のモジュールを使用するのがよいかと思います。
最終的に PHP から PostgreSQL に接続したい, ということでしょうか。 yum で PHP をインストールしたとのことですが, 取りあえず下記2点を確認してみて下さい。 ・phpinfo() を実行して pgsql の項目が表示されるかどうか ・（表示されていなければ）PHP の PostgreSQLモジュールはインストールされているか % rpm -qa pgsql で, php-pgsql がインストール済みか確認してみて下さい。 # PHP の PostgreSQLモジュールは, php-pgsql という名前だと思います
まずは localhost のポート13000 が開いているかどうかを確認してみて下さい。 DOSプロンプトで netstat コマンドを使用すれば確認できます。 > netstat -a tcp 0 0 *:13000 *:* LISTEN
PostgreSQLにそんなに詳しい訳ではないですが、マニュアルに以下のような記述がありますけど？ ＝＝＝＝＝マニュアル引用（ここから）＝＝＝＝＝ 5.7. スキーマ PostgreSQLデータベースクラスタには、複数の名前付きデータベースが含まれます。ユーザおよびユーザのグループはクラスタ全体で共有されますが、他のデータは複数のデータベース間で共有されません。サーバに接続しているクライアントは、単一のデータベース、つまり接続要求で指定したデータベース内のデータにしかアクセスできません。 ＝＝＝＝＝マニュアル引用（ここまで）＝＝＝＝＝ 参考URL：http://www.postgresql.jp/document/pg814doc/html/ …
なさりたい事とズレているかもしれませんが、 PostgreSQLのようなRDBに入れるからには、 まずきちんと正規化された形にして入れる かと思います。 （通常、300もフィールドがあるのは、正規化 されていないと思われます。） CSVをそのままの形で突っ込むのではなく、 No,Data1,Data2,....Data300 というデータであれば、 line_no|data_no|in_data -----+-----+------- 　　　1|　　　1| aaaaa 　　　1|　　　2| bbbbb 　　　1|　　　3| ccccc 　　　1|　　　4| ddddd 　　　1|　　　5| xxxxx : <略> : 　　　1|　　299| yyyyy 　　　1|　　300| zzzzz 　　　2|　　　1| abc111 　　　2|　　　2| def222 　　　2|　　　3| abc111 : というような形に変換してから入れると思います。 CSVをExcel等で編集してこの形にしてから突っ込むか、 プログラムでCSVから一行ずつ読んで、 改行とカンマ区切りごとにループをネストして INSERTするようなプログラムをコマンドラインの JavaなりPHPなりで書けばよいかと思います。
容量がいっぱいにならなければ、 大丈夫のはずです。
>もし担当者コード222のEndTimeが入ってない場合 >（その担当者が引き続き運用中の為、終了時刻が入っ>ていない）も同様にID2の担当者コードには222と入れ>たいのですが方法はありますでしょうか。 終了時刻の入れ方にも、いろいろ方法がありますよね。 例えば、nullとする方法もありますが、この方法では、範囲や大小比較で「終了であること」を判別する仕組みが必要になります。 もっと簡単な方法が、最大値を入れる方法です。 例えば、「9999-12-31 23:59:59」をdefault値として設定したり、あるいは格納するようにしておけば、検索などの操作時のSQLは非常に単純にできます。 最初に最大値を入れておき、終了日時が確定した段階で、実際の終了日時で更新すればいいのです。
起動時の最初のプロセスIDでしょう。 二重起動防止のためのファイルではないでしょうか。 postmaster.pidのファイルの中身のプロセスIDが起動していませんか？
Oracle　Generic　Connectivityという製品を使えば Oracleから、PostgreSQLのODBCドライバーを介してPostgreSQLに対して、SELECT,INSERT,UPDATE,DELETEなどのSQL文を発行することは可能です。
pg_dumpallはユーティリティ(コマンド)なので、OSプロンプト(コマンドプロンプト)から実行します。
PostgreSQL8.1からは自動VACUUMという機能が 入っているようです。 ちなみに、VACUUM実行中でもデータの更新作業が できるようになったのは7.2のバージョンからです。 ただし、この場合のVACUUMはデータベースの領域自体は 解放しないので、データベースのファイルサイズは 小さくなりません。 領域を小さくしたい場合は-fオプションを付けて、 データベースをロックしたVACUUMを実行する必要が あります。 7.1以前のVACUUMは常に、-fオプションを付けた動きに なっています。
UTF-8ではなくUNICODEでどうですか？ あと、結果を得るわけではないので、prepare→execute→finishではなくdoでもいいでしょう。 $dbh->do("SET NAMES 'UNICODE'");
ご希望に合うかどうか分かりませんが４つほど 思いつきました。 １．Slony-I ２．SRAが提供しているCLUSTERPRO for Windows 　　（共有ディスク方式） ３．NECのftサーバ ４．単純な二重化機能を自分で作る。 ３はハードウェアで実現する２重化なのでご希望とは 合わないかもしれませんが。 自分もLinuxですが、２重化システムを構築していて、 予算の関係で４となりました。
列「タイプ」の数値の種類は、固定ということでいいのですね？ もしそうであれば、副問い合わせを使うまでもなく、実現可能です。 ＜検索SQL例＞ select 日付, coalesce(sum(case when タイプ=1 then 個数 end),0) as タイプ1個数, coalesce(sum(case when タイプ=2 then 個数 end),0) as タイプ2個数, coalesce(sum(case when タイプ=3 then 個数 end),0) as タイプ3個数, count(*) as レコード数 from t1 group by 日付 order by 日付;
pg_dump のオプションで D　をつけて、カラム名指定インサート文でダンプするのが確実ですので、これでいかがかと。 ただし、この方法は時間はかかります。（また、バージョンが違うのでiオプションをつけたほうがよいかもです。） 例： ダンプするファイルが　dumpfile.sql、 データベース名が、mydbname だった場合、 # su - postgres $ pg_dump -F p -D -v -i -f dumpfile.sql mydbname とか。
テーブル構造および型は問題なくて、 psqlコマンドで実行してちゃんと１が返ってくるようであれば、 次はVB.NETプログラミングの問題かと思ってしまいます。 SQL周りだけでも良いので掲載して頂きたいと思います。
平均点は、静的に持つのですか？ こんな感じで、目的の結果は得られると思います。 select t."class",t."name",t."average" from (select x."class",x."name",x."average",count(*) as num from oshiete_goo as x,oshiete_goo as y where x."class"=y."class" and x."average"<=y."average" group by x."class",x."average",x."name" ) as t where t.num<=3 order by t."class",t.num ;
jdbcだけの問題だけでないかもしれませんが、 少なくとも、jdbcが見えてません。 Windowsだったら、 jdbc の .jar ファイルを、実行したいclassファイルHoge.class(仮名)と同じフォルダに入れて、 >java -cp .\ Hoge のように実行すればよしと思います。 classpathは、javaの基本なので、参考書を買うなりして勉強したほうが良いと思います。
LIKE を ILIKE にすれば大小同一視されます。
select A || '-' || B ans , C from テーブル でしょうか。
#1、#4回答者です。 #4回答について、補足説明をしておきます。 (1)select into～ 　標準SQLとは、構文が異なっています。 　→intoの位置が違う。 (2)select into～でのfor update指定 　更新前提であることを示し、多トランザクションからの同時使用を抑止 (3)updateでエラーの場合 　関数が例外発生でエラーとなるので、関数内ではチェックしていません。 (4)例示の関数を、「プライマリキー更新（入れ替え）」の方式で流用する場合 update列を単純にプライマリキー更新（例示のケースではc1列）に変えると、二つ目のupdateで重複エラーになります。 従来通り、一旦、存在し得ない値に更新してください。 →入れ替える両方の値を、存在し得ない値に更新する必要はありません。 どちらか一方を、存在し得ない値に一時的に更新してください。 例示すると、下記のようになります。 create or replace function functest1(x1 int,x2 int) returns int as $$ -- ------------------------ -- 二つの行の値の入れ替え（キー更新） -- ------------------------ declare begin update t1 set c1=-x1 where c1=x1; update t1 set c1=x1 where c1=x2; update t1 set c1=x2 where c1=-x1; return 0; end; $$ language 'plpgsql' ;
>rdate timestamp default 'now' この文の意味としては、rdateというtimustamp型（日時を表す）の列に、insert時に値を設定しなかった場合、システムから現在日時を受け取って格納するという意味です。 >MySQLの場合、どのような属性が適切なのかをお教えいただければ データ型のtimestampは、PostgreSQL、MySQLの双方に存在し、日時を表す点では等価と考えて問題ないでしょう。 →実際にはPostgreSQLの方が、timestamp型でもいくつかの表現形式を持っているという違いがあります。 default 'now'というのは、PostgreSQLの独特の記述で、一般的な表記方法としてdefault current_timestampという表記がPostgreSQLでも等価の意味で行えます。この表記方法は、MySQLでも同じです。 →PostgreSQL 8.0.0では、default 'now'と記述すると、最初のinsert時に受け取った現在日時がその後も繰り返し受け渡しされ、これはバグだと思われます。current_timestamp指定では、insert毎に最新の日時が仕様通り返されます。 PostgreSQLでも一般的なSQLの書き方にすれば、今回のケースでは、MySQLでもそのままの文で表定義を行えます。 CREATE TABLE session ( sid varchar(32) primary key, uid varchar(16) not null, password varchar(16), rawdata varchar(512), rdate timestamp default current_timestamp );
アンインストールしたときに、 C:\program files にあるpostgresqlのインストールフォルダの確認はしましたか？ もし、インストールしたときに、そこにフォルダがある場合、前のものが入っている可能性があります。 その場合は、postgresqlのフォルダごと削除してみてください。
ninoといいます あまりお役には立てませんが、 postgresql　のメーリングリストで質問された方が、良い回答が得られるのではないかと思います。 gostgresql　や　pgAdminIII　の開発に参加しておられる方もおられます。 技術的な解決方法を提示していただけるかも。 私なりの解決方法としては、 １　pgAdminIII　が使用するpg_dumpを現状のPostgesqlのバージョンのものに入れ替える （　pgAdminIII　をwindows環境で使用されている場合は、この対応はできません。　win対応版は　8.0以上です） ２　pg_dump のソースを改造して、check_function_bodies = 'false'　を　コメント文にする。 これもwin環境では、コンパイルの環境を構築する必要があると思うので、結構難易度が高い気がします。 Linux等の環境でソースから導入されいる場合は、その場所さえ特定できれば、win環境に比べれば比較的容易かも知れません。 残念ながら、私はこの技量を持ち合わせておりません。 やはり postgresql.jp　のメーリングリストに参加して投稿するのが近道のような気がします。 あとはどうでもいいことですが 私もpgAdminIIIを愛用しておりますが、バックアップには使用しておりません。 直接sshでサーバに接続して、pg_dump　コマンドを操作しております。このほうが使いやすいですね（私にとってはですが） 参考URL：http://www.postgresql.jp/
UPDATE employee SET age = 37, where name = '内海' ではなく、 UPDATE employee SET age = 37 where name = '内海' では？ SET句の後のカンマは更新したい列を追記したい場合に記述します。 例えば、 UPDATE employee SET age = 37, name = 'ほげ' where name = '内海' といった具合です。
関連付けを考えて順番に削除する必要がありますので、＃２の方法ではダメです。
#2回答者です。 「FETCH ALL IN カーソル名」の使い方がよく分からなかったので、代替案としてPL/pgSQLを使用する方法を考えてみました。 (1)関数の定義 recという行データ受け取り変数を使い、受け取った特定列の参照は、「変数名.列名」で行えます。 create function functest1() returns int as ' declare car cursor for select * from t1; rec record; begin open car; loop fetch car into rec; if not found then exit; end if; update t2 set c2=0 where c3=(select c3 from t3 where c1=rec.c1); end loop; close car; return 0; end; ' language 'plpgsql' ; (2)関数の実行 select functest1(); (3)関数を削除する場合 drop function functest1();
pgAdminIII HPには以下の記述があります。 Requirements PostgreSQL 7.4 or above (8.0 or above on Windows). 従って、無理では？ 参考URL：http://www.pgadmin.org/download/source.php
試しにSQLを作ってみました。 create table STAFF (ID smallint, 名前 varchar(10)); create table LABOR (ID smallint, 社員ID smallint, 年月日 date, 時間数 smallint, プロジェクトID smallint); insert into STAFF values(101,'川口'); insert into STAFF values(111,'宮本'); insert into STAFF values(123,'中田英'); insert into LABOR(社員ID,年月日,時間数) values(101,'2006-01-05',8); insert into LABOR(社員ID,年月日,時間数) values(101,'2006-02-01',10); insert into LABOR(社員ID,年月日,時間数) values(101,'2006-02-15',5); insert into LABOR(社員ID,年月日,時間数) values(101,'2006-03-01',8); insert into LABOR(社員ID,年月日,時間数) values(101,'2006-03-03',10); insert into LABOR(社員ID,年月日,時間数) values(101,'2006-03-10',12); insert into LABOR(社員ID,年月日,時間数) values(111,'2006-01-10',5); insert into LABOR(社員ID,年月日,時間数) values(111,'2006-01-15',10); insert into LABOR(社員ID,年月日,時間数) values(111,'2006-01-31',5); insert into LABOR(社員ID,年月日,時間数) values(111,'2006-02-10',8); insert into LABOR(社員ID,年月日,時間数) values(111,'2006-02-20',8); insert into LABOR(社員ID,年月日,時間数) values(111,'2006-03-20',10); insert into LABOR(社員ID,年月日,時間数) values(123,'2006-01-20',8); insert into LABOR(社員ID,年月日,時間数) values(123,'2006-01-21',8); insert into LABOR(社員ID,年月日,時間数) values(123,'2006-01-22',8); insert into LABOR(社員ID,年月日,時間数) values(123,'2006-03-03',5); insert into LABOR(社員ID,年月日,時間数) values(123,'2006-03-04',5); insert into LABOR(社員ID,年月日,時間数) values(123,'2006-03-05',5); select x.名前, coalesce(sum(case when date_part('month',年月日)=1 then 時間数 end),0) as １月, coalesce(sum(case when date_part('month',年月日)=2 then 時間数 end),0) as ２月, coalesce(sum(case when date_part('month',年月日)=3 then 時間数 end),0) as ３月, coalesce(sum(case when date_part('month',年月日) between 1 and 3 then 時間数 end),0) as 合計 from STAFF as x,LABOR as y where x.ID=y.社員ID group by x.名前 order by x.名前 ;
ActivePerlをお使いということですので、ppmでインストールできるとよいのでしょうけれど、 デフォルトのppmデータベースには該当するモジュールは登録されていないようです。 検索してみたところ、ちょっと前のバージョンですがActivePerlで動かした実績が見つかりました(参考URL参照)。 もしご自分でモジュールをコンパイルできる環境にあるのなら、 CPANからソースアーカイブを持ってきて、自分でコンパイル&インストール するのもよいかもしれません。対応していれば、 perl Makefile.pl make make install 程度のステップで済みます。 参考URL：http://chaichan.web.infoseek.co.jp/qanda/qa6515. …
PostgreSQLには、「SERIAL」というデータ型があり、これがMySQLのauto_incrementに相当します。 いくつかの商用RDBMSと同じように、CREATE SEQUENCEもサポートされています。 既存の表に列を追加する場合、SQLでなら 「ALTER TABLE 表名 ADD COLUMN 列名 SERIAL」 で行えます。 参考URL：http://www.postgresql.jp/document/pg814doc/html/ …
postgresql には直接関係ないですが iptables(ファイアウォール) が起動していれば、 tcpの指定port( 5440 ) を許可する必要があります。 設定されていますか？
PostgreSQLデータベースに使用できる日本語文字コードは 　EUC-JP 　UTF-8 だけです。 SJISを使いたい場合は クライアントエンコーディングにSJISを指定します。 21.2.3. サーバ・クライアント間の自動文字セット変換 http://www.postgresql.jp/document/pg814doc/html/ …
自信はないですが、やはりウイルス対策ソフトが原因の気もします。 最近、MacAfeeの入っているマシンでインスールはできたものの動かすとクラッシュ寸前になって使いものになりませんでした。 なんらかのエラーを見るために、 コマンドプロンプトで、msiのあるディレクトリに移動し、 > msiexec /package postgresql-8.1-ja.msi /log log.txt とやってわざとログを吐いてみるのも手かと思います。
こういった質問をするときには、環境を記入されることをお勧めします。 UNIX系なのかWindowsなのかで環境に依存する部分が変わりますので。 また、PostgreSQLのバージョンによっても変わります。 >旧マシンで、pg_dumpコマンドを使い、どこに保存すればよいのでしょうか？ お好きな場所にどうぞ。 >具体的な、データ移行の流れを教えていただけるとうれしいです。 参考URLがマニュアルになっていますので、そちらをご覧ください。 基本的には、 1．pg_dumpallでファイルにはき出す 2．1ではき出したファイルを新しいサーバに移す 3．2で移したファイルからリストアする という手順になります。 ファイルの保管場所は、それぞれができる場所（アクセス権限のある場所）ならどこでもかまいません。 ぶっちゃけ、環境（OSやPostgreSQLのバージョンなど）もわからないので、具体的な方法はアドバイスしかねます。 参考URLを含め、PostgreSQLのマニュアルにバックアップとリストアの方法が記載されていますので、まずはそちらをみることが最良かとおもいます。 参考URL：http://osb.sra.co.jp/PostgreSQL/Manual/PostgreSQ …
一定の順序で並べたければ、ORDER BYでソートする必要があります。 PostgreSQLは、何ら順序の保証をしていません。 ＝＝＝＝＝抜粋（ここから）＝＝＝＝＝ 7.5. 行のソート ある問い合わせが1つの出力テーブルを生成した後（選択リストの処理が完了した後）、並べ替えることができます。並べ替えが選ばれなかった場合、行は無規則な順序で返されます。そのような場合、実際の順序は、スキャンや結合計画の種類や、ディスク上に格納されている順序に依存します。しかし、当てにはなりません。特定の順序で出力することは、明白に並べ替える処理を選択することでのみ保証されます。 ORDER BY句は並べ替えの順番を指定します。 ＝＝＝＝＝抜粋（ここまで）＝＝＝＝＝ 参考URL：http://www.postgresql.jp/document/pg813doc/html/ …
単純にExcelへ取込むだけなら、PostgresqlのODBCドライバをインストールして、Excel上で外部データ取込みをすれば出来ると思います。詳しくは参考URLを確認してください(私も最初は参考しました)。 Excel上で読込み～更新まで行なうのでしたら、それなりにVBAで組まないといけないです。 参考URL：http://allabout.co.jp/internet/database/closeup/ …
select count(hoge) from tblA; というように「*ではなくどれかひとつのカラムをカウント」ではどうでしょうかね？ 試してないので分かりませんが。 INDEXされているカラムにすれば更に効果があるかもしれません。
#1回答者です。 #1回答後に気付きましたが、質問のタイトルで「副問い合わせ」とありますが、質問内容に副問い合わせのことが一つもありませんが？
VBAで作成した清音変換プログラムを載せて起きます。 ExcelなりAccessにご自分で展開して使用してください。 ' 清音処理 ' prstrKanaSimei : 入力したカナ氏名 ' 戻り値 : 清音化したカナ氏名 Public Function fncSeionConv(prstrKanaSimei As String) As String Dim lstrRet As String Dim lstrKanaSimei As String Dim lintLength As Integer Dim lintIdx As Integer lstrKanaSimei = prstrKanaSimei If lstrKanaSimei = "" Then lstrRet = "*" Else lstrKanaSimei = Replace(lstrKanaSimei, "ヂ", "シ") lstrKanaSimei = Replace(lstrKanaSimei, "ヅ", "ス") lstrKanaSimei = Replace(lstrKanaSimei, "ャ", "ヤ") lstrKanaSimei = Replace(lstrKanaSimei, "ュ", "ユ") lstrKanaSimei = Replace(lstrKanaSimei, "ョ", "ヨ") lstrKanaSimei = Replace(lstrKanaSimei, "゛", "") lstrKanaSimei = Replace(lstrKanaSimei, "゜", "") lintLength = Len(lstrKanaSimei) lstrRet = lstrKanaSimei For lintIdx = 2 To lintLength If Mid(lstrKanaSimei, lintIdx, 1) = "ウ" Then If Mid(lstrKanaSimei, lintIdx - 1, 1) = "オ" Or _ Mid(lstrKanaSimei, lintIdx - 1, 1) = "コ" Or _ Mid(lstrKanaSimei, lintIdx - 1, 1) = "ソ" Or _ Mid(lstrKanaSimei, lintIdx - 1, 1) = "ト" Or _ Mid(lstrKanaSimei, lintIdx - 1, 1) = "ノ" Or _ Mid(lstrKanaSimei, lintIdx - 1, 1) = "ホ" Or _ Mid(lstrKanaSimei, lintIdx - 1, 1) = "モ" Or _ Mid(lstrKanaSimei, lintIdx - 1, 1) = "ヨ" Or _ Mid(lstrKanaSimei, lintIdx - 1, 1) = "ロ" Then Mid(lstrRet, lintIdx, 1) = "オ" End If End If Next lintIdx End If fncSeionConv = lstrRet End Function
DBMSはAccessと違いプロセスを起動しなければいけません。 $/usr/local/pgsql/bin/postmaster -D /usr/local/pgsql/dataでDBプロセスを起動しています。
#1回答者です。 PostgreSQL 8.0を使用していますが、timestampの長さは8と表示されます。 CSEを試しにダウンロードして使ってみました(ver1.59）が、「テーブルレイアウトを確認」とは、どの操作のことでしょうか？ 「プロパティ」の「フィールド」タブでの表示なら、私の環境では、長さは8と表示されます。 CSEの表示で分かったのですが、CSEはPostgreSQLのシステムカタログ（http://www.postgresql.jp/document/pg746doc/html/ …）のpg_typeやpg_attributeを参照しています。 長さの所に、可変長の場合は負の値が入っていたりと、特殊な管理がされています。 >PostgreSQLは、ユーザ表内にシステム用のフィールドをたくさん作ります。 >これはどういう意味なのでしょうか。 上述のpg_type等を検索すると分かるのですが、PostgreSQLは、oidなどいくつかのシステム用のフィールドをユーザの表内部に作成するようです。 表の列構成（列のデータ型）は、どんな内容でしょうか？
まちがっていた場合はすみません。 ソースをコンパイルしてみてはいかがでしょうか？
定期的にdrop databaseをする運用が生じるシステムもどうかとは思いますが、それはさておき、ご質問のエラーがでる時には、postgresプロセスがidle状態で残っているというより、そのデータベースをアプリケーションが使用中(接続中)である可能性はないでしょうか。 Webアプリケーションなどでは、起動するだけでコネクションを張るものもあります。 もし、JSPなどであれば、Tomcatなどのサーブレットコンテナを、PHPならばApacheなどのWebサーバを、drop前後で停止・起動することによってPostgreSQLを停止せずとも、dropできると思います。
#1さんの意見に基本的に賛成です。 PostgreSQLだけでなく、一般的にもいえる部分ですが、バージョンが３桁表記の場合は、一番下の桁、３桁目については最新を追いかけた方がいいです。 ３桁ですと 　１桁目　→　大きな仕様変更を伴うバージョンアップ 　２桁目　→　仕様変更を伴うバージョンアップ 　３桁目　→　バグfixを目的としたバージョンアップ というカラーが一般的ですので、気にしないといけないのは１～２桁目のバージョンアップの部分です。１桁目が変わる場合、ある程度の互換性を持った別アプリになった感覚でいるくらいでもいいかもしれません。
copyの対象はテーブルだけです。 抽出したいのであれば、二段階になりますが 　1.作業用に別テーブルを作ってinsert～selectで抽出 　2.そのテーブルを対象にcopy という方法になると思います。 参考にinsertのマニュアルページを載せておきます。 参考URL：http://www.postgresql.jp/document/pg746doc/html/ …
#1回答者です。 PostgreSQLはデータ型が豊富なためか、システムカタログの参照方法が分かりにくいですね。 表中にシステム用の列も作っており、そのまま定義情報を検索すると、ユーザの定義列と一緒に情報を拾ってしまいます。 #1のSQLから、対応するデータ型の追加、「_bpchar」→「char」といった表示変更をするようにしました。 #1と併せて実行してもらえると、違いが分かりやすいと思います。 select relname as 表名, attname as 列名, attnum as 列番, case typname when '_bpchar' then 'char' when '_varchar' then 'varchar' when '_date' then 'date' when '_float8' then 'float8' when '_int4' then 'integer' when '_interval' then 'interval' when '_numeric' then 'numeric' when '_float4' then 'float4' when '_int2' then 'smallint' when '_text' then 'text' when '_time' then 'time' when '_timestamp' then 'timestamp' end as 型, case typname when '_bpchar' then atttypmod - 4 when '_varchar' then atttypmod - 4 when '_numeric' then (atttypmod - 4) / 65536 else attlen end as 長さ, case typname when '_numeric' then (atttypmod - 4) % 65536 else 0 end as 小数 from pg_stat_user_tables as a, pg_attribute as b, pg_type as c where schemaname='u1' and relname='t1' and a.relid=b.attrelid and b.attnum>0 and b.atttypid=c.typelem and substr(typname,1,1)='_' order by schemaname,relname,attnum;
多くのRDBMSでは、ディクショナリ（システムカタログ）をSQLで参照できるようにしており、SHOWといった特別なコマンドを利用させるMySQLが特殊なのです。 MySQLもバージョン5からか、英文マニュアルではカタログ情報が詳しく記載されています。 【SQL例】 select a.relname, b.attrelid, b.attname, b.attnum, b.atttypmod, b.attnotnull, b.atthasdef from pg_attribute as b, (select relid, relname from pg_stat_user_tables ) as a where a.relid = b.attrelid and b.attnum > 0 order by b.attrelid, b.attnum ; ●システムカタログ http://www.postgresql.jp/document/pg800doc/html/ … ●システムカタログの参照方法 http://www.pen-chan.jp/net/set/psql-catalog.html 参考URL：http://www.postgresql.jp/document/pg800doc/html/ …
\i file.sql を実行する前に \encoding EUC-JP を実行するといかがでしょうか？
3つのコマンドが登場していますが、 (1)createdb test (2)psql test (3)create database test; (1)、(2)とも、PosgreSQLの管理用コマンドでSQL文ではありません。 これらのコマンドの実体は、PostgreSQLをインストールしたディレクトリのbinフォルダの中にあります。 psql.exe createdb.exe という実行ファイルがあるのが確認できると思います。 これらのプログラムを (3)は、SQL文です。psql でデータベースに接続してから 実行するものです。 bouzu01さんが、(1)のコマンドを実行されたときは すでにpostgresユーザで、psql でデータベースpostgres に接続した状態なので、(SQL文ではないので)当然エラーが出ます。 「createdb test;ですんなりtestデータベースを作る」ためには、以下の方法で行ってください。 PostgreSQL8.1を、c:\Program Files\PostgreSQL\8.1に インストールしたならば、 (1)は、Windowsのコマンドプロンプトで、たとえば、 >"c:\Program Files\PostgreSQL\8.1\bin\createdb" -U postgres -E EUC_JP testdb と入力し、Enter、postgres ユーザのパスワード入力すれば、EUC_JPのtestdbというデータベースが作られます。 確認は、 >"c:\Program Files\PostgreSQL\8.1\bin\psql" -U postgres -l でデータベースの一覧が表示されます。
\cd '/Documents and Settings' または \cd 'c:/Documents and Settings' ＃最後に、';'は不要 と \!dir
列codeのデータ型が示されていませんが、char(4)と仮定します。 >codeの4桁目基本にグループわけ 一般的には、一番左側は「一桁目」と言うと思います。 (1)例１・・・ソートのために、codeの先頭１文字と２文字目から３文字を参照するx、yを作る select code,name, case substr(code,1,1) when '1' then 1 when '3' then 2 when '4' then 3 else 4 end as x, substr(code,2,3) as y from test order by x,y (2)例２・・・ソートのためのx、yを取り出さないようにするため、ビュー経由で操作 (a)ビューの定義 create view v_test as select code,name, case substr(code,1,1) when '1' then 1 when '3' then 2 when '4' then 3 else 4 end as x, substr(code,2,3) as y from test order by x,y (b)操作 select code,name from v_test
既に解決したと思いますが．．． SELECT usercd, Sum(CASE class WHEN 5 THEN point ELSE 0 END) AS class5, Sum(CASE class WHEN 11 THEN point ELSE 0 END) AS class11 FROM (SELECT * FROM table1 UNION ALL SELECT * FROM table2) as T1 GROUP BY usercd ORDER BY usercd; これでどうでしょうか？ 試してみたところご希望の結果が返ってきました。
さっき回答させてもらったものです。 PostgreSQLのユーザーのことだったんですね。 PostgreSQLをインストールしたときに自動的に作られてしまうので、手動で削除しなければいけません。 http://web.sfc.keio.ac.jp/~k12u/lecture/pgsql_wi … http://www.yc.musashi-tech.ac.jp/~yamada/doc/pgs …
私はこれで解決できたのですが、別の問題なのでしょうか。 あとはPostgreSQLのオプティマイザですね。 Alanizeオプションをつけてvacuumを実行してみてはどうでしょうか。 参考URL：http://www.postgresql.jp/document/pg732doc/refer …
エラーメッセージそのまんまですね。 集合関数を使う場合は、ほかのカラムは全てGroup Byに含まれてないといけませんよ。 Group Byに"userm"."nickname"を追加してください。 これでエラーはでなくなると思います。 ただ、それが正しい結果とは限りませんが・・。
今のハードスペックなら PostgreSQL で 100 万件を扱うことはたやすいことです。デフォルト設定のままでもそれなりの性能は出ます。ただし、＃１の方が指摘されているようにチューニングするに越したことはありません。 あと、データベースのチューニングというと、メモリ面だけに目がいきがちですが、テーブル設計や SQL、さらには CPU やディスク I/O にも注目する必要があります。 テーブル設計については、どういう構造にするかとか、どの列に索引を設定するのか、SQL についてはテーブル設計した成果をいかに引き出せるように記述できるか、CPU についてはソースコードからコンパイルする場合の最適化オプションをどう設定するか、ディスク I/O についてはディスクの回転数などが影響してきます。 これらについては、適材適所にボトルネックとなっている箇所を見つけ出して逐次チューニングしていく必要があります。 CPU のところの例で挙げたコンパイル時の最適化オプションについては、GCC の場合、最低でも CFLAGS="-O2 -mcpu=i686" を指定してください。
いっその事、VMWare Playerやqemuなどのエミュレータを使って、仮想Linux環境を作った上で開発してみては。 参考URL：http://www.atmarkit.co.jp/flinux/rensai/linuxtip …
>データベースの基礎知識は必要だと考えています 何故ですか? PHPをやるにしても 必ずしも必要ありません。 テキストベースで済むことの方が 多いです。 しかもPostgreSQLよりこの場合 MySQLが利用されることが多いです。
apacheのhttp.confファイルに AddType application/x-httpd-php .php を追加して、apacheを再起動して、 再度、チャレンジしてみてください。 AddType application/x-httpd-php .phpとは、 拡張子がphpの際、phpをじっこうするという意味です。詳しくは、apahceのマニュアルを見てください。
Java-PostgreSQLでしたら、 下記の方も回答しているように、ApacheとTomcatで良いと思います。 Apacheの最新版（2.2かな？）では、 Apache-Tomcatの連携に mod_jk も不要になっているというのを見た気もします。 次々新しいバージョンが出ていますので決して古くはないかと・・・ 逆に、Tomcatだけで起動しているWebサーバの方が私は不安です。
なにか、質問者さんの中でいろいろなものがごちゃごちゃになっている気がします。 検索エンジン（ロボット）は、表示されるHTMLをチェックしています。 なので、WEBで表示されるページがチェックされるので、PostgreSQLの使用の有無に関わらず、あくまでブラウザで表示される画面が、ということになります。 パスワード認証を通過しないとというのは、例えばBASIC認証とかでしょうか？ つまり、WEB上のパスワード認証でよろしいでしょうか？ その場合、検索ロボットはパスワードを知らないので、認証後に表示されるHTMLを取得できませんから、検索ロボットには表示されません。 googleなどの検索エンジンの巡回はHTMLを対象としている（CGIやPHPなどで構成されていても、HTMLとして吐き出されるのであれば、それはHTMLであるので、対象になります） PostgreSQLにテーブルがあっても、そのテーブルを取り込むにはPostgreSQL自体に接続しないと取り込めませんから、それだけでは検索ロボットにはひっかかりません
PostgreSQLならば、 update文のwhere句にselect文を入れれば 大概のことはできると思います。 select 文の結果が複数あれば、=ではなく、inを使うとかすればよいです。
内部結合で。 select A.id,A.name,A.comment, count(B.id) as cnt, max(B.date) as date, '0' as CK from A,B where B.id=A.id and not exists( select id from C where C.id=A.id ) group by A.id,A.name,A.comment UNION select A.id,A.name,A.comment, 0 as cnt, NULL as date, '0' as CK from A where not exists( select id from C where C.id=A.id ) and not exists( select id from B where B.id=A.id ) group by A.id,A.name,A.comment UNION select A.id,A.name,A.comment, count(B.id) as cnt, max(B.date) as date, '1' as CK from A,B,C where B.id=A.id and C.id=A.id group by A.id,A.name,A.comment UNION select A.id,A.name,A.comment, 0 as cnt, NULL as date, '1' as CK from A,C where C.id=A.id and not exists( select id from B where B.id=A.id ) group by A.id,A.name,A.comment order by CK,cnt;
> エンコーディングをEUC_JPにしています。 psqlはコマンドプロンプトから動かしているんでしょうが、WindowsのコマンドプロンプトはEUCを扱えません。 扱えるのはシフトJISです。（WindowsXPならUTF8も可） なのでPostgreSQLの方に既にEUCで日本語が入っているとしてSELECTするとコマンドプロンプト上には文字化けして表示されます。 > 入力切替方法が分かっていないだけかもしれませんが、半角/全角ボタン、カタカナひらながローマ字ボタンでも駄目でした。 ちなみにコマンドプロンプト（Windows上での）での日本語入力のONは「Alt」+「半角/全角」です。 まあこれでIMEをONにしたとしてINSERTで日本語を入れても、コマンドプロンプトはシフトJISで送るわけでPostgreSQLの方はEUCだと思ってそれを受け付けますので結局は文字化けします。 文字化けしないようにするには、クライアントの文字コードを指定してPostgreSQL側にそれに合わせて相互変換してもらいましょう。 SET NAMESを使って以下のように。 SET NAMES 'SJIS'; http://www.postgresql.jp/document/pg810doc/html/ …
PostgreSQLの独自仕様のようです。 '1'は数値でなく文字なのですが、数値との型変換を自動的に行ってくれるようです。 以下の操作を試して、定数の型を確認してみました。 (1)select 1→int4 (2)select 1.→numeric (3)select '1'→unknown (4)select '1'::int→int4 (5)select 1::dec→numeric (6)select 'A'→unknown '1'だけ入力した場合は、'A'と同じ、つまり文字として認識されています。 C1がdecで、「where C1=1」と指定した場合、内部的にはint→decの型変換が行われています。 この場合、型変換を行わせないためには、「where C1=1.」と指定する必要があります。 これと同様に、PostgreSQLでは、「where C1='1'」と指定した場合、文字→intの型変換が行われています。 型変換はオーバーヘッドになりますので、できるだけ列の型にあった定数を指定した方がいいというのが、どのDBMSにも共通の常識だと思います。 PostgreSQLでは、文字から数値への自動的な型変換も行ってくれるようですが、型変換のオーバヘッドがある上、見た目だけで判断すると、列のデータ型を勘違いすることになり兼ねないので、こういった使用は行わない方がいいと思います。
列「c1」に、'1月'～'12月'のデータが、varcharで入っているとします。 select c1 from t1 order by case length(c1) when 2 then '0'||c1 else c1 end
> 外付けHDDをNTFSフォーマットしてそこでPostgreSQLをインストールしたら PostgreSQLを外部のドライブにインストールするんですか？ 恐らく大丈夫でしょうが、その代わりにパソコン動作時は必ずその外付けHDDも付けて動かしておかなければ不都合が起こる可能性があります。 なにせPostgreSQLはWindowsのサービスとして動作させることになりますから、もしWindows動作中に外付けHDDを外したり、パソコン起動時に外付けHDDを付けていないと何が起こるかわかったものではありません。 （PostgreSQLに関わらず、外付けHDDにアプリケーションをインストールするのは御法度とはいいませんが非推奨です。デスクトップパソコンでずっと付けっぱなしならまだいいですが、ノート等で持ち運ぶようなマシンの場合はなおさら（以下略））
ついでに、DBに保存orディレクトリに保存は、私だったらDBに保存します。 セキュリティ的にはほぼ同等だと思いますが、バックアップの時、DBに保存しておけば、pg_dumpで全てバックアップ出来ますが、ディレクトリ保存であれば、そのディレクトリも保存しなければなりません。 使い勝手から言えば絶対にDBに保存した方がいいと思いますよ。
>どのようなテーブル構成にすればよろしいでしょうか？ テーブルの構成も何も、あなたが出している情報は、商品大分類、メーカー、値段だけですよ？ これで、何を回答して欲しいのでしょうか？ >テーブル数の見積もり、インデックスをどのように 張るか、またカラム構成もお願いします。 冗談ですか？
PostgreSQLのv7までのバージョンでは、DBサーバとしてwinodwsを標準的にはサポートしていません。 ただし、クライアントとしては、当時からサポートされています。 なので、古いライブラリを連れてきて動かせば良いかと思います。 http://www.interwiz.koganei.tokyo.jp/software/Po … システムディレクトリを置き換えてしまうと、他に影響があるので、お気をつけ下さい。
pg_dumpコマンドを、SQL文かつスキーマのみのダンプを取るオプションを指定し実行します。 具体的には、たとえば、DB名が"testdb"とすると、 [Linux版の場合] $ su - postgres $ pg_dump -f schema.sql -F p -v -s testdb [Windows版の場合] > cd "C:\Program Files\PostgreSQL\8.1\bin" > pg_dump -U postgres -f schema.sql -F p -v -s testdb で、schema.sql　というファイルがコンソールのカレントディレクトリに出来ます。
EUC-JPがいいです。 そのほうが後々トラブルになりにくいかも・・・
がると申します。 現場では、 ・ぽすとぐれすきゅーえる ・ぽすぐれ で呼称することがおおいです。 で、PostgresSQLはtypo(たいぽ。打ち間違いの意)だと思われます。 ただまぁ、読み方は場合によっては無限ループ的バトルを生みますので(笑 ある程度「ああ色々な読み方があるんだなぁ」くらいに受け流すとよいです(笑 例)char：ちゃー、きゃら、等、読み方がいくつか。
たとえば http://labo.heisei-tech.co.jp/pgsql/ とか、 http://www.postgresql.jp/interfaces/ でどうでしょうか？
橋渡しするツールというか方法についての問題ですよね。 手っ取り早いのは、XP上で、accessからODBC経由で ２つのRDBに接続して、コピーが良いと思いますよ。 わかりやすいですし．．
求めている回答ではないと思いますが、Shellで $ ps xu とプロセスを確認してみると、一応接続プロセスが表示されます。
>名前はまだないのですね SQLの国際基準に準拠しているので、PL/pgSQLのように、特別な名前は付かないと思いますよ？ 一般的には、ストアード・プロシジャと呼びます。 >トリガもまだなのですね CREATE PROCEDURE,CREATE FUNCTION,CREATE TRIGGERは、バージョン5でサポートされています。 【バージョン5のサポート内容に関する記事】 http://itpro.nikkeibp.co.jp/members/ITPro/oss/20 … 【マニュアル（英文）】 http://dev.mysql.com/doc/refman/5.0/en/index.html 参考URL：http://itpro.nikkeibp.co.jp/members/ITPro/oss/20 …
limitを31にして表示では30行だけ行い、 クエリの結果の31行目があればリンクを生成するとか
union allを使うと、２つの問い合わせ結果を同時に取得できます。 select name from テーブル１ union all select name from テーブル２ ; 詳しくは参考URLを参照してください。 参考URL：http://homepage2.nifty.com/sak/w_sak3/doc/sysbrd …
select * from table1 order by case when data_a > data_b then data_a else data_b end
こんにちは。インストールで、いろいろ失敗したので、回答します。 マイコンピューター ↓ 管理ツール ↓ コンピューターの管理 ↓ ローカルユーザーとグループ ↓ ユーザー ↓ PostgreS←これ削除で直りました。
>できれば12月1日～31日をズラッと表示したい 12月1日～31日の日付データを格納した表を作り、 LEFT JOINして、ナル値なら0を返すようにすれば 希望通りにできると思います。
その条件に合致するデータは、格納されているのでしょうか？ 試験的にやってみたら、検索できましたが？
データ容量は、 SELECT sum(relpages) FROM pg_class の結果に8KBを乗じて得られる値のはずです。 しかし、実容量はやはりdu コマンド（サーバがUnix、Linuxの場合）でなければ確認できません。 「データ容量 ＝ 実容量」ではないのです。
外部キーは、参照整合性を表現するためのものであり、データベースのモデリング時に考えるべきものです。 とくにPHPのコーディングに応じて使うものでないので、その際のメリット／デメリットを考えるのは、ちょっと難しいかと。 参照整合性の意味を知っての上での質問という事であれば、update/delte cascadeが使えれば、SQL文を短くできる、とか。
こんにちは。 昨日、OKウェブで質問して、postgreSQLの存在を教えてもらいました。 早速、本屋さんで、探したのですが、そこには、教えてもらった本はなかったので、SQL書き方ドリルを買いました。 初心者向けではなく、超初心者向けなのですが、 書く際の法則が、のってあり、自分的には、超お奨めです。 参考URL：http://www.amazon.co.jp/exec/obidos/ASIN/4774122 …
下のNo1です。 マニュアルを見ていたのですが、 pg_lo_seekという関数は使えないのでしょうか。 使ったことがないので、どのような動きをするか分からないのですが、 それっぽい気がします。 （一致しているのはseekという部分だけなのですが・・・） また、見当違いな回答だったらすみません。 失礼しました。 参考URL：http://jp.php.net/manual/ja/function.pg-lo-seek. …
データベースをリモートから操作できるようなツールは知りませんが、SQL の実行等のデータ操作を簡潔にするためのツールとしては psqledit, psqlgrid というソフトがフリーで公開されています。。 どちらも psql に比べるとかなり使いやすいのでお勧めです。 参考URL：http://www.hi-ho.ne.jp/a_ogawa/
> configure: error: readline library not found NINJA104 さんが 指摘されているように readline がインストールされていないためです。readline は bash などにも付属している履歴参照機能を提供するライブラリです。「↑」「↓」キーによって履歴が参照できるのは readline によるものです。configure 時に --without-readline を指定することでコンパイルすることは可能になりますが、もし、psql を利用して操作をされるようでしたら、是非 readline をインストールされることをお勧めします。 ちなみに、上の WARNING は bison がインストールされていないために表示されているものと思われますが (今回のエラーとは直接関係はありません)、もし今後もいろんなソースコードをコンパイルようでしたら、必要になることもあるパッケージですので、インストールしておかれると良いかと思います。
本来のご質問は、ＯｒａｃｌｅでいうSQL*Loader的な質問であったようで失礼しました。 代案として回答させてもらいましたのでご容赦ください。 ＯＤＢＣドライバーインストールを行い、「テーブルのリンク」で接続します。 参考ＵＲＬにドライバー乳先へのリンク・設定方法の解説があります。 参考URL：http://www.itnavi.com/PGSQLsiyou2.htm#run4
何階層になるか分からないのだから、同じ表を繰り返し 検索することになるのでは？ SQL99に準拠したDBMSなら、WITH句でRECURSIVE指定の 検索が可能です。 PostgreSQL 8.0.0の日本語マニュアルをざっと眺めた 範囲では、WITH句は未サポートのようです。 参考URL：http://www.atmarkit.co.jp/fnetwork/tokusyuu/01sq …
select a.code,a.sid, (select id from (select y.code,y.sid,x.id, (select count(*) from samp_dic as z where z.num=y.code and z.id=x.id and y.t1 like '%'||z.word||'%') + (select count(*) from samp_dic as z where z.num=y.code and z.id=x.id and y.t2 like '%'||z.word||'%') as Tx from (select distinct num,id from samp_dic) as x,samp_tv as y order by 1,2,4 desc) as b where a.code=b.code and a.sid=b.sid limit 1) as "どうだろ？" from samp_tv as a 効率は度外視して、こんな感じで、一文で書ける。 (少なくとも、ver7.2.1では動いてる)
nullの判定は「=」や「!=」ではなく「is null」「is not null」で行います。 select * from timetest where test_date is not null;
Windows版は、ときどき一回目のインストールでは失敗することがあるようです。 そこで、再インストールすることになるのですが、 再度インストールを試しても、今度は残留したサービスアカウントがバッティングするためコケます。 ではどうすればよいかというと。。。 過去にも同じ質問があったので、こちらをお試しください。２回目のインストールではたいがい成功します。 参考URL：http://oshiete1.goo.ne.jp/kotaeru.php3?q=1606300
統計情報の更新はされておりますでしょうか？ 統計情報更新は、 psql <データベース名> でDBにつないで、 VACUUM ANALYZE; とするか、 vacuumdbコマンドを使い vacuumdb -z -d <データベース名> とすれば出来ます。 これでSELECT文が劇的に早くなることがあります。
そうですかぁ。。。 > １）CGIをキックしたユーザのホームディレクトリに.pgpassをおいてみてはどうですか？？ 　CGIをキックするユーザーとなるとアパッチで設定されているnobodyというユーザーになるようなのですが、 　このユーザーのホームは「/」となっているようです。 　一応そこにおいて試してみました。（所有者root パーミッション600） 　・・・結果は失敗でした。 > ２）psqlで接続する-Uで指定したユーザのホームディレクトリに.pgpassをおいてみてはどうですか？？ 　やはりダメでした。 　ただ、テストサーバーではこの場所に置かれています。 本当に憶測ですみませんが、-Uで指定したユーザのホームディレクトリに.pgpassを配置したあと、PostgreSQLを再起動してもだめですかねぇ・・・。
#1回答者です。 降順という質問でしたね。以下のSQLで大丈夫だと 思います。 select * from (select c1,c2,coalesce(c3,0) from u1.t1) as wt1(wc1,wc2,wc3) order by wc3 desc
初めに、PrimaryKeyがIDとNAMEという事を想定します。 SELECT TEST.ID, TEST.NAME, WK.DATE FROM TEST, ( SELECT TEST.ID, MAX(TEST.DATE) AS DATE FROM TEST GROUP BY TEST.ID ) WK WHERE TEST.ID = WK.ID AND TEST.DATE = WK.DATE ORDER BY TEST.ID 動作確認済み。
大変失礼いたしました。今回はキチンと Windows版PostgreSQL8.0.4をインストールして やってみました。 (3)の操作はやはりおっしゃるとおりになりますので、 かわりに次のようにしてください。 (2)の続き、 <1>新しく作ったDBにpsqlで接続する。 >psql -U postgres -h localhost windb <2>ダンプファイルを読み込む。 windb=# \i C:/temp/out.sql これでいかがでしょうか？
英語版FAQによると、ＯＫのようです。 参考URL：http://pginstaller.projects.postgresql.org/faq/F …
１）Cron指定しているユーザではパスが通っていないということはないでしょうか？ ２）psqlコマンドをフルパスで書くとどうですか？ ３）abcをフルパスで指定するとどうですか？ ==> abcだとpsqlコマンドと同じ場所であるという解釈になりますが平気ですか？
MySQLはアメリカ等ではPostgreSQLよりも圧倒的に人気が高く、そのせいか、日本でも多く利用されるようになってきました。 ただ、naktak さんもおっしゃっているように、バージョンによってはトランザクションに欠けるとか、副問い合わせが出来ないとかいう欠点があり、それを実装したバージョンとなると性能もさほど良くないということを聞いたことがあります。 一方のPostgreSQLですが、かなりレベルが上がってきて、8.0からはPoint-Time-In-Recoveryができるようになるなど、エンタープライズレベルでも使えるような機能を搭載してきています (実際に PostgreSQL 対応の商用アプリ製品も市場に出て来つつあります)。以前のバージョンでは副問い合わせが極端に遅い、時々手動で vaccume しなければならない、Windows 未対応等の欠点がありましたが徐々に克服されてきつつあります。また、SQLの標準準拠レベルも高く、Oracle等が持つ独自関数なども実装しており、かなりの互換性があります。ただし、コマンドライン (psql 等) の日本語化はいつになっても正式版に組み込まれる見通しがありません。;; 従って、商用DBに先に追いつくのはPostgreSQLと考えられますが (OEM、検索速度等を除けば随分 Oracle に追いついている)、当然機能が高くなるに連れ勉強しなければならないことは多くなるし、ソースレベルで複雑になって不具合も出てくる可能性があるので、どちらがよいとは一概には言えません。 ちなみに、私は PSqlEdit および PSqlGrid (参考URL) の存在のせいもあって、かなり PostgreSQL を支持していて、MySQL には若干否定的になりがちですが、PostgreSQL よりも支持率が高い理由は検索速度以外にも PHP との相性がよいなどいろいろとあると思います。その辺りについては他の方の意見を待ってみて下さい。私も参考にさせて頂きます。 参考URL：http://www.hi-ho.ne.jp/a_ogawa/
参考URLで聞いた方がより的確な回答が得られますよ。 過去のML検索も出来ますので、一度ご覧になって下さい。 参考URL：http://www.postgresql.jp/PostgreSQL/pgsql-jp.html
自動化自体は、可能だと思います。 （いわゆるサイレントインストールのようなことは可能でしょう） ＞サンプルのバッチファイルとかってありますでしょうか？ 作業手順を熟知すれば、自ずと解決すると思いますので、 インストール関連のドキュメントをお読み下さい。
EUCは、 １バイト目：Ａ１～ＦＥ ２バイト目：Ａ１～ＦＥ なので、 ９０４Ｂ は、その範囲にありません。 つまり、書かれているコードをＥＵＣとして理解できませんということです。（ＥＵＣのコードとして不適当） ちゃんとＥＵＣで書く（あるいはコード変換してやる）必要があります。
ただ単にパスが通ってないだけではないでしょうか？ パスを通すか絶対パスでタメしてみてください。 通常のディレクトリにインストールしているのであれば /usr/local/pgsql/bin/initdb です。
selsect distinct ・・・ 初歩的なSQL文ですよっ！（笑
手元に環境がないので確認取れませんが、 (case where アリ>0 then '蟻'||アリ||'匹' else '' end) || (case where ハチ>0 then '蜂'||ハチ||'匹' else '' end) || (case where チョウ>0 then '蝶'||チョウ||'匹' else '' end) as 総数 のように case ～ end を文字連結してみては。できるかどうか試してください。
'2005-05-05 05:55:55'
参考URLをご覧下さい。ちょっと前にあった質問です。 参考URL：http://oshiete1.goo.ne.jp/kotaeru.php3?q=1606300
手元に環境がないのでなんともですが、 >約10分たつとまたできなくなります。 そもそも-iオプションをつけないとリモート接続できない(=ローカル接続のみ)はずですが...。-iを使用して起動している場合は、詳しくは分かりませんが、postgresql.confのstatement_timeなどが関係しているのかもしれません。ご参考程度までに。
＞クライアント側にもDBを持たせる事って出来るのですか？ クライアントにDBサーバ入れれば当然できますけど、本来のDBサーバーと同期とらないとならないですよね。 ＞それとプログラミング等でクライアント側に自動でDB設定とかが出来るのでしょうか？数が多いので自動化したいのです。 質問がよくわからないけど ＷＥＢアプリにしてしまってはダメ？ クライアントに何の設定もいりません。
代わりに to_char(nwtimestamp, 'YYYY.MM.DD HH:MI') を使用してください。
とりあえず、どのファイルを取って来たのかが わからないので、最初から取り直した方が いいと思います。 http://www.postgresql.jp/PostgreSQL/download.html とりあえず、↑から順番に行ってみてはどうでしょうか？
XPSP2だと、ファイアウォールでアクセスが禁止されている可能性が有りませんか？ 以下のページでファイアウォールをOFFしてみてください。 参考URL：http://support.microsoft.com/default.aspx?scid=k …
gomidb=# create table gomitabley(a timestamp,b text); CREATE TABLE gomidb=# insert into gomitabley values('2005-9-15 11:12:13','a'); INSERT 17315 1 gomidb=# insert into gomitabley values('2005-9-16 11:12:13','b'); INSERT 17316 1 gomidb=# insert into gomitabley values('2005-9-17 11:12:13','c'); INSERT 17317 1 gomidb=# insert into gomitabley values('2005-9-18 11:12:13','d'); INSERT 17318 1 gomidb=# insert into gomitabley values('2005-9-19 11:12:13','e'); INSERT 17319 1 gomidb=# insert into gomitabley values('2005-9-20 11:12:13','f'); INSERT 17320 1 gomidb=# insert into gomitabley values('2005-9-21 11:12:13','g'); INSERT 17321 1 gomidb=# select * from gomitabley; a | b ---------------------+--- 2005-09-15 11:12:13 | a 2005-09-16 11:12:13 | b 2005-09-17 11:12:13 | c 2005-09-18 11:12:13 | d 2005-09-19 11:12:13 | e 2005-09-20 11:12:13 | f 2005-09-21 11:12:13 | g (7 rows) gomidb=# select * from gomitabley where date(a)-2<=date(now()); a | b ---------------------+--- 2005-09-15 11:12:13 | a 2005-09-16 11:12:13 | b 2005-09-17 11:12:13 | c 2005-09-18 11:12:13 | d 2005-09-19 11:12:13 | e (5 rows) gomidb=#
　WEB開発をしている者です。 　PostgreSQL と MySQL 両方使いますが、最近はほとんどMySQLを使用しています。（以前PostgreSQLを使用していて、最近はMySQLを使用している口です） 　理由は、MySQLの方が検索スピードが多少早かったからです。また、PostgreSQLは更新が多発した場合、定期的にDB最適化をしてやる必要がありました。（かなり以前ですので、最新のバージョン同士で比較していませんが） 　ただし、SQL文では、PostgreSQLで使える構文でMySQLで使えない構文があり、複雑なSQL文を必要とする場合は、PostgreSQLの方が良かったと記憶しています。また、PostgreSQLの場合は、C言語等で、自分で関数を作ってやり登録する事で、複雑な例外処理を含むような検索がすっきり関数で行えるようになりました。 　しかしながら、ここまで複雑なSQL文を必要とするシステムはほとんど構築する必要はありませんでした。ですので最近はMySQLをほとんど使用しています。 　以上、ご参考までに。
もちろん「日本 PostgreSQL ユーザ会」のサイトにドキュメントは 整備されていますが、経験豊富な kounesi さんのはずなのに それを最初に見ようとは思わなかったのですか？ それとも分かってて何かの釣りですか？ 回答に対する結果報告が皆無なのでどの程度まで理解してるのか 判然としないのですが。
失敗って出ているので失敗しているのでしょう。 失敗の原因を探してください。 # postmaster -D /var/lib/pgsql/data などとして、直にPostgreSQLを起動してみよう。suでpostgresになった後postmasterの起動を試行しても良いだろう。ここでエラーメッセージでも出てくりゃあそれを読めば良い。 　他には、postgresqlスクリプトを読んで、怪しい所を探す。例えば設定ファイルの書式が変わっていたり、起動のコマンドライン引数が変わっていたりするかも知れない。 調べるファイル。（パスは一般的なものなので君の環境に合わせて読み替えてちょんまげ） /etc/init.d/postgresql または /etc/rc.d/init.d/postgresql /var/lib/pgsql/data/postgresql.conf /var/lib/pgsql/data/pg_hba.conf とにかく、解決にはまず「なぜ失敗するのか」だ。
普通はpostgresユーザのパスワードは人間が指定するものではない、と思う。 一旦rootになってそこから行くのではないかな。 $ su - Password: # su - postgres BASH2.05$ もちろん、rootになってそこからpostgresのパスワードを設定する事はできる。
>postgreSQLを起動するコマンドを教えて下さい /etc/rc.d/init.d/postgresql start 何しようというのかわからんけど、検索するとか調べるクセつけたほうがいいよ、マジで。 そっちのが早いから。 「fedora postgres 起動」でgoogleで検索しただけでも相当数HITするし
pg_connect()が定義されていないというのなら、必要なコンポーネントが入ってないので、 　yum install php-pgsql を実行してみてください。
三度，＃１です． postmaster -i としてみたらいかがですか？ あと，表示されるエラーメッセージは全て書いた方がいいですよ． その方が結果的に早く問題解決します． > psql: could not connect to server: ・・・ の「・・・」の部分に大切なことが書かれていたりするものです．
DBに入っている、日付(d1)がDATE型でしたら select * as s from xxx where now() - d1 > '1 week'::reltime こんな感じですかね。
reg_dateをdayでdate_truncしたフィールドをもつビューを作って、そいつをgroup byしたらどうでしょう。
Oracle８i以降でよければ順位関数と複文を使って Select table1.x,table1.y,table1.z from (Select rank() over (order by z) rank,x,y,z from XYZ) table1, --順位付けしたテーブル (Select rank from (Select rank() over (order by z) rank,x,y,z from XYZ) where x = 3) table2 --X=3のデータの順位 where table1.rank = table2.rank -1 --X=3の前 or table1.rank = table2.rank +1 --X=3の後; で出ますね。 順位付きのレコードの検索が重複しているから、 Viewを使えばもう少しすっきりすると思います。 Oracle以外では、順位の求め方や、複文が使えるかどうかなど条件が変わってきます。 上記ので解決できなければ、 使っているデータベースの名前やバージョンなどの情報を追加していただけたら、解決に結びつく回答が得られると思います。
while の処理の中で st に対して再度SQLを発行してたり、rs を上書きしてたりしませんか？ でなければ通常Exceptionは出ないと思われるのですが… あとcloseの順番は rs、st、con の順番の方が良いと思われます。
取れなくはありませんが、テーブル構成を見直す事をお勧めします。 使用上の注意 条件を一つ追加しないと取得出来なかったので勝手に追加しています。 勉強だと思って何が追加されているか、考えてみてください。 SELECT 　* FROM 　test 　JOIN 　　( 　　　SELECT 　　　　id, 　　　　max( num ) AS num 　　　FROM 　　　　test 　　　　JOIN 　　　　　( 　　　　　　SELECT 　　　　　　　id, 　　　　　　　max( "date" ) AS "date" 　　　　　　FROM 　　　　　　　test 　　　　　　WHERE 　　　　　　　flag = 1 　　　　　　GROUP BY 　　　　　　　id 　　　　　) AS tmp1 　　　　USING( id , "date" ) 　　　WHERE 　　　　flag = 1 　　　GROUP BY 　　　　id 　　) AS tmp2 　USING( id , num ) ORDER BY 　RANDOM() desc LIMIT 　2;
ちょっとバージョンは低いですが、7.1.3で確認しました。 まず、ALTER TABLEでは項目の変更はできないようです。 ALTER TABLE server MODIFY no serial; parser: parse error at or near "modify" 追加は出来ましたが alter table server add ser serial; ALTER test=> \d server Table "server" Attribute | Type | Modifier -----------+--------------+---------- no | bigint | name | character(8) | id | integer | ser | integer | integerにしかなりません。 調べてみると、データを退避して テーブルを作り直して流し込むという方法に なるそうです。
何をするかにもうよりますが、 SQLやテーブルの操作等、基本的な事なら7を勉強することで8も使えるようになります。 DBの管理等については、8で大幅に改善しているので、7を勉強するより8から勉強したほうが苦労しません。 個人的には、せっかく勉強するなら、最新の情報で勉強する事をお勧めします。 古い環境で勉強して苦労して出来るようになった事が、 新しい環境では実装されているなんて事も良くありますから。
char_length(string)で文字数が octet_length(string)でバイト数が得られます。
これは、Windows版の話でしょうか。お使いのPCが WindowsXPという前提でご説明いたします。 Windows版PostgreSQLインストーラは、 サービス用のユーザ(デフォルトで、"postgres")を 作成します。アンインストールしても、このユーザは 残ったままなため、まったく同じ条件で インストールする場合は、このユーザを手動で消さなければなりません。 (1)コマンドプロンプトを開き、 >　NET USER と入力してEnterしてください。 postgres というユーザがいるはずです。 (2) >　NET USER /DELETE postgres と入力してEnterしてください。 (3) コンソールが戻ってきたら、もういちど、(1)で 表示させ、postgresユーザが消えたことをご確認 ください。 (4) 消えていましたら、PostgreSQLの再インストール をしてください。 ご注意！ コマンドライン操作は諸刃の剣です。 上記手順を実行することによって生じたいかなる損害 にも責任とりかねますので、 他の資料などで、本手順が正しいかどうか 十分ご納得いただいたうえで、実行してください。 くれぐれも慎重に行ってください。
LIMIT、OFFSETを 利用すれば可能ですよ～！
PostgreSQLでは、正規表現によるパターンマッチングができますから、それでやってたらどうでしょう 参考URL：http://osb.sra.co.jp/PostgreSQL/Manual/PostgreSQ …
できますよ。まる括弧で囲んでください select * from (select * from tbl2) as t2
＞理想的には　.mdb　ファイルをなんらかの形で、一気にPostgreSQLに流し込みたいのですが… 残念ながらそんな「魔法」みたいな方法はありません。 考えられる方法は、ACCESSからODBC経由でPostgreSQLのテーブルに対してリンクし、ACCESSのクエリー（テーブル作成クエリー）またはVBAでデータコピーする事でしょう。 これが一番楽かと思います。まぁでも300テーブル分の処理は書く必要はありますが。テーブル名がプログラムでうまく制御（例えば連番になっているとか）出来るのであれば多少楽になりますが。 後は、ACCESSのデータをCSVにエクスポートして、PostgreSQLにデータをロードするプログラム（JavaでもCでも何でも良いですが。）を作ってやるという手もあるでしょう。
No1の方がかかれているようにソースを表示すると改行はされていますか? それであれば<pre></pre>のタグで囲んだ範囲は改行やスペースがそのまま反映されるので入力されたまま表示したいのならこの方法がよいかもしれません。
phppgadminでの操作が許可されていれば このツールを使うと便利ですよ
>Warning: prerequisite Test::Simple failed to load Test::Simpleが無いといっています。 Test::Simpleを入れましょう。 （Test::Simpleはあまり依存性がないので簡単に入ると思います）
Postgresのメーリングリストで質問した翌日に似た質問が出ていました。 参考URL：http://ml.postgresql.jp/pipermail/pgsql-jp/2005- …
カテゴリはPostgreSQLなので、まあバージョンだけは明記すべきでしょうな。 厳密に動作確認はしていませんが、マッチする範囲が広い条件を先にすれば、問題ないかと思います。 select * from sample where text not like '%LONG2%' and text like '%LONG%'
簡単に行うならpg_dumpall+ftpで良いでしょう。 crondで適当にpg_dumpallかけて、その結果を圧縮後、ftpとかでバックアップサーバへ送ればそれなりにいけるんじゃないでしょうか？ （これならあまり構成変えなくてすみそうだし）
>（integerよりsmallintにした方が動作が速くなるとか、そういう理由なんでしょうか？） 基本的にはプログラム言語にintとstring（text）があるのと同じ理由です。 たとえば、たいていの場合intの方がメモリ消費量が少なく、検索やソートも容易です。 あと、stringは基本的に算術対象にできません。 （StrToIntとか使えばできる場合もありますが） >何を基準にデータ型を決定 色々考慮する事項はありますが、基本的にその項目に入りうる最大限動的なデータ型を決定すれば良いかと思います。 特にPostgresだけを使うならvarcharやcharは積極的に使う理由がない限り使う必要はないでしょう。 （問題になるのは移植性くらいかな？） #私は大抵textとintくらいしか使わないです。 #（booleanはintで代用）
インストール CD のどこかに postgresql-contrib-7.3.2-3.i386.rpm があるはずです。 # rpm -ivh postgresql-contrib-7.3.2-3.i386.rpm (バージョン古すぎ!)
PostgreSQL-CEのことかな？ 参考URL：http://osb.sra.co.jp/postgresql-ce/news.html
絵文字？ケータイ向けですか？だとしたら かな～り難しいと思います(PCで使えないですから) また、顔文字でしたら、参照URLを見ると分かりますが顔文字でよく使う文字が除外されているようですよ 参考URL：http://php.s3.to/man/function.rawurlencode.html
ビューは仮想的なテーブルで、呼ばれたときに、実際に定義部分に書かれた、SELECT文が実行されます。 したがって、踏襲もなにも・・・ select id, data from TEST_TABLE が、実行されるんですから、インデックスは活きます。
IBMから出ているvisual-testというソフトで出来ます。一度インストールを手作業で行ってその操作をそのままvisual-testに覚えさせます。これをスクリプトで保存し、目的のPCで実行します。これで最初に操作したとおりのマウス操作やキーボード入力を自動的にやってくれます。マウス操作は解像度が違うPCで実行するとずれてしまうので、普通はマウスは使わずすべてキーボードで操作します。
個人的には、データを取り出す際に完全にDBに依存できるなら、それに越したことはないと思います。 「$dbh->selectall_hashref(q[SELECT * FROM hoge join fuga on foo = bar])」とかの帰り値をそのまま表示系のルーチンに渡せたほうが楽じゃないですか？ （管理画面とかを作るにしても定型化しやすいし） >■DB上での管理 >柔軟性が乏しい（仮に運用途中でテーブル項目が増えたりしたら面倒） テーブルの列をhashとして扱えば柔軟性は十分では？ （列が追加されようが、削除されようが関係なし） >■テキストデータの管理 >バックエンドとの通信がない為処理が早い どのみち取り出すときにSQLにするならDBへの接続が必要なので、速度に関してはそんなに変わらないと思う。 （よほどDBに負荷をかけたくないなら別だけど）
dbsizeというツールを使うと調べられます。 実行方法等、詳細は以下のサイトをご参照ください。 ＃今、確かめられる環境が無いのですが、不明な点があったら言っていただければ調べられると思います(^^) 参考URL：http://technodelic.net/pukiwiki/pukiwiki.php?Pos …
強制終了時に、PostgreSQLの一時ファイルが削除されず、PostgreSQL再起動時にエラーが発生してPostgreSQLサーバが起動できなかったという可能性があります。 PostgreSQLインストールフォルダ（「C:\Program Files\PostgreSQL\8.0\」等）の下の「data」フォルダに「postmaster.pid」というファイルが残っていませんか？それを削除して、もう一度PostgreSQLを再起動してみると起動するかもしれません...？ ----- こういった場合、Linuxだと「/tmp/.s.PGSQL.5432」も悪さをするのですが、Windows版の場合、上記ファイルと同等の役割のファイルがあるのかどうかが分かりませんでした。ご存知の方がいらっしゃいましたらフォロー頂けると助かります。
初めて答えさせていただきます。 いつも質問してるほうなのでうまく答えられない かもしれませんが、、 ↓のように pg_numrowsで結果レコードセットの分だけforで 回してそのたびに配列に入れればいいかと思います。 //検索SQL実行 $rs = db_query($sql,$con); 　　　　//forで行の分だけまわす for ($i = 0; $i < pg_numrows($rs); $i++){ //$i行目の行を取得 $DATA = pg_fetch_object( $rs, $i ); $get[$i] = $DATA->列名; }
参考になればと思い書き込みします。 １．IPアドレス >Is the postmaster running (with -i) at >'192.168.10.5' と >host all xxxxx 192.168.10.2 255.255.255.0 trust のIPアドレス違いは記入ミスでしょうか？ ２．PORT OS側の設定も調査してみてください。私はFreeBSDしか触ったことないのですが、FreeBSDには/etc/servicsというファイルがあり、ここにエントリーのないPORTは使用不可です。Linuxに似たようなものがあると思いますので確認してみてください。
できます!!っていうかやっています。 運用環境だとヤバイ(速度が落ちる等) と思いますけど、テスト環境ならゼンゼン問題ないです 運用環境と同等にしたいのであれば、交互に立ち上げればいいだけのことです
> バックアップ用に、OIDごとコピーしようと思っていたのですが、oidもコピーできるのでしょうか？ 可能かと思います。 COPY tabename TO '/foo/foo.csv' WITH OIDS DELIMITERS ',' とかでいけるのではないでしょうか。 ※度々ですが6.*系でできるのかどうかは判りかねます。 > テーブルに対してユーザapacheの権限を与えるには どうしたらよいでしょうか？ 具体的な命令文についてはURLなどのマニュアルをご覧下さい。 場合によってはテーブルに対する云々より、pg_hba.confなどをいじる必要があるかもしれません。 参考URL：http://www.postgresql.jp/document/pg653doc/j/use …
>申し訳ございません、この部分は例えばどのような場合になるのでしょうか？ > この例でいきますと、内容が同じ受注を２つ受けた場合に、 TableB(受注明細情報(作業内容))とTable C(受注明細に付属する オプション(作業場所))の両方が重複するように思います。 （【P1-人工キーを用いた構成】の場合) 逆に上記のケースでレコードが重複しない場合は、TableBとTableCには 同じ内容のレコード(主キーだけ違う)が許されるわけで、その場合は 第二正規形でなくなってしまうように思います。 フィールド内容の実世界での関係によりますが、話をうかがっている限りでは TableCが実際には、TableAに関係があるように思ってしまってます。 ここで本当にTableCがTableBだけの依存で関係を表現できるかが大切に 思えます。（勘違いだったらすいません） ---------------- >以下、別の質問になってしまうかもしれませんが・・・ これは難しい問題ですね。僕もよく悩みます。例えば会員を扱っている テーブルで、法人区分が個人か法人かで、個人名か会社名どちらかが必要な 場合などですよね。ちょっと調べてみます。 ・・
こんなのはどうですか？ select id, case when size >= 1048576 then (size / 1048576) || 'MB' when size >= 1024 then (size / 1024) || 'KB' else size || 'B' from table;
私はLinuxでeuc-jpを使っているので推測ですが。 Windows XPということは、ひょっとして DBの文字コードか何かでシフトJISを使っていて それが原因かもと思います。というのは秋山浩二の浩 という字はシフトJISで0x8D5Fであり、0x5Fは半角下線 （_)に相当します。そして半角下線はSQLのLIKE句において 任意の１字をあらわすワイルドカードになっているためです。 適切に設定されていれば、日本語文字の一部と判定されるべき 浩の字が、何らかの文字コードがらみの設定違いで、8D + 5Fという ２文字と判定され、結果、5Fがワイルドカードであると 誤判定されるなどして起こるのだと思います。 従って、文字コード関係の設定を洗ってみてはどうでしょうか。
これからPostgreSQLをはじめようとしているものです。 Oracleの経験はあるのですが、 Oracleはルールベースで検索しているとき、インデックスなどの優先的に使用される条件以外はWhere分のより後に書いてある条件から検索されるようになっていました。 LIKE文をより前に変えると結果が変わりますか? また日付の条件はインデックスが設定されているカラムですか? 統計情報を取得している場合はコストベースで考えるのでまた結果は代わってくると思います。 OracleとPostgreSQLの共通点、相違点について興味があります。 よろしければ結果をお教えください。
/var/pgsql/data/PG_VERSION には何と書いてありますか？ 7.3と書いてあれば7.3のフォーマットになってますのでデータは問題なくて、ほかに原因があると思われます。
echo $sql; 実際に発行しているSQLが何か確認してみてはどうでしょうか。
php.iniでPostgreSQL用のモジュールをロードするようにすれば接続できるように変更したらエラーが出なくなると思いますよ。 参考URL：http://www.aspect-sys.co.jp/etc/win/xp_db/php/in …
yum search postgres とやって、何も出てきませんか？ 普通は、これで rpm くらい見つかると思う。 見つかれば yum install XXXX でインストールできると思う。 いずれにしろ、まずはサーチです。 インストールされているかならば、＃１の方のおっしゃるとおり rpm -qa | grep postgres というところでしょう。
#1の方も指摘されている通り、 psql を使えば出来ます。 psql で、-f オプションを使うか、該当のDBに接続して \i コマンドを使えば良いでしょう。 http://www.postgresql.jp/document/pg746doc/html/ … SQLが記述されているファイルを insert_data.sql、 DBを testdb としますと 例1)------------------------------------------------------------- $ psql testdb Welcome to psql x.x.x, the PostgreSQL interactive terminal. ・ ・ ・ testdb=> \i insert_data.sql testdb=> \q ----------------------------------------------------------------- 例2)------------------------------------------------------------- $ psql testdb -f insert_data.sql ----------------------------------------------------------------- 注) ユーザのDBへのアクセス権によっては -U オプションや -W オプションも必要になります。
普通に select 注.ID, メ.料理名 from 注文表table 注, メニューtable メ where 注.メニューID=メ.ID でどうだろうか。
(ソースのリダイレクトです) postgreSQL v8.0.2で select * from pg_stat_activity; とすれば出て来ました。 一応、探すのに苦労しましたが 23.2. 統計情報収集器 にその他統計情報の閲覧テーブルが記載されています(参考までに) http://www.postgresql.jp/document/pg800doc/html/ … 参考URL：http://ml.postgresql.jp/pipermail/pgsql-jp/2003- …
select * from pg_database; とか select * from pg_tables; で見ることが出来ます 詳しくはドキュメント第41章システムカタログで。 #pgAdmini IIIでなんでココまで詳しく分るのかと思ったらこういう事だったのか。納得させられました。ありがとう 参考URL：http://www.postgresql.jp/document/pg803doc/html/ …
確認なのだが、apt-getではなくpostgresqlをSSL対応にしたいという事で良いね？ Debianはあまり詳しくないのだが、postgresを起動する時に-iオプションと-lオプションをつけてみるとどうなるだろうか。SSL使用可能でコンパイルされていたら、そのオプションをつけるだけでSSL対応になるはずだ。
PostgreSQL 8.0.2 文書 -> 8.5.1.5. 特殊な値より (以前のドキュメント7.3.0を参照してもこの項目、構文は存在していたので有効です) 入力文字列有効な型説明 epochdate, timestamp1970-01-01 00:00:00+00 (Unixシステム時間におけるゼロ) 今回の場合は、問い合わせの時に若干計算式を記述してやる必要があるようです select EXTRACT(epoch FROM TARGET_DATE)+ (EXTRACT(HOUR FROM TARGET_TIME)*60+ EXTRACT(MINUTE FROM TARGET_TIME))*60+ (EXTRACT(MILLISECONDS FROM TARGET_TIME)/1000) from T_TIME; #問い合わせに対する負荷が高いので、もしかしたら、新しいカラムを用意した方がいいかもしれません #さらなる情報は参考URL(ドキュメント)を参照して下さい テストrun: select EXTRACT(epoch FROM CURRENT_DATE)+ (EXTRACT(HOUR FROM CURRENT_TIME)*60+ EXTRACT(MINUTE FROM CURRENT_TIME))*60+ (EXTRACT(MILLISECONDS FROM CURRENT_TIME)/1000); クエリー全体 実行時間:10 ms. データ検索 実行時間:10 ms. 参考URL：http://www.postgresql.jp/document/pg721doc/user/ …
create function 関数名 () RETURNS void AS 'update文1;update文2;・・・・,update文5;' language sql; とかしてみたらどうでしょう。 実際に試してないので自信ないですが
コマンドプロンプト上でPostgreSQLにアクセスできてるなら、PHP側の問題かと思われます。 過去の回答が参考になるかと。 参考URL：http://oshiete1.goo.ne.jp/kotaeru.php3?q=1390123
Cygwinを使ったらどうでしょう？
＠ITでも似た書き込みをみたような。。。 実際やったことはないので、なんとも言えないのですが、まったく同じバージョンのPostgreSQLを前回インストール時と同じ方法で別サーバにインストールし、initdbして、アクセス不可になったPostgreSQLの　/usr/local/pgsql/data　ディレクトリをそっくり新しいほうへ上書きすることでなんとかなるような気もします。（もちろんディレクトリコピー時には、 移行元、先ともPostgreSQLのサービスはstopさせておく必要があります。） これで駄目ならちょっと方法が思いつきません。 参考URL：http://www.postgresql.jp/document/pg74doc/html/b …
> データベースのエンコーディングを【EUC_JP】に変更しないとだめでしょうか？ 【SQL_ASCII】では、マルチバイト文字がマルチバイト文字として認識されないので、難しいと思います。 WHERE句などに日本語が有る場合、予期しない動作することもあるでしょう。 特にSJISを扱う場合は、エスケープ文字(5Ch)を含む文字の後ろに\を加えるなどの処置しないと、構文エラーを引き起こすこともあります。 例えば、下記の様なSQLの場合、構文エラーになってしまうと思います。 select * from aaa where name like '%パソ'; 【SQL_ASCII】でないとだめということですが、どういった理由でしょうか？ 【SQL_ASCII】のままで無理に日本語を扱う方法を探すよりは、【EUC_JP】もしくは【UNICODE】にする方法を考えたほうが良いかと思います。
テーブル名に大文字と小文字が混在しているせい でしょうか。。。 "tblbooks" か　"TBLBOOKS"　にしたほうがよい とは思います。 (SQL文としては、大文字小文字どちらか一方 に統一されていれば、 "tblbooks"でCREATEしたテーブルでも、 "TBLBOOKS"でSELECTできるはずです。) 検証したわけではないので、はずしているかもしれませ んが、CREATE TABLE "tblbooks"　で作ってみても、 再現するでしょうか？
OID（オブジェクトID）の事でしょうか？ OIDなら SELECT oid FROM table_name で表示出来ます。 DELETEもUPDATEもWHERE条件で指定してあげれば出来ます。 DELETE FROM table_name WHERE oid = 123456
＃１です．補足します． リンクできるスキーマはpublic以外ではinformation_schemaだけのようです． この他のスキーマは出てきませんでした． しっかり確認するべきでした．ごめんなさい．
　ここでは「バイナリが扱える型」という意味で LOB と書きましたが、混乱させてしまったようですね。申し訳ない(^_^; 　ようするにバイナリ型の意味です。 　バイナリなら、ユニコードとかそういう概念は関係なくなるので、どんなデータでも自由に扱えることになります。 　Postgres だと、bytea 型がそれに当たるようです。
テーブルidのいずれかのカラムが配列で定義されｔます。 create table 文を確認してみてください。 もし、その定義で正しいのなら、insert文を変更する必要があります。
訂正します。 /etc以下ではなく/var以下でした。（初回起動していなかったので作成されてませんでした） （/var/lib/pgsql/data/postgresql.conf ←当方での本当のパスはこっちです（汗 ） pg_hda.conf および pg_ident.conf も同じところにあります。
ワイルドカード（というより、パターンマッチング）は文字列にしか使用できません。 どうしても数値フィールドで LIKE を使用したいのであれば、数値フィールドをto_charなどで一度文字列に変換し、それに対して LIKE を使用すれば良いと思います。
distinct の使い方が間違ってます。 select distinct on (name_1, name_2) id, name_1, name_2 from temp_table;
unionを使っているため、limit使用時に全体でのlimitなのか各SELECT文ごとのlimitなのかでわからずエラーになるようです。 そこで、括弧で括ってやるといいです。 ところで、■▲●で2件取得のところは ORDER BYでソートしなくていいんでしょうか？ 該当する列が元々2件だけしかないなら別ですが・・・。 (select * from table where culumn = '■' limit 2) union (select * from table where culumn = '▲' limit 2) union (select * from table where culumn = '●' limit 2) union (select * from table where culumn != '■' and culumn != '▲'and culumn != '●' order by random() limit 2)
>クエリを実行したまま処理が戻りません。 というか、遅いんでしょう(^^;;; >下のものはgroup by keyのkeyがないのでできませんでした。 うーん、「できませんでした」って書くより、group by句を直したほうが早いですよね？ select id, minorder from t_meisai t1, (select date, type, min(order) as minorder from t_meisai group by date, type) t2 where t1.date = t2.date and t1.type = t2.type
こんにちは 自信はありませんが，下のように，データベース名を一番最後に移動してみてはいかがでしょうか？ psql -U postgres -c "SELECT * FROM addrbook;" test2
試しに当方の環境で試してみましたが「濱」をInsertしてHTMLで表示という流れは問題ありませんでした。 当然WHERE句に指定しても問題ありませんでした。 データベースのEncodeはEUCでHTMLはS-JISです。 SJIS表示できるターミナルでも試したのですが、最初ターミナルをEUC表示でSET CLIENT_ENCODING TO 'SJIS';を行い、ターミナルをSJIS表示に切り替えINSERTおよびSELECTしてみましたが問題ありませんでした。ターミナル上でも同様の現象が発生しますか？
普通にインストールされたのなら。。。 PostgreSQLの接続ユーザ=postgres 作成するDB名=testdb DBの文字コード=EUC_JP と仮定すると、 コマンドプロンプトで、 (1)cd "C:\Program Files\PostgreSQL\8.0\bin" で、PostgreSQLのbinに移動して、 (2)createdb -E EUC_JP -U postgres -h localhost testdb (3)Postgresユーザのパスワードを入力 で出来上がりかと。。。
select の結果が必ず１レコードもしくはnull になるという条件なら、selectの結果にcoalesce()すればご希望通りかと。 update testb set nswer = coalesce((select coalesce(test1, 0)+coalesce(test2, 0) from testdb where 条件), 0);
>今回の場合、かまわないという状況 だとすると以下のSQLで問題ないんじゃないでしょうか？ >select * from (select distinct on (aaa) * from bbb) as ccc order by ddd 基本的にdistinctを置き換えるのはgroup byだと思いますが、この場合group byでは面倒なので、distinctで良いと思います。 （再帰結合とかすればいけそうな気もするけど、できても多分すげーめんどいと思う）
事業コード, 部署コード, 情報コードでユニークとなるのであれば、 select 事業コード, 部署コード from TBL1 where 情報コード in ('02', '03') group by 事業コード, 部署コード having count(*) = 2 ユニークにならないのであれば、 select 事業コード, 部署コード from ( select distinct 事業コード, 部署コード, 情報コード from TBL1 ) as WK where 情報コード in ('02', '03') group by 事業コード, 部署コード having count(*) = 2 こんな感じかなぁ。 ちなみにPostgreSQLを動かす環境がないので、動作するかは不明です(^^;
>新しくpostgresqlをインストールして、/var/lib/postgres/data のなかのデータを、旧HDDのなかのものと 換えたりしてみましたが、成功しませんでした。 PostgreSQLの付属文書で「できる」と書いてあるので、おそらく手順が違うのでしょう。 行った手順、エラーメッセージ等を記述してみては？ （パスが違うのは打ち間違い？） >どこのデータを入れ替えればよいか、と教えていただ きたいです 参考URLによれば「pgsql/data以下全部」だそうです。 参考URL：http://www.postgresql.jp/document/pg800doc/html/ …
メニューのデータベース ↓ 編集の反映（Ctrl + W） からできると思いますよ
update discussion set dentry=dentry+1::numeric where did = 3 ↓ update discussion set dentry=dentry+1 where did = 3 としてはどうでしょう update テーブル名 set カラム名 = 値 where カラム名 = 値
うーん！ 会社側が意図していることが概ね読めるだけに難しい！ このサイトでのやり取りでどうこうできるものでは、ないですね。
ここを参照してみては？ 参考URL：http://www.postgresql.jp/document/pg732doc/refer …
CAST関数の文法は、CAST(○ AS △) となります。 ○：変換する値 △：変換する型 Select CAST(nedan AS char(10)) ～ とすればできると思いますよ
\dtでは
実際にやってみた方が早い気もしますが・・・． select 41.4432::numeric(4,1); この結果が答えだと思います．
Linuxなら /usr/local/pgsql/bin/initdb って打つ． Windowsなら initdb.exeがあるところを探して実行 パスが通ってないだけぽいです．
>taka_tetsuさんの仰られるとおりの方法で可能でした、 >categoryに文字列が追加され1,2も文字列として扱いたい場合はどのようにしたらよいのでしょうか？ 基本的に一緒です。 categoryに格納される文字列の形式が不明なのでSQLそのものは書けませんが、case命令でcategoryを分類して1,2を求めれば同じことです。
NULLが格納されているフィールドにというより、 既にレコードがある場合は、UPDATE文を使います。 例えば、sampleテーブルのfield1列のNULLを０にするには、以下のようにします。 UPDATE sample SET field1 = 0 WHERE field1 = NULL; NOT NULL制約は、NULL値を許可しないということです。 フィールドにNULLを設定したくない場合は、 INSERT文のVALUESで値を指定すればいいのですが、 ここで、省略した場合の規定値は、CREATE TABLE文で指定しておくことができます。 例えば、 CREATE TABLE test (id integer primary key, field1 timestamp DEFAULT now(), field2 data integer DEFAULT 0); の様なときに INSERT INTO test VALUES(1); とかできます。
こんにちは。 まだよくわかってないのですが、 エラーの内容から考えると、「aaa100」というカラムが存在しない・・・。 ちゃんと値の方を訊いてますか？ SELECTの項目でのエラーのような・・・。 (^^ゞ
>カラムBBBは問題ないのですが、 >カラムDDD(最後尾のカラム)がNULLの場合にエラーになってしまいます。 改行コードに一票
テーブルAにすべての項目でUNIQUE制限をつけて、テーブルBから、全レコードをAに対してINSERTするってのはダメですか？ INSERTしようとしたときに、重複するデータはUNIQUEキーではじかれる・・・ということで。 （想定で回答していますのでアイデアだおれかもしれません）
私もNo.2さんに賛成です。カラム追加が必要ですが、これが速度的に一番早いと考えます。
フロントエンドの接続数よりもバックエンドの接続数が少なければ，フロントエンドで止まってしまいますよね？ CCCCCCCCCC [client] FFFFFFFFFF [apache] BBB******* [postgres] *の部分は足りないのでエラーが返る． ひとつのスクリプトでpostgresに2connectionあれば，フロントエンド＝バックエンドでは足りなくなりますよね？ よって，安全を考えてF < Bって考えるべきかと思います． それから，apacheが落ちると言うのは何かスクリプトに問題があったりしませんでしょうか？ アクセス数が多くなれば，コネクションできなくなるだけなので，そのエラーが返るはず． 落ちるのは，資源を使い切ってたりって事もあるのでは？ ベンチ中にtopで監視してみた方が良いかも知れません． #Linuxですよね？
rpmかな？ だったら/etc/init.d/postgresqlって起動スクリプトがあると思う． コンパイルして入れたのなら，postgresql-x.x.x/contrib/start-scripts/linuxってスクリプトがあるので， # cp linux /etc/init.d/postgresql # chmod 755 /etc/init.d/postgresql # chkconfig --add /etc/init.d/postgresql # service postgresql start で良いよ思われます． pidファイルの事が気になるのであれば，起動スクリプトを参照すればOKかと．
SELECT * FROM テーブル名 ORDER BY フィールド名 複数のフィールドをカンマ( , )で区切って列挙することもできます。 優先順位は先に記述したものから高くなります。 この場合 order by クラス, 出席番号 ですね。
PostgreSQL のマニュアル 第 12章同時実行制御 をよく読めば解決の糸口が見つかるのではないでしょうか。 http://www.postgresql.jp/document/pg746doc/html/ … 参考URL：http://www.postgresql.jp/document/index.php3
ちなみになぜ同時に消したいのですか？
指定したカラムに非NULL値を持つレコードがない場合、COUNT(～～)の値はNULLでは無く0になります。 お尋ねの場合は0を表示させたいとのことですので、CASE文を使わなくても良いのでは？ 例) ------------------------------------- SELECT t1.cd, COUNT(t2.cd) FROM t1 LEFT OUTER JOIN t2 ON t1.cd = t2.cd GROUP BY t1.cd ORDER BY t1.cd 参考URL：http://www.postgresql.jp/document/pg746doc/html/ …
"DISTINCT"はSQL文を実行した結果のテーブルから、重複している行を単純に削除して、重複のない結果をだすものです。それに対し"GROUP BY"は、結果のテーブルに対してグループ化を行い、さらに集計をすることを可能にします。よって、"GROUP BY"は主に集計関数と共に用いることが多いです。 確かに、単純に重複を取り除く目的だったらどちらでも結果は同じことになりますが、集計を必要とするような場合は"GROUP BY"を使うことが必至です。 ↓の掲示板のレスで、この2つの違いについて例を挙げて説明されています。http://fukkey.dyndns.org/pins/ora/020430/42660.h … また、参考URLに挙げたフォーラムの記事でも、この2つの使い分けについて論議されていますので、参考になれば幸いです。 "GROUP BY"を用いて集計する方法の具体例は、以下のページで解説されていますので、参考にして下さい。 http://www.atmarkit.co.jp/fnetwork/rensai/sql03/ … http://www.techscore.com/tech/sql/05_08.html 参考URL：http://otn.oracle.co.jp/cgi-bin/non/msgview_r.cg …
どのように上手くいかないのか不明ですが、条件は Where 商品主コード || '-' || 商品補助コード = '入力された商品コード' もしくは Where 商品主コード || '-' || 商品補助コード Like '入力された商品コード%' ではないのでしょうか？ インプットボックスが商品主コードと商品補助コードに分かれていない場合、前方一致か完全一致でないと入力する方も難しいと思います。 （つまり、「12345-00」の商品コードに対して、「45-0」と入力して「12345-00」を検索することはないと思いますが。。。）
可能。 phpPgAdminをインストールすると、config.inc.phpという設定ファイルがある。この中を見ると一発で分かるはず。
どこから繋げて何を行うかによるなぁ。 １．インターネットを経由してhttp→×話にならん。例えばIPによるフィルタを掛けてもセキュリティ上の意味なし。 ２．ローカルホストのみ→○問題なし。 ３．LAN内からhttp→ポリシーによる、が、セキュリティの議論をしているとなると×の可能性が高い。 ４．https→△まぁ大丈夫なんじゃないの。SSLが破られない事を祈ろう。 １． 特に設定なし。 ２． order deny,allow Deny from All Allow from 127.0.0.1 ３． 特に設定なし。強いて挙げるなら order deny,allow Deny from All Allow from 192.168.1 かな。 ４．(抜粋) Port 80 DocumentRoot /home/httpd/html Listen 443 <VirtualHost *:443> DocumentRoot /home/httpd/phpPgAdmin SSLEngine On </VirtualHost>
> HINT: Use "\r" to represent carriage return 改行コードが違うのでは？ > Ｗｅｂ上よりテキストを改行ＯＫの形で入力させたものを保存していました。 サーバがunixでWEBからWinのローカルに落としたときによくあることだったようなきがします
パスワードの有効日数ではなく、有効期限という方法なら 参考URLをご参照ください。 個々では、確か、再試行回数は無かったような気がします。 参考URL：http://osb.sra.co.jp/PostgreSQL/Manual/PostgreSQ …
参考URLにあるように、Windows 98では動作しません。 どうしても動作させたいのであれば、cygwinというソフト をインストールして、その上でPostgreSQLを動作させる必要がありますが、初心者にはお勧めできません。 Windows 98で動作させたいのであれば、 mysqlをインストールした方が簡単だと思います。 http://dev.mysql.com/downloads/index.html 参考URL：http://pginstaller.projects.postgresql.org/FAQ_w …
「ぴーえいちぴー ぴーじー あどみん」 「ぴーえいちぴー ぽすとぐれすきゅーえる あどみん」 ――ではないかと。
最新日付の取得はMAX()関数、ソートはORDER BY句を使用すれば出来ます。 http://www.postgresql.jp/document/pg746doc/html/ … http://www.postgresql.jp/document/pg746doc/html/ … 例) ----------------------------------------------------- SELECT type, COUNT(*), MAX(create_date) FROM shohin GROUP BY type ORDER BY MAX(create_date) DESC
下の参考URLのlog_statementをtrueにするではだめですか？ 参考URL：http://www.postgresql.jp/document/pg746doc/html/ …
基本的な話になりますけど動作環境はWindows/UNIX系? Windows版(PowerGres)は使った事がないので不確かですがGUIがついてるかもしれないです LINUXについてはPHPを利用すれば、phpPgAdminというフリーウェアがあるのである程度の事ができると思います フォームについては私的には、PHP+tex/xmlで何とかなるのでは？と思います オープン系で揃えるメリットとしては、大体の場合ライセンス料がほとんどかからない事があります オススメは、LINUX+APACHE+POSTGRES+PHPです 参考URL：http://www.bk1.co.jp/cgi-bin/srch/srch_detail.cg …
あまり自信はありませんが、個々のテーブル毎にGRANTしないとしょうがないように思います。 ただ、 テーブルのリストは取得できますし バッチ（ファイルからの入力）でコマンドを実行することができますので、 エディタの置換などの機能を使って、テーブルのリストから、GRANTコマンドの羅列に変える ユーザーＡ用Ｂ用と作るのはそれほど手間ではないと思います。
DB環境がLinuxだかではないでしょうか。 文字コードがうまく変換されていないのでは？ 一度、HTTPヘッダーで文字セットを行い、表示する文字をS_JISに設定してみたらどうですか。 <META HTTP-EQUIV="Content-Type" CONTENT="text/html;charset=Shift_JIS">
update test_table set test = test / 10; でいいと思います。 整数だし。
>ただ、ＲＤＢにしておきたいデータも別にあるのですが・・・ >この場合、ＲＤＢのデータと、txtファイルのデータの両方を同じプログラムで処理可能なのでしょうか？ 可能か不可能かといわれれば可能でしょう。 ＃ファイルを扱えない処理系は、組み込み以外聞いたことないですが。 問題になるのは処理可能かということではなく、どのように取得したデータをプログラムで使用した以下ということですよね。 一覧の表示に必要なデータがすべて順編成のテキストファイルになっているのであれば、特に問題なし。 そうではなく、正規化されていて名称等の項目をRDBから取 得する必要があるのであれば、ファイルの1レコードずつに対して自分で1つずつ名称等を取ってくる処理を組む必要がありますよね。そういう時はすべてをRDBに格納して物理的な位置は気にしないことをお勧めします。 SQLで一発で取ってこれることがほとんどですし。
横レスですけど group by eventid order by eventid のeventidも substrしないと意味ないと思いますが
... union ... union ... union ... とかとかとか。 （これが効率的かどうかは知らんけど） 参考URL：http://www.atmarkit.co.jp/fnetwork/rensai/sql09/ …
回答No.1の topはMS-ACCESSでの関数です。 このtopと同様のことを実現するのが、OFFSET、LIMITです。 以下のURLを参考にしてみてください。 参考URL：http://homepage2.nifty.com/sak/w_sak3/doc/sysbrd …
基本的に-や+は計算式の-や+と区別が付かないので使えなかったと思います。 もしかしたらカラム名を"で囲んでやると出来るかも知れませんが、そのカラムを使うあらゆる場面で"が必要になります。（select/insert/deleteなど全て） ということなのでカラム名に-や+をつけるのはお勧めできません。 ところで質問にあるSQLには+が使われている様子がないのですが、何か他の理由でエラーになっているのかも知れませんね。（漢字やひらがなのせい？）
int insertCount = stmt.executeUpdate("INSERT INTO shinamono (hinmei,nedan) VALUES ('+str1[0]+', 1500)"); この行ですね。文字列を+で連結しているので "insert into ...'" + str1[0] + "', 1500)" にならないといけません。ちゃんと前半の終わりと後半の始まりのダブルクォートを入れましょう。 それとstr1が配列なのは、今後拡張するからでしょうか？（今のプログラムでは配列である必要がないので・・・）
こんにちは initdbで作成されたディレクトリを削除してバックアップしたものをコピーす るという方法でできませんか？ 私の環境はWindows 2000にインストールしたCygwinのPostgreSQL 7.4.5ですが， 問題なくできました． 上書きコピーよりも置き換えた方がいいかも知れません．
バージョンが分かりませんが、alter table に set/drop not nullってのがあるみたいです。（少なくとも7.3.2には） でも、後々のことを考えるとdropして、ちゃんとtableを作るsqlを直して、createしたほうが間違いありませんよ。必要ならデータのバックアップを忘れずに。 （sqlを直し忘れたらあとでトラブルが起こりますし、実行してないsqlを後で流すのも不安ですしね。）
テーブルBの主キーは、A_IDとSEQですよね？？ テーブルBをA_IDでグループ化して、A_IDとSEQの最小を取得したものを、１つのテーブルと見立てればよいと思います。 私も勉強中なので、自信はなしです。いっしょにがんばりましょう～！ SELECT B.B_ID, B.A_ID FROM A, B, ( SELECT A_ID, MIN( SEQ ) FROM B GROUP BY A_ID ) C WHERE A.NAME = XXXX AND B.A_ID = A.A_ID AND B.A_ID = C.A_ID AND B.SEQ = C.SEQ
そんなときこそトリガーがいいと思います。 ・B,C にInsert するファンクションを作ります。 ファンクション の中に Aの新しいデータをあらわす NEW を使います。 ・A のテーブルにInsert したときに起動するトリガーを作ります。 こんな方向でいかかでしょうか？
試せる環境がないので、動くかどうか怪しいです。 select * from tableA order by rpad(id, 7, '#') これがだめなら select * from (select a,b,c,d,....,rpad(id, 7, '#') as sort_id from tableA) as tableA order by sort_id rpad(a,b,c)は aの文字列がb文字に達するまで、右側にcの文字列を付け足すと言う関数です。 ですので rpad('A0001', 7, '#') = A0001## rpad('A00010', 7, '#') = A00010# rpad('A000100', 7, '#') = A000100 rpad('A0002', 7, '#') = A0002## となります。一般的な文字コードの場合#は0より小さいので、ちょうど上のならびにソートされます。 7文字に満たないところにスペースが入っているのならrpad(rtrim(id,' '), 7, '#')にしてください。 後半の方法だとスピードは保障できません。動かなかったらごめんなさい。
＞POSTGRESのデータを退避させたいのですが ＞そのような事は可能なのでしょうか？ こういうときこそCDROMで動作可能な、KNOPPIXの出番です。 KNOPPIXのCDROMから起動すれば、ハードディスクのパーティション・ネットワークなど 認識してくれます（特殊なハードでない限り）ので、簡単にデータを退避すること が可能です。 パッケージ版のPostgresであれば、 /var/lib/pgsql/ 配下にPostgresの環境・ホーム・DBがあります。
文字コード？
psqlのコマンドオプションの-fは、 SQLコマンドのバッチ実行です。 psql対話実行時の\iと同じです。
to_numberの書式はto_number(元の文字,フォーマット)です。 参考URLはマニュアルです。 大変な環境でお仕事されているようですね。ユーザと話す人がちゃんと技術的なことを説明できないような人だと開発者はつらいですよね。頑張ってください。 参考URL：http://www.postgresql.jp/document/index.php3
case式かcoalesce関数でNULLが現れないようにするのが、定石かと。 あとは、col2がNULLの時、どういう結果にしたいのか次第。 参考URL：http://www.postgresql.jp/document/pg734doc/user/ …
psqlで、最初に「begin;」を入力したらどうでしょうか？ 明示的にcommitをしなければ、rollbackされるようになると思います。 例)----------------------------------------------- begin; insert into table1 values(1, 1); commit; --------------------------------------------------
#2です。ちゃんと見ていなかったですが、正規化という意味では、Ａテーブルに名前は要らないですね。もしくは、#1さんの言うとおり、ＪＯＩＮする必要はないですね。
こんばんは。 囲み方が変・・・かな？？？ ％は文字列だけど、Keyは出さないとダメだと思います・・・。 (^^ゞ
こんにちは。 なるほど・・・です。 残念ながら動的SQLじゃないので、コンパイル時にカラムの整合性をチェックしに行きます。 なので、本当は実行時にだけ参照して欲しいというささやかな願いは、聞き入れてくれません・・・。 動的SQLを使用するように変更するか、レコード型を宣言し、明示カーソルループ（こんな言い方でいいのかな？？？）でレコード型に代入、型のカラムを返す。 などという方向転換が必要かと・・・。 (^^ゞ
こんにちは。 値段の合計を出すのにＵＮＩＯＮするの？？？ 普通に等結合で足しちゃえば駄目ですか？ select date, type, Aテーブル.値段 + Bテーブル.値段 from Aテーブル, Bテーブル where ・・・省略（ＡとＢの条件を合わせる） ・・・(^^ゞ
WindowsでつかうならWINと文字コードを設定すればよいです。 以下サイトはPostgresqlの文字コード一覧です。 参考URL：http://www.postgresql.jp/document/pg742doc/html/ …
こんにちは お使いのPostgreSQLのバージョンが書かれていないので当てはまらないかも知 れませんが，確認できた範囲では，バージョン7.4.1以降ならば， ALTER DATABASE name RENAME TO newname としてデータベースの名前を変更できるようです． 参考URL：http://www.postgresql.jp/document/pg74doc/html/s …
PostgreSQLでは、CASE式が使えます。 例) ---------------------------------------------- SELECT CASE WHEN field2 = 0 THEN NULL ELSE field1 / field2 END AS result FROM table1; -------------------------------------------------- バージョンは、少なくとも7.0以降であれば使えると思います。 参考URL：http://www.postgresql.jp/document/pg743doc/html/ …
以下のコードの実行結果はどうなりますか？ （実際の結果と、期待する結果の両方を教えてください） $\="\n"; $sth = $dbh->prepare('select name from testtbl where name ilike ?') || die $dbh->errstr; $sth->execute('%A99B-6%') || die $sth->errstr; while ($name = $sth->fetchrow_arrayref()) { last if $dbh->errstr; print @{$name}; } print '$dbh->errstr:'.$dbh->errstr if $dbh->errstr; print '$sth->rows:'.$sth->rows;
すみません　ANO.２です mysqlimportはmysqlでした。 postgres は　 psql# copy addr from '/tmp/hoge.csv' using delimiters ','; 等のようでした。
#1です。 すいません。順番まで考えてませんでした。 #1の形のviewを作って、それをorder byする。 で、どうでしょう。
残念ながら、バージョン7.1以降でないとFROM句でのサブクエリーの使用は出来ないようです。 7.1以降であれば、#1の方の方法で出来ると思います。 参考URL：http://osb.sra.co.jp/PostgreSQL/Manual/PostgreSQ …
パッと見ただけですが、下記のところが怪しいかと。 ----------------------------------------------- DriverManager.getConnection("jdbc:postgresql://xxx.xxxx.xx.xx:8080/webshop","postgres","xxxx"); ----------------------------------------------- この部分は、 jdbc:postgresql://(PostgreSQLのホスト名orIPアドレス):(PostgreSQLのポート番号)/(database名) という書式です。 TomcatとPostgreSQLが動いているサーバが同じであれば、ホスト名の部分は“localhost”になります。また、PostgreSQLのポート番号はデフォルトで5432です。おそらく、8080はTomcatのポート番号ではないでしょうか。 ポート番号の後ろにはデータベース名が入りますが、“webshop”であっていますでしょうか。 TomcatとPostgreSQLが動いているサーバが同じで、PostgreSQLのポート番号がデフォルトのままで、データベース名が“webshop”とすると下記の様になると思います。 ----------------------------------------------- DriverManager.getConnection("jdbc:postgresql://localhost:5432/webshop"); ----------------------------------------------- 参考URL：http://www.postgresql.jp/document/pg743doc/html/ …
select user_cd from td_order_goods inner join td_order on td_order_goods.order_cd = td_order.order_cd where pay_dt is not null and to.sale_cd='A' 上記のように結合できると思います。 td_orderテーブルをある条件で絞り込んでから td_order_goodsテーブルを検索すると、 JOIN項目が主キーではないので テーブル全体を検索することになります。 逆に、td_order_goodsを絞り込んでから td_orderを検索するようにすると、 主キーでJOINしますので、効率が良いです。 もし、td_order_goodsのorder_cdに 二次インデックスを作成できるのであれば 逆にtd_orderから検索してJOINすれば インデックス項目でJOINしますので 効率が良くなります。 どちらを先に絞り込むかは、 データ件数の少ないほうを先にやったほうが良いです。 いろいろ試してみてください。
こんにちは 頭の体操という感じで作ってみました． もっとスマートなやり方があるのかも知れませんが．．． select age, cnt from (select trunc((current_date - to_date(birth,'YYYY/MM/DD'))/365.0) as age, count(*) as cnt from tb_custom_user where birth is not null group by age order by cnt desc) as cntsql JOIN (select max(cnt) as maxcnt from (select trunc((current_date - to_date(birth,'YYYY/MM/DD'))/365.0) as age, count(*) as cnt from tb_custom_user where birth is not null group by age order by cnt desc) as cntsql ) as maxsql ON cntsql.cnt = maxsql.maxcnt; cntsql: wantedさんが作られたSQL maxsql: 最大値を求めるSQL これで，最大値の人が複数でもだいじょうぶです． いかがでしょうか？
私の場合、PHPのmb_convert_kanaコマンドを使って全て、全角に統一してから登録しました
できます。普通のSQLです。 insert into testm (data1, data3) values(1,3); int8だから特別なことはありません。data2にはnullが入ります。 ご存知かもしれませんが参考URLはPostgreSQLの日本語ドキュメントです。お使いのバージョンのものをご覧ください。（insert文にそんなに大きな差はないと思いますが） 参考URL：http://www.postgresql.jp/document/index.php3
うぉお！！！ > $ LANG=C initdb -D /home/postgres/bin すっげ～名前！！！（驚愕・唖然 (^^;)） bin ですか・・・ 別に名前はなんでもいいといればいいんですが 普通 bin は実行ファイルを保存するフォルダ名に 使われるので、今後のために避けた方がよろしいかと。 /home/postgres/data/ あたりをされた方がよろしいかと思います。 > ただ、ディレクトリーは毎回指定しないと > いけないのでしょうか？ No1 の回答で答えていますが、再掲。 > initdb -D /home/postgres/data > のように D オプションで指定せねばなりません。 >（環境変数 PGDATA に設定してしまう手もあります） ユーザ postgres の .bashrc にて PGDATA=/home/postgres/data みたいにしておけばいいです。
sh、 ksh または bash のような Bourne シェルを使っている場合は、home ディレクトリの .profile ファイルに以下を付け加えます。 $ PATH=/usr/local/pgsql/bin:$PATH $ export PATH 参考URLを追記しておきます。分からなければ遠慮なくもう一度質問して下さい。レスはおそいですけど・・・ 参考URL：http://www.postgresql.jp/document/pg653doc/j/use …
togino です。 すみません。ありましたね・・・（汗） ------------------------ LIMIT 句 LIMIT { count | ALL } [ { OFFSET | , } start ] OFFSET start count は 返される行の最大数を指定し、 start は 行を返しはじめる前に飛ばす行の数を 指定します。 ------------------------ ここにも書いてありますが、ORDER BY と併用するように と注意書きされております。 # すみませんでした・・・
申し訳ありません配列の部分を見落としていました。 配列を使った設計はあまり良いことにならないのですが、参考までに。 CREATE TABLE test( id INT2[] ); で作成できると思います。
こんにちは ＃１さんのおっしゃるとおり，数値であっても文字列でしかデータの受け渡しができません． <form>で取得したデータをどんな言語で処理するのかは分かりませんが，一度SQL文を作成すると思います． 数値も文字列と同じようにしてデータを受け取り，SQL文を作成する段階で文字列ならばシングルコーテーションを付け，数値なら付けないようにすればいいだけだと思います． JAVAでSELECT文を作るとしたら以下のような感じになると思います． 文字列の場合："SELECT ... WHERE field1 = '" + mojiretu + "';"; 数値の場合："SELECT ... WHERE field2 = " + suchi + ";";
使ったことないので適当ですが、grantじゃだめですか？
> 検索をする際に数字の方が良いからだと、 > 言っておりましたが、 > 漢字ではDB内を検索できないのでしょうか？ その人の考えであるので色々事情もあるかと思いますが 『の方が良い』であって『でないと出来ない』とは おっしゃってないと思いますよ。 もちろん、PostgreSQL は漢字を格納でき検索も出来ますが、 SELECT * FROM meibo WHERE name = '佐藤*'; という風に SQL に漢字が含まれます。 この時、日本語には Shift-JIS, JIS, EUC, Unicode とたくさんの エンコード形式があり、これらを正しく変換しなくては なりません。こと PHP も絡むので ・ブラウザから送られてくる漢字のエンコード形式 ・PHP 内部で使われるエンコード形式 ・PostgreSQL に送られるエンコード形式 ・PostgreSQL 内部で使用されるエンコード形式 これらが実際なにで、どういう風に変換されるのか きちんと理解する必要があります。 失礼ですが、umioo さんは初心者であると思われて これらがまだ理解できないであろうと判断された上で 上記のように、漢字は使わないで数字でしろ と言われたのだと思います。 技術的にできるできないでいったら「出来る」ですが umioo さんには「出来ない」と思われたのでしょう。 あと > その際は半角カタカナのDB登録は必要でしょうか？ これは、技術的にも「出来ない」と思った方がよいです。 全角カタカナを使ってください。 どうしても半角カタカナにこだわるのであれば その問題点を理解した上で利用してください。
#1です。 WINDOWS版って書いてありましたね。 リダイレクトの切り替えはWindowsでも可能です。 (psql -h localhost [DB名] < sqllist.txt) 2>&1) > log.txt 2>&1は標準エラー出力2を標準出力1に切り替えという 意味です。 切り替えた結果を()で囲み、されにファイル出力してます。
「データを表示しない」というのは、selectで選択しない、という事で良いんでしょうか？ あと、20030301000001というのは、2003年03月01日00時00分01秒で良いんでしょうか？ 一応、そういう仮定で方法を。 20030301000001などのデータの前8文字を取り出し、数値として20030228と比較し、大きければ、20030228より後の日付なので条件と一致すると判断できます。 環境が無く、試せないので具体的なselect文は提示できません。 データを数値として扱う方法は、キャスト、型変換などでググるか、書籍を調べてみてください。後、前8文字を取り出すのも文字列関数があります。
SELECT setval ('"もともとのシーケンス"',1,false); 基本値の後がfalseの場合、基本値の値から始まります。 基本値の後がtrueの場合、基本値の次の値から始まります。 （指定がない場合、true）
こんにちは。 これは「shop が "kkk" か "lll" か "ccc" のもの」 という意味で良いのでしょうか？ それでしたら、OR でつなぐか IN を使います。 ... WHERE shop="kkk" OR shop="lll" OR shop="ccc" または ... WHERE shop IN ("kkk","lll","ccc") で検索できると思います。 シングルクォーテーションになるかもしれません('kkk') 見当違いでしたらすみません。
initdb:failed　の上あたりに原因が表示されてないですか？ そこのメッセージでググれば幸せになれそうな気がします。 とりあえずこんなのとか。 http://discypus.jp/pc/cygwin/postgresql.shtml ※セクション「動かしてみる」参照。 参考URL：http://discypus.jp/pc/cygwin/postgresql.shtml
今頃ですけど、replace関数では駄目なんでしょうか？ 誰も書かない所を見ると、駄目っぽい気もするんですが。 参考URL：http://www.postgresql.jp/document/pg743doc/html/ …
PostgreSQLのSQL用フロントエンドですと、psqlになりますが、そのコマンドですとそれぞれ下記の様になります。 \l \d \d テーブル名 参考URL：http://www.postgresql.jp/document/pg721doc/refer …
質問の意図が違っていたらすみません。 例えばフォームのテキストエリアから改行を含んだ文字列を受け取って、それをそのまま PostgreSQLのTEXT属性項目に入れても改行コードも書き込まれますから何ら問題はないように思われるのですが。実際に運用して問題は出ていません。（クライアントはSJIS、DB内はEUCです） 「おかしなことに」の具体的な内容を書いていただければ・・・
> ＳＱＬ文の長さ制限について 一行にすべてを記述しようとするとエラーになる、などの問題があるのでしょうか？ 改行することで結構長いスクリプトの記述ができるとおもいますが。 select col1, col2, ・・・ from table1 where ・・・ は select col1, ＜改行＞ col2, ＜改行＞ ・ ＜改行＞ ・ ＜改行＞ ・ ＜改行＞ from table1 ＜改行＞ where ・・・ ＜改行＞ と記述する手もありますよ。
使用したことはありませんが、ここなんかどうでしょう？ほかにもSOHOで検索してみてください。 参考URL：http://www.sohovillage.com/classads/,http://www. …
> できれば、LIKEを使用したくないのですが。。 PostgreSQL ならば LIKE 以外に 　SIMILAR TO / SQL99 の正規表現 　POSIX正規表現 と、ドキュメントの 　第 9章関数と演算子 　9.6 パターンマッチング に書いてあります。 # パフォーマンスにどのくらいの差がでるかわかりませんので 　それぞれの方法で試してみてはいかがでしょうか。
aiurai54　さんは 「画像の向き」の質問をしていらっしゃいましたが、 GD が有効ならば PHP (imagerotate)で回転できるみたいです。 スレ違いで失礼しました。
エラー は ERROR であり、 NOTICE は注目 です。 「インデックス用のテーブルを作成しました」 と言っているのでは？
実際にJSPファイルを作成してみましたが、特に数値に変換しなくても普通に比較・表示されましたよ。以下に実際作ったJSPを示します。 -------------------------------------------------- JSP -------------------------------------------------- <%@ page contentType="text/html; charset=Shift_JIS" %> <%@ page import="java.sql.*" %> <%! Connection con = null; Statement stmt = null; ResultSet rs = null; // データベースに接続 public void jspInit() { try { String user = "(ユーザ名)"; String password = "(パスワード)"; String host = "jdbc:postgresql:(データベース名)"; String driver = "org.postgresql.Driver"; Class.forName(driver); con = DriverManager.getConnection(host, user, password); } catch(ClassNotFoundException e) { e.printStackTrace(); } catch(SQLException e) { e.printStackTrace(); } } // データベースを切断 public void jspDestroy() { try { if(rs != null) { rs.close(); rs = null; } if(stmt != null) { stmt.close(); stmt = null; } if(con != null) { con.close(); con = null; } } catch(SQLException e) { e.printStackTrace(); } } %> <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> <html> <head> <title>データベースアクセス</title> </head> <body> <table> <tr> <td> ID </td> <td> update </td> </tr> <% stmt = con.createStatement(); try { int id; String update; rs = stmt.executeQuery("select * from test2 where update>'20040501'"); while(rs.next()) { id = rs.getInt("ID"); update = rs.getString("update"); %> <tr> <td> <%= id %> </td> <td> <%= update %> </td> </tr> <% } } catch(SQLException e) { e.printStackTrace(); } %> </tr> </table> </body> </html> -------------------------------------------------- 結果 -------------------------------------------------- ID update 2 20040612 3 20040520 即興で作ったプログラムですので不具合が多々含まれていると思いますが、一応結果が表示できましたので載せました。また実際には見やすいように字下げしたのですが、どうやら空白等が無視されてしまうみたいで、非常に見にくいプログラムとなってしまいましたが、その点はご容赦ください。 以上です。
設定内容が書いていないので いかんともあれなんですが。。。(^^; 以下の手順をご確認下さい。 １．mod_webapp.soをapacheのlibexecに配置している。 ２．apacheのhttpd.confに以下を記述している。 ------------------------------------------------------ LoadModule webapp_module libexec/mod_webapp.so AddModule mod_webapp.c <IfModule mod_webapp.c> WebAppConnection warpConnection warp localhost:8008 WebAppDeploy examples warpConnection /examples WebAppInfo info </IfModule> ------------------------------------------------------ ３．tomcatのserver.xmlに以下を記述している。 ------------------------------------------------------ <Service name="Tomcat-Apache"> <Connector className="org.apache.catalina.connector.warp.WarpConnector" port="8008" minProcessors="5" maxProcessors="75" enableLookups="true" appBase="webapps" acceptCount="10" debug="0"/> <Engine className="org.apache.catalina.connector.warp.WarpEngine" name="Apache" debug="0"> <Logger className="org.apache.catalina.logger.FileLogger" prefix="apache_log." suffix=".txt" timestamp="true"/> <Realm className="org.apache.catalina.realm.MemoryRealm" /> </Engine> </Service> ------------------------------------------------------ ４．tomcat、apacheの順で再起動 どう？
sonarです。２度目ですね。(^^) 確認なのですが JDK,TomcatでサーブレットやJSPの 動作確認まではできていたのでしょうか？ インストールしたバージョンと併せて教えてください。 Apacheとの連携はとりあえず置いといて まずはJDBCを使えるように頑張りましょう。 >CLASSPATH設定は、tomcat4.0以降だと違うのですか？ >pg_hba.confの設定はどうするのですか？ CLASSPATHはTomcatのバージョンとは関係ありません。 ポスグレの設定はとりあえず pg_hba.conf(7.3以上の場合)------- host all all 127.0.0.1 255.255.255.255 trust --------------------------------- と postgresql.conf----- tcpip_socket = true -------------------- を設定しておけばJDBCから接続できます。 pg_ctl reload などで設定を有効にしてください。 （ポスグレの再起動でもよいです。） JDBC以外はあまりバージョンは気にしなくても よいと思います。 順番の方は ポスグレをソースで入れてJDBCドライバを自前でこしらえるのであれば ・JDK ・ANT ・PostgreSQL ・Tomcat になろうかと思います。 ＊Apacheやmod_JKはいつでもよいです。
追伸です。 PostgreSQLに関しての参考URL 石井達夫さんのページ http://www.sra.co.jp/people/t-ishii/PostgreSQL/i … PostgreSQL 完全攻略ガイド」(初版) PDFで読めます。 http://www.sra.co.jp/people/t-ishii/PostgreSQL/p … PostgreSQL ODBC Driver 日本語版 http://www.interwiz.koganei.tokyo.jp/software/Ps … 最近情報を追いかけていないので最新のpostgresで使えるか不明ですが、たしか大丈夫だった気がします。ご自分で調べてみてください。
select * from tbl where name like 'カ%' って感じじゃないですかね。
postgreのpg_hba.confでhostのアクセスが許可されていないのでは？ とりあえず host all all 127.0.0.1 255.255.255.255 trust とか書いてみるとどうでしょうか。 ファイルのありかはソースだと一般的には /usr/local/pgsql/data/pg_hba.conf です。 rpmだと /var/lib/pgsql/datapg_hba.conf
参考URLの2003/1/10分、2003/1/11分辺りが参考になるのではないでしょうか。 参考URL：http://vision.featia.net/diary.jsp?year=2003&mon …
ダンプファイルからリストアと言っても色々方法があります。 ダンプを取った際及びリストアした際の、コマンドやオプションを明記しないと、誰もアドバイスができないと思いますよ。
VACUUMだけではデータは削除されません。 VACUUM FULLを行ってください。 参考URL：http://www.postgresql.jp/document/pg742doc/html/ …
pg_tablesは使えませんか？ select tablename from pg_tables WHERE session_user = tableowner （tableownerだから「参照可能」とはちょっと違いますが）
initdbしてないとか。 >/usr/local/pgsql/data/PG_VERSION is missing 実際このファイルはありますか？ $ ls -la /usr/local/pgsql/data/
PostgreSQLって、サーバ側charsetとしてShift JISは、サポートして無い（即ち、-EでSJISは指定できない）のでは。 代わりに、クライアントとの間でのEUC_JP⇔SJIS自動変換機能を持っていますが。 参考URL：http://www.postgresql.jp/document/pg742doc/html/ …
桁間違いの問題は、アプリケーション側で 入力チェックを行い、 データ挿入時にPHPのstr_padや、SQLのTO_CHARなどを 使い、6桁での記録を保証するようにしましょう。 6桁が保証されれば、chie65536さんのお答えどおりで 問題なく比較できるでしょう。 ※2004/11/01を　2004111　と保存してしまったら、 　後からそれが、2004/11/01か2004/1/11かをプログラムが判断することは不可能でしょう。 ただ、データの挿入が、時系列に沿ってされているのでしたら、OID列の比較でデータ挿入日時の大小比較できるかもしれませんよね？＞皆さん
すみません、勘違いでした。 PostgrSQL の ML を捜しましたがテーブル名を変数化するのは無理のようです。 ML http://ml.postgresql.jp/pipermail/pgsql-jp/2003- … 関係ありそうだがちょっと違うみたい http://ml.postgresql.jp/pipermail/pgsql-jp/2003- … # すでに見ていたらごめんなさい
＃１です。 自分も仕事ではCSEを使ってます。 便利なところは、ログなどで出ているダラ～っと横に長いスクリプトを、SQL部分に貼り付けて、CTRL+Qをおすとそのスクリプト文を整形してくれます。さらにCTRL+Eで実行。CTRL+Gで、結果データの表示と実行時間の表示の切り替えができます。 ご覧になってわかると思いますが、ある特定のフォルダを作っておき、そこにスクリプトをためておけば、自分の作成したテストデータを探したりするときにも簡単ですよ。 あと、eclipseのDBeditも結構使えると思いますよ。 参考URL：http://eclipsewiki.net/eclipse/index.php?DB%A5%D …
PostgreSQLの接続は、ODBC接続でなければ必要ないと思います。 問題は、libpq.dll のバージョンの問題だと思います。 「インターウィズ PostgreSQL関連情報」の中でも同様の指摘がされています。(以下引用) 「PostgreSQLバージョン6.5に付属するlibpqの日本語Windows版バイナリです。今となっては少々バージョンが古いのですが、PostgreSQLサーバはクライアントに対して上位互換性がありますので通常の使用では問題ありません。バージョン6.5以降の全てのサーバに接続可能です。ちなみにこの逆のパターン（新しいlibpqと古いPostgreSQLサーバの組み合わせ）では接続できません。」 libpq.dll の7.0等の新しいバージョンのものがインストールされていませんか？ 下記のサイトからダウンロードしたものをインストールすれば問題ないはずです。 参考URL：http://www.interwiz.koganei.tokyo.jp/software/Po …
システムのテーブル/ビュー(pg_***)を参照します。 pg_tables (view) にテーブル名、所有者名があります。 参項 URL にシステムテーブル/ビュー の一覧があります。 参考URL：http://www.ysd.bne.jp/pgutil/pgindex.php
データベースサーバは、ファイルとは別形式でデータを保存していると思ってください。(実際は、ファイルに記録したりしているのですが、そのファイルは、複雑な方法で読み書き・制御している場合が少なくないですので、それらに対して直接操作を加えることは推奨されません。) ですので、テーブルのデータを抜き出すには、シェルが使えるならば、pg_dumpやpg_dumpallを利用してデータ読み出します。これを、テキストファイルにデータをリダイレクトしてください。 そうすれば、他の人に渡すことが可能になります。 参考URL：http://osb.sra.co.jp/PostgreSQL/Manual/PostgreSQ …
とりあえず、思いつくのは、 テーブルを作るのもSQL を発行すれば良いのですから、データベースに接続した後で、"create table ..." のSQLを実行すれば良いと思います。 SQL のCreate table に関しては、検索すれば出てくると思いますので、ここでは説明しませんけど。 $con = pg_connect ("host=*** port=5432 dbname=*** user=*** password=***"); pg_exec ($con, "create table ..."); こんな感じでいいと思います。
>ODBCデータソースアドミニストレータの設定ですが、ユーザー名とパスワードの関係はどうなっているのでしょうか？ PostgreSQLのユーザ名とパスワード（createuserとかで設定したもの）を指定します（確か） >そのユーザーはWindows側にも登録されていなければならないのでしょうか？ その必要はないはず。 >home/postgres/.bashrc に対して、次のように設定するように書かれている場合が多い これはTurboLinuxServer8でrpm版を使っているの場合不要です。 （/var/lib/pgsql/.bash_profileにかかれています） >参考書とかWEBとかの内容と違っている おそらく参考書やWEBはソースからインストールすることを想定しているんでしょう。 rpmの場合、rpmを作ったところの設定しだいでファイルのpath等が変わるので、その辺はさっぴいて考える必要があります。
pg_dumpやpg_dumpallでファイルにダンプして そのファイルをpsqlで別サーバのデータベースに 流し込んでやればＯＫと思います。 コマンドの使用方法は参考URLの５項参照ください。 ダンプする範囲に応じてpg_dumpallを使用したり pg_dumpにオプションをつけてやったりしてくだ さい。 参考URL：http://www.itnavi.com/PGSQLsiyou5.htm
JavaでPostgreSQLにアクセスするには、JDBCドライバの役割を果たすpostgresql.jarというJavaアーカイブファイルが必要だったはずです。 postgresql.jarはPostgreSQLをインストールしたときに自動的に生成されているはずですので、このファイルを環境変数CLASSPATHに設定してみてください。これが設定されていないと、プログラムの実行時にClassNotFoundExceptionが発生します。 ただ、PostgreSQLのバージョンによっては、PostgreSQLのインストール時に生成されたpostgresql.jarではうまく動作しないことがあります。その場合は、そのバージョンに適合するファイルを別途入手する必要があります。
date_part関数の返り値はintegerでは ないのでcastが必要になります。 SELECT CURRENT_DATE - DATE_PART('DAY',CURRENT_DATE)::integer
参考にされたkei3の方は10.2.6、その元であるentropyで配付しているパッケージ(.pkg)は10.3を前提にしています。 私はソースから自前でコンパイルしてPostgreSQLをインストールしたのでよくわかりませんが、libsslのパージョンは0.9でした。 entropyの説明では10.2では「最新のupdateを施してください」と注意書きが有ります。試してだめならソースからコンパイルすべきでしょう。 テキスト形式であるソースをコンパイル(ビルド)してバイナリとし、ウイザードにしたがってインストールできる形式(パッケージ)にして配付という手順なのですが、ソースをコンパイルするということはそのコンパイルした環境でのみ動作が保証されるという点について注意しなくてはいけません。つまり今回の質問のように必要なライブラリが見つからないという例外などが発生します。この先バイナリ(パッケージ形式)でインストールするときは注意してください。
今晩は。すごいお礼ですね。 >そのdb名では存在しないのでしょうか？ 残念ですが、postgresqlのデータベースは データベース・テーブルなどが全て数字名のファイル になっていて、lsコマンドで見ても判りません。 少なくともbaseディレクトリ配下の数字名のディレクトリが createdbで作ったデータベースに相当します。 どのデータベースがどの数字のディレクトリかは、 pg_database というシステムカタログを見れば判ります。 たとえばzaikoというデータベースを作ってみます。 $ createdb --encoding EUC_JP zaiko <ENTER> $ psql -l <ENTER> 　　　　List of databases Name　　　|　Owner　　| Encoding -----------+----------+---------- template0 | postgres | EUC_JP template1 | postgres | EUC_JP zaiko　　　| postgres | EUC_JP $ psql zaiko <ENTER> zaiko=# select oid,datname from pg_database ; <ENTER> 　oid　|　datname -------+----------- 16977 | zaiko 　　 1 | template1 16975 | template0 (4 rows) zaikoというデータベースのOIDが「16977」になっています。 「base」ディレクトリ配下の「16977」ディレクトリが 「zaiko」と言う事です。
windows版は知らないですが >linux版でも同様にログインは誰でも可能なのか？ 出来ないです。 とりあえず、テーブル作成等してみて 所有者が誰になるのか確認してみては？ linux版の場合、設定にもよるのでしょうがデフォルトでは 登録されているユーザー以外でlinuxにログインしpsqlを実行すると 「ユーザーが見つからない」といったエラーが表示されます。 oracleの場合デフォルトでは OSとDB、それぞれユーザー管理が異なりましたが linux版postgresqlのデフォルトでは postgresがlinux上のユーザーにdbの使用許可を 与える。といったものでした。
shard_buffers,sort_mem...等のサイズ（値）に問題は ないでしょうか？ shard_buffersでいえば、当然ですが、OS全体で確保できる共有メモリサイズには上限があるので、共有メモリはPostgreSQL以外のソフトウェアも使用するのだから、システム全体の共有メモリ使用量が上限を超えないようにしなければなりませんよね！ また、設定値に 8192 Byte を掛けた数が確保されるメモリ量の概算になり（実際にはもう少し多くなります）、max_connectionsの値を２倍した値以上の数値を設定しなければなりませんがその辺りはいかがでしょう？ それぞれの項目に正しい値を設定しないと、エラーで起動できなくなるとう現象は、実際経験しています。 試算程度で、適当な値を設定すると、痛い目をみます。 あと、起動、停止、再起動について、pg_ctlコマンドでも確認してみるなども、試してみたらいかがでしょうか？ 以下のＵＲＬは、一部参考になるかもしれませんので、ご覧になられると良いかもしれません。 参考URL：http://www.awavetech.com/listmanager/docs/howto/ …
パターンマッチのメタ文字に「*」、「?」を使用するのは、私の知る限り、DAO + Jet だけです。 他のDBMSでは、「%」、「_」を使用するのが一般的です。 (Jetの場合でも、ADO + OLEDB接続のときは「%」、「_」を使用) 要するに、文法は土俵によって変わる、ということ。
linuxアカウントではないhogeさんを作ってみましたが、特に、問題ありません。 [postgres]$ psql -l List of databases Name | Owner | Encoding -----------+----------+----------- postgres | postgres | SQL_ASCII template0 | postgres | SQL_ASCII template1 | postgres | SQL_ASCII (3 rows) [postgres]$ createuser hoge Shall the new user be allowed to create databases? (y/n) y Shall the new user be allowed to create more new users? (y/n) n CREATE USER [postges]$ psql -U hoge postgres Welcome to psql 7.3, the PostgreSQL interactive terminal. Type: \copyright for distribution terms \h for help with SQL commands \? for help on internal slash commands \g or terminate with semicolon to execute query \q to quit postgres=>
リングサーバのサイトインデックスから検索画面に進めます。 「FTP クライアント用ファイル検索コマンド」とありますが、 下半分の表の「WEB 上の検索インターフェイス」から お好きなミラーを選んでクリック、「ファイルの取得手段」で HTTP にチェックして 「postgresql」で検索すれば HTTP プロトコルでダウンロードできます。 参考URL：http://www.ring.gr.jp/ring/siteindex-j.html
質問の真意を理解せず回答してしまいました。ORCA_Hさん、すいません。 ツールはシェルで作成するのでしょうか？ 以下の方法でテーブル有無は調べることは可能ですので、 シェル内でDROPするかどうか制御してはどうでしょうか。 ・pg_classテーブルのrelnameカラムが"test"のレコードがあるか ・\dでテーブルtestが表示されるか 単純にメッセージ（エラー／正常問わず）出さないというのであれば psql -f test.txt > /dev/null 2>&1 ということになりますが...一番簡単ですが乱暴ですね...
あと、 以下のＵＲＬをご覧ください。 自分のＰＣ開発環境では、REDHAT7.2 & postgresql-7.2.1できちんと動作しています。 http://www.postgresql.jp/ のダウンロード情報、日本語ドキュメントを参考にしてください。
＞一つのフィールドのみ空の場合には上記の処理では行数を拾ってしまい ＞データのないフィールドをpg_resultするとエラーになってしまうのです。 それは変ですね。ひょっとして設定でそういう風にもなるのかもしれません。 ちなみにちょっと調べたところ、エラー表示を抑制するには、関数の前に＠をつければいいみたいです＞PHP @pg_result という形ですね。試してみてください。
なかなかレスがつかないようなので、ご存知かと思いますがPostgreSQLのユーザ会で管理されているマニュアルなどを参照されてはいかがでしょうか？ 参考URL：http://www.jp.postgresql.org/
