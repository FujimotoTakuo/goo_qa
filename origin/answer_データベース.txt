SQLSERVERということであれば、LEFT JOINの代わりにOUTER APPLYを使ってクエリを簡単にする手もあります。 速度はデータにもよりますが、LEFT JOINより早いようですね。 相対コスト（LEFT JOIN 82：OUTER APPLY 18） DECLARE @TA TABLE (id INT NOT NULL PRIMARY KEY,item VARCHAR(30),quantity INT) INSERT INTO @TA VALUES(1,'商品1',10),(2,'商品2',20),(3,'商品3',30) DECLARE @TB TABLE (id INT NOT NULL PRIMARY KEY,item VARCHAR(30),price INT,saledate DATE) INSERT INTO @TB VALUES(100,'商品1',100,'2016-08-10'),(101,'商品1',110,'2016-08-11'),(102,'商品3',200,'2016-08-12') SELECT TA.item,TA.quantity,TB.price,TB.saledate FROM @TA as TA OUTER APPLY( SELECT TOP 1 * FROM @TB as TB WHERE TA.item = TB.item ORDER BY TB.id ) as TB
この辺で一時期勉強しました http://www.geocities.jp/mickindex/database/idx_d …
テキスト型の比較では "10" < "2" ですからね。 伝票番号フィールド を 数値型にすれば問題ないんですが、 それじゃダメなの？
商品マスター内の単価を増やした場合、将来的に4つ以上になった時に 対応ができなくなり、再改造を迫られる事になります。 ＞商品マスターの単価を都度替えてしまうと、前月の売り上げ金額等が ＞合わなくなってしまう そもそも上記の状態になるのなら、商品マスター内の単価を増やしても 商品マスター内の単価を変更すれば同じ結果になるので、根本的な解決 にはなりません。 前月の売上金額を集計するには、売上明細に単価を追加し、集計時には その単価を使う様にすべき。 ＃集計毎に、数量・単価から金額計算するのではなく、売上明細の金額 ＃(計算済み)を利用するのも可 同一の商品が複数の単価を持つ場合、[商品コード][単価区分コード]を キーにした、商品単価区分マスターを使うという方法も有ります。 ＃単価区分コード=0の場合は、商品マスターの単価を使用。 上記の変更ができるかどうかは、既存のシステムがどの様に作られて いるか及び、改修担当者に変更できるだけの能力があるか次第。
構造が見えてこないですが素直に読むと (フラグ1='a')*金額1+(フラグ2='a')*金額2+(フラグ3='a')*金額3 もしフラグと金額で更正されてるテーブルなら select sum(金額) from テーブル　where フラグ='a'
MySQLへのアクセスはなにを使ってるの? mysqlクライアント、phpMyAdmin、ODBC経由、 その他なにかプログラム経由? 具体的なSQL文もあわせて提示してください
カスタマイズを選ぶと一つのバイオームしか生成できません。 草ブロックの上に、水を敷いて生成させる方法ならあります。 ~~~~~~「-------------------- | 海 |　　　岸 | ________ |_______________ このように生成させる方法はありません。 海バイオームで草原にするという方法はあります。 詳しいことはwikiで。 http://minecraft-ja.gamepedia.com/%E3%82%B9%E3%8 … https://www.google.com/search?q=Minecraft+%E3%83 …
それから、シートにある　在庫　ですが データとして不要です。 在庫数＝SUM(生産数）－SUM(販売数）の関係にあるので 必要に応じて計算できます。 データ集計プログラム（パッケージ品）が何なのかわかりませんが エクセル自体が集計ソフトですので どうせ考えるならエクセルで集計するプログラムを考えた方が 今回、考えておられるテキストファイルへ出力プログラムより よっぽど簡単だと思いますよ。 その昔に決めた書式・ルールにこだわるため、どんどん複雑にしてしまった。 エクセルを昔の表を作成できるワープロ版の考えから脱皮できていない。 こんな感じを受け取るのですが？？
>>論理削除とは、boolean型のdeleted_atみたいなものをつけて、trueなら、存在する。falseなら、存在しない(物理的には、存在し、中身はNULL)みたいな事。と認識しているのですが、合っているでしょうか？ >>deleteではなく、trueの場合のデータを0か、NULLで上書き→falseにする。 >>という感じで良いでしょうか？また、not nullのフィールドが存在した場合、0を、それ以外はnullを突っ込むという感じですか？ あくまで開発／実装方法のひとつなので断言はできませんが、業界でよく耳にする論理削除の意味とはずれています。 ・論理削除されたデータの中身をあえてNULLにしたりはしません（だいたいは元のまま）。 ・select時やupdate時にwhere句で論理削除済データを除外して、存在しないものとして扱います。 >>そして、insertの場合、idが自動付番の場合で、10番まで存在し、5番までは、true。6以降はfalseの場合、新しい行を追加するとき、6番目に追加、(update)するのですか？それとも、11番目にcreateするのでしょうか？ idが自動付番の場合は11番目に追加することが多いですが、現場によります。
チェックをすることでTODAYではなくその日の日付を入れるならマクロになります。 マクロでもいいならどなたか回答がくるかも知れません。 私はマクロは使わないので、提案するなら例えばマウス操作ならいけるのでしたらどこかの別セルにTODAY関数を入れておき、入力規則のリストでそのセルを参照しておけばプルダウンの候補に常に当日の日付がでて選べばその日付が入ります。
> デザイングリット(?)でする作業で対応したいと思っています。 この条件があるから回答が付かないのでしょう。 テーブル構造に問題 があるのですが 構造を変えずに、ということなら 「ユニオンクエリ」でということになります。 デザインビューではできませんが、この場合なら簡単です。 探せばネットに同じような例がころがっていると思われます。
すみませんなんか違う SELECT id FROM sample GROUP BY id HAVING count(distinct type) = 3 とするとユニークなtypeが拾えます
サーバにクライアントもインストールが分かりませんが、とりあえず EZCONNECT を試してください
連鎖参照整合性制約の事ですか？？？ http://msdn.microsoft.com/ja-jp/library/aa933119 … 上のURLの説明を読んでください。 前提条件として、外部キーが設定されている事とCREATE TABLE（もしくはALTER TABLE）でREFERENCES句に"ON DELETE"、"ON UPDATE"が設定されている必要があります。 マスターデータを削除したら、それに関連するデータも同時に削除される設定です。こうしておかないとエラーとなります。 ALTER TABLEで外部キーを設定して、同時にREFERENCES句に"ON DELETE CASCADE"を追加すれば行けると思います。
テーブルの作り方に問題があります。 店舗名　商品名　価格、、、 というテーブルを作り、 価格表は、クロス集計クエリなどで表示すべきです。
普通は動くはずですけど、リンクテーブルのデータ型が変わっちゃっているのかな？ その場合は、クエリを修正する必要があるかもしれません。
おそらく、出題者が求めている結果は下記でしょう。 書籍コード　　total 1001　　　　 54000 1234　　　　 25000 その為には、GROUP BY と SUM() と AS を使います。 ＞ 新しくtotalという列を作り、20000円以上のコードとともに表示するという意味らしいです。 AS を使えと言う意味でしょう。 これまでに習ったことを理解して覚えていれば簡単に解けるはずです。それができないと言う事は、問題を解く前に、復習をすべきでしょう。 ＞ 抜き出した合計を列名totalとともに表示しなさい。 この記述が曖昧だから他の回答者のように迷いますが、授業を受けていればこれまでの経緯で理解できるはずです。
リンクテーブルを使うのが一番幸せな方法。 ローカルの DB 内には外部 DB のテーブルへのリンク情報が保存される。 フォーム、クエリ、レポート、VBA コードなどからは、ローカルの DB にあるテーブルも、リンクテーブルも、どちらも違いなく扱えるというメリットがある。 ODBC を媒体にして VBA コードから外部 DB へ接続し、レコード群のやり取りだけを行う方法も可能だが、自由度は減る。 ユーザー側にある Access の DB にはユーザーが操作するフォームやレポートがあるわけだが、これらとデータの仲介が全て VBA コードによる処理となるため、"非 VBA" で接続する方法がとれない。 具体的には、フォームやレポートのデザイン画面でレコードソースを設定することができなかったり、Access 側のクエリが使用できなかったりする。 UI とデータをそこまで分離させようとするのであれば、Access じゃないほうがもっと便利に開発できるんじゃないか？ と個人的には思う。 Visual Basic 2015 Express とかのがもっと本格的に、もっと自由に開発できる。 VBA のコードで作成した DAO または ADO の Reocordset オブジェクトをフォームの Recordset プロパティに設定して読み書きするためのサンプルは下記を参照。 https://msdn.microsoft.com/ja-jp/library/office/ … DB からデータを取得したり、DB のデータを更新する部分は SQL 文を中心に処理することになるかと思います。 データを更新する場合は SQL Server 側に作成したストアド プロシージャーを VBA から呼び出して適切な更新値を与えてあげるやり方が主でしょうかね。 「ADO SQL Server」 あたりで検索していくと調査がはかどると思います。
① -- 全件取りたいなら SELECT A.ID FROM sample A WHERE 2 <= (SELECT COUNT(B.ID) FROM sample B WHERE B.ID = A.ID AND B.type IN ('A', 'B') ) -- 1件だけ取りたいなら SELECT A.ID FROM ( SELECT A.ID FROM sample A GROUP BY A.ID ) A WHERE 2 <= (SELECT COUNT(C.ID) FROM sample C WHERE C.ID = A.ID AND C.type IN ('A', 'B') ) ② -- A, B, C以外もあるなら、 B.type IN ('B', 'C')の部分を -- B.type NOT IN ('A')に変えてもいいけど、 -- フルスキャンになると思うので、DやEまであっても、 -- 極力下記の形でIN句の中にDやEも追加する SELECT A.ID FROM sample A WHERE A.type = 'A' AND NOT EXISTS ( SELECT B.ID FROM sample B WHERE B.ID = A.ID AND B.type IN ('B', 'C') ) 先の回答の方法でもできるのでしょうが、HAVING、DISTINCTはデータが大量にあるとコストが高いです。 適切なプライマリーキー、インデックスを生成の上、データ量およびコストをそれぞれ実行計画をもとに確認し、最適なクエリを実装することをおすすめします。 どれが最もパフォーマンスがでるかは、データ量にも依存するので、一概にどういったクエリが正解となるかは難しいところです。
Access2002での実現方式がわかりませんので何とも言えませんが、マイクロソフトのサイトにある以下の情報が参考になるように思います。 https://support.office.com/ja-jp/article/Access- … 　で。基本的にはデータの参照を行うテーブルと、データの追加・更新・削除を行うテーブルを完全に分離しかつ、後者につては接続ユーザごと（端末ごと）にテーブルを分けることです。これが確実です。 　それが出来ない場合はAccessへの（少なくとも）追加・更新・削除を行う端末側からの要求を一手に受けるプログラムを作成し、これが各ユーザ（端末）からの要求を受けて処理するというプログラム構成に変更することです。 　サーバープログラムを1つ作成し、各端末はAccessに接続して処理要求するのではなく、このプログラムに接続して処理要求することになるのでかなりの改修＆新規開発ですね。 　SQL Serverを入れるのが早いと思います。機能を制限した無料版があったかな？ 　えっとExpressなら無料です。SQL Server 2016 Expressですね。 　もしくはMy SQLなどに乗り換えるか。。。 参考まで。
まずクエリの考え方が間違っています。 クエリとは、実態を表示する方法であり、入力を簡単にするものではありません。 あなたが参考にしている本やサイトは、クエリを使って入力させてるの？
ページヘッダーの部分は文字だけでは状況がよくわからないので 回答は控えさせていただきます。 レコードの抽出についてですが レポートのレコードソースになっているクエリで条件を指定します。 フォームにIDがあるのであればクエリの抽出条件に =[Forms]![メインフォーム名]![ID] とすれば該当のIDのレコードのみになると思います。 http://oshiete.goo.ne.jp/qa/2114831.html
Oracle Database 12c。 SQRって知らん。 12Cってでたの？ 11gしか知らんかった。
もしかしたらパーティショニングすれば汎用テーブルを共有して 利用する際に役にたつかもしれません。 https://dev.mysql.com/doc/refman/5.6/ja/partitio …
なお、ACCESSでLEFT JOINを複数利用する場合、()で括ってやらないとダメなようです。 SELECT 顧客マスタ.* , 問合せ履歴.* FROM ( 顧客マスタ LEFT JOIN 問合せ履歴 ON 顧客マスタ.顧客ID = 問合せ履歴.顧客ID ) LEFT JOIN ( SELECT MIN(問合せ履歴.登録日) , 問合せ履歴.顧客ID FROM 問合せ履歴 GROUP BY 問合せ履歴.顧客ID ) AS T1 ON 顧客マスタ.顧客ID = T1.顧客ID ただし、このクエリでは、T1内に存在する顧客IDが合致するものすべてを抽出してしまうので、1顧客IDに対して複数レコードを抽出してきてしまうため、間違いです。
作業をする際に、別MDB？のリンクテーブルを作ったなら、 もともとの状態に戻さないと、ダメだろうね。 まあ、現地に持っていったら、また、 ＞サーバのAccessデータベースが存在しないので、そのサーバのデータベースをリンクするようにAccessから指示され、リンクさせて動作させています。 になると思う。 　 頻繁にそのような作業が発生するのであれば、DAO(もしくはADOX)で、リンク先を変更するコードを書いておけば、メンテナンスは楽になると思う。 http://vba-geek.jp/blog-entry-104.html https://support.microsoft.com/ja-jp/kb/230588
連番が変化しない方がいいと思いテーブルに連番を作成する方法を回答したのですが クエリで行いたいならこちらを参考に作成してみてください。 http://www.relief.jp/itnote/archives/003569.php
>今考えていることは >テキストボックスコントロール/ラベルコントロールのクリック時イベントなどに >文字色を淡く/濃くなどと切り替えて、 >実際に作業する人には「淡い文字の所は無視してね」としてもらう・・・ >ダメですかね？ 作業工程の段階を何処かに保存する必要があるでしょうから、ダメでしょう。 没 にしてください。 すみません。
>>どなたか詳しく説明していただけないでしょうか？ それよりも、質問者さんが、データベースを「詳しく勉強されること」が必要だと思います。 >>なぜ、やりたいのかと言うと、レポート出力を使いたいからです、初心者なもので レポート出力で条件のみが印刷出来れば言うこと無いのですが この程度のことができないなら、本当に勉強不足ですよ！！
>商品名と件数が、構造上、離れてしまいます。 これは商品名と件数を配置している詳細セクションの高さが大きいからでしょう。 _________________________________________ ↓詳細 _________________________________________ となっている帯部分を選択するとそこのプロパティに切り替わります。 取りあえず、１cmくらいにしてみてください。 最終的（暫定）には、 売上日範囲の指定、 複数の顧客の確認書？をそれぞれ印刷。 のようですね。 何故、似たような質問を二つに分けたのか分かりました。
2016/7/4　 100 　　りんご 2016/7/4　 100 　　りんご 2016/7/4　 200 　　みかん 2016/7/5　 200 　　みかん 2016/7/5 　200 　　みかん これから得られるのは個数というよりも件数ですね。 売上日　 商品CD　 商品名　 個数 2016/7/4　 100 　　りんご　 10 2016/7/4　 100 　　りんご　 5 2016/7/4　 200 　　みかん　 20 2016/7/5　 200 　　みかん　 10 2016/7/5 　200 　　みかん　 15 で考えると SELECT Ｔ０１売上データ.売上日, Ｔ０１売上データ.商品CD , Count(Ｔ０１売上データ.商品名) AS 件数 , Sum(Ｔ０１売上データ.個数) AS 商品数計 FROM Ｔ０１売上データ GROUP BY Ｔ０１売上データ.売上日, Ｔ０１売上データ.商品CD HAVING (((Ｔ０１売上データ.売上日)=[いつの？])); というSQL文で 売上日　 商品CD　 件数　 商品数計 2016/07/04　 100　 2　 　 15 2016/07/04　 200　 1　 　 20 となります。 添付図は上記SQL文のデザインビューです。 リボンのΣ集計アイコンから始めてみては？
仮にこうします //データ作成 create table tbl (id int not null unique,name varchar(10)); insert into tbl values(1,'山田 太郎'),(2,'山田中 二郎'),(3,'山田山 三郎'),(4,'佐藤 一郎'),(5,'佐藤 次郎'),(6,'鈴木 一朗'),(7,'山田 太郎'); この場合、前二文字が同じの「山田」と「佐藤」を抽出する場合こうなります select * from tbl where substr(name,1,2) in( select substr(name,1,2) as x from tbl group by x having count(*)>1 ); 完全一致の「山田 太郎」のみ抽出したいならこう select * from tbl where name in( select name from tbl group by name having count(*)>1 );
クエリデザインで「元テーブル」、「参照テーブル」を追加 クエリの種類で更新クエリを選択 「元テーブル」の「ID」と「参照テーブル」の「ID」を結合 フィールド：登録日 テーブル：元テーブル レコードの更新：[参照テーブル].[登録日] フィールド：退会日 テーブル：元テーブル レコードの更新：[参照テーブル].[退会日] フィールド：登録日 テーブル：参照テーブル レコードの更新： 抽出条件：<=[元テーブル].[利用日] フィールド：退会日 テーブル：参照テーブル レコードの更新： 抽出条件：>=[元テーブル].[利用日] Or Is Null クエリを保存し実行すればできると思います。 バックアップを取ってから実行してください。
回線の状態、プログラムの内容、データ更新の量などによりますので一概に言えないでしょう。 数件のデータ更新ならおそらく問題ないと思いますが、数十万件の更新だと話にならないとかは十分ありえます。 実際にはやってみるしかない。
何をやっても遅いのか、たまたまそのSQL文が遅いのか 具体性がないのでなんとも言えません。 sshで接続してmysqlクライアントで実行した場合は総じて高速ということなのでしょうか？ 特定のSQL文が遅いのであれば、インデックスの付け方が間違えています 全般的に遅いのであれば、SQL実行前のデータ渡しもしくは SQL実行後のデータの吐き出しが遅いかもしれません そうなると、apacheやらサーバー側の問題なので管理者への問い合わせになると思います
では以下のとおり確認ください。 //とりあえずその期間のデータの全日程をとるためt2テーブルを作る CREATE TABLE t2(d DATE UNIQUE); //プロシージャを設定 DROP PROCEDURE IF EXISTS modify_t2; DELIMITER // CREATE PROCEDURE modify_t2() BEGIN TRUNCATE t2; SELECT @a:=MIN(DATE_FORMAT(created,'%Y-%m-%d')) from t1; SELECT @b:=MAX(DATE_FORMAT(created,'%Y-%m-%d')) from t1; WHILE @a<=@b DO INSERT IGNORE INTO t2 VALUES(@a); SET @a=@a+INTERVAL 1 DAY; END WHILE; END // //プロシージャを呼び出し CALL modify_t2(); ※この時点で2016-07-10~2016-07-18のデータができている //結果表示 SELECT t3.week,COALESCE(t4.count,0) AS count,COALESCE(t4.count,0)/t3.week_count AS AVE,t3.week_count FROM( SELECT DATE_FORMAT(d,'%w') AS week,COUNT(*) AS week_count FROM t2 GROUP BY week ) AS t3 LEFT JOIN ( SELECT DATE_FORMAT(created,'%w') AS week,COUNT(*) AS count FROM t1 GROUP BY week ) AS t4 ON t3.week=t4.week;
No.1です。 > 余り、参考にはなりませんでしたが。 　なるほど。 　それは、、、 > 今は、Access,perlのdbd:mysql,myslを使っていますが。 > 今は、例えばスーパークラスを使ってのインスタンス > でのデータベースを考えているのですが。 とお思いなのに、、、 > > オブジェクト指向データベースを始めたいが、どう言うのが有るのでしょうか。 と質問されたのが原因です。 なので、それを当方に「余り、参考にはなりませんでしたが。」と言われても。。。:-) ちなみに「現状」があるということは、おやりになりたいのは本当にオブジェクト指向データベースの利用ですが？ 「オブジェクト指向言語で既存のデータベースを使用したい」のではなく？ いずれにしろ頑張って下さい。 では。
パラメータが表示されたのは指定したフィールドがないからです。 テーブル名とフィールド名を使用している名前に変更してください。 InStr関数は ある文字列 (string1) の中から指定された文字列 (string2) を検索し、最初に見つかった文字位置を返す文字列処理関数です。 InStr(string1, string2) やっていることはテーブル受付データBの②（住所）の中からテーブルマスタAの③（住所）を検索し 文字列がある位置を出しています。 必要なのは文字列が含まれているデータのみなので条件を>0としています。 試しにInStrの部分をなくしてクエリを実行してみてください。 「テーブルマスタA」のレコード数*「テーブル受付データB」のレコード数のデータが表示されるはずです。
はい良くわかりました。 前回回答と重複する部分がありますが一通り説明します。 念のため、ファイルのバックアップコピーを取ってからにしてください。 １・レポートをデザインビューで開きレポートヘッダーにテキストボックスを配置。 ２・プロパティシートを開き、このコントロールのコントロールソースに、=[いつ受付？] ３・コントロール名を、その他タブにある名前欄から、Txtパラメータ と変更。 ４・書式タブから、可視 を いいえ に変更。 一旦保存します。これからはVBAの記述です。 レポートは閉じてください。 Alt + F11 を押してVBEを立ち上げます。 今後のこともあるので変数の宣言を強制するようにしてください。 メニューのツール→オプション→編集タブの「変数の宣言を強制する」のチェックを入れてください。 http://officetanaka.net/excel/vba/beginner/06.htm Option Explicit が自動的に新しいモジュールに付与されます。 「自動構文チェック」のチェックは外しておいた方がうるさくなくて良いかも？←ご随意に。 メニューから挿入→標準モジュールにてその宣言部に Declare Function apiIsWindowEnabled Lib "user32" _ Alias "IsWindowEnabled" (ByVal hWnd As Long) As Long そのレポートのモジュールには Dim IsPrintOut As Boolean Dim IsPreview As Boolean 上二行は宣言部に Private Sub Report_Activate() IsPreview = True End Sub Private Sub レポートヘッダー_Format(Cancel As Integer, FormatCount As Integer) IsPrintOut = (apiIsWindowEnabled(Me.hWnd) = 0) End Sub Private Sub Report_Close() dim sSql as String '更新クエリのSQL文 on error goto errH sSql="UPDATE テーブルA SET 発送年月日=#" & date & "# WHERE 新規受付日=#" & Me!txtパラメータ & "#" If IsPrintOut Then currentdb.execute ssql,dbfailonerror Else 'MsgBox "プレビューのみです。" End If exit sub errH: debug.print err.number,err.description msgbox err.description & "が発生しました。発送年月日は更新されません。" End Sub 最後にメニューからデバッグ→○▽□のコンパイルを行ってエラーが出ないことを確認。 これで大丈夫かと思います。多分。 前回回答でおバカなことをしていました。すみません。
strPath = "" 　 を rst.close: Set rst = Nothing exit sub の2行に置きかえれば、 そのまま、終了する。 最後の close #1の後にも、 rst.close: Set rst = Nothing と書いておいたほうが、お行儀良いかも。
私の環境(windows10, office2007pro)では、 Application.FileDialog(msoFileDialogFolderPicker) を改行した段階で、 The library which contains this symbol is not referenced by the current... というmsgboxが出てきて、「はい」をクリックすると、 microsoft office 12.0 object libraryの参照設定にチェックが入ります。 ので、VBAエディターの「ツール」「参照設定」で microsoft office 12.0 object library にチェックを入れて、OKを押すと動くようになるのではないかと思います。
レポートを開く前にdcountでレコード件数を調べ レコードがあればレポートを表示、レコードがなければメッセージを表示し終了
サンプルです。 Sub Sample() 　　Dim i As Integer 　　Dim strSQL As String 　　Dim dbs As DAO.Database 　　Dim rst As DAO.Recordset 　　Dim OutData As String 　　Dim kind As String 　　strSQL = "SELECT * from test ORDER BY 種類, 連番" 　　Set dbs = CurrentDb 　　Set rst = dbs.OpenRecordset(strSQL, dbOpenForwardOnly) 　　kind = "" 　　OutData = "" 　　Open "C:\Sample\output.csv" For Output As #1 ' 出力モードで開きます。 　　With rst 　　　　Do While Not .EOF ' レコードが無くなるまで繰り返します。 　　　　　　If !種類 <> kind Then 　　　　　　　　If OutData <> "" Then 　　　　　　　　　　Print #1, Mid(OutData, 2) 　　　　　　　　End If 　　　　　　　　kind = !種類 　　　　　　　　OutData = "" 　　　　　　End If 　　　　　　For i = 0 To .Fields.Count - 1 　　　　　　　　OutData = OutData & "," & .Fields(i) 　　　　　　Next 　　　　　　.MoveNext 　　　　Loop 　　　　If OutData <> "" Then 　　　　　　Print #1, Mid(OutData, 2) 　　　　End If 　　End With 　　Close #1 ' ファイルを閉じます。 End Sub
図示されたようなテーブル設計はよくありません。 もしかしてクロス集計クエリから作成したテーブル？ それとも、他からインポートしたデータ？ 欠点は、 日にち分のフィールドが必要、 月が替わると再度テーブルを作り直す必要がある、 かといって年間（365日）分だけ作るのも不可。フィールド数は最大でも255まで。 集計などの分析が困難など後々泥沼に。。。 http://www.accessdbstudy.net/entry/20140915/p1 商品名 日付　　　　価格 イチゴ　2016/07/01　200 イチゴ　2016/07/03　400 イチゴ　2016/07/04　400 バナナ　2016/07/02　100 バナナ　2016/07/03　150 メロン　2016/07/01　200 メロン　2016/07/02　150 メロン　2016/07/03　100 メロン　2016/07/04　120 メロン　2016/08/01　200 のようなデザインであればクロス集計で、 テーブル名をT1とするとSQL文は、 TRANSFORM First(T1.価格) AS 価格の先頭 SELECT T1.商品名, (DMax("日付","T1","日付 Between #2016/7/1# And #2016/7/31#")-DMin("日付","T1","日付 Between #2016/7/1# And #2016/7/31#")+1)- DCount("日付","T1","日付 Between #2016/7/1# And #2016/7/31# and 商品名='" & 商品名 & "'") AS 売切回数, Int(Avg(T1.[価格])+0.5) AS 平均価格, Max(T1.価格) AS 最大価格 FROM T1 WHERE T1.日付 Between #2016/7/1# And #2016/7/31# GROUP BY T1.商品名 PIVOT Format(T1.日付,"mm/dd"); 　で、 商品名　売切回数　平均価格　最大価格　07/01　07/02　07/03　07/04 イチゴ　　　1　　　　　333　　　400　　200　　　　　　400　　400 バナナ　　　2　　　　　125　　　150　　　　　　100　　150 メロン　　　0　　　　　143　　　200　　200　　 150　　100　　120 のようになります。 新規クエリをSQLビューに切り替えて上記のSQL文を貼り付けてみてください。 平均価格は四捨五入しています。 デザインビューに切り替えられますので確認してみてください。 売切回数を求める部分の出来が良くありません。 レコード数次第では遅くて使い物にならないかも？ご参考まで。
オンプレの更新頻度やクラウドの参照頻度によりますが、 そもそもオンプレのデータをクラウドからプルするのはセキュリティ的にどうかと思います オンプレ側からプッシュする方式がよいのではないでしょうか？ 同じ種類のSQLサーバーであればリプリケーション機能があったりしそうですが 無理ならとりあえず、SQL文ベースでのダンプとインサートができるか確認し、 無理ならCSVなど汎用テキストで受け渡すことになると思います 本来はEDIなどかまして所定の入出力形式のすり合わせをしておくのでしょうけどね
MicrosoftR SQL Server 2016 Express https://www.microsoft.com/ja-JP/download/details …
決済日-レートのテーブルに開始日というフィールドを付け加えるのが楽です。
ご存知かもしれませんが 名前の自動修正オプションを設定する https://support.office.com/ja-jp/article/%E5%90% … より引用 『名前の自動修正で修正されない対象 名前の自動修正では以下のものは修正されません。 フォーム、レポート、またはコントロールの名前の変更は追跡されません。 マクロ内またはコード内のテーブル、クエリ、またはフィールドの名前は修正されません。』 ですので残念ながら有りません。 どこでコントロール名が使われているか調べるときに リボンのデータベースツール→データベース構造の解析を選択 必要な個所にチェック・オプションの設定を行って[OK] 印刷プレビューが立ち上がるので、リボンのテキストファイルをクリック 適当な名前で保存しメモ帳などのテキストエディタで開き検索。 としたことはあります。
質問文からは全項目において重複している行はないように見えますが。（販売日、価格が違うので） これぐらいは自分で調べる癖をつけた方がいいですよ。 「Access　重複　削除」で検索すればたくさん出てきます。
私が使っていたのは10年以上前なので忘れてしまっています。 バックアップデータがあれば戻せばいいと思いますが。 こちらで質問してみては？ http://windom.bbs.coocan.jp/?m=listtop
インデックスは残したいレコードのものを選んだグループ化したリストを作り、本番側と結びつけ、グループ化したインデックス以外のレコードを選び出し削除する。 美しくないね。　これやるんだったら、普通にグループ化して、仮テーブルに書き出して、本番を削除した後、仮テーブルから戻すほうが、良いと思う。
決済日がテーブル名なのかフィールド名なのか紛らわしいのでテーブル名を決済日テーブルとしています。 決済日当日を含まない場合は条件式を変更してください。 DMin("決済日","決済日テーブル","決済日 >= #" & [販売日] & "#")
Columnで表示するとか http://tsware.jp/tips/tips_360.htm Dlookupで表示するとか http://www.accessclub.jp/samplefile/samplefile_1 …
考え方はほぼ同じでt2をt1のnameでしぼればよいでしょう SELECT sum(price) as price from t2 where id in ( SELECT max(t2.id) FROM t2 inner join t1 on t2.t1_id=t1.id and t1.name='a' group by t1_id )
こんな風では？ Function myMin(ParamArray aryX() As Variant) As Variant Dim v As Variant For Each v In aryX If IsEmpty(myMin) Or IsNull(myMin) Or v < myMin Then myMin = v End If Next End Function クエリでは 最小値:mymin([A商店価格],[B商店価格],[C商店価格])*1
参考に。 Accessでのテーブルのエクスポート定義 http://waji-mart.com/homeandabroad/access%E3%81% …
SQL？ https://www.dondari.com/%E8%A4%87%E6%95%B0%E3%83 … http://raining.bear-life.com/mysql-2/insert%E3%8 …
Dim 行 As Long Dim END行 As Long Set Sh = ActiveSheet END行 = Sh.Range("A65536").End(xlUp).Row　’最終行 For 行 = 2 To END行 If IsNumeric(Sh.Range("A" & 行).Value) Then　’数値の場合のみ If Sh.Range("A" & 行).Value >= 3000 Then Sh.Range("B" & 行).Value = "A" ElseIf Sh.Range("A" & 行).Value >= 2000 Then Sh.Range("B" & 行).Value = "B" ElseIf Sh.Range("A" & 行).Value >= 1000 Then Sh.Range("B" & 行).Value = "C" Else '1000未満なら無処理 End If End If Next 行
Right("000000" & [項目1],6)
使ったことはありませんが、使えそうな気がします。 http://www.vector.co.jp/soft/dl/winnt/business/s …
#2です ためしたところ別名をつかわないと名前が競合しますね SELECT COALESCE(営業所区分,センター区分) AS 営業所区分2,SUM(数量) AS 数量 FROM 数量テーブル GROUP BY 営業所区分2 ORDER BY 営業所区分2
じゃあブラウザの表示がUTF８じゃないとか どの文字コードなら普通に表示できるのかわかりませんか？
更新クエリを作成しマクロまたはVBAで実行。 http://www.feedsoft.net/access/guide-query/guide … http://hamachan.info/win7/Access/message_d.html
より高い知識が必要ですね。 時間とはシリアル値で管理されているのはご存知ですか？ ま、それはともかく発想を変えてみましょう。 私なら登録時に、開始時間と終了時間から、勤務時間と休憩時間と時間外とを計算し、それぞれ登録しますね。 その方が楽ですよ。 時間も時間と分を分けて計算した方が分かりやすいです。
いまいち、何をされたいのかがよくわかりませんが、追加クエリで解決できるのではないかと思われます。
>他のテーブルは成功するのですが、 >一つのテーブルだけが、このエラー ということであればMySQL側のlogにエラーが残っているかと思います なんとも言えませんがアクセス権か何かの問題じゃないでしょうか？
回答の通り、抽出したファイルからの1行を、更にforで別ファイルを1行ずつ読んで(抽出したファイルから1行ずつ読むのと同様)、ifで比較ということです。 ただ、そういえばと思い出したんですが、findstr(回答のサイトにあります)を使えば、別ファイルを1行ずつ読む必要はないかもです。 比較はifではなくfindstrが行うことになるので、あったかなかったかはfindstrの結果から判断することになると思います。
集計した結果が例示の通りということ？ それとも生データ？ 数値の部分に番号という名前がついているということですよね？ select * from テーブル order by 番号 で問題ないですね。 具体的なSQL文を提示してみてください
これは、TwitterBrainのインストールが上手くゆかないという質問じゃありませんか？　 そのPHPプログラムの動作条件としてMySqlというデータベースが必要。PHPプログラムをサーバーに送信しるにはFTPが必要。 で、あなたは、サーバーにインストールはしたが、うまく動作しないために困った。。 で、なにがうまくゆかないのかの説明がうまく出来ていない状態です。 おそらく、売る側はポン付けで動かせるとしていると思いますが、それにはサーバーの条件ありませんか？ http://wxiaoy.com/category10/entry74.html また、PHPプログラムを改変することは許可されてますかね？
こちらが関係しているかもしれません。”#”をやめて試してみてください。 https://support.microsoft.com/ja-jp/kb/826763
なんのDBに対して、どういうクライアントでつないでますか？ ＞他の人に頼んでセッションを切ってもらってます。 とありますが、その人の使っているツールではだめなのですか？
無いでしょ。 accessはデータベースですからね。 無いと思うけどなぁ。
普通に作成できたので私にはこれ以上はわからないですね。 あやしいのはリレーションですかね？ コピーを取ってからリレーションを削除して変化があるか試してみるかですが。 参考までに 作成した設定などを載せておきます。 コンボボックスの名前は大分類、中分類、小分類として作成しています。 「大分類」 値集合ソース：SELECT DISTINCT 支店 FROM 支店工場テーブル; 値集合タイプ：テーブル/クエリ 連結列：1 「中分類」 値集合ソース：SELECT DISTINCT 支店工場テーブル.工場 FROM 支店工場テーブル WHERE 支店工場テーブル.支店=[大分類]; 値集合タイプ：テーブル/クエリ 連結列：1 「小分類」 値集合ソース：SELECT DISTINCT 支店工場テーブル.都道府県 FROM 支店工場テーブル WHERE 支店工場テーブル.支店=[大分類] AND 支店工場テーブル.工場=[中分類]; 値集合タイプ：テーブル/クエリ 連結列：1 Private Sub 中分類_Enter() 中分類.Requery End Sub Private Sub 小分類_Enter() 小分類.Requery End Sub
access Microsoft Web Browser でGoogleと幸せになれるかと。 https://www.google.co.jp/search?q=access+Microso … から http://tsware.jp/tips/tips_207.htm などなど。 フォームにコントロールを配置します。 フォームの読み込み時イベントには Private Sub Form_Load Me!WebBrowserコントロール名.Navigate2 "about:blank" End Sub として白紙状態で開くようにしておきます。 何かのイベントで（たとえばコマンドボタンとか何処かのクリック時など） Me!WebBrowserコントロール名.Navigate2 "C:\・・・・・\ほにゃ.html" とすれば、ほにゃ.htmlが表示されます。 >htmlをフォームとして扱いたい ←意味を取り違えていたらご勘弁を。
たぶん テーブルA Date,ConNo,line にして select A.Date, A.ConNo, sum(B.Amt) from A left join B on A.ConNo = B.ConNo and A.line = B.line group by A.Date, A.ConNo とすれば解決
excelでは無理だと思います。 最初だけです。動くのはです。 データの件数が僅か65536を越えたら動きません。 Accessなら、動きます。 最初から動かない物を作っても仕方無いです。 普通にAccessの集計クエリーでサクサクと作れますよ。 作る方法としては、 1. userのテーブルを作る 　user_id テキスト型 　user_name テキスト型 2. profitのテーブルを作る 　id auto_number 　user_id テキストの型 　profit_date テキストの型 　profit　数値の型 　date_year テキストの型 3. userとprofitのテーブルのリレーションを作る 　userのuser_idとprofitのuser_idを一対多で参照整合性を作る 4. userフォームをuserテーブルを元にデータシートビューを作る 5. profitフォームをprofitテーブルを元にデータシートビューを作る 6. userフォームを使ってuserのマスターを作る 7. profitのフォームは下記の様に作る 　idの入力は自動入力なので使用不可にする 　user_nameはuser_idを入力すると自動入力なので使用不可にする 　profit_dateは定型入力で000000;0;とする 　また、profit_dateは自動タブとする。 　 　この様な設定で、user_idとprofit_dateとprofitを入力するだけになる。 　profit_dateは、数値6桁を入力すると自動的に次の項目に飛びます。 　profit_dateはyymmddになります。 8. 年間売上の作成は、クエリーを二つ作ります。 　profitのdate_yearは、何もデータは入っていないのでこれを作ります。 　更新クエリーで、left([profit_date],2)で更新します。 9. 2番目のクエリーは、集計クエリーです。 　SELECT profit.date_year, profit.user_id, user.user_name, Sum(profit.profiit) A　S profiitの合計 　FROM [user] INNER JOIN profit ON user.user_id = profit.user_id 　GROUP BY profit.date_year, profit.user_id, user.user_name 　HAVING (((profit.date_year)="16")) 　ORDER BY profit.user_id; 　ここでは、"16"の所で年を示しています。この条件を変えるだけです。 10. 操作性を高めるためには、マクロを用意して二つのクエリー入れて置くと良い。 11. なお、これらをまとめてswitchboardに入れて置くと良いでしょう。 以上となります。 本来ならば、サンプルをアップしたい所ですが方法が分かりませんので。
ソフトを使うよりエクセルが一番いいですよ。 一番上の段に必要な項目を一つづつ入力して、左に1から番号を入力する。（簡単な方法がありますが初心者のようなので省きます） ダイレクトメール希望の人には○希望しない人には×印でいいでしょう。 ある程度入力したら一番上の段にデータのソートをつける。そうすると検索する項目に該当する人だけが画面上に出てきます。 この方法ならワードの差し込み印刷でダイレクトメールやはがきなど簡単に作成できます。 エクセルの本でもわかると思いますが。つまづいたらまた質問してください。
対象とする日付＋１日 未満をDmaxのCriteriaに指定します。 質問の例では、 Dmax("日時フィールド" ,"テーブル名","日時フィールド<#2016/5/30# +1")
＞つまり、nullはhtml側で何を書いても取得できないということでしょうか。 MySQLの場合文字列の比較は大きく３つあります 完全一致：カラム='文字列' 前方後方一部一致:カラム LIKE '文字列%' (’%文字列%’とか'_文字列_'とかそれらの組み合わせ) 正規表現：カラム RegEXP '文字列' (’.*’とか'.+'とか^や$など組み合わせ) そのどれを使ってもNULLを抜き出すことはできません たとえば「カラム=''」としても、「カラム=NULL」としても合致しません NULLと合致するのはあくまで「カラム is NULL」とか「ISNULL(カラム)」などの関数を利用します もしそのCMSが文字列比較しかできないのであればNULLは抽出できないと思います たいていCMSごとにNULLをチェックする仕組みをもっているような気がしますが マニュアルなど再確認されてみてはいかがでしょうか？
fixedDateRange 固定された日付範囲かな？ timeOfDayStart [0..1] 開始時刻かな？ [0..1] は UML でいうところの多重度のことかな。
初めに言っておくと、phpMyAdminはDBメンテナンスをするためのツールであり、本来、運用で使うものではありません。 そういった要望があるならば、希望する動作をするWebページを用意しなければなりません。 決まった日時に定期的に行いたいならば、cronなどのスケジューラ―でスクリプトを実行する、という形なども取れるでしょう。 また、Webページで実装する場合、ローカルに存在するファイルを選択して処理する、という流れものでは、Webページを構成するHTMLおよびセキュリティの特性上、予めファイルを指定することはできません。 そういうものを望むならば、予めサーバに、対象ファイルをアップロードするなどという作業が必要になります。 Accessの利用を避けられないようですから、どうしても手動作業が必要になり、なんでも自動化というわけにはいきません。 より単純、より簡略化を望むならば、やはりAccessの利用を撤廃した運用を考えるべきです。
同じような質問がありますのでこちらを参考に http://oshiete.goo.ne.jp/qa/7918893.html エクスポートを2回実行すればできます。 「Access エクスポート VBA」や「Access エクスポート マクロ」などで検索すれば いろいろ見つかると思いますのでそちらも参考になると思います。
それってどうしてもSQL側でやらないとだめなの？ ふつうは受け取った側が前後のデータの収納状態をみて 表示したり、しなかったりするもんだと思いますが
> そこに表れるPCは、ネットワーク上のPCだけであって、 > インターネット上のローカルPCは見えなくて、選択できないのではな > いかと思うのですが > 違いますでしょうか。 違います。 指定できるのはローカルPCまたはLAN上に存在するPCやNASのファイルだけです。 押してみれば分かります。
Excelなどにある「マクロの記録」のことであればありません。 http://oshiete.goo.ne.jp/qa/4382941.html マクロを作成するなら「作成」タブにマクロがあります。 https://support.office.com/ja-jp/article/%E3%83% …
たしかレコードのコピーって、追加クエリ以外でもできたと思います。 でも、望む結果になって良かったですね。
今は列見出しが商品IDになってると思います。そのフィールド名は変更できますので、そこを商品名にしてみてください。 おそらく、それでいけると思います。
havingの使い方がおかしい SELECT count(id) FROM s where 1 AND (a/b)*100 BETWEEN 200 AND 500
webサーバー,mysql, PHP、phpＭyadminをインストールしてできる 設定ファイルを編集するときに、文字コードの設定がうまくできていなのでは？
＞PHPの再帰処理によっても似たようなことができた 構造を表示するだけならどちらでもたいして変わらないと思います 集計したり階層の構成を変えたりを考えるとプロシージャで 処理した方がストレスないのかなぁ・・
途中から失礼します。 『計算で求められるものはテーブルに保存しない』のが原則かと思います。 テーブルに保存した場合には現時点での年齢を求めるために 更新クエリを毎回行わねばなりません。 なので、 テーブルからは年齢フィールドは削除し、クエリに演算フィールドを設定します。 テーブル１が ID　　　　オートナンバー型 氏名　　　テキスト型 生年月日　日付時刻型 ・・・ のデザインで ID　氏名　　生年月日 1　ポチ　　2006/04/01 2　トラ　　2010/10/10 のようなデータが入っているとします。 クエリを新規作成して添付図のようにします。（読めるかな） デザイングリッドの、年齢:DateDiff("yyyy",・・・・は画面スペース上途中で切れていますので 年齢: DateDiff("yyyy",[生年月日],Date())+(Format([生年月日],"mmdd")>Format(Date(),"mmdd")) にします。 『才』を入れた状態にしたいのなら 年齢フィールドのどこかで右クリックしプロパティを表示させ 書式欄に、0\才 とします。 このクエリをフォームのレコードソースにしてください。 年齢フィールドは数値型のままなので右詰で表示されますし 抽出や平均年齢などの計算もやりやすくなるかと思います。
ヤマ勘レベルです。 一般的なWindows7などでは、Cドライブ直下はUACの制限を受けます。 メモ帳でCドライブ直下にファイルを保存しようとするとアクセスが拒否されたり、 エクスプローラでファイルをコピーしようとするとUACによる確認が求められます。 Accessの場合はmdb/accdb ファイルのある場所にロック情報ファイル ldb/laccdb が 自動的に作成されますが、これがUACによって制限されているのでは？ 問題切り分けのためにテーブル一個だけのmdbをCドライブ直下に置いて 検証してみては？ ただ、だとすると、 >ローカルドライブ（Cドライブ）にコピーして この時に何もメッセージが出なかったのか、 どうやってコピーしたのだろう？と気になります。
2007 以降なら VBA などを使用しなくても プロパティの設定だけで簡単に表示できます。 エラー処理も必要ありません。 以下などが参考になるでしょう。 イメージ コントロールを使用して、フォームに画像を表示する http://answers.microsoft.com/ja-jp/office/wiki/o … AC2007以降の帳票フォームで画像表示 http://hatenachips.blog34.fc2.com/blog-entry-362 … の 画像ファイル名のみ格納してイメージコントロールで表示する方法 あたり。
> (1) AccessデータベースからMySQLへの変換 > (2) ローカル環境で設置済みのphpMyAdminで、SQL文を有したSQL > ファイルを作成する > (3) サーバで、phpMyAdminを使用してエクスポートしたSQLファイ > ルをインポートする。 えと、普通、データの登録・変更・削除が必要になるならば、それを管理者用のWebページとして構成して、Webですべて完結させるものですが。 DBが2つあっては、どれが反映すべきデータが分かりませんよね。 面倒だったら、Accessを撤廃し、phpMyAdminの使い方をレクチャーすればいいんじゃないですかね。 しかし、それでシステムが破壊されても文句言えません。 本来、公開すべきでないものを公開するわけですから。 せっかく一旦はデータを移行したはずなのに、ローカル環境のAccessというとても閉鎖的な環境でデータの更新をすること自体が間違いだと思います。
＞SUBSTR('id',-4,4) SUBSTR(`id`,-4,4) でどうでしょ？ シングルクォートだとidという文字を操作しています
パソコン（エクセルも同じ）は、まじめで間違いをしないものですが あいまいな計算は出来ません。 シートがどのようなものか不明ですが どこかに 新部署名　　　旧部署名 財務経理部部　　財務部 ・・・・ 元データ 部署名　旧部署名　人員 とあったら 旧部署名に =IF(COUNTIF(新部署名の範囲,A2),VLOOKUP(B2,新旧部署名の範囲,2,FALSE),A2) と云ったようにな関数を旧部署名の列に入れて、旧部署名を一致させる必要があります。
runtimeではできません。
mysqldumpが標準
バージョンやエンジンによるかもしれませんが もともとタイムスタンプは1テーブルに1カラムしか許可されていませんでした いまは複数カラムのタイムスタンプが設定できるようですが defaultにCURRENT_TIMESTAMPを指定できるのは１カラムだけなので 他のカラムにはdefault 0でよいので設定をかいておくとよいでしょう （default値を指定しないとCURRENT_TIMESTAMPを指定しようとするみたい）
仕組みが違うと思うけど、、、update-anywhere configuration　みたいなことがやりたいのかな？ http://froebe.net/blog/wp-content/uploads/2013/0 … レファレンスのｐ48（pdfのｐ56）あたりから書いてあるような気がします。 日本語だとV10のレファレンスが見つからないけど、ｖ8でも同じようなことが書いてあるみたいです。 ftp://public.dhe.ibm.com/ps/products/db2/info/vr … ｐ55～ いくらするのかわからないけど、このような方法もあるみたいです。 http://www.ibm.com/developerworks/data/library/t … 全くの素人なんで、大いなる勘違い等ございましたらご容赦ください。
頻度は高くないと思われますので（たぶん年に一・二回？） エクセル出力用クエリ select * from 名簿テーブル where 登録年月日 <= #2016/4/1# 削除用クエリ delete * from 名簿テーブル where 登録年月日 <= #2016/4/1# を作っておいて（抽出条件は作業のつど適宜変更） docmd.TransferSpreadsheet acExport,acSpreadsheetTypeExcel12Xml,"エクセル出力用クエリ","D:\" & format (now,"yyyymmdd_hhnnss") & ".xlsx",true でDドライブなどに出力し、 docmd.openquery "削除用クエリ" で削除。 とかでは？ なお、 どのようなデータが入るのか不明ですが、 フィールド名　データ型　サイズ ID　　　　　　長整数型　　　8 名前　　　　　テキスト　　255 住所　　　　　テキスト　　255 電話　　　　　テキスト　　　40 メール　　　　テキスト　　255 登録年月日　　日付時刻　　　8 備考　　　　　　　メモ　　1000 で各フィールドに常に目いっぱいデータを押し込むとしても Accessのサイズの上限を安全マージンをとって1.5GBと仮定します。 8+500+500+80+500+8+2000 = 3596 1.5*1024*1024*1024/3596 = 447890. 常に目いっぱいの場合でも４４万件、一般的なケースでは１００万件でも まだ余裕がありそうですので、この処理自体を考えなくても大丈夫な気がします。
補足、プロシージャを使って10のn乗件単位でやるならこうかな （思ったより速くなったけど、まだ改善の余地あり） 一度バルクSQLをつくってから流し込むので あまり長すぎるSQLを書くとオーバーフローする可能性があります。 要素数やレコード長によりますが1000件単位くらいが妥当かなと DROP PROCEDURE IF EXISTS MYPROCEDURE4; DELIMITER // CREATE PROCEDURE MYPROCEDURE4() BEGIN DECLARE a BLOB; DECLARE done INT DEFAULT 0; DECLARE CUR CURSOR FOR SELECT CONCAT('INSERT IGNORE INTO `tbl2` VALUES(' ,GROUP_CONCAT('\'',id,'\',\'',data,'\',\'',val,'\'' separator '),(') ,')') as x FROM `tbl1` GROUP BY TRUNCATE(id,-2);/* PER1=0, PER10=-1, PER100=-2, PER1000=-3*/ DECLARE CONTINUE HANDLER FOR SQLSTATE '02000' SET done = 1; SET group_concat_max_len = 10000000; OPEN CUR; REPEAT FETCH CUR INTO a; IF NOT done THEN SET @sql=a; PREPARE stmt from @sql; EXECUTE stmt; END IF; UNTIL done END REPEAT; CLOSE CUR; END // DELIMITER ; TRUNCATE `tbl2`; CALL MYPROCEDURE4;
max (time)にas maxtimeなどして別名をつけて その名前でorderbyしてください
２つの方法で 金額部分は数値であるとします なお、希望の最終形表示での、"金額" ･･･ 同じ文字列のフィールドは作成できないので 金額1、金額2 ･･･ １）DLookup を使う SELECT 販売店名, 品名１, DLookup("金額","テーブル１","販売店名='" & 販売店名 & "' AND 品名='" & 品名１ & "'") AS 金額１, 品名２, DLookup("金額","テーブル１","販売店名='" & 販売店名 & "' AND 品名='" & 品名２ & "'") AS 金額２, 品名３, DLookup("金額","テーブル１","販売店名='" & 販売店名 & "' AND 品名='" & 品名３ & "'") AS 金額３, 品名４, DLookup("金額","テーブル１","販売店名='" & 販売店名 & "' AND 品名='" & 品名４ & "'") AS 金額４ FROM テーブル２; ２）クロス集計を使う 以下内容で、クエリ ★★ を作っておいて SELECT 1 AS 順, 販売店名, 品名１ AS 品名 FROM テーブル２ WHERE 品名１ Is Not Null UNION ALL SELECT 2, 販売店名, 品名２ FROM テーブル２ WHERE 品名２ Is Not Null UNION ALL SELECT 3, 販売店名, 品名３ FROM テーブル２ WHERE 品名３ Is Not Null UNION ALL SELECT 4, 販売店名, 品名４ FROM テーブル２ WHERE 品名４ Is Not Null; 以下のクロス集計で最終形にする TRANSFORM First(IIF(S=1,Q2.品名,Q2.金額)) AS 値 SELECT Q1.販売店名 FROM ( SELECT 1 AS S, * FROM ★★ UNION ALL SELECT 2, * FROM ★★) AS Q1 INNER JOIN テーブル１ AS Q2 ON Q1.販売店名=Q2.販売店名 AND Q1.品名=Q2.品名 GROUP BY Q1.販売店名 PIVOT IIF(S=1,'品名','金額') & Q1.順 IN ('品名1','金額1','品名2','金額2','品名3','金額3','品名4','金額4'); 余談）テーブル１だけからでも以下の様な表示は可能 どのように表示されるのかは、実際にやってみてください TRANSFORM Sum(金額) AS 値 SELECT 販売店名, Sum(金額) AS 計 FROM ( SELECT 1 AS T, 販売店名, 品名, 金額 FROM テーブル１ UNION ALL SELECT 2, '合計', 品名, 金額 FROM テーブル１) AS Q1 GROUP BY T, 販売店名 PIVOT 品名;
unionした2行をカッコでくくってfrom句にいれてgroupbyしてみては?
クロス集計を使ってみてはどうでしょう テーブルの内容がわからないので･･･ 添付図上段のテーブル ★★ があったとします 以下をクエリの SQL ビューに記述して表示してみると、 添付図下段の表示になります TRANSFORM Sum(金額) AS 値 SELECT 摘要, Sum(金額) AS 計 FROM (SELECT 1 AS T, 日付, 摘要, 金額 FROM ★★ UNION ALL SELECT 2, 日付, '合計', 金額 FROM ★★) AS Q1 GROUP BY T, 摘要 PIVOT Format(日付,'yyyy/mm');
Access Runtimは、フォームやレポート、テーブル、クエリー、モジュールの構造やデザインの保存ができないだけで、データベースへのデータの保存・修正・削除は、問題なくできますよ。 ただ、モジュールなどでは、一部制限ができてしまったりすることがありますので、/runtimeのオプションをつけて起動し、チェックされるといいと思いますよ。
月は月初日を入れておくといいです #1で指摘した通り、入出金のデータだけだと結局その前月からの 繰り越しがわからないので、ダミーで1月に各銀行に10000円ずつ入金しておきます //元データ create table table1(銀行名 varchar(10), 出金 int, 入金 int , 月 date); insert into table1 values('A','0','10000','2016-01-01'),('B','0','10000','2016-01-01'),('B','0','100','2016-02-01'),('A','100','0','2016-02-01'),('B','0','100','2016-02-01'),('A','0','100','2016-02-01'),('A','100','0','2016-03-01'),('B','100','0','2016-03-01'),('B','0','100','2016-03-01'),('A','100','0','2016-03-01'),('B','0','100','2016-04-01'); //第一段階：月毎、銀行名毎の入出金および前繰は以下 select 月,銀行名 ,(select coalesce(-sum(出金)+sum(入金),0) from table1 where 月<t1.月 and 銀行名=t1.銀行名) as 前月繰越 ,sum(出金) as 出金計 ,sum(入金) as 入金計 from table1 as t1 group by 月,銀行名 これに次繰を表示するとこうなる select 月,銀行名,前月繰越,出金計,入金計,前月繰越-出金計+入金計 as 次月繰越 from ( select 月,銀行名 ,(select coalesce(-sum(出金)+sum(入金),0) from table1 where 月<t1.月 and 銀行名=t1.銀行名) as 前月繰越 ,sum(出金) as 出金計 ,sum(入金) as 入金計 from table1 as t1 group by 月,銀行名 ) as sub これのうち、3月のデータをとるので select 月,銀行名,前月繰越,出金計,入金計,前月繰越-出金計+入金計 as 次月繰越 from ( select 月,銀行名 ,(select coalesce(-sum(出金)+sum(入金),0) from table1 where 月<t1.月 and 銀行名=t1.銀行名) as 前月繰越 ,sum(出金) as 出金計 ,sum(入金) as 入金計 from table1 as t1 group by 月,銀行名 ) as sub where 月='2016-03-01' ここで問題、命題では4月のA銀行は入出金データがない 入出金データがない月は前繰も次繰も拾えないので、カレンダーテーブルを 別途つくって処理するなど工夫が必要です
Access的なデータベースソフトということであれば、LibreOfficeのBaseがそれにあたるかと思います。 フリーオフィスで検索すると、結構出てくると思いますよ。
基礎からやるならやはり入門書を2~3冊読み漁るところからじゃない?
s_cateの型はなに?
休日だけど気力を振り絞ってやってみた。 最初に、テーブル1 のレコードを整理するクエリを作る。 例で説明すれば 2回出てきた "会社A" の金額を合計して 350円となるようにするクエリ。 単純な集計クエリで、会社フィールドをグループ化して金額フィールドを合計してるだけ。 クエリの名前は 「クエリ1」 とした。 以下は SQL で表現。 SELECT [テーブル1].会社, Sum([テーブル1].金額) AS テーブル1金額 FROM テーブル1 GROUP BY [テーブル1].会社; テーブル2 にも同じことをするためのクエリを作る。 クエリの名前は 「クエリ2」 とした。 SELECT [テーブル2].会社, Sum([テーブル2].金額) AS テーブル2金額 FROM テーブル2 GROUP BY [テーブル2].会社; 次に、すべての会社名のリストを出力するためのクエリを作成する。 これはユニオン クエリで作成する。テーブル1 とテーブル2 の合体で作ってもいいし、クエリ1 とクエリ2 の合体で作ってもいい。 今回はクエリ1 とクエリ2 の合体で作ってみた。 クエリの名前は 「クエリ3」 とした。 SELECT 会社 FROM クエリ1 UNION SELECT 会社 FROM クエリ2; まだまだ続く。 今度はすべての会社名リストの会社名に対してクエリ1 (基となっているのはテーブル1) の金額をくっつけるクエリを作る。 これは単純な外部結合のクエリで、テーブル1 に存在しない会社の金額は空白で出力される。 クエリの名前は 「クエリ4」 とした。 SELECT [クエリ3].会社, [クエリ1].[テーブル1金額] FROM クエリ3 LEFT JOIN クエリ1 ON [クエリ3].会社 = [クエリ1].会社; 同様に、会社名リストとクエリ2 の金額を対象にした外部結合のクエリを作る。 クエリの名前は 「クエリ5」 とした。 SELECT [クエリ3].会社, [クエリ2].[テーブル2金額] FROM クエリ3 LEFT JOIN クエリ2 ON [クエリ3].会社 = [クエリ2].会社; 最後、クエリ4 とクエリ5 を単純な内部結合で合体し、比較結果を "OK" "NG" で表示するようにしたクエリを作成する。 クエリの名前は 「クエリ6」 ってした。 SELECT [クエリ4].会社, [クエリ4].[テーブル1金額], [クエリ5].[テーブル2金額], IIf([クエリ4]![テーブル1金額]=[クエリ5]![テーブル2金額],"OK","NG") AS 比較結果 FROM クエリ4 INNER JOIN クエリ5 ON [クエリ4].会社 = [クエリ5].会社; クエリ6 がお望みの表になっているかと思う。 もっと少ない素材でできるかもしれないが、それはデータベースの先輩たちに任せます。
MySQLはマルチテーブルインサートはできないようです。 2行に分けてやるなり、プロシージャで処理するなりしてください ちなみにmysql_query()関数は最新のphpでは廃止されていますので いつまでも使い続けていると、痛い目をみます そろそろPDO（もしくはmysqli_系の関数）にシフトをしたほうがよいですよ http://jp2.php.net/manual/ja/function.mysql-quer …
No.1です。 つまりVBAでSQLを指定しているのですよね？ そのSQLにFormat関数を仕込みましょう。
>>頻繁に行われるため、Oracle、PL/SQL、ストアドプロシージャで実現したく 一番簡単なのは、エクセルシートで組織表（組織名、コード、備考、など）を管理し、エクセルvbaの中でSQLを発行し、自動でアップデートしてしまう。 どこでもやっている常套手段です。
ほぼ意味不明 画像のタイトルとはなんでしょうか？ ファイル名？なにか任意にタイトルをつけている？ また画像へのアクセスは特定のidを利用する？ かりにmysql上のファイル名を変更した場合、保持したファイル名との 整合性が保たれないため、アクセスできなくなるでしょうね (命題にあるパスの変更ってやつです) 任意のタイトルを変更したいなら好きに変更すればよいでしょう 圧縮については、そもそもmysql関係ないし
チームスピリットの販社に詳細資料や導入事例の要求、場合によってはプレゼンテーション・デモンストレーションを養成したら如何でしょうか。
クエリというのはＳＱＬ文をわかりやすく表示したものです。　（ので、クエリでできないものをＳＱＬであればできるという可能性は少ないのですが、クエリというのはＧＵＩですから、何を具体的にやっているのかなどを文章で説明するのは非常に困難ですので、ドキュメント化しにくいという欠点があります。　また、将来的に他のデータベースに変更する際など、手間がかかるのも問題です。） データベース上ではテーブルの個々のデータの更新はできますが、クエリなどで集計したものや計算したものについては、テーブル上のどのレコードのどの値を変えるかがわからないため更新することができないのが普通です。 質問者様がやりたいことがはっきり見えていないので、正しい回答になるかがよくわからいのですが、 ・件数というのがレコード数なら、集計する前のクエリで掛け率を表示する列を作りそれを合計させる ・件数というのが個々のレコードに入っている何らかの値なら、補正件数みたいな列を作りそこに件数と予想掛け率を掛けた値を入れて置き集計させる などの方法が思いつきます。
SharePoint Online や、SharePoint Online を含んでいる Office 365 E3 などのサービスを購入すれば、Access のデータベースを Web アプリとして公開できるので、Android 等から Web ブラウザでアクセスしてデータの閲覧や編集をすることができます。 とは言え Windows 上の Access 2016 で作りこむ従来型データベースほど細かい事はできません。 フォームのデザインも簡略化されていますし、VBA も使えません。 マクロは実装されていますが、デスクトップ版 Access データベースとはちょっと様子が違います。（慣れてしまえば問題ないでしょうが） SharePoint Online や Office 365 E3 は法人向けの商品ですが個人での購入も可能です。 (私は個人的に私自身、たった一人分のライセンスだけで Office 365 E3 を使っています） とは言え法人向けに特化した管理機能なんかが付いているため、個人で買うにしてもそれなりの管理知識は必要になってしまいますね。 情報は Web や書籍で十分すぎるぐらい出ていますし、サポートは料金に含まれています。
固有名詞なので、オーロラと読むかアウロラと読むかは、アマゾン次第です。で、アマゾンのプレゼンテーションを聞くと、オーロラ。極光の意味でのオーロラの発音でいいと思います。
＞どのように 12 を取得してwhere句で指定するのか GETで渡しているので$_GETを利用します とりあえずarticle.phpに対してnoを渡さないときの挙動をどうするか決める必要があります。 絞りこみ条件を指定しない場合の挙動は３つあります ・データを表示しない ・全データを表示する 　（すなわち絞り込みをしない） ・該当するデータの内、適当に１データだけ表示する 　（これはあまりお勧めできない） 見た感じPDOを前提としてよいのであれば以下 （とりあえず練習ということでワイルドカード使っているようですが できるだけカラム名は羅列した方がよいです。） <?PHP try{ $dsn = 'mysql:host=localhost; dbname=testdb'; $user = 'root'; $password = 'hogehoge'; $pdo = new PDO($dsn, $user,$password); $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); $sql="SELECT no,title,content FROM post WHERE 1 "; $sql.=" AND no=?"; $datas=array(); $datas[]=isse($_GET["no"])?$_GET["no"]:""; $stmt = $pdo->prepare( $sql); $stmt->execute($datas); $row = $stmt->fetch(PDO::FETCH_ASSOC); print_r($row); }catch(PDOException $e){ die($e->getMessage()); } 絞り込みの方法は原則WHERE 1に対して、絞り込み条件を付加していく 今回のケースだとnoが指定されていない場合でもno=""をチェックするので データが表示されない WHERE 1 AND 条件1 AND 条件2 AND 条件3・・・ もしくは WHERE 0 OR 条件1 OR 条件2 OR 条件3・・・ のどちらかだけど、場合によっては WHERE 1 AND (0 OR 条件1 OR 条件2) AND 条件3・・・ 的なことも必要になる場合があります
if(!is_null($xdays))$query .=" and tb.day='" .$xdays ."'\n"; if(!is_null($xmn))$query .=" and tb.mn = '" .$xmn ."'\n"; if(!is_null($xfp))$query .=" and tb.fp='" .$xfp ."'\n"; if(!is_null($xre))$query .=" and tb.re='" .$xre ."'\n"; $query .=" order by tb.day DESC,tb.jikan\n"; $query .=" limit 0,50"; など、条件を行にわけると、エラーの箇所をより細かく限定できるかもしれません 具体的なエラー行数が表示されるので
決して簡単ではありませんが、そう難しくもない、 でもレスが付かない。 私も今のままではレスする気になれません。 というのは、テーブルの仕様に問題あり。 > 数量は～までの数量設定となっております。 これでは、テーブルにある最大の数値 + 1 が来たらお手上げですよね？ 十分大きな数値にしておけばいいじゃないか、と言っても 絶対に起こり得ないとは言えませんから。
理論的にはライブラリを介するよりネイティブなmysqli関数が早いはずですが 現状PDOが短所が少なくベターな選択肢でしょう
一律で次や前を書くことはできないことは理解できてますか？ （例外処理が必要とかきましたよね？） とりあえず、なんのCMSかわかりませんがビミョーな感じ たとえばこんな風にidを抜き出してみては？ CREATE TABLE `m_magazine` ( `magazine_id` int(11) NOT NULL PRIMARY KEY, `url` varchar(256) not null, `magazine_title` varchar(256) not null, `is_deleted` enum('y','n') not null default 'n' ); insert into `m_magazine` values (1,'url1','title1','n') ,(2,'url2','title2','n') ,(4,'url4','title4','n') ,(5,'url5','title5','y') ,(6,'url6','title6','n') ,(7,'url7','title7','n'); 条件： ・idが必ずしも連番とは限らない ・削除フラグが'y'のモノは無視する select (select max(`magazine_id`) from `m_magazine` as t1 where t1.`magazine_id`<t0.`magazine_id` and t1.`is_deleted`='n') as pre_id ,t0.`magazine_id` as `this_id` ,(select min(`magazine_id`) from `m_magazine` as t2 where t2.`magazine_id`>t0.`magazine_id` and t2.`is_deleted`='n') as nxt_id from `m_magazine` as t0 where t0.`is_deleted`='n'; これにurlとタイトルを拡張して select `pre_id`,t4.`url` as `pre_url`,t4.`magazine_title` as `pre_title` ,`this_id`,`this_url`,`this_title` ,`nxt_id`,t5.`url` as `nxt_url`,t5.`magazine_title` as `nxt_title` from ( select (select max(`magazine_id`) from `m_magazine` as t1 where t1.`magazine_id`<t0.`magazine_id` and t1.`is_deleted`='n') as pre_id ,t0.`magazine_id` as `this_id` ,t0.`url` as `this_url` ,t0.`magazine_title` as `this_title` ,(select min(`magazine_id`) from `m_magazine` as t2 where t2.`magazine_id`>t0.`magazine_id` and t2.`is_deleted`='n') as nxt_id from `m_magazine` as t0 where t0.`is_deleted`='n' ) as t3 left join `m_magazine` as t4 on `pre_id`=t4.`magazine_id` left join `m_magazine` as t5 on `nxt_id`=t5.`magazine_id` 仮に自ページのidが4なら、t0のmagazine_idで絞って select `pre_id` ,t4.`url` as `pre_url` ,t4.`magazine_title` as `pre_title` ,`this_id` ,`this_url` ,`this_title` ,`nxt_id` ,t5.`url` as `nxt_url` ,t5.`magazine_title` as `nxt_title` from ( select (select max(`magazine_id`) from `m_magazine` as t1 where t1.`magazine_id`<t0.`magazine_id` and t1.`is_deleted`='n') as pre_id ,t0.`magazine_id` as `this_id` ,t0.`url` as `this_url` ,t0.`magazine_title` as `this_title` ,(select min(`magazine_id`) from `m_magazine` as t2 where t2.`magazine_id`>t0.`magazine_id` and t2.`is_deleted`='n') as nxt_id from `m_magazine` as t0 where t0.`is_deleted`='n' and t0.`magazine_id`=4 ) as t3 left join `m_magazine` as t4 on `pre_id`=t4.`magazine_id` left join `m_magazine` as t5 on `nxt_id`=t5.`magazine_id`
エラーではなく、MODを適用したときに出る表示のような気がする。
【結果クエリ】 SELECT IIf([テーブル名].[種別]='B','A',[テーブル名].[種別]) AS 種別, Sum([テーブル名].[金額]) AS 合計金額 FROM テーブル名 GROUP BY IIf([テーブル名].[種別]='B','A',[テーブル名].[種別]); でいかがでしょうか？ 「テーブル名」は実際の名前に置き換えてください。
まずMySQL4って一番最悪のバージョンですが本当に大丈夫ですか？ とくにMySQL4.0とMySQL4.1は似たバージョンですが中身はほぼ別物で もし4.0をつかっているなら高速化はかなり難しいと思います。 MySQL4使うくらいならMySQL3.23の方がチューニングしやすいと思います。 MySQL5以降の適当な運用を検討した方がよいと思いますが・・・ ちなみにSQL文的にもUNIONでつないだものを集計するのは相当無理があるように見えます なぜ同じ様な構成のテーブルを冗長に分断してしまったのでしょうか？ 構成がおなじならパーティショニングなどで統合して管理した方がよいのでは？ あとはexplainで様子を見ながらチューニングしていくのが賢明でしょう
やりたいことは「名前と日付を指定し、指定した日に表示する画像のパスを得る」ということですよね？ で、項目※については「指定した日付より小さい物のうちの最大値」ということだと思います。これは複問い合わせにMAXを使うことで行けるように思いますがいかがしょう。 あとnullの考慮ですね。日付指定の無い方の場合、項目※にnullを入れておくのか、最小値を入れておくのかのデータ仕様上の判断ですか。 授業の課題なのかお仕事なのかは分かりませんが、SQL化はご自身でお考えください。 INNER JOINを使う方法もあるのかな？　どうなのかな？ 参考まで。
一つの方法として、、、 クエリをＳＱＬ文にして、ＡＤＯなどで開いて値を求め、セレクト文などで印刷するものを分ける Sub cmdPRT_clicked dim con as adodb.connection dim rst as adodb.recordset Set con = CurrentProject.Connection strSQL = "SELECT * FROM ...." rst.open strSQL,con,adopenkeyset, adlockoptimistic intFiledValue = RST!FIELDxxx rst.close SELECT CASE intFiledValue case < 1 exit sub case > 1000 prtXLS("AA.xls") prtXLS("BB.xls") case else prtXLS("AA.xls") end select end sub sub prtXLS(fileName) ・・・・ end sub などのように。 エラー処理もしていないし、検証もしていないし、スペルミスすらチェックしていません。 実際に作る際には、レコード件数によって、エラー処理等をしないといけなくなる。
追加です。印刷の設定とか、プロパティで確認ができないですか？。 また、最新のドライバーも入手してください。 これ以上は、両面印刷を最近知ったので判りません。
＞カメラでは送り先をSDにすればできますが、本体だとエラーとなります それじゃ、できるところで救済して、そのあとは初期操作（リセット）してそれでもだめなら修理しかない。
デバッグ実行とか、プロファイラとかで ②の EXECでどんなSQLを実行しているか、確認してはどうです? @colNameが COL だったとすると @preDataColはT1.COL @postDataColはT2.COL になって、②のSQLが SELECT COL As ColumnName, T1.COL AS PreData, T2.COL AS AfterData FROM T1,T2 WHERE T1.BusinessName = T2.BusinessName AND T1.COL<>T2.COL となる、ということは理解できてますか? これだと COL As ColumnName のCOLがT1.COLとT2.COLの2つの候補があるので「曖昧」だ、ということは理解できますか? 「ColumnName」という名前から推測するに SELECT 'COL' As ColumnName, T1.COL AS PreData, T2.COL AS AfterData FROM T1,T2 WHERE T1.BusinessName = T2.BusinessName AND T1.COL<>T2.COL というSQLにするつもりだったのでは? 自分で書いといてなんですが これって、SQLインジェクションの危険があります。 気を付けてください。 やはり、列名をユーザーが自由に変えられる、というのは問題だと思います。
SELECT A.BusinessName , A.Item1 AS PreData , B.Item1 As AfterData FROM T1 A , T2 B WHERE A.BusinessName = B.BusinessName AND A.Item1 <> B.Item1 UNION ALL SELECT A.BusinessName , A.Item2 AS PreData , B.Item2 As AfterData FROM T1 A , T2 B WHERE A.BusinessName = B.BusinessName AND A.Item2 <> B.Item2 UNION ALL SELECT A.BusinessName , A.Item3 AS PreData , B.Item3 As AfterData FROM T1 A , T2 B WHERE A.BusinessName = B.BusinessName AND A.Item3 <> B.Item3 ORDER BY BusinessName ASC , PreData ASC
syoumiがDATE型、もしくはTIMESTAMP型ならdate_format関数を使って年と月のみの記述に変換することで可能です。 SELECT date_format(syoumi, '%Y-%m') AS syoumi_ym, syouhin,SUM(kosu) AS gokei_kosu,SUM(jyuryo) AS gokei_jyuryo FROM storage GROUP BY syoumi_ym, syouhin なお、結果の最初のカラム名がsyoumiからsyoumi_ym になりますので、ご注意ください。 元のSQLですが、MySQLの設定やバージョンによっては動くかもしれませんが、GROUP BY句は GROUP BY syoumi, syouhin とするのが正しいです。
http://www.shift-the-oracle.com/sql/case-when-ex … 複合CASE式は使ってみました?
＞条件として事前申請がないと旅費精算は受け付けないという事になっています。 社名以外に申請と請求を1：1で結びつけるフィールドが必要です。 それがないなら、「急いで」これを解決することは困難だと思います。 解決法としては、申請ＩＤというユニークなインデックスを表1に作り、表2にもその値を入れておき、それらを結合させることが必要です。 テーブルの結合は、こんな感じでできると思います。 http://ms-access.seesaa.net/article/46193086.html で、それをleft joinにするには、線をクリックして二番目のラジオボタンにチェックを入れてＯＫを押す。 結果的には線が矢印になる（こんな感じ）。　５番目の画像 http://www.feedsoft.net/access/tips/tips111.html　 で、選択クエリにして置き、is not nullを何らかのフィールドに指定すれば、完成です。 http://www.helpforest.com/access/ob_query/ac0500 … これをＳＱＬビューに変更すると、（やたらめったら括弧だらけの）ＳＱＬ文として見ることができます。　ここに、ＳＱＬを張り付けて動作することもありますが、ＡＣＣＥＳＳならではの制限もあり、使いやすいとは言えないかもしれません。
> データーシートビューにおいて、フォームのフィールド名ではなく任意の名前を表示 デザインビューで開き、 目的のフィールドのテキストボックスに付属しているラベルの「標題」プロパティに 表示したい名称を設定してください。
こんにちわ。 > こちらはパスワードもユーザ名も変更しておりません。 心当たりですが、Oracle 11.2 以降はDEFAULT Profile のパスワード有効期間 (PASSWORD_LIFE_TIME) が180日に設定されているので、パスワードの有効期間が 切れた可能性があります。 DBA の方にユーザの状態を確認して頂いた方が良いと思います。 DB が落ちた原因ですが、監査ログが溜まり過ぎてSYSTEM 表領域がパンク したような事はありませんか？ Oracle 11.2 以降は、audit_trail='db' がデフォルトになっていて Create Session (Connect) のデフォルト監査が有効になっているので注意が 必要です。 SYS で接続して、?/rdbms/admin/undoaud.sql, ?/rdbms/admin/undopwd.sql を実行すると、この辺の設定を無効化する事ができます。
DMZには、直接インターネットからアクセスするサーバーのみを置きます。それ以外のものを置いてはいけません。
検討したわけではありませんが。 ○同じサーバー上で動作させるなら、CPUにかかる負荷は結局一緒ではないか。 　MySQLで100%使っていたとして、PostgreSQLを追加したら、 MySQL50%,PostgreSQL50%とかになるだけかと。 ○別のデータベースになるので、データの転送が必要 　データ型の不一致とかも発生し得る
現在の構造がフロントエンドにはバックエンド側のテーブルへのリンクのみが存在していて、バックエンド側にマスターの仮テーブルがあるなら、TransferSpreadsheetの処理は、バックエンド側で行うべきです。 どうしても、フロント側から行いたいなら、 1.それこそ仮テーブルにいったん格納して 2.バックエンドのマスターテーブルのデータを削除 3.バックエンドのマスターテーブルにインサート 4.仮テーブルのデータを削除 などの手順を取れば、できると思います。 まあ、個人的な経験からするとアクセスのバックエンド分離もユーザー数が多いと、時々不思議なことが起こるから、バックエンドだけでもSQLServerなどの普通のｄｂ（とりあえずexpress でいいから）に更新することを考えておいたほうが良いと思います。
>オプション→表示→桁　35　OKにしたのですが35文字の約半分の17文字で >折り返されてしまいます。 ちゃんと35字で折り返していますよ。 上に文字数を表すスケーラー出ていますよね？ いわゆる半角換算で35字です。 >指定した文字できちっと折り返すにはどうしたらいいでしょうか？ 全角・半角入り交じりだった場合はどう折り返しするんでしょう？ 画面上の見た目で右端が揃わない折り返しがご所望なんでしょうか？ そういう場合はテキストエディタでは難しいんじゃないですかね。
リボン関連はここで。 リボンを最小化・非表示にする http://www.ka-net.org/ribbon/ri06.html
データベースを作る前に、レシートをノートに貼ることをお勧めします。
和暦と西暦の二つのフィールドを設定する必要があるのかな？ クエリのデザイングリッドに新たなフィールドを追加 和暦だよーん:[西暦] とし、Alt + Enter を押して[和暦だよーん]フィールドのプロパティを表示させます。 その書式のところに、ggge\年mm\月dd\日 とすれば今日だと西暦2016/3/5｜和暦だよーん平成28年03月05日 になります。 相互に変更可能ですから二つのフィールドを設定するよりも・・・。 gやmの数はお好みで変更を。
複雑な SQL は保守性が悪くなるのでオススメできませんが、 やるとしたら select *, _ case when B.親フラグ = 1 then _ _ AA.金額 - AA.子の費用合計 _ else _ _ {算出費用の計算式} _ end from ( -- 複問い合わせで、親以外の費用合計をあらかじめ計算。子が無ければ 0 とする _ select A.PID, A.金額, coalesce(sum( {算出費用の計算式} ), 0) AS 子の費用合計 _ from A left join B on A.PID = B.FID and B.親フラグ = 0 _ group by A.PID, A.金額 ) as AA left join B on AA.PID = B.FID
ファイル名を[ ]を括って保存すると上の方に表示されるようになる意味ということであれば、 前の質問で答えていますし答えられています。 （何の意味もない。単にコード順に並んで上位に表示されるだけと回答されている）
こちらの回答でできるのではないでしょうか http://okwave.jp/qa/q1290544.html
っていうかauto_incrementのカラムの頭に出力時にCONCATでつければいいだけじゃない？ 桁数をあわせたいなら、最初からidに長さを指定して、unsigned zerofillしておけばよいでしょう create table hoge (id int(10) unsigned zerofill not null auto_increment primary key,data varchar(10)); insert into hoge(data) values ('test1'),('test10'),('test100'); select concat('head',id) as hid,data from hoge;
小数点以下４桁までなら数値型ではなく通貨型で書式を「標準」にすると３桁区切りの小数点以下は２桁の表示になるはずです。
Cancel=trueと言う事は、データのチェックをしようとしている訳です よね。普通は、データの整合性の観点からエラーチェックを主体にして この文脈が有ります。だから、不用意にこれを使うとデータ更新が出来 ない事になります。 Cancel=trueの条件に合致すると当然にレコードは保存されません。こ の場合に保存をする方法と言うのは、エスケープキーを打鍵してこのレ コードの保存を断念するだけです。 だって、プログラムの方で有る条件を満たしていると言う事で Cancel=trueになっているのですから。具体的にこのCancel=Trueを指定 しての文脈と言うのは。 例えば、コードとして性別と言うのが有って男性を1に、女性を2に設定 をしている場合に有るユーザーが誤って3を打鍵をした時にここで Cancel=trueにして誤ったレコードが保存されない様にガードを掛けま す。 ですから、きちんとAccessの方は動作をしているのです。だから、それ が期待をした動作で無いと言うので有れば。そもそものCancel=trueに した時の条件文に問題が有ると言う事です。 これ以上は回答は出来ません。と言うのは、何も明らかにはなっていな いからです。具体的なデータが有れば一歩踏み込んだ回答は出来ます が。 頑張って下さい。
>配列の数を100と返すのでは無く、きちんとここでは3を返す様な関数と言うのはあるのでしょうか。 VBAには配列が空かどうか一括で調べる関数はありませんので、自作するしかありません。 以下の様な具合で、取得するといいでしょう。 Dim a(100) As String a(0) = "4555" a(1) = "3333" a(2) = "eee" '中身が空でない配列の数を取得 For Each b In a If b <> "" Then i = i + 1 Next Msgbox i
> 「サポートしてないか壊れているかデコードできてない」というエラーが表示されて開くことができません。 確かに、拡張子が PDF のファイルはできるでしょうが、 > DoCmd.OutputTo acOutputReport, strReportName, acFormatXLS, strFileName & ".pdf", True 出力ファイルの形式に エクセル（acFormatXLS）を指定していますから 中身は Excel のブックです。 とりあえず acFormatPDF を指定して動作確認してください。 「excelインポート」という名前のテーブルのレコード数分、PDF を作成、 ということでよろしいでしょうか？ 同じ「お名前」「特集」の レコードは存在しない？
>userid_2とdate_2というインデックスが残っていました。 ALTER TABLE `extra` DROP INDEX `userid_2` ; ALTER TABLE `extra` DROP INDEX `date_2` ; ですね ＞こういうsql文を覚えるのは何を勉強すればよいでしょうか。 細かい構文を覚える必要はなくて適当なキーワードでぐぐれば引っかかりますよ 基本的にテーブルの属性を見るのは「SHOW」構文で変更するのは「ALTER TABLE」構文です
Microsoft Access データベース エンジン 2010 再頒布可能コンポーネント http://www.microsoft.com/ja-jp/download/details. … でしょうか？ 『詳細』や『インストール方法』などをご確認ください。
>大量に増えた場合は非常にsqlを組み立てるのがめんどうになります。 そうでもないと思いますが・・・ create table クロス集計 select 登録日 ,sum(容量='s') as s ,sum(容量='m') as s ,sum(容量='l') as s ,count(*) as 合計 from 収穫 group by 登録日; >見た目にもデータが全く無いのにも関わらずに列見出しとしては存在をしますので。 SQLとはそういうものです、データがないということを集計するのもSQLの仕事ですから ＞この様な方法(この場合は、プログラムでデータが有るのかをチェックしてsqlを組み立てると言う方法) ＞以外にmysqlでのsqlの記述が有るのでしょうか。 ないですね プロシージャでやっても結局データがあるかどうかチェックしてからSQLを組み立てるだけです もしくはデータを全部だした上で、データがない列を削除するかですが、ロジック的には同じことです （むしろ効率はわるい）
>dummyと言うのはたんなるaliasでしょうか。 FROM句にサブクエリを実行するときにはalias名が必要なのはMySQLの仕様です https://dev.mysql.com/doc/refman/5.6/ja/from-cla … 正直dummyでもhogeでもなんでもいいです。 なにか別名がついていればいいという仕様です 実質この場合のalias名は利用されていないし、競合することはありません 気になるならユニークなalias名を指定してください 例) SELET内のサブクエリにaliasは不要、ただし付けないと参照しづらい SELECT (SELECT 1); WHERE句もリレーションしなければalias不要 SELECT 1 FROM (SELECT 1) AS DUMMY WHERE 1=(SELECT 1); FROM句は常にaliasが必要 SELECT * FROM (SELECT 1); →× SELECT * FROM (SELECT 1) AS DUMMY; →○
PHP はまるっきりわからないので、外しているようでしたら無視してください。 接続文字列のサーバー名の所は合っていますか？ サーバー名だけで済む場合と、サーバー名に続いて \インスタンス名 とする場合があります。 SQL Server は同一サーバーにいくつもインストールすることができるため、インストールされた SQL Server 毎を区別して管理するため、それぞれのインスタンスに名前を付け区別します。 最初にインストールされた SQL Server の製品版はインスタンス名が付きません。 2つ目以降にインストールされた SQL Server の製品版にはインスタンス名を付ける必要があります。 SQL Server Express の場合は最初にインストールした場合でも強制的に SQLEXPRESS というインスタンス名が付くのでサーバー名の欄は ServerName\SQLEXPRESS となります。 外していたらごめんなさい
＞PHPmyadmin で設定 (1)テーブルを開いて構造を選びます。 (2)各カラムの前のチェックボックスあるので必要なものにチェックします (3)テーブルの下にある「ユニーク」というアイコンか文字をクリックします phpMyAdminでやるとインデックス名を任意につけることができません。 インデックス名を変更したいならインデックスを作ったあとで、 インデックスの編集メニューから名称を変更してください
sourceコマンドを叩く形ではなく、mysqlコマンドを叩く際に、sourceコマンドで実行しようとしているファイルを選択すればよいのではないでしょうか。 http://mysql.javarou.com/dat/000845.html また、パスワードは、mysqlコマンドを叩く際のオプションとして指定することができます。 http://www.dbonline.jp/mysql/connect/index3.html perlはよくわかりませんが、perl内でDB接続後のsourceコマンドはサポートされていないようですね。 しかし、perlからバッチファイルの実行はできるようです。 http://q.hatena.ne.jp/1147014058 perlからの実行で一貫して処理させたいのならば、perlからはバッチファイルを実行するようにし、バッチファイル内でmysqlコマンドを、実行したいファイルの指定と合わせて記述して叩く、という方法でうまくいきそうな気がします。
たとえばこんな感じ 文字列結合の仕方はSQLによって微妙にことなるので、 ご利用のSQLの文字列関数のマニュアルを参照ください create table table_a(No int,住所 VARCHAR(100)); insert into table_a values(1,'神奈川県川崎市宮前1-1-1'),(2,'神奈川県横浜市都筑区2-2-2'),(3,'東京都江東区門前仲町3-3-3'); create table table_b(市区 VARCHAR(100),ランク VARCHAR(10)); insert into table_b values('川崎市','A'),('横浜市','B'),('江東区','C'); SELECT No,住所,ランク FROM table_a as a LEFT JOIN table_b as b ON a.住所 LIKE CONCAT('%',市区,'%'); ただし、テーブルBの市区のカラムは実用に耐えないと思います 同名の市区町村は多数あるので、検索が競合します https://ja.wikipedia.org/wiki/%E5%90%8C%E4%B8%80 …
ロールフォワードは、どういうケースでも同一ですので、その認識は正しいです。 どういうケースであっても、トランザクションの同期点ログの書き込みが完了している場合は、ロールフォワードで、そうでない場合は、ロールバックすることになります。 「トランザクション処理中の障害」という記述の「処理中」というのは、普通は「処理開始から同期点ログ書き込み完了までの間」という意味なので、 ＞教科書には、データベースの障害には記憶媒体などの物理障害とトランザクション処理中の障害とがあり、前者にはロールフォワード、後者にはロールバックを適用する という教科書は正しいです。同期点ログが書き込まれてしまったら、まだデータファイルにデータが書き込まれていなくてもトランザクション処理は完了したことになります。
ああ、任意の文字で試すことは出来ない状況でしたか。 しかし問題ありません。ハイフン(あるいはダッシュ?)「―」は0x5CかMS932かどちらの問題かわかりませんでしたが、全角マイナス(Unicode的には全角ハイフンマイナス)「－」なら確実にCP932の問題です。 参考: http://www.m-bsys.com/character-code/java-sjis phpやSQLには詳しくないので具体的な対処法は分かりませんが、(正式な)Shift_JISとCP932が入り混じって使われているのでしょう。
例えば。 重複の無いテーブル (列は 列１、列２、列３ ) で、行数を数えるなら 　SELECT COUNT(*) FROM 重複の無いテーブル になりますよね? サブクエリの使い方で、わかりやすいのは、FROM やJOINで「テーブルの代わりに」サブクエリを使うというものではないでしょうか。 　SELECT COUNT(*) FROM サブクエリ as W -- 別名を付ける サブクエリ自体は、いくつか制限があるものの、基本は「普通のクエリを()で囲ったもの」 となれば、あとはわかるのでは?
SELECT @@secure_file_priv; で得られたフォルダからアップロードしてみては？ NULLであればmysql設定ファイルで --secure-file-privを設定してみてください
＞SET @sql=CONCAT('update result1 set target1=? where id between ? and ?;'); ＞上記で、?をブレースホルダーと言い、 まぁプレースホルダ自体は比較的一般的なIT用語ですね http://e-words.jp/w/%E3%83%97%E3%83%AC%E3%83%BC% … ＞EXECUTE stmt USING @a,@b,@c; ＞この時に実際の指定をするのがバインドと言う事でしょうか。 私もプロではないので、厳密な用語として正しいかどうかといわれると怪しいですが そういう認識でよいかと思います https://dev.mysql.com/doc/refman/5.6/ja/sql-synt … ＞PREPARE stmt FROM @sql; ＞上記で、指定をするのは概観だけで実際の正確な指定は実行時に指定をする ＞と言う方法の事をここではブレースホルダーの指定と言うのでしょうか。 プリペア（もしくはプリペアド）の処理を指定してるという言い方の方がわかりやすいのでは？ 実行自体はEXECUTEの構文になるので https://dev.mysql.com/doc/refman/5.6/ja/prepare. …
＞動きました。 それはよかった ＞テーブルに書き込みますが、この場合はテーブルには一つしかフィール ＞ドが無いので(と)でフィールドの指定は要らないのでしょうか。 VALUESで指定する引数の個数と、テーブルのカラム数が同じ場合は省略可能です 気持ち悪ければ INSERT IGNORE INTO MYTABLE (`d`) VALUES (@D); としてください ＞この場合のバッククォートを付ける意味は何なんでしょうか。 よくある予約語対策です。 予約語と競合しない場合はバッククォートは不要です テーブルの日付カラムにdateとかつける人もよく見受けられるので カラムだけにでも付けといたほうが気休めにはなります。 本来ならデータベース名やテーブル名にもつけます。 ＞declareと言うのは、procedureの中で使われるローカル変数と言う事でしょうか。 今回はそうなりますね DECLARE自体はその他のカーソルや条件・ハンドラの定義などにつかいます https://dev.mysql.com/doc/refman/5.6/ja/declare. … ＞またbeginとendは複数の行をprocedureの中で記述をする時には必要と言う事でしょうか。 複合ステートメントの構文です https://dev.mysql.com/doc/refman/5.6/ja/begin-en …
select * from t where id in (select id from t group by id having min(status) = max(status) and max(status) in (88, 99));
＞group byでユニークになっているのですね。 勘違いしてはいけないのは、データが単にユニークなだけで、ユニークな属性は ついていないということです。 もしさらにそのテーブルからリレーションするのであれば、なんらかの 属性はつけた方がよいかもしれません >もう一つ質問ですが。ここで作ったテーブルを別のテーブルを日付でjoin >したいのですが。この時の日付はインデックスの指定が要るのでしょうか。 であれば「create table xt」するときに適正なインデックスをつくっておいた方がよいでしょう。 もちろん後付けでalter tableで追加することもできます
>既にテーブルにデータが >保存されていますのでsumの値を更新してテーブルに保存をしたい テーブルを毎回全レコード対象に更新するのはあまりお勧めしませんが 以下でできないことはない。 ただしホントに必要な処理なのかはよく考えて運用ください //テストデータ create table hoge(id int not null primary key,money int,sum int null); insert into hoge(id,money) values(1,12),(2,20),(3,22); update hoge set sum=(select @a:=@a+money from (select @a:=0) as dummy) order by id;
//元データ create table members(id int not null unique,name varchar(30),index id_name(id,name)); insert into members values(1,'山田'),(2,'鈴木'),(3,'田中'); create table subjects(id int not null primary key,member_id int,subject varchar(30),index member_subject(member_id,subject)); insert into subjects values(1,1,'国語'),(2,1,'数学'),(3,1,'英語'),(4,2,'国語'),(5,2,'英語'),(6,3,'数学'); create table colors(id int not null primary key,member_id int, color varchar(30),index member_color(member_id,color)); insert into colors values(1,1,'赤'),(2,1,'青'),(3,2,'赤'),(4,2,'緑'),(5,3,'赤'); ＞1.指定する教科と色のどれか１つにでも該当 ＞例）国語 英語 青 緑 のどれか１つに該当する名前を検索 SELECT DISTINCT m.id,m.name FROM members as m LEFT JOIN subjects as s on m.id = s.member_id AND s.subject in('国語','英語') LEFT JOIN colors as c on m.id = c.member_id AND c.color in('青','緑') WHERE not(s.member_id is null and c.member_id is null) ＞2.教科はAND 色はOR ＞例）国語と英語の両方に該当し、かつ、青か緑のどれか１つにでも該当する名前を検索 SELECT DISTINCT m.id,m.name FROM members as m LEFT JOIN colors as c on m.id = c.member_id AND c.color in('青','緑') WHERE 1 and not( c.member_id is null) and m.id in( SELECT member_id FROM subjects WHERE subject in('国語','英語') GROUP BY member_id HAVING COUNT(*)=2 ) ＞3.教科はOR 色はAND ＞例）国語と英語のどれか１つにでも該当し、かつ、青と緑の両方に該当する名前を検索 SELECT DISTINCT m.id,m.name FROM members as m LEFT JOIN subjects as s on m.id = s.member_id AND s.subject in('国語','英語') WHERE 1 and not( s.member_id is null) and m.id in( SELECT member_id FROM colors WHERE color in('青','緑') GROUP BY member_id HAVING COUNT(*)=2 ) ＞4.指定する教科と色のすべてを満たす ＞例）国語 英語 青 緑 のすべてを満たす名前を検索 SELECT DISTINCT m.id,m.name FROM members as m WHERE 1 and m.id in( SELECT member_id FROM subjects WHERE subject in('国語','英語') GROUP BY member_id HAVING COUNT(*)=2 ) and m.id in( SELECT member_id FROM colors WHERE color in('青','緑') GROUP BY member_id HAVING COUNT(*)=2 )
T_ボランティア日に「メッセージ」というフィールドを追加。 データ型はYESNO型で作成します。 メッセージを渡した場合はチェックをすれば誰にいつ渡したのかが分かります。 渡す日がボランティア日と違う場合はメッセージのフィールドを日付型にしてください。（その場合はこの後の抽出条件を変更してください） T_ボランティア日の「メッセージ」にチェックがある人がメッセージを渡した人になりますのでこのデータを抽出。（クエリ１とします） T_個人とクエリ１を不一致クエリを使いクエリ１に存在しない人を表示すればメッセージを渡してない人のみが抽出できます。 http://www.microsoft-access.net/start/query-7.html
ちょっと微妙かなぁ・・・・ SELECT * FROM hoge WHERE user_id IN ( SELECT t1.user_id FROM hoge as t1 INNER JOIN hoge as t2 ON 1 AND t1.user_id=t2.user_id AND t1.email_address=t2.email_address AND t2.type=1 GROUP BY user_id HAVING COUNT(*)=1 ); みたいな感じ？
いつも、アンインストールするときは そのアプリを長押しすると アンインストール削除と出てくるので それをタップして、けしています 設定のボタンから したの方にある アプリケーションを選んでも 削除アンインストールするのか 選べますよー( ´∀｀)
きょうび先生のチェックも厳しいので、 こういう掲示板で質問して回答をそのままコピペして提出すると「不可」になる 可能性も高いですがよろしいですか？ (自分なりに理解した上で、書き直した方がよいかと・・・) ＞(1) 大石蔵子さんの貸し出しの状況の一覧（KASIDASI表から作成） SELECT K.KNO,K.GAKUSEINO,K.TOSYONO,K.KIGEN,K.HENKYAKU FROM KASIDASI AS K INNER JOIN GAKUSEI AS G ON G.GAKUSEINO=K.GAKUSEINO AND G.SIMEI='大石蔵子'; ＞(2) まだ，未返却の貸し出しの一覧（KASIDASI表から作成） SELECT * FROM KASIDASI WHERE HENKYAKU=0; ＞(3) 期限が12月の貸し出しの一覧（KASIDASI表から作成） SELECT * FROM KASIDASI WHERE KIGEN BETWEEN '2014-12-01' AND '2014-12-31'; ※ただし、別の年の12月も拾いたいならやりかたは異なる ＞(4) 未返却かつ期限が12月の貸し出しの一覧（KASIDASI表から作成） SELECT * FROM KASIDASI WHERE KIGEN BETWEEN '2014-12-01' AND '2014-12-31' AND HENKYAKU=0; >(5) 未返却貸し出しで，貸出期限が古い順に出力するSQL（KASIDASI表から作成） SELECT * FROM KASIDASI WHERE HENKYAKU =0 ORDER BY KIGEN ASC >(6) KASIDASI表を基準に3つの表を内部結合し， VKASIDASIという仮想表を作成する． CREATE VIEW VKASIDASI AS SELECT K.KNO,K.GAKUSEINO,G.SIMEI,K.TOSYONO,T.SYOMEI,T.TYOSYA,K.KIGEN,K.HENKYAKU FROM KASIDASI AS K INNER JOIN GAKUSEI AS G ON K.GAKUSEINO=G.GAKUSEINO INNER JOIN TOSYO AS T ON K.TOSYONO=T.TOSYONO; >(7) 各図書の貸し出し回数の一覧を表示するSQL文 SELECT T.TOSYONO,T.SYOMEI,T.TYOSYA,SUB.COUNT AS COUNT FROM TOSYO AS T LEFT JOIN ( SELECT TOSYONO,COUNT(*) AS COUNT FROM KASIDASI GROUP BY TOSYONO ) AS SUB ON T.TOSYONO=SUB.TOSYONO; ※１回も借りられていないものをどうするかによる ＞(8) 各学生の貸し出し回数と一番遅い貸し出し期限を表示するSQL文 （１回も貸し出していない学生は表示しなくてよい） SELECT G.GAKUSEINO,G.SIMEI,SUB.COUNT,SUB.LATE_KIGEN FROM GAKUSEI AS G INNER JOIN ( SELECT GAKUSEINO,COUNT(*) AS COUNT,MAX(KIGEN) AS LATE_KIGEN FROM KASIDASI GROUP BY GAKUSEINO) AS SUB ON G.GAKUSEINO=SUB.GAKUSEINO;
なぜSEに興味を持っているか、でしょうね。 当然に能力や知識経験（あと体力）が必要ですが どれもこれも本人の「やる気度」が結果に影響する。 もちろん、そっち方向のセンスがない奴はどれだけやる気があってもNGなんだけど ただ単に「保育士という現実」から逃避するためにSEとか言っているならダメでしょうね。 20代で相応のセンスとやる気があると見込まれれば ある程度の試用期間と社内教育を実施するとして 採用している会社もあるとは思いますよ。
このへんでしょうか？ https://dev.mysql.com/doc/refman/5.6/ja/windows- …
NULLの置き換えなら ISNULL が使えるはずです。 複雑なものも CASE WHEN が使えるはずです。
一般的にはleft joinしてnullをチェック select A.* from A left join B on A.A1=B.A1 and A.A2=B.A2 and A.A3=B.A3 where B.A1 is null
explainで検証してみてください 一部インデックスが利いていないですね GOODSテーブルのCLASS_GOODSを捨てて、3カラムでインデックスを貼ってみてはどうでしょう？ ALTER TABLE GOODS DROP INDEX CLASS_GOODS; ALTER TABLE GOODS ADD INDEX ID_CLASS_GOODS(GOODS_ID,CLASS,NAME); それでもインデックスが微妙なので、いくつかパターンを試してみるとよいかもしれません。 試しに集計テーブルをつくってためしてみてください CREATE TABLE SHUKEI (CLASS INT NOT NULL,NAME VARCHAR(1000) NOT NULL,B_NAME VARCHAR(1000) NOT NULL,INDEX BNAME(B_NAME)); 2回目以降は TRUNCATE SHUKEI; //データ投入 INSERT INTO SHUKEI SELECT D.CLASS,D.NAME,B.NAME AS B_NAME FROM RELATION_GOODS AS A INNER JOIN GOODS AS B ON A.GOODS_ID = B.GOODS_ID INNER JOIN RELATION_GOODS AS C ON A.FILE_ID = C.FILE_ID INNER JOIN GOODS AS D ON C.GOODS_ID = D.GOODS_ID; //結果表示 SELECT CLASS,NAME,COUNT(*) AS NUMBER FROM SHUKEI WHERE B_NAME ='商品Ｂ' GROUP BY CLASS,NAME ORDER BY NUMBER DESC
ああ、まさに「email_addressの種類が3以上あるレコードを抽出したい」のですね 前の回答は全てがユニークなデータで構成されたレコードでした SELECT * FROM hoge WHERE user_id IN ( SELECT user_id FROM hoge GROUP BY user_id HAVING count( DISTINCT email_address ) >=3 ); サブクエリの最後の数字が○○個以上の部分になります
GREATEST()
delete from work where id<= (select * from ( select min(id) from work where mail = "end_of_record" )as sub) ;
>select count(id) from mail; select count(*) from mail; じゃなくて？ ちなみにidはユニークもしくはプライマリなんですよね？ で、あればインデックスも利いているとはおもうのですが・・・ ＞実際の処理は件数を取得するのが目的では無くて、テーブルにレコード ＞が有るのかどうかの確認 select id from mail limit 1; とすれば空かどうかはわかると思います
>[root@centos7 Disk1]# rpm -i oracle-xe-11.2.0-1.0.x86_64.rpm >[root@centos7 scs]# rpm -qip oracle-xe-11.2.0-1.0.x86_64.rpm カレントディレクトリが違いますがな…。 rpmコマンドの-qiでパッケージの情報を表示します。 このとき指定するのはパッケージ名。 さらに-pオプションを追加した場合はパッケージ名ではなくrpmファイル名を指定します。 ファイル名の指定なんでカレントにない場合はフルパスなりで指定してください。 rpm -qa | grep ^oracle で、oracleで始まるインストール済みのパッケージが一覧で出力されるはずです。 そちらからパッケージ名を調べる。というのもありでしょう。 http://labs.berrystyle.jp/archive/2007/08/07/4.h … http://ossfan.net/tips/004_rpminfo.shtml http://linux.kororo.jp/cont/intro/rpm.php http://dev.classmethod.jp/server-side/rpm-revers … などなど、rpmコマンドの解説をしているページはいくつもあるので いろいろ見たり、実際に(破壊したりしない程度に)触ってみてください。 　-qa　　　インストール済みパッケージの一覧を出力。grepで絞り込んだりする。 　-ivh　　　インストール。進捗表示あり。rpmファイル指定。 　-Uvh　　　アップデート。進捗表示あり。rpmファイル指定。 　-e　　　　イレース。パッケージ名指定。 　-qi　　　　パッケージの情報表示。パッケージ名指定。-qaとかではバージョンとか出ないからこっちで調べる。 　-qf　　　　ファイルやディレクトリが含まれるパッケージの調査。ファイルやディレクトリを指定。 　-qs　　　パッケージに含まれるファイルやディレクトリの一覧を出力。パッケージ名指定。 辺りが使えればそれほど困らないとは思いますが。 -p追加で… 　-qip　　rpmファイルを指定した-qi。インストールする前に調べたい場合とか。 　-qsp　　rpmファイルを指定した-qs。インストールする前にどんなファイルやディレクトリがあるか調べたい場合とか。 辺りも使うことがあるやも知れません。
>先頭がタブであっても 先頭と末尾にダブルクォーテーションは付けてますか？ またタブがないというのは何で確認しているのしょうか？ 見えていないだけであるのかもしれません。
ずいぶん奇妙なデータ管理ですが 例示のデータを利用するならこんな感じ select * from work where id<= (select min(id) from work where mail='end_of_record') 普通は、同じメールであれば同じidを振るとか 一行ごとに分けずにtext形式などで処理するとかじゃない？
page_idごとにユニークなdeviceをカウントしたいのですよね？ いろいろやりようもあるとおもいますが、とりあえずこんな感じ？ select `date`,sum(device='pc') as pc,sum(device='smart') as smart from ( select distinct `date`,`device`,`page_id` from access_recode where `date` between '2016-01-01' and '2016-01-03' ) as sub group by `date`
SQL の WHERE には、さまざまな条件式が書けます。 AND,OR, () を使って、複数の条件式を結びつけることができます。 SELECT * FROM city,town と結合したテーブルを 「 city.id=town.city_id でなおかつ city.id=? 」 という条件で抽出したければ、上記の言葉を SQLの式で表現するだけです。 WHERE city.id=town.city_id AND city.id=? また前にも書きましたが、city.id=town.city_id なのだから、INNER JOIN いいように思います。 SELECT * FROM city INNER JOIN town ON city.id=town.city_id WHERE city.id=? PHPのプログラムがどんなことやってるか、については、読むのが面倒なのでやりません。
以下のようにすれば、wp19_で始まるテーブルの一覧が「wp19_tables.txt」に作成されます。 mysql -u root -p[rootのパスワード] -N information_schema -e "SELECT table_name FROM tables WHERE table_schema=’データベース名’ AND table_name LIKE ‘wp19_%’" > wp19_tables.txt 問題は出力で、こんな感じにすれば出力出来るかも？ mysqldump -u root -p[rootのパスワード] データベース名 <wp19_tables.txt > ダンプファイル名 出来ない場合は、 mysqldump -u root -p[rootのパスワード] データベース名 wp19_tbl1 wp19_tbl2 wp19_tbl3 ・・・ > ダンプファイル名 のように出力されたtxtを参考に、テーブル名を並べて書けば出力出来ます。
一応プロシージャでテンポラリのカレンダーを作った例 DROP PROCEDURE IF EXISTS P_TEST; DELIMITER // CREATE PROCEDURE P_TEST(IN s DATE,IN e DATE) BEGIN DECLARE i DATE DEFAULT s; DROP TABLE IF EXISTS TEMP_CALENDAR; CREATE TEMPORARY TABLE TEMP_CALENDAR(`id` int not null primary key auto_increment ,`d` DATE); WHILE i<=e DO INSERT IGNORE INTO TEMP_CALENDAR(`d`) VALUES(i); SET i=i+1; END WHILE; END // DELIMITER ; テーブル CREATE TABLE hoge(`data` INT,`createdate` DATETIME); INSERT INTO hoge VALUES(1,'2016-01-01 01:01:22'),(1,'2016-01-01 08:00:23'),(1,'2016-01-03 09:00:22'); 実行 CALL P_TEST('2016-01-01','2016-01-04'); SELECT c.d,COALESCE(count,0) AS count FROM TEMP_CALENDAR as c LEFT JOIN (SELECT DATE(`createdate`) AS d,COUNT(*) AS count FROM hoge GROUP BY d) as h ON c.d=h.d ;
>not exists 以前はexists超高速神話がありましたねぇ・・・ 今はそうでもないんじゃないかと思います インデックスを設定して、テストしてみたのですが どちらのSQLも同じ効率のようです ちょっと調べたらこんなところがヒットしました http://kkoudev.github.io/blog/2013/09/14/sql/ left joinしてnullチェックの方が優勢との見方をしているようです。
小難しいことは考えず、楽しく行こうぜ。
バージョン管理については一般的に メジャーバージョン、マイナーバージョン、ビルドまたはリビジョン（もしくはその両方）という ３～４つのくくりがあります。 MySQLのメジャーバージョンは5でマイナーバージョンが5(5.5)や7(5.7)ということです。 通常メジャーバージョンはコンセプトや設計方針自体が違うのであるいみ別アプリにちかい バージョンアップになりますが、安定性や仕様の継続性の観点から マイナーバージョンもブランチすることが多いようです たとえばMySQLだと長年安定バージョンとされていた3.23が機能面での拡張要求から 4.0に上がった際、結局方針が固まらず4.1が並行して開発されました。 またさらに発展版の5.0が同じ様な時期にリリースされ、結構混沌としている状況でした。 それぞれマイナーバージョンもこまかい仕様の変更があるので、現行であれば 5.5であれば47、5.6であれば28、5.7であれば10のビルドをつけ 各自はマイナーバージョンごとにバージョンが管理されているということです。 また考え方としてはPHPもほぼ同様です その他あえてcurrentバージョン（現行の最新）とstableバージョン（安定版）を分けて リリースするようなものもあります。
インストールしました の下にある詳細には 何が書いてあるのでしょう？ そこにエラーコードなどが書いてあればそれを検索することで解決法を探せるかもしれません。
OLEDBはwin10未対応だと報告が在ります！ ネットで対応して居るか確認してみては如何ですか？
＞This may be due to a blocked port ポートがブロックされているメッセージです。 恐らくファイアーウォールでブロックされているのだと思います。 デフォルトのポートは、3306です。 ウィンドウズのファイアーウォールなら、プログラムでアクセス可能に出来るので「mysqld.exe」に許可権限を与えてあげれば起動すると思います。 ＞ブラウザを立ち上げて「http://localhost/」への接続もできません！。 これは、Apacheの問題です。MySQLとは直接の関係はありません。
＞正直申し上げて「正規のレプリケーション」の意味を理解できません。 むしろそれがびっくり！ リプリケーションというのはMySQLの機能の一つであり DBやテーブルを固めておくって解凍することは そもそも「なんちゃってリプリケーション」ですね https://dev.mysql.com/doc/refman/5.6/ja/replicat … 経験則として・・・ MySQLの地位を向上させた3.23xのテーブルは4.0xや4.1xにそのまま もっていっても読めないケースが多かったです MySQLの中のバージョンでさえそうなんですからDBが違えば 読めないケースがあっても仕方ないでしょう。 #2でも書きましたが原則テキストSQLに落としたうえで、 新DB側で読み込むのがトラブルを減らす手段だと思います。
＞これって言のは、働いている現役の社会人を対象としている事でしょう ＞か。そこを知りたかったものですから。 非常に単純なロジックだと思いますけどね・・・ 命題）必須項目をかけなければ登録できず、自分は必須項目をクリアできない ・登録にウソを書く→誰もいいとは回答しない→自己責任でウソを書く ・ウソは書きたくない→登録できない→使用しない ２択なので好きなように対応してくださいというのが#1の回答です （質問者さんの命題をみるかぎり他の選択肢は提示されていませんが） それ以上の回答を希望するなら、登録画面中のどこにどうひっかかっているか 具体的に明示しないと回答のしようがないかと・・・
ちなみに簡単なSQL文を実行するプロシージャ DROP PROCEDURE IF EXISTS P_TEST; DELIMITER // CREATE PROCEDURE P_TEST(IN s TEXT) BEGIN SET @sql=s; PREPARE stmt from @sql; EXECUTE stmt; END // DELIMITER ; ここで例えば・・・ CALL P_TEST('SELECT 1 AS X;'); を実行する
企業に勤務する統計家です。 期待度数が低すぎて、 χ2適合度の検定が出来ないのであれば、 フィッシャーの正確検定（正確確率検定）ですが、 15群もあると、私の経験では、 メモリーオーバーフローでPCが止まる気がします。 また、ご存じと思いますが、検定を繰り返す時は、 多重比較になりますので、有意水準を変えて下さいね。 残差の件は、ここに書いてあることからは分かりません。
こんなかんじかと DECLARE 　c UTL_SMTP.CONNECTION; 　n NUMBER; BEGIN 　SELECT count(*) INTO n FROM a WHERE a.b like '%△△△△△%' or a.c like '%△△△△△%'; 　IF n > 0 THEN 　　c := UTL_SMTP.OPEN_CONNECTION('smtp.example.com', 25); 　　UTL_SMTP.HELO(c, 'smtp.example.com'); 　　UTL_SMTP.MAIL(c, 'foo@example.com'); 　　... 　　UTL_SMTP.QUIT(c); 　END IF; END; / 参考 http://otndnld.oracle.co.jp/document/products/or … http://otndnld.oracle.co.jp/document/products/or … http://otndnld.oracle.co.jp/document/products/or …
連携するシート１と そのシート１を参照してレイアウトを工夫するシート２ってことでは駄目なのか？
>Ａテーブルは集計結果を保持しています。 集計結果からさらに集計ってしてます？ むしろ集計後の集計をしていないならインデックスは不要でつねにデータの垂れ流しですから イメージ的には 膨大なデータがあって→その日参照したいデータだけ朝つくってテーブルに保持→ パターン1)ユーザーは絞り込みや集計せずそのデータを読み出すだけ 解決策：キャッシュもなにも不要で、毎回同じデータを抽出するだけなら ファイルか何に保持しておけば済むでしょう パターン２)あくまでもユーザーは任意の条件で抽出(WHEREやらHAVINGやら) もしくは、集計(SUMやらCOUNT)をおこなう 解決策：検索条件を想定し、Aテーブルに適切なインデックスを設定して、抽出する
FileMaker で聞くのが一番です 何をするかで変わるかもしれません（今までと違う作り方）　 私は安い方で十分使えてます それと買う場合　相談後にFileMakerの直販をお勧めします　説明と違う場合交換もして貰えます 登録はしなければアップデートも出来ないので直販の方が便利です　ポイントは付きませんが(T.T)
そのソフトを持っていませんので詳しい説明はできません。 もしPDFに書き出しできないのなら 「スクリーンショット」をとってJPEGにする方法があります。 それをコンビニでプリント。 住所録をプリントして読むくらいだったらそれでも使えます。
こちらが参考になるでしょう。 http://www.accessclub.jp/bbs6/0008/das1904.html おまけ、上記を参考にした 一応動作するコード。 Dim strSQL As String strSQL = "INSERT INTO table1 " & _ 　　 "SELECT Q.* " & _ 　　 "FROM [" & _ 　　 "TRANSFORM Count(収穫.ID) AS IDのカウント " & _ 　　 "SELECT 収穫.ID " & _ 　　 "FROM サイズ INNER JOIN 収穫 ON サイズ.ID=収穫.サイズ " & _ 　　 "GROUP BY 収穫.ID " & _ 　　 "PIVOT サイズ.名前 " & _ 　　 "IN ('大','中','小')" & _ 　　 "]. As Q" Debug.Print strSQL CurrentDb.Execute strSQL
＞2の意味は「国語」「理科」という2つの語句で検索しているので2という数字を指定していると理解してよろしいのでしょうか？ ちゃんと説明した方がよかったですね。 ご理解の通り、２科目で検索しているという意味の「2」です。 ついでに「 count(distinct c.name)」でdistinctを使っている理由は 仮にcategoryテーブルで10番目のデータが「10 | 3 |国語」と9番目とかぶるような場合 count(c.name)だけだと数値が3になるからです ユニークなカウントをして数値と合致させる必要があります
ああ、なるほどねぇ・・・ そもそもRDBに「次のレコード」という考え方がないので作業がちょっと難しくなります いただいた例を元に以下 create table mytbl(ymd int,soshi varchar(30),shain varchar(30)); insert into mytbl values('20151211','011東京','010加藤'),('20151210','011東京','010加藤'),('20151210','012埼玉','005佐藤'),('20151203','010大阪','001山田'),('20151203','011東京','002後藤'),('20151203','012埼玉','005佐藤'),('20151203','011東京','009田中'); これを「order by ymd desc, soshi, shain」を前提にランク付けをします。 select ymd, soshi,shain ,(select count(*)+1 from mytbl as t2 where 1 and (t1.ymd<t2.ymd) or (t1.ymd=t2.ymd and t1.soshi>t2.soshi) or (t1.ymd=t2.ymd and t1.soshi=t2.soshi and t1.shain>t2.shain) )as rank from mytbl as t1; //order by rank asc するとランク順に表示される 仮にrank=4のレコード('20151203','010大阪','001山田')について 前のレコードはmeisai.php?rank=3 自分自身はmeisai.php?rank=4 次レコードはmeisai.php?rank=5 meisai.phpではrankを元にhavingで絞り込みをします。 select ymd, soshi,shain ,(select count(*)+1 from mytbl as t2 where 1 and (t1.ymd<t2.ymd) or (t1.ymd=t2.ymd and t1.soshi>t2.soshi) or (t1.ymd=t2.ymd and t1.soshi=t2.soshi and t1.shain>t2.shain) )as rank from mytbl as t1 having rank=? //?のところに$_GET["rank"]でうけとったデータを渡す 毎回おなじロジックでランク付けをだすので viewをつくっておくと楽です create view myview as select ymd, soshi,shain ,(select count(*)+1 from mytbl as t2 where 1 and (t1.ymd<t2.ymd) or (t1.ymd=t2.ymd and t1.soshi>t2.soshi) or (t1.ymd=t2.ymd and t1.soshi=t2.soshi and t1.shain>t2.shain) )as rank from mytbl as t1; リスト表示 select ymd, soshi,shain,rank from myview order by rank asc; viewをつかった絞り込みの場合havingではなくwhere句でいけます select ymd, soshi,shain,rank from myview where rank=4;
再インストール：もう一回インストールをやり直そうぜ。 って事ですよ。
あ・・・、転記ミス SELECT FID FROM 生徒テーブル GROUP BY FID HAVING SUM(性別='女')=0
phpmyAdminを使ってから、かなり時間がたっているので間違っているかも知れませんが・・・。 最初に、 #1046 - No database selected このエラーは、「使用するデータベースが選択されていない」というエラーです。 phpmyAdminの「データベース」で新規データベースを作成してから、そのデータベースを選択してからダンプを「インポート」してください。 ※MovableTypeのデータベース名は自由に設定出来るので、元のデータベース名がわかっている場合は同じ名前で新規作成。わからなくても、ダンプにデータベース名の指定がなければ適当な名前でもエラーにならないはずです。 いきなり DROP TABLE IF EXISTS `mt_as_ua_cache` のエラーが出ていますが、これは「もし、`mt_as_ua_cache`テーブルが存在すれば削除」という意味です。 データベース名のエラーが出ていないので、問題ないはずです。 これで、インポート出来ると思うのですが？？？
DATE でグループ化すれば、DATEで集計されます。 GROUP BY の中にDATEが不要なのでは? GROUP BY substr(DATE,5,2),SH_CD あるいは、MONTH,SH_CD,SURYO でサブクエリを作って、それに対して、 MOUTH,SH_CDでグループ化するとか。
http://www.postgresql.jp/document/9.2/html/funct … 正規表現が使えるようなので'[a-zA-Z0-9｡-ﾟ]*'でどうにかすればできそうです。
とりあえずトラブルシューティング https://dev.mysql.com/doc/refman/5.6/ja/windows- … アンインストール以外だとアクセス権の話がこちらにあがっていますね http://dev.classmethod.jp/cloud/aws/trouble-mysq …
MySQL Command Line Clientなどは、my.iniを取り込む仕組みがあります。したがって、[mysql]の設定が有効で、MySQL Command Line Clinetから、show variablesを表示すれば、文字コードの設定が一見、できているかのように見えます。 しかし、my.iniを取り込む仕組みがないアプリ環境では、そういう訳にいかず、[client]の設定が必要になります。 また、実際にデータベースを管理する側に対しては、[mysqld]で文字コードの設定が必要になるのです。
＞テーブルがない場合に使うSQL文が「DUMMY」 ちょっと不親切でしたね、もうしわけない 今回のSQL文はサブクエリを利用したわけですが、 「別名(alias)」をつけないといけないルールなんです。 別名はなんでもよい（よほど変な名前じゃなければ）ので とりあえず今回はDUMMYとしました。 あまり深く考えない方がよいかと思います・・・
where card_id = ? はいわゆるプレースホルダですよね eclipseはよくわからないですがgetRecordsでBindValuesしたりするのでは？
iPhoneのデータをパソコンに保存出来るようにしたい場合、以下の方法を試してみてください。 http://goo.gl/SGxFIq どうか参考になりますように。
#1ですが、参考までに・・・ 今回のデータが仮にshopとcdの組み合わせのデータだったとして shopのマスター、cdのマスター、shopとcdの組み合わせデータの3テーブルが必要です。 以下サンプルです。 //shopマスター create table master_shop(sid int not null primary key,sname varchar(30)); insert into master_shop values(1,'shop_a'),(2,'shop_b'),(3,'shop_c'),(4,'shop_d'),(5,'shop_e'),(6,'shop_f'),(7,'shop_g'),(8,'shop_h'),(9,'shop_i'),(10,'shop_j'); select * from master_shop; //cdマスター create table master_cd(cid int not null primary key,cnumber int unique ,cname varchar(30) unique); insert into master_cd values(1,11230,'cd_A'),(2,21002,'cd_B'),(3,28003,'cd_C'),(4,28005,'cd_D'),(5,99309,'cd_E'),(6,23003,'cd_F'),(7,11302,'cd_G'),(8,11332,'cd_H'); select * from master_cd; //shop-cdデータ create table data_shop_cd(scid int not null primary key auto_increment,sid int,cid int); insert into data_shop_cd(sid,cid) values(1,1),(2,1),(2,2),(2,3),(2,4),(2,5),(3,1),(3,6),(4,1),(4,6),(4,6),(5,1),(5,3),(6,1),(6,3),(6,4),(7,1),(7,4),(7,2),(7,3),(8,7),(9,7),(9,1),(10,7),(10,1),(10,8) select * from data_shop_cd; //集計表 select sc.sid,s.sname,group_concat(c.cnumber order by sc.scid) as SHOP_CD from data_shop_cd as sc inner join master_shop as s on s.sid=sc.sid inner join master_cd as c on c.cid=sc.cid group by sid; //質問者さん得たいデータはcnumberの昇順のcdマスターデータなので select * from master_cd order by cnumber asc;
ごめんなさい。ちょっとニュアンスが違いました。 条件にヒットしたレコードに対して更新を行うですね。
①② その程度なら何でもよくないですか？ WindowsServer, SQLServerに拘る理由はなんでしょうか？ ③④ レンタルを無償って、あり得ないと思います。 それはつまり、部屋貸してるのに家賃いらないよってことですよ。 楽なのはAzure。 契約内容によってはレンタルサーバの料金を超えるでしょう。 共用サーバならこんなとこありますが。 http://www.winserver.ne.jp/ > 最終的にはWEB上でDB更新用サイトを限定公開したり、 > アプリを開発してANDROID端末上でDBを更新したりしたい、 自分のところから出てるグローバルIPが固定なら出来ますね。 また、WebAPIを構築しておけばAndroidアプリからの制御ということも可能でしょう。 しかし、それがWindowsServer, SQLServerでなければならない理由にはなりません。 どうしてもWindowsServerがいいというのならば、やはりAzureを選択した方がやれることが広がる分、便利かと思います。 (やらなきゃいけないことも増えます)
完全なCMOSクリアをしてみる。
そのテーブルだけのファイルをファイルサーバーに置かせてもらうのが一番かと思います。 これについては社内の管理者と相談してください。 『待ち受け画面』とはスクリーンセーバーのこと？ OSが不明ですが、そのPCでスクリーンセーバーからの復帰時にパスワード要求は変更せずに 電源設定で http://qa.support.sony.jp/solution/S090714106469 … 休止状態不可 スリープ不可 ハードディスクの電源断なし で改善されませんかね。 コントロールパネル→ネットワークアダプタの電源の管理から 電力の節約のために・・・のチェックを外す。 このデバイスで、・・・にはチェックを入れる。 も必要かも？ PS. ファイルを共有していると破損・誤削除などへの対応も必要になってくるかと思います。
すみません。　Exit Function消し忘れました。
PHPのぬるさが許せるかどうかでしょうね ある意味javascriptのぬるさに通じるものがあるので WEBプログラムとの相性がよいのですが・・・ どの規模で開発をしたいかによって選択肢は大きくかわってくると思います 個人レベルならphpがちょうどいいと思いますよ
logでエラーを確認するのが手っ取り早いとおもいますが・・・ レプリケーションの設定などしていませんよね？
たしかWindows server 2008だとR2以降対応だったような気がしますが その辺大丈夫でしょうか？
> 実はこの一覧は元のデータベースから毎日自動更新されてしまうのでできればシートを開いた時に毎回自動的に置換されるようにマクロとして組みたいのです。 No.1 さんの回答の動作を「マクロの記録」でコード化し、 シートを開いた時（ブックを開いた時？ シートがアクティブになった時？）のイベントで、それを呼び出せばよろしいのでは？
お役に立てたなら、嬉しく思います。 私もそんなにスキルが高い訳ではないし、学歴も低いし、ベンダー資格もなくて、現場で叩き上げた経験だけで、私の意見は参考程度になれば幸いなくらいです。 二、三ヶ月前のOracleのデ－タがAccessにインポートされている理由についてのお尋ねについて、私が思うことを、もうします。 私が経験したいくつかの会社で予実管理をする場合に、accessなど基幹DB とは別の媒体で分析をすることで、基幹DBに負荷を掛けず影響も与えずに新たな情報分析デ－タを生み出し将来予測に役立てていました。なので、せっかくインポートされた情報資産を活用なさると良いかと思いました。
「sql update join」で検索するといいかも
もし、ご興味があったら、次のプログラムコ－ドをご利用下さい。 私が実際に、会社で利用中なので、動くはずです。 Dim objExcel Set objExcel = CreateObject("Excel.Application") objExcel.Visible = True objExcel.Workbooks.Open "c:\1\業務内容.XLS" Set objExcel = Nothing 私は、拡張子のチェックをしたり、ファイル存在チェックをしたり、していますが、必ず存在していて必ずエクセルなら、このまま、ファイル名だけを動的に差し替えるように組み込めば、目的を果たすプログラムを作ることが出来ると思います。
SQL の delete 命令に join 句は使えません。 https://www.postgresql.jp/document/9.0/html/sql- … PostgreSQL ならば using 句が使えますが、 独自拡張であるし join 句とは使い方が異なるので、 in やサブクエリを使うことをオススメします。
#2です。コピペミスでした //表示 select t1.年月,t1.区分,t2.値 from( select date_format(日付,"%Y-%m") as 年月,区分,max(日付) as 日付 from hoge group by 年月,区分 ) as t1 inner join hoge as t2 on t1.日付=t2.日付 and t1.区分=t2.区分;
「終了日が2015年10月14日より前」 だったら書けますか? これでも書けないなら、まずはこれができる程度にSQLの勉強をしましょう。 もしかしたら、算数や国語の勉強も必要かもしれません。 できるのなら、 「2015年10月14日」の部分を「今日」に置き換えればいいのです。 データベースにもいろいろありますが、大抵の場合、「今日」を知るための方法が用意されています。 SQL Serverのカテゴリーなので、SQL Serverのマニュアルを載せます https://msdn.microsoft.com/ja-jp/library/ms18672 … > 終了日（END_DATE）が無期限の場合はNULLも設定されている 一つはNULLかどうかの判定 END_DATE IS NULL / END_DATE IS NOT NULL と他の条件とのAND / OR とを組み合わせて、目的の条件にすることです。 もう一つは、NULLの場合は「9999/12/31とする」といった感じで置換処理です。 SQL Serverの場合は、ISNULLという関数があります https://msdn.microsoft.com/ja-jp/library/ms18432 …
最初に（）の中を評価し、その結果に対して（）の外を評価すればよいです。 SELECTとかFROMとかの単語は英語の意味のままで見れば何をしたいか意味はだいたい察しがつきますよね。:-)
法令を順守できること。 小笠原流派のマナーを体得してること。
№5は誤り。訂正します。 ．　A　　　B　　　C　　　D　　　E　　　F　　　G　　　H　　　I　　　J　　　K 1|　キー　　　　　　　　　　 2|　H1-A　H1-1　H1-2　　　　　　　　D1-3　D1-4　D1-5　D1-6　D1-7　D1-8 3|　H1-A　H1-3　H1-4　D1-1　D1-2　D1-3　　　　 D1-5　　　　 D1-7　D1-8 4|　H1-A　H1-5　H1-6　D1-1　D1-2　D1-3　D1-4　D1-5　D1-6　D1-7　D1-8 5|　H2-A　H2-1　H2-2　　　　 D1-2　D1-3　D1-4　D1-5　　　　　　　　D1-8 6|　H3-A　H3-1　H3-2　　　　　　　　 7|　H3-A　H3-3　H3-4　　　　 D1-2　D1-3　D1-4　D1-5　D1-6　D1-7　D1-8 1. 以下を入力します。 ・L2セルには、=IF(A2<>A3,1,0) ・M2セルには、=IF(D2<>""," "&D2,"")&IF(E2<>""," "&E2,"")&IF(F2<>""," "&F2,"")&IF(G2<>""," "&G2,"")&IF(H2<>""," "&H2,"")&IF(I2<>""," "&I2,"")&IF(J2<>""," "&J2,"")&IF(K2<>""," "&K2,"") ・N2セルには、=IF(A2=A1,N1&M2,A2&M2) 2. L～N列をそのまま7行（または、500行）下へコピーします。 3. 1行目全体を選択し、[データ][フィルタ][オートフィルタ]を実行しプルダウンメニューを生成します。 4. L列のプルダウンメニューから「1」を選択すると、N列に希望の表示が実現しコピーして貼り付けると以下のようになります。 H1-A D1-3 D1-4 D1-5 D1-6 D1-7 D1-8 D1-1 D1-2 D1-3 D1-5 D1-7 D1-8 D1-1 D1-2 D1-3 D1-4 D1-5 D1-6 D1-7 D1-8 H2-A D1-2 D1-3 D1-4 D1-5 D1-8 H3-A D1-2 D1-3 D1-4 D1-5 D1-6 D1-7 D1-8
>素人なので、気づけば汚いデータ構造で、非効率なテーブル 大丈夫、だれが作ってもチューニングは必要 ＞成り行きできなく、あらかじめ ＞SNSを作成するにあたって必要なテーブルをあらかじめ作成しよう アマゾンで「要求定義」と「要件定義」で検索してみてください 基本的な定義書さえかければ、機能を絞り込み、必要なリソースを洗い出すことできます
config.inc.phpの $cfg['Servers'][$i]['user'] = 'root'; $cfg['Servers'][$i]['password'] =　　<--- を確認。
>POSTに対応するカテゴリーを取り出す GROUP_CONCAT というものを見つけたのです いや・・・#1でGROUP_CONCAT提示していますよね？ ＞GROUP_CONCATはGROUP BYと一緒に使ってWHEREをHAVING ちょっと違うかも。この場合集計して抜き出すのではなく結合する際に絞り込むのが妥当。 JOINする際に条件節を追加します。具体的にはこう SELECT p.id as pid,group_concat(c.name) as cname FROM posts as p INNER JOIN categories_posts as cp ON cp.post_id = p.id AND cp.id IN (1,2,3) INNER JOIN categories as c ON cp.category_id = c.id GROUP BY pid; ただし、普通に考えればcategoriesのidで絞り込むことはあっても categories_postsのidで絞り込みをすることはありえない categories_postsはpostsとcategoriesの組み合わせを決めるテーブルなので そのidはprimary keyにあたるユニークを担保するものです。 検索の際にcategories_postsのidを意識することはまずないはずです。
>Windows8.1以降ってローカルアカウントより >マイクロソフトアカウント仕様の環境になる？かなと思うので、 それはあり得ないと私は思っているので、さっさとローカルアカウントに戻しました。MS的にはそうしたいでしょうけど。 なので深追いしてないし実際やってないけど、保険として残しておいた私的なメモから。 コレをやってみるとか。 http://121ware.com/qasearch/1007/app/servlet/rel … あるいは、「コントロール パネル」→「すべてのコントロール パネル項目」→「ユーザー アカウント」でアカウントのIDらしきものが見えるからそれを使ってみるとか。
冗長なSQLを書くよりはデータ渡しの工夫はphp側ですべきです たとえばこんなかんじ <form> aaa:<input type="text" name="aaa" value=""><br> bbb:<input type="text" name="bbb" value=""><br> ccc:<input type="text" name="ccc" value=""><br> <input type="submit" value="search"><br> </form> <?PHP $sql="select * from hogehoge where 1"; $aaa=(isset($_GET["aaa"])and $_GET["aaa"]!=="")?$_GET["aaa"]:null; $bbb=(isset($_GET["bbb"])and $_GET["bbb"]!=="")?$_GET["bbb"]:null; $ccc=(isset($_GET["ccc"])and $_GET["ccc"]!=="")?$_GET["ccc"]:null; if(is_null($aaa) and is_null($bbb) and is_null($ccc)){ $sql.=" and 0"; }else{ if(!is_null($aaa)) $sql.=" and `aaa`='$aaa'"; if(!is_null($bbb)) $sql.=" and `bbb`='$bbb'"; if(!is_null($ccc)) $sql.=" and `ccc`='$ccc'"; } print $sql; ?> 実際にはプレースホルダで処理する方が賢明。
フィールド名をF1～F4とした場合ですが、 判定: IIF([F1] In ([F2],[F3],[F4]) OR [F2] In ([F1],[F3],[F4]) OR [F3] In ([F1],[F2],[F4]) OR [F4] In ([F1],[F2],[F3]),1,null) では？
とりあえず設定を戻してmysqldを再起動し SHOW CHARACTER SET としてcharsetに「cp932」は表示されますか？
＞values ((select col_a from tb_B),1,1,1,1,1,1,1)みたいな感じ であれば insert ignore into tb_A (col_a,col_b,col_c,col_d,col_e,col_f,col_g,col_h) select col_a,1,1,1,1,1,1 from tb_B; とします
この辺りを読めば何が原因かお分かりになるかと。 http://wpdocs.osdn.jp/Giving_WordPress_Its_Own_D … いずれにしてもpublic_html/index.htmlのリネームまたは削除は、XServerで公開するためには必須です。
>やはり一つのテーブルにしないと難しそうですね。 こうすればいけると思います select a.peerId,a.email,b.roomId from peerslist as a inner join ( select peerId,roomId from rellist where roomId in( select roomId from rellist where peerId in( select peerId from peerslist where email='bbb@gmail.com' ) ) ) as b on a.peerId=b.peerId order by roomId asc; #2の指摘は、できるかどうかを問題にしているではなく、 正規化もせずにテーブルを分割するのは運用上よろしくないという意図です また分割したデータを結局結合して使うなら、分割することによるオーバーヘッドが大きいので 普通は分割しません （#2では便宜上viewを作って対応する方法を書きましたが最初から分割しないのが正解）
どういう仕様にしたいかによるので何とも言えませんが 設問ID、ユーザーID、回答結果の３項目が必要では？ 設問=1に対して、ユーザー=1001が回答1,3,５を持っている場合 1,1001,1 1,1001,3 1,1001,5 となるだけで、何も運用上問題ないかと・・ ただしhtml経由でcheckboxからデータを受け取る場合 未チェックデータは送られてこないので一度 delete from テーブル where 設問ID=1 AND ユーザーID=1001; とクリアしてから insert into テーブル values(1,1001,1),(1,1001,3),(1,1001,5); とデータ投入する必要があります。 （つまり２や4が未チェックであるというデータがおくられてこないため） 基本的にはプログラム側でうまくループ処理を入れればよいでしょう
http://www.goma.pw/article/2015-03-12-0/ http://www.adminweb.jp/xampp/mysql/index2.html などが参考になるとおもいます
では、フォームのコマンドボタンのクリック時の場合です。 Private Sub CMDテスト_Click() Dim RPname As String RPname = "印刷レポート" 'レポート名を指定 DoCmd.OpenReport RPname, acViewDesign, , , acHidden Reports(RPname).Controls("承認").Visible = False '承認ラベルを不可視に DoCmd.OpenReport RPname, acViewPreview, , , acWindowNormal '印刷プレビュー '↑印刷プレビューでみて問題なかったら 'レポートは保存しないで閉じます '本番では印刷プレビュー用の行はシングルクォート'でコメントアウトして '下記２行のシングルクォートを外して実行 'DoCmd.OpenReport RPname, acViewNormal '印刷開始 'DoCmd.Close acReport, RPname, acSaveNo '保存しないで閉じます End Sub
>member_no　カラムのデータ自体を修正 であれば普通に update table_abc set member_no=right(member_no,10)
ANo.2です。 > 装置も完全なスタンドアローンタイプで、外部には一切情報が出せていない状態ですが > パトライトで稼働中、エラー、警報は出しています。 であれば、シグナルタワーの出力を拝借するのが一番無難そうですね…と言うより、それしかすぐにはできなさそうです。キヤノンに装置の改造を頼めば好きな警報出力が出せるでしょうけども、とんでもない見積もり金額が出てくるか、あるいはできませんと断られるか。 無線LANでDIOを飛ばせる製品があるんで、それを使ってシグナルタワー出力を飛ばすのが最も安直では？PCで受けて画面に出すか、そこからさらにタッチパネルに送り出す形です。 http://www.lifetron.jp/prowebWI02.htm#01 フロアをまたぐのは無線では無理で、フロア間は有線にせざるを得ませんが、それくらいは工場だったら既存のネットワークケーブルが走っていそうな気がしますけど、どうでしょう。
文字通りの再送信なら、前回送信時の情報は含まれません。 相手が自分宛にCCしたものを転送する場合では、転送の仕方によっては、前回の情報が含まれますが、もちろんねつ造可能です。
ANDとORを並べると、ANDの論理演算が優先します。 「comment_textが、null か、空っぽで」としたいのなら、 + " AND ((comment_text IS NULL) OR (LENGTH(comment_text) = 0))" としなければなりません。
>food_id = (SELECT MAX(date) FROM food WHERE (food_id = 1) AND (food_name = 'みかん')) が多分おかしい。 date = (SELECT MAX(date) FROM food WHERE (food_id = 1) AND (food_name = 'みかん')) ってことじゃないの？
えらそうに言ってるけど今回もタイプミスがあるよ
＞ということは、ユニークキー以外を更新ということは、 ＞insertもできない理由になってないですよね？ いや、だから１行目に回答してるでしょ？ カンマがないから文法エラーになってます
INSERTでON DUPLICATE KEY UPDATEを指定する http://dev.mysql.com/doc/refman/5.6/ja/insert-on …
#2です。 あなたの質問には今後いっさい回答しないので つい回答してしまわないように、ブロックしてもらえませんか？
これってほぼ前回の応用では？ 考慮しなくてはいけないのは、該当レコードが複数ある場合全て表示するのか、 それともどれか１つだけ抽出するのか、抽出する場合はどういったロジックをつかうのかです。 また過去データが１つもないものは表示しなくてよいのか、nullでも表示したいのかを きめないといけません。 単純に合致するデータをすべて表示し、過去データがない場合は表示しないのであれば こんな感じ //データ create table goods (id int not null primary key auto_increment,pid int,d date); insert into goods(pid,d) values(1,'2015-10-11'),(1,'2015-08-02'),(1,'2015-07-01'),(1,'2015-07-01'),(1,'2014-01-01'),(1,'2015-06-03'),(2,'2015-10-11'),(2,'2015-08-02'),(2,'2015-07-01'),(2,'2015-07-01'),(2,'2014-01-01'),(2,'2015-06-03'),(3,'2014-01-01'),(3,'2014-01-02'),(3,'2014-01-02'),(4,'2015-07-10'),(4,'2015-07-11'); //抽出 select * from goods where (pid,d) in (select pid,max(d)from goods where d < '2015-07-01' group by pid) 注意：pid=3は合致するレコードが２つあります
実は単純そうでちょっとめんどうな命題です。 例示のものだけであればこんな感じ //元データ create table goods (id int not null primary key auto_increment,pid int,d date); insert into goods(pid,d) values(1,'2015-10-11'),(1,'2015-08-02'),(1,'2015-07-01'),(1,'2015-07-01'),(1,'2014-01-01'),(1,'2015-06-03'),(2,'2015-10-11'),(2,'2015-08-02'),(2,'2015-07-01'),(2,'2015-07-01'),(2,'2014-01-01'),(2,'2015-06-03'); //集計1 select g1.* from goods as g1 inner join( select pid,max(d) as d from goods where d < '2015-07-01' group by pid) as g2 on g1.pid=g2.pid and g1.d>=g2.d ところが・・・ データの中に、「指定日より後に（前に）しかデータがない」場合など想定するとちょっと変わってきます。 //データ追加 insert into goods(pid,d) values(3,'2014-01-01'),(3,'2014-01-02'),(4,'2015-07-10'),(4,'2015-07-11'); おなじ集計をかけるとpid=4のデータが抽出されません。 これはサブクエリ select pid,max(d) as d from goods where d < '2015-07-01' group by pid が指定日より過去のデータを持っているpidしか対象としないからです。 これをふまえて以下のようにするとpid=4もひろえます。 //集計2 select g1.* from goods as g1 left join( select pid,max(d) as d from goods where d < @d:='2015-07-01' group by pid) as g2 on g1.pid=g2.pid and g1.d>=g2.d where g2.d is not null or g1.d>=@d
単純復旧モデルでは、トランザクションがコミットされたタイミングで自動的に解放OKのフラグがつきます。 ですので、処理は不要です。 （また明示的に対応がありません） 完全復旧モデルでは、トランザクションログバックアップを実行すると解放されます。 フルバックアップではだめです。 dbcc shrinkfileは、自動拡張したファイルサイズを縮小するために使用します。 縮小できるのは、解放可能フラグがついている場合です。 イメージ的には、 トランザクションログファイルが1GB 長いトランザクションやトランザクションログバックアップをしなかったことで、ログファイルが2GBに自動拡張。 トランザクションログバックアップをして、2GBの内解放可能な領域を解放。 2GBを1GBに戻したいときにdbcc shrinkfileを実行となります。
下準備。 T1workテーブルを作成します。クエリ２のフィールドにIDフィールドを加えます。 ID　　　長整数型 順番, 出荷日, 客先, 依頼№, 品番, 製品名, ロット№, 本日出荷数, 単価, 金額, 返却・修正, 完納, 完納時出荷数, 計算上金額 ID以外のデータ型やフィールドサイズはオリジナルと合わせてください。 主キーの設定やインデックスの設定は不要です。 ※返却・修正フィールドの・中黒はAccessが誤動作しますから止めておくべきです。 下記コードではそのままにしています。 また、機種依存文字の№も同様です。 T1workテーブルを元にレポートを作成します。並び順にはIDを指定。 >現在、そのクエリの結果をフォームにし印刷しています。 フォームにコマンドボタンを置いて印刷するようにします。 Private Sub CMDテスト_Click() 　　Const rowNum As Long = 8 '←ひと区切りの行（レコード）数をここで指定 　　Dim DB As Database 　　Dim RsFrom As DAO.Recordset, RsTo As DAO.Recordset 　　Dim i As Long, j As Long, smallSum As Double 　　　　 　　Set DB = CurrentDb 　　DB.Execute "DELETE * FROM T1work" '既存レコード消去 　　Set RsFrom = Me.Recordset.Clone 　　Set RsTo = DB.OpenRecordset("T1work", dbOpenTable, dbDenyRead, dbPessimistic) 　　 　　Do Until RsFrom.EOF 　　　　i = i + 1 　　　　j = j + 1 　　　　RsTo.AddNew 　　　　RsTo!ID = j 　　　　RsTo!順番 = RsFrom!順番 　　　　RsTo!出荷日 = RsFrom!出荷日 　　　　RsTo!客先 = RsFrom!客先 　　　　RsTo!依頼№ = RsFrom!依頼№ 　　　　RsTo!品番 = RsFrom!品番 　　　　RsTo!製品名 = RsFrom!製品名 　　　　RsTo!ロット№ = RsFrom!ロット№ 　　　　RsTo!本日出荷数 = RsFrom!本日出荷数 　　　　RsTo!単価 = RsFrom!単価 　　　　RsTo!金額 = RsFrom!金額 　　　　RsTo![返却・修正] = RsFrom![返却・修正] 　　　　RsTo!完納 = RsFrom!完納 　　　　RsTo!完納時出荷数 = RsFrom!完納時出荷数 　　　　RsTo!計算上金額 = RsFrom!計算上金額 　　　　 　　　　smallSum = smallSum + RsFrom!金額 　　　　RsTo.Update 　　　　RsFrom.MoveNext 　　　　 　　　　If i Mod rowNum = 0 Then　'小計行挿入 　　　　　　RsTo.AddNew 　　　　　　j = j + 1 　　　　　　RsTo!ID = j 　　　　　　RsTo!製品名 = "【 小 計 】" 　　　　　　RsTo!金額 = smallSum 　　　　　　RsTo.Update 　　　　　　smallSum = 0 　　　　End If 　　Loop 　 　　If i Mod rowNum <> 0 Then 　　　　RsTo.AddNew 　　　　j = j + 1 　　　　RsTo!ID = j 　　　　RsTo!製品名 = "【 小 計 】" 　　　　RsTo!金額 = smallSum 　　　　RsTo.Update 　　End If 　 　　RsFrom.Close: Set RsFrom = Nothing 　　RsTo.Close: Set RsTo = Nothing 　　Set DB = Nothing 　　 　　DoCmd.OpenReport "レポート名", acViewPreview End Sub でどうですかね？
全部非連結コントロールということはデータの参照のみにしたいということなんでしょうか。 VBAは使わなくても間に合いそうです。 全てのフィールドが一つのテーブルの中にあるとしたらですが、 現状では非連結になっている各コントロールのコントロールソース欄 （データタブにあります）に指定すれば良いでしょう。 たとえば会社名なら =IIf(IsNull([会員番号]),"",DLookUp("会社名","テーブル名","会員番号 = " & [会員番号])) のようになります。 テーブル名、フィールド名、そもそも一つのテーブルに出したいフィールドが含まれているのか などが不明なのでその辺はDlookUp関数やIIF関数などをヘルプで確認し変更してください。 [会員番号]はフォームに配置してある >会員番号(テキストボックス)に数値が入力されたら を指しています。 PS. 画像は拡大しても肝心なところが読み取れません。 Windowsのおまけソフトの『Snipping Tool』で必要な部分だけ 切り取ってアップすると吉。
単純復旧モードにしていれば、コミットされたトランザクションはトランザクションログに残らず解放されます。 しかし、コミットされていないトランザクションは解放されていません。 今回のケースですと、何か長いバッチ処理がはしっていませんか？ もしくは、大量のデータを一気に更新する処理をしていませんか？ 例えば２時間かかるバッチ処理をワントランザクションで実行していると、 1時間経過して5GB使用してしまいまんぱんになることはあります。 上記のクエスチョンどちらのケースでも、DBCC SHRINKFILEしても意味がありません。 対応としては、コミット粒度の見直しか、例えばバッチ処理で必要な容量までは トランザクションログを確保するとかでしょうか。 ワントランザクションで10GBトランザクションログが必要なら、 ワントランザクションを維持するには、ログを10GBにするしかありません。 トランザクション粒度を見なおして、１トランザクションで必要な容量を 数GBにするとかでしょうか。 ちなみに以下のケースもあるので、ご注意。 １　データ更新料は少ないが、数時間かかるトランザクション ２　１０分程度でおわるがデータ更新料が多いトランザクション ３　それいがいのトランザクション １〜３の順番にトランザクションが実行されると、１がコミットされるまでは、 ２と３の分のトランザクションログは解放できないのです。
こちらを参考に進めてください。 コントロールの囲み罫の代わりにLineメソッドで線を引きます。 [AC95] 印刷時拡張を設定したレポートで横罫線をそろえる方法 https://support.microsoft.com/ja-jp/kb/404907/ja [ACC2002] レポートのセクションのサイズに比例して縦線が伸びない https://support.microsoft.com/ja-jp/kb/286247/ja
試してみなはれ。 （関西人じゃないけど・・・） Accessの日付時刻型は倍精度浮動小数点型です １日を１として時・分・秒は小数で扱われます。 今回の場合は 30を切る ということなので Date()+29 と解釈しました。 勘違いかな？ たまにやらかすので私の回答は眉唾かも？
対処方法がここの注意書きに載っています。 https://msdn.microsoft.com/ja-jp/library/cc42669 … フィルターする前にシングルクォートが含まれるかチェックする必要があるのは・・・。
なぜExcel上で『重複する主キー』が存在するのか その訳は何か・挿入する場合の規則性を確認することから始まるのでは？ 質問者さんの言われている「履歴」についても 新しいデータを既存のデータ下/上に追加とかいろいろ考えられそうです。 機械的に単純に・・・ならインポートの際にはExcelの主キー列／Accessの主キーフィールドを 除外してAccess上で新たにオートナンバー等々で割り振ってしまえば・・とも考えられますが 他のシステムとの整合性が取れなくなりますね。 なので、最初の二行に戻ってしまいますが 重複レコードの分析、元データ作成（入力）者へ確認・・からじゃないですかね。 以上ご参考までに。
＞サイト上から直接のログは消したものの ＞DBの容量の削減手順や方法が調べても テーブルからデータを削除したけど容量がへらないということ？ データ削除すれば減るはずですけど。 念のためインデックスを再構築して、テーブルの最適化してみては 環境がゆるせばパーティショニングするとか検討してみてもよいかも
なんか、DT,SE等を個別に取り出そうとしているように見えますが テーブルを JOINして SY, SE, ZU(ロジック２相当), DT(ロジック３相当), SE_2(ロジック4相当), DT_2(ロジック5相当) とすれば、1行で必要な情報が全て揃います。 ロジック6: DTとDT_2の比較 ロジック7: DT_2でソート ロジック8: 先頭の指定行数を選択。下記等を参考に https://oshiete.goo.ne.jp/qa/2624660.html ロジック9: SE_2 ※　同じDTに対応するSEが二つ以上あって、その全てを選択したい、というのなら、 もう一回JOINしてDT_2に対応させたSE_3の作る必要があるでしょう。
>論理更新については検索ヒットもなくよくわかりませんでした 論理削除は削除したレコードを残しておいて、後で何を削除したか 確認できるようにすることですが、論理更新では更に一歩すすめて レコードの更新を ・旧レコードの論理削除 ・旧レコードの内容を更新したものを新規挿入。 に置き換えます。つまり全ての更新履歴がDBの中に 残ることになります。金銭を扱うDBではよくやる処理方式です。 レコードは作成日付、更新日付や更新回数など、おきまりの 列をもつことになります。
> それは「レコードの移動を検出して」ということなんでしょうか。 そうです。 dataTable_RowChangedイベントで行の移動が検知可能そうです。 自前で実装するとテキトーですが、以下のようになると思います。 private void button1_Click(object sender, EventArgs e) { // DBから取得したと仮定 var dt = new DataTable(); var c = new DataColumn("column1"); dt.Columns.Add(c); c = new DataColumn("column2"); dt.Columns.Add(c); var r = dt.NewRow(); r["column1"] = "1-1"; r["column2"] = "1-2"; dt.Rows.Add(r); r = dt.NewRow(); r["column1"] = "2-1"; r["column2"] = "2-2"; dt.Rows.Add(r); // DBに応じたTableAdapterと紐づけ // BindingSourceと紐づけ var bs = new BindingSource(); bs.DataSource = dt; dataGridView1.DataSource = bs; // 行変更イベントの設定 dt.RowChanged += dt_RowChanged; } void dt_RowChanged(object sender, DataRowChangeEventArgs e) { Console.WriteLine("行の値が変更された"); // ここでTableAdapterでUpdateを行う } また、そんなことせずとも、データソースを登録しておいて、データソースを画面上へ貼りつけることにより、ほぼ動作するスケルトンが出来上がります。 それに対して、RowChangedイベントでもデータ更新するような実装を加えてしまえば、ご希望の動作をするのではないでしょうか。 大分古い、かつVB.NETですが、以下記事が参考になると思います。 http://www.atmarkit.co.jp/fdotnet/vblab/vb2005m_ … http://www.atmarkit.co.jp/fdotnet/vblab/vb2005m_ … データベースエンジンの違いは関係ありません。 勝手に違いを吸収してテーブル更新を行ってくれます。 具体的なクエリの発行内容が分からないや、何やってるかわからないなどの理由で嫌う人もいますが、好き嫌いなど度外視して構わないほどあっさり動作してくれますよ。
> 初歩的な質問＆ざっくりな質問ですが「処理時間を早くする」というのは、「できる限りSQL文を1回で終わらせること」という認識でよいのでしょうか？ 合ってもいますが違ってもいます。 例えば、全然内容の違う10個のSQLを、ネストさせて1つに統合した場合は、トータルで見た時にそれほど早くなりませんが、 データ部のみが異なる同一のSQLで10000回ループするロジックを、1つのSQLに付随する10000個のデータという形にした場合は相当違いが出ます。 早くなるのは、元々パソコン自体が特定の単位毎に情報を処理していることと、SQLが極端なまでに集合演算の仕様に最適化されていることの相乗効果です。 (前者の例では集合10から集合10のまま、後者の例では集合10000から集合1に変化しているため早くなる) で、今回のご質問内容ですと、集合演算を意識した上でなら、SQLで実装してもプログラムで実装しても、SQL実装の方が若干早い程度にとどまると思います。 ただ、SQLで実装すると複雑なネストや演算を避けて通れないデータ構造である気がしたので、 そういうのが得意なプログラム側実装でどうやるのかという視点で考えた上での回答です。 MYSQLでのやり方はよく分からなかったので、そういう意味だとお役になっていない情報かとは思いますが。
ご利用のクライアント環境はどうなっているのでしょう？ (1)MySQLの標準クライアント (2)MySQL WorkbenchやphpMyAdminなど接続用のアプリ (3)phpなどから直接プログラムの一部として実行
試せる環境がないので検索した結果になりますが、このURLのNo.8の否定がそうなんじゃないでしょうか。 stackoverflow.com/questions/11905868/check-if-sequence-exists-in-postgres-plpgsql 検索ワード「postgresql sequence exists」
DBF Viewer Plus で読み込ませてみます。読めたのなら(◆Table Type が xBaseIIIであることを確認します)別名で保存して、その後、別ディレクトリにコピーします。ＯＳ上で、コピーしたファイルのフィル名を該当名に変更します。出来たファイルを本番環境にコピーして試してみても良いかと。但し、インデックスファイルを使用していないことが条件です（下記参照）。 ◆Table Infoで見て《FoxBASE+/Dbase III plus, no memo》とあればok。違ったらアウト。 インデックスと同期がとれていない状態で業務システムを使うと、リンゴを更新したつもりがイチゴを更新していた、等となります。 上記で上手く行っても(at your own risk)、そちらのシステムで、ずっとＯＫとは限りません。２０年ほど前、dBase iii (plus), dBXL, Excel97 で相互運用をかましたシステムで良く発生していた障害(インデックス関係なくとも)です。これに dbf ファイルの level が絡むと、何が何やら。 その頃、小さな会社の社長や専務が、dBXL で自社システムを作っていたな。それでも、複数テーブルでインデックスを使っていたっけ。それらのシステムはどうなったんだろう。そういえば、dBase iii と dBase iii plus って微妙にちがうんだ。 閑話休題 dBXL じゃ引っ掛からないので... google [dBase 開発 請負] ***確認方法 その１ >差し替えてみるとかだけでは これが出来るという事は、該当ディレクトリが分かると云うことですよね。そこで確認(*.ndx ファイルが存在しない事)できます。 その２ XPのデスクトップアイコンをダブルクリックした直後状態が、dBXL INTRO 状態なのか、作りこまれた業務メニューなのかが判然としないのですが。 [F4] で下記が実行されます。 XL[1] > dir 上記の様にやって、*.ndx ファイルが存在しない事。 Q. 起動直後って、《業務メニュー》なんですよね？ 【回答希望】 *** ps. 分かっている人向け[素人が手を出すと火傷する] google [dbf ファイル 修復]
例えばこんな感じ //５問用意 create table questions (id int not null primary key,mondai text,kotae text); insert into questions values(1,'aaa','AAA'),(2,'bbb','BBB'),(3,'ccc','CCC'),(4,'ddd','DDD'),(5,'eee','EEE'); //is_correctは正解は1、不正解は0として、１番は3回答中1正解、2番は1回答中1正解、4番は1回答中正解なし、3番5番は回答なし create table question_histories(id int not null primary key auto_increment, questions_id int , is_correct tinyint); insert into question_histories(questions_id,is_correct) values(1,0),(1,0),(1,1),(2,1),(4,0); //集計 select q.id,mondai,seitouritu from questions as q left join(select questions_id,sum(is_correct=1)/count(*) * 100 as seitouritu from question_histories group by questions_id) as h on q.id=h.questions_id nullをどうするか別途調整、0とみなすのか、nullでいいのか、表示さえしないのか・・・
そちらの状況が不明です。 関連しているテーブル、MT_受付一覧・MT_キャンセル・MT_成績の各フィールド名とデータ型、 それぞれ数レコード程度のサンプル、 Q_キャンセルのSQL文、 反映させるとは具体的に上記レコードをどのようにしたいのか、 以上を提示してください。
> チェックしたい値が他にも大量にある場合はどうすればいいのでしょうか。 大量にあるならば、その『大量』にある値を、どのように指定するつもりだったのでしょうか？ 一度に行いたいなら、当然ですが、以下のように、テーブルなどが必要になると思います。 CREATE TYPE valuelist AS TABLE (val int) GO DECLARE @v AS valuelist INSERT INTO @v (val) VALUES (1) ,(3) ,(5) SELECT val FROM @v WHERE val NOT IN (SELECT NO FROM テーブル名) GO もしくは、『大量』にある値をエディタおよび正規表現などを利用して、 SELECT 値 val UNION ALL SELECT 値 UNION ALL ・ ・ ・ SELECT 値 という形に整形した上で、コピペを利用してSQLを以下のように組み立ててればいいのでは。 SELECT WK.val FROM ( SELECT 1 val UNION ALL SELECT 3 UNION ALL SELECT 5 ) WK WHERE WK.val NOT IN (SELECT NO FROM テーブル名) GO どちらにしても、『大量』にある値を操作して『一括して必要な形に整形する必要がある』ため、いちいちテーブルを用意しなければならない前者より、後者で十分かもしれません。
＞monthだけがNULLになってしまいます。 あれ、データの投入とかなにか違うのかな・・・ 以下テストデータでやってもダメでしょうか？ //元データ作成 create table hoge (room int, reservation varchar(10), daytime date); insert into hoge values('1','空き','2015-05-01'),('1','空き','2015-05-02'),('2','予約','2015-05-01'),('2','予約','2015-05-02'),('1','予約','2015-06-01'),('1','空き','2015-06-02'),('2','予約','2015-06-01'),('2','予約','2015-06-02'); //集計 select case when daytime BETWEEN '2015-05-01' AND '2015-05-31' then '2015年05月' when daytime BETWEEN '2015-06-01' AND '2015-06-30' then '2015年06月' end as month ,room,sum(reservation='予約') as reserved from hoge group by month,room
CSVファイルにタイトル行が有り、テーブルのフィールド名と同じ、 列数も同じ（オートナンバー型フィールドは除く）、 ならTransferTextメソッドでインポートはだめですか。 安全のためインポート定義を利用するべき オートナンバー型フィールドは考えなくとも自動的に処理されます。 トランザクション処理が出来ないからNGか・・・。 インポート出来ないデータ型（数値に文字など）の場合は インポートエラーテーブルが自動生成され記録されます。 テキスト型に255超の文字数の場合、超過分は黙って切り捨てられ エラーは記録されません。 姑息な方法かもしれませんがインポート前にオートナンバーの最大値を控え インポート処理後にエラーテーブルの有無・レコード数の増加をチェックし 変化が有れば削除クエリで元に戻す。 オートナンバーが大きく飛ぶので最適化で修正 Access VBA 自身を最適化 でGoogleとVBAサンプルもあるけど。。。 ・・・ 現状の方向だと dim v() as variant,i as integer v=split(txtData,",") '配列に格納 for i= lbound(v(i)) to ubound(v(i)) debug.print i,v(i) '添え字と値（タイトル）の確認 next with rec .addnew !購入者氏名(漢字)= v(2) !注文日時= cdate(v(0) ) 'Cdate 要らないかも？ ・・のように対応する配列を指定 .update end with のようになるかと思います。 ただ、CSVファイルを、,カンマで分割して配列に入れているだけなので ExcelでCSV出力した時のようなフォーマット （位取り有りの数値にダブルクォートがついて、"1,100"） 区切り以外でカンマが使われていると項目数・データとも崩れます。 Rollbackすることに。
残念ながら、それはモノによるとしか言えません。 Windows8.1 64bit ＆ Access2013 32 bit で Access2000に付いてくるサンプルファイルのNorthWind.mdb は動作しました（変換も新規accdbに外部データベースのインポートで可能です）。 ただ、 2013になって削られた機能があります。 https://support.office.com/ja-jp/article/Access- … 準備（覚悟）だけはしておくべきだと思います。 ユーザーインターフェイスも変わりましたし。
＞本題のuniqueをCCCだけに変更するやり方を教えていただけますか？ 具体的には CREATE TABLE `AAA` ( `id` char(5) NOT NULL PRIMARY KEY ,`BBB` char(3) NOT NULL ,`CCC` varchar(50) NOT NULL ,UNIQUE KEY `UK_AAA` (`BBB`,`CCC`) ); INSERT IGNORE INTO `AAA` VALUES('id001','xxx','test1'),('id002','xxx','test2'),('id003','yyy','test1'),('id004','xxx','test2') とすると、BBBとCCCの組み合わせによって、id004のINSERTが拒否されます その際BBBはxxx、CCCはtest1という同じ値を持っていてもINSERTできていることを理解してください ここで、インデックスUK_AAAを外したとして、 ALTER TABLE `AAA` DROP INDEX `UK_AAA`; あらたにBBBやCCCだけのユニークを作ろうとしても すでにユニークでないデータがあるため処理できません。 ALTER TABLE `AAA` ADD UNIQUE`UK_AAA2`(`BBB`); エラー：Duplicate entry 'xxx' for key 'UK_AAA2' ALTER TABLE `AAA` ADD UNIQUE`UK_AAA3`(`CCC`); エラー：Duplicate entry 'test1' for key 'UK_AAA3' それぞれxxx、test1がダブってるから無理というエラー データ投入後にあとからユニーク属性をつけるのであれば ダブリデータを手動で削除したのち、ALTER TABLE してください ちなみにCCCにダブリデータがあるかどうかのチェックはこんな感じ SELECT `CCC` FROM `AAA` GROUP BY `CCC` HAVING COUNT(*)>1
table3の順序付けとidの指定ができない table1とtable2でidが競合したときになぜtable3ではなぜ青森が1を取得できるか定義が必要。 table3の並び順が適当でidも適当に連番をふればいいならこんな感じ select (select @id:=@id+1 from (select @id:=0) as dummy) as id,area from( select area from table1 union select area from table2 ) as dummy
でしたらフォームB（条件設定画面かな？）にコマンドボタンでも作成し クリック時イベントなどに if currentproject.allforms("フォームA").isloaded = false then docmd.openform "フォームA" '開いてなかったら開く end if Forms!フォームA.recordsource = "SELECT 顧客情報TBL.* FROM 顧客情報TBL WHERE [顧客情報TBL].[利用予定日] Between " & [Forms]![条件設定画面]![コンボ12] & " And " & [Forms]![条件設定画面]![コンボ14] & " ORDER BY [顧客情報TBL].[利用予定日] DESC;" のようにレコードソースを変更するか、 フォームA自体には抽出条件を設定しないひな形フォームとして作成しておきます。 dim sFilter as string if currentproject.allforms("フォームA").isloaded = false then docmd.openform "フォームA" '開いてなかったら開く end if sFilter = ・・・・sFilterに条件を書き込むのですが具体例が挙げられません sFilter の作り方は前回回答のVBAコードを参照してください。 debug.print sFilter 'イミディエイトウィンドウで正しくできているか確認 Forms!フォームA.filter = sFilter Forms!フォームA.filteron = true のような流れになります。べた打ちなので間違っているかも。
>これを管理するには2つのテーブルで分けて管理するしかないですか？ むしろこれをどうやって２つに分ける方が難しいのでは？ //テーブル作成・データ投入 create table item(id int unique,サイズ varchar(10),肩幅 double,身幅 double,着丈 double); insert into item values(1,'XS',40,45,59),(2,'S',44,52,65),(3,'M',48,56,70),(4,'L',50,60,75); //表示 select * from item;
そもそもの話 「SQL Server2012 Management Studio」は、単なる管理ツールであってDB本体ではない それとも「Express with Tools」とか「Express」と言ったモノを、「SQL Server2012 Management Studio」と誤表記しているのだろうか？ 色々やってインストールしたとしか書かれていないので何とも言えんが・・・・
普通はまず伝票管理テーブルをつくり、 カテゴリやアイテムを正規化してこんな感じにします。 //伝票管理テーブル create table denpyo(did int not null auto_increment primary key,dno int unique key); insert into denpyo(dno) values(1),(2),(3),(4),(6),(7),(8),(9),(10),(12),(14),(15),(18),(20),(21),(22); //カテゴリーテーブル create table cate(cid int not null auto_increment primary key,ccode int not null unique key,cname varchar(100)); insert into cate (ccode,cname) values(101,'10代'),(102,'20代'),(103,'30代'),(104,'40代'),(105,'50代'),(111,'カップル'),(112,'ビジネス'),(113,'友人'),(114,'家族連れ'); //アイテムテーブル create table item(iid int not null auto_increment primary key,icode int not null unique key,iname varchar(100)); insert into item (icode,iname) values(1001,'ﾍﾞｼﾞﾏﾖﾁｷﾝL'),(1002,'ﾎﾟﾀｰｼﾞｭL'),(1003,'ﾍﾞｼﾞﾐｰﾄ油淋鶏'),(1004,'前菜盛合せ'),(1005,'ﾍﾞｼﾞﾏﾖﾁｷﾝ'),(1006,'本日のﾊﾟｽﾀ'),(1007,'Tsﾍﾞｼﾞｶﾚｰ'),(1008,'SPﾌｰﾄﾞ'),(1009,'ﾅｯﾂｻﾗﾀﾞ'),(1010,'ﾛｰｽﾄ野菜'),(1011,'ｶﾘﾌﾗﾜｰのﾑｰｽ') ,(2001,'ｼﾞﾝﾄﾆｯｸ'),(2002,'ｶﾝﾊﾟﾘｿｰﾀﾞ'),(2003,'ﾋﾟｴｰﾙｶﾛ'),(2004,'ｿﾙﾃｨｰﾄﾞｯｸﾞ'),(2005,'ｼﾞﾝｼﾞｬｴｰﾙ'),(2006,'ｺｰﾗ'),(2007,'生ﾋﾞｰﾙ(中)'); ここから伝票とカテゴリー・アイテムをリレーションします //伝票-カテゴリーテーブル create table denpyo_cate(dcid int not null auto_increment primary key,dno int,ccode int,unique key(dno,ccode)); insert into denpyo_cate(dno,ccode) values(1,111),(1,103),(2,111),(2,102),(3,104),(4,102),(6,112),(7,113),(7,102) ,(8,114),(8,105),(9,114),(9,104),(10,114),(10,104),(12,114),(12,104),(14,102),(15,101),(18,111),(18,104) ,(20,114),(21,112),(21,102),(22,112); //伝票ｰアイテムテーブル create table denpyo_item(diid int not null auto_increment primary key,dno int,icode int); insert into denpyo_item(dno,icode) values(1,1001),(1,1002),(1,1003),(1,2001),(1,2002),(1,2003),(1,2001),(1,2002),(1,2004) ,(2,2005),(2,2006),(2,1004),(2,1005),(2,1006),(2,1007) ,(3,2007),(3,1008),(3,2003),(5,1002),(5,1001),(6,1009),(6,1010),(6,1011),(7,2001); それぞれ表示 select dno,cname from denpyo_cate as dc inner join cate as c on dc.ccode=c.ccode order by dcid; select dno,iname from denpyo_item as di inner join item as i on di.icode=i.icode order by diid; 最終的にはこう select d.dno,dc.ccode,c.cname,di.icode,i.iname from denpyo as d inner join denpyo_cate as dc on d.dno=dc.dno inner join cate as c on dc.ccode=c.ccode inner join denpyo_item as di on d.dno=di.dno inner join item as i on di.icode=i.icode order by did,dcid,diid;
普通にできない？ create table hoge (name varchar(10),address varchar(100)); alter table hoge add id int after name; alter table hoge add score int first;
そもそもテーブルの作成なんてそうそう頻繁におこなうものでもないので 一気に作る構文自体あまり意味がないのでは？ べつに対して省略できるわけでもないし・・・ ×CREATE TABLE tb1(c1 int), tb2(c1 int); ○CREATE TABLE tb1(c1 int); CREATE TABLE tb2(c1 int); おなじ構造のテーブルを作るときに心情的に手を抜きたいだけなら LIKE構文がつかえるみたいですが、まぁこれも使って便利なのかどうか・・・・ CREATE TABLE tb1(c1 int); CREATE TABLE tb2 LIKE tb1; どうしてもというならプログラムで処理すればよいのでは？
> 私もちょっとイメージが完全にはつかめておりません イメージを完全につかんでください。 やりたいこと（条件）を整理してください。 > 複雑な式も可能なのかな？ やりたいことが整理されてからでないと 条件付き書式で色々設定しても堂々巡りになってしまいますよ。 私からは以上です。
>そういうデータが恐らく1万件近くあります。 ↑このデータ次第のように思えます。 #1 さんの方法の他に、 たとえば、 Address1　Address2　Distance Tokyo　　　Oosaka　　　　10 Tokyo　　　Chiba　　　　　1 Tokyo　　　Kanagawa　　　 2 Oosaka　　　Chiba　　　　 5 の様ならパラメータクエリで 図のようにしておけば、データが Tokyo　　Oosaka　　　　10 でも Oosaka　　Tokyo　　　　10 でも問題ありません。 また起点/終点どちらかを未入力なら、 入力した方の一覧が出て来るかと。 で、パラメータ部分（[起点は？]、[終点は？]）を フォームのテキストボックスに変更すれば・・・。 なにはともあれ、元データ次第のような気がします。
普通に考えて →プロシージャでは変数名を``で囲める →変数名とカラム名が競合したときは、変数名が優先される →テーブル名.カラム名で参照すればカラム名だと明示されるのでカラム名のまま参照できる という認識でよいのでは？ たとえばプロシージャ内で SELECT `table`.`criteria`,`criteria`,criteria from `db`.`table`; として結果をみると、最初のcriteriaはカラムとして扱われますが残りの２つは 変数を引っ張ってきます
mysqlクライアントをコマンドラインから実行しようとしているという理解でよろしいですか？ またその環境がマストなのでしょうか？ たとえばmysqlクライアントを公式のMySQL Workbenchにするとかどうですか？ http://www-jp.mysql.com/products/workbench/ もちろん、mysqlユーザーであればphpMyAdminあたりを標準的な クライアントツールとして使うのも手かもしれません。 （pmaは実際にはmysqlクライアントというよりサーバー機能の一部みたいな感じですが） また、サーバー側で接続クライアントのhostを制限している場合もあるので ご自身でサーバーの設定をいじれるなら、使用可能hostにWinのIPアドレスを追加してやり ユーザーテーブルを更新してみてください
idと同じ値をp_codeにいれる？ それってp_codeのカラムをつくる必要ないのでは？ また3桁のゼロフィルとは「001」~「999」までということ？ （まぁ桁あふれしたらかってに４桁になるんですけどね）
ちょっとPerlのDBIには疎いのでもうしわけないですが my.cnfなどサーバー側の設定ファイルで明示的にDBの文字コードを設定したり connectする際にオプションでon_connect_do => ['SET NAMES utf8'], したりすることで解消できるかもしれません。
現時点、および2-3年先の予想で、社内で11gか12cかどちらの方が多く使われているか、多く使われていそうか。がポイントでは？
＞何種類もの置換があり、置換ダイアログ(ctrl+f)では大変なので、 ＞ボタン1つで自動化できないものかと思って投稿しています designerで編集ができるなら別ですが、 クライアント側でできることは限られています。 とくにメールDBを編集すること自体かなりリスキーなので より高度の管理者にお願いするしかないと思いますよ
power pivotは使ったことはありませんが、ExcelDevToolのExcelアドインに テーブルデータ集計とデータマッチングの機能があり、希望されていることが 実現できると思います。SQLを書いて、Excelのテーブルを検索することができますが、 ウィザードでSQL自動生成できますので、基本的に自分で書く必要はありません。 ご参考ください。 ２０代というフラグが立っている伝票の総計を出すこと: SELECT SUM(金額) FROM T1 WHERE フラグ='20代' 集計の例： カテゴリデータとPOSデータのテーブルをつなぎ: データマッチングでできます。 　例： https://www.youtube.com/watch?v=TitRpy797ZI
>「タブ0」の中にページが5つ設定されている状態となっております でしたら、#2 の回答で、ＯＫ牧場！です。（古っ） タブコントロール名やページ名は適宜読み替えて行ってください。
select 売上日 as 日付 , sum(case 商品 when 'A' then 数量 end) as 商品A , sum(case 商品 when 'B' then 数量 end) as 商品B , sum(case 商品 when 'C' then 数量 end) as 商品C from 売上 group by 売上日
残念ながら Access 2013 で廃止、変更された機能 https://support.office.com/ja-jp/article/Access- … にあるようにExcelで行ってね・・・という事のようです。 ただ、クロス集計クエリでも実現できるのでは？と思います。 作成タブ中のクエリウィザードからクロス集計クエリウィザードが用意されています。 Access で SQL ビューを使ってクロス集計クエリを作成する http://mnrt.hatenablog.com/entry/2015/02/crossta … クロス集計クエリを使用して集計データを読みやすくする https://support.office.com/ja-jp/article/%E3%82% … 挑戦してみてください。
GROUP BYのグループ化条件にCASE式を使えばいいと思います。 WITH使って1月/2月/3月以降というデータを持つ列を増やす方法もありだと思います。 ただ，条件どおりに行うと3月以降のpriceが300ではなく1200になりますが。 --- お試し ここから --- DECLARE @table TABLE ( [id] INT, [month] NVARCHAR(3), [limit] DATE, [price] INT ) ; INSERT INTO @table ( [id], [month], [limit], [price] ) VALUES ( 1, N'1月', CAST('2015-01-01' AS DATE), 100 ), ( 1, N'1月', CAST('2015-02-01' AS DATE), 100 ), ( 1, N'2月', CAST('2015-03-01' AS DATE), 200 ), ( 1, N'2月', CAST('2015-04-01' AS DATE), 200 ), ( 1, N'3月', CAST('2015-05-01' AS DATE), 300 ), ( 1, N'4月', CAST('2015-06-01' AS DATE), 300 ), ( 1, N'5月', CAST('2015-07-01' AS DATE), 300 ), ( 1, N'6月', CAST('2015-08-01' AS DATE), 300 ) ; SELECT [id] AS [id], CASE MAX([month]) WHEN N'1月' THEN N'1月' WHEN N'2月' THEN N'2月' ELSE N'3月以降' END AS [month], MAX([limit]) AS [limit], SUM([price]) AS [price] FROM @table GROUP BY [id], CASE [month] WHEN N'1月' THEN 1 WHEN N'2月' THEN 2 ELSE 3 END ; WITH temp AS ( SELECT [id], [month], CASE [month] WHEN N'1月' THEN N'1月' WHEN N'2月' THEN N'2月' ELSE N'3月以降' END AS [temp_month], [limit], [price] FROM @table ) SELECT [id], [temp_month] AS [month], MAX([limit]) AS [limit], SUM([price]) AS [price] FROM temp GROUP BY [id], [temp_month] ; --- お試し ここまで --- テスト環境 (SELECT @@VERSIONの結果) Microsoft SQL Server 2014 - 12.0.4050.0 (X64) Feb 19 2015 18:37:03 Copyright (c) Microsoft Corporation Express Edition (64-bit) on Windows NT 6.3 <X64> (Build 9600: ) (Hypervisor)
＞全部放り込めば良い それでいいんじゃない？ 正規化については「必要」もしくは「効率的」だからやるものなので みる限り正規化するような項目があるようにも思えませんので。 ただしこれを拡張していく場合、たとえば履歴をどうするかとか カテゴリー分けしたりキーワード検索したいとか、 そういう用途に合わせて正規化した方がよい場合もでてくると思います
10年前の書籍になりますが・・・。 ＞改訂版 図解 ネットワークのしくみ 単行本 – 2005/2 ＞http://www.amazon.co.jp/%E6%94%B9%E8%A8%82%E7%89 … 　1円か・・・。
＞windows 7 pro　32bit 32bit版ODBCをインストールしましたか？ コントロールパネルから起動せずC:⁄Windows⁄SysWOW32フォルダにある「odbcad32.exe」を起動。 ODBCデータソースアドミニストレーターが表示され32bit版ODBCが設定出来る（とのこと） http://infith.com/system/database/mysql_odbc_win … ＞Winmysqladmin1.4が起動するのですが、赤信号になってしまい、緑信号表示になりません WinMySQLAdmin1.4を起動させるとメモリアクセス違反が起こる場合、タスクマネージャでwinmysqladmin.exeを強制終了すると消える。libmysql.dllというモジュールが犯人らしいがそれ以上不明。 http://satzz.hatenablog.com/entry/20080211/12026 …
テーブルCを更新しないなら、二つを結合したビューを作るのが一番簡単かと create view C(...) as select ... from A union all select ... from B 参考) http://dev.mysql.com/doc/refman/5.6/en/union.html http://dev.mysql.com/doc/refman/5.6/en/create-vi … 更新するなら、素直にテーブルCにデータを移転してA,Bは廃棄でしょう create table C(...) select ... from A insert into C(...) select ... from B drop table A,B 参考) http://dev.mysql.com/doc/refman/5.6/en/create-ta … http://dev.mysql.com/doc/refman/5.6/en/drop-tabl …
２番目の 累計: DSum("商品の数","Q2f2_受注記録_累計","発送日 <=" & [発送日] & "AND 在庫管理ID =" & [在庫管理ID]) は 累計: DSum("商品の数","Q2f2_受注記録_累計","発送日 <=#" & [発送日] & "# AND 在庫管理ID =" & [在庫管理ID]) では。（発送日が日付時刻型、在庫管理IDが数値型とした場合） # で括るのと AND の前に半角スペースがありません。 １・３番目は不明。
http://matome.naver.jp/odai/2138467754754094901 の内容が酷似しているなあ。 まずタスクマネージャーでRegClean Proというのを強制的に終了させる。 コントロールパネルのアンインストールになければSystweak Software社のやつだから プログラムファイルから　Systweak　らしきフォルダを見つけてとりあえず別名に変えとく。 後はCCLEANERとかで自動起動するプログラムをチェックして怪しげな奴は一つ一つ潰していく。
select テーブル2.値 from テーブル2 where exists (select * form テーブル1 where テーブル1.No = テーブル2.No and {通常の条件} ) or exists (select * form テーブル1 where テーブル1.No = テーブル2.No and {もう一つの条件} ) or exists (select * form テーブル1 where テーブル1.No = テーブル2.No and {おまけの条件} )
http://www.accessclub.jp/bbs/0007/beginers3124.h … では難しいことを回答されてますが、普通は http://members2.jcom.home.ne.jp/cozy.nakayama/Ac … で設定します。
アクセスは、データが入っていない状態と長さ0の文字列が入っている状態を区別しているからかな？ フィールドを数値にして規定値を0にして問題がないなら、そうするのもありかな。
for /f "delims=" %%A in ('sqlcmd ～～～') do set A=%%A echo %A%
たぶん select A.入金日, A.会員No, sum(A.入金額) from [ select 会員No, 入金日1 as 入金日, 入金額1 as 入金額 from テーブル1 where 入金日1 is not null union all select 会員No, 入金日2 as 入金日, 入金額2 as 入金額 from テーブル1 where 入金日2 is not null union all ... ]. as A group by A.入金日, A.会員No
oracle は知らないのですが。 ・・・ atbl.数量, DLookup("得意先コード", "btbl", "納品番号=" & [納品番号] ) AS 得意先コード from ・・・ とかですかね？ 「納品番号」がテキスト型なら DLookup("得意先コード", "btbl", "納品番号='" & [納品番号] & "'") AS 得意先コード
このサイトで解決できないのでしょうか？ https://support.microsoft.com/ja-jp/kb/2730109/ja
単価テーブルに時期を追加してクエリのフィールドに部分を作る考えでいいですかね？ ざっくりになりますが、下記の感じでどうでしょう？ 「時期分岐:IIf([単価テーブルの日付]>=[クエリの日付],"100円","150円")」
DBの種類やバージョンによってUNION時の挙動にばらつきがあるみたいですね。 本来二つのテーブルのデータ型が同じであれば、切り詰められることはないはずですけどね DB側の制限だとそのままでは解決できないので たとえばテンポラリテーブルをつかえるDBならAテーブル、Bテーブルを順に 流し込んで結果を取得するなど工夫するしかないかも
コマンドラインのmysqlクライアントで文字化けしないということは やはりデータの投入は成功しているのでしょうねぇ・・・ 拡張sjisのcp932でしたから、「set names cp932」の実行でしたね mysql_query("set names cp932"); をしてから、それ以降のmysql_query()を実行していますよね？ 一度発行すれば同じセッション内では有効なはずです。 ただこの掲示板でもよく注意されているのでおわかりだと思いますが mysql_系の関数はすでに非推奨状態なので、できるかぎりPDOへ 切り替えていく方が今後のトラブルを最小限に抑えることができると思いますよ
このバージョンだとなるみたいなんで手作業で分割する方法があがってます。 参考にしてみてください。 https://support.microsoft.com/ja-jp/kb/304932/ja
>Private Sub レコードの追加_Click() のコマンドボタンなどがメインフォーム上にあり .FindFirst "宿泊日=#" & D & "# AND 請求書_詳細ID =" & Me.請求書_詳細ID の末尾のMe.請求書_詳細IDがサブフォーム上にあるのでしたら .FindFirst "宿泊日=#" & D & "# AND 請求書_詳細ID =" & Me!サブフォームコントロール名.Form!請求書_詳細ID でしょうけど、。。。 http://hatenachips.blog34.fc2.com/blog-entry-347 … Me.請求書_詳細ID が重複している、 OR コントロール名を間違えている、かも？ Me.請求書_詳細ID は何処にあるのでしょう。？ 謎の仕様。 上手く行かなかったらより単純に .FindFirst "宿泊日=#" & D & "# AND 請求書_詳細ID =1" でもお試しを。
たぶん select C.顧客ID, C.顧客名 , (select 電番 from (select row_number() over (order by T.電番ID) no, T.電番 from 電番 T where T.顧客ID = C.顧客ID) where no = 1) 電番1 , (select 電番 from (select row_number() over (order by T.電番ID) no, T.電番 from 電番 T where T.顧客ID = C.顧客ID) where no = 2) 電番2 , (select メア from (select row_number() over (order by M.メアID) no, M.メア from メア M where M.顧客ID = C.顧客ID) where no = 1) メア1 , (select メア from (select row_number() over (order by M.メアID) no, M.メア from メア M where M.顧客ID = C.顧客ID) where no = 2) メア2 from 顧客 C
複数のテーブルをつないだクエリは「基本的に入力できません」・・・これが原則です。 入力できるのは リレーションシップがきちんと作成されている（１対１または１対多） 集計関数を使っていない などの条件があります。（前の方が示されたリンク先にはこれが書かれています） で、それをクリアしているとしても、一つ注意しなければならないことがあります。 売上伝票の例にします。 売上テーブル　＝　伝票番号　得意先ＩＤ　日付 明細テーブル　＝　伝票番号　明細番号　商品ＩＤ　数量　単価 となっている場合（売上の伝票番号と明細の伝票番号が１対多のリレーションシップ）に、 クエリは 　　伝票番号　明細番号　得意先ＩＤ　日付　商品ＩＤ　数量　単価 と作成すると思いますが、 この“伝票番号”は売上テーブルの伝票番号ではなく、明細テーブルの伝票番号にしないといけません。 「リレーションシップが設定されたフィールドは多側のテーブルのフィールドを使う」ということです。
たとえば http://blog.goo.ne.jp/pc_college/e/aef658131ce0a …
無料体験版（シェアウェア）で作成したファイルがプロジェクトファイル(編集用）の場合は 有料版を購入しないと使用する事ができません。 http://www.nchsoftware.com/videopad/jp/kb/1396.h … 動画ファイルとしてエクスポートしていたのであれば、再生する事は可能です。 今回の場合は、プロジェクトファイルのまま保存していたのではないでしょうか？ http://original-profile.com/?page_id=255 ＞ちなみに無料版をもう一度アンインストールしたら前回までのデータは 　きれいさっぱりなくなってしまうのでしょうか？ その可能性は大ですね。 仮に無料体験版をアンインストールし、再度、無料体験版をインストールしようとしても できませんから。 仮にインストールできても使用する事はできませんし。 「VideoPad」には無料体験版以外にフリー版がありますので、こちらを使用してみられてはいかがでしょう。 http://www.altech-ads.com/library/search.php?key … もしかすると、無料体験版を使用した後なので使えないかも・・ フリー版には機能制限がありますが、もしかすると前回作成したデータが使用できるかもしれません。 取りあえず、前回作成したデータをPC内より探し、コピー保存しておきましょう。 ファイル検索には超高速なファイル検索ソフトがお勧めです。 「Hddb」 http://www.gigafree.net/utility/desksearch/Hddb. … 「Everything」 http://www.gigafree.net/utility/desksearch/every … などがあります。 画面上部のテキスト入力フォーム上に、.vpj と入力して検索。 検索で表示された.vpj ファイルをダブルクリックするとファイルが何処にあるのかが判ります。
めんどくさい検索条件が必要ならば SQL を使わないほうが良いです。 複雑怪奇な SQL は極端な性能劣化とかデッドロック発生とか保守性とか... というわけで テーブルを正規化して条件を簡単にしましょう または PL/SQL を書きましょう
ブレイク処理とは、指定されたキーで集計をするアルゴリズムのことです。 SQLでいう「GROUP BY」に相当します。 GROUP BYについてはここに載せておきますね。 http://www.atmarkit.co.jp/ait/articles/0012/22/n …
こちらのスレッドが参考になりそうです。 http://www.russ.jp/stepbbs/step.cgi?mode=view&no … もしくは空白のみソートして、未来の日付を入れて非表示にしておく（空白に見せる）…くらいしか簡単なものは思いつかないです。 手間でなければ是非(^^)
pid-fileを指定できない設定のようなので、該当行をコメントアウトしてみては？
主キーの設定をきちんとしていないと「リレーションシップ未定義」となります。 主キー設定すると「重複なし」になります。テキストフィールドの値で主キーにしていいのですが、値が重複していると、主キーとして設定できません。 テーブルの中で、重複データが存在しないフィールドを主キーにします。 それぞれのテーブルに主キーを設定したら、 テーブルのリレーションシップは、片方の主キーともう一方のテーブルのフィールド（相手の主キーと同じ種類のデータを格納するフィールド）を結びます。 う～ん、具体的なフィールド名がわからないと、これ以上の説明は難しいです。
開発DBを本番DBにコピーすることはないと思いますが？ データに関しては本番DBが普通は優先ですよね？ もともと開発DBは本番DBからコピーをもってきますよね？ 開発DBでカラムの拡張などした場合は、それを仕様書として保持しておき 最終的にどうとうの拡張を本番DBに反映させるだけです。 もちろん開発DB上で新たに作成したテーブルなどは ダンプしてもってくればよいと思います
主キーが複数ある件については私の不明でした。 http://makoto-watanabe.main.jp/access/acconWhatK … 使ったことがないのでミスリードするかもしれませんから発言は控え目で。 主テーブルのIDには主キー（インデックスあり重複なし）に設定されているか。 （繰り返しになりますがテーブルを開いて何も言ってきませんよね） 主テーブルには他には主キーはないですよね。 枝テーブルには主キーが二つあるようですが インデックスを表示してみて、IDの方にインデックス名が付いていますか？ （枝テーブルの設定が関係してくるかは自信がありません）
クエリのデータを編集できない状況 https://support.office.com/ja-jp/article/%E3%82% …
公式だとこの辺？ http://mysql.stu.edu.tw/doc/refman/5.1/ja/show-e … http://mysql.stu.edu.tw/doc/refman/5.1/ja/innodb …
ランキングの考え方 自分より上位に何人いるかをcountしてそれプラス1が自分の順位ということです
>ユニークキーを設定するとその中の１個でも重複があると全部はじかれてしまいます。 uniqueをつけたうえで、insert ignore intoをつかえばよいでしょう //元データ create table hoge(cn varchar(10) not null unique key); insert into hoge values('aaa'),('xxx'),('yyy'); select * from hoge; //重複を含むデータの挿入 insert ignore into hoge values('aaa'),('bbb'),('ccc'); select * from hoge;
大変申し訳ありません。私の早とちりでした。 つい、PWも書いてあると思い込んでしまいました。 失礼いたしました。 さて、問題の件ですが、 私が回答できるのは推測の域をでませんが、 実際には、設定や手順のチェックシートを作って 全端末の確認を確実にすべきかなと思いますが 初心に戻って、 メッセージが正しいとするならば、(実は正かったという事が結構あります) ・使用している Access2000 ADP は SQL Server 2000までしか対応していない。 ・だとすると、更新できているのは SQL2000(以前のサーバー)に接続していて、 　更新できていないのは、今のSQL2014 に接続している。 という可能性はありませんか? または、Accessのプログラム更新などで途中からSQL2000以降も対応していて、 その更新がされてるかどうかで動きが違うという可能性。
とりあえずエラーメッセージでは 5行目を指摘しているので、 ,(SELECT PREF_NAME FROM PREF_TABLE WHERE ID = A.PREF_ID) AS PREF_NAME これを修正しましょう。そもそも、記述ミスですよね。 ,B.ID AS PREF_NAME と書きたかったのだと思いますが、これだとエラーでますか? エラーになるなら Group by に追加しましょう。 GROUP BY A.PREF_ID, B.ID
ずいぶん大雑把な質問ですが、「サーバー」と呼ばれている物のOSは何ですか？ ローカルに接続とは具体的にどのように接続されていますか？ とりあえず、補足願います。
こういうのはviewを作ってやると理解がしやすい //元データ create table score(id int,data1 double); insert into score values(1,100),(1,90),(2,40),(2,50),(2,60),(3,70),(4,10),(4,20),(5,60),(5,80); //view作成、確認 create view v_score as select id,avg(data1) as avg from score group by id; select * from v_score; //結果 id avg 1　95 2　50 3　70 4　15 5　70 //viewを利用してランク付け select id,avg,(select count(*)+1 from v_score as a where a.avg>b.avg) as rank from v_score as b order by rank asc,id asc //結果 id avg rank 1　95　1 3　70　2 5　70　2 2　50　4 4　15　5 //viewを排除するために、v_scoreに元のsqlを代入 select id,avg,(select count(*)+1 from (select id,avg(data1) as avg from score group by id) as a where a.avg>b.avg) as rank from (select id,avg(data1) as avg from score group by id) as b order by rank asc,id asc;
例えば。 TYPE Inputfile > SORT > Outputfile
＃１です 動きましたか･･･ じゃぁ、前回エラーだったのはシート名が違っていたりしたんでしょうかね。 > 追加された各シートの1行目を「先頭行の固定」＋「フィルタ設定」するにはどうすればよいか教えていただけないでしょうか。 これ、ご自分で操作できるのであれば、「マクロの記録」を使ってみるのも良いかも。 「先頭行の固定」＋「フィルタ設定」を 2007 でやってみると、以下が記述されます。 Sub Macro1() ' ' Macro1 Macro ' ' 　　With ActiveWindow 　　　　.SplitColumn = 0 　　　　.SplitRow = 1 　　End With 　　ActiveWindow.FreezePanes = True 　　Selection.AutoFilter End Sub この記述されたものを、違うシートでステップ実行してみます。 すると、ウィンドウを分割してから枠を固定している事がわかります。 この動きで良ければ、このままの記述を組み込んでいけば良いです。 私が知っている枠固定の方法は別にあって、 　　Range("B2").Activate 　　ActiveWindow.FreezePanes = True とすると、アクティブセルの上側・左側を固定するというもの。 上記は、B2 を指定しているので、１行目と A 列が固定に･･･ 今回は１行目だけなので、左側が無い A2 を指定すれば･･･良いですね で、Samp3 に組み込んでいきますが、フィルタの設定 　　Selection.AutoFilter は、それなりに項目が記述されていないとエラーになるみたいなので、抽出したものを転記した後 　　　　　　　　End With 　　　　　　　　Range("A2").Activate ' ★ 　　　　　　　　ActiveWindow.FreezePanes = True ' ★ 　　　　　　　　Selection.AutoFilter ' ★ 　　　　　　End If 　　　　　　Columns.AutoFit ' 列幅を調整してみた これで、終了･･･でも良いですが、 現状、抽出を繰り返す＝シートの使い回し　になっています。 前回、何件か抽出されていて、今回０件ならシートは空白になりますが、枠固定が残ってしまう事に･･･ 　　　　　　Else 　　　　　　　　v.Activate 　　　　　　　　Cells.ClearContents 　　　　　　　　ActiveWindow.FreezePanes = False ' ★ 　　　　　　End If 上記部分で、枠固定を解除する様にしといた方が良いかも。 オートフィルタは、Cells.ClearContents　することで解除されるみたい･･･？ ※ > もう一点甘えてもいいですか。 動いた･･･とかの後に、追加質問があった場合、 おそらく他の方は回答してこないと思うので、急を要する場合などは別質問にした方が良いかも？ しかも、内容的には Excel のカテゴリになる？ Excel に関しての回答者さんは、Access より多いかな？ 私のわかる範囲で追加等には応えていこうとは思っていますけど･･･ 自分でやったのと、聞いただけのものなら、後々自分でやった方を覚えている？のかな？
画像が小さくて見にくいのですが、 [コード]の更新後処理に me!金額 = DLookUp("金額","Q_クエリ") とか [金額]のコントロールソースに、= DLookUp("金額","Q_クエリ") でしょうか。 Q_クエリ をどうやって生成しているか分からないので 勘違い回答かも？ ご参考まで。 PS. DLookUp("金額","Q_クエリ") では Q_クエリ で複数のレコードが抽出された場合、 最初のレコードが表示されますので、その辺もご注意を。 Windows7のアクセサリの中にSnipping Tool というのがあります。 必要な部分だけ撮ってくれますので便利です。
なんとも言えませんが とりあえず強制でなんとかしたいのであればmysqldを再起動するのが 手っ取り早いかと。 あとはテーブルで利用されるエンジンのタイプにもよるし プログラムで強制的にロックする仕組みをつかっているかにもよりますが まぁあまりテーブルロックを多用しないように工夫するしか本質的な解決は できないと思います
＞要求が失敗したか、サービスが適切な時間内に応答しませんでした SQL Server 2008 ？ 回避するには、サービス管理コンソール (Services.msc) を使用して SQL Server エージェントサービスを開始 http://support.microsoft.com/kb/955494/ja
accdc 何処かで見たような拡張子・・・。 これですかね。 http://answers.microsoft.com/ja-jp/search/search … 今のところ４スレッドしかないので一通り目を通してみてください。 accdc になるのはアップデートで持ち込まれたバグの様です。 拡張子をaccdb に変えれば使えそうな事も書かれていますし、 より確実に手作業で行った方が・・・とも。 デジタル署名は公的な機関で取得でもしない限り、あまり役に立たないかと。 http://www.asahi-net.or.jp/~ef2o-inue/secur/sub0 … 少し古い解説ですが、 Access2010でもVBAプロジェクトのデジタル証明書で表示される注意書きは 上記解説とほぼ同じですね。 MS社さんの https://support.office.microsoft.com/ja-jp/artic … や https://support.office.microsoft.com/ja-jp/artic … もご一読を。
>>詳しい方、この様な場合はどの様に対処したら良いか教えて下さい。 私はwordpressは詳しくありません。でもＣｅｎｔＯＳは使っていますし、いろんなソフトを導入しています。 そのとき、質問者さんと同様に、うまくいかないことが多いですね。 書籍を見ても、古いバージョンが対象だったり、ネットで参考事例を探すと、それこそ、とても古いバージョンから最新まで、いろいろと混在しています。 また、導入するＯＳが違っていたり、アプリの組み合わせが違っていたりで、すんなりといかないことが多いです。 ブログを探して、質問者さんのように、「うまくいかなかったけど苦労して解決したレポートです」というのが見つかっても、それが古いバージョン対象の話だったりで、がっかりすることがありました。 まずは、エラーメッセージを元に、ネットで同じトラブル事例が無いか探し、それでも解決できなければ、回り道のようですが、付属のソフトのマニュアル（英文？）あるいは、対象のアプリのソースコードを読むのが一番ではないでしょうか？ （私がメールサーバ関係のアプリがうまく動作せず、悩んだとき、ＰＨＰのソースを追いかけて、解決しました。でも、設定ファイルの英文コメントをしっかりと読めば、どうすればいいのか、しっかりと書かれていたのを後で見つけて、くやしい思いをしたものです。）
＞select japanese from table2 where id = (select id from table1 where english = 'foo'); englishがユニークでない場合 select id from table1 where english = 'foo' で得たidは1つとは限りません。 上記で2つ以上のidが返ってきたときid=・・・は文法的にエラーになります。 どうしてもサブクエリでやりたいならinをつかうことになるでしょう (SQLiteに該当する文法があるなら) select japanese from table2 where id in (select id from table1 where english = 'foo'); #1さんのSQL文で問題ありませんが、 ロジック的には絞ったtable1からtable2の値を得たいので select japanese from table1 inner join table2 on table1.id = table2.id and english = 'foo'; の方が、より直観的かもしれませんね。 ちなみにMySQLでテストする限り適切なインデックスさえ貼ってあれば、 効率は変わらないみたいです。
>Sheets("会社管理").Select この辺で止めて debug.print Rst.locktype してみてください。 以下Access2010のヘルプより LockTypeEnum 編集時にレコードに適用されるロックの種類を表します。 定数 値 説明 adLockBatchOptimistic 4 共有的バッチ更新を示します。バッチ更新モードの場合に必要です。 adLockOptimistic 3 レコード単位の共有的ロックを示します。Update メソッドを呼び出した場合にのみ、プロバイダーは共有的ロックを使ってレコードをロックします。 adLockPessimistic 2 レコード単位の排他的ロックを示します。プロバイダーは、レコードを確実に編集するための措置を行います。通常は、編集直後にデータ ソースでレコードをロックします。 adLockReadOnly 1 読み取り専用のレコードを示します。データの変更はできません。 adLockUnspecified -1 ロックの種類を指定しません。複製の場合、複製元と同じロックの種類が適用されます。 で、 LockType プロパティ (ADO) 編集時にレコードに適用されるロックの種類を示します。 設定値と戻り値 LockTypeEnum の値を設定または取得します。既定値は adLockReadOnly です。☆★☆注目！ 解説 プロバイダーが Recordset を開くときに使用するロックの種類は、LockType プロパティを使用して事前に設定します。開いている Recordset オブジェクトで使用されているロックの種類は、このプロパティを取得することで確認できます。 プロバイダーによってはすべての種類のロックをサポートしていないものもあります。要求した LockType 設定をプロバイダーがサポートしていない場合は、他の種類のロックに置き換えられます。Recordset オブジェクトで実際に使用可能なロック機能を調べるには、adUpdate と adUpdateBatch で Supports メソッドを使用します。 CursorLocation が adUseClient に設定されている場合、adLockPessimistic 設定はサポートされません。サポートされていない値を設定してもエラーにはなりませんが、サポートされる LockType のうち、最も近いロックが使用されます。 LockType プロパティは、Recordset が閉じているときは読み取り/書き込み可能で、開いているときは読み取り専用になります。 リモート データ サービスでの使用 クライアント側の Recordset オブジェクトで使う場合、LockType プロパティは adLockBatchOptimistic にのみ設定できます
Oracleについては不明です。 あなたが作成したファイルでなければ いじくらずに作成者に相談する事を強くお勧めします。
エクセルの最新版は、古いバージョンで作成したエクセルファイルを 問題なく開くことができますので、今回開けなかったのは、 USBフラッシュメモリに保存したエクセルファイルが部分的に壊れてしまったためと思われます。 私も経験があるのですが、ファイルをダブルクリックすると、 エクセルが立ち上がるものの、グレーの画面のまま止まってしまう、 という状況ではありませんでしたか？ この場合、エクセルを開いて、ファイル→開く　とし、破損したエクセルファイルを選択、 右下の「開く(O)」の右にくっついている下向き黒三角「▼」をクリックし、 「開いて修復する」をクリックすると、罫線や色塗りなどの情報は失われるものの、 セルに入力した情報は拾い上げることができます。 最も確実なのは、USBフラッシュメモリの破損したデータを消去して、 あなたのPCから再度保存し直すことです。 元ファイルが破損していない限り、二度も続けて同じファイルが破損するとは考えられないので、 先方の2013で問題なく開けるようになるはずです。
手っ取り早いのは一度ビューを作ることです。 //準備 create table hoge(id int not null auto_increment primary key,kbn int); insert into hoge(kbn) values(1),(2),(3),(4),(5),(1),(1),(2),(4),(5),(3),(1),(2),(5),(5),(3),(2),(1); //ビューの作成 create view vhoge as select kbn,count(*) as cnt from hoge group by kbn; //集計 select kbn,cnt,(select count(*)+1 from vhoge as v2 where v1.cnt<v2.cnt) as rank from vhoge as v1 order by rank asc; ※もしビューを使いたくないのであればビューに書いたのと同様のSQLをそのまま書きます select kbn,cnt,(select count(*)+1 from (select kbn,count(*) as cnt from hoge group by kbn) as v2 where v1.cnt<v2.cnt) as rank from (select kbn,count(*) as cnt from hoge group by kbn) as v1 order by rank asc
Sum関数の引数にはコントロール名ではなく、そのフォームのレコードソースのフィールドを参照する必要があります。 まず、サブフォームのフォームヘッダーかフッターにテキストボックスを配置して、 コントロールソース　=Sum([金額]) 名前　合計金額 とします。次に、メインフォームのテキストボックスのコントロールソースから上記のコントロールを参照します。 =[SubForm01].[Form]![合計金額] SubForm01 はサブフォーム本体の名前ではなく、サブフォームを埋め込んでいるコントロールの名前にしてください。
＃１だけど、Where条件の話ね。 列見出しはDayで囲うが、1～31で並んだら、 ドラッグ＆ドロップで入れ替えて
自動生成したIDで別のテーブルと連携するといろいろデータに不整合が 起こりそうな気がしますが・・・ 無理やりやろうと思えば以下参考にしてみてください //テーブル作成 create table players(id int not null auto_increment primary key,name varchar(100),price int,position_id int); create table team(id int not null primary key,team_name varchar(100)); ※仕様 playersテーブルに挿入した際発行されるidをteamのプライマリキーとして データを挿入する。 ただしplayersテーブルのデータを削除したり、抜け番をうめたり特殊なことは 一切無視 //トリガー作成 DROP TRIGGER IF EXISTS players_to_team; DELIMITER // CREATE TRIGGER players_to_team AFTER INSERT ON players FOR EACH ROW BEGIN INSERT IGNORE INTO team SET id= NEW.id,team_name=@team_name; END; // DELIMITER ; //playersにデータを挿入する（ただしteamの名前は別途変数で指定） insert into players (id,name,price,position_id) values((select @team_name:='t1'),'p1',100,1); insert into players (id,name,price,position_id) values((select @team_name:='t2'),'p2',200,0); insert into players (id,name,price,position_id) values((select @team_name:='t3'),'p3',400,1); insert into players (id,name,price,position_id) values((select @team_name:='t4'),'p4',800,0); //確認 select * from players inner join team using(id);
Q、工事依頼元へ出す見積もり書作成の場合、既に入力している部材注文一覧と仮工事発注一覧のレコードの項目名、単価、数量を受注IDで紐付けたもの全部使用したいのです。その場合、クエリーでそうなるようなものを作成し、それをコンボボックスなどで選択するのも一つの手でしょうか・・・ A、No! 　私の作法では、まず、Accessのクエリーなるものは一切利用しません。 PS、まず、入力フォーム、検索フォームのデッサンを！ 　一体、ユーザーが直感的に手早く作業するには？ということを念頭に。その実現方法は、後から考えたらいいです。
０からはじまる連番を得たいだけならこんな感じ SELECT *,(select @a:=@a+1 from (select @a:=-1) as dummy) as zero from tbl select @a:=-1のところは初期値マイナス１の値を与えておきます
Q、帳票フォームの行の順番を簡単に変えたいのですが、何か方法はありますでしょうか？ A、ソート。 http://hatenachips.blog34.fc2.com/blog-entry-58. …
フィールドのインデックスの設定でも結構変わってきます。 ファイル名、idx.accdb テーブル名、T1 フィールド名、F1、テキスト型でフィールドサイズ255 （インデックスに、はい（重複あり）を設定 フィールド名、F2、長整数型。 標準モジュールにて Sub b() Dim db As Database Dim rs As DAO.Recordset Dim i As Long Set db = CurrentDb db.Execute ("delete * from T1") Set rs = db.OpenRecordset("T1", dbOpenDynaset) For i = 1 To 370000 rs.AddNew rs!f2 = i If i Mod 1000 = 0 Then rs!f1 = "abc" Else rs!f1 = rndStr End If rs.Update Next End Sub Private Function rndStr() As String Dim i As Integer For i = 1 To 255 rndStr = rndStr & Chr(Int(Rnd * 26) + 65) Next End Function で、b を実行しダミーデータを入れときます。（最適化も実行しといてね） このファイルを別名保存して、NOidx.accdb フィールド名、F1、テキスト型でフィールドサイズ255 （インデックスに、なし）に設定を変更します。 （テーブル名は、NoT1 とか適当に）。（最適化も実行） 二つのファイルをファイルサーバーに移動します。 もう一個検証用のファイルを作成し上記ファイルから 上記テーブルのリンクテーブルを二個作成します。 クエリを上記テーブルから二個作成 抽出条件に、Like "abc*" としてみます。 クエリの左下にあるレコード数が表示されるまで インデックス有りの場合は１～２秒 無しの場合は８秒弱でした。 （当方のはしょぼいファイルサーバーなので時間が掛かります。。。） ※初回のクエリに限ります。 一旦ファイルを閉じないとキャッシュから読みだされるようなので 連続して行う場合は時間は同じになります。 以上、 リンクテーブルでもインデックスは有効かのテストでした。 ＃１さんの回答の通りファイルサイズはどうしようもないと思います。 インデックスを作成していたなら、お邪魔虫回答ですね。(^_^;) ご参考まで。
【お知らせ】 　　　　　　If M > 99 Then 　　　　　　　　MsgBox "読込む行総数を100行に下方修正しました。(DBSelect)", _ 　　　　　　　　　　　 vbInformation, _ 　　　　　　　　　　　 " お知らせ" 　　　　　　　　M = 99 　　　　　　End If DBSelect()に99行制限をかけていました。この６行はバッサリと消して下さい。500行や1000行では変数オーバーはしないので大丈夫です。
回答No.2です。 > 例えば、ある受注の明細を全て仮テーブルに～(以下略) 具体的な実装は、システムの要件に従って工夫して頂ければ 良いかと思われます。 ただ『データをコピーして他のテーブルに格納』する処理は、 乱用すると後からデータ更新が必要になったときにコピー先も 更新が必要になって、処理が煩雑になりますのでご注意を。 安易なデータコピーもシステム崩壊原因の "あるある" です。 > 入金された物の消し込みをスル場合～(以下略) この質問が出るということは、失礼ながら質問者さんはまだ 今回作成するシステムの要件の理解が不足しています。もう いちど業務フローを見直して『なぜ、入金消込処理が必要な のか、これは何のために実施するのか』を問い直してくださ い。 これは質問者さんが今作っているシステムの『理解』のため に、質問者さんご自身の手で解決すべき内容かと思います。
演算誤差のない「通貨型」でしょうね。
＞複数テーブルだと実行できないように理解しましたが、 そうですね ＞何が問題か教えてください。 そもそもupdate でlimitをすること自体がイレギュラーな処理です where句で厳密に条件を提示するべきですね とはいえ、以下のようにリレーションする部分をあらかじめ処理したうえで その結果をうけて処理するればできないことはなさそうです。 //元データ create table tbl1(id int not null primary key,data int,flag tinyint not null); insert into tbl1(id,data) values(1,11),(2,12),(3,13),(5,15),(6,16); create table tbl2(id int not null primary key,data int,flag tinyint not null); insert into tbl2(id,data) values(1,21),(2,22),(4,24),(5,25); //とりあえず確認 select * from tbl1; →flagはすべて0 //limitしないupdate update tbl1,tbl2 set tbl1.flag=1 where tbl1.id=tbl2.id; //確認 select * from tbl1; →3件flagが1になる //１回クリア update tbl1 set tbl1.flag=0; select * from tbl1; →flagはすべて0 //tbl1のid順で上位1件をupdate update tbl1 set flag=1 where id in (select * from (select tbl1.id from tbl1 inner join tbl2 on tbl1.id=tbl2.id order by tbl1.id asc limit 1) as sub); //確認 select * from tbl1; →1件だけflagが1になる ※サブクエリはlimitを利用できないので一度ダミーで処理をいれる
すでに、f_a_007様の回答が出ているので、自分は別の視点から回答させて頂きます。 売上データにだけ存在する顧客があると想定し以下回答 初心者にはＳＱＬ文はきついかな・・・ でも、今後Accessを使っていくならば覚えていったほうが良いです 以下のテーブルを用意 住所リスト(顧客番号、名前、住所　)をTBL_ADRとし、顧客番号 1001,1002,1003を作成しておく 売上データ(顧客番号、名前、売上高)をTBL_URIとし、顧客番号 1002,1003,1004を作成しておく 抜粋＞主力キーにして合体をさせたのですが、 抜粋＞売上データに記載の顧客のみが抽出され住所リストの一部顧客が消えてしま～ 上記、現象から売上データを主体に作成しようとしているためと推測されます ■現象からの推測ＳＱＬ SELECT TBL_ADR.顧客番号, TBL_ADR.名前, TBL_ADR.住所, TBL_URI.売上高 FROM TBL_URI INNER JOIN TBL_ADR ON TBL_URI.顧客番号 = TBL_ADR.顧客番号; または SELECT TBL_ADR.顧客番号, TBL_ADR.名前, TBL_ADR.住所, TBL_URI.売上高 FROM TBL_URI LEFT JOIN TBL_ADR ON TBL_URI.顧客番号 = TBL_ADR.顧客番号; となっていると思われます。 ■住所リストを主体にしたい場合のサンプルＳＱＬ SELECT TBL_ADR.顧客番号, TBL_ADR.名前, TBL_ADR.住所, TBL_URI.売上高 FROM TBL_ADR LEFT JOIN TBL_URI ON TBL_ADR.顧客番号 = TBL_URI.顧客番号; 上記コードだと、住所リストにはなく、売上データにだけある顧客(顧客番号＝1004)は抽出されません ■住所リスト、売上データの顧客すべてを表示させたい場合のサンプルＳＱＬ (1).まず売上データだけにある顧客(1004)を列挙 (不一致クエリと呼ばれる物です) SELECT TBL_URI.顧客番号,TBL_URI.名前,TBL_ADR.住所, TBL_URI.売上高 FROM TBL_URI LEFT JOIN TBL_ADR ON TBL_URI.[顧客番号] = TBL_ADR.[顧客番号] WHERE (((TBL_ADR.顧客番号) Is Null)); (2).住所リストの顧客(1001,1002,1003)を主体にしたＳＱＬ SELECT TBL_ADR.顧客番号, TBL_ADR.名前, TBL_ADR.住所, TBL_URI.売上高 FROM TBL_ADR LEFT JOIN TBL_URI ON TBL_ADR.顧客番号 = TBL_URI.顧客番号 (3).UNIONでひとつの出力結果を出す(1,2を合体させる) SELECT TBL_ADR.顧客番号, TBL_ADR.名前, TBL_ADR.住所, TBL_URI.売上高 FROM TBL_ADR LEFT JOIN TBL_URI ON TBL_ADR.顧客番号 = TBL_URI.顧客番号 UNION SELECT TBL_URI.顧客番号,TBL_URI.名前,TBL_ADR.住所, TBL_URI.売上高 FROM TBL_URI LEFT JOIN TBL_ADR ON TBL_URI.[顧客番号] = TBL_ADR.[顧客番号] WHERE (((TBL_ADR.顧客番号) Is Null)); ※UNIONを用いる場合、クエリデザイナーでは作成が出来ません 表示をSQLビューに切り替えて自分でＳＱＬ文を入力することになります。 (4).3で纏めたＳＱＬを顧客売上台帳という名で保存 ＜顧客売上台帳 出力結果＞ 顧客番号 , 名前 , 住所 , 売上高 1001 , ○○○○ , ○○○○ , 1002 , ○○○○ , ○○○○ , \200 1003 , ○○○○ , ○○○○ , \300 1004 , ○○○○ , ○○○○ , \400 以上です
細かいことですが「RecordsetClone」は「変数」ではなくて「プロパティ」です。 さて、本題ですが、 > 一つお聞きしたいのですが、RecordsetClone変数だと、フィールド更新後に使うと、値が古いものが取得されてしまい、うまく計算が出来ない時があります。 フィールドは更新したが、まだレコード保存していない状態だとそうなるかもしれません。 フィールドを更新して、それを参照して使用する場合は、事前にレコード保存してテーブルに格納しておくべきですね。 テーブルに格納せずに、エラーや操作ミスで終了してしまった場合、テーブルの値と参照使用した値に矛盾が生じてしまう可能性があります。 フィールドを更新した場合は、RecordsetClone でデータを参照する前に、 DoCmd.RunCommand acCmdSaveRecord でレコード保存しておくといいでしょう。。 Me.Recordset だと、レコードセットでの操作（レコード移動など）が直接フォームに影響を与えてしまうので、 処理が重くなるので避けるべきです。 他にもフォームのレコードセットを参照する方法として、RecordSet.Clone があります。 「フォームの Recordset, RecorsetClone, RecordSet.Clone の違い」はWEB検索すると詳しい解説が見つかると思います。
チェックボックスは連結コントロールで、「チェック」というフィールドと連結していると仮定して回答します。 条件付き書式を使います。 フォームのデザインビューで入力可/不可を設定したいテキストボックスを選択します。 リボンの「書式」タブ→[条件付き書式]→[新しいルール]で、書式設定で「式」を選択して、隣のボックスに [チェック]=False という式を入力します。 ボックスの下の右端の「有効化」のアイコンをクリックして選択状態にします。 以上で、チェックボックスにチェックを入れてあるレコードのみ編集可能になります。
入力画面（フォーム）とテーブル設計は別に考えるようにしましょう。 通常は、注文履歴のテーブルに、商品ID（外部キー）以外の商品データ（商品名や品番）は保存すべきではないです。 履歴入力画面からは、商品管理テーブルは参照だけで変更できないような設計にすれば問題ないので。 また、リレーションシップで「参照整合性」にチェックを入れておけば、履歴テーブルのデータと紐づいているレコードをマスターから削除しようとすると警告が出て削除できないようになります。 ただし、例外として、例えば「単価」が頻繁に変わるように場合は、単価を注文履歴の方にも格納するということはあります。 注文履歴入力画面（フォーム）での商品名や品番の参照は、コンボボックスを利用すると簡単にでき、また、入力しやすいものになります。 ■T'sWare Access Tips #360 ～コンボの２列目をテキストボックスに表示する方法（コントロールソース版）～ http://www.tsware.jp/tips/tips_360.htm
速度的にどうなるかはわかりませんが、積集合を使って みるとかどうでしょう。 SELECT head, body FROM dic WHERE body MATCH 'foo bar' INTERSECT SELECT head, body FROM dic WHERE head MATCH 'bar'
また長文失礼いたします、必要な部分だけ見ていただけると助かります ■補足回答 ＞フィールドの更新後処理では、SQLで更新クエリーを実行すると ＞、フォームのレコードソースの値は既に更新されているのでしょうか？ テーブルのレコードとしてはまだ更新されていません レコードソースの連結項目であっても、 カレントレコードが「移動」されるか「閉じられる」か「コミット(保存)」された際に 初めてデータベース(テーブルレコード)に反映されます 従ってフィールドの更新後処理では、実際のレコードはまだ更新されていません レコードとしては、まだ編集中という位置づけになります 「acCmeSaveRecord」は保存の意味合いになるのであるいみ性解です ※編集中のレコードは、キーボードのＥＳＣを２度連続押下すると元に戻す機能を持っています ■余談：データベースが外部(SQLやOracle)の場合、以下のような現象が発生します (1)ＰＣ－Ａでテーブルレコード修正中(編集中)のとき、他のＰＣからそのレコード参照すると前の値が参照されます (2)ＰＣ－Ａでテーブルレコード修正中(編集中)のとき、他のＰＣでも同じレコードを修正しようとすると ___最後に更新しようとするＰＣに警告メッセージが出てきて反映できません（ココ裏覚えですがでたはず） ___その場合、レコードロックなどの仕組みを作る必要になります（仕組みは物凄い情報量になるので省きます） ■大昔(2008年ごろ)、自分が教わった事 テーブルを実際開いてみてください、テーブルのレコード内の(どれでも良いです)項目値を 入力すると左側に鉛筆マークがでてきます。 この鉛筆マークは編集中と意味で、まだレコードには実際に反映されていません キーボードのＥｓｃボタンを２回チャチャと押すと編集中のレコードは元に戻ります Ｅｓｃボタンを押さずにレコードを移動またはテーブルを閉じると反映されます ※ＶＢやＲＰＧ４００の言語で言うと、コミットされるというわけです これがAccessではフォームでも連結項目の場合、適用されるというわけです 解らなければ、そういうものだと理解しときや と教わった、やばいなぁ走馬灯のように思い出す自分・・・なんか涙出てくる 以上でした (さぁ定時だぁパチンコ行くぞ～ｗ)
＃１、＃２です ＃２のＧｒｏｕｐｂｙは、２番目をＭＡＸかMINで囲む前提です。 ルールがわからないので、どちらかお好きな方でどうぞ
いま手もとにアクセスがないので自分で確かめてみることができないのですが、↓これはヒントになりませんか？ http://www.ilovex.co.jp/blog/system/access/acces … http://ivystar.jp/ms-office/access/if-the-cause- …
cがsqlite3.Cursorだとして。 c.execute("SELECT * FROM stocks") に成功した後で、c.descriptionを調べることでわかります。 http://docs.python.jp/2/library/sqlite3.html#sql … r=c.fetchione() 等としたときの r は sqlite3.Row のオブジェクトになります。 http://docs.python.jp/2/library/sqlite3.html#row Rowにはkeysメソッドがあります http://docs.python.jp/2/library/sqlite3.html#sql … もし、簡単な参考書とかしか読んでいないのなら、公式マニュアルも読むことをお勧めします。 > 最初のRecord Setが(date,qty) = ("2014/12/1", 5)の場合 この例は「登録内容を得た後」だと思うのですが。 前と後、どちらなのでしょうか?
> 検索は下の方が速くなったりしますか？ 統計情報が正しく取られているなら速くはならないでしょう（同じということ）。 売上トランの件数にもよりますが(※)、どちらも商品マスタを削除フラグ = '0' で絞ってから結合という実行計画になると思われます。 ただし、上の記述の方がシンプルなのでおすすめします。複雑な記述はオプティ マイザを惑わせたり、オラクルの不具合を引く確率を高めたりするので。 ※絞り込んだ後も商品マスタの件数が５万件と大きめなので、例え売上トラン. 　商品コード列に索引があったとしても、ハッシュ結合が選択される可能性があ 　ります。 > また、削除フラグのように1か0の2値しかとらない項目については、 > INDEXを張る効果はあるでしょうか？ 例え２値しかなくても、1/20に絞り込まれるわけですから大いにあります。バイ ンド変数を使用していないならなおさらです。最近のオラクルは賢いのでテーブ ルのどの列が検索条件 (WHERE 句等) で使用されるかモニタリングし、検索に使 用される列だけヒストグラム統計を取ってくれるようになっていますが、自動的 に取ってくれない場合は手動で取る必要があります。
> １月～12月までのテーブルがあるのですが 一つのテーブルに年月別レコードがあるのなら Whereで最終年月を指定して、年月の昇順のOrderとLimitで2行に絞れば？
「SubForm」のフィールドのどれかのフィールドの ダブルクリックなどで、 　msgbox me.parent.name などとすれば、メッセージボックスでは 「FormA」が表示されますが、これは あくまでも「SubForm」でのイベントなので 当然ながらコードは「SubForm」に書き込みます。 同様にして、 ＞サブフォームのイベントで何かの処理をスル場合に、 ＞自分のフォームのフィールドの値を取得するのには の場合も、コードは「SubForm」に書き込みます。 たとえば、「SubForm」にボタンを設定して、 そのクリックイベントで、 msgbox Me.Controls("フィールド名").Value とすれば、現在「SubForm」でカレントになっている レコードの「フィールド名」の値が表示されます。
No.1です。 > Knoppix上での解決方法も教えて下さい puppy linux上の環境では、python 2.7.3でも前述のサンプルソースのコメントアウトだけで動作しました。つまりpythonではなく、インストールされているsqlite3のバージョンに依存するということになります。 通常ですと、sqlite3の最新版のソースをもってきてコンパイルし、インストールして、作成されたsqlite3.soを元のファイルと置き換えれば良いことになります。 ./configure --prefix=sqlite3のインストールされているディレクトリ make make install ただしKnoppixってCD-ROM(DVD-ROM)から起動しますよね？ いまご利用になっているsqlite3がCD-ROM(DVD-ROM)上に存在すると置き換えは難しいと思います。
> 読み込み専用で無いことが分かりました。 Alt+Enterでプロパティ開いて、読取専用のチェック外し、ＯＫ
//元データ create table tbl(id int,name varchar(20),number int,score int); insert into tbl values(1,'tanaka',358,98),(3,'tanaka',358,23),(4,'tanaka',358,45),(11,'yamada',126,63),(17,'yamada',126,77),(23,'suzuki',274,36),(45,'suzuki',274,16),(59,'suzuki',274,89),(73,'suzuki',274,75),(80,'hanako',89,24); //検索 select * from tbl where number in( select number from (select number from tbl group by number order by min(id) asc limit 2) as sub ) order by id asc; 考え方 select number from tbl group by number order by min(id) asc limit 2 で、idの小さい２人分のnumberを抜き出し そのnumberを持つ全データを抜き出す。 本来であれば select * from tbl where number in( select number from tbl group by number order by min(id) asc limit 2 ) order by id asc; でいければ楽なのですが、通常のサブクエリにlimitが使えないので一度select文でうける
Me.cmbo会社ID.RowSource = "会社ID1;依頼ID;会社ID2;会社ID3;会社名" Me.cmbo施工会社ID.RowSourceType = "テーブル/クエリ" "会社ID1;依頼ID;会社ID2;会社ID3;会社名" ↑ 少なくとも、これはテーブルでもクエリでもない。 次のサイトが参考になるかもです。 http://www.moug.net/tech/acvba/0060002.html
添付図ミス！
ネストがずれてるので "0%" が Format 関数の第2引数として評価できない位置にある。 と思うんだけど。 SELECT 　t_エクセル貼り付け.地域, 　Format 　　( 　　　( 　　　　NZ( [フロントNG] ) 　　　) 　　　/ 　　　( 　　　　NZ( [後確NG] ) 　　　　+ 　　　　NZ( [エントリー後NG] ) 　　　　+ 　　　　NZ( [アンテナ後確NG] ) 　　　　+ 　　　　( 　　　　　NZ( [フロントNG] ) 　　　　　+ 　　　　　NZ( [決裁者NG] ) 　　　　　+ 　　　　　NZ( [アンテナNG] ) 　　　　　+ 　　　　　NZ( [検討NG] ) 　　　　　+ 　　　　　NZ( [対象回線済NG] ) 　　　　　+ 　　　　　NZ( [NG] ) 　　　　) 　　　　, "0%" 　　　) AS フロントNG率 FROM t_エクセル貼り付け;
本題からズレるが、不勧奨を管理しないで良いの？
こんばんは。 Ruby や Railsは使用したことはありませんが、MySQLにはお世話になっています。 先ずは下記サイトの「MySQL on Windows (Installer & Tools)」 http://dev.mysql.com/downloads/ を試してみてください。
回答No.1 です。 既にマルチポストであちこちに問い合わせてらっしゃる ようなので私はこれでギブアップとさせて頂きます。 お役にたてずにすいませんでした。
開示されたレコード定義が列名のみなのでなんとも。 制約はどうしていますか？ Null、空文字を受け入れるなら、 レコード追加できますが、値を代入していない列はNullでしょうね。
接続先の mySQL が特に何も設定を変更していない のであれば、以下のページが参考になるかもしれません。 http://immature.01kawa.com/database/phpmyadmin/p …
>※先に開いている人には読み取りは可能 >※後から開いた人は、データの編集が可能にする >※先に開いた人が、後から開いた人がデータの編集をしている時に該当レコードの変更は出来ないようにしたい ？？？ 開いた順は特に関係ないと思います。 先に編集し始めた人に権限を与えるなら、OpenRecordsetで適切に設定することで可能です http://msdn.microsoft.com/ja-jp/library/office/f …
　Ｎｏ２．補足宛 　ＭｙＳＱＬが、いかに物理ドライブの物理ファイルを「意識しなくてもプログラミング」出来るようにという目的で作られたとはいえ、システムの管理者は物理構造を意識しないと仕事になりません。データを格納しているわけですから、データを格納する場所が必要なのは当然で、その場所は必然的に、ファイルとなります。 　ただ、そのファイル構造が複雑なので、単純なコピー・ペーストではデータベースをコピーすることは出来ませんよというだけの話です。（ちなみに、ちゃんと構造と動きを理解して、必要な手順を踏めば、ファイルのコピーでのデータベースのコピーも有りです。かなり難しいので普通はしません。データベースをコピーするにはもっと簡単で便利な方法がありますから。） 　アクセスでは、データを管理するのはひとつのファイルだけでしたが、ＭｙＳＱＬでは、データベースを管理するために、複数のファイルが絡み合って管理されます。単純なＭｙＩＳＡＭタイプのデータベースでさえ、３つのファイルで構成され、しかも、そのファイルの内容は、グローバルなカタログデータベースとの絡みが存在します。カタログデータベースの存在を考えれば、関係するファイル数はもっと増えると言うことです。 　そのあたりの構造を全部ここに書くのはさすがに無理です。 　リファレンスマニュアルの（例えば、５．１なら日本語マニュアルがあります。ここです。http://mysql.stu.edu.tw/doc/refman/5.1/ja/index. …）2章・４章・13章あたりを熟読してください。直接の答えは、13章にあります。 　ファイルの場所は、デフォルトのインストールのまま設定を変えていなければ、MySQLのインストールフォルダーの中のdata\mysqlとdata\データベース名 あたりでしょう。データベース生成時にもフォルダ指定が出来るので、その場合は、そこになります。 　
そのテーブルのデータが入ったファイルがread onlyの属性になっていると言われているので、ファイルのパーミッション等を確認しましょう。 このあたりが参考になるのではないでしょうか。 http://d.hatena.ne.jp/susan-style/20120914/13476 …
mdfファイルをNAS上に配置したいということですよね。 OSが書かれていませんが、Windows Server 2003以外であればシンボリックリンクで出来たという事例を見たことがありますので試す価値があるかもです。 デタッチ・アタッチをする方法ですが。 mklink /d NGだったら、切り分けとしてWindowsの共有フォルダでどうなるかを確認したらいかがでしょうか。 NAS NGでWindows共有 OKならば、問題はTS-X2.0TL/R5 が対応してないということになりますね。 上手くアタッチ出来たとしてもサポートされている構成とは言いがたいので、 別の回答者さんも書かれていましたが、iSCSIを使用するのがベストな選択だと思います。 TS-X2.0TL/R5がiSCSI対応ではないところがつらいですが。
Q1 で、Table2との結合を外部結合にすれば、Table2に対応する部屋IDがなくても影響は受けません。 当然、Table2の部屋データは参照できません。 ただ、参照先のない外部キーを残しておくのは通常は意味がないと思います。 残しておきたいなら、マスター側のレコードは削除せずに、もう使用しないという意味のフィールドを持たせてそこにフラグを立てるという方法にすると思います。 例えば、社員マスターで、社員が退職しても削除せずに、退職フラグを立てる、あるいは退職日を入力するというように。 おそらくアパート等の賃貸管理だと思いますが、その部屋を使用しなくなった日時と理由を格納するフィールドを用意して管理するのがいいと思います。、
> その場合には、更新されたかどうかを何らかの方法でフォームに持たせることは可能でしょうか？ 本テーブルと比較するか、ワークテーブルに更新チェック用のフィールドを持たせるかですね。 ただ、面倒だし、それほどパフォーマンスには影響しないと思いますので（逆に遅くなる可能性もあり）、上書きでいいとおもいます。
>ロックは複数のプロセスから同時にアクセスしないよう トランザクションで処理すればいいだけでは？ innoDBでテーブルロックは普通はあり得ない運用スタイルです
＞例えば、楽天なんかはメールアドレスをログインのキー（ID）にしてますよね？ ＞当然メールアドレスがuniqueになると思うのですが、 ＞その場合オートインクリメントidなどは設けているのでしょうか？ 楽天が実際にどうしているかはわかりませんが、 ログイン名は当然ユニークな属性をつけているはずです。 ただし、ユーザー管理テーブルの場合ログイン名がプライマリーキーになることはまれで (1)ログイン名を変更しようとした場合 (2)ユーザーごとにログイン情報の履歴をとる場合 には、別のidが（裏で）利用されていると考えるのが妥当です。 (1)だと、メールアドレスはさまざまな理由で変更になる場合があります ユーザーIDさえ不変であればメールアドレスを何らかの方法で修正すれば 別のアドレスでも個人情報をひきつげます。 (2)の場合、フラグとからめればログイン名やユーザーIDは単一でユニークである 必要はありません。 ユーザーID＋フラグで複合のユニーク属性をつけると、修正履歴をもつことができます ユーザーに実際に見せたり、ログインに利用したりするのはフラグの特定番号 たとえばフラグ＝0のものは現在のユーザー情報、フラグ＝１～5を履歴、などと定義すれば ユーザー管理の幅が広がります。 もちろん正規化して別テーブルで可変の履歴をとればフラグを使う必要はありません
>瞬時に選択したい列の行を選択する方法を教えてください。 貴方が選択したい行を誰も知らないので、不可能です。 CTRL+shift＋＊　で入力されている連続したセル範囲を選択可能です。 また画像にあるように、セル番号を入力すればそこにジャンプできますので CTRL+shift+home　等で、特定のセルから先頭セルまでを範囲指定可能です。
連結フォームなら、フィルターなどで対象の１レコードのみ抽出して「追加の許可」を「いいえ」にしておけば、レコード移動はしません。 あるいは、非連結フォームにしてもいいですね。 サブフォームのレコードソースがWorkテーブルと言うことは、本テーブルとは非連結ですので、親フォームも非連結フォームにすれば統一性があっていいかもしれませんね。 あるいは１レコードのみのWorkテーブルをレコードソースにするいうのもいいかも。
http://msdn.microsoft.com/ja-jp/library/b1e65aza … > 有効桁数: 7 桁 です。 9999999.999999 を入れようとしたら、途中で打ち切って概数にする必要があります。 9999999.999999 を有効数字7桁にするには、 9999999 で .999999 を四捨五入するとかする必要があります。 四捨五入すれば 10000000 です。 これは 1.0 * 10の7乗 であり、これを「指数表現」という方式で表現したのが 「1E+07」 です。 対策ですが ・C#でfloatを使うのなら、あきらめるしかありません。 ・doubleを使うと、SQLiteのREALと同じ精度になります。
すみません。!の件は間違い。 一覧表サブフォームのoptSelectの値は [=Nz([親フォーム]![ID])=Nz([ID]) ] ←右辺はレコードセットのID
考えられるのは以下あたりではないでしょうか？ ・phpMyAdminにpmaでログインしていない。 phpMyAdminにはどのユーザでログインしているのですか？ あとは、別のDBを作ってみて同じようにpmaユーザでphpMyAdminにログインしてみて、同現象が起こるか、を確認すると問題の切り分けがしやすいと思います。
TESTしてませんし、Deleteできるかわかりませんが SELECT * FROM test1 INNER JOIN (Select * From test2 where (フローID, 更新日時) = (SELECT (フローID, MAX(更新日時) ) From test2 Group by フローID ) ) as test2w ON (test1.フローID=test2w.フローID) カッコのネスト間違えてたらゴメン。 でも、重複のあるフローIDの、MAXではなかった行はどうなるのかな？
表示順変更は、そういうことです、ある階層だけ逆とか、２つの間に入れたいなーとかあっても、元テーブル側のidはどうしても登録順になってしまうから。 連番とか使ってると、置き換えるにも、重なりが生じると、狂ってしまうので、文字列コードとして、ascii順で、中間があるように名前を付けておくなどしてました。経路列挙の方式だったので、あとから、順番変えるときは、そのコード名を被らないように変更して一括置換しました。 ご呈示の閉包テーブルの場合、ご指摘のように、item テーブル側にもう一つカラムをdisplay_idなどの名前で追加して、文字列か、数値で空きのある番号で振るとかとしてunique indexを貼り、 閉包テーブル側は、FOREIGN KEYの連結先をこの表示順制御用カラムに変更すれば、ON UPDATE CASCADE条項により変更が反映されるかと思ったけど、 試してみたら、閉包テーブル側２カラムに対し、item側が同一カラムを参照しているので、片方づつ反映しようとしてエラーが出ますね。 mysqlの日本語マニュアルオンラインは消えちゃったけど、mysql5.1時代のをダウンロードは出来るので、それを読むと、外部キー制約に ON UPDATE CASCADE付けるときのやってはいけないこととして記述されています。ON UPDATE no action だと結局変更できないですし。 削除に関しては問題なく自動削除されるようです。兄弟順は気にしないことにするなら、このままでもいいかとも思うけど。
とりあえず下記の手順を試してみてください。 1. 4つぐらいのテーブル間でリレーションを設定 2. その中の1つのテーブルから、フォームの自動作成 3. 出来たフォームのレコードソースの「・・・」ボタンをクリックして、1で設定した3つのテーブルを追加し、必要な項目を追加して、その設定内容を保存 　→最初のテーブルは「テーブル名.*」として一覧に追加、その他のテーブルは、必要な項目だけを追加 ここまで実行した後で、レコードソースのクエリデザインビューを閉じて、フォームのデザインビューに戻ります。 プロパティのレコードソース以外の項目をクリックしてフォーカスを移動させます。 ここで Ctrl + S を押してフォームを保存します。 4. 以降の手順を実行します。 以上でどうでしょうか。
Winで試してみたけど2行目は簡易パスになってますね。 MacはPDFもピクチャと同様に扱えるのでサイズが出てた。
AWSはともかくデータベースの特性上エクスポートせずに別のデータベースへの移行は ほぼほぼ難しいかと もしリプリケーションできるならとりあえず試してみる価値はあるかも
No.1の方も回答されている通り、「その1回のコストを問題」にしています。 とは言え、最近はB-TreeはRebuildしない方がよいとも言われています。 第一に、Range Scanの場合、一般的に、索引で検索するときのコストよりも、索引で検索した後テーブルをScanしなければなりませんが、そのコストの方がはるかに大きいです。Unique Scanの場合は、ループで繰り返し実行しない限り、「1回のコスト」の影響はほとんどありません。例えループで繰り返し実行する場合でも、3が4なら1.33倍遅くなるくらいです。結局、索引断片化の影響が大きく出るのは、Index Fast Full Scan くらいです。 第二に、一般的に索引は無限に断片化し続けるのではなく、ある程度断片化すると平衡状態になります。Rebuild してもどうせまた断片化して変更状態になるわけだし、Rebuild にかかる CPU や I/O のコストや Redo 増大の影響の方が大きくなるかもしれません。
共通id にauto_increment値は使わない意見に賛成。 その場合でも、トランザクションにしないと、片方のテーブルにのみ挿入できてもう一方は挿入されない事態は発生する。 mysql_(iが付かない)関数群はトランザクション機能の無かった時代の遺物なので（トランザクションもトリガーも未対応）、 mysqliクラスかPDOクラス群を使って下さい。 あと、mysql サーバーのversion が5.1 以降であることと、テーブル作成時に innodb エンジンを指定している必要があります。
＞各フォルダのデータを閲覧するためルートを作ってあげて目的のフォルダをひらけるようにしたいと ＞考えております。 私は、セルにHYPERLINKリンク関数を使って、ファイルやフォルダーを開いています。 URLやエクセル以外のファイルもクリック一つで開くことが出来ます。
建物NOを文字列化して、数字以外で、かつ、部屋番号に使わない文字（例えばアンダーバー）を間に挟んで、部屋番号と連結して、文字列を生成する。 例： 建物NO：125、部屋番号：A301⇒125_A301 建物NO：128、部屋番号：202⇒128_202 建物NO：1282、部屋番号：02⇒1282_02 建物NO：211、部屋番号：103⇒211_103 建物NO：21、部屋番号：1103⇒21_1103
型番-枝番 という形式が固定されているなら、 　instrで - を探す→ - みつかったら以降を削除(substr) 型番の桁が決まっているなら 　substr(キー,型番の桁数) 等が考えられます。 また、「キー」列を「型番」「枝番」に分けたテーブルにして、使用時に必要なら 「型番」|| '-' || 「枝番」 みたいに連結する、とか。
http://oshiete.goo.ne.jp/qa/8847812.html の方に回答を書いたので、そちらを参照して下さい。
＞１を入れる部分で文章みたいなのを入れてみたのですが、できませんでした。 ＞1の部分は数字じゃなきゃできないでしょうか？ はて？以下試してみてください //元データ create table tbl (id int ,data001 varchar(10) null ,data002 varchar(10) null); insert into tbl values(1,'aaa','bbb'),(2,null,'ccc'),(3,'ddd',null),(4,null,null),(5,'',''); //更新 update tbl set data002=if(data001 is not null and data002 is null,'hoge',data002),data001=coalesce(data001,'fuga') where data001 is null or data002 is null; ちなみにnullと''は別なのは理解いただいていますよね？
こんばんは！ Sheet2のA1セルに =IF(Sheet1!A1="","",Sheet1!A1) という数式を入れておけば大丈夫だと思いますが・・・ どうしてもVBAで！というコトであれば ↓のコードをSheet1のシートモジュールにしてSheet1のA1セルにデータを入れてみてください。 Private Sub Worksheet_Change(ByVal Target As Range) If Target.Address = "$A$1" Then Worksheets("Sheet2").Range("A1") = Target End If End Sub ※　汎用性から考ると、数式で処理できるのであればそれの方が簡単だと思います。 （1）VBAの場合、範囲等こちらで設定してやる必要がある。 （2）本来は考えられるエラー等も対処しておく必要がある。 などなど・・・ ※　上記コードはA1セル限定です。m(_ _)m
添付図を忘れていました。
＞何しろ、ITの担当が私だけですので。1人で全部作っていますから。 私も、設計からプログラミング、導入時のレクチャーを一人で担当してきました。各種伝票のレイアウトに印刷発注、事務所と工場のレイアウトの設計、原価計算の仕組みから売上計算システムの改変。超片田舎なもんで地元のソフトハウスにも、この手の開発経験者はゼロ。まあ、でも、一人でもできました。質問者もできますよ。 Q、(1)(2)については、どのような設計をされていましたでしょうか？ A、生データの編集とインポートを行うプログラムで対応。 出力部門によって生データのどれとどれが必要なのかは大きく違ってきます。ですから、各担当部署は、生データ蓄積データベースから適当な時間を見計らって必要なデータを利用しやすい形に加工しつつインポート。加えて、独自に入力すべきデータの入力処理を行った後に、必要な演算と出力を行ってきたと記憶しています。なお、生データ蓄積PCと各部門PCとは、サーバーで共有すべきデータについても吐き出していたんじゃーないかと・・・。 ＞バッチのようなものを作り、それを深夜実行する。 これは、MS-DOS時代のやり方。今の時代、どんなに大量のデータであっても数十秒で加工しつつインポートすることができると思いますよ。 PS、できれば的を絞って再質問されて本当のプロからのアドバイスを！
>索引を非保存にする と書いてるのに。。。
＃１ですが、ご使用のSQLServerが2008以降なら、 「DTS」をインストールする必要があります。
> また、テーブルと画面とで分割しようと考えています。 というのが、どのようなことを想定しているのか、理解できません。 もう少し具体的に説明してもらえますか。 とりあえず、これは無視して、 > ・連結フォームの場合でネットワークで複数ユーザ（二人～三人ほど）が使用する。 > ・非連結フォームの場合で、ネットワークで複数ユーザ（二人～三人ほど）が使用する。 複数ユーザーが同時接続するなら、採番管理用のテーブルを利用したほうがいいでしょう。 採番管理テーブルには現在の主キーの最大値を格納しておきます。 新規追加するときに、採番管理テーブルを排他ロックをかけて開き、取得した値に+1して、その値を入力テーブルの主キーに設定して、採番管理テーブルの値も更新します。 もし、採番管理テーブルを開こうとしてロックがかかっていた場合は、しばらく待って、再試行をするというようにします。 非連結テーブルの場合は、上記の処理を保存コマンドボタンに設定します。 連結フォームなら、フォームの更新前処理で、NewRecord のときに実行します。
Single()を使ってマージしてしまうとデータが実体化しますんでNGかと。 普通にFirstOrDefaultつかえば？ var dc = new myDataContext(); var language = dc.Languages.FirstOrDefault(lng => lng.Id==3); if (language != null) { language .Language = "SriLankā"; db.SubmitChanges(); } 拡張メソッド記法で申し訳ありません。
accessなら以下参考にしてください http://oshiete.goo.ne.jp/qa/3239942.html
＞テキストボックスのrecordソースがその式であれば、 ＞式が判断した値が自動で表示されるのが当たり前のような気がしますが・・・ 私もそのように思いますよ。実際に、（リレーショナルの有無に関わらず）普通はそうです。なぜ、そうならないのか？そこが不思議だということです。
こんにちわ。 > 書き方を教えてください。 Statspack のSnapshot ですね。 これでどうでしょうか？ パラメータに指定する値は適当に書いてます。 begin perfstat.statspack.snap(i_snap_level=>7, i_execution_th=>10, i_disk_reads_th=>1000, i_parce_calls_th=>10, i_buffer_gets_th=>1000, i_sharable_mem_th=>10000, i_version_count_th=10); end; /
＃７です 修正量がそう多くなかったので回答してみます。 修正点 ・ハイパーリンクしない ・出来上がるシート名は「1R」「2R」・・・「xR」 ・抽出内容が無くてもシートは初期化する ・騎手名は C1 から始まり、終了は空白が２行続いたら 　（24 に限定せず、書かれていた分を処理する） Public Sub Samp2() 　　Dim cn As Object, rs As Object 　　Dim sSql As String, sS As String 　　Dim v As Variant 　　Dim iRow As Long, iRowN As Long, iR As Long 　　Dim i As Integer 　　Const adStateOpen = 1 　　Const PN2007 As String = "Microsoft.ACE.OLEDB.12.0" 　　Const PN2003 As String = "Microsoft.Jet.OLEDB.4.0" 　　Const CMDB As String = "\2014.mdb" 　　Const CSQL = "SELECT * FROM 2014 WHERE 騎手名 IN ('{%1}');" 　　On Error Resume Next 　　Set cn = CreateObject("ADODB.Connection") 　　For Each v In Array(PN2007, PN2003) 　　　　cn.Open "Provider=" & v _ 　　　　　　& ";Data Source=" & ThisWorkbook.Path & CMDB 　　　　If (cn.State = adStateOpen) Then Exit For 　　Next 　　If (IsEmpty(v)) Then 　　　　MsgBox "環境不足で処理中断", vbCritical 　　　　Set cn = Nothing 　　　　Exit Sub 　　End If 　　On Error GoTo 0 　　Application.ScreenUpdating = False 　　With Worksheets("SheetDB") 　　　　iR = 1 　　　　iRow = 1 　　　　While (.Cells(iRow, "C") <> "") 　　　　　　iRowN = iRow 　　　　　　With .Cells(iRow, "C") 　　　　　　　　If (.Offset(1) <> "") Then iRowN = .End(xlDown).Row 　　　　　　　　v = WorksheetFunction.Transpose(.Resize(iRowN - iRow + 1)) 　　　　　　End With 　　　　　　If (IsArray(v)) Then 　　　　　　　　sSql = Replace(CSQL, "{%1}", Join(v, "','")) 　　　　　　Else 　　　　　　　　sSql = Replace(CSQL, "{%1}", v) 　　　　　　End If 　　　　　　sS = iR & "R" 　　　　　　For Each v In Worksheets 　　　　　　　　If (v.Name = sS) Then Exit For 　　　　　　Next 　　　　　　If (IsEmpty(v)) Then 　　　　　　　　With Worksheets.Add(After:=Worksheets(Worksheets.Count)) 　　　　　　　　　　.Name = sS 　　　　　　　　End With 　　　　　　Else 　　　　　　　　v.Activate 　　　　　　　　Cells.ClearContents 　　　　　　End If 　　　　　　Set rs = cn.Execute(sSql) 　　　　　　If (Not rs.EOF) Then 　　　　　　　　With Range("A1") 　　　　　　　　　　For i = 0 To rs.Fields.Count - 1 　　　　　　　　　　　　.Offset(, i) = rs(i).Name 　　　　　　　　　　Next 　　　　　　　　　　.Offset(1).CopyFromRecordset rs 　　　　　　　　End With 　　　　　　End If 　　　　　　rs.Close 　　　　　　Set rs = Nothing 　　　　　　iRow = iRowN + 2 　　　　　　iR = iR + 1 　　　　Wend 　　　　.Activate 　　End With 　　cn.Close 　　Set cn = Nothing 　　Application.ScreenUpdating = True End Sub
ExcelからAccessのテーブルを更新するということならば 以下のような感じですか。Accessで更新クエリを作ってみれば わかりますが。 Sub test() Dim cn As New ADODB.Connection Dim cmd As New ADODB.Command Dim strSQL As String Dim strPath As String strSQL = "UPDATE Childrenテーブル INNER JOIN Parentsテーブル " & _ "ON Childrenテーブル.ParentID = Parentsテーブル.ID SET Childrenテーブル.Flag = 1 " & _ "WHERE ([Parentsテーブル]![HasChild])=True AND ([Parentsテーブル]![AGE])=20 AND ([Childrenテーブル]![Male])=True" strPath = ThisWorkbook.Path & "\sample.mdb" cn.Open "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & strPath Set cmd.ActiveConnection = cn With cmd 　　　　.CommandText = strSQL 　　　　.CommandType = adCmdText 　　　　.Prepared = True End With cmd.Execute Set cmd = Nothing cn.Close: Set cn = Nothing End Sub なお、SQL文の中身は UPDATE Childrenテーブル INNER JOIN Parentsテーブル ON Childrenテーブル.ParentID = Parentsテーブル.ID SET Childrenテーブル.Flag = 1 WHERE ([Parentsテーブル]![HasChild])=True AND ([Parentsテーブル]![AGE])=20 AND ([Childrenテーブル]![Male])=True; ですので、コード表が乱れていたら訂正してください。
Q1、売上が確定するとは、入金された時ということでしょうか？ A1、それは、私ではなく会社に聞くべき事柄。 私は、一般論として発生主義としか言えません。 Q2、どこで、どうやって帳尻を合わせたらいいのでしょうか？ A2、それも、私ではなく会社に聞くべき事柄。 私は、帳尻を合わせる必要はさらさらないと思いますよ。 そのための、見積り金額からの自由の確保ですから・・・。
この処理が邪魔しているようですが。 　　Me.RecordSource = StrRecSource 本当に必要ですか？
普通、条件分岐はIFやCASEを使います。 SELECT IF(`総額` / `個数` < 10000,10000,`総額` / `個数`); SELECT CASE WHEN `総額` / `個数` < 10000 THEN 10000 ELSE `総額` / `個数` END; ただ単に「大きいほう」なら SELECT GREATEST(`総額` / `個数`,10000); でも構いません。
この場合はusr_trmでユーザーごとのtrmを確認しないといけないのでは？ select t1.usr_id,t3.name ,group_concat(if(t2.cat_id=1,t1.trm_id,null)) as cat1 ,group_concat(if(t2.cat_id=2,t1.trm_id,null)) as cat2 from usr_trm as t1 inner join trm as t2 on t1.trm_id=t2.trm_id inner join usr as t3 on t1.usr_id=t3.usr_id inner join usr_trm as t4 on t4.usr_id=t1.usr_id and t4.trm_id=3 group by usr_id order by rand() limit 10; ＞総務に所属する人をランダムにn件 便利な機能だとは思いますが、SQLは明確な結果を得るための手段なので 不確実なrand処理を選ぶのは、個人的にはお勧めいたしかねます
おそらくはMySQLの文字エンコードの設定が間違っているだけでしょう。 元のサーバーの文字エンコードは何ですか？ 新しいサーバーの文字コードは元のサーバーと同じですか？ この質問に即答できないようなら、ここに間違いないでしょう。 文字エンコードが変わってしまうと正しく動かないのです。新しいサーバの設定を確認し、元のサーバーの設定と同じ内容にしましょう。
＞どうも、大文字と小文字の差の様ですが case-sensitive=OFFの時、sqliteはLIKE演算に対してインデックスを使わないとのことです
問題は「コーラ」が「コカ・コーラ」と同値かどうかです それによって書き方がだいぶ違います
select t1.usr_id,t3.name ,group_concat(if(cat_id=1,t1.trm_id,null)) as cat1 ,group_concat(if(cat_id=2,t1.trm_id,null)) as cat2 from usr_trm as t1 inner join trm as t2 on t1.trm_id=t2.trm_id inner join usr as t3 on t1.usr_id=t3.usr_id group by usr_id
>とりあえず最初の容量等をしれればと思いました。 「微々たるもの」じゃ回答になっていませんか？ ＞PostgreSQLに関してはどこに載っているか探しましたがわからず・・・。 たとえば例示したリンクからダウンロードリンクをたどれば 各OSの各バージョンがリンクされていますよね？ たとえばWin版だとアーカイブファイルで50Mそこそこですから インストールしても2～300Mでしょう もしそのくらいの容量が気になるPCなら、データの保存ができないので DBでデータ管理するのはあきらめた方がよいです。
SQL Serverのbit型と、AccessのYes/No型が対応しているようになっていますが SQLコマンドで処理する場合に違いがあります。 ※ リンクして使う分には大丈夫ですが。 bit型の値は、0または1なのに対して Yes/No型の値は、falseまたはtrueです。 この違いを知っていないと、SQLコマンドで処理するときにハマります。
#1 の回答は番号フィールドにNull がある複数のレコードが存在する場合の サンプルです。 ※最後に採番テーブルの番号の値を変更するのが抜けてました。 rs.close:set rs =nothing の前に currentdb.execute("update 採番テーブル set 番号 =" & maxnum) を追加してください。 １レコードずつ手入力で行っている場合はまた別の話になります。 フォームのレコード移動時イベントに if me.newrecord then me!フォームの番号コントロール名 = Nz(DMax("番号", "採番テーブル"), 0) +1 ・・・とかになりますが 採番テーブルの方の番号を更新するタイミングは更新前処理に行えば 良いでしょう。 が、もしかしてマルチユーザー環境で・・・と考えているのなら 全部忘れてください。ハードルがぐっと上がりますので確かな回答は出来ません。 こちらが参考になるかと思いますけど。。。 [VB] DAO でユーザー定義カウンターを実装する方法 http://support2.microsoft.com/default.aspx?scid= … 私からは以上です。
　Microsoft　は、オートナンバーの主キーの型を長整数（Long型）にしています。その理由は、整数（Intege型）についで処理速度が速いからです。キーの命は、なんと言っても処理速度。とは言っても、社員テーブルなんかは整数（Intege型）で十分間に合う訳です。でも、私は、そのように細かく使い分ける時代は終わったと思っています。なんでもかんでも主キーは長整数（Long型）で押し通しても問題ないかと思います。ただ、DECIMAL型を用いる意義はほとんどないと思いますよ。
どうしてもコマンドプロンプトが大好きというなら cmdで開いたコマンドプロンプトの左上のアイコンをクリックして メニューをだし、プロパティー→レイアウトでウィンドウの幅を調整できます ちなみに、コマンドプロンプトからというと以下どちらのパターンでしょうか？ (1)mysqlクライアントでログインしてselectを発行 (2)mysqlにリダイレクトでselectを流し込み結果を標準出力に得ている (1)ならinto outfile構文を使って、(2)であればファイル出力演算子をつかって ファイルに落とし込んでしまえば、好きなエディタで確認できます コマンドプロンプトでなくてもいいならphpMyAdminなどのツールをつかうか odbc経由でアプリで確認するなどGUIな処理の方がより見やすくなると思います
セキュリティセンターで信頼できる場所を設定してそこにファイルを置いても駄目ですか? http://www.mkkobo.com/SecuritySet/SecuritySet201 …
質問に質問で返すようで申し訳ないが、あなたはなぜSQL Server 2012 Express LocalDBを常時起動させておきたいのだろうか。あるいは、なぜ常時起動させておく必要があるのか。 SQL Server 2012 Express LocalDBは、クライアントからの接続要求があると自動的に起動し、接続中は動作し続け、クライアントから切断されてアイドル状態が続く（デフォルトは5分だと思う）と自動的に停止する。 この「自動起動する」がミソで、このためにSQL Server 2012 Express LocalDBは自分が不要だと判断したら勝手に終了してメモリを解放する事ができるようになっている。 どうしても常時動かし続けたいなら、必ず１つクライアントを接続しておくくらいしか手がないのでは。 それか素直にLocalDBではなくSQL Server 2012 Express Editionを選択してサービス起動するか。
mysqlへのアクセスはどうやっていますか？ →コマンドラインからmysqlコマンドでsqlを流し込んで実行している →コマンドラインからmysqlのクライアントを利用している →phpMyAdminなどを利用している →odbc（ほか）経由でアプリから利用している →phpやperlなどプログラムから所定の手続きを経てデータをとりだしている 文字化けについては利用環境にあわせた照合順序を設定すればよいですが 一度化けた状態でデータが保存されるととりだせない可能性もあります
vacuum fullしてみたらどうだろう。
セット商品コード(X) から始めて、見つかったセット商品コード (X を含む) を 結合配列に入れていく。入れる前に結合配列をチェックし、既にセット商品コー ドが入っていたら問題あり。 ▼結合配列 http://www.shift-the-oracle.com/plsql/collection/
SELECT 顧客ID,MIN(タイムスタンプ) FROM history GROUP BY 顧客ID ;
＞UPDATEしたときに出てくる ＞UPDATE item SET data1 = "some", data2 = "thing" WHERE id = "1234"; う～んつまりこういうこと？ phpMyAdminでitemテーブルを一度「表示」して、 そのうちの一行の「編集」を選んで修正をした？ その場合は当然、行の編集ですから行をユニークに特定するidの指定があってしかりです これでwhere句を任意にしていしたのであれば 表示されたUPDATE文の欄外にある「編集」を選んで 手動でWHERE句を書き換えればいいでしょう。 もちろん、SQL文をわかっているなら最初からフリーハンドで SQLを記入して実行すればよいような気がします・・・
PostgreSQLではOracleと異なりDDLで自動コミットされないので、基本的にはBEGINとCOMMIT(またはROLLBACK)で囲むのが基本です。 今回のWARNINGは、すでにトランザクションが終了しているのにCOMMIT/ROLLBACKを発行したために発生しています。アプリケーションのコードパスでBEGINとCOMMIT/ROLLBACKが1:1対応になっていない箇所(ROLLBACKしているのにCOMMITもしている、など)があるのではないでしょうか？ また、今回のケースではテーブルが存在しないことが通常ケースとしてあり得るということのようなので、DROP TABLE IF EXISTS <table name>;というDDLを使うのが良いと思います。 ちなみに、PostgreSQLではトランザクション開始後にエラーが発生してもトランザクションは終了せずabort状態に遷移します。この状態では、COMMIT/ROLLBACK以外の全てのSQLがエラーになります。COMMIT/ROLLBACKを実行すると、どちらでもトランザクションはROLLBACKされて終了します。 https://www.postgresql.jp/document/9.3/html/tuto … 参考URL：https://www.postgresql.jp/document/9.3/html/sql- …
self joinで無理矢理、table構造を作り替えるとか？ select st.GroupID from ( select * from `key_table` where key='start_date' and Value = '2014-11-05' ) as st inner join ( select * from `key_table` where key='end_date' and (Value > curdate() or Value="") ) as en on st.GroupID = en.GroupID ; 大量行数になると、No1の方の回答のほうが速度は速いと思われる。 GroupID　と　Key カラムで連動unique index が貼ってある前提も必要。 GroupID が同じ行は必ず２行なのでしょうか？start_date の行はあるけど、end_date の行が無い場合は、選ばなくてもよいなら上記でok end_dateの行が未入力で start_date がマッチするものもほしいなら、left join して以下のように select st.GroupID from ( select * from `key_table` where key='start_date' ) as st left join ( select * from `key_table` where key='end_date' ) as en on st.GroupID = en.GroupID where st.Value = curdate() and (en.Value > curdate() or en.Value="" or en.Value is null ) ; 蛇足：日付文字列のカラムは、date 型にしておいたほうが、エラー日付を弾いたり、日数計算に日付処理関数が使えるので便利ですよ。
>CurrentDb.Updatable　って何をしようとして... よく知らないですけど、、、 アクセスの環境変数みたいなものとして持っているものを返しているんじゃないかな？ ざっくばらんに言うと、どういう形でDBを開いたかをどこかで覚えておくためのものだと思います。 （ldb内に格納されているんじゃないかな）。 多分、参照だけなので、他には何の影響もないと思いますが、まあ、納品物なら 動作検証等はやっておいたほうがよいのかもしれませんね。
ブックマークが参照できません・・の時点で エラー処理出来たら良かったんでしょうけど、 いまさら言っても始まらないですね・・・。 以下は推測にすぎませんが ファイルをパスワード保護しているか、 「レコードレベルでロックして開く」のチェックが外れている場合に ページレベルのロックになります。 http://office.microsoft.com/ja-jp/access-help/HP … （2010でも同様です） で、Accessのキャッシュか遅延書き込みの際に 何かしらの問題があってカレントレコードだけではなく ページ（４Kバイト）単位でおかしくなったのでは？ Accessの場合1日１回のバックアップでは安心できません。 モノによってですが、タスクスケジューラで 出社時・昼食時・定時退社時間時 の１日３回×三日分の世代バックアップを取っています。 （安定動作するようになってからはお世話になっていませんが大事な保険）
＞何かおかしなところがございましたらご指摘いただけたらありがたい DBの部分はまぁよいとして、htmlに組み込むところを少し調整した方がよいようです こんな風にしておくと、htmlの部分がぐちゃぐちゃにならずにプログラムとの 親和性があがります とくに例示では$_POSTの中身をそのまま出力していましたが、さすがにNGです <?PHP $value=array(); //想定するデータを初期化しておく $value['name']=""; if(isset($_REQUEST['name'])){ $value['name']=htmlspecialchars($_REQUEST['name'],ENT_QUOTES,'UTF-8'); } $checked=array(); //想定するデータを初期化しておく $checked['team_id']=array(1=>"",2=>"",3=>"",4=>"",5=>""); if(isset($_REQUEST['team_id']) and is_array($_REQUEST['team_id'])){ foreach($_REQUEST['team_id'] as $val){ $checked['team_id'][$val]=" checked"; } } print <<<eof <form> <input type="hidden" name="cmd" value="search" /> <table> <tr> <th class="th_top">選手名</th> <td class="td_top"> <input type="text" name="name" size="30" value="{$value['name']}"> </td> </tr> <tr> <th>チーム名</th> <td> <input type="checkbox" name="team_id[]" value="1"{$checked['team_id'][1]}/>名古屋 <input type="checkbox" name="team_id[]" value="2"{$checked['team_id'][2]}/>徳島 <input type="checkbox" name="team_id[]" value="3"{$checked['team_id'][3]}/>千葉 <input type="checkbox" name="team_id[]" value="4"{$checked['team_id'][4]}/>浦和 <input type="checkbox" name="team_id[]" value="5"{$checked['team_id'][5]}/>磐田<br /> </td> </tr> </table> <p> <input type="submit" value="検索"> <input type="reset" value="リセット"> </p> </form> eof;
基本的にMySQLではFULL OUTER JOINはできませんが、 今回の命題ではそもそもJOINじゃなくてテーブルの統合ですよね？ であればどちらかのテーブルにもう片方を流し込むか、あらたなテーブルをつくって 両方流し込むのが妥当では？ とりあえず統合するキーになるカラムがprimaryもしくはunique属性で処理されている 前提で解説します。 例示のものだとテーブル1（データベースじゃないですよね？）にテーブル2を 流し込みたいと読めるので INSERT IGNORE INTO テーブル1(カラム1,カラム2,・・・・) SELECT カラム1相当のカラム,カラム2相当のカラム,・・・・ FROM テーブル2; ※テーブル2に該当するカラムがないならNULLを指定する とすれば既にテーブル1にあるテーブル2のデータは無視され、テーブル1にないものだけ あらたに挿入されます。 逆にテーブル1に競合データがあってもテーブル2で上書きするなら INSERT ON DUPLICATE KEY UPDATE構文が有効かもしれません。 新規でテーブルをつくるのであれば、CREATE TABLEするさいに有効なユニーク属性を 設定したうえで、テーブル1、テーブル2の順番で流し込めばいいでしょう また無理やりFULL OUTER JOINするなら、キーになる絡むだけUNIONして サブクエリを作っておくかVIEWを用意しておき、そこにテーブル1とテーブル2を LEFT JOINすればよいのでは？
多分、無意味な補足かと思いますが・・・。 1:TRANSFORM Sum(T1.件数) AS 件数のカウント 2:TRANSFORM Nz(Sum(T1.件数),0) AS 件数のカウント 1の戻り値は"" 2の戻り値は0 ですから、空欄ではなく0を表示したい時は Nz()で。
たぶん認識はあってきていると思います ちなみにこの質問はこのまま続くのでしょうか？
　単一ビュー： 　その質問の表現、言い方が逆です。だから、意味不明になってます。 　単一ビュー「とは」、一つのテーブルから作成されたビューで、group byで集約したり、関数を使ったりしていないビューのことを言います。 　つまり、単一ビューという言葉の定義をしているだけです。定義ですから、これにとやかく言っても始まらないんですね。 　まぁ、単純に言えば、単一ビューというのは、一つのテーブルから、せいぜい単純な選択をしただけのビューと言えばいいのかな。 　この用語を定義する必要性は、次に、「このビューは、更新可能ですか？」と言い始めた時に、出てきます。単一ビューに対しては、insert , updateが可能です。（ただし、insertの際には、ビューに登場する以外のカラムが実テーブルにある時には、それらにはデフォルト値が入ります。それも無ければ、ＮＵＬＬです。そのカラムにnot null制約がついていると、制約違反ではねられます。） 　スキーマ： 　Ｏｒａｃｌｅでは、ユーザー毎に一つのスキーマが割り当てられます。 　そうですね。とあるマンションを一つのデータベースに例えてみましょうか。マンション一棟全体がデータベースです。隣のマンションは、別のデータベースとしましょう。 　マンションの部屋には、各々住人が住みますね。この部屋がスキーマです。隣の部屋にヤカンがあっても、自分の部屋に同じ形のヤカンを置いても良いですよね。このヤカンを区別する必要が出た時には、Ａさん宅のヤカンとか、Ｂさん宅のヤカンとか言えますよね。 　表名も同じです。userA.onajihyouとか、userB.onajihyouといったように識別します。 　自分の部屋にあるものを使うのに、Ａさん宅のヤカンとは言いませんよね。素直にヤカンです。 　表名も同じ。例え、他のスキーマに同じ表名があろうが何だろうが、自分のスキーマ内の表に対しては、onajihyouでちゃんと通用します。 　ただし、マンションにも共有部分があります。データベースも同じ。各自のスキーマに属さない要素がいくつかあります。何がスキーマに属して、何がスキーマに属さないのかは、参考書やマニュアルを見れば書いてありますので、興味があれば探してみてください。
【補足】売上入力と工事台帳との関係。 これは、補足するまでもないこと。あらゆるソフトが、そのようになっていることですが・・・。 ＜工事台帳入力⇒売上伝票入力が主な流れとは限らない＞ 既製品を繰り返し販売しない場合、売上入力時に工事台帳に追加するフォームをオープンすることがほとんどでしょう。そうして、そのフォームを閉じる時に、売上入力フォームに各種データをコピー。もちろん、リンクさせてはダメですよ。 なお、当然に、新規顧客の場合も、売上伝票から顧客登録フォームを開きます。 PS、顧客台帳には、有効・無効フラッグを指示できる列があるといいでしょう。それで、各種集計を高速化できるでしょう。
単純にテーブル[会社]のみでフォームを作成し、社員表示用テキストボックスを追加。そして、そのプロパティを表示し コントロールソース=DBLookup("SELECT 社員名 FROM 社員 WHERE 会社ID=" & [会社ID] & " ORDER BY ソート番号") これは、以下の標準モジュールに登録したユーザ関数 DBLookup()を使っています。これで、クエリを用意しなくても目的を達成できます。 さて、かかるユーザ関数を標準ライブラリに登録したくない場合、 １、"社員ソートクエリ"を作成します。 SELECT 社員.会社ID, 社員.社員名 FROM 社員 ORDER BY 社員.ソート番号; ２、コントロールソースに次のように書きます。 =DLookUp("社員名","社員ソートクエリ","会社ID=" & [会社ID]) http://office.microsoft.com/ja-jp/access-help/HA … DLookup()については、マイクロソフトの解説を参照されてください。 【DLookup()の限界を破るにはVBAで同じ関数を作るしかない】 マイクロソフトの解説を読めば判りますが、ORDER BY 節を指定する引数が用意されていません。ですから、どうしても、"社員ソートクエリ"を作成するという手間が必要となります。そこで、SQL文を引数とするDBLookup()をVBAで書けば、その手間を省けるという算段になります。この辺りは、好みと趣味の問題。どっちでも良いと思います。そういうお断りをした上で DBLookup()を紹介しておきます。なお、ADOは、つぎのように参照設定しないと利用できません。 http://www.happy2-island.com/access/gogo03/capte … Public Function DBLookup(ByVal strQuerySQL As String, _ 　　　　　　　　　　　　　Optional ByVal ReturnValue = Null) As Variant On Error GoTo Err_DBLookup 　　Dim DataValue 　　Dim rst　　　　 As ADODB.Recordset 　　Set rst = New ADODB.Recordset 　　With rst 　　　　.Open strQuerySQL, _ 　　　　　　　CurrentProject.Connection, _ 　　　　　　　adOpenStatic, _ 　　　　　　　adLockReadOnly 　　　　If Not .BOF Then 　　　　　　.MoveFirst 　　　　　　DataValue = .Fields(0) 　　　　End If 　　End With Exit_DBLookup: On Error Resume Next 　　rst.Close 　　Set rst = Nothing 　　DBLookup = IIf(Len(DataValue & ""), DataValue, ReturnValue) 　　Exit Function Err_DBLookup: 　　MsgBox "SELECT 文の実行時にエラーが発生しました。(DBLookup)" & Chr$(13) & Chr$(13) & _ 　　　　　 "・Err.Description=" & Err.Description & Chr$(13) & _ 　　　　　 "・SQL Text=" & strQuerySQL, _ 　　　　　 vbExclamation, " 関数エラーメッセージ" 　　Resume Exit_DBLookup End Function
mysqlを停止 mysqld_safe --user=mysql --skip-grant-tables & mysqladmin -u root password '新しいパスワード' mysqladmin -h localhost flush-privileges mysqlを開始
「これは練習問題の内容がということなのでしょうか。それともテストという時間を計った問題が最後にありますがそのテストの的中率ということなのでしょうか。」 　多数の練習問題から、本試験の分数と問題数に絞り込んだものが、「テスト」です。 「このクラムメディアのテスト問題というのは、練習問題のページからランダムに出題されているものなのでしょうか。」 　その通りです。そしてその練習問題が、非常に的中率が高いのです。
ファイルメーカーのレイアウトですよね、用紙が100mmの148mm、 これが最大の用紙なら、上下、10ミリは、マージンを取らないと、上10ミリ、ヘッダー領域、 した10ミリ、フッダーになります。 その領域の中に、レコードやフィールドを設定するので、 もちろん、サイドも5ミリはマージンを取ってください。
そういうのって、まずマニュアル読めばすぐ解りそうなものですけど？ http://www.shift-the-oracle.com/sql/functions/de … 「第３パラメータのデータ型を戻り値の型とするので、それ以降に記述する戻り値用のデータもその型に合わせなければならない。」(少々表現変更)
VBAになりますが、フォームのコマンドボタンのクリック時イベントなどに On Error Resume Next DoCmd.OpenReport "レポートの名前", acViewPreview DoCmd.RunCommand acCmdPrint DoCmd.Close とすれば近いことは出来るかもです。 （実際に印刷まで行って検証した訳ではありません） 印刷プレビュー画面の上に設定画面が出ます。 但し、印刷設定画面を閉じない限り、プレビューに切り替えてみることは出来ませんでした。 On Error Resume Next は印刷設定画面でキャンセルした場合に 実行時エラー 2501 RunCommand アクションの実行は取り消されました。 のエラー表示を回避するために入れています。 印刷設定で何を変更したいのかにもよりますが Docmd.PrintOut メソッドについても調べると 吉 かもしれません。
こんにちわ。 > 安全かつ、本サーバーに負担の少ない方法はどうしたらよろしいでしょうか？ exp 又はexpdp コマンドを使って外部ファイルに必要なテーブル定義/データを 出力するのが良いです。
非常にこころもとない回答ですが、ちょっと調べてみました。 Dim XL As Object Dim BK As Object Dim SH As Object Set BK = GetObject("d:\DATA\123.xlsm", "Excel.sheet") Stop として止めておいてイミディエイトウィンドウで bk.worksheets(3).select はオートメーションエラーで失敗しました。 でも、 ?bk.worksheets(3).name や ?bk.worksheets("Sheet1").cells(1,1).value bk.worksheets(2).cells(1,1) = "ABC" と代入 は成功しました。 なので、この場合の BK はシートの集合体なのだろうと思います。 クラスには、Excel.Chart というのもあるので 図？に関しては別の扱いのような・・・？？？なので BK はブックの一部の様です。 bk.worksheets(3).select を成功させるためには Set XL = BK.Parent.Application XL.Windows(BK.Name).Visible = True bk.worksheets(3).select と２行追加で OK っぽい？です。？ 確認するためには、Xl.Visible = true としてみました。 Excelの大元の『親』が必要のようです。 しかし、 bk.worksheets(3).activate は無くてもなぜ成功するのか？ ヘルプ見ても謎は深まるばかり。。。
他の方も書いてるようにSQLを書かないとわかりませんよ。 >パススルークエリで、INSERT／UPDATE／DELETEするという意味です。 疑問だらけですが、これをVBAでするにはその都度CreateQueryDefでクエリをAppendする必要があると思います。なぜそんな面倒なことをするのでしょうか？ 直に発行しない理由がわかりません。 さらにそれなリンクテーブルはいらないと思います。フォームなどを作るのに面倒だからという使い方はありますが、こういうことをするとリンクテーブルで開いたテーブルのロックと更新のクエリのロックがバッティングしますから当然壊れます。
データベースのデータ型はあくまでデフォルトの提案値でしかないので テーブルのデータ型がInnoDBと表示されていれば問題ありません。 ちなみにMySQL5.5からテーブル作成時のデフォルトデータ型がInnoDBになったようですね ご利用の環境がMyISAMと表示されているということはそれより前のバージョンなのでしょう。
＞＞質問3.select だから意味があります。 ただの読み込みではなく、「更新のための読み込み」であるということを明示しています。 updateやinsertは更新と決まっています。 ＞BIGIN; UPDATE tb_a SET price = 残高-10000 WHERE id = xxx; INSERT tb_a (price) VALUE (10000) WHERE id = yyy; COMMIT; ですよね？ 合ってます。 ２行だけロックされて他からは読み込めません。 ＞これはつまり、SELECT～FOR UPDATEとは選択のためのクエリーではなく「行ロックします」というクエリーなのですか？ そして上のBIGIN～UPDATE～INSERT～COMMITは以下のように書かないといけないのでしょうか？ BIGIN; SELECT * FROM tb_a WHERE id = xxx FOR UPDATE; SELECT * FROM tb_a WHERE id = yyy FOR UPDATE; UPDATE tb_a SET price = 残高-10000 WHERE id = xxx; INSERT tb_a (price) VALUE (10000) WHERE id = yyy; COMMIT; 読みたいときにselect,更新したいときにupdate、追加したいときにinsertでいいです。 つまり、上２行のselect は不要なのですが、 UPDATE tb_a SET price = 残高-10000 WHERE id = xxx; ここ、残高は先に読んで10000円あるかどうか確認しないといけませんよね。 こういう場合は SELECT 残高 FROM tb_a WHERE id = xxx FOR UPDATE; UPDATE tb_a SET price = 残高-10000 WHERE id = xxx; となります。 他の情報で10000円があることが確認されていればselectは不要になります。
=IIF(IsNull(Filed1),0,1)+IIF(IsNull(Filed2),0,1)+IIF(IsNull(Filed3),0,1)+・・・+IIF(IsNull(Filed14),0,1) みたいな式でどうでしょう？
【疑問】今のアプローチは正しいのか？ ＞毎月の在庫回転期間を求めたいのです。 商品名｜月次出庫数｜月次期首在庫｜月次期末在庫｜月次在庫回転率｜月次在庫回転期間 ＡＡ１｜＿＿１００｜＿＿＿１００｜＿＿＿＿＿０｜＿＿２．０００｜＿＿＿０．５ヶ月 ＡＡ２｜＿＿＿５０｜＿＿＿１００｜＿＿＿＿５０｜＿＿０．６６６｜＿＿＿１．５ヶ月 ＡＡ３｜＿＿＿＿０｜＿＿＿１００｜＿＿＿１００｜＿＿０．０００｜＿＿＿＿＿＿＿＿ 商品ＡＡ１は、月次平均在庫数は５０。 これを一ヶ月で２倍の１００個出庫。 ですから、在庫回転期間は０．５ヶ月。 商品ＡＡ２は、月次平均在庫数は７５。 これを一ヶ月で５０個出庫。 ですから、在庫を出庫しきるにはもう半月を必要とします。 よって、在庫回転期間は１．５ヶ月。 敢えて、単月で「在庫回転期間]を出すとすれば上図のようです。 この結果を、更に、次のようにレポートしたい。 商品名｜７月度在庫回転期間｜８月度在庫回転期間｜９月度在庫回転期間｜平均在庫回転期間｜ ＡＡ１｜＿＿＿＿１／２ヶ月｜＿＿＿＿１／２ヶ月｜＿＿＿＿１／２ヶ月｜＿＿＿１／２ヶ月｜ ならば、 課題は、単月での「在庫回転期間]を求めるだけで事足りるのではと思いますよ。「商品別在庫回転期間推移表」は、単に、レポート出力の手の問題。 【在庫回転期間の定義は横に置いて】 要は、「商品別在庫回転期間推移表」をレポートすれば事足りる訳ですので・・・ <<テーブル「在庫回転台帳」>> ID=1 会社コード=XXXX 商品コード=XXXX <<テーブル「在庫回転明細」>> ID=1 在庫回転台帳_ID=1 月次=201405 月次月次出庫数=100 月次期首在庫=100 月次期末在庫=0 月次在庫回転率=2.00 ※列[月次在庫回転期間]は、月次在庫回転率の逆数なので必要ありません。 ※もちろん、質問者のいう「在庫回転率」でも同じ設計ですよ。 ID=1 在庫回転台帳_ID=1 月次=201405 前々月出庫数=XXX 前月出庫数=XXX 当月出庫数=XXX 月次在庫回転期間=XXX ↑ あくまでも雛形。私には、月次在庫回転期間の求め方がよく理解できていませんので当てずっぽうで書いています。 という二つのテーブルを生成すれば簡単に目的は達成できるかと思いますよ。「商品別在庫回転期間推移表」の出力は小一時間で終了します。ですから、レポート出力のことは一切考える必要はありません。
select 番号,max(値段) from テーブル where 番号=(select min(番号) from テーブル)
No1です。抜け落ちが、 For I = 0 to MyRs.Fields.Count - 1 obj.sheets(シート名).Cells(1,i+1) = MyRs.Fields(i).Name Next i ですね。セルの指定も反対になっていました。
Access VBAよりExcelのシート名を取得 http://oshiete.goo.ne.jp/qa/8772873.html ここでの OpenSchema を使用したものは不評だったでしょうか というのは置いといて 関数を用意しました いろんなパターンでテストはしていないので・・・ （完成形ではないので不具合等は修正してください） GetExcelSheet に、Excelファイルのフルパスを与えると シート名の配列が Variant で得られます。 内部でエラーがあったら、最後のエラー番号を返します。 内部の動きとして、GetObject で対象の Excel ファイルを開きます。 GetObject で初めて開かれた場合、そのファイルの Visible は False False なら後始末としてそのファイルを閉じ、 結果 Excel で開いているファイルが無ければ、Excel を終了します。 つまり、既に開いていたものについては閉じる事はしません。 この関数の使い方は、後半の Samp1 を例としてください。 Public Function GetExcelSheet(sPath As String) As Variant 　　Dim oApp As Object, oBook As Object 　　Dim vA() As Variant, v As Variant 　　Dim i As Long 　　On Error Resume Next 　　i = 0 　　Set oBook = GetObject(sPath) 　　If (Not oBook Is Nothing) Then 　　　　For Each v In oBook.Worksheets 　　　　　　ReDim Preserve vA(i) 　　　　　　vA(i) = v.Name 　　　　　　i = i + 1 　　　　Next 　　　　Set oApp = oBook.Application 　　　　For Each v In oApp.Windows 　　　　　　If (v.Caption = oBook.Name) Then 　　　　　　　　If (Not v.Visible) Then 　　　　　　　　　　oBook.Close SaveChanges:=False 　　　　　　　　End If 　　　　　　　　Exit For 　　　　　　End If 　　　　Next 　　　　Set oBook = Nothing 　　　　If (oApp.Workbooks.Count = 0) Then oApp.Quit 　　　　Set oApp = Nothing 　　End If 　　GetExcelSheet = vA 　　If (Err <> 0) Then GetExcelSheet = Err.Number End Function Public Sub Samp1() 　　Dim v As Variant 　　Dim sS As String 　　Dim i As Long '　　v = GetExcelSheet(CurrentProject.Path & "\test.xlsm") 　　v = GetExcelSheet("C:\test\テスト.xlsx") 　　If (IsArray(v)) Then 　　　　sS = "> シート数 = " & UBound(v) + 1 & vbCrLf 　　　　For i = 0 To UBound(v) 　　　　　　sS = sS & v(i) & vbCrLf 　　　　Next 　　　　MsgBox sS 　　End If End Sub 余談） piroin654 さんのは >　　With appObj >　　　　For Each appObj In .Sheets 部分の、For Each 用の変数を変更すれば良いと思います。 また、Shell で起動しておくことは不要と思います。 （/Runtime オプション付きで起動した中での確認なので？）
メモ型が切れるんですね キーワード「 CSVでエクスポートするとメモ型長文の後半が切れてしまいます。」を グーグル検索すると、VBAによる出力サンプルを見つけられます
1点補足 utf8_unicode_ciの場合、半角全角の違いや、濁音半濁音の違いなども 吸収してしまうので注意してください。 半角「a」で検索して全角「Ａ」がヒットしたり、 濁音「ば」で検索して「は、ぱ」やカタカナ「ハ、バ、パ」や半角「ハ」が （※この掲示板だと勝手に変換されるので半角にみえませんが） ヒットしたりします。 またLIKEを使うと微妙にヒットする値が違ったりするのも要注意です。
1. http://dreamhost-日本語.com/%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95/wordpress-install/ 2.http://www.atmarkit.co.jp/ait/articles/0106/01/n … 3.https://developers.google.com/speed/pagespeed/in … 4.http://wpdocs.sourceforge.jp/%E7%94%A8%E8%AA%9E% … 一応参考になりそうなサイトを挙げましたが、それだけの情報量で知識の漏れを気にするのであれば本を数冊買ったほうが効率的だと思います。 下記の本で1.~4.まで大体網羅していると思います。 「HTML5&CSS3」 「WordPressデザイン」 「サーバ構築の実際がわかる Apache[実践]運用/管理」
フォーム参照のパラメータクエリをVBAで扱う方法 http://www.tsware.jp/tips/tips_586.htm かな。
途中から失礼します。 >請求先から複数の依頼案件にまたがって入金されたりすることもあるので、 >それをシステム設計で自動的に、 >顧客がどの依頼案件の支払なのかを作りこむことは出来ないのでしょうか？ ここの部分だけですが、件数が少ない（５件とか）場合は なんとかなる場合もあります。 が、 実体験から、 １・条件を満たす複数の組み合わせが出来る場合が多い。 ２・件数が多いと時間が掛かりすぎて無理。２のｎ乗の組み合わせから探すことに、ｎは件数。 （出来たとしても１の問題があります） ３・振込手数料の問題 （通常は手数料を振込元が負担していたがタマに手数料を差し引いた額になる） （経由する金融機関次第で手数料が変わる。） （普段は都銀→都銀、タマに「じゃアタシがついでに振り込んどくね」で信金→都銀） ４・消費税の演算（誤差）の解釈の違いから１円差でヒットしない、切り上げ・四捨五入とか。 ５・その他、作業・納品などに問題があって・・等々などなどナドナドで無理でした。 で、 請求書には一意の番号を、 請求書の中の明細も全てを通じて一意の番号となるようにしておきます。 入金額に疑問がある場合には先方の経理担当に電話して どの請求書番号（請求明細番号）についての入金なのかを確認していました。 しっかりした経理なら応えてくれるはずです。 非常にアナログ的ですが、消しこんでゆく方法は他に無いのでは？と思います。
＞if($rows && !empty($_POST['numberSearch'])){ $_POST['numberSearch']が"0"のときemptyで評価すると正となります !emptyですから偽ですね emptyは理論的な空ですから 空文字列""、整数の0、浮動小数点数の0、文字列の"0"、NULL、FALSE、 空の配列array()、変数が宣言されているが値が設定されていない変数 などすべて空とみなします。 http://php.net/manual/ja/function.empty.php ちなみにSQLで参照するのにWHERE句に検索文字を入れない意味がわからない。 また古いmysql_系の関数を使い続けるはデメリットしかないので リプレースを検討してください
＞ちなみに、phpMyAdminのデータがなかったという状態です。 であれば ＞$sql = "INSERT INTO ideamemo_table (color, title, contents, create) VALUES ('$color', '$title', '$contents', '$create');"; で与えている各変数$color,$title,$contents,$createがきちんと入っていないのかも この直後に以下をして確認してみてください print $sql; また、mysql_query($sql, $con);がエラーを吐いているかもしれないので mysql_query($sql, $con) or die(mysql_error()); でエラーを拾うのも手です。 ＞mysqli()関数などを用いた方がいいってことですよね？ mysql_関数から一番移植性が高いのはmysqli_関数の手続き型です。 ただしあくまでもコンパチな機能なので可能であればPDOなど 現時点で標準的な仕様に切り替えた方がよいとおもいます
どこで詰まっているかがよくわかりませんが すでに正規化がされているのですから商品管理テーブルを用意してい 商品ID、商品固有のデータ、ブランドID、性別ID、カテゴリーID、 ブランドサイズID、インタナショナルサイズID を入れていけばよいでしょう。 たとえば売上集計用に販売管理テーブルが必要になった場合一番単純なモデルで 商品ID、数量、金額、日付 などを入れておけばよいです。 ただしご指摘の通り効率的な集計をしたいのであれば販売管理テーブルに それぞれのIDまで埋め込んでインデックスを貼っておけば おそらく数倍～数十倍高速化ができます。
＞１つずつチェックをするのは非常に非効率 (1)ページングする つまり１ページに表示するデータ数を制限する また１ページ当たりの表示数ルはユーザーが任意に選べるようにする （10、50、100くらいの大雑把に） (2)ページごとにすべてチェックする・すべてチェックを外す を選べるようにする (3)データの引き継ぎにはセッションをつかう とすればある程度まとまった単位で処理できるとおもいます ただし、1万件のデータを選んだあと印刷実行というのはミスが頻発しそうです。 選ぶ画面はあくまで選ぶ画面として確定までしてしまい 印刷は確定データをつかって選択画面なしに印刷した方がよいのでは？
join するのにかっこでくくる必要はないのでは？ また正規化するにあたってはleft joinを多用するのはどうかと。 各IDが存在する前提でinner joinでつなぐことをお勧めします それと、PDOを利用するのに「SET NAMES utf8」を発行するのはやめるべき PHPのバージョンにもよりますがdsnで指定するかoptionを設定してください http://php.net/manual/ja/ref.pdo-mysql.connectio …
補足: 1対多であれば、先の補足は無視してください。
#3の解釈については問題ないと思いますよ SQL文作成の流れとしては (1)ユーザーテーブル、アイテムテーブルもに存在するジャンルの数を数える select user_id,item_id,count(*) from user_genre as ug inner join item_genre as ig on ug.genre_id=ig.genre_id group by user_id,item_id; (2)ユーザーテーブルのユーザーごとのジャンル数を数える select user_id,count(*) from user_genre group by user_id; (3)この２つを突合し、user_idごとのカウント数が同じものを選ぶ 仮にitem_idが持ってないジャンルをuser_idが持っていた場合は(2)>(1)になる 逆にuser_idに持ってないジャンルをitem_idが持っている場合でも (1)で選別されているので(1)が(2)を超えることはない なお(1)と(2)の付け合わせの際には(1)の集計結果と(2)を比較するので 集計結果を利用して検索をする場合はルール上havingを利用するのが妥当。 もちろん(1)をサブクエリにして(2)とjoinしても同じ結果。
http://www.lancers.jp/work/detail/439177
テスト環境無いので未確認ですが。 Select t1.No from テーブル as t1 where t1.商品 = ’Ａ’ minus select t2.No from テーブル as t2 where t2.商品 Not in （’Ａ’, ’Ｂ’, ’Ｃ’） ;
＞INT(10)に設定されているため、保管数の限界が存在します MySQLのデータ型を誤解しているようです INT(10)は精度ではなく、桁揃えをつかうためのオプションです。 http://dev.mysql.com/doc/refman/5.1/ja/numeric-t … 「この表示幅オプションは、カラムに指定された幅よりも小さい幅の整数値を 表示する際に左側をスペースで埋めるために使用されます。 」 具体的には、属性を「UNSIGNED ZEROFILL」にしたときINT(10)であれば 一桁の数値は左に「0」が9個埋められる・・・という仕様です。 INTはINTとしての精度をもっていますので、桁あふれはほぼ考える必要はありません。 それでもINTが不安なら無駄だとはおもいますがBIGINTを利用してください またオートインクリメント自体、ユニークなコードを発生させる手段にすぎません。 抜け番を埋める行為自体、究極の無駄なので考える必要はありません。 とくにプライマリーキーとして使用している場合は、プライマリーキーが ころころ変わるのではテーブルの管理ができません。絶対にやめるべきです。
通常、ご質問のような事はしません。 同じデータが複数のテーブルにあることで ファイルサイズが大きくなってしまう。 一つのテーブルだけ一部のデータを更新し、 残りのテーブルの更新を行わなかった場合にデータの整合性が取れなくなる。 （顧客番号110の商品番号10の3月のデータがテーブルAとテーブルBで異なるけどどっちが正しいの？） などよろしくありません。 一般的？には テーブル1 顧客番号|商品番号|　年月|金額 　　　10|　　　10|201401|　50 　　　11|　　　10|201401|　20 　　　10|　　　10|201402|　30 　　　10|　　　20|201401|　50 　　　11|　　　20|201401|　30 　　　10|　　　30|201402|　10 のようなテーブル構造にしてクロス集計クエリで 顧客番号|商品番号|合計金額|201401|201402 　　　10|　　　10|　　　80|　　50|　　30 　　　10|　　　20|　　　50|　　50| 　　　10|　　　30|　　　10|　　　|　　10 　　　11|　　　10|　　　20|　　20| 　　　11|　　　20|　　　30|　　30| とすると思いますけど？ ※レイアウトが崩れてしまっていたらメモ帳にでもコピペしてフォントを等幅にしてください。 Access2002の場合のでちょっと古いですが今どき（2010など）でも一緒です。 https://www.microsoft.com/japan/office/previous/ … ご参考まで。
SQLiteの関数やフローの仕様がよくわかっていませんが CASE WHEN random()<=30/88 THEN 1 WHEN random()<=22/58 THEN 2 WHEN random()<=18/36 THEN 3 WHEN random()<=13/18 THEN 4 WHEN random()<=4/5 THEN 5 ELSE 6 END 的な処理をすればいいのでは？
　環境の記載が無いので、いったい、どこまでの構文が使える不明なので考え方だけ。 　一つビューを作ります。 　ビューのカラムは、元のテーブル全てのカラムに、pointの百分率の累計値を付け加えたものです。（もし、データが三桁の個数があるなら千分率に、四桁の個数があるなら、万分率にしてください） 　１００まで（千分率なら１０００まで、万分率なら１００００まで）の乱数を生成し、乱数の数値以下で且つ最大の累計値を持つレコードを選びます。 　これで、ポイントの比率に従った確率で、ランダムなレコードが選定できます。 　工夫すれば、ビューを生成しなくても一つのＳＱＬで組めるかもしれませんが、利用できるselectの構文に依存します。 　累計値が一つのＳＱＬで生成できるかも、同じくです。
なんだか以前にも似たような質問を見かけたことが あるのですが、忘れました。 「参照」とあるのはこのテーブルの値を参照して 他のテーブルの数値の合計を出すとか、そういうことですか。 もし、そうであるならば、二つのテーブルをレコードセット にしてグルグルとループさせる必要があるならば少し 具体的でないと関数が書けないと思いますが。 質問のテーブルは連続した数値が1から並んでいますが、 実際にもそうなのですか。 データベースのテーブルはデータの並びにユニークキーが なければ、データの並びはランダムなので、「3セル分上の値」 ということは確定できません。あるいは、質問の「数字」の フィールドのようにデータが昇順になっている、あるいは 昇順に設定できる、ということであれば話は別ですが。 もっとも「7を基点に4までの範囲」と「７を起点に7,6,5,4という 感じで3セル分上の値を指します。」の部分が謎なのですが。 No2さんは理解しておられるようですが。 どのように「数字」からデータを取り出し、どのような合計を 出したいのか具体的なプロセスがわかれば簡単なのですが。
mysqldumpのオプションに--default-character-set=ujisを指定するとどうですか？ もともとの作成データベースはeucjpmsのほうがいいようですが。
＞この場合、一つのテーブルに同じ都道府県や市区町村が重複して入るのを良しとす ＞るお考えでよろしいでしょうか? ＞この場合、運用上のやりやすさを考えたご提案かと思いましたが、その場合、デー ＞タ量が多少大きくなるのはOKとされますか? ENUMやSETで処理する限り、内部的には数値で管理されるため理論的に容量はさほど 大きくはなりません。したがって都道府県などリストの内容がほぼ普遍的なものに ついては容量を理由に正規化する必要はありません。 （とはいえ10年単位で考えると都道府県合併も可能性はありますが・・・） http://ja.wikipedia.org/wiki/%E5%88%97%E6%8C%99% … また市区町村は結構変更があるのと都道府県の下につく二次データであることから ENUMやSETに向きません。 正規化してもいいし、そのまま文字データで持ってもいいと思います。 ＞「SQLにおける効率的なデータは必ずしも容量を少なくするものではありません。」 正規化というのは多数の重複がある前提の技術です。 重複数があまりない場合は理論的には効率化されていますが実際には無駄な処理に なります。 また該当するカラムを集計のキーに使わない場合は無駄にインデックスを消費するため データは大きくなる半面全体的なスピードは低下する傾向にあります。 たとえば仮に「東京都」でデータを抽出するとき、ダイレクトに書いてある場合は 直にインデックスが効きますが、正規化してあると都道府県テーブルから 「東京都」を探し、都道府県IDを抽出したうえで都道府県IDに紐づいたレコードを 探すことになるので、処理的にはむしろ効率的ではありません。 実際には都道府県IDを最初から抽出した状態から検索するインタフェースなので 逆に正規化しておかないと、都道府県リストを都度つくる無駄がでますので 善し悪しでしょう。 ＞「都道府県名を入力欄にいれると不正にデータを抜かれやすくなると言われていた ＞時期もありますが、 ＞セキュアな技術を使えばそれは避けられるでしょう」 端的にいえばSSLで解決します。 もちろん都道府県IDに紐づけばトラフィックも減らせるので悪いわけではありません。 またインターネットのトラフィックが爆発的に増えている現在 よほど重要な個人情報でないかぎり住所からデータを不正に抜くことが 現実的ではなくなっているきらいもあります。 ＞都道府県名に対して、外部制約キーをつかったり、データ型をsetにしたりする ＞ことでデータを効率化することも可能です。 一部訂正します。 住所は都道府県が２つ以上存在しないためSET型よりENUM型がよいでしょう。 http://dev.mysql.com/doc/refman/5.1-olh/ja/enum. … ＞市町村名まで正規化するのが実用的かどうか 経験則でいえば、正規化する意義はあまり感じません。 例えば何万、何十万というデータ郡から市町村単位で広範なデータを集計する ようなケースを想定しているのであれば話は別ですが、単なる住所録としては メンテナンス性がおちるため市区町村名での正規化はお勧めしません。
失礼しました CALLしたプロシージャの結果をOUTを利用せずに使いたいのですね？ プロシージャから他のプロシージャを呼び出すことはできますが 呼び出すプロシージャ内で行っているSELECTは結果ではなく経過でしかないため SELECT文のようにカーソルでは受けられないですね。 書式的にもカーソルはSELECT文しかうけつけません http://dev.mysql.com/doc/refman/5.1/ja/declare-c …
利用者数 に対してフィールド名の別名宣言を省略しているのことに対する疑問でしょうか。 ユニオンクエリにした場合、フィールド数とデータ型があっていればフィールド名は異なっていも問題ないです。 最初のSELECT文のフィールド名が採用されます。 ですので、2番目は別名の宣言は省略しても問題ないのです。 SELECT "商品数" AS 項目, 年月, 商品数 AS 数量 FROM テーブル名 UNION ALL SELECT "利用者数", 年月, 利用者数 FROM テーブル名; これでもいいし、省略せずに丁寧に書けば、 SELECT "商品数" AS 項目, 年月, 商品数 AS 数量 FROM テーブル名 UNION ALL SELECT "利用者数" AS 項目, 年月, 利用者数 AS 数量 FROM テーブル名; となります。 最初のSQLは片方は別名宣言して、片方は省略したので紛らわしかったですね。 疑問に思ったことはこのようなことでしたしょうか。
Salary　テーブルの index がどうなってるかによります。 データ自体は、参考例に１，２行あればいいので、create 文の方を載せてほしかったですね。カラム区切りも解らなくなっていて、ほとんど載せる意味がない。 テーブルの意義から言って、Salaryテーブルでは、日付とEmployeeIDが決まれば、一行しか存在しないことが必要だと思いますが、もし、この２カラム連動でのunique index を貼っていなくて、同日に同一者に多重支払いしている行が存在するなら、Bと名付けたサブクエリ内でgroup by EmployeeID として、取得結果側カラムは sum(Amount) as Amount とする必要があるでしょう。 でも、現実の状況で、もし、同じ日付＆同じEmployeeIDで複数行あったら、バグ扱いになりそ。
こういうことでしょうか？ select S_Id , count(case C_Id when 1 then 1 else null end) Count_1 , count(case C_Id when 2 then 1 else null end) Count_2 , count(case C_Id when 3 then 1 else null end) Count_3 , count(case C_Id when 4 then 1 else null end) Count_4 , count(case C_Id when 5 then 1 else null end) Count_5 , count(case C_Id when 6 then 1 else null end) Count_6 , count(case C_Id when 7 then 1 else null end) Count_7 from Person where Z is not null group by S_Id; C_Idの種類分だけ列記しなくてはいけませんが・・
Select * From "曲名テーブル" as t1 Left Join "アーティストテーブル" as t2 On t1."アーティスト番号1" = t2."番号" Left Join "名前テーブル" as n_t1 On t2."アーティスト" = n_t1."番号" Left Join "アーティストテーブル" as t3 On t1."アーティスト番号2" = t3."番号" Left Join "名前テーブル" as n_t2 On t2."アーティスト" = n_t2."番号" Where (n_t1."名前" like '%大塚愛%' or n_t2."名前" like '%大塚愛%') 純粋にorでどちらかがhitすれば出るようにしてるだけですね。 頂いた情報をもとに書くとすればこんな感じでしょうか。 作曲者と編曲も同じようにすれば大丈夫です。
Access　VBAにてExcelファイルのシート名を取得したい http://answers.microsoft.com/ja-jp/office/forum/ … でも質問されているようですが、以下に違う方法を紹介しておきます。 （ADO は使える環境になっているものとして） Public Sub Samp1() 　　Dim cn As New ADODB.Connection 　　Dim rs As ADODB.Recordset 　　Dim sA() As String 　　Dim i As Long 　　Const CFILE As String = "Excelファイルのフルパス" 　　cn.Open "Provider=Microsoft.ACE.OLEDB.12.0;" _ 　　　　　　& "Data Source=" & CFILE & ";" _ 　　　　　　& "Extended Properties='Excel 12.0'" 　　i = 0 　　Set rs = cn.OpenSchema(adSchemaTables) 　　While (Not rs.EOF) 　　　　ReDim Preserve sA(i) 　　　　sA(i) = Left(rs("TABLE_NAME"), Len(rs("TABLE_NAME")) - 1) 　　　　i = i + 1 　　　　rs.MoveNext 　　Wend 　　rs.Close 　　Set rs = Nothing 　　cn.Close ' '　この後、sA の配列（ 0 スタートの添え字）にシート名が入っているので、 '　続けて処理するとか ' End Sub ※ 一応、Excel ファイルが xls でも、変更することなく動くみたい ※ 2000 / 2003 で動かすのなら、以下２か所を変更してください Microsoft.ACE.OLEDB.12.0 ↓ Microsoft.Jet.OLEDB.4.0 Excel 12.0 ↓ Excel 8.0
テーブル名を ★★ フィールド名を、左から F1 ～ F5 と仮定します。 また、提示あった内容の順が保証されるように、 オートナンバ「an」昇順で表示されているものとします。 以下をクエリの SQLビューに記述してどうなりますか SELECT * FROM ★★ AS Q1, ★★ AS Q2 WHERE Q1.F1=1 AND Q1.F1<>Q2.F1 AND Q1.an < Q2.an AND IIF(Exists (SELECT 1 FROM ★★ WHERE F1=1 AND an>Q1.an), Q2.an < (SELECT Min(an) FROM ★★ WHERE F1=1 AND an>Q1.an), Q2.an <= (SELECT Max(an) FROM ★★));
utf8固定なのでできません。 http://dev.mysql.com/doc/refman/5.6/en/server-sy …
見直したら、そもそもの条件がおかしいような気がします。 請求テーブルには[加入者ID]があるようには見えない。 > が選択されて、請求テーブルの更新日付を見て古い方を取ってくるので > 結局258087 20140412が取得されます。 201405 20140922が欲しいの？ 最初の１レコードを取得するロジック？ なら、現行のコードのまま、 > ORDER BY 更新日付 ASC を ORDER BY 更新日付 DESC にする。 直積使ってテーブル結合したらどうなるのかな？ SELECT 色々 --列名をt1、 t2で修飾してね FROM 請求テーブル t1, 請求テーブル t2 WHERE t1.識別ID = t2.識別ID AND t2. 加入者ID = 変数 ORDER BY t2.更新日付 DESC ; CREATE VIEW はググって下さい。 VIEWにするときはWHERE条件の AND t2. 加入者ID = 変数 は不要。VIEWに対してWHEREで変数を指定して下さい。
> で、実際のCSVファイルは数十万行あるのですが、 このファイルをコピー、編集して３行とかにしたら、２行目はきちんと取り込めますか？ 対象のCSVファイルの改行コードがVBAで想定しているものと違っていて、１行読み込むつもりが改行をきちんと見つけられずにファイル全体を読んでしまうとか？
無限ループ処理になりそうなので無理だと思います たしょうタイムラグはでますが スケジュール管理用のテーブルをひとつ用意して、 コールしたいイベントが発生したときに管理テーブルのフラグをたて イベントスケジューラでフラグが立っていたらcallしてフラグを消す ・・・的な処理を5分ごとに実行すればある程度目的は達成できるかと どうしても即座に反映したければ、アプリケーション側でCALLする方が 確実ですが。
こんにちわ。 マニュアルを軽く見てみましたが、明確に記載されている箇所は無さそうです。 Pro*C の場合、C言語にNULL値の概念が無いにも関わらず、NULL値の判断を C言語行えるようにするため、インディケータ変数があるのだと思っています。 PL/SQL の場合変数にNULL の概念があるので、NULL値を読んでくればNULL値 で上書きされます。
あまり深く考えていませんので、件数が多いと使いものにならないかもしれません。 with 休日テーブル as ( select 'busyo1' 部署コード, date'2014-09-13' 休日 from dual union all select 'busyo1' 部署コード, date'2014-09-14' 休日 from dual union all select 'busyo1' 部署コード, date'2014-09-20' 休日 from dual union all select 'busyo1' 部署コード, date'2014-09-21' 休日 from dual union all select 'busyo1' 部署コード, date'2014-09-23' 休日 from dual union all select 'busyo2' 部署コード, date'2014-09-07' 休日 from dual union all select 'busyo2' 部署コード, date'2014-09-14' 休日 from dual union all select 'busyo2' 部署コード, date'2014-09-21' 休日 from dual union all select 'busyo3' 部署コード, date'2014-09-20' 休日 from dual ) , 日付 as ( select trunc(/* sysdate */ date'2014-09-24' - 1) - level 日付 from dual --とりあえず過去30日分の日付 connect by level <= 30) select 部署コード, 日付 from ( select 部署コード, 日付, count(*) over(partition by 部署コード order by 日付 desc) cnt from (select distinct 部署コード from 休日テーブル) 部署マスタ cross join 日付 where not exists ( select * from 休日テーブル where 部署マスタ.部署コード = 休日テーブル.部署コード and 日付.日付 = 休日テーブル.休日 ) ) where cnt = 10; こまかい説明を書く時間がないので、そこはSQLから読みとってください。すみません・・・
技術的な話になると微妙ですが結論からいえばサブクエリが問題になることはまずありません じつは今回のSQLも select member_no ,member_name,max(title2) as max_title2 from member inner join rireki on rireki_member_no=member_no where title2 between '2014-09-13' AND '2014-09-19' と書くとわずかに効率的になるのですが、本来のSQLの書き方からいうと じゃっかんズルをしているところがあるのであまりお勧めしません。 いずれにしてもきちんとインデックスを設定しておけば、スピードに大差はないでしょう。 どうしてもカリカリにチューニングをしなくてはいけない場合に 調整項目としてはサブクエリを除外する検討が必要になってくるかもしれません
INSERT INTO TABLE_A (NAME_A) VALUES ('あいうえお') INSERT INTO TABLE_B (A_ID,NAME_B) VALUES (SCOPE_IDENTITY(), 'さしす')
まず、条件をなるべく素直に書くと↓のようなSQLになりました。 SELECT DISTINCT 車名 FROM 自動車 a WHERE EXISTS ( SELECT * FROM 自動車 b WHERE a.車名 = b.車名 AND 装備 = 'エアコン' AND 数量 = 2 ) AND EXISTS ( SELECT * FROM 自動車 c WHERE a.車名 = c.車名 AND 装備 = 'ブレーキ' AND 数量 = 1 ) ; WHERE句でサブクエリーを使って、条件にマッチする行の存在をチェックしています。 これでは、ちょっと冗長な感じがするのでGROUP BYとHAVINGを使って書き直すと下記の様になりました。 SELECT 車名 FROM 自動車 GROUP BY 車名 HAVING SUM(CASE WHEN 装備 = 'エアコン' AND 数量 = 2 THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN 装備 = 'ブレーキ' AND 数量 = 1 THEN 1 ELSE 0 END) > 0 ; HAVING句内で集約関数とCASE式を組み合わせる事によって、1番目のSQLと同様の存在チェックを行っています。 蛇足ですが、車種も装備も同一の行が複数有ると思えませんので、連番の行は冗長かと思います。 下記の様に車名と装備の組が主キーとなっても良さそうに見えます。 車名(PK), 装備(PK), 数量 参考URL：http://codezine.jp/article/detail/652
joinしてlimit指定でdeleteできると楽なのですが、標準のSQLではないようです まぁ普通に考えればプライマリーキーやユニークキーのないテーブルは データを特定過程が煩雑なので通常のSQL文では処理は難しいですね。 つまりはテーブルの作り方が変・・・ということです。 普通は重複してから消すのではなく、重複しないように属性をつけます 無理やりdeleteする方法としては (1)distincでテンポラリにデータを移し、truncateした後戻す (2)プロシージャで消す のどちらかが妥当です
　まず、やっていいこと、いけないこと。から。 ＞これは日付（開催日）で代用しようと思っています。同じ日に2試合は「絶対に」ないので。 　この部分は、極めて正しい対応です。 　でも、 ＞1試合で一方のチームが10点を取ることは「限りなく0に近いので」とりあえず10用意する。 　これは、絶対にやってはいけません。こういう事をやった時に限って、１００年に一度しか無い、11対１５なんてスコアに巡り会うことになります。（迷信のようだというなかれ。マーフィーの法則として知られる法則群の一つです。限りなく０％に近い確率で起こることは、何れ、必ず、そして最悪のタイミングで発生すると言います。） 　さて、全部をテーブル化しようとすると、スペースにも限りが有るので、考え方の一つを紹介しておきます。 　まず、属性がいろいろと出ていますが、その属性が、「何に依存するものなのか？」を考えます。言い換えると、何が決まれば、その属性を特定することが出来るかです。 　例えば、ホームチームの１ゲームの得点で有れば、開催日と開催場所が決まれば、必ず特定できますね。（もし、有るチームの試合に対して「だけ」のデータであれば、開催場所は不要です。） 　この組み合わせで特定できる属性の他の例は、ホーム・アウェイの各チームの監督名とか、主審名とか、１ゲーム全体に関わる属性群となります。 　さて、有るゴールの得点者は、何に依存しているでしょう？開催日と開催場所と、発生時間（試合開始からのタイム）となります。 　さて、こうやって、全部の属性が、何に依存しているかを整理してみましょう。 　こうやって作業していった時に、「開催日と開催場所」とか、「開催日と開催場所と、発生時間」とかいった有る事象を特定するためのキーになる物を主キーとします。 　そして、主キーに依存しているものを全て、テーブルの項目としてテーブル内に格納します。 　（こうすれば、ゴール１・ゴール２・・・・なんて項目にはならないはずです。ある特定の時間に発生するゴールは絶対に１つだからです。） 　考え方によっては、「開催日と開催場所、発生時間」の組で特定できるものが他にもあります。警告や反則の発生です。これも、ゴールと同じテーブルに入れることが出来ます。ただし、この場合は、この時間に何が起こったのかを記録するフィールドがひとつ必要になります。その代わり、ゴールも警告も反則もとにかく、ゲーム中に発生したイベントは全てこのテーブルに格納できます。 　 　ここで注意するのは、どちらのチームで発生したのか（どちらのチームの得点になったか）は、記録の必要はありません。選手名が解れば、各チームの選手リストを登録してあるテーブルから調べられますからね。 　 　むやみにテーブルを増やす必要はありませんが、テーブルを分けるのを怖がってはいけません。事象を特定するためのキーが異なる時は、あっさりとテーブルを分けましょう。 　この作業を、「正規化」と言います。（かなり作業を簡略化しています。ここまでを正しくやれば、第２正規化と言われる部分までの作業が終わるはずです。「ここで注意するのは」の項が見落としなく配慮出来れば、第３正規化まで終わるはずです。普通は、ここまで出来れば、よしとされます。） 　データベースのテーブル設計をする時には、避けて通れない作業ですから、根気よくやってみてください。この作業が正しく出来れば、次にデータベースを使うアプリケーションを作るのが、ぐっと楽になります。 　頑張ってくださいね。
エンジンにもよりますが基本は自動ロックでユーザーが任意におこなう 必要はないものだと考えてよいでしょう。 とくにトランザクション処理すればデータ競合もほぼ問題ならないです。
変数にそのcsvファイルのパス例えば "file:" & Get ( デスクトップパス ) & "ファイル名.csv" とかを入れて、Event送信ステップでその「ファイルを開く」にすると エラー処理オン時はそのファイルが存在しない場合Get(最終エラー)=100 が返ります。有るときは開いてしまうけど、Windowsのコマンドか何かで 閉じることできるのかな？
【補足】MAX()、MIN()の回数を減らすには・・・。 SELECT 　　Max(Format([カード番号],"0000") & ":" & [名前]) AS THE_MAX, 　　Min(Format([カード番号],"0000") & ":" & [名前]) AS THE_MIN, 　　CutStr([THE_MAX],":",1) AS Max_番号, 　　CutStr([THE_MAX],":",2) AS Max_名前, 　　CutStr([THE_MIN],":",1) AS Min_番号, 　　CutStr([THE_MIN],":",2) AS Min_名前 FROM T4 GROUP BY T4.ファイル番号, T4.順番;
それこそ100件程度なんだったら、コピー先にも既にテーブルが存在している前提の操作なら、 Microsoft Accessのテーブルリンクや他のツールを使って、レコード全体をコピペすれば出来そうですが。
> ではサーバーを使用するユーザーを増やすことは出来ないのでしょうか レンタルサーバーは複数人が使いますから、自由にユーザを増やすとユーザ名がぶつかる場合もありますから、1契約につき1ユーザの可能性がありますね。 hostingerに問い合わせてみて下さい。
補足 よくよく考えたら更新の際、user_idが変更になる場合は OLD.user_idに対してもアップデートしないといけないですね DROP TRIGGER IF EXISTS TRG_UPDATE_USER_ITEM; DELIMITER // CREATE TRIGGER TRG_UPDATE_USER_ITEM AFTER UPDATE ON user_item FOR EACH ROW BEGIN CALL UPDATE_ITEM_TYPE(NEW.user_id); IF OLD.user_id != NEW.user_id THEN CALL UPDATE_ITEM_TYPE(OLD.user_id); END IF; END; //javascript:void(0); DELIMITER ;
入力済みのデータなら、重複クエリウィザードで確認できます。 http://www.nbcom.co.jp/PC-Support/FAQ/acc/ht/acc … 新規のデータの追加をさせないなら、ロット、商品ID、生産者コードでユニークキーにすればいいのでは？ まあ条件付き書式でこだわるなら =DCount("*","テーブル名","ロット = '" & [ロット] & "' And 商品名 = '" & [商品名] & "' And 生産者 = '" & [生産者] & "'") >1 DCount関数 http://office.microsoft.com/ja-jp/access-help/HA …
実用にはidとdateの組み合わせがユニークであるという条件が必要ですね 処理的にはこう select * from tbl where (id,date) in (select id,max(date) from tbl group by id);
MySQLと連携するアプリでCSVをSQL文に変換しながら投入すればいいのでは？
よくあります。 何度もチャレンジしてみてください！ わたしは繰り返ししてたらできましたよ（＾∇＾）
CopyFromRecordsetについて調べてみると http://www.moug.net/tech/acvba/0090011.html オートメーションでExcelを操作した時にハマりそうな事 http://hanatyan.sakura.ne.jp/vbhlp/ExcelErr.htm
集計に１秒以上かかった場合集計中にデータが変化していくため １秒単位のデータをリアルタイムに集計することはかなり厳しいです 手っ取り早い高速化は例えば１日単位で中間的に集計したデータを 別のテーブルに保持し（日締処理）、当日分のデータと切り分けることです。 過去のデータは変化しないため集計することだけ考えればいいので。 そもそも1Gを86400秒で割ると毎秒11Kちょいのデータになります。 そうなると集計項目もかなり多いと予測されるので、 よほど真剣に仕様をきめこまないと運用に耐えないと思います
SQL Server Data Toolsというツールが使えそうですがどうでしょうか。 参考URL：http://codezine.jp/article/detail/6531
select id, iif(status=200,'ABC'+name+'XYZ',name), status from Members って感じ？試してないけど。
構築は可能です。 ただし運用できるかは質問者さんのスキル次第。 自分でファイルサーバを立ち上げることで解決しますね。 　　　ＲＡＩＤ１＋５ くらいで構築すれば良いと思います。 （ＲＡＩＤ６が必要かは判断できません） 手元にファイルサーバがあれば、それなりに早いＬＡＮ接続なら データの転送速度に不満は出ないと思います。 複数のパソコンから同時にアクセスするなら１００Ｇ　ＬＡＮおすすめ。 （１０Ｇでも良いかもしれませんがｗ） モバイル用途であれば、外付けＨＤＤを必要数用意してフォルダ単位で同期を取り 使用するデータが含まれる外付けＨＤＤを持ち出せばＯＫ。 まさかファイルサーバごと持ち出すわけにはいきませんからねｗ 手っ取り早く通信速度が速いプロバイダ契約をするというのもアリかもしれません。 （専用回線を契約するとかね）
よくあるランク付けの方法を応用すればよいでしょう。 まず、id順でitem_idごとにランクをつけます SELECT id,user_id,item_id,( SELECT COUNT(DISTINCT id) +1 FROM user_item AS t2 WHERE 1 AND t1.id > t2.id AND t1.item_id=t2.item_id ) AS rank FROM `user_item` AS t1; これを元に、user_idが1、rankが1のものを抽出します。 なお上記rank項目はHAVING句に移動します SELECT id,user_id,item_id FROM `user_item` AS t1 WHERE user_id=1 HAVING ( SELECT COUNT(DISTINCT id) +1 FROM user_item as t2 WHERE 1 AND t1.id > t2.id AND t1.item_id=t2.item_id )=1;
＞sort列は取得しないようにできますか・・・？ サブクエリにいれてしまえばよいでしょう select id,region,station from( select id,region,null as station,0 as sort from tb1 union select id,region,station1,1 from tb1 where not station1 is null union select id,region,station2,2 from tb1 where not station2 is null union select id,region,station3,3 from tb1 where not station3 is null union select id,region,station4,4 from tb1 where not station4 is null union select id,region,station5,5 from tb1 where not station5 is null ) as sub order by id,sort
まぁ普通日付の範囲を検索するときはbetweenですけどね SELECT * FROM m_nendo WHERE '2014/03/31' between sdate and edate
こんにちわ。 #1 のmuyoshid です。 > ちなみに、そのソースはどこかにありますでしょうか？ この辺が参考になるでしょうか？ SQL 言語リファレンスのfor update 句の説明です。 http://docs.oracle.com/cd/E16338_01/server.112/b … > 別の人を説得しなければいけないのです。 そうであれば、ユーザ登録が必要ですがOTN Japan から試用版をDownload して 実際に動かして確認した方が良いと思います。 参考URL：http://www.oracle.com/technetwork/jp/index.html
「expdat.dmp」の中に「STUDY.TEST2」というオブジェクトの 情報がないという意味のメッセージが出ているので そのまんまの内容だと思うのですが。 そもそもData Pumpはバックアップや別のスキーマ・インスタンスに 移動する際に使用する機能であって、同一スキーマの別テーブルに 移動する為に使用するものではなかったと思います。たぶん。 study.TEST1のデータを削除して以下のコマンドを実行したらどうなりますか？ impdp system/パスワード@XE directory=test_dir dumpfile=expdat.dmp log=test_imp.log tables=study.TEST1 content=data_only
CSVファイルの内容が提示無いので推測ですが 項目1,項目2,項目3 1,あ,あ,いい なら当然の結果と思います。 あ,あ　を１つの項目として扱いたいのなら、少なくとも 項目1,項目2,項目3 1,"あ,あ",いい という内容になっていないと１つの項目として解釈しないと思います。 元々のCSVファイルを作成する際に変更するよう依頼してみては？
CSV ファイルを、ヘッダなしファイルとして解釈させます。 以降得られるフィールド名は、F1、F2、・・・ 不要な　XXXXXX　部分は、２番目のフィールド以降 Null で除外判別できます。 ２行目の項目名部分の項目1は、 おそらく、以降のデータを解釈した際に数値と解釈されると思うので （項目1 部分が数値として解釈されたのなら Null に置き換わります） 項目1,項目2,項目3 ↓ Null,項目2,項目3 解釈が違っても項目1の有効なデータ部分は数値の様なので・・・ そこで、IsNumeric(F1) AND F2 Is Not Null　の条件を付加して インポートしたいテーブルと項目を列挙し、 それに対応する F1、F2、・・・・を記述した SQL を実行させれば終わりです。 以下は、項目3 までの記述になりますが Public Sub Samp1() 　　Const CSQL As String = "" _ 　　　　& "INSERT INTO テーブル名(項目1,項目2,項目3) " _ 　　　　& "SELECT F1, F2, F3 FROM [{%1}] IN " _ 　　　　& "'{%2}'[text;FMT=Delimited;HDR=No;IMEX=1] " _ 　　　　& "WHERE IsNumeric(F1) AND F2 Is Not Null;" 　　Const CPATH As String = "CSVファイルがあるフォルダへのフルパス" 　　Const CNAME As String = "CSVファイル名" 　　Dim sSql As String 　　sSql = CSQL 　　sSql = Replace(sSql, "{%1}", CNAME) 　　sSql = Replace(sSql, "{%2}", CPATH) 　　CurrentDb.Execute sSql End Sub ※ CSV ファイルのパスが D:\tmp\Hoge\テスト.csv だったら CPATH は、D:\tmp\Hoge CNAME は、テスト.csv
テーブル名は、Tseq とします。 下記のSQLでどうでしょうか。 Accessで試してうまくいきました。 SQLite ではどうか分かりません。 SELECT Tseq.ID FROM Tseq, Tseq AS T1, Tseq AS T2 WHERE Tseq.Point=30 AND T1.ID=Tseq.ID-1 AND T1.Point=20 AND T2.ID=Tseq.ID-2 AND T2.Point=10;
むしろ全文検索とは何か理解されていないなら FULLTEXT INDEXを設定することはまずないでしょう InnoDBとか対応していないし・・・ 全文検索自体は半角スペースで分かち書きされた文書（一般に英語の長文）の 特定のキーワードに高速にヒットさせるものなので、日本語との相性はわるく そもそもemailの検索としても適切だとはいえないのでこのケースでは 使うことはないでしょう。 慣れるまでは通常インデックスのみの運用で問題ないと思いますし おそらくよほど使いこなす人以外は一生使わない機能の一つだと思いますよ。
中規模の掲示板システムとなれば、Webサーバの冗長化やスケールアウトによる負荷対策と言ったことも考慮しなければいけないのではないでしょうか。 そうなると ・データの一元管理 ・書き込みの競合 と言ったことへの対策としてもDBを利用するメリットがあると思います。
cast してみたら？ insert のときは、カラム型に合わせて、かなり柔軟対処してくれるけど where などでの比較式においては、カラム値の方を文字列変換してから、文字列比較したりすることがあるらしいので（特にdatetime と日付だけの文字列を比較したとき）、今回は文字コードかCOLLATE の関係で、それが発生していると見られます。 その場合、文字列を日付にキャストするといいらしいです。 WHERE day = CAST('2014-8-19' AS DATE) 　この日付文字列の所を、プレースホルダーにすれば、ユーザーから日付入力して貰っても、範囲外でもない限りかなり柔軟に、日付対応できます。 参考 http://matsu.teraren.com/blog/2010/07/27/mysql-d … 「MySQLの日付比較：比較対象のカラムは型を意識しなければならない。」
> 動き的には一緒だったりしますかね…。 実行プランを見れば分かります。 http://technet.microsoft.com/ja-jp/library/ms178 …(v=sql.105).aspx SQLServerのオプティマイザは賢いので、SQLクエリを多少変えた程度では変わらないはずです。 パフォーマンス向上にはインデックスの追加が有効かもしれない。 ランクテーブルにインデックス{順位, 製品ID}を追加
PostgreSQL 8.4以降であれば、contribモジュールのcitext型を使うと、大文字小文字の区別のない主キーを定義できます。 【例】 test=# CREATE EXTENSION citext ; CREATE EXTENSION test=# CREATE TABLE ci_sample (key citext PRIMARY KEY, value text); CREATE TABLE test=# INSERT INTO ci_sample VALUES ('abc', 'foobar'); INSERT 0 1 test=# INSERT INTO ci_sample VALUES ('abC', 'foobar'); ERROR: duplicate key value violates unique constraint "ci_sample_pkey" DETAIL: Key (key)=(abC) already exists. PostgreSQLが9.1よりも古い場合は、CREATE EXTENSIONの代わりにSQLスクリプトを実行する必要があります。 【参考】 https://www.postgresql.jp/document/9.0/html/cont … 参考URL：https://www.postgresql.jp/document/9.3/html/cite …
ファイルシステムもデータベース（DB）も、何かしらのデータを格納する「道具」の種類であって、要はそれを使って便利かそうで無いか？で適時取捨選択する物です。 例えばデスクトップPCは何でも出来る便利な道具ですが、わざわざ電車の中で使いますか？　背中にでっかいバッテリを背負って、大きなモニタまで抱えて。 でも、そういう事をする奴はたまにいますが、普通はやりません。物理的にはもちろん可能ですが、便利では無いし、メリットも無いからです。普通の賢い人間は、スマホやノーパソを使うもんです。 DBもファイルシステムも、そういう風に取捨選択するモノです。 ＞コンピューターを使うには、データ（電子データ）が必要です。 それ以前に”プログラム”が必要です。データだけあってもタダの箱です。 ＞データを保存するにはデータベースが必要と聞いた事があります。本当でしょうか？ 正しい言い方をするなら、データを保存する一つの形式（方法論）にDBがある、というものでしょう。 ＞キャッシュメモリーはデータベースの構成要素の一であり 構成要素では無い気がしますが。どちらかというと、高速化の為の工夫といった感じでしょう。 （もちろん現実のシステムではキャッシュのヒット率を高めたりするためにインデックスを振ったりなんだと色々行うわけですが。キャッシュはDBというよりPC本体のメモリ（DBを稼働させるシステム側）に構成されるものです） ＞キャッシュメモリーにデータがあればデータベースにデータがあるという事と聞いた気がする。 あまたの状況の一瞬では成り立つ事でしょうが、一般的な事象とは言えません。 通常のシステムでは、DBの実体（データ）はストレージまたはコンピュータの主記憶（メモリ）にあります。 キャッシュは利用頻度の高い特定のデータを、アクセスが高速なメモリに一時的に蓄積されていることを示しているため、すべてのデータが全ての時間軸でキャッシュにあるということはあり得ません。 ＞ありとあらゆるデータを保存できて、何にでも活用できるそうです。本当でしょうか？ 本当です。 ただし、「出来る」と「普通はそうする」はイコールではありません。 音楽で使う五線譜のノートは、国語でも算数で図画工作でも使おうと思えば使えますが、普通は音符を並べる事にしか使いません。 写真データをDBに入れることは出来ますし、そういう実装をしたシステムもたくさんありますが、大概の人は写真データはファイルシステムに画像ファイル（例えばjpegファイル）といった形式にして保存するでしょう。 ＞ 例えば、リレーショナルデータベースの操作にSQLが使われますが、このプログラム文をリレーショナルデータベースに保存しますでしょうか？ やろうと思えば出来ますし、DBのデータとしてで無ければストアドプロシージャという仕組みが結構使われています。DBのシステム側によく使うSQL文を前もって登録しておくやり方です。 http://ja.wikipedia.org/wiki/%E3%82%B9%E3%83%88% … ＞私の認識だと、SQLはテキスト形式のSQLファイルで、マイドキュメントなどのフォルダーに保存します。 よっぽどのことが無い限り、SQLをマイドキュに保存するようなことはしません。 SQLはプログラム内部（敢えて言うならProgram Files以下）もしくは前述のストアドに保存します。 人間が読める＝テキスト形式ではありませんし、SQLファイルなる物も（実装によって色々あるでしょうが）通常メインのプログラムファイルと同じフォルダに入れるべき物です。 マイドキュメントは、ユーザのファイルを保存する場所であって、プログラムの構成要素を保存するところではありません。（やろうと思えば出来ますが、私の関わるプロジェクトでそんな実装したら設計ミスとしてやり直させます） ＞SQLの他、小説、写真、音声、ビデオ、３次元CADなども、リレーショナルデータベースに保存しますでしょうか？ 出来ますが、普通はやりません。メリットが無いからです。 ただし、一部のクラウド上のファイル保管サービスの類では、あらゆるデータをDBに入れてしまうといった実装もあります。それは全部DBに突っ込めばメリットがある使い方だからです。 ＞セル１つには、１行文字列、実数（整数と有限少数）、時刻、NULLだけが保存できます。 どこのDBのことを示しているのかよく分かりませんが、バイナリだろうと特定の文字数だろうと、より多くの種類のデータを扱えます。 ＞リレーショナルデータベースにも小説を保存できる。その方法は、小説を３０字区切りで分割し、主キーを振ること。１つのセルに３０字の文を保存し、その下に次の３０字の文を保存し、これを終わりまで繰り返します。正しいでしょうか？ 原理的には間違いと言えませんが、現実論からいうと間違いでしょう。 今のDBは、質問文で曰く１セルに小説一冊分全部入れられます。 わざわざ３０文字で区切る実装を行う意味もメリットもありませんし、そもそも主キーは何を振ります？ 主キーになんの意味を持たせて、DBのデータの検索性を増すのでしょうか。 ＞リレーショナルデータベースにも写真を保存できる。先ず、赤表、青表、緑表の３つを用意する。各表のマトリクスサイズは膨大で写真のピクセルがセルに対応し、行×列に配置します。各セルには画素３原色の強度数（0～255だとgif形式だっけ？）を保存する。その後、赤青緑の３表を合成し、ビットマップで出力します。正しいでしょうか？ 原理的には間違いと言えませんが、現実論からいうと間違いでしょう。 今のDBは、質問文で曰く１セルに画像ファイルを全部入れられます。 わざわざＲＧＢを分割した１ピクセル＝１セルに分ける意味は何もありません。 人に手紙を送るとき、はがきに一文字ずつ書いて、文字数分の枚数のはがきを送りつけるような物です。 ＞リレーショナルデータベースは銀行でよく使われていて、お金の出入りや顧客管理でリレーショナルデータベースは大活躍しているそうです。だけど、本当はもっと用途が広い？ コンピュータシステムのほぼ全てにDBが使われていると言っても過言では無いでしょう。 ただし、DBの中にリレーショナルデータベースという種類のシステムがあるので、リレーショナルではないDBもあります。KVS等が有名です。 http://ja.wikipedia.org/wiki/NoSQL ＞フォルダファイルシステムとデータベースは別物と聞いた事があります。一方で、フォルダファイルシステムの基本はデータベースで、データベースに何かアプリを組み合わせてフォルダファイルシステムが形成されているとも聞いた事があります。どっちが正しいでしょう？どっちも間違い？ 考え方としては、そうと言うことも出来る、といったものでしょう。 http://ja.wikipedia.org/wiki/%E3%83%95%E3%82%A1% …
#2のお礼欄にある例を使えば create table bukken(id int, bukken_name varchar(30), chiiki_id int, address varchar(200), price_min int, price_max int, station varchar(30)); insert into bukken values(1,'名駅MID',1,'愛知県名古屋市中村区則武本通x丁目xx番',40770000,55100000,'名古屋駅'),(2,'プレサン浄心',2,'愛知県名古屋市西区城西x丁目xxxx番x',30800000,40001000,'浄心駅'),(3,'アネシア八事',3,'愛知県名古屋市昭和区高峯町xxx番',50000000,62510000,'八事日赤'); create table fudou_kodawari (fid int not null,kid int not null,unique(fid,kid)); insert into fudou_kodawari values(1,1),(1,2),(1,3),(2,1),(3,2),(3,3),(3,4),(4,3),(5,4),(6,4),(7,1),(8,1),(8,2),(8,4),(9,5),(10,1),(10,4); として、fudou_kodawariに1かつ4を持つfidは8と10になります。 bukkenテーブルにidの8,10がないためヒットするレコードは一つも表示されません。 bukkennテーブルに該当レコードを入れたうえで再チャレンジすればいけると思いますよ SELECT * FROM bukken WHERE id IN (select fid from fudou_kodawari where kid in (1,4) group by fid having count(*)=2); サブクエリ部分の考え方 (1)select fid from fudou_kodawari where kid in (1,4) とすると1か4のレコードが表示される (2)select fid,count(*) from fudou_kodawari where kid in (1,4) group by fid とすると1か4のレコードがfidごとにいくつあるか表示される (3)select fid from fudou_kodawari where kid in (1,4) group by fid having count(*)=2 1か4でカウントされた個数2・・・つまり1かつ4のレコードが抽出される という流れです。 これをbukkenのidに対してINで抽出するわけですが、bukkennはレコードが被ることはないので bukkenに対するDISTINCTは不要です。
＞html上の英語に変換されたデータをどうやったらデータベースに入れられるのでしょうか？ ああ、なるほど元文書はwebで公開されているのですね？ であればなぜ英語版をデータベースに登録しようという考えに至ったのでしょう 単純にhtmlに埋め込んでマルチ言語対応のhttpdで公開するのが妥当では？ またDBにどうしてもデータを入れたいのであればルートからのフルパスで、 ファイル名を指定してそれをキーにテーブルに登録する方法が考えら得ますが ファイル名をキーにしてしまうとなんらかの理由でファイル名を変更しなくては いけないときにはまりそうですね。
No.6です。 >Rubyのexcel2csvライブラリから勉強してみようと思います excel2csvはエクセルで作成したファイルをシート単位でデータを読み込むライブラリです。ドキュメントを見てもよくわかりませんでした。例が書いてあるのでそれを真似した使えるようになりました。主はRubyです。Pythonなどのスクリプト言語でもかまいませんが、一から始めるのでしたらRubyが良いのはないか勝手に思っています。多少複雑なことをするのでしたら強力なツールになりますので、何かのスクリプト言語を知っておくと業務の効率化に役に立つことが多いです。 ただし、excel2csvは既存のエクセルファイルのどこかのセルに書き込むなどの複雑なこと無理です。集計した結果を表示するとか、新しいエクセルファイルとして書き出すという用途には適しています。既存のEXCELファイルに手を加えるのでしたらVBAや http://magazine.rubyist.net/?0027-ExcellentRuby など（リンクの下の方に関連したリンクも）を参考にしてください。 さて、先に書いたファイルメーカーで作った予算管理データベースのことについて少し触れておきます。 だいぶ前になるのですが、外部資金をもらったプロジェクトをやっていて、そのプロジェクトのために会社のシステムと切り離した厳密な予算管理を要求されていましたので、土日を二回ほど潰して作ったものです。 発注、納品、支払いの品目ごとの管理と、月々の支払いの集計ができ、注文書や集計表の印刷や、未払いの金額を含めた予算管理ができるようにしました。 ファイルメーカーでもやる気になればこの程度のことはできます。結構複雑なことをしていましたので、作るのがたいへんではありましたが。 今だったら、Ruby on Railsで作った方がだいぶ楽なように思いますが、 顧客名簿などの比較的単純なものでしたら、ファイルメーカーが適していると思います。 No.7にの書かれているように共有が簡単にできますし、 顧客名簿程度でしたら素人でも手をつけられるものです。（私も素人ですが）
db2 "CREATE TABLE TableA (order_id char(3),product_id char(10), product_name char(20), quantity int)" db2 "INSERT INTO TableA VALUES ('001','product001','商品名１',2),('002','product001','商品名１',1),('002','product002','商品名２',2),('003','product002','商品名２',1),('003','product003','商品名３',1)" db2 "SELECT product_id, max(product_name), sum(quantity), substr(xmlserialize(xmlagg(xmltext(concat(', ',order_id))) as varchar(50)),3) FROM TableA GROUP BY product_id" PRODUCT_ID 2 3 4 ---------- -------------------- ----------- -------------------------------------------------- product001 商品名１ 3 001, 002 product002 商品名２ 3 002, 003 product003 商品名３ 1 003 3 レコードが選択されました。 当方、DB2で実行しています。PostgreSQLで使えればいいのですが。
とりあえずトリガーつかってみてください http://dev.mysql.com/doc/refman/5.1/ja/create-tr … 基本的にはテーブルごとに、追加・削除・更新のトリガーを それぞれ作っておくとよいでしょう。 ちなみに微妙なのが「ユーザー名」の扱いですね 通常、mysqlのアクセスは管理者、編集者、読者程度のユーザーを設定し それに対して、webアプリなどでアクセスして更新する際に 代理で作業をさせると思います したがって、質問者さんがいうユーザーが、実質上のユーザー（作業者）であるなら そのユーザー名を渡してあげないといけないし、mysql上のユーザー（権限者）であるなら それを取得する必要があります。
マシンBに２つmysqlを立てればいけるんじゃない？ そうでなく１つのmysqlプロセスでやりたいという場合は 理論的に命題がなりたっていないような・・・ A=B、B=CでA!=Cということですよね？
>データーベース設計する際、店舗と通販は別々のテーブルを作成する必要があるのでしょうか？ 出荷元テーブルをつくって出荷元コードに店舗と通販を別コードで登録すればいいでしょう 店舗数と通販数はそれぞれ１つずつですか？ 複数店舗、複数通販サイトを管理するのであれば、出荷元テーブルだけでなく 出荷属性テーブルで、店舗と通販を分けておくと 店舗の合計出荷や通販の合計出荷など属性ごとに集計ができるようになります。 （厳密には分けなくてもいけますが、分けた方がより集計しやすい）
オンライン中は更新途中のファイルが数多く存在します。 更新中にディレクトリーでコピーされたものは整合性がなく、 万が一の時に戻しても整合性エラーでデータベースが立ち上がらなくなります。
こんにちは！ Sheet1にコマンドボタンを挿入しておいて、コマンドボタンをクリックすると Sheet1の2行目データをSheet2の最終行以降にカット＆ペーストしたい！ という解釈です。 もしそうであればわざわざSheet1にデータを入力し、おなじデータをSheet2に持ってこなくても ユーザーフォームにテキストボックスを4個とコマンドボタンを配置し、 ユーザーフォームのコマンドボタンをクリックで直接Sheet2に表示させる方が簡単だと思いますが、 敢えて質問通りにやれば、 Sheet1のコマンドボタンのコードを↓のようにしてみてはどうでしょうか？ ＞したいことは、データ４列で・・・ とありますので、A2～D2セルとしています。 Private Sub CommandButton1_Click() Dim wS As Worksheet Set wS = Worksheets("Sheet2") Range("A2").Resize(, 4).Cut wS.Cells(Rows.Count, "A").End(xlUp).Offset(1) End Sub Excel2007以降をお使いだとして・・・ （ActiveXコントロールのコマンドボタンを挿入するとします） メニュー　→　開発　→　挿入　→　ActiveXのコマンドボタンを選択し、Sheet1に挿入 →　挿入したコマンドボタン上でダブルクリック　→　上記コードの1行目と最終行はすでに表示されている状態ですので、 2行目～最後から2行目までをドラッグ＆コピー　→　そのままVBE画面のカーソルが点滅しているところに貼り付け →　「デザインモード」を解除してSheet1に戻りA2～D2セルにデータ入力　→　コマンドボタンをクリック！ としてみてください。 ※　今回はActiveXコントロールのコマンドボタンとしましたが、 オートシェイプ等でも構いません。m(_ _)m
う～ん。質問者の意図というか思い（それと質問者のお客さんがやりたい事）というのも分かるんだよね。 回答No.1で名寄せは「駄目」ではなく「可能な限り行うべきではない」という言い方をしたのは、 現実は往々にしてあるんだよね。そういう「お客様からの要望」が。 ○○コード、○○IDという概念自体が分からない、という人も居る。 なので名寄せが不可避な状況もある。 もちろんコード手打ちしてね、合ってたら店舗名が出てくるから、 店の名前がないときはこっちのボタンを押してあらかじめ店を登録してから続けてね、 という説得を試みるのは可能な限り行った方が後々お互い（デベロッパーとユーザー）のために良いとは思うんだけど、 まだ（お客様に見せれるシステムが）出来上がってない段階でお客さんにそれをイメージして納得して貰うのは極めて難しい。 質問者とお客さんがそれぞれ「餅」という言葉を聞いて頭の中で絵を描いてそれについて議論しろっていう事だからね。 で、店舗名寄せ法（毎回店舗名を入力）の場合、当然「マルナカ」と「マル　ナカ」は違うコードが割り当てられる。「株式会社ほげほげ」と「（株）ほげほげ」も同様。 これを後でどうするか（店舗コードを使ってるテーブル全部で片方の店舗コードに一気に書き換え＆消えた店舗コードを店舗マスタから削除）は完全に仕上げておかないと後で大変なことになる。 もっとも、店舗は本当に店舗名を書くだけで特に店舗ごとに集計が要らない、だから上の突合せ処理は要らない、というのだったらこの限りではない、んだけど、それならそもそも店舗を店舗マスター化する必要がない。 こういったタイプの名寄せ法を採用するなら店舗マスター化せずに本当に毎回店舗名を入力させて、後で購入履歴テーブルから似たような店舗名をピックアップして同じ店舗名に統一するという方法もあろう。この場合は本当に店舗名がテーブルの中では単なる関数従属なデータとなるが、システム側で何とかすると考えれば楽っちゃ楽な方法かも知れん。という意味でも店舗を店舗マスターかする必然性がない。 逆に、岐阜県にある「バイクショップみらくる」と熊本県にある「バイクショップみらくる」からの購入をどう分けるかという事についても考えねばならん。 > 実は店舗はユーザーがCSVで100店舗とか、1000店舗とか、一気に挿入できるようにしています。 > もしユーザーAが店舗コードS100～S300を挿入、ユーザーBが同時にS200～S400を挿入した場合、 > S200～S300が被ることになります。 わしはむしろこれが気になった。 ユーザーAとユーザーBで店舗コードがかぶるんが困るんなら 店舗コードの先頭n桁をユーザーIDという定義にすればいいだけだし、 CSVに手で入れたらかぶるやんけーっとユーザーから突っ込まれるのがイヤなら 最初から店舗コードをCSVにいれなければいい。 今回の課題で私が言いたい事は、今まで質問者から得られた情報だと 店舗マスターが単なる名称マスターとしての価値しかないという事だ。 私はそもそも名称マスターなるものは存在意義が無いと考えている。 名称マスターを設けて得られるメリットは、せいぜいDBサイズが若干減るくらいだ。 システムから見たデータベースの使い勝手はほとんど変わらない。 HDD単価が1GB当たり8円という時代にそんな事に腐心するくらいならもっと大事なことを考えようよというのが私の考え方だ。
こんにちわ。 > これを回避する方法ってありますでしょうか？？ 他スキーマが所有者なのでuser_sequences ではなく、all_sequences を使って下さい。
こちらの質問をされた方ですよね。 http://oshiete.goo.ne.jp/qa/8691890.html AccessとSQLServerによる環境構築(フロントエンドやバックエンドと仰っている新環境)について、ちょっとうまく伝わらなかったみたいですね(汗)それは後述するとして、先に質問に回答させて頂きます。 >【質問1】 >構築後、Accessのテーブルやフィールドを変更することはできるのでしょうか。 →後述しますが、質問者様がされようとしている新環境を実現すると、Accessからテーブルがなくなります(要らなくなります)。なので直接の回答としては「できません(もしくは不要)」が回答になります。 >【質問2】 >上記の仕組みをWindowsサーバではなく、UNIXサーバ上で実現できるでしょうか。 →AccessもSQLServerもWindowsのパソコンやサーバーで動きます。残念ながらUNIXでは動きません。 こちらはSQLServer。システム要件をご確認下さい。 http://www.microsoft.com/ja-jp/download/details. … Access2013はこちら。OfficeアプリケーションのAccess2013→オペレーティングシステム参照。 http://office.microsoft.com/ja-jp/products/FX102 … さて…AccessとSQLServerによる新環境を作ろうとするとテーブルがなくなると回答致しました。 質問者様も書かれている通り、SQLServerはデータベースを構築するソフトです。そのデータベースには様々ないわば部品を作ることが可能ですが、テーブルもその一つ。Accessにもテーブルはありますよね。つまりSQLServerにAccessのテーブルとデータを引っ越してしまい、個々のPCからはAccessからSQLServerのテーブルを参照する、というのがこの新環境。個々のPCからはSQLServer内のテーブルにデータを読み書きしに行くので、Access内にテーブルは不要となります。 これにより、みんなで同じSQLServerのテーブル(の中のデータ)を読み書きするので、データの一元管理ができる、個々のPC内のAccessにデータが分散されない、というのがこの新環境のミソだったかと。 新環境は↓こちらの図のようなものになるかと思います。 http://dba.fyicenter.com/faq/sql_server_2/Connec … ご健闘をお祈りしています。
＞誤差が発生しないようにできないでしょうか？ 質問の意図がわからないのですが、明細単位と総計での消費税誤差の話であれば 根本的な考え方として消費税とはそもそもが誤差がでる仕組みなので 小手先でなにをやっても無駄。会計上も税務上もする明細で調整する必要がない 8%の消費税をまるめるためには25円単位で取引をする必要があり そうでなければ明細単位で丸めて計算し、総額との誤差を「消費税差異」として処理する 消費税差異がプラスであれば雑収入だしマイナスであれば雑損 明細単位であわせたいとか、取引先との違算を調整したいのであれば 値引きやリベートで都度調整する、普通は経理の人がうまくやってくれる 私の解釈がちがいfloor関数に内在するなんらかの数学的な誤差の話であれば 誤差の具体的な例示があれば調べようがあるかも
こんにちわ。 > 出展が明記できてなくて申し訳ありません。個人的なblog等ではないので執筆者に > 問い合わせるなどはできないようです。 迷ったらマニュアルを見るようにすると良いと思います。 Version が明記されていないので、11.2 のマニュアルを見てみました。 Audit 文 http://docs.oracle.com/cd/E16338_01/server.112/b … これによると、最初のAudit table 文は「CREATE TABLE, DROP TABLE, TRUNCATE TABLE」 のSYSTEM 権限監査の設定のようです。 次に、「AUDIT TABLE ON ＜テーブル名＞」と言う構文は無いようです。 > また、特定のテーブルに対するすべての操作の監査をするには > AUDIT SELECT,INSERT,UPDATE,DELETE,LOCK ON <Schema>.<Object> BY ACCESS; > だけではDROPやCREATEが監査できないので不十分でAUDIT TABLEと組み合わせないと > 無理ということになるのでしょうか？ この場合、OBJECT 監査なのでAudit all on <Schema>.<Object> ～ で監査設定ができますが、SYSTEM 権限監査でやっているCreate, Drop, Truncate 等は 監査されません。 参考URL：http://docs.oracle.com/cd/E16338_01/server.112/b …
こんにちわ。 > 監査証跡への出力項目として上の用語が出てくるのですが、いまいち違いがはっきりしません。 上の項目は全てv$session から取得した値が入ります。 セッション識別 : SID 　これは、Database への接続で使用しているセッションのID です。 　実行中のSQL を中断させる時にSID, Serial# の組み合わせで指定すると言えば 　感じが分かるでしょうか？ クライアント識別 : CLIENT_IDENTIFIER 　これは、アプリが明示的にDBMS_SESSION.SET_IDENTIFIER を使って登録するものです。 　これをしておくと、特定のアプリから実行されているSQL の識別が容易になります。 端末識別子 : TERMINAL 　クライアントの端末名です。 > 実際のログの例などから教えていただければ理解しやすいかと思います。 v$session をselect してみると分かると思います。 因みにv$session の詳細は以下のURL からどうぞ。 http://docs.oracle.com/cd/E16338_01/server.112/b …
SQLを考える時は理論の組み立てが肝要です。 (1)部門別に日時の最大値を求める。 (2)テーブルから、部門と日時が(1)と同じものを求める。 厄介なのは英語だから逆になることです。 SELECT A.* FROM テーブル AS A INNER JOIN (SELECT 部門,MAX(日時) AS 日付 FROM テーブル GROUP BY 部門) AS B ON A.部門=B.部門 AND A.日時=B.日付 ()の中のサブクエリが(1)になります。外側のSELECTが (2)に該当します。
なんだか誤解されるのもアレなので、連投？ながら補足させて下さい。 質問文からの推量になりますが、質問者様の社内状況としてAccess→SQLServerに変更します、ということがまだ決定もしていないんじゃなかろうか、と。とりあえず「複数人で入力をする必要が出てきた」のでその方法を探っていて、お手軽にできるんじゃなかろうか？と質問されたのだと思っています。 そこで私の回答としては、Access→SQLServerの移行って結構大変な作業ボリュームになりそうですよ、ご自分でやるのも結構大変、まして業者に頼んだところで…ということでパッケージソフトでクリアできる処理内容ならそっちの方が楽じゃないの？という内容にしたつもりです。 別にパッケージソフトの回し者ではないですけど、ある程度定型化されたシステムへの移行の方が、移行作業も今後の運用も楽になると思います。 ご健闘をお祈りしています。
こんにちわ。 > しかし、次のSQLを実行しても、ログが出力されません audit の設定をした後で、一旦再接続してみて下さい。
cd PDO_MYSQL-1.0.2 のあとに phpize で作られます 参考URL：http://pentan.info/php/pdo_mysql_install.html
書式としては col1 = 'A' AND col2 = 'B' AND col3 = 'C' なら WHERE (col1,col2,col3) IN (('A','B','C')) ORならセットで複数指定して WHERE 　(col1,col2,col3) IN ( 　('A','A','A'), 　('B','B','B'), 　('A','B','C') ) という書き方もあるにはあります。パフォーマンスはEXPLAINしてみて。 ご参考まで
ロックを掛けた接続内では、ブロックされないので、ロック状況の取得は出来ないようです。 テスト状況を作るには、２つ以上の接続を作って、一つは、ロックしたままとする必要があるので、コマンドラインクライアントと、xampp(apache)などのhttpサーバー経由しphpでmysql接続とを駆使して、以下のようにしてみると、どのようにロックが行われているかを見ることが出来ます。 [1]. コマンドラインクライアントから、ロックする > lock tables `xx_tbl` write; [2]. phpで、上記ロックしたtableにアクセスするphpプログラム実行 select * from `xx_tbl` 　　しかし、writeロックがかかってるので、待機状態になり、結果は返ってこない 　　とりあえず、このウィンドウはこのままおいて [3]. ブラウザの別ウィンドウまたは別のタブから、以下を発行するphpプログラム実行 show processlist; 　→　３スレッドが返ってくる i: コマンドラインクライアントのスレッド、接続のままさわってなければ、sleep ii: ロックテーブルにアクセス待機中スレッド、Stateカラム に waiting という記述、Infoカラムに、待機中クエリの内容 　　ブロックされたクエリが表示されるだけなので、from 句からロック中のテーブルを推測するしかできない。 iii: show processlist;　を発行したスレッド。Infoカラムにそのクエリ [4]. コマンドラインクライアント で、ロック解除 > unlock tables; 　[2] のウィンドウをそのまま開いていれば、待機終了して、データ取得した結果が表示される。 ということで、ロック中のテーブルへさらに他からアクセスしている時しか、それを関知することはできないようです。
Access持ってないので、確認はできませんが。 #6 の最初の方法だと 名簿.ID,属性.type 4,1 4,2 ができるので、4,NULLの行が無い→where に該当しない、となりそうですが その次のやつは Select 名簿.ID, 名簿.Name, 属性.Value from 名簿 Left Outer Join (select ParentID,Value from 属性 where Type = 3) as T on 名簿.ID = T.ParentID Where 名簿.IsMarried = True で動きませんか? #1でエラーになる、というのも気になります。
FULL OUTER JOIN
カラムAが昇順で有る事が条件ですが select (select sum(カラムA) from テーブル t2 where t2.カラムA<=t1.カラムA) from テーブル t1 group by カラムA order by 1 です。
ANo1 です。補足です。 とりたい結果に【テーブルA】は重複してでていますが、 もし出したくないのなら。 select key,max(dataA),max(dataB),max(dataC) from ( select key,dataA,Null as dataB,Null as dataC, ROW_NUMBER() OVER (PARTITION BY key order by dataA) rn,key as keydmy from 【テーブルA】a union select key,Null as dataA,dataB,Null as dataC, ROW_NUMBER() OVER (PARTITION BY key order by dataB) rn,key as keydmy from 【テーブルB】 union select key,Null as dataA,Null as dataB,dataC, ROW_NUMBER() OVER (PARTITION BY key order by dataB) rn,key as keydmy from 【テーブルC】 ) group by keydmy,key,rn order by keydmy,rn ※とりたい結果には、keyが出ていない行がありますが、【テーブルA】が1行しかないときに 出さないのか、【テーブルA】【テーブルB】【テーブルC】どれかが複数行あるときに出さない のか？それによってやり方は変わります。
＞Excelのファイルを直接読み込むことができるような機能 SQL文をExcelでざっとつくって、コピペでphpMyAdminに貼りつければ 済む話のような気がしますが・・・
JOIN構文はご存知ですか？ 「同一の商品」ということなので、それぞれのテーブルのgoodsIdが指し示すものが同じものだと思うので以下のクエリではいかがでしょうか？ SELECT sales.goodsId, sales.goodsName, salesSum, retailsalesSum FROM ( SELECT goodsId, goodsName, SUM( quantity ) AS salesSum FROM tbl_sales WHERE salesDate BETWEEN '2014-06-01' AND '2014-06-30' GROUP BY goodsId ) AS sales JOIN ( SELECT goodsId, goodsName, SUM( quantity ) AS retailsalesSum FROM tbl_retailsales WHERE salesDate BETWEEN '2014-06-01' AND '2014-06-30' GROUP BY goodsId ) AS retailsales ON sales.goodsId = retailsales.goodsId
＞ところでこのSQL文をtest.phpに組み込むのでしょうか？ ＞ ＞そしてどのように組み込んだらよいのでしょうか？ プログラムとデザインを分けるようにお伝えしましたが SQLとプログラムも分けて考えてください。 まずはSQL文が動作することを確認する必要があります。 PHPとMySQLを利用しているということはphpMyAdminは運用していますよね？ もししていないようでしたらマストなツールなのでインストールをお勧めします。 なお最終的にはtest.phpで提案したphp相当のものに組み込んで PDOで処理することになると思います。 実際のところ#7,8の内容には絞り込みのデータが書いていないので、 （「where 1」というのは全データを表示するという意味、これにANDで絞り込みの SQL文をつないでいきます） ユーザーから送られてきたデータをもとにどう絞り込みをしたいか仕様を固めてください
>Windows認証で接続しているユーザです。 >ユーザは同じですがドメインが異なる windowsドメインって同じユーザーＩＤでも、 ドメインが異なるユーザーＩＤはまったく別のユーザーＩＤとして扱われますが。 ＤＢでもいいけど、 ファイルアクセス権限で試してみたほうが早いかな。（同じだから） ドメインＡとＢがあって、ＸというユーザーＩＤが両方にいたとして、 ドメインＡのＸに参照権限を与えてもドメインＢのＸでは参照できません。 ドメインＡのＸを消すと、参照権限はS-xxxxxみたいなのに化けてしまって ドメインＢのＸの権限などありません。 内部的には、S-xxxxxみたいなの(SID)で管理しているので、 ユーザーＩＤがいっしょかどうかという管理はしていないということです。 ということから、質問の方法でバックアップを戻すと アクセス権限がなくならないほうがおかしいってことになります。
残念ながら、秒を消すことができません。 http://msdn.microsoft.com/ja-jp/library/ms187819 …
＞何度やっても１行目のデータしか抽出しないんです。 まあ、基本的に「やり方が間違ってる」から、何度やっても１行目しか出ないだろうね。 検索結果のシートで、上から順に、最初に見付かったもの、２番目に見付かったもの、３番目に見付かったもの…、ってやる場合は、工夫が必要だよ。 しかも、条件が「２つ」あるから、そう簡単には行かない。 担当がA1と同じ、週がD1と同じ行を、あるだけシート２に抽出したい、と言う風に思ったんだけど、違うだろうか？
＃１です 以下を参照してください http://ja.wikipedia.org/wiki/%E9%96%A2%E4%BF%82% …(%E9%96%A2%E4%BF%82%E3%83%A2%E3%83%87%E3%83%AB)#.E7.9B.B4.E7.A9.8D この中の、S:E だけの E=1,2,3 の場合を考えてみてください。 「T連番」の「連番」が、S:E に相当して、用意した連番の <=3 を使うものになります。 ※ これで回答になっていたでしょうか
select distinct * from ( select b as X from table_A union select c as X from table_A ) as table_B こんな感じ？ ちなみに、SQL Server 2008R2 で動作確認しています。
yambejpさん来てくれてよかったですね。いつも博雅適切なご回答拝見しています。 さて、ざっと見ですみませんが、こちらが想定していたこだわり条件テーブルは kid | noiyo 1　 |新築 2　 |南向き 3　 |セキュリティ充実 ～ という「定義だけ」のものでした。この場合、bukkenテーブル本体の方には SET型のカラムを作り、 | kids | | 1,3,5,8 | のように該当するkidを(複数可のカンマ区切りで)入れておきます。なのでクエリは単純で SELECT * FROM bukken WHERE (price BETWEEN '1000' AND '3000') AND (address LIKE "%名古屋市西区%" OR address LIKE "%名古屋市東区%" ～) AND ( FIND_IN_SET("2",kids) AND FIND_IN_SET("3",kids) AND FIND_IN_SET("5",kids) ) のような感じで済むはずです。(実際には*ではなくきちんとカラム名を) また、地域は、address欄をLIKEで検索すると別テーブルが不要な反面、遅いですから、物件数や対象地域の範囲により、できれば 市町村コードなど利用すればずっと速くなるかと。 その場合はbukkenテーブルにエリアコードのカラムを作成・挿入しておけば、クエリは (area_code IN (23102,23103,23104)) /* 北区 or 東区 or 西区の例 */ のようになります。 ご参考まで。 http://www.soumu.go.jp/denshijiti/code.html
SQL2000 の時に似たような事例がありました。 SQL2008R2 にも同様の問題があるのかはわかりませんが、 私が経験した事例では 比較的重いクエリーを実行すると4つのCPU(2コア×2スレッド)全てで 100%の状態が数分間続き、他の処理ができない状態でした。 最終的には、SQL2000が使用する CPU を一つ減らすことで 発生しなくなりました。 マイクロソフトの推奨として SQLサーバーを DC と同居している場合には、 CPU0は DC用に空けろとしています。 (この話は講習の時に聞いただけなので、資料としてはみたことありません)
> IBMのアンサーラインではJDBCドライバか、IBM DB2 Connectを使えということを言っていました。 > 前者はIBM製品ではないので後者のほうを薦めていました。 > 通信の問題もエクステンションが解決してくれるのでしょうか？ ノー、通信に責任を持つのはIBM DB2 Connectの仕事。 IBM DB2エクステンションはPHPとIBM DB2 Connectの橋渡しをするだけ。 しかしながら、IBM DB2 Connectって管理ツールじゃないですか？ IBM Data Server Clientというのがあればいいんじゃなかろうか。 いや、私も開発はJDBCでしかやったこと無いので正確なツール名は分からないのだが、 とにもかくにも、まずIBM DB2サーバーとIBM DB2クライアントがあって、例のエクステンションは IBM DB2クライアントの機能をPHPから直接呼び出せるようにするためのいわばラッパーなのです。 なので、まずそのWindowsサーバーにJDBCじゃないIBM DB2クライアントを入れるのが先決。 ODBCで接続できているという事は既に入っているはず（DB2 ODBCドライバーもODBCに対してDB2クライアントの機能を提供するもの）なので、誰かにエクステンションをコンパイルしてもらうだけでdb2_connect系が使えるようになるはずですよ。
PHPの32ビット版って最新版だとインストールできないんですか？ ググってみたけど、それらしい情報が無かったけど… PHPを32ビットにできないなら、Accessをやめた方が良いかも。 もともと、Accessってあんまり信頼性は高くないし。 PostgreSQLあたりがライセンスフリーで良いかと。64ビット版ももちろんあるし。
SELECT * FROM table WHERE field NOT LIKE '[0-9][0-9][0-9]-[0-9][0-9][0-9]' 参考URL：http://msdn.microsoft.com/ja-jp/library/ms179859 …
質問1については、 例えば名前と完全一致で検索するような場合は以下のようなSQLが実行されると推測されます。 select * from test_table where name='入力された内容' 「入力された内容」の部分にシングルクォートのことを何も考慮せずに「SQL'」を入れれば、 select * from test_table where name='SQL'' となり、エラーになります。 シングルクォートを正しくエスケープしていれば、エラーにはなりません。 他の質問も、where句にそのままいれたらSQLがどうなるかを考えればわかります。
クラスター
同じテーブルを追加する時は、alias (別名)をつけます。 SELECT Persons.ID, Persons.pName, Persons_1.ID, Persons_1.pName FROM (Persons INNER JOIN Relations ON Persons.ID = Relations.yourID) INNER JOIN Persons AS Persons_1 ON Relations.spouseID = Persons_1.ID WHERE Persons.IsHusband=True;
commitしてみては？
select *,datediff(`out`,`in`) diff from office order by diff asc; ○年×日というのはうるう年など勘案すると正確にだすのは工夫が必要なので 日数で表示したほうがよいでしょう
select id,date,max(cost) as cost from tbl where id=129 group by id,date
素直に UPDATE TEST_TABLE SET NAME = substring(StoreBranchName,1,len(StoreBranchName)-1) where substring(StoreBranchName,len(StoreBranchName),1) = '　' while @@rowcount > 0 begin UPDATE TEST_TABLE SET NAME = substring(StoreBranchName,1,len(StoreBranchName)-1) where substring(StoreBranchName,len(StoreBranchName),1) = '　' end とでもすれば？ と思います。 説明： 末尾１文字が全角空白なら、文字列を末尾１文字を除く文字列に置き換える。 処理結果が０件になるまで繰り返す。 なお、全角空白、半角空白と続くと、半角空白より前は削除されません。
＞QWERTYテーブルは、5つのカラム(PHOGE,　MHOGE, J, YMO, NDATE)でユニーク として、この5カラムのユニーク属性を利用するならON DUPLICATEで処理だし それ以外でユニーク処理をしたいならテーブルの制限がつかえない以上 SQLを１文でやるのはそこそこ厳しい そもそもPKってのがよくわからないのですが？
１．ほとんど英数字です。説明を付けたい場合はcommentで各カラムに説明を日本語で書きます。 長くSEをやっていますが、日本語のカラム名は過去に一度見ただけですね。 ２．全く関係ありません。 適切にプログラムを書いていればセキュリティー上の問題は発生しません。 逆に英数字だけであってもプログラムに問題があればセキュリティー上の問題が発生します。 ３．英数字を使ってます。 そもそもプログラムを書いているときは、基本的に全て半角文字で入力しますから一々日本語変換をするのは効率が悪すぎます。
自分目線であればそんな感じの管理なんでしょうね さて命題の件は //仮データ create table game(issue varchar(10),h_a varchar(10),h_score int,a_score int,opponent varchar(20)); insert into game values( '●','H','8','9','チームB'),( '○','A','2','8','チームC'),( '●','H','4','9','チームD'),( '○','A','3','4','チームB'),( '●','H','0','1','チームB'),( '△','A','3','3','チームC'),( '△','H','1','1','チームE'); として（集計結果をみるためすこしデータいじってます） (1) select (h_a='H')*h_score + (h_a='A')*a_score as score ,issue,opponent from game order by score desc; (2) select opponent,coalesce(sum(issue='○')/(sum(issue='○')+sum(issue='●')),0) as ratio from game group by opponent order by ratio desc; となります。ポイントは ＞勝率は「勝った試合数÷（勝った試合数+負けた試合数）*100」 とする場合、引き分けしかない相手をどうするかですね いわゆる勝ち点方式のように引き分けも評価対象にしないと 引き分けが多いチームとの力関係が相対評価できないと思います 今回はcoalesce関数で引き分けだけの関係は負けと同等としています また、自分がホームかアウェーかわかっていてそれぞれの点数がわかっているので issueとダブルバインドしている点が気になります。 最初の書き込みでうっかり間違えたとおり、issueによる勝ち負けと 点数によって勝ち負け判断の整合性があわなくなる場合もあり、 何をもって勝ち負けをジャッジするか決めておかないと計算があわなくなります。
まずは仕様をきめるところからですね とくに風俗（？）となると0時マタギがあるでしょうから日付で管理するのは微妙です。 まずはユーザーテーブルで、ユーザーid、ユーザー名ほかユーザー情報を管理 シフトテーブルで、開始日時＋労働時間もしくは開始日時＋終了日時で管理します。 また休憩時間（時刻）の管理までおこなうならそれなり工夫が必要です。 お店の休日にはシフトを入れられないようにしたい場合は、営業カレンダーテーブルも 用意しておくと便利です。 あとは何を検索・集計したいかでテーブルの組み方は微妙にかわってきます。 たとえば ・任意の日時時点で入っているメンバー名をすべて得たい ・メンバーごとの月単位での労働時間を集計したい ・なんらかの売上と絡めて管理したい ・労働時間内の個別の作業内容のスケジュール管理までしたい など・・・
もう1つOBを起動して、管理→セッション情報から、セッションごと殺せばいいのでは。 サーバだけで動いてるわけではなく、アプリケーションを介してファイルを選択しているから、 OBのプロセスを殺せば止まる気もしますが。
正直保管しておくだけならBLOB系のものでも問題ないでしょう 照合順序は検索や集計をするために必要になるだけなので。 また投入時にURLの整合性をチェックしたいなどあれば ちょっと工夫が必要になります。
> ただ、この方法を用いた場合ですと、前期に売上実績があり、後期に売上実績がない場合、前期の分しか表示されない状態になりました。（109期の列自体が表示されませんでした） 後期の売上実績が0件、言い換えると、「後期売上データ.」のレコード件数が 0 の場合は、後期の列は表示されません。 そういうことでしょうか。 もし、そうなら、クロス集計クエリをデザインビューで開き、ビューの上部のテーブルの背景部分をクリックして、 クエリプロパティを表示させます。そこの、「クエリ列見出し」を "前期","後期" と設定すれば、「後期売上データ.」のレコード件数が 0 でも、後期の列は表示されます。
4.1ならサブクエリが使えるはず 理論の組み立て (1)商品、月別の件数を用意する。(現クエリ) (2)月別の全件数を用意する。 (3)上記の(1)と(2)を日付で結合する。 SELECT A.nengetsu,A.product,CONCAT(A.ken * 100 / B.zen,'%') hi FROM (SELECT DATE_FORMAT(date,'%Y-%m') AS nengetsu,product,COUNT(product) AS ken FROM test GROUP BY product,nengetsu) A INNER JOIN (SELECT DATE_FORMAT(date,'%Y-%m') AS nengetsu,COUNT(product) AS zen FROM test GROUP BY nengetsu) B ON A.nengetsu=B.nengetsu ORDER BY A.nengetsu,A.product
月ごとに集計するのが決まっているのであれば、できればそれ用のカラムを用意しておくと 集計の効率がたかくなり //集計用カラムを用意しない場合 create table tbl1 (id int not null primary key auto_increment,salesdate date, name varchar(20), price int,index(salesdate,name,price)); insert into tbl1 (salesdate,name,price) values( '2014-05-01','吉田',2400),( '2014-05-01','佐藤',1500),( '2014-05-02','佐藤',3000),( '2014-05-03','佐藤',10000),( '2014-05-04','佐藤',100),( '2014-06-18','佐藤',3000),( '2014-06-30','吉田',1000); //集計 select DATE_FORMAT(salesdate,'%Y%m') as ym,name ,sum(price) as amount from tbl1 group by ym,name; //集計用カラムを用意する場合 create table tbl2 (id int not null primary key auto_increment,salesdate date,ym varchar(6), name varchar(20), price int,index(ym,name,price)); insert into tbl2 (salesdate,name,price) values ( '2014-05-01','吉田','2400'),( '2014-05-01','佐藤','1500'),( '2014-05-02','佐藤','3000'),( '2014-05-03','佐藤','10000'),( '2014-05-04','佐藤','100'),( '2014-06-18','佐藤','3000'),( '2014-06-30','吉田','1000'); update tbl2 set ym=DATE_FORMAT(salesdate,'%Y%m'); //集計 select ym ,name ,sum(price) as amount from tbl2 group by ym,name; それぞれの集計SQLをEXPLAINすると効率の違いがわかると思います
できない http://blogs.msdn.com/b/jpsql/archive/2011/06/14 …
自分で使うなら、既存のものを使えばいいじゃないですか。 「データをエクセルのように表形式で扱いたい」：データベースはSQLServerですか。
学校の宿題ですか？ ここは学校の宿題の、それもまるっぽ答えを求めるところではありません。 そして、（１）の「給与等級が多い人」はｓｑｌ文にはなりません。 写すんならきっちり写しなさい。
重複クエリは、重複するレコードを抽出するもので、 今回は重複するレコードのうち最新以外は削除するということですので、 全然違いますね。 下記でどうでしょうか。 SELECT テーブル１.[共通ID], テーブル１.[連番], テーブル１.[郵便番号], テーブル１.[住所], テーブル１.[担当者名], テーブル１.[年月日], テーブル１.[フィルタ] FROM テーブル１ WHERE テーブル１.[年月日] In (SELECT TOP 1 年月日 FROM [テーブル１] As Tmp WHERE Tmp.共通ID = テーブル１.共通ID And Tmp.[フィルタ]=2 OEDER BY 年月日 DESC) ORDER BY テーブル１.[共通ID], テーブル１.[年月日] DESC; または、 SELECT テーブル１.[共通ID], テーブル１.[連番], テーブル１.[郵便番号], テーブル１.[住所], テーブル１.[担当者名], テーブル１.[年月日], テーブル１.[フィルタ] FROM テーブル１ INNER JOIN (SELECT 共通ID, Max(年月日) As Max年月日 FROM テーブル１ WHERE [フィルタ]=2 GROUP BY [共通ID] ) As Tmp ON テーブル１.共通ID=Tmp.共通ID AND テーブル１.年月日=Tmp.Max年月日 ORDER BY テーブル１.[共通ID], テーブル１.[年月日] DESC;
あ・・・$rowsの宣言がされてないですね while($row = $stmt->fetch(PDO::FETCH_ASSOC)){ $rows[]=$row; }; の直前に $rows=array(); としといた方がいいかもしれません。
　この解答が正しいことだけを説明するなら、たいしたことでは無いのですが・・・ 　まぁ、先にやっておきましょうか。 　（１）主キーの存在理由。 　関係データベース（普通は、リレーショナルデータベースとカタカナで書かれることが多いですね。）は、数学の集合論をベースにした理論体系です。 　まず、集合には、行の順序はありません。これを理解しておいてください。 　社員の住所を記載した従業員表を作るとしましょう。このとき、Ａさんのデータが欲しい時に、どうやって、Ａさんを指定するかというのが問題です。（Ａさんの住所を調べたい時にも必要ですし、Ａさんが引っ越したから住所を変更するという時にも必要ですね。Ａさんが退職した時にも、まずＡさんのデータを指定する必要があります。ありとあらゆる操作の基本操作です。） 　従来のファイル形式のデータや表計算ソフトですと、１番目のデータとか５番目のデータとかいう表現が出来ますが、関係データベースでは、この表現は不可です。先に書いたように順序が無いからです。 　では、Ａさんの名前で行を指定しましょうか？もし、同姓同名の人がいたらどうしますか？（あり得ない話ではありません。というか、比較的良くある話です。） 　普通は、社員番号を一人に一つづつ割り振り、社員番号で行を指定します。これなら、絶対に重複することはありません。（というか、重複しないように割り振るという方が正しいですね。）この社員番号が主キーになります。 　これは、この従業員表を使う全ての手続きにおいて、必ず社員番号が指定されていることを表します。平たい言い方をすれば、会社に出す申請書類や報告書類には必ず社員番号が書いてあるということです。 　ちなみに、もし、他に社員を完全に一意に決められる属性があるなら、別に社員番号をわざわざ作る必要はありません。例えば、この国では、法律で、「同じ日に産まれた人は絶対に違う名前で無ければならない」と決められていたします。そうすれば、社員番号は実は不要です。主キーは、（名前・生年月日）の組で表すことが出来ます。 　これが主キーの存在意義であり、主キーの定義の一部です。 　（２）正規化の意義 　引き続き、従業員データベースを例に。従業員には、所属課があります。当然、課には、課長がいます。課長も従業員ですから、住所も電話番号もあります。 　これを１行に全部登録することは可能です。 　従業員番号・名前・住所・電話番号・課名・課長社員番号・課長名・課長住所・課長電話番号 　という表を作ったとしましょう。 　課長の住所は、この表にいったい何回現れるでしょうか？まず、課長の自分のレコードに一回。課員全員の課長住所として、課員の数だけ。おんなじデータを何回も何回も登録するのは、ディスクスペースの無駄だと思いませんか？これが、データの重複です。 　この表には、まだ問題があります。これは、人事異動の季節に顕在化します。課長さんがめでたく栄転され、新しい課長さんが着任されました。さぁ、問題です。この表の何行を直す必要があるでしょうか？はい。課員全員の課長の属性全部と、元課長自身の所属に、新任の課長自身のレコードをちゃんと直す必要があります。一つでもやり忘れたら、元課長さんは、元部下を道連れに転任したことになってしまいます。 　このようなことが起こらないように、表の形を、決まった形で変形していくのが、正規化というプロセスです。 　さて、答えの解説は、終わり。 　なんですが・・・実は、これ、データベース理論の本なら、第一章の中に書いてある内容です。つまり、スタート地点なんです。 　この段階で既に引っかかっていると言うことは、データベースの学習を何もしていないと想定できます。 　できれば、データベースの理論書を探して（どんな物でもかまいません。ＭｙＳＱＬやＳＱＬＳｅｒｖｅｒやその他、特定のデータベースの入門書でもかまいません。）一冊読みこんでおくと良いでしょう。 　残念なことに、データベースの理論は、ｗｅｂの断片的な情報だけでは理解することが、わりと難しい分野です。基礎から順番に理解していく必要があるからです。
こんな感じでよくない？ DELETE R_TABLE FROM R_TABLE LEFT JOIN P_Master using(id) WHERE P_Master.id IS NULL
試してないけど set @maxseq = @maxseq - 1; bulk insert test_table from 'C:\data\test.csv' with (firstrow = 1,lastrow = @maxseq,formatfile = 'C:\ImportOrg_Fmt.xml'); でうまくいくような気がする。 それでだめなら declare cmdstr as varchar(2000); set @maxseq = @maxseq - 1; set cmdstr = 'bulk insert test_table from ''C:\data\test.csv'' with (firstrow = 1,lastrow = ' + @maxseq + ',formatfile = ''C:\ImportOrg_Fmt.xml'')'; exec (cmdstr); といった感じで書く。 execは http://msdn.microsoft.com/ja-jp/library/ms188332 … 参照。
> >通常は得意先ごとの担当＝期間×担当者で組みます。 > > 設定としては、「T得意先マスタ」に、期間フィールドを設ければ > 良いのでしょうか？ 担当の履歴を残したいとなると、 担当者 と 得意先 の関係は、多対多の関係になりますので、中間テーブルが必要になります。 T得意先マスタとT担当者マスタとは別に下記のテーブルを作成してください。 T担当履歴 --------- 得意先コード (外部キー) 担当者コード (外部キー) 開始日 終了日 これとは別に、 No.3の回答者さんも言われてますが、現行担当者 のフィールドを、T得意先マスタ に置いておくのは有効な方法だと思います。
さらっと見た感じMySQLの機能にはなさそうですね。 外部キー制約を相互にかけあうのはメンテナンス的にも問題ありそうなんで 参照キーのところだけ別テーブルにわけるなど運用でカバーした方がよいかも
元のDBに間違ったデータが投入されていないかぎり、エクスポートされたデータは 相応の整合性があるデータだと思われます。 データを確認するためのエディタで、文字コードを何パターンか指定して 開いてみて文字化けのないデータが得られるか確認してみてください。 エディタ上で問題がなくなったら、それをUTF8で保存しなおし、 適当なオプションをつけて新しいDBに読み込めばよいでしょう
SQLはこの手の処理は縦方向(?)に出力します select flag,sum(number) as sumNumber from test group by flag; しかし面倒ですが横方向に出せないこともありません select sum(number*(flag=4)) as sum4 ,sum(number*(flag=5)) as sum5 ,sum(number*(flag=6)) as sum6 ,sum(number*(flag=7)) as sum7 ,sum(number*(flag=8)) as sum8 ,sum(number*(flag=9)) as sum9 from test
複数列というのがちょっと面倒なところですが こんな感じでどうでしょう？ //元データ CREATE TABLE tbl (id int not null primary key,d1 int,d2 int,d3 int,d4 int,d5 int,index(d1,d2,d3,d4,d5)); INSERT INTO tbl VALUES(1,1,2,3,4,2),(2,5,4,3,2,1),(3,4,2,1,5,3),(4,2,4,5,1,1),(5,3,2,1,1,2),(6,1,1,1,5,1),(7,2,3,1,5,1); //集計 SELECT id ,d1,COALESCE((d1=m1),0) as f1 ,d2,COALESCE((d2=m2),0) as f2 ,d3,COALESCE((d3=m3),0) as f3 ,d4,COALESCE((d4=m4),0) as f4 ,d5,COALESCE((d5=m5),0) as f5 FROM tbl LEFT JOIN (SELECT MAX(d1) as m1,MAX(d2) as m2,MAX(d3) as m3,MAX(d4) as m4,MAX(d5) as m5 FROM tbl) as sub ON d1=m1 or d2=m2 or d3=m3 or d4=m4 or d5=m5 ORDER BY id
＞＞あまり最初から詰め込みすぎずに、徐々に条件を付けていった方がいいですよ ＞ということはもっと単純な条件式で大丈夫なのでしょうか？ え～と、そういうことではなく、たくさん条件を最初から書くと どの条件節でエラーになっているかわかりづらくなるということです。 今回の質問であれば「こだわり」の部分が問題だったのですから ほかの上限や下限料金、住所などはばっさりコメントアウトしてまえば エラーの切り分けができるので、どこを直せばいいか絞り込めます。 デバグをするときにはなるべく簡潔な処理まで切り詰めた方がいいということです。 （まぁ複合バグもあるのでケースバイケースですが・・・） ＞LEFT OUTER JOINを変更して ちなみに、こまかく見てないのでなんともいえませんが 今回の例だとLEFT JOINした場合はWHEREやHAVINGの処理をかませないと 絞り込みになっていないかもしれません ＞何もcheckboxや他の項目をチェックしなかったら、全てのホテルが表示されてしまします。 ＞本当はチェックしなかったら、表示されないようにしたいのですが。 通常の絞り込みのロジックはこう WHERE 1 AND 条件1 AND 条件2 ・・・ AND検索なのですべての条件に当てはまるものが絞り込まれます。 条件が何もない場合なにも表示しないなら フラグ管理して、条件句に条件を付加していくときにフラグを立てるようにし フラグが0の際には条件句の最後に「AND 0」を足せばいいでしょう。 $flag=0; $sql="SELECT * FROM tbl WHERE 1 "; if(条件1){ $sql.="AND hoge='hogehoge' "; flag=1; } if(条件2){ $sql.="AND fuga BETWEEN 'xxx' AND 'yyy' "; flag=1; } if(条件3){ $sql.="AND piyo LIKE 'zzz%' "; flag=1; } if($flag==0){ $sql.="AND 0 "; }
"CREATE TABLE hoge (yobi char(5))" "INSERT INTO hoge VALUES ('土'),('日'),('月'),('木'),('水'),('火'),('金')" "select yobi from hoge order by case yobi when '日' then 1 when '月' then 2 when '火' then 3 when '水' then 4 when '木' then 5 when '金' then 6 when '土' then 7 end" こんなところでしょうか
#3です PHPへの組み込みについては、今後学習していただくとして 一応SQLのサンプル //ホテルの基本情報 CREATE TABLE t_hotels(id int not null primary key,name varchar(100) not null,price_min int not null,price_max int not null,address varchar(100) not null); INSERT INTO t_hotels VALUES(1,'HOTEL A',5000,10000,'栃木県・・・'), (2,'HOTEL B',5000,12000,'栃木県・・・'), (3,'HOTEL C',6000,9000,'千葉県・・・'), (4,'HOTEL D',5000,10000,'千葉県・・・'), (5,'HOTEL E',4000,5000,'埼玉県・・・'), (6,'HOTEL F',15000,30000,'東京都・・・'), (7,'HOTEL G',12000,40000,'神奈川県・・・'); //こだわり情報 CREATE TABLE t_kodawari_key(id int not null primary key,name varchar(20)); INSERT INTO t_kodawari_key VALUES(1,'温泉'),(2,'ランチ'),(3,' ディナー'); //ホテルごとのこだわり CREATE TABLE t_hotel_kodawari(hid int not null,kid int not null,unique key(hid,kid)); INSERT INTO t_hotel_kodawari VALUES(1,1),(1,2),(1,3),(2,1),(3,2),(3,3),(4,3); //温泉かランチにこだわりがあるところ SELECT hid,t3.name,t3.price_min,t3.price_max,GROUP_CONCAT(t2.name) as kodawari,t3.address FROM t_hotel_kodawari as t1 INNER JOIN t_kodawari_key as t2 ON t1.kid=t2.id AND t1.kid IN (1,2) INNER JOIN t_hotels as t3 ON t3.id=t1.hid GROUP BY hid //温泉かランチかディナーのうち２つ以上にこだわりがあるところ SELECT hid,t3.name,t3.price_min,t3.price_max,GROUP_CONCAT(t2.name) as kodawari,t3.address FROM t_hotel_kodawari as t1 INNER JOIN t_kodawari_key as t2 ON t1.kid=t2.id AND t1.kid IN (1,2,3) INNER JOIN t_hotels as t3 ON t3.id=t1.hid GROUP BY hid HAVING count(*)>=2
コマンドは合ってます。 メッセージを見る限り環境変数が設定されていないようです http://docs.oracle.com/cd/E16338_01/server.112/b … を参考に必要な値を設定してください。 rootで実行出来ないのは単にemctlコマンドにパスが通ってないだけでしょう。 普通はoracleユーザでやるから気にしなくて良いです。
１・ 追記する場合。 前もって前回回答の Set RS = DB.OpenRecordset("実際のテーブル名に", dbOpenSnapshot) を Set RS = DB.OpenRecordset("select * from 実際のテーブル名に order by メーカー名", dbOpenSnapshot) のように並び替えを指示してやる必要があります。 http://support.microsoft.com/kb/834927/ja または「実際のテーブル名」を出力したクエリで並び替え指定を 行っているのならテーブル名の代わりにクエリ名を指定します。 で一回目の出力をします。 二回目は前回回答の一部を修正して Sub xlS2() Dim oXL As Object Dim oBK As Object Dim oSH As Object Dim DB As DAO.Database 'ここでエラーになったら参照設定の変更を Dim RS As DAO.Recordset Dim i As Long, j As Long Set DB = CurrentDb Set RS = DB.OpenRecordset("select * from 実際のテーブル名 order by メーカー名", dbOpenSnapshot) 'か前述のようにクエリ名 Set oXL = CreateObject("Excel.Application") 'oXL.Visible = True Set oBK = oXL.Workbooks.Open("e:\123.xlsx") 'ここ Set oSH = oBK.sheets(1) 'For i = 1 To RS.Fields.Count 'フィールド名転記 'oSH.cells(1, i) = RS.Fields(i - 1).Name 'Next j = 3 'レコード転記は３行目から ’ここ Do Until RS.EOF For i = 1 To RS.Fields.Count oSH.cells(j, i) = RS.Fields(i - 1).Value Next RS.MoveNext j = j + 5 '空き間隔調整 Loop oBK.Close True 'ここ oXL.Quit Set oBK = Nothing: Set oXL = Nothing RS.Close: Set RS = Nothing End Sub です。 まとめて一気にというのでしたら、 直積とユニオンクエリで空白行を作っても 出来そうですが、すみません割愛させてください。
残念ながら >持ち合わせていないので 検証できる環境がありません。 識者のご登場をお待ちください。
＞mysql4.0.25 かなり古いバージョンので、試す環境がないのですが MySQL5系でチェックすると CREATE TABLE `tbl`(`data` VARCHAR(20)) CHARACTER SET `ujis` COLLATE `ujis_japanese_ci` ; INSERT INTO `tbl` VALUES('あいうえお'),('あういおえ'),('おあういえ'),('えあいうお'),('かきくけこ'); と、しておいて SELECT * FROM `tbl` WHERE `data` LIKE BINARY 'あ%'; SELECT * FROM `tbl` WHERE `data` LIKE BINARY '%あ%'; SELECT * FROM `tbl` WHERE `data` LIKE BINARY 'あい%'; SELECT * FROM `tbl` WHERE `data` LIKE BINARY '%あい%'; をそれぞれ実行しても、想定どおりの戻りがあるので特に問題なさそうですね COLLATEについては`ujis_bin`でも問題ないです。 なにか入力みすか勘違いのような気がしますが・・・
＞ご指摘の通りに書き換えましたが、検索できませんでした。 一番高い可能性としては、POSTされたデータのキャラクターコードと DBに格納されたキャラクターコードが異なるということです この手のテストをする場合はキャラクターコードでの差異が出づらい 「英数字のみ」でまずテストをすることをお勧めします。 ここで動作確認ができたら次の段階として日本語検索を試してください プリペアドステートメントについてはphpマニュアルなどご一読ください http://www.php.net//manual/ja/pdo.prepared-state …
＞msであれば、まず遅い部類に入らない認識 運用方法によりますけど、1秒かからない処理なら普通に待てるんじゃないですかねぇ とはいえ、きちんとチェックしながら集計文を推敲すれば数倍～数十倍の 高速化ができるケースもあるので、常にチューニングに手を抜かない姿勢が必要ですね もちろん、運用上1分以上とか、10分以上処理に時間がかかるものもあります。 そういうものは予約型のUIを作るなど仕組みを考えないと、使用者が待ってくれません。 逆に定期的な締め処理的なものをいれると、その処理自体は1時間かかっても、 処理後の集計を高速にできたりするので、定型の集計が多い場合は検討すると よいかもしれません。 また、システム側からも継続的な過負荷がかかる処理を何本も走らせられないので 一定の処理待ちが発生した場合タイムアウト処理が必要になります。 たとえば、1時間返ってこない処理は、もしかしたらそのまま1日返ってこないかもしれない むしろ一生返ってこないかもしれないので、どこかで見切りをつける必要があるでしょう
phpMyAdminでサーバ接続の照合順序および、各テーブルの照合順序を確認し それに合わせたコード指定を、phpから接続するときに指定してやる PDO、mysqli関数のオブジェクト型、手続き型それぞれによって微妙に 指定が違うのでそれぞれの接続方法にあわせた指定が肝要 （接続後に「set names」を発行するのはNGといわれていますので注意）
作業列とか使えば出来ると思いますが。 > 0003　|　犬　猿　狐 「犬　猿　狐」は別のセルなんでしょうか？１つのセルに空白区切りで入力されてるんでしょうか？ 動物種は常に１文字？ １行に入ってる最大の項目数は決まってる？ なんかの条件で、やり方変わります。 -- シート名「Sheet1」のA1からセルごとに項目が入ってて、項目の最大数は９だとして、 Sheet2に、 A1:=OFFSET(Sheet1!$A$1,INT((ROW()-1)/10),0) B1:=MOD(ROW()-1,10) C1:=OFFSET(Sheet1!$A$1,INT((ROW()-1)/10),B1+1) と入力、A～C列を下向きにコピー 0001 | 0 | 犬 0001 | 1 | 猫 0001 | 2 | 0 ～ 0001 | 9 | 0 0002 | 0 | 猿 0002 | 1 | 狐 って具合に並ぶので、全体選択、コピー、値を貼り付け。 C列で並べ替えして「0」を削除。 A列B列で並べ替え。 B列を削除 で処理完了とか。
＞どうすればこれを修正することができるのでしょうか？ 具体的なSQL文がわからないのでなんとも言えませんが おそらくGROUP BYで日付でMAXをとったままの式で金額を抽出しているのでは？ MAXでとった日付をサブクエリとして利用しないと適正なあたいは得られませんね
Bがカラムとして存在しなければいけない理由は何でしょう？ selectするときにifでデータを作るとか、viewでBカラムに相当するデータを動的に生成するとかではダメなのでしょうか。
execute('select * from [test].[dbo]' + '.[test]') ならできます。 文2では、from以下が単なる文字列となってしまっているのです。 なので、全体を文字列とみなして、executeで処理することになります。 参考URL：http://msdn.microsoft.com/ja-jp/library/ms188332 …
>「SET XACT_ABORT ON」としているので「adoCN.BeginTrans」はなくてもいいと思うのですが Set adoCN = New ADODB.Connection adoCN.Open CurrentProject.Connection adoCN.BeginTrans adoCN.Execute "exec dbo.実行ストアド" insert into アクセスのテーブル values(1) 'エラー判定 adoCN.CommitTrans とかだと、 adoCN.BeginTransとadoCN.CommitTransはなくては困るはず。 （アクセスのテーブルへのinsertがストアドの結果に関係なく実行されるから。） ということで >明確に『不要である』としている文献等、見つからなかったため は見つからないと思います。 ストアドプロシジャ内のどの命令でエラーがでているのかが不明なので （⇒これを特定するのが先のように思いますが） はっきりしたことはわかりませんが、 >このストアド内では「SET XACT_ABORT ON ～ SET XACT_ABORT OFF」としてあります のほうが問題なのでは？ ## SET XACT_ABORT ONなんて気持ち悪くて使う気にならないので使ったことはないので ## 良く分かりませんが クライアントのadoのトランザクションの中で、突然、sqlserverにトランザクション制御を 任せるような命令を出したらなにかおかしくなるようにしか思えないです。 SET XACT_ABORT ON ～ SET XACT_ABORT OFF を Begin Transaction ～ Commit にしてエラー制御をきちんと書いて、エラーならロールバックするようにしてみたら？ と思います。 （SQL Serverはトランザクションの入れ子がOKだったはずなのでbegin transactionを 　書いても大丈夫だったと思いますが、ダメならストアド側でトランザクション制御はしないとか。） ## 的外れだったらごめんなさいね。
他の方が仰るように、ソースを見ながら修正ではコストが膨大になると思います。 それよりは、どのような機能が欲しいのか整理して1から依頼した方が早そうです。 なおこのようなカスタムメイド型のツールもあるようです。 http://www.eye-brain.jp/rakuchin.html
こういうことでしょうか。 insert into 売上データ ( 注文番号, 売上番号, 連番, 商品名 ) select 注文番号 , 売上番号 , ROW_NUMBER() over(partition by 注文番号 order by 売上番号, 連番) + (select COUNT(*) from 売上データ T2 where T1.注文番号 = T2.注文番号) 連番 , 商品名 from 納品データ t1; ROW_NUMBER()で納品データ内での連番を振って、その連番に既存データの件数を足しています。 MAX(連番)だと、同一注文番号が既存データに存在しない時にNULLになってしまうので、COUNTで件数を取るようにしています。
一人でローカルでしか使っていないなら排他モードで開く意味はないでしょうね。 ちょっと本題のアクセスとはずれますが、 例えば、AccessのプログラムがExcelのBookを作れるとして、 そのExcelを単独で編集もする。 ExcelのBookを開いて編集しているのを忘れて、 Accessのプログラムで同じExcelのBookを作ってしまうと、 編集していたのが無効になってしまいます。 あるいは、その後で、開いて編集していたExcelのBookを保存すると、 Accessのプログラムで作ったはずの情報が消えています。 とこういったことを防ぐために排他というモードがあります。 この例のExcelのBookをAccessのテーブルと置き換えてもらうとイメージがつかめるのかな？ ということで、同時に複数の人（またはプログラム）が処理をしようとしない環境では、 排他モードを使う必要性はありません。
ご使用のヤマト送り状は単票なんですか。 だとしたら、詳細セクションの「改ページ」プロパティを「カレントセクションの後」に設定して、 さらに、プリンターの設定で、ユーザー定義用紙 でご使用の用紙のサイズを設定して、 その用紙を指定して印刷してください。
エラーのとおりです。Oracleに接続するには、DBD-oracleが必要です。 http://search.cpan.org/~pythian/DBD-Oracle-1.74/ … perl-DBD-Pg-1.31-6 <<PostgreSQL用ドライバ perl-DBD-MySQL-2.9004-3.1 <<MySQL用ドライバ perl-DBI-1.40-8 <<1DB毎の差分を吸収するためのインターフェース Oracle用のドライバはインストールされていないようです。
ごめんなさい、うまく読み取れないのですが SELECTで表示する分には切れずに表示され、CSVにすると途中で切れるということですか？ またセパレータを改行以外の文字でやっても結果はおなじでしょうか？
亀レスですが参考になれば。 サイトというのが，SharePointのドキュメントライブラリーを指しているのであれば，通常は各々のライブラリーでアップロードすると思いますが，実はドキュメントライブラリーはExplorerでも開けますので，フォルダーにファイルをコピーする様にライブラリーにファイルをコピーすることができます。 操作メニューから，Explorerで開くを実行するだけで簡単に開きます。 コピー元のファイル名やコピー先のパスなど，いつも同じ状況であれば，スクリプトを作っておけば何度でも同じ事が実行できます。コピー元のファイル名が違うだけならば，ファイル名などを指定してコピーする様に作れば良いと思います。 コツは，フォルダーのパスと同じく，ライブラリーを開いたパスを使って，スクリプトを記述することでしょうか。 単発であれば，最初のファイルをコピーしておき，Explorerで開いたフォルダーに次々とペーストしていけば良いと思います。
こんにちわ。 > この手順と影響範囲が知りたいです。 http://docs.oracle.com/cd/E16338_01/server.112/b … 上記のマニュアルから判断すると、手順については認識の通りです。 影響範囲については、「Alter Session」 なのでAlter Session 文を実行したセッション でのみ有効で既存テーブルには影響しません。 > 既存テーブルもCharベースに変更するにはどのような手順を踏めばよいのでしょうか？ Alter Session したセッションからテーブルを再作成しないといけないので、 単純に思いつく方法としては、こんな感じでしょうか？ 1) exp 又は expdp でデータを外部に出力 2) Alter Session したセッションからテーブルをDrop＆Create 3) imp 又は impdp でデータ投入 4) 索引再作成 参考URL：http://docs.oracle.com/cd/E16338_01/server.112/b …
標準のSQLには配列に対する配慮がほとんどなく、テーブル構造には配列のような繰り返しは持たない方法が一般的です。繰り返しの代わりに必要な分の行を登録します。なので「ID」と「名前」のテーブルを１人に１行と「ID」「フォロアー」のテーブルで繰り返しの分だけ行を登録します。
>Webアプリをフレームワークで作成する場合、 >どの言語で、どのフレームワークを使用するのが一番お勧めでしょうか。 ぶっちゃけ、得意な言語でいいと思いますよ。 何を作るか知りませんがDBもpostgreSQL位の方が扱いやすいと思いますけど
今回の例ですと 「FROMにテーブルを列記する」のと「LEFT JOIN」で結合するのは、 あきらかにやっていることが違います。 なので処理速度の優劣を考える意味がありません。 もしやるならINNER JOINですね 実際abcdテーブルとhogeテーブルに適切なインデックスが設定されていれば FROMだけで処理してもJOINしても負荷は変わらないはずです。 基本的にはEXPLAIN文でSQL文の効率化を検証することができます。 http://dev.mysql.com/doc/refman/5.1/ja/explain.h … 個人的にはFROMでテーブルの列記よりJOINする方が 依存関係が分かりやすく、またJOIN語のSQL文に対してWHEREで絞り込みを したりできて便利なので使用頻度は多いです。
他の方の回答のように年月マスターを作成しておいて外部結合するというのがいいでしょうね。 例 年月マスター　テーブル 年月　　　　　　フィールド 201401 201402 201403 201404 それを作らずにするなら、入金、出金の２つのテーブルをユニオンクエリで結合してからそれを集計クエリにすればいいでしょう。 例 Q_入出金 SELECT Format(日付,"yyyymm") AS 年月, 科目コード, 入金額, 0 As 出金額 FROM 入金 UNION ALL SELECT Format(日付,"yyyymm") AS 年月, 科目コード, 0 As 入金額, 出金額 FROM 出金; このクエリを基に集計クエリを作成。 SELECT 年月, 科目コード, Sum(入金額) As 入金計 , Sum(出金額) As 出金計 FROM Q_入出金 GROUP BY 年月, 科目コード;
復元時にデータファイルとログファイルの格納先を指定して変更する必要があります。
こんにちわ。 > 上記のPDB1 = のところから追記しています。これで合っていますでしょうか？ VMware 上のLinux 環境に、Oracle12c をセットアップした環境があるので 確認してみました。 特にtnsnames.ora の設定は問題無いようです。 接続文字列を指定してSQL*Plus を実行した時のエラーも、ORA-1017 でしょうか？ であれば、PDB に作成したユーザのパスワードが違っている事が考えられます。 Oracle11g 以降では、sec_case_sensitive_logon がDefault でTrue となっています。 このパラメータがTrue に設定されていると、パスワードの大文字/小文字を厳密に区別します。 ユーザのパスワードを再設定して確認してみてはどうでしょうか？
結果に >4| え | あ | １ | － | え | とありますが、ここって 4| え | あ | １ | － | あ | になりますよね？ なにも考えずに書いたので、もっときれいな書き方があると思いますが、 SELECT 　　Ａ 　, Ｂ 　, Ｃ 　, CASE 　　　　WHEN Ａ = 'あ' THEN Ｂ 　　　　ELSE '－' 　　END Ｄ 　, CASE 　　　　WHEN Ａ <> 'あ' THEN Ｂ 　　　　ELSE NVL( 　　　　　　( 　　　　　　　　SELECT 　　　　　　　　　　Ｂ 　　　　　　　　FROM 　　　　　　　　　　T T3 　　　　　　　　WHERE 　　　　　　　　　　T3.Ａ <> T1.Ａ 　　　　　　　　AND T3.Ｂ <> T1.Ｂ 　　　　　　　　AND T3.Ａ　= T1.Ｂ 　　　　　　　　AND T3.Ｂ　= T1.Ａ 　　　　　　　　AND T3.Ｃ　= T1.Ｃ 　　　　　　) 　　　　　　, '－') 　　END E FROM 　　T T1 WHERE 　　NOT EXISTS ( 　　　　SELECT 　　　　　　* 　　　　FROM 　　　　　　T T3 　　　　WHERE 　　　　　　T1.Ａ <> 'あ' 　　　　AND T3.Ａ　= T1.Ｂ 　　　　AND T3.Ｂ　= T1.Ａ 　　) ORDER BY 　　Ｃ 　, Ａ 　, Ｂ; とりあえず、書いてあることだけは満たす結果になると思います。
No.3です。補足です。 JSONはほとんどのプログラミング言語で使えます。Cにもライブラリがあり使えるようですが、RubyやPythonなどの動的変数を使えるプログラミング言語の方が有り難みが実感できます。 YAMLはJSONよりも遅いがデータ構造の自由度が高いように思います。 これら２つはテキストで保存されますが、バイナリで保存するタイプのシリアライズもあります。 ＞・高速に入出力が出来る方が良い 検索対象にしなければ十分な速度があると思います。 ＞・複数アプリケーションからアクセス出来る方が良い データベース側の問題ですが、以前はSQLite3を使っていました。読み込みだけでは同時でも全然問題は無いのですが、同時に書き込みができないとの書き込み速度が遅いです。複数から同時に書き込みたいのならPostgreSqlやMySQLなどがお勧めです。 別の方法として、データベースにはデータファイル名だけを登録しそれを利用する方法もありますが、データがそんなに大きくないようですの、シリアライズしてしまう方が管理が楽だと思います。
OracleからCSVファイルへ出力すれば、件数の制限はないです。 CSVファイルをAccessへ投入するのはExcelより便利ですよ。 Accessで SUMとGroup byでSQLで簡単に集計できます。 簡単な例： SELECT ProductID, Avg(UnitPrice), Sum(Quantity) FROM "Order Details" GROUP BY ProductID
テーブルの構成と正規化の状況がわからないので微妙ですが こんな感じでは？ SELECT tokuisaki_id ,sum(nyukin*(nyukin_kubun='現金')) AS 現金計 ,sum(nyukin*(nyukin_kubun='振込')) AS 振込計 ,sum(nyukin*(nyukin_kubun='相殺')) AS 相殺計 ,sum(nyukin*(nyukin_kubun='手数料')) AS 手数料計 ,sum(nyukin) AS 合計 FROM nyukin_meisai WHERE AND uriage_bi BETWEEN '2014/05/01' AND '2014/05/31' GROUP BY tokuisaki_id
設定はOracle Enterprise Manager Database Controlから行いましたか？ 設定ファイルを直接修正しても反映されません。
こんにちは。 イノ(inno)です。 方法はいろいろありますけど、 上記の条件のにあうSQLを作ってみました。 下記のSQLをそのまま実行してみてください。 先ずは、テーブルを作成してください。 --################################# --#### テーブル作成 --################################# --#### ユーザーテーブル CREATE TABLE dbo.TempUser ( Sn int , UserName nvarchar(100) , IsCheck bit ) --#### 当番履歴テーブル CREATE TABLE dbo.TempUserLog ( Sn int , UserName nvarchar(100) , RegDate Datetime ) ここまでがテーブル作成です。 それでは31人のユーザーデータを登録しましょう。 --################################# --#### データ登録 --################################# DECLARE @i int SET @i = 1 WHILE(@i <= 31) BEGIN INSERT INTO dbo.TempUser (Sn, UserName, IsCheck) VALUES (@i, CONVERT(varchar(10), @i) + 'さん', 0) SET @i = @i + 1 END ここまでがユーザー登録です。 では、下記のSQLを実行すると当番を計算して結果がでるようになっています。 履歴も残しています。 --################################# --#### 当番計算 --#### １度にランダムに５人ずつ当番になる。 --#### １度当番になると、全員の当番が一巡するまで回ってこない。 --################################# DECLARE @TempSelectUser TABLE ( Sn int ,UserName nvarchar(100) ) DECLARE @Sn int DECLARE @UserName nvarchar(100) DECLARE DB_Cursor CURSOR FOR SELECT TOP 5 Sn, UserName FROM ( SELECT TOP 5 1 Code, Sn, UserName FROM dbo.TempUser WHERE IsCheck = 0 ORDER BY NEWID() UNION ALL SELECT TOP 5 2 Code, Sn, UserName FROM dbo.TempUser ORDER BY NEWID() ) A ORDER BY Code OPEN DB_Cursor FETCH NEXT FROM DB_Cursor INTO @Sn, @UserName WHILE @@FETCH_STATUS = 0 BEGIN INSERT INTO @TempSelectUser SELECT @Sn, @UserName IF 0 = (SELECT COUNT(Sn) FROM dbo.TempUser WHERE IsCheck = 0) BEGIN UPDATE dbo.TempUser SET IsCheck = 0 END UPDATE dbo.TempUser SET IsCheck = 1 WHERE Sn = @Sn INSERT INTO dbo.TempUserLog SELECT @Sn, @UserName, GETDATE() FETCH NEXT FROM DB_Cursor INTO @Sn, @UserName END CLOSE DB_Cursor DEALLOCATE DB_Cursor --################################# --#### 当番結果 --################################# SELECT * FROM @TempSelectUser ここまで実行してみてください。 上記のSQLを実行するたびに当番を計算して結果を表示します。 履歴を見るには下記のSQLを実行してご確認ください。 SELECT * FROM dbo.TempUserLog ORDER BY RegDate DESC どうですか。 正常に実行されましたか。
INSERT INTO テーブル1(依頼No, 依頼日) SELECT MAX(依頼No)+100, '2013/05/13' FROM テーブル1
見直したら一部非効率なところがあったのでちょっと改善するとともに ちょっとだけ解説します //元データ insert into tbl values('ほげ','2014-5-1'),('ほげ','2014-5-2'),('ほげ','2014-5-3'),('ほげ','2014-5-4'),('ふーばー','2014-5-2'),('ふーばー','2014-5-3'),('あああ','2014-5-1'),('あああ','2014-5-3'),('あああ','2014-5-4'),('いいい','2014-5-1'),('ううう','2014-5-10'),('ううう','2014-5-11'),('ううう','2014-5-13'),('ううう','2014-5-14'); ※インデックスを貼ってあります //第一段階 select t1.username ,t1.login_date as d1 ,t2.login_date as d2 ,datediff(t2.login_date,t1.login_date)+1 as diff from tbl as t1 left join tbl as t2 on t1.username=t2.username and t1.login_date <= t2.login_date inner join tbl as t3 on t3.login_date between t1.login_date and t2.login_date and t1.username=t3.username group by username,d1,d2 having count(*)=diff これでusername,login_dateごとに、何日連続しているか得られます。 たとえば「あああ」さんは あああ,2014-05-01,2014-05-01,1 あああ,2014-05-03,2014-05-03,1 あああ,2014-05-03,2014-05-04,2 あああ,2014-05-04,2014-05-04,1 となり、5/1から5/1まで1連続、5/3から5/3まで1連続、5/3から5/4まで2連続、5/4から5/4まで1連続であることがわかります。 考え方次第ですが厳密にいえば1連続データは連続ではないので抽出しないでもいいですが、 これをしておかないと1回しかログインしていない人や、毎日ログインしない人がヒットしません。 すこし無駄なような気がしますが1連続はとっておいて損はないでしょう 今回ほしいのはusernameごとの最大連続日数なので //第二段階 select username,max(diff) as renzoku from ( select t1.username ,t1.login_date as d1 ,t2.login_date as d2 ,datediff(t2.login_date,t1.login_date)+1 as diff from tbl as t1 left join tbl as t2 on t1.username=t2.username and t1.login_date <= t2.login_date inner join tbl as t3 on t3.login_date between t1.login_date and t2.login_date and t1.username=t3.username group by username,d1,d2 having count(*)=diff ) as t4 group by username とすると、結果 username,renzoku あああ,2 いいい,1 ううう,2 ふーばー,2 ほげ,4 となります。元データをみてもらうとわかりますが 「ううう」さんは2連続ログインが2回ありますが、「最大」は2連続となるので 上記データがただしいとわかると思います。 #1さんの抽出だと2連続が2回は4連続だとカウントされてしまいます 最終的に、連続日数ごとの件数が知りたいので //第三段階 select renzoku,count(*) as count from ( select username,max(diff) as renzoku from ( select t1.username ,t1.login_date as d1 ,t2.login_date as d2 ,datediff(t2.login_date,t1.login_date)+1 as diff from tbl as t1 left join tbl as t2 on t1.username=t2.username and t1.login_date <= t2.login_date inner join tbl as t3 on t3.login_date between t1.login_date and t2.login_date and t1.username=t3.username group by username,d1,d2 having count(*)=diff ) as t4 group by username ) as t5 group by renzoku で、命題の解を得ることができます なお、処理的には第一段階ではインデックスがきいていますが 第二、第三段階は結果にたいする集計のためインデックスが利用されません。 ただ、第一段階でほぼデータ抽出が完了しているため、 さほど負荷が問題になることはないと思います
(1)索引を用いるとI/O処理が少なくなりアクセスが高速になるということはわかったのですが、そのI/O処理とはプロセスとメモリ間のやりとりに関するI/O処理という認識で間違いないのでしょうか？ プロセスとディスク（またはキャッシュされたメモリ）との間のI/O処理 というほうがあっていると思うのですが。 ・・・「プロセスとメモリ間」というと正しくないようにしか聞こえませんが、 　　　たまたま、すべてメモリにキャッシュされていると、ディスクアクセスがなかったりするので 　　　完全な間違いとは言い切れないけど、大抵の場合は間違い、って思います。 (2)索引付きと索引なしのカラムを抽出条件にして検索した場合、まず索引付きのカラムから検索を行い、そのROWIDを元に索引なしのカラムのデータを取得して対象データかどうかの判断を行うのでしょうか？ >まず索引付きのカラムから検索を行い、そのROWIDを元に索引なしのカラムのデータを取得して のパターンは、RangeScanというタイプになり、Oracleがそれが早いと判断したら、そういう処理が 動きます。 「そのROWIDを元に索引なしのカラムのデータを取得して対象データかどうかの判断」をするのか 「索引付きのカラムから対象を抽出して、抽出したデータ（select句内の項目と where句内の項目などなのか詳細不明）から索引なしのカラムのデータが一致する 　物のみに絞り込んでいる」のかは不明。（Oracle内部の処理仕様の話なので。。。）
No.1です。 いえいえ、単に結果だけほしいならば、 update baken set bekijyo=POW( 2, umaban ); です。
ああ、なんとなく言いたいことはわかりました。 ログイン時に自動でスクリプトを走らせて、ログアウトしない状態 にしたいってことですね？（たぶん） mysqldセクションのinit-connectで解決するかもしれません。 http://dev.mysql.com/doc/refman/5.1/ja/server-sy …
>間違っているかもしれませんが、ＢＣＰを使う場合。 >販売管理ＳＶ側で、ｂｃｐコマンドでバックアップファイルを作成・出力。 >ＡＤＳＶ側で、出力されたバックアップファイルを読込と言う事で宜しいでしょうか？ はい。あっています。 とはいえ、 > >お教え頂いたURLを拝見しましたが、イマイチ理解出来なかったため、最低限必要な書き方をお教え頂け>たら幸いです。 という感じでしたら、リンクサーバを使うほうがいいのかなあという気がしてきました。 http://sql55.com/query/linked-server.php ここで、SQL SERVER認証のほうをつかう。 これが難しいようなら、 下のサイトの「SQL Server Management Studio の使用」のところを見てもらう。 http://msdn.microsoft.com/ja-jp/library/ff772782 … ちょっとわかりにくいかも。 ならば、下のサイトの手順でやってみる。 http://d.hatena.ne.jp/haradago/20110125/p1 ぐらいかな。 ・・・これで引っかかるようなら、どこがわからないか、あるいは、何を入力したか 　　　返信いれてください。
私には、ここが解りやすかったです。 http://rfs.jp/sb/sql/s01/05-13.html 私としては、第２と第３の方が区別が付きにくい気がします。部分と推移の意味がつかみにくい。 SQL文操作に慣れてくると、分離した状態から考え始めるので、第３正規形となったtableの全てをjoin して第１正規化前へ戻すSQL文構築から逆算するとすこし理解が進むかも？ まず、第３正規化で分離した table は、 join `th3rd` on `main`.nonprimary = `th3rd`.primary となって本星の`main`テーブルと非プライマリーキーのフィールドで結びつきます 次に、第２正規化で分離した table は、 join `th2nd` on `main`.primaryX = `th2nd`.primary となって `main`テーブルとプライマリーキーのうちの１フィールドで結びつきます つまり、複合プライマリーキーがあるテーブルでないと、第２正規形が理解しにくいのだと思います。 最後に、第１正規化で分離したtable は、こちらのtableの方が全体を連結して、これまでの`main` テーブル側が、FOREIGN KEY の関係になります。 `the1st` join `main` on `the1st`.mainid = `main`.id join `the1stCategory` on `the1st`.Categoryid = `the1stCategory`.id
１．select文の カラムリストに () 付けで、複数行データ定義などと言うことはできません。 union all を使ってください。 ２．まずは、select 文だけ書いてみてエラーのない select 文になれば、insert につないで実行可能です。 No1回答への補足をみると １対１対応させるのは、できてるのですね。 ３． umeta_idカラムが auto_increment だからnull を入れているなら、カラムリストから外しても良いと思います insert into ***_usermeta (user_id,meta_key,meta_value) select tableBid,'***_user_level','0' from dbB.tableB where tableBname <> 'Admin' union all select tableBid,'nickname',tableBname from dbB.tableB where tableBname <> 'Admin' ４． dbB.tableB の一行に対して、５行（以上）作って順番指定したいのですね。 ５行用のデータを union all で繋いで作ったtableを join しましょう。 select b.tableBid as user_id, k.meta_k as meta_key, COALESCE( k.meta_v , b.tableBname ) as meta_value from ( select tableBid, tableBname from dbB.tableB where tableBname <> 'Admin' ) as b cross join ( select 'first_name' as meta_k, '' as meta_v , 1 as order_no union all select 'last_name', '' , 2 union all select 'nickname', null, 3 union all select '***_capabilities','a:1:{s:10:\"subscriber\";b:1;}' , 4 union all select '***_user_level','0' , 5 ) as k order by b.tableBid, k.order_no ; 上記のtable記述順でcross join するなら、order by は無くても、希望の順番にはなりそうですけど、一応いれておきました。 このselect文で、insert したい行が生成できているならば、あとは先頭にinsert 用の構文(3で提示の１行目)を繋げばよいでしょう。
「ファイル」「共有設定」「FileMaker Server にアップロード...」選択「ホスト」一覧に表示するホストのタイプを選択・・・以下参考URL ＞現在クライアント(Fm13)の方で共有ファイルが見えません 「クライアントとしての共有ファイルの開き方」 http://www.filemaker.com/13help/ja/html/sharing_ … 参考URL：http://www.filemaker.com/13help/ja/html/sharing_ …
>危険はあるのでしょうか ここでいう危険というのはインジェクションのリスクという意味ですよね？ プリペアド処理でリスクヘッジをしているのですから、その点に関しては たぶん大丈夫ですが、きちんと管理しないと割り当てる箇所がずれたりしそうですね
＞PHPadmin これはphpMyAdminのことですか？それとも別の仕組みでしょうか？ （仮にphpMyAdminだとして以下） ＞システム上から確認したときは文字化けが起こっていない ＞PHPadminの画面から確認すると、メールマガジンのデータのみ ＞日本語が文字化けしておりました。 コンソールで表示すると文字化けしないという意味ですか？ phpMyAdminで文字化けしているのであれば、一度データを消して 適切な照合順序を設定の上、再取り込みしてみるとかですかねぇ・・
＞PHPの板に書けば回答くれますか？ ページングの部分に絞って質問をしてもらえれば回答できるかもしれません ページングで必要なのは ・現在のページ番号 ・検索結果のアイテム数 ・１ページに表示するアイテム数 ・現在ページが最初のページかどうか ・現在ページが最後のページかどうか あたりです。 このあたりの情報をまとめればさほど難しくない処理でしょう
＞name欄にヒットしない文字があるときは該当者なし iのついていないmysql関数はすでに利用禁止にちかい状態なので 利用するならもう誰もフォローしてくれない前提で すべて自己解決するしかありません。 ですのでmysql関数の利用を前提の質問は公の掲示板ではしないでください PDOでやるならこんな感じ? <?PHP $dsn = 'mysql:host=localhost; dbname=test'; $pdo = new PDO($dsn,$user,$password); $name=isset($_GET['name'])?$_GET['name']:""; $sql ="select * from tbl where "; $sql.="`氏名` like concat('%',?,'%') "; $sql.="or `住所` like concat('%',?,'%') "; $stmt = $pdo->prepare( $sql); $stmt->execute(array($name,$name)); $count = $stmt->rowCount(); if($count>0){ print "<table border=1>" ; print "<tr>"; print "<th>番号</th>"; print "<th>氏名</th>"; print "<th>住所</th>"; print "</tr>"; while($row = $stmt->fetch(PDO::FETCH_ASSOC)){ print "<tr>"; print htmlspecialchars($row["番号"]); print htmlspecialchars($row["氏名"]); print htmlspecialchars($row["住所"]); print "</tr>"; }; print "</table>" ; }else{ print "no hit!"; } ?>
まず、mysqlの全文検索って標準で日本語通らなかったような気がしますが mroongaなど適当なソフトと組み合わせていますか？ それにしてもramがヒットしないのは微妙ですが 全文検索はヒット率が50%を超えると逆にヒットしないなど いろいろルールがあるみたいなのでマニュアルで確認してみてください
すでに、同名のエクセルファイルがある場合にこのようなエラーが出るようです。 同名のファイルを事前に削除しておくか、ダブらないファイル名を付ける必要があります。 私の場合は、FileName & Format(Now,"yyyymmddhhnnss")で、ファイル名に作成日時を付してダブらないようにしています。
2008でなければいけない理由は? 最新の2014やその前の2012ではだめなのでしょうか?
初心者なら、プログラムを書く前に、「設計図」をきちんと作ってはどうでしょうか? そして、全部一度にやろうとしないで、一つ一つ部品を分けてやっていきませんか? まずは ～?page=2 でアクセスしたら 現在 2 頁 <前 次> と表示され、「前」には ～?page=1 「次」には～?page=3 にリンクが張られている、というプログラムを作ってみましょう。 当然、 page=3でアクセスすれば 「前」には ～?page=2 「次」には～?page=4 となるように、です。 あなたが作ろうとしているのは、このプログラムから 「現在 2 頁」と表示する部分を変えただけのものです。 このプログラムができないようでは、あなたが作ろうとしているものなどできません。
＞メール情報をさらにテーブルにして細分化したりしない方向で、そのまま取得できないか はっきりいえば、SQLでやる作業ではない しかしできる・できないという意味ではできるのでできるので一応書いておきます。 しかし、こんなことやってたらRDB上達しないですよ （インデックスは絶対効かないし効率最悪で、データが増えるとすぐいきづまる・・・） //例 select * from TABLE1 where ( TO_USER_NM ,substr(MAIL_TITLE,@pos:=instr(MAIL_TITLE,'『')+1,instr(MAIL_TITLE,'』')-@pos) ,SEND_TIME ) in ( select TO_USER_NM as 顧客 ,substr(MAIL_TITLE,@pos:=instr(MAIL_TITLE,'『')+1,instr(MAIL_TITLE,'』')-@pos) as 商品 ,max(SEND_TIME) from TABLE1 where substr(MAIL_TITLE,instr(MAIL_TITLE,'』')+1,3)='本申込' group by 顧客,商品 ) order by SEND_TIME desc ※ポイント substr(MAIL_TITLE,@pos:=instr(MAIL_TITLE,'『')+1,instr(MAIL_TITLE,'』')-@pos) というのが商品名です
で、print $sqlしてみて文法エラーを確認してほしいんですが $sql .= " limit " . $page * 10 . ", 10" ; と、limitの文字の前後に空白をいれるところから始めてみてください 決して差別をするわけではないですが、念のため教えてほしいのですが 「文字通りの意味しか理解できないコミュニケーション障害」的な ハンデをお持ちの方ではないですよね？ それによって教える表現がだいぶかわってくるので・・・
構造うんぬんではなく、文法エラーのようですね。 echo "<a href = find.php?name=",$name, ", $page_num -1.">" ; の部分、 echo "<a href = find.php?name=". $name . ", $page_num -1.">" ; ではないですか？ " " と　" " など、文字列と文字列を連結するのは　, ではなく　. ですよね。 次の10件の部分も同様かと思います。
ODAC112012.zip(Oracle Data Provider for .NET 4 11.2.0.1.2)以降でしょうね。 32bitでコンパイルするのですから、当然必要なのは32bitです。 クライアントの64bitOSには、InstantClientにしろなんにしろ、32bitのクライアントが 設置されていないと接続不可です。 アプリケーションを32bit版しか用意しないのならば、それに関係するものは全て32bitで なければ64bitOSでは動きません。
「カンマや空白で区切られたキーワードの羅列から単語検索」ではなくて、「通常の分かち書きされてない日本語文章から、自由単語検索」なのですよね？ 英文のように分かち書きされていれば、前後に空白を入れた文字列で like 検索すれば、部分文字列のみのところと、長い文字列のところとは、個別マッチが可能 カラム値　例 ' きー ワード キーワード ' -- カラム値の前後にも区切り文字の空白を入れておくことで、先頭や最後もマッチさせ得る、検索時に、カラム値にも concat で前後に連結してもよいが時間的に無駄が多い。 条件式　例 where `カラム` like '% ワード %' and `カラム` like '% キーワード %' 分かち書きのない状態で、部分単語のみを見つけるには、perlくらいの強力な正規表現検索ができれば、可能かもしれないが、SQLiteは、正規表現検索させるには、ユーザー関数で組み込む必要がある、MySQLの正規表現検索やブール全文検索も、言明(xが前方にないaにマッチ)検索は実装されてないので、No2の方の回答のように、順番変えた組を作ってlike 検索くらいしかなさそう。OracleやpostgreSQL,Accessについてはよく知らない。
こんな感じですかね？ //データ作成 create table tbl(id int,name varchar(10),dt datetime); insert into tbl values(1,'a','2014-04-01 08:00:00'),(1,'b','2014-04-02 08:00:00'),(1,'c','2014-04-03 08:00:00'),(1,'d','2014-05-01 08:00:00'),(2,'e','2014-04-04 08:00:00'),(2,'f','2014-05-02 08:00:00'); →idが1のデータは4つ、内3つのデータが2014年4月の日付 //集計・・・今日が2014年4月である前提でnow()を利用 select count(*) as c1 ,sum(dt between (@d:=date_format(now(),'%Y-%m-01 00:00:00')) and (@d+interval 1 month -interval 1 second)) as c2 from tbl where id=1; ※条件式をsumで集計すると件数がとれます (@d:=date_format(now(),'%Y-%m-01 00:00:00')) というのが、今月1日の、0時0分0秒で '2014-04-01 00:00:00' (@d+interval 1 month -interval 1 second)) というのが、今月1日の1ヶ月後の1秒前で'2014-04-30 23:59:59'
枝番管理も難点は桁がふえたときの問題です 仮に11-30とか出てきたときに文字列でのみ判断すると 11-30には1-3が含まれていますので1-3を抽出しようとして11-30まで ヒットしてしまうことになりかねません ざっと、枝番を別カラムに分けた例をあげておきます。 //テーブル作成 create table tbl (id int not null primary key,顧客 varchar(10),商品a int,商品b int,購入日時 datetime); insert into tbl values (1,'A','2','2','2014-04-23 08:00:00') ,(2,'A','2','1','2014-04-21 08:00:00') ,(3,'B','2','3','2014-04-20 09:00:00') ,(4,'B','2','2','2014-04-18 06:00:00') ,(5,'B','2','1','2014-04-15 05:00:00') ,(6,'A','1','3','2014-04-12 08:00:00') ,(7,'A','1','2','2014-04-10 04:00:00') ,(8,'C','2','2','2014-04-09 05:00:00') ,(9,'C','2','1','2014-04-08 06:00:00') ,(10,'C','1','2','2014-04-07 08:00:00') ,(11,'C','1','1','2014-04-06 05:00:00') ,(12,'A','1','1','2014-04-05 02:00:00') ,(13,'B','1','2','2014-04-04 02:00:00') ,(14,'B','1','1','2014-04-03 01:00:00'); ※実際の運用時にはインデックスなど適宜設定する //集計 select id,顧客,商品a,商品b,購入日時 from tbl where (顧客,商品a,購入日時) in (select 顧客,商品a,max(購入日時) from tblgroup by 顧客,商品a) order by 購入日時 desc; ＞商品に"3"という文字を含むもののみ取得 select id,顧客,商品a,商品b,購入日時 from tbl where (顧客,商品a,購入日時) in (select 顧客,商品a,max(購入日時) from tbl group by 顧客,商品a) and (商品a=3 or 商品b=3) order by 購入日時 desc ※3を含むというのが「13」や「30」まで含むかどうかで いろいろやりかたに工夫が必要になります
すくなくとも「echo $err」の位置は変 if(empty($err)){ ・・・・ } の外側もしくは、elseなどで処理しないと 「もし空なら」のブロックの中で表示しようとしても 空かヒットしないかのどっちらかでしょ それと、しつこいようですがINSERTは「IGNORE」で行わないと エラーになるので思った処理にならないかもしれませんよ
PRIMARY KEY (id) FOREIGN KEY (from_id) の間にカンマが必要では？
まずは、マニュアルをよみましょう。 http://technet.microsoft.com/ja-jp/library/bb510 … http://technet.microsoft.com/ja-jp/library/ms187 …
コンピュータが「ここおかしいんじゃね？」ってご丁寧に行番号までつけてエラーメッセージを出してくれてるわけです。 英語がわからないならGoogle翻訳に頼っても構いません。 エラーの内容を理解する努力をしましょう。 それをするつもりがないならプログラミングは諦めてください。 <html> <body> <?php $pdo = new PDO("mysql:dbname=db_test;host=localhost", "root", "admin"); if($st->rowCount()>0){ //←PC「$stが何なのかわからないからrowCount()もわからない」 if ($_POST['ID'] != '' && $_POST['NAME'] != '' && $_POST['ADDR'] != ''){ (以下略) ちなみに、「重複チェック→未入力チェック→登録」という流れで書いていますが、 「未入力チェック→重複チェック→登録」の順にした方がいいかと思います。
条件が何も書いていないので妄想になりますが、 create table tbl_c select a.code2, a.name, min(b.point) as point from tbl_a a left join tbl_b b on(a.code1 = b.code1) group by code2, name; こういうことでしょうか？
＞COOK_KIOKU_TBLのCOOK_NAMEとCOOK_TBLのCOOK_NAMEと一致するレコードは頭の方 というのであればCOOK_KIOKU_TBLに順位を確定させるためのソートキーが必要 それぞれidをふるとするとこんな感じかな？ create table COOK_TBL(cid int not null primary key auto_increment,COOK_NAME varchar(10)); insert into COOK_TBL(COOK_NAME) values('パスタ'),('パスタ'),('グラタン'),('オムライス'),('グラタン'),('カレー'); create table ZAIRYO_TBL(zid int not null primary key auto_increment,COOK_NAME varchar(10),ZAIRYO_NAME varchar(10)); insert into ZAIRYO_TBL(COOK_NAME,ZAIRYO_NAME) values('グラタン','鶏肉'),('オムライス','卵'),('オムライス','玉ねぎ'),('パスタ','卵'),('パスタ','麺'); create table COOK_KIOKU_TBL(kid int not null primary key auto_increment,COOK_NAME varchar(10)); insert into COOK_KIOKU_TBL (COOK_NAME) values('オムライス'),('グラタン'); //表示 SELECT DISTINCT k.kid,c.COOK_NAME FROM COOK_TBL as c INNER JOIN ZAIRYO_TBL as z ON c.COOK_NAME=z.COOK_NAME LEFT JOIN COOK_KIOKU_TBL as k ON c.COOK_NAME=k.COOK_NAME ORDER BY COALESCE(k.kid,9999); →kidがnullになる場合は適当に大きなデータにしておく（手抜き） →kid以外のソートが設定されていないので、ソート順は必ずしも一意にならない
No.2gouzigです。 補足コメントの内容、そういうやり方になると思います。 そのような方法だと、取引先マスターに区分を追加するDB変更が多発してしまいます。 それでは大変なので、あらかじめ取引先マスターには区分欄を多めに作っておきますね。 そうすれば、都度DB変更作業をしなくて済みます。
OSは何を利用している前提でしょう？ サーバー上のコンソールでしょうか？ クライアントからsshなりでログインしているのでしょうか？
PostGlSをさわったことがありませんが。 > ST_GeomFromText('POLYGON(( POLYGONのカッコが２重になってますが、1重にしたらどうなります？ 参考URLも見て下さい 参考URL：http://lets.postgresql.jp/documents/tutorial/Pos …
\のかわりに/を用いてみてください。
＞自分はまずSQLを投げる前に空のチェックをすればいいんですか？ 考え方は4つ (1)POSTを受け取って、SQLに投げる前にチェックできるタイミングがある 空だったり想定した値でない場合には前の画面にもどす いわゆる「バリデート」処理 (2)送られてくる前にjavascriptなどでチェックする、これもUIの基本。 ただしjavascriptのチェックはあくまでもおまけなので javascriptでチェックをかけたとしても必ずサーバー側で二重チェック しないといけない (3)事前処理をせずにSQLにまかせる あらかじめ空文字をいれたデータを登録しておき自動ではじかれるようにするなど 運用でカバー (4)チェックしない 前述したとおり、結局機械的なチェックをしてもそれが「正解」かどうかは 別のはなし。一生懸命チェックしても結局むだならしなくてもいいという 考えもある。 どれをとるかは、あなたしだい 通常は(1)、(2)をベースに行い、(3)や(4)は例外処理がおおくなるので あまりお勧めできません。
max_sp_recursion_depthで設定するみたいです http://dev.mysql.com/doc/refman/5.1/ja/server-sy … ただあまり再帰処理はしない方がいいと思いますけどね・・・
こんにちわ。 > 作業時間 を　文字型で '01:45' として格納したデータを > Date型の'1.75'というデータに変換したいのですが、どうしたらできるでしょうか。 先ずDate 型についてですが内部では7バイト数値型で、整数部で基準日からの経過日数を 小数部で当日の経過秒を表しています。 01:45 は、時:分 を表していると思いますが、日付の部分はどのようにお考えでしょうか？ 強引にやれば、to_date('01:45', 'HH24:MI') ですが、これでは日付情報が欠落 しているため、以下のように目的の値とならない可能性があります。 SQL> select sysdate, to_char(to_date('01:45', 'HH24:MI'), 'YYYY/MM/DD HH24:MI:SS') from dual; SYSDATE TO_CHAR(TO_DATE('01:45','HH24:MI'),'YYYY/MM/DDHH24:MI:SS' -------- --------------------------------------------------------- 14-04-23 2014/04/01 01:45:00
insert ignore into でデータを投入して、 php側でaffected_rows()やrowCount()で作用した行数を数え 0だった場合にメッセージをだせばいいのでは？
＞dataカラムにカンマ区切りのデータを保存している いや、SQLでそれはあり得ない・・・ こうしてみて //テストデータ create table tbl(id int not null auto_increment primary key,groupid int,data int); insert into tbl(groupid,data) values(1,1),(1,2),(1,3),(2,1),(2,2),(2,10),(3,1),(3,2),(3,3),(3,10); //カンマ区切り表示 select groupid,group_concat(data order by data) as datas from tbl group by groupid; //data単位で集計 select data,count(*) as count from tbl group by data;
＞10数件のインデックスを張ったテーブルは普通に運用できるものなのでしょうか……？ ＞または、「Using filesort」は大きな問題ではないと考えたほうがよいのでしょうか？ インデックスを貼るとデータの追加、削除のスピードは落ちます。 よって検索と更新、どちらを頻繁にするかということも関連してきます。 私が持っているデータで言えば、２０年前のアメリカ某大手の大型コンピュータで １万件をソートして５０秒というのがありました。 顧客が電話で問い合わせてくるものに対してデータを表示するソフトでしたので、 ５０秒は待てないと言われました。 問い合わせのパターンを絞ってもらってインデックスを１０個作成して検索したら３秒になりました。 サーバーの処理能力にもかかってきますが、１億件を考えるとテストで打ち込んでも タイムアウトするか、しばらくそのサーバーを専有してしまうかもしれません。 （他のすべての処理を止めかねない）
select * from tbl t1 where t1.no = (select max(t2.no) from tbl t2 where t1.id = t2.id) MySQLもバージョンによって使えるsqlが異なりますのでバージョンは明記しましょう。 where (id,no) in・・・が使えるならANo.1の方のsqlのほうがいいと思いますが、 古いバージョンはこちらしかだめだったかと。 さらに古いバージョンはこちらもだめだったりしますが。
top.phpのGETパラメータに、「id」が存在しないようですが。 <form>～</form>の間に送るべき値、例えば echo "<input type=\"hidden\" value=\"$row['番号']\">"; などがありません。 URLで、koushin_input.phpの後ろにGETパラメータありますか？ これだと、koushin_input.phpの $id=(isset($_GET["id"]))?((int) $_GET["id"]):0; この部分は、必ず0になると思われます。 もしなら echo "<form action=koushin_input.php method=get>"; を echo "<form action=koushin_input.php?id=$row['番号'] method=get>"; としてもいいかもしれません。 当然、限定的な環境下での利用方法になりますが。 で、データが削除されたのではなく、番号=0が純粋に 存在しないから発生しているのではないでしょうか。
>>削除ボタンを押しても削除できないので質問しました どういう仕組でどういう流れで削除するのかは誰が決めてるんですか？ また、その仕組流れを理解できてますか？ 上記できないようでしたら、 「キーを回しても車が動きません。なんでですか？」 という質問と同レベルです。 エンジンは壊れてないの？そもそもエンジン付いてるの？燃料は入ってるの？タイヤは？道路は？ もう少しわかない場所、動かない場所をまず自分で切り分けましょう・・・・
mysql> LOAD DATA INFILE "T01Prefecture.csv" -> INTO TABLE T01Prefecture FIELDS TERMINATED BY "," -> LINES TERMINATED BY "\r\n"; Query OK, 1 row affected, 1 warning (0.11 sec) Records: 1 Deleted: 0 Skipped: 0 Warnings: 1 mysql> select * from t01prefecture; +---------+-----------+ | pref_cd | pref_name | +---------+-----------+ | 1 | 北海道 2 | +---------+-----------+ をみると、 -> LINES TERMINATED BY "\r\n"; CR(0x0D)+LF(0x0A)という改行になっていないので、 １行目のpref_nameは、 「 北海道 2 」という値が入っているのがわかります。 入力元のファイルをバイナリエディタで調べてみましょう。 改行が0Dだけなら\rで、0Aだけなら\nで指定するとうまくいくはず。 バイナリエディタの例 BZ エディタ http://www.forest.impress.co.jp/library/software … 他。
流れ的にはこんな感じでどうでしょう？ (1)テンポラリテーブルに未出力のデータidをはきだす (2)テンポラリに合致するデータをcsvに出力する (3)出力後テンポラリを元にデータテーブルのoutputカラムをアップデートする
同じtestテーブルで管理しているなら複合インデックスで十分では？ explainで検証しながらやってみるしかないでしょう bが「ほぼユニーク」であるならbで先行して 絞り込みをしてサブクエリをつかって処理する手もないことはないかと。 できれば「ほぼユニーク」をなんらかの形で「ユニーク」に絞り込む 方法を考えた方がいいかもしれませんね
こうなるとおそらくもう釣りだと思うんだけど一応かいときます もし釣りじゃなければ何か参考書でもかって基礎から学習したほうがいいと思います。 <table border='1'> <tr> <th>番号</th> <th>氏名</th> <th>住所</th> </tr> <?PHP $id=(isset($_GET["id"]))?((int) $_GET["id"]):0; $con=mysqli_connect("localhost","root","password","db_test"); $result = mysqli_query($con,"SELECT `番号`,`氏名`,`住所` FROM tbl_test where `番号`={$id}"); while($row = mysqli_fetch_array($result,MYSLQI_ASSOC)){ print "<tr>"; print "<td>".htmlspecialchars($row["番号"])."</td>"; print "<td>".htmlspecialchars($row["氏名"])."</td>"; print "<td>".htmlspecialchars($row["住所"])."</td>"; print "</tr>"; eof; } ?> </table> 前回は<tr>の位置がまちがってました。 ちなみに、削除するときは DELETE FROM tbl_test where `番号`={$id} で削除することになります
ちなみにこんな感じ create table hogehoge ( test1 char(11) DEFAULT NULL, test2 char(3) DEFAULT NULL, test3 int DEFAULT NULL, test4 char(5) DEFAULT NULL, test5 int DEFAULT NULL, test6 double DEFAULT NULL, test7 double DEFAULT NULL, test8 int DEFAULT NULL ); create temporary table tmp (data char(41)); insert into tmp values ('011010000000009　　　　　043.052927141.3446931') ,('011000000000009　　　　　043.059576141.3581841') ,('011010010000009　　　　　043.036466141.3242842') ,('011010010010009　　　　　043.038999141.3229683') ,('0110100A0020009　　　　　043.037663141.3252133') ,('0110100E0030009　　　　　043.037048141.3238143'); //ここをload処理にする？ insert into hogehoge select mid(data,1,11) ,mid(data,12,3) ,mid(data,15,1) ,mid(data,16,5) ,mid(data,21,1) ,mid(data,22,9) ,mid(data,31,10) ,mid(data,41,1) from tmp; //表示 select * from hogehoge;
>データを移植 データとは住所録ですか？バージョンは？ 参考URL なお、筆ぐるめのプログラムはWindows 8.1でインストールする必要があります（Windows 7についていたプリインストールプログラムならWindows 8.1で使用できない可能性もあります（ライセンスと、バージョン） プリインストールソフトは、基本的には、PC本体とセットの形でのライセンスで、機種を変更（Windows 8.1）した場合使用する権限がない。 Windows 7で使用できたソフトがWindows 8/Windows 8.1対応でないことがある。 参考URL：http://nakahori.cocolog-nifty.com/blog/2011/12/p …
MySQLから削除するのは難しいのでは？ 実行するトリガーとなるプログラム側で処理するのがよろしいかと。 コマンドラインであればシェルやバッチで、プログラム的にであれば phpなどで・・・
＞MSDEとMicrosoft SQL Server 2005 Express Edition Service Pack 3 エディションとしては後継になります。 せっかくなので２０１０とかにしても良いとは思います。２００５では２０００のコマンドから変更された部分もあり注意も必要ですが、２００５から後はあまり変更無いと思います。 またマネージメントツールは別でダウンロードする必要があります。これが無いと全部コマンドベースなので辛いです。
my.cnfなど設定ファイルで調整してください
>【過去の質問】 http://oshiete.goo.ne.jp/qa/8546719.html こちらですよね？追加で回答していたのですが、ご覧になっていないのでしょうか？ No.1さんと同様の回答ではありますが。
そもそもLIKEでマッチさせようというなら最初から わけずにつなげておけばいいのでは？ 完全一致をねらうならカラムをわけても悪いとはいわないですが よほどローカルな区分けでなにかを管理しない限り 番地まで一致するような集計が必要になるとは思えませんが？ （たとえば番地ごとにある電柱の数を集計するとかそのレベル・・・） 都道府県、市区町村、それ以下の３くくり位がちょうどいいかと
decodeだったりnullifとnvlの組み合わせだったり方法はいくらでもあると思いますが、case式を使う例だと select 　case 　　when instr(col, '-') > 0 then substr(col, 1, instr(col, '-') - 1) 　　else col 　end as col from tbl; こんな感じとかでしょうか。
＞>>AccessのデータをSQLで(SELECTで検索したりといった)操作 ＞これについてもう少しヒントをいただけないでしょうか？ 　http://www.geocities.jp/xmldtp/ac_sql.htm 　このサイトの記事は、古いaccessでやっていますが、新しいａｃｃｅｓｓでも、同じ機能は提供されています。バージョンが解らないので、具体的説明はできませんが、探してみればすぐに見つかります。
Windows 8.1 を搭載しているコンピューターに SQL Server をインストールする前に、状況に応じて、以下の最低要件を満たしていることを確認する必要があります。 SQL Server 2008 R2 Service Pack 2 以降の更新プログラムを適用する必要があります。 参考URL：http://support.microsoft.com/kb/2681562/ja
＞　文字列を格納するフィールド型は可変長文字列型にした方がいいのか、固定長文字列型にした方がいいのかです。 varchar 型も可変長文字列なので varchar と text を比べても意味はありません。 固定長と可変長を比べるなら char と varchar を比べなければ行けません。 CPUの性能が良くなり、メモリの搭載量が増え、HDDの読込速度が上がった今となっては、char 型の優位性はあまりないと考えていいでしょう。 データの取扱量が多い環境では、char より varchar の方が資源の有効利用という意味ではメリットが多いかもしれません。 text 型はRDBMSによっては検索時の性能や制限に差があるので、必要最小限にするべきだと思います。 よほど大きな文字列が入る予定が無ければ、varchar(2000) といった感じで varchar 型で大きく取った方が使い勝手がいい場合があります。
外部結合 Cテーブル（Dテーブル）に結合条件となる対象レコードが存在しなくてもAテーブルの レコードを出力することを示します。 通常は等結合で、結合条件に一致しなかったAテーブルのレコードは出力されません。 外部結合は出力することを前提とします。 別テーブルにデータが存在する時は、付加情報としてそれも出力したい場合などに利用しますね。
こんにちわ。 > 「14/04/03」で取得してしまいます。 aaa_date がDATE 型であれば、TO_DATE ではなくTO_CHAR で 取得だと思います。
画像などバイナリデータをDBにおくのはあまり効率的だと言えません。 検索や集計ができるわけでもないので 適当なidを数値でもって、ファイルとしておいておき、DBにはそのIDに ひもづくデータをを格納しておくくらいで十分だとおもいますが。
mysqlマニュアルではgeospatial featureと総称されるようです。この章全部参照するのが一番かな。あんまり利用者がいないのか、日本語訳はされていない。 http://dev.mysql.com/doc/refman/5.1/ja/spatial-e … http://dev.mysql.com/doc/refman/5.1/ja/opengis-g … 次の章あたりから、実際の例文が出てくる。カラムタイプは geometry になるらしい。 http://dev.mysql.com/doc/refman/5.1/ja/creating- …
単純にifで場合分けするだけでしょうね、以下例 //元データ create table tbl (id int not null auto_increment primary key,data varchar(30),flg tinyint not null); insert into tbl(id,data) values(1,'a'),(2,'b'),(3,'c'); select * from tbl; id,data,flg 1,a,0 2,b,0 3,c,0 //id=4,dataを'x'を挿入 insert into tbl (id,data) values(4,@data:='x') on duplicate key update data=if(flg=0,@data,data); select * from tbl; id,data,flg 1,a,0 2,b,0 3,c,0 4,x,0 //id=4のdataを'y'に更新、ただしflgが0の場合→flgは0なので更新 insert into tbl (id,data) values(4,@data:='y') on duplicate key update data=if(flg=0,@data,data); select * from tbl; id,data,flg 1,a,0 2,b,0 3,c,0 4,y,0 //id=4のdataを'z'に更新、ただしflgが1の場合→flgは0なので更新されない insert into tbl (id,data) values(4,@data:='z') on duplicate key update data=if(flg=1,@data,data); select * from tbl; id,data,flg 1,a,0 2,b,0 3,c,0 4,y,0
まだ不十分な点があるけど 一番簡単なのはCase(数量<0;計)という計算フィールドを作って このフィールドの合計を求める集計フィールドを作る。
ファイルにデータを書き出すときに２つ以上が同時に書き込むと ファイルが壊れます。 複数が書き込む処理を１つずつ処理するように制御しているというのが データベースの１つの特徴ですので、言われるような処理はできません。 １つ、あるとすれば一連のINSERTが終了次第、COMMITを挟んでおくと スレッドの終了を待たなくてもいいので速くなったりエラーが出にくくなるかもしれません。
普通考えれば、記事IDには所有者がいて所有者IDでひもづいており 所有者もしくは管理者以外が特定の記事を編集することはできないですよね ＞「◯◯のアカウントで投稿された◯◯番の記事を削除する」 というロジックはないです 条件を二重定義しなくても記事番号だけ指定すれば済みます 「○○番の記事を削除する」だけ指定して WHERE 記事ID = 消したい記事ID AND 所有者ID = 私のID となるなので、該当するレコードの記事IDと所有者IDが合致しなければ ヒットしないでしょう
そもそもUPDATEをEXPLAINする必要があるかどうかはおいとくとして （一般的な環境ではエラーになる？） SELECTは単純にレコードをズバリ指定できればconstになりますが、 UPDATEは1レコードだけみればよいのではなくインデックスやユニークなどの 属性も含めて処理するからrangeになるのではないかと勝手に思っています そういうものだと思うしかないような・・・
「Microsoft® SQL Server® 2012 Express」の「Express with Advanced Services」がおすすめ。 http://www.microsoft.com/ja-jp/download/details. … 自習書のテキストもそろっている http://www.microsoft.com/ja-jp/sqlserver/2012/te … あるいは　「Microsoft® SQL Server® 2008 R2 SP2 - Express Edition」 http://www.microsoft.com/ja-jp/download/details. … http://www.microsoft.com/ja-jp/sqlserver/2008/se … MSDEは「なんちゃってSQLサーバ」みたいなものだから 本物を入れた方が後々都合が良いと思います。 最初はWindows認証で接続した方が簡単です。（Server認証はセキュリティや権限の設定が面倒くさい）
基本的にroot - localhostの組み合わせだけで問題ないはず ３つ有効なユーザーがあるのであればそれぞれがパスワードを持っているのは仕様。 あとは同じパスワードにするか、別のにするかは運用次第。
NO3です。成功しましたのでお知らせします。 1　横長のCSVデータをエクセルに取り込みます。二つのシートになります。 CSVデータはテキストファイルとしてワードなどに保存しておきます。エクセルでそのファイルを開きますが、テキストファイルを開くこととし、区切り文字はカンマと指定します。 シート1にSOGE1のデータを、シート2にSOGE2を取り込みます。 2　エクセルの横長のデータを縦長のデータに変換します。 データの変換にはシート関数があるようですが、使い方が私はわかりませんので下に示した二つのマクロを使ってしーと3しーと4に縦長のデータに変換しました。 3　アクセスにテーブルとして取り込みます。シート3とシート4をsheet3,sheet4という名前で二つのテーブルとして取り込みました。これに縦長のフィールドひとつだけのテーブルをつくり、aaaからfffまでのデータを入れておきます。テーブル3という名前になっています。 4　アクセスでテーブル3とsheet3の間にaaaなどのフィールド1によってリレーションを作り、結合の種類をテーブル3のすべてとsheet3のけっごうとします。クエリーでテーブル3とsheet3を選択して得られたデータをクエリー9という名前で保存します。 5.クエリー9とsheet4の間にリレーションを作ります。結合の種類はクエリー9のすべてとsheet4の結合とします。クエリー9とsheet4を呼び込んでクエリーを作ります。実行すればここでご希望のデータが得られます。 Sub Macro1() ' ' Macro1 Macro ' マクロ記録日 : 2014/3/25 ユーザー名 : ' Dim i As Integer, j As Integer For i = 1 To 2 For j = 1 To 5 Worksheets(3).Cells(j, i) = Worksheets(1).Cells(i, j) Next Next ' End Sub Sub Macro2() ' ' Macro2 Macro ' マクロ記録日 : 2014/3/25 ユーザー名 : ' Dim i As Integer, j As Integer For i = 1 To 2 For j = 1 To 5 Worksheets(4).Cells(j, i) = Worksheets(2).Cells(i, j) Next Next ' ' End Sub テーブル3.フィールド1Sheet3.フィールド1クエリー9.フィールド2Sheet4.フィールド1Sheet4.フィールド2 aa1a1 bb2b2 cc3 dd4d4 ee5 ff6
こういうのは条件と数値の積をとってsumするのが普通です //元データ create table tbl(name varchar(10),point int,d date); insert into tbl values('A',1,'2014-01-01'),('B',2,'2014-01-01'),('C',3,'2014-01-01'),('A',1,'2014-02-01'),('B',3,'2014-02-01'),('C',2,'2014-02-01'),('A',2,'2014-03-01'),('B',4,'2014-03-01'),('C',3,'2014-03-01'); //集計 select name ,sum(point*(d between '2014-01-01' and '2014-01-31')) as `point(2014/1)` ,sum(point*(d between '2014-02-01' and '2014-02-28')) as `point(2014/2)` ,sum(point*(d between '2014-03-01' and '2014-03-31')) as `point(2014/3)` from tbl group by name:
＞ただの利用者 として、権限がどこまであるかによりますが ビューを作れるならそれが一番はやそうですね あとはどこに何が入っているか特定できないなら unionなどで処理することになりそうです
こんにちわ。 > 複数列を複数行にする方法がわかりません。 > 何か良い方法はないでしょうか。 パイプライン表関数を作成すれば、効率的に作成できます。 カンマ区切りのデータから各項目を切り出して、各項目を PIPE ROW で返してやると、返したデータを行として認識できます。 実際の方法は、この辺が参考になるかと思います。 http://docs.oracle.com/cd/E16338_01/appdev.112/b … 参考URL：http://docs.oracle.com/cd/E16338_01/appdev.112/b …
こんにちわ。 > PACKAGEとBODYの分割はできたものの、BODY内のストアドを別々にすると、 > エラーとなってしまいます。 Package Body のStored Procedure は1つのスクリプト内で定義して下さい。 こんな感じです。 Create or replace Package pkg_xxxx as procedure proc_A; procedure proc_B; procedure proc_C; end pkg_xxxx; / show error Create or replace package body pkg_xxxx as procedure proc_A is begin Proc_A の中身 end proc_A; procedure proc_B is begin Proc_B の中身 end proc_B; procedure proc_C is begin Proc_C の中身 end proc_C; end pkg_xxxx; / show errors
単純にunionでidの一覧をつくって それぞれをleft joinすればいいような気がしますが select t1.id,coalesce(t3.name,t2.name) as name from (SELECT id FROM hoge UNION SELECT id FROM test) as t1 left join hoge as t2 on t1.id=t2.id left join test as t3 on t1.id=t3.id
ここで質問しましょう。 http://joy-h.com/bbs2/viewforum.php?id=2
こういうのは本来日付がずらーっとならんだカレンダーテーブルをつくって それにinsert していくのが普通 また曜日は月曜日=0とした0～6（WEEKDAY関数）もしくは日曜日=1とした1～7 (DAYOFWEEK)が扱いやすい かりにこんな処理にすると //元データ create table staff(uid int,uname varchar(20)); insert into staff values(1,'田中'); create table sch1(uid int,start_time time,end_time time,d date,flg tinyint) ; insert into sch1 values(1,'9:00','22:30','2014-03-17',1),(1,'9:00','13:00','2014-03-18',1),(1,'9:00','20:00','2014-03-19',1); create table sch2(uid int,start_time time,end_time time,dateW int,unique(uid,dateW)); insert into sch2 values(1,'9:00','22:30',0),(1,'10:00','11:30',1),(1,'13:00','15:30',3); カレンダーテーブルがない場合はテンポラリで無理やりつくる こんな感じで3/17、18、20、21をそれぞれとると 3/17は両方ヒット、3/18は日付でヒット、3/20は曜日でヒットし 3/21はヒットしないことがわかる。 create temporary table sch3 select '2014-03-17' as d; select * from sch3 left join sch1 on sch3.d=sch1.d left join sch2 on weekday(sch3.d)=sch2.dateW; create temporary table sch3 select '2014-03-19' as d; select * from sch3 left join sch1 on sch3.d=sch1.d left join sch2 on weekday(sch3.d)=sch2.dateW; create temporary table sch3 select '2014-03-20' as d; select * from sch3 left join sch1 on sch3.d=sch1.d left join sch2 on weekday(sch3.d)=sch2.dateW; create temporary table sch3 select '2014-03-21' as d; select * from sch3 left join sch1 on sch3.d=sch1.d left join sch2 on weekday(sch3.d)=sch2.dateW; これをまとめて、こんな感じ create temporary table sch3 select '2014-03-17' as d; select coalesce(sch1.start_time,sch2.start_time) as s ,coalesce(sch1.end_time,sch2.end_time) as e from sch3 left join sch1 on sch3.d=sch1.d left join sch2 on weekday(sch3.d)=sch2.dateW; いちいちテンポラリテーブルを作るのが面倒であれば最初に書いた通り 10年分くらいので日付を並べたカレンダーを最初につくっておいて where カレンダ.d='指定日' 的な処理をすればいい 仮に10年分日付つくっても所詮3600件程度、100年分作っても3万ちょいなので 対して重い処理にはならない
こんにちは。 イノ(inno)です。 翌月10日を取得する時は下記のようにします。 DECLARE @Today DATETIME SET @Today = GETDATE() SELECT CONVERT(CHAR(7),DATEADD(MM,1,@Today), 111) + '/10' これが一番簡単です。 @TodayにDATEADD(MM,1,@Today)をして翌月に移動します。 CONVERTを利用して'yyyy/MM/dd'形式に変換して前から7文字を切り取ります。 その後に'/10'をつけて'yyyy/MM/dd'に変更します。 上記の方法はSQL SERVERの全バージョンから使えます。 SQL SERVER 2012ならば「EOMONTH」を使って下記のように記述して取得することができます。 SELECT DATEADD(day, 10, EOMONTH(GETDATE())) 「EOMONTH」はSQL SERVER 2012以上から使えます。
数人でやってるなら、別にAccessのファイル共用でもいいんじゃ ないですか？　Accessは確かに同時に使うと「落ちる」ことがある ソフトですが、数人程度なら「使ってますよ」と声を掛ければいい だけの話ですし。 それ以上に、データだけをExcelのシート１枚にまとめて、使うたび に「開いて取り込んで閉じておく」「使用中のフラグをどこかのセル に立てておく」程度で済む話じゃないかとも思えるんですが・・・。 数名程度で利用先がExcelマクロ程度なら、SQLサーバとか使う ような大掛かりな話じゃないと思いますけど。
文法エラーで悩んだときはマニュアルで構文を確認しましょう。 http://dev.mysql.com/doc/refman/5.1-olh/ja/delet … DELETEの複合テーブル構文は 　DELETE [LOW_PRIORITY] [QUICK] [IGNORE] 　　tbl_name[.*] [, tbl_name[.*]] ... ←DELETEとFROMの間にテーブル名が必要 　　FROM table_references 　　[WHERE where_condition] となっていますので、 　DELETE a 　FROM piyo AS a 　LEFT JOIN hoge AS c ON a.hoge_id = c.hoge_id 　WHERE c.x_id = 13 と書けばいいかと。
//元データ create table hoge(id int not null primary key,kbn int,name varchar(10),score int,flg tinyint,d date); insert into hoge values(1,1,'a',100,1,'2014-03-10'),(2,1,'b',90,1,'2014-03-11'),(3,1,'c',80,1,'2014-03-12'),(4,1,'d',90,1,'2014-03-13'),(5,1,'e',80,1,'2014-03-10'),(6,1,'f',80,1,'2014-03-11'),(7,2,'g',0,1,'2014-03-12'),(8,2,'h',100,0,'2014-03-13'),(9,2,'i',100,1,'2014-03-10'),(10,2,'j',100,1,'2014-03-11'),(11,2,'k',100,1,'2014-03-12'),(12,2,'l',100,1,'2014-03-13'),(13,3,'m',100,1,'2014-03-10'),(14,3,'n',100,1,'2014-03-11'); とりあえず検索条件がかぶるので一度 (1)(2)をつかってビューを作ります。 //view作成 create view v_hoge as select * from hoge where d between curdate() - interval 1 week and curdate() + interval 1 week and flg = 1; //結果 select * ,(select count(*)+1 from v_hoge as v2 where v1.kbn=v2.kbn and v1.score<v2.score) as rank1 from v_hoge as v1 where kbn in (select kbn from v_hoge group by kbn having count(*)>=5) having (select count(*)+1 from v_hoge as v2 where v1.kbn=v2.kbn and (v1.score<v2.score or v1.score=v2.score and v1.d>v2.d) ) <=5 order by kbn asc,rank1 asc; (1)は「何の」一週間以内なのか不明。たぶん今日の？ また一週間とは前も先もあるので命題が中途半端 (4)と(6)のフォーマットはsql側でやらずに出力側のプログラムでやるべき （キャストや結合が無駄なため） (5)はkbnごとに日付がユニークでないと順位が決定できない (7)は意味不明 ５個データがないのに5位ってどういうこと？しかもkbnまでnullじゃ何を示しているか？
> ためしにCdate関数を使ってみましたが 元のデータはテキスト型ということですか？ 日付型のまま、大小比較するのは危ないと思います。 (1)どうしてこういった現象がおきるのか。 「たぶん」程度ですが、日付表記の文化の違いかも。 日本では「年月日」の言葉通り、yyyymmddですよね。これは大小比較しやすい。 でも合衆国ではmm-dd-yyyyだし、他の英語圏ではdd-mmm-yy。 クエリに日付を#で囲んで記述する際に#14/03/2014#と書くようです（参考URL) なので > ?Deduction!To > 2014/02/13 は　14/02/13　→　2013/02/14と解釈されてるのかも。 if format(Deduction!To, "YYYY/MM/DD") > format(Contract!To, "YYYY/MM/DD)　Then みたいに明示したほうがトラブルにならないと思います。（処理速度が不利としても） バージョンによるのかも、とは思いますが １）ACCESSでタイムスタンプ目的で年月日時分秒を記録して ２）レコードコピーして、 ３）EXCELにペーストすると、dd-mmm-yyになる。 ４）それをEXCELでコピーして ５）ACCESSにペーストすると、yyとddが逆転する。 何度か痛い目に遭いました。 参考URL：http://office.microsoft.com/ja-jp/access-help/HA …
　解りやすいのは、with句を利用して、ROW_NUMBER列を形成し、本体select文側で、ROW_NUMBER列に対して条件付けしてあげることかな。 　例えば・・・ WITH JYUNITUKI AS (SELECT RETU1,RETU2,RETU3, 　　　　　　 ROW_NUMBER() OVER ( ORDER BY RETU1) AS ROWNUM 　　　FROM TABLE1 WHERE 条件いろいろ) SELECT RETU1, RETU2, RETU3 FROM JYUNITUKI J WHERE J.ROWNUM　BETWEEN 50 AND 100 　とかですね。
#1さんの通りですが 効率は変わりませんがこの場合はbetweenの方がよいかもしれません select user_id from tbl_a group by user_id having count(*) between 2 and 5;
こんにちわ。 > これはどういった場合に発生するエラーなのでしょうか？ 識別子で出力されているSynonum が存在しないか、アクセス権限が無い 可能性が高いです。 > またOracleのバージョンによってPL/SQLのコマンドが動かなくなったりすることは > よくあることなのでしょうか？ データディクショナリ等、Oracle 内部のオブジェクトに依存して いなければ、通常は大丈夫です。
こんなのでもいいかな。 B1:=MIN(A1,40) C1:=A1-B1
＞ユニークな値(10桁ほどの英数文字列)を持ったデータを、DBに大量に登録したい といっているのに ＞1件ずつユニークかのチェック しているのはなぜですか？ 元データはユニークである保証がない、つまり 「ユニークな値を期待したデータ」でしかないということですか？ とりあえずデータを取り込むテーブルのユニークな値を保持するカラムに unique属性(プライマリキーを含む)を設定するところからですね 一つ一つのデータのユニークをプログラム的に検証するのは 無駄が多いのでお勧めできません それと、ユニークではないデータ（ダブったデータ）が来た時には 無視するか、上書きするかを決めないといけません。 無視する場合は、INSERT IGNORE INTO 構文 上書きする場合は、INSERT ON DUPLICATE KEY UPDATE 構文 を利用します。 http://dev.mysql.com/doc/refman/5.1/ja/insert.html http://dev.mysql.com/doc/refman/5.1/ja/insert-on … 場合によっては元データがCSV形式であればLOAD DATA INFILE構文 がつかえるかもしれません http://dev.mysql.com/doc/refman/5.1/ja/load-data … 元データを所定のルールで補完しながらデータを投入するのでしたら やはりINSERT構文が基本です 総合的に考えるとPDOなどの互換性をもった仕組みを利用すると 多少の環境の変化にも対応できるとおもうのでお得です またPHP+MySQLの場合はmysqliという仕組みが用意されていて オブジェクト型・手続き型というアプローチの仕方があります。 それぞれ特性がありますので、やり方は多少ためしてみてから 決めた方がよいですが、一般にオブジェクト型の方が好まれるようです。 ちなみにmysql関数（iがつかないタイプ）を利用した解説書がまだ 販売していたりしますが、内容が古いので参考にしないほうがいいでしょう データの持ち方についてはRDBの原則として正規化をしていると思いますので それに合わせてデータ投入方法を考えないといけません 一度正規化について詳しく勉強したほうがいいかもしれませんね
こんな感じでは？ //元データ create table WK(ID int not null primary key, POSTID int, DATA varchar(20), FLAG tinyint); insert into WK values(1,1,'aaaa',0),(2,1,'bbbb',0),(3,1,'cccc',0),(4,1,'dddd',0),(5,5,'eeee',0),(6,5,'ffff',0),(7,5,'gggg',0),(8,4,'hhhh',0),(9,4,'iiii',0),(10,4,'jjjj',0); //アップデート update WK as t0 inner join (select ID from WK as t1 where (select count(*) +1 from WK AS t2 WHERE t2.ID < t1.ID and t2.POSTID=t1.POSTID) >2) as t3 on t0.ID=t3.ID set FLAG=1 where t3.ID is not null; //表示 select * from WK; ※考え方 POSTIDごとにID順でランクをつけ、そのランクが2より大きいもののIDをつかって アップデートする。
select count(*) as cnt, point from tbl group by point order by cnt desc
副問い合わせを使って「テーブルAのTOP10を抽出したもの」とテーブルBを外部結合したらどうでしょうか。 SELECT AA.列名, テーブルB.列名 FROM (SELECT TOP 10 列名 FROM テーブルA) AA LEFT OUTER JOIN テーブルB ON (結合条件) このようにFROM句の後に()をつけてSELECT文を記述すると、そのSELECT文の結果を一つの表（ビュー）として扱えます。
>starttimeが2番目に大きいもの ちょっと特殊になりますがこんな感じ select * from tbl where (juchuu,keisiki) in (select juchuu,t2.keisiki from tbl as t2 inner join (select starttime,keisiki from tbl where keisiki=7745 order by starttime desc limit 1,1) as t3 on t2.starttime=t3.starttime and t2.keisiki=t3.keisiki) ここでlimit 1,1の前の「1」が2番目に大きいという意味 つまりn番目に大きいものを含むはlimit n-1,1とする 1番大きいのはlimit 0,1でもいいが、maxを使った方がらく keisikiごとに同じstarttimeがあるとは想定していません 同じものがある場合はさらに順位をつけるロジックが必要になるので
こんにちわ。 > OracleClient9iをインストールしたのですがインストール自体は > 終わっても正常にインストールできないようでOSから入れなおし > ました。 Oracle9i は相当古いので、恐らくWindows Server 2008R2 をサポート していないためと思われます。 > どれをインストールすればよろしいでしょうか。 先ずは、以下の情報を確認して下さい。 http://www.oracle.com/jp/system-requirement/inte … 先ず、Oracle12c からはOracle9i への接続はできません。 11.2 以下のClient が必要となりますが、現在はOracle9i のサポートは終了しているため 不具合が見つかったとしても修正は行われません。 参考URL：http://www.oracle.com/jp/system-requirement/inte …
select a.* from a left join b on substring(a.url,8)=b.id where a.url REGEXP '^/color/.*' where substring(a.url,1,7)='/color/' 抽出条件はurlが'/color/'で始まるもの where句はどちらも同じ意味になりますので、 どちらかを使って下さい。 結合条件はa.urlの8文字目以降とb.idが 一致するものです。
49で始まる13桁の数字からすると、JAN－13コードですか？ 計算に用いない、とにかく読めさえすれば良い、ということならば 先頭にアポストロフィー(Shift＋7)を付加するとか。（見えちゃいますが)
気がする、だけですとなかなか回答しづらいので、実際に動作時間を測ってみるのはいかがでしょうか。 添付URLの記述を参考にしてみてください。 参考URL：http://d.hatena.ne.jp/replication/20130321/13638 …
これでよくない？ select t1.*,if(isnull(t2.mysequence),0,1) as myflg from mymagazine as t1 left join (select distinct mysequence from mymagazine order by mysequence desc limit 3) as t2 on t1.mysequence=t2.mysequence
一応、0月0日 は許容されています。 年は４桁指定で 2014-00-00 , 2013-03-00 のようになるべく省略せず指定すべきではありますが。マニュアルみるとinsert時の年月日指定フォーマットは、結構柔軟に対処されます。 where 文で比較するときは、そのような日付は、2014-00-00　であれば2013前年より後で、2014-01-01より前と解釈されます。 http://dev.mysql.com/doc/refman/5.1/ja/date-and- … 「SQL モード」でも許容されるかが変わるので、ご注意ください 参考URL：http://dev.mysql.com/doc/refman/5.1/ja/date-and- …
SQL Serverのエディションにもよりますがクライアントアクセスライセンスがクライアント数分必要になります。 参考URL：http://www.microsoft.com/ja-jp/sqlserver/2012/ho …
２つのテーブルの相関関係がいまいちわからない なぜ２つに分けているか？ それぞれがどういうデータをもっていて どう表示したいのか簡単な例示はできますか？
　基本的には回答No.1様の方法に似た方法ではありますが、私の場合は、作業用シートの1行目に入力するシート名を間違えたり、将来的に作業人数を増やした場合における新たなシート名を記入するために、1行目が空欄の列を設けて置いたりした場合においても、エラーとはならない様にするために、次の様にします。 　まず、作業用シートのA1セルに「シート名」と入力して下さい。 　次に、作業用シートのB1～D1セルに各担当者シートのシート名を入力して下さい。 　次に、作業用シートのB2セルに次の関数を入力して下さい。 =IF(B$1="","",IF(ISERROR(1/(INDIRECT("'"&B$1&"'!A"&ROW())<>"")),"",ROW()+COLUMNS($B:B)*10000000)) 　次に、作業用シートのB2セルをコピーして、作業用シートのC2～D2の範囲に貼り付けて下さい。 　次に、作業用シートのB2～D2の範囲をコピーして、同じ列範囲の3行目以下に貼り付けて下さい。 　次に、集計シートのA4セルに次の関数を入力して下さい。 =IF(ROWS($4:4)>COUNT(作業用!$B:$D),"",INDEX(INDIRECT("'"&INDEX(作業用!$B$1:$D$1,INT(SMALL(作業用!$B:$D,ROWS($4:4))/10000000))&"'!A:C"),MOD(SMALL(作業用!$B:$D,ROWS($4:4)),10000000),COLUMNS($A:A))) 　次に、集計シートのA4セルをコピーして、集計シートのB4～D4の範囲に貼り付けて下さい。 　次に、集計シートのA4～D4の範囲をコピーして、同じ列範囲の5行目以下に貼り付けて下さい。 　以上です。 　因みに、 COLUMNS($B:B)*10000000 等の箇所において掛け合せる数を、何故100や1000等ではなく、10000000としているのかと申しますと、例えば掛け合せる数を100とした場合において、もしも、「ああ」シートの100行目よりも下の行、例えば102行目などの所にデータが入力されていますと、作業用シートの「ああ」の列の102行目の所には「202」(=102+100)と表示されてしまい、右隣の「いい」列の2行目に表示される「202」(=2+100)と区別がつかなくなります。 　一方、現行のExcelで使う事が出来る行数は、1048576行までですので、列数×10000000としておけば、万が一にも上記の様な事が起こる恐れは無くなるため、掛け合せる数を10000000としております。 　若しくは、10000000の代わりに ROWS(A:A) 等とするという方法もあります。
＞show table status;がありました。しかしこれでは、データが本当にそのストレージエンジンを使って格納されているかどうかがわかりません。 ごめん意味がわからない これで表示されるengineがそのテーブルのエンジンですが ＞一覧表示か検索で 何を一覧表示するの？
仮に 「aaatestbbb」はヒットして「aaa[[test]]bbb」はヒットしないとして 「aaatestbbb[[test]]ccc」はどうするのでしょうか？ ヒットしなくていいなら where not カラム like '%[[test]]%' and カラム like '%test%' みたいな感じ どちらにしても前方後方一致はインデックス対象外なので スピードは期待できませんが
postgreSQLのLPAD関数は引数の型が 文字列,数値,不定　となっています。 seq_noが数値なので、文字型でなければ いけないLPADの第1引数に指定すれば、 当然ですが、掲題のようなエラーになります。 関数の意味としては前ゼロを付けて、 shiyo_ketaの示す長さでseq_noを表現 したいのではないかと思います。 lpad()の代わりに、以下の方法を使って 見てください。 to_char(seq_no,repeat('0',shiyo_keta))
INNER JOINに書き換えたのが以下。 q1クエリ SELECT date, Sum(num) AS num, date1, date2 FROM (SELECT Table1.date, Table1.num,Table1.date-1 as date1,Table1.date-2 as date2 FROM Table1 union SELECT Table1.date-1, 0 as num,Table1.date-2 as date1,Table1.date-3 as date2 FROM Table1 union SELECT Table1.date-2, 0 as num,Table1.date-3 as date1,Table1.date-4 as date2 FROM Table1) GROUP BY date, date1, date2; 結果クエリ SELECT q1.date, q1.num+q1_1.num+q1_2.num AS sum_num FROM (q1 INNER JOIN q1 AS q1_1 ON q1.date1 = q1_1.date) INNER JOIN q1 AS q1_2 ON q1_1.date1 = q1_2.date WHERE q1.num<>0;
＞直近の1ヶ月に誕生日を迎える の定義次第ですね ・今月と誕生月が一緒の場合、今日の日付が誕生日の日付より小さい ・来月と誕生月が一緒の場合、今日の日付が誕生日の日付と同じか大きい ということでよければ、こんな感じ？ （過去１カ月も取りたいとなるともうちょい工夫が必要） //元データ create table office (birth date,name varchar(20)); insert into office values('1960-03-02','山田'),('1970-03-15','菊池'),('1980-03-22','田中'); //今日が2014-02-10の場合 SELECT office.* from office where month(@d:='2014-02-10')=month(birth) and day(@d)<day(birth) or month(@d)+1=month(birth) and day(@d)>=day(birth) order by birth asc; →山田 //今日が2014-02-28の場合 SELECT office.* from office where month(@d:='2014-02-10')=month(birth) and day(@d)<day(birth) or month(@d)+1=month(birth) and day(@d)>=day(birth) order by birth asc; →山田、菊池、田中 //今日が2014-03-02の場合 SELECT office.* from office where month(@d:='2014-02-10')=month(birth) and day(@d)<day(birth) or month(@d)+1=month(birth) and day(@d)>=day(birth) order by birth asc; →菊池、田中 //今日を調整しない SELECT office.* from office where month(@d:=curdate())=month(birth) and day(@d)<day(birth) or month(@d)+1=month(birth) and day(@d)>=day(birth) order by birth asc;
あ、以上・以下ではなくより大きい・より小さい（未満）のときは 1足したり1引いたりして調整してください
　……belong_cat_3='10086', belong_cat_4='' ,goods_id='1000402' or …… の部分って 　……belong_cat_3='10086', belong_cat_4='' where goods_id='1000402' or …… だったりしませんか？
#1 です。 補足に書かれた 「ログファイルではなくて、トランザクションログのフォルダについての質問になります。 」 の意味が良くわかりません。 ちなみに、質問文には「Logファイル」は有っても「トランザクションログ」とは書いてありません。 insert処理でLogファイルに書きこまれるのはトランザクションログです、 そして、トランザクションログは各データベースのログファイルに書かれます。 なので、データベースのログファイルについた書いたつもりですが 質問者の認識と異なる部分があるのかもしれません。 とりあえず書けば (1) 新規にデータベースを作成する場合には 　「サーバーのプロパティ」の「データベースの設定」にある 　「データベースの規定の場所」に設定されているフォルダが 　デフォルトのフォルダーになります。 　実際にデータベースを作成する際にそれを変更することも可能です。 (2) 既に作成されたデータベースについては、当然、あとから(1)を変更しても変わりません。 　「データベースのプロパティ」の「ファイル」にデータベースファイルとログファイルの一覧があります。 　これを変更したい場合は少し注意というか正しい手順で行う必要があります。 　マニュアル等を確認して行ってください。 あとはなんだろ？ 「SQL Server ログ」のことかな? これは、SQLサーバーをインストールした場所から変更できそうに無いですね。 インストール時に好きなところへ指定できるかは、少し調べてみないとわかりません。 でも、データの更新があったからといって、このログが書き込まれるわけでは無いので、 実際に、このログが頻繁に書き込まれているとするなら、他にエラーとかの原因が考えられます。
「2得点以上5得点未満の試合」はhome_scoreとaway_scoreの両カラムがという事でしょうか。 それとも自チームが「2得点以上5得点未満の試合」という事でしょうか。 両カラムならば select * from gamedata where home_score >= 2 and home_score < 5 and away_score >= 2 and away_score < 5; 自チームという事なら select * from gamedata where (h_a = 'H' and home_score >= 2 and home_score < 5) or (h_a = 'A' and away_score >= 2 and away_score < 5);
こんにちは。 あぁ。空白が入っていましたね。 下記のように-1をしてください。 Ltrimを使うよりいいです。 DECLARE @Str VARCHAR(100) SET @Str = 'abc 123 xyz' SELECT RIGHT(@Str,CHARINDEX(' ',REVERSE(@Str))-1) SET @Str = 'abcxcvzx 123456 xyzsdf' SELECT RIGHT(@Str,CHARINDEX(' ',REVERSE(@Str))-1) また下記の質問の件ですが、 >> CHARINDEXで検索文字列を「123」とすると結果が得られ >> ないのですが、REVERSE関数により反転してしまっている >> からですか。 そうですね。REVERSE関数により検索ができなかったからです。 どんなデータでどんなデータを得られたいかをもっと詳しく教えて頂ければ、 答えするのに助かりますが。。。 よろしくお願いします。
はじめまして、通りすがるというものです。 パススルークエリの方法ですが、パススルーでググってみると、以下のｕｒｌが検出されました。 http://support.microsoft.com/kb/303968/ja これで、解決されるのでしょうか？ データ量が増えて、ｓｑｌserverに移行した。ということですが、今まで、クライアント側のアクセスを回線 を通して、ｄｂから抽出したデータをクライアントに送信する形式となったのでそのネックで当然 レスポンスは落ちると思います。 また、氏名検索にて同一名が複数存在した場合（データ量増大により）サーバーとクライアントとの データ量が増大しレスポンスが低下することが予想されるかと思います。 これらにより、パススルークエリによる（これはアクセス特有の機能？　）レスポンスの改善はあまり 効果ないと思います。 レスポンス向上の方法として氏名のみの検索条件だけでなく、たとえば住所とか、生年月日などの 複合条件で検索することを検討したほうがよいかと思います。 複合条件で抽出件数を絞ることにより、サーバーからクライアントへのデーター送信量を絞るため レスポンス向上を図れると思います。 これに合わせ、サーバー自体に付加がかかるのであれば、インデックスを追加するとかメモリ割り 当てなど、検討してはいかがでしょうか？
えーと、こんな感じでどうですか？ //元データ create table mytable (myCode int not null auto_increment primary key,val varchar(20)); insert into mytable(val) values('a'),('b'),('c'),('d'),('e'),('f'),('g'),('h'),('i'); //最新6件にフラグをつける select t1.*,if(isnull(t2.myCode),0,1 ) as flg from mytable as t1 left join (select myCode from mytable order by myCode desc limit 6) as t2 on t1.myCode=t2.myCode
Runtime版を作ろうとしているのだろうと思います。 最初の一歩でつまずくかも？ http://infith.com/system/database/mysql_odbc_win … Access2010 の場合ですがファイルの拡張子を、accdr にすると Runtimeモードで起動できます。
＞なぜでしょう？ 文字列として、先頭から１文字つづ比較していくから。 「01 」と「002」を、先頭から１文字づつ比較すると、以下のようになります。 ・１文字目の「0」と、１文字目の「0」を比較、同じなので、２文字目の比較に進む。 ・２文字目の「1」と、２文字目の「0」を比較、「1」の方が大きい。 ・結果が出たので、３文字目は比較しない。 結果「01 」は「002」よりも大きい、となります。 これは、「AB 」と「AAC」を比べたら「AB 」の方が大きい、と言う比較と同じです。
とりあえずデータベースを作る権限はなさそうですね？ CREATE DATABASEを削除すると同時に すでに作られているデータベースを使用することを宣言してください USE すでに作られたDB; CREATE TABLE ・・・ またすでに同名のTABLEが存在する場合はまたエラーがでますので CREATE TABLE IF NOT EXISTS などの構文を使うか、そのテーブルを削除してからインポートしてください （テーブルの削除はリスクがありますので自己責任でお願いします）
month でグループ化しないと、opencoursesテーブルに有る分の行数が出力されますね。 グループ化すると、CASE式を入れ子にする必要が出てきますが。 SELECT month AS 開講日 ,CASE WHEN SUM(CASE WHEN course_name = '経理講義' THEN 1 ELSE 0 END) > 0 THEN '○' ELSE '×' END AS 経理講義 ,CASE WHEN SUM(CASE WHEN course_name = '財務講義' THEN 1 ELSE 0 END) > 0 THEN '○' ELSE '×' END AS 財務講義 ,CASE WHEN SUM(CASE WHEN course_name = '簿記講義' THEN 1 ELSE 0 END) > 0 THEN '○' ELSE '×' END AS 簿記講義 ,CASE WHEN SUM(CASE WHEN course_name = '税理講義' THEN 1 ELSE 0 END) > 0 THEN '○' ELSE '×' END AS 税理講義 FROM OpenCourses AS OC INNER JOIN CourseMaster AS CM ON OC.course_id = CM.course_id GROUP BY month ORDER BY 1 ; 参考URL：http://codezine.jp/article/detail/751
#3 ですが、商品IDが2桁以上になるとダメですね。 マッチングに正規表現を使わなければならないかも知れません。 SELECT no, (SELECT LISTAGG(商品名, ', ') WITHIN GROUP (order by 商品ID) FROM Bテーブル b WHERE REGEXP_LIKE(a.商品ID, '\s*(.*\D)?' || b.商品ID || '(\D.*)?\s*') FROM Aテーブル a; 参考URL：http://docs.oracle.com/cd/E16338_01/appdev.112/b …
ExcelにはAccessのレポートを読み込む機能はないので無理なような気がします。 下記で紹介されているフリーソフトを使うというのはどうでしょうか。 レポートを PDF 出力するフリーウェアまとめ | YU-TANG's MS-Access Discovery http://www.f3.dion.ne.jp/~element/msaccess/AcTip …
こんばんは！ 関数でやってみようと作業用の列・Sheetを使用して試みましたが 数式が長くなるのであきらめました。 お望みでないVBAになってしまいますが、一例です。 ↓の画像の左側が「集計Sheet」でSheet見出しの一番左側にあり、Sheet2～Sheet4のSheet名は ああ・いい・うう　のように担当者名になっているという前提です。 まず、Alt＋F11キー　→　メニュー　→　挿入　→　標準モジュール　→　VBE画面に ↓のコードをコピー＆ペーストしてください。 Dim k As Long, lastRow As Long, str As String, wS As Worksheet 'この行から Sub Sample1() Set wS = Worksheets(1) For k = 2 To 4 '←Sheet見出しの左から2番目～4番目のSheet With Worksheets(k) .Range("A1").AutoFilter field:=1, Criteria1:=wS.Range("B2") If wS.Range("B3") <> "" Then .Range("A1").AutoFilter field:=3, Criteria1:=wS.Range("B3") End If lastRow = .Cells(Rows.Count, "A").End(xlUp).Row If lastRow > 1 Then Range(.Cells(2, "A"), .Cells(lastRow, "C")).Copy wS.Cells(Rows.Count, "A").End(xlUp).Offset(1) End If .AutoFilterMode = False End With Next k End Sub Sub Sample2() Set wS = Worksheets(1) str = wS.Range("B3") On Error Resume Next With Worksheets(str) If wS.Range("B2") <> "" Then .Range("A1").AutoFilter field:=1, Criteria1:=wS.Range("B2") End If lastRow = .Cells(Rows.Count, "A").End(xlUp).Row If lastRow > 1 Then Range(.Cells(2, "A"), .Cells(lastRow, "C")).Copy wS.Cells(Rows.Count, "A").End(xlUp).Offset(1) End If .AutoFilterMode = False End With End Sub 'この行まで 次にExcel画面に戻り、 Sheet見出しの一番左側にある「集計Sheet」のSheet見出し上で右クリック　→　コードの表示　→　VBE画面に ↓のコードをコピー＆ペースト　→　Excel画面に戻り、B2・B3セルにデータを入力してみてください。 Private Sub Worksheet_Change(ByVal Target As Range) 'この行から Dim endRow As Long If Intersect(Target, Range("B2:B3")) Is Nothing Then Exit Sub endRow = Cells(Rows.Count, "A").End(xlUp).Row If endRow > 6 Then Range(Cells(7, "A"), Cells(endRow, "C")).ClearContents End If If Target.Address = "$B$2" Then If Target <> "" Then Call Sample1 Else Call Sample2 End If ElseIf Target.Address = "$B$3" Then If Target <> "" Then Call Sample2 Else Call Sample1 End If End If End Sub 'この行まで おそらくお望み通りの動きになると思います。 ＞マクロは苦手です。関数でなんとかなりませんか？ というコトですので、 ご希望の方法でない場合は無視してください。m(_ _)m
http://www.postgresql.jp/document/9.3/html/sql-s … 名前 as 別名 の as は省略可能です。(こういう記法では、 []でかこった部分は省略可能を意味します) つまり yamato_order_info as yo と同じです。 IN については http://www.postgresql.jp/document/9.3/html/queri … http://www.postgresql.jp/document/9.3/html/funct …
IDが5同士なら名前順ということみたいなので 0rder by MAX_ID DESC，NAME に訂正
追記 VBAからマクロを呼び出すより、 マクロの処理をVBAに変換して、すべてVBAで処理するようにしたほうが、 デバッグしやすいですね。 マクロはデバッグ機能が貧弱なので。
＞共用サーバー系ではトリガーが使えないのは普通なのでしょうか…？ super権限ってのはいわゆるrootユーザーみたいなのですから いろんな意味で難しいのかもしれませんね 極端な権限譲与するとレンタルサーバーのまた貸しみたいなことも できちゃいますしね また高負荷がかかりそうな機能もあまり許諾してもらえないと思います いずれにしろトリガー自体はそれほど重要な機能ではないので サービス側が「プログラムで対応しろ」というのであれば それが限界なのだと考えるしかないと思います
　一つだけ、絶対にテーブルを分けておかなければいけないパターンがあります。 　一人の会員が、二つ以上のブログを持てる場合です。 　この場合、memberテーブルと、blog詳細テーブルが一対多の関係となるため、二つのテーブルが必要です。 　ブログは、金輪際、一人につき一つだと主張するのであれば、blog詳細テーブルのnoフィールドは不用です。 　memberテーブル　blog詳細テーブル共に、同じnoを使用することとして、主キーはどちらのテーブルでもnoとなり、結合するフィールドも当然noとなります。 　後者の場合において、テーブルを一つにするか二つにするかですが、・・・ 　もし、セキュリティーを考えてというのが動機であれば、テーブルは一つで良いです。 　その代わり、テーブルに対してでは無く、フィールドに対してアクセス権限を設定します。 　当然、このようにセキュリティーを強化する場合、ブログを表示するためのプログラムと、会員情報をも扱うプログラムは、別々のＩＤでデータベースにアクセスすることになります。会員情報を扱うＩＤにはテーブル全体に対する権限を許可して、ブログを表示するＩＤには、ブログ情報のフィールドのみにアクセス許可を与えておくわけです。 　ブログを扱うプログラムは、どうあがいても、会員情報にアクセスすることは出来ません。 　同じＩＤでデータベースにアクセスするのであれば、テーブルをいくつに分けようが、セキュリティーは強化されません。 　さて、不正侵入を考えます。ルートが破られれば、何をどうやっても漏洩の阻止は不可能です。 　アクセスするためのＩＤを分けてあれば、最悪、ブログ情報用のＩＤに関しては破られても、会員情報へのアクセスは出来ません。漏洩するのは、ブログ情報だけです。会員情報が破られたら、テーブルを分けていようが同じテーブルだろうが一緒のことで、全データが漏洩します。 　また、データの保全という意味では、どうせ、データベースが壊れたら、テーブルをいくつに分けていようがデータベース丸ごと壊れますから、一緒のこと。　 　となると、検討するのは、どちらの方が保守管理が楽になるかです。 　もう一つの検討課題は、テーブルを分けると、会員情報全体を集約する時に、テーブルの結合が余計に発生します。 　また、テーブルを分けた時には、memberテーブルにある会員にのみ、blog詳細テーブルの情報を作るように、整合性を保証する必要があります。普通は、テーブル定義の時に、参照性制約を定義して保証するのですが、ＭｙＳＱＬでは、ファイル形式の選択によって、之が出来るかどうかが変わるところには注意が必要です。 　後は、動機と環境によりますね。 　シンプルさを考えるなら（当然、保守性はシンプルなのが一番です。）、わたしなら、１テーブルにします。
普通にできると思いますが、varcharなどは可読性のあるデータの方がよいので 改行みたいなものはむしろはじいた方がいいと思いますが
limit ? offset ? に数値を入れるときだけは、必ず、bindValueでPDO::PARAM_INT　の型指定必須です。 ここだけは、 "1" と入れると、syntax error になるので。 それ以外の所では、既に回答があるように、暗黙の型変換があるので、ほぼ、PDO::PARAM_STRで問題ありません。
こんにちは。 下記のようにsubstringとcharindexを使えばできます。 例文を作成しましたので、下記のSQLを実行してみてください。 DECLARE @Str nvarchar(100) SET @Str = N'こんにちは。山田です。会員番号123456です。ありがとうございます。' --#### 結果 SELECT SUBSTRING(@Str, CHARINDEX('会員番号', @Str), 10) SET @Str = N'こんにちは。会員番号561257です。' --#### 結果 SELECT SUBSTRING(@Str, CHARINDEX('会員番号', @Str), 10)
わざわざキーワードと例文の組み合わせをつくらなくても 例文だけあげてあれば全文検索でマッチさせることはできそうですね むしろそうではないならthisやwearsもマッチするので bigとshoesだけ抜き出すロジックが必要です また複数形や三単現やら微調整はどうするのでしょうか？ shoesはshoeとwearsとwearを同一とみなすならなにか調整が必要
windows8でXAMPPを利用しています。 ただ、XAMPPのサイトから落としてきたわけではなくeclipseのサイトからPHPバージョンの最新版をダウンロードしてそれに付属しているXAMPPを利用しています。
> tbl家族（テーブル名） > 顧客NO > 家族名 > 誕生日 > 性別 本人に加え1名しか持てませんよ？ 枝番号持たせるとか
SQLサーバーにはユーザーばかりでなくグループも設定出来ます。SQL　Serverを扱えるグループを設定し、SQLサーバーに登録し、SQL　Serverを扱うユーザーにそのグループを設定すれば、個々にユーザーをSQL　Serverに登録する必要は無くなります。
SQL Server はインストール時にその辺の必要な環境をチェツクしてダメならインストールを中止し、何が足りないかを知らせます。 ですからまずはインストーラーを走らせるのがいちばん早いです、
こんにちわ。 > Oracle10.2.0.5 x64(windowsServer2008x64)ではコンパイルエラーになります。 > （Ora-00918）列定義が未確定がでます。 > 64bitでなにかあるのでしょうか？ Bit 数の違いよりも、Patch Level の違いが影響している可能性が高いです。 エラー発生箇所で参照しているオブジェクトの定義が、10.2.0.3 と10.2.0.5 で差異があるのでは無いでしょうか？ エラーになっているSQL とそのSQL が参照しているオブジェクト定義を確認 して見て下さい。 ORA-918 は、同一ビュー (テーブル) に同じ列名が複数回出現するような 場合に発生するエラーですが、稀にV$ やX$ でそのような事があります。
せっかくなので軽く書いてみましょう まず元になるデータを羅列します （元テーブル） ID,英単語ID,英単語,意味ID,意味,分類ID,分類,品詞ID,品詞,難易度 1,1,eye,1,目玉,1,物体,1,名詞,2 2,1,eye,1,目玉,2,体,1,名詞,2 3,1,eye,2,視力,3,能力,1,名詞,2 4,2,hand,3,手,1,物体,1,名詞,3 5,2,hand,3,手,2,体,1,名詞,3 6,2,hand,4,拍手,4,行為,1,名詞,4 これを正規化します （正規化後） 英単語テーブル 英単語ID,英単語 1,eye 2,hand 意味テーブル 意味ID,意味 1,目玉 2,視力 3,手 4,拍手 英単語_意味テーブル 英単語ID,意味ID 1,1 1,2 2,3 2,4 分類テーブル 分類ID,分類,品詞ID 1,物体,1 2,体,1 3,能力,1 4,行為,1 意味-分類テーブル 意味ID,分類ID 1,1 1,2 2,3 3,1 3,2 4,4 品詞テーブル 品詞ID,品詞 1,名詞 これをSQLで書くと CREATE TABLE `英単語テーブル`(`英単語ID` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,`英単語` VARCHAR(50),UNIQUE KEY(`英単語`)); CREATE TABLE `意味テーブル`(`意味ID` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,`意味` VARCHAR(200),`分類ID` INT,`難易度` INT,UNIQUE KEY(`意味`)); CREATE TABLE `英単語_意味テーブル`(`英単語_意味ID` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,`英単語ID` INT,`意味ID` INT,UNIQUE KEY(`英単語ID`,`意味ID`)); CREATE TABLE `分類テーブル`(`分類ID` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,`分類` VARCHAR(200),`品詞ID` INT,UNIQUE KEY(`分類`)); CREATE TABLE `意味_分類テーブル`(`意味_分類ID` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,`意味ID` INT,`分類ID` INT,UNIQUE KEY(`意味ID`,`分類ID`)); CREATE TABLE `品詞テーブル`(`品詞ID` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,`品詞` VARCHAR(20),UNIQUE KEY(`品詞`)); //データの追加 SET @a='eye',@b='目玉',@c='物体',@d='名詞',@e=2; INSERT IGNORE INTO `品詞テーブル`(`品詞`) VALUES(@d); INSERT IGNORE INTO `分類テーブル`(`分類`,`品詞ID`) SELECT @c,`品詞ID` FROM `品詞テーブル` WHERE `品詞`=@d; INSERT IGNORE INTO `意味テーブル`(`意味`,`分類ID`,`難易度`) SELECT @b,`分類ID`,@e FROM `分類テーブル` WHERE `分類`=@c; INSERT IGNORE INTO `意味_分類テーブル`(`意味ID`,`分類ID`) VALUES((SELECT `意味ID` FROM `意味テーブル` WHERE `意味`=@b),(SELECT `分類ID` FROM `分類テーブル` WHERE `分類`=@c)); INSERT IGNORE INTO `英単語テーブル`(`英単語`) VALUES(@a); INSERT IGNORE INTO `英単語_意味テーブル`(`英単語ID`,`意味ID`) VALUES((SELECT `英単語ID` FROM `英単語テーブル` WHERE `英単語`=@a),(SELECT `意味ID` FROM `意味テーブル` WHERE `意味`=@b)); 最初のset行を SET @a='eye',@b='目玉',@c='体',@d='名詞',@e=2; SET @a='eye',@b='視力',@c='能力',@d='名詞',@e=2; SET @a='hand',@b='手',@c='物体',@d='名詞',@e=3; SET @a='hand',@b='手',@c='体',@d='名詞',@e=3; SET @a='hand',@b='拍手',@c='行為',@d='名詞',@e=4; SET @a='cat',@b='猫',@c='動物',@d='名詞',@e=1; SET @a='cat',@b='連結する',@c='動作',@d='動詞',@e=5; のようにして順次INSERT を繰り返します。 場合によってはプロシージャやファンクションにしてもいいでしょう。 結果表示はこんなかんじ SELECT T1.`英単語ID`,T1.`英単語`,T2.`意味ID`,T3.`意味`,T4.`分類ID`,T5.`分類`,T5.`品詞ID`,T6.`品詞`,T3.`難易度` FROM `英単語テーブル` AS T1 INNER JOIN `英単語_意味テーブル` AS T2 ON T1.`英単語ID`=T2.`英単語ID` INNER JOIN `意味テーブル` AS T3 ON T2.`意味ID`=T3.`意味ID` INNER JOIN `意味_分類テーブル` AS T4 ON T3.`意味ID`=T4.`意味ID` INNER JOIN `分類テーブル` AS T5 ON T4.`分類ID`=T5.`分類ID` INNER JOIN `品詞テーブル` AS T6 ON T5.`品詞ID`=T6.`品詞ID` ORDER BY `英単語ID`,`意味ID`,`分類ID`,`品詞ID`;
詳しく検証していませんが、単にダブりを表示しないだけなら SELECT DISTINCT カラム FROM テーブル で十分かと
デバッグ時の環境と、サーバーマシンで動作させようとしている環境との 違いを確認してください。 何が同じで何が異なるのか？ 特にDBサーバーは同じか? ドメイン環境か? SQLサーバーへのアクセス時のログインは SQLサーバー認証かWindows認証か? を書いてください。 質問をざっと見た感じでは アクセスしているDBサーバーが異なるか、 ログインユーザーが異なるか のどちらかだと想像します。
pg_hba.confに無線LAN時のPCのIPアドレスを追加してみてはどうでしょう？ （例） host all all 10.0.21.0/24 password 追加後再起動です。
単にphpMyAdmin上の文字化けだけなら $cfg['DefaultLang'] $cfg['DefaultConnectionCollation'] $cfg['DefaultCharset'] あたりの設定を調整してみてはいかがですか？
NotInList イベントはコンボボックスに無いデータを入力したときに発生します。 >もし、コンボボックスの内容に対応するレコードがなかった場合 にフォームに新たなレコードを追加したいのですから >コンボボックスを使ってレコードを検索するコードを に書き加える形になります。 分からなければ、レコードを検索するコード、 コンボボックスのコントロールソースまたは値集合ソース、 それとフォームのレコードソース、 以上３点を提示ください。
例の疑似コードでは別に問題点が見つかりませんので、 実際のコード中のどこかにバグがあるんだと思います。 『(1)で取得した値が+1されているかどうか』を第１歩として コードレベルの誤りを探すしかないです。 おそらく(1)の時点では+1した値が取れているのに、(2)～ (3)の処理に問題があってデータが更新されていないので はないかと推測します。
古い人間なので現状にあっていなかも知れませんが経験より。 このシステムはオンラインで、月次にバッチでメンテが出来るような環境であると想定しました。また、DBMSの物理的なキャッシュなどは考慮していません。 (1)削除フラグを使う この目的は「消しちゃったけど戻したい」が主たる目的です。この条件でなければ、また、大量の削除でなければ、オンラインでのdeleteでも良いと思います。レコードが減る分、バックアップが楽になります。 (2)カラムに入っている内容を削除する nullか空白でupdateするということですよね。インデックスにレコードが残るという観点ではメリットはないでしょう。検索において、削除されたレコードは取得されないので関係ないと思います。 (3)オンラインでの削除 deleteすることによってレコードが減ればそれだけインデックスが軽くなり(なれば)検索は早くなる可能性があります。ただし、これは非常に稀です。 (4)性能 「削除フラグを使う」でdeleteで良いと書きましたが実は「削除フラグ」という考え方は正しいかも知れません。 インデックスが張られているでしょうからこれらも更新の対象になります。 昔(10年前)では、I/Oは大体10ms/1件といった感じです。これは、update、delete、insert、インデックス更新が該当します。 例えば、3個のインデックスがあるテーブルで考えてみます。「削除フラグ」を使う場合、削除されたレコードを読み込まないために、すべてのインデックスに削除フラグが関連するはずです。 削除フラグを立てて他の列を空白等でupdateする場合、 [1]select　for　update　;1行確定 [2]update　;1行更新 [3]インデックス更新　;インデックス1 [4]インデックス更新　;インデックス2 [5]インデックス更新　;インデックス3 の5回のI/Oが発生します。約50msかかる計算です。 また、deleteでは、 [1]select　for　update　;1行確定 [2]delete　;1行削除 [3]インデックス更新　;インデックス1 [4]インデックス更新　;インデックス2 [5]インデックス更新　;インデックス3 の5回のI/Oが発生します。約50msかかる計算です。 オンラインでの性能面から見るとどちらも同じようになります。 結局はインデックス更新にも引っ張られますので、オンラインでの処理ではどちらでも良いということになります。 オンライン以外の性能ではdeleteした方がレコード少なくなるだけメリットが有るように感じます(レコードは少ないに越したことな無いです)。 長々と書きましたが、私はユーザ要件によって削除フラグを使うか否かを決めていました。 間違えた削除を戻す必要がないならdeleteで良いと思います。 メンテについてですが、容量に応じて色々な方法が考えられます。 件数が多くなるようでしたらファイルに吐き出して、削除レコードを削除し、LOADERで入れ込むことも考えられます。 MySQLはロックリソースが必要でしょうから(詳しく知りません)、想定件数で仕組みを考えるべきと考えます。
質問1： 　BOOLEAN型(TRUE/FLASE型)があるDBの場合はこれを 　使ったほうが良いですが、mysql には無いので数値で代替 　するしかありません。 　0 の意味を忘れないように (0 は削除・未削除のどっちだっ 　け？とならないように) 注意してください。 質問2： 　検索は速くなりません。しかも登録 (INSERT/UPDATE) が 　遅くなるので付けないほうがマシです。 　 　何故 検索が速くならないのか、何故 登録が遅くなるのかに 　ついては、きちんとインデックスの仕組みを学習してください。 　良いシステムを作るには、きちんと仕組みを知ることが必須 　です。 質問3： 　たいていの場合は SQL のほうが速いでしょう。 　DB関連の処理は『なるべくまとめて処理する』『不要なデータ 　は取得しない』ことが処理速度アップの基本です。
＞;extension=php_sqlite.dll エラーは、上記行の先頭にコメントアウトがあるせいだとは思うけど、 sqlite_open関数群は、sqlite２用です、SQLite3のデータファイルは扱えません。 SQLite3　を利用するなら、PDO または、SQLite3 クラスしか有りません。
別回答があるとおり、やってできないことはありませんが 連番でデータをつける意味はあるのでしょうか？ データを削除した場合結局抜け番が発生して連番状態はくずれます。 連番を前提に設計をすると思わぬ落とし穴があるかもしれません。 通常データの投入順をみるだけならauto_incrementされたカラムを みればいいので、c1,c2の組み合わせを取ることは無駄だと思います
　・where句をつけると、当然、where内の条件を解決しないといけませんので、統計情報のみで答えを返すことが出来ません。基本的には、テーブルを見に行くことになります。ただし、where sure_id=5において、該当のテーブルのsure_id列にインデックスがついていれば、インデックススキャンのみで終わる可能性が高いです。 　・count(*)とcount(name)の間で、早い遅いはありません。が、この二つ、ｎｕｌｌの扱いにおいて関数の意味が違うので注意してください。普通は、この意味で使い分けをします。 　count関数は、基本的に、nullを数えません。 　count(*)だと、全列nullの行のみが数えない対象となります。 　しかし、count(name)とすると、name列がnullのデータは数えてもらえなくなります。 　name列にnullが入らなければ、count(*)とcount(name)は等価ですが、nullが許されると意味が違うというです。
teratermを利用しているなら、サーバー上にファイルを作っておいて ファイルメニューのSSH SCPで簡易的なダウンロードができます
あ、見直してたら、テーブルエイリアス名の抜けを発見。 sum(nedan)　のところ、２カ所とも、b エイリアスを加えて下さい sum(b.nedan) 実行チェックまで行ってないのがばればれ。
1レコードにどのくらいの容量があるかにもよりますが csvを一度テンポラリに保存して 重複チェックなどはテーブル同士のリレーションでおこない エラーのものはエラーテーブルに吐きだして削除し 残ったテンポラリのテーブルを結合しながら他のユーザーテーブルなどに 吐きだしていくとそれなりに速くなると思います
単にためておいて要求に応じて表示だけすればいいのであれば TEXTやBLOBあたりになるでしょう 容量が多いのであればLONG系の拡張が必要です。 また保管された内容から文字列の検索が必要な場合は char、varcharなど検索性の高い型が必要ですが、容量には制限があります 全文検索を想定する場合はデータ型だけでなくエンジンの選定に注意が必要です
こんなかんじ //元データ create table tbl (日付 date,入出金 int); insert into tbl values('2014-02-04',1000000),('2014-02-10',-100000),('2014-02-25',+200000),('2014-02-27',-10000); //集計 select t1.日付,sum(t2.入出金) as 残高 from tbl as t1 inner join tbl as t2 on t1.日付>=t2.日付 group by 日付;
　以前、連続２年上昇を考えたことがありますよね。 　連続２年減少なら、簡単です。前回のＳＱＬの不等号をひっくり返すだけ。 　本当に問題の表現が正確であるのならば、 select sm.year, sm.sale from sales sm where not exists( 　　　　select sc.year, sc.sale 　　　　from sales sc join sales s1 on s1.year = sc.year -1 　　　　　　　　　　　　join sales s2 on s2.year = sc.year - 2 　　　　where s1.sale < s2.sale and sc.sale < s1.sale and sm.year=sc.year) 　で、いけるともおいます。 　サブクエリの中でやっていることは、２年連続で減少しているレコードの一覧の抽出です。前回のＳＱＬと同じ方法ですね。 　これをnot existsで否定しています。 　さて、恒例の問題への条件です。 　今回は、「減少していない」という表現だったので、前年度・前々年度が存在しない場合も含みます。実は、そのために、ＳＱＬが少々複雑な表現になっています。こうしないと、ＮＵＬＬの扱いが面倒なんです。存在しない年度との比較結果は、「減少していません」としています。増加もしていないし、同値でも無いんですけどね。 　yearがきちんと一意であるか一意化できることが前提になるのは、前回の２年連続増加と同じです。
アクセスでは、大名リストテーブルと呼び出しテーブルの二つのテーブルを作ります。そしてリレーションシップを呼び出しテーブルの番号と大名リストテーブルの番号の間につくり、1対多の設定にします。クエリーをつくり二つのテーブルを乗せておいて、クエリーを実行させると、ご希望の結果が得られます。
(1)と(2)からデータを取得するクエリの結果をインポート用のテーブルに入れるならば、次のようにすればできます。 リレーションは必要ありません。 簡単なのはコピー＆ペーストですが、クエリとマクロの組合わせで自動化もできます。 ・コピー＆ペースト 　　１．インポート用テーブルのデータをすべて削除する 　　２．クエリで検索した全データをコピーする 　　３．インポート用テーブルにペーストする ・クエリを手動実行 　　クエリを準備します 　　　インポート用テーブルのデータを削除するクエリを作成します 　　　(1)と(2)からデータを取得するクエリをコピーして「追加クエリ」にする 　　　　※Accessのバージョンが書いてありませんが、メニューかリボンに 　　　　　「追加」か「追加クエリ」というのあるはずです 　　　　　追加クエリにするときに追加先のテーブルの各項目との関連づけをします 　　　　　同じ項目名なら自動で設定されます　　 　　１．インポート用テーブルのデータ削除するクエリを実行する 　　２．(1)と(2)からデータを取得する「追加クエリ」を実行する ・マクロで実行 　　上のクエリを手動実行で作成した２つのクエリを順に実行するようにマクロを 　　作成して実行します 今あるクエリ等を修正するのではなくコピーをしてから試してみることをおすすめします。
文字コードがおかしいんじゃないでしょうか。 DreamWeaverじゃなくて、例えばサクラエディタで開いてみたらどうでしょう。そして元のファイルはEUC-JPになっているでしょうからそれをUTF-8で保存します。そしてFileZillaのところからやり直してみるといいでしょう。 とにかく、pg_dumpで出力されたファイルの中身をEUC-JPからUTF-8に変換してからpsqlで取り込むと良さそうかと存じます。
＃１さんの回答へ横レスさせて下さい 文字列中に”を含めたい場合は、２重に書くとOKです。 ｓｔｒSQL = "select 次回検査日 from 管理台帳クエリ where 最終検査日 <= DateAdd("”yyyy””,-[検査周期], #" & txtDate & "#)"
>>指定した曜日、日付でもいいので簡単に入力出来ないかと思っています。 そのような事は出来るでしょうか？ シフト表を作るようなソフトは市販されています。ですから可能です。 >>出来るのであれば、どのようにしたらよいでしょうか？ ソフトでやりたいことを要件定義としてまとめます。 そして、それを元に、画面と帳票の詳細を決めます。 それから、必要なプログラムを求め、プログラム設計書を作成します。 accessのデータベース設計を行います。 そのあとは、画面、帳票とプログラム設計書に基づいてプログラムを作ります。 それらのプログラムが完成したら、正常に動作するかテストし、問題がなければ完成です。 これ以外にもあるかもしれませんけど、およそ上記の手順で作ればできます。
フリーズしているのではなく、最後にセミコロンを入れ忘れてるだけでは？
>>これで動作させるとエラーになります。 エラーの内容を確認して、エラー原因を取り除いてやれば、うまくいくんじゃあないですか？
ざっと調べてみました どうやらphpMyAdminのバージョンによる仕様のようですね 一度idカラムを削除し、phpMyAdminの構造タブから 1個のカラムを追加する（追加位置は先頭？適当に）として実行し 名前をid、データ型をintとし、nullにチェックをせず、 A_I（オートインクリメント）にチェックをいれた上で保存してください （たぶんその時点で主キー属性がついていると思います）
ちなみにこんな感じ？ $sql="・・・"; $temp=array(); $datas=array(); foreach ($conn->query($sql) as $row) { $data=Array ("商品ID" =>$row["商品ID"],"重量" =>$row["重量"]); if(!in_array($data,$temp)) $temp[]=$data; $key=array_search($data,$temp); $datas[$key]["色"][$row["色"]]=array("価格"=>$row["価格"]); } print_r($datas);
MySQLじゃないからじゃないでしょうか？ MySQL Server Expressなんて聞いたことが無いのですがSQLServerExpressの間違いじゃないでしょうか？ もちろんそれもMySQLではないのですが・・・
user_custom_tableに対して (relational_id,custom_name)にユニークにするか (relational_id,custom_name,custom_value)にユニークにするかで若干書き方が違います 仮に、データ管理がしやすい前者だとすると （所定のユーザーが一つの同名のカスタム名を複数もてないとする） 先にカスタムテーブルで条件を抽出した上でユーザーテーブルの 抽出条件とすればいいでしょう SELECT user_table.* FROM user_table where user_table in (select relational_id from user_custom_table WHERE 0 or (custom_name = 'CompanyAddress' and custom_value LIKE '東京都%') or (custom_name = 'Birthday' and custom_value < '2001/1/1') or (custom_name = 'CompanyName' and custom_value LIKE '%○○%') group by relational_id having count(*)=3 //custom_nameを連結した数 )
select s.year, s.sale from sales s join sales s1 on s1.year = s.year -1 　　　　　　　　join sales s2 on s2.year = s.year - 2 where s1.sale > s2.sale and s.sale > s1.sale order by year で、行けそうな気がしますけど。 　書いてないことで推定した条件は、 　　yearフィールドには重複が無いこと。又は、適切な条件で一意化が出来ること。（この場合は、条件の付加が必要です。） 　　yearが初出又は、２年目の登場の場合には、２年前との比較のしようがありませんので、このような年度は表示しません。 　 　やっていることは単純です。内部結合を使って 　year, sale, year(-1), sale1(-1), year(-2), sale(-2) 　という構造の結合テーブルを構成し、単純に二年前と前年、前年と今年の比較をしているだけです。
select 姓,名,年齢 from テーブル名 INTO OUTFILE "ファイル名.csv" fields terminated by ','; のようにselect文の列名指定を使えばいいのでは？ 詳細は参考URLを 参考URL：http://dev.mysql.com/doc/refman/5.1/ja/select.html
本質的にidというのはレコードを特定するためのものなので インデックスが利いていれば基本的にスピードの差はほぼでないでしょう ＞apple → 0 ＞orange → 1 ＞banana → 2 実務上idに意味のある単語などを用いることは危険です。 appleとしたものの実はgreen appleだったりする場合もあるでしょう idを意味のない数字でもっておけばあとからいくらでも修正が利きます ＞phpMyAdminなどでレコード表を確認した場合、何のidかわかりにくいです リレーションの設定で外部キー制約をつけておけば、所定のコードをクリックして リンク先へ飛ぶことができますよ （仮に上記の例であれば0をクリックしたときappleのデータを表示させられる） ちなみにidに0を利用するのはお勧めできません 1以上の整数を利用してください （他のプログラムとの組み合わせの際,0は特別な意味を持つケースが多いため、 たとえばfalseだったりnullだったり,空文字だったりする）
クライアントツールに関しては製品版もExpress版も同じですので特に問題は有りません。サーバーのインストールに関してはSQL Server2005 Expressもインストールされているようですので、デフォルトではインストールは出来ません。2005Expressをアンインストールするか、アンインストール出来ない場合はインスタンス名を変更してインストールして下さい。通常のインストールではSQLEXPRESSがデフォルトのインスタンス名ですので2005で既に使われているはずです、別の名前に変更すればインストール出来ます。
テーブルをまたがったインデックスは貼れないのでその辺の問題でしょうか 本質的には同じテーブルで管理するしか解決方法はないかもしれません 地道にexplainでチェックしながらindexの利き具合をテストしてみてください
＞このように明らかに文字リテラルが入る箇所 ＞upper(aiueo) 違います。変数aiueoの値をupperに送るという文です。 変数aiueoが定義されていないとエラーが出ていませんか？
詳細な情報が無いので、 「できますよ」としか言えませんが、 注意として、create view するユーザーは 元テーブルへのアクセス権限が必要です。
これはですね。パススルークエリーではなくふつうのクエリーですよね。 この方式ですとデーターセットが使えないと一回でまとめて更新は無理です。つまりAccessではなくC#でSQLサーバーとAccsessを両方使うとかなら出来ます。 データーセットに読み込めばソースの形式は何でも構わないので。メモリ上に展開してメモリでリレーションを掛け更新もできます。 もしどうしてもAccessを使いたい場合は本当にパススルークエリをプロフラムでその都度作るしかありません。そのパススルークエリーを元にさらにふつうのテーブル作成クエリを作成しDoCmdなどで実行するしかありません。 まずパススルークエリを作成する前に、同じクエリは削除します。 　　Dim CAT As ADOX.Catalog On Error GoTo errc Set CAT = New ADOX.Catalog Set CMD = New ADODB.Command Deleteobj = True CAT.ActiveConnection = CurrentProject.Connection If CAT.Procedures.Count > 0 Then For Each i In CAT.Procedures If i.Name = クエリの名前 Then CAT.Procedures.Delete (i.Name) End If Next Exit Function End If そのあとに新しいSQLでパススルークエリのオブジェクトを作成します。 　　 qd.SQL = "SELECT * FROM MAINDATA WHERE((DATE>=" & str月初 & ") And (DATE<=" & str月末 & "))" Set CMD.ActiveConnection = CAT.ActiveConnection CMD.CommandText = qd.SQL CMD.ActiveConnection.Properties("Jet OLEDB:ODBC Command Time Out") = 0 CMD.Properties("Jet OLEDB:ODBC Pass-Through Statement") = True CMD.Properties _ ("Jet OLEDB:Pass Through Query Connect String") = _ "ODBC;DRIVER=SQL Server;SERVER=" & server ";DATABASE=" & database CAT.Procedures.Append クエリの名前, CMD CAT.Procedures.Refresh これでAccessにクエリオブジェクトが作成されています。 テーブル作成クエリは予め作成しておいても構いません。名前は同じなので。 この後にそのテーブル作成クエリを実行します。
記載のSQLをインラインビューにすればいいのではないでしょうか。 select * from ( select *,(select count(*)+1 from card as c where c.n < card.n) as idx from card ) where ...; という感じです。 参考までに http://ideone.com/uSQ3fe
入力フォームは送信前に確認画面をだすはずです 確認画面で表示されたのものと保存されるものが異なれば明らかにバグです きちんとやるなら確認画面時点でデータの整合性をとるべきです
一般論として 一番考えられるのがコンパイルが動作する場合ですね。 ストアドプロシャを修正後 最初の実行はコンパイルされるので、少し時間がかかります。 二回目以降は速くなります。 質問の内容からこのケースに該当するかどうかは不明ですが、 コンパイルされる条件は他にもいくつかあるようです。 以下も参考にしてください。 http://engineermemo.wordpress.com/2013/08/02/%E3 …
>現在、ＤＢ移行（が可能かどうか）の第一段階目として、 >とりあえず１行（１レコード）を文字化け等なしで抽出する方法を模索しております。 私の説明が悪かったのかもしれませんが、レコードレイアウトがわからないとそれができないのです。 私のいうレコードレイアウトは何バイト目～何バイト目が商品コードとかいうものではなく 何バイト目～何バイト目が1バイト整数 何バイト目～何バイト目が2バイト整数 何バイト目～何バイト目が4バイト整数 何バイト目～何バイト目が4バイト浮動小数点 何バイト目～何バイト目が8バイト浮動小数点 何バイト目～何バイト目がテキスト など、そこが何の型のデータなのかです。 例えば2バイトで構成されたレコードがあり、そのうちの1レコードの16進ダンプが 30 31 だった場合、 1バイト整数が2つと見るなら 48,49 ですし 2バイト整数が1つと見るなら 12592(ビッグエンディアンなら12337) テキスト(ASCIIコード)と見るなら "01" など何の型のデータとして見るかによって得られるデータはまったく変わります。 これがわからない状態で「文字化け等なしで抽出」といったことができると思いますか？
「rooms.idが重複しないもののみ抽出」 ということなので、重複しているrooms.idのレコードは１件も出したくないのなら、 SELECT max(R.updated_at), R.id, max(R.public), max(M.room_id), max(M.sendfrom_list_id), max(M.sendto_list_id), max(M.body) FROM messages AS M, rooms AS R WHERE R.public = "t" AND M.room_id = R.id GROUP BY R.id HAVING count(*) < 2 ORDER BY R.updated_at DESC; ででると思うけど ・・・blobとかの型（つまりmax()を使えない型）の項目があればだめですが。⇒別のやり方有り。
通るでしょう。何が問題点
>結果NULLが返されるのはなぜでしょうか @結果＝@結果＋@会社名 最初の@結果か、いずれかのレコードの@会社名に Nullが１つでもあれば、Nullになりますが。 @結果＝ 'ABC' + null は、 @結果がnullになります。
> ちなみに、得意先CDのIN句を抜くとちゃんとデータは抽出されます。 IN の内のSQLのみ別クエリとして保存し実行したらどうなりますか？ select [T_得意先]![得意先CD] from [T_得意先] Where [T_得意先]![抽出フラグ] = True； だけで。 テーブル名!列名で、テーブル名が長いとチェックしづらく無いですか？ T1やT2のような別名付けて正式名はFromにのみ残し、 SelectやWhereはT1やT2で修飾したほうがデバッグしやすいですよ
＞プライマリーキーはつけといたほうがいいでしょうか？ 普通付けますが、必須ではないです。 ＞プライマリーキーがないとプライマリーキー以外のカラムをselectするとき遅くなるのでしょうか？ それは関係ありません。 ＞プライマリーキーのカラム名はid以外でもいいですか？ もちろんOKです。 ＞phpmyadminからindexを他のカラムにつけた場合はそのカラムにindexつけた後に追加された行も自動的にindexがついていますか？ indexは、カラムや複数カラムに付く物です。行の挿入削除変更でindexは自動的に更新されます。
> フィールド1はＩＤ番号です。 ということは、オートナンバという事を言いたかったのでしょうか オートナンバであれば、以下の SQL でいけると思います INSERT INTO テーブル名(フィールド2,フィールド3,フィールド4) SELECT フィールド2,フィールド3,フィールド4 FROM テーブル名 WHERE フィールド4='巨人'; オートナンバ、いやいや自分で採番・・・テーブルによってはいろいろあると思います いろいろ対応できるかな・・・　というものを作ってみました Public Sub fncRecCopy(sTable As String, sFld As String _ 　　　　　　　　　　, Optional bAn As Boolean = False _ 　　　　　　　　　　, Optional sWheres As String = "") というインターフェイスになるのですが、 使い方（指定方法）は、 sTable　：　テーブル名 sFld　：　フィールド名の列挙　（,）カンマ区切り 　　　　　先頭が採番するフィールド bAn　：　その先頭のフィールドがオートナンバなら True を指定（既定：False） sWheres　：　抽出条件以降の記述（既定：条件なし） Call fncRecCopy("テーブル名", "フィールド1,*", True, "フィールド4='巨人'") とすると、前述SQLでの処理と同じになります ※ 処理性能は、SQL一発の場合より遅くなります フィールド1 がオートナンバでなければ Call fncRecCopy("テーブル名", "フィールド1,*", False, "フィールド4='巨人'") とすれば、フィールド1 を採番します フィールド部分の列挙を "フィールド1,*" ↓ではなく "フィールド1,フィールド3,フィールド4" とした場合、指定されたフィールド部分しかコピーしません コピーするレコードの順が必要なら、条件以降に ORDER BY 記述します "フィールド4='巨人'" ↓例えば "フィールド4='巨人' ORDER BY フィールド1" ※ 汎用的にするには ・Where 指定と、 ・ORDER BY 指定は 分けた方が良いんでしょうけど 標準モジュールに記述して利用します Public Sub fncRecCopy(sTable As String, sFld As String _ 　　　　　　　　　　, Optional bAn As Boolean = False _ 　　　　　　　　　　, Optional sWheres As String = "") 　　Dim rs As New ADODB.Recordset 　　Dim rsC As ADODB.Recordset 　　Dim sSql As String 　　Dim i As Long, j As Long 　　Dim iM As Long 　　sSql = "SELECT " & sFld & " FROM " & sTable 　　If (Len(sWheres) > 0) Then 　　　　sSql = sSql & " WHERE " & sWheres 　　End If 　　sSql = sSql & ";" 　　If (Not bAn) Then iM = DMax(Split(sFld, ",")(0), sTable) 　　rs.Open sSql, CurrentProject.Connection, adOpenStatic, adLockOptimistic 　　Set rsC = rs.Clone 　　For i = 1 To rs.RecordCount 　　　　rsC.AddNew 　　　　For j = 1 To rs.Fields.Count - 1 　　　　　　rsC(j) = rs(j) 　　　　Next 　　　　If (Not bAn) Then 　　　　　　iM = iM + 1 　　　　　　rsC(0) = iM 　　　　End If 　　　　rsC.Update 　　　　rs.MoveNext 　　Next 　　rsC.Close 　　Set rsC = Nothing 　　rs.Close End Sub ※ エラー処理は入れてません ※ 不都合あれば、変更するとか・捨てるとかしてください エラーがあったら、エラー番号を返す様に Function にするとか・・・
"Base Directory"そのものにも空白があります。 そのため、 (略)DO IF "%%A %%B"=="Base Directory"(略) と指定しないと見つからないようです。 "Program Files"の空白の処理が面倒な気がします。 "ProgramFiles"とかにインストールされていると空白の数が違ってきますので。 コマンドプロンプトで REG QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\PostgreSQL\Installations\postgresql-9.0" /v "Base Directory" を実行して結果を見るとわかりやすいです。
rollupするとよいです select ym,sum(score) as sumscore from data where code=10020 group by ym with rollup
追記。 ANo.4のクエリを 主TBL：700レコード 副TBL1～10：100レコード の１１個のテーブルで結合してみたが、まったく問題なく動作した。 動作環境は、あえて WinXP Pro SP3 Access97 メモリ768MB CPU Celeron CPU 2.5GHz というチープな環境にしてみたが、まったく問題が無かった。
>「OR検索」が多発するため、索引がうまく使用されず、件数が増えると >すぐに遅くなると思います。 多分その通りと思います。 特に、指定無し（あるいはすべて指定）があるために頭が痛いことになります。 ⇒指定なしの場合もいちいち検索条件に指定するのか、しないのか。 また、名称などのあいまい検索が含まれることも考慮しておいたほうがいいと思います。 例えば店名のあいまい検索など。 >index_merge である程度、効果があるのでしょうか。 条件が多すぎると、期待薄としか思えませんが。 対策としては、 条件検索用テーブル（インデックス付き）と 情報格納用テーブル（プライマリキーのみ）を分けるというのも ひとつの方法かと思います。 例）レストラン レストラン情報テーブル　 レストランＩＤ、レストラン名、ジャンル（和洋中・・・）、地域・・・・ レストラン名検索テーブル レストラン名、レストランＩＤ ジャンル検索テーブル ジャンル、料理種別、レストランＩＤ 地域検索テーブル 地域（必要に応じて複数階層）、レストランＩＤ ・・・ 検索画面 店名：（指定無し） 料理長名：（指定無し） ジャンル：北京料理、上海料理にチェック 料理種別(ジャンルに従属)：ラーメン以外の全部にチェック 都道府県：東京都を選択 市区町村：千代田区、江戸川区にチェック 地域：すべてを選択 営業時間区分：（指定無し） 朝昼夜区分：（指定無し） 客単価：千円未満、二千円未満、三千円未満を選択 ・・・ 検索方法（条件が指定されたところだけinner joinで条件検索用テーブルを追加。） select * from レストラン情報テーブル tx inner join ジャンル検索テーブル t2 on tx.レストランID = t1.レストランID and t2.ジャンル in (北京料理,上海料理) and t2.料理種別 in (・・・) inner join 住所検索テーブル t3 on t3.都道府県 in (東京) and t3.市区町村 in (千代田区,江戸川区) ・・・・ /* inの中の漢字でかいたところは、おのおのに相当するコード */ といった感じ。
答えやすい質問から・・・ 　・基本的には前日のデータに戻すような対応をする契約です 　 　　これで問題ないのであれば、完全バックアップモードから 　　単純バックアップモードへ設定変更してしまうことが一番手っ取り早く 　　以後の運用設計や運用が楽になります。 　　その代わり、障害が発生した場合には必ず最後の完全バックアップを 　　とったタイミングまで巻き戻ってしまいます。 　・ログファイルのバックアップは上書きしていき、 　　データの完全バックアップのみNヶ月分残すというような運用でも 　　問題なく復元できるのでしょうか？ 　　問題ありません。 　　厳密に言うと、最後にフルバックアップをとってから、次のフルバックアップを 　　とるまでの間のトランザクションログバックアップがあれば問題ありません。 で、いろいろ考える前に急がば回れの典型例になっていますので、 落ち着いて次の自習書を読むことをお勧めします。 http://go.microsoft.com/?linkid=9820534
はて？おかしいですね サブクエリの部分 select sure_id,max(dt) from bbs group by sure_id だけ実行すると 1 2014-01-04 19:19:45 2 2014-01-12 01:37:03 5 2014-01-04 18:30:47 6 2014-01-03 19:02:26 が返ってきますよね？ であればそれで絞り込んでいるので重複がでるはずがないのですが・・・ （完全にスレッド番号と日時が同じであればダブるのでその場合は distinctするなりする必要はあるかも） なにか特殊な処理を別途施していたりしませんか？
訂正： 先ほどの回答で、>= はすべて、> が正しいです。 追記： 回答後、前の方の回答を再度見てみました。 直前の回答で「補足」としたところに書いた内容から、 where starttime <= reng * 60 and endtime >= (reng + 1) *60 を where starttime < reng * (60 + 1) and endtime > reng *60 にすればいいのじゃないかな？ って感じでしたが、詳細は未確認。
WHERE条件に「全ての列がNullで無い」を指定したら、personal_idを網羅できますか？ 同一ｉｄで複数行出てこないなら、そこから取得する。 複数行出るなら、Topキーワード使って一行に絞れば良さそう。 updateのwhere条件には、更新対象列 is Null入れとけば良いし。
Viewとなると、正直提示された情報だけでは原因特定は厳しいので、 まずは実行計画を確認してみると良いかと思います。 後はもう少し情報を増やす意味で次のオプションをつけてみるのもいいかと。 ----- set statistics io on set statistics time on set statistics profile on go <調査したいクエリ> go set statistics profile off set statistics time off set statistics io off go -----
INSERT文になって再度発行処理をすればいいだけです。 Dim cmd As New OleDbCommand( "INSERT INTO table1 (オペレータ名, ランク, 補足, パスワード) VALUES " & "(?, ?, ?, ?)", cn) cmd.Parameters.Add("ランク", OleDbType.Integer).Value = RANK cmd.Parameters.Add("パスワード", OleDbType.Char).Value = PWORD cmd.Parameters.Add("補足", OleDbType.Char).Value = HOSOKU cmd.Parameters.Add("オペレータ名", OleDbType.Char).Value = OPE cmd.ExecuteNonQuery() ところでcn.Open()の後にcmd.ExecuteNonQuery()が2回もありますが、1回で十分です。
＞MyISAMの違うテーブルに同時アクセスできるのでしょうか？ テーブルが異なればどのエンジンでも同時アクセスは問題ないとおもいます ＞2chのようにスレッド掲示板にしたいのですが、テーブルは2つで作れると考えました（スレッドとレス）スレッド番号でレスをまとめるやり方です ＞このような1つのテーブルでレスをまとめた場合、複数のカラムにindexをつけると将来100万行とかになっても軽快に動きますか? テーブルは1個で管理してもいいかもしれません。 親文書がなければスレッドだと判断できるので ただ古いログはパフォーマンスを下げるだけなので 古いデータや所定の上限数までいったデータをdat落ちさせる仕組みを作った方が よいかもしれませんね
こんな感じです select clm2 from test where clm1 in(2,4,6) group by clm2 having count(distinct clm1)=3
いくつか見えていない要件がありますので以下にサンプル的に書いてみます。 ＜業務の手順＞ (1)お問い合わせフォームまたは電話にてお申込み連絡を承ります。サービスの利用が可能かを確認致します。 ここで基本的な会社の情報をいただきます。メールにて送信。 ↓ (2)メール確認後、ご訪問、電話にてご説明。 弊社担当よりサービスのご案内・利用方法についてご説明させて頂きます。 ↓ (3)クライアントがサービス利用と判断された場合は利用に必要な項目を確認、取得します。 ↓ (4)サービス利用時に登録テーブルを参照（他）を行う。 ＜方法１＞　仮登録も本登録も同一テーブルで管理 登録テーブル　登録区分　0:仮登録/1:本登録/9:本登録しない(退会とかも必要なはずですが) (1)登録テーブルに登録区分0で基本的情報を登録 (2)登録テーブルの情報更新：登録区分0のまま、更新処理。または、登録区分9に変更。 (3)登録テーブルの情報更新：登録区分1に変更。 　このとき未入力データがあってはいけない項目の未入力チェックを行う。 　（プログラムでチェックしないとやりにくい） (4)登録テーブルを参照（登録区分1のみ） ☆仮登録や本登録した件数が増えると、(4)のときの処理が遅くなる。また、管理しにくい。 ⇒本登録したデータだけ別にすると（方法２） ＜方法２＞　本登録したデータは別テーブルで管理 仮登録テーブル　登録区分　0:仮登録/9:本登録しない 本登録テーブル　登録区分　1:本登録(退会とかも必要なはずですが) (1)仮登録テーブルに登録区分0で基本的情報を登録 (2)仮登録テーブルの情報更新：登録区分0のまま、更新処理。または、登録区分9に変更。 (3)仮登録テーブルの情報削除 　　本登録テーブルの情報登録 　このとき未入力データがあってはいけない項目の未入力チェックを行う。 　（本登録テーブルにNot Nullなどの制約を付けるだけでもチェック可能。） (4)本登録テーブルを参照 ☆仮登録件数が増えると、(2)のときの処理が遅くなる。また、管理しにくい。 ⇒本登録しないデータだけ別にすると（方法３） ＜方法３＞　本登録したデータも本登録しないとなったデータも別テーブルで管理 仮登録テーブル　登録区分　0:仮登録 本登録テーブル　登録区分　1:本登録(退会とかも必要なはずですが) 登録取止テーブル　登録区分　9:登録しない ※登録区分は、なくてもいいですが。 (1)仮登録テーブルに登録区分0で基本的情報を登録 (2)仮登録テーブルの情報更新：登録区分0のまま、更新処理。 　または、仮登録テーブルの情報削除＆登録取止テーブルの情報登録 (3)～(4)は同じ ☆過去に仮登録から本登録あるいは、登録しなかった履歴がほしい ⇒登録履歴テーブルを作って仮登録テーブル削除時にコピーを残す等。 ★ポイント 仮登録も登録の一つとして同一テーブルにもたすか、 仮登録はあくまで登録されていない状態として、別テーブルにおいておくか。 また、仮登録のまま放置されているデータをどうするのか？ （一定期間たったら消すとか考えておかないと無駄なデータが溜まります。） また、サーピス利用の終了（退会）や終了後の再加入はどうするのか？
>この商品の価格や在庫数の1年分（365日分）の履歴をデータベースに記録したいのですが、通常はどのような設計になるのでしょうか？ 例えば、 価格： 価格テーブル 商品コード、適用開始日、価格　 （適用終了日はあっても可：通常は次の適用開始日の前日なのであまり持たない） ※価格が取引先によってまちまちな場合は、価格テーブルに取引先コードがはいっていたり・・・。 在庫： あまり、日単位の在庫数を持っているのを見たことがない。 元帳テーブル 商品コード、（在庫場所）、年月、月初在庫数 入出庫テーブル 年月日、（入出庫場所）、商品コード、入出庫数 入庫と出庫別々で持つため最大で２レコード持つ。 ※毎日の在庫は、上記２テーブルより集計。 ★目的によってどういうテーブルを用意するかは変わってきておかしくないので、 例えば、在庫の適正水準算出のために必要な帳票専用のテーブルとして、 年月日、商品コード、在庫数のテーブルがあってもおかしいとは言いませんが、 このテーブルは更新するのが面倒なんです。 ⇒例えば、過去日付の入庫を訂正したら・・・その日以降の全データを修正しないといけません。 注：どこまで管理しているかにもよります。 質問文の内容では、入庫数や出庫数は管理していない、単に一日の終わりに在庫数を入力しているだけ とも考えられます。 これなら、年月日、商品コード、在庫数のテーブルでいいと思われます。 （というより他の持ち方ができない） データベースを分けるかどうかは、どちらでもいいでしょう。 商品属性なので、商品データベースに含めてもいいし、 在庫属性なので、在庫データベースを別に作ってもいいし、 データベースの容量との関係で問題がなければわかりやすいと思うほうでいいでしょう。
先ず、大前提として32bitプログラムのプロセス空間には 32bitのDLLしかロードできません。同様に64bitのそれは 64bitのDLLしかロードできません。 OLEの実装にはDLL型とEXE型があり、前者は同一の プロセス空間にあるため、32bitプログラムからは32bitの、 64bitプログラムからは64bitのDLL実装でなければ動き ません。 OLEをインスタンス化する時に使うクラス名はレジストリに 登録されており、最終的に処理を担うDLLかEXEのパスに 行き着くようになっています。互換性を保つため、クラス名は 以前から変わっていませんし、32/64の区別もありません。 OracleのOLEはDLL型実装なので、32bitか64bitのどちらか 一方しか処理できません。 ここでは”OraOLEDB.Oracle”が示す最終パスは後から インストールした方に切り替えられているはずです。 サーバが64bitなら、64bit版で統一すべきでしょう。 32bit版をアンインストールして、もう一度、64bit版を インストールした方がよいでしょう。 そして、コンソールプログラムの方を64bit版でリビルドする ことを薦めます。Visual Studio 2012ならどちらでもビルド できます。
> これは、「1」や「a」などの英数字は1バイト、「%」や「#」などの記号は2バ > イト、「あ」「ア」「亜」などの全ての日本語は3バイトで保存されるという > ことだと思いますが正しいでしょうか？ その認識でOKです。 > そうであれば、例えば氏名項目に２０文字を保証したい場合は、一番バイト消 > 費の多い3バイトで見積もり、20 * 3 = 60バイトで定義すればよいでしょうか？ > 第3水準文字、第4水準文字は4バイトで保存されるという記事もあったのですが、 > これらはとても稀なケースなので考慮せずに3バイトで考えておくのが一般的で > しょうか？ anmochiさんがおっしゃられている通り、UTF-8では１文字の最大が６バイトです。 ただ、私が見てきたいくつかのプロジェクトでは、UTF-8 (AL32UTF8) を使用す る場合、１文字あたり３バイト (すなわち、氏名２０文字を保証したい場合、６０ バイトで定義) で定義していました。 もし、AP側でも何かしらのチェックをするのであれば、DB側は少し緩めで作成す るのも良いかもしれません。VARCHAR の場合、データが入った分の容量しか必要 としませんので。 > あとは、バイトで考えずにNLS_LENGTH_SEMANTICSという初期化パラメータをChar > にすることで文字数ベースにすることができるとも聞いたのですがこのアプロ > ーチは推奨されますか？ 推奨する人がいるとしたら便利そうな機能を売り込みたいOracle社のプリセール スくらいです。実績が少ないパラメータをみだりに設定することで、未曾有のバ グに遭遇するリスクがあるため奨めしません。
そのページがリンクで辿れるか否かが重要です。 url が動的(?queryを使う)、静的(通常path_infoなどでページ切り分けしてる)に関わらず、 検索エンジンに収集してほしいページがトップページからリンクで辿れていれば、そのページ内キーワード（タイトルや<h1>などの強調系タグで括られた単語）で引っかかってくるようになります。 リンクで辿れないページは、収集されませんので、検索に引っかかることはありません。 つまり、form からキーワード入力または、選択して、ボタンをクリックして初めて表示されるページや、JavaScriptを実行後に表示される情報は、検索エンジンに収集されません。
> エクスポート定義のみを作成する方法をお教えいただけませんでしょうか。 なんか勘違いしているようですね。 エクスポート定義では、 CSVファイルのフォーマットを定義できますが、 保存先のパスは設定てきませんよ。 > 行いたいことは、VBA内で出力先パス・出力先ファイル名を任意に指定し > ダブルクォーテイション無しのCSVファイルを作成したいのです。 ヘルプより ----------------------------------------------------------- 構文 式.TransferText(TransferType, SpecificationName, TableName, FileName, HasFieldNames, HTMLTableName, CodePage) パラメータ FileName インポート、エクスポート、またはリンクを行うテキスト ファイルの、パスを含めた完全な名前を文字列式で指定します。 --------------------------------------------------------------- TransferText のFileName引数に出力先パス・出力先ファイル名を設定してください。
改行は\nですよ
特に違いはありません。そのままで大丈夫です。
商品B－商店３の価格差は 2800 - 2500 なので300になる気がしますが・・・。 それで良いのなら、下記の様なSQLでよろしいかと。 ---------------------------------------- SELECT a.価格 - b.価格 AS 価格差, a.商品ID AS 商品名, a.商店ID AS 商店 FROM 対象テーブル a INNER JOIN 対象テーブル b ON (a.商品ID = b.商品ID AND b.商店ID = '商店１') WHERE a.商店ID <> '商店１' AND a.履歴 = (SELECT MAX(履歴) FROM 対象テーブル c WHERE a.商店ID = c.商店ID AND a.商品ID = c.商品ID) AND b.履歴 = (SELECT MAX(履歴) FROM 対象テーブル d WHERE b.商店ID = d.商店ID AND b.商品ID = d.商品ID) ORDER BY a.価格 - b.価格 DESC; ---------------------------------------- a, b, に対して、それぞれ、商店IDと商品IDが同じものの中で履歴が最大の行だけを抽出しています。 同じ事は EXISTS 句を使っても表現できます。 ---------------------------------------- SELECT a.価格 - b.価格 AS 価格差, a.商品ID AS 商品名, a.商店ID AS 商店 FROM 対象テーブル a INNER JOIN 対象テーブル b ON (a.商品ID = b.商品ID AND b.商店ID = '商店１') WHERE a.商店ID <> '商店１' AND NOT EXISTS (SELECT * FROM 対象テーブル c WHERE a.商店ID = c.商店ID AND a.商品ID = c.商品ID AND a.履歴 < c.履歴) AND NOT EXISTS (SELECT * FROM 対象テーブル d WHERE b.商店ID = d.商店ID AND b.商品ID = d.商品ID AND b.履歴 < d.履歴) ORDER BY a.価格 - b.価格 DESC; ---------------------------------------- こっちは a, b, に対して、それぞれ、商店IDと商品IDが同じでそれより履歴が大きな行が存在しないものだけを抽出しています。 結果として、商店IDと商品IDが同じものの中で履歴が最大の行を取出す事になり、前のSQLと同じ意味になります。 また、サブクエリーで絞り込んでしまい、それを INNER JOIN する方法も有りますね。 ---------------------------------------- SELECT a.価格 - b.価格 AS 価格差, a.商品ID AS 商品名, a.商店ID AS 商店 FROM ( SELECT * FROM 対象テーブル c WHERE 商店ID <> '商店１' AND NOT EXISTS (SELECT * FROM 対象テーブル d WHERE c.商店ID = d.商店ID AND c.商品ID = d.商品ID AND c.履歴 < d.履歴) ) a INNER JOIN ( SELECT * FROM 対象テーブル e WHERE 商店ID = '商店１' AND NOT EXISTS (SELECT * FROM 対象テーブル f WHERE e.商店ID = f.商店ID AND e.商品ID = f.商品ID AND e.履歴 < f.履歴) ) b USING (商品ID) ORDER BY a.価格 - b.価格 DESC; ---------------------------------------- http://gihyo.jp/dev/serial/01/sql_academy2/000901 http://gihyo.jp/dev/serial/01/sql_academy2/000902 http://codezine.jp/article/detail/907
「商品ID」カラムの値が「商品A」や「商品B」で、「商店ID」カラムの値が「商店１」や「商店２」なのでしょうか？ 少し違和感が有りますが、それは置いておいて・・・。 「商店１」以外の行を、同じ商品IDの「商店１」の行と結合して、価格の差を取れば良いかと。 例) ------------------------------------ SELECT a.価格 - b.価格 AS 価格差, a.商品ID AS 商品名, a.商店ID AS 商店 FROM 対象テーブル a INNER JOIN 対象テーブル b ON (a.商品ID = b.商品ID AND b.商店ID = '商店１') WHERE a.商店ID <> '商店１' ORDER BY a.価格 - b.価格 DESC; ---------------------------------------- 参考URL：http://dev.mysql.com/doc/refman/5.1/ja/join.html
＃１ですが間違いありました。セミコロンの前を訂正 select sum(t2.num) from t1, t2, (select t1_id, max(id) as max_id from t2 group by t1_id) t2w where t1.name = 'aaa' and t1.id = t2w.t1_id and t2w.max_id = t2.id ; でした
AddNewする前の時点で、どのDBのどのテーブルに対して行うかをセットしていないためだと思います。 例えば、現在のDBの「T_追跡」テーブルをRSにセットする場合はこんな感じです。 Dim DB As DAO.Database Dim RS As DAO.Recordset Set DB = CurrentDb Set RS = DB.OpenRecordset("T_追跡") 参考URL： http://www.geocities.jp/cbc_vbnet/DAO/database.h … この一番下のサンプルが参考になります。
二つの集団の間の差は同じ母集団から出たサンプルとすれば、その確率は１００分の1以下であり、つまり極めてまれにしか起こりえないことと考えられる。したがって二つの集団の間には有意差があるという結論になります。
教科中の順位とその教科のレコード数を1回で取得するなら、下記の様にSELECT句内のサブクエリを一つ追加すれば良いだけです。 ---------------------------------------- SELECT Name, Kyouka, Score, (SELECT COUNT(*) + 1 FROM table1 b WHERE b.Score > a.Score AND a.Kyouka = b.Kyouka) AS rank, (SELECT COUNT(*) FROM table1 c WHERE a.Kyouka = c.Kyouka) AS count FROM table1 a WHERE ID = '10001' ORDER BY Kyouka, Score DESC; ---------------------------------------- また、上記の様に教科をサブクエリ内の結合条件で絞り込んでやると、WHERE句の条件を変えるだけで色々な絞込みが可能です。 例) [国語の全データを取得] ------------- SELECT Name, Kyouka, Score, (SELECT COUNT(*) + 1 FROM table1 b WHERE b.Score > a.Score AND a.Kyouka = b.Kyouka) AS rank, (SELECT COUNT(*) FROM table1 c WHERE a.Kyouka = c.Kyouka) AS count FROM table1 a WHERE Kyouka = '国語' ORDER BY Kyouka, Score DESC; ---------------------------------------- 性能が気になるようでしたら、下記の様にカウントはFROM句内のサブクエリで取得した方がよいかも知れません。 ---------------------------------------- SELECT Name, Kyouka, Score, (SELECT COUNT(*) + 1 FROM table1 b WHERE b.Score > a.Score AND a.Kyouka = b.Kyouka) AS rank, c.count FROM table1 a INNER JOIN (SELECT Kyouka, COUNT(*) AS count FROM table1 GROUP BY Kyouka) c USING(Kyouka) ORDER BY Kyouka, Score DESC; ---------------------------------------- なお、他の方も指摘されている通り、Kyoukaカラムにもインデックスを張ったほうが良いと思います。
投稿時にMsgBoxのWhere文を書いて欲しいですね。 Date型なんだからFormat文で整形でしょうね。 Where条件に＃で囲んだ日付を書く時、元が英語圏のソフトだけに mm/dd/yyyy が良いらしい。
Canvasの操作をJavaScriptで行うのであれば、受け渡しデータの形式はCSVかJSONで扱うのがよいと思います。 どちらを採用するかはいずれも長所短所ありますが、 ・CSV：データサイズが小さくなるが、スクリプト処理に手間がかかる。（行分割・項目分割） ・JSON：取得結果をそのままスクリプト上のオブジェクトとして使えるが、データサイズが大きい。 のイメージとなるので用途によりけりと思います。 ※XML形式の選択肢もありますが、JS上では両方の短所を兼ねていると思いますのであえて外しました（私見ですが） なお、 > 作りたいグラフのデータは項目が20あり、個数は1700以上あります。 が 20 * 1700 = 34000 のデータを用いるという意味であれば、 ・グラフ描写にどの程度時間がかかるのか。 ・メモリを大幅に消費しないか。 など、ブラウザ側のパフォーマンスを気にしたほうがよいような気がします。 （この辺りは想像でお話ししていますので、当てはまらない場合は読み流してください）
ですから、 ＞など設定がばらばらなのでQueryDefを使ってパラメータを ＞VBAで設定するならば、他の方への補足の内容をもとにすると、 ＞SQL文を、 として、補足にあるパラメータの宣言、 ＞PARAMETERS 納期1 DateTime; をはずしたクエリのSQL文を提案し、VBAでは、 ＞With qdf ＞.Parameters("納期") = Format(Forms![受注データ一覧]![納期], "yyyy/mm/dd") ＞Set rs = .OpenRecordset ＞.Close ＞End With のところで、 With qdf qdf.Parameters("XYZ") = CDate(Format(Forms![受注データ一覧]![納期], "@@@@/@@/@@")) Set rs = .OpenRecordset End With のように、Parameters("納期")　を　Parameters("XYZ")　のように パラメータが「納期」というようなフィールド名と同じになるのを 避けるために「XYZ」としているのですが・・・。パラメータと フィールド名を同じにするとエラーが出るのでこのようにしています。 補足にある、 ＞フォームからyyyy/mm/ddの書式で日付を指定し該当する ＞レコードをクエリで抽出します。 ということは、フォームではテキストボックスの書式が 日付型に設定してあると、いうことだと解釈します。したがって、 VBAでは、 .Parameters("XYZ") = Forms![受注データ抽出]![date1] とします。 ＞上記記述で ＞実行時エラー3061 ＞パラメーターが少なすぎます。2を指定してください。 ＞エラーが発生します。 これは、補足にある書き変えたVBAの中で、 ＞With qdf ＞.Parameters("納期1") = Forms![受注データ抽出]![date1] ＞Set rs = db.OpenRecordset("確定クエリ", dbOpenDynaset) ＞End With のところで、 db.OpenRecordset としているために、「確定クエリ」をパラメータを指定せずに レコードセットとして接続しようとしているためにエラーが エラーがでるのです。したがって、ここのところは、もともとの 設定のようにQueryDefを使って、 With qdf .Parameters([XYZ]) = Forms![受注データ抽出]![date1] Set rs = .OpenRecordset("確定クエリ") End With とします。ようするに、 Set rs = qdf.OpenRecordset("確定クエリ") ということです。 以上より、クエリの「納期1」の抽出条件に「[XYZ]」 (XYZではなく、[XYZ]です）と記入し、 そのクエリのSQL文は、 SELECT 確定.注文番号, 確定.注文年月日, 確定.発注者品名コード, 確定.[品名(品名仕様)], 確定.[注文数量(受注数量)], 社内データ.SNP, 確定.単位, 確定.納期1, 確定.納入No1, 確定.納品キー番号1, 確定.受渡場所名, 確定.発注者用備考, 確定.発注者名, Int([納入指示数量1]/[SNP]+0.5) AS 印刷枚数 FROM 確定 LEFT JOIN 社内データ ON 確定.発注者品名コード = 社内データ.得意先品目コード WHERE (((確定.納期1)=[XYZ])); VBAは、 Private Sub コマンド23_Click() Dim db As DAO.Database Dim rs As DAO.Recordset Dim qdf As DAO.QueryDef Set db = CurrentDb Set qdf = db.QueryDefs("確定クエリ") With qdf .Parameters("XYZ") = Forms![受注データ抽出]![date1] Set rs = .OpenRecordset End With MsgBox rs![注文番号] qdf.Close: Set qdf = Nothing rs.Close: Set rs = Nothing db.Close: Set db = Nothing End Sub
そう思うのなら、改行コードを調べてはどうでしょうか? MacOSのバージョンが記載されていませんが、 OS9以前のMacでは、標準の改行コードはCR でした。 OSXになってから、UNIXベースになり、標準の改行コードは LF です。 特に、ターミナルから入力するようなコマンドは、UNIXベースのコマンドであり、LFを改行コードとするものがほとんどです。(一部に自動判別するものや、オプションで指定できるものなどがあります) 一部アプリケーションで、OS9以前のMac用の意味で、「改行コード: CR(Mac)」等となっているものがあります。 もし、in.txt を保存するときに「CR」を選んでいるのなら、それを「LF」にしてください。
三つも五つも変わらないのでは？ まず作成したクエリを出しましょう。
> 「LibreOffice Base」はAccessと同等のことができるのでしょうか。 そうです。無料で使用できる互換ソフトと思ってもらえたらと思います。 リンクをたどるのが嫌なら"LibreOffice Base マニュアル"で検索するとマニュアルらしいものがすぐ見つかると思いますので、パラパラと見てみたらいかがでしょうか。 ただ、LibreOfficeは有志が無償で作っているものなので、Microsoftがお金をかけて作ったものに比べて不足していることが多々あると思います。そこを何とかごまかして使うか、(プログラミングを勉強して、)その機能を自分で作るかする事ができないなら、おとなしくAccessを買ったほうがよいかもしれません。
SELECT artist, COUNT( distinct event ) as c FROM tb GROUP BY artist ORDER BY c DESC
テーブルは2列だけどインポートファイルは4列あるというエラーですね。 列の定義確認してください。
「まずはマニュアルを参照する」という癖をつけましょう。 http://dev.mysql.com/doc/refman/4.1/ja/numeric-t … > もう 1 つの拡張として、MySQL には、INT(4) のように、 > 型の基本キーワードに続いて整数値の表示幅をかっこ内に指定できるオプションがあります。 > このオプションの表示幅の指定は、カラムに指定された幅より小さい幅を持つ値で表示の左側を埋める目的で使用されますが、 > そのカラムに格納できる値の範囲が制限されたり、そのカラムに指定された幅を超える幅を持つ値の桁数が制限されたりすることはありません。
select * from tbl t1 where count = (select max(count) from tbl t2 where t1.ex_id = t2.ex_id) order by count desc ではどうでしょう？
phpMyAdminとかでファイルの文字コードを変更してCSVインポートすればいいのでは。 http://www.php-seed.net/blog/archives/39
> ・エラーの意味を教えてください あなたが理解したとおり、'2147483647'というエントリーが重複した値を許さないカラムであるhogeに既にあって、それを更に登録しようとしているということだと思います。 > ・「'2147483647'」には何か特別な意味があるのでしょうか？ 32bit 符号付き整数型の最大値ですよね。 hogeに入力される値の初期値や異常値としてINT_MAXを使っていたりしませんか？ その問題が出るテーブルで次を実行したら、なにか表示されませんか？ SELECT * FROM テーブル名 WHERE hoge='2147483647'; とりあえず、修正方法としてはINT_MAXが入った値がなぜRDBに登録されたかを調べ、それが入らないようにエラー表示をするようにコードを変えることでしょうね。
>Webでの公開設定してましたが、解除できません。 共有設定のインスタントWeb公開をオフにするだけ。
PSV という拡張子というか、パイプ｜で区切るのを初めて知りました。 根本的なのはファイルを作成している方で対応してもらうのが一番でしょうけど、 多分、無理な相談だと思われますので、 VBA でファイルをリネームしてインポートする処理を作るくらいではないですかね。 Excelだと柔軟に読み込めますが、Access は頑固一徹です。 >インデックスが有効範囲にありません"のエラーになるとき 既存のテーブルに追加インポートなら フィールドのインデックスが、「はい重複なし」に設定されている場合が Google とありますね。
デフォルト16回で設定されているようです。 回数を変更するにはレジストリをいじる必要あるので気をつけてください。 参考URL：http://support.microsoft.com/kb/211922/ja
文字列型の数値変換ですか？ 意味不明です。 数字自体、文字列ではないので。 数値型からデートタイムに変換するべきことです。 私自身よく出来た話です。 文字列型から、デートタイムに変換すると yyyy/m/dなら出来ますが、 yyyy/mm/ddに変換は不可能です。 数値型でもキー入力で数字に変換されますから、 他のウェブサイトで拝見したほうがよろしい。 楽天市場の買い物の数値型も。
こんにちは。 下記のようにしてみてください。 -- #### テーブル作成 CREATE TABLE dbo.TempData ( ID int , Code1 varchar(10) , Code2 varchar(10) , Code3 varchar(10) , Val1 int , Val2 int , Val3 int ) -- #### テストデータ登録 INSERT INTO dbo.TempData SELECT 1, 'A1', null, null, 1, null, null UNION ALL SELECT 2, 'A1', 'Z1', null, 2, 1, null UNION ALL SELECT 3, 'B1', 'A1', null, 1, 1, null -- #### データ確認 SELECT SUM(CASE WHEN Code1='A1' THEN Val1 ELSE 0 END) AS Val1, SUM(CASE WHEN Code2='A1' THEN Val2 ELSE 0 END) AS Val2, SUM(CASE WHEN Code3='A1' THEN Val3 ELSE 0 END) AS Val3 FROM dbo.TempData WHERE Code1='A1' OR Code2='A1' OR Code3='A1'
補足に対しまして・・・ テーブル名の指定部分はクエリ名ではなく、そのクエリの元になっているテーブル自体の名前を指定して下さい。 「select * from～」の箇所の一文でそのままパラメータクエリ同様の役割をしてくれますので。 恐らくそれが原因かとは思いますが、もしそれでも駄目なようなら再度補足願います。。
日付毎の個数だけ出ても良く分からない結果になると思うので。 select date,count(distinct station) from table_name where date between '2013-11-01' and '2013-11-30' group by date order by date 私も日付をlike で範囲指定するのはちょっと？です。 dateとなっているけど日付＆時刻が入っていて 最終日のデータがうまくヒットしないなら、 where date >= '2013-11-01' and date < '2013-12-01' とするとか、23:59:59を指定すればいいだけと思うし。 '2013-11-01'も本当は、日付型の書き方があったはずなので、 そうすべきなんですが ・・・調べていないので調べてみてください。 （書き方がわからなければ日付型に変換する関数を調べて書いてもらえるといいと思います。） 日付といいながら、charやvarcharで定義してあるなら、 likeでも、上の書いた表記でもいいと思います。 ・・・なんでこんなことを言うかというと、日付型の項目の場合、インデックスを作っても likeや上記のような記述だと、暗黙の型変換が行われて、インデックスを使ってくれない という困ったことが起きる可能性があるからです。 （一般論で、mySQLについてはしらべてはいないですが。）
人気といえば最近では、Redisですかね。 Redisはレプリカやその運用を考えると様々な機能が充実しており、 無料だし非常に使いやすいです。 商用の様々なシステムのフロントシステムに使用されています。 ただやはり基幹系には活用は難しく、 複雑なクエリは投げることはできません。 ECサイトや、コンテンツ系WEBサイトで、 非常に多くのエンドユーザ向けシステムに向いているといえます。 NoSQL自体は、RDBMSと比べて更新性能が非常によいです。 なので、顧客情報はRDBMS、更新系の多い揮発型データは NoSQLでといった使い方をしたりします、
WHERE CHARINDEX('人間', naiyou) BETWEEN 0 AND CHARINDEX('第二章', naiyou + '第二章')
シーケンスを使う方法としては、１分以内に９９９９を超えることがないなら、 シーケンスを１分毎に０にリセットして使えばいいと思いますし、 他の方法としては、 連番 = (select nvl((select max(連番)+ 1 from テーブル where 連番 like to_char(sysdate,'hhmiss') || 'A%') ,to_char(sysdate,'hhmiss') || 'A0001') from dual) で既に登録されたデータに１を加えてもいいと思いますが。 ※どちらも秒単位で連番という仕様で書いています。 　単に連番で付けている番号だけでサイクリックにすると質問の現象は防げません。 　（防ぐためには、サイクリックにはできません。どこかでリセットするか十分に大きな桁数をとるか 　　いづれかが必要です。） なお、同時に複数のコミットされていないデータが発生する （ＤＢ側が、２ＣＰＵ以上で同時に処理されている）というのなら、不可能。 （複数のＣＰＵをまたいで連番を共有することはプログラムでもできっこないです。） ・・・２ＣＰＵ以上で同時に処理されているのでなければミリ秒まで同一のデータが出来るのは あまり起きないと思うのですが。
No.1です。 追加です ＞#psql --version でバージョンが出力されるなら、 which psql と入力してみてください。psglのある場所が表示されます。 その周辺をみて削除してみてください。 先にも書きましたように使い始めたところでしたら、初期化を強くお勧めします。
EXCEL側でACCESSからインポートする方法もありますよ CopyFromRecordSet のサンプルを探してみて下さい
> 都道府県47つの場合、各都道府県ごとにcountする形になりますでしょうか？ GROUP BY 句を使えば一度の実行で、データが存在する全ての都道府県のカウントが取得できますよ。 例) SELECT no, COUNT(*) FROM Table GROUP BY no ORDER BY no; http://www.atmarkit.co.jp/ait/articles/0012/22/n … http://dev.mysql.com/doc/refman/5.1/ja/group-by- … なお、パフォーマンスの問題は本番もしくはそれに順ずる環境で実際に測定してみないとハッキリしたことは分からないかと。
プリントアウトの体裁はレポートでグループ化を行えば実現できそうです。 http://office.microsoft.com/ja-jp/access-help/HA … 商品単価が頻繁に変化するのなら、T_注文履歴に加えてしまった方が『楽』はできます。 （「テーブルの正規化」に反しますけど） 部署間・チーム間で人員のトレードが行われると 前年対比などの場合に今年の構成で前年も比較するのか、前年は前年の構成で行うのか、 も問題になりそう。
可能ですが、先頭32文字と末尾20文字を切り捨てるからには、 元のデータは必ず52文字以上あるんですかね？ UPDATE [A表] SET [A表].F1 = iif( len([F1]) > 52, mid([F1], 33, len([F1]) - 32 - 20), ''); F1列が52字を越えていれば途中を切り出し、52文字以下なら空文字をセットします。 ELSE部分は適宜変更してください。
DB2に限った話ではありませんが、 リテラルを文字列として扱って欲しい場合はシングルクォーテーション(')で囲う必要があります。 (DB2では、リテラルをダブルクォーテーション(")で囲うと列名として認識されます)
No2のIf文はこの形ではなく、単に Private Sub 修正_Click() CopyRec MsgBox("修正が完了しました。フォームを閉じます。") DoCmd.Close acForm, Me.Name End Sub のように、コードを羅列しても同じなので どちらでもいいです。 一応、No1とNo2はIf文を使った例です、ということに します。
PDOってそもそもさくらでは使えるんですよね？
表領域を削除すればデータファイルも削除できます。 INCLUDING CONTENTS AND DATAFILESを付けて DROP TABLESPACE を実行することで、 表領域の削除時に Oracle がデータファイルも削除してくれます。 DROP TABLESPACE IndexTbs INCLUDING CONTENTS AND DATAFILES; IndexTbs表領域が２つ以上のデータファイルから構成されている場合に、 IndexTbsを削除することなく、複数のデータファイルのうち１つだけを削除することは できないので、そのようにしたい場合は、IndexTbs表領域のデータを一旦エクスポート して、IndexTbs表領域を再作成してください。
＞としないのには、トラフィックの問題以外に何か理由があるのでしょうか？ フィールドの並び順が「予期せぬ結果」になるからです。 例えば、最終的な抽出結果を「項目名が１行目に付かない、CSVファイルに落とす場合」を考えてみましょう。 CSVになった段階で「１番目の項目が何、２番目の項目が何、３番目の項目が何」と言う情報は失われます。 もし、誰かが、大元のテーブルのIDフィールドとuserフィールドを「逆の順番に並び替えた」とします。 SELECT * FROMだと「抽出結果が、１番目の項目がIDで、２番目の項目がuserである」と言う保証はありません。誰かが元テーブルのフィールドの順番を入れ替えてしまったかも知れません。 入れ替えたのを知らずに、そのままCSVファイルに落としてしまうと、「１番目の項目が何、２番目の項目が何」と言う情報は失われているので、想定外のCSVファイルが出来上がってしまいます。 SELECT ID, user FROMなら「抽出結果が、１番目の項目がIDで、２番目の項目がuserである」と言う事が保証されます。誰かが元テーブルのフィールドの順番を入れ替えても、結果は変わりません。 結果のフィールドの並び順が保証されるので、そのままCSVファイルに落としても、想定通りのCSVファイルが得られます。 SELECT文で「すべての項目が全部並べて書いてあって、抽出条件も何もなしで、全レコードを返している場合」がありますが、このSQL文の意味は「結果のフィールドの並び順を固定するため」なので、安易にSELECT * FROMに書き換えると、思わぬ所でバグを産んで、痛い目に遭います。
自分のところでは問題なく認識できていると不思議に思って確認したら、！でした。 Visual Web Developerって、無償の「Express」バージョンですよね。 申し訳ありません。 通常版のVisual Studioならば、「サーバエクスプローラ」「データベースエクスプローラ」とも問題なく表示できます。 Connector/Netのバージョン問題は同様じですが。 「データベースエクスプローラ」のようなウィザード系を使用せず（となるとLINQやEntityFramneworkはおろか、「強く型付けされた」DataTable等も使えませんが）、SqlCommandやSqlDataReaderでゴリゴリやるしかないようですね。 http://social.msdn.microsoft.com/Forums/ja-JP/45 … Express系はアドオンが使えないので、Connector/Netよりはるかに強力なDotConnectのようなサードパーティ製品もNG。IDEの恩恵を得るにはProfessionalを導入するのが一番かもしれません。 Devarts Dotconnect for MySQL http://www.devart.com/dotconnect/mysql/
貴方言っている論理名とは http://dev.mysql.com/doc/refman/5.1/ja/create-ta … この中にでてくる論理名ですかね？ ＞MySQLで論理名を取 これは、「表題の通り」ではありません。表題通りというのは、表現としてはよくありません。論理名は、固有名詞ではないので、何を指しているのか、ちゃんと矛盾無く説明しましょう。
#1です。 ごめんなさい。where条件で部分一致がなりたたない。 update テーブル名 set keyword = keyword || ' ' || 追加キーワード where (' ' || keyword || ' ') not like ('% ' || 追加キーワード || ' %') ; です。
No3ですが、他の回答者のために、記述。 http://dev.mysql.com/doc/refman/4.1/ja/mysqldump … http://dev.mysql.com/doc/refman/5.1/ja/mysqldump … などにあるように、MySQLフリーソフト付属のバックアップコマンドで吐き出す、データーをリダイレクトでファイルにする時に、公式サンプルでは（公式HP） shell> mysqldump --opt database > backup-file.sql などど、記述されている。それを質問者が、 ＞Linuxの.sqlを なんて記述してしまうと、何の話をしているのか？　　と言う事になる（リダイレクト自体も理解していないかも）。よく公式だけ覚えて何も考えない社員に多く見られる傾向ですね。質問者のかすかね巧妙は、「mysql:mysql2」と記述した点ですね。これで、何者かやっと分かった程度です。 で、なぜLinuxなどのUNIX系で拡張子が必要ないのに、付けてたかといえば、上記ページに、 「ダンプには、テーブル作成や入力のための SQL ステートメントが含まれます。」 とあります。つまり、俗に言う「SQLファイル」ですね（テーブル構造とデータのダンプ）。拡張子が必要ないのにつける場合は、慣習ですね。 （※備考：　よく、tar コマンドでアーカイブしてファイルに XXXX .tar などtar コマンドでアーカイブした事があとでわかるようにわざわざつけます（UNIX系、Linux系）。付いてなくてもtarコマンドやOSでは何も困りません。ただし、OS側やファイルマネージャー等で紐付けしたらダブルクリックしたら特定ツールが起動するでしょうが。 SQLファイルも同じように慣習として、意味はありませんが、 .sql と拡張子をつける習慣があります。Windowsでも、それを使うソフトが存在しなければ、「不明ファイル」として、Windowsのアイコンが付くはずです） つまり、RDBの構造を（ユーザー作製テーブル等）、他のRDBMSに移植用、バックアップ用にSQLファイルの形で、標準出力に表示するコマンドと言う事になります。中身はプレーンテキストですね。 このコマンドは通常 http://dev.mysql.com/doc/refman/4.1/ja/backup.html にあるようにMySQLのバックアップコマンドですね。 以上ですが、当人に聞いていないので、実際このファイルなのかは不明。
いっそ、ファイルシステムのディレクトリの様なツリー構造と考えてしまって上位のIDを保持するようにしてはどうですか？ 例) テーブル「area」 +----+----------+---------+ |　id　|　name　　　 |　upper_id　| +----+----------+---------+ |　1　|　関東　　　　|　(null)　　| +----+----------+---------+ |　2　|　東京都　　　|　1　　　　 | +----+----------+---------+ |　3　|　渋谷１丁目　|　2　　　　 | +----+----------+---------+ |　4　|　渋谷２丁目　|　2　　　　 | +----+----------+---------+ 構造的には、県の上位に市を設定したり、自分自身のIDを上位IDに設定する事も出来てしまいますから、そこら辺はアプリケーション側で管理する必要が有りますが。 さらに地域の種別を表すコードのカラムを設けて、どの階層かを管理しても良いかも知れません。 参考URL：http://www.geocities.jp/mickindex/database/db_tr …
UPDATE tableA SET tableA.name = ( SELECT tableB.name FROM tableB WHERE tableA.id = tableB.id ) WHERE EXISTS ( SELECT tableB.name FROM tableB WHERE tableA.id = tableB.id )
すみません。少し単純なことに気が付きませんでした。 実際には、わざわざ「日付」を数値に変換する必要は ありませんでした。「日付」の比較に難儀したので 数値化したのですが、関数の中では直接比較できるので わざわざ「日付」を数値化する必要はなかったようです。 以下のコードをコード表に貼り付け、保存します。 「テーブル名」は実際に合わせて変更してください。 Function funcDateRank(ByVal dData As Date) As Long 　　Dim db As DAO.Database 　　Dim rs As DAO.Recordset 　　Dim minNum As Long 　　Dim i As Long 　　Dim j As Long 　　Dim strSQL As String 　　'日付だけを取り出しグループ化 　　strSQL = "SELECT 日付 FROM テーブル名 GROUP BY 日付" 　　Set db = CurrentDb 　　Set rs = db.OpenRecordset(strSQL) 　　'自分より大きい日付を見つける 　　rs.MoveFirst 　　Do Until rs.EOF 　　　　If num < rs!dData Then 　　　　　　i = i + 1 　　　　End If 　　　　rs.MoveNext 　　Loop 　　'レコード数の取得 　　j = rs.RecordCount 　　'ランクの算出 　　funcDateRank = j - i 　　rs.Close: Set rs = Nothing 　　db.Close: Set db = Nothing End Function 次にテーブルを基にクエリを作成します。 そのクエリの新しいフィールドに、 　　funcDateRank([日付]) と設定し、保存してください。 以上です。
正直、書いてあることからどういうデザインなのか今ひとつピンときません。 普通、ロックによる性能劣化の解消方法はロックの粒度を細粒度にするか、ロックフリーアルゴリズムの採用だと思いますが、提案されている方法はどちらでもないように思います。 > DBに書き込み前にロック用ファイルをファイルロックをし、書き込みが終わったらロックを解除する、という感じです。 というデザインにしたことでどうして現状より良くなるんでしょうか？ これはSQLiteがロックしてくれていたところを自分でやっただけで、本質的に現状と変わらないと思います。むしろ、自分の実装ミスによってロックがされず、にデータの消失や不整合を招くリスクのほうが高いのではないでしょうか。 いや、RESERVEDやPENDINGといったSQLite3のロック状態を使えない分だけ、それをちゃんと使って書いたコードよりも、ロックの粒度は粗くなっているので、トータルでの性能は落ちそうです。 質問者が言うところのロックファイルを使う実装というのは、要はすべてEXCLUSIVEにするということですよね？ ちなみに、 http://www.sqlite.org/lockingv3.html によると、SQLite3からはPENDING状態があることでリードの多発によってEXCLUSIVEロックが取れない状態というのは解消されたそうです。 > その他に、メインのDBに書き込みできるのはマスターのPHPだけにして、ユーザーは一切書き込みできないようにする、という方法です。 ロックを取る話と今ひとつつながって見えませんが、普通に考えていくつも問題が思い浮かびます。 1. DBの内容の不整合 2. スレーブ？によって新規作成されたDBファイル名の競合 3. スレーブ？によって新規作成されたDBが書き込み中であったことによるマスターの待ち 4. スレーブ？によって新規作成されたDBファイルによるディスク領域の圧迫 1についてですが、例えば、持っている商品の数に整合性がないわけですから、ヘタしたら自分が持っている数以上に商品を出してしまいますよね。商品数が1個で、ユーザーAもユーザーBもそれを使えると思って確保したら、マスターが突き合わせをした時に不足しているとわかると。 あるいは、新規商品の追加だけしかしないとしたら、同一商品の追加があった時に微妙に内容が違っていたことでエントリーが複数できたりしませんか？また、登録したものがマスターが処理を終えるまで見られないという状況になるとも思います。 2について、被らないようにファイル名をつけないと、先の入力を後の入力で上書きしそうです。あるいは、マスターによるDBの削除でデータがあるファイルを削除しそうです。 3について、1分ごとにマスターのデータベースを止めてひたすらアップデートをするので、スレーブ？が作ったファイルが著しく多かったり、スレーブ？が自分が書いているDBのロックを取ったまま帰らないことが多かったりすると、その間マスターを使えないということになりませんか？ 4について、それぞれのスレーブがDBファイルを作るとなると、書き込みが増えれば増えるほどファイルのオーバーヘッドの部分によるディスク領域の圧迫もありそうです。 > しかし同時書き込みでデータベースがロックしてしまうSQLiteの仕様では複数人数での運用ができません。 一応確認ですが、書き込みにはちゃんとトランザクションを使っていますよね。使うのと使わないのとでは雲泥の性能差がSQLite2のころからあるようですが。 http://www.sqlite.org/speed.html あと、釈迦に説法だと思うのですが、インデックスをちゃんと設定してquery planも確認してますよね。 http://www.sqlite.org/eqp.html http://www.sqlite.org/queryplanner.html それでだめならMySQLの採用もやむなしだと思うのですが。 自分だったらSQLite3でちゃんと性能が出るように実装してみて、ダメだったらもっと細かい粒度でロックが取れるRDBMSを採用するというアプローチを取るでしょう。 #1さんと同じく、ロック機構を自分で実装するというのは、リスクが高すぎてやりたくないです。
mysql -u ユーザー名 -p ではどうです? http://dev.mysql.com/doc/refman/5.1/ja/connectin … を読むかぎり、 -u だけ、という指定は無いようです。 私自身はMySQL歴が浅く4のころを知りませんが、もしかしたら、コマンドラインの変更があったかもしれません。 4では「-u:ユーザー指定無し→無効→デフォルトユーザー、-p:パスワード指定無し→パスワード入力」 5では「-u:ユーザー'-p'、-pオプション無し→パスワード入力なし」 といった解釈方法の変更があったのかもしれません
で、httpd.confの120行目はチェックしたのでしょうか？
LINUXのnkfコマンドを使って、pg_dumpしたファイルをS-JISに変換出来ます。 （例） nkf -s 入力ファイル名 > 出力ファイル名 それ以前の問題として、pg_dumpしたファイルを英訳なんて無茶苦茶ですね。 psqlのcopyコマンドでテーブル毎にCSVファイル出力可能です。 これをnkfコマンドでS-JISに変換し、PCにftpする方が現実的でしょう。 参考URL：http://www.postgresql.jp/document/9.3/html/sql-c …
No.2です。 不確かですがCOBOLでROWCOUNTは使えなかったような気がするので… SELECT COUNT(*) INTO :ホスト変数 FROM テーブル名 DISPLAY ホスト変数
> Npgsqlではフェッチは使えないのでしょうか？ できますよ。 http://msdn.microsoft.com/ja-jp/library/9kcbe65k(v=vs.110).aspx 別にNpgsqlに限った話ではなく、こういうライブラリはよっぽど独自 実装してない限り、大抵DbCommand、DbDataReaderを使うのと一緒です。 継承元クラスを直接利用するならば、 Dim con As NpgsqlConnection ' コネクションがある前提 Dim command As NpgsqlCommand = con.CreateCommand() Dim r As NpgsqlDataReader = command.ExecuteReader() Do While r.Read() 　Console.WriteLine(r.GetString(0)) Loop r.Close() command.Dispose() こんな感じに。 DB操作がわからないなら、System.Data.Common内のクラスを見るなり、 それぞれのメソッドを見るなり、他サイトでクラスやメソッド単位で調べるなり すれば解決すると思います。 Npgsqlのクラスのほとんどは、このクラスを継承して実装が行われています。 http://msdn.microsoft.com/ja-jp/library/System.D …(v=vs.110).aspx Npgsqlのクラス名を知りたければ、CHMファイルがあります。 http://pgfoundry.org/frs/?group_id=1000140
作り直す気があるならこんな感じ //元データ create table shohin(sid int,sname varchar(30)); insert into shohin values(1,'パソコン'),(2,'洗濯機'),(3,'車'); create table category (cid int,cname varchar(30)); insert into category values('1','OA機器'),('2','家電'),('3','大型'); create table category_shohin (cid int,sid int); insert into category_shohin values(1,1),(2,1),(2,2),(3,2),(3,3); //商品ごとにカテゴリー名を羅列 select s.sid,s.sname,sub.cnames from shohin as s inner join ( select sid,group_concat(cname) as cnames from category as c inner join category_shohin as cs on cs.cid =c.cid group by sid ) as sub on s.sid=sub.sid あとは最終形をどう見せたいかによります
補足 ああsql結果は基本的に配列構造なのでimplode()なりしないと1すら出ません。。
>MyISAM で使っていたsqlをそのまま使ってもトランザクションは利用できないとゆうことでしょうか？ MyISAM自体がトランザクションを利用できないので そのままInnoDBにエンジンを変更してもトランザクションは利用されません。 MyISAM→InnoDB変換後に適切なプロセスを追加してください。
単純にCOUNT関数ではダメなのでしょうか？ SELECT COUNT(*) FROM udon WHERE not abc = '111' limit 5, 10 もしくは質問がそのlimit取得後の後ろの残りレコード数が知りたいというのであれば、一般的には総数を最初にカウントしlimitの開始位置/取得数を考慮差し引きし残りを求めます。
SELECT tbl_1."請求ID" , tbl_1."請求先名 " , (Select 　　　　　　' ' + tbl_3."商品名" + "*" + "個数 " From "注文TBL" tbl_2 Left Join "商品TBL" tbl_3 On tbl_2."商品ID" = tbl_3."商品ID" WHERE tbl_1."請求ID"= tbl_2."請求ID" For_XML_Path('')) as "商品名" FROM "請求TBL" tbl_1 こんな感じだったかな～。コード検証はしていません！ For_XML_Pathで言うならば文字列の結合GroupByになったはずです。 MySQLでいう、group_concat関数ですね。
グラフィカル実行プランの表示 (SQL Server Management Studio) http://technet.microsoft.com/ja-jp/library/ms178 …(v=sql.105).aspx 同じ実行プランであれば、差はありません。
＞valueが「1」かつ「2」のデータを検索する この命題では日本語としてなりたたない なんとなく言いたいことはわかるのだけど条件提示が杜撰すぎ 以下のどれかだと推測します (1)valueが1および2を含むデータをすべて抽出 →仮に別途value=3のデータがあたったらそれも抽出 (2)valueが1および2を含むデータの内、1,2に該当するデータのみ抽出 →仮に別途value=3のデータがあってもむし (3)valueが1および2しかないデータを抽出 →仮に別途value=3のデータがあったら1,2に合致しても抽出しない たぶん(2)なんだろうなぁということで以下 //元データ create table table_a (id int,data varchar(20)); insert into table_a values(1,'a1'),(2,'a2'),(3,'a3'); create table table_b (id int,aid int,value int); insert into table_b values(1,1,1),(2,1,2),(3,1,3),(4,2,1),(5,2,2),(6,3,1),(6,3,3); //単純な表示 SELECT * FROM table_a WHERE table_a.id in (SELECT aid FROM table_b where value in (1,2) group by aid having count(distinct value)=2 ) //table_bの情報も含めた表示 SELECT * FROM table_a INNER JOIN table_b ON table_a.id = table_b.aid and value in (1,2) WHERE table_a.id in (SELECT aid FROM table_b where value in (1,2) group by aid having count(distinct value)=2 )
SQL分の効率分析ツールなら、SQL Server Profilerを勧めます。 スタートー＞すべてのプログラムー＞Microsoft SQL Server 2008ー＞パフォーマンスツールー＞SQL Server Profiler 新しいトレースを作成して、実行すると、SQL文のパフォーマンスを見ることができます。 ご参考になれればと思います。
まず、「元データ」から「区分」以外のフィールドの選択クエリを作ります。 ツールバーの「Σ」ボタンをクリックし、集計行を表示します。 「社員コード」「日付」を　グループ化。 「勤務時間」から「訪問のカウント」までは 合計。 「開始時間」を 最小。 必要なら、フィールド名を変更。 以上です。
## ちょっと、大変そうですね。。。 >疑問 >・WEBページに対してマスタはもつものなのでしょうか。 目的を書かずに手段の要否を問われても、答えはでてこないです。 要は、WEBページに対してマスタを持って何をするかがまったくかかれていないので いるかいらないか誰も判断をつけれないということになってしまいます。 例えば、 ユーザーのアクセスログを別途取得する★ その際は、アクセスした日時とユーザーＩＤとＷｅｂアドレスを取得している ⇒ユーザーＩＤとＷｅｂアドレスで何をしたかはわかるといえばわかるが 　Ｗｅｂアドレスだけではとてもわかりにくい。★ 目的：アクセスログを参照するさいには、わかりやすくWEB画面名称を表示したい ⇒マスタをもって、ＷｅｂアドレスからWEB画面名称を参照し、 アクセスした日時とユーザーＩＤとＷｅｂアドレスとWEB画面名称を表示する このためにマスタを利用します という話の筋道になります。 ★のところがわからないとマスタの要否がわからないっていう話です。 参考資料については、 例えば、Ｗｅｂページの作り方がまったくわからない人に対してのサイトで http://www.shoshinsha.com/hp/1hour/first.html とか見つかりましたが、これからスタートだったら、業務で利用できるようになるまでには いったい何年かかることやら。。。（このＵＲＬは参考にならないはずです） きつい言い方してすいませんが、 業務要件を聞いて、どういう風に作ってというのをアドバイスしてもらえる人を探してこないと いつまでたっても出来そうにないです。 ・・・質問文を見ると、WebアプリのＤＢ設計を担当ということなので、 Webアプリを作るサイドにそういう人がいるということなら、 その人に要件を聞くことからはじめれば対応できるかもしれません。 （Webアプリを作るサイドにそういう人がいないならもう撃沈するのがオチとしか思えませんが。。）
FM7（持っていない）には機能的に無いということなのでしょうね。 v10？以上にすると変数設定とPDF保存の機能があるので、スクリプトを設定 するとボタンを押すだけで全レコードを一括PDFにしたり出来ます。
>このようなものが２0個程あり、年度が変わるごとに全ての値を入力し直しています。 >（年度・西暦・配付率などその年の数値） これのデータを何に使用するのですか？レポートなど？ >そこで”年度”を主キーにしたテーブルを作成し、そこに他の項目（西暦・配付率など）の >フィールド（２０個）を設定し、そのデータを利用できないかと考えています。 これだと、データとして何にも使えますが、用途は？
SQLiteでは、insert or replace しかないけど select文からの入力とサブクエリは使えるから replace into [table_name] (n,c1,c2,c3) select x.n, org.c1, x.c2, org.c3 from (select 1 as n, 1 as c2 ) as x left join [table_name] as org on x.n=org.n ; n がprimary key または uniqueの前提で１行書き換えまたは、新規挿入。
質問1について。 >２つのオーバーロードプロシージャのパラメータ数が異なるよう指定しているので、このエラーに関する原因を見つけれておりません。 とありますが、 >PROCEDURE SHOW_BIZDAYS( >v_start_date IN DATE := sysdate, >v_bus_days IN NUMBER := 30); と、v_bus_daysのデフォルト値を設定しているため、 >EXECUTE test.SHOW_BIZDAYS('20-NOV-13') この呼び出しは、EXECUTE test.SHOW_BIZDAYS('20-NOV-13', 30); と同じことになります。 ですので、デフォルト値の設定を消さなければいけません。
並び順が替わるというのは、別のtableなどからのデータで、変更するのですよね？、１行２行の入れ替えという物ではなさそうなので、構成を練り直した方が良いようにも見受けるけど、毎回集計しないで、一回集計した順で通常のアクセス時の表示を速くしようとしてるのかな。 であれば、order順定義用カラムは、別table に分けた方がいいのでは？ id と orderだけのtableにしてorder をauto_incrementとしておけば、truncate したあとに、一気に、並べ替えたい順でidだけ流し込めば、orderは、自動的に1から振り直される。 この方がorderとid 以外のデータにはさわらないので、大事なデータが失われる可能性もなくなり、作業時間も短縮するのでは？ 通常表示の部分は、元table と id でjoin して表示順をコントロールすることにはなるけど。
□数字の入力 phpmyadmin の insertやupdateのフォームでは、カンマ「,」が入ってると文字列として解釈されて、数値カラムにおいてはそのようなデータ入力できません。 直接SQL文でinsert文を発行するときは、２個の数値として解釈されてしまいます。ので、結果としてデータ入力時は、カンマ表記は使えません。 出力表示に関しては、format関数を使えば、いかようにもなります。 http://dev.mysql.com/doc/refman/5.1/ja/string-fu … select FORMAT('#,###,###.##' ,`column_name`) from `table_name` □名前の入力 姓と名の間にブランクが入っているときは、全角なら全角ブランクを入れて同じように指定しないと = 比較ではマッチしません。 個別カラムにすれば、それぞれのカラムで = 比較して、andで繋げば、完全一致名を取り出すことが出来ます。 □改行 改行コードを文字として入れることは出来るけど、phpmyadminでは、html表示なので、改行されたようには見えないでしょう。 通常、phpなどなんらかのアプリケーションから、その改行コードに対して、改行表示されるような操作をするので、問題なく改行コードを入れたり取り出したりは出来ます。
(1)とは別に、(2)のデータを作るためのクロス集計クエリーを作成し、二つを社員コード、日付でリンクし、それぞれをフィールドを結合させます。この時、クロス集計クエリーは、＊で全フィールを追加します。これは、クロス集計で作成されるフィールドはその都度変化するので、フィールド名を特定できない事への対応です。 以下に具体的に書いてみます。 先ず(2)に必要なデータを求めるクエリーとして、社員コード、日付、訪問名：[区分] & ([Gコード]-1),業務時間: DateDeff("n",[開始時間],[終了時間])として、区分＝"訪問"だけを選択し、下記データのダイナセットを作成します。 社員コード| 日付 |訪問名|業務時間 ==================================== |1111111 |2013/10/01　|訪問1 |　20 |1111111 |2013/10/01　|訪問2 |　240 |2222222 |2013/10/01　|訪問1 |　60 |2222222 |2013/10/01　|訪問2 |　30 次にこのクエリーを元に、行見出し：社員コード、日付、列見出し：訪問名、集計値：業務時間としたクロス集計を行います。この結果として、下記データのダイナセットが作成されます。 社員コード| 日付 |訪問1|訪問2 ==================================== |1111111 |2013/10/01　|20 |　240 |2222222 |2013/10/01　|60 |　30 (1)の集計クエリーと上記クロス集計クエリーを社員コード、日付で連結し、(1)から社員コード、日付を除くフィールド、クロス集計からは＊を使って全フィールドを追加、結合したクエリーを作成すれば、目的の結果が得られます。確認して下さい。社員フィールド、日付フィールドの位置が中程になってしまいますが、訪問数がその都度変化することに対応するとこうなります。不明点があれば補足ください。
仮にこうします monthは月の整数でもつと、年をまたいだ時に大変なので、日付型のデータの方がよいです //元データ create table score (id int not null primary key auto_increment, name varchar(20), score int, month date, increment int not null,unique(name,month)); insert into score(name,score,month) values ('taro',100,'2013-11-01') ,('jiro',200,'2013-11-01') ,('saburo',150,'2013-11-01') ,('hanako',200,'2013-11-01') ,('yosiko',160,'2013-11-01') ,('taro',50,'2013-10-01') ,('jiro',200,'2013-10-01') ,('saburo',250,'2013-10-01') ,('hanako',300,'2013-10-01') ,('yosiko',100,'2013-10-01'); //incrementを求める update score as s1 inner join score as s2 on s1.month + interval 1 month =s2.month and s1.name=s2.name set s2.increment=s2.score-s1.score; where s2.month='2013-11-01' //雑なランク付け select name,increment from score where month='2013-11-01' order by increment desc limit 3; ランク付けは同順位の処理をどうするか考えるとすこし複雑になってきますが 今回はとりあえず表示するだけの簡単な文法を提示しておきます
>特定の作業（レイアウトモードに切り替える等）をすると、 >タブ1の表示にもどってしまいます。 無理です。タブコンではなく別レイアウトにした方がまだいいかも。
このような場合はいくつかの対応ですね。 (1)リスク承知で8.1を導入する 動作確認がとれていないと言っても動作しないという訳ではないかもしれないので、自己責任で8.1の導入をする (2)8.0のまま導入する 動作確認が取れるまで8.0を使い続ける。最新のOSが最良とは限らない 企業としての対応なら(2)になると思います。当社では顧客にメリット・デメリットを伝えた上であえて古いOSを納入することもあります。逆にWin7を導入することもありますね。
もっとも肝腎なところが抜けています。 リモートマシンからどのような方法で、MySQLサーバーのあるマシンへ接続するのでしょうか？ とはいえ、第１にMySQLサーバー自体では、リモートにあるファイルは直接は読めません。 load data local infile文は、クライアントとなるアプリを通してそのファイルとSQL文とを送り込むから読めているだけです。 第２にクライアントは、何を使うのでしょうか？ mysqlクライアントツールが、リモートマシン側にあって、そこからログインするとしても、mysqlクライアントツールも、sql文を書いたテキストファイルを読んで実行することは出来ても、入力中のSQL文に、外部ファイルからのデータは取り込めません。 しかし、「特定のテキスト」自体をSQL文全文にしてしまえば、SQLスクリプトファイルとして読んで、実行することが出来ます。 http://dev.mysql.com/doc/refman/5.1/ja/batch-com … または、クライアント側のバッチファイルなり、シェルスクリプトなり、または、phpやperlなりで、そのテキストを読みとったうえで、SQL文全文を作成するプログラムを書けばよいでしょう。
#1の方と書き方が違うだけですが、 SELECT * FROM テーブル名 WHERE SUBSTR(chk_open_date_time,1,4) || SUBSTR(chk_open_date_time,6,2) || SUBSTR(chk_open_date_time,9,2) = '20131115' 後、カラムの型がもしDATE型の場合、TO_CHARでフォーマットしてみる SELECT * FROM テーブル名 WHERE TO_CHAR(chk_open_date_time, 'YYYYMMDD') = '20131115'
(1)SUBSTRで必要部分を取り出して検索する SELECT * FROM テーブル名 WHERE SUBSTR(chk_open_date_time,1,10) = '2013-11-15' SUBSTR(文字列(カラム名), 開始位置, 文字数)で必要部分を取り出して検索条件つ使用する (2)LIKEで前方一致 SELECT * FROM テーブル名 WHERE chk_open_date_time LIKE '2013-11-15%' LIKEで指定日付で始まるものを条件とする
なるほど・・・ foodを管理するテーブルのidとなるキーであればfood_idで良いと思いますよ もしくは端的にidとするかです。 joinする際に別名を付けて管理すれば混乱は少ないと思います
DoCmd.OutputToは、使用したことはありませんが、レポートのRecordSourceとして、"ID=" & PubIDReturn()をWhere条件にしたQueryを指定すれば良いと思います。 フォームのテキストボックスで、PDF化したいIDを指定し、このIDで絞り込まれたレポートをPDFに出力させます。 フォーム上のボタンで操作するなら、次のようにVBAを組むことが考えられます。 モジュールオブジェクトで、Public PubID as Longとグローバル変数宣言します。 次に、このグローバル変数を返す関数PubIDReturn()を定義します。 Public PubID As Long Public Function PubIDReturn() As Long PubIDReturn = PubID End Function 次にIDを指定するフォームで、実行ボタンのクリック時イベントに次のようなモジュールを作成します。 Private Sub コマンド0_Click() If IsNull(Me![ID]) Then MsgBox "IDを指定して下さい" Exit Sub End If PubID = Me![ID] DoCmd.OutputTo acOutputReport, "レポート名", acFormatPDF, "保存path&ファイル名.pdf" End Sub レポートに設定するQueryは次のように設定します。 SELECT * FROM テーブル1 WHERE (((テーブル1.ID)=PubIDReturn())); これで如何でしょうか？ IDは、オートナンバー型を仮定しています。 実際のIDのデータ型に合わせて確認下さい。
#2です コピペミスみたいなので再投稿します //データ作成 create table movie(m_id int,m_name varchar(100),m_memo text); insert into movie values(1,'タイタニック','※2000円'),(2,'E.T','※子ども向け'),(3,'007','※R指定'),(4,'アメリ','※女性向け'); create table theater(t_id int, t_name varchar(20)); insert into theater values(1,'バルト9'),(2,'渋谷東急'); create table schedule(t_id int,m_id int,s_date date); insert into schedule values(1,1,'2013-10-16'),(1,2,'2013-10-19'),(2,3,'2013-10-17'),(1,1,'2013-10-17'),(2,3,'2013-10-18'),(2,4,'2013-10-20'),(1,2,'2013-10-18'),(1,1,'2013-10-15'),(2,3,'2013-10-19'); //スケジュール一覧 select t_name,m_name,s_date,m_memo from schedule as s inner join movie as m on s.m_id=m.m_id inner join theater as t on s.t_id=t.t_id; //スケジュール集計 select t_name,m_name,min(s_date) as start,if(count(s_date)=1,null,max(s_date)) as end,m_memo from schedule as s inner join movie as m on s.m_id=m.m_id inner join theater as t on s.t_id=t.t_id group by t_name,m_name;
できないとは言わないけど、普通SQLでそんなデータの持ち方はしません こんな風にしてみて //元データ create table tb(id int,place varchar(20)); insert into tb values(5,'上野'),(6,'銀座'),(6,'東京'),(7,'銀座'),(7,'上野'),(8,'銀座'); //カンマ区切りの表示 select id,group_concat(place) as place from tb group by id; //集計 select place,count(*) as count from tb group by place;
Access MDB からの移行というのであれば、Access ADP + Microsoft SQL Server が最も簡単かと。 http://oshiete.goo.ne.jp/qa/7439684.html
こんにちわ。 > インスタンス、ノード、ターゲットの違いについて ターゲットは、RMAN で言うTarget DB の事でしょうか？ そうであれば、こんな感じで良いと思います。 インスタンス : SGA (共有メモリ) とバックグラウンドプロセス群 　　　　　　　 要は、DB Server 上のメモリリソースです。 ノード : インスタンスを起動しているDB Server ターゲット : インスタンスを通してアクセスされるデータベース 　　　　　　　 データファイルやRedo Log 等、Storage 上のリソースです。
REGEXP を利用しているということは完全一致ではなく部分一致でよいのですよね？ であれば WHERE table1.title REGEXP "りんご|みかん|ばなな" で十分では？
「実際の日付の9日前」でグルーピングすれば済む気もします。 SELECT SUM(金額) FROM　売上テーブル WHERE　日付 BETWEEN '2011-01-01' AND '2011-12-31' --正しくは '2011-01-10' AND '2012-01-09' ? GROUP BY DATE_FORMAT(日付 - INTERVAL 9 DAY, '%Y/%m');
GROUP　BYを行う項目の型はなんでしょう？ char(3) ’1△△’と’1△’は同じ （’1△’を格納していても、’1△△’となるため） varchar(3) ※Oracleではvarchar(3) ’1△△’と’1△’は別 ※ ’△△1’と’1△’が同じとみなされる？ ⇒暗黙の型変換がされてしまって数値に変換されている気がします。。。 SQL Server2000で試す環境がないので、はっきりしたことはわかりませんが。 ・・・項目としているけど実はConvert関数を使っている関数式とかならかなりあやしい。
>>説明不足でしたが、SQLではなくオラクルです。 オラクル・データベースをはじめとして、ＲＤＢは、ＳＱＬ言語を使っています。このレベルも理解できてないなら、大学で学んでいることが理解できないのも当然でしょう。 >>私JAVAはあまり慣れていないので、まずはJAVAの基礎を固めてからオラクルの勉強をしたほうがよいということでしょうか？ 現在学んでいることを理解するならば、どちらも必須です。なおJavaとオラクルは直接の関係はありません。Javaの基礎が分かったとしても、オラクルは別ものですので、ゼロからのスタートです。 さらにTomcatやそれ以外のWebServerとか、html、JavaScript、データベースや文字コードのことも理解しないとだめでしょう。全部を勉強しないといけません。 とはいっても、同時に勉強しようと何冊も同時に書籍を読みまくっても、頭に入るわけはないので、理解しやすいところから順番にやっていくしかないかもしれません。 そして書籍を読むだけではなく、時間がかかっても、自分の手を動かして、１からサイトを作ることが、学ぶ良い方法だと思います。 ただ、正直なところ、JavaでのWeb開発は、PHPとかRubyonRailsなどに比べると、難しいと思います。私もいろんな言語でのシステム開発経験があったのですけど、JavaをつかったWeb開発は、本をよんだだけでは分からず、ベテランＳＥさんの応援を求めて、なんとか開発を進めることができたという経験があります。なので、今でもWeb開発をするときは、Javaを敬遠して他言語で行っています。 ということで、質問には (1)WEBデータベースにあたって何をどの順番で学んでいくのがよいか 人それぞれだと思うけど、時間をかけて一歩ずつ進むしかない。ただ、ある程度分かるまでは、冬休みなどの休暇を全部潰して、１日に１５時間の勉強を連日続けるとか、まとめて学習したほうがいいと思います。 (2)それにあたっておすすめの参考書またはサイト たぶん「これだけ１冊読めばいい」とはならず、辞書的な本、言語解説的な本とか、逆引き本が必要になると思います。また、データベースやＨＴＭＬとか、いろんな技術・知識が必要になりますので、書店で自分が必要でかつ理解できると思える書籍は、財布が許す限り全て購入すればいいと思います。
セキュリティ上、ある会員が他の会員の扱っている商品を簡単に見ることができていいのでしょうか？ また、会員というのが商店で、複数の商店の情報を比較しながら買い物する顧客が別にいる、 という話では、 ある会員が他の会員の扱っている商品を簡単に見ることができてはいけないが、 ある顧客は、複数の会員の扱っている商品を簡単に見ることができないとまずいです。 というのも要件の１つにはいるのですが。 A. 1.のDBの中に作る 方法が２通りあって A-1.同一ＤＢで複数テーブルにする。 　複数の会員が扱っている商品をみるのにはいささか不便。 A-2.同一ＤＢの同一テーブルにする。 　この件数から見ると、会員の数×数万～数十万件の商品というレコード数になり、 　ちょっとレスポンスが心配。 　会員の数が少なければレスポンス対策としてあえて、横持ちする手はありますけどね。 　（拡張性や正規化という点から言うと好ましくないですが。） 　例）商品コード,会員1,会員2,会員3,・・・ 　　　会員1が1なら会員1が扱っており、0なら会員1は扱っていない。 B. 各会員のDBを作ってその中に扱いたい商品のテーブルを作る C. 会員DBを作って会員ごとのテーブルを作る BとCの差があまりなくて、 Bのメリットは、サーバを分割しやすいという点と、会員間でデータを見れなくしやすいという点で、 デメリットは、商品を減らしたいときに、全会員のＤＢに接続して、１件ずつ消さなくてはいけない （CならＤＢ接続は１回ですむ。）、サーバを分割しにくい、複数の会員のデータを見るのが面倒 等ですね。 Aは、BやCと違って、サーバを分割なんて難しいし、 会員間でデータを見れなくしにくい（作りこみがいるというだけ）、 一方で、商品を減らすのはすごく簡単。複数の会員のデータを見るのも簡単。 といったところが長短として挙げられます。 どれを重視するかによって答えは変わってくると思います。 （あと用意できるＤＢサーバの性能と。）
ANO.1,2です。 >繰り返し、エクセルファイルを作成する試験を行ったところ、オブジェクト変数のclose処理を行ったのに改善されませんでした。 とは、私も意外でした。 なにか他に悪さをしている処理があるのでしょうけど、 ちょっと見当がつかないです。 ただ、最後に１個だけ、 ・・・ XLWS.Select With ActiveSheet.PageSetup ・・・ With XLWS.PageSetup に変えても動いたと思うのですが、 これでやってみてもだめでしょうか？ （ 例えばExcel自体が２個立ち上がっていると With ActiveSheet.PageSetup とすると、どちらのExcel？ってことになるように思われますので。 ）
こんにちわ。 > 何かわかる方が居ましたら教えて頂きたいです。 サービスが正常に起動していない事があると言う事は、正常に起動 している場合もあると言う事でしょうか？ そのような場合は、起動に時間がかかっているだけの可能性が高いです。 PC 再起動後暫く待ってから、接続を行った場合はどうでしょうか？ また、問題発生時のAlert log を見れば何か分かるかも知れません。
リンクテーブルへのリンクテーブルは張れないと思いますよ。
正直これだけの情報ではなんとも・・・・。可能性としてはラインターミネーターが\r\nじゃなくて\nなので全部が1行と解釈されて最初の2列だけに反応しているとかかね。 ↓の2つを試してみてその結果を教えてもらえますか。\r\nを\nと\rにそれぞれしたものです。 １． LOAD DATA INFILE "Prefecture.csv" -> INTO TABLE Prefecture FIELDS TERMINATED BY "," -> LINES TERMINATED BY "\n"; ２． LOAD DATA INFILE "Prefecture.csv" -> INTO TABLE Prefecture FIELDS TERMINATED BY "," -> LINES TERMINATED BY "\r";
販売管理システムだけであれば特に問題はありません。将来拡張した時点で必要であれば有償版にされれば良いと考えます。制限としてはCPUは１ソケットまたは４コアですのでクアッドコア以上のCPUのマシンを使えば４スレッドまで動かせます。メモリが最大１GBですが３２BitOS自体が最大４GB（内ユーザー領域2GB）であった時代でもそこそこ動いていたので、さほど問題にはならないと考えます。データベースは最大４GBですが、１データベース単位なので、１テーブルの容量が4GBを超えない限り、複数のデータベースに分散して持てば回避可能です。
顧客情報が重複しているというなら、SQLを副問い合わせと外部結合の組み合わせにすれば何とかなります。 select A.銀行No, B.銀行名, A.顧客No, C.顧客名, A.残高 from 口座 as A left outer join 銀行 as B on B.銀行No = A.銀行No left outer join (select distinct 顧客No, 顧客名 from 顧客) as C on C.顧客No = A.顧客No しかしそもそもテーブルの正規化が出来ていないという、関係データベースの基礎がおろそかになっているように思われます。 素直に重複が発生しないように、テーブル設計を見直してはいかがでしょうか。
まずmysql_** 関数を使うべきではないことはともかく ＞mysql_query('SET NAMES UTF-8'); 「UTF-8」→「UTF8」じゃない？
こんにちは。 下記のSQLを利用して簡単にバックアップすることができます。 DECLARE @Path nvarchar(200) DECLARE @DBName nvarchar(100) DECLARE @FileName nvarchar(100) DECLARE @FullFileName nvarchar(500) SET @Path = 'D:\backup' -- バックアップファイルを保存する経路 SET @DBName = 'master' --バックアップしたいデータベース名を記入 --　経路設定 SET @Path = @Path + N'\' + @DBName -- フォルダー生成 EXECUTE master.dbo.xp_create_subdir @Path --　ファイル名 SET @FileName = @DBName + N'_Backup_' + CONVERT(VARCHAR(10), GETDATE(), 120) + +N'_' + LEFT(REPLACE(CONVERT(VARCHAR, GETDATE(), 108),':','-'),5) --　経路 + ファイル名 SET @FullFileName = @Path + N'\' + @FileName + N'.bak' -- バクアップ実行 BACKUP DATABASE @DBName TO DISK = @FullFileName WITH NOFORMAT, NOINIT, NAME = @FileName, SKIP, REWIND, NOUNLOAD, STATS = 10 修正が必要なところは下記の２つです。 SET @Path = 'D:\backup' -- バックアップファイルを保存する経路 SET @DBName = 'master' --バックアップしたいデータベース名を記入
　そこそこの普通のシステムなら、普通に出来る規模かと思います。総枚数２０００枚程度であれば、「普通に考えれば処理できる」規模です。 　MySQLは、普通のパソコンクラスでも、数万～数十万レコード程度なら、充分に扱える程度のシステムです。 　フィールド数の方も、心配する領域としては、やっぱり桁が違います。 　画像を扱うための保存領域の容量だって、２０００枚程度なら、１枚２Ｍバイトとしても、４Ｇバイトほど。今時のハードディスクの保存容量からすればやっぱり桁が違いますね。 　ただし、普通に出来るとは書いたものの、あくまで、私的な領域で使うレベルでの話です。観客数が増えて、１秒あたりのアクセス数が・・・なんてレベルになるなら、やっぱりそれなりの構成と検討が必要です。が、これは、静的な普通のホームページでも同じ事です。
#1です。 1秒毎に１加算した（できた）として、どうやってソレを参照するのか？ 「何らかのテーブルの何らかの列に記録を繰り返す」が必須なのですか？ select sysdate from dual; を投げれば、システム日付・時刻を取得できます。 １）処理の開始時点のシステム日付・時刻を取得し秒数に変換して保持しておく。 ２）参照したい時点のシステム日付・時刻を取得し秒数に変換し、１）の秒数を減ずる。 で経過秒数になると思いました。
> SYSスキーマなどを含めてエクスポートしたいときには、 > Full=y　では無理だから各スキーマ（SYS、ORDSYS等）を指定して個別で > 行う必要があるということなのでしょうか。 SYS スキーマはシステムの持ち物なのでexp した事はありません。 その他も、Oracle Text やExpression Filter 等、Oracle の拡張機能をInstall した際に作成されるスキーマのため、ユーザが意識的にexp/imp する事はありません。 SYSスキーマにオブジェクトを作成しなければならない理由が無いのであれば、 新しいスキーマを作成してそちらにオブジェクトを移動した方が良いです。 テーブルのデータだけで良ければ、ユーザ作成後に Create table 新ユーザ.テーブル名 as select * from SYS.テーブル名; とすれば、コピー可能です。
【ARCHIVE_SAMPLE】 ArchiveID　Order_SampleID 1　　　　　2 2　　　　　1 【ARCHIVE_ORDER】 ArchiveID　Order_SampleID 1　　　　　1 2　　　　　2 こういうデータがあると抽出結果は2件になっていいんですか？ やりたいことはこうじゃないんですかね？？ SELECT M.* FROM ARCHIVE_SAMPLE M WHERE EXISTS ( SELECT AO.ArchiveID, AO.Order_SampleID FROM ARCHIVE_ORDER AO WHERE AO.Order_PatientID LIKE '%234%' AND M.ArchiveID = AO.ArchiveID AND M.Order_SampleID = AO.Order_SampleID ) また、LIKEでUPPER()を利用していますが、不要、かつカラムに指定することで インデックスが利かなくなります。
使ったことは無いのですが、phpPgAdmin 自体が php で動くスクリプトだと思います。 php とついているように。 実際ウエブサーバに置いたりして活用するようですし、ウェブサーバも必要ですね。 私のサイトにスキャンを仕掛けてくる人が定期的に存在しますし。 参考URL：http://www.kkaneko.com/rinkou/postgresinstall/ph …
　データベースをリモートでメンテナンスできるようにしようとすると、何らかの方法でMySQLにダイレクトにアクセスできる道を作ることになりますよね。その道を知っている人にとっては、残る関門は、ＩＤとパスワードだけです。別に、人のドメインに直接プログラムをアップロードするまでも無いので、IDとパスワードが漏れちゃったら、大変です。（MySQLでは、ID毎にクライアントのＩＰを制限するのが普通なので、そこまでは普通至らない物ですが。それでも、最大の関門を破ったことに変わりはありません。） 　さて、ルートディレクトリー配下で、スクリプトファイルに対して、クライアントからアクセスした場合は、普通は、スクリプト（例えばＰＨＰ）が実行されるのが普通です。これが正しい姿ですが・・・ 　webサーバーを一から構築した人は、クライアントからアクセスするとブラウザーにスクリプトのソースが表示されて、悲鳴を上げるという体験を、必ず一度はするものです。 　そう。webサーバーのちょっとした設定間違いで、簡単にこんな事故はおこるものなんです。 　さて、このスクリプトのソースにＩＤとパスワードが堂々と書いてあったら？はい。事故＝ＩＤ・パスワードの漏洩発生です。 　というわけで、クライアントからアクセスできる領域のファイルにはＩＤやパスワードは書きたくないものです。 　ですから、まず、ＩＤとパスワードを別のファイルに分けます。 　このファイルを同じ場所においたら、結果は一緒です。このファイル名はちゃんとスクリプトに書いてありますから、そのファイル名をurlにしてもう一度アクセスするだけになってしまいます。 　 　ですから、ルートディレクトリー配下には、このようなファイルは置かないようにするのです。さすがに、相当の間違いをやらかしても、ルートディレクトリー配下意外の場所をweb経由でアクセスできるようになんてことにはなりませんから、大分、安心度が大きくなります。（まぁ、ルートディレクトリーの設定そのものを間違えれば・・・でも、その場合は、別の心配をした方が良いです。被害はデータベースのデータを抜く程度では収まりません。でもサーバーのＯＳレベルで、webサーバーシステムのアクセス権限はルートディレクリー配下に制限することが普通ですから、その意味でも、ルートディレクトリの外は、結構厳重に守られている物です。） 　設定を間違えなくても、webサーバーのシステムにセキュリティーホールがあれば、同じ結果になることはあり得ます。でも、ルートディレクリー以外の所まで平気で見に行けるなんて巨大なホールはそうそう出ませんし、ちゃんと設定していれば、ＯＳの保護も期待できます。 　まぁ、セキュリティーに完璧はありません。少しでも、心配事をひとつずつつぶしていくのが基本です。心配事をひとつつぶす毎にセキュリティーは一段階上がります。
音楽管理ソフトは何をお使いですか？ ソフトによっては、ライブラリ中の楽曲の情報をCSV形式などで書き出せるものもありますけど。 当方が使用のMediaMonkeyですと、標準で選択ファイル群の情報をCSV形式やExcel形式で書き出せます。項目は固定で、アーティスト、タイトル、アルバム、長さ、録音年、ジャンル、評価、ビットレート、パス（CSVの場合）。 更に、CustomReportという追加スクリプトを入れれば、ソフトが管理してる情報のほとんどすべてから任意に出力項目を選んでCSV形式やExcel形式で書き出しも可能。 http://mediamonkey.xn--m8jfw.jp/index.php?%A5%B9 … タグエディタのMP3Tagでも上記と同様のことが出来ますね。 また、表計算ライクなタグエディタのSTEP、STEP_Mとかですと、セルを選択して直接Excelとの間でコピペ出来ます。 一旦Excelに読み込ませることが出来れば、後は如何ようにも出来ますよね。
なんとも言えませんが普通にこんな感じでやってみては？ set @str1='01234561',@str2='1'; select (char_length(@str1) - char_length(replace(@str1,@str2,'')))/char_length(@str2) as count;
単一のSQLでやりたいなら、CASE式とスカラサブクエリの組合せでいけるのではないかと。 なお、手元に環境が無いので Oracle では未確認です。 UPDATE table_hoge SET Qty = CASE No WHEN 1 THEN (SELECT Qty FROM table_hoge WHERE No = 2) WHEN 2 THEN (SELECT Qty FROM table_hoge WHERE No = 1) ELSE Qty END WHERE No IN (1, 2); 性能などを気にしないなら、最後の WHERE 句は不要です。 参考URL：http://www.geocities.jp/mickindex/database/db_ca …
こんにちは。 どんな方法でバックアップを行ったかは分かりませんが、 普通にバックアップを行うと「bak」,「trn」拡張子で作成されます。 「mdf」,「ldf」のファイルがありましたら、「ATTACH」で復元することができます。 利用方法は下記のとおりです。 CREATE DATABASE [データベース名] ON ( FILENAME = N'D:\SQL_Data\DBFileName.mdf' ) ,( FILENAME = N'D:\SQL_Data\DBFileName_log.ldf' ) FOR ATTACH GO 例えば、データベース名が「LogDB」だとしたら CREATE DATABASE LogDB ON ( FILENAME = N'D:\SQL_Data\LogDB.mdf' ) ,( FILENAME = N'D:\SQL_Data\LogDB_log.ldf' ) FOR ATTACH GO こんな感じになるかと思います。 FILENAMEのパスは正しく入力してください。 またUSBにあるファイルをサーバーにコピーしてからご利用ください。 上記のパスにUSBを指定してしまうと復元するデータベースがUSBと繋がってしまいますので、ご注意ください。
>>必要はディスク領域は400MBに対して私のPCは264MBしかありません。 必要なディスク容量が４００ＭＢと表示されていて、それを満たさないのですから、インストールがうまくいかないのは当然です。 ２００Ｖ用のモータを１００Ｖで使って、「規定のパワーが出ない」といっているようなものでしょうね。 ハードディスクを増設するか、不要なファイルを消して、４００ＭＢのフリースペースを確保して、再インストールしましょう。
私のアクセスにはないのですが、さんこうしょでみたことです。クエリーの中にユニオンクエリーと追加クエリーがあり、ユニオンクエリーでは二つのテーブルは合体することはないが、追加クェリーは合体するということです。参考にしてください。
>□現在、会社が違うレンタルサーバーを一つずつ借りています。・・・ 直接データベースを参照することはできないと思います。Web経由であれば可能です。例えばXMLで受け渡しする方法があります。 まずA社のサイトでデータベースからテーブル一覧を取得し、そのデータをXMLで出力するページを作成します。 B社のサイトはそのページにアクセスし、XMLを解析して一覧を表示します。 >□初心者がデータベースを作成するにはphpMyAdminを使用するのが一番良いでしょうか？・・・ phpMyAdminが一番いいと思います。MySQLのGUIツールでは一番利用者多いと思います。 phpMyAdminもテーブルにデータを入力していくのは簡単ですよ。 >□現在使用しているサーバーはMySQLが5つ使えると書いています。・・・ 可能です。データベースの中に複数テーブルを作るということになります。それが普通です。 野球の情報を管理するデータベースを作り、その中に試合の記録のテーブル、選手のデータのテーブルを作ることになると思います。他にも容量が許すかぎりいくらでもテーブルは作れますよ。 □スマホのサイトも作成しているんですが、PCサイトと同様にデータベースに接続し、一覧表示できるのでしょうか？・・・ できます。phpが動いているのはサーバ側なので関係ないです。
画像のデータからという意味では無理ですね。 画像にURLなどは記録されていません。 Googleの画像で検索する機能で同じ画像のあるサイトを発見することはできるかもしれません。 http://www.google.co.jp/insidesearch/searchbyima …
SQL Serverの話ですよね？ > ntextの代わりにnvarchar(4000)を使う そういうことでしたらそうしてください。 ただし、インデックスに使わないのであればnvarchar(max)の方がよいでしょう。 http://technet.microsoft.com/ja-jp/library/ms187 … > ntext 、text、および image の各データ型は、将来のバージョンの Microsoft SQL Server で削除される予定です。 　(中略) > 代わりに、nvarchar(max)、varchar(max)、varbinary(max) を使用してください。 で、本題の「nvarcharを使うときはとりあえずnvarchar(4000)でいいんじゃないか？」という話ですが、 1列または1レコードのサイズが大きすぎるとこんな落とし穴があるようです。 クエリ関連 http://msdn.microsoft.com/ja-jp/library/ms345371 … キー・インデックス関連 http://technet.microsoft.com/ja-jp/library/ms163 … http://technet.microsoft.com/ja-jp/library/ms143 … このあたりのことも理解した上でサイズを決めた方が良さそうです。
一般にいわれるレンタルサーバじゃ無理と思いますが。 接続文字列の中でポート番号を書きますが（書かなければデフォルトのポート番号使用。） このポート番号が、WebブラウザとAccessやVBで使うODBCやADO(ADO.Net)etcで違っていて 一般にいわれるレンタルサーバでは、Web経由のアクセスしかできない設定のはず。 普通、サーバ側のポート設定などさせてくれないし、設定できても、 ファイアーウォールを通過できないとかになりそうです。 とややこしいことは置いておいて、お望みのことは、 ホスティングサービス、とかクラウドサービスとか呼ばれるサービスを探してください。 ま、レンタルサーバ業者もやってますので、レンタルサーバで探して、ホスティングやクラウドの 項目を見るということになると思います。 これらは条件がまちまち。業者毎に違うと思ってもいいと思います。 で、設定は逆に、社内ＬＡＮにサーバを置いているのとほとんど一緒。 単に接続するIPアドレスが替わるだけ、といったパターンもあります。 （クラウドのPaasやホスティング） 但し、ＯＳやデータベースはこちらで用意するという条件になるかもしれません。 また、サーバの設定などもこちらということになるでしょう。 （通常のサーバへの導入とほぼ同じ手順を、特定のツールかリモートデスクトップ接続で接続した 　サーバに対して行います。ＣＤ－ＲＯＭとかは、大抵、クライアントに接続されている装置を使う。 　業者ごとにまちまちかもしれません。） クラウドのSaasなら、データベースまで業者持ちというのもあるのかもしれませんが、 こうなるとサーバの設定は業者側がしていて変更不可。 接続文字列とかに制限（ポート番号はこれ、とか）がついてくるかもしれません。 ちなみに、ネットワークはVPN(仮想プライベートネットワーク)にして外部とつながない、 （外部とつなぐなら、HTTPとか別の方法を使うべき） とかにしておかないと不正侵入されて大変困ったことになります。
$result = mysql_query(レス一覧取得SQL文); //最後のNo取得 $lastNo = mysql_num_rows($result); while($row = mysql_fetch_assoc($result)){ 表示処理(レスNoを出力場所で$lastNoを出力すればいい) $lastNo--; } ようは最初に最後のNoを取得し、１行表示ごとにマイナスしていけばいいということです。 mysql_queryなどと書いていますが、これは非推奨になっているのであまり使わない方がよいです。 mysqliなどを使いましょう。
order by GREATEST(a,IFNULL(b,a)) desc でもできるようです。 ※IFNULL(b,a) bがNullでなければb、Nullならaを返す。 基本的にはANo.1のかたの方法でいいと思いますが、 他の方法も示しておこうかなと思って書いています。 なお以下は蛇足です。 上のIFNULL同様に、 GREATEST(a, COALESCE(b, -2147483648)) DESC; は、 GREATEST(a, COALESCE(b, a)) DESC; でいいのではないかなと思いました。
どんな目的でインポートしたいのか分からないですが エクセルの1セルのデータはFMの1フィールドとなります。 1行が1レコードという意味です。 1レコードに全部入ったらDBとして何の意味も無いです。 単にエクセルのシートを保存したいという意味なら オブジェクトフィールドに挿入したらいいのでは？ エクセルなんか使わずに最初からFMにすればいいのに・・・
素直にその条件／動作のSQLを書けば良いかと。 例) UPDATE table_hoge SET b = a WHERE b IS NULL; 参考URL：http://dev.mysql.com/doc/refman/5.1/ja/update.html
http://oshiete.goo.ne.jp/qa/8318594.html で回答したものですが、投稿後クエリで可能 であることに気づいたのですが、気が付いた ときはすでに締め切られていたので、この場 をお借りして投稿しておきます。 クエリの内容はNo1の方と重複するのですが。 SELECT * INTO テーブルB FROM (SELECT 名前1 AS 名前,タイム1 AS タイム FROM テーブルA UNION SELECT 名前2 AS 名前,タイム2 AS タイム FROM テーブルA UNION SELECT 名前3 AS 名前,タイム3 AS タイム FROM テーブルA ) AS Temp;
クエリではできない、と思いますが。 以下、DAOで。 Sub test80() 　　Dim db As DAO.Database 　　Dim rs1 As DAO.Recordset 　　Dim rs2 As DAO.Recordset 　　Dim i As Long 　　Set db = CurrentDb 　　Set rs1 = db.OpenRecordset("テーブルA") 　　Set rs2 = db.OpenRecordset("テーブルB", dbOpenDynaset) 　　rs1.MoveFirst 　　Do Until rs1.EOF 　　　　'コメントアウトしている部分は参考 　　　　'rs2.AddNew 　　　　'rs2!名前 = rs1.Fields("名前1").Value 　　　　'rs2!タイム = rs1.Fields("タイム1").Value 　　　　'rs2.Update 　　　　'rs2.AddNew 　　　　'rs2!名前 = rs1.Fields("名前2").Value 　　　　'rs2!タイム = rs1.Fields("タイム2").Value 　　　　'rs2.Update 　　　　For i = 1 To 2 　　　　rs2.AddNew 　　　　rs2!名前 = rs1.Fields("名前" & i).Value 　　　　rs2!タイム = rs1.Fields("タイム" & i).Value 　　　　rs2.Update Next i 　　　　rs1.MoveNext 　　Loop 　　rs1.Close: Set rs1 = Nothing 　　rs2.Close: Set rs2 = Nothing 　　db.Close: Set db = Nothing End Sub
CDを購入すれば良いのでは。 http://www.stat.go.jp/data/k-sugata/index.htm
select A.FITEMNO from A , B , B B2 , C where C.FCHILDITEMNO = A.FITEMNO(+) and C.FPARENTITEMNO = B2.FITEMNO(+) /* (+)はいらない？ */ and A.FITEMNO(+) = B.FITEMNO and B.FITEMTYP(+) = 'P' /* (+)はいらない？ */ and B2.FITEMNO(+) = '123456789' /* (+)はいらない？ */ ん？Cの全件　×　FITEMTYP = 'P'であるBの全件　の件数だけ出したいの？ もし、それでよければ上のSQLででると思いますが（未検証）、 left outer join を使ったほうがわかりやすそう。 from (((C left outer join B on B.FITEMTYP = 'P') /* ひょっとしてこれはInner Join？ */ left outer join B B2 on C.FPARENTITEMNO = B2.FITEMNO and and (B2.FITEMNO = '123456789')) /* ひょっとしてこれはInner Join？ */ left outer join A on C.FCHILDITEMNO = A.FITEMNO and A.FITEMNO = B.FITEMNO) こちらも未検証。left outer join B as B2 on・・・でないとだめだったかも。
適正なインデックスがあれば特にスピードは変わらないと思いますが？ //元データ create table user(user_id int,user_name varchar(20),index(user_id,user_name)); insert into user values(1,'aaa'),(2,'bbb'),(3,'ccc'); create table user_agreements(user_id int ,money int,index(user_id,money)); insert into user_agreements values(1,5000),(2,3000),(2,5000),(1,8000),(2,4500),(3,10000),(3,2500); //例1 select user_id,count(money) as money,user_name from user inner join user_agreements using(user_id) group by user_id; //例2 select user_id,(select count(money) as money from user_agreements where user_id=t1.user_id) as money,user_name from user as t1; //例3 select user_id, money,user_name from user as t1 inner join (select user_id,count(money) as money from user_agreements group by user_id) as t2 using(user_id); 例1と例2はほぼ同じ、例3は若干効率が悪いかもしれません
たとえば、 update A set numStr = case numStrの長さ when 4 then '0000' when 6 then '00' else '' end || numStr where numStr is not null; みたいな感じでいいと思うのですが、パッとInterbaseのリファレンスを見た限りでは 文字列の長さを取得する関数はないようですね・・・。 Interbaseについて全く知識がないので的外れかもしれませんが、 http://www.geocities.jp/kimura804/rdb/InterBase/ … こちらのページのようなプロシージャを作ったらうまくいくのかもしれません。 なにかの参考になれば幸いです。
無理、無駄 というか、顧客ごとにテーブルを作っているなら横断的に検索させたら わける意味がなくない？ そんなことするならtableid的なカラムつくるだけで全て解決するし （プログラムの修正が行えないという時点でそういう選択肢はないのでしょうけど）
桐は持ち合わせていませんが・・・。 ODBCの設定では？ C:\Windows\SysWOW64\odbcad32.exe を立ち上げると32bit版の設定ができますので、 システムDSNにエクセルの設定を追加。 名前は適当で構いません。 これを桐で使用したら出来るかもです。 AccessからVBAでODBC経由で接続した経験からですので どうかな？ http://support.microsoft.com/kb/942976/ja
> XAMPPは、「Webサーバ ⇔ PHP ⇔ MySQL」を一台の > パソコンで構築できるとの認識で間違いないでしょうか！？ はい，間違いないです。 > 「各端末 ⇒ Webサーバ ⇔ PHP ⇔ MySQL」 > その図を、客観的に見た場合、 > ３台のパソコンで構築されているように見れます。 いいえ，次のような表現が一般的に用いられているように， 「１台のサーバ機で，WebサーバとDBサーバとメールサーバが稼働している」 サーバという用語は， ハードウェアを指す場合もありますし（例：サーバ機） ソフトウェアを指す場合もあります（例：Webサーバ）。 Webサーバというソフト単位，PHPというソフト単位，MySQLというソフト単位， が連携しているということを客観的に示しているのであり， それが３台のハードウェアに分かれているかどうかは示していません。 各端末，というのも，正しくはハードウェアではなく， Webブラウザというソフト単位を指しているはずです。 「Webブラウザ，Webサーバ，PHP，MySQL」すべてのソフト単位が１台のPC内にあり， その１台のPCがWebクライアントでもあり，かつ，Webサーバでもある。 というのは，小規模な実習環境においてよく用いられている形態です。
効率良くというか、普通のupdate文・delete文ですが・・ update テーブル T1 set T1.カラムD = (select カラムD from テーブル T2 where T2.カラムA = 'aaa' and T1.カラムB = T2.カラムB and T1.カラムC = T2.カラムC) where T1.カラムA = 'bbb' and exists ( select * from テーブル T2 where T2.カラムA = 'aaa' and T1.カラムB = T2.カラムB and T1.カラムC = T2.カラムC ); delete from テーブル T1 where T1.カラムA = 'aaa' and exists ( select * from テーブル T2 where T2.カラムA = 'bbb' and T1.カラムB = T2.カラムB and T1.カラムC = T2.カラムC ); こんな感じでどうでしょうか。
> <meta http-equiv="Content-Type" content="text/html; charset=euc-jp"> > mysql_query("SET NAMES 'utf8'"); そもそも、プログラムは何の文字コードで書かれていて、データベースの文字コードは何になっているんでしょう？ 上記の記述だと、既に文字コードで相違がおこっていますので、うまく日本語が扱えていないのではと思います。 それと、データベース側のフィールドはちゃんと日本語がはいる型（varcharやtext）になっているのでしょうか？ テストされたURLとサンプルコードなど、何か提示があれば回答しやすいかと思います。
ACCESSからＯracleへのリンクテーブルですか？ ACCESS上でパススルークエリ以外のクエリなら、to＿charでは無くformatを使います。 insert table into (format(now(), 'yymmdd'), ......); です。
No2です 蛇足ではありますが、示したページにはボタンで実行するように説明さてれてますが、アクション名：キー送信、キー操作：%TDCをご自身のマクロの最後に付け足すということで実行してください。 もちろん、ページのように最適化マクロという名前にしてご自身のマクロから「マクロの実行」「最適化マクロ」で実行させてもよろしいでしょう。 ただし、ページに書かれている注意事項は確認しておいてください。
and (concat(MyCol1,' ',MyCol2) like '%いちご%' and concat(MyCol1,' ',MyCol2) like '%ソーダ%') とでもすれば手っ取り早いと思いますが。 concat()・・・文字列をつなげます。 http://dev.mysql.com/doc/refman/5.1-olh/ja/strin … 具体的には、 ID　Concat(MyCol1,' ',MyCol2) -------------------------- 1　いちご みかんジュース 2　ぶどう いちごみるく 3　みかん すいかジュース 4　すいか めろんソーダ 5　めろん ぶどうガム となり、「いちご」と「ソーダ」をorでつなげば、1,2,4がでてきます。 （なお、andでつなぐと、質問にかかれた1,2,4でなく、1件もでてこないですが。） なんで、,' ',をいれているかというと、 6 といち ごりら とあると Concat(MyCol1,MyCol2) では、 6 といちごりら となり、「いちご」が見つかってしまうためです。
ストアドファンクションを作ってください。 8.1でもsplit_part関数は使用できるようですから、 これで数値部分を取り出して加算していけばいいかと思います。 まあ、カンマの数が例えば最大で10個とか決まっている場合は、 split_part関数を利用して力技でSELECTだけで完結させることもできそうですね。
Private Sub calendarForm_DateChanged(newDate As Date) 　　Me.[日報選択] = newDate 　　Call 日報選択_AfterUpdate End Sub では、どうですか。 あるいは、 Private Sub calendarForm_DateChanged(newDate As Date) 　　Me.[日報選択] = newDate 　　Me!F_日報商品売上.Requery 　　Me!F_日報扱い現金.Requery 　　Me!F_日報扱いクレジット.Requery End Sub これでは。 もし、構文エラーになるなら、メニューの [デバッグ]-[****のコンパイル] で反転選択される部分のコードを教えてください。
(1) 解りません。 もちろんkgyqk433さんがそのように要求される権利はありますが、私が従う義務はありませんので従いません。 この後に発言するかどうかはその時に決めます。 (2) 既に回答済みなので、読解力があるならご一読ください。
＞条件としては、最適化をVBAなどでするのではなく、 ＞　マクロのコマンド：データベースの最適化 ＞でしたいと思っております。 自分自身のmdbを最適化するのは不可能です。 何故なら、マクロの実行中は「自分自身が開かれている」からです。 仕様で「開かれているデータベースは最適化は不可能」になっていますから、結果的に「自分自身は最適化不可能」なのです。 なので、最適化を自動でやる場合は「マクロでは絶対に不可能」です。最適化を自動でやる場合は「VBAで、開かれていない、自分自身以外のデータベースを最適化するしかない」のです。 ＞※具体的手順を記載できない場合は、この質問は無視して下さい。 無視する訳にはいきません。 「不可能」ですから「具体的手順を記載できない」ですが、だからと言って無視し続けていると、質問者さんは「記載できる人が出てくるまで、諦めない」でしょう？ そうすると「不可能だって事に気付かず、無駄に何度も何度も質問し続ける」って事になります。 「できないものはできない」ってのが判ったら、VBAで行うとか、他の方法を考えて下さい。 ＞私の質問文が悪く、希望する回答をえれませんでした。 違う。「貴方の希望する回答が存在しない」のだから、質問文が悪かった訳じゃない。 「無いものは無い」のだから、諦めなさい。
>>となると、データベースを扱うという部分ではパフォーマンスはあまり変わらないのでしょうか？ Oracleは、データベースとしてパフォーマンスと耐障害、信頼性を十分に考えた作り方をしていると思います。 Oracleの内部動作について学べば、「プログラマーとして考えたら、こういう作りにするだろうなあ（作るのは面倒だけど・・）」と思えるような正当派の堅実なやり方をしているように思えてきます。 ですので、たぶん、大規模になれば、オープンソースソフトよりも、パフォーマンスがいいような気がします。 でも、個人ベース、中小企業レベルでは、そこまでの大差はつかないような気もします。 たぶん、どのソフトを使うかという場合、単なる速さ以外にも、さまざまな要求項目が出てくると思います。そういう中で、消去法によって残るのがOracleが多いってことだと思いますし、要求項目が少ないなら、オープンソースのソフトから選んでもいいように思います。 そして、データベースを選択するときは、単なるパフォーマンスだけでなく、「自分がこの部署を去ったあとも、システムを維持できるか？」なんてことも考えることになると思います。 そこまで考えたとき、「コストパフォーマンスとしては、最高ではないかもしれないけど、代わりの技術者が得やすくて、安心して使える有償のＤＢを選択する」という判断となることもあると思います。
プロシージャに直接ショートカットキーを割り当てることはできませんが、マクロならできますので、 マクロからプロシージャを呼び出すようにして（プロシージャの実行）、そのマクロにショートカットキーを割り当てればどうでしょうか。 マクロにショートカットキーを割り当てる方法は下記を参照してください。 キーボード ショートカットを使用して Access マクロを実行する - Access - Office.com http://office.microsoft.com/ja-jp/access-help/HA …
マクロの最後に最適化を入れたいという理由は、ワークテーブルを使用していて、大量データの削除・追加を繰り返すのでMDBファイルサイズが肥大化するのに対処したいということでしょうか。 もし、そうなら、テーブルだけのMDBファイル（データMDB）と、クエリ、フォーム、レポート、マクロ等のMDBファイル（アプリMDB）に分割してアプリMDBからデータMDBのテーブルをリンクするという設計に変更すればどうでしょうか。 ワークテーブルもデータMDBに作成します。 そうすれば、アプリMDBの方から、データMDBを最適化できます。また、アプリMDBはデータの追加・削除は発生しませんのでファイルサイズの肥大化は防げます。 また、このように分割しておくと、MDBの破損の危険性が減らせますし、アプリMDBが破損してもデータは残る、など安全性が高いというメリットもあります。
フィールドA&" "&フィールドB&" "&フィールドC などの計算フィールドを作るだけでは？
うーん、いまいち意図がよくわかりませんが こういうことでしょうか？ //元データ create table mytable(year int not null,number int not null); insert into mytable(year,number) values(2005,1),(2005,2),(2005,3),(2008,4),(2008,5),(2008,6),(2008,7),(2008,8),(2010,9),(2011,10),(2011,11),(2011,112); //検索 select year,number,(select if(max(number)=t1.number,1,null) from mytable where year=t1.year) as myflg from mytable as t1
> マクロの一連の流れの最後で、データベースの最適化をしたいと > 思っていますが、具体的にどのようにすれば、 > データベースの最適化を実行できるのでしょうか？ 一連のマクロの最後に最適化するということなら可能だと思いますが、 一連の流れの途中に入れるは原理的に不可能だと思います。 最適化はいったんデータベースファイルを閉じますので。 方法は下記を参照ください。 Access2003以前の場合 開いているデータベースを最適化する(Access VBA) http://www.ka-net.org/office/of05.html Access2007 開いているデータベースを最適化する(Access 2007 VBA) http://www.ka-net.org/office/of06.html VBAになりますので、上記の Sub を Function に書き換えて、マクロの「プロシージャの実行」で呼び出します。
SELECT C1, ( CASE MIN( CASE C2 WHEN 'R' THEN 1 WHEN 'P' THEN 2 ELSE 3 END ) WHEN 1 THEN 'R' WHEN 2 THEN 'P' ELSE 'S' END ) AS C2 FROM Table1 GROUP BY C1 ORDER BY C1
こちらがお勧めです。 http://www.microsoft.com/japan/office/previous/x … 「その設定の解除方法について」にも目を通しておくことをお勧めします。
Accessにぴったりの要件のように思います。 提示された要件はAccessですべて可能です。 ビジュアルスタジオ等の開発環境だと、一からすべて作成していく必要がありますが、Accessなら、テンプレートやウィザードである程度の雛型はできるので、それをもとに手直したり、機能追加したりという形で開発できるので、かなり楽できます。 プログラミング知識がなくても、ウィザードやプロパティの設定である程度のものは作成できますし、VBAを使用してプログラムすればかなり高機能なことまで可能です。 画像データの管理に関しても、2003以前のバージョンでは弱かったですが、最近のバージョンは強化されて楽に扱えるようになりました。 パーソナルに使うなら問題なくお勧めです。一桁台の人数までなら共有する運用でも使用できます。MSの製品ということもあってユーザーも多く情報も豊富にあり簡単に入手できます。 ただ、まがりなりにもデータベースなので、テーブル設計にはそれなりの知識が必要です。それなしエクセルの間隔でテーブル設計をすると使い物にならないものになります。データベースに関数する知識は他にも活かせるので苦労してでも取得しておいて損はないです。 入門書や初心者向け解説サイトは豊富にありますので、まずはその中から自分の目的にあいそうなものを見つけるといいでしょう。顧客管理をサンプルに解説しているものも見つかると思います。
そのmdbファイルをAccessw2000で開いた時、フォームが自動で表示されるようにしているのでしょうか？ 確かAccess Runtimeで使用するにはそれが前提だったはずです。 Autoexecという名前のマクロを作り、フォームを開くなどで起動後の動作を指定するのが約束事。 http://www.naboki.net/access/heaven/heaven-01.html こちらの「ランタイムはデータベースウィンドウを表示できない」にかかれてますね。 で、Autoexecマクロを作成するとRuntimeじゃないAccessで開くときも自動実行されます。 デバックやフォームのデザイン変更を行いたいときは、mdbファイルを開くときにShiftキーを押しながら開けばAutoexecは無視されるはずです。
質問としては、新規の書込みがあったスレッドの上位20件を取り出すSQLが知りたい、という事で良いでしょうか？ そうであれば、 bbs_id 毎の最新の time を比較して、その新しい順に並べ、上位20件分の bbs_id を取得すれば良いかと。 SELECT bbs_id, MAX(time) FROM bbs GROUP BY bbs_id ORDER BY MAX(time) DESC LIMIT 20; ※ bbs_id はタイトルごとのIDとなっていますが、タイトル＝スレッドの様なので、スレッドを表す番号と仮定しています。 参考URL：http://dev.mysql.com/doc/refman/5.1/ja/select.html
基本はmysqldumpでしょうけど、毎回100万件全てが更新されているとは思えないので ほとんどのデータが前回のままであるなら、差分バックアップでもある程度は 精度は保てるでしょう ただし、レンタルサーバーのmysqlだとCUIでコマンドを実行できないかもしれないので 用意されたツールの範囲でやるしかありません 参考URL：http://www.atmarkit.co.jp/ait/articles/0107/24/n …
動的SQL http://stackoverflow.com/questions/5019041/how-t …
下記のSQLてどうでしょう。 SELECT * FROM テーブル名 WHERE 名前 Not Like "[tk]*" AND 入社日 Between "19900101" And "20000101";
　質問の例題が、あまりにも省略されている為に、正確な要件が解らなくなってしまっています。 　おそらく、商品テーブルにも在庫テーブルにも、そのほかのフィールドがあるはずですよね。そうで無いと、在庫テーブルはレコードの特定が出来ませんし、商品テーブルに至っては存在価値を疑ってしまいますので・・・ 　で、質問の結合方法も、そのほかのフィールドがらみで方法が変わってきそうです。 　本当に、質問内容だけでしたら、一番単純な解は、 select distinct ID from 在庫テーブル 　です。結合の必要なんてありません。 　こんなのも、いちおうあり・・・ですが・・・ 　select distinct z.ID from 商品テーブル s join 在庫テーブル z on s.ID=z.ID 　これで、少なくとも、商品テーブルに存在する商品ＩＤのうち、在庫テーブルに存在する商品の重複の無いＩＤが取得できます。が・・・普通、商品テーブルに存在しない商品IDてのが想像しがたいので、意味があるかどうか・・・ 　普通は、この類のテーマだと、 select s.ID, sum(z.数量) from 商品テーブル s join 在庫テーブル z on s.ID=z.ID group by s.ID 　等とやって、「商品の在庫量が知りたいです」となるんですけど・・・ 　さて、いったい何がやりたいのでしょうか？ 　「いろいろとやりたいこと」の内容を書かれた方が、的確な答えが返ってくると思います。
＃1ですが、No列が文字型の場合なら大小判定がおかしくなるかも。 No列は数値型として下さい
私が思いついたのは、結合して GROUP BY を使う方法とSELECT句内のサブクエリを使う方法でした。 version 5.5.8 で確認しました。 ■ 結合して GROUP BY を使う方法 SELECT a.id, COUNT(b.A_id) AS count FROM table_a a LEFT OUTER JOIN table_b b ON(a.id = b.A_id) GROUP BY a.id; ■ SELECT句内のスカラサブクエリを使う方法 SELECT id, (SELECT COUNT(*) FROM table_b b WHERE a.id = b.A_id) AS count FROM table_a a; 参考URL：http://gihyo.jp/dev/serial/01/sql_academy2/001003
http://pgfoundry.org/frs/?group_id=1000140
>>ACCESSでローカルに作成したデータベースを WEB上で使用できるようにすることはできますか?? はい、条件付きで、できますよ。サーバ機のＯＳとしてWindowsOSを使っていることが必要です。offec365では無理なように思えます。 まずは、自宅サーバであれば、Windowsサーバを用意すればいいだけですね。レンタルサーバの場合は、以下のようなWindowsベースのサーバを使っている業者と契約すればＯＫです。 http://www.datajapan.ne.jp/expressweb/ ただ、ローカルにてACCESSで作成したアプリは、Ｗｅｂ対応じゃあないので、そのままでは使えないですよ。 お手軽にWebアプリとしてじゃあなく、クライアント／サーバ的に動作させるなら、リンクテーブルとしてサーバ上のＭＤＢファイルを、ローカルのACCESSアプリから使うような方法になると思います。ただし、多人数で同時使用には向かず、処理速度が遅くなると思えます。 きちんとしたWebアプリにするなら、ACCESSはデータベースとしてだけ使い、アプリ部分はASP.Netで作り直すことになると思います。 ＭＳや有志の提供でACCESSからASP.Netにアプリを変換するツールもあるようですが、１００％の自動変換はできないので、手作業でのプログラム修正・追加になると思います。 ただ、ここまでやるなら、ACCESSではなく、SQLServerをデータベースとして選んだほうがいいでしょうね。
仕様が微妙ですが、単純に考えればこんな感じ？ select * from tblA left join tblB on tblA.id = tblB.id and tblB.del_flg=0 left join tblC on tblA.id = tblC.id and tblC.del_flg=0 where tblA.del_flg=0 ただし、tblBは複数ある可能性があるため分けるのは妥当かもしれませんが tblCはtblAの機能の一部の方がよいのでは？ すなわち未婚、既婚、以前既婚の状態は排他関係にあるので、複数にならず 既婚カラムで管理すればすっきりするので・・・
ANo.1の方がショックを受けておられたようですが、 DB2にisnumeric等の文字かどうかや数値かどうか等を判定する関数は、なかったと思います。 以下はAS400のDB2のマニュアルですが。。。（すぐに見つかったのがこれだったので。） http://publib.boulder.ibm.com/html/as400/v4r5/ic … ということで、 ANo.1の方が書かれているＵＲＬの方法を応用するとか、 select max(項目名１) from テーブル名１ where length(trim(translate(項目名１,' ','0123456789'))) = 0 とするとかしないとダメと思います。 注：このwhere句の意味。 (1) translate(項目名１,' ','0123456789') 0から9までの数字を空白にする。 (2) trim( ・・・ ) 前後の空白を除去する (3) length( ・・・ ) 長さを調べる。 0から9までの数字は空白に置き換えられた後、他の文字がなければ、trim()で消去され、 長さ０になっています。 ただし、空白が途中に入っていても数値とみなしてしまうので、'12 3'等があれば使えません。 未検証です。 マニュアルの文法では、 translate(項目名１,変換先文字列,変換元文字列) と書いてあったので多分大丈夫と思いますが。 （Oracleなんかと逆なのでちょっと気がかり。ご自身の持つマニュアルで確認するなり、 　動かしてみて確かめるなりしてください。）
SELECT 組 ,1+IIF([タイムA]>[タイムB],1,0)+IIf([タイムA]>[タイムC],1,0) AS Aの順位 ,1+IIf([タイムB]>[タイムA],1,0)+IIf([タイムB]>[タイムC],1,0) AS Bの順位 ,1+IIf([タイムC]>[タイムA],1,0)+IIf([タイムC]>[タイムB],1,0) AS Cの順位 INTO テーブルＢ FROM テーブルＡ; イムA],1,0)+IIf([タイムC]>[タイムB],1,0) AS Cの順位 FROM テーブルＡ; 同一のタイムが複数ある時については何も書いていないので考慮していません。
そもそもがUNIONの用途として正しくない気がしますしね。 複数のテーブルの同一キーのデータを簡単に取れないというのは、設計がよくないのではないかという気がします。 >１つ１つNULLを設定するのは難しいかと、、、 とありますが、ただ面倒だということですよね？ ひとつひとつ項目を列挙していくだけなので難しいことはないと思うのですが。 たしかに、テーブルや項目が多ければ大変だとは思いますが、やらなければいけないことならやるしかないと思います。 役に立つか分かりませんが、複数のテーブルの全項目をUNIONで取得するSQLを組み立てるSQLを考えてみました。 --全角スペースでインデントしています select 　　case 　　　　when COL_NUM = 1 then 　　　　　　case 　　　　　　　　when TAB_NUM > 1 　　　　　　　　then 'UNION ALL' ||CHR(10) 　　　　　　end 　　　　　　|| 'SELECT' || CHR(10) 　　　　else ',' 　　end || coalesce(P_COLUMN_NAME, 'NULL') || ' AS ' || L_COLUMN_NAME || case 　　　　when max(COL_NUM) over() = COL_NUM then 　　　　　　CHR(10) || 'FROM ' || TABLE_NAME 　　end from 　　( 　　　　select 　　　　　　TABS.TABLE_NAME 　　　　　, COLS.COLUMN_NAME L_COLUMN_NAME 　　　　　, TAB_COLS.COLUMN_NAME P_COLUMN_NAME 　　　　　, dense_rank() over(order by TABS.TABLE_NAME) TAB_NUM 　　　　　, ROW_NUMBER() over(partition by TABS.TABLE_NAME order by COLS.COLUMN_NAME) COL_NUM 　　　　from 　　　　　　( 　　　　　　　　select distinct COLUMN_NAME 　　　　　　　　from USER_TAB_COLS 　　　　　　　　where TABLE_NAME in ('Aテーブル', 'Bテーブル') --対象のテーブルを列挙してください 　　　　　　) COLS 　　　　cross join 　　　　　　( 　　　　　　　　select TABLE_NAME 　　　　　　　　from USER_TABLES 　　　　　　　　where TABLE_NAME in ('Aテーブル', 'Bテーブル') --対象のテーブルを列挙してください 　　　　　　) TABS 　　　　left join USER_TAB_COLS TAB_COLS 　　　　on 　　　　　　( 　　　　　　　　TAB_COLS.TABLE_NAME = TABS.TABLE_NAME 　　　　　　and TAB_COLS.COLUMN_NAME = COLS.COLUMN_NAME 　　　　　　) 　　) order by 　　TAB_NUM 　, COL_NUM ; これを実行すると、たとえば今回提示されているテーブル定義であれば、 SELECT 内容 AS 内容 ,所属 AS 所属 ,日付 AS 日付 ,時間 AS 時間 ,NULL AS 理由 ,社員番号 AS 社員番号 ,結果 AS 結果 FROM Aテーブル UNION ALL SELECT 内容 AS 内容 ,NULL AS 所属 ,日付 AS 日付 ,NULL AS 時間 ,理由 AS 理由 ,社員番号 AS 社員番号 ,NULL AS 結果 FROM Bテーブル というSQLが出来ます。 これをインラインビューにして、SELECTする項目順を入れ替えたり、不要な項目を削除したりすれば少しは楽になるかもしれません。
cint( )でDLookupを囲う。 テキストボックスの値をNz( )で囲うと、なお良いかも。
> それで、できれば、エクスポートされたデータをそのままエクセル表示させ > エクセル側で修正したいのでお聞きしています ん？　テキストエディターだけでなくエクセルで開いても改行部分がおかしいって事？　詳しい状況求む。 ・テキストエディターで開いたら問題がある。→エクセルで開いた時に問題なければ問題ないでしょう？ ・エクセルで開いたら問題がある。→どういう問題があるか教えてください。 前回の回答でも触れているけど、エクセルはダブルコーテーションでくくられたセルデータ中に改行が含まれていた場合、正しくセル内改行として取り込んでくれる。 数字が入った文字列とかは前ゼロが消えるという問題はあるけど、今回の件には関係ない話だ。
サーバー側でローカルのフォルダを指定しても無意味 一度サーバーに落としたものを拾う仕組みにするか phpMyAdminのエクスポート機能でブラウザの設定による ダウンロード処理をするしかないです
単純に infile '入力ファイル名' "str '@\r\n（か@\n)'" でダメですか？
こんにちは。 下記の私の回答に少し間違いがありました。 「root139」さんの回答が正しいですね。 大変失礼いたしました。 よろしくお願い致します。
>ご回答では15分区切りのselect文ですが、30分区切りで予定を入れられるように変更したい場合、all_datetime_tblのデータを全件30分毎に作成し、select文のinterval 15 minuteの部分をinterval 30 minuteに変えるだけでよいのでしょうか？ その通りです。 あとjikan_tblのデータも30分間隔に変更してくださいね。 >このように確認時点から少し時間が経過すると10:45～11:00の予定が入れられないことになりますが、対処方法が分からないのでこの対応にしました。 もし、その時間的なずれを、この機能に盛り込んでしまいたいというのであれば、 -------------------------- where concat(each_datetime, ':00') > now() and start_datetime is null -------------------------- を -------------------------- where concat(each_datetime, ':00') > date_add(now(), interval 1 minute) and start_datetime is null -------------------------- とすれば、基準となる時刻を1分うしろにずらすことができます。 別にネガティブな話をしたのではなくて、現実的な対応を考えると、基準となる時刻（確認時刻）が現時刻ジャストでは無理があるんじゃないですか？という意味だったのです。
失礼しました。 COUNT(*)だと表2にレコードが存在しない場合も表1の1件を返してしまうので COUNT(*)　→　COUNT(表2.id_no) に変えてみて下さい。
datetimeバージョンをざっと //元データ create table t_jikan(start datetime,end datetime); insert into t_jikan values('2013-09-27 10:00','2013-09-27 10:15'),('2013-09-27 10:15','2013-09-27 10:30'),('2013-09-27 10:30','2013-09-27 10:45'),('2013-09-27 11:00','2013-09-27 11:15'),('2013-09-27 11:30','2013-09-27 11:40'); //後ろ時間が空いているviewをつくっておく create view v_jikan as select j1.start,j1.end from t_jikan as j1 left join t_jikan as j2 on j1.end=j2.start where j2.start is null; //空き時間一覧 select v1.end as start,min(v2.start) as end from v_jikan as v1 inner join v_jikan as v2 on v1.end < v2.start group by start; //特定時間の直近の空き時間 select v1.end as start,min(v2.start) as end from v_jikan as v1 inner join v_jikan as v2 on v1.end < v2.start where v1.end>='2013-09-27 10:00' group by start order by start limit 1; ここで'2013-09-27 10:00'を '2013-09-27 10:45'や'2013-09-27 10:50'や'2013-09-27 11:50'に 変えると状況がヒットするレコードが変わることがわかる
SQL Server 2005 Express は、Vistaまでのようです。(正式サポートは) http://technet.microsoft.com/ja-jp/library/ms143 …(SQL.90).aspx Windows7で利用できるのは、2008以降のようですね。 http://technet.microsoft.com/ja-jp/library/ms143 …(v=sql.100).aspx > もし対応していたとしても新しいExpress Editionに変えた方が良いでしょうか？ SQL単体での利用であれば、新バージョンの方がOSとの適合と言う点で推奨しますが、、 大抵はSQLを利用しているアプリケーション側に大きく依存する事となると思いますので、そちらの方の確認を。
テーブルデザイン画面で、入力を必須とするフィールドのRequired/値要求" プロパティに「はい」を設定すればよいと思います。 試して見てください。
記載のデータって正しいですか？ このデータだとID:2～4が連続することになると思うのですが。 正しいデータが不明なので、期待どおりの結果が取れるか分かりませんが、 select min(START_DATE) START_DATE, max(END_DATE) END_DATE from( select ID, START_DATE, END_DATE, sum(TERM_START) over(order by START_DATE, END_DATE) TERM_ID from ( select ID, START_DATE, END_DATE, case when START_DATE >= LAG(END_DATE, 1) OVER(ORDER BY START_DATE, END_DATE) THEN 1 else 0 end TERM_START from EVENT ) ) group by TERM_ID order by START_DATE, END_DATE; こんな感じでどうでしょうか。
一例。
#1さんの回答の考え方で良いと思いますが、HAVING句の位置と綴りに間違いが有るようです。HAVING句は GROUP BY句の後に書きます。 SELECT id, SUM(num) FROM teble GROUP BY id HAVING SUM(num) >= 20; また、サブクエリを使っても同様のことは実現できます。 SELECT * FROM (SELECT id, SUM(num) AS sum_num FROM teble GROUP BY id) a WHERE sum_num >= 20; HAVING句を使った方がスマートだとは思いますが。 参考URL：http://dev.mysql.com/doc/refman/5.1/ja/select.html
select ID, DT, BUMON from ( select ID, DT, BUMON, row_number() over(partition by ID order by DT desc) rnum from TB ) where rnum = 1; なんてのでもいいと思います。
> この1件のデータをインポートをさせた時、サーバ側にある1000件のデータにプラスされて1001件になるでしょうか いえ～すざっつらいと。 > それとも、1000件の上にインポートされたデータがかぶせられて、1000件のデータがなくなり1件になってしまうのでしょうか の～！ ただ、CSVでデータをやりとりするのはお勧めしない。Excelが悪さをする事もあるし。SQLでエクスポートした方が安全かも。 それに、phpMyAdminを使ってるんだったら適当な行を表示してコピーすればいいんじゃない？　行を表示した時にチェックボックス、編集、コピー、削除って出てるでしょ（phpMyAdmin 3.5.7で確認）。そこでコピーを選ぶと、元のデータが全列に入った状態でinsert画面になる。そこでちょこちょこっと値を書き換えて登録した方が楽チンだと思うけどな。
ACCESSからやると接続文字列テストは面倒なので単体でってみるとか。 デスクトップで右クリック＞新規作成＞テキストファイルとやって ファイル名はTEST．UDLとでもして下さい。 「表とＰＣ」みみたいなアイコンに変るので起動。 ここで順を追って進めて下さい。
Order by 項目名　asc/desc で、項目名に case文は、使えるけど、 asc/desc にcase文は使えません。 (1つ目のCase文は項目名を指定しているのと同じで、1レコードずつ処理されて同じCase文の結果を 1レコードづつ返していると思うけど、内部処理の話なのではっきりしたことはわかりません。) >2つ目のCase文（：LINE）を消し、最初のCase文だけを残して、並び順（DESC・ASC）を埋め込むと、 >実行される状態になります。 では、デフォルトのascが適用されて実行できている。 じゃあどうすれば実現できるのかといわれると、 SQLを発行している元の処理が何かわからないので最善かどうかはわかりませんが、 SQLで実行するなら、 Select case ：LINE when '1' then (row_Number() Over(Order by Case ：ITEM When 'PJコード' then PJコード When '部署コード' then 部署コード end desc) when '2' (row_Number() Over(Order by Case ：ITEM When 'PJコード' then PJコード When '部署コード' then 部署コード end asc) end .... とでもするしかないと思います。 ※未検証。
1の関連コードと言うと、マクロの内容を記載すればいいのでしょうか？ ・サブフォームのレコードソース。 　　-->サブフォームをデザイン表示しプロパティで確認。 ・マクロ（VBA）のコード。 　　-->どこかに XXXXXXX.Requey のコードがあるはず。 　　レコードソースから不具合の引き金になっているテーブルが判明。 　　それを手掛かりに、問題の日付以後の全データを削除。 　　（もちろん、バックアップしておいて・・・） 　　先ずは、このテーブルの破損個所の修復テストでどうなるのか？ 　　レコードソースのSQL文の変更と不具合との関係もテスト。 　　SELECT 列名 FROM テーブル名 WHERE 列名 BETWEEN 値１ AND 値２; 　　もしかしたら、 BETWEEN "#2013/09/09#" AND "#2013/0910#" 　　という書き方だとエラーは発生しないかも知れません。 2の停止コードをコメントアウトと言うのがどのような作業なのか？ 　　XXXXXXX.Requey 　　　↓ 　　' XXXXXXX.Requey 　　Stop 　　実行コードをRem文に変更。 　　同時に Stop文も挿入。 　　この修正で、サブフォーム更新はストップします。 　　Stop文を含むVBAも表示されます。 　　ここで、{F9}を押して反応をみます。 　　また、その他のエラー回避策も試します。 【最初にやるテスト】 テスト１、問題なく動作していたバックアップで問題日付を試す。 　　これが一番確実で、しかも、真っ当なやり方です。 　　「不具合が発生したらバックアップに戻れ！」です。 テスト２、HDDとMDBの修復が終わったらテーブルの修正・復元です。 　　バックアップが利用できない場合は・・・。 　　問題の日付以後の全データを削除=>最適化/修復。 　　動くようだったら、必要なデータを少しづつ戻してテスト。 　　動かなかったら、テーブルの全データを削除=>最適化/修復。 　　動くようだったら、必要なデータを少しづつ戻してテスト。 PS、考え方。 (1)Accessのバージョンの旧さが原因。 (2)MDBの破損が原因。 現象からは(2)が有力そうですが(1)も視野に。 日付が"yyyy/mm/dd"形式でないこと、あるいは、関連テーブルの破損によりレコードソースの再取得でスタック領域を浪費。もって、エラーが発生。ということならば、(2)と(1)とを両睨み。などなどと考えています。 　　
＞NULLは使わない設定にしています 思い込みで否定せずに試してみようよ・・・ NOT NULLの設定した項目にNULLをセットしてやるとクリアになります。 文字列型なら''、数値型なら0 また、デフォルト値にしたいならdefaultを指定してやるのでもかまいません SET gif=default
すでに対策済みかもしれませんが以下チャレンジしてみては？ ・テーブルやカラムの照合順序 ・my.cnfでのinit-connectの誤設定 ・phpでPDOを利用しているのであればnew PDO()する際にcharsetを指定していない ・単に出力されたデータがブラウザで正当に評価されていないだけならheader()やmetaなどで補足する
＞実際のデータでは、処理時間が長く完了しないです。 どのくらいの量のデータを更新しようとしているのかによりますが 集計と違い更新するのですから、量が多ければそれなりに時間がかかりますよ むしろ更新せずに、必要なときだけ和算データを集計した方が効率的かも もしくはデータを投入する際にあらかじめ和算データを設定していくような 運用が必要かも。
ああ、なんとなくわかりました ＞ＮＵＬＬの場所に、aaaaa、bbbbb、cccccを挿入する方法も分からないため、 ということはnullを置き換えてよろしいのでしょうか？ であれば、以下のようなupdateをしてみるとよいかもしれません //元データ create table tbl1(no int,kubun varchar(20) null,flg tinyint null); insert into tbl1 (no,kubun) values(1,'aaaaa'),(2,null),(3,null),(4,null),(5,'bbbbb'),(6,null),(7,'*nozoku'),(8,'ccccc'),(9,null); create table tbl2(no int,komoku varchar(20)); insert into tbl2 values(1,'bbbbb'),(2,'eeeee'); //nullや*で始まる区分を置き換える update tbl1 set kubun=if(kubun is null or kubun like '*%',@a,@a:=kubun) order by no; //tbl2の項目と合致するtbl1のフラグをたてる update tbl1 inner join tbl2 on tbl1.kubun=tbl2.komoku set tbl1.flg=1;
こんにちわ。 > 私の考えでは、13でテーブルを確認するとデータが2件はいっていると思ったのですが、 > 結果は、1件だけでした。 > 解決の手がかりになる情報などがございましたらご教示いただけますでしょうか。 RMAN で取得したBackup に対して、SQL*Plus からRecovery を行っているから だと思います。 増分 Backup (Backup Set) はRMAN 独自の形式のため、RMAN からRecovery を 行ってやる必要があります。 但しRMAN にはuntil cancel が無いので、最後に取得したBackup 時のログから Backup されたThread番号, Log順序番からv$archived_log 等を検索して Recovery するSCN を算出しないといけないですね。 RMAN はRestore する時もultil SCN の指定が可能ですので、Restore を開始する前に Restore/Recovery するSCN を取得した方が良いと思います。
＞xmasデータベースにxmastranテーブルは確かに存在しています。 　えっと・・・入力されたプログラムでやりたいことは、xmasデータベースを作り、その中にxmastranテーブルを作成したいんだと思うんですが、xmastranテーブルが確かに存在していて、何か他に不満な点があるんでしょうか？ 　これで完成のように思うのですが・・・・
nameのケツが「課」か「部」を調べるなら正規表現でしょうね where name regexp '(部|課)$' これを利用してupdateすればよいです //データ作成 create table bumon (name varchar(30)); insert into bumon values('経理課'),('営業部'),('開発部'),('部門開発部'),('RアンドD'); //更新 update bumon set name=left(name,char_length(name)-1) where name regexp '(部|課)$'
一般的には在庫テーブルを作り、入庫日と出庫日または入出庫日欄を設けて、在庫の有る物に対し６ヶ月以前か判定します。現テーブルで判定出来ない場合は、新たなテーブルや項目を持つ必要があります、このようにシステムは新たなニーズが発生した場合は、テーブル構造も含めて対応を取る必要があります、つまり、常に変化成長させる必要が有ります。
Ａ．VBE(エディタ)は、Shift-JISみたいです OfficeやVBAの文字列型はUnicodeなので、処理は可能です。 ただ、エディタがsjisなので、補助漢字はコード上に書くことができません。なぜかMsgBoxもsjisです。 　→ 仕様かと。ChrWしかないと思います。 　参考)http://codezine.jp/article/detail/1718 Ｂ．VBAはサロゲートペア(4byte文字)未対応です 2byte*2として扱われます。 　→ "
実際に使ったことがないのであまり自信がないのですが、Access オブジェクトの SQLServer への移行にMicrosoft SQL Server Migration Assistant (SSMA) for Access というツールが使えるようなことが書いてあります。たしかクエリも Access オブジェクトの一種でしたよね。試してみてはいかがでしょうか。 SQLServer 関連ソフトウェアのダウンロードページ（SSMA for Access へのリンクあり）： http://www.microsoft.com/ja-jp/sqlserver/2012/do … SSMA for Access の使い方（英語）： http://blogs.msdn.com/b/ssma/archive/2011/01/29/ …
No.1さんもおっしゃっているように > 「abc.jpg」が表示されるとは思えませんが 仮に echo "<img src=¥"$name¥">"; だとして、出力結果が <img src="abc.jpg"> となったとしたら、これはこれで正しいと思いますよ。 abc.jpgがその場所にあれば、正しく表示されると思います。 画像そのものを出力したい、つまり （たとえば） /abc.jpg がリクエストされたとき、PHPを実行して画像（バイナリ）を返したい、ということならば、 １．まずそのURLがリクエストされたときPHPが実行されるようにウェブサーバの設定をする ２．（画像そのものがDBに格納されているとして）PHPで先のPDOなどを使って画像を取得する ３．header関数でContent-Typeを指定して（header('Content-type: image/jpeg');） ４．２の画像を出力する という流れになると思います。 画像をDBに格納しておらず、どこかのディレクトリに保存しているなら、 １．そのディレクトリをウェブサーバ経由で外部ネットワークから参照できるようにウェブサーバを設定する 　　またはウェブサーバ経由で外部ネットワークから参照できるディレクトリにその画像を保存する ２．そのディレクトリに対応するURLパスを先のDBに保存する ３．先の$nameが２のURLになっていればOK と思います。ウェブ上から見えないどこかのディレクトリに保存してPHP経由で返してもよいと思います。
こんな書き方でもできた気がします。 この方法なら、同一条件クエリは2つで済みますね。 UPDATE A SET (DK, NUM) = (SELECT DKB, SUBSTR(A.NUM, 1, 13) || (SELECT LPAD(TO_CHAR(B.DKB), 7, '0') FROM B WHERE A.DK = B.DKA) WHERE EXISTS ( SELECT B.DKA FROM B WHERE A.DK = B.DKA ) キーが同じレコードを対象に、更新する項目でも同じ条件で対象レコードを抽出して 更新するだけですよ。
自分のソフトにデータベースの機能を組み込みたいと思ったときに使うものです。 たとえば、メールソフトで、 受信したメールを詰め込んだデータベースを作る。 並べ替え（件名、受信年月日、送信者など）などがすぐ出来ます。
　サーバーの種類により、ログイン画面を経由させる時に、クッキー認証を必要としているからではないでしょうか。 　あなたのご覧になられたＵＲＬhttp://php1st.com/435/＜ＰＨＰプログラミングの教科書＞の中に、赤字で説明してありますよ。
いまのままのテーブル構成だと集計にあまり向いていないと思いますが とりあえず動けばいいというならこんな感じでサブクエリにして joinすればいいのでは？ select 年,月,最大値,`datetime` from 米ドルtbl inner join ( select year(`datetime`) as 年, month(`datetime`) as 月, max(usd) as 最大値 from 米ドルtbl group by 年, 月 ) as sub on year(`datetime`)=年 and month(`datetime`)=月 and usd=最大値
SET句で number に既存の値の前に'東京/'を付けたものを設定すれば良いかと。 http://dev.mysql.com/doc/refman/5.1/ja/update.html 文字列連結には CONCAT 関数を使います。 http://dev.mysql.com/doc/refman/5.1/ja/string-fu … 例) ------------------------------------ UPDATE テーブル名 SET number = CONCAT('東京/', number) WHERE area LIKE '%tokyo%';
create table もそうですが、生成したＳＥＬＥＣＴ文を張ってください よっぽどファンタスティックなテーブル設計をしない限り。ＳＥＬＥＣＴ文のほうに 間違いがあるのだと思います。たとえば、JOINする対象を間違えているとか。 取あえず、この文章だけだとo2shgi3eatgeさんがやりたいことはRDB（SQL）が得意とすることなので SQL入門を読んでその通りに作れば、できますよとしか言えません。
No.5の補足からすると、「手元に届くデータが定型的ではない」ということですか。 それはコンピュータ処理に向きませんねぇ。(^_^;) どんなに雑であっても、一定の法則が無ければ簡単な解決方法はありません。 一番の近道は、現状のままで解決策を見つけるのではなく、 ある程度コンピュータ処理に向いた記述に変更してもらうのが一番だと思います。 #3さんが言われるようにどうしても雑な文には抜け道が発生します。 それらの注文方法が最低でもいくつかのパターンに収まるようにしてもらうべきだと思います。 例えば、 ◆区切り文字を決め（空白とか、：とか、／とか品目などで使用しない文字にします）、項目の順番を決める。 １３時５０分 3個 商品：7777 するめ （項目を空白で区切ってもらう、品目が最後と仮定し、商品コード以降の空白は品目とみなす） 高知へうど 3kg （品目は「へ」から最後の空白まで、最後の空白以降の文字は受注数とする） 高知へうどを3kg （品目は「へ」から「を」まで、「を」以降の文字は受注数とする） 上記のようないくつかのパターンに、ある程度整形してもらうことは難しいのでしょうか？ 私の今までの経験から、どんな文字が来るかわからない、ような受注内容では、いつまで経っても解決策はありませんし、 また、新たな受注文章が来た場合、今までの方法が使えなくなったり、訂正することによってこれまでの処理がうまくいかなくなるケースも往々にしてあります。 こういった、建設的ではない方法は、時間と労力と金銭の無駄．．という考え方でいます。 解決策にはなっていませんが、もっと前向きに、 建設的な方法（少しの労力を払ってでも、すべてがうまくいく方法）にシフトされることを望みます。
CASE WHEN @D = 0 THEN (dbo.TEST.D = dbo.TEST.D) '全データを WHEN @D = 1 THEN (dbo.TEST.D = 1) '値が1のデータを WHEN @D = 2 THEN (dbo.TEST.D = Is Null) 'データがNull のものを ↓ ((@D = 0 AND dbo.TEST.D = dbo.TEST.D) OR (@D = 1 AND dbo.TEST.D = 1) OR (@D = 2 AND dbo.TEST.D = Is Null) ) とした方がよいかと思います。
そのログに書いてある通りなのでは? 設定とか見直してください
パスワードはいれましたでしょうか？ 15247ってことは、古いパスワード部分をnullというか空白状態で有効にしようとされていません？ 混合モードで指定したsaパスを古いパスワードにいれて、それとは違うパスワードを新のほうにいれてみたらどうなるでしょうか？ あと、15247はsysadminが付与されてないユーザで操作されているのかな？ という印象を受けます。 こんな回答となってしまいますが、申し訳ない。
なんらかの削除フラグを立てて、更新後削除フラグのたっているデータを削除するのが妥当 そもそもデータを削除しないで削除フラグがないデータだけ集計対象にするだけでよい気がします
key_buffer_sizeをチューニングしようとされているので、ストレージエンジンは、MyISAMでしょうか？ InnoDBなら、チューニングするパラメータが異なります。 alter tableでテーブルを変更する場合において、 基本的にデータが多いときは、indexの再作成に時間がかかります。 （使用しているハードウェアのスペックに依存しますが） CPU使用率ですが、普段が2%前後で、alter table実行時に50～100%になるのでしょうか？ 教えていただきたいのが、下記の項目です。 ・ハードウェアのスペック ・ストレージエンジン ・テーブルに張っているインデックスの数とインデックスの合計データサイズ(1行あたり）
規格上は #2 の通りなんですが, 現実の世界は必ずしも規格に従っているわけではなく 「(SDHC ではなく) SD の 4 GB」 というのが実在していたりします. まあいまどきそうそう見つからないとは思いますが, 可能であれば確認しておくべきでしょう (規格外の製品なので使えなくても文句が言えない). あと「バンク切り替え」するやつもいた.
共有とかシェアリングてはないの。
MySQL の仕様では、GROUP BY した際に一意にならないカラムをSELECT句に指定した場合は、そのグループに属する値のどれかを返します。その中のどれを返すかについては特に基準は有りませんので、不確定です。 詳しくは下記のページを参照して下さい。 http://dev.mysql.com/doc/refman/5.1/ja/group-by- … なお、 null 以外は同じ値になるのでしたら、MAX 関数などを使えばその値が取得できるかと。 例) SELECT address, MAX(title), SUM(count) as SUM FROM ・・・ 参考URL：http://dev.mysql.com/doc/refman/5.1/ja/group-by- …
Q_Data の定義に問題があると思います。 キーが１対１になっているクエリーは読み取り、更新とも可能ですが、 １対多ならば読み取りのみ可能となります。 Select * from Q_Data でレコードの重複がないかどうかを確認してください。 　
こんにちは。 方法として２つの案を準備しました。 まずは下記のSQLを実行して質問に書いてあるテストデータを準備します。 -- #### テーブル作成 CREATE TABLE dbo.TestData ( LogDate date , Data1 nvarchar(10) ) GO -- #### テストデータ登録 INSERT INTO dbo.TestData SELECT '2013-08-01', N'ああああ' UNION ALL SELECT '2013-08-03', N'いいいい' UNION ALL SELECT '2013-08-06', N'うううう' GO -- ################################################ -- #### 方法１：毎回日付テーブルを作成する。 -- #### 短所があり、パフォーマンス的に悪いです。 -- ################################################ DECLARE @StartDate datetime, @EndDate datetime SET @StartDate = '2013-08-01' SET @EndDate = '2013-08-10' DROP TABLE #TempDate CREATE TABLE #TempDate ( ComDay date ) DECLARE @i int SET @i = 0 WHILE (@i <= DATEDIFF(DD, @StartDate, @EndDate)) BEGIN INSERT INTO #TempDate (ComDay) VALUES (DATEADD(DD, @i, @StartDate)) SET @i = @i + 1 END SELECT A.ComDay, ISNULL(B.Data1, '') Data1 FROM #TempDate A LEFT OUTER JOIN dbo.TestData B ON A.ComDay = B.LogDate ORDER BY A.ComDay -- ################################################ -- #### 方法2：日付テーブルdbo.tComDayを作成しておいて使う。 -- #### おすすめする。 -- ################################################ SELECT A.ComDay, ISNULL(B.Data1, '') Data1 FROM dbo.tComDay A LEFT OUTER JOIN dbo.TestData B ON A.ComDay = B.LogDate WHERE A.ComDay BETWEEN @StartDate AND @EndDate ORDER BY A.ComDay 上記の方法１と方法２の実行結果 ComDayData1 2013-08-01ああああ 2013-08-02 2013-08-03いいいい 2013-08-04 2013-08-05 2013-08-06うううう 2013-08-07 2013-08-08 2013-08-09 2013-08-10
読ませていただくと、2がベストと思われます。 Webシステムにすることによって、SQL処理は本社のサーバーで実行され、結果がWebベースのテキストで飛んできます。 データーベースが一カ所のため、整合性にも問題ないですし、やり取りは結果のテキストだけですので、VBベースのシステムに比べるとかなり速くなると思われます。 ただ、インターフェイス面でVBのような手の込んだ処理が出来ないことがありますので、利用者から別の文句が出る可能性があります。 また、開発元ベンダーさんも実績が無いとのこと、そうなると、他の案ですが、 > 4.SQL Serverを各拠点に立て、ミラーリングする >（マスタや採番は一元化管理が必要です。データの整合性を保つのが困難な印象で、 > 4より1か2か3の方が良いシステム構成かと思います） マスタはそんなに頻繁に更新されるものでしょうか？ 採番は、絶対に連番でないと困るのでしょうか？ そのあたりを考え直すと、ミラーリングでも十分実用的になりますし、速度もほぼ本社並になることでしょう。 合わせて、緊急時のバックアップにも使えます。 ベンダーさんにその辺りのノウハウを持っていないか、聞いてみてはいかがでしょうか？ ターミナルサーバー、MetaFraame(Xen Desktop)、Horizon View、同じようなものですが、拠点側での同時利用者がどれぐらいの規模かによって、構成が決まります。サーバーにそれなりのコストがかかるのと、クライアントとして動かす中のOSのライセンスが結構ネックになります。 最後にあまり期待できないかもしれませんが、WAN高速化装置(アクセラレーター)と言われるものがあります。 http://www.itmedia.co.jp/enterprise/special/0706 …
こんにちは。 LEFT OUTER JOIN と　INNER JOIN は少し差があります。 下記のSQLを実行して確認してみてください。 CREATE TABLE #TempTableA ( Idx int , DataA varchar(10) ) CREATE TABLE #TempTableB ( Idx int , DataB varchar(10) ) INSERT INTO #TempTableA SELECT 1, 'A' UNION ALL SELECT 2, 'B' UNION ALL SELECT 3, 'C' UNION ALL SELECT 4, 'D' INSERT INTO #TempTableB SELECT 1, 'Z' UNION ALL SELECT 2, 'Y' UNION ALL SELECT 4, 'X' UNION ALL SELECT 5, 'V' 上記のSQLを利用してテーブル作成とデータを登録します。 その後、LEFT OUTER JOIN　でIdx値が３のデータを抽出してみます。 SELECT A.Idx, A.DataA, B.DataB FROM #TempTableA A LEFT OUTER JOIN #TempTableB B ON A.Idx = B.Idx WHERE A.Idx = 3 結果は下記のとおりです。 1件のデータが出ます。 ですが、#TempTableBテーブルにはIdxが3のデータがないのでnullのデータで表示されます。 IdxDataADataB 3CNULL 今回は、INNER JOINで実行してみます。 INNER JOINは両方のテーブルにデータが存在しないとデータが表示されません。 SELECT A.Idx, A.DataA, B.DataB FROM #TempTableA A INNER JOIN #TempTableB B ON A.Idx = B.Idx WHERE A.Idx = 3 ですので、1件も表示されません。 LEFT OUTER JOIN と　INNER JOINはこの差がありますので、 注意して適当なSQLを利用する必要があります。
>　As nameを使う以外に ないのでasを利用してください
Access2007は持ち合わせていませんので、ここんとこだけですが >※因みにアクセス2007に関してはネット環境がありませんので >ソフトやPCはアップデートはされません。 SP3未適用でしたら http://www.microsoft.com/ja-jp/download/details. … をダウンロードして、USBメモリなどを経由してインストールされれば？
http://www.mahoutsukaino.com/ac/ac2000/ac2000/ac … ここに非常に判りやすく書かれています。 ＞んでは、まずは普通にクエリを作り始めます。 ここまで出来たら、完成したも同然です。 添付画像を手掛かりにアタックされてください。
苦労されているようでもうひと踏ん張りしてほしいところですが・・・ ＞INDEX a_id(`a_id`) されているのであれば、別解で上げているように select a_id,b_id,hoge from table1 force index(a_id) where a_id IN (・・・) order by updatetime desc limit 0,100 ; の処理で高速化が確認できませんか？
テーブルデザインの「その列」の定義と、いくつかのデータと、 クエリデザインをSQLビューにして「その問題のクエリ」を 開示していただけますか？
Access2002・2010（多分2013も）で フィールドのデータ型を設定してあっても インポートの際にはAccessが頑固一徹にデータ型を決めてしまいます。 Excelの場合はデータ行で先頭から8行を空読みして決定しています。 これはレジストリに登録されています。 レジストリエディタを立ち上げ Ctrl + F で Typeguessrows を検索すると（当方では最初に見つけるまで１分程度） WindowsXPなら HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\4.0\Engines\Excel にあるかと思います。 複数個所（Windows7 & Office2010なら二か所でした）にあることも。 規定値は、8 になっていますので この値を10進数なら30位の適当な大きな値にするか 0 にすればすべてを空読みしてからデータ型の決定を行います。 (0 だとモノによっては時間が掛かるかも） CSVファイルなら、Maxscanrows を検索してみてください。25行になっているかと。 FF1　FF2 1　　123 2　　123 3　　123 4　　123 5　　123 6　　123 7　　123 8　　123 ここまでで数値型に決定される 9　　abc データ型が違うので除外される レジストリの変更をすれば、その後はデータ型に注意しなくともすみますが、 権限の問題でRegedit.exe を立ち上げられない（変更ができない） レジストリの変更に不安 な場合は、 先頭に近いセルの値に一つにシングルクォーターしょんを付け、123 → '123 にしてしまうことです。 そうすればすべてテキスト型で読み込まれます。 なお連続している順番が 数値→数値・・・・・・・・・テキスト だと変換エラーになりますが テキスト→テキスト・・・・・・・数値 だと数値もテキスト型として読んでくれます。 テキスト型はある意味オールマイティです。
これって、エラーではなく情報（単なるメッセージ）ではないですか。 リリースにもよりますが、要件を満たしているマシンにDBをインストールするときにも似 たようなメッセージが表示されたように思います。 なので、うまくインストールできないということでしたら、別のところでエラーが発生し ている可能性を疑ってみるべきだと思います。 まずは、oraInventoryに出力された installActions.log を確認されてみると良いでしょ う。（非常にわかりづらいですが・・・） いくら Oracle でも、6GB RAMでも足りない製品はさすがにないはずです。
Q_商品クエリは選択クエリでしょうか。 Q_商品とT_テストのフィールド名・フィールドサイズが同じなので currentdb.execute "insert into [T_テスト] select * from [Q_商品]",dbfailonerror で機能するかと思います。 >'システムメッセージの非表示 >DoCmd.SetWarnings False >DoCmd.RunSQL "DELETE FROM T_テスト" >'システムメッセージの表示 >DoCmd.SetWarnings True は、 currentdb.execute "DELETE FROM T_テスト" ,dbfailonerror だと確認メッセージを出さずに進行します。 Setwarnings で切り替える必要がなくなります。
主キーに複数の意味を持たせるな http://hatenachips.blog34.fc2.com/blog-entry-201 … 絶対に・・・というわけではないと考えますが 人間にとって分かりやすい ≒ データベースの処理に適切 だと思います。
Where じゃなくて、group byじやないですか？ まずはInsertせず、Selectで試験して下さい。 SELECT 'staff',product,SUM(user_volume) FROM user_table Group by 'staff', product ;
最も簡単な対応は、[支店マスタークエリ]を作成されることです。そのクエリで、列[新支店CD]を生成されると目的は達成されます。 ※本来は、支店コードという可変なデータ列ではなく長整数の一意な数字を主キーに。もちろん、列[支店コード]はあっても構いません。が、それは、あくまでも表のデータ。リレーションを内部管理するキーとしては不適です。
ユーザーテーブルとメールマガジンテーブルを別々に設定し ユーザー＝メールマガジンテーブルで管理すればいいでしょう。 たとえば、ユーザー＝鈴木・佐藤・山田がいて、 メールマガジン＝趣味、仕事、自己啓発があったときに 趣味は全員、仕事は鈴木・佐藤、自己啓発は佐藤だけ登録している場合 こんな感じ create table user (uid int,uname varchar(20)); insert into user values(1,'鈴木'),(2,'佐藤'),(3,'山田'); create table mailmagazin (mid int,mname varchar(20)); insert into mailmagazin values(1,'趣味'),(2,'仕事'),(3,'自己啓発'); create table user_mailmagazin (mid int,uid int,unique(mid,uid)); insert into user_mailmagazin values(1,1),(1,2),(1,3),(2,1),(2,2),(3,2); これを、ユーザーごと、メールマガジンごとに表示するとこう //ユーザーごと select u.uid,uname,group_concat(mname) from user as u ,user_mailmagazin as um ,mailmagazin as m where u.uid=um.uid and um.mid=m.mid group by uid; //メールマガジンごと select m.mid,mname,group_concat(uname) from user as u ,user_mailmagazin as um ,mailmagazin as m where u.uid=um.uid and um.mid=m.mid group by mid; あとはたとえば仕事（mid=2）のメールマガジンだけ送るなら select u.uid,uname from user as u ,user_mailmagazin as um where u.uid=um.uid and um.mid=2; のような検索でuidを抽出して処理すればよいでしょう
こういうこと？ （理想の処理結果から「なし」が消えてるロジックがわからないけど） create table hoge (name varchar(20),price int null); insert into hoge(name) values('りんご'),('みかん'),('なし'); update hoge set price=300 where name like '%ん%'; ちなみに前方後方一致は負荷が高いので膨大な処理をする場合はきびしいかも （数万件程度なら余裕だけど・・・）
カーソルというのを使って処理します。 http://homepage3.nifty.com/owl_h0h0/unix/job/ORA …
>また、どういった情報が必要であるかを教えて頂ければ、 絶対パスにしたら治る可能性が高いと思ったので書きませんでしたが… 「バッチ」とは何かとか、起動方法やその内容とか。バッチではなくコマンドプロンプトから「imp user/password@sid file=filename full=y」のコマンドを、ファイルのある場所で実行したらどうなるのかとか。それから1回でも成功した事があるものが、失敗するようになったのか、1度も成功した事が無くはじめて試しているところかとか。 とにかく状況を伝えようとする意思を持つことが重要だと思いますよ。「聞かれたら答えますよ」という態度ではなく。 「バッチ」の処理の中でCDされていてカレントディレクトリが変更されているんじゃないかとか、何も書いていないが実は何らかのジョブスケジューラーを使っていてそのスケジューラーの機能でカレントディレクトリが変更されているとかの可能性があるかなと考えました。 が、そういうところをくどくど言わなくても絶対パスにすりゃいいだろと思っています。
質問者さんが作成されたファイルでしょうか？ >「フォーカス喪失時」 ボタンの「クリック時」は機能します は理解不能ですが >項目の「変更時」、「更新後処理」 はまったく反応なし？ 無反応の部分のコードをいったんメモ帳などに保存し 無反応なイベントプロシージャを削除。 最適化を行ってAccessも終了します。 再度立ち上げて、以前作成したようにメモ帳で保存したコードをペースト。 で動くようになりませんかね。 あるいは、mdb形式からaccdb形式に、ファイルタブの「保存して発行」から変換するだけでも 直るかも？ なお、VBEで参照設定に無効なものが無いかとかコンパイルが通るかなども確認を。 ※念のためファイルのバックアップを取ってからお試しを※ それでもダメなら確認のために動かない部分の Private Sub ・・・ ・・・ End Sub まで載せてみては？
> 出席番号１さんがライバルだと思っているのが、 > 出席番号３さん、５さんとします。 > ３さんは１さんのことをライバルと思っていませんが、 > ５さんは１さんのことをライバルだと思っています。 という関係は，「ライバル」テーブルに次の3行を登録すれば表現できます。 (user_id, rival_id) = ((1, 3), (1, 5), (5, 1)) (user_id, rival_id) = (1, 5) と (user_id, rival_id) = (5, 1) は，主キーの値はまったく別です。 ちなみに， 「ライバル」テーブルのrival_idが「生徒」テーブルの主キーを参照する外部キーであるのと同様， 「ライバル」テーブルの user_idも「生徒」テーブルの主キーを参照する外部キーです。 それから。 出席番号というのはクラス内の連番を指す概念ですか？ であるなら。 変則的な理由で年度の途中で出席番号が変わる可能性もありえますし，1年→2年→3年の進級によっても出席番号は維持できません。学籍番号（学生番号）に代表される，入学以降変化しない識別値を「生徒」テーブルの主キーにすべきです。
削除クエリーの場合、サブフォームに#Deletedと表示 me!サブフォーム名.form.requery じゃダメですかね。ゴミレス勘弁。 dao.recordset の件は分かりません。 調べる気力も体力もスキルも。。。 Access2010のヘルプでは Sub SupplierID_AfterUpdate() 　　Dim rst As DAO.Recordset 　　Dim strSearchName As String 　　Set rst = Me.Recordset 　　strSearchName = CStr(Me!SupplierID) 　　rst.FindFirst "SupplierID = " & strSearchName 　　If rst.NoMatch Then 　　　　MsgBox "Record not found" 　　End If 　　rst.Close End Sub ともなっています。 Sub CheckRSType() 　　Dim rs as Object 　　Set rs=Forms(0).Recordset 　　If TypeOf rs Is DAO.Recordset Then 　　　　MsgBox "DAO Recordset" 　　ElseIf TypeOf rs is ADODB.Recordset Then 　　　　MsgBox "ADO Recordset" 　　End If End でRecordsetのどちらを使っているか判別できるようです。 投稿用にタブインデントは全角スペースにしています。
No.1です。 データ様式の変更ができないということですね。 その場合、クエリーで、式1: CDbl(Left([テーブル1]![名前1],Len([テーブル1]![名前1])-1))のように入力し、このカラムを昇順にソートすればOKです。 Left関数で、文字長-1の文字を取り出し、℃を除き、数字部分だけを取り出し、これを数字（倍精度浮動小数）に変換し、この値でソートするという事です。 確認下さい。
こちらで試した限りでは dim fld as object j = "select * from [Sheet1$] " 　'←ここです。 myRS.Open j, myCon for each fld in myrs.fields debug.print fld.name next だと Alt + Enter （chr(10)）は、_ アンダーバー になってますね。 j = "select count(*) from [Sheet1$] where H24_決済 = '済';" だと？
Apache単体でインストールしたんですか？ 「XAMPPとしてインストールした」とかではありませんか？ もしそうなら、インストール先フォルダにあるUNINSTALL.EXEを実行。 （XAMPPが一式アンインストールされます）
・それしか手立てがない場合には別に構わないでしょう。 ・やりたいことによります。 　また、MySQLのバージョンによってはPHPなどの外部言語ではなく 　MySQL内のストアドプロシージャ、ファンクションでの実装も可能でしょう。 ・適切にインデックスキーなどが設定されている前提で考えると、 　ループ回数が少ない方がスピードが出るのがほとんどです。
バッチファイルとはコマンドプロンプトの BAT でしょうか。 テーブルだけではなくて、まるっと変換なら Accessの起動オプション /convert を使ってみては？ http://office.microsoft.com/ja-jp/access-help/HP … VBAなら、ConvertAccessProject メソッド があります。 http://support.microsoft.com/kb/304318/ja
以前から全く進んでいないようで残念です ＞CREATE DATABASE xmas; ではなく、以下としてください CREATE DATABASE if not exists xmas; ＞USE xmas; phpMyAdminを利用しているならuse文は利用せずに、左のリストから選んでください ＞CREATE TABLE ・・・ も、「if not exists」で処理してください。 CREATE TABLE if not exists xmastran ( book_id int not null auto_increment, name varchar(30) not null default ' ' , org varchar(50) not null default ' ', addr varchar(80) not null default' ', tel varchar(20) default ' ', mail varchar(40) default ' ', course varchar(30) default ' ', nums integer default 0, PRIMARY KEY (book_id) ) ENGINE=MyISAM DEFAULT CHARSET=utf8; もしくはcreate tableする前に drop table if exists xmastran; として、テーブルを削除しても構いません
＞よくわかりません？ どのへんがわかりませんか？ そもそも、クォーテーション の意味がわからない？ シングルクォートもダブルクォートも、文字列を「囲む」ものですから、必ずペアです。
あまり良い設計とは言えませんが、性能的な要請が厳しく、他の手段（後述のパーティショニング等）も無くて、そうせざるを得ない場合は有るでしょうね。 ということで、「一般的なやり方ではないが、アプリ内容(仕様)によっては普通に起こりうる」になるかと。 ただし、パーティショニング機能の有るDBMSでは、それによって月や日付によって物理テーブルが分割される事は一般的だと思われます。 http://lets.postgresql.jp/documents/technical/pa … http://www.atmarkit.co.jp/ait/articles/0611/22/n … もっとも、この場合は日付や月などのカラムもそのまま残しつつテーブルを分割する事になるのですが。
こんにちわ。 > 私には、なぜバックアップから除外されているデータファイル6に対して > 「～古いバックアップからリストア～」といったメッセージが出てくるのか > 理解できていません。 バックアップしていない表領域は、リカバリの対象外となります。 そしてリカバリとは、「全てのデータファイルの最終更新SCN を一致させる事」 と考えると、TBLSP01, TBLSP02 のデータファイルについてもSCN を一致させる 必要があるため、データベースをオープンするためにはバックアップが必要となります。 TBLSP01, TBLSP02 表領域については、バックアップを取得していないのであれば 該当の表領域を除外してリカバリを行う事になると思います。 Alter database datafile 'データファイル#6 のフルパス' offline drop; Alter database datafile 'データファイル#7 のフルパス' offline drop; としてから、データベースのリカバリを行い、resetlogs を指定してDB を オープンした後で、 Alter tablespace TBLSP01 including contents and datafiles; Alter tablespace TBLSP02 including contents and datafiles; でリカバリの対象外とした表領域を削除した後で、該当表領域の再作成と テーブル, 索引等の再作成を行って下さい。 ※ 表領域を読取専用にしておけば、1度だけBackup を取得しておけば、 　 (Backup を残しておけば) そのBackup を使ってリカバリが可能になります。
なら、ゴールは見えたも同然？ まずは頑張って不一致クエリウィザードを使って 未登録車両を抜き出せるクエリを作成してください。 そのクエリ名を仮に、Q未登録チェック とします。 このクエリだけでも目的の大半は達成かと思います。 あとは前回回答のを流用して Sub UnknownCarCheck() 'Microsoft Office xx.x Access database engine Object Library←Access2007から出来ました 'または、Microsoft 3.6 Object Libary←2003だと多分こっち のいずれかに参照設定が必要です　　 　　Dim db As Database 　　Dim rs As DAO.Recordset 　　Set db = CurrentDb 　　Set rs = db.OpenRecordset("Q未登録チェック", dbOpenSnapshot) 　　rs.MoveLast 　　If rs.RecordCount <> 0 Then 　　　　MsgBox rs.RecordCount & "件不一致あり" 　　　　DoCmd.OpenQuery "Q未登録チェック" 'クエリを開いて確認 　　Else 　　　　msgbox "未登録車両はありませんでした" 　　End If 　　 　　rs.Close: Set rs = Nothing 　　Set db = Nothing End Sub というのを必要な時に行えばどうでしょ。 なお、上記回答は CSVファイルを一時的なテーブルにインポートして それと車番マスタを照合する場合を想定しています。
こんにちは。 MSSQLサーバーのテーブルで最新でInsertした直後に、そのレコードを削除して、 再度Insertした時のIDENTITY列の値はその前にInsertした時に使用された値が 再度使われることはありません。 手動で設定し直す限り。 #### Identityを設定する方法 テーブルを「デザイン」で開いてIdentityで設定するカラムを選択すると 【例のプロパティ】に「Identityの設定」があります。 スクリーンショットのように画面が見えない場合は、 「IDENTITYの設定」前にある「+」マークをクリックすると スクリーンショットのように表示されると思います。 そこで「(idである)」項目を「いいえ」から「はい」に変更すると設定は終わります。
＞ max の分だけ集計したい 一度最大値を変数にとっておくのが楽かも （テンポラリテーブルは微妙な制限があるので） create temporary table fuga(`int` int); insert into fuga values(0),(1),(2),(3),(4),(5); select @max:=max(`int`) from fuga; //ここで@maxに最大値をとっておく select fuga.int,ifnull(count,0) as count from fuga left join (select `int`,count(*) as count from hoge where `date`='2013-08-13' group by `int`) as sub on sub.int=fuga.int where fuga.int =@max //絞り込み
セミコロンのありなしはともかくとして、ダブルクォーテーションで開始しているわけですから、 最後もダブルクォーテーションで終わらせて、ちゃんと囲まないとダメですよ。 ; UNIX: "/path1:/path2" ; Windows: "\path1;\path2" この行が、UNIX系の場合と、Windows系の場合の記述例です。
普通はUPDATEを使うと思います。 処理時間が問題にならないのであればDELETE,INSERTでも良いとは思いますが、 UPDATEに比べてかなりコストが大きいと思います。
こういうこと？ //元データ create table hoge(address int,nyukai date,id int); insert into hoge values(1,'2013-01-01',201),(1,'2013-01-02',204),(1,'2013-01-03',202),(1,'2011-01-04',203), (2,'2013-02-04',101),(2,'2013-02-02',102),(2,'2013-02-01',103),(2,'2011-02-03',104), (3,'2013-03-01',301),(3,'2013-03-02',302); //表示 SELECT address,nyukai,id FROM hoge WHERE address in(1,2) ORDER BY case address when 1 then 1 when 2 then 2 else 3 end ASC, case address when 1 then nyukai when 2 then id end ASC もとの処理だとnagoyaだろうがnyukaiで一度ソートがかかるためidでソートされません。
手元のパソコンはマックでもウインドウズでもいいのですが、サーバ側でphpmyadminが呼び出せる環境なのでしょうか。だとしたら、そのサーバのＵＲＬのphpmyadminページのログイン画面でユーザー名とパスワードを入力すれば、データベースを作成できる画面になるはずです。 そのあと作成したデータベース名とパスワードをWordPress用のwp-config.phpファイルの所定箇所にあてはめて、サーバへFTPでアップロードします。そして、ＩＥなどのブラウザからそのサーバのＵＲＬのwp-admin/install.php を呼び出せば、サーバー上でインストール動作し、wordpressが呼び出せるようになります。 もし、会社のサーバにapacheもmysqlもphpもまだ設定していないのだったら、以下のサイトを参照し、まずご自身のMacにXAMPPをインストールしてパソコン上のローカルサーバーでのWordpressのインストールと設定の実験をすることをおすすめします。 http://www.apachefriends.org/jp/xampp-macosx.html その上で会社のサーバーを設定し、XAMPPとWordpressを動作できるようにしましょう。当然、外部から無断操作されないようにセキュリティ設定する必要があります。
#2です >そのパターンは無理でした。 なにか読み間違えていると思いますが・・・ もしかしたら5.5でできないのでしょうか？ 以下ためしてみてください。 create table hoge (id int not null,data int null); insert into hoge values(1,100),(2,null),(3,200); alter table hoge modify data int not null; nullだったid=2のdataは0になるはずです
手元に ACCESS が無いので動作未確認ですが、下記のSQLではどうでしょうか？ (weather テーブルに、日付/時刻型のdateカラムと文字列型のweatherカラムが有ると仮定) SELECT date, weather, DateDiff("dd", date, (SELECT MIN(date) FROM weather c WHERE a.date < c.date AND a.weather <> c.weather)) AS weather_count FROM weather a WHERE NOT EXISTS (SELECT * FROM weather b WHERE a.date - 1 = b.date AND a.weather = b.weather) AND date BETWEEN '2013-7-1' AND '2013-7-31' ;
回答者皆が分からんのか、なんで　「通信速度向上」＝「ケーブルを代える。それもクロスに」　と考えられたのか？？？？ まずは、その意図を公開して下さい。 １．クロスを使うのは、ふつーであれば、Ｔのポートを使って、ＰＣ同士、HUBを介さずにケーブルで直結する場合。 ２．通信速度を上げたいのであれば、ポート・ネットワーク機器・ケーブルが速度に対応できるのか？　とくにポート・ネットワーク機器が例えばＧ baseに対応していないと、当然、その速度は出ない。 ネットワークについて、もう少し整理してもらえませんか？
表示されたメッセージの末尾にあるファイルは、記述通りの場所に存在しますか？
HKEY_LOCAL_MACHINE です。 ＃　先の質問で「媒体」求められた経緯といい、 ＃　以前に製品版をインストールしたことがあるのなら ＃　もう少し違う操作が必要かも。
> win764bitにMicrosoft SQL Server 2008をインストールしたいです。 > それとも何かＣＤ－Ｒが必要なのでしょうか？ 製品版なら媒体が必要です。 SQL Server 2008がExpressなら、ダウンロードしたファイルを指定する。
良いと思います。 フロントエンドは「ユーザとのインターフェイス部分」、 バッグエンドは「向こう側の処理部分」と捉えると、 別サーバにＤＢを配置しているなら、フォームに限らず 「MS-ACCESSそのものがフロントエンド」になります。
FromにSelectを書く場合でも、数式と同様にカッコが優先されるから、と思います。
いやだから「タイプミスが3件ありました」と書いたでしょ？ >tel verchar(20 default '', vercharじゃなくvarchar、かっこが閉じてない >PRIMARY KEP (book_id) KEPじゃなくKEY 文法（シンタックス）エラーの原因は大半がタイプミスです
ユーザ毎の、article数とsizeの最大値、sizeの最大のものの登録日時とタイトルが取得したいという事ですよね？ 下記の様なSQLで出来ると思います。(Ver. 5.5.8 で確認) ---------------------------------------- SELECT article_id, user_id, (SELECT COUNT(*) FROM article c WHERE a.user_id = c.user_id) AS count, size AS max_size, insert_unixtime, title FROM article a WHERE NOT EXISTS ( SELECT * FROM article b WHERE a.user_id = b.user_id AND (a.size < b.size OR a.size = b.size AND a.insert_unixtime < b.insert_unixtime) ) ---------------------------------------- WHERE句では、user_id が同じで size が大きいものと同じ size で insert_unixtime が大きいものが無いという条件、つまり、その user_id で最大 size, insert_unixtime のレコードを取得する条件を書いています。
仕様の詰め次第ですね tagとu_idの組み合わせがユニークかどうかでやり方が異なります たとえばu_id=5の人が一度「そば」を登録した後にダブって「そば」を 登録できるかどうかということ 仮にuniqueを前提にすればこんな感じ //元データ create table tags(id int not null primary key auto_increment,tag varchar(30),u_id int,unique (tag,u_id)); insert into tags values(1,'うどん',5),(2,'そば',5),(3,'うどん',2),(4,'ラーメン',2),(5,'そうめん',1),(6,'そば',3); //ユーザーごとにうどんorそばに合致する件数 SELECT u_id, sum(tag in('うどん','そば')) as agr FROM tags GROUP BY u_id ORDER BY agr DESC //うどんかつそばに合致するユーザー SELECT u_id FROM tags GROUP BY u_id having sum(tag in('うどん','そば'))=2
いずれにせよ、ブラウザに認証ダイアログが表示される(IISが401を返す？)のと、データベースの話は直接の関連はないでしょう。 IIS側の動きを調査 →IISのアクセスログ ASP.NETの動きを調査 →trace.axd http://www.atmarkit.co.jp/fdotnet/dotnettips/040 … ブラウザ側の動きを調査 →HTTPモニタソフト(Inetspy/横取り丸など)
ひょっとしてカタカナの部分は元々半角文字で、 質問を投稿する際に全角になってしまっているのでしょうか？ そうであれば濁点も半濁点も１文字ですので、 LIKE１回で絞り込むことはできないような気がします。 チルダをつかって正規表現でマッチさせるのではだめでしょうか？ column_1 ~ 'カルヒ([^゛゜].*)?$'
ん～・・・ 複数の店舗と、複数の書籍があって、各お店が最大6点までお勧めの書籍を 指定できるみたいイメージでしょうか？ //元データ create table book(bid int not null primary key,bname varchar(100)); insert book values(1,'A'),(2,'B'),(3,'C'),(4,'D'),(5,'E'),(6,'F'),(7,'G'),(8,'H'); create table shop(sid int not null primary key,sname varchar(100)); insert shop values(1,'X'),(2,'Y'),(3,'Z'); create table osusume(bid int,sid int,unique key(bid,sid)); insert osusume values(1,1),(2,1),(3,1),(4,1),(5,1),(7,1),(1,2),(2,2),(3,2),(5,2),(6,2),(2,3); //各お店のお勧めする書籍数 select o.sid,s.sname,count(*) as count from osusume as o inner join shop as s on s.sid=o.sid group by sid; //'X'(sid=1)がお勧めする書籍ランダムで3点 select o.bid,b.bname from osusume as o inner join book as b on o.bid=b.bid where o.sid=1 order by rand() limit 3 こうするとランダムに３点選ばれます。 もし同じ日に検索した場合同じデータを表示するためには rand()のシード値に日付を指定すればよいでしょう select o.bid,b.bname from osusume as o inner join book as b on o.bid=b.bid where o.sid=1 order by rand(curdate()) limit 3
であれば、やはりcommitされていないか、どこかでrollbackされているということぐらいしか思い当たりません・・・ executeBatchではなく、executeUpdateで1件だけInsertした場合はちゃんと登録されるのですよね？
「レポートの元（テーブルorクエリ）で計算しておく」ではダメなんですか？ 単価: iif([商品]='商品A', 100, iif([商品]='商品B', 300, iif([商品]='商品C', 200, 0))) 金額: [個数]*[単価] の列を追加したクエリを新たに作り、それをレポートの元とする。 合計金額でsum(金額)を月別に求めればよさそう。
「その列」をｗｈｅｒｅ条件に記述して、is null またはis not nullで絞れますか？ どちらもできないなら、nullと空文字を混同しているのかも
IPアドレスではなく、ドメイン名で指定したらどうでしょう？ あと外部データソースで指定しておいたら、 PC上のスクリプトを起動させるなどでそのファイルがホストされているか確認できます。
No.1さんの回答でいいと思いますが、記載のSQLのおかしい点を。 IN条件を使うなら、 項目 IN (値のリスト) という感じです。 記載のSQLであれば、 select * from [DB名] where [パスワード] = 'test' and [更新日] IN (select [更新日] from [DB名] where [ユーザID]='1111' order by [更新日] desc limit 3); となると思います。 まぁ、これでは[やりたいこと]には合わないのですが。
>SELECT * FROM DDD WHERE B = (SELECT B FROM DDD WHERE C=1) SELECT * FROM DDD WHERE B in (SELECT B FROM DDD WHERE C=1) だったらできるんじゃないかな～
2013環境はないので2010で確認しましたが、質問者さんと同じ結果でした。 クエリでの比較は、テキストモードでの比較なのでそれのバグが原因だと思われます。 （テキストモードとは、大文字/小文字、半角/全角、ひらがな/カタカナ を区別しないというモード。） 吉 だけなら No.1の回答者さんの方法でいいと思いますが、他にも環境依存文字の存在する可能性があるなら、StrComp関数でバイナリモードで比較するといいかもしれません。その代わり、大文字/小文字、半角/全角、ひらがな/カタカナ を区別するという比較になりますが。 フィールド　StrComp([フィールド名],[氏名を入力してください。],0) 抽出条件　0 これで2010環境では、パラメータに 土口 の吉田さんを入力すると1件のみの表示になりました。
こんなのを使えば簡単なのでは？ http://buffalo.jp/products/catalog/network/remot …
タスクマネージャのプロセスには現れていない。 プログラムの追加と削除にも無い。 ならアンインストール時に消し損ねたので レジストリから削除すればよいかと。 サービス一覧の中で、SQL Server(YAYOI) をダブルクリックすると 全般タブ中に サービス名 ○○○ 表示名 SQL Server(YAYOI) 後略・・・ となっているハズです。 コマンドプロンプトを立ち上げて sc delete "○○○" でEnter。 SQL Server Agent(YAYOI) も同様に。
＞MySQLの特定のカラムの全データを削除 「削除」とはどういう状態を想定しているのでしょうか？ レコードの削除と違いカラムのデータは削除はできません。 特定のデータで埋めるか、デフォルト値に戻すか、nullにするかでしょう。 以下サンプルです create table hoge (id int not null primary key auto_increment ,a1 int null default null ,a2 int null default 0 ,a3 int not null default 0 ,a4 int not null default 100 ,b1 varchar(30) null default null ,b2 varchar(30) null default '' ,b3 varchar(30) not null default '' ,b4 varchar(30) not null default 'xxx' ); 数値型のa1～a4と文字列型のb1～b4にそれぞれnull設定とデフォルト値設定をしたとします。 //テストデータ投入 truncate hoge; insert into hoge(a1,a2,a3,a4,b1,b2,b3,b4) values(1,1,1,1,'a','a','a','a'),(2,2,2,2,'b','b','b','b'),(3,3,3,3,'c','c','c','c'); ここで、「削除」的な処理をするには各カラムにNULLを与えます update hoge set a1=null,a2=null,a3=null,a4=null,b1=null,b2=null,b3=null,b4=null; こうすると、null設定した数値型はnull、null設定していない数値型は0、 null設定した文字列型はnull,null設定していない文字列型は''になっているのが みてとれます。 これではわざわざデフォルト設定しているのが意味がありません デフォルト値に戻したい場合はdefault()関数で処理します。 //データを再設定 truncate hoge; insert into hoge(a1,a2,a3,a4,b1,b2,b3,b4) values(1,1,1,1,'a','a','a','a'),(2,2,2,2,'b','b','b','b'),(3,3,3,3,'c','c','c','c'); //デフォルトとに戻す update hoge set a1=DEFAULT(a1),a2=DEFAULT(a2),a3=DEFAULT(a3),a4=DEFAULT(a4),b1=DEFAULT(b1),b2=DEFAULT(b2),b3=DEFAULT(b3),b4=DEFAULT(b4); こうすればnull設定してあってもデフォルト値が優先になりますし、 0以外の数値デフォルトや''以外の文字列デフォルトへ戻すことも可能です
＃１、＃２です。すみません。漏れがあるので訂正。 select 区分, 理由１ as 理由　from <テーブル名> UNION ALL select 区分, 理由２ as 理由　from <テーブル名> UNION ALL select 区分, 理由３ as 理由　from <テーブル名> ; です。 UNION と　UNION　ALLの違いは、 UNION　ALLだとおのおののselect結果すべてを返す、 UNION　だけだと　区分, 理由　の重複を除去した結果を返す、の違いです。
>どうしてそうなってしまったのか、 経験はありませんが、 可能性の一つとして、複数ユーザーが同じファイルを共有していて・・。 誰かがレコードの削除を行った。 >又直すには、どうしたらいいのでしょうか？ あなたが作成したファイルではないのなら、作成者に相談してください。 決して自分で何とかしよう・・とは考えないこと。 あなたが作成者であれば ■必ずファイルのバックアップを取ってから■ Access でオートナンバー型フィールドの値をリセットする方法 http://support.microsoft.com/kb/812718/ja の2007の説明を読んでみてください。 自信が無ければ止めることです。 元々オートナンバーは一意の番号を付与するためのものです。 結果的に（副産物として）通し番号になっているだけですので 飛び番号を気にせず使い続けるのも選択肢の一つかと思います。
update テーブル set 危険フラグ=1 where 賞味期限 < now() + interval 24 hour; みたいな感じで
こんにちわ。 > Oracleでの動的ポートがわからないのでご教示頂けますでしょうか。 デフォルトでは、TNS Listener がClient からの接続要求を1521ポートで 待っていますが、接続要求を受け取った後はClient とサーバープロセスが 別のポートで通信し合う事かと。 この辺が参考になるかと思います。 http://www.oracle.co.jp/forum/thread.jspa?thread …
こんにちわ。 > 他のDBのテーブルを参照したいのですが方法がわかりません。 DB Link 使用すれば、他DB のデータを参照する事ができます。 手順としては、こんな感じです。 1) 接続しているDB Server のtnsnames.ora にもう1つのDB に接続するための 　 接続文字列を定義する。 2) SQL*Plus から、以下のようにしてもう1つのDB を参照するための 　 DB Link を作成する。 　 SQL> Create database link dblink名 connect to 接続ユーザ名 　　　　　identified by パスワード using '接続文字列'; 3) 後は、テーブル名を@dblink名で修飾すると、他DB のテーブルを 　 ローカルのテーブルと同じように扱えます。
こんなデータの持ち方をすると集計しやすいかと 仮に長野、亀井、坂本、阿部、村田の5人がいて、 長野は亀井と友達、阿部は長野、亀井、坂本と友達、村田はぼっちだとすると //元データ create table user(uid int not null unique ,name varchar(20)); insert into user values(1,'長野'),(2,'亀井'),(3,'坂本'),(4,'阿部'),(5,'村田'); create table friend(id int primary key auto_increment,fid int,uid int,unique(fid,uid)); insert into friend(fid,uid) values(1,1),(1,2),(2,1),(2,4),(3,2),(3,4),(4,3),(4,4); ※friendテーブルのfidは友達二人をつなぐためのリンク用id (1)各自友達が何人いるか集計する select user.uid,name,coalesce(count,0) as count from user left join( select uid,count(*) as count from friend group by uid ) as sub on sub.uid=user.uid order by uid; (2)各自の友達の名前を羅列する select u1.uid,u1.name,friends from user as u1 left join( select f1.uid,group_concat(u2.name) as friends from friend as f1 inner join friend as f2 on f1.fid=f2.fid and not f1.uid=f2.uid inner join user as u2 on f2.uid=u2.uid group by uid ) as sub on u1.uid=sub.uid
投稿してからもう一回見直していたら、 dt[i] の iもlocal変数だった、 i がn-1 まで回りきってから、callbackが呼ばれるので、callback 関数にもう一つかぶせないといけない db.transaction( 　(function(x1,x2){ /* データの受け渡し用wrapper関数と引数 */ 　　return function(tx) { 　　　tx.executeSql( "insert into 対象 (番号,名称) values(?,?)",[x1,x2], 　　　　function(tx,rs) {}, 　　　　function(tx,er) {alert(er.message);} 　　　);/* tx.executeSql の閉じ */ 　　};/* return するcallback 関数の閉じ */ 　})(cd,nm) ,/* wrapper関数に渡すデータの指定。これは、 db.transaction が呼ばれた時点の変数値が入る */ 　function(er) {alert(er.message)}, 　function() {} );/* transaction メソッドの閉じ */ ※ ()や{} の多重入れ子で括りの対応が解らなくなるので、全角空白でインデントしてます。コピー時は、半角に変換してください。 実行チェックしてないので、まだ間違いがあるかも？
バルク処理でupdateまでやってしまうとなると一度テンポラリテーブルを 作った方がよいかも //元データ create table TBL1(id int not null unique key,string varchar(10),count int); insert into TBL1 values(1,'aaa',0),(2,'bbb',3),(3,'ccc',1); create table TBL2(id2 int not null unique key,string2 varchar(10),count2 int); insert into TBL2 values(1,'aaa',0),(2,'bbb',2),(3,'ccc',1); //処理 create temporary table tmp(id3 int,string3 varchar(10),count3 int); insert into tmp values (1,'aaa',3),(2,'bbb',3),(3,'ccc',3),(4,'ddd',3); insert into TBL1 select id3,string3,count3 from tmp left join TBL2 on id3=id2 where count2 is null or count2<1 on duplicate key update count=count3; //テンポラリを使わない場合はunionでデータを羅列？ insert into TBL1 select id3,string3,count3 from (select 1 as id3,'aaa' as string3,3 as count3 union select 2,'bbb',3 union select 3,'ccc',3 union select 4,'ddd',3) as list left join TBL2 on id3=id2 where count2 is null or count2<1 on duplicate key update count=count3;
＞別に勝手に連番 注意する必要があるのはauto_incrementは必ずしも連番を保証する機能ではないこと あくまでも他のレコードと異なることを保証するためだけのものなので 抜け番や飛び番が発生することを理解する必要があります 抜け番が発生しないようにするためにはかなり負荷の高い無駄な処理が必要です どのような運用方法を想定しているかによります。
話がおかしいと思います。 恐らく、 　１．本番環境旧システムのスキーマをエクスポート 　２．開発環境新システムのNEWテーブルをエクスポート 　３．本番環境新システムのスキーマへ１．のダンプファイルをインポート 　４．本番環境新システムのスキーマへ２．のダンプファイルをインポート という流れかなと思います。 この時、NEWテーブルがトリガーからデータ登録が行われるならば、 インポート後は0件でも問題ないと思います。 開発環境で作成されたデータが本番環境に混ざってはいけませんからね。 しかし、NEWテーブルが今回追加され、トリガーによってレコードが挿入される テーブルとしたら、足りないものがあります。 それは、『トリガーの生成』。 どこかのテーブルが更新された時に、NEWテーブルを更新するトリガーを 追加、もしくは変更しているはずです。 これは上記１．２．３．４．をやっても反映されません。 そのトリガーの所在を明確にした上で、４．を適用後にトリガーのCREATE文を 本番環境へ走行させる必要があります。
SQLの種類によっては以下でもいけます select hoge,sum(stat='a') as a,sum(stat='b') as b from test01 group by hoge; なおcountでやるならnullを利用します select hoge , count(if(stat = 'a' ,0,null)) as a , count(if(stat = 'b' ,0,null)) as b from test01 group by hoge; もうすこし複雑になってくるとピボットテーブルという処理用のテーブルを 用意すると効率的に処理ができます
TCP/IPのポート 1433 を閉塞しているとか？ 参考URL：http://support.microsoft.com/kb/287932/ja
キーとなる列名を指定して、Group Byを用います。 select hoge, count(*) from test01 group by hoge; 場合によっては select hoge, count(hoge) from test01 group by hoge; と書くかも。
＞ＤＢはｍｙＳＱＬ それはおそらくMySQLの仕様が4.0まではcharやvarcharなどいわゆる文字列型の カラムの文字数上限が255バイトとなっていたからでしょう 現在のMySQL5系は拡張されて65535文字まで格納可能なのであまり255桁に こだわる必要はないかもしれません。 ただしインデックスの特徴で極端にながい文字列にインデックスを作成すると 無駄がおおく、肥大化による弊害もでてくるため、255文字程度を上限にしておいた方が 運用上効率的かもしれません （たいていのものの名称は200文字程度におさまることですし）
> Like "81*"の人で、負担金が600以上の人を追加しようとしましたが出来ませんでした。 式2として「何を」追加したいのでしょうか？ [番号]のLike条件が3つありますが、80*、90*の場合には式2に何を返しますか？ 以下、「Like "81*"の人で、負担金が600以上」でtrueを、それ以外はfalseを返します。 式2: IIf(([番号] Like '81*') and ([負担金]>=600)),True,False)
命題の通りだと ＞C社：1件　重複1件 ではなく、こうじゃない？ C社：1件　重複0件 また、3月のB社への問合せはどうするのでしょうか？ B社：0件　重複1件 とするには「重複」ではないですから、非表示でよいのでしょうか？ 総じてこんなかんじ //元データ create table client(cid int,name varchar(20)); insert into client values(1,'A'),(2,'B'),(3,'C'),(4,'D'); create table ask(mail varchar(50),cid int ,dt datetime); insert into ask values('aaa@aaa.com',1,'2013-02-01-10:00:00'),('aaa@aaa.com',2,'2013-03-01-10:00:00'),('bbb@bbb.com',3,'2013-04-01-10:00:00'),('ccc@ccc.com',4,'2013-04-02-10:00:00'),('aaa@aaa.com',1,'2013-04-03-10:00:00'); //表示 select t1.cid,c.name,count(*) as kensu,( select count(*) from ask as t2 where and t1.cid=t2.cid and dt between '2013-02-01 00:00:00' and '2013-03-31 23:59:59' ) as chohuku from ask as t1 inner join client as c on c.cid=t1.cid where dt between '2013-04-01 00:00:00' and '2013-04-30 23:59:59' group by cid
なんか説明がデータベーステーブルの行と列の考え方が90°狂っているとしか思えないんだが。id と他カラムとの関係が見えない。 group by がないんだけど、 tableごとに全行 group_concat したいだけですか？もしそうならjoin の順番を間違えてますね。 a テーブルからは、h テーブルにも同じid値が存在する行を選択して　全行に group_concat b テーブルも同様 で各一行づつになったサブクエリをjoin であれば、以下 select * from ( select group_concat(c) as c, group_concat(d) as d from a where exists ( select * from h where a.id=h.id ) ) as a1 closs join ( select group_concat(e) as e, group_concat(f) as f from b where exists ( select * from h where b.id=h.id ) ) as b1 ;
$pdo = new PDO("mysql:dbname=men", "root"); $pdo->query("set names utf8;"); // この行を追加する $st = $pdo->query("SELECT * FROM udon"); 取り急ぎの対策といたしましては、 上記のように1行追加してみるといかがでしょうか？？ また下記URLにも同様の現象を解決している事例がございましたので、 つけさせていただきました！ http://blog.machacks.net/2013/06/18/pdo%E3%81%A7 …
> nameの入力が5件あるので、５回同じような検索をする、ということです。 なるほど、意味がわかりました。 それなら5つのnameを一度に検索すれば済みますね。 （発行すべきクエリは＃４の回答がそのままその通りでしょう） そのかわり、ロジックが面倒になると思います。 感覚的に、 　１．SQLを発行してResultSetを取得 　２．SQLの結果を専用クラスかなんかに突っ込んで、それをHashMapなどsnameをキーにして格納 　３．探す時に、２．ので作った変数に対して、HashMap.get(sname)で求める こんな感じになる気がしますが、どうなんでしょう？ ロジック内で余計なループをする必要が出てくるなら、 検索スピードが速くなっても、レスポンスタイムも速いとは限りませんよね。 クエリを投げるよりロジックで頑張る方が遅いっていうのも往々にありますし。 AppサーバとDBサーバが分かれていて、絶対的な制約として、極力ネットワーク通信をしない、 Appサーバの処理性能に任せるというコンセプトならSQL一発ってのが正解かも しれませんが。 こんな些細な部分に、それをやるほどの意義があるのかと言うと甚だ疑問です。 仮にその検索がいちいち遅いとすると、そもそもプログラムではなくDBの問題のような。
あくまで私見ですが参考までに →一般的には(1)が好まれるのではないでしょうか 往々にして選択肢というのはシステムの運用が始まると拡張することがないため １レコードに個別に埋め込むのが感覚的にももっとも適しているため メリット： 特定のレコードに対する有無だけをチェックする場合はもっとも効率的 データ構造が単純なためイメージしやすい （ようはエクセルちっくなデータだと思えばよいので） デメリット： 項目が増えるといちいちカラムを増やさないといけず、多くの選択肢がある 場合は物理的に対応できないなど、スケーラビリティが低い 冗長なもち方のため集計や抽出の際にあまり効率的なSQLをかけない →次に(2)と(3)はほぼ同様のケースであまりSQLライクではありません とくに(3)のような持ち方だとおおよそSQLとしての集計には向きません （例示の(2)はビット処理じゃないですね？1と2がチェックなら3？） メリット： カラム数がへらせる データの拡張が容易 デメリット： とくにインデックスがききにくいため大量のデータ処理にはむかない データに制限をつけにくい →個人的には(4)を使うケースが多いです メリット： 集計が簡単で簡便なSQL文で表現できる 拡張性はたかい デメリット： かならず集計のSQLが必要になるためなれないとSQL文が書きにくい ただし最初に書いた通り、拡張する必要があるかどうかで(1)の方を選ぶことも 多々ありそれはケースバイケースで設計時点で調整します
case式を使って、 select YEAR("日付") as yere,MONTH("日付") as month,sum(case when "収支名" = '収入' then "金額" else "金額" * -1 end) as "差" from 収支 group by YEAR("日付"),MONTH("日付") こんな感じでどうでしょうか。 "収支名"には'収入'・'支出'しかない前提です。
列Ａの値をインクリメントするようなＵＰＤＡＴＥ文を書いたことはありませんか？ update tbl set a = a + 1; などと同じように、シンプルに考えれば良いですよ。 update tbl set name_en = concat(substr(name_en,comma+1) ,' ',substr(name_en,1,comma-1)) ;
バックアップではなく、復元ですよね。 なら、復元元と復元先が逆ではないでしょうか？
＞ちなみにこれはどれくらいのデータ数までなら問題ないのでしょう？ うーん、経験的にはインデックスさえきちんと貼ってあれば 数万件程度は実用レベルで使えるような気がします。 ちなみに「今年」とか「年齢」という不確かな定義（変化してしまうもの）を 格納しておくのはあまりお勧めできません。 （もちろん4/1時点での年齢など一定の条件がつけば別） 蛇足ですがデータの持ち方としては name,age,yearのような持ち方をしたテーブルを作った方が効率的かも //去年=2012、今年=2013としておけばよい create table user (name varchar(30),age int,year int,unique key(name,year)); insert into user values('taro',21,2012),('jiro',24,2012),('taro',22,2013),('saburo',20,2013); //結果 select name,sum(age*(year=2012)) as lastage,sum(age*(year=2013)) as thisage from user group by name ※だたし、データがない場合はnullではなく0が変えるので注意
そもそも明細TBLに予約TBLとの関連がないのが良くないと思うのですが。 それがあればもっと単純なSQLでよくなるはずです。
>【select distinct カラム名 from テーブル1 union select distinct カラム名 from テーブル2;】 >としても重複を取り除いた後にテーブルを結合してるので結果的に両テーブルの重複した値を取り除くことができず。 いや、できますね むしろunionするならdistinctもいらないです。 //データ作成 create table t1(data int); create table t2(data int); insert into t1 values(1),(2),(2),(3),(3),(4); insert into t2 values(1),(3),(3),(5); //表示 select data from t1 union select data from t2; //重複も表示するならunion all select data from t1 union all select data from t2;
tarコマンドで.tar.gzにした、ということは、 tarでアーカイブ(複数のファイルを一つの書庫に入れる。無圧縮ZIPみたいなもの)した後、gzipで圧縮した状態になっています。 pg_restore -U postgres -d (データベース名） < ****.tar.gz では、その圧縮されたままの入力になるので、不正となります。 gunzip -C ****.tar.gz | pg_restore -d (データベース名） これでも、 gzipの展開はされていますが、tar形式のアーカイブになっています。 元のダンプファイルではありません。 pg_restoreで使うためには、アーカイブの中にあるファイルを取り出す必要があります。 GNUtarの場合、 -Oオプションで標準出力に出力、というのがあるので tar -O zxvf ****.tar.gz | pg_restore -d (データベース名） でできるかと思います(実験はしていません) 本来のtar等、標準出力オプションが無い場合は、 tar.gzから元のダンプファイルをファイルに展開→そのファイルをpg_restore となります。 そもそも、tar+gzipでアーカイブして圧縮するのが間違いです。 単にgzipで圧縮すればいいでしょう。そうしていれば gunzip -c ****.gz | pg_restore -d (データベース名） で使えたはずです
こんにちわ。 > TIMESTAMP型が含まれるテーブルは上記のSQLでは取得できないのでしょうか。 通常、そのような事はありません。 問題のテーブルにアクセスできるユーザからuser_tab_columns ビューを 参照している前提で、考えられる原因が3つあります。 1) 別スキーマにテーブルがある。 　 user_tab_columns ビューは、自スキーマに定義されているテーブルの 　 列情報を持ちます。 　 all_tab_columns ビューで情報が取得できるか確認して下さい。 　 ※ all_tab_columns ビューのowner 列にテーブルの所有者名が 　　　格納されています。 2) テーブルが大文字/小文字混在で作成されている。 　 テーブルを大文字/小文字混在でCreate table しても、大文字でテーブルが 　 作成されますが、テーブル名をダブルクォーテーションで囲むと大文字/小文字 　 混在で作成させる事ができます。 　 その場合、ディクショナリにもテーブル名は大文字/小文字混在で格納されて 　 います。 　 where upper(table_name) = upper('テーブル名') で確認してみて下さい。 3) Synonym 経由で別の表にアクセスしている。 　 Synonum 経由で別の表にアクセスしている場合も、user_tab_columns や 　 all_tab_columns ビューには列情報は格納されません。 　 select owner, object_type, object_name from all_objects 　　 where object_name = '先に指定したテーブル名'; 　 上のSQL で、どの所有者のどのようなオブジェクトにアクセスしているか 　 確認してみて下さい。
ワークグループ環境で動作する SQL Server をドメインに参加させる場合でも、 再インストールは必要ありません。 ドメイン参加後、ドメインユーザーで SQL Server を管理したり、接続する場合は SQL Server の「ログイン」にドメインユーザーを追加して適切なロールを設定する 必要があります。 データベースエンジンサービスや Agent サービスのサービス開始アカウントを ドメインユーザーにする場合も、再設定が必要です。 これはSQL Server 構成マネージャーなどから行います。
>カーソルおよびフェッチ時にダブルクウォートを削除、またはシングルクウォートに変換をすることが可能でしょうか。 なんか違う気がする。 >※※※上記TESTREC.TEST_NAMEに"AAAA"の形でデータが入るため、下記実行時にORAエラーが発生する。 というのを >EXECUTE IMMEDIATE V_EXEC_STRING INTO V_EXEC_COUNT; で実行されるＳＱＬ文が、 >V_EXEC_STRING := V_EXEC_STRING || 'SELECT COUNT(*) FROM READ_TBL WHERE TEST_NAME = '|| TESTREC.TEST_NAME; によって作成された SELECT COUNT(*) FROM READ_TBL WHERE TEST_NAME = "AAAA" になっているからAAAAという項目がないってエラーになっているようです。 "を除去したところで、 SELECT COUNT(*) FROM READ_TBL WHERE TEST_NAME = AAAA になるだけ。 やはり、AAAAという項目がないってエラーになるのでは？ V_EXEC_STRING := V_EXEC_STRING || 'SELECT COUNT(*) FROM READ_TBL WHERE TEST_NAME = '''|| TESTREC.TEST_NAME || ''''; にすると、 SELECT COUNT(*) FROM READ_TBL WHERE TEST_NAME = 'AAAA' となるので、TEST_NAMEの値が、AAAAの件数を取得できる ということかなと思いますがいかがでしょう？
元テーブルのデータに特定の条件をつけるのはwhereで 処理結果からデータに特定の条件をつけるのはhavingで 既述します。 例えば、 （質問文の例） where 従業員職種テーブル.job_id not = 4 とか、 （税額を計算して10000円以上を対象にする） select 売上額 * 税率 as 税額 from table1 having 税額 > 10000 とか。 ※いったん対象にして処理をしてから条件を適用するhavingのほうが処理に時間がかかります。 where でできるのならそちらが望ましいです。 質問のSelect文なら、 select 従業員職種テーブル.worker_id, 従業員テーブル.name, 従業員テーブル.age GROUP_CONCAT(職種テーブル.job_name order by 職種テーブル.job_id) from 従業員職種テーブル left join 従業員テーブル on 従業員職種テーブル.worker_id=従業員テーブル.worker_id left join ot_dow on 従業員職種テーブル.job_id=職種テーブル.job_id where 従業員職種テーブル.job_id not = 4 /* これを追加 */ group by 従業員職種テーブル.worker_id order by 従業員職種テーブル.worker_id とかしてみてください。
＃１です。補足しておきます。 ＯＤＢＣ経由です。 accdb（リンクテーブル） <--ODBC--> MySQL accdb上で、自ファイル内のテーブルとリンクテーブルのクエリを作成する。
＃１、＃２、＃５です。 ＃３さんへの回答の補足を見落としてました。 原因は From にあります。 > left JOIN kashu ON song.kashu_1_ID = kashu.kashu_ID) > left JOIN kashu_yomi ON song.kashu_1_ID = kashu.kashu_ID) ←追加 > left JOIN kashu_yomi ky2 ON song.kashu_2_ID = ky2.kashu_ID) ←追加 ＜結合の方法＞ JOIN ＜テーブル名＞ ON ＜結合列の条件＞ であるべきが ＜結合の方法＞ JOIN ＜列名＞ ON ＜結合列の条件＞ になってる。 これ、kashu_yomi　は１行目の left JOIN kashu ON song.kashu_1_ID = kashu.kashu_ID) で拾えるので２行目は不要。 ３行目はテーブル名を記述するのが正しいので left JOIN kashu ky2 ON song.kashu_2_ID = ky2.kashu_ID) ←追加 です。 ただし、selectを ti2.tie_up as tie_up2 kashu.kashu_yomi, ←追加 ky2.kashu_yomi as kashu_yomi2 ←追加 と変更することも必要。
あ、１です。 新しくレコードを追加するんでしたね＾＾； 先ほどの例だと「今日のメモ」を上書きしてしまっていました。 （名字、名前が既に登録されていたら今日のメモを上書き、 名字、名前が一致しなければレコードを追加するというＳＱＬ文でした） あたらしくレコードを追加するのはINSERT INTOです。 主キーの設定をしなければどんどん追加できますけど、名前と名字がかぶってしまって無駄になってしまいますね。 私ならテーブルの構成はこうします 名簿テーブル ・ＩＤ （主キー） ・名字 ・名前 メモテーブル（主キーなし） ・ＩＤ ・日付 ・メモ メモがあればメモテーブルにどんどんINSERTしていけばいいと思います。 メモの内容の変更はをUPDATEでWHERE句でIDと日付を指定すればいいと思いますー＾＾ｖ
> データを移動・・・レコード移動・・・ という言葉が出てきていますが、表示上の事と解釈して良かったでしょうか 提示された５桁の数字部分のフィールド名を「番号」、テーブル名を「★★」と仮定します。 ９レコードを３×３の表示・・・これに限定したとすれば、以下でできそう SELECT Q1.*, Q2.*, Q3.* FROM ( (SELECT (Int(番号)-1)\3 AS S, (Int(番号)-1) Mod 3 AS M, * FROM ★★) AS Q1 INNER JOIN (SELECT (Int(番号)-1)\3 AS S, (Int(番号)-1) Mod 3 AS M, * FROM ★★) AS Q2 ON Q1.S+1=Q2.S AND Q1.M=Q2.M) INNER JOIN (SELECT (Int(番号)-1)\3 AS S, (Int(番号)-1) Mod 3 AS M, * FROM ★★) AS Q3 ON Q2.S+1=Q3.S AND Q2.M=Q3.M ORDER BY Q1.M; S は、番号を元に、何組目の表示になるのか M は、番号を元に、何レコード目の表示になるのか 表示レコードは、M が同じで 隣の S は 左側の S+1 になっている ９レコード限定なので INNER JOIN で結び付け 番号 「00001」の隣は「00004」で、その隣は「00007」 番号 「00002」の隣は「00005」で、その隣は「00008」 番号 「00003」の隣は「00006」で、その隣は「00009」 番号 「00004」の隣は「00007」で、その隣は・・・ないので INNER JOIN により抽出外 横３組は変えずに表示行を変更できるようにすれば、以下の様な感じで （実行すると「行数」の入力になるので、4 とか 5 とか入力すれば・・・） SELECT Q1.*, Q2.*, Q3.* FROM ( (SELECT (Int(番号)-1)\[行数] AS S, (Int(番号)-1) Mod [行数] AS M, * FROM ★★) AS Q1 LEFT JOIN (SELECT (Int(番号)-1)\[行数] AS S, (Int(番号)-1) Mod [行数] AS M, * FROM ★★) AS Q2 ON Q1.S+1=Q2.S AND Q1.M=Q2.M) LEFT JOIN (SELECT (Int(番号)-1)\[行数] AS S, (Int(番号)-1) Mod [行数] AS M, * FROM ★★) AS Q3 ON Q2.S+1=Q3.S AND Q2.M=Q3.M WHERE Q1.S=0 ORDER BY Q1.M; ※ 計算用に追加したフィールド「S」「M」は適当にあしらってください また、別の方法（クロス集計）を使って横５組限定としてみると以下の様な雰囲気に PARAMETERS [行数] Long; TRANSFORM First(Q1.値) AS 値 SELECT (Int(Q1.番号)-1) Mod [行数] AS 順 FROM (SELECT 番号, "番号" AS 項目, 番号 AS 値 FROM ★★ UNION ALL SELECT 番号, "郵便番号", 郵便番号 FROM ★★ UNION ALL SELECT 番号, "住所", 住所 FROM ★★ UNION ALL SELECT 番号, "氏名", 氏名 FROM ★★ UNION ALL SELECT 番号, "TEL", TEL FROM ★★) AS Q1 GROUP BY (Int(Q1.番号)-1) Mod [行数] PIVOT 項目 & (((Int(Q1.番号)-1)\[行数])+1) IN ('番号1','郵便番号1','住所1','氏名1','TEL1', '番号2','郵便番号2','住所2','氏名2','TEL2', '番号3','郵便番号3','住所3','氏名3','TEL3', '番号4','郵便番号4','住所4','氏名4','TEL4', '番号5','郵便番号5','住所5','氏名5','TEL5'); ※ クロス集計では、PIVOT 部分で IN 指定（列見出し指定）しないと、 TEL1,TEL2,氏名1,氏名2,住所1,住所2,・・・の様に、組として表示してくれない ※ 各フィールドの値を１つのものとして扱うので数値型があったとしても、ここではテキストに なお、上記クロス集計で５組を有効に使ってみると（行数はレコード数によって可変） TRANSFORM First(Q1.値) AS 値 SELECT (Int(Q1.番号)-1) Mod ((Q2.CT+4)\5) AS 順 FROM (SELECT 番号, "番号" AS 項目, 番号 AS 値 FROM ★★ UNION ALL SELECT 番号, "郵便番号", 郵便番号 FROM ★★ UNION ALL SELECT 番号, "住所", 住所 FROM ★★ UNION ALL SELECT 番号, "氏名", 氏名 FROM ★★ UNION ALL SELECT 番号, "TEL", TEL FROM ★★) AS Q1, (SELECT Count(*) AS CT FROM ★★) AS Q2 GROUP BY (Int(Q1.番号)-1) Mod ((Q2.CT+4)\5) PIVOT 項目 & (((Int(Q1.番号)-1)\((Q2.CT+4)\5))+1) IN ('番号1','郵便番号1','住所1','氏名1','TEL1', '番号2','郵便番号2','住所2','氏名2','TEL2', '番号3','郵便番号3','住所3','氏名3','TEL3', '番号4','郵便番号4','住所4','氏名4','TEL4', '番号5','郵便番号5','住所5','氏名5','TEL5'); ※ Q2 でレコード数を求めておいて、前述の [行数] 部分を ((Q2.CT+4)\5) に置き換えます ただし現状では、５組目が使われない事があります。 これは、左の組から行分データを詰めるので・・・ １０レコードなら２行で５組目まで使われますが、 １１レコードなら３行で、３組目までは埋まって、４組目は２つの計１１ ３行では、１３レコードになって初めて５組目が使われる事になります。 ※ なお、データ量によって組数（フィールド側）も可変にしたい場合は、 VBA で SQL を組み立てる事になると思います。 ※ 各処理性能はわかりません
#2のTabledefのConnect（接続文字列）にヒントが隠されているかもしれませんが、 当方では、 リンクテーブルでかつシステムオブジェクトであったケースは覚えがないので分からないです。 VBA云々は関係ないだろうとは思います。
メリット 検索が早くなる デメリット 更新や挿入の処理に時間がかかる ディスクやメモリをたくさん喰う RAMが少なくてテーブル数やデータ量が多いとスワップアウトするので検索が遅くなる RDBMSがインデックスの効率が悪いと判断したらインデックスを使用しないので資源の無駄遣いになる
今日、見つけたんですが [印刷プレビュー]タブを丸ごと表示して良いなら こちらの方法で。 http://mukkumuku.blogspot.jp/2010/10/access2010- … グループ毎の非表示もできそうですが、ID を調べたりしなくちゃいけないので。 <customUI xmlns="http://schemas.microsoft.com/office/2006/01/cust … <ribbon startFromScratch="true" > <tabs> <!-- idMsoで指定し明示する --> <tab idMso="TabPrintPreviewAccess" visible="true" /> </tabs> </ribbon> </customUI> もっと良い方法があるかもしれないけど、 一応動いている方法。 印刷プレビュー時 に 「印刷」「印刷プレビューを閉じる」だけを表示します。 USysRibbons に レコードを追加。 RibbonName ： PrintRibbon （何でもいいけどとりあえず「PrintRibbon」） RibbonXml ： <customUI xmlns="http://schemas.microsoft.com/office/2006/01/cust … <ribbon startFromScratch="true"> <tabs> <tab id="frmPrintTab4" label="コマンド"> <group id="frmPrintGroup1" label="印刷"> <control idMso="PrintDialogAccess" size="large"/> </group> <group id="frmPrintGroup2" label="プレビューを閉じる"> <control idMso="PrintPreviewClose" size="large"/> </group> </tab> </tabs> </ribbon> </customUI> 各レポートの「リボン名」プロパティ に「PrintRibbon」 を設定。 カレントデータベースのリボン名 は、非表示用のまま変更せずに。 以上です。
基本的な問題です sales_goods_noはreceiptを含むので文字列 goods_noはPK（プライマリーキー）なので整数です。 整数と文字列はJOIN（結合）出来ません 解決策 (1)receiptを9999とかにしましょう（商品数が多い場合もっと大きくする必要があります） (2)sales_goods_noを整数(int)にします。　エラーがうるさい場合テーブルを作り直してください。 (3)goodsテーブルに goods_no=9999,　goods_name=""というレコードを追加してください それでエラーは出ないはずです 最後に1つ言いたいことがあります。 普通質問するときは、エラー内容をコピペして添付します。最低限のマナーです。 それを怠ると、海外だと無視されることもあります。 日本はエスパーがおおいのでみんなさん的確に類推して答えてくれますが エラー内容がわかればこちらも答えるのが楽になります。 そもそも、エラー内容読みましたか？
＿＿＿＿＿＿＿ Dim rs As New ADODB.Recordset rs.Open "～(1)～", cn, adOpenDynamic, adLockOptimistic, adCmdText ￣￣￣￣￣￣￣ を ＿＿＿＿＿＿＿ Dim rs As ADODB.Recordset Set rs = cn.Execute("～(1)～") ￣￣￣￣￣￣￣ に変えてみるとどうでしょう？
> テーブルA：承認が必要なデータが保存されます。 > テーブルB：承認が完了したデータが保存されます。 > 承認処理はWebからオンライン処理で行います。 > 承認完了後、バッチ処理でテーブルBに内容をコピーします。 一般的な話をすると、テーブルAとテーブルBが1:1で共通の属性を持っているなら、 そもそもテーブルAとテーブルBを分けたりしません。分けることで冗長になるので。 それに、承認済みデータと未承認済みデータはフラグや承認日時列を設定してあげる事で、 SQLで絞り込めますから。性能云々についても、何千万件ならいざしらず、たかが50万件 程度ならチューニング次第でどうにでもなるでしょう。 もちろん、これは一般論であり、そうせざるを得ない理由があるなら話は別です。 なので、まずは、Cテーブル以前にまずBテーブルがなぜ必要なのか明確にしていただかないと。 > １．テーブルAの完了フラグをONにする。 > 　　バッチ処理は、テーブルAの完了フラグがONのデータを対象とする。 > ２．新たにテーブルCを設け、承認完了したデータをコピーする。 > 　　バッチ処理は、テーブルCに存在するデータを対象とする。 前提条件等にもよりますが、普通はますます冗長になる２案は採用しません。 さらに言えば、１案よりもNo.2様が言われている、承認してAテーブルのデータを削除する際に Bテーブルにデータを入れる方が良いでしょう。 もっと言えば、データを移動するくらいなら、冒頭で述べたとおり、Bテーブル自体も無くし、 承認された時点で承認日時を入れるためのUPDATEをするのが良いように見えます。
普通に「=」を入れて検索ですけど。 未入力では困るフィールドには自動入力オプションの 「空欄不可」を設定しましょう。
　No.2です。 　書き忘れ、補足。 　もし、調べるのであれば、「トランザクション」とか、「分離レベル」などの単語で検索してみてください。この類の話題が、わんさかと引っかかります。 　ちなみに、先の例での正しい処理は、update文一発でやることなんですが・・・話を単純化するためにあえて、処理をselect・計算・updateと分離してあります。あしからず。
SELECT song.song_ID, song_name, song_name_yomi, kashu, ←これ これがkashuテーブルから参照するのかka2エイリアスから参照するのか判断できないから ちなみにmysql_query("・・・") or die(mysql_error())で デバッグするとよいでしょう。 なおmysql_query関数は非推奨なので、そのままの運用だと早晩いきづまりますので 移行を考えてください
お疲れ様です。 tmnktmnkさんの言われていることで十分わかりますよ。 きっとそんなにOracle詳しくないので、言葉足らずかもしれませんが、 十分わかります。 >ログをスイッチし、Oracleは動作したのですが 確かに、listener.logをリネームすることをスイッチするって言われる方いますよね。 正しくはリネームというと思いますが、スイッチでわかります。 >dllからは動作しません。 固まるんじゃないんですか？応答がない感じで、ぐるぐる回ってるんじゃ？ エラーは特に表示されないんじゃ？ >なんとなくですが、with句を用いたものが失敗しているようです。 with句はSQLが複雑になっているんで、with句だけじゃなく複雑なものだと失敗すると思いますよ。 結論としてですが、 そのアプリケーションサーバからdll経由で接続したセッションが、DB側に残ってないでしょうか？ 質問されてからですので、20時間くらいセッションをはったものがないでしょうか？ それを切断すれば大丈夫です。 切断できない場合は、Oracleを再起動しかありませんが… こういった現象をなんとなく聞いてわかるようになるのには、経験しかありません。 エラーから調べることも大切ですが、現象である程度わかるようになれるといいですね。 tmnktmnkさんの今後のご活躍を期待します。 エラそうですみません。
カラムの型がVARCHERだからです。 VARCHERは文字列型なので、データを数値ではなく文字列として検索しMAXを探しています。 文字列比較は左側の文字から順番に1文字ずつ比較しますので、1と9では9の方が大きいと判断されます。 従って、9999 と 10001 では 9999 の方が大きいと判断されます。
ANO.2です。 うっかりしてました。 ＞⇒それを避けるためにバッチ処理を使わない設計にするとなると、 ＞ポイント残高テーブルを用意して、１３か月分の項目を用意する。 の部分。月が変わると更新しなきゃいけないのですが、そのために １３か月分の項目に加えて、基準月を用意します。 基準月は、当月利用可能ポイントの当月がいつなのかを示します。 プログラムで読み込んだとき（ポイント照会も含む） 基準月が当月でなければ、１３か月分の項目を順番にシフトして、 基準月を当月にして、更新してしまいます。 その後、画面表示なりの処理をする。 ⇒集計がむちゃくちゃやりにくい構造になるので、やっぱり、 　バッチ処理使ったほうがベターでしょうね。 注：集計ってなに？というと 今全員のポイント残高合計がいくら？ とか、顧客別のポイント一覧とかです。
nullを許諾して、デフォルト値をnullにしてみては
おそらくSQL文の間違えになると思います。 update "store_table" set "tenpo_post1" = '123', "tenpo_post2" = '4321', "tenpo_add" = '東京都１－１－１' where "kaiin_no" = '123456'; 上記のように１つ１つ値を設定するような形が、 複数項目をUPDATEする場合の記述になります！
ちょっと違いますが「ビックリマーク」んお対応方法については共通するかと思いますのでURLを参考にしてみてください。 参考URL：http://blog.sou-lab.com/mamppro-phpmyadmin/
## 私はANo1の方の回答のようにスカラー副問い合わせ使ったほうがいい ##（適切なインデックスをつけると確実に処理が早いため）と思っていますけど ## 質問文の以下を素直に反映したSQL文を参考までに記載しておきます。 >やり方としては下記の(1)と(2)の結合ができれば良いと考えております。 select A.商品コード,A.販売個数,A.販売店コード,B.商品コード毎販売個数合計 from (　SELECT　商品コード,　SUM(販売個数) as 販売個数,　販売店コード　FROM　販売テーブル　 　　　　　　　　　　　　　　　　　　　　　GROUP　BY　CONCAT(商品コード,'and',販売店コード) ) as A, ( 　SELECT　商品コード,SUM(販売個数) as 商品コード毎販売個数合計　FROM　販売テーブル　group　by　販売テーブル.商品コード ) as B where A.商品コード = B.商品コード なお、 GROUP　BY　CONCAT(商品コード,'and',販売店コード) は GROUP　BY　商品コード,販売店コード で問題ない というより、商品コード,販売店コードのインデックス作っても早くならないので 後者のほうがいいのでは？ （ファンクションインデックス作るのならいいですが、ファンクションインデックスばかり作ると、 　システム全体としてインデックスの数が増える傾向になり効率悪い。） あ、ひょっとして、 販売店コード　A1　と販売店コード　andA1　を一つにまとめて集計したいということ？ （違うと思うけど）なら、そのままでないとだめです。
TextFormatRemove関数
## 余計なお世話の話ですが。 MySQLでは、Left Join = Left Outer Join （他のDBでは、Left Join = Left Inner Join が多い） http://dev.mysql.com/doc/refman/4.1/ja/join.html　の 「上の構文リストの最後に挙げた LEFT OUTER JOIN 構文は、単に ODBC との互換性を確保するためのものです。 」 を参照。（古いマニュアルですけど変わってなかったと思います） したがって、ANo.1の方の回答で、 「actionテーブルには行はあるが， resultテーブルにはそれと結合できる行が存在しない」ときも出てきます。 ## 私は、これがあるからLeft Join のように　Inner、Outerを書かないJoinは嫌い！ ## 昔はまった。
私も質問者さん同様、中間ファイルを作成してから・・と思っていましたが、 Windows Vista および Windows 7 で Access 97 ファイル形式のデータベースを Access 2007 または Access 2010 ファイル形式に変換できないことがある http://support.microsoft.com/kb/942394/ja ↑のようにすれば一発変換ができました。 以下、手順。 （当方Windows7 64bit & Access2010 32bit 環境です。適宜、読み替えてください。） （検証したファイルは唯一残っていたNorthWind.mdb です。） Windowsのスタートボタンを押し、「Microsoft Access 2010 」を右クリック、 プロパティを選択し、互換性タブを選択、 「互換モードでこのプログラムを実行する」にチェックを入れ、 直下のプルダウンメニューから、「Windows XP(Service Pack 2)」を選択、 OKを押して閉じます。 Accessを今まで通り立ち上げて新規ファイルを作成します。 リボンの外部データタブから、Access を選択してウィザードに従って 全てのオブジェクト（テーブルやクエリ、フォームなど）を選択してインポートします。 途中でエラーが発生するかもしれませんが最後まで進めます。 そのまま修正作業に入りたいところですがぐっとこらえてAccessを終了し、 前述の互換モードのチェックを外します。 Accessを立ち上げて必要に応じてインポートしたファイルの細々とした修正作業を行います。 （ここからが大変かもしれません。） なお、 Windows 7 上の Office 製品を Windows XP SP3 互換モードで実行し VBEditor を開くと、マクロの全角文字の一部が削除されコンパイル エラーが発生する http://support.microsoft.com/kb/2297924/ja というバグがありますので、互換モードはSP2を選択が無難です。 また、互換モード中であれば直接97形式のmdbを開く事も出来ました。 開く際に変換するかそのまま開くかの選択肢が現れます。
mdbの制限は調べられましたか？ http://support.microsoft.com/kb/965659/ja
「Access コンボボックス 絞り込み」をキーワードで検索するとたくさん見つかりますよ。 例えば、 コンボボックスの絞込み http://hamachan.info/access/sibori.html
CASE式で書くならば、 CASE WHEN A.c - A.d > 0 THEN A.c - A.d ELSE 0 END AS sa ですね。
　DATETIMEに日付以外の物を入れるとエラーになります。 　でも、これを担保してくれるだけの型でもないですよ。 　少なくとも、私は、2001年12月5日-2001年10月７日は、何日間ですか？なんて計算の為のアルゴリズムをいちいち作りたくはありませんから。 　これだけでも、汎用性のあるちゃんとしたルーチン作るの大変なんですよ。 　ましてや、ある基準日から、２００日後この日付は何日ですか？とか、1999年5月7日10:50の５０００分後はいつですか？なんて質問に答えるルーチンを作るのも嫌ですし、２０１０年６月１０日は何曜日ですか？というのはもっと嫌ですね。 　日付型をちゃんと使えば、ほとんど何も考えずに、上記の質問の全てに答えられます。 　この日付・時刻というやからは、おそらく、あらゆる単位系の中で、一番嫌らしい・ややこしい単位系じゃないかしら。考えてみれば、アナログ時計を読むのも結構難しいことやってますものね。まぁ、もう慣れてるから本能で出来ますけど・・・・（今、小さな娘に時計の読み方を教えるのに四苦八苦しているもので（笑））
> 文法は間違っていないとは思うのですが・・・ syntax errorは構文エラーという意味です。 残念ながら文法が間違っています。 http://www.sqlite.org/lang_update.html #1で指摘されていますが、 上記のマニュアルを見ると「テーブル名.項目名」という書き方はできないことがわかります。
dradra33さんはじめまして 結論から言いますと ストアドプロシージャは作成されていますし 実行されているはずです。 ただ内容がSELECT文なので ストアドプロシージャはデータベースから SELECT文の結果を取得して、パソコンメモリ上のどこかに 格納したはずです。でも、それだけです。 その結果をdradra33さんの目で確認するには別の命令が必要になります。 なぜそうなるか、説明しますと、プログラムは最終的な結果だけが重要で その途中経過をいちいち表示するとうざいからです。 (SELECT文をGUIで実行すると表示されるのはそれが最終目的だからです。) ストアドプロシージャの実行を確認するだけなら　INSERTかDELETE文なんかをお勧めします。 途中で消えるのはよくわかりませんね キー操作ミスじゃないんですかね。 別のGUIをつかってみては MySQLWorkbenchとか
>最終更新日 SHOW TABLE STATUSすればUpdate_timeで更新日時を得ることができます ただしエンジンによるのでMyISAMはけますがInnoDBは無理みたいです また、遅延書き込みなどあるので厳密な更新時間は得られないと思います 参考URL：http://dev.mysql.com/doc/refman/5.1/ja/show-tabl …
パッと思いつくのは下記の2つほどですね。 a. 相関サブクエリを使う方法 SELECT * FROM master m WHERE ( SELECT COUNT(DISTINCT hakko) FROM data d WHERE m.kata = d.kata AND m.kyaku = d.kyaku AND hakko IN (201303, 201305) ) >= 2 WHERE句では、一つ一つの master レコードについて、 kata と kyaku が同じで hakko が 201303 か 201305 の data レコードを取り出し、その hakko の値が2種類以上有るかどうか調べています。DISTINCT が付いているのは hakko に同じ値が複数有っても1つと数えるためです。 b. 結合してHAVING句で判定する方法 SELECT m.kata, m.kyaku, m.code FROM master m join data d on m.kata = d.kata and m.kyaku = d.kyaku GROUP BY m.kata, m.kyaku, m.code HAVING SUM(CASE hakko WHEN 201303 THEN 1 ELSE 0 END) >= 1 AND SUM(CASE hakko WHEN 201305 THEN 1 ELSE 0 END) >= 1 master と data を結合したものを master の項目でグループ化し、HAVING句で hakko が 201303 のものと 201305 のものが存在するか判定しています。 性能的には、どちらも今一つかも知れません・・・。 MySQL version 5.5.8 で確認しました。 http://codezine.jp/article/detail/907 http://codezine.jp/article/detail/405?p=2
ケースバイケースですね。 リアルタイムの順位を求めるなら、DBから条件に沿った並べ替えを行ったデータを取得してPHPで処理してやればいいと思います。 週間ランキングのように決まった日に集計を行ってその結果を表示したいのなら、cron等で定期的に集計バッチを実行して集計結果をランキングテーブル等に保存し、その集計結果を表示するといったやり方の方がいいと思います。
こんにちわ。 > そもそも2台だけで構築は可能なものでしょうか？ 確かにRAC を構築するのであれば、共有ディスクが必要になります。 でもVMware とかを使えば、1台でもRAC の構築は可能ですょ。 物理マシンは1台なので、当然可用性はありませんが、動作検証などで 使用するには十分です。 手順については、この辺を見て下さい。 http://otndnld.oracle.co.jp/products/database/or … http://sakusakuit.blog.fc2.com/blog-entry-96.html http://www.doppo1.net/oracle/admin/rac_install_1 … > (2)のShared File System（共有ファイルシステム）とは、NFSといった話でしょうか？ NFS とは違います。 NFS の場合、複数のマシンから同じファイルを一貫性を保って更新する事が できないため、RAC のStorage として使用する事はできません。
たぶんこんな感じを期待しているのだとおもうけど かならずnameがユニークだとは限らないためnameで判断するのは微妙 SELECT count(DISTINCT a.name) as a_count ,count(DISTINCT b.name) as b_count ,count(DISTINCT c.name) as c_count FROM d LEFT JOIN a ON a.id = d.id LEFT JOIN b ON b.id = d.id LEFT JOIN c ON c.id = d.id WHERE d.id = 1
クエリを投げる前にとまっているなら コネクトかセレクトDBをうたがってみては？ $cn = mysql_connect("192.168.*.***", "user", "password") or die(mysql_error()); mysql_select_db("mydatabase",$cn) or die(mysql_error());
5.6の運用はしていないのでテストしていませんが普通auto_incrementのクリアは ALTER TABLE testtb AUTO_INCREMENT = 1 で、よくないですか？
select 職員番号, 氏名, レベル, 点数 from aaaa a0 where 点数 is not null and レベル <= 4 and a0.レベル=(select max(a1.レベル) from aaaa a1 where a1.職員番号 = a0.職員番号 and 点数 is not null and レベル<=4) and a0.点数 = (select max(a2.点数) from aaaa a2 　　　　　　　　　　where a0.職員番号 = a2.職員番号 and　 　　　　　　　 　　　a0.レベル = a2.レベル) order by 職員番号 　ウィンドウ構文を使わずにやろうとすると、こんな感じでしょうか。 　なお、もし、（職員番号，レベル）の組に重複がないのであれば、where区内の２つめのselect文を含む条件( a0.点数=で始まる比較）は不要です。（ちなみに、一応実験は、01100でレベル４で得点5点を追加して行っています。） 　また、常識的に、職員番号が同じで氏名が違うなんてことはあり得ないとしていますが、もしこれを考慮に入れ別人として扱う必要があるなら、その条件は追加が必要です。
[参加県TB] テーブルに存在しない '東北' の県レコードを [都道府県TB] から削除するってこと？ [参加県TB] の [県ID] が主キーなどユニークである必要がありますが、クエリ ウィザードの不一致クエリ ウィザードで作成されたものを DELETE に作り変え、AND で ((都道府県TB.地域名)="東北") を WHERE に付け加えるだけ。 DELETE 都道府県TB.* FROM 都道府県TB LEFT JOIN 参加県TB ON 都道府県TB.[県ID] = 参加県TB.[県ID] WHERE (((参加県TB.県ID) Is Null) AND ((都道府県TB.地域名)="東北"));
>プライマリーキーがあれば、検索は高速になるのでしょか? プライマリキーはそのレコードを特定するためのカラムなので 他のカラムと連動してインデックスを貼るのは向いていません ユーザー管理テーブルをユーザーID,ユーザー名をとるのであれば ユーザーIDにはプライマリではなくユニーク属性をつけて、 ユーザーIDとユーザー名を合わせたインデックスを貼るほうが効果的です また参照だけで集計がないような更新頻度の少ないテーブルであれば、 トランザクションの必要がないので、データエンジンをMyISAMなどにして 高速化をはかるなど工夫できます
こんにちわ。 > 本来ならここでプライベート（これって仮想IPのことですよね？） 違います。 ざっくり言うと、こんな感じです。 Public IP : アプリケーションからアクセスする時に使用するIP 　　　　　　 Node 毎に1つ必要で、Node が停止してもFailover しない Private IP : RAC がNode 間通信で使用するIP 仮想 IP : 基本的にPublic IP 　　　　　　 Node 毎に1つ必要で、Node が停止すると別Node にFailover する。 　　　　　　 → VIP はGrid が管理して動的にNode に割当てるので、 　　　　　　　　ping が通る (どこかのマシンに割当てられている) のはダメです。 更に11.2 からはSCAN IP と言うのがあって、1つのホスト名で3つのIP Address を ラウンドロビンで引けるようにしておきます。 SCAN IP はRAC を構成する何れかのNode に割当てられており、Node が停止すれば 自動でFailover します。 これで、アプリケーションがSCAN IP で接続するようになっていれば、RAC の Node 追加/Node 削除があっても設定を変更する必要がなくなっています。
　auto_incremnt属性の付いたカラムの基本的な性質のため、普通は０を使えません。 　というのも、auto_increment属性のカラムは、そのカラムに、０かnullをインサートしようとした時に、自動採番した数値をカラムに代入するからです。 　カラムの値に０を許すと、自動採番の引き金になる０なのか、数値としての０なのかをMySQLが判断することが出来なくなります。 　ＳＱＬモード変数で、NO_AUTO_VALUE_ON_ZEROモードを有効にすると、この挙動が少しだけ変わり、nullをインサートしようとした時のみ自動採番するようになります。この場合は、０もデータとして利用できるようになります。 　が・・・・ 　そもそも、この質問が出る時点で、auto_incrementの使い方が間違った方向に行ってる気配を感じます。 　auto_incrementは、値の数字そのものには全く興味が無いがとりあえず、重複しない値が欲しいという時に使います。自動採番された数字は、連続しているとは「限らない」し、採番する時まで、どんな値になるかも不明です。 　例えば、ある決まった値から、連続したシーケンス番号を発行したい・・・と言う時には、使ってはいけません。欠番が発生する可能性があるからです。例えば、トランザクションＡとＢが同時に実行され、Ａがインサートした後で、Ｂがインサートを行い、その後、Ａがロールバックされたら、Ａの為に発行された数字は、欠番となります。 　この連続が不可欠の例としては、伝票番号があげられます。もし欠番が見つかったら、それは、伝票が行方不明になったという意味であり、監査の時に大騒ぎになります。 　このように、値そのもの（または、値と値の関係）に興味がある場合には、そもそもauto_incrementは使うべきではないとされています。ちゃんと自分で決められた条件を満たすロジックを作成して発行するべきです。 　０がないのが不満だと思った時点で、値の絶対値そのものに興味があると言うことですよね。大概これは、危険な兆候です。
もし本当に >SELECT * としているのであれば、必要カラムを明示的に列記すべき 今回の件であればtie_upテーブルを二重にjoinしていますので名称が競合していませんか？
> #1066 - Not unique table/alias: 'tie_up'と > エラーメッセージが表示されました。 uniqueという英単語の意味が分からなければ英和辞書を参照。 http://eow.alc.co.jp/search?q=unique 今回，tie_upというのは別名(alias)ではなく実表名(table)だったわけですが， > left JOIN tie_up ON song.tie_up_1_ID = tie_up.tie_up_ID) > left JOIN tie_up ON song.tie_up_2_ID = tie_up.tie_up_ID; と同一表を２度 用いたいのであれば，tie_up.tie_up_ID と言われてもそのtie_up表というのは not unique table だから，１度目に登場するtie_up表なのか，２度目に登場するtie_up表なのか，列別名を与えて区別してくれ，と言っているわけです。
＞32bitと64bitの両方がサポートされたSQLEXPR_JPN.EXE これは32 ビットと 64 ビット (WOW インストール) 64ビットネイティブはSQLEXPR_x64
>String sql = "select sum(oni) from テーブル名 where ken = '" + ken + "'"; これはoniというカラムを別途参照しているときにエラーがでているのでしょうか？ もしそうであれば String sql = "select sum(oni) as oni from テーブル名 where ken = '" + ken + "'"; などのクエリを投げてみてはどうでしょうか？ そうではなくSQL文をなげた時点でエラーがでているなら、やはりoniというカラムが ないと判断せざるを得ないですが・・・
外部キーが指定してあっても、 実際、SQLで取得する際には、2つのテーブルを結合する必要がありますので、 SELECT `song`.`song_ID`, `song`.`song_name`, `kashu`.`kashu` FROM `song` JOIN `kashu` ON `song`.`kashu_id` = `kashu`.`kashu_id` WHERE `song`.`song_name` LIKE '%%' こちらのような、SQLになるかと思います。
byteで作れると思います。 create table テーブル1 (年 smallint , 月 byte);
>yumでインストールできるような事を書いているのもありましたが、 >yum list 上にpgadmin3は見当たりません。 epelのリポジトリにあるみたいですが。 epelのリポジトリを追加する方法は…まぁ、難しくないですから検索して調べてみて下さいな。 # epelだけで依存関係がクリアできるかどうかは…試していないので不明ですが。 # CentOS5.xでやっている例だとrpmfusionのリポジトリも追加しているところもありますし。
> (1)二つのテーブルの両方に存在するカラムの比較が全くなくても、式自体が > 成り立っていたらOKという事ですか？ > > それとも、 > > (2)最低１つは、（２つのテーブルに存在するカラムの比較）が必要で、 > それ以外はand等で、条件式として成り立つものならなんでもOKという意味ですか？ 実際に実行してみましたか？ 　SELECT * 　FROM Table_A LEFT JOIN Table_B ON 1 = 1 といった書き方も可能ですから、(1)が正解です。
>複数の属性 表現がよくわからないのですが ここでいう属性とは所定の「フィールド」を指すのでしょうか？ また例示された「あ～お」にあたるものもフィールドだということでしょうか？
謎のおまじない http://www.atmarkit.co.jp/bbs/phpBB/viewtopic.ph … http://ameblo.jp/gurizou/entry-11287297746.html
レプリケーションの状態を確認するためには、 マスタのDBに接続し、 SELECT * FROM pg_stat_replication; のSQLを実行すると、マスタのレプリケーション状態の確認ができます。 その際、stateがstreamingをとっていれば、正常にレプリケーションができていると考えられます。 また、PostgreSQLのデフォルトのログ位置は、 /var/log/postgresql になるようですので、 マスタ、スレーブ両DBのログを確認いただくと、 エラー内容が分かるかと思います。 http://www.postgresql.org/docs/9.1/static/runtim … おそらく上記のどこかでエラーが確認できるかと思いますので、 エラーログにしたがって対処するのがよいかと思います。
運用方法を厳密にどうしたいかによりますね 基本的にはプライマリキーはインデックスに含めないのが好ましいので a_idをプライマリとせずに、別途auto_incrementのプライマリキーを設定してみては？ つまりa_idを含むインデックスをつくるべきだということです。 （a_idが含まれない場合はrangeですが、含まれればtype=indexを得られます） create table a_mst(pid int not null primary key auto_increment,a_id int not null unique key,a_name varchar(30),a_price int,a_print_flg tinyint); alter table a_mst add index (a_id ,a_price,a_print_flg); insert into a_mst(a_id,a_name,a_price,a_print_flg) values(1,'a1',200,0),(2,'a2',150,0),(3,'a3',100,0),(4,'a4',250,0),(5,'a5',50,0),(6,'a6',150,1),(7,'a7',50,1); //データ抽出 EXPLAIN SELECT a_id,a_price,a_print_flg,b_data FROM a_mst INNER JOIN b_mst ON a_id=b_id WHERE a_price >= 100 AND a_price <= 200 AND a_print_flg = 0; また、a_nameが集計のキーにならないなら、a_idとの間に別途インデックスを作成して 自分自身を結合するか、別テーブルに正規化してしまうことです。 alter table a_mst add index (a_id ,a_name); EXPLAIN SELECT a1.a_id,a2.a_name,a1.a_price,a1.a_print_flg,b_data FROM a_mst as a1 INNER JOIN a_mst as a2 ON a1.a_id=a2.a_id INNER JOIN b_mst ON a1.a_id=b_id WHERE a1.a_price >= 100 AND a1.a_price <= 200 AND a1.a_print_flg = 0; ※どうしてもテーブルをわけたくないなら、出力項目全てに対してインデックスを 貼る必要がでてくるかもしれません。しかしあまり大量のインデックスを貼ると オーバーヘッドが大きく、スピードアップできないかもしれません
相関サブクエリは遅くなりがちです。 F1グループ化、F2最大の集計クエリを作成する。 これと元のテーブルと内部結合した集計クエリで、F1, F2 グループ化、F3最大 というようにクエリを２段にすればいいでしょう。 サブクエリを使えば、一つのクエリにできます。 SELECT F1, F2, MAX(テーブルA.F3) AS F3 FROM テーブルA INNER JOIN (SELECT F1, MAX(F2) AS MaxF2 FROM テーブルA GROUP BY F1) Q ON テーブルA.F1=Q.F1 And テーブルA.F2=Q.MaxF2 GROUP BY F1,F2;
select 生年月日.ID,生年月日,基準日, cast(substr(基準日,1,4) as int)-cast(substr(生年月日,1,4) as int) -case when substr(基準日,5,4)<substr(生年月日,5,4) then 1 else 0 end as 年齢 from 生年月日,基準日 です。
> 実際にid15の順位を取得しようとするとエラーが出てだめでしたorz > FROM WHERE id=15 vote a FROM句とWHERE句が混ざってますよ。 ↓では？ FROM vote a WHERE id=15
各テーブルの関連が不明なのですが、こんな感じのことでしょうか。 select T.*, N.SIME from TOKUTEN T inner join KIHON K on (K.SYKNCODE = T.SYOKUINCD) inner join NAME N on (N.SYOKUINID = K.SYOKUINID and T.HYOKIKAN_FR between N.TKYSTADATE and N.TKYENDDATE); NAMEテーブルにレコードがないTOKUTENテーブルのレコードも取得したいなら、LEFT JOINに変えてください。
厳密に測定すれば、2つしかカラムのないテーブルの方が、10カラムのテーブルよりも高速です。 たとえ、残り8カラムのデータすべてがNULLでもRDBMSでのテーブルスキーマの管理コストが余計にかかるためです。 しかし、ほとんどの場合、その他の要因のほうがパフォーマンスに影響を与えると考えられます。無用にテーブルを分割しても結合コストのほうが大きい場面のほうが多いと思います。 ちなみに、RDBではなければよく使うカラムが限られるような局面が多い事に注目して実装化されたのが「カラムベース・データベース」です。 この考え方は最近のMS SQL Serverなどでも取り入れられており、注目する必要があるかもしれません。
CLIENT_ENCODING を指定して PostgreSQL 側で自動文字コード変換させれば良いのでは？ Perlスクリプト側や個々のSQLで文字コード変換をするより楽かと。 例) ------------------------------------------ $query = 'SELECT KEN_ID, KEN_NAME FROM KEN_MASTER'; # ↑個々のSQLに変換処理は必要なし。 $dbi = DBI->connect(・・・ $dbi->do("SET CLIENT_ENCODING TO 'EUC_JP';"); # ← この行を追加 $dsi = $dbi->prepare($query); $dsi->execute(); ---------------------------------------------- http://www.postgresql.jp/document/9.1/html/multi … http://www.postgresql.jp/document/9.1/html/runti …
＞XAMPPでｍｙｓｑｌ これはphpMyAdminでデータ確認をしたときの文字化けでしょうか？ テーブルやカラムの照合順序は「utf8_unicode_ci」など 適切なものが設定されていますか？
MySQLでDB EngineがINNODBの場合基本として主キーでクラスタ化されて配置されます。主キーを宣言しない場合はMySQLが暗黙の主キーを人工的に設定し、データ配置を行います。 そのため、更新削除がなければ、概ね挿入順にデータを取得することになります。 ですので現在の実装であれば SELECT * FROM ．．． LIMIT 1; で最初に挿入した行を取得できる可能性があります。 しかし、これは実装依存ですし、MySQLの仕様として保証されるものではありません。 将来的に1クエリを並行に実行するようなものになった場合、異なる結果が返されるかもしれません。 「いつも同じ並び順で表示される」ことを基準にするなら、今のうちに「AUTO_INCREMNT」属性の主キーを持ったテーブルを作りINSERTすべきと考えます。 これなら ORDER BY 主キー LIMIT 1; で一番古いレコードを取得出来ます。
SQLの仕様上抜き出される順番はOrder　Byのみにより決定されます。５と１と３のみでその順番に抜き出したいのであれば「order by case id when 5 then 1 when 1 then 2 when 3 then 3 else 4 end」等で対応する以外無いです。
XAMPP 新バージョン 1.8.1の内容 Apache 2.4.3 MySQL 5.5.27 PHP 5.4.7 phpMyAdmin 3.5.2.2 FileZilla FTP Server 0.9.41 Tomcat 7.0.30 (with mod_proxy_ajp as connector) Strawberry Perl 5.16.1.1 Portable XAMPP Control Panel 3.1.0 (from hackattack142) http://www.apachefriends.org/jp/xampp-windows.html とありますように Apache 2.4.3や MySQL 5.5.27も 入っている ワンセットになっているのが、 XAMPPです。 正常に作動しなくなりますので ポート80の番号は、変更しないで下さいとの 注意書きは、読みませんでしたか？ 先ず、ApacheもXAMPPも アンインストールして 再度インストールして下さい。 XAMPPのダウンロード先 外国人女性の写真の下より 下に進みますと XAMPP for Windows 1.8.1, 30.9.2012 Version XAMPP Windows 1.8.1 と青い細い帯が、あります。 こちらからダウンロードして下さい。 http://www.apachefriends.org/en/xampp-windows.html ZIP 後ほどファイルを修正しなければいけませんので 圧縮でダウンロードして下さい。 重要 Cドライブ直下にディレクトリxampp（必ず小文字で名前を付ける）を作りまして そのままインストールして下さい。 ※ディレクトリとは、Excelでいうフォルダの事を プログラミング言語でそう呼びます。 もしよろしけけば 解凍レンジ をお使い下さい。 外部DLLファイルを必要としない解凍、復元専用ツール です。解凍せずに中身を表示し、個別ファイルのドラッグアンドドロップでの取り出しにも 対応しています。 電子レンジの画像のアプリです。 その下の緑のダウンロード をクリックして下さい。 http://freesoft-100.com/review/range.php APACHE FRIENDS が、APACHEやXAMPPを 配布しています。 ダウンロード元 www.apachefriends.org インストール後、デフォルトでは、 C:\Program Files\xampp\htdocs がXAMPPのDocumentRootとなります。 ★重要★ PHP文字化けを解消する方法 XAMPPの php.iniを修正しなければいけません。 (1)事前にデスクトップにテキストエディタの ショートカットを置きます。 用意されていない場合は、 テキストエディタをインストールする (2)・コンピューターの ローカルディスクCを開く ・ XAMPPのディレクトリを開く ・ php.iniをテキストエディタの上に乗せて 開く（メモ帳で開いてはプログラム修正できませんのでいけません。） (3)必ず php.iniファイルの内容をコピーする 間違うと取り返しが、つかなくて インストールし直しになります。 うまくインストール出来ない場合が、 ありますので要注意して下さい。 以下は、Apacheの旧バージョンでも同様です。 ○×行目の違いです。 (4)Apache最新版では、 ★default_charset="UTF-8" 先頭の；セミコロンか#シャープを削除 814行目付近にありますので探して下さい。 ★mbstring.Language=Japanese 先頭の；セミコロンか#シャープを削除 1860行目付近にありますので探して下さい。 ★mbstring.internal_encoding=EUC-JP なども文字コードを mbstring.internal_encoding=UTF-8 に変更します。 先頭の；セミコロンか#シャープを削除 1866行目付近にありますので探して下さい。 最後に ★タイムゾーンの設定をします。 日本に住んでいるので date.timezone=Asia/Tokyo 先頭の；セミコロンか#シャープを削除 1044行目付近にありますので探して下さ い。 変更をファイルの上書き保存をして 完了です。 他にMysqlの一部のファイルも 修正する箇所が、ありますが、 コマンドプロンプトの状況を 見ながらとなりますので 次回にします。 また、不明な点が、ございましたら いつでも私に質問して下さい。 回答いたします。
こんにちわ。 ブロック破損ですか。 Oracle の場合、DBMS_REPAIR Package を使用する事で、破損ブロックを除外して データにアクセスさせる事ができます。 詳細は、この辺のマニュアルを確認して下さい。 http://otndnld.oracle.co.jp/document/products/or … Oracle のバージョンによって、使い方も変わってくる可能性がありますので、 バージョン毎のマニュアルを必ずご確認下さい。 http://www.oracle.com/technetwork/jp/indexes/doc … 大まかな手順としては、こんな感じです。 1) DBMS_REPAIR.ADMIN_TABLES で、障害状況補足用テーブル (REPAIR_TABLE, ORPHAN_KEY_TABLE) の作成 2) DBMS_REPAIR.CHECK_OBJECT で、破損オブジェクトの確認 　 → 破損オブジェクトが索引であれば、Drop&Create で復旧 3) DBMS_REPAIR.FIX_CORRUPT_BLOCKS で破損ブロックをマーク 4) DBMS_REPAIR.DUMP_ORPHAN_KEYS で破損データブロック関連の索引エントリの確認 5) DBMS_REPAIR.SKIP_CORRUPT_BLOCKS で破損ブロックのスキップ指定 6) 破損ブロックのSKIP して、exp, expdp 等で外部に退避 参考URL：http://www.oracle.com/technetwork/jp/indexes/doc …
かなり強引ですがこんな感じ？ //元データ create table hoge (id int,name varchar(20)); insert hoge values(1,'apple'),(1,'banana'),(2,'onion'),(2,'potato'),(2,'carrot'),(2,'radish'),(3,'beef'),(3,'chicken'),(3,'pork'); //集計 select id ,concat(group_concat(name) ,repeat(',NULL',(select max(c) from (select id,count(name) as c from hoge group by id) as sub)-count(name))) as name from hoge group by id; そもそも「NULL」を文字列として使用していいのか怪しいところ また例題のNULLの後ろにカンマがあったりなかったりブレがあるのが気になる ロジック的には、nameの最大件数を拾って、自分の件数との差だけ「,NULL」という 文字をつなげる・・・みたいなかんじ、 ただし思いつきを冗長にかいただけなのでもっと有効な方法があると思います
select 項目 from テーブル where 'ABCDEF' like '%' || 項目 || '%'; regexp_likeを使うなら、 select 項目 from テーブル where regexp_like('ABCDEF', 項目); とかではどうでしょうか。 インデックスが使われないのでパフォーマンスに問題があるとは思いますけど。
.>　一応自分でも調べててWHERE句では結合よりも先に条件を記載する方が良いとか書いてました。 >　あと、IN演算子がちょっと問題な演算子ということが。 結合処理については、駆動表の絞り込みが出来るのならそこで件数を絞り込みを行うのは有効です。 しかし、絞り込みでそんなに件数が減らない場合、駆動表・内部表ともにWHERE条件を先に適用させるSQLは結合にINDEXが使えないので逆に遅くなる可能性があります。 ここらあたりはテーブル構造やデータの状況にもよるので一般論はありません。 IN句は意味的にOR条件と等値です。後はRDBMSの実装しだいですが、場合によってせっかくINDEXが使えるような場面でも、IN句の場合全表検索を選択する傾向があるのも事実です。 > WHERE　ＡＡＡ　ＩＮ　（'122','244','366'） のような場合、オプティマイザがどのような実行計画を選択するかは場面によって違うと思いますが、テクニックとしては ( SELECT '122' UNION ALL SELECT '244' UNION ALL SELECT '366' ) AS Q のような副問合せ（インラインビュー）を作り、結合処理に変換することでパフォーマンスが上がる場合もあります（AAAにINDEXがある場合） > GROUP BY ＡＡ．Ａ１ HAVING COUNT(*) >= 0 > といった処理も重くしてしまうのでしょうか？ すみません、この条件の意味がよく分かりません。 「GROUP BY ＡＡ．Ａ１」で「COUNT(*)」が返す値はゼロ以上以外にあるのでしょうか？ （「COUNT(*)>0」ならまだ分かりますが、この場合はEXITS述語を使ったほうがパフォーマンス的に有利な気がします。） この欄だけではSQL全般のセオリーは書ききれません。 http://books.shoeisha.co.jp/book/b104811.html を是非読んでください。
dcount("日付","テーブルA","日付 in(select 日付 from テーブルB") とか？
where以降意味がわからないので割愛して、 とりあえず普通にjoinするやりかたはこう select * from timeTpl as t left join booked as b on b.date ='2013-06-05' and ( t.start >= b.startTime and t.start < b.finishTime or t.finish > b.startTime and t.finish <= b.finishTime)
CSVをMySQLに流し込むだけ また、お勧めはしませんが場合によってはMySQLはCSVデータをエンジンに利用できます MySQLにおける検索の仕方などはMySQLの書籍やWEBサイトで 学習してください
> 但し、私はWHEREの所で、今日のデータの中の重複データを削除されるつもり > でいたのですが、今日以前の物も全て削除されてしまいました。 > 構文に誤りがあるのでしょうか。 構文に誤りはありません。構文通りに削除されただけです。 ＊WHERE句とGROUP BY句は、なんか引っかかってたのですが気付きませんでした。 副問い合わせの部分で、今日(SYSDATE)の重複しているデーターのID最少値を取得しています。 DELETEでは、そのID以外をすべて削除、ですので、日付などは関係なく削除されます。 今日のみというのであれば、DELETE文にもWHERE句で日付の指定を入れてください。 DELETE FROM D入庫データ WHERE ID NOT IN ( SELECT MIN(ID) FROM D入庫データ WHERE TO_CHAR(SYSDATE, 'yyyy/mm/dd') = TO_CHAR(登録日時, 'yyyy/mm/dd') GROUP BY PRID, 台車番号, 入庫数量, ロット番号, TO_CHAR(登録日時, 'yyyy,mm,dd') ) AND TO_CHAR(SYSDATE, 'yyyy/mm/dd') = TO_CHAR(登録日時, 'yyyy/mm/dd') ; ---- NOT EXISTS句を利用した方がパフォーマンスが良くなるかもしれませんが詳しくは調べてください。
＞値を1レコードに詰め込む必要があり30個近く １レコードについて多少カラムが多くてもさほど問題はないでしょう ただ、データの蓄積がすすみテーブルが肥大化したときには シークに時間がかかったりするかも 集計やデータ抽出がメインであればインデックスをきちんと貼っておけば スピードは確保できると思います。
MySQLの戻り値としては当初の表示データのモノがのぞましく 受け取ったプログラム側でテーブルに表示しなおす方がよいと思います どうしてもデータをMySQL側で処理したい場合は group_concatで処理することになると思います
こんにちわ。 > 非同期I/Oが有効なら、I/Oスレーブが使用されるのではないでしょうか？ http://docs.oracle.com/cd/E16338_01/backup.112/b … この辺が参考になるかと思います。 http://docs.oracle.com/cd/E16338_01/server.112/b … http://docs.oracle.com/cd/E16338_01/server.112/b … RMAN に限った話ではありませんが、非同期I/O がサポートされていない時に、 I/O を高速化するためにSLAVE 数をDBWR_IO_SLAVES に指定するようですね。 参考URL：http://docs.oracle.com/cd/E16338_01/backup.112/b …
＞今回の私の質問にある、伝票番号毎の合計（入金も含む）を集計する 私の認識が間違っていたら申し訳ないですが それって私の書いた「集計」のSQLだと思うのですがちがいます？
freの受け渡しを配列処理でできれば構文は簡素化できます <input type="text" name="fre[]"> <input type="text" name="fre[]"> <input type="text" name="fre[]"> <?PHP $sql = "SELECT id FROM friend WHERE 1"; $str=""; $fre=isset($_POST["fre"])?$_POST["fre"]:false; foreach((array) $fre as $val){ if(!empty($val)){ //空データの場合処理しない $str.=$str===""?"AND name IN (":","; $str.=$val; } } if($str!="") $str.=")"; $sql.=$str; print_r($sql); ?> nameが完全一致ならlikeで検索する必要はありません
>like '%4%' のような前方後方一致はSQLの不得意分野で基本的にインデックスはきかないため、 なにをやっても高速化は期待できません 遅くても気にしないなら適当なセパレータを使って連結してからlikeを使えば 書式はすっきりします（さらにスピードはおちると思いますが・・・） select * from tb where concat_ws(char(0),bang,name,tuki) like '%4%; ただし、この場合もbang,name,tukiは文字列型のカラムでnullがないことが前提になります そうでない場合は例外処理をいくつかかます必要があるでしょう
パイプ(||)で文字連結をするには事前の設定が必要です。 http://db.just4fun.biz/MySQL/MySQL%E3%81%A7%E3%8 … 事前の設定なしで文字連結を実現できるという理由でconcat関数を使ったのではないでしょうか。
先ず、理論の組み立てが大切です。 (1)TBL_1からJUDGE=OKのものを抽出する。 (2)TBL_2からJUDGE=OKのものを抽出する。 (3)上記(1)と(2)をIDで結合する。 次にOracleのバージョンにより結合式の 書式が違います。 バージョンを明記しましょう。 最新と仮定すると、以下のようになります。 SELECT A.ID,A.JUDGE,B.DATE FROM (SELECT ID,JUDGE FROM TBL_1 WHERE JUDGE='OK') A INNER JOIN (SELECT ID,DATE FROM TBL_2 WHERE JUDGE='OK') B ON A.ID=B.ID 結合したクエリから条件を指定して抽出 するより、先に条件で絞り込んだクエリを 結合する方が件数が減っているので効率が 良くなります。まぁ、今時は機械も速いし、 件数が何十万でもなければ、どうやっても 見た目の変化はありませんが、昔はこういう ことをしないと、処理時間に大きな差がでた ものです。
ANO.3です。 後でみたところ、１行抜けてしまいました。 訂正というか、下の行を追加します。 ＞回線エラーなのでロールバックしようとすると、 ＞ロールバックする情報は自サーバで、ロールバックする先は、他サーバなのに ＞回線はつながらない といったことがおきないことを確認しておく必要があるはずです。 ＞・・・２フェーズコミットのサポートはしていたはずなので大丈夫だったと思いますけどね。
補足に気付かず遅くなりました、すみません。 コントロールの位置関係がよくわからないのですが、大雑把な流れは以下の様かと思います。 ※印のところが不明点です。 このサイトではTabインデントが使えないので全角スペースで代用しています。 Private Sub 予約ボタン_Click() On Error GoTo errH 　　Dim db As DAO.Database 　　Dim rs As DAO.Recordset 　　Dim WSP As Workspace 　　Dim reTryCount As Integer 　　Set db = CurrentDb 　　Set WSP = DBEngine.Workspaces(0) reTry: 　　'※Me!機材番号txtコントロール とこのコマンドボタンが同じフォームにあると仮定 　　Set rs = db.OpenRecordset("SELECT * FROM T_管理テーブル WHERE 機材番号='" & Me!機材番号txt & "'" _ 　　　　, dbOpenDynaset, dbPessimistic) 　　DBEngine.Idle dbRefreshCache 　　If rs.EOF And rs.BOF Then 　　　　MsgBox "該当する機材番号はありません", vbOKOnly 　　　　Me!機材番号txt.SetFocus ' 　　　　GoTo atoShimatu 　　End If 　　If rs!選択フラグ = True Then 　　　　MsgBox rs!機材番号 & "は既に他者に貸出中です。", vbExclamation, "入力依頼" 　　　　Me!機材番号txt.SetFocus 　　　　GoTo atoShimatu 　　End If 　　WSP.BeginTrans 'トランザクション処理開始 　　rs.Edit 'ここでロック開始 　　　　rs!選択フラグ = True '選んだことで選択フラグをセット 　　　　rs!担当者 = Forms!F_新規貸出フォーム!担当者 'メインフォームの予約担当者をセット 　　　　rs!予約日時 = Forms!F_新規貸出フォーム!年月日 'メインフォームの予約日をセット '　　　　　　　　・　（省略） '　　MsgBox "lock" '確認用です 　　rs.Update 'ロック解除される 　　WSP.CommitTrans dbForceOSFlush 'トランザクション処理終了 　　rs.Close 　　Set rs = db.OpenRecordset("T_TMPテーブル", dbOpenDynaset) '　　rs.AddNew '　　　　rs.機材番号= ・・・・（省略） '　　　　　　　　・（省略） '　　　　　　　　・ '　　　　rs.Update 'ここで　サブフォームのリクエリーを実施 'DoCmd.GoToControl "検索"　←　コントロールをメインフォームへ移動しようとしています。 '※↑コマンドボタンはサブフォームにおいてあるのかな？ 'DoCmd.Requery "機材詳細表示リスト" '※以下二行の説明がほしいです。PS.メインフォーム名とサブフォーム名も。 'DoCmd.Requery "予約済み機材表示" errH: 　　Select Case err.Number 　　　　Case 0 '正常処理の場合、何もしない 　　　　　　 　　　　Case 91 'rs の閉じエラー 　　　　　　err.Clear 　　　　　　Resume Next 　　　　Case 3218 '同時に複数から同じレコードに更新処理が掛かった場合 　　　　　　err.Clear 　　　　　　WSP.Rollback 　　　　　　MsgBox "他の人によって更新中です。", vbOKOnly 　　　　　　reTryCount = reTryCount + 1 　　　　　　 　　　　　　If reTryCount < 2 Then 　　　　　　　　Resume reTry 　　　　　　Else 　　　　　　　　MsgBox "データを更新できませんでした。" 　　　　　　End If 　　　　Case Else 　　　　　　Debug.Print err.Number, err.Description 　　　　　　MsgBox err.Number & vbCrLf & err.Description 　　End Select 　　 atoShimatu: 　　rs.Close: Set rs = Nothing 　　Set WSP = Nothing 　　db.Close: Set db = Nothing End Sub
お礼率27%では補足も厳しいか・・・・
こんにちわ。 > ODBC設定画面にて接続テストを実施すると、テスト環境への接続は > 問題なく成功しました。 > しかしながら、Accessを起動すると本番環境を参照しにいって > しまいますので、Access内に作成した本番環境へのリンクを一旦 > 削除し、テスト環境へのリンクを作成し直す必要があると思いますが、 > 如何でしょうか？ であれば、Access のプログラムが上で設定したODBC 接続を使っていない のではないでしょうか？ この辺の作りは、Access のアプリを作成された方に確認して見て下さい。
　ＭｙＳＱＬは、さまざまなＯＳにインストールできます。 　ついでに、ＭｙＳＱＬに接続する方法も、実に様々な方法があります。 　というわけで、情報があまりにも不足していて、回答のしようが無いのが本音なんですが・・・ 　まぁ、とりあえず、windowsの何かにインストールして、PHPMyAdminで接続しようとしていると仮定して。 　最初は、つながっていたというのなら、サービスが起動しているかどうか確認してください。 　コントロールパネルの管理ツールの中にあるサービスで（windows　ＸＰ以降ならここにあるはず。これ以前なら、忘れました=^・・;=）、インストールされているサービスが全て列挙されますから、まず、MySQLが登録されているか、起動しているかどうか確認してください。 　もし、ステータスが、停止（起動の字がない。）なら、起動してあげてください。ツールバーからでも、右クリック→プロパティーで出てくるダイアログからでもかまいません。 　ついでに、自動起動をセットしておくとなお良いですね。同じダイアログから設定できます。 　さて、仮定が間違っているなら、質問事項がいくつか。 　１．インストールしたＯＳとバージョン 　２．ＭｙＳＱＬのディストリビューションの種類（どこから、何をダウンロードしましたか？） 　３．インストールの方法。 　４．ＭｙＳＱＬにはどうやって接続しようとしていますか？ 　（５．エラーメッセージは、何に出てきたのですか？まさか、何もないところにいきなりダイアログがでたわけじゃないですよね？） 　以上が補足されれば、きっと回答が出ると思います。
ｍａｘがいいでしょう。 処理時間に問題があればINDEXをつければ瞬時に出てきます。
こんにちわ。 > 制御ファイルを別ホストのrmanのカタログなり制御ファイルに登録する > 必要があるかと思うのですが、それはどうやってやればいいのでしょうか。 http://docs.oracle.com/cd/E16338_01/server.112/b … 制御ファイルには、上記マニュアルにある通りデータベース物理構造が 格納されていますが、ホスト名等情報は特に格納されていませんので、 マニュアルにある通りの方法で良いかと思います。 それとも、マニュアルにある通りの方法で操作して、何らかのエラーが出ている のであれば、エラーの内容を記載して下さい。 参考URL：http://docs.oracle.com/cd/E16338_01/server.112/b …
>３．userのデータが複数あっても、取得するのは新しいものから3件のみ まで考えるとidも比較しなくてはいけないかもしれないですね select * from テーブル as t1 where (select count(*) from テーブル as t2 where t1.user=t2.user and (t1.date<t2.date or t1.date=t2.date and t1.id<t2.id) ) <3 order by (select max(`date`) from テーブル as t3 where t1.user=t3.user) desc ,user ,`date` desc
そのような現象は出たことがないですけど データベース管理やレイアウトモードでそのフィールドがあったら 削除するとか。
FileMaker Pro　ネットワーク共有を使うのでしたら ファイル→共有設定→FileMaker ネットワーク をONにするだけですが、使わないのでしたら毎回出ます。
定義、使用すべてでバッククォート「`」で括れば使用は出来ます。 create table `create` ( dummy int ); ただし、お勧めはしません。ODBCなどで使う場合などがあると破綻するからです。
＞DB名、ID、パスワード、ホスト名、ポート番号、MySQLのバージョン5.0.90 ＞[Microsoft][ODBC SQL State: '08001' SQL Server エラー: 6 [Microsoft][ODBC SQL Server Driver][TCP/IPSockets]指定された SQL Server が見つかりません。 --- 先方から指定のあったMySQLと、質問者様がお使いのODBCドライバーに互換性がありません。 Microsoft SQL Server はマイクロソフトの製品であり、MySQL は現在はオラクルがライセンスを管理しています。 MySQL に接続するなら、MySQL のODBCドライバーを使用してください。 MySQL用のODBCドライバを入手する方法。 http://mysqlweb.net/s/article/61906902.html
ごめんなさい、単純にこれでいいかと・・・ UPDATE KOKYAKU_TABLE SET id = 9 WHERE id =0; UPDATE TYUMON_TABLE SET id = 9 WHERE id =0; UPDATE GAZOU_TABLE SET id = 9 WHERE id =0; JOINしてやりたいならまた書きますが、 無難にこれでいいと思います。 質問を読み間違えてたらすいません。
andとorで記述できます。 select * from table1 where @jouken = 0 and field1 = 1 or @jouken = 1 and (field1 = 1 or field2 = 1) or @jouken = 2 and (field1 = 1 or field2 = 1 or field3 = 1)
test_masterテーブルの「initial_kana」にINDEXはありますか？ なかったら付けてください。 後、インラインビューの「where test_id is not null」の必要性 が分かりません。 「test_id」にINDEXがあり、しかも内容がほとんどNULLならば、 この段階で絞込むこともあるかもしれませんが、そうでないなら、 FIND_IN_SET関数の判定と二重チェックになると思います。 selectp.product_id as product_id, am.id as id from test_master as am join product as p on am.initial_kana = 'あ' and FIND_IN_SET(am.id, p.test_id)<>0 group by am.id limit 20 offset 0 で試してみてください。
select * from テーブルA union select * from テーブルB order by あるカラム; で出来る思いますが、セレクトされるカラムがunionの前後で同じでなくてはいけませんので、テーブル構造に違いがあるのであれば　＊　ではなくカラム名を書き出してセレクトするカラムを指定してください。
>>・先駆者がいてそれじゃ不十分だから発展していったのか、 そうだと思います。 >>・そもそものＥＲ図の使用度。そんなに使う？の意味合いで いままでの開発経験では、一番良く使われる資料でした。 >>・使い分けされてるのか、→だとしてその使い分けは？どれが頻度高いのか ＥＲ図なんてエンドユーザは関係無いものです。自分たちが分かりやすく、使いやすいものが一番です。 些細な記述上の相違よりも、ＥＲ図を作るツールの値段や、使いやすさで決まることが多い気がします。 つまりは、「あれがベストだけど、手が出ないんだよ。で、次善策としてフりーのコレ」となったりします。
エラーは出てないということなのでしょうけど、動かない状況の詳細をもうちょっと欲しいところです。phpでのwarningすらも表示しない設定になってるような気がする。 でも、みなおすと、pdo の実行順というより、htmlの記述の方に問題有りそう。 </tr> と <tr> の間つまり行間で、文字列出力すると、最近のブラウザは、table の枠の外に表示したりして、どこに何が表示されてるか解らなくなります。場合によっては、出力されたhtmlソースをみて初めてwarning表示に気付く。 <table> 出力前に sql文を発行したなら、その直後で、 errorInfo チェックを行って下さい エラーがなければ、<table>用の文字列を出力していくようにします。 また、最後の閉じタグ</table> がないと、表は全く表示されなくなるブラウザも有りますのでこれも注意して下さい。 まずは、html文法で、どこにどの文字列をはさんでよいのか把握する方が先なのでは？ あと、ごく初歩的ですが、離れたところに記述してるせいで、途中で、$link 変数に別なデータを入れてしまったりなどもあるので、どの変数がどこで使われてるかなどもしっかり把握しておく必要があります。まあ、ちょっとしたタイプミスで意図せずそうなることもあるので、var_dump() でのチェックは有用です。
Date と Name が同一のレコードが複数在る場合や、同一のDateに a だけが存在して b, c が無い場合などはどういった値になれば良いのでしょうか？ 仮に Date と Name が同一のレコードが複数有る場合は最大の値、特定の Name の値が無い場合は null になるとすると、下記の様なSQLで取得できるでしょう。 SELECT Date, MAX(CASE WHEN Name = 'a' THEN Value ELSE NULL END) AS a, MAX(CASE WHEN Name = 'b' THEN Value ELSE NULL END) AS b, MAX(CASE WHEN Name = 'c' THEN Value ELSE NULL END) AS c FROM tbl GROUP BY Date; この様に CASE 式と集約関数を組み合わせは非常に便利です。 下記のページが参考になるでしょう。 http://codezine.jp/article/detail/404?p=2 http://codezine.jp/article/detail/751?p=1
パスワードを保存するときは、ハッシュ化（復元不可能な暗号化）をしなければなりません。 これはパスワード管理の基本中の基本です。 登録の時に、hash("sha256", $salt . $_POST["pass"]) とかで変換してDBに格納し、認証の時には入力された物を同じ関数でハッシュ化して、格納された値と一致したら認証OKとします。 $saltについては、「ハッシュ ソルト」とかで検索して勉強してください。 セキュリティは難しいように見えますが、基本がわかってしまえば楽です あと、sprintf + mysql_real_escape_string でSQL文を組み立てるのは古いやり方で、 これからプログラミングを学ぶのなら、やめましょう。 mysqliライブラリとかPDOライブラリとかの、prepare等を使ってください。
$name3 = mysql_query("SELECT name FROM hoge2 WHERE id != '".$id."' AND name = '".$name."'"); じゃないでしょうか。
まず、Ｏｒｅｃｌｅの場合、ほとんどがカスタマイズ可能なものです。自動で割り当てられるのほとんですが、作成時に指定、システムから自動に割り当て（変更化、不可あり＜＝システムの設定を変更）、作成後システムを停止後設定変更等があります。そのうえで下記のように検索しましょう http://www.google.co.jp/search?hl=ja&q=%22DBA_SE … から http://docs.oracle.com/cd/E16338_01/server.112/b … （オンラインヘルプですね） http://www.oracle.co.jp/forum/thread.jspa?thread … （あなたと類似の質問です） 上記を理解したうえで http://www.google.co.jp/search?hl=ja&q=%22DBA_SE … で検索すると、 http://docs.oracle.com/cd/E16338_01/server.112/b … （オンラインヘルプ） そこで http://www.google.co.jp/search?hl=ja&q=%22DBA_SE … から http://otn.oracle.co.jp/forum/message.jspa?messa … などを見れば、何を意味しているかわかってくるかと。
UPDATE テストTB A INNER JOIN テストTB B ON A.責任者名 = B.社員名 SET A.責任者ID = B.社員ID という感じでどうでしょう？
select * from Bテーブル join (SELECT SUBSTRING_INDEX(aカラム, '#', 1 ) as bカラム from Aテーブル) as sub on Bテーブル.id = sub.bカラム; って感じでしょうか。
一般的には、 【Ａ】顧客テーブル 主キー(1)顧客ID（オートナンバー・・・長整数型） (2)氏名（テキスト型） ※同一顧客で複数の発注を受けたら同じ顧客IDを使うように考えます。 （発注コードは入れるべきでない） 【Ｂ】商品テーブル 主キー(1)商品ID（オートナンバー・・・長整数型） (2)品名（テキスト型） (3)単価（通貨型）・・・定価があるなら設ける。 ※同一商品で複数の発注を受けたら同じ商品IDを使うように考えます。 （注文番号は入れるべきでない） 【Ｃ】注文テーブル 主キー(1)注文ID（オートナンバー・・・長整数型） (2)日付 (3)発注コード（テキスト型） 　　　　　　　※発注コードは『英数字』のためテキスト型。リンク元も『テキスト型』 (4)顧客ID・・・顧客との紐付けはこの項目で行う。 【Ｄ】注文明細テーブル（注文番号は全て4ケタの数字です。重複Noはありません） 　主キー(1)注文明細ID(オートナンバー型・・・長整数型） 　(2)注文ID（長整数型） または 　(1)注文ID（長整数型） (2)枝番・・・1から連番 主キーは(1)と(2)のセット (3)注文番号(数値型・・・長整数型) (4)商品ID (5)数量（注文番号1） (6)単価（通貨型）・・・商品マスタの単価はいつでも同じではないので、注文と一致しないことあり。 金額は、数量×単価で求めるか、別途(7)金額を設けるか。 （金額設定の仕方によりけりで、3本1000円とかがあるなら、(7)金額も必要。） 注文明細テーブルは、「ひとり最大50個の商品を一枚の注文書で発注します」に対応して、 １枚の注文書で、最大50レコード作ります。 リレーション 【Ａ】(1)-【Ｃ】(4) 【Ｂ】(1)-【Ｄ】(4) 【Ｃ】(1)-【Ｄ】(1)か(2) というふうにしますが。 （まずは、何でこういう設計にするのか、現状との違いから話をしていったほうが 　いいのかなと思います。 　⇒現状のほうがいいというのなら、それで話を進めてもいいのですが、 　　後の実績抽出は処理が面倒になると思っておいてください。）
3つある場合は、 SELECT * FROM ( SELECT 社員番号, 日付, 内容 FROM Aテーブル UNION SELECT 社員番号, 日付, 内容 FROM Bテーブル /*--------追加ここから--------*/ UNION SELECT 社員番号, 日付, 内容 FROM Cテーブル /*--------追加ここまで--------*/ ) ORDER BY 日付, 社員番号, 内容 ……という風にUNIONでつなげていけばOKです。
たとえばこんな感じ create table hoge (id int,url varchar(200)); insert into hoge values (1,'http://www.AAA.com/中略/0109.html'), (2,'http://www.AAA.com/中略/acb.html'), (3,'http://www.AAA.com/中略/0110-1.html'), (4,'http://www.AAA.com/中略/acb1.html'), (5,'http://www.AAA.com/中略/2acb.html'), (6,'http://www.AAA.com/中略/a3cb.html'), (7,'http://www.AAA.com/中略/123/abc.html'), (8,'http://www.AAA.com/中略/123.htm'); select * from hoge where url regexp '/.*[0-9][^/]*\.html$'
こんにちわ。 > ひょっとして、Oracleに設定すべきもの？ そうです。 ディレクトリオブジェクトです。 こんな感じで設定して下さい。 sqlplus "/ as sysdba" SQL> Create directory EXPORT_DIR as 'D:\TEST'; SQL> grant read on directory EXPORT_DIR to ユーザ名; SQL> grant write on directory EXPORT_DIR to ユーザ名; SQL> exit
select id,case hoge_id when 0 then redult else (select redult from tbl t2 where t2.id=t1.hoge_id) end from tbl t1 order by 1 です。
＞mysql_select_db("db1".$s); mysql_select_db("db1",$s); じゃないの？
GUIではphpmyadminが有名ですが、mysql workbenchもありますね。こちらはクライアントアプリなので接続設定とかちょっと手間ですが。 余計なお世話かもしれませんが、GUIは視覚的に使えて便利なので、いざGUIがない環境でテーブル定義の更新を行う等と言った場合に対応できなくなることがあります。 SQLを理解していればそんなことはないのですが、GUIばかりでSQLを覚えずにいるエンジニアもいますので(本当にいるから困る)、そのようにならないためにもまずはCUIで一通りできるところまで覚えるほうがいいかと思います。
SELECT title, code, name FROM address_book NATURAL JOIN customers; じゃだめなの？
正しく安全な遠隔操作ツール teamviewer 8 http://www.teamviewer.com/ja/download/currentver … 私も仕事場と自宅の間で使ってます。 偶然に他のＰＣと繋がるっていう掲示版？もあったみたいですが、それは無いと思います。 あったとすれば、それは「釣り」なので気をつければＯＫかと。 参考URL：http://www.teamviewer.com/ja/download/currentver …
MEMORYエンジンは通常のストレージに保存するよりかなり容量をくいますので ギリギリの容量だと難しいかもしれませんね ssdなどではダメなんでしょうか？
要はある整数で割り切れるデータ、ということでいいですよね？ select データ from テーブル where mod(あるカラム, 整数) = 0; でいいのではないでしょうか。
＞mysql_query('SELECT name FROM hoge2 WHERE name=$name'); シングルクォーテーションで囲んでいるので$nameは展開されません また、プリペアド処理ではないので$nameにクォーテーションがないと かりに展開されても文字列はマッチしません せめてこんな感じに mysql_query("SELECT name FROM hoge2 WHERE name='".$name."'");
GoもiPadも持っていないので厳しいですが >PC上の転送用の別プログラム（以降、ソフトB）を非表示で開き、接続ができた場合、 これってBをFM共有の「共有ファイルを開く」で開いていないのでは？
No.1の補足にある >col1もcol2も同じく小さければという条件 の意味が理解できませんでした。 どのようなデータから、どのような結果を取得したいのかを 具体的に書いてもらえればアドバイスできるかもしれません。
別カラムでAを保持してインデックスはるだけで済む話 数字の項目についてはAやBと別次元でオートインクリメントすればいいのでは？ アルファベット付きでも付きじゃなくても、ユニークは保証されます オートインクリメントは単にユニークなIDを振るための手段なので 運用方法によっては抜け番だって発生するし連番であることを期待しない方がよい
ちなみに後からuniqueを設定するとしても すでにあるレコードの該当フィールドが「ユニークなデータで埋まっている」 のが前提になります。 2個以上同じデータがある場合は当たり前の話ですがユニーク属性を 後付けすることはできません
http://dev.mysql.com/doc/refman/5.1-olh/ja/date- …
対象の Excel ファイルを一時的に別名 (必要であれば別の場所に) コピーして、コピーしたものを開くようにしたらどうだろうか。 これなら 「対象のファイルが存在するか」 というチェックを事前に行うことも可能なので、誰かが対象のファイルを間違って消してしまった場合にもプログラムでエラーを検知できる。
スクリプト側でやってもいいですし、SQLでやりたいのであればgroup byを使うことになるでしょうか。 テーブル構造が提示されていないのでそれ以上のことは何も言えません。
>【Ａ】顧客テーブルは　(2)の発注コードが主キー >【Ｃ】注文テーブルは、(1)のID（オートナンバー）が主キーです。 これはOKです。ただし、注文テーブルのID は 注文ID というように内容が分かる名前に変更しましょう。 >【Ｂ】商品テーブルは、(1)のID（オートナンバー）が主キー これは、ID を主キーにするなら、リンク先も ID(長整数型)にする必要があります。 注文番号をリンク先に格納したいのなら、「注文番号」を主キーにする必要があります。 注文テーブルは、下記のように２つに分割してください。 【Ｃ】注文テーブル 　　　(1)注文ID（オートナンバー） 　　　(2)発注コード 　　　(3)日付 　　　(4)氏名 ←この氏名が顧客テーブルの氏名ならば、このフィールドは不必要 　　　　　　　　　担当者とか別の内容のデータならOK、その場合は意味を表すフィールド名に変更したほうがよい。 【Ｄ】注文明細テーブル 　　　(1)注文明細ID(オートナンバー型） 　　　(2)注文ID（長整数型） 　　　(3)注文番号　　←商品テーブルの主キーが「注文番号」の場合 　　　(4)数量
select * from 表A, 表B where 表A.列1 = 表B.列2 and 表A.列3 = 値 と select * from 表A inner join 表B on 表A.列1 = 表B.列2 where 表A.列3 = 値 は同じ結果となります。前者の方が古くからある構文，後者が新しい構文になります。新しいといっても20年は経っていますけれど。 > 普通は、どちらの書き方で書くとか、 > そういうお作法的な暗黙の了解はあるでしょうか？ 旧構文は，結合を指定する要素がfrom句とwhere句に分かれてしまっているのに対して， 新構文では次のように各句の機能が明確ですから，join句の使用をお薦めします。 射影…select * 結合…from 表A inner join 表B on 表A.列1 = 表B.列2 選択…where 表A.列3 = 値 > 書き方によっては「LEFT OUTER JOIN」みたいにも書けるのでしょうか？ 旧構文で外部結合を記述することもできますが，各データベース製品の独自構文になります。標準SQLの規格ではありません。 > 「WHERE」だと3つ以上繋げられない(？)から、奨励されていない、とか そういう制限はありません。
一括でインポートするのが吉 http://nasunoblog.blogspot.jp/2012/05/sql-server …
update "store_table" set "t_tiket" = "取扱っている" where "kaiin_no" = ANY('{"100","101","103"}'); ではないですか？ IN句使うなら、それでも問題なさそうですけど
> ちなみに、不要なデータは削除してはいけないのですか？ 最初の件数(DCount)で連番をつけると、削除した分だけ取得する連番が小さくなりますからダメですが、 私の提案した最大値（DMax）を取得する方法なら、削除しても大丈夫です。 コードのロジックをきちんと理解して使用するようにしましょう。
datetime型かdateとtimeを組み合わせないと予約が１回しかできませんね 今回の例だとこんな感じ？ select t.`time` from time1 as t left join booked as b on t.time>=b.time and t.time<b.finish where b.time is null finishの時間が次の予約とかぶるので冗長な書き方になります
>もっと効率の良いテーブル設計 絶対的なデータ量がおおいなら、効率もなにもないのでは？ 5000件のデータというのは5000項目別々でそれらが相関関係をもつのか たんに冗長なデータが5000個登録されるのかによって設計は異なります ご提示の例では何がしたいのかわからないので もう少し具体性をもった質問が良いと思いますよ
SELECT * FROM 表 WHERE コード = ( SELECT コード FROM (SELECT コード, 番号, MAX(番号) OVER() max番号 FROM 表) WHERE 番号 = max番号 ); とかでしょうか。
このページが参考になると思いますが、いかがでしょう。 参考URL：http://www.db4o.com/japan/
こんにちわ。 > インストールしたいのですが、注意点はありますか？？ バージョンの低い方から先にInstall すれば後は余り気にしなくて 大丈夫な筈です。 > Oracle Client10g⇒Aシステム > Oracle Client11g⇒Bシステム 使うシステムに合わせて、ORACLE_HOME, PATH 環境変数を設定して やれば大丈夫な筈です。 http://www.oracle.com/jp/system-requirement/inte … でも上記のURL を確認して、接続対象のDB Version によっては どちらか一方のClient で大丈夫な場合もあります。 参考URL：http://www.oracle.com/jp/system-requirement/inte …
http://www.itmedia.co.jp/enterprise/0307/18/epn2 … 上記に更新SQLのサンプルが掲載されています。 答えを直接誰かに教えてもらうより、サンプルを見て自分でSQLを組み立てられるようにした方が力がつきますよ。
phpinfo.phpなど適当な名前で <?PHP phpinfo(); ?> というファイルを保存してアクセスしてみてください mysqlに関するモジュールが表示されないようであればphp側での設定が不十分です OSがよくわからないけど、スキルが伴わないならxamppなどでやる方がよいかと
No1です。 参照TB F1　　　F2　　　　F6　　　F7　　　F8 Ａ1　　あああ　　Ｂ1　　いいい　　Ｃ1 Ａ2　　えええ　　Ｂ21　　えええ　　Ｃ21 Ａ3　　かきく　　Ｂ3　　たちつ　　Ｃ3 修正TB F1　　　F2　　　F6　　　F7　　　F8 Ａ1　　959　　　Ｂ1　　363　　　Ｃ1 Ａ2　　965　　　Ｂ23　　111　　　Ｃ23 Ａ3　　115　　　Ｂ3　　499　　　Ｃ3 Ａ1　　236　　　Ｂ1　　546　　　Ｃ1 のようなサンプルテーブルで確認していますが。 利便上、F3とかF4などのフィールドは省いています。 このようなテーブルでクエリを実行すると、 F1　　　F2　　　F6　　　F7　　　　F8 Ａ1　　あああ　　Ｂ1　　いいい　　Ｃ1 Ａ2　　965　　　Ｂ23　　111　　　Ｃ23 Ａ3　　かきく　　Ｂ3　　たちつ　　Ｃ3 Ａ1　　あああ　　Ｂ1　　いいい　　Ｃ1 のように修正TBは更新されます。補足のような エラーはでませんが、提示したSQL文を正しく クエリのSQLビューに貼り付けたのでしょうか。 あるいは、実際のテーブルに合わせてSQL文を 書き換えてエラーが出たのでしょうか。 あるいは、質問通りにテーブルは参照TB、修正TB、 フィールドはF1、F2、F6、F7、F8とした上で エラーが出たのでしょうか。
明細データのテーブルのキー列のＡ列は重複ありのインデックス⇒idx1 Ｂ列も重複ありのインデックス⇒idx2 とすると、 A=3 and B=7 の条件を求めるときは、idx1かidx2のどちらかしか使えません。 idx1 を使ってA=3 が1000件、もしくは、idx2を使って、B=7が600件とでてきても A=3 and B=7　の3件を探すには、 1000件なり、600件なりを１件ずつ調べることになるので。 極端にいうとインデックスを両方とも使っていないかもしれません。 （パラレル処理できるＤＢ＆ＨＷの組み合わせなら知りませんが、 　一般的にはどのＤＢでも同じです。） インデックスを使った処理をしようと思えば、Ａ列、Ｂ列を指定した重複ありのインデックスを 作るほうがいいです。 でも、設計の話をすると、一般には、 >マスタデータのテーブルのキー列のＡ列、Ｂ列を主キーとして定義し なら、 明細データのテーブルのキー列のＡ列、Ｂ列、連番を主キーとして定義するように思うのですが。 ## 余計な話に流れてしまいましたが。
> ・エントリーに属するすべてのカテゴリーデータを取得するにはどうすれば良いでしょうか？ 構造的にはエントリーテーブルとカテゴリーマスターテーブルは対称になるので、#1で例示したSQLのテーブル名やカラム名をカテゴリー関係に入れ替えるだけで出来ますよ。 SELECT DISTINCT cm.* FROM カテゴリーマスターテーブル cm LEFT OUTER JOIN エントリー所属カテゴリーテーブル ec ON (cm.カテゴリーID = ec.カテゴリーID) WHERE ec.エントリーID = 101 テーブル間の構造が把握できない場合はER図などを書いてみると良いでしょう。 > ・例えば、一旦複数レコードとして取得後、スクリプト側で文字列連結とかして、1カラムのようにして、1レコード表示するのでしょうか？ > ・希望としては、エントリー毎に、属しているすべてのカテゴリー名とかを表示させたいです ？？？ エントリー毎に1行出力して、ひも付く全カテゴリーをその行に含めたいという事でしょうか？ そうだとしたら、GROUP_CONCAT を使えば良いでしょう。 SELECT cm.*, GROUP_CONCAT(et.件名) FROM カテゴリーマスターテーブル cm LEFT OUTER JOIN エントリー所属カテゴリーテーブル ec ON (cm.カテゴリーID = ec.カテゴリーID) RIGHT OUTER JOIN エントリーテーブル et ON (ec.エントリーID = et.エントリーID) GROUP BY cm.カテゴリーID ORDER BY cm.カテゴリーID 複数行が良いのなら、結合してカテゴリーID順にソートすれば良いでしょう。 SELECT cm.*, et.* FROM カテゴリーマスターテーブル cm LEFT OUTER JOIN エントリー所属カテゴリーテーブル ec ON (cm.カテゴリーID = ec.カテゴリーID) RIGHT OUTER JOIN エントリーテーブル et ON (ec.エントリーID = et.エントリーID) ORDER BY cm.カテゴリーID 参考URL：http://dev.mysql.com/doc/refman/5.1/ja/group-by- …
NOT EXISTSを使う方法もあります。 SELECT id, key, code, cls, add_date FROM table t1 WHERE NOT EXISTS ( SELECT * FROM table t2 WHERE t1.key = t2.key AND t1.code = t2.code AND t1.add_date < t2.add_date ); 分析関数を使うなら、 SELECT id, key, code, cls, add_date FROM ( SELECT id, key, code, cls, add_date, ROW_NUMBER() OVER(PARTITION BY key, code order by add_date desc) rnum FROM table ) WHERE rnum = 1; といった感じでしょうか。
テーブルに追加できているなら、 そのテーブルから作成したフォームをリクエリすれば良いのでは？
名前が決まるまで事前に用意しておく必要はありませんので、最初はidとnameだけで十分です。
Windowsの場合WireWallで拒否される場合が有るので、サービスのサービス名MySQL55の実行ファイルのパス名をWireWallに追加して下さい。
手元に環境がないので試していませんが、 MySQLは正規表現が使えるようなので、それを使うと楽です。 これを試してみてください。 SELECT * FROM テーブル名 WHERE フィールド名 REGEXP '/[0-9]+\\.html$' （「/[1桁以上の数字].html」で終わるものを検索）
都道府県テーブル を変更することが可能なら、 下記のようにするのが一番簡単でしょう。 m_prefecture prefecture_ID　prefecture_name 0　---選択してください--- 1　北海道 2　青森県 3　岩手県 コンボボックス 名前　cb都道府県 値集合ソース SELECT m_prefecture.prefecture_ID, m_prefecture.prefecture_name FROM m_prefecture; 規定値　0 連結列　1 列数　2 列幅　0cm フォームの 更新前処理 で、 Private Sub Form_BeforeUpdate(Cancel As Integer) If Nz(Me.cb都道府県) = 0 Then Cancel = True MsgBox "都道府県を選択してください。" Me.cb都道府県.SetFocus End If End Sub
条件に"カラム=" & "'" & Replace("テキストボックス","'","''") & "'" としてあげれば、' の存在を気にする必要は無くなるのでは？
顧客リストの規模とか使い方によりますね。 ただ、さっぱりわからないなら、そういった方がいいと思います。 相手があなたに十分なコンサル能力というか技術的な能力がある事を期待している以上、相手の意図が分からない場合でも、自分の知識でわからない場合でも分からないので相談することが必要な内容だと思います。 今後毎回ここで質問してもいいですが、その結果困るのはあなたでは無いでしょうか。
select hoge2.* from hoge1,hoge2 where int1=int2 and hoge1.id=hoge2.id てことかな？
> 通常のエディタで開くことはもちろん、手作業で行うことは気が遠くなってしまいます。 そういうことでしたら、思いつくのは下記の様な方法でしょうか。 a. pg_dumpall ではなく pg_dump を使ってダンプする 　元のDBに接続でき、現在の状態のリストアでよいならば、この方法が簡単でしょう。 　例) pg_dump -h localhost -p 5432 -U user_hoge -t table_hoge db_hoge > dump.txt; http://www.postgresql.jp/document/9.2/html/app-p … b. スクリプト言語を使って対象のテーブルの箇所を抽出する 　perl や ruby などを使えば、対象部分を抽出するプログラムが割りと簡単に作れるかと思います。 c. サイズの大きいファイルも扱えるエディタを使って抽出する 　例えば、 vim などではサイズが大きくてもさほど不自由なく編集はできたと思います。 　検索機能で該当箇所への移動・選択を行い、新旧の2ファイルを開いてコピーすれば良いかと。
そういう意味で書いたのでは無くて、SM-S210iはBluetooth印刷 が可能とありますけど、あなたのは「i」が無いモデルですか？ という意味でした。 でも問題はFM GoがAirPrintしか対応していないという事なのですね。
> C:\Tomcat7\lib の中に tomcat-dbcp.jar は有りました。 そうですか。その中に↓は含まれているはずなのですが・・・。 org.apache.tomcat.dbcp.dbcp.BasicDataSourceFactory > e.printStackTrace() で出たメッセージがどこに表示（保存？）されるのかわかりません。 おそらくは、↓の様なファイルが有って、そこに出力されているかと。 C:\Tomcat7\logs\catalina.～～～.log あと、#1で補足して頂いたエラーメッセージ(スタックトレース)は、あれで全部なのですよね？
http://dev.mysql.com/doc/refman/5.1/ja/adding-an … 書いてある通りそのままやればいいです。
No2の方がおっしゃっているように、postage_price_min　postage_price_max　daibiki_priceは 文字型として処理しているように見受けられます。 もういちど、型のチェックをおねがいします。
MySQLじゃなくてphpの問題でしょう。 (3)は、phpの short_open_tag がoff なのでしょう。 php4 時代は、default on だったけど、php5 になってからは、default off です。 <?php で開始するように書き換えた方が今後も無難だと思います。 (5) は、まだ、$_GET[] を受け取ってないから、変数（または連想配列キー）が存在しないというwarning でしょう。 isset() で存在確認してから使って下さい。 上記は、php version upによるセキュリティ設定改善の結果です。 ネットショップ構築するなら、なおさらセキュリティに気を使って下さい。
> クロス集計をしても編集入力はできますか？ 残念ながら、できません。 １）ＡＣＣＥＳＳでクロス集計した結果をＥＸＣＥＬにエクスポートして ２）ＥＸＣＥＬで１ヶ月単位の表形式で入力・編集したものを ３）ＡＣＣＥＳＳにインポートする が良いのかも。
Wikipediaで「ビットマップ画像」「データ圧縮」を引いてみるとか
複雑なクエリを書けばなんとかなりはしますが、内部で色々やろうとすると混乱するだけになるかと思います。 ストアドプロシージャという機能がありますので、PHPでやるのがいやであれば、そちらで行うことをおすすめします。
文字列「%佐藤%」には両端に引用符を付けて下さい。 SELECT * from `table` where REPLACE(name,'★','') like '%佐藤%' です。
往復はがきに宛名印刷が課題とすれば ソフトはワードを使い、ツールバーでツールを選び、はがき宛名印刷と進み、はがきの選択のところで、往復はがきを指定して・・・・・・・というコースでやってみたらいかがですか。
MyISAM エンジンで作成するなら、連動primary key で指定した２番目カラムを int NOT NULL AUTO_INCREMENT　とすれば、１番目のカラム値ごとに、１から順に番号を振ってくれます。 innodb エンジンでは出来ません。 create例 CREATE TABLE `auto_rendo` ( `column1` int(11) NOT NULL DEFAULT '0', `column2` int(11) NOT NULL AUTO_INCREMENT, `memo` varchar(255) DEFAULT NULL, PRIMARY KEY (`column1`,`column2`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8
ここはMySQLの板ですがaccessの質問？ たぶん名前でJOINしてORDER BY するだけだと思いますが
簡単な方法として、INFORMATION_SCHEMAのTABLESテーブルを利用して、 SELECT CONCAT('DROP TABLE ', TABLE_NAME, ';') FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME LIKE 'hoge\_%'; という感じのSQLでテーブル削除用のSQLを作成してはいかがでしょうか。 もしくはストアドプロシージャを作成して動的SQLを実行するか。
> whereで指定した場合id全部取得できるんですね。1つしかできないと勘違いしていました PerlのDBIについての説明にざっと目を通しておくと良いかもしれません。 http://dbi.perl.org/ http://search.cpan.org/~timb/DBI/DBI.pm また、"Perl DBI"で検索すると様々な方の解説記事を見つけられます。公式ドキュメントを読んでもピンと来ない場合は検索してみましょう。 > idでやったことをgroup_idでやればいいのでしょうか？この場合idの意味ってありますか？ちなみにidは登録者番号です 基本的にそういうことです。ただ、登録者番号ならregistrant_idなどと名付けるのでは。 行ごとに固有の番号が振ってあると、その行のデータを指定して取り扱うときになにかと便利だと思います。普通に考えて、データの複数ページにわたる表示、削除や変更をする場合、idがあったほうが楽ではありませんか。 例えば、Webのフォームなどで登録者IDごとにデータの一覧表示をして、削除するものをそこから選ぶ場合、IDさえフォームから送ってもらえると削除するものが一意に決まり、簡単に削除出来ますよね。また、IDで整列して表示すれば複数ページにわたっる表示が必要な場合に簡単に重複なく次のページを表示できます。
MySQLの文字コードと、コマンドプロンプトの表示できる文字コードが異なるからでしょうね そもそもxamppを導入してphpMyAdminが使える環境なのに どうしてもコマンドプロンプトで入力する必要があるのでしょうか？ とりあえず「コマンドプロンプト utf-8」あたりでググればいろいろヒットすると思いますが
-- #!/bin/sh while :; echo "exec dbms_mview.refresh('mview_name','c') -- マテビュー(mview_name)を完全リフレッシュ" sleep 60 done | sqlplus Userid/Passwd@sid exit 0; -- これで60秒ごとにコマンドがSQL*Plusに送られリフレッシュが実行されるはずです。
sql 文が解らないということですか。 windows ならFireFoxのアドオン版 SQLite Managerをインストールしてみては？GUIで結構操作性よいらしいとありますが。 http://satolab.tiu.ac.jp/js/index.php/lectures/3 … インストールは、最新のFireFox をインストールして、アドオン追加するだけのようですし、 利用は、FireFox　のツールボタンから開いて、 さらに、拡張子 .sqliteのファイルを開くだけで、既に入ってるtableのデータは簡単に一覧できるようです。
`a-test` で試してみてください
マニュアルを読めば、最大何バイトまで入るかがわかります。 http://www.dbonline.jp/mysql/type/index6.html あとは、「あ」 1文字が何バイトかがわかれば計算できますね。 これは使用する文字コードによって子tkなりますが、UTF-8を 使うなら、「あ」1文字は3バイトです。 あとは技術者たるもの、自分で計算してください。
> SELECTの処理が何秒かかったとしても終わってから次のphpの処理にいっているんですか？ はい。待ってくれます。 ただ、所定の時間返ってこないとタイムアウトになり、失敗を返してから次の処理に行きます。 もっと具体的に言うと、同期APIだと待ちます。非同期APIだと待ちません。 いずれの場合でも、意図に反してMySQLが結果を返さないのを無視して実行を進めることはありません。 非同期APIの場合は例えばこんなコードになるみたいです。 http://www.php.net/manual/ja/mysqli.poll.php PDOからは非同期APIは使えないようですが。 http://php.net/manual/ja/mysqlinfo.api.choosing. …
>シェル状態ではどのようなコマンドになるのでしょうか？ sshで接続してから、そのまま mysqldump -u サーバー名 -p データベース名 > testdump.sql で、カレントディレクトリにtestdump.sqlが出力されるんじゃないですかね？
wavepad のお試し期間は14日間ですから、インストールしてから 14日が経過したということでしょう。『無料お試し期間』が終わって いますので、購入しない限り、有料の機能 (保存機能) は使用 できません。 wavepad の開発者も『慈善事業』ではなく、そのソフトを売った お金で生活しているわけですから、気に入ったら買ってあげる のがアタリマエです。
＞"N002"のグループ内に"N"が存在したら"P"に置換したいです。 を「B_NOのグループ内に'P'が存在したら'P'に置換」と解釈しました。 SELECT REC_NO, B_NO , CASE WHEN 'P' IN (SELECT [TYPE] FROM Table1 x WHERE SUBSTRING(x.B_NO, 1, 4) = SUBSTRING(a.B_NO, 1, 4) GROUP BY [TYPE],SUBSTRING(B_NO, 1, 4)) THEN 'P' ELSE [TYPE] END [TYPE] FROM Table1 a
元データの件数はどのくらい？ 2000万行あるうちの100万行と、101万行のうちの100万行だと違う方法がありそう。
Access をやる者にとって、こちらが標準かと思われます。 DJoin 関数 - リスト文字列を取得する方法 http://www.f3.dion.ne.jp/~element/msaccess/AcTip …
#2の補足です。対戦表風に横に並べたいのなら、下記の様に並べてSELECT句にサブクエリを並べて書けばよいです。 SELECT uid, COALESCE((SELECT SUM(val) FROM zaiko WHERE from_uid = 1 AND to_uid = uid), 0) - COALESCE((SELECT SUM(val) FROM zaiko WHERE to_uid = 1 AND from_uid = uid), 0) AS from_1, COALESCE((SELECT SUM(val) FROM zaiko WHERE from_uid = 2 AND to_uid = uid), 0) - COALESCE((SELECT SUM(val) FROM zaiko WHERE to_uid = 2 AND from_uid = uid), 0) AS from_2, COALESCE((SELECT SUM(val) FROM zaiko WHERE from_uid = 3 AND to_uid = uid), 0) - COALESCE((SELECT SUM(val) FROM zaiko WHERE to_uid = 3 AND from_uid = uid), 0) AS from_3 FROM user ORDER BY uid; (縦横を入替えるには引き算の前と後を入替えます) また、#4さんのSQLは MySQL version 5.5.8 で問題無く動作しました。 下記の様にスカラサブクエリを使っても書けますね。 SELECT u1.uid AS from_uid, u2.uid AS to_uid, COALESCE((SELECT SUM(val) FROM zaiko WHERE from_uid = u1.uid AND to_uid = u2.uid), 0) - COALESCE((SELECT SUM(val) FROM zaiko WHERE to_uid = u1.uid AND from_uid = u2.uid), 0) AS val FROM user u1 INNER JOIN user u2 ORDER BY u1.uid, u2.uid;
#1 です。 おー、#2さんのおっしゃる通りでした。 今、試してみました。 全角のまま大文字になるんですね。 勉強になりました。
大変申し訳ありません。 私の勘違いだったようです。 検証結果、条件に合致しない場合には、EOF BOF ともに True になりました。 迷宮に入っていたのはヘルプを~@;}%した私でした。 orz こちらでは何故か、主キー設定無し・全てのフィールドでインデックス無し にしても機能しました？ >1つ目のメールアイテムに対して・・・ こちらです。
>ちなみに(1)のmysqlにログインというのは、 ああ、なるほどズブの・・・ ユーザー名とパスワードなどログイン情報わかっているのでしょうか？ mysqlのコンソールにログインするには mysql -u ユーザー名 -p として、パスワードを入力します。 もしログイン情報がわかっていないなら無理なのであきらめてください ちなみに管理者がセキュリティを少しでもきにしているなら sshでログインするときのユーザー名とパスワードとは異なるものが 設定されていると思います。
共用サーバーで100MBのDBというのがあまり想像できませんが、数MBであっても負荷が掛かるようなSQLを実行すれば制限を受けたり追い出される可能性があります。実際に停止され専用サーバーに移った事があります。 最近では専用サーバーも3千円台からあるようです。 基本的に共用サーバーの負荷許容量は公表されていません。100MB級のDBを扱う予定があるのでしたら最初から専用サーバーにしてしまうのも手かと思います。
>大きくなり過ぎて一括ではエクスポートもできなく では小さいうちはなにでエクスポートできているのでしょうか？ とりあえずphpMyAdminのエクスポートではできない？
goup byが無いから。 SELECT 仕入テーブル.date_y, 仕入テーブル.date_m, 仕入テーブル.id_direct_cost, 勘定項目テーブル.name_cost, SUM(仕入テーブル.price) AS sumcost FROM 仕入テーブル NATURAL JOIN 勘定項目テーブル WHERE 仕入テーブル.date_y="'.$y.'" AND 仕入テーブル.date_m="'.$m.'" AND 仕入テーブル.typecost="direct" AND 仕入テーブル.id_direct_cost=勘定項目テーブル.id_cost group by 仕入テーブル.date_y, 仕入テーブル.date_m, 仕入テーブル.id_direct_cost, 勘定項目テーブル.name_cost では？
残念ながらSQL Serverの機能としては提供されていません。 プログラムの実装側で対応する必要があります。 今回のケースですとVBで、タイムアウトとリトライを作りこむしかないかと思います。
＞の構文は、mydb.sql（インポートのためのsqlファイル）内に そうですね、sqlファイルをテキストエディタで開いて データベース名の前に「IF NOT EXISTS」を書きこむことになります なおこのエラーが回避されても ・同じデータベース内に同じテーブル名がある ・同じテーブル内で同じユニークデータがある 場合もどうようのエラーがでると思います。 そもそもバックアップしたデータをリストアするのに別のマシンでやっているのでは ないのですか？ 同じマシンでやる限りデータを戻すときに競合するのは避けられませんね 思い切ってデータベースごと削除してしまった方が分かりやすいかもしれません。
> Set Me!～.Form.Recordset = Me!～.Form.Recordset > > 上記が何かしら悪さをしているということも考えられますでしょうか。 この場合、どちらのサブフォームで Filter、OrderBy の設定をしているのでしょうか。 もう少し、どこにコードを設定して、それぞれのフォームがどのようになるのか詳細を説明ください。 当方、Access2000の環境はないので、Access2003でサンプルを作成して試してみましたが、正常にフィルター、並べ替えができました。ただし、フィルターをかけると、レコードセットが再生成されるため、同期しなくなりますので、再度、代入して同期させる必要があります。 こちらで動作確認したサンプルの詳細 メインフォームの読み込み時 Private Sub Form_Load() 　　Set Me.F_社員詳細.Form.Recordset = Me.社員.Form.Recordset End Sub サブフォーム F_社員 上のコマンドボタンのクリック時 Private Sub コマンド8_Click() 　　Me.Filter = "在籍支社='東京本社'" 　　Me.FilterOn = True 　　Me.OrderBy = "社員コード DESC" 　　Me.OrderByOn = True 　　Set Me.Parent.F_社員詳細.Form.Recordset = Me.Recordset End Sub
>エクセル書き出しとか機能があるようですが、書き出したエクセルファイルは整合性をたもったまま問題なくよみこめるのでしょうか？ ANo1の方も書いておられますが、問題なく読み書きできますけど、 エクセル書き出しした結果を簡単に編集できるかどうかは別の話です。 エクセルの１行が１レコードなので、繰り返し項目とかを含んでいると、 １セルの中に繰り返し100個分がまとめて入ってきて 編集できな～い、ってオチに私のところではなっています。
単に「入力待ち」ということですね SQL文はステートメントデリミタが記述されるまでエンターを押しても 実行されません 通常デリミタには「;(セミコロン)」か「\g(円マーク＋ジー)」が使われています たとえば SELECT 1\gSELECT 2（エンター） とすると「SELECT 1」の結果だけ表示されます。 MySQLは入力待ちになりますので、あらためて 「,3\g（エンター）」とすると、「SELECT 2,3」の結果が表示されます
\Qじゃなかったかな
＞ ソフトはマック 「マック」ってこれ↓のことですか? http://www.apple.com/jp/osx/ もしそうなら、たいていOS X標準の印刷機能を使ってPDFファイルに転換できますので、コンビニに持ち込んでプリントできます。 くわしくは、コンビニの店員にお尋ねください。 http://www.lawson.co.jp/service/counter/copy.html http://www.sej.co.jp/services/print_document.html 参考URL：http://support.apple.com/kb/HT4670?viewlocale=ja …
>1行上のcol4-col5 RDBには1行上という考え方はありません。 上下関係を確定するカラムとそのロジックを提示しなければ ご提示の命題を解決する手段はありません。
tableAに加え、sysdateを取得するために dualを加える。 日付形式・時刻加算等は適宜調整 select sysdate from dual;
＃１です 補足です。 提示された条件で重複するものがあったら、おかしくなっていくと思います。
＞ PARAMETERS [ParaヘッダーID] COUNTER; 下記サイトを見た感じ、「COUNTER」が意味不明のような。 パラメータの型を指定するので、「Long」では。 http://office.microsoft.com/ja-jp/access-help/HP … http://msdn.microsoft.com/ja-jp/library/office/f … あと、クエリもちょいとおかしい感じがするので、まずはAccessのクエリ作成画面を使ったほうが学習しやすいと思います。
最近のバージョンならコレでいけるかと select (select A from テーブル where ID = TBL.ID1) A1 , (select A from テーブル where ID = TBL.ID2) A2 , A1＝A2の比較式 from ( select T1.ID as ID1, MAX(T2.ID) as ID2 from テーブル T1 LEFT JOIN テーブル T2 ON T1.ID > T2.ID group by T1.ID ) TBL ;
社員テーブル１～3があると仮定した場合、以下のSQLで実現可能です。 SELECT NES.会社名 ,SUM(NES.訪問回数) AS 訪問回数合計 ,SUM(NES.単価) AS 請負費合計 FROM( --社員テーブルその1 SELECT TEST11.会社名, SUM(TEST2.訪問回数) AS 訪問回数, SUM(TEST2.訪問回数 * TEST2.単価) AS 請負費 FROM TEST11 RIGHT OUTER JOIN TEST2 ON TEST11.訪問日 = TEST2.訪問日 AND TEST11.区分コード = TEST2.管理番号 GROUP BY TEST11.会社名 UNION ALL --社員テーブルその2 SELECT TEST11.会社名, SUM(TEST2.訪問回数) AS 訪問回数, SUM(TEST2.訪問回数 * TEST2.単価) AS 請負費 FROM TEST11 RIGHT OUTER JOIN TEST2 ON TEST11.訪問日 = TEST2.訪問日 AND TEST11.区分コード = TEST2.管理番号 GROUP BY TEST11.会社名 UNION ALL --社員テーブルその3 SELECT TEST11.会社名, SUM(TEST2.訪問回数) AS 訪問回数, SUM(TEST2.訪問回数 * TEST2.単価) AS 請負費 FROM TEST11 RIGHT OUTER JOIN TEST2 ON TEST11.訪問日 = TEST2.訪問日 AND TEST11.区分コード = TEST2.管理番号 GROUP BY TEST11.会社名 ) AS NES GROUP BY NES.会社名 ORDER BY NES.会社名
mysql の ALTER DATABASE や CREATE DATABASEにおける文字コード設定というのは、これから新規にtableを創るときに、table に文字コードを指定しなかったら、そのdatabaseに設定してあるdefault値を使うと言う意味ですので、既に作成済みのtable に対しては、何も作用を及ぼしません。 作成済みtable内の多バイト文字は、作成時の文字コードのままですので、そのつもりで、取り出さないとかえってプログラム側で文字化けすることになるでしょう。 show create table でcreate 文を表示してみると、table作成時に CHARACTER SETを付けて無くても、作成時のdatabaseに設定されていたCHARACTER SET 指定が追加されているはずです。 それから、iniファイルで変更するのは、サーバー本体のsystem 設定なので、これまた、databaseに対する設定とは別物です。 サーバ、データベース、テーブル、カラムの 4 段階で設定があります、マニュアル参照してください http://dev.mysql.com/doc/refman/5.1/ja/charset-s …
>今はテキストを見ながらのお勉強なので、コマンドプロンプトを使ってみよう では「コマンドプロンプト utf8」でググって自力で環境を整えるしかありません。 もしくはテストするときには日本語を使うのを避けるかのどちらかです
＞データの無い というのが、NULLなのか''なのか0なのか テーブルでどう定義されているのかによるのでは？
こちらが参考になると思います。 http://www.shift-the-oracle.com/plsql/dbms_lock/ …
スキーマ(ベンダーによってはデータベースとも呼びますね)が別なテーブルを使った差分ということでいいんですよね？ 例として、サーバAにdb1, db2スキーマが存在する場合は、「スキーマ名.テーブル名.カラム名」で参照することが可能です。 また、サーバAにdb1,サーバBにdb2というように各スキーマが別サーバにあるような場合は、ベンダーごとに変わってきます。 このような場合は各ベンダーのリファレンスを参照して、それにあわせたクエリを書く(または接続方法や接続ユーザの権限を 適切に設定する)ことになります。 また、同一スキーマのテーブルであれば、「テーブル名.カラム名」で参照することが可能です。 どちらの方法でも並び替えであれば、 「order by スキーマ名.テーブル名.カラム名 - スキーマ名.テーブル名.カラム名 asc(またはdesc)」 で並び替えが出来ます。
こんにちわ。 RPMで導入すれば、基本的にmysqlユーザで立ち上がるはずです。 なお、RPMパッケージを導入するユーザと導入したパッケージの起動ユーザとは基本的に関係はないので、安心してください。 ＃コマンドラインから起動した場合は、起動されたプロセスのオーナーは起動時のユーザになりますが、MySQLのようにデーモンとして利用するプログラムの場合は、起動ユーザに関わらずプロセスのオーナーを設定することができるのが普通です。 ちなみに、MySQLの起動ユーザを決めるのは、デフォルトの状態だと/etc/my.cnfというMySQLの設定ファイルの中にある"user"という行になります。ここにmysqlが設定されていれば、プロセスのオーナーがmysqlユーザで起動するはずです。
http://www.sharp.co.jp/support/mebius/tips/tips- … これはWindowsMeですけど、同じ感覚で行けませんかね
Windowsクライアントからバックアップするのではなく、 LinuxサーバでDBバックアップしてWindowsクライアントにダウンロードするという方法なら自動化できます。 しかし、私が携わったプロジェクトでは、サーバでバックアップしていましたが、自動化はしていませんでした。 その理由は、バックアップ前にハードディスクの空き容量を確認が必要だったからです。 シェルだけ用意しておいて、空き容量確認後にDBバックアップしていました。 バックアップは自動化してクライアントにダウンロード後にサーバから削除するなら、毎回サーバの空き容量を確認しなくてもいいので、サーバでのDBバックアップを自動化してもいいかもしれません。 私が携わったプロジェクトは月１回のバックアップだったのでサーバの空き容量確認が毎回必須でした。 １．Linux でDBバックアップ ・postgres の所有ユーザで pg_dump を実行する。 　-h, -U といったオプション指定が不要になると思います。 ２．WindowsクライアントにDBバックアップファイル取得 ・WinSCPとかを使ってLinuxサーバにあるDBバックアップファイルをWindowsクライアントにダウンロード ・サーバーのDBバックアップファイルを削除 手順は以上です。ご検討下さい。
PostgreSQL が Windows に直接インストールできるように なったのは、バージョン 8 からです。 バージョン 7 以前は、『 Cygwin (シグウィン) という UNIX ライクな環境を Windows にインストールし、その Cygwin 上で PostgreSQL を動かす』 という、手の込んだことが 必要です。 具体的な方法は以下の参考URLを見てください。 参考URL：http://allabout.co.jp/gm/gc/47344/
変換をどこでどのように行ったのか不明ですが、 変換先の文字コードの指定を、「Shift_JIS」や「SJIS」でなく、 「sjis-win」、「SJIS-WIN」、「CP932」などに変えてみてはいかがでしょう。
MySQL にも COALESCE 関数は存在するので、使えます。 ただし、先の回答にも書きましたが、この方法でいけるのは、 『title カラムの先頭1文字目が漢字ではない場合、 　yomi カラムは null である 』 という条件が満たされるデータの場合だけ、ということに注意 してください。 質問者さんの案1も案2も、『先頭１文字目が ”漢字ではない”』 場合のデータがどうなるかが明示されていませんので、実際に 使用できるかどうか、私には直接判断できません。
sed で行末の区切り文字を取っ払ったものを流し込んでやるのはどうですか？ sed -e 's/[|]$//' hoge.txt | psql -U user_hoge -c "\copy hoge from STDIN delimiters '|';" db_hoge http://itpro.nikkeibp.co.jp/article/COLUMN/20060 … 参考URL：http://www.postgresql.jp/document/9.1/html/app-p …
> NULLならタブを出したい 対象アプリケーションが不明ですが、仮にAccessであれば 　「Nullの場合のみ指定した値に変換するNz関数」と 　「指定した文字を返すChr関数」 を使用すれば、ご希望の結果が得られると思います。 ただ、「CSV【とか】」とされていますが、CSVであればNullで あっても「,(カンマ)」の数で調整されて、列ずれは起こらない ような・・・CSVを開くプログラムによるのでしょうか?(汗) とりあえず、Nullの場合の読替をTabではなく空文字で 済ませるようなら、Chr関数は不要になります。 【現状例】 Select 顧客マスタ.ID, 顧客マスタ.社名, 顧客マスタ.住所 From 顧客マスタ; 【修正例】 ※社名のNullを変換する場合 <Tabに変換する場合> Select 顧客マスタ.ID, Nz(顧客マスタ.社名, Chr(9)), 顧客マスタ.住所 From 顧客マスタ; ※「Chr(9)」がTabに相当します。 <空文字に変換する場合> Select 顧客マスタ.ID, Nz(顧客マスタ.社名, ""), 顧客マスタ.住所 From 顧客マスタ;
まずは、B-PCのAccessのツール→オプション→詳細タブの 既定の開くモードが共有モードになっているか を確認してください。 なお、既定のレコードロックは、編集済みレコード レコードレベルでロックして開く にチェック もお勧めします。 これでダメならA-PCのアクセス権の設定かもですね。 ちなみに現状の使い方はMDBファイルを壊す危険性が大です。 せめてデータ部分（テーブル）とそれ以外は分けた方が。。 http://office.microsoft.com/ja-jp/access-help/HP …
普通？はグローバルフィールド(G)に表示したい画像を入れておいて オブジェクトフイールド（いつもは空っぽ）の計算式を =Case ( Get ( レコード番号 ) = Get ( 対象レコード数 ); G)　とします。 Get ( 対象レコード数 )にしておかないと検索等で絞り込まれたとき 最終レコードになりませんから・・・・ オブジェクトフィールドを背景色で塗り潰しましょう。
k28484　さん 横から余計な口出しをして申し訳ありませんが、テーブル設計が正しく行われていないように思います。 そのため契約明細と契約基本のデータを結合して取得するだけなのに、とても複雑な結合条件が必要でＳＱＬ文もかなり複雑になってしまっています。 一般的に親テーブルの主キーで子テーブルのデータを検索できなければなりません。その逆もしかり。 親テーブル「契約基本」の主キーは基本ＳＥＱですが、子テーブル「契約明細」にはその基本ＳＥＱが含まれていません。 基本契約年月日と明細契約年月日の近いという条件でテーブルを結合するとデータの不整合が起こります。 例えば２人の契約者が違うが同じ契約明細年月日の場合、基本ＳＥＱの値が大きい契約基本テーブルのデータを探すと、１人の契約者名しか表示されません。 １人の契約者は１つの契約種別のデータを持たないなら、テーブルを親子に分ける必要がありません。 （契約番号を主キーに持つテーブルがあると見受けられます。契約基本テーブルはそのテーブルの子テーブルなのではないでしょうか？） ■１つのテーブルにした例 契約テーブル　　主キー：基本ＳＥＱ 【基本ＳＥＱ】【契約番号】【契約者名】【基本契約年月日】【契約種別】【明細契約年月日】 　1　　　　　　　K0001　　　契約者１Ａ　2013/05/01　　　　S1　　　　　2013/05/05 　2　　　　　　　K0001　　　契約者１Ｂ　2013/05/10　　　　S1　　　　　2013/05/10 　3　　　　　　　K0001　　　契約者１Ｃ　2013/05/20　　　　S2　　　　　2013/05/25 　4　　　　　　　K0002　　　契約者２Ａ　2013/06/10　　　　S2　　　　　2013/06/10 　5　　　　　　　K0002　　　契約者２Ｂ　2013/06/10　　　　S1　　　　　2013/06/15 　6　　　　　　　K0002　　　契約者２Ｃ　2013/06/10　　　　S2　　　　　2013/06/10 　7　　　　　　　K0003　　　契約者３Ａ　2013/07/01　　　　S1　　　　　2013/07/05 　8　　　　　　　K0003　　　契約者３Ｂ　2013/07/10　　　　S2　　　　　2013/07/10 　9　　　　　　　K0003　　　契約者３Ｃ　2013/07/10　　　　S1　　　　　2013/07/10 １人の契約者が複数の契約種別のテータを持つ場合、テーブルは親子に分けます。親テーブルの主キーで子テーブルのデータを検索できるように子テーブルの主キーを決めます。 ■親子にテーブルを分けた例 契約基本テーブル　　主キー：基本契約番号（基本ＳＥＱ） 【基本契約番号】【契約番号】【契約者名】【基本契約年月日】 　1　　　　　　　　K0001　　　契約者１Ａ　2013/05/01 　2　　　　　　　　K0001　　　契約者１Ｂ　2013/05/10 　3　　　　　　　　K0001　　　契約者１Ｃ　2013/05/20 　4　　　　　　　　K0002　　　契約者２Ａ　2013/06/10 　5　　　　　　　　K0002　　　契約者２Ｂ　2013/06/10 　6　　　　　　　　K0002　　　契約者２Ｃ　2013/06/10 　7　　　　　　　　K0003　　　契約者３Ａ　2013/07/01 　8　　　　　　　　K0003　　　契約者３Ｂ　2013/07/10 　9　　　　　　　　K0003　　　契約者３Ｃ　2013/07/10 契約明細テーブル　　主キー：基本契約番号（基本ＳＥＱ）、明細番号 【基本契約番号】【明細番号】【契約種別】【明細契約年月日】 　1　　　　　　　　1　　　　　S1　　　　　2013/05/05 　1　　　　　　　　2　　　　　S2　　　　　2013/05/10 　2　　　　　　　　1　　　　　S1　　　　　2013/05/05 　2　　　　　　　　2　　　　　S2　　　　　2013/05/10 　3　　　　　　　　1　　　　　S1　　　　　2013/05/05 　3　　　　　　　　2　　　　　S2　　　　　2013/05/10 　4　　　　　　　　1　　　　　S1　　　　　2013/06/05 　4　　　　　　　　2　　　　　S2　　　　　2013/06/10 　5　　　　　　　　1　　　　　S1　　　　　2013/06/05 　5　　　　　　　　2　　　　　S2　　　　　2013/06/10 　6　　　　　　　　1　　　　　S1　　　　　2013/06/05 　6　　　　　　　　2　　　　　S2　　　　　2013/06/10 　7　　　　　　　　1　　　　　S1　　　　　2013/07/05 　7　　　　　　　　2　　　　　S2　　　　　2013/07/15 　8　　　　　　　　1　　　　　S1　　　　　2013/07/05 　8　　　　　　　　2　　　　　S2　　　　　2013/07/15 　9　　　　　　　　1　　　　　S1　　　　　2013/07/05 　9　　　　　　　　2　　　　　S2　　　　　2013/07/15
ん～～～～～ Windows を再起動する。 件のアクセスファイルを開く。（他のアプリケーションは開かない） Alt + F11 を押してVBEの画面にし、コンパイルを行う。 （VBEのメニューから、デバッグ→○△のコンパイル） VBEは閉じて、念のためにリボンのデータベースツール→最適化 を行う。 フォームのコマンドボタンを押してみる。 これでもExcelが立ち上がらない・エラーも出ないのなら Set rsFrom = CurrentDb.OpenRecordset("集金明細", dbOpenSnapshot) 'クエリ名は出力したいのに適宜変更 クエリ名（"集金明細"）を指定していますが、 ここを適当なテーブル名にする。集金明細 → 適当なテーブル名 また、 上の行の前に msgbox "ここは" & screen.activecontrol.name と１行追加。 コマンドボタンを押してみる。 「ここは・・・」が出るか。 （・・・の部分がコマンドボタン名（コマンド40 になっているか確認） エクセルが立ち上がるか。 （下？のタスクバーも見てください） でどうでしょ？ 上記の変更二か所（テーブル名・１行追加）を行って コマンドボタンを押して、「ここは・・・」が出る。 ・・・はコマンド40 になっている。 にも関わらず エクセルが立ち上がらない、タスクバーにも現れないのなら 私は降参です。
状況がよくわからないのだけど、SQLを手で打っているので間違いない？ ＞select'a1','a2','a3'・・・・ ＞from 'テーブル名' ＞where 'a1'=abcde ＞order by ＞limit 0,30 もし本当にこのまま打ってたら間違いだらけ まずカラムやテーブル名を囲むならバッククォートを使ってください またwhere句でabcdeで絞り込むのならabcdeはシングルクォートで括ってください それとorder by をかくなら何らかのカラムを指定してください たとえばこんな感じ select `a1`,`a2`,`a3`・・・・ from `テーブル名` where `a1`='abcde' order by `a1` limit 0,30
No.1です。 各プロパティは私も同じでした。 「すべてのフィールドの固定解除」もやったり逆に固定もしてみましたが、 どちらでも、幅は固定できます。 確認なのですが、フォームビュー/レイアウトビュー/デザインビューのうちのレイアウトビューで幅を変更→上書き保存されてますでしょうか？ （該当のフォームのタブを右クリックして選ぶか、アプリケーションのウインドーの右下にある３つの小さいアイコンのうち、真ん中のものをクリック）
リンクテーブルはODBCで接続可能なデータベースであれば設定可能だったと記憶しています(ODBCは分かりますよね…？)。 そのため、ODBCで接続できない状況にある場合は出来ません。 GUIで操作したい、というだけならネイティブ接続が可能なフリーソフトがありますので、 クエリを発行するのが面倒でなければこちらでもいいかと思います。 http://www.hi-ho.ne.jp/tsumiki/ また、他の方が勧めているようにphpMyAdminなどを入れてみるのも手です。 ただしブラウザベースなのでaccessとは使い勝手はもちろん違います。 ちなみに、webサービスのシステムだとは思うのですが、管理画面はないんでしょうか？ 通常管理画面上でデータの追加や修正ができるようにするのが普通だと思いますが、 フロントエンドだけ作ってバックエンドは何もなしだったりすると、それはそれでシステムと見た場合にまずい気はします。 直接クエリを実行して変更することもありますが、経験上それはよほど大規模なデータ修正や構成変更があった場合のみです。
temp = dmax("表記", "T_時間帯", "開始 <= #" & Me.時間帯 & "#") でどうですか？
EXISTS句を使っても書けますね。 http://dev.mysql.com/doc/refman/5.1/ja/exists-an … DELETE FROM t2 WHERE NOT EXISTS(SELECT * FROM t1 WHERE t2.num = t1.num); 2行目は t2.num = t1.num となる t1 の行が存在しなかったら、という条件を表しています。
Accessは勝手にSQLを投げます。これはODBCなどの仕様にもなります。 要するにAccessは一人で使うもの。だからリソースをふんだんに使ってよいという設計になってます。 SQLサーバーに限らずOracleでも複数人で使うDBはPG側で考慮が必要なので、TBをスクロールするなどの処理は避けます。というような基本的な事は後で学んでください。 パフォーマンスを上げる事だけに特化すれば、まずその情報は何を基準に検索するのか。どのキーでビューを作成しているのか。 キー項目ならインデックスは自動で付加されますが、キー項目以外でリレーションを張る場合は、対象の項目にインデックスを張る。さらに検索対象の項目にもインデックスを張ります。 インデックスは多ければ今度は更新時に遅くなります。その辺はDB設計に考慮を組み込んでおきます。 またAccessはテーブルリンクは使わない。TBになるものを全てパススルークエリで作ります。 つまりAというTBをリンクするのではなく、SELECT * FROM Aというクエリをパススルー定義で作り参照するという苦肉の策です。本来は目的の情報だけをAccess側で扱うようにするため、SELECT　XXX,XXX,XXX,XXX from　A Where XXX = 'YYY' とちゃんとそのたびにクエリをパススルーで投げるのが一番です。そのためにはパススルークエリをADOXでそのたびに作成する必要があります。 そこまでやるなら、VBAで全て書き直しEXCUTEした方が早いです。 さらに早くするのはストアドプロシージャをSQL上に作成し、変数を投げて結果だけを取得するなどしてください。
関数の呼び出し方に問題があります。関数の呼び出し時には IN / OUT パラメータやデータ型の指定は不要です。 /* (1)の正方形について再帰処理 */ SELECT insert_square(kaisuu, count + 1, x1, y1, x3, y3); などと書き換えるとどうなるでしょうか。(2) ～ (4) についても同様です。 また、エラーメッセージが出力されていれば、提供してもらったほうが回答しやすいです。 あと、PostgreSQL には幾何データ型や幾何関数があるので、それらを使ったほうが関数をシンプルにできると思います。例えば、中心の座標を求めるcenterといった関数もあります。 参考URL：http://www.postgresql.jp/document/9.2/html/funct …
mysql の場合、auto_increment 属性を付けたら、何らかのindexも設定しないとエラーになるので、create table 出来てるのなら、primary key とか付けているのでは？phpmyadmin で作成したのなら自動付加してくれてるのでしょう。 index必要性について マニュアル参照 http://dev.mysql.com/doc/refman/5.1/ja/create-ta … コマンドラインクライアントでチェックするなら、show構文で show create table `tbl_name`;
クロス集計クエリの部分だけで良いですか？ クエリの表示結果は添付図の様になります。 テーブル名を ★★ と仮定します。 TRANSFORM First(Day(来店日)) AS 値 SELECT Year(来店日) AS 年, クライアントID FROM (SELECT Q1.クライアントID, Q1.来店日, Count(*) AS CT FROM ★★ AS Q1 INNER JOIN ★★ AS Q2 ON (Q1.クライアントID=Q2.クライアントID) AND (Format(Q1.来店日,'YYYYMM')=Format(Q2.来店日,'YYYYMM')) AND (Q1.来店日>=Q2.来店日) GROUP BY Q1.クライアントID, Q1.来店日) AS T1 GROUP BY Year(来店日), クライアントID, CT PIVOT Month(来店日) & "月"; ※ PIVOT Month(来店日) & "月" のまま 10月以降も表示しようとすると、順が狂います。 その時には、クエリ列見出しを設定してください。 たぶん、以下の様な感じに PIVOT Month(来店日) & "月" IN ("1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月") ※ 処理性能はわかりません ※ 不都合あれば修正してください
実行されたSQLのorder by句に項目が設定されていませんね。 phpMyAdminを使ったことがないので詳しく回答できませんが、 ソート順を設定するところあたりを確認してみてはいかがでしょうか。
PL/pgSQL であれば、INSERT/UPDATE 操作によって更新された新しい行の値を NEW.～～～ という形式で参照できます。 http://www.postgresql.jp/document/9.2/html/plpgs … パーティショニングの際の INSERT に対するトリガーの設定も参考になるかと思います。 http://www.postgresql.jp/document/9.2/html/ddl-p …
>$sql = 'SELECT * FROM anketo WHERE code='.$code; ダイレクトに$codeをクエリに書きこんでしまってはプリペアド処理になってない 何を参考にしているかわからないけど、その参考文献をもう一度よく 読みなおした方がよいと思います
簡単なのは 元レイアウトに「検索モード」というボタンを作ってレイアウト切り替え（レイアウト2へ） にしておく。 新規レイアウトでレイアウト2を作り、検索条件入力用のグローバルフィールドを置き その横に「検索実行」ボタンを配置。 検索実行ボタン用のスクリプトを作る。 　・切り取り　グローバルフィルド 　・レイアウト切り替え　元レイアウト 　・検索モードに切り替え　一時停止しない 　・貼り付け　検索するフィールドに 　・検索実行　条件を記憶しない 検索レイアウトに移動する部分を新規ウインドウにしてウインドウサイズ変更などを 加えると、よりそれらしくなります。 検索実行スクリプトは検索しても該当するレコードが無かった場合等のためのエラー 処理も考えて下さい。
> >MySQLに直接接続すること > http://localhost/phpmyadmin/で > phpmyadminを呼び出すことでしょうか？ 違います。 まあ、phpMyAdminが正常に動作してれば問題はありません。 MySQLは別にPHPにもApacheにも依存しているわけではないので、 mysql -u root -p などというコマンドを実行することでコマンドライン上で直接 操作できます。 http://y-kit.jp/saba/xp/mysqltry2.htm そこでログインできないならば、MySQLが稼働していないorユーザー名、 パスワードに誤りがあるなどとなります。 > >初めてPHP(Wordpress)の設定を確認し > phpmyadminで確認が取れるものでしょうか？ phpMyAdminが正常に動作しているならばOKです。 当然、事前にWordpress用のデータベースも作成するでしょう。 >MySQLに接続できるか > phpmyadminから接続するための方法を記した > 参考サイトなどございますでしょうか？ そもそもお使いのOSが何だか分かりません。 調べればたくさん出てきますので、自分に近い環境のものを 参考にすれば良いと思います。 https://www.google.co.jp/search?num=20&hl=ja&saf … 順序としては以下のようになります。 １．MySQLは正しく稼働、およびログイン可能か。 ２．phpMyAdminで正しくログイン可能か。（本来不要ですが、phpMyAdminを動作させたいみたいなので） ３．Wordpress用のデータベース、ユーザーは存在するか、及び、そのアクセス権限は適切か。 ４．Wordpressのデータベース接続情報は適切か。（wp-config.php） この辺は、グラフィカルに説明していて分かりやすいかもしれません。 http://www.adminweb.jp/wordpress/install/
DELETEの書き方は下記の方法ですので間違えないで下さい。 DELETE FROM [ ONLY ] table [ WHERE condition ]
phpmyadminデータベースを削除したのであればシステムにかかわる部分が ダメになっている可能性が高いです。 修復の方法はないことはないですが、始めたばかりであればxammpの 再インストールした方がはやいかもしれません
やはり先の回答で書いておくべきだったかもしれませんが、 質問にある例では各ユーザーが別々のレコードに書き込みをしていますよね。 この場合だとお互いの書き込みが他のユーザーの書き込みに影響を及ぼさないのでロックを取る必要が無いと思います。あと、ちょっと気になったので調べた感じだと、UPDATEで更新する場合もロックは不要みたいですね。 > 何も指定しないで下記の方法でテーブルをつくりました > この場合は、MyISAMになるんですか？ そうです。 InnoDBを使うにはテーブル作成時に明示する必要があります。 http://dev.mysql.com/doc/refman/4.1/ja/using-inn … > その場合、自動でテーブルロックしてくれるってことでしょうか？ してくれません。 自分で明示的にテーブルをロック / アンロックしてください。 http://dev.mysql.com/doc/refman/4.1/ja/lock-tabl … あと、MyISAMはトランザクションセーフテーブルではないので、いわゆるトランザクションには使えないと思います。トランザクションの場合はCOMMITをするまで値が反映されてはいけませんので。 http://dev.mysql.com/doc/refman/4.1/ja/commit.html http://dev.mysql.com/doc/refman/4.1/ja/table-typ … > みなさんはphpやperlからmysqlを使う場合は、どのテーブルを使っていますか？InnoDBを使うのが一般的なのでしょうか？ MyISAMが一般的だと思いますが、適材適所ではないでしょうか。 例えばwordpress (http://ja.wordpress.org/) ではデフォルトのMyISAMを使っているようです。 自分が見た範囲では特にLOCK TABLESも登場しないように思います。 UPDATEは時々出てきますが、UPDATEによる更新はアトミックな処理になるようなので行の更新をする程度ならロックを取る必要はないのかもしれません。 http://dev.mysql.com/doc/refman/5.1/ja/ansi-diff … かつてMySQLを選ぶ理由はトランザクションがない代わりに速いということだったので、色々と工夫をしてMyISAMを使うというのが普通なのかもしれません。しかしながら、MyISAMにはトランザクションの機能がないので、InnoDBを普通は選ぶべきという意見もあります。 Top 10 MySQL Mistakes Made By PHP Developers http://www.sitepoint.com/mysql-mistakes-php-deve … | 1. Using MyISAM rather than InnoDB ただ、この記事へのコメントでDavidさん他多数がMyISAMよりInnoDBは非常に遅くて使いものにならないし、DBの設計を適切にすればMyISAMでも問題なく使えると主張しているので、InnoDBを使えば万事解決というわけでもないようです。
普通（かどうかは知りませんが）こういう要件のときは、 部屋ID=A で '2013-03-22 11:00:00' から '2013-03-22 15:00:00' と画面で入力されたとすると、 SELECT count(*) FROM 予約テーブル WHERE 部屋ID=A AND 開始時刻<'2013-03-22 15:00:00' AND 終了時刻>'2013-03-22 11:00:00' の結果が0でなければ重複しているとしてエラーにします。 00:00は含まれないので、データの持ち方は、00分00秒でＯＫです。 なにをやっているかの補足： AND 開始時刻<'2013-03-22 15:00:00' は、開始時刻が入力した終了時刻以降のものは関係ありません。 （今回の予約時間が終わってから始まります。） AND 終了時刻>'2013-03-22 11:00:00' は、終了時刻が入力した開始時刻以前のものは関係ありません。 （今回の予約時間が始まる前に終わってます。） ⇒上記以外とは、今回の予約時間が終わる前に始まり（今回の予約開始前か予約開始後かは問わない） 今回の予約時間が始まる前には終わっていない（今回の予約終了後か予約終了前かは問わない） 予約が既にあるということを調べています。
DataRowのRowStateがModifiedになっているから。 DataRow.SetAdd()でRowStateをAddedに変える。
NOが主キー、CDとDATEはCD1・DATE1から順に設定されていくという前提で、 select COUNT(*), CD1, CD2, CD3 from ( --DATE1、DATE2、DATE3の全てが一致 select T1.CD1, T1.CD2, T1.CD3 from T T1 where exists ( select * from T T2 where T1.NO <> T2.NO and (T1.CD1 = T2.CD1 and T1.DATE1 = T2.DATE1) and (T1.CD2 = T2.CD2 and T1.DATE2 = T2.DATE2) and (T1.CD3 = T2.CD3 and T1.DATE3 = T2.DATE3) ) union all --DATE1、DATE2のみが一致 select T1.CD1, T1.CD2, null from T T1 where exists ( select * from T T2 where T1.No <> T2.NO and (T1.CD1 = T2.CD1 and T1.DATE1 = T2.DATE1) and (T1.CD2 = T2.CD2 and T1.DATE2 = T2.DATE2) and ((T1.CD3 is null and T2.CD3 is null) or ((T1.CD3 = T2.CD3) and ((T1.DATE3 <> T2.DATE3)))) ) union all --DATE1のみしかデータがない select T1.CD1, null, null from T T1 where T1.CD2 is null ) group by CD1, CD2, CD3; とか。 やりたいことを正しく理解できているか分かりませんが。
php.iniの設定やhtml側での文字コードの設定にも依存するので、これだけの情報ではズバリ回答が難しいですが、 MySQLの文字コード設定がcp932とutf8が混在しているようですね。 文字化けを防ぐために、webシステムは「統一された文字コード」で開発される事が多く、 最近ではUTF-8が主流ですのですべてUTF-8で統一されることをおすすめします。 MySQL、php、HTMLがすべてUTF-8であれば、ほとんど文字化けに悩まされることはなくなると思います。
>■内容を再編集する時、htmlタグを無効化しつつ、再編集する方法 PHPで編集するというからにはhtml画面上で処理をすると考えてよいですね？ であればtextareaにhtmlspeacialcharsで処理した文字列を入れて 編集させるのが一般的でしょう。 >■データベース登録時、プリペアドステートメントで、\（円マーク）がついてしまう事の対処方法 SJISの5C問題あたりを気にしているのでしょうか？ もし万が一DBのキャラクターセットをSJIS系にしようと考えているなら やめた方がいいでしょう。 UTF8なり適切な文字コードを利用して、入出力の際に文字コードの コンバートをかけることで問題は最小化することができます。 また見た目上エスケープした文字が登録されても、PHPで抽出して出力するときには アンエスケープされた状態で取り出せるとおもいます
なんかうまく伝わってないみたいで、すみません。 POSTでidを送りつけてデータが削除できるなら、 ユーザーが1から順番に100番、1000番・・・と適当におくってきたときに 全部消されちゃいますよという意味です。 インジェクションの場合、SELECT文の参照時に、不正にUPDATEやDELETE されないような処理とか、本来アクセスできないSELECT文にオールの パラメータをあたえて不正にデータを引き出すのを防ぐ処理なので DELETE文などは特殊な権限をもったユーザーに処理させるために リンクを調整するところから入ると思います
最新のバージョン9.2であっても、PL/pgSQL では SELECT INTO は使用できません。(下記ページの注釈参照) http://www.postgresql.jp/document/9.2/html/sql-s … したがって、SELECT INTO の様なことを行う場合は CREATE TABLE AS に書き直してやる必要が有ります。 また、PL/pgSQL 内で動的にSQLを生成して実行する場合は EXECUTE を使う必要性が有るようです。 http://www.postgresql.jp/document/9.2/html/plpgs … 例) BEGIN EXECUTE 'CREATE TABLE ret_val AS SELECT * FROM ' || t_name::regclass || ' OFFSET ' || ofs_num || ' LIMIT ' || lmt_num; END;
将来にわたっても自分以外は使わない、現時点でも複数の人が同時に使わない、データベース容量最大２GBを超えない、のであればそのまま使方い続けた方が良いです。そうでなければ、ACCESSはJIS規格に成っていないので、JIS規格となっているSQLとC言語、C#等で再構築されると良いです。つまり、SQL　Serverへの移行とプログラムの再構築をお勧めします。
新しいクエリを使ってＳＱＬ文を組み立てて下さい。下記はキーが２項目データーが２項目の場合の例です。 delete from tbl_new where not exists(select ' ' from tbl where tbl_new.キー1=tbl.キー1 and tbl_new.キー2=tbl.キー2) go update tbl_new set データ1=tbl.データ1,データ2=tbl.データ2 from tbl_new,tbl where tbl_new.キー1=tbl.キー1 and tbl_new.キー2=tbl.キー2 go insert tbl_new select * from tbl where not exists(select ' ' from tbl_new where tbl_new.キー1=tbl.キー1 and tbl_new.キー2=tbl.キー2) go です。
(1)～（5）の設定でやりたいこと(1)(2)は満たせます。 「すべてのデータベースにバクアップファイルを作成する。」でバックアップごと、データベース毎に 異なるファイル名でバックアップが作成されます。 やりたいこと(3)の削除はご認識の通り、クリーンアップタスクで行えます。 バックアップの有効期限を設定する必要はありません。
>INTで（６）としても >試しに１０桁を入れても（phpmyadminで直接） >入ってしまいます。 INTの桁数はUNSIGNED ZEROFILL属性をつけた際にゼロ埋めするための桁数です。 >試しにと思ってINTのところに >”あいうえお”を入れても入ってしまいます。 それはない、勘違いでしょう。 >桁数の設定は（10）までは意味があっても、(11)以上に >しても意味がないのでしょうか？ 前述の通り有効桁数ではなく表記上の桁数なので、 よほど特殊な使い方を想定していなければ気にする必要はありません。 >INT（１１）に上限数値の4294967295をいれると >何が起こるのですか？ 普通に入力される以外なにもおきません。 そういうのはご自身でためしてみるが一番です ◇最後にもうひとつ >Name` varchar(32) NOT NULL default '', >NOT　NULLとは、ヌル値は認めないというのに、 >defaultは””（ヌル）で設定ができてしまう。って >矛盾してませんか？それとも私の解釈が間違っていますか？ 基本を理解していないようで、完全に間違っていますね。 実際「」とNULLは排他的な関係ではなく必要に応じて共存できます。 具体的にはNULL指定すると「空ですよ」いう情報が入ります。「」は文字の長さが0の文字情報が入ります。 LENGTHで長さを拾う時LENGTH(NULL)はNULLを返しLENGHT('')は0を返します。 カウントを取る時に、「」はカウントの対象となりますがNULLはカウントの対象外です。 たとえばあるテーブルのXというカラムに10個のデータが保持されているとき NULLのレコードが3件あれば、SELECT COUTN(X) FROM テーブルすると 7件しかレコードが拾えません。 また、NULLへのアクセスはIS NULLなどで評価を行うなど NULLというのは特徴のある属性ですので、きちんと理解を深める 必要があります。
基本的に本で独学でした。 当時主に参考にしたのは ・標準ＳＱＬガイド（C.J.DATE　アスキー） ・ＳＱＬ９２／９９標準リファレンスブック（マーチン・グルーバー　ピアソン・エデュケーション ・プログラマのためのSQL（ジョー・セルコ）　SQL92・99準拠 ・SQLパズル ・Oracle8i&UNIXパフォーマンスチューニング ・ＯＲＡＣＬＥハイパフォーマンスチューニングＳＱＬ編 ・ORACLE9i ハイパフォーマンスチューニング―STATSPACK編（廃版） ・データベースパフォーマンスアップの教科書 基本原理編 あたりでしょうか。「SQLパズル」は「SQLでこんなことができるのか」と驚かせてくれましたが、一方で「何でも無理にSQLで処理するのは避ける」きっかけになりました。 パフォーマンス・チューニングは学ぶと奥が深いですね。OSやストレージ、ネットワークの総合的な知識が求められます。 今は開発ライセンスでOracleを自分のPCにインストールして試せますし、GUIで実行計画が見られるSQL Server の Express版もあります。 実際にSQLを結構簡単に試せるので本を読みながらSQLとその実行計画を確認したりすることをお勧めします。
>１．仕様書の読解方法 何度も読みます。 >２．独学方法 文法は簡単なので、確実に全ての文法を理解する事です。 >３．参考ホームページ 特にありません、文法が簡単なので、後は知恵を使う必要があります。 >４．仕様を自分で考えて作る時の対象システム リレーショナルデータベースを扱うのでほとんどが事務処理関連のシステムです。 >５．SQLのよくある仕様パターン 同じテーブルを何度も形を変えて使うパターンが多いです。また、CASEを使用する場合が多いです。 >６．ユニークなSQL文のサンプル 文法が単純なのでユニークな物はほとんど有りません。ただし、RDBMS毎に仕様が異なるので注意が必要です、特に複数テーブルを使ったUPDATE文はRDBMS毎に、まさにユニークです。 >７．仕様プラスSQL解答例が載っているようなホームページOR参考書 無いので、全て自分の頭で考えています。しいて言えばそのRDBMSのSQLリファレンスです。
・3秒毎 ・REDOログバッファが3分の1になった時 はいずれもトランザクションがコミットされているという保証はありません。 逆に言えば、コミットされた時点で「このトランザクションはコミットされた」という情報もログファイルに書き込んでいるのです。 (6)name列確認 結果⇒test01 のタイミングではコミットされていませんので、UNDOデータを読みに行って「test01」を返しています。
Accessは手元に無いのでExcelで試しましたが、配列kyoku()に曲のパス、kyokusuに曲数が入ってるとして、 pathWMP = """C:\Program Files (x86)\Windows Media Player\wmplayer.exe""" pathPlayList = "C:\Users\△△\Desktop\test.wpl" Dim kyoku(10) kyokusu = 2 kyoku(1) = "C:\～1.mp4" kyoku(2) = "C:\～2.mp4" Open pathPlayList For Output As #1 Print #1, "<?wpl version=""1.0""?>" Print #1, "<smil>" Print #1, " <head>" Print #1, " <title>～</title>" Print #1, " </head>" Print #1, " <body>" Print #1, " <seq>" For i = 1 To kyokusu Print #1, " <media src=""" & kyoku(i) & """/>" Next i Print #1, " </seq>" Print #1, " </body>" Print #1, "</smil>" Close #1 Shell (pathWMP & pathPlayList) とかで再生できました。 幸いと言うか、自分の環境だと繰り返し実行してもプレイリストのファイル名とかタイトルとかが履歴に残らないみたい？
「オブジェクト・・・・・が見つかりませんでした」 "・・・・・" が最大のヒントだと思うのですが、、、 そんでその mdb を開いたときに期待する本来の動作はどうなのか、と。 どこかに置いてあるテキストファイルとかを自動的にインポートするようにしてあるとか、何か外部との連携を取ろうと設定してあるとかね。 その外部に置いてある何かへのパスが今回の PC から見つからない場所になってしまっているとか。
SELECT フィールド１,フィールド２,max(フィールド３) from hoge group by フィールド１,フィールド２ って感じでどうでしょう。
正規化は目的ではなく手段です。 何をしたいかビジョンがないなら、正規化しないで冗長なデータでも さほど問題はありません。 たとえば管理画面をつくったとして、セレクトボックスで選ばせたい項目が あるなら正規化するしたほうがよいです
そのフォームは単票でしょうか。 帳票なら以下の方法ではできません（コントロールを重ねないと不可能だと思います。） 現状のフォームをコピーし、コピーした方で動作確認してみます。 レコードが更新されても良いようにバックアップは取っておきます。 コピーした方のフォームに記述してあるイベント関係のものをすべて削除し、 以下の記述と置き換えてみます。 Private Function EnterCheck() 　　Dim vN As Variant 　　Dim i As Long, j As Long 　　vN = Array("大分類", "中分類", "小分類") 　　For i = LBound(vN) To UBound(vN) 　　　　If (Me.ActiveControl Is Me(vN(i))) Then 　　　　　　For j = LBound(vN) To i - 1 　　　　　　　　If (IsNull(Me(vN(j)))) Then 　　　　　　　　　　Me(vN(j)).SetFocus 　　　　　　　　　　Exit Function 　　　　　　　　End If 　　　　　　Next 　　　　　　Exit For 　　　　End If 　　Next 　　With Me.ActiveControl 　　　　.Requery 　　　　.Dropdown 　　End With End Function Private Function UpdateCheck() 　　Dim vN As Variant 　　Dim i As Long, j As Long 　　vN = Array("大分類", "中分類", "小分類") 　　For i = LBound(vN) To UBound(vN) 　　　　If (Me.ActiveControl Is Me(vN(i))) Then 　　　　　　For j = i + 1 To UBound(vN) 　　　　　　　　Me(vN(j)) = Null 　　　　　　Next 　　　　　　If (i <> UBound(vN)) Then 　　　　　　　　Me(vN(i + 1)).SetFocus 　　　　　　　　Exit Function 　　　　　　End If 　　　　　　Exit For 　　　　End If 　　Next End Function Private Sub Form_Load() 　　Dim vN As Variant 　　Dim i As Long 　　vN = Array("大分類", "中分類", "小分類") 　　For i = LBound(vN) To UBound(vN) 　　　　With Me(vN(i)) 　　　　　　.ValidationRule = "Is Not Null" 　　　　　　.OnEnter = "=EnterCheck()" 　　　　　　.AfterUpdate = "=UpdateCheck()" 　　　　End With 　　Next End Sub Private Sub Form_BeforeUpdate(Cancel As Integer) 　　If (IsNull(Me.小分類)) Then Cancel = True End Sub ※※ 操作は、必ず　"大分類" → "中分類" → "小分類"　の順であるとします。 ※ Enter 時の動き どのコンボボックスの Enter でも同じ処理を走ります。 まず、Enter になったのは「誰」を求めます。 求まったら、前操作のコンボボックスが入力されているか確認します。 値が設定されていなければ、そのコンボボックスにフォーカスを移動します。 値が設定されていれば、 Requery 後 Dropdown 表示します。 ※ AfterUpdate 時の動き どのコンボボックスの AfterUpdate でも同じ処理を走ります。 まず、AfterUpdate になったのは「誰」を求めます。 求まったら、後操作のコンボボックス値を Null に変更します。 次のコンボボックスにフォーカスを移動します。 ※ フォームのオープン時 各コンボボックスに上記関数を実行する様、イベントに設定していきます。 また、入力規則に念のため Is Not Null を設定しておきます。 既に値が設定されていて、Delキー 等で削除された場合エラーとなるように・・・ ※ フォームの更新前処理 コンボボックスは、必ず　"大分類" → "中分類" → "小分類"　の順と決めたので、 最後の Me.小分類 が Null なら Cancel = True として、更新を拒否します。 ※ コンボボックス３つの処理をまとめましたが、個別に記述しても良いと思います。 ※※ 検証等は十分に行ってください。また、不具合等あれば修正してください。
つうか、エクセルをデータベースみたいに使うほうがよっぽどつかえない。 エクセルの表でVlookup関数が使いたくなったら、私は迷わずアクセスにする。 エクセルで何とかできる程度のことなら、そんなに構えなくても、気軽にアクセスが使えるよ。 #1さんのご意見にことさら意を唱えるつもりはないけど、でも、ちょっと大げさじゃないかなぁ。 まずはクエリをつかえるようになればいいと思うな。 クエリこそがデータベースのかなめだからね。 とはいえ、みんなが使いたくないものを無理やりに使わせるわけにはいかない。 みんな新しいことを覚えたくないんだよ。 察するところ、エクセルおじさんばっかがいる職場じゃない？ワードを使う場面でも、パワーポイントを使う場面でもみんなエクセルで押し通す人のことを言っているんだけど。 余談だけど、そういう人がエクセルのことよく知っているかというとそうじゃなくて、ピポットテーブルとかいうと、？？？？？？ だったりするんだね。 そうそう、いきなりアクセスに飛ばずに、ピボットテーブルを作ってみるのも手だよ。 そういう性質の表なら、だけど。 あとは、いつまでもエクセルにしがみついている人は、そのままにしておいてあげて、あなただけアクセスに移行することもできるかもしれない。 エクセルのシートをアクセスから呼び出すことができるから(アクセスにリンク貼り付けする)、データはエクセルに入れたままにして、データの処理はアクセスでするんです。 もっともシートが、きちんとデータベースで処理できる形式になってなければいけないですけどね。
データベースファイルというのは SQLサーバーが使用するデータを格納するファイルです。 (拡張子は データ用 MDB,NDB ログ用 LDB です。) 一般的にはデータベースにアクセスすると言うことは SQLサーバーの様なデータベースソフトに対してアクセスします。 データ操作と言う意味では、データベースファイルに直接アクセスすることはありません。 説明にもあるように SQLサーバーA から データベースX をデタッチすると データベースX に使用しているデータベースファイルはフリーになります。 そのデータベースファイルを別のSQLサーバーBに持っていき アタッチすると、データベースX が使用できるようになります。 データベースファイルを操作するのはこういった特殊な場合だけです。 プログラミングの勉強と言う意味では データベースファイルは使用しないと思って良いでしょう。
Outlook は使ったことがないので予想ですが、、、 Outlook のセキュリティ レベルが高すぎるとか、ユーザーに代わって外部プログラムからメールを送信することを許可しない設定になっているとか。
＞(1)で動いていたものを(2)にしたら、動かなくなりました そういうのはprint $sqlしてみて見比べればわかりますよね？ '%s' のところにシングルクォーテーション付きの文字列を入れれば クォーテーションがダブってます。 あまりお勧めできませんが、あえてやるなら元文字列のシングルクォーテーションを はずしてみればよいのでは？ $sql = sprintf("SELECT id , password FROM `adminDatabase` where id = %s and password = %s order by id",$id , $password );
質問通りにSQL作るとこんな感じ SELECT MIN(t.個別ID) 個別ID, t.グループID, t.順位, t.個数 FROM table_1 t INNER JOIN (SELECT a.グループID, MAX(a.個数) 個数 FROM dbo.Table_1 a GROUP BY a.グループID) ex on ex.グループID=t.グループID AND ex.個数 = t.個数 GROUP BY t.グループID, t.順位, t.個数
> WEB上で検索すると、select実行時にもロックを取得し 「ＤＢ２　SQL for update」でググると先頭に出ました。 ここのことだったらごめんなさい。 参考URL：http://www.atmarkit.co.jp/fdb/rensai/rdbmsarc04/ …
非数字の部分の文字数が決まっていれば可能です。 SELECT * FROM ～ WHERE SUBSTRING(書籍名,1,4), SUBSTRING(書籍名,5)*1 SUBSTRING(書籍名,5)*1 は書籍名の5文字目以降を 数値化する表現です。但し、非数字があると0になって しまいます。 書籍名の先頭の非数字部分の文字数が不定だと、 考えられる字数の範囲でUNIONクエリにするしか ないと思います。
>Cannot find a J2SE SDK installed at path:C:\Program Files\Java\jre6. とあるようにJDKをインストールする必要がありますが、指定したパスはJREのようですよ。 >Sqldeveloperはデスクトップ上から起動させていますが、そもそも64bit版の場合はどこのフォルダへ 格納するのが正しくて 64bit版に関わらず、インストールガイドにあるように好きなフォルダでいいのではないでしょうか。 http://docs.oracle.com/cd/E38764_01/doc.32/b7021 …
「mysql_real_escape_stringを使うな」というのが正論なのですが、 ＞もろもろの事情で仕方なくmysql_real_escape_stringを ということなので、回答しようかと思いましたが、(2)のようなプログラムを書く人であれば、やはり、生のmysql関数は使ってはいけません。 ＞PDOを利用し、プリペアドステートメントで処理する でしょうね。それ以前にPHPの基本的な事柄についての理解を深める必要があります。 ＞$sql = sprintf("SELECT id , password FROM `adminDatabase` where id = '%s' and password = '%s' order by id",’mysql_real_escape_string($id)’,’mysql_real_escape_string($password)’); を実行すると、$sql は、 SELECT id , password FROM `adminDatabase` where id = 'mysql_real_escape_string($id)' and password = 'mysql_real_escape_string($password)' order by id になりますよ。
商品番号&"_"&色 などという計算フィールドを作って、これでソートするとGetSummary も使えます。 別テーブル（重複の無い商品マスタのような）からリレーションで集計した方がいいかも。
TABLEとINDEXで同じSEGMENT_NAMEの場合もあるので、SEGMENT_NAMEではユニークにならないです。 たぶんSELECTする際にはSEGMENT_TYPEを指定するのでしょうから、これで重複する事はあまり無いと思いますが。 上記以外でも、パーティション表の場合、 各パーティションのSEGMENT_NAMEは同一になり、PARTITION_NAMEにそれぞれのパーティション名が入るようです。 当方の環境は10g XEなので、パーティション機能を利用することは出来ないのですが、 DBA_SEGMENTSを見てみたらSYSAUX表領域にそのようなデータがあることが確認できました。 参考になれば幸いです。
select テーブルＡ.カラム１, テーブルＡ.カラム２, max(テーブルＢ.カラム２) from テーブルＡ, テーブルＢ where テーブルＡ.カラム１ = テーブルＢ.カラム１ group by テーブルＡ.カラム１, テーブルＡ.カラム２;
>>時間とお金がないので可能な限り効率的な順序で勉強をしたいのですが、これからPHPとDBを扱うには何をどういう順番で勉強するといいのでしょうか？また他にアドバイスがあればよろしくお願いします。 学習に王道はありません。私の経験上、お金をかけて学校に行くとか、セミナー等に出れば、その分、早く学習できると思います。 もちろん、無償セミナーと有償セミナーでは、やはり教える側の気合いの入り方も違いますし、教材にも違いがあると思います。 また、専門書などはやや高価ですが、それらを買わないわけにはいきません。 学習するには、足りないと思う部分を、ひとつずつ基礎から順番に学んでいくしかないと思います。 >>（クラスだの、オブジェクト指向だのが全くわかりません、またフレームワーク、その他難しいことは、基礎を覚えた後にやらないと結局痛い目にあうものでしょうか？ これらも、上記と同様に、時間・お金をかけて学んでいくしかないと思います。 また、PHPの知識なく、PHP用のフレームワークを学んでも意味ないと思いますので、当然ながら基礎を固めたあとに応用を学ぶことになると思います。 極端な言い方をすれば、「専門学校、あるいは情報系の大学で学ぶと、お金と時間がかかる。お金と時間をできるだけかけずに、そこの卒業生と同レベルになりたい！」ってのが質問者さんの希望だと思います。 もっと言えば、小学１年生の子供を持つ親が「大学を卒業させるまでの学費もそこまで育てる時間もない！小学校から高校までの教科書等は全部あります。さしあたりあと１年で子供が高卒レベルになる方法を教えてください！」っていうような願いかもしれませんね。 いくら焦っても子供を１ヶ月で産むことができないのと同じだと思います。 それから、このＩＴ系って、職人っぽい部分があると思います。すごく頭がよくて本を一度読めば、覚えてしまう人がいたとします。そんな人であれば、ＰＨＰの専門書を１日で読み切ることが可能だと思います。でも、それでＰＨＰのプログラムが作れるようになるか？というと、できないような気がします。それは、カナヅチの人が、泳ぎ方の本を１日で読み切っても、泳げるようになれないのと同じだと思います。 ちなみに、わたしも、「自分でレンタルサーバを借りて、独自ドメインとって、そこにＯＳをインストールして、Ｗｅｂサーバやアプリケーションサーバ、メールサーバを設定して・・・」と思って調べ始めると、知らないことがイロイロと出てきて、「どうしよう・・」と思ったものです。結局は、腰を落ち着けて、関連する参考書籍を購入して、試してみて、すこしずつ学んでいくしかありませんでした。
まず気になったのがそのrpmパッケージはどこから持ってきた物か? そのrpmパッケージは質問者が使っているディストリビューションに適合する物なのか? ディストリビューションに適合しないrpmパッケージなら.src.rpmを利用して ディストリビューションに適合したパッケージを作る必要がある。 ディストリビューションに適合していないと変なところにパッケージがインストールされたり データベース関連のファイルが置かれる場所がディストリビューションによって想定されている 場所と違う場所に設置されたりする可能性がある。
Bツリーは索引(INDEX)によく使われるデータ構造ですね。 索引を使うことのメリットは#1, 2さんが書かれている通りです。 索引によく使われるデータ構造は他に、ハッシュテーブルやビットマップ・インデックスなどが有りますが、それらに対してBツリーは汎用性の高さがとりえと言えるでしょう。弱点が少なく、多くの用途に適していて、ほとんどの探索・更新操作に対してそこそこの性能が期待できます。 下記のページが参考になるかと思います。 http://gihyo.jp/dev/serial/01/sql_academy2/000701
欠落するデータに規則性はあるんですか？ キーの重複とかは？
文字コードの何を知りたいのでしょうか？ 文字コードについての全般的なことを知りたいのだったら、下記のページが参考になるかと。 http://ja.wikipedia.org/wiki/%E6%96%87%E5%AD%97% … http://itpro.nikkeibp.co.jp/article/COLUMN/20061 … http://euc.jp/i18n/charcode.ja.html
syscmd(acSysCmdRuntime) で取得できますよ。
プロシージャの実装方法ですよね？ こちらの例のように、配列で受け取って表関数を使用するようにしてはいかがでしょうか。 http://www.shift-the-oracle.com/plsql/table-func …
いちお～こちらのかんきょう（10gXE）でかくにんしてますけど～（笑） SQL> with data as ( 2 select '0001' code, '3-15' "date", 'A' status from dual union all 3 select '0001' , '3-15' , 'B' from dual union all 4 select '0001' , '3-15' , 'C' from dual union all 5 select '0002' , '3-15' , 'A' from dual union all 6 select '0002' , '3-15' , 'B' from dual union all 7 select '0003' , '3-15' , 'B' from dual union all 8 select '0004' , '3-15' , 'A' from dual union all 9 select '0005' , '3-15' , 'C' from dual 10 ) 11 select code from data 12 where "date" = '3-15' 13 group by code 14 having 15 0 < sum(case when status = 'A' then 1 else 0 end) 16 and 17 0 < sum(case when status = 'B' then 1 else 0 end); CODE -------- 0001 0002 SQL> with data as ( 2 select '0001' code, '3-15' "date", 'A' status from dual union all 3 select '0001' , '3-15' , 'B' from dual union all 4 select '0001' , '3-15' , 'C' from dual union all 5 select '0002' , '3-15' , 'A' from dual union all 6 select '0002' , '3-15' , 'B' from dual union all 7 select '0003' , '3-15' , 'B' from dual union all 8 select '0004' , '3-15' , 'A' from dual union all 9 select '0005' , '3-15' , 'C' from dual 10 ) 11 select code from data 12 where "date" = '3-15' 13 group by code 14 having 15 0 < sum(case when status = 'C' then 1 else 0 end) 16 and 17 0 = sum(case when status = 'C' then 0 else 1 end); CODE -------- 0005 1)でandをorに変えると別のSQLになっちゃいますよ。
変てこな考えかも（処理性能は考えてませんので・・・） 除外する・・・これは結構厄介なものと思います。 タイムスライスして、ある・ない・・・で結果を得ても良いのかも フィールド「時刻」（日付/時刻型：主キー）のみのテーブル「T時刻」を作り、 0:00 ～ 23:59 までのデータを入れておきます。（60 * 24 = 1440 レコード） この「T時刻」を基準に、対象者の予定日と開始時間、終了時間を結び付けて、 その結果、結びついていない時刻をグルグルとみて、空きの開始、終了を処理すれば・・・ 元テーブル名を★★と仮定すると SELECT Q1.時刻 FROM T時刻 AS Q1 LEFT JOIN (SELECT * FROM ★★ WHERE 予定日=#2013/3/1# AND 氏名='AAA') AS Q2 ON (Q1.時刻 Between Q2.開始時間 AND Q2.終了時間) WHERE (Q2.氏名 Is Null) AND ((Q1.時刻 Between #8:40# AND #12:00#) OR (Q1.時刻 Between #13:00# AND #18:00#)); の様な感じで・・・・ 得られる結果は、10:01 ～ 12:00 の 120レコードと 14:01 ～ 18:00 の240レコード 全体で 360レコードになるので、360分空いている事がわかります。 ただ、注意しないといけないのは、時刻の境目・・・・ 例えば、上記の空きで 15:00 ～ 15:30 を予定に入れたら、 14:01 ～ 14:59、15:31 ～ 18:00 に分かれます。 ということは、レコード数＝分　ではなくなる？ そこで、開始と終了の時刻が重ならないように、終了の方を１分前にします。 SELECT Q1.時刻 FROM T時刻 AS Q1 LEFT JOIN (SELECT * FROM ★★ WHERE 予定日=#2013/3/1# AND 氏名='AAA') AS Q2 ON (Q1.時刻 Between Q2.開始時間 AND DateAdd("n",-1,Q2.終了時間)) WHERE (Q2.氏名 Is Null) AND ((Q1.時刻 Between #8:40# AND #11:59#) OR (Q1.時刻 Between #13:00# AND #17:59#)); これで得られる結果は、10:00 ～ 11:59 の 120レコードと 14:00 ～ 17:59 の240レコード 上記の空きで 15:00 ～ 15:30 を予定に入れたら、 14:00 ～ 14:59、15:30 ～ 17:59 に分かれます。 （レコード数＝分　でしょうか） (Q1.時刻 Between #8:40# AND #11:59#) は、 (Q1.時刻 >= #8:40# AND Q1.時刻 < #12:00#)　の方が考えやすい/指定しやすいかも・・・ 上記を指定して Recordset を得て、グルグル回して、時刻差が 1 分でなかったら 開始の時刻はそのまま・・・ 終了の方は1分加算・・・・ で、求まっていくと思います。 空きの時間帯が複数あっても、グルグル回る時の処理を考えれば良いと思います。 また、どんな時間帯で登録されていようが、求まったものを処理するだけです。 ※ 上記では 1分間隔で「T時刻」内を作成していましたが、入力が 10分単位とかなら、 登録しておく「時刻」も 10分間隔で良いと思います。 グルグル回る時には、時刻差が 10分でなかったら・・・・とか ※ 上記記述をクエリとして作成した場合 保存・閉じた後、再度SQLビューで覗くと ON (Q1.時刻 Between Q2.開始時間 AND DateAdd("n",-1,Q2.終了時間)) 部分は ON Q1.時刻 Between Q2.開始時間 AND DateAdd("n",-1,Q2.終了時間) の様に ( ) が外れます。 編集等しなければ何も影響ありませんが、編集した後保存しようとするとエラーになります。 その時には、消えた ( ) を付け直してください。 （何故なのか・・・・わかりません） ※ 冒頭でも記述しましたが、処理性能は考えてませんので・・・
> Me.Recordset.FindFirst "[社員番号]=" & Num 検索するのは親フォームではなくサブフォームですから 　Me.SF1.Form.Recordset.FindFirst "[社員番号]=" & Num だと思います。（未検証、まちがっていたら御免。）
単純に権限付与するならsysadminで、 GRANT exec ON xp_cmdshell TO <SQLLogin> ですが、この辺はある種のFAQで、もう一手間、二手間必要かもしれません。 http://www.atmarkit.co.jp/bbs/phpBB/viewtopic.ph … http://ameblo.jp/sql-server/entry-10292432498.html http://bokuibi.blogspot.jp/2009/06/sql-server.ht … http://support.microsoft.com/kb/890775/ja バージョンや認証方法でも対処法が変わります。 とは言え、（私は、仕事で使っていたのは2000が最後ですが）基本理念は変わっていないと思います。 ところで、bcpでサーバにファイルを吐いた後、クライアント側に持って来る処理は不要なのでしょうか？ ファイルサイズにもよるとは思いますが、C#とVBが使えるなら、それこそ、OLEDB、ODBC経由でCSV吐くサンプルは沢山転がっていると思います。 数100MB以上とかなら、サーバ側で吐いたのを圧縮転送の方がいいですけど。
> 日本語に訳したら、何て言うのでしょうか。 > （「ウィキシンタックス」でいいのでしょうか。） syntaxの日本語訳が次のとおりですから， http://eow.alc.co.jp/search?q=syntax Wikiの構文，もう少し具体的に言うならば，Wikiのマークアップ書式，と言えばよいでしょう。 > ウィキシンタックスとは、何ですか。 Wikiの構文例については次のリンク先の「3 ウィキの文書マークアップ構文」を参照。 http://ja.wikipedia.org/wiki/%E3%82%A6%E3%82%A3% … Wikipediaの拡張構文例については次のリンクを参照。 http://ja.wikipedia.org/wiki/Help:%E6%97%A9%E8%A …
次回からは、Accessのバージョンは明記するようにしましょう！ 操作方法が異なる場合があります。 2003以前なら参考にされたサイトのように 『並べ替え/グループ化』の設定で フィールド/式　　　　　　　　　　　　　　並べ替え順序 グループ化したいフィールド名　　　　　　　　昇順 NO.　　　　　　　　　　　　　　　　　　　　昇順 と[NO.]を追加すればできます。 >NO. というフィールド名は変更することを強くお勧めします。 http://support.microsoft.com/kb/286335/ja トラブルの元になりかねません。
Excel2007以降だとして。 （Excel2003までだと重複の削除ができないので別の方法にする必要あり） sheet1シート Ａ列：あるコード Ｂ列：紐付きコード Ｃ列以下はない sheet2シート 作業用にＡ列、Ｂ列およびＤ列を利用します。 とすると、 1.Ｂ列を、1111でフィルタする。 2.フィルタしたあとで、Ａ列をコピーして、sheet2のＤ列に貼り付ける。 （Ｂ列が1111のＡ列のみが貼り付けられるはず。） 3.Ｂ列のフィルタを解除。 4.Ａ列をコピーsheet2のＡ列に貼り付ける。 5.sheet2のＡ列を指定して、重複の削除を実行する。 6.sheet2のＢ１セルに =vlookup(A1,D:D,1,0)と入力する。 7.sheet2のＢ１セルをコピーして、Ｂxx（xxはＡ列の最終行）まで貼り付ける。 Ｂ列に#N/AとでてきたＡ列の値が1111がないもの。 ※以下は応用って感じ。 式を = if(isna(vlookup(A1,D:D,1,0))=true,"○","") とかにすると、○が出てきた行が対象。 Ａ列とＢ列をコピーして、sheet3のＡ：Ｂ列へ貼り付けしてＢ列でフィルタすると、 対象のみになります。など。。。 とりあえず、EXCELの操作のみでできる方法を記載してみました。 ## 使えるレベルが分らないので「フィルタ」って何？とか「重複の削除」ってどうすんの？とか ## ありましたらお礼なり補足なりに記載してください。
ビュー自体には実データは存在しませんが、実データの見方を定義しているので、調査しようとしてい範囲によっては、調査の必要が有る可能性は有ります。ビューを沢山作ると、システムの解析が面倒になるので、あまり作らない事をお勧めします。
何かメッセージが出てきていませんかねー。 それとも、拡張子が、ACCDBやMDBになっているAccessファイルを ダブルクリックしても、だんまりで何も起きないのでしょうか。 Accessのバージョンによって設定方法が異なりますが オプション設定の 『既定の開くモード』を共有モードに 『既定のレコードロック』を編集済みレコードに それぞれ設定してあるか、まず確認を。 後半の質問は難しいです。とても書ききれない量があります。 なので、同じ難しいなら一足飛びに、無料のRDBMS 例えば、SQL SERVER Express Edition、MySQL ・・・にでも した方が良いのでは？という意見の方も多いです。 ユーザーに使用方法を強制することなく、 安全・確実に運用出来るように作りこむのは大変だと思います。 取りあえずは下記を読んでみてください。 http://support.microsoft.com/kb/882219/ja http://hpcgi1.nifty.com/MADIA/VBBBS2/wwwlng.cgi? …
多分最初に曲を保存した場所をどこかに移したのですね。それでＸアプリが曲データを認識できないんだと思います。 まずは、元の曲をどこに保存しているのか探してください。 それが終えたら次のステップを教えます。
select ID,名前,趣味 from 現在 union all select ID,名前,趣味 from 履歴 t1 where 履歴NO=(select max(履歴NO) from 履歴 t2 where t1.ID=t2.ID) and not exists(select ' ' from 現在 where 現在.ID=t1.ID) order by 1 です。
CSEって32bitアプリケーションらしいですよ。 それに対して64bit版InstantClientを利用しようとすることが そもそも違う気がしますが、32bit版InstantClientだと ダメなんですか？
やりたいことそのままのSQLがこちらに載っています。 http://codezine.jp/article/detail/5154?p=2 参考になれば幸いです。
取りだすDBと入れるDBのバージョンは完全に一致していますか？ 一致しているとしてexport_utf8.sqlをテキストエディタでみてみて クエリがおかしくないですか？
疑問2 についてさらに補足回答 存在しないカラム名はどんな場合もエラーです。データは空文字列やnullとして与えて as カラムエイリアスとするなら、存在しない名前もokです。 出力表示のカラム名は、最初のselect節で指定したものになるので、union 以降のselect節ではエイリアス名は無くてもよいですが、データ内容（固定値、存在するカラム値、計算値など）は必要です。
＞黒い画面 vbsなどで以下のような処理をしてみては？ 'test.vbs Set WshShell = WScript.CreateObject("WScript.Shell") Return = WshShell.Run("コマンド・・・", 0)
データベースはExcelの表などと違って「二つの同じ形式の表の同じ位置にある値同士を足す」ようなことはできません。 ですから、table1の各レコードとtable2の各レコードを紐付けるための列が必要になります。 例えば以下のように「no」という列を追加します。 table1 -------------------- col1|col2|col3|no 20 |30 |40 | 1 40 |40 |50 | 2 10 |20 |20 | 3 -------------------- table2 -------------------- col1|col2|col3|no 10 |10 |20 | 1 20 |20 |20 | 2 10 |20 |20 | 3 -------------------- として SELECT table1.col1 + table2.col1, table1.col2 + table2.col2, table1.col3 + table2.col3 FROM table1 INNER JOIN table2 ON table1.no = table2.no ORDER BY table1.no; とすれば一応は可能かと思いますが、これはtable1とtable2のレコード数が同じで、かつnoが必ず一対一で対応している場合でないと期待通りの結果を返してくれません。 実際には ・table1とtable2でレコード件数が違う ・noがtable1とtable2で一対一で対応していない などの場合はさらに工夫が要りますが、どういう結果を返したいかによってやり方は変わってくるので、とりあえずはここまでで。
新規ユーザーを作って試してみました。 Access（Office）を一回も開いていない状態 HKEY_CURRENT_USER\Software\Microsoft 下にVBA というキーは無し Access を立ち上げてテーブルを一個だけ作成 HKEY_CURRENT_USER\Software\Microsoft\VBA\7.0\Common まで出来て中味は↓だけ 名前 種類データ （既定）REZ_SZ （値の設定なし） Access閉じても変化なし Access立ち上げて標準モジュールに MsgBox "" だけのSub Module作成 実行しても変化なし Access終了後 （既定）、CtlsShowSelected、Dock、DsnShowSelected、FolderView、MainWindow MdiMaximized、OGGroupMembers、PropertiesWindow、Tool、UIAccess に増える。 （多分、モジュールの保存時に出来るものと思われるが確認漏れ） Access立ち上げてVBEのツール→オプションで、『自動構文チェック』のチェックだけ 外す。直後に （既定）、「AlignToGrid」、「AutoQuickTips2」、「AutoStatement2」、「AutoValueTips2」、 「BackGroundCompile」、「BackgroundProjectLoad」、「CollapseWindows」、「CompileOnDemand」、 CtlsShowSelected、Dock、「DragDropInEditor」、DsnShowSelected、「EndProcLine」、 FolderView、「GridHeight」、「GridWidth」、MainWindow、MdiMaximized、OGGroupMembers、 PropertiesWindow、「SaveBeforeRun」、「ShowGrid」、「ShowToolTips」、 「SyntaxChecking」、Tool、UIAccess、「UpgradeVBX」 に増える。（「」内は増えた分） Accessを再起動しても名前をその数には変化なし。 なお、本番環境だともう少し設定を変えてあるので３６個ありました。 （既定）、AutoValueTips2、AutoQuickTips2、AutoStatement2、DragDropInEditor RequireDeclaration、EndProcLine、CompileOnDemand、BackGroundCompile FontHeight、FontCharSet、FontFace、GridWidth GridHeight、ShowGrid、AlignToGrid、SaveBeforeRun ShowToolTips、CollapseWindows、UpgradeVBX、BackgroundProjectLoad PropertiesWindow、MainWindow、MdiMaximized、Dock FolderView、Tool、CtlsShowSelected、DsnShowSelected UIAccess、OBGroupMembers、UI、SyntaxChecking CodeForeColors、CodeBackColors、OBSearchHeight 数の多寡は関係ないような気がします。。。 （根拠はまったくありません） 何もしないのに数がちょこまかと増減したらマズイとは思いますけど。 それにしても解せない。 同一PC内でアカウントによって変わるなんて？ もしかして、アカウント名に日本語（全角文字）使ってるとか。 ミスリードが怖いので、少し回答を控えます。 明日は我が身かもしれないので、進展（解決）ありましたら教えてください。 最後に残念な苦言です。 困っていらっしゃるのは良く分かるのですが、 マルチポストは如何なものかと。 せめて、ここと、あそこと、あっちに同じ質問を立てています、 のようにしてください。 ↓をご一読ください！ http://stakasaki.at.webry.info/200512/article_3. …
#4 さんの回答にある国際規格「Database Language -SQL- Part 2: Foundation (SQL/Foundation)」は、和訳がJISデータベースにあります（ただし1999年版ではなく2008年版の和訳）。 http://www.jisc.go.jp/app/JPS/JPSO0020.html JISX3005-2 で検索すると出てきます。 「データベース言語ＳＱＬ－第２部：基本機能（ＳＱＬ／Ｆｏｕｎｄａｔｉｏｎ）」
はじめまして、このようなサイトがあります。言語選択で日本語を選択できます。フリー・ダウンロードです。 http://www.maxmind.com/en/worldcities
taisenに対してteamを２回joinしてやればよいのでは？ select taisen.hometeam ,t1.team_name as hometeam_name ,taisen.homepoint ,taisen.awayteam ,t2.team_name as awayteam_name ,taisen.awaypoint ,t1.year ,t1.leagueid from taisen left join team as t1 on t1.team_id=taisen.hometeam left join team as t2 on t2.team_id=taisen.awayteam ちなみにyearとleagueidはホームチームもしくはアウェイチームのどちらかの ものを拾うしかありません。 若干正規化の仕方がおかしいですね。
並べ替えはクエリでやれば出来ると思います。二つのテーブルから必要な項目だけクエリに取り込んで、並べ替えを指定すれば出来ると思います。
DB名入れないとダメですよ。 select * from DB1.table1,DB2.table2 where DB1.table1.id = DB2.table2.id これだけでうまくいくかはわかりませんが。
表面テーブル:全項目データを持っている inserted/deletedのトリガーで更新系テーブルのみ更新する。 また、inserted/deletedのトリガーで、常に、参照系テーブルの値をセットする。 （間違えて参照系テーブルからセットする項目を変更されても勝手に元に戻る。 　・・・いいとは思いませんが、仕様上そうしたいならできるはずという趣旨です。） 更新系テーブル：自身の更新はなし。 参照系テーブル：inserted/deletedのトリガーで、表面テーブルを追加・更新・削除する。 とすれば表面テーブルのアクセスは簡単に実現できるけど。 実態として、参照系テーブルは見ていないけど。
そのテーブルに、『非表示』というフィールドを加えます。 データ型は、Yes/No 書式は、True/False 『ルックアップ』タブに切り替えて、表示コントロールを「チェックボックス」に。 テーブルでは 非表示にしたい企業だけチェックを入れます。 クエリを一個作成して、非表示フィールドの抽出条件に、False とすれば？
<?php print date("Y-m-d"); ?> そもそもSQLでCURDATEを指定するならformからデータをおくる必要ないです
以上と言いつつ、 最初の質問の Me.Refresh を見逃していました。 Me でフォーム全体のRefreshを行うのではなく 個々のコントロールのRefresh、Recalc、Requeryを行えませんかね？ Me!コントロール名.Re… ただ、Me.Refresh を外しても若干の改善となると。。。 実際にファイルを見られればもう少し何とかなるかも？ですが やり取りはこのサイトではご法度なのでゴメン。
こんな事例がありますよ 参考URL：http://blog.goo.ne.jp/cxq02162/e/0e7dc86799b4a47 …
全ての貸出日もしくは全ての返却日を調べれば一番貸出本数が多い日が含まれるはずなので、それを利用すれば良いかと。 例) ------------------------------------ SELECT MAX(合計本数) AS 合計本数 FROM ( SELECT (SELECT SUM(本数) FROM 貸出 b WHERE a.貸出日 BETWEEN b.貸出日 AND b.返却日) AS 合計本数 FROM (SELECT DISTINCT 貸出日 FROM 貸出 WHERE 貸出日 BETWEEN 20130101 AND 20130131) a ) c; ---------------------------------------- 別名aのサブクエリーで全ての貸出日(重複なし)の集合を取得しています。 その一つ外側で、全ての貸出日について合計の本数を算出しています。 そして、一番外側で合計の本数が一番多いものを抽出しています。 日付を絞り込むには、一番内側の別名aのサブクエリーで条件を指定すれば良いです。
ANO1.ですが、頻度が同じものがあるとうまくいかないですね。 TF.freqだけでなく、TF.telでもorder byするとか。
order by binary coalesce(yomi,title) です。
Access Excel ともに2010で試しました。 パスワード・・のエラー発生。 ググリまくると http://www.access-programmers.co.uk/forums/showt … Franz Haidacher さんによれば Access2010 から採用された既定の暗号化方法（高度なセキュリティ）は ADO OLEDB では接続できないようです。 Accessのオプションのクライアントの設定から 以前の暗号化方法を使用するに変更したうえでパスワードを設定するしか 現在のところ方法がなさそうです。 (-"-) DAOなら・・・と試しましたが同じく orz
列Ｊが１０列目、列Ｋは１１列目。 ＶＢＡ中に"１０"はあるが、"１１"が見当たらない。 もう一度、やりたいことを整理して。
Access-VBAでは、普通のアプリで動いているような処理の ほとんどがプログラミングすることで動作可能です。 Accessは、ご質問のように「プログラマが別に居て、業務を 行う人はプログラムを知らない」という状況で、システムを 動かすことを前提にアプリ全体が設計されていますので。 具体的にお話の処理は、フォームで条件を決めてクエリを 走らせ、結果をフォームに転送して表示するという処理に なりますが・・・。 ただ、じゃあどうやってその「プログラム」を書くか、というと 相当にプログラミングに対する事前の知識が必要です。 例えば、この手の内容がスラスラ理解できるか・・・という 話です。了解できればほとんど万能なんですがね。 http://office.microsoft.com/ja-jp/access-help/HA … 実際、お話程度の処理なら、Excel-VBAでも十分可能です。 Excel-VBAは「手作業でやる動作を自動的にVBAのコードに してくれる」機能があるので、Accessよりとっつき易いですし、 Aceess-VBA同様に、フォームへの入出力も簡単に出来ます から・・・。 http://excelvba.pc-users.net/
クエリを使い、抽出条件のところで東京都を指定すればよろしいです。クエリのキーワードで調べてください。
それほど詳しくない上にMyISAMのデータベースが無く実験も出来ませんが知ったかで回答します。 AND unixtime BETWEEN UNIX_TIMESTAMP(NOW()) AND 1360850220; で現在から1360850220の間のunixtimeにマッチすると思います。
スクリプトは不要でした。 mysqlimport単体で複数ファイルを一括インポートできるようです。 例えばtkhgshデータベースのtestテーブルにインサートするとします。 ファイル名を data1_1.csv、data1_2.csv、data1_3.csv、data2_1.csv から test.data1_1.csv、test.data1_2.csv、test.data1_3.csv、test.data2_1.csv などとインサートするテーブル名に変えてください。 mysqlimport -L tkhgsh /path/to/test.* これで一括インポートできます。スクリプトは不要でした。 mysqlの権限やcsvファイルのパーミッションに気を付けてください。 他、オプションやcsvファイルの仕様などはマニュアル見てください。 http://dev.mysql.com/doc/refman/5.1/ja/mysqlimpo … http://dev.mysql.com/doc/refman/5.1/ja/load-data … ------------ 自分が言ったスクリプトというのは、 #!/bin/sh files="/path/to/csv/*" for file in ${files} do mysqlimport database ${file} done で、1ファイルずつmysqlimportすることを考えていました。 これとは別に、最初にファイルをまとめて巨大なファイルを作ってインポートでも可能ですね。 $ cat /path/to/csv/* >test.csv $ mysqlimport database test.csv また、回答2、3の人のはcsvをインポートではなく、 csvをinsert文に変えてmysqlに突っ込む方法ですね。 $ mysql database <test.sql でtest.sqlに書かれたsql文をdatabaseに対して発行できます。 csvの中が A 1 A 2 b 3 などとなっていれば、例えば insert into test values('A', 1); insert into test values('A', 2); insert into test values('B', 3); などと変えてやり、それで上記の$ mysql database <test.sql でインサートできます。 やり方様々、あります。 mysql、linux、シェルスクリプトの基本の基本から学びなおしてください。 windows環境ならばシェルスクリプトではなくコマンドプロンプトですね。がんばってください。
>まだ試合をおこなっていないチームもランク付けしたいのですが、 ではまず、teamテーブルの、2012年1リーグEチームを登録します insert into team values(13,'E',2012,1); //v1を作り直します。（すでにある場合は削除してください） create view v1 as select id,hometeam as team_id ,case when homepoint>awaypoint then 3 when homepoint = awaypoint then 1 else 0 end as wp ,if(homepoint>awaypoint,1,0) as w ,if(homepoint=awaypoint,1,0) as d ,if(homepoint<awaypoint,1,0) as l ,homepoint as tokuten ,awaypoint as sitten ,team_name,year ,leagueid from taisen inner join team on team.team_id=hometeam union all select id,awayteam as team_id ,case when homepoint<awaypoint then 3 when homepoint = awaypoint then 1 else 0 end ,if(homepoint<awaypoint,1,0) ,if(homepoint=awaypoint,1,0) ,if(homepoint>awaypoint,1,0) ,awaypoint ,homepoint ,team_name,year ,leagueid from taisen inner join team on team.team_id=awayteam union all select null,team_id,0,0,0,0,0,0,team_name,year,leagueid from team left join taisen on taisen.hometeam=team.team_id or taisen.awayteam=team.team_id where taisen.id is null //v2を少しいじります。（すでにあるものは削除） create view v2 as select team_id,year,leagueid,team_name ,sum(wp) as wp ,count(id) as count ,sum(w) as w ,sum(d) as d ,sum(l) as l ,sum(tokuten) as tokuten ,sum(sitten) as sitten ,sum(tokuten) - sum(sitten) as tokusitten from v1 group by team_id,year,leagueid; //この状態で、前回のSQLを走らせます select year,leagueid, (select count(*)+1 from v2 as v2b where 1 and v2a.year=v2b.year and v2a.leagueid=v2b.leagueid and (0 or v2a.wp<v2b.wp or v2a.wp=v2b.wp and v2a.w<v2b.w or v2a.wp=v2b.wp and v2a.w=v2b.w and v2a.tokuten<v2b.tokuten or v2a.wp=v2b.wp and v2a.w=v2b.w and v2a.tokuten=v2b.tokuten and v2a.tokusitten<v2b.tokusitten ) ) as rank,team_id,team_name ,wp,count,w,d,l,tokuten,sitten,tokusitten from v2 as v2a order by year,leagueid,rank; ※2012年1リーグの5位にチームEが表示されます
え～と・・・時間ができたので（笑）SQL版をば -- keyの設定（SQL*Plusでの実行を想定） VARIABLE v_key NUMBER EXECUTE :v_key := 1 -- なんか…無理矢理だな～、DB設計が悪いんだよな（笑）版 SELECT MAX(CASE WHEN A.fno = 1 THEN B.fvalue END) AS field1, MAX(CASE WHEN A.fno = 2 THEN B.fvalue END) AS field2, MAX(CASE WHEN A.fno = 3 THEN B.fvalue END) AS field3 FROM ( SELECT 1 AS fno, field1 AS fname FROM テーブルA WHERE key = :v_key UNION ALL SELECT 2 AS fno, field2 AS fname FROM テーブルA WHERE key = :v_key UNION ALL SELECT 3 AS fno, field3 AS fname FROM テーブルA WHERE key = :v_key ) A, ( SELECT 'item1' AS fname, item1 AS fvalue FROM テーブルB WHERE key = :v_key UNION ALL SELECT 'item2' AS fname, item2 AS fvalue FROM テーブルB WHERE key = :v_key UNION ALL SELECT 'item3' AS fname, item3 AS fvalue FROM テーブルB WHERE key = :v_key UNION ALL SELECT 'item4' AS fname, item4 AS fvalue FROM テーブルB WHERE key = :v_key UNION ALL SELECT 'item5' AS fname, item5 AS fvalue FROM テーブルB WHERE key = :v_key ) B WHERE A.fname = B.fname / 「動的SQL」をオススメします。
group by 句に無いカラムがどう選択されるかは既にご回答の有るとおり。 要は見つけた順なのだが、indexのアルゴリズムや、挿入削除で物理配置が変わるので、不定となる。 あと、mysql には、集約関数にランダムに取り出す物はないので、サブクエリか、テンポラリーテーブルが必要。mysql 4.1 以降なら、サブクエリでいけそう。最適化も考慮すると以下かな？最後の order by null で既に並んでる物を再度並べ替え作業しないようにして、少々時間短縮。 select id,Type, age from (select id,Type, age from tb order by id,Type, rand() ) as rand_tbl group by id,Type order by null ;
この辺が関係あるかもです。 Windows7(64Bit版)での32Bit版ODBC管理ツール http://rinta-annex.at.webry.info/201202/article_ … http://support.microsoft.com/kb/942976/ja 要は、OS(Windows7) が64bit の場合に既定で64bit版ODBCを使用しようとしますが Access は32bitで動いているので64bit版ODBCでは接続できない。 なので、 『Odbcad32.exe ファイルの 32 ビット バージョンは、 %systemdrive%\Windows\SysWoW64 フォルダーにあります。』 で設定を行う必要がある・・という事。 OS が 32bitならこの回答は読み捨ててください。
1) 値段の集計 SELECT 販売支店, 出身国, SUM(値段) AS 値段 FROM テーブル GROUP BY 販売支店, 出身国 ORDER BY 販売支店, 出身国 (2)車種の頻度順 SELECT COUNT(*), 車種 FROM テーブル GROUP BY 車種 ORDER BY COUNT(*) DESC, 車種 (3) 合体 SELECT a.販売支店, a.出身国, SUM(a.値段) AS 値段 , ( 　　SELECT TOP 1 b.車種 　　FROM テーブル b 　　WHERE b.販売支店 = a.販売支店 AND b.出身国 = a.出身国 　　GROUP BY b.車種 　　ORDER BY COUNT(*) DESC, b.車種 ) AS 車種 FROM テーブル a GROUP BY a.販売支店, a.出身国 ORDER BY a.販売支店, a.出身国
idだけを拾うならこれで十分 select min(id) as id from tb group by field1,field2;
例えば、 create view vw1 as select * from table1 where KeyCol2 = '1' select * from vw1 where keyCol1 = 'X' order by keyCol2 なんてすると、 select * from table1 where keyCol1 = 'X' and Keycol2 = '1' order by keyCol3 はインデックス(KeyCol1,KeyCol2,KeyCol3)を使えるのに、 Viewを使ったほうが、インデックスを使えない （KeyCol2が'1'を抽出してからkeyCol1='X'を洗い出すため） なんてことが起きるかもしれません。 （この例は、SQLを解析した結果で実行計画が同じ処理となるかもしれませんが。） なお、 SQLでVIEWを作成し、そのVIEWに対してSELECT文を書くときに、そのVIEWに対してWHERE句をつけるのは、パフォーマンスを必ず下げることになるのでしょうか？ は必ずしも下げることになるとは限りません。 where句でインデッックスを使えない場合、 Create view vw2 select * from table1 where NotIndexCol1 = 'A' として、 select * from vw2 where NotIndexCol2 < 15 としようが、 select * from vw2 where NotIndexCol1 = 'A' and NotIndexCol2 < 15 としようがあまり変わらないはずです。 （SQL解析時間が少し早くなるかもしれませんが、体感速度の差というレベルではないはず。） まあ、そもそも、View でwhere 句を書いて、Viewを使ったSelect句でも、where 句を書くのは お薦めしません。（Viewが副問い合わせ扱いされる危険性があるため） create view vw1 select * from table1 where NotIndexCol1 = '1' して、 selcet vw1 where IndexCol1 = 12 なんてしたときに、table1 が10万件合って、IndexCol1 = 12　が10件しかなかったら いったん、 select * from table1 where NotIndexCol1 = '1' で数万件のワークを作って、その中からIndexCol1 = 12を探すという動きになったら きわめて遅いだけです。（SQL解析能力に期待しましょう・・・というわけにはいかないので。） こうなったら、 select * from table1 where IndexCol1 = 12 and NotIndexCol1 = '1' としたほうがはるかに早い。
importする時に文字コードを指定してみてください。 mysqldumpなら--default-character-set=[binary/utf8]オプション
ANo.1です。 >基幹ＤＢに顧客などのマスタテーブルや売上などのトランテーブルの数が約800あり、これらのデータを>毎日ＤＷＨ用のＤＢへ差分更新します。 マスタは無視して、売上などのトランテーブルがいくつあるのでしょうか？ これが数百あるなら分けたほうがいいというのが、前の回答の趣旨。 「ｘｘ別売上テーブルみたいな中間ワークテーブル」といっていたのが、 「ＤＷＨ側のＤＢにビューを約500作成し」に相当します。 500も必要でしょうか？ （ついついいくつも作ってしまうのがビューだったりします。） 例えば、課別月別売上ビューと部別月別売上ビューを別々に作ってしまったりとか。 （課別月別売上ビューがあれば部別月別に売上リストを出すのは結構早い。） 昔やった仕事で、縦軸、横軸の組み合わせ１５０個程の検索を、１２個の中間ワークファイル （ビューと思ってください）で実現したことがあります。 ・・・ビューは、出力が遅ければ追加するという考え方で作っていくのも有りと思っています。 （もちろん、1伝票毎のトランザクションから出力させると遅いにきまっていますので、 　最も細かい単位でのビューは作る前提のほうがいいですが。） 「ドクタサム」がよくわからないのであまりアドバイスはできないのですが、 ビューといっているけど実データを別に格納していて毎日更新する必要があるという前提と 考えられますので、効率よく更新する方法はあると思われます。 例えば、日別取引先別売上ビューがあるなら、月別課別売上ビューは、元データから更新する のではなく、日別取引先別売上ビューから更新するとか（前提として１取引先１課とする）。 あと、差分更新は、ちょくちょく、値があわなくなることがあります。 （あってはいけないのですが、バグやsqlを直接実行して削除したため、マイナスデータが 作れなかったとかいったイリーガルなオペレーションからおきることがあるので。） 例えば当月分を月末に全件再計算するとかしたほうが安全です。 毎日当月分を再計算するってほうがベターとは思いますが、処理時間とのバーターです。 >本来、基幹で作成しなければならなかった帳票などもＤＷＨから出るようにしたいため プルーフリストとか入力内容を確認する帳票は、基幹で出すようにしてください。 基幹で正しいデータにしてからデータを受け取らないと、取り消しデータとか山のように データを受け渡ししなければいけないことになります。 ## ま、お分かりと思いますので余計なお世話なんですが。 ## とりあえず、こんなところで。 ## 後は個別にどんなデータとどんなビューがあって・・・ ## と１件ずつ掘り下げていく必要があるのですが、 ## ＱＡサイトではそれもなかなか難しそうですね。
＞DELETE FROM `__TABLE__` WHERE `user_id` = 1234 LIMIT 1 user_idがユニーク属性なカラムならLIMITはいりません 逆にユニークではないならLIMITによる抽出はレコードを特定できません。 LIMITは最初に出現する1つですが、ORDER BYしない場合は出現順は保証されないからです。 単体で運用しているならともかくレプリケーションを前提とするなら 更新や削除は厳密にデータを特定できる指定をしてください
ケースバイケースだとは思いますが、メンテナンスを考えると、複雑なSQLはメンテしにくいので、 ・できるだけPHP側で処理 ・SQLでやったほうがディスクアクセスが有意に減るならそっちでやる SQLの工夫でディスクアクセスが1/10になるとして、100回か10回かならどっちでも良い。 100万回か10万回かなら、10万回を選ぶ。 インデックスとかも関係してきます。
＞　データベースに重複するデータが入っていなかったとしても、SELECT文で取得する際に ＞　同じデータを取得することもあるという事でしょうか。 SQL文の書き方次第ではあり得ます。
> 特に「か」だけではなく　あ・か・さ・た・・・ というレコードを選択です。 > 単純に「あ」、「か」、「さ」・・・と選択して蓄積しても良いのですがスマートなSELECTを書きたいと思って質問しました。 このあたりがよくわかりませんが普通に select * from xxxx where ヒラガナ like　'か%'ではだめですか？
あ、よくよく考えたらこの程度ならピボットしなくてもかけますね ピボットの場合もう少し複雑な集計をとるとき便利です。 もちろん今回のケースでも活用できます //例 select bang ,max(if(tuki=4,name,null)) as 4月 ,max(if(tuki=5,name,null)) as 5月 ,max(if(tuki=6,name,null)) as 6月 from tb as t group by bang order by bang; //ちなみに2名以上いるときの列記 select bang ,group_concat(if(tuki=4,name,null)) as 4月 ,group_concat(if(tuki=5,name,null)) as 5月 ,group_concat(if(tuki=6,name,null)) as 6月 from tb as t group by bang order by bang; //各bangに月ごと何人いるかカウントする select bang ,sum(tuki=4) as 4月 ,sum(tuki=5) as 5月 ,sum(tuki=6) as 6月 from tb as t group by bang order by bang;
SQL Server のカテゴリーに質問されているので SQL Server の質問てことでいいんですかね。 Xoops が SQL Server を使っているとして、、、、 接続文字列は DB へ接続するための文字情報なので、それを削除しても DB は削除されない。 相手が SQL Server なら Management Studio または Management Studio Express を使って DB 自体を削除する。
とりあえずSPFILEを適当な名前にリネームしておいて、 PFILEから起動（startup）するという手は？
select m.name,s.makercd,count(s.makercd) from shohin s left join meisho m on s.makercd=m.makercd group by s.makercd; 追加質問に素直に答えると上記です。 追加質問のエラーというのは、多分ですが、 「Column 'makercd' in field list is ambiguous」ではないでしょうか？ であれば、これはgroup byで指定したmakercdに、 どちらのテーブルのmakercdかの指定がないためです。 上記のsqlは素直にそれを訂正しただけです。 ただ、例を見てたのですが、「004 東芝」はmeishoには登録されているけど shohinに出てきていないですね。 ----------- 001 富士通 3 002 NEC 2 003 パナソニック 1 004 東芝 0 ----------- もし、上記のような0件の結果も必要ならば以下となります。 select m.makercd,m.name,count(s.makercd) from meisho m left join shohin s on m.makercd=s.makercd group by s.makercd order by m.makercd;
likeの方は、それぞれにカラム名も必要ですよ。 (`urlpath` not like '%/officeedit/%') and (`urlpath` not like '%/houseedit/%') 括弧は省略出来るけど、between の and とは違うので。 regexp は正規表現なので、検索が遅くなることが多いようです。like も前方一致でないなら、indexは使われないので、やはり、速くはならない。よって、どっちがいいかはデータ量や複雑なパターンマッチが必要かどうか（likeは単純文字列マッチなので）によるのでは。
>データが操作禁止になっていたので これ、どういうことですか。
phpはデータベースではありません、プログラミングの言語の1つです。 あなたの今の状況では、あなたがやりたいこと、 「データベースに登録したデータをWEB経由で検索、閲覧する」までは遠い道のりです。 まずは、フリーのWIKIサービスなどを使ってサイトを作ってみてはどうでしょう？ http://atwiki.jp/ http://wiki.fc2.com/ --------------- 名前：ガーゴイル レア：コモン 属性：飛行,悪魔 説明：・・・・・ --------------- 上記のようにカードのページを作れば、 名前やレア度や属性で検索できますよ(上記は適当なデータです)。 その上で、やっぱりちゃんとデータベースを作りたいと思ったら勉強してみてください。 インターネットの仕組み、WEBアプリの仕組み、データベースの仕組み、プログラミング、、 遠い道のりかもしれませんが、決して不可能ではないです。がんばってください。
こんな感じですか？ select cast.name,cast.age,photo.url,schedule.starttime,schedule.finishtime from cast left join photo on cast.name=photo.name and photo.order=0 left join schedule on cast.name=schedule.name and schedule.workdate='2013-02-05' なお、カラムにcastやorderといった予約語をいれると思わぬ落とし穴があったりするので 気をつけてください
とりあえずマニュアルに固定長の制限があると書いていますね memoryエンジンを使う限り仕様なのでメモリを増やすか あきらめるしかなさそうです。 http://dev.mysql.com/doc/refman/5.1/ja/memory-st …
＞$rst = mysql_query($sql, $con); おそらく参考にされている書籍やサイトが古いですね すでにmysql_query()は非推奨になっていますので いまはmysqli系の処理か、PDOを利用した処理が正しいです。 環境を見直したほうがよいかと思います。
これって合計じゃなくて単にcount処理をフラグやグレードを指定して取っているだけですね。 //準備 create table A (id int,flag tinyint); create table B (id int,grade tinyint); create table C (id int,val int); insert into A values(1,0),(2,1),(3,0),(4,1),(5,1),(6,0),(7,0); insert into B values(1,0),(2,0),(3,2),(4,2),(5,0),(6,0),(7,0); insert into C values(1,10),(2,20),(3,30),(4,40),(5,50),(6,60),(7,70); //非効率SQL SELECT num_a, num_b FROM (SELECT SUM(IF(flag=0, 1, 0)) AS num_a FROM A WHERE id=ANY(SELECT id FROM C WHERE val<=50)) AS sub_a, (SELECT SUM(IF(grade=2, 1, 0)) AS num_b FROM B WHERE id=ANY(SELECT id FROM C WHERE val<=50)) AS sub_b //調整後 SELECT count(flag) as num_a,count(grade) as num_b FROM C LEFT JOIN A on C.id=A.id and flag=0 LEFT JOIN B on C.id=B.id and grade=2 WHERE val<=50;
"EXECUTE IMMEDIATE"が余計です。 取りましょう。
OSは？ Win7あたりであれば「windows」キー＋Fで更新日を指定して検索とかできます
Dumpとってテーブル作り直してインポートする
現職のサーバエンジニアです。 ＞Linuxにログインする際のユーザ（OSのrootユーザ権限）でMySQLのエクスポートやインポートを行うことは可能かどうか？ mysqldumpを用いてのデータのインポート/エクスポートを指すのであれば、不可能だと思われます。 mysqldumpはMySQLのユーザ情報にて接続するためです。 Linuxにログインする際のユーザとMySQLへ接続する際のユーザは完全に別物であり、 私の知る限りでは双方を連動させる方法は聞いたことはありません。 ただし、mysqlのデータファイル本体は通常のファイル扱いであるため、それらのファイルを扱う際にはLinuxのユーザ権限がかかわってきます。 それらのデータファイルをLinux上でコピーや上書きを行うことで、以前のデータへの復元やデータのバックアップが可能です。
>たとえば、SELECT * from A WHERE B=変数 SELECT * from A WHERE B='/*[VARIABLE]*/' をブックマークしておいてください
＞CPU使用率は40%ほどしかなく、メモリも余裕があるのに、IOだけが完全に溢れております。 となるとたんにファイルI/Oのボトルネックでしょうか・・・ 遅延書き込みがうまく機能していないだけならバッファリングの調整で 少しは改善されるかもしれません。 ただ、結局書き込みがおいつかないなら、本質的にはハードウェアで処理するしかなく、 SSDやらでデータ管理しないと解決しないかもしれませんね。 検証については以下サイトなど参考になるとおもいますので、 諸々の変数を調整してみてはいかがでしょうか？ http://blog.layer8.sh/ja/2011/12/23/mysql%E3%82% … また、MySQLのレイヤーによる負荷を軽減するためにHandlerSocketというプラグインも あるようなので、場合によってはチャレンジしてみてもよいかもしれません。 （個人的には興味があるのですが未検証なので自己責任でお願いします） http://engineer.dena.jp/2010/08/handlersocket-pl …
4人以上を3人に絞り込むのは適当でいいとのことですので 投票数が同じ場合はユーザーのidが小さいものを上位とします 性質上一度集計をするためにviewをつくっておくとよいでしょう。 //テーブルをつくり create table vote (cID int,iID int,cTime datetime,unique(cID,iID,CTime)); //ビューをつくります create view v_vote as select cID,iID,count(*) as count from vote group by cID,iID; //ダミーデータをいれます insert ignore into vote values (1,1,'2013-01-01 00:00:00'),(1,1,'2013-01-01 00:00:01'),(1,1,'2013-01-01 00:00:02'),(1,1,'2013-01-01 00:00:03'),(1,1,'2013-01-01 00:00:04'),(1,1,'2013-01-01 00:00:05'),(1,2,'2013-01-01 00:00:06'),(1,2,'2013-01-01 00:00:07'),(1,2,'2013-01-01 00:00:08'),(1,3,'2013-01-01 00:00:09'),(1,3,'2013-01-01 00:00:10'),(1,4,'2013-01-01 00:00:11'),(1,4,'2013-01-01 00:00:12'),(1,4,'2013-01-01 00:00:13'),(2,1,'2013-01-01 00:00:14'),(2,2,'2013-01-01 00:00:15'),(2,3,'2013-01-01 00:00:16'),(2,4,'2013-01-01 00:00:17'),(2,5,'2013-01-01 00:00:18'),(2,1,'2013-01-01 00:00:19'),(3,2,'2013-01-01 00:00:20'); //まずビューを確認します select * from v_vote; //カテゴリごとにカウントの多い人順 select( select count(*) +1 from v_vote AS v2 where ( v1.count=v2.count and v1.iID>v2.iID or v1.count<v2.count ) and v1.cID=v2.cID ) AS rank ,cID,iID,count from v_vote AS v1 having rank<=3 order by cID asc,rank asc;
>Listenで設定とはどういうことですか？ Listen 80 なんて行はないですか？ apacheの2.x辺りではPortではなくListenで設定する。 というように変更されているっぽいですけど。 http://blog.sarabande.jp/post/32488898943 によると、/etc/httpd/conf.d/以下ではないようですがSSL設定用のファイルは別にある…みたいですね。 # httpd関係のファイルは/etc/apache2の下…なんですかねぇ……。 >提示されたページは教授から提示されたので、よくわかりません。 であれば…その教授にも確認してみるべきでしょう。 # 授業料払っているんですし。 # ここみたいな何の責任も負ってくれない回答者からの回答よりはマシかと思われます。
どのような目的で使用するのか判りませんが。 一般的に言えば列車の行き先がない、種別(急行、普通など)、運転日(休日運休など) 上下の区別をするか？ ２線以上ある接続駅の扱い 等々突込みどころは有りますね。
>「お魚くん」を「焼き魚くん」 であれば、REPLACEを使うとよいかと UPDATE wp_postmeta SET meta_value=REPLACE(meta_value,'お魚','焼き魚') WHERE meta_key LIKE '%koubutsu%'; ただし絞り込みを入れた方が効率的かもしれないのでこっちの方がよいかも UPDATE wp_postmeta SET meta_value=REPLACE(meta_value,'お魚','焼き魚') WHERE meta_value LIKE '%お魚%' AND meta_key LIKE '%koubutsu%';
自宅にとか自宅でを聞いたのではないです。 パソコンとiPadを両方とも自宅に持ち帰ってという意味ですか。 でしたらwi-fi関連の問題になるでしょう。
＃１です > 通常状態で触れさせないようにする良い方法はないでしょうか？ VBA は大丈夫だったでしょうか。 考え方をちょっと変えてみます。 テキストボックス「テキスト0」をいじらせたくないので、Enabled / Locked で制御している。 ↓ テキストボックス「テキスト0」の Enter で異なるコントロールに Focus を移動する。 例えば、テキストボックス「テキスト0」の フォーカス取得時に以下を記述しておきます。 Private Sub テキスト0_Enter() 　　Me.テキスト1.SetFocus End Sub この場合、「テキスト0」にフォーカスが入ろうとした場合、「テキスト1」に無条件で移動させます。 意味合い的に、「テキスト0」にはフォーカスが入らないので修正等できません。 では、テキスト0.Text にどうやって値を設定し、イベントを発生させるかですが・・・・ 一旦、「テキスト0」の フォーカス取得時を無効にしてから設定して、終わったら戻します。 Dim ctl As Control Dim sS As String Set ctl = Me.ActiveControl sS = Me.テキスト0.OnEnter Me.テキスト0.OnEnter = "" Me.テキスト0.SetFocus Me.テキスト0.Text = "こんにちは" ctl.Setfocus Me.テキスト0.OnEnter = sS 今の アクティブコントロールを覚えておいて、 フォーカス取得時を無効にして、 "こんにちは"　を設定して フォーカスを元のところに戻して、 フォーカス取得時を有効にして・・・・ お礼にあった記述と変わらないですかね・・・・（上記コードは未検証） また、違う方法と言えば、手間でも自分で呼び出す・・・・ 設定後、「テキスト0」の更新後処理を動かしたい場合、 Me.テキスト0.Value = "こんにちは" Call テキスト0_AfterUpdate とすれば、同じことになると思います。 ※ フォーカスがあるうちに、Enabled = False はエラーになったような・・・・ ※ ご質問の内容をもう一度読み直してみました。 > テキストボックスの値を変更する段階で別のコードを入力すれば対応は可能なのですが、「テキストボックスの値を変更した時」のタイミングで別コードを動作させることで、コードをまとめたいと考えています。 という事ですが、アクセスで用意されているイベント（フォームに関して）は、操作する人がいること・・・ が、主だと思います。 VBA とかで値を設定する・・・・操作の範疇じゃないので自分で面倒をみることになると思います。 上記での SetFocus しないとイベントが発生しない・・・・操作していればあたり前のことなので・・・ Enabled = False / Locked = True にした状態のものの、変更イベントを取りたい・・・ 私にはチョッと理解できない部分になります。 ※ 他の方の回答を待ってください ※ 解釈違い等あれば、ごめんなさい。
できるような表記はないですね エンジンの特性のようですしあきらめた方がよいかもしれません。 むしろなぜ行ロックの必要があるのでしょうか？ http://dev.mysql.com/doc/refman/5.1/ja/internal- …
ご参考 http://www.insight-tec.com/mailmagazine/ora3/vol …
テーマに連動しているようなのでできないです。
> Me![性] = Rs![性] 「指定された患者番号でレコードを取得して、内容を表示」はわかるけど テーブル構造もFormの項目も提示が無いので推測。 きっとどちらか、あるいは両方が定義されていない。 ホントに「性」ですか？姓名の「姓」が正解じゃないですか？ この手のものなら「性別」と定義していそうに思います。
バージョンが書いていないのでなんともいえませんが 「MySQL character set」でググってみてください
１についてです クエリキャッシュを0にしてみたらどうでしょう 2についてです 更新の少ないテーブルならばオンメモリ化してしまうのも手です
そのまま作れますよ。 問題ごとの値一覧を作って、チェックボックスでは無くラジオボタン にします。 合計はSum(回答1;回答2;回答3・・・・)です。 回答フィールドは数字フィールドにしたほうがいいのかと思いました が、テキストフィールドでも数字部分だけ合計してくれますね。 何m歩けますかの問題の回答が 5点　5m 4点　4m ではダメですが。
V列の一番上の「V1」セルに以下の式を入力 =IF(ROW()=1,S1&"\"&T1,IF(OFFSET(S1,-1,0)=S1,OFFSET(V1,-1,0)&"\"&T1,S1&"\"&T1)) 入力したらV1セルを下方向の「V2」～「V10」にコピーする
select t4.name as t4_name, sum(t5.profit * coalesce(t2.rate, avg(case when date(t5.date, 'start of month') = date(t2.date, 'start of month') then t2.rate else null end), avg(case when date(t5.date, 'start of year') = date(t2.date, 'start of year') then t2.rate else null end), avg(t2.rate)) as sum from t5 inner join t4 on (t5.t4_key = t4.key) inner outer join t3 on (t5.t3_key = t3.key) left outer join t2 on (t3.t1_key = t2.t1_key2 and date(t5.date) = date(t2.date)) where t2.t1_key1 = 't1_key1' and date(t5.date, 'start of month') = '2012-01-01' group by t4.key, t4.name order by sum desc 環境がないのでテストしていませんが、上記のような感じになるとかとおもいます。 （あまり自信はないですが） あと、何でわかりにくく説明しているの？（T1 とか T2 key とか date とか） 具体的に説明してもらったほうが質問を理解しやすいです。（質問を理解するのに無駄に時間がかかりましたので・・・）
GoもiPhone、iPadも持ってませんが、Pro12のホストDBにアクセスして 使用する場合はPro12のオブジェクトフィールド内の画像を外部保存して あればいいはず。 DBをGoに転送している場合は、Pro12のオブジェクトフィールドに画像 を埋め込んでから転送しないと見えないはず。（各デバイスに画像の実体 が必要という意味で）
6.5の古いバージョンは問題が出ましたが、最近のバージョンは問題は出ないはずです。尚、クライアントからの接続は当然コンピューター名を変更する必要があります。
なんの場合でもそうですが旧コンピュータ名でアクセスしていた サービスがあるなら、接続できなくなります MySQLサーバー自体は、自サーバー名を参照するケースはあまりなく localhostなどで参照するのでほとんどの場合問題ないとおもいます
クエリーの機能を使って簡単に出来ます。 クエリーの抽出条件のところで、一つの条件を書き込み、その下の「または」のところに次の条件をそしてその下に３番目の条件を書き込めばよろしいです。
親と子の連動する部分は、宛名の会社の人と「同じ会社」の「ランク１のリスト」という点だと思います。 親には、印刷するしないに関わらず会社ＩＤを配置します。（会社ＩＤを印刷したくない場合には、プロパティの「可視」を いいえにします） サビレポートのプロパティ「データ」タブで「親フィールド」を「会社ＩＤ」「子フィールド」も「会社ＩＤ」にします。 サブレポートのデータソースは、クエリーで「社内ランク１」に絞り込んだ「氏名」および「会社ＩＤ」とします。 前述と同様手順でサブレポートの「会社ＩＤ」も非表示扱いにします。
>Tomcat内のcommon\lib内にmysql-connector-java-5.1.22-binを導入し、環境変数でパスを通しています。 Tomcat内に入れれば、Tomcat上で実行されるプログラムからは認識されますが、Eclipseからは認識されません。EclipseはTomcat上で動いていませんから。またPathを設定してもJavaのクラスパスとして認識されていなければJava内からは利用できません。 Tomcat内ではなく、Eclipseが使用しているJDKのlib内にドライバのJarを入れてやればEclipseでも利用できるはずです。 JDKのフォルダ\jre\lib\ext　←　ここです。
Aさんがコミットして更新（この場合INSERT）を確定すれば Bさんからも見えるようになりますよ。 Aさんが確定しない限り、Aさんの更新はBさんからは見えません。 このカラクリがないと Aさんが「やっぱ、や～めた」ってロールバックした時 困るでしょ？ Bさんから見えてたら。 SQL*Plusで SET AUTOCOMMIT ON として自動コミット機能を有効にすれば Aさんが更新するたびに自動的（強制的）にコミットされますが、 Aさんは、その更新をロールバックすることができなくなります。 よ～～～く、考えて使うべき機能です。
＃４です ＃４の補足にあった > T_コーチマスタ(テーブルＡ) > ランク　ヒット数　 コーチ名 　担当者MAX > ---------------------------------------- > 　A　　　10　　　　　佐藤　　　　3 > 　A　　　 3　　　　 　鈴木　　　　3 は構成がおかしい(?)ので、上記「ヒット数」は考えないことにします。 ＃２でのVBAで 　　While (Not rsB.EOF) 　　　　If (sS <> rsB("ランク")) Then　' ★ 　　　　　　sS = rsB("ランク")　' ★ 　　　　　　rsA.Filter = "ランク='" & sS & "'"　' ★ 　　　　　　i = 1　' ★ 　　　　End If　' ★ 　　　　rsB("人数(連番)") = i 　　　　rsB("コーチ名") = rsA("コーチ名") 　　　　rsB.Update 　　　　i = i + 1　' ★☆★ 　　　　If (i > rsA("担当数MAX")) Then　' ★☆★ 　　　　　　rsA.MoveNext　' ★☆★ 　　　　　　i = 1　' ★☆★ 　　　　End If　' ★☆★ 　　　　rsB.MoveNext 　　Wend ★：選手側「ランク」が変わったか判別して、 　変わっていたら、その「ランク」のコーチを求め直して・・・ 　連番を 1 に ★☆★：連番をカウントアップして、 　そのコーチの「担当数MAX」を超えたら次のコーチにして、連番を 1 に なので > (最後の3までふられない理由は？) 確認された時の「担当数MAX」が 2 だったのでは・・・と思います。 （ 3 を 2 にする処理は入っていないので） ※ 以前は「担当数MAX」でしたが、＃４補足では「担当者MAX」になってますね テーブルは新しく作って変えたけど、VBAで参照しているテーブルは前のまま・・・とか？ この処理での大前提は、選手側のデータは「ランク」で並んでいる必要があります。 「ランク」で並んでいるのなら、そのランク内の並びは？？？ それを指定してあげればよいです。（それが＃３の冒頭に記述したものになります） 割り当てしたい順に並んでいる・・・・並んだ後は「ヒット数」等、確認はしません。 （なお、この前提以前に、１選手１データであること・・・・があります） コーチの方も、コーチの並び順を指定しておけば、その順は Filter 後も維持されるようです。 回答になっていたでしょうか？
どういう要件ですか？ 受け取ったイメージは以下の要件なので無理！ tableA SHOHINCD A101 A201 A301 の３件が抽出されると、 tableB SHOHINCD X-A101b A101c A101 XYZ-BA201 XYY-A301 A301xxyz 等がすべて取得できる必要がある。 言い換えると、 SHOHINCD like '%A101%' or SHOHINCD like '%A201%' or SHOHINCD like '%A301%' と、tableAから抽出されたSHOHINCDを含むSHOHINCDを持つtableBのレコードすべて 出力したい、と読み取れました。 Likeの文字列を可変にするのは無理です。 条件が違っているなら、やりようはあるかもしれません。。。 例えば、tableBの２文字目から４文字目がtableAから抽出されたSHOHINCDと一致するレコード とかならできます。
こんにちわ。 > rmanコマンドに、時間を引数として渡したいのですが、渡し方がわかりません。 以下RMAN マニュアルの「例3-34 置換変数の指定」が参考になるかと。 http://docs.oracle.com/cd/E16338_01/backup.112/b … 参考URL：http://docs.oracle.com/cd/E16338_01/backup.112/b …
int型項目に限らず、極力nullは避けた方が無難です。 nullを含んだテーブルの検索は、しばしば直感に反した動作をします。 詳しくは下記のページを見て下さい。 http://codezine.jp/article/detail/532?p=1 http://www.geocities.jp/mickindex/database/db_ge …
基本的な流れは、ユーザー関数を作成して・・になります。 例えば 標準モジュールに Function delStr(delOrg As String, delList As String) As String Dim delAry As Variant Dim i As Integer delAry = Split(delList, " ") delStr = delOrg For i = LBound(delAry) To UBound(delAry) delStr = Replace(delStr, delAry(i), "") Next End Function とします。 左のフィールドのフィールド名が、F1 として下記が入ってると仮定 ブリキ看板 テキサコ ダルメシアン TEXACO ブリキカンバン ぶりき看板 ティンサイン サインボード インテリア TINサイン アメリカン雑貨 同様に右のフィールドのフィールド名が、F2 として下記が入ってると仮定 ブリキ看板 ブリキカンバン アメリカン雑貨 クエリのデザイングリッドに F1｜F2｜F3:delstr(F1,F2) とすればF3フィールドに結果が表示されます。 ただ、上の関数はあくまでも基本形ですので以下のような事が不明ですので 期待した結果が出ないと思います。エラー処理も入れてません。 １・ >ブリキ看板 テキサコ 文字と文字の区切りが半角スペースになっているが 全角スペースが紛れ込んでいないか ２・半角スペースが２個以上になっているのがないか ３・>TEXACO<=>texaco 大文字・小文字は同一視するのか ４・TEXACO<=>ＴＥＸＡＣＯ 半角・全角の場合は パッと思いつだけでも色々あります。
テーブル名を、T1 とした場合には SQL文では SELECT ID, 氏名, 科目, 点数 FROM T1 WHERE (科目 = '国語' AND 点数<=59) OR (科目 = '数学' AND 点数 <= 49) です。 クエリのデザインビューに切り替えても確認できます。 なお、フィールド名の 『No.』は適切ではないので 『ID』に変更しています。 http://office.microsoft.com/ja-jp/access-help/HA …
元のテーブルの主キーが「個人ID」単独だったと仮定すると正規化では有りません。単にテーブルを分けているだけです。 考えにくいですが、元のテーブルが複合主キーだった場合は第2正規化ともいえます。そうだとしても、主キーが「個人ID」だけのテーブルを作り、そこに「郵便番号」「都道府県」などの属性を移せば良いだけです。「郵便番号」「都道府県」などで分割する必要は無いです。 第2正規化は部分関数従属性の解消、つまり、複合主キーの中の一部にカラムだけで確定する属性を、単一の属性の主キーを持つテーブルに分割することです。 憶測ですが、下記の様に書こうとして書き間違えたのではないでしょうか？ ・郵便番号IDを主キーとする「郵便番号テーブル」を作る ・都道府県IDを主キーとする「都道府県テーブル」を作る 　　・ 　　・ 　　・ これだと、郵便番号IDなどを導入した上で、第3正規化を行ったという事になります。 ともあれ、「DB 正規化」などで検索すると参考となるページが多数ヒットしますので、これらを参考にご自身で検討されると良いかと。 http://www.techscore.com/tech/sql/SQL16/16_02.ht … http://www.atmarkit.co.jp/fdb/rensai/db_enginer0 … http://ja.wikipedia.org/wiki/%E3%83%AA%E3%83%AC% … なお、この文章の中で主キーと書いたところは、厳密に言うと候補キーとなります。主キーは候補キーの一つですが、主キーで無い候補キーも有ります。気になったら「候補キー」などで検索して下さい。
こんな感じでしょうか？ create table hoge (id int,user varchar(20),d date,num int); insert into hoge values (1,'A','2012/12/25',100), (2,'B','2012/12/24',200), (3,'A','2012/12/24',100), (4,'C','2012/12/23',500), (5,'A','2012/12/23',300), (6,'B','2012/12/23',200); select t1.id,t1.user,t1.d,t1.num from hoge as t1 inner join ( select user,max(d) as max_d from hoge group by user ) as t2 on t1.user =t2.user order by max_d desc,user asc,d desc
WindiwsのコマンドプロンプトはShiftJisだったと思いますが、SQLiteはUTF-8,16だったと思います。 インプットにGUIツール(PupSQLiteなど)を使ってはいかがでしょうか？
解決されていない認識で良かったでしょうか、 piroin654 さんと変わり映えしませんが回答してみます。 元々のテーブル名を「TC」と仮定します。 以下を標準モジュールに記述しておきます。 Public Function TCLCM(vCode As Variant) As Long 　　Dim rs As New ADODB.Recordset 　　Dim iNum As Long, i As Long, j As Long, iTmp As Long 　　iNum = 0 　　rs.Source = "SELECT 数値 FROM TC WHERE 項目='" & vCode & "';" 　　rs.Open , CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly 　　Do While (Not rs.EOF) 　　　　If (IsNull(rs(0))) Then 　　　　　　iNum = 0 　　　　　　Exit Do 　　　　ElseIf (rs(0) < 1) Then 　　　　　　iNum = 0 　　　　　　Exit Do 　　　　End If 　　　　i = rs(0) 　　　　If (iNum = 0) Then 　　　　　　iNum = i 　　　　Else 　　　　　　j = iNum 　　　　　　While (i) 　　　　　　　　iTmp = j Mod i 　　　　　　　　j = i 　　　　　　　　i = iTmp 　　　　　　Wend 　　　　　　iNum = iNum * rs(0) \ j 　　　　End If 　　　　rs.MoveNext 　　Loop 　　rs.Close 　　TCLCM = iNum End Function クエリは何種類かあって、表示上だけであれば 1) 更新/追加（項目・数値）したい場合 SELECT 項目, 数値, TCLCM(項目) AS 最小公倍数 FROM TC; 2) 単に表示すれば良い場合 SELECT Q1.項目, Q1.数値, Q2.最小公倍数 FROM TC AS Q1 INNER JOIN (SELECT 項目, TCLCM(項目) AS 最小公倍数 FROM TC GROUP BY 項目) AS Q2 ON Q1.項目 = Q2.項目; 2) の方が作った関数を呼ぶ回数が少ないので速いかも・・・・ テーブル「TC」のフィールド「最小公倍数」に値を設定する場合 UPDATE TC SET 最小公倍数 = TCLCM(項目); ※ 「キー項目」という項目名は、面倒だったので「項目」にしていました。 ※ 処理性能はわかりません。参考にする/しない等々自己責任にてお願いします。
数値を日付に変えるのは通算日付になるので普通出来ません。つまりOracleでも文字列を日付に変換するはずです。 つまり文字にかえてからこれです。 http://dbhikaku.web.fc2.com/sqlserver_convert.html
H2を良く知らないのですが、一般的には、group byとRownum()とを一緒に使うと うまくいかないのではなかったかと。 SELECT ROWNUM ( ) AS ID,ADDRESS,COUNT(*) AS 出身人数 FROM SAMPLE GROUP BY ADDRESS ではなく、 SELECT ROWNUM ( ) AS ID,ADDRESS,出身人数 from ( select ADDRESS,COUNT(*) AS 出身人数 FROM SAMPLE GROUP BY ADDRESS ) とするとうまくいくのでは？ ANO.1の方が示しておられるURLの The first row has the row number 1, and is calculated before ordering and grouping the result set・・・ To get the row number after ordering and grouping, use a subquery. というのが、 「group byの前に連番振りますよ、但し・・・。 サブクエリを使うと、group byの後に連番を振りますよ。」（適当な意訳ですけど） つまり上記の意味です。
単純にdatetime型のカラムで管理すればよいのでは？ create table hoge( 日時 datetime ,USER varchar(5),金額 int); insert into hoge values( '2012-01-14 10:00:00','00001',100),( '2012-01-14 10:00:00','00002',200),( '2012-01-14 10:00:00','00003',100),( '2012-01-14 10:00:10','00001',100),( '2012-01-14 10:00:10','00002',200),( '2012-01-14 10:00:10','00003',100),( '2012-01-14 10:00:20','00001',100),( '2012-01-14 10:00:20','00002',200),( '2012-01-14 10:00:20','00003',100),( '2012-01-14 10:00:30','00001',100),( '2012-01-14 10:00:30','00002',200),( '2012-01-14 10:00:30','00003',100); select 日時,USER ,金額 from hoge where (日時,USER) in (select MAX(日時),USER from hoge group by USER);
こんにちわ。 > 上記のテーブルにはIDという項目があるのですが、このテーブルで > 使用していないIDのみをSQLで抽出できないかと考えております。 ID にどのような書式でデータが格納されているか記載されていないので '00000001' から連番で入っていると仮定して 00001000までの間で使用 していない番号を求めるなら、こんな感じです。 Select to_char(level, 'FM00000000') as id from dual connect by level <= 1000 minus select id from XXXマスタ;
## Nullじゃなくて''（空文字）が登録されているような気がしますが。。。 ## select case when 変数 is null then 'NULL' when 変数 = '' then '空' else 'OK' end ## from CSVファイル ## でNullと出ずに、空とでたらそうです。 ## 調べてみないと分らないので、それはさておき、 とりあえず、 convert(datetime,変数) のほうは、 case when 変数 is null then null when 変数 = '' then null else convert(datetime,変数) end としたらうまくいくのではないかと思います。 datetime型の変数がNot Null指定でテーブルを作っているとダメですが。
設定でフルスクリーンにする 　描画距離を普通にする だいたいの設定をOFFにしてみてはいかがですか？ あるいは軽量化MODいれてみたらいいかもしれません　　　URL→http://www26.atwiki.jp/minecraft/pages/295.html 情報すくなくてすみません　　　　　　　　　　　　　　　　　　　　　
あまり考えてないので無理やり感でいっぱいですが・・・ select min(CD) + 1 from ( select CD from TB union select (101 - 1) from DUAL) where CD >= (101 - 1) and (CD + 1) not in ( select CD from TB union select (101 - 1) from DUAL ) ; とか。
動的SQLにするか、 SELECT A.* FROM testtable A WHERE A.testID = 123 AND (変数A = 0 or A.testName = 'aiueo'); なんてSQLにしておくとかでしょうか。
その後、どうですか？ 文字エンコーディングについては、お使いのエンコーディングを指定して（あるいは内部エンコーディングでよければ省略してもよいです）、以下のコードで動くのではないでしょうか？ エンコーディングはutf8としていますが、これは適宜変えてください（もしくは省略してください） $last_char = mb_substr($str, mb_strlen($str,'utf8')-1, 1, 'utf8'); まだ質問が閉じられていなかったので、気になりました。
>そこで、Slim3を使うことで、あいまい検索などRDBの様にBigTableを扱える様になる。 いえ、Slim3は、GAEで「MVCアーキテクチャー」によるWebアプリケーション開発を行うためのものです。データベースのためのものというわけではありません。（データベースアクセスを簡略化する機能も含まれていますが）そもそもSlim3導入で、あいまい検索ができるようになるわけではありません。というか、GAEにはあいまい検索のためのAPIも標準でありますから。 最近の本格サーバーサイド開発では、MVCアーキテクチャーによるフレームワークを利用して開発するのが主流となりつつあります。Ruby言語におけるRuby on Rails、PHPにおけるCakePHPといったものがこれに相当します。 MVCアーキテクチャーは、アプリケーションをモデル（データベース管理）、ビュー（画面表示担当）、コントローラー（ロジック担当）、という３つの要素に整理し、それぞれを実装していくことでアプリケーションを構築していくという考え方です。データベースアクセスなども、SQLのクエリーを直接書いたりせず、フレームワークに用意されているモデルクラスのメソッドを呼び出してアクセスするようになります。フレームワークを使って抽象化することにより、データベースなどが変更されてもコードを書き換えることなく、設定の変更だけで動かせるようになります。 GAEは、基本的な機能はAPIですべて提供されますが、MVCアーキテクチャーのための基盤は標準では用意されていません。そこでリリースされたのがSlim3です。これを導入することにより、直接APIをコールせず、モデルクラスを定義してメソッドを呼び出すだけでデータベース（この場合はBigtable）にアクセスできるようになります。 ただし、「Bigtableにアクセスしやすくする」ためにSlim3が作られているわけではありません。Slim3は、あくまでMVCアーキテクチャー実現のためのものです。それの導入により、いわば副産物的にデータベースアクセスも簡単になる、というだけのことです。 Bigtableによるデータベースアクセスに、なにか特別なものを見ているようですが、Bigtableだろうとなんだろうと、要はただのデータベースです。Bigtableは、SQLではなく、NoSQLですからちょっと違和感を覚える人はいるでしょうが、NoSQLはHTML5のWeb DBからMongoDBなどまで、今ではごく普通に使われているデータベースであり、それほど特別なものでもありません。Bigtableというデータベース機能のために、なにか特別な技術などが要求されるかのような考えは不要です。そのへんのデータベースと同じです。
起動ユーザか環境変数の問題だと思われるので・・ （１）JP1が実行するユーザでの動作検証 （２）JP1が実行するときの環境変数 の2点を確認するとよいと思いますよ。 確認するまでもなく、接続エラーの時のエラーメッセージで判るような気もしますけどね。
以下のSQLでいけると思います。 select max(C.name) as category_name, count(C.cid) as count_cid from (article_category A inner join (select aid from article_flag where display<>2) B on A.aid=B.aid) inner join category C on A.cid=C.cid group by A.cid
正直原因は分かりません。「mroonga」を使っているのが影響しているのかもしれません。 とりあえずの対症療法と考えてください。 できれば、エンジンをInnodbのみした時に再現するのかを試して、「mroonga」の問題らしければ開発コミュニティにメールしたほうがいいでしょう。
No.2です。 m3_makiさんのご回答で解決されたとのことなので、今後のご参考に、ということで。 > チェックのロジックを共通化できるのがメリットということですか。 はい、前任者の方にそういう意図があった可能性を推測しての回答でした。 例えば、テーブルの各フィールドに入力するデータを非連結フォームで 一旦受けた上で、コマンドボタンのクリックなどでテーブルに反映、という 形を採る場合、フォームモジュールで対応すると、テーブル/フォームが 異なる場合は、また同様のコードを記述することになると思います。 ここで、例えば 　a)記録先の各フィールドに一対一で対応するクラス 　　→DataAccessObject(DAO)のFieldオブジェクトを経由して 　　　 『データ型』や『入力規則』『値要求』などを取得するとともに、 　　　当該フィールドに対応するコントロールの更新時(→WithEvents 　　　使用)に、それに相当するチェックを実行 　b)記録先となるテーブル/クエリに対応するクラス 　　→上記「a」のクラスを格納するコレクションを定義しておき、記録先 　　　のフィールドに対応する上記「a」のクラス群を保持 　　　(フィールド名とコントロール名を引数とするメソッドを用意しておき、 　　　同メソッドで「a」クラスのインスタンスを生成し、コレクションに追加) という2つのクラスを定義しておけば、当該フォームのOpenイベント等で 　・上記「b」クラスのインスタンスを格納する変数の定義 　・上記「b」クラスのインスタンスの生成 　・上記「a」クラスのインスタンスを生成し、コレクションに追加するメソッド 　　の呼出(Split関数と「For Next」ステートメントを使用) というコードを記述するだけで、「テーブルのフィールドに定義された各種 プロパティへのチェック」を、フォーム毎に個別にコーディングする手間が 省ける、ということです。 (更にクラスの定義に凝れば、テーブルの『入力規則』では対応できない 　「ユーザー定義関数による入力規則の定義」なども行えるかと 　思います： 　但し、この部分は各フォームのOpenイベント等での個別コーディングが 　発生することになります) ・・・と、長々と書きましたが、私自身ではまだこれに相当するクラスを 作成したことはありませんので(汗)、細部に間違いがありましたら ご容赦願います。 あくまで、イメージということで・・・(汗)
セッショントレースで、捕まえられないのなら・・ オラクルがキャッシュしているＳＱＬを見る位しか思いつかないんですが、 データディクショナリのv$sqlやv$sqltextを見ると今実行中のＳＱＬを確認できます。 v$sessionと絡めれば、どのクライアントからリクエストなのかも切り分けできますよ。 ただし、バインド変数を使っていると、バインド変数名が表示された気がしますけどね。 SQL文を提示するといいんですが、今手元に環境がないので、ご自分で試行錯誤してみてください。 （昔、どっかの掲示板で書いてあげた思い出はあるんですが、見つけられませんでした）
ロリポップでSQLite3クラスは使えるようになっているのか?
#1 です。 ＞という事はPL/SQL内の静的SQLではバインド変数は使えないと言うことでしょうか？ ストアドプログラム（パッケージ/プロシージャ/ファンクション）内では動的以外には使えないと思います。 （SQL*PlusからストアドをEXECUTEする時の引数として使用する事は、もちろん可能ですが） 但し、私が例に書いた通り、無名PL/SQLブロック（DECLARE～BEGIN～END）内では静的にも使用可能です。 質問者様の試したサンプルで言えば。 CREATE OR REPLACE PROCEDURE TEST.TEST(v_Id IN VARCHAR2) IS v_name varchar2(20); BEGIN SELECT name INTO v_name FROM test WHERE id = v_Id; EXCEPTION WHEN OTHERS THEN RETURN; END; / これでコンパイルは通りますよね。（すいません、環境が無いので未検証です） 「これじゃ、v_Idはバインド変数にならないんじゃ？」と思うかもしれませんが、これバインド変数なんです。 （うーん、混乱しちゃいますかね？） SQLトレースを取るとわかるんですが、引数v_Idが '1' だろうが '2' だろうがトレースで解析されるSQLでは WHERE id = :b1 と言うバインド変数になるんですよ。 ＞このあたりが理解できていない部分です。 パフォーマンスチューニングで扱われるバインド変数と置換変数（リテラル）の差異を把握する事が、実はこの辺の理屈を理解する上での近道かもしれません。 OTNでパフォーマンス・チューニング・ガイドを落とすか、もしくはパフォチュー系の本を一冊読んでみるとよいかと思います。 もしJavaの経験がおありでしたら、"?"（プレースホルダ）を使ったSQLと、リテラル直指定の同じSQLをそれぞれ実行するJDBCプログラムを作って、SQLトレース（とtkprof）を取って較べてみると見えてくる物があると思います。 私自身、SQLトレースの中身を見るようになって、この辺の事が理解できるようになりましたから。 （SQLトレースに関しては前述のチューニング・ガイド等参照）
No.7に対し、頭の悪い勘違い野郎の反論。 Accessは立派な開発環境です。 ADO、DAO、ODBCで繋げばデータベースは何でもＯＫ。 そのデータを、オペレーターが自由に参照、加工できる操作画面、レポートを効率よく作れるのがMS-Accessです。 資金的、時間的余裕のない中小企業経営者が、寝る間を使って勉強すれば素人でもそれなりに使えるDBが組めるソフト、簡単過ぎず、難解すぎでもない、絶妙なバランスにあるのがAccess。 「マクロと関数、それ以上なら次に行くしかない」ですか・・・・ 私には意味がわかりません。 マクロ、関数の先を勉強していますが、その先は進めば進むほど奥が深いです。 むしろ、その先の方が実務に必要なテクニックが多く眠っています。 ちなみに、以前VB2005をいじりましたが商売に使える伝票（＝レポート）を作るならAccessレポートをVBAで動かした方がVB単体で描くより何十倍も表現力豊かな帳票が作れました。 ソフト開発には３つの立場の人がいます。 金を払う依頼人、金をもらうプログラマ、そしてソフト使い日々の実務を行うオペレーター。私は毎日一人３役で仕事をこなしています。 こんなことが可能なのは開発効率が極めて高いMS-Accessのおかげです。 資金に余裕があり、人材も豊富で、開発時間も十分にある会社なら「Accessである必要性は無い」の意見に、私も同感です。
とか。
バージョンによって、名称が違うけど、8iだか9iの頃から機能的には用意されていますよ。 設定が面倒だけど、他社製DBMSを、DBLINKしたオラクルDBのごとく扱えます。 http://otndnld.oracle.co.jp/document/products/or … 参考URL：http://otndnld.oracle.co.jp/document/products/or …
自分はMongoDBを使ったことはありませんが、MongoDBのマニュアルにはそういうことが書いてあるように見えます。 http://docs.mongodb.org/manual/faq/concurrency/ http://docs.mongodb.org/manual/faq/concurrency/# … によれば、ほとんどの操作に対してdatabase単位でロックを行なっているようです。 read/write lockなのでwrite lockが必要なケースが少ないと問題ないでしょうが、ユーザーによる更新が多発する場合には大きな問題になりそうです。 http://docs.mongodb.org/manual/faq/concurrency/# … 更新の際には当然、write lockが行われるようです。 work aroundとしてはすべてのユーザーを単一のdatabaseに入れるのではなく、ユーザーIDごとに散らして入れておくという方法がありそうですが。複数のユーザーに関わる操作をされた場合には複数のdatabaseのロックを取得しないといけなくなります。
ここでLINQについて質問しても回答は出ないのでは。 C#カテのほうが向いてると思うよｗ LINQは本当に便利。取得だけならSQLなど一行も書く必要ないし、オブジェクトに詰める手間もいらない。 キモは、Group化してまとめたボディ部を、Selectで別の型に変えるところでしょう。 public List<MemberTypes> GetMemberTypes(){ 　using (var dc = new DataContext()){ 　　return dc.MemTypeBinds 　　　.GroupBy(mt=>mt.Member) 　　　.Select(g=>new MemberTypes{ 　　　　member　= g.Key, 　　　　types　= g.Select(mtg=>mtg.Type).ToList() 　　　}).ToList(); 　} } 逆の種別->メンバー（複数）変換も書いてみたｗｗ public List<TypeMembers> GetTypeMembers() { 　using (var dc = new DcHealth()) { 　　return dc.MemTypeBinds 　　　.GroupBy(mt => mt.Type) 　　　.Select(g => new TypeMembers { 　　　　type　= g.Key, 　　　　members= g.Select(mtg => mtg.Member).ToList() 　　　}).ToList(); 　} } 面白いｗｗｗ
まず基本から 選択肢が複数ある条件分岐はIFよりCASE WHEN のほうがいいかも また偶数奇数だけの判定ならMOD処理はIFをつかわなくても処理できます select V1 ,1-MOD(V1,2) as FLG1 ,CASE WHEN V1>=20 THEN 'L' WHEN V1>=10 THEN 'M' WHEN V1>=0 THEN 'S' END as FLG2 from tbl1; これを単純にデータを確認したいだけならviewをつかえます create view view1 as select V1 ,1-MOD(V1,2) as FLG1 ,CASE WHEN V1>=20 THEN 'L' WHEN V1>=10 THEN 'M' WHEN V1>=0 THEN 'S' END as FLG2 from tbl1; select * from view1; アップデートするならこんな感じ update tbl1 set FLG1=1-MOD(V1,2) ,FLG2=CASE WHEN V1>=20 THEN 'L' WHEN V1>=10 THEN 'M' WHEN V1>=0 THEN 'S' END; select * from tbl1; なおストアドプロシージャなどで処理するともう少し効率的になりそうですが 今のスキルだとまだそこまでやるのは難しいかもしれませんね
ひとつの繰り返しフィールドの消去は 変数を設定 [ $n; 値:1 ] Loop 　消去 [ テーブル::その繰り返しフィールド[$n] ]　---[]は繰り返し数指定欄に 　変数を設定 [ $n; 値:$n+1 ] 　Exit Loop If [ $n=LeftWords( FieldRepetitions ( Get ( ファイル名 ) ; 　　　　　　　　　 Get ( レイアウト名 ); Get ( アク ティブフィールド名 ) ) ; 1 )+1 ]　※ End Loop ※の部分は繰り返し表示数が3なら、単にExit Loop If [ $n=4]でもいいです。
クエリ(Query)は「問い合わせ」の意味でSQLのQは元々はQueryの略でしたが今はSQLで一つの言葉になっています。ビュー(View)は「景色」や「見解」と言った意味ですが、RDBMSでは実際のテーブルをSQLのSELECTで問い合わせた状態を、仮想のテーブルと見立てる場合に使用します。ちなみに私の作っているツールは７種類のRDBMSに対応していますが、テーブル名一覧等のテーブル構造がRDBMS毎に異なるのでViewを造って見かけ上同じ構造のテーブルに見立てる事でツール側ではどのRDBMSでも同じ書き方でSQLが書けるので便利に使っています。
Connectionを開きっ放しにして置くと排他や競合で問題が発生する可能性が高いので、 必要な時だけ開き終わったらすぐ閉じるのが原則かと思います。 細かく書いてゆくのが基本かと考えますが 標準モジュールに Sub myOpenCn・・・ Sub myCloseCn・・ のようなものを作成して 各ボタンには Call myOpenCn 処理・・・・ Call myCloseCn のようにしておけば良いのでは？
テーブルから別のテーブルへだったら INSERT INTO table1 SELECT cast(aaa as char), bbb, ccc,・・・ FROM table2 WHERE ～～～ こんな感じでできるんじゃないかな～
>SQLが使えるツール によって変わってくる場合がありますが、 SELECT メルアド FROM テーブルA WHERE 郵便番号 IN (SELECT 郵便番号 FROM テーブルB) とか。
こんな感じで、Access2010で書いたので2000だとエラーになるかも？ DAO 3.6？に参照設定が必要です。 タブインデントの代わりに全角スペースを使っています。 Sub test() 　　Dim DB As Database 　　Dim DB2 As Database 　　Dim tdf As DAO.TableDef 　　Dim i As Integer 　　Const mdbPath As String = "c:\顧客管理.mdb" 　　Const tblName As String = "MT住所録" 　　　　 　　If Dir(mdbPath) = "" Then 　　　　MsgBox mdbPath & "が見つかりません" 　　　　Exit Sub 　　End If 　　 　　For Each tdf In DB.TableDefs 　　　　If tdf.Name = tblName Then 　　　　　　DB.Execute ("drop table " & tblName)　'テーブル削除 　　　　　　Exit For 　　　　End If 　　Next 　　 　　Set DB = CurrentDb 　　Set DB2 = DBEngine.OpenDatabase(mdbPath) 　　For Each tdf In DB2.TableDefs 　　　　If tdf.Name = tblName Then 　　　　　　i = 1 　　　　　　Exit For 　　　　End If 　　Next 　　 　　If i = 0 Then 　　　　MsgBox mdbPath & " に " & tblName & "がありません" 　　　　DB2.Close: Set DB2 = Nothing 　　　　Exit Sub 　　End If 　　 　　DoCmd.TransferDatabase acLink, , mdbPath, acTable, tblName, "リンクテーブル１" 　　 　　'[切り離し] 　　'DoCmd.DeleteObject acTable, "リンクテーブル1" 　　DB2.Close: Set DB2 = Nothing End Sub
実験した訳ではなく予測で回答しますのであしからず。 一応SQL　Server認証は通常はWindows認証は不要です。 (1)Guestユーザーを有効化してみてはどうでしょうか。 (2)昔パソコンへのログインIDがサーバーにも有っ、てそのパスワードが異なると動かない場合がありました、パソコンへのログインIDをサーバーには存在しない物にしたら動きませんか。
バージョンによって違うかもしれませんが、 enterprise manager で表示できませんでしたっけ? 各オブジェクトのDDL が表示できたと思います。 でも、export して import すれば同じものができると思いますけどね。
※「当月」初日の求め方 「当日」を「月」で切り捨てる TRUNC(SYSDATE, 'MM') ※「前月」末日の求め方 「当月」初日の前日は「前月」末日 TRUNC(SYSDATE, 'MM') - 1 ※「前月」初日の求め方 「前月」末日を「月」で切り捨てる TRUNC(TRUNC(SYSDATE, 'MM') - 1, 'MM') ほかの方の回答と合わせれば、もう大丈夫でしょう。
> そのソフトを私のデスクトップにインストールするのでしょうか？ はい、そうなります。 > SQL Serverというソフトなら基幹システムから落ちてくるMDBファイルを今のように扱えるのでしょうか？ MDBにあるデータ(テーブル等)をインポートして使うことになります。 単体ではもしかすると使い辛い部分があるので、フロントエンドはAccessをお使いになられた方が良いかもしれません。 参考書など多数出てますので・・・それぐらいは経費でなんとか・・・ 現在サポートされている(といってもセキュリティパッチがダウンロードできますよの意味)SQL Server Expressは以下にあります。 バージョンが新しいほど、必要なスペックはあがるとお考えください。また、対象OSも異なりますので、それぞれリンク先を確認してください。 Microsoft SQL Server 2005 Express Edition Service Pack 3 http://www.microsoft.com/ja-jp/download/details. … Microsoft® SQL Server® 2008 R2 SP2 - Express Edition http://www.microsoft.com/ja-jp/download/details. … Microsoft® SQL Server® 2012 Express http://www.microsoft.com/ja-jp/download/details. …
select Aテーブル.ID,MAX(TIME) from Aテーブル,Bテーブル where Aテーブル.ID=Bテーブル.ID group by Aテーブル.ID です。
実際に試したことは無いのですが Windows 2000でSQL Server 2008 R2は動作対象外なので動かない （インストール時に弾かれる）と思います。 そもそもWindows 2000は、すでにサポート終了しているため 不具合があっても修正されません。 SQL Server 2008 R2を Windows Server 2008 R2 に入れて ネットワークで接続されたWindows 2000に DB を置いて ほかの端末から SQL Serverにアクセスとかなら できると思います。 （この場合、Windows 2000にDBを置く意味が無い）
>データベースとのセッションを切断してもサーバ上にhsodbcプロセスが解放されずに残る現象が発生しています。 というのは当然かと思います。 設定方法とかを見ていると、Listenerで定義していること等から、OracleサーバとListenerの間での接続なので、クライアントがセッションを切ろうが関係なく、 Oracleサーバが必要だと思っている限りは、クライアントがどうしようとつながっているから、 hsodbcは解放されないと思えます。 じゃあ、クライアントから接続を切る方法はないのかと調べてみました。 Oracle10gじゃないけど、11gR2では以下のような説明を見つけました。 （10gは調べてみてください。10gではまだ実装されていない機能かもしれません。） --引用-- アプリケーションで不要になった高コストの接続を切断するには、データベース・リンクを使用して確立されたリモート接続を終了することが有効です。・・・（中略）・・・ 次の文は、salesデータベース・リンクが指すリモート・データベース内のセッションを終了します。 ALTER SESSION CLOSE DATABASE LINK sales; 以上以下のサイトより。 http://docs.oracle.com/cd/E16338_01/server.112/b …
Access2007 → SQLServer2008 で出来ないものが 後発のSQLServer2012なら、なおさら無理というものでは？ >状況 >この動作は仕様です。 ↑これは、哀しいですねぇ。 なお、Access2013からは、 『アップサイジング ウィザードを使用すると、Access データベース テーブルを新規または既存の Microsoft SQL Server データベースにスケール アップできます。この機能は Access 2013 で削除されました。』 です。 他にも、ひどいと思う変更が幾つか。あんまりだ！ Office 2013 での変更点 http://technet.microsoft.com/ja-jp/library/cc178 …
-- こういうことじゃないのかな？ select X1, min(X1) over (partition by substr(X1,1,1)) from zz where 条件
＞後ろページの取得は上手くいきます であればソート順を逆にしてもう一度SQLを発行すればデータがとれるのでは？
ああ、ごめんなさい、中途半端なソースさらしてしまいましたね $sql = "select sum(c1) as c2 from (select count(*) as c1 from テーブル1 union all select count(*) from テーブル2 ) as sub"; $res = mysql_query($sql,$myLink); $rows = mysql_fetch_array($res,MYSQL_ASSOC); print $rows["c2"]; みたいな感じです。 ただし、いまはmysql_query()は使わないように指導されています。 別の方法を試した方がよいでしょう。 もしなにか参考にしている書籍があるならそれは古いのでもう少し 新しいものを用意した方がいいかもしれません。
番外回答： 提示されたサイトを見ましたが自分には理解できませんでした マイクロソフトなのでIIS起動が条件になると思うのですが・・ というような人の回答です 大げさな表現をさせますが、1台のパソコンに無償の「Xampp」なるソフトを組み込み、このパソコンに無線LANルーター（WiFi）を有線LANで接続して電波を発信します この無線LANルーターの届く範囲に持ち込まれた無線受信可能パソコンが発信電波をとらえて使用許可が取れれば（WiFi）親PCが持っている固有のデーターベースに接続できます この親PCがどのような固有データーベースを発信しているかによって、持ち込みPCのユーザーは使う使わないを判断します ということで全く不可能ではありません（ここが言いたかっただけ）
Accessとオラクルクライアント機能だけで処理可能だと思うのですが、あえて別に用意したいということですか？ もし、あえてフリーソフトを使いたいということであれば、その理由を挙げた上で質問されると、紹介できるものがあるかも知れません。
#1 です。 最初のIF の条件に合った場合の処理と 合わなかった場合の処理を明確に区別しましょう。 それぞれを BEGIN END でくくります。 そしてそれらの間に ELSE を記述します。 つまり、以下のように記述します。 IF (@@FETCH_STATUS = 0) BEGIN IF (@column_new_value$19 = 1) update ・・・ ELSE IF (@column_new_value$19 = 2) update ・・・ END ELSE BEGIN IF (@column_new_value$19 = 1) insert ・・・ ELSE IF (@column_new_value$19 = 2) insert ・・・ END いかがでしょう? 元のソースがどうなっているか判りませんが、 ツールも100% では無いと言うことでしょう。
そもそもSETをつかうならSETの選択肢にリンゴ、オレンジ・・・と 最初からキーワードをいれておけば済みます。 SETで別テーブルを参照する正規化は効率的ではないとおもいます。 逆にクライアント側からの入力を制限したいという目的であれば 外部キー制約の方がよいかと。 //まず果物テーブルを作り create table `kudamono`(`id` int,`kudamono` varchar(20),index(`id`)) engine=InnoDB; insert into `kudamono` values(1,'りんご'),(2,'オレンジ'),(3,'いちご'),(4,'メロン'),(11,'おまけ'); //外部キー制約付きで商品テーブルを作ります create table `shohin`(`group` varchar(20), `item` int ,foreign key(`item`) references `kudamono`(`id`),unique(`group`,`item`)) engine=InnoDB; //データはitemを個別に持たせます insert into `shohin` values('果物群A',1),('果物群A',3),('果物群B',2),('果物群B',4),('果物群C',2),('果物群C',11); //groupとitemの組み合わせを表示するにはこう select `group`,group_concat(cast(`item` as char)) as `items` from `shohin` group by `group`; //果物名を表示させるにはこう select `group`,group_concat(`kudamono`) as `kudamonos` from `shohin` as s inner join `kudamono` as k on k.id=s.item group by `group`;
並べ替えについて回答させてください。 >>レポート1の問題を踏まえ、一応、項目名Eを除外して集計しています（現時点で未解決） ここでは、担当者の並び替えを任意に行いたいです。 昇順や降順ではなく、例えばあ・い・う・え・おを、い・う・あ・お・えのように並べたいのです。 リレーションの機能を使って出来ます。記載順のテーブルを別に作成し、これに二つの項目を入れます。順番の番号(1,2,3・・・)と担当者氏名です。そこで並べ替えをしたいテーブルと記載順テーブルを氏名をもとにリレーションを設定します。 次にクェリーを実行します。二つのテーブルの必要事項を取り込み、ここで並べ替えの設定を記載順のテーブルの番号を基準に指定すれば、実行の結果は希望のものになります。
SQL Server は同一マシン上にいくつもインストールすることができる。 SQL Server は DB を管理するサービス (DBMS) なので、同一マシンに複数インストールすれば、同一マシンで複数の DBMS が稼動することになる。 1つめの DBMS で管理されている DB-A という DB があったとして、さらに 2つ目の DBMS にも DB-A という DB があったとしても、1つ目の DBMS で管理している DB-A と 2つ目の DBMS で管理している DB-A は別物である。 これは Windows のフォルダーで考えればわかりやすい。 1つのマシン上には複数のドライブ (C とか D とか) をマウントできる。 各ドライブには当然ながらフォルダーがあるが、C:\hoge と D:\hoge という 2つの同じ名前のフォルダーはドライブが違うので別物である。 で、本題。 同一マシン上に複数の DBMS をインストールする場合、それぞれの DBMS のインスタンスに名前をつけて区別する。 ただし 1つの DBMS しか稼動させない場合は名前をつける必要がない。これを 「既定のインスタンス」 と呼ぶ。 既定のインスタンスが稼動しているマシンに 2つ目の DBMS をインストールする場合、すでに稼動している既定のインスタンスと区別するために何か名前をつける必要がある。これが 「名前付きインスタンス」 である。 ただし DBMS を 1つしか稼動させない場合でも、何が何でも既定のインスタンスにしなくてはならないわけじゃなく、名前をつけてやってもかまわない。 例外として、SQL Server の無償版である Express Edition は、通常は名前付きインスタンスとしてインストールされる。 名前付きインスタンスを指定せずにインストールした場合は、既定の名前付きインスタンスである SQLExpress が使用される。
ご質問のコードは１行目の第０番目のデータを表示させていますが、select命令の取得フィールドを２つとも指定するようにできます。 そして、fetch を　fetch_assocに変えて、count(*)に別名kosuを与えて、連想配列で$num->idと呼び出すようにできます。 ただし、このようにしてデータ件数分だけ繰り返したとして、count()関数をその度に繰り返すでしょうから時間的ロスは出るので、別々にするのが効率的と思われます。 また、ＰＤＯを活用するとしたら、基本的なＳＱＬの操作方法は共通ですから、ＳＱＬの文法と繰り返し取得とフィールドの分割が分かれば、SQLの違いに関わらす自由に操作できます。 $pdo = new PDO(sqlite:test.db); $query = $pdo->prepare('SELECT id, count(*) AS kosu FROM testTable WHERE id > 0 AND id < 10'); $query->execute(); $num = $query->fetch_assoc(PDO::FETCH_NUM); // id,kazuを指定して echo $num->id; echo $num->kazu;
＞alter table table modify id varchar(10) binary ああ、そういうバイナリですか・・・ であればこんな感じで標準のutf8にしてはいかがでしょうか？ alter table `テーブル名` modify id varchar(10) character set utf8 collate utf8_general_ci （もしくはcollate utf8_unicode_ciなど）
SELECT * FROM db where (name,update,time) in (SELECT name,update,MAX(time) FROM db WHERE name LIKE \"%{$search}%\" GROUP BY name,update) じゃない？
▼以下のSQLで無効化できます。 alter index ind_test invisible; alter index ind_test unusage; 有効化は以下です。 alter index ind_test rebuild; invisibleでオプティマイザから索引が見えなくなります。 unusageでDML発行時の索引の更新を抑止します。 有効化するときはテーブルと同期がとれていない状態なので 索引を再構築する必要があります。 ▼無効化している間のDMLで索引も更新されても問題ない場合はunusageのみでOKです。 alter index ind_test unusage; 有効化は以下です。 alter index ind_test usable; こちらの方が手軽ですが、大量データを入れる場合の性能改善はありません。 索引がない場合のオプティマイザの動作確認に使うくらいでしょうか。
JPN\x64\SQLEXPRADV_x64_JPN.exe をダウンロードすれは間違い無いです。 これには全ての機能が入っています。 インストールの時に選択してください。 リンク先をちゃんと読めば違いが書いてありますよ。 単に DBだけが必要で他の機能は不要なったら JPN\x64\SQLEXPRWT_x64_JPN.exe でも良いかもしれません。
管理番号がテキスト型でしたらこちらで。 累計: DSum("試験時間","テーブル9","管理番号='" & [管理番号] & "' AND 開始日付 <= #" & [開始日付] & "#") 確認してみてください。
> cdate順にsortしたら、１２月の人より、１月の人が先に出ます。 > １２月の人の次に１月の人が出るようにしたいですが。。。 普通は月は1,2,3．．．11,12の順番だと思います。 実際に12月を1月の前にするとすると、11月や2月の扱いはどうしたいのでしょうか？
SELECT * FROM `table` WHERE 1 AND `s1`='あああああ' AND ifnull(`s2`,'いいいいい') = 'いいいいい' なんて方法もあります。 ※ifnull()は、MySQL5.1の文法書を参照して見つけています。 http://dev.mysql.com/doc/refman/5.1-olh/ja/contr … 使っているVerによって違うかもしれませんから確認してください。
http://dev.mysql.com/doc/refman/5.1/ja/gone-away … wait_timeoutを伸ばすと解決するのでは？
No.1です > 他に原因と思われるところ う～ん、とりあえず、思いつくところを挙げてみます(汗) 1)Accessでのキー操作に対する制限方法としては、前述の 　設定の他には「AutoKeys」マクロがあるので、その端末の 　ツールにそれがないかを確認してみる： 　(『テーブル』『フォーム』などの一群の中に『マクロ』というのが 　　あるので、そこで上記の名前(全角半角・大文字小文字 　　は問わない)のものがないかを確認) 　http://www.accessclub.jp/samplefile/samplefile_1 … 　お使いのAccessが2010の場合はややこしそうですが・・・(汗) 　http://www.free-style.biz/lifediary/2011/06/acce … →上記マクロで、『マクロ名』欄に「{F11}」が割り当てられている 　 ようなら、これが原因の可能性大。 　 但し、同一ツールなら他の端末のものにもあるはずなので、 　 『アクション』等の指定が異なっていないか、或いは一方で 　 「{F11}」に「+」や「^」などが組み合わせになっているのに、 　 他方でそれがない、といった違いがないか、を確認 2)ご自身でも予想されているように、ファイルが破損している： 　F11キーが有効になっている他の端末から、ツールをコピー 　して、そちらが正常に動作するかを確認してみる →コピー(差し替え)で直るようなら、破損だった可能性が高い。 　 (丸々コピーだけでよいなら上記のままでOk、ローカルテーブル 　　の内容が各端末で異なるようなら、そのデータをインポート 　　して、差し替えたファイルを使用する) 3)CtrlキーとGキーを同時押しして『イミディエイト ウィンドウ』を 　開き、そこに以下のコードを入力後、Enterキーで改行して、 　データベース ウィンドウが表示されるか確認： 　(SelectObjectメソッドの詳細については、ヘルプを参照下さい) 　　　DoCmd.SelectObject acTable, , True →上記「2」では改善せず、こちらで表示されるようなら、 　　ａ)キーボードのF11キーの不具合の可能性 　　b)Accessアプリケーション自体の不具合の可能性 　が疑われるので、 　　a)別のキーボードがあればそちらを接続して確認。 　　　別のキーボードでそのまま使用可能ならそれで対応。 　　　ノートPCなどで交換できず、端末をそのまま使い続ける 　　　しかない場合は、上記コードを適当なフォームに埋め込む 　　　か、「1」で紹介したAutoKeysマクロを使用してF11キー 　　　以外のキーにデータベース ウィンドウへのショートカットを 　　　割り当ててしのぐ 　　　(SelectObjectは「オブジェクトの選択」アクションに相当) 　　b)コントロールパネルから「プログラムの追加と削除」から、 　　　Officeアプリケーションの修復(又は再インストール)を 　　　試す 　　　念のため、Office UpdateまたはMicrosoft Update 　　　(前者は後者に統合されてもうなくなってましたっけ?(汗)) 　　　も行った上で、他の端末と同様の動作になるか、確認 ・・・以上です。 とりあえず、どれかで解決するとよいのですが・・・(汗)
未満がよくわからないと・・・ 未満はその数を含みません。 なので、整数より小さい数を四捨五入する。 小数点以下の桁数を調整するだけでいいのかな？ とも思いますが（小数点表示桁下げで5.66なら.66をなくして6にする） たとえば、関数を使って小数点以下を操作しなしさい と言われたら A１の数値を操作する場合 「整数未満四捨五入」・・・=ROUND(A1,0) 「整数未満切り上げ」・・・=ROUNDUP(A1,0) 「整数未満切り捨て」・・・=ROUNDDOWN(A1,0) とし、これが「小数第２位未満」と指定されたら ０のところに２を入れます。 5.678だったとしたら、.678の6を四捨五入して６にする。
なんか、質問内容と回答に対する補足を見ていると．．． 設計側の物を、使用者側に、そのまま見せてる感じ？ たとえば 「設計側」 コードマスター（ID,名称） 1,'北海道' ．．．．． 20,'東京' ．．．．． 47,'沖縄' 社員出身マスタ（社員コード,社員名,出身コード,方言） 1,'あ',1,1 1,'い',2,2 となっているとすると 「使用者側」 社員名を入力 or 選択（同姓同名がいる場合があるため、社員コード入力等が望ましい） 出身を選択（北海道, 東京, 沖縄 等から選択） 方言を選択（北海道, 東京, 沖縄 等から選択） 多くのシステムでは、こうなっています。 ですので、使用者側がコード入力する箇所は、社員コードぐらいですね。 ただし、昔から（汎用機）のシステムを使っていて、ずっと同じように使いたいという 会社もあります。 そのような場合、コード入力の方が、選択 or 漢字入力よりも慣れているため あえて、コード入力を使用者側がするということもあります。
select id,name from または select id,name,NULL place from としてみては？ Ｏｒａｃｌｅの表記なので、少し違うかも。。
SELECT case when （ドロップダウンリストの値） = 1 then 列１　 when （ドロップダウンリストの値） = 2 then 列２ when （ドロップダウンリストの値） = 3 then 列２ end FROM table1 （ドロップダウンリストの値） は変数として引き渡してもいいし、Select文を組み立てるときに 固定値をセットしてもいい。 固定値の例） （ドロップダウンリストの値）が1なら、 SELECT case when 1 = 1 then 列１　 when 1 = 2 then 列２ when 1 = 3 then 列２ end FROM table1 となるので、列１が返ってくる。
tb_trn_aa_day_r の定義が分からないと、正しい回答は出来ないような気がします・・・ >全てNUMBER型のテーブル列で、NOT NULL制御を施しています。 とありますが、仮に tb_trn_aa_day_r が、テーブル%ROWTYPE だとしても各カラムの制約は引き継がれません。 そこを勘違いされているのかもしれません。 また、 >ちなみに、tb_trn_aa_day_r.tx_00～tx_23に「0」をセットしても とありますが、これはどのようにセットして確認したのでしょうか？ TO_NUMBER2ですが、strにどんな値が来たときにexceptionブロックに飛ぶことを期待していますか？ 空文字やNULLの場合は、exceptionは発生しないのでNULLが返りますよ。
んと、クライアントのバージョンだけInstant Client 10.2とかに あげるならばADO.NETもODP.NETも可能ですが、7のままだと確かに ADO.NETはダメなようですね。 そうすると当然同じテクノロジーを利用しているODP.NETもダメです。 クライアントとサーバのバージョン差異がでかすぎると怪しいですし。 OLEならいけるかも、らしいですよ。 ただ、速くなるかどうかは別のお話なので、どうしても変えたいなら COMでoo4oを使うのが限界じゃないでしょうか。
SSRSは使っていないのでよくわからないですが、 一般にSQLで、パラメタによってdistinctをするしないを区別するのは無理です。 （パラメタによって別のSQLをそれぞれ発行するしかないです。） 無理やりするなら、 select * from (select A1,A2,A3,・・・,row_number() over(order by A1,A2,A3,・・・) as rn from tableA) group by A1,A2,A3,・・・,case when (パラメタ) = 'する' then 1 else rn end でできるでしょうけど。 注： select distinct A1,A2,A3,・・・ from tableA と select A1,A2,A3,・・・ from tableA group by A1,A2,A3,・・・ は同じ結果になります。
リストボックスの名前が LST1 チェックボックスの名前は CHK1 LST1の隣などの同じセクションにCHK1 が有るとしたら CHK1 のクリック時イベントにて Private Sub CHK1_Click() Me!LST1.Visible = Me!CHK1.Value End Sub とかでは？
何を持って誤ったデータと判断するのか。条件がさっぱり見えてきません。 読み取れる規則性としては codeが同じであれば noは1から連番 yearは昇順 noXのyear < noX+1のyear つまり noXのyear > noX+1のyear を見つけ出せば解決ですか？
GETDATE関数、CONVERT関数？ もしかしてお使いのRDBMSはMS SQL Serverでは？ それなら select id,endtime from [テーブル名] where endtime>=getdate() MySQLなら select id,endtime from [テーブル名] where endtime>=now()
おかしくなって当然です。 回避策は、#2 さんがしめされているので なぜか？ の部分をExcelの場合で説明されています。 SQLServer でも考え方は一緒です。 ※ #2 さんの詳しい解説ですね。 日経PC21 / エクセル（Excel）「演算誤差」対策講座 http://pc.nikkeibp.co.jp/pc21/special/gosa/
解決策となる回答では無く恐縮です。 似たような現象で Win7 64bit + Filemaker Pro11で再変換が利きません FMPro12も怪しいですが、Win7の64もかなり怪しいかと MSからのSP待ちで解決するかどうかですね？
ANo1です。 ＜追加したい条件4＞ ・Bテーブル「created_at」カラムの値で、一番新しいレコードが複数あった場合、 Aテーブル「id」カラム(int型)が一番大きいレコードを1件返す ですけど、 ■前提 ・Aテーブルの1レコード(「id」カラム)に対して、0～複数のBテーブルレコード(「a_idカラム」)がある ・A.id = B.a_id からいうと、 一番新しいレコードが複数あった場合、 Aテーブル「id」カラム(int型)は同じ値になるはずですけど。 ★ひとつだけ2件重複取得されているレコードがありました。 というのが、まったく同じレコードが２件出てきたということなら、 当初の回答のselectの次にdistinctをいれればよい。 select distinct a.id,a.created_at as Acreated_at,a.area, b.a_id,b.created_at as Bcreated_at from Atable a left outer join Btable b on a.id = b.a_id and b.created_at = (select max(c.created_at) fron Btable c where c.a_id = b.a_id) ★この質問に挙げた仕様はサンプルレベルなので、実際には、Bテーブルのほかの項目もselectしている ならば、Bテーブルのほかの項目で判断しないと意味がないと思われます。 ・・・該当するほかの項目を挙げてもらえばSQLを直します。
他の方の指摘通り、commentは予約語です。 で、予約語を項目名につけたときの指定は、""でくくればよかったはずです。 update table set "comment" = '新規' where code = '111'; で試してみてください。 ※予約語を項目名に使うことはお勧めしません。。。
【要旨】 値集合ソースやクエリのSQL文では、 　((テーブル.カラム) like "'*" & Forms!フォーム!テキスト1 & "*'") と、「'」は入れずに、 　((テーブル.カラム) like "*" & Forms!フォーム!テキスト1 & "*") としてください。 【詳細】 VBA上でSQL文を扱う場合や、DMaxなどの定義域集計関数の引数にする 場合は、確かに「*」と同時に「'」を使用しますが、クエリ(又は値集合ソースへの 直接入力)に使用する場合は「'」は使用せず「*」だけを指定します。 ちょっとわかりにくいかもしれませんが(汗)、完全一致の場合も、 　((テーブル.カラム) = "'" & Forms!フォーム!テキスト1 & "'" ) ではなく 　((テーブル.カラム) = Forms!フォーム!テキスト1 ) と、「'」を使用せずに指定しないと正しい結果が得られないのと同様と 考えて戴ければいいかと思います。 くどくなるのを承知で(汗)、さらに説明すると・・・ VBAでは、例えば「Me.氏名」に「鈴木」という値が入っていたとして、 　strSQL = "Select * From テーブル1 Where 氏名 Like *" & Me.氏名 & "*;" という変数への記録を行った場合、実際のWhere句は 　氏名 Like *鈴木* となって 　氏名 Like "*鈴木*" とはなってくれません。　 (「*」がワイルドカード文字ではなく乗算の演算子として扱われてしまう、と) これを防ぐため、VBA上でSQL文を扱う場合は、「'」を(又は「"」を重ねて) 使用する必要があります。 一方、クエリやSQL文を直接編集する場合は、 　氏名 Like "*鈴木*" とか 　氏名 Like "*" & Forms!フォーム!テキスト1 & "*" といったように、予め「*」を「"」で括って文字列(ワイルドカード文字)として 明示していることになります。 なので、逆にここに「'」を追加すると、その「'」まで「検索文字列」として 指定したことになってしまうので、意図した抽出結果が得られなくなる、 ということです。 ・・・以上、長くなりましたが、参考まで。 なお、余談になりますが、この「Like」は「関数」ではなく「演算子」になります。
土地テーブルと家屋テーブルは、同一所有者ＩＤで同一取得日で複数のレコードがあってもおかしくない はずだけれども、テーブルの項目がないので、ないと仮定しましょう。 （あったら以下のSQLではうまく結果はでません。） select a.所有者ID,a.所有者名 as 名前,b.土地取得日,b.面積,c.家屋取得日,c.延床面積 from 所有者テーブル a, (select b2.所有者ID,b2.取得日 as 土地取得日,b2.面積, ROW_NUMBER() OVER(PARTITION BY b2.所有者ID ORDER BY b2.取得日 DESC) as No from 土地テーブル b2) b full outer join (select c2.所有者ID,c2.取得日 as 家屋取得日,c2.延床面積, ROW_NUMBER() OVER(PARTITION BY c2.所有者ID ORDER BY c2.取得日 DESC) as No from 家屋テーブル c2) c on b.所有者ID = c.所有者ID and b.No = c.No where a.所有者ID = case when b.所有者ID is null then c.所有者ID else b.所有者ID end という感じでできるはずです（未検証）
行を一意に識別できる unique かつ not null な属性群が主キーですから， > id name sex date1 > 1 'A' '男' 20120101 > 1 'A' '男' 20120101 と，同じ内容の行が複数存在しているというのが事実であるなら，それは質問者が主キーだと思い込んでいるけれど主キー設定されていないということを示しています。 となると，失礼ながら，質問文に挙げられたデータ例の真偽も少々訝しく感じられてきてしまいます。確認のため差し支えなければ，次の３つのSQLをそれぞれ実行して表示された結果を，そのままCopy&Pasteで提示していただけるとありがたいです。 (1) select * from table; (2) select min(date1) from table where id = 1 and name = 'A' and sex='男'; (3) select * from table where date1 = (select min(date1) from table where id = 1 and name = 'A' and sex='男');
> SQLの抽出条件「forms!サブ１!a」として、上記で取得した > テキストボックスaを使用しております。 > > サブ１をメインフォームで開き上記を実行すると値を抽出します。 Forms!メインフォーム名!サブフォームコントロール名.Form!a としてください。 あるいは、単純に、[a] とするだたけでもOKです。Formsの指定がない場合は自分自身のフォームから探しますので。また、この方法だと単独で開いても、サブフォームとして開いても正常に動作しますのでお勧めです。
インストールはうまくいきましたか？ あと、システム用件は満たしていますか？ WindowsXPの場合、 SP1とSP3がセットされている事が条件とのことです。
まったくSQLを使っていませんが、logがそのまま残っているのなら、このような方法があります。 cut -c1-19 <log.log|uniq -c >result.txt 日付時刻部分を切り出してuniq -cで行数を数えるものです。 2日分300万件の疑似ログデータを作成して8秒で集計できました。 除外したいデータが有る場合にはgrepなどを入れる必要があるのでもう少し時間がかかりますが。 ご参考に
アプリケーションからはどのような接続方式なのでしょう？ VBとかのアプリケーションであれば何もせずに移行できる場合もあります。 面倒そうなのは、 ・システムテーブルを直接操作している　→　方法が少し変わった ・DBCCコマンドを使用している　→　T-SQLに変わった （互換性レベルを90以上にする場合） ・外部結合演算子を使っている　→　OUTER JOINに変更する必要がある ・ORDER BYでテーブル名にプレフィックスを付けていたりする　→　エラーになる これに該当しなければ、そのまま動くかもしれません。
SELECT `数量` ,COUNT(`商品ID`) FROM `売上げ明細` WHERE (`商品ID`, `単価`) IN (SELECT `商品ID`, MAX(`単価`) FROM `売上げ明細` GROUP BY `商品ID`) GROUP BY `数量`
ゴミではないと思いますがGoogleっても、MS社のですら出てきませんね。 とりあえず確認できたこと。 MDBファイルには存在せず、ACCDBファイルにのみ存在する。 Access2010でMDBファイルを作っても無い。 新規ACCDBファイルでオブジェクトを全く作成せずに MSysObjectsテーブルを見ると既にある。MDB→ACCDB変換に関わらず作成される。 作成時刻を見ると新規にACCDBファイルが作成された時刻になっている。 f_・・・・・・_Dataの文字桁数が同じなので何かの識別用UIDかもしれない。 気にしない事がイチバンかも？ (^^ゞ
＞　取り出したい形式は「ID/名称コード1/名称コード2」ではなく「ID/名称コード1 名称コード2」でした。 問題無くSELECTできますよ。 test=# SELECT id, name || code1 || ' ' || name || code2 FROM test; id | ?column? ----+----------- 1 | A111 A444 2 | B222 B555 3 | C333 C666 (3 rows)
深く考えすぎ まず第一に選手ごとの最多点数を拾います。 select c_name,max(c_score) from tb_score group by c_name; この条件にあう、選手とスコアの組み合わせをwhereで絞り込むだけです select c_name,game,c_score from tb_score where (c_name,c_score) in(select c_name,max(c_score) from tb_score group by c_name);
>（１）インポート についてですが、 impdpを使うなら、CONTENT=DATA_ONLY DATA_OPTIONS=SKIP_CONSTRAINT_ERRORS impなら、IGNORE=Y のパラメータを設定することで、うまくいくのではないでしょうか。
あ、XXXの表示も含めるとこんなかんじ select PARENT ,(select XXX from hoge as t2 where t1.PARENT=t2.ID) as XXX ,COUNT(*) as COUNT from hoge as t1 where PARENT!=0 group by PARENT
postgreSQLはほとんど触ったことがないのですが、 generate_seriesという関数があるようですね。 http://www.postgresql.jp/document/8.1/html/funct … これを使って、 insert into 名簿 select s.n, '芥川龍之介', 'ほげ太', NULL from generate_series(2,10) as s(n) ; という感じでも出来るかもしれません。
こんにちわ。 > oracle 11gでは、1990年以前は、サポートしていないのでしょうか？ Oracle のDate 型の基準日はユリウス日です。 正確には憶えていませんが、紀元前4000年頃からサポートされている筈です。
sql puzzle でGoogleってみたら？ これなどは？ Joe Celko氏の著書[SQLパズル]の内容をふまえて構造化定理を意識しつつ、SQLパズルを解くサイトです。 Oracle9i以降が対象です。 http://www.geocities.jp/oraclesqlpuzzle/
UPDATE tbl_question INNER JOIN tbl_quiz_log ON (tbl_question.answer=tbl_quiz_log.user_answer) AND (tbl_question.question_id=tbl_quiz_log.question_id) SET tbl_quiz_log.answer_flag = 1; こう？ たぶん、 tbl_questionのquestion_idとtbl_quiz_logのquestion_idが一致（つまり、問題番号が一致） かつ tbl_questionのanswerとtbl_quiz_logのuser_answerが一致（つまり、回答者の答えが正解と一致） の時だけ tbl_quiz_logのanswer_flagを1にする が、質問者さんの希望する動作だと思うのだけど。
> 本筋から外れてしまってすみませんが、「Class.forName("com.mysql.jdbc.Driver");で使い回し」とはどういった意味でしょうか…？ そう言われると…どういう意味でしょうね(^^; いや、使いまわしはよくないですよ…と言いたかったのです(汗) > また、コネクションはSQL文を一回発行するごとに確立し、実行が終わるたびに閉じるのがやはり理想的なのでしょうか？ はい、理想的です。 ムダなメモリーも食いませんし、不必要なバグに怯える必要もなくなります。 また、コネクションの確立も今のPCであれば大した速度でもないでしょうし。 ただ、使いまわしも1処理内であればいいと思います。 例えばfor文で回してる間にいちいち閉じるのは非現実的なので、 for文が始まる前に確立させて使いまわす…は、アリかもしれません。 この辺りは人の感覚やソースにもよりますので、一概には言えません。 不安があるウチは、実行が終わるたびに閉じるようにした方がよいでしょう。 この辺の事情は難しいですよね。 自分で言ってても正しいのか不安です…。 なので、DataSourceを使用しないのであればかなり気を付けるようにしています。 > となると、元のソースコードが動かなかったのはやはりjdbcの方のバグなんでしょうかね… 全ソースを見てないので何ともですが、そうなのかもしれませんね。 今お使いのJDKは5以上とお見受けしますが、元のソースコードは 1.4.2なので、この辺りも関係しているかもしれません。 何はともあれ、動いて良かったですね！
クエリA側にダミーの項目を1つ増やすのであれば以下の様にすればよいと思います。 クエリA select 　　A.Col1 　　,A.Col2 　　,A.Col3 from A クエリB select 　　B.Col1 　　,B.Col2 　　,B.Col3 　　,B.Col4 from B としてUNIONするとこうなります。 select 　　A.Col1 　,A.Col2 　,A.Col3 　,'' AS Col4 from A union all select 　　B.Col1 　,B.Col2 　,B.Col3 　,B.Col4 from B
VBAでの回答は却下でしょうか？ また、フォームAをダブルクリックするとして その際に選択された行の中に、フォームBで一意に指定できる要素 （単一または複数のフィールドの組み合わせで一意となるもの）がありますか？ たとえば、『ID』というのが一意なら、フォームAのダブルクリック時イベントで Private Sub Form_DblClick(Cancel As Integer) Forms!フォームB.Filter = "ID=" & Me!ID Forms!フォームB.FilterOn = True End Sub 等なんですけど。。
エラーメッセージをみるかぎり、すでに同名のデータベースが存在しているようですが？
まずプリペアドステートメントの理解度を上げる必要がありそうですね http://www.php.net/manual/ja/pdo.prepared-statem … またphpの基本文法も怪しそうです 「.」でつないでいるつもりなのでしょうか？そのわりにクォーテーションの 使い方が変です
MySQLのサービスが停止したらphpMyAdminでデータの出力はできません おそらく基本的なところで大きな違いをされているのではないでしょうか？
>>クエリーが複雑すぎます」とのエラーが出て、データベース（登録.mdb）の更新が行えません。 何とかエラーを出なくする方法は無いでしょうか？ たぶんクエリをなんとかシンプルに変更するしか対策は無いと思います。
> この機能のオン・オフをＶＢコードから制御できないでしょうか？ ご質問の制御の対象がフォーム上ということでよろしければ、 郵便番号・住所の入力/表示に使用しているテキストボックスの 「PostalAddress」プロパティの値を切り替えてやればOkのようです。 (普段この機能は使用しないので(汗)、今試してみました：Acc2007) 既にウィザードなどで機能を設定済みのテキストボックスがある ことを前提に、式を例示します。 『郵便番号欄』『住所欄』の2つのテキストボックスがあって、 それぞれの『住所入力支援』プロパティ(→テキストボックスの プロパティシートの『その他』タブにあります)の値が、それぞれ 　　『郵便番号欄』テキストボックス　→　プロパティ値=「住所欄」 　　『住所欄』テキストボックス　→　プロパティ値=「郵便番号欄;;;」 となっている場合は、 　　Forms!フォーム名!郵便番号欄.PostalAddress = "住所欄" 　　Forms!フォーム名!住所欄.PostalAddress = "郵便番号欄;;;" 　または、同じフォーム上なら 　　Me!郵便番号欄.PostalAddress = "住所欄" 　　Me!住所欄.PostalAddress = "郵便番号欄;;;" と、プロパティ値を「"」ダブルクォーテーションで括って代入すればオンに、 　　Forms!フォーム名!郵便番号欄.PostalAddress = "" 　　Forms!フォーム名!住所欄.PostalAddress = "" 　また、上と同様に同じフォーム上なら 　　Me!郵便番号欄.PostalAddress = "" 　　Me!住所欄.PostalAddress = "" と、空文字("")を設定してやればオフに、それぞれできます。 住所を『都道府県』と『市区町村』などに分割している場合も、 基本的には上記と同様にプロパティ値の代入で切り替え可能です。 (郵便番号系・住所系で使用しているテキストボックスの数だけ、 　代入式が必要になります： 　上の例では郵便番号欄/住所欄の2つなので、2つの代入式、と) ・・・以上、参考まで。
phpMyAdminの検索は削除用ではないのでご希望の機能はありません 検索の際にオプションで１ページあたりのデータ件数を指定できるので 大きな数字を入れて検索してみてください 前にも書きましたがSQL欄でやるのが一番 検索のwhere句をコピペするだけなのだからなぜそれをしないのかが疑問
phpMyaAdmin のことかな～
XAMPPは開発やテスト用と主眼に作成されています。 そのため、標準の状態ではセキュリティ関連の設定がなされていません。 そのままで本番環境として使用しないでください、という警告です。 XAMPPは修正したファイルの確認用に使用すると言うことで良いでしょうか？ であれば、問題は特にないかと思います。
>「kamedaの一番の得意科目(クラスでの相対順位が最上位)は英語で、クラス2位である」 >「kamedaの二番の得意科目は数学で、クラス4位である」 >「kamedaの三番の得意科目は国語で、クラス7位である」 とテーブルの更新内容が一致しなかったので、上記の結果を出すためのSELECT文です。 select 　t1.usr_id, t1.kyoka_name, count(t2.usr_id) + 1 my_rank,t1.kyoka_rank from 　(　select 　　　t1.usr_id, t1.kyoka_name,count(t2.usr_id) + 1 kyoka_rank 　　from seiseki2 t1 　　left join seiseki2 t2 on (t1.usr_id <> t2.usr_id and t1.kyoka_name = t2.kyoka_name and t1.point < t2.point) 　　group by t1.usr_id, t1.kyoka_name 　) t1 　left join 　(　select 　　　t1.usr_id, t1.kyoka_name,count(t2.usr_id) + 1 kyoka_rank 　　from seiseki2 t1 　　left join seseki2 t2 on (t1.usr_id <> t2.usr_id and t1.kyoka_name = t2.kyoka_name and t1.point < t2.point) 　　group by t1.usr_id, t1.kyoka_name 　) t2 on (t1.usr_id = t2.usr_id and t1.kyoka_name <> t2.kyoka_name and t1.kyoka_rank > t2.kyoka_rank) group by t1.usr_id, t1.kyoka_name,t1.kyoka_rank order by usr_id,my_rank ; 全角スペースでインデントしてあります。 mysqlの文法に合っていない箇所は適宜修正してください。
書き忘れましたが、 >これは、バッチ処理で行うようなかたちになろうかと存じますが、 バッチ処理は基本的には行いません。Windowsのバッチ処理やUNIIXのshellスクリプトも含めて、書くのが結構大変です。質問者さんは、PHPなどのスクリプト言語を書けるのですので、そこから命令を実行させて結果を受け取るのがずっと楽ですし、高機能なものができます。 実行環境としてLinuxも考えているのであれば、互換性の関係からPHPだけで書くのが良いと思います。 PHPの場合はshell_exec()などを使うようですね。
No5です。 「True」という文字列がBooleanで返す「True」とまぎわらしい、という ことであれば、 Function funcJudge(ByVal fP As Long, ByVal fQ As Long, ByVal fR As Long, ByVal fS As Long) As String '最初の条件 If fP = 0 And fQ >= 1 And fR = 2 And fS = fQ Then funcJudge = "同値" Exit Function End If '二番目の条件 If fP >= 1 And fQ >= 1 And fR = 1 And fS = fP Then funcJudge = "同値" Exit Function End If End Function のように「同値」でもかまいませんが。
確認ですが　JavascriptよりAjaxの方がチェックが減ると思いますが．． Javascriptなら　という理由はどういうものでしょうか 個人的には　jQueryからPHPに投げるものを作ります http://alphasis.info/2011/11/jquery-gyakubiki-jq … http://alphasis.info/2011/11/jquery-gyakubiki-jq … http://alphasis.info/2011/11/jquery-gyakubiki-jq … http://alphasis.info/2011/11/jquery-gyakubiki-jq … http://alphasis.info/jquery-api/gyakubiki/ajax/ サンプル付で分かりやすいものを紹介しておきます 分かりにくい場合は詳しく説明します　補足を
聞くところが間違っています。 eventパラメータの詳細はサポートを通じてしか知り得ない情報です。 なので、サポートに聞いてください。
イミディエイトウィンドウでの、?DLookup・・・はDlookupの戻り値を表示せよ、という意味です。 Print DLookup・・・ の省略です。 一方、Private Sub s店舗no_LostFocus()では Dlookupの戻るところがありませんのでエラーになります。 通常は 変数 = DLookup("[店舗名]","[t店舗]","[店舗no]="& Forms![ft店舗seach]![s店舗no]) などと使用します。 また、ヘルプをご覧になれば 「criteria に適合するレコードがない場合や、domain にレコードが含まれていない場合は、Null 値が返されます。」 とも記載されています。 加えて、s店舗no がフォーカスを失うごとにDLookupで調べるよりも 更新後に行った方がベターかと思います。 具体的に何をしたいのかよく分かりませんが Private Sub s店舗no_AfterUpdate() dim へんすう as string If Not IsNull(s店舗no) Then msgbox nz(DLookup("店舗名","t店舗","店舗no="& Forms!ft店舗seach!s店舗no),"見つからない") へんすう = nz(DLookup("店舗名","t店舗","店舗no="& Forms!ft店舗seach!s店舗no),"見つからない") debug.print へんすう End If End Sub のような感じでは？ なお、オブジェクト名やテーブル名などに、 スペースが含まれていたり、予約語である場合を除いて、[] で囲まなくとも可。 http://support.microsoft.com/default.aspx?scid=k … nz関数で括るのは余計かもしれない。。
>DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel3, _ strac, strxls, True, strrange Excel では、RTEST という範囲名が設定されていないのでは？ なら此処は・・・strac, strxls, True だけで。 また、acSpreadsheetTypeExcel3 はExcel3.0形式の指定です。8 あたりでは？
select * from TABLE_A where No1 + No2 + No3 >= 30;
追加で、気になった点を １）同じフィールド名はOK? 以下から始まる４組で、フィールド名を同じにしているがOK? > Ｔ傷病名マスタ取込用.傷病名 As 傷病名, > T傷病名マスタ.傷病名 As 傷病名, ・・・・ > T傷病名マスタ取込用.大分類 as 大分類, > T傷病名マスタ.大分類 as 大分類, また、テーブル名先頭の T が全角/半角混在するけど・・・ ２）RIGHT JOIN の ON 部分で、テーブルの修飾が無いものがある > From T傷病マスタ RIGHT JOIN [T傷病名マスタ取込用] ON [T傷病名マスタ].[傷病名コード] = 傷病名コード また、テーブル名を確認する（T傷病マスタ ? T傷病名マスタ ?） ３）SELECT 部分の IIF にも Nz は必要？ ４）WHERE 部分の IIF は不要で、そのまま判別してみたら・・・・ (Nz(T傷病名マスタ.傷病名)<>Nz(T傷病名マスタ取込用.傷病名)) OR ・・・ ５）２つ目の SELECT に FROM が無いような・・・ 上側 SELECT の雰囲気は以下（動かないかも：未検証） SELECT Q2.傷病名コード, Q1.傷病名, Q2.傷病名 AS 傷病名N, Q1.ショウビョウメイカナ, Q2.ショウビョウメイカナ AS ショウビョウメイカナN, Q1.ICD10コード, Q2.ICD10コード AS ICD10コードN, Q1.大分類, Q2.大分類 AS 大分類N, MID(IIF(Nz(Q1.傷病名)=Nz(Q2.傷病名),"","、傷病名") & IIF(Nz(Q1.ショウビョウメイカナ)=Nz(Q2.ショウビョウメイカナ),"","、ショウビョウメイカナ") & IIF(Nz(Q1.ICD10コード)=Nz(Q2.ICD10コード),"","、ICD10コード") & IIF(Nz(Q1.大分類)=Nz(Q2.大分類),"","、大分類") ,2) AS 変更部分 FROM T傷病名マスタ AS Q1 RIGHT JOIN T傷病名マスタ取込用 AS Q2 ON Q1.傷病名コード = Q2.傷病名コード WHERE (Nz(Q1.傷病名)<>Nz(Q2.傷病名)) OR (Nz(Q1.ショウビョウメイカナ)<>Nz(Q2.ショウビョウメイカナ)) OR (Nz(Q1.ICD10コード)<>Nz(Q2.ICD10コード)) OR (Nz(Q1.大分類)<>Nz(Q2.大分類)); ２つ目の SELECT では、RIGHT JOIN を LEFT JOIN に変更し、 SELECT 部分の Q2.傷病名コード, を Q1.傷病名コード, にすると、できるかも・・・
dda167さん 蛇足や余計なお世話などではありませんね。 質問者さんの欲しい値を取るには、 select SYS_CONTEXT ('USERENV', 'SID') from dual; こちらですね・・・ ご指摘ありがとうございました。 また、関数名について回答していませんでした。 確実に使えるかは分からないですが、DBMS_UTILITY.FORMAT_CALL_STACKの戻り値のコールスタックの内容から取得できるかもしれません。 当方の環境（10g XE）で少し試してみました。 インデントしていないので見づらいですが・・ --ストアド名を返すファンクション create or replace function get_name return varchar2 is callstack varchar2(2000); currentname varchar2(2000); begin callstack := DBMS_UTILITY.FORMAT_CALL_STACK; /* コールスタックの最初には、このファンクション自身の情報が入っているため 2つ目のストアド名を取得する */ currentname := regexp_substr(callstack, 'procedure.+$|function.+$|package.+$',1,2,'im'); return currentname; end; / --上記ファンクションを呼ぶだけのファンクション create or replace function func_a return number is begin dbms_output.put_line(get_name); return 0; end; / --プロシージャ create or replace procedure proc_a is begin dbms_output.put_line(get_name); end; / --パッケージ create or replace package pack_a is procedure proc_a; end; / create or replace package body pack_a is procedure proc_a is begin dbms_output.put_line(get_name); end; end; / --無名ブロックで上記ファンクションらを実行 set serveroutput on declare w_num number; begin w_num := func_a; --function スキーマ名.FUNC_A proc_a; --procedure スキーマ名.PROC_A pack_a.proc_a; --package body スキーマ名.PACK_A end; / set serveoutput off 無名ブロックのコード内にある、コメントの内容が出力されました。 パッケージの場合は、プロシージャ名までは取得できないようです。 参考になれば幸いです。
空白ってなに？とまず突っ込まれる内容ですね キチンと型指定すれば空白はないとおもいますが create table hoge(id int not null default 0 primary key,data int null); insert into hoge value(1,1),(2,3),(3,''),(4,null),(5,null),(6,0); この場合、空白は0です そこで拡大解釈して0もカウントしないという命題だとすると 一般的にはsumを使う場合とcountをつかう場合があります (1)select sum(data is not null and data!=0) from hoge; →dataがnullじゃないかつdataが0じゃないものをカウントするのにsumをつかいます (2)select count(if(data=0,null,data) ) from hoge →dataが0だった場合nullだとみなします、この場合はcountでいけます
「SQL」を押して表示される入力欄にDELETE文をLIMIT文を省いて書けばいけるのでは？
データーの格納先のフィールドはＵＮＩＣＯＤＥ格納などの指定がされてないのでは？日本語はそういう指定をしないと化けますよ。どのＤＢでも。
>MAX(日付) OVER (PARTITION BY 出発, 到着, 年齢) AS 最新, >LAG(運賃) OVER (PARTITION BY 出発, 到着, 年齢 ORDER BY 日付) AS 前日 上記の記述で大丈夫だと思います。 Good luck!
こんにちは。 ＞＞すでにあれば作成するという すでにあれば作成しない・・・でした。 失礼しました。 ＞＞これはチェックをつけなくても、 ＞＞そこまで問題にならないものなのでしょうか？ 「IF NOT EXISTSを追加」 をチェックしなければ、ただの「CREATE TABLE ・・・」が出力されますから、 新規で作成する場合には問題にならないでしょう。 「完全なINSERT文を作成する」 と 「長いINSERT 文を作成する」 は、いずれかを指定する事になりますが、多分どちらかがデフォルトなんでしょうね・・・。 両方チェックしなければ、どちらかの型で出力されると思います。 なので、上記を理解して全てチェックを外すのは問題ありません。
Accessのほうで質問するべきではないでしょうか？ まあ3行なので答えますが ActiveX Data Object （ADO）を使ってmysqlを直接発行するか 合計を別に作り、UNIONクエリで結合するか 表示だけだったら、(レポート/フォーム)フッダーにSUM(colum名)でいいと思います。
おそらくGROUP BY句のWITH ROLLUPでいけるかと http://dev.mysql.com/doc/refman/5.1/ja/group-by- …
>SQL = "select * from T1 where keyword = '" & tb1 & "'" でエラーになるかと思ったら出来るんですね・・・？？ Accessが気を利かしてくれているらしいのですが、少し気味が悪いので Private Sub cmd_exe_Click() Dim SQL As String If isnull(me!tb1) then SQL = "select * from T1 " else SQL = "select * from T1 where keyword = '" & ME!tb1 & "'" end if me!sf1.form.recordsource = sql ・・・ では？
http://detail.chiebukuro.yahoo.co.jp/qa/question … こちらをどうぞ。
sennaが古いので、その後継のgroonga及びmroongaをおすすめしておきます。
元表のプライマリキーはどうなっているのでしょうか? nameをidにするとユニークを確保するのがかなり大変ですが大丈夫ですか？ //準備 create table seiseki(name varchar(20) primary key,school varchar(10),city varchar(10) null,point int not null,rank int null); insert into seiseki(name,school,point) values ('kameda','1高',345),('suzuki','2高',341),('kaneko','3高',332),('yosida','2高',321),('tanita','1高',310),('suyama','1高',310),('kisida','2高',301),('komine','1高',299),('tomita','2高',289),('sugita','1高',275); select * from seiseki; //nameごとのschool単位での順位 select name,(select count(*) +1 from seiseki as t2 where 1 and t2.point > t1.point and t2.school= t1.school ) as rank from seiseki as t1; //上を応用して、rankとcityを更新 update seiseki as t0 inner join (select name,(select count(*) +1 from seiseki as t2 where 1 and t2.point > t1.point and t2.school= t1.school ) as rank from seiseki AS t1 ) as t3 on t0.name=t3.name set t0.rank=t3.rank,t0.city='tokyo';
＞SET @GetRand = CAST(RAND()*10 AS numeric(1,0)) RAND()*10の値が9.5以上だと破たんする（＝丸められて10になる。）ので、floorするとか。
こんな感じでどうでしょうか。 select C1, C2 from T_TABLE order by case when C2 = 'XY' then 1 when C2 = 'XZ' then 2 when C2 = 'XX' then 3 else 4 end, C1; SQL Serverの環境がないので動作確認はしていません。
こんにちわ。 > 何かもっと有効な方法がありますか？ サーバーA とサーバB が同じOS で、サーバーA のインスタンスを停止できるのであれば、 以下の手順で可能かと 1) サーバーA のインスタンスを停止 2) データファイル, 制御ファイル, Online Redo Log 等を全てサーバーB にコピー 3) 初期化パラメータファイル, tnsnames.ora, listener.ora 等の設定ファイルを サーバーB にコピーして、ホスト名等の環境依存の部分を修正 　 ※ 制御ファイルのパスがサーバーA とサーバーB で異なる場合はここで修正 4) サーバーA のインスタンス起動 5) Windows 環境であれば、oradim でサービス作成 6) 必要であれば、orapwd でパスワードファイル作成 7) サーバーB のインスタンスをmount で起動 8) サーバーA とサーバーB のデータファイル等のパスが違っている場合は 　 alter database rename file コマンドでファイル名を修正 9) サーバーB のインスタンスオープン 要は、Cold Backup のリストア＆リカバリと同じ事です。
windows環境のsjisはwindowsの機種固有文字を含まないので今後は「cp932」を使用することをおすすめします。 ・my.iniの文字コードの指定をcp932にする。 ・mysqldump -uユーザ名 -pパスワード --default-character-set=cp932 データベース名 > ****.sql ・create databaseする際にCHARACTER SET cp932を指定 ・ダンプファイルの「CREATE TABLE文の「CHARACTER SET」を確認。SJISだったらcp932に変更。（エディタなどの一括変換が便利） ・リストアはmysqlコマンドです。コマンド実行時に文字コードを指定しても、ダンプファイルの中のCREATE TABLE文の文字コード指定、データ部分の文字コードは影響を受けないのであまり意味はないような気はします。
＞レコード構造を解析もしくは割り出す ＞ツールなどはございませんでしょうか？ 私が知らないだけの可能性もないわけじゃないですが、おそらくそのようなツールはないです。 例えば8バイトのバイトデータがあったとして、それが 64ビット浮動小数点 32ビット浮動小数点が2つ 64ビット整数 32ビット整数が2つ 16ビット整数が4つ 8ビット整数が8つ それ以外の組み合わせのどれか のどれに当てはまるかなんてのはツールでは判定できません。
できますよ。 PDFをコピーしてレイアウトモードで貼り付け とか レイアウトモードで挿入メニューからオブジェクト挿入 等で。 でもWinではレイアウトにPDFを取り込むと汚くなるはず。 JPEGと両方試してみてください。
>指定の場所に移動に移動してレコードのインポート→フォルダで参照データのみのインポートをおこなっています。 別のFMファイルからのデータのインポートなども同じで、 新規レコードとしてインポートすると今インポートしたレ コードだけが対象レコードになりますよ。 既存レコードは混ざりません。
> ・char(0)て何でしょうか？ 「検索語にはありえない文字」です。char(0)は、文字コード0の文字。以下の説明では\0と書きます。 例えば、検索語が"%おか%"で、field1="あいうえお"で、field2="かきくけこ"だった場合、 concat(field1,field2)は"あいうえおかきくけこ"となり、検索条件にマッチします。 ところが、concat(field1, char(0), field2) は、"あいうえお\0かきくけこ"となるため、 こうしておけば"%おか%"はマッチしない、ということになります。 > ＞%データ%は全件を検索するため効率うんぬんを論ずるような仕組みではない > ・どういう意味でしょうか？ 前後にワイルドカードをつけたLIKE 検索(いわゆる「部分位置検索」)は、効率が非常に悪いからです。 通常の検索(完全一致や範囲指定などによる絞り込み)では、DBにインデックスをつけることで、条件に該当するレコードを高速に抽出することができます。 (LIKEを使う場合でも、後ろにだけワイルドカードをつけた「データ%」のような、いわゆる「前方一致検索」は、インデックスが使えるので問題ありません。) ところが、前にワイルドカードをつけた場合、インデックスが使えませんので、 DBの全レコードを1件ずつ読み込んで条件に合致するかチェックする必要がある、ということになります。 検索にはレコード数に比例した時間がかかるという、非常に効率が悪いものになってしまうのです。 > ・あるいは、データ規模が少なければ、LIKE検索を利用しても良いのでしょうか？ それが問題にならない程度の規模ならLIKEの前後ワイルドカード(部分一致検索)をしてもいいでしょう。 > ・全件検索する際は、LIKE検索を使わないのでしょうか？ 全文検索エンジン(?)を利用するのでしょうか？ 規模が大きくなった場合には、全文検索エンジンを使うのが基本です。 > ・全件検索しなければ(例えば2カラムだけ)、LIKE検索を利用しても良いのでしょうか？ 「例えば2カラムだけ」というのが意味不明ですが、 問題はチェック対象のレコード数(行数)です。カラム数(列数)は問題になりません。 全件検索でなくても、チェック対象のレコード数が多い場合にはLIKE部分一致検索はしない方がいいでしょう。 LIKE検索以外の条件で、チェック対象が十分に絞り込めているなら、LIKE部分一致検索をしても大丈夫ということになります。 > ＞本番ではこんなことはしませんがあくまでも遊びということで > ・どういう意味でしょうか？ 上述のように性能が出せないので、大規模業務システムではそんなものは使わない、ということです。 > ・あるいは、全件検索でLIKE検索を普通は使わない、ということでしょうか？ LIKE検索でも、「あるカラムのみをチェック対象(LIKEの左辺)」とし、「頭には%をつけない前方一致検索」を行うのであれば問題ありません。 > ・concatで LIKE 検索を普通はしない、ということでしょうか？ > ・それとも、LIKE 検索で、char(0)などのセパレータを挟まない、ということでしょうか？ LIKE対象の前に%をつける「部分一致検索」は普通はしない、ということです。 さらにいうと、あと、カラムそのものではなく、concat した文字列に対してのLIKE 検索だと、「データ%」のような前方一致検索でも、左辺側にインデックスが使えませんので、やっぱり効率が悪くなりますので使えません。
検索してみました （「ビートリーブ」とカタカナで書かれたのは初めてみたので、しばらく思い出せなかった） 参考URL：http://q.hatena.ne.jp/1076907159
＞他のソフトは何も起動していませんが セキュリティ対策ソフトが常駐していませんか？（一時的に「無効」） OSは？（Administratorでログオンし実行やプログラムを右クリック「管理者として実行」実行）
きっといいと思います。 唯一気にした方がいい部分としては、日付項目は明示的に日付型に 変換した上で比較してあげましょう。 個人的には必要性がない場合にFROM句内にサブクエリを書くのが 見通しが悪くなって嫌いなので SELECT 　　　A.ENAME 　　　B.FCODE 　　　C.DATE FROM　AAA A, 　　　BBB B, 　　　CCC C WHERE A.FNAME = B.FNAME AND　 B.ID　　= C.ID AND　 C.DATE >= TO_DATE('2012/10/31', 'YYYY/MM/DD')
回答２に対する質問についてお答えします。マクロ1の代わりに下のマクロ２を実行してください。不具合がありましたら質問をしてください。 Sub Macro2() ' ' Macro2 Macro ' マクロ記録日 : 2012/11/10 ユーザー名 : ' Dim mygyo As Integer, kijitsu As Variant, koumoku As String, tanka As Variant, kosuu As Variant, kingaku As Variant Sheets("Sheet2").Select mygyo = Cells(1, 8) + 1 Sheets("Sheet1").Select kijitsu = Cells(5, 3) koumoku = Cells(4, 5) tanka = Cells(15, 3) kosuu = Cells(20, 4) kingaku = Cells(20, 5) Sheets("Sheet2").Select Cells(mygyo, 1) = kijitsu Cells(mygyo, 2) = koumoku Cells(mygyo, 3) = tanka Cells(mygyo, 4) = kosuu Cells(mygyo, 5) = kingaku Cells(1, 8) = mygyo Sheets("Sheet1").Select End Sub
こういうものは仕様が命 table_aはユニークなチームの一覧だとして table_bはtable_aとの相関関係がどうなんでしょう？ (1)table_aに存在してtable_bに存在しないデータがあるか？ (2)逆にtable_bに存在してtable_aに存在しないデータはあるか？ (3)table_bのuser_idのユニークは保証されているか？ これがきまらないと書き方がおおきくかわってきます。 もう少し突っ込んで言えば、もしtable_aとtable_bのデータが常に1対1で整合性が とれているならtable_bは必要なく、table_aで管理をすればよいような気がします。
最初のFETCHをループの外ですればいいのでは。 open cur1; fetch cur1 into rec1; if cur1%notfound then close cur1; raise NO_DATA_FOUND; end if; loop --処理 fetch cur1 into rec1; exit when cur1%notfound; end loop; close cur1;
>db1とdb2は同じマシンの中にあります。 ああなるほど、では、出力の際に mysqldump -u root --add-drop-table=false --insert-ignore=false --no-create-info=true -p db1 > db1.sql としてみてはどうでしょうか？
安心してください nharasawa様の回答されたテーブルで十分です 数千万レコード、1秒間に100近い更新、リアルタイム表示 これらすべての条件が重ならない限り、別に回数などを記録しなくても 集約関数を使って（GROUP BY）集計(COUNT)すれば、安サーバー、ノートパソコンでも余裕ですｗ （HAVING句も使えばさらに応用の幅が広がります） 参考　集約関数 http://www.atmarkit.co.jp/fnetwork/rensai/sql03/ … むしろ回数などのデーターを持ってしまうと、回数データの整合性をチェックするために 定期的に内部結合を伴ったクエリを発行しなくてはなりません。 おそらくこちらのほうが厄介です。←まあどんぐりの背比べですがｗ
JavaでもDB2でもOracleでもWindowsでも、何にでも当てはまりますが、「まずはマニュアルを見ながら実際に使ってみる」のが良いかと思いますよ。 それで基礎を自分なりにしっかりと理解して行ったほうが良いと思います。 基礎を理解しないで、応用は出来ません。 先輩からそう言われたのであれば、多分ですが、あなたの会社にJavaやSQL（DB2）のマニュアル、参考書等は沢山あると思いますので、それらを読みつつ、実機を触って理解してみては如何でしょうか。
SQL Server 側の設計をどのようにしたのかわからないが、適切なインデックスを作成し、クエリの見直しを行うのが第一歩だと思う。 一般的に WHERE で使われる列はインデックス候補となりやすいため、受注日のインデックスを作成する。 そしておそらくは VBA のコードの中で Dim sql As String sql = "DELETE testデータ.受注日 FROM testデータ WHERE ((testデータ.受注日)=#" & juchu & "#));" とかやっているのかと思うが、SQL 文を動的に作成して実行するのをやめて、SQL Server 側にストアド プロシージャとして作成しなおし、UI 側からはこのプロシージャに必要な日付値を与えてキックする方法にする。 とりあえずそんなところか？
マニュアルで書かれている構文フォーマットは、BNF likeな書き方なので斜体で書かれた文字列は、マニュアルの別ページで定義されていますよ。 http://ja.wikipedia.org/wiki/ABNF 例で出てきた、table_referencesの定義は、"JOIN構文"のところで定義がなされています。 http://dev.mysql.com/doc/refman/5.1/ja/join.html
＃２です できそうなそぶりを見せて申し訳ありません。 私のわからないところに行ってしまいました。 ＃２で想像していたのは、 コンボボックスのデータが、何らかのタイムアウトで空欄になり・・・・ だったら Requery すれば裏方さんが繋ぎ直してくれるのでは・・・・ という考えからでした。 そして、その想像も打ち消されました。 ごめんなさいです。 そこで提案ですが、 現QAでは、他の方の登場は期待できないかも・・・ 時間的余裕があれば、待ってみるのもありかと思いますが・・・・ 本QAは締切扱いとして、 ・Microsoft Community　とか　http://answers.microsoft.com/ja-jp/office/forum/ … （モデレーターさんがどこまで面倒を見てくれるのかわかりませんが） ・moug の一般機能　とか　http://www.moug.net/faq/viewforum.php?f=3 で質問しなおされることを望みます。 ただ、回答が得られるかは・・・・ 質問しなおされる場合には、 ・ログインフォームの構成　コンボボックスで ID、パスワードを持たせている事 ・＃２で記述された どの様な時間経過でどうなるか ・Access2010 or Runtime 以外に OS を簡潔に記述されたらと思います。 なお、締め切ってから質問してください。くれぐれもBAは付けないように。 質問しなおされる時には、このQAのアドレスを記述しておいた方が良いと思います。 解決しなかったから質問した・・・と くれぐれもマルチポストにはならないように・・・・ 長々と時間を取らせて、すみませんでした。
ゴミが残る可能性があるのでリストアの観点からいえばdropした方が確実 たとえばバックアップ後、データ更新（追加・削除ふくむ）があった場合、 バックアップ時点にデータを戻したいなら各テーブルの中身が残っていると 不都合がある可能性がたかい
コードの決め方にこだわらなくてよく、商品の品目ごとにコードを決めればよいです。コードのなかに一部を使ってサイズ、色を組み込むことも出来るし、サイズ、色別にコードを作ってもよいです。
こういう質問をするなら、semi-sync-replication の有無より、レプリケーションとトリガーの組み合わせについて質問するなら、バイナリログのフォーマット設定も書き込むべきじゃないかな？ http://dev.mysql.com/doc/refman/5.5/en/replicati … MySQL 5.1のだけど、日本語ならここ http://dev.mysql.com/doc/refman/5.1/ja/stored-pr … もうマニュアルに書かれていることだから説明するのも二度手間になるけど… row-basedなら、バイナリログでテーブルのデータが更新されてもトリガーがスレーブ側で実行されることは無いので、実行順序の問題は原理的に生じない。(トリガーで更新されたテーブルのデータもバイナリログに記録されてスレーブに反映される) statement-basedならスレーブでもトリガーが実行されるので、実行順序に関しての保障は無い。 というのが回答になります。 で、"これはお願いなのですが、～(省略)～実際に運用経験があり、正確な知識をお持ちの方にアドバイス頂きたいと思います。"こういう情報がほしければ、お金を払ってプロに頼んでください。
Merge文のサンプル。 http://www.shift-the-oracle.com/sql/merge.html Ｂテーブルの項目数や属性とＡテーブルの項目数や属性に依存関係はないです。 例えば、Ｂテーブルのvarchar2に、ＡテーブルのdateからTO_CHAR()を使ってデータを格納する とかもできますし、Ａテーブルに項目がないので固定値をＢテーブルに入れることもできます。 ＡテーブルとＣテーブルを結合した結果を副問い合わせの形で指定すれば、複数のテーブルから 格納することすらできます。 ただね、利用できない条件がOracle10gではあった。 （11gの環境では試していないので大丈夫かもしれませんが） 例 MERGE INTO Out_Table USING In_Table ON ( Out_Table.Key_ID = In_Table.Key_ID) ・・・ で、In_Tableのデータが以下のような場合、 In_Tableのプライマリキー:Key_ID,UpdateDate Key_ID,UpdateDate,・・・ A,2012/1/5 B,2012/1/5 C,2012/1/5 A,2012/2/4 D,2012/2/4 ・・・ Out_TableのKey_IDにAが存在していなくて、 1回のmerge命令で同じレコードに対してInsertとUpdateが同時に行われる場合、 エラーになってました。 べたの場合より早いかどうかは、少なくとも遅くはないとはいえますが、処理によっては同じになる かもしれませんので、早いとは言い切れません。 （でも、プログラムは見やすいのは確実。） ## ANO2の人が書いているXEとは、ユーティリティ類等の一部機能がなかったと思いますが、 ## 基本的にOracleの機能が実装されたソフト。 ## 利用条件にも制約はあったと思いますが、無償。 ## サイズが大きいのでダウンロードでタイムアウトしないかどうかはわかりませんし、 ## ダウンロード元が英語サイトなので、私は、ちょっと薦めるには躊躇しますが、 ## ダウンロードして使う環境を作っておけば、いろいろ試せるので便利なことは確か。 ## 私の使っているとあるノートＰＣでも動いていたりする。。。
Windows認証も無効化できます。 SQL Serverのログインで、Windowsユーザーで設定されたログインを削除することでWindows認証できなくなります。 SQL Server認証は純粋にIDとPASSの組み合わせなので、サーバー管理者云々は関係ありません。 SQL Serverの認証方式として、 Windows認証 Windows認証＋SQL Server認証（混合） の2種類しか選択肢がないので、混同されているのだと思います。 Windows認証は、OSの認証に使用したユーザーに権限を付与した認証。 これはOSのユーザーにSQL Server内のログインで権限が付与する形式。 なので権限をはく奪するなり、ログインから削除すればOSのユーザーで認証できなくなります。 SQL Server認証はIDとPASSの比較。 こちらもログインで設定されております。OSのユーザは関係ありません。 SQL Server Management Studioでサーバーに接続し、インスタンスのセキュリティのログインにWindowsのOSユーザーのログインがあると思いますので削除すればWindows認証ではログインできなくなります。
existsを使って、 select * from スキーマA.テーブルA A where exists ( select * from スキーマB.テーブルB B where A.カラム1 = B.カラム1 and (A.カラム2 <> B.カラム2 or A.カラム3 <> B.カラム3 or A.カラム4 <> B.カラム4) ); でもいいと思います。
SELECT USERID,DATEDIFF(DAY,購入日,GETDATE())/7+1 FROM テーブル名 でどうでしょうか。
アプローチの仕方が的を射ていない感じ 無関係ではないが本質はそこには無いと思います
スクリプト言語「PHP」はどうでもよくって（別にASPでもJSPでもかまわない）とにかく 「データベース言語「SQL」を使用し、データベースを扱う標準関数を利用して」というのもどうでもよくって、 とにかく 「なんらかの言語でWebブラウザから、GUIで、データベースを操作したということ」 が実習のポイント。 一方で、Webブラウザを使わずにSQLを直接発行してデータベースを操作する作業を考えて （やったのかもしれませんが）これをCUIで、データベースを操作したということ として、その対比を「私の書いた考察」に結び付けれませんか？ ## あえて答えになってしまうような例を挙げないで書いていますので ## ちょっと分りにくくてすいません。 ## 答えの見当はついているけどまずはあえて書かないでどういう方向かだけ書いています。 ## 答えを考えろって要求でしょうし、答えに悩んでいるのではなく、 ## 答えを見つけるための方法で悩んでいそうなので。
動的にSQLを書き換えて実行することはMYSQL単体でも可能です。 （ストアドプロシジャとかで） 頻繁に入れ替えないのなら、それでもいいと思います。 しかし単純なUPDATE文で更新するのの100倍は時間がかかると思います。 （結構めんどくさいですし） そもそも、テーブルの設計に問題があるように思います。 常に4人のデータが入っているのならまだ、いいのですが NULL値などがあるとさらに上の処理が煩雑になります もし、テーブル設計を見直せるなら table pk, group, id, age, sex として insert時に idはgroupでグループ化し、count(pk)+1で取得 1つのグループが5人以上にならないようにトリガでチェックをかける というふうにすれば上のテーブルと同じデータが格納できます。 拡張性も高いです。 で、肝心のUPDATEですが ちょっとわかりません まず、3,1,2の順番から ・「1の数字が付いたカラムの値」を、「3の数字が付いたカラムの値」で更新したい ・「2の数字が付いたカラムの値」を、「1の数字が付いたカラムの値」で更新したい となるのがよくわかりません 予想ですが ・「3の数字が付いたカラムの値」を、「2の数字が付いたカラムの値」で更新したい というのを書き忘れていて、３次の巡回置換（３つの入換という意味）を表しているのか つまり１，２，３が３,１,２になるのか…(1) それとも１，２，３が３，３，３になるのか…(2) はたまた１，２，３が３，１，３になるのか…(3) たぶん(3)だと思うのですがそれって意味がないような…。 まあ、どれでもテーブル構造さえ見直せば結構簡単にかけるので テーブル設計を見直せるならやってみてください
information_schemaの中身はシステムの情報なのでupdate文なんかで変えちゃいけません。 ・・・不整合が起こってシステムが異常な動作をしても知りませんよ、って内容なので。 で、エラーになるんでしょう。 routine_definitionだけテキストファイルに出力して、メモ帳かなにかで 「CRAEATE PROCEDURE 」を「ALTER PROCEDURE 」に 「★★★」を「○○○」に一括置き換えして sqlcmd等で実行すればそれでしたい作業は終わりのはずですが。 ## とここまで書いて、ちょっと甘いことに気づいた。 ・sqlcmdで接続するデータベースをきちんと指定するか、出力結果の先頭にuse等を追加して指定する。 ・各alter文の最後にgoがないとだめなので、 SELECT ROUTINE_DEFINITION + CHAR(13) + CHAR(10) + 'GO' + CHAR(13) + CHAR(10) AS Expr1 FROM INFORMATION_SCHEMA.ROUTINES WHERE (ROUTINE_DEFINITION LIKE '%★★★%') AND (ROUTINE_TYPE = 'procedure') とselect文を変更する。 なお、select句の中を、 REPLACE(REPLACE(ROUTINE_DEFINITION, 'CREATE PROCEDURE ', 'ALTER PROCEDURE ') ,'★★★', '○○○') とするだけでメモ帳なんか使わないって方法でも大丈夫のような気がしますが、 '★★★'と'○○○'の内容次第。 '★★★'でPROで'○○○'がXYZとしたら、ALTER PROCEDUREが、ALTER XYZCEDUREになってしまって 全部エラー。。。 ということも考慮する必要はあります。
あなたの想いとは違うかもしれないけど -- 運賃比較 SELECT 日付, 出発, 到着, 運賃, LAG(運賃) OVER (PARTITION BY 出発, 到着 ORDER BY 日付) AS 前日 FROM 運賃テーブル; -- 運賃変更 SELECT * FROM ( SELECT 日付, 出発, 到着, 運賃, LAG(運賃) OVER (PARTITION BY 出発, 到着 ORDER BY 日付) AS 前日 FROM 運賃テーブル ) WHERE 運賃 <> 前日;
LINECDの型は数値型なんですよね？ エラー発生時の、sSQLの中身はどうなっていますか？ 実行直前にブレークポイントを張って、値を確認するなり、 Debug.Printでイミディエイトウィンドウに出力するなりして確認してみて下さい。 "LINECD = OR"みたいに、=の右辺に値が無かったり、 "LINECD = '001 OR"みたいに、=の右辺に数値以外の文字があったりしませんか？ たぶん、Cells(3, 20)～Cells(20, 20)に空のセルがあったり、数値以外が入ったりしているんじゃないかと思います。
、販売店コードフッターに配置したテキストボックスのコントロールソースを下記のように設定してください。 =Sum(IIf([売上額]>0,1,0))
>尚、PUT先の192.168.100.105　の/var/lib/mysql/の所有者はユーザー、グループともmysqlです。 >mysqlユーザーで行えばput可能のでしょうが、どのサイトを見てもreplication専用ユーザーを作って対応することとなっており、安全上の面からも機能限定のユーザーでputしたく考えております。 グループに書き込み権限がついていないだけ…とか言うことはありませんか？ ティストリビューションが何かは不明ですが…。
レコードの削除 実行前、削除の確認メッセージが出ないように設定します。 そのままでは、メッセージなしに削除されてしまいますので、自前で Msgbox関数で確認メッセージを出します。 下記の部分を、 If not [Form].[Newrecord] Then 　　　　メニューコマンドの実行 　　　　　　　　　　コマンド　レコードの削除 If文の最後 下記のように変更してください。 If Not [Form].[NewRecord] And Eval("MsgBox('レコードを削除します。@「はい」をクリックすると、削除したレコードを元に戻すことはできません。@削除してもよろしいですか?',52)")=6 Then 　　　　メッセージの設定 　　　　　　　　　　メッセージの表示　いいえ 　　　　メニューコマンドの実行 　　　　　　　　　　コマンド　レコードの削除 　　　　メッセージの設定 　　　　　　　　　　メッセージの表示　はい If文の最後 「メッセージの設定」アクションを表示させるには、リボンの[マクロツール]-[デザイン]の「すべてのアクションを表示」を押し込んでおいてください。
この場合、INNER JOINの後を()でくくる必要はないのだが。 それはさておき、 SELECT c.CarNo, c.Model, cs.FirstName, cs.LastName, b.Date, b.Duration FROM Location l INNER JOIN ( ( (Own o INNER JOIN Car c ON o..FK_CarNo = c.CarNo l.LocationNo) /* o..FK_CarNo は、 o.FK_CarNo のあやまりでしょう。 また c.CarNoの後にあるl.LocationNoは何のためのものか分らないので文法エラーになります。 */ INNER JOIN Book b ON c.CarNo = b.FK_CarNo) INNER JOIN Customer cs ON b.FK_CustomerID = cs.CustomerID) ON l.LocationNo = o.FK_LocationNo WHERE l.LocationName =:user_input ; ANO.1の方が書いた方法で悪いとは思わないのですが、ご自身で書かれたselect文を試してみたければ /* ・・・　*/内に書かれた内容を直した下のselectを試して見られたらいいでしょう。 SELECT c.CarNo, c.Model, cs.FirstName, cs.LastName, b.Date, b.Duration FROM Location l INNER JOIN ( ( (Own o INNER JOIN Car c ON o.FK_CarNo = c.CarNo) INNER JOIN Book b ON c.CarNo = b.FK_CarNo) INNER JOIN Customer cs ON b.FK_CustomerID = cs.CustomerID) ON l.LocationNo = o.FK_LocationNo WHERE l.LocationName =:user_input ;
変数をエスケープしないで突っ込んでいる時点でアウトですが、Syataxエラーとは無関係なので、 直接のエラーの原因は文字列をクォートしていないことでしょう。
> TOP句がうまく機能しないんです・・・。 あっ、しまった。昇順ですので総売上が一番小さいのが表示レさてしまいますね。 ORDER BY句を降順に変更してください。 ORDER BY 総売上 DESC;
こういうことでしょうか。 select A.uriage from A inner join B on (A.data like '%' || b.data || '%') where A.month = 1 and b.day = 5;
2916の項目が複合的にすべて連携しあいながら検索・集計する必要があるのでしょうか？ ただの履歴でしかないようなデータはまとめてblobで1項目に流し込んでしまうとか 運用の方法でなんとかなるのでは？
最近、同様のトラブルがありましたので まだ解決していないようでしたら参考にしてください。 原因については推測によるものです。 開発環境とトラブルのおきた環境でプリンタが異なっている場合です。 私の場合は、たまたまプリンタが故障して 間に合わせで、 「給紙方法」 が 「後トレイ」 しかない機種を 「通常使うプリンタ」 にしていました。 その状態で作成したレポートは デザインのページ設定で給紙方法が 「後トレイ」 に設定されていました。 それしかないのですから 「自動選択」 にならないのは当然と言えば当然ですが。 客先から、用紙切れのメッセージが出る、と報告があるまで 全く気が付きませんでした。 で、対策としては 「通常使うプリンタ」 を 「カセット」もある機種に戻して （本体が無くてもドライバさえあればOKです） デザインのページ設定で「給紙方法」を「自動選択」に変更して保存。 デザインで 「自動選択」 になっていれば 「通常使うプリンタ」を「後トレイ」しかない機種にもどしても正常に印刷できます。 いずれにしても、レポートのデザインでの「給紙方法」 を確認してください。
３点ほど。 １．emConfig.logのエラー内容を頂けませんでしょうか。 ２．「set ORACLE_UNQNAMEとありましたので、orclをsetしてみましたが、エラーメッセージが変わっただけで問題解決にいたりません。」とありますが、変わった後のエラーメッセージを教えてください。 ３．https:～は、VM上のWindowsのIEからやりましたよね？ すみませんが、よろしくお願いします。
＞画像を呼び出す際に、この二つの方法によって ＞できる事やできない事、またメリットやデメリットというのもは できる事とできない事は、基本的には差はありません。 あとはざっとこんなところでしょうか？ 個人的には後者の方がお勧めですが、リソースに十分な余裕があるなら 前者でもいいかもしれません。 ○直接登録する方法 →メリット ファイルの削除や移動など気にせずにDBに保存されているものがすべてなので 整合性がとりやすい →デメリット データが集積するに伴いデータベースが肥大化する。 そもそもバイナリデータ自体SQLとしての検索の対象にならないので、 テーブルに収納すること自体が無駄。 （とくにG単位のムービーなどはオーバーヘッドが大きすぎる） ○ディレクトリに画像を格納 →メリット 出力がファイルI/Oに依存するためデータベースに問い合わせるより若干高速 管理者がファイル自体を直接見て内容を判断できる →デメリット idでのひも付けがきれたとき、ゴミがたまりやすい ファイル自体を直接編集してしまうと、DBの内容と差異が発生する データの取り扱いがやや煩雑
私なら地域テーブルを追加するか、テーブルに地域項目を追加します。 県名項目に地域名を追加してしまうと、県名だけが必要なときに操作が困難です。
細かくチェックしてないけどこんな感じでどうでしょう？ create table tenki_log(日付 date,天気 varchar(10),気温 double); insert into tenki_log values( '2012-10-01','晴',19.5),( '2012-10-02','晴',19.0),( '2012-10-03','晴',20.0),( '2012-10-04','晴',21.0),( '2012-10-05','晴',21.0),( '2012-10-06','晴',19.5),( '2012-10-07','晴',20.5),( '2012-10-08','曇',18.0),( '2012-10-09','曇',21.0),( '2012-10-10','曇',20.0),( '2012-10-11','雨',18.0),( '2012-10-12','雨',18.0),( '2012-10-13','雨',18.0),( '2012-10-14','雨',17.0),( '2012-10-15','曇',18.0),( '2012-10-16','晴',18.0); //表示 select `天気` ,`最高気温` ,`最高気温が出た日付` ,(select max(`日付`) from tenki_log where `気温`>=20 and `天気`=sub.`天気` ) as `20度以上になった最新の日付` from ( select `天気` ,`気温` as `最高気温`,max(`日付`) as `最高気温が出た日付` from tenki_log where (`天気`,`気温`) in ( select `天気`,max(`気温`) from tenki_log group by `天気` ) group by `天気` ) as sub
全部 Visual Basic Express Edition 関連でしょ。 SQL Server Compact Edition とその関連ツールだな。 これらは SQL Server の上位エディションとは違い、管理サービスを実行しなくてもデータ ファイルだけあれば DB が使えるようになるファイル ベースのデータベース。 DB を使用するアプリを開発して配布先PDでインストールする際に SQL Server をインストールしなくても良くなる。 そういうのを開発するために Visual Basic と一緒にインストールされたりする。
質問者さん 私に騙されてみる気はありますか。 以下の方法は、私がいろいろやってみて、何か動きそう・・・ というレベルのもので、Microsoft の資料等裏付けが取れていないものになります。 確認用フォームは、添付図の様になります。 （フォームウィザードから表形式として作ったものになります） 「an」「日付」「Src」を連結した帳票で、 ボタン、前に「btnPrev」、次に「btnNext」がヘッダに配置されたものになります。 VBAで、以下を記述します。 Const CSCRLNUM As Long = 10 Private Sub Form_Load() 　　Me.InsideHeight = Me.Section(acHeader).Height _ 　　　　　　　　　　+ Me.Section(acDetail).Height * CSCRLNUM _ 　　　　　　　　　　+ Me.Section(acFooter).Height End Sub Private Sub ScrollByMyself(iNum As Long) 　　Dim i As Long, j As Long 　　If (Me.Dirty Or Me.NewRecord) Then Exit Sub 　　j = Abs(iNum) 　　With Me.RecordsetClone 　　　　.MoveLast 　　　　.Bookmark = Me.Bookmark 　　　　i = .AbsolutePosition + iNum 　　　　If (i < 0) Then 　　　　　　i = 0 　　　　ElseIf (i >= .RecordCount) Then 　　　　　　i = ((.RecordCount - 1) \ j) * j 　　　　ElseIf ((i Mod j) <> 0) Then 　　　　　　i = (i \ j) * j 　　　　End If 　　　　.AbsolutePosition = i 　　　　Me.an.SetFocus　　' ★詳細にあるコントロール「an」にフォーカス移動 　　　　Me.Bookmark = .Bookmark 　　　　i = (Me.CurrentSectionTop - Me.Section(acHeader).Height) _ 　　　　　　+ Me.Section(acDetail).Height 　　　　i = i \ Me.Section(acDetail).Height 　　　　If (i > 0) Then 　　　　　　DoCmd.GoToPage 1, , Me.Section(acDetail).Height * i 　　　　End If 　　End With End Sub Private Sub btnPrev_Click()　' 前へ 　　Call ScrollByMyself(-CSCRLNUM) End Sub Private Sub btnNext_Click()　' 次へ 　　Call ScrollByMyself(CSCRLNUM) End Sub ※ ★ の、詳細にあるコントロールにフォーカスを移動しないと、まともに動きません。 上記では「an」にしましたが、「日付」でも「Src」でも・・・・ フォーカスが詳細にあることが重要です。 上記の細かい説明は、ここではしません。 ※ 本質問とは別の用途ですが、ブログに記事として載せてます。 アドレスは書けない、導くキーワードの提示も規約で禁止されているので書けません。 興味あったら探してみてください。 なお、上記を確認してみる・・・・使ってみようかな・・・・ すべて自己責任にてお願いします。
INSERT文は行データを追加するためのもので列データを追加するものではありません。 3_column列がrtableテーブルに存在するならUPDATE文を使用しましょう。 UPDATE `rtable` SET `3_column` = `2_column`; 3_column列がrtableテーブルに存在しないなら3_column列を追加後に上記のUPDATE文を流します。 列追加のためのSQLは以下の通りです。 ALTER TABLE `rtable` ADD `3_column` [データ型]; （[データ型]部分は3_columnのデータ型にする必要があります。 　INTならALTER TABLE `rtable` ADD `3_column` INT;）
未テストですが、以下のような感じはどうでしょう？ select case when year >= month then year else (case when month >= hour then month else hour end ) end as money from (select COALESCE(year,0) / 12 as year , COALESCE(month,0) as month , COALESCE(hour,0) * 8 * 20 as hour from table ) order by money desc
MySQLは全然さわったことがないのですが、 http://dev.mysql.com/doc/refman/5.1/ja/alter-tab … を見る限り、プライマリーキーを追加するだけなら ALTER TABLE tbl_name ADD PRIMARY KEY(col_name1, col_name2); でいいのではないですか？
試していませんが、こちらで解決するかもしれません。 Access 2010 の修正プログラム パッケージ (アクセス x none.msp）： 2012 年 2 月 28日 http://support.microsoft.com/kb/2597935/ja
TO_DATEは文字列をDATEに変換する関数。 DATEをDATEに変換してどうする？ また、大小比較するので、0時を跨ぐ場合(0時を跨ぐかどうかは、FROM>TOで判定可能)は 日付カラム >= 18:00 or 日付カラム < 02:00 にする必要あり わかりやすくすると、 (18:00 <= 日付カラム AND 日付カラム < 24:00) OR (00:00 <= 日付カラム AND 日付カラム < 02:00) だが、マイナスの時刻や24時を超えた時刻は存在しないから前述のとおり
>table_cにcdがある場合は条件を指定し、 >ない場合は条件を指定しない table_c.cd = 'cd_1' or table_.cd is null 以下ざっとテスト create table table_a(id varchar(10),name varchar(10)); insert into table_a values('a1','aaa'),('a2','bbb'),('a3','ccc'); create table table_b(b_id varchar(10),a_id varchar(10),user_id int(5) unsigned zerofill not null,point int); insert into table_b values('b1','a1',1,5),('b2','a1',2,2),('b3','a3',7,10),('b4','a2',356,10); create table table_c(c_id varchar(10),user_id int(5) unsigned zerofill not null,cd varchar(10),bonus_point int); insert into table_c values('c1',1,'cd_1',1),('c2',7,'cd_2',1),('c3',356,'cd_1',1); //表示 SELECT b.user_id ,coalesce(b.point,0) + coalesce(c.bonus_point,0) as total_point FROM table_a as a INNER JOIN table_b as b ON a.id=b.a_id LEFT JOIN table_c as c ON b.user_id=c.user_id WHERE c.cd = 'cd_1' or c.cd is null ORDER BY total_point desc
細かいことをいうと > データベース：ONLAINGAME ではなく「ONLINEGAME」でしょう。基本命名規則を英語に準拠するなら注意しないと後で訳がわからなくなります。 > MENBERの中に50件、WEAPONの中に50件データを作ればいいのでしょうか。 これはゲームの性質によります。多人数の同時アクセスが想定されるなら、MEMBERテーブルのレコード件数を多めにしておいたほうが本番に近い検証ができる気がします。（同時アクセスのシミュレーションができる環境も作らないといけませんが） > create table MENBERl(age int, name varchar(20) , primary key (aa); 「MENBERl」の「|」は不要です。セミコロンの前に閉じかっこが必要です。「primary key(aa)」とありますが、「aa」という項目がありません。多分このままでは通らないと思います。
No.1です。 システム監査の一環という事でしょうか。 理解不足で申し訳ありませんでした。 が、自分自身をupdateするというのは、どうかと思います・・・。 そういった機密性の高いデータにアクセスがあったかどうかは、別なテーブルやログ・ファイル等に追記していくのが一般的です。 ちなみに、このようなオープンソースのソフトがありますので、利用されてみては如何でしょうか。 参考URL : http://sourceforge.jp/magazine/12/03/27/1333243 ※また見当違いの回答でしたらスミマセン。
なんどもすみません（汗）。 ANo.6 ですが、FROM を FORM とタイプミスしています。 SELECT DISTINCT 果物TBL.* FROM 果物TBL WHERE (ID In (SELECT ID FROM 果物検索TBL) AND EXISTS (SELECT 1 FROM 果物検索TBL WHERE ID Is Not Null)) AND (名前 In (SELECT 名前 FROM 果物検索TBL) AND EXISTS (SELECT 1 FROM 果物検索TBL WHERE 名前 Is Not Null)) AND (値段 In (SELECT 値段 FROM 果物検索TBL) AND EXISTS (SELECT 1 FROM 果物検索TBL WHERE 値段 Is Not Null));
＞実はマシンＡとマシンＢは別の場所にあります。 AとBがインターネットに繋がる状態なら、両方に「どこでもLAN」と言うのをインストールすれば、離れた場所同士で、ファイルの共有が出来ます。 http://www.dokodemolan.com/ 当方の会社では、異なる都道府県の間、海外間で、これを使ってファイルを共有しています。
エラーとなる理由は、スタンバイ解除後の、フォームのクリックイベント時に実行され保存した変数等が、クリックイベント終了時に全て無くなるからです。この現象をスコープから外れる等と言います。 参考url : http://ja.wikipedia.org/wiki/%E3%82%B9%E3%82%B3% … ちなみに、何らかの処理中にスタンバイ等になりネットワークが切断されてしまった場合は、そこでエラーとし、アプリケーションを強制終了し、再度、最初から実行させるのが一般的です。 ※そうしないと、データベースの整合性が崩れてしまう可能性があるため。
私の知る限りですが、すでにあるカラムにIDENTITY属性は付加できません。
No1 , No3です。 何度もスミマセン。 >ログ出力先をオラクル外へ変更する場合、オラクルを止なくても全く問題ないでしょうでしょうか？また一般論でかまいませんが、ｔｒｃログはオラクルhome外へ出力しておくのが良いのでしょうか？メンテナンス的にも楽なんですが。。 Oracleを停止しなくても変更可能です。 詳細はOracleのマニュアルの"ALTER SYSTEM"を参照してください。 次ですが、アラートログやトレースログ等は、容量が増えていく＝ディスクを圧迫していくので、システム系以外の別なディスクに格納するのが絶対です。 でないと、システムディスクがパンクし、最悪システムダウンになりかねませんので。 また、当然ですが、そういったログの中には機密情報等が含まれる可能性がありますので、一般ユーザに教えない・見えないようにしておく事が必須です。 余談ですが、私はシステムエンジニアとして、多数の顧客のOracleDB等の管理する仕事をしています。
>レンタルサーバに依存しないデータベースライブラリ？を探しています。 >「MySQL」や「PostgreSQL」のようなデータベースではなく、ファイルをデータベースとして使用出来るものを探しています。 接続ライブラリを探している? データベースを探している? どっちを探している? 前者ならPEAR:MDB2かPDOを使えばいい。 後者なら#1が回答しているSQLite
Oracleのバージョンの記載が無いため、最新版という解釈で回答しますね。 質問１のポイントは、SQL文の実行計画が低コストで実施されるよう書いてあるかが大前提ですので、explain planや、SQLトレースを使用して、低コストになるようSQLを書きなおす、そしてテストを行い、再度トレースを採取し・・の繰り返しでチューニングを行うのがベターかと。 ちなみにですが、where句にインデックス項目が使用されていても、その項目が型変換されるよう書き方をされている場合インデックスが使用されなくなる可能性がありますのでご注意下さい。 質問２ですが、これは一概に「こうだ！」という説明は難しいと思います。（詳細な環境説明が無いため回答しにくいです） また、これはDB全般に言えることですが、１つのSQLをチューニングしていくのはなく、もっと多くなくくりでチューニングをして行ったほうが早い場合もあります。 それには、スタッツパック等のツールを使用します。 それには、CPUの負荷はどれくらいか、ディスクのIO待ちは発生していないか、キャッシュメモリに余裕があるか、バッファヒット率が高いか、一番遅いSQLは何か、ナドナド、様々な情報が出てくるツールですので、それを元に「システム自体のチューニング」を実施していったほうが良いと思います。 乱文乱筆失礼しました。 また、参考にならかったらスミマセン。
　まず、正確な定義を書いておきます。 　「関係 (リレーション) がスカラ値のみを持ちうるとき、そのリレーションを第1正規形であるという。」 　「あるリレーションが、第1正規形で、かつ、すべての非キー属性が、すべての候補キーに対して完全従属するとき、第2正規形であるという。」 　「あるリレーションが、第2正規形で、かつ、非キー属性があるならば、それら全てが候補キーに非推移的に関数従属するとき、第3正規形であるという。」 　となります。 　 　まず、第１正規形では、表をフラットな形にすることを、目標とします。ここでフラットな形とは、繰り返し項目（配列）や構造体を持たないことを意味します。この段階では、キーに関する言及はありません。ただし、集合としての性質上、全てのレコードが一意に決定できる（重複がない）ことは必要です。 　第２正規形では、候補キーへの「完全従属性」を求めます。これは、候補キーの一部だけが決まれば値が決まるという項目があってはいけないことを要求しています。完全従属性は、関数従属の特別な場合です。 　 　そして、第３正規形では、「推移的な関数従属がない」ことを求めています。これは、Ａが決まるとＢがきまり、Ｂが決まるとＣが決まる　という関係です。つまり、Ａが決まるとＣが決まることになりますね。これが「推移的な」関数従属です。 　例えば、「会員番号・氏名・支店コード・支店名」というテーブルを考え、会員番号を候補キーとしましょう。（つまり、会員番号は全社で一意な番号となっています。）会員番号が決まれば、氏名と所属する支店コードが特定できます。そして、支店コードが決まれば支店名が特定できます。この結果、会員番号が決まれば、推移的に支店名も特定できます。これが、推移的な関数従属です。 　このテーブルが第２正規形は満たしていることに注意してください。候補キーは、会員番号のみですので、氏名・支店コード・支店名のいずれも、候補キーの一部分には関数従属していません。 　さて、では、もう少し補足です。 　＞「第一正規化」では、データの重複をなくす事をする 　すこし違いますね。データの重複がないことは集合としての条件で、正規化以前の話です。 　＞「第二正規化」では関数従属をおこないxの値が決まればyの値が決まるのと同じように あるキーが決まれば、他のキーも決まるようになること 　これも、少し残念。キーの一部分で決定できる項目がないようになることが目標です。 　＞「第三正規化」では関数従属をなくすと聞いたんですが、意味がわかりません 　意味がわかったら、ある意味大変です。関数従属がなくなったら、データベースとして形をなしません。 　なくすのは、「推移的な関数従属」です。「関数従属」を無くしてしまったら、データとしてのつながりがなくなる・・・つまり、テーブルとして存在しなくなってしまいます=^・・;=。
> DBCopyTool.exe これは使ったことが無いのでわかりません。 > また当初の希望内容を実現するため、他の方法があれば　 DTS（Data Transformation Services）を使う、ではダメですか？ 直接接続がダメでも、Textなり、MDBなりにデータ変換するツール（双方向）。 参考ＵＲＬ：MicrosoftさんのWebページ [SQL Server 2008 R2 における SQL Server 2000 DTS のサポート] 参考URL：http://msdn.microsoft.com/ja-jp/library/bb500440(v=sql.105).aspx
SELECT * FROM M_SHOHIN WHERE code = ANY( SELECT code FROM M_SHOHIN WHERE class_code = '01' );
大変失礼いたしました。 指摘いただいた通り、Standardは大丈夫そうですね。 勘違いしておりました。 Server OS縛りなのはEnterprise Editionのようです。 惑わせてしまい申し訳ありません。
alter table Test_table alter column name nchar(20)
＃３です 申し訳ありません。 各フィールドの型を記述していませんでしたね。 テーブル「TA」では、LV（数値型/長整数）、その他はテキスト型 テーブル「TB」では、LV（数値型/長整数）、SLV はテキスト型 　（テーブル「TB」の主キーは　LV） たぶん、この型があっていなかったので、コンボボックスの SELECT TA.ID, TA.名前, TA.PWD, TB.SLV FROM TA LEFT JOIN TB ON TA.LV = TB.LV; が取得できていなかった可能性があります。 デザインで、この「値集合ソース」の表示部分をクリックすると、 右側の SELECT・・・・が反転表示になると思います。 その状態で、右側の[・・・]をクリックすると、クエリのデザインの様な表示になります。 「F_LOGIN：クエリ ビルダ」の表示部分で、マウス右クリックし、 「データシート」表示にしてデータがどう並んでいるか確認してみます。 OK なら保存して終了です。 標準モジュールへの変更は＃３の通りです。 確認するフォーム「F_MENU」は＃２から変更なしです。 （コントロール名に _ が付いている状態のものです） また、私が確認したのは、テーブルを以下の様に設定していました。 テーブル「TA」 ID　　名前　　PWD　LV A1234　AAAA　1234　1 B1234　BBBB　1234　2 C1234　CCCC　1234　3 D1234　DDDD　1234　6 テーブル「TB」 LV　SLV 1　,2,3,4, 2　,2, 3　,3,5, 4　,4, 5　,5,1, これで確認できると思います。 （上記では D1234 さんがオールマイティ） 繰り返しになりますが、 他のフォームでも同じように Enabled 設定したかったら、そのフォームに Private Sub Form_Load() 　　Call FrmLevelSet(Me) End Sub を記述するだけです。ただ、コントロール名は命名規則に従っている事が前提です。 また、 Call FrmLevelInit ' 初期化　を記述するのは、ログアウトする直前の最後の最後です。 途中初期化してしまうと情報が消えてしまうので、再ログインが必要になります。 ２）の方法で良かったんでしょうか。 押しつけるつもりはありませんので、良い方法が見つかればそちらの方で・・・・ ※　２）はレベルをコントロール名に持っていましたが、この部分にタグ（Tag）を使う 　　っていう方法もあります。雰囲気わかっていただけるかと思います。 ２）で「btn_4」となっていたらタグ（Tag）に ,4, を設定しておいてコントロール名は自由に >　　i = InStr(.Name, "_") >　　If (i > 0) Then >　　　　If (InStr(sUserLevel, "," & Mid(.Name, i + 1) & ",") > 0) Then >　　　　　　.Enabled = False >　　　　End If >　　End If 部分を 　　If (Len(.Tag) > 0) Then 　　　　If (InStr(sUserLevel, .Tag) > 0) Then 　　　　　　.Enabled = False 　　　　End If 　　End If に変更するだけです。 この方法では、タグ（Tag）は書き換えれませんが、 テーブル「TB」の SLV 変更で、途中からでも変更要求には対応できます。 おかしな所等ありましたら、補足いただければと・・・
回答でなくて申し訳ありませんが、質問をする際には、もっと詳しい情報（使っているソフト等）を教えて頂かないと、答えようがありませんよ。
No.1です。 時間帯について明確な回答が得られませんでした。 なので一般的なサーバはどのような感じ化回答しておきます。 日中帯はアクセス数が多くなり負荷が高くなっています。 夜間はバッチ処理が走っていたりオペレータが作業していたりで負荷が高くなっています。 比較的安全な時間帯を上げるならば早朝の時間帯でしょうか。 私の以前の職場ではそんな感じです。 また、商用環境ですとAM03時～AM05時くらいに切り替えやバージョンアップ作業が入ります。 アナウンスがあるとは思いますが、この時間も避けておくのが無難でしょう。 これらの時間帯を避けて作業を行ったうえで規制がなされたのであれば よほど規制が厳しいのだとお考えください。 その際は現在実施されている運用に戻せばいいでしょう。 もしくはDBの更新時のSQLをすべてバッグアップし手動で反映させるか・・・ 現在の運用方法のほうが簡単で手間もなく、安全だとは思います。
MS-Access 2000での例。
SQL文が変ですが、質問内容に対する回答はYESですね mysqlデータベースのuserテーブルにおけるhostは その特定ユーザーが任意のホストからアクセスする際の権限です。 SQLのいわゆるLIKEをつかったマッチングにあたるので 「%」は全てのホストという意味になります また別途hostテーブルでも制限されますのでご注意ください 詳しくは http://dev.mysql.com/doc/refman/5.1/ja/connectio …
SQL Server 2008 Expressを既定のインスタンスとして作成すると、インスタンス名がSQLEXPRESSとる仕様になっています。 検証していないので不確かですが、 SQL Server 2008 Expressを名前付きインスタンスを選択し、名前に「MSSQLServer」を入力しインストール すると希望されているサーバー名のみの接続が可能になるかもしれません。 ちなみに、SQL Serverはインスタンス名無しではインストールできません。 普段サーバー名だけで接続できているのは、裏側で既定のインスタンス名である「MSSQLServer」を自動保管しているのです。 例えばtestサーバーに、製品版の既定のインスタンスをインストールしたとします。 Management Studioで、接続先に「test」と入れて接続を試みると、 裏側で、「test\MSSQLServer」と解釈しているのです。 インスタンス名が「MSSQLServer」以外の場合は、ユーザーが指定する必要があるのです。 ですので、Expressの場合、あえて名前付きインスタンスを選択し、「MSSQLServer」でインストールすると結果的に、上記動作にのっとり、サーバー名だけで接続できるようになるかもしれません。
select cast( DeviceTime as date ) as 日時, DeviceID as 端末番号, max(DeviceValue) as 計測最大値 from テーブル名 group by cast( DeviceTime as date ), DeviceID order by 日時,端末番号
> できれば一つのクエリで上記の結果を表示させたいのですが 一つのクエリの定義が微妙なところですが、以下でどうでしょう？ ※検品テーブルへのレコード展開はなされているものとしています。 ※インデントのため全角スペースがあるので注意してください。 ※表示順は、得られた[コード]の昇順にしています。 select t1.コード, t2.数量 as 数量合計 from マスターテーブル t1 inner join 受注テーブル t2 on t1.コード = t2.コード where t1.印刷フラグ = 'YES' union select t3.コード, count(*) as 数量合計 from 検品テーブル t3 where t3.コード in (select t4.コード from マスターテーブル t4 　where t4.印刷フラグ = 'NO') group by t3.コード order by 1 ;
http://zipcloud.ibsnet.co.jp/ 郵便番号データはこちらをすすめます http://typhoon.yahoo.co.jp/weather/jp/warn/14/ http://typhoon.yahoo.co.jp/weather/jp/warn/23/ http://www.jma.go.jp/jp/warn/320_table.html http://www.jma.go.jp/jp/warn/329_table.html もし自分なら　気象庁　の地域を参考にします http://cpf.uub.jp/seirei.html http://cpf.uub.jp/chukaku.html http://cpf.uub.jp/tokurei.html 政令市　中核市　特例市　はある程度の規模なので 分割が必要なのかもしれません http://www.water.city.nagoya.jp/user/renraku/ren … 名古屋では水道局などが情報でありました http://www.iezo.net/tiikinavi/aichi/nagoya/ 学区で分けるとか https://www.google.co.jp/search?num=100&hl=ja&sa … 個人的には　食べログを逆検索で地域をリストアップするプログラムなど用意します
WAL アーカイブを有効にして、ベースバックアップを取得、archive_command でベースバックアップ後の WAL を自動バックアップすればよいようです。archive_command で scp を使ったり、コピー先を NAS にしたりすれば別サーバにバックアップデータを退避できます。 バックアップは復旧できてなんぼのものですから、取得したバックアップデータからきちんと復旧できることも確認してください。 参考URL：http://www.postgresql.jp/document/8.3/html/conti …
そもそもshohinが特定されているならgroup byするまでもないのでは？ SELECT COUNT(*) AS kazu FROM zaiko WHERE shohin='A';
親子カテゴリーというか、その手のものは、さらに孫カテゴリーが出来て、ツリー型になるので、親子でtableを分離すると逆に面倒なことになる。 しかし、ツリー型をデータベースでうまく処理するには、こつが要る。 ３種類の方法があって、最終的にどんなデータの取り出し方をすることがおおいか、どのデータベースシステムを使うのか（サブクエリの使い勝手や、Oracleのように階層関係を簡単に処理できる関数を持ってるか）によって決めるとよいだろう。 http://makizou.com/1616/ に概略解説がある。 １．隣接リスト型　：　parent_id を持たせる方法 ２．経路列挙型：　ディレクトリーツリーのような表示形式で保持する方法 http://www.makizou.com/archives/1662 ３．入れ子集合型：　右値と左値を持たせて、子集合は、親の左右値内に入る様にする http://www.geocities.jp/mickindex/database/db_tr … まあ、単純一覧でぱっと見理解しやすいのは、２の列挙型かと思うけど、列挙形式記述にこつが要る。親側に変更があるときに面倒、プログラムで行えばどうということもないけど。 ３は、ぱっと見分け解りません。データ作成も手作業では間違うから、プログラムをうまく組む必要があります。でも、最終的に結構すっきりした構造になるという利点があります。 １は、データ作成は簡単だけど、取り出すときに、階層処理関数を持ってないmysqlでは一回で階層化できないことが多い。２階層しかないなら、あんまり問題にならないかもしれないけど。 「テーブルの正規化」は、ちょっと意味が違うので、ちゃんとそれを解説しているページを探して読んでください。
こんな感じです、sumを使うのがポイント create table hoge(科目 varchar(30),点数 int); insert into hoge values('英語',93),('英語',96),('英語',88),('独語',95),('独語',83),('仏語',84),('仏語',89); select 科目 ,sum(点数>=95) as 95up ,sum(点数>=90) as 90up ,sum(点数>=85) as 85up from hoge group by 科目;
表をコピーして、貼り付けたい場所を右クリック＞形式を選択して貼り付けをクリック、「すべて」から「数値」を選択すればいいのでは
＞桐の　どのメニューから選べばできるか　ご存じの方　教えてください 入力フィールドを右クリックらしいです。 ＞カレンダーを利用して　日付データを　入力 カレンダー入力コントロールは提供されてないので、カレンダーを模した入力フォームを自作する必要があるのだそうで。
2行目がファイル名だけということではないですよね。 計算式はいろいろありそうですけど =GetValue ( Substitute (オプジェクト ; "/" ; "¶" ) ; ValueCount ( Substitute (オプジェクト ; "/" ; "¶" ) ) ) とかはどうですか。オブジェクトはオブジェクトフィールドのことです。 オブジェクトフィールド内の「/」全部を改行に変更して最後の行の値を 取得する式です。ファイル名に「/」があるとダメですけど。
> 二度手間を避けるため、一度入力した顧客コードを空のフォーム上に表示させるには > どうすればいいでしょうか。 「メインメニュー」フォームにテキストボックスを配置して、名前を txt顧客コード とします。 ここに、「顧客登録」に表示させたい顧客コードを入力します。 埋め込みマクロのWhere条件式で [顧客コード]=[Forms]![メインメニュー]![txt顧客コード] と設定します。 「顧客登録」フォーム上の「顧客コード」テキストボックスの既定値プロパティを =[Forms]![メインメニュー]![txt顧客コード] と設定します。 以上でどうでしょうか。
SQLの実行はプログラムで処理しているのでしょうか？ （$iとか書いてあるし） その場合はPHPかなにかで処理していますか？ そうだとするとPHPからのデータ受け渡しはおかしくないですか？ もしくはphpMyAdminあたりでしょうか？ その場合は$iのところがどういう対応しているのかよくわかりませんが・・・
全パターンというのは、最終的に値が取れないものも含めてでしょうか？ 値が取れるものすべて、ならば少し変えるだけで済みます。 http://ideone.com/fQFUC
「(4)検索実行（クエリ）」とは具体的に何をしているのでしょうか。 検索結果表示（フォーム） を開くときに引数で抽出条件を設定するか、抽出条件を設定したクエリをレコードソースにしておけば、抽出結果を表示出来ると思いますが。 普通は、クエリを実行する必要はないと思います。 一度、「(4)検索実行（クエリ）」の処理を削除して試してみてください。 それでも解消しないなら、「検索」ボタンの埋め込みマクロの最後に、 「オブジェクトの選択」アクションで検索結果表示（フォーム）を選択する処理を追加すればどうでしょうか。
こんにちは。 リンクサーバーを使えば、 意図されていることができるかと思います。 参照URLに手順が記載してあります。 参考URL：http://msdn.microsoft.com/ja-jp/library/ff772782 …
SQL Serverで作業しているものです。 多分、MySQLでも同じと思いますが、 mainとsubを取得するときに固定値を入れたら判断することができます。 質問のSQL文ですと、下のように書いたらできます。 （tablenameという名前の列を追加しています。） SELECT tablename, id, tom, best, center, dragon 　FROM ( 　　SELECT 'main' tablename, m.id, m.tom, m.best1, m.center, u.dragon FROM main m　←セレクト１ 　　　LEFT JOIN usa u ON m.usa_id = u.id 　　UNION ALL 　　SELECT 'sub' tablename, s.red_id, s.red_title, s.best2, s.center, u.dragon FROM sub s　←セレクト２ 　　　LEFT JOIN usa u ON s.usa_id = u.id 　) as PIYO
最初の回答者の方と重複しますが 問題MDBを自身のPCにコピー。 Accessで空のMDB作成 （初期値はDatebase1.accdbになってますので拡張子をmdbに変更） （Access2003以前では使用しないのならばaccdbでも可） 空のMDBの、ファイル→オプション→カレントデータベース の名前の自動修正オプションのチェックは全て外す。 一旦MDBを閉じる。 再度開いて、リボンの外部データで問題MDBを全て、 この新規MDBにインポートする。 新規MDBでオブジェクト名が正しいか等、 VBAでは参照設定に参照不可になっているものがないかチェック。 その他諸々のチェック。 問題が無いのを確認したら、MDBを閉じる。 新規MDBのコピーを作成し（最適化の時に壊れる可能性を配慮） 新規コピーMDBを開いて最適化を試みる。 ■解決するかどうかの保証は出来ません。■ ※ファイルサイズが2GB近いならAccessの仕様の限界です。 テーブルにOLEオブジェクトの埋め込みでもしているのでしょうか？ もし問題が解決したとしても、ファイルサイズが2GB近いのなら 早晩また問題が発生する可能性があると思います。 また、Accessからも警告メッセージが出ていたはず。 なお、ファイルを共有しているので 「閉じる時に最適化」のオプションにチェックは入れないように。
その式では、「[Forms]![frm検索1]![消費者名]」で始まるデータを抽出することになります。 そのような名前の消費者が存在するはずもないので当然0件となります。 ""から出して & で連結しましょう。 Like [Forms]![frm検索1]![消費者名] & "*"
えーと、たぶんSQL Server Compact Edition 3.5は、ASP.NETに対応していなかったと思います。 対応したのはFramewok 4のASP.NETからかな？ 3.5CEはLINQのデータソースとして選択できるけど使えないと思います。 あと、SQLServer CE（3.5、4とも）は、Visual Studioと別製品。WebMatrixなんかだったらインスコされるけど、Visual Studioだけだと入らないよ。 インストーラがあるので、そちらからダウンロードしてインストールしてみてください。
試してみたら当方の環境でも文字化けしました。 調べてみましたらこちらの手順でOKでした。 http://www.e-petlife.com/wordpress/category/tats …
修正したときのみ、「元に戻す」を実行するようにすればいいでしょう。 修正したかどうかは Dirtyプロパティで調べられます。 　　条件　　　　　　　　　　　　　　アクション　　　　　　　　引数 [Forms]![フォーム名].[Dirty]　　コマンドの実行　　　　元に戻す
すみません。 t2の抽出条件が抜けていましたね・・・ ただ、No.4の補足にある >inner join t2 on (t2.key = (SELECT key FROM t2 WHERE name = 't2_name1')) では正しくないです。 こうしてしまうと、t2とt5の結合条件がなくなってしまうので、 t2に存在しない、t5の'2011-03-03'のレコードまで抽出されてしまうことになります。 ですので結果が13300になってしまいます。 >inner join t2 on (t2.key = (SELECT key FROM t2 WHERE name = 't2_name1')) こうではなくて inner join t2 on (t2.key = t5.t2_key and t2.name = 't2_name1') とすればいいです。 なので、 select sum(t5.amount * (t4.percent / 100.0)) result from ( 　( 　　select strftime('%Y', date) year, t2_key, t3_key, amount 　　from t5 　　where strftime('%Y', date) = '2011' 　) t5 　inner join t2 on (t2.key = t5.t2_key and t2.name = 't2_name1') 　inner join 　　( 　　　select t4.* from t4 　　　inner join t1 on (t4.t1_key = t1.key and t1.name = 't1_name1') 　　) t4 　on (t5.t3_key = t4.t3_key and t5.year = t4.year) ); これでどうでしょうか。 参考URL：http://ideone.com/86dQY
下記のSQLでどうでしょうか。 select top 1 * from mydata where 'P2342' Like key1 & "*" order by key1 desc;
> 下記の変換方法だと、「丁」や「-」がないものは空白で返してしまう。 > Left([番地],InStr(Replace([番地],"丁","-"),"-")-1) この部分だけが解決すればよいですか。 解決方法）InStr に与える文字列に必ず "-" が存在する様に加工する。 例えば、Left([番地],InStr(Replace([番地] & "-","丁","-"),"-")-1) とか、Left([番地],InStr(Replace([番地],"丁","-") & "-","-")-1) で、どうでしょうか
私のエスパーとしてのレベルが足りないので申し訳ないのですが まず、質問の意味が分かりません そしてなにがしたいのか、なぜそうしたいのかが、全く見えませんが 私のつたない第六感をたよりに書きますと SELECT id, century, tom, best, center, dragon FROM ( SELECT h.id, c.century, h.tom, h.best, h.center, u.dragon FROM hoge h --ここにhを追加 LEFT JOIN usa u ON h.usa_id = u.id LEFT JOIN century c ON h.century_id = c.century_id UNION ALL SELECT r.red_id, c.century, r.red_title, r.best, r.center, u.dragon FROM red r --ここにrを追加 LEFT JOIN usa u ON r.usa_id = u.id LEFT JOIN century c ON r.century_id = c.century_id ) as PIYO こういうことでしょうか？ テーブル名の後に略称を入れただけです。 ただ、こういう書き方をしても元の式と全く返される結果は変わらず。 また、内部処理も全く改善しないので なんの意味もないような気がするのですが…。 あと、常識すぎて指摘されるのも不愉快かと思いますが一応断っておきます。 （仮、テーブルを作成してコードが実行できることは確かめております。） 掲示板の仕様上コードに全角スペースが混入する可能性があります。 そのままコピーして実行してもエラーが出る場合はメモ帳などで全角スペースを半角スペースに変換してお使いください。 もし「こんな当たり前のこと聞いてねーよ、氏ね」と思ったらご容赦下さい。
こんにちは。 ・sp_add_job ・sp_add_jobstep を使うことで、自動化することはできると思います。 参考URL：http://msdn.microsoft.com/ja-jp/library/ms189953 …
select 出身地,sum(幅跳び),sum(反復横跳び),sum(懸垂),実施年,実施月 from ( select 出身地,得点 as 幅跳び,0 as 反復横跳び,0 as 懸垂,実施年,実施月 from MotoTable where 種目 = '幅跳び' union select 出身地,0 as 幅跳び,得点 as 反復横跳び,0 as 懸垂,実施年,実施月 from MotoTable where 種目 = '反復横跳び' union select 出身地,0 as 幅跳び,0 as 反復横跳び,得点 as 懸垂,実施年,実施月 from MotoTable where 種目 = '懸垂' ) group by 出身地,実施年,実施月 order by 出身地,実施年,実施月 とか、 select 出身地, sum(case when 種目 = '幅跳び' then 得点 else 0 end) as 幅跳び, sum(case when 種目 = '反復横跳び' then 得点 else 0 end) as 反復横跳び, sum(case when 種目 = '懸垂' then 得点 else 0 end) as 懸垂, 実施年,実施月 from MotoTable group by 出身地,実施年,実施月 order by 出身地,実施年,実施月 とか。 ## 下のほうが早そうだが、キーの持ち方とかで一概にはいえない。
# SQL ServerではなくC#の質問であるように思えますが……。 データを「どのように表示したい」のですか。 データの表示方法は一通りではないので，そのデータをどのように表示するかは作るときに決めなければならないことになります。 > string testID = reader["id"].ToString(); > Convert.ToInt32(testID) int testID = reader.GetInt32(reader.GetOrdinal("id")); とすれば，Convertする必要はないかと。
データの結合は相乗的にデータが増えるので、自己結合などで 条件設定を冗長にやっていると処理時間が膨大になったり メモリを食い過ぎたりなど当然想定しなくてはいけませんね ＞独学で、1，2か月 で、このレベルの質問ができるとすると、相当基礎的なスキルがあるかとは 思いますが、まずはSQLの基本である正規化について知識を深めて、 インデックスなどをためしながらexplainでテストしていく というのが流れになると思います。 また簡易なデータ参照についてはエンジンも思い切ってMyISAMなどで 処理することで高速化をはかるとか、データ更新がおおくなかったり 完全なリアルタイム性が必要でないものは中間テーブルをつくって 高速化することはできるかと思います。 プロジェクト管理についてはガントチャートやパートチャートの考え方を理解し、 プロジェクトのパートごとに人月設定をしたうえで、アサインするユーザーに 配分の係数を掛けていくと進捗がだせると思いますので プロジェクトテーブル、ユーザーテーブル、プロジェクト＝ユーザーアサインテーブル などに分けて処理すれば効率的にいけるかもしれません。 期間の処理はプロジェクトに寄せるか、さらに別テーブルで管理するかは 出力したい帳票によりますね
＜困っていること＞： 「会社検索フォーム」から顧客を選択後、「会社登録フォーム」では、支店情報は変わりますが、本社情報が変わりません。 （メッセージ：「リレーションシップが設定されたレコードがテーブル'支店テーブル'にあるので、 レコードの削除や変更を行うことはできません。」というメッセージがでます。） ----------- この点について、リレーションシップの結合の種類のところでフィールドの連鎖更新を許可していないのではないでしょうか。調べてみてください。
> 画面は404等のエラーになるわけでもなく真っ白です。 > ・・・ > ログファイル上では正常にページが読み込めたことになっています。 > ・・・ > ソースも真っ白です（1文字も表示されない）。 という状態で、何を見て↓だと分かったのでしょうか？ > DBのデータを読み込むためのPHPファイルをインクルードしようとするところでエラーを起こし、読み込みストップしています。 また、生ログとは apache などのWebサーバのアクセスログかと思いますが、Webサーバのエラーログを見ることは出来るのでしょうか？
管理番号とデザイン内容のフィールドオプションで入力値の自動化で 計算式を選んで、式を「" "」にして既存値を置き換えるにチェックす ると複製したときどちらのフィールドも空になります。 スクリプトでやるときは 　レコードの複製 　消去/管理番号 　消去/デザイン内容 　フィールドへ移動[]　--指定しない
＃１です 投稿直前に補足が見えたのですが、読んでません。 INNER JOIN が正しいのであれば、それはそうかもしれません。 LEFT JOIN としたのは、以下の様に friendname に記述された方が name に居なかった時のことを考えただけでした。 元テーブルが以下だった時 name　　friendname aaaa　　bbbb bbbb　　cccc cccc　　aaaa dddd　　gggg eeee　　bbbb ffff　　eeee ＃１での表示結果は name　　friendname　　friendname2 aaaa　　bbbb　　cccc bbbb　　cccc　　aaaa cccc　　aaaa　　bbbb dddd　　gggg　　 eeee　　bbbb　　cccc ffff　　eeee　　bbbb となるだけです。
SQLの土俵はなんですか？ あと、カンマの後ろに半角スペースを入れる習慣をつけると読みやすいですよ。 select book.author, sum(book.money * daityou.cnt) from book, daityou where book.bookname = daityou.bookname group by book.author ;
＃１です 訂正です。 以下の様なデータがあった場合は想定していませんでした。 ID 判定 日本語　　　英語 ・・・・ 11　　 o 　テスト　　　tests 12　　 o 　テスト　　　tests １）での ORDER BY 日本語, ID　は、ORDER BY 日本語, 英語, ID　としてください。 ２）での　日本語=Q2.日本語　の後に、 AND 英語=Q2.英語　を追加してください。 重複クエリを使った例になっていなかったので、 １）は、 SELECT Q1.ID, Q1.判定, Q1.日本語, Q1.英語 FROM TE AS Q1 INNER JOIN (SELECT 日本語, 英語 FROM TE GROUP BY 日本語, 英語 HAVING Count(*)>1) AS Q2 ON (Q1.日本語=Q2.日本語) AND (Q1.英語=Q2.英語) ORDER BY Q1.日本語, Q1.英語, Q1.ID; ２）は、１）を「Q_TE_1」名で保存したとして（＃１と変わりありませんが） SELECT ID, 判定, 日本語, 英語 FROM Q_TE_1 AS Q3 WHERE EXISTS (SELECT 1 FROM Q_TE_1 WHERE 判定<>Q3.判定 AND 日本語=Q3.日本語 AND 英語=Q3.英語); なお、これらは更新できない表示となります。 ＃１は、更新可能です。
MAIN、SUBともに1件だとしても、レコードとしては2件抽出したんですよね？ MAINとSUBをそれぞれ独立して抽出するならば、結合などせずUNION ALLすればいいのでは。
＞方法としては間違ってないでしょうか？ 効率的かどうかはともかくロジックはあっていると思います SELECT *している時点でインデックスは期待できないですしね ＞他にいい方法があればアドバイスをお願いします。 あえて指摘するなら構造が同じテーブルなら、一つにまとめてしまった方が 効率がいいのは間違いないです （おそらくなんらかの理由でわけているのでしょうけど）
MySQLに限らずSQL全般についてorder byにて任意にソートルールを指定しない限り 表示順は保障されません。
create table t1 (品番 varchar(30),枝番 int); insert into t1 values('aaa',1),('bbb',2),('aaa',2),('ccc',3),('aaa',6); create table t2 (品番 varchar(30),枝番 int); insert into t2 values('aaa',2),('rrr',5),('bbb',5),('aaa',6); delete from t1 where (品番,枝番) in (select 品番,枝番 from t2); みたいな感じでよいのでは？
1レコードをユニークに特定できる情報が無いのであれば、基本的には無理です。 各レコードにユニークIDを振るなどデータの持ち方を見直した方がいいと思います。
これでどうでしょうか？ select human.名前 from human where exists ( select 'Y' from kotoba_have where kotoba_have."human.id" = human.id and kotoba_have."kotoba.id" in (select id from kotoba where koboba.名前 in ('日本語','英語') ) ) and exists ( select 'Y' from kakutougi_have where kakutougi_have."human.id" = human.id and kakutougi_have."kakutougi.id" in (select id from kakutougi where kakutougi.名前 in ('柔道','空手') ) )
>ユーザ名、趣味名１、趣味名２、趣味名３を表示させたい 意図がよくわかりませんが5個登録されていても3つだけ表示したいということでしょうか？ もし単純に全ての趣味を表示してよいならこんな感じで //準備 create table user(uid int not null primary key,uname varchar(100)); insert into user values(1,"佐藤"),(2,"鈴木"),(3,"田中"),(4,"吉田"); create table hobby(hid int not null primary key ,hname varchar(100)); insert into hobby values(1,"テレビ"),(2,"ネット"),(3,"ゲーム"),(4,"ラジオ"),(5,"スポーツ"),(6,"スポーツ観戦"),(7,"映画鑑賞"),(8,"音楽鑑賞") create table user_hobby(uhid int not null primary key auto_increment,uid int,hid int,unique(uid,hid)); insert into user_hobby(uid,hid) values(1,1),(1,2),(1,3),(1,4),(1,5),(2,2),(2,5),(2,3),(2,1),(3,1),(4,2),(4,3),(4,5),(4,7),(4,8); //表示 select uname,group_concat(hname) as hnames from user as u inner join user_hobby as uh on u.uid=uh.uid inner join hobby as h on uh.hid=h.hid group by u.uid;
こんにちわ。 > (2)select * from user_sys_privs;でもselect等の権限の確認はできませんでした。 > (3)select * from user_tab_privs;では一件も出てきませんでした。 (2) がSYSTEM 権限 (DML やDDL を実行する権限) で (3) がOBJECT 権限 (特定の表やSEQUENCE に対する操作権限を他ユーザに付与) です。 > 上記3つは何か間違えているのでしょうか？ 恐らくは、ROLE (権限の塊り) 経由で権限が付与されているのではないでしょうか？ ユーザに付与されたROLE はuser_role_privs で確認できます。 また、ROLE に付与された権限を確認する場合は、dba_role_privs を確認して下さい。 詳細は、Oracle のリファレンス・マニュアルを確認して下さい。 http://docs.oracle.com/cd/E16338_01/server.112/b …
join の所を、right join　に変えてみてください。 これで、うまくいくと思いますけど。 解説： 　joinで、結合するには、両方のテーブルに結合条件に該当するレコードが存在することが必要です。 　片方のテーブルにだけ存在するデータも欲しい時には、 　　joinの左側に書いたテーブルのデータが全部欲しい→left join 　　joinの右側に書いたテーブルのデータが全部欲しい→right join 　　両方のテーブルのどちらか一つでもあれば全部欲しい→full join 　を使用します。 　使い方は全く同じ。結果が異なるだけです。
--たとえば…… select No from tmp group by No having 0 < sum(case when Flg = 'A' then 1 else 0 end) and 0 = sum(case when Flg = 'B' then 1 else 0 end);
そんなに難しくないですよ。 select TABLE1.X , (select count(*) from TABLE2 where TABLE2.Z = TABLE1.X) from TABLE1
SELECT CD, SUM(CASE WHEN FLG = 0 THEN KINGAKU ELSE 0 END) AS KINGAKU_0, SUM(CASE WHEN FLG = 1 THEN KINGAKU ELSE 0 END) AS KINGAKU_1 FROM 対象TBL GROUP BY CD;
> チェックボックス付きの一覧が表示されるフィールドと,表示されないフィールド 定義されている内容と、登録されているデータはどんな状態？ 「チェックボックス付きの一覧を表示させる」意味が無い状態とか。 性別フィールドが定義されていて、取りうる値が「男性/女性」の２値なら 「チェックボックス付きの一覧を表示させる」意味はあろうけど チェックボックス付きの一覧が表示されないフィールドは 何万もレコードがあって、登録されているデータの種類も何万とあるなら、 「チェックボックス付きの一覧を表示させる」意味はなさそう。 （例：全国郵便番号簿テーブルの"郵便番号"）
> オプショングループのコントロールソースは何も指定していません。 オプショングループのプロパティ設定が下記になっているか確認。 使用可能　はい 編集ロック　いいえ フォームのプロパティ設定が下記のなっているか確認。 更新の許可　はい
その質問だと asp.net がかわいそうだ。 PageMaker に置き換えられる程度の要件だから結果として PageMaker の評価が良くなっているに過ぎない。 PageMaker は RDB ではなくカード型 DB なので、扱うデータの構造が 1枚の表で表現できる程度なら力を発揮する。 他のテーブルとの連携、プログラミングによるデータ処理のロジックなどは不得意と言える。 また、PageMaker の共有機能がどの程度なのかわからないが、Windows アカウントのグループ情報を使って、あるグループしか表示できないページを作ったりなど、ASP.NET としての可能性をまだまだ知らないだけだと思う。
With Me 　　Debug.Print .Controls("単価_" & cnt) End With とか。 Me("単価_" & cnt) でも参照できます。
質問者さんが書かれていることはリレーショナル型のデータベースが一番得意とすることです。多分全部できると思います。 EXCELだとどうなんでしょうか。VBAの得意な人はある程度のことができる様な気もしますが、データベースソフトならあまり苦労しないで可能です。 高度な使い方ではないので、No.1に書かれているようにFilemakerがちょうど良いのではないかと思います。最初はEXCELなどで、表をつくってみられてはいかがでしょうか。 食器の種類ごとに、整理番号、食器名称、大きさ、形状、色調、用途、数量、保管場所など、１種類につき１行で。 それと、 献立ごとに必要な食器の種類と数量（人数にも依存するでしょうから大皿は何人１枚とか）の表をつくると、献立と人数を入れると必要な食器をリストアップしてくれるなどが可能です。 献立が同じでも、数種類の食器の候補から選ぶのはちょっと考えないといけないような気もしますが、組み合わせの種類が多くないのなら難しくないように思います。 あとは顧客管理や予約管理も一緒にやってしまうこともできます。 EXCELでのデータがある程度できた段階で、Filemakerに読ませればそれなりのデータベースができます。試用版で試してみてはいかがでしょうか。
> どのような参考書を使えば良いですか？ 大きめの書店のデータベースのコーナーに行けば入門書がたくさん有りますから、その中から気に入ったものを選べばよいでしょう。 一つ挙げるとすれば下記の書籍がお勧めです。 http://www.amazon.co.jp/dp/4798118818/ > 独学で出来るのでしょうか？ 基本的な知識を身に付けるという点では独学で出来ると思いますよ。 ただし、何事でもそうですが、知識だけではスキルが有るとは言えませんが。 > 20代後半から勉強しても出来るようになるものでしょうか？ 十分出来ますよ。 > 基礎をマスターするのにどれくらいの時間がかかりますか？ SQL92の範囲を一通り覚えるだけであれば、数十時間も見れば十分でしょう。 (もちろん使いこなすには、はるかに時間が掛かるでしょう) > このスキルを使って就職できるようになるまでどれくらい時間がかかりますか？ うーん、独学で勉強したというだけでは採用の決め手になる可能性は少ないでしょうね。業務実績が無いとさほど評価はされないでしょう。まあ、難関とされている資格を持っていれば少しは興味を持ってもらえるかも知れません。 就職については、学んだスキルが一助となるかも知れない、程度に考えておいたほうが良いでしょう。 > 資格などはありますか？ いろいろ有ります。各DBベンダーがそれぞれの製品向けの技術認定試験を行っているケースも多いです。 DB関係の資格の例を挙げてみます。 「データベーススペシャリスト試験」 http://www.jitec.ipa.go.jp/1_11seido/db.html 「オラクルマスター」 http://www.oracle.com/jp/education/certification …
カスタムダイアログ表示ステップの後ろに Get ( 最終メッセージ選択 ) を入れて分岐していますか？ ボタン１が「OK」、ボタン２が「キャンセル」の場合 If [Get ( 最終メッセージ選択 ) = 2 　現在の（全）スクリプト終了 とか。
組み合わせテーブルと製品テーブルの関係がよくわからないですね （組み合わせテーブルと製品テーブルを並列に書いているので区切りもわからない） 結果として、どういうデータが抽出されることを想定していますか？
レポートの集計機能を使っても、クエリを使っても、どちらでもできます。 レポートウィザードを使えば、レポートの集計機能を使った方法が簡単にできます。 ウィザードによりレポート作成する方法 http://www.microsoft.com/japan/office/previous/x … 上記のページの説明で、集計オプションの指定のところで表示するデータの「集計値のみ」にチェックを入れておくと合計のみ表示されます。 クエリを使う場合は下記の手順で。 クエリを新規作成して、消費者マスターと判定マスターを追加します。 ２つのテーブルを判定コードで連結します。 集計クエリにします。 下記のように設定します。 フィールド____販売店コード___判定コード___判定結果____件数: 消費者コード___料金合計: 料金 集計__________グループ化______グループ化__グループ化__カウント_________________合計 このクエリをレコードソースとするレポートを作成します。 レポートフッターにテキストボックスを2つ配置してコントロールソースを下記のように設定します。 =Count([消費者コード]) =Sum([料金]) これで総件数と総合計が表示されます。
■質問1 SHOW TABLE STATUS WHERE Name = 'テーブル名' の結果で返却された、 Auto_incrementカラムの値が、 次回発行される「auto increment の値」です。 ■質問2 AUTO_INCREMENTが設定されているカラムに対しても値を自分で指定して設定することができますので、 削除した一番若い番号を利用することは可能です。 ↓ mysql> insert into autotest(id, name) values(15, 'DVDプレイヤー'); ■質問3 引き継がれます、AUTO_INCREMENT値500までデータがあればAUTO_INCREMENT値501からINSERTされます。
最後に編集したレコードを表示するみたいですから それだけでも良さそうですね。
Null値（未入力値）は特殊な値ですので、=演算子では比較することはできません。Is演算子を使います。 抽出条件欄に Is Null としてください。Null以外を抽出するときは、 Is Not Null とします。
レポートのテキストボックスのコントロールソースを下記のように設定してください。 =Choose([用途区分],"家庭","業務用","その他") ただし、データベースの機能を活かしたお勧めの方法は、下記のようなマスターテーブルを作成してそれを利用する方法です。 T_用途区分 -------------------- 用途区分　区分名 -------------------- 1　家庭用 2　業務用 3　その他 レポートのレコードソースの「ビルドボタン」をクリックして、クエリのデザインビューを表示させて、T_用途区分 を追加して、 用途区分フィールド同士で結合します。T_用途区分の「区分名」をダブルクリックしてフィールドに表示させます。 レポート上に「区分名」フィールドをテキストボックスとして配置します。 こちらの方法ですと、例えば用途区分が増えたり、変更になっても、テーブルデータの編集のみですみます。 最初の方法だと、フォームのコンボボックスやレポートのコントロールソースなど複数箇所の変更が必要になります。
遷移先の ninsyou.php にて idとpassの値を取得 ↓ <?php $id = $_POST['id']; $pass = $_POST['pass']; ?> その値を利用してMySQLへSELECT問い合わせ ↓ SELECT * FROM TABLE名 WHERE id = '$id' AND pass = '$pass' これにてテーブルに情報があるかどうか確認出来ます。
mysqliをつかう http://www.php.net/manual/ja/book.mysqli.php もしくはPDOで処理する http://www.php.net/manual/ja/class.pdo.php
ポップアップメニューにして0～9を入力しても 該当するリストには移動しませんよね。 ドロップダウンリストにして、Aフィールドを 計算値自動入力/既存値置き換え に設定して、計算式を Case ( PatternCount ( Self ; "." ); Substitute ( Self ; Left ( Self ; 2 ) ; "" ) & "様"; Self & "様" ) にする。 トリガにしてもいいけどSelfが使えない・・・
状況がよく分かりませんけど レコードの保存なら、VBA では、Docmd.RunCommand acCmdSave なんですけどね。 Access2000は落としてしまったので違うかも知れませんが ショートカットキーなら F9 や Ctrl + S かな？
１つ確認ですが、SQL-AとSQL-BとSQL-C、それぞれの処理速度を厳密に比較したいという事ですよね？ であれば、それぞれのSQLを実行する前に、DBを再起動する必要があると思います。 SQLを実行すれば、どうしてもデータはキャッシュにのってしまいます。 なので、DBを再起動して、完全にまっさらな状態にする必要があります。 「運用上それが出来ない」となれば、その環境と同じ環境を別に用意して、そこでテストを行うしか無いと思います。 ちなみに、No1の回答者さんが示したURLは、OracleBIを使用している場合の説明ですね。
>「読み込み中です。」のような画面 この仕組みだと、2～3秒ならいいですが10秒くらいが待っていられる限界ですね ajaxでデータを呼び出し、readystateをチェックする流れだと思います もし30秒以上かかるような想定であれば、予約式にして 予約確認画面で作成状況を確認し、データができあがっていたら ダウンロードするような方式が現実的です
with T as ( select t1.* from ( select 検索対象データ.*, dense_rank() over( partition by ID order by 価格 ) rnk from 検索対象データ ) t1 where t1.rnk <= 2 ) select T.ID, T.日付, T.価格 from T where not exists ( select 1 from T T2 where T.ID=T2.ID and T.価格=T2.価格 and T.日付>T2.日付 ) order by T.ID, T.日付 desc
ANo.1さんの回答の参照先は Visual Basic の例ですね。 AccessVBAはちょっと異なっていて癖がありますのでVBのコードをそのまま使えません。 ■コントロール名(文字列型)を変数にする場合 Dim　strCtl As String strCtl = "TextBoxName" Me.Controls(strCtl).FontSize = 9 .Controls は省略することもできます。 Me(strCtl).FontSize = 9 ■コントロールオブジェクト（オブジェクト型）を変数にする場合 Dim objCtl　As Object Set　objCtl = Me.TextBoxName objCtl.FontSize = 9
どこかにあるかもしれませんので、写真の検索を行ってみて下さい。
すみません、不都合が二つほど 標準モジュールは Function countStr(s As Variant) As Long 　　Dim i As Long 　　For i = 1 To Nz(Len(s),0) 　　　　If Mid(s, i, 1) Like "[A-z,Ａ-ｚΑ-ω]" Then 　　　　　　countStr = countStr + 1 　　　　End If 　　Next End Function に変更してください。 F1 と F2 のどちらかが Null だった場合のことを考慮。 また、クエリは 判定:iif(countStr([F1]) = countStr([F2]) ,"一致","不一致") にしてください（前回F1どうしを比較してましたorz） これで抽出条件に、"不一致"で出来るハズです。 以下は独り言です。 ギリシャ語のホームページからAccessのフィールドにコピペすると ほとんどの文字が全角文字に変換されてしまいます。 しかし、中には半角文字のままのが少々。 なあぜぇ？？ 少々の半角文字になってしまう文字については nora1962 さんの回答で SELECT regexp_count( 項目, "[a-zA-Zａ-ｚＡ-Ｚα-ωΑ-Ω△□]")　FROM テーブル △□は、その文字を順次一文字づつ追加したイメージです。 にすれば出来ました。 F1の個数:regexp_count([F1],"[a-zA-Zａ-ｚＡ-Ｚα-ωΑ-Ω△□]") F2も同様に 判定:iif(regexp_count([F1],"[a-zA-Zａ-ｚＡ-Ｚα-ωΑ-Ω△□]") = regexp_count([F2],"[a-zA-Zａ-ｚＡ-Ｚα-ωΑ-Ω△□])","一致","不一致") 私は文字について根本的な事がわかっていないので危ない雰囲気 (^^ゞ 私の回答ではpattern をコード中に埋め込んでしまっているので出来ません。 （VBEではShift-JIS？ですのでコピペした時点で半角ギリシャ文字が『?』になります） また前回回答でキャラクタコード云々の事をエラソーに言ってますが、これも忘れてください。 さっぱり判らなくなりました。
変数で設定するパスを間違うとそのアラートが出ます。 photexportが実際にはphotoexportになっているとか？ End Loopも無いですよ。
SELECT count_coin, COUNT(*) FROM (SELECT user_id,COUNT(coin) count_coin FROM buy GROUP BY user_id) t GROUP BY count_coin; でどうでしょうか？ もしかして、これは2回のSQLということになってしまうのでしょうか・・・
http://blogs.yahoo.co.jp/kensinisnek/10176003.html 9. 以下のメッセージが出力されたら、接続は成功ですので、「OK」をクリックしてください。　他のメッセージが表示される場合、何かしら設定に問題があると思われます。 の画面は出ましたか？
確かインストールしてから変更していなければ、 SERVERPROPERTY ( 'servername' )と同じところを見ていたと思うので、 nvarchar(128) http://msdn.microsoft.com/ja-jp/library/ms174396(v=sql.90).aspx より。 心配なら、 nvarchar　とのみ設定しておけば？ http://msdn.microsoft.com/ja-jp/library/ms187944 … より なお、SQL Server2000 と仕様が変わっていた項目だった記憶があります。
エラーメッセージそのものだけど、 インサートしようとしているデータに外部キー違反があるため、インサートできなかったってこと。 ・インサートをあきらめるか、 ・別の値をつけてインサートするか、 ・キーの設定を変えるか
>「果物の出現回数が多い順に並べる」 ということなら、 select * from tableA x order by (select count(*) from tableA y where y.name = x.name ) ,No とか、 select x.no,x.name from tableA x, (select y.name,count(*) cnt from tableA y group by y.name ) z where x.name = z.name order by z.cnt,x.No とか。 DBにより多少変わるかも。(as句が必要だったりとか・・・）
> 実行結果については、どちらも特にエラーメッセージは表示されず > 画面で見る限りは何も入っていないように見えます。 > 該当項目に移動し金額や日付を入力し更新ボタンをクリックすると > 正常に反映されていました。 ということは値の代入はできているが、表示に反映されてないという状況のようですね。 通常はすぐに反映されるはずなんですが、なにか普通でない設定をしているのかな。 とりあえず、OS、Accessのバージョン、単票フォームなのか帳票フォームなのか、など、 また、標準から変更した設定などがあればご提示ください。 あと、対症法的な対策になりますが、下記のコードを追加してみてください。 Private Sub 単価ランク_AfterUpdate() 　　Me.料金=DLookup("単価","単価マスター","単価ランク=" & Me.単価ランク) 　　 Me.Repaint End Sub あるいは、Me.Recalc を追加してみてください。
こんにちわ。 http://docs.oracle.com/cd/E16338_01/appdev.112/b … 上記のマニュアルにある通り、PL/SQL でLONG RAW 変数の上限は32760 Byte になります。 なので、PL/SQL でLONG RAW のデータを扱うのは難しいと思います。 どうしてもと言う事であれば、TO_BLOB で一度BLOB 型に変換する事になるかと。
すべてのページに表示させたいと言うことですね。 販売店コードフッターで正常に表示されているなら、出力範囲も販売店コードも、 ページフッターに単純に移動させただけで問題なく表示されるはずです。 frm出力範囲 は開いたままにしてますよね。 とりあえず現状の設定してある式をコピーして貼り付けてください。 それと、Accessのバージョンも教えてください。
＃１です。 > デザインビューでは1～3は完成しており、 1～3のクエリをSQLビューで表示して、開示できますか？ （クエリ１・２の日付--Where条件の年月日に関する列定義はどうなってる？）
こんにちわ。 http://docs.oracle.com/cd/E16338_01/server.112/b … 上記のメッセージマニュアルによると、詳細はAlert Log, Trace Log を確認するように 記載されています。 ORA-53203 発生時のAlert Log, Trace Log には何が記録されていますか？ 52000番台って、Oracle Multimedia 関連のエラーのようですので、Oracle Multimedia を 使っている部分を確認してみてはどうでしょう？
ＣＭＳにもよるかと思いますが可能だと思いますよ。 例えば、ＣＭＳの代表としてWORDPRESSなどがありますが、この場合、現在のサーバーの管理パネルにログインして、【エクスポート】というものでデーターを抜き出します。 次に新しいサーバーにWORDPRESSのプログラム本体をインストールした後で、同じようにバックアップデーターを復元するを選択すると、そのサーバーに最初のサーバーの時と同じデーターが瓜二つでできます。 もちろん写真などのデーターもすべてコピーできています。 ＣＭＳは基本的にサーバーのデーターベースという機能を使用しますので、サーバーそのものの管理パネルの中にデーターベースの中身をエクスポートできる機能がありますし、復元もできると思います。 ドメインというのは、たぶん独自ドメインのことだと思いますので、ドメインの管理パネルにログインして、サーバーのデーターとして、【ネームサーバー】というところを新しいサーバーの指定するものに変更します。 ネームサーバーというのは、その独自ドメインのURLが呼び出された時に、どのサーバーへそのことを転送するか？という役割を一瞬で振り分けているだけになります。 ネームサーバー変更を行いますと、早ければ１時間後に新しいサーバーの方のデーターを呼び出しますが、古いサーバーと新しいサーバーがまったく同じデーターになっていると、どちらが呼び出されているのかがわかりにくくなりますので、インデックスページなどを少しだけ書き換えたりして、自分でわかるようにしたりもします。
SQL SERVER 2008 R2、 PostgreSQL 9.1(cygwin）で試したところではrow_number()のover句でのオーダー順で出力されました。 実行計画をみても、WINDOWSソートの後はシーケンス処理のみということで今の実装上ではover句の指定順になると思われます。 なお、SELECT文の最後にORDER BYでROW_NUMBER関数の値を指定したところ、SQL SERVER 2008 R2では無視（最適化）され、PostgreSQLでは実行されるようです。 ただし、SQLの規格としてはおそらくover句順を保証してはいないと思います。
>string 変数にどんどんと長いクエリを書いてしまいがちです SQL文の中に改行コードを含めてもかまわないので、 適当なところ（項目名の次とか、命令の次とか）に改行コードをプログラムで入れても問題ないので 私はプログラムでstring 変数中にクエリを書いている処理の最中にところどころで、 string 変数中に改行コードを入れることをしていますが。 C#は使わないので例えばVBとかでは dim sqlstr as string sqlstr = "Select * from tableA" & vbcr &vblf sqlstr = sqlstr & "where tableA.A1 = '" & wkstr1 & "'" & vbcr &vblf sqlstr = sqlstr & "order by " & wkstr2 & wkstr3 & wkstr4 といった具合。 ## whereの中はホスト変数にしたほうがいいけど・・・ま、サンプルということで。
sub 印刷ボタン_click() DoCmd.OpenReport "テストレポート, acViewPreview, , "テスト1 = '" & txt_inputID & "'" を DoCmd.OpenReport "テストレポート, acViewPreview, , "テスト1 = '" & me!txt_inputID & "'" ,openargs:=me.name にしてください。 あとチェックボックスの方なのですが、印刷プレビューだけの場合でもチェックを入れて構わないのでしょうか？ 勝手に印刷時のみと思い込んで回答します。 レポートの其々のイベントに下記のように、といってもYU-TANG さんの受け売りですけど。 Option Compare Database Option Explicit Private IsPreview As Boolean ' プレビュー判定用フラグ Private Sub Report_Activate() 　　IsPreview = True End Sub Private Sub レポートヘッダー_Format(Cancel As Integer, FormatCount As Integer) 　　If Me.Visible Then IsPreview = False End Sub Private Sub Report_Close() 　　If Nz(Me.OpenArgs, "") = "" Then 　　　　Exit Sub 　　End If 　　If IsPreview Then 　　　　' 印刷プレビューの場合の処理 　　　　MsgBox "印刷プレビュー" 　　Else 　　　　' 印刷の場合の処理 　　　　If MsgBox("印刷は無事終了しましたか？", vbYesNo) = vbNo Then 　　　　　　Exit Sub 　　　　End If 　　　　 　　　　CurrentDb.Execute ("UPDATE てーぶる名 SET テスト5 = True WHERE テスト１='" & Me!txt_inputID & "'") 　　　　Forms!テストメインフォーム.Recalc 　　End If End Sub 補足 　　If Nz(Me.OpenArgs, "") = "" Then 　　　　Exit Sub 　　End If はレポートを単独で開かれた場合には何もしないということです。 DoCmd.OpenReport "テストレポート, acViewPreview, , "テスト1 = '" & me!txt_inputID & "'" ,openargs:=me.name でフォームから開いた場合は、openargs:=me.name で名前を渡しています。 蛇足 　　　　If MsgBox("印刷は無事終了しましたか？", vbYesNo) = vbNo Then 　　　　　　Exit Sub 　　　　End If は今回の場合は１レコードだけ？の変更なので邪魔かもしれないです。 多くのレコードの一括変更の場合などの時は入れとくと幸せになれるかも。 ※夏バテ気味で何処かにポカが空いてるかも知れません。。。
主キー項目でないなら update テーブル名 set コード = '0' + コード
>どちらのテーブルを左側 FROMの次の最初のテーブルが左側です。 尚、後で解析しやすいように、なるべくLEFT JOINを使い、どうしてもRIGHT　JIONが必要な場合のみRIGHT　JIONを使う事を推奨します。
提示された情報からは、No.2 の回答の ="住所コード：" & Forms![frm出力範囲]![住所自] & "～" & Forms![frm出力範囲]![住所至] & Chr(13) & Chr(10) & "販売店コード：" & Forms![frm出力範囲]![販売店自] & "～" & Forms![frm出力範囲]![販売店至] & Chr(13) & Chr(10) & "担当者コード：" & Forms![frm出力範囲]![担当者自] & "～" & Forms![frm出力範囲]![担当者至] で問題ないはずです。 情報に間違いがあるか、式に記述ミスがあるとしか思えません。 オブジェクト名に間違いがないか、記述に間違いがなかい注意深く確認してください。全角/半角が違っていたり、空白が入っていたりなど、ちょっとでも違うとエラーになります。 あと、このレポートを開くときに、フォーム「frm出力範囲」は開いたままにしてますよね。閉じちゃったら参照できませんのでエラーになります。
ライセンスについてここで質問しても何の保証もない。 質問をするならマイクロソフトかマイクロソフトのパートナー企業にすべき。 SQL Server に関するご相談窓口 http://www.microsoft.com/ja-jp/sqlserver/2008/r2 …
それはcmd自体のcharsetがUTF-8ではないからです コマンドプロンプト上に以下コマンドを打ち込んでください UTF-8に変更する場合のコマンド chcp 65001 デフォルトに戻す場合 chcp 932 以上おためしください
最初のフィールドで愛知県を除外検索実行 次のフィールドで愛知県除外で絞り込み検索
SELECT DISTINCT t2_code,date FROM t1 INNER JOIN t2 ON t1_code=t2_code WHERE (t1_type,date) IN(SELECT t1_type,MAX(date) FROM t1 INNER JOIN t2 ON t1_code=t2_code GROUP BY t1_type) でどうでしょうか。
頻度が高いのであれば最初から別カラムに専用でとっておき インデックスを貼っておくことです
主キーが無いのでは？ AccessでODBC接続のリンクテーブルは 主キーがないと更新可能になりません。
SELECT … FROM Ａ Right Outer Join Ｂ Ｂ on Ｂ.c =Convert(varchar(10),Ａ.d) varchar(10),は、 Ｂ.cの型にあわせる。 ただし、 今までは暗黙の型変換で、数値に変換されていたから条件が成立していたケースで条件が成立しない 場合がでてくるかもしれません。 例） Ｂ.cが' 1'で、Ａ.dが1のとき、 数値に変換されると、どちらも1ですが、 文字に変換すると、 Ｂ.cが' 1'で、Ａ.dが'1 'になって等しくならないかも。 というようなことがおきたら、 on trim(Ｂ.c) = trim(Convert(varchar(10),Ａ.d)) trim()を利用してください。
遅くなりましたが、参考になれば。 EMは、それ単体でWEBサーバのような役割を持っています。（これがdbconsoleプロセス） なので、DBが停止していようが、リスナーが停止していようが、EMプロセス自体は使用できます。 また、DBプロセス、リスナープロセスは、EMプロセスとは完全に独立していますので、EMからそれらの状態を確認することが出来ます。 ただ、EMから、DBにアクセスする処理、リスナーにアクセスする処理を実行する際には、当然、それらのプロセスが起動していないとアクセス出来ません。 という意味です。
これって、単に金額が＋なら、１行ずつ出力して、 －なら、日付でgroup byして出力したいってこと？ SELECT　case when 金額>0 then ID else Null end,　日付,　sum(金額), case when 金額>0 then 伝票 else Null end,　・・・ FROM 　出納帳 group by case when 金額>0 then ID else Null end,　日付, case when 金額>0 then 伝票 else Null end,　・・・ order by 日付,case when 金額>0 then ID else Null end ででるはずですが（未検証ですが。）
「フォームを開く」マクロの「Where条件式」に提示の式を設定したと言うことでしょうか。 で、希望することは、マクロを実行すると、「パラメータの入力」ウィンドウが開き、標題に「消費者コードは？」と表示されていて、ユーザーが入力した値と一致する[消費者コード]のレコードをフォームに表示させたいということでしょうか。 上記の推測があっているとすると、、、 「フォームを開く」マクロの「Where条件式」に下記の式を設定してください。 [消費者コード]=[消費者コードは？] この推測が違っているのなら、 どこに提示の式を設定して、 どのような動作を希望しているのか、 具体的に説明してください。
テーブルの構造が書いてないので、はっきりとは分かりませんが、式が間違っているというより、そもそもテーブルの構造がおかしいんじゃないでしょうか。 でもまずは式から検討してみましょうか。 私は、やりたいことと式がまったくあっていないと思います。 そのDLookup関数は、次のような動作をします。 テーブル"Q_単価分類別_単価"のレコードで、"商品コード"フィールドの値が Me.商品コード である（つまり当該フォームの"商品コード"テキストボックスの値）であるレコードをひとつ探し、そのレコードの"ShukkaPtn"フィールドの値を返す。 こういうことがしたいんですか？そのテーブルは"ShukkaPtn"という名前のフィールドを持っているのですか？ なお、ドメインをあらわす引数には[]をつけません。 私が想像するに、"Q_単価分類別_単価"というテーブルは、以下のような構造を持っているんじゃないですか？ 商品コード|01|02|03|04|・・・|13|14|15|・・・ そして01などのフィールドに単価がデータとして格納されているのではないでしょうか。 もしそうなら、テーブルの設計が間違っています。 あるいは、クロス集計の結果できたクエリなのかもしれませんが、そのフォームで単価を呼び出すのなら、元のテーブル（ないしクエリ）私はこういう風にするべきだと思います。 商品コード|出荷パターン|単価 そして、そのテーブルには商品コードと出荷パターンの全ての組み合わせとそれに対応する単価が書いてあるのです。 こういう風にして初めて、テーブルがデータベースとして使えるようになります。 例えば、DLookup関数で単価を呼び出すときはこうします。 Me.売上単価 = DLookup("[単価]", "Q_単価分類別_単価", "[商品コード]='" & Me.商品コード & "' AND [出荷パターン]='" & Me.出荷パターン & "'") なお、出荷パターンもテキストデータだと仮定しています。
ネットワークの設定状況がわかりませんので正確な回答が出せませんが、XPとホストPCと接続しようとしているWindowsPCをまず同じLAN（サブネットマスクとネットワークアドレスを同じにする）に設定する方法が一番確実です。（他のLANは極力使わない） VirtualPCのXPはホストPCと同じLANカードを使う事で、同じLANケーブルを使って同じLANに接続できるはずです。
>※Col1に重複がある場合、重複結果の1行目のレコードをData2に入れる の「1行目」の定義がハッキリ書かれていませんが、 例を見ると一番小さな値ということでいいのでしょうか。 それなら単純に、 UPDATE Table2 T2 SET Data2 = (SELECT MIN(T1.Col2) FROM Table1 T1 WHERE T1.Col1 = T2.Data1); でいいのではないでしょうか。 ただ、このSQLだとTable1にTable2のData1と一致するデータがない場合は NULLに更新されてしまうので気を付けてください。 もし、そういうデータが存在するのであれば UPDATE文のWHERE句にEXISTS条件を書くようにしてください。
--綺麗かどうかはともかく、かなり無理やり SELECT 日付, SUM(金額) AS 金額 FROM ( SELECT 日付, 金額, ROW_NUMBER() OVER (PARTITION BY 日付 ORDER BY 金額) AS id FROM 出納帳 ) GROUP BY 日付, CASE WHEN 金額 < 0 THEN 0 ELSE id END;
回答が付かないようなので・・・・ フィールド数が多いのが難点ですが、 パラメータクエリーでごりごり力尽くでやるのは駄目なんでしょうか？ ただこれだけフィールド数が多いと大変ですけど。 検討済みであればごめんなさい。 お邪魔しました。
投稿データ[bbsTable]と会員マスタ[userTable]を結合するキーが bbsTable.postUserName　と　userTable.userName なんですかね？ ユーザーIDを用いてない投稿時のデータとマスタを関連付けできるのかな？という点が気になります。 投稿時のユーザー名と会員マスタのユーザー名が完全一致するものだけ、拾うはず。 （当然、検索結果の件数が減ります） select t1.postUserName, t1.postTitle, t1.postText, t1.postDate, t2.userType as postUserType from bbsTable t1 inner join userTable t2 on t1.postUserName = t2.userName order by t1.postDate desc; 投稿データ[bbsTable]はすべて選択させたいなら select t1.postUserName, t1.postTitle, t1.postText, t1.postDate, t2.userType as postUserType from bbsTable t1 left join userTable t2 on t1.postUserName = t2.userName order by t1.postDate desc; 結果を確認する間は t2.userType as postUserType　の行を t2.userName, t2.userType as postUserType　としたほうがよさそう。
ビジネス活用事例から見て，(1)(2)(3)すべてNoです。 http://japan.zdnet.com/cio/analysis/35011528/
【例2】はホントのSQL文ですか？selectする列とOrder Byの列が合ってません。 やはり実機で、シンプルな検証データ・テーブルで確認をしたほうが良いでしょう。 OracleだとOrder By をselectする列番号で指定できましたが、SQLServerはどうでしたっけ。 SELECT DISTINCT ISNULL(T1.C1,""),T1.C2 FROM T1 ORDER BY 1
>モジュールからサーバにアクセスして、サーバ側のローカルファイルなどに書き込むなどして >ログを残す といった箇所は全く経験がなく検討がつきません。 Apacheサーバーを含めて主要なサーバーアプリはアクセスがあったページのログを自動で残す機能がありますから 単純にダミーのページを一つつくってクライアント側から起動時にバックエンドでそのページにアクセスするように しておけばサーバー側でアクセスログから時間と起動した端末のIPアドレスが割り出せます。 もう少し詳細な情報を自前のデータベースに取り込みたい場合はPHPなどで動的ページを作成しページへの アクセス時のURLの「?」以降にパラメータを記載してサーバー側で情報を受け取って処理する方法があります。 例） http://xxx.xxx.xxx.xxx/index.php?cliant=xxx&stat … ようするにクライアント側からは積極的にデータベースの更新には動かずページを見に行くだけに留め サーバー側でページを見に来た相手を記録してログとして残すわけです。 確実性という点では若干の不安が残りますがデータベースの接続、更新、切断の手間に比べれば手軽に実装できます。
SELECT文ですが、子カテゴリーの parent_id と親カテゴリーの category_id で自己結合するのが簡単かと。 なお、テーブルの行数が多いと性能的な問題が出てくるかも知れません。 例) ------------------------------------ SELECT cld.category_id AS child_category_id, cld.parent_id AS child_parent_id, cld.other_data AS child_other_data, ・ ・ ・ prt.category_id AS parent_category_id, prt.parent_id AS parent_parent_id, prt.other_data AS parent_other_data, ・ ・ ・ FROM category cld LEFT OUTER JOIN category prt ON cld.parent_id = prt.category_id WHERE cld.category_id = :category_id; ---------------------------------------- テーブル構造ですが、0～1の親を持つカテゴリー階層はツリー構造の一種ですから、下記の記事が参考になると思います。 http://www.geocities.jp/mickindex/database/db_tr … http://www.geocities.jp/mickindex/database/db_tr … http://gihyo.jp/dev/serial/01/sql_academy2/000601
＃１です。やっぱりMySQL.EXEへのパスが通ってないことが原因と思います。 以下、XAMPPをC:\直下にインストールしたものと仮定します。(C:\XAMPP\) MySQは、C:\XAMPP\MySQL以下に、MySQL.EXEはC:\XAMPP\MySQL\binにあるもとします。 １）環境変数PATHを確認してください。 　　コマンドプロンプトで　PATH　と入力して [Enter]を押下してください。 　　（このPATHにはC:\XAMPP\MySQL\binは含まれてないはず。） ２）環境変数PATHにC:\XAMPP\MySQL\binを追加してください。 　　マイコンピュータのプロパティ＞詳細設定の環境変数ボタンをクリック。 ３）ソステム環境変数をスクロールしてPathを探し、クリックしてから編集ボタンをクリックする。 ４）末尾に　;C:\XAMPP\MySQL\bin　を追加し、ＯＫボタンをクリックする。 ５）ＯＫボタンをクリックする。 ６）もう一回、ＯＫボタンをクリックする。 これでコマンドプロンプトで MySQLが実行できるはず。 ソースに記述してある　ユーザー名/パスワードでログインしてください。 ＰＨＰ入門のＷebページ探す際、「ＸＡＭＰＰ　ＭｙＳＱＬ　設定」で上記の記載があるはずです。
SDカード内にデータペースを作るちょっと特殊な方法だと削除は出来るけど通常の方法の rom内にデータペースを作るタイプだとrootでも取ってない限りそこにアクセスしてデータを削除することはできない。 アプリの管理画面からデータの削除をするしかない。
多分こちらの件と同様かと思われますがどうでしょうか？ MySQLの UNIQUEなINDEXには長さ767byteまでしか使えない件と対策 http://d.hatena.ne.jp/tanamon/20090930/1254332746 参考URL：http://d.hatena.ne.jp/tanamon/20090930/1254332746
こんにちわ。 > 「integer external」と「decimal external」のどちらが良いのですか。 > 違い、使い方を教えてください。 interger とdecimal は全く意味が異なります。 http://docs.oracle.com/cd/E16338_01/server.112/b … 上記のマニュアル (Oracle ユーティリティ) に記載されている通り、 integer は整数型, decimal はパック10進となります。
SQLでは改行マークは文の区切りではないので普通に改行すればいいのでは？ create table hoge (id int,data varchar(100) default 'a b c'); insert into hoge(id) values(1),(2),(3); select * from hoge;
mysqlでは、データベース名に 「_」アンダースコアがあると、ワイルドカード扱いになるので、アンダースコアの手前に「\」バックスラッシュをいれてエスケープが必要です。 ワイルドカードにより同時に複数のデータベースを開こうとしていることになるので、mysql_select_db はエラーになってると思うのですけど。 mysql_select_dbの直後でも mysql_error() の出力をチェックしてみてください。
例１）単純に縦に出力したいときに使う。 select 課名,'予算' as 予実,nvl(予算金額,0) from 課マスタ left outer join 予算マスタ on 課マスタ.課コード = 予算マスタ.課コード union select 課名,'実績' as 予実,nvl(実績金額,0) from 課マスタ left outer join 実績マスタ on 課マスタ.課コード = 予算マスタ.課コード order by 課名,予実 とすると、 1課 予算 10000 1課 実績 8500 2課 予算 20000 2課 実績 0 ・・・ とでる。 例２）例１と違ってどちらか一方にしかないデータをどちらも出したいときに使う。 select 課名,sum(予算金額), sum(実績金額) from ( select 課名,予算金額 as 予算金額,0 as 実績金額 from 予算マスタ union select 課名,0 as 予算金額,実績金額 as 実績金額 from 実績マスタ ) group by 課名 order by 課名 とすると 1課 10000 8500 2課 20000 0　　　←実績マスタなし 3課 0 8500　←予算マスタなし とでる。 例３）今年新規（過去３年間取引のなかった取引先も新規として扱う）で獲得した取引先の数 select count(*) from ( select distinct 取引先コード from 売上マスタ where 年度 = 2012 minus select distinct 取引先コード from 売上マスタ where 年度 = 2011 minus select distinct 取引先コード from 売上マスタ where 年度 = 2010 minus select distinct 取引先コード from 売上マスタ where 年度 = 2009 ) 例４）（これはどっちかというとシステム保守要件ですが。） 何らかの異常があったときに不整合データのチェックに使う select * from Ａマスタ_バックアップ minus select * from Ａマスタ Ａマスタ_バックアップにあってＡマスタにないものが出てくるので、 これらを調べたりする。 select * from Ａマスタ minus select * from Ａマスタ_バックアップ 逆のパターンのデータ。これも調べる。 とか。 例５）Orの代わりにunionを使うと便利なこともたまにある。 select * from table1 where Key1 between 1 and 3 union select * from table1 where Key1 between 6 and 7 union select * from table1 where Key1 between 12 and 18 select * from table1 where Key1 between 1 and 3 or Key1 between 6 and 7 or Key1 between 12 and 18 と書けばしまいなのだが、orを使うとインデックスを使ってくれないことがあるので、 orを使わないselectをunionしたほうが早いことがたまにある。 ★table1が、5000万件あるときなどあくまで例外的な使い方です。 ！！！普通は、orを使ったほうがいいです！！！ ## SQLはこんな感じだったと思うというレベルで書いています。（うまく動かないかも） ## とりあえず、過去に使った例ですぐに思いついたパターンを挙げてみました。
CSVとか MDBとか
補足ありがとうございます。 ということは >001　　AAA　　DDD があって >NULL　 AAA　　DDD もあるというのは間違っていますよね。 ですので、以下のデータと結果を正として考えます。 --データ 001　　AAA　　BBB 001　　AAA　　CCC 001　　AAA　　DDD 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　EEE --DDDをEEEに変えました NULL　 AAA　　BBB NULL　 AAA　　CCC --結果 001　　AAA　　BBB 001　　AAA　　CCC 001　　AAA　　DDD 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　EEE 以下のSQLでどうでしょうか。 select 種類,キー1,キー2 from ( 　select 種類,キー1,キー2,count(*) over(partition by キー1,キー2) cnt 　from ( 　　select 種類,キー1,キー2 from Table1 　　union select 種類,キー1,キー2 from Table2 　　union select 種類,キー1,キー2 from Table3 　) ) where 種類 is not null or cnt = 1 order by 種類,キー1,キー2; 全角スペースでインデントしているので、実行時には削除するか半角スペースに置き換えるなどしてください。
キーワード「mysql update」でGoogle検索してヒットする http://dev.mysql.com/ 公式サイトの次のリファレンスマニュアルを参照。 -------- MySQL バージョン 4.0.4 以降では、複数のテーブルに対する UPDATE 操作も実行可能です。 UPDATE items,month SET items.price=month.price WHERE items.id=month.id; （出典 http://dev.mysql.com/doc/refman/4.1/ja/update.html ） --------
今までの機能は2007？から削られたようです。 私の場合は、Alt + Tab で切り替えていたのでがっかりです。 代替案としては、最初の方の回答の他には ナビゲーションフォームを作る位しか無さそうです。 http://msdn.microsoft.com/ja-jp/library/office/f … なお、タブの表題の所を、得意先 → 得意先 &1 （半角の数字やアルファベット） 等としておくと、 フォームビューでは、得意先 1 の1の下に _ （アンダーバー？）が付きます。 この状態で Alt + 1 とするとそのタブに移動します。 ですが、いずれにしても以前に比べると・・・ですね。(-"-) MukkuMuku さんが考えられたようですが、私はAPIに関しては門外漢なのでご紹介まで。 http://mukkumuku.blogspot.jp/2010/11/office2010- …
「入力インターフェイスにExcel」 「同時利用者が数十名」 「ADO」で接続してデータ操作 「閉じるときに最適化する」にチェックしておいて、 「ExcelからAccessアプリケーションを呼び出してある資料をレポート出力」 という運用を考えているのですね。 No1、No2の回答でも言われてますが、ADOで接続して接続を閉じただけでは最適化されませんし、CreateObject で Access を起動しているのなら、Accessオブジェクトを閉じた時に最適化されます。 ただし、このような運用は、非常に危険だと思います。 例えば、誰かが ADOで接続してデータ操作しているときに、別のユーザーがレポートを印刷して閉じて最適化されたら、どうなるのか。 あるいは、二人がほとんど同時にレポートを開き印刷後閉じて、同時に最適化が始まったら、どうなるのか。 accdbファイルが破損する危険性が非常に高い運用だと思います。 最適化に失敗してデータファイルが消滅したという報告をまれにWEBでみることもあります。 レポートを印刷するたびに最適化を繰り返すというのはやはり破損の危険性を高めます。 No1の回答で紹介されているリンク先 http://office.microsoft.com/ja-jp/access-help/HA … でも、 > ネットワーク上で複数のユーザーが単一のデータベース ファイルを共有する場合を除き、最適化と修復を自動で行うようにデータベースを設定します。 というようにファイルを共有している場合は、最適化を自動で行うのは推奨していません。 accdbファイルを置いているサーバーが常時電源オンになっているなら、深夜など誰も使用していない時に、あるいは毎朝、電源を入れるならPC起動時に、自動で最適化するようにするのがいいかと思います。 安全性を重視するなら、バックアップをとってから最適化するようにするのがよりいいでしょう。Accessにおいては定期的なバックアップは必須です。 具体的な方法としては、Windowsのタスクで、上記のリンク先の最適化ショートカットのコマンドを実行させるようにします。
オートナンバー型は長整数型です。 『4 バイトで、-2,147,483,648 ～ 2,147,483,647の範囲の整数を表すデータ型。Visual Basic では、キーワードは Long で、型宣言文字はアンパサンド (&) です』 限界に達したらどうなるかというと オートナンバー型フィールドが上限値を超えた場合はどうなる？ http://www.ruriplus.com/msaccess/Exp/Exp0901.htm 負の数を使い始めたら入力の並び替えには使えませんね。 もっとも、その前にAccessでは重たくて。。。 道草ですが日付時刻型に時刻の部分も入れれば（Now()とかで）もっと使えます (＾＾ゞ データ型の限界の前にAccessが過労死するのは間違いないと思います。 『倍精度浮動小数点数型 (Double) の変数は、IEEE 64 ビット (8 バイト) の浮動小数点数の変数です。負の値は -1.79769313486231E308 ～ -4.94065645841247E-324、正の値は 4.94065645841247E-324 ～ 1.79769313486232E308 の範囲の値をとります。倍精度浮動小数点数型の型宣言文字はシャープ記号 (#) です。』 >初期値（１からスタート）に戻すこと 『Access オートナンバー リセット』でGoogleって見てください。 http://support.microsoft.com/kb/812718/ja テーブルのオートナンバーを振りなおす方法（β版） http://www.f3.dion.ne.jp/~element/msaccess/AcTip … などなど。 AccessClub.jp さんが見えなくなってる？。
UTF-8 で間違いはないのでしょうかね。 以下思いついたことです。 １・BOMの有無で読み込みが変わらないか。 ２・Shift-JIS に変換してしまったら・・。 ３・ADODB.Stream で読み込んだら。 http://d.hatena.ne.jp/replication/20091117/12584 … ４・Excelに一旦読み込ませたらどうなるか。 ５・テキストファイルをそのままデータベースとして開いたら。 http://home.att.ne.jp/zeta/gen/excel/c04p47.htm そちらのAccessのバージョンが不明なので "Provider=Microsoft.Jet.OLEDB.4.0;" & は "Provider = "Microsoft.ACE.OLEDB.12.0;" かも知れない。 Ｘ・もしかしてファイルが壊れてる？ そのファイルの製作元にShift-jis で出力できないか頼んでみる。 以上、ご参考まで。
CentOS5.xが現に稼動しており、CentOS6.xにマイグレーションしようとしているのですね。 CentOS5.xのphpMyAdminのインストール方法について特に明示はないようですが・・・ CentOS6.xをyumでインストールしているとの記載がありますので、同様にしてyumでインストールしたと推察します。 質問には、config.inc.phpの内容は明記されていますが、格納位置は明示されていません。 phpMyAdmin2では、config読み込みインスタンスは、 new PMA_Config('./config.inc.php') と、ハードコーディングしています。 これに対してphpMyAdmin-3.5.2では、間接指定となっています。 new PMA_Config(CONFIG_FILE); このCONFIG_FILEはどこで定義されているかと言うと、 libraries/vendor_config.php:define('CONFIG_DIR', '/etc/phpMyAdmin/'); libraries/vendor_config.php:define('CONFIG_FILE', CONFIG_DIR . 'config.inc.php'); という具合になっています。 従いまして、/usr/shere...ではなく /etc/phpMyAdmin/config.inc.php の内容をご確認ください。 ちなみに phppgadminは当初から /etc/phpPgAdmin においてあるので気が付かなかったのではないですか?
ANo.2さんの方法で可能だと思いますが、クリエ一つでやりたい場合は、 テーブルからクエリを作成して、STOCK の抽出条件に下記の式を記述 In (SELECT ID FROM TABLE WHERE STOCK Is Null) AND Is Not Null SQLだと、 SELECT ID, STOCK FROM TABLE WHERE ID In (SELECT ID FROM TABLE WHERE STOCK Is Null) And STOK Is Not Null; これは、ANo.1さんのSQL の = を In に変更しただけです（複数の結果を返すサブクエリに = は使えない）。 他にも、 SELECT ID, STOCK FROM TABLE INNER JOIN (SELECT DISTINCT ID FROM TABLE WHERE STOCK Is Null) WHERE STOK Is Not Null; とか、いろいろあります。
なんか勘違いしてませんか？ デフォルト値や設定を変えたからといって、すでに設定されているものは 変わりませんよ？ きちんとやるならdbを作るときに文字コードを意識してつくります。 CREATE DATABASE db_hoge DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci; またtableをつくるときにもテキスト系のカラムに文字コードを指定します CREATE TABLE db_hoge.tbl_fuga (id INT NOT NULL ,data VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_unicode_ci); もうすでにlatin1で設定されているカラムに対してはalterで変更します ALTER TABLE tbl_fuga CHANGE data data VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci
FooEditorならグループ置き換えの機能があるので<a href=○○>はそのまま置き換えることができます ただ、<a href="○○">と</a>を同時に置き換えることはできないので、2回に分けて実行する必要がありますが… 例（FooEditorの場合) 検索パターン：<a href="(?<foo>.+)"> 置き換えパターン：[url=$1]
＞＞mysql5.5.9 バージョンが・・・。 [mysqld] default-character-set=utf8 　　　　　↓ character-set-server=utf8
SELECT ID,MAX(列) AS 最大値 FROM (SELECT ID,列1 AS 列 FROM テーブル UNION ALL SELECT ID,列2 AS 列 FROM テーブル UNION ALL SELECT ID,列3 AS 列 FROM テーブル UNION ALL SELECT ID,列4 AS 列 FROM テーブル UNION ALL SELECT ID,列5 AS 列 FROM テーブル) AS TBL GROUP BY ID ORDER BY 1 でどうでしょうか。
こんにちわ。 > 元々キャッシュに関してはデフォルトのまま（20）で試してますが、欠番は確認できていません。 > 以前のoracleのバージョンだと欠番されていたが、11gだと起きないものなのでしょうか？ Sequence から採番した時に、SGA (Shared Pool) にCache されるので、 事前に「select seq1.nextval from dual;」とか行って、アクセスしておかないと Cache されません。 11g (11.2.0.3) で最近確認しましたが、Shared Pool をFlush しただけで普通に 欠番が発生していました。 書き忘れましたが、RAC 環境だったりすると、1Node を再起動しても、もう1Node が 情報を持ってたりするらしく、欠番は発生しませんでした。
http://shain.blog.conextivo.com/2007/10/phppdosq … http://codezine.jp/article/detail/433 http://keicode.com/cgi/using-sqlite-in-php.php http://d.hatena.ne.jp/fatwebstudy/20120804/13440 … http://d.hatena.ne.jp/fatwebstudy/20120804/13440 … http://www.phppro.jp/school/security/vol3/1 http://gihyo.jp/dev/serial/01/php-security?start … http://www.ipa.go.jp/security/awareness/vendor/p … http://www.ipa.go.jp/security/awareness/vendor/p … 関連がありそうなものをいくつか紹介します 何か不明な点があれば補足をお願いします
質問者様はグラフに表示された数式と同じワークシートの数式を正しく作成されています。 （実際の数式ではyはなくxのところにセル参照が入っているのですよね） 元データと合わない原因ですが、グラフに表示された数式の係数の精度不足ではないでしょうか。 それが原因であれば、グラフに表示された数式の表示形式を変更して係数の精度を上げ、その数値でワークシートの数式を作り直せば多くの場合解決します。 どのような数値でも精度良く表示するためには、表示形式を指数にして小数点以下14桁にするとよいと思います。 ご存知かもしれませんが、以下念のためグラフに表示された数式の表示の変更方法を説明します。 Excel2003とExcel2007についての解説となりますが他のバージョンも大きくは違わないと思いますのでそこのところの対応はよろしくお願いいたします。 １．グラフに表示された数式を右クリック ２．2003なら「データラベルの書式設定」をクリック、2007なら「近似曲線ラベルの書式設定」を左クリックする。 ３．書式設定のダイアログが出るので、「表示形式」を左クリック（2003は上、2007は左上。最初からクリックされた状態になっている可能性あり。） ４．「分類」（表示形式）の「指数」を左クリック。（「数値」はNG） ５．「小数点以下の桁数」を14にする。（最大30だが「分類」（表示形式）が「指数」ならば15以上は無意味。Excelの精度が15桁であるため。） ６．「OK」を左クリック なお、質問者様の作成された式の「2*POWER(10,8)」の部分ですが、「2*10^8」「2E+08」「2e8」などとしても数式の値としては同じになります。
回答というより補足なので、参考までに読んでください。 ＞もちろんさかのぼって修正ということもありえますね。 そうしたシステムもあるかと思いますが、事実の記録に基づいたシステムでは基本的にはありません。 （データが確定する処理が何段階もあるような場合は途中修正ができるものもあります） 事実の訂正も訂正のデータを入力することによって記録します。 銀行の取引でもそうなっていますよね？（実際に紙に記録した通帳の訂正はできないので） そうすることで、正確な事実の記録やデータ改竄の防止だけでなく、計算がシンプルになるというメリットもあります。
それは、選択クエリです。 http://www.geocities.jp/haku1569/pasocom/microso … 更新クエリに変更してください。 2007以降ならクエリをデザインビューで開けば リボンの中に『更新』てのが有ります。
UNIONつまり集合演算子を使った場合、SELECTするカラム以外のソートはできません。 これは、MySQLに限った話ではなく、ANSI/ISO SQLそのものの仕様です。 postDate でソートするなら、SELECTするカラムに postDate が無くてはいけません。 （もちろんUNIONする全テーブルに無いとダメです） さて、ご質問に対しての回答は以上ですが、以下、Tritonn環境がないので、想像で書きます。 全文検索用のcommentIndex、これも各テーブルにあるものですよね？ だとしたら、ご質問の書き方だとこうなります。 table1→無条件に全表走査（遅い） table2→無条件に全表走査（遅い） table3→無条件に全表走査（遅い） table4→ここだけ全文検索（高速） 各テーブルから検索ワードで全文検索したいのであれば select text from table1 where match(commentIndex) against("検索ワード" in boolean mode) union all select comment from table2 where match(commentIndex) against("検索ワード" in boolean mode) union all select comment from table3 where match(commentIndex) against("検索ワード" in boolean mode) union all select comment from table4 where match(commentIndex) against("検索ワード" in boolean mode) にならないといけないと思います。 上記の書き方で初めて table1→全文検索（高速） table2→全文検索（高速） table3→全文検索（高速） table4→全文検索（高速） となるのでは？ 「それじゃsennaが4回も呼ばれるじゃないか」と思われるかもしれませんが、3回全表走査するよりは、よっぽど高速でしょう。 （各テーブルの件数にもよると思いますが） インラインビューを使えばsenna1回で書けますけど、せっかくの全文検索の意味がなくなる（却って劇遅になります）し、そもそも、インラインビューでsennaを使うと多分構文エラーになると思います。
aliasは，あるSQL文において定義され，そのSQL文の実行中に限って一時的に使用できる別名です。 synonymは，create synonym文によって定義され，他のオブジェクトからも永続的に使用できる別名オブジェクトです。 シノニムも エイリアスも「別名」ですか？　と問われれば，はいそうです，と答えますけれど， シノニムと エイリアスは同じ意味？　と問われたなら，いいえ違います，と答えます。
アクセスで空白がグループ化されない http://oshiete.goo.ne.jp/qa/7600416.html という場合もありますので、抽出条件には NZ([フィールド名],"") = "" NZ([フィールド名],"") <> "" で分けた方が良いかと。
Oracleのバージョンが書いていないのですが、10g以降であればmodel句を使って、こんな感じでどうでしょうか。 SDATE、EDATEのデータ型が不明なのでDate型と言う前提です。 --この部分はテーブルを作るのが面倒なので疑似データを用意しているだけです with tableA as ( select 1 KEY1, 1 KEY2, 1 KEY3, date '2012-07-12' SDATE, date '2012-09-11' EDATE from DUAL union all select 2 KEY1, 2 KEY2, 2 KEY3, date '2012-06-01' SDATE, date '2012-07-31' EDATE from DUAL ) --実際のSQLはここから select key1,key2,key3,to_char(dt, 'yyyy/mm/dd') dt from tableA model partition by (KEY1,KEY2,KEY3) dimension by (0 as IND) measures(trunc(SDATE, 'mm') as DT, months_between(trunc(EDATE,'mm'), trunc(SDATE,'mm')) as TERM) rules(DT[for IND from 0 to TERM[0] increment 1] = add_months(DT[0], cv(IND)));
こういうことですか。 Table1 ユーザーID,商品ID,数量 001,ABC,3 001,XYZ,2 002,FFF,4 だとして、種テーブルを一個作ります テーブル名：Tno Rno 1 2 3 4 ・ 数量の最大値を超えるまで連番で。 クエリのデザインビューに上記のTable1とTnoを加えます 結合線は引きません。 フィールド：ユーザーID｜あれ:1|　　数量｜Rno テーブル：　　　Table1｜　　　｜Table1 ｜Tno 表示：　　　　　　レ　｜　レ　｜　レ　 ｜レ 抽出条件： 　　　　　 ｜　　　｜　　　 ｜<=Table1.数量 これで確認してOKなら、数量とRnoの表示のチェックは不要です。 かな？
>InnoDB: Error: auto-extending data file \xampp\mysql\data\ibdata1 is of a different size 設定ファイルの編集でも行ったのでしょうか？ エラーメッセージで検索すると、下記のページとか見つかります。 http://www.ilovex.co.jp/blog/system/projectandsy … innodb_data_file_pathの設定はどうなっているのでしょう？ あとは…xamppがインストールされているパーティションの容量は十分にあるでしょうか？ innodb_data_file_pathで設定しているサイズよりパーティションの空き容量が小さい…ということはないですか？
Values の中に Select は書けません。 下記のように書いたらよいはずです。 INSERT INTO TableA SELECT COUNT(*), 'データ' FROM TableA 参考URL：http://office.microsoft.com/ja-jp/access-help/HP …
FULLTEXTでテーブルを構築しておけば、INSERTやUPDATEしたとしても自動でインデックスを作ってくれるはずです。 URL先の説明は検索の最小文字数を変更したので、REPAIR TABLE をしたというわけです。 なので、REPAIR TABLE を実行するのはこの1回だけです。 その後のインデックス作成はMySQLがやってくれます。
親テーブルitemのitemnoに適切なインデックスを設定するのが先
テーブル名を、T1 として 品番　数量　場所 A　　　100　　上 B　　　 50　　上 B　　　 30　　下 ならクエリをSQLビューで表わすと SELECT 品番, (SELECT Sum(数量) FROM T1 AS Tx WHERE T1.品番= Tx.品番) AS 数量2,場所 FROM T1 ORDER BY 品番; で 品番　数量　場所 A　　　100　　上 B　　　 80　　上 B　　　 80　　下 になりますので、レポートで品番と数量2の重複レコード非表示にすれば 品番　数量　場所 A　　　100　　上 B　　　 80　　上 　　　　　　　下 の様にはなります。 （レイアウトが崩れていたらメモ帳などで等幅フォントで見てください） 添付図のように品番と数量を上下センターに収めたい時は・・・ http://www.accessclub.jp/bbs/0231/beginers72024. … のhatena さんのレスをご参考に。 中途半端な回答で御免。
Accessの場合も、Accessというソフトとデータが入ったファイルの2つが必要ですよね。 サーバにインストールされているデータベースソフト（Accessのようなもの）上で、データファイルが1個持てますという意味です。 PHP自体にはデータベース機能はありませんので、PHPからデータベースソフトに接続して、データベース内のデータを検索したり、あたらなデータを登録したりして使用します。
>>簡単にでもどういうふうに書けるか例を示していただけるとありがたいのですが。。。 んー。 じゃあこのあたりで。。。？ http://www.dbonline.jp/mysql/view/ http://dev.mysql.com/doc/refman/5.1/ja/create-vi … 作成したビューの中で、unionですべてくっつけておいてやれば、 そのビューに対してselectかけるだけで、全テーブルに対してselectを行ったことと一緒。に出来るようになりますね。 あんまりにもややこしいビューを作ろうとすると制約に引っかかったりとかしますが、今回のような内容ならば問題ないでしょう。
つまり、更新日時カラムではnullが一番大きいとみなすということなので、下記の順番でソートすればよいかと思います。 ORDER BY modified IS NULL DESC, modified DESC, created_at DESC 蛇足ですが、設計的にはトリッキーなSQLを書かないで済むようにやはり登録時には更新日時カラムにも登録日時カラムと同じ値を入れておくのが王道だと思います。
「VARCHAR」を「VARCHAR(必要最大文字数)」とします。
#1 です。 こちらこそ、補足に気が付きませんでした。 ＞１）ORACLE_SID は、XE に設定しております。 ＞２）DBサーバはローカルです。 うーん、私の予想は外れでしたね。 だとすると、ちょっとわかりかねます。 お役に立てず申し訳ありません。 後は、TWO_TASK環境変数に無効なTNS接続子が書かれているとか。。
＞通常、これを開いたときにODBC接続用のダイアログ画面が表示されると思うのですが、 これが接続認証用（パスワードを入力等）の画面でしたら、テーブルリンクの作成画面にある「パスワードの保存(V)」にチェックを入れてリンクを作ってください。
＞・Insert時、自動的に日時データを取得する ＞・Update時、日時データを自動更新しない datetime型にしてINSERT時にはNOW()を投入してやればよいのでは？ 基本的にタイムスタンプは更新日時をいれておくための フィールドですので、データが更新されるときに合わせて更新されるのが普通です。
(2)は以下の理由より、求めているものを抽出するSQLではないでしょうね。 ・外側のSQLで ryorihyo, meisaihyoを等結合していない。 ・IN句でサブクエリをしている。 INの中でmeisaihyoテーブルが利用されてデータが抽出されており、その 条件にマッチしたryoricodeテーブルのレコードを抽出するでしょうが、 そもそも等結合して抽出しているわけではないです。 あっさり言ってしまうと、『抽出条件は正しいかもしれないけど、結合条件に 誤りがある』ということです。 select * from ryoricode, meisaihyo これだけ試してみれば分かりいいですね。 テーブルを複数使ってるくせに正しく結合してないから、クロス結合になって 大量にレコードを抽出します。 http://www.confrage.com/oracle/oracle_sql/join/c …
MySQL 5.5.25がインストールされてました。 # いくらか前に試しに入れた模様。 >接続先がポート0番でいいのでしょうか？ 0でもよろしくやってくる…ようですな。 const char *sever ="localhost"; const char *user = "root"; const char *password = "********"; const char *database = "mysql"; unsigned int portnumber = 0; unsigned int num_fields; con = mysql_real_connect(mysql, sever, user, password, database, portnumber, NULL, 0); if(NULL==con) { printf( "SQLのオープンに失敗しました．\n" ); exit(1); } mysql_query( mysql, "select host,password from user"); result = mysql_store_result( mysql ); if(NULL != result) { num_fields = mysql_num_fields( result ); printf("fieldの数は%dです。",num_fields); } else { int ErrorNo = 0; char *error = NULL; ErrorNo = mysql_errno(mysql); error = (char*)mysql_error(mysql); printf("errno = %u, error = %s\n", errno, error); } で、一応の出力はありました。 mysql_query()が未実行だとmysql_store_result()の戻り値はNULL、ErrorNoは0、errorは空文字になっていました。 # errnoという名前は、標準Cライブラリとカブるので変更。 # VC++2010EEではコンパイルエラーになりましたし…。 mysql_query()で第2引数が空文字だとmysql_store_result()の戻り値はNULL、ErrorNoは0、errorは"Query was empty"でした。 # mysql_query( mysql, ""); の時。 http://dev.mysql.com/doc//refman/5.1/ja/mysql-st … >mysql_store_result()は結果セットが失敗した場合、ゼロポインターも戻します。mysql_error()が空でないストリングをを戻すか、mysql_errno()がゼロ以外を戻すか、mysql_field_count()がゼロを戻すかをチェックすることによって、エラーが起こったか否かをチェックすることができます。 とのコト。 クエリー発行していないのに結果を受け取ろうとする。 という、現状のコードが誤っているのかと。 >mysql.exe の 0x5b8a8f04 でハンドルされていない例外が発生しました: 0xC0000005: 場所 0x00000048 を読み込み中にアクセス違反が発生しました はNULLポインタアクセスによるものでしょう。 >試しにmysql.exeを直接起動してみるとやはり、エラーの画面が出ます。 こっちは原因不明ですが。 # どう起動したのか、どんなコマンド投入したのか、表示されたエラーがなんだったのか…とか不明ですし。
SQLで select host, db, user from mysql.db; を実行すればとりあえず、IPアドレス、DB、ユーザ名の関係は分かると思います。 SELECT,INSERT,UPDATE,DELETEなどの個々の権限はそれに関するフィールドを確認する必要があります。 後、テーブル単位に権限付与している場合はmysql.tables_priv表を見る必要があるかと。
1> App.config の connectionString にサーバのDBを指定する 2> ～.exe.config の connectionString にサーバのDBを指定する
もう10日以上前なのでご覧になっていないかも、ですが。 .exeと言う事はDBサーバーはWindowsですね。 SQL Serverでは標準で使える機能ではありますが（推奨はされていませんが）、PostgreSQLのトリガーで使用するPL/pgSQLでは面倒な手順が必要です。 （商用のORACLEの場合も同様） まず、使うのはPL/pgSQL以外に、この場合、C言語も必要です。 C言語関数 http://www.postgresql.jp/document/8.3/html/xfunc … 但し、ご自分で検索されるとわかると思いますが、ほぼ全てのサンプルはUnix/Linuxです。 （と言うかWindowsの例は探せませんでした） DBを操作するアプリケーションを作成されているのであれば、そちらで行った方がよいと思います。 私自身は、PostgreSQLではありませんが、以前、ORACLEで外部コマンドを実行する処理を作った事があります。 （方法は上記リンクと似たような感じで、やはりC言語でライブラリをコンパイルする必要があります） Cに関しては初心者ではありませんが、正直、サンプルレベル以上の、仕事で使えるレベルにするにはかなりハマるな、と思いました。 Windowsだと権限周りも面倒そうなので、更にハマる事、必至だと思います。 （何より事例が少ない） それと、もし 「DBサーバーはUnix/Linuxだが実行したいexeはリモートのWindows上」 と言う事でしたら、もはやトリガ内で何かする、と言うのはあり得ません。 （私が上司なら即座に却下します）
'Using temporary'とUsing filesort'が使われているので、実表に対して大規模なソート（おそらくdt）処理が走っていることが確認できますね。これはview内でdistinctを使用しているせいだと思いますが、distinctをview内に定義せず、検索クエリー側で指定する訳にはいきませんか？
開始日と終了日は必ず同一日でよろしいですか。 表示先はクエリでよろしいですか。 各々のクエリのデザインビューで下記のように設定してください。 日別の集計 フィールド______ 日付: DateValue([開始日時])________検査内容_____________件数: 検査内容 集計______________ グループ化_________________________________グループ化___________カウント_________ 並べ替え________ 昇順________________________________________________________________________________________ 表示_________________ レ_____________________________________________ レ_______________________ レ______________ 月別の集計 フィールド______ 月: Month([開始日時]) __________________検査内容_____________件数: 検査内容 集計______________ グループ化_________________________________グループ化___________カウント_________ 並べ替え________ 昇順________________________________________________________________________________________ 表示_________________ レ_____________________________________________ レ_______________________ レ______________ SQLでは、 日別 SELECT DateValue([開始日時]) As 日付, 検査内容, Count(検査内容) As 件数 FROM テーブル名 GROUP BY DateValue([開始日時]), 検査内容 ORDER BY DateValue([開始日時]); 月別 SELECT Format([開始日時],"yyyy/mm") As 月, 検査内容, Count(検査内容) As 件数 FROM テーブル名 GROUP BY Format([開始日時],"yyyy/mm"), 検査内容 ORDER BY Format([開始日時],"yyyy/mm");
こう? SELECT t1.name AS site_name, t2.* FROM stock_sites AS t1 LEFT JOIN stocks AS t2 ON t1.id = t2.stock_site_id and t2.item_id = 1 ORDER BY t1.id;
> SELECT tableA.a * (select 1 from tableB) > tableA.b * (select 2 from tableB) > FROM > tableA このようなSQLは文法エラーで通りません。
オリジナル文字列が abc___________ とａｂｃ＿＿＿＿＿ だった時にインポートした時点で末尾の半角スペースは削除されます。 半角文字フィールド｜全角文字フィールド abc　　　　　　　 ｜ａｂｃ＿＿＿＿＿ なので 半角全角のフィールドを結合したいのなら クエリなどで 結合:[半角文字フィールド] & space(14-len([半角文字フィールド])) & [全角文字フィールド] にして行うとか。
＃１です。 うーん、不思議ですね。主キーはなんでしょう？ 検証できる環境が手元にないのですが、やはり＃１の最後に書いたように 　MINUS前後を別SQLにして、キー項目だけで考えてみては？ SUMをしないでT1.COL5を素直にSELECTさせてみるのが良いと思います。 実は何か別テーブルと結合してるとか？
データが大量になってくるとデータベースを使うのが便利だと思います 1) No.1で書かれている無料で手に入るOpenOffice(あるいはLibreOffice) 2) 質問者さんが書かれているMS Access 3) それとFileMaker が個人で使われている有名どころです。 曲がりなりにもデータベースですのでそれなりの敷居の高さがあります。 上に書いたものほど敷居は高いように感じます。 私自身は全部使ってみましたが、 a) データ量が多くなりExcelでは対応できなくなった b) データをいろいろな形式で加工し出力したい。 という時には威力を発揮します。 それぞれ試用版がありますので試されてはいかがでしょうか。 http://www.microsoft.com/ja-jp/office/2010/trial … http://www.filemaker.co.jp/products/filemaker.html Excelでやれている間はExcelでやるのも一つの選択かと思います。
ごめんなさい元のSQLをコピっちゃいました こちらで select id from tb where tag IN(1002,1004) group by id having count(distinct tag)=2
ANo.1です。 説明の内容に誤解をまねく内容がありましたので訂正します。 >質問に書かれた【Ａテーブル】の中身のように、 というのはちょっと違っていて、 start with 品目番号 = 'B' となっているので、 【Ａテーブル】 品目番号,親品目番号 B,A B,C の２レコードを拾ってきてそれぞれについて正展開しています。 だから、 start with 親品目番号 = 'B' としたら、 B1,B の１個しか拾ってこないから目的が達成できたと思うけど・・・ （未確認。ひょっとしたらエラーになるかもしれません。 　申し訳ないですが今手持ちの試せる環境がないので。）
こんにちわ > SQLPLUS system/???@???でつながります。 > 別のクライアント機からは > EXP system/???@??? FILE= full120725.dmp LOG= exp_full120725.log FULL=y そうすると、SQL*Plus とexp で異なるtnsnames.ora を参照している可能性位しか 考えにくいですね。 sqlplus とexp は同じDos Prompt から実行しても、今までと同じ結果になるでしょうか？ Oracle Client は、TNS_ADMIN 環境変数 (Windows の場合はレジストリも) で参照する tnsnames.ora の指定できるようになっていますので、その辺を画くインした方が 良いかも知れません。 環境変数はマイコンピュータから、レジストリはHKEY_LOCAL_MACHINE\SOFTWARE\ORACLE の下から 探してみて下さい。
ＤＢのテーブル定義書を書いた人がどんなルールで書いているのかわかりませんから 断言はしませんが（本筋はどういうルールで書いたかを書いた人に聞くべきと思う） >・・・（略）・・・ >１　１ >が更に存在できないということですか？ 一般的には質問に書かれているようなことを意味しているでしょう。 他のこととしては、P1とP2の違いについて書くと where ＸＸＸＸＸＸＸ Between 1 and 3 等、ＸＸＸＸＸＸＸを使った検索はＹＹＹＹＹＹＹを含んでいても含んでいなくても、 プライマリキーを利用した検索になりますが ＸＸＸＸＸＸＸを使わず、ＹＹＹＹＹＹＹを使った検索では、プライマリキーを利用しない検索になる という意味も読み取ることができます。
ショッピングサイトに行かなくてもあなたのパソコンの中にデータはありますけど？
>この方法も思いついて、DBの設定を変えて試したのですがダメでした。 たぶんやり方が間違えているので、以下参考に create table main (id int not null primary key,paidy int not null default 0); insert into main values(1,1),(2,1),(3,1); create table sub (id int not null primary key,totaly int,main_id int); insert into sub values(1,10,1),(2,20,1),(3,50,3); ※比較のため仮にmainテーブルのpaidyの値を1にしておく update main SET paidy = (select sum(totaly) from sub where main_id=1) where id=1; とすると、mainのid=1のpaidyは30になる update main SET paidy = (select sum(totaly) from sub where main_id=2) where id=2; すると、sum(totaly)はnullだが、paidyは0になる
>削除できません できない状況がわかりませんね。 エラーがでるならそれを書いてください。 普通はできます
ごめんなさい、書き方がわるかった where句につなげる場合は、ifはいらない たとえば3か4で始まってeを含むレコードはこう SELECT * FROM hoge WHERE val REGEXP'^[3３4４].*[eｅ]'; あとは諸条件をandでつなげばよい
PBXTですが、 https://launchpad.net/pbxt のページの右上からダウンロードできますよ。 ソースコードなので、コンパイルするのに MySQL 5.1 のソースコードが必要ですけど。
そのままうまくいくこともあるようですが、内部はかなり変わっているので、データをダンプして入れ直すことで検討されたほうが安全と思います。文字コードのパラメタなど変わっているのもあるので注意が必要です。 SQL文等は5.0の時に使っていたものを、ほぼそのまま使えます。
ファイルに書き出されたSQL文がすべてです。 つまりデータベースを削除する必要はありません（全テーブルをdropしてcreate tableで再作成します）。 >逆にdatやdumpファイルとしてバックアップしているもの 何を使って作成された「datやdump」でしょうか？
私はMacintosh環境については詳しくないので勘違いがあるかもしれませんのでご注意ください。 JDBC の URL のエンコーディングは、 cp932 ではなく MS932 か、 Windows-31J （Windows 日本語（Microsoft社のShift_JIS））を指定します。 （CP932 は IBM OS/2 日本語（IBM社のShift_JIS）の様です。CP932をもとに MS932 へと拡張された（NEC拡張文字の追加）のではと思います。） また、Java は Macintosh 日本語（Apple社のShift_JIS（X-MAC-JAPANESE））をサポートしていないようです。 ※誤った指定でもそれなりにうまく動作したのは、Windows 日本語環境ではデフォルトがMS932なので、CP932の指定が無視されたのではないかと思います。 http://docs.oracle.com/javase/7/docs/technotes/g … http://java.sun.com/javase/ja/6/docs/ja/technote … また、MySQLがサポートするCP932は、Windows-31JですのでApple社のShift_JISはサポートされていない様です。 http://dev.mysql.com/doc/refman/5.1/ja/charset-a … http://dev.mysql.com/doc/refman/5.1/ja/charset-c … 以上のことからMySQL Migration Toolkitを使用すると文字化けが発生したと考えられます。 よってSQL Server のデータを文字化けを回避できる他のツールで取得して、MySQLの側も文字コードの自動変換を回避するようにするとかになるかと思います。 [mysqld] character-set-server=cp932 skip-character-set-client-handshake なお、Apple社のShift_JISについてはこちらに http://ja.wikipedia.org/wiki/MacJapanese もあるように、Apple社らしい独創性（非互換性）を感じます。Microsoft社とは対照的ですね。
実運用に使わないならSQL Server 2008 R2 Developerを検討してみてください。 最大 CPU 数 : 256 論理プロセッサまで 最大メモリ : OS がサポートする最大容量まで 最大 DB 容量 : 無制限 ライセンスで許容される仮想化環境数 : 無制限 (ライセンスはユーザーごとに許諾されます) http://www.amazon.co.jp/SQL-Server-2008-Develope …
＞調べている内、「現在のDB設計やリレーションが本当に適切なのか(そもそもリレーション設定とは、DB構築時に行なうべきものか、SQLを走らせる度に構築するものか、など)」 　ＥＲ図の逆生成にかんしては、Ｎｏ．５　６で答えておられるとおり。 　ただ、この引用部分が目的なら、システムの要件をもう一度洗い直す必要があります。（要件そのものが、現在あるシステムが作られた時と変わっている可能性もありますけどね。） 　ちゃんと要件が精査され、ちゃんと設計が行われていれば、テーブル（エンティティー）間の関係は、設計中に全部現れているはずなんです。外部キー制約に表現できるリレーションのみならず、外部キーに表現できないリレーションも含めてです。 　さて、現在のＤＢ設計が正当かを評価しようと思ったら、当然ですが、あなた自身が、正しいと思うＥＲ図を要件から起こしておく必要があります。でないと、現状のＤＢが正しいかどうか判断できないですよね。（まぁ、自分で作ったＥＲ図が正しいかどうかという問題もありますが、これを言い出すと、「私は現在のシステムを評価する資格があるのか？」と問い出すことになりますので、横に置きます。） 　これが前提であれば、エンティティーや属性の意味（これは、あくまで実体の業務の上での意味です。）は、理解できているはずですから、現在のＤＢがあれば、基本的なＥＲ図は起こせます。 　でも、外部制約に現れないリレーションがどう表現されたかまでは見えません。このような関係を含め、このＤＢが正しく扱われているかは、ＳＱＬ・アプリケーション側の責任ですから、こればかりはアプリケーションを見ないと何ともならないです。
こんなことすると出来るっぽいですよ。 select id, name, array_to_string (array(select b.goal from tbl b where b.id = a.id order by b.goal), '、') as strAgg from tbl a group by a.id http://www.geocities.jp/oraclesqlpuzzle/postgres …
No.4 です。 そうでしたか、失礼しました。 直接の回答ではないのですが、mysqld以外の再起動の状況について見てみてはいかがでしょうか。httpdやメール関係のデーモンが、日曜日の4:02に再起動とか起きているか。 誰が誰に対して終了シグナルを飛ばしているのかを切り分けるのに参考になると思います。 ＃4:02という合致からも、ほぼ確実にその時刻のcronがトリガとなっているので、しらみつぶしに試してみるとか。もちろんコメントアウトして一週間待つ必要はなくて、そこで指定されているコマンド等を、ひとつひとつ、手動で起動、または（実行権限の問題が関係しそうなら）数分後に起動するcronに設定してみるなど。どれかの行がMySQLを落としてくれてると思います。。 解決するといいですね。
一番の違いは結合は二つのテーブルのデータ双方を抽出結果に含められるのに対し、相関副問い合わせによるクエリでは一方のテーブルからしかデータを抽出できないことです。 後、評価順序としては外部結合の場合、外部結合がされたのちにWHERE条件の判定が行われます。 相関副問い合わせを用いる場合は多くのRDBMSでは駆動表に対する他のWHERE条件の判定を行った後に副問い合わせの判定を行う傾向がありますが、ORACLEで「PUSH_SUBQ」ヒントを使用したりすると副問い合わせを優先的に判定条件に使用したりできます。 後、「結合は最初に結合された一時的なテーブルを絞りこむ」イメージではなく、可能な限り結合された行を連続的に判定していきます。ソートや集約演算など一時テーブルを作らざるを得ない限りはできるだけ避けている実装が大半だと思います。
drop database データベース名; してから コマンドラインからmysql -u root -pパスワード < ダンプファイル名
ホストを指定したからソケット接続になり、おそらくユーザ名が違うので ident認証で失敗しているのですよね？ http://www.postgresql.jp/document/9.1/html/auth- … ホストを指定せずにローカル接続で接続すれば良いのでは？ 例) psql -U postgres -f xxxxxx.dump xxxxxx
変わります と言うより同じデータしかないデータベースでは性能測定はできません。 実データに近いデータ分布・データ内容で試験をすることが鉄則です（実データを使えればなおよし）
サーバ上にmdbファイルを置いて クライアント上のAccessからネットワーク経由で共有されたサーバ上のmdbファイルを開く というaccessで時々やっているのを見かける方法をイメージして考えていませんか？ SQL Serverは普通、こんなことはしません。（理由は後述） 1.サーバ機上で、SQL Serverを常時動かしておきます。 (当然、データファイルもこのSQL Serverからアクセスします) 2.クライアントとサーバの通信は、TCP/IPを利用します。 （後述のODBCやADOがTCP/IPの通信をします。） 3.クライアントからは、ODBCやADOその他の方法で、SQL言語を使って、SQL Serverとアクセスします。 4.ODBCやADOは、AccessやEXCEL、ExcelのVBAやVB.2008、C#その他の開発ソフトから利用できます。 ということで、 >・それぞれの端末からサーバーが共有できるが、端末同士で互いに繋がることは出来ない。 それぞれの端末からサーバーが共有できる必要はありません。 ただし、SQL Serverと接続するためのポートがウイルス対策ソフトなどでブロックされていないこと が必要です。 >このような場合、まずはSQLserverをサーバーにインストールするのでしょうか？ まず、サーバ上にSQL Serverをインストールします。 >そもそもNTFSにインストールって…？ NTFSだろうが他のファイルシステムだろうが、ファイル共有するわけではないので関係ないです。 >それとも端末のSQLserver2008があれば、データ保存先でサーバーを選択して、 >他のPCから同じデータを操作できるものなのでしょうか？ 端末のSQLserver2008で、データファイルをネットワークドライブ（サーバー）上のファイルを 指定できなくはないと思いますが、ネットワーク経由にすると異常に遅いのと、 利用前に、SQLServerを起動して、利用後にSQLServerを停止しないとダメで、 停止していないと排他がかかって他の端末から利用できない。 ということ、使用前使用後で数分ずつかかり、なおかつ処理が遅いという、使い物にならない結果が 待っています。。。こんなことはしないことをお薦めします。 ## という説明でイメージくらいはつかんでいただけたかと。。。
■コメント ★「コメント構文」と、「COMMENT オプション」の違い 「コメント構文」は、SQL文を書く上でのコメントの書き方。 処理の結果に対する影響はありません。 「COMMENT オプション」は、テーブルの情報の一つ。 処理の結果、テーブルの情報として書き込まれるため、 SHOW CREATE TABLE と SHOW FULL COLUMNS ステートメントによっていつでも表示できます。 例 create table table1 /* 日付と文字列各１個の定義をします */ (col1 date COMMENT '日付です', col2 VARCHAR(10) COMMENT '文字列です' ) SHOW CREATE TABLE と SHOW FULL COLUMNSをすると、 COMMENT の定義は出てくるけど、/*　・・・　*/の内容はでてこない。 ## 今手元にMySQLの環境がないので未検証です。 ■論理名 >・論理名は、内容を分かりやすくするために付ける日本語表記、と思っているのですが、 >そういう認識で合っているでしょうか？ いいと思います。 他には、すべて論理名で仕様を作成して実装直前で物理名と紐付けするような開発方法をすると ちょっと違うイメージになるかも。 （内容を分かりやすくするためではテーブル上の項目に同一論理名を複数つけても問題ないが、 　論理名で仕様を作成するなら、テーブル上の項目に同一論理名を複数つけてはいけない！） >・論理名は、どこに付けるのでしょうか？ >テーブル定義書などの設計書にだけ表記するのでしょうか？　 >それとも、SQLの中で「論理名」を付ける場所は決まっているのでしょうか？ 設計書だけでもＯＫ。 既述のコメントオプションやコメント構文のいづれの方法で各コメントに記載してもＯＫ。 開発のルールしだい。 >・MySQLのコメント内に、「論理名」を記述しても良いのでしょうか？ かまいませんし、一般にはコメントに論理名を記述することは少なくないです。 （手間がかかるので一切省くという場合もありますけど。） >・「論理名」を付与する場合、一般的に、どこに記述するのか？ >SQLの中でも記述するのか？ について、教えてください 仕様書だけの場合もあれば、SQLのコメントまでの場合もあれば、 テーブルのCommentオプションまで書く場合もあります。 私の場合は、仕様書だけのことが多いかな。 （内部設計書を見ると、SQLや関数はすべて知っている前提で 　何も考えなくてもSQLを含む、各言語のプログラムソースが書けるレベルにしているので・・・ 　というか、プログラムソースの一部分を見て、内部設計書のどこの部分かわからないソースには 　していないからというべきか。 　・・・項目名のつけ方が、tblACol1,tblAcol2,・・・ 　　 とかと決まっていたならコメントつけたほうがいいかも）
databaseソフトのつくりによると思うのではっきり断言する気はないが、 WHERE ～ ff = 'xxx' と書くとインデックスを使った検索になるが、 WHERE ～ ff IN('xxx') と書くとインデックスを使わないかも。 別にインデックスを使わないと極端に遅くなるのでない限り問題じゃないと思うけど。 （inの中が２個以上でも検索しようと考えていると思うので、 　インデックスは使わなくても大丈夫と考えていると思うけど。） 多分、inの中を可変にしたいのだが、１個になる場合は大丈夫か心配という質問と思うので、 そういう意味では問題ないと思います。 ## ところで、inの中が０個にはならないつくりにしているかな？ ## ・・・プログラム作るときにうっかりはまるパターンなので。（余計なおせっかいと自分でも思う）
https://www.google.co.jp/search?q=mysql%2Cgoogle …
ソートアルゴリズムを勉強すれば分かりますが、ほとんどのソートアルゴリズムはキーで指定された以外のデータ順については保障がありません。（安定的なソートではない）。 また、RDBMSが仮に安定的なソートアルゴリズムであっても、どのような順序にデータをフェッチするかはRDBMSの実装に依存しています。 > この、順番は何で決まっているのでしょうか？ きまりはないと思ってください。
OpenJDKでインストールしようとすると文字化けを起こすことがあります。 OracleのJDKをいれてみてはどうでしょう。
ALLの意味はインデックスをつけないといけないということではなくて、オプティマイザがフルテーブルスキャンをしたほうが効率的と判断したということですね。 例えインデックスがあってもフルテーブルスキャンをしたほうが効率的と判断されれば使われません。 また、possible_keysは今回の条件で使えるインデックスがなかったよ、という意味です。（WHERE句で指定していて、レコードの大部分が絞りこめるような列にインデックスを貼って試してみましたか？） それと、Extraにfilesortが出ていますが、検索よりもソートの負荷の方が高いかもですよ。ケースによってはORDERBYを外してプログラムで処理した方が速いケースもあります。 （今回の場合は件数が少ないので大した違いはないでしょうが。） しかし、データが最大で数百件程度ならな、それほどムキになって現在の実行時間を短縮する意味もないような気がします。 （現在の時間が半分になったとしても体感ではわからないレベルでしょう）
　A5:SQL Mk-2作者です。 　お使いの環境でレンタルサーバーのMySQLに接続することは可能と思います。 　この場合、SSHポートフォワーディングはSSHトンネルとそれほど区別して考える必要はないかと思います。どちらかというと、SSHポートフォワーディングは技術・手法全体をさし、SSHトンネルはそれで作成された暗号化された通信経路のことを指す気がします。 　SSHポートフォワーディングできるツールがあれば、基本的に http://www.wind.sannet.ne.jp/m_matsu/developer/a … の方法を使って、接続することができるはずです。もちろん、Poderosaも、PortForwarding.exeを用いてSSHポートフォワーディングできます（SSHトンネルを作成できます）。 　ちなみに、A5:SQL Mk-2の次期バージョンでは、単体で（CygwinやPoderosaを使わず）SSHトンネルを作成し、より簡単にSSHトンネル経由の接続ができるようになります。ベータ版で実装していますので、こちらもお試しいただけるとありがたいです。 http://www.wind.sannet.ne.jp/m_matsu/developer/a … SSHトンネル経由でMySQLに接続するのに必要な情報（Version 2.8.0 beta 13） 「データベースの内容を登録 -MySQL (直接接続)」ダイアログ 　「基本」タブ 　　ホスト名：localhost -- 接続先ホスト（レンタルサーバー）と、DBサーバーが同一の場合は、 　　　　　　　　　　　　　　　　　localhostを指定してください。 　　　　　　　　　　　　　　　　　異なる場合は、接続先ホスト（レンタルサーバー）から見た、 　　　　　　　　　　　　　　　　　DBサーバーのホスト名またはIPアドレスを指定してください。 　　ポート番号：3306 -- デフォルトなら、3306ですが、異なる場合は変更してください。 　　ユーザーID：（ご自身のユーザーID） 　　パスワード：（ご自身のパスワード） 　「SSH2トンネル」タブ 　　SSH2ホスト名：レンタルサーバーのホスト名またはIPアドレス　　 　　ポート番号：22 -- 異なる場合は変更してください 　　パスワード認証・鍵ファイル認証…その他の項目：認証に必要な情報を入力してください 　　　（もし鍵ファイル認証がなんのことかわからない場合は、おそらくパスワード認証です） 参考URL：http://www.wind.sannet.ne.jp/m_matsu/developer/a …
まず、現時点のDBをバックアップしてください。 バックアップをきちんとしてあるなら、その時点までは復旧できます。 復旧してDROPしたテーブルデータをbcpツールなどでエクスポートし、現時点のDBに再度切り替えてエクスポートしたデータをインポートするぐらいでしょうか。
当方自慢のソフト　データ復旧モグラで使えば、完全にデータ取れると思います。 無料バージョンでスキャンできますよ。 http://www.p-mon.jp/データ復旧ソフト/
もう解決されているかと思いますが 日付: "" & [Forms]![F_登録]![日付] & "" ↓ 日付: "#" & [Forms]![F_登録]![日付] & "#" かもしれない。 Excelのピボットテーブルは使ったことないので。。。
IDが変わったらまずいでしょ 削除したら抜け番にするのが妥当
DBの利用をお勧めするポイントは大きく３つ (1)検索性・・・速い、単純 CSVデータからの抽出は基本的に毎回全データを読むのでオーバーヘッドが大きい データが膨大または検索条件が複雑な場合、DBを使う方が圧倒的にはやい さらに単にデータを抜き出すのではなく集計をする場合など雲泥の差 条件適合もSQLは単純かつ明確だが、プログラムでやるには限界がある (2)堅牢性・・・正しい、壊れにくい CSVファイルでのデータ管理はデータの整合性がとりづらい またCSVファイルはロックをしても読み書きのタイミングによって破損がつきもの とくにデータを読みながら更新する場合などCSVは使えない (3)メンテナンス・・・楽 DBはデータ更新が楽 データにさまざまな制約をかけたりできる デメリットももちろん多いですね なにしろ覚えるまでがめんどくさい、システム構築がめんどくさい 導入しても適切な設定をしらないと期待ほど速くならない（つまりさらに勉強が必要） DBのサービスを受けるのにISPの制限がある、少しくらいならCSVの方が軽い、 インジェクションなど落とし穴もおおい それらのデメリットを全てクリアしてでもDB導入による効果は高いです
クエリ上での表示でいいのですよね。 「DJoin関数」でググると、ご希望の事ができる関数が見つかりますよ。
既に一度インポートしたのであればテーブルは出来てるんだから EnterpriseManagerでテーブル定義を変えて、レコード全部削除してから再度インポートするとか。 ＤＴＳ（データ変換サービス）では定義できませんでしたっけ？
更新量とメンテナンス時間がとれるかのバランスの問題になります。 週一回日曜などにしかメンテナンス時間が取れないのなら現状のままの運用でいくべきでしょう。 REINDEX中は該当のINDEXは使用できなくなります。 こちらを参考にしてください。 http://dqn.sakusakutto.jp/2011/11/postgresql-rei …
前提として常にDATE1<=DATE2であるという条件が必要です WHERE CURDATE() BETWEEN DATE1 AND DATE2 AND FLG=0
>これを使えば、エクセルのワークシートを、テーブルのように見立てて、そのままxlsファイルの中身を修正変更出来ます。 この機能はMS社が敗訴したために随分と昔に削除されました。 http://pxp.seesaa.net/article/8627654.html
できます。 簡単で申し訳ありません。
「JOIN `u1`」の部分を「(SELECT `uid` FROM `u1`) `u1`」という具合に「z2カラム」を除いた列を取得するSQLにすれば可能ですね。 SQLを書く代わりに「z2カラム」を除いた列を取得できるu1テーブルのビューを作っておいてもよいでしょう。
違っていたらすいませんが、アタッチする際に[データベースの詳細]でファイル名を確認してみてください。mdfファイルとldfファイルを同じ論理名（NAME）でアタッチしようとしているということはありませんか？ 例えば、mdfのNAMEがaaaaならばldfのNAMEはaaaa_logなどにしないといけません。
初めまして。 MongoDBのGUIツール作っています。 よかったら使ってみてください！ 　■MongoDB GUIツール 「JMongo」 　　http://d.hatena.ne.jp/moremagic/20120625/1340606 … →Java Swingで実装してあり、環境を選ばず起動できます。 　※Win、Linux　で起動することを確認してます。 ではでは。 参考URL：http://d.hatena.ne.jp/moremagic/20120625/1340606 …
>これは、plsqlの記述内に加えるのでしょうか 同じplsql内では同じユーザーですので、GRANT権限が無いのが普通ですので、GRAN権限の有るユーザーで接続してGRANTします。 ＞それとも一度これを実行（コンパイル！？）すれば良いのでしょうか。 DROP　TABLEしない限り、一回実行しておけば良いので、通常はCREATE　TABLE直後にGRANTを実行しておきます。
変換テーブルをつくっておいて処理するしかないですね もう少し突っ込んだところまでやりたいのだと 「シソーラス」と「全文検索」の組合せなど結構めんどくさい話になります。 http://ja.wikipedia.org/wiki/%E3%82%B7%E3%82%BD% …
「テキストのみペースト」はショートカットがcommand+option+vに割り当てられています。もしうまく行けば儲け物です。 さて、CiPTというソフトもあります。PlainClipは他のソフトでショートカットを登録しないといけませんが、こちらはその機能がすでにありますし、邪魔にならなければずっと起動しておくこともできます。 http://tama-san.com/?page_id=2 昔は、複数の操作を1つのショートカットに登録できるソフトがあったのですが、今はできるのでしょうか。 それができるのでしたら、command+option+vに、書式情報を取り除くのとペーストの2つを登録しておけば簡単なのですが。
こんにちは。 CREATE TABLE aliens_abduction ( last_name VARCHAR(30), first_name VARCHAR(30), when_it_happened VARCHAR(30), how_long VARCHAR(30), how_many VARCHAR(30), alien_description VARCHAR(100), what_they_did VARCHAR(100), fang_spotted VARCHAR(10), other VARCHAR(100), email VARCHAR(50) ); が正しいです。 エラーメッセージで１２行目付近のエラーとわかります。 email VARCHAR(50), カンマが余計です。 テキストと見比べてみてください。 >このテキストはMySQL5.5が出る前の2010年3月に出版されたものなのですが、それが原因でしょうか？ そこまで差は出ません。
もとの質問内容がたぶんSQLの特性を理解できないまま left joinの多重結合しているので、その流れに引っ張られたのだろうけど #2はオーバーヘッドが大きすぎるのでやめた方がいい
>B側では単にリストで見る程度でレコードを更新、追加、削除はしません >クエリで絞り込んで集計程度はします であれば、B側でロックは発生しませんので 『共有モード』で開いている場合には、 A側でのクエリ・テーブルなどでの更新・追加・削除は支障はありません。 B側で突然レコードが増えたり変更されたりDeletedになって B側の人が驚くくらいです。 ただ、実際には確実にデータが変更されるように、 排他でレコードをオープンしたり トランザクション処理を行う場合がありますから その場合には障害となります（A側でロックに失敗して出来ません）。 蛇足ですがB側でも変更などの可能性がある場合は、格段に難易度が上がります。 相当作りこまないと確実な運用ができません。 ネットワーク上での Access データベースの共有について (MDB) http://office.microsoft.com/ja-jp/access-help/HP … ネットワークでの使用 http://www.naboki.net/access/achell/achell-02.html
>空いた番号5～10を利用するのは適切でしょうか？ 削除した場合空けておくのが常套です。 もっといえば、データの削除はせずに削除フラグをたてて消したように 見せるという運用が普通です。 >※ID番号を隙間なく、埋めていきたい 上記を踏まえたうえでどうしても最後の番号の次のデータから埋めていきたい という希望があるならこうしてください ALTER table テーブル auto_increment=1
テーブルの前に接頭辞などをつければ、データベースは１つで大丈夫です。 ですが、複数のアプリを入れると、テーブルがやたらと多くなり見づらいと思いますので、 データベースが複数使える所がいいと思います。 レンタルサーバーによっては、複数設置可能な所も多くありますので、そちらを検討されればいいかと思います。 ご参考までにですが、私が使ってるレオサーバーは、データベースが複数設置できますので、WordPress、EC-CUBEなどをいくつもインストールしてみています。 参考URL：http://www.leosv.jp/
確かに「なぜ」なのかは不明ですが、情報が足りないのかも知れません。（SQLServer、Excelのバージョンやデータの中身等） 現状、質問から読み取れる内容でやってみた画像を添付しておきます。 ちなみに、SQLServer2008、Excel2003です。 画像中の「B列」が数値と文字データが混在する列です。当方では「'」がないデータはDoubleと認識しますが、「'」を付けたデータではVarCharと認識されました。
>後ろから4行分はデータが入りましたが残りは更新されません。 ゴメンなさい、意味がわからない 新規でつくったテーブルなのになんで更新がされるの？ すでにあるテーブルを更新する場合は replace createtable select id,a1,c3,b2,a3,a2,b1,c2,b3,c1 from tableA inner join tableB using(id) inner join tableC using(id); みたいに書いてみてください
そういうのは書き方があります。 //準備 create table hoge (id int,sub_key int,item_id int); insert into hoge values (1,1,3),(2,1,4),(3,1,5), (4,2,3),(5,2,4), (6,3,3),(7,3,3),(8,3,4),(9,3,4), (10,4,3),(11,4,4),(12,4,4),(13,4,5),(14,4,6); さてここで検証するとsub_key=1は合致するのでOK、同2は2個しかないのでNG、 同3は見た目上4個あるけどユニークなものが2個しかないのでNG、 同4はかぶってたり余計なデータがあるけど合致するのでOK //表示 select sub_key from hoge where item_id in (3,4,5) group by sub_key having count(distinct item_id)=3
こんにちわ。 Windows認証方式ということで、前提として、問題のWin7PCのWindowsログインユーザーがSQLServer2005 Express が稼働しているPCに適切な権限のグループ（Administrator等）に登録されているかどうかご確認されましたでしょうか？ 切り分けとして、一時的にデータベースの認証方式をSQLServer認証との混合方式にして接続が可能であれば、Windows認証の問題と言えるのではないでしょうか。 それでWindows認証の問題となった場合にWin7PCとSQLServer2005 Express が稼働しているPCとのユーーザー登録状況を記載されると問題の有無が判断できる情報になるかと思います。
参照URLに自習書があります。参考にしてみてください。 ディストリビュータとサブスクライバを同一サーバーで実行するのは 普通やりません。そういう設定ができるかどうかは知りませんが... この場合はパブリッシャとディストリビュータを同一サーバーで実行するのが普通です。 >また、Server1は更新用アプリが使用、Server２は参照用アプリが使用などといったことはできるのでしょうか？ これができなかったら、レプリケーションする意味がありません。当然できます。 参考URL：http://technet.microsoft.com/ja-jp/sqlserver/cc7 …
5桁に限定して良いならchar(5)、少しでも省略したいなら int(5) のunsigned zerofillをつかう
まずC2の型によってやりかたがことなります もしC2が文字列型であればこんな感じ select C1,group_concat(C2 separator '') AS C2 from テーブルB で、テーブルAとテーブルBをどうつなげたいのか書いていないので そこは自力でやってください
質問は ＞日付型で作成してなく、年齢の出し方も分かりません。 ということでよろしいでしょうか？ まず、下記の列を追加します。これは生年月日をまとめて西暦になおしたものです。 生年月日:Format([年号] & [生年] & "年" & [月] & "月" & [日] & "日", "yyyy/mm/dd") 次に、下記の列を追加します。 これは、「年齢計算に関する法律」によって誕生日の前日に満年齢に達することになっているためで、学校教育法の第22条の就学の基準では「子女の満六才に達した日の翌日以降における最初の学年の初から」となっているためです。もし、この年齢ではなく、当日に満年齢になる計算をお望みの場合は、「Date()」だけに修正すればよいです。（基準日がわからないので、動かした当日にしています） 基準日:DateAdd("d",+1,Date()) 最後に、下記の列を追加します。 年齢:IIf(Format(生年月日,"mm/dd")>Format(基準日,"mm/dd"), DateDiff("yyyy",生年月日,基準日)-1, DateDiff("yyyy",生年月日,基準日)) 上記で年齢の出し方は大体分かるかと思います。 あとは年齢をもとに条件にあう列を追加していくことになるか、上記の年齢計算自体を修正するかになると思います。
UPDATE テーブル SET 更新日時フィールド=now(),作成日時フィールド=now() じゃだめなの？
そもそも、「第3木曜日=第3週の木曜日」は必ず成立するのでしょうか。 仮に、日曜始まりで週を考えるとして、その月の初日が金曜あるいは土曜の場合、 その月の第1週はその土曜までになって、第1木曜日=第2週の木曜日となったりはしないでしょうか。 まあ、この考え方はあくまで私個人のものであって、 「第3木曜日=第3週の木曜日」が必ず成立する、と質問者さんが お考えでしたらよいのですけれど。
PHP myadminの　SQLの欄にトリガの原文を入力すれば対応できます。 入力後、 同じくSQLの欄にて　SHOW TRIGGERS で設定できたか確認してください。
下記のSQLを実行してみてください。 見やすいように半角スペース2つは全角スペース1つに変換してます。 使用される際は「全角スペース1つ」を「半角スペース2つ」に変換してください。 SET NOCOUNT ON DECLARE @LogicalFileName sysname, 　　　　@MaxMinutes INT, 　　　　@NewSize INT -- *** 検索条件により、次の 3 行を変更してください。 *** USE　　 データベース名　　　　　　　　　　　　-- ログを圧縮するデータベース名を指定してください。 SELECT　@LogicalFileName = 'ログファイル名',　-- 圧縮したいログファイルを確認指定してください。 　　　　　　　　　　　　　　　　　　　　　　　-- (ログファイルは sp_helpfile で確認可能です) 　　　　@MaxMinutes = 10,　　　　　　　　　　 -- ログファイル圧縮処理の実行時間を指定します。 　　　　@NewSize = 512　　　　　　　　　　　　-- 単位は MB です。 -- セットアップ/初期化 DECLARE @OriginalSize int SELECT @OriginalSize = size -- 8K ページ 　FROM sysfiles 　WHERE name = @LogicalFileName SELECT 'Original Size of' + db_name() + ' LOG is ' + 　　　　CONVERT(VARCHAR(30),@OriginalSize) + ' 8K pages or ' + 　　　　CONVERT(VARCHAR(30),(@OriginalSize*8/1024)) + 'MB' 　FROM sysfiles 　WHERE name = @LogicalFileName CREATE TABLE DummyTrans 　(DummyColumn char (8000) not null) -- ログをラップし、それを切り捨てます。 DECLARE @Counter　 INT, 　　　　@StartTime DATETIME, 　　　　@TruncLog　VARCHAR(255) SELECT　@StartTime = GETDATE(), 　　　　@TruncLog = 'BACKUP LOG ' + db_name() + ' WITH TRUNCATE_ONLY' -- 最初の圧縮を試みます。 DBCC SHRINKFILE (@LogicalFileName, @NewSize) EXEC (@TruncLog) -- 必要な場合に、ログをラップします。 WHILE　　 @MaxMinutes > DATEDIFF (mi, @StartTime, GETDATE()) -- 有効期間は切れていません 　　　AND @OriginalSize = (SELECT size FROM sysfiles WHERE name = @LogicalFileName)　 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 -- ログは圧縮されていません　　 　　　AND (@OriginalSize * 8/1024) > @NewSize　-- 新しいサイズに渡される値は、現在のサイズ未満です。 　BEGIN -- 外部ループ 　　SELECT @Counter = 0 　　WHILE　((@Counter < @OriginalSize / 16) AND (@Counter < 50000)) 　　　BEGIN -- 更新します 　　　　INSERT DummyTrans VALUES ('Fill Log')　-- char フィールドなので、8000 バイト挿入します。 　　　　DELETE DummyTrans 　　　　SELECT @Counter = @Counter + 1 　　　END　 -- 更新 　　EXEC (@TruncLog)　-- ログの切り捨て。 　END　 -- 外部ループ SELECT 'Final Size of ' + db_name() + ' LOG is ' + 　　　　CONVERT(VARCHAR(30),size) + ' 8K pages or ' + 　　　　CONVERT(VARCHAR(30),(size*8/1024)) + 'MB' 　FROM sysfiles 　WHERE name = @LogicalFileName DROP TABLE DummyTrans PRINT '*** データベース全体のバックアップを実行します ***' SET NOCOUNT OFF
SQLの基本がたぶんわかってないんだろうなぁ・・・という結合です ＞※0002に関しては、テーブル２の方がデータ数が多いため の箇所はロジックが破綻しているので、表示できるとしても「NULL」です 無理すれば一発でできないことはないですが、テンポラリを作りながらやると解りやすいかも。 //準備 create table テーブル1(日付 date,品番 varchar(10),管理番号 varchar(10),数 int,unique key (日付,管理番号,品番)); insert into テーブル1 values('2012-06-12','A987','0001',500),('2012-06-14','A987','0001',300),('2012-06-16','A987','0001',400),('2012-06-18','A987','0001',800),('2012-06-12','A987','0002',750),('2012-06-12','A987','0003',540),('2012-06-14','A987','0003',740),('2012-06-16','A987','0003',840),('2012-06-18','A987','0003',240),('2012-06-20','A987','0003',640); create table テーブル2(日付 date,品番 varchar(10),管理番号 varchar(10),使用数 int,unique key (日付,管理番号,品番)); insert into テーブル2 values('2012-7-10','A987','0001',160),('2012-7-11','A987','0001',260),('2012-7-10','A987','0002',220),('2012-7-12','A987','0002',320),('2012-7-20','A987','0003',530),('2012-7-22','A987','0003',430),('2012-7-24','A987','0003',830); //抽出SQL create temporary table temp_t1 select (select count(*) +1 from テーブル1 AS t1b where t1a.日付 > t1b.日付 and t1a.管理番号=t1b.管理番号 and t1a.品番=t1b.品番) AS RANK,日付,品番,管理番号,数 FROM テーブル1 AS t1a; create temporary table temp_t2 select (select count(*) +1 from テーブル2 AS t2b where t2a.日付 > t2b.日付 and t2a.管理番号=t2b.管理番号 and t2a.品番=t2b.品番) AS RANK,日付,品番,管理番号,使用数 FROM テーブル2 AS t2a; create temporary table temp_t3 select RANK,管理番号,品番 from temp_t1 union select RANK,管理番号,品番 from temp_t2; //表示部分 select temp_t1.日付 ,temp_t3.品番 ,temp_t3.管理番号 ,coalesce(数,0) as 数 ,coalesce(使用数,0) as 使用数 from temp_t3 left join temp_t1 on temp_t3.RANK=temp_t1.RANK and temp_t3.管理番号=temp_t1.管理番号 and temp_t3.品番=temp_t1.品番 left join temp_t2 on temp_t3.RANK=temp_t2.RANK and temp_t3.管理番号=temp_t2.管理番号 and temp_t3.品番=temp_t2.品番 order by temp_t3.管理番号,temp_t3.RANK
とりあえず (1)phpMyAdmin上で所定のテーブルの照合順序をutf8_unicode_ciあたりにしておく (2)文字列の入っているカラムの照合順序を同様に調整する 登録させているデータがEUCならujis_japanese_ciとかになるかも・・・ sjis系は問題外なので省略
mysqlhotcopy 参考URL：http://dev.mysql.com/doc/refman/5.1/ja/mysqlhotc …
削除したものがロールバックできなくても構わないのであれば、「TRUNCATE TABLE table_name」で素早く消すことができます。 参考 http://mysql.deikou.com/pages/000067.html http://dev.mysql.com/doc/refman/5.1/ja/truncate. …
副問合せにunionを使っている事自体に問題はないですね。 「こんな感じ」ではなくて、実際にxx1とxx2しかないシンプルなテーブルを3つ用意して試してみましたか？
おそらくTEXT型のせいでカラム数が若干少なくなっているかと思います。 MySQLのサイズ計算は実際は複雑で詳細は下記をご覧頂き、確認されてはいかがでしょうか。 しかしデータ型を多少変更したことろで限度は2千数百といったところだと思います。 http://dev.mysql.com/doc/refman/5.5/en/column-co … で、やはり現実的にはテーブルを垂直分割するしかないかなと思います。3000カラムでしたら1500カラムの2テーブル、あるいは1000カラムの３テーブルあたりに分けてパフォーマスを見られてはいかがでしょう。（もちろんデータを入れた際にレコード長をオーバーしないかどうかも含めて）
添付画像がありません。 サンプルデータをテキストでいいので補足してください。
これ、MySQL以外ではサブクエリでできるSQLがMySQLでできないからって質問ですよね？ （サブクエリを多用しなければならない設計の場合、MySQLはやりにくいと思います） あと、「ID1が１のValueに「卒業生」と入れたいのです。 」は「ID2が１のValueに」ではないですか？ ID１は同一なはずなので。。。 まぁ、この解釈が多少間違っていても直せる範囲だと思います。 update student a, (select ID1 from student where ID2 = 2 and Value = '10期生') b set a.Value = '卒業生' where a.ID1 = b.ID1 and a.ID2 = 1
既存データベースの文字コード情報が壊れたのかもしれません。 ・postfixの自動起動を止める。 この状態で http://kzworks.at.webry.info/200903/article_14.h … を参考に ・my.cnfのmysqldとmysqlセクションのCHARACTER SETがutf8になっているか確認。 ・ALTER DATABASE でデータベースのCHARACTER SETをutf8に変更を試みてはどうでしょうか。
echoのところが明らかにおかしい またINSERT文を発行するなら文字列はクォーテーションでかこってね file_get_contents()で"7203,トヨタ,3080"が得られたとした場合の サンプルを書いておきます <?php mysql_connect("localhost","root","hogehoge"); //$stock = file_get_contents('http://hoge.jp/data.php?id=7203'); $stock = "7203,トヨタ,3080"; $stock = mysql_real_escape_string($stock); $stock = "'".str_replace(",","','",$stock)."'"; $sql ="INSERT INTO table (id,company,stock_price)"; $sql.=" values(".$stock.")"; print $sql; ?>
直接の回答ではないですが、アクセスしていないDBがメモリを大量に食っているとは 思えませんが？
php-mysql を Install すると解決すると思います。
7は持っていませんが、ファイルメニューに「レコードをPDFとして送信」 などというのはありませんか？これを（現レコードのみで）実行して メールに添付するだけでいいと思いますが。 PDF保存機能が無くても、ファイルメニューから印刷→PDFがあります。 バージョンアップするとメールを送信スクリプトとともに使って自動化 できます。7の機能が分からないのでここまでですが。
試してみた方が早いのでは？ クライアント条件として FileMaker Pro / Pro Advanced クライアントに、ライセンスされた FileMaker Pro / Pro Advanced 9、10、 または 11 が 1 コピー必要です。 となっていますね。互換性の無い機能を除いては共有出来るとは 思いますけど。
password()、md5()、sha1()など用意されています
ちょっとやってみました rand()を使って上がる率を調整します。 //準備 create table aaa (id int not null unique key); insert into aaa values(1); //この2行を、必要な回数実行 SET @NUM=0,@MIN=1,@MAX=10; INSERT INTO aaa SELECT (@NUM:=@NUM+FLOOR(@MIN + (RAND() * (@MAX-@MIN+1))))+a.id FROM aaa inner join (select max(id) as id from aaa) as a on 1
こんにちわ。 > 動的SQLでは無い方法でそのような事が可能でしょうか？ decode を使えば可能かもです。 例えば、v1, v2, v3 と言う数値型変数にそれぞれ列B, 列C, 列Dに 対する検索値が格納されていて、値が-1 だった場合に、検索条件を 無効化する場合、以下のようなSQL で実現できます。 select * from tablea 　where a=1 and b=decode(v1, -1, b, v1) and 　　c=decode(v2, -1, c, v2) and 　　d=decode(v3, -1, d, v3); こうすると、例えばv1変数に-1 が設定されている時の検索条件は 「b=b」となり常に真となるので、実質検索条件を指定していない 場合と同じ事になります。
いまいち構造がわからないのですが whereじゃなくて連結の条件にしてみては？ SELECT u.user_email, m.meta_value FROM wp_users AS u LEFT JOIN wp_usermeta AS m ON u.ID = m.user_id and m.meta_key = 'user_name'
おそらくajaxの案件ですね 参考URL：http://oshiete.goo.ne.jp/category/973/
基本的な構文しか使っていないと思いますが？ SELECT USER,count(*) AS COUNT FROM HOGE GROUP BY USER ORDER BY COUNT DESC
No.2のお礼欄について 基本的には質問者さんの認識でよいと思います。 しかし、データベースをがんがん構築するなんてあまり考えられないのですが。 Filemaker ProやFileMaker Pro Advancedでは少人数での使用を考えた場合に良い選択になると思います。 それ以上になるとFileMaker Server などになってくると思います。 データベースの導入が初めてでしたら、FileMaker Pro Advancedを１ライセンス購入して、必要になったときにFileMaker Proライセンスを追加するのが良いように思います。 Advancedだと個人で名刺管理をしたい場合にも、ライセンスのない他のパソコンで利用できるデータベースが作れますので。
こんな感じでしょうか？ この場合は、内部ではなく外部結合にして都道府県テーブルを 別名で３つ開けるという形になると思います。 SELECT Customer.* 　　 , Pref1.PrefName as PrefName1 　　 , Pref2.PrefName as PrefName2 　　 , Pref3.PrefName as PrefName3 　FROM Customer 　LEFT OUTER JOIN Pref Pref1 　　ON Customer.CustomerPref1 = Pref1.PrefId 　LEFT OUTER JOIN Pref Pref2 　　ON Customer.CustomerPref2 = Pref2.PrefId 　LEFT OUTER JOIN Pref Pref3 　　ON Customer.CustomerPref3 = Pref3.PrefId WHERE CustomerId = 123
調べてみると良く出ている障害みたいですね。 多いのは何かの原因で異常終了したとき。これはPC再起動で治る。 メモリーが少ないとき。 等々
(3) はい，version名です。11gでよいでしょう。 (1) Bが先でAが後でもかまわないでしょう。 ただおそらくほぼすべての受験者が， 基本的な内容であるAのオンライン試験（13,600円＋税）を先に合格した後， Bの会場試験（21,200円＋税）を受験しているはずです。 (2) 1Z0-017（ 90分，40問，合格ライン70%）の出題の方が市販問題集の内容に似ているという口コミもありますけれど， 新刊の市販問題集はほとんど1Z0-051（120分，55問，合格ライン60%）対応をうたっているんじゃないでしょうか。 1Z0-051の受験でいいんじゃないかと思いますけれど。 (5) Amazon.co.jpのカスタマーレビューを参考にしてください。 (4) 転職でしたら，ペーパードライバーじゃダメでしょう。 実務経験はなくても，実際にOracleDBを操作できる実機経験をアピールできないと評価されないと思います。実機でOracleDBを扱うことができるなら，Bronzeでも評価されるんじゃないですか。 Oracle 11gのトライアル版を収録した参考書も出版されていますし， http://www.amazon.co.jp/dp/4797359293/ 無償版の XE(Express Edition) を試してみてもよいでしょう。 http://www.oracle.com/technetwork/database/expre …
なるほど、確かにおかしいですね ちなみにphpMyAdminから「show tables」を実行すればみえますか？
こうしてみてください SELECT ID,GROUP_CONCAT(名前 SEPARATOR ',') FROM テーブル GROUP BY ID HAVING ID IN (SELECT ID FROM テーブル WHERE name='SQL')
「ｘｘできない」とか「エラーになる」とかでなく、具体的にどのようなエラーメッセージが出るとか事象を具体的に提示してください。 データ不整合やVACUUMができないなら、必要なデータを可能な限り救出して、データベースを再作成するしかないのでは？ .dump　→ .read　でダンプしてリストアするといった方法があります。ただし、動画などbinaryデータを格納しているなら、selectでhex関数を使って16進数でファイル出力といった工夫をする必要があるかも知れません。 参考URL：http://www.sqlite.org/sqlite.html
なにでアップロードしていますか？ ・コンソールからmysql < ファイル ・ログインしてload data ・phpMyAdminでコマンド入力 ・phpMyAdminでファイルロード ・独自のプログラムでsqlを発行？ ・そのた またログインするユーザーとアクセスするDB、テーブルとの 整合性は確保していますか？
こんにちわ。 > 「ORA-12514: TNS: リスナーは接続記述子でリクエストされた > サービスを現在認識していません」 > どのようにすれば復旧・接続できるようになるのでしょうか？ Server 側のListener/Instance とClient 側の設定が合っていない 可能性が高いです。 恐らく以前は接続できていたと思うのですが、その時から サーバのホスト名, IP Address 等、network の構成は変更しました でしょうか？ 以下の情報を確認して見て下さい。 ※ サーバ側 1) lsnrctl status <Listener 名> の結果 2) service_names, local_listener, instance_name, db_name, db_domain 初期化パラメータの設定内容 3) listener.ora, sqlnet.ora の内容 4) /etc/hosts の内容 ※ クライアント側 1) sqlnet.ora, tnsnames.ora の内容 2) 接続失敗している接続文字列の内容 3) /etc/hosts の内容
mroongaエンジンを試す環境がないためなんともいえませんが 別のエンジンで試してみてはどうでしょう？ 別のエンジンで問題ないなら場合によってはmroongaエンジンの 何らかの特性や制限の可能性もあるので、そちらの専門サイトで 仕様を確認してみてください
substring(項目Ａ, locate('\"age\" : ',項目Ａ, locate('],\r\n"BBB" :\r\n{\r\nCol1,',項目Ａ)+length('],\r\n"BBB" :\r\n{\r\nCol1,')-1))+8, locate(',',項目Ａ, locate('\"age\" : ',項目Ａ, locate('],\r\n"BBB" :\r\n{\r\nCol1,',項目Ａ)+length('],\r\n"BBB" :\r\n{\r\nCol1,')-1))+8 ) - locate('],\r\n"BBB" :\r\n{\r\nCol1,',項目Ａ)+length('],\r\n"BBB" :\r\n{\r\nCol1,')-1))+8 ) という感じですか。（マニュアル見ただけ。未検証。） ・・・はっきり言って、訳が分らないselect文になるのでお薦めじゃないです。 \r\nは、\rだけかも。 要は改行のときに入る文字のエスケープシーケンス。 "BBB" : { "id" : 2, "age" : , } は"age"未入力と言った仕様があるなら未対応。 （さらに輪をかけてややこしくすればできるとは思いますが。）
こんにちは。 SQLの構成がおかしいです。 $sqlを出力すると select "a_type" from table where member_id="a" というものが生成されています。 $Fieldを"でくくっては返ってくる値は常にa_typeになってしまいます。 $sql = 'select '.$Field.' from table where member_id = "'.$id.'"'; に修正してみてください。
ALTER TABLE `テーブル` ORDER BY `列１` ASC としておくと、可能な限りソートしてくれますが 確実性をもとめるなら表示するときにorder byしてください
「フィールド００１」は「varchar2(2)」ですか、正確な列定義を提示してください。 そうでないと回答も曖昧になってしまいます。 後、 SELECT ':' || フィールド００１ || ':', COUNT(*) FROM テーブルA WHERE REPACE( TRIM( フィールド００１ ), '0', '' ) = '9' GROUP BY ':' || フィールド００１ || ':' を実行してみてください。「90」なども対象になってしまいますが、とりあえず現状がどうなっているのかわかると思います。
SELECT F_No FROM (SELECT DISTINCT F_No,F_Kaisu FROM テーブル名 WHERE F_Memo IS NOT NULL)AS T GROUP BY F_No HAVING COUNT(*)<>MAX(F_Kaisu) ORDER BY 1 です。
ODBC経由ならDAO接続できる気がしますが http://www.accessclub.jp/bbs/0072/beginers27186. … ただ、SQL Serverを利用するということは複数ユーザーからの同時接続の可能性が高いと思います。 カーソルをサーバー側にするのかクライアント側にするのか、共有モードをどうするのかロック戦略をどのように選択するのか注意しないと不整合が起きたり、デッドロックにはまる気もしますが。
プログラムをデプロイするなら、クエリを出すプログラムとデータベースサーバが同一なわけですから、サーバ・クライアント間の通信速度は関係ないはずです。 それとも、ローカルPCから、リモートサーバのデータベースにクエリを出すということなのでしょうか？ それなら通信速度が影響する可能性はあります。 ＃ローカルPCとレンタルサーバでの性能差による処理速度の違いはあるでしょうね。 ＃特に共有サーバは未知数ですね。
## 余計なお世話ですけど。。。 （前）SELECT DISTINCT a.ID1, a.NAME1 FROM TABLE1 a, TABLE2 b WHERE a.ID1 = b.ID2 （後）SELECT a.ID1, a.NAME1 FROM TABLE1 a 　　　WHERE EXISTS ( SELECT 'X' FROM TABLE2 b WHERE a.ID1 = b.ID2) のほうも、一緒の結果になるとは限りませんが。。。 例）TABLE2はTABLE1のID1がすべてID2にあるとして。 a.ID1, a.NAME1 1 あ 2 い 2 い 3 う というデータがあれば、 （前） 1 あ 2 い 3 う （後） 1 あ 2 い 2 い 3 う となりますが。 ・・・ID1が単独でプライマリキー、またはユニークインデックスとして設定されている という前提がないと同じ結果にはならないです。
最初のうちは、データベース管理システムに付属するインタプリタを使う可能性が高いと思います。SQL文を一文ずつ入力しながら、順にその結果を確かめることもできるので。 開発方法は判明するのを待つのが賢明だと思います。プログラムからの問い合わせは、どのデータベース管理システムを使うかによって方法が変わってしまいますから。 それよりもデータベースの用語について、なじみの無い概念に慣れておいた方がよいかもしれません。状況によってTableと言ったり、Relationと言ったりまぎらわしいですし。恐らくSQLでは関係代数、トランザクション処理ではロールバックやデッドロックなど、データベースの設計では正規化などが出てくるでしょう。 参考URL：http://en.wikipedia.org/wiki/Relational_database …
>・トランザクションが使えない ってどういうことかというと 例えば伝票入力の画面で、見出し部と明細（複数行）を一度にInsertしようとしたときに Insert Into TableA(Key1,Data1) values('1','見出し部'); Insert Into TableB(Key1,Key2,Data2) values('1',01,'明細1行目'); Insert Into TableB(Key1,Key2,Data2) values('1',02,'明細2行目'); Insert Into TableB(Key1,Key2,Data2) values('1',03,'明細3行目'); と連続でInsertを実行しますが、例えば２行目でキー重複エラーがあったときに 見出しと明細の1行目のデータが残ってしまいます。 トランザクションを使うと、見出しと明細の1行目のデータもInsertされていない状態に戻す（Rollback）ことができます。 ※論理的なエラーの場合も物理的なエラー（ハードエラー等）の場合も同様です。 ⇒トランザクションを使っていないならあまり気にする必要はないですが、 　（使わないとエラーのときに困るのですが。）
カラム・フィールド・レコードの意味を間違っています。 EXCELで言う「カラム（列）」＝「フィールド」です。
データベースの選択をしていないのが気になります。 ただし、「mysql_select_db」は非推奨のようですね。 http://www.php.net/manual/ja/function.mysql-sele …
こんにちわ。 > SUB1.sql、SUB2.sqlで失敗していても・・・ MAIN.sql の最初で、以下のコマンドを実行してみて下さい。 ---------------------------------------------------- WHENEVER SQLERROR EXIT FAILURE ROLLBACK ---------------------------------------------------- > MAIN内のそれぞれのsqlの実行結果ログを取得 MAIN.sql を以下のようにしてみて下さい。 sub.log に追加でログを取得していきます。 ---------------------------------------------------- set echo on spool sub.log append @&1 @&2 commit; spool off quit ----------------------------------------------------
MySQLの4.0系はメインサポートからはずれているし、しかも 一番評判のわるかったバージョンなのでお勧めできません （サブクエリもつかえない？） もう少し上のバージョンならなんとかなるかも知れませんが・・・
こんにちわ。 > 桁数を増やすとか、・・・ v$sysstat をSelect する前に、以下の何れかを実行して下さい。 SQL> col value format 999999999999999 又は、 SQL> set numwidth 15
補足について MyISAMでもInnoDBでもどちらでもよろしいと思います。このようなシンプルな構造のデータベースだからトランザクションがどうしても必要というわけではないだろうということと、MySQLのバージョンの指定がなかったので、MyISAMにしておいたほうが、問題がないだろうということです。 >　ID_SPECIESだけにインデックスをつける インデックスは付けすぎるとパフォーマンスが低下します。 ID_SPECIESはテーブルを結合するフィールドだからです。 それ以外のフィールドへのインデックスは、実際にデータが入ってから、遅いクエリが発生する場合にチューニングすることで使用するかもしれない選択肢としてとっておきます。 はじめから決め打ちはしません。
＞$sdate=$_POST['sdate']; ＞$edate=$_POST['edate']; ＞$sql='select*from question_tb where purchase_date>="'.$sdate.'" and purchase_date<="'.$edate.'"'; print $sql; とすれば何がおこなわれているかわかるのでは？ ちなみにPOSTで受け取ったデータをそのままSQLに投げるのはNGですので 適切なエスケープ処理が必要です $sql ='select * from question_tb where purchase_date>='; $sql.='"'.mysql_real_escape_string($sdate).'"'; $sql.='" and purchase_date<=' $sql.='"'.mysql_real_escape_string($edate).'"'; ちなみに日付の間をとるならpurchase_date between sdate and edate 的な書き方の方が一般的です
以下のコマンドを実行すれば確認できます。 "$ORACLE_HOME/OPatch/opatch" lsinvetory
>Ａという項目でユーザーが何個チェックをして、Ｂという項目で何個チェックするかは毎回変わると思うのです。 だから・・・ ユーザーがチェックした数をカウントするだけじゃないの？ それができないなら、ユーザーの要求でデータの絞り込みなんてできないでしょ
#3 です。#4 さんとほとんど同じですが、その後気付いたのが MAX を使う方法でした。 SELECT NAME, ICHI, MAX(CASE WHEN ITEM = 'D2' THEN DATA ELSE NULL END) AS DATA_D2, MAX(CASE WHEN ITEM = 'D3' THEN DATA ELSE NULL END) AS DATA_D3 FROM TEST a WHERE NAME = 'A' GROUP BY NAME, ICHI ;
エンジンをMyISAMにしてインデックスをはればidからヒットさせるだけの 単純な検索なら気になる遅さにはならないと思います 複雑で速さが必要ならオラクルなど商用のDBをつかってください
id名をそれぞれ変えたのですか？ 「where ccc.id = 100」と書けばどの属性か特定できたのに。 表名・列名を``で括っていたり，join句を()で括っていたり， 変わった書き方をする人だなあと思っていたのですけれど， そうしなければならない明確な意図は別にないのかな， という印象を受けました。 失礼かとは思いますが， 全部のcolumnに索引がついているとか，データベースが正規化済とか， それもいま一度確認してみた方がよさそうに感じました。 ずるずると回答＆補足が続くのは好みではないので， 私からの回答はこれで止めます。 格納データなど確認した上でそれでもトラブルが解消できないようであれば，また別の質問をたててみてください。
> この時、実行計画が > HASH JOIN RIGHT OUTER > TABLE ACCESS FULL TABLE-B > > のように出ましたが、どのように解釈すれば良いのでしょう？ AAとBBをハッシュ外部結合した。 > TABLE-Bは件数が少ないのでACCESS FULLでも問題ないでしょうか？ たかが30件ですからね。。 > たとえば、この場合のより適切な実行計画ってありますか？ 「*」の部分が本当に「*」で、AAの件数（条件色々で絞り込んだ結果）が 極めて大きいなら、他の実行計画は考えにくいです。 # TABLE-Aの件数は非常に多く（例100万)、条件は複雑です。 従って、この部分をなるべく高速に返せるようにすることが重要です。
逆引用符は列名等を使用する場合に使います、文字列は引用符で囲みます。
>FFFTPで送ろうとしたデータを削除したらデータが消失してしまい ＦＴＰなのでローカルファイルとリモートファイルがあるのだが、どっちを削除したらどっちがどうなったのか？ 当てずっぽで言えば、同期設定しているのに気付かずにファイルを削除したら、ローカルもリモートも一緒に消えたってところか？
＞phpmyadminでselect version()を実行すると、4.1.22-Maxという文字が出てきました。 ああなるほど、じゃMySQLサーバーが4.1なのでしょうね 現在4.1はすでにメインサポートからはずれほぼ終了している状態なので、 今後このようなサイトで質問するときにも、大きく内容がぶれる可能性が高いです。 ＞phpは5.2です。 こちらも微妙に古いですね 現在安定版が5.3.13で、5.4系も5.4.3まできています ＞レンタルサーバなのですがアップデートはできるのですか？ レンタルサーバー自体のポリシーによるのでなんともいえません アップデートのプランがあるかサポートに確認してみてください
簡単なのはリレーション集計です。 別テーブルからの場合、元テーブルの日付から年月を取り出します。例201204とか。 別テーブルに部署とこの年月フィールドを作り、元テーブルとリレーション。 別テーブルにSum(元テーブル::時間)の計算フィールドを作って、部署と年月を入力 すると出ます。もちろん別でブルでは無く元テーブルの自己リレーションでも可能。
8.3.1 からのアップグレードという事ですよね。 簡単に言うと、8.3.19 へのバージョンアップはバグフィックスのみ、9.1.4 へのバージョンアップは大幅な機能追加・性能改善を含みます。 ■ 8.3.19 への移行 ・バグやセキュリティの改善のみでアプリケーションの動作への影響は無し。 ・機能・性能的な変化も無し。 ・移行作業は楽。今までのデータディレクトリがそのまま使える。 　http://www.postgresql.jp/document/8.3/html/insta … ■ 9.1.3 への移行 ・大幅な機能追加・性能改善がされている。(詳細は最後の方のリンク先を参照) ・デフォルトの動作が変わっている部分もある。 　→ ただし、設定によって8.3系と同じ動作にする事は可能。 　　http://www.postgresql.jp/document/9.1/html/relea … ・移行作業では基本的にデータのダンプ・リストアを行う必要がある。 　http://www.postgresql.jp/document/9.1/html/upgra … 　→ ただし、pg_upgrade というツールを使えば少し時間が短縮できる。 　　http://lets.postgresql.jp/documents/technical/co … 　　http://www.postgresql.jp/document/9.1/html/pgupg … 偶然ですが、私が関わっているシステムも先日8.3系から9.1系にアップグレードしました。 移行作業でデータがきれいになった影響もありますが、目に見えて速くなりましたよ。 ■ 参考 PostgreSQL 8.4 の新機能 http://lets.postgresql.jp/documents/technical/8.4/ PostgreSQL 9.0 の新機能 http://lets.postgresql.jp/documents/technical/9. … PostgreSQL 9.1 の新機能 http://lets.postgresql.jp/documents/technical/9. …
こんにちわ。 > 何回のFullScanの結果として読み込んだ行数が > 「table scan rows gotten 151275758」で、 > Full Scanの総数 ＝ table scans (short tables) + > table scans (long tabels)と考えて良いのでしょうか？ Oracle のマニュアル (9.2 リファレンス) を見るとその解釈で良さそうです。 以下のURL で、9.2 リファレンスが参照できます。 http://otndnld.oracle.co.jp/document/oracle9i/92 … 参考URL：http://otndnld.oracle.co.jp/document/oracle9i/92 …
> 今一度私がやりたいことを、具体的に説明させていただきます > > 例えば「やまだ」 > 　　　　↓ > この名前をバラバラにした組み合わせを、一覧にして表示したいのです これは、、、最初の質問文からはまったく読み取れませんでしたよ。 最初から具体例を出していただくべきでした。 名前の文字数は一定ではないですよね？ これはちょっと関数では難しいような気がします。 私ではマクロでもちょっとお時間をいただかないと。。。 あるいは、具体例を質問文に書き加えて質問を立て直されたら 回答が早くつくかもしれません。
ANO.3ですが。 >（データ上にコードで持っていて、in句の中もコードを指定するほうが早いですが。） コードを持っていく、指定するとは何ですか？ 物件テーブル上は、 101とか102とかコードでもっていて 住所マスタで、 101,'東京都千代田区' ・・・ を別に持つ。 画面は住所マスタから選択肢を表示し、 チェックされたら in('101','102'・・・) のようにコードでin句を組み立てるという意図でした。 >方法２は指定する項目が30あれば >00100010100011100000001100100 >といったデータを格納するということですね。 その通りです。 但し、全部1つにする必要はなく、条件の分類毎に１項目作ればいいと思います。 例えば、先ほどの回答では、「収納」が2桁、「・・・」がn桁・・・という感じです。 何も指定されていなければ、select文のwhere句の中に入れる必要ないので。 方法２の下に 「（ビットマップインデックスが使えるなら、同じような考え方で、検索はより早くなります）」 をつけたのは誤解を招いたかもしれません。 方法３のやり方で、方法２のような検索処理をしてくれるというイメージが近いです。 MySQLにはないようですのであまり書く意味が無かったですが。
UPDATE Salary SET Amount=Amount+5000,PAYDATE='2007-12-31' WHERE EmployeeID IN(SELECT EmployeeID FROM Employees WHERE BloodType='A') です。
・@@IDENTITYは直前のIDENTITY列の値です。INSERT INTOする場合に使う物ではありません。 ・SET IDENTITY_INSERTはリストア時など，明示的にIDENTITY列に値を入れたい場合に使います。 というわけで，このクエリは， INSERT INTO members (seibetu, name) VALUES ('男', 'すずき') のみでよくなります。 # SET IDENTITY_INSERTは不要。
ANO.2です。 ＞ただ、店舗や商品の数が今後も増えていくのですが、その都度、インデックスを張りなおさないといけないのでしょうか。 インデックスは、店舗や商品を増やすたびに更新されます。 要は、インデックスを作ると、テーブルに対する追加・更新・削除のときに、 インデックスも更新されるので、テーブルに対する追加・更新・削除が遅くなる。 （但し、今回みたいに１種類や２種類増やしたところで、人間の目では遅くなったことはわからないでしょう。） そのかわりに検索処理のときにインデックスを使って検索するので非常に早くなる。 ということです。 スロークエリログの件は・・・私はちょっとわからないです。 （スロークエリログを使ったことがないので。） 他の方が回答してくれるかも。。。
> そのサイト非常に有名ですが、あんまり役に立ちませんでした。 > そのため、質問しました。 #1にも書いたけど、どう役に立たなかったか書いてもらわないと何も回答できない。 サポート掲示板で訊くからここでの回答はいらないってことなんだろうな。たぶん。
> １．トランザクション開始 > ２．テーブルAをUPDATE > ３．色々な処理(省略) > ４．テーブルＡのUPDATE前の情報を参照 同一トランザクションでUPDATEしてから更新前の情報を取得しようとすること自体無理があるように思えるのですが。 SELECT UPDLOCK でデータ取得してから更新処理を行うのが妥当ではないですか。
select s1 from テーブル名 where code in ( 0, 1) group by s1 having count( distinct code ) > 1 でどうでしょう。
Accessのバージョンはいくつでしょう？ それによって回答も少し変わるのですけど。 まずはこちらをご覧になって分からなければ ご返答ください。当方2010と2002を所有 複数列のレポートを作成する方法 http://www.nurs.or.jp/~ppoy/access/access/acR008 … 後半部分は『課』をグループヘッダーにして 改ページを『カレントセクションの前』に指定すれば出来そうですが もっと正確なイメージが欲しいところです。 （こちらに関しては解決までの自信はありません）
その程度したら、3つのDBどれを使用しても性能差は出ないと思います。 自分が一番使い慣れているDBを使用するのが良いかと思います。 >あと、どの程度データを各データベースに入れると重くなってしまうものなのか・・・ 数千万件でも問題なく動作しますよ、mySQLもSQL Serverも。 HWを大きくして、数を増やしていけば、どこまでも。 と、しか言えないのは、 性能は一概にデータ量だけで判断できないからです。 一般論として、よく言われるのは メモリにキャッシュしきれないデータ量になると急激に遅くなる というものです。 以上をまとめると、 適切なHW構成であれば、どのデータベースを使用しても性能は担保できる。 5万件であれば、無茶苦茶なクエリを書かなければ、 メモリに乗り切るかどうかが性能分岐点になりやすい ってところでしょうか。 ちょっと不親切な回答になり、すみません。
こんにちわ > そのSQLでどの程度PGAメモリを消費するか・・・ http://docs.oracle.com/cd/E16338_01/server.112/b … 上記、管理者ガイド (11.2) のメモリ管理に以下のように記載されています。 > PGAメモリーの使用統計を提供する動的なパフォーマンス・ビューが > 用意されています。これらの統計のほとんどは、PGA_AGGREGATE_TARGETが > 設定されると使用可能になります。 > 作業領域メモリーの割当ておよび使用に関する統計は、次の動的 > パフォーマンス・ビューで表示できます。 > V$SYSSTAT > V$SESSTAT > V$PGASTAT > V$SQL_WORKAREA > V$SQL_WORKAREA_ACTIVE > V$PROCESSビューの次の3つの列では、Oracle Databaseプロセスによって > 割り当てられ使用されているPGAメモリーがレポートされます。 > PGA_USED_MEM > PGA_ALLOCATED_MEM > PGA_MAX_MEM SQL と紐付けるなら、V$SQL_WORKAREA かV$SQL_WORKAREA_ACTIVE を使用 する事となります。 ※ V$SQL_WORKAREA_ACTIVE の場合、現在アクティブなものしか出力 　 されませんが。 現在のPGA の使用量であれば、V$PROCESS かV$SESSTAT を集計するのが 簡単だと思います。 ※ V$SESSTAT で、統計名 "session pga memory" と "session pga memory max" 　 でセッション毎のPGA メモリ量が確認できます。 　 こちらは、PGA_AGGREGATE_TARGET とは関係なく取得できます。 > PGAメモリを消費しやすいSQLとは・・・ http://docs.oracle.com/cd/E16338_01/server.112/b … 上記チューニングガイドには、以下のように記載されています。 > 複雑な問合せ(たとえば、意思決定支援の問合せ)の場合、ランタイム領域の > 大部分が、次のようなメモリー集約型演算子で割り当てられた作業領域に > 使用されます。 > ・ソート・ベース演算子(たとえば、ORDER BY、GROUP BY、ROLLUP > およびウィンドウ・ファンクション) > ・ハッシュ結合 > ・ビットマップ・マージ > ・ビットマップ作成 > ・一括ロード操作で使用される書込みバッファ それと、In-Memory Parallel Query を使っていなければ Parallel Query の場合もPGA に直接読込みます。
この手のDBは実は奥が深い (1)楽曲名やアーティスト名がまったく同じ場合がある (2)同じ楽曲であってもカバーなどアーティストが１人だけだとは限らない (3)同じ人であってもアーティスト名が一つだけだとは限らない (4)季節がない場合もあるし、四季をとおしたうたもある
select * from member where birthday between curdate()-interval @age:=36 year and curdate()-interval (@age -1) year - interval 1 day みたいなかんじで
>方法はありませんでしょうか。 であれば、MySQL側でなんとかなるもんではないのでPerl板に 質問投げてみてはどうでしょう？ http://oshiete.goo.ne.jp/category/255/
MySQLを用いて動的に生成されたWebページがSEO的に有効に作ってあるか不利に作ってあるかというだけで，MySQLを使うこと自体はSEOには無関係です。 話は変わってAmazonの場合，ある一冊の本が掲載されたページのURLとして必要な情報は， http://www.amazon.co.jp/dp/477414195X/ なのですけれど，本のタイトルや著者名をURLに組み込んで， http://www.amazon.co.jp/「最速」SEO-~たった28日で上位表示する驚速ビジネスサイト構築術~-デジタル仕事術-芳川-充/dp/477414195X/ という形式で公開しています。Amazonの目に見えて分かるSEOの代表例です。
OEMは恐らくAWRという機能を利用して負荷の高いSQLの情報を出力しているのでしょう。 AWRは負荷が高いSQLの情報のみを取得しているようなので、負荷が少ないSQLの実行計画を 見るにはSQLトレースを取得するしかないように思います。 SQLトレースは非常に負荷がかかる処理なので、AWRで負荷少ないSQLの情報まで取得すると 普通にシステムが動かなくなってしまいますからね。。
ん？ > CREATE OR REPLACE PROCEDURE A.P930 > ( > varCD IN VARCHAR2, > varDate IN VARCHAR2 > ) は procedure (function じゃない)だし、out の引数もないから、 > Set myRs = .Execute ではなにもかえってこないんではないですか?? function の戻り値を ADO で得るためには、なんかくふうが要るようだ。 http://homepage2.nifty.com/sak/w_sak3/doc/sysbrd … out で戻すなら、 http://www.progress-japan.co.jp/support/SupportL … ADODB.Command.Execute の戻り値は Command が SQL であるときのレコードセットじゃないかな?? ADOのしがらみがめんどうならば、ストアードで、ワークテーブルに書き込んで、 execute の戻り値をとらずに、ワークテーブルを直接見に行くかしたらいいんじゃないですかね? 　 　 　
＞「基礎からのMySQL改訂版」という書籍で学習しており、 ＞参考書もphpMyAdminベースのものに買い直して方がよろしいですかね。 同書の詳細は存じませんので大きなことは言えませんが、 往々にして参考書を買い直す必要はないと思います。 サンプルなどで発行するSQL文をphpMyAdminに張り付ければ（もしくは手で書く） 戻ってくるデータの見え方が違うだけなので、ざっくり読み替えれば 問題ないはずです。 ただ、他の方への補足を見る限り、WindowsにMySQLをインストールして そこにローカルで接続するということですね？ であればシステムの構築のところは統合環境のxamppなどで環境を作った方が よいかもしれないですね
phpMyAdminは、入っていますか？ 入っているなら、そちらからダンプファイルが作れるかと思います。 あとは、他の方も書かれていますが、PHPから行うとかですかね。 system関数や、exec関数などを使えば可能です。 私の場合、PHPから exec( mysqldump -c -u xxxxxxx -pxxxxxxx xxxxxxx | gzip > /home/ユーザー/backup/zzzzz.dump.gz", $output, $ret ); の様に実行させています。
CSVファイルの段階で36MBもあると、Excelでは辛いかもしれません。 CSVファイルの先頭行の有無にもよりますが、ExcelでADOで開けば何とかなるかも？ ADODBでCSVファイル読み込み＠Excel マクロ・VBA http://www.cocoaliz.com/excelVBA/index/35/
一日あたり5万件のデータが1年つづくと1800万件 その生データを抽出集計するのはほぼ現実的ではないですね 経験的に1000万件をこえると集計付加は相当でてくると思います 回答とすればどちらも単純なシステムではまともなレスポンスは 期待ないでしょう 逆になんらかの中間テーブルをつかって処理すれば データは数百～数千分の一に圧縮できるでしょうから インデックスをうまくつかえばどちらのシステムでもそうかわらないかとｋ 極端に多いデータを場合は、商用のデータベースとＩＴコンサルを 活用してください（最近流行のビッグデータ？）
＃２です 訂正です。 ＃２では、＃１の補足を元に、サブクエリ部分を関数に置き換えましたが、 質問を読み直してみると、A, B 逆ですね。 書き方一緒で、内容を逆にしてみて、どうなりますか。
Oracleの文法では、 文字列型の連結に || を使います（Concatもあるけど）。 ⇒CONCAT(A,B)と　A || B が同じ結果となる。 ## 選んだ参考書がOracle用だとかないですか？ MySQLは他の方が書いておられるように　CONCATを使う必要があるようです。 ## ちなみに、SQL Serverは、A + B（Concatもあるけど） ## CONCATはほぼ共通ですが、他はデータベースソフトによってばらばらとなっている ## 要素の一つでした。
