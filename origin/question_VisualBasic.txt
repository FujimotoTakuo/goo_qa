私は、「ダブルクリックをすると画像がセルの大きさぴったりに挿入される」方法を探していて、現在ネットで見つけた下記のコードを使用しています。 Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) Dim WDT, HGT Application.ScreenUpdating = False WDT = Target.Width HGT = Target.Height On Error GoTo Fin Application.Dialogs(xlDialogInsertPicture).Show With Selection.ShapeRange .LockAspectRatio = msoFalse .Width = WDT .Height = HGT End With Fin: On Error GoTo 0 Application.ScreenUpdating = True End Sub とても便利で見つけた時は嬉しかったんですが、2点困っています。 1点目は、すべてのセルが適用されていることです。 画像を挿入したいのはA列で10行まとまりほどで結合しています。 プラスで入力するとき、 結合しているセルを指定というコードなのか A列のみというコードなのか また、どの部分にいれればエラーにならないのか教えてください。 まだ勉強中なのでお手数ですが、いれる文の前後を教えてください・・・。 2点目はシートを変えると適用されていないということです。 複数シートがあるんですが、最初のシートしか適用されていません。 ネットで見つけた下記コードを参考にいじってみたのですが、エラーになってしまいました。 Sub すべてのシートでマクロ実行() Application.ScreenUpdating = False Dim シート As Worksheet Application.ScreenUpdating = True End Sub ぜひアドバイスなどがあればお願い致します。
VBAでExcelの複数のシートのうち、ある範囲に赤色塗りつぶしのセルが含まれているシートのみ、シートの色を変更したいと考えています。 シートの色を変更するVBAは調べられたのですが、その前の判定部分がどう書けば良いか分からないです。 お助けいただけないでしょうか？
エクセル2010にてユーザーフォームを作成しています。 ユーザーフォームにコンボボックスを3つほど作成し、選択した内容で検索ボタンを押すと オートフィルタにて内容が表示される仕組みになっています。 ここで質問なんですが、 コンボボックスが一つでも空欄の場合は検索結果がすべて空白のセルが表示されてしまいます。 どれか1つでも選択されている場合は絞り込み検索が可能にしたいです。 現状は下記のようになっています。 -------------------------------------------------------------- Private Sub CommandButton1_Click() ActiveSheet.Range("$A$3:$S$3").AutoFilter Field:=1, Criteria1:=ComboBox1.Value 　ActiveSheet.Range("$A$3:$S$3").AutoFilter Field:=7, Criteria1:=ComboBox2.Value ActiveSheet.Range("$A$3:$S$3").AutoFilter Field:=8, Criteria1:=ComboBox3.Value Unload 検索 -------------------------------------------------------------- 大変恐縮なのですが、よろしくお願いします。
タイトルのとおりですが、TextBoxの数字の表示は千単位でカンマしたいです 例「1,000,000」 よろしくお願いします
Visual Basic 6.0で　ファイルをコピーするソフトを作っています。 ただ１行のなかに0000から0020までのコントロールコードが入っていところが所々あります。 だからその行にはLine Input では正確に読み込めません。 書き込むと違う文字になっています。 char = Input (1, #1) char = inputB(1, #1) でバイナリが含まれている１行だけ読み込みみたいのですが 0D　0A すなわち　CR　LF まで読み込むにはどうしたら良いのでしょうか？ この文章の意味がわかる方お願いします。
質問　：　windws10（32bit）タブレットに Winbas95 をインストールしたい 　ジャストシステムの「一太郎１６」とセットで購入したテックウィンド社製タブレット「CLIDE W10A」をサブマシンとして使っています。使い慣れているＸＰ時代（中には９５時代）からのハードやソフトも結構問題なく使用できています。 　ところが N88BASIC機能を windows 環境で使える winbas95 というソフトがインストールできません 　このソフトは、N88時代からデータの集積、整理に使いい続けていますし、調べたところいまこのソフトに代わるものはないようです。 　いまメインに使っているノートパソコン 　　　ＮＥＣの LaVieS LS150/SSW 　　　　（windows8.1からw10(home 64bit ver1511 にアップグレード） 　には問題なくインストールでき正常に動作しています。 　したがって Winbas95 は widows10 に対応出来るけれども W10A では使えないということになります。これは Windows10 の 64bit と 32bit との違いなどが原因でしょうか。なんとか W10A でも使えるようにしたいのですが 　なおWinbas95はVB6で作ったとのことなので、もしかしてと思いVB6のランタイムをインストールしようとしたのですが、同じようなメッセージが出てインストールできませんでした。 　解決に結びつくようなヒントなどよろしくお願いします。 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　以上
Excelシートにファイルを参照して 貼り付けたいのですが、マクロの書き方が分かりません。 やり方はいろいろあると思いますが、起動用シートにファイルのパスを貼り付けて 貼り付けたパスのファイルをSheet1とSheet2に貼り付けるにはどうマクロにかけば良いでしょうか？
次のコードを実行させるとファイル Book1.xlsx がオープンされますが、VBAのコードが実行されません。そのため次のコードが実行できなくなっています。環境はWindows 10 、Excel2016 です。 〜 前のコード 〜 Workbooks.Open ("¥¥Mac¥Home¥共有フォルダ¥book1.xlsx") 〜 次のコード 〜 前のコードにブレークポイントを設定し、そこで一度止めてから実行を継続させると正常に次のコードのブレークポイントで止まります。しかし、前のコードでブレークポイントを設定せずに実行させると次のコードに設定したブレークポイントで停止しません。 book1.xlsxはまっさらなファイルでVBAのコードはありません。 何が原因でしょうか。
こんにちは、VBAの初心者です。 わかる方いたら教えてください。 今シート1に入力したものをシート2に飛ばし蓄積データとしています。 売上日 請求日 伝票No 2016831 2016831 99998 2016831 2016831 99999 シート1とシート2の形式は上記のようになっており シート2で蓄積しているデーターの伝票№の末番+1を シート1で売上日を入力した際に自動で表示させたいです。 ご回答よろしくお願い致します。
DirとWorkbooks.OpenTextを併用し、大量のファイルの開閉をしてます。 ファイル数２千。ファイルの行数は5千行程度。CSVファイル。 出だしは快調で10ファイル/秒程度の速さですが、だんだん遅くなり、１ファイル/５秒程度になり、ついに固まります。最初は問題ありませんでしたが、毎日処理を続け１か月目あたりから発生してます。固まるまでの処理数は、１０００～５００ファイル程度。 単にファイルの開閉だけなのに止まります。なぜでしょう？ Sub Macro() TwbPath = ThisWorkbook.Path Folder = Cells(1, "A").Value buf = Dir(TwbPath & "\" & Folder & "\*.dat") Do While buf <> "" 　　 Application.ScreenUpdating = False Workbooks.OpenText Filename:=TwbPath & "\" & Folder & "\" & buf, Comma:=True Application.DisplayAlerts = False Workbooks(buf).Close savechanges:=False Application.DisplayAlerts = True buf = Dir() 　 Application.ScreenUpdating = True Loop End Sub
ＶＢＡ勉強中で調べながらプログラムを作成しています。 調べた中で似た内容のプログラムを実行させたのですが自分が実行したい内容と 一部違うのでどうすればいいのかをご教授いただけると助かります。 下記プログラムではコメントでもあるように１行全部の転記となってしまう為 一部の列のみを転記するプログラムに変更したいです。 ◆似た内容のプログラム◆ Sub Sample() Dim c As Range Dim v() As Variant Dim cols As Long Dim j As Long Dim dic As Object Set dic = CreateObject("Scripting.Dictionary") With Sheets("Sheet2") 'シート２のA3からA列のデータ最終行までのセルを１つずつ取り出す For Each c In .Range("A3", .Range("A" & .Rows.Count).End(xlUp)) dic(c.Value) = dic.Count + 1 'その値をキー、１からの連番をデータとして辞書登録 Next End With With Sheets("Sheet1") 'シート１の列数取得 cols = .UsedRange.Cells(.UsedRange.Cells.Count).Column ReDim v(1 To dic.Count, 2 To cols) '転記用配列 'シート1のG5からG列のデータ最終行までのセルを１つずつ取り出す For Each c In .Range("G5", .Range("G" & .Rows.Count).End(xlUp)) 'もし辞書にあれば（シート２にあれば）１行分のイメージを配列に格納 If dic.exists(c.Value) Then For j = 2 To cols v(dic(c.Value), j) = c.EntireRow.Cells(j).Value Next End If Next End With With Sheets("Sheet2") .Range("I3").Resize(UBound(v, 1), UBound(v, 2)).Value = v .Select End With MsgBox "転記終了" End Sub ◆実行したい内容◆ 【Sheet2】Ａ3～最終行までの番号（値）をキーとして 【Sheet1】Ｇ5～最終行までの番号（値）と一致した同じ行の一部の列(B5・K5・M5・S5の最終行まで)を 【Sheet2】一致した番号（値）と同じ行の列（I3・J3・K3・L3の最終行まで）に転記したいと思っています。 　　　　　 　　転記元　　 ⇒　　　転記先 【Sheet1】B列　⇒　【Sheet2】I列 【Sheet1】K列　⇒　【Sheet2】J列 【Sheet1】M列　⇒　【Sheet2】K列 【Sheet1】S列　⇒　【Sheet2】L列 宜しくお願い致します。
指定のフォルダに入っている全てのエクセルファイルをシートを指定して一つのpdfファイルに変換したいと考えています。全てのエクセルファイルにはSheet1～Sheet5まであり、Sheet1～Sheet4までをpdf化させたいのですが、なかなか上手くいきません。 どなたかご教授願えれば幸いです。試作したマクロコードは下記になります。よろしくお願いいたします。 Sub pdf() '変換対象の.exlsファイルを保存したフォルダ Const PATH = "E:\Exceclデータ\vba\" '.xlsなどのファイルを検索 Dim file As String file = Dir(PATH & "*.xlsx") 'すべての検索結果を取得するまでのループを継続 Do While file <> "" Dim tmp_path As String tmp_path = PATH & file 'ファイルを開いて、PDF形式でエクスポート Workbooks.Open tmp_path Sheets(Array("Sheet1", "Sheet2", "Sheet3", "Sheet4")).Select Sheets("Sheet1").Activate ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=tmp_path & ".pdf", Quality:=xlQualityStandard, _ IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False '現在のファイルを閉じる ActiveWorkbook.Close '次に合致するファイルを取得 file = Dir() Loop End Sub
セキュリティ的な理由で、職場にてLL言語の代わりにEXCEL VBAを使用する機会がふえています。 使用していてちょっと気になることができたので質問いたします。 必要に応じてサイズを増やすため、要素を動的に確保するプログラムにしたのですが、最初の要素を追加する場面でエラーになります。 予め最初の要素を作っておくとエラーにならないのですが、要素が無題になるので気に入りませんｗ この場合、もっと適切がやりかたがあるのでしょうか？ Sub Sample() 　　Dim ary() As Variant, e As Variant 　　Dim size As Long 　　 　　 　　'ReDim ary(0) ' ←ここを有効にするとOK 　　 　　size = UBound(ary) ' ←ここでエラー"インデックスが有効範囲にありません" 　　ReDim Preserve ary(size + 1) 　　ary(size + 1) = "foo" 　　 　　size = UBound(ary) 　　ReDim Preserve ary(size + 1) 　　ary(size + 1) = "bar" 　　 　　For Each e In ary 　　　　MsgBox TypeName(e) & ":" & e 　　Next End Sub
VBA初心者です。 シート１にあるデータ一覧のセルをダブルクリックしてそのデータをシート２に転記させたいです。 ダブルクリックしたらその一列がまるごと転記されるにはどのように書いたらいいですか？ また、一行だけでなく各行のデータをダブルクリックしたらその都度転記されるようにしたいです。 お手数ですがご回答のほどよろしくお願いします。
前回の質問の続きです。 　　(前回　https://oshiete.goo.ne.jp/qa/9376599.html) クリップボードがダメなら、UserPictureメソッドしかないということで、クッリプボードの図をemf形式でファイル化するプロシージャーを入手しました。(http://www.oaltd.co.uk/Excel/Default.htmのPastePicture.zip) そして、下記のプロシージャーを作成しました。 そして、aa()の1回目は問題なく実行できます。 しかし、選択するShapeを変更して2回目を実行すると、”SavePicture oPic, FN”の行でエラー。「書き込みできません。(Error 70)」で実行できません。Helpを見ると「・別のプロセスでロックされているファイルに書き込もうとしています。 別のプロセスが解放してから、ファイルを開きます。 」とあります。 (エラーの出方が不安定です。コードを修正するとできるときもありますが、保存後再起動すると同様にエラーが出ます。) その他の状況は、 (1)　”cc FN”をコメントアウトすると何回でも問題なく実行できます。 (2)　また、エラーの発生時に、エクスプローラからzzz.emfを削除しようとすると、エクセルが使用していて削除不可とのこと。 (3)　手動でファイルから塗りつぶし設定を行うと、そのファイルはすぐに削除可能なこと。 これらから、cc()のコードに問題があり、ファイルを解放しないようなのですが、何が悪いのかさっぱり判りません。 よろしくアドバイスをお願いします。 Private Sub aa() 　Dim FN As String 　FN = "zzz.emf" 　Selection.Copy　’事前にShapeを選択してます 　Set oPic = PastePicture(14)　'入手プロシージャーの呼び出し 　SavePicture oPic, FN　'同　ファイル保存ステップのプロシージャーの呼び出し 　cc FN End Sub Sub cc(FN As String)　'塗りつぶし処理 　Dim Oj As Object 　ActiveSheet.Shapes("Rectangle 14").Select 　Set Oj = Selection 　Oj.ShapeRange.Fill.UserPicture FN 　Set Oj = Nothing End Sub
access初心者です。 インターネットや本を調べてできないのでわかる方教えて下さい。 フォーム1にテキストボックスとボタンとリストボックスがありテキストボックスに製品名を入力しボタン(あいまい検索)をクリックするとリストボックスに該当データが表示されるようになっています。リストボックスには、ID・製品名・金額・SALE金額の4つのフィールドがあります。 ここで検索された該当データをダブルクリックするとフォーム2のテキストボックスに製品名とSALE金額が代入され、SALE金額が合計される仕組みを作りたいと考えています。できれば、フォーム2のテキストボックスは10行ほど作成しボタンを使用しクリックするとSALE金額が合計されるようなイメージをしています。 いろいろ試してみたのですがaccess初心者では、限界を感じました。質問文章もわかりづらいかもしれませんがわかる方ご教授お願いします。
失礼します。 現在、下記のコードを使いエクセルからOutlookメールを作成しています。 これに指定のフォルダ入っているエクセルファイル（例：E:\Exceclデータ\vbaにあるtest.xlsx）を添付したいのですが、VBA初心者で上手くいきません。 またできれば、C9セルにファイルURLを入れておき変更しやすくしたいです。 VBAに明るい方がいらっしゃいましたらご教授願えますと幸いです。何卒よろしくお願いいたします。 Sub MakeMail() ' Outlookのメールを作成する Dim ol As Object ' 起動しているOutlookを取得する Set ol = GetObject(, "Outlook.Application") If ol Is Nothing Then Exit Sub ' メールを作成する With ol.CreateItem(0) .To = Range("C4").Value ' 宛先 .CC = Range("C5").Value ' CC .BCC = Range("C6").Value ' BCC .Subject = Range("C7").Value ' 件名 .Body = Replace(Range("C8").Value, vbLf, vbCrLf) ' 本文 .Display ' 表示 End With Set ol = Nothing End Sub
Sheet1 A列 B列 C列 　201606 175 　 . 1 　 . 2 　201606 176 　 . 1 　 . 2 　201607 175 　 . 1 　 . 上のような表がありまして Sheet2 A列 B列 C列 201606 176 1 2 このようにSheet2のA1セルとB1セルに入力した数値で検索して,Sheet1C列の値をSheet2のC列にコピーしたいのですが、FindやMatch,For Each等試してみましたが上手く出来ません。 訳がわからなくなりすぎて丸投げになってしまい恐縮ですが、ヒントだけでもと思い質問させて頂きました。よろしくおねがいします。
インプットボックスに入力した値をSheet Dtで検索してその行番号を取得するようにしたいのですが、match関数がエラーになって上手く出来ません。どこが悪いのか教えて頂きたいです。 Sub 検索() Dim a As Variant, b As Variant, c As Variant, d As Variant, e As Long a = InputBox("日付を入力してください。例 210610") b = InputBox("社員番号を入力してください。") If a = "" Or b = "" Then MsgBox "入力されていません" End If On Error GoTo Err_Trap Worksheets("Dt").Activate c = Application.WorksheetFunction.Match(a, Columns("B"), 0) d = Application.WorksheetFunction.Match(b, Columns("C"), 0) MsgBox "検索値は" & c & "行目、" & d & "行目です" Exit Sub Err_Trap: MsgBox "エラーコードNo." & Err.Number & vbCrLf & Err.Description MsgBox "検索値が見つかりませんでした" End Sub
EXCEL　VBA初心者です。 「Excelでファイル階層表作成」（http://www.vector.co.jp/soft/winnt/util/se499921 …）というフリーソフトで指定フォルダの階層を取得していていましたが、さらに最終更新日時の行も作成したいです。 色々試してはみたのですが、エラーばかりで…。 申し訳ございませんが、お知恵をお貸し頂けたらと思います。 会社で使用したく、セキュリティ上レジストリに書き込んだりするexeのインストールはできず、なんとかこのEXCELに追加したいのです。 できましたら、サイズを表示する列の右隣に表示させたいです。 コードを記載したいのですが、文字数とそもそも記載して良いのか不明のため、大変申し訳ございませんが、教えて頂けたらと思います。 どうぞよろしくお願いいたします。
Excelマクロ VBAに関して、ご教示お願いします。 シート1の列Aに「文字列a」～「文字列z」が入力してあるとします。 シート2の列Bにシート1の列Aに入力してある文字列と同じ文字列が 入力してあるのですが、順は不同となります。 この時に、シート1のA列の各文字列にハイパーリンクを設定し、 シート2の同じ文字列へジャンプさせる方法についてご教示お願いします。 シート１　　　　 　シート2 　A　　　　　　　　　B --------------------------------------- 　a　　　　　　　　　d　　　 　b　　　　　　　　　a　　　 　c　　　　　　　　　b　　　 　d　　　　　　　　　c ご回答いただけますと大変ありがたいです。 よろしくお願い致します。
EXCEL2003(.XLS)ファイルをEXCEL2010環境（互換モード）で実行しています。 3行目から行単位のデータがあり、１列目をダブルクリックすると、フォーム入力画面が開きます。 データが存在する３列目をクリックすると、Range("J1")を、その値で更新します。 このファイルを開いて、最初に1列目をダブルクリックしてフォームを開くと、後の処理は問題なく動くのですが、最初に3列目をクリックして、SelectionChangeイベントを発生させると、必ず画面がフリーズしてしまいます。 どうもダブルクリックイベント処理の中の Cancel=True 処理がヒントのような気がしますが、 それにしても、どう対応すべきかわかりません。 ご存じの方、よろしくお願いいたします。 以下は関連するコードです。 （シート内のモジュール） ===================================================== ' ダブルクリックイベント処理 Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) If Target.Column = 1 And _ Target.Row >= 3 Then If Target.Value <> "" Then 'カード入力画面 Call S_Card_IN(Target.Row) Cancel = True 'セルの選択状態を解除 End If End If End Sub ' 処理中NO 更新 Private Sub Worksheet_SelectionChange(ByVal Target As Range) If Target.Row >= 3 And Target.Column = 3 Then If Cells(Target.Row, 3) <> "" Then Application.EnableEvents = False ActiveSheet.Range("J1") = ActiveSheet.Cells(Target.Row, 3) Application.EnableEvents = True End If End If End Sub
動的に変化させるグラフをクリップボードにコピーし、これで四角形等のShapeを塗りつぶすVBAを求めてます。 　手作業ではうまくいったので、マクロの記録を取ろうとしたのですが、最後の塗りつぶしのステップがうまく取れません。 　よろしくお願いします。 追伸：画像ファイル等での塗りつぶしは、マクロに記録できるのですが、なぜかクリップボードからの塗りつぶしはできません。何か設定があるのでしょうか？
いつもお世話になります、 ユーザーフォームのテキストボックスにカーソル位置を置いたらマクロが実行されるようなコードをご存知の方いらっしゃいましたらご教示願います。目的は入力支援です。
マクロを用いてユーザ指定に応じて、テーブルのフィールド数や名称を可変にします。 そのため、フィールドの入力方法をリストボックスにしたいのですが、VBAで記述する必要があります。 色々調べてみたのですが、どのような設定をすればいいのか見つかりません。 選択肢は決められた文字列からでいいので教えてください。
マクロ 検索した条件に対応する値を選択したセルに貼り付ける マクロでsheet1のBの名前をsheet2のA列から検索してsheet2のF列をsheet1で選択したセルへ貼り付けたいです。 良い方法はないでしょうか？(٭°̧̧̧ω°̧̧̧٭) 助けてください！！
マクロ初心者で申し訳ないのですが、どうかご教授ください。 タイトルの通り、指定したシート及び範囲のデータを新しいブックに貼り付け、指定したセルの名前で指定フォルダに保存する一連のマクロを作りたいのですが、上手くいかず困っています。 ※①～④が現在抱えている問題点です。 ①sheet1のセル(5,1)にTODAY関数で求めた日が入っているのですが、これをフォルダ名にするやり方がわからない。 ②元エクセルファイルのシートは１～３まであるのですが、新しくマクロで作成されたファイルにもシートが１～３まで出来てしまっているので、これをシート１のみにしたい。 ③保存ファイルの形式はデフォルトでxlsxにしたいのですが、毎回xlxmにするかどうかのメッセージが出てしまうので、これを無くしたい。 ④マクロを実行すると元エクセルファイルが閉じ、何故か新規Book1のエクセルが立ち上がってしまう。 マクロの記録で作ったコードは下記になります。 Sub データ保存() ' データ保存 Macro Range("A1:C40").Select Selection.Copy Workbooks.Add Application.CutCopyMode = False Windows("保存マクロ.xlsm").Activate Selection.Copy ThisWorkbook.Activate Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Application.CutCopyMode = False ChDir "E:\Exceclデータ" ActiveWorkbook.SaveAs Filename:="E:\Exceclデータ\マクロテスト.xlsx", FileFormat:= _ xlOpenXMLWorkbook, CreateBackup:=False ActiveWindow.Close End Sub 説明がわかりずらく大変申し訳ないのですが、何卒ご教授ください。
いつもお世話になっています。 .NetFrameworkで「:（コロン）」キーのKeyCodeは何でしょうか。 おわかりになる方よろしくお願いします。
お世話になります。 VBA ユーザーフォーム上に20個のチェックボックスがあり、それぞれ名前を変える必要があります。 名前は別シート（リスト)に登録されているものを使用するのですが、一度に変えることは可能でしょうか？ for next で色々試したのですがうまくいきません。 教えていただけますよう、よろしくお願いします。
Excelマクロの初心者です。 仕事でやらざるを得なくなったため、本を読みながら悪戦苦闘しながらやっております。 ブックAのシートAのA列に条件（年月で「2016.1」など）が100行ほど記載してあります ブックBにはここ数年のすべての年月がシート名になって存在しています （2016.１、2016.２・・・など） シートAのA列の条件と同じ年月のシートをブックBから選択したいのですが、どうしてもうまくいきません。 またA列の数とセルの値は変わるため、変数に代入してforNextステートメントで繰り返し処理をしたいと思っています。 変数の指定まではできるのですが、違うブックになってしまうと変数が認識？されなくてブックBから条件にあてはまるシートを選択することができません・・・ 何分初心者なもので、質問内容そのものがおかしい事も承知しております。 お力を貸して頂けましたら幸いです。 どうかよろしくお願いいたします。
シート内に複数の図形が並んでいます。 その内の３個をマウスで選んで、アクティブ図形のみをVBAで移動させたいのですが、可能でしょうか？
エクセル初心者です。 印刷したくないセルについて Private Sub Workbook_BeforePrint(Cancel As Boolean) Dim MyLocal() As Variant, i As Long, MyCount As Long With ActiveSheet MyCount = .Range("D3:D4").Cells.Count ReDim MyLocal(MyCount - 1) For i = 1 To MyCount MyLocal(i - 1) = .Range("D3:D4").Cells(i).NumberFormatLocal Next i .Range("D3:D4").NumberFormatLocal = ";;;" Application.EnableEvents = False .PrintOut Application.EnableEvents = True Cancel = True For i = 1 To MyCount .Range("D3:D4").Cells(i).NumberFormatLocal = MyLocal(i - 1) Next i End With End Sub 上記で出来たのですが、シ－トを保護するとエラ－になってしまいます＞＜。 ミス防止のためにシ－トの保護はしておきたいです。 解決方法教えて頂きたいです。 よろしくお願いします。
VBScriptに関して質問です。 最近まで以下のようなプログラムでフォルダの作成を行っていたのですが ソフトのアップデート後から以下のプログラムでエラーが出るようになりました。 ".\結果"の部分を実際のパスに変更すると上手くいくのですが ".\結果"にするとエラーが発生します。 どのように変更すればこのエラーは改善できるでしょうか。 使用ソフトは解析専用ソフトの「JMAGdesigner15.0」に付属しているスクリプト機能であり 14.0から15.0に変更した際に前述のエラーが出ました。 ご教授よろしくお願いいたします。 Set objFS = CreateObject("Scripting.FileSystemObject") If objFS.FolderExists(".\結果")= False Then objFS.CreateFolder(".\結果") End If
お世話になります。 複数シートに同じ表があります。 その表のセル(G7,H7) (I7,J7) (K7,L7)というように列が結合されている箇所に連番を振るにはどうしたらよいのでしょうか。 結合されるセルの数は（G８,H8) (I8,J8) (K8,L8)と番号を振る下に入るデータ数によって変わっていきます。 色々試してはいるのですがうまくいきません。 よろしくお願いします。
VBAの初心者です。色々調べたのですがわからなかったので、こちらで質問させていただきます。 A列にある文字列に対して、B列にある単語を抽出し、赤字で表示させるというマクロを組みたいです。 B列1行目の単語を抽出させるところまでは何とかなったのですが、B列2行目へ処理を移行？させるやり方がわかりません。 どなたかご教授いただけますと幸いです。 ---------------------------------------------- Sub test2() Dim rng As Range, cl As Range, i As Long With ActiveSheet Set rng = .Range("a1:a100") txt = Range("b1").Value For Each cl In rng s = 1 While s <= Len(cl) p = InStr(s, cl, txt, 1) If p > 0 Then cl.Characters(p, Len(txt)) _ .Font.Color = vbRed s = s + p Else GoTo p1 End If Wend p1: Next End With End Sub ----------------------------------------------
VBA初心者です。 エクセルで作ったデータ(数値でけでなく、文書も含みます)を秀丸エディタにコピーして、保存する事はできますか？ シートがたくさんあるので、シートごとに保存していきたいのです。 今は手作業でシートごとにコピーして、タブを消して、その後一つづつ保存しついるのですが、その作業が毎日50シートごとにあり、なんとかならないかと思っていますが、VBAでは秀丸のタブを消していくのは難しいですか？ 初心者でトンチンカンな質問でしたら、申し訳ありませんが、よろしくお願いします。
テキストファイルを１行ずつ読み込んで別ファイルに保存しています。 ただ時々バイナリの入っているところがあります。 Line Input #1, d$ では正確に読み込めないのか 書き込んだ行とは違うことになります。 同じように書き込むためにはどうしたらいいのでしょうか？
いつも大変お世話になります。2日連続の投稿になります。 エクセルで右上の×ボタンを押して上書き保存するときに、「顧客管理」という名前の特定シートが存在している時のみ「顧客管理シートを削除してから保存して下さい」といったメッセージが表示されて、上書き保存されないマクロをご教示願いたいです。 Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean) Dim wi As Worksheet, flab As Boolean For Each wi In Worksheets If wi.name = "顧客管理" Then flab = True Next wi If flab = True Then MsgBox "『顧客管理』シートを" & vbCrLf & "削除してから保存して下さい", 48 Exit Sub End If End Sub この上記のコードだとメッセージが表示されるのですが、結局上書き保存されてしまいます。
Excel2010使用者、VBA初心者です。 複数のファイルを1つのエクセルに統合するマクロをネット上で見つけたのでそれを活用しているのですが、空白セルの一部が長さ0の文字列のまま残ってしまうため、一気にNullに変換したいと思っています。ネットで色々と調べてコードを追加してみたのですが、どうしても上手くいきません。 下記のコードに何を追加すれば最後に一気に空白をNullにできるでしょうか？ご教授頂けると助かります。どうぞよろしくお願い致します。 Sub ExcelbookCombine() '結合したいファイルがあるフォルダの場所 cドライブなら "C:\test\" Const Fol As String = "C:\test\" Dim Fn Dim NewFile As Workbook Dim Wb As Workbook Dim Ws1 As Worksheet Dim Ws2 As Worksheet Dim R As Range Set NewFile = Workbooks.Add Set Ws1 = NewFile.Worksheets(1) Set R = Ws1.Range("A2") Fn = Dir(Fol, vbNormal) Do Until Fn = "" Set Wb = Workbooks.Open(Fol & Fn) 'ワークシート1をコピーする場合は Wb.Worksheets(1) 'ワークシート2をコピーする場合は Wb.Worksheets(2) Set Ws2 = Wb.Worksheets(1) 'Aの1行目から8列目までをコピーして結合する Ws2.Range("A2", Ws2.Cells(Rows.Count, 1).End(xlUp)).Resize(, 22).Copy R Set R = R.End(xlDown).Offset(1) Application.CutCopyMode = False Wb.Close 'Debug.Print Fn Fn = Dir Loop Set R = Nothing Set Ws1 = Nothing: Set Ws2 = Nothing Set Wb = Nothing: Set NewFile = Nothing End Sub ↑このコードできちんとエクセルは統合できています。
いつもお世話になります。 表題とおり、A1セルにNUMエラーが出た時にメッセージボックスが表示されるやり方をご教示頂ければ幸いです。
MicrosoftマイクロソフトのエクセルでマクロVBAをやりたいです。 プログラムがちょっとわかりません。 sheet1、sheet2、sheet3を参照します。各sheetの中は写真のようなデータが入ってます。 sheet1から始めます。 列Aの3行から23行までをみます。 ◯が書いてあったら、その行をsheet4に貼り付けます。 順次、23行まで繰り返します。 次のsheet2も同じ事を繰り返します。 次のsheet3も同じ事を繰り返します。 sheet4に◯が書かれた行の一覧が出来れば成功です。 可能でしょうか？ 出来れば、モジュールmoduleに貼り付けるだけで終わるようにプログラム教えてもらえますか？
他所サイトのQ&Aです。行削除の下記３つの方法について ①Unionで溜めておき一気に削除。変数でなくSelectで溜める ②Unionで溜めておき一気に削除。変数で溜める ③最終行から１行ずつ削除 300行削除　　いずれも0.2秒程度 3000行削除　①②140秒　③2秒 Unionを使う場合、処理行数が多くなると急激に遅くなります。なぜ？と言っても仕様なのだからしょうがない？③と同等または遅いくらいなのだから、Union使う意味ないように思えて来ました。これまでの自分の認識ではUnion一気削除の方が速いので、少々困惑気味です。 Sub ①() t = Timer Application.ScreenUpdating = False Max = 10000 For i = 3 To Max If i Mod 2 <> 0 Then If i = 3 Then Rows(i).Select Else Union(Selection, Rows(i)).Select End If End If Next i Selection.Delete shift:=xlUp Application.ScreenUpdating = True Cells(1, 1).Value = Timer - t End Sub Sub ②() Dim rng As Range, i As Long t = Timer Max = 10000 Set rng = Cells(3, 1) For i = 5 To Max Step 2 Set rng = Union(rng, Cells(i, 1)) Next i rng.EntireRow.Delete Cells(1, 2) = Timer - t End Sub Sub ③() Dim i As Long Dim Max As Long t = Timer Max = 10000 For i = Max To 3 Step -2 Rows(i).Delete Next i Cells(1, 3) = Timer - t End Sub
例： C:\Users\User1\Desktop\File.txt ファイルを右クリックすると、場所は表示されてコピーできるのですが、 （C:\Users\User1\Desktop） ファイル名は自分で入力しなければいけません。 ファイル名を含めたパスを、一発でコピーするよい方法はありませんでしょうか？
下記はDataGridViewのｾﾙ同士を掛け算するﾌﾟﾛｸﾞﾗﾑです。 実行すると型shortの値をDataGridViewｾﾙに変換できません 。 とｴﾗｰが出ます。なぜでしょうか。 Private Sub DataGridView2_CellValueChanged(sender As Object, e As DataGridViewCellEventArgs) Handles DataGridView2.CellValueChanged Dim txt1 As Short Dim txt2 As Short Dim value As DataGridViewCell DataGridView2.Rows(0).Cells(1) = txt1 DataGridView2.Rows(0).Cells(2) = txt2 value = txt1 * txt2 DataGridView2.Rows(0).Cells(3) = value End Sub End Class
VBAの数字で困っています。 お世話になります、勉強しながらプログラムを記述しているVBA並びにプログラム初心者です。 base.Cells(2, 28)のセルに8556805823という数字を入れています。 しかし、 Dim Number As Single Number = base.Cells(2, 28).Value checkSheet.Cells(3, 1).Value = Number と記述すると、 checkSheet.Cells(3, 1).Value のセルの表示が 8556805632と変わって表示されてしまいます。 試しに、 Number = 8556805632 と記述しようとすると Number = 8556805632# となってしまいます。 プログラムの他の部分でもNumberの数字を修正するような記述はしていません。 質問がわかりづらくて申し訳ありませんが、 どうかご教授お願い致します。
お世話になります。 私は４月から新社会人となりAccess,VBAの学習課題に取り組んでおります。 そこで、分からず立ち止まっている箇所がありますのでご教示願いたいと思い質問致します。 メインフォームとサブフォームで構成された伝票登録フォームなるものを作成し、コンボボックスで顧客名や商品名の入力を行いたいのですが、クエリの設定方法の影響か顧客IDや商品IDでの入力はできるのですが、顧客名や商品名での登録を行おうとすると「フィールド'顧客ID'とキーが一致しているレコードをテーブル'T_全顧客'で探すことができません。」というエラーメッセージが出てしまいます。 T_全顧客というのは顧客情報を削除した場合でも売上からデータが消えないようにするため作成しました。 伝票登録フォームはメインフォームのQ_売上とサブフォームのQ_売上明細で構成されています。 Q_売上で使用しているテーブルは以下の通りです。 T_売上 売上NO｜売上日｜顧客ID T_全顧客 顧客ID｜顧客名｜住所｜電話番号｜etc... 自分でも理解が不十分なため稚拙な文章で申し訳ありません。 お力添えよろしくお願い致します。
シート操作について教えてください。 sheet1～sheet10において sheet3～sheet10までの名前を変更しています。 sheet3　Aランク sheet4 Bランク sheet5 Cランク sheet10 Jランク 各シートの2列目、17行目から下の表示を折り返して表示とするため Dim i As Integer For i = 6 To Worksheets.count 　 　j = Worksheets(i).Cells(Worksheets(i).Rows.count, 2).End(xlUp).row 　If Worksheets(i).range("B17") = "" Then Exit For End If Worksheets(i).Cells(j, 2).WrapText = True Next というコードを作成しましたがうまくいきません。 どこが駄目なのか教えてください。よろしくお願いします。
学校のレポートにあたり、VB.NETで3次関数の係数をテキストボックスに入力し、ボタンを押すとグラフを出力するプログラムを作ることになりました。 フォーム設計は写真のような感じです。 座標軸を描くプログラムはできるのですが、3次方程式を表す曲線を描くプログラムがわかりません。 教えて頂けるとありがたいです。
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click [ア] tate As Graphics = [イ].[ウ] [ア] yoko As Graphics = [イ].[ウ] [ア] shahen As Graphics = [イ].[ウ] [ア] x1, y1, x2, y2, x3, y3 As [エ] x1 = [オ] (TextBox1.[カ]) y1 = [オ] (TextBox2.[カ]) x2 = [オ] (TextBox3.[カ]) y2 = [オ] (TextBox4.[カ]) x3 = [オ] (TextBox5.[カ]) y3 = [オ] (TextBox6.[カ]) tate.[キ] ([ク].[ケ], [コ], [サ]) yoko.[キ] ([ク].[ケ], [シ], [ス]) shahen.[キ] ([ク].[ケ], [セ], [ソ]) End Sub アからソに何を入れてよいかわかりません わかる方がいらっしゃったらおねがいします
辞めた社員が作成したエクセルVBAを修正しなければいけなくなりました。 これまでのエクセルの項目列にはなかった年齢列を設けて、また、これまで存在しなかったとある転職サイト（エン転職）さんのCSVファイルを新たに取り込むことになりました。 これまで他の転職サイト（マイナビ）さんのCSVファイルのVBAを修正して取り込もうと思ったのですが、うまく取り込めません。 ■取り込みたいCSVファイルの列　（A列～Z列まであり、取り込みたい列は以下の5列です。 O:氏名○, P:氏名○ ,Q: R:年齢 ○ ,Y:携帯電話番号○, Z:Mail○ 以下は実際のCSVデータの列です（☓は取り込まず、○を取り込みます） A:☓ B:☓ C:☓ D:☓ E:☓ F:☓ G:☓ H:☓ I:☓ J:☓ K:☓ L:☓ M:☓ N:☓ O:氏名○ P:氏名○ Q: R:年齢 ○　S:☓ T:☓ U:☓ V:☓ W:☓ X:☓ Y:携帯電話番号○ Z:Mail○ ■元となるエクセルの列 A：項 B:状況 C:雇用形態 D:勤務地 E:応募媒体 F:応募詳細 G:氏名 H:かな I:年齢 J:電話番号　 K:Mail L:入力日 という具合です。 エクセル側のVBで【E列:の応募媒体】、【L列:入力日】,【G列：氏名】、【H列:かな】の項目だけはなんとか修正できました。 ■【J列：電話】は、電話番号の左３文字目までを””にて文字列として扱うようにしたのですが、どうしても１文字目の０が省かれてしまいます、 ■I列に取り込みたい年齢　、K列に取り込みたいmailの２項目を色々と修正をしてみたのですが、どうしてもうまく取り込めません。 どなたか、修正箇所をお教え頂けませんでしょうか？ Sub entensyoku() On Error GoTo ErrorTrap Application.ScreenUpdating = False Application.DisplayAlerts = False Dim Ret As Long Ret = SetCurrentDirectory("\\D\2014年度") fret = "\\D\2016年度\" ChDir fret Filename = ThisWorkbook.Name Maxrow = Range("G65536").End(xlUp).Row + 1 filetoOpen = Application.GetOpenFilename("CSV（カンマ区切り）,*.csv") If (filetoOpen <> "") Then Workbooks.OpenText Filename:=filetoOpen Filename2 = Dir(filetoOpen) Dim LastRow As Long LastRow = Range("A2").End(xlDown).Row Range("A:C").Select Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove Range("I2:J2").Select Range(Selection, Selection.End(xlDown)).Select Selection.Phonetics.CharacterType = xlHiragana Range("A2:A" & LastRow).Value = "=RC[15]" Range("B2:B" & LastRow).Value = "=PHONETIC(RC[15])" Range("C2:C" & LastRow).Value = "=IF(OR(LEFT(RC[25],3)=""090"",LEFT(RC[25],3)=""080"",LEFT(RC[25],3)=""070""),RC[25],IF(RC[25]="""",RC[25],RC[25]))" Range("A2:C" & LastRow).Select Selection.Copy Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Application.CutCopyMode = False Columns("D:P").Delete Shift:=xlToLeft Range("A2:D" & LastRow).Copy Workbooks(Filename).Activate Range("G" & Maxrow).Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Range("E" & Maxrow & ": E" & Maxrow + LastRow - 2).Value = "06.エン転職" Range("L" & Maxrow & ": L" & Maxrow + LastRow - 2).Value = Date Application.Goto Range("A" & Maxrow), True Workbooks(Filename2).Close Else Application.DisplayAlerts = True Application.ScreenUpdating = True Exit Sub End If Exit Sub ErrorTrap: MsgBox "cancel", vbOKOnly, "採用管理表" Application.DisplayAlerts = True Application.ScreenUpdating = True End Sub
エクセルのオプションボタンにグループ分けを設定して、朝の起動時に　どちらかがＯＮ状態を確認しています。 グループは2個　その中にボタンが各2個あります。 タイマー作業で15時にあるコードが走ります。そうすると、グループＢの方のボタンが両方ＯＦＦ状態となります。（そのコードの性かどうかわかりかねますが、作業としてそれくらいしか思い当たらない） 書いたコードのバグでボタンのＯＮ／ＯＦＦを触ったとしても、その対のボタンが反応するはず。 グループの中で両方ＯＦＦって？　逆にどういう操作すればその状態が作り出せるのか？ 何かプロパティにありましたでしょうか？ NULLを与えている状態でもなさそうです。 ネットでデータを取得していますので QueryTable.Refresh BackgroundQuery:=False 位が、内部の操作が分かりずらいコマンドでしょうか、後は特別の操作も無し・・・・ 思い当たることが有りますれば、よろしくどうぞ
都道府県ごとのブックにバラけたトマトの作付面積のデータを、一つのシートにまとめようと試みています。 転記元のブックは「1北海道」、「2青森」・・・「47沖縄」という順番で単一フォルダ内に並んでおります。 このフォルダ内の順番の通りにシートに転記したいのですが、 以下のマクロ（あるサイト様から拝借しました）を用いて転記すると順番がめちゃくちゃになってしまいます。 何か改善策はないものでしょうか？お詳しい方、どうぞよろしくお願い申し上げます。 転記に用いたマクロ 記 Sub ブックの転記() Dim myDir As String, myName As String, myBook As Workbook Dim motodata As Range, sakidata As Range Dim 転記先 As Worksheet, 転記元 As Worksheet Set 転記先 = ThisWorkbook.ActiveSheet Application.ScreenUpdating = False '集計用のブックがあるフォルダ名を指定 myDir = "C:\Users\Desktop\野菜データ" myName = Dir(myDir & "\" & "*.xls") Do While myName <> "" '↓転記先の最新レコード位置を取得する Set sakidata = 転記先.Range("XFD2").End(xlToLeft).Offset(0, 1) '↓(1)指定した名前のブックを開いて変数に格納する Set myBook = Workbooks.Open(Filename:=myDir & "\" & myName) '↓(2)転記元を取得する。 Set 転記元 = myBook.ActiveSheet Set motodata = 転記元.Range("A8:A47") '↓(3)転記先に貼り付ける motodata.Copy sakidata '↓(4)開いたブックを閉じる myBook.Close myName = Dir() Loop End Sub 以上
フォーム上にあるチェックボックスのチェック数を合計し、その数を別シートに標示するにはどうしたら良いのでしょうか。教えてください。 Private Sub count_CheckBox() Dim i As Long For i = 1 To 20 If Me.Controls("CheckBox" & i).Value = True Then count = count + 1 End If Next i If count > 0 Then MsgBox count End If End Sub 上記コードでフォームにあるチェックボックスの合計を求めています。
vbaマクロにて初心者なので教えてください。 各店舗から送られてくる注文表を本店でまとめるため、 複数のエクセルファイルデータを１つのファイルにまとめる作業を行いたいと考えております。 本店ファイルのA列１セルはプルダウン形式で支店名が選択できるようにしているので、 支店名を選択し、マクロボタンを押せば、選択した支店名の注文内容が一発で値貼付できるようにしたいのです。 具体的には、作業実行中「本店ファイル」のA列1セルに入力されている「支店名ファイル」のシート１B列1～C列１０までのデータを、「本店ファイル」のシート１B列１～C列１０に値でコピーして貼り付けするという作業を行いたいです。両ファイルは同じフォルダ内にあります。 ご教授の程よろしくお願いいたします。
Sheet1に（行×列）5000×2500の数値のデータがあり、 その中の偶数行だけをSheet2に移動しようとしているのですが、 なかなかうまくいきません。 助けていたたければ幸いです。
入力フォームの入力値をコマンドボタンを押すことでシートのリストに登録することをVBAでおこないたいのですが、そこでテキストに入力規制をかけたいのですがいろいろ調べ調べで試行錯誤していますがわからなくて困っています。 初心者のためご教授願います。 以下のようにできるか考えたのですが… ユーザーフォームに ①OptionButton1 と ②OptionButtun2 と ③TextBox を配置し、①を選択すると正の数(自然数）、②を選択すると負の数(マイナスをつけた数）しか③に入力できない規制をかけたい（異なった数値が入力された場合メッセージで注意を促したい）のですが、そもそもこのようなことはできるのでしょうか？できるのであればコードを教えて下さい。 上記以外でも結果として登録する直前に①と②の状態からシートに誤登録を防ぐストッパーのような働きができればと考えています。
ＶＢＡのフォーム上にチェックボックスが数個あります。 チェックされた数を合計しフォーム上に表示させることは可能でしょうか。
マクロ初心者レベルのものです． 現在，表からInputboxにて特定の文字を複数検出し，削除した後に，背景の塗りつぶし設定を”なし”の状態にしたく奮闘していますがうまくいきません． 詳しい方いらっしゃいましたら知恵を貸してください(._.) ネットにあったマクロを参考にし，複数の文字を削除するところまでは可能でしたが，同時に背景の塗りつぶし設定を”なしor白？”の状態にしたいのですが，うまくいきません． ネットで参考にしたマクロ Sub 削除と置換() ' 範囲選択 Macro ' Range("F7:AD31,G42:Z65").Select Range("G42").Activate Dim MyA As Range Dim MyKey As String Dim MySpl As Variant MyKey = InputBox("消したい文字を「スペースで」区切って、入力してください") If Len(MyKey) = 0 Then Exit Sub For Each MyA In Selection For Each MySpl In Split(Trim(Replace(MyKey, "　", " ")), " ") MyA = Application.Substitute(MyA, MySpl, "") Next MySpl Next MyA End Sub 途中に強引に（MyA = Application.の後など）Withなどで塗りつぶし設定の コマンドを入れても挿入位置が悪いのか，マクロの表記が悪いのか？うまくいきません． こういった場合どのようなマクロが一番すっきりでしょうか？ご教授下さい． 具体例； 図のような状態から，Inputboxにて，”東京”　”大阪”　”北海道”などの文字を空白を入れながら 文字指定をすることで削除はできるのですが，そのまま塗りつぶし設定も変更したいのですが わかりません． どのようなマクロがいいのか？どの列にどのようなマクロを挟むのか？なども教えて頂けると 幸いです．よろしくお願い致します．(._.)
手作業で、名前を付けて保存をする時に拡張子をPDFにすると、保存したPDFが表示されます。 マクロの記録で、作成したプログラムを実行すると、保存はされますが、保存後のPDFが表示されません。ネットでPDF表示とかPDF出力を検索しても、今回の求めている記述ではありません。 私はシートをPDF形式で保存、保存されたPDFファイルを自動で開いて確認をしたいです。 PDF保存は、マクロの記録で出来ております。 保存後、そのPDFファイルが自動で開く記述が知りたいです。 どうか、無知な私に教えて下さい。
For...Next文をつかってボタン1を、押したら3.2.1.0.と順にカウントダウンするメッセージボックスが表示されるようなプログラムのコードを書きなさい。という課題が出たのですがわかりません。よろしくお願いします
至急お願いします。プログラミングなんですけどFor.....Next文をつかってボタンを押したら3.2.1.0と順にカウントダウンするメッセージボックスが表示されるようなプログラムのコードを書きなさい。という課題が出ましたがわかりません、、、
VBAを使っていて ミリ秒単位でスリープするためには、 Sleepコマンドを使うことができます。 もっと短い時間で指定してスリープしたいのですが 数十マイクロ秒スリープするにはどうしたら良いですか？ http://lab.tricorn.co.jp/kicco/486 検索すると、Linuxではusleepというコマンドで実行することができるそうです。 VBやVBAではこういうコマンドは実装されていませんでしょうか？
ACCESS2010を利用しています。 ＣＳＶファイル（m159.csv）をインポートするため、下記①を記述しました。 （正確には教えてgooで教えて頂きました） 更に、ダイアログボックスでＣＳＶファイルを指定して取り込めるようにしたかったので、ネットで調べ自分なりに追記しましたした（下記②の２箇所） しかし、うまくいきません。 恐らく、「 DoCmd.TransferText acImportDelim, "M159定義", "M159", "C:\Users\t.yukie\Desktop\m159.csv", True」の部分がいけないと思われますが、どのように修正していいか分かりません。 ご指導をお願いします 【①】 Private Sub コマンド1_Click() Dim msg As String msg = getFilePicker　　←【②】 If msg = "" Then Exit Sub On Error GoTo err_sample DoCmd.TransferText acImportDelim, "M159定義", "M159", "C:\Users\t.yukie\Desktop\m159.csv", True MsgBox "インポートが終了しました。" Exit Sub err_sample: Select Case Err.Number Case 3011 MsgBox "ファイルが見つかりません。処理を終了します。" Case Else MsgBox Err.Number & ":" & Err.Description End Select End Sub 【②】 Function getFilePicker(Optional dTitle As String = "ファイル選択") Const msoFileDialogFilePicker As Integer = 3 Dim fDlg As Object Set fDlg = Application.FileDialog(msoFileDialogFilePicker) fDlg.Title = dTitle fDlg.InitialFileName = CurrentProject.Path fDlg.AllowMultiSelect = False fDlg.Filters.Clear fDlg.Filters.Add "すべてのファイル", "*.*" fDlg.Filters.Add "CSV ﾌｧｲﾙ (*.csv)", "*.csv" fDlg.FilterIndex = 1 If fDlg.Show Then getFilePicker = fDlg.SelectedItems(1) Else getFilePicker = "" End Function
皆さんよろしくお願いします。 ピボットテーブルのレポート位置を既存のワークシート中、 任意の列の（今はB列の予定）最下行から作りたいのです。 そもそも、ピボットテーブルの行変更（列は変わらないのですが、日々、行数は変わります）について ピボットテーブルの作成のＶＢＡ化で悩んでいます。 Ｓｈｅｅｔ1のＢ1に「区分」項目があり、Ｉ1に「税抜金額」項目があります。それぞれ2行目から値が入っています。 列としてはＲ列まであります。 Ａ列は空です。 したい事は ①Ｂ列を基準にできれば上に向かって最下行を取得し、データソース範囲とする。 ②レポートはＢ列の区分をラベルにして、データの個数、合計/税抜金額、合計/全体に対する金額の構成割合の「行ラベル・データ個数・合計金額・構成割合」の4列です。 ③同じシートC列を基準に最下行を取得し、C列の最下行から3行下をレポート（作表）開始位置とする。 色々と調べてみたのですが、全くわからないので投稿させてもらいました。 宜しくお願い致します。 以下はマクロの自動記録です。 Sub Macro2() ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _ "Sheet1!R1C2:R12395C18", Version:=xlPivotTableVersion14).CreatePivotTable _ TableDestination:="Sheet1!R12398C3", TableName:="ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2", _ DefaultVersion:=xlPivotTableVersion14 Sheets("Sheet1").Select Cells(12398, 3).Select With ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").PivotFields("区分") .Orientation = xlRowField .Position = 1 End With ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").AddDataField ActiveSheet.PivotTables( _ "ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").PivotFields("税抜金額"), "合計 / 税抜金額", xlSum ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").AddDataField ActiveSheet.PivotTables( _ "ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").PivotFields("税抜金額"), "合計 / 税抜金額2", xlSum ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").AddDataField ActiveSheet.PivotTables( _ "ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").PivotFields("税抜金額"), "合計 / 税抜金額3", xlSum With ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").PivotFields("合計 / 税抜金額") .Caption = "データの個数 / 税抜金額" .Function = xlCount End With With ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").PivotFields("合計 / 税抜金額2") .NumberFormat = "#,##0" End With With ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").PivotFields("合計 / 税抜金額3") .Calculation = xlPercentOfTotal .NumberFormat = "0.00%" End With ActiveSheet.PivotTables("ﾋﾟﾎﾞｯﾄﾃｰﾌﾞﾙ2").TableStyle2 = "PivotStyleMedium8" End Sub 宜しくお願い致します。ｍ（＿）ｍ
すいませんが、教えてください。 インプットデータは以下になります。（実際は1000行ぐらいあります） A1 X C1 D1 A2 X C2 D2 A3 Y C2 D3 A4 Y C1 D4 A5 Y C2 D5 A6 X C6 D6 C列の値が同じ行（例えば1行目と4行目）はB列がXである行を残し、Yである行を削除します。 しかしその際、削除する行のD列の値を残す行のD列に追加します。 その結果、アウトプットデータは以下になります。インプット、アウトプットどちらも同じエクセルファイルにし、シートを分けたいです。 A1 X C1 D1 D4 A2 X C2 D2 D3 D5 A6 X C6 D6 いろいろやってみたのですが、どうもうまくいかず、途方に暮れています。 どうかよろしくお願いいたします。
Excel2010で。 たとえばC列全体を選択したい場合、 Columns("C:C").Select と書くと、なぜかC・Dの２列選択されます。 相対参照で書いても、同じでした。 excel2007で同じ記述するとC列だけの選択ができるのですが・・・。 2010で仕様変更になったのでしょうか。バグ？ 1列だけ選択して動作させたいのですが、困っています・・・。 何か解決方法あれば教えていただけるとありがたいです。
お世話になります。 当方、4月から企業に入社した新入社員です。 現在AccessとVBAでシステム構築の課題に取り組んでおります。 現在分からず悩んでいる箇所についてご教示願います。 問題の箇所を簡単に説明します。 売上管理システムなるものを構築中で、現在苦戦しているのが領収書印刷という機能の日付を指定した印刷方法です。 顧客ごと毎月の締日が異なるのですが、20日が締日の顧客の場合、前月21日から今月20日までの売上を印刷するという動作をさせたいです。 下記のようにレポートをひとまずビューで表示させるようにしているのですが、型エラーが起こり上手くいきません。 例） Start => 2016/06/21 Closing => 2016/07/21 --- DoCmd.OpenReport "領収書", acViewPreview, , "顧客ID='" & 顧客ID.Value & "'" And "売上日 Between ' & Start & ' And ' & Closing & '" --- 色々と試してはいるのですが理由がわかりません。そもそもこの方法ではできないのでしょうか？ 皆さんのお力お貸しください。よろしくお願い致します。
フォーム上にチェックボックスが20あります。 チェックすると別のシートに　1　が入るようにしたいです。 Ａ～Ｈには項目が設定されているので　１　が入るのはＩからに。 １６行目までは固定のデータが入っていて、１７行目から増えていき、 最終行がどの行になるかは未定です。 チェックボックス1　　　から　　チェックボックス20 　　Ｉ,17　　　　　　　から　　　　ＡＢ,17 　　Ｉ,18　　　　　　　から　　　　ＡＢ,18 　　Ｉ,100　　 　　　　から　　　　ＡＢ,100 　　　　　　　　　　 に　順に　１　を入れるにはどうしたらよいのでしょうか。 教えてください。よろしくお願いします。
すみませんが、ご教授願います。 いくつかのセルに色が付いていますが、その後データが追加されます。 作っていただきたいのは、その後 色が付いていたセルで、重複した文字があった箇所のみ セルに色を付けたいのです。 よろしくお願いします。
VBAのプログラミングついて、困っています。 ある観測データがExcelに 0.117 0.114 0.114 0.102 0.102 0.093 0.09 0.09 0.09 ←こんな数値の羅列が100万くらいがB列に並んでいます。 １、このような数値の羅列のあるシートから別のシートにこの観測データのなかで−１＞Xに当てはまる数値の除外かつそのデータを5000毎に分割 ２、そうすると（行×列）5000×100に数値が埋め込まれるはずで、さらにそのなかの偶数行の数値を上下反対にしたいのですが 例えば 0.117 0.117 0.117 0.117 ←これを 0.116 0.116 0.116 0.116 0.115 0.115 0.115 0.115 0.104 0.114 0.114 0.114 0.103 0.113 0.113 0.113 0.117 0.113 0.117 0.113 ←このように偶数列のみ上下逆にしたいです 0.116 0.114 0.116 0.114 0.115 0.115 0.115 0.115 0.104 0.116 0.114 0.116 0.103 0.117 0.113 0.117 やり方がわからず悪戦苦闘しています、よろしくお願いします。
EXCEL VBAでdo~loopとexit doを使って計算しなさい。という問題があり、 一応やってみましたが動きません…。 わかる方回答お願いします。 消費税５％を含むものとする A　　　　　　　　　B　　　C　　　D 1　ケーキ名 　　　　単価　　 数量 　　金額 2　ショートケーキ 　450 　　15 3　アップルパイ 　　400　　 3 4　マロングラッセ 　420 　　25 5　チーズケーキ 　　320　　 8 6　モンブラン 　　　410 　　18 7　ティラミス 　　　370　　 5 Sub 例題47() Dim tanka As String, suryou As String, kingaku As String Range("A1").Select Do tanka = ActiveCell.Offset(0, 1).Value suryou = ActiveCell.Offset(0, 2).Value kingaku = (tanka * suryou) * 1.05 ActiveCell.Offset(0, 3).Value = kingaku ActiveCell.Offset(0, 1).Activate If ActiveCell.Value = "" Then Exit Do End If Loop End Sub
VBAのプログラミングついて、困っています。 ある観測データがExcelに 0.117 0.114 0.114 0.102 0.102 0.093 0.09 0.09 0.09 ←こんな数値の羅列が100万くらい １、このような数値の羅列のあるシートから別のシートにこの観測データのなかで−１＞Xに当てはまる数値の除外かつそのデータを5000毎に分割 ２、そうすると（列×行）5000×100に数値が埋め込まれるはずで、さらにそのなかの偶数行の数値を上下反対にしたいのですが 0.117 0.117 0.117 0.117 ←このように偶数行のみ上下逆にしたいです 0.114 0.117 0.117 0.117 0.114 0.117 0.117 0.117 0.102 0.117 0.117 0.117 0.102 0.117 0.117 0.117 やり方がわからず悪戦苦闘しています、よろしくお願いします。
宿題と称してVBAの質問する人が増えてます。中学？高校？大学？専門学校？ 私の学生の頃はありませんでした。
VBScriptを使って Set WshShell = WScript.CreateObject("WScript.Shell") Call WshShell.Run( "taskmgr.exe", , True ) というコードでタスクマネージャーを開くことができます。 開くと同時に最小表示にしたいのですが どうすれば良いですか？
エクセルのマクロを使用してグラフを複数作成しています。作成したグラフのタイトルに番号をつけたいのですがわかりません。番号は１つ目のグラフに１、2つ目のグラフに２といった感じです。 教えてください。
仕事で製品の入出庫数とその使用期限の履歴をExcel管理したいと思っていますがコードがまだまだ理解不足のため教えて下さい。 以下のような基本動作を考えております。 ■入庫＆現在庫 ①ユーザーフォームのコマンドボタン1を押すとフォームで入力したデータ(品名:ｺﾝﾎﾞﾎﾞｯｸｽ・期限日付：ﾃｷｽﾄﾎﾞｯｸｽ)をフォームで指定した数の分だけ（1～多くて300～500とか）のレコードでSheet1（入庫・現在庫ｼｰﾄ）にいっぺんに登録。 ※削除されたデータがあった行は上方向に詰めていって歯抜けにならないようにしたいです。 ■出庫履歴 ②コマンドボタン2を押すと、入力した項目に該当するデータ（入庫と同じ）を、Sheet1に登録されたレコードから指定した数の分だけ削除して（VbOKCancelから)Sheet2（出庫履歴）のデータベースに削除した数の分だけレコードを登録。 ※品目と期限のデータチェックしてからの削除したいです。（該当データがなければメッセージを表示） ※また、各製品・期限が登録されているレコード以上の数が削除されないようにしたいです。 追記1：レコードが製品1ヶというふうに考えています。 追記2：できれば、それぞれのボタンを押すと1押しにつき登録したデータに簡単な追番をつけれれば…と思います（重複データだらけになるため） 何かいろいろ注文だらけで申し訳ありませんが、何卒、ご教授願います。
お世話になります。 4月から新社会人となり上司から課題を出されました。 内容はAccessでの売上管理システムなるもので、マクロは一切使わずVBAで組むというものです。 現在苦戦を強いられている箇所が以下になります。 売上入力フォームというものがありフォームの中にサブフォームが存在しているのですが、サブフォームからのデータ取得方法が分からず手詰まりな状態です。 通常のフォームからのデータ取得は「変数 = Me.フィールド名」として問題なく動作しております。 サブフォーム内のデータはクエリから表示をしています。 私自身も自分で何をしているのか理解が足りていないため稚拙な文章になってしまい申し訳ありません。 一応ですが現在のプログラムソースを貼り付けておきます。 ----プログラムソース---- Private Sub 保存_Click() Dim SQL1 As String Dim SQL2 As String Dim ID_k As Variant Dim Name_k As Variant Dim Date_u As Date Dim NO_u As Variant Dim NO_i As Variant Dim Name_i As Variant Dim Price As Currency Dim Count As Variant Dim Tax As Currency Dim Price_tax As Currency Dim Total As Currency On Error GoTo Err ID_k = Me.顧客ID Name_k = Me.顧客名 Date_u = Me.売上日 NO_u = Me.売上NO NO_i = Me.商品NO Name_i = Me.商品名 Price = Me.単価 Count = Me.数量 Tax = Me.消費税 Price_tax = Me.税込価格 Total = Me.合計 SQL1 = "INSERT INTO T_売上(顧客ID,顧客名,売上日) VALUES('" & ID_k & "','" & Name_k & "','" & Date_u & "');" DoCmd.RunSQL SQL1 SQL2 = "INSERT INTO T_売上詳細(売上NO,商品NO,商品名,単価,数量,消費税,税込価格,合計) VALUES('" & NO_u & "','" & NO_i & "','" & Name_i & "','" & Price & "','" & Count & "','" & Tax & "','" & Price_tax & "','" & Total & "')" DoCmd.RunSQL SQL2 DoCmd.RunCommand acCmdSaveRecord MsgBox "保存しました" Exit Sub Err: MsgBox "保存できませんでした" End Sub ---- よろしくお願い致します。
Function名に変数を使用する方法は、Application.Run しか知らないのですがこれでは 戻り値がえられません。 ご指導よろしくお願いいたします。 Sub TEST() Dim Prc_Name As String Dim i 　　 As Long Dim Rtn For i = 1 To 3 Prc_Name = "PRC_" & Trim(Str(i)) Application.Run Prc_Name '←'ここでFunctionからの戻り値を得たい Rtn = Application.Run Prc_Name '←これではエラーになります Next i End Sub Function PRC_1() As Boolean '処理 PRC_1 = 処理結果(True Or False) End Function Function PRC_2() As Boolean '処理 PRC_2 = 処理結果(True Or False) End Function Function PRC_3() As Boolean '処理 PRC_3 = 処理結果(True Or False) End Function
VB.NETでExcelファイルを出力するプログラムを作っています。 大きな表を作成するので、行・列名を固定させたいと考えているのですが、 調べてみても、VB.NETの方でウィンドウ枠を固定させる方法が見つかりません。 ご教授いただければ幸いです。 Dim oExcel As Excel.ApplicationClass = New Excel.ApplicationClass Dim oBook As Excel.WorkbookClass Dim oSheet As Excel.Worksheet oBook = oExcel.Workbooks.Add() oSheet = oBook.Worksheets(1I) oSheet.Cells("C3").~~~~~~~~ のようなコードで実装できないでしょうか？
お世話になっております。m(__)m 非連結のサブフォーム(データシート)に、新規行を追加したいです。 Sql = "select A.データ1,B.データ2,count(*) form A inner join B on ～ inner join c on ～ where ～ group by ～" forms!親!子.from.[データ1].ControlSource = "A.データ1" forms!親!子.from.[データ2].ControlSource = "B.データ2" forms!親!子.from.件数.ControlSource = "Expr1002" forms!親!子.from.RecordSource = Sql Me.子.SetFocus Me.子.AllowAddition = True ←コンパイルエラー DoCmd.GoToRecord , , acNewRec ←実行時エラー2105 指定したレコードに移動できません。 色々と試してみたのですが、初心者な者で原因が分かりません。 また、親フォームを開き直した時も、サブフォームのデータを保持していたいです。 親切な方、教えて下さい。m(__)m 宜しくお願い致します。
VBA勉強中です。 タイトルの通りですが、範囲内の複数セルの値を、1つのセルに結合したいのです。 さらに、条件設定できれば最高です。 いろいろ検索してみましたが、 functionで新たな関数を定義して、セルに直接関数を書き込む形の回答ばかりで、 思った通りに動きません。 やりたいことは以下の画像の通りで、いくつか注意事項があります。 注意事項） ・条件A～Cの数は一定ではありません。時にはDやEが追加されます。 ・1つの条件にあてはまる番号の数も一定ではありません。今回、Aに当てはまるものは3つでしたが、2つのときもあれば5つのときもあります。 説明が下手で申し訳ございません。 ご教授のほど、よろしくお願いします。
VBAを使っていて http://blog.goo.ne.jp/mumbai/e/dc90cf94fc40baebf … #If VBA7 Then Debug.Print "EXCELは2010以上です。" #Else Debug.Print("EXCELは2007以下です。") #End If というように、#IFというようなものが出てきます。 これの使用方法を知りたいのですが検索して調べたところ、 https://msdn.microsoft.com/ja-jp/library/tx6yas6 … このページに書かれてあるように #があるとコンパイル時にif文の評価を行うのに対し、 #がないとif文も含めてコンパイルした後に、プログラムを実行する時にif文の評価を行う といったことが書かれてあります。 それで試してみたのですが #If VBA7 Then aa=0 #Else aa=1 #End If というコードを実行するとaa=0が代入されます。 一方で If VBA7 Then aa=0 Else aa=1 End If というコードを実行するとVBA7がemptyになっており aa=1が代入されます。 これはVBA7という変数がコンパイル時にのみ有効で 実行時には存在しないためだからでしょうか？
VBA超初心者です。ネットで検索しながら、達人のものをコピペしながら少しづつ理解して、なんとかexcelを作っています。 しかし、今回、どうにもうまくできないので質問です。 下の様な表があった場合（goo表示の都合上空白は＿で記しています。） セルA1(20)、B1(空白)、C3(40)のみを対象に、 20は"good"、40は"bad"、空白は"エラー"に変換したい。 ＿ A B C 1 20 ＿ 40 2 20 20 ＿ 3 40 ＿ 40 ネットをごんごん調べてたどり着いた達人の書いたものが下記のとおりです。 Arrayの後に検索語と置換語を入れたら、上手く動きましたが範囲の指定をしようとした所でつまづいてます。 Set Set Rng = SelectionをRange("A1,C3")～～～などなど試してみましたが、どうも根本的に違うような。。。どうしたら良いのでしょうか。ご教授の程何卒よろしくお願い申し上げます。 Sub MultiReplacement() 　Dim MyWords As Variant 　Dim MyRepWords As Variant 　Dim Ans As Integer 　Dim Rng As Range 　MyWords = Array("A", "C") 'ここに検索語を入れてください。 　MyRepWords = Array(1, 2)　'ここに置換語を入れてください。 　'検索語と置換語を調べる 　If UBound(MyWords) <> UBound(MyRepWords) Then 　　MsgBox "検索語数( " & UBound(MyWords) & _ 　　" )と置換語数( " & UBound(MyRepWords) & " )数が違います。", 64 　　Exit Sub 　End If 　 　Set Rng = Selection 'マウスで範囲を選択してください。 　If Rng.Count = 1 Then 　　Ans = MsgBox("セル１つしか選択されていませんが、よろしいですか？", vbYesNo) 　　If Ans = vbNo Then 　　　Exit Sub 　　End If 　End If 　'実行 　For i = LBound(MyWords) To UBound(MyWords) 　　Cells.Replace What:=MyWords(i), Replacement:=MyRepWords(i), _ 　　LookAt:=xlPart, _ 　　MatchCase:=True 　Next i End Sub
宜しくお願いします。 セルの表示設定で.NumberFormatLocal＝”0.00％” を使いたいのですが、わかりません。 このコード中、どこで指示すればよいでしょうか？ ================================================== Dim xFormula As String, rng As Range Const cFormula1 As String = "=SUM(@@)" Const cFormula2 As String = "=@1/@2" With Columns(1).SpecialCells(xlCellTypeConstants) Set rng = .Cells(.Count).Offset(2, 1) rng.NumberFormatLocal = "\#,##0;\-#,##0" rng.Formula = Replace(cFormula1, "@@", .Offset(, 1).Address(False, False)) xFormula = Replace(cFormula2, "@2", rng.Address) xFormula = Replace(xFormula, "@1", .Cells(1).Offset(, 1).Address(False, False)) .Offset(, 2).Formula = xFormula 　　　　↑ 　　　　｜ 　　　　｜ ここに表示される結果に対して【rng.NumberFormatLocal = "0.00%"】 を入れたい。 End With 宜しくお願い致します。
オプションボタンをクリックしてテキストを切り替えたいのですがどうしたら切り替わりますか？
Access2010のサブフォームで、データシート形式で埋め込んでいます。 項目は「個社」「ファイル名」「件数」です。 Me.SUB_kekka.個社 = kosya_Name Me.SUB_kekka.ファイル名 = myFilename Me.SUB_kekka.件数 = dataVolume では上手く入力出来ません。 どなたか、親切な方、教えて下さい。m(__)m また、2レコード目への移動の仕方も教えて下さい。 宜しくお願い致します。
マクロ初心者です、パスからファイル名を指定する際にファイル名に変数入れたいのですが変数認識してくれず困っています。 どなたか、どういう風にすれば変数認識するのかご教示お願いします。 '指定額の抽出 Private Const MESSAGE_START = "ファイルの読み込みを開始します" & vbCrLf & "フォルダを選択してください。" Private Const MESSAGE_FINISH = "ファイルの読み込みが完了しました" Sub テキスト出力() '------------------------------------------------------------------------------------------------------- '処理開始 '------------------------------------------------------------------------------------------------------- MsgBox MESSAGE_START ' With Application.FileDialog(msoFileDialogFolderPicker) If .Show = 0 Then Exit Sub Fol = .SelectedItems(1) End With Application.ScreenUpdating = False Dim Fn Dim Wb As Workbook '開始行の指定（データ最終行の次の行 Dim n n = Cells(Rows.Count, 1).End(xlUp).Row + 1 'セットするシートの指定 Dim w Set w = Worksheets(1) Dim a As Variant 'ファイル名（拡張子なし）を取得するためのFileSystemObjectオブジェクト - GetBaseNameメソッド Dim FSO As Object Set FSO = CreateObject("Scripting.FileSystemObject") Fn = Dir(Fol & "\*.xls*") Do Until Fn = "" Set Wb = Workbooks.Open(Fol & "\" & Fn) Wb.Unprotect ActiveSheet.Unprotect w.Range("a" & n).Value = n - 5 w.Range("b" & n).Value = FSO.getbasename(Fn) a = FSO.getbasename(Fn) w.Range("c" & n).Value = Wb.Worksheets("R3取込シート").Range("h26").Value w.Range("a" & n).Resize(1, 3).Borders.LineStyle = xlContinuous n = n + 1 ' Application.DisplayAlerts = False Wb.Worksheets("R3取込シート").Copy '↓ここのパスが今の時点でエラーなんです ActiveWorkbook.SaveAs Filename:="D:\Library\Desktop\新しいフォルダー\"a"&".txt"" _ , FileFormat:=xlText ActiveWindow.Close Wb.Save ' Application.DisplayAlerts = True Wb.Close savechanges:=False Fn = Dir Loop Range("A4").Select MsgBox MESSAGE_FINISH End Sub
ユーザーフォームの中にマルチページをつくりそこにWindows Media Playerを貼り付けたのですがそこからどうすれば自分が保存した.wmvの動画を再生させることができますか？
教えてください。 web上の画面をドラッグして、コピーしたあと、EXCELに貼り付けた時、 入力フォーム？テキストボックス？の部分が、 デザインモードにして選択すると、コントロール1　コントロール2・・・・・となっています。 この中にあるテキストを出力したいのですが、どんな方法がありますでしょうか。 コントロール1内の文字列=B2に コントロール2内の文字列=B3に 　　　　・ 　　　　・ 　　　　・ という順番でセル内に文字列を抽出できるような方法が知りたいです。 vbaでできますでしょうか。 ご教授願います。
ユーザーフォームでオプションボタンをクリックして画像を切り替えるときのソースコードを教えて欲しいです。画像はexcelのシートにハイパーリンクで貼り付けてあります。 明日までにお願いします。
Excelで「Sheet1」の任意の行を「Sheet2」へ移動させるマクロを考えています。 以下の通り、ユーザーフォームのテキストボックスに 移動させたい行番号を入力し、ボタンを押して実行するようにしたのですが 上手くいきません。 【原因】 用意したテキストボックス15個(表記は5個に省略)、 全てに数字を入れれば動くのですが、空白があるとエラーになってしまいます。 【質問】 1)テキストボックスに空白があっても(移動させたい行数が15に満たなくても) エラーにならない方法はありますでしょうか？ 2)非連続行の「切取り」が出来なかった為、「コピー後に削除」の方法を 取っていますが、他にやり方はありますでしょうか？ 以上、宜しくお願い致します。 -------- Private Sub CommandButton1_Click() Set 選択1 = Cells(UserForm1.TextBox1.Value, 1) Set 選択2 = Cells(UserForm1.TextBox2.Value, 1) Set 選択3 = Cells(UserForm1.TextBox3.Value, 1) Set 選択4 = Cells(UserForm1.TextBox4.Value, 1) Set 選択5 = Cells(UserForm1.TextBox5.Value, 1) Set 削除選択 = Union(選択1, 選択2, 選択3, 選択4, 選択5) 削除選択.EntireRow.Select Selection.Copy Sheets("Sheet2").Select Range("A1").Select ActiveSheet.Paste Range("A1").Select Sheets("Sheet1").Select Application.CutCopyMode = False Selection.Delete Shift:=xlUp Range("A1").Select Unload UserForm1 End Sub -------
お世話になります。 午前中に似た様な質問をさせて頂いたのですが、苦闘しており お知恵を拝借したく再度質問を致します。 以下の様なコード（一部）でset myRng の値だけ（もしできればA列～F列まで） workingsheet に貼り付けたいのですが、どのように修正を 行えばよいでしょうか？　よろしくお願い致します。 lastRow = .Cells(Rows.Count, "A").End(xlUp).Row ' lastCol = .Cells(1, Columns.Count).End(xlToLeft).Column ' Set myRng = Range(.Cells(2, "A"), .Cells(lastRow, lastCol)).SpecialCells(xlCellTypeVisible) myRng.Copy wS.Cells(Rows.Count, "A").End(xlUp).Offset(1) 本日中には補足やお礼をできないかもしれませんが、 何卒よろしくお願いします。
お世話になります。VBA 初心者です。 以下のコードを、タイトルにあります通りmaRng の値だけを worksheet に貼り付けたいのですが、どのように修正すれば よいですか。 myRng.Copy wS.Cells(Rows.Count, "A").End(xlUp).Offset(1) よろしくお願い致します。
本来webbrowserはIEの設定を使ってプロキシを使うようなのですが、IE設定とは切り離してプログラム個別でプロキシ経由でwebbrowserを使う方法はありませんでしょうか？ ちなみにプロキシは認証付きプロキシを使おうと思っております。 ※IP：ポート:ユーザー名:PASS 何卒宜しくお願い致します！
Access2010のVBAで動的コントロールにてオプショングループと複数のオプションボタンを作成したいです。 デザインモードでフォームを開き DoCmd.OpenForm "フォーム1",acDesign セレクト文で、SQLArrayに結果を代入 intdataX = 2850 intdataY = 3190 オプショングループの作成 Set ctlOpGroup = CreateControl("フォーム1",acOptionGroup, ,"","",intDataX,intdataY, 300,(RECCnt * 300)) intdataX = intdataX + 50 intdataY = intdataY + 50 For i = 0 To UBound(SQLArray,2) Set ctlOption = CreateControl("フォーム1", acOptionButton, , "", "",intdataX + 300,intdataY, 5000,300) SetctlLabel = CreateControl("フォーム1", acLabel, , "", "", intdataX + 300,intdataY,5000,300) ctlLabel.Caption = SQLArray(0, i) intdataY = intdataY + 300 Next i 上記だと、全てのラジオボタンが選び放題なので、オプショングループを効かせたいです。 また、各オプションボタンのオプションバリューの値を設定したいのですが、方法が分かりません。 どなたか、親切な方、教えて下さい。m(__)m 宜しくお願い致します。
Excelのシートに、管理・スケジュール・リストというシートが3つほどあったとします。 その中で管理・リストというシートの削除・移動・名前変更等を行おうとした際に、警告メッセージを表示し、許可しないように制御をかけるにはどのようにマクロを組めばよいのでしょうか？ （シートの保護を使わずに、VBAで実現したい。ただしシート内は自由に編集ができる。） そのブックExcelファイルを開いた時に有効になるので VBAProject＞Microsoft Excel Objects＞ThisWorkBookにて、 Private Sub Workbook_Open()　・・・と続くと思いますが、実現できるコードをご教授のほどお願いいたします。
C#でテキストボックスとスクロールバーをバインディングしていて、更にエラープロバイダーをセットしエラーメッセージが出るようになっていてe.cancel=trueを書いています。 やりたいことは、テキストボックス空欄でタブを押下したときにエラーメッセージがでてe.cancel=trueが反応し動作できなくなることです。 現在、テキストボックス空欄でタブを押したときにエラーメッセージは出ますがe.cancel=trueが反応せず、テキストボックス内が空欄→0になり進んでしまいます。 ちなみにバインディングしているスクロールバーの最小値は0に設定しています。 是非ともご教授お願いします(._.)
マクロによるデータの区切りについてです。 A001,A002,A003 B001 C001,C002 という風になっているものをカンマごとに分けていき、 B4からデータがありデータがなくなるまで処理を続けてほしいのですが、 どういったマクロを組めばいいでしょうか？ テンプレとして使用するためボタンで動くようになるととても簡単になるのですが... Ver.2003です。 回答よろしくお願いします。
○　あ　い　う 0　5.7　3.8　8.8 2　3.7　4.8　4.8 4　4.4　1.5　4.2 6　2.5　7.7　4.8 8　9.7　9.0　4.1 10　3.6　7.0　4.3 12　1.6　5.8　4.3 14　4.9　4.8　4.8 ・・・ タブ区切りのテキストファイルの中に 上記のように4列で数値が入っています。 一行目にタイトルが入っており、 一列目に横軸の値 二行目以降の２～４列目に縦軸の値が入っています。 これをエクセルファイルに読み込んで 散布図グラフを作成するプログラムをVBAで作りたいんのですが どのようにすれば良いでしょうか？
エクセルVBAでテキストボックスが20個あります。これにデータを挿入するのにTestbox1からTextbo２０まで　for next で回すようなことはできませんか？ for i=1 to 20 textbox(i)=deta(i) next というようにしたいのですがこれはエラーになるので困っています。 どなたかやり方があれば教えてください。
お世話になります。 Win7+VS2015を使用しています。 クラスをNewして使用する時は 　Dim x as MyClass = New MyClass() Call x.myProcess() 　x = Nothing などとしますが、以下でも出来ました。 　Call (New MyClass).myProcess() 下のパターンで呼び出した場合、 インスタンスが破棄されるタイミングはいつなのでしょうか。 （DisposeされてGCに回収されるマークが付くのはいつなのでしょうか。）
マクロを使用してグラフを複数作りたいのですがマクロを使ったことがなくわかりません。 データは１０列２１６０行あります。 １列目を横軸にした散布図を７２０行ごとに３つ作成したいのですがどのようにマクロを作ればいいのでしょうか？
Access2010でサブフォームのフレームを非表示にする方法を教えて下さい。m(__)m
はじめまして。 TSVデータをAccessのテーブルに取り込み、Excelにもデータ出力はできるのですが確認のためにAccessのテーブルからテキストデータに出力するとデータは確認できるのですが、ところどころに(”A”)のようにダブルコーテーションが入っています。 ダブルコーテーションを表示させないコード等がありましたら教えていただけたらと思います。
C４～C１８のセルの範囲で、ダブルクリックをした順番に数字が出るようにしたいです。 例：C4でダブルクリック→C１でダブルクリック→C９でダブルクリック→C18でダブルクリック 表示：C４は１、C1は２、C9は３、C１８は４と表示させる動作です。 もしここでC1の２を消すと、C9は２、C18は３と消した物に準じて番号が変わり、番号の空白はなくしたいです。また、C１７に数字の３をいれると、手入力した数字を優先して、C９は４、C１８は５にする動作も起こしたいです。逆にC１７に６とかいう数字を入力した場合は、５がないので上の例の表示はそのまま無視して表示されたままの感じです。 なかなか質問の意図がわかりづらいと思いますので、その点については適宜補足いたします。 非常に難しく私の力では全くマクロが組めませんでした。マクロをご教授いただけると幸いです；
すみまでんが、どなたか教えていただきたく。 別のVBAを使い、順番に果物の名前をバーコード入力すると 選択された果物の名前のセルに、色が付いていくようになっています。 やりたいことは、その 入力されている行にあるセルにすべてに色がついた時点で Bの列に、○が自動で付くようにしたいのです。 （例）順にりんご、みかん、ぶどうがバーコードで入力された場合 どうかよろしくお願いします。
Access2010で、Accessのテーブル一覧を取得して プルダウンに表示したいです。 教えて下さい。m(__)m
いつも拝見させていただいています。 C#を使っていてどうにも進まなくなりご教授願いたいです。 よろしくお願いいたします。 テキストボックスに４桁の数字のみ入力させることはできたのですが、0を４回押して（0000）TABを押すと0000で入力が通ってしまいます。 0001→0001 0123→0123で通ります。 １、0を始めに入力できないように４桁入力できる制限 ２、0000を入力してTAB押すとテキストボックス内が0になる制限 どちらか、あるいは別の方法でやり方あればご教授よろしくお願いいたします。
ExcelVBAを使ってこのようなものを作りたいと思っています A1に1　B1に200　C1にテストと入力されたら E1にあらかじめ用意された文の一部にA1 B2 C1に入力された物を入力させること ってできますか？できるのならやり方を教えてください!!分かりづらくてすいません VBA初心者です
こんにちは、宜しくお願いします。 （Visual Basicのカテゴリに失礼します。） 添付画像のような表があったとして、A1～C1までと、A8～C8までは文字が入るとします。 その文字がABAと表示されたら、すぐ3つ下のセルまでに斜線を引きたいと思っています。 過去の質問を参考に頑張って考えてみた結果、 Sub AAAに罫線() Dim c As Range '一旦斜罫線無しの状態にする Range("A1:C1").Offset(1, 0).Borders(xlDiagonalDown).LineStyle = xlNone Range("A1:C1").Offset(2, 0).Borders(xlDiagonalDown).LineStyle = xlNone Range("A1:C1").Offset(3, 0).Borders(xlDiagonalDown).LineStyle = xlNone Range("A8:C8").Offset(1, 0).Borders(xlDiagonalDown).LineStyle = xlNone Range("A8:C8").Offset(2, 0).Borders(xlDiagonalDown).LineStyle = xlNone Range("A8:C8").Offset(3, 0).Borders(xlDiagonalDown).LineStyle = xlNone 'AAAなら1行下～3行下までのセルに斜罫線を表示 For Each c In Range("A1:C1,A8:C8") If Format(c.Value, "aaa") = "ABA" Then c.Offset(1, 0).Borders(xlDiagonalDown).LineStyle = xlContinuous c.Offset(2, 0).Borders(xlDiagonalDown).LineStyle = xlContinuous c.Offset(3, 0).Borders(xlDiagonalDown).LineStyle = xlContinuous End If Next End Sub 自信はありませんが、こんな感じで動きはしたのですが、もう少しコンパクトに なるのではないかと思い質問してみました。 なにぶん初心者ですので、おかしな所があると思います。 添削していただけないでしょうか。 宜しくお願いいたします。
VBA初心者ながら、顧客管理用に入力フォームなどを作っています。 検索フォームを作成し、名前や住所などをキーワードに実行ボタンを押して検索すると、顧客シートからデータを引っ張ってきて、検索フォームの下に対象リストが表示されます。（今回の場合は顧客シートのNo１、12、17のデータを引っ張ってきています。） そこから、イメージとしては、画像のように３件結果が出力された内、一番上の検索結果をクリックすると、入力フォームに選択した対象者の情報が表示されるようなことをしたいのですが、何から手をつけたらよいかがわかりません・・・。 ちなみに、検索フォームに表示される値は、実際の入力フォームに入力する項目より少ない（例えば、入力フォームでは「ふりがな」がありますが、検索フォームに検索結果としては「ふりがな」は表示されていません。） かなり大雑把な質問ですが、アドバイスなど頂けると幸いです。
CSVファイルで項目にダブルクオーテーションを付与した形で作成しなければいけません。 エクセルファイルから上記条件のCSVに変更する方法はありますか？ ちなみに他にも条件があります。 見出し無し、改行コード（ＣＲ／ＬＦ）付与、シフトＪＩＳコード、全項目半角 エクセルからCSV作成するためにマクロを書いています。 もし可能ならマクロに上記条件のプログラムを書くことってできますか？ ご教授のほどよろしくお願いいたします。 マクロ ================================================== Sub CSV作成() Dim myFileName myFileName = Application.GetSaveAsFilename(FileFilter:="CSVファイル (*.csv,*.csv") If TypeName(myFileName) = "Boolean" Then Exit Sub Application.ScreenUpdating = False Range("A2:N73").Copy With Worksheets.Add .Cells(1, 1).PasteSpecial Paste:=xlPasteValues .Move End With With ActiveWorkbook .SaveAs Filename:=myFileName, FileFormat:=xlCSV .Close False End With Application.ScreenUpdating = True End Sub ============================================= ちなみにＧ列はyyyy/mm/dd, Ｈ列はyyymm形式で表記したいのですが、 CSVファイルに抽出すると単なる数字の羅列になってしまいます。 ダブルクオーテーション付与にしたらこれも解決されるのでしょうか。 ご指導よろしくお願いいたします！
初心者ですエクセルマクロでデータ抽出したいですがファイルによって読込できません、何か問題ありますか？ちなみにファイル名は読み込めますが、データ読み込みでエラーになるようです。 実行時エラー'9' インデックスが有効範囲にありません。 Sub ExcelbookCombine() '------------------------------------------------------------------------------------------------------- '処理開始 '------------------------------------------------------------------------------------------------------- MsgBox MESSAGE_START With Application.FileDialog(msoFileDialogFolderPicker) If .Show = 0 Then Exit Sub Fol = .SelectedItems(1) End With Dim Fn ' Dim NewFile As Workbook Dim Wb As Workbook 'Dim Ws1 As Worksheet Dim R As Range Dim SrcRng As Range Dim Rng As Range '開始行の指定（データ最終行の次の行 Dim n n = Cells(Rows.Count, 1).End(xlUp).Row + 1 'セットするシートの指定 Dim w Set w = Worksheets(1) 'ファイル名（拡張子なし）を取得するためのFileSystemObjectオブジェクト - GetBaseNameメソッド Dim FSO As Object Set FSO = CreateObject("Scripting.FileSystemObject") Set SrcRng = ActiveSheet.Range("B4") Set Ws1 = Worksheets(1) Set R = Ws1.Range("A2") Fn = Dir(Fol & "\*.xls*") Do Until Fn = "" Set Wb = Workbooks.Open(Fol & "\" & Fn) 'ワークシート1をコピーする場合は Wb.Worksheets(1) 'Set Ws2 = Wb.Worksheets(3) ' '' '各所の値をコピーしてa～gにセットする ' ActiveSheet.Unprotect w.Range("a" & n).Value = FSO.getbasename(Fn) 'この下の行がエラー時に反転します w.Range("c" & n).Value = Workbooks(Fn).Worksheets(3).Range("b3").Value w.Range("d" & n).Value = Workbooks(Fn).Worksheets(3).Range("o6").Value w.Range("e" & n).Value = Workbooks(Fn).Worksheets(2).Range("aa3").Value w.Range("f" & n).Value = Workbooks(Fn).Worksheets("指定額").Range("cj3").Value w.Range("g" & n).Value = Workbooks(Fn).Worksheets("指定額").Range("b5").Value w.Range("h" & n).Value = Workbooks(Fn).Worksheets("指定額").Range("o5").Value w.Range("i" & n).Value = Workbooks(Fn).Worksheets("指定額").Range("b7").Value w.Range("j" & n).Value = Workbooks(Fn).Worksheets("指定額").Range("cj55").Value w.Range("a" & n).Resize(1, 10).Borders.LineStyle = xlContinuous n = n + 1 Workbooks(Fn).Close savechanges:=False Fn = Dir Loop Range("A4").Select MsgBox MESSAGE_FINISH Set R = Nothing Set Ws1 = Nothing: Set Ws2 = Nothing Set Wb = Nothing: Set NewFile = Nothing End Sub
改めて質問させて頂きます。 https://oshiete.goo.ne.jp/qa/9295594.html の質問者です。　 この課題でtom04さんの分かりやすいご回答で解消しましたが、 コピーする際にコピー先へ値のみコピーするようにする場合は、 どのような記述が追記になってくるのでしょうか？（パターン1とパターン2の場合） 【パターン1】SheetシートのA行を統計シートのB行へ、SheetシートのD行を統計シートのF行へ If .Cells(Rows.Count, "A").End(xlUp).Row > 1 Then maxRow = wS.UsedRange.Rows.Count + 1 Range(.Cells(2, "A"), .Cells(lastRow, "A")).Copy wS.Cells(maxRow, "B") Range(.Cells(2, "D"), .Cells(lastRow, "D")).Copy wS.Cells(maxRow, "F") wS.Range("A1").CurrentRegion.Borders.LineStyle = xlContinuous 【パターン2】Sheetシートから統計シートへそのまま同じ行にコピーする。 If .Cells(Rows.Count, "A").End(xlUp).Row > 1 Then myRng.SpecialCells(xlCellTypeVisible).Copy wS.Cells(Rows.Count, "A").End(xlUp).Offset(1) wS.Range("A1").CurrentRegion.Borders.LineStyle = xlContinuous 何度も恐縮ですが、ご教授のほどお願いいたします。
会社で契約書の終了日を見て、終了日の3か月前になったらそのデータを別シートに抽出できるようにマクロを考えています。 マクロの記録といろいろ調べ、一度下記のマクロを作成し、テストしたところうまくいったのですが、本番環境でマクロを利用したところエラーが出て利用ができませんでした。 テスト環境と本番環境で大きく違うのが、タイトル行（画像だと4-5行目）が2行になっており、ほとんどのセルでセルの結合がされているとこかと思います。 普通にオートフィルターをかえても4行目（上の行）にフィルターがかかってしまい、5行目でオートフィルターが利用できません。（一度解除してやり直してみましたが、結果は同じ4行目にフィルターがかかりました） Sub 更新確認マクロ() ' Selection.AutoFilter Range("A4").CurrentRegion.AutoFilter Field:=11, Criteria1:="Check" Range("A4").CurrentRegion.Copy Sheets("Sheet2").Range("A1") Selection.AutoFilter これをタイトル行が2行ある場合のVBAの書き方などヒントも含めあれば教えていただけないでしょうか。 VBA初心者でいくつか調べてみたのですが、どれもうまくいかず。。。 よろしくお願いします。 Windows7／Excel2010利用
お手上げバンザイです。どうか助けて下さい。 以前教えていただきありがとうございました。後少し　どうかしたいのですが頭賢くないです。詳しく教えて下さい。 主C列に入力するとB列に1からの連番が出てJ列に入力時間が出る様にC列とF列にカーソル移動 G行からAA行はセルに文字や数字が入っているならならそのままでセルが空なら1つ上をコピーペーストして行を埋める様にしたいのですがどのように入れ込んだら良いのか教えて下さい。 Private Sub Worksheet_Change(ByVal Target As Range) Dim rng, r As Range Dim i As Integer, j As Integer If Intersect(Target, Range("C8:C47,F8:F47")) Is Nothing Then Exit Sub Application.EnableEvents = False If Target.Column = 3 Then Set rng = Intersect(Target, Range("C8:C47")) If rng Is Nothing Then Exit Sub For Each r In rng If r.Value <> "" Then Range("J" & r.Row).Value = Format(Now(), "hh:mm") Else Range("J" & r.Row).ClearContents End If Next r j = 6 Else j = 3 End If For i = 8 To 47 If Cells(i, j).Value = "" Then Cells(i, j).Select Exit For End If Next i Application.EnableEvents = True End Sub
下記ページ　billyboyさんのサンプルプログラムを参照させて頂きました。 http://vba-geek.jp/blog-entry-314.html このとおりに、取得したいコンピュータ名もしくはIPアドレスを設定シートに入力し VBAを実行しましたが、イベントログが取得できませんでした。 該当PCにはpingもリモートデスクトップもできます。ファイアウォールも全て無効にしています。 一体何が原因なのでしょうか？　このようなログを取得しExcelにデータ化するにはどのように すれば良いでしょうか？
毎日CSVファイルをテキストファイルとして読み込んで処理をする作業をしたいのですが、そのファイルは毎日名前が変わります。そのため、そのマクロを実行するための同じフォルダの中に写して、名前を１に変更させて処理するようにしているのですが、もっと簡単にそのCSVファイルの名前を変更しなくても、また、同じフォルダに移さなくても読み込んで処理するようなマクロを組むことは可能でしょうか？マクロの記録でしかできないレベルなので困っています・・ちなみにその処理の最初だけ抜粋すると以下のとおりです。 With ActiveSheet.QueryTables.Add(Connection:= _ "TEXT;" & ThisWorkbook.Path & "\1.csv" _ , Destination:=Range("$A$2")) .Name = "1" .FieldNames = True .RowNumbers = False .FillAdjacentFormulas = False .PreserveFormatting = True ・・・・
こんにちわ、以前もここで質問させていただいたのですが、未完成なので再度質問させてください。 以前と違い、初日の部分を表を作りそこからとれるようにしました。 一、開催場所別にシートを分けているので、それぞれ会場のシートに１２レース分表示したい(A１セル１レース目、E１セル２レース目...と順に横にずれてほしいです)。 一、開催場所でレースがない場合は、webサイト自体ない(エラーが起きる)のでwebサイトがないエラーが起きた時には、A1セルに本日のレースはありませんと表示したい 一、レース番号は引数取得ではなくループ処理にしたいのですが、For Lng_レース = 1 To 12これをどこに入れればいいか、わかりません。 -------------------------------------------------------------- 以前、GooUserラックさんに作っていただいたVBAを自分なりに、模索しながらいじってみたのですが、どうしてもできませんでした。 Sub データ抽出(Day_日付 As Date, Lng_場 As Long, Lng_レース As Long) Dim Str_アドレス As String Dim Day_初日 As Date Day_初日 = Day_日付 - Weekday(Day_日付, vbTuesday) + 1 Str_アドレス = "FINDER;http://app.boatrace.jp/race/01_" & Format(Day_初日, "yyyymmdd") Str_アドレス = Str_アドレス & ".php?day=" & Format(Day_日付, "yyyymmdd") Str_アドレス = Str_アドレス & "&jyo=" & Format(Lng_場, "00") Str_アドレス = Str_アドレス & "&rno=" & Format(Lng_レース, "00") & "&type=program" Sheets("作業").Select Cells.Delete Shift:=xlUp With ActiveSheet.QueryTables.Add(Connection:=Str_アドレス, Destination:=Range("A1")) .Name = "Data" .FieldNames = True .RowNumbers = False .FillAdjacentFormulas = False .PreserveFormatting = False .RefreshOnFileOpen = False .BackgroundQuery = False .RefreshStyle = xlInsertDeleteCells .SavePassword = False .SaveData = True .AdjustColumnWidth = True .RefreshPeriod = 0 .WebSelectionType = xlEntirePage .WebFormatting = xlWebFormattingAll .WebPreFormattedTextToColumns = True .WebConsecutiveDelimitersAsOne = True .WebSingleBlockTextImport = False .WebDisableDateRecognition = False .WebDisableRedirections = False .Refresh BackgroundQuery:=False End With End Sub -------------------------------------------------------------- を自分なりにアレンジしたデータ -------------------------------------------------------------- Sub 桐生(Day_日付 As Date, Lng_場 As Long, Lng_初日 As Long) Dim Str_アドレス As String For Lng_レース = 1 To 12 Str_アドレス = "FINDER;http://app.boatrace.jp/race/" & Format(Lng_レース, "00") Str_アドレス = Str_アドレス & "_" & Format(Lng_初日, "yyyymmdd") Str_アドレス = Str_アドレス & ".php?day=" & Format(Day_日付, "yyyymmdd") Str_アドレス = Str_アドレス & "&jyo=" & Format(Lng_場, "00") Str_アドレス = Str_アドレス & "&rno=" & Format(Lng_レース, "00") & "&type=program" Sheets("桐生").Select Cells.Delete Shift:=xlUp With ActiveSheet.QueryTables.Add(Connection:=Str_アドレス, Destination:=Range("A1")) .Name = "Data" .FieldNames = True .RowNumbers = False .FillAdjacentFormulas = False .PreserveFormatting = False .RefreshOnFileOpen = False .BackgroundQuery = False .RefreshStyle = xlInsertDeleteCells .SavePassword = False .SaveData = True .AdjustColumnWidth = True .RefreshPeriod = 0 .WebSelectionType = xlEntirePage .WebFormatting = xlWebFormattingAll .WebPreFormattedTextToColumns = True .WebConsecutiveDelimitersAsOne = True .WebSingleBlockTextImport = False .WebDisableDateRecognition = False .WebDisableRedirections = False .Refresh BackgroundQuery:=False End With Next End Sub 回答よろしくお願いいたします。
Excel VBAにて例えばA列の行に A B C と文字列があるとします。 それを A→　良好 B→　普通 C→　不可 などと文字変更置き換えするには、どのようなコードを組めばよろしいでしょうか？ ちなみにA列の行は文字データが入っている行を判定して文字置き換えをするものとします。 （例えば、2行目～10行目までデータが入っているのを判定して文字置き換えをする） IF関数等で別セルには簡単にできますが、VBで簡単に処理したいです。 当方、初心ですがご教授頂けると助かります。 よろしくお願いいたします。
①EXCELフォーム自動的に起動させる方法がわからず困っています。 いろいろ本を見て自動オープンの方法を試しているのですが起動しません。まずわからない点は、フォームやモジュールを作るとエクスポートして保存します。その保存したフォームやモジュールをインポトしなくても自動起動するのでしょうか? エクセルを開いてフォームやモジュールはあらかじめ手動で インポートしてから使うものなのでしょうか? ②フォームのタブストリップに表データを表示させるVBAがわかりません。コーディグのサンプルをみてやっているのですが、デバッグでどうしてもエラーしてしまいます。エラーメッセージはオブジェクトが必要ですとか値が0等が出てきます フォームやその中のタブストリップなどと、エクセルの表との関係性をどこかで示すのでしょうか?プロパティの中にあらかじめ表のシートの名前などを書いておくのでしょうか?コンボボックスなどはその方法でデータがでてきましたがタブストリップでそうしますとタブごとに違う表データを表示できません。
添付図を参照してください。 元データがある表（シート名：統計）へ（シート名：Sheet1）にあるオートフィルタで抽出したデータを統計 シートの最終行を判断して、Sheet1のA列とD列の該当のデータのみをコピーして シートの最終行から貼り付けをするマクロを作成したいです。 最終行を判断するには、 Range(Selection, Selection.End(xlDown)).Select　など記述すべきかと思いますが、 あくまでSheet1の抽出したデータ行は15行までではなくデータにより様々な行数を取得するようにしたいです。Range("A2", Range("A2").End(xlDown)).Select　など？ すいませんが、ご教授頂きますようお願いいたします。
visual studio2012を使ってプログラミングを練習しています。 そこで、6桁の数字を桁毎に分けて表示する方法がわかりません。たとえば、123456という６桁の数字があったとすれば、lbl1＝1,lbl2＝2,lbl3＝3,lbl4＝4,lbl5＝5,lbl6＝6のように順番にlblの中にばらばらに入れていきたいのです。どのような式を書けばいいのか、教えてください。
お世話になります。 デスクトップの「ABC」フォルダ内に複数のエクセルシートがあり 各エクセルシートの　A2欄に　日付データが記載されているのですが エクセルVBAでA2欄ある日付情報をファイル名にして デスクトップの「DEF」フォルダに保存したいと思っています。 VBAで可能でしょうか？ またどのような記述をすればよろしいでしょうか？ ご教示いただければ幸いに存じます。
インターネットから参照したコードを使用して検索フォームを作成しました。 動くは動くのですが、以下のような不具合が発生してにっちもさっちもいきません。 使用している検索フォームに関連するコードですが、どこがおかしいのでしょうか？ VBA初心者のため、どなたか教えてください。 不具合：ﾃｷｽﾄﾎﾞｯｸｽで品目の一部分を入力し、データを絞り込むと2列目のデータとタイトルがリストに表示されません ■ｺｰﾄﾞ 'フォームを開いた時の処理 Private Sub UserForm_Initialize() Dim wLastGyou As Long '最終行番号を取得 wLastGyou = Worksheets("Sheet1").UsedRange.Rows.Count 'リストボックスに「品目」のリストをセット With ListBox1 .ColumnCount = 2 .ColumnWidths = "100;20" .ColumnHeads = True 'リストボックスの値にセルA2からA最終行までセット .RowSource = "Sheet1!A2:B" & wLastGyou End With End Sub '検索用のテキストボックス更新後の処理 Private Sub TextBox1_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean) Dim Obj As Object Dim wAddST As Variant Dim wAddress As Variant Dim wKamoku As Variant With Worksheets("Sheet1") 'テキストボックスの値が含まれるセルを検索 Set Obj = .Cells.Find(what:=TextBox1.Value, _ LookIn:=xlValues, _ lookat:=xlPart, _ matchbyte:=False) '検索対象がない場合はメッセージを表示 If Obj Is Nothing Then MsgBox "対象科目は存在しません。", _ vbOKOnly + vbInformation, "検索" Else 'リストボックスをクリア ListBox1.RowSource = "" '検索にヒットした先頭のセルのアドレスをセット wAddST = Obj.Address '検索の繰り返し処理 Do '検索にヒットしたセルのアドレスをセット wAddress = Obj.Address '検索にヒットしたセルの値を取得 wKamoku = .Range(wAddress).Value 'リストボックスに追加 ListBox1.AddItem wKamoku '次の検索を行う Set Obj = .Cells.FindNext(Obj) '最初にヒットしたアドレスと同じ場合は処理を終了 If Obj.Address = wAddST Then Exit Do Loop End If End With End Sub '検索リストボックス内のデータをダブルクリックするとシートのデータを選択します。 Private Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean) Dim V As String Dim rngFind As Range V = Me.ListBox1.Value With Worksheets("Sheet1").Range("A:A") Set rngFind = .Find(what:=V, LookIn:=xlValues, _ lookat:=xlWhole, MatchCase:=False, matchbyte:=False) If Not rngFind Is Nothing Then .Worksheet.Parent.Activate .Worksheet.Activate rngFind.Select End If End With End Sub
エクセルでマクロを組み始めたばかりの者です。下記のようなマクロを組んでみましたが、27行目もしくは41行目のActiveSheet.Pasteで「実行時エラー‘1004‘： 変更しようとしているセルまたはグラフは保護されているため読み取り専用となっています…」というエラーメッセージが出て止まってしまいます。 しようとしている内容は、転送ボタンを押し各シートの指定セルへ一括転送（コピー）をしたいのです。 その際、転送先はシート保護をしておきたいのです。 エラーはエクセル2010で確認しましたが、職場のＰＣを使用するため2007や2003等他のバージョンを利用する可能性もあります。また、仕事で使用するため早急に使わなければならず焦っています。 Option Explicit Private Sub CommandButton2_Click() Call Macro2 End Sub Sub Macro2() Workbook.Open Filename:=”K:¥共有¥○○○.xlsm” ActiveSheet.Unprotect ThisWorkbook.Activate Range(”D4:G20”).Select Selection.Copy Windows(”○○○.xlsm”).Activate Range(”E7”).Select ActiveSheet.Paste Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Save ActiveWindow.Close Application.CutCopyMode = False Workbook.Open Filename:=”C:¥Users¥Desktop¥×××.xlsm” ActiveSheet.Unprotect ThisWorkbook.Activate Range(”D4:G20”).Select Selection.Copy Windows(”×××.xlsm”).Activate Sheet(”△△△”).Select Range(”AF18:AI34”).Select ActiveSheet.Paste Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Save ActiveWindow.Close Application.CutCopyMode = False Workbook.Open Filename:=”K:¥共有¥□□□.xlsm” ActiveSheet.Unprotect ThisWorkbook.Activate Range(”D4:G20”).Select Selection.Copy Windows(”□□□.xlsm”).Activate Sheet(”▽▽▽”).Select Range(”AF18:AI34”).Select ActiveSheet.Paste Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Save ActiveWindow.Close Application.CutCopyMode = False MsgBox " 『○○○』と" & vbCrLf & "『×××』と" & vbCrLf & "『□□□』の" & vbCrLf & "規格を変更しました。" End Sub どの様に修正すれば良いのでしょうか？ マクロが原因でしょうか？または他の原因があるのでしょうか？ マクロ初心者のため、修正方法など具体的な詳細をお教えいただけないでしょうか。 お手数をおかけして申し訳ございませんが、よろしくお願いします。
下記のコードを実行するとインデックスが有効範囲ではありません。となります。 Private Sub CSV読み込みボタン_Click() Dim textData As String Dim fileNo As Long Dim myArray() As String '文字列型の配列変数myArrayを宣言する。 Dim myRecordSet As Recordset Set myRecordSet = CurrentDb.OpenRecordset("CSV用顧客管理テーブル") fileNo = FreeFile Open "C:\access2013Data\顧客データ.csv" For Input As #fileNo ' 1行目の項目名部分を読み込むが、ここでは何もしないでおく。 Line Input #fileNo, textData ' 実際のデータの部分（2行目）からの処理を行う。 Do While Not EOF(fileNo) Line Input #fileNo, textData MsgBox textData myArray = Split(textData, ",") myRecordSet.AddNew myRecordSet("氏名") = Replace(myArray(1), """", "") myRecordSet("性別") = Replace(myArray(2), """", "") myRecordSet("年齢") = Replace(myArray(3), """", "") myRecordSet("郵便番号") = Replace(myArray(4), """", "") myRecordSet("住所") = Replace(myArray(5), """", "") myRecordSet("電話番号") = Replace(myArray(6), """", "") myRecordSet.Update Loop Close #fileNo CSV追加結果リストボックス.Requery myRecordSet.Close Set myRecordSet = Nothing End Sub
題名の通りのVBAコードを作成したのですが、ファイルの保存先が、指定フォルダでは無く、 最後に指定したフォルダへ保存されてしまいます。 どこがおかしいのかご教示頂けますでしょうか。 Private Sub シート保存_Click() Windows("A.xlsm").Activate Dim FLname As String Range("F11,G11").Select FLname = "申込書_" & Range("F11") & "_" & Range("G11") & ".xlsx" Workbooks.Add ActiveWorkbook.SaveAs Filename:=FLname, FileFormat:=xlOpenXMLWorkbook Windows("A.xlsm").Activate Cells.Select Selection.Copy Windows(FLname).Activate ActiveSheet.Paste Application.CutCopyMode = False Selection.Copy Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Application.CutCopyMode = False ChDir "\\TEST\test" ActiveWorkbook.SaveAs FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False
VB.netでデータを読み込みました。 何もしないで読み込むと下記のような右の昇順になります。 2016/07/31,1306453 2016/07/30,1326235 2016/07/27,1434311 2016/07/28,1475040 2016/07/29,1740547 そこでデータセットに格納後 '昇順ソートを実施 DataGridView1.Sort(DataGridView1.Columns(0), System.ComponentModel.ListSortDirection.Ascending) を処理後は下記のように表示されますが 2016/07/27,1434311 2016/07/28,1475040 2016/07/29,1740547 2016/07/30,1326235 2016/07/31,1306453 CSV出力を行うと最初の順で出力されます。 2016/07/31,1306453 2016/07/30,1326235 2016/07/27,1434311 2016/07/28,1475040 2016/07/29,1740547 どうしたらよいでしょうか？
今仕事で、バーコードを作成するアプリケーションを作成中です。 環境は、 　Windows Embedded Compact 7 　Visual Studio 2008 Pro (VB.NET 2008) になります。 このOS上で動作するバーコードライブラリをご存じないでしょうか。 いろいろ探していますが、見つからず困っています。 有償・フリー問わず探しています。 知っていたら教えて下さい。
閉じるボタンを無効化させたいです。 ユーザーフォームのではなくブック？ウィンドウ？のやつです。 シート上のコマンドボタンより閉じるようにし、 上書き保存をさせないようにしたいです。 ×ボタンで閉じてもよろしいのですが、保存云々の表示が出ないようにし、 できるだけマクロの記述は少なくしたいです。(既に結構重めなので…) 一番したいことは上書きをさせないようにしたいです。 回答よろしくお願いします。
４個の整数A,B,C,Dは１または２のどちらかです。 この組み合わせによってある計算値が得られます。 マクロを使ってすべての組み合わせを計算するには、どのように繰り返しをさせるのか教えていただけますか？ 組み合わせは次の16通りです。 1111 1112 1121 1122 1211 ・・・ 2212 2221 2222 となります。 よろしくお願いします。
[xdoc2txt] PDF,WORD,EXCEL,一太郎などの各種バイナリ文書からテキストを抽出 を利用して、c:\tempにあるpdfファイルからテキスト情報を取り込みたいです。 xdoc2txt.exeやxdoc2txt.dllなどはどこに配置したら良いのかも教えてください。 お願いします。
ロケーションの管理表をVBAを使って作成したいのですが、毎度のことですがコードがわかりません教えてください。 以下のように考えています。 ①登録 1.ﾌｫｰﾑに品目とﾛｹｰｼｮﾝを入力してﾎﾞﾀﾝを押すと、品目の重複ﾁｪｯｸをおこなう（ﾒｯｾｰｼﾞ[OK]or[ｷｬﾝｾﾙ]） 2.[OK]⇒ｼｰﾄのA列とB列に入力した品目とﾛｹｰｼｮﾝが登録される。 3.[ｷｬﾝｾﾙ]⇒終了 ただし、重複していても同じ品目で複数のﾛｹｰｼｮﾝという場合があるため、ﾕｰｻﾞｰの判断で登録は可能 （1のﾒｯｾｰｼﾞは、あくまで重複品目があるかどうかの情報を表示するだけと考えています） ②削除 1.ﾌｫｰﾑに品目とﾛｹｰｼｮﾝを入力してﾎﾞﾀﾝを押すと、表に登録されている一致するﾃﾞｰﾀが削除される できるかどうかわかりませんが、例えば品目のみ入力してﾎﾞﾀﾝをおすと、ﾌｫｰﾑに更に何か追加してﾛｹｰｼｮﾝのみの修正できれば…とも思いますが、考えつかないので上記①②のコードを教えて下さい。 何卒よろしくお願いします。
いつもお世話になります。 Sheet1のA2からA10までをRowsourceで指定して表示させる場合、Sheet1!A2:A10の形式になるかと思いますが、 Sheet1を変数を使ってシート名を指定する場合のやり方をご教示願えればと思います。
こんにちは。 アクセスVBAの勉強を始めました。 キーワード検索で教えて下さい。 InputBoxで検索したい文字列を入力し検索したいのですが、エラーとなってしまいました。 下記のようなスクリプトですが、どこが間違えているか教えていただけないでしょうか？ abc = InputBox("都道府県名を入れて下さい") RS.Find "住所１= ’" & abc & "’" 宜しくお願いします。
Access2010を使用しています。 AccessVBA初心者です。 T_マスタを基にF_新規登録フォームとF_詳細情報フォームを作成しました。 項目は全部で50ほどあるのですが、その中で20の項目については、 それぞれ選択項目が決まっているため、プルダウンで選択してもらう作りです。 この選択された20項目を非連結のtxtboxにそれぞれ点数変換し、 フォーム上で合計値を出しています。 個々の点数をテーブルで持つ必要がないので、フォーム上での計算ですが、 合計値のみ、テーブルへセットしたいと考えております。 更新されるタイミングは特にこだわらないのですが、 新規登録＝登録ボタン（新規レコードに登録）、 詳細情報＝更新ボタン（既存データの書き換え）を設けているので、 それぞれを押したタイミングにでもテーブルへ値がセットされればと思います。 できればマクロ、VBA両方でできる方法があるとよいのですが。。 ご教示をお願いいたします。
AddDataTableRowメソッドにて 1月として、A列は日付で先に31日分の行が作成されます。その際にB行はNothingで生成しました。 私は、A列はそのままでB列の1行目から1つずつ書き込んでいくコーディングが知りたいです。 現在はAddDataTableRowのためA列の最後の行の次の行が追加され入力されてしまいます。
エクセルでマクロをし始めたばかりのため、皆様にお教え頂きたいです。 1度質問させて頂きましたが上手くいかず何度も質問させて頂き申し訳ございません。 今開いてる様式Aシートに転送ボタンを作成します。これとは別に様式Bシートを作り、様式AシートのセルC4からC27までと、様式BシートのセルC4からC23までのデータ(言葉や数値など)を、ボタンを押して、Cドライブ共有フォルダ内のマクロというブック、様式1ならびに2の名前のシートにセルB9,C9,D9…といったように縦並びから横並びに変えて毎日までに転送しようと思います。(行と列を入れ替えて2シート一括転送コピー。) その際、転送先はシート保護をしておきたいのです。 Option Explicit Private Sub CommandButton1_Click() Call Macro1 End Sub Sub Macro1() Dim GYOU As Long Workbook.Open Filename:=”C:¥共有¥マクロ.xlsx” ActiveSheet.Unprotect ThisWorkbook.Activate With Workbooks(”マクロ.xlsx”) Sheets(”様式A”).Activate Sheets(”様式A”).Unprotect GYOU = .Sheets(”様式1”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式1”).Range(”A” & GYOU & ”:AA” & GYOU + 1880).Value =Sheets(”様式A”).Range(”A2:AA2000”).Value Sheets(”様式B”).Activate Sheets(”様式B”).Unprotect GYOU = .Sheets(”様式2”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式2”).Range(”A” & GYOU & ”:W” & GYOU + 1880).Value =Sheets(”様式B”).Range(”A2:W2000”).Value Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Close SaveChanges:=True End with End Sub この様なマクロを組んでみましたが、転送先の様式1シートにはデータが転送されているものの保護が掛かっておらず、様式2シートは保護が掛かったままデータが転送されていない状態です。 どの様に修正すれば良いのでしょうか？ お手数をおかけして申し訳ございませんが、よろしくお願いします。
エクセルでマクロをし始めたばかりのため、皆様にお教え頂きたいです。 1度質問させて頂きましたが上手くいかず再度質問させて頂きました。 今開いいるシートに転送ボタンを作成します。このシートのセルC4からC27まで、もしくはC23までのデータ(言葉や数値など)を、ボタンを押して、Cドライブ共有フォルダ内のマクロというブック、様式1ならびに2の名前のシートにセルB9,C9,D9…といったように縦並びから横並びに変えて毎日までに転送しようと思います。(行と列を入れ替えて2シート一括転送コピー。) その際、転送先はシート保護をしておきたいのです。 Option Explicit Private Sub CommandButton1_Click() Call Macro1 End Sub Sub Macro1() Dim GYOU As Long Workbook.Open Filename:=”C:¥共有¥マクロ.xlsx” ActiveSheet.Unprotect ThisWorkbook.Activate With Workbooks(”マクロ.xlsx”) Sheets(”様式1”).Activate Sheets(”様式1”).Unprotect GYOU = .Sheets(”様式1”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式1”).Range(”A” & GYOU & ”:AA” & GYOU + 1880).Value =Sheets(”様式1”).Range(”A2:AA2000”).Value Sheets(”様式2”).Activate Sheets(”様式2”).Unprotect GYOU = .Sheets(”様式2”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式2”).Range(”A” & GYOU & ”:W” & GYOU + 1880).Value =Sheets(”様式2”).Range(”A2:W2000”).Value Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Close SaveChanges:=True End with Range(”A2:AA6000”).Value=”” End Sub この様なマクロを組んでみましたがエラーメッセージが出て、止まってしまいます。 【エラー内容】 変更しようとしているセルやグラフは保護されているシート上にあります。… というコメントが出て、 .Sheets(”様式2”).Range(”A” & GYOU & ”:W” & GYOU + 1880).Value =Sheets(”様式2”).Range(”A2:W2000”).Value に黄色いラインが入ります。 どの様に修正すれば良いのでしょうか？ お手数をおかけして申し訳ございませんが、よろしくお願いします。
エクセルでマクロをし始めたばかりのため、皆様にお教え頂きたいです。 1度質問させて頂きましたが上手くいかず再度質問させて頂きました。 今開いいるシートに転送ボタンを作成します。このシートのセルC4からC27まで、もしくはC23までのデータ(言葉や数値など)を、ボタンを押して、Cドライブ共有フォルダ内のマクロというブック、様式1ならびに2の名前のシートにセルB9,C9,D9…といったように縦並びから横並びに変えて毎日までに転送しようと思います。(行と列を入れ替えて2シート一括転送コピー。) その際、転送先はシート保護をしておきたいのです。 Option Explicit Private Sub CommandButton1_Click() Call Macro1 End Sub Sub Macro1() Dim GYOU As Long ActiveSheet.Unprotect Workbook.Open Filename:=”C:¥共有¥マクロ.xlsx” ThisWorkbook.Activate With Workbooks(”マクロ.xlsx”) GYOU = .Sheets(”様式1”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式1”).Range(”A” & GYOU & ”:AA” & GYOU + 1880).Value =Sheets(”様式1”).Range(”A2:AA2000”).Value GYOU = .Sheets(”様式2”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式2”).Range(”A” & GYOU & ”:W” & GYOU + 1880).Value =Sheets(”様式2”).Range(”A2:W2000”).Value Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Close SaveChanges:=True End with Range(”A2:AA6000”).Value=”” End Sub この様なマクロを組んでみましたがエラーメッセージが出て、止まってしまいます。 【エラー内容】 変更しようとしているセルまたはグラフは保護されているため、読み取り専用となっています。… というコメントが出て、 .Sheets(”様式1”).Range(”A” & GYOU & ”:AA” & GYOU + 1880).Value =Sheets(”様式 に黄色いラインが入ります。 どの様に修正すれば良いのでしょうか？ お手数をおかけして申し訳ございませんが、よろしくお願いします。
エクセルでマクロをし始めたばかりのため、皆様にお教え頂きたいです。 今開いいるシートに転送ボタンを作成します。このシートのセルC4からC27まで、もしくはC23までのデータ(言葉や数値など)を、ボタンを押して、Cドライブ共有フォルダ内のマクロというブック、様式1ならびに2の名前のシートにセルB9,C9,D9…といったように縦並びから横並びに変えて毎日までに転送しようと思います。(行と列を入れ替えて2シート一括転送コピー。) その際、転送先はシート保護をしておきたいのです。 Option Explicit Private Sub CommandButton1_Click() Call Macro1 End Sub Sub Macro1() Dim GYOU As Long Workbook.Open Filename:=”C:¥共有¥マクロ.xlsx” ThisWorkbook.Activate With Workbooks(”マクロ.xlsx”) GYOU = .Sheets(”様式1”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式1”).Range(”A” & GYOU & ”:AA” & GYOU + 1880).Value =Sheets(”様式1”).Range(”A2:AA2000”).Value GYOU = .Sheets(”様式2”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式2”).Range(”A” & GYOU & ”:W” & GYOU + 1880).Value =Sheets(”様式2”).Range(”A2:W2000”).Value ActiveSheet.Unprotect Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Close SaveChanges:=True End with Range(”A2:AA6000”).Value=”” End Sub この様なマクロを組んでみましたがエラーメッセージが出て、止まってしまいます。 どの様に修正すれば良いのでしょうか？お手数をおかけして申し訳ございませんが、よろしくお願いします。
私はエクセルのVBAを使って下記の接続先に 無数に同じブラウザを立ち上げるコードを 作ったのですが、起動しません。どこをな 直したら良いでしょうか？よろしくお願いいたします。 Sub main() For a = 1 To 20 Shell "C:¥Program Files¥Internet Explorer¥IEXPLORE.EXE http://www.xxx,com/” Next End Sub どうかよろしくお願いいたします。
オートフィルタ結果をコピーして、別シートに貼り付けるというマクロとなります。 しかし、これですと絞り込んだ対象の中に空白の行があると、空白行の上までの部分しかコピーをすることができません。 そこで、登録のシートの空白行は削除することなく、 抽出のシートで空白行を削除して貼り付けをしたいのですが、 こうしたことは可能でしょうか。 もし可能でしたら、どのようなコードを追記すればよろしいでしょうか。 よろしくお願い致します。 ＞ Sub () Const SHEET_COPY As String = "登録" Const SHEET_PASTE As String = "抽出" Worksheets(SHEET_COPY).Range("a2:e" & _ Worksheets(SHEET_COPY).Range("a1").CurrentRegion.Rows.Count).Copy Worksheets(SHEET_PASTE).Range("a" & _ Worksheets(SHEET_PASTE).Range("a1").CurrentRegion.Rows.Count + 1).PasteSpecial Paste:=xlPasteValues Sheets("抽出").Select End Sub
エクセルでマクロを組み始めたばかりのため、皆様にご教授頂ければと思います。 今開いいるシートに転送ボタンを作成します。このシートのセルC4からC27まで、もしくはC23までのデータ(言葉や数値など)を、ボタンを押して、Cドライブ共有フォルダ内のマクロというブック、様式1ならびに2の名前のシートにセルB9,C9,D9…といったように縦並びから横並びに変えて毎日までに転送しようと思います。(一括転送) その際、転送先はシート保護をしておきたいのです。 Option Explicit Private Sub CommandButton1_Click() Call Macro1 End Sub Sub Macro1() Workbook.Open Filename:=”C:¥共有¥マクロ.xlsx” ThisWorkbook.Activate With Workbooks(”マクロ.xlsx”) GYOU = .Sheets(”様式1”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式1”).Range(”A” & GYOU & ”:AA” & GYOU + 1880).Value =Sheets(”様式1”).Range(”A2:AA2000”).Value GYOU = .Sheets(”様式2”).Range(”A” & Rows.Count).End(xlUp).Row + 1 .Sheets(”様式2”).Range(”A” & GYOU & ”:W” & GYOU + 1880).Value =Sheets(”様式2”).Range(”A2:W2000”).Value ActiveSheet.Paste Application.CutCopyMode = False ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True ActiveWorkbook.Save ActiveWindow.Close Application.CutCopyMode =False End Sub この様なマクロを組んでみましたが、コンパイルエラーが出て、「変数が定義されていません」と表示されます。 どの様に修正すれば良いのでしょうか？お手数をおかけして申し訳ございませんが、よろしくお願いします。
VBA 初心者です。 以下のコードをどうにか作成しました。自身のパソコン上では作動するのですが、 他のパソコンで使ってみると、エラーメッセージで「パスがみつかりません」、 デバックして、 ChDir "C:\Users\会社User\Desktop"　を指定されます。 どのパソコン上でも使えるようにしたいのですが、どのように修正すれば 良いのでしょうか。 お力添えよろしくお願い致します。 ＞ Sub ペースト() Dim wb As Workbook Workbooks.Add Set wb = ActiveWorkbook ChDir "C:\Users\会社User\Desktop" Windows("データ.xls").Activate Sheets("まとめ").Select Range("A2:E1000").Select Selection.Copy wb.Activate Cells.Select ActiveSheet.Paste Range("A1").Select Windows("データ.xls").Activate Sheets("まとめ").Select Range("A2:E1000").Select Selection.Clear Range("F2").Select End Sub
EXCEL2010で重複しない名前リストを作りたいです。 イメージは添付ファイルのような複数人数の名前（適当につけています）が2列（A班B班）に並んでいるのを、重複削除し上の横並びの枠(a～g)に一人ずつ入れていきたいです。 A班B班を分ける必要はなく、順番も適当で構いません。 いろんなサイトを参考にしてみましたがうまくできませんので、どなたかVBAまたは関数を用いて作っていただけませんでしょうか？ 名前は今後50人ほどまで増える予定ですので、関数よりVBAの方がいいのかなとなんとなく思っています。 よろしくお願いします。
DateTimePickerのカレンダーを表示させたとき、画像のようなダイアログを表示し月選択するとダイアログが閉じるようにしたいです。 値としては**年**月が理想ですが、**年**月1日でもできれば教えて頂きたいです。
エクセルのマクロについて教えてください。 デスクトップにフォルダが作成されています。 その中には100個ほどブックがあります。(全てのブックにシートは1シートだけです) そのブックを担当者ごとのブックに分けたいです。 ・マクロの実行は別のブックを作成しているので、そこでマクロボタンを使って実行する ・デスクトップにあるフォルダは名前が決まっていないので、選択ダイアログを使って開く ・マクロ実行ブックの3番目のシートに担当表があり、列A2行目以下に識別コード、列B2行目以下に担当者名が書かれてある ・デスクトップのフォルダの中のブック名の右4文字が識別コードとなっている ・シート名とブック名は同じである ・1識別コード＝1担当者ではなく、1担当者ごとに多数の識別コードがある ・作成した担当者ごとのブックはデスクトップに年月日のフォルダを作り、その中に保存する ・保存するときのブック名は担当者＋様分、シート名は識別コード(もともとのシート名の右4文字) としたいです。 どなたかご教授ください。
〈フォルダ内のファイル名に限らず、2種類のファイルを1つの集計用ファイルに集計し、それぞれ別々のシートの転記するマクロ。〉 マクロ・VBA初心者です。 ご教授、宜しくお願いします。 上記の動作を行う、VBAコードを教えていただけたら幸いです。 コードに関しては下記のリンクに貼っています。（字数等の関係により） ■詳細 社員から経費精算書・交通費精算書のファイルをもらい一つのフォルダーに入れた状態で集計用のファイルに転記する） 経費のデータは→経費用データのシート 交通費は→交通費用データのシート 経費精算書から取り出したい（集計用Excelに転記したい）値のセルは、B4、B5、A列からH列の9行目から下のセルが埋まっている値（9行目含む 交通費精算書から取り出したい値のセルは　B4、B5、AからK列の9行目から下のセルが埋まっている値（9行目含む） 仮にシートを条件で切り分けるとしたらセルA1がそれぞれ下記のように記入があります。 経費A1セル General Expense Report 交通費A1セル Travel Expense Report また、過去にも質問をさせていただいたのでこちらをリンク貼らせていただきます。 ■コードの記入は下記のリンクに貼っています。 http://okwave.jp/qa/q9174557.html 最終行の列が字数制限で消えてまいした。 '---------------------------------------- Next i End Sub ■詳細と経費と交通費の異なる点記入 http://detail.chiebukuro.yahoo.co.jp/qa/question … 非常に困っています、 何卒、よろしくお願いいたします。
レポートのサブレポートにデータがない場合、サブレポートが表示されないため、代わりに”お取り扱いがありません”を出力したく、やり方を質問しましたら、以下のご回答を頂きました。 ＞1.メインレポートにあるサブレポートと同じ位置に「お取り扱いがありません」と ＞表示が出るコントロールを作ります。（ラベルやコントロールボックス） ＞2.メインレポートの詳細セクションにサブレポートがある場合 ＞詳細セクションのフォーマット時のイベントで ＞Dcountを使いサブレポートのレコード件数を確認します。 ＞3.レコード件数が0の場合は「お取り扱いがありません」のコントロールの ＞可視プロパティをTrue、サブレポートの可視プロパティをFalse ＞0以外の場合はその逆 ＞これでサブレポートのレコードが０のときはお取り扱いがありませんと表示され ＞0以外のときはサブレポートが表示されます。 ＞コードはサブレポート　非表示とかで探せば見つかると思います せっかく、教えて頂いたのですが、ＶＢＡを知らない私にとっては、ＶＢＡの記述が分かりませんでした。 本当にわがままですみませんが、できれば、どなたかＶＢＡを教えて頂けませんでしょうか？ 事前にレポートで以下を作成しました。 ①レポート名：Ｒ_取引案内 ②サブレポート名：Ｒ_定期 　　　　　　　　Ｒ_普通 　　　　　　　　　Ｒ_出資 ③ラベル名「txt_定期用」、標題「定期のお取り扱いはありません」 　　　　　「txt_普通用」、標題「普通のお取り扱いはありません」 　　　　　「txt_出資用」、標題「出資のお取り扱いはありません」
マクロ・VBA初心者です。 〈VBA・マクロでのテキストファイル作成方法に関しての質問です〉 経費精算のExcelデータを画像のような「"",]で区切ったテキストファイルを作成するマクロを作りたいと考えてます。 完成イメージ：マクロを登録したボタンを押すとテキストファイルの形でフォルダに作成される。もしくは、マクロボタンを押すとテキストファイルの形で区切ったものが表示されるものを作りたいです。 〈捕捉情報〉 ＊経費精算データに関してA列からX列まであり、集計データにより列にデータを埋めていく作業が入っております。なので、A列からX1列まででデータが記入されている範囲で集計できるようにしたいと考えております。 現在は、勉強しつつ組み立てた結果、 CSVのExcelファイルをフォルダの中に作成できるようになりました。 （コードは下記に記載します） ただ、テキストファイルが作れるコードができていないのが問題です。 このコードをどのように変えればよいのか？ もしくは、別のコードで出来るようならば教えていただけると嬉しく思います。 宜しくお願いします。 ______________________________ 〈コード〉 Option Explicit Sub ExcelファイルCSV形式作成() '変数宣言 Dim filePath As String Dim i As Long Dim maxRow As Long Dim fileNo As Integer '初期値設定 filePath = ActiveWorkbook.Path & "\経費計算エクセル（CSV保存）.csv" maxRow = Range("A1").End(xlDown).Row '最終行取得 fileNo = FreeFile 'FreeFile関数で使用可能なファイル番号取得 'ファイル開く Open filePath For Output As #fileNo '最終行までループ For i = 1 To maxRow '列の数は決め打ち Write #fileNo, Cells(i, 1), Cells(i, 2), Cells(i, 3), Cells(i, 4), Cells(i, 5), Cells(i, 6); Cells(i, 7), Cells(i, 8), Cells(i, 9); Cells(i, 10), Cells(i, 11), Cells(i, 12); Cells(i, 13), Cells(i, 14), Cells(i, 15); Cells(i, 16), Cells(i, 17), Cells(i, 18); Cells(i, 19), Cells(i, 20), Cells(i, 21); Cells(i, 22), Cells(i, 23), Cells(i, 24) Next i 'ファイル閉じる Close #fileNo End Sub ＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿
エクセルでマクロを組み始めたばかりのため、皆様にご教授頂ければと思います。 今開いているブックのシート1、シート2の各データをシート3に付けた転送ボタンをおして、「マクロ」というブックの「記録用紙1」「記録用紙2」名の各シートの各同セルに毎日データ転送しようと思います(4行目,5行目…)。 その際、転送先はシート保護をしておきたいのです。 Option Explicit Private Sub CommandButton1_Click() Call Macro1 End Sub Sub Macro1() Workbook.Open Filename:=”K:¥$共有¥マクロ¥記録用紙.xlsmx” ThisWorkbook.Activate With Workbooks(”記録用紙.xlsmx”) GYOU = .Sheets(”記録用紙1”).Range(”A” & Rows.Count).End(xlup).Row + 1 .Sheets(”記録用紙1”).Range(”A” & GYOU & ”:AA” & GYOU + 1880).Value = Sheets(”記録用紙1”).Range(”A2:AA2000”).Value GYOU = .Sheets(”記録用紙2”).Range(”A” & Rows.Count).End(xlup).Row + 1 .Sheets(”記録用紙2”).Range(”A” & GYOU & ”:AA” & GYOU + 1880).Value = Sheets(”記録用紙2”).Range(”A2:W2000”).Value End With Range(”A2:AA6000”).Value = ”” End Sub この様なマクロを組んでみました。転送ボタンを押しても、「保護の為、読み取り専用」というエラーメッセージが出て途中で止まってしまいます。 どの様に修正すれば良いのでしょうか？お手数をおかけして申し訳ございませんが、よろしくお願いします。
表1のセル値を、ユーザーフォーム1のA,B,Cに表示させたいのですが、 VBAでどのように書けばよいかわかりません。 ユーザーフォームを開くと最初に1行目のa1, b1, c1をA, B, C のTextBoxに表示させ、 [次へ] ボタンをクリックすると下の行の値(a2,b,2,c2)を表示させる ボタンに書くコードがわかりません。 [戻る] ボタンをクリックすると上の行の値を表示させる ボタンに書くコードがわかりません。 また、[次へ]と[戻る]ボタンクリックの様な規則的ではなくランダムに 行ごとを表示させる方法もあれば教えて下さい。 質問内容以上です。 このような質問でご教示頂けるか不安ですが、宜しくお願い致します。
始めて投稿します。 Sheet１に設置したボタンを押すとSheet２のデータを処理するようにしたいのですがうまくいきません。 処理内容は一定の行を隠し、表示セルのみのデータを新規シートに貼り付け（Sheet3)貼り付けたシートのみを新規ファイルにして共有することを目的にしています。 （Sheet2はSheet３の閲覧者には見せたくないデータがあるため） （Sheet2にボタンを置くと上手くいくのですがSheet２にボタンを置きたくないです。最初はSheet2にボタンを置いて作りました。指定ファイルだけ新規ファイルに保存する方法もうまくいかず、貼り付けと保存は一つにしたいのですが後付けで作ったの別々になってしまいました。） 何か足りないのだろうということはわかるのですが何を書き足せば実行できるようになるのかお知恵をお貸しいただけますでしょうか。 Private Sub Cmd隠す_Click() Sheets("Sheet2").Activate Dim 行番号 As Long '行を隠す For 行番号 = 1 To 10 If Cells(行番号, 6).Value = "A" Then Cells(行番号, 1).EntireRow.Hidden = True End If Next 行番号 End Sub Private Sub Cmd表示_Click() Sheets("Sheet2").Activate '表全体を再表示する Cells.Select Selection.EntireRow.Hidden = False Selection.EntireColumn.Hidden = False Cells(1, 1).Select End Sub Private Sub Cmd貼付_Click() ' 可視セル貼付 Range("A2").Select Range(Selection, Selection.End(xlToRight)).Select Range(Selection, Selection.End(xlDown)).Select Selection.SpecialCells(xlCellTypeVisible).Select Selection.Copy Sheets("Sheet3").Select Range("A2").Select ActiveSheet.Paste Columns("B:B").EntireColumn.AutoFit Columns("E:E").EntireColumn.AutoFit Range("A2").Select End Sub Sub 最終更新日を取得して保存() ' 最終更新日を取得して保存 Dim myFile As String myFile = ThisWorkbook.Path & "\" & "Sheet3" & Format(Date, "yymmdd") & ".xlsm" ThisWorkbook.SaveAs Filename:=myFile End Sub
Excel VBAで、特定の範囲の空白セルを探して行番号を表示させる方法を探しています。 教えていただけたらとてもありがたいです。 以下が作りたいマクロのイメージです。 ①エラーチェック用のブックを作り、空白セルの数を調べたいブック名とシート名を記入する場所を作る。 記入したブックとそのシートをマクロで開いて、その特定の範囲から空白セルを検索してその空白セルの行番号をエラーチェック用のブックのE7～に入力する。 ②調べたい範囲→P21:V21　この７列のデータが記入されている一番下のセルまでを調べて、その中から空白セルを検索したい。 一番下のセルはデータが増えると変わるので、最初から範囲指定ができません。データが記入されている一番最後のセルまでを自動で調べてほしい。 ③空白セルを調べ終わったら最後に自動でそのブックを閉じる。 そういうマクロを作りたいです。 仕事で使う便利なマクロを作らなくてはならず、エラーチェック用のブックにブック名とシート名を記入してマクロを実行すれば、そのブックとシートを自動で開いて特定の範囲の記入漏れの空白セルを調べて行番号をエラーチェック用ブックに一覧で表示し、探しやすくしたいのです。 私はＶＢＡの勉強を始めて４日目なので、マクロでどこまでできるのか全てわかるわけではないので、もしマクロで作れない無理なことを書いていたら申し訳ありません。 ネットでたくさん調べながら作ろうと頑張っているのですが、難しくてうまくいきません。 どうか知恵を貸していただけませんでしょうか。
いつもお世話になっています。 VBAでフォームに配置した２０個程度のコントロール（ラベル）をユーザーが自由に変更するにはどのようなプログラムを書けばよいのかわかりません。 配置は、エディタで固定して使わせるのではなく、ユーザーがフォーム上で自由にコンロトロールの配置を行ってレイアウトできるようにしたのですが、適当なイベントドリブンが見つかりません。 マウスダウンやマウスムーブなどのイベントを組み合わせることでできそうな気もするのですが１週間ほど悩んでも名案がうかびません。 目指すのは、「レイアウト変更」ボタンを押すと、変更モードになって、コントロールをドラッグしながら好きな位置へもっていけるというものです。 よろしくお願いします。
sheet1のセルA1にa001またはa002 同じくsheet1のセルA1にb001またはb002 を入力した時に、 a001,a002だった場合sheet2へ b001,b002だった場合sheet3へ という形で入力したら自動的に行うものを作りたいのですが、初心者が故にうまく行きません どうか教えてください!!
エクセルでマクロを組み始めたばかりのため、皆様にご教授頂ければと思います。 今開いいるシートに転送ボタンを作成します。このシートのセルC4からF24までデータ(言葉や数値など)を、ボタンを押して、Cドライブ共有フォルダ内のマクロというブック、様式名のシートにセルD7からG27までに転送しようと思います。 その際、転送先はシート保護をしておきたいのです。 Option Explicit Private Sub Workbook_Open() ActiveSheet.Unprotect ActiveSheet.Protect User InterfaceOnly:=True ActiveWindow.ScrollRow = 1 End Sub Sub Macro1() Workbook.Open Filename:=”C:¥共有¥マクロ.xlsm” ThisWorkbook.Activate With Workbooks(”マクロ.xlsm”) Range(”C4:F24”).Select Selection.Copy Windows(”マクロ.xlsm”).Activate Sheets(”様式”).Select Range(”D7:G27”).Select End With End Sub この様なマクロを組んでみました。転送ボタンを押して走るものの、転送元(C4からF24)で幾つかのデータを変更しても転送先のセルに変更は出来ていませんでした。 どの様に修正すれば良いのでしょうか？お手数をおかけして申し訳ございませんが、よろしくお願いします。
今までソニーのパソリというリーダーを使ってパスモやスイカをVB6で読み込んでました。OSはwindows7、8、8.1、10で可能でした。 ところがwindows10の64bitではエラーが出て読み取る事ができません。（windows10の32bitでは大丈夫でした。） Private Declare Sub ReadFlcIDm Lib "ReadFlc.dll" (ByVal res As String) と宣言し、ReadFlc.dllはwindows\sysutem32に入れてあります。 64bitのPCではwindows\syswow64にも入れてみました。 どちらに入れてもReadFlc.dllが見つからないとエラーが出ます。 windows10の64bit版でパソリからIDをVB6で読み取る方法を教えてください。 よろしくお願いします。
Excel2013で VBAでstrConv関数を使って 「あいうえお」という文字列をUNICODEに変換しました。(vbUNICODE) すると返された文字列は「B0D0F0H0J0」でしたが これは16進数とは関係ないのでしょうか？ HやJで16進数→2進数変換をしようとすると当然エラーになります… UNICODEと、この処理で返された「B0D0F0H0J0」について 教えてください。 ざっくりとした質問ですみません。
マクロ初心者です。 以前、以下のようなマクロコードをここで教えて頂きました。 Sheet 2 にSheet1 の代表を抽出させ、かつ それに対応する個数の合計を表示させるというものです。 しかし、 ここで、Sheet 1 の内容はソートさせずに（データの順番の変化を起こさせず）、 Sheet 2 にはソートをさせた代表の状態で表示させることはできますでしょうか？ Sheet 1（登録） A　　　　　B　　　C　　　　E 品名　　　　種　　産地　　　個数 りんご　　　赤　　　　　　　30 バナナ　　　　　　台湾　　　30 りんご　　　青　　　　　　　20 りんご　　　赤　　　　　　　25 バナナ　　　　　　国産　　　14 バナナ　　　　　　国産　　　22 バナナ　　　　　　台湾　　　30 Sheet 2（代表） A　　　　　　B　　　　C　　　　D 品名　　　　種　　　産地　　　個数 りんご　　　赤　　　　　　　　55 りんご　　　青　　　　　　　　20 バナナ　　　　　　　台湾　　　60 バナナ　　　　　　　国産　　　36 長々と申し訳ありませんが、ご助力の程よろしくお願い致します。 Sub 抽出_Click() Dim 元行 As Long Dim 先行 As Long Dim 小計 As Long Dim 一致 As Boolean Sheets("代表").Select Rows("2:" & Rows.Count).ClearContents Sheets("登録").Select Cells.Sort _ Key1:=Range("A2"), Order1:=xlAscending, _ Key2:=Range("B2"), Order2:=xlAscending, _ Key3:=Range("C2"), Order3:=xlAscending, _ Header:=xlYes, OrderCustom:=1, _ MatchCase:=False, Orientation:=xlTopToBottom, _ SortMethod:=xlPinYin 元行 = 2 Do While Cells(元行 - 1, 1).Value <> "" 一致 = False If Cells(元行, 1).Value = Cells(元行 - 1, 1).Value Then If Cells(元行, 2).Value = Cells(元行 - 1, 2).Value Then If Cells(元行, 3).Value = Cells(元行 - 1, 3).Value Then 一致 = True End If End If End If If 一致 Then 小計 = 小計 + Cells(元行, 6).Value Else 先行 = 先行 + 1 Sheets("代表").Cells(先行, 1).Value = Cells(元行 - 1, 1).Value Sheets("代表").Cells(先行, 2).Value = Cells(元行 - 1, 2).Value Sheets("代表").Cells(先行, 3).Value = Cells(元行 - 1, 3).Value Sheets("代表").Cells(先行, 4).Value = 小計 小計 = Cells(元行, 6).Value End If 元行 = 元行 + 1 Loop Sheets("代表").Select Cells(1, 4).Value = "小計" End Sub
エクセルのマクロ・VBA初心者の為、お教え頂きたいです。 ユーザーフォームを作成して読み込みボタンを付けました。エクセルにセルのデータを、フォームのテキストボックスに読み込む様にしたいのですがよく分かりません。 どこにどの様にプログラミングすれば良いかお教え頂けないでしょうか。 申し訳ございませんが、よろしくお願い致します。
Excel VBAを勉強しており、とりあえずサンプルなどをもとに、自分で簡単な顧客管理フォームのようなものを作っております。 その中で、電話番号を入力するテキストボックスがあり、 「そのテキストボックスに入力があり、”登録”というコマンドボタンを押した際に、正規表現チェックをかけたいと思っております。」 Private Sub 登録_Click（） Dim myRegEx As New RegExp Dim regCheck As Boolean '電話番号正規表現チェック' If 電話番号テキストボックス.Value <> ""　= True then (すみません無茶苦茶です。） myRegEx.Pattern = "\d{2,4}-\d{2,4}-\d{4}" regCheck = myRegEx.Test(電話番号テキストボックス.Text) If regCheck = False Then MsgBox "電話番号が不正です。" Exit Sub End If End sub まだ勉強して1ヶ月くらいなので、基礎もままならないのです、VBA自体、理解していないのですが、もし教えていていただけるなら幸いです。 宜しくお願い致します。
添付画像に示したように白い部分を黄色の1×1セル(BD52)を原点にしたときのVBAのプログラミングについて教えてもらえませんか？ Excel VBAについては先日始めたばかりなのでよくわからないので解説があればうれしいです
Ａ列に項目が入っています。２０００行ほどあります。 項目間の行数がばらばらの状態です。 下記の例で言うと、 名前と果物の間は常に１０行 果物と主食の間は常に１０行 主食と名前の間は常に１０行 とする方法をご存知の方、教えて下さい！ なお、名前、果物、主食、の間は常に空白ではなく、文字が入っていることもあります。 この文字を消さずに、１０行に揃えたいです。 Ａ列 名前　　　 果物 主食 　　 名前　　　 　　　　　 　　　　　 果物　　　 　　　　　 　　　　　 主食
いつも大変お世話になります。 今日より一日前は　Date-1　で　指定できます。 今日を含めないで今日より前の日付は　 "< Date"　では指定できませんでした。 オートフィルタでマクロの記録でやると、 　"<2016/5/11"　となっていたので　 "< Date"　でいけるかと思いましたが無理でした。 どなたかご教示願える方いましたらどうかよろしくお願いいたします。
誰かエクセルのVBAを使ってIEを多重起動するプログラムはないでしょうか？よろしくお願いいたします。
Sub 転記() Dim s As String, i As Integer Dim ss As String, ii As Integer s= "スカイライン（GTR)" ss = "スカイライン" i = InStr(1, Worksheets("Sheet1").Range("A1").Value, s) If i > 0 Then Worksheets("Sheet2").Range("A1").Value = s Else Worksheets("Sheet2").Range("A1").Value = "" End If ii = InStr(1, Worksheets("Sheet1").Range("A1").Value, ss) If ii > 0 Then Worksheets("Sheet2").Range("A1").Value = ss Else Worksheets("Sheet2").Range("A1").Value = "" End If End Sub セルAIにスカイライン（GTR)と入力されていても、上記コードを実行すると スカイラインとしか転記されません。 （）等がつくとだめなんですかね？ これを修正するためのコードをご教示お願いします。
.Sort Key1:=.Rows(1), Order1:=xlAscending, Header:=xlNo, Orientation:=xlLeftToRight .Rows(1).SpecialCells(xlCellTypeFormulas).Value = Empty .Sort Key1:= .Rows(1), Order1:= xlAscending, Header:= xlNo, Orientation:= xlLeftToRight .Rows(1). .SpecialCells (xlCellTypeFormulas) .Value = Empty
エクセルマクロについて CSVファイルのファイル名を取得するにあたり、下記構文を見つけたのですが、拡張子の.csvも取得してしまいます。拡張子を除くにはどのように変更すれば良いのでしょうか？ Sub CSVまとめ() Dim MyObj As Object Dim MyFol As String Dim MyFnm As String Dim MyStr As String Dim i As Long Dim n As Long Dim n1 As Long 'フォルダを選択する Set MyObj = CreateObject("Shell.Application") _ .BrowseForFolder(0, "SelectFolder", 0) '選択なければ処理を抜ける If MyObj Is Nothing Then Exit Sub MyFol = MyObj.self.Path & "\" MsgBox MyFol & "を処理します。" Set MyObj = Nothing Application.ScreenUpdating = False 'ThisWorkbookにシートを追加して処理 With Sheets.Add 'Dir関数を使って指定フォルダ内csvファイルを順次処理 MyFnm = Dir(MyFol & "*.csv") Do Until Len(MyFnm) = 0& i = i + 1 'データエリアを取得してセット先を変更 n = IIf(n = 0, 1, n + n1) '外部データ取り込みを利用 With .QueryTables.Add(Connection:="TEXT;" & MyFol & MyFnm, _ Destination:=.Range("B" & n)) .AdjustColumnWidth = False .TextFilePlatform = xlWindows .TextFileStartRow = 1 .TextFileCommaDelimiter = True .Refresh False n1 = .ResultRange.Rows.Count .Parent.Names(.Name).Delete .Delete End With 'ファイル名をA列にセット .Range("A" & n).Resize(n1).Value = MyFnm '次のファイルへ MyFnm = Dir() Loop End With If i > 0 Then MyStr = i & "個のファイルを処理しました。" Else '検索結果が０なら MyStr = "検索条件を満たすファイルはありません。" End If Application.ScreenUpdating = True MsgBox MyStr End Sub
CSVファイルのファイル名を取得するにあたり、下記構文をつけたのですが、拡張子の.csvも取得してしまいます。どのように変更すれば良いのでしょうか？ 'ファイル名をA列にセット .Range("A" & n).Resize(n1).Value = MyFnm
マクロ初心者です。 先ほどと似たような質問となり大変恐縮なのですが、 以下の内容についてマクロを組みたいと考えています。 Sheet1 に以下の様なデータが入力されております。 A列　　　　　B列　　　　C列　　　　　　　D列 （品名）　（種類） 　（産地）　　　　　　（個数） りんご　　　　赤　　　　　　　　　　　　　　90 バナナ　　　　　　　　　台湾産　　　　　　　15 りんご　　　　青　　　　　　　　　　　　　　10 りんご　　　　赤　　　　　　　　　　　　　　20 りんご　　　　青　　　　　　　　　　　　　　20 バナナ　　　　　　　　　国産　　　　　　　　20 バナナ　　　　　　　　　国産　　　　　　　　25　 Sheet2 に自動的に以下の様に集計させたいのです。 A列　　　　　B列　　　　C列　　　　　　　　D列 （品名）　（種類） 　（産地）　　　　　　　（個数） りんご　　　　赤　　　　　　　　　　　　　　110 りんご　　　　青　　　　　　　　　　　　　　30 バナナ　　　　　　　　　台湾産　　　　　　　15 バナナ　　　　　　　　　国産　　　　　　　　45 このように、代表を表示させ、それに対応する個数の合計を 表示させたいのですが、どのように作成すればよろしいでしょうか。 できればコードを示して頂けますと非常に助かります。 ご教授のほど宜しくお願い致します。 sort key を複数設定すると思われるのですが、何卒よろしく お願い致します。 ＞ Sub 転記() Dim i As Long, lastRow As Long, wS As Worksheet Set wS = Worksheets("Sheet2") wS.Rows("2:" & Rows.Count).Clear With Worksheets("Sheet1") lastRow = .Cells(Rows.Count, "A").End(xlUp).Row .Range("D:D").Insert .Range("D1") = "ダミー" Range(.Cells(2, "D"), .Cells(lastRow, "D")).Formula = "=A2&""_""&B2" .Range("D:D").AdvancedFilter Action:=xlFilterCopy, copytorange:=wS.Range("A1"), unique:=True wS.Range("A:A").Sort key1:=wS.Range("A1"), order1:=xlAscending, Header:=xlYes .Range("A1").Resize(, 3).Copy wS.Range("A1") lastRow = wS.Cells(Rows.Count, "A").End(xlUp).Row With Range(wS.Cells(2, "C"), wS.Cells(lastRow, "C")) .Formula = "=SUMIF(Sheet1!D:D,A2,Sheet1!C:C) " .Value = .Value End With Application.DisplayAlerts = False wS.Range("A:A").TextToColumns Destination:=Range("A1"), DataType:=xlDelimited, _ Tab:=True, OtherChar:="_", FieldInfo:=Array(Array(1, 1), Array(2, 1)) Application.DisplayAlerts = True .Range("A1").Resize(, 3).Copy wS.Range("A1") .Range("D:D").Delete End With End Sub 以上
お世話になります。 あるソフトウェアを作成し、配布用にインストーラーを作成しようとしています。 そのソフトウェアの使用には、第三者が作成したドライバーがインストールされていることが必須のため、インストーラー起動時にそのドライバーも一緒にインストールされるようにしたいと考えています。 ドライバーのインストーラーはexe形式で、これを自作ソフトウェアのセットアップに組み込む方法を探しています。 操作を面倒にしたくないので、それぞれ別個にセットアップする、ということは避けたいです。 少し調べると、 System.Diagnostics.Process.Start（"exeのパス"） で、任意のexeを起動できることがわかり、 ドライバーのインストーラー（.exe） 自作ソフトのインストーラー（.exe） を順々に起動するプロジェクトを作成する、 ということを考えましたが、これで問題ないのか判断できません。 上記目的を達成するために、この方法で問題はないでしょうか。 もしくは、何かスマートな方法があれば、お教えいただけないでしょうか。 所有している開発環境は Visual Studio 2008 です。 よろしくお願いいたします。
VBAコマンド Excel Book 1にシート１，２があります。 シート１には　下記のように複数名分があります。 ○○○　太郎 テーブル番号 PC１ PC２ PC3 ＃＃ ＃＃＃ ＃＃＃＃ シート２に上記のデータを一列に抽出したいです。 テーブル番号を入れて抽出ボタンをクリックすれば残りの情報が反映される。 もし１００名分のテーブル番号を入力すれば、ループで処理を行う。 処理が完了すれば、ダイアルボックス表示させ終了。 例） テーブル番号 氏名 PC1 PC2 PC3 ## ### #### 宜しくお願い致します。
お願いします。シートは2枚。Database とReportです。reportにvlookup関数を使って生徒一人一人の成績を出し、順番に３５６人分を印刷したいのですが、ループ関数を使っても同じ人間のデータが ループ指定の枚数で出てきてしまします。以下、記述式を書きます。データはDatabaseシートに入っており、一列目出席番号、二列目氏名、3、4、5列目は英数国という科目の得点になっています。 それをReportシートでVLOOKUP関数で呼び出して印刷するには、どう書き換えたらよいのでしょうか？お忙しいとは思いますが、ご教示くださいませ。 以下記述 '---------- ここから ---------- '■■■個人票印刷マクロ■■■ Sub 個人票印刷() '変数の宣言 Dim i As Integer Dim MySheetName As String '確認メッセージの表示 （キャンセルの場合マクロを抜ける） If MsgBox("個人票の印刷をはじめます。" & Chr(13) & Chr(13) _ & "プリンタの準備はよろしいですか？", vbOKCancel) = vbCancel Then Exit Sub End If 'アクティブシートのシート名取得 MySheetName = ActiveSheet.Name '画面表示更新の停止 Application.ScreenUpdating = False '印刷用シートの選択 Sheets("Report").Select '【１】 '印刷ループ開始 For i = 1 To 40 '【２】 '出席番号の代入 Range("A1").Value = i '【３】 '印刷 ActiveSheet.PrintOut Next i '元のシートに戻る Sheets(MySheetName).Select '画面表示更新の許可 Application.ScreenUpdating = True '確認メッセージの表示 MsgBox "個人票の印刷が終わりました。" End Sub '---------- ここまで ---------- 初心者なので、ころがっているものをコピペしてみたのですが。
Outlookメール（.msg）から添付ファイルのみ取り出すコーディングをサンプルなどで教えてほしいです。 Outlookから「：C￥メール」にmsgファイルを手動で移し、そこからVBにて「：C￥添付ファイル」に添付ファイルのみを取り出したいです。
OSはwin8.1 64bitです。 VBフォームアプリケーション上に設置したコマンドボタンを押すだけで コマンドプロンプトからwindowsエクスペリエンスインデックスを実行したいと考えているのですが、 Windowsから直接立ち上げたコマンドプロンプトに「winsat formal -restart clean」と 入力すると問題なく始まるものの、 VBフォームから実行すると、「'winsat' は、内部コマンドまたは外部コマンド、 操作可能なプログラムまたはバッチ ファイルとして認識されていません」とエラーが出ます。 Dim ShellObj ShellObj = CreateObject("WScript.Shell") Call ShellObj.Run("cmd.exe /k winsat formal -restart clean") Windowsから直接立ち上げる際、管理者権限を使用しなくても 問題なく走るため、管理者権限は関係ないと考えて良いのでしょうか？ また、どういった記述であればWindowsエクスペリエンスが実行できるでしょうか？ 出来ればバッチやスクリプトは使用したくありません。 よろしくお願いいたします。
エクセルＶＢＡを勉強し始めた初心者です。 あまり家だと集中できないため、外でノートＰＣを使ってエクセルＶＢＡを勉強したいのですが、 初心者～中級者が勉強する程度なら十分だと思われるノートＰＣのスペックを教えてください。 CPU, メモリ, 容量　など、必要そうなスペックを挙げていただけますと幸いです。 よろしくお願いいたします。
Sub Sample1() Dim c As Range, myRng As Range, myCnt As Long With Range("H11") Set myRng = Union(.Offset(, -1), .Offset(-1), .Offset(, 1), .Offset(1)) For Each c In myRng If c < .Value Then myCnt = myCnt + 1 End If Next c Select Case myCnt Case 3 .Interior.ColorIndex = 1 '←「黒] .Font.ColorIndex = 2 '←「白」 Case 2 .Interior.ColorIndex = 6 '←「黄」 .Font.ColorIndex = 3 '←「赤」 Case 1 .Interior.ColorIndex = 5 '←「青」 .Font.ColorIndex = 2 Case 0 .Interior.ColorIndex = 3 '←「赤] .Font.ColorIndex = 2 '←「白」 Case Else .Interior.ColorIndex = xlNone .Font.ColorIndex = xlAutomatic End Select End With End Sub 前回の質問で上記のコードを押していただきました。 With Range("H11")の設定なんですが、Ｈ１１しか比較できなく たとえば、Ｈ６　Ｊ６　Ｌ６と規則性があります。（一個飛ばしです） その時にWith Range("H11")をcellsでＨ６～ＡＬ６までを表すことはできますか？ ほぼ丸投げですが、いま、自分でもネット、本で調べてますが、できるのか、どうかもわからないので、ご教示お願いします。
ExcelVBAのそれほど詳しくは無い者です。 表の下に作成されたグラフのグラフタイトルの有無やグラフの種類を調べて、 正しいかを判断し、セルに結果を表示するものを作っていますが、どうしても グラフの系列をセルに書き出せず、困っています。 セルに書き出したい理由は、書き出された式と予め設定した式が一致する かを確認して結果を別のセルに表示させたいためです。 以下のようにしています。 =SERIESから始まる式をmsgBoxには表示できるのですが、msgBoxではなく 結果をセルに書き出すにはどうすればよいのでしょうか。 セルに式を代入するように書いてみたのですが、書き方が悪かったようで、 どうにも動きませんでした。 ＝＝＝ Sub graph_check() ' グラフが1つの場合だけ処理する If ActiveSheet.ChartObjects.Count = 1 Then With ActiveSheet.ChartObjects(1).chart ' グラフタイトルの有無の判定 If .HasTitle = True Then Range("グラフタイトルの有無の判定を表示するセル番地").Value = "OK" Else Range("グラフタイトルの有無の判定を表示するセル番地").Value = "NG" End If ' グラフタイトルの判定 If Range("グラフタイトルの有無を判定を表示するセル番地").Value = "NG" Then Range("グラフタイトルの文字の一致の判定を表示するセル番地").Value = "NG" Else If .ChartTitle.Text = "指定のグラフタイトル" Then Range("グラフタイトルの文字の一致の判定を表示するセル番地").Value = "OK" Else Range("グラフタイトルの文字の一致の判定を表示するセル番地").Value = "NG" End If End If ' グラフの種類の判定 If .ChartType = xlColumnStacked Then Range("グラフの種類の一致を判定表示するセル番地").Value = "OK" Else Range("グラフの種類の一致を判定表示するセル番地").Value = "NG" End If Dim objChart As chart 　Set objChart = ActiveSheet.ChartObjects(1).chart 　With objChart.SeriesCollection For i = 1 To .Count MsgBox "系列" & i & "のソースデータ範囲は　⇒" _ & vbCrLf & .Item(i).Formula 　↑この部分の=SERIES…をセルに書き出したいのですが、 　　私の力ではどうにもできませんでした 　 Next i End With End Sub ＝＝＝ （セル番地は文字列に置き換えています） 今回の積み上げ縦棒グラフ以外でも元データの範囲が知りたいので、 複数の系列があれば、その数だけ書き出したいと思っています。 しかし自分の持っている知識ではどうにもできず、時間ばかりが経って しまいました。 詳しい方のお知恵を拝借し、初心者にわかるようご教授いただけない でしょうか。 よろしくお願いいたします。
VBA初心者です。 Excel VBAで、指定したフォルダ内のファイルを順に開き、特定のセルの値をコピーし、リスト化したいと考えています。 以下の構文では作業自体はうまくいくのですが、コピー元が数式セルになっているため、値ではなく数式がコピーされてしまい、値がうまく引っ張れない状態です。 ------------------------------------------------------------------------------------------ Sub Sample() Dim Workbook_path As String Workbook_path = ActiveWorkbook.Path & "\test" Dim objFSO As Object Dim objBook As Object Dim lngRow As Long Application.ScreenUpdating = False '集計シートをクリア ThisWorkbook.Sheets("集計").Select Cells.Clear 'FileSystemObjectを変数にセット Set objFSO = CreateObject("Scripting.FileSystemObject") 'フォルダ内のファイル全て繰り返し処理 For Each objBook In objFSO.GetFolder(Workbook_path).Files '貼り付け行(最終行+1)取得 lngRow = ThisWorkbook.Sheets("集計").Range("A" & Rows.Count).End(xlUp).Row + 1 'ファイルを開く Workbooks.Open objBook.Path 'コピー後ファイルを閉じる With ActiveWorkbook .Sheets("Sheet1").Range("A1").Copy ThisWorkbook.Sheets("集計").Range("A" & lngRow) .Sheets("Sheet1").Range("A2").Copy ThisWorkbook.Sheets("集計").Range("B" & lngRow) .Sheets("Sheet2").Range("B1").Copy ThisWorkbook.Sheets("集計").Range("C" & lngRow) .Close End With Next 'オブジェクト変数解放 Set objFSO = Nothing Application.ScreenUpdating = True End Sub --------------------------------------------------------------------------------------------- この部分を値コピーにできればうまくいくと思い色々試したのですが、エラーが生じてしまい、うまくいきません。 ①Copyではなく＝を使用　　⇒　アプリケーション定義またはオブジェクト定義のエラー ②指定したセルのあとにvalueを追加　　⇒　同上 ③各行の末尾に.PasteSpecial Paste:=xlPasteValuesを追加　⇒　コンパイルエラー（修正候補　ステートメントの最後） いずれもHPなどを色々検索して試してみたのですが・・・ 解決策をご教授ください。 ---------------------------------------------------------------------------------------------------- .Sheets("Sheet1").Range("A1").Copy ThisWorkbook.Sheets("集計").Range("A" & lngRow) .Sheets("Sheet1").Range("A2").Copy ThisWorkbook.Sheets("集計").Range("B" & lngRow) .Sheets("Sheet2").Range("B1").Copy ThisWorkbook.Sheets("集計").Range("C" & lngRow) -----------------------------------------------------------------------------------------------------
Sub あああ() Dim a As Variant a = Range("H11") If a < Range("G11") And a < Range("H12") And a < Range("I12") And a < Range("H10") Then Range("H11").Font.Color = RGB(255, 255, 255) Range("H11").Interior.Color = RGB(255, 0, 0) End If End Sub 上記のコードをSelect　caseを使って記載した場合なんですが、 Sub あああ() Dim a As Variant a = Range("H11") Select Case true Case a < Range("G11") And a < Range("H12") And a < Range("I12") And a < Range("H10") Range("H11").Font.Color = RGB(255, 255, 255) Range("H11").Interior.Color = RGB(255, 0, 0) End Select End Sub select case の時はうまくうごきません。 例えば、　セルＨ１０が　セルＨ１１より値が小さくても実行されます。 間違っている場所をご指摘していただけないでしょうか？
excel VBAで、 ユーザからの操作を待ち受け、操作に応じて外部アプリケーションを 起動し、外部アプリケーションウインドウのスクリーンショットを撮り、 保存するアプリを開発しています。 セルに保存したデータをパラメータとして外部アプリケーションに渡すために、 excel上での開発をしています。 当方、プログラミング歴は浅く、Cのポインタ、Javaのオブジェクト指向で頓挫し、 必要に迫られ、VBAとSwiftでコードを書きはじめた初心者です。 参考URL、同じような問題を解決した時の方法、前提知識の誤解の指摘等、皆様のお知恵を拝借いただけますと、幸いです。よろしくお願い致します。 ＜困ったこと＞ 　・外部アプリケーションを起動し、スクリーンショット作成時に用いるwindowsAPIを 　　呼び出した時、オブジェクトが破棄されるため、処理が進まない 　・オブジェクトの破棄は、UserFormを起動したタイミングでも起こっている模様 ＜知りたいこと＞ 　・VBAコード全体でオブジェクト変数を保持するエレガントな方法を知りたい 　・そもそも、VBAで外部アプリケーションとの連携をする際、 　　どのようなプログラム構造であるのが望ましいのか 　　（イベント駆動型のプログラムを書くときの作法　等） ＜アプリケーションのイメージ＞ UserFofmで作成したメニュー画面を表示 　※マクロが入ったexcelファイルの起動時もしくは、別の起動用マクロからUserFormを表示。 ユーザ動作を待ち、UserFormに設置したコマンドボタンを押下した際、下記の処理を行う 　コマンドボタン１(btnLaunch)押下時 　　別のアプリケーション（例えばIE）が起動する 　コマンドボタン２(btnTakePicture)押下時 　　コマンドボタン１で起動したウインドウのスクリーンショットを撮る ※keybd_event(windowsAPI)を使用 　コマンドボタン３(btnTerminate)押下時 　　VBAのコード全体が終了する 　　※コマンドボタン１で生成したアプリケーションのプロセスも正しく終了する ＜アプリケーション全体の構造＞ 　・メインのコードは標準モジュールmainに配置。 　・mainモジュールから呼び出す関数は役割ごとに異なる標準モジュールに配置 　・コマンドボタン押下時に起動するアプリケーションのオブジェクト変数は、 　　mainモジュールのグローバル変数として定義 ＜コード＞ ※細かい部分は省略しています ●mainモジュール ———————————————————————————— Option Explicit 'WindowsAPIの設定 'キーボード関係 Private Declare Sub keybd_event Lib "user32" _ (ByVal bVk As Byte, ByVal bScan As Byte, _ ByVal dwFlags As Long, ByVal dwExtraInfo As Long) Private Declare Function GetKeyboardState Lib "user32" _ (pbKeyState As Byte) As Long Const VK_NUMLOCK = &H90 '「NumLock」キー Const KEYEVENTF_EXTENDEDKEY = &H1 'キーを押す Const KEYEVENTF_KEYUP = &H2 'キーを放す 'Sleep関数 #If VBA7 Then Private Declare PtrSafe Sub Sleep Lib "kernel32" (ByVal ms As LongPtr) #Else Private Declare Sub Sleep Lib "kernel32" (ByVal ms As Long) #End If 'ウインドウ制御関係 'cf. http://www.vba-ie.net/ie/foreground.html Declare Function IsIconic Lib "user32.dll" (ByVal hWnd As Long) As Long Declare Function SetForegroundWindow Lib "user32.dll" (ByVal hWnd As Long) As Long Declare Function ShowWindowAsync Lib "user32.dll" ( _ ByVal hWnd As Long, _ ByVal nCmdShow As Long _ ) As Long Const SW_RESTORE As Long = 9 'for event loop Declare Function GetInputState Lib "user32.dll" () As Long Public objIe As Object Public menuKeyFlg As String Public Sub init() MainCtrl.Show End Sub Public Sub terminate() Unload MainCtrl 　‘その他、オブジェクトの破棄処理等 End Sub Public Sub launch() Set objIe = new_ie(***URL***) ie_submit objIe '無限ループにしておく Do While True If GetInputState() Then DoEvents Sleep 500 Loop End Sub Public Sub takePicture(ByRef objIe As Object) 'ウィンドウが最小化されているかのチェック If IsIconic(objIe.hWnd) Then ShowWindowAsync objIe.hWnd, SW_RESTORE End If 'IEを最前面に表示 SetForegroundWindow (objIe.hWnd) '・ウインドウ全体のスナップショットを作成 　‘ウインドウの表示イメージをクリップボードに保存 Call keystroke Call saveClipBoard End Sub Private Sub keystroke() ' alt+PrtScreenを模擬し、クリップボードに保存 keybd_event VK_LMENU, 0&, fKEYDOWN, 0& 'Altキーを押す keybd_event vbKeySnapshot, 0&, fKEYDOWN, 0& keybd_event vbKeySnapshot, 0&, fKEYUP, 0& keybd_event VK_LMENU, 0&, fKEYUP, 0& 'Altキーを離す End Sub Private Sub saveClipBoard() 　クリップボードの中身を画像ファイルとして書き出す 　**内容省略** End Sub ●UserFormモジュール ———————————————————————————— Private Sub btnLaunch_Click() call launch End Sub Private Sub btnTakePicture_Click() call takePicture End Sub Private Sub btnTerminate_Click() call terminate End Sub Private Sub UserForm_Initialize() call init End Sub
読んでいただきありがとうございます。 ExcelのマクロでIEを操作しサイトから情報収集するツールを作成している者です。 今回教えていただきたいのは、VBAでのIE操作で、サイト参照をし過ぎるとアクセス拒否等をされてしまうケースはあるのでしょうか？ということですm(__)m またその対策があれば教えていただきたいです。 抜粋したものですが下記のようなソースでHtmlファイルを読み込んでいます。 -------------------------------------------------------------- Set ie = CreateObject("InternetExplorer.Application") ie.navigate URL Do While objIE.readystate < 4 On Error GoTo ERR Loop Html = ie.document.all.tags("tbody")(0).innertext Cells(i,1) = Html ie.Quit -------------------------------------------------------------- このようなHtmlファイルを読み込む処理を300回ほどループしています。 指定したURLへアクセスをするループ処理を行う中で、途中から急にURLにアクセスできなくなります。 その後自分で「YAHOOから検索」⇒「リンクをクリック」すると 「404 NotFoundError」となってしまいます。まるでそのサイトからアクセス拒否されているように見えます。 ルータの再起動を行うと「YAHOOから検索⇒リンクをクリック」　でアクセスできますし、ツールでのアクセスもできるようになるので、指定するURLは間違っていません。 ですがしばらくするとまた同じように404エラーが出てしまいます。 悪質なWEBクローラ等とみなされてアクセス拒否をされているのでしょうか。。。 やはり、300回も上記のような処理を繰り返すのは良くないのでしょうか。 ここまで読んでいただきありがとうございます。 是非ご意見、ご回答よろしくお願いいたしますm(__)m
Excel　VBA初心者です。 下記が可能か教えてください。 B列で連続しているデータを参照し、連続したデータと同じ行分A列をセル結合したいのです。 A　　　B 100　　1 100　　1 100　　2　 200　　3 ↓ A　　　B 100　　1 　　　　1 100　　2 200　　3 こんな感じです。 連続したデータが入力されているセルを結合する方法は、検索して見つかったのですが、この場合は、どうしたらいいでしょうか？ どうぞよろしくお願いいたします。
エクセルマクロの外部ファイル出力の件で伺いたい事が御座います。 現在 元sheet、発注書sheet、CSV用sheetという3つを、同じブックに御座います。 元sheetに２つのボタン(図挿入)で行い、それぞれに以下のマクロを1つずつ設定しております。 ------------------------------------------------------------------------------------------------------------ １．PDF保存 Sub PDF保存() Dim fName As String '保存ファイル名及び保存場所の設定 fName = Application.GetSaveAsFilename(, "PDFファイル,*.pdf") '保存操作 Sheets("発注書").ExportAsFixedFormat Type:=xlTypePDF, Filename:=fName End Sub ２．CSV保存 Private Sub CSV保存() Dim fn 'ファイル名を整える fn = Format(Now(), "yyyymmdd_hhmm") & "_ファイル.csv" '保存先を選択させる fn = Application.GetSaveAsFilename(fn, "CSVファイル,*.csv", 1, "保存先の指定") 'キャンセルなら中止 If fn = "False" Then Exit Sub 'Sheet3をコピー Worksheets("CSV用").Copy 'CSV形式で保存 ActiveWorkbook.SaveAs Filename:=fn, FileFormat:=xlCSV '保存せずに閉じる ActiveWorkbook.Close SaveChanges:=False End Sub ------------------------------------------------------------------------------------------------------------ →上記２つの時、出力ファイル名を以下の様に出力できるように変えたいです。 ・PDF保存 １．出力先をデスクトップのPDFフォルダに ２．出力ファイル名を、「元sheetのA１＋発注書sheetのB1」に設定 ・CSV保存 １．出力先をデスクトップのCSVフォルダに ２．出力ファイル名を「元sheetのA１＋発注書sheetのB1＋CSV用のB1」に設定 以上です。 簡易的なマクロを友人に教えてもらいましたが、上記を聞いたら分からないとの事でしたので、こちらへ質問させて頂きました。 ご教授下さい。 よろしくお願いいたします。
エクセルのマクロで構成できないので、教えて頂きたいです。 現在以下の様な２つのマクロを同じブックに設定しております。 １．データコピー Sub データコピー() Dim fName As Variant Dim bk1 As Workbook, bk2 As Workbook Dim st As Worksheet '参照したいBookの選択を行う fName = Application.GetOpenFilename("Excel ブック,*.xls?,すべてのファイル (*.*),*.*") If fName = False Then Exit Sub '選択されたブックを開く Set bk1 = Workbooks.Open(fName) '選択されたブックにSheet1があるかどうか調べる Set st = Nothing On Error Resume Next Set st = bk1.Worksheets("Sheet1") On Error GoTo 0 'Sheet1がなければメッセージを表示する If st Is Nothing Then MsgBox ("選択されたブックにはSheet1がありません。") Else '選択されたブックのSheet1!A1:P45をこのブックに貼り付ける st.Range("A3:P45").Copy ThisWorkbook.Worksheets("★貼り付け").Range("A3") End If bk1.Close False End Sub ２．採番 Sub Auto_Open() With Sheets("★貼り付け").Range("IV1") .Value = .Value + 1 End With End Sub この状態ではブックを開く度に、採番数字が増えてきます。 しかし今回は、１の作業の中に２を埋め込みたいです。 データをコピーしてくる度に、採番数字を増やしていきたいです。 どのようにすれば、構成出来ますか？ ご教授下さい。 よろしくお願いいたします。
Excelで連番を出す方法が分からないです。 10シート程有るのですが、入力ごとにシートをまたいでも連番が出る様にしたいのですが分からないです。Excel初心者です。 例えば、Bに入力してAに連番が出る様にして3シート目のBに入力して5シート目のBにいくつか入力して3シート目にBに入力してまたいで途中削除あっても出来るというやり方を教えて頂きたいです。どうかお願いします。
ＡＣＣＥＥＳＳ２０１３を利用しています。 ＶＢＡでストップウォッチを作成したいのです。 自作では、簡単なのはできたのですが、 スータト⇒ストップ⇒スタート　⇒このとき0秒の戻ってしまいます。 スタート　ストップ　一時停止がほしいのですが、 一時停止の作成ができません。 ネットで調べても、見つけることができませんでした。 ほぼ、丸投げ状態ですが、ご教唆お願いします
セルA2,A3に「， 」で区切った文字列を検索してB列のどこにあるかさがすコードを考えています。 初めにセルA1の文字列をSplit関数を使って個別に格納してFind関数またはIF文とFor文を使って処理しようと考えていました。しかしうまくいきません。 どなたか解る方がいましたら教えていただけますでしょうか？ 参考に画像を添付します。 以上、よろしくお願いします。
こんばんは！いつも質問させていただいている、Nieと申します。 仕事で始めたVBAですが、その奥深さにどっぷりはまっている者です！！ 今、添付画像のように、アルファベットが入っているセルにのみ、番号が割り振られているシートがあります（※自分で本文最下部にあるコードを作成ために便宜上わりふっているだけです） これを画像の黄色のテーブルのように並び替えたいのですが、上手くいかないため、VBAにお詳しい方！どなたか、この要望を叶えるコードをご教示いただけないでしょうか！？ （ちなみに自分でコードを書いてみたら、F列からI列に１行ずつずれて値が入りました。恥） 尚、恥ずかしながら自身で書いてみたコードは下記のとおりです。 これだと、仮に連番が増えたり、テーブルの行・列が増えた場合の処理が非常に大変です＞＜。。。 「こんなコードは全くなってない！けしからん！」ということであれば、 全く１から異なるコードをご提示いただくのでももちろん構いません（それはそれで狂喜乱舞します） お手数をおかけしてしまいますが、ご回答おまちしております＞＜。。。。 記================================= Sub 並び替え() Dim iRow As Long iRow = 0 For iRow = 1 To Cells(Rows.Count, "B").End(xlUp).Row If Cells(iRow, "A") = 1 Then Cells(iRow, "F") = Cells(iRow, "B") ElseIf Cells(iRow, "A") = 2 Then Cells(iRow, "G") = Cells(iRow, "B") ElseIf Cells(iRow, "A") = 3 Then Cells(iRow, "H") = Cells(iRow, "B") ElseIf Cells(iRow, "A") = 4 Then Cells(iRow, "I") = Cells(iRow, "B") ElseIf Cells(iRow, "A") = "" Then Cells(iRow, "I") = Cells(iRow, "A") ElseIf Cells(iRow, "A") = 5 Then Cells(iRow, "F") = Cells(iRow, "B") ElseIf Cells(iRow, "A") = 6 Then Cells(iRow, "G") = Cells(iRow, "B") ElseIf Cells(iRow, "A") = 7 Then Cells(iRow, "H") = Cells(iRow, "B") ElseIf Cells(iRow, "A") = 7 Then Cells(iRow, "I") = Cells(iRow, "B") ElseIf Cells(iRow, "A") = 8 Then Cells(iRow, "I") = Cells(iRow, "B") jRow = iRow + 1 End If 以上================================= 何卒よろしくお願いします。。。。
エクセルでマクロ、またVBAプログラムほんの少し経験があります。昔です。今７２才。ボランティアで新しい（必要な）ことやろうとしています。会員700人程のデータがあるのですが、郵送物があり、今後手書きでは大変なので、マクロ、またはVBAで裏のりの付いたシールラベルに印刷することを考えています。どこから手をつけていいのでしょう。簡易ソフトを購入という手もあれば賢明ならその手もありますが、マクロ、またVBAの楽しさを忘れないのですが。
Excel VBA 初心者です。 B4に入力するとC3〜F3までコピーしたものを C4〜F4にペーストする方法知りたいです。 ただDとF幅が広いです。 【Bがアクティブになると1つ上のC〜Fのコピーして下のC〜Fにペーストしたいです。』 後、Cがアクティブになると一つ上をコピーしてスクロールバー1〜15まで選べて数字の数だけ下にペーストしたいと思っています。 分からないので教えて下さい。
現在左側のような画像のExcelデータがあります。 そこで、商品名の所に0が入っている行と、「量」という文字が入っている行を削除し、 それだけだと行が少ない場合にとても見づらいので、 「部署」から「小計」までの間が最低18行以上になるようにしたいです。 現在下記のコードを使用し0と「量」が入っている行の削除まではできたのですが、 行の挿入の仕方がわかりません。 どなたかご教授頂けないでしょうか。 現在のコードです。 Sub del() Dim i As Long Application.ScreenUpdating = False For i = Cells(Rows.Count, "C").End(xlUp).Row To 1 Step -1 If InStr(1, Cells(i, "C"), "0", vbTextCompare) > 0 Then Rows(i).Delete ElseIf InStr(1, Cells(i, "C"), "量", vbTextCompare) > 0 Then Rows(i).Delete End If Next Application.ScreenUpdating = True End Sub このコードにおかしな部分もあれば指摘していただければ有難いです。 ちなみに今消している「0」と「量」は他のシートからリンクしているのでどうしても入ってしまいます。 行数は1行だけの時もあれば100行以上の時もあります。 バージョンは2003で、私はVBAを習い始めたばかりで実用で使えるレベルではないです。 宜しくお願いします。
お世話になります。 マクロについて質問です。 シート1のF9に入力された数値にD9の数値を掛けて シート2のF9の入力されている数値へ足していき さらにシート1のF9が終わると下のセルへ順次同じ計算をしていく！ シート1 F9×D9=X シート2 F9=シート2 F9+X 下へ シート1 F10×D10=X シート2 F10=シート2 F10+X 下へ ・ ・ ・ という感じです。 ボタンを押したら実行にしたいので 標準モジュールを使いたいです！ 初心者なのでどうしたらいいかわかりません。 説明がわかりにくいかも知れませんが 教えてください！
ファイル内の沢山のマクロ有効ファイルを自動でxlsm形式からcsv形式に変換するプログラムを作成したいと思い、ネツト等で調べ下記のマクロを組みましたが、うまく作動しません。 どうすればできるようになるかご存知の方がいれば教えていただけないでしょうか？ Sub ボタン2_Click() Dim myObj As Object Dim myDir As String Dim myFileName As String Dim myFileList As String Dim myFileCount As Long Dim wb As Workbook 'フォルダ選択ダイアログの表示 Set myObj = CreateObject("Shell.Application"). _ BrowseForFolder(0, "フォルダを選択してください", 0) If myObj Is Nothing Then Exit Sub myDir = myObj.Items.Item.Path If Right(myDir, 1) <> "\" Then myDir = myDir & "\" 'フォルダ内のExcelファイルを確認 myFileName = Dir(myDir & "*.xlsm") Do While myFileName <> "" If myFileName <> ThisWorkbook.Name Then myFileList = myFileList & Chr(13) & myFileName myFileCount = myFileCount + 1 End If myFileName = Dir() Loop If myFileCount = 0 Then MsgBox "ファイルは見つかりませんでした。マクロを終了します。", 48 Exit Sub ElseIf vbNo = MsgBox(myFileCount & " 個の .xlsm ファイルが見つかりました。マクロを実行しますか？" _ & Chr(13) & myFileList, 4, "ファイル確認") Then MsgBox "キャンセルしました。" Exit Sub End If 'CSV処理 myFileName = Dir(myDir & "*.xlsm") Do While myFileName <> "" Application.DisplayAlerts = False Application.ScreenUpdating = False If myFileName <> ThisWorkbook.Name Then Workbooks.Open (myDir & myFileName) Workbooks(myFileName).Activate ActiveWorkbook.SaveAs Filename:=myDir & Left(myFileName, Len(myFileName) - 4) & "csv", _ FileFormat:=xlCSV, CreateBackup:=False ActiveWorkbook.Close ↑上記３行でエラー発生 End If myFileName = Dir() Loop Application.DisplayAlerts = True Application.ScreenUpdating = True MsgBox "完了しました。" End Sub
初心者です。 これまで下記サイトより、webクエリーを使ってエクセルに時系列データを取込んでいたのですがサイトの構成が変わりできなくなりました。 ＩＥを制御して取込む方法を試してみましたが、うまくできませんでした。マクロコードを記述して教えていただければありがたいです。（いろんな方法を教えていただいても初心者なので私の力ではできないと思います。） よろしくお願いします。 http://k-db.com/stocks/8306-T/4h
CDOメッセージオブジェクトを使用し、EXCEL2010 VBAよりメール送信を実現したいのですが．． 下記コードの .Sendを実行後にエラーメッセージ「[6]オーバーフローしました」が表示されます。 試行錯誤しておりますが..自力では解決できないため、皆様よりご教授賜りたく何卒よろしくお願い 申し上げます。 --------------------------------------------------------------------------------------------------------- Public Sub SendMail() Dim objCDOMsg As New CDO.Message '/* CDOメッセージオブジェクト */ '// Dim objCDOMsg As Object '/* CDOメッセージオブジェクト */ '// Set objCDOMsg = CreateObject("CDO.Message") With objCDOMsg ' /* メールサーバ設定 */ With .Configuration.Fields .Item(CdoConfiguration.cdoSendUsingMethod) = CdoSendUsing.cdoSendUsingPort '/* 外部SMTP指定 */ .Item(CdoConfiguration.cdoSMTPServer) = "111.222.333.44" '/* SMTPサーバ名 */ .Item(CdoConfiguration.cdoSMTPServerPort) = 25 '/* ポート№ */ .Item(CdoConfiguration.cdoSMTPConnectionTimeout) = 60 '/* タイムアウト */ .Item(cdoSMTPAuthenticate) = cdoAnonymous '/* SMTP認証なし */ .Item(CdoConfiguration.cdoLanguageCode) = CdoCharset.cdoShift_JIS '/* 文字セット */ .Update End With ' /* メール編集 */ .To = "test@aaa-bbb.com" '/* 宛先 */ .CC = "test@aaa-bbb.com" '/* CC */ .From = "test@aaa-bbb.com" '/* 送信者 */ .Subject = "Test mail" '/* 件名 */ .TextBody = "メール本文" '/* メール本文 */ .AddAttachment "C:\Users\term\Desktop\TempFile.txt" '/* 添付ファイル */ ' /* メール送信 */ .Send <------------------- このコードをステップ実行後にエラーメッセージ表示 End With ' /* オブジェクト変数解放 */ Set objCDOMsg = Nothing End Sub --------------------------------------------------------------------------------------------------------- [実行環境] ・Windows 7 Professional SP1 ・EXCEL 2010 （Ver. 14.0.7165.5000） ・Outlook 2010（Ver. 14.0.7165.5000） [補足] ・Outlook セキュリティセンターの設定 DEP有効、マクロ警告、プログラムアクセス警告 ・Outlook アカウント種類 POP/SMTP 以上、宜しくお願いいたします。
24時間稼動しているガソリンスタンドの勤怠管理をVB2013で作成しています。 1日の実働時間中に深夜時間帯が何時間含まれているかを判断したいのですが 良いロジックが浮かばなくて困っています。 条件としては以下の内容です。 深夜時間帯開始時刻：22：00 深夜時間帯終了時刻：06：00 勤務形態は完全なシフト勤務で勤務開始時刻、終了時刻は決まっていません。 勤務開始時刻が深夜時間帯になる場合、勤務終了時刻が深夜時間帯になる場合 勤務開始時刻、勤務終了時刻が深夜時間帯をまたぐ場合 1日の実働時間全てが深夜時間帯になる場合などがあります。 過去に同様のロジックを作成したことのある方や、解決方法をご存知の方は 返信お願いします。
マクロ超初心者です　ファイルの読込フォルダを固定から選択式に変更したいです。 下記のC:\test\フォルダの指定をコメントバック部分に入れ替えただけでは 「実行時エラー'13' 型が一致しません。」となってしまいます。 何か定義の型とか色々と修正しないと駄目かと思いますが、超初心者が切り貼りで 作っている状態でぜんぜんわかりません。 どなたか教えてください、よろしくお願いします。 Private Const MESSAGE_START = "ファイルの読み込みを開始します" & vbCrLf & "フォルダを選択してください。" Private Const MESSAGE_FINISH = "ファイルの読み込みが完了しました" Sub ExcelbookCombine() '------------------------------------------------------------------------------------------------------- '処理開始 '------------------------------------------------------------------------------------------------------- MsgBox MESSAGE_START Range("A2:Z10000").Select Selection.ClearContents Range("A2:Z10000").ClearFormats 'With Application.FileDialog(msoFileDialogFolderPicker) ' If .Show = 0 Then Exit Sub ' FolderPath = .SelectedItems(1) 'End With Const Fol As String = "C:\test\" Dim Fn Dim NewFile As Workbook Dim Wb As Workbook Dim Ws1 As Worksheet Dim Ws2 As Worksheet Dim R As Range Dim SrcRng As Range Dim Rng As Range Set SrcRng = ActiveSheet.Range("A2") Set Ws1 = Worksheets(1) Set R = Ws1.Range("A2") Fn = Dir(Fol, vbNormal) Do Until Fn = "" Set Wb = Workbooks.Open(Fol & Fn) 'ワークシート1をコピーする場合は Wb.Worksheets(1) 'ワークシート2をコピーする場合は Wb.Worksheets(2) Set Ws2 = Wb.Worksheets(1) 'Aの2行目から8列目までをコピーして結合する 'Ws2.Range("A2", Ws2.Cells(Rows.Count, 1).End(xlUp)).Resize(, 17).Copy R ' Set R = R.End(xlDown).Offset(1) 'Ws2.Range("A2", Ws2.Cells(Rows.Count, 1).End(xlUp)).Resize(, 17).Copy R 'Ws2.Range("A2:P" & Ws2.Range("A65536").End(xlUp).Row).Copy R.Range("a" & Ws1.Range("a65536").End(xlUp).Row).EntireRow.PasteSpecial(xlPasteValues) 'Ws2.Range("A2:P" & Ws2.Range("A65536").End(xlUp).Row).Copy Ws1.Range("a" & Ws1.Range("a65536").End(xlUp).Row + 1).PasteSpecial(xlPasteValues) ' Set R = R.End(xlDown).Offset(1) ' データの行数 = Ws2.Cells(Rows.Count, 1).End(xlUp).Row ' Ws1.Range("A2:P" & データの行数).Value = Ws2.Range("A2:P" & データの行数).Value With Wb.Worksheets(1) Set Rng = Ws2.Range("A2", Ws2.Cells(Rows.Count, 1).End(xlUp)).Resize(, 16) SrcRng.Offset(i).Resize(Rng.Rows.Count, 16).Value = Rng.Value i = i + Rng.Rows.Count '一行開ける End With Wb.Close 'Debug.Print Fn Fn = Dir Loop MsgBox MESSAGE_FINISH Set R = Nothing Set Ws1 = Nothing: Set Ws2 = Nothing Set Wb = Nothing: Set NewFile = Nothing End Sub
Range(Cells1, Cells2)=Arr のように２次元配列からセル範囲に一気代入が可能ですが、Value扱いでFormulaになりません。 "=A1+B1"のように文字列が表示されます。セルをアクティブにして、文字列をちょっと触り編集したかのようにした後リターン押すと、関数式になります。 何か方法はあるでしょうか？もちろん配列にする位だから、データ数は結構あります。
下記のようなPGMを書いたのですが、たとえば、yahooのニュースなどのURLを入れた場合は、 テキストをちゃんと取ってきます。ですが、amazonの商品などを指定した場合はエラーが出ます。 エラーの内容は、プロシージャの呼び出し、または引数不正です。エラーが出ているのは、 objTxtfil.Write strBdytxt & vbcrlf　の41行目です。　 どなたかわかりませんでしょうか？ PGMはこちら↓ Set objInterE = WScript.CreateObject("InternetExplorer.Application") Set objFsystm = WScript.CreateObject("Scripting.FileSystemObject") Set objShells = WScript.CreateObject("WScript.Shell") arrWebUrl = Array( _ "https://www.amazon.co.jp/gp/product/B00IB84W6G/r … ) objInterE.Width = 1024 objInterE.Height = 768 objInterE.Left = 0 objInterE.Top = 0 objInterE.Statusbar = True objInterE.ToolBar = True objInterE.Visible = True '保存ファイル名を指定 Set objTxtfil = objFsystm.OpenTextFile(objShells.SpecialFolders("Desktop") & "\copytest.txt" ,2,True) For intWebUrl = 0 to UBound(arrWebUrl) 'URLを開きます objInterE.Navigate arrWebUrl(intWebUrl) Do Until objInterE.Busy = False WScript.sleep(300) Loop '内容テキストを取り出します strBdytxt = objInterE.Document.Body.InnerText msgbox strBdytxt objTxtfil.Write strBdytxt & vbcrlf Next '終了処理します objTxtfil.Close Set objInterE = Nothing Set objFsystm = Nothing Set objShells = Nothing MsgBox "取得が終了しました" , vbInformation , "VBScriptテスト"
VBAで教えて頂きたいことがあります。 【リスト1】のような表を毎日入手します。 それを【リスト2】のような、列に日にち、行に食品の種類が書かれた表の「消費」の行に数字をコピーしたいのですが、どのようなマクロを書けばいいですか。 A列：食品の種類。B列：購入or消費。C列以降：日にち。です。 【リスト1】 消費日 4/3 ---------------- みかん 10　　　 ⇒セルE3にコピー とまと 4　　　 ⇒セルE9にコピー なす　　 6 　　 ⇒セルE11にコピー 【リスト2】 　　　　A列　Ｂ列　　　 C 列 　D列 E列 F列 　 G列 ～ 　AF列 1行　　　 　　　 4/1 　　4/2 4/3 　 4/4 　 4/5 ～ 4/30 　　--------------------------------------------------------------------- 2行　　みかん 購入 3行　　 　　　 消費 　　--------------------------------------------------------------------- 4行　　りんご 購入 5行　　 　　 消費 　　--------------------------------------------------------------------- 6行　　ぶどう 購入 7行 　　　 　 消費 　　--------------------------------------------------------------------- 8行　　とまと 購入 9行 　 　　 　 消費 　　--------------------------------------------------------------------- 10行　　なす 購入 11行　　 　　 消費 　　--------------------------------------------------------------------- どうぞよろしくお願いいたします。
以前こちらで紹介されていた、『Excelで複数のファイルから抽出(3～5行目だけを集めたファイルを作りたい)』の以下のマクロを活用させていただいております(有難うございます。) 例えば、3～5行目の『値のみ』を集約したい(貼り付けたい)場合は、どのような構文を追加したらよいですか？基本的な質問で申し訳ありませんが、教えてください。 Sub ファイルから抽出()   Dim FName As String   Dim Folder As String   Dim WB As Workbook   Dim i As Integer, j As Integer   Application.ScreenUpdating = False   Folder = ThisWorkbook.Path & "\"   i = 1: j = 1   Worksheets(1).Cells.ClearContents   FName = Dir(Folder & "*.xls")   Do While FName <> ""     If FName <> ThisWorkbook.Name Then       Workbooks.Open (Folder & FName)       Workbooks(Workbooks.Count).Worksheets(1).Rows("3:5").Copy _       ThisWorkbook.Worksheets(1).Cells(i, 1)       Workbooks(Workbooks.Count).Close       Application.StatusBar = j & "ファイル処理済み"       i = i + 3: j = j + 1     End If     FName = Dir()   Loop   Application.StatusBar = ""   Application.ScreenUpdating = True   MsgBox ("完了しました") End Sub
プログラム初心者です。 業務でエクセルに画像を貼り付けしデータを管理しています。 今は手動で挿入しているのですが、データが多くなると間違えや手間が増えて困っています。 あらかじめ決められたエクセルのフォームに、ドロップするだけで整列できるプログラムを作りたいのですが、エクセルでＶＢなどで開発可能でしょうか？ できれば、画像ファイル名の順番にならべてくれるようなものを望みます。
いつもお世話になります For Each wSheet In Worksheets If wSheet.name <> "*予定*" Then ・・・・・・・・ End If 予定という文字が含まれるシート名を除外したいのですが　上記のコードでは除外してくれません。 どなたか　お時間ある方で　ご教示して頂ける方いらっしゃいましたらお願い致します。
"コーラ"という値を含むセルが見つかったら、そのセルより8行上、４列右までのセルの値を空白にしたい。 ・シートが１０００シートほどあり、すべてに適用したい このような感じなのですが、効率のいいマクロを教えていただけないでしょうか？
お世話になります。 VBA（およびVBS）の参照渡しについてです。 関数でByRefと宣言しているのに、呼び出す際、引数を（）で囲うと強制的に値渡しになります。 何故、このような仕様になっているのか、背景をご存知でしたら教えていただきたいです。 （そもそも参照渡しは良くないと思いますが、エラーで返してくれないとバグの温床になりそうな気がします） '-----------------Sample.vba-------------------- Sub Test() Dim num : num = 0 RefSample ( num ) '強制的に値渡しになるので num = 0　のまま Call RefSample( (num) ) '同じく強制的に値渡し End Sub Sub RefSample(ByRef num )　 ’参照渡し 　num = 1 End Sub
プログラミング初心者です。 ExcelVBAマクロの実行時、ある端末では、エラーが出ずに正常に処理を行いますが、 別の端末では、『オブジェクト変数またはWITHブロックが設定されていません』のエラーが出て、処理が実行出来ません。 Excelの環境設定によるものかと考えていますが、原因が分かりません。 対象の2台はいずれも、OS：Windows7 32ﾋﾞｯﾄ、Excel2010を使用しています。
直接ＶＢＡで無く恐縮ですが Windows の時刻同期間隔(ntpサーバーとの同期間隔)はデフォルトで１週間「604800秒」だそうです。 http://tm.root-n.com/misc:windowsxp_time_poll_in … で、WIN8/WIN10　でも　有効でしょうか？もしくは、ご教示願えれば助かるのですが もしくは、 http://homepage2.nifty.com/nonnon/SoftSample/VB. … VB.NETのサンプルは有ったのですが、VBAのサンプルはどこかにないでしょうか
常駐プログラムを停止する方法を教えてください
こんばんは 以下のようにmyListの中に、「果物」、「県名」、「月名」にカテゴリー分類された配列があります。 そして、Recipe配列の中に記載してある、それぞれの要素がmyListのどのカテゴリーに分類されているかを検索し、最終的には、それぞれのカテゴリーに分類された中身を表示したいのです。 下記の例では、最終的にDebug.printにて 果物 = りんご、いちご、バナナ 県名 = 静岡 と表示したいのです。（該当するものがないカテゴリー（今回は月名）は表示しない） Filter関数にて、要素がカテゴリーリストに存在するかどうかはできたのですが、最終的にカテゴライズして表示する方法がわかりませんでした。 すみませんが、教えていただけると幸いです。 Sub Test() Dim myList , Recipe myList = Array( _ Array("メロン", "りんご", "バナナ", "ナシ", "いちご"), _ Array("神奈川", "東京", "静岡", "千葉", "埼玉"), _ Array("1月", "2月", "3月", "4月", "5月") _ ) Recipe = Array("りんご", "静岡", "いちご","バナナ") End Sub
Sheet1のデータをそのままcsv形式で保存したいのですが、その際Sheet2のA1の値をファイル名にし、csvを発行する度に無条件で上書き保存するマクロを組みたいのですが、調べて試してもうまくできませんでした。 いい方法ご存じの方、いらっしゃいますか？ 宜しくお願い致します。
写真台帳として使っているんですが 写真を消すと台帳の方の写真も消えてしまうので 変えたいのでお願いします。 いろいろ調べてリンク貼の解除を見様見真似でやったんですが 今度は写真台帳のfile自体が重くなってしまいました。 今までは200kb前後で収まっていたのに、5mbぐらいになってしまいます。 改善のやり方をお願いします。 Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, _ Cancel As Boolean) Dim myPic Dim myRange As Range '画像を配置するセル範囲 Dim rX As Double, rY As Double If Intersect(Target, Range("L2,L14,L26")) Is Nothing Then Exit Sub myPic = Application.GetOpenFilename("画像ファイル,*.jpg;*.jpeg;*.gif;*.tif") If VarType(myPic) = vbBoolean Then Exit Sub Set myRange = Target 'このセル範囲に収まるように画像を縮小する Application.ScreenUpdating = False With ActiveSheet.Pictures.Insert(myPic).ShapeRange rX = myRange.Width / .Width rY = myRange.Height / .Height If rX > rY Then .Height = .Height * rY Else .Width = .Width * rX End If .Left = .Left + (myRange.Width - .Width) / 2 '写真を横方向の中央に配置 .Top = .Top + (myRange.Height - .Height) / 2 '写真を縦方向に中央に配置 End With Application.ScreenUpdating = True Cancel = True End Sub
エクセルデータが有り、A列からU列迄約5000件　A列にはNO1　2　3と有り、昇順にデータを並び替えたい、その間に【プログレスバーフォーム】○○％とか、を表示させたいのですが、どのようにマクロを組んだらいいか教えて下さい。 お願いします。 他のサイトには、プログレスバーフオームの事記載が有るものの、難しくて解りません。
VB.NETでプログラミングを行っております。 テンキーの何を押されたかによって処理を振り分ける箇所で KeyPressイベント時に'0'と'00'を区別したいのですが、 '00'は'0'の処理を2回連続行う仕様になっているようで、 e.KeyCharでは識別できません。 識別できる上手いやり方をご存知の方いましたら 教えていただきたいです。
関数計算を用いて以下の計算をしたとします B1=Sum(A1:A10) B2=Sum(A11:A20) この時、以下の操作をした場合に再計算されるのでしょうか？ ・A50の値を変更した時（もちろんB1, B2とも値は変更なしですが） ・A11の値を変更した時にB1は再計算されるか？ ・隣のシートのA1を変更した時は再計算されるか？ マクロを回す際に関数計算を保留しておき最後に回すことが多いですが、関数計算に使うセルが変更された時「だけ」再計算されるなら、保留しなくても計算時間は同じでは？と思い質問してます。
VBSを勉強中です。下記URLによるとnotepadの起動は出来るようですが、編集は可能でしょうか？ http://www.roy.hi-ho.ne.jp/mutaguchi/wsh/index.h … 編集は始めの2, 3行だけです。notepad用のコマンド一覧とかあるのでしょうか。 エクセルVBAはそこそこ出来ます。
3152.8　-　20.3＝3132.7 3132.5になってほしいのですが、、、。 K3　-　K2　＝　K1です。 Dim buf As Double With sh1 　For i = 6 To 200 'Sheet1の6行目から200行目まで' If InStr(Range("F" & i), "控除") > 0 Then buf = buf + Range("K" & i) 　End If Next i Range("J1") = "使用量" Range("J2") = "空" Range("J3") = "合　計" Range("K3").Formula = "=SUM(K5:K212)" Range("K2") = buf Range("K1") = Range("K3") - Range("K2") 　For i = 1 To 3 Range("K" & i).NumberFormatLocal = "0.0"
EXCELマクロで台帳のシステムをつくっています。 台帳の入力が完了した後EXCELを閉じるタイミングで、 バックアップをとるために新しいブックを作成してデータを コピーしたいと思い、Workbook_BeforeClose　のなかで 新しいブックを作成する処理をいれました。 EXCELの右上のＸで閉じたときには うまく作成されるのですが、自作の終了ボタンから閉じたときには Workbook_BeforeClose　& 終了処理 には入るのですが新しいブックを作成する 箇所がスルーされてしまいます。 デバッグモードでみても該当箇所は通っているのですが、作成はされず エラーになるわけでもありません。 いろいろ試してみましたがさっぱりわかりません。 詳しい方、教えてください。 ・WINDOWS10 ・EXCEL2013 ・終了ボタンの処理 　　Sub ボタン6_Click() 　　　 ThisWorkbook.Close True 　　End Sub ・Private Sub Workbook_BeforeClose(Cancel As Boolean) Dim rc As Boolean rc = Application.Run("BOOK1.xlsm!終了処理") If rc = True Then Cancel = True Exit Sub End If ・BOOK1.xlsm!終了処理 　　　　・ 　　　　・ 　　　　・ Workbooks.Add.SaveAs FileName:=XXpass & "\XXXX.xls" Worksheets.Add().Name = XXXX 　　　　・ 　　　　・
エクセル初心者です。 ユーザーフォームで検索窓を作成しリストボックスへ表示 　　　　　　　　　↓ リストから選択すると同じユーザーフォーム内のテキストボックスに値が自動で表示 　　　　　　　　　 というフォームを作りたいのですがご教授お願いします。 A列　　　B列　　C列　　　D列　　　E列 番号　/　品名　/　品番　/　原価　/　メーカー 1　　　　A　　　20×20　　100　　A社 2　　　　A　　　20×30　　150　　A社 3　　　　B　　　50×50　　100　　B社 下図のようなフォーマットで考えています。
お世話になります。 VBA初心者の者です。 タイトルの通りのなのですが、以下の通りコードを作りました。 A列に文字が入力されると、F列に日付が入力されることを目指して成功しています。 しかし、ここで AとE列同時にデータをペーストすると、なぜかB列に日付が 入ってしまいます。 どのように変化させれば宜しいでしょうか。 ご教授下さい。よろしくお願い致します。 （※ excel2003を使用） Private Sub Worksheet_Change(ByVal Target As Range) If Target.Column = 1 Then If Cells(Target.Row, 1).Value <> "" Then Status = Date Else Status = "" If TypeName(Target.Value) <> "Variant()" Then Cells(Target.Row, 6).Value = Status Else _ For i = 0 To UBound(Target.Value) - 1: Cells(Target.Row + i, 2).Value = Status: Next End If End Sub
Columns("AO") = Application.Round(Columns("AO"), 0) 列　A0の数値を（”AO6”）から下にデータがある部分のみ四捨五入して整数で表示させる というのを試しているのですが、何かが足りないようでして、教えていただけませんでしょうか。 For i = 6 To Cells(Rows.Count, 2).End(xlUp).Row Columns("AO") = Application.Round(Columns("AO"), 0) Next i
前任者が作成したＥＸＣＥＬの勤務計算表の計算式がわかりません。 まったくの素人ですのでどなた様かご教授いただければ幸いです。 勤務時間　8：00　～　17：00　（勤務時間8.0ｈ） 　　　　　　　　　　　　　　　　　　　就業　 公休 　Ｄ8　　Ｆ8　　　　Ｈ8　　　Ｊ8　　 Ｌ8　　Ｍ8 8：00　12：00　　13：00　17：00　　8.0　　0.0 上記のようにセルに入力されると就業時間、公休時間が表示されるようになっております。 計算式は下記です。 Private Sub Worksheet_Change(ByVal Target As Range) Dim W1 If Intersect(Target, Range("D8:J38")) Is Nothing Then Exit Sub W1 = Target.Row Cells(W1, 12).Value = (Minute(Cells(W1, 6).Value) / 60 + Hour(Cells(W1, 6).Value)) - (Minute(Cells(W1, 4).Value) / 60 + Hour(Cells(W1, 4).Value)) + (Minute(Cells(W1, 10).Value) / 60 + Hour(Cells(W1, 10).Value)) - (Minute(Cells(W1, 8).Value) / 60 + Hour(Cells(W1, 8).Value)) Range("Ｄ8").Activate Application.ScreenUpdating = False Do Until ActiveCell.Value = "" If ActiveCell.Offset(0, 0) < Range("S1").Value And ActiveCell.Offset(0, 7) > 8# Then ActiveCell.Offset(0, 9).Value = (Minute(Range("S1").Value) / 60 + Hour(Range("S1").Value)) - (Minute(ActiveCell.Offset(0, 0).Value) / 60 + Hour(ActiveCell.Offset(0, 0).Value)) Else ActiveCell.Offset(0, 9).Value = 0 End If ActiveCell.Offset(1, 0).Activate Loop Worksheets("春").Select Range("J8").Activate Do Until ActiveCell.Value = "" If ActiveCell.Offset(0, 0) > Range("T1").Value Then ActiveCell.Offset(0, 4).Value = (Minute(ActiveCell.Offset(0, 0).Value) / 60 + Hour(ActiveCell.Offset(0, 0).Value)) - (Minute(Range("T1").Value) / 60 + Hour(Range("T1").Value)) Else ActiveCell.Offset(0, 4).Value = 0 End If ActiveCell.Offset(1, 0).Activate Loop Worksheets("春").Select Range("L8").Activate Do Until ActiveCell.Value = "" If ActiveCell.Offset(0, 0) < 8# Then ActiveCell.Offset(0, 1).Value = 8# - ActiveCell.Offset(0, 0).Value Else ActiveCell.Offset(0, 1).Value = 0# End If ActiveCell.Offset(1, 0).Activate Loop Application.ScreenUpdating = True ActiveCell.Offset(0, 1).Activate End Sub 質問なのですが このたび午前、午後に休憩時間を15分引いて計算することになり 就業時間、公休時間を7.5ｈに変えて提出することとなりました。 ①午前休、午後休もある勤務体系です。 ②半休した場合は3.75ｈと表示したい ③一日勤務の中で、例えば午前に2時間勤務して帰る場合もあります。 午後も同様です。※フレックスタイム その場合も15分休憩したものとみなします。 質問内容がわかりずらくて申し訳ありませんが よろしくお願いいたします<m(__)m>
お世話になります。 VBAを初心者なのですが、質問させてください。 タイトルにありますように、まず Sheet1 でオートフィルタで抽出したものをコピーして Sheet2 に貼り付ける。　次に Sheeet1 の抽出したセル行を削除する　 また、この際に「削除しますか？」という質問もいれる。 というマクロを組みたいと考えています。 以下の通り、過去のソースから Sheet2 に貼り付けることまでは できたのですが、Sheet1 の行削除をどのように組めばいいのか 検討がつきません。 ご教授よろしくお願い致します。 Sub Sample() Const SHEET_COPY As String = "Sheet1" Const SHEET_PASTE As String = "Sheet2" Worksheets(SHEET_COPY).Range("a2:e" & _ Worksheets(SHEET_COPY).Range("a1").CurrentRegion.Rows.Count).Copy Worksheets(SHEET_PASTE).Range("a" & _ Worksheets(SHEET_PASTE).Range("a1").CurrentRegion.Rows.Count + 1).PasteSpecial Paste:=xlPasteAll End Sub
エクセルのＶＢＡを使ってグーグルにインデックスされているか確認する事って可能でしょうか？ 具体的に言うと、Ａのセルにサイト名があり、ＢのセルにはＵＲＬがあるとします。 グーグルでＢセルのＵＲＬを検索したときに同じＵＲＬが表示されたら、Ｃ列に「〇」表示されなかったら「×」の判定をします。 また、一度に多くを検索するとグーグル側でストップがかかるかもしれないので、１度検索を行ったら、３０秒とか開けて検索するとします。 このような事がやりたいです。 数サイトなら手動でやるのですが、数が多いのでＶＢＡを使ってできないかと考えました。 どなたかＶＢＡが詳しい方がいらっしゃいましたら教えていただけないでしょうか？
A　　　　　B　　　C　　　D　　　　E 検索列　　　取得列　　　　検索値　　取得値 7432　　　　1　　　　　　7432　　　1 7433　　　　2　　　　　　7433　　　2 上記のようにE列に数式ではなく値を取得したいです 実際には358行目まであり、E列にも同様に385行目まで値を取得したい 当方初心者ですが宜しくお願い致します
ＶＢＡを4月から習おうと講座に申込んだり準備をしていたところ それを聞いた上司が前勉強でツールを作れ、と無茶ぶりしてきました。しかも期限がすごく短くて焦ってます。 まだ勉強前で右も左もわからないので、本を読んだりＷＥＢで調べたりしたのですが、 どうしてもよく作れない部分があります。教えてください。 うまくいかない部分 社内システムに投入するテキストファイルを作成したいです。 ①作成ボタンを押したら投入する文章の書かれたテキストdefault.txtを呼び出す ②そのテキスト内の決まった項目（Ｃ１、Ｃ２，Ｃ３）をそれぞれActiveSheetのＡ１、Ａ２、Ａ３ に置換する ③shinki.txtという名前で書きだす スクリプト？ランタイムを使うといいと聞きましたが、よくわかりません。 Private Sub SakuseiButton_Click() 　 References.AddFromFile "C:\Windows\system32\scrrun.dll" 　　Call ReplaceFromFile("C:\default.txt", "Ｃ１", "Ａ１") 　　 Call ReplaceFromFile("C:\default.txt", "Ｃ２", "Ａ２") 　　Call ReplaceFromFile("C:\default.txt", "Ｃ３", "Ａ３") 　 　Call ReplaceFromFile("C:\shinki.txt", vbCrLf) End Sub すみません、上のをどう直せばいいのでしょう？ 周りはＶＢＡのツールを使ったことはあっても作ったことのある人はいません… 助けてください！
VBでChromeを制御して、表示した画面を印刷するアプリを作成しています。[Ctrl]+[Shift]+[P]キー入力で表示されるWindowsの印刷ダイアログ上の[印刷]ボタンを押す方法をご教示して頂きたくお願いします。 環境はつぎのとおりです。 o OS：Windows 7 Pro. 64bit SP1 o VB：VB 2010 Express o Chrome：Ver.49.0.2623.87 m ダイアログで設定する内容は、デフォルトのままでよいので[印刷]ボタンを押すだけです。 よろしくお願いします。
AccessVBA初心者です。 Access2010を使用しています。 マクロとVBAを駆使して顧客情報を検索するツールを作成しました。 フォーム画面に検索条件を入力して検索をするボタン、 検索した結果をExcelにエクスポートするボタンと、 元データを入れ替えるボタンを作成しました。 元データは月に１度程度入れ替えをするのですが、 今現在入っているデータがいつ入れ替えたものなのかわかるように 元データ入れ替えボタンを押した際に、 txtボックス等で更新日付を表示させたいと考えております。 VBAでもマクロでもよいのですが、どなたか表示させる方法を ご教示いただけないでしょうか？
カンマ区切りのCSVファイルをテキストとして読み込んだ時の挙動についてお伺いします。 現在、excelマクロで印刷用のファイルとCSVを作成するプログラムを作っています。 以下、流れになりますが、 １．外部サイトからCSVファイルをDL ２．マクロファイルを開いて１のCSVを指定する。 ３．テキストウィザード処理（マクロの記録を流用）を含めマクロが実行される ４．印刷用のxlsxファイル（とCSV）が作成される。 ５．４で作成されたCSVファイルを他システムに流し込む。 DLしてきたデータ数（175）がある一定のレコード数（例えば180）より少ないと、 5データ分が「,」としてなぜか埋まっています。 テキストにして初めてわかりましたが、excelファイル上だともちろん何もないので気づきませんでした。 その状態で５をすると、5データ分が空データ扱いになりエラーが出てきてしまいます。 データの量は可変なので、上記の例だと180より少ないレコード数の場合、差分行をdeleteしています。 ただテキストウィザードで１つずつ進めてみると、データ量にかかわらずゴミがないデータが作成されているので、 違いがわかっていません。 ご存知の方がいましたら、ご教授お願いします。 以下、３の処理です。 openfileは２で指定したフルパスファイルで、Fname2はファイル名を指しています。 With ActiveSheet.QueryTables.Add(Connection:="text;" & openfile, Destination:=Range("$A$1")) .Name = Fname2 .FieldNames = True .RowNumbers = False .FillAdjacentFormulas = False .PreserveFormatting = True .RefreshOnFileOpen = False .RefreshStyle = xlInsertDeleteCells .SavePassword = False .SaveData = True .AdjustColumnWidth = True .RefreshPeriod = 0 .TextFilePromptOnRefresh = False .TextFilePlatform = 932 .TextFileStartRow = 1 .TextFileParseType = xlDelimited .TextFileTextQualifier = xlTextQualifierDoubleQuote .TextFileConsecutiveDelimiter = False .TextFileTabDelimiter = False .TextFileSemicolonDelimiter = False .TextFileCommaDelimiter = True .TextFileSpaceDelimiter = False .TextFileColumnDataTypes = Array(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _ 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, _ 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _ 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _ 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _ 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, _ 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _ 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _ 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _ 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _ 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _ 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _ 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2) .TextFileTrailingMinusNumbers = True .Refresh BackgroundQuery:=False
vba 初心者です、オートフィルターの後、可視行だけに処理をしたいのですが、このコードでは 非可視行も処理をしてしまいます　宜しくお願いします Private Sub CommandButton29_Click() Application.DisplayAlerts = False Dim i As Integer Dim a As String Dim b As String Dim c As String Dim d As String Dim e As String Dim f As String Dim g As String Dim h As String Dim j As String Dim rng As Range Dim p As Integer Dim k As Integer For Each rng In Selection.Rows p = rng.Row a = Range("D" & p).Value '氏名 b = Range("F" & p).Value '生年月日 c = Range("H" & p).Value '性別 d = Range("j" & p).Value '住所 e = Range("k" & p).Value f = Range("l" & p).Value g = Range("g" & p).Value '年齢 h = Range("e" & p).Value 'フリガナ j = Range("m" & p).Value '電話番号 Range("R" & p).Interior.ColorIndex = 44 Workbooks.Open Filename:="C:\111\222.xlsx" With Worksheets(1) .Select .Range("E4").Select .Range("E4") = a .Range("E6").Select .Range("E6") = b .Range("V6").Select .Range("V6") = c .Range("E8").Select .Range("E8") = d & e & f .Range("R6").Select .Range("R6") = g .Range("O4").Select .Range("O4") = h .Range("E10").Select .Range("E10") = j .Range("A1").Select End With Application.DisplayAlerts = True Dim x As String x = Range("D" & p).Value Workbooks("222.xlsx").SaveAs Filename:="c:\get\" & x & ".xlsx" _ Next rng End Sub
表題の通りなのですが、Worksheetのボタンイベントプローシージャ内で時間のかかる処理中 （モーダルのユーザフォームで進捗表示中）当該マクロのブックとは別に開いたブックのセルを ダブクリックして編集モードに入ると、メインのブックのマクロがフリーズしてしまいます。 Debug.printで追い込んだところ、マクロと同じブックに所属のワークシート上のセルの プロパティ書き換え処理....Value = ほげほげ、や.Font = ほげほげがフリーズし、 帰ってこなくなることが判明しています。これはそもそもの仕様なのでしょうか。 編集モードを抜けてもプロパティ書き換えの中で固まったままです
R1C1形式で変数の入力について教えて下さい。 過去の質問を参考に下記のように入力するとコンパイルエラーとなり上手くいきません。。 Application.Goto Reference:="R1C1:R[" &***& "]C1" 下記の「*」部分に変数を入れてます。 是非ともアドバイスお願いいたします。
お疲れ様です。 表題の件で質問がございます。 仕事の関係上、画像を挿入しリサイズ後、任意の場所に移動を行うということを数百枚単位で行わなければなりません。 従来は上記作業を手動で行っていたのですが、VBAを用いて業務を省略化できないかと考えました。 そこで、VBA教本及び各HPを参照しながら添付画像のようなインターフェースのユーザーフォームを作成し、任意フォルダから画像を読込みEXCELに保存するVBAを作成中です。しかし、どうしても③及び④に該当するVBAの記述方法がわからず困っています。 ①画像を任意のフォルダから読み込む(画像の読込みボタンを押す) ②読み込んだ画像のタイトルをリストビューに表示していく。 ③リストビュー上で選択した画像をイメージに表示する。 ④必要な画像だけを選択し(チェックボックスを用いることを考えていますが、その他代替案がございましたらそれでOKです。)一度に画像をEXCELに保存する。なお、保存する場所・シートを指定するVBAは記述可能です。 大まかな質問で恐縮ですが、御回答お願いいたします。 もちろん参考HP、参考文献のご紹介のみでも大歓迎です。
こんにちは。考える40代の男性です。 vbaを使って下記のとおりsheet1の情報をD1からJ1をキーにしてA1からC1を集計し、その結果をsheet2の E,G,L列の二行目より貼り付けたいと考えております。また、sheet1のD列とE列はsheet2では結合してsheet2のA2より表示させ、同じくsheet1に該当する項目をsheet2の二行目より貼り付けたいと考えております。 どなたかお力添えをお願いいたします。表がずれてますがお許しください。 sheet1 　　M 　　P 　　S 　　T 　　U 　　V 　　W 　　X 　　Y 　　Z 1 金額 数量1 数量2 番号1 番号2 番号3 記号 識別 率 コード 2 153.10 10.00 19.00 620821 000 2 TR R 7.4% 11223 3 100.00 20.00 36.00 620921 090 7 TR R 7.4% 13333 4 450.00 10.00 　4.00 620921 090 7 TR R 7.4% 24444 5 66.00 10.00 　4.00 620821 000 2 TR R 7.4% 24444 6 45.00 6.00 　4.00 620821 000 2 TR R 7.4% 24444 7 55.00 10.00 　4.00 620821 000 2 TR R 7.4% 24444 8 153.10 9.00 　4.00 620821 000 2 TR R 7.4% 24444 sheet2 　　D　　　　　E　　　　　G 　　　I　　　　K　　　M　　　N　　　　O　　　P 1 番号1　　番号3　　　率　数量1　数量2　コード　記号　 識別 金額
こんにちは 主にExcelとOutlookでVBAによる仕事効率化ツールを作ろうと思っています。 転職したばかりで、社内数名と社外数名の全部で10人強のチームを担当することになりました。 ツールを作っていく上で、ExcelやOutlookの各ツールでこれらの人材に関する情報を参照することが多くなると考えています。 例えば、社内サーバに置かれたエクセルに含まれる、仕事リストや議事録の内容などを社内メンバーのみに自動でメール送信したり、特定の種類のメールを受信すると、社外と社内の営業職のFTP領域に添付の資料をアップロードするなど、様々です。 さて、こうした人材情報をどこでどのように定義するかで迷っています。 あ、書き忘れましたがプログラミングは独学で、基礎的な部分の理解が怪しいです。 たとえば、VBAのユーザー定義型を使って Type Resource name as string position as string email as string hasManagerPriv as Boolean End Type などのようにどこか1ヶ所に宣言して、各ツールで「役職が営業担当のみ」「社内メンバーのみ」「マネージャ権限を持つ人のみ」を判定して該当者をふるい分けられる仕組みができれば最高なのですが、どのように考えれば良いのか分からずに困っています。 ・メンバー構成が変わるのは多くて四半期に一度くらい。変更のたびに手書きで書き換えても良い。 ・メンテナンス性を考えて書き込む場所は1ヶ所で済ませたい。 ・複数の人間がツールを使えるようにするために、各使用者のマクロにそれぞれ書くことになっても良い（つまり、メンバー構成が変わるとマクロ使用者全員の該当部分を書き換えることになっても良い、逆に社内サーバに情報を置いて一元管理すると、ネットワーク接続がないときに使えない）。 ・社外の人はこのマクロを使わない。 ・ExcelとOutlookの複数のモジュールで使いたい。 どこにどのように記述するのがスマートで、メンテナンス性が高いでしょうか? お知恵とアドバイス、お願いできますでしょうか。
あるシートの書式を更新させたいのですがファイルが400以上あるため自動でできたらなあと考えています excelブックAの　Sheetあ　のSheet内全範囲をコピーしてフォルダ内の全てのexcelブックに張り付けるマクロはどう組めばよいでしょうか 貼り付け先のシートは全てブックAの　Sheetあ　と同一ですがそれぞればらばらのSheetを選択した状態で保存されているため各ブックを開いた後　Sheetあ　を選択しなおす必要があります https://oshiete.goo.ne.jp/qa/9198080.html URL先で以前似たような質問をさせて頂いたのですが勉強不足のため応用ができず・・・ 構想ではこんな感じのマクロを組めばよいのかと考えていますがうまく組めず悩んでいます 1.ブックAの　Sheetあ　を全範囲選択してコピー 2.同じフォルダ内の別のブックを開いて　Sheetあ　に貼り付け 3.B7セルを選択(張り付けた後全範囲選択したままだと使い勝手が悪い為B7セルを選択しておきたい) 4.保存して閉じる 5.次のブックを開く 6.フォルダ内のブックすべてに適用するまで1～5の繰り返し
インターネットで図形の位置を取得する下記のプログラムを見つけたのですが、図形（四角）を右へ90度回転した場合でも、原形の位置が返されます。図形のサイズによって変化するので、サイズを自動的に取得し、回転した図形の上と左が、用紙の上端、左端からいくらの位置になるか、プログラムを組むことはできないでしょうか？　よろしくお願いします。 Sub 選択されている図形の位置を取得する() Dim msg As String With Selection If .Type = wdSelectionShape Then With .ShapeRange .RelativeVerticalPosition _ = wdRelativeVerticalPositionPage .RelativeHorizontalPosition _ = wdRelativeHorizontalPositionPage msg = "用紙上端から " msg = msg & Round(PointsToCentimeters(.Top), 2) & "cm" msg = msg & vbCrLf & "用紙左端から " msg = msg & Round(PointsToCentimeters(.Left), 2) & "cm" End With Else msg = "図形を選択して実行してください。" End If End With MsgBox msg End Sub
はじめまして。 いつもこちらを拝見して参考にさせてもらっていますが、解決しないので初めて質問させていただきました。 超初心者ですがよろしくお願いいたします。 マクロでcsvファイルを開いて計算や装飾の処理をしたあとに保存させたいのですが、その部分の記述を教えてもらえませんか？ 元のcsvファイルは何も変更せずに残します。（手動で開いた場合は、保存しますか？のときに「いいえ」を選択して閉じています。） マクロを実行して処理後に名前をつけるところまでは出来ました。 その後、保存先にエクセルのブックが保存されますが、開くと空白のブックでした。 マクロの途中で停止させて、手動で名前をつけて保存をすると保存は出来ます。 Workbooks(1）SaveAs Filename:= "C:\Macro\hozon.xslx" インターネットで調べたところ、 fileformatの指定　xlcsvが必要とかいくつかの記事を拝見しましたがどうもよくわかりません。 お詳しいかた、どうぞよろしくお願いします。
色々調べて、 WshShell.Run """C:\abcd.vbs　””10 20"　とすれば 引数10,20を渡してVBSを起動できることは分かりました。 しかし、変数AA=10、BB=20として WshShell.Run """C:\abcd.vbs　””AA BB”　では文字列AA、BBが渡されてしまい、 変数を渡すことはできませんでした。 「変数を渡してVBSを起動する」などで調べても見付かりませんでした。 変数を渡してVBSを起動すること自体できないのでしょうか？ どうぞ、知恵をお貸しください。
excel vbaで、他のEXCELファイルのマクロの処理を中断して、自己ファイルのマクロを処理後、再度他のEXCELファイルのマクロを継続して再度処理を行わせるにはどうすれば良いですか。教えて下さい 他のＥＸＣＥＬファイルとして、フリーソフトを利用しています。 そのソフトは、モジュールにロックが掛ってるので、その中のマクロなどを編集することはできません。（ロック解除などは考えていません。） そのソフトを起動して、データファイル入力画面で、データファイルを入力して、処理をして、処理結果を保存することを、入力データファイルを変えながら、繰り返し行いたいです。 そこで、処理マクロを作成しています。その手順とＶＢＡを説明します。 １）フリーソフト（違法なものではありません。）を開き、 ２）そのフリーソフトのシート内のボタンを、ＶＢＡで、マウスカーソルを移動させて、マウスのキー操作で、「押す」「離す」を行い、 ３）ファイルの初期化の問合せの警告が出るので、キー操作で、「Ｙ」を押し、 ４）データファイルの名称をクリップボードにコピーし ５）ＥＸＣＥＬのカレントフォルダを、データファイルのあるフォルダに変えて ６）DoＥventsとして、フリーソフトのデータファイル入力画面を開いています。 この時、画面のポインタは、データ入力画面のファイル名入力欄にあり、 この後、データファイル名をクリップボードから入力したいので、 キー操作で、「ｃｒｔｌ＋ｖ」としたいのですが フリーソフトのマクロが起動中で、作成している処理マクロに制御が移らないためと思いますが 入力できません。（人手での入力は可能ですが）、自動化したいので、どの様にすれば良いか教えて下さい。 マクロは長いので、抜粋して記載します。 sub a() （宣言文省略します。） Workbooks.Open freesoft Dim mPSet As Long mPSet = SetCursorPos(b,c) Call mouse_event(MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0) Call mouse_event(MOUSEEVENTF_LEFTUP, 0, 0, 0, 0) keybd_event VK_Y, 0, fKEYDOWN, 0 keybd_event VK_Y, 0, fKEYUP, 0 Application.CutCopyMode = False Dim d As New DataObject With d .SetText e .PutInClipboard End With ChDrive f ChDir g DoEvents （ここで、止まります。） With d .GetFromClipboard .GetText End With keybd_event VK_RETURN, 0, fKEYDOWN, 0 keybd_event VK_RETURN, 0, fKEYUP, 0 DoEvents Dim mPSet2 As Long mPSet2 = SetCursorPos(h, i) Call mouse_event(MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0) Call mouse_event(MOUSEEVENTF_LEFTUP, 0, 0, 0, 0) Workbooks(freesoft).SaveAs FileFormat:=xlNormal, Filename:=k Workbooks(k).Close End sub
VBA関数の書き方を教えてください。
あるスプレットシートが既にあり,そこにTextファイルから下記のようなデータをコピーしたいのですがよくできません。データが同じように並んでいて、Aの90という数値を検索したいと思っています。取得するデータはData2にあるAからDのデータを丸ごとコピー＆ペイストしたいのです。ペイストするときには、スペースとコンマで区切りを付けてペーストしたいと思っております。 Data１ A 90, B -23.3, C 0.5, D 9 A 90, B -42.5, C 0.4, D 9 A 45, B -21.6, C 0.25, D 9 A 90, B 23.5, C 0.7, D 9 Data2 A 90, B -23.3, C 0.5, D 9 A 90, B -42.5, C 0.4, D 9 A 45, B -21.6, C 0.25, D 9 A 90, B 23.5, C 0.7, D 9 ネットに載っているのをいろいろ試しましたが、すべてのセルに検索がかかり使えませんでした（アレンジできませんでした）。 どうぞよろしくお願いいたします。
VBAについて質問です。 例えばSheet1のA1セルに「2016/3/7」という値が入力されているとして、そのセルからSheet2にある同じ値（2016/3/7）が入力されているセルに移動するにはどのようにすればよいでしょうか。よろしくお願いします。
このネットで出ていた構文をアレンジして作ってみました。 http://www.start-macro.com/55/Lesson/l197.html アレンジした部分が動きません。教えてください。 インプットボックスから、数字を選んで検索した行を張り付けたいだけなのですが うまくいきません。その時にLOGのファイルをOpenしてを選択させたいのです。 わかる方教えてください。どうぞよろしくお願いします。 --------------------------------------------------------- Sub macro1() Dim a(256) As String s = InputBox("Input Number(s)") If Trim(s) = "" Then Exit Sub ’（この下のCurDirからElseまでを足しました, csvをlogに変更）　 CurDir ("C:\") strFileName = Application.GetOpenFilename("Log File (*.log),*.log", 1, "Select LOG File") If (strFileName <> "False") Then If (Trim(Dir(strFileName)) = "") Then Call MsgBox("Missing Log file", vbOKOnly, "OK") Else 'Open "C:\Users\Santa\Desktop\KEN_ALL.CSV" For Input As #5 　　’　（上の文を下に変更） strFileName For Input As #5　（ここがアレンジした部分） j = 1 Do While Not EOF(5) Line Input #5, buf If buf Like "*" & s & "*" Then Call wReadCsv(buf, a, n) For i = 1 To n Cells(j, i).Select ActiveCell.FormulaR1C1 = a(i) Next i j = j + 1 End If Loop Close #5 MsgBox j - 1 & "件のデータを取り込みました。" Range("A1").Select End Sub --------------------------------------------------------------------------
単純な複数のシートを移動するマクロを作りたいのですが、そのうちの一つがない場合はその作業を飛ばして次に進むにはどう組めばよいでしょうか？ 行いたい作業は複数の既存ファイルのシートの並び替えです。ファイルによってシートの数が違うため対応できるようにしたいです 10個程あるシートの中から3つのシートを末尾から”三ニ一”の並びにしようとしています マクロの記憶機能でマクロを作ったところ仮に三番のシートがなかった場合処理が中断されてしまいました 該当するシートがなければ作業を飛ばして次の作業に進むにはどのようにくめばよいのでしょうか (If Not を使えばよいかと考え追記してみましたがおそらくsetの段階で間違っているのでしょう、うまくゆきませんでした) ↓組んだコードです Set sh = Sheets("三番") If Not wk Is Nothing Then shcut = Sheets.Count Sheets("一番").Select Sheets("一番").Move After:=Sheets(shcut) Sheets("二番").Select Sheets("二番").Move After:=Sheets(shcut) Sheets("三番").Select Sheets("三番").Move After:=Sheets(shcut) End If Sheets("一番").Select Range("H24:O24").Select End Sub 書籍やサイトで勉強中ですがなかなかうまくゆかず ご教授お願いします
ＡＣＣＥＳＳ2010を利用しています。 ＭＴ＿顧客というテーブルに、キーワード1　キーワード2　キーワード3があります。 フィールドの形式は、テキスト型です。 主キーは、顧客ＩＤです。 フォームに非連結のテキストボックスを1つ作成し、検索すると、 キーワード1　キーワード2　キーワード3の全部に該当する顧客を最後まで検索したいのです。 Private Sub コマンド103_Click() Dim myRS As Recordset Set myRS = Me.RecordsetClone myRS.FindFirst "キーワード Like '" & キーワード検索1.Value & "'or " & "キーワード2 Like '" & キーワード検索2.Value & "'or " & "キーワード3 Like '" & キーワード検索3.Value & "'" If myRS.NoMatch Then MsgBox "該当するレコードはありません。" Else Me.Bookmark = myRS.Bookmark End If myRS.Close Set myRS = Nothing End Sub こんな感じでコードをかきましたが検索できる場合とできない場合があります。 キーワード1に格納されている語句を入力すると作動しますが、キーワード2、キーワード3に格納されている語句を入力すうると "該当するレコードはありません。"と表示されます。 ご教授お願いします。
TeratermのマクロででLinuxへログインするように Windows8クライアントからWindows2012へリモートデスクトップで自動ログイオンする方法が知りたいのですがどのようにすれば可能でしょうか。 vbsなど紹介していただければ助かります。 ご存じの方、宜しくお願いします。
選択された単一行を１段下の行へ移動する記述は下記で良いと思うのですが、 複数行を考慮した記述を教えて下さい。 ' '１段下に移動 ' Selection.Cut Selection.Rows.Offset(2, 0).Insert Shift:=xlDown Selection.Offset(1, 0).Select よろしくお願い致します。
データファイルをOpenTextで開き、データを書き換え別シートに書き出し、保存して閉じてます。開いてシートに読み込んだ際、データはセルの書式設定に従います。小数は2桁までとか、1.22E-003とかです。元々は小数点以下10桁程度あります。値自体が変わる訳ではないと思い、気にせず保存終了します。 ところが、保存したファイルをワードパッドで開くと、データ自体が書式設定に合わせて変わってしまってます。10桁→2桁になってます。 データ処理といっても、順番が変わるだけです。元のデータ形式で保存するにはどうすればいいでしょうか。
こんにちは。 vlookup関数でB列に"#N/A"のエラーメッセージが出ている行をマクロで 削除したいのですが上手くいきません。 ご教示お願いします。
エクセルにてアクティブファイル名を張り付けたいのですが、うまくいきません。ファイル名を他のエクセルブックに移したいのです。 こちらはファイルの中身をDestinationで張り付ける方法でネットから見つけてきて機能しています。 Workbooks.Open Filename:=strFileName ActiveSheet.Range("A1:E1000").Copy _ Destination:=ThisWorkbook.Worksheets("sheet1").Range("A4") こちらは、試しに作ってみたがActiveWorkbook.nameとDestinationでは機能しない。 ActiveWorkbook.Name _ Destination:=ThisWorkbook.Worksheets("sheet1").Range("B1,B2") 何かいい方法を教えてください。よろしくお願いいたします。
VB2013とSQLServer2012で作成したプログラムをインストーラーで 配布したのですが実行直後にエラーが発生しプログラムが起動しません。 開発環境はWindows7 Pro 32Bit SP1で配布先はWIndows8 Pro 64Bitと Windows7 Pro 64Bit SP1です。 問題の署名: 問題イベント名: CLR20r3 問題の署名 01: SEIKYU.exe 問題の署名 02: 1.0.0.0 問題の署名 03: 56cd2d3c 問題の署名 04: System.Data 問題の署名 05: 4.0.30319.34209 問題の署名 06: 53489aad 問題の署名 07: 1df1 問題の署名 08: 52 問題の署名 09: System.InvalidOperationException インストーラープロジェクトの作成でインストールウィザードから 作成しました。 Framework 4.5.1も一緒にインストールするようにインストーラーで 設定しています。 客先の配布ができないので困っています。 何かご存知の方はお助けください。
Visual Basicカテゴリの一つ前の質問に関連して質問させて下さい。 確認環境は、Windows10 Excel2013 および VBScriptです。 ---------- Sub aaa() Dim i As Double Dim j As Double i = 0.4 j = 0.6 If i * 3 = j * 2 Then MsgBox 1 Else MsgBox 2 End If End Sub ---------- 上記の結果は、前の質問のとおり2になりました。 ところが ---------- Sub aaa() Dim i As Double Dim j As Double i = 0.4 j = 0.6 If i * 0.3 = j * 0.2 Then 'かける数を1/10にした。 MsgBox 1 Else MsgBox 2 End If End Sub ---------- の結果は、1になります。 これはどういった理由によるものなのでしょうか？ ご教示をお願いいたします。
こんばんは、VBSについて質問です 以下のコードですが、何故Elseのケースが適応されるのかがわかりません。 i=0.4*3 '1.2 j=0.6*2 '1.2 なので、メッセージボックスで１が表示されると思ったのですが・・・。 '----Text.vbs---- i = 0.4 j = 0.6 IF i*3 = j*2 then Msgbox 1 Else Msgbox 2 End If
いつもお世話になります。 C1に=IF(A1="","",(A1+B1))の関数が入っていて、同様の関数がC10まで入ってます。 A1からB3までだけ数字が入っている状態で、C1からC3までの値があるセルをマクロで範囲指定した いのですが、いい方法があれば教えて頂きたいです。お時間ある方いらっしゃいましたら 宜しくお願い致します。
Visual Basic 2010 Express Editionを前提とした解説本を見ているのですが、最近はVisual Studio 2015 Community が最新になっています。もし、前者をアンインストールして後者の環境になった場合、解説本を読み替えていくことは可能なのでしょうか。両者がどのような位置関係になっているのかということなのですが。Visual Studio 2015 Community版にはVBは含まれていますので、できると思っています。Visual StudioでVBを利用する事始めの部分を教えて頂きたいのですが。 よろしくお願いします。
sheet1に、特定の文字列を含むA列があります。 A列のみで10～100行くらいに変動します。 sheet2に、特定の文字列に関する情報があります。 文字列によって10～100列あります。 20行くらいで特定の文字列は重複しません。 行、列とも増えることがあります。 sheet1に、 特定の文字列と一致するsheet2の行を、 上書きしたいです。 行ごとすべて上書きが理想です。 ＜例＞ ●sheet1 A １　みかん_和歌山 ２　みかん_静岡 ３　みかん_静岡 ４　りんご_青森 ５　りんご_長野 ６　うめ_和歌山 ７　うめ_静岡 ●sheet2 A　B　C　D １　みかん　甘い　黄 ２　りんご　甘い　赤 ３　うめ　すっぱい　赤　おにぎりの具に合う ●sheet1結果 A　B　C　D １　みかん　甘い　黄 ２　みかん　甘い　黄 ３　みかん　甘い　黄 ４　りんご　甘い　赤 ５　りんご　甘い　赤 ６　うめ　すっぱい　赤　おにぎりの具に合う ７　うめ　すっぱい　赤　おにぎりの具に合う 宜しくお願いいたします。
VBAのユーザーフォームで ComboBoxの値を初期化するために With ComboBox3 .AddItem "aaa" .AddItem "bbb" .AddItem "ccc" .AddItem "ddd" End With ComboBox3.Text = ComboBox3.list(3) 'コンボボックスのデフォルトの値 のような記述をする必要がありますが、 この初期値を複数のComboBoxにも適用したいのですが ComboBoxの初期値をコピーすることってできないでしょうか？ ComboBox4 = ComboBox3 とやってみましたが うまくいきませんでした。 どなたか教えてください。
Accsess2013でレポート作成時にレコードの特定の条件下で画像を添付しようとしてます。 画像はデータベースと同じフォルダーにあり個々のPCによって異なるため、 パスを取得・指定したいので、 Public Function pass() As String pass = CurrentProject.Path End Function という標準モジュールを作りました。 次にレポートのイメージのデータを式ビルダーで =iif(「条件式」, pass() & "\gazou.gif","") としたのですが、実行するとpassを問うインプットボックスが表示され、上手くいきません。 式作成時はユーザー定義関数 pass がちゃんと表示されておりそれを選択しています。 手法には拘りませんので解決策を教えてください。 よろしくお願いします。
いまさらながら古いソフトを使用しております。 Visula Basic6、Borland C++Builder5、Office 2010 今はWidows7(32bit)を使用し、上記の2種のソフトが使えております。 PCが古くなったため新規で購入を考えているのですが、 Windows10(64bit)になります。 上記のソフトは、動作するのでしょうか？ Officeなら2万程度でOffice2013を購入できますが、 VBやBCは、新規で購入となると費用も掛かりますし、 何より慣れないソフトを使用するには、ハードルが高いのです… 動作するかどうかわかる方がいましたら回答お願いいたします。
フォルダの中から作成日時を指定しファイルを開き、データ取得して閉じます。数千個の中から百個を開くイメージです。FSOを使用してますが、ファイル名タイムスタンプの取得は結構時間がかかり、１ファイル当たりコンマ数秒、全部集めると結構な時間になります。 DOSコマンドでDirなら全部でコンマ数秒のイメージがあるので、こちらに変更しようと考えてます。問題は手順です。 ①シートにDOSコマンドを書き並べる ②バッチファイルに書き込み ③プロセスＩＤを取得し終了監視しつつ実行 ④結果の入ったファイルをエクセルに読み込み、ファイル名とタイムスタンプ取得 ⑤タイムスタンプからをファイルを選び、開く 無理とは言いません、全部心あたりはあります。が、私には少々道のり遠いです、特に③あたり。 もうちょっと簡単で速い方法はないでしょうか？ 無ければ諦めて気合入れて上記でやります。
Excel 2010では下記のようなVBAマクロで、ブックを開いているウインドウのリサイズ 禁止が出来たのですが、Excel 2013に持って行ったところ禁止が効かなくなりました。 SDIになったことによる影響かと思いますが、Excel2013でウインドウサイズを固定するには どうすればよいでしょうか？ Set MainWindow = Application.Windows(ThisWorkbook.Name) With MainWindow .EnableResize = False ''その他設定 ・・・・ End With
エクセルＶＢＡを使ってセルのデータをtxtファイルで出力したいと考えています。 仮にフォルダＡがあり、その中にフォルダＢ、フォルダＣがあります。 （フォルダＢの中にはフォルダＤがあります） フォルダＣの中には、エクセルブックがあるとします。 以下のような感じです。 フォルダＡ 　　　　├フォルダＢ 　　　　│　　　　└フォルダＤ（この中にtxtファイルを作りたい） 　　　　│ 　　　　└フォルダＣ 　　　　　　　　　└エクセルブック エクセルブック（Sheet1） セルA1には「日記タイトル」 セルA2には「日記の内容」 があるとします。 エクセルＶＢＡを使って、フォルダＤの中に「日記タイトル.txt」のファイルを作りたいです。 日記タイトル.txtの中身は、セルA2の日記の内容です。 エクセルＶＢＡを使いたいのですが、どのように書けばいいか教えてください。 よろしくお願いします。
エクセルのVBAを始めたばかりの初心者です。 選択した塗りつぶしていないセルのRGB色を Selection.Cells.Interior.Color で取得して、メッセージボックスに出すと、「16777215」と表示されます。 なぜ、何も塗られていないのに、0ではなく、このような数値になるのでしょうか？ 意味が分かっていませんが、「もし選択したセルが塗られていなければ」という時に If Selection.Cells.Interior.Color = 16777215 then という風に使ってしまっており、動いていますが、意味が知りたいです。 また、そもそも色のついたセルでも同じ方法で表示される数値の意味が分かりませんので そもそものこの数値の意味も知りたいです。 ご教授よろしくお願いいたします。
VBAのコンボボックスについての質問です。 画像のようなデータがあったとして フォームのコンボボックスで会社を選択すると、その会社の商品が一覧として出てきて さらに商品を選択すると味の一覧が出てきて、その後商品のサイズが選択できるような処理をしたいです。 ただし、コンボボックスには、A社、A社･･･B社、B社･･･のように重複するのではなく、A社、B社のように出てくるようにしたいです。
book1からbook2を開きます。book2のフォーム1に　book1のセルの値を送り込みたいのですが ’appwb.Worksheets("UserForm1").TxtPassword.Value = Sheet2.Range("K2") appwb.UserForm1.Controls(TxtPassword).Value = Sheet2.Range("K2") TxtPassword　この変数は　知らない　となります。まあ、当たり前と言えば、他のbookのことですから・・・・ 如何でしょうか？ 前処理は Target = Sheet2.Range("G2") 'Target = "b.xlsm" f_Target = ActiveWorkbook.Path & "\" & Target buf = Dir(Target) If buf = "" Then MsgBox Target & vbCrLf & "は存在しません", vbExclamation ' Exit Sub End If For Each appwb In Workbooks If appwb.Name = buf Then MsgBox buf & vbCrLf & "はすでに開いています", vbExclamation ' Exit Sub Else Set appwb = Workbooks.Open(f_Target) End If Next appwb
Collectionで複数のRangeを返す関数を作ったところ、 戻り値のCollection要素からRange型の変数に取り出す時にエラーとなる為 デバッガで見たところ、Range型そのものではなくRangeの展開された内容と 思しきものが入ってました。おそらく、Addするときに意図しない型変換が かかってしまったものと思いますが、これを抑制する方法はありますか？ （写真添付） もし無理なら、 ・要素数可変の１次元配列（リスト構造）で複数のRangeを扱える。 ・要素番号の指定により目的のRangeを取得する。 ことが出来れば手段は問いません。
http://detail.chiebukuro.yahoo.co.jp/qa/question … このページと全く同じ質問です。 マルチページのページ指定で Valueではなく、Captionで指定したいのですが Forループで検索をかけるしかないでしょうか？ 一発で指定できる方法があれば教えてください。
A列に文字列、B列に数字が入っています。 A列、B列とも空欄の場合があります。 行数は10〜1000くらいです。 同じ行のC列に、 A列&"(n="&B列&")"を、 A列とB列両方に入っている時だけ、 表示したいのですが、 お教えいただけませんでしょうか。 例: A B C 1 全体 300 全体(n=300) 2 男性 3 150
慣れない言語で悪戦苦闘しています。 （アクティブな）ウインドウをクライアント領域一杯まで広げたときのサイズを取得する方法を教えてください。 Application.WindowState = xlMaximizedしたあと、 Windows("ブック名").Width、Windows("ブック名").Heightで取れるかと 思ったのですが、これではxlNormalの時のサイズが返ってきてしまうようです。 目的は、右下一杯までウインドウを広げて、左上は下のウインドウが見えるよう、 少し隙間をあけて開きたいためです。
エクセルの I1~L1 　千　百　十　一 と　各列の位名が入力されています。 その下 I2～L2710に　0～9までの数字が、ランダムで入力してあります。 千百十一 ３３６５ ８５９２ １１１１ ４４８８ ４１０1 １１７６ ３３５０ ７２５６ １６９８ ５８６６ ７６２２ ・・・・ ・・・・ ・・・・ ....2710行 検索開始対象数字は I12 ～ L12 、上の表でみるなら ＜ 7 6 2 2 ＞ に あたります。 この数字を位別(列)に見て検索し、右列 M12 ～ U12 に ＜ 何個前に対象数字があるか？＞ を位別に表記したいのです。 これを、2720行まで行います。 検索をするにあたり ①. 遡るのは10個前までです。各位の検査結果は 千 → M12 , 百 → O12 , 十 → Q12 , 一 → S12　に入力し、無ければ "X" とします。 ②.①で "X" だった場合 各 M,O,Q,S の右隣の列(N,P,R,U)に、下の順番で検索 　　千の場合　千 → 百 → 十 → 一 　　百の場合　百 → 十 → 一 → 千 　　十の場合　十 → 一 → 千 → 百 　　一の場合　一 → 千 → 百 → 十 を行い、＜どの位置(千・百・十・一)の何個前に該当数字はあたるのか？＞を表記します。 ③. 2を行い、検索しても無い場合は "X" と表記します。 　 　 ※この7622の場合は、 千の位にある"7"は、3個前にあるので → M12→"3", N12→"X" 百の位にある"6"は、2個前にあるので→ O12→"2", P12→”X” 十の位にある"2"は、10個遡ってもありません。 なので右隣の一の位へ…。すると一の位の9個前にあるので → Q12→”X" , R12→”一,9” 一の位にある"2"は、9個前にあるので → S12→"9" , T12→"X" となる表を作成したいのです。 ※(千・百・十・一)の表記が難しい場合（あ・い・う・え）でも構いません。 調べ記載したい行が、I12～から始まりL2710まで、、、約3000行弱の数字を一個づつ調べるのは大変で、とても困っています。 良い方法は、無いでしょうか？？？ 何卒、お力をお貸しください！！ よろしくお願いいたします。
800万行、1.4GBのCSVファイルをLineにより100万行ずつシートに読み込み、処理してます。 100万行読み込み コンマを区切り文字にして展開 データ処理 次の100万行読み込み の手順です。 出だしは快調で1シート20秒程度で読み込みます。ところが、シートを重ねるごとにだんだん遅くなり、１シート５分、最後の方はメモリーオーバーでエラーとなり、最後まで行き着いてません。ウインドウ下枠に表示される「フィル」で時間がかかります。その後で表示される「区切り位置」以降、データ処理は普通です。おそらくLineによる読み込みで時間がかかっていると思います。なぜでしょうか？どうすればいいでしょうか？ エラー位置はDoの３行下です。 Sub Macro1() Dim vFile As Variant Dim WSdata As Worksheet Dim ffn As Long Dim vA() As Variant Dim j As Long, k As Long Const Half As Long = 500000 ' １回の書き出し行数 Const CROWSZ As Long = 1000000 '1シートへの書き出し数 vFile = ThisWorkbook.Path & "\CSVconverted.CSV" ReDim vA(1 To UnitRead, 1 To 1) '100万行を入力するワークシート Set WSdata = ThisWorkbook.Worksheets("CSV") 'CSVファイルを開く ffn = FreeFile() Open vFile For Input As #ffn j = 1 k = 1 Do Line Input #ffn, vA(j, 1)　　　'1行ずつ読み込み If j >= Half Or EOF(ffn) Then WSdata.Cells(Rows.Count, "A").End(xlUp).Offset(1, 0).Resize(UBound(vA), 1).Value = vA 'ここで止まる。vAにマウスを当てると「メモリーオーバー」と表示 ReDim vA(1 To UnitRead, 1 To 1) j = 0 If k >= CROWSZ Or EOF(ffn) Then 　　　　　　'コンマを区切り文字にして展開 With WSdata.Range(WSdata.Cells(2, "A"), WSdata.Cells(Rows.Count, "A").End(xlUp)) Application.DisplayAlerts = False .TextToColumns .Cells(1), xlDelimited, Comma:=True Application.DisplayAlerts = True End With k = 0 'データ処理がここに記載 WSdata.Cells.ClearContents End If End If j = j + 1 k = k + 1 Loop While Not EOF(ffn) Close #ffn 'CSV閉じる End Sub
B3~B12まで1→10の昇順で基準としてが入力され C3~F12まで0～9までの数字がランダムに入っています。 これらのC3~F12にある0～9の各数字が何個入っているか？を求め、 G3～H12に、G列には0～9の各数字を、H列にはその数字の総個数を降順で並べ、表にしたいのです。しかし、この並べ替えの際、総数が同じ個数の数字が、いくつか出てきてしまいます。 この総数が同じ個数の場合の優先順位を 　　　　C12→D12→E12→F12→ 　　　　C11→D11→E11→F11→ 　　　　C10→D10→E10→F10→ 　　　　C9 →D9 →E9 →F9→・・・・・・→F3 という具合に、降順でありながら、総個数が同じ数字は、下から上へ、左から右へという優先順位順で並び直し、表にしたいのです。 COUNTIF関数とオートフィルターを使い単純に降順に並べ替えた後、ちまちまと手動で並べ替えていたのですが、これが　サクッと出来る方法を探しています。 知恵者の皆さまで、ご存知の方、ご教授いただけたら幸いです。
主題の環境で、以下の構文で、止まりはしませんが、ファイルが無い　を　返します。 同じ構文で　2013/win7　で　実行しています。 10でも、動くマシンがあるのですが・・・・、逆に　2010/WIN10　で動きません 何の環境でしょうか？　参照設定は同じです。エクセルはすべて32BITです Dim buf As String ', appwb As Workbook, appSheet As Worksheet Dim Target As String, f_Target As String Target = orgdata.Range("L4") f_Target = orgdata.Range("L5") ''ファイルの存在チェック buf = Dir(Target) If buf = "" Then MsgBox Target & vbCrLf & "は存在しません", vbExclamation Exit Sub End If ''同名ブックのチェック For Each appwb In Workbooks If appwb.Name = buf Then MsgBox buf & vbCrLf & "はすでに開いています", vbExclamation Exit Sub End If Next appwb ''ここでブックを開く ' Application.ScreenUpdating = False Workbooks.Open Target Set appwb = Workbooks(f_Target) '////////// Target = Sheet2.Range("G2") 'Target = "b.xlsm" f_Target = ActiveWorkbook.Path & "\" & Target Debug.Print Target & "--" & f_Target ''ファイルの存在チェック With CreateObject("Scripting.FileSystemObject") If .FileExists(Target) Then Workbooks.Open Target Else MsgBox Target & vbCrLf & "が存在しません" End If End With
VBA初心者です。AccessでVBAにより、 ①：ファイルダイアログを開く→②：CSVファイルを選択する（CSVファイルのみ選択可に設定）→③：一行ずつ読み込む→④：新しいファイルへコピー→⑤：③④最終行までを繰り返す→⑥コピーされたCSVファイルが完成 という操作を行いたいです。 どのように記載すれば良いか教えてください。 よろしくお願い致します。
Excel VBAを始めたばかりの初心者です。 図形を選択した後に、Application.Dialogs(xlDialogPatterns).Show でカラーパレッドを 呼び出した時に、図形の塗りつぶしは変更できるのですが、輪郭は色もスタイルも何も 変更できません。 これはなぜなのでしょうか？ ご教授よろしくお願いいたします。
29の問題が分かる方がいたら教えてください。
下記のperlのソースでエラーになる。 use DBIx::Custom; my $dbi = DBIx::Custom->connect( dsn => "dbi:ODBC:Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=C:/Users/usui/Documents/Access/目標管理/151225.accdb" ); 下記のエラーが出る。 DBI connect('Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=C:/Users/usui/Documents/Access/目標管理/151225.accdb','',...) failed: [Microsoft][ODBC Driver Manager] データ ソース名および指定された既定のドライバーが見つかりません。 (SQL-IM002) at C:/Perl64/site/lib/DBIx/Custom.pm line 1656. (DBIx::Custom::_connect) at C:\Users\usui\Documents\Access\目標管理\02.pl line 2. perlのDBIx::Customはperldocで確認を取っています。odbcドライバーのインストールは終わっていますがそれ以外の設定が有るのでしょうか。 特にデータソースなどの設定はしていないのですが。詳しい方の説明をお願いします。
Dirでファイルの存在を確認しworkbooks.openで次々と開き、望みの処理をして次に移る操作をしてます。ファイルが大量にあるので、何らかの理由で開けない事がたまにあり、処理が中断してしまいます。。その時、処理を止めずさっさと次に移るにはどうすればいいでしょうか？ 要はファイルを開く際のエラー判定方法を知りたいのです。
Office365, Excel 2013を使用していますが サーバにあるExcelを起動して、他のサーバにあるExcel/Accessのファイルを開くシートがあります。 今までずっと機能していたのですが、何故か、今日、使用してみるとどのボタンも機能しません。 エラーメッセージは 実行時エラー： '1004':、ファイルが開けない 詳しくは画像を添付しますので、そちらの方をお読み下さい。 原因が良くわからず、心当たりとしては、本日自分のPCのパスワードを変えたくらいですが、これはさほど影響はないと思います。 誰か、問題の解決の手助けをしていただけるかたがおられましたら、ぜひとも、ご助言をお願い致します。
Windows7＆Access2013にてファイルのPathを取得しようとしておりますが、思う ように動いてくれませんので、教えて戴きたいと思います。 内容は、エクスプローラーを予め開いておいて、Accessのフォーム上の指定箇所へと ファイルをドラッグ＆ドロップするだけで、Accessのフォーム上のテキストボックス へとそのファイルのPathを表示させようとしております。 下記URL_その１ではhtmlファイルが削除されてしまったのかアクセスが出来ず、 下記URL_その２ではその内容通りに作業をしても何も動きません。 （プログレスバーの名前はhtml記載のものへと変更しております） URL_その１：http://www.sanryu.net/acc/tips/tips279.htm URL_その２：http://accessclub.jp/bbs/0109/beginers37871.html Access超初心者ですので、OLEDropModeの値を「1」にする意味すら理解出来ており ませんが、よろしくお願いします。
こんにちは。宜しくお願いいたします。 Pivot table で集計したテーブルのデータをCSVで出力する事はできないでしょうか。 もとがCSVデータからPivot tableを作成している感じですが加工したデータを再度CSVでエクスポートしたいです。 検索するとCSVからPivot tableを作る方法はヒットするのですが。。 結果として同じことなるならその方法でも結構なので宜しくお願い致します。
マクロ初心者です。仕事で膨大なデータ処理をする為にマクロを作りたいのでご教示ください。 リスト1　→　　リスト2 品名　　個別　　答え　　　　　品名　　　ａ１　a2　b1　b2 りんご　a1　　　　A　　　　りんご　　 A B C D りんご　b1　　　　B　 みかん　　　　E F G H　　　 りんご　a2 C りんご　b2 D みかん　a1 E みかん　b1 F みかん　b2 G みかん　a1 H 上記の様に別シートがあります。その中で品名を検索し個別にあるデータをリスト2へ転記したいです。品名は重複しているのでオートフィルタで抽出し別シートへの転記がわかりません。因みに個別はバラバラに並んでいます。 拙い文章で分かりづらく申し訳ありません。 宜しくお願いします。
エクセルのセル内に入力した情報をテキストボックスに持っていく方法はテキストボックス内にセルのアドレスを入れれば出来ると分かりましたが、逆にテキストボックス内の情報をセルに持っていくやり方が良く分かりません。 インターネットで下記の様な情報があったのでやってみましたが、「End Sub」が無い、という様なエラーが出てうまくいきません。 ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー ＜使用例 テキストボックスに入力された値をセルA1に代入する＞ Private Sub TextBox1_Change() Range("A1") = TextBox1.Value End Sub ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー 内容としては下記の様なものだと思っていますが正しいでしょうか？ （１）テキストボックスの名前を確認または希望する名前に変更 （２）開発、VBAでマクロを入力する 　　　　Range("A1") が出力したいセル 　　　　TextBox1が参照したいテキストボックスの名前 また、VBAで無く、コマンド操作で実施してマクロ記録とすることは出来ないのでしょうか？ 以上、よろしくお願いいたします。
いつもお世話になります。 また自己解決できずです・・・・ 日付(yyyy年m月d日）が入っているシート名のブックがあるのですが、インプットボックスで日付の yyyy年ｍ月の部分を入力して、そのyyyy年ｍ月の部分の文字が含まれるシートを削除したいコードが以下です。 Sub test1() Dim saaa As String Dim daaa As Worksheet saaa = InputBox("日付を入力") For Each daaa In Worksheets If daaa.Name = "*" & saaa & "*" Then Worksheets("*" & saaa & "*").Delete Exit Sub End If Next MsgBox "探しているシートはありません" End Sub おそらく　If daaa.Name = "*" & saaa & "*" Then 　　　　　Worksheets("*" & saaa & "*").Delete 　　　　　　　 この2行がおかしいのだ思います。何とかご教示願いたいです。 宜しくお願い致します。
次のマクロは、ニコニコ動画のマイリストページを開き、動画の数を取得するVBScriptになります。 Dim objIE 'as Object Dim Movies 'as integer Set objIE = CreateObject("InternetExplorer.Application") objIE.Navigate "http://www.nicovideo.jp/mylist/53973672" Do until objIE.readystate=4 Wscript.Sleep 200 Loop Movies = objIE.Document.GetElementsbyClassName("SYS_box_item").Length '動画の数を取得 msgbox Movies objIE.quit set objIE = Nothing また添付図は、そのマイページのソースの一部になります。 ここで質問なのですが、同じクラス（今回はSYS_box_item）から、任意のｎ番目のタグIDを取得したい場合には、どのように記述すれば良いのでしょうか？ HTMLに詳しくないので、教えていただきたいです。
ExcelVBAでワークシートを監視している状態で，VBscriptを実行して，IEを操作したいと考えています。ただ，このとき，監視していたワークシートの中の数値を引数としてVbscriptに渡したいと考えています。このようなことが出来るのでしょうか？出来るのであれば教えてください。 もし，引数として渡すことが出来ないのであればVBscriptの方から，ワークシートのセルを読みに行かせるという方法もあると思うのですが，VBAの方でワークシートの値を更新するので，VBAとVBscriptの両方が同時に同じセルを操作したりすると，不具合が起こったりするのではないかと心配です。ですから，ワークシートの読み書きはVBAにやらせて，VBAから，引数のようにして必要なデータをVBscriptに渡せないかと考えています。 しかし，エラー処理などをして，上記の不具合が解消できるのであれば，引数で渡すのではなく，ワークシートを読みに行く形でも良いのかなと思っていますが，そうすると，VBscriptで既に開いているワークシートを特定して，所定のエクセルシートを操作できるようにしなければなりません。その際の具体的な方法等が分れば，教えていただきたいです。（UWSCでいうところの，getactiveoleobject？みたいなのがあれば，それを中心に，サンプルコードを御提示いただきたいです。） どうか，よろしくお願いします。
店名リスト(店の番号)から品目Aの今年度の売上だけ(一週目から13週目まであります。）を別ブックに反映させたいのですが… マクロや関数でも構いませんので教えて頂けると幸いです。 質問の意図がわかりづらくて申し訳ありません。
Sub Auto_Open() Dim OpenFileName As String Dim wb As Object rc = MsgBox("体温表を開いている場合は起動できません。" & vbCrLf & "体温表は全て閉じていますか?", vbYesNo + vbQuestion, "バグ差し替え") If rc = vbYes Then MsgBox "バグのある体温表を選択して下さい。", vbInformation, "バグ差し替え" ChDrive "E" ChDir "E:\コスモス2006リンクフォルダ\体温表" OpenFileName = Application.GetOpenFilename("Microsoft Excelブック,*.xlsm?") 'ここでバグファイルを選択させる.ア行～ワ行というフォルダがある。 On Error Resume Next 'エラーがあっても続行する Application.ScreenUpdating = False Application.DisplayAlerts = False 'ーーーーーーーーーここのマクロをつくってほしいーーーーーーーーー '①選択したファイルを“E:\コスモス2006リンクフォルダ\体温表\2016\※バグあり分”に移動させる。ただし2016は現在の年とする。 '②“E:\コスモス2006リンクフォルダ\体温表\2016\※原本\新体温表色あり”をコピーし、選択したファイルが置いてあったフォルダ内に貼り付け、選択したファイル名と同一に名前にリネームする。 '③選択して移動させたファイルの名前に、右記を追記＆リネームする。“バグありｎ”※ｎは複数ある場合に数字２～を追記。 'ーーーーーーーーーーーーーーー以上ーーーーーーーーーーーーーーー '④双方を開いて、各シートのテキストをコピー/ペースト、終了とする。 '⑤シートは説明書とする Application.ScreenUpdating = True Application.DisplayAlerts = True If Err.Number <> 0 Then 'エラーがあったら実行する MsgBox "体温表の選択に失敗しました。" Exit Sub 'マクロの実行を終了する End If Else MsgBox "処理を中断します。", vbCritical End If End Sub 何卒よろしくお願いします。
条件（範囲列A~D）に合う数字を各指定の色で塗りつぶしをしたいのですが、、、。 塗りつぶしの範囲はB3～GN62です。 A2~A12の範囲にある数字と該当する場合は、黄色 B2~B12の範囲にある数字と該当する場合は、オレンジ C2～C12の範囲にある数字と該当する場合は、黄緑 D2~D12のの範囲にある数字と該当する場合は、紫 列A~Dまでは、歯抜けの状態ですべてのセルに数字が入ってるわけではありません。 知恵者の皆様の御回答をお待ちしております。
すいません、エクセルＶＢＡを使って置換をしたいのですが、力を貸してください。 仮に Sheet1のセルA1に「こんにちは私は元気です。」 Sheet2のセルA1に「自分」 とあったとします。 置換するときに 検索する文字列が「私」 置換後の文字列にSheet2のセルA1を入れて 置換後は「こんにちは自分は元気です」 このようにしたいのですが、ＶＢＡではどのようにして書けばいいのか教えてください。
こんばんは。いつもお世話になっております。 今回も自力では解決出来なかった為、質問させていただきました。 やりたいこと 1.エクセルのBook1のsheet1(sheetの名前は''テンプレート'')には、情報を書き込んでいくだけのテーブルのテンプレートと、マクロが入っています。このテンプレートを自動で複製して同じBook内にsheet2を作成し、名前を''1月''とします。同様に、12月まで作成させます。 2.複製されるタイミングは月が変わった瞬間に作成されるようにしたいです。 3.sheetには毎日情報を書き込んでいくので、日付が変わったら自動でバックアップをフォルダAに作成されていくようにもしたいです。 よろしくお願い致します。
こんばんは 下記内容はHTAアプリケーションにおいて、button1をクリックすると、1回目はSample1プロシージャが発動をし、２回目以降はSample2プロシージャが発動することを期待したコードになります。 <body> <script type="text/vbscript"> Sub Sample1 button1.onclick = "Sample2" msgbox "Sample1" End Sub Sub Sample2 msgbox "Sample2" End Sub </script> <input type="Button" onclick="Sample1" value="実行" id="button1"> </body> しかし、実際には２回目以降はメッセージボックスが表示されず、onclickイベントが動作していないようです。 ここで質問なのですが、onclick="Sample1"の状態からonclick="Sample2"の状態へとタグ内容を変更をすることはできるのでしょうか？（if条件式を用いてプロシージャの実行先を変更したいのではありません。タグの書き換えによる実行先の変更を目的とした質問です） また、onclickから他のイベント（例えばonmouseover）に変更することはできるのでしょうか？ 以上２点です。ご存じの方は教えていただきたいです。 なお、現状の回避策としてはinputタグをdiv要素に組み込んで、div1.innerHTMLにてinputタグの中身をすべて書き換えています。↓ Sub Sample1 div1.innerHTML = "<input type=""Button"" onclick=""Sample2"" value=""実行"" id=""button1"">" msgbox "Sample1" End Sub <div id="div1"> <input type="Button" onclick="Sample1" value="実行" id="button1"> </div>
セル範囲をコピー 図としてペースト ペーストされた図形を選択 記録マクロで書くと下記のようになります。 Sub Macro1() Range("G2:K15").Select Selection.Copy Range("A1").Select ActiveSheet.Pictures.Paste.Select ActiveSheet.Shapes.Range(Array("Picture 1")).Select End Sub ・場所を指定してペーストするのは、事前にselectする必要あるのでしょうか？ ・挿入された図の名前がPicture1と分ってないと選択出来ません。他に方法あるのでしょうか？ 図は複数あり、たった今ペーストした図形を選択したいのです。 参考になるURLあるいは書籍はないでしょうか？
お世話になります 親ウインドのHTAアプリケーション内にボタンを設置し、そのボタンを押すと”新たにHTAファイルを作成し”別ウインドとして生成したHTAアプリケーション画面を表示するようにしたいのです。（表示後は生成したHTAアプリケーションは削除する） これ自体は、実現できたのですが、いくつか疑問点がありましたので、教えていただきたいです。 長くなるので、先に質問だけ記載します。１つでも良いので教えていただけると嬉しいです。 コード①の質問、終了していない文字列型の定数と表示されるのはなぜか？ コード②の質問、scriptの文字列が入らないように分割して変数に入れるとエラーが出ないのはなぜか？ コード③の質問、タグを記載したsample2.htaを生成し、runメソッドで起動したが、runメソッドの後にdeletefileメソッドを行なうと、inputタグを記載したにもかかわらず、テキストボックスが表示されないのはなぜか？ コード④の質問、sample2.htaを削除する手順を別プロシージャに分けたが、Callメソッドではテキストボックスが生成されず、SetTimeOutメソッドでは生成されるのは何故か？ （※④のコードで１秒後にdelfileプロシージャが呼び出されるわけではないのはわかっていますので、SetTimeOutメソッドの誤用は指摘しないで頂きたいです。） 以下、ボタンを押しonclickイベントで呼び出されるプロシージャのみ記載します。 ①最初に書いたコード、「終了していない文字列型の定数」エラーが出るのは何故？ sub sample set fso = CreateObject("Scripting.FileSystemObject") set sh = CreateObject("Wscript.Shell") set Mhta = fso.opentextfile("C:\sample2.hta",2,true) Mhta.Writeline "<body><script type=""text/vbscript""></script><input type=""text""></body>" Mhta.close sh.run "mshta.exe C:\sample2.hta" End sub ②Writelineの内容を試行錯誤した結果、scriptと記載が入っているとNGなようなので、scriptという文字列が入らないように変数に分割して結合。エラーが出ないので上の理論は合ってる？ sub sample set fso = CreateObject("Scripting.FileSystemObject") set sh = CreateObject("Wscript.Shell") set Mhta = fso.opentextfile("C:\sample2.hta",2,true) a = "<body><scrip" b = "t type=""text/vbscrip" c = "t""></scrip" d = "t><input type=""text""></body>" Mhta.Writeline a&b&c&d Mhta.close sh.run "mshta.exe C:\sample2.hta" end sub ③ボタンクリックにてsample2.htaを表示後、生成したsample2.htaファイルを削除したいので、 end subの１行前に以下のコードを追記、何故かsample2.htaにテキストボックスが表示されない fso.deletefile "C:\sample2.hta" ④起動前にファイルが削除されてしまっているのかと思い、削除を別プロシージャに分けたところ、callメソッドではテキストボックスが生成されないが、SetTimeOutでは生成されるのはなぜか fso.deletefile "C:\sample2.hta"　　の代わりに、delfileプロシージャを呼び出す２例 （ⅰ） Callメソッドを用いた場合（sample2.htaウインドにはテキストボックスは表示されない） Call delfile end sub sub delfile set fso = CreateObject("Scripting.FileSystemObject") fso.deletefile "C:\sample2.hta" set fso = nothing end sub （ⅱ）setTimeOutを用いた場合（sample2.htaウインドにはテキストボックスが表示される） setTimeOut "delfile",1000 end sub sub delfile set fso = CreateObject("Scripting.FileSystemObject") fso.deletefile "C:\sample2.hta" set fso = nothing end sub 以上です、よろしくお願いします。
マクロ初心者です。 【】はシート名です。 【テスト2】のB7に、【テスト1】のオートフィルターをかけたAC列を合計した値を入力し、 その後C7,D7と同様にAC列の合計値を入力したいと考えています。 しかし、下記のようにVBAを組むと、中断してしまい上手くいきません。 正しいVBAの組み方をご教授いただけますでしょうか。 また、本当はAC列を絶対参照したVBAを組みたいのですが、 方法がわからず、下記のような組み方になっています。 AC列を絶対参照にして組む方法も教えていただきたけますでしょうか。 -------------------- Dim i As Long For i = 1 To 12 Worksheets("テスト1").Range("$A$1:$XFD$1048576").AutoFilter Field:=1, Criteria1:="4月" Worksheets("テスト2").Cells(7, 1 + i) = "=subtotal(9,テスト1!C28 - i)" ------------------- よろしくお願いいたします。
エクセルのセル式の非表示ですが、教科書の様な、書式設定・・・シートの保護で　可能は可能ですが マクロの実行に　問題が出て　使えません。 アドオンが使えない　とか　データを自動でカットするような（データ域A~Eの110から2000行までを10行頭に　コピーして、1900～2000行削除（データ域を参照するセル式領域の　ｆ～ｚはコピーなしの削除だけ））ことなど、保護が邪魔します。 保護の解除や実行をVBAからやれなくはないのかもしれませんが、アドオンが使えないというか、それを叩くと、マクロが使えなくなっている　というエラー表示です（使っているシートは別なんですがねえ） セル式をVBAに書き換えて、お茶を濁しているのですが・・・ 何かうまい方法は無いでしょうか
https://oshiete.goo.ne.jp/qa/9159489.html このページで Excel VBAを使って D:\aaa\bbb\のフォルダーが もし、開かれていなければ 最前面表示でこれを開き、 もし、既に開かれていればそのウインドウを最前面表示にするプログラム の作り方を教えていただきました。 できればそれと同時に そのフォルダー内のあるファイルにフォーカスを合わせたいのですが どうすれば良いでしょうか？ http://www.accessclub.jp/bbs2/0135/beginter40526 … このページにあるように Call Shell("Explorer.exe /select,""" & 変数名 & """", vbNormalFocus) を使えば、ファイルにフォーカスを合わせることができます。 しかし、フォルダーが新しく開いてしまいます。 もし既に開いている場合には、 新規に開かずに既に開かれているフォルダー内のファイルを選択しながら 最前面表示したいのですが このようなことは可能でしょうか？
A列で入力した数値をE列に表示されるようしたく 色々調べてコピペしているのですが・・・・ （A列に入力するとE列にバーコードで表示される仕組みです） --------------------------------- Private Sub Worksheet_Change(ByVal Target As Range) Call Columns(1).Copy(Columns(5)) Set font1 = Range("E:E").Font font1.Name = "BC39" font1.Size = 30 Range("E:E").HorizontalAlignment = xlCenter End Sub --------------------------------- 1行目は各表の説明見出しなのですが A1の見出しがE1に変更されてます。 お手数ですが、よろしくお願いします。
いつもお世話になります Dim saa As String saa = InputBox("実行する日付を入力して下さい" & vbCrLf & "入力例）2016/03/17（半角入力）", "日付入力") If saa = "" Then Exit Sub If Not IsDate　saa Then MsgBox "日付の入力が間違っています" & vbCrLf & "2016/01/07のように入力して下さい", 16 End If 上記コードは一応、yyyy/mm/dd で入力してもらうようにしているコードのつもりです。 でも、正確に動作しません。 このコードを、日付入力の方法が間違っていたら、Exit Sub で終わるのでななく、ループ？ってやつできちんと日付入力がされるまでマクロが終わらないコードに修正して頂きたいです。 どなたか、ご教示頂ける方いらっしゃいましたらよろしくお願い致します。
2次元配列を作成し、コレクションにAddし、 ループで処理をしたいと考えています。 Addしたものの、取り出す方法がわかりません。 ローカルウインドウで確認すると、値が表示されているので、 test に　2次元配列は追加されているようです。 　 Dim test As Collection Set test = New Collection Dim tmp(0, 9) As String tmp(0, 0) = "test" tmp(0, 1) = "56" test.Add tmp tmp(0, 0) = "test2" tmp(0, 1) = "tttt" test.Add tmp この後　test　の中の2次元配列の値をループで取り出したいです。 取り出して、セルに代入する予定です。 どうかアドバイスをお願いいたします。
以下のマクロをより短く出来ませんか？よろしくお願いしますｍ－－ｍ Case "M50" Range("O50").Select Case "O50" Range("Q50").Select Case "Q50" Range("R50").Select Case "R50" Range("M51").Select Case "M51" Range("O51").Select Case "O51" Range("Q51").Select Case "Q51" Range("R51").Select Case "R51" Range("M52").Select Case "M52" Range("O52").Select Case "O52" Range("Q52").Select Case "Q52" Range("R52").Select Case "R52" Range("M53").Select Case "M53" Range("O53").Select Case "O53" Range("Q53").Select Case "Q53" Range("R53").Select
お世話になっております Excelのシート追加について質問させてください 例えば1月1日というシートを VBAを使い、1日のシートの書式、関数など全てコピーし シートの名前を1日、2日、3日と 連続した数値のシートを追加したいのです 私なりに考えたのですが、 シートを31日分コピーして、特定のセルにある数値を シート名にするVBA処理で出来るのではないか？ しかし、その場合だと関数がわかりません 1日のA1セルに1日と入力し 2日のA1セルに2日と入力できる関数ってありますか？ 最近VBAに手を出した初心者なので、 わからないことが多いですが、 よろしくお願いします
Excel VBAを使って D:\aaa\bbb\のフォルダーが もし、開かれていなければ 最前面表示でこれを開き、 もし、既に開かれていればそのウインドウを最前面表示にするプログラムを 作りたいのですが どのようにすれば良いでしょうか？
このマクロを ①より早く、又は ②より簡潔に できないでしょうか？何卒ご教授願います。 ※Win8.1/７、Excel2010です。 Sub Auto_Open() Application.ScreenUpdating = False ActiveWorkbook.EnableAutoRecover = False '''自動保存の無効 Call シートの選択 '''追記ここから '''Application.StatusBar = "" '''小連絡用　要StatusBar表示 Application.CellDragAndDrop = False '''Call Auto_Jump '''追記ここまで CommandBars("Cell").Enabled = False '''右クリック不可 Application.ScreenUpdating = True Call Auto_Jump End Sub Sub Auto_Close() Application.Visible = False Application.WindowState = xlMinimized Application.DisplayAlerts = False CommandBars("Cell").Enabled = True '''右クリック可 ActiveCell.Activate '''追記ここから Application.CellDragAndDrop = True ActiveWindow.ScrollColumn = 1 ActiveWindow.ScrollRow = 1 '''追記ここまで Application.Visible = True UserForm2.StartUpPosition = 3 '''UserForm表示 UserForm2.Caption = "" UserForm2.Show vbModeless UserForm2.Repaint ThisWorkbook.Activate If ThisWorkbook.Saved = False Then ThisWorkbook.Save End If Call ●見出しを表示する Unload UserForm2 '''UserForm非表示 ActiveWorkbook.Close End Sub
特定範囲のセルはEnterした時に右などにカーソル移動するマクロを作りましたが、文字数は3万文字を超え、ビット数の肥大化により保存終了に時間がかかります。このマクロを簡潔にできないでしょうか？何卒ご教授願います。尚、マクロのテキストは長すぎるので以下リンクに掲載しています。 ※Win8.1/７、Excel2010です。 http://4vote.sakura.ne.jp/macro.html
"H133"のセルが今月の数字になっており、その数字に応じてシートを選択するマクロを作りましたが、明らかに初心者が作ったような非効率なマクロになっているようで、保存時間に影響がでるので、なるべく短く訂正したいのですが、どうかご指導頂けると幸いです。 ※Win8.1/7、Excel2010です。 Sub シートの選択() If Range("H133") = 1 Then Worksheets("1月").Select End If If Range("H133") = 2 Then Worksheets("2月").Select End If If Range("H133") = 3 Then Worksheets("3月").Select End If If Range("H133") = 4 Then Worksheets("4月").Select End If If Range("H133") = 5 Then Worksheets("5月").Select End If If Range("H133") = 6 Then Worksheets("6月").Select End If If Range("H133") = 7 Then Worksheets("7月").Select End If If Range("H133") = 8 Then Worksheets("8月").Select End If If Range("H133") = 9 Then Worksheets("9月").Select End If If Range("H133") = 10 Then Worksheets("10月").Select End If If Range("H133") = 11 Then Worksheets("11月").Select End If If Range("H133") = 12 Then Worksheets("12月").Select End If If Range("F1") <> Range("H134") Then MsgBox "この体温表は " & Range("F1") & " 年分です。" & vbCrLf & "　　 (現在は " & Range("H134") & " です)" Worksheets("1月").Select End If
エクセルでマクロを作り始めた初心者です。 選択した図形に対して色やフォントなどを変更したいため、Selection.Shaperangeを使っています。 例えば下記のようなものです。 Sub 図形の文字を太くする() Selection.ShapeRange.TextFrame2.TextRange.Font.Bold = msoTrue End Sub しかし、図形を選択していない時にこのマクロを動かすとエラーが発生します。 このエラーが発生しないようにするにはどうすればよいでしょうか？ ご教授よろしくお願いいたします。
現在時間を30分隔ててにアクティブセルに入力するマクロを作りましたが10kBもあり保存終了回数が多いので保存終了時間に影響があります。このマクロを簡潔にできませんか？ご教授願います。 ※Win8.1、Excel2010です。 Sub 時間詳細0_8() If Time >= TimeValue("0:00:01") And Time <= TimeValue("0:30:00") Then ActiveCell.Value = "0:00" ElseIf Time >= TimeValue("0:30:01") And Time <= TimeValue("1:00:00") Then ActiveCell.Value = "0:30" ElseIf Time >= TimeValue("1:00:01") And Time <= TimeValue("1:30:00") Then ActiveCell.Value = "1:00" ElseIf Time >= TimeValue("1:30:01") And Time <= TimeValue("2:00:00") Then ActiveCell.Value = "1:30" ElseIf Time >= TimeValue("2:00:01") And Time <= TimeValue("2:30:00") Then ActiveCell.Value = "2:00" ElseIf Time >= TimeValue("2:30:01") And Time <= TimeValue("3:00:00") Then ActiveCell.Value = "2:30" ElseIf Time >= TimeValue("3:00:01") And Time <= TimeValue("3:30:00") Then ActiveCell.Value = "3:00" ElseIf Time >= TimeValue("3:30:01") And Time <= TimeValue("4:00:00") Then ActiveCell.Value = "3:30" ElseIf Time >= TimeValue("4:00:01") And Time <= TimeValue("4:30:00") Then ActiveCell.Value = "4:00" ElseIf Time >= TimeValue("4:30:01") And Time <= TimeValue("5:00:00") Then ActiveCell.Value = "4:30" ElseIf Time >= TimeValue("5:00:01") And Time <= TimeValue("5:30:00") Then ActiveCell.Value = "5:00" ElseIf Time >= TimeValue("5:30:01") And Time <= TimeValue("6:30:00") Then ActiveCell.Value = "6:00" ElseIf Time >= TimeValue("6:30:01") And Time <= TimeValue("7:00:00") Then ActiveCell.Value = "6:30" ElseIf Time >= TimeValue("7:00:01") And Time <= TimeValue("7:30:00") Then ActiveCell.Value = "7:00" ElseIf Time >= TimeValue("7:30:01") And Time <= TimeValue("8:00:00") Then ActiveCell.Value = "7:30" ElseIf Time >= TimeValue("8:00:01") And Time <= TimeValue("8:30:00") Then ActiveCell.Value = "8:00" ElseIf Time >= TimeValue("8:30:01") And Time <= TimeValue("9:00:00") Then ActiveCell.Value = "8:30" End If End Sub
ＶＢＡ初心者です。 自力ではどうしても解決できず、投稿させていただきました。 添付したような表があります。 やりたい事 ①品名の中から「バナナ」を、産地の中から「マレーシア」を、グレードは「空白」、○は「空白」、×は「空白」と、複数の条件に合致したデータを抽出させて、個数・売上・粗利の合計を出します。 ②別のブック（集計表）には、添付画像と同じようなテーブルがあります。 との中から、品名・産地・グレード・○・×すべて合致した行を探して、見つかった場合①で出した個数・売上・粗利を集計表に合算させます。 見つからなかった場合は、新たに行を作成させます。 以上です。 よろしくお願い致します。
表題のとおりですが、 例えばsheet1,sheet2,sheet3とあり、ファイルを閉じるときにsheet3のみ強制的に上書き保存をして終了させたいのです。閉じるときに「変更を保存しますか？」というメッセージが出てきて、保存しないをクリックしてもsheet3だけは保存されているような設定は可能でしょうか？ なぜこのような設定がしたいのかと言うと、作業しているsheet上で誤った入力などがなかったか記録したいのです。この記録するプログラムはネット上で見つけたのですが（下記に示します）、記録されていくシートだけを上書き保存したいと思っています。単純に上書き保存すれば残る話しですが、作業しているシートはフォームが決まっているので変更（上書き保存）を許したくありません。 それか、この記録したシートだけを別のファイルで保存していく方法でも構いません。但し、あくまで自動上書き保存が前提です。どうか宜しくお願い致します。 Private Sub Worksheet_Change(ByVal Target As Range) Dim X As Integer, Y As Integer Dim LastRow As Long X = Target.Column Y = Target.Row If Worksheets("Sheet2").Range("A" & Rows.Count).End(xlUp).Row = Rows.Count Then Exit Sub End If LastRow = Worksheets("Sheet2").Range("A" & Rows.Count).End(xlUp).Row + 1 Worksheets("Sheet2").Range("A" & LastRow) = DateValue(Now()) Worksheets("Sheet2").Range("B" & LastRow) = Target.Address(Y, X) Worksheets("Sheet2").Range("C" & LastRow) = Cells(Y, X) End Sub
マクロ初心者です。 エクセルで出納帳を作っています。 必要に応じて行を追加挿入する為に、ボタンを作成しそこからアクティブセルのある行の次の行に 行を追加し計算式をコピーするマクロを入れてあります。 （ネットで見つけたコードを参考にしています。） 一行挿入して数式をコピーさせるコードは下記のとおりです。 （挿入ボタンクリック、確認してから行が挿入するようになっています） 列はA列からP列まで使用、 A、B、C、D、H、K、M、N、O、Pの各列に計算式が入っており、挿入した行の各列の数式をコピーさせています。 ちなみに、Eはドロップダウンリストから選択、F、G、I、J列は手入力で必要なデータ等を入力しています。 アクティブセルがある行はセル色が緑になるようになっております。 画像が小さくて見づらいかもしれません。 申し訳ありません。 Sub 追加確認() If MsgBox("実行してよろしいですか？", vbOKCancel) = vbOK Then insert_click End If End Sub Sub insert_click() Sub insert_click() Application.ScreenUpdating = False ThisWorkbook.ActiveSheet.Unprotect Password:="0000" Dim wgyou As Long wgyou = ActiveCell.Row If wgyou < 2 Then Exit Sub Application.CutCopyMode = False Range(wgyou + 1 & ":" & wgyou + 1).Select Selection.EntireRow.Insert Range("A" & wgyou & ":D" & wgyou).Copy Range("A" & wgyou + 1 & ":D" & wgyou + 1).PasteSpecial Paste:=xlPasteFormulas Range("H" & wgyou).Copy Range("H" & wgyou + 1).PasteSpecial Paste:=xlPasteFormulas Range("K" & wgyou & ":P" & wgyou).Copy Range("K" & wgyou + 1 & ":P" & wgyou + 1).PasteSpecial Paste:=xlPasteFormulas Application.CutCopyMode = False Range("A" & wgyou + 1).Select ThisWorkbook.ActiveSheet.Protect Password:="0000" Application.ScreenUpdating = True End Sub 複数行追加する場合、時間も掛かり一行ずつ追加するのに不便が生じている為 「行挿入ボタン」⇒「挿入の確認」⇒「挿入する行数の指定」⇒「指定した行数を挿入しアクティブセルのある行の数式を挿入した行数分コピーさせる」 ができるコードに変更したいと思っています。 複数行挿入するコードもネットを参照して入れてみましたが いくら調べても複数行挿入と計算式をコピーさせることができません。 重複しますが、上記のコードを指定した行数分行行を挿入し、数式をコピーさせるように変更させたく思います。 分かりづらい説明で大変申し訳ありませんが、 何卒お力添えいただけますようよろしくお願いいたします。
指定セルの合計数値が10を超えると0に戻すマクロはありますか？ 各行ごとに実行できればと思っております。 A列 B列 あ 5 い 6 う 10←11になったら0に戻して、またカウントがスタート え 9 お 2 よろしくお願いします。
VBAを利用すれば、簡単に表が作成できる♪ヽ(´▽｀)/ などど、あれや これやと試してみましたが、やはり初心者。 えーっと、、、んーっと、、、、、。 分からん！！・゜・(つД｀)・゜・ 動かん！！！・゜・(つД｀)・゜・ そこで、パソコンに向かって誉めてみた！！ しかし、パソコンは、無情にも何も表示せず。。。 そこで、パソコンを撫で撫でしてみた！！！ やはり、何も起きなかった。。。 ま、当然か。。(〃_ _)σ∥ そこで！素晴らしき知恵者の皆様のお力を拝借したいｯｯｯ‼ 先ずは、A17～A26までの数字をC4まで移動させる。 （写真の左側） 次に降順に並べかえる。（写真の右側） これらを列AMY1まで行いたいのです。 何卒、良き解決策を、お願い致しますm(._.)m
A2にコードを入力するとC2にSheet2のC列から数式で文字が現れます。 その自動で現れた文字に対し、マクロを実行させたいのですが出来ますでしょうか？ C2には以下の数式が入ってます =VLOOKUP(A2,Sheet2,3,FALSE) 今、設定しているマクロは Private Sub Worksheet_Change_1(ByVal Target As Range) If Target.Address = "$C$2" Then If Target.Value = "A" Then ' 前の奴を開いていたら閉じる Call WindowsMediaPlayer1.Close ' "movie.wmv"っていう名前のファイルを再生する FilePath = ThisWorkbook.Path & "\" & "testA.wmv" ' ファイル名を設定する WindowsMediaPlayer1.URL = FilePath ' 再生を開始する Call WindowsMediaPlayer1.Controls.Play ElseIf Target.Value = "B" Then ' 前の奴を開いていたら閉じる Call WindowsMediaPlayer1.Close ' "movie.wmv"っていう名前のファイルを再生する FilePath = ThisWorkbook.Path & "\" & "testB.wmv" ' ファイル名を設定する WindowsMediaPlayer1.URL = FilePath ' 再生を開始する Call WindowsMediaPlayer1.Controls.Play End If End If End Sub こんな感じです。 宜しくお願いします。
いつもお世話になります。 Sheet1に条件付き書式のセルがあるかどうかをマクロで調べる方法を探してます。 Sub　test3() If Sheet1 = SpecialCells(xlCellTypeAllFormatConditions) Then MsgBox "条件付き書式です" Else MsgBox "条件付き書式ではありません" End If End Sub 上記のどうしようもないコードをどなたか修正できる方いましたら　お力添え下さい。
Excslのデータを分割したいです。 以下のように、A列が66666であるタイトル行とそのデータが、1つのブックに連続して入力されているファイルがあります。 ｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰ 66666 0101 10 5101 0 6 51021906 2 2 200 1385 1010 51021912 2 2 200 1385 1010 ・・・ 66666 0102 37 5102 0 6 51031806 2 2 57 1583 1002 51031812 2 2 60 1594 1002 51031818 2 2 64 1604 1000 ・・・ 66666 0103 36 5103 0 6 51041500 2 2 80 1515 1002 51041506 2 2 83 1503 1002 ・・・ ｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰ 行数は70000行あります。 これを、タイトル行で区切って、新たなブックを作成したいです。 その際、新たなブックの名前もつけたいです。 つまり、以下のように新たなブックを作成したいです。 ｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰ ブック名：0101 ファイルの中身： 51021906 2 2 200 1385 1010 51021912 2 2 200 1385 1010 ・・・ ｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰ ブック名：0102 ファイルの中身： 51031806 2 2 57 1583 1002 51031812 2 2 60 1594 1002 51031818 2 2 64 1604 1000 ・・・ ｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰ ブック名：0103 ファイルの中身： 51041500 2 2 80 1515 1002 51041506 2 2 83 1503 1002 ・・・ ｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰｰ 各ブックの行数は異なります。 よろしくお願い致します。
VB.NET (.NET Framework 4.5)にて、ファイルのZIP圧縮をしたいと 思い、.NET4.5から追加になったZipArchiveクラスを利用しようと 考えています。MSDNやらその他解説サイトなどを見てみると、 フォルダ内にあるファイルをフォルダごと圧縮する方法ばかり書いて あるのですが、フォルダにある特定の１ファイルだけをそのフォルダ内 に圧縮したいと思っています（圧縮のパスはファイルのみでディレクトリは含まない） ZipArchiveクラスでは、こういった圧縮は出来ないのでしょうか？ もし出来るのであれば、やり方をご教授ください。
VBAのユーザーフォームのラベルに関して質問です。 下記のようなことをする良い方法を教えていただけますでしょうか？ 現状ではCaption部分でエラーが発生します。 Sub test2() Dim i As Long Dim Word() As Variant For i = 1 To 20 ReDim Preserve Word(i) Word(i) = "UserForm2.Label" & i With Word(i) .Caption = "Sample" & i .Font.Name = "ＭＳ Ｐゴシック" .Font.Size = 11 End With Next UserForm2.Show vbModeless End Sub 情報が少ないかもしれませんがご教示よろしくお願いいたします。
A列　　　　B列　　　　C列 りんご　　りんご　 みかん　　みかん　 もも　　　もも　 バナナ　 ライチ　　 という表があるとします。 C列にA列とB列で重複しないデータ（バナナとライチ）を関数などで簡単に表示させる方法はありますか？ つまりA列にデータを貼り付けたら、毎回自動的にC列に重複しないデータが抽出されるようなフォーマットを作りたいです。 毎月同じ形式の売上表を各支店ごとに２０個程作っているのですが、 毎回A列とB列を別シートに一列に並べて条件付き書式で重複データを色付け→重複しないセルをフィルターで抽出→抽出したデータをC列に貼付け、という作業を何回も繰り返し膨大な時間がかかっています・・。 ちなみにExcelを仕事で使い始めて４か月、マクロとかVBA？は使ったことがありません。 一から勉強するには時間がかかりそうなので、今月からすぐにでも使えそうな方法を探しています。 よろしくお願いします。
かなり古い環境なのですが、Visual Basic 2008 にて勉強を始めた初心者です。ネットの記事を参考にしながら勉強しているのですが、データベースのデータをTextBoxに入力された値で検索であいまい検索して表示させる方法が分りません。似たような記事があったのですが環境が違う為か上手く出来ませんでした。 Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load Me.在庫表TableAdapter.Fill(Me.Database4DataSet1.在庫表) Form1は上記のようになっております。 ここからは、Visual Basic 中学校 のサイトのコピペです。LIKE前の品名と書き換えただけです。 Private Sub TextBox1_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox1.TextChanged Dim Table As DataTable = DirectCast(DataGridView1.DataSource, DataTable) Dim View As DataView = Table.DefaultView View.RowFilter = "品名 LIKE '" & TextBox1.Text & "%'" End Sub エラー：型 'System.Windows.Forms.BindingSource' のオブジェクトを型 'System.Data.DataTable' にキャストできません。 何となく入れ替えたりしてみましたが、上手く出来ませんでした。 テーブルはＩＤ、品番、品名、在庫数です Form1にはDataGridViewとTextBoxとButtonのみの配置のシンプルなものを考えております。 品名をあいまい検索したいです。 クエリビルダの品名フィルタ欄に何かを入れるのは理解したのですが、上手く出来ません どなたか手直ししていただけませんでしょうか？ また、今後自分の為になるようにわかりやすい参考本等、紹介していただけませんでしょうか？ まずはＳＱＬ等きちんと理解してからやらなくてはいけないのでしょうが、サンプルをいじりつつ、本で構造を理解して行ければいいななどと考えております。 繰り返し同じようなものを作ってみて、徐々にレベルアップしてゆきたいです。 なぜ、2008なのかと言うと、実はプログラムに挑戦しようと思いVisual Studioを奮発して購入したのですが、勉強する時間が足りずに放置しておりました。最近時間が出来たので、きちんと勉強したいと思い再挑戦を始めました。初歩過ぎて馬鹿にされるかも知れませんが、どうか助けて下さい。
いつもお世話になります。 マクロのコードの中で計算式を入れて、その結果をA1セルに というのはできますか？ 具体的には B1セルの5月2日の日付が入ってます。それを翌月の2日の形でA1に表示させたいです。 過去質見てません。お時間ある方いらっしゃいましたらよろしくお願いします。
Excel2010 VBAを使って グラフシートのグラフのサイズを変更したいのですが With ActiveChart.ChartArea .Width = 400 End With のコマンドで変更できることが分かりました。 しかし、これを実行すると 図形はロックされていますと表示され、変更することができません。 検索して調べてみると http://oshiete.goo.ne.jp/qa/8875055.html 同じような質問が見つかりましたが 解決策は分かりませんでした。 更に調べると .ProtectDrawingObjects = False を変えると良いような情報が得られましたが 既にFalseになっており、 また、この値は変更することもできないようです。 一体どうすれば良いでしょうか？
以前、以下の質問をして、いただいた回答からあとは自分で勉強しながら使っていこうと思っていたのですが、行き詰ってしまったので教えていただけますか？ https://oshiete.goo.ne.jp/qa/9139476.html ① Macで使えない。 同じ作業をするものにMacユーザーがいたため、CreateObjectが使えません。 Macで代替となるようなもの、若しくは外部アプリケーションを使わずに行える方法はあるのでしょうか。 ② すべてのシートでマクロが動いてしまう。 マクロを実行するとアクティブなシートだけでなく、すべての「A」が付くシートのデータを対応するシートに出力してくれます。 シートは1日1シート使い、31日分あります。 さらに1シート内でも複数の計算をするようにしたいため、計算終了までに1分強かかってしまいます。 こちらはその時間待てばいいのですが、参照にする「A」が付くシートの指定をActiveSheetにすればいいのではと思い、いろいろやってみたのですが、結局うまく動きませんでした。 なにかいい方法を教えていただけますでしょうか。 素人の質問で申し訳ありませんが、よろしくお願いします。 下に以前の質問の抜粋を載せます。 ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー 「VBAでシート名に対応したシートへ自動入力したい。」 質問抜粋 やりたいことは、例えば一つのブックにシート名が1~10までとA1~A10まであるとします。 シートA○のセルA1とセルA2に数字を入力したら、シート○のA1にシートA○のセルA1とセルA2の合計が自動入力されるようにするには、どのようなコードを書けばよいのでしょうか。 更に、できれば参照元であるシートA○を削除してもシート○に自動入力されたデータが消えないようにならないかと考えています。 回答でいただいたコード Sub foo() Dim dic As Object Dim ws As Worksheet Dim name As String Set dic = CreateObject("Scripting.Dictionary") With ActiveWorkbook ' A無しシートの存在チェック For Each ws In .Worksheets If Left(ws.name, 1) <> "A" Then dic(ws.name) = True End If Next ' 計算＆記入 For Each ws In .Worksheets If Left(ws.name, 1) = "A" Then name = Mid(ws.name, 2) If Not dic.Exists(name) Then MsgBox name & "シートがありません", vbExclamation Else .Worksheets(name).Range("A1").Value _ = ws.Range("A1").Value + ws.Range("A2").Value End If End If Next End With Set dic = Nothing End Sub ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー
Excel VBAでは大きな配列を生成しようとすると メモリ不足でエラーが出るため、 どの程度のサイズまで作れるか試してみました。 Dim aaa() as Single ReDim aaa(xxxxx) というようにして定義しています。 Singleの配列を一つの場合には、 132813299 が上限であることが分かりました。 Singleの配列を2つの場合には、 132813299 130009804 が上限となりました。 Singleの配列を3つの場合には、 132813299 130009804 9 が上限となりました。 なぜか3つめは9より大きな配列を作ることができません。 それで配列サイズを小さくして試してみたところ 60000000 60000000 60000000 60000000 60000000 32000000 のようにして、3つの場合の合計よりも 大きなメモリを確保することができました。 つまり、合計のサイズに上限が決められているわけでもなく 配列一つ一つのサイズに上限が決められているわけでもないということが分かりました。 一体どういう法則でメモリサイズの上限が決定しているのでしょうか？
素人です。お願いします。 交代制勤務のシフト表（A列　シフト名、Ｂ列　始業時間、Ｃ列　終業時間）から、Ｂ列の時間を検索してその時間のシフト名を調べるマクロを作りたいのですが、上手くいきません。 A列のシフト名の検索は出来たのですが、時間の検索だとエラーがでてよくわかりません。 ちなみにシフト名の検索はこんな感じでうまくいきました。 userformを使いtextboxに検索したいシフトを入力し、該当があればそのセルを選択するようにしました。これを時間（Ｂ列）の検索に変えたいのですが、上手くいかないです。 With ActiveWorkbook.Worksheets("シフトコード") .Range("A1") = TextBox1.Text End With Dim Rng As Range For Each Rng In Range("A4:A1500") If Rng.Value = Range("a1") Then Rng.Activate Exit Sub End If Next MsgBox "該当なし" どうすれば時間を検索できるか教えて下さい。 宜しくお願いします。
Kootsuki4と申します。 ADODBの本質を理解しないでネットからコピペして使っているものです。 ADODBでCSVファイルを読み込むのですが読み込むレコード件数を制限したいと思っております。 もしかしてレコードセットの MaxRecords プロパティをセットしておけばいいのかな？と 考え、以下のコードにしてみました。 ところが、RECSET.MaxRecords = 10　の行で、「エラー　’3705’　オブジェクトが開いている場合は 操作は許可されません」のエラーになります。 どのように書くのがいいのでしょうか？ また、CSVファイルの読み込むレコード件数を制限したいとき、MaxRecords プロパティの操作でできるものでしょうか？できないときは方法をお教えいただけますと有り難いです。 dim ADODB As New ADODB.Connection dim RECSET As New ADODB.Recordset dim SQLSTR As String ADODB.Open SQLSTR = "SELECT * FROM csvファイル名" RECSET.MaxRecords = 10 Set RECSET = ADODB.Execute(SQLSTR) 以上
タイトルがわかりにくくてすみません。 やりたいことは、例えば一つのブックにシート名が1~10までとA1~A10まであるとします。 シートA○のセルA1とセルA2に数字を入力したら、シート○のA1にシートA○のセルA1とセルA2の合計が自動入力されるようにするには、どのようなコードを書けばよいのでしょうか。 更に、できれば参照元であるシートA○を削除してもシート○に自動入力されたデータが消えないようにならないかと考えています。 今まではVBAを使わずに、CELL関数のfilenameからシート名を調べてINDIRECT関数で対応するシートのセルを参照するという方法を使ってきましたが、関数が長くなるうえに、参照元のシートを削除してしまうとエラーになってデータが消えてしまいます。 今回、報告には大まかなデータを入力するフォームで提出するが、こちらで詳細なデータをとっておきたいという状況が生まれたため、詳細なデータをシートA○に入力したら、大まかなデータがシート○に自動入力され、報告時にシートA1~A10を削除してそのまま報告できるようなフォームができないかと考え調べ始めました。 しかしVBAはコピペでしか使ったことが無く、自力で調べるにも適切な検索ワードを選択する能力すらありません。 出来る限り自力で調べようと思ったのですが、初心者の状態でやりたいことだけをピックアップして学ぶのは相当難しいと痛感して終わりました。もしかしたら「こんなことわざわざ聞くんじゃねーよ」と思われる様な内容かもしれませんが、是非教えてください。
VB.netでのWindowsアプリケーション開発をしています。 String文字列の連結においてOutofMemory.Exceptionのエラーがスローされます。 手法としてはSingleの数値をカンマで区切り、1000個のカンマ区切り文字列を作成します。 その文字列は「temp_Str as String」の変数に格納していくのですが、 大型のループ処理で10万件以上作成されたところで上記のエラーが発生します。 （時間にして2～3時間程度経過した時点） 少なくとも数100万件の処理を行いたいのですが、 うまくメモリー管理をする方法はないでしょうか？ 今現在GC.CollectやRemove等の処理は入れているのですが、あまり効果がありません。 よろしくお願いいたします。
osはwindows7です。ユーザーはアプリを閉じる時、右上の”×”をクリックします。場合による、”終了してもよろしいですか？”みたい確認画面が出るアプリありますし、出ないアプリもあります。 質問：出ないアプリは”終了してもよろしいですか？”という確認画面が出てほしいです。windows7の設定とか、プログラミングとか、なんか方法がありますか？
こんばんは。EXCELVBAで教えてください（ＶＢＡ初心者です）EXCEL2010です。 （やりたいこと） データから日付、氏名、開始時間（最小値）、終了時間（最大値）を書き出す。 （元データ）列Ａ１からＤ１　行3000行程度 日付 氏名 開始時間 終了時間 2月1日 Ａ 8:00 12:00 2月1日 Ａ 12:00 15:00 2月1日 A 15:00 16:00 2月1日 A 16:00 17:00 2月1日 Ｂ 9:00 11:00 2月1日 Ｂ 11:00 16:00 2月2日 Ａ 7:00 9:00 2月2日 Ａ 9:00 14:00 2月2日 B 10:00 16:00 2月2日 B 16:00 17:00 2月2日 B 17:00 20:00 2月2日 B 20:00 21:00 2月3日 A 1:00 2:00 2月3日 A 3:00 4:00 2月3日 A 4:00 5:00 2月3日 A 5:00 6:00 2月3日 B 10:00 11:00 2月3日 B 11:00 13:00 2月3日 B 14:00 15:00 2月3日 B 15:00 16:00 2月3日 B 16:00 21:00 2月3日 B 21:00 22:00 （求める結果）終了時間の最大値が取れません。 列Ｉ１～Ｌ１に書き出し 日付 氏名 開始時間 終了時間 2015/2/1 Ａ 8:00 2015/2/1 A 15:00 2015/2/1 Ｂ 9:00 2015/2/2 Ａ 7:00 2015/2/2 B 10:00 2015/2/3 A 1:00 2015/2/3 B 10:00 検索して探してきたコード Sub test() Dim myDic As Object, myKey, myItem Dim myVal, myVal2, myVal3 Dim i As Long Range("E1", Range("H" & Rows.Count).End(xlUp)).ClearContents Range("I1:L1").Value = Range("A1:D1").Value Set myDic = CreateObject("Scripting.Dictionary") myVal = Range("A2", Range("A" & Rows.Count).End(xlUp)).Resize(, 4).Value For i = 1 To UBound(myVal, 1) myVal2 = myVal(i, 1) & "_" & myVal(i, 2) If Not myVal2 = "_" Then If Not myDic.exists(myVal2) Then myDic.Add myVal2, myVal(i, 3) Else myDic(myVal2) = myDic(myVal2) End If End If Next myKey = myDic.keys myItem = myDic.items For i = 0 To UBound(myKey) myVal3 = Split(myKey(i), "_") Cells(i + 2, 9).Value = myVal3(0) Cells(i + 2, 10).Value = myVal3(1) Cells(i + 2, 11).Value = myItem(i) Cells(i + 2, 12).Value = myItem(i) Next Set myDic = Nothing End Sub 最大値を書き出すところがまったくわかりません。（myitem(i)が違うことはわかります） Cells(i + 2, 12).Value = myItem(i) ご教示よろしくお願い致します。（説明が下手でスミマセン）
vb6です。 文字データをコード変換して送信したいのですが、 送信関数は既にあり、いじれません。こいつは送信データをstringで受け取ります。しかし不思議なことに送信データサイズの指定もあります。多分stringをchar配列のようなイメージで使っているんだと思います。 文字コード変換処理は変換前データをstringで受け取ります。 コード変換はSJISをEBCDIC派生の独自コードに変換するので 一旦byte配列に落として1バイトずつ表に従って変換します。 変換したら送信関数に渡したいのですがなにせstringでしか受け取ってくれません。 中身の解釈をせずmemcpy的なことをしたいと調べたらダイレクトキャストという方法を 見つけたのですがよくわかりません。 誰か教えてもらえませんでしょうか？
http://www.projectgroup.info/tips/Windows/comm_0 … このページにあるように リンク先を %windir%\explorer.exe ..\..\aaa\bbb\ のようにすることで 相対パスのショートカットフォルダーを作成することができます。 これをVBAでやりたいのですが うまくいきません。 VBAでのショートカットの作成方法は https://www.moug.net/tech/acvba/0020025.html ここに書かれてあります。 .TargetPath = "%windir%\explorer.exe ..\..\aaa\bbb\" とやると出力結果の最初と最後に"が自動で付加されてしまい、 "%windir%\explorer.exe ..\..\aaa\bbb\" ショートカットとして機能しません。 .TargetPath = "%windir%\explorer.exe"" ""..\..\aaa\bbb\" とやってみても""で%windirのところを囲むと %windir%が機能しないのでショートカットが機能しません。 .TargetPath = "C:\Windows\explorer.exe"" ""..\..\aaa\bbb\" とやると C:\Windows\aaa\bbb のようになってしまい、うまくいきません。 .RelativePathというのが使えそうな気がしたのですが ここを変えてもうまくいきませんでした。 どうすれば良いでしょうか？ .TargetPath = "%windir%\explorer.exe" でショートカットを作成した後に バイナリを直接改変するしかないでしょうか？
エクセルファイルの中で、あるセル（シート１のＨ列限定がベター）の文字列が、もし「合計２箱」という文字列だった場合、その「合計２箱」というフォントを赤色に変更したい、と思っています。 （合計２箱はＩＦ関数による返数です） このような場合、ＶＢＡコードはどう組めばいいでしょうか？ よろしくお願いします。
各店舗の日々の売上を一つのブック（シート）に集約するVBAを作ったのですが、 全店集約するのにすごく時間がかかります（エクセルが途中でフリーズします） 集約する元の表が1月1日～始まっているため、いまだと約1年分のデータが毎日更新される からだと思うのですが。。 12月18日だったら、前日（12/17）の売上のみ集約できればよいのですが、マクロで（PCに設定されている日付の前日の売上のみ集約する）という設定はありますか？ 宜しくお願いいたします。
こんにちは。 VBAの記述方法についてご質問です。 ご教示のほどよろしくお願いいたします。 ◆やりたいこと 指定したURL(1000ページほどあります）にアクセスし、htmlソース内にちらばっている”スキー場名”を抽出しエクセルに値を返すVBAを記述したいです。 ※スキー場名が記述されているタグはページごとに不規則なことが難点です。 ◆やりたいことイメージ 画像内に記載しているURL http://meito.knt.co.jp/detail.aspx?&crsno=1042176 http://meito.knt.co.jp/detail.aspx?&crsno=1061740 http://meito.knt.co.jp/detail.aspx?&crsno=1059072
２つのEXCELファイルがあります。 ・TEST1.xlsx ・TEST2.xlsx これらのEXCELファイルのセルの値を比較し合致した場合、 TEST2.xlsxの値をTEST1.xlsxの値に設定しています。 ただし行数が多いせいか処理に時間がかかってしまいます。 配列で保持し、最後に一気に張り付ける方法も考えたんですが、 貼り付けるTEST1.xlsxのフォーマットに癖があるため難しい状況です。 良い方法があればご教示お願い致します。 For i = 1 To 5000 For j = 1 To 10000 If Workbooks("TEST1.xlsx").WorkSheets("Sheet1").Range("A" & i).Value = Workbooks("TEST2.xlsx").WorkSheets("Sheet1").Range("A" & j) Then Workbooks("TEST1.xlsx").WorkSheets("Sheet1").Range("A" & i).Value = Workbooks("TEST2.xlsx").WorkSheets("Sheet1").Range("A" & j).Value Exit For End If Next Next
EXCEL2013を使用しています。 VBAで文字の置換方法についてご教授願います。 C列に商品名があります。 商品名は ﾊﾞﾅﾅ ｼﾞｭｰｽ 5本入、ﾊﾞﾅﾅ ｼﾞｭｰｽ 10本入、ﾊﾞﾅﾅ ﾊﾟｲ 箱入・・・ ﾒﾛﾝ ｼﾞｭｰｽ 5本入、ﾒﾛﾝ ｼﾞｭｰｽ 10本入・・・ ﾘﾝｺﾞ ｼﾞｭｰｽ 5本入、ﾘﾝｺﾞ ｼﾞｭｰｽ 10本入・・・ ﾄﾏﾄ ｼﾞｭｰｽ 5本入、ﾄﾏﾄ ｼﾞｭｰｽ 10本入・・・ 等があります。 ﾊﾞﾅﾅ ｼﾞｭｰｽ 5本入等、ﾊﾞﾅﾅの付くものはバナナに変換 ﾒﾛﾝ ｼﾞｭｰｽ 5本入等、ﾒﾛﾝが付くものはメロンに変換 ﾘﾝｺﾞ ｼﾞｭｰｽ 5本入等、ﾘﾝｺﾞが付くものは林檎に変換 ﾄﾏﾄ ｼﾞｭｰｽ 5本入等、ﾄﾏﾄが付くものはトマトに変換するVBAコードを教えて下さい。 宜しくお願いします。
Excelを使って計算時間の長いプログラムを走らせている時に IEなどの別のウインドウを開いて作業するということがよくあります。 例えば、計算のプロセスが100あったとして、 ユーザーフォーム上に 1/100、2/100、・・・100/100 と計算が進む毎にカウントを進めていくというプログラムを書くことはできるのですが IEなどの別のウインドウを最大表示で開いていると 隠れて見えなくなってしまいます。 それでタスクバー上に上記のような文字列を表示したいのですが どうすれば良いでしょうか？ あるいは常に最前面表示の小さなウインドウを モニターの端に表示させてカウントを表示するにはどうしたら良いですか？ あと、プログラムが終了した際に タスクバー上のExcelが点滅するようなアクションを起こしたいのですが 可能でしょうか？ よろしくお願いいたします。
VBA初心者です。 下記のようなことがしたいのですが分からないことばかりなのでお力をお貸しください。 ①ダイアログボックスにてAとBとCの３つのエクセルワークシートを開く 　因みにAのファイルのシート名は"部品表"BとCのファイルのシート名は毎回違います ②AのファイルにてVLOOKUP検索を実行 検索値・・・H列 、範囲・・・先程開いたBのファイルのF12:H300 、列番号・・・3 、検索の型・・・0 AのファイルのM列２２行～M列６９５行にてこれを実行（検索値もH列22行～H列695行） ③VLOOKUPにて#VALUE!になった行だけCのファイルとVLOOKUP検索実行 検索値・・・H列 、範囲・・・先程開いたCのファイルのB7:F100 、列番号・・・5 、検索の型・・・0 ④終了 尚、Cのファイルだけいくつもシートを持っているので対象となるシートを選択できるようにしたいです。 説明が下手で分かりにくいかと思いますが宜しくお願い致します。
VBAでテキストと数字が一緒に入力されたセルの数字だけを読み込みたいのですが、何か方法はありますでしょうか？ わかる方いらしたらお願いいたします。
”現状”のように、「保第××」セルが3個、「高尾××」セルが2個、「山梨××」セルが1個。 一発処理で”以下の表がほしい”のようにしたいですが、分かる方のご指導をよろしくお願いします。
皆さん、こんにちは SQL Serverからの抽出プログラムをExcelで作りこんで実行しているのですが、Excel 2013へアップグレードしてから1回目は問題なく実行できるのですが2回目は必ずエラーが発生します。 何方か下記のどの文がExcel 2013で使用できなくなったかアドバイスしていただけませんでしょうか？ちなみにExcel 2010では何度で実行しても問題は発生しません。 With ActiveSheet.ListObjects.Add(SourceType:=0, Source:="ODBC;DSN=SQL_Server;Database=DATABASE;UID=xxxx;PWD=xxxxx" _ , Destination:=Range("$A$1")).QueryTable .CommandText = (wSQLquery) .RowNumbers = False .FillAdjacentFormulas = False .PreserveFormatting = True .RefreshOnFileOpen = False .BackgroundQuery = False .RefreshStyle = xlInsertDeleteCells .SavePassword = False .SaveData = True .AdjustColumnWidth = True .RefreshPeriod = 0 .PreserveColumnInfo = True .ListObject.DisplayName = "Extract_Data" .Refresh BackgroundQuery:=False End With よろしくお願いします。
こんばんは 以下は、HTAアプリケーションのbody部にマウスカーソルを乗せると、テキスト上の選択してある文字列をクリップボードに送り、そのデータをテキストボックス内に送ることを意図したスクリプトです。 しかし、テキストを選択した状態でonmouseoverイベントを発生させても１回目はNull、２回目は選択した文字列がテキストボックスにセットされ、これが交互に繰り返されます。 当方のWindows7でも、仕事先のXPの環境でも同様の現象が発生します。 Nullがランダムに発生するのであれば、コピーが失敗しているのだなと分かるのですが、規則的に交互に繰り返される理由がわかりません。 どなたか、原因と解決法をご存知のかたがいらっしゃいましたら、教えていただきたいです。 （※7でClipコマンドが使えるのは知っております） --------------------sample.hta---------------------- <html> <head> <script type="text/vbscript"> Sub window_onload resizeTo 200,200 End Sub Sub Sample Set sh = CreateObject("Wscript.Shell") sh.sendkeys "^c" Clp = ClipboardData.GetData("text") text1.value = Clp Set sh = Nothing ClipboardData.ClearData End sub </script> </head> <body onmouseover="Sample"> <input type="text" id="text1"> </body> <html>
Windows10(64bit) & Excel2013(64bit)です。 以前Windows7(32bit) & Excel2013(32bit)ではFormが常に手前に表示されていましたがWindows10に変更してから、Formが隠れてしまいます。 Netでもいろいろ調べましたが原因がわかりません。何卒ご教示願えればと投稿させていただきました。 よろしくお願いします。 ソースは次の通りです。Formにはコマンドボタンを１つ配置しただけの単純なFormです。 ’UserForm1 #If VBA7 And Win64 Then Private Declare PtrSafe Function FindWindow Lib "user32.dll" _ Alias "FindWindowA" _ (ByVal lpClassName As String, _ ByVal lpWindowName As String) As Long Private Declare PtrSafe Function SetWindowPos Lib "user32" _ (ByVal hwnd As Long, _ ByVal hWndInsertAfter As Long, _ ByVal x As Long, ByVal y As Long, _ ByVal cx As Long, ByVal cy As Long, _ ByVal wFlags As Long) As Long #Else Private Declare Function FindWindow Lib "user32.dll" _ Alias "FindWindowA" _ (ByVal lpClassName As String, _ ByVal lpWindowName As String) As Long Private Declare Function SetWindowPos Lib "user32" _ (ByVal hwnd As Long, _ ByVal hWndInsertAfter As Long, _ ByVal x As Long, ByVal y As Long, _ ByVal cx As Long, ByVal cy As Long, _ ByVal wFlags As Long) As Long #End If Private Const HWND_TOPMOST As Long = -1 Private Const SWP_NOSIZE As Long = &H1& Private Const SWP_NOMOVE As Long = &H2& Private URL As String Private IE As Object Private OBJ As Object Private Sub UserForm_Activate() Dim hwnd As Long hwnd = FindWindow(vbNullString, Me.Caption) Call SetWindowPos(hwnd, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOMOVE Or SWP_NOSIZE) End Sub Private Sub CommandButton1_Click() URL = "http://maps.google.co.jp/maps?hl=ja&dirflg=d&sad … _ & EncodeURL("大阪府大阪市北区中之島１丁目3-20 ") _ & "&daddr=" & EncodeURL("東京都新宿区西新宿2-8-11") Set IE = CreateObject("InternetExplorer.Application") With IE .Navigate (URL) .Toolbar = False .Visible = True .Top = 0 .Left = 0 .Width = 1920 .Height = 1080 Do While .Busy = True DoEvents Loop Do While .document.readyState <> "complete" DoEvents Loop End With End Sub ' ##### URL ｴﾝｺｰﾄﾞ Private Function EncodeURL(ByVal sWord As String) As String Dim D As Object Dim elm As Object sWord = Replace(sWord, "\", "\\") sWord = Replace(sWord, "'", "\'") Set D = CreateObject("htmlfile") Set elm = D.createElement("span") elm.setAttribute "id", "result" D.appendChild elm D.parentWindow.execScript "document.getElementById('result').innerText = encodeURIComponent('" & sWord & "');", "JScript" EncodeURL = elm.innerText End Function
お世話になります。 vb.netにて、コントロール類のイベントが完全に終了した直後に、特定の処理を行う方法を探しています。例えば、フォーム上のButton1のEnterイベント（下記コード）が完全に終了した直後に、ある特定の処理ができればと思います。 'Button1を張り付けたフォーム Private Sub Button1_Enter(sender As Object, e As EventArgs) Handles Button1.Enter 　 '(Enterイベントの処理) End Sub サイト上にて、Buttonを継承させたButtonExクラスを作成し、Enterイベントが終了してから自作のEnteredイベントを発生するボタンを利用する方法を見つけました（下記コード）。しかし、この方法でも私が望む動作に至らなかったので、ButtonExクラス内のOnEnterイベントが終了してから特定の処理ができればと思います。 'Enterイベント終了後にEnteredイベントを発生させるButtonExクラス Public Class ButtonEx 　Inherits Button 　Public Event Entered(sender As Object, e As EventArgs) 　Protected Overrides Sub OnEnter(e As EventArgs) 　　MyBase.OnClick(e) 'ここでButtonExのEnterイベントが発生する。 　　RaiseEvent Entered(Me, e) 'ここでButtonExのEnteredイベントが発生する。 　End Sub End Class 'ButtonExを張り付けたフォーム Private Sub ButtonEx1_Entered(sender As Object, e As EventArgs) Handles ButtonEx1.Entered 　'(ButtonEx1のEnterイベント終了直後に行いたい処理) End Sub １つ思いついたのが、タイマーコントロールを利用する方法です（下記コード）。 'Button1、Timer1を張り付けたフォーム Private Sub Button1_Enter(sender As Object, e As EventArgs) Handles Button1.Enter 　'(Enterイベントの処理) 　Timer1.Interval=1 　Timer1.Enabled = True 'このとき以外は、Timer1.Enabled = False にする。 End Sub Private Sub Timer1_Tick(sender As Object, e As EventArgs) Handles Timer1.Tick 　Timer1.Enabled = False 　'(Button1のEnterイベント終了直後に行いたい処理) End Sub Enterイベントで例を記載しましたが、他のイベント（Validatedイベント等）でも同様のことができる方法を探しています。Timerのイベントを用いた方法よりも良い方法がありましたら、ご教示下さい。 宜しくお願い致します。
VBA Excelに関するしつもんです。 ddd = "23:53" のような文字列変数があり、 これをハイフンで分割してLong型の配列に格納したいのですが 一度、 eee = Split(ddd,":") としてから dim fff() as long redim fff(ubound(eee) for i = 1 to ubound(eee) fff(i) = eee(i) next i のようにして、別で用意した配列に格納しなおす必要がありますか？ 直接Split関数でLong配列に入れる方法があれば教えてください。
UNICODEに主をPC（MacBookAir）で使いたいのですが、どの様に操作するかご存じでしょうか。 入れたいのは❶や❷のような黒丸数字で１０〜２０を入れたい。unicode自身は分かりましたが、PCに取り込む方法を教えて下さい。
タイトルでは何をどうしたいのかわかりにくいと思うので、私がしたいことを以下に書きます。 ------------------------------- Dim A as String A = "ThisWorkbook.path" * Debug.print A ------------------------------- このコードを実行したときに、このブックの保存場所を示すPATHを表示したいです。 このようなことが可能なのか不可能なのか、もしできるのであればどのようなコードを書けばよいのか教えてください。よろしくお願いします。
ACCESS2010を利用しています。 Private Sub Form_Open(Cancel As Integer) Me.[あいう].Visible = False End Sub 上記コード使っています。 このときは、 あいう　【あいうの入力フォーム】⇒　これが全部見えなくなるとおもうのですが、 実行すると、 あいう　⇒　入力フォームだけ消えて、あいうが見えているのです。 これの原因はなんてしょうか？ Visibleって利用回数の制限とかあるのでしょうか？ Me.[あいう].Visible = False以外にも利用してます。
もともと添付されている画像は何もせず、図の挿入で追加した画像のみ、pngからjpg形式に変換。また、リサイズしてExcelに貼り付けたいです。 もともと貼ってある図まで切り取りされ、jpgに変換されてしまうのですが、どこを変更したらよいでしょうか？ Sub resize() Application.Dialogs.Item(xlDialogInsertPicture).Show With Selection .ShapeRange.LockAspectRatio = msoFalse .ShapeRange.Height = 100 .ShapeRange.Width = 300 Dim sp As Shape Dim l As Double Dim t As Double For Each sp In ActiveSheet.Shapes If sp.Type = msoPicture Then l = sp.Left t = sp.Top sp.Select Selection.Cut ActiveSheet.PasteSpecial Format:="図 (JPEG)", Link:=False, DisplayAsIcon:=False With ActiveSheet.Shapes(ActiveSheet.Shapes.Count) .Left = l .Top = t End With End If Next End With End Sub
Windows7 SP1、 IE11です。 以下のVBスクリプトで、①を消して②を書いたときは動くのですが、 ②を消して、①を書いたときはエラーになります。 http://syanai.co.jp/は、社内イントラのサイトです。 エラーは、Visibleをアクセスした行に対して、 「そのインターフェイスは認識されません。コード:800706B5」 Set objIE = CreateObject("InternetExplorer.Application") ①objIE.Navigate2 "http://syanai.co.jp/" ②objIE.Navigate2 "http://www.yahoo.co.jp/" WScript.Sleep 5000 objIE.Visible = True 社内イントラのサイトに対して、Visibleを使いたいのですが、 何かうまい手はないでしょうか？
VBAを学習中の初心者です。 学習の一環として素数を求めるプログラムを作成しているのですが苦戦しています。 過去質問に同じようなものが見当たらなかったので質問させて頂きます。 指定した数までの素数だけをDebug.Printで出力するプログラムを組みたいです。 引数を素数か否か判定し返すFunctionとその結果を出力するかしないか決めるプログラムは組めたのですが、素数だけを選んで出力するというプログラムがどうしても分からず苦戦しています。 今組んでいるプログラムでは、引数が素数じゃなかった場合何も出力せず、素数だった場合その数までの全ての数字(引数が7だったら2,3,4,5,6)が出力されてしまうという状態です。 ここから素数だけを出力できるようにするにはどうコードを書いたらいいのでしょうか？ できれば解答ではなく、ヒントを教えて頂けるととても嬉しいです。 宜しくお願いします。
VBAでpng画像に文字列を描画したいのですが 検索して調べるとVB.netを使った方法が書かれたページはいくつか見つかりました。 http://logicalerror.seesaa.net/article/152199150 … http://hanatyan.sakura.ne.jp/patio/read.cgi?no=284 https://msdn.microsoft.com/ja-jp/library/aa984365(v=vs.71).aspx しかしこれらをVBAにコピーしてもそのまま使うことができません。 どなたかVBAで使える方法を教えていただけないでしょうか？ よろしくお願いいたします。
VBAで引数をありでもなしでもできるようにするために optionalというものがあります 例えば sub aaa(bbb, optional ccc) という使い方がされます。 sub aaa(bbb, optional ccc()) のようにして配列を引数として渡そうとするとエラーが発生してしまいます。 http://officetanaka.net/excel/vba/statement/Func … このページによれば ParmArrayを付けると、配列でも省略可能なものとして指定できるそうなのですが functionではうまくいくのですが subでやるとやはりエラーが出てしまいます。 VBAの仕様ではsubで配列を省略可能として使うことはできないのでしょうか？
excelvbaで業務処理をしています。1年以上使ってきたvbaが急に使えなくなり調べてみると、for~next内にあるApplication.WorksheetFunction.VLookupが処理できず、なぜかエラーもなく強制的にループを抜けてしまいます。パソコンを変えても治りません。何が考えらるるでしょうか？
Sub TestB(ByVal MyArray() As Integer) のようにして、 配列引数をByValで渡そうとすると エラーが出てしまいます。 http://vba.doorblog.jp/archives/51291826.html このページにあるように variantとして渡せば エラーは出ないのですが byrefとして扱われてしまいます。 なぜVBAでは配列を値渡しすることができないのでしょうか？ 何が問題なのでしょうか？
シート１に顧客情報があって、シート２に請求書があるとします。 シート２のA1に、１～１０を入力して、vlookup関数で、顧客名や請求金額を表示させるようにしています。（ＶＢＡ詳しくないので、とりあえず自分のできる範囲でこのようにしています。） sub 印刷 () dim a as integer dim b as integer b=sheets(1).range("c2").end(xldown).row　（←これが10として） for a = 1 to b sheets(2).range("a1")=a sheets(2).printout next a end sub これで一応印刷はできるんですが、順番がバラバラになります。これを１から１０まで順番どおりに印刷するにはどのようにしたらよいのでしょうか。ご教授お願いいたします。
VBAを使って、 10MByteのバイナリファイルがあり、 これの1MByte～1.1MByteの領域のデータを書き換えたいとします。 いままでは Open ファイル名 For Binary As #ファイル番号 でデータを書き換えていたのですが http://officetanaka.net/excel/vba/file/file08.htm Random、ランダムアクセスモードというものもあることに気がつきました。 RandomとBinaryモードの違いについて教えてください。 名前から判断すると Randomモードはファイルの途中からでも読み書きができるのに対し Binaryモードは最初からしか読み書きができないので ファイルの途中のデータを書き換えたい場合には Randomモードの方が高速のような気がするのですが 本当にそうなのでしょうか？ 散々調べてみたのですが 違いおよび使い分け方が分からなかったので教えてください。
一度、singleで定義した変数をLongなどほかの型に変更したいのですが これはできないのでしょうか？ Dim aaa As Single aaa = 2.4 Dim aaa As Long でやってもうまくいきませんでした。 ReDim aaa As Long は配列しか使えないようです。 Variant型を使うしかないのでしょうか？
お世話になります Inputboxで指定したファイル名の一部を、指定したフォルダの中から検索し、部分一致したPDFファイルをAdobeReaderで開くという操作を行いたいのです。 自分でスクリプトを記載したのですが、アドビが開かれた時に「この文書を開くときにエラーが発生しました。ファイル名、ディレクトリ名、またはボリュームラベルの構文が間違っています。」というエラーが発生してしまいます。 以下のどこを修正したら良いのでしょうか？教えていただければ幸いです。 C:\Test　フォルダにpdfファイルが入っているものとします Set fso = CreateObject("Scripting.FilesystemObject") Set sh = CreateObject("Wscript.Shell") Set sha = CreateObject("Shell.Application") FileName = Inputbox("ファイル名を入力してください") Dim fi Set fi = sha.NameSpace("C:\Test").Items() For i = 0 to fi.Count-1 'ファイル名の一部にInputboxで入力した文字の一部が含まれていれば、そのPDFファイルを開く IF (Instr(fi.Item(i),FileName)>=1) and (FileName<>"") then sh.run "AcroRD32.exe ""C:\Test\"" & fi.Item(i)" Exit For End IF Next Set fso = Nothing Set sh = Nothing Set sha = Nothing
Windows7/InternetExplorerでは、VBScriptにより下記ソースでHTMLソースを取得できました。 firefoxではどのようにすればHTMLソースが取得できるのかご教示頂けないでしょうか。 特に困っているのは、ソース内の①、②の箇所で、 ①では、firefoxのURLが取得できずにfalseにしかならず、 ②では、「iexplore.exe」→「firefox.exe」に変更してもfalseにしかなりませんでした。 For文の条件であるobjShell.Windows()ではfirefoxのブラウザ情報を保持していないのかと推測しています 【IE の場合に取得できるソース】 Dim objShell Dim objIE Set objShell = WScript.CreateObject("Shell.Application") For Each objIE In objShell.Windows() If InStr(objIE.LocationURL,"http://localhost:XXXX/Sample.do") > 0 Then ・・① If InStr(LCase(objIE.FullName),"iexplore.exe") Then　　 　　　 ・・② Dim strBody strBody = objIE.Document.all(0).outerHTML Dim objADO Set objADO = CreateObject("ADODB.Stream") objADO.type = 2 objADO.charset = "UTF-8" objADO.open objADO.WriteText strBody,1 objADO.SaveToFile "test.txt",2 objADO.Close Set objADO = Nothing End If End If Next Set objShell = Nothing 先日類似の質問をしており、 私の質問内容が悪かった為、再度検討した内容を載せさせて頂きました。 ご回答のほど宜しくお願いします。
Windows7/firefoxにおいて、VBScriptによりHTMLソースを取得しようとしています。 他の質問を参考にしたところ、IEでは下記のソースによって取得できるようですが、 firefoxではどのようにすれば良いのでしょうか。 【IE の場合に取得できるソース】 Dim objIE Dim strBody Set objIE = CreateObject("InternetExplorer.Application") objIE.Navigate "http://www.XXXXX.co.jp/" Do Until objIE.Busy = False WScript.sleep(250) Loop' strBody = objIE.Document.all(0).outerHtml WScript.echo strBody
Visual Basic6.0を使用しています。 String型の値をLong型へ変換したいのですがどうやればよろしいでしょうか？ ①→②のように変換したいです。 s は String型変数 l は Long型変数 ① s = "aaa"　　'aaaは任意の値 ② l[0]=0x6161 l[1]=0x0061
VBAで D:\test\test.exe が起動中か調べたいのですが どのようにすれば良いですか？ http://www.vbalab.net/vbaqa/data/access/log/tree … このページの方法を使えば、 exe以外のファイルが使用中かは調べることができたのですが exeファイルの場合にはうまくいきません。 良い方法があれば教えてください。
VBAです、 長い動画のエンコード後に 自動でPCがシャットダウンするようにしたいのですが その前にシャットダウンするかどうかのメッセージボックスを出したいと考えています。 Dim rc As Integer Dim WSH As Object Set WSH = CreateObject("WScript.Shell") rc = WSH.Popup("シャットダウンしますか？(3分後に自動実行)", 180, "自動シャットダウン", vbOKCancel) Set WSH = Nothing If rc = vbOK Or rc = -1 Then '1 vbOK 2 vbCancel -1 自動停止した場合 Call Shell("shutdown -s -t 3", vbHide) '3秒後に自動シャットダウン Application.Quit ThisWorkbook.Close SaveChanges:=False End If プログラムの終了後にこのコードを実行するとメッセージボックスが表示され、 3分間キャンセルボタンが押されないと自動でシャットダウンします。 上記のコードだけ実行してみると うまくいくのですが、 長い動画のエンコード後にやってみると まだ二回しか試していませんが、 rc = WSH.Popupのところで止まって先に進みません。 動画のエンコーダーは正常に終了させていますし、 そもそも何か他のプログラムが実行されていたとしても rc = WSH.Popupが自動で閉じるという動作には影響を与えないはずです。 ちなみに、エンコーダーを短時間起動していた場合には この現象が起きないので 長時間PCを起動したままであることが原因でしょうか？ 対策とかあれば教えてください。
UserFormにWebBrowserとCommandButtonがあります。 Private Sub UserForm_Initialize() Me.WebBrowser.Navigate("URL") End Sub この後、現在表示されているページのHTMLをコピーして、 Sheet1のA1に貼り付けという動作を、手動では 右クリック→ソースを表示→コピー→セル選択→貼り付け で行っています。 CommandButtonを用いて、 この一連の動作を行うことは出来ないでしょうか。 また、少ししかソースを読むことができないので、 今は全てを選択しています。 コードをご教示願います！
すみません、質問です。 同じエクセルシート内での操作で、 1つのセルを選択したら、同じ列の別のセルの背景色が変わるようにしたいのですが、selectionを使ってどうやって組んだらよいのか分かりません。 例えば、 セルG1を選択したら、セルA1の背景が水色に変わる。 セルH1を選択したら、セルB1の背景が水色に変わる。 といったものを作りたいです。 セル同士の間隔は常に一定です。 説明が不十分であれば質問受け付けております。 回答お願い致します。
バイナリエディタのように機械語を編集できるようなソフトが使いたいのですが、windowsOSではそのようなソフトはプリセットで入っていないのでしょうか？
はじめて質問させて頂きます。 エクセル2013にて、100シートのものを、それぞれのシート名（B2でも構わない）で別ブックにコピーし、名前をつけて保存する作業をしています。 現在のVBAでは途中でエラーが起きてしまい、かつ出来ればブックは閉じたいとと思っています。 Sub sheetmove() Dim i As Integer For i = Worksheets.Count To 2 Step -1 Worksheets(i).Move ActiveWorkbook.SaveAs ThisWorkbook.Path & "\" _ & ActiveSheet.Range("B2") & ".xls" ThisWorkbook.Activate Next i End Sub 前任者の残したマクロでこれ以上触ってしまうと手に負えなくなると思います。 お詳しい方いらっしゃいましたらご教授いただけましたら幸いです。。 どうぞよろしくお願い致します。
VBAでお知らせアラームを作成したいのですが、添付画像のように分と秒の部分に値を入力し、スタートを押すとカウントダウンが始まり、０になるとアラーム音がなり下の「時間になりました!!」とメッセージを出し、リセットでアラームとメッセージを消すようなプログラムは作成できますか？
図１のような形式のシートが複数シートあります。 行いたいことは、図２のような表を作ることです。 全シートから、図１でいうB列の値だけをコピーし、 新しいブックの１つのシートに"値の貼り付け"をしていきたいです。 二回目以降の貼り付け時には、 コピーしたセルの１つ下のセルから張り付けたいです。 その際、図１の上部にあるシートタイトルやヘッダの部分も、 図２のように分けて表示させたいです。 その他にも、シート名や日付も表示させたいと考えています。 なお、対象ブックのあるパスをセルに入力して 「抽出」等のコマンドボタンをクリックしたら そのパスを読み込んで抽出処理を行うようにしたいです。 VBAを勉強し始めたばかりでなかなか完成できず困り果てています。 コマンドボタンの配置方法や、クリック時に動作する方法は分かります。 が、セルに入力されたパスを読み込むことに手こずっています。 今まで調べてきたなかで、getPathやgetDirなどを使うんだろうなというイメージですが 動くものを作ることができません。 複数シートが対象なので、for文でシートの終わりまでループを回すことは 想像がつくのですが、実際にコードが書けません。 「こういう考え方で出来る」などでもかまいませんので 何かアドバイスをいただけませんでしょうか。 以上、よろしくお願い致します。
いつも大変お世話になります。 リストボックスから都道府県を選択するようにしてあります。都道府県はSheet1のA1:A47に北から順に書いており、それをリストボックスに表示させているとします。この状態でユーザーフォームを開くと、A1の北海道がデフォルトの状態なので、これをA14の東京都をデフォルトの状態にしてリストボックスを表示させるってのはできるのでしょうか？ もしご存知の方、いらっしゃいましたらご教示お願い致します。
VBAでWebページをMHTMLファイルで保存して、Chromeで表示がしたいです。 VBAでWebページをMHTMLで保存するマクロは下記の通りで保存ができました。 --------------------------- Public Sub GetUrlPerfectWeb(ByVal downLoadURL As String, ByVal outFileName As String) Const cdoSuppressNone As Long = 0 Const adSaveCreateOverWrite As Long = 2 Dim msg As Object ' // CDO.Message Dim stm As Object ' // ADODB.Stream Set msg = CreateObject("CDO.Message") msg.CreateMHTMLBody downLoadURL, cdoSuppressNone, "", "" Set stm = msg.GetStream stm.SaveToFile outFileName, adSaveCreateOverWrite stm.Close Set stm = Nothing Set msg = Nothing End Sub --------------------------- 上記で保存したファイルをIE9だと表示できるのですが、Chromeだとファイルの中身？の文字列がそのまま表示されてしまい、テキストエディタで開いた様な状態になってしまいます。VBAで保存したMHTMLファイルをChromeで表示できるようにするにはどうしたらよいでしょうか？ Chromeが悪いのか、VBAが悪いのか分からない状況ですが、こちらに投稿させていただきます。 なお、ChromeはデフォでMHTMLファイルは表示できないので、以下を参考にMHTMLを有効化しています。 http://qiita.com/takoratta/items/aa943b35ce5a439 … また、ChromeでCtr+SからMhtml形式で保存したファイルはChromeでもIEでも表示できます。 -- エクセル2013 Chrome バージョン 46.0.2490.86 m IE 9.0.8...
現在Web用の掲示板の作成に当たり、プログラミング言語の種類を何にしようか模索中です。 　掲示板用のプログラミンングとはいえ、年単位でのプログラミング言語の習得になるので、 　苦労して覚えた言語がISPのWebサーバに対応できなかったばあいは苦労が水の泡となって しまいます。 　自宅サーバはクラッカーに乗っ取られ、悪さをされた場合は自己責任になる可能性がありま 　すのでISPと決めています！ 　　掲示板用プログラミング言語の候補に挙げております２種類は以下です。 第1候補 Visual Studioを使い Visual Basic で掲示板が作れますか？ 　もし、作成可能で、完成した、ファイルをnifty等のISPにアップロードした場合 　特殊なソフトをインストールすることなくそのまま動作するのでしょうか！？ 第2候補 ＰＨＰですが、（経験済みですが、まだ掲示板を作成できるスキルはありません！） 　操作確認で自宅サーバでアパッチを介してWeb 上に公開する場合、 　xamppをインストールしてからでないと動かかないので、掲示板のプログラムのファイルを 　いきなりISPのWebサーバにアップしても、はたして動くのかが疑問です。 以上ですが、掲示板を作成に当たり、ビジョンにあったプログラミング言語はどちらがよろし いのでしょう！？ 　掲示板を作成して、自分のWEBサイトが人気が出てきて、バナーがついて1円でも稼ぐことが 目標です。 　よろしくお願いいたします。
win8 64bit Excel2010 32bit VBA を使用して、MediaInfo_DLLを使いたいのですが うまくいきません。 MediaInfo_DLLの本体はここでDLすることができます。 http://mediaarea.net/us/MediaInfo/Download/Windows VBA用のファイルはここでDLすることができます。 http://sourceforge.net/p/mediainfo/discussion/29 … http://sourceforge.net/p/mediainfo/code/HEAD/tre … DLLファイルはうまく読み込めているのですが 「ファイルが見つかりません」と表示されて動画ファイルを読み込むことができません。 動画ファイルは D:\text.3gp のようにスペースや全角文字などが含まれないようにしているにも拘わらず 読み込むことができません。 ブレークポイントを使って 変数にパスが読み込まれているかどうか確認も行いましたが問題ありませんでした。 一体どうすれば良いでしょうか？
Excelで多項式近似( a3・x^3 + a2・x^2 + a1・x + b)の係数を求める数式 a3 = INDEX(LINEST(TRANSPOSE(E3:I3),TRANSPOSE(E2:I2)^{3,2,1}),1,3) を、VBAでプログラミングするときの記述の仕方について教えて頂けませんか？ このとき、アドレス範囲(E3:I3)は、(Cells(i,j), Cells(k,l))のように変数化できるのでしょうか？ 以上です。よろしくお願い致します。
VBAに関する質問です。 あるフォルダーに指定したファイルが生成されたら別のsubを実行するプログラムを作りたいのですが Web上で調べて以下のコードを書いてみました。 Sub WatchNewFile(filepath As String) If Dir(filepath_last) = "" Then Application.OnTime Now + TimeValue("00:00:01"), "'WatchNewFile ""filepath""'" 　End If End Sub Sub test() Dim filepath As String filepath = "D:\test\test.txt" Call WatchNewFile(filepath) Beep End Sub 実際にはBeepのところにsubを書くのですが とりあえず正常に動作するか確認するためにBeepを入れています。 これのtestプログラムを実行すると、 D:\test\test.txtが存在しなくても 速攻でBeepが鳴ってしまいます。 しかしVBEを開いて、WatchNewFile内のコードのどこかに ブレークポイントを置いてみると そこでプログラムが止まるので、プログラムは終了していないことが分かります。 つまり、なぜかファイルを検索するためのループからは抜けていないのに ループの後のコードが実行されていることになります。 通常、Sub内にForで無限ループを書いた場合、 ループを抜けない限りそのSubの後のコードは実行されないはずなのですが なぜこのようなことが起きるのでしょうか？ そしてSubを同期実行するためにはどうしたら良いですか？
Excel VBAを使ってIEなどのプログラムのクライアント領域の ウインドウのサイズを指定・変更したいと考えています。 http://www.excel-vba.net/excel-api-020.html このページのコードを使ってサイズの取得だけはできるようになりました。 次に設定を行いたいのですが http://home.att.ne.jp/zeta/gen/excel/c04p58.htm このページにあるように Dim window1 As Window Set window1 = Windows("Google - Internet Explorer") 'アプリケーションウィンドウを対象 window1.WindowState = xlNormal '通常表示に設定します。 window1.Width = 800 'ウィンドウ幅を800に設定 window1.Height = 300 'ウィンドウの高さを300に設定 とやってみましたが インデックスが有効範囲にありません というエラーが出てしまいます。 どうすれば良いでしょうか？ あと気になっているのですが 幅及び高さの単位はポイントです。(ピクセルでは無いので注意して下さい)。 と書かれてありますが、 ピクセルからポイントへはどのように換算すれば良いのでしょうか？
VisualStudio2010でVBのコンソールアプリケーションを作成しました。 内容は Mainの中でConsole.WriteLine("Hello World") だけのプログラムです。 VisualStudioからデバッグ実行すると、当然Hello Worldと表示されます。 しかし、ビルドしてProjectフォルダ内のReleaseフォルダにあるExeファイルを DOSプロンプトから実行すると、何も表示されず、プログラムも終了しません。 (DebugフォルダのExeも同様です） 何かExeファイルの作成方法に誤りがあるのでしょうか？ ビルドはVisualStudioの「ビルド」メニューの「○○○のビルド」をクリック しただけです。エラーは出ていません。 Windowsは8.1です。
vbaで文字列でインスタンスを生成することは出来ますか？ CreateObjectやVBScriptなど色々試しましたが上手く行きませんでした。
こんばんは VBS・・に限ったことじゃないかもしれませんが、プログラミングにおける、条件分岐（IF、Select文）についての正しい知識を教えて頂きたいです。 IF文、Select文の処理がどのように行われているかについてです。 ①上から順番に条件式の判定が行われ、合致した後は最後までスキップされる？ ②上から順番に条件式の判定行われ、合致した後も１行ずつ進んでいく？ ③全体の条件式を判定した後、合致するものまで戻り処理を行い、最終行までスキップされる？ ④その他 また、変数を条件式に指定し、処理内容で変数を別の値や文字に変えた場合、途中の変数の状態はどのようになっているのでしょうか？ すなわち、極端な例で書きますが 0001：Dim i 0002：i = 0 0003：IF i = 0 then 　　 ←条件に合致するので処理後、iは1となりますが、その後は 0004：i = i + 1　　　 　　　行9999に飛ぶのでしょうか、それとも行４から順に下へと進んで　　　　　　　　　　　　　　　　いくのでしょうか 0005：ElseIF i = 1 then　←行４により、iは1となっているが、ここの式の判定は行われない？ 0006：i = i + 1　　　　　　それとも、iは元の値0して判定が行われている？ 0007：ElseIF i = 2 then ・ ・ 9999：End IF　 よろしくお願いします。
http://oshiete.goo.ne.jp/qa/8769403.html 上記参照URLと同じ現象が発生しています。エラー発生場所もLine, 大容量CSVを開く際に発生します。 ①改行コードがLFの場合に発生するとありますが、確認方法はどうすればいいのでしょうか？ ②対策はあるのでしょうか？
vbscriptで時計を作りたいのですが、 msgboxで1秒ごとに更新させて行くにはどうすればいいですか？
既に作成してあるワークシート上のコマンドボタンをVBAで移動させたいのですが http://www.happy2-island.com/excelsmile/smile03/ … 上記URLを参考にして以下のコードを作成してみました。 Sub sAdd_OLEObject() Dim objOLE As OLEObject '画面更新を一時的にOFF Application.ScreenUpdating = False 'コントロールを追加する Set objOLE = Worksheets("data").OLEObjects("Forms.CommandButton.1") objOLE.Object.Left = 10 '横位置を設定 objOLE.Object.Top = 20 '縦位置を設定 '画面更新をONに戻す Application.ScreenUpdating = True End Sub しかし、 WorksheetクラスのOLEObjectsのプロパティを取得できません。 というエラーが出て実行することができません。 そもそも、作成していあるコントロールのコマンドボタンの名称が "Forms.CommandButton.1" で正しいのかどうか分からないのですが どうすれば名称を確認することができますか？ 右クリックメニューなどでは確認することができないのですが どうすれば良いでしょうか？
お世話になります。 下記は、実行ボタン押下前（①）と押下後（②）のフォームのイメージ図になります。 動作としては、［テキストボックス１］に検索ワードを入力し、【実行ボタン】を押すと、マスターファイルから検索ワードが含まれる行を抽出して、配列に格納していき、得られた要素を現在表示しているページにテキストボックスを作成し表示、さらに結果の隣にボタンを表示したいのですが、 スクリプトからテキストボックスやボタンなどのフォームの生成をするにはどうすればよいのでしょうか？ 予め、テキストボックスやボタンを用意しておき、そこへ結果を代入していくというやり方ならできるのですが、フォームを新たに作成し、そこへ結果を入力していくというやり方がわからないのです。 VBScriptでもjavascriptでも構いませんので、よろしくお願いします。 ①実行ボタン押下前の状態 ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ ［テキストボックス１］ 【実行ボタン】【クリアボタン】【終了ボタン】 ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ ↓ ②実行ボタン押下後の状態 ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ ［テキストボックス１］ 【実行ボタン】【クリアボタン】【終了ボタン】 ［テキストボックス２（要素１の内容）］【ボタン１】 ［テキストボックス３（要素２の内容）］【ボタン２】 ・ ・ ・ ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
Excel VBAに関してですが 通常、ファイルからファイルにモジュールをコピーしたい場合 https://support.office.com/ja-jp/article/%E3%83% … プロジェクト エクスプローラー上で モジュールをドラッグして別のブック上でドロップすればできますが モジュールが多すぎて画面に収まりきれていない場合にはどうしたら良いですか？ ドラッグした状態で画面の端までもっていって 自動でスクロールしてくれないため、 ・4k等の最大解像度の大きなモニターでコピーを行う ・一度bas形式で出力してから、そのファイルをD&Dする ・コードを全選択後にコピーして、新規作成したモジュールにペーストする ・コードをコピーするプログラムを使う という方法しかないと思うのですがもっと良い方法があれば教えてください。
http://okwave.jp/qa/q4890392.html MsgBox関数は半角で最大1024文字しか扱うことができないようです。 これ以上の文字数を扱いたいのですが 恐らくWindows APIを使えばできるのではないかと考えました。 APIを使った方法は http://www.ne.jp/asahi/hishidama/home/tech/excel … http://soudan1.biglobe.ne.jp/qa6488258.html この辺りに書かれてあります。 それで Declare Function MessageBoxPtr Lib "user32.dll" Alias "MessageBoxA" (ByVal hwnd As Long, ByVal text As Long, ByVal caption As Long, ByVal nType As Integer) As Integer Sub aaa() Dim text() As Byte Dim caption() As Byte Dim ret As Integer caption() = StrConv("dd7優勝a", vbFromUnicode) text() = StrConv("b日本aaa", vbFromUnicode) ret = MessageBoxPtr(0, VarPtr(text(0)), VarPtr(caption(0)), vbOKOnly) End Sub を実行してみたのですが なぜか全角文字と半角文字を両方含んでいると 文字化けしてしまいます。 しかもなぜか実行するたびにその文字化けが変化していきます。 例えば以下のようです。 b日本aaawPAｾ b日本aaaﾕ君・ 優勝{aaaﾕ君・ b日本aaa蛹N・ VarPtrがメモリのアドレスを取得する関数なそうなのですが これがリセットされていないことが原因なのでしょうか？ 一体どうすれば正常に取得できるか教えていただけないでしょうか？ ちなみに環境はWin8 Excel2010です。 よろしくお願いいたします。
VBAのLog関数に関して質問です。 http://stabucky.com/wp/archives/3083 数値の桁数を求めるために dd = Int(Log(ses) / Log(10) )+1 という計算を行いたいのですが 計算速度を上げるために、Log10を予め計算しておくことで 2倍の高速化ができることを確認しました。 dd = Log(ses) / 2.30258509299405 しかし、一見同じ結果を返すかと思ったのですがきりの良い数値を使うと 異なる結果が返ってきてしまいます。 【Int(Log(100) / 2.30258509299405 )+1】 2 【Int(Log(100) / log(10) )+1】 3 これはなぜなのでしょうか？ 予め計算してあるlog(10)を使って計算するにはどうしたら良いですか？
Excel VBAを使っていて ListviewなどのMSCOMCTL.OCXに依存した コントロールを使っている場合 MSCOMCTL.OCXに上位互換性がないため、 VBAを含むxlsmファイルを作成したPCとは異なるPCで そのプログラムを使用するためには 使うPCごとにMSCOMCTL.OCXをアップデートする必要があります。 http://detail.chiebukuro.yahoo.co.jp/qa/question … 詳細はこのページに書かれてあります。 疑問は、いま、自分が使っているMSCOMCTL.OCXのバージョンが2012年のものなのですが Windows10にアップグレードするなどした場合に MSCOMCTL.OCXをアップグレードする必要がありますが VBAは正常に動作するのでしょうか？ MSCOMCTL.OCXには下位互換性があるのでしょうか？ もし動作しないとして、 一つずつListviewを削除して新規作成するという作業を行う必要があるのでしょうか？ 自動更新できる方法があれば教えてください。
以下のようなマクロを教えていただけないでしょうか？ A |B|C|D|E|F|G| 1|　| | | | | | | 2| | | |da| |○| | 3| | | |rat| |○| | 4| | | | | |○| | 5| | |Ps| | |○| | 6| | |P8|ss| |○| | 7| | | |hi| | | | 上記のようなエクセルが各シートがあった場合 A1に文字列入力後(例***：11-23930) マクロ実行後に以下のような各シートになるようにしたいと考えています。 A |B|C|D|E|F|G| 1|***| | | | | | | 2| | | |da|***-da|○| | 3| | | |rat|***-rat|○| | 4| | | | |***-rat-1|○| | 5| | |Ps| |***-Ps|○| | 6| | |P8|ss|***-P8|○| | 7| | | |hi| | | | 仕様について １：F列に○がある行に限ります。 ２：E列にA1で入力した文字列(数字含む)を頭に入れます。 ３：C列の頭文字でPが無ければD列の文字列をE列の文字列後に-(ハイフン)に続けて入れます。 ４：3の際にD列に文字列が無かった場合は一行上の文字列を入れ続けて-1と入れます。 ５：4が連続する場合は-2、-3、-4・・・とします。 ６：C列の頭文字でPが有った場合はE列の文字列後に-(ハイフン)に続けて入れます。 ７：C列に頭文字Pが有り、D列にも文字列が有った場合は６を実行します。 ８：ブックに存在するすべてのシートに実行します。 ９：上書き保存します。 以上 完全に頼ってしまって、申し訳ありませんが VBAコードを作成いただき、教えていただきたく。 不明な点が有れば、問い合わせ下さい。
こんにちは。 windows7でexcel2010を使用しています。 マクロの記録を切り貼りして、コードを作成し使用しているのですが、いつも正常に動作するマクロが固まるケースがあります。 固まった場合は、下記の Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ 　 :=False, Transpose:=False の部分がいつも黄色く表示されます。 固まってしまいexcelが保存できず、パソコンの再起動をするしかないケースがあり、困っております。 お知恵をお借りできないでしょうか？ 宜しくお願い致します。 Sub ①用() ' ' ①用 Macro ' ' Range("A:A,B:B,C:C,E:E,I:I,J:J,L:L").Select Range("L1").Activate Selection.Delete Shift:=xlToLeft Columns("E:E").Select Selection.Cut Columns("B:B").Select Selection.Insert Shift:=xlToRight Columns("E:E").Select Selection.Cut Columns("D:D").Select Selection.Insert Shift:=xlToRight Range("A1:AZ60").Select Selection.Copy Sheets("①").Select ActiveWindow.SmallScroll Down:=-48 Range("A6").Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False ActiveWindow.SmallScroll Down:=6 Range("E45").Select Application.CutCopyMode = False Selection.FormulaR1C1 = "合計" Selection.Characters(1, 2).PhoneticCharacters = "ゴウケイ" Range("F45").Select ActiveCell.FormulaR1C1 = "=SUM(R[-37]C:R[-1]C)" Range("F45").Select Selection.AutoFill Destination:=Range("F45:AA45"), Type:=xlFillDefault Range("F45:AA45").Select ActiveWindow.SmallScroll Down:=-27 ' ' ①用デリート Macro ' ' Range("A5:AD5").Select Selection.ClearContents End Sub
早速ですが、加重移動平均を求めたいのですが =SUMPRODUCT(OFFSET(E6,0,0,-$J$4,1),OFFSET(I6,0,0,$J$4,1))/SUM(OFFSET(I6,0,0,$J$4,1)) 式として成り立ってます。Ｅ列が基本データ　$J$4は　集める期間　20項とか I列が　連番です。連番を利用すれば事足りるのですが、オリジナルはシートが大きくなり、連番の列を増やしたくない、で、連番の代わりに　ROW()が代わりに使えないか？　という質問です ＮＧですが SUMPRODUCT(OFFSET(E5,0,0,-$J$4,1),OFFSET(row(),0,0,$J$4,1))/SUM(OFFSET(row(),0,0,$J$4,1)) こんな感じで使えれば・・・ お手数ですが
表をフィルターで絞った時隠れた所はカウントしないようにユーザー定義関数をつくりました。 表はこのような感じです。 A列　B列　C列 1　　○　　× 2　　○　　× 3　　□　　× 4　　□　　△ 5　　○　　△ 6　　○　　× 表現したい関数はB列が○の時C列が×の回数、この場合だと3になります。 このように表現したいのですが上手くいきません。 作った標準モジュールは Public Function subtotal_countifs(rgSelect As Range, moji As String) 　　Dim rg As Range 'セル 　　Dim cot As Long 'カウンタ 　　For Each rg In rgSelect 　　　　If Rows(rg.Row).Hidden = False Then '表示されている行だけ対象にする 　　　　　　If rg = moji Then 　　　　　　　　cot = cot + 1 　　　　　　End If 　　　　End If 　　Next 　　subtotal_countifs = cot これだと上記のような表現したい関数ではなく、 B列の○の回数といったカウントしません。 どなたか詳しい方、教えてください。
ランダムで数字を割り当ててるのですが、数字が重複してしまいます。 Option Explicit Dim sekigae As Integer Private Sub Command1_Click() Randomize Dim i As Integer For i = 1 To 36 sekigae = Int(Rnd * 36 + 1) Label4(i - 1).Caption = sekigae Next i End Sub Private Sub Command2_Click() End End Sub このプログラムでは重複してしまいます。 まだ初心者なのでよくわからないところもあるのでよろしくお願いします。
現在、以下のような操作のマクロを作成しています。が、行き詰まってしまったので教えてください。 ↓ マクロと同じフォルダの中には、.xlsx形式のファイルが多数あります。 ファイルの名前は、AAA管理表、BBB管理表のように一部一致しております。シートはいくつかありますが、その中で操作したいのはリストというシートです。 また別のフォルダには、リスト2015.xlsxというファイルがあります。b列には、『○○○管理表』の○○○の部分が入っています。 マクロを実行すると、 このリスト2015.xlsxを開き、フィルタで順番に○○○を検索し、フィルタの検索条件と管理表の○○○.xlsxが一致したときにそのブックを開き、リストというシートへ内容をコピーしたいです。 教えていただきたいのが、 リスト2015.xlsxの検索条件と、『○○○管理表』の○○○が一致したらそのブックを開く、という処理です。 よろしくお願いします。
下はエクセルファイルの印刷ためのコントロールボタンに組んであるコードです。 ---------------------- Sub ボタン6338_Click() Dim k As Integer For k = 1 To 3 'Sheet1から3までループ Worksheets(k).Select 'シートを選択 Select Case k '何枚目のシートかによって処理を変える Case 1 'Sheet1 の時 ActiveSheet.PrintOut '印刷 Case 2 'Sheet2の時 ActiveSheet.PrintOut from:=1, To:=2 '１頁から２頁を印刷 Case 3 'sheet3の時 　 End Select Next k End Sub --------------------- このコードの中に更に「シート３は、セルG10が日曜日になっている時は、印刷しない」、としたいのですが、どのようにすればよいでしょうか？
複数ファイルをffmpegで変換するために VBAのRunで実行しているのですが コマンドプロンプトが実行されるたびにウインドウが最前面に出てくるため 他の作業の邪魔になります。 http://www.happy2-island.com/vbs/cafe02/capter00 … このページによれば 第二引数を4にすることでウインドウは表示されるが最前面にならないようにできるそうです。 Set objWShell = CreateObject("WScript.Shell") objWShell.Run "%windir%\system32\calc.exe", 4, False それでこれを実行してみたのですが やはりウインドウが最前面に表示されます。 1～8まで試したのですが 6や7を使うとウインドウが最小化して表示されますが 所望している操作と異なります。 どうすれば最前面に出さずにRunを実行できますか？
大変勉強になり、皆様にはいつもお世話になります。 Private Sub Workbook_SheetChange(ByVal Sh As Object, _ ByVal Source As Range) If ActiveSheet.Name = "目次" Or ActiveSheet.Name = "印刷用" Or ActiveSheet.Name = "集計" Then Exit Sub If Range("O15") = 0 Then ActiveSheet.Name = Range("AJ19") & "おわり" MsgBox "おわり", 64 Else ActiveSheet.Name = Range("AJ19") End If End Sub O15には、計算式が入っています。その計算式の結果が０になるとシートの名前の後ろに「おわり」と付け加えるようにしたのですが、このコードですと　O15が０になったあとも、例えば他のセルが何らか変更があった場合には　毎回動作してしまい煩わしいです。 何かいい方法があれば　教えていただきたいです。 宜しくお願い致します。
Access2007のswitchboardのフォームでlabel1とlabel2のコントロールの 表題をvbaで変更したいが、その方法が分からない。 方法としては、オブジェクトを上から下に順番に取得してからの話ですが 上手く行きません。下記は上手く行かない途中経過の物です。 Function SetValue() Dim obj As AccessObject Dim dbs As Object Dim ctl As Object Set dbs = Application.CurrentProject Set obj = dbs.AllForms("switchboard") Set ctl = obj.Controls("label1") End Function set obj=...の所迄は動いていますが、それ以降が動きません。 ここから先は、controlを取得してからそのプロパティに値をセットするだけですが。 上手く行きません。vbaは分かっていませんので、教えて下さい。 宜しくお願いします。
http://www.officepro.jp/excelvba/array/index6.html このページにある方法で まとめて配列にinteger型の数値を格納したいと考えています。 この方法だとvariantで配列を定義する必要があるので とりあえず配列に格納してから redim preserveでinteger型に変更したいのですが そのままだと型変更することができません。 http://officetanaka.net/excel/vba/statement/ReDi … このページにあるように後から配列を型変更するためには バリアント型変数を配列として使用する必要があるそうなので Dim myData As Variant にarray関数で配列の格納を行いましたがうまくいきませんでした。 どうすれば良いでしょうか？
https://www.moug.net/tech/exvba/0150033.html http://officetanaka.net/excel/vba/statement/Call … VBAですが、 これらのページに subやfunctionの呼び出し時のcallを省略できると書かれてあります。 二つ質問なのですが call無しでsubを呼び出した際に 引数が二つ以上あると呼び出せないように思うのですが これは仕様でしょうか？ functionの呼び出しは通常 abc = myFunction(123) のようにして得られた結果を変数に格納するような形で使われますが Call myFunction(123) や myFunction 123 のような形で使ってもエラーが出ません このような形で使う場合 どのような用途で用いられるのでしょうか？
あるCSVのファイルがあり、そこのA19セル目のROWから番号が振ってあります。そこのRowの番号をUserForm1で選択し、OKボタンを押したら、そこの欄だけコピーペーストをあるシートに実行したいのですが、戸惑っています。　欄はここではROWからJudgeまでコピペが実行できればいいです。 。例えば、Userform1に「2」と数値を入力したら、A22,A23からI22とI23までコピーして、ペーストできればいいのです。また、この欄は右へ増えることがあります。 なにとぞよろしくお願いします。
ワークシートが７つほどあるエクセルワークブックがあります。 ブック全体を印刷する日と、全て印刷ではない日があります。 全体印刷は、コントロールボタンにマクロをリンクさせてワンクリックで出来ました。 問題は全て印刷しない日です。 印刷しないのは、「Ａのワークシート全ページ」、そして「Ｂのシートの３ページ目」・「Ｄのシートの５ページ目です。 これをマクロで記憶させていくには、Ａ以外のシートをシート毎に印刷していき、ＢやＤについては印刷範囲の再設定をしないといけません。 ＶＢＡでプラグラミングできるでしょうか？
こんばんは やりたいことは、「選択した行のデータをクリップボードへ送る操作を自動で行なう」というプログラムを作りたいのですが、クリップボードに送る際に問題がありまして、それが解決可能かどうかの相談です。 まず、環境は会社のPCで、個人情報を扱うためネット非接続（接続は許可されていない）、OSはWindowsXP、IE6かIE7、ソフトウェアはOffice含めてインストール不可（OSを入れただけの状態） 個人情報の管理は外部が開発している独自のソフトウェアを利用しており、その中の情報の一部をクリップボードへ送りプログラムで判定したいのです。 ソフトウェアの内容は企業秘密とのことで、詳しい構成は言えないのですが、添付図のような構成です 。 人の名前をダブルクリックすると更に詳しい情報が別ウインドで開きます。また人の名前の行でCtrl+Cをすると、その行のデータ（名前、住所～）がクリップボードへ送られます。 クリップボードへ自動で送って欲しいのは、その行のデータです。 今、例えばBさんの行のデータが欲しいとします。また添付図の画面のタイトルを「画面１」、詳細が表示される画面のタイトルを「画面２」とします。 まず、Bさんが選択されたかどうかの判定には「画面２」が表示されたかどうかで判定をします。 （WSHのAppactivateで「画面２」がTrueとなったとき） 「画面２」が表示されたと判定できたら、一度「画面２」をSendkeyのESCキーで閉じ、「画面１」をアクティブにして、Bさんが選択された状態にし、その状態でCtrl+Cを押し、クリップボードへ情報を送ろうと考えています。 「画面２」を閉じるところまでは順調に行くのですが、その後、「画面１」をアクティブにするためにAppactivateをするとフォーカスがBさんから、一番上のAさんに移ってしまうため、Ctrl+CをSendkeyで送った結果がAさんのものになってしまうのです。 うまく伝わるかどうかわかりませんが、Aさん以外の行のデータを自動で取得するのは難しそうでしょうか？ 該当行を手動にてCtrl+Cをすればいいだけの話ですが、操作者に高齢者やコンピュータにうとい方がいますので、新しい手順を追加することなく、自動で取得できるようにしたいのです。 また、Ctrl+C以外で、その行のデータを取得する方法ないのと、「画面１」にしかその情報はありません。 アイデアがあれば教えていただきたいです。カテゴリは自分がVBS以外よくわからないので、VBとさせていただきましたが、インストールせずに使用できる言語があれば、それ以外でも大丈夫です。
エクセルファイルを右上バツ印にて閉じる時、通常「上書き保存しますか？」というメッセージが出ます。 本来、「No」を選択するべきところ、誤って「Yes」としてしまうミステイクを防ぐ為、上書き保存の再確認メッセージを出したいと思っています。 みなさんに教えてもらい、以下のようなＶＢＡを組みました。 ------------------------------------- Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean) Dim lngSave As Long lngSave = MsgBox("間違いありませんか？本当に上書き保存しますか？", vbExclamation + vbYesNo, "保存確認") If lngSave = vbYes Then: End Sub ------------------------------------- ほぼやりたいことは出来るようになっているのですが、２点、合点がいかないところがあります。 ①１回目のメッセージに対し、ＹＥＳを選択し、２回目の「本当に上書きしますか？」に対し、ＮＯとした時、ＮＯとしているにもかかわらず、保存してしまっています。 なぜでしょう？ 上のＶＢＡには、「ＮＯを選択した時、保存をキャンセルする」という式が無いように思うのですが・・・？ ②「保存しますか」メッセージが２，３回繰り返されることがあります。保存のイベント→確認メッセージ→ＹＥＳ→保存へ→確認メッセージ→ＹＥＳ・・・・・・と、このままエンドレスで続くのかと思わせる動きです。 はじめに組んだ時、終わりの行はThenの次に、ThisWorkbook.Saveとなっていました。そのせいでしょうか？ 上のようにしてからは発生してないかもしれません・・・。あやふやですみません。 アドバイスお願いします。
本当にいつもお世話になります。 下記にどうしようもないコードがあります。 Sub　test() Range("B7").End(xlDown).Select Selection.AutoFill ？？？？？ 行き詰ってしまいました。 B列には日付が入ってます。 B列を上からからデータの入っている最終セルを取得して、その日付をオートフィルで月単位で次のセルまでやりたいのですが、うまくいきません。 例）データの入っている最終セルがB12だとして、そのB12が8月3日ならオートフィルでB13セルに9月3日と表示させたいです。 宜しくお願い致します。
https://oshiete.goo.ne.jp/qa/9095392.html このページでご回答いただきました。 既に述べた通り、 新規作成したxlsmファイルにマルチページとテキストボックスを挿入すると strTxtbox = Me.MultiPage1.SelectedItem.ActiveControl.Name で正常に動きます。 しかし既存のxlsmファイルにこれを入れても動きません。 徹底的に不要なモジュールを削除してみましたが 全てのコントロールを削除しないとうまく機能しません。 それでご回答いただいたとおりソースファイルをアップしました。 http://fast-uploader.com/file/7001919551048 最初はもっとたくさんコードがあったのですが 全て削除したものです。 最後に一つだけボタンを残してあります。 これがあると上記の機能が動作しないのですが これを削除すると動作するようになります。 散々、頭を悩ましましたが原因が分かりませんでした。 一体何が原因でしょうか？
VBAで、通常は文字列はInputを使って読み込むのですが Binary形式で読み込んだらどうなるかについて調べてみました。 例えば、D:\text.txtのファイルに 123456789ABあ という内容が書き込まれているとします。 このテキストデータを以下のようにして文字列数を指定した上で読み込むと Sub Sample2() Dim buf() As String ReDim buf(0) buf(0) = Space(10) Open "D:\text.txt" For Binary As #1 Get #1, , buf(0) Close #1 End Sub 最初の10文字である 123456789Aを読み込むことができます。 一方で、文字列数を指定せずに配列に直接読み込もうとすると Sub Sample1() Dim buf() As String ReDim buf(0) Open "D:\text.txt" For Binary As #1 'Seek #1, 9 Get #1, , buf Close #1 'MsgBox buf 'ABCを返します End Sub なぜか最初の2文字をスキップして 最後の10文字である 3456789ABあ が読み込まれます。 なぜ最初の二文字が読み込めなかったのでしょうか？
VBAを使って -9223372036854775808 ～ 9223372036854775807 の数値を要素数が4のバイト型の配列に変換したいと考えています。 まず思いついたのが dim Length_buf(3) As Byte dim Text_size1 as long Length_buf(0) = Text_size1 \ 16777216 Len01 = Text_size1 - Length_buf(0) * 16777216 Length_buf(1) = Len01 \ 65536 Len02 = Len01 - Length_buf(1) * 65536 Length_buf(2) = Len02 \ 256 Length_buf(3) = Len02 - Length_buf(2) * CLng(256) のようにして普通に10進数を分解する方法です。 しかしこの方法だと正の数の時にはうまくいくのですが longの上限値を超えて負の数になった時にうまくいきません。 これはどうすれば良いでしょうか？ あともう一つがhex関数を使った方法で Len_byte01 = Hex(Text_size1) Len_byte02 = "" For I = 1 To 8 - Len(Len_byte01) Len_byte02 = Len_byte02 & "0" Next I Len_byte02 = Len_byte02 & Len_byte01 Length_buf(0) = "&H" & Mid(Len_byte02, 1, 2) Length_buf(1) = "&H" & Mid(Len_byte02, 3, 2) Length_buf(2) = "&H" & Mid(Len_byte02, 5, 2) Length_buf(3) = "&H" & Mid(Len_byte02, 7, 2) のようにすることで負の数であっても、うまくいきます。 しかし8桁の数値にするためにfor文を使っていますが もっと簡単に8桁に変換することができないでしょうか？ もっと良い方法があれば教えてください。
VBAで Dim objWSH As Object Set objWSH = CreateObject("WScript.Shell") objWSH.Run Command, 8, True というようにしてコマンドラインでプログラムを実行している途中で コマンドプロンプトのウインドウの×印をクリックして 強制終了したとします。 するとそのままVBA上で書かれたその後のプログラムは実行されてしまいますが コマンドプロンプトが正常に終了しなかった場合には その後のプログラムの一部あるいは全てをスキップするようにしたいのですが どうすれば良いでしょうか？
msoFileDialogFilePicker　を使って、選択したファイルをフォルダにコピーしたいです。 Public Sub コマンド10_Click() Dim strFiles As String Dim i As Integer With Application.FileDialog(msoFileDialogFilePicker) 'ファイルの複数選択を可能にする .AllowMultiSelect = True 'ファイルフィルタのクリア .Filters.Clear 'ファイルフィルタの追加 .Filters.Add "画像", "*.jpg; *.bmp; *.png*" '初期表示フォルダの設定 .InitialFileName = "D:\・・・・" If .Show = -1 Then 'ファイルダイアログ表示 ' [ OK ] ボタンが押された場合 For i = 1 To .SelectedItems.Count strFiles = strFiles & vbLf & .SelectedItems(i) Next i テキスト11.Value = strFiles Else ' [ キャンセル ] ボタンが押された場合 MsgBox "ファイル選択がキャンセルされました。", vbExclamation End If End With End Sub 上のコマンドでファイルを選択し、テキスト11というテキストボックスに出力します。 Private Sub コマンド13_Click() If MsgBox("ファイルをコピーしますか？", vbYesNo) = vbYes Then Dim FSO As Object Dim pass As String pass = テキスト11.Value Set FSO = CreateObject("Scripting.FileSystemObject") ''D:\Test\フォルダにコピー FSO.CopyFile "pass", "D:\Test\" Set FSO = Nothing End If End Sub 上のコマンドでテキスト11に出力したパスのファイルをD:\Test\にコピーしたい、、、のですが「 FSO.CopyFile "pass", "D:\Test\"」のところでファイルが見つかりませんとのエラーが出てしまいます。。。どこが問題なのでしょうか？？ また、msoFileDialogFilePickerで複数選択したときはどうやってコピーすればいいのでしょうか？？ 初心者でまだまだ理解が足りていないんだと思います、、、どなたかご教授お願いします。
https://oshiete.goo.ne.jp/qa/9098167.html このページで質問してご回答いただいたのですが 質問文が長くなってしまったので 再度質問させていただきます。 自分でもいろいろと試していて、 特性が大分分かってきました。 ただ、まだ理解できていないのが以下の二つの現象です。 引数として文字列を使った場合 r2() = StrConv("あいうえお", vbFromUnicode) シフトJISへの変換は正常に行われるのですが r2() = StrConv("あいうえお", vbUnicode) Unicodeへ変換すると、なぜか空要素が途中に入ったUnicode配列が出力されます。 Unicodeの配列をUnicodeに変換しても 同じように配列の内容はそのままで空要素が入ったUnicode配列が出力されます。 この空要素の入ったUnicode配列をシフトJISへ変換しようとすると r2() = StrConv(CStr(r2()), vbFromUnicode) なぜかシフトJISではなく元の空要素のない正常なUnicode配列が出力されます。 空要素の入ったUnicode配列が出力されるのも疑問ですが シフトJISへの変換で元に戻せるのは一体どういう仕様なのでしょうか？ それとあと一つ気になったのが、 シフトJISの禁則文字を含んだ文字列を 配列に変換後にもう一度元の文字列に戻した時、変換の仕方で文字化けするものとしないものがあります。 文字化けしない方法 (文字列→SHIFT_JIS →Unicode（スペース無し）→文字列) r4() = StrConv("あいう\ku予定表", vbFromUnicode) r5() = StrConv(CStr(r4()), vbUnicode) mozi = CStr(r5()) 文字化けする方法 (文字列 →Unicode（スペース有り）→Unicode（スペース無し）→文字列) r6() = StrConv("あいう\ku予定表", vbUnicode) r7() = StrConv(CStr(r6()), vbFromUnicode) mozi = CStr(r7()) ここで謎なのはr5とr7は全く同じ配列なのに CStrをかけて文字列に変換すると違う結果が得られることです。 これは一体なぜなのでしょうか？
VBAを使っていて VBAのコードの強調表示・配色を保持したまま コードをwordファイルにコピーしたいのですが そのようなソフトがあれば教えてください。 　 例えば、秀丸を使えば強調表示・配色を表示することができるのですが wordに強調表示・配色をコピーすることはできません。 何か良いソフトはないでしょうか？
https://www.moug.net/tech/exvba/0140028.html このページにあるようにStrConv関数を使って UnicodeとSHIFT_JISを相互に変換することができます。 これで得られる結果とchr()、Hex(Asc(""))で得られる結果の違いについて教えてください。 例えば、以下のコードをVBAで実行すると 'Unicode→シフトJIS gg = StrConv("123あいう", vbFromUnicode) '結果　"㈱舳??" 'シフトJIS→Unicode gg2 = StrConv("123あいう", vbUnicode) '結果　"1 2 3 B0D0F0" というようになります。 gg = StrConv("あ", vbFromUnicode) と「あ」だけ変換しても"?"になってしまいます。 なぜシフトJISに変換すると文字化けしてしまうのでしょうか？ Hex(Asc("あ")) で変換すると 82A0となるのですが、これと全く違うのはなぜでしょうか？ また、Unicodeの方は文字化けこそしなかったのですが 意味の分からない出力になりました。 gg2 = StrConv("あ", vbUnicode) と変換すると"B0"が得られたので 「あ」はB0に相当することが分かったのですが https://ja.wikipedia.org/wiki/Unicode%E4%B8%80%E … 「あ」はUnicodeでは3242 http://www.seiai.ed.jp/sys/text/java/shiftjis_ta … 「あ」はシフトJISでは82A0 が割り当てられており、全く異なる値であることが分かります。 一体、このB0というのはどこから来る値なのでしょうか？
VBAを使って4バイトを10進数に変換する方法に関してですが Dim aaa(3) As Byte Dim bbb As Long aaa(0) = 7 aaa(1) = 15 aaa(2) = 15 aaa(3) = 15 bbb = aaa(0) * 4096 + aaa(1) * 256 + aaa(2) * 16 + aaa(3) bbb = (CInt(aaa(3))) Or (CInt(aaa(2)) * &H10&) Or (CInt(aaa(1)) * &H100) Or (CInt(aaa(0)) * &H1000) 上記の二つの方法が上げられます。 速度を比較したところ、 一つ目の方法の方が30%程度高速であることが分かりました。 それで一つ目の方法を使いたいのですが、 aaa(0)が7以下（bbbが32767以下）なら問題ないのですが aaa(0)が8以上（bbbが32768以上）になるとなぜかオーバーフローしてしまいます。 32767上限というとintegerの上限のはずですが、 aaa(0)をintegerで定義しても同じところでオーバーフローしてしまいます。 aaa(0)をlongで定義するとオーバーフローしなくなります。 掛け算するときに、入力変数の上限が出力結果に影響を及ぼすのはなぜなのでしょうか？ 一度、aaa(0) * 4096の結果が、aaa(0)に代入されてから bbbに代入されているのでしょうか？ もしそうだとしてもbyteでの上限が255にならず 32767になるのはなぜなのでしょうか？
下記コード（複数のシートの纏め）で、値のみをコピーする手法を教えて戴きたくお願いします。 Sub matome() 　Dim Sh 　Dim i As Integer 　Dim lRow As Long, lCol As Long, lRow2 As Long 　　Application.ScreenUpdating = False 　 　'----列見出しをコピーします 　　Worksheets(2).Range("1:1").Copy Worksheets(1).Range("A1") 　　'----コピーする順番にシート名を配列Shに登録します 　　Sh = Array("Sheet1", "Sheet2", "Sheet3") 　　For i = LBound(Sh) To UBound(Sh) 　　　　With Worksheets(Sh(i)) 　　　　　　lRow = .Cells(Rows.Count, 1).End(xlUp).Row 　　　　　　lCol = .Cells(1, Columns.Count).End(xlToLeft).Column 　　　　　　If lRow >= 2 Then 　　　　　　　　lRow2 = Worksheets(1).Cells(Rows.Count, 1).End(xlUp).Row + 1 　　　　　　　　.Activate 　　　　　　　　.Range(Cells(2, 1), Cells(lRow, lCol)).Copy Worksheets(1).Cells(lRow2, 1) 　　　　　　End If 　　　　End With 　　Next i 　　Worksheets(1).Activate 　　Range("A1").Select 　　Application.ScreenUpdating = True End Sub
VBAを使って、 あるバイナリファイルを読み込み 5000バイト～5100バイトの部分だけをカットして ファイルを出力するプログラムを作りたいと考えています。 Dim buf As String Dim buf2 As String Open filepath For Binary As #1 buf = Space(5000) buf2 = Space(FileLen(filepath(j)) - 5100) Get #1, , buf Get #1, 5100, buf2 Close #1 intFileNumber = FreeFile 'ファイルの空き番号を得る Open Strpath For Binary As intFileNumber Put intFileNumber, , buf Put intFileNumber, 5000, buf2 Close intFileNumber '必ず、最後にcloseする必要がある この方法で作成すると元が64.5kBだったファイルが76.5kBとなり、 元よりも大きなサイズになってしまいます。 恐らく、bufをbyteで定義して for文で一つずつ回していけばうまくいくのではないかと思うのですが この方法だと時間がかかってしまいます。 for文を使わずに一度にまとめてファイルを読み込んで 入出力したいのですがどうすれば良いでしょうか？
初めて投稿します。 Access2013にてレポート出力の為のフォーム、レポートを作成しております。 Form：F_01 ①txt_A／受付番号 ②txt_B／担当者名 ③txt_C／日付 ↓ Report：R_99 ❶txt_A／受付番号 ❷txt_B／担当者名 ❸txt_C／日付 サブレポート： 受付番号に紐づいた明細表示 フォームからレポートへこれらの情報を受け渡すのにOpenArgsを使いしました。 Form側********************************************** Private Sub cmd_PrintPVW_Click() Dim sDATA As String sDATA = Me.txt_NO.Value & "," & _ Me.txt_KPPSN.Value & "," & _ Me.txt_Customer.Value & "," & _ Me.txt_ANKEN.Value & "," & _ Me.txt_RQDate.Value DoCmd.OpenReport "R_Order", acViewPreview, , , , sDATA End Sub Report側********************************************** Private Sub Report_Open(Cancel As Integer) Dim rDATA() As String If IsNull(Me.OpenArgs) = True Then Cancel = True Exit Sub End If rDATA = Split(Me.OpenArgs, ",") Me.txt_JNO = rDATA(0) Me!txt_KPPSN = rDATA(1) Me.txt_Customer = rDATA(2) Me.txt_ANKEN = rDATA(3) Me.txt_RQDate = rDATA(4) End Sub この様にしてみたのですが、いざレポートプレビューを開こうとすると表題のエラーが出て 「このオブジェクトに値を代入する事はできません」と言われてしまいます。 どなたかご教示願えれば幸いです。 どうぞよろしくお願い致します。
こんばんは htmlオブジェクトのクリップボードの操作方法を眺めていたのですが、期待と違う戻り値がもどってきて少し戸惑っています。 以下、htmlfileオブジェクトによるクリップボード操作になりますが、strClipが「True」と表示されます。 「文字を送る」と返して欲しかったのですが、ClipboardDataはそういう操作をするものではないのでしょうか？ ※IEを利用したクリップボード操作など、他のアプローチ方法については知っておりますので、htmfileオブジェクトによる操作が可能かどうかについての、ご回答をお願いします。 Set objHTML = CreateObject("htmlfile") strClip = objHTML.ParentWindow.ClipboardData.SetData("text","文字を送る") Msgbox strClip
VBAを使っていて、 ユーザーフォーム上の複数のテキストボックスに以下のような コードを設定したいと考えています。 Private Sub TextBox14_Change() Dim txtbox As Object Set txtbox = TextBox14 call routine(txtbox) End Sub 上のコードの中で Dim txtbox As Object Set txtbox = TextBox14 call routine(txtbox) の部分をコピーしていけば良いのですが 「TextBox14」の「14」という番号の部分を テキストボックスごとに書き換えられる必要があります。 それで Sub TextBox14_Change 内でコードが走っている場合には 14あるいはTextBox14という名称を返す変数のようなものがあれば教えていただけないでしょうか？ 一応、検索して調べてみたのですが 類似の質問ページは見つかったのですが 明確な回答は見つかりませんでした。 よろしくお願いいたします。
私は心理学を専攻する大学4年生です。 現在卒業論文で実験プログラムを作成しなければならないのですが、プログラミングは大の苦手であり、心理学実験用のマニュアルや資料を参照しても全く完成させることができません。使用しているアプリケーションソフトはVisualStudio2015、言語はVisualBasicです。 作成すべきプログラムは以下のようなものです。 1. 開始ボタンを押すと開始ボタンが消え、画面中央のラベルに文字が1個表示される。 2. ラベルの文字は全部で28種類あり、1ブロックにおいてそれぞれが1回ずつランダムに表示される。これが全部で4ブロックまで繰り返されるので、総試行数は112試行となる。 3. 1試行は、1個の文字が10秒間表示されることであり、10秒経つと自動的に次の試行へと移り、文字が切り替わる。 4. ただし、1試行中に被験者がスペースキーを押すと、ただちに画面全体が暗転する。暗転状態は10秒間であり、10秒経つと自動的に次の試行へと移る(元通りの画面になり、次の文字が表示される)。 5.ある文字に対してスペースキーが押された回数と、その文字が表示されてからスペースキーを押すまでの時間(潜時)を計測する。 指導教授からは簡単なプログラムなのだから早く完成させろと叱責します(ただし、教授自身にはプログラミングの具体的指導は仰げません)。別の先生によるプログラミングの授業も以前受けたことがありますが、その際も今回よりも簡単なプログラムの作成すらままなりませんでした。その先生は大変プログラミングにお詳しいので、今回もご相談したところ、授業で用いたレジュメよりも詳細なものを頂きました。また、「はじめての行動分析実験―VisualBasicでまなぶ実験プログラミング」という本を入手し、これらを参照して作成に励みました。しかし、それぞれの項目にあるサブプロシージャを単に組み合わせただけでは、デバッグをしても思うように作動せず(何も表示されない、暗転状態が終わらない、表示された文字が10秒経過しても切り替わらない、など)、徹夜を続けて試行錯誤的に記述してはデバッグを繰り返しましたが、全く完成させることができませんでした。サブプロシージャ同士のつながりが重要なのだろうと思いますが、それをどうやって実現すればよいかは資料を読んでも私の頭では理解・実現困難でした。 指導教授には2日後の月曜日から実験を始めるよう命じられており、明日には完成させなければなりません。先のプログラミングにお詳しい先生とは休日にはコンタクトがとれないので間に合いません。私のゼミにはそのようなプログラミングに詳しい院生の方はおらず、他のゼミにもご相談できる方がおりません。本日も完成させるべくずっと頑張っていたのですが、ついに思うように作動することはなく、完成の見通しが全く立たないため、このサイトにて質問を投稿する決心を致しました。このような事態になったことは完全に私の自業自得であり、私の横着と怠慢故の質問で大変恐縮ですが、本当に困っています。ここ1週間は慢性的に頭痛腹痛に悩まされ、夜も眠れません。どなたかお助け下さい。どうかよろしくお願い申し上げます。 お恥ずかしながら、以下が私が作成したコードになります。 Button1は開始ボタン、Label1は文字を表示するラベル、Trialは試行数カウンタ、StartTimeは表示開始時間、EndTime1は表示終了時間、RespTimeはキーを押した時間、EndTime2は暗転終了時間、Latencyは表示開始からキーが押されるまでの時間、EndFlag1は表示終了、EndFlag2は暗転終了、StimTypeは文字の種類、dataは当座の順番保管場所になります。 (以下作成コード) Public Class Form1 Declare Function GetAsyncKeyState Lib "user32.dll" (ByVal nVirtKey As Integer) As Short Dim Trial As Integer Dim StartTime, EndTime1, RespTime, EndTime2, Latency(130) As Long Dim EndFlag1, EndFlag2 As Boolean Dim StimType(30) As Integer Dim data(30) As Integer Dim i As Integer Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click Button1.Visible = False EndFlag1 = False Trial = 1 ArrangeStim() StimStream() End Sub Private Sub StimStream()←文字の表示 　　　Label1.Visible = True StartTime = System.Environment.TickCount EndFlag2 = False StimType(Trial) = data(i) Select Case StimType(Trial) Case 1 Label1.Text = "文字1" Case 2 Label1.Text = "文字2" 　　　(中略) Case 28 Label1.Text = "文字28" End Select Do Until EndFlag1 Application.DoEvents() EndTime1 = System.Environment.TickCount If EndTime1 - StartTime > 1000 Then EndFlag1 = True End If Loop If EndFlag1 = True Then Trial = Trial + 1 End If If (&H001 And GetAsyncKeyState(System.Windows.Forms.Keys.Space)) = 1 Then BlackOut() End If End Sub Private Sub BlackOut()←暗転 Me.BackColor = Color.Black RespTime = System.Environment.TickCount Latency(Trial) = RespTime - StartTime Do Until EndFlag2 Application.DoEvents() EndTime2 = System.Environment.TickCount If EndTime2 - RespTime > 10000 Then EndFlag2 = True End If Loop If EndFlag2 = True Then Trial = Trial+ 1 StimStream() End If End Sub Private Sub ArrangeStim()←文字のランダム化 Dim r, temp As Integer For i = 1 To 28 data(i) = i Next For i = 1 To 28 r = Int(Rnd() * 28 + 1 - i) + i temp = data(i) data(i) = data(r) data(r) = temp Next End Sub End Class
VBAで ユーザフォーム上に多数のコントロールがある状態で 例えば、textbox18を探したいとします。 一つ一つテキストボックスをクリックして オブジェクト名を見て探すのだと時間がかかるのですが 検索などして見つける方法があれば教えてください。
現在作成しているシステムがあるんですが、いろいろ調べてコードを作成しても検索まではできても、別のユーザーフォームと連動させられようにはできませんでした。 やりたいことは下記のとおりです。 「学生情報」のシートがあり、「検索」と「学生情報」のユーザーフォームのみ作成している状態です。 ①「検索」のユーザーフォームで、学籍番号・氏名・氏名カナのいずれかのテキストボックスの部分一致で検索 ②「検索」のコマンドボタンをクリックしたら、リストボックスに表示 ③リストボックスには、学籍番号・氏名のほかに学科・学年・クラス・在籍状況等を表示 ④検索しリストボックスに表示された項目を選択し、「OK」のコマンドボタンをクリックしたら「学生情報」のユーザーフォームを開き、それぞれのテキストボックス（27項目程）に表示 ⑤データの変更等をしたら、「学生情報」シートの基データも更新する この説明だけでは伝わりにくく、難しいことなのかもしれませんが、よろしくお願いいたします。
お世話になります。 DBから2つのテーブルを取得する際にSqlParameterを使用すると2つ目のテーブルの取得時にタイムアウトになってしまう現象に遭っています。 ・SqlParameter使用 ''型付きデータセット Dim ds As New TargetDataSet Dim sb as new System.Text.StringBuilder sb.Append("SELECT ~ FROM TblA WHERE ColA = @Val") Dim sb2 as new System.Text.StringBuilder sb.Append("SELECT ~ FROM TblB WHERE ColB = @Val") Using conn As New SqlConnection(ConnString) ＿＿Using cmd As New SqlCommand(sb.ToString, conn) ＿＿＿＿cmd.Parameters.Add(New SqlParameter("@Val", val)) ＿＿＿＿Using da As New SqlDataAdapter(cmd) ＿＿＿＿＿＿da.Fill(ds.TblA) ＿＿＿＿End Using ＿＿＿＿cmd.CommandText = sb2.ToString____''CommandTextをtblB用に変更 ＿＿＿＿Using da As New SqlDataAdapter(cmd) ＿＿＿＿＿＿da.Fill(ds.TblB) ＿＿＿＿End Using ＿＿End Using End Using パラメーターに入る値は共通なのでSqlCommandは使いまわしてCommandTextを変えて使用しています。 これで実行すると、2つ目のtblBへのFillでタイムアウトになってしまいます。 しかし、同じやり方でSqlParameterを使わずにクエリ文字列に直接valの値を入れて実行すると、問題なく処理されます。 SqlCommandとSqlParameterを使いまわしてはいけないのでしょうか？ よろしくお願いします
いつもお世話になります Sub Sample77() If ActiveSheet.AutoFilterMode Then If ActiveSheet.AutoFilter.FilterMode Then MsgBox "絞り込まれています" Else MsgBox "絞り込まれていません" End If End If End Sub 上記のコードではテーブル化したエクセル表には適応しないのでしょうか？ どなたかご存知の方いらっしゃいましたらご回答をよろしくお願い申し上げます。
下記二点について、ご教示お願いします。 ①Windows7/IE9において、VBScriptによりIEのHTMLソースを取得しようとしています。 下記のソースによって、BODY句は取得できるのですが、 HEAD句も含めた全てのHTMLを取得するのはどのようにすれば良いのでしょうか。 ②InnerHtmlに文字制限はあるのでしょうか。 　（昨日、検証していた際に、BODY句が長い場合にエコーが途中で切れていた為） 【BODY句が取得できるソース】 Dim objIE Dim strBody Set objIE = CreateObject("InternetExplorer.Application") objIE.Navigate "http://www.XXXXX.co.jp/" Do Until objIE.Busy = False WScript.sleep(250) Loop' strBody = objIE.Document.Body.InnerHtml WScript.echo strBody
こんばんは Document.body.innerTextで取得した内容を１行ずつ配列に格納していきたいのですが、どのようにすればよろしいでしょうか？ FileSystemObjectを用いて、一時的にテキストに取得した内容を書き出し、１行ずつ読み込んで格納していくしかないのでしょうか？ できれば、innerTextで取得した内容を直接格納したいのですが、詳しい方いらっしゃいましたら、アドバイス下さい。
以下のマクロコードを教えてもらえないでしょうか？Ａ列にバーコード番号・Ｂ列にその値段、また同様にＤ列にバーコード番号・Ｅ列にその値段が入っているとき、Ａ列とＤ列のバーコード番号が一致すれば、Ａ列・Ｄ列のバーコード番号とＢ列・Ｅ列の対応する値段を緑色にしたいです。同じバーコード番号が同じ行にあるとは限りません。
Excel VBAにてActiveDirectoryのユーザなどの管理をしたいと考えています。 （理由：操作ミスなどを防ぐために、AD操作は全てExcelからにしたい） 情報を取得する対象のユーザが分かっていれば、以下の方法で、情報を取得可能かと思います。 （実行するユーザが、ADの操作権限がある前提で、suzukiというユーザの情報を取得する場合） Dim objSysInfo Dim objUser Set objSysInfo = CreateObject("ADSystemInfo") Set objUser = GetObject("LDAP://CN=suzuki,OU=OU123_ユーザー,OU=OU123,DC=ad,DC=test,DC=com") 　AD：ad.test.com 　OU：OU123→OU123_ユーザー OU123_ユーザー配下のすべてのユーザ情報を取得する場合には、どのようにすればよろしいでしょうか？
エクセルの質問です。 エクセルのSheet1に複数の画像があります。 この画像の名前がpicture1～picture1999の場合は削除し、それ以外の画像は削除しない。 ということはマクロでできるのでしょうか？ ご教示お願い致します。
VBAで ダブルクオーテーションマーク内で改行して コードを複数行を分ける方法についてですが ですが eee = "abcdefghijk" を2行に分けたい場合 eee = "abcde _ fghijk" とやってもうまくいかないのですが eee = "abcde" _ & "fghijk" というようにして各行毎に""を閉じる必要がありますか？
Sub aiu() Dim Atai7 As Long Atai7 = Range("K3").Value Select Case Atai7 Case 0 To 3.8 Range("K9").Value = Range("K1").Value & "(" & Range("K5") & ")" Case 3.9 To 5.5 Range("K10").Value = Range("K1").Value & "(" & Range("K5") & ")" Case 5.6 To 8.8 Range("K11").Value = Range("K1").Value & "(" & Range("K5") & ")" Case 8.9 To 11.8 Range("K12").Value = Range("K1").Value & "(" & Range("K5") & ")" Case 11.9 To 15.6 Range("K13").Value = Range("K1").Value & "(" & Range("K5") & ")" Case 15.7 To 21 Range("K14").Value = Range("K1").Value & "(" & Range("K5") & ")" Case 21.1 To 27.5 Range("K15").Value = Range("K1").Value & "(" & Range("K5") & ")" Case 27.6 To 33.5 Range("K16").Value = Range("K1").Value & "(" & Range("K5") & ")" Case 33.6 To 43.9 Range("K17").Value = Range("K1").Value & "(" & Range("K5") & ")" Case 44 To 59.9 Range("K18").Value = Range("K1").Value & "(" & Range("K5") & ")" Case 60 To 85.5 Range("K19").Value = Range("K1").Value & "(" & Range("K5") & ")" Case 85.6 To 119.9 Range("K20").Value = Range("K1").Value & "(" & Range("K5") & ")" Case 120 To 119.9 Range("K21").Value = Range("K1").Value & "(" & Range("K5") & ")" Case 200 To 1000 Range("K22").Value = Range("K1").Value & "(" & Range("K5") & ")" End Select End Sub このプログラムについて質問です。 セルK3に、3.9の値があるときに、本来であれば、セルK10に、セルK1の値が表示されるはずなのですが、セルK9に、セルK1の値が表示されるのですが、どうしてなのか分かりません セルK3の値が、4.6になってから、セルK10に、セルK1の値が表示されます。 詳しいかたご教授お願いします。
こんにちは。３日前からマクロを勉強し始めました。 A列に有るデータをC列に３回コピーしていきたくて 下記のようなものを仮に組んでみました。 Worksheets("Sheet1").Range("A1").Copy Destination:=Worksheets("Sheet1").Range("C1") Worksheets("Sheet1").Range("A1").Copy Destination:=Worksheets("Sheet1").Range("C2") Worksheets("Sheet1").Range("A1").Copy Destination:=Worksheets("Sheet1").Range("C3") Worksheets("Sheet1").Range("A2").Copy Destination:=Worksheets("Sheet1").Range("C4") Worksheets("Sheet1").Range("A2").Copy Destination:=Worksheets("Sheet1").Range("C5") Worksheets("Sheet1").Range("A2").Copy Destination:=Worksheets("Sheet1").Range("C6") ・ ・ ・ この作業をA列が空白になるまでという条件で （　Do while を使うのでしょうか・・） 続けたいのですが、 どのようにマクロを組めばよいのかわかりません。何となか変数を使うらしいということまではわかったのですが。。 どなたかご教示いただけると助かります。 よろしくお願いします。
VBAでコマンドプロンプトを実行した後に ウインドウを閉じないで実行したいのですが https://oshiete.goo.ne.jp/qa/8931913.html このページを参考にして Sub Sample_WShell01() Dim ShellObj Set ShellObj = CreateObject("WScript.Shell") ShellObj.Run "%ComSpec% /c & pause", , True Set ShellObj = Nothing End Sub を実行してみたのですが 一瞬でウインドウが閉じてしまいます。 どうすれば閉じずに実行できますでしょうか？
お世話になります。 xlsmマクロ有効ファイルのシートを、xlsxファイルへコピーして、 xlsxファイルを保存しようとすると、 「ドキュメント検査機能では削除できない個人情報がドキュメントに含まれていること がありますのでご注意下さい。(Ok/Cancel)」 のメッセージボックスが表示されます。 保存の都度、煩わしいので、このメッセージを表示しない方法を教えて下さい。
ファイルを共有するので別ファイルのリンクを切る必要があり、vbaで処理ができるようにしたいです ファイルは２つで②のファイルにvbaを組込ませたいです ①参照先＝[masterファイル.xls]の[master1]シート ②書込先＝[○○支店.xls]の[xxxx(コード)_yyyy(西暦)]シート ＜条件＞ １．①の[master1]シートにはA列～X列の5行目から3000行目までデータが入っており 　　検索値＝F列 　　範囲＝F5:X3000 　　列番号＝18(W列)と19(X列)　　←2つのデータを取り出したい ２．①のW列とX列は関数が入っているので値だけ取り出したい ３．②のファイルには[xxxx(コード)_yyyy(西暦)]シートがあり、A～AD列の6行目～300行目あたりまでデータが追加されていきます 　　参照値＝Q列 　　取り出したデータの貼付け先＝AB列とAC列 ４．①のファイルは一定量のデータが溜ると更新される(書換えられる)ので②のAB列やAC列のすでにデータが入ったセルはそのままで空欄となっているセルだけを埋めるようにしたい ５．ちなみに②は20ファイルくらいあるので、それぞれにvbaを組込ませる予定です(参照ファイルは①の１つだけです) ６．vbaは全くの初心者なので、条件が変わった場合に修正ができるように詳しい解説をお願いしたいです どうぞよろしくお願いいたします
ffmpegかffprobeを使って 動画のfps情報だけを取得したいのですが http://askubuntu.com/questions/110264/how-to-fin … このページにあるように コマンドプロンプト上で ffmpeg -i filename を実行すると Input #0, matroska,webm, from 'somerandom.mkv': Duration: 01:16:10.90, start: 0.000000, bitrate: N/A Stream #0.0: Video: h264 (High), yuv420p, 720x344 [PAR 1:1 DAR 90:43], 25 fps, 25 tbr, 1k tbn, 50 tbc (default) Stream #0.1: Audio: aac, 48000 Hz, stereo, s16 (default) というような情報が出力されます。 この中で25 fpsという部分だけを抽出したいのですが このページにあるように ffmpeg -i filename 2>&1 | sed -n "s/.*, \(.*\) fp.*/\1/p" を実行することで所望する 25 だけを表示することができます。 このsedというものの使い方を知りたいのですが どのような仕組みで25だけを抽出しているのでしょうか？ https://hydrocul.github.io/wiki/commands/sed.html こういうページに解説が書かれてあるのですが 難解で理解することができませんでした。 簡単に説明していただけないでしょうか？
少し長いですが、ご容赦 ２台のＰＣで　実行速度が全く違った。その理由を知りたいのですが・・・ プログラムは同じ、（プログラムをＵＳＢで　移し替えた） 基本はロジックは 生データを　１５分単位でまとめたものを orgdata.Range("a4:b4").Copy Destination:=fun15.Range("A" & endsisu) 月日と時間のコピー DoEvents orgdata.Range("c4:f4").Copy Destination:=fun15.Range("d" & endsisu) 株価の生データのコピー DoEvents fun15.Range("c" & 500 & ":c" & 500).Copy fun15.Range("c" & endsisu & ":c" & endsisu).PasteSpecial Paste:=xlPasteFormulas 月日と時間の合成 ここまで、株価の生データを　コピーする。 DoEvents fun15.Range("H" & 500 & ":AZ" & 500).Copy fun15.Range("H" & endsisu & ":AZ" & endsisu).PasteSpecial Paste:=xlPasteFormulas DoEvents で、１５分データで　セル式の計算本番　ＨからＡＺまで・・・・ １５分を更に時間単位でまとめて Call jikantenso　’時間シートに・・・ これで、セル式の計算が完了するので、 Call 確認 Call 注文確認　この中で、注文フラグが立ったら　ＦＴＰプログラムで　ＨＰにアップする。 このロジックが ＯＳ－１０—64bit　 Intel(R) Core™ i7-3537U CPU @2.00Ghz 2.00GHz 実装RAM　８．００GB のマシンで マクロin2015/10/13 9:15:08 マクロcopy-in2015/10/13 9:16:08 マクロfun　copy-in2015/10/13 9:16:29 マクロ60copy-naka2015/10/13 9:16:48 マクロ　60fun　copy-out2015/10/13 9:16:57 マクロ Call 確認-in2015/10/13 9:17:00 変化24940--18365 新規　買い24940--18365 マクロ Call 注文確認-in2015/10/13 9:17:16 注文確認-in2015/10/13 9:17:18-0-18365 注確 k_order_row-105-返-105 UP-in2015/10/13 9:17:45　　 UP-out2015/10/13 9:17:56　 9:15:08から　スタートして　UP-out 　9:17:56　で　アップ完了 ２分４８秒？？ ところが、ロースペックの　はず？？　ｉ５マシン ＯＳ　は　7—64BIT Intel(R)Core(TM) i5-2410M CPU@2.3Ghz 2.30GHz 実装RAM 　4.00GB マクロin2015/10/09 16:45:01 マクロcopy-in2015/10/09 16:45:23 マクロfun　copy-in2015/10/09 16:45:31 マクロ60copy-naka2015/10/09 16:45:37 マクロ　60fun　copy-out2015/10/09 16:45:40 マクロ Call 確認-in2015/10/09 16:45:41 変化23820--18340 新規　買い23820--18340 マクロ Call 注文確認-in2015/10/09 16:45:47 注文確認-in2015/10/09 16:45:48-0-18340 注確 k_order_row-100-返-100 UP-in2015/10/09 16:45:58 UP-out2015/10/09 16:46:03 16:45:01　開始で　16:46:03　完了 １分２秒・・・・・　約　1/3　の時間　 ＯＳが　7と　10　エクセルは　どちらも　2013　 ただエクセルの　オプション設定は　微妙にに違うかもしれませんが　 反復計算　3回　.0.001　どちらも同じ。 それ以外　意識したことはありません・・・・ マザーのチップと　クロックが　i７＝2.0　ｉ５＝2.3　と違いますが・・・・ それとも、エクセルのオプション設定に時間にかかわる　何かあるのでしょうか？ それとも　10が　原因？？ 如何でしょうか
いつもお世話になります。 表題の通りなのですが、C1からC30まで、＝A1+B1　から　=A30+B30　の計算式が入っているとしてマクロでC列の一番下のセルの値を取得する方法を探しています。　ちなみにC列はIfを使って空白処理してあります。ご協力頂ける方いらっしゃいましたらご教示願います。
今更なのですが、VB6にてフォーム上にメディアプレーヤーコントロールを貼り付けて 動画や静止画のスライドショー的なものを作成しました。 メディアプレーヤーコントロール上でダブルクリックを行うと、最大化されてしまい、 コントロールを配置しているフォームを覆い隠してしまいます。 そうなると、画面いっぱいにメディアプレイヤーコントロールが表示されてしまうため フォームの他のコントロールが操作出来なくなります。 再度、メディアプレーヤーコントロールをダブルクリックすれば元の状態に戻るのですが、 出来れば、ダブルクリックしてもメディアプレイヤーコントロールが最大化（イメージ的には フォームから外れて、単独で最大化されている感じ）を防ぐ方法はないでしょうか？ よろしくお願いいたします。
VBAのユーザーフォームのテキストボックスで TextBox5.Value TextBox5.text の違いについて教えてください。 てっきり数値かストリングかの違いだと思っていたのですが Private Sub TextBox5_Change() ee = TextBox5.Value dd = TextBox5.text End Sub というコードでテキストボックスにいろいろな値を入れて調べてみたのですが valueもtextもストリングで値が格納されており、 両方とも数値、文字列をどちらとも扱えることが分かりました。 検索して調べてみたのですが http://www.tsware.jp/study/vol16/vbabegin_32.htm 前者はそのコントロールからフォーカスが離れたときなどに確定した値です。 一方、後者は現在編集中のデータ内容（画面に表示されている内容）です。 編集中の場合にValueプロパティを取得しても、それは前回最後に確定したデータであって、 現在画面に表示されているものではありません。 このページによれば、 文字入力確定後の値がtextに格納されており 編集中の値がvalueに格納されているそうです。 それで、例えば「aaaa」と入力されている途中にカーソルを入れて 「aabaa」としてみました。 しかし、両方とも同じ値が代入されています。 http://officetanaka.net/excel/vba/tips/tips143.htm このページにはボックスが空のときの扱いが異なるそうなのですが 「aaaa」をクリアしてみると 両方とも""という値が代入されています。 全く同じ挙動をしているように思えるのですが どうやって使い分ければ良いのでしょうか？ どういうコードなら違いが見られますでしょうか？
ＶＢＡで複数のブックを集計ブックにまとめたいのですが、コピー元のエクセルシートに計算式がはいっているためコピー先が全てREF!となってしまいます。。。 下記の式をどのように変えたら値のみをコピーできますか？ ご教示頂ければ幸いです！ Sub 集計() Workbooks.Open "\\場所\ブック名.xlsm " Workbooks("ブック名.xlsm").Worksheets("シート名").Range("AJ5").Resize(400).Copy Destination:=Workbooks("コピー先.xlsm").Worksheets("Sheet1").Range("C1") End Sub
以前にxcelブックから、シート名を取得し、取得した名前をcsvファイル名にする書き方を教わりました。 進めて行く間に、シート名に "1.5SVI" の様に "." が入ったシート名があり、これをcsvに変換出力すると "." で区切られてしまいます。 "."が入ったシート名とそうでないシート名で共通できる書き方はありますか。 また、難しいようでしたら、入ったシート名はどの様に記載すれば宜しいでしょうか。 Dim shName As String Dim newSh As Worksheet Dim myPath As String myPath = ThisWorkbook.Path & "\" With ActiveSheet shName = ActiveSheet.Name Set newSh = Worksheets.Add .Range("A5:F600").Copy newSh.Range("B2").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False .Range("A1").Copy newSh.Range("A2:A601") newSh.Move End With Application.DisplayAlerts = False ActiveWorkbook.SaveAs myPath & shName, xlCSV Application.DisplayAlerts = True ActiveWorkbook.Close False 宜しくお願い致します。
上から順に読み込み、順次処理していき最終的には全部処理します。CSVファイルは読むだけです。 やり方はいくつか考えられます。 1 100万行ずつシートに読み込み、終わったら次を読み込む。CSVファイルは開きっぱなし。 2 100万行ずつのエクセルファイルに分割し、順次開いて処理。ファイル開閉に時間がかかる 3 2千万行の巨大な配列に代入し、順次処理。 CSVファイルは閉じることが出来る。 3がいいように思えますが、どうでしょうか？使用メモリは1と同じですか？
指定したフォルダ内の 全Excelファイルのシート名を抽出したいと考えております。 またそのデータをワークシート上に表示したいと思います ソースは一通り教えていただけると嬉しいです。 どうぞよろしくお願いいたします。
Sub あいう() Select Case True Case Range("D3").Value >= 0 And Range("D3").Value <= 3.8 Range("D14").Value = Range("D1").Value Case Range("D3").Value >=3.9 And Range("D3").Value <= 5.5 Range("D15").Value = Range("A3").Value Case Range("D3").Value >=5.6 And Range("D3").Value <= 8.8 Range("D16").Value = Range("A3").Value Case Range("D3").Value >=8.9 And Range("D3").Value <= 11.8 Range("D17").Value = Range("A3").Value Case Range("D3").Value >=11.9 And Range("D3").Value <= 15.6 Range("D17").Value = Range("A3").Value Case Range("D3").Value >=15.7 And Range("D3").Value <= 21 Range("D18").Value = Range("A3").Value End Select End Sub この記述を、cellsプロパティを使って簡単に記述することはできますか？ VBAを勉強していますが、変数とCellsの使い方がよくわからないのです。 VBAに詳しいかたご教授お願いします。
VBAでテキストデータを読み込みたい時 Set MyTxt = FSO.OpenTextFile(Strpath, 1) Do While MyTxt.AtEndOfStream = False aaa = MyTxt.ReadLine Loop のようにして読み込むことができます。 途中まで読み込んだ後に、最初の行に戻りたい時とか 指定した行まで飛びたい時にはどうしたら良いですか？
VBAのテキストボックスに1未満の値のみが代入できるようにしたいのですが http://detail.chiebukuro.yahoo.co.jp/qa/question … このページを参考にして数値以外の代入の禁止を行った上で 以下のコードを試してみましたのですが 不審な挙動をしてうまくいきません。 Private Sub TextBox5_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger) If (KeyAscii < Asc(0) And KeyAscii <> Asc(".")) Or KeyAscii > Asc(9) Then KeyAscii = 0 End If TextBox5.Text = Val(TextBox5.Value) If Val(TextBox5.Value) >= 1 Then TextBox5.Value = Val(1) End If End Sub TextBox5.Text = Val(TextBox5.Value) というところは例えば、「0.00..42」などのように複数のピリオドが代入された場合に 数値に変換するために入れています。 これを実行すると なぜか13とか15とか1x系の数値しか代入することができません。 TextBox5.Text = Val(TextBox5.Value) を外してみましたがやはりうまくいきませんでした。 どのように改良すれば良いでしょうか？
大変いつもお世話になります　。 UserForm１というオブジェクト名のユーザーフォームをコピーしたくていろいろ試してるのですが よくわからなく困っています。。。 エクスポートして　UserForm1.frmになったのをインポートすると、すでに名前が使用されているとかメッセージが出てインポートできません。なので　UserForm1.frm　を　UserForm２.frmに名前を変更してチャレンジしたのですが、それでも同様の結果です。何かコツがあるのでしょうか？モジュールの場合のインポートとは要領が違うのでしょうか？ お時間ある方いらっしゃいましたら是非お願いします。。。。
VBAを使って cells(1,1)～cells(6,6) 以外の全てのセルを非表示にしたいのですが どうすれば良いですか？ http://www.moug.net/tech/exvba/0050108.html このページなどに セルを非表示にするコードは載っているのですが これらは一部のセルを非表示にするものなので、 いまやりたい、一部を除く全てのセルを非表示にする という操作にはどのように応用したら良いでしょうか？
エクセル2013で　シートが　３枚　+　１枚 この１枚で　外部からデーターを読み込みます。５分間ため込みます それを整形して、シート３枚に時間（５分ピッチ）で転送します。 転送すれば、生データはクリヤーされ、新規にため込みます。 転送されたシートは、セルに式が埋め込まれていますが、Hから　ＡＱまで、びっしり（A:Gまでは、受けた生データ　小数点の無い６ケタ程度の数値） かつ、セル式には　VLOOKUPで　他のシートを参照するのもあります。 で、計算シートの　行が　4500超え始めると、不明な行動が目につきます。 有効な、行は　2000も有れば良いので、適当に増え始めるとカットして運用しています。 それとは別に、記録として、別ファイルで生データを取得せず、コピーでシート埋めて、残してあります。これも、60.000行超えると、作業が遅くて、年度でファイルを分ける様です。 で、質問は、エクセルのセル式の計算、再計算に有効なのは、ＣＰＵの速さと言うか。、もしくは　メモリ―容量でしょうか？ 今は　i7　3770ｋ　3.5GH　メモリー　16GB　です。 とりいそぎ
タイピングアプリを作成していますが、途中で作業が止まっています。 仕様としては、Enterキーをトリガーとして処理が開始されます。 簡単な流れとして、 1 Excelキー押下 ストップウオッチ開始 テキスト入力 2 Excelキー押下 ストップウオッチ停止 テキストの値を取得し、判定 となる時の1と2の条件分岐がわかりません。 ストップウオッチの起動はsubプロシージャをcallして呼び出しています。 VBAはほとんど触ったことがなく、分かりにくいかと思いますが、ご教示いただきたいです。 また、簡単なもので良いので分岐の際のソースも教えて頂きたいです。 よろしくお願いします。
例えば、50個くらいあるxlsmファイルの Microsoft Excel ObjectsのThisWorkbookに同じプログラムコードを入力したいのですが 一つ一つファイルを開いてコピペしていくのが非常に面倒です。 複数のxlsmワークブックのVBAを変更するプログラムを作ることは可能ですか？
Worksheets("sheet1").ScrollArea = "A1:G20" とすることでワークシート内でのセルの選択範囲を制限することができます。 これをcellsで数値指定したいのですがどうすれば良いですか？ Worksheets("sheet1").ScrollArea = Range(Cells(1, 1), Cells(3, 2)) とやってみたのですが 型が一致しません、と言われ うまくいきませんでした。 良い方法があれば教えてください。
Excel2010のVBAでグラフを作成して、散布図や折れ線グラフのプロット（点）にタバコのパッケージのJPEGファイルを貼り付ける方法は、どんなものがあるでしょうか？
はじめまして。 WindowsのCドライブからExcel・VBAのAPIが格納されているフォルダまでどのようにたどって行けばよいのでしょうか？ また、APIの内容を確認すること可能でしょうか？ 例えば、MsgBoxのプログラムがどう書かれているかをエディターなどで開いて確認することは可能でしょうか？ できれば、Windows7以降の場合で教えてください。 よろしくお願い致します。
ＶＢＡで作成したマクロを実行した際に、今までは起きたことがないのですが、なぜか消えては困るシートが何回か消えていました。 シートが削除されないようにするには、どのような処置をすればいいですか？
ExcelのVBAでこんな場合はどう記述するのでしょうか A列の１行目から100行目とB列の１行目から100行目に 文字が入力されています。C列にA列とB列の文字を 入力するマクロ（関数でいえばCOCATENETE） すみませんなかなかうまくいかなくて。For～Nextでやってみたいのですが・・ なかなか前に進みません。
前に、画像貼り付けマクロについて質問したものです。 ある程度の解決を見ましたが、今度は画像を張り付ける際に、サブディレクトリから画像を選択し 貼り付けしているわけですが、選択する際にメインディレクトリに戻ってしまいます。 excel2003では、サブディレクトリを維持したまま何枚でも貼り付けが可能でしたが何か方法が ありますでしょうか？
Windows 7で Excel 2010 のVBAを使い、あるアプリケーションの出力結果 (バイナリデータ) が正しいかチェックしようとしています。 その結果が 2GBバイト以下の場合はうまくチェックできており、実績があります。 ところが 2GBを超えると下記の Get文で「レコード番号が不正です」というエラーメッセージが出て中断してしまいます。 おそらく Get文の VBA内部のポインタが Long型で、オーバーフローしてしまうのだと想像しています。 Dim a(1024) As Byte Dim d as double Open "バイナリデータ.dat" For Binary Access Read As #1 For d = 1 To ((1024 * 1024) * 10) ' 10GBファイルを1KBずつ読み込みするループ処理 Get #1, , a '～ a の内容チェック処理 (略します) ～ Next d Close #1 なお、実績のあるチェック処理は、そのまま使いたいので他の言語は利用したくないと思っています。 (会社なので、VB や VC を購入するにも、稟議の日数がかかってしまうのです) 別の試みで Get の代わりに INPUTB()関数を、試してみましたがバイナリデータにヌル &H0 などが含まれているので、読み込みができません。 (それは INPUTB()関数の仕様のようです) なにか良い解決方法をご存じの方がいらっしゃいましたら、宜しくおねがいします。
VBAでの新規シート作成について VBA初心者です。Excel2007、XPを使用しています。 シート1のA列からCP列まで、約1000行データがあります。 1行目は見出しです。 その中でCP列の値が同じ行のみ、 別シートの各位置、見出し行+最大10行としてに表示したいです。 最低でも同じ値が各2行はあります ちなみにA列とCP列は同じ値なので、A列で判別しても問題ないです。 (例) Sheet1 A... / CN / CO / CP 項目1... / 項目92 / 項目93 / 項目94 1111 / 品名1 / ○ / 1111 1111 / 品名2 / ○ / 1111 1222 / 品名3 / ○ / 1222 1222 / 品名4 / ○ / 1222 1222 / 品名2 / ○ / 1222 1333 / 品名3 / ○ / 1333 1333 / 品名4 / ○ / 1333 →Sheet2 AA... / DN / DO /DP. 項目1... / 項目92 / 項目93 / 項目94 1111 / 品名1 / ○ / 1111 1111 / 品名2 / ○ / 1111 AA53から 項目1... / 項目92 / 項目93 / 項目94 1222 / 品名3 / ○ / 1222 1222 / 品名4 / ○ / 1222 1222 / 品名2 / ○ / 1222 AA105から 1333 / 品名3 / ○ / 1333 1333 / 品名4 / ○ / 1333 といったように、52行ずつずらした位置に表示したいです。 A列からU列の間に明細を表示しており、 そちらに参照する行として、隣に表示を出来ればと思っております。 恐れ入りますが、ご教授頂けないでしょうか。 宜しくお願い致します。
VB.NET Excelシート上のラベルコントロールのTextプロパティを変更する方法について どなたかご教授願えますか？ objSheet.Control(labelname).Text = "変更したいラベル名"
VBA超初心者です。 ですが急ぎなので申し訳ありません。 シート１には、500個くらいの氏名が様々なセルに散らばっています。 シート２のA列には、シート１の500個くらいの氏名が入っています。 シート２のB列には、A列の氏名のフリガナが入っています。 やりたいことは以下の内容です。 シート２の表（Ａ列Ｂ列）を使って シート１の氏名の上にフリガナを挿入することは可能でしょうか。 エクセルのフリガナの機能を使うと、最近のキラキラネームのような変換されない文字が フリガナとして出てきてしまいます。また一つ一つ修正するのはかなり大変なので せっかくあるシート２の名簿（Ｂ列は正しいフリガナになっています）を使えないかと 思い、ご質問させていただきました。
初心者です。参考書に沿ってVBAの勉強をしています。 Sub test() ThisWorkbook.Worksheets("Sheet1").Cells(1.1)="VBA" Next i End Sub こちらを標準モジュール内に書き込んだところ題名のようなエラーが発生しました。 VBAに慣れている方に相談したのですが、その方もわからないようなのでこちらに質問させていただきました。 シートの名前は正しいはずです（初期から変更していません） アドバイスお願いします
いつも大変お世話になっております。 VBAについてご教示ください。 現在、手元にSheet1のデータがあります。 下記の条件の下、Sheet1のD2:D4のデータ(即ち、Sharesのデータ)をSheet2に自動的に反映させたいのですが、その時どのようなVBAコードで可能となるかご教示ください。 Sheet1の状況およびVBA作業後のSheet2は下の画像をご覧ください。 条件： 1) Sheet1はダウンロードした数値・情報で、特定のセルを手作業で動かすなどこのシート上のマニュアル操作はないものとします。 2) 現在のSheet1ではSheet2に反映するのは3セルだけですが、この数は変動するものとします。(つまり、現在はRow1-3のみですが、Row1-50など数が多くなる場合もSheet2に反映されるようにしたいのです。) 3) Sheet2のAAA,BBBなどの名前は入力されていますが、必ずしもSheet1の名前と一致しません。名前の最初の方は一致するものとします。(例えば、Sheet1ではAAA PLCとありますが、Sheet2ではAAAと表示されています。)また、Sheet2では必ずしも名前がアルファベット順になっているとは限りません。 4) 緑に網掛けする必要はありません。画像ではお伝えしやすく緑の網掛けにしています。 初心者の質問で大変申し訳ございませんが、お力をお貸しください。 どうぞよろしくお願い申し上げます。
こんにちは。 当方マクロ初心者で、教本を片手にマクロを組んでいるレベルです。 宜しければご回答お願いします。 質問はタイトルにあるように、 「読み込んだcsvファイルの名前を別名保存のファイル名に使いたい」 ということです。 マクロ有効のエクセルファイル（abc.xlsｍ）に、csvファイル(123.csv)を取り込む ※GetOpenFilenameというマクロでcsvファイルを取り込んでいます（マクロボタンを設置） ↓ 取り込んだcsvデータで集計等の作業をする ↓ 作業が終わったマクロ有効エクセルファイル(abc.xlsｍ)を「別名をつけて保存」する ※この時、保存ダイアログボックスに読み込んだcsvファイルの名前が自動で付与される（123.xlsｍ) ようにしたいです。 なお「別名をつけて保存」はエクセルファイル（abc.xlsｍ）上にマクロ実行用のボタンを設置して使用する予定です。 （ボタンで実行させるのはエクセルに不慣れな方も使用する為です） 説明が下手でやりたいことがうまく伝わっていないかもしれませんが、、、 よろしくご教授くださいませ。
売上伝票（複写式で合計４枚）のEXCEL化を検討しております。ご教授ください。 EXCELの構成は、シート１で複写の１枚目（一番上の用紙）の全項目を記入する。 　　　　　　　　シート２で２~４枚目の必要な項目のみ１枚目からコピーして記入します。 シート１枚につき、記入できる商品数が６点のため、７点以上のご注文時には、 シートが２枚、３枚・・・と増えていきます。 その際、ファイルが分かれると、管理がしづらいため、 １つのファイル内でシートを追加しての対応を検討しています。 現在、マクロを登録し、ボタン（フォームコントロール）に割り当てて使用しています。 マクロ１：シート１の内容をシート２に転写する。 マクロ２：シート２をＡ３用紙に出力する。 マクロ３：シート１・２をコピーしシート右端に、シート３・４を追加する。 　　　　　このとき、商品記入欄のみ削除するようにしています。 ※シート１にマクロボタンを３つ配置して、シート２にはマクロありません。 　シート追加するとシート３にマクロボタンを配置し、シート４にはマクロなし。 　シート３のマクロは、シート４に対して実行される。 マクロ１・２の実行では、不具合は発生しないのですが、 マクロ３を実行すると、シート１・３のマクロ１やマクロ３のボタン名が『ボタン１３』などと 初期値に戻り、ボタンも押せなくなります。 マクロに関して全くの初心者のため、できるだけ簡単に解決できると助かります。 皆様のお知恵をお借りしたいのですが、何卒、宜しくお願いいたします。
こんにちは 以前”特定の行を選択して別シートにコピー”の題目でご質問させて頂いた者です。 ご教示頂いた皆様のおかげで何とか思ったようなマクロが組めたのですが、今度は その抽出したデータを既存データの後ろに追加（挿入）することをしたいと考えております。 お時間のある方、ご教示頂けますでしょうか。 条件として ・追加（挿入）する行数は都度変わります。※特定の行の数とイコールです。 ・追加（挿入）するシートは別シートとなります。 ・出来れば、貼り付け先シートの書式を変えない方法があるとありがたいです。 （これは可能な限りで構いません。） お手数をお掛けしますが、何卒、よろしくお願いいたします。
perlでマイクロソフトAccessのaccdbに接続したいのですが。方法が分かりません。本を購入したいのですが。その本の名前すら分かりません。 ネットで検索しましたが。これと言った物が検索出来ませんでした。出来れば、 本の名前 ネットで紹介しているURL その物ずばりのperlのソースコード 上記の何れかを提示願います様、宜しくお願いします。
XPのときに作ったVBAがあります。７に変えたとたん”DLL読み込み時エラー”がでました。 原因は何でしょうか？VBAはAgilent社の測定器を動かすものです。
いつもお世話になります B13からAE150までの可変表があります。13行目はタイトルです。 ユーザーフォームでリストボックスから選択した値をJ列の一番下に入れたいのですが上手くいきません。（J列の途中には空白有ります）下記のコードはどこか間違えてますでしょうか？ 未だにこんなところで躓いております。 どなたかご指摘頂ければ幸いです。 Private Sub CommandButton1_Click() Dim LastRow As Long With Worksheets("顧客台帳") LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row + 1 .Cells(LastRow, 10) = Me.ListBox1.Text End With Unload Me End Sub
新ブックを作成し、このブックに　ほかのブックの複数シート(一つのシートのこともある)を 追加しようとしています。 追加するシートをもつブックを　Abc.xlsx とし、そのシート　(　DataS(シート数) 、シート数は CountS　)　を　新ブックの　D:\Temp.xlsx へ　追加する場合です。　 次のマクロ内容を実行すると、 ***** 新BOOK作成 ***** ActiveWorkbook.SaveAs fileName:="D:\Temp.xlsx" ' For a = 1 To CountS Workbooks("Abc.xlsx").Sheets(Trim(DataS(a)).Copy before:=Workbooks("Temp.xlsx"). _ Sheets(a) Next a ' 次のエラーが出ることがあります。 『実行時エラー '-2147417848(80010108)': オートメーション　エラーです。 起動されたオブジェクトはクライアントから切断されました。』 何回も、別の　ブックの　シートを　追加する時に、一回目は　問題ないが、二回目に　この エラーがでることがあります。 エラーが出た後、一旦、この実行ブックを閉じて、再起動すると、ＯＫとなります。 エラーの原因が、このマクロ部分のみの影響によるのかどうか、ということも　ありますが、 単純に、このマクロだけで、このエラーが起こる、ということは　あるのでしょうか？ Windows 8.1 Excel 2013 の 場合は、以前は、このエラーは起きていなかったのですが、今回 以前と違うマクロを作成した時に　このエラーが起きるようになりました。 以前は、Windows With Bing Excel 2013 では　このエラーが　起きることがありました。 このエラーの　発生が　どのような場合に　起きるのか、回避方法　は　どうすれば　いいのか お教え願えませんでしょうか？ 内容不十分かも、わかりませんが、よろしく、お願いします。
プロジェクトオイラーというサイトがあります。 https://projecteuler.net/ 数学的なクイズを出題するサイトで、手計算だけでは解けずプログラム併用を必須とする問題ばかりです。しばらくは遊んで数十問ほど解きましたが。。。 Basic使用者はごく少数でC++やJavaが多く、正解すると他正解者のプログラム紹介等を見れるようになってますが、ごくごくシンプルなプログラムで解いてます。極端な例では２，３行、確かRuby。調べてみるとVBAは関数の数値範囲が狭く、他言語ではメモリ範囲内で無限なんていうのもありました。数列で値が1000桁に達する添え字を求めよとか、なかなか歯ごたえある問題ばかりだと思ってましたが、Basic以外ではすんなり解いてるようなのです。 要するにVBAの数値範囲が狭い、あるいは遅いがために工夫して解く部分が多過ぎるのです（これも楽しみと言えなくもありませんが）。この先、500問もの問題を解くというのに２桁レベルで躓いており、他言語ではこんなに簡単に解いてる、モチベーションが一気に下がりました。プログラム紹介見なけりゃよかったと後悔してます。 みなさんだったら、どうします？乗り換えますか？VBAだけで解けそうですか？ 愚痴みたいな質問ですみません。
VBA初心者です。Excel2007、XPを使用しています。 シート1のA列からH列まで、数千行データがあります。 1行目は見出しです。 その中でG列に値が入っている、且つH列に指定文字以外の時、 D～Hを新規シートに表示したいです。 (例) D　/　E　/　F　/　G　/　H ID　/　名前　/　品名　/　文言　/　メーカー 123456　/　名前1　/　　/　A社 678910　/　名前2　/　○　/　B社 111213　/　名前3　/　　/　C社 141516　/　名前4　/　×　/　D社 →新規シート[B社] 678910　/　名前2　/　○　/　B社 →新規シート[D社] 141516　/　名前4　/　×　/　D社 こういった動作は可能でしょうか。 恐れ入りますが、ご教授お願い致します。
初めて質問させて頂きます。 エクセルで入力規則のリストを作成し、そのリストの中から複数選べるようにしたいのですが調べたところＶＢＡとやらを使わないといけないようで・・調べましたが詳しくないので全然わかりません。 どなたかお知恵を貸してもらえないでしょうか？ これが出来るとアンケートを集計しているのですがかなり助かるのです。 エクセル詳しくないので初心者に教えるよう細かく教えて頂けるとありがたいです。 宜しくお願いします。（入力規則のリストは作成できました） （画像を添付しております。）
とあるアプリケーションを引数付きで実行したものを、既定のプログラムから開くにて指定したいのですが、いかがすればよろしいのでしょうか？ ショートカットにて引数を指定したものを作ったのですが、ショートカットは規定のプログラムとして設定することができないようなので質問させていただきました。 どうか回答をよろしくお願いします。
いつもお世話になります、 フィルターがついたままファイルを上書きして保存しようとする際に フィルタ解除して下さい というようなメッセージを表示させたいのですが そんな方法はあるのでしょうか？ おそらくシートにコードを書くのだと思いますが お時間ある方いらっしゃいましたら、ご教示願います。
私のパソコンのExcelは2000です。 新しいExcelで作ったデータを古いExcelで使うためのファイルの保存方法があると聞きました。それはメールで受け取った新しいExcelのデータを私パソコンで古いExcelで使うファイルに直す方法はありますか？ すみません、よろしくお願いします。
教えてください。 excelファイル内にあるA1及び、A5からF600までのデータを、保存場所を指定したcsvファイルに常に強制上書き保存をする(確認画面なし)VBAの書き方が分かりません。 ファイル名はシート名を取得したものとします。 これにできる事なら、A1で取得した文字列はA1からA600までペーストし、A5からF600のデータをB1からG600にペーストしたいと思ってます。 一つ一つは検索して可能なのは判ったのですが、組合せると上手く実行できずにいます。 ご協力の程をお願い致します。
剰余をコンピュータで効率よく算出する方法を教えていただきたいです。 x-int(x/y)*yと同様にすれば比較的簡単に求められることは知っているのですが、計算対象が64266330917908644872330635228106713310880186591609208114244758680898150367880703152525200743234420230進数で整数部だけで最大268435456桁というデータ型の為、不用意に割り算や掛け算をしたくないというところがあります。 何か良い方法はないでしょうか。 参考としてJavaにあるBigDecimalの有効桁数が約64643000桁程度に対して計算対象は10進数に変換すると約3000000000桁程度になるので50倍弱の精度のデータを計算してしまう危険があります。
A B C D E　５枚のカードがあり、これらを１列に５枚全部並べる時の並べ方は５！通りです。この５！通りの文字列をVBAで作成したいのですが、アルゴリズムからして思いつきません。並べ替え規則というか方法を教えて下さい。
同じフォルダにある『ScreenShot_XXXX.XX』（※XXXX.XXは日付）という複数ファイルを『XXXX.XX』という風に頭の『ScreenShot_』だけを削除するVBScriptが作りたいのですが、コードはどのようにすれば実現できるでしょうか。 ご存じの方、アドバイスをお願いします。
1行の文字列の中に半角の　"　が入っているところが始めから何番目かを知りたいのです。 For j% = 1 To l% If Mid$(dat$, j%, 1) = Chr$(22) Then n%=j%：Exit For Next j% でいいのですか？
Sheet2のA列のセルの値をSheet1のI3セルに転記、Sheet2のE列のセルの値を　Sheet1の　A2からの結合セルの最終セルに転記したいのですが、なんだか滅茶苦茶で訳わからなくなりました。 お時間ある方で、下記のコードを修正していただける方いらっしゃいましたらよろしくお願いします。 Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) If Target.Column = 1 Then [Sheet1!I3] = Target.Value End If If Target.Column = 5 Then [Sheet1!A2] = Target.Value While Selection.Item(1) <> "" Selection.Offset(1, 0).Select wend End If Sheets("Sheet1").Activate End Sub
accessのインストールされているＰＣでプログラムを作成し、accessのインストールされていないＰＣで入力したいので、accessランタイムをＤＬしましたが開くことができません 開いて使えるようにならないでしょうか ｗin７、access2007の環境です
http://d.hatena.ne.jp/purukyawa/20110715/1310711 … 一応ここは見つけたんですが　停止のとこのほうができません!! どうすればよいのでしょう　できるだけわかりやすく教えてくれると幸いです!!
超初心者なのでわかりやすくお願いします！ バッチファイルのコマンドでyes/noをきいて y＝ナントカの動作をする n=yではないナントカの動作をする みたいな感じにできないでしょうか。 できれば書式を書いて、くれればうれしいです。 お願いします。
フォルダ内に同一フォームで行数が異なる複数のファイルがあります。(20個)データがあるのは、sheet1だけです。それぞれのファイルのシートのタイトル行以下を新規ブックの1シートにまとめるため、同じ事をしたい方の質問の答えにあった以下のマクロを実行しましたが、RR.Copy Dst の部分で、次のようなエラーになってしまいます。エラーになったあとは、エクセルが固まりタスクの終了にしなければいけない状態です。新規ブックに一つ目のファイルのシートのデータはペイストされていますが、そこでディバックになります。VBAは初心者なので、解決策をどなたか教えていただけないでしょうか？ 実行時エラー '-2147417848 (80010108)': copyメソッドが失敗しました。rangeクラス. Sub test() 'このブックと同一フォルダ内のブックの、１シート目の３行目以下を、 '新規ブックの１シートにまとめる Dim Book As Workbook Dim Fpath As String Dim Fname As String Dim RR As Range Dim Dst As Range Fpath = ThisWorkbook.Path & "\" Fname = Dir(Fpath & "*.xls") Application.ScreenUpdating = False Do Until Fname = "" If LCase(Fname) = LCase(ThisWorkbook.Name) Then Else If Dst Is Nothing Then Set Dst = Workbooks.Add.Worksheets(1).Range("A1") End If Set Book = Workbooks.Open(Fpath & Fname) Set RR = Book.Worksheets(1).UsedRange Set RR = Intersect(RR, RR.Offset(2)) RR.Copy Dst Set Dst = Dst.Offset(RR.Rows.Count) Book. Close False End If Fname = Dir() Loop Application.ScreenUpdating = True MsgBox "完了！" End Sub
Excel2010のVBAでAutoFilterの全条件を取り出す方法が分かりません。どうすればいいのでしょうか？
最近は本当にお世話になっております A列には１から連番で数字が入っています。 で、B列の最終セルの下のセルを取得した後、隣のA列の数字を取得してメッセージボックスで「150です」とか出てくるような方法があればどなたか教えて頂きたいです。 Sub 取得() Range("B1048576").End(xlUp).Offset(1).Select Selection.End(xlToLeft).Select このあとが続きません・・・・ お時間ある方いらっしゃったら、よろしくお願い致します。
ExcelのVBAを最近始めました。 ユーザーフォームのことについてなんですが，二つのテキストボックスを用意し，ひとつのテキストボックスに検索したい番号をいれてボタンを押すと片方のボックスにその検索結果が出るようにできませんか？ 検索の仕方はワークシートの数値をvlookupで検索するような形で。 (例：画像のようにA列にNo.　B列になまえがあり，No.で検索をかける) 要するにD2:E3の処理をユーザーフォームでしたいです。 不可能なら「不可能」と可能ならその記述の仕方を教えてください。 しっかりとVBAを理解していないのでわかりやすく教えてください。
エクセルの参照設定ですが、マイクロの　HTML Object Library と　Internet Controls を　使っています（これ以外も有るのですが） 2013に成ってからの様な気がするのですが、配布先の環境で、これが、途切れるというか、参照できない事がおきます。2013までは、OSや（いっても、7か8.1のこと）　エクセルの2007,10　意識せずに配布して、動いていたように思うのですが、 エラーが出ると、参照設定を外して、そのマシンで参照設定を行うと、以降　不問です。 そうした事をきらって、インストール作業の無いエクセルのVBAで作ったのですが・・・・ で、モジュールで、参照設定の宣言が出来れば、解決するかと思っているのですが、如何でしょう。 その方法をご存じあれば、よろしくどうぞ。 また、別の方法で解決できればそれでも、結構かと・・・・
VBAで objIE を使用して Webページ中の javascript を実行したいのですが、 onclick="~~" の記述がないケースがあり困っております。 例えば以下のような記述です。 <a href="javascript:;" pnb="~~" scdaction="~~" bulkaction="~~" id="~~">~~</a> onclick の記述がない上記のようなケースでは、javascript の呼び出しはどのようにすればよいのでしょうか？ 不可能でしょうか？
Quick Test Professional（QTP）を使用して社内サーバー（Webブラウザ）より複数ExcelファイルをDLするコードをVBScriptを使用して作成しています。 ただVBScriptもQTP上で多少制限があり、完全に同じではないようです（申し訳ございません、当方もQTP及びVBScriptを始めたばかりのため把握ができていない状況です）。 QTPから記録機能を使用している箇所もあります。 そのような状況でDLしたファイルが希望したものではなく、行き詰まっております。 お知恵を拝借いたしたくお願いいたします。 ※「Download Data.xlsx」というExcelファイルにDLしたいファイルの情報やログインユーザー情報などを記載し、そこから取得しています。 一部下記リンク先を参考にさせていただきました。 http://q.hatena.ne.jp/1297409549/ Const adTypeBinary = 1 Const adSaveCreateOverWrite = 2 Set obj = CreateObject("Excel.Application") obj.Visible = True obj.Workbooks.Open "C:\Users\XXXXX\Desktop\Download Data.xlsx" With obj.Workbooks("Download Data.xlsx").Worksheets("Sheet1") .Activate uName = .Cells(2, 1).Value 'ユーザーID pWord = .Cells(2, 2).Value 'パスワード MaxRow = .UsedRange.Rows.Count For i = 2 To MaxRow getURL1 = .Cells(i, 3).Value 'DLしたいExcelファイルのURL getPath = .Cells(i, 4).Value 'DLしたファイルを格納するデスクトップ上のフォルダ getFL = .Cells(i, 5).Value 'DLしたいExcelファイルの名前 getURL2 = .Cells(i, 6).Value 'DLしたいExcelファイルの上位階層のURL SystemUtil.Run "C:\Program Files\Internet Explorer\iexplore.exe", getURL2, "", "" 'ieの起動 Browser("XXXXXX").Page("XXXXXX").WebEdit("username").Set uName Browser("XXXXXX").Page("XXXXXX").WebEdit("password").Set pWord Browser("XXXXXX").Page("XXXXXX").WebButton("ログイン").Click sSource = getURL1 '※コメントアウトにしている紆余曲折があるため意味のない置き換えをしています… dName = getFL '※コメントアウトにしている紆余曲折があるため意味のない置き換えをしています… '指定したデスクトップ上のフォルダに保存 Set ws = CreateObject("WScript.Shell") '特殊フォルダ名の取得 desktopDir = ws.SpecialFolders("Desktop") 'デスクトップの実体 sDest = desktopDir & "\" & getPath & "\" & dName 'コピー先 Set oHTTP = CreateObject("Msxml2.XMLHTTP") oHTTP.Open "GET", sSource, False oHTTP.Send Set Stream = CreateObject("Adodb.Stream") Stream.Type = adTypeBinary Stream.Open Stream.Write oHTTP.responseBody Stream.Savetofile sDest, adSaveCreateOverWrite Browser("XXXXXX").CloseAllTabs Set Stream = Nothing Set oHTTP = Nothing Set ws = Nothing Next obj.Quit Set obj = Nothing End With 動作はエラーもなく完了し、Excelファイルも保存できましたが、そのファイルはオリジナルよりサイズが小さく、拡張子が違うとエラーが出て開くことができません。 参考とさせていただいたリンク先は画像ファイルをDLするもので、ExcelファイルをDLする場合実際は「『開く』『保存』『キャンセル』」を選択するメッセージが立ち上がり、ieのURLアドレスバーはExcelファイルのものが入力されていますが、画面はログイン画面のままです。 恐らくそのログイン画面をExcelで保存しているものと思われます。 指定したExcelファイルのアドレスからそのファイルを取得したいのですが、どのように改修すればいいのかわかりません。 このままのコードを修正してできるのであればその方法を、もし「『開く』『保存』『キャンセル』」の選択メッセージから保存を選びDLするしかないのであればその方法及び格納フォルダ指定の方法をご教示いただきたく、よろしくお願いいたします（QTPの記録でその格納先指定が上手くできなかったため上記のようなVBScriptを使用して作成しております）。 動作環境 OS win7 QTP 11 ie 8
こんにちは VBAで文字列を処理するプログラムを書いていますが、シングルクオート(8217)が使えずに困っています。シングルクオートを出そうとすると全角のアポストロフィのような文字になって、8217になりません。 どうしたらよいでしょうか。 Windows 7 Pro 64bit
どなたか助けてください。 以前、以下のVBAを利用して障害管理を行っていましたが 数年ぶりに利用しようとしたところ動作しなくなっていました。 ネットで調べて分かったのですが、Office2007以降、 FileSearchオブジェクトが使用不可になったことが原因のようです。 出来れば下記をどのように変更すれば Excel2013で動くようになるか教えて頂けないでしょうか？ ※文字数制限のため、処理の一部（転記処理）を削除しています ---------------------＜VBA文＞------------------------- Private Sub GetFiles_Click() '-障害管理表の更新を行う- '　指定したフォルダ配下に存在する「障害処理票」をサーチし、その内容を一覧表示する。 Dim objWBK As Workbook ' ワークブックObject Dim strPATHNAME As String ' 指定フォルダ名 Dim strFILENAME As String ' 検出したファイル名 Dim motoSH As Worksheet Dim sakiSH As Worksheet Dim DtCnt As Long Dim currentCell As Range Dim wkBuff As String Beep If MsgBox("指定するフォルダ内の障害票の情報を再取得します。よろしいですか？" & Chr(13) & Chr(10) & "※シート内の情報はクリアされます", vbQuestion + vbOKCancel, "") = vbCancel Then Exit Sub End If DtCnt = 9 Set sakiSH = ThisWorkbook.Sheets("障害管理表") '転記先のシート sakiSH.Range("B9:O1000").ClearContents 'フォルダを指定 Dim Folder As Object Set Folder = CreateObject("Shell.Application"). _ BrowseForFolder(0, "障害票が存在するフォルダを指定してください", 0) If Not Folder Is Nothing Then strPATHNAME = Folder.Self.Path & "\" Set Folder = Nothing Else Set sakiSH = Nothing Set Folder = Nothing Exit Sub End If Application.StatusBar = "転記処理の実行中です・・・（時間がかかりますので、しばらくそのままでお待ちください）" Application.ScreenUpdating = False ' 指定フォルダ内のExcelワークブックのファイル名を参照する(1件目) strFILENAME = Dir(strPATHNAME, vbNormal) Set FS = Application.FileSearch With FS .NewSearch .LookIn = strPATHNAME .Filename = "*_障害処理票.xls" .SearchSubFolders = False .Execute For i = 1 To FS.FoundFiles.Count ' ワークブックを読み取り専用で開く Set objWBK = Workbooks.Open(Filename:=.FoundFiles.Item(i), UpdateLinks:=False, ReadOnly:=True) Set motoSH = objWBK.Sheets("障害処理票") 'シート名指定 'ファイル名＝管理番号として転記（アンダーバー以下は削除） wkBuff = "" wkBuff = Left(strFILENAME, InStr(1, strFILENAME, "_") - 1) '受付済みかどうかチェック If StrComp(motoSH.Range("AY4").Value, wkBuff) <> 0 Then sakiSH.Cells(DtCnt, 2).Value = "未受付" Else sakiSH.Cells(DtCnt, 2).Value = wkBuff End If '画面名を転記 sakiSH.Cells(DtCnt, 6).Value = motoSH.Range("L18").Value '障害概要を転記 sakiSH.Cells(DtCnt, 7).Value = motoSH.Range("K19").Value '調査者を転記 sakiSH.Cells(DtCnt, 8).Value = motoSH.Range("K20").Value '障害原因を転記 sakiSH.Cells(DtCnt, 9).Value = motoSH.Range("K21").Value ' 開いたブックをClose objWBK.Close SaveChanges:=False Set objWBK = Nothing Set motoSH = Nothing DtCnt = DtCnt + 1 ' 次のファイル名を参照 strFILENAME = Dir Next i End With Application.StatusBar = False Application.ScreenUpdating = True Set sakiSH = Nothing End Sub
AccessVBAのサブフォームで、指定した値の項目を先頭に表示したい。 例えば、サブフォームに1～100の値が縦にある場合、50と指定したら、50をサブフォームの 先頭に表示したいのですが。 宜しくお願い致します。
お世話になります。 Excel2010でAccess2007へのデータ接続をしています。 検索内容毎に基本のクエリから必要なデータをクエリとして作成し、その結果を取得したいと思っております。複数作成したクエリは名前の頭に「”出力用”＋連番」で設定し、データが０のものは削除済みです。 Set dbCon = New ADODB.Connection Set dbRes = New ADODB.Recordset Set dbCmd = New ADODB.Command Set dbCat = New ADOX.Catalog ～この間でクエリを作成、また0件のクエリは削除の処理～ dbCat.ActiveConnection ="Provider=Microsoft.ACE.OLEDB.12.0;Data Source="　&　”データベースのパス” For Each obj In dbCat.Views If InStr(obj.Name, "出力用") <> 0 Then If sql = "" Then sql = "SELECT DISTINCT　* FROM " & obj.Name Else sql = sql & ", " & obj.Name End If Next obj Set dbRes = New ADODB.Recordset dbRes.Open sql, dbCon, adOpenStatic, adLockPessimistic 上記の最終行のところで「クエリが複雑すぎます」でエラーになります。 すべてのクエリの重複しないデータを取得する方法はないでしょうか？ よろしくお願い致します。
質問タイトルの通りですが、詳しく書くと↓ ＜やりたいこと＞ あるExcelファイル(Aとする)でマクロを有効にした時に、自動で、Aと同じフォルダにある複数のパスワード付ブックを読み取り専用で開く。 ＜条件？＞ ・同じフォルダに複数のパスワード付ブックがある。(ファイル名はバラバラ) ・パスワードはすべて共通。(Password=1111) 以下のようなコードを考え、ThisWorkbookに入れてみたのですが、思うような動作にならず・・・ -------------------------------------------------------------------------------------- Private Sub Workbook_Open() Dim FileName As String Dim OpenedBook As Workbook Dim IsBookOpen As Boolean FileName = Dir("*.xlsx") Do While FileName <> "" If FileName <> ThisWorkbook.Name Then IsBookOpen = False For Each OpenedBook In Workbooks If OpenedBook.Name = FileName Then　'既にブックを開いていた時の処理 IsBookOpen = True Exit For End If Next If IsBookOpen = False Then Workbooks.Open FileName, ReadOnly:=True, Password:="1111" End If End If FileName = Dir() Loop End Sub -------------------------------------------------------------------------------------- どこをどのように修正したらよいのか、教えて頂けると幸いです。
VBA初心者です。フォルダ内のbookに対して連続で処理を行うマクロを 作成してみたのですが、”○○.xlsxが見つかりません”とエラーが表示されます。 どのように修正すべきでしょうか？ Dim file As String Application.ScreenUpdating = False file = Dir("フォルダパス\*.xlsx") Do While file <> "" Workbooks.Open file 任意処理 ActiveWorkbook.Save ActiveWorkbook.Close file = Dir() Loop End Sub
おかしな質問内容ですが 2013で　あるBOOKを開いて、保存終了します。しかし、本体BOOKは保存されますが、エクセルのフレームだけ残って終了できません（コマンド他　終了のＸも有りません）。タスクマネージャーを見ると、エクセルが残っています。そこで終了するか。フレームだけの時、中で右クリックで、新規作成が出るので、そこでやっと、コマンドラインが並び　Ｘ終了も表示されます。 オプションの中をのぞいても、それらしきものも無く・・・ 思い当たる操作は、セル式をコピーする時、他のBOOKを開き、式を横、数列をコピーしましたが、その折、リンクなったのを気がつかずセーブ。再度開いた折、データ追加でコピー元にデータがなく、エラーに成って、気づきました。 で、置換で　”ｃ：***”、を””で　シートの中のリンクをすべて消しました。 さて、打つ手は、如何でしょうか？ もともと、2013を　複数BOOK起こす時　それまでと、変更になった（基本、複数は無理やり・・・）これが　そもの問題と思うのですが
おはようございます。 excel vbaで●を数えるコードを教えてください。関数ならばcountifで出来ると思いますが vbaで数えるコードが知りたいのです。worksheet_changeを使ってa3:a10の間の●を数えてa11に表示する。Ｂ列、Ｃ列も同じようにあります。 ご教示よろしくお願い致します。
タイトルの件ですが、現在CSVよりIDとPWを読み込み、Webページに自動ログインできるVBSを作成しております。 ネットの情報を頼りに下記ソースを作成し、自動ログインできるところまでは達成しました。 しかしながら、一回目の実行時はいいのですが、二回目以降時間を置かずにVBSを起動すると エラーが発生します。（IEは起動し、ログイン自体は出来ます） 本エラーの回避方法をご教授願えませんでしょうか。 エラーの発生場所は objIE.Document.getElementsByName("username")(0).Value = SiteID あたりだとは思うのですが、何が原因かがわからなく。。 ○エラーメッセージ エラー：オブジェクトがありません。：'objIE.Document.getElementByName(...)(...)' コード：800A01A8 ソース：Microsoft VBScript 実行時エラー ○コード 'Option Explicit Dim tmp 'CSV格納 Dim tmp2 'CSV分割 Dim SiteArray(10) 'ID,PW,URL格納 Dim SiteURL 'URL格納 Dim SiteID 'ID格納 Dim SitePW 'PW格納 Dim i dim objFSO dim stmCsvFile 'URL,ID,PWをCSVより読込 Set objFSO = CreateObject("Scripting.FileSystemObject") Set stmCsvFile = objFSO.OpenTextFile("C:\Users\***\Desktop\login.csv") Do Until stmCsvFile.AtEndOfLine = True tmp = stmCsvFile.readline tmp2 = Split(tmp, ",") SiteArray(i) = tmp2(1) i = i + 1 Loop stmcsvfile.Close 'URL,ID,PWを格納 SiteID = SiteArray(1) SitePW = SiteArray(2) SiteURL = SiteArray(0) '---------- ひらく Set objIE = CreateObject("InternetExplorer.application") objIE.Visible = True objIE.Navigate SiteURL Do Until objIE.busy = False And objIE.readyState = 4 : Loop '待ち合わせ '---------- ID/PASSの入力 objIE.Document.getElementsByName("username")(0).Value = SiteID objIE.Document.getElementsByName("password")(0).Value = SitePW '---------- SUBMIT objIE.Document.getElementsByName("login_form")(0).Submit Do Until objIE.busy = False And objIE.readyState = 4 : Loop '待ち合わせ '---------- 宜しくお願い致します。
お世話になります。とても困っているため質問させていただきました。 エクセルのマクロについて質問させてください。 ”グラフ”と”表”の2シートの値を順番にPPTにはりつけるマクロをかきましたが 「1004 アプリケーション定義またはオブジェクト定義のエラーです。」となるときがあります。 ソースは以下になります。↓↓　この処理を30回繰り返す処理にしております。 On Error GoTo ERROR_HANDLER dim st_row as integer dim end_row as integer Set ppApp = CreateObject("PowerPoint.Application")　’powerpoint Set ppPst = ppApp.ActivePresentation Set grp = Worksheets("グラフ")　'エクセルのシートグラフ用 Set cht = Worksheets("表")　'エクセルのシートグラフ用 '*①------------------- grp.Activate　’グラフシートをアクティブに '指定範囲をクリップボードにコピー grp.ChartObjects(1).Copy 'PowerPointスライド指定 Set ppSld = ppPst.Slides(1) '貼り付け ppSld.Shapes.Paste '位置・サイズを補正 With ppSld.Shapes(ppSld.Shapes.Count) '最終シェイプを処理 '.LockAspectRatio = msoTrue '縦横比固定 .Top = 150 '上からの位置 .Left = 5 '左からの位置 End With cht.Activate　’表シートをアクティブに '指定範囲を取得する st_row = cht.Range("B" & end_row).End(xlDown).Row end_row = cht.Range("H" & st_row).End(xlDown).Row '指定範囲をクリップボードにコピー cht.Range("B" & st_row - 1 & ":H" & end_row).Select Selection.CopyPicture xlScreen, xlPicture 　’エクセルの表をパワーポイントに貼付する処理を呼び出す 　Call set_chart(1, "1") '*①------------------- '*②------------------- ’エクセルの表をパワーポイントに貼付する Sub set_chart(setpage As Integer, chkp As String) 'PowerPointスライド指定 Set ppSld = ppPst.Slides(setpage) '貼り付け ppSld.Shapes.Paste If chkp = "1" Then '位置・サイズを補正 With ppSld.Shapes(ppSld.Shapes.Count) '最終シェイプを処理 '.LockAspectRatio = msoTrue '縦横比固定 .Top = 455 '上からの位置 .Left = 5 '左からの位置 End With ElseIf chkp = "2" Then '位置・サイズを補正 With ppSld.Shapes(ppSld.Shapes.Count) '最終シェイプを処理 '.LockAspectRatio = msoTrue '縦横比固定 .Top = 985 '上からの位置 .Left = 5 '左からの位置 End With End If '*②------------------- 単純処理なのですが、オブジェクトの定義の仕方がまずいのかエラーになります。 よい方法をご教示いただけないでしょうか。 何卒宜しくお願いいたします。
特定のHPにExcelマクロでHP上にあるダウンロードボタンをクリックし ファイルをダウンロードする方法を知りたいのですが、ご存知の方がいらっしゃったら お願いします。 現在、構文はここまで出来ております。 ----------------------------------------------------------------------------------- Sub HPからDL() Dim objIE As InternetExplorer Set objIE = CreateObject("InternetExplorer.Application") objIE.Visible = True objIE.Navigate "http********************" ----------------------------------------------------------------------------------- 対象HPには、"CSV出力"のボタンを押せばダウンロード開始されて保存先を指定するように 表示されます。 CSV出力ボタンのソースコードでは下記のように書いてあります。 ----------------------------------------------------------------------------------- </p> <input type="submit" value="CSV出力"/> </p> </form> ----------------------------------------------------------------------------------- "CSV出力"ボタンをクリックするために、ID・name属性が付与されていれば "document.getElementsByName(★)" で検索可能ですが、属性指定がない為 指定ができないので教えて頂ければと思います。
下記マクロは、列を指定してサブプロシージャColumnTreatへ引数として渡し、処理するものです。処理内容は質問と関係ありません。起動したところ　、★位置で「ユーザ定義型は定義されてません」Columnはオブジェクトではないのですか？そういえば今まで見たことない？？と思い質問しました。この形式は出来ないのですか？ Sub test() 　Call CleanUp(colmns("A")) End Sub Sub ColumnTreat(ByRef Tcol As Column)　　　　　’★ 　Dim c As Range 　With Tcol 　　For Each c In Range(.Cells(1), .Cells(Rows.Count).End(xlUp)) 　　　c.Value = 1 'セルごとの処理 　　Loop 　End With End Sub 列指定をLong　(1)あるいはString　("A")で渡す方法もありますが、Worksheetを別途指定する必要があるので、出来れば避けたいです。何かいい方法はないでしょうか？
エクセルで、日にちと時間の引き算をおこない、その経過日時をみたいのです。 条件は次のとおりです。 ・たとえば、2015/8/10 10:00 、2015/8/12 9:00 の経過日時になります。 ・ また、18:00から9:00の間はカウントしない ・ 土日祝日も除外する。 ・ エクセル2013を使用していあｍす。 このような場合の関数を教えていただけませんか。
AccdessVBAでExcelを、タブ指定で開きたいのですが、やり方が分りません。 バージョンは13です。 よろしくお願いします。
エクセルデータシート1 の日付ごとのデータを他のBOOKシートの日付ごとのデータとリンクさせたい。 たとえば シート1の A1に日付 B1に数値 このふたつを他のBOOKシートの日付と同じものとデータを共有したいのですがどうしたらいいのでしょうか？
初めまして。 VBの学習として、VisualBasic認定試験の公式サイトのサンプル問題（１級の２問目、personaldata）と、その模範解答に沿って アプリケーションを作っています。 http://www.sikaku.gr.jp/js/vb/ind/about/sample/ この模範解答のエラーとして、 「Form2でOKを押した時点で、Form1にある全てのDataGridViewのデータが上書きされてしまう」 といった点があります。 この問題を回避したく、以下の点に悩んでおります。 どなたか宜しくお願いします。 ①Form1で宣言し、かつ読み込んだXMLファイルのデータが書き込まれているDataSetを、Form2で呼び出す方法を教えてください。（Form1で、Publicで宣言したのですが上手くいきませんでした・・） ②Datasetで指定したセルのみをXMLファイルに書き込む方法を教えてください。
ネットでいろいろ検索し、試してみましたが自分の思うような仕上がりにならず困っています。 実施したい内容としては、マクロで ①エクセルシートのA2,B2,C2,D2,A4,B4,C4,D4 …A24,B24,C24,D24セルに画像を挿入 ②マクロを開始するとフォルダを選ぶ画面が現れる ③フォルダを選択すると、①にフォルダ内の画像がすべて貼り付けられる ④画像は、セルの大きさに合わせて自動調整される というものです。 1枚ずつを選んでセルに自動調整で貼り付けるということは真似事でできましたが、希望の内容をできるようにしようとすると、かなり難易度が高くお手上げ状態です。 このプログラムをどのように改修すれば可能になるかお教えください。 Sub 図11() Dim strFilter As String Dim Filenames As Variant Dim PIC As Picture ' 「ファイルを開く」ダイアログでファイル名を取得 strFilter = "画像ファイル(*.jpg;*.jpeg;*.gif;*.bmp;*.png),*.jpg;*.jpeg;*.gif;*.bmp;*.png" Filenames = Application.GetOpenFilename( _ FileFilter:=strFilter, _ Title:="図の挿入(複数選択可）", _ MultiSelect:=True) If Not IsArray(Filenames) Then Exit Sub ' ファイル名をソート Call BubbleSort_Str(Filenames, True, vbTextCompare) ' 貼り付け開始セルを選択 Range("B6").Select ' マクロ実行中の画面描写を停止 Application.ScreenUpdating = False ' 順番に画像を挿入 For i = LBound(Filenames) To UBound(Filenames) Set PIC = ActiveSheet.Pictures.Insert(Filenames(i)) '------------------------------------------------------------- ' 画像の各種プロパティ変更 '------------------------------------------------------------- With PIC .Top = ActiveCell.Top ' 位置：アクティブセルの上側に重ねる .Left = ActiveCell.Left ' 位置：アクティブセルの左側に重ねる .Placement = xlMove ' 移動するがサイズ変更しない .PrintObject = True ' 印刷する End With With PIC.ShapeRange .LockAspectRatio = msoTrue ' 縦横比維持 ' 画像の高さをアクティブセルにあわせる ' 結合セルの場合でも対応 .Height = ActiveCell.MergeArea.Height End With ' 次の貼り付け先を選択（アクティブセルにする）[例：5個下のセル] ActiveCell.Offset(5).Select Set PIC = Nothing Next i ' 終了 Application.ScreenUpdating = True End Sub よろしくおねがいします。 ※マクロはほぼ初心者です。大体がネットからコピペをして使っている程度のレベルです。
以下、スタートアップフォームをForm1,子フォームをForm2とします。 そして、Form1にはButton1, Form2にはTextBox1があります。 まず、Form1が起動したと同時にForm2を開きます。 そのあとForm1にあるButton1を押すとForm2のTextBox1に文字が入力されるような機能にしたいのですが、Form2のTextBox1の中身が変わりません。 どのようにすればForm1からForm2のTextBox1へ書き込むことができるのでしょうか？
以下のコードのエラーを解決する方法と、書き方がきれいではない部分をご教示ください。 下のコードで、ワークブックAWBの集計シートから取得したデータを、ReportTypeによって、Book1.xlsmのAAAからFFFのいずれかのシートに貼り付けたいです。 Select caseの手前まではエラーなく進むのですが、Select caseの中に入ると、各貼り付けのところで、アプリケーション定義またはオブジェクト定義のエラーが生じます。 あと、見よう見まねで書いているので、動いている箇所でも書き方が良くない場所があればぜひご指摘ください。 よろしくお願いいたします。 Dim MWB As Workbook Dim AWB As Workbook Dim AnsFolder As String Dim AnsFile As String Dim ReportType As String Dim nRow As Long Dim i As Long Dim temp As Variant Application.ScreenUpdating = False Set MWB = Workbooks("Book1.xlsm") AnsFolder = "C:\test\" nRow = MWB.Worksheets("List").Cells(Rows.count, 2).End(xlUp).Row For i = 3 To nRow AnsFile = MWB.Worksheets("List").Cells(i, 2).Value Workbooks.Open AnsFolder & AnsFile Set AWB = Workbooks(AnsFile) ReportType = MWB.Worksheets("List").Cells(i, 5).Value temp = AWB.Worksheets("集計").Range(Cells(7, 1), Cells(7, 2000)).Value MWB.Activate Select Case True Case ReportType Like "*AAA" MWB.Worksheets("AAA").Range(Cells(i, 2), Cells(i, 2001)) = temp Case ReportType Like "*BBB" MWB.Worksheets("BBB").Range(Cells(i, 2), Cells(i, 2001)) = temp Case ReportType Like "*CCC" MWB.Worksheets("CCC").Range(Cells(i, 2), Cells(i, 2001)) = temp Case ReportType Like "*DDD" MWB.Worksheets("DDD").Range(Cells(i, 2), Cells(i, 2001)) = temp Case ReportType Like "*EEE" MWB.Worksheets("EEE").Range(Cells(i, 2), Cells(i, 2001)) = temp Case ReportType Like "*FFF" MWB.Worksheets("FFF").Range(Cells(i, 2), Cells(i, 2001)) = temp End Select AWB.Close (False) Next Application.ScreenUpdating = True End Sub
エクセルのマクロを最近始めました。入門書に従ってまずはマクロの記録を使って、作業の効率化を図ろうとしています。記録を終了したのちにマクロの編集で確認してみると、以下のようになっていました。 Sub new_sheet() ' ' new_sheet Macro ' ' Keyboard Shortcut: Ctrl+Shift+A ' Sheets("新規シート作成").Select Sheets("新規シート作成").Copy After:=Sheets(2) Range("B1").Select ActiveCell.FormulaR1C1 = "=TODAY()" Selection.Copy Sheets("新規シート作成 (2)").Select Sheets("新規シート作成 (2)").Name = "2015 07 15" Range("B1").Select Application.CutCopyMode = False Selection.Copy Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Range("A2:B2").Select Application.CutCopyMode = False Selection.ClearContents Sheets("2015 07 13").Select Columns("E:AR").Select Selection.Copy ActiveWindow.ScrollColumn = 29 ///以下省略 End Sub ここで質問なのですが、Sheets("2015 07 13").Select以下の部分なのですが、本当は「新規シート作成」sheetのB2セルに入力されている文字列と同一のシート名を検索し、そのシートにおいてSelection.Copy以下の作業をしたいのです。 このときにSheets("2015 07 13").Selectの””内に2015 07 13の代わりにどのようにプログラムを書いたらいいのでしょうか。 完全な初心者の初歩的すぎる質問で恐縮なのですが、教えていただけませんでしょうか。よろしくお願いします。
VB2010の事でお聞きします。 モジュールに下記のコード Public Sub File_Open() FileSystem.FileOpen(1, "c:\Test.txt",OpenMode.Random, , , Len(Dum)) End Sub あるクラスから call File_Open と呼び出したらクラスには戻らずフォームに戻ってしまいます。 モジュールにこの様なコードはかけないのでしょうか？
VB2010でラベルコントロールを作成しました Public Class Form1 Private MyLabel As Label() Private Sub Form1_Load(sender As Object, e As System.EventArgs) Handles MyBase.Load Dim y As Integer Me.MyLabel = New Label(1) {} y = 20 For i As Integer = 0 To 1 Me.MyLabel(i) = New Label() Me.MyLabel(i).Name = "MyLabel" & i.ToString Me.MyLabel(i).Text = "MyLabel" & i.ToString Me.MyLabel(i).Size = New Size(200, 20) Me.MyLabel(i).Location = New Point(20, y) Me.MyLabel(i).BackColor = System.Drawing.ColorTranslator.FromOle(RGB(255, 224, 192)) Me.MyLabel(i).ForeColor = System.Drawing.ColorTranslator.FromOle(RGB(0, 0, 255)) Me.MyLabel(i).Font = New System.Drawing.Font("ＭＳ 明朝", 14, FontStyle.Bold) Me.Controls.Add(Me.MyLabel(i)) y = y + 21 'AddHandler MyLabel(i).Click, AddressOf MyLabel_Click '上記のイベントハンドラを追加するとエラーがでます。 'エラー内容→MyLabelは宣言されていません。アクセスできない保護レベルになっています。 'お世話かけますが、どなたか解決策を教えてもらえませんか。 Next End Sub End Class
イベントビューアから指定のログを取得したいのですが 下記のerがなぜかnullになります。eReaderにはしっかりEventLogReaderも入っています。 ー環境ー VS2013 C# .net string section = "System"; //Systemイベントを指定する string queryString = ""; using (StreamReader sr = new StreamReader("readme.xml", Encoding.GetEncoding("Shift_JIS"))) { queryString = sr.ReadToEnd(); } //上記の条件でEventLogQueryを初期化し、EventLogReaderを介して、EventRecordを読み込みます。 EventLogQuery eQuery = new EventLogQuery(section, PathType.LogName, queryString); EventLogReader eReader = new EventLogReader(eQuery); EventRecord er = eReader.ReadEvent();
こんにちわ。 すみません、VB5のプログラムをVB2010へアップグレードしたところ 「クラス 'System.Windows.Forms.Label' には既定のプロパティがないため、インデックス処理を実行できません。」 と怒られてしまいます。 たぶんLabel81(c).のラベルがないからだとおもいますが そうするとFor文自体が破綻してしまいます。 なんでFor文にしたかもおぼえていませんが。。。 下記のような簡単なプログラムです。なんででしょうか？ ところで話はかわりますが me. ってなんでしたっけ。 すみませんがよろしくご指導お願いします。 （.netになってから数回講習を受けてますので（５年前ですが）ヒントなどいただければ、もしかしたらなにか思い出せるかもしれません。） For c = 1 To 8 Label81(c).Text = "" Label82(c).Text = "" Label83(c).Text = "" Label84(c).Text = "" Label81(c).BackColor = System.Drawing.ColorTranslator.FromOle(&H8000000F) Label82(c).BackColor = System.Drawing.ColorTranslator.FromOle(&H8000000F) Label83(c).BackColor = System.Drawing.ColorTranslator.FromOle(&H8000000F) Label84(c).BackColor = System.Drawing.ColorTranslator.FromOle(&H8000000F) Label74(c).Text = "" Label75(c).Text = "" Label76(c).Text = "" Label77(c).Text = "" Label74(c).BackColor = System.Drawing.ColorTranslator.FromOle(&H8000000F) Label75(c).BackColor = System.Drawing.ColorTranslator.FromOle(&H8000000F) Label76(c).BackColor = System.Drawing.ColorTranslator.FromOle(&H8000000F) Label77(c).BackColor = System.Drawing.ColorTranslator.FromOle(&H8000000F) Next
関数計算式の結果、♯N/Aとかの♯VALUE!とかのエラーがセルに表示されたとき、マクロのメッセージボックスで画面上にエラーメッセージを出すといったようなことはできますか？意図が伝わりにくい質問かと思いますがご存知の方いらっしゃいましたらよろしくお願い致します。
Accessのウインドウサイズの固定について回答お願いします。 Accessファイルを開いたときに、メインメニューのフォームが開くのですが、これのオープンイベントにウインドウサイズの変更を入れたいと思っています。 Windows Apiというものを呼び出すコードをモジュールにも記入すると思うのですが、よく分からず困っています。 変更したいのは、ウインドウサイズのみなので、位置は必要ありません。 出来れば、高さや下位置等の数字を任意に変更すれば使えるコードを教えてもらえれば有難いです。 後、メインメニューのオープンイベントにサイズ倍率を変更するコード Private Sub Form_Open(Cancel As Integer) FormSizeChange Me, 0.9 End Sub がすでに入っていますのでこれに追加していただきたいです。 よろしくお願いします。
マクロ初心者です エクセル2010のマクロVBAで以下を作成したいのですが、分からないので教えてください(>_<) 仕事で、データが入ってる複数のエクセルブック(フォーマットは同じで数値 が異なる)のA～E列をAA.exlmにひたすらコピーしていく作業があります。 なので作業効率をあげるために、 マクロ(cntl+○)起動→エクスプローラを開く→あるエクセルをマウスでクリックすると自動でそのエクセルのA～E列をコピーして元のマクロファイルに貼り付けたいです。 コピーの仕方やエクスプローラを出すプログラムは出来たのですが、そこからエクセルを適当に選んで、そのエクセルのセルをコピーするやり方がわかりません(>_<) お願いします！
あるホームページに出てくる　○○から××へ　などの際に使用される（から記号）が、普通に（から）と打って変換して出てくるもの（～）と微妙に違い、これを普通の～記号に置換したいのですが、できずに困っております。 いちおう質問タイトルの～記号には、私の困るほうを使ってみました。 （質問をアップすると変換されてしまうかもしれませんので、違いについて補足いたします） ●困るほうの～記号の特徴： セルにペーストすると、普通のものより若干太く見える。 テキストエディタに貼り付けると?（半角ハテナ記号）になる。 VBAのモジュールに貼り付けても上と同じくハテナ。 ●使用されている場所： 例えばヤフオクのカテゴリーを下っていき、子ども服のサイズに辿りついたところで、ページ上部あたりにカテゴリー表示されているところ。 すべてのカテゴリ > ファッション > キッズ、ベビーファッション > 子ども服（女の子用） > ボトムス > パンツ、スラックス > 150（145〜154cm いったいなぜこんな記号が使われているのだろうか・・・とほほ。 すいませんが、どうかよろしくお願いいたします。
コードコンバートサイトを使ってもエラーで 変換できなかったので お願いします。 Private Sub DataGridView1_CellPainting(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellPaintingEventArgs) Handles DataGridView1.CellPainting If e.ColumnIndex >= 0I AndAlso e.RowIndex >= 0I _ AndAlso (e.PaintParts And DataGridViewPaintParts.Background) = DataGridViewPaintParts.Background Then ‌ e.Graphics.FillRectangle(New SolidBrush(e.CellStyle.BackColor), e.CellBounds) ‌ If (e.PaintParts And DataGridViewPaintParts.SelectionBackground) = DataGridViewPaintParts.SelectionBackground _ AndAlso (e.State And DataGridViewElementStates.Selected) = DataGridViewElementStates.Selected Then Call e.Graphics.DrawRectangle(New Pen(Color.Black, 2I), _ e.CellBounds.X + 1I, e.CellBounds.Y + 1I, _ e.CellBounds.Width - 3I, e.CellBounds.Height - 3I) End If ‌ Dim pParts As DataGridViewPaintParts = e.PaintParts And Not DataGridViewPaintParts.Background ‌ Call e.Paint(e.ClipBounds, pParts) ‌ e.Handled = True ‌ End If End Sub
いま、変数aaaに、ストリング型で "2015:07:03 16:36:04" という書式でに日時・時刻が入っているとします。 これをDate型の変数に変換したいのですが どうすれば良いですか？
最近　本当にお世話になっております。 入力したシートを移動させるとき、インプットボックスでファイル名を指定させて、そのファイルを開かせるまでは大丈夫なのですが、その指定したファイルのシートの一番末尾に移動させる方法がわかりません。どなたかおわかりの方がいらっしゃっいましたらご指導よろしくお願い致します。 Sub 開く() Dim mywbname As String Dim mymsg As String, mytitle As String mymgs = "開くファイルコードを入力してください" mytitle = "ファイルを選択" mywbname = Application.InputBox(Prompt:=mymgs, Title:=mytitle) If mywbname <> "" Then Workbooks.Open Filename:="\\LANDISK-01D595\disk\" & mywbname & ".xlsx" Windows("入力シート.xlsm").Activate Sheets("追加").Move After:=Workbooks("\\LANDISK-01D595\disk\" & mywbname & ".xlsx").Worksheets(Worksheets.Count) End If End Sub
VBAでボタンをクリックしたくて、Webページを要素を検証というので調べています。 添付画像で３分と書かれている箇所のidを知りたいです。 この場合、idはassetsCategoryFilterZoneRegionになるんでしょうか？。 しかし、これ３分の他にも１５分や１時間など別のものが多くありました。 下の情報だけで３分のidは正確に分かるにはどこを見たら良いですか？。 また、VBAでここの３分というのをクリックする他の方法がある場合があれば、ご教授願いたいと思っております。 以上、よろしくお願い致します。
エクセル2010で、画像のように最初Ａ列に赤が５個と黄色が４個、Ｃ列に赤が５個と青が2個、ランダムに入っています。これをＡ列をＥ列のように、Ｃ列をＧ列のように並べ替えたいです。 つまりＡ列とＣ列両方に含まれる赤は真ん中にそろえ、黄色は赤の下、青は赤の上という具合です。実際にＡ列をＥ列に移動させなくても、Ａ列内での並べ替えで結構です。Ｃ列に関しても同様です。 色にしたのは見やすくするためで、実際使う時は色はついておらず、バーコードナンバーが書いてあります。何をしたいかというと、古い出品リストのＡ列と新しい出品リストのＣ列を比べ、整理したいということです。赤が次回も出品する商品、黄色が売り切れ商品、青が新規入荷です。同じ色でも、各セルには違う番号が書いてあります。 このようなＶＢＡコードを教えてもらえないでしょうか？
Dim strFormat As String strFormat = "xlCenter" Columns("A:C") .HorizontalAlignment = strFormat この様にstrFormat変数に入れた文字列(定数)で書式を設定したいのですが 何か簡単且ついい方法はありますか？ 因みに、 strFormat = "-4108" Columns("A:C") .HorizontalAlignment = Val(strFormat)では 上手く設定出来ましたが、今回は "xlCenter"という文字列で何か 簡単且ついい方法をお願いします。
エクセルＶＢＡ　ユーザーフォームのリストボックスより選択した数値の取得についてアドバイス願います。 ユーザーフォームのリストボックスに表示させている中から、（列数は5列表示させています）選択行の内より（後ろの）4列から数値を取得し、足し算を行い、テキストボックスに表示したいのですが、構文エラーが出ます。アドバイスをお願います。 Dim 選択行 As Integer 選択行 = Userform1.ListBox1.ListIndex With Userform1.ListBox1 TextBox1 = .List(選択行, 1) + ListBox1.List(選択行, 2) + ListBox1.List(選択行, 3) + ListBox1.List(選択行0, 4) End With
ＥＸＣＥＬ ＶＢＡでフィルターの掛け方を教えて下さい。 ＥＸＣＥＬは2013です。 販売というシートに商品ごとに出荷率があります。 表示範囲というシートのＣ2とＤ2に表示範囲があります。 表示範囲がＣ2（0.5）以下とＤ2（1.2）以上の販売というシートの商品の行を表示するようにフィルターを掛けたいです。 　　※Ｃ2とＤ2は可変します。 　　　商品は5000行ほどあります。 コードの説明も加えて頂けると大変助かります。 宜しくお願い致します。
写真をセルに挿入するマクロをよく見ますが、以前から2003で使用していたマクロが2010で画像のリンク情報が挿入され、肝心の画像が挿入されていないためブックの配布が出来なくなりました。 ActiveSheet.Pictures.InsertメゾットをActiveSheet.Shapes.AddPictureに変更することで解決するような記述を目にしますが、エラーとなり間違いがよくわかりません。 ご伝授いただけないでしょうか。 セル内でマウスの右クリック、ホルダーを開いて画像を選択し挿入、セルの大きさに自動調整されセル内のセンターに収まるといったものです。 Private Sub Worksheet_BeforeRightClick(ByVal Target As Excel.Range, Cancel As Boolean) Dim Pic As Picture Application.ScreenUpdating = False Cancel = True On Error GoTo Err If Target.MergeCells = False Then Exit Sub Const MF1 As String = "JPEG Files (*.jpg;*.jpeg;*.jpe),*.jpg;*.jpeg;*.jpe" Const MF2 As String = "ビットマップ (*.bmp),*.bmp" Const MF3 As String = "GIF (*.gif),*.gif" Const MF4 As String = "すべてのファイル (*.*),*.*" Fname = Application.GetOpenFilename(FileFilter:=MF1 & "," & MF2 & _ "," & MF3 & "," & MF4) If Fname = "False" Then MsgBox "取り消されました。", vbInformation Exit Sub End If For Each Pic In ActiveSheet.Pictures If Pic.TopLeftCell.MergeArea.Address = Target.Address Then Pic.Delete End If Next Set Pic = Pictures.Insert(Fname)　　←　ここ If Pic.Height > Pic.Width Then GoTo PicH ElseIf Pic.Height < Pic.Width Then GoTo PicW End If PicH: With Pic .Top = Target.Top .Left = Target.Left .Placement = xlMove End With With Pic.ShapeRange .LockAspectRatio = msoTrue .Height = Target.Height End With If Pic.Width > Target.Width Then GoTo PicW Else End If GoTo Center PicW: With Pic .Top = Target.Top .Left = Target.Left .Placement = xlMove End With With Pic.ShapeRange .LockAspectRatio = msoTrue .Width = Target.Width End With If Pic.Height > Target.Height Then GoTo PicH Else End If Center: aw = Target.Width bw = Pic.Width x = (aw - bw) / 2 Pic.Left = Target.Left + x ah = Target.Height bh = Pic.Height y = (ah - bh) / 2 Pic.Top = Target.Top + y Set Fname = Nothing Exit Sub Err: MsgBox "エラー番号:" & Err.Number MsgBox "エラー内容：" & Err.Description Application.ScreenUpdating = True End Sub
下記のような構文で　ｊに　countif 結果を　for ~Nextで処理させたいんですが ｊに計算結果が入らないんですけど教えてください。 dim i as Long.j as Long For i = 15 To 20 j = WorksheetFunction.CountIf(Worksheets(2).Range("B3:B10").Value, Worksheets(1).Cells(i, 7)) 　msgbox j next i
Visual Basic 2010 Expressでプロジェクト名の変更方法が分からなったため、そのプロジェクトのフォルダ名、ファイル名を直接リネームしてしました。その結果、そのプロジェクトが開けなくなってしまいました。 対策方法をご教示頂きたくお願いします。せめてソースコードだけでも取り出せたらと思っています。よろしくお願いします。
最近、本当にお世話になってます。 B列の最終行にPHONETICを使用していない漢字を隣の最終行のCセルにカタカナに変換したのを表示させたいのですが（手入力が早いと言われればそれまでなのですが・・・・） Sub カタカナ変換() Dim s As Range For Each s In ("Range("B1048576").End(xlUp).Offset(0).Select)) Range("C" & s.).Value = Application.GetPhonetic(s) Next End Sub このコードだと動きません、どなたかお時間ある方ご教示お願いします。
富士通のFMV　シリーズですが 2013年10月発表モデル〜2014年1月・2月発表モデルは、「リカバリデータディスク」（「リカバリデータディスク」（DVD）または「トラブル解決ナビディスク＆リカバリデータ＆ソフトウェアディスク」（Blu-ray Disc））を1回しか作成できません。 「リカバリデータディスク」を作成した後は、作成するディスクを選択する画面に「リカバリデータディスク」が表示されなくなります。 何処かのiniファイルか何か弄って、2回作ることが出来ないでしょうか？ どこにしまったか？行方不明なのですが、 ソフト起動しても、作ったことらしく、表示されません。 https://www.fmworld.net/cs/azbyclub/qanavi/jsp/q …
あるブックに複数シートが存在していて（シート名は人名）、その中で新宿という特定の文字があるシートを全部選択させ、その選択したシートのそれぞれの同一セル（ここではN1セル）に設置させているハイパーリンクをまとめて削除したいのですが、うまくいきません。選択まではネットから取り寄せたコードで何とかなっているのですが、その後は変数を使っての処理なのでしょうか？わかりにくい質問内容だと思いますが　教えていただけるとありがたいです。 Sub Sample() Dim myWS As Worksheet MsgBox "新宿が含まれるシートを選択します" For Each myWS In Worksheets If myWS.Name Like "*新宿*" Then If ActiveSheet.Name Like "*新宿*" Then myWS.Select (False) Else myWS.Select End If End If Next End Sub
232cの接続プログラムについて教えて下さい！ vb6または、visualstudio2008で232cでモデムと接続し、データの送受信を行いたいと思っています。 前提 PCはwin7またはwinＸＰ 開発言語はvb6またはvisualstudio2008 232cの先にはモデムが接続している。 PC ⇄モデム⇄モデム⇄別の機械 データをお互いに送受信し続ける仕様です。 機械とは、BSC手順で送受信するようにと言われていますが、以下のことがイマイチわかりません。 1、232cとはコントロールで接続設定を書けばいいかと考えているのですが、bsc手順に基づく書き方はどうすれば良いでしょうか？ 通信機器との接続プログラムは初めてなので、お願いします！
恐縮ですが =YEAR(A3)&"/"&MONTH(A3)&"/"&DAY(A3)&" "&FLOOR(B3,"0:15") のセル式が有ります。 セル書式を　ユーザー定義　yyyy/m/d　hh:mmとしてありますが このセルの表示が　2015/01/01　0.055555 と　時間が　hh:mm　と表示されません ＝FLOOR(B3,"0:15")　のみなら　ｈｈ：ｍｍ　形式で表示されます。 何か情報はないでしょうか
マクロ初心者です。A1セルに100の数値が入ってます。B1セルに5という数値が入ってます。これらの数値はいろんな数値になります。 この状態でマクロを実行するとA2セルより下に5個連続で100がコピーされる方法を探してます。どなたかご協力お願いします。 また、A1セルの表記がパーセントの場合でもコードは同じものを使うのでしょうか？
シートタブの表示領域が狭く、スクロールバーの領域が広くなっています。 おかげでシートタブが一つしか見えません。 仕切りのスライダーを右へ動かすコードはありますか？
VBAでプログラム実行中にEscキー押すと 途中でデバッグモードに入ることができますが コードで入るにはどうすれば良いですか？ WaitとかPauseとか該当しそうな気がしたのですが うまくいきませんでした。 どなたか教えてください。
ヤフオク　VBA 自動プログラムを作成していますが、途中の　通常入力　とHTMLタグ入力　の切り替えのプログラムが書けず、困っています。。。 どなたか、ご存知の方がいらっしゃいましたら、ご教授いただけたら幸いです。 JAVAが使用されているようで、どのように突破していったらよいか悩んでいます。。。 よろしくお願いいたします。 ▽元のソース▽ <div id="htmlMode" style="display:block;"> <div class="decFormTab"> <table width="100%" border="0" cellpadding="0" cellspacing="0"> <tr> <td class="decFormTab01On"><p>通常入力</p></td> <td class="decTabSp"></td> <td class="decFormTab01Off"><p><A id="aucHTMLtag" href="javascript:void(0);" onclick="ModeTabTEXTON(false);">HTMLタグ入力</A></p></td> <td></td></tr></table> </div> <div class="decFormTxtArea"> <script type="text/javascript"> if (YAHOO.env.ua.ie || YAHOO.env.ua.gecko || YAHOO.env.ua.chrome || (YAHOO.env.ua.webkit && !YAHOO.env.ua.android)) { var formName = "auction"; var controlName = "Description_rte"; var documentFragmentRTE = "<div id=\"RTEContainer\" style=\"left: 0px; position: relative; top: 0px; height: auto; width: 400px;\">\n"; var idGenerator = null; var editor = true; var isDesignMode = true document.write(documentFragmentRTE); idGenerator = new RTEIDGenerator(0); editor = new RTEEditor(idGenerator); editor.SetLocation("jp"); editor.SetIconVersion("1"); editor.Instantiate(); document.write('</div>'); } else { var documentFragmentTextarea = "<div style=\"font-size: 90%; margin: 4px 0;\">お使いのブラウザでは「通常入力」機能をご利用いただけません。<\/div>\n"; document.write(documentFragmentTextarea); } </script> </div> </div> <div id="textMode" style="display:none;"> <div class="decFormTab"> <table width="100%" border="0" cellpadding="0" cellspacing="0"> <tr> <td class="decFormTab01Off"><p><A href="javascript:void(0);" onclick="ModeTabTEXTON(true);">通常入力</A></p></td> <td class="decTabSp"></td> <td class="decFormTab01On"><p>HTMLタグ入力</p></td> <td></td> </tr></table> </div> <div class="decFormTxtArea"> <textarea name="Description_plain_work" cols="60" rows="10"></textarea> <textarea name="Description_plain" style="visibility:hidden;height:1px;"></textarea> <p class="decTx03"><a href="http://rdsig.yahoo.co.jp/auction/aucfun/RV=1/RE= …^ADAS8JnuQbzPEM1iV_t8OsxijLos6Y-" target="new">かんたん、きれいに入力できるテンプレートを使う</a>（外部リンク）</p> </div> </div> <script type="text/javascript"> ▽試してみたPG▽ For Each objINPUT In objIE.document.All.tags("input") 'Inputのタグを.allから抜く If objINPUT = "HTMLタグ入力" Then '見つけたINPUTオブジェクト(ボタン)を.Clickクリックする objINPUT.Click '用が済んだので(見つかったので)ループを抜ける Exit For End If Next 'ページの表示完了を待ちます。 While objIE.ReadyState <> 4 Or objIE.Busy = True '.ReadyState <> 4の間まわる。 DoEvents Wend 普通に、マウスでクリックすると切り替わるのですが、　VBA　で　HTML　をクリックしようとしてもできません。。。 わかる方いましたら、よろしくお願いいたします。
タイトル通り、visual stadioを使って、メニューバー (プロジェクト→参照の追加)の順番で追加すると、現在、プロジェクトには、(追加した項目)の複数のバージョンへの参照、バージョンへ(古いバージョン)の直接的な参照、およびパーション(新しいバージョン)への間接的な参照が含まれています。(追加した項目)バージョン(新しいバージョン)を使用するには、直接的な参照を変更してください。 すごく困ってますので、よろしくお願いいたします。
エクセルでWeb情報を更新しながらある値を取得し、エクセルのあるセルの値がある範囲内にある時に、UWSCによって、ある特定のボタンをクリックする、という操作は可能でしょうか。 これは、つねにUWSCでエクセルの値を見続けるのと、UWSCからエクセルの特定のセルを監視させる方法について、詳しい方のご教授を願いたいです。 お願いします。
Windows XPで動いていたVBAでWindows 8.1のPCを替えて動作しなくなった機能が満載 になっています。 そのなかで今回ご教示いただきたいのがRS-232Cの使用方法です。 事前に次の処理は完了しています。 １．Windows XPのPCからMSCOMM32.OCXをWindows8.1のPCのC:\Windows\SYSWOW64に 　　コピーしました。 ２．コマンドプロンプトの画面でregsvr32.exe C:\Windows\SYSWOW64\MSCOMM32.OCX を実行しました。（「・・・・成功しました」の表示が出ました。 ２．参照設定でC:\Windows\SYSWOW64\MSCOMM32.OCXを選択しました。 ３．参照可能なﾗｲﾌﾞﾗﾘﾌｧｲﾙでMicrosoft Comm Control 6.0にﾁｪｯｸがついて表示 　　されました。 実行すると次のエラーとなります。 '==== 通信ポート初期化設定 ==== Set MSComm1 = New MSComm　←　「実行時ｴﾗｰ'429' ActiveXｺﾝﾎﾟｰﾈﾝﾄはｵﾌﾞｼﾞｪｸﾄを作成できません。」 MSComm1.CommPort = 5 MSComm1.PortOpen = True MSComm1.Settings = "9600,N,8,1" MSComm1.Handshaking = comRTS よろしくお願いします。
エクセルで複数URLのリンク先から、「在庫状況」「旧定価がいくらか」「ＩＳＢＮバーコードの番号」という３つの情報を引っ張ってくることはできないでしょうか？ Aの列にあらかじめURLを100個ほど入力し、マクロでもいいですが、リンク先の情報を取得して、B,C,Dの列に引っ張ってくるシステムが欲しいです。 具体的には、このような表を作りたいです。 __A____ ____B＿＿ ____C＿＿ ＿____D＿＿＿＿ ＵＲＬ１ 在庫取り寄せ 1500 9784331059685 ＵＲＬ２ 品切れ 2500 9784860951344 ＵＲＬ３ 現在お取扱いできません 2400 ] 9784899771579 ・ ・ ・ ・ ・ ・ ・ ・ ・ 在庫情報はソースでは、 <p class="status_1">在庫取寄せ<br/> 通常1週間以内発送</p><!-- 青 --> <p class="status_2">品切れ<br/> ご注文は可能 入荷しない場合あり</p><!-- 赤 --> <p class="status_3">現在お取扱いできません</p><!-- 灰 --> の３種類です。ＵＲＬ１でいうと、 旧定価は<p class = "geb_itemDetailTtlKbValue1"><span>旧定価：１，５００円＋税／ＢＳ分類：民俗・風俗・文化・地誌・紀行・他<br />で、 ＩＳＢＮバーコードの番号は<br />BS(9784331059685/0-04427)</span></p>で囲まれています。 ＵＲＬ１ http://www.bookservice.jp/bs/ItemDetail?cmId=634 … ＵＲＬ２ http://www.bookservice.jp/bs/ItemDetail?cmId=629 … ＵＲＬ３ http://www.bookservice.jp/bs/ItemDetail?cmId=615 … 在庫状況は本タイトルの下、旧定価とＩＳＢＮバーコードは内容紹介の上下にあります。 よろしくお願い致します。
Excel１３　マクロでデスクトップ上の他のブックを参照する時のファイル名について教えて下さい。 ファイルのプロパティを見ると場所は C:\Users\aaaa\Desktop となっています。"aaaa"は、実際とは違いますが。 Excelのマクロで"Test.xlsx"を開こうとするとファイルが無いとエラーになります。 どうしたら良いんでしょうか
エクセル　VBA　にて　IE　のボタンがクリックできません； どなたか、ご存知の方がいましたら、ご教授のほど、よろしくお願いいたします。 ヤフオクの出品をエクセルVBAで作成していますが、ここから先に行けません； ソースコードは↓ <tbody> <tr> <td align="center"><table cellpadding="2" cellspacing="2" style="margin-bottom:0;"> <tbody><tr> <td><input id="auc_preview_back" onClick="Ya.submit(document.auction, 'http://pageinfo16.auctions.yahoo.co.jp/jp/show/u …);" type="button" value="修正する"> </td> <td> </td> <td><input id="btnEditConfirm" onClick="Ya.submit(document.auction, 'http://edit16.auctions.yahoo.co.jp/jp/config/sub …);disabledSubmit(document.auction);" type="button" value="ガイドラインと以下の注意事項に同意して更新する"></td> </tr> </tbody></table></td> </tr> <tr> <td align="center"><table width="700" cellspacing="0" cellpadding="4" border="0"> <tbody><tr> この "修正する"　ボタンと　"ガイドラインと以下の注意事項に同意して更新する"　ボタン があるのですが、うまく押せません； 書いているコードは↓ For Each objINPUT In objIE.document.all.tags("td") 'Inputのタグを.allから抜く If objINPUT.Value = "ガイドラインと以下の注意事項に同意して出品する" Then '見つけたINPUTオブジェクト(ボタン)を.Clickクリックする objINPUT.Click '用が済んだので(見つかったので)ループを抜ける Exit For End If Next 'ページの表示完了を待ちます。 While objIE.ReadyState <> 4 Or objIE.Busy = True '.ReadyState <> 4の間まわる。 DoEvents Wend For Each objINPUT In objIE.document.all.tags("input") 'Inputのタグを.allから抜く If objINPUT.Value = "修正する" Then '見つけたINPUTオブジェクト(ボタン)を.Clickクリックする objINPUT.Click '用が済んだので(見つかったので)ループを抜ける Exit For End If Next 'ページの表示完了を待ちます。 While objIE.ReadyState <> 4 Or objIE.Busy = True '.ReadyState <> 4の間まわる。 DoEvents Wend ここで詰まってしまい、先に進めません
勉強始めて数年、いわゆる文法的な内容は覚えエクセルVBAエキスパートならベーシックＯＫ、スタンダードもおそらく大丈夫？？程度になったと思ってます。しかし、ちょっと複雑なマクロを組もうとすると、うーーんと考えます。とりあえず時間さえあれば組める状態（笑）。もちろんその手段がここで質問するというのもあります。 うーーんと考えずに出来る範囲を広げるためには、この先何を勉強すべきでしょうか？文法ではない筈です。アルゴリズムですか？科学技術的な数値解析をする分けではありません。エクセルで数字をこねくり回すだけです。手作業で出来る面倒事を正確にマクロに記述するだけです。アルゴリズムの知識が必要とは思えません。 質問 ひたすら作りまくり経験値を上げるしかないのか？ 何か参考書があれば読みたいですが、何かあるのでしょうか？
200万行のCSVファイルをエクセルに読み込みたいです。Rows.Countを超えるので、２回に分けて 半分読み込み 処理 残り半分読み込み 処理 のようにしたいのです。どうすればいいでしょうか？ 参考までに、検索したところ下記のＱ＆Ａは見つかりました。 https://oshiete.goo.ne.jp/qa/3407338.html ただ、これは途中の任意の１行を読み込む方法です。 100万行のファイルを２個作る等のようなとんちの利いた回答はナシでお願いします。 他に無ければしますが。。。
検索でVCのコードしか見つからず、VBに直しているのですが、下記がわかりません。 [VC] public ExtendedWebBrowserSite(ExtendedWebBrowser wb) : base(wb) { parent = wb; } 下記のところまでは、出来たのですが、最後の「 : base(wb)」の部分はどのようにすればよいのでしょうか？ [VB] Public Sub ExtendedWebBrowserSite(ByVal wb As ExtendedWebBrowser) parent = wb End Sub ご存知の方、よろしくお願いいたします。
VBA入門者です。宜しくお願いします。 以下の作業を、シート（1）～（3）に繰り返したいのです 　 　◎シート（”レポート”）列A,C,F…40列まで3列置きにコピー 　◎シート（１）のA3に貼付 初歩的な構文だとシートごとに設定するのが大変です（汗） 下の構文をコンパクトにまとめ、 できれば・・・ シート(2)には（B4,B23)～、シート(3)には（C4,C23)～同じ流れでコピペする動作も まとめたいのです。 　　With Worksheets("レポート") .Range("A4:A23").Copy Worksheets("1").Range("A3").PasteSpecial xlPasteValues .Range("C4:C23").Copy Worksheets("1").Range("B3").PasteSpecial xlPasteValues .Range("F4:F23").Copy Worksheets("1").Range("C3").PasteSpecial xlPasteValues .Range("I4:I23").Copy Worksheets("1").Range("D3").PasteSpecial xlPasteValues '……４０列まで続く End With
お世話になります。 VBAを使用して、 セルに、UNICODEE文字が含まれているかのチェックをしたいと考えております。 ・できれば、どの文字がUNICODE文字かどうか知りたい。 ・最低でもどのセルにUNICODE文字が含まれているか知りたい という形ですが、もし、ご存知の方教えて頂けないでしょうか？ 宜しくお願い致します。
http://koikide.net/With.html このページにwithを入れ子にして使う方法が書かれてあるのですが 下記のようにwithが上下関係のない場合にはどうしたら良いですか？ with ThisWorkbook.Worksheets("Sheet1") With ListView1 For i = 2 To filenum0 + 1 .ListItems.Add Text:=.Cells(i, 1) Next i End With End With .ListItems.Add Textの前にListView1 .Cells(i, 1)の前にThisWorkbook.Worksheets("Sheet1") が省略されています。
下記マクロは、１行～Rows.Countの間で条件に合う１行を抽出し、別シートにコピーするものです。３種類の方法で所要時間を比較してます。 ①セルを１行目～Rows.Countまで調べて抽出 ②セルを一旦変数vrに収納してから調べて抽出 ③autofilterで抽出 ところがautofilterでエラーとなります。どこがおかしいのでしょう？ 場所： .Range("A1").CurrentRegion.AutoFilter _ Field:=1, _ Criteria1:=100000, Operator:=xlFilterValues メッセージ： 「実行時エラー 　オートメーションエラーです。 　起動されたオブジェクトはクライアントから切断されました」 Sub test() Dim vr As Variant Application.Calculation = xlCalculationManual Application.ScreenUpdating = False Cells(1, 3) = Timer For i = 1 To Rows.Count Cells(i, 1) = i Next i Cells(2, 3) = Timer Application.ScreenUpdating = True ′① j = 1 For i = 1 To Rows.Count If Cells(i, 1).Value = 100000 Then Rows(i).Copy Destination:=Worksheets("Sheet2").Rows(j) j = j + 1 End If Next i Cells(3, 3) = Timer ′② vr = Range("A1:A" & Rows.Count) For i = 1 To Rows.Count If vr(i, 1) = 100000 Then Rows(i).Copy Destination:=Worksheets("Sheet2").Rows(j) j = j + 1 End If Next i Cells(4, 3) = Timer 　 '③ With ActiveSheet .AutoFilterMode = False .Range("A1").CurrentRegion.AutoFilter _ Field:=1, _ Criteria1:=100000, Operator:=xlFilterValues .Range("A1").CurrentRegion.SpecialCells(xlCellTypeVisible).Copy _ Worksheets("Sheet2").Range("A1") .AutoFilterMode = False 'AutoFilter を解除 End With Cells(5, 3) = Timer Application.Calculation = xlCalculationAutomatic End Sub
以下のページを参考に試してみたのですが、マクロ実行でコピーができません。 http://qiita.com/tukiyo3/items/0d50f2834fb5098b4 … 「Mirosoft Forms 2.0 Object Library」にチェックが付いていることを確認しております。 ちなみにセルＥ６には、改行された文章が入っています。 やりたいことは、セルの値だけコピーして、別のアプリケーションに貼付けをしたいと考えています。 改行された文章を普通にコピーをするとダブルクォーテーションが付くのでコピーした際にダブルクォーテーションを取りたいです。 それとエクセルは2010を使用しています。
早速ですが セル式に　下記が有ります =YEAR(A10) & "/" & MONTH(A10) &"/" &DAY(A10) & " " & HOUR(B10) A列　日付　yyyy/mm/dd　B列　時間　hh:mm:ss　です これを　VBAから　与えたいのですが Range("C10").Formula = "=YEAR(A10)" & "/" & "Month(A10)" & "/" & "Day(A10)" & "/" & "HOUR(B10)" これを　実行すると セルに　=YEAR(A11)/MONTH(A11)/DAY(A11)/HOUR(B11) が入ります　 さて、どう書けばいいのでしょうか？よろしくご指導ください。
エクセル2010で表の編集のマクロを組みました。 保存先は個人用マクロブックです（PERSONAL　XLSB) このマクロを別のPCに送信して、そのマクロで表を編集したいのですが、どうすればよいでしょうか？ マクロは組みますが、VBEはよくわかっていません。 エクスポートしてファイルを二つ作成し、送信、送り先のPCでインポートすると聞きましたが、詳しく説明いただけないでしょうか？ よろしくお願いします。
configurationmanager.appsettings.haskeysがTrueか判定しているプログラムがありました。 appsettingsでxmlファイルからデータ取得しているようなのですが、haskeysの存在がちょっと解せません。たぶん、ちゃんと取得して格納されているとTrueを返すのかなと想像しているのですが・・・。 で、問題なのですが、MSDNのリファレンスを見ていると、ConfigurationManager.AppSettings プロパティのページでhaskeysの記載がなく、HasKeysのページで、AppSettings の記載がありません。 HasKeysの方は、NameValueCollection.HasKeys メソッドのページを見ていました。 NameValueCollectionにどんなメソッドが使えるのかなど、みなさんはどうやって調べているのでしょうか？現在私はググッてヒットしなければ諦めるし、業務的に諦めれない物は、時間を大量に消費した上で妥協したりしながら、なんとかやってました。 ここを見て、こう理解したら、分かる！のようなアドバイスがありましたらよろしくお願いします。
バッチコマンドで、(gmailなどの)「他の通信相手全てにこのバッチファイルを転送する。」というコマンドを教えてください。 お願いします。
２つのシートを比較するよていです。 Ａのシートには4500個の情報があり、Ｂのシートには1400個の情報があります。 2つのシートを比較し、AのシートにないＢの情報を抽出するにはどうしたらよいでしょうか。
VBAを使っていて 2×256の配列にそれぞれxとy座標の数値データが入っており これをグラフ化（散布図か折れ線図）して画像として出力したいのですが コマンドラインで使えるソフトで配列を受け取って グラフを画像化する方法を教えてください。 大量のデータを出力するため Excel上のシートやグラフを使わず直接画像化する方法を教えてください。 コマンドラインで使えるソフトとかってありますか？
個々では作動しているマクロですが、１つにまとめると、１ッ目しか実行しません。 ※全てSheet1にボタンがあります。また、全て標準モジュール６に書いています。 また、以下の２ッ目が０や空白になることもありません。 １ッ目はデータを張り付けるマクロ（ボタン1_click） ２ッ目はSheet1のＬ１９の数値が８以下なら実行するマクロ（ボタン8_click) ３ッ目はSheet1のＰ３が「組合せ」という文字なら実行するマクロ（ボタン６_click) ４ッ目はSheet1のＷ３が「組合せ」という文字なら実行するマクロ（ボタン１３_click) で、実行すると、１ッ目だけ実行し、エラーやデバックもなく終わってしまいます。 以下の構文でおかしいところをご伝授いただければ助かります。 Sub test11() Dim statWS As String statWS = "Sheet1" Worksheets(statWS).Activate Call ボタン1_Click If Worksheets("Sheet1").Range("L19").Value <= 8 Then Worksheets(statWS).Activate Call ボタン8_Click End If If Worksheets("Sheet1").Range("P3").Value = "組合せ" Then Worksheets(statWS).Activate Call ボタン6_Click End If If Worksheets("Sheet1").Range("W3").Value = "組合せ" Then Worksheets(statWS).Activate Call ボタン13_Click End If End Sub よろしくお願いします。
Excel2003で質問です。 E~M列の、25,31,37,43,50,56,62,68,74行目全てに処理を作りたいのですが、入力も上記の番地に行う為数式では対応出来ません。 処理は、例えばG25に"s"と入力 したらF25に"◯"を表示みたいな感じです。 もう一つ条件がありまして、上記の各行の1行下にそれぞれ数式で値が表示されている列と、空白の列があります。 なのでG26に値があり、F26が空白でE26に値があるとします。 その時にG25に"s"を入力したら、E25に"◯"、F25は空白のまま、という処理です。 "s"を入力するのは、必ず真下の行に値が表示されている箇所になります。 数式を入れると、"s"の入力が出来なくなってしまい困っています。 VBAでの処理になると思いますが、VBAは初心者なので詳しく教えて頂けると助かります。 上記の各行で、同じ処理を行いたいです。
今midiについて勉強中なんですが デルタタイムがどうしても分かりません。 エクセルでバイナリのデータから16(10)進数に変換していて http://www.geocities.jp/stdmidi/03.html 上のサイトに書いてあることはできましたが http://www.geocities.jp/stdmidi/t0.html デルタタイムの83 60を480(10進数)にすることがどうしてもできません。 vbaでもワークシート関数でもどちらでもいいのでお願いします。
タイトルの通りなのですが、VB.netでtwitter APIなどを利用してソフトを作りたいのですが、VB.netはtwitter APIに対応しているのでしょうか？
VBAで一桁目を四捨五入する方法を教えてください。 例 12345 →12350 124→120 34219→34220 322.5567→320 -22.553→-20 普通に考えると10で割って 整数にして元の数値から引き算して if文で5以上か未満を判定ということになると思うのですが もっとスマートなやり方ありますか？ format関数とかでできるのでしょうか？
わかる範囲/部分的にでも答えられる所は、答えて頂けると嬉しいです。 ゴール/そこまでのイメージとしては、 1)答え合わせボタンをクリックすることで、ファイル選択ダイアログを開き、存在するcomma-separated valuesファイルを読み込む。（回答をExcelのシートに表示する） 2)そして、答え合わせを順次行う。正確な記述ではありませんが、あくまでイメージとして例えば、If B2(回答) =C2（正解）なら、”正解”Else,"不正解"をD2に表示する感じです。"正解"の数をどこかのセル内に表示させる。 この答え合わせのシステム化をVBAで作ろうと考えております。イメージは出来上がるのですが、なかなかとっかかりがわからないです。お手を拝借させていただけませんでしょうか。。。 具体的な手順等を教えて頂ければ、頑張って調べようと思います。。 専門用語があるほうが、検索に引っかかりやすいのですが、どういう言葉を使って質問したらよいものか。。。 例えば、採点ボタンをクリックなら、コマンドボタンを用意して、それをクリックしてPrivate Sub CommandButton1_Click()～End Subというのがでるはずですよね。採点ボタンなど検索しても出ませんが、コマンドボタンから調べることが出来ます。 また、ダイアログで選択したファイルを選ぶといってもPrivate Sub CommandButton1_Click()～End Subの中にどのように記述していけばよいのか悩んだりしてしまいます。 VBのマクロスクリプト部分を記載して頂ければ一番嬉しいですが、本当にわかるところで十分です。
エクセル2010です。 以下のコードを実行すると「マクロ実行時に実行時エラー１３型が一致しません。」というエラーが出ます。配列の型はvariantで設定しているので問題ないと思うのですが、 皆様のお知恵を拝借させていただけないでしょうか。 マクロは Sub () Dim book5 As String,book1 As String Dim NLink, As Variant, OLink AsVariant , OLdLink As Variant Dim a As Long Dim Z As Long, K As Long, J As Long Book5 = Range("A8").Value Book1 = Range("A2").Value Windows(booK5).Activate 　‘○○ファイルをアクティブにする Z = Range("A1")　 For K = 1 To Z　‘セルA1　に記載されている数字回繰り返す OLink(K) = Range("A1").Offset((K) - 1, 2)　←ここでエラー NLink(K) = Range("A1").Offset((K) - 1, 3)　←同じくエラー ‘△△ファイルを開く buf = Dir(NLink(K)) If buf = "" Then MsgBox buf & vbCrLf & "は存在しません。　ファイル名を確認してください｡", vbExclamation Exit Sub End If For Each wb In Workbooks If wb.Name = buf Then MsgBox buf & vbCrLf & "はすでに開いています", vbExclamation Exit Sub End If Next wb Workbooks.Open Filename:=NLink(K), UpdateLinks:=0 Windows(book1).Activate '××ファイルをアクティブにする '旧リンクから新リンクに変更 ActiveWorkbook.ChangeLink Name:=OLink(K), _ NewName:=NLink(K), Type:=xlExcelLinks '△△ファイルを閉じる Windows(NLink(K)).Activate Application.DisplayAlerts = False ActiveWindow.Close Application.DisplayAlerts = True Next K Windows(book1).Activate '××ファイルをアクティブにする。 ActiveWorkbook.Save '××ファイルを保存。 Windows(booK5).Activate '○○ファイルをアクティブにする。 End Sub どうにかエラーを出なくする方法はないですか？ 宜しくお願いします。 他にも、おかしなところがありましたらご指導いただければと思います。
ユーザーフォームのコマンドボタンをクリックすると、アクティブシートのD列を検索して、リストボックスへ抽出するようになっています。 ここで知恵を頂き下記コードになっています。 更に下記を実行できるようにしたいと考えています。 リストボックスに抽出されたデータをクリック（または選択してコマンドボタン）すると ラベル１へ→選択したデータの行のB列のデータを表示 ラベル２へ→選択したデータの行のE列のデータを表示 マクロは超初心者なので、とても無理なことなのかもしれませんがご教授頂ければ助かります。 Private Sub UserForm_Activate() Worksheets("シート１").Activate End Sub Private Sub CommandButton1_Click() Worksheets("メニュー").Select UserForm2.Hide End Sub Private Sub CommandButton2_Click() Dim myFirst As Range, myFound As Range If TextBox3 = "" Then Exit Sub Set myFound = Range("D:D").Find(what:=TextBox3, LookIn:=xlValues, lookat:=xlPart) If Not myFound Is Nothing Then ListBox1.Clear Set myFirst = myFound ListBox1.AddItem myFound Do Set myFound = Range("D:D").FindNext(after:=myFound) If myFound.Address = myFirst.Address Then Exit Do ListBox1.AddItem myFound Loop Else MsgBox "該当データなし" End If End Sub
ACCESSのレコード転送について ACCESS2010を利用してます。 サンプル.accdbというデータベースがあります。 連結の入力フォーム（F_納品日）があります。 ■ID（オート） ■商品名 ■商品ナンバー ■納品日 上記を保存したときにDAOを利用して、 サンプル2.accdbのテーブル（サンプル.accdbとテーブルの構造は同じです）に転送したいのです。 保存のクリックのときに、VBAでコードを書きたいのですが、DAOを利用することまでは理解したのですが、 WEBのコードを参考にして記載してもうまくできません。 どなたがご教授おねがいします。
VBAのExecメソッドでコマンドプロンプトの画面を非表示にして 実行する方法を教えてください、 検索してみると http://seesaawiki.jp/w/bokkuri_orz/d/VBA%20-%20% … このページには Runのように、外部プログラム呼び出し時にそのウィンドウを非表示にする制御は出来ないようです。 と書かれてあります。 http://scripting.cocolog-nifty.com/blog/2007/05/ … http://scripting.cocolog-nifty.com/blog/2008/08/ … このページにはやり方が書かれてあるのですが VBAについてやり方のみでVBAではどのようにして使えば良いか分かりません。 http://blog.onpu-tamago.net/entry/20101020/12875 … このページにはVBAでもできるというような記載がなされています。 どなたか実行方法を教えてください。
VBAで 500行くらいあるテキストデータを読み込んで そのうち abcd = xxx; （xxxには何らかの数値が入る） という行を探して、 このxxxに所望する数値で置換するという操作をしたいと考えています。 Readlineを使って 一行ずつ検索して、左4文字がabcdになっている行だけ一つずつ書き換えながら 別のテキストファイルとして出力する方法であれば 分かるのですが、 ファイルから一行ずつ読むのではなく Readallで全文を変数に読み込んだ後に その変数に対してReadlineを行うにはどうしたら良いですか？
回答お願いします。 [メインデータ]というアクセスファイルがあり、検査記録のテーブルがあります。 検査記録のテーブルには判定フィールドがあり合格、不合格が入力されます。 この不合格が入力されたレコードを、別のaccessファイル[異常記録]の社内異常記録テーブルにコピーしてきたいです。 この検査記録のフィールド名と社内異常記録のフィールド名は異なっています。 手順としては、 ①異常記録ファイルに検査記録のリンクテーブルを作成する。 ②クエリにてリンクテーブルから不合格のレコードを選択し、社内異常記録テーブルに追加する。 という方法を教えてもらったのですが、問題がでたので教えてもらいたいです。 この不合格のレコードは検査記録テーブルにそのまま残さなければならないデータなので、②の不合格レコードを抽出し追加するクエリを実行すると、毎回同じ不合格のレコードも追加されてしまいます。 例えば、検査記録に10件の不合格レコードがあり追加クエリで10件の不合格データを社内異常記録テーブルに移します。その後2件不合格のレコードが検査記録に入力されたとします。この時点で検査記録テーブルには12件の不合格レコードがあります。ここでもう一度追加クエリで不合格のレコードを追加クエリで移すと先の10件＋12件で22件のレコードになってしまいます。当然前の10件は重複したレコードになっています。 これを解決する方法はありますか？ 削除クエリで追加クエリ前に全データを削除も考えたのですが、社内異常記録のテーブルには手入力する箇所が複数あるので削除は使えません。 リンクテーブルも下手に触ってしまうと検査記録に支障が出てしまうので、出来ればリンクテーブルを使わない方法があれば教えてもらいたいです。 ややこしい話ですので、その都度追記させてもらいますのでよろしくお願いします。
リストボックスに下記の値 1 2 3 シート1の行と列に下記の値 A B C D E 1 かさたな 2 たなはま 3 わらなや 教えて頂きたいマクロは下記になります。 リストボックスの2を選択 2に該当するシート1のB列の『た』をラベル1に表示 D列の『は』をラベル2に表示 よろしくお願いします。
お住まいの地域ではご利用できませんって出るのですがどうすればいいですか？
エクセルマクロの質問です。 当方初心者ですが、明日までに完成させなければいけないマクロがあり大変困っています。 ぜひとも有識者のみなさんのお力をお貸しいただきたく。 一つのセルに、複数のセルの文字列をマージする方法をお聞きしたいのですが、画像の例で説明しますと、(1.B)の「好物」セルに、りんご、刺し身、ぶどう、うどん、を切り取って、改行しながらて入力していくマクロを作成したいです。その際、文字列「好物」は消してしまいたいです。 つまり、（1.B）にはりんご～うどんまでが改行して入力してある状態が完成です。 それをループして、(6.B)にはたい焼き～ももまでが改行して入力したいです。 好物と記入してあるセルを目印に、それ以下の行にある文字列をマージしていくというマクロをつくっていきたいのです。 冗長な説明で大変申し訳無いのですが、本当に切羽詰まっているので何卒宜しくお願い致します。
お世話になります。 行数が変動する製品一覧に対して、フィルタの詳細設定で絞込をしたいと考えております。 製品一覧は、EXCELシートを開く際外部のDBから読み込んでいます。 ありえない行数を記述する方法でなんとかいきましたが、もっときちんとした方法があるのではないかと思い質問させていただきます。 案１：　駄目 可変範囲の名前を定義してやって駄目（フィルタが働かない） 名前：　△製品一覧 =OFFSET(製品一覧!$B$5,0,0,COUNTA(製品一覧!$B:$B),COUNTA(製品一覧!$5:$5)) Range("△製品一覧").Resize(RCnt, CCnt).AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:=Range("$D$1:$E$3"), Unique:=False 案２：　駄目 VBA内で行数をカウントしてRangeをResizeしてみましたが駄目（フィルタが働かない） RCnt = WorksheetFunction.CountA(Sheets("製品一覧").Rows(5)) ' CCnt = WorksheetFunction.CountA(Sheets("製品一覧").Columns(2)) ' Range("$B$5").Resize(RCnt, CCnt).AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:=Range("$D$1:$E$3"), Unique:=False 案３：　OK これは無いだろうという行数を固定で記述してOK Range("$B$5:$P$99999").AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:=Range("$D$1:$E$2"), Unique:=False
VBA初心者です。 ACCESS VBAからExcelブック２のシート「データ①」をExcelブック１のシート「データ①」へコピーしたいのですが、インデックスが有効でないとのエラーで先にすすめません。 どなたかをご教授願います。 Private Sub Ps_Excel_Data_Set() Dim strNewFileName As String Dim strOldFileName As String Dim xlApp As Object Dim xlBook1 As Object Dim xlBook2 As Object Dim xlSheet As Object strNewFileName = "c:\ブック1.xls" strOldFileName = "c:\ブック２.xls" 'エクセル展開 Set xlApp = CreateObject("Excel.Application") xlApp.Visible = False xlApp.UserControl = False xlApp.DisplayAlerts = False Set xlBook1 = xlApp.Workbooks.Open(strNewFileName) Set xlBook2 = xlApp.Workbooks.Open(strOldFileName) 'シート削除 xlBook1.Worksheets("DATA①").Delete xlBook1.Worksheets("DATA②").Delete 　 '****************ここでエラーが出ています！ 'シートコピー 'xlBook2.Worksheets("DATA①").Copy after:=xlApp.Workbooks(strNewFileName).sheets(1) 　 '************************************** 　 'エクセルファイルを閉じる xlBook2.Close (False) Set xlSheet = Nothing Set xlBook2 = Nothing 'エクセルファイルを閉じる xlBook1.Close (True) xlApp.Quit 'オブジェクトの開放 Set xlBook1 = Nothing Set xlApp = Nothing End Sub
お世話になっております。下記の部分でつまずいてしましました。 ご教授いただきたくお願いいたします。 Ｌ列に「時間：」という文字列 Ｍ列に「5:30:00」のような時間（セルの書式設定は「ユーザー定義　h:mm:ss」となっております） Ｎ列もＭ列と同様になっております（例として7:30:00） 下記のようなＶＢＡを組み、結果としては「時間：7:30:00/5:30:00」という形にしてＬ列に反映したいのですが…(3行目からスタートします） with range("L3") dim i as string i = 3 do until cells(i,13) = "" cells(i,12) = cells(i,12) & cells(i,14) & "/" & cells(i,13) i = i + 1 loop end with 環境：windows7　Excel2010 以上、よろしくお願いいたします。
お世話様です。Ａシートの(Ａ２：Ｆ１０)をＢシートの同じ場所に値だけの貼り付けをしたいのですが現在は一行づつクリップボード経由でＢシートに張り付けるやり方をしています。仕方なく計算式もそのままコピーしています。計算結果の値だけ貼り付けることは可能でしょうか。できれば行単位でなく上記の範囲で一回で済ませたいのですが。上記範囲の中には計算式の入っていないセルも含まれます。宜しくお願いします。
28人の子供の100m走の記録を元にリレーチームを作りたいと思います。 条件は、リレーは１チーム４人　それぞれのチームのタイム差ができるだけ少ない　としたいと思います。 30人全ての記録の組み合わせを作り、最も差が少ない組み合わせにしたらよいと思うのですが。 また30人の子供でおなじ4人組を作ったとしたら、2人あまるような場合はどうしたらよいでしょうか。 関数、VBA等を使ってできる方法を教えていただけないでしょうか。 windows7 excel2007 を使っています。
Excel Book AのSheet1には、その日の２種の売り上げと件数が自動計算されている。 Excel Book Bはサーバ内に在り、Sheet2上に前述の４つの値を日々蓄積したい。 具体的な動作は、 ①マクロONでBook A のSheet 1上の4セルのコピー ②Book BのSheet2を開く　 ③列　D、E、F、Gの最終空セルに項目①の4データの値をペースト ④データをセーブし、Book Bを閉じる ご教授よろしくお願いいたします。
データベースシートから、名前で検索して個人カードシートに表示するVBAを組みたいと考えています。VBAに関しては全くの素人で、最近始めたばかりです。個人シートから新規登録、検索、修正上書きがしたいと考えております。本を読んだり、ネットで検索したりしながら、基本となる意味を分からないままで作成してしまっています。新規登録はできるようになりました。が、検索のVBAを下記のようにするとエラーが出てしまいます。お恥ずかしい話ですが、基本が分かっていないのでなぜエラーになるのかも分かりません。 どうすれば、ちゃんとできるのか、ご教授いただけませんでしょうか。 個人カード　検索値（名前入力セル）はJ6 表示させたいセルは横一列になっていません。 表示範囲セルには”個人カード”と名前の定義がしてあります。 データベース（データ）のA：BBには”データ”と名前の定義がしてあります。 名前を入力するとデータより該当するレコードを検索して個人カードに表示させるというものです。 Sub 名前検索() Dim tmpInt As Integer, motoHani(), myRng As Range, i As Integer tmpInt = Sheets("個人カード").Range("J6").Value・・・←エラーになる motoHani = Array("J5", "Y6", "I12", "M12", "Q12", "U12", "Y12", "G11", "N11", "Y8", "S6", _ "W6", "J7", "S8", "J9", "S10", "S11", "Z11", "Y10", "E12", "C13", "C14", _ "C15", "C16", "C17", "K13", "K14", "K15", "K16", "K17", "T13", "T14", _ "T15", "T16", "T17", "AB13", "AB14", "AB15", "AB16", "AB17", "C18", _ "N18", "Y18", "AB6", "AF6", "AB8") Set myRng = Range("データ").Columns(1).Find(tmpInt, LookAt:=xlWhole)・・・←エラーになる If myRng Is Nothing Then MsgBox "該当するレコードはありませんでした" Exit Sub End If For i = 0 To UBound(motoHani) Range(motoHani(i)).Value = myRng.Offset(0, i + 1) Next End Sub 上記はネットで見つけたものをコピーして来たものです。ここはこうなのかな？といった感じで自分の状況に合うようにしてみましたが、間違っているようです。 申し訳ありませんが、説明もつけて教えていただけると、ありがたいです。 これができたら、次は修正したのち同じレコードの場所に上書きするというVBAを組みたいと考えおります。 どうかよろしくお願いいたします。
ユーザーフォームで、ある点に コントロールがあるかどうかを判定する方法はありますか？ できれば重なっている全てのコントロールの名前も取得したいです。 回答よろしくお願いします。
条件 B列に2～500まで、「ああ-○○」、「かか-▽▽」、…といったように、頭に２文字の目印を付けて、後半には長い文章が書かれて、1つのセルの中で文字列が何種類か並んでいます。 頭の２文字の目印を境目に2行追加したいのですが、どのようなマクロを書けばよいでしょうか？ ネットで見る限り、セル1つずつ検索して、上のセルと異なる場合は行を挿入、が適切に思いますが、頭の2文字の検索？をどうすればよいか思いつきません。 ちなみに、頭の2文字は、 ああ かか ささ たた なな と決まっています。。 http://www.asahi-net.or.jp/~zn3y-ngi/YNxv9482.html こちらの、 10 Dim 行 As Long 20 Const 列 = 7 '所属Ⅲの列 30 For 行 = Cells(Rows.Count, 列).End(xlUp).Row To 3 Step -1 40 If Cells(行, 列) <> Cells(行 - 1, 列) Then 50 Rows(行).Insert 60 End If 70 Next 行 を流用すると、 10 Dim 行 As Long 20 Const 列 = 2 30 For 行 = Cells(Rows.Count, 列).End(xlUp).Row To 3 Step -1 40 If Cells(行, 列) <> Cells(行 - 1, 列) Then 50 Rows(行).Insert 60 End If 70 Next 行 でもよいかと思ったのですが、頭の2文字の判定ができないので、使えない状況です。 セルの中の頭の2文字だけを判定するマクロは作れるでしょうか？ 上のものに追加してもらえると助かります。 また、これよりいいものがあれば、教えてください。
Sub マップリンク表示() Dim i As Integer For i = 2 To 36 ActiveSheet.Hyperlinks.Add Anchor:=Range("H" & i), _ Address:="http://maps.google.co.jp/maps?q=" & Range("G" & i).Value, _ TextToDisplay:="Map表示" ※G列に住所、H列にMAPリンク表示。 と記述すればマップリンクができますが、決まった拠点から（例えば東京駅）この住所のルート先表示をしたいです。どのように表記すればよろしいでしょうか？
エクセルの時間ですが １５分起きにタイマーアクションを作っています。 タイマーがセットアップされたら（実行ではありません） セットアップされた時間をセルに書き出しています。エラーログがわりです。 その内容が 2015/4/28 23:15 2015/4/28 23:30 2015/4/28 23:45 2015/4/28 0:00 2015/4/29 0:15 2015/4/29 0:30 で、２８日の　０時は　2９日の　０時　でないとおかしいのですが、２８日です 当然　０：00時の　作業は　行われませんでした。 変数は Public インターバル As Variant Public 反復時刻 As Variant　　です。以上は実行時の状態です で、今日　下記を作って実行（実行時も　同じロジックです。Debugが無いだけ） 反復時刻 = Date + TimeValue("23:30:00") Debug.Print 反復時刻 インターバル = TimeValue("00:15:00") Debug.Print インターバル 反復時刻 = 反復時刻 + インターバル Debug.Print 反復時刻 反復時刻 = 反復時刻 + インターバル Debug.Print 反復時刻 Exit Sub これで、 2015/04/29 23:30:00 0:15:00 2015/04/29 23:45:00 2015/04/30 2015/04/30 0:15:00 ４５分の次、日付は　１日繰り上がったのですが、時間がない で、 反復時刻 = Date + TimeValue("23:30:01") Debug.Print 反復時刻 インターバル = TimeValue("00:15:00") Debug.Print インターバル 反復時刻 = 反復時刻 + インターバル Debug.Print 反復時刻 反復時刻 = 反復時刻 + インターバル Debug.Print 反復時刻 反復時刻 = 反復時刻 + インターバル Debug.Print 反復時刻 2015/04/29 23:30:01 0:15:00 2015/04/29 23:45:01 2015/04/30 0:00:01 2015/04/30 0:15:01 １秒で　変数は　保たれる。現実的解決方法としては、有効ではあるのですが・・・ イマイチな気が Variant　　が　まずいのでしょうか？　Date　でも　同じでした。
早速ですが = VLOOKUP(C5880,'60min'!C$77:Q$5000,13,0)*$Q$6) のセル式が有ります。（検索元は　15minデータです） データ不一致など　検索に失敗することが有ります。すると、以降のセル式が　ＮＧで　無人運転ですので、プログラム的に止まります。 で、 =IF(ISERROR(VLOOKUP(C5880,'60min'!C$77:Q$5000,13,0)*$Q$6),Q5879, VLOOKUP(C5880,'60min'!C$77:Q$5000,13,0)*$Q$6)　と エラーの折、上の値で埋めると、プログラム的に止まることはありません。でも、検索失敗に気づかず、データが微妙にずれます。 で、 =IF(ISERROR(VLOOKUP(C5880,'60min'!C$77:Q$5000,13,0)*$Q$6),Q5879+0.1, VLOOKUP(C5880,'60min'!C$77:Q$5000,13,0)*$Q$6) と上の値に0.1　加算しました。 まあ、上の値が良いか、0.1足した方が良いか・・・ですが、通常、エラーが一度出ると、以降、不整合で、気が付くまでエラーが続きます。 上に値に0.1　加算しますから、気が付くまでに　かなり数値が大きくなっています。 エラーが出たら、どこかのセルの色が変わるとか、数値を変えないで、警告が出る様な方法はないでしょうか？ 色が変わるのは、該当セルでなくても、良いのですが（該当セルが一番いいのですが） とりいそぎ
エクセル マクロについての質問です。 チラシと在庫という異なるブックがあります。 チラシのSheet1は B列　商品コード 在庫のSheet1は F列　商品コード K列　在庫数 M列　発注数 という形でデータが入っています。 このチラシのB列の商品コードと在庫の商品コードを照合して一致したものの在庫数と発注数をチラシのH列とI列に貼り付けをしたいです。 自分でネットなどを参照してコードを作っていましたが分からずに在庫数をコピーして持ってくることもできませんでした・・・。 レベルが低くて申し訳ありません。 どなたかご教授願えないでしょうか。 よろしくお願いいたします。<b
VBAを使っていて Listviewで取り込んだファイルパスは d:\aaa\ABC.txt のようにドライブレターが小文字になります。 一方で With CreateObject("Scripting.FileSystemObject") For Each f In .GetFolder(Path).SubFolders f.path を使って取り込んだファイルパスは D:\aaa\ABC.txt のようにドライブレターが大文字になります。 これは drive_let = UCase(Left(ListView1.ListItems(2), 1)) For cnt1 = 1 To filenum0 ListView1.ListItems(cnt1 + 1).Text = drive_let & Mid(ListView1.ListItems(cnt1 + 1), 2) Next cnt1 のようにしていちいちドライブレターだけ大文字か小文字に変換する必要がありますか？ ドライブレターの指定方法があれば教えてください。
VBAを使っていて Open filepath For Binary As #1 Dim tmp_short() As Integer ReDim tmp_short(xlim) Get #1, , tmp_short(1) Get #1, , tmp_short(2) Get #1, , tmp_short(3) ・・・・ のようにして、バイナリデータをひとつずつ読んでいくことができます。 これはひとつずつ進んでいきますが ひとつ後ろに戻ったり、指定行まで飛んだりするにはどうしたら良いですか？ WS
お世話になります。 vbOKとか　vbWhite　とかの様な定数一覧表を VBのHelp機能で捜していますが見つかりません。 他でも結構ですので、一覧表が載っているサイトがありましたら、ご紹介下さい。 よろしくお願いします。
SQL文について教えて頂ければとおもいます。 VB2005とAccess2007を組み合わせて下記を作っています。 売上テーブルには下記のレコードが入っています。 売上日、商品、数量 4/10　　商品A　　2 4/10　　商品B　　3 4/10　　商品A　　2 4/10　　商品C　　1 4/10　　商品B　　1 4/11　　商品A　　1 4/11　　商品B　　2 4/11　　商品C　　3 4/11　　商品C　　2 4/11　　商品A　　2 4/11　　商品B　　4 商品は3種類しかなく、日付ごとの3種類の売り上げ数量を1行に表示したく、 COUNT やGROUP BYを組み合わせていろいろ試行錯誤していますが、 うまくいきません。 イメージは下記になります。 日付　商品A　商品B　商品C 4/10　　4　　　　　4　　　　1 4/11　　3　　　　　6　　　　5 そもそもSQLでは上記のイメージにできないのでしょうか？ ご回答よろしくお願いします。
エクセルVBAを使用して、VLOOKUPと全く同じことがしたいです。 A列にある項目の最終行まで、B列にVBAでVLOOKUPみたいなことをさせたいです。 sheet1 A列　　　B列 りんご　　10円 みかん　　30円 ばなな　　40円 sheet2 A列 みかん　　10円 りんご　　30円 ばなな　　40円 エクセルバージョンは2013です。
エクセル2010のマクロを作ったのですが、順調に動いている途中で、VBA起動後に編集を開始すると、直後にクラッシュしてしまいます。 クラッシュ開始の直前に、ネットで見かけた便利そうな文を追加したら、クラッシュし始めました。 エラーの文章は この問題の説明に役立つファイル: c:\temp\444228.cvr c:\temp\WERE10D.tmp.hdmp と表示されるのですが、全く意味が分かりません。 コントロールパネルから、 エクセルの修復 は実施しましたが、状況は変わりません。 マクロ添付可能ファイルにしているので、元となったエクセルファイルは別にバックアップを取っているのですが、マクロの文章を記録していないので、また一からやり直すのが嫌なので、なんとか復旧できないか、もしくはマクロの文章だけでも抜き出せないか？と思っています。 このファイルは捨てるべきなのでしょうか？ また、マクロは個人ブックなどに記録すべきなのでしょうか？
https://code.msdn.microsoft.com/office/VBACRC-32 … このページのプログラムでは「% & $」という文字が使われています。 これを使用する意味を教えてください。 例えば、 Public Function GetCrc32FromFile&(Path$) Dim R&, I&, B As Byte, FN%, FL& のところです。 関数名の後ろに　& 、　引数に$　が入っており 変数の定義にもなぜか& や%　が入っています。 検索しても分かりませんでしたので教えてください。
Zフォルダ内(下に複数のフォルダがある)pdf fileが入っており、エクセルのA列(A2～Axx)に入っている名前のものをXフォルダにCOPYする方法を教えて頂けませんか？※Zフォルダの中のどのフォルダに入っているかはpdfファイルによりバラバラです。よろしくお願いします。
初心者です。 VBSからPOST送信を行い、PHPで受け取りたいです。 例えば、NAME="123"というPOSTデータをPHPに送り PHP側で受け取ったPOSTデータのNAMEに値が入っていればOKを返すような簡単なものを作りたいです。 PHP側は何も考えずとも簡単に実装出来るんですが、VBSからPOSTデータを送る方法が いまいちわかりません。わかる方教えていただければ幸いです、、、。
VBAでの質問です。 フォルダの中に20個ファイルがあり、１つにつき1チームのデータが入っており、それらの決められた位置にある値を別の１つのファイルにある表に転記させたいです。 また転記する際に参照した数値が入っているファイル名も同じようにセルに転記させたいのですがそのようなマクロを組むことは可能でしょうか。 サッカーチームの表を20チーム分こういうイメージで作りたいです。 勝 負 分 浦和 ４ ３ １ 川崎 ２ ２ ２ 横浜 ２ ４ １ チーム名が参照したいファイル名で横の数字がそのファイルの中にある数値です。 勝負分の数値はA2～C2のセルにそれぞれあります。 それぞれの数値の転記先のファイル名はチーム別結果表 転記するセル位置は浦和がB1～D1 川崎がB2～D2 横浜がB3～D3 以下は徐々に下へ またA１に浦和 A２に川崎と数値の前にファイル名も転記させたいです。 よろしくお願いします。
csvファイルをエクセルで読み込みデータの配置を変えたいです。 csvファイルを読み込む際にデータの区切り位置でカンマ区切りにし 今は下記のような配置になっています。 文字列　文字列　文字列　文字列　日付　時刻　時刻　文字列　文字列　(たまに空白)... と文字列と日付、時刻、空白が混ざってます。 また、不規則な並び順になっています、 それをとりあえず改行させたいと思っています。 =OFFSET(Sheet1!$A$1,INT(ROW(A1)/100),MOD(ROW(A1)-1,100)) を使い改行することはできるのですが、文字列と日付、時間が混ざっているので 日付や時刻が文字列になってしまします。どのようにすれば時刻、日付を区別することができるでしょうか。 よろしくお願いします。
フォーム内に表示しているクエリのレコードを選択し、 選択したレコードのフィールドの値を取得（変数に入れる） するにはどうしたらよいか？ 変数　=　Me.オブジェクトの名前.Form.CurrentRecord とすると選択されたクエリ自体のレコード番号は取得できるのですが・・・
EXCEL VBAでの質問です。 VBAはまったくの初心者なのでマクロの記録でコードを作りました。 Sub sample() Range("D4:N4").Select Workbooks.Open Filename:= _ "\\192.168.30.11\nas1\00917397\デスクトップ\新しいフォルダー\課\医事課.xlsx" Range("T5:AD5").Select Selection.Copy Windows("院内.xlsm").Activate Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False End Sub 値を集計させたい集計ファイル[院内]に、値を参照したい[医事課]ファイルのセル(T5:AD5)をコピーし院内のD4:N4にペーストするという処理です。 また値を参照したいファイルは医事課の他に[総務課] [看護1A.1B～9A.9B]など課というフォルダに一緒に入っています。(参照したいセルは全部同じ) ここで質問なのですが、院内のEXCELファイルの表ににペーストするときには下のように 医事課　D4:N4(医事課ファイルのセルT5:AD5の値) 総務課　D5:N5(総務課ファイルのセルT5:AD5の値) 看護1A D6:N6(看護1AファイルのセルT5:AD5の値) 下に下にとペーストしていきたいです。 上記のコードを()内を変えてひとつひとつ作ろうかと思いましたが実質変わるのは("D4:N4")のセルとファイルの名前だけなので 他の処理を繰り返し、すべてのファイルに対応できるコードがないかと思いました。 ずうずうしいですが今回はコードを拝借させていただきたく思っております。よろしくお願いします。
くわしい方、よろしくお願いいたします。 ＜したいこと＞ 表１のようなデータがあるとします。これをD列の数字に応じて、表2のようにコピー行をその数字の数だけ作りたいのです。もちろん、手作業で「コピー→行挿入」を繰り返せばできますが、いかんせん実際はデータ量が多いため大変です。これを簡単に行う方法はないでしょうか。 表１ 　　　A列　　　B列　　　C列　　D列 １　ポテト　　120円　　12/2 3 ２　チョコ　　150円　　３/5　 5 ３　クッキー　200円　　 5/3 2　 表２ 　　　A列　　　B列　　　C列　　D列 １　ポテト　　120円　　12/2 3 ２　ポテト　　120円　　12/2 3 ３　ポテト　　120円　　12/2 3 ４　チョコ　　150円　　３/5　 5 ５　チョコ　　150円　　３/5　 5 ６　チョコ　　150円　　３/5　 5 ７　チョコ　　150円　　３/5　 5 ８　チョコ　　150円　　３/5　 5 ９　クッキー　200円　　 5/3 2 10 クッキー　200円　　 5/3 2 シートは別に作成されると、なおよいです。
院内という集計ファイル１つ 看護1A～看護9Aまでの参照ファイルが9つ (どちらもEXCEL) ①Aのシートでマクロの仕組まれたボタンを押す。 ↓ ②看護1A～看護9AのファイルのそれぞれのセルT5～AD5までの値を参照する。 ↓ ③参照した値を看護A1から順に 院内シートのD4～N4に看護1AのT5～AD5 　　　　　　D5～N5に看護2AのT5～AD5 といった流れで9Aまで転記させたいです。 上記のように活用できるコードを教えてください。お願いします。
来訪された方（ゲスト）のデータを入力するのに困っています。 エクセルには、 A列：ゲストの名前 B列：ID（任意） C列：対応者の名前 D列以降：日付、ゲストの情報、対応内容情報など が転記されるようにVBAのユーザーフォームで入力フォームを作りました。 しばらくはこのまま使用していましたが、同じゲストに対して数回対応することが多くなりました。 今は、 エクセルの検索機能で名前かIDを検索→ 入力フォームを立ち上げて情報を入力しエクセルに転記→ 一度フォームを閉じてから再びエクセルで検索をする→ 入力フォームを立ち上げて情報を入力→ と続けており、かなり面倒です。 そこで、入力フォーム上で名前もしくはIDの検索をできるようにするVBAプログラムを教えていただけないでしょうか？ ・たとえば「鈴木」と検索したら「鈴木Aさん」「鈴木Bさん」「鈴木Cさん」が候補として表示される。 ・その候補名と一緒、それぞれのIDも同時に表示される。 ・いずれかの「鈴木さん」を選んだら、ユーザーフォーム上のテキストボックス「name」と「id」に選んだ「鈴木さん」が入力される。 ＜できれば＞ ・候補名とIDのセットが重複していた場合は、1組だけ候補に表示されるプログラム →同じゲストの数回分のデータが入力されているため よろしくお願いいたします。
EXCEL VBAでの質問です。 集計用のファイル１つと参照するファイルが30あります。 参照するファイルは基本的に書式は全部同じで数値だけが違い、参照させたいセル位置は全て同じです。 そしてAにある表にこのように転記させたいです。 B 1 2 4 6 2 5 C 4 5 3 7 8 4 D 2 3 7 5 3 2 この時いちいち別のコードで１つ１つのファイルを転記させるのではなく30のファイルをひとまとめに転記させるコードを作りたいと思っています。 もしわかる方がおりましたらコードをよろしくお願いします。
私はあるIT企業に勤める会社員です。 vb.netで社内用アプリケーションを、私一人で開発することになりました。 そこで質問なのですが、vb.netで開発する場合、マイクロソフトに対して何らかの費用を支払う必要はあるのでしょうか？ たぶん支払う必要はないのだろうなと思っているのですが、じゃあマイクロソフトは.NETに関してどうやって金を稼いでるんだ？？という疑問が湧いてきまして・・・ なお、開発環境にはMicrosoft Visual Basic 2010 Expressを使用する予定です。 ご回答よろしくお願いします。
あるYというフォルダ内にエクセルファイルが複数入っています。 Xという別のエクセル(データベース)があり、A列(A2～Axx)にYフォルダ内に入っているエクセルファイル名が記載しており、そのファイルを上から順に開き、ある処理をしたあとＺというファルダに保存することを繰り返します。その際、A列に同じ名前のファイルもある(同じ名前のものでも処理が異なる。Xのエクセルファイルの行の方でコントロール)ため、一度処理したものの場合、上書き、もしくはエラー？になってしまう？と思われる為、同じファイルの処理の場合、エクセルファイル名の後ろに-1、-2、-3・・・・みたいな感じで保存したいのですが、そのようなことは可能でしょうか？
以下のプログラムをあげます。 Private Sub cmdkuku2_Click() '定数 Dim i As Integer '最初の数字 Dim j As Integer '最初の数字にカケル数字 Dim kake As Integer '掛け算 Dim msg As String '並べる '初期値 msg = "" 'カウント For i = 1 To 9 For j = 1 To 9 kake = i * j kake = Str(kake) msg = msg & " " & kake Next j MsgBox msg Next i End Sub こうした場合、ダイアログボックスに返ってくるものは、 1 2 3 4 5 6 7 8 9 次 1 2 3 4 5 6 7 8 9 2 4 6 8 10 12 14 16 18 次 1 2 3 4 5 6 7 8 9 2 4 6 8 10 12 14 16 18 3 6 9 12 15 18 21 24 27 次 続く にだんだん増えていきます。 プログラム内はどのように処理してるのでしょうか？ よろしくおねがいします。
現在出納帳を作成中です。入力はすべてuserformから行っており削除もuserformか行っております。 しかし出納帳だけは削除したい行をクリックすると削除のuserformが表示されボタンを押すと実行されます。ボタンを押したら削除userformの日付、費目、内容が完全一致したら（出納帳）別シートの該当する行も一緒に削除できればと思います。別シートは科目ごとに計14シートあります。 （例）1、出納帳で削除したい行を選択 　　　２、userformで内容を確認し削除を実行 　　　 3、関連する別のシートの行も自動削除 いろいろためしましたがうまくいきませんのでどなたかアドバイスお願いいたします。 （出納帳のみ削除） Private Sub 削除_Click() MsgBox ("削除します。よろしいですか") ActiveSheet.Unprotect Selection.Range(Cells(1, 1), Cells(1, 8)).Delete Shift:=xlShiftUp（範囲指定） Unload Me End Sub
下記に記載しているものは、開いているエクセルファイル"X"に記載している文字(B列("B2"から記載)に対して、該当する"O"フォルダ内の複数のエクセルファイルを開き、書き込み(ファイルXに記載している事項)をして閉じるPROGRAM(B列記載の文字列を繰り返しで全て処理)なのですが、一番上に記載している文字のもの以外は一度の処理で終わるのですが、一番上の文字のものは何度も同じ処理を繰り返す(最初は書き込みされるが、次は書き込みが空欄で上書きされる)状態で、原因が分かりません。非常に分かりにくいかもしれませんが、もし分かれば、ご教授願えないでしょうか？(当方VBA初心者の為、分かりにくくて申し訳ありません。またおかしい構文があれば、教えて頂けると助かります。 Sub 書き込み() Dim myPath As String Dim myFile As String Dim myFiles As String Dim 書き込み１ As String Dim 書き込み2 As String Dim Number As Integer Dim Column As Integer myPath = "C:\O\" Column = Range("B2").CurrentRegion.Rows.Count For Number = 2 To Column myFile = Cells(Number, 2) 書き込み1 = Cells(Number, 1) 書き込み2= Cells(Number, 3) myFiles = Dir(myPath & myFile & "*.xls*") If Dir(myPath & myFile & "*.xls*") <> "" Then Workbooks.Open myPath & myFiles ActiveSheet.Range("H8") = 書き込み1 ActiveSheet.Range("J4") = 書き込み2 Worksheets.Select ActiveWorkbook.Close True Else MsgBox "処理を中断しました" Exit For End If Next Complete = MsgBox("処理が完了しました。", vbOKOnly + vbInformation, "確認") ThisWorkbook.Close SaveChanges:=False End Sub
VBAで表示と違うシートの印刷についていろいろ調べてみたんですが、うまくいかなかったので質問させてください。 Ａというシートを表示しているときに、 Ｂというシートを、Ａをアクティブにしたまま印刷します。 その際、ページ範囲を指定するのですが、 １つめの指定は開始頁のセルがＤ３で終了頁のセルがＥ３です。 ２つめの指定は開始頁のセルがＤ４で終了頁のセルがＥ４です。 ３つめの指定は開始頁のセルがＤ５で終了頁のセルがＥ５です。 そこで１つ条件があるのですが、 指定ページのセルが空白だった場合、エラーを表示せずにその次の印刷条件を実行する。という動きをしたいのです。 （Ｄ３とＥ３が空白だった場合はエラーを表示せずにＤ４～Ｅ４を印刷するといった感じです） お忙しいかとは思いますが気が向いたときにでもお教え願えれば幸いかと思いますのでよろしくお願いいたします。
すいません。 教えて下さい。 1024~65535までの数字範囲を正規表現でヒットさせたいです。 得に言語は問いませんが、私はVBSで実装しようとしています。 よろしくお願いします。
次のプログラムを ﾀﾞｲｱﾛｺﾞﾎﾞｯｸｽ１個目 1 2 3 4 5 6 7 8 9 OKを押すとﾀﾞｲｱﾛｺﾞﾎﾞｯｸｽ２個目 2 4 6 8 10 12 14 16 18 OKを押すと・・・以下略 Private Sub cmdkuku_Click() '変数 Dim i As Integer 'カウント Dim j As Integer 'カウント Dim kake As Integer '掛け算 Dim msg As String '並べる '初期値 msg = "" 'i*j For i = 1 To 9 For j = 1 To 9 kake = i * j kake = Str(kake) msg = msg & " " & kake Next j msg = msg & vbCrLf Next i MsgBox msg End Sub どこをどのように変えると上記のようにﾀﾞｲｱﾛｺﾞﾎﾞｯｸｽを返すことができますか？ よろしくお願いします。
VBAでフォルダを指定してエクセルファイル名を検索し、ファイル名のリストを作成しようとしています（Excel2010)。フォルダおよびファイルを連番で名づけた順に取得したいのですが、検索するフォルダが、01**,02**,03**・・・110**という連番で名づけられていた場合、検索順が、01,02,03,・・・09,110,111,112、・・となり、連番順に検索できません。1,2,3,・・・10,11・・と名付けると、1**からではなく10**から検索されてしまいます。 01,02,03**・・順で取得する方法と、1,2,3**・・の連番順で取得する方法を教えていただけるでしょうか。 よろしくお願いします。 Sub FileSearch(strPath As String) Dim fso As Object Dim strFolder As Variant Dim strFile As Variant Dim strPathExcel() As String Dim l As Long Set fso = CreateObject("Scripting.fileSystemObject") For Each strFolder In fso.getfolder(strPath).subfolders Call FileSearch(strFolder.Path) Next strFolder l = 0 For Each strFile In fso.getfolder(strPath).Files If InStr(strFile.Type, "Excel") > 0 Then ReDim Preserve strPathExcel(l) strPathExcel(l) = strFile.Path l = l + 1 End If Next strFile End Sub
たびたび質問をさせていただいてすみません 以下のプログラムをあげます。 Private Sub cmdsktuisi2_Click() '定数 Const A = 60　'基準となる点 '変数 Dim sugaku As Integer '数学の点 Dim kokugo As Integer '国語の点 '初期値 sugaku = InputBox("数学の点数を入れなさい") sugaku = Val(sugaku) kokugo = InputBox("国語の点数を入れなさい") kokugo = Val("kokugo") 'IF式　数学のテストは合格か？ If sugaku >= A Then If kokugo >= A Then MsgBox "追試になりません" Else MsgBox "追試です" End If Else MsgBox "追試" End If End Sub メッセージボックスに何もいれないときは、エラーとしてかえすことにします。 こんかいのプログラムを実行すると、何の数値を入れても”追試です”と返します。数学も国語も基準点以上の場合はちゃんと”追試にはなりません”と返したいのですが・・・。
今、画面でテキストが5行、それぞれ表示されてるとします あるイベントが発生した時に、例えばその中の3行目を非表示にします。 （visible=false等で非表示にします） その時に4行目、5行目を上につめたい（4行目、5行目を元々の3行目、4行目の位置に表示させる） このようにしたいのですが、 実際組み込むと上手くいきません。（3行目が空いたように表示される） それぞれのテキストをTopで位置を指定してます。（Topで細かく指定したい） この指定が悪いのでしょうか 初心者の質問ですみませんが、よろしくお願いします。
プログラミング初心者です。 Javaで作成したWebサービスを .NETで呼び出す方法がわかりません。 json形式、JBossを使用しています。 ご助力いただけないでしょうか、よろしくお願いします。
下記のプログラムをあげます。 Private Sub cmdatai_Click() '変数 Dim n As Long '代入された値 '入力用のﾀﾞｲｱﾛｸﾞﾎﾞｯｸｽ表示（初期値） n = InputBox("整数を入れてください") n = Val(n) 'IF式　値が入ってされていない時 If n = "" Then MsgBox "値が入力されていません" If (n Mod 2) = 1 Then '奇数のとき MsgBox "奇数です" ElseIf (n Mod 2) = 0 Then '偶数のとき MsgBox "偶数です" Else MsgBox "０です" End If End If End Sub 見直したのですが、プログラムが何をダイアログボックスに入れてもプログラムが動きません。 どこがおかしいのでしょうか？ ちょいミスだとは思うのですが、どうしてもわかりません。 よろしくお願いいたします。
画像を貼り付けたexcel ブックが何百個あります、印刷した時に画像が重くて、貼った画像が印刷できなかったりしますので、ブックに貼った画像を圧縮してブック保存することにしました。 excelブックを一つずつ開いて図を圧縮し保存するのが手間なので、マクロでできないかと、探してみたんですが、なかなか見つかれない。 ファイル開いて保存し閉じるマクロ見つけたんですが、画像の圧縮部分をどのように書けばいいのか わからなくて、皆さんに助けを求め質問させていただきました。 excelに貼った画像枠の大きさはばらばらです、サイズを指定せずに、図形だけ圧縮、トリムしたいです。 マクロで圧縮トリムできるなら、画像の圧縮部分をどのように書けばいいのか教えてください。 よろしくお願いします。 下のマクロがファイル開いて保存し閉じるマクロです。 Private Sub CommandButton1_Click() ' フォルダ参照ダイアログを利用して、フォルダを特定する。 Dim folderName As Variant Set folderName = CreateObject("Shell.Application") _ .BrowseForFolder( _ &O0 _ , "フォルダ選択" _ , &H1 + &H10 _ , "ﾃﾞｽｸﾄｯﾌﾟ") ' フォルダが選択されたか否か判別する。 If folderName Is Nothing Then MsgBox "中止します" Exit Sub End If ' 単純なループカウンタ Dim lp1 As Long, lp2 As Long ' FileSystemObjectを作成する。 Dim Obj As Object Set Obj = CreateObject("Scripting.FilesystemObject") ' 選択されたフォルダ配下に存在するファイル名を取出す為の変数 Dim fileName As String Dim fileNames() As String ReDim fileNames(0) As String ' 選択されたフォルダ配下に存在するファイル名を取出す fileName = Dir(folderName.Self.Path & "\*.xls") Do While fileName <> vbNullString ' ファイル名を配列に取込む。 ReDim Preserve fileNames(UBound(fileNames) + 1) As String fileNames(UBound(fileNames)) = _ folderName.Self.Path & "\" & fileName fileName = Dir() Loop ' 全てのExcelファイルを順次開いて閉じる。 For lp1 = 1 To UBound(fileNames) ' 開いたファイルのブック名を取得する。 Dim bookName As String bookName = Obj.GetFileName(fileNames(lp1)) ' 開いたファイルの全シートを全て参照する。 For lp2 = 1 To Workbooks(bookName).Sheets.Count ' *************** ' 集計処理を行う ' *************** Next ' 開いていたExcelファイルを保存して閉じる。 Workbooks(bookName).Close SaveChanges:=False Next ' メモリを解放する。 Erase fileNames ' オブジェクトを破棄する。 Set Obj = Nothing Set folderName = Nothing End Sub
userformがbookを立ち上げると同時に全画面表示になります。Userformにはエクセルと言うコマンドボタンがあります。このコマンドボタンを押すと転記元のエクセルシートが表示できるようにしたいのですがアドバイスお願いします。普段はuserformが表示されていて転記の確認の為にエクセルを見ようと思います。よろしくお願いします。
以下のプログラムをあげます。 Private Sub cmdcade_Click() '定数 Const a = #5/3/2015# '変数 Dim dt1 As Date 'クレジットカードの有効年数 Dim risule As Boolean 'このクレジットカードが使えるか？ '初期値 dt1 = InputBox("クレジットカードの有効年日を、「月/日/年」と入力して下さい") '比較 result = a <= dt1 '表示 MsgBox "このクレジットカードは使えますか？　" & result End Sub dt1はインプットボックスからとってきたのですが、最初最後に#がつきません。ためしにつけてみるとエラーになります。 最初は、VBA特有の勝手にdateに判断してくれるのかな？と思ったのですが、この＃＃間の　月/日/年　は、インプットボックスから返すので文字列ですよね。最初最後になぜ　＃＃　がつかなくても大丈夫なのですか？
Excel2003です。 列は決まっていますが、行数はその都度変わります。 何十列、何万行あります。 数人が使うので並べ替えのユーザー設定リストを登録する使い方は出来ません。 どのようにして並べ替えるのがよろしいでしょうか？
VBAで、比較のBooleanで定義したものを、メッセージボックスやテキストボックスに表示させるとき、Sｔｒ（）として、文字列に変換なくてもよいのですか？ VBAは勝手に文字列として認識してくれます。一般的にはどうなのでしょうか？
お世話になります。マクロは全然分からないのですが、どうやらマクロで可能なようですので、質問させてください。 宜しくお願い致します。 【質問】複数のhtmlファイルが保存してあります。その各htmlファイルから、適切な部分を抜き出してエクセルに貼り付けたいのですが、どうすれば良いでしょうか。 例）dbr02.html、4107989208.html、45_3d.html という３つのファイルがあったとします。（実際は数千ファイルあります） それぞれのファイルから、商品番号、商品名、キャッチコピー、商品説明文、商品画像を抜き出して、エクセルに貼り付けるには、マクロでどのように記述すれば良いでしょうか。 ------------------------------------------------------------------------------------------------- ※各セルに挿入したいデータは下記の通りです。 【A1～E1】1行目は取り込みデータではなく、文字列です。 セルA1:商品番号、B1:商品名、C1:キャッチコピー、D1:商品説明文、E1:商品画像 【A2～E2】 dbr02.htmlから抜き出した「商品番号」「商品名」「キャッチコピー」「商品説明文」「商品画像」をそれぞれ、A2、B2、C2、D2、E２へ取り込む 【A3～E3】 4107989208.htmlから抜き出した「商品番号」「商品名」「キャッチコピー」「商品説明文」「商品画像」をそれぞれ、A3、B3、C3、D3、E3へ取り込む 【A4～E4】 45_3d.html から抜き出した「商品番号」「商品名」「キャッチコピー」「商品説明文」「商品画像」をそれぞれ、A4、B4、C4、D4、E4へ取り込む 以下、同様に、保存してある全てのファイルを取り込む。取り込む順番はランダムで大丈夫です。 ------------------------------------------------------------------------------------------------- 【その他仕様】 htmlファイル保管場所：C:\Users\moto\Desktop\data 商品番号：半角英数字、アンダーバー、半角ハイフンが使用されている場合があります。 ソースについて：それぞれ、下記のくくりで、記載されています。（＊が抽出したい部分です。また、該当する箇所は各ファイルに１ヵ所しかありません。） <th>商品管理番号</th><td>＊＊＊＊＊＊</td></tr><tr><th>ブランド名</th> <!--商品名-->＊＊＊＊＊＊<!--/商品名--> <!--キャッチコピー-->＊＊＊＊＊＊<!--/キャッチコピー--> <!--商品コメント-->＊＊＊＊＊＊<!--/商品コメント--> <!-- 商品詳細画像 --><div style=" height:1px; width:1px; overflow:hidden;"><img src="＊＊＊＊＊＊" alt="" class="imageborder" name="photoName1" id="photoName1" onClick="overSizeLink('photoName1')"><br></div><!-- ／商品詳細画像 -->
サブフォームを埋め込んだメインフォームがあります。 メインフォームにはサブフォームのフィルタのボタンがあり、テキストボックスに検索文字を入力しボタンを押せばフィルタするようになっています。 今のコードは検索1ボタンを押せば[製品規格サブ]のサブフォームからコードNoを検索しフィルタするようになっています。 Private Sub 検索1_Click() On Error GoTo Err_検索_AfterUpdate Dim stDocName As String 　stDocName = "コードNo Like '*" & Me!検索 & "*'" Me![製品規格サブ].Form.Filter = stDocName Me![製品規格サブ].Form.FilterOn = True Exit_検索_AfterUpdate: Exit Sub Err_検索_AfterUpdate: MsgBox Err.Description Resume Exit_検索_AfterUpdate End Sub このコードに追加、修正をお願いしたいのですが、 コードNoでフィルタした後にさらに別のテキストボックス、別の検索ボタンを作り、社名でもフィルタをできるようにしてもらいたいです。 今のコードと同じようなものを作っても、コードNoで検索をした後社名で検索するとコードNoのフィルタが消えてしまいます。 いくつフィルタボタンを作成し押しても重ね掛けできるようなコードを教えてもらいたいです。 よろしくお願いします。
①　次の表データの各社の科目欄は、まちまちですが、②の標準科目で整理する場合 社名 大科目 科目 　　　　　　2000 2010 A社 資産 現金・預金 　　　　　418525 463782 A社 資産 財政融資資金預託金 540470 637720 A社 資産 貸出 　　　　　　　　4166238 4542799 A社 資産 株式以外の証券 　　1049146 1188598 A社 資産 株式・出資金 　　320016 368177 A社 資産 金融派生商品 　　　　　　0 0 A社 資産 預け金 　　　　　　21856 24492 A社 資産 企業間・貿易信用 　　　　　　0 0 A社 資産 未収・未払金 　　104541 116420 A社 資産 対外直接投資 　　　3510 3751 A社 資産 対外証券投資 　　　25627 31240 A社 資産 その他対外債権債務 28006 30998 A社 資産 その他 　　　　　　32028 36363 A社 資産 合計 　　　　　　　6709963 7444340 A社 負債 現金・預金 　　　　3296197 3612754 A社 負債 財政融資資金預託金 846623 1000549 A社 負債 貸出 　　　　　　　　935185 997042 A社 負債 株式以外の証券 　　543956 602144 A社 負債 株式・出資金 　　192739 246563 A社 負債 金融派生商品 　　　　　0 0 A社 負債 保険・年金準備金 　　　432124 499327 A社 負債 預け金 　　　　　　34000 35555 A社 負債 未収・未払金 　　　199602 242116 A社 負債 その他対外債権債務 　4025 4927 A社 負債 その他 　　　　　　30647 40155 A社 負債 金融資産･負債差額 194865 163208 A社 負債 合計 　　　　　　　6709963 7444340 ②　標準科目（Worksheet(2))は、以下のとおりです。 現金・預金 財政融資資金預託金 貸出 株式以外の証券 株式・出資金 金融派生商品 保険・年金準備金 預け金 企業間・貿易信用 未収・未払金 対外直接投資 対外証券投資 その他対外債権債務 その他 資金過不足（金融取引表） 金融資産・負債差額(金融資産・負債残高表) 合計 ③　出来上がりの形は、①の表に②の標準科目がない場合には、不足する標準科目を該当位置に行挿入する（データ欄は、空欄）。つまり、すべての会社の科目の内容を②の標準科目の並びにしたいのです。 ④　そこで作成したコードは、以下のとおりですが、無限ループになってうまくいきません。 どこがおかしいのでしょうか？どなたかご教示いただけないでしょうか。 Sub 科目整列() Dim i As Integer Dim j As Integer Range("c3").Activate Do While ActiveCell.Value <> "" For j = 2 To 18 If ActiveCell.Value = Worksheets(2).Cells(j, 4).Value Then ActiveCell.Offset(1, 0).Activate Else Selection.EntireRow.Insert ActiveCell.Value = Worksheets(2).Cells(j, 4).Value ActiveCell.Offset(1, 0).Activate End If Next j Loop End Sub
ＶＢＡ初心者です。 どなたか教えてください。 先日も同じような質問をさせていただき、かなり理想に近い回答を いただきましたが、自力では どうしても解決に至らず再度投稿させていただきました。 下記の様な表があります。 [やりたいこと] ①Ａ列を最初にみて、文字列の　”０”　ｏｒ　”02”　を判断します ②Ａ列が2であれば、となりのセルＢ列をみます 　Ａ列が1であれば上に次に進む ③Ｂ列の数字の分だけ　その下に行を追加し 　追加した行には、同じ内容をコピーします。 ④さらに③で増やした行の個数は、1へ変更し元の行も 　1へ変更します。 ⑤ Ｄ列の重量は按分させ、最後の部分でＲＯＵＮＤダウン 　　させたいです。　　 ⑤最後に処理完了のメッセージＢＯＸ [結果]　表1を　表2の様な形にしたいです。 表1 業者 個数 記事 重量 2 　4 　A 　8 2 　3 　B 　9 2 　2 　C 　10 1 　1 　D 　4 2 　1 　E 　6 1 　2 　F 　3 2 　5 　G 　15 表2 業者 個数 記事 重量 2 　1 　A 　2 2 　1 　A 　2 2 　1 　A 　2 2 　1 　A 　2 2 　1 　B 　3 2 　1 　B 　3 2 　1 　B 　3 2 　1 　C 　5 2 　1 　C 　5 1 　1 　D 　4 2 　1 　E 　4 1 　2 　F 　10 2 　1 　G 　3 2 　1 　G 　3 2 　1 　G 　3 2 　1 　G 　3 2 　1 　G 　3 どうかお願いいたします。
エクセルで「シート１元台帳」と「シート２請求書フォーム」を同じブックに入れてあります。 シート１ 　　　　A　　　 　B　　　C　　　　　D　　　　E 1行目　担当者　　日付　　 内容　　売上金額　　備考 2行目　データ　　データ　データ　 データ　　　データ 　↓　 データ　　･･･　　　･･･　　　･･･　　　　･･･ 　↓　　　･･･　　･･･　　　･･･　　　･･･　　　 シート２ F3　 日付　　 F5　 担当者 A6　 内容　　 C8　 売上金額　　 A12　備考 のようにコピーして請求書を印刷したいと思います。 シート１の元帳にはデータが増えていくので、その中から カーソルを置いたセルの行を行ごと選択をして、 選択した行の該当列の情報をコピーし、使いたいと考えています。 行を選択するまではできたのですが、 それを別シートに移すことができなくて手こずっています。
http://oshiete.goo.ne.jp/qa/8953402.html このページで日時の出力方法について教えていただきました。 配列aaa(0)に日時が入っており、 Forループを使って、0.3秒ずつ増やしていくようなことがしたいのですが ミリ秒の扱い方がどうしても分かりません。 aaa(0) = DateSerial(2015, 2, 24) + TimeSerial(16, 23, 16) For i = 1 to 256 aaa(i) = aaa(i - 1) + 0.3 / 24 / 3600 bbb(i) = Format(aaa(i), "yyyy_mmdd_hhnn_ss.fff") next i というようなことがしたいのですが bbbにミリ秒まで代入するにはどうしたら良いですか？
エクセルVBAで新規シートを作成するマクロを作りました。 この作成した新規シートにマクロを登録しているボタンなどを配置することはできるでしょうか？ その方法があれば教えてください（どういう検索でたどり着けるかでもOKです） よろしくおねがいします。
エクセルVBAのユーザーフォームでアンケートシートを作っています。 オプションボタン3つとコンボボックス1つで、和暦西暦とそれに対応する年数を表示したいと思っています。 オプションボタン３つのオブジェクト名はそれぞれ、 showa heisei seireki となっており、コンボボックスは bd_year としています。 下記のように作ってみたのですが、うまくいきません。 どなたか、教えていただけませんか。 よろしくお願いします。 Private Sub bd_year_DropButtonClick() Dim A1 As String, B1 As String, C1 As String Dim i As Integer A1 = v For v = 1 To 64 Next v B1 = w For w = 1 To 30 Next w C1 = x For x = 1925 To 2020 Next x If showa.Value = True Then Me.bd_year.List = A1 End If If heisei.Value = True Then Me.bd_year.List = B1 End If If seireki.Value = True Then Me.bd_year.List = C1 End If End Sub
『 '文字列に直す answer = Str(answer) '値をtwxtBoxに返す。 txtall.Text = answer』 と、 『'値をtwxtBoxに返す。 txtall.Text = Str(answer)』 とでは微妙に値の返し方がずれます。 前述より後述のほうが、テキストBOXでの値が少し右にずれます。 どうしてでしょうか？
https://oshiete.goo.ne.jp/qa/8952035.html 前回質問では、shell実行した後待機、終了後に次行へうつりました。これを変更し、shell実行後は別なvba処理をしつつ終了監視し、終了したら別のshellを実行したいのです。 どうすればいいでしょうか？
はじめまして。 下記のようにA列にデータがあるとき、 A列　　　　　　　　　　　　　　　　　　　　　　　　　B列 資産・現金・預金／金融機関／ストック　　　　　　　　　（空欄） 資産・－現金／金融機関ストック 資産・－日銀預け金／金融機関ストック 資産・－流動性預金／金融機関ストック 資産・－定期性預金／金融機関／ストック 資産・－譲渡性預金／金融機関／ストック 資産・－外貨預金／金融機関／ストック 資産・財政融資資金預託金／金融機関／ストック 資産・貸出／金融機関／ストック （この場合は、／　以降が同じ文字列ですが、実はこの後のデータで、様々なものが、たくさん出てくるのでこの最初の　／　の記号以降を削除したいのです） 右隣の空欄のB列に表記の編集データを格納するプログラムとして Sub Test() Dim i As Integer Dim s1 As String For i = 1 To 9 s1 = Cells(i, 1).Value Cells(i, 2).Value = Left(s1, Len(s1) - InStr(1, s1, "／") - 1) Next i End Sub を実行しましたら、B列には、 資産・現金・預金 資産・－現金／ 資産・－日銀預 資産・－流動性預 資産・－定期性預 資産・－譲渡性預 資産・－外貨預金 資産・財政融資資 資産・貸出／金融 となってしまい、うまくいきません。 希望としては 資産・現金・預金 資産・－現金 資産・－日銀預け金 資産・－流動性預金 資産・－定期性預金 資産・－譲渡性預金 資産・－外貨預金 資産・財政融資資金預託金 資産・貸出 としたいのです。 そこで質問です。 ①　このプログラムのどこがおかしいのでしょうか？ ②　次に、B列を新たに作らずに、A列に編集したデータを出したいのですが 　　どうすれば良いのでしょうか？ どなたか、ご教示いただければ幸いです。 よろしくお願いいたします。
エクセル２０１３でセルについているコメントが数行に改行して記入してあります。このコメントの一部（例えば2行目だけや3行目だけ等）をVBAで参照する方法をどなたか教えてもらえますでしょうか。
http://blog.livedoor.jp/goji_da_tsuji/archives/5 … このページにある方法を使って ファイルの作成日時や更新日時を書き換えたいと考えています。 そのためには date型の変数に任意の日時を代入する必要があります。 （例：2015年2月24日16:23:16） date型の変数は http://www.exvba.com/blog/?p=1721 このページにあるように 1899年12月30日から起算して何日目にあるかを代入する必要があります。 年によって日数が異なるため、単純に365を年数にかけるというわけにはいきません。 どうすれば 任意の日時をdate型で宣言した変数に代入することができますか？
ＶＢＡ初心者です。 下記の様な表があります。 [やりたいこと] ①Ａ列を最初にみて、1ｏｒ2を判断します ②Ａ列が2であれば、となりのセルＢ列をみます 　Ａ列が1であれば上に次に進む ③Ｂ列の数字の分だけ　その下に行を追加し 　追加した行には、同じ内容をコピーします。 ④さらに③で増やした行の個数は、1へ変更し元の行も 　1へ変更します。 ⑤最後に処理完了のメッセージＢＯＸ [結果]　表1を　表2の様な形にしたいです。 表1 Ａ列　Ｂ列　　 業者 個数 記事 2 4 A 2 3 B 2 2 C 1 1 D 2 1 E 1 2 F 2 5 G 表2 Ａ列　Ｂ列　　 表2 業者 個数 記事 2 1 A 2 1 A 2 1 A 2 1 A 2 1 B 2 1 B 2 1 B 2 1 C 2 1 C 1 1 D 2 1 E 1 2 F 2 1 G 2 1 G 2 1 G 2 1 G 2 1 G どなたかご教示お願いいたします。
数学に関するソフトを作っていますが、変数(アルファベットの小文字)は教科書で、CenturyOldStyleのイタリック体とGeorgiaのイタリック体が混じったようなローマ字です。イタリック体でないと「ｘ」と「×」は見分けるのが難しいし、イタリック体にすると「()」は斜めになってしまいます。 　改変して使いたいのですが、もちろん販売目的ではありません。どのようにすれば許可してもらえるでしょうか。いえ、連絡先さえわかればなんとかなると思いますが…。英語は無理です。 　どなたか、ご存じありませんか。宜しくお願いします。
Excel VBA初心者です。 以下のVBAを簡略化したいのですがどうすればいいでしょうか？ Sub Macro1() Dim cnt As Long, cnt2 As Long, cnt3 As Long, cnt4 As Long, cnt5 As Long, cnt6 As Long, cnt7 As Long, cnt8 As Long, cnt9 As Long, cnt10 As Long, cnt11 As Long, cnt12 As Long, cnt13 As Long, cnt14 As Long, cnt15 As Long, cnt16 As Long, cnt17 As Long, cnt18 As Long, cnt19 As Long, cnt20 As Long, cnt21 As Long cnt = Evaluate(&quot;SUMPRODUCT(((F:F)=I9)*((G:G)=H10))&quot;) cnt2 = Evaluate(&quot;SUMPRODUCT(((F:F)=J9)*((G:G)=H10))&quot;) cnt3 = Evaluate(&quot;SUMPRODUCT(((F:F)=K9)*((G:G)=H10))&quot;) cnt4 = Evaluate(&quot;SUMPRODUCT(((F:F)=L9)*((G:G)=H10))&quot;) cnt5 = Evaluate(&quot;SUMPRODUCT(((F:F)=M9)*((G:G)=H10))&quot;) cnt6 = Evaluate(&quot;SUMPRODUCT(((F:F)=N9)*((G:G)=H10))&quot;) cnt7 = Evaluate(&quot;SUMPRODUCT(((F:F)=O9)*((G:G)=H10))&quot;) cnt8 = Evaluate(&quot;SUMPRODUCT(((F:F)=P9)*((G:G)=H10))&quot;) cnt9 = Evaluate(&quot;SUMPRODUCT(((F:F)=Q9)*((G:G)=H10))&quot;) cnt10 = Evaluate(&quot;SUMPRODUCT(((F:F)=R9)*((G:G)=H10))&quot;) cnt11 = Evaluate(&quot;SUMPRODUCT(((F:F)=S9)*((G:G)=H10))&quot;) cnt12 = Evaluate(&quot;SUMPRODUCT(((F:F)=T9)*((G:G)=H10))&quot;) cnt13 = Evaluate(&quot;SUMPRODUCT(((F:F)=U9)*((G:G)=H10))&quot;) cnt14 = Evaluate(&quot;SUMPRODUCT(((F:F)=V9)*((G:G)=H10))&quot;) cnt15 = Evaluate(&quot;SUMPRODUCT(((F:F)=W9)*((G:G)=H10))&quot;) cnt16 = Evaluate(&quot;SUMPRODUCT(((F:F)=X9)*((G:G)=H10))&quot;) cnt17 = Evaluate(&quot;SUMPRODUCT(((F:F)=Y9)*((G:G)=H10))&quot;) cnt18 = Evaluate(&quot;SUMPRODUCT(((F:F)=Z9)*((G:G)=H10))&quot;) cnt19 = Evaluate(&quot;SUMPRODUCT(((F:F)=AA9)*((G:G)=H10))&quot;) cnt20 = Evaluate(&quot;SUMPRODUCT(((F:F)=AB9)*((G:G)=H10))&quot;) cnt21 = Evaluate(&quot;SUMPRODUCT(((F:F)=AC9)*((G:G)=H10))&quot;) Range(&quot;I10&quot;).Value = cnt Range(&quot;J10&quot;).Value = cnt2 Range(&quot;K10&quot;).Value = cnt3 Range(&quot;L10&quot;).Value = cnt4 Range(&quot;M10&quot;).Value = cnt5 Range(&quot;N10&quot;).Value = cnt6 Range(&quot;O10&quot;).Value = cnt7 Range(&quot;P10&quot;).Value = cnt8 Range(&quot;Q10&quot;).Value = cnt9 Range(&quot;R10&quot;).Value = cnt10 Range(&quot;S10&quot;).Value = cnt11 Range(&quot;T10&quot;).Value = cnt12 Range(&quot;U10&quot;).Value = cnt13 Range(&quot;V10&quot;).Value = cnt14 Range(&quot;W10&quot;).Value = cnt15 Range(&quot;X10&quot;).Value = cnt16 Range(&quot;Y10&quot;).Value = cnt17 Range(&quot;Z10&quot;).Value = cnt18 Range(&quot;AA10&quot;).Value = cnt19 Range(&quot;AB10&quot;).Value = cnt20 Range(&quot;AC10&quot;).Value = cnt21 End Sub かなりの初心者ですのであまり難しくないように回答頂ければ助かります。 現状で動かすとかなり処理が遅いので困ってます。
下記のURLはいずれもshellアプリケーションの終了を監視するものです。 https://support.microsoft.com/en-us/kb/408064/ja http://www.seiji-tsubosaki.net/ExcelTech/ExcelVB … 上はマイクロソフトのものですが、Excel97用です。これの2010版はないでしょうか？また、下は2010版で動きますか？ボリュームの差が大きいようですが、機能的に何か違いがあるのでしょうか？
よろしくお願いします。 Private Sub 印刷_Click() Me.Refresh Dim stDocName As String stDocName = "管理票" If Me.製品規格サブ.Form.FilterOn Then DoCmd.OpenReport stDocName, acViewPreview, , Me.製品規格サブ.Form.Filter & "AND 印刷='P'" Else DoCmd.OpenReport stDocName, acViewPreview End If End Sub フォームでフィルタした後、印刷ボタンを押せば印刷フィールドにPと入力したものだけが印刷されるようになっています。 この印刷した後に、自動でPを消すコードの追加をお願いしたいです。印刷フィールドのデータをNullにするでも構いません。 毎日何十回と印刷するので、そのたび更新クエリで印刷フィールドをNullにしていては手間が相当なので印刷後、自動でPを消すようにしたいです。 印刷フィールドは短いテキスト型です。 よろしくお願いします。
VB6で開発したソフトをVB2010で作り直しています。 VB6でリストボックスに Format(Format(i, "##0"), "@@@")(iは1から100)と入れると、一の位が右揃えになるのですが、 VB2010では@@@と表示されてしまいます。 VB6と同じように表示したい場合は、どうすれば良いのでしょうか?
VBAの質問です。 B行に入力があるとA行に日付が入り、それに加えてC行に入力があるとD行に関数を出てくるようにしたいです。 下のVBAだとselect caseと最初のcaseの間のステートメントが適切でないとエラーがでます。どう修正すれば良いのかわかりません。 ご教授お願いします。 Private Sub Worksheet_Change(ByVal Target As Range) With Target If .CountLarge > 1 Then End Select Case .Column Case 2 If .Value <> "" Then .Offset(, -1) = Date Else .Offset(, -1).ClearContents End If Case 3 If .Value <> "" Then .Offset(, 1) = "=""数式""" Else .Offset(, 1).ClearContents End If End Select End With End Sub
フォーム名は製品一覧で、製品一覧がレコードソースのテーブルです。 メインフォームの中に製品一覧のサブフォームがあり、サブフォームはデータシートビューです。 フィールドには管理Noがあり、オートNoで1～5000までレコードがあります。 ここから、例えば管理No10の製品をレポートで印刷したい場合は、管理No10の印刷フィールドにpと入力すれば管理No10のレコードのみがレポートで印刷される仕組みになっています。 この時に、印刷フィールドにpと入力されたレコードの管理Noを使って画像をレポートに挿入し印刷できるコードはありますか？ 感じ的には、管理Noが10なので、画像ファイル名も10.jpgにしておき同じ番号をLookupしてくる、みたいな感じです。 他の方法でもいいので、画像を抽出しレポートで印刷できるようにしたいのですが可能でしょうか？ データが5000もあるので、画素ファイルはマイピクチャなどの外部に保存しておきたいです。 よろしくお願いします。
If文やFor-Nextループ等で字下げをするインデント処理、このサイトで質問回答をする際には、普通には使えないハズです。ところが、質問回答を見ていると、なぜか出来てる人もいます。どうやってるのでしょうか？
他サーバからファイルをダウンロードしようとしてます。日付指定です。タイムスタンプが日付１～日付２の間のファイルをコピーします。元ファイルフォルダにあるファイル全5千個から300個を選びコピーする形となります。 Dim f As Object Dim FSO As New FileSystemObject Dim Path1 As String, Path2 As String Dim filename As String Path1=’元ファイルのフォルダパス Path2='ダウンロード先のフォルダパス filename='コピーしたいファイル名 For Each f In FSO.GetFolder(Path1).Files If f.DateLastModified >CDate('日付1指定) And f.DateLastModified <CDate('日付2指定) then If f.Name Like "*" & filename & "*" then FSO.CopyFile f.Path, Path2, True End If End If Next f 問題点 実際のコピー作業以前に、５千個から条件に該当するファイルを選び出すのに時間が掛かり過ぎます。最初の条件該当が出て１個目コピーが始まるまで５分程度。ほぼ一瞬で終わることを期待してましたが、違いました。一個のコピー時間は現在不明です。 次善の策 一旦バッチファイルに以下のように出力すると、待ち時間なくコピー開始されます。 xcopy path1\*finename path2\ /d:月-日-年 しかし１個当たりのコピー時間が4秒と長いです。さらに日付は日付１しか指定出来ません。つまり○月×日以降のファイルを全部コピーします。 要は、速く期間指定でコピーしたいのです。何か良い方法はないでしょうか？
Excel2013を使用しています。 以前、Excel2003を使用していたときは、 Shift + F2⇒プロシージャや変数などの定義元へジャンプ、 Ctrl + Shift + F2⇒Shift + F2でジャンプした直前の位置へ戻る ができていましたが、 Shift + F2⇒は使えるのですが、Ctrl + Shift + F2　だと　印刷になってしまいます。 どのキーでできるのでしょうか？
MidとMid$の使い分けについて教えてください。 http://www.tsware.jp/labo/labo_32.htm このページにあるように $が付いた関数は文字列型の値を返し、付いていないものはバリアント型の値を返す、あります。 つまり、出力先が 数値と文字列が混在した配列（つまりvariant型）のみに$無しを用いて、 それ以外の場合には$有りを用いるということでしょうか？ 合っていますか？
Windows7 EXCEL2010です。 ユーザーフォームのテキストボックスに、ユーザーフォームがアクティブの際に自らのファイル名を表示するようにしています。しかしＡｕｔｏＣｌｏｓｅでユーザーフォームを表示後にエクセルを保存終了するように組むと、ファイル名が表示されないまま終了してしまいます。ファイル名を表示して終了させるマクロを教えて頂けると幸いです。
当番表を創る為、名簿を含むユーザーフォームを同時に表示させて人名を選ばせています。 終了したらunload命令を出して、フォームを閉じていますが、閉じるマーク×で途中閉じられないようにするにはどうしたらいいですか？
Windows7　Access2010を使ってVBAを組んでいます。 1つのフォームに2つのテーブルデータをもとに各々別々のリストボックスを作り、それぞれから値を 取得することはできますでしょうか？ 例：フォームにコンボBOX1+テキストBOX1をつくりこちらにはリストBOXAから値を選択して、値を代入 また、別操作でリストBOXBから値を取得して、コンボBOX1+テキストBOX1とテキストBOX2 テキストBOX3に値を代入 1.フォームのレコードソースは[テーブル＿いいい]として、 2.リストBOXAは非連結で値集合ソースは[テーブル＿あああ]からSELECTして表示しています 3.リストBOXBは非連結で値集合ソースは[テーブル＿あああ]と[テーブル＿いいい]の結合したものを SELCTして表示しています。 今はできているのは、リストBOXAをクリックすると、リストBOXBのリストBOXAのインデックスの値の[テーブル＿いいい]のデーターだけが表示されるということになっています。 標題のようなことができるかどうか、またそのような説明がある、ホームページや、ブログがありましたら、合わせてお教えいただけますでしょうか。 よろしくおねがいいたします。
Excel VBAを使っていて 512×512の二次元配列をクリップボードにコピーして シート上でペーストすることでシートに貼り付けられるようにしたいのですが どうすれば良いですか？ https://oshiete.goo.ne.jp/qa/5650002.html 検索すると単一の変数のクリップボードへの転送方法に関しては このページなどにたくさん見つかるのですが 配列を転送方法について書かれたページが見つかりませんでした。 とりあえず、 Open filepath3 For Output As #1 でタブ区切りのファイルとして一時保存した後に .SetText FSO.GetFile(filepath3).OpenAsTextStream.ReadAll .PutInClipboard Readallで読み込むことで所望の操作を行うことができました。 しかし、HDDに一時ファイルを生成せずに 直接配列からクリップボードにコピーする方法があれば教えてください。 さんざん検索しても分かりませんでした。
すいません。 教えて下さい。 タイトル通りなんですが自分自身が改竄されていないか確認したいです。 そこでMD5(外部ライブラリ使用)を利用してハッシュ値のつけ合わせをと考えたのですが そもそも、MD5のハッシュ値をVBSプログラムに追加した時点で、当然また値が変化してしまうのですが どうにかして実装する事は可能でしょうか？ MD5変更後のハッシュ値が、わかれば良いのですが、、、（＞＜； よろしくおねがいします。
VBAを使って、 例えば、行番号5～10と20～30、50～60の三カ所のセルを選択した状態で 行番号を全て取得したい場合 ccc = 0 For Each c In Selection.Rows ccc = ccc + 1 Row0(ccc) = c.Row Next c で取得することができます。 ここで三カ所の領域毎に配列を分割したいのですが For i = 2 To row_num0 If Row0(i) - Row0(i - 1) > 1 Then を使って行をひとつずつ調べていって、 配列から別の配列に入れ直しいくしかないでしょうか？ もっと簡単な方法があれば教えてください
VBA初心者です。 セルを別シートにコピーするマクロを作成を２個作成したのですができれば結合したいと思いいろいろ試しているのですがどうしてもうまくいきません。 どなたかご教授いただければ幸仁です。 コードは下記のように組んでいます。 どうかよろしくお願いいたします Sub jisseki_copy() Dim strdate As Date strdate = Cells(246, 2) Application.ScreenUpdating = False Range("b245:AI339").Select Selection.Copy Sheets("ｆｌｇ_data").Select Cells(1730, 3) = strdate Range("c1731").Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Sheets("週間印刷").Select Range("A1").Select End Sub Sub keikaku_copy() Dim strdate As Date strdate = Cells(371, 2) Application.ScreenUpdating = False Range("B370:AI464").Select Selection.Copy Sheets("ｆｌｇ_data").Select Cells(3730, 3) = strdate Range("C3731").Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Sheets("週間印刷").Select Range("A1").Select End Sub 上記マクロを１つのマクロにしたいのです。
512×512の二次元配列データが入ったバイナリデータを読み込んで ワークシートのセルに出力するプログラムと ワークシートのセルの内容をタブ区切りのテキストデータとして出力するプログラムを VBAを使って、作りたいと考えています。 普通にバイナリデータを二次元配列に読み込み for y = 1 to 512 for x = 1 to 512 Cells(x, y) = hairetu (x,y) next x next y というようにすると 10秒くらいかかります。 一方で バイナリデータを一度タブ区切りテキストデータとして出力後に 直接ワークシートに読み込ませると 一瞬で読み込むことができます。 なぜこのような速度差が生じるのでしょうか？ 配列の内容をワークシートを読み込ませたい場合 一度テキストデータを経由することなく高速で読み込ませるにはどうしたら良いですか？ ワークシートの内容をタブ区切りのテキストデータとして出力する場合も同様に forループを使って出力すると10秒程度時間がかかります。 一方で普通にExcelの保存機能を使うと 一瞬で保存することができます。 どうすればExcel機能と同じくらいの速度でタブ区切りデータとして保存することができますか？
VBAで 現在のワークブックのセルを指定したい場合 ThisWorkbook.Worksheets("Sheet1").Cells(5, 2) のようにして指定することができます。 一方で 現在のワークブックのユーザーフォームを指定したい場合どうしたら良いですか？ ThisWorkbook.UserForm1.ComboBox5.Text としてもうまくいかないのですが
VBAでサイトからダウンロードしたExifReaderクラスをつかってJPEGファイルの 撮影日時を取得しようとしています。 ある画像ファイル（JPEG)を読み込もうとすると、オーバーフローエラーが発生します。 Dim objExif As New ExifReader objExif.Load "画像ファイルパス"　←この時 ちゃんと画像ファイルを読み込んで、撮影日時を取得できるものもあります。 画像ファイルのプロパティを確認しても違いがわからないです。 ダウンロードしたクラスによるかともおもうのですが、原因および対処方法がございましたら 教えていただきたいです。（何らかの方法で画像ファイルを変更するとか？） よろしくお願いします。 Excel2010 Windows7
excelで、値の集計とグラフを表示させるマクロをVBAで作成しています。 集計する値の元がGoogleドキュメントのスプレッドシートに格納されていて、週末に更新されます。 今は、コピペでexcelシートに値をコピペして持ってきて集計しています。 この作業を自動化させ、Googleドキュメントのスプレッドシートにある値を参照するようにしたいのですが可能でしょうか？
以下のプログラムを挙げます。 Private Sub cmdcaki_Click() '変数と定義 Dim caki As Integer 'ケーキ一個の値段 Dim kosuu As Integer '買う数を数値変換 Dim answer As Integer '総額 '変数の初期値 caki = 280 kosuu = Val(txtkosuu.Text) '計算 answer = kosuu * caki '答えを表示 MsgBox "1個　" & caki & "円のケーキを " & kosuu & "個買うと " & answer & "円になります。" End Sub ”買う数”のテキストボックスに小数点を入れてしまったときに、「整数値で入力してください」とエラーボックスを出したいのですけどどのようにしたらいいですか？
エクセルでリストから出荷日を拾って表に自動で展開されるようなものを作成したいのですが、 複雑で悩んでいます。 品名　　　　出荷日　　　　　数 メロン　　　3/15　　　　　10 バナナ　　　3/18　　　　　30 キウイ　　　3/20　　　　　5 上記のような表を、下記のような表に作り変えたいのですがどのようにマクロを組んだらできるのでしょうか？ 　　　　　　　　　　　　　　　　　出荷日 品名　　　　～3/13　3/14　3/15　3/16　3/17　3/18　3/19　3/20～　　　　　　　　 メロン　　　　　　　　　　　10　 バナナ　　　　　　　　　　　　　　　　　　　　　30 キウイ　　　　　　　　　　　　　　　　　　　　　　　　　　　　5 品名と日付が合う場所を探して数欄を自動入力するようにしたいです。 申し訳ありません。 お力をお貸しください。
FormにButtonを配置し、クリックイベントで処理をする場合、高々3個のButtunの場合 Private Sub btn_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btn1.click,btn2.click,btn3.click …… End Sub で簡単ですが、ひらがななら46個?、アルファベットなら26個のボタンを配置し、上記のコードのHandles以下もその数分記述しなければいけません。とてつもない作業です。 　調べてみると、例えば Dim btn as Button()=New Button(){btn1,btn2,…} のように配列をつくり、 AddHandler btn(i).Click, AddressOf プロシージャ で処理をすれば良いとのこと。 　しかし、考えてみますと「AddHandler btn(i).Click, AddressOf プロシージャ」の記述があるプロシージャにはどういけばよいのでしょうか。あくまでも、Clickイベントなんですよね。 …Handles btn().Click　なんて動くはずもないし…。どうか宜しくお願いします。
以下のプログラムを上げます。 Private Sub cmdhirei2_Click() '変数と定義 Dim a As Single '単位グラム Dim b As Single '単位グラムの値段 Dim c As Single '買うグラム Dim answer As Single '払う値段 '変数の初期化 a = 100 b = 350 c = 380 '計算 answer = b * c / a '答えを表示 MsgBox "買った肉の値段は　" & answer & "円です。" End Sub なぜ変数がSingleでなければいけないのでしょうか。 Integerでは処理が止まってしまいます。 Integerでは小数点は四捨五入されてまるめこまれて整数になるので、32768の絶対値を超えない限り使えると思ったのですが。 どなたか私の間違いを正してくれませんか？
Sub Main() Dim sales()() As Double = New Double(11)() {} Dim month As Integer Dim days As Integer For month = 0 To 11 days = DateTime.DaysInMonth(Year(Now), month + 1) sales(month) = New Double(days - 1) {} Next month End Sub VBのコードサンプルです。Microsoftのサイトにあります。ジャク配列の基本的なものです。考え的にはイメージできます。これをExcelのVBAに出来ないだろうかと苦戦してます。二次元の配列なら分かりやすいのですが…。これをExcelに置き換えることが出来ません。 どうか教えて下さい。
10.5をセルに入力したときに10:30という風に変換？表示させたいのですが 教えてもらえないでしょうか？
初めまして、 枠線だけによる円や矩形の描き方、そして枠線の色とは異なる色を背景色として挿入して、 さらにその中にフォントのプロパティを自在に指定できる方法を探しているのですが…！、 なかなかWebサイト等には見当たりません。どなたか、ご存知の方是非お教えください。
何が問題でしょうか？
もし何か方法があったら教えていただきたいです。よろしくおねがいします(切実)。 Excel2010VBAで、100万行程度のCSVデータを、ADODBを使用して読み込み、 WHERE条件にヒットした行の次のヒットしていない行のデータを取得したいです。 サンプルとして、CSVが以下のようになっているとして、 F1,F2,F3 あ,い,う え,お,か き,く,け こ,さ,し ※このようなデータがランダムに繰り返される これに対して Set DB = CreateObject("ADODB.Connection") Set RS = CreateObject("ADODB.Recordset") With DB .ConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & Path & ";" _ & "Extended Properties='Text;HDR=YES;FMT=Delimited'" .Open End With RS.Open "SELECT * FROM " & CSVFileName & " WHERE F1 = 'え'", DB, 1, 1 Debug.Print RS.Fields(0) & "," & RS.Fields(1) & "," & RS.Fields(2) このコードは100万件でも処理時間はとてもいいのですが、 この時の"き,く,け"のデータが取得したいのです。 WHERE句なしで、 RS.Open　"SELECT * FROM " & CSVFileName としてから、MoveNext等でループしてF1に"え"があった次の行を取得すればできるのですが、データが多いと、非常に遅くなってしまいます。 RS.Findを使用する方法もありますが、WHERE句での検索よりも処理時間がかかりました。 別の方法として、CSVに行番号を付加し、WHERE句にヒットした行の行番号+1を条件にSELECT文を投げたらできるかな?と思い、 '行番号のあるテーブルを新たに作成 Set Ca = CreateObject("ADOX.Catalog") Set DB = CreateObject("ADODB.Connection") Ca.Create "Provider=Microsoft.Jet.OLEDB.4.0;Data Source='" & DBFileName & "'" DB.Open "Provider=Microsoft.Jet.OLEDB.4.0;Data Source='" & DBFileName & "'" DB.Execute "CREATE TABLE TESTTB(ID INT IDENTITY(1,1) PRIMARY KEY ,F1 String,F2 String,F3 String)" 'CSVをインポート DB.Execute "INSERT INTO " & TableName & " SELECT F1,F2,F3 FROM [Text;database=" & Path & "].[" & CSVFileName & "]" とやってみましたが、Providerがおかしいせいか、エラーは発生しませんが、 ID列が自動採番されず、空になります。。。 一行づつINSERT INTOすればできますが、データが多いとやはり時間が非常にかかってしまいます。 何かいい方法はないのでしょうか??
userfomeに中にtextbox1があります。その隣にコマンドボタンがありボタンを押すと男と表示されます。しかしボタンを押した後、どこかにカーソルで移動しないと男が編集できません。コマンドボタンをみると押しっぱなしの状態です。アクティブセルにならない？解りづらいと思いますがアドバイスお願いします。 sub cud_click() Textbox1.text = "男" end sub 何か記述が足りないでしょうか よろしくお願いします。
A列の背景色を B列にR C列にG D列にB を表示したいです。 尚且つ、A列の背景指定が無くなるまでループさせたいです。 マクロ初心者なので、ぜひ教えてください。
セルA1～A10には「データの入力規則」の「リスト」を使った方法でデータが入力されています。 セルC1～C10にも「リスト」でデータが入力できるようになっていて、リストの中の「削除」を指定して入力すると入力した列と同じ列のA列のリストで入力したセルのデータのみが「削除」できるように VBA を使って実行したいのですが、ご指導をお願いします。
ユーザーホームで入力するとＡ１に転記されます。転記されたＡ！の内容を修正するのにＡ１をクリックするとユーザーホームが表示されると同時にＡ１の内容が一緒に表示されるようにしたいのですがうまくいきません。アドバイスお願いいたします。 現在はコマンドボタン2で呼び出しています。(123と表示できる） セルをクリックするとユーザーホームは表示されますがＡ１の内容が表示されません。最終目的は指定する行でクリックし情報を表示したいです。 現在のユーザーホームの内容(Userfome1) Private Sub CommandButton1_Click() Dim myrow As Integer With ActiveSheet If .Range("A1").Value = "" Then myrow = 1 Else myrow = .Range(Cells(.Rows.Count, 1). _ End(xlUp).Address).Row + 1 End If .Cells(myrow, 1).Value = TextBox1.Value End With End Sub Function 戻り() TextBox1.Value = Range("A1") End Function Private Sub CommandButton2_Click() Call 戻り End Sub シートの内容（sheet1) Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) If Target.Column <> 1 Then Exit Sub UserForm1.Show End Sub
添付画像のような結果になるプログラムをVBAで考えております。 Sheet2の検索ワードとSheet3のデータベースの整合までは考えれたのですが、 Sheet2の検索ワードとSheet3のデータベースのワードと適合した時にSheet2のB列にどのようにして 入力したいワードを引っ張ってくればいいのかわかりません。 ご教授お願いできますでしょうか？ 初心者ながら途中までは考えたのでコードを下記に示します。 考え方の間違い等がありましたら訂正してください。 説明不足かもしれませんが、よろしくお願いいたします。 Sub matching_sys() Dim Parts() As Variant, PartsCount As Long Dim LibParts() As Variant, LibPartsCount As Long Worksheets("sheet2").Activate PartsCount = Cells(Rows.Count, 1).End(xlUp).Row ReDim Parts(PartsCount) For i = 1 To PartsCount Parts(i) = Worksheets("sheet2").Cells(i, 1) Next Worksheets("sheet3").Activate a = Cells(Rows.Count, 1).End(xlUp).Row b = Cells(Rows.Count, 4).End(xlUp).Row LibPartsCount = a + b ReDim LibParts(LibPartsCount) For Each lp In Union(Range("A1:A" & a), Range("D1:D" & b)) For i = 1 To PartsCount If lp = Parts(i) Then 　　　「この部分の条件式または処理方法がわかりません。」 End If Next Next End Sub
http://www.officepro.jp/excelvba/dialog/index4.h … VBAで4種類の改行コードがあります。 しかしながら、以下のコードを実行してみたのですが 4種類とも全く同じダイアログが表示されます。 Sub テスト() MsgBox "こんにちは" & vbCr & "お元気ですか" MsgBox "こんにちは" & vbLf & "お元気ですか" MsgBox "こんにちは" & vbCrLf & "お元気ですか" MsgBox "こんにちは" & vbNewLine & "お元気ですか" End Sub http://ja.wikipedia.org/wiki/%E6%94%B9%E8%A1%8C% … 改行には本来 キャリッジリターンCR ラインフィードLF 2種類あり、それぞれ、タイプ位置を一番左端に移動させる、タイプ位置を真下に移動させる、 という機能なそうなのですが、 実際には、この4種類ともCR+LFの機能が動作しているようです。 http://oshiete.goo.ne.jp/qa/4004349.html この質問ページには、OSによっては CRだけでもCR+LFの動作をするというようなことが書かれてあります。 でもVBAは基本的にWindows上でのみ動作することが前提に置かれていると思います。 それでは、どういう時に 上記の4種類のコードが違って表示されるのでしょうか？
VBAを使ってバイトの定義された変数の引き算を行いたいのですが 以下のコードをするとオーバーフローしてしまいます。 Sub test() Dim a As Byte Dim b As Byte Dim c As Integer a = 50 b = 100 c = a - b End Sub この場合、 Dim d As Integer d = a c = d - b とするしかないですか？ もっと良い方法があれば教えてください。
VBAで、コマンドプロンプトを実行する objWSH.Run strShellCommand(i), vbNormalNoFocus, True コマンドプロンプトを実行し、パラメータを取り出す Set wExec = WSH.Exec("%ComSpec% /c " & """" & sCmd & """") 'Set wExec = WSH.Exec("%ComSpec% /c " & sCmd) Do While wExec.Status = 0 DoEvents Loop Result = wExec.StdOut.ReadAll という二つの方法がありますが、 実行後にコマンドプロンプトのウインドウを閉じないで待機するにはどうしたら良いですか？ sCmd = xxxxx & vbCr & " pause" のように改行後にpauseが入るようにしてみたのですが うまくいきませんでした。 どうすれば良いでしょうか？
ネットで見たりつなぎ合わせたりやってみたのですが、初心者のせいか、うまくいきませんでした。 やりたいことは次のとおりです。 シート“0202”のようなシートを日付ごとに作成しておきます。2月は19営業日なので19シートをあらかじめ作成しておきます。 構成は日付シートはすべて同じです。。データ数とB列の「R」がどの行に入るかはその日によって違います。 マクロボタン（各日付シートに作成）をクリックする方法でお願いします。 コピー後に表示されるシートは、日付シートのままにしたいです。 １．入力するシートを選択すると、メッセージBOXを表示する。「OK」をクリックして 　　BOXが消えるようにする。 　　　　内容：今日のシートか確認してください。 　　　　　　　すべての入力が終わってからマクロボタンをクリックしてください。　　 ２．B列の「R」が入力されている行のデータ（D～J列、L～Q列）を、 　　シート”急ぎ分”の空白行（添付図の11行目）に値コピーする。 ３．シート”急ぎ分”の「備考」に①のシートのR列にある日付をコピーする。 　　（コピーしたデータが3行なら3行とも） ４．３．の後に、メッセージBOXを表示する。 　　　　内容：再度コピーするときは、最初に”急ぎ分”の今日コピーしたデータを削除してください」 画像の一番下のは、シートの並び順です。念のために添付しました。 説明が分かりずらい所がある場合は、すみません。どうぞよろしくお願いいたします。
form1上に　button1 と　textbox1 を張り付けてください。 辺の長さ　r1,r2,r3 が同じになるはずですがなりません。どなたか。助けて下さい。 私は、dimの　integer,singleか、パソコンの解像度の問題か？とも思いますが？ よろしくお願いします。 pblic Class Form1 Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click Dim g As Graphics = Me.CreateGraphics Dim x1, y1 As Integer '点A の座標 Dim x2, y2 As Integer '　点B の座標　 Dim x3, y3 As Integer '点Cの座標　　　点Aの周りにABを60度回転した点。 Dim r1, r2, r3 As Integer Dim rd As Single = 60 * 3.14159 / 180 '60度回転 x1 = 500 : y1 = 400 ' ' 点A x2 = 550 : y2 = 450 '点B g.DrawLine(Pens.Black, x1, y1, x2, y2) ' 直線　AB r1 = Math.Sqrt((x2 - x1) ^ 2 + (y2 - y1) ^ 2)　 'r1=AB x3 = 500 + r1 * Math.Cos(rd) y3 = 400 - r1 * Math.Sin(rd) r2 = Math.Sqrt((x3 - x2) ^ 2 + (y3 - y2) ^ 2) ' r2=BC r3 = Math.Sqrt((x3 - x1) ^ 2 + (y3 - y1) ^ 2) ' r3=AB TextBox1.Text &= "x3=" & x3 & vbCrLf TextBox1.Text &= "y3=" & y3 & vbCrLf TextBox1.Text &= "r1=" & r1 & vbCrLf TextBox1.Text &= "r2=" & r2 & vbCrLf TextBox1.Text &= "r3=" & r3 & vbCrLf End Sub End Class
今更なのかもしれませんが、2003・2007・2010で、ActiveXコントロールとフォームコントロールを意識せず全部ActiveXのコントロールをシートに貼り付けてプログラムを作っていましたが、いままで、不自由はありませんでした。ところが、 2013でプログラムを走らせると、エラーに成りそのコントロールを認識してくれません。 2013では　シートにActiveXコントロールは　貼り付けられないようです。 で、新たにフォームコントロールのパーツを貼り付けるのですが、プロパティーが　VBAというか、ActiveXとは全く異なり、例えば、オプションボタンは、プログラム分岐のフラグ代わりに使っていたのですが(VBAから　シート.orderInput_btn2.value = True　などと）、「マクロの実行」などと　出て、VBAに記載されたコードが選択できるようですが、VBAから　この、パーツは認識しない？（コードを書いても、お助け文字列が浮いてこないし、ドロップダウンにもない？）のですが・・・・ どこで、私は間違ったのでしょうか？それとも、これで、正しい？
visual studioexpress2013 for desktop を無償ダンロードして細々と勉強始めた全くの初心者ですが、最近になって ツールボックスの中に　image コントロールが無いことに気付きました。編集画面をイジリまわして 削除したのか、それとも２０１３版には元々ないのか？ imageコントロールは２０１３版にもあるのでしょうか、もしあるのなら、 復活する方法があったら教えていただけませんか。お願いします。
エクセルVBAのユーザーフォームだけ表示して エクセルシートを非表示にすることってできますか？ バグがあったりなどしてVBAがデバッグモードに入り強制終了してしまった場合 ユーザーフォームも同時に消えてしまい、 再度マクロの実行を行う必要がありますが、 自動的に復帰することは可能ですか？ どちらか片方でも良いので操作方法を知ってらっしゃったら教えてください。
VBAでシステム音を鳴らす方法 を教えてください。 簡単な方法として http://www.start-macro.com/55/w/s077.html beep BeepAPI Lib "kernel32.dll" Alias "Beep" という二つの方法がありますが、 この音ではなくwindowsの警告音や起動音やシャットダウン音などの システム音が使いたいのですがどうすれば良いでしょうか？ 検索しても分かりませんでしたので どなたか教えてください。
ExcelのVBAで、チェックボックス(ActiveXコントロール)を使用し、各セル毎に設定する方法を教えてください。 はじめまして、VBA初心者です。 下記のように、各セルにチェックボックスを設け、VBA（セル内を値のみにする＜Selection.Value = Selection.Value＞）で各セル毎にチェックボックスが機能するようにしたいのですが、どのようにすれば宜しいでしょうか？ 現状下記のようにチェックボックスを配置しております。 ・A列には各番号が振ってあります。 ・B列にチェックボックスを配置。 ・C列に関数＜=Today（）＞を使用して、設定してあります。 A B C 1 □ 2/23 2 □ 2/23 3 □ 2/23 4 □ 2/23 5 □ 2/23 VBA内での指示は以下になります。 Selection.Value = Selection.Value ひとつのチェックボックスにはVBAを設定することはできたのですが、各チェックボックス（B2-B5以下）への設定が難航している状態です。 ちなみに下記VBAを設定しました。 Sub 関数値変換() Range("c7").Select Selection.Value = Selection.Value End Sub ※また可能であれば、VBAと関数にて（もしくはいずれかで）、チェックボックスを使用時、TRUEであれば→selection.value、FALSEであれば元の関数に戻す、が行える方法を教えていただけますか。 大変申し訳ございませんが、皆様のお力添えのほどよろしくお願いします。
VBAで照合作業用マクロを作成しております。 初心者なのでネット検索などして作成しているのですが 重複データ同士の照合というものが見つからないため どなたかご教示いただけると助かります。 (OS-Windows7,Office2013) 作業内容： ①シート1とシート2のデータを売上番号と金額をキーにして照合する ②データが一致したシート2の該当行(同行横)へ、シート1の該当行を転記 ・シート1,2の売上番号と金額は重複を含む ・重複している売上番号等は、シート1,2で同数 ・データは各シート1,000行～1,200行 ・マッチング出来ないデータについては空白とする ======================================= ◆質問◆ 重複データの"Item"を転記する方法 (転記は金額を基準とする) ======================================= ○シート1（明細データ) 売上番号　金額　　Item1　 Item2 -------------------------------------- 44-3　　2,000　　500　　1,500 11-1　　1,000　　300　　　700 11-1　　1,000　　500　　　500 11-1　　1,500　　500　　1,000 22-4　　3,000　 2,000　　1,000 ○シート2(売上データ) 売上番号　金額　　氏名 ------------------------ 11-1　　　1,000　　佐藤 11-1　　　1,000　　佐藤 11-1　　　1,500　　佐藤 55-2　　　4,500　　上田 22-4　　　3,000　　松本 　　↓マクロを実行 ○シート2　完成表(希望) 売上番号　金額　　氏名　　Item1　 Item2 ------------------------------------------------ 11-1　　　1,000　　佐藤　　300　　700 11-1　　　1,500　　佐藤　　500　　500 11-1　　　1,000　　佐藤　　500　1,000 55-2　　　4,500　　上田　　　(空白) 22-4　　　3,000　　松本　2,000　1,000 ========================================== 下記マクロを実行した結果： 重複番号の"Item"列が1行しか転記されない->重複最終行のみ (ユニークの番号同士については問題なく転記される) ============================================= Sub TEST01() Dim sht1, sht2 Application.ScreenUpdating = False Set sht1 = Worksheets("Sheet1") Set sht2 = Worksheets("Sheet2") d = sht1.Range("A5536").End(xlUp).Row On Error Resume Next For i = 2 To d '条件設定 If sht1.Cells(i, "A") = sht2.Cells(i, "A") Then ElseIf sht1.Cells(i, "B") = sht2.Cells(i, "B") Then End If If sht1.Cells(i, "C") <> sht2.Cells(i, "C") Then 'Sheet2で該当行を検索 For r = 2 To 1000 If sht1.Cells(i, "A") = sht2.Cells(r, "A") Then Exit For Next r '該当行をSheet2へ転記 sht2.Cells(r, "D") = sht1.Cells(i, "C") sht2.Cells(r, "E") = sht1.Cells(i, "D") End If Next i Application.ScreenUpdating = True End Sub どうぞよろしくお願いします。
現在、秀和システムの「IEを自在に操るExel VBAプログラミング入門」を購入してVBAの勉強をしています。 その本のP.120でOffice.comからタイトルを取得するコードのサンプルがあるのですが、コンパイルエラーが出てしまい試行錯誤しても解決出来ず、行き詰ってしまいました。 その時のコードは下記となります。 ======================== Public Sub IE基本_リンク一覧を取得() Dim ie As New InternetExplorer ie.Navigate "http://office.microsoft.com/ja-jp/" ie.Visible = True While ie.Busy = True Or ie.ReadyState < READYSTATE_COMPLETE DoEvents Wend Dim doc As HTMLdocument Set doc = ie.Document Debug.Print doc.Title End Sub ======================== ちなみにエラーは ”コンパイルエラー： ユーザー定型型は定義されていません。” で恐らく”doc As HTMLdocument”に問題があるのかと思っているのですが、 どなたか教えていただけると幸いです。 こちらのPC環境はMicro soft Exel2010となります。
VBAでコマンドラインを使って表示された文字の取得を行いたいのですが Set wExec = WSH.Exec("%ComSpec% /c " & """" & sCmd & """") Do While wExec.Status = 0 DoEvents Loop Result = wExec.StdOut.ReadAll というコードを使って取得を行うことはできるのですが 一瞬だけコマンドプロンプトの画面が表示されるのですが これが表示されずに文字の取得を行うにはどうしたら良いですか？
ＶＢＡの勉強をしています。 データ型の値で分からないところがあるので質問させていただきます。 ①１．４E－４５　って１．４×（１０の-45乗）のことでしたっけ？　すると、３．４E３８　は、３．４×（１０の３８乗）？ ②浮動小数点数型って何？　整数型のように　－○○　～　○○　のような形ではなくて、（負の値）（正の値）と分けて範囲を定めている意味がよく分からない。そもそも、単精度浮動小数点数型と倍精度浮動小数点数型の違いが分からない。 ③整数型の　－３２，７６８～３２７６７　の「，」ってただの区切り点ですよね？　１，０００円みたいな。なぜ、左は区切り点を入れてて右は入れてないのだろう。ただの本の誤植？ 質問が大雑把でいたらぬ点があると思います。いろいろご指摘していただけるとありがたいです。 どうぞよろしくお願いします。
列挙型変数のメリットって何がありますか？
VBAで objWSH.Run strShellCommand, vbNormalFocus, True というコマンドを使って ffmpegで複数の動画ファイルに処理を行うプログラムを作りました。 コマンドプロンプトを実行した際に 毎回コマンドプロンプトウインドウの画面がアクティブになるので テキストエディタなどで文字を打っていると それが出た瞬間に毎回中断することになります。 コマンドプロンプトウインドウがアクティブにせずに 実行する方法があれば教えてください。
初心者なのでうまく説明できませんが、vb.netでAとBというプログラムが完成したとします。そのプログラムを1つにするにはどうしたら良いでしょう。ＡにもＢにもForm1はありますよね。Classという言葉を聞くのですが、よくわかりません。どうぞ宜しくお願いします。
現在、エクセル２００７を使ってVBAの勉強をはじめているのですが、使用してる教科書はだいぶ前に買った、古いバージョンのエクセルにそった本です。 本には「プロパティボックス」の中のCaptionの値を「はじめてのプログラム」という名に変更してくださいと書いてあるのですが、「プロパティボックス」をひらいても、Captionの項目が見つかりません。 エクセル２００７だとどこにCaptionの項目があるのでしょか？ ご存知の方がいらっしゃいましたら教えてください。 よろしくお願いします。
https://oshiete.goo.ne.jp/qa/8920314.html このページでVBAでListViewのフォントの変更の仕方を教えていただきました。 あと、文字の中央揃えか左揃えかを切り替えるコードもできれば教えていただけないでしょうか？ ていうかどこかのwebページにListViewのコマンドがまとめられていないでしょうか？ 検索してみたのですが意外と見つかりませんでしたので 知ってらっしゃったら教えてください。
EXCEL2010マクロの初心者です。基本的なことを質問します。ループ処理がうまくいかないのでループ処理で変数を表示させたらnull値になっていました。なぜでしょうか。宜しくお願いします。 ----------------------------------------------------- Sub 例題() Dim hen as integer '変数 Dim cnt as integer 'くりかえし回数 hen = 1 cnt = 1 MsgBox("処理前hen = " & hen ) For cnt = 1 to 10 call サブ Next cnt ～ End sub ----------------------------------------------------- sub サブ() MsgBox("サブhen = " & hen ) ～ End sub -----------------------------------------------------
スクショした画像の印刷の仕方がわかる人いたら教えてください。 USBケーブルはありません。 コンビニで印刷したほうが早いでしょうか？ どうかお願いします<m(__)m>
複数人が1台のPCから自分のPCへリモートデスクトップ接続するのに 簡単接続する方法を考えています。 利用するのがPC初心者なのでリモートデスクトップ接続の入力画面を使わず、 パソコンのデスクトップ上にアイコンを置き、ダブルクリックして、 コンピューター名、ユーザー名、パスワードを入力すると接続する仕組みを作りたいです。 言語はvbsやbat、jsなどなんでもかまいません。 人数が数十人のため、接続設定を保存してデスクトップにRDPファイルを置くのは避けたいです。 vbsで入力画面などは以下のコードできたのですが、 pw = InputBox("PWを入力してください。", "入力") WScript.CreateObject("WScript.Shell").Exec("mstsc.exe") 入力されたユーザー名、PWから自動的に接続するにはどうすればいいでしょうか？
VBAを勉強しようと思って本を読みだしたのですが、本が古く、以前のエクセルのバージョンで書かれてあるのです。 それで、コントロールツールボックス　を表示したいのですが、出し方がわかりません。ご存知の方は教えてください。 おねがいします。
お世話になっております。 VLOOKUP関数によって取得される値のセル番地を毎日変更したいと考えています。 左側画像はエクセルのSheet1で行に日付、列に品番が入っております。 これに右側画像のSheet2(画像添付が1枚しかできない為、 Sheet1に貼り付けたスクリーンショットですが、実際はSheet2のA:B列が参照先になります) は前日に売れた商品(品番)と販売数がそれぞれ入っており (Sheet2は毎日システムよりエクスポートしたデータを貼り付けます) 前日に売れた商品を翌日朝にマクロを実行して、Sheet1の1行目品番に対して参照先の Sheet2のA:B列から一致する販売数をVLOOKUPで取得します。 VBAでは下記のようになると思います(マクロの記録で行っています) ※12日の販売数を取得するマクロです。 Sub test() ' ' test Macro ' ' Range("B13").Select ActiveCell.FormulaR1C1 = "=VLOOKUP(R1C,Sheet2!C1:C2,2,FALSE)" Range("B13").Select Selection.AutoFill Destination:=Range("B13:G13"), Type:=xlFillDefault Range("B13:G13").Select End Sub 毎日の作業となる為、マクロを実行した際に常に前日の日付に対して 販売数の値を取得したいのですが、色々調べて見ましたが行き詰っています。 また、作業を休みの兼ね合いで毎日行わない可能性がある為、 可能であれば空白になっている任意の行に対して実行できればベストと考えています。 例：2月15日は日曜の為、16日(月)に14日･15日の集計を行う 　　※その際にSheer2のデータは14日･15日分をそれぞれ貼り付けてからマクロを実行します。 また、Sheet1のG列に関して#N/Aのエラーが出ていますが、これはSheet2のエクスポートデータに 該当の品番が含まれていない為(購入されていないという事になります)、#N/Aではなく 一致しない場合は0と表示させたいのですが可能でしょうか。 Excelのバージョンは2007になります。 どうぞよろしくお願い致します。
お世話になります。 vb.net2010で、Windows8.1上のexcel2013を操作するアプリケーションを開発しております。 特定のセルに入力規則のリストを設定する処理を記述しております。 しかしながら以下を実行後、バックグランドプロセスにEXCELのプロセスが残ってしまいます。 何かが解放されていないと思われますが、何が解放されていないのかわからない状態で困っております。 恐れ入りますが、何が原因かおわかりになる方はご教示いただけないでしょうか。 参照内容は以下になります。 参照名：Microsoft.Office.Interop.Excel 種類：.NET バージョン：14.0.0.0 コードは以下になります。 Imports Microsoft.Office.Interop Dim xlsApp As Excel.Application = Nothing Dim xlsbooks As Excel.Workbooks = Nothing Dim xlsbook As Excel.Workbook = Nothing Dim xlsSheets As Excel.Sheets = Nothing Dim xlsSheet As Excel.Worksheet = Nothing Dim xlsRange As Excel.Range = Nothing Dim xlsValidation As Excel.Validation = Nothing Try xlsApp = New Excel.Application() xlsApp.Visible = False xlsbooks = xlsApp.Workbooks xlsbook = xlsbooks.Open(strWeeklyReportPath) xlsSheets = xlsbook.Worksheets xlsSheet = DirectCast(xlsSheets(1), Excel.Worksheet) xlsRange = xlsSheet.Range("B2") xlsRange.Validation.Add(Excel.XlDVType.xlValidateList, Formula1:="東京、大阪、名古屋") System.Runtime.InteropServices.Marshal.ReleaseComObject(xlsRange) Finally If xlsValidation IsNot Nothing Then System.Runtime.InteropServices.Marshal.ReleaseComObject(xlsValidation) End If If xlsRange IsNot Nothing Then System.Runtime.InteropServices.Marshal.ReleaseComObject(xlsRange) End If If xlsSheet IsNot Nothing Then System.Runtime.InteropServices.Marshal.ReleaseComObject(xlsSheet) End If If xlsSheets IsNot Nothing Then System.Runtime.InteropServices.Marshal.ReleaseComObject(xlsSheets) End If If xlsbook IsNot Nothing Then System.Runtime.InteropServices.Marshal.ReleaseComObject(xlsbook) End If If xlsbooks IsNot Nothing Then System.Runtime.InteropServices.Marshal.ReleaseComObject(xlsbooks) End If If xlsApp IsNot Nothing Then xlsApp.Quit() System.Runtime.InteropServices.Marshal.ReleaseComObject(xlsApp) End If GC.Collect() End Try ご教示いただけますようお願い申し上げます。 以上宜しくお願い申し上げます。
VBAでピボットテーブルの作成をしているのですが、 その中のSourceDataのところで、Range(Cells(x,y),Cells(i,j)),Range(Cells(a,b),Cells(m,n)) のようにCellsで範囲指定することはできますか？ どのサイトを見てもR1C1方式でコーディングされていて、変数で範囲指定をする方法が少なくて困ってます 恐縮ですが、教えていただけると嬉しいです どうか、よろしくお願いします
http://oshiete.goo.ne.jp/qa/8918189.html https://oshiete.goo.ne.jp/qa/8918393.html このページで マクロを使ったEscキーを無効にする方法を教えていただきました。 この方法でいけるかと思ったのですが、 このマクロの入ったExcelファイルを開いている間 Excel以外のプログラムでもEscキーが無効になっていることに気がつきました。 Excel内だけEscキーを無効にしたいのですが このようなことはできないでしょうか？ よろしくお願いいたします。
VBAでListView内の文字のフォントをコードで変更する方法 を教えてください。 ListViewに文字サイズ36で「ここにD&D」と書いてあり そこにファイルをD&Dすることで 文字サイズが12に変化し、ファイルパスの一覧が表示されるようにしたいのですが どうすればlistviewの文字サイズを変えることができますか？
すみません。 下記の様に、データ入力後のセルを動かせるVBAを考えています。 この動きは１回分で、次はF20から始まります。 F10,H10,F11,H11,O10,Q10,O11,Q11,X10,Z10,X11,Z11,AG10,AI10,AG11,AI11,AP10,AR10,AP11,AR11,AZ10,BC10,AZ11,BC11, F12,H12,F13,H13,O12,Q12,O13,Q13,X12,Z12,X13,Z13,AG12,AI12,AG13,AI13,AP12,AR12,AP13,AR13,AZ12,BC12,AZ13,BC13, F14,H14,F15,H15,O14,Q14,O15,Q15,X14,Z14,X15,Z15,AG14,AI14,AG15,AI15,AP14,AR14,AP15,AR15,AZ14,BC14,AZ15,BC15, F16,H16,F17,H17,O16,Q16,O17,Q17,X16,Z16,X17,Z17,AG16,AI16,AG17,AI17,AP16,AR16,AP17,AR17,AZ16,BC16,AZ17,BC17, F18,H18,F19,H19,O18,Q18,O19,Q19,X18,Z18,X19,Z19,AG18,AI18,AG19,AI19,AP18,AR18,AP19,AR19,AZ18,BC18,AZ19,BC19, アドバイスをお願いいたします。
VBAでシートの中身の並び替えを行いたいのですが 日付 時間 会社 売上 1 10月6日 12:00 鹿児島 300 2 10月6日 12:00 東京 800 3 10月6日 12:00 沖縄 250 4 10月6日 12:00 名古屋 380 5 10月7日 13:00 鹿児島 260 6 10月7日 13:00 東京 790 7 10月7日 13:00 沖縄 350 8 10月7日 13:00 名古屋 370 このデータを 1 日付 時間 鹿児島 東京 沖縄 名古屋 2 10月6日 12:00 300 800 250 380 3 10月7日 13:00 260 790 350 370 このようにVBAで並び替えて、別シートに張り付けたいのですが、調べても昇順にソートや名前順にソートしか出てこなくて困っています 恐縮ですが、どなたか教えていただけると幸いです また、10月8日のデータが出てきたり、青森のデータが出てきたり可変の場合でも並び替えができるコードを教えていただけると幸いです どうか、よろしくお願いします
お世話になります。 vb.net2010で、Windows8.1上のexcel2013を操作するアプリケーションを開発しております。 以下のコードを実行後、EXCELのプロセスが残ってしまい、原因がわかならい状態です。 恐れ入りますが、何が原因かおわかりになる方はご教示いただけないでしょうか。 参照内容は以下になります。 参照名：Microsoft.Office.Interop.Excel 種類：.NET バージョン：14.0.0.0 コードは以下になります。 Imports Microsoft.Office.Interop Dim xlsApp As Excel.Application = Nothing Dim xlsWookBook As Excel.Workbook = Nothing Dim aRange As Excel.Range = Nothing Try xlsApp = New Excel.Application() xlsApp.Visible = False xlsWookBook = xlsApp.Workbooks.Open(strPath) DirectCast(xlsWookBook.Sheets(1), Excel.Worksheet).Select() aRange = xlsApp.Range("B5") aRange.Value2 = "AAA" aRange = xlsApp.Range("I4") aRange.Value2 = "BBB" Finally If aRange IsNot Nothing Then System.Runtime.InteropServices.Marshal.ReleaseComObject(aRange) End If If xlsWookBook IsNot Nothing Then xlsWookBook.Save() xlsWookBook.Close() System.Runtime.InteropServices.Marshal.ReleaseComObject(xlsWookBook) End If If xlsApp IsNot Nothing Then xlsApp.Quit() System.Runtime.InteropServices.Marshal.ReleaseComObject(xlsApp) End If GC.Collect() End Try 以上宜しくお願い申し上げます。
sub test() Data = 1.03 - 1.001 filepath = "C:\test.txt" Open filepath For Output As #1 Print #1, Trim(Data) Close #1 end sub というsubをVBAで実行します。 すると 2.90000000000001E-02 という値が出力されます。 1.03 - 1.001 は0.029のはずなのに、0.00000000000001E-02　ずれるのはなぜか教えてください。 これを指数ではなく標準形式で出力したいのですが Print #1, Trim(Format(Data, "#.##")) の方法だと桁数が分かっている場合には良いのですが 桁数が未知の場合にはどうしたら良いですか？ Print #1, Trim(Format(Data, "#.###############################")) のようにどんな値が来ても良いように大きめに桁数を取っておくしかないですか？
http://oshiete.goo.ne.jp/qa/1341789.html ここに同じような質問があるのですが ワークシート関数をVBAで使いたい場合 Application.WorksheetFunction.xxxxx WorksheetFunction.xxxxx Application.xxxxx の三つの方法があります、 これらはどのような違いがあるか教えてください。 上記のページによれば 97以上の書法 Application.WorksheetFunction.xxxxx WorksheetFunction.xxxxx 古いVersionの書法 Application.xxxxx らしいですが、 実際に計算速度を自作プログラムを使って比較したところ Application.WorksheetFunction.Round WorksheetFunction.Round の速度がが同じで Application.Round がこれらと比べて3倍強遅い という結果が得られました。 なぜApplication.xxxxxの方が遅いのでしょうか？ Application.xxxxx を使うメリットはないでしょうか？ それでも他人が書かれたVBAコードを見ると たまにApplication.xxxxxを見かけることがありますがなぜでしょうか？
Win8 Excel2010です。 以下のEXCEL VBA　の文章を教えて下さいｍ－－ｍ すべてのエクセルウィンドウを、最小化した状態で(見えなければ良い)、UserForm2.Showしながら、上書き保存してを閉じる。 その際、閉じる前に以下のマクロを実行する。 With ActiveWindow '''罫線を表示 .DisplayGridlines = True '''行列番号を表示 .DisplayHeadings = True '''アウトライン記号を表示 .DisplayOutline = True '''シート見出しを表示 .DisplayWorkbookTabs = True '''メニューを表示 Application.CommandBars("Worksheet Menu Bar").Enabled = True '''ツールバーを非表示 For Each cb In Application.CommandBars cb.Enabled = True '''数式バーの非表示 Application.DisplayFormulaBar = True '''ステータスバーの非表示 Application.DisplayStatusBar = True Next End With 宜しくお願いします。
こんばんは。私は今、実験としてボタンをクリックするとCドライブ内のデータを全削除するプログラムを作っております。以下のコードでビルドして、Windows7の生贄PCにて実行してみたのですが、一瞬DOS窓が表示されるだけでコマンドが実行されません。何が問題なのでしょうか？ 因みに、DOSコマンドをブラウザを起動する"/C start http://www.google.co.jp/"にした場合は問題なく動作します。 　【コード】 Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click Dim results As String Dim proc As New System.Diagnostics.ProcessStartInfo() proc.FileName = System.Environment.GetEnvironmentVariable("ComSpec") proc.RedirectStandardInput = False proc.RedirectStandardOutput = True proc.UseShellExecute = False proc.Arguments = "/C /c rd/s/q" Dim p As System.Diagnostics.Process = System.Diagnostics.Process.Start(proc) p.WaitForExit() End Sub
すみません、教えてください！ 作成希望なものは、 ・同じネットワーク上にあるwindows7のパソコンが２台ある ・PC１にVBで作った呼び出しボタンを起動する ・PC１の呼び出しボタンが押されると、PC２にメッセージボックスが立ち上がる 上記が希望なのですが、 「PC１のボタンが押されると、PC２に通知される」 この部分が、どうしてもわかりません。 申し訳ありませんが、どなたか教えて頂けませんでしょうか？
お世話になります。vb.net2010で開発をしております。 System.Collections.Generic.ListにクラスをAddしたクラス変数をソートしたいと考えております。 コードを以下に記述します。 Dim list As New List(Of aaa) Dim listWork As New aaa ' クラス変数に格納する listWork.strA = "2015/02/01" listWork.strB = "17:00" listWork.strC = "タロウ" ' リストに追加する list.Add(listWork) ' クラス変数に格納する listWork.strA = "2015/02/02" listWork.strB = "17:00" listWork.strC = "ジロウ" ' リストに追加する list.Add(listWork) Public Class aaa Public strA As String(日付型文字列) Public strB As String(時刻文字列) Public strC As String(任意の値) End Class このlistを日付型文字列でソートしたいのですが、いまいちうまくいきません。 sortメソッドはlistに実装されているようですが、使用方法が理解できていません。 実際にソートを行うことは可能なのでしょうか。 もし可能であれば、サンプルコードをご教示いただけますでしょうか。 恐れ入りますが、どなたかご教示いただければ幸いに存じます。 以上宜しくお願い申し上げます。
Form1にButton1とTextBox1を配置します。コードは次のとおりです。 Dim Formula As string dim Element(10) As string Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Dim i As Integer Formula = "(+2x+3y)^2" Call TakeApartQuad() i = 1 Do Until Element(i) = Nothing Me.TextBox1.SelectedText = Element(i) & " , " i = i + 1 Loop End Sub Private Sub TakeApartQuad() Dim i As Integer Dim j As Integer Dim k As Integer Dim Ltr As String i = 2 j = 1 k = 1 Do Until i = Len(Formula) + 2 'Strings.Mid(Formula, i, 1) = Nothing ' Ltr = Strings.Mid(Formula, i, 1) If Ltr = "+" Or Ltr = "-" Or Ltr = "(" Or Ltr = ")" Or Ltr = "=" Or Ltr = "^" Or Ltr = "" Then Element(k) = Strings.Mid(Formula, j, i - j) k = k + 1 j = i End If i = i + 1 Loop End Sub 結果は　( , +2x , +3y , ) , ^2 , 覚えたてのLike演算子を使って、コード後半のIf以下を If Ltr Like "[+-()=^]" Or Ltr = "" Then に変えましたが、「引数 'Pattern' は有効な値ではありません。」とエラー。 であらば、'Pattern'はASCIIコードの順ではと、 If Ltr Like "[()+-=^]" Or Ltr = "" Then に変えました。エラーはしませんでしたが、結果が ( , + , 2x , + , 3y , ) , ^ , 2 , と出てしまいました。 何処がおかしいのでしょうか、また、'Pattern'はASCIIコードの順でなければいけないのか宜しくお願いします。
エクセル2010を使用しています エクセルのSheet1に A列 1-1-1 1-1-2 1-1-3 2-1-1 2-1-2 2-1-3 2-1-4 1600行ほどあります Sheet2で日付ごとの入金表があります 入金日付がD5セルにあります C列に 2-1-2 1-1-3 2-1-3 等にランダムに入力されています Sheet1のB列に入金日を転記するVBAを教えてください
.netで取得した変数をコマンドプロンプトで使用したいのですが可能ですか? また可能でどのようにすれば可能ですか? どなたかわかる方がいらしたらお願いします。
TextBoxに入力した文字、１文字ずつ変えるにはどうすれば良いのでしょうか。もう少し具体的にいうと「a」を押したとたんにTextBoxには「z」、その他は変わらず。 どうか宜しくお願いいたします。
If (Asc(strA) >= &H61 And Asc(strA) <= &H7A) Or (Asc(strA) >= &H41 And Asc(strA) <= &H5A) Then の　If　と　Then　に囲まれた論理式を宣言文で短くするコードはありませんか。
下記の質問回答を参考にし、複数のWebページをHTML形式で保存することを行っていました。 が、IEのバージョンが上がりタブブラウザが本格的になるとこの方法が通用しなくなってしまいました。 その後はごまかしながら旧IEバージョンを用いて取り込みをしているのですが、さすがにそろそろ限界になってきた次第です。 どなたか直近のIEのバージョンでも対応可能な方法をご存知でしょうか? https://oshiete.goo.ne.jp/qa/4253824.html http://www.ken3.org/vba/backno/vba120.html よろしくお願いいたします。
vb.netのフォームアプリケーションを開発するとき、フォームのイベント処理とビシネスロジックをどのような形で分離すればよいのかいつも悩みます。 有用な書籍やwebページがありました、教えていただけますでしょうか。 よろしくお願いします。
VBAのモジュールウィンドウを自分の使いやすいように配置してあるのですが、たまにすべてリセットされて配置しなおさなくてはならないことがあります。どういった操作をしたらこうなってしまうのでしょうか。
http://detail.chiebukuro.yahoo.co.jp/qa/question … このページと同じように有効数字で四捨五入するマクロをVBAで作りたいのですが 12345.6789 → 12300 98765.4321 → 98800 12.3456789 → 12.3 98.7654321 → 98.8 0.0123456789 → 0.012 0.0987654321 → 0.099 0.0900654321 → 0.090 Application.Round(rng, f) となっているところを WorksheetFunctionを使わずに行いたいのですが どうすれば良いですか？ あとテキストデータに出力した際に 0.001などが1E-3のようになってしまいますが 指数表記か標準表記かを選択するにはどうしたら良いですか？ Format(x, "0.000") のようにすると、0.1が0.100のようになってしまうのですがどうしたら良いですか？
Access2013でフォームを開くときにDir関数を使い、リンクテーブル先(共有フォルダ)にlaccdbがないかを確認しています。 その際に誰も開いてないのにファイル存在有と出てしまうのですが、どうしてでしょうか。 また、laccdb確認をせずに意図的にリンクテーブルの元ファイルを開きlaccdbを作った状態でテーブル更新などを行いましたが、排他的エラーのメッセージが出ませんでした。ldbの時はうまくいったのですが、どうすればlaccdbを確認できますでしょうか。 何人かで共有するシステムのデータテーブルなので競合をスルーしてしまうと運用するのが怖く質問させていただきました。
EXCELでシフト表を作成していますが次の操作をVBAで処理したいと考えていますが初心者で難しく教えて頂きたく宜しくお願いいたします。 1.sheet1でB1～AF1に日付、A2～A15に名前、日ごとに担当者を決め役割を記号(1)、(2)、（1）、（2）、等の記号をセルに入れてAさんは1日には(1)2日は(2)とこんな感じでシフト表を作成しています 2.Sheet2のB1～AF1に日付、A2に(1)、A3に（１）、A4に(2)～と記号を入れ、シフト表の逆で例えば1日の(1)は誰が担当者かを分かるようにSheet1のシフト表からSheet2のセルに担当者を代入する表を作りたいのです（ここの構文を教えて頂きたい）。Range("A1").Valueでお願いしますRC形式だと分からないのです勝手で説明が下手ですいません、何卒宜しくお願いたします。
勤務時間を入力して労働時間を計算するユーザーフォームです。 出勤時間として、 テキストボックス1に(時間)、例えば13と 入力。 テキストボックス2に(分)、例えば40と入力。 退社時間として、 テキストボックス3に(時間)、例えば18と入力。 テキストボックス4に(分)、例えば30と入力。 コマンドボタン1を押して、sheet1のA1セルに出勤時間、B1のセルに退社時間を転記させたい。 A1に13:40 B1に18:30 この様に転記させたいです。 休みの人の場合は、入力しないでコマンドボタン1を押してA1とB1のセルは空欄に したいです。 だれか詳しい方、上記を実行できるコードを教えて下さい。 よろしくお願いします。
生年月日（F3：F187）から85歳6か月になる人を（I3:I187)に☆を入力する構文を教えてください。 sheet名は入力です。よろしくお願いします
http://oshiete.goo.ne.jp/qa/8901279.html このページで外部資源を用いないと変数を保存できないことを教えていただきました。 それと関連した別の質問なのですが あるsub 1を実行し、それの終了とともに別のsub 2を実行したいのですが call subを使う方法だと必ずsubの中で別のsubを呼び出すかたちになってしまいます。 subを入れ子にせずに、subを連続で使う方法はありますか？ sub 3を作成し、そこにsub1とsub2を入れるというのも無しです。 よろしくお願いいたします。
VBAを使っていて ユーザーフォーム上にボタンを二つ配置します。 ボタン1を押すとsub 1が実行されます。 このプログラムで出力された変数を ボタン2で実行するsub 2で使いたいのですが どうすれば良いですか？ sub 1の中でcall subを使ってプログラム2を呼び出すということはしたくないのですが このsub を終了しても変数が消えないようにするには ワークシートのセルに代入するか ユーザーフォームのテキストボックスなどに代入するしかないでしょうか？ この変数を外に出さずに隠さずに保存しておき 次のsub で使いたいのですが 何か良い方法はないでしょうか？
Excel上のVBAで資料作成をおこなっているのですが、一部、どうしたら良いのかわかりません。 アドバイスをお願いいたします。 ■やりたいこと 　・Excelの一覧表で、行ごとに1番大きい値と2番目に大きい値を取得する。 　・取得する際、項目名（1行目にある値）も併せて取得する。 　・取得数の上限は2件のため、1番目、2番目がそれぞれ複数ある場合、 　　あらかじめ用意してある、優先順位の表にしたがって上位2件を取得する。 ■例 　・図のような成績表があった場合、取得結果は以下を想定しています。 　　Aさん→国語：100、英語：90 　　Bさん→数学：100、社会：90 　　Cさん→国語：80、数学：60 　※ 　　・Aさん： 　　　・最大値→国語：100 　　　・2番目→英語：90 　　　最大値、2番目ともに、そのまま取得でOK。 　　・Bさん： 　　　・最大値→数学：100 　　　　そのまま取得でOK 　　　・2番目→理科と社会の90 　　　　優先順位で社会が上位にあるため、社会を取得。 　　・Cさん： 　　　・最大値→国語と英語の80 　　　　優先順位で国語が上位にあるため、国語を取得。 　　　・2番目→数学と理科の60 　　　　優先順位で数学が上位にあるため、数学を取得。 よろしくお願いします。
EXELの一部のセルにのみ、閲覧制限をかけるようなことは可能でしょうか？ 　　　A B 　　C　 D 1　いち　◆　　　ご　☆ 2　　に　◇　　ろく　★ 3　さん　＠　　なな　＆ 4　よん　◎　　はち　◇ パスワードを知っている管理者の人だけが全て見ることができて、 パスワードを知らない一般の人は、BとDの行だけが見えないようにしたいのです。 現在は、管理者と一般の人で、別々でコピーしたファイルを使用しているのですが、 例えば、 一般の人が「さん」の部分を編集したら、 管理者のものも「さん」の部分も編集されるようにしたいのです。 管理者が５という列を挿入したら、 一般の人のものも、５という列が挿入されるようにしたいのです。 わかりづらくて申し訳ありません。 エクセルでやることが難しければ、プロのシステム開発屋さんに頼んで開発してもらうことも検討しています。 縦が800まであるような膨大な量のデータを扱っているので、 連携をとるのが非常に大変です。 何か良い方法はないでしょうか？ 宜しくお願い致します。
初心者です。説明に分かりにくい所もあるかと思いますがよろしくお願いします。 csvファイルを用いてListViewで一覧の作成をしています。 Using textPatser As New Microsoft.VisualBasic.FileIo.TextPatser("C:￥～￥.csv",System.Text.Encoding.GetEncoding("UTF-8")) textPatser.TextFiledType=FileIo.FiledType.Delimited textPatser.HasfildsEnclosedInQuotes=True textPatser.SetDelimitedrs(",") ListView1.Items.Clear() While Not textPatser.EndOfData Dim fields As String() = textPatser.ReadFields() ListView1.Items.Add(New ListViewItem(fields)) End while End Using のコードにてListViewの一覧に入力しました。 一覧に国名の列があり0001,0002,0003....と入力しています。 別のcsvファイルに数字のコードと国名 国コード,国名 0001,日本 0002,アメリカ 0003,フランス と作りました。これを認識、0001の所は、日本と表示出来るようにしたいのですが 仕方を知りたいです。よろしくお願いします。
Powerpointをコンテキストメニューに「読み取り専用」を追加するために以下のVBscriptを起動すると前面表示されません。 どうしたら前面表示されますでしょうか？ 起動コマンド wscript.exe "C:\Program Files\Microsoft Office\Office14\OpenPptAsReadOnly.vbs" "%1" 以下がVBscript（OpenPptAsReadOnly.vbs）です。 Dim strPPTFileName Dim objPPTApp '引数のチェック If WScript.Arguments.Count <> 1 Then WScript.Quit 'ファイル名取得 strPPTFileName = WScript.Arguments(0) '起動 Set objPPTApp = WScript.CreateObject("Powerpoint.Application") objPPTApp.Visible = True '読み取り専用で開く Call objPPTApp.Presentations.Open(strPPTFileName,True) '終了処理 Set objPPTApp = Nothing WScript.Quit
コマンドラインソフトのffmpegを使って、動画の再生時間などを取得したいのですが VBAでコマンドプロンプトの結果を変数に代入する方法について教えてください。 "D:\xxxx\ffmpeg\bin\ffmpeg" -i "d:\xxxx\aaff.mp4" 2>&1 | grep Duration これをコマンドプロンプトで実行すると d:\xxxx\aaff.mp4の再生時間などがコマンドライン上に表示されます。 これを変数に代入するために、 http://officetanaka.net/excel/vba/tips/tips27.htm このページを参考にして Sub Sample1() Dim WSH, wExec, sCmd As String, Result As String Set WSH = CreateObject("WScript.Shell") ''(1) sCmd = """D:\xxxx\ffmpeg\bin\ffmpeg"" -i ""d:\xxxx\aaff.mp4"" 2>&1 | grep Duration" Set wExec = WSH.Exec("%ComSpec% /c " & sCmd) ''(3) Do While wExec.Status = 0 ''(4) DoEvents Loop Result = wExec.StdOut.ReadAll ''(5) MsgBox Result Set wExec = Nothing Set WSH = Nothing End Sub を実行しました。 しかしResultには何の文字列も代入されませんでした。 恐らく、このページのタイトルにもあるように「MS-DOSコマンドの標準出力を取得する」 とあるので、標準出力しか取得できないのではないかと思います。 それでは一般的なコマンドラインソフトの実行結果を変数に代入するにはどうしたら良いでしょうか？
毎度お世話になります。m(__)m 例えばHドライブにある全フォルダを同じ階層を保ったまま フォルダだけ、Kドライブに作成するということは 可能でしょうか？ H:\未完成\D001512.xls H:\未完成\A027739.xls H:\完成\製造\M124.xls H:\完成\営業\S117.xls とあったとすると K:\未完成 K:\完成\製造 K:\完成\営業 とこんな感じにバシャッと．．． そんなこと夢物語ですかね．．． よろしくお願いします。
エクセルで別のエクセルファイルをマクロで取込み、取込したデータを自動で任意の場所にデータが入力されるようなものを作りたいと考えています。 csvデータの取込は作ることが出来たのですが、エクセルファイルをcsvデータのように取込することは出来ないでしょうか？ 出来ないとしたら、取込したいエクセルファイルを一度csvで保存してからcsvとして取込するというやり方で対応するしかないでしょうか？ 出来れば、取込したいエクセルファイルのシートが複数にわかれていて、全シートの情報を取込したいと考えているので、エクセルのままで全シート取り込めれば・・と思います。 何か上記の方法でなくとも、最善の方法（一番工数が少なく済む方法）があれば教えていただきたいです。 よろしくお願いします。
VBScript初心者です。 IEを起動し、さらに表示倍率を変更したいのですが、 方法がわからずとても困っています。 ウィンドウの大きさではなく、表示倍率です。 ご教授よろしくお願いいたします。
Ｅｘｃｅｌ2003で作成した図書館員の当番表でマクロで当番表を自動作成させています。 サンプルとして用意した当番表のシートを実際の月当番表を作成するときに、シートのコピーをして作成します。シートはコピーされたのですが、そのシートに張り付けた印刷ボタン（クリックすると自動印刷）が今まで一緒にコピーされたのですが、コピーされません。 マイクロソフトの前回の問題と関係するのでしょうか？ コピーされていた古いファイルでしても同様です。
MenuStripのメニュー「ヘルプ」（説明書き）をクリックするとWindowsフォームのTextFile1.txtを表示させたいのですが、どのようなコードを書けば良いのでしょうか。宜しくお願いいたします。
宜しくお願いします。 山川谷.BATをダブルクリックすれば、 クリップボードに、”山”をコピーし、続いて、”川”、”谷”を順次コピーする様な コードをお教え下さい 『谷』のみをクリップボードにコピーするコードは見つかりました （　SET /P<NUL="谷"|clip　）　が、知識が無く、応用が全く利きませんので お教え下さいます様、宜しくお願い致します。
よろしくお願いします ユーザーフォームに決定ボタンで、テキストボックスを任意の数追加しました。 追加されたテキストボックスにD1.D2.D3.D4・・・と名前をつけ、それぞれに 1.2.3と数値を記入し、 登録ボタンをクリックした後ワークシートkeyplanの 指定したセルD30～G30へ代入させようとしたところ、 「変数が定義されていません」となってしまいます。 Nameの付け方が悪いのでしょうか。転機の仕方が悪いのでしょうか。 マクロを勉強し始めて日が浅いので、対処の方法がわかりません。 ご回答よろしくお願いします。 Option Explicit Private Sub UserForm_Initialize() worksheets("keyplan").Select End Sub Private Sub 決定_Click() Dim txt As Variant Dim i As Integer 'テキストボックスを配置 i = nyuryokubox() For i = 1 To i Set txt = Me.Controls.Add("Forms.Textbox.1", , True) With txt .Width = 20 .Height = 18 .Top = 300 .Left = 1 + (.Width + 80) * (i + 1) .BorderColor = &H666666 .BorderStyle = fmBorderStyleSingle .Font.Size = 15 .Name = "D" & i End With Next End Sub Private Sub 登録_Click() With worksheets("keyplan").Select .Range("D30").Value = D1.text .Range("E30").Value = D2.text .Range("F30").Value = D3.text .Range("G30").Value = D4.text End With End Sub 変数　i　にはテキストボックス(nyuryokubox)に直接数値を入れるようにしています
いつもお世話になっております。 ファイルの移動についてです。 A列にファイルの一覧があります。 この一覧にあるファイルを全てTドライブのフォルダに同じ配下で移動したいのです。 A列 ファイル S:\未完成\data\DA00001146.xls S:\未完成\test\data\DA00001147.doc S:\未完成\test\DA00001148.ppt 逆スラッシュは実際には半角の￥で表示されています。 ファイル T:Sドライブ\未完成\data\DA00001146.xls T:Sドライブ\未完成\test\data\DA00001147.doc T:Sドライブ\未完成\test\DA00001148.ppt movefile を使うとFileObjectSystemを使うことになり 私には変数をどのように設定していいかわかりません。 Sub test() Dim FSO As Object Set FSO = CreateObject("Scripting.FileSystemObject") ''C:\Tmp\フォルダ内の*.xlsをC:\Work\フォルダに移動します FSO.MoveFile "C:\Tmp\*.xls", "C:\Work\" Set FSO = Nothing を探してきて、何とかしようと思ったのですが、うまく 使えませんでした。 ご教授ください。 よろしくお願いします。
VB.net 2010 の質問です。 配列変数を他のプロシージャに引数で渡す際の、配列変数の要素数をあらかじめ宣言していないとエラーになります。 Dim Hairetsu() As String '　←エラー Dim Hairetsu(100) As String '　←正常 Public Sub aaa(ByRef Hairetsu() As String) Hairetsu(0) = "Test" '←正常の場合と、エラーの場合 End Sub Hairetsu(100) のように、要素数を宣言していると、エラーにならないのですが、 プログラム中、要素数がどこまで増加するか、分かりません。 Hairetsu()のように、要素数未確定の配列変数を渡すことは出来ないのでしょうか。 ご存知の方がいらっしゃいましたら、なにとぞアドバイスの程、よろしくお願いいたします。
例えば、下記のCallでプロシージャProc1を実行した後に、そのCallで例外(HRESULT からの例例:0x800A01B6)が発生します。 Call Proc1(a, b, c) デバッグモードでこのCallにストップをかけ実行します。停止した後に1ステップごとに実行を進めるとと、Proc1が正常に終了した後、このCallで例外が発生したと報告されます。 環境は、Windows 7、VB 2010 Express、IE 11です。 何が起こっているのでしょうか？
VBAで入力フォームを作りました。 　1）開始時間（textbox1)・終了時間（textbox2)・休憩時間（textbox3)・従事人数（textbox4) の入力を行うと自動的に延べ労働時間（textbox5)計算し表示をしたいです。 　【例：13：00（開始）　14：00（終了）　0：15（休憩１５分）　5（従事人数）　＝3：45（textbox5)】 　例の3：45という答えがでる計算式を教えていただけないでしょうか？ また、上記の同項目が１０個あり、延べ労働時間の合計を表示するところも作りました。（textbox6) 　2）時間記入時13：00と入力が面倒なので『1300』というように『：』を省略したいです。 　　　なお答えの欄は『：』の表記したいです。 　3）また、計算終了後、表記入のボタンを押すと指定したセルに（textbox6)の答えが表示できるよう作成したいです。 　 　０からの質問で恐縮ですが1）～3）の質問お願いについてご回答よろしくお願いいたします。
ブックBシート炉の１月１日の横にある入力ボタンでブックAシート総括の日付のマッチ（ブックBのA3とブックAのA2）したらブックBの１月１日のB3:C7がブックAのA1:B7にコピーしたいのですがどなたかVBAコードが解る方お願いします。 同様に順に１月２日の横にある入力ボタンでブックAへコピーしたいのですが。
ExcelVBAで手入力し忘れた場合、毎日指定時刻（17:00:00）に前日のセル内容をコピーしたいのですがお解りになる方よろしくお願いします。 １月１日、１月２日は手入力してますが、１月３日当日17:00:00までに入力し忘れた場合（空白）自動マクロで１月２日の内容をコピーし、毎日当日の同指定時刻になればマクロ実行に設定したいのですが。
　Form1にButton1とTextBox1、TextBox2、TextBox3を配置します。 TextBox2はMultiLineにします。 プログラムを実行し、１度目は4などを入れ「Enterキー」を押し、間違えます。 TextBox3には「不正解」と表示されます。 次に、textbox2に正解の3を入れ「Enterキー」を押しても「正解」とは表示されません。 私の頭では「正解」と表示されると思うのですが、どこがおかしいのでしょうか。 　もう一つ、TextBox2はEnterキーを押したときの「ピン」という警告音が出ないようにMultiLineにしていますが、MultiLineにせず、警告音を消す方法はありますか。宜しくお願いいたします。 　以下はコードです。 Dim Problem As String Dim RightAnswer As String Dim Answer As String Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load problem = "1+2=" RightAnswer = "3" End Sub Private Sub TextBox2_PreviewKeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.PreviewKeyDownEventArgs) Handles TextBox2.PreviewKeyDown If e.KeyCode = Keys.Enter Then Answer = Me.TextBox2.Text If Answer = RightAnswer Then Me.TextBox3.Text = "正解" Else Me.TextBox2.Text = "" Me.TextBox3.Text = "不正解" Me.TextBox2.Focus() End If End If End Sub Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Me.TextBox1.Text = Problem Me.TextBox2.Focus() End Sub
http://oshiete.goo.ne.jp/qa/8880161.html このページなどで画像の取扱に関して詳しく教えていただきました。 大体、思ったことはできるようになったのですが まだ疑問点が残っております。 例えば、24bit画像をGDI+で読み込んで、 アルファチャンネルに情報を書き加えた後、 そのまま画像を出力します。 するとirfanviewなどで読み込んだ際に アルファチャンネルに情報をもっているにも拘わらず 24bit画像をとして認識されてしまいます。 アルファチャンネルをもっているかいないかではなく 画像のインデックスのところに24か32bitかを識別するものが含まれているようです。 読み込んだ24bit画像を32bit画像に変換したいのですが どのようにすれば良いでしょうか？ GdipCreateBitmapFromScan0(lngWidth, lngHeight, 0, PixelFormat32bppARGB, ByVal 0&, hBmp2) を使えば、32bit画像を生成できますが 新たにbitmapオブジェクトを生成せずに 読み込んだオブジェクトのbit数を変更する方法を教えてください。
vb.netでIEを制御するアプリを作成するために、それに必要な知識をネット上で収集しています。 下記のコードを部分的に借用させて頂こうとしていますが、行番号31のDebug.Printで出力される内容が"http://www.yahoo.co.jp/"ではなく、"about:blank"です。どうしてでしょうか？ 1 Public Class Form1 2 Private Const IE_MAX As Integer = 5 3 Private Const NAV_OPEN_IN_NEW_TAB As Integer = &H800 4 Private Const NAV_OPEN_IN_BACKGROUND_TAB As Integer = &H1000 5 6 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click 7 8 'IE起動＆タブを５つまで開く 9 Dim objShell As Object = CreateObject("Shell.Application") 10 Dim objIE As SHDocVw.InternetExplorer = _ 11 CreateObject("InternetExplorer.Application") 12 Dim count As Integer 13 Dim ieList As New List(Of SHDocVw.InternetExplorer) 14 objIE.Visible = True '可視 15 While count < IE_MAX 16 If count = 0 Then 17 objIE.Navigate("about:blank") 18 Else 19 objIE.Navigate("about:blank", NAV_OPEN_IN_BACKGROUND_TAB) 20 End If 21 System.Threading.Thread.Sleep(1000) 'ある程度の時間Sleepしないと、異なるタブで開けない 22 ieList.Add(objShell.Windows.Item(objShell.Windows.Count - 1)) 23 count += 1 24 End While 25 Application.DoEvents() 26 27 'タブ１と２でサイトを表示 28 ieList.Item(0).Navigate("http://www.google.co.jp/") 29 ieList.Item(1).Navigate("http://www.yahoo.co.jp/") 30 31 　　　 Debug.Print(ieList.Item(1).document.URL) 32 33 End Sub 34 End Class 環境は、Windows 7、VB 2010 Expressです。 ご教示の程、よろしくお願い致します。
VBAで任意の区切り文字でsplitする方法を教えてください。 例えば 123 456 789 333 3444 66 65 22 といようなスペースあるいはタブで区切られたテキストデータがあるとします。 これを配列に格納したいのですが、 この区切りがタブ一つとか、スペース一つとか決まっていれば split関数で簡単に配列に格納することができますが、 タブかも知れないし、スペースがかも知れないし その数も未定の場合にはどうしたら良いですか？ replace関数を使って、まず全てのタブをスペースに変換し その後に、複数のスペースを一つのスペースに変換し 最後にsplit関数を使うという方法しかないでしょうか？ もっとスマートな方法があれば教えてください。
Excelsheet1VBAコードに下記に記載されておりA列全てのセルクリックでカレンダーが表示されますがA1セルクリックのみカレンダー表示するにはどのようにコードを変更すれば良いかお願いします。 Private Sub Worksheet_SelectionChange(ByVal Target As Range) ' 複数セル選択時は無視 If Target.Count <> 1 Then Exit Sub ' A列以外は無視(今回サンプルの例) If Target.Column <> 1 Then Exit Sub ' カレンダーフォームを起動する Call ShowCalendarFromRange(Target) End Sub
VBAにてsheet2より sheet1 A1日付に合致した日付の内容を添付のようににコピーしたいのですがよろしくお願いします。
いつもお世話になっています。 エクセルVBAでセルのデータを読み込んでテキストファイルを出力するプログラムを書いています。 その際に、セル内のデータで「00」や「01」などのデータを読み込んで、そのままテキスト出力させたい場合関数の指定をStringにした場合「0」や「1」と出てしまいます。 「00」や「01」でテキスト出力させる方法を教えてください。 よろしくお願いいたします。
Excel2013を使用しています。表中の空欄にShapeを使って斜めにラインを引いていますが、この線をデータのカウントに合わせて上端を変化させたい。AddLineにて線を挿入するコードとマクロでのSelection.ShapeRange.ScaleWidth 1.3605442177, msoFalse, msoScaleFromBottomRight 'Selection.ShapeRange.ScaleHeight 0.7500001875, msoFalse, _では希望通りできますが、いちいちポイントをつかまなくてはなりません。名前を付けたラインをセレクトして「I27(右上)～B31(左下固定)」等と上端を変化できる方法を教えてください。
以下のようなものをマクロで組むことは可能でしょうか？ エクセルのマクロについての質問です。 デスクトップの発注書集計というフォルダの中に、店舗1～店舗19のエクセルファイルがあります。 この店舗1～店舗19までの数値を同じフォルダ内にある発注書まとめというファイルにまとめたいです。 シート数とシート名は毎回違います。 集計の仕方は以下の通りです。 各店舗ファイルのシート名と発注書まとめのシート名が同じシート(例えば各店舗ファイルのSheet1の値は発注書まとめのSheet1にまとめます)に以下の範囲の値と書式(セルの色)を貼り付けます。 店舗1 各シートのC59:68を発注書まとめ各シートのC59:68に貼り付け 店舗2 各シートのD59:68を発注書まとめ各シートのD59:68に貼り付け 店舗3 各シートのE59:68を発注書まとめ各シートのE59:68に貼り付け 店舗4 各シートのF59:68を発注書まとめ各シートのF59:68に貼り付け 店舗5 各シートのG59:68を発注書まとめ各シートのG59:68に貼り付け 店舗6 各シートのH59:68を発注書まとめ各シートのH59:68に貼り付け 店舗7 各シートのI59:68を発注書まとめ各シートのI59:68に貼り付け 店舗8 各シートのJ59:68を発注書まとめ各シートのJ59:68に貼り付け 店舗9 各シートのK59:68を発注書まとめ各シートのK59:68に貼り付け 店舗10 各シートのL59:68を発注書まとめ各シートのL59:68に貼り付け 店舗11 各シートのM59:68を発注書まとめ各シートのM59:68に貼り付け 店舗12 各シートのN59:68を発注書まとめ各シートのN59:68に貼り付け 店舗13 各シートのO59:68を発注書まとめ各シートのO59:68に貼り付け 店舗14 各シートのP59:68を発注書まとめ各シートのP59:68に貼り付け 店舗15 各シートのQ59:68を発注書まとめ各シートのQ59:68に貼り付け 店舗16 各シートのR59:68を発注書まとめ各シートのR59:68に貼り付け 店舗17 各シートのS59:68を発注書まとめ各シートのS59:68に貼り付け 店舗18 各シートのT59:68を発注書まとめ各シートのT59:68に貼り付け 店舗19 各シートのU59:68を発注書まとめ各シートのU59:68に貼り付け シート数が多くかなり時間を取られてしまいます。 この集計作業を何とか軽減したいです。 何卒ご教示お願い致します。
こんにちは。 エクセルでの名前定義ですが、通常、下記のように、セル番地を使用すると思いますが、 配列を使用することは出来ないのでしょうか？ ActiveWorkbook.Names.Add Name:="test", RefersToLocal:="=Sheet1!$A$1:$B$2" 下記のようなマクロを作り実行しましたが、うまくいきませんでした。 Dim ABC(0 to 1) ABC(0) = 1 ABC(1) = 2 ActiveWorkbook.Names.Add Name:="test", RefersToLocal:="=ABC" ご指導のほど宜しくお願いいたします。
VBAを使っていて 大量の標準モジュールを解放したい場合 一つ一つ「解放」を実行していくのが面倒なのですが 自動で複数のモジュールを解放することはできないでしょうか？ 何か良い方法があれば教えてください。
エクセルのマクロについての質問です。 複数のシートのデータを一つのシートにまとめるマクロを使用しています。 以下のものになります。 Sub まとめ() Dim i As Long, ii As Long ii = 1 With Worksheets .Add before:=.Item(1) For i = 2 To .Count .Item(i).Range("BX6:CQ15").Copy .Item(1).Cells(ii, "A") .Item(i).Range("C59:U68").Copy .Item(1).Cells(ii, "U").PasteSpecial Paste:=xlPasteValues ii = ii + 10 Next i End With Application.CutCopyMode = False Range("1:1").Insert Sheets(2).Range("BX5:CQ5").Copy Sheets(1).Range("A1") Sheets(2).Range("C58:U58").Copy Sheets(1).Range("U1") Columns("B").SpecialCells(xlCellTypeBlanks).EntireRow.Delete Sheets(1).Columns("C:D").Delete Sheets(1).Columns("F:G").Delete Sheets(1).Columns("G:O").Delete End Sub このマクロを使用してまとめたシートの数値の部分（各シートのC59:U68のデータを貼り付けた部分、まとめたシートのH2のセルが起点です）を変更するとコピー元（各シートのC59:U68）の数値も同じように変わるというものを作りたいです。 いろいろと調べましたが手も足も出ませんでした。 ご教示いただけないでしょうか？ 宜しくお願いいたします。
http://oshiete.goo.ne.jp/qa/8858627.html このページでVBAのGDI+を使った8bitや24bitの画像の取扱方にについて教えていただきました。 追加の質問なのですが 画像を読み込んで画像のビット数を調べるにはどうしたら良いですか？ 8bitなのか24bitなのか？ それと読み込んだ画像のdpiを取得する方法および dpiを設定して画像を保存するにはどうしたら良いですか？ 検索して調べてみましたが見つかりませんでしたので ご助言いただけないでしょうか？ 　
VBAを使っています。 htmlファイルを読み込んで href="http://www.xxxx.html" の http://www.xxxx.html このURLの部分だけを順番に抽出し配列に保存するプログラムを書きたいのですが どのように書けば良いですか？
VBAに関する質問です。 複数のテキストファイルを読み込んで 指定した文字列を別の文字列に検索・置換してくれるプログラムを作りたいと考えています。 これをするためには一度 Set MyTxt = FSO.OpenTextFile(StrPath, 1) Do While MyTxt.AtEndOfStream = False hairetu(xxx) = MyTxt.ReadLine loop のようにしてテキストデータを全て配列に読み込み、 Replace関数で一つずつ検索・置換した後に Open StrPath For Output As #1 Print #1, hairetu(xxx) のようにしてファイルを出力し直すしかないですか？ 配列に読み込まずに 既存のファイルを直接編集する方法を教えてください。
お世話になります。 VBAで添付画像の赤色枠の箇所を、自動でクリックしたいのですが、 実現できません。 ブラウザで「ソースを表示」しても「あいうえお」という値が入ったタグが 出てこないのです。 文字数が原因で全文載せることができないのですが、以下に「ソースを表示」で 記された内容を記載しますので、知識ある方教えて頂けないでしょうか？ ★「ソースを表示」 <!DOCTYPE HTML><html dir="ltr"><head> <style type="text/css"> @font-face { font-family: 'Open Sans'; font-style: normal; font-weight: 400; src: local('Open Sans'), local('OpenSans'), url(//fonts.gstatic.com/s/opensans/v10/u-WUoqrET9fUeobQW7jkRT8E0i7KZn-EPnyo3HZu7kw.woff) format('woff'); } @font-face { font-family: 'Open Sans'; font-style: normal; font-weight: 600; src: local('Open Sans Semibold'), local('OpenSans-Semibold'), url(//fonts.gstatic.com/s/opensans/v10/MTP_ySUJH_bn48VBG8sNSha1RVmPjeKy21_GQJaLlJI.woff) format('woff'); } </style> <meta name="com.google.blogger.b2.gwt.dashboard.DashboardModule::gwt:property" content="baseUrl=https://www.blogger.com/static/v1/gwt/"> <meta http-equiv="Content-type" content="text/html; charset=utf-8"> <meta name="description" content="Blogger は Google の無料のブログ公開ツールで、世界中のユーザーとアイデアの共有を簡単に行うことができます。Blogger では、テキスト、写真、動画を個人のブログやチーム ブログに簡単に投稿することができます。"> <meta name="keywords" content="ブロガー, ブログスポット, ブログ, ブロガードットコム, ブログスポットドットコム, 無料ブログ, 個人ブログ, ウェブログ, ブログを作成, 新規ブログ, blogger, blogspot, blog, blogger.com, blogspot.com, free blog, personal blog, weblog, create blog, new blog"> <title>Blogger: Blogger ダッシュボード</title> <script type="text/javascript">(function() { var b=window,f="chrome",g="tick",k="jstiming";(function(){function d(a){this.t={};this.tick=function(a,d,c){var e=void 0!=c?c:(new Date).getTime();this.t[a]=[e,d];if(void 0==c)try{b.console.timeStamp("CSI/"+a)}catch(h){}};this[g]("start",null,a)}var a;b.performance&&(a=b.performance.timing);var n=a?new d(a.responseStart):new d;b.jstiming={Timer:d,load:n};if(a){var c=a.navigationStart,h=a.responseStart;0<c&&h>=c&&(b[k].srt=h-c)}if(a){var e=b[k].load;0<c&&h>=c&&(e[g]("_wtsrt",void 0,c),e[g]("wtsrt_","_wtsrt",h),e[g]("tbsd_","wtsrt_"))}try{a=null, b[f]&&b[f].csi&&(a=Math.floor(b[f].csi().pageT),e&&0<c&&(e[g]("_tbnd",void 0,b[f].csi().startE),e[g]("tbnd_","_tbnd",c))),null==a&&b.gtbExternal&&(a=b.gtbExternal.pageT()),null==a&&b.external&&(a=b.external.pageT,e&&0<c&&(e[g]("_tbnd",void 0,b.external.startE),e[g]("tbnd_","_tbnd",c))),a&&(b[k].pt=a)}catch(p){}})();b.tickAboveFold=function(d){var a=0;if(d.offsetParent){do a+=d.offsetTop;while(d=d.offsetParent)}d=a;750>=d&&b[k].load[g]("aft")};var l=!1;function m(){l||(l=!0,b[k].load[g]("firstScrollTime"))}b.addEventListener?b.addEventListener("scroll",m,!1):b.attachEvent("onscroll",m); })();</script></head> <body id="blogger-dashboard" class="lang_ja"><script type="text/javascript"> var DashboardClientFlags={0:true,1:true,5:true,9:true,11:10000,12:"/go/adsensehelp",19:"{\x221\x22:{\x221\x22:\x22\\u3084\\u307e\\u3060\\u305f\\u308d\\u3046\x22,\x225\x22:\x22https://plus.google.com/111415095292153979878\x2 …},\x222\x22:[{\x221\x22:\x223265592934540335
師も走りまわる１２月。。皆様（師）も走りまわっていることでしょう。 私は。。。走りません、はい。 本題です。 ExcelのVBAでToggleButtonを排他的に使いたいのです。 調べるとオプションボタンになさいと書かれてはいるのですが・・・。 ワークシート上にToggleButton1～3があります。 １を押す（凹）と“処理A”，もう一度押す（凸）と“処理Ｚ” 2　　同上　　　 “処理Ｂ”，　　同上 3　　同上　　　 “処理Ｃ”，　　同上 以下のコードでなんとなく動くのですが，排他的動作の際には，TrueなToggleButton#の動作をおこなってしまいます。 Excel2007,Windows7です。 師の皆様の良い御提案が御座いましたら御教示下さい。 ----ボタンがあるシートモジュールに記載---------------------------------------- Option Explicit Dim strCode As Variant Private Sub ToggleButton1_Click() If ToggleButton1.Value = False Then strCode = "処理中Ｚ" ' Debug.Print "ＡからＺに戻します。" Else strCode = "処理中Ａ" ' Debug.Print "Ａを押しました。" ToggleButton2.Value = False ToggleButton3.Value = False End If 'Debug.Print "Ａでの処理をします。" Call 処理(strCode) 'Debug.Print "Ａから処理をしました。" End Sub Private Sub ToggleButton2_Click() If ToggleButton2.Value = False Then strCode = "処理中Ｚ" ' Debug.Print "ＢからＺに戻します。" Else strCode = "処理中Ｂ" ' Debug.Print "Ｂを押しました。" ToggleButton1.Value = False ToggleButton3.Value = False End If 'Debug.Print "Ｂでの処理をします。" Call 処理(strCode) 'Debug.Print "Ｂから処理をしました。" End Sub Private Sub ToggleButton3_Click() If ToggleButton3.Value = False Then strCode = "処理中Ｚ" Else strCode = "処理中Ｃ" ToggleButton1.Value = False ToggleButton2.Value = False End If Call 処理(strCode) End Sub Sub 処理(strCode) Dim i As Long Dim Start As Single Dim Finish As Single Start = timer i = 0 'Application.ScreenUpdating = False Application.Calculation = xlCalculationManual For i = 1 To 1000 i = i + 1 Cells(2, 1).Value = strCode & i Next i Application.Calculation = xlCalculationAutomatic 'Application.ScreenUpdating = True Cells(1, 1).Value = strCode Finish = timer Cells(3, 1).Value = Format$(Int((Finish - Start) * 10 ^ 4 + 0.5) / 10 ^ 4) End Sub --------------------------------------------------------------------------- おまけ： 　上記サンプルを作ってみましたが，ToggleButton1だけ相対的に処理速度が速いです・・・。 なぜなんでしょう？？
エクセルVB初心者です。　ウェブサイトから情報を取ろうと思いました。 <dt class="market zsg-fineprint"> <!-- Market Text & tooltip --> <!-- Non-Market Text & Tooltip --> Market <sup>&reg;</sup>: $1.18M</dt> <dt class="market zsg-fineprint"> から"1.18M"を取り込んで現在のセルから右に6個目のセルにコピペしようと思い、次のようなSubを作りましたが、うまく行きません。 Sub getMarket(objIE As Object) Dim MarketPosition As Integer Dim DollarPosition As Integer MarketPosition = InStr(1, objIE.Document, "Market") DollarPosition = InStr(marketPosition, objIE.Document, "$") ActiveCell.Offset(0, 6) = Mid(objIE.Document, DollarPosition + 1, 4) End Sub うまく動作させるためにはどうしたらよいでしょうか?
お世話になります。 エクセルのVBAで、WEBブラウザ内にあるテキストボックスに 文字を入れたいと思っております。 以下のようなページは処理できたのですが、 ・対象ページのブラウザのソースを見ると「textarea」のタグがあり、 　それを取得して、「value」に文字を入れる 「スタイルシート」で書かれたページの処理の方法がわかりません。 お手数ですが、ご存じの方宜しくお願いします。
VB.net2013にて、フォームアプリ作成中です。 アプリの構成としては、 Ａフォーム、Ｂフォームの2画面があり Ａフォームの呼出ボタンにより、フォームを呼び出す仕組みです。 Ｂフォームでは、データ編集できる 下記のような入力コントロールが多数配置されています。 ・テキストボックス ・スプレッドシート ・ラジオボタン ・ユーザコントロール各種 等々 ※Ａフォームには、編集状態を保持するために Ｂフォームのインスタンスを保持しています。 Ｂフォームには、キャンセルボタンが配置してあり、 これにより編集状態を、画面を開きなおした段階まで戻したいと思っています。 Ｂフォームを表示する際に、 Ａフォームの保持している、Ｂフォームのインスタンスを クローンコピーし退避しておくことで Ｂフォームクローンで元に戻そうと構想しています。 ◾︎案1ーーー memberwisecloneのクローンでは、 Ｂフォームの参照型のメンバをディープコピー出来ないようでした。 ーーーーーー ◾︎案2 ーーー 下記参考サイトより、 メモリ上に一旦シリアライズして、コピーする方法は、 基底であるFormクラスがシリアライズできないため こちらも出来ませんでした。 d.hatena.ne.jp/tekk/touch/20100131/1264913887 ーーーーーー フォーム上のコントロールをクローンする 他に良い方法はないでしょうか？ 案1では、値型のメンバはmemberwisecloneでクローン出来たため 残りのコントロールをどのようにディープコピーするかで 悩んでいます。 InvokeMemberなるもので、対象のコントロールについて 別インスタンスを生成するというところは出来たのですが コントロールの編集途中までの各種プロパティ値までは 引き継がれませんでした。 やはり別インスタンスとしたところに 再度入力値を設定しなおしてあげる必要があるのでしょうか？ 作業工数と、汎用性を考えると もっと他に良い方法があるのではないか とは思うのですが・・・ もしよりよい方法をご存知の方いらっしゃいましたら ご教授願います。よろしくお願いいたします。
任意の関数式を入れるとグラフを描くプログラムを作りました。表示するのに時間がかかる（といっても1秒程度ですが）ので「計算中！」と赤で表示させ、グラフが描き終わると消したいと思い、グラフ開始時にLabel2.Visible=True、終了時にLabel2.Visible=Falseを付けましたが、思惑通りには行きません。何故でしょう。おわかりになる方、教えてください。
す。 もともとローカルドライブにソースを置いて開発＆デバッグしておりました。 今回、ソースをネットワークドライブに移動しました。 ソースの読み込みは、問題無くできるのですがデバックを行うと下記のメッセージエラーが発生します。 対処法を教えていただけないでしょうか？？ セキュリティ例外 説明: このアプリケーションはセキュリティ ポリシーで許可されていない操作を実行しようとしました。このアプリケーションで必要なアクセス許可を取得するには、システム管理者に相談するか、構成ファイルでアプリケーションの信頼レベルを変更してください。 例外の詳細: System.Security.SecurityException: 型 'System.Web.AspNetHostingPermission, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' のアクセス許可の要求に失敗しました。 ソース エラー: 現在の Web 要求の実行中にハンドルされていない例外が生成されました。障害の原因および発生場所に関する情報については、下の例外スタック トレースを使って確認できます。 スタック トレース: [SecurityException: 型 'System.Web.AspNetHostingPermission, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' のアクセス許可の要求に失敗しました。] System.Reflection.Assembly._GetType(String name, Boolean throwOnError, Boolean ignoreCase) +0 System.Web.UI.NamespaceTagNameToTypeMapper.GetControlType(String tagName, IDictionary attribs, Boolean throwOnError) +98 System.Web.UI.NamespaceTagNameToTypeMapper.System.Web.UI.ITagNameToTypeMapper.GetControlType(String tagName, IDictionary attribs) +11 System.Web.UI.TagPrefixTagNameToTypeMapper.System.Web.UI.ITagNameToTypeMapper.GetControlType(String tagName, IDictionary attribs) +127 System.Web.UI.MainTagNameToTypeMapper.GetControlType2(String tagName, IDictionary attribs, Boolean fAllowHtmlTags) +228 System.Web.UI.MainTagNameToTypeMapper.GetControlType(String tagName, IDictionary attribs, Boolean fAllowHtmlTags) +28 System.Web.UI.RootBuilder.GetChildControlType(String tagName, IDictionary attribs) +20 System.Web.UI.ControlBuilder.CreateChildBuilder(String filter, String tagName, IDictionary attribs, TemplateParser parser, ControlBuilder parentBuilder, String id, Int32 line, VirtualPath virtualPath, Type& childType, Boolean defaultProperty) +69 System.Web.UI.TemplateParser.ProcessBeginTag(Match match, String inputText) +526 System.Web.UI.TemplateParser.ParseStringInternal(String text, Encoding fileEncoding) +896 バージョン情報: Microsoft .NET Framework バージョン:2.0.50727.8000; ASP.NET バージョン:2.0.50727.8001
VBAを使っていて 関数fffに引数として配列aaaを入れたいとします。 通常 fff(aaa) と指定するところですが fff(aaa()) と括弧を付けて指定する場合もあるようです。 このように括弧を付けるのはどういう理由があったでしょうか？
.NET2005です。既存のプロジェクトを「名前を付けて保存」はできないのでしょうか。お願いします。
正規表現のコードなんですが、 上手く動きません。 何故でしょうか… Sub Test() Dim reg As Object Dim ans As Object Dim c As Range         Set reg = CreateObject("VBScript.RegExp")     For Each c In Range("A1", Range("A" & Rows.Count).End(xlUp))             With reg             .Pattern = "^【[(1)-(20)](\d*/\d*)"             Set ans = .Execute(c.Value)         End With                 If ans > 0 Then             If Len(ans(0).submatches(0)) > 0 Then                             Debug.Print c.Address & "|" & ans(0).submatches(0)                             End If         End If             Next     End Sub
配列の使い方について教えてください １つの配列をどんどん追加したりしたいので１つの mybox　で追加していきたいと思っています。 （下記コードが実現できればと思います。） (1)配列を広げ追加したい (2)繰返しを使わず一気に書き込みたい (3)一部をクリアしたりしたい のですがよろしくお願いします。 Sub Macro1() Range("A1").Value = "A" Range("A2").Value = "B" Range("A3").Value = "A" o = Range("A1").End(xlDown).Row mybox = Range(Cells(1, 1), Cells(o, 1)).Value 'myBox(1,1)=A 'myBox(2,1)=B 'myBox(3,1)=A ←このような表示になります。 '------------------------------------------------- '(1)配列を広げ追加したい ReDim Preserve mybox(o, 2) For i = 1 To UBound(mybox) If mybox(i, 1) = A Then mybox(i, 2) = 0 Else mybox(i, 2) = 1 End If Next i '------------------------------------------------- '(2)(1)をＣ列に「myBox(?,2)を「繰返しを使わず一気に」書き込みたい 'Transposeは限界（65536個）を超えるので使えません。 Range(Cells(1, 3), Cells(UBound(mybox), 3)) = mybox '(3)配列myBox(？,1)は残したままmyBox(？,2)はクリアにしたい End Sub
Ｅｘｃｅｌ２０１３のＶＢでＦＴ２４５を制御したいのですが、ＤＬＬの呼び出し方やその後の使い方などがわからず困っています。 制御したいのは秋月電子の「ＦＴ２４５ＲＬ ＵＳＢパラレル変換モジュール」です。 サンプルプログラムをダウンロードしたりしましたがエラーで使えなかったり、ＶＢ６で作られたものはそのままＥｘｃｅｌで動作しなかったりです。 パソコンはＷｉｎｄｏｗｓ８．１（６４ｂｉｔ）で、Ｅｘｃｅｌの指定のセル上に書き込んだ１バイトデータを、ＵＳＢを通してパソコンから出力し、パラレル８ビットで扱いたいのです。 今実験的に変換モジュールの出力ピンにＬＥＤを付けて、ＬＥＤを点灯させる回路を作ったのですが、パソコンからの操作方法がわからず止まっています。 どなたかお分かりになるかたいらっしゃいませんでしょうか。
VisualStugio.Net2003でソースコードを記述しており、コード内でSQLのSELECT文を実行して、実行結果をDataTableに格納する処理をしています。 今回、とあるテーブルに対し２パターンのSQLを実行し、それぞれの実行結果を１つのDataTableに格納したいのですが、どのようにすれば良いでしょうか？ 自分で調べたところ、先に実行したSQL結果に、後から実行したSQL結果を１行ずつ追加するといった方法は見つかりましたが、１行ずつではなく、一括で追加する方法が知りたいです。 前提として、２回のSQL実行では、同じテーブルの同じ項目をSELECTしております。 下記に簡単ですがコード記述の概要を補足しておきます。 ・コード記述概要 【変数宣言】 Dim DB1 As DataTable Dim DB2 As DataTable 【SQL文1】 SELECT A,B,C FROM テーブル１ WHERE 条件文１ DB1 = SQL文1の実行結果 【SQL文2】 SELECT A,B,C FROM テーブル１ WHERE 条件文２ DB2 = SQL文2の実行結果 【DB1にDB2のデータを追加】←ここのやり方を知りたいです DB1 = DB1 + DB2 よろしくお願いいたします。
様々なサイトを参考にして、自分でマクロを作り、うまく動作したまではいいのですが、不勉強で不備があるかどうか自分では判断できません…。 どなたか不備を指摘してはいただけないでしょうか。 内容：指定したフォルダ内のフォルダ名を、一行ずつ間を空けて書き出す。 Public Sub make_FolderList_02() ' FileSystemObjectを作成する。 Dim Obj As Object Set Obj = CreateObject("Scripting.FileSystemObject") ' フォルダ名をシート上に出力する為のカウンタ Dim cnt As Long cnt = 0 ' 「C:\Sample」フォルダ配下に存在するフォルダを一つずつ参照する。 Dim f As Object For Each f In Obj.GetFolder("C:\Users\test\Desktop\test").SubFolders ' フォルダ名をシート上に出力する。 Range("A1").Offset(cnt, 0).Value = Obj.GetFolder(f).Name cnt = cnt + 1 ' 空白セルを出力する。 Range("A1").Offset(cnt, 0).Value = Null cnt = cnt + 1 Next f Set f = Nothing ' 別のフォルダを書き出す Dim a As Object For Each a In Obj.GetFolder("C:\Users\test\Desktop\nyannko").SubFolders ' フォルダ名をシート上に出力する。 Range("A1").Offset(cnt, 0).Value = Obj.GetFolder(a).Name cnt = cnt + 1 Range("A1").Offset(cnt, 0).Value = Null cnt = cnt + 1 Next a Set a = Nothing ' オブジェクトを破棄する。 Set Obj = Nothing End Sub ここでは、２つのディレクトリを書き出していますが、実際には、６～７つ書き出す予定です。 また、参照先を共有フォルダにした場合、過剰な負荷が掛からないかどうかも、教えていただけると嬉しいです。 大変無駄の多い内容だとは思いますが、ご指導のほどよろしくお願いいたします。
日時をFormat関数を使って所望の書式に変更したいのですが http://excelvba.pc-users.net/func/func3.html このページにあるようになぜかmmには 月と分という二つの異なるものが割り当てられています。 yyyymmdd のようにyyyyやddと一緒に書くと月となり、 mmのように単体で書いても月になり、 hh:mm:ss　のようにhhやssと一緒に書くと分として扱われます。 では、 分だけを単体で取り出したい場合にはどうしたら良いのでしょうか？ yyyymmss とかに年と時間を混ぜたらどうなるのでしょうか？ 月と分をちゃんと使い分ける方法があれば教えてください。
Excel2003で作ったVBAマクロを互換モードで保存し、ずっとExcel2013で実行できていましたが、2014.12.13に実行しようとしましたら、 Sheets("当番表サンプル").Select で実行エラー（インデックスエラー）になってしまいました。 Excel2010で実行したら、通りました。 どういう理由でしょうか？
下記の図表【事前】のA列に時間（シリアル値）が入力されていますが、 これをマクロを使って不要な時間帯のデータを行ごと削除したいです。 それを実行するためのマクロをご教示頂けますでしょうか？ 削除対象の条件 ・9:00:00～18:00:00以外の夜間や早朝の時間帯は削除する。 その他 ・データが入力されている行数分繰り返し処理 ・秒数、分数は全て0 ・列は3列（B、C列は任意） ・Excelのバージョンは2007 【事前】 　　A　　　　　　　　　　　　　　　　　　　　　　　B　　　　　　C １ yyyy/mm/dd 01:00:00　※削除対象 ２ yyyy/mm/dd 23:00:00　※削除対象 ３ yyyy/mm/dd 09:00:00 ４ yyyy/mm/dd 15:00:00 ５ yyyy/mm/dd 17:00:00 ６ yyyy/mm/dd 19:00:00　※削除対象 ７ yyyy/mm/dd 04:00:00　※削除対象 【事後】 　　A　　　　　　　　　　　　　　　　　　　　　　　B　　　　　　C １ yyyy/mm/dd 09:00:00 ２ yyyy/mm/dd 15:00:00 ３ yyyy/mm/dd 17:00:00
数値をソートする方法にはバブルソートやクイックソートなどがあり アルゴリズムは分かるのですが 文字列を五十音順にソートしたい場合にはどのようにしたら良いですか？ 検索をかけてみたのですが、大抵プログラミング言語に備わったsortの方法が紹介されており 自分で処理を行う方法については書かれていません。 ExcelのSort機能を使わない方法で教えてください。
JPEG画像のEXIF情報を読み取って、撮影日時を出力するプログラムを作りたいのですが http://www.btinc.jp/vba_labo/study1.html このページに書かれたものを実行しようとすると Set objJpeg = New JpegExif のところで、 ユーザー定義型は定義されていません と言われて実行することができません。 http://blog.livedoor.jp/hamu1962/archives/513758 … このページに書かれたものを実行しようとすると Set objFolItem = objFol.ParseName(tarFile) のところで、 オブジェクト変数またはWithブロック変数が設定されていません。 と言われて実行することができません。 どうすればうまくいきますでしょうか？ それと、上記二つの方法はどちらの方がお勧めでしょうか？
http://oshiete.goo.ne.jp/qa/8852322.html http://oshiete.goo.ne.jp/qa/8856128.html このページで画像の配列への入出力の仕方を教えていただきました。 配列の読み書きの方法が分かればできるかと思ったのですが やり方がわかりませんでしたので質問いたします。 24あるいは32bitの場合には教えていただいた方法で問題ないのですが 8bitの画像（インデックスカラー画像）の場合にはどうしたら良いでしょうか？ 8bit画像を GdipCreateBitmapFromFile(ByVal StrPtr(strInName), pSrcBitmap) で取得し、そのまま GdipSaveImageToFile pSrcBitmap, StrPtr(strOutName), encTIFF, VarPtr(udtEncParam) を使って、別の画像形式に再圧縮して出力しても 8bit画像として出力されるので、 pSrcBitmapにはインデックスカラーに関する情報と 256階調（8bit）での画像情報も含まれているようです。 しかしながら、 GdipBitmapGetPixel pSrcBitmap, x, y, myARGB で画像情報を抽出すると 8bit画像を読み込んだとしても 32bitカラー情報として抽出されてしまいます。 http://www.vbforums.com/showthread.php?718163-GD …(untrusted) このサイトにPixelFormatの設定の仕方が書かれてあって、 PixelFormat24bppRGB = &H21808 を用いると24bit画像として出力できることが分かりました。 PixelFormat8bppIndexed = &H30803 を指定してみたのですが、 一応、8bit画像として出力することは確認できたのですが 出力にものすごく時間がかかってしまうのですが。 恐らくインデックスを生成するのに時間がかかっているのだと思うのですが 既にインデックスがでている場合にどのように指定すれば良いか、 8bit画像からインデックスを抽出するのかが分からないのですが。 どのようにすれば インデックスカラーと256階調（8bit）での画像情報を 配列に読み込み、および配列から画像への書き出しを行えますでしょうか？
ＶＢＡのOn Errorステートメントでエラー処理を行うときに、VBAソースの何行目で エラーが発生したかをメッセージBOXに表示したいのですが。 また、上記に近い類似の方法がありますか。 ご指導願います。
http://oshiete.goo.ne.jp/qa/8852322.html このページで、 配列から直接圧縮画像ファイルを出力する方法を教えていただきました。 次は圧縮画像ファイルから配列を読み取るプログラムを作りたいと考えています。 http://tanlab.blog.fc2.com/blog-entry-31.html このページで画像ファイルをメモリに読み込む方法は書かれていて、 GdipCreateBitmapFromFile(ByVal StrPtr(file1), image) で変数imageに読み込むことができます。 このimageを上記のページの変数pDstBitmapに回すことで、 読み込んだ画像を別の画像として出力できることがわかりました。 いまやりたいことは 変数imageあるいは変数pDstBitmapを配列に書き出すことなのですが どうやれば良いでしょうか？ これらの変数はLongとして定義されていて、 型が配列ではないのですが どのようにして扱えば良いのでしょうか？ 一応、検索などして調べてみましたが 分かりませんでしたので教えてください。
困っております。助けてください。。。 顧客一覧があります。 それぞれの町名で判断して、これぞれの顧客に担当支店を振り分けたいのですが、 if文で ○○町　だったら　０１支店 else if ××町　だったら 02支店 というふうに、ひたすら書いていくしかないのでしょうか？ 対象住所は一つの市の数あるので、膨大です。 郵便番号で範囲をきめて、ふりわけていくのが一番かと思っているのですが・・・。
VBAについての質問です。 Excel2013を使っています。次のような場合に不具合があります。 sheet１上にフェオームコントロールのボタンを配置し、ユーザーフォームを呼び出します。 ユーザーフォームにはコマンドボタンを配置し、コードは　Worksheets("Sheet2").Select　です。 実行すると、Sheet2に画面は変わりますが、セルに何かを入力すると、入力したはずのものがすぐ 消えて、しまいます。スクロールもできません。 実際には　Sheet１　に入力されています。 sheet１上のボタンをActiveXコントロールのコマンドボタンを使用して、同じユーザーフォームを呼び出し実行すると、正常に作動します。 この現象は、2010以前のバージョンだと、どちらも同じ動作をすると思います。すべてを調べたわけではありませんが。 12月10日（水）の更新後、Excel2013ではActiveXコントロールのコマンドボタンが使用できなくなったと思いますが、VBAに詳しい方で、何か解決策をご存じの方、アドバイスをお願いします。
VBAでフォーム上のListViewにavi動画ファイルをD&Dすると そのパスを読み取って、自動でプログラムを実行するマクロを作成しました。 問題無く実行できる場合には問題ないのですが バグがあったりして、デバッグモードに入ったり 途中でプログラムの実行を中断したりすると、 そのavi動画ファイルをシート上にD&Dしたのと同じ状態になり Excelでavi動画ファイルを開こうとしてしまいます。 大きなファイルなら開けませんが、 小さなファイルだとバイナリデータとして無理矢理開くことになり Excelがフリーズしてしまいます。 それでVBAかExcelの設定で シート上にファイルをD&Dしても読み込まない設定にしたいのですが どのようにすれば良いでしょうか？ 一応検索して調べたのですが見つかりませんでした。 どなたか教えてください。
access2003でSQLServer2008へのリンクテーブルを作成し、 vbaでadoを使ってデータ更新処理をしようとしています。 以下のように記述していますが、 実行後、BやCのテーブルが開かなくなります。 （正確にはインサートしたデータが表示されるであろうページがロックされているような動きです。） また、その状態からAccessを一旦終了し、再度起動すると、データがインサートされていない状態です。 コミットが効いてないように感じます。 こちら原因としてどんなことが考えられるでしょうか？ ちなみにDAOで動かしても同様でした。 宜しくお願い致します。 以下 コード＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Set cn = CurrentProject.Connection Set rst = New ADODB.Recordset cn.BeginTrans rst.Open "select key from A", cn, adOpenForwardOnly, adLockReadOnly Do Until rst.EOF cne.Execute "insert into B （ aa, bb） select aa, bb from A where key = " & rst!key & " " cne.Execute "insert into C （ aa, bb） select aa, bb from A where key = " & rst!key & " " rst.MoveNext Loop rst.Close cn.CommitTrans cn.Close set rst = Nothing set cn = Nothing
Win7(32bit) Excel 2010 を使用していますが、突然、以下の不具合が発生しました。 1.　シート上に配置したActiveXコントロールのコマンドボタンが押せない状態に 　　 なりました。（マクロは起動します） 2. ActiveXコントロールが使用出来ない。 この事象は、12/11のWindows Updateの更新プログラムを自動更新した以降に 発生しました。そこで、更新プログラムの不具合と思い、順次アンインストールして 確認しましたら(KB2687455)の32ビット版更新プログラムを削除すると復元すること が解りました。マイクロソフトの技術サポートに連絡しましたら、本件は有料相談に 該当しますので、34,344円かかるとの事でしので、悩んでいます。皆さんに同様な事象 は発生していませんか？　何か良い対策方法か、情報などありませんでしょうか。 教えて下さい。
VB６に関する質問です。 以前VB６で制御していた検査設備があり（１０年前ほど） 急遽それを動作させることになったのですが、QRリーダ（RS２３２C信号をcomportで通信） で読み取りを行うと、一度目はうまくいくのですが、 ２度目以降は、前回の読み取り対象のQRコードないようが表示される問題が生じて困っています。 プログラムの流れとしては １．timerでデジタル入出力を監視 ２．入力信号が来たらQRリーダに読み取り命令 ３．Oncommイベントが発生 ４．受信内容をラベルに表示 というものです。 mscommのオブジェクトを新しく作りなおしたり、 リーダを変更したりしましたが、効果がありません。 詳しい方、原因の推測とその対処方法を教えてください。
VB6.0 でCSVの取り込みをしています。 Dim objFso As FileSystemObject Dim objTso As TextStream Dim データ As Variant Dim stArrayData() As String Set objFso = New FileSystemObject Set objTso = objFso.OpenTextFile(取込パス, ForReading) データ = objTso.ReadLine '配列に格納 stArrayData = Split(データ, ",") 'データの取得 データの取得 = stArrayData(0) stArrayData(0)で、データが取得できますが、 ダブルコーテーションが付加された状態で取得がしたいのですが、できません。。 今は、「000」で取得しているのを、 「"000"」で取得したいのです。 なお、取込むＣＳＶをテキストで開くと、 ダブルコーテーションはついていません。 また、そもそも、取込む際に、ダブルコーテーションを付加する方法があるのでしょうか？ それとも、取込んだ後に、ダブルコーテションを付加するのでしょうか？ ご教授宜しくお願いします。
ある配列をtiff画像ファイルとして出力したいのですが 配列を一度bmp画像ファイルとして出力して http://oshiete.goo.ne.jp/qa/8809275.html このページにある方法を使って、それをtiffファイルに変換して 残ったbmpファイルを削除するというプログラムを作りました。 この方法だと、HDDにアクセスする手順が多くなるため、ファイル数が多い時に時間がかかってしまいます。 bmpファイルをメモリにいったん保存しておいて、 それをtiffファイルに書き換えるようなプログラムを作るにはどうしたら良いですか？ あるいは配列から直接tiff画像ファイルを出力する方法があれば 教えてください。
CSVの取り込み部分を作っていて、ほぼOKの状態にはなっているのですが 取り込む際にカンマを基準にデータを区分けしている為、金額の部分にカンマが入っていると、金額が分割したデータとして扱われてしまいます これをうまく解消する方法はないでしょうか？ よろしくお願いします。
マクロで以下のような操作をしたいと思っております。 どのようなコードを書けばよろしいでしょうか。ご教授ください。 【顧客データ一覧.xls】というブックのシート１に顧客データ一覧表があります。 同ブックのシート１上部にコマンドボタンを作成し、ボタン押下で以下のような操作を行いたい １.ファイルダイアログを開いて、【顧客データひとり分.xls】というブックを選択 ２．【顧客データひとり分.xls】に入力されているデータを、【顧客データ一覧.xls】の顧客データ一覧表の末尾に、コピーして追加・上書保存 顧客データひとり分はセル（3,4)に年齢が入力されている等、入力箇所は固定です。 ３.顧客データひとり分.xlsは閉じて、更新された顧客データ一覧.xlsを表示させる よろしくお願いいたします。マクロは作成したことがありますが、何年もブランクがあり、かなり忘れてしまいました・・・。 と、エクセル2003以来久しぶりに操作ですので、エクセルそのものに大変戸惑っております。。。実力不足でお恥ずかしいのですが、お力をお借りできれば幸いです。
エクセルVBAについて、同じ型の値が複数列あった際に、変数に取り入れる方法として、それぞれ一つずつ別々に変数に入れる場合と、ユーザー定義型変数を定義して入れる場合の二つがあると思いま すが、どちらの方がメモリを使わなくて済むのでしょうか。また、他にも長短があればご教示下さい。
過去の質問を閲覧していて入力方法が解らなく、初歩的な質問だとは思うのですがご教授頂きたく宜しくお願い致します。 「Rst.FindFirst "名称コード" & " = " & "' 101 "'」という記述を「Microsoft Visual Basic for Applications」を使用し「"' 101 "'」と入力する場合、半角ＡでShift+2(")で、「"」が入力できますがそのまま、Shift+7(')と入力すると、「"の３番目」がセミコロンの下部分の様な記号が入力されてしまいます。つまり「"'」となりません。（この質問ページでは「"'」と入力出来ますが）どの様にすれば「"'」と入力出来ますでしょうか？
VBAです。 If (a <1 and a>100) OR (b<1 and b>100) then これは(a <1 and a>100)か、(b<1 and b>100)のいずれか、あるいは両方が成り立っている場合の条件。 どちらか片方のみが成り立っているとしたい場合には、 If ((a<1 and a>100) OR (b>=1 and b<=100)) OR ((a>=1 and a<100) OR (b<1 and b>100)) then とする必要がありますか？ もっと簡単な方法があれば教えてください。
vbsでデバイスインスタンスパスを取得し、そのデバイスインスタンスパスを vb.netで使用してデバイス制御アプリケーションを作成しようと考えています。 ですがvbsで取得したデバイスインスタンスパスをvb.netで受け取るための手段が調べても わかりませんでした。 ご存じの方がいらしたら教えていただきたいと思います。
　VB.net 2010 のプログラムで、ExcelからA4サイズの帳票を作り、自動印刷する機能を作っていますが、解決できない点が1つありますので、質問させて頂きました。 　実行するPCによって、1枚当たりに印刷できる幅が異なるのです。 　画像をご覧いただきたいのですが、画像上段にある"A"はBV列までが、印刷できる範囲です。ところが"B"では、CF列までが印刷範囲となっています。(各列の幅は0.64(9ピクセル)です。) ”ページ設定”の値を見比べましたが、全て同じ設定です。 　結果、"B"になってしまうPCで帳票を作ると、BW～CF列の余計な列のせいで、印刷できる帳票のサイズが小さくなってしまいました。 実行したPCの環境は以下のものです。 　A画像になったPC　 Windows7 & Excel2010 　B画像になったPC　Vista & Excel2007 　プリンタは同じプリンタを使っています。 A4で1枚当たりに印刷できる長さを固定に出来ないかご教授ください。 VBの印刷設定～印刷までのソースは次の通りです。 (objAppはExcel.Application、objSht はExcel.Worksheet オブジェクトです） Dim xlPageSetup As Excel.PageSetup = objSht.PageSetup With xlPageSetup .PaperSize = Excel.XlPaperSize.xlPaperA4 '用紙サイズをＡ４ .Orientation = Excel.XlPageOrientation.xlPortrait .LeftMargin = objApp.CentimetersToPoints(1.3) '左余白 .RightMargin = objApp.CentimetersToPoints(1) '右余白 .TopMargin = objApp.CentimetersToPoints(1.4) .BottomMargin = objApp.CentimetersToPoints(1.5) .FooterMargin = objApp.CentimetersToPoints(1) .HeaderMargin = objApp.CentimetersToPoints(0.8) .PrintTitleRows = "$14:$16" .LeftFooter = "&""ＭＳ Ｐ明朝,""XXXXXX会社　見積書 (NoXXXXX)" .RightFooter = "&""ＭＳ Ｐ明朝,""&P/&N" .CenterHorizontally = True End With objSht.PrintOutEx()
皆様おはこんばんちわ。 セル(Ex.B2,B3,B4)をダブルクリックする度に、そのセル内にオートシェイプを描画／削除したいのです。 描画は下記（で良いのかですが）で出来たのですが、削除がどうしてもわかりません。 ------------------------------------------------------------------------- Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) If Intersect(Target, Range("B2:B4")) Is Nothing Then Exit Sub With ActiveCell With ActiveSheet.Shapes.AddShape _ (msoShapeOval, .Left, .Top, .Width, .Height) .Fill.Visible = msoFalse .Line.Weight = 1.75 .Line.ForeColor.SchemeColor = 0 End With End With End Sub ------------------------------------------------------------------------- 既に図形があるセルをダブルクリックで削除するにはどの様な方法があるのでしょうか。 バージョンはExcel2007です。 皆様よろしくご教示ください。
今、エクセルにて商品管理をするツールを作成していました。 ユーザーフォームにて、売却した商品コードを入力すると、在庫シートから該当商品を検索し、ユーザーフォーム内に商品データが入力されるようになっています。 売上登録処理を実行した時に、売買明細シートへＡ列には(1)売却した商品コード、Ｂ列には(2)売却した商品名、Ｃ列には(3)売却価額、Ｄ列には(4)売却した商品の仕入価額（これは”在庫シート”の中で商品コード（Ｂ列）を検索し、在庫シートのＪ列から引っ張る）という情報を転記したあと、(5)在庫シートへ記載されているその商品情報の行を削除したいのです。 (1)～(3)の処理はできたのですが、(4)の在庫シート内で商品コードを検索する　というコードが書けません。 (1)～(3)の処理は、 Dim Ctrl As Control With Worksheets("売買明細") 'A列の最終セルからEndプロパティでデータの最終行を取得し、 '＋１をして、次にデータを入力する行の行番号を取得 RowNum = .Cells(Rows.Count, 1).End(xlUp).Row + 1 'ワークシートの行列を指定してテキストボックスの値を1つずつセルへ代入 .Cells(RowNum, 1).Value = Me.商品コード.Value .Cells(RowNum, 2).Value = Me.商品名.Value … 以下続くとしました。 すみませんが、どなたかお知恵を貸していただけないでしょうか。 よろしくお願いいたします。
こんにちは。 Visual Studio 初心者です。 テキストファイルを開く、簡単なプログラムを作成しました。 そのテキストファイルを開発マシンに保存すると、問題なく開くのですが テキストファイルをサーバーに指定するとエラーが発生します。 開発環境はWindows 8.1 Pro 64bitで、 .NET Framework 4.0を使用しています。 サーバーはWindows Server 2008 R2 32bitで .NET Framwork 3.5がインストールされています。 なにが原因かわかりますか？
お世話になっています。 標題の件に付いて教えて頂きたく質問板に投稿させて頂きました。 以下の様な複数の文字列があり各文字列で共通の文字列のみを抽出するといった処理を行いたいのですが可能でしょうか？？ 例(1) 赤鉛筆を11/1に購入 青鉛筆を11/5に購入 黄鉛筆を11/20に購入 →鉛筆を購入 例(2) 今日の天気は晴れです 今日の天気は曇りです 今日の天気は雨です →今日の天気はです という様な感じです。 文字列には決まったパターン等はありません。 申し訳ありませんがご教授下さい。 よろしくお願い致します。
困っております。 ご教授ください。 エクセルシート上に1～10の数字が列方向に並んでいます。 ユーザーフォームでtextbox1とtextbox2を作成します。 textbox１とtextbox2は1～10の間で範囲を入力します。 textbox2でエンターを押されたときに処理が開始します。 例えばtextbox１に「3」、textbox2に「8」が入力された場合、 3,4,5,6,7,8のセル範囲を選択したいのですがどのようにすればよろしいでしょうか。 よろしくお願いします。
１行目には１ヶ月分の日付がはいっています。 ２行目にはWEEKDAY関数で１行目の日付の曜日をいれています。 ３行目に月曜日（WEEKDAY関数では２）なら公休日の"公"と表示したいのですがどのようにしたらよいでしょうか？ Sub 公休日() If Range("A2").Value = 2 Then Range("A3").Value = "公" End If End Sub このような作業を繰り返すにはどうすればよいでしょうか？ 補足として、エクセル2007を使用しています。 ３行目には数字を入力するためIF関数を使うことができません。
いつもお世話になっております。 エクセルVBAでIE制御についてです。 環境はWIN7、IE 9or11とエクセル2010です。 あるページのリンクをクリックすると、 WEBからのメッセージというダイアログボックスが出てきて、 続行しますか？　はい　いいえ　を聞かれます。 その「はい」をVBAで押したいのですが、 sendkeysメソッドで押そうとしてもうまくいきません。 以下に記載したサイトのOKボタンを押すと出てくるものです。 http://kamicha1.web.fc2.com/Excel/Test20090726.h … 以下が書いたコードです。 Declare Sub Sleep Lib "KERNEL32" (ByVal dwMilliseconds As Long) Sub test() Dim ie As Object Set ie = CreateObject("InternetExplorer.Application") ie.Visible = True ie.navigate "http://kamicha1.web.fc2.com/Excel/Test20090726.h … 　　　　　　 Do While ie.Busy Or ie.readyState < 4 DoEvents Loop ie.document.getElementsByClassName("bt2")(0).Click　'-ここで止まる Sleep 2000 SendKeys "{Enter}" End Sub ステップ実行していくと、ここで止まると書いた所で、 IE上にダイアログは表示されるのですが、 それ以上ステップ実行ができなくなってしまいます。 ダイアログを自分でOKかキャンセルで消すと続きが動くようになります。 その間はVBEはビジー状態となり操作できません。 そのためそれ以降のsendkeysメソッドに たどり着けない状況かと思われます。 いろいろ調べたところIE8以降はダイアログボックスは IEから出ているのではなくOS？から出ているとの事でした。 上記のサイトはHTML本体にjavaスクリプトが記載されており、 それをVBAから操作すればどうにかOKボタンが押せるらしいのですが、 自分が操作したいページにはそれらしき記載がありませんでした。 対象のアンカータグは <a herl=URL 中略　data-comfirm=続行しますか？　＞ のような感じで記載がありました。 完全に煮詰まっております。 自動でOKをクリックするかEnterキーでOKを押すでも構いません。 どうかご教授お願いいたします。
現在、カレンダーをプログラミングで作成しています。 カレンダーの土日を色づけして表示するところまでは、出来たのですが、祝日でつまづいています。 企業などで、休みは暦通りや、カレンダー通りという言葉を耳にしますが、これを作成するには祝日の振り替え休日のロジックがわかりません。 どの祝日は振り替え休日となるのか、何曜日に対して振り替えされるのか、振り替えされない場合など、ルールがわかりません。 どなたか、詳しい方アドバイスよろしくお願いいたします。 参考URLなどあると助かります。 尚、現在テストプログラムはExcel_VBAで作成しています。 今後、VBかC#でも作成する予定です。 よろしくお願いします。
お世話になります。 現行使用しているモジュール内に記述されているファイル名をVBAで書き換えたいのです。 現状コーディング中に記述されているファイル名には、頭に年度を表わす、例えば 2014年なら下2桁の　"14データ処理用"　と書かれていて、年度が変わるたびに、 14を15の様にキーボードより編集しています。 　しかしモジュールの中にファイル名の記述箇所が複数あり、またモジュールは複数あり その中にもその年のファイル名が記述されているために修正も一苦労しています。 そこでVBAのコードの記述を変換するためのフォームを作成し、西暦の下2桁を、前年、当年 それぞれ入力し、前年で検索して当年に置換するようにしたのですが、実行時エラー'13' で落ちてしまいます。 PCはゲストで使用しています。御存じのかたいらっしゃいましたらご教示願います。 以下VBAのコーディングです。宜しくお願いします。 Option Explicit Dim Target As Workbook, VBC, i As Long Private Sub CommandButton1_Click() Set Target = Workbooks(Sheet1) With Target.Workbooks(Sheet1).VBProject.VBComponents("Module1").CodeModule For i = 1 To .CountOfLines If .Lines(i, 1) = "" & In_Year & "データ" Then 'In_Year;前年 .ReplaceLine i, "" & Out_Year & "データ" 'Out_Year;当年 End If Next i End With Target.Save End Sub
VB2008+Access2003でプログラムを組んでいます。 VB2008の経験は2年位です。 MDBテーブルへの削除・更新処理で疑問がわいてきましたので質問いたします。 ご回答よろしくお願いいたします。 MDBへの接続処理は省略しています。 　　 下記のトランザクション処理で正常に削除・更新されますが Disposeしないコマンド(Cmd42)の使い回しに問題はありませんか？ 　　 Dim Cn As New OleDb.OleDbConnection Dim RsTran As OleDb.OleDbTransaction Try 　　　RsTran = Cn.BeginTransaction 　　　Me.Cmd42 = Cn.CreateCommand 　　　Me.Cmd42.Transaction = RsTran 　　　Me.Cmd42.CommandText = "DELETE * FROM 売上テーブル " _ 　　　　　　　& " Where (MitumoriNo = '" & Insatu_MitumoriNo & "') " 　　　Me.Cmd42.ExecuteNonQuery() 　　　Me.Cmd42.CommandText = "DELETE * FROM 売上サマリーテーブル " _ 　　　　　　　& " Where (MitumoriNo = '" & Insatu_MitumoriNo & "') " 　　　Me.Cmd42.ExecuteNonQuery() 　　　Me.Cmd42.CommandText = "DELETE * FROM 請求合計テーブル " _ 　　　　　　　& " Where (MitumoriNo = '" & Insatu_MitumoriNo & "') " 　　　Me.Cmd42.ExecuteNonQuery() 　　　Me.Cmd42.CommandText = "UPDATE 見積書テーブル " _ 　　　　　　　& " SET KousinDay='" & dumy & "' " _ 　　　　　　　& " Where (MitumoriNo = '" & Insatu_MitumoriNo & "') " 　　　Me.Cmd42.ExecuteNonQuery() 　　　RsTran.Commit() 　　　MessageBox.Show(Me, "削除しました") Catch ex As Exception 　　　RsTran.Rollback() 　　　MessageBox.Show(ex.Message) 　　　Call 終了処理() End Try Me.Cmd42.Dispose() RsTran.Dispose()
動作環境 OS:Windows7(64Bit) Home Premium SP1 MS:Office Version2007 SP3 Excel図形内のテキストの編集で、マウスをドラッグしてテキストの領域を選択後、コンテキスト メニューから、フォント(F)－フォント(設定ダイアログ)画面－[フォント]タブ上に、下線の色が、 あります。 テキスト設定した場合、vba上から下線の色を取得する方法が、知りたいです。 大体、目途は、付いています。 どなたか、ご指導願います。 ■現在、自分が、分かっている下線の色を取得するPG 下記の方法ですと、全てエラーです。 For Each wkbWorksheets In ActiveWorkbook.Worksheets For Each wksShapes In wkbWorksheets.Shapes With wksShapes.TextFrame2.TextRange.Characters MsgBox .Font.UnderlineStyle.ColorIndex MsgBox .Font.UnderlineStyleColorIndex MsgBox .Font.Underline.ColorIndex MsgBox .Font.UnderlineColorIndex End With Next wksShapes Next wkbWorksheets
お世話になっております。 VB.netで、特定の文字から7文字を複数回取得したいのですがうまく出来ません。 instr、midを使うまでは分かったのですが、複数回となると出来ませんでした。 例： 01.aaa:00-0001 02.bbbb:00-0002 03.ccccc:00-0003 04.dddddd:00-0004 05.eeeeeee:00-0005 ↓ 「:」の後ろから7文字を取得。検索回数は5回と決まっておらずランダム。 00-0001 00-0002 00-0003 00-0004 00-0005 としたいです。 先生方、お忙しいところ申し訳ありませんがお力をお貸しくださいませ。 よろしくお願いいたします。
以下のように関数を設定し、実行してみたのですがCall CommonModule.testの部分で 実行時エラー '424': オブジェクトが必要です。 と表示され関数が実行されません。 初心者なので知識が浅く、初歩的なミスかもしれませんがご教示いただければ幸いです。 Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal target As Range) If target.Count = 1 Then Dim column As Integer Dim row As Integer column = target.column row = target.row If row >= 3 Then If ((column - 3) Mod 5) = 2 And column > 3 Then Call CommonModule.test 'エラー '424' オブジェクトが必要です。 End If End If End If End Sub Function test() MsgBox "test" End Function
フォームをロードし、下記のようにしてもカーソルが点滅しません。その解決方法を教えてください。 Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load TextBox1.Focus() End Sub
メインフレームとVB.NETの両方をご存知の方にお尋ねします。 メインフレーム上のPL/IプログラムをWindowsサーバ上にて、 テキストファイルにして保存してあります。 このPL/Iソースをいろんな角度から解析したいのですが、 コメント部分が邪魔なので削除したいです。 VB.NETの正規表現を使ったら上手にできるでしょうか？ またできるのであれば、そのロジック（ソース）をご教示願いたく 存じます。 PL/Iのコメントは、「/*」と「*/」で囲まれた範囲で、 複数行にわたることが可能です。 　⇒ｎ行目に「/*」があり、ｎ＋ｍ行目に「*/」がある場合、 　　ｎ行目からｎ＋ｍ行目まですべてがコメント扱いとなる。
町の図書館です。蔵書データをエクセル（蔵書リスト）で3万件持っています。 実際に本があるかどうか蔵書点検をしたいと思っています。 バーコードリーダーで図書のバーコード（図書ＩＤ）を一件ごと読みこんで、図書ＩＤをエクセルの新ファイル（図書ＩＤリスト）に次々と入れ込みたいのですができますか？ 読み込みができれば、蔵書リストとマッチングするマクロを組みたいと思います。
win7を使っています。 あるブックに入ったVBAで別のブックに入ったsubマクロを開きたいのですが http://qanda.rakuten.ne.jp/qa7769745.html このページに書かれた方法を参考にすると 別のxlsmファイルが開いて、マクロを開こうとするところまではいくのですが 権限がない、と言われてsubを開くことができません。 回答をよく読むと、XPの方法には対応しているが win7に対応しておらず xlApp.Visible = True xlApp.Run "'" & MyFileName & "'!" & "test" を入れるとうまくいく、 みたいなことが書いてあるのですが、 これをやってもうまくいきませんでした。 どなたか方法を教えてください。
こんばんは .vbsファイルからデータベースを操作しようとして躓いています。 エクセルvbaでは動いているのに、.vbsに移植するとエラーが出てしまいます。 エラーの内容は「プロバイダーが見つかりません。正しくインストールされていない可能性があります。」です。 次のスクリプトです。 'ここから Dim ADO_CONNECT Dim MDBName Dim dbCon Dim strSQL ADO_CONNECT = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" MDBName = WScript.Arguments(0) 'エクセルVBAの場合はハードコード Set dbCon = CreateObject("ADODB.Connection") dbCon.Open ADO_CONNECT & MDBName & ";" strSQL = "命令文" dbCon.Execute (strSQL) 'ここまで プロバイダーの場所、バージョン、32/64ビット、あたりに問題がのかもしれませんが、調べてもよくわかりません。エクセルVBAでは動作するので、参照設定？の違いなのかもしれません。どのように解決したら良いでしょうか。 Win 7 Pro 64bit MS Accessなし Excel 2007 あり
　関数のグラフを描くプログラムを作りましたが、グラフが背面にあり、座標平面の格子に消されています。前面に出す方法はありませんか。 　FormにPictureBoxを載せ、格子はe.Graphics.DrawLineで描き、グラフはビットマップに描き、PictureBoxのImageで置きました。宜しくお願いします。
VBAのLOOPを　バグって　表が　大きくなりました。 余分のデータは小さくしたのですが、縦スクロールが　小さく成りません。 マクロ記録で　下記をやってみたのですが、効果ありません。 どこで、間違ったのでしょうか？ Selection.SpecialCells(xlCellTypeLastCell).Select Rows("291964:291964").Select Selection.Delete Shift:=xlUp Columns("BH:BH").Select Selection.Delete Shift:=xlToLeft ActiveWindow.LargeScroll ToRight:=-3 ActiveWindow.LargeScroll Down:=-1 Range("A1").Select ActiveWorkbook.Save それとも、縦スクロールを現実データに反映させる方法は別にあるのでしょうか？ よろしくどうぞ
vb6で座標平面を作成するプログラムを作っています。lineやlabelを配列で設置しましたが、 lineが前面に出てしまい、とても見づらいものになってしまいました。labelを前面に出すにはどうしたらよいでしょうか。 (1)lineコントロールを配置し、index=0 (2)labelコントロールを配置し、index=0 (3)(1)と(2)が重なるようにします（label1(0)が前面に出ています）。 (4)以下を実行します Private Sub Form_Load() Form1.ScaleMode = 3 Label1(0).FontSize = 15 Label1(0).FontBold = True Line1(0).BorderWidth = 2 Line1(0).BorderColor = &H80000005 Load Line1(1) With Line1(1) .X1 = 100 .X2 = 100 .Y1 = 0 .Y2 = 200 .Visible = True End With Load Label1(1) With Label1(1) .Left = 98 .Top = 80 .Visible = True End With End Sub (5)label(1)が背面になります。
こんばんは！ テキストファイル内に何行かの文章があり、そのすべての文章に含まれる数値の合計を求めるVBSを記述したいのです。 例文↓ ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ 2014年11月12日 今日はダイソーで100円の商品を3つ購入した 明日は10時からテストがある ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ のような文章があったとき、2014,11,12,100,3,10の「和」を求めたいです。 自分の中では、配列とループ処理を用いて１文字ずつIsnumeric関数で判定していこうかなと考えていますが、他にスマートな方法はないでしょうか？ ただし、以下の条件があります。 １）個人情報を含む会社のPCなので、インターネットは接続できない ２）ソフトウェアのインストールはOfficeも含めて不可で、windowsの標準機能のみ使用可能
ACCESS VBAで DoCmd.TransferText acExportDelim, , "テーブル名", CSV_File_Full_Path でCSVファイルのエクスポートを行っていますが、 エクスポートするテーブルの任意の複数項目でソートして出力する方法はあるのでしょうか？ 現在はテーブルの表示順と異なった出力がされています。
会社で、GPIB、I/O、ActiveXコンポーネントの環境下で、 VB6のプログラムを使用して試験評価を行っているのですが、 VB6のコードを変更するにあたり、うまくいきません。 どなたかご教授願います。 内容は、 コードを変更したいので、元々の.vbpを開くと、 まず、「オブジェクトライブラリは登録されていません」とエラーが出ます。 その後、「プロジェクトのロードを続けますか？」となるので、OKを押します。 すると、「読み込み中にエラーが発生しました。・・・.logを参照してください」と出ます。 気にせず、OKを押し、コードの内容を変更したあと（※変更しなくても）、 プロジェクトの上書き保存をしたあと、.exeの作成（上書き）をすると、 また、「読み込み中にエラーが発生しました。・・・.logを参照してください」と出ます。 気にせず、OKを押し、作成した.exeを開くと、変更した内容になっていますが、 いざ、実行すると、「実行時エラー”１３”　型が一致しません」とエラーが出ます。 .logの内容を確認すると、”クラス・・・がロードされていません”とか、 ”プロパティ名・・・が不正です”とか表示されています。 試験する上で、使用しやすいようにVB6のコードを変更したいのですが、 試験で使用しているPCで元々のコードを変更しようとすると、上記のようなエラーが出ます。 どなたか、解決方法を教えてください。
http://officetanaka.net/excel/vba/filesystemobje … このページにファイル名から、拡張子やドライブ名などを出力する方法が書かれていますが ファイルが入っているフォルダ名を取得するコマンドはございますでしょうか？ 例えば、 C:\xxxx\yyyy.txt の場合、 C:\xxxx\ を取得したいのですが、コマンドはありますか？
Excelやwordでは Ctrl+yキーに、Ctrl+zキーのやり直しが割り当てられていますが、 Excel VBAでは http://span.jp/office2010_manual/excel_vba/refer … 行の削除が割り当てられています。 これをExcelやwordと同様に「やり直し」操作を割り当てたいのですが どのようにすれば良いですか？ あるいは、他のショートカットキーに「やり直し」操作はありますでしょうか？
VB2013 expressです。 VBで作成したフォーム上にファイルをD&Dすることで フルパス名を取得するプログラムを書きたいのですが http://dobon.net/vb/dotnet/control/droppedfile.h … このページにのように、テキストボックス上に D&Dすればうまくいくものは見つかったのですが、 フォーム全体で受け付けてくれるものが見つかりません。 どのように改良すれば良いか教えてください。
VBSを使ってプログラムを作りたいのですが、 visual studioを使ったデバッグの方法について教えてください。 バージョンはvisual studio express 2013で最新バージョンです。 OSはwin8 64bitです。 ・とりあえず、 http://winscript.s41.xrea.com/wiki/index.php?%5B … のページにあるように、 タイトル VBSスクリプトの実行(&R) コマンド C:\WINDOWS\system32\wscript.exe 引数 $(ItemPath?) を外部ツールに登録した上で MsgBox "テスト" と書かれた適当なvbsファイルをD&Dで読み込ませてみたのですが コードの色分けが行われておらず全て同じ色になっています。 http://www.koutou-software.co.jp/junk/use-vs-pro … このページのようにdimなどを青色に表示するにはどうしたら良いですか？ ・MsgBox "テスト"の左横にブレイクポイントの赤い丸を付けて VBSスクリプトの実行をしたのですが、 特にプログラムを停止することなく実行されてしまうのですが どうすれば指定した位置でプログラムを止めることができますか？ ・あとEXEファイルとして出力したいのですが ビルド機能が見つからないのですがどうすれば良いですか？ ・http://www.koutou-software.co.jp/junk/use-vs-pro … このページには Visual C++としてプロジェクトを作成し、いろいろな設定を行った後にするみたいな解説がありますが この通りやっても、wscript.exeが見つからないというようなエラーが出て 実行することができませんでした。 少し質問が多いですが よろしくお願いいたします。
ｖｂ６にて、元々のコードの内容を変更して、 プロジェクトの上書き保存をした後、 上書きの内容のexeを作成しようとすると、 「コンパイルエラー　：メソッドまたはデータメンバが見つかりません」とでます。 デバッグ開始ボタンで変更したコードが問題ないことは確認済です。 元々のコードの内容を変更せず、 exe作成で同じ名前で上書きをしようとしても上記のコンパイルエラーが表示されます。 なぜでしょうか？コンパイルエラーが出る理由をお教え願います。 GPIBやI/Oを使用しているのですが、測定機器につなげた状態で、 exe作成をしないとダメなのでしょうか？？？ 素人でよくわかりません。どなたかお教え願います。
http://oshiete.goo.ne.jp/qa/8809275.html このページでbmp画像をtiff圧縮する方法を教えていただきました。 このプログラムを改良して jpegやpng画像にも対応したプログラムを作ることはできないでしょうか？ 恐らく、 　　　CLSIDFromString StrPtr("{E09D739D-CCD4-44EE-8EBA-3FBF8BE4FC58}"), .Guid ' 圧縮方法 というところを書き換えれば、他の形式にも対応できると思うのですが、 CLSIDFromString　で検索しても、情報は見つかりませんでした。 どうか教えてください。
ユーザーフォームの背景だけを 完全に透明にすることは出来ますか？ 調べてみると他のコントロールも 透明になるコードが見つかりました。 もし背景だけというのが可能であれば 回答お願いします。
VBSを使って、 ファイルの更新日時プラス任意の時間をファイル名に書き込むプログラムを作ろうとしています。 zisa = 10 zikan = objFile.DateLastModified +zisa objFile.Name = Right("0" & CStr(Hour(zikan)), 2) & Right("0" & CStr(Minute(zikan)), 2) のようにして、変数zisaに任意の時間を代入して ファイル名を書き換えたいのですが、 objFile.DateLastModified　の　フォーマットが不明であるため 上記の方法では、うまくいきません。 zisa を10000とか適当な値にも変えてみましたが うまくいきませんでした。 objFile.Name = Right("0" & CStr(Hour(zikan)+zisa), 2) & Right("0" & CStr(Minute(zikan)), 2) とする方法だとうまくいきますが、 日付が変わってしまう場合には、うまくいきません。 どうすればうまくいきますでしょうか？
ＶＢ初心者です。 ＶＢ等でアクティブウィンドウのパスを取得する方法を探しています。 タイトルであればGetWindowTextで取得で可能ですし、 アプリケーションのパスであれば、 　http://sumishiro.blogspot.jp/2009/09/blog-post_3 …が参考になりました。　 しかしドキュメントファイルのパスを取得する方法がどうしてもわかりません。 例えば、ワードでtest.docxを開いているとき、そのウィンドウハンドルからwinword.exeのフルパスでなく、test.docxのフルパスを取得する方法です。（ワード、エクセル等だけでなく画像ビューアーが画像ファイルを開いているとき、その画像ファイルのフルパスの取得） どうぞよろしくお願いいたします。
こんにちは。 よろしくお願い致します。 在庫数が０になった時間をK列に表示したいのですが、うまく出来ません。 H列、I列、J列、K列を使います。 H列は自分で数字を入力しています。 I列はCOUNTIFで他のシートから数字を持ってきています。 J列には「H－I」の数式が入っています。 そしてK列にJ列の数字が０になった時の時間を表示したいです。 どうぞよろしくお願い致します。
お世話になります。 VBAでテキストボックスに日本語入力する為に、Validation.IMEmodeを活用しています。 このオブジェクト．プロパティで、エクセルを立ち上げた時に、WorkBook全体を自動的に日本語入力ONにしようと色々試みましたが実現出来ません。 教えて頂きたく宜しくお願いします。
エクセル マクロについて質問です。 現在，以下のような記述をエクセル上のボタンに登録しています。 ボタンを押すと，デスクトップ上の任意のCSVファイルの選択を行い，CSVファイルを選択し，そのCSVデータを全てエクセル上のデータとして落としさせたいと思っています。 しかし，csvファイルによっては， 「実行時エラー　 アプリケーション定義またはオブジェクト定義のエラーです。」と出て， 「デバック（D）」ボタンを押すと，下から４行目の 「Cells(i, j) = strCell」のところが，黄色くエラーとして表示されてしまいます。 下記の記述もネット上で皆さんに教えていただきながらなんとかやっているもので，正直自分自身でよく理解できていませんが，上記のようなエラーを回避する方法をどなたかご教示いただけないかと思います。 どうかよろしくお願いいたします。 Sub Macro5() Dim varFileName As Variant Dim intFree As Integer Dim strRec As String Dim strSplit() As String Dim i As Long, j As Long, k As Long Dim lngQuate As Long Dim strCell As String varFileName = Application.GetOpenFilename(FileFilter:="CSVファイル(*.csv),*.csv", _ Title:="CSVファイルの選択") If varFileName = False Then Exit Sub End If intFree = FreeFile '空番号を取得 Open varFileName For Input As #intFree 'CSVファィルをオープン i = 0 Do Until EOF(intFree) Line Input #intFree, strRec '1行読み込み i = i + 1 j = 0 lngQuate = 0 strCell = "" For k = 1 To Len(strRec) Select Case Mid(strRec, k, 1) Case "," '「"」が偶数なら区切り、奇数ならただの文字 If lngQuate Mod 2 = 0 Then Call PutCell(i, j, strCell, lngQuate) Else strCell = strCell & Mid(strRec, k, 1) End If Case """" '「"」のカウントをとる lngQuate = lngQuate + 1 strCell = strCell & Mid(strRec, k, 1) Case Else strCell = strCell & Mid(strRec, k, 1) End Select Next '最終列の処理 Call PutCell(i, j, strCell, lngQuate) Loop Close #intFree End Sub Sub PutCell(ByRef i As Long, ByRef j As Long, ByRef strCell As String, ByRef lngQuate As Long) j = j + 1 '「""」を「"」で置換 strCell = Replace(strCell, """""", """") '前後の「"」を削除 If Left(strCell, 1) = """" And Right(strCell, 1) = """" Then strCell = Mid(strCell, 2, Len(strCell) - 2) End If Cells(i, j) = strCell strCell = "" lngQuate = 0 End Sub
シート(A社)にはA社の株の変動の予測(A列にパターン1,2,3,4・・・、1行目に時間)、同じくシート(B社)にはB社の株の変動の予測パターンが入っています(添付画像参照)。 マクロを起動させると、シートResultのグラフのデータを削除して、新たにA社・B社のデータを追加させて新しいグラフを作るというようなマクロを作りたいです。 また、データの範囲(表の開始位置・シュミレーションの回数(縦)・時間(横))はその都度変わるので、絶対参照ではなく、変数で指定できるようにお願いします。 x軸の値を最小値=0，最大値=j(例だと30)というようにしたいです。 i=10 'シュミレーション回数 j=30　 '時間 k=cells(rows.count,1).end(xlup).row-i　 '表の左上 私のスキル不足で例では、凡例をA社1,A社2・・・B社10としていますが(添付画像参照)、1～10までを区別する必要がないので（むしろ邪魔）、赤線：A社・青：B社のような凡例(右)が付けられると嬉しいです。 50回,100回とシュミレーションの回数を増やしたときにVBAでないととても手に負えません。 よろしくおねがいします。
2009年頃の発行ですが「VBA for Professional Access VBA+SQL実践活用」のサンプルファイルを紛失してしまいました。マイコミから入手できませんでした。AccessVBAを読み直ししているところです。
例示の表データからテキスト（ＨＴＭＬ）ファイルを生成し、特定のフォルダヘ格納したい。 ファイル名はすべて　index.html　とする。 エクセルは2003 フォルダは作成ずみ デスクトップ＞zenkoku＞kanagawa＞kanagawa01＞kanagawa01A 分類方法については、 ・大分類：県ごと ・中分類：２０社ごと ・小分類：１社ごと テキストＨＴＭＬファイルの作成パターンは２つ パターン(1)　中分類のフォルダに格納 ・「会社名」と「住所」の２つの項目 ・２０社ごとにファイルを作成 ・ファイル名は　index.html パターン(2)　小分類のフォルダに格納 ・「会社名」「住所」「電話番号」の３つの項目 ・１社ごとにファイルを作成 ・ファイル名は　index.html
業務でマクロを使うことになり、ご教示お願い致します。 （例） 実行前　→実行後 C列　　　　 C列 001　　　　　001 003　　　　　001-1 002　　　　　001-2 005　　　　　002 001　　　　　002-2 001　　　　　003 002　　　　　005 同じ文字が複数ある場合、2個目以降には”-1”、”-2”と区別し、並べ替えを実行。 （データはA列～BI列まで入っていますので、C列が動いた場合、連動させる形で…。） ActiveWorkbook.Worksheets(BaseSheet).Activate p = HeaderPos + 1 For i = (HeaderPos + 1) To SearchNum CelValue = Range(Inbound & i).Value For m = 0 To SearchNum If KindType(m) = CelValue Then KindCount(m) = KindCount(m) + 1 Range(Inbound & i).Value = KindType(m) + CStr(KindCount(m)) Exit For ElseIf KindType(m) = "" Then KindType(m) = CelValue KindCount(m) = KindCount(m) + 1 Range(Inbound & i).Value = KindType(m) + CStr(KindCount(m)) Exit For End If Next If CelValue = "" Then Exit For End If Next イメージはこんな感じなのですが、お分かりになる方よろしくお願いいたします。
こんにちは。 マクロで下記作業をしたくて悩んでいます。 【Aブック　シートa　A列】 ↓ A列の前6文字を ↓ 【Bブック　シートb　B列】へ貼付け A列が空欄になれば処理は終了 MIDを使って作っていたのですが、別ブックへの貼付けが組めません…。 検索をしても丁度参考になるものが見つけられませんでした。 詳しい方、ご教示頂けませんでしょうか？ よろしくお願いいたします。
マクロ初心者です。 Sheet1のＡ１からＣ３に入力されているデータがあります。 それを別のブック（集計）のＳheet1のA２からＣ４へ値のみコピーを行いたいと思っています。 ２回目以降は、Sheet1のＡ１からＣ３のデータをＡ５からＣ７というように前回コピーした内容に上書きしないように連続してコピーを行いたいのですがそのようなことは可能でしょうか。 マクロで実行したいです。 ご教授よろしくお願いいたします。
動作環境 OS:Windows7(64Bit) Home Premium SP1 MS:Office Version2007 SP3 Excel図形内のテキスト編集で、マウスをドラッグしてテキストの領域を選択後、コンテキスト メニューから、フォント(F)－フォント(設定ダイアログ)画面－[文字幅と間隔]タブ上に、間隔と幅が、 あります(画像参照)。 テキスト設定した場合、vba上から文字間隔と幅を取得する方法が、知りたいです。 それと、カーニングもついでに、取得する方法が、知りたいです。 大体、目途は、付いています。 どなたか、ご指導願います。 ■現在、自分が、分かっている文字間隔と幅を取得するPG(URL参照) http://detail.chiebukuro.yahoo.co.jp/qa/question … 下記の方法ですと、MsgBoxで、[文字間隔を広げる]設定値が取得されます。 For Each wkbWorksheets In ActiveWorkbook.Worksheets For Each wksShapes In wkbWorksheets.Shapes With wksShapes.TextFrame2.TextRange.Characters MsgBox .Font.Spacing End With Next wksShapes Next wkbWorksheets ※[標準]、[文字間隔をつめる]、[カーニング]で、vbaから設定値を取得するには？
お世話になります。 マクロを作成するのに、If～Thenを使用したいのですが上手く使えません。 ＜例＞ A列に文字・数字が入っているとき→B列に”い”、C列に”う”、D列に”え”と反映させる。 A列が空白のセルになったら→その行はすべて空白にする。 行数は５０行程度の予定です。 　　　　A　　　　　　B　　　　　　C　　　　　　D １　　　あ　　　　　い　　　　　　う　　　　　　え ２　　　空白　　　空白　　　　　空白　　　　空白 ３　　　あ　　　　　い　　　　　　う　　　　　　え ４　　　空白　　　空白　　　　　空白　　　　空白 ---------------------------------------------------------- 数値に対して一致・大小等の条件であれば、問題なく作成できたのですが…。 私の探し方が悪いのだとは思いますが、 セルが空白か否かを判断して文字を反映させる、というのが見つけられませんでした。 関数を使えば簡単なのは承知しておりますが、その他の処理をすべてマクロで作成したので、 できれば統一させてしまいたい…と思っています。 初心者用の本を見ながら作成している初心者ですが、何卒ご教示頂けませんでしょうか？ よろしくお願いいたします。
VBAを使って、bmp画像をtiff圧縮するプログラムを教えてください。 検索すると http://oshiete.goo.ne.jp/qa/8508126.html 画像圧縮、変換用のライブラリ　を使えば良いという回答ページは見つかったのですが 具体的な方法が分かりません。 「画像 dll vba　tif bmp」などで検索してみても分かりませんでしたので 教えてください。
株価グラフを、セル範囲に合わせて横に３個並べて表示させています。 同時に凡例非表示などの条件を設定していますが 　１．ローソクの幅（太さ）を広くしたい 　２．背景を着色したい この２つの設定が出来ません。何回か挑戦しましたがエラーの壁にはじき飛ばされて 困っています。是非、教えて下さい。 (Win7、エクセル2010) For I = 1 To 3 With ActiveSheet.ChartObjects.Add(Left:=Cells((I - 1) * 4 + 1).Left, _ Top:=Cells(3, 1).Top, Width:=xSize(2), Height:=ySize(2)) With .Chart .SetSourceData Source:=GFDB(4, I), PlotBy:=xlColumns .ChartType = xlStockOHLC '-------------株価グラフ .HasLegend = False '---------------------凡例非表示 .HasAxis(xlValue) = False '-------------Y軸（数値軸）非表示 .HasAxis(xlCategory) = False '---------X軸（項目軸）非表示 End With End With Next I
　excelのマクロは少しかじっていますが、word　vbaは全くの初心者です。宜しくお願いします。 　例えば、下のように、似かよった文面が複数行ある文書で 　 　[8:50:31] qqe-CF: The building where Q-ty’s friend lives is very old. 　[8:50:53] qqe-CF: The town where my father grew up is small. 　[8:51:40 | 8:52:14] qqe-CF: That is the school where Q-rex teaches. 　[8:52:44] qqe-CF: That is the room where I keep my books. 　[8:53:59 | 8:54:14] qqe-CF: This is a picture of the place where we are going for our holidays. 　[8:54:33] qqe-CF: This is the place where I fell off my bike. 　[8:54:52] qqe-CF: That is the place where we stayed for our honeymoon. ↑ここの左端から半角10文字目から始まる、半角10文字で、それが数字の場合（3行目の「 8:52:14」など）のみを、指定した複数行に渡り、数字か文字かを判別しながら自動で繰り返し削除するＶＢＡマクロのプログラムを教えて下さい。 　質問内容のまとめ 　１．各行の、左端から半角10文字目から始まる半角10文字を削除対象とする。 　２．数字のみを削除対象とし、文字はスルーする。 　３．操作範囲行を指定できるようにする。１行から１000行の範囲で。 　 　実際には、１０００行以上の文書です。よろしくお願いします
VB6で1をA、2をB、3をC・・・・に変換したいのですが、 そのような関数はありますでしょうか? 小文字から大文字に変換するUCase関数みたいなのがあると 嬉しいのですが。 逆のAを1、Bを2、Cを3・・・でも良いです。
ACCESS（VBA）の検索処理にて 以下のVBAを実行すると、かならず「★データあり処理」 に流れてしまいます。 確実に検索結果がヒットしない状態（データ全削除）にしても 同じです。 何故なのでしょうか。。 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Private Sub xx_Click() Dim sSql As String sSql = "SELECT 年月 FROM 材料明細トランザクション " _ & "WHERE 年月 = " & Me.年月.Value & " " _ & "AND 材料顧客コード = " & Me.材料顧客コード.Value & " " _ & "AND 現場コード = " & Me.現場コード.Value Set db = CurrentDb Set oRs = db.OpenRecordset(sSql) If oRs.NoMatch = False Then '★データあり処理 Else 'データなし処理 End If End Sub ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ ※初心者ですので、わかりやすく回答していただけると助かります。
シート内に複数のグラフを表示させていますが、セル範囲から微妙にズレてしまい、 セルに記載した説明文との間隔がバラバラになってしまい、体裁が悪く困っています。 なんとか、セル範囲（行６，列４）に合わせてグラフを作成する方法を教えて下さい。 （エクセル2010） For I = 1 To 4 For J = 1 To 4 LA = LA + 1 ActiveSheet.ChartObjects.Add(J * 183 - 182, I * 2 * 123 - 225, 183, 105).Select ActiveChart.ChartType = xlLine ActiveChart.SetSourceData Source:=GFDT(LA), PlotBy:=xlColumns ActiveChart.Parent.Name = "GF" & LA Next J Next I
VBAを使用してWebサイトにログインを行いたいのですが、ログインをする際に必ず新規セッションでウィンドウを起動してログインするようにするにはどのようなコードを組めばいいのでしょうか？ 申し訳ありませんがどなたかご教授願います。
作成してあるフォルダの中にテキストファイル(html)を格納する事は可能でしょうか。 フォルダはすでに作成してあります。 デスクトップ＞zenkoku＞kanagawa＞kanagawa01＞kanagawa01A ファイル名はすべて　index.html 　 (1)「kanagawa02」フォルダには　会社名と住所とF列の値（20社分） 　 →20社ごとに01、02、03　となっています。 (2)「kanagawa02A」フォルダには　会社名と住所と電話番号（1社分のみ） ※以下は　会社と住所のHTMLファイル（(1)の例）です。 <!DOCTYPE html> <html lang="en"> <body> <div class="span3" id="sidebar"> 　　<div class="widget"> 　　<h4 class="widgetTitle">ＨＨＨ病院</h4> 　　<ul><li>神奈川県横浜市</li> 　　<li>kanagawa02A</li></ul></div> 　　<div class="widget"> 　　<h4 class="widgetTitle">株式会社ＩＩＩ</h4> 　　<ul><li>神奈川県横浜市</li> 　　<li>kanagawa02B</li></ul></div> 　　（２０社分） </div> </body> </html> ※以下は　会社と住所と電話番号のHTMLファイル（(2)の例）です。 <!DOCTYPE html> <html lang="en"> <body> <div class="span3" id="sidebar"> 　　<div class="widget"> 　　<h4 class="widgetTitle">ＨＨＨ病院</h4> 　　<ul><li>神奈川県横浜市</li> 　　<li>電話番号</li></ul></div> </div> </body> </html>
背面画像Aと前面画像Bがあります。 画像Bは画像A上をファイルから読み込んだ X,YのLocationを任意に移動します。 Bの画像の白色の部分を透過にして、背面の画像Bが見えるように 表示したいのですが、うまくいきません。 PictureBoxコントロールのimageプロパティに 画像Bを設定して、backColorにTransparentを指定しても 親コントロール(画像Bを表示しているPictureBox)の BackColorで表示されるだけでした。 vb6だとimageコントロールを使用すればできました。 vb.netで何か良い方法はないでしょうか？
動作環境 OS:Windows7(64Bit) Home Premium SP1 MS:Office Version2007 SP3 下記のURLを参考にして、色の設定ダイアログ画面を出力させました。 ところが、この画面、モーダレス出力をモーダル出力にさせたいのですが、 方法が分かりません。 ちなみに、Excelのvbaで、試しています。 どなたか、ご指導願います。 ■色の設定ダイアログ画面(URL) http://www.tsware.jp/tips/tips_343.htm
会社の一覧があるのですが企業数が増えてきたのでフォルダを作成して分類しようと考えています。 一覧表には「県ごと」「２０社ごと」「１社ごと」にコードが割り振られています。 以下のようなフォルダの構成にしたいのですが、ＶＢＡによって自動的にフォルダ作成することは可能でしょうか。 zenkoku > hokkaido 　　　　　　　miyagi 　　　　　　　chiba 　　　　　　　mie 　　　　　　　kanagawa > kanagawa01 > kanagawa01A 　　　　　　　　　　・　　　　kanagawa02 > kanagawa02A 　　　　　　　　　　・　　　　　　　・　　　　　kanagawa02B 　　　　　　　　　　・ 　　　　　　　　　　・ １県あたりに20社以上ある場合は、kanagawa01、kanagawa02　となっています。 元のエクセルのデータがソートされてもＯＫです。 　　　　　 　　　　　　 　　　　　　 　　　　　　
動作環境 OS:Windows7(64Bit) Home Premium SP1 MS:Office Version2007 SP3 Excel図形内のテキストの編集で、マウスをドラッグしてテキストの領域を選択後、コンテキスト メニューから、フォント(F)－フォント(設定ダイアログ)画面－[フォント]タブ上に、下線のスタイルが、 複数あります。 テキスト設定した場合、vba上から下線のスタイルを取得する方法が、知りたいです。 大体、目途は、付いています。 どなたか、ご指導願います。 ■現在、自分が、分かっている下線のスタイルを取得するPG 下記の方法ですと、MsgBoxで、.Font.Underline=2が取得されます。 For Each wkbWorksheets In ActiveWorkbook.Worksheets For Each wksShapes In wkbWorksheets.Shapes With wksShapes.TextFrame.Characters MsgBox .Font.Underline End With Next wksShapes Next wkbWorksheets ※「1.」～「16.」で、下線のスタイルをvbaから取得するには？ 1.一重線 2.二重線 3.太線 4.点線 5.太点線 6.破線 7.太破線 8.長破線 9.長太破線 10.一点破線 11.太一点破線 12.二点破線 13.太二点破線 14.波線 15.太波線 16.二重波線
いつもお世話になっております。 早速ですが、VB2013Expressを使用しソフトを組んでいます。 組んだソフトをWin8.1がインストールされているタブレットで使用するつもりです。 そこで質問なのですが、フォームにパネルを配置しスクロールバーを表示させます。 そのスクロールを指で行いたいと思っております。 VB2013の標準機能で実行可能なのでしょうか。 宜しくお願い致します。
エクセルのマクロを使って、自動的にセルの内容をオブジェクト(図形）に入れていきたいです。 (オブジェクトは随時新規作成） 例えば、セルのA1からA3に、”あ”、”い”、”う”が記入してあるとすると、 図形が3個作成されて、図形にはそれぞれ文字が記入されている。 という感じに作りたいのですが、できますか？ 誰か教えてください＞＜
動作環境 OS:Windows7(64Bit) Home Premium SP1 MS:Office Version2007 SP3 Excel図形内のテキストの編集で、マウスをドラッグしてテキストの領域を選択後、コンテキスト メニューから、フォント(F)－フォント(設定ダイアログ)画面－[フォント]タブ上に、下線のスタイルが、 複数あります。 訳が合って、この各下線の表意定数を、知りたいのです。 大体、目途は、付いています。 どなたか、ご指導願います。 ■各下線の表意定数 括弧内の?を、ｘｌ～のように知りたいです。 後、クエスチョン以外も、間違っている場合、教えて下さい。 1.一重線(xlSingle) 2.二重線(xlDouble) 3.太線(xlMedium) 4.点線(xlDot) 5.太点線(?) 6.破線(xlDash) 7.太破線(?) 8.長破線(?) 9.長太破線(?) 10.一点破線(xlDashDot) 11.太一点破線(?) 12.二点破線(xlDashDotDot) 13.太二点破線(?) 14.波線(?) 15.太波線(?) 16.二重波線(?)
数日前に"Locationができなくなりました"というタイトルで質問させて頂きました。 内容に誤りがありましたので、再度質問させて頂きます。 実はVB2008でExcelを使用するわりと大きなプログラム「ブリッジ」を作成中です。Excelの操作を勉強するため、練習用のプロフラム「Excel練習」を作成し、ここでExcelの操作を勉強しました。 この「練習用プログラム」ではExcelの参照設定を行い、Importもし、皆様の助けを頂きながらなんとか完成することが出来ました。ちなみに”Excelの参照設定”、”Import”の内容は Excelの参照設定：Imports Microsoft.Office.Interop.Excel Import記述内容：Imports Microsoft.Office.Interop です、そこでこの内容を「ブリッジ」に移植した所問題が発生しました。「ブリッジ」では。Excelに関する宣言で「Application'は名前空間'Microsoft.Office.Interop.Excel'では不適切です」とエラーメッセージが表示されます。下記がその例です。 　　Dim oXls As Excel.Application：Excel.Applicationにエラー ところが”Import”の記述内容を　　 Imports Microsoft.Office.Interop.Excel　　：.Excelを追加 とすると、Excelに関する宣言でのエラーが無くなる代わりにLocatinをしようとしたところ で Label14.Location = New Point(350, 100)　：Pointに「Pointは、名前空間Microsoft.Office.Interop.Excelでは不適切です」とエラーメッセージが表示されます。 全くの初心者なのでエラーの原因が全く判りません。ご教示のほどよろしくお願い致します。
本日エクセルVBAエキスパートのスタンダードを取得いたしました。 仕事で半年ほどVBAをチョコチョコ使う機会があったので、 最初のうちはWEBで調べてコードを切り張りして 簡単なツールを作っておりました。 それで９月のはじめに折角だし資格を取ろうと思い 現在に至っております。 転職を考えており、もう少しプログラムを勉強しようと思っています。 次はVB.NETかC#をと考えているんですが、 どちらがいいでしょうか。 個人的な目標としてはWINDOWSのPC上でGUIで動く ヤフオクの出品ツールが作れるぐらいを考えています。 それでご相談なのですが、VBとVB.NETはかなり違うとのことですが VBAを学んでいるとC＃に比べVB.NETは多少は習得し易いでしょうか。 VBAが習得の上で何のアドバンテージにもならないのであれば、 人気のC#にしようかと思っています。 ちなみに今の職場にいる限りVBA以外のプログラムをする機会はありません。 恐れ入りますが回答をお願いいたします。
excel　vbaで次のようなコードを作りたいです。 シート1に元データが4000件ほどあります。 シート2に、シート1のidが同じものを、3行ずつ横に表示したいです。 idと名前は1度のみ、それ以降は都道府県名と数字のみ表示します。 同じidを持つものが3行に満たないのであれば、改行します。 同じidを持つものが3行以上ある場合は、3行ごとに改行します。 1　佐藤　東京　1000 1　佐藤　千葉　2100 1　佐藤　青森　1300 2　鈴木　東京　5600 2　鈴木　千葉　3500 3　山田　三重　2910 3　山田　長野　3820 3　山田　山口　8760 3　山田　沖縄　6560 4 ： ↓ 1　佐藤　東京　1000　千葉　2100　青森　1300 2　鈴木　東京　5600　千葉　3500 3　山田　三重　2910　長野　3820　山口　8760 3　山田　沖縄　6560 4 ： どなたかこのような動作を行うvbaのコードを教えてください。 よろしくお願いします。
住所録を分類（大中小の３つ）して、それぞれの名前でファイルを作成しています。 旧）中分類のファイル名で「chu」フォルダ内にＨＴＭＬファイルを作成 　　小分類のファイル名で「sho」フォルダ内にＨＴＭＬファイルを作成 これを以下のように改変したいと思っております。 新）大分類の名前のフォルダを作成して、 　　そのフォルダの中に該当する分だけの「中分類のファイル」を作成 　　同じフォルダの中に該当する分だけの「小分類のファイル」を作成 当方まったくの初心者なので、手も足も出ませんでした。 どうかご教授よろしくお願いいたします。 Sub 中分類HTMLソース() Dim fso As Object 'ファイルシステムオブジェクト Dim strPath As String '削除対象ファイル Set fso = CreateObject("Scripting.FileSystemObject") strPath = Environ("USERPROFILE") & "\Desktop\chu\*.*" fso.DeleteFile strPath, True Set fso = Nothing 'ファイルの削除（読み取り専用の場合も削除） Dim myPath As String Dim i As Long myPath = Environ("USERPROFILE") & "\Desktop\chu\" Range("A:I").Sort Key1:=Range("H2"), Header:=xlYes, MatchCase:=False, _ Orientation:=xlTopToBottom For i = 2 To Range("H1").End(xlDown).Row If Range("H" & i).Text <> Range("H" & i - 1).Text Then Open myPath & Range("H" & i).Text & ".html" For Output As #1 Print #1, "<!DOCTYPE html>" & vbNewLine _ & "<html lang=""en"">" & vbNewLine _ & "<body>" & vbNewLine _ & "<div class=""span3"" id=""sidebar"">" & vbNewLine End If Print #1, "<div class=""widget"">" & vbNewLine _ & "<h4 class=""widgetTitle"">" & Range("A" & i).Text & "</h4>" & vbNewLine _ & "<ul><li>" & Range("B" & i).Text & "</li>" & vbNewLine _ & "<li><a href=""/sho/" & Range("I" & i).Text & ".html"">連絡先・地図はこちら</a></li></ul></div>" & vbNewLine If Range("H" & i).Text <> Range("H" & i + 1).Text Then Print #1, "</div>" & vbNewLine & "</body>" & vbNewLine & "</html>" Close #1 End If Next End Sub Sub 小分類HTMLソース() Dim fso As Object 'ファイルシステムオブジェクト Dim strPath As String '削除対象ファイル Set fso = CreateObject("Scripting.FileSystemObject") strPath = Environ("USERPROFILE") & "\Desktop\sho\*.*" fso.DeleteFile strPath, True Set fso = Nothing 'ファイルの削除（読み取り専用の場合も削除） Dim myPath As String Dim i As Long myPath = Environ("USERPROFILE") & "\Desktop\sho\" Range("A:I").Sort Key1:=Range("I2"), Header:=xlYes, MatchCase:=False, _ Orientation:=xlTopToBottom For i = 2 To Range("I1").End(xlDown).Row If Range("I" & i).Text <> Range("I" & i - 1).Text Then Open myPath & Range("I" & i).Text & ".html" For Output As #1 Print #1, "<!DOCTYPE html>" & vbNewLine _ & "<html lang=""en"">" & vbNewLine _ & "<body>" & vbNewLine _ & "<div class=""span3"" id=""sidebar"">" & vbNewLine End If Print #1, "<div class=""widget"">" & vbNewLine _ & "<h4 class=""widgetTitle"">" & Range("A" & i).Text & "</h4>" & vbNewLine _ & "<ul><li>" & Range("B" & i).Text & "</li>" & vbNewLine _ & "<li>" & Range("C" & i).Text & "</li>" & vbNewLine _ & "<li>" & Range("D" & i).Text & "</li>" & vbNewLine _ & "<li>" & Range("E" & i).Text & "</li></ul></div>" & vbNewLine If Range("I" & i).Text <> Range("I" & i + 1).Text Then Print #1, "</div>" & vbNewLine & "</body>" & vbNewLine & "</html>" Close #1 End If Next End Sub
たびたびお世話になっております、VBA初心者です。 同じ形式の複数のエクセルBOOKに入っている特定の列の特定の行範囲にあるデータを、 別の集計用エクセルBOOKの単一のシートの中に順々にコピーをしていきたいのです。 集計用BOOKの特定の行には、データBOOKのBOOK名が横にずらっと記載されて おり、集計用BOOKに組んだVBAでBOOK名を読み取り、そのBOOK名のデータBOOKを 開き、特定セル範囲（A2:A1000）の値をコピーし、集計用BOOKのBOOK名が記載されて いる列に貼り付けしていく。同様に、集計用BOOKの右どなりの列に記載されている BOOK名を読み取り、そのBOOKを開き．．．と継続し、集計用BOOKにデータ用BOOK 名が記載されていない列まできたら、Do Whileステートメントを終了する、ということ をやりたいのです。 ＜問題点＞ 集計用BOOKに記載のあるデータ用BOOK名のBOOK自体が存在しないものがあるのです。存在しない場合は無視して次に進んで行ってほしいのですが、「ファイルが見つかりません」とメッセージが出て先に進まないのです。IFとTHENを使ってやってみたのですが、IFの中の構文の作り方がよくわからず、なにかうまい方法はありましたら教えて頂きたいのですが。 ＜プログラム＞ Sub W() Dim ファイル名 As String Dim 列番号 As Long 列番号 = 4 Do While Cells(2, 列番号).Value <> "" ファイル名 = Cells(2, 列番号).Value Workbooks.Open "D:\学校\データ\" & ファイル名 & ".xlsx" Range("A2:A1000").Copy Application.DisplayAlerts = False ActiveWorkbook.Close ThisWorkbook.Activate ActiveSheet.Paste Cells(5, 列番号) 列番号 = 列番号 + 1 Loop End Sub よろしくお願いいたします！
よろしくお願いいたします。 下記をやろうとした際、「クリップボードに大きな情報があり．．．．．」なる メッセージが都度出てしまい、次に進みません。 これを回避する方法を教えて頂きたいのですが。 ＜やりたいこと＞ 同じ形式の複数のエクセルBOOKに入っている特定の列の特定の行範囲にあるデータを、 別の集計用エクセルBOOKの単一のシートの中に順々にコピーをしていきたいのです。 集計用BOOKの特定の行には、データBOOKのBOOK名が横にずらっと記載されて おり、集計用BOOKに組んだVBAでBOOK名を読み取り、そのBOOK名のデータBOOKを 開き、特定セル範囲（A2:A5）の値をコピーし、集計用BOOKのBOOK名が記載されて いる列に貼り付けしていく。同様に、集計用BOOKの右どなりの列に記載されている BOOK名を読み取り、そのBOOKを開き．．．と継続し、集計用BOOKにデータ用BOOK 名が記載されていない列まできたら、Do Whileステートメントを終了する、ということ をやりたいのです。 ＜問題点＞ 実行させると、「修飾子が不正です」なるメッセージが出てしまい 先に進まないのです。 ＜プログラム＞ Sub W() Dim ファイル名 As String Dim 列番号 As Long 列番号 = 4 Do While Cells(2, 列番号).Value <> "" ファイル名 = Cells(2, 列番号).Value Workbooks.Open "D:\学校\データ\" & ファイル名 & ".xlsx" Range("A2:A1000").Copy ThisWorkbook.Activate ActiveSheet.Paste Cells(5, 列番号) ファイル名.Activate Workbook.Application.CutCopyMode = False ActiveWorkbook.Close 列番号 = 列番号 + 1 Loop End Sub ＜エラー発生部分＞ ファイル名.Activate ＜補足＞ 「ファイル名.Activate Workbook.Application.CutCopyMode = False」 という部分はもともとなかったのですが、データが入っているBOOKを閉じる際 「クリップボードに大きな情報があります。この情報．．．」なるメッセージが 出てしまったため、回避策として追加修正したものです。 すみませんお手数ですが、よろしくお願いいたします。
業務にて、選択した範囲の名前のシートを作成し、 なおかつその内容は「マスタ」というシートをコピーする。というマクロを作ったのですが、うまくいきません。 名前のシートを作成するのみならばうまくいくのですが、内容をコピーしようとすると、逆順になり、空白のシートが挿入されます。 最終的には降順（名称にはNo.があります）になり、空白のシートが挿入されないようにしたいです どうしたらうまくいくのでしょうか？ ==== Sub 連続シート作成() For Each 対象セル In Selection Sheets.Add After:=ActiveSheet Sheets("マスタ").Copy After:=Sheets("マスタ") ActiveSheet.Name = 対象セル.Value Next 対象セル End Sub
今折れ線グラフを作成しています。 データの範囲設定で悩んでいます。 項目軸ラベルのセル範囲と、グラフデータのセル範囲を指定を以下のように設定し折れ線グラフを作成しました。 Set RngData = Union(Wb3Sh6.Range(Cells(範囲1, 1), Cells(範囲2 - 1, 1)), _ 　　　　　　　　　　　　Wb3Sh6.Range(Cells(範囲1, 12), Cells(範囲2 - 1, 12)), _ 　　　　　　　　　　　　 Wb3Sh6.Range(Cells(範囲1, 18), Cells(範囲2 - 1, 18)), _ 　　　　　　　　　　　　 Wb3Sh6.Range(Cells(範囲1, 33), Cells(範囲2 - 1, 33)), _ 　　　　　　　　　　　　Wb3Sh6.Range(Cells(範囲1, 34), Cells(範囲2 - 1, 34)), _ 　　　　　　　　　　　　Wb3Sh6.Range(Cells(範囲1, 39), Cells(範囲2 - 1, 39)), _ 　　　　　　　　　　　　Wb3Sh6.Range(Cells(範囲1, 40), Cells(範囲2 - 1, 40))) ActiveChart.SetSourceData Source:=RngData, PlotBy:=xlColumns ですが。 項目軸を「Wb3Sh6.Range(Cells(範囲1, 12), Cells(範囲2 - 1, 12)), 」 のみとしたいのに 項目軸が「Wb3Sh6.Range(Cells(範囲1, 1), Cells(範囲2 - 1, 1)), _ 　　　　　　　　　　　　Wb3Sh6.Range(Cells(範囲1, 12), Cells(範囲2 - 1, 12)), _ 　　　　　　　　　　　　 Wb3Sh6.Range(Cells(範囲1, 18), Cells(範囲2 - 1, 18)), _ 　　　　　　　　　　　　 Wb3Sh6.Range(Cells(範囲1, 33), Cells(範囲2 - 1, 33)), _ 　　　　　　　　　　　　Wb3Sh6.Range(Cells(範囲1, 34), Cells(範囲2 - 1, 34)), _ 　　　　　　　　　　　　Wb3Sh6.Range(Cells(範囲1, 39), Cells(範囲2 - 1, 39)), _」 となってしまいます。 項目軸を確実に設定したいのですが、どうすればよいでしょうか。
ひとつのエクセルに　BOOK1,2　を　起こして BOOK1　から　BOOK2　の　自作フォームの　テキストに　値は　送り込めないのでしょうか？ シートのセルと　ボタンは　可能なのですが・・・ Workbooks("Book2.xlsm").Worksheets("Sheet1").Range("A1:a4").Copy Workbooks("test.xlsm").Worksheets("Sheet2").Range("A1:a4").PasteSpecial Workbooks("test.xlsm").Worksheets("Sheet2").opb2.Value = True フォームには何か書き方が有るのでしょうか
VBA初心者です。 VBAで作成したプログラムがエラーで止まってしまい、先に進まないのです。 わかる方いらっしゃいましたら、ご教示頂けないでしょうか。 ＜やりたいこと＞ 同じ形式の複数のエクセルBOOKに入っている特定の列の特定の行範囲にあるデータを、 別の集計用エクセルBOOKの単一のシートの中に順々にコピーをしていきたいのです。 集計用BOOKの特定の行には、データBOOKのBOOK名が横にずらっと記載されて おり、集計用BOOKに組んだVBAでBOOK名を読み取り、そのBOOK名のデータBOOKを 開き、特定セル範囲（A2:A5）の値をコピーし、集計用BOOKのBOOK名が記載されて いる列に貼り付けしていく。同様に、集計用BOOKの右どなりの列に記載されている BOOK名を読み取り、そのBOOKを開き．．．と継続し、集計用BOOKにデータ用BOOK 名が記載されていない列まできたら、Do Whileステートメントを終了する、ということ をやりたいのです。 ＜問題点＞ 実行させると、「実行時エラー'1004' 'Range'メソッドは失敗しました :'Global'オブジェクト」なるメッセージが出て、先に進まないのです。 ＜プログラム＞ Sub W() Dim ファイル名 As String Dim 列番号 As String 列番号 = c Do While Range(列番号 & "5").Value <> "" ファイル名 = Range(列番号 & "5").Value Workbooks.Open "D:\学校\データ\" & ファイル名 & ".xlsx" Range("A2:A5").Copy ActiveWorkbook.Close ThisWorkbook.Activate ActiveSheet.Paste Range(列番号 & "6") 列番号 = 列番号 + 1 Loop End Sub ＜エラー発生部分＞ Do While Range(列番号 & "5").Value <> "" ＜補足＞ ちなみに、VBAの組んであるBOOKは「学校」フォルダの中、データが入っている BOOKは「データ」フォルダの中に格納されています。 以上お手数をおかけしますが、よろしくお願いいたします。
現在vb.netで接続されたデバイスの状態変更操作を行うアプリを作成しています。 デバイスの状態変更はdevcon.exeをvb.net上で呼び出しそこで行っているのですが、デバイスそれぞれの状態を変更したいと考えています。 現時点では、devcon.exe上でUSB*を使用してデバイスのすべてを状態変更しているのですが、これを実行するとマウスやキーボードなども変更されてしまい困っています。 そこでvb.net　上でハードウェアIDを取得し、その取得したハードウェアIDのデバイスのみ、状態変更ができればいいと思っています。 しかし、vb.net上で取得したハードウェアIDを変数に格納し、その格納された変数をdevcon上で使用方法がわかりません。 わかる方がいらしたらご教示していただけると幸いです。 また、上記の方法ではなく他の方法がわかる方がいらしたご教示していただきたいと思います。
独学で手さぐりしながら学んでいますが、どうしてもうまくいかず。 アドバイス頂けないでしょうか？ (1)を毎回元にして、出荷指示を作成していき、入力後保存ボタンをおすと(2)の別シートに自動転記して 月々のリストを作成していきたいのです。 知っているマクロでやろうとすると、同じデータシートに(2)がある為、(1)を開くたびにデータが消えてしまい溜まっていきません。効率の良いやり方と、もし可能であれば実現できるモジュールコード教えて頂けないでしょうか？
エクセルで作成した住所録があります。 数が増えてきたのでコードで分類したいと考えています。 現在の住所録には「大分類」のＣ列まで入力されています。 ここからＶＢＡによって、 「中分類」と「小分類」を入力したいと思います。 ＊中分類は末尾に２ケタの数字を追加（２０ごとに　01、02、03　とする。） ＊小分類は末尾に１ケタの英字を追加（１つごとに　A、B、C　とする） どうかよろしくお願いいたします。
VB2008でExcel（.xls）のセルデータを読み込もうと思い、ネットにあるものを試しましたが、全くよみこめません。列と行を整数型変数で指定して読み込む方法を教えてください。
お世話になります。 Accessにて顧客管理システムを作成しています。掲題について、連結サブフォームでの入力項目の郵便番号には入力支援として住所の自動入力は設定しています。 ただ、その郵便番号入力後 住所を入力者が変えた時、郵便番号と異なる場合のチェックを保存処理のボタンを押したタイミングでDBに予め用意したフラグフィールドに付けたいです。 このチェック方法をVbaのコードで示して頂けると助かります。どうかよろしくお願いいたします。 ※住所から郵便番号を自動入力で変えるということは考えてません。郵便番号と住所、どちらが正しい情報なのか区別するため、ただ一致しないという判別をつけるだけであとで入力者本人に確認する運用にします。
会社リストからＨＴＭＬファイルを作成しています。 １つの地域で１つのファイルにしています。 地域によっては会社数が多くなってきたので、 ２０社ごとにファイルを別にして出力したいと考えております。 tokyo tokyo2 tokyo3 tokyo4 　・ 　・ 　・ Ｇ列のファイル名を２０社ごとに変換するには 以下のソースをどのように改良すれば良いのか、ご教授願います。 Sub HTMLファイル出力() Dim myPath As String Dim i As Long myPath = Environ("USERPROFILE") & "\Desktop\Hoge\" Range("A:G").Sort Key1:=Range("G2"), Header:=xlYes, MatchCase:=False, _ Orientation:=xlTopToBottom For i = 2 To Range("G1").End(xlDown).Row If Range("G" & i).Text <> Range("G" & i - 1).Text Then Open myPath & Range("G" & i).Text & ".html" For Output As #1 Print #1, "<!DOCTYPE html>" & vbNewLine _ & "<html lang=""en"">" & vbNewLine _ & "<body>" & vbNewLine _ & "<div class=""span3"" id=""sidebar"">" & vbNewLine End If Print #1, "<div class=""widget"">" & vbNewLine _ & "<h4 class=""widgetTitle"">" & Range("A" & i).Text & "</h4>" & vbNewLine _ & "<ul><li>" & Range("B" & i).Text & "</li>" & vbNewLine _ & "<li>" & Range("C" & i).Text & "</li>" & vbNewLine _ & "<li>" & Range("D" & i).Text & "</li>" & vbNewLine _ & "<li>" & Range("E" & i).Text & "</li></ul></div>" & vbNewLine If Range("G" & i).Text <> Range("G" & i + 1).Text Then Print #1, "</div>" & vbNewLine & "</body>" & vbNewLine & "</html>" Close #1 End If Next End Sub
エクセル2003で作成した会社の一覧表があります。 Sheet1は会社一覧（上図） Sheet2はエリア表（下図）です。 マクロを使用して、Sheet1のＧ列にエリアの読みを表示 どうにか自分でやろうとしたのですが、できませんでした。 Sheet1の最後まで行くとストップするようにしたいのです。 どうかご教授お願いいたします。
エクセル2003で商品の一覧表を作成しています。 Sheet1は商品一覧（左図） Sheet2は価格表（右図）となっています。 マクロを使用して、Sheet1のB列に価格表のデータを転記させたいと考えています。 VLookupになるのかと思い、自分でいろいろとやってみたのですが、 どうしても動作せず、挫折してしまいました。 商品一覧の最後の行までいって、空白セルがくると止まるというのが、 難しくてできませんでした。 どうかお願いいたします。
エクセル2003で作成した住所録があります。 県名（３文字）のみを抽出して、新たに設けたD列に表示させたいと考えています。 Sub 県名の列作成() 　Dim myStr As String 　myStr = ActiveCell.Value 　Range("D2").Value = Left(myStr,3) End Sub ここまで、できたのですが・・・・ B列の２行目から順に処理をして、一覧表の最後まで行って、 空白セルの行が見つかったら終了させる方法が分かりません。 どうかよろしくお願いします。
早速ですが Cells(cnt, n - 5) = WorksheetFunction.Sum(Me.Range("cr" & cnt + 1 & ":ct" & cnt + 1)) は　通っています。 sumの範囲を　可変にしたいので 可変値　$CR$6　＝3　とします（ｃｒ、ｃｓ、ｃｔ） で Cells(cnt, n - 3) = WorksheetFunction.Sum(Me.Range("cr" & cnt & ":" & Offset("cr" & cnt, $CR$6 * -1, 1))) が　OFFSETが　定義されていない　となります こうした、使い方は出来ないのでしょうか 他の方法があればご教示ください
現在、ユーザーフォームに60個のテキストボックスを設置しています。 数値入力されるとカンマが付くようコードを書いているのですが、まとめて処理できるようなコードはないでしょうか？ 現在… Private Sub TextBox1_Change() TextBox1.Text = Format(TextBox1.Text, "#,##0") End Sub Private Sub TextBox2_Change() TextBox2.Text = Format(TextBox2.Text, "#,##0") End Sub Private Sub TextBox3_Change() TextBox3.Text = Format(TextBox3.Text, "#,##0") End Sub これを60個 試しにfor～Nextで書いてみましたが、失敗しました。 Dim c As Integer For c = 1 To 60 Controls("TextBox" & c).Text = Format("TextBox" & c.Text, "#,##0") Next End Sub ご存知の方、お力を貸してください。 ウィンドウズ7のエクセル2013を使用しています。
現在、グループの数だけユーザー名の合計数をSheet2に抽出するという 事をやっているのですが....... コードの方は下記になります Sub Sample3() Dim i As Long, j As Long, k As Long, lastRow As Long, lastCol As Long Dim wS2 As Worksheet, wS3 As Worksheet Set wS2 = Worksheets("Sheet1") Set wS3 = Worksheets("Sheet2") Application.ScreenUpdating = False If wS2.Range("Y1") = "" Then wS2.Range("Y1") = "ダミー" End If With Worksheets("Sheet1") If .Range("A4") = "" Then .Range("A4") = "ダミー" End If lastRow = .Cells(Rows.Count, "B").End(xlUp).Row Range(.Cells(5, "B"), .Cells(lastRow, "B")).AdvancedFilter Action:=xlFilterCopy, copytorange:=wS3.Range("A1"), unique:=True '★ For i = 2 To wS3.Cells(Rows.Count, "A").End(xlUp).Row wS2.Cells(7, (i - 2) * 8 + 3) = wS3.Cells(i, "A") .Range("A4").AutoFilter field:=2, Criteria1:=wS3.Cells(i, "A") Range(.Cells(5, "AA"), .Cells(lastRow, "AA")).SpecialCells(xlCellTypeVisible).Copy wS2.Cells(7, (i - 2) * 8 + 2) For k = wS2.Cells(Rows.Count, (i - 2) * 8 + 2).End(xlUp).Row To 7 Step -1 wS2.Cells(k, (i - 2) * 8 + 3) = WorksheetFunction.CountIfs(.Range("AA:AA"), wS2.Cells(k, (i - 2) * 8 + 2), .Range("B:B"), _ wS2.Cells(7, (i - 2) * 8 + 3)) If WorksheetFunction.CountIf(wS2.Columns((i - 2) * 8 + 2), wS2.Cells(k, (i - 2) * 8 + 2)) > 1 Then wS2.Cells(k, (i - 2) * 8 + 2).Resize(, 2).Delete shift:=xlUp End If Next k Next i wS2.Range("B1").CurrentRegion.Borders.LineStyle = xlContinuous wS2.Cells.Replace what:="ダミー", replacement:="", lookat:=xlWhole .Cells.Replace what:="ダミー", replacement:="", lookat:=xlWhole wS3.Cells.Clear .AutoFilterMode = False End With Application.ScreenUpdating = True End Sub このコードで検索をかけるSheet1のセルBの文字をセルCに移動して検索かけたいという事なのですが、下記の用なコードでBをCに変更してみた結果エラーが発生してしまいます。 lastRow = .Cells(Rows.Count, "C").End(xlUp).Row Range(.Cells(5, "C"), .Cells(lastRow, "C")).AdvancedFilter Action:=xlFilterCopy, copytorange:=wS3.Range("A1"), unique:=True '★ For i = 2 To wS3.Cells(Rows.Count, "A").End(xlUp).Row wS2.Cells(7, (i - 2) * 8 + 3) = wS3.Cells(i, "A") .Range("A4").AutoFilter field:=2, Criteria1:=wS3.Cells(i, "A") Range(.Cells(5, "AA"), .Cells(lastRow, "AA")).SpecialCells(xlCellTypeVisible).Copy wS2.Cells(7, (i - 2) * 8 + 2) For k = wS2.Cells(Rows.Count, (i - 2) * 8 + 2).End(xlUp).Row To 7 Step -1 wS2.Cells(k, (i - 2) * 8 + 3) = WorksheetFunction.CountIfs(.Range("AA:AA"), wS2.Cells(k, (i - 2) * 8 + 2), .Range("C:C"), _ どなたかご教授の方お願い致します。
下記のようにA列に金額　Ｂ列に欄No.があります。VBAマクロで集計した結果を出すマクロの記述の仕方を教えてください。 金額　　欄No. 232 　　　 1 1005 　　 1 812 　　　 2 425 　　　 2 193 　　　　1
WEBページのテキストを取り込んで、携帯あてメールで転送するのですが、今まで、文字コードを意識せず使っていたのですが、YAHOO.BBの携帯（グーグルNEXUS5）に送ると　文字化けします。 一番簡単な文字コード指定の方法は無いでしょうか？ネットでは保存されたファイルの変換等のサンプルは有るのですが、 StrConv関数の使い方的な方法でJIS-2022-JP（これで良いハズ？）に化けてくれると良いのですが・・・ 今のコードは SendMail oObjDoc.documentElement.outerHTML　’web取り込み Public Sub SendMail(txt As String) Dim CDOMail As Variant Dim STUl 'On Error Resume Next Application.DisplayAlerts = False Set CDOMail = CreateObject("CDO.Message") CDOMail.From = ConfigForm.TxtSendAddr.value CDOMail.To = ConfigForm.TxtDesMailAddr.value If Len(sTitle) > 0 Then CDOMail.Subject = sTitle Else CDOMail.Subject = ConfigForm.TxtTitle.value End If 'CDOMail.TextBody = txt CDOMail.HtmlBody = txt 'CDOMail.AddAttachment ThisWorkbook.FullName STUl = "http://schemas.microsoft.com/cdo/configuration/" With CDOMail.Configuration.Fields .Item(STUl & "smtpserver") = ConfigForm.TxtSendServer.value .Item(STUl & "smtpserverport") = ConfigForm.TxtPort.value .Item(STUl & "sendusing") = 2 .Item(STUl & "smtpauthenticate") = 1 .Item(STUl & "sendusername") = ConfigForm.TxtSendUser.value .Item(STUl & "sendpassword") = ConfigForm.TxtSendPwd.value .Item(STUl & "smtpconnectiontimeout") = 60 .Update End With CDOMail.Send Application.DisplayAlerts = True End Sub
VB .netで自分のドキュメントにフォルダを作成する方法を教えて下さい。 普通のフォルダ作成はできました。 System.IO.Directory.CreateDirectory("c:\test\test") 自分のドキュメントに作りたいので以下のようにやってみましたがダメでした。 System.IO.Directory.CreateDirectory("%USERPROFILE%\Documents\test") 何かやり方がありますか？ それとも以下のようなベタ書きしかできませんか？ System.IO.Directory.CreateDirectory("c:\Users\user1\Documents\test")
VisualBasic2008です。 csvファイルに「タイトル名」が100個あります。 フォームに100個のボタンがあり、起動時にcsvの「タイトル名」でボタンのtextを動的に変更しています。 この動的な変更をやめて、ボタンのtextを固定したいと思います。 ひとつずつ手動でtextを変更すればできるのですが、なかなか大変です。 そこで動的に変更した状態をそのまま保存し、コードを取り除くことができれば一番いいのですが・・・ そんなことできるでしょうか？ もちろんコードの削除は手動で問題ありません。
エクセル「Excel2003」ブックのデータを仕分けしてテキストファイルを作成する。 住所録（全国一覧表：シート１枚に記載）があります。 住所ごとにデータを分けて、個別のテキストファイルを作成する ※テキストファイルのファイル名は地域コード（英数字）にする。 　tokyo.html ※テキストファイルの種類は、HTMLファイル ※住所録の項目は、 　会社名、住所、電話、FAX、担当者、地域コード　の６個 ※HTMLファイルに表示させるのは地域コードを除いた５項目 ※以下は、HTMLファイルの例になります。 <!DOCTYPE html> <html lang="en"> <body> <div class="span3" id="sidebar"> <div class="widget"> <h4 class="widgetTitle">会社名1</h4> <ul><li>住所1</li> <li>電話番号1</li> <li>ファックス1</li> <li>担当者1</li></ul></div> <div class="widget"> <h4 class="widgetTitle">会社名2</h4> <ul><li>住所2</li> <li>電話番号2</li> <li>ファックス2</li> <li>担当者2</li></ul></div> <div class="widget"> <h4 class="widgetTitle">会社名3</h4> <ul><li>住所3</li> <li>電話番号3</li> <li>ファックス3</li> <li>担当者3</li></ul></div> <div class="widget"> <h4 class="widgetTitle">会社名4</h4> <ul><li>住所4</li> <li>電話番号4</li> <li>ファックス4</li> <li>担当者4</li></ul></div> <div class="widget"> <h4 class="widgetTitle">会社名5</h4> <ul><li>住所5</li> <li>電話番号5</li> <li>ファックス5</li> <li>担当者5</li></ul></div> <div class="widget"> <h4 class="widgetTitle">会社名6</h4> <ul><li>住所6</li> <li>電話番号6</li> <li>ファックス6</li> <li>担当者6</li></ul></div> </div> </body> </html>
現在、関数ではなく　VBAでマクロを勉強しているのですが、 下記のコードでエラーが発生してしまいます。 是非、ご教授願えませんでしょうか。 Sheet3を作業用のSheetとして使用しています。　 Sub Sample1() Dim i As Long, k As Long, lastRow As Long, wS2 As Worksheet, wS3 As Worksheet Set wS2 = Worksheets("Sheet2") Set wS3 = Worksheets("Sheet3") Application.ScreenUpdating = False With Worksheets("Sheet1") lastRow = .Cells(Rows.Count, "A").End(xlUp).Row .Range("A:A").AdvancedFilter Action:=xlFilterCopy, copytorange:=wS3.Range("A1"), unique:=True For i = 2 To wS3.Cells(Rows.Count, "B").End(xlUp).Row .Range("B1").AutoFilter field:=1, Criteria1:=wS3.Cells(i, "B") Range(.Cells(3, "B"), .Cells(lastRow, "B")).SpecialCells(xlCellTypeVisible).Copy wS2.Cells(3, (i - 1) * 2) For k = wS2.Cells(Rows.Count, (i - 1) * 2).End(xlUp).Row To 2 Step -1 wS2.Cells(k, (i - 1) * 2 - 1) = WorksheetFunction.CountIfs(.Range("A:A"), wS3.Cells(i, "A"), _ .Range("C:C"), wS2.Cells(k, (i - 1) * 2)) For j = 2 To wS3.Cells(Rows.Count, "E").End(xlUp).Row .Range("E1").AutoFilter field:=1, Criteria1:=wS3.Cells(j, "E") Range(.Cells(3, "E"), .Cells(lastRow, "E")).SpecialCells(xlCellTypeVisible).Copy wS2.Cells(3, (j - 1) * 2) For l = wS2.Cells(Rows.Count, (j - 1) * 2).End(xlUp).Row To 2 Step -1 wS2.Cells(j, (j - 1) * 2 - 1) = WorksheetFunction.CountIfs(.Range("A:A"), wS3.Cells(j, "A"), _ .Range("E:E"), wS2.Cells(k, (j - 1) * 2)) If WorksheetFunction.CountIf(wS2.Columns((j - 1) * 2), wS2.Cells(k, (j - 1) * 2)) > 1 Then wS2.Cells(l, (j - 1) * 2 - 1).Resize(, 2).Delete shift:=xlUp End If Next k Next i wS2.Range("A1").CurrentRegion.Borders.LineStyle = xlContinuous .AutoFilterMode = False End With Application.ScreenUpdating = True End Sub 実際に抽出結果を出したい概要は下記に用になります。 検索したいsheet1には セルBにはUsername番号などがあります。 　　　　　A　　　　　　　　B　　　　　　　C　　　　　D　　　　　E　　　　　F　　　　　G １　　　　　　　　　　　Ｕｓｅｒｎａｍｅ　　　　　　Ｇｒｐ番号　　　 ２　　　　　　　　　　　ｙａｍａｄａ１０ｘ　　　　　　Ｇｒｐ１　　　　　　　　　　　　 ３　　　　　　　　　　　ｙａｍａｄａ４ｘ　　　　　　　Ｇｒｐ１　　　 ４　　　　　　　　　　　ｙａｍａｄａ１０ｘ　　　　　　Ｇｒｐ１ ５　　　　　　　　　　　ｙａｍａｄａ１０ｘ　　　　　　Ｇｒｐ１ ６　　　　　　　　　　　ｙａｍａｄａ４ｘ　　　　　　　Ｇｒｐ２ ７　　　　　　　　　　　ｙａｍａｄａ１０ｘ　　　　　　Ｇｒｐ２ ８　　　　　　　　　　　ｙａｍａｄａ４ｘ　　　　　　　Ｇｒｐ２ ９　　　　　　　　　　　ｙａｍａｄａ１０ｘ　　　　　　Ｇｒｐ３ ． ． ５０　　　　　　　　　　　ｙａｍａｄａ４ｘ　　　　　　Gｒｐ４０ Sheet2にはセルBとCにyamada10xの合計数とgrp番号、セルEとFにはyamada4xの合計数とgrp番号などがあります。 　　　　　A　　　　　　　　B　　　　　　　　　　C　　　　　　　D　　　　　　　　E　　　　　　　　　　　F　　　　　 １ ２　　　　　　　ｙａｍａｄａ１０ｘの合計数　Ｇｒｐ番号　　　　　　　ｙａｍａｄａ４ｘの合計数　　Ｇｒｐ番号　　 ３　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 ４　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 ５　　　　　　　　　　　　　　 ． ． １０　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 sheet1で検索したユーザ名・Grp番号などを行数3のセルC・ＦにはGrp番号を抽出 行数3のセルB・ＥにはGrp番号ごとのｙａｍａｄａ１０ｘとｙａｍａｄａ４ｘの合計数をsheet2に 抽出させたいという形になります。 　　　　　　A　　　　　　　　B　　　　　　　　　　C　　　　　　　D　　　　　　　　E　　　　　　　　　　F　　　　　 １ ２　　　　　　　ｙａｍａｄａ１０ｘの合計数　　Ｇｒｐ番号　　　　　　　ｙａｍａｄａ４ｘの合計数　Ｇｒｐ番号　　 ３　　　　　　　　　　　　　　　３　　　　　　　　　Ｇｒｐ１　　　　　　　　　　　 １　　　　　　　　Ｇｒｐ１ ４　　　　　　　　　　　　　　　１　　　　　　　　　Ｇｒｐ２　　　　　　　　　　　 ２　　　　　　　　Ｇｒｐ２ ５　　　　　　　　　　　　　　　１　　　　　　　　　Ｇｒｐ３ ． ． １０　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　１　　　　　　　Ｇｒｐ４０ わかりにくい図と説明で申し訳ございません。 お手数をおかけしますが、ご教授の方をお願いできますでしょうか。 よろしくお願い致します。
win7とＥxceｌ2007でマクロ作成中の初心者です。 以下、ファイルの中の複数シートを印刷できました。 Private Sub 請求書印刷_Click() Application.ScreenUpdating = False Unload Me 請求書の印刷100 '請求書印刷 Worksheets(1).Select ActiveWindow.DisplayHorizontalScrollBar = False End Sub Sub 請求書の印刷100() ' Dim i As Integer For i = 1 To Worksheets.Count - 8 With Worksheets(i) If .Range("F11").Value <> 0 Then .PageSetup.PrintArea = "$B$1:$U$44" .PrintOut End If End With Next i Worksheets(1).Activate End Sub ------------------------------------ 今度は、同一のファイルから、指定の単一のシートを印刷したいので 以下のコードを実行すると、 Private Sub 単数印刷_Click()' Application.ScreenUpdating = False Unload Me Unload G印刷 Dim i As Integer With 名簿リスト2 For i = 0 To .ListCount - 1 If .Selected(i) Then 請求書の印刷範囲200 ' Worksheets(.list(.ListIndex)).PrintPreview Worksheets(Split(.list(.ListIndex - 0), " ")(1)).PrintPreview ' End If Next i End With ActiveWindow.DisplayHorizontalScrollBar = False GH印刷.Show End Sub Sub 請求書の印刷範囲200() ' ActiveSheet.Unprotect Dim i As Integer For i = 1 To Worksheets.Count - 8 With Worksheets(i) .PageSetup.PrintArea = False '印刷範囲のクリア If .Range("F11").Value <> 0 Then .PageSetup.PrintArea = "$B$1:$T$44" End If End With Next i Worksheets(1).Activate End Sub 以下の行が黄色くなりマクロがエラーとなり停止します。 エラーは　実行時エラー9 インデックスが有効範囲にありません　となります。 Worksheets(Split(.list(.ListIndex - 0), " ")(1)).PrintPreview ' これと同様のファイルで試すと何なく１枚だけ印刷できました。 このエラーの原因はなんでしょうか？解決方法を教えてください。
ワークシートイベント内で、 セルの値に応じて行色を変更する処理をしているのですが、 オートフィルをした場合、 範囲内のセル全てに処理が適応されません 何か解決策はありますでしょうか？
Ｅｘｃｅｌｌ　ＶＢＡ　にて ユーザーフォーム内に［コマンドボタン］を配置し、このボタンにてユーザーフォームの消去およびその他の作業を行うコードを書い動作させています ユーザーフォームの右上隅に表示されている［×］ボタンを表示しない（又は消去する）方法をおしえてください
質問です。 定期的に更新されるテキストファイルをFileSystemWatcherクラスで監視し、 FileSystemWatcher.OnChangedで変更があった時に、 変更された内容や追記されたを検出したいのですが、 どうすればいいでしょうか？ 前データを予めRenderなどで取得しておき、それをIFでチェックする処理を 毎秒や毎分置きにすると負荷が掛かりそうですし、 何か良い提案を探しています。 Q, 変更された内容や追記されたを検出したいのですが、 どうすればいいでしょうか？ Q, 仮にIFでチェックした際に負荷を軽減化する場合は？ よろしくお願いします。
こんにちは。 EXCELの表からグラフが自動表示されるように設定しております。 ただ、表は日々、更新されデータが増えていきます。 そこで、最終行が更新されたデータに合わせてグラフの選択範囲が変動されるように したいです。 イメージは添付画像の通りです。 以下の関数をどのように修正するべきかをご教授ください。 よろしくお願いします。 FX!$N$1:$N$500
中１男子の母です。 最近、息子が Visual Basic 2010を始めたのですが、 わかりにくいので参考書がほしいそうです。 おすすめの参考書はありますでしょうか。
Win7とExcel2007でマクロ作成の初心者です。 Sub 選択範囲を広げる() Sheets("計算").Select Range("CU6").Select Selection.Resize(, Selection.Columns.Count + 27).Select ここで選んだセルの選択部分を、下の行に向かって選択範囲を広げたいです。 ただ、下方の行数は、常に変動するため、どうやって変動の選択範囲を広げたいか わかりません。よろしくお願いします。 表のCU6以下は、文字列と空白が交互にあります。 End Sub
現在vb.netでインストーラを作成しています。 (1)その中でexeファイルをレジストリに登録しようと考えています。 そのexeファイルを登録することはvb.netで可能でしょうか？ (2)またアンインストールも同じプロジェクトで作成しようと考えているのですがそれも可能ですか？ わかる方がいらしたら教えていただきたいと思います。 よろしくお願いします。
を勉強したいです。 ビジュアルベーシックってなに？というレベルです。（レベルじゃない） 無料で講習を受けたいです。 どこかで講習会等は開催されていませんか？ 滋賀県在住です。
はじめまして、業務用で下記の用にExcel VBABasicでマクロを 組みたいのですが、組み方の方がわかりません。 是非、ご教授願えませんでしょうか。 Ms Oficeは2010です。 検索したいsheet1には ユーザの名前とGrp番号などがあります。 　　　　　A　　　　　　　　B　　　　　C　　　　　D　　　　　E　　　　　F　　　　　G １　Ｕｓｅｒｎａｍｅ　　　Ｇｒｐ番号　　　 ２　ｙａｍａｄａ１０ｘ　　　Ｇｒｐ１　　　　　　　　　　　　 ３　ｙａｍａｄａ４ｘ　　　　Ｇｒｐ１　　　 ４　ｙａｍａｄａ１０ｘ　　　Ｇｒｐ１ ５　ｙａｍａｄａ１０ｘ　　　Ｇｒｐ１ ６　ｙａｍａｄａ４ｘ　　　　Ｇｒｐ２ ７　ｙａｍａｄａ１０ｘ　　　Ｇｒｐ２ ８　ｙａｍａｄａ４ｘ　　　　Ｇｒｐ２ ９　ｙａｍａｄａ１０ｘ　　　Ｇｒｐ３ ． ． ５０　ｙａｍａｄａ４ｘ　　　　ｇｒｐ４０ Sheet2にはyamada10xやyamada4xの合計数とＧｒｐ番号などがあります 　　　　　　A　　　　　　　　　　　　　　B　　　　　　　C　　　　　　　　　　　　　D　　　　　　　E　　　　　F　　　　　 １　　ｙａｍａｄａ１０ｘの合計数　Ｇｒｐ番号　　ｙａｍａｄａ４ｘの合計数　　Ｇｒｐ番号　　 ２　　　　　　　　　　　　　　　　　 ３　 ４ ５ sheet1で検索したGrp番号などの合計数を下記の用にGrp番号にはGrp１などを抽出 そのGrp番号に合ったyamada10xやyamada4xの合計数などをsheet2に抽出させたいのですが 　　　　　　A　　　　　　　　　　　　　　B　　　　　　　C　　　　　　　　　　　　　D　　　　　　　E　　　　　F　　　　　 １　　ｙａｍａｄａ１０ｘの合計数　Ｇｒｐ番号　　ｙａｍａｄａ４ｘの合計数　　Ｇｒｐ番号　　 ２　　　　　３　　　　　　　　　　　　　Ｇｒｐ１　　　　　１　　　　　　　　　　　　Ｇｒｐ１ ３　　　　　１　　　　　　　　　　　　　Ｇｒｐ２　　　　　２　　　　　　　　　　　　Ｇｒｐ２ ４　　　　　１　　　　　　　　　　　　　Ｇｒｐ３ ． ． １０　　　　　　　　　　　　　　　　　　　　　　　　　　　１　　　　　　　　　　　　Ｇｒｐ４０ わかりにくい図で申し訳ございません。 お手数をおかけしますが、ご教授の方をお願いできますでしょうか。 よろしくお願い致します。
vb.netで作成したexeファイルをアンインストールする際にパスワード認証をさせたいのですが、可能ですか？ また、可能の場合どうすればいいですか？ ご存じの方がいらしたらおしえていただけないでしょうか。。 よろしくお願いします。
vb.netで作成したEXEファイルを終了させないアプリにしたいと考えています。 そのため、タスクマネージャーの”プロセスの終了”でもそのアプリが終了しないようにしたいのですがそれは可能でしょうか？
vbaにて勤怠表を作っているのですが、時刻と時間の区別はどのようにするのでしょうか。 初歩的な質問でしたら、どうかご容赦ください。 項目には出勤時間、休憩時間、退勤時間、勤務時間、他（省略します）があるのですが、 退勤時間から出勤時間を引いた時間をmyTimeとして、myTimeに応じて休憩時間の判定を行ないたいです。 myTimeが４時間未満で休憩時間０分 ４時間以上６時間未満で休憩時間３０分 ６時間以上８時間未満で休憩時間４５分 ８時間以上で休憩時間は１時間 の時間を休憩時間セルに入力させたいのですが、myTimeが時刻から変えられず困っています。 恐らく、８時より前か後か、といったような判断をしているのだと思います。 ちなみにセルには別のExcel関数が入っていて、マクロを実行するときに関数を無視して（上書きして）入力させたいので、Excel関数での提案は今の所考えておりません。 コードの書き方を教えてくださいませんでしょうか。 現在の表記がh：mmになっている為、これで統一出来れば嬉しいです。 このあと勤務時間の集計も行なう為、時間の計算方法なども教えて頂けると助かります。 （一応自力で調べてみてはいるものの、まだ理解には及びません。） Dim STAR_TIME As Date Dim RECESS_TIME As Date Dim myTime As Date STAR_TIME = Cells(0, STAR_CL)　　　'出勤時間の行です LAST_TIME = Cells(0, LAST_CL)　　　'退勤時間の行です myTime = LAST_TIME - STAR_TIME With Cells(0,RECESS_CL)　　'休憩時間の行です If myTime >= Format(Time, "8:00") Then .Value = Format(Time, "1:00") ElseIf Format(Time, "8:00") > myTime And myTime >= Format(Time, "6:00") Then .Value = Format(Time, "00:45") ElseIf Format(Time, "6:00") > myTime And myTime >= Format(Time, "4:00") Then .Value = Format(Time, "00:30") ElseIf Format(Time, "4:00") >= myTime Then .Value = Format(Time, "0:00") End If End With 記号（大なり、小なり）の挙動もいまいち理解出来ていません。 何度も試してみて今の位置にしてみたのですが、 いろいろ試して変えまくって、なんだかよく分からなくなってきました。正直合っている気はしないです。 実際にはもうすこし長いコードですが、必要そうな所だけ書き出しました。 私のミスで足りないところがあるかもしれません。必要であれば書き足します。 作成はExcel for mac 2011ですが、 実際に運用するのはWindowsの各Excelバージョン（複数）の為、 互換性のあるコードで教えてください。宜しくお願い致します。
初歩的なことなのですが、どうか教えてください。 (1)はわかるのですが、(2)が分かりません。 どのように表したらよいでしょうか。 (1)Range("A1","C5")　⇒　Range(Cells(1, 1), Cells(5, 3)) (2)Range("A1:C5,E1:G5") ⇒　？？？
win 7 とEXCEL2007でマクロ作成初心者です。 Sub kigoumade() Range("DK30").Activate Do Until ActiveCell.Value = "※※" ActiveCell.UnMerge ActiveCell.Clear ActiveCell.Offset(1).Activate Loop End Sub 上のコードでDK列のセル（※※の無い行だけ）を消去できました。 これをActiveCell列のセルでなく、 （"BR30：EE30")という複数セルを、※※のある行の手前までをClearしたいのですが どうすればよろしいかご教示お願いします。
現在，以下の記述でエクセル上にマクロ実行ボタンを作成しました。 任意のCSVファイルをエクセルに取り込み利用する目的です。 実行ボタンを押すと，「実行時エラー　ファイルにこれ以上データがありません。」として，記述中の 「Input #intFF, X(1), X(2), X(3), X(4), X(5), X(6), X(7) ' (2)」 部分が黄色になって止まってしまいます。 エクセル画面上には，希望通りのデータが出力されているようなので，このエラーが表示されなければデータの取り込みとしては問題ないのですが・・・。 どのようにこのエラーを回避し処理すればよいかかが分かりません。 どなたかご教示いただければ幸いです。 どうかよろしくお願いいたします。 Sub Macro4() ' CSV形式テキストファイル(7カラム)読み込みサンプル Const cnsTITLE = "テキストファイル読み込み処理" Const cnsFILTER = "CSV形式ファイル (*.csv),*.csv,全てのファイル(*.*),*.*" Dim xlAPP As Application ' Applicationオブジェクト Dim intFF As Integer ' FreeFile値 Dim strFileName As String ' OPENするファイル名(フルパス) Dim vntFileName As Variant ' ファイル名受取り用 Dim X(1 To 7) As Variant ' 読み込んだレコード内容 ' (1) Dim GYO As Long ' 収容するセルの行 Dim lngREC As Long ' レコード件数カウンタ ' Applicationオブジェクト取得 Set xlAPP = Application ' 「ファイルを開く」のフォームでファイル名の指定を受ける xlAPP.StatusBar = "読み込むファイル名を指定して下さい。" vntFileName = xlAPP.GetOpenFilename(FileFilter:=cnsFILTER, _ Title:=cnsTITLE) ' キャンセルされた場合はFalseが返るので以降の処理は行なわない If VarType(vntFileName) = vbBoolean Then Exit Sub strFileName = vntFileName ' FreeFile値の取得(以降この値で入出力する) intFF = FreeFile ' 指定ファイルをOPEN(入力モード) Open strFileName For Input As #intFF GYO = 1 ' ファイルのEOF(End of File)まで繰り返す Do Until EOF(intFF) ' レコード件数カウンタの加算 lngREC = lngREC + 1 xlAPP.StatusBar = "読み込み中です．．．．(" & lngREC & "レコード目)" ' レコードを読み込む(このサンプルは7項目のCSV) Input #intFF, X(1), X(2), X(3), X(4), X(5), X(6), X(7) ' (2) ' 行を加算しA～G列にレコード内容を表示(先頭は2行目) GYO = GYO + 1 Range(Cells(GYO, 1), Cells(GYO, 7)).Value = X ' 配列渡し ' (3) Loop ' 指定ファイルをCLOSE Close #intFF xlAPP.StatusBar = False ' 終了の表示 MsgBox "ファイル読み込みが完了しました。" & vbCr & _ "レコード件数=" & lngREC & "件", vbInformation, cnsTITLE End Sub
vb.netのexeファイルでのアプリの一部の動作ができません。 プロジェクトファイルを開いて実行すれば稼動するのですが、生成したexeファイルを実行した場合に一部の動作が稼働できません。その動作以外の動作は稼働します。 その稼働しない動作はデバイスの状態変更(有効から無効)にする動作です。 原因が分かる方、推測できる方がいらっしゃったら、教えていただけないでしょうか？ 宜しくお願いします。 exeファイルは監視exeでデバイスの接続時にフォームが表示するようにタスクスケジューラーで常時監視をしています。 また、通常時は画面上には見えないように「ShowInTaskbar」をFalseにしており、フォームは通常時最小化されている状態になります。
ＶＢ2010を使っています。 Oracleのプロシージャを呼び出しするのですが、 以下のエラーが出て困っています。 ORA-06550:行1、列7： PLS-00801:内部エラー[22503] ORA-06550:行1、列7： PL/SQL:Statement ignored 実際のＰＧ Public Function ORA_EXECUTE(ByVal strSQL As String) As Boolean ' データ格納領域の初期化 Dim v_return_flg As Boolean Dim Ora_Cnn_bk As OracleConnection Dim Ora_Cmd_bk As OracleCommand ' Oracle接続情報の初期化 Ora_Cnn_bk = New OracleConnection Ora_Cmd_bk = New OracleCommand ' Oracleへのコネクションの確立 Ora_Cnn_bk.ConnectionString = "User Id=(ユーザ名); Password=(パスワード); Data Source=(接続文字列)" & "; Pooling=false" Ora_Cnn_bk.Open() v_return_flg = False Try Dim oTYPE_CHAR As OracleDbType = OracleDbType.Char Dim oPARM_OUTPUT = ParameterDirection.Output 'バインド変数のセット Ora_Cmd_bk.Parameters.Add("AAA", oTYPE_CHAR) Ora_Cmd_bk.Parameters("AAA").Value = " " Ora_Cmd_bk.Parameters("AAA").Direction = oPARM_OUTPUT Ora_Cmd_bk.Parameters("AAA").OracleDbType = oTYPE_CHAR 'ストアドプロシージャ実行 Ora_Cmd_bk.CommandType = CommandType.StoredProcedure Ora_Cmd_bk.CommandText = strSQL Ora_Cmd_bk.Connection = Ora_Cnn_bk Ora_Cmd_bk.ExecuteNonQuery() Catch ex As Exception MessageBox.Show("SQL(" + strSQL + ")" + Chr(13) + ex.Message, "確認", MessageBoxButtons.OK) Finally ' コネクションを閉じる Ora_Cnn_bk.Close() ' Oracle接続情報のクリア Ora_Cnn_bk = Nothing Ora_Cmd_bk = Nothing End Try ' データ返却 Return v_return_flg End Function Oracle側のプロシージャは、別ＰＧで使用していて Ｃ＋＋からアクセスし使える状態です。 お分かりになる方教えてください。 m(_ _)m
csvファイルを別のファイル(エクセル)に並べ替えて保存したいと考えてVBAでプログラムを 書いてみたのですがうまくできないので解決策をご教示いただけないでしょうか。 960行640列のデータを，「行，列，値」←エクセルでいうとA列＝行，B列＝列，C列=値 の形に並べ替えようとしています。 　行　　列　　値 　1　　　1　 　28 1 　 2 　10 　1　　　3　　　0 　・　　　・　　　・ 　・　　　・　　　・ 　960　640　 37 といった具合です。 実行すると，行と列は並べ替えて表示されるのですが，値だけはどの行でも同じ値が入ってしまいます。元のデータでは値はランダムです。 書いたプログラムを下に載せます。 配列tmpのインデックスがループを追うごとに変化しないことが原因かと考えていますが， 変数nを追加して　”For tmp = 0 To UBound(tmp) Next n”　を　”For j = 1 To 640　Next j” の中に入れてみましたが(これでは意図と違う表示がされそうですが)，結果はおなじでした。 配列tmpの中身を，対応するセルに一つ一つ入れていくにはどのようにしたら良いのでしょうか。 本やネットの情報をつまみ食いして書いているので，理屈やスマートな書き方など よくわかっておらず，見苦しいものかとも思いますがどうぞよろしくお願いします。 ------------------------------ Sub　並べ替え() Dim i As Long, j As Long, m As Long Dim buf As String, tmp As Variant Open "ファイル" For Input As #1 m = 1 Input #1, buf tmp = Split(buf, ",") Cells(1, 1).Value = "X" Cells(1, 2).Value = "Y" Cells(1, 3).Value = "Z" For i = 1 To 960 For j = 1 To 640 m = m + 1 Cells(m, 1).Value = i Cells(m, 2).Value = j Cells(m, 3).Value = tmp Next j Next i Close #1 ChDir "新しいファイル" ActiveWorkbook.SaveAs Filename:="新しいファイル", _ FileFormat:=xlCSV, CreateBackup:=False End Sub ---------------------
excel初心者です。 文字列を置き換え、オリジナルの隣のセルに表示させる方法を教えてください。 扱っている商品名のいくつかが変更になったので、過去に入力済みのデータを一括変換したいのですが、旧商品名も残しておきたいと思っています。 たとえば、 日付商品名数量価格 9/6オレンジジュース1550 9/6バナナミルク1500 9/6カフェラテ1600 を 日付新商品名旧商品名数量価格 9/6フレッシュオレンジオレンジジュース1550 9/6バナナオレバナナミルク1500 9/6カフェオレカフェラテ1600 という感じです。 商品名が多く40以上あるため、SUBSTITUTEだと無理があり、VBAでの方法を調べ始めたものの、replaceでは上書きしかできない（？）ようで、いまいちよくわかりません。 どなたかご教授いただけないでしょうか。 また、VBAについて初心者向けにわかりやすく解説しているサイトや本がありましたら、あわせて教えていただけたら幸いです。 よろしくお願いいたします。
VisualBasic2008で作った実行ファイル（～.exe）はあるんですが、そのほかのソースなどフォルダごと削除してしまったようです。 実行ファイル（～.exe）は別のところにコピーして使ってたので残っているんです。 実行ファイル（～.exe）からソースを作るなんて事できませんか？ 自分で作ったやつなので大まかには分かるんですが・・・・
windws7 Excel2007でマクロ作成中の初心者です。 B列に８月21日から９月20日まで入力されてます。 以下のコードでセルＢＷ28の数値によりセル選択範囲が異なります。 すべて８月２１日の行から開始します。 28のときは、８月２１日の行から２８番目の行まで選択 29のときは、８月２１日の行から２９番目の行まで選択 30のときは、８月２１日の行から３０番目の行まで選択 以上正常にセルの選択が出来ます。 しかし３１のとき ８月２１日の行ただ１行しか選択してくれません。 上の例のように ８月２１日の行から３１番目の行、つまり９月２０日までの行まで 選択したいのですが、どうしたらよいでしょうか。 Sub sersu sentaku() If Range("BW28") = 28 Then Range("B30").Resize(Day(DateSerial(Year(Date), Month(Date), 28)), 66).Select ElseIf Range("BW28") = 29 Then Range("B30").Resize(Day(DateSerial(Year(Date), Month(Date), 29)), 66).Select ElseIf Range("BW28") = 30 Then Range("B30").Resize(Day(DateSerial(Year(Date), Month(Date), 30)), 66).Select ElseIf Range("BW28") = 31 Then Range("B30").Resize(Day(DateSerial(Year(Date), Month(Date), 31)), 66).Select End If End Sub
vb.netでデバイス状態変更のアプリを作成しています。 その中で、Visual Studio上でデバックすると、デバイスの状態変更げできるのですが、アプリとして起動するとデバイスの状態変更が出来なくなってしまいます。 調べてもこの現象に関してのことはわかりませんでした。ですので、わかる方がいらしたら、教えていただけたらと思い質問させていただきました。
VBAのプロの方にお願いがあります。下記、内容で欄ごとに仕入書価格と申告金額を集計しその結果を別シートの10行目から表示させるにはどのようなプログラムを作成すればいいでしょうか。欄番号と輸入統計品目番号も合わせて表示したいです。またSMALLのグループの中では税率ごとで金額が一番大きい輸入統計品目番号を表示させることはできますでしょうか。どなたかお力をお貸しください。よろしくお願いいたします。 欄　大額・少額　輸入品目統計番号　　税率　仕入書価格　 申告金額 1　　　Large　　　　8708.70-0906　　　　　無税　　　5,659.00　　　¥777,320 2　　　Large　　　　8708.10-0006　　　　　無税　　　2,250.00　　　¥309,060 3　　　Small　　　　8708.94-0004　　　　　 無税　　　　854.50　　　¥117,374 3　　　Small　　　　8708.29-0006　　　　　 無税　　　　735.00　　　¥100,959 4　　　Small　　　　6211.43-2006　　　　　　9.1%　　　　420.00　　　　¥57,691 4　　　Small　　　　6204.62-2001　　　　　　9.1%　　　　194.40　　　　¥26,702 5　　　Small　　　　7318.15-0195　　　　　　2.8%　　　　142.62　　　　¥19,590 　
初心者です。 エクセル2010を使用しています。 社内のエクセルシートで工事の依頼を物件ごとに記入していきます。（A:N） 工事完了後、（A:N）に色を付けます。 毎回パレットで選んでいます。色番は16777164 マクロで一連の動作を記憶させ、ボタン一つで出来るようには作れたのですが、元々色の付いている箇所だけはそのままの色にしたいのです。 元々色がついてる理由ですが、工事には材料が必要なのですが、仕入れて請求が来るのが月末となります。金額の入力を忘れない為に色を付けています。 そういった場合はどのようなプログラムになるのでしょうか。 ご教示お願い致します。
VB2010であるテキストファイルに下記のような文字が入っているとします。 そこで、このファイルから「歌：」や「アーティスト：」、「歌手：」などと書かれている行を検索し、 その行の「歌：」や「アーティスト：」、「歌手：」以降の文字列を取り出したいと思いました。 下記の例では、「歌：小林ゆう」と書かれている行の「小林ゆう」を取り出したいです。 テキストファイルは数万件あります。 ご教示お願いします。 ************************ HANAJI 作詞：有森聡美 作曲：村井大 編曲：村井大 歌：小林ゆう タイアップ：TVアニメ「まりあ†ほりっく」 ************************
sqlでの拡張子保存ができません。 mac OS X バージョンは10.8.5です。 テキストエディットを使って、「○○.sql」という拡張子で保存したいのですができません。 なにか特別な設定が必要なのでしょうか。
vbで作成したフォームアプリケーションをサービスに登録し、Windowsが起動時に自動で実行するようにしたいのですが、vbで作成したフォームアプリケーションをサービスに登録する方法がわからないのでわかる方がいらしたら、教えていただきたいと思います。 アプリの動作は、デバイスの抜き差しの監視アプリです。
毎月の150人分の給与データをエクセルにする必要があります。 csvデータを加工の途中で一名分のデータが3行になります。 その3行になった時点でそれぞれ各個人のデータの2行目に あたる部分のAからＣを削除したいのですが、 例えば　A2-C2, A5-C5, A8-C8, A11-C11 ........ A449-C449 を一括で削除する。 マクロでそういった記録は可能でしょうか？
こんにちは。わかる方教えて下さい。 Excelで作成したいのですが、セルA1とA2に時間（例：13:00と14:00）をそれぞれ入力。 その時刻になったら音を鳴らして知らせるようにしたいと思っています。 いろいろサイトをみていますが初心者なのでよくわかりません。 OnTimeを使用したらよいと記載されているサイトが多いのですが、使い方がいまいちです。 どのようにしたらよいのか教えていただけないでしょうか。 また、それぞれその時間になったらセルA1とA2に色がつくようにできますかよろしくお願いいたします。 参考URL http://excel-ubara.com/excelvba5/EXCEL104.html を試してみましたがうまくいきませんでした。
あるフォルダに100曲くらいのmp3があります。 これをAxWindowsMediaPlayerリストに入れて、再生しています。 たとえば100曲中の12曲目の再生中に終了（例えばボタンを押す）させた場合、12という数値を取得する方法がありますか？ その数値をテキストファイルに書き込んでおいて、次回再生する際は13曲目から再生したいのです。 いろいろ調べてみたのですが、取得する方法がわかりません。 よろしくお願いいたします。 下記をforで回して100曲セットしてます Me.AxWindowsMediaPlayer1.currentPlaylist.appendItem(AxWindowsMediaPlayer1.newMedia(　～～　)) 下記で再生してます Me.AxWindowsMediaPlayer1.Ctlcontrols.play()
win8.1でvbaでブラウザを操作しています。 ＸＰからＷＩＮ７までは、 Sub Sample() Dim objIE As InternetExplorer Set objIE = CreateObject("InternetExplorer.application") objIE.Visible = True objIE.Navigate "http://www.yahoo.co.jp/" Do While objIE.Busy = True DoEvents Loop objIE.Navigate "http://shopping.yahoo.co.jp/" ・・・ このように、 objIE.Navigate に、ＵＲＬを入れ替えても、問題なく表示できたのですが ｗｉｎ８からは objIE.Navigateで、１つ目のＵＲＬを表示させ、２つ目のＵＲＬを表示させると、 見た目は、 二つ目の"http://shopping.yahoo.co.jp/"が表示されるのですが、 objIEの中身は、１つ目の "http://www.yahoo.co.jp/"のままです。 なので、 objIE.Navigate "http://shopping.yahoo.co.jp/" のあとに、 Do While objIE.Busy = True DoEvents Loop をしても、 objIEに格納されている値は、 "http://www.yahoo.co.jp/"だから 無限ループしてしまいます。 この現象を回避するにはどうすればいいでしょうか？ エクセル２０10です。 よろしくお願いします。
お世話になります。 平成○○年○月 　　　　Ａ　　Ｂ　C 　D 　E 　 F 　G　 １　　　月　火　水　木　金　土　日 ２　　　○　○　○　○　○　○　○ ３　　　○　○　○　○　○　○　○ ４　　　○　○　○　○　○　○　○ ５　　　○　○　○　○　○　○　○ ６　　　○　○　○　○　○　○　○ 上記のようなデータがあり、条件付き書式のルールで土曜日と日曜日のセル（Ｆ２からＦ６とＧ２からＧ６）、にはセルに色がついています。マクロをつかって、色のついたセルの〇を自動で消したいのですが、そういうことは可能でしょうか？　ちなみに月日を変えると曜日は自動で変わるようになっています。 よろしくお願いします。
早速ですが、 シート1　行　3.000から4000.列　セル式　Ｈ-AM　まで シート2　行　3.000から4000.列　セル式　Ｈ-W　まで シート3　行　3.000から4000.列　セル式　Ｈ-AO　まで このような、BOOKが有ります。 データの追加（各シートのＡ-Ｇ　1行追加）に伴い　シート1から　3まで　セル式の計算が行われます。 で、計算が済んだあと、セルの変化をとらえて、次のアクションを起こすのですが、 セル式が完了するまで、時間を稼ぎたいのですが、 今は、タイマーで act時刻 = Now ａｃｔ時刻 = DateAdd("n", 2, act時刻 ) 待ち時間 = DateAdd("s", 20, act時刻 ) Application.OnTime act時刻 , "ｎｅｘｔ-job", 待ち時間 このタイマーが不正確（動作したりしなかったり）で　上の式は　2分待ちですが　1分以下だと　100％起動せず、 1分40秒以上でどうやら・・・ で、タイマー以外で　 シートにデータ送り込むＶＢＡ（15分毎のタイマー）の続きに　計算完了、もしくは、セル式の仕事を止めないで、セル式計算完了を　まって、”ｎｅｘｔ-job”　の　仕事をさせたいのですが セル式の仕事を止めない時間稼ぎは無いでしょうか　
マクロを含むエクセルファイル（AUTO_OPEN()で起動）を共有化したところ、「実行時エラー'1004：Worksheetクラスの Unprotectメソッドが失敗しました。」という表示が出て、止まってしまいます。共有化する前は問題なく動いていたのですが、何が原因なのか、教えてください。よろしくお願いします。
以前別のカテゴリで質問したのですが、そちらでは解決出来なかったので、こちらで改めて質問します。 下記のマクロで、一つのブックからSheet1だけをコピーして来て、少し処理をし、元のブックを閉じるというもので、ブックの数は多くて3000程、少ない時は300位です。 で、このマクロだと９００位までですと最後まで行くのですが、それを超えるとリストが９５位で止まってしまいます。 自宅で別データを作ってやってみるとうまくいきました。 コピー元のブックにはテキストデータのみで、２００文字から５００文字程度の大きさしかありません。 ファイル名も５０文字程度の物を全部２０文字程度まで短くしてもみましたが、ダメでした。 どうかお知恵をお貸しください。 Sub ★1★ブックの結合() Dim sFile As String Dim sWB As Workbook, dWB As Workbook, aWB As Workbook Dim dSheetCount As Long Dim i As Long Dim SOURCE_DIR As String 'エクセルデータに変換されたファイルのあるフォルダを選択します。 MsgBox "エクセルに変換されたデータのフォルダを選択" With Application.FileDialog(msoFileDialogFolderPicker) If .Show = True Then SOURCE_DIR = .SelectedItems(1) & "\" End If End With Application.ScreenUpdating = False '指定したフォルダ内にあるブックのファイル名を取得 sFile = Dir(SOURCE_DIR & "*.xls") 'フォルダ内にブックが無ければ終了 If sFile = "" Then Exit Sub '集約用ブックを作成 Set dWB = Workbooks.Add '転記マクロの中のDMリストシートをコピーする Workbooks("転記用マクロ.xlsm").Worksheets("DMリスト").Copy Before:=dWB.Worksheets("Sheet1") Application.DisplayAlerts = False Worksheets(Array("Sheet1", "sheet2", "sheet3")).Select ActiveWindow.SelectedSheets.Delete Application.DisplayAlerts = True '集約用ブック作成時のシート数を取得 dSheetCount = dWB.Worksheets.Count Do 'コピー元のブックを開く Set sWB = Workbooks.Open(Filename:=SOURCE_DIR & sFile) 'コピー元のsheet1を集約用ブックにコピー sWB.Worksheets("sheet1").Copy After:=dWB.Worksheets(dWB.Sheets.Count) シート転記 'コピー元ファイルを閉じる Application.DisplayAlerts = False sWB.Close Application.DisplayAlerts = True 'セルA2の名前を変更する 'シート名をセルA2の値に変更 'ActiveSheet.Name = Range("A2").Value '次のブックのファイル名を取得 sFile = Dir() Loop While sFile <> "" '集約用ブックを保存する 'dWB.SaveAs Filename:=DEST_FILE Application.ScreenUpdating = False End Sub
ACCESSでORACLEのサーバからデータを取得しようと試みましたがうまくいきません。どこを改善したらよろしいでしょうか？どなたかご教示ください。 クライアント：WINDOWS7 ACCESS2010 サーバ：WIN-SV2003 ORACLE10G 以下のエラーがVBAで取得しようとするとでてきてしまいます。 「[Microsoft][ODBC driver for Oracle][Oracle]ORA-00923:FROMキーワードが指定の位置にありません。」 SQL部分の空白は見直しました。 Private Sub コマンド610_Click() Dim adoCON As Object Dim rs As Object Dim oraclebox() As Variant Dim rdsu As Long On Error GoTo Err_Han 'データベースに接続する' Set adoCON = CreateObject("ADODB.Connection") adoCON.Open "Driver={Microsoft ODBC for Oracle};" & _ "CONNECTSTRING=*****; UID=abcd; PWD=1234;" sqlstr = "SELECT J.KTN_COD,J.SBN,J.GYOSYA_COD,G.GYOSYA_MEI" _ & "FROM JITU_SHARYOU J ,GYOSYA G" _ & "WHERE J.GYOSYA_COD = G.GYOSYA_COD" Set rs = adoCON.Execute(sqlstr) rs.MoveFirst 'レコード数カウント' Do Until rs.EOF rdsu = rdsu + 1 rs.MoveNext Loop '配列を再定義' ReDim oraclebox(rdsu, 4) i = 1 rs.MoveFirst Do Until rs.EOF oraclebox(i, 1) = rs!KTN_COD oraclebox(i, 2) = rs!SBN oraclebox(i, 3) = rs!GYOSYA_COD oraclebox(i, 4) = rs!GYOSYA_MEI i = i + 1 rs.MoveNext Loop rs.Close Set rs = Nothing '警告ダイアログをオフ' DoCmd.SetWarnings False DoCmd.RunSQL "DELETE FROM SAMPLE_T" 'Oracleデータを書き込み' For i = 1 To rdsu DoCmd.RunSQL "INSERT INTO SAMPLE_T(KTN_COD,SBN,GYOSYA_COD,GYOSYA_MEI)" _ & "VALUES('" & oraclebox(i, 1) & "','" & oraclebox(i, 2) & "','" & oraclebox(i, 3) & "'," & oraclebox(i, 4) & ")" Next i '警告ダイアログをオン' DoCmd.SetWarnings True Exit Sub Err_Han: ' エラー処理' MsgBox (Err.Description) End Sub ＊単一のテーブルであればDoCmd.TransferDatabase acImpor等を使うのですが、場合によっては今後データ量が多かったりより複数のテーブルを扱うことになるので。
以前に質問をさせていただき、こちらでベストアンサーを決定した後に急きょ変更があったところがあり、わからなくなってしまいこちらに戻ってきた次第です。 http://oshiete.goo.ne.jp/qa/8743521.html にて質問をさせていただきました内容について、以下のVBAで解決できております。 しかし、抽出したファイル名にハイパーリンクが欲しいという要望を受けてしまいました。 ハイパーリンクのＶＢＡについていろいろ調べましたが、この記述方法に追加して実行する方法が全く分かりませんでした。 お分かりになる方がいましたら、この内容にハイパーリンクをつける方法をお教えいただけますでしょうか。よろしくお願いいたします。 Sub Macro1() Dim i As Long Dim myPath As String, Flnm As String ReDim Flnmfp(0) As String Dim WS1 As worksheet Set WS1=ThisWorkbook.sheets("sheet1") myPath="望みのフォルダパスを入力" Call fpFileName(myPath, Flnmfp ) 'フォルダ内のファイル名取得 If Ubound(Flnmfp)=0 Then 'フォルダにファイルが無ければ終了 Exit Sub End if For i =1 to Ubound(Flnmfp) Workbooks.open filename := Flnmfp(i) Flnm=Dir(Flnmfp(i)) With Workbooks(Flnm).sheets("sheet1") WS1.Cells(2, i).value=.Range("G5").value WS1.Cells(3, i).value=.Range("G6").value WS1.Cells(4, i).value=.Range("K7").value WS1.Cells(5, i).value=CStr(.Range("G9").value) & CStr(.Range("N9").value) & CStr(.Range("P9").value) '同じ要領で望みのセルを記入する WS1.Cells(8, i).value=Flnm End with Workbooks(Flnm).close Savechanges:=False Next i End Sub Sub fpFileName(ByVal myPath As String, ByRef Flnmfp() As String) 'サブフォルダも含め全部のxlsファイル名をフルパスで取得する 　　Dim cnt As Long, buf As String, f As Object 　　buf = Dir(myPath & "\*.xls") 　　Do While buf <> "" 　　　　cnt = Ubound(Flnmfp) + 1 ReDim Preserve Flnmfp(cnt) 　　　　Flnmfp(cnt)= myPath & "\" & buf 　　　　buf = Dir() 　　Loop 　　With CreateObject("Scripting.FileSystemObject") 　　　　For Each f In .GetFolder(myPath).SubFolders 　　　　　　Call fpFileName(f.Path, Flnmfp) 　　　　Next f 　　End With End Sub
VisualBasic2008 で外部のサーバーにあるMySQLに接続できません。 Cnn.Open()の所で、こんなエラーがでます。 Unable to connect to any of the specified MySQL hosts. MysqlTest.vshost.exe Error: 0 : Unable to connect to any of the specified MySQL hosts. 'MySql.Data.MySqlClient.MySqlException' の初回例外が MySql.Data.dll で発生しました。 System.Transactions Critical: 0 : <TraceRecord xmlns="http://schemas.microsoft.com/2004～ ～～ PC内にあるMySQLには接続できるんですが。 外部のサーバーのMySQLには接続できないのでしょうか。 -------コード------------------ Dim sqlStr As String = "SELECT * FROM allitem" Dim CnnStr As String = "server=xxxxxxxxxxx.com:3306;database=PGTESTDB;User Id=pgtestuser;Password=xxxxxx" Dim Cnn As MySqlConnection = New MySqlConnection Cnn = New MySqlConnection(CnnStr) Cnn.Open()
下記のグラフのように、Y軸に目盛表示をしたいのですが、うまくできません。 PictureBoxにLineは表示できるのですが、目盛が表示できません。 どなたかお教え願います。 下記のコードでは、目盛表示ができないのでしょうか。 　　 '目盛表示 Dim J As Integer, CurrentY As Integer, CurrentX As Integer Dim strB As String J = 0 For I = 0 To 200 Step 40 CurrentX = 120 CurrentY = 100 + I strB = CStr(0.2 - (2 / 5) * J * 0.1) J = J + 1 Next J = 0 For I = 0 To 200 Step 40 CurrentX = 120 CurrentY = 300 + I strB = CStr(0 - (2 / 5) * J * 0.1) J = J + 1 Next
64bit版ExcelのVBAでEnumChildWindowsを使用して、子ウィンドウのウィンドウハンドルを 取得したいと考えています。 下記のようなサンプルを作ってみましたが、コールバック関数でExcelが異常終了します。 （05行目にブレークポイントを設定、各変数の値を参照しようとした時点でExcelが異常終了) また、コールバック関数の第3引数(lParam)の型をInteger,Long,LongPtr等変えてみましたが、 いずれもExcelの異常終了となりました。 つきまして、64bit　Excelでの本ＡＰＩの使い方を教えていただきたくよろしくお願いいたします。 （なお、32bit版のExcelでは正常に動作しました) <以下サンプルコード> 行　コード 01 　 Declare PtrSafe Function EnumChildWindows Lib "user32.dll" (ByVal ParenthWnd as LongPtr, ByVal EnumWindosPROC as LongPtr,ByVal lParam as Long) as Integer 02 03 04 Function ListupChildWindows(hWnd as LongPtr,lParam as Long) as Boolean 05 MsgBox hWnd 06 ListupChildWIndows =True 07 End Function 08 09 Sub test_CwinList 10 Dim ThishWnd as LongPtr 11 12 ThishWnd=Excel.Application.hWnd 13 Call EnumChildWindows (ThishWnd , AddressOf ListupChildWindows ,0) 14 End Sub
IEを制御するvb.netで作成して動作していたアプリが、何をきっかけか分りませんが(OSやIEのVupがあったかも知れません)が動かなくなりました。 その対処方法をご教示して頂きたくお願いします。 エラーのステートメント： objIE.Document.FORM_301_01.btn.Click() エラーの内容： 公開メンバー 'btn' は型 'HTMLFormElementClass' に見つかりませんでした。 動作環境 　OS：Windows 7 64bit SP1 　IE: Ver.11 　vb: Visual Studio 2010 Express 　.NET Framework: Ver.4.5 よろしくお願い致します。 P.S. 間違って他のジャンルで質問してしまいましたが、こちらで再質問させて頂きました。
グラフの目盛表示をしたくて、 ｖｂ2010で下記のコードを入力したのですが、何回やってもエラーがでます。 どなたか教えてください。 --------------------------------- J = 0 For I = 0 To 200 Step 40 CurrentX = 120 CurrentY = 100 + I strB = CStr(0.2 - (2 / 5) * J * 0.1) Print strB J = J + 1 Next J = 0 For I = 0 To 200 Step 40 CurrentX = 120 CurrentY = 300 + I strB = CStr(0 - (2 / 5) * J * 0.1) Print strB J = J + 1 Next -------------------------------------
ブックを開くコマンド × Workbooks("filename.xls").open ○ Workbooks.open filename:="filename.xls" 何故下なのですか？ワークブックコレクションの中から特定のブックを指定し開くなら、上の構文にした方がワークシートコレクション等と構文表現を統一出来ます。 現にブックを閉じるコマンドは Workbooks("filename.xls").close です。何故ブックを開くコマンドだけ別表現なのですか？
ｖｂ2010で指定のポイントに文字を表示させる方法を教えてください。 下記のようなコードは間違いでしょうか。 初心者です。 CurrentX = 110 CurrentY = 70 Print("おはよう")
2つのエクセルファイル（電話番号リスト）を比較し、一致するものだけを抽出するという操作をしています。 フィルタオプションを使い、一致するものを抽出しているのですが、まったく同じ電話番号なのに、フィルタオプションで抽出されないものがあり、困っています。 たとえば、0120-234567という電話番号がファイル1にあったとして、まったく同じ番号がファイル2にもあるのですが、この2つが違うデータとして扱われてしまうのです。 試しに2つのファイルから、セルをそのままコピーし、別のエクセルファイルに並べ、if(A1=A2,"一致","一致しない")という関数をしてみると、なんと「一致しない」でした。 見た目的には全く同じなのに、何故なのでしょうか。 ちなみにそれぞれの電話番号セルをダブルクリックし、文字列のみコピーして同じことをすると、「一致する」になりました。 セルに見えないデータでもあるのかと、cleanをしてみましたが、セルをそのままコピーする方法だと、cleanをしても「一致しない」です。 一つ一つのセルをダブルクリック→文字列コピーをすればよいのですが、件数が多く手間です。 この2つのデータが見た目通り同じものだとされるためには、どのような方法があるでしょうか。
類似質問を読んでも今ひとつ完全に仕上がらない為、こちらで質問をさせていただいた次第です。 社内の全員がコンピューターに疎く、せめて私が一番マシという状況だったのですが、私のVBAの端っこをかじったくらいでは到底難しい現状です。お力添えいただけますでしょうか。 EXCELは2010です。 誰でも操作できるようにしたい為、ブックにボタンを作成しそのボタンを押すとVBAが実行され、共有上にあるフォルダから、その中にある.xlsのファイルすべて（サブフォルダも含め）のsheet1から、必要な情報だけ抜き取り、新規ブックにリスト化する、という作業をしたいです。（ボタンの作成や、ボタンを押してのVBA実行のあたりは経験がありますので大丈夫だと思います。） 共有上の.xlsのsheet1には決まったひな形のデータがあります。 共有のパスはts-****/share/共有/発注管理　「発注管理」の中にあります。 そこから企業名、支店名、実施店舗名、実施日、担当名、案件進捗状況などだけを抜き取ってリスト化できると非常にありがたいです。 なので、A2から企業名、A3に支店名、A4に担当名、A5に実施日、A6に実施店舗名、A7に案件進捗状況、A8にファイル名、という項目を入れて それぞれB列から下にそれを反映させていきたいです。 共有上のsheet1にはG5に企業名、G6に支店名、K7に担当名、実施日はG9に初日N9に「～」が入ってP9に終了日が入っている状態でできれば一つのセルに*/*～*/*という表記にしたいです。G10に実施店舗名、X8に案件進捗状況が入っています。 このVBAを実行すればその時フォルダに入っているものが一覧で見ることができる、という事が出来ると非常に作業が効率化できる状況です。 文字ばかりでわかりにくい状況かもしれませんが、ご教授いただけると非常にありがたいです。 よろしくお願いいたします。
VB2010を勉強していますが、コマンドの意味がよくわかりません。 コマンドについて、参考となる本やサイトがあれば、お教えください。
vb2010を用いて「picturebox」に下図のようなグラフを描きたいと思っています。 できれば、ソースを教えて頂ければ幸いです。 VB初心者です。よろしくお願い致します。
ＭＯＳでオフィスマスターを習得しました。ＶＢＡを使いこなせるようになりたいと思い一からプログラミングの勉強をしたいです。 (1)プログラミング初心者にはBasic言語がいいみたいですが、BasicとVisual Basicは違うものですか？ (2)先日Visual Basicのテキストを買いました。テキストには「VS Expression 2013 for Desktop」という無償のソフトを使って勉強していくタイプなのですが、エクセルやワードに入っているＶＢＡではできないのでしょうか？ 詳しい方、よろしくお願いします。
vb.net IVSの漢字を１文字切り出す方法 花という漢字の異体字がセットされた文字列があるとします。 U+82B1 + U+E0103の草冠が＋＋の花の異体字です。 Dim String1 as String = ChrW(&H82B1) & ChrW(&HDB40) & ChrW("&HDD03") この文字列String1 から頭の”１文字”を切り出す方法を教えて下さい。 mid(String1 ,1,1) とすると、異体字の花ではなく、通常の花が出ます。 １文字ではなく、文字の本体部分だけ切り出してしまい、”１文字”を切り出す事ができません。
ＶＢＡでエクセル関数のDATEDIF関数でJ3から始まりその列の最後に入力された次の空白セルに関数を埋め込みたいのですがうまくいきません、どなたか教えてください。 現在の式は　Range("J"＆NewDataRow)、Value=,=IF(DATEDIF(E3,Today(),"Y")>80,"大型中止",OK）ですがE3の結果が出ます、列には途中違う計算式も入っていくことになるので入力した行の計算結果がほしいのです。よろしくお願いします
セル式ですが、記載シートならば下記で　ＯＫですが =INDIRECT("A"& COUNTA(A:A)) 他のシート値が取得できません。 =INDIRECT (データ2!A　& COUNTA(A:A)) #name? エラーが返ります データ2　は　基本　nameです。　オブジェクト名もやりましたが、だめでした。 ””など、やってみたのですが・・・・
vb .net で文字コードから漢字へ変換する方法を教えて下さい。 例えば 「花」という漢字のコードが"82b1" これを、表示させるために me.TextBox1.Text = 関数的なモノ("82b1") というような事はできますか？ さらに、 「花」という漢字の異体字で草冠が＋＋になっている文字が "82b1"＋"e0103" これを、表示させるために me.TextBox1.Text = 関数的なモノ("82b1","e0103") というような事はできますか？ ※ＩＶＳ対応フォントと環境は既にあるものとします。
エクセル勉強中です。 マクロの記憶でＳｈｅｅｔ2の元データの図と記入できるセルをＳｈｅｅｔ1の有効セルにコピペするマクロを作りました。 複数の方が使う予定なので元データのＳｈｅｅｔ2を非表示にしたところマクロがエラーになりました。 どうしたらよいでしょうか？ また貼り付けをする時、微妙に元データのシートがちらちらと移ります。 こちらも合わせてご指導いただけましたら助かります。 　 よろしお願いします。 Sub b1ab1() ' ' b1ab1 Macro ' ' Sheets("Sheet2").Select Range("AK48:AP56").Select Selection.Copy Sheets("ダクト制作単品図").Select ActiveSheet.Paste End Sub
IEを操作して、ファイルをダウンロードしようと思います。 色んなサイトからとってきて、使わせてもらっています。 '---------------------------------IEを開くときに使う Sub IE_OPEN(webUrl As String) Dim objShell Dim writesheet As Worksheet Dim n As Long Dim ID As String, Password As String Set objShell = CreateObject("Shell.Application") Set ie = CreateObject("InternetExplorer.Application") ie.Visible = True ie.Navigate2 webUrl Do While ie.Busy Or ie.readyState <> 4 DoEvents Loop Dim objINPUT Set objINPUT = ie.document.getElementsByTagName("INPUT") 'ループで頭からテキストが 次へ を探す For n = 0 To objINPUT.Length - 1 '※ type="submitボタンなので、.InnerTextじゃなくて、.Valueです ※※注意 If InStr(objINPUT(n).Value, "ログイン") > 0 Then '文字列の中から見つけたら Worksheets("Sheet1").Activate Do While ie.Busy Loop objINPUT(n).Click '見つけたINPUTタグのオブジェクトをクリック Do While ie.Busy Loop Exit For End If Next Set objINPUT = Nothing 'オブジェクト変数解放 End Sub '------------------------------IEを開く（この段階では既に開いてあります。） Private Sub CommandButton1_Click() Do While ie.Busy Or ie.readyState <> 4 DoEvents Loop ie.document.all.ah_ehName.Value = Me.ComboBox1.List(Me.ComboBox1.ListIndex) 'ID Do While ie.Busy Loop Dim objINPUT Dim n As Long Set objINPUT = ie.document.getElementsByTagName("INPUT") For n = 0 To objINPUT.Length - 1 If InStr(objINPUT(n).Value, "ダウンロード") > 0 Then objINPUT(n).Click Do While ie.Busy Loop Exit For End If Next Do While ie.Busy = True DoEvents Loop SendKeys "%S", True'保存 Do While ie.Busy = True DoEvents '何もしないループ（笑） Loop SendKeys "%O",True'ファイルを開く？ Do While ie.Busy = True DoEvents Loop 'ie.Quit End Sub ’＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝－ 面倒なので、IEはPublic変数として モジュールに書いています。 （色んなモジュールを経由する必要があるため、このような手段を取りました） SendKeysをIEに送るというのが出来ずに困っています。 ダウンロードというボタンを押してのダウンロードなので、 ダウンロード用のURL等は分かりません。 Excel2003を使っています。 どうにかSendkeysで出来ないでしょうか？ もしくは、もう少し分かりやすい方法は無いでしょうか。 （ファイルを保存しますか？のダイアログの「保存」をクリックして 　所定の場所におき、開きたい。　そのまま開くのでもいいけれど、動作が不安定になるのは困る） 以上、よろしくお願い致します。
ソリューションの名前を変更しても、 C:\Users\○○\Documents\Visual Studio 2012\Projects の配下にあるフォルダ名は変更されないのでしょうか？ プロジェクトごと、ソリューションごと名前を変更したいのですが、 全て変更できないのであれば訳が分からなくなるのでやめたいのですが、 ソリューションの名前を開発画面で変えた場合 手作業でフォルダ名を変更すればいいのでしょうか？
vb2012をインストールしようと http://www.microsoft.com/ja-jp/download/details. … のページを開いたのですが wdexpress_full.exe VS2012_WDX_JPN.iso のどちらを選べばいいのかわかりません。 http://gurigumi.s349.xrea.com/programming/visual … を見ると、 「オフラインインストールをする場合は、VS2012_WDX_JPN.iso のチェックを入れます。 Webインストールをする場合は、wdexpress_full.exe のチェックを入れます。」 とのことですが、 「オフラインインストール」と「Webインストール」の違いがわかりません。 どちらでもいいのでしょうか？
VBS初心者です。 以下のように、リストを読み込んで動的配列に持たせたいです。 ----------------------------------------------------------------- GET_FILE = "sample.txt" SET objFs = CreateObject("Scripting.FileSystemObject") ' 動的配列セット Call Array_Set("AryVal",GET_FILE) ' 表示 For i = 0 To Ubound(AryVal) msgbox AryVal(i) Next ' 終了 WScript.Quit 0 Function Array_Set(AryName,ReadFile) Set strVal = objFs.OpenTextFile(ReadFile) ' 1行づつ処理 Do While strVal.AtEndOfStream <> True i = i + 1 ReDim Preserve AryName( i - 1 ) AryName( i - 1 ) = strVal.ReadLine Loop End Function ----------------------------------------------------------------- 見て頂くと分かるとおり、動的配列として持たせたい変数名を Functionの引数として渡しています。(当然のごとくエラー、、、) Functionの引数として渡した値に動的配列が格納される方法があれば教えてください。 よろしくお願いします。
Excelでテキストボックスに数値(例：1223-02)入力、検索ボタンを押すことにより同文字B16と一致することで先頭行を１６行に表示移動したいのですがVBAの式をどなたかお解りの方よろしくお願いします。
「ExcelVBAでIEを思いのままに操作できるプログラミング術」という本の中の [[http://store.tsutaya.co.jp/item/rental_dvd/08970 …]このページの"店舗を指定して在庫検索"ボタンを押す、という動作をさせるマクロ]について質問があります。 本を見ながら写してみました。 ページを開いた上でマクロを動かすと"店舗を指定して在庫検索"ボタン押され、画面が変わるマクロです。 基本的に動かないのですが（[完了しました]というメッセージのみが出てきます）、 ごく稀に（頻度としては１０回に１回ほど）正常に動作します （[クリックしました]とメッセージが表示され、画面が変わり[完了しました]というメッセージが出てくる）。 なぜ時々うまく動作するのか分かる方いらっしゃいましたら教えてください。 よろしくお願いいたします。 マクロの内容は下のような内容です。 --------------------------------- Option Explicit Private Declare Sub Sleep Lib "kernel32" (ByVal dwmilliseconds As Long) --------------------------------- Private Function getIe(argTitle As String) As InternetExplorer Dim ie As InternetExplorer Dim sh As Object Dim win As Object Dim documentTitle As String Set sh = CreateObject("Shell.Application") For Each win In sh.Windows documentTitle = "" On Error Resume Next documentTitle = win.document.Title On Error GoTo 0 If InStr(documentTitle, argTitle) > 0 Then Set ie = win Exit For End If Next Set getIe = ie End Function --------------------------------- Private Sub waitBrowsing(ie As InternetExplorer) Do While ie.Busy Or ie.readyState < READYSTATE_COMPLETE Sleep 1 DoEvents Loop End Sub --------------------------------- Private Sub getStock() Dim ie As InternetExplorer Set ie = getIe("TSUTAYA") Dim htdoc As HTMLDocument Set htdoc = ie.document Dim img As HTMLImg For Each img In htdoc.getElementsByTagName("IMG") If InStr(img.alt, "店舗を指定して在庫検索") > 0 Then img.Click MsgBox "クリックしました" Exit For End If Next MsgBox "完了しました" End Sub ---------------------------------
excel2013でシート１にB２～K２１、B２２～K４１まで分けて、それぞれ、あ行～わ行順に氏名が入っています。このデータをシート２のB２～B１０５の範囲にシート１の氏名を実行ボタンで並べるようにマクロ組みしているのですが、並べる際に氏名を昇順で並べられるようにしたいです。初歩的な質問で申し訳ありませんが、この場合、どのようなコードでしょうか？ご回答宜しくお願い致します。
VBA初心者です。 エクセル2007で、sheet1にある商品名（A列)・金額(B列)・個数(C列)・発注日(D列)のリスト（AからD列の50行ほどの範囲。行は増える可能性あり）を商品名をキーにあいうえお順で並べ替え、 sheet2のフォーマットの各セル（A6,D6,G9,J9)へsheet1の商品名・金額等を差込→印刷の繰り返しを行うマクロを組みました。 業務内容に変更があり、ある商品（商品名Ｃとします）のみsheet2ではなく、別のフォーマットへ差込印刷しなければならなくなりました。（別のフォーマットはsheet3とします） 商品Cも含めた全リストを、商品名であいうえお順に並べ替えて印刷（商品名順に印刷したい）を行うためにはどのようにマクロを書き換えれば良いか教えていただきたいです。 リスト並べ替え→商品Cの1行前まで差込印刷LOOP→商品Cをsheet3に差込印刷→商品Cの1行 後から差込印刷LOOPという組み立て方でいいのでしょうか？ IF等使用して商品Cの前の行まで繰り返しを指示すればいいのかなと、自分なりに検索して調べてみましたが方法がわかりませんでした。 宜しくお願いします。 Range("A1:D100").sort_ 　Key1:=Range("A1"),_ 　Order1:=xlAscending,_ 　Header.=xlYes,_ 　Orientation:=xlTopToBottom Workheets("sheet1").Active Range(A1).Select Do Activecell.Offset(1,0).Select If Trim(ActiveCell.Value)=""Then Exit do End if If ActiveCell.EntireRow.Hidden=False Then With Worksheets("sheet2") .Range("A6").value=ActiveCell.Offset(0,0).Value .Range("D6").value=ActiveCell.Offset(0,1).Value .Range("G9").value=ActiveCell.Offset(0,2).Value .Range("J9").value=ActiveCell.Offset(0,3).Value .Printout End With End If Loop End Sub VBAを勉強しだしたばかりですが、今月中に変更する必要があり困っています。 よろしくお願いいたします。
エクセルVBA初心者です。組んで欲しいマクロがあります。 Sheet 1に13桁を入力するセル sheet 2に検索したいデータ 手順としては、 Sheet 1のセルにデータを入力 →13桁以上でマクロが開始(されるように設定します) →Sheet 1のセルと同じ数列をSheet 2の列Aから検索 →該当のセルを含む行をSheet 3にコピー →Sheet 1の入力セルの少し下にもコピー (確認用) というのを一回一回ずつやりたいです。 できれば作業中マウスやキーボードを触りたくないので、そのために、マクロの終わわりには入力セル内の消去、マクロの始まりには確認用でコピーした行の削除もつけて下さい。 検索するSheet 2には同じデータが含まれているので、出来ればひとつずつSheet 3にコピーしたいので組み込んで頂けると幸いです。 よろしくお願いいたします。
プログラムを通信教育で勉強したいと思っています。 アルゴリズムの習得を目指しています vbを使えればまずはよしです 日本プログラミングスクールを探したのですが お勧めのスクールはありますか？ 在職中のため通信が良い
複数の動画ファイルをD&Dして、ファイル名に更新時間と動画時間（動画ファイルのプロパティのビデオの欄に表示される「長さ」という項目） をファイル名に追加するプログラムを書きたいと考えています。 更新時間を書き込む方法は http://www.vector.co.jp/soft/winnt/util/se501476 … のvbsを参考に作ることができました。 動画時間の読み取りに関しては http://q.hatena.ne.jp/1312251379 に書かれてあるのですが、うまくいきません。 ExtendedPropertyのところで、 オブジェクトでサポートされていないプロパティまたはメソッドです。 というエラーが出て実行することができません。 以下が、作りかけですが、作成したプログラムです。 WScript.Echo "Duration : [" & CStr(objFile.ExtendedProperty2("Duration")) & "]" ' 単位は 100ns のところをどのように書き換えれば良いか教えていただけないでしょうか？ Dim stArrayData Dim objParam Set objParam = WScript.Arguments'D&Dでの読み込みを可能にする Dim objFs Set objFs = WScript.CreateObject("Scripting.FileSystemObject") ' 引数の全ファイルについてファイル名を変更する Dim objFile Dim dtLastModified Dim strLastModified Dim i Const FMTID_AudioSummaryInformation = "{64440490-4C8B-11D1-8B70-080036B11A03}" For i = 0 To objParam.Count - 1 If objFs.FileExists(objParam(i)) Then Set objFile = objFs.GetFile(objParam(i)) ' DateLastModifiedのフォーマットが環境によって違うかもしれないので ' いったんDate型にする dtLastModified = CDate(objFile.DateLastModified) If Hour(dtLastModified) < 10 Then strLastModified = strLastModified & "0" End If strLastModified = strLastModified & Hour(dtLastModified) If Minute(dtLastModified) < 10 Then strLastModified = strLastModified & "0" End If strLastModified = strLastModified & Minute(dtLastModified) ' ファイル名を設定 stArrayData = split(objFile.Name, ".") objFile.Name = stArrayData(0) & "-" & strLastModified & "." & stArrayData(1) WScript.Echo "FileName : [" & objFile.Name & "]" WScript.Echo "Duration : [" & CStr(objFile.ExtendedProperty2("Duration")) & "]" ' 単位は 100ns WScript.Echo "FMTID_AudioSummaryInformation,3 : [" & CStr(objFile.ExtendedProperty(FMTID_AudioSummaryInformation & " 3") ) & "]" ' 単位は 100ns Set objFile = Nothing End If Next Set objFs = Nothing Set objParam = Nothing
あるエクセルのファイルにLIST（A列に呼びだすエクセルファイル名、B列からD列に呼びだしたエクセルに貼り付ける文字列があり、それが100行程度ある)があり、そのLIST A列に書かれているエクセルファイルを開き、その開いたエクセルファイルのある特定のセルにB列からD列にあるセルをそれぞれに貼りつける作業を繰り返すようなマクロはできないでしょうか？ [流れ] LISＴに書いてあるエクセルファイルを呼び出す→文字列を貼りつける→保存(できれば名前を変えて保存(その場合は、LISTのE列に名称を記載)→閉じる→次のLISTのエクセルファイルを開く→それをLISTの最後の行まで終わるまで繰り返す。 よろしくお願いします。
VB6のコンボボックスのテキストプロパティですが、 Combo1.text="test"と入れてもコンボボックスにtestと表示されません。 Form_Loadモジュールに記載するとtestと表示されるのですが、 最初testと表示されていて、コンボボックスの候補を一つ選んで、 今の設定ではその候補は使用できないので、初期状態のtestという表示に戻したいのですが、 testに戻りません。
お世話になります =VLOOKUP($G6,マスタ２!$A$2:$F$27,2,FALSE) で値を取得できる状況で それを$G6が変更されたイベントで値をセルにセットするようにしたいのですがどのようにすればいいでしょうか？ 複数人でコピー＆ペーストしたりするので セルに式を埋め込まずに実現したい事情があります。 よろしくお願いします。
OracleのサーバからAccessのクライアントへ(1)のSQL文を使って Accessのテーブルヘインポートしたいのですが、どのように(2) に付け足せば良いのでしょうか？どなたかご教示願います。 (1) SELECT S.KTN_COD ,K.KTN_MEI FROM T_SYUKA S ,M_KTN K WHERE S.KTN_COD=K.KTN_COD (2) Private Sub abc_Click() Dim adoCnn As Object 'ADODB.Connection Dim adoRec As Object 'ADODB.Recordset Dim tblName As String DoCmd.SetWarnings False Set adoCnn = CreateObject("ADODB.Connection") adoCnn.Open "Driver={Microsoft ODBC for Oracle};" & _ "CONNECTSTRING=dns; UID=hoge; PWD=hoge;" strSQL = "SELECT S.KTN_COD ,K.KTN_MEIFROM T_SYUKA S ,M_KTN K" _ &"WHERE S.KTN_COD=K.KTN_COD" adoCnn.Execute (strSQL) adoCnn.Close Set adoCnn = Nothing Set adoRec = Nothing End Sub
お勧めのVBA勉強法はありますか？ というのも、excelでデータ整理等をやっているのですが、基本だけはWebの優しいマクロ解説ページを読んだだけで、マクロ組んでいるとよくつまずきます。後からもっと別のいい方法があったりで、遠回りしている気がします。 例えば、使用されている領域を色付けしたいと思ったときに 使用されている領域を選択し、selectionで処理していた部分を、 後からusedrangeで指定すれば一発だなぁと思ったり…。
お世話になります。 EXCEL VBAで 以下の処理をしています。 C6の内容に応じて、セルに式を設定するだけなのですが このシートの全然関係ないセルで[Delete]キーを押下した際に 実行時エラー　13 型が一致しません というエラーが発生します。 どういう理由でエラーとなるのでしょうか？ また、どのような対処をすればいいでしょうか？ 以下、実際のコードです Private Sub Worksheet_Change(ByVal Target As Range) If Target = Range("C6") Then If Range("C6").Value = "する" Then Range("I11").Formula = "=C7" Range("I12").Formula = "=C7" Range("I13").Formula = "=C7" Range("I14").Formula = "=C7" Range("J11").Formula = "=C8" Range("J12").Formula = "=C8" Range("J13").Formula = "=C8" Range("J14").Formula = "=C8" Else Range("I11").Formula = "" Range("I12").Formula = "" Range("I13").Formula = "" Range("I14").Formula = "" Range("J11").Formula = "" Range("J12").Formula = "" Range("J13").Formula = "" Range("J14").Formula = "" End If Else End If End Sub
エクセルのセル式の質問で恐縮ですが シート1　の　Ａ列　月日　Ｂ＝時間　15分ピッチ　Ｃ＝データ　　空列に　月日+時間は可能です（が　、下記の検索の為に時間のみ　取り出す方法が分かりません　A10+hour（B10）で　0：00になります） 2014/1/6　19:45　データ1 2014/1/6　20:00　データ2 2014/1/6　20:15　データ3 2014/1/6　20:30　データ4 2014/1/6　20:45　データ5 2014/1/6　21:00　データ6 シート2　Ａ列　月日　Ｂ＝時間　1時間ピッチ　Ｃ＝データ　　空列に　月日+時間は可能です 2014/1/6　19:00　データ60-19 2014/1/6　20:00　データ60-20 2014/1/6　21:00　データ60-21 シート1　に　シート2のデータで　月日と時間が一致する　値を埋め込みたいのです 2014/1/6　19:45　データ1　データ60-19 2014/1/6　20:00　データ2　データ60-20 2014/1/6　20:15　データ3　データ60-20 ＶＢＡでなく　シート1の　Ｄ列に入れる　セル式が欲しいのですが シート1,2　とも　検索の為の　列は利用できます。 よろしくどぞ
エクセル2010で下記コードの矢印の部分でエラーが出てしまいます。 ほぼネットで見つけたコードそのままですが矢印のところで題記のエラーが出てしまいます。 内容はトヨタのホームページの燃料電池車の画像を保存するはずなのですが・・・ どなたかご存知の方ご教示いただけますでしょうか？？？ Sub aaa() GetImageFile "http://toyota.jp/sp/image/e_bn/", "FCV_20140625.jpg" End Sub Sub GetImageFile(ImgName As String, SaveName As String) Dim SaveFileName As String, DownloadFile As String, Ret As Long If ImgName = "" Then Exit Sub SaveFileName = SaveName DownloadFile = ImgName Ret = URLDownloadToFile(0, DownloadFile, SaveFileName, 0, 0)　’←ここです If Ret = 0 Then MsgBox "ダウンロードできました" Else MsgBox "エラーが発生しました" End If End Sub
問題がわかりません(>_<) 課題(UserAveの作成) 選択したセルの範囲の平均を求めるユーザ定義関数を作成しなさい。ただし、セルには整数が入ってい る ものとし、マクロ内でワークシート関数は使用しないこと。 この問題のコードがさっぱりです・・・ どなたか簡単でいいので教えていてだけないでしょうか・・・？
VB6.0で次のようなコーディングをしています。 Dim FNmDic As Variant Dim HelpFile As File Set FNmDic = CreateObject("Scripting.Dictionary") FNmDic.Add Left(HelpFile.Name, 3), HelpFile.Path このFNmDic.Addに２秒もかかってしまいます。 HelpFileは、先頭3文字が数字のファイルを指しており、キーの役目をしています。 HelpFileがローカルにあるファイルをさしている場合は、遅くないのですが、 ほかの端末の共有フォルダにあるファイルを指すとAddが遅いです。 また、この現象はエンドユーザの環境で発生し、私の開発環境では発生していません。 Addを１秒以下にしたいのですが、何か解決の糸口はあるでしょうか？
Visual Studio 2013でプログラムを作っているときにメニューバーを配置し、 「ヘルプ=>バージョン情報」と構成し、バージョン情報をクリックすると、 別で用意したバージョン情報フォームを表示させたいのですが、 'バージョン情報 Private Sub バージョン情報ToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles バージョン情報ToolStripMenuItem.Click ShowDialog(AboutBox1) End Sub としても、 追加情報:既に表示されているフォームをモーダル ダイアログ ボックスとして表示できません。showDialog を呼び出す前に、フォームの Visible プロパティを false にしてください。 と表示されてしまいます。 どのようにすればうまくいくでしょうか。よろしくお願いします。
エクセルを使ってMSSQLに接続したいのですが、エラーがでて接続できません。 なぜでしょうか？ [エラー内容] コンパイルエラー： ユーザー定義型は定義されれいません。 コードの下の部分で発生します。 Dim Cn As New System.Data.SqlClient.SqlConnection [コード] Private Sub CommandButton1_Click() Dim St As String Dim Cn As New System.Data.SqlClient.SqlConnection Dim SQL As System.Data.SqlClient.SqlCommand Dim ServerName As String Dim UserID As String Dim Password As String Dim DatabaseName As String ServerName = "TEST-PC" 'サーバー名(またはIPアドレス) UserID = "sa" 'ユーザーID Password = "password" 'パスワード DatabaseName = "TEST_DB_20140801" 'データベース St = "Server=" & ServerName & ";" & "User ID=" & UserID & ";" & "Password=" & Password & ";" & "Initial Catalog=" & DatabaseName Cn.ConnectionString = St SQL = Cn.CreateCommand SQL.CommandText = "SELECT * FROM LOG_DATA_XLINE" Cn.Open MsgBox (SQL.ExecuteScalar) Cn.Close SQL.Dispose Cn.Dispose End Sub
EXCELのマクロについて質問させてください。 一覧シートから、職種別の各シートへ集計（貼り付け）が出来るような プログラムを作成したいのでやってみたところ、私の知識では上手く出来ませんでした。 お力をお借り出来ると幸いです。 具体的には、一覧シートへ入力後（毎月入力） 『A』　『B』　『E』と分かれた職種別の各シートへ職種別かつ氏名の昇順でソートが掛かった状態で 貼り付け？集計？が出来るようにしたいです。 一覧シートのB列には「A・B・E」のどれかの職種が入力されており 氏名はD列E列へ記載しています。（漢字、カナ表示） A～AD列までデータを記入していますので、全て各シートへ集計出来ると嬉しいのですが・・・ 行は8行目から記載してます。 上記のようにプログラムを組む事は可能でしょうか。 具体的なプログラムも載せて頂けると嬉しいです。 宜しくお願い致します。
Access2010を使用しています。 エクスポートするExcelファイルに画像のような作成日を入れたいのですが どの様にすればよいでしょうか？
特定フォルダにある、iniファイルを変更したいと思っています。 テキストファイルで変更するなら、 TestDateA=1 ↓ TestDateA=5 と変更するのは 1行ずつ読み込み、Replaceで出来ると思うのですが iniファイルとなると特別なのか、調べてみても良く分かりません。 h ttp://yozda.exblog.jp/9552062/ この方が書いている通り、書けば良いのかもしれませんが 自分で理解していない分、このまま使うのは不安です。 クラスを使うとなると余計にわかりません・・・。 ReadLineで読み込み、特定の文字を含んだらReplaceみたいな 方法は使えないでしょうか？ それ以外に何か方法はありますでしょうか？ 以上、よろしくお願い致します。
Beepと記述すると一回だけビープ音が鳴りますが、 ある処理をしている最中、ビープ音を鳴らすことは出来ますでしょうか？
早速ですが WEBクエリーで　下記の値が　セルに取り出せます Last Updated: Friday, 25 Jul 2014 06:00 PM これを　他のセル　と　比較するために　yyyy/mm/dd　に変換したいのですが MIDで　取り出すと　曜日と月のスペル文字列の長さが一定でないので困っています。 何か方法は無いでしょうか If Format(Mid(NKNY.Range("J213"), 15, 10), "yyyy/mm/dd") = Format(NKNY.Cells(10, 2) - 1, "yyyy/mm/dd") Then
35万件以上あるエクセルデータに対して、マクロを使って以下のような処理で重複業を削除したいと思っています。 Sub DeleteOldRow() Dim lastRow As Integer Dim i As Integer Dim j As Integer Dim strVal As String 'B列の最終行を求めます。 lastRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, 2).End(xlUp).Row '1行目から最終行の前まで繰り返します。 For i = 1 To lastRow - 1 'チェックする値を、strValに代入します。 strVal = ActiveSheet.Cells(i, 2).Value '今見てる行から、下をチェックします。 For j = i + 1 To lastRow 'もし、値が同じであれば、 If strVal = ActiveSheet.Cells(j, 2).Value Then '元の行を削除します ActiveSheet.Rows(i).Delete '最終行が１行減ったのでlastRowの値を減らします。 lastRow = lastRow - 1 'チェックしている行を１行前に戻します。 j = j - 1 End If Next j Next i End Sub 上記処理を３５万件あるファイル上でマクロの実行すると、オーバーフローしてしまいました。マクロ側で対象ファイルを読み込むなどして、処理を軽くするやり方はありますでしょうか。上記処理にどのような処理を加えればスムーズに処理されるでしょうか。
例えば、テキストボックス内でF1を押した時に あるプログラムを走らせたいのですが、 F1を押したかどうかは、どうやって判定すれば良いのでしょうか？
VB6でForm内にCommandButtonがいくつか有ります。 各CommandButtonはClickするとShellオブジェクトでファイルを開く様になっています。 やりたいことは 2つのCommandButton間をDragDrop？によりCaptionを入れ替えたいです。 (CommandButton間をマウスDragDropでCaption名入れ替え) MouseDownとDragDropイベントで何とかなると思いましたがうまくいきません。 Dim dd As Integer Private Sub Command1_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single) If Button = vbLeftButton Then dd = 1 'CommandボタンNo, End If End Sub Private Sub Command2_DragDrop(Source As Control, X As Single, Y As Single) Dim cn As String cn = Command2.Caption Command2.Caption = Controls("Command" & dd).Caption Controls("Command" & dd).Caption = cn End Sub CommandButtonプロパティでDragModeを自動にするとShellオブジェクトでファイルが開かないし サイトで調べたところファイルの移動やコマンド自体の移動などで分かりませんでした。 ご教授お願い致します。
初めて質問せて頂ます 指定した文字だけを変更することは可能なのですが セル内にある指定した文字全部の色が変わらなくて困っています マクロ初心者なもので大体インターネットから拾ってきたものをつなぎ合わせて使う程度の能力です どなたか教えていただけませんでしょうか？ ちなみに「質問No.2769123」を参考にしましたがセルに含まれる文字は１つしか色が変わりません 例）セル内に指定した文字が10個あった場合全部色を変えたいと思っています 1つのセル内の文字「ABCD、ABCD、ABCD、ABCD、ABCD、ABBA、ABCD、ABBA、ABBA、ABCD…」 上記の場合ABBAの文字を全部赤に変えたいといった感じです どうかよろしくお願いいたします 経緯としては検索した文字がヒットしたらその文字の色を変更したいと思ったからです
Excel2013 Enterキーを押すと隣りのセルに移動ではなく、次に入力したいセルにカーソルが移動するようにしたいです。 たとえば、 必要事項を入力する書類で、B2のセルに入力したら次はD5のセルに入力、次はA6に入力といった書類あり、Enterキーを押して次の入力セルに移動するようにしたい。また、書類の書式を崩されたくないのでシート保護して使いたいです。 Enterで進み、戻る時はUPキーか、↑キーなどで設定したいと考えてます。 どなたか、VBで教えてくださる方お願いします。
Excel2013 指定した文字の個数を求めたい。 例えば、 A1からJ1に入力された"a"の数をK1に表示。 続いてA2からJ2に入力された"b"の数をK2に表示。 関数ではなくて、VBでコードを書きたいのですが、どなたがVBに詳しい方教えて下さい。よろしくお願いします。
文字変数を内容により並び替えたいのですが。 moji(1)="aaaaa":moji(2)="cc":moji(3)="b"のとき 1,3,2という結果が出せるプログラムを教えていただけないでしょうか。 文字変数の中身が同じだったりすると、うまく動きません。
★ブックＢの売上1月、売上2月など「売上」を含むシート（"売上*")の、ソート後のSUBTOTALの数値を、 　別ブックＡで拾い上げ一つのセルで合算表示することは可能ですか？ ブックＢ内であればワークシート関数Indirectで出来ましたが、別ブックとなるとマクロ作成時にIndirect関数を挿入することは不可能ですか。 ★を実行したい場合に他に方法があれば併せて教えて頂けるとありがたいです。
Office2013 OSは8を使ってます。 Excelで日付に対して曜日のほかに大安とか仏滅とか友引とか六曜も自動で表示したいのですが、全然分かりません。 関数でもVBでも構いません、どなたか詳しい方教えて下さい。 お願いします。
VB6ですでに存在しているcsvファイルに書き込みをするプログラムを作っているのですが、 書き込みしたいcsvファイルが開いているとエラーになって書き込みができません。 なので、「書き込みしたいファイルが開いているか判定」して、 「開いている場合は閉じたい」のですが、どうすれば良いでしょうか? 開いているファイルはVB6で開いたのではなくて、ユーザーが開いたファイルになります。
子供の勉強時間表を作成しようと思っています。 セルに何時～何時までと入力すると、指定範囲内のセルの背景に色がつくというものです。 ＶＢＡ初心者なので、どなたかご教授願います。 宜しくお願い致します。 　　　　　　　　　　　　　8:30　　9：00　　9：30　　10：00 10：30 11：00 11：30 12：00 12：30 Ａ　　8：30～10：00 Ｂ　10：30～12：30 Ｃ　11：00～12：00
お世話になっております。 Visual Studio2013で、テキストボックスに入力された値をmdbへ挿入しようと思っています。 フォーム上にTextBox1～ TextBox100があり、それぞれの値を１つずつフィールド へ挿入したいのですが、INSERT文へ100個もフィールド名を書かないように ループさせる方法はあるのでしょうか？ For i = 1 to 100 sSql = "INSERT INTO table1(？？？) VALUES('" & Me.Controls("TextBox" & i).Text & "');" のようなイメージです・・・。 初心者の質問で申し訳ありませんが、よろしくお願いします。
Visual Basic を用いて、TextBoxから入力した 数字について、ボタン１を押すと平方根を求め、Labelに書き出し、 ボタン２を押すとリセットされるプログラムを 作りたいのですが、全くわかりません。 コピペしたらプログラムが動くコードを教えてください。 お願いします。
vba初心者です。下記のようにプログラミングしましたがもっといいプログラムの仕方はないでしょうか。ちょっとごちゃごちゃしていて見にくいです。どなかたお力をお貸しください。 Private Sub データUPDATE輸入_Click() ActiveSheet.Unprotect Dim Line As String Dim Maxrow As String Sheets("Invoice").Select Line = 5 　 Do Until Cells(Line, 7).Value = "" On Error Resume Next 'A列の空欄をコピーして埋める If Cells(5, 1).Value = "" Then Cells(Line, 1).Value = "" ElseIf Cells(Line, 1).Value = "" Then Cells(Line, 1).Value = Cells(Line - 1, 1).Value End If 'B列の空欄をコピーして埋める If Cells(5, 2).Value = "" Then Cells(Line, 2).Value = "" ElseIf Cells(Line, 2).Value = "" Then Cells(Line, 2).Value = Cells(Line - 1, 2).Value End If 'C列の空欄をコピーして埋める If Cells(5, 3).Value = "" Then Cells(Line, 3).Value = "" ElseIf Cells(Line, 3).Value = "" Then Cells(Line, 3).Value = Cells(Line - 1, 3).Value End If 'D列の空欄をコピーして埋める If Cells(5, 4).Value = "" Then Cells(Line, 4).Value = "" ElseIf Cells(Line, 4).Value = "" Then Cells(Line, 4).Value = Cells(Line - 1, 4).Value End If 'E列の文字を「輸入シート」から検索しF列に貼り付ける If Cells(Line, 5).Value = "" Then Cells(Line, 5).Value = Cells(Line - 1, 5).Value End If Cells(Line, 6).Value = Application.WorksheetFunction.VLookup(Cells(Line, 5).Value, Worksheets("輸入Parts").Range("A2:R20000"), 2, 0) 'E列を検索しデータが存在しない場合はF列に「データがありません」を表記 If Cells(Line, 6).Value = "" Then Cells(Line, 6).Value = "データがありません" GoTo コピー貼り付け End If コピー貼り付け: If Cells(Line, 6).Value = "データがありません" Then Cells(Line, 5).Copy 'コピーする Maxrow = Worksheets("輸入Parts").Range("A1").End(xlDown).Row + 1 Worksheets("輸入Parts").Range("A" & Maxrow).PasteSpecial Paste:=xlPasteValues '値を貼り付け End If 'H列の空欄をコピーして埋める If Cells(5, 12).Value = "" Then Cells(Line, 12).Value = "" ElseIf Cells(Line, 12).Value = "" Then Cells(Line, 12).Value = Cells(Line - 1, 12).Value End If 'E列の文字を「輸入シート」から検索しZ列に貼り付ける Cells(Line, 26).Value = Application.WorksheetFunction.VLookup(Cells(Line, 5).Value, Worksheets("輸入Parts").Range("A2:R20000"), 3, 0) 'E列を検索しデータが存在しない場合はZ列に「データがありません」を表記 If Cells(Line, 26).Value = "" Then Cells(Line, 26).Value = "データがありません" End If 'AD列の空欄をコピーして埋める If Cells(5, 30).Value = "" Then Cells(Line, 30).Value = "" ElseIf Cells(Line, 30).Value = "" Then Cells(Line, 30).Value = Cells(Line - 1, 30).Value End If 'E列の文字を「輸入シート」から検索しAM列に貼り付ける Cells(Line, 39).Value = Application.WorksheetFunction.VLookup(Cells(Line, 5).Value, Worksheets("輸入Parts").Range("A2:R20000"), 18, 0) 'E列を検索しデータが存在しない場合はAM列に「データがありません」を表記 If Cells(Line, 39).Value = "" Then Cells(Line, 39).Value = "データがありません" End If '「Unit price」の計算・円建と外貨建が合わさったインボイスの場合の合計金額 If Cells(Line, 14).Value = "" Then Cells(Line, 13).Value = Cells(Line, 17).Value * Cells(Line, 33).Value / Cells(Line, 7).Value Else Cells(Line, 17).Value = Application.WorksheetFunction.RoundDown(Cells(Line, 14).Value * Cells(Line, 16), 0) Cells(Line, 15).Value = Cells(Line, 16).Value * Cells(Line, 33).Value / Cells(Line, 7).Value End If 'T.Invoice Priceの計算 Cells(Line, 23).Value = Application.WorksheetFunction.Sum(Cells(Line, 17), Cells(Line, 18), Cells(Line, 19), Cells(Line, 20), Cells(Line, 21), Cells(Line, 22)) 'VLOOKUP関数が終わり、エラーが発生したら止まる On Error GoTo 0 '次の行に移り最後の行まで検索 Line = Line + 1 Loop End Sub
VBA初心者です。下記のようにプログラムしましたがうまくいかなくて困ってます。どなたかお力をお貸しください。内容としましては輸入Partsのシートからコピーして商品内容確認のシートのセルB17に貼り付けたいです。輸入Partsシートで3列目の空白を探し同じ行の1列目をコピーします。商品内容確認のシートのセルB17にはカーソルは動いているようですが貼りつきません。 Private Sub 商品内容確認2_Click() If MsgBox("商品内容確認へ移動しますか？", 33, "移動の確認") = 2 Then MsgBox "処理を中止します。" Range("A2").Select Exit Sub End If Dim Line As String Dim Maxrow As String Worksheets("輸入Parts").Select Line = 2 Do Until Cells(Line, 1).Value = "" On Error Resume Next If Cells(Line, 3).Value = "" Then Cells(Line, 1).Copy 'コピーする Maxrow = Worksheets("商品内容確認").Range("B17").End(xlDown).Row + 1 Worksheets("商品内容確認").Range("B" & Maxrow).PasteSpecial Paste:=xlPasteValues '値を貼り付け End If On Error GoTo 0 '次の行に移り最後の行まで検索 Line = Line + 1 Loop Worksheets("商品内容確認").Visible = True Worksheets("商品内容確認").Select Worksheets("商品内容確認").Range("B6").Select Worksheets("商品内容確認").輸入Partsシート2.Visible = True Worksheets("商品内容確認").輸出Partsシート2.Visible = False Worksheets("輸入Parts").Visible = False End Sub
私は毎朝、東証１部銘柄の株価時系列を以下のプログラムでダウンロードしていますが、一部の銘柄で、前日の株価だけがダウンロードされていないという事象が発生しています。その銘柄のＷｅｂページの時系列表を見ますと、やはり前日分が抜け、前々日分から表示されています。しかし、日付設定の後の「表示」ボタンをクリックしますと、前日分が正常に表示されます。マクロで、この「表示」ボタンを押すような設定は出来るんでしょうか。 Dim X As Worksheet Set X = Worksheets.Add X.Name = "INDB" Sheets("INDB").Select URLWEB = "http://info.finance.yahoo.co.jp/history/?code=" KIKAN = ".t&sy=" & END年 & "&sm=" & END月 & "&sd=" & END日 & "&ey=" & _ FST年 & "&em=" & FST月 & "&ed=" & FST日 & "&tm=d&=" For I = 1 To CNT With ActiveSheet.QueryTables.Add(Connection:= _ "URL;" & URLWEB & CD(I) & KIKAN, Destination:=Range("$A$1")) .BackgroundQuery = True .RefreshStyle = xlInsertDeleteCells .AdjustColumnWidth = True .WebSelectionType = xlEntirePage .WebFormatting = xlWebFormattingNone .Refresh BackgroundQuery:=False End With 時系列データー( I ) = Webの時系列データー 　　'時系列データーを取り込みます。 Application.DisplayAlerts = False Sheets("INDB").Cells.Clear Application.DisplayAlerts = False Next I Set X = Nothing
Visual Studio Express 2013 Shell("cmd /c copy D:\aaa.txt " & textbox1.text & ".txt",AppWinStyle.Hide,True) 例ですが、 テキストボックスに任意の文字列を入力して、 aaa.txtをコピーするとします。 aaa.txtを固定の場所に置くのではなく、実行ファイル内に保持していて、 どのPCでも実行できるように出来ないでしょうか？
早速ですが =SUM(INDIRECT("g"&P25&":g"&P26))　自分のシートは無問題 でも、 =SUM(INDIRECT("損益!M"&P25&":損益!M"&P26))　が　#REF!　となります。 p25,p26　は　それぞれ　合計したい行の数値です。 最終は =SUMIF(indirect("損益!M"&q25&":損益!M" &q26,">0", "損益!M"&q25&": 損益!M"&q26))) これなのですが・・・・ どこで　間違ったのでしょうか よろしくどうぞ
Excel2013です。 別シートに名簿、作業用シートで名前を検索する、別シートにある名簿から検索された名前を選択すると、その名前の住所や電話番号が作業用シートに表示出来るようにしたいのですが、どなたかVBに詳しい方教えて下さい。 出来れば、名簿に無い場合は新規に登録出来たり、変更があったりしたら編集も出来て、重複してる場合は削除などが出来ればいいのですが。
Visual Basic を用いて、TextBoxから入力した 数字について、平方根を求め、Labelに書き出す プログラムを作りたいのですが、全くわかりません。 コピペしたらプログラムが動くコードを教えてください。 お願いします。
実行中の他のアプリのパスを取得する方法を教えてください。 プロセスの一覧の取得はできるんですが、インストールされている場所が取得できません。 例えば「エクセル」だとプロセス名の「EXCEL」は取得できるんですが、「C:\Program Files\Microsoft Office\Office\EXCEL.EXE」も取得したいのです。 例えば「メモ帳l」だとプロセス名の「notepad」は取得できるんですが、「C:WINDOWS\system32\notepad.exe」も取得したいのです。 検索してみてるんですが、ありそうでないんです。 OSはWindowsXP、VisualBasic2008で取得したいのです。 よろしくお願いします。
任意の数字を入力し、Len関数とMid関数を使って2進数を10進数に変換するというプログラムを作っているのですが、うまくいきません。 コードは Dim a　 As Integer Dim b　 As Integeｒ Dim i　　As Integer a = Val(TextBox1.Text) For i = Len(a) To 1 Step -1 If Mid(a, Len(a), 1) = "1" Then b += 2 ^ (i - 1) End If Next Label3.Text = b 　　　End Sub 上記のものが作ったコードです。 問題点の指摘をよろしくお願いします。
visual basicのeventとcontrolについての質問です。 　初心者で苦労しています。以下のようなcodeingをしましたが上手く行きません。宜しくお願いします。 1.下記のcall updatefileによりupdatefile内でcombobox内のdataを設定します。これは次のdialogで 　　設定どおりに出ています。しかし元のsub startdialog1に帰ってdialogを表示してみるとcombobox 　　内は空となっています。　　subroutineが変わるとformの　controlは消えるのでしょうか。 　　もしそうならどの様にすれば良いのでしょうか。 　　(pushdata変数等をpublicとして再度comboに入れることもやりましたがNG) ２．STARTDIALOG1の初めに　RADIO BUTTONの変更のCODEが有りますが、此処でEVENTが 　　　発生しUPDATEFILEに行きます。 　　　DIALOGを出すまでは初期値を設定しDIALOG上でCLICK等して変更をするCODEなので 　　　不具合です。　(ほかにもいろいろ同じCODEが入っていますので） 　　　CODE上の設定変更はEVENTが発生しないように、DIALOGからの変更はEVENT発生としたい 　　　のですがどの様にしたら良いでしょうか。(普通そうなので何か勘違いしてるかも) 　 INTERNETで見るとAddHandler,AddressOf,REmoveHandlerなどが記載されていますが、 　　　書き方と何処に書くのか判りません。(本当に必要かも?) 　　　よろしくお願いします。 　　　(以下のcodeは読みやすいように簡略化しています、code errorは大目に見て下さい。 ---------------------Form1.vbに記載---------------------------------------　　　 Sub STARTDIALOG1() 　　　'此処から処理が始まる with cform2 as Fform2 .Radio_btn1.Checked = True　　’ここへくるとbuttonのeventが発生,routineにいき,updatefileへいく Call UpdatePfile(1) 'ここはcomboboxの初期値を設定する(UPDATEPFILEを使う) .ShowDialog()　　 　 ’UpdatateFileでは入っていたがCOMOBOXの中は空になっている 　　　　　　　　　　　　　　この後comboboxのdataの選択などをdialogue上で設定値を変更する。 end with end sub -----------------------form1.vbに記載---------------------------------- sub UpdatePfile(ByVal cntlNO) 'PushDataはこの前にREADして設定している、keがそのDATAの個数 For k = 1 To ke cForm2.Combo_P.Items.Add(pushdata(k))　’COMBOBOX Comb_Pに一覧として入れる Next k cForm2.ShowDialog()　　　'ここではCOMBOBOXにPUSHDATAが入ったLISTがでる end sub --------------------------------------------------------------------------- DisalogはForm2に作成 　　　radioボタン　Radio_btn1とRadio_btn2,combobox combo_P等をsetしている '---------------------------Form2.vbに記載------------------------------------ Private Sub push_button(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Radio_BTN1.CheckedChanged,Radio_BTN2.CheckChanged Dim cls As Form1 RDBTN = 1 If RDBTN > 0 Then Call cls.UpdatePfile(RDBTN) end Sub
Basp21を使用して、メール送信プログラム(Excel VBA)を作成しました。 ５台のパソコン(同一仕様)の内１台のパソコンのみエラーが発生してメール送信ができません。 他の４台のPCと環境の相違は無いと思いますが、原因が解りません。 パソコンの初期化をすれば、正常に動作すると思いますが、 エラー発生の都度、初期化もできません。 どなたか、ご教示をよろしくお願いします。 PC環境 　OS　 ：Win7 Pro　64Bit環境 　Excel：2013 32Bit 　セキュリティソフト：無効 コンポーネントの組み込み 　Bsmtp.dll(587 Version) を C:\Windows\SysWOW64 のフォルダーにコピー エラーメッセージ(1秒程度でリターン) 　HELO BSMTP.DLL helo BSMTP.DLL 確認項目 　1)通常のメール送受信は問題無し(Outlook) 　2)Bsmtpのセキュリティは、正常な他のPCと同じ 　3)Administratorsで実行してもエラー発生(ユーザー権限の問題) 　4)エラー発生時に、Bsmtp.dllの削除操作 　　　Excelによって開かれているため削除不可のメッセージ(dllの読込み確認) 　5)架空のサーバーを指定：Cant connect Server 11001のメッセージ 　6)LANケーブルを抜く　 ：Cant connect Server 11004 　7)Excelの再インストール(レジストリも削除)しても同じ(Excelのチェック) 　8)Bsmtp.dllをコピーしなおしても同じ(Bsmtpのチェック) プログラム 　Private Declare Function SendMail Lib "BSMTP.dll" _ (szServer As String, szTo As String, szFrom As String, _ szSubject As String, szBody As String, szFile As String) As String strSMTP="aaa.co.jp" strPort="25" strTimeOut="60" strToAddr="a123@aaa.co.jp" strFromAddr="b123@aaa.co.jp" strSubj="メールテスト" 　　strBody="本文" strAttach="" strSV_Name = strSMTP & ":" & strPort & ":" & strTimeOut strMailto = strToAddr strMailFrom = strFromAddr strRC = SendMail(strSV_Name, strMailto, strMailFrom, strSubj, _ strBody, strAttach) If strRC <> "" Then MsgBox "エラー発生" & strRC End If 以上 よろしくお願いします
はじめまして。 マクロ全くの初心者です。 詳しい方、優しく教えていたたげると幸いです。 エクセル2010または2013でマクロを作成したいと思っています。今までマクロの作成は自動保存？マクロ記録→マクロ記録終了のボタンを使って条件付き書式等しか作成したことがありません。 今回は ピクチャの中のデジカメの画像を、選択したセルに挿入し、サイズを変更したいです。 他社から送られてきたデータにマクロが設定してあり、そのようにしたいです。 挿入したいセルをクリック→マクロの設定されているボタンをクリック→ピクチャが開く→挿入したい画像を選択→選択したセルに画像が挿入され同時にサイズも変更される 自分で少しやってみたのですが、画像を選べません（記録した時の画像が挿入されてしまう）。 ボタンの挿入方法は大丈夫です。 他の方の質問も参考にしたのですがうまくいかなくて、、、どうしたらいいかわかりません。 是非ご教授ください。 よろしくお願い致します。
デスクトップの\dataフォルダに、名前を付け替えたいファイルが多数あります。 それらのファイル名（旧名）と、変更したい名前（新名）は、エクセル上の２列に 入力済みです。VBAを使って、ｄｏｓプロンプトのＲＥＮを実行しようとしましたが、 多くのファイル名にスペースが含まれるせいか、大半が変更できませんでした。 良い方法があれば、教えてください。どうかよろしくお願いします。 ※作成したプロシージャは以下の通りです。 Sub ファイル名変更() Dim カウンタ As Integer For カウンタ = 2 To 1000 Dim wsh As Object, wexec As Object, cmd As String Dim 旧名 As String, 新名 As String Set wsh = CreateObject("wscript.shell") 旧名 = Cells(カウンタ, 1).Value 　　　 '旧名はA列にある 新名 = Cells(カウンタ, 2).Value 　　　'新名はB列にある cmd = "ren c:\users\me\desktop\data\" & 旧名 & " " & 新名 Set wexec = wsh.Exec("%comspec% /c " & cmd) Set wexec = Nothing Set wsh = Nothing Next End Sub
はじめまして。VBAを始めて間もないので教えてください。 今現在数千行のリストのデータを、決められたフォーマットの表にコピー&ペーストし、セルの書式設定でユーザー定義を変えるという作業をしています。 表のフォーマットは１種類なので、リストのD列目のデータを１つずつ対応する名前のファイルを開いてはH6に、E列目のデータはI6にペーストし…（そして定義を変え１つのファイルずつ保存する）という単純作業をボタンひとつで自動的に行えるVBAを創ろうしてます。以下のサイトなどを参考にしてプログラムを組み直して 『VBAで他のファイルのセルをコピーして貼り付けるマクロを作成しましたが、 どうし...』 http://detail.chiebukuro.yahoo.co.jp/qa/question … 『第4回 セルの内容と同じ名前のブックを開く 1/4』 http://www.moug.net/vba/beginners/exvba004-1.html 『プログラムの肝！ 条件分岐と繰り返しの基本文法とさまざまな書き方 (1/4)』 http://www.atmarkit.co.jp/ait/articles/1403/04/n … いるのですが、デスクトップのフォルダ内にあるセルと同じ名前のファイルを開く場面などでエラーを 起こしデバックがうまくできません。 どういったマクロを組めばうまくいきますでしょうか？ またコンピュータに負荷があまりかからないで、開いてはペーストして保存という行為を数千回繰り返す方法を教えてください。 お願いします。
ご教授ください エクセル2010を使用しています。 OSはWin7です。 エクセルVBAでユーザーフォームを作成し そこに入力した値からSQLを発行して データを取るようにしたいのですが どのようにすればいいのでしょうか。 select day from AAA where day = ******************** ※　*にユーザーフォームから入力した値を渡したいのです。 　　 *はyyyymmdd形式で入力します。 以上、よろしくお願いします。
VBAで数値をカウントするマクロを作りました。 　Dim Co1 As Integer Co1 = WorksheetFunction.CountIf(Range(Cells(○, ○), Cells(○, ○)), "<1") Dim Co2 As Integer Co2 = WorksheetFunction.CountIf(Range(Cells(○, ○), Cells(○, ○)), "<2") Dim Co3 As Integer Co3 = WorksheetFunction.CountIf(Range(Cells(○, ○), Cells(○, ○)), "<3") Dim Co4 As Integer Co4 = WorksheetFunction.CountIf(Range(Cells(○, ○), Cells(○, ○)), "<4") Dim Co5 As Integer Co5 = WorksheetFunction.CountIf(Range(Cells(○, ○), Cells(○, ○)), "<5") Dim Co6 As Integer Co6 = WorksheetFunction.CountIf(Range(Cells(○, ○), Cells(○, ○)), "<6") Dim Co7 As Integer Co7 = WorksheetFunction.CountIf(Range(Cells(○, ○), Cells(○, ○)), "<7") Dim Co8 As Integer Co8 = WorksheetFunction.CountIf(Range(Cells(○, ○), Cells(○, ○)), "<8") Dim Co9 As Integer Co9 = WorksheetFunction.CountIf(Range(Cells(○, ○), Cells(○, ○)), "<9") Dim Co10 As Integer Co10 = WorksheetFunction.CountIf(Range(Cells(○, ○), Cells(○, ○)), "<10") Dim Co11 As Integer Co11 = WorksheetFunction.CountIf(Range(Cells(○, ○), Cells(○, ○)), ">=10") Cells(2, 1) = Co1 Cells(3, 1) = Co2 - Co1 Cells(4, 1) = Co3 - Co2 Cells(5, 1) = Co4 - Co3 Cells(6, 1) = Co5 - Co4 Cells(7, 1) = Co6 - Co5 Cells(8, 1) = Co7 - Co6 Cells(9, 1) = Co8 - Co7 Cells(10, 1) = Co9 - Co8 Cells(11, 1) = Co10 - Co9 Cells(12, 1) = Co11 Cells(2, 1) = "0～0.999" Cells(3, 1) = "1～1.999" Cells(4, 1) = "2～2.999" Cells(5, 1) = "3～3.999" Cells(6, 1) = "4～4.999" Cells(7, 1) = "5～5.999" Cells(8, 1) = "6～6.999" Cells(9, 1) = "7～7.999" Cells(10, 1) = "8～8.999" Cells(11, 1) = "9～9.999" Cells(12, 1) = "10～" これを短くする方法を教えてください。
いつもお世話になります。 この度仕事上で、壁に当たってしまいましたのでご質問させて頂きます。 WindowsXPで作られている、バッチからプログラム(引数あり)を実行する処理をWindows7に載せ替えているのですが、ここで動作の差異が発生しました。 Environment.CommandLineで引数を取得しているのですが、WindowsXPで実行すると、プログラムパスと引数との間の空白は、１ケタ分になりますが、全く同じプログラムをWindows7で実行すると、空白が２ケタとなります。 プログラム上は、半角スペースをsplitさせているので、引数を参照する添え字が変わってしまい、処理が正常に行われません。 皆様の中で、この様な経験をされた方、アドバイスをお願いします。 【言語】 　VB2008 【テスト端末】 　Windows7 SP1 　WindowsXP SP2　←ツッコまないでください^^; 【テストＰＧ処理概要】 　・Environment.CommandLineにて引数を取得 　・split関数にて動的配列へ格納 　・配列全てをmsgboxへ表示 【動作結果】 　≪Windows7≫ 　　・Environment.CommandLine取得時 　　　　「C:\test.exe**ABC」　※便宜上、半角スペースを*で表す 　　・配列表示 　　　　添え字０：C:\test.exe 　　　　添え字１： 　　　　添え字２：ABC 　≪WindowsXP≫ 　　・Environment.CommandLine取得時 　　　　「C:\test.exe*ABC」　※便宜上、半角スペースを*で表す 　　・配列表示 　　　　添え字０：C:\test.exe 　　　　添え字１：ABC
お初にお目にかかります 過去の質問を見ていて http://oshiete.goo.ne.jp/qa/8633081.html この方の質問と同じことを私もやりたいと思い NO2の方の回答と同じVBSファイルを作成して 起動しましたが 失敗しました -2147417848 とエラーが表示されてしまいます。 環境はwin7 64bitとExcel2007です。 なんとか私の環境でも動くようにならないでしょうか？ よろしくお願いいたします。
VisualStudio2008で、Access2010のデータベースからデータ抽出を行えるアプリを作っています。 このときＳＱＬ文を用いてAccessからデータ抽出を行うんですかね？ そもそもVisualStudio、SQL、Accessそれぞれがどのように関係しているのかわかりません。 いくつかサイトを見て回ったのですが・・・ 教えてほしいこと １．データ抽出アプリを作るにあたってVisualStudio、SQL、Accessの各々がどのような役割を果たすか ２．Accessのデータベースの形式は空or Webどちらが有効なのか ３．VisualStudioでデータの抽出を行う方法 長くなりましたがよろしくお願いします。 開発言語はＶＢで、私自身は簡単なプログラムであれば理解できるレベルです
Fortranのread/writeをＶＢへの書き換え方を教えて下さい。 他の方の作られたfortran.90のprogramをvisual basicに書きなおす作業をしています。その中の下記のfileのaccessが上手出来ません。このなかに有るbinary,とかbig_endianが原因のようです。 (これの無いfile accessの箇所は問題なく出来ました。) program内でdataをfileに書込み保存して蓄積しているようで、後日このdataをreadして使うようになっていますので新しくfileを作り直すわけにもいきません。 いろいろとcodeを入れてみたが、結果は文字化けばかりで10日も費してしまいました。 binary,bigendianなどの理屈が判っていないのでどうしょうもないと感じました。 どうか下記のfortranをVisual Basicへの書き変え方をご教授お願いします。 REAL ShipDim(17) '読み込みの時 　 filename = 'c:\pbcal\pbcal\pushdata\'//'push04' open (3,file= filename, status='old', & & form='BINARY', convert='BIG_ENDIAN',err=930) DO 10 J= 1,17 read(3) shipDim(j) 10 CONTINUE 　　　　　（中略)　　'見やすいように簡略化しています。 CLOSE (3,STATUS='KEEP') 　 '書込みの時はopenは下記で、後readをwriteに変えただけです。 open (3,file= filename, status=pstatus,form='BINARY', convert='BIG_ENDIAN',err=940) VBでTRYしたことの一例 　　　　Dim dat() As Byte = New Byte(-1) {} 　 Dim sr As System.IO.Stream = Nothing 　 Dim br As System.IO.BinaryReader = Nothing Dim strf As String = filepath & "push04" 'filepathは適当にしている 　　 sr = System.IO.File.Open(strf, _ 　　　　　　 System.IO.FileMode.Open, System.IO.FileAccess.Read) br = New System.IO.BinaryReader(sr) ReDim dat(sr.Length - 1) dat = br.ReadBytes(sr.Length) 　　　　 dat に=572個の2-3桁の数字が入っています。encodingなどでためしてみたが文字化け 　　　　ばかりです。 　　　(System.Text.Encoding.GetEncoding("＊＊＊＊").GetString(dat) など） 　　　　　 　　どうかよろしくお願いします。
VBAで文字列の抜き出しの方法を教えてください。 同様な質問があり、参考にしてみたのですがうまくいきません。 お分かりの方がいましたらご享受お願いいたします。 30~45字からなる文字列があります。 その中に特定の文字列が２つあり、そのうちの最初の特定文字列に続く文字２つ目の特定文字列前までを抜き出したいのですがうまくいきません。 具体的には abcdefghi GN=12jikl PE=fghj456 という文字列のなかから"GN="と"PE="の中間の文字を取り出したいのですが、 自分で書いたものでは"PE="以上が抜き出され、"GN="より前の文字列を抜き出せませんでした。 GN=......, PE=......の文字数はそれぞれ不規則です。また、GN=...よりも前の文字数も不規則です。 以下が作成したものです。 Dim i As Integer Dim Srch As String Dim Btwn As String Const Chr1 As String = "GN " Const Chr2 As String = "PE" Dim m As String Set sheetobj = ThisWorkbook.Worksheets("A") With sheeobj lastrow = sheetobj.Cells(sheetobj.Rows.Count, 10).End(xlUp).Row For i = 2 To lastrow Srch = sheetobj.Cells(i, 10) Btwn = Mid(Srch, InStr(Srch, Chr1) + 1, InStr(Srch, Chr2) - InStr(Srch, Chr1) - 1) sheetobj.Cells(i, 9) = Btwn Next i End With End Sub なにかいい方法があれば教えて頂けたらと思います。 よろしくお願い致します。
エクセルのマクロで以下の事を行いたいのですが、上手く行かずに悩んでおります。 どなたかご教示ください＞＜ 前提：範囲指定した部分をcsvで出力 1.csvの保存フォルダを指定したい （\\192.168~などのネットワークドライブ） 2.形式はデフォルトでcsvを選択した状態にしたい 3.ファイル名を「年月日売上表」にしたいので、デフォルトでファイル名部分に「売上表」と入れたい 年月日は都度手動で変更して保存したいので、上記のフォルダ選択→名前を付けるところまでとマクロで行いたい。 どなたかお知恵をお貸し下さい。
Excelのオートシェイプをテキストデータに変化するVBAを作成したいです ただし対象となるオートシェイプは複数のオートシェイプがグループ化された グループオブジェクトになっています それら特定のパターンを持つオートシェイプオブジェクトの一群があり 1つ1つには想定される名称が存在します 具体的な操作としては複数のオートシェイプオブジェクトを横に並べたイメージダイアグラムを 作成し、それらにそって対応するテキストを配置していきたいというものです このようなオートシェイプの情報をうまく拾う方法、テキストデータと紐づける方法はありませんでしょうか よろしくお願いいたします
ExcelのVBAについて VBA全くの初心者です。 以下のような処理を行いたいのですが、どなたかご教授をお願いします。 以下のように支店(1)～(3)のシートがあります。 １．入力シートに調べたい商品Ｎｏ・商品名・備考を入力する（複数行あり） ２．マクロを実行すると、商品Ｎｏを検索対象として支店(1)～(3)シートをチェックし、 　　一致しない行を不一致データシートに出力する もう一つ別のマクロで、 １．入力シートに調べたい商品Ｎｏ・商品名・備考を入力する（複数行あり） ２．マクロを実行すると、商品Ｎｏを検索対象として支店(1)～(3)シートをチェックし、、 　　一致する行を一致データシートに出力し、Ｄ列に対象データがあるシート名を表示する 　　※可能でしたら、Ｅ列に対象データがある行番号も表示する -------------------------------- シート名:支店(1) Ａ　　　　　　Ｂ　　　　　Ｃ 商品Ｎｏ　　　商品名　　　備考 ０１１　　　　商品Ａ　　　備考Ａ ００９　　　　商品Ｂ　　　備考Ｂ ０１５　　　　商品Ｃ　　　備考Ｃ -------------------------------- シート名:支店(2) Ａ　　　　　　Ｂ　　　　　Ｃ 商品Ｎｏ　　　商品名　　　備考 ００８　　　　商品Ａ　　　備考Ａ ０２３　　　　商品Ｂ　　　備考Ｂ ００４　　　　商品Ｃ　　　備考Ｃ -------------------------------- シート名:支店(3) Ａ　　　　　　Ｂ　　　　　Ｃ 商品Ｎｏ　　　商品名　　　備考 ００７　　　　商品Ａ　　　備考Ａ ０３３　　　　商品Ｂ　　　備考Ｂ ０１８　　　　商品Ｃ　　　備考Ｃ -------------------------------- シート名:入力シート Ａ　　　　　　Ｂ　　　　　Ｃ 商品Ｎｏ　　　商品名　　　備考 ※ここに複数行入力する -------------------------------- シート名：不一致データシート Ａ　　　　　　Ｂ　　　　　Ｃ 商品Ｎｏ　　　商品名　　　備考 ※ここに出力される -------------------------------- シート名：一致データシート Ａ　　　　　　Ｂ　　　　　Ｃ 商品Ｎｏ　　　商品名　　　備考 ※ここに出力される
下記の様なコードがあり、EXCELのデータを別EXCELの指定シートの日付欄と合致させ、データを 貼り付けるという内容です。 ★部の所で実行時エラー　'1004':RangeクラスのSelectメソッドが失敗しました。となってしまいます。 なぜか不明確なためアドバイスを宜しくお願い致します。 K2 = Range("K2") K3 = Range("K3") Dim wb As String Dim dy As String Dim dy2 As String Dim a As String dy = Range("K5") dy2 = Range("M1") Range("R5:R41").Copy wb = "D:\Documents and Settings\ssk\デスクトップ\" & dy & ".xls" Workbooks.Open (wb) Workbooks(dy & ".xls").Sheets("data").Select For n = 2 To 100 Step 1 a = Cells(1, n).Value If Cells(1, n).Value = dy2 Then Worksheets("data").Activate Cells(3, n).PasteSpecial Paste:=xlPasteAll Application.CutCopyMode = False End If Next 'err1: 'Excel.Application.CutCopyMode = False 'With ThisWorkbook 'If Workbooks.Count > 1 Then '.Saved = True ' .Close False ' Else ' .Saved = True ' Application.Quit '.Close ' End If 'End With End Sub
EXCEL VBAについて質問です。 アドバイスを宜しくお願い致します。 現状開いているシートの日付を参照し、新しく開いたシートの日付とあっているセル下部に 貼り付けを行おうとしています。 条件的にはあっている気がしますが、なぜか貼りつきません。 アドバイス宜しくお願いたします。 元シート日付　2014/06/01 添付画像が貼り付け先のEXCELとなっております。 以上宜しくお願い致します。 Dim s As Long Dim wb As String Dim dy2 As String Dim a As String 　dy2 = Range("M1")　　　　元EXCELの日付を参照 　Range("M5:R41").Copy　　元EXCELのデータをコピーする。 wb = "D:\Documents and Settings\ssk\デスクトップ\まとめ.xls"　　　’ Workbooks.Open (wb)　　　　新しいブックを開く。 Sheets("data").Select　　　　対象のシートを選択 For n = 2 To 187 Step 6 If Cells(1, n).Value = dy2 Then 元ブックの日付と新しく開いたブックの日付を参照しあっていれば下記のようにはりつけする。 Cells(3, n).Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Application.CutCopyMode = False End If Next End Sub
Excel2013です。 シート上でセルや行、列などをコピー、ペーストした場合は、コピー元の書式や入力規則などはそのままです。 コピーではなく切り取りした場合は元の書式や入力規則などが変わってしまいます。 データを他の場所へ移したいとき、コピペしてくれたら問題ないのですが、社内では切り取りでデータを移す人もいるので、元の設定が変わってしまい、困ってます。 いい方法はないのでしょうか？ VBでも構いません。 どなたかExcelに詳しい方、教えてください。
コールセンター勤務のExcelマクロ初心者です。 時間帯ごとの迷惑電話リストデータを作成するにあたり、オペレーター約100名から数ヶ月間情報を徴収しようと思っています。 受信業務の妨げにならないよう、簡単に操作できるExcelでのマクロを作成し、そのExcelを100名に配信する予定です。 オペレーターがマクロボタンを操作したら集計用Excelが開いてデータが集まる、というイメージです。（以降便宜上オペレーターが操作するExcelを子Excel、集計用Excelを親Excelと表記） 迷惑電話業者リストは既に手元にあり、「何時何分に電話が掛かってきているのか」のデータが欲しいのです。 【親Excelイメージ】 a列・・・業者名 b列・・・業者電話番号 c列・・・掛かってきた時刻 1ヶ月あたりの累積で約500件（500行）ほどのデータを収集見込みです。 【子Excelイメージ】 a列・・・業者名 b列・・・業者電話番号 c列・・・時刻（関数now） そしてd列にボタンを配置させ、行数（業者数）は10行程度になります。迷惑電話が掛かってきたら、該当行のボタンを押してもらう形です。 ここで質問です。 子Excelのセルd1にあるボタンをクリックすると、セルa1～c1をコピーし、親Excelを開いて最終行を探し、値のみを貼り付けて保存して親Excelを閉じる、というところまでのマクロは作れます。困っているのが、複数のオペレーターが同時刻に操作してしまった場合のバッティングです。 例えばオペレーターAが親Excelを開いていた場合に、オペレーターBは親Excelが閉じられるのを待ってから貼り付けにいく、という感じにしたいのです。 若しくは、親Excelをブックの共有としたときに、全く同時刻にオペレーターAとオペレーターBが最終行を探しにいってもエラーにならないようにしたいのです。 どちらの方法でも構いませんので、どなたかご教授頂けると幸いです。オペレーターは100名ほどおりますので、2名同時操作どころか3名同時操作もあり得ます。これ以外にも懸念される事項があれば教えてください。
コマンドでTCP/IPの設定を行うコマンドを以下の通り作成しました。 @echo off set Ntname="ローカル　エリア接続" set Ipadd=XXX.XXX.XXX.XXX set Subnet=XXX.XXX.XXX.XXX set Dfgy=XXX.XXX.XXX.XXX set DnsSv1=XXX.XXX.XXX.XXX set DnsSv2=XXX.XXX.XXX.XXX set DnsSv3=XXX.XXX.XXX.XXX netsh interface ip set add name=%Ntname% source=static addr=%Ipadd% mask=%Subnet% gateway=%Dfgy% gwmeric=1 netsh interface ip set dns name=%Ntname% source=static addr=%DnsSv1% primary validate=no netsh interface ip add dns name=%Ntname% addr=%DnsSv2% index=2 validate=no netsh interface ip add dns name=%Ntname% addr=%DnsSv3% index=3 validate=no pause これを実行するとIＰアドレス、デフォルトゲートウェイ、サブネットマスク、ＤＮＳサーバーの設定は問題なくできています。 これに「この接続のアドレスをＤＮＳに登録する」を無効にする設定（チェックを外す）にしたいのですが、どのようなコマンドを追加すればよいのでしょうか。 ご教授ください。
下記のような処理を実行すると応答なしとフリーズになってしまいます。 解決方法について教えてください やりたいこと　：8列目にコードが並んでいて、重複コード（2回目以降）のものは赤色にする 困っていること：実行すると応答なしでフリーズしてしまう →変数の上限が20000ではなく5000だと問題なく動く Sub (1)() Dim i As Long For i = 3 To 20000 If Application.WorksheetFunction.CountIf(Range(Cells(3, 8), Cells(i, 8)), Cells(i, 8)) > 1 Then Cells(i, 8).Font.ColorIndex = 3 End If Next i End Sub
【VBA】マクロについて質問です。 マクロで複数のシートの特定のセル（A5（日付）、A7（社名）、B3（担当者）など）を別ブックのひとつのシートにまとめて、 日付 社名 担当者 シート１ A5 A7 B3 シート２ A5 A7 B3 シート３ A5 A7 B3 のように下へ下へ積み上げていくにはどうゆうマクロを組めばいいでしょうか。 同じ作業を複数のファイルで行わなければいけないため、マクロを組みたいのですが、よくわかりません＞＜ ファイルによってシートの数が違うので、それにも対応すると有難いです。 どうぞよろしくお願いいたします。
Excel2007でCSVファイルを取り込むVBAで作成しています。 下記のURLを参考にしています。 http://www.asahi-net.or.jp/~ef2o-inue/vba_o/sub0 … 皆さんにお聞きしたい事があり、投稿させていただきました。 CSVファイルの先頭行にタイトル行が指定されている場合、VBA上で除外する事は可能でしょうか。 できれば Do Until objTS.AtEndOfStream ※この中で・・・ Loop すみませんがどうかアドバイス宜しくお願いします。 では失礼します。
初心者です。 VisualBasic2010で複数のフォームを持つアプリケーションを作成しています。 それぞれのフォームに親子関係はありません。 全てのフォームが開いている状態で別のアプリケーションを操作し、 [Alt]+[Tab]やツールバーから選択するなどで１つのフォームを選択すると、 そのフォームのみ前面に表示され、 アプリケーション内の他のフォームは別アプリケーションの後ろに隠れたままとなります。 それを全て手前に表示する方法はありますでしょうか。 Activatedイベントで他のフォームをアクティブにせずに開く、などできればおしえてください。 よろしくお願いいたします。
ユーザーフォームを作ったのですが、 いくつかあるテキストボックスを enterを押すことで 上から下に順番に移っていくことはできますか？？ その方法が知りたいです！ よろしくお願いします<(_ _)>
Visual　BASIC　6で 文字列の並び換えの方法がわかりません 文字列には半角も全角もあって数字もあります。 if　A$　< B$ then ではだめです。
こんばんは VBをせこせこ書いているのですが、躓いて分からないところがあります。 たとえば、その日の Day が 15日よりも前か後かを判定するにはどうすればよいのでしょうか？ 日付を比較したり足したり引いたりする関数はわかるのですが、日数を比較する方法がわかりません。 例えば、今日は6月11日です。11日は15日より前なのでTrue、このプログラムをを6月16日の時点で実行するとFalseが返るといった具合です。特定の年・月とは無関係で、日だけをチェックしたいと考えています。 どのように記述したらよいでしょうか？教えてください。
Private Sub Worksheet_Activate() Dim wsData As Worksheet Dim number As Variant Const SH_DATA As String = "データ入力" Set wsData = Worksheets(SH_DATA) On Error Resume Next If wsData.Range("G3") = "" Then number = InputBox("個人番号を入力してください") If number Is Nothing Then Exit Sub Else wsData.Range("G3") = number MsgBox "性別を選択してボタン(1)を押してください" End If End If End Sub このコードの If number Is Nothing Then のところがうまく動きません、、、 カーソルをnumberに持っていくと値はきちんとはいっています！ なのに何回やっても Exit Sub に飛んでしまいます(-_-;) どなたかよろしくお願いします(__)
Sub clear() Dim wskyu As Worksheet Dim wsData As Worksheet Dim Y As Range Const SH_KYUYO As String = "給与明細" Const SH_DATA As String = "データ入力" Set wskyu = Worksheets(SH_KYUYO) Set wsData = Worksheets(SH_DATA) With wsData For Each Y In .Range("C3:G55") If Y.Interior.ColorIndex <> xlNone Then Y.ClearContents End If Next End With With wskyu Range ("P7:AQ7"), .Range("D10:AQ10"), .Range("D13:AQ13"), _ .Range("D17:AQ17"), .Range("D20:AQ20"), .Range("D24:AQ24"), _ .Range("D29:AI29").Select Selection.SpecialCells(xlCellTypeConstants, 23).Select Selection.ClearContents End With MsgBox "個人番号を入力後、性別を選択しボタン(1)を押してください" End Sub 値のみ削除しようと上のコードを書いたのですが With wskyu のあとの Range～ でプロパティの使い方が不正です と言われてしまいました(-_-;) ヘルプボタンがあったので押しても空のページに飛んでしまい どうすればよいのかわかりません、、、 どうかよろしくおねがいします！！
VB6で配列の最大値を簡単に求める方法はありますでしょうか? 今は、1番目と2番目を比較して、大きい方を変数に格納して、 変数と3番目を比較して、・・・・ 以下繰り返して、求めています。
Visual Basic 2010を勉強しています。 フォームに貼り付けたコントロールのプロパティの設定についてですが、 今までは、貼り付けた後にプロパティウインドウで直接いじっていました。 (Text、Font、Imageなど...) ですが、知人が書いたコードを見ていると、コードの中で設定しているようなのです。 プロパティウインドウで設定した方が、視覚的にも確認しながら設定できるのでそうしていたのですが、コード内で設定するのと違いはあるのでしょうか？(パフォーマンスやコードの見やすさなど...) 動的にコントロールを配置したい時や、プロパティを変更したい場合にはコード内で操作しますが、初期設定やラベル等の変更することがないようなコントロールに関しては、どちらでも同じような気がするのですが... 実際に皆さんがどうされているのかも気になり、質問させて頂きました。 以上、何卒よろしくお願いいたします。
ファイルを探すプログラムをネット頂き　テストしたのですが c:\ のみ　動かず　c:\*** は　そのフォルダーから下を探します e:\ は　全てのフォルダーを探します。 ＷＩＮ８　ですが　どこで間違ってるのでしょうか？ よろしくどうぞ Option Explicit Private g_dteDate As Date Private g_strEXT As String '参照設定　M-Scripting.Runtime Cells(1, 2).Value　に　探すアドレス　記載　c:\ 　e:\ 　c:\*** など Sub Sample_FileSearch2() 　　Dim vntF As Variant Dim objFSO As FileSystemObject Dim dteDate As Date Dim GYO As Long Dim cntFound As Long Set objFSO = New FileSystemObject ' FSO Rows("5:65536").ClearContents GYO = 4 ’ g_dteDate = DateAdd("m", Cells(3, 2).Value * -1, Date)　更新　不要 g_strEXT = UCase(Trim(Cells(2, 2).Value)) ' ルートフォルダから探索開始 Call Sample_FileSearch2_SUB(objFSO, _ objFSO.GetFolder(Trim(Cells(1, 2).Value)), GYO, cntFound) Set objFSO = Nothing ' 処理結果の表示 If cntFound = 0 Then MsgBox "見つかりません" Else MsgBox cntFound & "個見つかりました" End If End Sub '''******************************************************************************* ''' ファイル探索処理(再帰動作) '''******************************************************************************* Private Sub Sample_FileSearch2_SUB(objFSO As FileSystemObject, _ ByVal objFolder As Folder, _ GYO As Long, cntFound As Long) Dim objFolder2 As Folder Dim objFile As File ' サブフォルダの探索 For Each objFolder2 In objFolder.SubFolders ' サブフォルダ個々の探索(再帰動作) Call Sample_FileSearch2_SUB(objFSO, objFolder2, GYO, cntFound) Next objFolder2 ' このフォルダ内のファイルの探索 For Each objFile In objFolder.Files ' ここから条件判断 With objFile If (UCase(objFSO.GetBaseName(.Path)) = g_strEXT) Then GYO = GYO + 1 Cells(GYO, 1).Value = .Name Cells(GYO, 2).Value = .DateLastModified Cells(GYO, 3).Value = _ Left(.Path, Len(.Path) - Len(.Name) - 1) cntFound = cntFound + 1 End If End With Next objFile End Sub
現在、少し古いシステムのメンテナンスのために、WindowsNTでVB5を触っています。 その中で、以下のことを行いたいのですが、どうもうまくいかないため質問させていただきます。 やりたいこと 　FileListBoxを使って、ネットワークドライブ上の、特定の拡張子を持つファイル一覧を取得・表示したい。 (試しに、ネットワークドライブ上ではなく、Dドライブ(MO)にて確認したところ、問題なく動作しました。) また、ネットで調べてみましたが、私のやりたいことができるのかどうか、という情報を見つけることができませんでした。 できないものなのでしょうか。 どうかご教授ください。 OS：Windows NT 4.0 開発環境：VB5　SP3 以上です。よろしくお願いします。
Windows7 VB2010のWebBrowserで表示されているテキストを取得することはできますか。
今までVB6.0でプログラミングをしていた者で、最近VB2010に開発環境を変えました。さっそくソフトを開発しているのですが、フォームのリロードが必要なところがあったためそこのプログラムをネットなどで参考にして書いてみたのですがどうしてもエラーがでます。 今までVB6.0ではその部分を Private Sub Command1_Click() Set Form1 = Nothing Call Unload(Me) Form1.Show End Sub と、記載していました。これをVB2010のコードに書き換えるとどのようになるのでしょうか。 ご回答よろしくお願いいたします。
複数選択でのファイルの配列取り込みは下記でおこなえましたが、 tmp = Application.GetOpenFilename(, , "処理したいファイルを複数選択してください", , True) For Z = LBound(tmp) To UBound(tmp) 同じような感じの事をフォルダでしたいのですが・・・ ネットや本を探してみましたが、見当たりません・・・ 具体的には複数選択したフォルダ（年月の名前が付いたフォルダ）が複数個あり そのフォルダ内に約７００個づつファイルがります フォルダは年月の名前が付くフォルダなので１年分だと１２フォルダ、２年分だと２４フォルダになり名前も変わります（２０１４０３、２０１４０４、２０１４０５、・・・・） ファイルはフォルダの１分毎のデータになりますので名前が変わり、数も多いです。１フォルダ分（１ヶ月なら２４時間×２８～３１日でだいたい７００ファイルくらい）なので過去分も含めると月数が増えると手ではちょっとキツイです。 ３か月分を処理するとして フォルダ２０１４０３、２０１４０４、２０１４０５を複数選択し 　フォルダ２０１４０３の 　ファイル２０１４０３０１０００１→２０１４０３０１０００２→２０１４０３０１０００３・・・　２０１４０３３１２３５９ 　フォルダ２０１４０４の 　ファイル２０１４０４０１０００１→２０１４０４０１０００２→２０１４０４０１０００３・・・２０１４０４３０２３５９　　フォルダ２０１４０５の 　ファイル２０１４０５０１０００１→２０１４０５０１０００２→２０１４０５０１０００３・・・２０１４０５３１２３５９ まで順次ファイルを開いてセルのデータを１ヶ月分毎に収集したいのですが 月数が増えると手ではちょっとキツイので複数フォルダを選択するとフォルダとファイルを配列に取り込み 対象Folders = 複数選択したフォルダの配列 For Z = LBound(対象Folders) To UBound(対象Folders) 　　　　対象fileｓ = 複数選択したファルダ内のファイルの配列 　　　　　For Y = LBound(対象fileｓ) To UBound(対象fileｓ) 　　　　　　　　　　ファイルを開いてデータ収集 　　　　 Next Next 上記のようなイメージの処理をしたいのですが ご存知の方ご教示いただけると幸いです。 よろしくお願いいたします。 ＯＳはＷindows7、エクセルは2010です。
Visual Basic 2010　×　SQLite　を使ったアプリケーション開発の勉強をしています。 そこで、ふと思ったのですが、データベースの値を参照する時に、 一々データベースへの接続処理をしなくても、 「DataAdapter」 の 「Fill」 メソッドだけを使えばいいのではないかと... 皆様のご意見を伺いたく質問させて頂きました。 具体的には、 SQLiteDataAdapter (System.Data.SQLiteライブラリ) のFillメソッドは、 データベースへのコネクションが確立されていなければ接続し、 データベースの値をデータセットに格納し、Closeする。 (コネクションがあればそれを使い、Closeしない) 上記のことから、常に DataAdapter の Fill だけを使っていれば、 一々、Open→Close しなくてもいいのではないかと思ったのです。 アプリケーションやデータベース等の規模や使い方にもよると思うので、 簡単に結論が出るような話ではないと思いますが、 ごく簡単なアプリケーションで、小規模なデータベースをちょっと参照するくらいなら、 上記でもいいのでは？ 皆様がどう使い分けているかお伺いできれば幸いです。 それとも、「使い分けもなにも、Open → Close しないなんてバカなことはしないよっ！」 と笑われて終わりという話でしょうか...＾＾； 何卒よろしくお願いいたします。
HLOOKUPを使ってある文字列を探し、その値がある行番号を知りたいのですが どうすればよいのでしょうか？？ findを使えばいいのかもしれませんがfindはあまり良くないという意見を多く聞くので どうにかLOOKUPで行こうと思っています みなさんよろしくお願いします(__)
Access 2000 を利用してフォームを作成しております。 フォーム上にサブフォームを配置して、そのレコードソースにパススルークエリを 指定しております。 このパススルークエリのSQLをデータベースサーバ上で動作させると結果を 返すまで2秒程度かかります。 Access のサブフォームのレコードソースにした場合、画面表示が完了するまでに 60秒程度かかります。 しかしながら2回目からは2秒程度で表示が完了します。 初回の画面表示が遅い原因等がお分かりの方がいらっしゃいましたら ご教授願いたいと思います。 以上です。
VB6でデバッグする時にカーソルのある行まで簡単にスキップすることは出来ますでしょうか? 右クリックで[カーソルの直前まで実行]というのはあったのですが、 カーソルの直前まで実行せずにスキップしたいのですが。
dim a as string dim b as string dim c as string dim d as string dim e as string dim f as string dim g as string dim h as string dim i as string a = "○○" b = "○○" c = "○○" d = "○○" e = "○○" f = "○○" g = "○○" h = "○○" i = "○○" 上記のような形でたくさん宣言しているのですが、 実際はもっとあり、これだととても長いコードになってしまいます(・・;) なんとか簡略化したいとは考えたのですがよい方法が見つからず 皆さんよろしくお願いいたします_(_^_)_
VBですが、ユーザ名とパスワード不要で いきなりログインできるようにしたいのですが！？ http://homepage3.nifty.com/mtaiyo/login.txt 以上プログラムですが、実際組み込まれている「Webデータシステム」は イントラネットにあり、リンクできませんので あえて、HPにプログラムのみ公開しました。 ブラウザから最初「login.aspx」にログインして、ユーザ名とパスワードをBOXに入力してログインしています。 最近原因不明ですがログインできなくなり、困っています。責任者からも自動ログインできるように できないか頼まれています。 どうしたらユーザ名とパスワード不要でログインできるようできますか！？ 今日は以上のプログラムしかわかりませんが、関連するプログラムは知れべればわかります。 対策として第１案の対策も考えています。（仕事ができなくて困っていますので必死です。） 　第1案はhttp://oshiete.goo.ne.jp/qa/8622954.html 打開策に参考にされてくだい よろしくお願いします。
VBAど初心者です。どうしても最終行のデータを選んだシートにコピーできません。 LastRow.Selectのところで、止まってしまいます。どのように行を設定していいのかさっぱりわかりません。どなたか、ご指導のほどよろしくお願いします。 Sub copy_last_line() Dim LastRow As Long Sheets("Sheet1").Select LastRow = Cells(Rows.Count, 1).End(xlUp).Row LastRow.Select Selection.Copy Sheets("Sheet2").Select Range("A1").Select ActiveSheet.Paste Sheets("Sheet1").Select Range("A1").Select End Sub
コードの書き方が分からないのですが、 一つもともとあるｅｘｃｅｌファイル（ｆｉｌｅ１）にマクロを保存しておいて それを使うときに新しく必要な情報が入った上のとは別のｅｘｃｅｌファイル（ｆｉｌｅ２）を作ります そしてｆｉｌｅ１を開いた状態でｆｉｌｅ２から値を参照するにはどうすればよいのでしょうか？ つまり今ｆｉｌｅ２はありません しかしｆｉｌｅ２を作りそこから参照したいときににコードをさわらなくてもいいように書きたいのです file２は毎回同じように作るので値は変わっても場所は毎回同じセルに入ります 説明が下手で質問が分かりづらいとは思うのですがどうかよろしくお願いいたしますm(__)m
VBA実行中に他の作業をする Win7 にExcel2010を入れて使っているのですが、 VBAで数値計算プログラムを走らせつつ、画像ファイルを開いたり、ファイルコピーしたりなどを 行うことができます。 一方で同じプログラムでも Win8 に入れたExcel2010では、ファイル操作しようとすると マウスポインタが砂時計マークになり、数秒～10秒ていどもたつきます。 DoEventsを増やしてみてもあまり効果はありませんでした。 なぜこのようにOSによって違いみられるのでしょうか？ そしてWin8でもWin7と同様にVBA実行中に他の作業を行うにはどうしたら良いですか？
Access2000(VBA)にてパススルークエリを生成してOracleのデータを取得しようとしております。 結果は正しく取得できるのですが、取得にかかる時間が非常に遅くて困惑しております。 SQL*plusやObjectBrowser等でSQLを実行すると2秒程度で結果が返るのですが、 Accessのパススルークエリですと60秒程度かかります。 SQLの内容は以下のように集計するものになります。 どなたか、改善方法が分かる方がいらっしゃればお教え下さい。 以上です。 SELECT A.請求先コード 請求先CD, B.会社名 請求先名, 20140401 集計開始日, 20140431 集計終了日, SUM(A.合計金額) 合計金額_合計, SUM(A.消費税額_外税) 消費税額_合計, (SUM(A.合計金額) + SUM(A.消費税額_外税)) 税込合計金額_合計, SUM(D.入金額) 入金額_合計, ((SUM(A.合計金額) + SUM(A.消費税額_外税)) - SUM(NVL(D.入金額,0))) 未入金額_合計 FROM 売上_TRN A, 顧客先_MST B, 入金_TRN D, 顧客_TRN E, 顧客_TRN F WHERE A.請求先コード = B.顧客先コード AND A.顧客先コード = E.顧客先CD AND A.請求先コード = F.顧客先CD AND A.売上日 Between 20140401 AND 20140431 AND A.売上NO = D.売上NO(+) AND (nvl(A.摘要コード１,' ') <> 'DM') AND A.赤伝NO = ' ' GROUP BY A.請求先コード, B.会社名 ORDER BY A.請求先コード
FileSystemObjectでファイルをコピーしたく、下記のようなコードを書きました。 SYSFILEはファイル名です。（拡張子なし） ******************************************************* Dim objFileSys SYSFILE Set objFileSys = CreateObject("Scripting.FileSystemObject") objFileSys.CopyFile("C:\TEST\", "C:\REAL\SYSFILE") C:\REAL\SYSFILE"を編集して"C:\REAL\SYSFILE_NEW"を作成（コード省略） SYSFILE_NEWを読み込んで最終行の番号を取得（コード省略） ’取得した番号にリネームコピー objFileSys.CopyFile("C:\REAL\SYSFILE_NEW", "C:\REAL\XXX")←★　 ******************************************************* ★のCopyFileで「ファイルが見つかりません」のエラーになります。 "C:\REAL\SYSFILE_NEW"は確実に作成されて存在しますが発生します。 おかしいと思って直前にFileExistsをしてもFalseになります。 エクスプローラー上では確かに存在するし、コピーもできます。 実際はファイル名の箇所は変数名なので中身を確認しようと★の直前行で echoで出力してみたが、変数の中身も問題ありませんでした。 おかしいのがその後です。 今度はエラーにならずに処理が通りました。 直前にechoでダイアログを表示させた場合にはエラーが発生しません。 その記述を削除するとまた発生します。 考えられる原因を教えていただきたいです…
Excel2013です。 A1からA10に文字を入力、となりのB列B1からB10に数字を入力する表があります。 A列の文字がAとBとCが入力された場合、文字の色が赤に、その隣のB列の数字も同じく赤い文字になり、それ以外の文字が入力された場合はそのまま文字の色は黒になる。 VBでどなたか詳しい方教えて下さい。 出来れば、入力してる最中に文字の色が直ぐ変わってくれるようなやり方で教えて欲しいです。 それが難しい場合は全て入力し終わって、シート上にボタンを作り、そのボタンを押すとA列、B列の文字の色が変わるようなやり方をお願いします。
困りました、、 下のような表から検索したいのですが うまく取り出せません ～63,000 63,000～73,000 73,000～83,000 83,000～93,000 93,000～101,000 101,000～107,000 107,000～114,000 114,000～122,000 122,000～130,000 130,000～138,000 138,000～146,000 146,000～155,000 155,000～165,000 165,000～175,000 175,000～185,000 185,000～195,000 195,000～210,000 210,000～230,000 230,000～250,000 250,000～270,000 270,000～290,000 たとえばこの中から225000が当てはまるところを探したいのです 今はselect caseで一つずつ判定しているのですが これではコードが果てしなく長くなってしまいます もっとスマートなコードはないのでしょうか？？ よろしくお願いします<m(__)m>
教えて下さい。 テキストファイルの内容を元に自動的グラフを作りたいです。 【C:\Temp\data.csv】の中身 ----------------------------------- 1回目,10.50% 2回目,30.45% 3回目,70.45% ----------------------------------- 横軸には「n回目」の文字列を、縦軸には「n%」数値を入れたいです。 なんとか静的にグラフを作ることは出来ましたが、これを自動化したいと思っています。 【サンプルvba】 ----------------------------------- Private Const LOGFILE = "C:\Temp\data.csv" Private Sub CommandButton1_Click() ' グラフオブジェクト作成(位置,サイズ) With Sheet1.ChartObjects.Add(10, 50, 400, 150).Chart .ChartType = xlLine ' 折れ線グラフ .Axes(xlValue).MaximumScale = 100 ' 縦軸最大値 .Axes(xlValue).MinimumScale = 0 ' 縦軸最小値 ' グラフデータ内容 With .SeriesCollection.NewSeries ' グラフ名 .Name = "テスト" ' 縦軸 (ここに%数値を入れたい) .Values = "={10.50,30.45,70.45}" ' 横軸 (ここに回数を入れたい) .XValues = "={""1回目"",""2回目"",""3回目""}" End With End With End Sub ----------------------------------- テキストファイルの内容は一定間隔で更新されるため自動的に取り込みたいです。 すいませんがよろしくおねがいします、、。（T▽T）ノ
マクロ初心者です。 文字を検索する列の範囲はD~Fとし、検索開始セルはDとします。 検索結果を表示するセルの先頭セルはAとし、A～Cに結果を表示させます。 もしD2に文字があった場合、A１に”１”を表示させます。 E３に文字があった場合は、A３に”１”を、B３に”１”を表示。 E５に文字があった場合、E列に文字が入ったのが２回目となる為、A５に”１”を、B５に”２”と表示。 上記のように、それぞれの列に何個文字があったのかカウントしていくマクロを作成したいのですが、作成できずに困っています。 よろしくお願いします。
ウィンドウ上のどこをクリックしても, 処理が実行されるようにしたいです。 Excel2010(とSolidworks2013)で使用します。 教えてください　お願いします
VB6で0か1を扱う時の変数はByte型で宣言すればよいでしょうか?
教えて下さい。 ファイルをバイト型配列に読み込んで、ある固定長に区切(改行)って出力したいです。 以下簡単にサンプルとして作っているのが以下です。 【読み込みファイル.txt】 ---------------------------------------------------------------------------------- AB ---------------------------------------------------------------------------------- このテキストファイルの内容（byte型では、"41 42"）を１バイトづつに改行で区切りたいです。 【VB.Net】 ---------------------------------------------------------------------------------- Dim BUFSIZE As Integer = 1 ' 1バイトづつ処理 Dim buf(BUFSIZE) As Byte ' 読み込み用バッファ Dim readSize As Integer ' Readメソッドで読み込んだバイト数 Dim srcName As String = "C:\Temp\読み込みファイル.txt" ' 読み込みファイル名 Dim dstName As String = "C:\Temp\書き込みファイル.txt" ' 書き込みファイル名 Using src As New FileStream(srcName, FileMode.Open, FileAccess.Read) Using dest As New FileStream(dstName, FileMode.Create, FileAccess.Write) While True ' 1バイト読み込み readSize = src.Read(buf, 0, BUFSIZE) ' 読み込むものが無ければ終了 If readSize = 0 Then Exit While ' 改行いれたい部分(動かないけど、、、) buf = (0D,0A) ' 書き込み dest.Write(buf, 0, BUFSIZE) End While End Using End Using ---------------------------------------------------------------------------------- ↓ 理想の処理後 【書き込みファイル.txt】 ---------------------------------------------------------------------------------- A B ---------------------------------------------------------------------------------- 重要なのはバイト型で処理を行いたいです。（文字列ではない） すいませんがよろしくお願いします。
VBAからIEを操作し、サイトを閲覧する処理を作成しています。 質問はサイトを閲覧する処理の前にプロキシ設定を行い、サイト閲覧処理が終われば、プロキシ設定を無効に戻したいのですが、方法がわからないので、ご教授いただきたくm(_ _)m
マクロ初心者です。 アクティブセルから一つ上の列に、値が入っているセルが何個あるのかカウントするマクロを作成したいのですが、うまくいかずに困っております。 すみませんが、よろしくお願いします。 参考用画像の解説 【ActiveCell】セルから上の列を範囲指定。 １、２、３と数字が入っているセルが何個あるのかカウント。
VBAでMSXで発売していた初代メタルギアソリッドを再現して作ることは可能ですか。 もちろんマリオブラザーズ同様、エクセルのVBAでメタルギアを作ってみたいです！！！！ それか定番であるC#やC++やCもしくはJavaやPerlなどを習得しないとアクションゲームは難しいですか？ 作ることが可能かどうかと著作権上問題はないのかどうか教えてください。たぶんアップロードしなければ問題ないと思いますが・・・・　せっかく半年くらい独学でVBAを学んだので出来れば本腰入れてゲームも作ってみたいです。 よろしければ教えてください！！ システムやプログラミングのお仕事に携わっている方　教えてください！
VBS超初心者です。 10年くらい前に作られたVBSを修正したいのですが、さっぱりわからないため助けてください。 勤務先で、社内イントラのデータベースを参照するときに使っているVBSです。 【いまの挙動】 VBSを起動すると文書番号の入力画面が表示→入力してEnter→IEで該当ページ(http:★★★/文書番号)が表示されます。 【やりたいこと】 FIREFOXで表示したい。(先日のIE脆弱性の騒ぎの影響で、上から指示があり。。) 今は以下のようなソースで使ってます。 ---------------------- Sid = InputBox("ID を入力。") Sid = Trim(Sid) If Sid = "" Then WScript.Quit If Len(Sid) <>14 Then WScript.echo "ID が不正。" WScript.Quit End If Set objie = WScript.CreateObject("internetexplorer.Application") objie.navigate2 "http://★★★/" & Sid objie.Visible = True WScript.Quit ---------------------- 「internetexplorer.Application」ではダメなことはわかるのですが それ以上は私の知識ではお手上げでした。。 どなたか詳しいかた、アドバイスお願いします。
Access VBA で VLookup を使いたいと思っていたのですが、 「メソッドまたはデータメンバが見つかりません。」とエラーになります。 箇条書きになりますが、行いたいことは以下のとおりです。 ・「D:\0402\コメント.xlsx」を開き、最初のシート（sheet1）を選択する。 ・sheet1の A列には検索対象の文字列が、B列にはそれに対するコメントが文字列で入っています。 ・VLookup 関数を使用し、変数「vDir.Name」を検索値、sheet1全体が検索範囲、 B列の情報がほしいので、列は「2」、完全一致で取りたいので「False」としています。 ・B列の返り値を変数「vComment」に代入します。 下記が書いたソースなのですが、「vComment = ～」を記述すると、 冒頭の「メソッドまたはデータメンバが見つかりません」とエラになってしまいます。 前後のプログラムの関係上、Accessのクエリの使用や、Excelをリンクテーブルにすることはできません。 解決方法がわかる方、助けていただけますでしょうか。 Access は 2010 になります。よろしくお願い致します。 'エクセルを開く Dim oCommentXLS As Object Dim oCommentXLSWorkbook As Object Dim vFileCommentXLS As String vFileCommentXLS = "D:\0402\コメント.xlsx" Set oCommentXLS = CreateObject("Excel.Application") Set oCommentXLSWorkbook = oCommentXLS.Workbooks.Open(vFileCommentXLS) Dim oSheet As Object Set oSheet = oCommentXLS.Worksheets(1) Dim raCommentFind As Range Dim vComment As String Set raCommentFind = Cells.Find(What:=vDir.Name, LookIn:=xlValues, LookAt:=xlWhole) If Not raCommentFind Is Nothing Then Debug.Print "みつかりました。" vComment = Application.WorksheetFunction.VLookup(vDir.Name, Range("A1:B1000"), 2, False) Debug.Print vComment Else Debug.Print "見つかりませんでした" End If
CSVファイルをLine Inputメソッドで1行毎に読み込みたいのですが、 セル内の改行により、1行分として読み込む事ができません。 セル内の改行コードは「vbLf」が使用されているとの認識でいますが、 仮に「vbLf」が改行コードとして使用されていれば、メモ帳などで 開くと「vbLf」の部分は改行されないと思っています。 ところが、問題のCSVをメモ帳で開くとセル内改行部分も改行されて 表示されます。 Line Inputメソッドの1行分は、改行コード「vbCrLf」までで、 改行される位置がメモ帳で開いた結果と同じになります。 そうなると、セル内の改行に使用されている改行コードに何が 使用されているのでしょうか？ 環境は、Windows7、EXCEL2013です。
VBAを使っていて、 配列数を変数で定義したいのですが、 ネットで検索すると Dim aaaa() as integer Redim aaa(xxx, yyy) あるいは Dim aaaa() Redim aaa(xxx, yyy) as integer のようにdimで変数を定義した後にredimで定義しなおす方法が書かれてあります。 一方で、 Redim aaa(xxx, yyy) as integer のように、dimの定義を省略して、いきなりredimで配列を定義しても 問題なくプログラムは実行できることに気がついたのですが これら二つの方法に違いはあるのでしょうか？ 後者を使っても問題ないでしょうか？
作成したプログラムを実行している途中で プログラムの開始ボタンや終了ボタン、計算時間などを表示するように作成した ユーザーフォームが自動的に消えることがあります。 他のプログラムではその現象はなく、あるプログラムのある箇所のみで起きます。 しかしながら、毎回起きるというのではなく、3回に1回程度の頻度で起きます。 特にユーザーフォームが消えるようなことは書いていないのですが なぜこのようなことが起きるのでしょうか？ 一応、その消える辺りに If (UserForm1.Visible = False) Then UserForm1.Show vbModeless というのを入れてみましたがうまくいきませんでした。 これはどのようにすれば改善できますでしょうか？
お世話になります ふと思ったのですが c言語やVBのSin Cos Tanって、パラメータはラジアンですよね。 でも、中学などで習うSin Cos Tanは直接角度を指定してましたよね？ 【質問１】 なぜ、プログラミング言語ではラジアンなのでしょうか？ 【質問２】 角度指定で求められる同等の関数が有りますでしょうか？
VBAで作成した長いプログラムがあり、 前半は完成しているのですが、後半が未完成で作りかけのものがあります。 しかも変数・配列が多量に使用されています。 後半の部分のプログラムを動かすためには 前半の計算を行う必要があるのですが、 後半の計算のバグを直すために何度もやり直すのに時間がかかってしまいます。 前半の計算で行った変数の代入を保持したままでVBAの計算を終了し、 後半の計算の手前から計算を行うようなことをしたいのですが このようなことは可能でしょうか？ もし、無理だとして、このような長いプログラムで、しかも変数が多いような 場合どうやって一部（特に後半部分）のプログラムのバグフィックスを行えば良いでしょうか？
PC9801のDiskBasicでファイルをRS232C送信し,DOS/VのWinndow（OS 95 98 XPなど) のRS232CのCOM1で正常受信ができません。DOS/VのPC9821のDOSのN88Basic では,クロスケーブルを使用して受信できますが,ウィンドウでは,フリーソフト7,8種類使用 しましたが、同じようには受信ができません。 　ウィンドウXPで、同期して受信らしき様子はあるのですが、内容が16進コードで　 00とか80とかのコードでどう行っても,送信コードとは異なっています。 　送信コードは　DISKBASICのN88BASCプログラムで以下のようなものです 　　100　'ABC 　　110　LINE(100,100)-(150,100),COL 　通信ケーブルは,　クロスです。 　　DOS　N88BASICと同じように受信ができないのでしょうか。何が悪いのか原因は？ 　教えてください。 　　昔の5インチのデータを移植資料としてウィンドウで保存したいのです。
ExcelのVBAでGOM Playerを動かそうと思っています。 動画の途中から時間指定で再生しようと思っていますが、再生時間を指定するための画面を出す文字コード「G」をSendKeysで送るとなぜかShiftキー付の文字コードが送られてしまっているようです。 GOM Playerでは「G」を押すと「移動先の時間を指定」画面が出るのですが、VBAで「G」を送ると、「Shift＋G」で表示される「オーディオキャプチャー設定」画面が出てきてしまいます。 VBAではなく手で「G」キーを押すと何の問題もなく表示されます。 具体的に書きますと H列のセルを選ぶとH列に書いてある時間（「0:04」など）のところから再生が始まるプログラムになります。 Private Sub Worksheet_SelectionChange(ByVal Target As Range) Set 指定セル範囲1 = Range("H2:H132") Set 共有セル範囲1 = Intersect(ActiveCell, 指定セル範囲1) If Not 共有セル範囲1 Is Nothing Then Shell "C:\Program Files (x86)\GRETECH\GomPlayer\GOM.EXE", 1 　　SendKeys "G" 　　SendKeys "00:0" & Cells(Rows.Count, 8).Value End If End Sub 「Shell・・」の行はExcelがアクティブの状態からGOM Playerがアクティブの状態にするために入れてあります。 Wait時間を入れてみたり、CRを送ってからGを送ったり 下記のように別のコートで送ってもダメでした。 SendKeys ("G") SendKeys vbKeyG SendKeys 71 また「G」だけではなく「P」を送っても「Shift＋P」が送られた動作になってしまいます。 すみませんが、お知恵を貸していただけませんでしょうか。 よろしくお願いします。
すいません、教えて下さい。 Byte型で読み込んだ内容を指定した固定長で出力したいです。 例えば、次のテキストファイルがあります。 【読み込み元.txt】 ------------------------------------------------------- ABC123 ------------------------------------------------------- 文字コードをSJISとしてバイナリ値では「41 42 43 31 32 33」となります。 この値を次のように出力したいです。 【出力先.txt】（3バイト区切りとする） ------------------------------------------------------- 414243 313233 ------------------------------------------------------- なんとか自力で近しい？とこまで行けたのかなと思いますが 肝心の出力がうまくいきません。 【VB.Net】 ------------------------------------------------------- Dim BUFSIZE As Integer = 2048 ' 1度に処理するサイズ Dim buf(BUFSIZE) As Byte ' 読み込み用バッファ Dim readSize As Integer ' Readメソッドで読み込んだバイト数 Dim srcName As String = "C:\Temp\A.txt" ' 読み込み元 Dim detName As String = "C:\Temp\B.txt" ' 出力先 ' 処理開始 Using src As New FileStream(srcName, FileMode.Open, FileAccess.Read) Using dest As New FileStream(destName, FileMode.Create, FileAccess.Write) While True ' 読み込み readSize = src.Read(buf, 0, BUFSIZE) ' 読み込むものが無ければ終了 If readSize = 0 Then Exit While ' 直接16進数を指定固定長で書き込みしたい部分 For i As Integer = 0 To readSize - 1 msgbox buf(i) Next ' 書き込み実行 dest.Write(buf, 0, readSize) End While End Using End Using ------------------------------------------------------- 大変お手数ですがご教示頂ければと思います。
ＥＸＣＥＬ２０１０にて、ＶＢＡでプログラミングしております。 クラスモジュールを用いてクラスを自分で作成して、 作成したクラスを標準モジュール内で使用するのは普通ですが、 クラスモジュールを用いてクラスを自分で作成して、 作成したクラスを、更に別のクラスモジュールの中に記述することは可能ですか？ このようなクラスの中に別のクラスが入っている状態（クラスの入れ子）で、 まともに動くものでしょうか？ 詳しい方、御教授よろしくお願いいたします。
http://www.relief.jp/itnote/archives/vba-if-or.php このページにも書かれてあるのですが、 Sub textss() aaa = 2 If aaa = 0 Or 1 Then bbb = 1 ElseIf aaa = 2 Then bbb = 2 End If ccc = bbb End Sub を実行すると cccには2が代入されそうなのですが、実際には1が代入されてしまいます。 If aaa = 0 Or aaa = 1 Then と入力する必要があります。 それでは、 If aaa = 0 Or 1 Then とした時、プログラムではどういう処理がなされているのでしょうか？
またまた困ってます、、 このコードを実行したとき .Range("H" & i).Copy.wsDetail.Range ("D24") ここでエラーが起きて 「オブジェクトが必要です」 と言われてしまいます(・・;) だれかよろしくお願いします<m(__)m> ※シートの宣言は上でやってます Private Sub 社会保険() Dim i Dim endrow As Long Dim kihon As Long Set wshoken = Worksheets("各種保険料表") Set wsDetail = Worksheets("給与明細") Set wsData = Worksheets("データ入力") kihon = WorksheetFunction.Round(wsData.Range("C5"), -4) endrow = Cells(Rows.Count, 3).End(xlUp).Row With wshoken For i = 2 To endrow If kihon = .Range("C" & i) Then .Range("H" & i).Copy.wsDetail.Range ("D24") .Range("L" & i).Copy.wsDetail.Range ("H24") .Range("N" & i).Copy.wsDetail.Range ("L24") Application.CutCopyMode = False End If Next i End With End Sub
早速ですが マクロの記録も取れないので、お尋ねします。 エクセルのメニューバーのアドインアイコンを　叩きたいのですが。 エクセルのメニューバーのレベルはＶＢＡでコントロール出来ないのでしょうか　 現実問題は　楽天ＲＳＳで株価取得ですが アドインとしてエクセルに組み込まれています。このRSS.EXEが途切れたとき　ＲＳＳを再起動させることは　単にEXEの再起動だけの事なのですが エクセルでは一度途切れると自動で再取得でき無いようで、アドインアイコンに再リクエストなるものが有ります。手動でこれを叩けば問題は解決するのですが。 で、ＲＳＳの、中は非公開で、再リクエストなる関係の文字列が　見当たりません ならば、自動でメニューバーを選択、目的のアイコンを叩く方法ってあるのか？　ということなのですが ＲＳＳの再起動は　下記の通り。 Dim ei As SHELLEXECUTEINFO ei.cbSize = LenB(ei) ei.fMask = SEE_MASK_NOCLOSEPROCESS ' プロセスを終了させない ei.hwnd = GetActiveWindow() ' シートのハンドル 　　ei.lpFile = "c:\Program Files (x86)\Marketspeed\Mlauncher\MLauncher.exe" ei.lpParameters = "RSS" ' コマンドライン引数(ある場合) ei.lpDirectory = "" ei.nShow = SW_HIDE ' コンソールを非表示にする ShellExecuteEx ei ' 実行 クエリーでもないし・・・・ 　　
教えて下さい。 あるファイルの1バイトづつローテートを行いファイルの書き出しを行っています。(ビット演算による暗号化) しかし以下の処理の場合、サイズの大きいファイルを扱った場合に多くの処理時間がかかってしまいます。 もっと処理を高速化する事は可能でしょうか？ ----------------------------------------------------------------- ' 読み込みファイル Private Const READ_FILE As String = "c:\temp\date.Text" ' 書き込みファイル Private WRIT_FILE As String = "c:\temp\date.dat" ' オブジェクト作成 Dim br As New System.IO.FileStream(READ_FILE, IO.FileMode.Open, IO.FileAccess.Read) Dim bw As New System.IO.StreamWriter(WRIT_FILE, False, System.Text.Encoding.GetEncoding("iso-8859-1")) Dim m As Integer = 3 ' 3ビット左回転 Dim n As Integer ' 1バイトづつ処理 For I As Integer = 0 To CType(br.Length, Integer) - 1 ' 16進数を10進数へ変換 n = ("&h" & String.Format("{0:X2}", br.ReadByte)) ' mビット左へローテート処理を行いファイルへ書き込み bw.Write(ChrW("&h" & Hex(Int((n / 2 ^ (8 - m)) + (n * 2 ^ m And 255))))) Next ' 閉じる bw.Close() br.Close() ----------------------------------------------------------------- よろしくお願いします。
題名のようなことを考えて、実験的にやってみたのですが、これにまつわる不具合の情報をお持ちでしたら聞かせていただきたいのです。ネット上を漁った限りでは、内部処理がUnicode化されているので問題はないという話と、使えるけどやっちゃダメ的な精神論が出てくる程度で、それが原因でトラブった事例は見かけなかったため、おそらく問題はないだろうと思ってはいるのですが。なおExcel2010より古い環境のことは無視してOKです。 私個人は全角変数名は何となく気味が悪いと思っているくちですが、マクロの引き継ぎを行う必要に迫られ、そこで日本語変数名を使ってみようとしている次第です。特定部署でのみ使用している帳票（印刷するのでデータは50行前後）から、条件に沿ってデータを引っ張ってくるマクロを自作して利用しているのですが、マクロ作者たる私が異動となることとなり、帳票フォーマット変更などのメンテを、残った人員に引き継ぐ必要に迫られています。 部署内に残る人員ではまともにマクロを自作できる者はおらず、かろうじて作られたものを触る程度が可能なくらいです。と言う状況で、残った人員が少しでも修正が容易にできるように、変動要素のあるものは全て定数にしてマクロ先頭に集めたり、しこたまコメントを付けたりはしているのですが、ふと、 「変数名を日本語化したら、入門者には読みやすいのでは？」 と思って実験的にやってみました。こんな感じです。 Const 開始行=10 Dim 終了行 As Long Dim 行カウンタ As Long 終了行=開始行+30 For 行カウンタ=開始行 To 終了行 （実処理） Next これを見て正直なところ、「やべ、俺自身にも解りやすいわwww」って思っちゃいました。これだったら概念説明が非常にやりやすい。動作上も問題ないし、特にやばい話も聞こえてこないなら、このまま行っちゃえと。 なので冒頭でも触れたように、精神論的やっちゃダメ以外の情報を求めます。なお同意意見でもけっこうです。
画像のようにexcelファイルのD列に自動で通番を入力させたい。 フォームを利用して新しいデータは最終行に反映するように設定しています。 できれば、フォームの登録を押した時点でD列最終行に画像条件にあう通番を入力させたいのですがどうすればいいかわかりません。 今は、D列セルにCOUNTIFを使って条件を検索して通番を表示させているのですが、日々行が増え続けるためファイルが非常に重たくなってきたのでマクロにチャレンジしました。 マクロの知識はほとんどありません！ よろしくお願いします。
アクセスでADOを使っているのですが、 Sub test() Dim cn As New ADODB.Connection Dim rs As New ADODB.Recordset Set cn = CurrentProject.Connection rs.CursorLocation = adUseClient rs.Open "SELECT * FROM Q1", cn, adOpenStatic, adLockPessimistic rs.Sort = "受付日 DESC" For i = 1 To rs.RecordCount ・ ・ ・ このようなコードを作っていますが、 rs.Sortの部分で、「並べ替えを適用できません」になります。 レコード数は、15000件くらいです。 なぜ並べ替えができないのでしょうか？ しょうがないからクエリで最初から並べ替えしておきますが、原因を教えてください。
Excelのシート内で、罫線(下辺/太線)を引いたセルの値を取得する事ができたんですが、 これ以降が難しく進むことができません。 Dim rg As Range For Each rg In ActiveSheet.UsedRange If rg.Borders(xlEdgeBottom).Weight = 4 Then MsgBox rg.Address End If Next 上記の様に罫線(下辺/太線)の位置を取得する事ができたんですが、 現状だと列を指定できず罫線(下辺/太線)がある全ての位置を取得してしまいます。 そこで、H列&I列を限定としH3：I3から罫線(下辺/太線)がある所の範囲を取得できませんでしょうか？ その取得した範囲をセルの個数を関係なく 100％とし背景色が変更になった箇所が 増えると0％から50％とか80％と言う様に上がって行くように作成したいです。 範囲を全て背景色で塗られたら100％で、全く塗られてなければ0％にしたいです。 結果は、メッセージボックスで表示できる様になると良いです。 画像ですと、黄色の部分がちょうど半分になっているので50％となります。
教えてください。 Visual Studio2005の評価版を入手したいのですが、 入手先のURLを教えていただけないでしょうか。 よろしくお願いします。
またまたエラーが起きてしまいました、、 D列にある数値の平均値を出すマクロを組みたいのですが そのD列は今後増えていくので変数を使い指定したいのです Option Explicit Public Sub all() Const SH_NAME As String = "VBA" Dim i Dim endrow As Long Dim ws As Worksheet Dim Result As Integer Set ws = ThisWorkbook.Worksheets(SH_NAME) With ws endrow = .Cells(Rows.Count, 4).End(xlUp).Row For i = 2 To endrow Result = Application.WorksheetFunction.Average(.Range("D2:D&i")) .Range("F39").Value = Result .Range("F39").NumberFormatLocal = "0.00" Next i End With End Sub このコードだと Result = Application.WorksheetFunction.Average(.Range("D2:D&i")) のところでrangeメソッドは失敗しました と言われてしまいます どうかよろしくお願いします<m(__)m>
教えて下さい。 VBSで出来るだけ高速でローテート演算を行いたいです。 当方ではシフトJISの1バイトコード(16進数)を一度、10進数に直して さらにそこから2進数へ変換した後にローテートを行い、また10進数に直して～を行っています。 やはり処理に膨大な時間がかかってしまいます、、。 もっとスマートに素早く計算出来る方法があればご教示下さい。
アドバイスをお願いします。 Excel－VBAで起動しているエクスプローラに対してハンドルを取得してクリックしたり、テキストボックスに文字をセットするプログラムを作って動かしています。 WindowsXPのときはできていたのですが、Windows7になったらエクスプローラが変わったため正しく動作しなくなりました。 やりたいのはエクスプローラに検索文字列（添付ファイル参照）をセットして検索をさせたいのです。 「windows7のエクスプローラをVBAで操作－１」「windows7のエクスプローラをVBAで操作－２」のタイトルで質問させていただき、下のコードを考えましたが、★のところでハンドルが返らず０でした。InspectObjectsで見ると「読み込み専用」と。これが原因ですか？どうしたらいいのだろう・・・。 またこのハンドルを取得して、AccessibleObjectFromWindowでIAccessible を取り出して、accDoDefaultActionしたいのですが、UUIDの値が分かりません。OLEViewで見たのですがExplorer関連がいくつかあり（添付ファイル参照）どれを使っていいものやら。ボタンクリックの後に文字列セットがあるのですが、まだたどり着けず。 IAccessible初心者です。 質問ばかりで済みませんがコーディングのアドバイスお願いします。 Option Explicit Declare Function FindWindow Lib "user32" Alias "FindWindowA" _ (ByVal lpClassName As Any, ByVal lpWindowName As Any) As Long Declare Function FindWindowEx Lib "user32" Alias "FindWindowExA" ( _ ByVal hwndParent As Long, _ ByVal hwndChildAfter As Long, _ ByVal lpClassName As String, _ ByVal lpWindowName As String) As Long Private Declare Function AccessibleObjectFromWindow Lib "oleacc" _ (ByVal hWnd As Long, _ ByVal dwObjectID As Long, _ ByRef riid As Any, _ ByRef ppvObject As Any) As Long Const WM_SETTEXT = &HC '文字列送信 Const BM_CLICK = &HF5 'クリック Const OBJID_CLIENT As Integer = &HFFFFFFFC Private Type UUID Data1 As Long Data2 As Integer Data3 As Integer Data4(7) As Byte End Type Private IID_IAccessible As UUID Private oShell Private ie Private hWnd As Long Private SearchBoxハンドル As Long Private Search_Folder As String Private RC As Long 'Private objAcc As IAccessible Private objAcc As UUID Private varChild As Variant Private cnt Private fullnames As String Sub 検索指定のインプット() Search_Folder = "c:\xxx" Set oShell = CreateObject("Shell.Application") For cnt = oShell.Windows().Count - 1 To 0 Step -1 ' On Error Resume Next Set ie = oShell.Windows().Item(cnt) fullnames = ie.FullName ' On Error GoTo 0 If fullnames = "C:\Windows\Explorer.EXE" Then ie.Navigate (Search_Folder) hWnd = FindWindow("CabinetWClass", vbNullString) hWnd = FindWindowEx(hWnd, 0, "WorkerW", vbNullString) hWnd = FindWindowEx(hWnd, 0, "ReBarWindow32", vbNullString) hWnd = FindWindowEx(hWnd, 0, "UniversalSearchBand", vbNullString) hWnd = FindWindowEx(hWnd, 0, "Search Box", vbNullString) hWnd = FindWindowEx(hWnd, 0, "SearchEditBoxWrapperClass", vbNullString) hWnd = FindWindowEx(hWnd, 0, "SearchBox", vbNullString) ' ★--> 0 return SearchBoxハンドル = hWnd hWnd = FindWindowEx(SearchBoxハンドル, 0, "Button", "検索") hWnd = FindWindowEx(SearchBoxハンドル, 0, "SearchEditBox", vbNullString) ' "SearchEditBox" に検索文字列入力の予定だった With IID_IAccessible .Data1 = &H68284FAA .Data2 = &H6A48 .Data3 = &H11D0 .Data4(0) = &H8C .Data4(1) = &H78 .Data4(2) = &H0 .Data4(3) = &HC0 .Data4(4) = &H4F .Data4(5) = &HD9 .Data4(6) = &H18 .Data4(7) = &HB4 End With RC = AccessibleObjectFromWindow(hWnd, OBJID_CLIENT, IID_IAccessible, objAcc) '　80004005が返る varChild = 2 '　Class="Button", Name="検索"のコントロールをクリックしたいが・・・ ' RC = objAcc.accDoDefaultAction(varChild) ' 書き方が違うみたい・・・ '　Class="SearchEditBox"　に検索する文字列を入れたいが・・・ Exit Sub End If Set ie = Nothing Next End Sub
はじめて質問させて頂きます。 VBA初心者ですが、宜しくお願いします。 CSVデータをエクセルにコピペしてから処理することを考えています。 CSVのデータはエクセルで開くと以下の様に入力されています。 　　　　｜　　　 　　A列　　　　　　｜　 B列　｜ 　C列　｜ １行目｜　　　日付 時刻　　　　｜データ１｜データ２｜ ２行目｜2014/5/14　13：00：01｜　　○　 ｜　　△　 ｜ ３行目｜2014/5/14　13：00：14｜　　○　 ｜　　△　 ｜ 時刻は24h制で入力されています。 A列の日付と時刻の間にはスペースがあり、これをVBAでスペース区切りをしたいのです。 B列に列を追加し、スペース区切りの処理をしようと思い、自動記録すると以下のようになりました。 Sub Macro1() 　　　　Columns("B:B").Select 　　　　Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove 　　　　Columns("A:A").Select 　　　　Selection.TextToColumns Destination:=Range("A1"), DataType:=xlDelimited, _ 　　　　　TextQualifier:=xlNone, ConsecutiveDelimiter:=True, Tab:=True, Semicolon _ 　　　　　:=False, Comma:=False, Space:=True, Other:=False, FieldInfo:=Array( _ 　　　　　Array(1, 5), Array(2, 1)), TrailingMinusNumbers:=True End Sub ところが、このマクロを実行すると「コピーまたは移動先のセルの内容を置き換えますか？」のメッセージが表示されます。(記録する際には表示されませんでした。) 原因を探ったところ、自動記録のマクロを実行すると時刻が12時間制に変更されB列に、 C列にAM/PMが書き込まれます。(A列の日付は問題なく処理されます。) B列に24時間制の時刻が書き込まれるようにしたいのですが、 何か不足してるとことがあるのでしょうか？ 方法を教えて下さい。 お手数ですが、宜しくお願いします。
A列に数字を入力するとB列に合計が出るようにしたい。 但し、条件があります。 数字の入力範囲はA1からA20まで。 B列の合計はA列の数字が連続した部分の最後に表示。 例 A列 B列 10 10 10 30 20 20 10 30 40 上記のように数字の入力は1行だけの時もあり、5行の時もあるので次の空欄までの合計をB列に表示したい。 VBでも関数でも構いませんので、どなたか詳しい方教えて下さい。
古いExcelでDialogsheetで作られたものを Excel2010でメンテナンスしようとしているのですが 以下のコード部分で定義しているダイアログシートの実態がどこにあるのかわかりません。 Set m_Dlg = ThisWorkbook.DialogSheets("DlgXXXX") ret = m_Dlg.Show プロジェクトエクスプローラーを見ても、それらしいものがありません。 ちなみに、このXLAファイルを開くとシートが一つも表示されていません。 ネットの文献を参考に以下を試してみましたがダイアログシートは表示されません ThisWorkbook.DialogSheets("DlgXXXX").Visible = True 表示する方法があればご教授いただければと思います。
お世話になります。 Windows7、Excel2010で、Xlsmファイルを作りました。 ActiveXのToolBoxで、UserFormを作っている途中途中で保存しようとしたら、 次の警告メッセージOkCancelが表示されます。 「プライバシーに関する注意： このドキュメントにはマクロ、ActiveXコントロール、XML拡張パックの情報、 またはWebコンポーネントが含まれています。 これらにはドキュメント検査機能で削除出来ない個人情報が 含まれる場合があります。」 今まで、VBA作成時には、このメッセージは表示された事はありませんでした。 これは、何のメッセージでしょうか？ 害がなければ表示を止めたいのですが、表示しない方法を教えて下さい。
ＶＢ初心者です。色々調べて、セルに「画像名と画像サイズ一覧」を 書き出すことができました。 しかし、書き出せたのはjpgだけで、gifやpngをフォルダー内に入れると エラーが・・・・ どうしたらgifやpngも書き出せるコードになるか教えてください。 よろしくお願いします。 書いたコードは下記です。 Sub GetImageSize(ByVal f, ByRef x, ByRef y) Dim p Set p = LoadPicture(f) x = CLng(CDbl(p.Width) * 24 / 635) y = CLng(CDbl(p.Height) * 24 / 635) Set p = Nothing End Sub Sub main() Dim FSO As New FileSystemObject Dim FLD As Folder Dim FLE As File Dim FF As File Dim x As Long Dim y As Long Set FLD = FSO.GetFolder("C:\画像の入ったフォルダー名") For Each FF In FLD.Files Call GetImageSize(FF, x, y) Name = FF.Name Name_x = x Name_y = y myCnt = myCnt + 1 Cells(myCnt, "A").Value = FF.Name Cells(myCnt, "B").Value = x Cells(myCnt, "C").Value = y Next FF End Sub
BMPファイルを読み込んで配列に書き出すプログラムを作ろうとしています。 BMPファイルの構造は http://www.geocities.co.jp/Playtown-Knight/6845/ … のページに書かれてあるのですが、 typedef unsigned short WORD typedef unsigned long DWORD typedef unsigned char BYTE typedef long LONG などの「符号無し整数」で定義された変数を使う必要があります。 http://homepage1.nifty.com/rucio/main/kiso/DataT … のページにあるようにVBではUlongやUshortが使えるようなのですが、 VBA上で Dim bfSize As ULong とすると、「ユーザー定義型は定義されていません」 と表示されます。 参照設定のところで何か設定を行えば良いと思うのですがどこを設定すれば良いのでしょうか？ もし、使えないとして、VBAで2バイトや4バイトを数値として読み込むにはどうすれば良いでしょうか？
すいません、教えて下さい。 VBSを利用して16進数にてバイナリファイルを生成したいです。 例えばSJIS文字コードの文字列"あ"の場合だと16進数では"82A0"です。 その"82A0"を指定してバイナリファイル出力を行いたいです。 自分で色々と試しましたが、何故か出力ファイルの結果がバイナリで"81 45 A0"となってしまい 結果的に"あ"が表示されません、、、。 目的としてはVBSでビット演算子の論理和による暗号化を行いたいです。 申し訳ありませんが、ご教示頂ければ幸いです。
vbaでTypeステートメントはどういう時に使えばいいのでしょうか？ 今までTypeを使わずに問題なくコードを作ってきたのですが Typeを使いどころがわかりません。
C言語とPICのアセンブラは分かるんですが、 VB系は初心者です。 SetやWithの使い方やメリットなど 分かり易く解説していただけますでしょうか
VB2010でSQLサーバを使ったアプリを作成しました。 多くの方に使っていただきたいので、アプリの配布 をする為に、書物を読んで拡張子EXEの実行ファイル を作成し、Windowsインストーラも作成して、別の PCで配布用のソフトを実行させました。 すると、ソフトは快調に動きますが、SQLサーバと関連 するページに移る際に、次のようなエラーが出ました。 「Unable to load the native components of SQL Server Compact corresponding to the ADO.NET provider of version 8080. Install the correct version of SQL Server Compact. Refer to KB article 974247 for more details.」 SQLサーバをインストールしないと、サーバに関連 するページは動かないと言う事でしょうか。 良い対応策がございましたら、ご教授ください。
今まで、IE9を使っていて、vbaを使ってIE操作をしていました。 この度IE11にしたら、今まで使っていたvbaがエラーになったりするようになりました。 なぜバージョンが変わるだけで、エラーになるのでしょうか？ 同じサイトなのでソースは変わらないのですが。
Access初心者です（2010使用） 業務でDB作成をしているのですが、チェックボックスで実行可能な内容なのかが分かりません。 ご教授下さい。 ＜テーブル＞ マスターT 通し番号（オートナンバー） 製品（テキスト型で内容は１０個の種類があります） カテゴリー（上と同じ） 素材（上と同じ） 備考1（テキスト型） 備考2（テキスト型） このテーブル内にある 製品、カテゴリー、素材の3フィールドについて、フォーム上でそれぞれチェックボックスを項目数分作り、チェックしたもののレコードを別クエリで表示させる（チェックは複数可能） というものが作りたいのです。 以下フォームイメージ ＜製品＞　＜カテゴリ＞　＜素材＞　　 □A　　　　　□1　　　　　　□あ　　　　　　　 □B　　　　　□2　　　　　　□い　　　　　　←＜製品＞＜カテゴリ＞＜素材＞のうちどれか１つでも □C　　　　　□3　　　　　　□う　　　　　　　　チェックが入ればそのレコードを別表示させたい □D　　　　　□4　　　　　　□え □E　　　　　□5　　　　　　□お この動作がチェックボックスで可能なのか、他に方法があるのか 参考書を当たってみたのですが希望する内容を見つけられませんでした。 不勉強で申し訳ありませんが、お力をお貸しください。 宜しくお願い致します。 （作業者のレベルとしては、コンボボックスで絞り込みを作れる程度です。 マクロ、VBAも初学者レベルです）
マクロ超初心者です・・・ エクセルマクロでIEを操作したいのです。 ****エクセルのセルA1が「OK」の場合、以下の処理を実行**** 処理1．セルB1に数値として表示済みのURLを取得してIEを開く。 処理2．開いたIEのtextareaにセルC1の文字を入力。 処理3．submitボタンを押して送信。 ****HTMLは以下の通り（一部省略）**** .1..<form name="directForm" enctype="multipart/form-data" method="post" action="/thr_rp1/"> .2....<input type="hidden" value="120" name="bid"> .3....<input type="hidden" value="3217234" name="tid"> .4....<input type="hidden" value="103" name="ctgid"> .5....<input type="hidden" value="8" name="acode"> .6....<input type="hidden" value="1" name="tp"> .7....<input type="hidden" value="2" name="prof_flg"> .8......<ul class="display inqForm rCate"> .9........<li> 10..........<input id="name" type="text" tabindex="1" maxlength="16" onclick="fun_focus(this)" size="16" value="" name="name"> 11........</li> 12........<li> 13..........<input id="trip" type="text" tabindex="2" maxlength="16" onclick="fun_focus(this)" size="16" value="" name="trip_pass"> 14........</li> 15........<li> 16..........<input id="email" type="email" tabindex="3" maxlength="50" onclick="fun_focus(this)" size="30" value="" name="mailaddr"> 17........</li> 18........<li> 19..........<textarea class="required" required="" tabindex="-1" onkeyup="showCharCnt('resize-demo', 'idCharCnt')" onclick="fun_focus(this)"></textarea> 20..........<textarea id="resize-demo" class="required" required="" tabindex="4" onkeyup="showCharCnt('resize-demo', 'idCharCnt')" onclick="fun_focus(this)" name="body"></textarea> 21........</li> 22........<li> 23..........<input id="delpaass" type="password" tabindex="5" value="" name="del_pass"> 24........</li> 25........<li class="noborder"> 26..........<div class="center"> 27............<input type="submit" tabindex="6" value="送信する"> 28..........</div> 29........</li> 30....</ul> 31..</form> ****//HTML（終）**** 上記のHTMLにもありますように、20行目のtextarea「name="body"」に処理2を実行後、 27行目の「value="送信する"」を押すというマクロを作成したいのです。 いろいろなサイトを参考にさせていただいて、切り貼りをした結果、 次のようなマクロを書きました。 ****マクロ**** Sub test() If Range("A1").Value = "OK" Then Dim IE As Object Set IE = CreateObject("InternetExplorer.Application") IE.Visible = True IE.Navigate Range("B1").Value '画面へ移動する waitNavigation IE IE.document.All("body").Value = Range("C1").Value ObjIE.document.Forms(0).Submit End If End Sub '画面移動の完了待ち Sub waitNavigation(IE As Object) Do While IE.Busy Or IE.ReadyState < 4 DoEvents Loop End Sub ****//マクロ（終）**** ====私にとっての難題 (+д+;lll )==== 処理1と処理2はクリアできたのですが、処理3がどうしてもうまくできません・・・ 27行目のsubmitにはIDやnameもなく、そういった場合は ObjIE.document.Forms(0).Submit と記述すればいいといろんなサイトに書いてありましたが、 マクロを実行するとエラー（91、424など）が出るばかりで、処理を完了できません。 Ifによって処理3までを実行して、その後はIfに関係なく次のマクロを記述したいのです。 上記のマクロは、詳しい方がご覧になれば「デタラメな書き方」と採点されると思います。 どなたかご教授頂けましたら幸いです。 よろしくお願いいたします。
VB2013で、DataGridViewのRowsコレクションに独自のメソッドを追加することは可能でしょうか。 Inherits System.Windows.Forms.DataGridViewで継承してメソッドを追加するだけでは DataGridView.XXXといった形式になってしまうので・・・。 よろしくお願いいたします。
ＶＢかＣ＃を使って出力したファイルをGoogleDriveやYahooボックス、ＤｒｏｐＢｏｘなどに保存させたいのですが、いまいちやり方がわかりません。 専用アプリをインストールすれば自動的にアップロードしてくれる設定などはできそうですが、 そうではなく自アプリから直接アップロードさせたいのです。可能でしょうか？ どこかにサンプルコードなどが公開されていないでしょうか？
VisualBasicからcsvファイルを以下のようなプログラムで読み込んでいます。 Open ファイルパス For Input Shared As #1 Do Until EOF(1): Input #1, A(i), B(i): i = i + 1: DoEvents: Loop Close #1 n行2列のcsvファイルとn行3列のcsvファイルを読み込んだ時に A(2)にセルB1、B(2)にセルB2の値を代入したいです。 現状だとn行3列のcsvファイルを読み込んだ時に A(2)にはセルA3の値が入ってしまいます。 n行3列の3列目のデータは無視したいです。
商品コード一覧表をＶＢＡ「エクセル2003」で作成したいのです。 ２年ほど前に、このサイトで助けていただいたものです。 http://oshiete.goo.ne.jp/qa/7578507.html ↑前回のものを利用していたのですが、今回、改良を加えていただいたいのです。 改良点は２つです。 １）６面を１２面に増やす。 ２）重複の少ないもから優先して抽出できるように（当面は400個の予定） （問題点） 現在は６面のうち５面が同じになってしまう時もあります。 できる限り、重複しないものから優先的に並べられるようにしたいと思っております。 どうかよろしくお願いいたします。
以下のような表があるとします 　　　　A列　　B列　　C列 １行　　１ ２行　　　　　　　５　　　６ ３行　　２　　　　 ４行　　　　　　　　　　　７ ５行　　３ 各列の最後の行に以下のような回答を表示させる関数が知りたいです。 A列の一番最初の文字は１ B列の一番最初の文字は５ C列の一番最初の文字は７ 分かりづらいかもしれませんがご教示ください
sheet1のE列に年度が入力されており、sheet1のb列からｄ列に文字が入力されています。 sheet2に「=countif(sheet1!B2:B13,"○"」という関数が入力されているのですが、年度ごとによって、B2:B13が、B14:B25というように置き換えるようにしていのです。 分かりづらい質問で申し訳ありませんが、ご教示いただきますようお願いします。
あるサイト…ぶっちゃけてしまうと、楽天ＲＭＳ（楽天市場の出店者がアクセスできる、店舗情報の編集サイト）なのですが Visual Basic 2010 でフォーム・アプリケーションを作り、自動アクセスして必要なファイルをダウンロードしてきたい　というのがオーダーです。 楽天RMSにはID/PASSのセキュリティが２つかかっています。 アクセスできるブラウザの種類に制限があるようですが、WebBrowser はIEと見なされるのか、接続できました。 http://web.biz-prog.net/index.html を参考に、ID/PASSをセットしたり、submitボタンを押すなどの処理を順番に行うよう記述したところ、概ね希望通りになったのですが、要望のsubmitボタンを押すコードを通過したところで --------- ファイルのダウンロード このタイルを開くか保存しますか？ --------- のダイアログがでました。 希望の動作としては、このダイアログの保存のボタンを「押した」処理を送り、保存場所を指定して、ファイルを自動ダウンロードしたいです。 ここから、Visual Basic 2010 WebBrowser ダイアログ 保存　など、Googleってみたのですが、希望のサンプルコードなどを見つける事ができませんでした。 見つけたページを総合すると、ファイルのダウンロードはWebClient.DownloadFileを使用するのが簡単な方法のようです http://dobon.net/vb/dotnet/internet/downloadfile … しかし、前述の通り、楽天ＲＭＳはID/PASSを２種類投入する認証ページを通過する必要があって、WebBrowser でそれを通過してからでないと、ファイルダウンロードのURLに辿り着けません。 WebBrowser でブラウザ上の処理を行った結果、出て来たダイアログボックスを処理する方法がありましたら、教えてください。
こんばんは！会社で使用しているエクセルシートで困っていることがあります。 sheet１に各年度毎の表が作成されています（A列は平成25年度、B列は平成26年度…） sheet2の特定のセルに年度を入力すると、sheet2のA列に入力されている数式「=Sheet１!A○」の"A"を"B"等に置き換えるマクロが知りたいです。 分かりづらい説明で申し訳ありませんが、よろしくお願いします。
こんにちは。 VB.NET Framework2.0でユーザフォーム開発しています。 Excel2010をインストール済みの環境で、WebBrowserからxls形式のExcelファイルを読み込むと、Excelの内容が表示されません。Excel2003をインストールした環境では、正しくWebBrowserにExcelの内容が表示されます。 解決の方法をご存知の方がいらっしゃいましたら、教えてください。
ＶＢ（2010）で行う構造体のソートの方法についてお尋ねします。 下記のようなデータのソートを行いたいです。 レコード数：約５００万（テキストファイル） 構造体： data(i).class1 data(i).class2 data(i).class3 data(i).class4 data(i).class1-.class2-.class3の順でソートを行いたいです。 いくつかのサイトで調べ、.NETのサンプルコートは見つけたのですが、当方初心者のため複数の条件でソートする方法と仕組みを理解することができませんでした。 どなたか教えていただけるとありがたいです。 よろしくお願いします。
皆さん、こんにちは。 Visual Studio 2013ですが、 Crystal Reportsが利用できるダウングレード版が 先日はSAPよりリリースされたようです。 http://scn.sap.com/docs/DOC-7824 上記のサイトをみているのですが、 英語の知識がなく、どれをダウンロードすればよいのかわかりません。 ご存知の方、いらっしゃいましたら、教えてください。 ちなみに、インストールする環境は以下となります。 **************************** Windows 8.1 Pro 64bit Visual Studio 2013
こんにちは！FolderBrowserDialogについてお教えいただけないでしょうか？ 下記のコードを実行しました。 ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' 'FolderBrowserDialogクラスのインスタンスを作成 Dim fbd As New FolderBrowserDialog '上部に表示する説明テキストを指定する fbd.Description = "フォルダを指定してください。" 'ルートフォルダを指定する 'デフォルトでDesktop fbd.RootFolder = Environment.SpecialFolder.Desktop '最初に選択するフォルダを指定する 'RootFolder以下にあるフォルダである必要がある fbd.SelectedPath = "C:\Windows" 'ユーザーが新しいフォルダを作成できるようにする 'デフォルトでTrue fbd.ShowNewFolderButton = True 'ダイアログを表示する If fbd.ShowDialog(Me) = DialogResult.OK Then '選択されたフォルダを表示する Console.WriteLine(fbd.SelectedPath) End If ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' デスクトップを選択すると、「C:\Users\owner\Desktop」、 Cドライブを選択すると、「C:\」となります。 フォルダを選択した後に、「abc.txt」という固定ファイルを出力させようと思っています。とりあえずは、文字列連結をしてフルパスを作成します。 選択したフォルダパスに「"\abc.txt"」と文字列連結すると、「C:\Users\owner\Desktop\abc.txt」になります。 これは、OKです。 しかし、「Cドライブ直下では、「C:\\abc.txt」となってしまい、円マークが2つできてしまいます。 これだと正しいパスにファイルを出力することができないと思います。 これを解決するには、つまり「C:\abc.txt」にするには、どのようにコードを書いたらいいでしょうか？FolderBrowserDialogは使うものと前提でお願い致します！
いつもお世話になっております。 一つのセルの文字列を分解して別のシートの指定したセルに一文字ずつ入力したいと考えています。 （例） 　 A　B C 　D E 　　　　　　F ・・・・・・・・・・・　　　　ＡＤ 1 2014/5/1 ・・・・ 　　2014/5/6・・・・・・・・・・・2014/5/31 2 3　　　　　　　　　　　　　　　こ 4 5　　　　　　　　　　　　　　　ど 6 7　　　　　　　　　　　　　　　も 8　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 9　　　　　　　　　　　　　　　の 別シートには、祝日の一覧が作成してあり、一つのセル"こどもの日"のように入力してあります。 F1のセルが2014/5/6なので、別シートの祝日データからデータをとばして、Ｆ3のセルに"こ"、一つ飛ばしてF5のセルに"ど"、F6のセルに"も"のように自動で入力したいのですが（他の祝日も同じく）、そういったことはマクロで可能でしょうか？ よろしくお願いいたします。
EXCELマクロでShrinkToFitの状態(True,false)を取得したいのですが・・・ どうやって取得したらよいかわかりません。 出来るのかどうかもわかりません。 ご存知の方教えてください。
VBAを使用して、Wordの文書から見出しとなっている行から章番号のみを選択し、エクセルの指定のセルにコピーしたいのですが、本文にも数字が入っているためうまく指定する方法が思いつきません。 Word文書の構成は先頭に変更履歴と目次が来て、見出し、本文に入ります。 構成は、見出しが来て本文が来ます。これを繰り返す形です。 1.1.×× ××はなんとかである。 これはなんとかを指している。 ※章と章の間は空白行が入ります 1.2.××× 1.1.で指し示すものはこの章でも適応される。 見出しは太字になっています。本文は太字ではありません。 ※見出しのフォントサイズはバラバラです。 章番号のみを指定してコピーする方法をご存じであればご教授ください。 よろしくお願いします。
確か、以前にこの方法を何処かで発見した記憶があるのですが、Googleで検索しても見付からないので質問とさせていただきます。 --------------------- Sub t() Call ("test" & 1) End Sub ----- Sub test1() MessageBox.Show("1が選択されました") End Sub ----- Sub test2() MessageBox.Show("2が選択されました") End Sub --------------------- 上記はエラーが出ます（「式はメソッドではありません」エラー） このように、プロシージャー名の一部や全部を変数にしてCallする方法は存在していなかったでしょうか？ 何処でというのも忘れてしまいましたし、Visual Basic 2010ではなく、ExcelかAccessのVBAだったと思うのですが、このCallの部分を変数にして、動的に呼び出すプロシージャーを変更する事ができた記憶があるのですが… 御存知の方、いらっしゃいましたら、よろしくお願いします。
Access初心者です。よろしくお願い致します。 コンボボックスとテキストボックスの連携がうまくいかずに苦戦しています。 Accessオブジェクト ＜テーブル＞ 　T_住所録 　　∟ID、名前、住所、電話番号、アドレス 　T_住所確認テーブル 　　∟名前、住所 ＜クエリ＞ 　Q_ラベル_住所録 　Q_住所確認テーブル 　Q_入力_住所確認テーブル ＜フォーム＞ 　F_入力_住所確認テーブル 　　∟コンボボックス(名前)、テキストボックス(住所) とあり、 「Q_住所確認テーブル」では、 「T_住所録：名前」＝「T_住所確認テーブル：名前」 「T_住所録：住所」＝「T_住所確認テーブル：住所」 を、つなげてあります。 フォームの「F_入力_住所確認テーブル」では、コンボボックスをクリックすると名前が選択でき、選択するとその名前の人の住所がテキストボックスに表示されるようにしたいのですがうまくできません。 ネットや書籍などを見ていろいろ試したのですが、ことごとく失敗しています。 「Me」とかダメでした。 ExcelのVBAは経験があるのですが、Accessはデータベースを少々編集した程度なので知識は浅いです。 なのでとても初歩的な質問かもしれませんが、どなたかご教授いただけますと幸いです。 とても勝手ながら、すごく急いでいて、どうにかしたいともがいているのですがどうにもならず焦っています。どうぞよろしくお願い致します。
VB.net 2010でプログラムを作成して居ます。 やりたい内容が同じで、同じコントロールを幾つか使う時、処理は共通にする事があると思います。 Case 1 sub_Std_Vlt_Dsp(0, frmMain.dgv_Std_100) '100Vの規格編集表示 Case 2 sub_Std_Vlt_Dsp(1, frmMain.dgv_Std_120) '120Vの規格編集表示 Case 3 sub_Std_Vlt_Dsp(2, frmMain.dgv_Std_200) '200Vの規格編集表示 この場合、sub_Std_Vlt_Dsp()は Sub sub_Std_Vlt_Dsp(ByVal iVolt As Integer, ByVal dgvList As System.Windows.Forms.DataGridView) '規格テーブルの編集/Edit of standars. '入力/Input 　 'iVolt as Integer 電圧ID/Voltage ID 'dgvList as DataGridView 表/List dgvList.Rows.Clear() '表示内容の初期化 'セルの設定 Setting of each cell dgvList.Columns(0).Width = 30 dgvList.Columns(0).DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter dgvList.Columns(0).HeaderCell.Style.Alignment = DataGridViewContentAlignment.MiddleCenter この様に記述する事により、各々のデーターグリッドビューをdgvListとして処理出来ます。 そこで、割り込みの時なのですが、やはり複数のデーターグリッドビューのCellEndEditでの処理が同じなので、上記例の様に処理する事は可能でしょうか。 現在は各データーグリッドビュー毎に以下の様なコーディングをして居ます。 Private Sub dgv_Std_200_CellEndEdit(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles dgv_Std_200.CellEndEdit '電圧毎の規格編集処理 '0:規格命令 1:結果命令 2:倍率 3:符号(1:マイナス可) 4:表示(1:非表示) '5:単位 6:項目 7:最大値 8:最小値 bUpdItm = True '編集ありフラグTrue設定 btnStdUpdate.Enabled = True '更新ボタン利用可 btnStdCancel.Enabled = True '取り消しボタン利用可 Select Case e.ColumnIndex 'コラム別処理/Process by each column Case 0 '列0/Column 0 規格コマンド bStatus = fncChkHex(dgv_Std_200(0, e.RowIndex).Value, 0, 2) 'コマンド　空白か2桁のヘキサ文字 Case 1 '列1/Column 1 結果コマンド/Result command bStatus = fncChkHex(dgv_Std_200(1, e.RowIndex).Value, 0, 2) 'コマンド　空白か2桁のヘキサ文字 処理内容が各データーグリッドビュー同じなので一つの割り込み先にまとめたいと思っています。 上記の　dgv_Std_200() を何らかの方法で他のデーターグリッドビューの時でも使える様にしたいのです。 なお、Handles の所に他のデーターグリッドビューのCellEndEditの飛び先を追加すれば、この割り込み処理に飛べる事は分つています。 直接先の例の様にコントロールの継承で無くても、例えばデーターグリッドビューの違いを番号等で伝えてもらつても構いません。 以前使って居たC++Builderは割り込み元のIDが取り込める様に成っていました。 どなたか、お分かりに成る方が居られましたらお教え下さい。
Windows7 64bitを使用しています。 これにVS2008をインストールし、VB、C#でアプリを作成しました。 このアプリは32ビットOSで動作するでしょうか？ 動作しないとしたら、32ビットOSでも動作できるアプリを吐き出す設定はどうすればいいでしょうか？
エクセルで貸出備品の管理を考えてます。 例えば・・・ 10個のＰＣがあります。（管理番号あり。） 利用日から返却日を入力して、その数値をもとに、管理番号ごとに、色づけされた月の管理表を作成したいのですが、どのように作成していいかわからないです。 よろしくお願いします。
　ＶＢＡなので低レベルすぎてここで質問する内容ではないかもしれませんが 　 　　 Dim 元データ As Variant Dim 文字数 As Variant 元データ = Range("D1:D3087") For i = 1 To 3087 ’元データに格納されている文字列をこの間で操作したい 　　　　　任意の文字を抜き取ってセルに貼り付ける 文字数 = Len(元データ) MsgBox 文字数 Next i 上記で　元データ　に　D1:D3087　の文字列を格納し文字列から必要な部分を抜き出しセルに書き込みたいのですが、エラーで止まります　D1:D3087　の1行目は麻B060516-MSE300です。 文字列を操作できないのは元データがstringじゃないので無理っぽいかんじがするのですが配列に取り込むにはvariantじゃないといけないみたいなので、良い方法があればご教示いただけると幸いです。
いつもお世話になっております。 表題の件につきまして、ご教示ください。 【処理内容】 メインフォームのボタンからポートをオープンし、 受信データ(1Byte)をテキストボックスに表示し続ける。 ※受信データは定期受信 通信をやめたいときにメインフォームのボタンから ポートをクローズする。 上記、クローズ時に、ほぼフリーズします。 原因はシリアル通信の受信イベントが別スレッドにて処理されているため、 Invoke()にてテキストボックスの更新をしており、 これが悪さをしているみたいです。 BeginInvoke()を使用するとフリーズは回避することができるのですが、 テキストボックスに表示される受信データの内容が激しく欠落してしまいます。 Invoke()を使いつつ、フリーズを回避する方法はないのでしょうか。 無知で大変申し訳ございませんが、よろしくお願いいたします。
.net初心者です。教えてください。Windows xpで動いていたプログラムをzwindows7上でインストーラからインストールしようとしたら、.netframework1.1 が必要ですというエラーメッセージが表示されました。ネットで調べてみたら、dotnetfix.exeとやらをダウンロードしてインストールしたら、プログラムのインストーラからインストールできました。このdotnetfix.exeとはどのようなものなのでしょうか？再頒布パッケージとかネットでは書かれていました。1.1で開発された対応プログラムは、やはり1.1が無いと基本windows7では動かないのでしょうか。
エクセル２０１０で、1つのフォルダ内にある複数のエクセルブック（約５０支店分）の売上シートから、担当者別の日次売上等の集計マクロを作成したいのですが方法がわかりません。支店ごとの担当者数は、支店ごとに違います。ご協力お願いします ■基本条件 ・毎日、支店がブック内の売上シートに入力（更新）し保存する。売上シートには、担当者が複数名登録されており、支店によって担当者数は異なります。 ・全店とも中身は同書式同形式ファイル 　例)売上報告Ａ店.XLS、売上報告Ｂ店.XLS・・・ ■マクロ（集計.XLS）でやりたいこと ・各支店ブックの売上シートから、担当者名（A5）・売上A（B5）・売上B（C5）を転記し明細表の作成 どなたか教えていただけますでしょうか？よろしくお願いします。
VB.net 2010でプログラムを開発して居ます。 VB.net データーグリッドビューで余白を無くしたいのですが、何か良い方法はあるでしょうか。 アンカーで左右上下を設定して、オートサイズに設定すれば余白が無くなる様ですが、1つのプログラムで複数の表を作成して居る為、これだと各表のセルの幅が表によって異なってしまい、見栄えが良くありません。 各セルの幅とスクロールバー、及び一番左の列の幅を足して、その幅をデーターグリッドビューの幅とすれば余白は無くなると思うのですが、一番左の列とスクロールバーの幅の求め方が分かりません。 どなたか解決策をご存知の方、お教え下さい。 宜しくお願い致します。 添付のAの部分を無くしたいのです。 Bの幅とスクロールバーの幅が判れば何とか成ると思うのですが。
MS-Wordの文章を検索して行頭に一致した文字がある段落を削除するマクロを作りたいと思いチャレンジしています。 たとえば，文章を頭から順に検索して，行頭にある文字が検索文字と一致した場合，その段落を削除して，次の行を検索し続け，文書が終わったら終了するようなマクロです。 小生，WordVBAを２日ほど前から学び始めたばかりで，ネットや参考書を探しまして，"@"マークが行頭にある段落を削除するというサンプルを作るところまでは何とかできたのですが，これを文章全体に一括して実行できるマクロにするにはどうすればよいかに手こずっています。 このマクロがあると仕事の効率がぐんとアップしますので，何とかしたいと思っています。 是非ご教いただければ大変ありがたく思います。 ＜サンプル＞ Sub test_DeleteParagraph() Selection.HomeKey Unit:=wdStory, Extend:=wdMove With Selection.Find .Forward = True .ClearFormatting .MatchWholeWord = True .MatchCase = False .Wrap = wdFindContinue If .Execute(FindText:="@", Forward:=True, Format:=True) = True Then Selection.HomeKey Unit:=wdLine, Extend:=wdMove Selection.MoveDown Unit:=wdParagraph, Extend:=wdExtend lVal = Selection End If Selection.Delete End With Selection.Find.ClearFormatting End Sub
検索の仕方なのか、判らないので教えてください。 ＥｘｃｅｌのVBAではApplication.OnTime メソッドがあり、 Application.OnTime TimeValue("17:00:00"), "test01" とすれば、17時ちょうどにtest01というプロシージャが実行されます。 フォームを作って Application.OnTime UserForm1.TextBox1.Value, "test01" のようにすれば、TextBox1に時間指定して、その指定時間にtest01を起動する事も可能で、業務用アプリとして実際に使用しています。 では、これをVisual Basic 2010で同じように実行するにはどうしたら可能でしょうか？ googleで調べても、時計のように、一定時間（1秒ごと）にラベルの内容を書き換え表示するようなサンプルは見つかるのですが、指定時間に、指定の処理を実行する　というようなサンプルは見つかりませんでした。 指定時間にFTPにファイルをアップしたり、指定時間にWEBブラウザからHTMLを取得したりと、いろいろ使い道があって結構つかっていますので、この「指定した時間に、処理○○を記述したプロシージャーを実行して」という処理ができないとかなり困ります。
Microsoft Visual Basic 2010 Express　の質問です。 ExcelVBAや、AccessVBAで作成したプログラムを、VBに移そうと思っています。 ネットや本のサンプルを、自分のやりたいことに修正しつつ、一応、動作としては希望通りなのですが、元々VBAで簡易に作ったものだけに、本来なら注意すべきインスタンスの管理などがおざなりになっています。 動作は一応正常ですが、果たしてこれで良いのか不安でもありますので質問させていただきます。 大抵の本やサンプルには、複数のSQLを連続で発行するようなものは載っていませんが、いくつものSQLを順次発行していく処理をする時は、どのように記述するのが正しいでしょうか？ 例えば、Access2010データベース、C:\test.accdb　には、別のテーブルからリンクしたテーブル genpon　があるとします。これをコピーしたテーブル、tb01を作る場合、 ------------------------------------ Dim com As OleDb.OleDbCommand Dim cn As OleDb.OleDbConnection = New OleDb.OleDbConnection( _ "Provider=Microsoft.ACE.OLEDB.12.0;" & _ "Data Source=C:\test.accdb;") cn.Open() ''現在のデータを削除 com = New OleDb.OleDbCommand("DROP TABLE [tb01];", cn) com.ExecuteNonQuery() ''現在のデータを削除 com = New OleDb.OleDbCommand("SELECT * INTO [tb01] FROM [genpon];", cn) com.ExecuteNonQuery() ------------------------------------ SQLとしては、現テーブルをDROPして、SELECT * INTO　を発行すれば希望通りで、上記もその通り動きますが、NEWでインスタンス作成を繰り返しているのは、やってはいけない事ではないでしょうか？ さらに、例えばこのコードの続きとして、FOR～NEXTや、DO～LOOPで繰り返しを設け、その中でINSERT INTO を発行しながら、データを登録するような処理を加える場合、このままでは　NEWをループの回数分、繰り返す事になります。 プロシージャの中で、ループなどで複数のSQLを発行する場合、記述として正しい作法がありましたら、教えてください。
VBAでコレクションの要素を一括削除する方法として、下記のコードが掲載されていましたが Nothingを代入しないままNewを使用しても問題ないでしょうか。 また、この辺りの挙動について詳しく書かれているサイトがありましたら、ご教示頂ければ幸いです。 Dim fruits As Collection Set fruits = New Collection With fruits Call .Add("バナナ") Call .Add("リンゴ") Call .Add("ミカン") End With Set fruits = New Collection
A列の値を元にフォルダを作成するVBAで 富士通の緑の本を参考にして作ってみたのですが、 うまく動作しません。 1.Sub フォルダ作成() 2. 3. Dim MyFSO As New FileSystemObject 4. Dim Folderpath As String 5. Dim i As Integer 6. 7. i = 1 8. 9. Do While Cells(i, 1).Value <> "" 10. 11. Folderpath = ThisWorkbook & "\Cells(i, 1).value" 12. 13. MyFSO.CreateFolder Path:=Folderpath 14. 15. i = i + 1 16. 17. Loop 18. 19.Set MyFSO = Nothing 20. 21.End Sub 目的の動作は 今のワークブックのある場所にSheet1のA列の1～データがなくなるまで、 そのセルの値のフォルダを作成する。 になります。 よろしくお願いします。
早速ですが。シートは　ORＧDATA　と　計算　の２枚 ORGDATA　は　WEB経由で　秒単位で　７セルほどのデータを受信します。 それを、５分単位で　データを集約し　７セルほどのデータとして、計算シートに　コピーで　送ります。 計算シートは、生データは　７セルの　２万行　Ｉ列から　ＢＵ列　５０行？位数式が　埋まっています。 基本　ORGDATAシートは　Worksheet_Calculate()　で　受信しますので、計算を止められません。 で、計算シートの　再計算を止めて、データが送り込まれたとき（５分ピッチ）のみ　再計算させたい。 が　リクエストです。 下記が　やってみたことの要約です。 Workbook_Open() ５分タイマーセット Application.Calculation = xlCalculationAutomatic Me.Worksheets("計算").Select Me.Worksheets("計算").Activate ActiveSheet.EnableCalculation = False　 これが機能してないような？タスクバーに再計算してる％表示が出ている。 Me.Worksheets("orgdata").Select データ受信、５分後のタイマーで endsisu = keisan.Cells(1000, 2).End(xlDown).Row + 1 orgdata.Range("a4:ｇ4").Copy Destination:=keisan.Range("b" & endsisu) keisan.Range("i" & endsisu - 2 & ":bu" & endsisu - 2).Copy keisan.Range("i" & endsisu & ":bu" & endsisu).PasteSpecial Paste:=xlPasteFormulas ここまでは　実行される。 下記のどちらかで　ＶＢエラー400（タイマーで　実行しているから） keisan.Range("i" & endsisu - 2 & ":bu" & endsisu).Select Selection.Calculate 要は　OREGDATAは　常時再計算ＯＮ 計算シートは　常時再計算ＯＦＦで　データが送り込まれた時だけ　再計算で　済んだら　ＯＦＦ が希望なのですが。 ご教示願えれば助かります。
いつもお世話になっております。 指定した文字数分の文字列を抽出し、他のシートから抽出した文字列を検索して表示するのに セルBB2に　=IF(AW2="",VLOOKUP(LEFT(N2,2),商品マスタ!$M$21:$N$67,2,0)) という数式を入れています。 セルBB2のみではなくBB列でずっと同じ処理をするため、マクロで処理しようと思うのですがなにぶん未熟でいい方法がわかりません。 Mid関数を使えばいいのかな、とは考えましたが、どう書けばいいのかわからず前にすすめません・・・・ どなたかご教授いただければ幸いです。
VB２０１３でプログラムを作成し、データベースは Expressに一緒にダウンロードされたSQLServerを 利用しています。 作成したEXEファイルなどはファイルサーバーに入っており 複数のクライアントPCで利用しています。 1台のPCで使用していると他のPCではデータベースをOPENできませんと言われて 2台同時に使用できません。 完全にプログラムを終了させないとメニューに戻っただけではだめでした。 （メニュー画面はフォームを呼ぶだけなのでデータベースは扱ってません） 簡単なプログラムなのでフォームの中のprivate sub 単位でOPEN～CLOSEはしてます。 EXPRESSは複数台で利用することはできないのでしょうか？ ほかのPCをすべて終了させればできるのです。 なにか対処の方法をお解りの方がいらっしゃいましたらよろしくお願いいたします。
いつもココにはお世話になっております。 またよろしくお願いします。 VB.net（Visual Studio Express）を使用しています。 OSはＷｉｎ７ 64Bitです。 Form1にStatusStrip（名前：stsStrip1）を配置してその中にStatusLabel（名前：stsbarLabel1）がある普通のステータスバーがあります。 以下の様な処理をしているのですが、存在しないシリアルポートを設定するとWrite(sndData)で8秒間止まりますが、その間”処理中”が表示されないことが有ります。（１～２秒経って表示されることもある） どうも、IO処理で待ちの状態になるとステータスバーの表示がうまく更新されないようなのです。 （UDP通信の時も同じ現象でした） StatusStripの表示を即座に更新させるようなことは出来ないものでしょうか？ よろしくご享受願います。 '======================================================= stsbarLabel1.Text="処理中" Try 　　　SerialPort1.PortName = "COM6"　　　　'存在しないポートを設定 　　　SerialPort1.WriteTimeout = 8000　　　　'タイムアウト8秒 　　　SerialPort1.Open() 　　　SerialPort1.Write(sndData)　　　　　　　　'送信 　　　SerialPort1.Close() Catch ex As Exception 　　　エラー処理 End Try 　　　 stsbarLabel1.Text="" '=======================================================
エディタ上の文章 abc<table border=1><tr><td>A</td><td>B</td></tr><tr><td>C</td><td>D</td></tr></table> の文章をcopyして、適当なセルにpasteすると、この文章のままではなくて、A、B、C、Dが違う セルに入ってしまいます。 <とtabelの間に半角をいれて abc< table border=1><tr><td>A</td><td>B</td></tr><tr><td>C</td><td>D</td></tr></table> をcopyして、セルに入力すると、そのセル内には入りますが、abc< table border=1>ABCD とタグが無視された形で入力されてしまいます。 今まではこんな事はなかったのですが、HTMLタグが消えないようにする事はできないでしょうか？
VBS初心者です。 以下のサイトを参考に，特定のフォルダにファイルが追加されたら， 指定のメールアドレスに添付して送信するVBSを作成してみました。 http://plaza.rakuten.co.jp/mscrtf/diary/20120626 … ちなみに記述を少しだけ変えて， 送信したファイルを削除しないようにしています。 しかしこうしてしまうと，「送信フォルダ」にファイルが追加されると， その新しく追加されたファイルではなく， 前から置いてある別のファイルが送信されてしまいます。 「最新のファイルを添付して送信」することはできないでしょうか？ またファイルを添付してメールを送信することはできるのですが， なぜか送信受信ともに，まったくおなじメールが2通作成されてしまいます。 （2通同時ではなく1通目が届いて30秒後くらいにもう1通届きます）。 あと，受信側メールアドレスをbbb@hotmail.co.jpにし， smtpserver：smtp.live.com smtpserverport：587 とすると 「転送においてサーバーに接続できませんでした」と出てしまいます。 ポート番号を，465や25にしてみましたがだめでした。 どこを直せばいいでしょうか？ 以上の解決策をご教授ください！ コードは以下です。 Dim Fs, strPath, Fl, F, NewFile, NewFileFP, OutF Set Fs = CreateObject("Scripting.FileSystemObject") strPath = "C:\FileSend\送信フォルダ\" NewFile = "" Set Fl = Fs.GetFolder(strPath) For Each F In Fl.Files If F.Name > NewFile Then NewFile = F.Name End If Next NewFileFP = Fl & "\" & NewFile Dim WshShell, BtnCode Set WshShell = WScript.CreateObject("WScript.Shell") Set objShell = CreateObject("Wscript.Shell") Set oMsg = CreateObject("CDO.Message") oMsg.From = "ファイル送信元 <aaa@gmail.com>" '送信元 oMsg.To = "bbb@hotmail.co.jp" '送信先 oMsg.Subject = "ファイルの送信test3" '件名 oMsg.TextBody = "ファイルをお送りします。" 'メール本文 oMsg.AddAttachment NewFileFP '添付 oMsg.Configuration.Fields.Item _ ("http://schemas.microsoft.com/cdo/configuration/s …) = 2 oMsg.Configuration.Fields.Item _ ("http://schemas.microsoft.com/cdo/configuration/s …) = "smtp.googlemail.com" oMsg.Configuration.Fields.Item _ ("http://schemas.microsoft.com/cdo/configuration/s …) = 465 oMsg.Configuration.Fields.Item _ ("http://schemas.microsoft.com/cdo/configuration/s …) = True oMsg.Configuration.Fields.Item _ ("http://schemas.microsoft.com/cdo/configuration/s …) = 1 oMsg.Configuration.Fields.Item _ ("http://schemas.microsoft.com/cdo/configuration/s …) = "aaa@gmail.com" oMsg.Configuration.Fields.Item _ ("http://schemas.microsoft.com/cdo/configuration/s …) = "******" oMsg.Configuration.Fields.Item _ ("http://schemas.microsoft.com/cdo/configuration/s …) = 60 oMsg.Configuration.Fields.Update oMsg.Send oMsg.Configuration.Fields.Update oMsg.Send Set OutF = Fs.OpenTextFile("C:\FileSend\test.txt",8) OutF.WriteLine "Date[" & date & "] Time[" & time & "] File[" & NewFile & "]" OutF.Close objShell.Popup "メール送信しました。", 0, "送信完了", 0 Set Fs = Nothing Set Fl = Nothing Set OutF = Nothing 使用しているパソコンは Win7Professional 32bit です。 よろしくお願いいたします！
すいません教えて下さい。 ADにOUが複数あります。 OU一覧を取得するにはどのようにすれば良いでしょうか？ 色々やり方はあると思いますが、出来るだけ簡単な方法で実現したいです。 よろしくお願いします。
OS:Windows 7 64bit 開発環境：Visual Studio 2013 Express リッチテキストボックスでキャレットの幅を変更したいのですが、うまくいきません。 ------------------------------------------------------------- 'キャレットを作成する Private Declare Function CreateCaret Lib "user32" _ (ByVal hWnd As IntPtr, _ ByVal hBitmap As IntPtr, _ ByVal nWidth As Integer, _ ByVal nHeight As Integer _ ) As Boolean 'キャレットを表示する Private Declare Function ShowCaret Lib "user32" _ (ByVal hWnd As IntPtr) As Boolean Private Sub RichTextBox1_Enter(sender As Object, e As EventArgs) Handles RichTextBox1.Enter 'CreateCaret(RichTextBox1.Handle, IntPtr.Zero, 7, 15) CreateSolidCaret(5, 10) ShowCaret(RichTextBox1.Handle) End Sub ------------------------------------------------------------- 以上のようにして RichTextBox1 にフォーカスが来た時にキャレットの幅を変えるようにしているのですが、一度だけフォーカスが来た時にほんの一瞬だけ四角いキャレットが見えるのですが、すぐにＩ型に戻ってしまいます。 ググっても上記ソースくらいしか見つかりませんでした。 どなたかご享受願えませんでしょうか？ よろしくお願い致します。
エクセルで　シュミレーションをしています。 パラメータは　10個　パラメーター変化数　5 5*5*---10乗　の計算 秒で　２０個ほど　パラメーターは進む？　で　まあ　１週間も有れば・・・・ 所が、１日めで　ハングでもない、とにかく　止まるというか パラメータ全く動かず。 ＶＢの実行の　中断、実行でも　動かず。 保存して タスクマネージャーの　メモリーを見ると ハング状態　　　　　　　　　　：リセットした状態のメモリー 合計　　　　　4002　　　　　　　：　4002 キャッシュ　2200（曖昧）　　　：　416　 利用可能　2000（曖昧）　　　　：　2435 空メモリー　200（正確）　　　　：　2461　　 空メモリーが　200　と　少ない。 これが原因だろうと　思うのですが。 キャッシュを開放する方法って　有るのでしょうか ループの中で DIM　set　など　一切　ありません。 セルに値を代入。クリヤーせずに　全て上書き 自動計算　ON 相関係数算出などは　有りますが キャッシュが　原因か　それなら解放は？ それ以外の原因は？ 何かご教示願えれば幸いです。 　　
VB.net でプログラムを開発して居ます。 プログラムは海外拠点に出すものなのでメッセージは英文にしようとして居ます。 プログラムで出すメッセージは英文にしていますが、問題はシステムが出すメッセージです。 たとえば try ・・・・・・・・・ catch ex as exception MsgBox( ex.Message ) end catch とした場合、メッセージの内容が日本語に成ってしまいます。 当然、英文OS下でコンパイルすれば英文メッセージに成るでしょうが、手元に英文OSのPCはありません。 海外拠点は英文OSを使って居ます。 そこで、質問なんですが、この様なVB.netシステムが出すメッセージを英文にするにはどうしたら良いのでしょうか。 先ほどVB.Netの再インストールを英文でやってみましたが、これはインストールやコンパイルのメッセージが英文に成るだけの様でした。 PCの言語切り替えも英語にして診ましたが駄目でした。 NETのインストールを英語(選択が出来たかは定かではありませんが)でやり直すとかで英文の表示になりますでしょうか。 理想的には、海外拠点のPCは英文OSで、その他のモジュールも英文に成っているはずなので、開発は日本語でやっても、現地でプログラムを実行すると自動的に英文に成っていれば一番良いのですが。 お分かりに成る方がおられましたらお教え下さい。 宜しくお願いいたします。
お世話になります。 2個の条件に一致するものを別シートに抽出したいのですが、お知恵を貸してください。 Excelシートで下記のような表があります。 これをL列（品名)かつS列(品質)の条件に一致するデータで新しいシートを作成したいのですが、 その際に新しいシート名は"AA1"のようにしたいのです。 条件がC列(品名)だけであれば下記で動いたのですが…。 （データ） A列　入荷日 I列　 品目コード L列　品名 S列　品質 V列　在庫 A・・・・・・I・・・・・・・・・L・・・・・・・・・S・・・・・・・・・V 1/1・・・・01・・・・・・・AA・・・・・・・・1・・・・・・・・・20 2/2・・・・01・・・・・・・AA・・・・・・・・1・・・・・・・・・10 2/3・・・・01・・・・・・・AA・・・・・・・・2・・・・・・・・・10 2/3・・・・01・・・・・・・AA・・・・・・・・2・・・・・・・・・10 2/3・・・・01・・・・・・・BB・・・・・・・・1・・・・・・・・・10 ※以下、最大100品目の行数10000程です。 　↓↓ （実行後希望） シート名 AA1 A・・・・・・I・・・・・・・・・L・・・・・・・・・S・・・・・・・・・V 1/1・・・・01・・・・・・・AA・・・・・・・・1・・・・・・・・・20 2/2・・・・01・・・・・・・AA・・・・・・・・1・・・・・・・・・10 シート名 AA2 A・・・・・・I・・・・・・・・・L・・・・・・・・・S・・・・・・・・・V 2/3・・・・01・・・・・・・AA・・・・・・・・2・・・・・・・・・10 2/3・・・・01・・・・・・・AA・・・・・・・・2・・・・・・・・・10 シート名 BB1 A・・・・・・I・・・・・・・・・L・・・・・・・・・S・・・・・・・・・V 2/3・・・・01・・・・・・・BB・・・・・・・・1・・・・・・・・・10 Sub Sheet抽出() Dim i As Long, Lstrow As Long, myName As String Dim MySht As Worksheet, myFlg As Boolean Application.ScreenUpdating = False With Sheets("sheet1") '準備 For i = 2 To .Cells(.Rows.Count, 1).End(xlUp).Row myName = .Cells(i, 9) 'シートの存在確認 For Each MySht In Worksheets If MySht.Name = myName Then myFlg = True '既にシート在り!! Sheets(myName).Range("a1") _ .CurrentRegion.Offset(1).ClearContents Exit For End If Next '新規シートの追加 If myFlg = False Then Worksheets.Add.Name = myName End If With Sheets(myName) .Range("A1") = "入荷日" .Range("I1") = "品名コード" .Range("L1") = "品名" .Range("S1") = "品質" .Range("V1") = "在庫" End With myFlg = False Next 'データの転記 For i = 2 To .Cells(.Rows.Count, 1).End(xlUp).Row myName = .Cells(i, 9).Value .Range("A" & i & ":Ｖ" & i).Copy _ Sheets(myName).Cells(Rows.Count, 1).End(xlUp).Offset(1) With Sheets(myName) .Activate Lstrow = .Cells(Rows.Count, 1).End(xlUp).Row .Cells(Rows.Count, 1).End(xlUp).Offset(1, 21) = "" .Cells(Rows.Count, 1).End(xlUp).Offset(1, 21) = _ "=SUM(v2:V" & Lstrow & ")" End With Next End With Sheets("Sheet1").Activate Application.ScreenUpdating = True End Sub 実行後希望のように抽出するには、どうすれば良いのでしょうか？ よろしくお願いいたします。
現在、VBAのリストボックスへの複数列の項目追加に苦戦しております。 まだまだ未熟の為、どうか皆様のお力をお貸し下さい。 手法等、間違えてる箇所があるかと存じますので、ご指摘と、また別に手法がございましたら、ご教授お願い致します。 現在、リストボックスへの複数列の項目追加の為、以下のように記述しておりますが、上手く動きません。 ※あらかじめ、UserForm1にリストボックス（ListBox1）と、コマンドボタンを作成しています。 ※Sheet1に、添付のように書いております。 Private Sub CommandButton1_Click() Dim rngTemp1 As Range Dim rngTemp2 As Range Dim rngTemp3 As Range With Sheets("Sheet1") .Activate Set rngTemp1 = .Cells(2, 2) rngTemp1.Select Set rngTemp2 = .Range(.Cells(2, 4), .Cells(2, 6)) rngTemp2.Select Set rngTemp3 = Union(rngTemp1, rngTemp2) rngTemp3.Select End With UserForm1.ListBox1.ColumnCount = rngTemp3.Count UserForm1.ListBox1.List = rngTemp3.Value 'ここでエラー End Sub ウォッチ式で見ると、rngTemp3には、rngTemp1の値しか入っておらず、その為にエラーとなっているようです。 が、rngTemp3.Selectの時点では、正常に選択出来ております。 (1)そもそもListプロパティで、離れたセルをリストボックスへ追加するのは無理なのでしょうか？ ※Userform1.ListBox1.List=rngTemp2.Valueとすると正常に追加されます。 (2)このような場合を解決する手段は他にありませんでしょうか？(配列の手法などありましたら、教えて下さい。) ※ちなみに実際のデータ列は10列以上ある為、AddItemでは10列目でエラーとなり、無理でした。 環境は、Office2010になります。 説明がわかりづらく申し訳ありませんが、何卒よろしくお願い致します。
お世話になっております。 表題の件につきまして、 質問させてください。 ショートカットキーでフォームを表示するアドインを作成したのですが、一点解決できない問題がございます。 ※フォームは最前面に表示します。 A.xlsで、フォームを表示。 ↓ B.xlsを選択して、アクティブする ↓ 表示されたフォームを選択 上記操作を行うと、A.xlsがアクティブになってしまいます。 フォーム選択で、ブックのアクティブ状態が切り替わらないようにするにはどうすればいいのでしょうか。 説明下手で申し訳ないですが、 ご教示願います。
お世話になります C言語等ですとLog10関数がありますよね たとえば値が12345の数値ＡＡをLog10すると 4.091491 = Log10(AA) になると思うのですが これをＶＢ６の場合 AA / Log(10)と思ったのですが、 5361.3653となってしまいます。 Logの使用法が間違っているのだと思うのですが、 正しい使用方法を教えていただけないでしょうか？
作業中中断により日付を変更したのかどのボタンまでクリックしたのかがわからなくなります。 A2セルの日付を変更したらB5セルが赤表示、ボタン１をクリックしたらC5セルが青表示、ボタン２をクリックしたらD5セルが緑表示、ボタン３をクリックしたらE5セルが黄表示等どこの作業まで実施したのかわかるようにしたいのですがVBAのコードがお解りになる方よろしくお願いします。
下記のマクロを実行すると BBB.Save のところで、実行時エラー 2147024893(8007003)が発生します。 「ショートカット"C:\Documents and Settings\ユーザー名\MyDocuments\Documents and Settings\All Users\スタート メニュー\プログラム\スタートアップ\拡張子無しのファイル名.lnk"を保存できません。」 ヘルプをみると、オ－トメーションエラー(Error440)となっています。 いろいろ調べましたが解りません。助けて下さい。 Sub 自動起動設定() Dim AA, BB, CC, DD Dim AAA, BBB AA = ThisWorkbook.Path CC = ThisWorkbook.Name CC = Left(CC, Len(CC) - 4) Set AAA = CreateObject("WScript.Shell") DD = Left(AA, 2) & "Documents and Settings\All Users\スタート メニュー\プログラム\スタートアップ" Set BBB = AAA.CreateShortcut(DD & "\" & CC & ".lnk") BBB.targetPath = AA & "\" & ThisWorkbook.Name BBB.Arguments = "/n,/e," & AA & "\" BBB.WindowStyle = 1 BBB.WorkingDirectory = AA BBB.Save Set BBB = Nothing Set AAA = Nothing End Sub
シート上にコマンドボタンをおきました。そしてそのボタンを押したたときの動きをVBAで書きました。 普通に動きます。 次にそのシートを新しいウィンドウで開き、並べて表示しました。一方のウィンドウ上でボタンは正常に働きますが、もう一方のウィンドウのシート上ではボタンは働きません。 どちらのウィンドウ上でも正常にボタンを働かせたいのですが、できません。どうすればいいのでしょうか。
エクセルVBEのThisWorkbook内に下記のようなイベントでコードを書いておき、 BOOKオープン時には実行されない単なるメモ的効果のものを書いておきたいと思います。 （これ以外にも複数のコードをたくさん記述しておきたい。） そして実際に使う時だけ有効に切り替えて使いたいと思っています。 コードは正しく書いておかないとオープン時にエラーメッセージがでてしまうので 「’」の記号を行頭につけてメモにしておくのはわかるのですが、行数が増えると全行頭に 記号を付けたり省いたりするのがかなり手間となります。 簡単に有効無効を切り替えて書いておく方法はありますか。 あるいは必要な部分だけ記号を全行頭に一気に付けたりとりはずしたりする方法はありますか。 Private Sub Workbook_Open() Sheets("販売").EnableSelection = xlUnlockedCells Sheets("顧客").EnableSelection = xlUnlockedCells Sheets("商品").EnableSelection = xlUnlockedCells End Sub
シュミレーションの結果が合わないのですが エクセル　列　約70　１パターン６列　の１０個と　合計列 行は　約３００　300*70＝　21.000セル？ セルには　何らかの　式が埋め込まれています。 １パターンの中の列に　手間のかかりそうなのは　１列だけ１８行の移動平均があります。他の列は、隣の足し算とか、比較してどうこう・・・（よって　移動平均は　合計１０列） で、このワンパターン　に　各パラメーターが有って　これを変化させて　再計算して　合計の変化でＭＡＸを　取り出す プログラムは ｃ4＝0　i4=0 ・・・・１０個のパラメーターに初期値代入　 この時点で　セルの再計算 do if max<合計セル　then 　　do 　　 Call Sleep(5) 　　DoEvents 　　　z = z + 1 　　　If z > 5 Then 　　　 Exit Do 　　　End If loop ここに　入れる？　合計セルが遅れて　パラメーターが先行してたら意味ないような？？ 　　max＝合計セル　 　　記録（max、ｃ４．ｉ４・・・・・・） endif c4=c4+1 この時再計算 ｓｌｅｅｐがないと　秒　１０回くらい変化する ２１．０００セルが　１０回計算してるとは　思えないのですが？ if c4>6 then c4=0 i4=i4+1　　この時再計算 if i4>6 then i4=0 o4=o4+1 　この時再計算 １０個まで同じロジックが続く ここに　ｓｌｅｅｐ　を　入れる？？ loop で、問題は　sleep　を　入れないとき、計算が進んで、別の保存プログラムにパラメータを入れて合計を見るのですが、記録されたパラメーターと合計が合わないのです。 しかし、 ＭＡＸが更新されたときの中にブレークポイントを付けて、ストップ状態で（別のことしてたので、かなり止まってた）、保存プログラムにパラメーター代入、合計確認すると合っていました。 で、知りたいのは 再計算とＶＢＡの整合性は　エクセルは　取ってくれないのか？ 再計算が完了しようが　途中であろうと、ＶＢＡだけ　お構いなしに　ループするのか はっきりしてるのは　パラメータを弄った　後に　Ｓｌｅｅｐ入れるのが　最適なのでしょうが、6*6*6*・・・ の仕事量ですから、ここで　０．５秒取られても　合計時間がかかる。 記録の所だけなら、ＭＡＸが更新した時だけですから　時間が早いのですが・・・ この辺の状況、ご存知の方が　いらっしゃればご教示ください。
職場のPC ・windowsXP ・excel2003 自宅PC ・windows7 ・excel2007 　職場には自分専用端末がないので、自宅でコードを書いてＵＳＢメモリにコピーし、 職場でペーストするという環境で起きた問題です。 　やりたいことは、顧客から送られてくるデータを sheet1 に保存し、 sheet2 に置いてあるマスターデータを参照して不必要な行を削除するマクロです。 　以下、コード ＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿ Sub 別シート参照デリート() Dim st1, st2 As Worksheet Set st1 = ThisWorkbook.Sheets("sheet1") '作業用シート Set st2 = ThisWorkbook.Sheets("sheet2") 'マスターシート Dim st1Row, st2Row As Integer st1Row = st1.Cells(Rows.Count, 1).End(xlUp).Row st2Row = st2.Cells(Rows.Count, 1).End(xlUp).Row Dim st1value, st2value As String Dim i, j As Integer 'マスターシートを参照して必要ないものは削除する For i = st1Row To 1 Step -1 st1value = st1.Cells(i, 3).Value For j = st2Row To 1 Step -1 st2value = st2.Cells(j, 1).Value If st1value = st2value Then Exit For '該当するなら必要行なので次へ ElseIf j = 1 Then st1.Cells(i, 3).EntireRow.Delete 'st2の先頭行は"品番"なので不必要＝削除 End If Next j Next i End Sub ＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿ 　自宅環境では問題なく動作するのですが、職場のPCだと ”オブフェクトが必要です” のエラーが返ってきます。 かといって、どの構文でエラーが出ているのか教えてくれない（反転しない）んです。 　どこにエラーがあるのでしょうか？ 　よろしくお願いします。
Chartコントロールを初めて使用します。 VB.net（VB2012）でChartコントロールを使用してグラフを描画するアプリを作っています。 X軸に稼動日　　1　　　2　　　3　　・・・・ Y軸に時間　　　1.5　　1.0　　2.75　・・・・ 上記のようなデータで折れ線グラフを描くことはできたのですが グラフはそのままで、Y軸のラベル表示を実数から時間表示に変更することは 可能でしょうか？　（例　1.5→1：30、　1.0→1：00、　2.75→2：45　・・・） Y軸のLabelSyale.Formatプロパティを設定すればいいのかなと思いましたが 上手くいきません。 分かる方いらっしゃいましたら、ご教授下さい。宜しくお願いします。
Excel VBAでユーザーフォームを作成し、ファイルを起動時にSheetを非表示にしてユーザーフォームのみ表示させるようにしました。 そうしたところ、 (1)実行ボタンをクリックすると作成されるExcelファイルも表示されなくなる (2)終了ボタンをクリックするとユーザーフォームを含むExcelファイルだけが閉じるのではなく、Excelのアプリ自体が終了してしまう(実行ボタンで作成したExcelファイルは表示したままにしたいのに閉じてしまう） という現象になってしまいました。 某書籍を参考にしてコードを書いたのですが、なぜかこのようになってしまいました。 ※「★」が書籍に指示があった箇所です。 ＜ThisWorkbook＞ Private Sub Workbook_Open() Application.Visible = False '★ myForm.Show '★ myForm.MultiPage1.Value = 0 'マルチページ構成のため End Sub Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer) '========== [×]ボタン,[Alt]+[F4]キーを無効にする ========== Dim msg As String, title As String msg = "[画面を閉じて終了する]ボタンから終了してください。" title = "終了方法" Dim res As Integer Select Case CloseMode Case vbFormControlMenu res = MsgBox(msg, vbOKOnly + vbCritical, title) Cancel = True End Select ActiveWorkbook.Save '★ Application.Visible = True '★ Application.Quit '★ End Sub 実行したいのは、 (1)ユーザーフォームを含むExcelファイルを起動したときは、起動時にユーザーフォームだけが表示されるようにしたい 　※ワークシートを非表示としたい (2)「実行」ボタンをクリックすると、プログラムが実行されExcelファイルが新規で作成され表示される 　※上記で記載した「★」の部分をコードをコメントアウトしてユーザーフォームから実行ボタンをクリックすると、プログラムが実行され正常にExcelファイルが新規で作成されることは確認済みです。 (3)ユーザーフォームが閉じても、ユーザーフォームのExcelファイルのみ閉じ、新規で作成されたExcelファイルは閉じない。 　※実行ボタンをクリックして新規ファイルを作成しなかったり、他にExcelファイルがなかった場合は、Excelは終了する。 それとあわせて、 (1)を実行できた場合に、再度コードを編集する時はどうしたらExcelの画面が表示できるのか教えて下さい。 　※それとも表示できないのでしょうか？ 作成締め切りが迫っていて焦っています。 お知恵のある方どうかお力添え下さい。 よろしくお願い致します。
会社の売上げ伝票をMicrosoftAccessで作ったソフトを使っています。 消費税８％に変更する為、サーバーのアクセスファイルのデーターファイルのテーブルの数値を5％から8％に書き換えました。 すると県外の営業所からソフトを使用すると****（DB）.mdbを開くか書き込むことができませんでした。とエラー3051となってしまいます。 エラーコード　　　：3051 エラーメッセージ　：:ファイル '\\***.mdb' を開くか、書き込むことができませんでした。ほかのユーザーが排他的に開いているか、データ表示と書き込みを行う権限がありません。 今までは営業所からも普通に起動していました。 サーバーのアクセスファイルのデーターファイルのテーブルの数値を書き換えただけでこんなエラーがでるものなんでしょうか？ サーバーが置いてある本社では普通にソフトの使用も可能です。営業所からのみがエラーを排出します。 本社サーバーはWinXP　Access2000 営業所　Win7　Access2007 サーバーへ繋ぐのは「どこでもLAN」を使用してます。 本社サーバーのアクセスファイルのデーターファイルのアクセス権限を見れば解決するでしょうか？ アクセスファイルのデーターファイルの数値を変更しただけで権限が変わってしまうものなのでしょうか？ 難しい事はまったくわからないので原因と救済方法を簡単に教えて下さい。 伝票ソフトを作成した会社はもうありません。 本当は消費税のテーブルをレ点チェックではなく、5％・8％・10％と選べるようにした方が今後の対応にはなると思うのですがなるべくお金をかけたくなかったもので・・・・ よろしくお願い致します。
こんにちは。 Visualstudio2005でFramework2.0で動作するVB.NETアプリを 作成しています。 やりたいことは、特定のDLLを参照しているプロジェクトを一括検索したいです。 方法をご存知の方がいらっしゃいましたら、教えていただきたいです。
初めて質問いたします。 至らない点があれば、指摘の程お願いします。 当方の環境は、 Windows7 VB.NET(VisualBasic) です。 今回、 Webページを開いた際にF12で起動する開発者ツールにおける、 「表示」－「ソース」－「DOM(ページ)」のhtmlソースに該当する情報を VB.NETで取得したく思っております。 自分で調べてみたのですが、 明確に記述がなかったのと自己解決していたのとで、 よくわかりませんでしたので、 教えていただきたく。 よろしくお願いします。
大量のワードのファイルをテキスト保存する仕事が入り、フォルダ内にあるワードファイルをテキスト保存し、テキストボックスやオートシェープの中のテキストも抜き出すプログラムを「VBScript」で作りました。 テキスト保存する際、Unicode形式で保存しなければならず、調べると、「SaveAs …, 7」がUnicodeによるテキスト保存だと分かったのですが、実際にやってみると、拡張子が「.rtf」ファイルだけが、Unicodeによるテキスト保存され、「.doc」や「.docx」は、「シフトJIS」保存されてしまいました。 私、何か間違っているのでしょうか？ 以下、一応、プログラムをコピーしておきます。 問題の部分は「行１３」です。 なお、ワードは「Word2010」です。 01　Option Explicit 02　Public a, b, c, d, e, f, g, h, t, u, v, w, x, y, z 03　Set w = CreateObject("Word.Application") 04　w.Application.DisplayAlerts = False 05　w.Visible = False 06　Set x = CreateObject("Scripting.FileSystemObject") 07　Set y = x.GetFolder(".") 08　For Each a In y.Files 09　b = LCase(x.GetExtensionName(a.Name)) 10　If b = "doc" or b = "docx" or b = "rtf" Then 11　h = x.GetBaseName(a.Name) 12　Set z = w.Documents.Open(y & "\" & a.Name) 13　z.SaveAs y & "\" & h & ".txt", 7 14　z.Close 15　Set z = Nothing 16　End If 17　If b = "docx" Then 18　Set z = w.Documents.Open(y & "\" & a.Name) 19　z.SaveAs y & "\qkza934irs2801wuptc56ynv7bm.doc", 0 20　z.Close 21　Set z = Nothing 22　Set z = w.Documents.Open(y & "\qkza934irs2801wuptc56ynv7bm.doc") 23　Call o 24　z.Close 25　Set z = Nothing 26　x.DeleteFile(y & "\qkza934irs2801wuptc56ynv7bm.doc") 27　ElseIf b = "doc" or b = "rtf" Then 28　Set z = w.Documents.Open(y & "\" & a.Name) 29　Call o 30　z.Close 31　Set z = Nothing 32　End If 33　If f > "" Then 34　Set t = x.CreateTextFile(y & "\TB_" & h & ".txt", True, True) 35　t.Write f 36　t.Close 37　End If 38　Next 39　w.Quit 40　Set z = Nothing 41　Set y = Nothing 42　Set x = Nothing 43　Set w = Nothing 44　MsgBox("Finished!") 45　Sub o 46　f = "" 47　For Each c In w.ActiveDocument.Shapes 48　If c.Type = 1 or c.Type = 17 then 49　Set v = c.TextFrame 50　e = v.TextRange 51　f = f & e 52　Set d = Nothing 53　ElseIf c.Type = 6 Then 54　For Each g In c.GroupItems 55　Set u = g.TextFrame 56　e = u.TextRange 57　f = f & e 58　Set u = Nothing 59　Next 60　End if 61　Next 62　End Sub よろしく、お願いします。
原因が分かりません。宜しくお願いします。 エクセルVBAで、フィルターを掛けたシートを別シートへコピーしています。 問題なく出来ていたルーチンでしたが、他の作業の影響か、 気がついたらコピー出来なくなっていました。 他のシートでも同じ方法でコピーを行っていますが、問題ありません。 問題のコーディングは以下のとおりです。 Worksheets("work2").Unprotect Worksheets("work2").Range("A:Z").ClearContents Worksheets("コピー元").Range("A5").AutoFilter Field:=6, Criteria1:=フィルタ請求年1, Operator:=xlOr, Criteria2:=フィルタ請求年2, VISIBLEDROPDOWN:=True Worksheets("コピー元").Range("A1").CurrentRegion.SpecialCells(xlVisible).Copy Worksheets("work2").Range("A1") Worksheets("work2").Protect Worksheets("コピー元").Range("A1").CurrentRegion.SpecialCells(xlVisible).Copy Worksheets("work2").Range("A1") の箇所では、エラーメッセージもでませんが、コピーもされていないことを確認しています。 どのような原因が考えられるでしょうか？ または、どのような方法で原因追求が出来るでしょうか？ ご回答お待ちしています。
お世話になります。 環境：Windows7 64Bit 　　　　Visual Studio 2012 UpDate4 VB.Netにて開発しております。　 　　　　.Net Framework4 Windows7、8で動作するアプリケーションをXPで動かくたい、ネットでいろいろ調べております。 プロジェクトプロパティ　→　構成プロパティ　→　全般　→　プラットフォーム ツールセットに「Visual Studio 2012 - Windows XP (v110_xp)」を選択します。　と書いてあるのですが、 そもそも　構成プロパティ　が見つからず、プロジェクトのプロパティにはアプリケーション、コンパイル、デバック、参照、リソース、サービス、設定、署名、Ｍｙ拡張、セキュリティ、発行、コード分析しか表示されていません。 プロジェクトの構成プロパティからプラットフォーム ツールセットにたどりつけません。 もしかしたら、VB.Net 環境では構成プロパティは表示されないものなのでしょうか？ Visual C++ の環境のみ構成プロパティは表示されるものなのでしょうか？ わたくしがプロジェクトのプロパティと思っているページ自体が間違いなのでしょうか？ VB.Net 環境でXPで動作するアプリを作成するにはどのようにすればいいでしょうか？ 何卒よろしくお願いいたします。
Excel VBAでユーザーフォームを作成しています。 ユーザーフォームで出力したファイル 「出力ファイルA」 ユーザーフォームで使用するファイル 「ファイルB」 を、起動していると必ず「インデックスが範囲内にありません」 といった内容のエラーが表示されます。 ユーザーフォームで使用するファイルの表示中に そのようなエラー画面が出てきても仕方がないと思うのですが、 ユーザーフォームはマルチ画面を作成したので ファイルは「出力ファイルC」も出すことができる仕様です。 また、「出力ファイルA」「出力ファイルC」は コンボボックスで選択した西暦がファイルの先頭に付くので （例：2014_出力ファイルA.xls） 必ず同じファイル名が出力されるとは限りません。 なので、そのようなエラーが表示されないようにしたいのですが可能でしょうか？ また、特別なコードは記述していないのですが、 なのでボタンとかコンボボックスのコードを書けばよいのか・・・という感じなのですが、 どのように対処すればよいかわかりません。 それと、出力したファイルの内容を確認するためにアクティブには、 ユーザーフォーム画面を終了させるしかならず、 そもそもそうゆう仕様なのかがわかりません。 ユーザーフォームを作成するのは初めてなので初心者丸出しで お恥ずかしい限りなのですが、 どなたかアドバイスいただけますと幸いです。 こんな抽象的ですが、どうお伝えすればよいのかがそもそもわからず困っていて、 それに時間もなく頭を抱えているので お手柔らかに願います。 よろしくお願い致します。
A1セルに2014/3/18と入力した際、入力ボタンで図のようにA2～A11に下記の式で火曜日のデーターE2～E11が入力出来たのですがA1の日付（曜日）を変更した際、入力ボタンを押すごとにA2～A11の値がその曜日ごとのデーターに変わるようにしたいのですが。VBAコードをお解りになる方よろしくお願いします。 Sub 入力() ActiveCell.Value = Range("D2:D11").Copy Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False End Sub
VS2012(VB) WindowsForm ターゲットフレームワーク：4.5 ｘ86 フォーム上に「ImageList」を 配置してJpegを表示しています。 その画面上に配置したボタンを押すと90度回転させて画像を保存します。 上記後に再描画してもImageListの画像は回転せずそのまま表示されます。 エクスプローラからダブルクリックすると回転しています。 上記再描画のコツ等ありましたら、ご教授願います。 何卒よろしくお願い致します。
お世話になります。データの縦の列に名簿、横の列に日付があるデータがあります。 （例） 　　Ａ B C D E F 　　　　　　　　 1　　 　　　１　 ２　 ３　 ４　 ５　・・・・・・・・・　２８　２９　３０　３１ 2　　 　　 土　 日 月　火 水 金　 土 日 月 3 Ａさん 4 Ｂさん 5 Ｃさん 6　 ・ 　 ・ 　 ・ Ｎさん　 Oさん エクセルの条件付き書式のルールで土日祝は縦方向（1が土曜であれば、"土"の下からデータがある範囲まで）に色がつくように設定してあります。 マクロを使って色がついたところ（土日祝）に曜日の下から名簿のデータの最後まで(例でいうと１（土）の時"土"の下からＯさんまで)赤い直線を引きたいと思うのですがそういうことは可能でしょうか。　名簿の人数は一定ではなく変動します。 よろしくお願いいたします。
現在、表を使ったプログラムを作成して居ます。 DataGridViewでデーターをセルに入れると、下のセルにフォーカスが移ってしまいます。 次に入れるデーターはどこに成るかはユーザーが決定したいので、出来れば入力したセルからフォーカスを移動させたく無いのですが、何か方法はあるでしょうか。 下記の様に、入力された時、右にフォーカスさせる方法は見つけましたが、フォーカスが移らない方法がありましたらお教え下さい。 宜しくお願い致します。 Public Class DataGridViewEx Inherits DataGridView <System.Security.Permissions.UIPermission( _ System.Security.Permissions.SecurityAction.Demand, _ Window:=System.Security.Permissions.UIPermissionWindow.AllWindows)> _ Protected Overrides Function ProcessDialogKey( _ ByVal keyData As Keys) As Boolean 'Enterキーが押された時は、Tabキーが押されたようにする If (keyData And Keys.KeyCode) = Keys.Enter Then Return Me.ProcessTabKey(keyData) End If Return MyBase.ProcessDialogKey(keyData) End Function <System.Security.Permissions.SecurityPermission( _ System.Security.Permissions.SecurityAction.Demand, _ Flags:=System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode)> _ Protected Overrides Function ProcessDataGridViewKey( _ ByVal e As KeyEventArgs) As Boolean 'Enterキーが押された時は、Tabキーが押されたようにする If e.KeyCode = Keys.Enter Then Return Me.ProcessTabKey(e.KeyCode) End If Return MyBase.ProcessDataGridViewKey(e) End Function End Class
お世話になります。 Visual Studio 2012　を Windows 7 64Bit　　にて使用しております。 Tabコントロールの全てのタブのタグ(Tag) に値を設定しており、変数と各タブページに格納してあるTag の値が一致したら、そのタブページのインデックスを取得できればと思っておりますが、 For　Each　Next 文にてそれをどう実現すればいいか困っております。 以下の文は　プロパティ的にはめちゃくちゃですが、ニュアンスとして、こんな感じで実現できればと思っております。 指定タブコントロールの全てのタブの中でTagの値が　123　のタブがあったら、そのタブインデックスを取得する 　　　　Dim Flg As Integer = 0 　　　　For Each TabPage In Me.TabControl1.TabPages 　　　　　　　　If TabPage.Tag = 123 Then 　　　　　　　　　　　　Flg = TabPage.Index() 　　　　　　　　　　　　Exit For 　　　　　　　　End If 　　　　Next 何卒よろしくお願いいたします。
rs.Open "SELECT * FROM Tログイン WHERE サイト名='" & サイト名 & "'", cn, adOpenStatic, adLockOptimistic rs("日時") = Now() rs.Update このコードを実行しようとしたときに、 実行時エラー3021「BOFとEOFのいずれかTRUEになっているか、 または現在のレコードが削除されています。 要求された操作には、現在のレコードが必要です。」 と言うエラーが発生する場合があるのですが、 どういう意味のエラーなのかが良くわかりません。 ちなみに、 rs("日時") = Now() をコメントアウトして、 rs.Updateのコードを実行しても、同じエラーが発生します。
VB 2010 Express　をOS W.XPで使用しています。 通常左に出で居るツールボックスの中身が表示されなく成り、 "このグループには使用可能なコントロールがありません。項目をこのテキスト上にドラッグして、ツールボックスに追加して下さい。" とのメッセージが表示されて居ます。 表示の中のツールボックスを選択したり、ツールバーのツールボックスをクリックしても同様です。 数週間前も同じ現象が出て、その時はVB 2010 Expressの修復を試みましたが、駄目。 VB 2010 Expressを削除してからVB 2010をインストールをした所、元に戻りました。 今日も同じ事をしたのですが、回復しませんでした。 ただ、他のプロジェクトを開くとツールボックスの中にツールが入って居るのもありました。 その状態でプロジェクトを閉じて、ツールボックスが無いプロジェクトを開こうとすると、そのタイミングでツールボックスの内容が消えました。 新規のプロジェクトを作成しても、ツールボックスの内容は入って居ませんでした。 ネットで検索すると、何処かにツールが入って居て、それを持って来ると治ったとの書き込みがありましたが、バージョンが違うのか、その場所が分かりませんでした。 どなたかこの現象を回復させる方法をご存知の方がおられましたら方法をお教え下さい。 ただ、問題が発生して居るのは会社のPCで、会社からはこのサイトには書き込み出来ませんので、結果は明日の帰宅後にしかお伝え出来ません。 家にもPCはありますので、場所を探す事は家でも出来ると思います。 金曜までに仕上げなければならないプログラムの開発中で、直らなければ他のPCで開発は続けようと思いますが、プロジェクトの何処かでツールボックスの内容が表示されない様に成っていれば、他のPCでもツールボックスの内容が表示されない事になります。 対処方法お分かりの方、宜しくお願いいたします
多分、まったく内容がなっていないというお叱りを受けそうですが、 今私が考えられるところはここまでです。 何が原因で動かないのか、分かりません。 よろしくお願いします。 確認用シートにデータがあります。データは個人カウントと月ごとの集計で成り立っています。 そのデータの個人名と月で検索した回答を集計用シートに表示させたいと考えています。 それで次のようなコードを書いてみましたが、思い通りの結果を出すことができませんでした。 式は直接式を入力すると正しい答えが出るのですが、コードを実行させた場合は＃NAME?に なってしまいます。こういう場合は変数は使えないのでしょうか? また、集計で得た結果を結果シートに値のみ貼り付けてエビデンスを残したいのですが、 これもうまくいきません。 貼り付けた後順位の項目でソートさせたいのですが、これもうまくいきませんでした。 また、ピボットテーブルに毎月のデータを入力させて、ピボットグラフを作るように テーブルとグラフをあらかじめ作成し、前月のデータを集計させたかったのですが、 これも見事に失敗しました。 ところで、もし当月が1月の場合は12月を見るようにさせたいのですが、IF文がうまく できません。IF文を認識してくれていないので、END IFにするとIFがありませんとエラーが 返ってきます。 まったくお手上げです。 よろしくお願いします。 Sub カウント() '式の割当 Dim a As Long, b As Long, d As String, e As String Dim getRange As String, getpreRange As String a = Sheets("集計用").Range("B87").Value b = a - 1 d = "_" & a & "月" e = "_" & b & "月" If a = 1 Then b = 12 getRange = "=INDEX(確認用データ,H89,d)" getpreRange = "=INDEX(確認用データ,H89,e)" Sheets("集計用").Range("C89").Formula = getRange Sheets("集計用").Range("D89").Formula = getpreRange Sheets("集計用").Range("C89:D89").Copy Sheets("集計用").Range("C90:C128") '結果シートに値のみ貼り付け, 順位で並べ替え Sheets("集計用").Range("B87:E128").Select Selection.Copy Sheets("結果").Range("A1").End(xlRight).Offset(0, 2).Select Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False Application.CutCopyMode = False Selection.Sort Key1:=Range("順位"), Order1:=xlAscending, Header:=xlGuess, _ OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, SortMethod _ :=xlPinYin, DataOption1:=xlSortNormal '前月のデータからピボットテーブルを作成する Dim r As String r = a & "月" ActiveSheet.PivotTables("ピボットテーブル2").AddDataField ActiveSheet.PivotTables( _ "ピボットテーブル2").PivotFields(r), "合計 / r", xlSum End Sub
VBA初心者です。 すいません教えて下さい。 たくさんのテキストボックスに決められた値を入れたいです。 今は１つ１つのテキストボックスに静的に直書きしています。 （理由は聞かないで下さい、、、^^;） 【今】 ---------------------------------------- TextBox0.Text = "0です" TextBox1.Text = "1です" …(省略) TextBox100.Text = "100です" ---------------------------------------- これをもっとスマートに出来ればと思い"For"を使いました。 【やりたいやり方】 ---------------------------------------- For i = 0 To 100 TextBox & i .Text = i &"です。" Next ---------------------------------------- 、、、が当然の結果、i変数を扱うことが出来ずにエラーになります。 どうにかスマートに実現する方法はありませんでしょうか？ 申し訳ありませんがご教示頂ければと思います。
基本的なところですみません。 Excel2007 VBAで「実行時エラー438 オブジェクトは、このプロパティまたはメソッドをサポートしていません」となります。 Dim xml As Object Dim objPrice As Object Dim tempWprd As Varient Set xml = CreateObject("Microsoft.XMLDOM") 省略（XMLデータを受信しxmlに代入） Set objPrice = xml.SelectNodes("AAA/BBB/CCC") If Not objPrice Is Nothing Then tempWord = objPrice.text　’★ここでエラー End If というようなコードです。 うまく取れることもあるのですが、objPrice は存在するがtextのメンバがいないということだと思いますが、存在を判定する方法をご教授させてください。そもそも<ccc>文字</ccc>の中の文字（実際は数値）を取得したい場合は、textはダメなのでしょうか？ cccはNothingではないので存在しているように見えるのですが、textが使える場合と使えない場合があるのは理由があり、値がある場合に取得したいと考えています。 存在確認に関しては if (objPrice.text <> Null) then Empty,Nothingなどいろいろ試しましたが、そもそもtextがないようなのでうまくいきません。 すみませんが、よろしくお願いします。
お世話になります。 VBScriptで、下記のような動きをさせたいのですが、 私の頭では全くわかりませんので、ご知識ある方 何卒よろしくお願いします。 Scriptを実行すると、「対象のテキストファイル」の 名前を「親のフォルダ名+"_"+対象のテキストファイル名」 にしたいのです。 例えば、 hogeフォルダに、 「複数のテキストファイル(拡張子.txt)」 「batファイル」 を置いて、 batファイルを実行すると、 現在のテキストファイルの名前の前に,親のフォルダ名をつけたいという 形です。 ※元のテキストファイル名が,「1.txt」なら「hoge__1.txt」にしたい インターネットで、いろいろ調べたのですが、断片的な情報では、 私の頭ではまったくわかりませんでした。。 そこで、大変申し訳ないのですが、実際に動くソースレベルで 教えて頂きたいので、ご知識ある方、何卒よろしくお願い致します。
Windows XP + Excel 2010 の際、社内の定型ドキュメントを保存する際、以下のようにして [名前を付けて保存] ダイアログを表示し、ファイル名ボックスに FileName 変数の値を入れておりました。 Dim FileName As String (中略) FileName = xxxx & yyyy & zzzz (<--- xxxx、yyyy、zzzz は毎回値が変化するので、別の変数を使用して値を取得しています) SaveFileName=Application.GetSaveAsFilename(InitialFileName:=FileName) If SaveFileName <> "False" Then ActiveWorkbook.SaveAs Filename:=SaveFileName, FileFormat:=xlOpenXMLWorkbook MsgBox "このブックを保存しました。" Else MsgBox "保存がキャンセルされました。" End If End Sub しかし、Win7Pro+Excel2010 のマシンにリプレイスし、同一の vba を動かしますと [名前を付けて保存] ダイアログでファイル名が空白になり、FileName 変数の値を取得してくれなくなってしまいました。 なお、SaveFileName 以降の文字列をコメントアウトし、SaveFileName の直前で Msgbox FileName を 実行すると、意図したとおり FileName 変数が働き、ファイル名を取得してくれています。 また、InitialFileName 以降の文字列を固定値にする ("" で囲む) と、InitialFileName で指定した文字列を取得して [名前を付けて保存] ダイアログを表示します。 OS の変更に伴うこのような動作の変更の差異が何にあるのかわかりません。 Win7+Excel2010 の環境で、以前と同様、[名前を付けて保存] ダイアログを表示した際、変数で取得した値をファイル名ボックスに自動的に挿入するコードを教えてください。 よろしくお願いいたします。
ExcelVBAで、変数でのファイルのOpen方法を教えてください。 以下のフォルダ構造とします。 '////////////////////////////////////////////////////// マクロファイル.xls 1フォルダA 　∟1999ファイルA.xls 　∟2000ファイルA.xls 　∟2001ファイルA.xls 　∟2002ファイルA.xls 　∟2003ファイルA.xls 　∟2004ファイルA.xls　・・・ 2フォルダB 　∟1999ファイルB.xls 　∟2000ファイルB.xls 　∟2001ファイルB.xls 　∟2002ファイルB.xls 　∟2003ファイルB.xls 　∟2004ファイルB.xls　・・・ 3フォルダC 　∟結果ファイルC.xls '////////////////////////////////////////////////////// マクロファイル.xlsのシートにコンボボックスとボタンを配置します。 コンボボックスで【2001】を選択した場合は、 前後1年…合わせて合計3年分のファイルの「A5～A25」の値が、 「結果ファイルC.xls」にコピーされるようにしたいのです。 コピー内容や範囲が多く1つのプロシージャーに収まり切りませんでした。 そこで「結果ファイルC.xls」ファイルを1つめのプロシージャで開き、 2つめのプロシージャで残りの処理を実行しようとしたのですが、 変数、コンボボックスの値でのファイルを開く方法がわからず困っており、 どなたかお知恵をお貸し下さい。 以下のようなコードを書いてみましたがエラーとなりました。 '////////////////////////////////////////////////////// Dim vTgYear As Variant Dim myFLName1 As String, sWbkSubName1 As String Dim myFLName2 As String, sWbkSubName2 As String, SubName As String, vTgYear = ComboBox1.Value For i = -1 To 1 sWbkSubName1 = "3_フォルダC\結果ファイルC.xls" myFLName1 = ThisWorkbook.Path & sWbkSubName1 Workbooks.Open Filename:=myFLName1 SubName = "vTgYear + i & _ファイルA.xls" sWbkSubName2 = "1_フォルダA & SubName" myFLName2 = ThisWorkbook.Path & sWbkSubName1 Workbooks.Open Filename:=myFLName2 (実行コード中略) Next i '////////////////////////////////////////////////////// 今回はファイルの開き方だけなので、実行コードを省略させていただきました。 初歩的な質問かと思いますが、何卒お力をお貸しいただけますと幸いです。 よろしくお願い致します。
VBAを使って、 bmp画像ファイルをJPEGやTIFFファイルに圧縮したいのですが 可能でしょうか？ よろしくお願い致します。
いつもお世話になります。 私の会社では、スケジュール管理するにあたり、1日を3つに分けています。 つまり、「午前」「午後」「夜間」「午前午後」「午後夜間」「全日」の6種になります。 只今私は、スケジュールが更新されたときに、上書きして変更点をメッセージボックスで返すマクロを考えています。 （趣味の範囲ですので締め切りはないのですが、なんせVBA始めて1ヶ月目なもんですから四苦八苦してます＞＜） そこで、とりあえず下記のような「更新前のスケジュール区分を検知してメッセージで返す」ところまで出来ました。 （もう少しスッキリできないものかと思っております。） ここに「更新版と見比べて変更し、メッセージで返す」という働きを足していこうと思っています。 が、別々にコードが書けても、それを合体させようとなると、どうやったらいいのか皆目見当が付きません。 難解に思われるのは、結合セルと入力済みデータの扱いです。 例えば、とある1日に対して、「午前」「午後」「夜間」と別々の予定が入ってたとします。 予定に変更が出て「夜間」が「全日」になってしまったとします。 コードに「生き残っているのは夜間だ」という判断をさせることは出来ませんよね？ （というのも、区分が変更された場合、文字列が一致しているとは限らないのです。） 対話型にして、チェックボックスみたいな形で選択させるのがいいのでしょうか？ オーバースペックで耳から煙が出そうです・・・ とりあえず下記がコードです。 "strage1"を古いスケジュール、"strage2"を更新版としています。 つたない記述ですが、ヒントをご教授くださいませ。 ------------------------------------ Sub 何を書き換えたかMsgBox2() Dim i As Integer, j As Integer Dim myMsg As String Dim myold As Worksheet, mynew As Worksheet Set myold = Sheets("strage1") Set mynew = Sheets("strage2") j = 5 For j = j To 35 i = 6 　　For i = i To 8 　　　　If IsEmpty(myold.Cells(j, i)) And Not IsEmpty(mynew.Cells(j, i)) Then 　　　　　　myMsg = myMsg & mynew.Cells(j, i) & "が追加になりました" & vbCrLf 　　　　ElseIf Not IsEmpty(myold.Cells(j, i)) And IsEmpty(mynew.Cells(j, i)) Then 　　　　　　myMsg = myMsg & myold.Cells(j, i) & "がキャンセルになりました" & vbCrLf 　　　　ElseIf myold.Cells(j, i) <> mynew.Cells(j, i) Then 　　　　　　myMsg = myMsg & myold.Cells(j, i).Value & "から" & mynew.Cells(j, i) & "に変更しました" & vbCrLf 　　　　End If 　　　　　　myold.Cells(j, i).Value = mynew.Cells(j, i) 　　Next Next MsgBox myMsg End Sub --------------------------------------------- Sub 区分識別3() Dim i As Integer Dim myMsg As String i = 5 For i = i To 35 If Cells(i, 6) <> "" Then 　　If Cells(i, 6).MergeArea.Count = 3 Then 　　　　myMsg = myMsg & i - 4 & "日、全日枠の" & Cells(i, 6).Value & "です。" & vbCrLf 　　ElseIf Cells(i, 6).MergeArea.Count = 2 Then 　　　　myMsg = myMsg & i - 4 & "日、午前午後枠の" & Cells(i, 6).Value & "です。" & vbCrLf 　　Else 　　　　myMsg = myMsg & i - 4 & "日、午前枠の" & Cells(i, 6).Value & "です。" & vbCrLf 　　End If End If If Cells(i, 7) <> "" Then 　　If Cells(i, 7).MergeArea.Count = 2 Then 　　　　myMsg = myMsg & i - 4 & "日、午後夜間枠の" & Cells(i, 7).Value & "です。" & vbCrLf 　　Else 　　　　myMsg = myMsg & i - 4 & "日、午後枠の" & Cells(i, 7).Value & "です。" & vbCrLf 　　End If End If If Cells(i, 8) <> "" Then 　　myMsg = myMsg & i - 4 & "日、夜間枠の" & Cells(i, 8).Value & "です。" & vbCrLf End If Next MsgBox myMsg End Sub ------------------------------------------------------- 以上です。 よろしくお願いいたします。
MultipageにそれぞれImagecontrolを張り付けて エクセルで自動作成したマーカー付折れ線グラフを 表示させるマクロを書いてみたんですが 2Pageまでは、上手く動作するんですが3page目をクリックしても 全く反応しません。何がおかしいのかどなたかお分かりの方 ご教授下さい。 ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ Private Sub MultiPage1_Change() Application.ScreenUpdating = False Dim chartrange As Range Me.MultiPage1.Value = 0 ActiveSheet.Range("a8").CurrentRegion.Select Set chartrange = Selection Charts.Add ActiveChart.ChartType = xlLineMarkers ActiveChart.SetSourceData Source:=chartrange, PlotBy:=xlRows ActiveChart.Location where:=xlLocationAsObject, Name:="記録" Const graphimage2 As String = "C:\Users\user\Pictures\Graph.bmp" If ActiveSheet.ChartObjects.Count = 0 Then Exit Sub ActiveSheet.ChartObjects(1).Chart.Export graphimage2 If Len(Dir(graphimage2)) > 0 Then With Image1 .PictureSizeMode = fmPictureSizeModeStretch .PictureAlignment = fmPictureAlignmentCenter .BorderStyle = fmBorderStyleNone .Picture = LoadPicture(graphimage2) End With Kill graphimage2 End If ActiveSheet.ChartObjects.Delete Me.MultiPage1.Value = 1 ActiveSheet.Range("a11").CurrentRegion.Select Set chartrange = Selection Charts.Add ActiveChart.ChartType = xlLineMarkers ActiveChart.SetSourceData Source:=chartrange, PlotBy:=xlRows ActiveChart.Location where:=xlLocationAsObject, Name:="記録" Const graphimage3 As String = "C:\Users\user\Pictures\Graph.bmp" If ActiveSheet.ChartObjects.Count = 0 Then Exit Sub ActiveSheet.ChartObjects(1).Chart.Export graphimage2 If Len(Dir(graphimage3)) > 0 Then With Image2 .PictureSizeMode = fmPictureSizeModeStretch .PictureAlignment = fmPictureAlignmentCenter .BorderStyle = fmBorderStyleNone .Picture = LoadPicture(graphimage3) End With Kill graphimage3 ActiveSheet.ChartObjects.Delete End If Me.MultiPage1.Value = 2 ActiveSheet.Range("a14").CurrentRegion.Select Set chartrange = Selection Charts.Add ActiveChart.ChartType = xlLineMarkers ActiveChart.SetSourceData Source:=chartrange, PlotBy:=xlRows ActiveChart.Location where:=xlLocationAsObject, Name:="記録" Const graphimage4 As String = "C:\Users\user\Pictures\Graph.bmp" If ActiveSheet.ChartObjects.Count = 0 Then Exit Sub ActiveSheet.ChartObjects(1).Chart.Export graphimage4 If Len(Dir(graphimage4)) > 0 Then With Image3 .PictureSizeMode = fmPictureSizeModeStretch .PictureAlignment = fmpictueralignmentcenter .BorderStyle = fmBorderStyleNone .Picture = LoadPicture(grphimage4) End With Kill graphimage4 End If ActiveSheet.ChartObjects.Delete Application.ScreenUpdating = True End Sub
すみません、いつも、いろいろな方に助けて頂いていますが、また、初歩的な質問をさせて頂きます。 Excel2007のVBAでXMLの扱いが良くわかっておりません。 以下のプログラムで複数ItemのASINを出力したいのですが、うまくいきません。 XMLがきちんと取得できているのはWireSharkでキャプチャして確認できております。 VBAで表示出力するのがうまくいきません。ご教授方よろしくお願いします。 selectSingleNodeで一つの場合はうまく取り出せています。複数ノードの場合にSelectNodesの使い方に問題がありますでしょうか？ 型の宣言などに誤りがありますでしょうか？ また、基本的なことですが、MSXML2を使おうとしたら、Excel2007で使えませんでした。 XMLDOMは、サポート切れ？で古いので、MSXML2を使うのが良いとWebで見ました。 DLLなどが必要な気がしているのですが、よくわかっていないのでご教授頂きたいです。 すみませんが、よろしくお願いします。 *****VBAプログラム（抜粋）****** Dim xml As Object, xmlItems As Object, objPrice As Object 'XML オブジェクト作成 Set xml = CreateObject("Microsoft.XMLDOM") xml.async = False xml.Load URI Set xmlItems = xml.SelectNodes("ItemLookupResponse/Items/Item") For Each objPrice In xmlItems ' ASIN If Not objPrice.SelectSingleNode("ASIN") Is Nothing Then curWS.Cells(rowIndex, ASINCol) = objPrice.SelectSingleNode("ASIN").text End If Next *****取得したXML（抜粋）****** <ItemSearchResponse > <Items> <Item> <ASIN>111</ASIN> </Item> <Item> <ASIN>222</ASIN> </Item> <Item> <ASIN>333</ASIN> </Item> </Items> </ItemSearchResponse>
VB４.0で作成してましたMicrosoft.Jet.OLEDB.4.0のDBをSQLSERVER2012で作成したDBに移行したいのですが VB2013では読み込めないのでしょうか？ データーベースエクスプローラーでは中身の確認はできるのですが プログラムで走らせるとSqlDataAdapter(sql, cnStr)のところでエラー下記[エラー結果]とになります Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click Dim cnStr As String = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\\SERVER\DB名.mdb" Dim sql As String sql = "SELECT * FROM テーブル名" Dim dt1 As New DataTable Dim da1 As New SqlDataAdapter(sql, cnStr) Try da1.Fill(dt1) DataGridView1.DataSource = dt1 Catch ex As Exception End Try End Sub [エラー結果] 型 'System.ArgumentException' のハンドルされていない例外が System.Data.dll で発生しました 追加情報:キーワードはサポートされていません : 'provider' 以前のmdbファイルが読み込める方法はないのでしょうか？
「ExcelVBA複数のシートへのコピーの方法」 http://oshiete.goo.ne.jp/qa/8504035.html 上記質問の補足です。 '////////////////////////////////////////////////////// 「ExcelVBA別フォルダにあるブックのコピー方法」 http://oshiete.goo.ne.jp/qa/8488933.html で教えていただいたコードを元に自分なりに編集したのですがうまくいきません。 結果先のシートは複数なのですが、複数のシートにコピーする編集方法がうまくいきません。 '////////////////////////////////////////////////////// 「yyyy」のファイルは「1999～2012」のファイルがあります。 　　※「yyyy」の箇所にはそれぞれの年号が入ります。 　　※例えば「1999_ファイルA.xls」 「yyyy2」のファイルは「2000～2012」のファイルがあります。 　　※「yyyy2」の箇所にはそれぞれの年号が入ります。 　　※例えば「2000_ファイルB.xls」 1_フォルダA 　∟yyyy_ファイルA.xls(Sheet名：「dateA」で統一) 2_フォルダB 　∟yyyy_ファイルB.xls(Sheet名：「dateB」で統一) 3_フォルダC 　∟yyyy2_ファイルC.xls(Sheet名：「dateC」で統一) 4_フォルダD 　∟yyyy_ファイルD.xls(Sheet名：「dateD」で統一) 5_フォルダE 　∟ファイルE_結果.xls (Sheet名：A広域/B広域/C広域/D広域/E広域) 例えばコンボボックスで「2007」を選択した場合、 表【地域A男性】 「2006_ファイルA.xls」のC5～C23を「ファイルE_結果.xls」の(A広域)D7～D25にコピー 「2007_ファイルA.xls」のC5～C23を「ファイルE_結果.xls」の(A広域)E7～E25にコピー 「2008_ファイルA.xls」のC5～C23を「ファイルE_結果.xls」の(A広域)F7～F25にコピー 「2006_ファイルB.xls」のC5～C23を「ファイルE_結果.xls」の(A広域)H7～H25にコピー 「2007_ファイルB.xls」のC5～C23を「ファイルE_結果.xls」の(A広域)I7～I25にコピー 「2008_ファイルB.xls」のC5～C23を「ファイルE_結果.xls」の(A広域)J7～J25にコピー 「2007_ファイルC.xls」のC4～C22を「ファイルE_結果.xls」の(A広域)L7～L25にコピー 「2007_ファイルD.xls」のE8～E26を「ファイルE_結果.xls」の(A広域)N7～N25にコピー 表【地域A女性】 「2006_ファイルA.xls」のD5～D23を「ファイルE_結果.xls」の(A広域)D26～D44にコピー 「2007_ファイルA.xls」のD5～D23を「ファイルE_結果.xls」の(A広域)E26～E44にコピー 「2008_ファイルA.xls」のD5～D23を「ファイルE_結果.xls」の(A広域)F26～F44にコピー 「2006_ファイルB.xls」のC25～C43を「ファイルE_結果.xls」の(A広域)H26～H44にコピー 「2007_ファイルB.xls」のC25～C43を「ファイルE_結果.xls」の(A広域)I26～I44にコピー 「2008_ファイルB.xls」のC25～C43を「ファイルE_結果.xls」の(A広域)J26～J44にコピー 「2007_ファイルC.xls」のC24～C42を「ファイルE_結果.xls」の(A広域)L26～L44にコピー 「2007_ファイルD.xls」のE8～E26を「ファイルE_結果.xls」の(A広域)N26～N44にコピー 表【地域B男性】 「2006_ファイルA.xls」のF5～F23を「ファイルE_結果.xls」の(A広域)D51～D69にコピー 「2007_ファイルA.xls」のF5～F23を「ファイルE_結果.xls」の(A広域)E51～E69にコピー 「2008_ファイルA.xls」のF5～F23を「ファイルE_結果.xls」の(A広域)F51～F69にコピー 「2006_ファイルB.xls」のD5～D23を「ファイルE_結果.xls」の(A広域)H51～H69にコピー 「2007_ファイルB.xls」のD5～D23を「ファイルE_結果.xls」の(A広域)I51～I69にコピー 「2008_ファイルB.xls」のD5～D23を「ファイルE_結果.xls」の(A広域)J51～J69にコピー 「2007_ファイルC.xls」のD4～D22を「ファイルE_結果.xls」の(A広域)L51～L69にコピー 「2007_ファイルD.xls」のE8～E26を「ファイルE_結果.xls」の(A広域)N51～N69にコピー 表【地域B女性】 「2006_ファイルA.xls」のG5～G23を「ファイルE_結果.xls」の(A広域)D70～D88にコピー 「2007_ファイルA.xls」のG5～G23を「ファイルE_結果.xls」の(A広域)E70～E88にコピー 「2008_ファイルA.xls」のG5～G23を「ファイルE_結果.xls」の(A広域)F70～F88にコピー 「2006_ファイルB.xls」のD25～D43を「ファイルE_結果.xls」の(A広域)H70～H88にコピー 「2007_ファイルB.xls」のD25～D43を「ファイルE_結果.xls」の(A広域)I70～I88にコピー 「2008_ファイルB.xls」のD25～D43を「ファイルE_結果.xls」の(A広域)J70～J88にコピー 「2007_ファイルC.xls」のD24～D42を「ファイルE_結果.xls」の(A広域)L70～L88にコピー 「2007_ファイルD.xls」のE8～E26を「ファイルE_結果.xls」の(A広域)N70～N88にコピー 表【地域C男性】 「2006_ファイルA.xls」のC5～C23を「ファイルE_結果.xls」の(B広域)D7～D25にコピー 「2007_ファイルA.xls」のC5～C23を「ファイルE_結果.xls」の(B広域)E7～E25にコピー 「2008_ファイルA.xls」のC5～C23を「ファイルE_結果.xls」の(B広域)F7～F25にコピー 「2006_ファイルB.xls」のC5～C23を「ファイルE_結果.xls」の(B広域)H7～H25にコピー 「2007_ファイルB.xls」のC5～C23を「ファイルE_結果.xls」の(B広域)I7～I25にコピー 「2008_ファイルB.xls」のC5～C23を「ファイルE_結果.xls」の(B広域)J7～J25にコピー 「2007_ファイルC.xls」のC4～C22を「ファイルE_結果.xls」の(B広域)L7～L25にコピー 「2007_ファイルD.xls」のE8～E26を「ファイルE_結果.xls」の(B広域)N7～N25にコピー 表【地域C女性】 「2006_ファイルA.xls」のD5～D23を「ファイルE_結果.xls」の(B広域)D26～D44にコピー 「2007_ファイルA.xls」のD5～D23を「ファイルE_結果.xls」の(B広域)E26～E44にコピー 「2008_ファイルA.xls」のD5～D23を「ファイルE_結果.xls」の(B広域)F26～F44にコピー 「2006_ファイルB.xls」のC25～C43を「ファイルE_結果.xls」の(B広域)H26～H44にコピー 「2007_ファイルB.xls」のC25～C43を「ファイルE_結果.xls」の(B広域)I26～I44にコピー 「2008_ファイルB.xls」のC25～C43を「ファイルE_結果.xls」の(B広域)J26～J44にコピー 「2007_ファイルC.xls」のC24～C42を「ファイルE_結果.xls」の(B広域)L26～L44にコピー 「2007_ファイルD.xls」のE8～E26を「ファイルE_結果.xls」の(B広域)N26～N44にコピー ※「表【地域C女性】」等はワークシートの表のタイトルです。 '//////////////////////////////////////////////////////
以下の質問の補足質問です。よろしくお願い致します。 「ExcelVBAコードの編集方法を教えてください」 http://oshiete.goo.ne.jp/qa/8503466.html 「ExcelVBA別フォルダにあるブックのコピー方法」 http://oshiete.goo.ne.jp/qa/8488933.html で教えていただいたコードを元に自分なりに編集したのですがうまくいきません。 結果先のシートは複数なのですが、複数のシートにコピーする編集方法がうまくいきません。 '////////////////////////////////////////////////////// yyyy = 1999～2012 yyyy2 = 2000～2012 Sheet名：A広域、B広域 1_フォルダA 　∟yyyy_ファイルA.xls 2_フォルダB 　∟yyyy_ファイルB.xls 3_フォルダC 　∟yyyy2_ファイルC.xls 4_フォルダD 　∟yyyy_ファイルD.xls 5_フォルダE 　∟ファイルE_結果.xls 例えばコンボボックスで「2007」を選択した場合、 '地域A男性 「2006_ファイルA.xls」のC5～C23を「ファイルE_結果.xls」の(A広域)D7～D25にコピー 「2007_ファイルA.xls」のC5～C23を「ファイルE_結果.xls」の(A広域)E7～E25にコピー 「2008_ファイルA.xls」のC5～C23を「ファイルE_結果.xls」の(A広域)F7～F25にコピー '地域A女性 「2006_ファイルA.xls」のD5～D23を「ファイルE_結果.xls」の(A広域)D26～D44にコピー 「2007_ファイルA.xls」のD5～D23を「ファイルE_結果.xls」の(A広域)E26～E44にコピー 「2008_ファイルA.xls」のD5～D23を「ファイルE_結果.xls」の(A広域)F26～F44にコピー '地域B男性 「2006_ファイルA.xls」のF5～F23を「ファイルE_結果.xls」の(A広域)D51～D69にコピー 「2007_ファイルA.xls」のF5～F23を「ファイルE_結果.xls」の(A広域)E51～E69にコピー 「2008_ファイルA.xls」のF5～F23を「ファイルE_結果.xls」の(A広域)F51～F69にコピー '地域B女性 「2006_ファイルA.xls」のG5～G23を「ファイルE_結果.xls」の(A広域)D70～D88にコピー 「2007_ファイルA.xls」のG5～G23を「ファイルE_結果.xls」の(A広域)E70～E88にコピー 「2008_ファイルA.xls」のG5～G23を「ファイルE_結果.xls」の(A広域)F70～F88にコピー '地域C男性 「2006_ファイルA.xls」のC5～C23を「ファイルE_結果.xls」の(B広域)D7～D25にコピー 「2007_ファイルA.xls」のC5～C23を「ファイルE_結果.xls」の(B広域)E7～E25にコピー 「2008_ファイルA.xls」のC5～C23を「ファイルE_結果.xls」の(B広域)F7～F25にコピー '地域C女性 「2006_ファイルA.xls」のD5～D23を「ファイルE_結果.xls」の(B広域)D26～D44にコピー 「2007_ファイルA.xls」のD5～D23を「ファイルE_結果.xls」の(B広域)E26～E44にコピー 「2008_ファイルA.xls」のD5～D23を「ファイルE_結果.xls」の(B広域)F26～F44にコピー '地域A男性 「2006_ファイルB.xls」のC5～C23を「ファイルE_結果.xls」の(A広域)H7～H25にコピー 「2007_ファイルB.xls」のC5～C23を「ファイルE_結果.xls」の(A広域)I7～I25にコピー 「2008_ファイルB.xls」のC5～C23を「ファイルE_結果.xls」の(A広域)J7～J25にコピー '地域A女性 「2006_ファイルB.xls」のC25～C43を「ファイルE_結果.xls」の(A広域)H26～H44にコピー 「2007_ファイルB.xls」のC25～C43を「ファイルE_結果.xls」の(A広域)I26～I44にコピー 「2008_ファイルB.xls」のC25～C43を「ファイルE_結果.xls」の(A広域)J26～J44にコピー '地域B男性 「2006_ファイルB.xls」のD5～D23を「ファイルE_結果.xls」の(A広域)H51～H69にコピー 「2007_ファイルB.xls」のD5～D23を「ファイルE_結果.xls」の(A広域)I51～I69にコピー 「2008_ファイルB.xls」のD5～D23を「ファイルE_結果.xls」の(A広域)J51～J69にコピー '地域B女性 「2006_ファイルB.xls」のD25～D43を「ファイルE_結果.xls」の(A広域)H70～H88にコピー 「2007_ファイルB.xls」のD25～D43を「ファイルE_結果.xls」の(A広域)I70～I88にコピー 「2008_ファイルB.xls」のD25～D43を「ファイルE_結果.xls」の(A広域)J70～J88にコピー '地域C男性 「2006_ファイルB.xls」のC5～C23を「ファイルE_結果.xls」の(B広域)H7～H25にコピー 「2007_ファイルB.xls」のC5～C23を「ファイルE_結果.xls」の(B広域)I7～I25にコピー 「2008_ファイルB.xls」のC5～C23を「ファイルE_結果.xls」の(B広域)J7～J25にコピー '地域C女性 「2006_ファイルB.xls」のC25～C43を「ファイルE_結果.xls」の(B広域)H26～H44にコピー 「2007_ファイルB.xls」のC25～C43を「ファイルE_結果.xls」の(B広域)I26～I44にコピー 「2008_ファイルB.xls」のC25～C43を「ファイルE_結果.xls」の(B広域)J26～J44にコピー '地域A男性 「2007_ファイルC.xls」のC4～C22を「ファイルE_結果.xls」の(A広域)L7～L25にコピー '地域A女性 「2007_ファイルC.xls」のC24～C42を「ファイルE_結果.xls」の(A広域)L26～L44にコピー '地域B男性 「2007_ファイルC.xls」のD4～D22を「ファイルE_結果.xls」の(A広域)L51～L69にコピー '地域B女性 「2007_ファイルC.xls」のD24～D42を「ファイルE_結果.xls」の(A広域)L70～L88にコピー '地域C男性 「2007_ファイルC.xls」のC4～C22を「ファイルE_結果.xls」の(B広域)L7～L25にコピー '地域C女性 「2007_ファイルC.xls」のC24～C42を「ファイルE_結果.xls」の(B広域)L26～L44にコピー '地域A男性 「2007_ファイルD.xls」のE8～E26を「ファイルE_結果.xls」の(A広域)N7～N25にコピー '地域A女性 「2007_ファイルD.xls」のE8～E26を「ファイルE_結果.xls」の(A広域)N26～N44にコピー '地域B男性 「2007_ファイルD.xls」のE8～E26を「ファイルE_結果.xls」の(A広域)N51～N69にコピー '地域B女性 「2007_ファイルD.xls」のE8～E26を「ファイルE_結果.xls」の(A広域)N70～N88にコピー '地域C男性 「2007_ファイルD.xls」のE8～E26を「ファイルE_結果.xls」の(B広域)N7～N25にコピー '地域C女性 「2007_ファイルD.xls」のE8～E26を「ファイルE_結果.xls」の(B広域)N26～N44にコピー '////////////////////////////////////////////////////// コピー先は複数あるのですが、文字数の関係で割愛させていただきます。 この内容で伝わると良いのですが。 何卒よろしくお願いします。
「ExcelVBA別フォルダにあるブックのコピー方法」 http://oshiete.goo.ne.jp/qa/8488933.html 上記質問でコードを教えていただきました。 自分で編集しようと思ったのですが、どうにもうまくいきません。 編集したい内容としては、 出力する「ファイルC」に複数のシートがあるので、 それぞれのシートを指定して値をコピーしたいのです。 でも、別のシート名の指定がうまくいきません。 シートはフォーマットが決まったものが配置されているのですが、 1つのシートごとに数が異なります。 '////////////////////////////////////////////////////// Private Sub CommandButton1_Click() Dim vTgYear As Variant Dim sht結果 As Worksheet, sht上小 As Worksheet Dim sht保存 As Worksheet Dim sht元データ As Worksheet Dim sMyDir As String Dim sWbkFullName As String Dim sWbkName2 As String Dim sShtName As String Dim sMsg As String Dim i As Long Dim seru As Range vTgYear = ComboBox1.Value '　　● If Not vTgYear Like "####" Then MsgBox "年次を指定してからやり直し", vbExclamation Exit Sub End If Select Case vTgYear Case 1999 To 2012 '　　● Case Else MsgBox "1999～2012の間で年次を指定してからやり直し", vbExclamation '　　● Exit Sub End Select sMyDir = ThisWorkbook.Path & "\" With Application .ScreenUpdating = False '　　　　.DisplayAlerts = False .Calculation = xlCalculationManual End With ' ' ファイルC_結果.xls を開く sWbkFullName = sMyDir & "3_フォルダC\ファイルC_結果.xls" '● sShtName = "地域A" '● On Error Resume Next Set sht結果 = Workbooks.Open(sWbkFullName).Sheets(sShtName) On Error GoTo 0 If sht結果 Is Nothing Then MsgBox sWbkFullName & vbLf & sShtName & vbLf & "開くことが出来ませんでした", vbExclamation Exit Sub End If ' ' 出力先のセル範囲を値消去 sht結果.Range("D7:F44,H7:J44,L7:L44,N7:Q44").ClearContents ' ' 前年～翌年、ループ For i = -1 To 1 ' ' 1_フォルダA sWbkFullName = sMyDir & "1_フォルダA\" & vTgYear + i & "_ファイルA.xls" sShtName = "Sheet1" On Error Resume Next Set sht元データ = Workbooks.Open(sWbkFullName).Sheets(sShtName) On Error GoTo 0 If sht元データ Is Nothing Then sMsg = sMsg & vbLf & "●" & sWbkFullName & vbLf & sShtName Else sht結果.Range("E7:E25").Offset(, i).Value = sht元データ.Range("C5:C23").Value sht結果.Range("E26:E44").Offset(, i).Value = sht元データ.Range("D5:D23").Value sht元データ.Parent.Close SaveChanges:=False Set sht元データ = Nothing End If ' ' 2_フォルダB sWbkFullName = sMyDir & "2_フォルダB\" & vTgYear + i & "_ファイルB.xls" '● sShtName = "Sheet1" '● On Error Resume Next Set sht元データ = Workbooks.Open(sWbkFullName).Sheets(sShtName) On Error GoTo 0 If sht元データ Is Nothing Then sMsg = sMsg & vbLf & "●" & sWbkFullName & vbLf & sShtName Else sht結果.Range("I7:I25").Offset(, i).Value = sht元データ.Range("C5:C23").Value sht結果.Range("I26:I44").Offset(, i).Value = sht元データ.Range("C25:C43").Value sht元データ.Parent.Close SaveChanges:=False Set sht元データ = Nothing End If Next i ' ' "ファイルC_2006～2008年結果.xls"形式の名前を付け保存して閉じる Application.DisplayAlerts = False sht結果.SaveAs Filename:=sMyDir & "3_フォルダC\" & ComboBox1.Value & "_ファイルC.xls" '　　● Application.DisplayAlerts = True With Application .ScreenUpdating = True '　　　　.DisplayAlerts = True .Calculation = xlCalculationAutomatic End With Set sht結果 = Nothing If sMsg = "" Then MsgBox Label1.Caption & vbLf & "処理完了", vbInformation Else MsgBox sMsg & vbLf & "開くことが出来ませんでした", vbExclamation End If End Sub '////////////////////////////////////////////////////// 文字数制限のため全てのコードを書けなかったのですが、 (1)フォルダは複数ある (2)データ元のコピー方法は3種類 　　(1)コンボボックスで選択した前後2年のファイルの値をコピーする 　　(2)コンボボックスで選択した年次のみのファイルの値をコピーする 　　(3)範囲がどの結果の範囲に対しても同一の場合がある (1)(2)は教えていただいたコードでクリアしているのですが、 前の質問の時に結果のファイルにシートが複数あるのをお伝えするのを忘れてしまいました。 結果ファイルの複数のシートにコピーするにはどのように編集したらよいのか教えていただけますと幸いです。 締め切りが近くとても焦っています。 自分でどうにかできないのがお恥ずかしいのですが、どうかよろしくお願い致します。
ご回答ありがとうございました。 これといった資料がなく(探し方が悪いのかもしれませんが)、少ない経験値で複雑なというか面倒な処理のマクロ(VBA)を組まされることになり、困っているところです。当初の話だと「勉強しながらでよい」ということだったのですが、いろいろと仕事が次々と舞い込んできて、そんな余裕もなくせっぱ詰まり少ない知識で必死にやっています。 先にご回答いただいた内容で是非アドバイスをいただきたいと思い、新たに質問させていただきました。 ユーザーフォームでマルチページを作っています。そこでもコンボボックスを使うのですがそこの記述方法をアドバイス下さい。やっぱり記述場所がおかしいのか、クリックするとリストの内容がコンボボックスをクリックした分だけ繰り返してしまうことがあります。 ////////////////////////////////////////////////////// Private Sub UserForm_Initialize() Dim sh As Worksheet Set sh = Worksheets("対象年") Dim i As Integer Dim lastRow As Integer lastRow = sh.Cells(Rows.Count, 1).End(xlUp).Row With ComboBox1 For i = 2 To lastRow If ComboBox1 = "" Then .AddItem sh.Cells(i, 1).Value End If Next i End With End Sub ////////////////////////////////////////////////////// Private Sub ComboBox1_DropButtonClick() Dim sh As Worksheet Set sh = Worksheets("対象年") Dim i As Integer Dim lastRow As Integer lastRow = sh.Cells(Rows.Count, 1).End(xlUp).Row With ComboBox1 For i = 2 To lastRow If ComboBox1 = "" Then .AddItem sh.Cells(i, 1).Value End If Next i End With End Sub ////////////////////////////////////////////////////// とまぁ、結局コードは同じなのですが。 それと、結果をラベルに出させる場合には回答で記述いただいた ////////////////////////////////////////////////////// Private Sub ComboBox1_Change() 　　Dim vTgYear As Variant 　　vTgYear = ComboBox1.Value 　　Label1.Caption = vTgYear - 1 & "～" & vTgYear + 1 & "年" End Sub ////////////////////////////////////////////////////// で、よいでしょうか？ よろしくお願いいたします。
Excel2007のVBAについてご教授ください。 Application.Matchで特定列の文字列検索を使いたいんですが以下のような構文で使えますでしょうか？ ----------------- Set usWS = Worksheets("Sheet1") KeyIdValue = "hogehoge" JANCol = 9 m = Application.Match(KeyIdValue, usWS.Columns(JANCol), 0) ----------------- Sheet1のワークシートの９（I列）列目に"hogehoge"が入っている行数をmに入れたいです。 （最初に見つかった行数で構いません。複数は見つかりません。） 検索されません？というようなエラー（エラー2042）が出るのですが、使い方が誤っていないかご教授させて頂きたいです。 変数の宣言はコンパイルエラーが出ないので問題ありません。 Application.Matchの使い方に問題ないか教えて頂けませんでしょうか？ よろしくお願いします。
Visual Basic 2010を使ってoutlook 2007を操作し、予め用意したテキストを送信できる簡単なサンプルプログラムはないでしょうか。 相手のメアドはプログラムの中に書きます。outlook 2007はあくまでも送信用メーラーとして使うだけです。
Excelのワークシートでコンボボックスを設定する方法を教えてください。 「フォームコントロール」と「ActiveXコントロール」の違いがわかりません。 添付の画像の通りコンボボックスに西暦を入力(別シートに入力済みの値を表示するように設定)してあるのですが、ファイルを保存しているにも関わらず、再度ファイルを開くとコンボボックスの中のリストは空欄になってしまいます。 今は「ActiveXコントロール」のコンボボックスで設定しています。 コードは以下のように設定してみたのですが、設定内容や設定箇所が違うのでしょうか？ ////////////////////////////////////////////////////// Private Sub ComboBox1_DropButtonClick() Dim sh As Worksheet Set sh = Worksheets("マクロ") Dim i As Integer Dim lastRow As Integer lastRow = sh.Cells(Rows.Count, 1).End(xlUp).Row With ComboBox1 For i = 2 To lastRow If ComboBox1 = "" Then .AddItem sh.Cells(i, 1).Value End If Next i End With End Sub ////////////////////////////////////////////////////// コンボボックスのリストの内容が消えてしまうので、 コードの内容は同じで以下のところにもコードを書いてみました。 ////////////////////////////////////////////////////// Private Sub Worksheet_Activate() Dim sh As Worksheet Set sh = Worksheets("マクロ") Dim i As Integer Dim lastRow As Integer lastRow = sh.Cells(Rows.Count, 1).End(xlUp).Row With ComboBox1 For i = 2 To lastRow If ComboBox1 = "" Then .AddItem sh.Cells(i, 1).Value End If Next i End With End Sub ////////////////////////////////////////////////////// なんだかもう、訳がわからずぐちゃぐちゃです。 コンボボックスの中に値が入っていると、実行ボタンをクリックしたときは正常にやりたい結果を出すことが実現できます。 ファイルを閉じた後に再度開いてもコンボボックスの中に値があるようにするにはどうしたらよいのか、ド素人の私にご教授いただきたくお願いいたします。
.NET　2010でアクセスのモジュールを実行させようとしております。 アクセスに配列を引数にしようとしていますが “Public ReadOnly Default Propety Chars(index as Integer) as Charに対する引数が多すぎます。” のエラーが発生しており困っております。 これはどのようなことが原因でエラーが発生しているのでしょうか。 また、解決策がありましたらご教授していただけないでしょうか。 .net側 Private sub AcsRun() Dim strdata as string Dim pData(50,10) as object Strdata =数値1 pData(1,1) = 文字2 pData(2,1) = 数値2 　　　　・・・・・・・ 　　‘ここでpDataでエラーがでます。 If app.Run("AcsMdl"( Strdata, pData) = False) Then 　　　Exit sub End If End sub アクセス側 Public Function AcsMdl (Strdata As Integer, pData () As Variant) As Integer AcsMdl = false ‘処理 AcsMdl = true End function
Private Sub Worksheet_Change(ByVal Target As Range) Dim ret If Target.Address = "$B$2" Then Set ret = Workbooks("抽出.xlsm").Sheets("抽出元").Range("A:A") _ .Find(ActiveSheet.Range("B2").Value) ActiveSheet.Range("C2").Value = ret.Offset(0, 5).Value ActiveSheet.Range("D2").Value = ret.Offset(0, 6).Value ActiveSheet.Range("E2").Value = ret.Offset(0, 7).Value ActiveSheet.Range("F2").Value = ret.Offset(0, 4).Value ActiveSheet.Range("G2").Value = ret.Offset(0, 2).Value ActiveSheet.Range("H2").Value = ret.Offset(0, 8).Value ActiveSheet.Range("I2").Value = ret.Offset(0, 9).Value ActiveSheet.Range("J2").Value = ret.Offset(0, 10).Value End If End Sub 上記のようなマクロで 　選択したセルの値を検索（必ずB列） 　選択セルと同じ行に抽出した各データを書き込み（選択セルがB5の場合　C5,D5,E5…に書き込む） ようにするにはどのように書き換えたらいいのでしょうか。 変数で行を取得して…など試したのですがどうもうまくいきません。 どなたかお願いします。 オートフィルタも考えたのですが諸事情で見出しを揃えることができない為諦めました。 現在はVLOOKUP関数で処理を行っていますが既に24000近いセルに式が入っており、データは重くなるし非効率的な気がします。
教えて下さい。 vb.net(VS2010 FW4.0)にて、2つのByte配列の各要素をOR演算し、結果をどちらかのByte配列へ格納するか、別のByte配列へ格納したいのです。 For分で回すとできるのは分かるのですが、メソッドを使ってできないか教えて下さい。 条件としては、２つのByte配列の要素数は同じです。 For分で記述すると、 Dim bytA() as Byte = {0,0,0,0,0,128,128,128,128,128} Dim bytB() as Byte = {255,255,255,255,255,0,0,0,0,0} For i as Integer = 0 to bytA.GetUpperBound(0) bytA(i) = bytA(i) Or bytB(i) Next ''' 結果は bytA = (255,255,255,255,255,128,128,128,128,128)となる
こんにちは MS Word 2007から条件に合う語を抜き出してエクセルに貼り付けた後、ソートをするマクロを書いているのですが、ソートの部分で「型が一致しない」というエラーが出てしまい困っています。エクセルのVBAでは問題なく動作しています。 次がエクセルVBAで作ったソートのVBAです。 ActiveWorkbook.Worksheets("Sheet1").Sort.SortFields.Clear ActiveWorkbook.Worksheets("Sheet1").Sort.SortFields.Add Key:=Range("A1"), _ SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal With ActiveWorkbook.Worksheets("Sheet1").Sort .SetRange Range("A1:A6") .Header = xlNo .MatchCase = False .Orientation = xlTopToBottom .SortMethod = xlPinYin .Apply End With これをWord VBAに貼り付けて、一部を変更しました。 myExcel.workbooks(BookName).sheets(1).Sort.SortFields.Clear myExcel.workbooks(BookName).sheets(1).Sort.SortFields.Add Key:=Range("A1"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal With myExcel.workbooks(BookName).sheets(1).Sort .SetRange Range("A1:A6") .Header = xlNo .MatchCase = False .Orientation = xlTopToBottom .SortMethod = xlPinYin .Apply End With myExcelは事前に作成したExcelオブジェクトです。BookNameは作成したブックのファイル名です。2行目「myExcel.workbooks(BookName).sheets(1).Sort.SortFields.Add Key:=Range("A1"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal」でエラーになります。 「型が一致しない」と表示されます。ちょこちょこ書き換えているのですがエラーは解消されません。 Windows 7/8 64bit Word 2007. Excel 2007 解決策をご存じでしたら教えてください。
お世話になります。 表題のとおり、F5：H35の範囲で、通し番号を入力したいのですが、VBAコードのヒントを教えていただけませんでしょうか？ 番号を振る規則は「5行が1・2・3」「6行が4・5・6」といった具合に、横に昇順に並べたいのです。 最後に「35行が103・104・105」としたいです。 下記のようにコードを書いてみました。 5行（1行目）まで走るんですが、6行（2行目）に改行してくれませんでした。 For構文の原理がいまひとつ理解できてないからでしょうか？ --------------------------------------- Sub 通し番号() 1) Dim i As Integer, j As Integer, n As Integer 2) i = 5 3) j = 6 4) n = 1 5)For i = i To 35 6)For j = j To 8 7)Cells(i, j) = n 8)n = n + 1 9)Next 10)Next End Sub -------------------------------------- 以上です。 よろしくお願いいたいます。
VBSを利用して、IEのタブを自動的に切り替え続けるスクリプトを作成しています。 以下現状 手動でやる事 ・作成したVBSファイルをダブルクリックして起動 ・IEは常に画面の全面（アクティブウィンドウ）にしておく VBSファイルの中身 set W = WScript.CreateObject("WScript.Shell") do WScript.sleep 30000 W.Sendkeys "^{TAB}" loop これでも正常に動くのですが、 ここにESCキーを押す事でプロセスを終了させるスクリプトを追記したいのですが、どのようにしたらよいでしょうか。 ご教授お願いします。
独学でVBAを始めて1ヶ月の初心者です。 下記のコードについて質問です。 シート"strage２"のA1からA15のデータをシート"strage1"と比較し、違ったら更新します。 更新したデータだけを、まとめてメッセージボックスで返したいのです。 しかし、返してくるのは一番最後に処理した値だけなのです。 何が間違いでしょうか？ ご指南よろしくお願いいたします。 --------------------------- Sub 何を書き換えたかMsgBox() Dim i As Integer Dim myMsg As String i = 1 For i = i To 15 If Sheets("strage1").Cells(i, 1) <> Sheets("strage2").Cells(i, 1) Then myMsg = Sheets("strage1").Cells(i, 1).Value & "から" & Sheets("strage2").Cells(i, 1) & "に変更しました" & vbCrLf Sheets("strage1").Cells(i, 1).Value = Sheets("strage2").Cells(i, 1) Else End If Next i MsgBox myMsg End Sub -------------------------------------- 以上です。よろしくお願いします。
環境 Excel2003 Win7 64bit -------------- Const C as Currency = 50000000 Sub Test() 　　Dim A as Currency 　　Dim B as Currency 　　B = 6823695200 　　A = B \ C '←ここでオーバーフロー End Sub --------------- 「A = B \ C」 ↑この式はオーバーフロー時、ウォッチ式上では、 型： Integer　と表示されますが、これも不思議。 また、「A = B \ C」を、 A = CCur(B) \ CCur(C) としても、オーバーフロー。 それと、 「Const C as Currency = 50000000」を、 「Const C = 50000000」　としても、同様にオーバーフロー。 Currency型は、 -922,337,203,685,477.5808～922,337,203,685,477.5807 のはず。 このオーバーフローは、一体なぜ？
300台ほどのPCがNASに接続されており、あるEXCEL（ABC.xlsm）を参照したり入力したりします。 今日、誰かがそのEXCELを閉じずに帰ったようで、このEXCELを開こうとすると、 ABC.xlsmは編集のためロックされています。使用者は××です。とでます。 残念ながら、全PCとも××と同じ名前になっているので、どのPCか不明です。 ～＄ABC.xlsmもできています。 なんとか、ロックをはずす手段はないものでしょうか？
Excelマクロで、Publicステートメントで配列を定義し、 プロシージャ内で配列要素を増やすことはできないのでしょうか？ 下記ロジックで2つのMsbBoxが表示されるようにしたいです。 よろしくお願いします。 Public pubTMP Sub test() pubTMP(2,2)="aaa" test222 Msgbox pubTMP(2,2) Msgbox pubTMP(3,3) End Sub Sub test222() pubTMP(3,3)="bbb" End Sub
エクセルVBAです。 ユーザーフォームのテキストボックスでカーソルが点滅している状態で 例えばエクスプローラ等何でもいのですが、他の画面を表示したあと 再度ユーザーフォームを表示すると、フォーカスはそのテキストボックスに あるようなのですが、カーソルは消えています。 画面を切り替えてもカーソルが元の状態のままにするにはどうしらいいでしょうか。
VBScriptのRegExpオブジェクトで拡張機能を有効にするにはどのようにすればいいのでしょうか。例えば、後方一致(先読み)は正しく実行できますが、前方一致(後読み)は拡張機能となっているためそのままではエラーになりますがどのようにすれば前方一致(後読み)の機能が使えるようになるのでしょうか。(OSはWindowsXPです) ------------------------------------- Option Explicit dim a dim bs dim b Dim o Set o = new RegExp o.IgnoreCase = False o.Global = True o.pattern = "\d+(?=年)"　　　　　　　　　　　　'後方一致　 <OK> 'o.pattern = "(?<=昭和)\d+"　　　　　　　　　'前方一致　 <ERROR> a="昭和45年と平成26年" Set bs = o.Execute(a) For Each b in bs 　WScript.echo b.FirstIndex+1 & "文字目の" & b.Value & "がマッチしました" Next Set o = Nothing -------------------------------------
VBAとVBScriptを混同しているのかもしれませんがよく分からないので教えてください。 Excel2010のVBAから、外部プログラム(test.exe)をコマンドプロンプトを非表示の状態で実行して、外部プログラムの実行が終了するのを待ってから、次の処理をさせたいのですが、test1のプログラムでは(A)の部分でエラーになってしまいます。また、test2のプログラムでは正しく実行されるのですがコマンドプロンプトのウインドウを非表示にする方法がよく分かりません。 test1のプログラムでエラーをでなくする方法、または、test2のプログラムでコマンドプロンプトのウインドウを非表示にする方法がありましたら教えてください。 ------------------------------------------------------- Sub test1() 　Dim ws As Object 　Dim we As Object 　Dim command As String 　command = "C:\test.exe" 　Set ws = CreateObject("WScript.Shell") 　Set we = ws.Run("%ComSpec% /c " & command, 0, False) '<===(A) 　Set we = Nothing 　Set ws = Nothing End Sub ------------------------------------------------------- Sub test2() 　Dim ws As Object 　Dim we As Object 　Dim command As String 　command = "C:\test.exe" 　Set ws = CreateObject("WScript.Shell") 　Set we = ws.exec("%ComSpec% /c " & command) 　Do Until we.Status 　　DoEvents 　Loop 　Set we = Nothing 　Set ws = Nothing End Sub -------------------------------------------------------
VBA初心者です。 １つのフォルダ内にある１００（ファイル名００１から１００）個のエクセルファイル（ブック）の特定の場所（すべてのエクセル ファイルはファイル名は違うが、同一のシート名で同一のセルの構造になっている。 以上に対して、1つのもとになるファイルA（ブック、シート）の特定のセル（同一列の行を上から順次下る）セルの値を先の同一フォルダ内のエクセルファイル１００（００１～１００）個に対して、ブックオープン、特定セルのデリート、特定セルへの書き込み、ブック保存という一連の作業を行いたいです。 多数のファイルから１つの集計ファイルに値を読み込んできて書き込むサンプルはあるようですが、逆に１つのファイルから同一フォルダ内の多数のファイル（ブック）の特定場所に書き込むためのサンプルコードを教えていただけると大変助かります。 以上よろしくお願いいたします。
ExcelVBAでデータを条件に応じてコピーしたいと思っています。 同一階層に「VBAファイル.xls」「1_フォルダA」「2_フォルダB」「3_フォルダC」があります。 「1_フォルダA」と「2_フォルダB」には年代別に分かれたファイルがあります。 ファイルとフォルダの構造は以下の通りです。 VBAファイル.xls 1_フォルダA 　∟1999_ファイルA.xls 　∟2000_ファイルA.xls 　∟2001_ファイルA.xls 　∟2002_ファイルA.xls 　∟2003_ファイルA.xls 　∟2004_ファイルA.xls 　∟2005_ファイルA.xls 　∟2006_ファイルA.xls 　∟2007_ファイルA.xls 　∟2008_ファイルA.xls 　∟2009_ファイルA.xls 　∟2010_ファイルA.xls 　∟2011_ファイルA.xls 　∟2012_ファイルA.xls 2_フォルダB 　∟1999_ファイルB.xls 　∟2000_ファイルB.xls 　∟2001_ファイルB.xls 　∟2002_ファイルB.xls 　∟2003_ファイルB.xls 　∟2004_ファイルB.xls 　∟2005_ファイルB.xls 　∟2006_ファイルB.xls 　∟2007_ファイルB.xls 　∟2008_ファイルB.xls 　∟2009_ファイルB.xls 　∟2010_ファイルB.xls 　∟2011_ファイルB.xls 　∟2012_ファイルB.xls 3_フォルダC 　∟ファイルC_結果.xls 「VBAファイル.xls」では添付の画像のような「ActiveXコントロール」を設定しました。 コンボボックスで西暦を選択すると、選択した年を中心年として、 前後1年を合わせて合計３年がラベルに表示されます。 その年のファイルのデータが「ファイルC_結果.xls」にコピーされるようにしたいです。 例えば画像のように「2007」を選択した場合、 ・「2006_ファイルA.xls」のC7～C25を「ファイルC_結果.xls」のD7～D25にコピー ・「2007_ファイルA.xls」のC7～C25を「ファイルC_結果.xls」のE7～E25にコピー ・「2008_ファイルA.xls」のC7～C25を「ファイルC_結果.xls」のF7～F25にコピー ・「2006_ファイルB.xls」のC6～C24を「ファイルC_結果.xls」のH7～H25にコピー ・「2007_ファイルB.xls」のC6～C24を「ファイルC_結果.xls」のI7～I25にコピー ・「2008_ファイルB.xls」のC6～C24を「ファイルC_結果.xls」のJ7～J25にコピー というようにしたいです。 「ファイルC_結果.xls」のD/E/F列はファイルAのデータで、 D列は前年、E列は当年、F列は翌年 H/I/J列はファイルBのデータで、 H列は前年、I列は当年、J列は翌年の値をコピーして貼り付けたいです。 また、可能であれば「ファイルC_結果.xls」は原本なので、 値をコピーする際にファイル名が変更できればよりよいです。 いろいろ書いてしまい、うまく伝わっているか不安なのですが 処理するデータが多くとても困っています。 お知恵のある方、どなたか助けていただけますと幸いです。 よろしくお願いいたします。
VBAでセルF1に数式を入れようと次のようにしました。 Range("F1").Formula = "=if(D4=" & """"",""""" & ",JIS(PHONETIC(D4)))" 実行したところ、F1セルは「#NAME?」と表示されてしまいます。 F1セルの数式バーには、きちんと、「=if(D4="","",JIS(PHONETIC(D4)))」となっています。 この数式を数式バー内で一度選択してリターンキーで決定するときちんとD4セルのふりがなが入ります。 これまでにも、数式を入れたことはあったのですが、こんなことにはなりませんでした。 今回は、なぜ正しい関数式が入ってもきちんと表示されないのか分かりません。 よろしくお願いします。
VBでDataGridViewを使用して表の入力処理をして居ます。 入力内容が数字で無い時はエラー表示をして、セルのフォーカスをエラーセルに戻そうとして居ます。 実際にプログラムを組んだのですが、エラー時にセルのフォーカスが元に戻らす、エラーで無い時と同じ様に次の行に行ってしまいます。 エラー時にRow、Columnのアドレスを保存して置き、ボタンでそのRow、Columnの場所にセルのフォーカスを当てると、その位置のセルにフォーカスが当たります。 コーディング上は全く同じですが、同一処理内ではフォーカスの設定は出来ないものでしょうか。 試しに間にApplication.DoEvents()を入れてみましたが結果は同じでした。 どなたかこの現象を解決出来る方法が分かる方、若しくはDataGridViewではこの様な事は出来ない理由をご存知の方、お教え下さる様お願い致します。 ‘CellEndEdit割り込み処理 Private Sub dgvTst_CellEndEdit(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles dgvTst.CellEndEdit Dim iVal As Integer Dim sWrk As String sWrk = dgvTst.CurrentCell.Value　‘セルの値をワークに If subChkDec(sWrk) = False Then '数字か調べる。 MsgBox("Error")　‘数字で無い時、エラー表示 iRow = dgvTst.CurrentCell.RowIndex　‘Rowアドレス取得 iCol = dgvTst.CurrentCell.ColumnIndex　‘Columnアドレス取得 lblRow.Text = iRow.ToString("D")　‘デバックの為にRow表示 lblCol.Text = iCol.ToString("D")　‘デバックの為にColumn表示 Application.DoEvents() dgvTst.CurrentCell = dgvTst.Rows(iRow).Cells(iCol)　‘RowとColumnを指定してセル位置変更したつもり、フォーカスは入力したセルの下に移動する。 End If End Sub ‘ボタンでの割り込み処理。 Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click dgvTst.CurrentCell = dgvTst.Rows(iRow).Cells(iCol)　‘同じ処理をボタンの割り込みで行うと指定した(エラーとなった)所にフォーカスが移る。 End Sub
すみません、ファイルからデータを読み込んでいるのですが、変なコードが入っているらしく、EOFはきちんと認識できず、困っています。 文字コードも何かわからなず、半角空白でもないようです。読み込みファイルの2行目の"ー"と"＆"の間にある見えない文字コードです。（さくらエディタでは半角空白に見えてます。） 何なのかも私にはわかりませんが解決方法をご教授願います。このコードを削除するば良いですが、大量にあり手動では削除困難です。 （出来れば以下のサンプルプログラムを修正する形で教えてもらえると助かります。） 簡単なVBAコードと読み込みファイルをお付けしますので、解決策をご教授方よろしくお願いします。 （以下のコードでも問題は発生します。） 添付ファイルが付けれないし、コードは変換されて表示されそうです。。。 その場合はどうやって調べれば良いかご教授頂ければと思います。 ----------VBAプログラム（Excel2007で作成）---------- Option Explicit Sub testLoadFile() Dim intFF As Integer ' FreeFile値 Dim lngREC As Long ' レコード件数カウンタ Dim strREC As String ' レコード領域 Dim opnFileName As String ' FreeFile値の取得(以降この値で入出力する) intFF = FreeFile ' 指定ファイルをOPEN(入力モード) opnFileName = ActiveWorkbook.Path & "\loadtest.txt" Open opnFileName For Input As #intFF lngREC = 0 ' ファイルのEOF(End of File)まで繰り返す Do Until EOF(intFF) ' レコード件数カウンタの加算 lngREC = lngREC + 1 ' 行単位にレコードを読み込む Line Input #intFF, strREC Cells(lngREC, 1).Value = strREC Loop ' 指定ファイルをCLOSE Close #intFF End Sub --------読み込みファイルテキスト（３行のファイルです。）------------ "aaa","3" "cccー＆","4" "bbb","5"
java でプログラムして何とか完成できました。 var links = document.getElementsByTagName( "link" ), filtered = [], i = links.length; while ( i-- ) { links[i].rel === "prev" && filtered.push( links[i] ); } alert( filtered[0].href ); このjavaプログラミングをVBAで動作させるためにはどのようにすればよいですか？ VBAに詳しいどなたか　おしえてください。
VBAでフォームコントロールのチェックボックスのON・OFFを変更することは可能でしょうか。 具体的にはA.xlsmのマクロを実行して、 A.xlsmのセルA1が0ならB.xlsの"チェック 1"がOFF状態に。1ならON状態になる。 以上のような仕組みを作りたいです。 （フォームコントロールなのは様式（B.ｘｌｓ）がフォームコントールで作成されており、変更不可のため） ですが、同じシート内でもチェックボックスのON・OFFができずに挫折しそうです。 まずは同一シート内で作ってみようと思い下記コードを作成したのですが、 ”SubまたはFunctionが定義されていません”となってしまいます。 Public Sub test() If Range("A1") = 0 Then CheckBoxes("チェック 1").Value = False ElseIf Range("A1") = 1 Then CheckBoxes("チェック 1").Value = True Else MsgBox "無効な値が設定されています" End If End Sub エラーは”CheckBoxes”のところで出てしまいます。 どなたかご教授ねがいます。
　エクセル２０１０で、1つのフォルダ内にある複数のエクセルファイル（約１００支店分）から、日次売上等の集計マクロを作成したいのですが方法がわかりません。 上司からの依頼を受け、ひとり悩んでましたが・・・で皆さんに相談です。ご協力お願いします ■基本条件 ・毎日、支店がフォルダ内の売上情報を入力（更新）し保存する。 ・全店とも中身は同書式同形式ファイル 　例)実績報告Ａ店.XLS、実績報告Ｂ店.XLS・・・ ■マクロ（集計.XLS）でやりたいこと ・各支店ブックの実績シートから、支店名（A5）・売上A（B5）・売上B（C5）を転記し明細表の作成 ・集計表の作成 マクロど素人の私に、どなたか教えていただけますでしょうか？ よろしくお願いします。
【Book2】（Sheet2)L1に「12-1」を入力 ↓ 【Book1】(Sheet1)で「12-1」をM列、T列、AA列から検索→M4に「12-1」があった ↓ 【Book1】(Sheet1)N4：S4のデータを【Book2】(Sheet2)M1:R1にコピー 各ブックは同一ファイルに保存 検索する文字列の重複はなし 現在は関数≪VLOOKUP≫を使い上記を行っています。 マクロを使った方がスムーズに処理できるのでしょうか。 マクロを使う場合はどのような方法が良いのでしょうか。 データ数は1000行程度、各行の25個のセルに≪VLOOKUP≫関数が入っています。
個人名.xlsmがあり、中味をみて必要ならばまっさらのに更新し、元の分はOLDというフォルダに保存したいのですが... oldName=ThisWorkbook.Name oldPath=ThisWorkbook.Path 中味をみて更新すべきという状態だったら newName="以前の" & oldName newPath=oldPath & "\" & "OLD" ThisWorkbook.save as Filename:=newPath & "\" & newName sheets("sheet1").select Cells.Select Selection.ClearContents ThisWorkbook.save as Filename:=oldPath & "\" & oldName とすると最後の行が黄色になって、 実行時エラー 1004　個人名.xlsmにアクセスできません。 とでます。 何か打開する方法はないでしょうか？
VB.NETで既存のWebBrpwserコントロールを継承して 独自のコントロールを作成せいしたいのですが上手くいきません。 以下、私が実践した手順です。 １．プロジェクトにクラスを追加 　　→クラス名：CBrowser ２．CBrowserにWebBrowserを継承 　　→Inherits WebBrowserを記述 ３．フォームに既存のWebBrowserを配置 ４．Designer.vbを編集 　　→２箇所のSystem.Windows.Forms.WebBrowserをCBrowserに置き換え このやり方だと、稀にフォームデザイナーがエラーを出してしまいます。 よろしくお願いします。
エクセルＶＢＡで　ＩＥ読み込み完了まで、というサンプルは有るのですが 時間来ても、読み込め無い時　中止の処理ですが、 下記で如何でしょうか（実験が出来ないので、お知恵拝借） さらに、もっと、スマートな方法が有ればご教示ください。 Set IE = CreateObject("internetExplorer.application") url = yobiurl ' "http://admin.blog.fc2.com/control.php?mode=edito … With IE .Navigate url .Visible = True i = 1 Do While .Busy = True Call Sleep(50) '0.05sec　*　400　=20秒 DoEvents i = i + 1 If i > 399 Then .Quit ' End With Set IE = Nothing Exit Sub End If Loop i = 1 Do While .document.ReadyState <> "complete" Call Sleep(50) DoEvents i = i + 1 If i > 399 Then .Quit ' End With Set IE = Nothing Exit Sub End If Loop
ExcelVBAのSelect Caseで Select Case 数式または文字列式 Case 値1, 値2, 値3 　処理 Case Else 　処理 End Select のようにカンマで区切ると複数の値を指定できるはずです。 この値1, 値2, 値3のところに別のシートのＡ1、Ａ２、A3に入っている値を設定したいのですが そのようなことは可能でしょうか？（A1→値1　A2→値2　A3→値3） 5年ぶりにＶＢＡを書いていますが、びっくりするぐらい忘れています。。。
以下のようなプログラムで、ExcelVBAで作成しております、Webの情報を取得しております。 strGetUrl のところのサイトによっては、メモリが解放できず困っています。 Whileで繰り返すほど、メモリを消費して解放されません。メモリいっぱいになれば解放してくれるのかと思いましたが、止まってしまいました。2回目はOSを壊して再インストールしてもらいました（VPS上で）。 困っております。オブジェクトも”Set ｘｘｘｘ = Nothing”で解放しているつもりです。 考えられる理由をご教授頂けると幸いです。 環境は OSはWindowsServer2008R2 IEはIE8 でVPSなので変更不可と言われました。 ちなみに、Windows8.1の環境ではメモリが溜まっていくことはなかったです。 何か良い方法はありますでしょうか？ また、別のWebアクセス方法はありますでしょうか？ IE = CreateObject("InternetExplorer.Application")は同じ結果でした。 以下のプログラムでサイトにもよりますが、発生しています。 *********************************** Option Explicit Sub testHtml() Dim doc As Object, objTag1 As Object, objTag2 As Object Dim oHttp As Object Dim strUrl As String, strGetUrl As String Dim rowIndex As Integer ' 基本URL設定 strGetUrl = "http://www.xxxx.xxx.com" rowIndex = 1 '1列目が1行づつ進めてが空になったら終了 While Cells(rowIndex, 1).Value <> "" Set oHttp = CreateObject("MSXML2.XMLHTTP") Set doc = CreateObject("htmlfile") ' *************** HTTPヘッダの作成し、送信してデータを取得 ***************** With oHttp .Open "GET", strGetUrl, False .Send ' 受信したデータをオブジェクトに書き込みます。 doc.Write .responseText End With ' *************** 受信データを解析し、H2データ取得に分割 ***************** For Each objTag1 In doc.body.getElementsByTagName("H2") If objTag1.className = "resultCount" Then Cells(rowIndex, 2).Value = objTag1.innerText End If Next ' Objectの解放 Set objTag1 = Nothing Set objTag2 = Nothing Set doc = Nothing Set oHttp = Nothing rowIndex = rowIndex + 1 Wend End Sub
エクセルのVBAでＩＥのページを（メニュー選択）進める件ですが Dim tag As String Dim objtag As Object in_str = "新しく記事を書く" tag = "li" Set objtag = doc.getElementsByName(tag)(0) For Each objtag In IE.document.getElementsByTagName(tag) 　　If InStr(objtag.outerHTML, in_str) > 0 Then 　　　Exit For 　　End If Next Debug.Print objtag.outerHTML objtag.Click For　は　機能していて、Debug　は <LI><A href="?mode=editor&amp;process=new">新しく記事を書く</A> で　止まっています。 で、叩く方法は？？ Click が機能しないのですが objtag. の　後に　お助け文字が全く出ませんので、行き詰りました。
TextBoxに入力した「0123」などの数字を文字列として"ControlSorce"などで次回起動時に表示したい場合どうすればよいのでしょうか。普通に「0123」と入れた場合その時は「0123」として表示されますが次回起動時は「123」となってしまいます。
Excel2010のVBAで別ブックのシートをコピーしてくる方法 Excelファイル(C:\test\BOOK2.xls)のシート名が TESTというシートを自分のExcelファイル(C:\doc\BOOK1.xls)に コピーするにはどのように記述すればよいのでしょうか。 ・コピー先:自分のExcelファイル(C:\doc\BOOK1.xls) 　VBAのコードがあるファイルです ・コピー元:C:\test\BOOK2.xlsのTESTシート 　なお、TESTシートを持つ同じ名前(BOOK2.xls)のファイルが 　別フォルダにもあります 　 Workbooks( )の引数にファイル名(BOOK2.xls)は指定できるのですが、 フルパス名(C:\test\BOOK2.xls)で指定できないので困っています。
VBで表を使用する必要があり、検索した所、DataGridViewがヒットしました。 これで目的は達せられると思うのですが、このコントロールはプログラムでしかサイズ、行数等を設定出来ないのでしょうか。 問題としては、表のデザインの時に行数、コラムの幅等の設定がやりにくい事です。 一々プログラムを作ってサイズを合わせて行かないと駄目な様ですね。 まぁ、希望サイズを考えておいて、プログラムで全て行やサイズを決定させる事は可能と思いますが。 何か、他のコントロールの様に実行前にサイズを設定する方法は無いでしょうか。 入力出来る表であればDataGridViewにはこだわりませんので、他の方法でも構いません。 方法が無いとのであれば、無いとの回答でも構いません。 宜しくお願い致します。
いつも拝見させていただいてます。 今回Excel VBAでタイムスケジュールを作成したところ、まったくわけのわからないエラーが発生してしまい途方に暮れており、皆様のお力をお借りしたく投稿させていただきます。 エラーの内容は簡単に言うと Function プロシージャの戻り値がなくなってしまう(0になっている)ことです。 ESC = ESColumn(EventStart) ---------------------------------- Function ESColumn(TimecoluConv As Date) As Integer Select Case TimecoluConv Case "8:00:00" ESColumn = 2 Case "8:10:00" ESColumn = 3 Case "8:20:00" ESColumn = 4 ・・・ End Select End Function と、このようなコードで入力された時間を数値に変換しているのですが、 繰り返し処理をしているといきなり戻り値が0になってしまいます。 今回は8:00を6回取得した後、8:10を変換しようとしたら戻り値が0になっていました。 戻り値を使用して、セルを選択するため、そのタイミングでエラーになります。 なぜ繰り返し処理の途中で発生するのでしょうか。 解説と対策をご教示していただけると大変助かります。 よろしくお願いします。
VBでWebBrowser1に表示したページのURLをTextBox1に表示させたいです。 分かる方サンプルコードを教えて下さい。お願いいたします。
VB6でエクセルを開き、ある処理をして、 名前を付けて保存ダイアログを出して保存したいのですが、 名前を付けて保存ダイアログを出すところがうまくいきません。 Dim app As Excel.Application Dim book As Excel.Workbook Dim sheet As Excel.Workshee Set app = CreateObject("Excel.Application") app.Visible = True Set book = app.Workbooks.Open("c:\test.csv") 'ファイルを開く Set sheet = book.Worksheets(1) sheet.Columns("B:D").Delete Shift:=xlToLeft sheet.Columns("C:D").Delete Shift:=xlToLeft sheet.Rows("1:7").Delete Shift:=xlUp ここで、名前を付けて保存ダイアログを出して、ファイルを保存したい。
初めて質問させていただきます Win7(32) + Office2010で社内業務用ExcelBookを作っている者です。社内向けに作ったマクロ付Bookを同じ環境で約40人が利用しています。 ところが最近、急に動作が不良になりました。 1.CommandButton1.Enabled =True / False 効かなくなってしまった 2.ThisWorkbook.SaveAs Filename$　において、すでに同名のファイルが有る場合、上書きで動作していましたが、　<Filename$は既に存在します上書きしますか＞とダイアログが出るようになってしまい、<いいえ>を押すとエラーになる　 原因が分からず、ここの相談箱などを参考に以下のように対処を検討しました。 　１はWorksheets("XX").OLEObjects(CommandButton1).Object.Enabled = True / False 　（本来はこの使い方が正しいようですが）　 　２はファイルが既に存在すればいったん消去する 　　If Dir(Filename$) <> "" Then 　　 Kill Filename$ 　　End If 　　ThisWorkbook.SaveAs Filename$ しかし本日　2014.2.13 Windows7とOffice2010 UpDateが有り、念のため試したところ、1と2両方ともに元に戻って動作するようになっていました。 動作不良になった原因は　2014年1～2月のWindowsUpdateではないかと思います。 　このような既存のマクロが急に動作しなくなるようなUpDateが頻繁に起きるのであれば、そのたびに製作者としてビクビクしなければなりませんし、Excelは業務では使えないと思います。 もしかしたら私の勘違いかもしれませんので１と２を経験された方は他にもいらっしゃるでしょうか？
添付画像のように、数字は１０行ずつ WWP-70、WWP-71、WP-72と下一桁が増えていきますし、 数字の前にはアルファベットとハイフンが入ります。 あと、セルの中に×が記入してある場合は数字が打ち込まれないように(飛ばして)プログラミングして頂けないでしょうか？ エクセルは2003を使用しております。 小々厄介な内容ですが、ご存知の方ご教示下さい。
ADOで rs.Open strSQL, cn, adOpenKeyset, adLockOptimistic を過ぎようとすると 実行時エラー 3265「要求された名前、または序数に対応する項目がコレクションに見つかりません」 になるのですが、 strSQLの文字列をクエリのＳＱＬビューに張り付けると、問題なくクエリが表示されます。 だから、 存在しないフィールド名を指定した訳ではないのですが なぜこの部分でエラーになるのでしょうか？ オブジェクトが閉じてないのかと思い、 rs.Close: Set rs = Nothing をイミディエイトでやってみたら オブジェクトが閉じている場合は、操作は許可されません。 になります。
Excel2010 VBAを使っています。 ファイルAに AAA BBBB CCCCC DD ・・・ というように50行程度に渡って文字列が書かれています。 この文字列をファイルB（これも同じく文字列が書かれています）と合体させるプログラムを作っています。 このプログラムをほかのPCでも使用したいのですが、 xlsmファイルとともにファイルAも同時にコピーする必要があり不便です。 ファイルAの内容を標準モジュールの中に保存したいのですが どのようにすれば良いでしょうか？ dim a(50) a(0) = "AAA" a(1) = "BBBB" a(2) = "CCCCC" a(3) = "DD" ・・・ というように配列として保存しておけば、これができるのですが、 いちいち、ダブルクオテーションマークでくくって 上記のようなコードを書くのが面倒です。 例えば、 a = "AAA BBBB CCCCC DD ・・・" のように複数行に渡る文字列を変数として用いたいのですが このようなことは可能でしょうか？
CSV取込により、添付画像のフォーマットに値で貼り付けし、昇順に並び変え、 印刷が出来るマクロが出来ないか考えていますが、何から手をつけていいのか分からない ため、詳しい方ご教授お願いします。 ■したいこと (1)CSVを取込し、値で添付のようなフォーマットに貼り付けしたい 　6行目でいうと、CSVのそれぞれの以下のセルの値がエクセル表の以下のセルに 　値で貼り付くようになります。 　※エクセル表は5行目がタイトル行になります。 　※コピー後の貼り付けは値で貼りつけしたい 　　　　　 エクセル表　B6 C6 D6 E6 F6 G6 　CSV　 　A2 B2 E2 F2 I2 L2 (2)昇順に並び変えをしたい 　G列は数字になりますので、昇順で並び変えをしたい (3)値が入っている範囲で印刷をしたい。 　CSV取込によりセットした値の印刷範囲で自動で印刷するようにしたいです。 すみませんが、宜しくお願いします。
vbaで http://www.valuecommerce.ne.jp/ に自動$インできるようにしようと思ってソースを見てるのですが、 どうしても、メールアドレスやパスワードの部分が見つかりません。 画像で表示させてるようなのですが IDやpassなどのタグで検索してみましたが 見つけられません。 そもそもソースにログインするソースはないのでしょうか？
皆さん、こんにちは。 Visual Studio 2013ですが、 Crystal Reportsが利用できるダウングレード版は まだ、リリースされていませんか？ 色々探してみたのですが、ありませんでした。 ご存じの方、おいでになりましたら ご一報お願いします。
dim hairetu(1000,1000) と宣言した後に、 (0,0)から(x,y)までデータを入れるとします。 このときのデータが入っている要素数xとyの値を求めたいのですが、 inboundやUboundだとemptyも含めた要素数を求めることになり使えません。 forを使わない方法があれば教えてください、
こんばんは。 VisualBasic6のMSFlexGridに以下の様にデータをセットしたいのですが中々うまくいきません。 ※DBのデータ RowNo　　　　ColNo　　　Data 1　　　　　　　　　1　　　　　　A 1　　　　　　　　　2　　　　　　B 1　　　　　　　　　3　　　　　　C 2　　　　　　　　　1　　　　　　D 2　　　　　　　　　2　　　　　　E 2　　　　　　　　　3　　　　　　F ※MSFlexGridデータセットイメージ RowName　　ColName1　　ColName2　　ColName3 1　　　　　　　　　A　　　　　　　　B　　　　　　　C　　　 2　　　　　　　　　D　　　　　　　　E　　　　　　　F　　　 縦に並んでいるデータベースの値を横に並べたく思っています。 RowNo = 1 , ColNo=1 , Data =A　⇒　MSFlexGrid 1行目、1列目の値=A というような感じです。 わかり難くて申し訳ないですがご教授頂けると助かります。 どうぞ宜しくお願い致します。
XP SP3の環境でVisualStudio2010Proを使用しているのですが、先日一部の漢字が「・」 表示されるようになりました。（未登録の外字などの代わりに出るやつです） 例えば、上メニューの設定が「・・」、ファイルメニューのすべて保存が「すべて保・」、プロジェクト起動時にフッタに表示されるファイル”～～”を読み込み中が「ファイル”～～”を・み・み・」と表示されます。 他の症状として、 ・テキストのソースコードは問題ない ・デバッグしたプログラムのラベルやリストボックスの漢字もおかしい ・exeから起動しても同様の症状 ・ただし、ダイアログボックスだと正常に表示（他にも正常なコントロールがあるかも？） ・VS2003,2005とそれからデバッグしたプログラムは問題ない 等があります。 対策として、VS2010Pro、VS2010ProSP1、.netframework3.5・4.0の修復を行いましたが、依然おかしいままです。 同様の症状に心当たりのある方、対策をお願いします。
配列a(256, 256)をまるごとバイナリデータとして書き込みたい場合には Put #1,,a a(256, 256)の配列に入った数値のうち、 a(51,51)～a(256,256) に入った数値のみをバイナリデータとして書き込みたいのですが どのようにすれば良いですか？ で次元を変更して、この配列の中のデータを消さないままで a(0,0)～a(50,0)とa(0,0)～a(0,50) を削除してa(206,206)の配列を作成したいのですが、 ReDim Preserve a(206,206) とすると ”インデックスが有効範囲にありません”というエラーがでます。 http://hpcgi1.nifty.com/kenzo30/b_cbbs/cbbs.cgi? … このページにあるように、 ReDim Preserveは一次元配列でしか使えないそうです。 どうすれば一部だけバイナリに書き込めますでしょうか？
Data_Typeという変数の中に文字列doubleが入っていたら、 AIyyという変数をdoubleで定義、 longが入っていたらlongで定義するというプログラムを作りたいのですが If Data_Type = "double" Then Dim AIyy As Double ElseIf Data_Type = "long" Then Dim AIyy As Long End If と書くと、定義が重複しているというエラーが表示されてうまくいきません。 これはどうすれば良いでしょうか？ それと一度integerで定義した変数をlongなどに定義を変更したい場合どのようにすれば良いでしょうか？
いつもお世話になっております。 また詰まってしまいましたので質問させてください。 Ｓ列に「test」という文字が入っているセルの個数を集計し結果を セル「ＡＣ１」に表示したいのですがうまくいかずにおります。 なお、Ｓ列には様々な文字が入っているのでワイルドカードで検索しております。 データ数は変動します。 Sub Macro1() Dim c As Long Dim ans As Integer Dim i As Integer ans = 0 With ActiveSheet For i = Cells(65536, c).End(xlUp).Row To 1 Step -1 If Range("S" & i) = "*test*" Then ans = ans + 1 End If Next i Range("AC1") = ans End With End Sub 環境　Excel2003 以上、宜しくお願いします。
VBAを使って、一部バイナリデータを読み書きする方法 を教えてください。 あるファイルが1行目から30行目までが普通のASCII形式でデータが書き込まれており、 31行目以降はバイナリデータとなっています。 また、30行目にheader endと書かれています。 このデータを30行目までは文字列データとして抽出し、 31行目以降はバイナリデータとして抽出して、 少し内容を書き換えてから、最初と同様に 30行目までをASCII、31行目以降をバイナリデータとして出力したいのですが どのようにすれば良いですか？ http://homepage2.nifty.com/kasayan/vba/binary.htm http://hanatyan.sakura.ne.jp/vbhlp/Binary.htm バイナリデータの読み込み方は上記のページに書かれてあるのですが いずれも、ファイルをまるごとバイナリ形式として読み込むもので 一部だけバイナリとして読み込むことはできないようです。 どなたかどうすれば良いか教えてください。
VBAで配列からbmp画像を出力する方法を教えてください。 例えば、 dim a(255,255) で作成した二次元配列があり、それぞれの中に0～255の数値が格納されているとします。 この画像からグレースケールあるいは任意の配色で 256x256の解像度のbmp画像を出力するプログラムを VBAで作りたいのですがどのようにすれば良いですか？ 検索して調べたのですが、 http://www.vbalab.net/vbaqa/c-board.cgi?cmd=ntr; … http://akadamashy.blog68.fc2.com/blog-entry-915. … のサイトにビットマップ画像を出力するための プログラムが記載されていました。 しかしながら、どうしても配列からどうやって出力すれば良いか分かりません。 どなたか教えてください。
設問をA列に、回答欄をB列に設定した10問程の 正誤問題の一覧を作ろうとしています。 （B１に問題文、B２に正または誤で回答） セルを選択時にオプションボタンが出るようにし、 選択したものがセルに入力されるように プログラムを組みました。 現在入力しているコードは以下のものになります。 ●User Form Private Sub CommandButton1_Click() If OptionButton1.Value = True Then Worksheets(1).Range("B2").Value = OptionButton1.Caption ElseIf OptionButton2.Value = True Then Worksheets(1).Range("B2").Value = OptionButton2.Caption End If End Sub ●Sheet1 Private Sub Worksheet_SelectionChange(ByVal Target As Range) UserForm1.Show End Sub これと同じことがB3～B11でも繰り返されるようにするには どのようにコードを入力すれば良いでしょうか。 （Do～LoopやFor each～Nextを使用するのでしょうか？） また、現在はどのセルを選択してもオプションボタンが出るように なっているのですが、B2を選択したときにだけ出すようにすることは 可能でしょうか？ 初歩的な質問かもしれませんが、 全く検討がつかないのでご回答お願い致します。
環境：Windows7 ／　VIsual Basic 2008 教えて下さい。 データベースの値を、CSVファイルとして出力する為に、以下のような記述を しましたが、どうしても下記のようなエラーとなってしまいます。 Cドライブの直下は記述すべきでなく、アクセス権がないのが原因かと思われますが、 なんとかCドライブの直下へ出力したいと考えています。 良い方法はないでしょうか？ 《記述内容》 　'保存先のCSVファイルのパス 　Dim csvPath As String = "C:\ABC.csv" 　'CSVファイルに書き込むときに使うEncoding 　Dim enc As System.Text.Encoding = _ 　System.Text.Encoding.GetEncoding("Shift_JIS") 　Try '開く Dim sr As New System.IO.StreamWriter(csvPath, False, enc) 　Dim colCount As Integer = dtTable.Columns.Count　 　Dim lastColIndex As Integer = colCount - 1 　以下省略・・・ 《エラー内容》 　パス 'C:\ABC.csv' へのアクセスが拒否されました。 仮にアクセス権を付加するしか方法がないようであれば、申し訳ありませんが、 その方法も教えて頂ければと思います。 教えて下さい。 よろしくお願いします。
お世話になります。 環境　　Windows 7　：　Visual Strudio 2012 Function ABC(ByVal wCtrl As Object) As Boolean 　　If String.IsNullOrEmpty(wCtrl) = True Then 　　　　ABC= True 　　Else 　　　　ABC= False 　　End If End Function 今まで上記のようなやり方で、引数が空かどうかを検証していたのですが、これを実行すると 型 'System.InvalidCastException' の初回例外が Microsoft.VisualBasic.dll で発生しました というエラーが大量に発生します。 If String.IsNullOrEmpty(wCtrl) = True Then　の部分でこれが発生しているようで 動作には問題ないようなのですが、どうにかできないものかと思っております。 初回例外を発生させないで同じ機能にするにはどうしたらよいでしょうか？ 何卒よろしくお願いいたします。
Excel VBA 2007を使用しています。 ActiveWorkbook.RemovePersonalInformation = True によって、ブック保存時に個人情報を保存しないようにできますが、 ユーザーインターフェースの操作の「ドキュメント検査」と同様に、ブック保存前に個人情報を削除するにはどうすれば良いでしょうか。
VBAで配列をまるごとコピーする方法を教えてください a(256,256) という配列があり、これの中身を b(256,256) にまるごとコピーしたいのですが どのようにするのが手っ取り早いでしょうか？
説明が冗長になりそうですが・・・ たとえば「日別訪問動物」というフォルダがあるとします。 その中には、 20140206.txt 20140205.txt 20140204.txt　・・・ と、日別に名前がつけられたテキストファイルが複数入っています。 それぞれのテキストファイルは、以下のような内容が書き込まれています。 　○20140206.txtの中身 　今日わが家を訪問してきた動物は次の通りです。 　3匹・・・イヌ、カエル 　2匹・・・カワウソ 　1匹・・・ライオン、ゾウ、オオカミ 　○20140205.txtの中身 　今日わが家を訪問してきた動物は次の通りです。 　5匹・・・トラ 　2匹・・・ネコ、イヌ 　1匹・・・クマ 　○20140204.txtの中身 　今日わが家を訪問してきた動物は次の通りです。 　3匹・・・ネコ、ライオン 　1匹・・・カバ このときに、”最新の日付で、ネコが訪れてきたときのネコの数”をエクセルVBAで抽出し、任意のセル（たとえばA1など）に貼りつけたいと考えています。 上記の例では、「2匹」を抽出したいと考えています（2月5日に訪れたネコ2匹）。 どのようにすればうまくいくでしょうか？
お世話になります。 文字列の分解についてお聞きします。 環境はVB.NET2008です。 Private Sub Main(ByVal CmdArgs() As String) Dim cmds() As String cmds = System.Environment.GetCommandLineArgs() End Sub コマンドライン引数で以下のように文字列を取得しています。 ("起動exe", "/KEY=○○○/ テーブル名=△△△") この文字列を元に、 変数Ａに○○○を変数Ｂに△△△を代入したいのですが、どうやるのでしょうか？ ご教示願います。
度々、お世話になっており、今回もご教授お願いしたいです。 VBAの“Sheet1”に２つのコンボボックスのプログラムを作成しました。 Private Sub ComboBox1_Change() Private Sub ComboBox2_Change() どちらも選択（fmStyleDropDownList）のみです。 しかし、Excel起動時にコンボボックスの内容が登録されないため、 ThisWorkbookの【Private Sub Workbook_Open()】　で Private Sub ComboBox1_Change() Private Sub ComboBox2_Change() ↑この２つを実行したいのですが、、、、 なんと記述したらよいかわからず、行き詰っています。。。 Private Sub Workbook_Open() ComboBox1_Change() = ture End Sub ↑こんな感じであれやこれや試してはいますが・・・ 記述方法をご教授ください。よろしくお願いします。
今までC-Builderを使用しており、今回、会社の方針でVBでプログラムを書き始めた者です。 データーの比較を行いたいのですが、VBには文字定数と言う概念ありますか? C ですと以下の様なコーディングが可能です。 iDataが65の時flagを1に、それ以外の時にflagを2にする。 int iData; 　　　i f( iData == 'A' ) flag = 1; else flsg = 2; 現在VBで　if iDat = 65 then flag =1 else flag = 2 end if と書いていますが、もしVBに文字定数の概念があれば65ではなく'A'の値と比べて居る様にコーディングしたいのです。 もちろんコメントに書いて置けば良いのですが方法があればそれを使って見たいと思っています。 若しくはVBにはその様な概念は無いとの回答でも構いません。 色々探しましたが、分かりませんでしたので、お分かりに成る方、宜しくご回答下さい。
チェックボックスを配置して、チェックボックスがオンになった時に 測定器と通信して数値データを表示するプログラムを作っています。 数値データは刻一刻と変化するので、チェックボックスがオンの時は Loopで数値データを取得するようにしています。 数値データの取得を止めたいときはチェックボックスを再度クリックして 終了したいのですが、Loopの中に入っているとチェックボックスを クリックしても反応しません。 何か方法はありませんか?チェックボックス以外のボタンを配置して Loopを抜けるようにしないと駄目ですか? Private Sub Checkbox1_Click() If Checkbox1= 1 Then Do 数値データを取得して、画面上に表示するプログラム(チェックボックスのクリックが効かない) Loop End If End Sub
お世話になります。 2点ほどVB.netのコーディングに関して質問があります。 環境：VB2008 DB：SQLSEVER Ａ = アプリケーション1 B = アプリケーション2 複数の引数 = DB検索情報(key,テーブル名)＆ヒットしたファイルが格納されているルートディレクトリ ●実装したい機能 Aから外部のB(exe)を呼び出し、Aから受け取った複数の引数を元にDBを検索しファイル名をヒットさせ、そのファイルを開く。 質問(1) Aから外部のB(exe)を呼び出すときにAで取得した複数の引数をBに渡す方法はどうするのでしょうか？ 質問(2) 受け取った引数を元にDBを検索し、ヒットしたファイルを開きたいのですが、その複数の引数を格納する構文はどういったものになるのでしょうか？ ネットで調べはしましたが、いまいちピンとくるものがなく質問した次第です。 最近VBを始めたもので、質問をする上で情報が欠如しているかもしれませんが、ご回答頂けると幸いです。 よろしくお願いします。
VB6でトグルボタンを使いたいのですが、プロジェクト-コンポーネント-コントロールで Microsoft Forms 2.0 Obeject Libraryにチェックを入れて使えるようになりました。 しかし、他のソフトで同じことをすると 「この名前は既にあるモジュール、プロジェクト、オブジェクトライブラリで使われています。」という メッセージが出てしまいます。 対処策はあるのでしょうか?
Excel　VBを使って、デスクトップにあるcsv形式のデータを取り込むマクロを作りました（「マクロの記録」にて）。データは10個あるので、同じようなマクロを10個作っています。 そこで、取り込むcsvのファイル名ですが、01.csv、02.csv、…、10.csvという名前になるように1つ1つ名前の変更をしてから取り込んでいます。 これをもとのファイル名のままで、番号の若いもの順から取り込むということは出来ないでしょうか。 元のファイル名は「1002.csv」「1234.csv」「3456.csv」などと「（4ケタの数字）.csv」です。 今、使っているVBは以下の通りです（長くてすみません）。 どうぞよろしくお願いいたします。 ------------------------------------------------------------------------ Sub data01取り込み() ' ' data01取り込み Macro ' ' Sheets("data1").Select Range("A1").Select With ActiveSheet.QueryTables.Add(Connection:= _ "TEXT;C:\Users\user\Desktop\データ\01.csv", Destination:=Range("$A$1")) .Name = "cell1" .FieldNames = True .RowNumbers = False .FillAdjacentFormulas = False .PreserveFormatting = True .RefreshOnFileOpen = False .RefreshStyle = xlInsertDeleteCells .SavePassword = False .SaveData = True .AdjustColumnWidth = True .RefreshPeriod = 0 .TextFilePromptOnRefresh = False .TextFilePlatform = 932 .TextFileStartRow = 1 .TextFileParseType = xlDelimited .TextFileTextQualifier = xlTextQualifierDoubleQuote .TextFileConsecutiveDelimiter = False .TextFileTabDelimiter = True .TextFileSemicolonDelimiter = False .TextFileCommaDelimiter = True .TextFileSpaceDelimiter = False .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1) .TextFileTrailingMinusNumbers = True .Refresh BackgroundQuery:=False End With Range("E2:E400").Select Selection.Copy Sheets("計算").Select ActiveWindow.SmallScroll Down:=-16 Range("e4").Select ActiveSheet.Paste End Sub ----------------------------------------------------------------
マクロで収支を出すプログラムを組みたいのですが、具体的には Ｃ２：今回の収支　→　Ｂ７に反映される。　Ｃ７：前回の収支　Ｄ７：トータル収支 で、今回の収支を入力したらが更新されるプログラムなんですが。 Private Sub Worksheet_Change(ByVal Target As Range) If Target.Address(False, False) <> "C2" Then Exit Sub If Not IsNumeric(Target.Value) Then Exit Sub Range("C7").Value = Range("D7").Value Range("D7").Value = Target.Value + Range("C7").Value End Sub の、プログラムだと特定のセルだけになってしまいます。これにさらに人を認識して更新するプログラムを組みたいのですが上手くいきません。 画像を添付しますが、Ａさんの場合は、Ａさんの収支に反映される。Ｂさんの場合はＢさんの収支に反映される感じで作りたいです。 ちなみに人はプルダウンで変更できるようにしてあります。 どなたか分かる方がいらっしゃいましたら、ご教授をお願いいたします。
本を読みながら作ったのですが、全然動いてくれません。 Sheet１に A　　　　　　　　　　　B 1 2開始日　　　　　　2月12日 3開始時間　　　　 8:30 4終了時間　　　　　12:00 5間隔/ 分　　　　　　5 6人数/コマ　　　　　　8 という情報が入っています。 Sheet2には A2から番号が振ってあります。2000件くらいあります。 それに次の条件で番号を振りたいのです。 8時30分から12時までの間で8人毎に5分間下記の時間を振り分けたいのです。 12時を過ぎると翌日の8時半からまた同じことを繰り返します。 Sheet1の情報は毎回変更しますので、変数を使いたいと思っています。 　　　　　A　　　　　B　　　　　C 1 2　　　　1001　　2/12　　　8:30 3　　　　1002　　2/12　　　8:30 :　　　　　　:　　　　:　　　　　　: :　　　　　1008　　2/12　　　8:30 :　　　　　1009　　2/12　　　8:35 :　　　　　1010　　2/13　　　8:35 :　　　　　　:　　　　:　　　　　　: :　　　　　　:　　　　:　　　　　　: :　　　　　1336　　2/13　　　8:30 :　　　　　　:　　　　:　　　　　　: 　　　 Sub test() Dim strdate As Date, strtime As TimeValue, endtime As TimeValue Dim i As Long, c As Long, j As Long strdate = Worksheets(2).Range("b2").Value strtime = Worksheets(2).Range("b3").Value = TimeValue("8:30") endtime = Worksheets(2).Range("b4").Value = TimeValue("12:00") Range("b:b").NumberFormatLocal = "h:mm" i = Worksheets(2).Range("b5").Value c = Worksheets(2).Range("b6").Value If strtime < endtime Then Do While strtime < endtime For j = 1 To c Worksheets(1).Cells(j, 0) = strdate Worksheets(1).Cells(j, 1) = strtime Next j strtime = DateAdd("m", 5, strtime) Loop Else strtime = Worksheets(2).Range("b3").Value Do Until strtime = endtime For j = 1 To c Worksheets(1).Cells(j, 0) = strdate + 1 Worksheets(1).Cells(j, 1) = strtime Next j strtime = strtime + 5 Loop End If End Sub これでは全く動きませんでした。 また、strtimeをtimevalueで宣言するとオブジェクトを要求され、結果変数ではなく 直接データを入れることになってしまい、目的を果たせません。 初心者がやることではないなと思いましたが、これが出来ると、私たちの仕事が 画期的に向上するので、是非今回は苦労しても作り上げたいと思いました。 プロの方々はこういう場合、私はIf ⇒Do Loop⇒For Nextをネストしましたが、 どういう風に考えられるのでしょうか？それも興味があります。 よろしくアドバイスお願いします。<m(_　_)m> 　
エクセルVBAで、XML-RPCを使ってseesaaブログに投稿する方法が知りたいです。 セルA1:エンドポイント セルB1：ブログID セルC1：ログインid セルD1：パスワード セルE1：URL セルF1：カテゴリ名 セルG1：記事タイトル セルH1：本文 エクセルには、上記のような感じにデータがあるとします。 （本文は改行された文章が入っています） エクセルVBAを使って投稿できれば便利と思っているのですが、VBAがよく判らず困っています。 どなたか、教えていただけないでしょうか？ よろしくお願いします。
このサイトに http://dobon.net/vb/dotnet/internet/ftpwebclient … WebClientを使ってFTPサーバーからファイルをダウンロード、アップロードするというのがあります これを参考に実行して見ますと、ダウンロードはうまくいくんですが、アップロードがうまくいきません。 そのプログラムは 'WebClientオブジェクトを作成 Dim wc As New System.Net.WebClient() 'ログインユーザー名とパスワードを指定 wc.Credentials = New System.Net.NetworkCredential("username", "password") 'FTPサーバーにアップロード wc.UploadFile("ftp://localhost/test.txt", "C:\test.txt") '解放する wc.Dispose( と、非常にシンプルです。なんでうまくいかないんでしょうか？
規則性のあるテキストから、1行づつ処理を行い ある文字列の設定値を抽出したいです。 例：Bの値だけを抽出したい。(AとBの間は半角スペース) 【テキストファイルの中身】 ---------------------------------------- 1行目| A="あ" B="あ" A="い" B="い" A="う" 2行目| A="え" B="う" A="お" B="え" A="か" 3行目| A="き" B="お" A="く" B="か" A="け" ---------------------------------------- 【出力結果】（Bの値だけ） --------------------- 1行目| あ,い 2行目| う,え 3行目| お,か --------------------- 色々方法はあると思いますが、どうしても複雑になってしまうので 簡単に出来る方法（観点）があれば、ご教示頂きたいです。
VBA　Excel２００７を使用しています。 画像を読み込むために、例えば、 Dim picture As Shape Set picture = ActiveSheet.Shapes.AddPicture(filename:=filename, LinkToFile:=msoTrue, SaveWithDocument:=msoFalse, Left:=Selection.Left, Top:=Selection.Top, Width:=0, Height:=0) のように、一旦、画像を「文書とともに保存しない」モードで読込み、後にそのShape画像を「文書とともに保存する」ように変更することは、可能でしょうか。
VB2010で作ったアプリケーションを難読化するフリーソフトありませんか？ あれば教えていただきたいです。
ExcelVBAで複数条件一致の時の抽出法方を教えて下さい。 ここで教えていただいたコードがあるのですが、質問の仕方が悪かったのか、意図した結果が得られず、改変もできなかったので再質問です。よろしくお願い致します。 質問をすることは会社の許諾を得ているのですが、会社のPCからは制限がかかっており投稿できないのでスマホからです。なるべく伝わりやすいよう努めますが、力不足なときはお許し下さい。 Excelのオートフィルタ機能でもよいとも思ったのですが、処理数が100を越えるため、VBAを検討することにしました。 (1)処理前の並び順と、VBAで処理した後の並び順は異なります。 処理前：コードの昇順 処理後：地域ごとに表を作成し、更に広域ごとに表を掲載するシートを分ける (2)処理前の表は数字しか並んでいません。全てコード化しています。 (3)処理前はいくつもの地域の男女の値が表になっていますが、 ・地域コード ・性別コード ・年代コード ・疾患コード で抽出して、表を作る方法を教えて下さい。1つの地域を抽出する方法で良いのでお願い致します。 後は表を配置する場所と地域コードを指定して、自力で頑張ります。 <元データ> ---|-A-|-B-|-C-|-D-|-E-|-F-|-G-| 列|地域| 性 | 年 | 21 | 22 | 23| 24 | 01| 201 | 1 | 40 | 1 | 2 | 3 | 4 | 02| 201 | 1 | 50 | 2 | 4 | 2 | 1 | 03| 201 | 1 | 55 | 3 | 0 | 0 | 7 | 04| 201 | 1 | 65 | 2 | 1 | 1 | 6 | 05| 201 | 1 | 80 | 1 | 2 | 4 | 1 | 06| 201 | 1 | 95 | 7 | 5 | 4 | 3 | 07| 201 | 2 | 45 | 0 | 3 | 3 | 0 | 08| 201 | 2 | 60 | 4 | 2 | 2 | 6 | 09| 201 | 2 | 70 | 1 | 2 | 3 | 4 | 10| 201 | 2 | 75 | 3 | 6 | 0 | 3 | 11| 201 | 2 | 85 | 5 | 2 | 4 | 2 | 12| 201 | 2 |100| 2 | 2 | 1 | 0 | 13| 202 | 1 | 40 | 1 | 2 | 3 | 4 | 14| 202 | 1 | 45 | 3 | 5 | 2 | 7 | 15| 202 | 1 | 55 | 1 | 2 | 3 | 2 | …続く ・A列は地域コードです。 ・B列は性別コードです。男性が「1」女性が「2」です。 ・C列は年代コードです。 40/45/50/55/60/65/70/75/80/85/90/95/100 という形に40から100まで5歳刻みです。 ・D列～G列は疾病コードです。 <希望> ・元データの年代は値がないと表示がありません。ですが、出力される表には全ての年代を表示させるのが希望です。 <処理後の表> VBA実行後は、以下のような表が1つ作成できることが希望です。教えていただいたコードを元に、配置場所を変更できるようになっていると大変ありがたいです。 01| 201 |----| 21 | 22 | 23 | 24 |合計| 02|男性 | 40 | 1 | 2 | 3 | 4 | 10 | 03|男性 | 45 |-----|-----|-----|----| 0 | 04|男性 | 50 | 2 | 4 | 2 | 1 | 9 | 05|男性 | 55 | 3 | 0 | 0 | 7 | 10 | 06|男性 | 60 |-----|-----|-----|----| 0 | 07|男性 | 65 | 2 | 1 | 1 | 6 | 10 | 08|男性 | 70 |-----|-----|-----|----| 0 | 09|男性 | 75 |-----|-----|-----|----| 0 | 10|男性 | 80 | 1 | 2 | 4 | 1 | 8 | 11|男性 | 85 |-----|-----|-----|----| 0 | 12|男性 | 90 |-----|-----|-----|----| 0 | 13|男性 | 95 | 7 | 5 | 4 | 3 | 19 | 14|男性 |100|-----|-----|-----|----| 0 | 15|男性 |合計| 16 | 14 | 14 | 22| 66 | 16|女性 | 40 |-----|-----|-----|----| 0 | 17|女性 | 45 | 0 | 3 | 3 | 0 | 6 | 18|女性 | 50 |-----|-----|-----|-----| 0 | 19|女性 | 55 |-----|-----|-----|-----| 0 | 20|女性 | 60 | 4 | 2 | 2 | 6 | 14 | 21|女性 | 65 |-----|-----|-----|-----| 0 | 22|女性 | 70 | 1 | 2 | 3 | 4 | 10 | 23|女性 | 75 | 3 | 6 | 0 | 3 | 12 | 24|女性 | 80 |-----|-----|-----|-----| 0 | 25|女性 | 85 | 5 | 2 | 4 | 2 | 13 | 26|女性 | 90 |-----|-----|-----|-----| 0 | 27|女性 | 95 |-----|-----|-----|-----| 0 | 28|女性 |100| 2 | 2 | 1 | 0 | 5 | 29|女性 |合計| 15 | 17 | 13 | 15 | 60 | こんな表にしたいです。 縦横のそれぞれの合計が出せると素敵です。 お知恵を拝借したく、何卒、よろしくお願い致します。
はじめまして。 VB2000、Office2000の環境です。 (1)複数のクエリの内容を、フォームにあるボタンを押下すると、テンプレートのエクセルを 　　別名保存してそのエクセルに出力する (2)同一エクセル内に用意してある計算式(出力したデータを計算)が設定されているシートに 　　結果を表示 ※クエリ結果は日々変わります。 ※計算式の設定してあるシートはテンプレートに用意したいと思っています。 上記をボタンを押下すると自動的に(1)、(2)が実行され、デスクトップにエクセルが出力される といった機能を作っています。今現在はクエリの内容をエクセルに手動で貼り付けています。 出力は問題なくできたのですが、その後の計算処理の実装方法が分かりません。 出力は DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, "クエリ(1)", DeskTopPath() & Format(Date, "yyyymmdd") & "_シート.xls", True で行っています。 クエリは(1)～(14)あり、別シートにそれぞれ出力しています。(計14シート) 該当するシートがないと、計算式のあるシートでエラーが出てしまいますし、 頭が痛いです。 このような要件を解決する手段は何かありますでしょうか? 当方勉強を始めたばかりで行き詰っております。 どうぞよろしくお願いいたします。
VB.net2008で開発しています。 DateTimePickerを画面に貼り付けて使用しているのですがイベントにダブルクリックがありません。 画面に配置したコントロールにイベントを追加することってできますか？ ご教授のほどよろしくお願い致します。
VBAでACCESSのテーブルを順番に読んでいきたいのですが、 読み込みの順番が、実際に入っているデータと異なっていてばらばらです。 先頭から順番に読んでいきたいのですが、どうしたらよいのでしょうか。 Public Function DateCheck() On Error GoTo ErrExit Dim db As Database Dim rs As Recordset Set db = CurrentDb() With Application.CurrentDb Set rs = .OpenRecordset("テーブル名", dbOpenSnapshot) rs.MoveFirst Debug.Print rs!STAFFCD Do Until rs.EOF Debug.Print rs!STAFFCD rs.MoveNext Loop rs.Close db.Close End With Exit Function ErrExit:
VB or C#についてお教え下さい。環境はVS2010です。 フォーム(Form1)にテキストボックス(txtBOX)があります。 このFormのtxtBOXに対して文字列を入力するには、 this.txtBOX.text = "こんにちは"; または Me.txtBOX.text = "こんにちは"; というように、やるのは理解できます。 Classを追加して、このクラス(CLASS1)からForm1のテキストボックスに文字列を入力したいと思います。 そこで、 Form1 f1 = new Form1(); f1.txtBOX.text = "こんにちは"; とやりたかったのですが、そもそもインテリセンスが効きません。さらに、ビルドすると、 「Form1.txtBOXはアクセスできない保護レベルになっています。」と表示がされます・・・ いったい何が悪く、どこを直せば解決するのでしょうか？
if(a <>"A" And b<> "A" ) Then 処理 End if というプログラムがありました。 <>の部分がよくわからないです。 これをJavaに変換するとすれば、どの様なプログラムになるのでしょうか？ 教えていただけるとありがたいです。
言語はVB2010です。 CheckBox1にチェックを入れてButton1をクリックするとTextBox1とTextBox2に入力した文字を次回起動時から記憶する。 これをやりたいです。教えて下さい。
エクセルvbaなのですが、 adoのWHERE句は、テーブルじゃないとダメなのでしょうか？ と言うのも、 rs.Open "Q_カテゴリ WHERE 分類 like '%A%'" だと、エラーにならないのですが、抽出もされずに全レコードが対象になってしまいます。 しかし、 rs.Open "T_カテゴリ WHERE 分類 like '%A%'" にすれば、抽出された後のレコード数が取得されます。 エラーにならない事から、オブジェクトは存在してる事は確かなはずですが なぜかフィルタできません。 なぜでしょうか？
UserForm1を配置しその中にOptionButtonを２つ配置しまして、 OptionButton1をクリックした時は、a1セルに東京と表示した後カーソルをb1セルに移動させて、 そのB1セルに数字をキー入力する。 OptionButton2をクリックした時は、a1セルに大阪と表示した後カーソルをb1セルに移動させて、 そのB1セルに数字をキー入力するマクロをつくりました。 '---------------------------- Private Sub Workbook_Open() UserForm1.Show End Sub Private Sub OptionButton1_Click() Range("a1").Value = "東京" Range("b1").Activate End Sub Private Sub OptionButton2_Click() Range("a1").Value = "大阪" Range("b1").Activate End Sub '---------------------------- 動かしてみて、下記２点を改良したいのですが １、OptionButtonをクリック後、数字キーを押してもb1セルに表示されません、b1セルをマウスでクリック後キー入力すると入力した数字が表示されます。マウスでクリックしなくてもキー入力出来る　　　ようにしたい ２．ファイルを保存終了後、再度開いたときオプションボタンの丸印が２つ共○になっているが、前回終了時に選んだオプションボタンに●がついた状態で表示させたい 以上　よろしくお願いします
Excel２００７（VBA)を使用しています。 1 内容の書き換えや行の高さの変更を禁止して、フィルターとソートだけを許可することはできるでしょうか？ ２ フィールド内に画像（Shape)が置かれている場合に、フィルターでその行が畳まれたときに画像も非表示にすることはできるでしょうか？ 以上、よろしくお願いします。
VB2008のイベンド中止処理についてお教え頂けませんでしょうか。 Formにボタンが１つあり、クリックするとCSVファイルが出力される処理をしたいです。 やりたい処理： 1. 「CSVファイル出力しますか？」というメッセージを出す。YESなら処理続行。Noなら処理中止。 2. CSVファイル出力処理。 3. 「CSVファイルを出力しました。」 (プログラム自体を終了したいわけではありません） VBAだと下記のようなコードを書きたいです。 Sub テスト() Dim ans As Integer ans = MsgBox("CSVファイル出力しますか？", vbYesNo, "テスト") If ans = vbNo Then end end if 'CSV出力処理～～～ end sub VBにendというステートメントがあれば、良いのですが無さそうです・・・ 何か上手な処理はあるでしょうか？VBAのコードになってしまいますが、下記のような処理方法しかないでしょうか？ '''''''''''''''''1 Sub テスト() Dim ans As Integer ans = MsgBox("CSVファイル出力しますか？", vbYesNo, "テスト") If ans = vbNo Then end else 'CSV出力処理～～～ end if end sub ''''''''''''''''2 Sub テスト() Dim ans As Integer ans = MsgBox("CSVファイル出力しますか？", vbYesNo, "テスト") If ans = vbNo Then goto here end if 'CSV出力処理～～～ here: end sub
下記のような患者No.001～100の体温をまとめる配列の宣言方法について教えて下さい。 （環境：Excel2003 Windows7 ultimate 64bit) 患者No.001の、 1回目の体温36.5℃、 2回目の体温36.2℃、 3回目の体温36.8℃、 ・ ・ 300回目の体温36.1℃ （回数の上限値は不定） 同様に、 患者No.002の、 1回目の体温36.2℃、 2回目の体温36.7℃、 3回目の体温37.9℃、 ・ ・ 300回目の体温35.9℃ これを延々と繰り返して、、、 患者No.003～ 患者No.004～ ・ ・ 患者No.100～ （患者数は100で定数） こんな感じです。 ----- こうしたデータをまとめるには、 どういった配列を宣言すれば良いでしょうか？ 出来る限りスマートな方法で教えて下さい。 配列Ａ（患者No、配列Ｂ（ｎ回目、体温））　のように、 配列の中に配列を入れたい（多段階配列、多次元配列）と考えています。 よく分からないポイントは以下の通りです ・配列宣言時の型の書き方 （患者Noは1～100の整数、回数も整数、体温は非整数。 というより、配列の中に配列を入れるので、型は配列型？！） ・予め配列の要素数が決まっていない。（要素数不定） お詳しい方、宜しくお願い致します。
VBA　Excel２００７を使用しています。 画像をインポートするために、例えば、myPicuter = ActiveSheet.Shapes.AddPicture(filename, true, false, 0, 0, 100,100)を実行した際に、読み込みに失敗するとmyPictureとして添付のような表示が現れますが、このmyPicuterが画像でないことを判定する方法は有るでしょうか。 また、もし直接判定ができなければ、中の文字列を読み出して、その内容から判定する方法はあるでしょうか。
質問させていただきます。 現在、ウィンドウを任意のサイズに固定したいと考えているのですが、方法が分かりません。 また、WorkBookのサイズでは無く　Excel ファイルのサイズ変更です。 また、コードを用いて行う場合は要約程度でも構いませんので、どの部分がどの様な挙動をとるのかも 記載して頂きたいです。 よろしくお願いします。
vb.netで、form1のdatagridviewを、form2のボタンをクリックした際に、datagridviewのrowを削除したいのですが、newでform1を参照して、datagridviewのrowを削除しようとしたのですが、form1のdatagridviewの情報をform2で取得できなくて、実行時エラーになってしまい困っています。 form1のdatagridviewのデータは、csvファイルを接続して、loadイベントで表示させるようにしています。 わかるかたいらっしゃいましたら、教えていただけると助かります。 宜しくお願いいたします。
VB.net 2010でプログラムを作成しており、そのパラメーター入力にIniFileを使用しました。 その作成の途中で、VB.netではIniFileではなくXMLが推奨されている様な事を読みました。 プログラムが完成したので、XMLもいじってみようと思い、簡単なパラメーターの読み書きは出来る様に成りましたが、その過程で、DOM が簡単だとかX Documentが良いとか色々書かれて居るのをみました。 私が使ったのはXmlSerializer/DeSeralizerですが、XMLを作成する方法で一番簡単なのは何でしょうか。 IniFileと同じ様な機能を実現させようとして居るのですが、色々試行錯誤して好みを見つける時間が無いのでどれか一つで作業を進めて行こうと思っています。 各方式で何か特徴はあるのでしょうか。 目的としては先に書いた様にIniFileの代替です。 特にSectionの削除、Keyの追加等は必須と成ります。 Serializer/DeserializerでSectiionやのKeyの追加、削除はどの様にするのかネットを検索して居る内に色々方法があるらしい事が分ったのですが、全ての方法を試して居る時間がありません。 IniFileの代替として一番使い易い方法は何でしょうか。 お分かりに成る方が居られましたら宜しくご回答下さい。 又、IniFileの代替方法のサイトがありましたらご紹介下さい。 宜しくお願い致します。
VBAでメッセージボックスの表示方法で教えてください。 あるセル、例えばA1に”111”と入力されたらメッセージボックスで ”○○”と出したい場合はどうしたらいいですか。 あと、A1からA3に”111”と入力された場合の複数セルの場合も教えてください。
VBAを学習しようと考えている者です。ただし、プログラミング言語に関しては全くの素人なのでご容赦下さい。 質問の核となるのは、 「vbaを学習する際に、C言語を学習して知識を得る事は、その後のvbaの学習・習得に役に立つかどうか？」です。 なぜ、そのような質問をするかと言いますと、とある大学でvbaの習得を学生にお教えされている方の論文を拝見した際に、 「VBAというプログラミング言語は、C言語を最低でも１年間学習した人間でなければ、文法や規則性を記憶したり、定着したりする事が難しい。」 との情報が文章として記載されていたため、突然私のように、言語の学習経験のないものが手を出すと挫折をしたり、理解のスピードが追いつかないのではないかと考えたからです。 様々な質問箱に、VBAと他のプログラミング言語との難易度等の比較は記載されていますが、情報が氾濫していて、どの言語から手をつけてよいか混乱しています。 将来は、VBAを習得できたら少なくとも損をすることは無いだろうと思っています。 どうかどなたか私に知恵や指針を与えて下されば嬉しく思います。 どうかよろしくお願いいたします。m(__)m
エクセルで別ブックで作成してあるカレンダーから、稼働日を判断して指定した期間の日付をオートフィルターを使って抽出したいのですが、うまくいきません。 このようなコードを記述しましたが、別ブックでオートフィルターを使用する事はできるのでしょうか？ Dim book1 As Workbook '変数book1をワークブック型で宣言 Dim book2 As Workbook '変数book2をワークブック型で宣言 Dim today As Date Set book1 = Application.ActiveWorkbook 'アクティブになっているブックをbook1へセット Application.ScreenUpdating = False '画面の更新を止める '↓アドレスのブックを開く事までbook2にセット（ReadOnly:=Trueで読み込み専用） Set book2 = Application.Workbooks.Open("\\sv\C1\\稼働日カレンダー.xls", ReadOnly:=True) today = Date maxdate = cdate("2014/3/3") ' book2.Worksheets("DATA").Cells.Copy Destination:=book1.Worksheets("Sheet1").Range("A1") '----オートフィルタでデータを抽出 With book2.Worksheets("Sheet1").Range("A1").CurrentRegion .AutoFilter .AutoFilter Field:=1, Criteria1:=">=" & today, Operator:=xlAnd, Criteria2:="<=" & maxdate ' .AutoFilter Field:=2, Criteria1:="=" & 1 '----抽出データをコピー&貼り付け .Copy ActiveSheet.Range("A" & maxrow) .AutoFilter End With ' Range("A1").Select Application.ScreenUpdating = True Set book1 = Nothing '変数book1を開放 book2.Close SaveChanges:=False 'book2を閉じる（SaveChanges:=Falseで保存せずに終了） Application.ScreenUpdating = True '画面の更新を再開する Set book2 = Nothing '変数book2を開放
VB2010でマクロのように指定した画像を右クリックするようなことはできるのでしょうか。 できるのであれば教えて下さい
ExcelVBAのExit Forをjavaで表すとすると、どの様になるのでしょうか？ 教えていただけるとありがたいです！
正規表現のパターンの " [^<]*?>" これはどういう意味なのでしょうか？
こんにちは。プログラム終了方法についてお教え下さい。 下記のような処理を書いています。 if(A!=B)の場合、処理を抜けてプログラムを終了させたいと思っています。 下記のコードだとテキストボックスにエラー表示をさせた後に、プログラムを終了させたいです。 ただ、現状だと～～～処理3、処理4が実行されてしまいます。 どのようにすれば、if(A!=B)でテキストボックスにエラーを出力した後にプログラムを終了できるでしょうか？ gotoを使用し、真ん中の処理を飛ばす方法しか有りませんでしょうか？ よろしくお願いします。 try{ ～～～処理1 ～～～処理2 if(A!=B) { textbox.text = "エラー"; //goto endfinish; } ～～～処理3 ～～～処理4 } catch { textbox.text = "エラー"; } //endfinish:;
ある一つのセルに以下のような条件式が組み込まれていました。VBAに関してあまり良くわからないのですが、これをjavaに書き換えるとすれば、どの様な形になるのでしょうか？ 教えていただけるとありがたいです！ =IF(AW6<=チーム!H51,IF(AW6>=チーム!G51,0,AW6-チーム!G51),AW6-チーム!H51)
オシロスコープからの画像データ（40kバイト程度のtifファイル）をＰＣのCOMポートから受信し 保存するプログラムを作成しているのですが、受信データを正しくＰＣ上に保存できません。 具体的には下記のコードでtifファイルは作成されますが、容量が数kバイトで明らかに不足 しています。 MsgBoxを有効にして受信バッファサイズや書込み長さを確認しましたが、「OK」ボタンを押す たびに下記の表示になります。COMポートのバッファサイズが４０９６バイトなので「dat.Length」 をすべて足し合わせると本来の受信データサイズになると思うのですが、PC上に作成された ファイル容量から「dat」が常に上書きされているような気がします。 正しく保存するにはどのような修正が必要でしょうか？ 【MsgBoxを有効にしたときの表示値（OKを押すたびに数値が変わる）】 「dat.Length」 １８３ ４０７５ ４０７２ ４０９２ ４０８８ ４０８４ ４０８５ ４０９２ ４０５９ ４０７８ ３９１０ ０ ０ ・ ・ ・ 「ByteToRead」 ４０６０ １５０８ ３２４ ９０８ ２３３４ １７８５ ７０ ２２７ ４００ ０ ０ ・ ・ ・ 【作成したコード】 Private Sub SerialPort1_DataReceived(ByVal sender As System.Object, ByVal e As_ System.IO.Ports.SerialDataReceivedEventArgs) Handles SerialPort1.DataReceived ' シリアルポートからデータ受信 Dim dat As Byte() = New Byte(SerialPort1.BytesToRead - 1) {} SerialPort1.Read(dat, 0, dat.GetLength(0)) 'MessageBox.Show(dat.Length) 'MessageBox.Show(SerialPort1.BytesToRead) File.WriteAllBytes("C:\test1.tif", dat) SerialPort1.DiscardInBuffer() End Sub 【環境】 OS：Win7 VB：2010 ポート設定：SerialPortクラス標準からポート番号以外は変更なし
VBAで比較ツールを作っています。２つのワークシートを比較し、同じセルの位置にある値を比較し、値が異なっていれば色を変えるというものです。行をキー（1行、2行、3行・・・）として2つのワークシートですべてのキー行のセルの値が一致する列同士を比較する方法があるのですが、キーを1個でも100個でも指定した場合のプログラム構造を知りたいのです。 お力をお貸しください。 Sub DF() Dim Before As Range Dim After As Range Before = Worksheets("Sheet1").UsedRange.Value After = Worksheets("Sheet2").UsedRange.Value キーとなる行数をカウント 　　カウントした行を最大値を変数に設定 　　・・・・ 　　・・・・ 　　・・・・ End Sub
VBを用いて，CSVファイルから必要な数値のみを読み込みたいのですが，うまくいきません． 一行目を飛ばし，二行目以降から読み込んでいきたいのですが，可能でしょうか？ よろしくお願いします．
ＶＢＡでＩＥを動かそうとしている初心者です。 For Each a In ie.Document.getElementByTagName("A") で実行時エラー'438':オブジェクトは、このプロパティまたはメソッドをサポートしていません となるのですがなぜでしょうか Dim ie As Object Set ie = CreateObject("InternetExplorer.Application") ie.Visible = True '画面へ移動する ie.Navigate "http://www.forest.impress.co.jp/" waitNavigation ie Dim a As Object Dim urls As New Collection For Each a In ie.Document.getElementByTagName("A") urls.Add a.href Next
　40ページほどのpng画像が張り付けられたpowerpoint file Aから画像だけを選択して 　powerpoint file Bに一括で貼り付けたいのですが、何か方法ないでしょうか？ 　　1ページの画像は1ページ目に2ページ目の画像は2ページ目にコピーしたいです。 powerpoint Bには、既にタイトル、テキスト、png画像が存在するのですが、このpng画像だけを置き換えたいと考えています。 　どなたかいい方法をご存じの方、お知恵を貸してください。 　自分で色々とマクロで試行錯誤してみたのですが、 　うまくいきません。 　まず、png画像のみを消去しようとすると、タイトルもテキストも消えます。 　そして、貼り付けたくても一括で画像を選択することができません。 　よろしくお願い致します。 　powerpointは2010です。 　 　
お世話になっています。 ExcelVBAでマルチページを利用して、ユーザーフォームを作成中です。 ユーザーフォームはExcelの作業画面が非表示でマルチページのみ表示されるようにしています。 作成後は管理を別の担当者に任せるのですが、それとともに一般ユーザーにも配布して利用してもらう予定です。 管理者によりコードのメンテナンスは行われますが、一般ユーザーにはコードを閲覧及び編集できなくしたいです。 今は「×ボタン無効」「終了ボタンくっりっくの場合のみ終了」「コードは[Ctrl]+[Pause]のショートカットキー押下で見られる」という状況です。 パスワードを設定し、限られた人のみが閲覧及び編集できるようにしたいのですがどうしたらいいでしょうか？ また、ショートカットキーでVBA画面を表示させるとエラーになるのですが(マクロを停止させてるからでしょうか？)、これを回避する方法はありますか？ お手数ですがご教授いただけますと幸いです。 よろしくお願い致します。
vbからIE10を操作しています。 テキストボックスにパスワードを入力しログインボタンを押しますが その時テキストボックスにカーソルが無いとログインボタンが押せません。（グレーアウト） テキストボックスをアクティブにする方法は無いでしょうか。 objIE.Document.getElementById("Password").Value = "123456"
VBA初心者です。MsBox関数の第２引数のうち、 vbDefaultButton4 の使い道について教えてください。 vbYesNoCancelなどで、３つのボタンを表示することができるので、 vbDefaultButton3まではその使い道がわかるのですが、 第４のボタンを指定するようなプロパティがあるのでしょうか？
お世話になります。 現在、Excel2010のVBAを使って、ある項目内に改行CRLFを含むCSVを Excelシートにコピーして加工するマクロを作成しようとしています。 CSV1レコードの例） "001","b","c","d[CR][LF] e[CR][LF] f[CR][LF] g","h" 4項目名に改行が含まれますが、1レコードあたり5項目のCSVです。 CSVをExcelに取り込むには様々な方法があると思いますが、改行を含んでいても正しく取り込める方法として、 現在は下記のようにOpenText関数を使用して読み込みを行い、シートへ貼り付けています。 Workbooks.OpenText fileName:=取り込みたいファイルの名称, StartRow:=1, _ DataType:=xlDelimited, TextQualifier:=xlTextQualifierDoubleQuote, _ ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=False, _ Comma:=True, Space:=False, Other:=False, _ FieldInfo:=Array(Array(1, xlTextFormat), Array(2, xlTextFormat), _ ・・・・・・・・・・・・・・ このとき、CSVの取込自体はできるのですが、FieldInfoで指定した書式指定 （ここでは文字列をあらわすxlTextFormat）が無視されてしまい、 Excelに取り込んだときには文字列でなく標準の書式になっています。 つまり上記の例では1項目目の"001"が桁落ちして1となってしまいます。 ネットで調べたところ、OpenText関数では拡張子csvのファイルを読み込む際には FieldInfo指定が無効となるとありました。そこでファイルの拡張子を.txtに変えてみたところ、 今度は項目内改行が認識されず、行区切りの改行とみなされてしまって、項目取り込みがずれてしまいます。 なんとか、桁落ちせず、なおかつ項目内改行も正しく認識できるような方法はないでしょうか。 OpenText関数以外の方法でもかまいませんので、有識者の方々にご教授いただければ、 と思っております。 よろしくお願いします。
お世話になります。 Ａ列に番号、Ｂ列に名字、Ｃ列に名前が入力されています（500近いデータがあり、データ量は増減あり） 例 Ａ列　　　　Ｂ列　　　Ｃ列 　1　　　　　阿藤　　　海 2　　　　　加藤　　　 山 3 木村　　　一　 4　　　　　齋藤　　　十三 5　　　　　佐藤　　　まさる ・ ・ ・ 最終行　　渡辺　　　慎吾 ユーザーフォームを使い、名字と名前（2つのテキストボックスに別々に）を入力すると、リストからその人が何番なのか（Ａ列の番号）を教えてくれるようにしたいと思っています。　 そういったことは可能でしょうか？ よろしくお願いいたします。
[環境] Windows 7 お世話になります。 完全にお遊び程度の内容になりますが、 VBSでドラッグ＆ドロップしたファイルのファイル名を取得するプログラムを 作成しているのですが、 検索してもそれらしき方法が見つからずヤキモキしています。 まだ起動していないVBSファイルに対してのドラッグ＆ドロップする方法であれば 結構HITするのですが、そうではなく私がやろうとしているのは、 既に起動しているVBSのアプリにドラッグ＆ドロップをしたファイル名を 取得したいのです。（ちなみに取得したいのはフルパス） 取得したファイル名はInputBoxか何かに表示する程度でいいのですが、 案外むずかしかったりするのでしょうか？ ご回答よろしくお願いします。
http://oshiete.goo.ne.jp/qa/8420174.html ↑ VB.NETで作成したアプリでこちらの質問で無事解決し、違う環境で試したところORA-12170の タイムアウトエラーが発生しました。 SQL*Plusからの接続は問題ありません。 わからないのはWEBアプリの方は接続できるのに、コンソールアプリの方がこのエラーになってしまいます。 どちらのアプリの接続文字列も同じData Sourceを指定してます。 「db1」がTNSNAMES.ORAに記述している識別子になります。 WEBアプリ側 （Web.configに記述） <connectionStrings> <add name="oracle" connectionString="Provider=OraOLEDB.Oracle;Data Source=db1;Password=pass1;User ID=user1" providerName="System.Data.OleDb" /> </connectionStrings> コンソールアプリ側 （INIファイルに記述） ConnectionString=Provider=OraOLEDB.Oracle;Data Source=db1;Password=pass1;User ID=user1 一般的にはDBサーバにネットワークがつながってないなど単純な理由のようですが、 WEBアプリは接続できるので、そういうことはあり得ないと思います。 コンソールアプリの問題と思うのですが、どんな原因が考えられるでしょうか？
・計算機アプリケーションです ・テキストボックスは数値と「-（マイナス）」「.（小数点）」以外は入力できないように制御しています。 ・テキストボックス１と２に入力したものをボタン１を押して計算し、ラベル２に表示します。 テキストボックスに数値以外が、もしくは「3-2」「.32」「32.」等の不正な値が入った場合に、メッセージボックスを出して入力の誤りを指摘するプログラムを書きたいです。 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click ・・・・・・・・・・・・・・・・・・・・・・・・・・・・ If Not IsNumeric(TextBox1.Text) Then MsgBox("不正な値です", vbExclamation, "ERROR") Label2.Text = "ERROR" ElseIf Not IsNumeric(TextBox2.Text) Then MsgBox("不正な値です", vbExclamation, "ERROR") Label2.Text = "ERROR" End If End Sub 色々と調べてみて、IsNumericが使えそうだったのでこのプログラムを書いたのですが、 これだと「-」や「.」だけを書いた場合にはちゃんとエラーメッセージが出ますが、 「32-」「.32」「32.」等は数字だけを認識して、計算結果を表示してしまいます。 何が足りないのか、もしくは使用している関数を変えたほうがいいのか、アドバイスいただければ幸いです。 以上、ご回答宜しくお願い致します。
ExcelVBAのユーザーフォームについて教えて下さい。 マルチページで作成し、アイコンをクリックしてファイルを開くと、マルチページのみが表示される仕様にしました。 <ThisWorkbook> Private Sub Workbook_Open() Application.Visible = False UserForm.MultiPage1.Value = 0 UserForm.Show End Sub そして、マルチページ内にボタンを配置して、そのボタンをクリックすると、マルチページが終了するとともに、マルチページが埋め込まれているExcelファイルを(他のExcelファイルが動作中はそれらは何もしないでそのまま)閉じたいのです。 <UserForm> Private Sub CommandButton_Click () Dim msg As String, title As String msg = "プログラムを終了します。よろしいですか？" title = "終了確認" Dim res As Integer res = MsgBox(msg, vbYesNo + vbInformation, title) If res = vbYes Then Unload Me End Sub と書いてみました。 マルチページの画面はExcelの作業画面なしに開きます。ボタンをクリックするとマルチページが終了します。 ですが、「マルチページが閉じてExcelの作業画面も表示されず、一見終了したように見えるが、タスクマネージャーのプロセスではEXCEL.EXEが動作している」ことがあったり(他にExcelファイルを開いていないときも同様です)、「マルチページ終了後にExcelの何もない作業画面が表示」されます。そのファイルを閉じてもよいのですが、せっかくマルチページで、単独のアプリのようにしているので、マルチページを閉じて、Excelを閉じて…という、二度手間的なことはしたくないと思っています。 マルチページに配置したボタンをクリックしただけで、マルチページを終了させ、マルチページが埋め込まれているExcelのみも正常に終了させることはできますでしょうか？ ご教授頂きたくお願い致します。 ちなみに「×」ボタンでの終了はNGとしています。
ExcelVBAで教えて下さい。 A | B | C | D | E |F| 地域コード| 性別コード|年代|野球|サッカー|テニス| 201| 1 | 40 | 5 | - | 1| 201| 2 | 55 | 6 | 1 | 3| というような表が1万行近くあります。 これを「地域別の表」にして、なおかつ「男女別」「スポーツ別」にして、人数を表にしたいと思っています。 表のイメージはこんな感じです。 ーー| 201 | 野球|サッカー|テニス| 男性| 40 | 5 | - | 1 | … 女性| 55 | 6 | 1 | 3 | 年代は40、45と5才刻みで100歳までで、男女は1と2のコードで表します。 クロスのところにはいっているのは人数です。 Sheet1が元データなので、Sheet2に表を作りたいです。表はどうにか作れるので、 ・地域コード ・性別コード ・スポーツ に、一致した場合に別シートにコピーできるコードを教えていただけるとありがたいです。 Sheet1の元データの年代は、地域によっては、該当なしだと無い年代もあります。 今回は投稿のためわかりやすければ…と思い、空白セルにハイフンを入れましたが実際は入っていません。 ややこしくて申し訳ありませんが助けていただきたく、お願い致します。
この度はお世話になります。 現在、バイナリ―ファイル(xxxx.bin)をVBAで読み込み、バイナリ―データを文字列化して、エクセルで解析できるようなシートを作っています。 バイナリ―ファイルの中身が31 39 32 31 ・・・・・となっていたら、31393231・・・と文字列化にしたいです。 そこで、自分でプログラムを考えてみたのですが、バイナリ―が 01 などの場合、など“１”として読み込まれて、“0”が入らず、ずれてしまいます。 Sub 電文解析プログラム() Dim Deciphering_file As Variant '読み込みファイル Dim buf As Byte '1バイト格納 Dim fLen As Long 'ファイルサイズ Dim TEMP(1) As String ' Dim S_JIS As String '文字コード（2バイト） Dim str As String '文字列データ Dim i As Long Deciphering_file = Application.GetOpenFilename("BINファイル(*.bin),*.bin") fLen = FileLen(Deciphering_file) Open Deciphering_file For Binary As #1 For i = 1 To fLen Get #1, i, buf S_JIS = Hex(buf) If buf = 0 Then S_JIS = "00" End If TEMP(0) = Mid(S_JIS, 1, 1) TEMP(1) = Mid(S_JIS, 2, 1) str = myChr & TEMP(0) & TEMP(1) Next i End Sub ホントは3行くらいで済みそうな気がするんですが、あまりプログラミングをやったことありません。なので、すみませんがご教授お願いいたします。
はじめまして。 Outlookにて仕訳ルールの処理にて 特定のアドレスの方からのメールを仕訳け、さらに 添付ファイルを保存する。という処理を行っています。 添付ファイルの保存自体はネットでのVBAを参考に 作成することができました。 ただ、OutLook起動時に複数件、同じメールがある場合、 一番古いメールの添付ファイルのみが保存されてしまっているようです。 解決方法がわかる方、教えてください。 やりたいことは以下のとおりです。 宜しくお願い致します。 ■実現したいこと ・件名Aのメールの場合：添付ファイルをフォルダーAへ保存 ・件名Bのメールの場合：添付ファイルをフォルダーBへ保存 ・件名Cのメールの場合：添付ファイルをフォルダーCへ保存 ・件名Dのメールの場合：添付ファイルをフォルダーDへ保存 ■OutLookのVBA Public Sub SaveAttachments(objMsg As MailItem) Const SAVE_Dir = "C:\" Dim objFSO As Object Dim objAttach As Attachment Dim strFileName As String Dim c As Integer: c = 1 Dim flg As Integer: flg = 1 Dim SAVE_PATH As String Set objFSO = CreateObject("Scripting.FileSystemObject") ' 件名により、保存先のパスを変更します。 SAVE_PATH = SAVE_Dir If VBA.Right(SAVE_PATH, 1) <> "\" Then SAVE_PATH = SAVE_PATH & "\" Select Case objMsg.Subject Case "件名A" SAVE_PATH = SAVE_PATH & "フォルダーA" Case "件名B" SAVE_PATH = SAVE_PATH & "フォルダーB" Case "件名C" SAVE_PATH = SAVE_PATH & "フォルダーC" Case "件名D" SAVE_PATH = SAVE_PATH & "フォルダーD" Case Else flg = 0 End Select If VBA.Right(SAVE_PATH, 1) <> "\" Then SAVE_PATH = SAVE_PATH & "\" ' 指定のフォルダに添付ファイルを格納 If flg = 1 Then For Each objAttach In objMsg.Attachments With objAttach strFileName = SAVE_PATH & objAttach.FileName .SaveAsFile strFileName End With Next End If End Sub
VBAであるテンプレートのファイルを開いて、ファイル名をB3セルに入力された名前で保存したいのです。まず、下にマクロを示します。 Sub 新規_試作マスタ作成() ChDir "C:\Users\H1250-201\Desktop" Workbooks.Open Filename:="C:\Users\H1250-201\Desktop\試作マスター.xlsm" ChDir "D:\A\" & Format(Date, "yyyy年") & "\" & Format(Date, "yyyy年m月") & "" ActiveWorkbook.SaveAs Filename:="D:\A\" & Format(Date, "yyyy年") & "\" & Format(Date, "yyyy年m月") & "\" & Format(Date, "yyyymmdd") & "　" & ThisWorkbook.Sheet1.Range("B3").Value & " 試作.xlsm", FileFormat _ :=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False End Sub Dドライブの中のAというフォルダがあり、その中に、2014年→2014年1月の順にフォルダがあります。ただし、Aの中には2013年～2020年、2014年の中には、2014年1月～2014年12月のフォルダがあるのです。そこで、今日の日付を参照してそれに応じたフォルダ分けを行い、ファイルの頭に「日付」、その後に「B3セルに入力された名前」、「試作」の順に 「日付」　「B3セルに入力された名前」　「試作」という名前で保存されるマクロを作成したいのです。 上のマクロでは、ThisWorkbook.Sheet1.Range("B3").Valueの部分がおかしくてうまく行きません。個々の部分をただ文字列として"○○"とするとうまくいきました。 つまり、マクロのある自身のファイルのセルを参照したいのです。差し支えなければご回答願います。
VB2010を使っています。 今WebBrowserにパケットを送信するプログラムを作りたいと思っています。（PacketEditor） button1を押すと指定したパケットが１回送信されるようにしたいです。 どう組めばできますか？分かる方教えて下さい
タイトルが文字数の関係でおかしいのですが エクセルＶＢＡで　ＩＥのＨＰに　値を代入して、送信するのですが 同じページで　oObjDoc.getElementsByName（）やoObjDoc.getElementsByＩＤ（）などで、値を代入したいのですが、この構文の２回目の所で　エラ検出の　debugに　「書き込めない」　などのエラーが出ます。（当然、実際もスルーされます） 初期化がまずいのか　判断しかねています。 一般的なＩＤ、ＰＳＷ代入ページから来ました Sleep 500 Set oObjDoc = Nothing Set pitem = Nothing Set oObjDoc = objIE.document Set pitem = oObjDoc.getElementById("order_type") value = "通常注文" 実際は3パターン Dim order As Object For Each order In pitem If InStr(1, order.innerText, value) > 0 Then pitem.value = order.value Exit For End If Next pitem.Click Set pitem = Nothing Sleep 500 id = "変更" '上記の入力を確定させるためだと思う　変更 クリック Set pitem = oObjDoc.getElementById(id) For Each pitem In objIE.document.getElementsByTagName("input") If pitem.value = id Then Exit For End If Next pitem.Click 'オーダーの内容 If TradeForm.ordertype_btn1 = True Then value = "3" Else value = "1" End If Set aradio = oObjDoc.getElementsByName("side") Debug.Print aradio.Length For i = 0 To aradio.Length - 1 Debug.Print i Debug.Print aradio(i).Name 2回目で　エラー70　書き込みできません。 Debug.Print aradio(i).value If "side" = aradio(i).Name And　aradio(i).value = value Then aradio(i).Checked = True Exit For End If Next Set pitem = Nothing で、aradio.Length　は　2を返して　 Set aradio = oObjDoc.getElementsByName("side") はＨＰ内容と一致、動作しているようです で、１回まわって　２回目（これが答えなのですが）の　i=1　で　次 aradio(i).Name 　が　取れません。 debug.printは　 2 0 side 3 1 ところが 前の id = "変更" '変更 クリック Set pitem = oObjDoc.getElementById(id) を　全部レムれば　プログラムは　通ります。 debug.print　が　書き込めない　と言うエラーも　今まで始めてみました。 どれかの初期化が　抜けているのでしょうか よろしくどうぞ
マクロのルールについて記載された一文について、次の内容を噛み砕いて教えていただけますか。 さっぱりわかりません。。。 「イベントを利用するマクロはオブジェクトのモジュールに記述する」 ワークシートをアクティブにすると、アクティブになったワークシートでActivateイベントが発生します。このイベントを利用して、ワークシートが切り替わった時自動的に起動するようなマクロは、Worksheetオブジェクトのモジュールに記述しなければなりません。
下記を走らせると、セルが右端まで行ってとまります。 そうなる前に、対象セル範囲が空白になった時点で、動作を止めたいのですが どう記述するのがいいでしょうか？ Dim u As Integer, o As Integer Application.Calculate For u = 2 To 3 For o = 7 To 2000 If Cells(u, o) = "" Then Range("G2").Select Range("G2").End(xlToRight).Select ActiveCell.Resize(6, 5).Select Selection.Cut Range("B2").Select Range("B2").End(xlDown).Select ActiveCell.Offset(1).Select ActiveSheet.Paste End If Next o Next u End Sub
VBAはじめたばかりで、躓きました。 下記を実行すると、”Nextに対するForがありません。”とでます。 なぜこうなるのか教えてください。 　G2～列2000の間が空白になるまで、 　下記の処理を続けるようにしたいと思っています。 　Dim i As Integer For i = 7 To 2000 Do If Cells(2, i) = "" Then Range("G2").End(xlToRight).Select ActiveCell.CurrentRegion.Resize(6, 5).Select Selection.Cut Range("B2").End(xlDown).Select ActiveCell.Offset(1).Select ActiveSheet.Paste Exit Do End If Next i Loop 　よろしくお願いします。
質問させて頂きます。 現在コマンドボタンを作成したいと考えているのですがツールボックスからでは無く、コーディングで作ろうと考えています。 現在は下記のコードでコマンドボタンの作成までは出来たのですが ＋ コマンドボタンの背景色/フォントカラー/フォントサイズの調整も加えたいと思っています。 下記のコードに上記要望を可能にする為にはどのようなコードを記述すれば宜しいでしょうか？ よろしくお願いします。 With　ActiveSheet.Buttons.Add(省略しました) .Name = "" .Caption = "" .OnAction = "" End With
EXCEL（テキスト可）内に書かれた大量のキーワードを 1ワードずつ自動でGoogle検索し、 1ページ目の検索結果のリンクを1つ1つクリックしていき、 検索結果ページ内に、目的の情報があれば取得し、 EXCEL（テキスト可）に出力するといった操作を VBAで自動で行いたいと思っています。 EXCEL2010かEXCEL2000に対応していればOKです。 検索するところまでは分かりましたが、検索結果（1ページ目のみ） のリンクをクリックして、ページ内の目的の情報を取得する といったところをどう記述すればよいかが分かりません。 検索するところまではこことほぼ同じように書きました。 http://vbaie.blog111.fc2.com/?mode=m&no=6 お分かりになる方、アドバイスのほど、よろしくお願いします。
お世話になります。 一昨日からエクセルのVBAをやりはじめたのですが、 表題のエラーが回避できなくて困っております。 下記のコードの Sub 繰越判定(cellno1 As Long, cellno2 As Long, cellno3 As Long, kamoku As String, bunrui As String, karikatakamoku As String, kasikatakamoku As String, tekiyou As String, kurikosi As Long) の行が黄色になり、そこから１７行下の Call 当期(cellno1, cellno2, cellno3, kamoku, bunrui, karikatakamoku, kasikatakamoku, tekiyou, kurikosi) のtekiyouの部分が青く変わります。 お分かりになる方がいらっしゃいましたら お助けください。 以下コードです。 Sub 総勘定元帳() '開始行の設定 Dim cellno1 As Long '総勘定元帳の開始行 Dim cellno2 As Long 'マスタの検索行 Dim cellno3 As Long 'データの検索開始行 Dim kamoku As String 'マスタの科目 Dim bunrui As String 'マスタの（科目の）分類 Dim karikatakamoku As String Dim kasikatakamoku As String Dim tekiyou As String Dim kurikosi As Long cellno1 = 5 kurikosi = 0 kamoku = Sheets("マスタ").Range("B3") bunrui = Sheets("マスタ").Range("C3") Call 繰越判定(cellno1, cellno2, cellno3, kamoku, bunrui, karikatakamoku, kasikatakamoku, tekiyou, kurikosi) End Sub Sub 繰越判定(cellno1 As Long, cellno2 As Long, cellno3 As Long, kamoku As String, bunrui As String, karikatakamoku As String, kasikatakamoku As String, tekiyou As String, kurikosi As Long) cellno2 = 3 'マスタの開始行数セット cellno3 = 5 'データの開始行数セット kamoku = Sheets("マスタ").Range("B" & cellno2) karikatakamoku = Sheets("データ").Range("F" & cellno3) tekiyou = Sheets("データ").Range("G" & cellno3) kasikatakamoku = Sheets("データ").Range("H" & cellno3) 'MsgBox kamoku 'MsgBox karikatakamoku 'MsgBox tekiyou 'MsgBox kasikatakamoku If kurikosi = 0 Then '前期繰越か当期かの判定 Call 繰越(cellno1, cellno2, cellno3, kamoku, bunrui, karikatakamoku, kasikatakamoku, tekiyou, kurikosi) Else Call 当期(cellno1, cellno2, cellno3, kamoku, bunrui, karikatakamoku, kasikatakamoku, tekiyou, kurikosi) End If End Sub Sub 繰越(cellno1 As Long, cellno2 As Long, cellno3 As Long, kamoku As String, bunrui As String, karikatakamoku As String, kasikatakamoku As String, tekiyou As String, kurikosi As Long) Range("a1") = kamoku '科目タイトル出力 Range("C" & cellno1) = "前期繰越" If bunrui = "資産" Or bunrui = "資産２" Or bunrui = "収益" Then '科目分類の判定 Set マスタ = Sheets("決算") Set 範囲 = マスタ.Range("A68:B90") Range("D" & cellno1) = Application.WorksheetFunction.VLookup(bunrui, 範囲, 2) End If Call 当期(cellno1, cellno2, cellno3, kamoku, bunrui, karikatakamoku, kasikatakamoku, tekiyou, kurikosi) End Sub Sub 当期(cellno1 As Long, cellno2 As Long, cellno3 As Long, kamoku As String, karikatakamoku As String, kasikatakamoku As String, tekiyou As String, kurikosi As Long) Do Until cellno3 = 30 If kurikosi = 0 Then Select Case kamoku Case karikatakamoku MsgBox karikatakamoku cellno3 = cellno3 + 1 karikatakamoku = Sheets("データ").Range("F" & cellno3) karikatakamoku = Sheets("データ").Range("F" & cellno3) Case kasikatakamoku MsgBox kasikatakamoku cellno3 = cellno3 + 1 kasikatakamoku = Sheets("データ").Range("H" & cellno3) karikatakamoku = Sheets("データ").Range("F" & cellno3) Case Else cellno3 = cellno3 + 1 karikatakamoku = Sheets("データ").Range("F" & cellno3) kasikatakamoku = Sheets("データ").Range("H" & cellno3) MsgBox cellno3 End Select Loop End Sub
Visual BasicでWindowsフォームアプリケーションを作っています。 下記のようなフォームがあり， ・1つのフォームにTextBoxとButtonが1つずつある ・TextBoxのTextは空 ・ButtonのTextは"abc" 下記のような動作をさせたいです。 ・Buttonをクリックすると，TextBoxにabcが追加で入力される ただし，AppendTextメソッドを使って文字列の末尾に入力するのではなく， ・入力カーソルが文字列の途中にあれば，そこにabcが入力される ・一部の文字列が選択されていれば，その文字をabcに置き換える のような，直接キーボードからabcを入力するときと同じような動作をしてほしいのです。 分かりにくいかもしれませんが，どのようにすれば実現できるか教えてください。
Excel VBAでハングルを日本語に置換することはできますか？ 例えば、 Range("A:A").Replace What:="일본", Replacement:="日本" を行いたいのですが、VBEでハングルを入力できません。 よい方法があれば、お教えください。
VB2010でMDI親フォームに表示したForm1のWebBrowser1をキャプチャして保存するコードを知りたいです。
条件付き書式を使い、土曜・日曜・祝日に自動的にB列～Ｎ列までセルに色がつくように設定してあります。 （例：セルの色は省略） Ｂ行（日付）　Ｃ行（曜日）・・Ｅ行・・・・・・・・Ｎ行 　　1　　　　　　　　　日　　　　 　　2　　　　　　　　　月　　　　　 　　3　　　　　　　　　火　　　　　 　　4　　　　　　　　　水　 　　　 　　5　　　　　　　　　木 　 　　6　　　　　　　　　金 　　7　　　　　　　　　土 　　8　　　　　　　　　日 　　・　　　　　　　　　 ・ 　　・　　　　　　　　　 ・ 　　・　　　　　　　　　 ・ 　 31　 　　　　　 　火 色がついたセル(土・日・祝)のE行に”０”を自動で入力したいと考えています。マクロを使えば可能なのでしょうか？ よろしくお願いいたします。
任意の値の時にstopするにはどうすればいいでしょう？ Sub test() Dim i As Long For i = 1 To 10 'iが３の時にストップさせたい Next End Sub ご教授よろしくお願いします。
条件付き書式を使い、土曜・日曜・祝日に自動的にB列～Ｎ列までセルに色がつくように設定してあります。 （例：セルの色は省略） Ｂ行（日付）　Ｃ行（曜日）・・・・・・・・・・Ｎ行 　　1　　　　　　　　　日 　　2　　　　　　　　　月 　　3　　　　　　　　　火 　　4　　　　　　　　　水 　　5　　　　　　　　　木 　　6　　　　　　　　　金 　　7　　　　　　　　　土 　　8　　　　　　　　　日 　　・　　　　　　　　　 ・ 　　・　　　　　　　　　 ・ 　　・　　　　　　　　　 ・ 　 31　 　　　　　 　火 色がついたセル(土・日・祝)のＢ列～Ｎ列に、セルの真ん中を通るような赤い線をマクロを使って引きたいと思っています。そういったことは可能でしょうか？ よろしくお願いいたします。
VBAでやっと希望どおりに出来上がってきたのですが、いつの間にか保存ができなくなりました。 EXCEL２０１０ですが、”EXCELが動作を停止しました。"と出てしまいます。 マクロによって、それを走らせたあと保存できないようなのです。 保存をしなければ特に問題なく動きますが、はっきり言って意味がありません。 名前をつけて別ファイルもダメですし、フォルダを変えてもダメでした。 ２０秒ほどの重いマクロも有りますが、重いことが問題なんでしょうか？ 心あたりのある方、どうか教えてください。
こんにちは。VBを学習しています。 Formにbuttonを配置して、buttonを押すと指定されたパスにあるCSVを読み取り、データベースに取り込むプログラムを書きました。 ここで、buttonを押さずに、定期的な時間になったらデータベースに取り込むようなことをしたいと思います。 考えたのが、PowerShell等のスクリプトでデータベースに取り込む用のプログラムを書き、タスクスケジューラーで時間を指定するというものです。これは努力すればできそうな気がします。 これとは別に、VB上でバッチみたいなものを書いて、それを所定の時間に実行させるみたいな事はできるのでしょうか？
この度はお世話になります。 VBAについて、調べながらやっているのですが・・・うまくいかずに悩んでいます。 エクセルのVBAでバイナリファイル（xxx.bin)を出力したいのですが 思った出力が出ないでいます。 エクセルの方でDEC2HEXをした512文字を、そのままの状態でバイナリファイルを生成をしたいです。 そこで、まずはtxtで書き出せるかやってみまして・・・ Sub test() fnsave = "1.txt" Worksheets("Sheet1").Activate numff = FreeFile Open fnsave For Output As #numff temp = Range("C3") Print #numff, temp Close #numff End Sub （Sheet1のセルのC3に512文字入っています。） これをOutputをBinaryにして・・・Putで書く？ 多分2文字を取り出して・・・書き込む？ような感じなのですが それをプログラムに起こす書き方がわからず困っています。 申し訳ございませんが、ご教授よろしくお願いします。。。
ExcelVBAで教えて下さい。 同じようなデータ形式のファイルが年度ごとにあるので、それを処理するモジュールを作成しました。 私は雛型を作っただけで、実際のファイルの処理をするのは他の人なのですが、雛型ファイルに付いているコードが書かれた「モジュール」は、VBAの画面からのドラッグでのコピーしかできませんか？ また、処理を実行後はモジュールを削除したいのですがそのようなことは可能でしょうか？コードで書けるのでしょうか？もし可能でしたら教えていただけますと幸いです。 初歩的な質問で申し訳ありませんが、よろしくお願い致します。
環境：Visual Basic 2008 教えて下さい。 現在、あるフォルダに格納されている画像ファイルを、EXCELに貼り付けるような プログラムを作成中で、以下のようなサンプルを見つけましたが、単純に貼り付けではなく、 指定のセルに貼り付けたいと考えています。 そのような指定のセルに貼り付ける為にはどのような記述をしたら良いでしょうか？ 教えて下さい。 《現在の記述》 Dim xlApp As New Excel.Application Dim xlWb As Excel.Workbook Dim xlWs As Excel.Worksheet Dim FileNameTmp As String xlWb = xlApp.Workbooks.Open("C:\abc.xls") xlApp.Visible = True xlWs = xlWb.ActiveSheet FileNameTmp = "C:\ABC.png" ' シートオブジェクトを用いない時 xlApp.ActiveSheet.Shapes.AddPicture(FileNameTmp, False, True, 10, 20, 100, 100) 'シートオブジェクトを用いた時 'xlWs.Shapes.AddPicture FileNameTmp, False, True, 10, 20, 100, 100 よろしくお願いします。
環境：Visual Basic 2008 教えて下さい。 EXCELからデータを読み込み、データベースに格納するようなプログラムを 作成していますが、そのＥＸＣＥＬデータの中に、改行コードが含まれているデータ が存在する為、取り込み時点で、削除してから取り込もうと考えています。 その為、以下のような記述をしましたが、改行コードがない場合でもあると認識 してしまいます。 正しい記述はどのようにすれば良いでしょうか？ 《記述内容》 Dim B_SearchChar As String = vbLf B_dp = IN_名称.IndexOf(B_SearchChar) ↑　この記述で改行コードがあると認識できる？ B_dp >= 0 であった場合処理をする。 　　 よろしくお願いします。
Visual Studio2010初心者です。C#で学習しています。 テキストボックスに入力された値が数字(0～9）かそうじゃないか判定をしたいです。 テキストボックスに文字が入力されたらエラーとして検知したいのですが、どのように処理をすればよろしいでしょうか？ ネットで調べるとTryParseメソッドでできるみたいですが、よくわかりません・・・ よろしくお願いします。
お世話になります。 セルの選択時に、カーソルがある箇所に「hoge」と入力する ショートカットを作りたいと思っております。 カーソルがセルの先頭にあれば、「hoge」 「あいうえお」の「お」の後ろにカーソルがあれば、「あいうえおhoge」 「あいうえお」の「う」の後ろにカーソルがあれば、「あいうhogeえお」 です。 何卒、何卒よろしくお願いします
エクセルVBAです VBAでループしているときに、Escキーを押すと、中断する時としない時があるのですが しない時はなぜしないのでしょうか？
あるExcelの表データをHTMLファイルとして出力するやり方を試しています。 A列には単語が記載されており、B列には説明文が記載されています。B列の説明文の中にA列の単語があった場合、hrefでリンク設定にしたいと思っているのですが、考え方としてA列、B列を配列（配列A、配列B）でそれぞれ取得し、配列Aに格納されている要素をfor eachステートメントで一つつ一つ取得し、配列Bの中身を検索し、ヒットしたら、Hrefを設定する。 というやり方で問題ないでしょうか。 自分の頭の中でプログラミングが出来ているのか不安なので質問させていただきました。 間違っているなど、もっとこうしたほうが良いというのがありましたら、ご指摘お願いします。
エクセルのマクロでActiveCellの両端のセルの列番号 はどの様にして得るのでしょうか、教えて頂ければ幸い です、宜しくお願いします。
vbaなのですが ダブルコーテーションを置換する際に、 moji = Replace(moji, """", "") のように、"を二つ入力しないとエラーになりますが そのような事はヘルプのどこに書いてありますか？ ヘルプで検索しても ダブルコーテーションに一致する結果はありません。 となってしまいました。
時間を取得するコードを使っていますが Declare Function timeGetTime Lib "winmm.dll" () As Long Sub Sample() Dim nStart As Long Dim nEnd As Long nStart = timeGetTime() nEnd = timeGetTime Debug.Print (CDbl(nEnd) - CDbl(nStart)) / 100 & "秒" End Sub これだと結果が、 11607271.9221569秒 秒になってしまいました。 ●分●秒で取得したいのですが、 どのような書式にすればよいですか？
アクセス初心者です。 もともと、誰かが作成した金額計算のフォームの消費税の部分で悩んでます。 消費税が5％から8％に上がるので、今まで入っている顧客データの金額はそのままで、 チェックボックスを作って、チェックを入れたら8％で、チェックが入ってない、今までのデータは5％のままにしたいのですが、チェックボックスをデザインビューで作成しても、形だけで、チェックの意味付けのやり方が分かりません。 ＶＢＡとか、入れるのかも知れませんが、どこをクリックして何を入力すれば良いのかも分かりません。 全くの初心者なので、チェックボックス以外のやり方も思いつかず、お手上げです。 クエリに何か式を入れるのかもと思っても、何をどう入れたら良いのかも分かりません。 詳しい方、教えていただけませんでしょうか？
アクセスなのですが Sub test() Set cn = CurrentProject.Connection rs.Open "テーブル", cn, adOpenKeyset, adLockOptimistic rs.Filter = "(店名 = '" & str店名 & "') And (URL = '未')" For j = 1 To rs.RecordCount rs("URL") = "http" rs.Update rs.MoveNext Next rs.Close: Set rs = Nothing cn.Close: Set cn = Nothing End Sub このようにして、既存のレコードにフィルタをかけて該当のレコードの値を更新しているのですが rs.MoveNext をいれると、 1レコード目、3レコード目、5レコード目・・・と言う順番になってしまい、 最終的にrs.RecordCountの数を越したレコードを指定してしまい 実行時エラー　3021 「BOFとEOFのいずれかTRUEになっていか、または現のレコードが要求された操作には、現在のレコードが必要です。」 となってしまいます。 だからって rs.MoveNextをいれないと、rs.RecordCountに達するまで、 いつまでも同じレコードをループしてしまいます。 1レコードずつ順番にデータを掴む方法を教えてください。
初歩的な質問かもしれないですが * ? # 全部のワイルドカードの読み方を知りたいのですが アスタリスク ハテナ シャープ であってますか？ ハテナはクエスチョンマーク シャープはイゲタでしょうか？
おはようございます。 VisualStudio2013　Professionalで開発を考えています。 まだ、購入していないのですが、 色々調べているとVisualStudio2013　Professionalでも MSDN付となしの2種類があるようです。（8万円ほどアップ） MSDNとは質問の受付が可能なようですがその他に 特典があるのでしょうか？ また、その特典は価格に値するものでしょうか？
EXCEL VBA で　VBAサンプルを参考にして、下記により、URLの内容を得ようとしていますが、できません。　どうも、URL画面の中に　インプット用の記述があると、できなくなるのでは、と推測していますが、できるケースもあるようです。解決方法があるようでしたら、教えていただけますでしょうか？ (Win7 64B EXCEL2010 IE11です。)' Sub URL取得TEST() On Error GoTo Er1 Dim StrUrl As String StrUrl = InputBox("URLを指定", "URL入力", "http://www3.nhk.or.jp/nhkworld/") ' これは　読み込めます StrUrl = InputBox("URLを指定", "URL入力", "http://uwl.weblio.jp/") ' これが読み込めません Dim objIE As Object Set objIE = CreateObject("InternetExplorer.application") objIE.Visible = True objIE.FullScreen = False objIE.Top = 200 objIE.Left = 100 objIE.Width = 800 objIE.Height = 600 objIE.navigate StrUrl While (objIE.readyState <> 3 And objIE.readyState <> 4) Or objIE.busy = True DoEvents Wend DoEvents Workbooks.Add objIE.ExecWB 17, 0 objIE.ExecWB 12, 0 Sheets.Add ActiveSheet.name = "Format テキスト" Range("A1").Select ActiveSheet.PasteSpecial Format:="テキスト" objIE.ExecWB 17, 0 objIE.ExecWB 12, 0 Sheets.Add ActiveSheet.name = "FormatHTML" Range("A1").Select ActiveSheet.PasteSpecial Format:="HTML" '別のURLでテキストOKでこれはだめというケースあり ' objIE.Quit Set objIE = Nothing Exit Sub ' Er1: objIE.Quit Set objIE = Nothing End Sub
Ｅｘｃｅｌ2010にて、 VBA マクロ　画像（図）貼り付けを行いたいと思っています。 しかし、マクロを自動登録すると、ActiveSheet.Pictures.Paste.Selectになり、AddPicture ができません。　下記のマクロをAddPictureへ変換したいのですが、そのまま、ＩｎｓｅｒｔをAddpictureに変更してもエラーになってしまいます。　いい方法を教えてください(ToT)/~~~。　どうぞよろしくお願いします。 Sub Test() ' ' Test Macro ' Rows("4:4").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove Selection.RowHeight = 150# Range("C4").Select ActiveSheet.Pictures.Insert( _ "E:\FolderA\fileC.gif"").Select ActiveSheet.Pictures.Paste.Select Range("D4").Select ActiveSheet.Pictures.Insert( _ "E:\FolderA\fileD.gif"").Select Selection.Cut Range("D4").Select ActiveSheet.Pictures.Paste.Select Range("E4").Select ActiveSheet.Pictures.Insert( _ "E:\FolderA\fileE.gif"").Select Range("E4").Select ActiveSheet.Pictures.Paste.Select Range("F4").Select ActiveSheet.Pictures.Insert( _ "E:\FolderA\fileE.gif"").Select ActiveSheet.Pictures.Paste.Select Range("G4").Select ActiveSheet.Pictures.Insert( _ "E:\FolderA\fileG.gif"").Select Selection.Cut ActiveSheet.Pictures.Paste.Select Range("H4").Select ActiveSheet.Pictures.Insert( _ "E:\FolderA\fileH.gif"").Select Selection.Cut ActiveSheet.Pictures.Paste.Select Range("I3").Select ActiveSheet.Pictures.Insert( _ "E:\FolderA\fileI.gif"").Select Selection.Cut ActiveSheet.Pictures.Paste.Select Range("J4").Select ActiveSheet.Pictures.Insert( _ "E:\FolderA\fileJ.gif"").Select Selection.Cut ActiveSheet.Pictures.Paste.Select Range("K3").Select ActiveSheet.Pictures.Insert( _ "E:\FolderA\fileK.gif"").Select Selection.Cut ActiveSheet.Pictures.Paste.Select Range("L3").Select ActiveSheet.Pictures.Insert( _ "E:\FolderA\fileL.gif"").Select ActiveSheet.Pictures.Paste.Select Range("M4").Select ActiveSheet.Pictures.Insert( _ "E:\FolderA\fileM.gif"").Select Selection.Cut ActiveSheet.Pictures.Paste.Select Range("N4").Select ActiveSheet.Pictures.Insert( _ "E:\FolderA\fileN.gif").Select Selection.Cut ActiveSheet.Pictures.Paste.Select End Sub
ExcelVBAマクロについて確認させてください。 ExcelでA列から行方向に漢字、記号（環境依存文字も含む）のデータが１文字ずつ入力されてあり、漢字は削除しないで記号のみセルごと削除するプログラムを作りたいのですが、その方法はありますでしょうか。 [例] 科 削除しない (1) セルごと削除 加 削除しない ☆ セルごと削除
VB初心者でソフト開発をやり始めたのですが行き詰まって困っています。 助けてください。よろしくお願いします。 ・ACCESSのmdb形式のデータは下記の構成になっています。 　1列：　ID　　　　　　integer　サイズ指定無し　自動設定　 　2列：　名前　　　　string　　サイズ指定無し 　3列：　性別　　　　string　　サイズ指定無し 　4列：　電話番号　string　　サイズ指定無し 　テーブル名：sampleTable 　フォームにテキストボックスを項目数配置してＩＤを設定してボタンを押すと各テキストボックスに 　検索されたデータが帰ってきて表示されるものです。 ・下記のようなプログラムで「ＩＤ」を指定して検索が出来るのは確認済みです。 　これを「名前」を指定して検索出来るように改造したいのですがどのようにすれば 　良いのかお教え頂きたくお願いいたします。 　たぶん　”strSelectSql =・・・・・の部分かと思うのですがよろしくお願い致します。 　　（色々試しましたがうまくいきません・・・。） Public Class Form1 Dim MjstrPath As String Dim MjstrID As String 'ID Dim MjstrSimei As String '名前 Dim MjstrSexnam As String '性別 Dim MjstrTel As String '電話番号 　'－－－－－－－－－－－－－－－－－－－－－－－－－－－－－ 　'データを検索する 　'－－－－－－－－－－－－－－－－－－－－－－－－－－－－－ Function MDB_SELECT(ByVal PistrMakPath As String) As Boolean MDB_SELECT = False Dim strDatbasePara As String 'データベースパラメータ Dim ObjCnn As New ADODB.Connection Dim ObjRst As New ADODB.Recordset Dim strSelectSql As String 　　　　MjstrSimei=　TextBox4 strDatbasePara = "Provider=Microsoft.Jet.OLEDB.4.0;" + _ "Data Source=" + PistrMakPath + ";" + _ "Jet OLEDB:Engine Type=5;" Try ObjCnn.Open(strDatbasePara) ' strSelectSql = "Select * from sampleTable" _ ' + " where ID = " + MjstrID strSelectSql = "Select * from sampleTable" _ + " where ID = " + MjstrID 　'＜－－－　問題か？　－－－ 　　　　　　　’where　名前=　"＋　MjstrSimei　ではだめでした ObjRst.Open(strSelectSql, ObjCnn, _ ADODB.CursorTypeEnum.adOpenKeyset, _ ADODB.LockTypeEnum.adLockOptimistic) If ObjRst.EOF Then MjstrSimei = "" MjstrSexnam = "" MjstrTel = "" Else MjstrID = ObjRst.Fields("ID").Value MjstrSimei = ObjRst.Fields("名前").Value MjstrSexnam = ObjRst.Fields("性別").Value MjstrTel = ObjRst.Fields("電話番号").Value MDB_SELECT = True End If ObjRst.Update() ObjRst.Close() Catch ex As Exception End Try ObjCnn = Nothing ObjRst = Nothing End Function 　'------------------------------------------------------------- 　'データを検索する 　'------------------------------------------------------------- Private Sub Button1_Click(ByVal sender As System.Object, _ ByVal e As System.EventArgs) Handles Button2.Click Dim strMdbpath As String Dim intRecQuery As Integer strMdbpath = TextBox1.Text + "\" + TextBox2.Text MjstrID = TextBox3.Text If MDB_SELECT(strMdbpath) Then MsgBox("検索該当しました") Else MsgBox("該当ありません") End If TextBox4.Text = MjstrSimei TextBox5.Text = MjstrSexnam TextBox6.Text = MjstrTel End Sub End Class
表題の通りの事をしたいと思っています。とあるサイトで参照したvbaコードで、デスクトップにファイルをExcelのブック名と同じ名前でPDFに変換するところまで出来ました。あと自動でやりたいことは2つあり、(1)とあるセルの情報を読み込み保存名にしたい【○○○.pdfという具合に】、(2)生成したpdfファイルの保存先をマクロ内に設け指定したいです。【\\サーバー名\○○\△△\□□などのように】 現状までのコードを表記します。わかる方いらっしゃいましたら、お手数ですがアドバイスお願いします。 自分はマクロは手を出したばかりで、初心者です。宜しくお願いします。 Sub pdf() Dim i As Integer Dim s_prn As String, oldprn As String, flg As Boolean On Error Resume Next s_prn = "Adobe PDF" 'インストールされているPDFプリンタの名前 oldprn = ActivePrinter 'アクティブプリンタを取得 If InStr(oldprn, s_prn) = 0 Then '切替えたいプリンタがアクティブプリンタでない場合 flg = False 'プリンタ切替フラグ For i = 0 To 99 ActivePrinter = s_prn & " on Ne" & Format(i, "00") & ":" '「"プリンタ名"on NeXX:」形式PC用 ActivePrinter = "Ne" & Format(i, "00") & ": の " & s_prn '「NeXX: の "プリンタ名"」形式PC用 If ActivePrinter <> oldprn Then flg = True 'プリンタ切替成功 Exit For End If Next i If flg = False Then 'プリンタ切替失敗の場合 MsgBox "プリンタ名:" & s_prn & " が見つかりません。" Exit Sub End If End If ActiveSheet.PrintOut ActivePrinter = oldprn 'アクティブプリンタを元に戻す MsgBox "終了しました。" End Sub
エクセルで、シート１に顧客データ（会員番号、氏名、住所等）が有り、シート２の入力セルに会員番号を入力すると、シート１の顧客データがＶＬＯＯＫＵＰ関数により呼び出されるというエクセルファイルがあります。シート１の顧客データは、別システムでデータ更新しており、ＵＳＢメモリにＣＳＶファイルとして定期的に抽出しています。このＣＳＶファイルのシート１の最新顧客データを元のエクセルファイルのシート１にすべてコピー＆ペーストすることで最新の顧客データを更新しています。 このたび、その作業の自動化を図るにあたり、元のエクセルファイルのシート２で作成したボタンを押下することにより、自動実行したいのです。 お忙しいところ大変申し訳ないですが、そのような他ファイルに及ぶＶＢＡの記述を教えていただけたらありがたいです。よろしくお願いします。
お世話になります。 Excel VBAで作成しております。 エクセルのセルに、[GAZOU]という文字があったら、G1,G2,G3と、連番で置換する マクロを作成したいと思っております。 ※一つ目の[GAZOU]はG1,二つ目の[GAZOU]はG2という風に しかしながら、 一つのセルに[GAZOU]は、一つだけとは限らない状態です。 ※例えば、下記のような形です。 A1セル：あいうえお[GAZOU]かきくけこ[GAZOU] A2セル：さしすせそ A3セル:[GAZOU] A4セル:[GAZOU]たちつてと[GAZOU] 検索対象の文字は、「A列」という条件で結構ですので、 実現方法をご存知の方教えて頂けないでしょうか？ 何卒よろしくお願い致します。
EXCEL 2010ですが、 EXCELのVBAでフォーム上にボタンを複数つけて、各ボタンを押すと対応するテキストファイルが起動するようにしました。これをA.xlsmとします。これはうまくいったので、今度は各ボタンをおすと、対応するEXCELファイルが起動するようにしたかったのですが、ピクリとも起動せず、A.xlsmを終了すると、のこのこと対応するB.xlsmが開きます。 同時起動はムリでしょうか？
環境：Visual Basic 2008 教えて下さい。 画面上から２つのＥＸＣＥＬファイルを指定し、１回の処理でその２つの ＥＸＣＥＬからそれぞれ値を取得したいと考えています。 その為、以下のような記述をしましたが、２回目の値取得のところで "オブジェクト参照がオブジェクト インスタンスに設定されていません。" というエラーメッセージとなってしまいます。 １つのファイルから取得する事は経験ありましたが、同時に２回は初めてで ある為、記述方法が正しいのか、、、 どのように記述したら良いかを教えて下さい。 初歩的な質問で申し訳ありませんが、よろしくお願いします。 《記述内容》 'ＥＸＣＥＬファイルを開く Dim xlFilePath As String = ofd1.FileName '起動時の処理 Dim xlApp As Object xlApp = CreateObject("Excel.Application") Dim xlBooks As Object = xlApp.Workbooks Dim xlBook As Object = xlBooks.Open(xlFilePath) '現シート数 Dim S_COUNT As Integer = xlBook.Worksheets.Count Dim xlSheets As Object = xlBook.Worksheets Dim xlSheet As Object = CType(xlSheets.Item(1), Object) '現シート数 S_COUNT = xlBook.Worksheets.Count Dim R_名称 As String R_名称 = "" R_名称 = xlSheet.Cells(1, 1).Value 'COM オブジェクトの解放 System.Runtime.InteropServices.Marshal.ReleaseComObject(xlSheet) System.Runtime.InteropServices.Marshal.ReleaseComObject(xlSheets) System.Runtime.InteropServices.Marshal.ReleaseComObject(xlBook) System.Runtime.InteropServices.Marshal.ReleaseComObject(xlBooks) 'Excel のプロセス終了 xlApp.DisplayAlerts = False xlApp.Quit() System.Runtime.InteropServices.Marshal.ReleaseComObject(xlApp) GC.Collect() 'のＥＸＣＥＬファイルを開く Dim xlFilePath2 As String = ofd2.FileName '起動時の処理 Dim xlApp2 As Object xlApp2 = CreateObject("Excel.Application") Dim xlBooks2 As Object = xlApp2.Workbooks Dim xlBook2 As Object = xlBooks2.Open(xlFilePath2) '現シート数 Dim S_COUNT2 As Integer = xlBook2.Worksheets.Count Dim xlSheets2 As Object = xlBook2.Worksheets Dim xlSheet2 As Object = CType(xlSheets2.Item(1), Object) '現シート数 S_COUNT = xlBook2.Worksheets.Count Dim R_番号 As String R_番号 = "" R_番号 = xlSheet2.Cells(I_COUNT2, 1).Value 'COM オブジェクトの解放 System.Runtime.InteropServices.Marshal.ReleaseComObject(xlSheet) System.Runtime.InteropServices.Marshal.ReleaseComObject(xlSheets) System.Runtime.InteropServices.Marshal.ReleaseComObject(xlBook) System.Runtime.InteropServices.Marshal.ReleaseComObject(xlBooks) 'Excel のプロセス終了 xlApp.DisplayAlerts = False xlApp.Quit() System.Runtime.InteropServices.Marshal.ReleaseComObject(xlApp) GC.Collect()
　 お世話になります。 Visual Studio 2010 SP1(VB.net)での"ビルド失敗"についての質問です。 OSが Windows7 Pro(32bit)、DBはSQL Server2008、Framework2.0でビルドも正常に成功し 正常に動作しているアプリがあります。 そのソースをOSがWindows 7 Pro(64bit)でその他の環境は上記と同じPCにソースをコピーし ソリューションを開いてビルドを行うとビルドが失敗してしまいます。 エラー、警告は１件もなく、出力ウィンドウを見ると以下のメッセージが出力されていました。 ------ ビルド開始: プロジェクト: DBconnect, 構成: Release Any CPU ------ TRACKER : error TRK0002: ========== ビルド: 正常終了または最新の状態 0、失敗 1、スキップ 0 ========== アプリで使用している小さなクラス（ＤＢ接続のみ）のような複雑ではないコードでも ビルドに失敗してしまいます。 エラーメッセージで調べてみると 64bit開発環境 特有のエラーらしいことは分りましたが Visual C++（？）の情報しか見つけられませんでしたので質問させていただきました。 解決方法を知っている方がいらっしゃいましたらご教授お願い致します。
IDをループで呼び出しながら、追加クエリでテーブルに追加したいのですが、 値が入りません。 エラーなく動くのですが、テーブルに値が入っていないのです。 何がたりないのでしょうか？ ――――――――――――― Public Sub CYUSYUTU_SEIKYUID2() Dim CYUSYUTU_SEIKYUID As String Dim recCount As Long recCount = DCount("*", "作業用請求先ID") Dim ID As String Dim DB As DAO.Database Dim RS As DAO.Recordset Dim i As Integer Dim strSQL As String Set DB = CurrentDb Set RS = DB.OpenRecordset("作業用請求先ID") RS.MoveFirst Do Until RS.EOF RS.Edit For i = 1 To recCount CYUSYUTU_SEIKYUID = RS.Fields("請求先ID(13)").Value DoCmd.RunSQL _ "INSERT INTO [作業用_▲入金DB] SELECT * FROM ▲入金 WHERE ▲入金.請求先ID='& CYUSYUTU_SEIKYUID &';" Next i RS.Update RS.MoveNext Loop RS.Close: Set RS = Nothing DB.Close: Set DB = Nothing End Sub
次のURLを使わせていただいてVBAでZIP圧縮できました。 http://scripting.cocolog-nifty.com/blog/2007/11/ … さらに、VBAからパスワードつきでZIP圧縮したいのですがどのようにしたらいいでしょうか？ VBAはExcel2013VBAです。
得意先の当年、前年の売上実績表をExcel2010で作成しています。 Aファイル（売上集計表）とBファイル（前年売上金額）があり、Bファイルを集計し、Aファイルに前年の売上金額を表示します。Aは、当年の順位と会社名と当年の売上金額を表示しています。当年と前年で順位が異なると数値が合いません。当年の順位と会社名をキーにして、前年の売上金額を載せたく思います。例えば当年が1位のA会社が、前年が2位の場合もあります。当年1位は、A会社の売上金額、前年の金額はA会社の2位の売上金額が入り、１位の前年度の金額が入りません A.xlsを立ち上げて、B.xlsを立ち上げ計算して、得意先の当年と前年の数値をA.xlsに書き込んでおります。 A.xlsのB列に１から8の順位までが固定で入力されていて、C列に会社名があり、D列に当年の数値、E列に前年の数値を書き込んでおります。 B.xlsのA列に１から60までの順位があり、B列には会社名があり、C列に前年の数値があります。 当年の数値は問題ないのですが、前年の数値をA.xlsに書き込む際に、B.xlsの順位fがキーになっている為、 数値が逆になってしまう事があります。 A.xlsにある会社名は、当年の数値を見てA.xlsに書き込んでおります。 得意先の順位が、当年と前年において同一であれば問題ないのですが、 異なる場合、数値が異なって書き込まれてしまいます。 当年で８位、前年で９位だとすると（得意先の当年と前年の順位が同一でない場合）前年の8位の値が書き込まれてしまいます。 （異なる得意先の前年の８位の値になってしまいます。） A.xlsのC列の会社名をキーにして、得意先の当年と前年の順位が同一でなくても、 前年の順位を出すにはどうすれば良いでしょうか？ 下記コードを用いております Dim iii, jjj As Long Dim myrange1 As Range jjj = 3 For iii = 1 To 8 Set myrange1 = Range("A:A").Find(What:=iii, lookat:=xlWhole) If myrange1 Is Nothing Then Workbooks(ThisWorkbook.Name).ActiveSheet.Range("E" & jjj) = "確認！" Else myrange1.Offset(0, 2).Copy Workbooks(ThisWorkbook.Name).ActiveSheet.Range("E" & jjj) End If jjj = jjj + 1 Next iii 長文・乱文を最後まで読んでくださりありがとうございました。 ご教授ください。 宜しくお願い申し上げます。
「ExcelVBA複数条件一致後別シートに結果表示」という質問を以前させていただき、丁寧にコードを解説していただきました。 ※その節はありがとうございました。 ●ファイルの内容(概要)配下の通りの構成です。 　＜Sheet1＞ 　　A列：性別(男性:1、女性:2でコード化) 　　B列：死因コード(数値5～6桁) 　　C列：年齢 　　D列：市町村(3桁でコード化「201」等) 　＜Sheet2＞Sheet1で条件に一致したものを以下の通り表を作成する 　　・「セルA1」に表にしたい市町村コードをあらかじめ入力しておく 　　・セルB1～セルEC1まで死因コード 　　・セルA2～セルA132まで年齢0～130 　　・セル範囲B2～EC132に「A1」に入力した市町村コードの男性の値が入る 　　・セルB133～セルEC133まで死因コード 　　・セルA134～A264まで年齢0～130 　　・セル範囲B134～EC264に「A1」に入力した市町村コードの女性の値が入る そして、以下のコードを教えていただきました。 **************************************************** Dim r As Long Dim i As Integer, j As Integer, k As Integer Dim Wsf As Object Dim SCode As Range, Nenrei As Range Dim Ws1 As Worksheet, Ws2 As Worksheet Set Ws1 = Worksheets("sheet1") Set Ws2 = Worksheets("sheet2") Set Wsf = Application.WorksheetFunction Application.ScreenUpdating = False Ws2.Range(Ws2.Cells(2, 2), Ws2.Cells(132, 133)).ClearContents Ws2.Range(Ws2.Cells(134, 2), Ws2.Cells(264, 133)).ClearContents With Ws2 Set SCode = .Range(.Cells(1, 1), .Cells(1, 133)) 　↑ここはこのように書いていただいたのから、 　指定の死因分類があったためシートから参照するようコードを変えています。 　手元にファイルが無くてかけないのが初心者の情けないところです。 　申し訳ありません。※シートは同一ファイル内におくようにしています。 End With r = 2 Do While Ws1.Cells(r, 1).Value <> "" If Ws1.Cells(r, 4).Value = Ws2.Cells(1, 1).Value Then If Ws1.Cells(r, 1).Value = 1 Then i = 1 ElseIf Ws1.Cells(r, 1).Value = 2 Then i = 134 End If With Ws2 Set Nenrei = .Range(.Cells(i, 1), .Cells(i + 130, 1)) End With j = i + Wsf.Match(Ws1.Cells(r, 3).Value, Nenrei, 0) - 1 k = Wsf.Match(Ws1.Cells(r, 2).Value, SCode, 0) Ws2.Cells(j, k).Value = Ws2.Cells(j, k).Value + 1 Else End If r = r + 1 Loop Application.ScreenUpdating = True Set Scode = Nothing Set Nenrei = Nothing Set Wsf = Nothing Set Ws1 = Nothing Set Ws2 = Nothing End Sub **************************************************** 表はあらかじめ作成しておくので、そこに集計結果が入ります。 実行していたら、古いファイルに不詳の死因コードが登場し、 どうしたらいいかと考えた結果、死因コードの列の最後に「その他」を設け、 死因コードに一致しない場合にはそこに集計結果をカウントすることは できないか？という考えに至りました。 自分で考えるのが一番勉強になると分かっていても試行錯誤している時間が無く、 急ぎのためお知恵のある方々にご協力を頂ければと思い、 再度質問させていただいた次第です。 前の質問は↓こちらです。 http://oshiete.goo.ne.jp/qa/8356291.html 何卒よろしくお願い申し上げます。
WindowsXPのエクスプローラで、検索コンパニオンを使って検索させるVBSの相談です。 ある文字列を含むファイルを検索させたいと思っていますが、検索対象のフォルダーが数十個ありますので、これをバッチ的に動かしたいと思っています。なお、会社で使いますのでフリーソフトはNGですがVBSはOKです。 WindowsXPでは検索した結果の保存はできないようですが、検索結果を取り出してファイル保存するVBSは探せました。 VBSで　フォルダーを指定してエクスプローラを起動するところも出来そうです。 エクスプローラで現在開いているフォルダ配下から、ある文字列を含むファイルを検索させる部分をVBSで組みたいのでアドバイスをお願いします。できればコードで。それと、検索が終わったことを検知する部分も出来ればお教えいただきたいです。 ネットではかなり調べたつもりですが分かりませんでした。よろしくお願いします。
教えてください。 Sheet1の"A1"に"1"、"A2"に"2"、"A3"に"3"と数字が並んだ状態です。 次の関数を利用して範囲から値を表示します。 ---------------------------------- Dim c As Variant For Each c In Sheet1.Range("A1:A3") MsgBox c.Value Next ---------------------------------- このやり方だと、当然上から1,2,3と表示されます。 やりたいことは物理的に元データをいじらずに(並び替えはせずに) VBAだけで範囲の下から上への処理を行いたいです。 よろしくお願いします。
Visual Basic 2010でのプログラミングがわからないので教えて下さい。 自分は、今回がプログラムを初めて行う初心者でして、テキストファイルを読み込むことはできたのですが、サンプルコードを改変してつくったので言語についてはあまり理解できていません。 知識不足なのですが、急いで作らなくてはいけないのでよろしくお願いします。 テキストファイルから必要な部分だけを読み込む→読み込んだ数値を使ってグラフを表示するというアプリケーションを作りたいのですが、どのようにすればよいのでしょうか？
乱数が0～9まであります。 次の出現率に従って乱数を生成したい場合どのように行えば良いでしょうか？ 0の出現率は70%です。 1の出現率は20%です。 2の出現率は10%です。 3～9の出現率は0%です。 よろしくお願いします。
VS2008のStandard Editionでクリスタルレポートを用いて開発したいのですが そもそも「Standard」で開発が可能なのでしょうか？ そこらへんの情報が出てこないので質問させて頂きます。 ご教授の程よろしくお願い致します。
選択範囲で定数(数値)が含まれているセルを表示する自作関数を 作成したいと考えていますがうまく動いてくれません。 以下のサンプルコードを実行すると選択した範囲全てが表示されてしまいます。 初心者で申し訳ないですがご教示下さい。 ■ 標準モジュールソース --------------------------------------- Function SAMPLE(SelectRange) For Each c In SelectRange.SpecialCells(xlCellTypeConstants, xlNumbers) MsgBox c.Value Next End Function --------------------------------------- → 再現方法：A1に「1」と入力して、B1セルに「=SAMPLE(A1:A2)」と入力 よろしくお願いします。
［sheet1］内での作業ですが… 雛形のページを１枚作成して、複数枚のページが必要になったので「マクロの記録」で１ページ分の行をコピーして、１ページの下に貼り付けてみました…で、それは実行できるのですが、３ページ目では実行できません。 マクロの知識はありませんが、ページを貼り付ける行が変更できないからだなぁ～と。 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Sub ページを追加() ' ' Macro1 Macro ' マクロ記録日 : 2013/12/12 ユーザー名 : エクセル-NOTE ' ' Rows("9:51").Select Selection.Copy Rows("52:52").Select ActiveSheet.Paste End Sub ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ 何処でも好きな行を選択してページを増やすことはできないのでしょうか? ただ、単純にページを下へ下へと、必要な分だけ追加したいのです…が。 上の「数行」は見出しに利用しています。
VBで、 　　　Call SendKeys.Send(%{F4}) とコードを書くと、なぜか%の部分に「文字が有効ではありません。」というエラーが出てくるのですが、どういうことでしょうか。ネットで検索したら、成功するとありましたが…。 環境）OS：Windows8 　　　 バージョン：VB2012
VB2012ですが、電卓を起動している状態で、 Private Sub Form1_Load(sender As Object, e As EventArgs) Handles Me.Load AppActivate("電卓") End Sub というコードでForm1を実行してみると、どうしてもForm1がアクティブになってしまうのですが、電卓をアクティブにしたいので、どうすれば良いでしょうか？ 環境）OS：Windows8 　　　 バージョン：VB2012 　　　　　　　　　　　　　　　 …となっています。
VBAでリストを作成したあと B列　昇順 C列　昇順 D列　ユーザー設定リスト という順番で並び替えるにはどうしたらよいでしょうか？
重複行を削除するマクロを作っていますが、うまくいきません。 2行目にタイトルが入っていて、3行目以降が必要なデータになります。 この中でA列が一致しているデータ行を削除したいと考えており、 重複データが削除された後、タイトル行がなぜか一番下の行にはりついてしまいます。 どなたか詳しい方助けてください！！！よろしくお願いします。 ちなみに以下が現在使用しているVBAコードです。 =============================================================== Sub GoodRemoveDuplicates() 'A列にデータが入力されており、そのデータを並べ替えた後、 '重複するデータが含まれている行を削除するマクロ Worksheets("貼り付け用用マクロ").Range("A1").Sort _ key1:=Worksheets("貼り付け用用マクロ").Range("A1") Set currentCell = Worksheets("貼り付け用用マクロ").Range("A1") Do While Not IsEmpty(currentCell) Set nextCell = currentCell.Offset(1, 0) If nextCell.Value = currentCell.Value Then currentCell.EntireRow.Delete End If Set currentCell = nextCell Loop End Sub ===============================================================
エクセル2007でＶＢＡを使用しての一覧表を作りたく質問させていただきます。 名簿 001　あいう 002　かきく 003　さしす　 上記の様な一覧表のシートから 別のシートで Ａ　　　　　Ｂ　　　　　Ｃ　　　　　Ｄ 002　　　かきく 001 Ａ列に指定のコード002等を入れると名簿のシートから「かきく」とＢ列の「かきく」を表示する様に させたいと考えています。 ＶＬＯＯＫＵＰで行おうと試行錯誤しましたが、 Ａ列の上段に002と入れた時に001が読み出せなかったり 再度002と入れても表示されないためにやりたいことが上手く出来ずに困っています。 Ａ　　　　　Ｂ　　　　　Ｃ　　　　　Ｄ 002　　　かきく 002　　　かきく 002　　　かきく 001　　　あいう 001　　　あいう 001　　　あいう 002　　　かきく 003　　　さしす 理想は上記のような形で表示できるようにしたい為、 マクロボタンを押すと一括でＡ列に対応したＢ列の文字を名簿シートから 表示（貼付？）させれば可能なのかとも考えていますが、 正直勉強不足でそこまでの式が書けずに、 ネットで検索してそれらしいコードも探していますが、 修正して使えるようなコードが見つけられません。 この関数を使えばとか、このコードが使えますといった物を教えて頂けないでしょうか？ 宜しく願いいたします。
エクセルのA列に「フォルダ場所+ファイル名.pdf」のリストを作成し、 PDFファイルを開き、印刷し、閉じるマクロを作成しましたが、全く印刷されません。 エラーが出て止まることなく、次々進んでいるのですが、肝心の印刷が実行されていません。 ネット検索で見つけたものをアレンジしたのですが、高度すぎて苦戦しています。 エクセルシートの内容は、 セルA2～には、フォルダ場所+ファイル名.pdf　　例）C:\work\test1.pdf C2には印刷実行数（ファイルの数） を置いています。 どなたかご存知の方いらっしゃいましたら、どうか教えてください。 よろしくお願いいたします。 ---------------------------------------------------- Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long) Sub PDF() Dim AA, BB, CC, DD Dim AAA, BBB Dim i As Long For i = 1 To Range("C2").Value AA = "C:\Program Files (x86)\Adobe\Reader 11.0\Reader\AcroRd32.exe /t " BB = Range("A" & i + 1).Value CC = Application.ActivePrinter DD = AA & """" & BB & """" & " " & """" & CC & """" Debug.Print DD Set AAA = CreateObject("WScript.Shell") Set BBB = AAA.exec(DD) Sleep 1000 On Error Resume Next BBB.Terminate Set BBB = Nothing Set AAA = Nothing Next i End Sub
ExcelVBAに関する質問です。 ExcelVBAに関する質問です。ExcelVBAではデフォルトのマウスカーソルの大きさを変更（例えば2倍に大きくするなど）すること可能なのでしょうか？ マウスカーソルが特定のボタンに触れたとき、マウスカーソルが大きくなるようなプログラムを、VBAで作成したいと考えております。 VBAに関して知識のある方、是非お力を貸していただきたいです！ ・自分で考えたこと マウスカーソルの大きさを変更する手段は２つあると考えました。 １,マウスカーソルをデフォルトのn倍にすること ２,マウスカーソルをデフォルトから、n倍の大きさのマウスカーソルの画像に置き換えること 前者については、調べた中では難しそうだと感じました。 後者に関しては、javaやVBなどの言語でマウスカーソルを特定の画像に置き換えることが可能であることがわかりました。 ただ、VBAである特定の条件になった時に、マウスカーソルをデフォルトから特定の画像に変更するプログラムのサンプルは見つかりませんでした。 （VB.Netだとhttp://d.hatena.ne.jp/RIREX/20120507/1336397369にあるような例が見つかりました） ・回答していただきたいこと（1が難しいと感じた場合でも、他の1つでも回答していただけると嬉しいです） 1.特定のボタン上にきた時に（注意：左右クリックはしない）、マウスカーソルが大きくなるようなプログラムの具体的なサンプルを教えていただきたいです！ やってほしい度合い：★★★★★ 2.VBAにおいてマウスカーソルをデフォルトからn倍にする方法はあるのか？マウスカーソルの座標とは切り離して、実行すればマウスカーソルの大きさが変更されるプログラムの具体的なサンプルを教えていただきたいです！ やってほしい度合い：★★ また、仮にVBAで特定の画像を読み込み、デフォルトカーソルをその画像と変更できる場合の画像は、例えばどのような形式のファイルで、どの様にパスを設定すれば良いかも簡単に教えていただけると嬉しいです！ ・注意 　「マウスカーソルをデフォルトから、他の形に変更したい」のではなく、「マウスカーソルの大きさをExcelVBAのプログラム上で変更したい」です！
いつもお世話になっています。 約半年ほど前よりエクセルのVBAを勉強し始めまして 機会がありVisualBasicを覚える事になりました。 会社の先輩が作ったVB6のコードを見ていたのですが やっている事が何となくわかる様なわからない様な・・・ という感じです。。 例えばエクセルでは(A1～A20までのセル)、VBでは同じようにグリッドにデータが入力してあり 選択しているセル(A1)のデータと一致するセルを含む行又はレコードを選択するという処理があったとします。(あくまでも例です) エクセルでもVBでもFor～Nextが使える事はわかったのですが 対象とする目印？的なものの(基準というか考え方というか）が理解出来ないのです・・・・。。 エクセルだとcells(rows.count,1).end(xlup).rowで最終行を取得して For～NextでIf Range("A1").value = cells(i,1).value then・・・ で処理できますがVBではどうなのかとか・・・・ (説明がめちゃくちゃですみません。。泣) 同じようにVBAからVisualBasicを始めた方！ VBAでのプログラミングの考え方とVisualBasicの考え方の違いや どういう風に勉強していけば良いか等、アドバイスや経験談等を教えて頂きたいです。 宜しくお願い致します。
シリアル通信で定期的に４桁の数字が送られてきます。 それをSample.txtに 0126 0125 0125 0125 0124 と言う風に、記録したいんですが、実際やってみると 0124 と、データが上書きされてしまい,一番最後に送られてきた数字しか記録されません。 これを改行して書くにはどうしたらいいんでしょうか、おしえてください。 　data = RecvStr 　IO.File.WriteAllText("C:\Test\Sample.txt", data,　System.Text.Encoding.GetEncoding("Shift-JIS"))
VB初心者のものです。 VB2008で制作したデータベース（Sql Compact3.5を使用）を他のPCに配布に配布したいと思っています。 Sql Saver2008で制作しても配布すれば楽だったのですが、取り扱う人間が私以上にPCに疎く、使用するまでの過程が困難になりそうでしたので、実行形式に出来るもので制作して配布しようと考えました。 自分のＰＣで完成したのですが、他のＰＣにコピーして使用してみたところ、 「アプリケーションのコンポーネントで、ハンドルされていない例外が発生しました。[続行]をクリックすると、アプリケーションエラーを無視し、続行しようとします。[終了]をクリックすると、アプリケーションは直ちに終了します。 ファイルまたはアセンブリ’System.Data.SqlServerCe, Version=3.5.0.0,Culture=neutral,PublicKey Token=89845dcd8080cc91’、またはその依存関係の1つが読み取れませんでした。指定されたファイルが見つかりません。」 といったエラーが出てしまいました。 配布先のPCには必要以上のものをインストールしたくないので、テスト機（Windows7）には VBおよびSqlはインストールしていません。 テスト機のPCで動かすためのファイルが足りないために起こるエラーだと自分は思っているのですが、何が必要なのかがわかりません。 配布にあたりまして、こういったトラブルを防ぎたいのですが必要なファイルが入っていない場合に自動的にダウンロードをする、といった事は可能なのでしょうか？ また、このエラーの場合は何が必要なのでしょうか？ またはそもそも、自分の考えは間違っているのでしょうか？ なお、配布先のPCのOSはWindowsXP機もありますが、これについても問題がありますでしょうか？ ご指摘、ご指導をお願いできませんでしょうか？ よろしくお願いいたします。 制作元PCのOS：Windows7 開発環境：Visual Basic2008 Express 使用データベース：Sql Compact3.5
ＶＢＡのサンプルを見ていると＃が使われていました。例えば ＃Ｉｆ　・・・・　then ・・・ #end　if などです。この＃の意味は何でしょうか。 よろしくお願いします。
Windows7 IE10 の環境でEXCEL VBAからWebのダウンロードボタンを押すところまではできてますが、 通知バーのハンドルを取得できずに困っています。 以下のFindWindowのパラメータが悪いと思うのですが、何を指定すればいいのかわかりません。 ご教授、よろしくお願いします。 Do DoEvents p_lngFindWnd = FindWindow("#32770", "保存") lCntloop = lCntloop + 1　　　　　 Loop While (p_lngFindWnd = 0 And lCntloop < 10000)
教えてください。 VS2010(Vb.net)で作成したアプリケーションで例外エラーが発生しました。 　・問題イベント名：CLR20r3 　　　・ 　　　・ 　　　・ 　・問題の署名07：939 　・問題の署名08：14a ・問題の署名09：System.ObjectDisposedExcaption と表示されます。 ildasm.exeを使用し、逆アセンブリファイルを出力して確認しようとしましたが、内容がちんぷんかんぷんで分かりません。 問題の署名07,08で発生箇所を特定できそうな事を調べましたが、その見方が良く分かりません。 この問題の署名07,08をどのように検索すれば、発生箇所を特定できるのか教えてください。 宜しくお願いします。
Wordマクロで下記のような動作をすることができますでしょうか？ (1)　WordマクロからVB.Netのフォームを起動 (2)　(1)で起動されたフォーム上のOKボタンをクリックすると、フォームに入力されたデータを 　　WordVBA側が受け取り、処理を行う。 よろしくお願いします。
オブジェクトをどこで破棄するか こんにちは。C#もしくはVBについてお教え下さい。オブジェクトの破棄をどこですればいいかわからなく、悩んでいます。 フォームには下記のオブジェクトが配置されています。 ・データグリッドビュー ・検索ボタン ・閉じるボタン 動作は下記のようになります。 ・フォームをロード時、データベースにアクセス。データテーブルにデータをセット。グリッドビューに表示。 ・検索ボタン。データベースにアクセス。データテーブルにデータを再びセット。グリッドビューに表示。 ・閉じるボタン。フォームを閉じる。 ・DataTable、DataAdapter、sqlConnectionなどの変数は使い回しています。 質問： これらのオブジェクトを破棄、disposeするのは、どのタイミングですれば良いでしょうか？ 閉じるボタンを押された時でしょうか？またフォームの右上にバッテンマークがありますが、これが押された時もdispose処理を入れておいたほうがいいのでしょうか？ またはフォームを閉じた時は自動で破棄してくれるのでしょうか？ 宜しくお願い致します。
VisualBasic6.0(AccessVBA)でバイナリ形式(EBICDIC)のファイルを読み書きしようとしています。 その際に以下の問題が発生してしまい原因が分からずに悩んでおります。 ■問題 　ファイルの読み込みはファイルのサイズ（バイト数）分を一気に読込ます。 　その後、VB側で1レコード(128バイト)単位に分割してファイル出力(PUT)しています。 　このPUTを行うと、ファイルの先頭4バイトに(08001200)と出力されてしまいます。 　この4バイトが出力される原因が分からず悩んでおります。 どなたかご存知の方がいらっしゃいましたらご回答いただけると助かります。 参考にバイナリエディタのキャプチャを添付いたします。 以上です。
vbでDataTableの抽出コピー DataTableから条件抽出したデータで別のDataTableを作成したい ・DataTable1から条件抽出したデータで別のDataTableを作成したい ・データの件数が違うだけでヘッダーなどの内容は同じにしたい Dim DataTable1 As DataTable ' 既にテーブルデータが入っているとする Dim DataTable2 As DataTable ' これに一部のデータとヘッダーを複写 Dim DataRow1 As DataRow ' DataRowの一時領域１ Dim DataRow2 As DataRow ' DataRowの一時領域２ ＜試作１：ＮＧ　DataRowの使いまわしがきかない＞ DataTable2 = DataTable1.Clone For Each DataRow1 In DataTable1.Select(条件, ソート) DataTable2.Rows.Add(DataRow1) Next DataRow1 ＜試作２：ＮＧ　ワンクッションかましただけではダメ＞ DataTable2 = DataTable1.Clone For Each DataRow1 In DataTable1.Select(条件, ソート) DataRow2 = DataRow1 DataTable2.Rows.Add(DataRow2) Next DataRow1 もしかして、個別セット以外に道はないのでしょうか？ DataTable2 = DataTable1.Clone For Each DataRow1 In DataTable1.Select(条件, ソート) DataRow2 = DataTable2.NewRow DataRow2("item1") = DataRow1("item1") DataRow2("item2") = DataRow1("item2") DataRow2("item3") = DataRow1("item3") DataRow2("item4") = DataRow1("item4") DataRow2("item5") = DataRow1("item5") DataRow2("item6") = DataRow1("item6") DataRow2("item7") = DataRow1("item7") DataRow2("item8") = DataRow1("item8") DataTable2.Rows.Add(DataRow2) Next DataRow1 何か良い方法はありませんか？
こんばんは！ Accessについて、質問があります!! あるフォームに設置したボタンのクリック時プロパティに、教えてもらったものですが Private Sub 解約_Click() 　　Me.取次名.Locked = False 　　Me.担当者名(1).Locked = False 　　Me.担当者名(2).Locked = False 　　Me.形態.Locked = False 　　Me.契約日.Locked = False 　　Me.会社ID.Locked = False 　　Me.会社名.Locked = False 　　Me.電話番号.Locked = False 　　Me.FAX番号.Locked = False 　　Me.郵便番号.Locked = False 　　Me.都道府県.Locked = False 　　Me.住所.Locked = False 　　Me.URL.Locked = False 　　Me.代表者.Locked = False 　　Me.代表者携帯電話.Locked = False 　　Me.代表者メールアドレス.Locked = False 　　Me.担当者.Locked = False 　　Me.担当者携帯電話.Locked = False 　　Me.担当者メールアドレス.Locked = False CopyRec 　　Me.取次名.Locked = True 　　Me.担当者名(1).Locked = True 　　Me.担当者名(2).Locked = True 　　Me.形態.Locked = True 　　Me.契約日.Locked = True 　　Me.会社ID.Locked = True 　　Me.会社名.Locked = True 　　Me.電話番号.Locked = True 　　Me.FAX番号.Locked = True 　　Me.郵便番号.Locked = True 　　Me.都道府県.Locked = True 　　Me.住所.Locked = True 　　Me.URL.Locked = True 　　Me.代表者.Locked = True 　　Me.代表者携帯電話.Locked = True 　　Me.代表者メールアドレス.Locked = True 　　Me.担当者.Locked = True 　　Me.担当者携帯電話.Locked = True 　　Me.担当者メールアドレス.Locked = True End Sub というイベントプロシージャを設定しました。 しかし、ボタンをクリックすると『メソッドまたはデータメンバーが見つかりません』とエラーになります。 デバッグ後、1行目が黄色くなり、『Me.代表者メールアドレス.Locked = False』の".代表者メールアドレス"や".Locked = "が青く選択されます。 単に名前が誤っているものと思い、テーブルのフィールドとフォームのテキストボックスで"メールアドレス"の部分が全角だったり半角だったりしたため、プロシージャ含め全て全角に統一しました。 それでボタンをクリックしても、同じエラーになります。 名前は全て修正したはずですが……何が原因でエラーになるのでしょうか？ 回答よろしくお願いします！
次のこと教えて下さい。 シートの下部に並んだシート名（cheet1 cheet2 cheet3) を　別セルに名前を転記したいのですが For I = 1 To 18 On Error Resume Next Sheets(I).Select SHET(I) = Application.ActiveSheet.Name ' 現在開いているシート名を取得す ' Sheets("メニュー").Cells(3 + I, "AS").Value = SHET(I) 　　　　　Next i 　　 で作ってみたのですが、シートの順位を変更・新シートを挿入すると 転記した順位が狂ってきます　　のでうまくいきません　　　
ある文字列の中から漢字のみを抜きだしセルに表示、その漢字の個数とそれぞれの漢字の個数をセルに表示するにはどのようなプログラムにしたらよいのでしょうか？ 例えば、「私は昨日、日光東照宮へ私の家族といっしょに行った」⇒私２、昨１、日２、…漢字の総数１２というような感じです。拙い説明で分かりずらいかもしれませんが、わかる方どうかお力を貸してください。
Excel VBAを使っていて、 たまにマクロを実行できないときがあります。 特にデバッグ途中というわけでもないのに、 マクロで実行したいプログラムを選択しても実行ボタンがグレー色になっており 実行することができません。 全てのプログラムではなく、実行途中に変な操作が入り、 停止したものだけです。 excelを再起動すると元に戻ります。 これはどういう状態にあるのでしょうか？ 再起動せずに復帰する方法を教えてください。
初めてgoo質問を使います。 sheet1とsheet2の１列目と２列目で重複していない行を sheet2から削除したいです。 例えば、 Aの列に番号？、Ｂの列に数字 sheet1 A B CDEF 1 番号A 1 2 番号A 2　 3 番号A 3 4 番号C 1 5 番号C 2 6 番号F 6 7 番号F 7 8 番号F 8 9 番号F 9 10 番号F 10 sheet2 A B CDEF 1 番号A 1 2 番号A 2　 3 番号A 3 4 番号B 1 5 番号B 2 6 番号B 3 7 番号C 1 8 番号C 2 9 番号D 8 10 番号D 10 があったとして、上記を下記のようにしたいです。 sheet2 A B CDEF 1 番号A 1 2 番号A 2　 3 番号A 3 4 番号C 1 5 番号C 2 6 番号F 6 7 番号F 7 8 番号F 8 9 番号F 9 10 番号F 10 CDEFの列にはsheet1とsheet2で違うデータが入っています。 sheet2から重複していない行を削除したいです。 宜しくお願いします。
エクセル2003のVBAを使用し、データを別BOOKの指定セルに流し込む方法を教えて下さい。 シート名「流し込み用」の中のデータは4行目から1000行目まで入っていて、列はAとBが結合、DEFが結合されていてGまで4つのデータが入っています。 このデータを10行ずつ、BOOK2のシート名（QW-1）～（QW-100）の指定セル（行は16~25の間、列の並びはBOOK1と同じ）に流し込みたいと思っています。BOOK1のデータもBOOK2のシートも今後増えていきます。 どなたか詳しい方、ご教示いただけないでしょうか？
はじめまして。 急遽VB6.0、Accessで開発を行っております。まったくの初心者です・・・。 DoCmd.TransferText　でCSVファイルを一時テーブルに保存し、利用する機能を開発しているのですが、その際CSVのデータの中の電話番号（080-0000-0000というテストデータ）がyyyy/mm/dd型に変換されてしまい、困っています。 このような状況を解消するには、何か方法はありますでしょうか。 調べてみたのですが、なぜ変換されるかもいまいち分からず・・・ DoCmd.TransferTextでは無理、などお分かりでしたらご教授ください。 またCSVファイルのレコード数が多いので、一つ一つのデータを修正することは難しいかと思っております。 どうぞよろしくお願いいたします。
初心者です。今無償のVisualBasic2010を使って勉強していますが、VisualBasic2012にアップするかどうか迷っています。 勉強は今のままの2010でほぼ満足する軽さでいいと思うのですが、今後の事を考えると（書籍も出ているので）2012にしたほうがいいのか、このまま2010でいいのか？ 2012をインストールして重かった場合、2012をアンインストールして今使っている2010に戻せるのか。ちょっと考えてどちらが良いのか分かりません。 PCのスペックはWindows7（元はVista）CPU：Core2Duo2.6GHz ：メモリ2.0Gです。宜しくお願いいたします。
ExcelVBAで複数の表に、同じ見出し行を入れる方法を教えて下さい。 ExcelのSheet1に数字だけで構成された表があります。それぞれ意味があり、例えば「4列は市町村コード」「5列は性別」「17列は年齢」「20列は疾病コード」という感じです。 VBAで市町村・男女別で、年齢と疾病コードに一致した場合にカウントする場合の表は回答をいただき作成できました。 ですが50以上×男女分の表を作るのに疾病コードを 　Range("C3,C136").Value = 14500 　Range("D3,D136").Value = 14510 と、していると、入力間違えも発生しかねないですし、きりがなく、他に良い方法があればご教授いただけましたらと思います。 疾病コードの数字は連番ではないためコピーができません。 疾病コードは「132」あります。 よろしくお願い致します。
こんにちは。VBAの記述について質問させてください。 VBAのレベルは、簡単なマクロ処理(コピー、貼り付けしたり、シートの追加、削除をしたりできる程度です）を VBAで書けるくらいの初心者です。 インターネットに掲載されている事例を見ながら一週間ほど試行錯誤しましたが、 どうしても、下層フォルダも含め、複数のファイルをまとめて移動する方法がわかりません。 いろいろ考えたところ、 1．下層フォルダも含め、ファイル名をまとめて取得 2．それをExcelに書き出してリストを作る 3．そのリストにあるものをすべてひとつのフォルダにまとめて移動する という流れでやればいいのかな、と思いますが、 やり方がわかりません。 ※そもそもこの考え方が違っていたら、ご指摘ください。 インターネットを参照すると、 まず、1、2は、次の方法でできることがわかりました。 参照サイト VBA応用 http://www.asahi-net.or.jp/~ef2o-inue/vba_o/sub0 … ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Option Explicit ' 指定したフォルダ内のファイルの一覧を取得 Sub ファイル名一覧取得() Const cnsTitle = "フォルダ内のファイル名一覧取得" Const cnsDIR = "\*.*" Dim xlAPP As Application Dim strPATHNAME As String, vntPathName As Variant Dim strFileName As String Dim GYO As Long Dim Shell, myPath Set xlAPP = Application ' InputBoxでフォルダ指定を受ける vntPathName = xlAPP.InputBox("参照するフォルダ名を入力して下さい。", _ cnsTitle, "C:\") ' (1) strPATHNAME = vntPathName ' フォルダの存在確認 If Dir(strPATHNAME, vbDirectory) = "" Then MsgBox "指定のフォルダは存在しません。", vbExclamation, cnsTitle Exit Sub End If ' 先頭のファイル名の取得 strFileName = Dir(strPATHNAME & cnsDIR, vbNormal) ' ファイルが見つからなくなるまで繰り返す Do While strFileName <> "" ' 行を加算 GYO = GYO + 1 ' 先頭は1行目 Cells(GYO, 1).Value = strFileName ' 次のファイル名を取得 strFileName = Dir() Loop End Sub ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ これを行うと、A列にすべてのファイル名が書き出されます。 また、 動かしたいファイルが入っているフォルダと、ファイル名がわかっている場合は、 nameで動かせるのはわかりました。 例 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Name "C:\AAA\SAMPLE1.txt" As "C:\BBB\SAMPLE1.txt" ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ ※こうすると、AAAというフォルダにあったSAMPLE1が、BBBに移動します。 この組み合わせで何とかできるのではないかと思うのですが、 ここから先が見えません。 実際に行いたい処理は、 図面がたくさん入っているフォルダが対象のフォルダになります。 ※図面はzipファイルになっていますので、解凍をする必要があります。 ファイル名は、その時によって違うので、一旦 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝ C:\Users\Desktop\移動元 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝ というフォルダに格納します。 この中で、zipを解凍すると、 格納された複数のフォルダと2000個近くのファイルが出てきます。 ファイルの拡張子は特殊なものですが、ファイルを取り出すときに、 zip以外を取り出したいので、仮に、.xls .docとしておきます。 フォルダの名前やファイルの名前は図面の名称になっていますが、 今回は、 デスクトップ上の「移動先」というフォルダにすべてそのまま移動できればいいです。 ＝＝＝＝＝＝＝＝＝＝＝ C:\Users\Desktop\移動先 ＝＝＝＝＝＝＝＝＝＝＝ です。 実験用に、 デスクトップに、移動元というフォルダを作り、 その中に、子A、子B、子Cというフォルダを作り、 さらに、それぞれ、孫A、孫B、孫Cというフォルダを作りました。 それぞれの孫フォルダには、4つずつダミーファイルを入れました。 ※これが、解凍後の状態になります。 図面の拡張子は特殊なものなので、今回は、わかりやすいように、 xlsとdocにします。 A-A-1.doc、A-A-1.xls、A-A-2.doc、A-A-2.xls という感じです。 ファイル名は、A-A-1や、C-B-2のようにして、 それぞれ、 「子Aのフォルダの中の孫Aの1つ目」 「子Cのフォルダの中の孫Bの2つ目」 という意味になるようにしています。 書き出したリストと、 pathの組み合わせと、 For Nextもしくは Do Loopの組み合わせで なんとかなりそうなのですが、 頭の中が混乱して答えが導き出せません。 今週中に作らないといけないので、 お力をお貸しください。 よろしくお願いいたします。
http://www.jtw.zaq.ne.jp/animesong/a/index.html ↑のソースから正規表現を使って アークエとガッチンポー てんこもり アーケードゲーマーふぶき 等を抽出したのです。 教えてください。
こんにちは！ Accessについて、質問させていただきます。 追加クエリを５つ作成したのですが、『複数値を持つフィールドをINSERT INTO クエリに含めることはできません』とエラーが出ます。 調べたところ、ルックアップウィザードに追加クエリが使用できないものと思われます。 追加クエリの元になるテーブルには、ルックアップウィザードを適用しているフィールド（他のテーブルから値を取得している）が複数あります（フィールド名：取次名・担当者名・形態）。 ちなみに、５つの追加クエリのうち１つはルックアップウィザードのフィールド（値を手入力で設定）も１つありますが正常に作動しています。 何か解決策はありますでしょうか？ よろしくお願いします!!
FormのInputBoxに値をセットしようとすると実行時エラー438（VB6.0）になります。 何か考慮漏れがある為かと思います。初心者です。ご教示よろしくお願いします。 ---------------------------------------------------------------------- 環境（VB6.0 Excel2002 Windows7 IE10.0） ◇エラー状況 　　「objIE.Document.all.oil.Value = "20"」を実行すると、エラーする。　 　　　「実行時エラー438 オブジェクトは、このプロパティまたはメソッドをサポートしていません」 　　この記述で、１度だけ値をセットできたが、なぜうまくいったのかわかりません。 　 ◇親の画面（http://premium-club.jp/mygarage/mycarbox/KyuuyuR …）で 　「給油を記録する」ボタンを押すと、元の画面がかすかに見える状態で、 　　入力画面（フォーム）が表示される。 　　データ入力を実行 　　　objIE.Document.all.oil.Value = "20"　　　'⇒ Error 438 　　　objIE.Document.form1.oil.Value = "20"　　'⇒ Error 438 　　 ◇親画面のボタンはマクロで操作（クリック）できるので、 　　objIEは生きているようですが、なぜか、Error 438になります。 　　　Set objIE = CreateObject("InternetExplorer.Application") 'IEを開く 　　Object busyが気になり、ステップイン（pf8）で１行ずつ実行してみたが同じでした。 ◇HTMLコードは、IEの「F12開発ツール」で調べました。 　　<form name="form1" action="KyuuyuRecord" method="post">　' 　　　<TH>給油量<IMG alt=必須 src="/images/ico_hissu01.gif" 　　　<TD><INPUT name=oil>リットル ------------------------------------------------------------------------
VBA ( excel ) もしくは VB の プログラミング/プログラム についての質問です。 ユーザーフォーム上の所定のテキストボックス(Textbox1)のなかに、 現在すでに何らかの文字列が書かれていて、 そのなかの、どこかの部分に、 カレット（またはキャレット)(＝文字入力部分を示す点滅する縦棒） が有るとします。 この時 ユーザーフォーム上の、所定のコマンドボタン(Commandbutton1)を押すと、 例えば”あ”という文字が、現在のカレット位置に書き込まれる(挿入される)ようにするには、 どうすればよいでしょうか？ ただし、 クリップボードの内容を変えたくないので、 ”あ”という字をクリップボード経由でペーストする方式ではなくお願いいたします。 よろしく御指導お願いいたします。
さっそくですが質問に入ります。 VB.2012(.Net Framework3.5)で開発しています。 MDIの親画面、子画面を作成しています。子画面が表示された状態でキーボードでCtrl+F4を押してもなにもしないようにしたいのですが、どうすれよいでしょうか？ 画面右上の×印では通常通り画面を閉じられるようにしたいのですが、キーボード操作(Ctrl+F4)による画面閉はできないようにしたいのです。 よろしくお願いします。
さっそくですが、質問に入ります。 VB.NET 2012(.Net Framework 3.5)でフォームにテキストボックスを張り付けています。 テキストボックスにフォーカスがある状態でキーボードのEnterキーを押すと音がなります。 この音がならないようにしたいのですが、どうすればよいでしょうか？ テキストボックスのプロパティーは初期状態のままで何も変更してません。
お世話になります。 VB6の開発環境で困っております。 マシンは前任者から引き継いだWin7 の32Bitなのですが、 VB6のプロジェクトを開くと「オブジェクトライブラリは登録されていません」のメッセージが出てしまいます。 確認したところ、プロジェクトのコンポーネントにMscomctl.ocxが登録できない状況なのは確認できました。 ※登録時も同じメッセージで登録できません。 以下、試したこと VB6のSPやパッチをインストール VB6.0-KB290887-X86とVB60SP6-KB2708437-x86-JPN レジストリの削除 reg delete hkcr\typelib\{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}\2.0 /f レジストリの再登録等 C:\Windows\system32\regsvr32 /u C:\Windows\system32\mscomctl.ocx C:\Windows\system32\regsvr32 C:\Windows\system32\mscomctl.ocx　/u C:\Windows\system32\regsvr32 C:\Windows\system32\mscomctl.ocx C:\Windows\regtlib.exe C:\Windows\system32\mscomctl.ocx 前任者からの引き継ぎ（会ったことないけど）なので、いつの段階から事象が出ているのか判断つかず、システムの復元は行っておりません。
.net VB 2010 初心者です。VB　6.0は、少々分かります。 よろしくお願い致します。 .net VB 2010を使用して、CSVファイルを読み込みたいのです。 列は固定、行は可変です。 配列で、buf（行,列）のように読み込みたいのです。 これだと、１０行、３列目と実際とイメージが合致するからです。 これは、どのように実現可能か教えてください。 buf(10,3）ではなく、もっと良い方法があるのであれば、そちらをよろしくお願い致します。 列は、1列目：No.、２列目：フルネーム、３列目：略語、４列目：更新日 となっています。 なので、1行目のフルネームの取り出し、２行目の略語の取り出しでもOKです。 どうぞよろしくお願い致します。
2回目の質問です。前回も”VBでのカードゲーム作成”について質問させていただきました。 乱数発生については回答を頂きながらも自力で突破しました。申し訳ありませんでした。 回答者様には感謝しています。 さて、本題ですが2点質問させていただきます。 Menu.vb　をトップページとし、そこからボタンによる遷移でAloneGame.vb（一人プレイなので）という画面に移ります。 デバッグした際、トップページよりaloneに飛ぼうとしたところ、以下のエラーが発生しストップしました。 ---------------------------------------------------------------------------------- 'System.InvalidOperationException' のハンドルされていない例外が poker.exe で発生しました。 追加情報: フォームの作成中にエラーが発生しました。詳細については、Exception.InnerException を参照してください。エラー: オブジェクト参照がオブジェクト インスタンスに設定されていません。 ---------------------------------------------------------------------------------- （自力でポーカーを作っています。） 自分でも検索したり調べてはいますが、現在行き詰まっております。 今回は上記の質問がメインですが、前回に引き続きアニメーションについても質問させていただきたいと思います。 前回も少し書きましたが、 □□□□□　　　相手手札。伏せてあり、裏の模様のみ。 □□　　　　　　　　片方が山札、片方が捨て札です。 □□□□□　　　自分の手札。 暫定的ではありますがこのような形です。 ソリティアなどのように、山札から手札が配られるというアニメーションを付け加えたいのですが、どうしたらいいのでしょうか？ 尚、コードすべてを書いていただかなくても、参考書籍、参考ホームページを教えて頂く形でももちろん結構です。 私自身も随時調査中ではあります。 わかりにくいとは思いますがどうぞよろしくお願いします。 この質問を答えるにあたって欲しい情報がありましたら何なりと。
こんにちは。C#で仮想メソッドの勉強をしています。Form1でボタンを押すとフォームが閉じるメソッドを書きました。 Form2でoverrideしてメッセージボックスを表示するようにメソッドを再定義しました。 ここで問題なのですが、Form2でcmdCloseボタンをクリックすると「閉じます」というメッセージを表示した後に、もう一度「閉じます」というメッセージが表示されます。 2回メッセージが表示されるのが腑に落ちなく、何が原因なのかお教え頂きたく思います。よろしくお願いします。 Form1 /******************************************************************************/ // フォームクローズ /******************************************************************************/ protected virtual void cmdClose_Click(object sender, EventArgs e) { this.Close(); } Form2 /******************************************************************************/ // フォームクローズ /******************************************************************************/ protected override void cmdClose_Click(object sender, EventArgs e) { MessageBox.Show("閉じます"); }
VBAを使っていて第二種ベッセル関数を使いたいのですが worksheetfunctionだと計算に時間がかかるため これを使わずに計算する方法を教えてください、 以前、どこかのwebページで近似式を見かけたような気がするのですが どこかに書かれてあるページがあれば教えてください。
初めて投稿します。よろしくお願い致します。 Excel上でダブルクリックしたセルの内容を、次のようにしたいと思っています。 ダブルクリックしたフォーカス位置より左側　→　現セルに残す ダブルクリックしたフォーカス位置より右側　→　右側のセルの値の先頭につける 知りたいことは、アクティブセルのフォーカスの位置（左から何文字目か？）を取得できるものでしょうか？ ご教授頂ければ幸いです。 以上
初めて質問させていただきます。VBAとマクロを勉強中なのですが、数値だけのcsvデータ(3万行くらい)をマクロで処理するように指示されて困っています。 ●ファイルの内容(概要) ＜Sheet1＞ A列：性別(男性:1、女性:2でコード化) B列：死因コード(数値5～6桁) C列：年齢 D列：市町村(3桁でコード化「201」等) ＜Sheet2＞ ・「セルA1」に表にしたい市町村コードをあらかじめ入力しておく ・セルB1～セルEC1まで死因コード ・セルA2～セルA132まで年齢0～130 ・セル範囲B2～EC132に市町村1の男性の値が入る ・セルB133～セルEC133まで死因コード ・セルA134～A264まで年齢0～130 ・セル範囲B134～EC264に市町村1の女性の値が入る Sheet2にはあらかじめ表を作成しておき、行と列の値を参照してSheet1で一致する値が、列と行が交わるところの空白セルに入力した市町村コードと一致していることもふるいにかけられ、表で結果としてカウントされるときには男女別に分かれるようにしたいのですが可能でしょうか？ ややこしくて申し訳ありません。繰り返しあらかじめ作成された表にカウント結果を入力させる記述はヒントを頂ければ頑張ります。 なので、4つの条件に一致した場合にカウントして別シートに返すにはどうしたらいいのか助けていただけますと幸いです。 それと、シート1の最終行は決まっていません。
フォームツールのコンボボックスを大量に作ろうと考えています。 以前にコントロールツールで作ったのですが結構重い為、今回フォームツールで作成したいのです。 その際、ドロップダウンリストの行を増やすにはどうしたらいいでしょうか？ コントロールツールの時は下記コードで Object.ListRows = 20 で増やすことができたのですが、フォームツールの場合サポートしていませんとでます。 VBAで行を増やす事はできないでしょうか？ 素人質問ですみません。 Sub　Sheet1() Dim sh As Worksheet Set sh = Worksheets("Sheet1") For i = 1 To 100 l = sh.Cells(i, "E").Left t = sh.Cells(i, "E").Top w = sh.Cells(i, "E").Width h = sh.Cells(i, "E").Height With sh.OLEObjects.Add(ClassType:="Forms.ComboBox.1") .Left = l .Top = t .Width = w .Height = h .ListFillRange = "担当者" .Object.ListRows = 20 .LinkedCell = "E" & i .PrintObject = False End With Next i End Sub
VBA初心者です。Excel2007、XPを使用しています。 A列からQ列、平均100行程度の顧客データがあります。 F列に型番（アルファベット+数字等）が記入されており、 その型番内に「半角もしくは全角スペース」が含まれている場合、 該当があった行の下へ、該当行をコピーした内容を追加したいです。 できれば、スペースがある数だけ挿入し、 かつ該当行、挿入行に色付け出来ればなお良いです。 ご教授頂けないでしょうか。 宜しくお願い致します。
エクセルのセル「G9～G1508」に1-78までの数字をランダムに表示させるマクロを作成したいです。 一応自分で作成したのですがなんの事やら分からず… どういう記述をすればよろしいのでしょうか？
以下の2つのサイトを参考にIEの自動処理を作っています。 「IE 画面を、スクリプトで操作する (パソコン便利ツール集)」 http://makoto-watanabe.main.jp/htmlDOM.html 「WSH JScriptを使いこなそう ～キーボード操作～」 http://3rd.geocities.jp/kaito_extra/Source/Keybo … そこで簡単なhtmlページを作り、javascriptの「confirm」を使って確認メッセージを表示しました。 この確認メッセージの「OK」か「キャンセル」をVbscriptの「SendKeys」を使ってコントロールしようとしてるのですが全く反応しません。 何がいけないのでしょうか？ もちろん確認メッセージはアクティブの状態です。 開いたIEのオブジェクトなどでコントロールしないといけないのでしょうか？ ちなみに、html内のjavascriptは次のようにしています。 <script Language="JavaScript"> <!-- confirm("よろしいですか？") //--> </script> Vbscriptは次の通りです。 Set objWshShell = Wscript.CreateObject("Wscript.Shell") Set objIE = CreateObject("InternetExplorer.Application")'IEの起動 objIE.Visible = True 'IEウィンドウを表示 siteurl = "http://テスト用のサイト/test.html" objIE.Navigate2 siteurl'指定ページを開く While objIE.ReadyState <> 4 Or objIE.Busy = True WScript.Sleep 1000 Wend objWshShell.SendKeys("{enter}") objIE.Quit Set objIE = Nothing WScript.quit
図１のような表があります。 やりたいことは次の(1)～(3)です。 (1)　黄色の部分に適当な数字を入力します。（今仮に２５０００とします。この部分は変数です。） (2)　図１の表の中から最も近い値を緑の部分に表示するとともに、その数字のセルを赤でマークします。（行６－列７の２５１００になります） (3)　(1)と(2)の差をピンクの部分に表示します。（絶対値で）（１００になります） これを自動でやりたいのですがどうしてもできません。 関数や、テーブル検索のプログラムでもかまいませんので、ご存知の方どうかお知恵をお貸しください。 これができると、大変助かります。 よろしくお願いいたします。
Vb .net オブジェクトの属性に応じて値を文字列に加工して渡したいです。 DataTableのセルやStringやIntegerやdateなどの値が渡されることを想定しています。 postgresqlのWhere句に渡す事を想定しています。 strTmp = TestTest(Object1) strSql = "Where item1 = " & strTmp ＜内容＞ ・オブジェクトの値がDBNull.Valueなら文字列で"null" ・数字属性の場合、 　文字列に変換して数字を渡す ・日付属性の場合、 　文字列に変換して値を渡す ・文字属性の場合、 　シングルクオートした値を渡す。 ・上記以外は文字列で"null"を渡す。 ＜書きかけ＞ function TestTest(byref p01 Object) As String dim aaaa as object dim bbbb as string if aaaa is DBNull.Value then bbbb = "null" else Select Case aaaa 属性 Case 数字の場合 bbbb = aaaa.toString Case 文字の場合 bbbb = "'" & aaaa.toString & "'" Case 日付の場合 bbbb = "'" & to_timestamp('" & Format( aaaa, "yyyy.mm.dd hh:nn:ss" ) & "', 'YYYY.MM.DD HH24:MI:SS')" Case Else bbbb = "null" End Select end if Return (bbbb) end function ＜メモ＞ ・属性の判定方法が分かりません。 ・何か見落としている事はありませんか？ 以上、よろしくお願いします。
可能かどうかわかないので教えて下さい。 作成中のVBScript処理内に、ある外部コマンドを利用します。 現在はコマンドを外部から呼び出し実行を行っていますが どうにか、その外部コマンドをVBS内に取り込んで実行させる事が出来ればと考えています。 （単体実行させたい） 一度、その外部コマンドをstreamデータでバイナリとして読み込んでおいて バイナリデータの内容をAという変数に持たせておけば、あとはその変数Aと実行すると 読み込んだ外部コマンドと同じ動きをしてくれたら嬉しいなぁと、、、。 ご教示願いします。
文字列を数式に変換する標準モジュール「EVALUATE」の更新が不安定です エクセルシート内の文字列を数式に変換して、計算結果を返すために下記標準モジュールを登録して試すのですが うまく行ったりいかなかったり、標準モジュールが安定して機能しない原因などが分かりません。 ●現在の設定とやりたいこと (1)Ａ１⇒=myEvalAry(B1)、B1⇒C1+D1、C1⇒2、D1⇒5 として、A1にC1+D1計算結果の7を表示させたい (2)一つのシートの中に、myEvalAry標準モジュールを数百使っている (3)一つのセルの中で、=myEvalAry(B1)+myEvalAry(B2)のように標準モジュールを複数使っているセルもある ●現在の状況 上記状態で、何かのタイミングで標準モジュールの計算結果が一気に全て正しく反映されることもあれば、 急に反映されなくなることもある。１００のうち１０だけ反映されることもある。 というような不安定な状態です。 しかも数量が問題かと思って、多量に登録していたmyEvalAryのセルを１つだけにして動きを確認しようとしたらまた反映 されなかったりで、全然理由が分かりません。 どこか標準モジュール内に、考慮すべき構文が漏れたりしてるのでしょうか？？？？ 正常稼働しない理由が分かると大変ありがたいです。win7、win8、excel2003、excel2013のいずれの環境でも同様です。 /////////////////////////////////////////////////////// Function myEvalAry(ParamArray ItemR()) As Variant Dim re As Variant Dim strTmp As String Dim varR As Variant Dim i As Variant, j As Variant strTmp = "" varR = ItemR() For Each i In varR If IsArray(i) Then '引数が配列の場合 For Each j In i If IsNumeric(j) Then re = CStr(j) Else re = j End If strTmp = strTmp & re Next Else '引数が配列以外 If IsNumeric(i) Then re = CStr(i) Else re = i End If strTmp = strTmp & re End If Next myEvalAry = Application.Evaluate(strTmp) End Function
下記VBAでコンパイルエラーを起こして進みません 解消法をご教授いただけると幸いです やりたいこととしては ボタンで任意のタブ区切りのテキストを指定し 特定のシートに値をコピーすることです ---- Private Sub CommandButton1_Click() Dim Sh As Worksheet Dim FileN As String Set Sh = ThisWorkbook.Sheets("import") ' <-- 読込みシート指定(※) FileN = Application.GetOpenFilename("テキストファイル,*.txt") If FileN <> "False" Then Workbooks.OpenText Filename:=FileN, StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlTextQualifierNone, Tab:=True End If Set Sh = Nothing End Sub ----
textboxにID入力し、ENTERを押したらそのIDのデータがアクセスのデータベースから出力される、というプログラムを書き方のヒントを教えていただけないでしょうか。 Imports System.Data.OleDb Public Class Form1 Private Sub Enter(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Enter '▼データの取得 Dim Cn As New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Database\Animals.mdb") Dim SQLCm As OleDbCommand = Cn.CreateCommand Dim Adapter As New OleDbDataAdapter(SQLCm) Dim Table As New DataTable SQLCm.CommandText = "SELECT * FROM T_akusesu" Adapter.Fill(Table) '▼データの連結 textbox.DataBindings.Add("Text", Table, "名前") textbox2.DataBindings.Add("Text", Table, "フリガナ") Table.Dispose() Adapter.Dispose() SQLCm.Dispose() Cn.Dispose() End Sub End Class ・アクセスデータ 　ID、名前、氏名 以上、よろしくお願い致します。
Excel 2003 VBAにて、 PDFファイルを開き、印刷し、閉じるマクロを作りたいと思っています。 Dim AA, AAA AA = "C:\Program Files\Adobe\Reader 11.0\Reader\AcroRd32.exe C:\Scan\20131101160734050_001.pdf" AAA = Shell(AA, vbNormalFocus) にて、PDFファイルを開くことは出来ました。 このPDFファイルを、「印刷し、閉じる」ためには、 このPDFファイルを指定する必要があると思いますが、 その構文が判りません。 知っている方、教えて下さい。
Visual basic 2010を使用しています。 「 Datetimrpickerの選択が今日ならComboBox1の選択をTextbox1へ表示」 というプログラムを書きたいのですが、datetimepickerの扱い方がわからず、うまくいきません。 たとえばComboBoxなら、「ComboBox.items.item(0)」で一番上、 つまり今日の日付を取得できるのですが、「datetimepicker.items.item(0)」だとdatetimepicker のメンバーではないというエラーが出て実行できません。 以上、宜しくお願い致します。
　いつも大変お世話になっております。 　VB2005でプログラミングしています。 　PictureBoxにBitmapを入れて表示させているのですが、それをそのまま拡大していくと（表示されていないところを消さない限りは）いつかはメモリ不足になります。 　これまでは、評価した結果でメモリ不足にならない倍率に上限を設定していたのですが、よりメモリが大きいＰＣならもっと拡大できるはずなので、拡大率の上限を緩和する、というバージョンアップを行うことにしました。 　エラーが出たらそれを回避して、そのＰＣではそれ以上拡大しないようにしたいと思うのですが「メモリ不足」はどこで起こるか言っていでなく、Try～等の命令では網羅できていません。 　恐れ入りますが、メモリ不足になってもエラーにならず戻れるよい方法がありましたらご教示いただけますと幸いです。
for i=1 to 10 step 4と書くと i=1 5 9の順番だと思いますが、 一番最後のi=10も処理して欲しいのですが、 そのようなことは出来ますか？
visual basic 2010を使用しています。 ■質問内容 ・EnabledをFalseにしてもクリックでボップアップ表示させる方法 ・他の方法で書き込み禁止にし、クリックでボップアップ表示させる方法 テキストボックスをクリックすると、ボップアップで内容が表示されるプログラミングをしたのですが、テキストボックスへの書き込みを禁止するためにプロパティからEnabledをFalseにすると、ボップアップされなくなってしまいます。 'テキストボックスには、コンボボックスから複数取得された内容が入っていますので、変数に入れました Private Sub textbox_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles textbox.Click Dim a As String a = textbox.Text MsgBox(a) End Sub 以上、宜しくお願い致します。
初心者です。 ある実行結果を持っている変数から、新たにリテラル文字列として変数を 代入する要件があり、クリアできず非常に困っています、、、。 どなかたご教示頂ければと思います。 以下例、変数Aのリテラル定数を変数Bに代入したいのですがやり方がわかりません。 (単純にリテラル文字列として渡したいです。) 【例】 -------------- A = "123" const B = A msgbox B -------------- よろしくお願いします。
ExcelのSlope関数をVBAで繰返し処理させたいのですが、自分が作製したプログラムですと、処理に時間がかかってしまう事がわかりました（正常動作はするのですが、Excelの動きが鈍い）。 動きが遅くなってしまう部分はおそらくここだろうと部分をピックアップしたので、処理が軽くなる方法がわかる方いらっしゃいましたら、教えて下さい。宜しくお願い致します。 i = 1 n = 55 Do While i < 3 i = Sheets("Sheet2").Cells(n, 2) n = n + 1 Loop n = n - 2 Worksheets("Sheet3").Range("Q16").Formula = "=Slope(Sheet2! C55:C" & n & ",Sheet2!B55:B" & n & "）" Worksheets("Sheet3").Range("Q17").Formula = "=Slope(Sheet2! E55:E" & n & ",Sheet2!D55:D" & n & "）" Worksheets("Sheet3").Range("Q18").Formula = "=Slope(Sheet2! G55:G" & n & ",Sheet2!F55:F" & n & "）" ・ ・ ・ ・ ・ Worksheets("Sheet3").Range("Q28").Formula = "=Slope(Sheet2! AA55:AA" & n & ",Sheet2!Z55:Z" & n & "）"
VB.NETからDLLを呼び出したいのですが、これが私のコンピューターと 顧客側のコンピュータとで環境が違う為、毎回ファイルの場所を変えて 使用しています。（ソース内のファイル場所を毎回書き換える） これを、hostnameの取得により、私のパソコンとその他の環境とで 呼び出す状況を変えたいと思っております。 どの様にすれば良いか、教えて下さい。 Windowsの環境変数のPATHに書き込みはしたくありません。 あくまで、プログラム内で終わらせたいのですが・・ （ソース例） ’↓固定変数でないとダメ？ Public Const MyDllFileName As String = "\\ServerName\Kyouyu\MyDllFile.dll" 'Type(1) Public Declare Function ExportDLL1 Lib MyDllFileName (ByRef MyData As MyStructure) As Integer 'Type(2) <DllImport(MyDllFileName)> Public Function ExportDLL2(ByRef MyData As MyStructure) As Integer End Function
Excel2007でマクロ作成中の初心者です。 以下のコードの中で(1)のところがうまく作動できません。 ここの ActiveCell.Select　を正常にするにはどうしたらよいかご教示をお願いします。 Sub 最終日の検索() Dim FC As Range Dim mydate As Date mydate = Range("BQ5").Value For Each FC In Range("BR30:BR300") If FC.Value = DateValue(mydate) Then Exit For End If Next If FC Is Nothing Then MsgBox "みつかりませんここでおわりです" Exit Sub End If MsgBox "見つかりました" & vbLf & FC.Address(0, 0) & vbLf & FC.Value ' ' ここに処理を追加したい ActiveCell.Select　’----------(1) Selection.Offset(0, 45).Select ActiveCell.Select 貼付けしてあるかどうか Set FC = Nothing End Sub ---------------------------------- Sub 貼付けしてあるかどうか() If ActiveCell.Value = "※※" Then MsgBox " 既に貼付けしてあります" Else MsgBox "貼付けしてないので処理します" End If End Sub
お世話になります。 VBAの初心者です。 以下のマクロを組もうと考えているのですが、いまいち理解できていないようで エラーが多発します。 どのようなコードを書けばいいのかアドバイスをお願い致します。 マクロを組みたい部分としては下記の3つです。 ・A列の氏名をSplit関数を使って半角スペースで分割⇒A列に名字、B列に名前 ・E列の郵便番号をSplit関数を使って-で分割⇒E列に上3桁、F列に下4桁 ・G列の住所を、G列⇒都道府県、H列⇒市区町村、I列⇒番地以下 またその際に下記の3点のようにしたいです。 -毎回入力されている行の数が違うため、自動で最終行を取るようにしたいです。 -郵便番号はF列は4桁の数字として入るように表示形式を設定 -I列はテキストとして表示形式を設定 本来であれば、一度自分で書いたものを掲載してアドバイス頂くべきなのでしょうが どのようにコードを書けばいいのかすら分からず困っています。 お手数ですが、よろしくお願い致します
エクセル2000。VBAでコンボボックスを作成したのですが、ドロップダウンリストの表示する行の増やし方が分かりません。” 担当者”は20セル（人）指定しています。 プロパティからならListRowsを8から変更すればいいだけなので分かります。ですがVBAで実施したいです。ドロップダウンリスト表示を20に増やすにはどうしたらいいでしょうか？かなり困っていますのでどうぞ宜しくお願いします。 Selection.ListRows = 20 を足したところ、実行時エラー438「オブジェクトは、このプロパティまたはメソッドをサポートしていません。」となりました。 Sub test() Dim sh As Worksheet Set sh = Worksheets("Sheet1") For i = 1 To 100 l = sh.Cells(i, "H").Left t = sh.Cells(i, "H").Top w = sh.Cells(i, "H").Width h = sh.Cells(i, "H").Height sh.OLEObjects.Add(ClassType:="Forms.ComboBox.1", _ Left:=l, Top:=t, Width:=w, Height:=h _ ).Select Selection.ListFillRange = "担当者" Selection.LinkedCell = "H" & i Selection.PrintObject = False Next i End Sub
マクロ初心者です。 前任者のマクロファイルで不具合があり、直したいのですがわかりませんので教えてください。 ActiveCell.Offset(0,34).FormulaR1C1="=R[-1]C*R[-1]C[-3]"'自動機部品費小計挿入 ActiveCell.Offset(0,35).FormulaR1C1="=R[-1]C*R[-1]C[-4]"'自動機部品費小計挿入 上の式で、[-3]と[-4]の位置のセルが空白の時に、0と認識して、答えが0になってしまいます。 空白は、1と認識して計算するようにするには、どのような式にすればよいのでしょうか。 ご教授願います。
お世話になります。 下記のVBAソースで、特定のフォルダにあるエクセルを全て 開く処理をしているのですが、スマートに行えているか 疑問に思いました。 具体的には、「'''''''''時間がかかっている？？」箇所で 無駄なこと・時間がかかっていないか疑問です。 目的としては、「vba で全てのエクセルファイルを開く処理」ですので、 (1)皆さんがされている「vba で全てのエクセルファイルを開く処理」 (2)下記ソースの「'''''''''時間がかかっている？？」は時間がかかっていないか の、どちらかで、結構ですのでご返事頂ければ有り難いです。 宜しくお願いします。 ------------ソース----------------- ChDir (ThisWorkbook.Path & "\" & フォルダ) fileName = Dir("*.xls") Do While fileName <> "" If fileName <> ThisWorkbook.Name Then IsBookOpen = False '''''''''時間がかかっている？？ For Each OpenedBook In Workbooks If OpenedBook.Name = fileName Then IsBookOpen = True Exit For End If Next '''''''''時間がかかっている？？ If IsBookOpen = False Then Workbooks.Open (fileName) End If End If fileName = Dir() Loop
当方エクセル初心者で、プログラミングはほぼ分かりません。 詳しく教えていただきたいです。 エクセル2007で、sheet1からsheet2にコピー＆ペーストする、というようなマクロを組みました。 そのマクロだと、ペーストする先のセルに何かが入力されていても、上書きされて消えてしまいます。 なので、その場合にポップアップなどで知らせる(キャンセルする)機能をつけることはできますか？ 例えば、「入力先のセルに既にコマが入っています。置き換えますか？→はい/キャンセル」のような感じです。 よろしくお願いします。
お世話になります。 vbaで、下記の様なif文があるときに、 iは、1,2,3のどれで合致しているか判別する方法はありますか? 現在は、下記のように処理(1)を繰り返し、書いているのを 一度で済ませたいと思っています。 -------現在---------------- if i=1 then '処理(1) 'iの値が1の時の処理 elseif i=2 then '処理(1) 'iの値が2の時の処理 elseif i=3 then '処理(1) 'iの値が3の時の処理 endif ----------------------------------- ----------------理想--------------------------- if i=1 or i=2 or i=3 then '処理(1) ★★ここの時点でiの値を取りたい endif '処理で、iの値によって分岐 ------------------------------------------
Accessのフォームに 、WebBrowserコントロールを貼り付けて、 JavaScript が記述されている、HTML を表示させているのですが、 その HTML内の JavaScriptから、Access VBAの関数を呼び出したり、 イベントを発生させることは、可能でしょうか？ 以上、宜しくお願い致します。
初めまして。 プログラミングを始めた初心者なのですが、Visual Studio express 2010で、テキストボックスのマスク処理をするにはどうしたらいいのでしょうか。 premiumにはテキストボックスのプロパティから設定できたのに、expressですとプロパティにマスクが無くて困っています。
VBAでIE操作をするサンプルをネットでいくつか見ているのですが Sub Sample1() Dim objShell As Object Dim objIE As New InternetExplorer Set objShell = CreateObject("Shell.Application") objIE.Visible = True objIE.Navigate "http://www.yahoo.co.jp/" Set objIE = Nothing Set objShell = Nothing End Sub Sub Sample2() Dim objIE As InternetExplorer Set objIE = CreateObject("InternetExplorer.application") objIE.Visible = True objIE.Navigate "http://www.yahoo.co.jp/" Set objIE = Nothing End Sub ではどちらを使った方がいいのでしょうか？ 圧倒的にSample2の方がネットでは多いのですが Sample1のやり方もあることを知りました。 Sample1の方法でブラウザを開くメリットはあるのでしょうか？
お世話になります。 VBAの文字列の置換で教えてください。 replaceを使用したときに、置換対象の文字がなかったら、 「元の値をそのまま返す」という形なのですが、 置換対象がなかったときは、その旨わかるようにしたいのですが、 方法あるでしょうか？ ※毎回replaceの前でfind関数であるかないか、調べないと いけないのでしょうか？ 何卒宜しくお願いします。
同一Book内のすべてのシートから、指定した語句を検索する方法についてお聞きします。 検索と置き換えのダイアログボックスを表示させ、キーワードを入力しても、表示しているシートからしか検索することが出来ません。 この検索と置き換えのダイアログボックス、もしくは、ユーザーフォームを使って、すべてのシートから検索するにはどのような方法があるのですか。 ご回答宜しくお願いします。
vb .net Winアプリでコンボボックスに値をセットする方法を教えて下さい。 table1 都道府県コード,都道府県名(カナ),都道府県名 01,ホッカイドウ,北海道 02,アオモリケン,青森県 03,イワテケン,岩手県 のテーブルがあり、既に読み込んでいます。 このデータをコンボボックスにセットしたいです。 Dim NpgsqlConnection1 As NpgsqlConnection Dim NpgsqlCommand1 As NpgsqlCommand Dim NpgsqlDataAdapter1 As NpgsqlDataAdapter Dim String1 As String Dim DataTable1 As DataTable NpgsqlConnection1 = New Npgsql.NpgsqlConnection NpgsqlConnection1.ConnectionString = gstrCnct NpgsqlConnection1.Open() String1 = "select * from table1;" NpgsqlCommand1 = New NpgsqlCommand NpgsqlCommand1.Connection = NpgsqlConnection1 NpgsqlCommand1.CommandText = String1 NpgsqlDataAdapter1 = New NpgsqlDataAdapter(String1, NpgsqlConnection1) DataTable1 = New System.Data.DataTable NpgsqlDataAdapter1.Fill(DataTable1) ' 一括の方法でもＯＫ ' Me.ComboBox1.？？？ = ？？？？ ' ぐるぐるしながらセットでもＯＫ ' Me.ComboBox1.？？？ = Space(0) ' Me.ComboBox1.？？？ = "ミセンタク" ' Me.ComboBox1.？？？ = "未選択" For Each DataRow1 As DataRow In DataTable1.Rows ' Me.ComboBox1.？？？ = DataRow1("都道府県コード") ' Me.ComboBox1.？？？ = DataRow1("都道府県名(カナ)") ' Me.ComboBox1.？？？ = DataRow1("都道府県名") Next DataRow1 ■要件 メインの情報は都道府県名ですが、 めくった時に 都道府県コード,都道府県名(カナ),都道府県名 を見せる形で作りたいです。 都道府県コードは取り出す必要があります。 データ １行目は空白,ミセンタク,未選択 ２行目以降はtable1から取り出した値。 以上、よろしくお願いします。
複数開いているブックを、名前の指定はせずに順番に切り替える方法が分からずに困っています。 例えば、Book1、Book2、Book3を繰り返して切り替える等です。 どのような方法がありますか。 ご回答宜しくお願いします。
Excelでメッセージボックスの使い方についてお聞きします。 下記のコードを実行します。その時、メッセージボックス上に入力したセル番地（A1)、「こんにちは」という語句をそれぞれ表示させるにはどのような方法があるのでしょうか。 宜しくお願いします。 Range("A1").Value = "こんにちは"
VB6からエクセルを立ち上げて、 有る特定の範囲のセルをコピーすることは出来ますでしょうか？ よろしくお願いします。
VB.NETの開発でアプリの実行端末にDB接続の環境がない可能性を考えてWebアプリとの連携を考えています VB.NETで開発したフォームのDataGridViewに表示するデータをWebアプリ(ASP、サーブレットなど)と連携するためにはどうすれば良いですか？ 考えているのは単純にURLにパラメータを付けてReqeustして結果をカンマ区切りなどで出力したデータをResponseし、一行ずつ分解してDataGridViewの項目に設定していけばいいのかな？って思っています。 他に良いやり方などあれば教えて頂きたいです。
VB6でwinsockというオブジェクトを使っていて、 tcpClient.Protocol tcpClient.LocalPort tcpClient.RemoteHost tcpClient.RemotePort というコマンドを使うのですが、 これらを記述したコマンドを標準モジュールに記述すると動作しません。 通常のフォームに記述したら動作するのですが、 他のソフトでも使うので標準モジュールに記述したいです。 このようなことは出来ますか?
全行数の取得はできたのですが、 テキストファイルの中で、文字を検索して、その検索文字のある行番号を取得したいのですが、 どうやったらいいですか？ （accessからテキストファイルを開いて読みこんでいます）
社内のとある装置の測定値を関係者みんなが閲覧できるよう、 インターネットで公開するためのウェブアプリを作成しようと思います。 ウェブアプリは、PHP + MySQL を考えています。 まったく素人で、勉強しつつ作成していくことになります。 そこで質問なのですが、 1. 測定機器から値を収集してウェブサーバ上のDBに登録する処理を、 C#のプログラムで作成しようと思いますが、 ローカルで動作するC#のプログラムからウェブDBへの登録は可能でしょうか？ 2. 1.が可能な場合、どのくらいのレスポンスになるものでしょう？ もちろんデータ量やPCや回線の能力にもよると思いますが... 例えば、500バイト程度のレコードを3000件ほど定周期で登録したいのですが、 周期をなるべく短いものにしたいです。 数秒周期？十数秒周期？数十秒周期？数分周期？ 大雑把に分かりませんでしょうか？ 3. 運用に必要な情報（例えば、ユーザID,PW等）もウェブDBに登録したいのですが、 設定項目が多くウェブアプリではメンテしづらいのと、 既存VB.NETのプログラムがあるためこれを活かしたいということで、 ローカルのVB.NETのプログラムからウェブDBへの登録は可能でしょうか？ よろしくお願いします。
VB6で関数の戻り値に配列を設定できるのでしょうか？
プログラム中にコマンドボタンを押す動作はどのように記述すればよいのでしょうか？ コマンドボタン1を押して、その処理をしている途中にコマンドボタン2を押したいです。 Private Sub Command1_Click() 途中にコマンドボタン2を押したい。 End Sub
VB6です。 テキストの数字が変更されときにメッセージを出したいのですが、 changedを使うと、例えば5から10に変更した時に最初の1を入力しただけでメッセージが出てしまいます。 10と入力してコマンドボタンを押すなりカーソルを別のテキストボックスに移動したときに、メッセージを出すことは出来ますか？
罫線や色がつけられたコピー先のエクセルファイルに値だけ貼り付けて、データを転記しようと考えています。 .Worksheets(1).Range("B2:B145").Copy xBk.Worksheets(1).Range("C5").xlPasteValuesのような式をかきまし たが、貼り付け先では、値だけコピーされず、罫線や色の情報が失われてしまします。 値のみを転記し、罫線や色、フォントの情報を残すには、どのようにコピー文を書き換えればよろしいでしょうか。 お手数をおかけいたしますが、よろしくお願いいたします。
エクセルVBAでPDFを作成したい<http://oshiete.goo.ne.jp/qa/8318460.html > の派生質問になります。 エクセル2000　Windows7の環境下で CubePDFというアプリケーションをVBAで操作しています。 出力ファイルに保存したいファイル名をいれるのですが、 ひらがなカタカナ漢字などの２バイト文字がパス名にあると うまくコピペできません。 例） ↓で保存したい 　～～\Desktop\新しいフォルダー\12345.pdf ↓アプリケーション内 出力ファイル 　～～\Desktop\V6{tH_[\12345.pdf ↓メッセージ ×CubePDF エラー パスの一部が見つかりません。 パス名が１バイト文字なら問題ありません。 どのように指示をすれば良いのでしょうか？＞＜； 調べたのですが、 Unicode？Shift_JIS に自動で対応してくれない？B付きの関数？URL形式でエンコード？ 等々、初心者には？？？の連続で。。。 VBAはA1セルにあるパス名（ファイル名）でPDFを作成保存するVBAです。 Declare Function FindWindow Lib "user32.dll" Alias "FindWindowA" _ (ByVal lpClassName As String, _ ByVal lpWindowName As String) As Long Declare Function SetForegroundWindow Lib "user32" _ (ByVal hwnd As Long) As Long Sub PDF作成() ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, ActivePrinter:="CubePDF on Ne05:" '↑ActivePrinter:="ここを変える"　マクロの記録などで確認　<プリンタの設定> Do cuHw = FindWindow(vbNullString, "CubePDF 1.0.0RC4 (x86)") Loop While cuHw = 0 '↑CubeBDFのウインドーが開いたかどうかを確認（この段階ではまだアクティブになるまで若干間がある） SetForegroundWindow cuHw '↑CubeBDFのウィンドーをアクティブ化 Dim Fname As String Fname = Range("A1") 'ファイル名を取得 PresentPrinter = Application.ActivePrinter With CreateObject("Wscript.Shell")　'保存先の所まで移動して名前をつける .SendKeys "{TAB}" .SendKeys "{TAB}" .SendKeys "{TAB}" .SendKeys "{TAB}" .SendKeys "{TAB}" .SendKeys Fname .SendKeys "{ENTER}" End With Application.ActivePrinter = PresentPrinter End Sub 質問内容に不明な点がありましたら、補足説明させていただきますので、 よろしくお願いいたします。
お世話になります。 VBAでエラーが起こった時の分岐処理を記載したいと思っています。 私が知っているのは 「On Error Resume Next」 なのですが、次の行に進みたいわけではなく、 a = b+c 　　　-(1) が成功したら Z=a エラーを発生したら Z=0 という形で ・エラーの発見対象は(1)のみ※他の箇所でエラーが発生しても、関係なし ・(1)の時のエラーの有無で処理を切り分け したいのです。 お手数ですが、何卒宜しくお願いします。
お世話になります。 C#.NETまたはVB.NETでiPhoneから送られたメールを解析するメーラーを作っているのですが、 charset=iso-2022-jp-2、charset=iso-2022-jp-3で送られてくる場合があり、 そのデコードができずに困っております。 charset=iso-2022-jpですと、下記でデコードできるのですが、 charset=iso-2022-jp-2、charset=iso-2022-jp-3はそもそも Encodingクラスで扱えるエンコーディング名に存在しないので、 どのように変換してよいか分かりません。 string mailtext = "？"; // ←メール内容をそのまま入れます byte[] bytes = Encoding.ASCII.GetBytes(mailtext); string body = Encoding.GetEncoding("iso-2022-jp").GetString(bytes); 宜しくお願い致します。
「Office TANAKA」のホームページを参考にして、Excelをデータベース的に使用したいと考えています。 あるセルに検索条件を入力して、条件に合うセルを検索したいのですが、検索条件はWeb検索のように、以下の(1)～(3)ように入力したいと思っています。 (1)検索ワードをスペースで区切るとAND検索 (2)検索ワードをORで区切るとOR検索 (3)検索ワードの前に、－を付けるとNOT検索 【例】 あ　い　（う　OR　え）　－お ※上記の例は、「あ」を含み、かつ、「い」を含み、かつ、「う」または「え」を含み、かつ、「お」を含まないセルを検索する条件です。 仕事でAccessのないPCで、Excel VBAを駆使してデータベース的に使用したいと思っています。 どうか、ご協助ください。よろしくお願い致します。
下記は０～９が重複せずに３つ、順番も考慮してシートに出すものです。 いわゆる=PERMUT(10,3)、数学で言えば10P3を力技で求めるもの。 さて、３つ程度のループなら下記のようにｉｆを書いても良いのですが これが多重になればなるほど、ifが増えるので面倒になります。 なにか賢いアルゴリズムあったらご教示ください。 （使用目的は頭の体操、例えばポーカーの役の１回目に出る確率とかです。 　本計算とは関係ありませんが、理屈で考えたものを検証したい為です。） Sub test() r = 2 For a = 0 To 9 For b = 0 To 9 If b = a Then GoTo 10 For c = 0 To 9 If c = a Then GoTo 20 If c = b Then GoTo 20 Cells(r, 1) = a Cells(r, 2) = b Cells(r, 3) = c r = r + 1 20 Next 10 Next Next End Sub
Excel2007でマクロ作成中の初心者です。 範囲指定がうまくいかない。 1）セルＢ30　　=IF(A30="","",VLOOKUP(A30,表データ,2,FALSE)) 　　セルＢ31　　=IF(A30="","",VLOOKUP(A31,表データ,2,FALSE)) 　　　以下略 　というように、セルＢ30～Ｂ60まで関数が入っており、 　以下のように表示されています。　 1　　　9月21日 2　　　9月22日 　　　以下略 　　　〃 29　　10月19日 30　　10月20日 31　　　　　　　←（ここのセルは日付表示されず空欄。　関数　=IF(A60="","",VLOOKUP(A60,表データ,2,FALSE))が入っている） 2）以下のコードを実行すると Sub 範囲を選択() Range("B30").CurrentRegion.Select Selection.Resize(Selection.Rows.Count - 1).Select Selection.Offset(1, 0).Select Selection.Resize(Selection.Rows.Count - 1).Select End sub 1から31行まで選択されてしまします。これを30行目まで、日付の表示あるセルのみ 選択したいのですが、どうすればよろしいでしょうか
フォームが５０個くらいあるのですが 該当のフォームが存在するかｖｂａで取得したいのですが If CurrentProject.AllForms("フォーム１").IsLoaded Then のように、一発で取得する方法はありますか？ 今は Sub Sample1() Dim DB As DAO.Database Dim f As DAO.Document Set DB = CurrentDb Dim strForm As String Dim flg As Boolean strForm = "Fメインメニュー" For Each f In DB.Containers!Forms.Documents If strForm = f.Name Then flg = True Exit For End If Next If flg = False Then MsgBox strForm & "は存在しません" End If End Sub のような感じで、すべてのフォームをループしているのですが 無駄が多い気がします。 改善策があればお願いします。
お願いします． 現在，メーカーの計測器についているライブラリ(dll)を利用して，測定ソフトを試作しようとしています． 仕様書ではライブラリはC言語で書いてあるようですが，自分はVB.NETでソフトを作ろうと思っています． しかし，うまく関数を使うことができず，現在停滞ています（＞＜； 以下にソースを示しますので，どなたか問題点をご指摘いただけないでしょうか？ >>ライブラリ(仕様書) int send_cmd(　WORD CmdSize, void *CmdPacket　) //WORD:符号なし64ビット //CmdSize:送信パケットサイズ(Byte) //CmdPacket:送信パケット >>VB.NET(自作) Public Declare Function send_cmd lib "test.dll" (ByVal CmdSize as ULong, ByRef CmdPacket as Byte() )　as integer Dim Test_Packet(a) as Byte res = send_cmd(Test_Packet.length, Test_packet) //Test_Packet : 送信用パケットのダンプ ***結果 res の値が仕様書の"ｄｌｌの内部エラー"の値でした．
accessのフォームのINDEX画面にて クリックしたボタンによって取得するテーブル名を分けたいのですが、 それは可能でしょうか？ いろいろ調べたのですが、見つからず。。。 ↓こんなかんじのようなことがしたいです。 Function strTbl() As String If A出力_Click Then strTbl = "[A_5_通常処理]" ElseIf B出力_Click Then FstrTbl = "[B_3_月次処理]" End If End Function
VBAの知識がなく、コピペで作業しています。 笑わないで見てください。 作業内容は 「集計用フォルダ内にあるファイル（60個くらいあります）の情報を取得してデータベース化する」 です。 下記のプログラムを作ってみたのですが、ThisWorkbookに各ファイルのデータが 一行ずつずれて貼り付けられてしまい、最終行の一つ下に貼り付けられていません。 画面を見ていると、ファイルは一つずつ開いて閉じてを繰り返しているのですが、 貼り付けは一括で行われます。 ThisWorkbookの扱いで、散々苦労して作ったのですが、あと一歩というところで つまづいてしまいました。 アドバイス、よろしくお願いいたします。 Sub フォルダ内エクセルファイル値取り出し() Dim FName As String Dim FPath As String Dim cnt As Integer Dim r As Long '画面更新オフ Application.ScreenUpdating = False '累積データがある列のデータ下端を取得 cnt = Cells(Rows.Count, 1).End(xlDown).Offset(1, 0).Row FPath = "C:\Documents and Settings\******\デスクトップ\集計用フォルダ(このフォルダは書込み専用です）" '対象フォルダのパス ChDir FPath FName = Dir("*.xls") Do While FName <> "" Workbooks.Open FName Worksheets(1).Range(Selection, ActiveCell.SpecialCells(xlLastCell)) _ .Copy Destination:=ThisWorkbook.Sheets(1).Cells(cnt, 1) cnt = cnt + 1 ActiveWorkbook.Close FName = Dir() Loop '画面更新オン Application.ScreenUpdating = True End Sub
お世話になります。 VBScriptで作成しています。 A.xmlの「sx」の値を全て200にしたいと思っております。 A.xmlの値を抜き取って、OKフォルダに複製する処理は 作ったのですが、どのようにして、sxを指定・その中の値を 変更するのかわかりません。 お手数ですが、ご教授お願いいたします。 ------------------A.xml---------------------------- <?xml version="1.0" encoding="UTF-8"?> <links> <link id="0" name="" title=""> <sx>145</sx> <sy>142</sy> </link> <link id="1" name="" title=""> <sx>495</sx> <sy>142</sy> </link> <link id="2" name="" title=""> <sx>155</sx> <sy>510</sy> </link> </links> --------------------------------------------------- ------スクリプト------------------------------------------------ Set Fso = CreateObject("Scripting.FileSystemObject") Set objXML = CreateObject("Msxml2.DOMDocument.3.0") ' カレントディレクトリ str = WScript.ScriptFullName Set obj = Fso.GetFile( str ) Set obj = obj.ParentFolder str = obj.Path ' XML を読み込み objXML.load( str & "\A.xml" ) ********************************************************** '''ここで、sxの属性の値を変更したい ********************************************************** ' XML を保存 objXML.save( str & "\OK\A.xml" ) ------------------------------------------------------
Dim FolderName As String FolderName = rst![格納フォルダパス] ハイパーリンクの　「＃」を抜いたテキストの値で取得したいのですが、 どうやったらいいですか？
エクセル2000　Windows7（管理者権限無し） <ソフトを使うのであれば、フリーソフト> Adobe、Acrobat　無し（Adobe Readerのみ） 以上の状況下でエクセルVBAを使って、 エクセル⇒PDF保存したいのですが、 検索の方法が悪いのか、どれかの条件で出来なくなってしまいます。 解決方法ご存知の方、ご教授いただけないでしょうか？＞＜； 現状はCubePDFというソフトで手作業で変換しています。 (質問内容に不足部分ありましたら、補足いたします）
.NET Frameworkを使った開発について質問です。 開発環境で実行できて実行環境で実行できないなんてことありますよね？ 実行環境には.NET Frameworkがインストールされていないとか・・・ あまり詳しくないんで大雑把な質問になるんですが・・・.NET Frameworkがインストールされていない環境でも.NET Frameworkを使って開発したアプリを実行できる方法はありますか？(dllの参照とか？）
Ｅxcel2007でマクロ作成中の初心者です。 不特定範囲の中で日付検索し、日付の有無で 処理を分岐したいです。でも、どうしても出来ません。 よろしくお願いします。 1）不特定範囲　Range("BR30:BR90")　 　　　行は毎月1回ごとに増加します。 　　　ここのセルには、すべて2013/10/12　形式で日付けが入ってます。 2）見つける日付は、セルRange("$U$2")です。 　　　2013/10/12　形式で日付けが入ってます。 3）分岐処理を追加したいです。 　　　もし同じ日付が見つかった場合は、　処理1へ 　　　　　同じ日付が見つからない場合は、処理2へ Sub 日付検索後の処理() Dim FC As Range Set FC = Range("BR30:BR90").Find(What:=DateValue("2013/10/20"), _ LookIn:=xlFormulas) 　　　’ここに処理を追加したい End Sub
リストに追加された内容をチェックシートに差し込み印刷する運用を考えています。 リストは定期的に追加され、前回リストに追加した内容は今回の印刷は印刷しないように したいです。 例）10：00　1～3を入力/1～3を印刷済　 　　11：00　4～6を入力/4～6を印刷する　※10：00の1～3ｈは再度印刷しないようにする ■したいこと 一度印刷した内容もリスト上にあれば、再度印刷されるので、印刷済フラグをたてて、 次回印刷は印刷済フラグをチェックし、再度印刷されないようにしたい ※現マクロは下記にしるしています。（モジュール1） ※画像に関連する２つのシートを添付しています 上部：データ入力 下部：問合せ回答一覧 ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ Sub 流し込み印刷() Sheets("データ入力").Select Dim mylastRow As Long '最終行を格納する変数 Dim myLastCol As Integer '最終列を格納する変数 Dim myLastCell As String '最終セルを設定する変数 With ActiveSheet.UsedRange '対象はアクティブシートの使用中のセル '最終行の行番号 mylastRow = .Rows(.Rows.Count).Row '最終列の列番号 myLastCol = .Columns(.Columns.Count).Column End With Dim i As Integer For i = 7 To mylastRow '1 Sheets("問合せ回答一覧").Range("F3:J3") = Sheets("データ入力").Cells(i, 1).Value '2 Sheets("問合せ回答一覧").Range("F4:J4") = Sheets("データ入力").Cells(i, 2).Value '3 Sheets("問合せ回答一覧").Range("F5:J5") = Sheets("データ入力").Cells(i, 3).Value '4 Sheets("問合せ回答一覧").Range("H8:V8") = Sheets("データ入力").Cells(i, 4).Value '5 Sheets("問合せ回答一覧").Range("H9:V9") = Sheets("データ入力").Cells(i, 5).Value '6 Sheets("問合せ回答一覧").Range("H10:V10") = Sheets("データ入力").Cells(i, 6).Value '7 Sheets("問合せ回答一覧").Range("H11:V11") = Sheets("データ入力").Cells(i, 7).Value '8 Sheets("問合せ回答一覧").Range("H12:V12") = Sheets("データ入力").Cells(i, 8).Value '9 Sheets("問合せ回答一覧").Range("H13:V13") = Sheets("データ入力").Cells(i, 9).Value '10 Sheets("問合せ回答一覧").Range("H14:V14") = Sheets("データ入力").Cells(i, 10).Value '11 Sheets("問合せ回答一覧").Range("H15:V15") = Sheets("データ入力").Cells(i, 11).Value '12 Sheets("問合せ回答一覧").Range("H16:V16") = Sheets("データ入力").Cells(i, 12).Value '13 Sheets("問合せ回答一覧").Range("H17:V17") = Sheets("データ入力").Cells(i, 13).Value Sheets("問合せ回答一覧").PrintOut Next i = i + 1 End Sub ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
Visual Basic Express 2012 テキストボックスにファイルをD&Dして、絶対パスを取得して 名前を変更してコピーしています。 D:\test\aaa.txt　→　D:\test\aaa_abc.txt "cmd /c copy " & filen1 & ".txt " & filen1 & "_abc.txt" filen1は拡張子なしの絶対パスになっています。 末尾に文字を追加してコピーしているのですが、パスの途中に 文字を追加したいです。 D:\test\aaa.txt　→　D:\test\old\aaa_abc.txt 上記のように別のフォルダにコピーするにはどうしたら良いでしょうか？
ExcelのVBAで、ファイルが存在するかを調べる為に以下のような記述をしました。 If Dir(filename) = "" Then Err.Raise errnumber ここで、filenameに通常のファイル名が入る場合は問題ないのですが、filenameにスペースが含まれている場合、明らかにファイルが存在する場合でもErr.Raiseが呼ばれてしまいます。そこで、次の記述を上記のIf文の前に挿入してみました。 filename = """" & filename & """" ファイル名を「"」で囲めば良いのでは、と考えたのですが、実行すると、 実行時エラー '52' ファイル名または番号が不正です。 とのエラーが出てしまいます。このように、スペースを含む可能性があるファイル名に対してDir関数を使うにはどのようにすれば良いのでしょうか。よろしくお願いします。
エクセルで30行に0-4の間の乱数を発生させて合計数を常に100にするにはどうすればいいのでしょうか。 VBAではないのですがやりたいことはCのほうの過去ログにあったのですが http://oshiete1.watch.impress.co.jp/qa4035587.html 見ても全くわかりませんでした。
VB.NETで開発をしています。 配列をテーブルに変換するにあたって、新規作成すると、問題なく成功するのですが、 作成中のシステムに組み込みをしますと、Type.GetType("system.stirng")で、「'dataType'引数をNullにすることはできません。」と、エラーが発生します。 原因は、Type.GetType("system.stirng")の結果が、「Nothing」になってしまうからです。 いろいろと試してみましたが、状況が一向に改善されません。 新規作成した方は、「{Name = "String"FullName="System,String"}」と、入っています。 下記を、システムに設置すると、エラーになります。 Dim s1() As String = New String() {"a", "b", "c", "d"} Dim dt As DataTable Dim t_data As Object dt = New DataTable t_data = Type.GetType("system.stirng") dt.Columns.Add("kname", t_data) 以上、宜しくお願い致します。 環境は、Visual Studio 2012です。
お世話になります。 VBAのfor文の中で、ある条件に合致したら、for の先頭に戻りたいのですが、 方法が分かりません。 VB.net 等の「 Continue For」に当たるものは、VBAに ないのでしょうか？ 何卒宜しくお願いします。
リストに追加された内容をチェックシートに差し込み印刷する運用を考えています。 リストは定期的に追加され、前回リストに追加した内容は今回の印刷は印刷しないように したいです。 例）10：00　1～3を入力/1～3を印刷済　 　　11：00　4～6を入力/4～6を印刷する　※10：00の1～3ｈは再度印刷しないようにする ■したいこと 一度印刷した内容もリスト上にあれば、再度印刷されるので、印刷済フラグをたてて、 次回印刷は印刷済フラグをチェックし、再度印刷されないようにしたい ※現マクロは下記にしるしています。（モジュール1） ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ Sub 流し込み印刷() Sheets("データ入力").Select Dim mylastRow As Long '最終行を格納する変数 Dim myLastCol As Integer '最終列を格納する変数 Dim myLastCell As String '最終セルを設定する変数 With ActiveSheet.UsedRange '対象はアクティブシートの使用中のセル '最終行の行番号 mylastRow = .Rows(.Rows.Count).Row '最終列の列番号 myLastCol = .Columns(.Columns.Count).Column End With Dim i As Integer For i = 7 To mylastRow '1 Sheets("問合せ回答一覧").Range("F3:J3") = Sheets("データ入力").Cells(i, 1).Value '2 Sheets("問合せ回答一覧").Range("F4:J4") = Sheets("データ入力").Cells(i, 2).Value '3 Sheets("問合せ回答一覧").Range("F5:J5") = Sheets("データ入力").Cells(i, 3).Value '4 Sheets("問合せ回答一覧").Range("H8:V8") = Sheets("データ入力").Cells(i, 4).Value '5 Sheets("問合せ回答一覧").Range("H9:V9") = Sheets("データ入力").Cells(i, 5).Value '6 Sheets("問合せ回答一覧").Range("H10:V10") = Sheets("データ入力").Cells(i, 6).Value '7 Sheets("問合せ回答一覧").Range("H11:V11") = Sheets("データ入力").Cells(i, 7).Value '8 Sheets("問合せ回答一覧").Range("H12:V12") = Sheets("データ入力").Cells(i, 8).Value '9 Sheets("問合せ回答一覧").Range("H13:V13") = Sheets("データ入力").Cells(i, 9).Value '10 Sheets("問合せ回答一覧").Range("H14:V14") = Sheets("データ入力").Cells(i, 10).Value '11 Sheets("問合せ回答一覧").Range("H15:V15") = Sheets("データ入力").Cells(i, 11).Value '12 Sheets("問合せ回答一覧").Range("H16:V16") = Sheets("データ入力").Cells(i, 12).Value '13 Sheets("問合せ回答一覧").Range("H17:V17") = Sheets("データ入力").Cells(i, 13).Value Sheets("問合せ回答一覧").PrintOut Next i = i + 1 End Sub ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
業務の中でエクセルマクロによる効率化が望めそうなので見様見真似でマクロを作ってみました。 動作は思った通り行くのですが検索が上手くいきません。 どなたかご教示お願い致します。 以下コード Dim Ran As String Dim Hn As String Dim i As Long i = 0 Do While i < 300 Ran = 1+i Hn = Range("K" + (Ran)) Cells.Find(What:=(Hn), After:=ActiveCell, LookIn:=xlFormulas, LookAt _ :=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:= _ False, MatchByte:=False, SearchFormat:=False).Activate ActiveCell.Offset(0, -7).Activate Range("G" + (Ran), "K" + (Ran)).Cut ActiveCell i = i + 1 Loop End Sub 上記コードのFIND文で検索をした際にセルの値が100やB50等は正常に見つかるのですが 100Aや100E等数値の後に英語がくるとFindの検索にひっかかりません。 改善しようと努力してみたもののわかりませんでした。 添削やアドバイス、改善方法を教えて下さい。
エクセルのFunctionプロシージャを使って以下のユーザー定義関数を作りたいのですが上手くいきません。 アドバイスお願いしますm(＿_)m やりたいこと エクセルのA列とB列に複数の（たとえば10行の）数字が並んでいます。 各行ごとに　0.5×[A列の値]×[B列の値の二乗] を算出し、その合計を求めたいです。 別の列（例えばC列）を使って上記の計算式を入力し、その合計を求めればよいのですが どうしてもFunctionプロシージャを使って１セルだけを使って求めたいのです。 自分はVBA（エクセルマクロ）はあまり詳しくないのですが 色々ネットで調べた結果、以下のようなプロシージャを書いてみたのですが 上手く計算できません。 Function KE(element As Range) Dim e As Range Dim m() As Variant Dim v() As Variant Dim ans As Integer i = 0 j = 0 For Each e In element If i = j Then m(i) = e.Value i = i + 1 Else m(j) = e.Value j = j + 1 End If Next e k = i i = 0 j = 0 While i < k + 1 ans = ans + 0.5 * m(i) * v(i) * v(i) i = i + 1 Wend KE = ans End Function もちろん、この形に拘りません Functionプロシージャを使ってうまく計算できる方法ありましたらご教示お願いします。
お世話になります。 VBAで教えてください。 dim 文字 as variant 文字="2013年10月5日（土）" を 20131005 文字="2013年1月5日（日）" ならば 20130105 という風に8桁表示したいのですが、 ・年、月、日、(日)を外す ・8桁で表示 する方法がわかりません。 どのようにすれば希望の形になるでしょうか？ よろしくお願いします。
お世話になります。 下記のVBAで作成した「oApp」をその後の処理で使用しています。 --------------------------------------------------------- Set oApp = CreateObject("Excel.Application") oApp.Workbooks.Open FileName:=CurrentProject.Path & "\メイン.xls" --------------------------------------------------------- 現在は、閉じたメイン.xlsを開いて「oApp」を取得しているのですが、 わざわざメイン.xlsを閉じるのではなく、開かれたままメイン.xlsをoAppとして 処理したいのです。 どのよにすれば、すでに開かれているメイン.xlsをoAppに 割り当てることができるでしょうか？ なにとぞよろしくお願いします。
もし、C9が空白で、C10も空白ならばC9の行は削除。 もし、C9が空白で、C10が空白でなければA9に「ID]、B9に「氏名」、C9に「住所」、D9に「年齢」E9に「電話番号」、F9に「備考」と入力する。 上記を実現するには、どのようにすればよいでしょうか？ よろしくお願いします。
お世話になります。 VBAで作成しております。 ------------------------------ dim 文字 as variant 文字="abcdwe" ------------------------------ ここで、「文字」に含まれている「c」を「0」に 変更したいのですが、 どのようにすれば変更できるでしょうか？ 素人で申し訳ございませんが 宜しくお願いします。
EXCELのA列に下記のような値が入っています。 ----------- "aaa bb cccc" ----------- "ddd" ----------- "" ----------- "eee fff ggg hhh" ----------- といったようにセルの中の値に改行があったり、 なかったり、値すらなかったりといった感じです。 これを改行区切りで配列に入れたいんですが、いい方法ありませんか？ 上の内容を下記のような配列にしたいんです。 arrValue=Array("aaa","bb","cccc") arrValue=Array("ddd") arrValue=Array("") arrValue=Array("eee","fff","ggg","hhh") よろしくお願いします。
お世話になります。 エクセルAのVBAで、配列Aを生成・使用しています。 アクセスBのVBAで、その配列Aの中身を使用したいのですが、 現在は、 　エクセルA:配列Aの中身をテキストに書き出す。 　アクセスB:テキストを取り込む という形で、受渡をしています。 このようなテキストを介さずに、 直接、配列のコピー(もしくは、エクセルの配列Aをアクセスで直接しよう) する方法はあるのでしょうか？ 何卒宜しくお願いします。
Visual Studio Express 2012 for Windows Desktop を試しています。 やりたい事は、pdf出力です。 基ネタがあって変換するというモノではなく、 ＤＢか何かからデータを取得し、 そのデータを予め決めた罫線枠に収めて、 Ａ４横などのスタイルでpdf出力するというものです。 下記はイメージです。 ┏━━━━┳━━━━┳━━━━┳━━━━┓ ┃　名字　　┃　名前　 　┃郵便番号┃都道府県┃ ┣━━━━╋━━━━╋━━━━╋━━━━┫ ┃名字Ａ　　┃名前Ａ　　┃123-4567┃北海道 　┃ ┠────╂────╂────╂────┨ ┃名字Ｂ　　┃名前Ｂ　　┃123-4567┃青森県 　┃ ┠────╂────╂────╂────┨ ┃名字Ｃ　　┃名前Ｃ　　┃123-4567┃沖縄県 　┃ ┠────╂────╂────╂────┨ ┃名字Ｄ　　┃名前Ｄ　　┃123-4567┃和歌山県┃ ┗━━━━┻━━━━┻━━━━┻━━━━┛ 　　　　　　　　ページ 1 有料のツールやアドオンなく、実現する事はできますか？ サンプルコードなどがあれば紹介頂きたいです。
VB初心者です。 VB.NETでExcelファイルを読み込みたいんですが、実行する端末にExcelがインストールされていなくても可能ですか？ また、その読み込み方法を教えて頂きたいです。（もしくは参考サイト） お願いします＞＜
期限条件のＶＢＡ文は分かりました。 実際の作りたい文は、「日付がきたら下記のプログラム文の動作を中止する」です。 例として 　　　ＶＢＡ文でセルの色塗り文があるとする。 　　　2014/1/1がきたら色塗り動作は中止する 恐縮ですがご教示宜しくお願い致します。
win7・Ｅｘｃｅｌ2007でマクロ作成中の初心者です。 1）今ブック2個があります。 2）ひとつは、ブックＡでマクロ書き込み用です。 3）もひとつは、ブックＢで、データ作業用です。 4）やりたい事は、ブックＡのユーザーフォームのコマンドボタンクリックで 　ブックＢのシートＣを表示させ、メッセージボックスを即座に表示させたいです。 5）そこで、ブックＡにコードを書込みました。 Private Sub CommandButton89_Click() Unload Me 表を開く End Sub ----------------------------------------- Sub 表を開く() ChDrive ThisWorkbook.Path ChDir ThisWorkbook.Path On Error GoTo err: Workbooks("H25年11月の表.xls").Activate Exit Sub err: Workbooks.Open Filename:=ThisWorkbook.Path & "\綴り\H25年11月の表.xls" Sheets("確定").Select MsgBox "これを更新してください。" End Sub ところが、シートＣを表示させてから、メッセージボックスを表示させたいのに Private Sub CommandButton89_Click() Unload Me こんなところで（この段階で）、メッセージボックスが出てきてしまいます。 表を開く ここで出したいです。 End Sub シートを開いてからメッセジボックスを開くにはどうしたらよいでしょうか？よろしくお願いします。
期限が来た時条件処理を変える文を教えてください。 例： 2014/1/1 がきたら、あるセルを黄色にする 　　
お世話になります。 progressbarを表示するために、 重たい処理のループの中ではDoEventsを入れることで表示ができているのですが、 ループとループの間でprogressbarを更新するには、どのようにしたらよろしいでしょうか？ *****　現状 for i =1 to 9999 重い処理 Frm_ProgressBar.ProgressBar1.value = 進捗数 DoEvents next i *****　やりたいこと for i =1 to 9999 重い処理Ａ next i Frm_ProgressBar.ProgressBar1.value = 進捗数 DoEvents for i =1 to 9999 重い処理Ｂ next i
ExcelVBAで　「データ検索後リスト表示をして、そのリストから該当するシートを選べば表示される」　というユーザーフォームを作成したいのですが、やり方がよく解りません。どなたか教えて下さい。 具体的には　「コマンドボタンが押された時に、ユーザーフォーム内のテキストボックスに入力された値（名称、日付等）と、複数のシート内のセルの値（名称、日付等）を比較して、一致（全一致、一部一致）した場合、ユーザーフォーム内のリストボックスに表示させる」　というものと　「リストボックスに表示されたものの中から見たいシートを選択すると、そのシートを表示する」 というものです。 リストの表示形式は シート名　　　名称　　日付等 Sheet1　　　 りんご　 2013.01.01 Sheet2　　　 りんご　 2013.01.02 という具合にしたいと思っています。 ちなみに複数のシートと言いましたが、マスターシートを作りコピーして使用しますので、同一形式のものになります。 以上になります。 色々やってみましたが、うまくいきませんので、どなたか解る方は教えて下さい。 よろしくお願いします。
プログラミング初心者です。 検索してもよく分からかったので、皆様のお力を貸してください。 DataGridViewの選択した行の値を別のフォームに渡したいです。 別のフォームにはNumericUpDownが一行のセルの数の分あり、 そこに値を渡し、変更された値をボタンを押すことでもとのフォームに反映させたいです。 お願い致します。
Err.Number=13とかの13という数字は何を表しているのでしょうか？ どういう時に13という数字になるのでしょうか？
エクセルのVBA（ＶＢＥ）で、以下のことが可能でしょうか。 シート上のＡ列に並んだｎ個のセル内に文字列があります。 このｎ個の文字列をファイル名として、特定のフォルダ内に、 中身のない（０バイト）のｎ個のファイルを作成したいと思います。 こんなことができるｖｂのコードの作り方がありましたら、教えてください。 よろしくお願いします。
よくテキストボックスの隣に上と下の矢印が付いたボタンが２つあって、 テキストボックスの数値を上げたり下げたり出来るものがありますが、 あれは専用のボタンがあるのでしょうか？ それとも、コマンドボタンを2個並べて実現しているのでしょうか？
忍者へFTP接続でVBAでファイルをアップロードしたいです。 http://officetanaka.net/excel/vba/tips/tips47.htm を参考に実践してるのですがうまくできません。 FFFTPを使っての手動でのアップロードは問題なく行えます。 ----------------------------------------------------------------- Sub Sample1() Dim FTP, rc As Long, Server As String, User As String, Pass As String Dim Target As String, Folder As String Set FTP = CreateObject("basp21.FTP") ''FTPオブジェクト Server = "ftp.xxxxx.com" ''ホストアドレス User = "toru_tanaka" ''ユーザー名 Pass = "password" ''パスワード Target = Application.GetOpenFilename() ''送信ファイル If Target = "False" Then Exit Sub Folder = "/" ''送信フォルダ rc = FTP.Connect(Server, User, Pass) If rc <> 0 Then MsgBox "FTP接続できませんでした。", vbCritical FTP.Close Exit Sub End If rc = FTP.PutFile(Target, Folder) If rc <> 1 Then MsgBox Dir(Target) & "を送信できませんでした。", vbCritical FTP.Close Exit Sub End If MsgBox Dir(Target) & "を送信しました。", vbInformation FTP.Close End Sub ----------------------------------------------------------------- の rc = FTP.Connect(Server, User, Pass) If rc <> 0 Then MsgBox "FTP接続できませんでした。", vbCritical FTP.Close Exit Sub End If これは通過できるのですが、 rc = FTP.PutFile(Target, Folder) If rc <> 1 Then MsgBox Dir(Target) & "を送信できませんでした。", vbCritical FTP.Close Exit Sub End If で0が返るようで、送信できませんでした。となります。 トップページの階層にアップしたい場合は Folder = "/" でいいんですよね？ Folder = "/" にしても Folder = ""にしても失敗します。 FFFTPのメッセージランを見ていると、 VBAで送信できなくても ----------------------------------------------------------------- >TYPE A 200 転送タイプを A にセットしました >PASV 227 Entering Passive Mode (***). ダウンロードのためにホスト *** (***) に接続しています. (TCP/IPv4) 接続しました. (TCP/IPv4) >MLSD 150 ASCIIモードのデータ接続をオープンします MLSD 226 転送が完了しました ファイル一覧の取得は正常終了しました. (821 Bytes) ----------------------------------------------------------------- が表示されます。 何が間違ってるのでしょうか？ ご教授よろしくお願いします。
プログラミングに関してなにかヒントがあればご教授いただきたく投稿しました。 VB.net2008 Framework2.0向けで作成中のアプリです。 上記アプリはフォームの中で無線の受信を口を開けて待っています。 　→LOOPの中のある関数で受信するまで待機しています。 そこに　VB6の他アプリから「SendMessage　HWND_BROADCAST・・・・」をやられると 両方のアプリがハングアップ（フリーズ？）してしまいます。 BROADCASTは全てのウィンドウにメッセージを送ることはわかったのですが これを回避する方法が見つかりません。 何卒ご教授の程よろしくお願い致します。
VB6でトグルボタンを使いたいのですが、コンポーネントでMicrosoft Forms 2.0 Object Libraryに チェックを入れたのですが、ファイルが見つかりませんと出ます。 エクスプローラで見るとFM20.dllというファイルは存在しています。
機器をコントロールするためのモジュールを標準モジュールに記載しているのですが、 プログラムを他のパソコンに持って行くと、 標準モジュールがありませんというエラーメッセージが出ます。 メッセージを出さない方法は、有りますか？
VB.NETで　List(Of String()) の多次元配列を宣言したとします。 Listの要素数とListの中のStringの要素数はどのように確認すれば わかるでしょうか？ どうぞ、よろしくお願いいたします。
すいません、教えてほしいです！ VB.NET2010開発環境を利用しています。 多段配列を多次元配列に入れる方法を教えていただきたいです。 多段配列 Dim myArr1()() ↓ 多次元配列　Dim myArr2(　,　)
EXCELのVBAを使って、SQLサーバーに接続し、 データテーブルを開き、データを200個（ｘが100個、ｙが100個） 書き込みさせたいプログラムを作っています。 強引に1つ1つ書き込みし、200個登録は出来たのですが、 もっとプログラムを簡略化したいと思います。 以下に内容をしめします。 ------------------------------------------- 'SQLデータベースに接続 Set rs = CreateObject("ADODB.RecordSet") Set CN = CreateObject("ADODB.Connection") CN.ConnectionString = "Driver={SQL Server};" & _ "server=○○○.○○.○○.○○; database=DB ; uid=ID; pwd=1234;" CN.Open '-----［Dataテーブル] ----- Set rs = New Recordset rs.Open "Data", CN, adOpenKeyset, adLockOptimistic '[Dataテーブル]に書込み rs.AddNew Worksheets("Sheet1").Select '☆☆☆ rs!x1 = Cells(10, 5).Value rs!x2 = Cells(11, 5).Value rs!x3 = Cells(12, 5).Value rs!x4 = Cells(13, 5).Value 　　　・ 　　　・　 　　　・ 　　　・ rs!x100 = Cells(109, 5).Value rs!y1 = Cells(10, 7).Value rs!y2 = Cells(11, 7).Value rs!y3 = Cells(12, 7).Value rs!y4 = Cells(13, 7).Value 　　　・ 　　　・　 　　　・ 　　　・ rs!y100 = Cells(109, 7).Value '☆☆☆ '保存 rs.Update MsgBox "追加しました" '後処理 rs.Close: Set rs = Nothing CN.Close: Set CN = Nothing '終了処理 Set rs = Nothing Set CN = Nothing ------------------------------------------- '☆☆☆で挟まれた部分を繰り返し文で簡潔にプログラミングしたいです。 自分が考えた以下の分では、エラーが出てしまいました。 　　i = 1 　　n = 10 Do While i < 100 　　　rs!x"& i &" = Cells(n, 5) 　　　rs!y"& i &" = Cells(n, 7) 　　i = i + 1 　　n = n + 1 Loop よりシンプルな構文にしたいと思います。 お手数おかけいたしますが、わかる方いらっしゃいましたら 教えて下さい。
vb.netは 制御系のプログラミング言語ですか？ 業務系ですか？
VBA初心者です。上級者の方助けてください。 VBAで入力セルを消去後、ＩＦ関数をN列に挿入したいです。 挿入したいＩＦ関数のところが解決できればあとの記述はなんとかなります。 ■挿入したいＩＦ関数 =IF(M4=$Y$5,$Z$9,IF(M4=$Y$6,$Z$9,IF(M4=$Y$7,$Z$9,IF(M4=$Y$8,$Z$6,IF(M4=$Y$9,$Z$10,IF(M4=$Y$10,$Z$9,IF(M4=$Y$14,$Z$7,IF(M4=$Y$15,$Z$8,"")))))))) 他関数は下記構文でうまくいくのですが、 ＩＦ関数はどのように記述したらよろしいでしょうか。 ■他 ws.Cells(i, jig_col).Value = "=VLOOKUP(F" & i & ",Sheet1!$A$2:$C$358,2,0)" ■現在の記述 Dim ws As Worksheet Dim endrow As Long Dim endcol As Long Dim you_col As Integer Dim gak_col As Integer Dim jig_col As Integer Dim bc_col As Integer Dim chg_col As Integer Dim i As Long '確認メッセージを表示し、「NO」の場合は処理を行わない If MsgBox("入力されている内容をクリアします。よろしいですか？", vbYesNo) = vbNo Then Exit Sub End If '画面の更新を行わない Application.ScreenUpdating = False Set ws = ThisWorkbook.Sheets("シンフォームイレギュラー運用状況") '呼び出し元シートの最終行、最終列を取得する endrow = ws.Cells(ws.Rows.Count, 6).End(xlUp).Row endcol = ws.Cells.Find(What:="変更フラグ", LookIn:=xlValues, LookAt:=xlWhole).Column - 2 If endrow < 4 Then Exit Sub ws.Range(ws.Cells(4, 1), ws.Cells(endrow, endcol)).ClearContents you_col = ws.Cells.Find(What:="曜日", LookIn:=xlValues, LookAt:=xlWhole).Column gak_col = ws.Cells.Find(What:="学年", LookIn:=xlValues, LookAt:=xlWhole).Column jig_col = ws.Cells.Find(What:="事業所", LookIn:=xlValues, LookAt:=xlWhole).Column 'bc_col = endcol - 1 'chg_col = endcol For i = 4 To endrow ws.Cells(i, you_col).Value = "=B" & i ws.Cells(i, gak_col).Value = "=VLOOKUP(F" & i & ",Sheet1!$A$2:$C$358,3,0)" ws.Cells(i, jig_col).Value = "=VLOOKUP(F" & i & ",Sheet1!$A$2:$C$358,2,0)" 'ws.Cells(i, bc_col).Value = "=IFERROR(MID(H" & i & ",LEN(H" & i & ")-1,1), "")" 'ws.Cells(i, chg_col).Value = 0 ws.Range("W" & i).Value = 0 Next '画面の更新を行う Application.ScreenUpdating = True End Sub
お世話になります。 ＶＢ６でエクセルのセルを数値で指定して、そこに画像を読み込んで実態を張り付けたいのですが、 色々調べて ActiveSheet.Pictures.Insertと ActiveSheet.Shapes.AddPictureを試してみましたが ActiveSheet.Shapes.AddPicture( FileNameTmp, False, True, 10, 20, 0, 0) AddPictureはもしかしてVB6には対応していないのでしょうか？ 構文エラーになってしまいます。 ActiveSheet.Pictures.Insert(FileNameTmp).Select Insertだと画像がリンクになってしまいます。
お世話になります 単純ミスだとは覆うのですが、単純すぎるせいか、理解できない状況に陥ってしまいました。 コンパイルをするとImage.Saveの行で構文エラーが発生、 もしやと思い括弧を外すと今度は変数が・・・・ どこがいけないのか、ご指摘をお願いいたします Dim FileName As String FileName = App.Path & "\TmpDummy.jpeg" Me.Picture.Image.Save(FileName, Imaging.ImageFormat.Jpeg) ←　「構文エラー」 Me.Picture.Image.Save FileName, Imaging.ImageFormat.Jpeg ←　Imagingに対して「変数が定義されてません。」
セルに入力された文字列のみをコピーする方法が分かりません。 貼り付け先のセルには既に文字列が入力されており、それに加えてコピーした文字列を貼り付けしたいと考えております。 Range("A1").copyとしたのですが、これではセルそのものがコピーされてしまいます。 F2を押した時のように編集状態にして、文字列を選択し、コピーするにはどのような方法があるのでしょうか。
お世話になります VB6のMSFlexGridでセルをマージしたいのですがうまくいきません 行イメージは以下になります。 ------------------ | AA | 1 | 2 | 3 | 　　　------------- |　　　| A | B | C | ------------------ | AA | 4 | 5 | 6 | 　　　------------- |　　　| D | E | F | ------------------ | BB | 1 | 2 | 3 | 　　　------------- |　　　| A | B | C | ------------------ | BB | 4 | 5 | 6 | 　　　------------- |　　　| D | E | F | ------------------ 1行目と2行目の先頭をマージしてtext="AA" 3行目と4行目の先頭をマージして上と同じtext="AA" 5行目と6行目の先頭をマージしてtext="BB" 7行目と8行目の先頭をマージして上と同じtext="BB" flexMergeFreeもMergeRowも試したつもりなのですが、うまくいきませんでした。 記述の順番なのかな？ With oObjGrid .Col = 0 .Row = 0 .Text = "AA" .Row = 1 .Text = "AA" ' ※ここでマージ処理を試したつもり .Row = 2 .Text = "AA" .Row = 3 .Text = "AA" ' ※ここでマージ処理を試したつもり .Row = 4 .Text = "BB" .Row = 5 .Text = "BB" ' ※ここでマージ処理を試したつもり .Row = 6 .Text = "BB" .Row = 7 .Text = "BB" ' ※ここでマージ処理を試したつもり End With ※以下を色々な順番で試したのですが、だめでした .MergeCells = flexMergeFree .MergeRow(0) = True .MergeRow(1) = True .MergeCells = 2 'マージの指定 .MergeCells = 3 'マージの指定
VB.NET初心者です 一次元配列string()に、下記データが格納されており、 そのデータを、ListBox1に表示したいのですが、 そのまま表示する方法が不明な為、DataTableに変換して から表示する方法で、実行しましたが、 syaintable = CType(syaindata_Obj(i), DataTable)の部分で、 「型 'System.String' のオブジェクトを型 'System.Data.DataTable' にキャストできません。」 というエラーが発生してしまいます。 列１　列２　列３ 1 社員Ａ　営業 2 社員Ｂ　総務 3 社員Ｃ　開発 4 社員Ｄ　開発 5 社員Ｅ　営業 6 社員Ｆ　営業 7 社員Ｇ　総務 8 社員Ｈ　営業 9 社員Ｉ　 営業 10 社員Ｊ　開発 Dim syaindata As String() Dim syaindata_Obj As Object Dim syaintable As New DataTable Dim cnt As Integer Dim i As Integer i = 0 cnt = syaindata.Length syaindata_Obj = CObj(syaindata) For i = 0 To cnt - 1 syaintable = CType(syaindata_Obj(i), DataTable) Next ListBox1.DataSource = syaintable 以上、この方法以外でも良いので、リストボックスに表示 するようにしたいと思います。 宜しくお願い致します。
お世話になります すでにエクセルに画像が複数張り付けられている状態で、 指定したセルに存在している画像のサイズのみ変更したいのですが、 皆目見当がつきません。 色々調べると、新規に張り付けた時の処理は見つかるのですが、 今回の様に、すでに存在していて、かつ、一括ではない場合のサンプルを見つけられませんでした。 判っている条件は以下となります １．画像はＪｐｅｇ形式で張り付いています ２．サイズは全て異なります ３．張り付いているセルの位置は全て判っています 　　　⇒　Ｃｅｌｌｓ（５，１０）　Ｃｅｌｌｓ（１０、１０）・・・・・ ４．画像はセルより大きく、複数のセルにまたがって張り付いております ５．サイズ変更はアスペクト比を保ったまま変更 ６．画像の重なりはございません ActiveSheet.Cells(YY1, XX1).Selectまでは何となく理解できております
CLICKONCEを使おうと試みていますが、参考書等を見ましても、レンタルサーバでは難しい気がしますが、いかがでしょうか。 社内LANとか自前のサーバですと、IISとかFrontPageServerExtensionsのインストールが出来ますが、レンタルサーバでは難しいので、CLICKONCEは使えない気がしています。 このあたりのことに詳しい人に、ご意見を伺いたいと存じます。
　以下の様なレコード(実際は他にもデータがあります）があります。必要な部分のみを抽出しています。 　事業所名と職種名が同じものですから、整理番号が最大のものを残して、ほかは削除したいのですが、思うように重複レコードの削除ができません。ご教授ください。 　整理番号　事業所名　職種名 　20110001　○○○○　△△△ 　20120001　○○○○　△△△ 　20130001　○○○○　△△△　←このデータを残したいのですが・・・ よろしくお願いします。
Vbaでセルの値だけコピーしたいのですが可能でしょうか？ 数式を埋め込んだセルに、数値が入力されたセルを形式を値だけ貼り付けにして貼り付けても数式が消えてしまって値だけ入ってます。 数式は消さず、値だけコピーというのはvbaで実現可能でしょうか？
コールバック関数を実行するのに、わざわざイベントを使う利点は何でしょうか。 下記のコードでは、どちらでも大して変わらないように見えますが・・・ Module modMain Sub Main() Dim myRaise As clsMyRaiseEvent = New clsMyRaiseEvent 'イベントを使った使用法 AddHandler myRaise.MyEvent, New clsMyRaiseEvent.dlgMyEvent(AddressOf MyCallBack) myRaise.Test1() '関数ポインタ的な使用法 myRaise.callback = New clsMyRaiseEvent.dlgMyEvent(AddressOf MyCallBack) myRaise.Test2() Console.ReadLine() End Sub 'コールバック関数 Private Sub MyCallBack(ByVal aEx As Exception) Console.WriteLine("Called") End Sub End Module Public Class clsMyRaiseEvent Public Delegate Sub dlgMyEvent(ByVal aEx As Exception) Public Event MyEvent As dlgMyEvent 'デリゲート型のイベント Public callback As dlgMyEvent Public Sub Test1() RaiseEvent MyEvent(New Exception) End Sub Public Sub Test2() callback(New Exception) End Sub End Class
お世話になります VB6での画像のサイズ変更に関して教えていただけないでしょうか 機能としては、画像を読み込み、指定サイズ枠内のサイズで一旦フォームに表示して画像を確認 問題なければ、エクセルに保存なのですが フォーム表示時にサイズを変更したにも関わらず、 エクセルに保存すると、元画像のサイズで保存されてしまいます。 表示と保存を同じtwip幅にするにはどのようにしたらよろしいでしょうか ******** 画像読み込み＆リサイズ抜粋 Me.CDialog.CancelError = True Me.CDialog.Flags = cdlOFNExplorer + cdlOFNLongNames + cdlOFNHideReadOnly + cdlOFNNoChangeDir + cdlOFNFileMustExist Me.CDialog.Filter = strMessage(33) & "(*.jpg;*.bmp)|*.jpg;*.bmp" Me.CDialog.Filename = "" Me.CDialog.ShowOpen Me.CDialog.Flags = 0 If Err Then Err.Clear On Error GoTo 0 Exit Sub End If If Trim(Me.CDialog.Filename) = "" Then On Error GoTo 0 Exit Sub End If ' 画像の比率を保って、画像をセットする Me.PImage(Index).Stretch = False ' 一旦元の大きさで読み込み指定 Me.PImage(Index).Visible = False ' 一旦非表示にする Me.PImage(Index).Picture = LoadPicture(Me.CDialog.Filename) ' 縦方向基準縮尺変更 If Me.PImage(Index).Height > Report_PImageHei Then Me.PImage(Index).Stretch = True HWTemp = Me.PImage(Index).Height Me.PImage(Index).Height = Report_PImageHei Me.PImage(Index).Width = Me.PImage(Index).Width * Me.PImage(Index).Height / HWTemp End If ' 横方向基準縮尺変更 If Me.PImage(Index).Width > Report_PImageWid Then HWTemp = Me.PImage(Index).Width Me.PImage(Index).Stretch = True Me.PImage(Index).Width = Report_PImageWid Me.PImage(Index).Height = Me.PImage(Index).Height * Me.PImage(Index).Width / HWTemp End If ********* エクセルへの出力抜粋(上記と別関数) Clipboard.Clear Clipboard.SetData Me.PImage(i).Picture WB.ActiveSheet.Cells(YY1, XX1).Select WB.ActiveSheet.Paste pict = Selection.Name Clipboard.Clear
条件を指定して、ブックの切り替えをする方法についてお聞きします。 現在をブックをBook1とし、もう一方のブックをBook2とします。 現在Book1がActiveになっていればBook2に切り替え、Book2がActiveになっていればBook1に切り替えるようにしたいのですが、どのような方法がありますか。 例えば、 Windows("Book1").Activate このような方法を考えたのですが、この方法ですと他のBookからBook1にしか切り替えることが出来ません。 ご回答宜しくお願いします。
教えてください。 他のアプリケーションの固定ウインドウをリサイズ可能にするにはどうすればよいでしょうか？ SetWidowLong GetSystemMenu InsertMenu を使うんだろうなというとこまではたどり着いたのですが。
ユーザーがエクセルをダブルクリックして起動したのか それとも別プログラムからOPENされたのか 判断する方法はあるでしょうか？ ユーザーが手動で起動したら警告メッセージを出し 別プログラムから自動でOPENされたら何もメッセージを出さないという 処理をWorkbook_Openに書きたいのですが こういう場合はどう書けばいいのでしょうか？ ちなみに別プログラムは複数あり 今後増える可能性があり、私の管理下にも無い為 別プログラムに判別する為の処理を入れる事は出来ません。
文字列を空白セルに指定した優先順位の順で、貼り付けるコードについてお聞きします。 A1をコピーしそれをB1に貼り付け。 もし、貼り付け先のセルのB1が空白でなければB2、B3、B4、B5のように順位を指定して貼り付けをしたいと思います。 どのような方法があるのでしょうか。 ご回答宜しくお願いします。
ExcelのVBAで複数列から、キーワードを含む行を検索する方法についてお聞きします。 検索キーワードを名古屋と設定しました。 A列から名古屋というキーワードを含む行を検索する為に、下記コードを作りました。 Range("A1").AutoFilter 1, "*名古屋*" しかし、これだとA列からしか検索することが出来ません。 例えば、B列とC列から名古屋を含む行を検索するにはどのような方法があるのでしょうか。 宜しくお願いします。
ｖｂａでkillステートメントを使えばファイルの削除できますが この削除は復元不可能の削除ですよね？ そうではなくて、ゴミ箱に移動するような削除をｖｂａでしたいのですが 可能でしょうか？
ビルドとデバッグは どっちから先にやればいいのでしょうか？
VB2008にてプログラムを組んでいます。 RichTextBox に英文を流し込んでありますが、それに対して英単語を検索して、ハイライトするプログラムを組んでいます。 しかし、正規表現の表現方法が悪くうまく検索してくれません。 例えば、RichTextBox には次のような英文があります。 I have seen many chavette. 上記英文に対して、下記のような正規表現で検索しているのですが、 [ -]?have[ s,-]? "have s"がヒットしてしまいます。 その他、chavetteという単語も回避したいのにヒットしてしまいます。 どのように正規表現を訂正すればよいでしょうか。 ================================== 【have の前に"[ -]?"をつけた理由】 "chavette" のような単語を回避し、 "abc-have" のような単語や " have" のような前にスペースのある単語はヒットさせたいからです。 "?"は0か1文字という理由です。 【have の後ろに"[ s,-]?"をつけた理由】 "have-had-had" のような文字列や "haves" のようなsがつく単語や "have," のようなカンマつきの単語や "have " のような後ろにスペースのある単語はヒットさせたいからです。 "?"は0か1文字という理由です。
VB6でList1.AddItemでデータを書き込んでいるのですが、 データの色を変更するにはどうすればよいでしょうか?
テキストボックスに、下記のように文字列が有ります。 そこで、2つ目の'>'以降の'RD 潜脳調査室 'という文字や 'i-wish you were here- 'を抽出したいのです。 2つ目の'>'以降の文字列や'あ'は変化します。 'トップページ > あ > RD 潜脳調査室' ↑や↓のような文字列。 'トップページ > あ > i-wish you were here-'
元のエクセルファイルにすべての商品コードとサイズと在庫数が以下のようにあります。 code　　サイズ　　在庫数 a　　S　　10 a　　M　　5 a　　L　　7 b　　26インチ　　10 b　　27インチ　　20 b　　28インチ　　10 c　　S　　1 c　　M　　6 c　　L　　4 c　　LL　　20 ・ ・ ・ ・ と2万行ほど。 そこで週2回ほど在庫表が他部署から回ってきます。 しかし、そのファイルには以下のように在庫のあるコードとサイズと個数しか書いていません。 code　　サイズ　　在庫数 a　　M　　1 a　　L　　2 c　　M　　5 c　　LL　　11 ・ ・ ・ ・ 期待値としましては、 a　　S　　0 a　　M　　1 a　　L　　2 b　　26インチ　　0 b　　27インチ　　0 b　　28インチ　　0 c　　S　　0 c　　M　　5 c　　L　　0 c　　LL　　11 ・ ・ ・ ・ となるようにマージしたいです。 元のファイルにはすべてのcodeとサイズが書いてあります。 回ってくる在庫表はすべてのコードとサイズが書いていません（在庫のあるものだけ書いてあります）。 在庫が復活するとまた書き直さないとダメなので、困ってます。 いい方法はないでしょうか。 どうぞ、よろしくお願いします。
VB6.0でVISAを用いてプログラミングしているのですが、 機器の状態を取得するところで躓いています。 ":AM:STA?"というコマンドを使うのですが Call viVPrintf(vi, ":AM:STAT?" + Chr$(10), 0) と打った後、戻り値の取得方法が分かりません。 viVPrintfで良いのかも自信がありません。(もしかして、viVScanf？)
ワイルドカードは簡単な文字検索方法で 正規表現は難しいパターンも調べられる文字検索方法ですか？
お世話になります VB6のvbModalに関して教えていただけないでしょうか やりたいこと Form1のモーダルとしてForm2を起動 Form2のモーダルとしてForm3を起動 Form3が閉じられるまで、Form1とForm2はいじれない様にしたいのですが、 単純に、以下の様にコーディングしたら、エラーとなってしまいました。 Form1から Form2.Show vbModal … これは正常に動作 Form2から Form3.Show vbModal … 以下のエラー発生 「子フォームはモーダルにできません」 vbModalのネストはできないのでしょうか？ できない場合、別の解決策はございますでしょうか？
ハイパーリンクの挿入で設定した、ハイパーリンクをクリックしてコードを実行する方法が分かりません。1つのシートで複数のハイパーリンクに、異なるコードを設定するにはどのようにすればよいのですか。ご回答宜しくお願い致します。
マクロ初心者ですので、よろしくお願いいたします。類似例が無いかと検索しましたが見つからないので質問いたします。 会社のパソコンがエクセル2003から2010に変更されました。しかし、XP環境でエクセル2003しか使えないソフトがあり、そのパソコンも残してあります。2010で作成したマクロブック（xlsm）が、2003でも使えるようファイル名を付けてエクセル2003（xls）で保存できるマクロを作成したのですが、うまくいきません。 2010で保存できた構文に、「m」を削除し、Excel8の構文を付加するのですが、構文「FileFormat:」がハイライトされ、コンパイルエラーと表示され、「名前付き引数がありません」となります。 ActiveWorkbook.SaveCopyAs Filename:=FPATH & "\" & book3 & ".xls", _ FileFormat:=xlExcel8　 「ActiveWorkbook.SaveAs」では拡張子が合わないとなりますが、保存はできています。「ActiveWorkbook.SaveCopyAs」で名前付け保存したいのですが、上記のエラーとなります。 よろしくご回答をお願いいたします。
プログラミング初心者です。 検索してもよく分からかったので、皆様のお力を貸してください。 数値を入力後に、小数点の前後に値が入力されているかどうかをチェックしたいです。 例えば、 .1 や 1. と入力された時に、フォーカスが移動する時にチェックしたと考えております。 お願い致します。
いつもお世話になります。 エクセルは2010を利用しています。 現在、下記のコードで、文字揃えを制御しています。 A1～C1は、それぞれセルが結合されています。 ---------------------------------------------------------- Sub HorizontalAndVerticalAlignmentSamp1() If Range("B1").Value = "" Then With Range("C1") .HorizontalAlignment = xlHAlignRight End With Else With Range("C1") .HorizontalAlignment = xlHAlignLeft End With End If If Range("A1").Value = "" Then With Range("B1") .HorizontalAlignment = xlHAlignRight End With Else With Range("B1") .HorizontalAlignment = xlHAlignCenter End With End If End Sub Private Sub Worksheet_SelectionChange(ByVal Target As Range) If Range("A1:C1") <> "" Then Call HorizontalAndVerticalAlignmentSamp1 End Sub ------------------------------------------------------------------------- シート２、シート３は、A1～C1のセルがシート1とおなじように結合されています。 シート1で、A1～C1に文字を入力したら、おなじ文字と文字揃えがシート2、シート3でも反映、シート１で、A1～C1に入力されていた文字を削除すると、シート2、シート3も消えているようにしたいです。 わたしの知っている限りの範囲でがんばってみたことは シート２、シート３のA1に「=Sheet1!A1」、B1に「=Sheet1!B1」、C1に「=Sheet1!C1」と入力して シート２、シート３にも上記とおなじマクロを記述してみました。 けれど、シート１で入力しても、シート２、シート３を選択して、どこかのセルを1回選択しないと、文字揃えが反映されませんでした。 そこで、 シート１の上記マクロに Sheet2.select Sheet3.select Sheet1.select を追加してみました。 けれど、あたりまえといえばあたりまえなのですが、シート１でどこかのセルを選択するごとにシート２、シート３、シート１と画面が切り替わるようになり、画面が切り替わったあとにシート２、シート３を見てみても、文字揃えはどこかのセルを選択しないかぎりおなじく反映されませんでした。 どのようにしたらいいのかが分からず、質問いたしました。 みなさまのお知恵を借していただけますと幸いです。 どうかよろしくお願いいたします。
表-1のようにセル範囲A1:A9、A10:A20があり左1文字のみ削除し表-2のようにしたいのですが。 下記のコードでは空白セルにてどうしてもエラーが生じます。どなたか解る方よろしくお願いします。 Sub 文字削除() Dim i, w For i = 1 To 9 w = Range("A" & i) Range("A" & i) = Right(w, Len(w) - 1) '←この部分でエラー発生 Next For i = 10 To 20 w = Range("A" & i) Range("A" & i) = Right(w, Len(w) - 1) Next End Sub
お世話になります。 VB2005で、 Clipboard.SetImage(ビットマップが入った変数) .cells( i , j ).select() .Paste x = (ビットマップが入った変数).height i = i + int( x / 13.5 + 1 ) + 1 （13.5はExcelの一行のピクセル数） というコードで、ビットマップをExcelに張り付けたあと、そのビットマップの下端の次付近の適切な行(i行)に移動しようとしています。 しかし、 ・貼り付けられた画像は、ビットマップの大きさより小さくなっている。 ・仮にその高さのビットマップを手動で貼り付けても、その高さを13.5で割ると、貼りつけられたその高さより多い行数になってしまう。 という現象が起こり、不要な空行がたくさんできてしまいます。 適切な場所を決める、よい計算方法を、どなたかご存知でしたらご教示いただけますと幸いです。
Labelのプロパティを変更しようとすると、「プロパティの値が無効です」と表示されて変更できません。 またサイズも変更できません。 どうすればいいでしょうか？
急ぎのため再度の質問失礼します。 ３つの数字すべてが７のとき、メッセージ１を出し、 どれか２つだけが７のときは、メッセージ２を出し、 どれか１つだけが７のときは、メッセージ３を出し、 どこにも７が含まれていないときは、メッセージ４を出すようにEndifを使って書きたいのですが、正しいコードを教えて下さい。 Public Class Form1 Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load Randomize() End Sub Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Me.Close() End Sub Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click PictureBox1.Visible = False Label4.Visible = False Label1.Text = CStr(Int(Rnd() * 10)) Label2.Text = CStr(Int(Rnd() * 10)) Label3.Text = CStr(Int(Rnd() * 10)) If End If End Sub Private Sub Label1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label1.Click End Sub Private Sub Label3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label3.Click End Sub Private Sub Label5_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label5.Click End Sub End Class よろしくお願いします。
急ぎのため再度の質問失礼します。 （zのn乗）－（xのn乗＋yのn乗）の計算をさせて、答えが０のときにメッセージを表示したいのですが、どのようなコードを書けばいいのでしょうか？ Option Explicit On Public Class Form1 Dim x As Long Dim y As Long Dim z As Long Dim n As Long Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Me.Close() End Sub Private Sub TextBox1_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox1.TextChanged End Sub Private Sub TextBox2_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox2.TextChanged End Sub Private Sub TextBox3_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox3.TextChanged End Sub Private Sub TextBox4_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox4.TextChanged End Sub Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click x = TextBox1.Text y = TextBox2.Text z = TextBox3.Text n = TextBox4.Text TextBox5.Text = (z ^ n) - (x ^ n + y ^ n) If (TextBox5 .Text= 0) Then Label6.Visible = True End If End Sub Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load End Sub Private Sub Label6_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label6.Click End Sub End Class このコードだと答えが必ず-1になってしまうのですが、どこを直せばいいのでしょうか？ 正しいコードを教えて下さい。 よろしくお願いします。
A1、B1、C1、・・・のセルに、1を入力した時、その列を非表示にするマクロを教えて下さい。 マクロ作成に当たって、条件が不足する場合は、その旨ご指摘下さい。
お手数ですが誰か教えてください！ BのデーターをAに集計するマクロを作ったのですが 処理速度とっても遅いのです。 高速で処理する方法はありませんでしょうか？ 私が作ったマクロ Sub 集計() Dim Z As Integer Dim i As Integer Dim X As Integer For Z = 2 To 2000 For i = 2 To 2000 For X = 3 To 20 If Worksheets("A").cells(Z, 1) = Worksheets("B").cells(i, 1) And 　　　　　　Worksheets("A").cells(1, X) = Worksheets("B").cells(i, 14) Then Worksheets("A").cells(Z, X) = Worksheets("B").cells(i, 16) End If Next X Next i Next Z End Sub 　　　　　　どこかが間違っている気がしますがマクロ初心者のため 　　　　　　先に進めません。 　　　　　　どうかご教授よろしくお願い致します。
Visual Studio Express 2012 for Windows Desktop で Excelのファイル（.xlsや.xlsx）を読み込んで、セルの値を読み取ったり、セルを加工したりといった、ＶＢＡマクロのようなことはできますでしょうか？ http://msdn.microsoft.com/ja-jp/library/vstudio/ … このあたりの情報を見ていると 無償の Express エディションでは出来ないのでは・・・？ と危惧しております。
VBSでフォルダの操作を行っています。 フォルダ名にUnicodeが含まれる場合エラーが発生します。 なんとか文字列を表示する事が出来ますでしょうか？ 【文字化けサンプル.vbs】 ---------------------- REM Unicode(U+2776) str = "❶" REM 表示 msgbox str ---------------------- よろしくお願いします。
Elselfを使ってLavel5,6,7全てが7のときメッセージ１を表示、内二つが７のときはメッセージ２、一つが７のときはメッセージ３を表示、全て違った場合はメッセージ４を表示したいのですが、どのようなコードを書けばいいですか？
テキストボックスの値を変数に代入したいのですが、どういうコードを書けばいいですか？ 例えばTextBox1の値を変数xに代入したいのですが。
散布図の設定を線ありにし、かつ終点を矢印にしたいのですが、線はかけるものの、矢印の設定の時、 With Sheet1.ChartObjects("Chart").Chart.SeriesCollection(1) .Border.LineStyle = xlContinuous '線の種類(連続線) End With With sheet1.ChartObjects("Chart").ShapeRange .Line.EndArrowheadStyle = msoArrowheadOpen End With と設定すると、指定された値は境界を超えています。とでます。いくつかの方法でやりましたが、オブジェクトが対象ではないなど、エラーがどうしてもでてしまいます。どのように設定したら良いでしょうか？
VB初心者です。 VBで（zのn乗）－（xのn乗＋yのn乗）の計算が出来るようにしたいのですが、答えが必ず-1になってしまいます。 Option Explicit On Public Class Form1 Dim x As Long Dim y As Long Dim z As Long Dim n As Long Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Me.Close() End Sub Private Sub TextBox1_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox1.TextChanged End Sub Private Sub TextBox2_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox2.TextChanged End Sub Private Sub TextBox3_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox3.TextChanged End Sub Private Sub TextBox4_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox4.TextChanged End Sub Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click TextBox5.Text = (z ^ n) - (x ^ n + y ^ n) End Sub End Class 正しいコードの書き方を教えて下さい。 また特定の答えのときにメッセージを表示したいのですが、どうすればいいですか？
お世話になります VB6でプリントスクリーンを無効にする機能を作成しているのですが、 hHook = SetWindowsHookEx(WH_KEYBOARD, AddressOf KeyBoardProc, 0&, App.ThreadID) フックはたぶん正常に定義できているようで、 KeyBoardProcでプリントスクリーンキーを捕まえて「４４」でブレイクも脹れています。 ここで戻り値「１」を返しているのですが、クリップボードに画像が生成されてしまいます。 画像が生成されない様にするには、何が間違っているのかおしえていただけないでしょうか？ '********************************************************************* ' フックプロシジャー '********************************************************************* Public Function KeyBoardProc(ByVal nCode As Integer, ByVal wParam As Long, ByVal lParam As Long) As Long Dim ret As Long If nCode < 0 Then KeyBoardProc = CallNextHookEx(hHook, nCode, wParam, lParam) Exit Function End If Select Case wParam ' Print Screen Case 44 KeyBoardProc = 1 Exit Function End Select KeyBoardProc = CallNextHookEx(hHook, nCode, wParam, lParam) End Function
Access 2000 VBAでシステム開発を行っております。 Oracle 7 と接続してリンクテーブルを作成しています。 通常は問題なく動作するのですが、 Access のフォーム上にボタンを配置して、あるボタンがクリックされたら、 リンクテーブルの参照先を変更して、リンクテーブルを再作成するといったことを 行おうと考えております。 しかし、ソース上でリンクテーブルの参照先を変更しても、 元の参照先でリンクテーブルが作成されてしまい、大変困っております。 どなたか本現象について分かられる方がいらっしゃいましたらご回答のほど 宜しくお願いいたします。 以下がリンクテーブル作成時のソースになります。 Function Create_odbc_table(str_OraTblName As String, str_mdbTblName As String) As Long On Error GoTo Create_odbc_table_Err Create_odbc_table = True Set DBS = CurrentDb DBS.TableDefs.Delete Trim(str_mdbTblName) DBS.TableDefs.Refresh Set tdfA = DBS.CreateTableDef(Trim(str_mdbTblName)) tdfA.Connect = "ODBC;DSN=" & DSN_NAME & ";UID=" & Oracle_UID & ";DBQ= " & Trim(TNS) & ";ASY=OFF;PWD=" & Oracle_PWD & ";TABLE=" & Trim(str_OraTblName) tdfA.SourceTableName = Trim(str_mdbTblName) DBS.TableDefs.Append tdfA DBS.Close end function
EXCEＬシートの内容をシート単位でＣＳＶ化したいと思います。 その際、 " （ダブルクォーテーション） を除去したいと思いますが、その方法を教えて頂けないでしょうか。 すみませんがよろしくお願いします。
http://oshiete.goo.ne.jp/qa/8135136.html こちらのANo.2様のご意見を参考に、フレーム操作について調べているのですが、 サンプルを作ってみたのですが、うまくできません。 サンプルの内容としては、ＵＲＬの中のフレームのオブジェクトを変数に格納し、 その格納したオブジェクトのＵＲＬをメッセージボックスに表示し、 欲しいＵＲＬかどうかを目視で確認したいのですが Dim objIE As InternetExplorer Sub Sample001() Dim myObj As Object Dim objFr As Object Set objIE = CreateObject("InternetExplorer.Application") objIE.Visible = True objIE.navigate "http://masaboo.cside.com/new_html1/ht_sun/frame0 … Stop Set objFr = objIE.document.frames.Item(1) MsgBox objFr.document.frames.LocationURL Set objIE = Nothing End Sub MsgBox objFr.document.frames.LocationURL だと、実行時エラー438になります。 MsgBox objFr.document.LocationURLもMsgBox objFr.LocationURLもダメでした。 私は何か根本的に勘違いをしているような気がしますが、格納したフレームのＵＲＬを表示する方法があれば教えてください。 ご教授よろしくお願いします。
ExcelVBAにおいて Set SheetObj = Workbooks("ブック名").Sheets("シート名") のようにメソッドチェーンで書くことができますがこれをクラスで 真似る場合 Public Function Workbooks(Optional ByVal BookName as Variant = "") '処理 Set Workbooks = Me End Function とすればメソッドチェーンで書けるようになりますが・・・ Set BookObj = Workbooks("ブック名") のように後ろにメソッドが来なければブックのオブジェクトを返すといったような 挙動をすることはできますでしょうか？ まとめ。 クラスでメソッドチェーンとして使いたい時(後ろにメソッドが控えている時は) 自分自身(Me)を返し、メソッドとして使いたい時は、別の値を返したいなんてことは 可能でしょうか？
VB2010で出勤簿を作っています。 社員名簿と出勤簿がDataGridviewで作成され、社員名簿のDataは出勤簿に連動しています。 このDataGirdViewのDataを別のＰＣにある出勤簿でも使えるようにしたいので、素人考えでＣＳＶ形式で保存して、ＦＤに移して別のＰＣに入れて使ことにしました。（ＣＳＶ形式でなくても、移動できるのでしたら、そうしたいのですが、方法が分からないので、仕方なくＣＳＶ形式を選びました） いろいろ勉強しまして、保存方法は習得しましたが、ＣＳＶを読み込む際に、 [コントロールがデータバインドされているとき、DataGridView の行コレクションにプログラムで行を追加することはできません。] というエラーが出ました。 対処方法をご存知の方が居られましたら、ご教授ください。 コードを記載します。 Private Sub Button10_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button10.Click Dim parser As TextFieldParser = New TextFieldParser("savekyoto.csv", Encoding.GetEncoding("Shift_JIS")) parser.TextFieldType = FieldType.Delimited parser.SetDelimiters(",") ' 区切り文字はコンマ '出勤簿のDATAを初期化する Dim j As Integer For j = 0 To Me.DataGridView1.Rows.Count - 2 Me.DataSet11.出勤簿.Rows(j).Delete() Next While (Not parser.EndOfData) Dim row As String() = parser.ReadFields() ' 1行読み込み ' 読み込んだデータ(1行をDataGridViewに表示する) DataGridView1.Rows.Add(row) End While End Sub
お世話になります。 VB.Net　駆け出しの者です。 コンボボックスのDataSourceがSQL Serverのデータであります。 データを登録したら、そのデータが反映した内容のコンボボックスにしたいのですが、 Me.コンボボックス.DataSource = Nothing Me.コンボボックスのBindingSource.ResetBindings(False) Me.コンボボックス.DataSource = Me.コンボボックスのBindingSource 上記を実行しても、登録したデータがデータソースに反映してないのです。 そのフォームを一度閉じて、再度開くとデータは反映しております。 Access で言うところの ReQuery のようなことができないかと質問させていただきました。 上記のコードで問題があったり、別のコードで実現できるなどお分かりになる方がいらっしゃいましたら、何卒ご教授いただければと存じます。 よろしくお願いいたします。
同一フォルダに複数のエクセルブック（100個以上）が入っています。 その中のSheet1だけ（Sheet1～3まですべてのブックにあります）を一つのエクセルにまとめたいです。 ブックの中にSheet1、Sheet1(1)、Sheet1(2)・・・ みたいになればいいです。 Sheet名がブック名になるのが理想ですが。。 どのようにすればよろしいでしょうか？
お世話になります。 以下のようなコードをプログラム内にて使用しております。 flag1 = WorksheetFunction.VLookup(ticker, Sheets("r" & Mid(Sheets("InsampleData").Cells(2, 2), 1, 4)).Range("A1:A10000"), 1, False) ticker（例えば１３３２）がシート内のA列に存在するならばそれを返すようなコードで御座います。 存在しないならばエラー処理をしております。 同じticker（例えば１３３２）でも2度目のエラーが発生しますと、意図したようにエラー処理されず、プログラムが停止してしまいます（実行時エラー’1004’）。 関数内の引数が全く同じにも関わらず、一度目は意図したようにエラー処理され、2度目にはされない。。。一日考えまして、Webにてご相談させて頂いた方が良いと判断いたしました。 皆様のアドバイスを頂戴できれば非常に助かります。 因みに、WorksheetFunctionの初期化等は出来るのでしょうか？ 宜しくお願い申し上げます。
お世話になります。 大変困っているので助けてください。 (1)現在 サーバ：WindowsXP SP3 DB：Access 2003 WEBサーバ：Tomcat6 言語：Java(JSP) (2)今後 サーバ：Windows 7 DB：Access 2010 WEBサーバ：Tomcat6 言語：Java(JSP) 上記(1)で動作してますWEBアプリを使用していまして、 (2)に移行したいと考えています。 その設定中(=Webブラウザからアクセスした場合)に 「データベースの形式'ファイル名(.accdb)'を認識できません。」 となり動作しません。 ODBCまわりなのか、Jacobまわりなのか よくわからない状況で困っています。 トレース(抜粋) com.jacob.com.ComFailException: Invoke of: OpenDatabase Source: DAO.Workspace Description: データベースの形式 'ABC.accdb' を認識できません。 com.jacob.com.Dispatch.invokev(Native Method) com.jacob.com.Dispatch.invokev(Dispatch.java:625) com.jacob.com.Dispatch.callN(Dispatch.java:453) (中略) javax.servlet.http.HttpServlet.service(HttpServlet.java:617) javax.servlet.http.HttpServlet.service(HttpServlet.java:723) どなたかご存知のかたがいらっしゃいましたらお助けください。 よろしくお願い致します。
エラー -2147418107 (&H80010005) とは？ アクセスからを使ってエクセルを開いてるのですが いつも開けたのに、今回は　 Set xlApp = CreateObject("Excel.Application") の部分で、 実行時エラー　 -2147418107 (&H80010005) オートメーションエラーです。 メッセージフィルターの中にある状態では呼び出せません。 となりました。 ググっても英文しか出てこなくてどういう意味のエラーなのかわからないのですが どういう意味ですか？ もちろんエクセルに参照設定はしているし、今までと環境は変わってません。
お世話になっております。 Excel VBAでこんなことできるのかわかりませんが、ご教授いただきたくよろしくお願いいたします。 例えば、 (1) Ａ列の（セルA1） 具有能量回收的电动汽车制动控制方法 Ｂ列の（セルB1） 具有エネルギー回収的電気自動車制动控制方法 があった時に、その差分用語 (2) A1：能量、电动汽车 B1：エネルギー、電気自動車 を任意の別シートのＡ列、B列にそれぞれ出力したいのですが、 ＜イメージ＞ Ａ列　　　　　　　B列 能量　　　　　　　エネルギー 电动汽车　　　　電気自動車 そんなことって可能なのでしょうか？ 可能であれば、(1)でA列、B列にそれぞれ対応した差分用語を (2)の別シートに出力していきたいです。 わかる方がおりましたら、ご教授の程よろしくお願いいたします。
こんにちは。 メッセージボックス(MsgBox)の表示を検出するためのイベント並びに表示内容をテキストで取得することは可能でしょうか？
現在、機器管理としてExcelで管理を行っているのですが、使用履歴等の情報が多い為、機器1台に対して1つのシートを使用しています。 ただ、機器が多くなってきており、現時点でも20シートを使用している状態で、今後も増えていく予定ですので、VBAで対象のシートを探すプログラムを作成して、効率を上げたいと思っております。 ただ、VBAの知識がない為、こちらに質問させて頂きました。 イメージとしては、機器の製造番号を入力して、ボタンを押すと、各シートの製造番号が記載されている指定のセルを検索して、その製造番号のシートにジャンプするプログラムを作りたいと思っています。 VBAに詳しい方、ご教授をお願いいたします。
excel VBAを使ってあるブックのセル範囲を別のブック（日報.XLS)のシートへコピー貼り付けをしたいのですが、コピーする側のブックがランダムに取り込まれ（例　８時間ピッチにて自動的にブックが作成される）そのブックを日にちごとに集計し、一か月ごとにまとめるということをやらなければなりません。 例）8時間ごとにフォルダが作成されます。 　　000001.XLS 000002.XLS 　　00000F.XLS ・・・・・・・・16進数にて 　　上記ブックのSheet1のA2:A11までの数値を別のブック（日報月報集計）のに貼り付ける。 別のブック(日報月報集計）は項目ごとに１０個のシートがあり ８時間ごとのファイルのセルA2は別ブックのSheet1の日付けに対応するセルへ貼り付け B2は　　　　　　　Sheet2 上記操作を８時間ごと（可変可能）に自動的にコピー貼り付けをやりたいのですが ブック間のコピー貼り付け等わからないことが（初心者です。）多々あり、いろいろ調べてはいるのですが、ＳＴＯＰした状態です。 出来れば、初心者にも理解しやすい解説等あれば宜しくお願いします。
開いているエクセルファイルが多数あるのですが、今アクティブになっているファイルだけを、上書き保存→閉じる→指定したフォルダに移動までを自動で行なわせたいです。 ・上書き保存はマクロの記憶でできるのですが、閉じるをしてしまうとマクロを終了できない、指定したフォルダに移動はマクロではできなく、教えて下さいませ。ファイルの移動は、名前を付けて保存ではなく、そのファイル自体を移動させたいです。 移動させたいファイルは決まってなくて、その都度変わります。 Sub Macro1() ActiveWorkbook.Save End Sub ・現時点、開いているファイルの保存場所 C:\Documents and Settings\aaa\デスクトップ\作業用 ・移動させたいフォルダ C:\Documents and Settings\aaa\デスクトップ\作業用\保存用
あるフォルダの中に「abc#1xyz_201308.txt」という形のテキストファイルがあり、 ボタンを押すと、直近1年分のファイルに対して中身のデータをシート3に書き込むような マクロを作りたいのですが、直近１年分のものに対して所定の操作を行うやり方が分かりません 例として、「C:\Users\Owner\Documents」に「abc#1xyz_201308.txt」の形のファイルが １年以上分ある場合で教えていただけますか？ （テキストは日付以外は同じ名前、つまりabc#1xyz_201307.txtやabc#1xyz_201306.txtが存在し それ以外の名前のものはこのフォルダにはありません。またフォルダ内には順番通り入っていませんが シートに書き込むのは古いものから順にしたいです）
お世話になります ＶＢ６のメモリ解放に関して、以下を参考に下記のコードで試したのですが、 コンパイルエラーで「配列には割り当てられません」となってしまいます。 http://oshiete.goo.ne.jp/qa/3372573.html 違いは宣言の型がStringかLongしかないと思うのですが、 なにが悪いのか教えていただけないでしょうか ******* 以下　ソース Dim wProcDat() As Long ReDim wProcDat(1 To 1000, 1 To 768) 中略 Set wProcDat = Nothing
いつもお世話になっております。 現在帳票出力のコーディングをしております。 帳票は８レコードで一枚で、 ８レコード以下になると、罫線が印刷されないため、 ブランクのデータを作ることで対応しようと思っています。 そこでブランクを入れる処理についてなのですが、 データ件数が８の倍数まで処理をつづけたいのですが どのように記述すればいいか思案に苦しんでおります。 Do Until KANRI_TANA_KENSU = 8 Or 16 Or 24 Or 32 Or 40 Or 48 Or 56 Or 64 Or 72 RS_BLANK.AddNew RS_BLANK!区分 = "BLANK" RS_BLANK.Update Loop とりあえず、一つのグループに３０件以上はないので数値を固定化させたのですが 勿論これではダメだというのは理解しているのですが。。。 イメージとしては 件数カウントしている数値を８で割り、その答えが ８の倍数でない場合は小数点が出ると思います。 要するに、整数というか小数点が出なくなるまで加算させるという条件が できればいいのかなと思っているのですが それをコーディングにするにはどうすれば。。。と思っている次第です。 他の方法でも結構ですので何か案が御座いましたら ご教示いただけませんでしょうか。
こんにちは 自プログラム(画面)のプロセスの終了時に、そのイベントを 自プログラムでキャッチするにはどうしたらよういのでしょうか？
いつもお世話になっております。 AccessVBAでコーディングを始めたのですが、 NULLの判定で分からない点がでてきました。 データベースより If rs.Fields(0) = Null Then Else 区分 = rs.Fields(0) End If この場合、rs.Fields(0)の中身がNULLの場合は rs.Fields(0)のデータを入れるとエラーになるので ELSEで逃がしたいのですが、 中身のデータがNULLにもかかわらずELSEの方を通ってしまいます。 If rs.Fields(0) Is Null Then Else シール = rs.Fields(0) End If こちらかとも思いましたが、オブジェクトが必要とエラーが返ってきました。 NULLをIF分で判定したい場合どのような記述を行えばよいでしょうか。 どうぞよろしくお願い致します。
VBAで、複数ファイルから、指定したセルに情報抽出したいと思っております。 下記のようなエクセルファイルがあり、1列目、２列目はすでに入力されています。 ２列目に詳細が書かれているテキストファイル名が記載されていて、該当ファイルは、同じルートの \filefoldaの中に、格納されています。　\filefolda内のテキストファイルから、３列目の情報を抽出したいのです。 アメリカ　　　america.txt　 　　　　　　　 シカゴ　←テキストファイルから抽出　 日本　　　　japan-oamori1.txt　　　　　 ロシア　　　rossia.txt　　　　　　　　 　　 テキストファイルの中身（アメリカの例）： <div> <div> <h1>参加国</h1> <div id="country"> <div id="organizationsBox"> <h1>アメリカ<br>　　　←この２行だけを取り出して、セルに入れたい。（３行の場合もある） シカゴ</h1>　　　　← <h2></h2> <div> <p>内容</p> </div> <h2>人数</h2> <div></div> <h2>メモ</h2> やりたいこと： \filefolda　内の各該当のファイル（1列目は「america.txtを」開いて、地域名（１行目は、「シカゴ」）をエクセルのセルに取り出したいが、一度には難しそうなので、まずは、 テキストファイルから、<h1>から、</h1>までの行を取り出して、エクセルのセルに入れていきたいと 考えております。 コードは作成してみたのですが、ＶＢＡ初心者でうまくいきません。どこをどう直したらよいのかご教授いただけると助かります。よろしくお願い致します。 Sub toridashi() Dim InputFile As String Dim FileName As String Dim i As Integer Dim LastRow As String LastRow = Range("A" & Rows.Count).End(xlUp).Row For i = 1 To LastRow FileName = Cells(i, 2).Value InputFile = ActiveWorkbook.Path + "\filefolda\" + FileName Open InputFile For Input As #1 Dim NameLineString As String Dim st As Integer st = 0 While Not (EOF(1)) Line Input #1, NameLineString Select Case st Case 0 　 If InStr(NameLineString, "<div id="country">") > 0 Then 　 st = 1 　 End If Case 1 　 If InStr(NameLineString, "<h1>") > 0 Then 　 st = 2 　 End If Case 2 　 If InStr(NameLineString, "<h2>") > 0 Then 　 st = 1 　 End If End Select 　 If st = 2 Then 　 Cells(i, 3).Value = NameLineString 　 End If 　Wend 　Close #50 　Next i End Sub
左上入力表にユーザーフォームリストボックスより選出実行された文字をB列にはリストボックス１の選出文字をC列にはリストボックス２、３、４から選出された文字を連ねて入力したいのですが。 尚、行に記入があれば次の空白から順に入力したい。 どなたかコードが解る方よろしくお願いします。
お世話になります。 VB.Net 駆け出しの者です プロジェクトをビルド、リビルトすると、いつからか以下のメッセージが出るようになっていました。 ****************************************************** vbc : warning BC40059: アセンブリ 'Microsoft.VisualBasic.Compatibility' からの間接的な参照が原因で、埋め込まれた相互運用機能アセンブリ 'stdole' に対して参照が作成されました。両方のアセンブリで '相互運用機能型の埋め込み' プロパティを変更することを検討してください。 ****************************************************** 上記のメッセージが出ても、デバックもしくは発行で実行することは可能なのですが、何か気持ち悪い気がしております。エラーメッセージならクリックすればそのコードに移りますが、実際にどこがという指定がないので、その問題の箇所にたどり着けないのです。 上記のメッセージ、もしくはそのほかの情報からなんとかメッセージの箇所を突き止める方法はありますでしょうか？何かご存知の方がいらっしゃいましたら何卒ご教授いただければと存じます。 よろしくお願いいたします。
sheet1（表-1）の入力文字「A,C,E」をsheet2へコピーする。 sheet2（表-3)のように[A,C,E」以外及びsheet1空白のセルはsheet2でも空白としたい。 その際、sheet2（表-2)に入力済みの記号「○、●、◎」はそのまま残したい。 下記のコードでは、sheet2に入力済みの記号「○、●、◎」が消えてしまいます。 どなたかコードがわかる方よろしくお願いします。 Sub シートコピー() Dim r As Range For Each r In Worksheets("Sheet1").Range("B1:D5") If WorksheetFunction.CountIf(Range("A8:A10"), r.Value) Then Sheets("sheet2").Range(r.Address).Value = r.Value Else Sheets("sheet2").Range(r.Address).Value = "" End If Next End Sub セルA11に"0"を入力して実行してもsheet1空白セルはsheet2でも空白となり困っています。
会社で自動でメールが送れるJOBを作成したいのですが、今のままでは正常に作動できないので。 修正点のご教授をお願いいたします。 下記がWebを参考して作成したバッチファイルです。 Mail.vbs: Set oMsg = CreateObject("CDO.Message") oMsg.From = "mailsender@gmail.com" oMsg.To = "user@gmail.com" oMsg.Subject = "Test" oMsg.TextBody = "テストメッセージです" & vbCrLf & Now oMsg.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/s …) = 　2 oMsg.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/s …) = "xxxxxxxxxx" oMsg.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/s …) = 25 oMsg.Configuration.Fields.Update oMsg.Send Mail.bat: cscript Mail.vbs Webで探して上記の内容で作成しました。 今の状況として、 JOBを動かすサーバーA IP:10.111.222 Aではメールを送信する機能がありません。 ※IPは適当です メール送信ができるサーバーB IP:10.333.444 AサーバーでJOBを起動してBサーバーのメール機能を使ってメールを送りたいと考えています。 Aサーバーからtelnet を利用してBへの25番ポートの穴が開いているのは確認済みです。 Bサーバーのsmtpサーバー名はわかりません。確認しようとしたら、 「IPだけでできるはず」と言われたました。 上記のVBS だと7行目で"xxxxxxxxxx"の部分にBサーバーで使用しているsmtpサーバー名が必要だという認識のため、上記のVBSは使えなのでしょうか？ IPだけわかる今の状況でメール送信できるようにする場合どのように修正したらよろしいですか。 また上記VBSは利用できない場合どのように修正したらよろしいでしょうか。 他に必要な情報がございましたらご指摘をお願いいたします。
ＶＢ２０１０でWindowsアプリケーションを作成しましたが、このアプリケーションのＦｏｒｍ1にボタンを設けて、それをクリックすることによりネットに繋げるようにしたいのですが、出来ないものでしょうか。 ネットに繋ぐ理由は、ネット上でホームページを参照できるからです。 ネットに繋ぐのであれば、ＷＥＢアプリケーションを作成しないといけないのでしょうか。
gstrMyFileにファイルへのパスが入っているとして、以下を実行すると 今あるファイルへ追記されてしまいます。 今ある行を削除をして新たにbuf()のデータを記入したいのですが、できますか？ fileNo = FreeFile Open gstrMyFile For Append As #fileNo For i = 0 To 50 Print #fileNo, buf(i) Next i Close #fileNo
　ユーザーフォームのチェックボックスの選択後(複数選択可)コマンドボタンのクリックで各チェックボックスのマクロを実行するようにしていますが、下記コードだとマクロの実行後もMsgBoxが表示されてしまいますが(当たり前ですが)、これをコマンドボタンのみをクリックした場合のみMsgBoxを表示させることは可能でしょうか？お教え下さい。 Windows7・SP1 Office2010・SP2 Private Sub CommandButton1_Click() Sheets("編集").Select If CheckBox9 Then Unload UserForm6 変更後編集データの保存 End If If CheckBox10 Then Unload UserForm6 変更前編集データの保存 End If If CheckBox11 Then Unload UserForm6 指定勤務有あり編集データの保存 End If If CheckBox12 Then Unload UserForm6 指定勤務有なし編集データの保存 End If If CheckBox2 Then Unload UserForm6 日付データの保存 End If If CheckBox3 Then Unload UserForm6 個人情報の保存 End If MsgBox ("保存する編集データを選択してください。"), vbExclamation End Sub
VBSでソート処理を行っています。 Excel2007以上の環境では、正常に動作したのですがExcel2003環境では どうもうまく動きません。 とても困っています。 ご教示いただけないでしょうか。 'ソート処理 '// エクセルオブジェクトを使用して実行 Set objXL = WScript.CreateObject("Excel.Application") objXL.Workbooks.Open "C:\test.csv" objXL.ActiveSheet.Sort.SortFields.Clear objXL.ActiveSheet.Range("A1:M" & iLine).Sort objXL.ActiveSheet.Range("K1"), , , , , , , 0, 1, False, 1, 1, 0 objXL.ActiveSheet.Sort.SetRange objXL.ActiveSheet.Range("A1:O5000") objXL.ActiveSheet.Sort.Header = 1 objXL.ActiveSheet.Sort.MatchCase = 0 objXL.ActiveSheet.Sort.Orientation = 1 objXL.ActiveSheet.Sort.Apply Excel2003では、「Clear」がサポートされていないようで、 その処理を抜いて実行してみましたが、「438のエラー」が表示されてしまいます。 根本から理解できておらず申し訳ありません どうぞよろしくお願いいたします。
VBAを利用して、あるセル列内にある文字列があった場合に その文字列が存在した行のAセルからCセルまで自動的に 背景色をグレーにしてくれるような動きをしたいです。 簡単に言うと、「作業完了」の文字列があったらその行をグレーするイメージです。 参考例として、セルC列に対してその列内のあるCセル列に 文字列"@"が入力された場合、その行のA行からC行まで 自動的に背景色を変更したいです。 また、"@"が入力されていない場合は、元の背景色に戻るようにしたいです。 ■ 例１：C2に"@"が入力されるパターン 【入力前】 　| A | B | C | -+---+---+---+- 1|　　　|　　　|　　　| -+---+---+---+- 2|　　　|　　　|　　　| ← 当然何も変化なし -+---+---+---+- 3|　　　|　　　|　　　| -+---+---+---+- 【入力後】 　| A | B | C | -+---+---+---+- 1|　　　|　　　|　　　| -+---+---+---+- 2|////|////|/@/| ← ← C2に"@"が入力されるとA2～C2までの背景色をグレーに変更。 -+---+---+---+- 3|　　　|　　　|　　　| -+---+---+---+- 【削除】 　| A | B | C | -+---+---+---+- 1|　　　|　　　|　　　| -+---+---+---+- 2|　　　|　　　|　　　| ← C2の"@"を消すと入力前に戻る。（元通り） -+---+---+---+- 3|　　　|　　　|　　　| -+---+---+---+- 任意の文字列をきっかけに自動実行するようには出来たのですが それから先がさっぱりで困っています、、、。 よろしくお願いします。
ＤａｔａＧｒｉｄＶｉｅｗ内にコンボボックスを設定しております。 マウスのホイールボタンは、ＤａｔａＧｒｉｄＶｉｅｗの縦スクロールに 使いたいのですが、ＤａｔａＧｒｉｄＶｉｅｗ内のコンボボックスに カーソルがある場合、コンボボックス内のデータが変わってしまいます。 ユーザー側と打ち合わせた結果、コンボボックスにカーソルが ある時に、マウスのホイールボタンを無効に出来ないかと 言われております。 色々調べてみましたが、私では分からず、教えて下さい。 （サンプルソース） Dim column1 As New DataGridViewComboBoxColumn() With DataGridView1 .Columns.Clear() .Columns.Add("Col01", "列１") With column1 .Items.AddRange(New String() {"Item01", "Item02", "Item03"}) .Name = "Col02" .HeaderText = "列２" End With .Columns.Add(column1) For i As Integer = 0 To 100 .Rows.Add() Next i End With
タイトル通り、指定したパス先のテキストファイルを読み込みたいのですが、 OpenFileDialogで開くやり方しかわかりません。 ボタンを押すと読み込んでテキストボックスに表示させる方法を教えて頂きたいです。
EXCEL2010のVBA(マクロ)利用して、指定したセルの書式をユーロ通貨記号(€)にしたいのですが VBAのエディタで、　€　を記入すると　？の疑問符になってしまいます。 VBAを使わずに、通常のワークシート上でセルの書式変更から表示形式を € を選択すると €123.45 のようにユーロの通貨記号表示でき印刷問題なく出来ます。 VBAを利用して、指定のセルに　€　の通貨記号で表示変換させるにはどうすれば良いのかを 教えてください。 いろいろとググッてはみたのですが、有効な情報が見当たりませんでしたので ご教示をお願い致します。
WindowsAPIを使いたいので宣言(Declare)してmciSendString関数が使えるようにしている時に Private Const FILE_NAME As String = "C:\WINDOWS\Media\chimes.wav"・Private Const が今使っているサウンドですが windowsのログオフ音にするにはどうすればいいでしょうか？
お世話になります。   DOSコマンドの"QUERY SESSION"で得たセッション情報を元に、 処理を行いたいと考えております。   そこでVB2010にて下記のプログラムを試したのですが、肝心の"QUERY SESSION"が   『操作可能なプログラム(中略)として認識されていません。』として実行されません。   ---------------------------------------------------------         '--Processオブジェクトを作成         Dim pr As New System.Diagnostics.Process         pr.StartInfo.FileName = System.Environment.GetEnvironmentVariable("ComSpec")         p.StartInfo.UseShellExecute = False         p.StartInfo.RedirectStandardOutput = True         p.StartInfo.RedirectStandardInput = False           'コマンドラインを指定         pr.StartInfo.Arguments = "/c QUERY SESSION"  '<--------問題個所？           pr.Start()           '出力を読み取る         Dim results As String = pr.StandardOutput.ReadToEnd()           pr.WaitForExit()         pr.Close()   --------------------------------------------------------- 上記のコマンドラインの部分を、         pr.StartInfo.Arguments = "/c ipconfig" など他のDOSコマンドに変えると正常に動作するのですが、   例えば下記の様に別表現でQuery sessionを指定しても同様のエラーが返されるばかりです。         pr.StartInfo.Arguments = "C:\windows\System32\qwinsta.exe"   何が原因となっているのかも分からず困っております。   どうか、お知恵をお貸しください。宜しくお願い致します。
sheet1（表-1）の入力文字「A,C,F,H」をsheet2へコピーする。 sheet2（表-3)のように[A,C,F,H」以外及びsheet1空白のセルはsheet2でも空白としたい。 その際、sheet2（表-2)に入力済みの記号「○、●、◎」はそのまま残したい。 下記のコードでは、sheet2に入力済みの記号「○、●、◎」が消えてしまいます。 どなたかコードがわかる方よろしくお願いします。 Sub シートコピー() Dim r As Range For Each r In Worksheets("Sheet1").Range("B1:F10") If WorksheetFunction.CountIf(Range("A14:A18"), r.Value) Then Sheets("sheet2").Range(r.Address).Value = r.Value Else Sheets("sheet2").Range(r.Address).Value = "" End If Next End Sub セルA18に"0"を入力して実行してもsheet1空白セルはsheet2でも空白となり困っています。
Excel UserForm を選択セルの右下に表示させたいのです。 皆様こんばんわ。 セル選択を（例）B5:F5とし、右クリックでユーザーフォームを表示させているのですが 最後のセルＦ５の右下にユーザーフォームの左上がくる様な表示方法はあるのでしょうか？ Set Area = Selection With UserForm1 .StartUpPosition = 0 .Top = 400 .Left = Area.Left + Area.Width .Show vbModeless End With などと行っていますが、エクセル画面の最大表示とそうでない場合とで表示位置が異なってしまいます。 ウィンドウズのエリアとエクセルのエリアで座標が異なるのかなぁと思いつつ。。。 良いアイデア（？）が浮かびません。 良い方法が御座いましたら 皆様、宜しくご教示願います。
って何が違うのでしょうか？ 後者は開発用のソフトウェアだと認識してますが 前者は後者を動かすためのアプリケーションみたいな物でしょうか？
はじめまして。 vb2010でソケット通信を使いたくて、今TCPサーバーを作っています。 クライアント側から受信した瞬間にサーバー側から返信というのは可能でしょうか。 受信したタイミングで接続が切れてしまって困っています。 初めてソケット通信に触れてイマイチ分かってないので説明がうまくいきませんが、 どなたかわかる方がいらっしゃいましたらご回答よろしくお願いします。
Excel2007で、複数条件の重複チェックの方法を教えてください。 以下の表があります。 A1：あああ　B1：A C1：=IF(COUNTIFS($A$1:$A$4,A1,$B$1:$B$4,B1)>1,"重複","") A2：いいい　B2：B 　C2：=IF(COUNTIFS($A$1:$A$4,A2,$B$1:$B$4,B2)>1,"重複","") A3：あああ　B3：A C3：=IF(COUNTIFS($A$1:$A$4,A3,$B$1:$B$4,B3)>1,"重複","") A4：いいい　B4：B 　C4：=IF(COUNTIFS($A$1:$A$4,A4,$B$1:$B$4,B4)>1,"重複","") C1～C4には"重複"が表示されますが、これを、重複しているグループ で表示する方法はありますでしょうか？ 期待する結果 A1：あああ　B1:A C1:グループ1 A2：いいい　B2:B 　C2:グループ2 A3：あああ　B3:A C3:グループ1 A4：いいい　B4:B 　C4:グループ2 C列に表示する文字は、どれとどれが組みになっているかわかればなんでも結構です。 すみませんが、Excelで実行する場合と、マクロで行う場合のサンプルソース を教えていただけないでしょうか？ よろしくお願いします。
Excel VBA でやりたいことがあるのですが、自分ではわからず困っています。。 データ例として、画像を添付しました。 実行前は、A列に名前、B列にそれぞれ選手の打点（ただし、最初の行は空白）というデータです。 これを実行後のように（A列、B列という場所は変わらずに）、それぞれの選手の打点平均を空白に算出するコードを教えてほしいです（ただし、各打点の入っていたデータはクリア）。 なお、画像例は「中田」までしか載せてませんが、その下にも続いていてデータ最後まで計算させるということをやりたいです。 ぜひ、ご教授願います。
ネットワークカメラにHttp（80）にて接続し、画像ファイルを取得しようとしております。 ネットワークカメラにはAPIが用意されておりhttp://カメラIP?framelate=0と入力すれば画像データが取得できます。 フレームレート0の場合は1枚のみの画像のため WebClient.DownloadFile （url）メソッドにて取得できましたが http://カメラIP?framelate=2 とすると　毎秒2枚の画像が常に送られてくるため処理がおわりません。 こういった場合常にストリームで取得しながら一枚単位でダウンロードできしだい吐き出す方法はあるのでしょうか。 ちなみに画像のフォーマットは length=50000<CR><LF> <CR><LF> 画像データ（jpeg）<CR><LF> length=40000<CR><LF> <CR><LF> 画像データ（jpeg）<CR><LF> length=50000<CR><LF> <CR><LF> ・・・・ という風に続いていく感じです。 lengthは画像データバイト数となっております。 以上説明がへたで申し訳ありませんが、ヒントをいただけないでしょうか。
Ｅｘｃｅｌのマクロについての質問です。 マクロについての質問です。 以下のようなマクロを作成しました。 このマクロを動作させているのはこのマクロを作成したファイル上です。 Sub Macro9() Dim WBA As Workbook Dim WBB As Workbook Dim WSA As Worksheet Dim WSB As Worksheet Set WBA = Workbooks("Ａ") Set WBB = Workbooks("Ｂ") Set WSB = WBB.Worksheets("1") For i = 100 To 3000 Step 20 Worksheets.Add Before:=Worksheets("Sheet1") Dim k As String k = i ActiveSheet.Name = (k / 100) Set WSA = WBA.Worksheets(k / 100) WSB.Range("A1:AY30").Copy Destination:=WSA.Range("A1") WSA.Range("D4:I30").Clear WSA.Range("Q4:V30").Clear WSA.Range("AD4:AI30").Clear WSA.Range("AQ4:AV30").Clear Next i Application.DisplayAlerts = False Sheets("Sheet1").Delete Application.DisplayAlerts = True Application.DisplayAlerts = False Sheets("Sheet2").Delete Application.DisplayAlerts = True Application.DisplayAlerts = False Sheets("Sheet3").Delete Application.DisplayAlerts = True End Sub そこで質問ですが、このマクロを作動させると何のエラーの表示もなく最後まで動作は完了します。 ですが、シートの作成は30まで作成できてもその後のセルのコピー＆ペーストはなぜかシート6.8までしかできていません(7～30までのシートはシート作成はできているのですがコピペのみが実行されず空白のままになっています。) シートもコピペも両方ともシート30まで完了するにはどの点を改善すればいいのでしょうか？ 知恵が足りずどうしても直す事が出来ません。 長文申し訳ございませんが是非皆さまのお知恵をお貸しください。 宜しくお願い致します。
先日、こちらで以下の質問に回答いただきました。 ●Acccess レポートをグループ別に出力する http://oshiete.goo.ne.jp/qa/8228404.html そこでさらに質問なのですが、 １つのテーブルから作成した複数のレポートをグループ毎にまとめ、 １つのファイルを作成することは出来るのでしょうか？ テーブル名「納品書」を元にした レポート名「R_納品書1」、「R_納品書2」、「R_納品書3」、「R_納品書4」 各々のレポートは顧客番号でグループ化しています。 これを顧客番号ごとに１つのファイルを作成できればと思います。 それぞれフォーマットが異なる為、１つのレポートで完成させることができず、 検索したところ、複数レポートを連続して出力する、というのは見つけましたが、 それを特定条件で振り分ける、というのはどういうコードにすればよいのか 自力では見つけられませんでした・・・。 どうぞよろしくお願いいたします。
いつもお世話になります。 エクセルは2010を使っています。 現在、エクセルで表を作成しています。 表内の一部分に「該当する」「該当しない」の２つの項目があり どちらかに楕円を描かないといけません。 楕円は、「挿入」→「図形」から楕円を描いています。 また、表は3枚複写で、「シート１」「シート２」「シート３」に それぞれ「該当する」「該当しない」の項目があります。 シート１の「該当する」に楕円を入れる場合、残りのシート２、シート３も「該当する」に楕円が必要になります。 シート１の「該当しない」に楕円を入れる場合、残りのシート２、シート３も「該当しない」に楕円が必要になります。 現在は、シート１、シート２，シート３の「該当する」「該当しない」両方にとりあえず楕円を入れています。 そして、「該当する」に楕円が必要な場合、シート１，シート２、シート３の「該当しない」の楕円を削除。 「該当しない」に楕円が必要な場合、シート１、シート２、シート３の「該当する」の楕円を削除――というふうにしています。 それ以外の、たとえば、「住所」や「名前」といった入力欄には、シート１に入力したら、シート２、シート３にもおなじ内容が入力されるようにリンクしています。 なので、今回の「該当する」「該当しない」の楕円の箇所の理想の状態は、最初は「該当する」「該当しない」どちらにも楕円が表示されていない状態で、「該当する」「該当しない」どちらかをクリック、もしくはダブルクリックすると、そこに楕円が表示されて、残りのシート２，シート３にも楕円が表示される――です。 このような動作をエクセルのVBAで可能でしょうか？ 上記のような表で楕円を入れる場合、どのようにつくったら一番理想的なのか、皆様のお知恵をお借りしたいです。 どうか、よろしくお願いいたします。
エクセルのマクロについての質問です。 長文申し訳ございません。 Ｅｘｃｅｌマクロが何度作り直してもうまく作動せず非常に困っております。 (1)ファイルＡのシート１のＤＢ列3行目に1の値をいれます。 (2)ファイルＡのＤＣ列172行目の値をファイルＢのシート名が「1」のシートのＤ列4行目に入れます。 (3)ファイルＡのＤＣ列2733行目の値をファイルＢのシート名が「1」のシートのＤ列6行目に入れます。 (4)ファイルＡのＤＣ列3128行目の値をファイルＢのシート名が「1」のシートのＤ列7行目に入れます。 (5)ファイルＡのシート１のＤＢ列3行目に1.2の値をいれます。 (6)ファイルＡのＤＣ列172行目の値をファイルＢのシート名が「1.2」のシートのＤ列4行目に入れます。 (7)ファイルＡのＤＣ列2733行目の値をファイルＢのシート名が「1.2」のシートのＤ列6行目に入れます。 (8)ファイルＡのＤＣ列3128行目の値をファイルＢのシート名が「1.2」のシートのＤ列7行目に入れます。 (9)以上のようにファイルＡのシート１のＤＢ列3行目に入れる値を0.2ずつ増やしていき、その値に対応したファイルＢのシートに上記のように値を入れていくという動作を20まで繰り返す。 以上のようなマクロを作る事は可能でしょうか？ マクロについて勉強はしているのですが上手く使いこなせず苦労しております。 長文の質問で大変申し訳ございませんがよろしければ皆さまのお知恵をお貸しください。 宜しくお願い致します。
お尋ねします。 VBAでマクロを作成中に画像のように「Sheet15」というのが作成されました。 アイコンは「ThisWorkBook」と同じです。 右クリックして「オブジェクトの表示」を選んでも他のシートが表示されます。 エクセルの画面上にはシートとして表示されていません。 削除したいのですが、 右クリックで表示されるメニューの「Sheet15の解放」はグレーアウトして押せません。 削除する方法があれば教えてください。 マクロでの削除でも結構です。 よろしくお願いします。
サーバ入替に伴い、以下のようなスペックの新サーバが納品されており、 現状、新サーバで検証作業中です。 　　　　　＜現 行＞ 　　　　　　　　　 　　→ 　　　　＜新＞ ・サーバOS：Windows server 2003（32bit） → Windows server 2008R2（64bit） ・ＣＰＵ：Xeon X 5260 3.33GHz（2コア）　　 → Xeon E5-2403 1.80GHz（4コア） ・メモリ：4GB 　　　　　　　　　　　　　　　 → 32GB ・データベース：SQL server 2005（32bit） → SQL server 2008R2（64bit） データベースは現行のコピーをアタッチしております。 このサーバにテキストファイルを使用して、データベースの特定のテーブルに 追加更新を行う、VB6.0（SP6）のプログラムがあり、テストを行っております。 プログラムは、現行のWindows server 2003（32bit） +SQL server 2005（32bit） 環境下で使用していたものをそのまま使用しております。 プログラムから、SQL serverへの接続は、ADO接続を使用し、接続文字列は、 "Provider=SQLOLEDB.1;User ID=[ ];Password=[ ];Initial Catalog=[ ];Data Source=[ ]" と記述しております。 ここで質問ですが、現行サーバと新サーバで、同じプログラム、同じテキストファイルを 用いてテストすると、不思議なことにスペックがいいはずの新サーバの方がプログラム 処理時間が倍～3倍程度かかります。 プログラム実行時のCPU使用率やメモリ使用率は、新しいサーバの方がかなり余裕が あるのですが、何故か処理が遅いです。 Windows server 2008R2、SQL server 2008R2、VB6、接続文字列等どこに原因があり そうでしょうか？ （何か原因及び対応策らしきものを調べる術はありますでしょうか？） よろしくお願いいたします。
Formに貼り付けたActiveXコントロールへのアクセスを別Classに担当させる方法 プログラミング初心者です。 現在VB.NETでRS-232Cで接続するデバイスを制御するフォームアプリケーションを作成しています。 デバイス制御にはメーカからActiveXコントロールが配布されており、それをフォームに貼り付けて基本的な動作をさせるところまではできています。 ただ、現在全てのコードがForm1クラスに記述されており、今後ボリュームが増えていくとメンテがしづらくなりそうですので、まとまった各機能群を別のクラスとして作成したいのですが、フォームに貼り付けたActiveXコントロールを別のクラスから動かすためにはどうすれば良いのかわかりませんので教えていただけないでしょうか。 以外検討してだめだったものです。 Class Class2 Dim frm As Form1 = New Form1 frm.AxSample1 End Class 上記のようにForm1のインスタンスを作成するのも何かが違う気がしますし…。 Class Class2 Dim frm As Form Public Sub New(ByVal senderfrm As Form) frm = senderfrm End Sub frm.AxSample1 End Class 上記だとAxSample1がClass2に認識されるはずもないですし…。 Importsとか色々試してみたのですがうまく行かず…という状況です。 そもそも根本的に別クラスにさせようということがおかしい、などの回答でも結構です。 よろしくお願いいたします。
下記のようなテキストファイルの中から、抽出したい行だけを指定して、取り出す方法はありますでしょうか。 テキストファイルの中身（部分） <h3 align="center">顧客名１</h3> <table><tr><td>ABC商事</td><td>鹿児島県</td></tr></table> <h3 align="center">顧客名２</h3> <p>出版</p> <br> <table> <tr><td>A株式会社</td><td>宮崎県</td></tr> ←抽出したい行 <tr><td>ｂｂ株式会社</td><td>長崎県</td></tr>　←抽出したい行 </table>　　 <p>教育</p> <br> <table>　　　　　　　　　　　　　　　　　　　　　 <tr><td>ＴＴ株式会社</td><td>鹿児島県</td></tr> ←抽出したい行 <tr><td>Ｗ株式会社</td><td>東京都</td></tr>　←抽出したい行 </table>　　　　　　　　　　　　　　　　　　　　　　　　　　　 <p>マスコミ<p> 以下省略 実際には、ファイルが大きく、抽出したい行が多いため、自動で処理できればと考えております。 ＶＢＡで作成できればと思っています。 <h3 align="center">顧客名２</h3>　のあとに、<table>があれば、抽出を開始し、 </table>　で、抽出をやめる、　また、<table>があれば、抽出を開始するということができればと 思うのですがよい方法がありましたら、ご教授いただければ幸いです。 よろしくお願いいたします。
ロジスティック曲線作成 vb6サンプルプログラム お世話になります vb6でロジスティック曲線の値を求めるサンプルソースを探しております。 サンプルを元に作成したい処理は以下となります 右上がり（右増分）の曲線 サンプルの計算式があれば、以下の様に改造を考えております 引数は YMax : 縦軸の最大値 XMax : 横軸の最大値 T_Val : 閾値 Table(XMax) : 戻り値 言葉で説明すると YMaxが100ならば、求める値の増分幅は0～100で XMaxが200ならば、Table(200)に100が入る T_Valが小さければ、比例に近く T_Valが大きければ、曲線がきつくなる T_Valの範囲はサンプルソース依存で構いません
お世話になります VB6の言語で 以下の値で作成された曲線を増分値を変えず0～40の閾値にしたいのですが、 計算式もしくは直値を教えていただけないでしょうか 元データ 閾値 1の時の値は1 閾値 2の時の値は1.5 閾値 3の時の値は2.25 1.5^2 閾値 4の時の値は3.375 1.5^3 閾値 5の時の値は5.0625 1.5^4 お願いしたい値は以下を満たす閾値0～40の時の値 閾値 0の時の値は1 閾値 10の時の値は1.5 閾値 20の時の値は2.25 1.5^2 閾値 30の時の値は3.375 1.5^3 閾値 40の時の値は5.0625 1.5^4
教えてください。初心者です。 1つ目。 http://oshiete.goo.ne.jp/qa/4225063.html を参考にさせていただき、複数のブック内のシートを別の1つのブックのSheet1にまとめて書き出しました。 実際は「振替伝票1月」「振替伝票2月」・・・・「振替伝票12月」と12個のブック内に 「現金」「備品」「雑費」などの共通のシートがあります。 12個のブックの「現金」をSheet1に書き出しをしたのですが、上から「振替伝票8月」の「現金」、「振替伝票5月」の「現金」・・・と順番がバラバラに書き出されます。 「振替伝票1月」「振替伝票2月」・・・・「振替伝票12月」と12個を順番に書き出すにはどうしたらよいでしょうか？ 色々調べましたがわかりません。 「Dir関数が返すファイルの順番」の説明のサイトを見つけたのですが、さっぱりわかりませんでした。 Sub Sample1() Dim buf As String, i As Long Dim j buf = Dir(Sheets("Sheet1").Range("A1").Value & "\*.xls") Do While buf <> "" Workbooks.Open Worksheets("Sheet1").Range("A1").Value & "\" & buf Sheets("現金").Range("A1:J1000").Copy ThisWorkbook.Activate Range("A65536").End(xlUp).Offset(1, 0).Select ActiveSheet.Paste Workbooks(buf).Activate Application.CutCopyMode = False Workbooks(buf).Close SaveChanges:=False buf = Dir() Loop End Sub 2つ目。 「現金」だけでなく「備品」「雑費」なども「現金」と同じブックの「Sheet2」「Sheet3」に書き出したいのですが、いろいろ調べてみるのですがわかりません。 ご教授の程、宜しくお願いいたします。
自分のユーザー名を元に、外部リストから任意の情報を 取得するVBScriptを作成したいです。 【検索条件】 １．一列目の列Aから自分のユーザー名を検索（例では2件ヒット） ２．ヒットした内容から3列目の文字列を抜き取る ３．４列目が存在する場合は4列目(概要)を抜き取る ３．msgbox等でただ表示させるだけ。 【外部リスト例：list.txt = ユーザー名,グループ,文字列,概要】 ----------------------- ABC,123,AAAAAAAAAAAAA 123,ABC,AAAAAAAAAAAAA ABC,123,BBBBBBBBBBBBB,AAA 123,ABC,BBBBBBBBBBBBB ----------------------- 【理想の動き】 --------------------------------------------------------------------- (1) ユーザー名 UserName = "ABC" (2) Forで外部リストから一列目UserNameを検索(例の場合2件) for ・1回目、1行目のABCの内容はAAAAAAAAAAAAAです。 → 4列目は存在しないのでスルー ・2回目、3行目のABCの内容はBBBBBBBBBBBBBです。 → 4列目が存在するので続けて「AAA」も表示。 next --------------------------------------------------------------------- あまり複雑化せずに、簡単に出来ればうれしいです。
VBS初心者です。 配列を1つにまとめた内容(strMSG)から 正規表現を利用して任意のキーワードを元に grepのような実行結果が欲しいです。 【実行サンプル】 ------------------------------------------- Option Explicit Dim TEST(4),i,strMSG TEST(1) = "001-AB1" TEST(2) = "001-AB2" TEST(3) = "AB1-001" TEST(4) = "AB2-001" For i = 1 To UBound(TEST) strMSG = strMSG + TEST(i) & vbCrLf next msgbox strMSG ------------------------------------------- strMSGの内容として4行分TESTの配列が格納されています。 ここでは例として、先頭001で始る文字列を検索かけたいです。 【理想の実行結果】 検索キーワード：先頭が001で始る行 ------------------------------------------- 001-AB1 001-AB2 ------------------------------------------- よろしくお願いします。 【備考】 １つ１つのTEST配列単位でgrepかけるより、配列を１つにまとめたものに 1度だけgrepかけたほうが処理速度が速いかな？と考えているためです。
ie.Document.getElementById("menu_2").Click で、オブジェクトが必要ですというエラー”４２４”が発生します やってることはIE操作でウェブページのメニューをクリックするという内容です いかに全コードを記載します Sub ********() Set ie = CreateObject("InternetExplorer.Application") 'IE起動 ie.Visible = True ie.Navigate "************" '開きたいサイトのURLを指定 　Call IEWait(ie) 'IE待機 ie.Document.getElementsByname("${loginForm.loginId}")(0).Value = "**********" ie.Document.getElementsByname("${loginForm.password}")(0).Value = "*********" ie.Document.getElementsByname("Image7")(0).Click Call IEWait(ie) 'IE待機 ie.Document.getElementsByname("Image1")(0).Click Call IEWait(ie) 'IE待機 ie.Document.getElementById("menu_2").Click Call IEWait(ie) 'IE待機 End Sub 自分としてはie.Document.getElementsByname("Image7")(0).Clickでエラーが出ないのに getElementByIdではオブジェクトが必要と言われidで取得なのかnameで取得なのかしか、かわらないのにオブジェクトが必要です、となる意味がわからないです。 どなたかご教授お願いします。
エクセル内に数万件のレコードが書き込まれています。 登録されているデータの品質をチェックしたいため、 特定の列を参照し、類似しているデータは一括で抽出したいと考えています。 エクセルの関数だけに限った際、 下記のようなやり方があるかと思いますが、 一括で抽出することができないためお知恵をいただきたい所存です。 現在のチェック方法 (1)B2のリンゴをA1にコピーし、C列はA1とB列の文字列の適合率を表示する。 (2)C列の適合率が高いもの（仮に90%以上適合した文字列）を目検でチェック (3)B3以降をA1に順次コピーして(1)～(2)のチェックを行う 　　　　　　|A列　　　|B列　　　|C列 1　　　　　|リンゴ　|　　　　　　 | 2　　　　　|　　　　　|リンゴ　　　|100% 3　　　　　|　　　　　|すいか　　|0% 4　　　　　|　　　　　|もも　　　　|0% 5　　　　　|　　　　　|すもも　　　|0% 6　　　　　|　　　　　|メロン　　　|33% 7　　　　　|　　　　　|生ハム　　|0% 8　　　　　|　　　　　|おリンゴ　|100% ■ご質問させていただく内容 ・近似した文字列の適合率を一括で調べるもしくは抽出するツールをご存知でしょうか？ ・もしくは、上記に記載した内容をマクロで組むことができるでしょうか？ 例えば以下のような流れです。 ※上図を参考に説明 (1)Sheet1のB2の文字列の適合率をB2:B8まで順次計算してC列に代入 (2)Sheet1のC列を参照し、B2の行以外で適合率が90%以上の場合、Sheet2のA列に代入 (3)B3～B8まで(1)～(2)の処理を繰り替えす。 ※参考になるサイトやプログラムなどをご教示いただければ幸いです。 よろしくお願い致します。
Microsoft Visual Basic 2010 ExpressでTwitterに連続投稿するソフトをつくりたいです。 Textbox1にツイートする内容を書く Textbox2にツイートする量を書く Textbox3に打ち込むユーザーを書く Button１でツイート 成功した場合は「打ちました」 失敗した場合は「失敗しました」 というメッセージ のような感じで作りたいです サンプルコードを　直で　　　　Githubに書いてリンクを張る　　で回答してください
シート上に多数点在するセルを、ダブルクリックで変更したいのです。 下記の通り、数ヶ所のセルだと思い通りにセルが変更されるのですが ３０か。。。４０個目辺りのセルを追加して行くと突然動かなくなってしまいます。 Range(・・・・・・・) ←この中 物には限界があるのかな？と思いつつ、質問致します。 １２０セル位で動作させたいのですが、良いお知恵をお貸し下さいませ。 皆様宜しくお願い致します。 Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) If Intersect(Target, Range("A1,C1,F1,A3,C3,F3,A6,C6,E6," _ & "A8,C8,E8,A10,C10,F10,A12,C12,F12," _ & "A14,C14,F14,A17,D17,F17,A19,C19,F19")) Is Nothing = False Then Cancel = True If Target.Value = ChrW(10003) Then Target.ClearContents Else Target.Value = ChrW(10003) End If End If End Sub
お世話になっております。 Access VBAでRSSを読み込み指定した要素の値を取得したいのですが、ググってもよく分からず どのようにすれば良いのか分からないので教えてください。 下記XMLの「item」の値を取得しフィールドへ値を挿入したいのです。 item_title1を読み込んだ後に次に別のレコードとしてitem_title2を読みたいといった形です。 初心者で言葉足らずの部分があると思いますが、ご教授の程よろしくお願いします。 VBA本文 Sub readXml() Dim XDoc As MSXML2.DOMDocument Dim node As MSXML2.IXMLDOMNode Set XDoc = New MSXML2.DOMDocument If XDoc.Load(CurrentProject.Path & "\" & "a.xml") = False Then MsgBox "読み込み失敗" Exit Sub End If Dim rs As New ADODB.Recordset 'データベースにデータを挿入する。 rs.Open "test", CurrentProject.Connection, , adLockOptimistic rs.AddNew 　　　For Each node In XDoc.selectNodes("rss/content/title") rs!title = node.Text rs.Update rs.Close End Sub 取込元XML(RSS)ソース <?xml version="1.0"?> <rss version="2.0"> <content> <title>test/title> <language>ja</language> <item> <title>item_title1</title> </item> <item> <title>item_title2</title> </item> </content> </rss>
エクセルのVBAで教えてください。 エクセルファイルAとエクセルファイルBがあります。 ・エクセルファイルAを、複製してエクセルファイルCを作成。 ・エクセルファイルBの「あ」シートをエクセルファイルＣにコピー 　※「あ」シートは、エクセルファイルＣに存在しない のですが、どのようにVBAを作成すればよいでしょうか？ 私が素人過ぎて、誠に申し訳ないのですが、 具体的なソースで頂ければ大変助かりますので 宜しくお願いします。
.NETについて初心者です。 教えてください。 .netframework1.1で作成されているプログラムがあるのですが、 確認するとフォルダ内にはdllファイルとexeファイル、configファイルしかありません。 .csや.vbなどの拡張子のプログラムファイルは生成されないのでしょうか？ .netframework2.2動かすにはどのようにすればいいのでしょうか？ よろしくお願いします。
クエリ「納品書」を元にしたレポート「納品書」（※'クエリ名とレポート名は同名）は フィールド「顧客番号」（テキスト型）でグループ設定をしています。 レポートをPDF出力する際、グループごとにファイルを保存したいと思います。 しかし、VBA実行時に「パラメータが少な過ぎます。7を指定して下さい。」と エラーが出てしまい、行き詰まっています。 VBAの知識もほとんど無い為、どこで躓いているか教えていただけないでしょうか。 また、 他サイトで申し訳ありませんが・・・、 ●ACCESSVBA レポートをグループ毎に別のPDFファイルとして保存 http://detail.chiebukuro.yahoo.co.jp/qa/question … こちらの回答を参考に、以下のように作成しました。 (以下、レコードソース) --------------------------- Const TBL_NAME = "納品書" Const RPT_NAME = "納品書"　 Const PDF_PATH = "C:\Users\Desktop\ Dim rs As ADODB.Recordset Set rs = New ADODB.Recordset rs.Open "SELECT DISTINCT 顧客番号 FROM 納品書", CurrentProject.Connection, adOpenStatic, adLockReadOnly Do Until rs.EOF pdfName = rs!顧客番号 DoCmd.OpenReport RPT_NAME, acViewPreview, ,"顧客番号=" & rs!顧客番号, acWindowNormal DoCmd.OutputTo acOutputReport, RPT_NAME, acFormatPDF, PDF_PATH & Format（date,"yyyymmdd"） & ".pdf" DoCmd.Close rs.MoveNext Loop ---------------------------
　エクセルで表現すれば、=IF(OR($G11="",COUNTIF(H11:BN11,"ｋ")>0),"",INT(AVERAGE(H11:BN11)*10+0.5)/10))という式をVBAで以下のように記述したところ、アプリケーション定義エラーまたはオブジェクト定義エラーが出ました。 For i = 1 to 410 Sheets("評定").Cells(i + 10, 79).Formula = "=IF(OR($G" & i + 10 & "=" & Chr(34) & "" & Chr(34) & ",COUNTIF("H11:BH11," & Chr(34) & "ｋ" & Chr(34) & ">0)," & Chr(34) & "" & Chr(34) & ",INT(AVERAGE("H11:BN11")*10+0.5)/10))" next i 　どのように書き換えればよいのでしょうか。お教え下さい。
VBAで特定のフォルダ内のエクセルファイルをPDFに変換する作業しているのですが Filename:=ThisWorkbook.Path & "\" & Replace(f.Name, fs.GetExtensionName(f.Path), "pdf"), _ 出来上がったファイル名を コード_日付にしたく Filename:=ThisWorkbook.Path & "\" & ("コード") & Range("B9") & ("_") & Format(Now, "yyyymmdd") & ".pdf", _ に入力したのですがB9セルのコードが入りません。 どこが間違っているのでしょうか？
お世話になります。 VB6にて下記ソースの様にバイトオーダのエンディアン変換を行っているのですが、 一旦Stringに入れ込んでいるせいなのか、 非常に処理が遅く困っております。 ２Btyteのデータの入れ替えだけなのですが、 高速化もしくは単純化する方法がございましたら教えていただけないでしょうか Public Function Swap(ByVal L As Long) As Integer Dim S As String S = Right(String(4, "0") & Hex(L), 4) Swap = CInt("&H" & Right(S, 2) & Left(S, 2)) End Function
セルに入れる　ＩＦ分を　教えてください ＮＧを　分解してみたのですが・・・・ =IF(N3=1,then 　　　　-M2, else 　　　　IF(K2=1, then 　　　　　　IF(M2<P3-M3, then 　　　　 　　　　M2 　　　　　Else 　　　　　　　　P3-M3, 　　　　　　endif 　　　　　else　　 　　　　　　　IF(K2=-1,then 　　　　　　　　　　IF(M2<M3-P3,then　 　　　　　　　　　　　　　M2, 　　　　　　　　　　Else 　　　　　　　　　　　　　　M3-P3, 　　　　　　　　　　　endif 　　　　　　　　else 　　　　　　　　　　　0 　　　　　　　　endif) 　　　　　　endif) endif) N3　は　１　もしくは　0。　K2　は　１，－１，０　の３通りです ＩＦ　が　５個ですから　）　も　５個？（ENDIF　も　５個　だし？） といった　ことで　お手数ですが
A列を基準にBC列が空白ならAの数値を入れて、A>BならB列を更新、A<CならC列を更新 A列が数値以外ならその行をスキップ、という処理をしたいのですが Option Explicit Dim A As Range, B As Range, C As Range Dim i As Long Sub test() For i = 1 To 10 Set A = Cells(i, 1) Set B = A.Offset(0, 1) Set C = A.Offset(0, 2) If IsNumeric(A) Then Else Exit Sub End If If B.Value = "" Then B.Value = A.Value If C.Value = "" Then C.Value = A.Value If A.Value > B.Value Then B.Value = A.Value If A.Value < C.Value Then C.Value = A.Value Next i End Sub とすると数値以外の行の時点で停止してしまいます。 その行を飛ばして次の行に進むにはどうしたらいいのでしょうか？
表題の件ですが、サービスアプリを作成しておりメッセージを表示したいと思います。 通常のフォームアプリですと、「msgbox」でメッセージボックスを表示出来ますが、サービスアプリから同じコードを書いても何も表示されません。 「デスクトップとの対話をサービスに許可」をオンにすると、「msgbox」でメッセージを表示するタイミングで「サービスがメッセージ出そうとしてますが表示しますか？」という感じのダイアログが出て、「OK」を押すとようやくメッセージボックスが表示されます。 これでは「キャンセル」ボタンを押されるとプログラムが停止する等で実用性が無いので別の方法を探したところ、 MessageBox.Show("test", "caption", MessageBoxButtons.OKCancel, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.ServiceNotification) で表示出来る、という方法を見つけました。 試したところ、ビルド時にエラーは出ませんが動作させてもメッセージボックスは表示されません。 「デスクトップとの対話をサービスに許可」をオン・オフどちらにしても表示されません。 6番目の「ServiceNotification」を「DefaultDesktopOnly」に変更しましたがやはり表示されません。 開発ツールは「Microsoft Visual Basic 2008」で動作環境は「windows7」の「Professional 64ビット」と「Enterprise 64ビット」です。この環境で動作確認後に32BitやWindows8でも動作させたいと考えております。 原因や対処法をご存知の方がおられましたら、ご教授頂けると非常に助かります。 お手数をお掛けいたしますが、よろしくお願いいたします。
お世話になります。 ExcelのVBAで作成しております。 処理の過程で、「2012年1月5日（木）」という形の文字列を 取得するのですが、これを、「20120105」という 形に変換したいと思っております。 どのように「VBA」で、「具体的に」コーディングしたらよいか教えて 頂けれないでしょうか？ 宜しくお願いします。
いつもお世話になります。 エクセルでチェックマークをつける際に、フォームコントロールやActiveXコントロールのチェックボックスを利用していました。 しかし、このたび、すべての色を青色でつくらなくてはいけなくなりました。 フォームコントロールのチェックボックスでは、文字も枠もチェックマークも黒色しかできません。 ActiveXコントロールのチェックボックスでは、文字の色こそ変えることができましたが、枠とチェックマークの色を変えることはできませんでした。 そこで、チェックマークさえできてしまえば、枠は図形で、文字はテキストボックス、もしくはセル内に入力というやり方ができるのでいろいろと探してみました。 結果、以下のサイトを発見し、試してみました。 http://oshiete.goo.ne.jp/qa/5678741.html 一部抜粋 ---------------------------------------------------------------------------------- Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) If Intersect(Target, Range("A1:A10")) Is Nothing = False Then Cancel = True If Target.Value = ChrW(10003) Then Target.ClearContents Else Target.Value = ChrW(10003) End If End If End Sub ---------------------------------------------------------------------------------- 上記でチェックマークの色の変更と、ONとOFFができるようになったのですが、EXCELデータ作成の都合上、どうしてもセルの結合内にチェックマークをつくらなければなりません。 上記では、セルが結合されていなければうまくいくのですが、セルが結合されていると下記のエラーが出てしまいます。 ------------------- 実行時エラー '13': 型が一致しません。 ------------------- そこで、セルの結合をメインにgoogleで調べたところ以下のサイトを発見しました。 http://oshiete.goo.ne.jp/qa/3155117.html 以下の内容を踏まえて、下記のように変更してみました ---------------------------------------------------------------------------------------- Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) If Intersect(Target, Range("A1:A10")) Is Nothing = False Then Cancel = True If Target.Text = ChrW(10003) Then Target.ClearContents Else Target = ChrW(10003) End If End If End Sub -------------------------------------------------------------------------------------- 結果、セルが結合されていてもチェックマークをつけることはできました。 けれど、チェックマークがついたセルを、もう一度ダブルクリックしてもチェックマークが外れてくれません。 結合されていないセルでは、チェックマークをつけたりはずしたりができます。 そこで、もう一度googleでいろいろと調べてみたのですが、どうしても解決できませんでした。 現段階では、チェックマークのONはできるけど、OFFにはできないという一方通行の状態なので 結合セル内でもチェックマークをOFFにできるようにしたいです。 皆さまに教えていただけますと幸いです。 どうか、よろしく願いいたします。
Dドライブフォルダ内のエクセルファイルすべてをPDFとして保存するというVBAに悩んでいます。 どのように記述すればうまくいくでしょうか？
Access2013でXMLファイルを読み込むVBAを作成しています。 VBA実行時に「実行時エラー '-2147467259(80004005)': 未宣言の名前空間の接頭語を参照します :'a'」と表示されてしまい読み込むことができません。 色々調べた結果、下記のページが今回のエラーに関係ありそうということは分かったのですが、VBAのソースをどのように書き換えれば良いか分からず苦戦しております。 http://support.microsoft.com/kb/280457/ja 解決法をご存じ方がいらっしゃいましたらご教授いただければと思います。 よろしくお願いします。 --------------以下ソース-------------- XMLファイル <?xml version="1.0"?> <rss version="2.0"> <a:b>0</a:b> <title>test</title> </rss> VBA本文 Sub readXml() Dim XDoc As MSXML2.DOMDocument Dim node As MSXML2.IXMLDOMNode Set XDoc = New MSXML2.DOMDocument If XDoc.Load(CurrentProject.Path & "\" & "a.xml") = False Then MsgBox "読み込み失敗" Exit Sub End If Dim rs As New ADODB.Recordset rs.Open "test", CurrentProject.Connection, , adLockOptimistic rs.AddNew 　　　For Each node In XDoc.selectNodes("rss/title") rs!title = node.Text rs.Update rs.Close End Sub
EnumWinProcとEnumChildProcを使って、デスックトップ上のすべてのウィンドウのハンドルを取得していますが、リモートデスクトップの中のウィンドウのハンドルは取得できないようです。 どういうFunctionを使用するとできますでしょうか？ よろしくお願いします。
質問票をExcel VBAで作成、各設問に対する回答はラジオボタン（YES/NO/NA）で選択、NOの場合だけテキストボックスを表示仕組みなのですが、テキストボックスがセルときちんと連動しない時があって困ってます。 詳しく言うと、各設問に対する回答をラジオボタン（YES/NO/NA）で選んでもらい、NOの場合だけ、その理由をテキストボックスに書いてもらう仕組みで、YesまたはNAが選ばれた場合には（フォームをすっきり見せたいため）、テキストボックスを隠します。 ただそのテキストボックス（やラジオボタン）がきちんとセルと連動してくれないときがあります。（きちんと動いた場合のスクリーンショットを添付したのでご確認ください。）微妙に上下にずれてしまいレイアウトが崩れるときがあって困っています。いつ動いているのか、どういうときに動いてしまうのか等のパターンが全然分かりません。 ＜ロジック＞ Yes/No/NAのラジオボタンのデフォルトはNoで、すべての設問に対しテキストボックスは表示しておきます。テキストボックスは9行にわたって配置していて、YesまたはNAのクリックイベントによって、その9行の非表示、およびテキストボックスを非表示設定をコントロールしています。 正常に動いているケースのスクリーンショットを添付しましたので、ご確認お願いします。 また、すべてのテキストボックスおよび（”種類”の）ラジオボタンの Placement プロパティは、2（Move but don't size with cells）に設定しています。 この質問票使用時にはパスワードでシート保護もしています。（保護対象外はロック／アンロックされたセルと行） 開発環境：Excel2010 (Version: 14.0.6023.1000(64-bit)) ファイル保存形式：Excel 97-2003 Workbook (*.xls) ＜ソース＞ 表示する場合（Noが選択）の関数が下記です。非表示の場合も同様のつくりです。 ラジオボタンのクリックイベント内から下記Subプロシージャが呼ばれます。 Private Sub Set_Visible(ByVal j As Integer, ByVal k As Integer, ByVal m As Integer) i_RowNumber = （ここでパラーメータの変数を使って値をセット） ActiveSheet.Rows(i_RowNumber & ":" & i_RowNumber + 9).Hidden = False For i = 1 To 3 ActiveSheet.OLEObjects("TextBox" & j & "_" & i).Visible = True Next i For i = 4 To 7 ActiveSheet.OLEObjects("RadioBtn" & j & "_" & i).Visible = True Next i End Sub ※各テキストボックス、ラジオボタンの名前が TextBox1_1やRadioBtn1_4等としているため、For文でまわしてます。 基本的にこのコードで正しく動作しています。ただ、何かの加減でテキストボックスやラジオボタンが予期せぬところに表示されるので、コードの問題というよりは何か不安定要素が絡んでいるのではないかと思ってます。 左右に動く症状は見かけておらず、上下に少し動いて、（添付ファイルを参照ください）”理由１”や”関連リンク”といったテキストボックスのすぐ上に配置した文字を隠してしまったりします。 この症状はわたしのPCだけでなく、他の人のPCで動作確認しても、起きたり起きなかったりします。 この不安定な動作の修正方法が見つからず、ここ二週間ほど困っています。もしどなたか、修正案、もしくは、このロジックを見てもっとシンプルな代替案があれば、是非教えていただけると助かります。 ※質問するのは初めてなので不備がありましたら遠慮なくご指摘いただけると助かります！
インターバル = TimeValue("00:50:00") 早速ですが インターバル = TimeValue("00:50:00") Debug.Print Now + インターバル これは　エラーになりません。 しかし If Format(Now, "hh:mm:ss") < Format("3:00:00", "hh:mm:ss") Then 終了時刻 = Format(Now, "yyyy/mm/dd") & " " & TimeValue("3:02:00") Else 終了時刻 = Format(DateAdd("d", 1, Now), "yyyy/mm/dd") & " " & TimeValue("3:02:00") End If Debug.Print 終了時刻 + インターバル これは、型が合わないエラーです。 終了時刻は　文字列的に合成されただけ・・・だろうと　推察するのですが では、「終了時刻 + インターバル」　が　可能な終了時刻は　どうして　作ればいいのでしょうか？
５分ピッチで　仕事させます。 ブックオープンで インターバル = TimeValue("00:05:00") Application.OnTime Format(開始時刻, "hh:mm:ss"), "orgdata.必要な作業を行うマクロ", 待ち時間 Debug.Print "st" & 開始時刻 Call timer_set 反復時刻 = 開始時刻 If Format(反復時刻, "hh:mm:ss") > "23:54:00" Then 反復時刻 = Format(DateAdd("d", 1, 反復時刻), "yyyy/mm/dd") & " " & TimeValue("0:00:10") Else 反復時刻 = Format(反復時刻, "yyyy/mm/dd") & " " & TimeValue(反復時刻) + インターバル End If ループで５回ほど Application.OnTime Format(反復時刻, "hh:mm:ss"), "orgdata.必要な作業を行うマクロ", 待ち時間 Debug.Print "loopexit" & 反復時刻 で、デバッグアウトが end　2013/08/15 3:02:00 st　2013/08/14 23:50:10 loop2013/08/14 23:55:10 loop2013/08/15 00:00:10 loop2013/08/15 00:05:10 loop2013/08/15 00:10:10 loopexit2013/08/15 00:15:10 makuro 2013/08/15 00:20:10 makuro 2013/08/15 00:25:10 makuro 2013/08/15 00:30:10 で、「必要な作業を行うマクロ」　で　仕事のあと　タイマー追加します。 If Format(反復時刻, "hh:mm:ss") > "23:54:00" Then 反復時刻 = Format(DateAdd("d", 1, 反復時刻), "yyyy/mm/dd") & " " & TimeValue("0:00:10") Else 反復時刻 = Format(反復時刻, "yyyy/mm/dd") & " " & TimeValue(反復時刻) + インターバル ' End If Application.OnTime Format(反復時刻, "hh:mm:ss"), "必要な作業を行うマクロ", 待ち時間 （反復時刻を　時間だけの時　formatを　入れて・・・） Debug.Print "makuro " & 反復時刻　’これが　デバッグで出力されています。 で、ダミーの作業が clup = clup + 1 orgdata.Cells(clup, 10) = Format(Now, "yyyy/mm/dd") orgdata.Cells(clup, 11) = Format(Now, "hh:mm:ss") orgdata.Cells(clup, 12) = Format(反復時刻, "yyyy/mm/dd") orgdata.Cells(clup, 13) = Format(反復時刻, "hh:mm:ss") 結果 2013/8/1423:50:102013/8/150:20:10 2013/8/1423:55:102013/8/150:25:10 2013/8/150:00:102013/8/150:30:10 これで、タイマー作業が　途切れます。 0：00：00　超える事に　問題があるなら　0：00：10　は　実行されないハズ・・・・ 反復時刻は　ｙｙｙｙ/ｍｍ/ｄｄ　&　”　”　&　”ｈｈ：ｍｍ：ｓｓ”　です。 試しに　時刻だけでやっても　同じでした。 さて、如何でしょ？ 実は　これで、動いていたのですが、３日ほど前から　0：00以降　突然タイマーが動かなくなったのです ＰＣは　３台　同じ現象です　よって　ＷＩＮの設定では無い・ エクセル　オプションに　何か設定でもあるのか？？ どうも　VBAのタイマーは不可解で エクセル終了させず、　プログラムだけ終了、再ロードだと、前のタイマー残ったまま、ダブルでタイマー動くとか・・・・ それと、WIN32とかの　別のタイマー使った方が　良いのでしょうか？？
読み取り専用のエクセルファイルで エクセルのvbaでADOでエクセルデータをアクセスに転記してる時に アクセスでフィルタをかけてるとフリーズします。 ADOでデータを送ってる最中は アクセスで検索やテーブルへのアクセスはできないのでしょうか？
お世話になります VB6で同一のコンボックスを二つのフォームで使用したいのですが、 うまくいきません。 やりたいこと フォーム１のコンボックスでリストから”東京都”と選択したら フォーム２のコンボックスのリストを”東京都”に その逆の操作も有効で フォーム２のコンボックスでリストから”東京都”と選択したら フォーム１のコンボックスのリストを”東京都”に 現在はフォームの定義毎にそれぞれCombo1とCombo2を定義して、 ListIndexをセットしようとしたのですが、 ListIndexをセット時にClickイベントが発生して無限ループに陥っています。 定義を一つにする方法かお互いの値を同時に更新する方法を教えていただけないでしょうか
お世話になります VB6で二つのコンボックス内でお互いのリストを編集する処理を作りたいのですが、 イベントを止めないと、編集時に相手のコンボックスにClickイベントが発生して無限ループになってしまいます。 そこでRemoveHandler、AddHandlerで一時的にイベントを停止させたいのですが、 今度は「メソッドまたはデータメンバが見つかりません。」のエラーが出てしまいます。 ※Me.を付けても同じ結果でした どのように記述したらClickイベントを止められますか？ Private Sub Combo1_Click() RemoveHandler Combo2.Click, AddressOf Combo2_Click ここでCombo2の編集 AddHandler Combo2.Click, AddressOf Combo2_Click End Sub Private Sub Combo2_Click() RemoveHandler Combo1.Click, AddressOf Combo1_Click ここでCombo1の編集 AddHandler Combo1.Click, AddressOf Combo1_Click End Sub
私は現在、Accessでフォルダ内のExcelファイルを一括でインポートし集計するというツールを作成しております。 そこで質問ですが、フォルダ指定ダイアログを表示し、ダイアログで指定したフォルダ（中はxls,xlsx,xltmなど）をテーブル上にインポートするようなVBAはありますでしょうか？ まとめます。 ・フォルダを選択するダイアログを表示したい ・一つのフォルダの中に、幾つものエクセルファイルが存在する ・ファイル名などはバラバラです ・シート単位でインポートしたいです ・インポートするシートを選択できるようにしたいです ・テーブルのカラムは決まっています 以上です。 どうか皆様のアドバイスよろしくお願い致します。
お世話になります Combo1のリスト更新に連動してCombo2も更新したいのですが、 「プロパティの値が不正です。」のエラーが出てしまいます。 下記コードの添削をお願いいたします。 Private Sub Combo1_Click() Me.Combo2.ListIndex = Combo1.ListIndex End Sub
お世話になります VB6でコードを修正しているのですが、 コードが見やすいように、変数名などの文字数に合わせて、 スペースを入れて、各種記号が並ぶようにしているのですが、 保存すると、スペースが一つになってしまうため、 結局、修正は外部エディタで行っております。 スペース等が勝手に削除されてしまう機能を無効にできないのでしょうか？ ※インデントではございません。 AAA = CCC(FFF + G) AA = DD( FF + G) A = E( F + G) ↑の"="や"+"の位置をスペースを入れてあわせています
Expr, Domain, Criteria のExprってなんて読んでますか？ ドメインとクライテリアは読めるのですが。
Excel VBAのOptionButtonについてお伺いします。 現在、Excel2007にてユーザーフォームを作成しております。 シート上の文字によって、ユーザーフォーム上のオプションボタンの ON/OFFを切り替えたいのですがうまく動作しません。 具体的には・・・・ ユーザフォーム上のCommandButton1を押下すると、 sheet2のE22セルの文字がTRUEの場合、ユーザーフォーム上の OptionButton1がON・OptionButton2がOFF sheet2のE22セルの文字がFALSEの場合、ユーザーフォーム上の OptionButton1がOFF・OptionButton2がON 以下のように考えていたのですが、動作しません。 ------------------------------ Private Sub CommandButton1_Click() If sheet2.Range("E22").Value = "TRUE" Then OptionButton1.Value = True ElseIf sheet2.Range("E22").Value = "FALSE" Then OptionButton2.Value = True End If ------------------------------ お知恵お借りしたく存じます。 宜しくお願い致します。
DoCmd.TransferSpreadsheetでExcelへデータをエクスポートする際に、 シート名にハイフンを使うことはできないでしょうか？ 例えばexcelシート名を"pre-date"とする。 通常だとハイフンはアンダーバーに変換されて保存されますが、 無理矢理、ハイフンをシート名に入れる方法はありませんでしょうか？ よろしくお願いいたします。
Excel2010　VBAでの質問です。 画面上のすべてのトップレベルウィンドウを取り出そうと、標準モジュールに以下コーディングしました。 Option Explicit Declare Function EnumWindows Lib "User32.dll" (ByVal Proc As EnumWinProc, ByVal lParam As Integer) As Boolean Delegate EnumWinProc (ByVal hwnd As IntPtr, ByVal lParam As Integer) As Boolean Sub Main() Call EnumWindows(AddressOf disp_hwnd, 0) MsgBox ("完了") End Sub Function disp_hwnd(ByVal hwnd As IntPtr, ByVal lParam As Integer) As Boolean MsgBox (hwnd) disp_hwnd = True End Function そうしたところ、Delegate 文が赤文字に反転してエラーになります。 Excel2003　VBAでは使えない構文なのでしょうか？あるいは何かのミスなのでしょうか？ 環境ですが、WindowsXP　SP3、Excel2003 SP3です。 .NET Framework1.1、2.0、3.0、4.0がインストールされています。 あと、以下の参照設定はあります。 　　Visual Basic For Applications Microsoft Excel 11.0 Object Library OLE Automation Microsoft Office 11.0 Object Library Microsoft Forms 2.0 Object Library Microsoft Scripting Runtime Microsoft Windows Common Controls 6.0 (SP6) 以上、よろしくお願いします。
エクセルで　Ctrl-End　で　セルの終端に　ジャンプしますが、そこは　何もありません。 それが、１２万行とか、とんでもなく　大きいファイルになっています。 プログラムで　余分な　行や列を削除しますが、全く変化しません。 とりあえず、新しいシートにセル内容をコピーしますが、プログラムは手で移植するより方法がありません。この方法でとりあえず、ファイルは小さくなります。 ネット検索では　エクセルのバグらしき記載がありますが、何か　上手い方法はありますでしょうか
現在ListviewとImagelistを使って同じカテゴリの画像を表示させるものを作成しているのですが、画像が多いを読み込みに時間がかかるので、一度読み込んだImagelistは使い回しができないか試しているのですがうまくいきません・・・ 試した方法なのですが、初回は普通に「Imagelist1」に読み込んで画像が多いもの（例えばImagelist1.Images.Countが20以上）の場合、Imagelistのコントロール？を配列（MyImageList(index)）で作成してそれにコピー、次回はそのコピーしたものを表示するようにしてうまくいった（表示できた）と思ったのですが、一度「ImageList1.Images.Clear()」をするとなぜか関係ないはずのMyImageList(index)の方まで消えてしまうようです・・・なぜなのでしょうか？ 色々試したのですが、どうしてもうまくいきません。Imagelistはこういう使い方はできないのでしょうか？ うまい使い回し（保存・維持）方法があったら教えてください。 VBは2008です。
例えば以下の Dim objIE objIE = CreateObject("InternetExplorer.application") のような記述をすればIEを立ち上げることができると思うのですが、 これらの関数やコマンドは先駆者の方々はどこから知ることができたのでしょうか？ VBA辞典みたいな本を購入してもこういう指示が記載されていなかったりします。 こういったコマンドや記述の仕方を網羅的にのせているサイトなどは存在するのでしょうか？ ご回答のほどよろしくお願いいたします。
以前も質問しましたが、 VB6で音声読み上げしたいのですが、フォームにTextToSpeechというオブジェクトを配置するところまではできましたが、TextToSpeech1.Speakの.Speakのところで「メソッドまたはデータメンバが見つかりません。」というメッセージが出ます。 何が足りないでしょうか？
http://code.msdn.microsoft.com/windowsdesktop/VB … にてブラウザを作ったのですが戻るキー、進むキー、ブックマーク、再読み込み、中止、印刷 など機能をつけたいのですがわかりません Button1=戻る　Button2=進む　Button3=お気に入り　Button4＝再読み込み　Button5=中止　 Button6=印刷 と割り当てたいです。 ちなみにMicrosoft Visual Basic Express 2010です。
Excelファイルについて 現在、mdbに登録されたデータを、 VB.NETを使用してExcelファイルに出力する処理を作成しております。 質問なのですが、 この形式で作成したExcelが、 お客様のPCで動かした際に開こうとすると、 'ファイル名.xls'のファイル形式と拡張子が一致しません。ファイルが破損しているか、安全ではない可能性があります。 発行元が信頼できない場合は、このファイルを開かないでください。ファイルを開きますか？ と言うメッセージが表示されます。 なお、PGを作成したPCのExcelは、2000です。 お客様のExcelのバージョンは確認しておりませんが、 社内にあるOffice2010の入ったPCでは上メッセージは表示されませんでした。 ですので、出力処理自体は間違えてはいないと思います。 上メッセージについて調べてみると、Excel2007でxlsを開こうとすると、 そのメッセージが表示されることがある、とあったのですが、 どうしてそのメッセージが出るのかなどは分かりませんでした。 対処法としてレジストリを変更する方法が書いてあったのですが、 レジストリは極力いじりたくありません。 ほかに対処法などはありますでしょうか？
お世話になります。 Access2000のVBAで、教えて頂ければと思います。 下記の「テーブルA」がある状態で、 「ID=1」の「フィールド：名前」の値を「名称なし」に更新したいのですが、 どのようにVBAで記載したらよいでしょうか？ ------テーブルA------- ID　　名前 1 やまだ ----------------------- お手数ですが何卒宜しくお願いします。
こんばんは 下記マクロで FNameというファイルのグラフの数を数えて名前を取得しGnameというファイル に同名のシートを作成したいのですが 実行時エラー'9'、インデックスが有効範囲にありません.と出てしまいます。 どなたかご存知の方ご教示お願いいたします。 Workbooks(FName).Activate 　For　 s = 1 To Charts.Count Windows(GName).Activate Worksheets.Add ActiveSheet.Name = Charts(s).Name 　Next s
お世話になります。 エクセルVBAで作成しております。 「E:\フォルダ」にある拡張子が「.txt」のファイルを全て、「.xls」の 拡張子に変更したいのですが、どのようにVBAを作成すればよいでしょうか？ 何卒宜しくお願いします。
開いている複数のエクセルブック(.csv)に対して同じ処理を行いたいのですが、いいマクロが分からなくて困っています。ご存じの方がいらっしゃったら、教えてください。 ちなみに、ファイル名は、1 A、1 B、2 A、2 B・・・と言った感じです。 Sub i = 1 Do While i < 9 Windows("i A.csv").Activate ・・・ Loop End Sub とやってみたのですが、ファイルが選択されずに、止まってしまいました。
実践で学ぶ Office Excel 2007 VBAというマクロの学習サイトで Sub Macro実践1() 'ブック シート セルアドレスを指定すればブック シートをアクティブにする必要はない　　　　 　　 Workbooks("転記.xlsx").Worksheets("転記シート1").Range("A1").Value = _　　　　　 　　 Workbooks("データ.xlsx").Worksheets("データ1").Range("A1").Value　　　　　　 　　End Sub　　　　 と入力すると「インデックスが有効範囲にありません」となってしまいます。なにか間違っているのでしょうか？
１０年ほど掛け、VB6を使って趣味で作ったプログラムがあります。 ソースコードが数万行あり、今さら新バージョンに移植する気力がありません。 現在は、XPで使用しておりますが、７や８上でもVB6は稼働するものなのでしょうか？ また、VB本体だけでなく、Office2003のAccessデータベース（mdb）に接続するデータベースアプリなので、Office2003が最新OSで稼働するかも心配です。 XPサポート終了後、どうすれば良いか、迷っています。 良い知恵はありますか？
素人で大変申し訳ございません。 VBAを使用して、「テスト」という文字を「E:\フォルダ\試作.txt」に保存する VBAコードを教えて頂けないでしょうか？ 何卒宜しくお願いします。
エクセルシートの1列に以下のような文字列を打ち込みました。 - a aa aaa aaaa aaaaa - b bb bbb bbbb bbbbb - c cc ccc cccc ccccc - 「-」の2行後をテキストを出力した際のファイル名とし、ファイル名を含んだ次の「-」までの文字列をそのテキストの中に出力したいです。なお、全体の行数は分かっています。 例えば上の文字列に対して実行すると、 a.txt b.txt c.txt というファイルができ、それぞれの中には a aa aaa aaaa aaaaa などがそれぞれ出力されるようにしたいです。 Sub tepa() Dim strFilename As String Dim FileNumber As Integer Dim strREC As String j = 1 For i = 1 To 70 If Cells(i, 1) = "-" Then strFilename = Cells(i + 2, 1) & ".txt" Do While Cells(i + j, 1) <> "-" If i > 70 Then Exit Sub End If FileNumber = FreeFile strREC = Cells(i + j, 1) Open strFilename For Append As FileNumber Print #FileNumber, strREC Close j = j + 1 Loop End If i = i + j Next End Sub さきほど初めてVBAなるものを知り、見よう見まねで書いてみましたが・・・ループに陥ったりテキストファイルが1つめしか出力されなかったりとうまくいきません。 改善点など教えていただけたら嬉しいです。 よろしくお願いします。
お世話になります。 VBAで作成しております。 現在(1)のコードで、「指定したURL」をエクセル保存しているのですが、 「現在開いているページ」エクセル保存したいのですが どのようにすればよいでしょうか？ お手数ですが何卒宜しくお願いします。 ---------(1)------------- Set g_msg = CreateObject("CDO.Message") g_msg.CreateMHTMLBody ★指定したURL, 0, "", "" DoEvents Set g_stm = g_msg.GetStream DoEvents g_stm.SaveToFile ★書き出すファイル名.xls, 2 ----------途中までがんばったところ---------- Dim objIEログイン As Object Set objIEログイン = CreateObject("InternetExplorer.Application") objIEログイン.Navigate "指定したＵＲＬ" ★★★★★★objIEログインを使用して、エクセルに保存したい★★★
VBAで、すべてのファイル（ppt,pdf,txtなど）を選択して開きたい VBA初心者です。ダイアログから選択して様々な形式のファイルを 開きたいのですが、 検索して↓などをみていますが、イマイチわかりません。。。 http://oshiete.goo.ne.jp/qa/1545851.html http://oshiete.goo.ne.jp/qa/7827757.html http://detail.chiebukuro.yahoo.co.jp/qa/question … 【環境　WindowsXP　Excel2000】 ↓これだとPDFを選択はできますが、エクセルに文字化けしてでてきます。 Sub フォルダからファイル選択() Dim OpenFileName As String Dim AAA, ZZZ As String AAA = Sheets("data").Range("A5") ZZZ = "'ChDir "\■.local\pubs\●\△\" & AAA With CreateObject("WScript.Shell") .CurrentDirectory = ZZZ End With OpenFileName = Application.GetOpenFilename("すべてのファイル,*.*") If OpenFileName <> "False" Then Workbooks.Open OpenFileName Else MsgBox "キャンセルされました" End If End Sub 不足情報ありましたら補足致しますので、お教え下さい＞＜；
KenKen_SPさんの素晴らしいコードを参考に、特定の色のセルにおいてのみ、テキストを削除するマクロが以下です。このままでは結合セルのあるエクセルシートでエラーになってしまいます。 これを解決できませんでしょうか。よろしくお願いします。 For i = 1 To ThisWorkbook.Worksheets.Count ThisWorkbook.Worksheets(i).Select Dim C As Range For Each C In ActiveSheet.Range("A1:M55") If C.Interior.ColorIndex = 6 Then '6 - YELLOW C.ClearContents End If Next Next
いつもお世話になっております。また行き詰ってしまいました。 ご助言頂きたくお願い致します。 Ａ列とＢ列にデータが入っていて、Ｂ列には２つのパターンの文字が入っています。 一つは、前の１０文字が必ず半角（英字+９ケタの数字）その後は全角のスペースの後に 全角の文字が並びます。（全角の文字数は不規則） 例１：A123456789　あいうえおかきくけこさしすせそ もう一つは頭からすべて全角文字 例２：あいうえおかきくけこさしすせそたちつてと 問題になっている部分は、このＢ列に入っているデータを頭から 全角１５文字以内、半角なら３０文字以内に収める という所です。 例１だと、 A123456789　あいうえおかきくけこさしすせそ →A123456789　あいうえおかきくけ（半角10文字+全角10文字） 例２だと あいうえおかきくけこさしすせそたちつてと →あいうえおかきくけこさしすせそ（全角15文字） 下記のようなマクロを作ってみたのですが2つのパターンに対応する為にはどうすればよいでしょうか？ Const col1 As String = "B" Dim idx1 As Long Dim myStr1 As String With ActiveSheet For idx1 = .Cells(65536, col1).End(xlUp).Row To 1 Step -1 myStr1 = Cells(idx1, "B") If .Cells(idx1, "B").Value = "" Then Else Cells(idx1, "B") = Left(myStr1, 15) End If Next idx1 End With 以上、宜しくお願い致します。 環境：windowsXP　Excel2003
エクセル内の文字列を以下のように出力したいです。 エクセル内の以下の構成の文字列が複数あります。ファイル名に含まれる文字列shをキーとしてファイル名を検索し、ヒットしたらファイル名下段の文字列達を空白まで１ファイルとして出力したいです。 ファイル名（….sh） 文字列1 文字列2
Excel2003、2007で実行した場合は正常終了するが Excel2010で実行するとVBA終了時に強制終了します。 処理は、マクロありブックからマクロなしブックを作成するために、 新規ブックを作成しマクロありブックからシートを移動する処理です。 VBA起動は、フォームコントロールから行っています。 VBA終了時に(End Sub）後にEXCELがなぜか強制終了します。 （Microsoft Excel　は動作を停止しました。のメッセージが表示される） なお、 ・フォームコントロールから実行した場合はＥＸＣＥＬが強制終了し、 　　デバックモードで実行した場合は強制終了しません。 　・マクロありファイルの種類：Excel 97-2003ブック 　・★★★のソースが含まれていると、Excelが強制終了します。 以下、ソース。 Sub ファイル保存() 　　'マクロなしファイルを作成 CreateNoMacroBook End Sub '←ここで異常終了が発生する。 Sub CreateNoMacroBook() Dim fname As String Dim ns As Integer Dim cnt As Integer Dim i As Integer 'マクロありブックの名前を取得 fname = ActiveWorkbook.Name 'マクロありブックのシート数を取得 cnt = ActiveWorkbook.Worksheets.Count 'すべてのシートをMoveするとエラーになるのでシートを追加 Worksheets.Add After:=Worksheets(Worksheets.Count) '新規ブック作成時のデフォルトのシート数を保管 ns = Application.SheetsInNewWorkbook '新規ブック作成時のシート数を変更 Application.SheetsInNewWorkbook = 1 '新規ブック作成 Workbooks.Add '新規ブック作成時のデフォルトのシート数に戻す Application.SheetsInNewWorkbook = ns 'マクロありブックのシートを新規ブックの"Sheet1"シートの前に移動 For i = 1 To cnt Workbooks(fname).Worksheets(1).Move Before:=Workbooks(Workbooks.Count).Worksheets("Sheet1")　　'★★★ Next i '表示用に新規ブックの一枚目のシートをアクティブにする Workbooks(Workbooks.Count).Worksheets(1).Activate Application.DisplayAlerts = False '新規ブックのデフォルトシート"Sheet1"を削除する Workbooks(Workbooks.Count).Worksheets("Sheet1").Delete Workbooks(Workbooks.Count).Activate Application.DisplayAlerts = True End Sub
ExcelVBAの「For～Nextステートメント」が全くわかりません。 変数にいれるなど、本に書いてあるのですが、、いまいち理解できないです。
VB.NET でウインドウの位置だけを変更するのに、次のMoveWindowsを使用しましたが、サイズも変更されました。 　　MoveWindow(hWnd, 0, 30, 0, 0, 1) ウインドウのサイズを変えないで、位置だけを変更する指定方法をご教示して頂きたくお願い致します。
はじめまして。 定期的に数十のインデザインファイルを開き、各ファイルで使った画像を片っ端から手作業で削除する作業を行う係りが自分に回ってきてしまいました。 日頃IllustratorとPhotoshopを多用しているので、「こんなのマクロでしょ」と思いきや、インデには何故かマクロ機能がなく、代わりにスクリプトで何とかできる「かも」ということが分かりました。 やりたいことは以下の通りなのですが、簡単にできるものでしょうか？ 1.特定のフォルダ内にある全インデファイルを開く 2.全てのファイルで使われている画像データを削除 3.全ファイルを上書き保存 osはwindowsなのでVBで対応すべく書籍を買い込み学習を開始しました。 どなたかヒントをいただければ幸いです。 それにしてもアドビさん、なぜインデにはマクロ機能つけてくれなかったの(T . T)
２つのシートを操作するマクロを書いています。 Worksheets(A).Range("A1").Value = Worksheets(B).Range("A1").Value Worksheets(A).Range("B1").Value = Worksheets(B).Range("B1").Value Worksheets(A).Range("C1").Value = Worksheets(B).Range("C1").Value ・ ・ ・ 簡単に書くとこのような感じです。 =の両辺ともうまくWithでまとめてすっきりさせることは可能ですか？
お世話になります。 VBAで作成しております。 VBAで固定配列、Array(20000,256)を使用しています。 この配列を使用している時には、この配列だけで 具体的にメモリをどれくらい使用しているのでしょうか？ もし、配列の中にどれくらい値が入っているか等、 条件が必要でしたら、その条件を指定した上で メモリの使用量を教えて頂ければと思います。 タスクマネージャなどで、自分で調べろ・物によるなどの 回答は結構ですので宜しくお願いします。 以上宜しくお願い致します。
すみません。一度質問を載せた後で、補足で絵を載せようとしたのですができなかったので 再投稿させていただきます。（元の質問はけしました。） -------------------------------------- こんにちは、今作成しているエクセルのVBAで配列を膨大に食ってしまい、メモリ不足に落ちいるという現象に悩まされています。 そのため、なるべくいらなくなった配列はEraseステートメントを使って解放しようとしてるのですが、 これが上手くいっている気がしません。 ためしにフォームと、ラベルを1つずつ用意し、下記のような配列をどこまで作れるか計算するプログラムを組んでみました。 1回目、ans(i) に"a"というaを1個のみ格納した場合で計算すると、配列は2970万個できます。 2回目、ans(i) に"aaa～a"というaを64個格納した場合で計算すると、配列は770万個できます。 まぁ、ここまでは当然の結果だと思います。 可変長のString型変数の場合は、割り当てられるメモリサイズが固定ではないらしいので (前回の質問で教えてもらいました) しかし3回目、ここでもう一回、1回目と同じ、"a"を一個のみ格納した場合で計算してみます。 私の予想では1回目と同じ2970万個程度の配列が作れると思っていました。 なぜなら、Eraseステートメントでメモリを解放していたし、 タスクマネージャーのPF使用量（おそらくメモリの値）を見ても2回目を実行した後の値は 1回目前と同じ値に戻っているからです。 しかし、実際試してみると、 2回目と同じ770万個の配列しかつくれませんでした。 つまり、Eraseステートメントを使用しても配列の上限値は元の状態に戻らなかったのです。 どうすれば、配列を再び2970万個作れる初期の状態に戻せるのでしょうか？ 現時点ではエクセルを起動しなおせば、元に戻りますが、それでは困ります (プログラムの途中で配列の数を減らしたり、コピーしたりを行っている為、 どうしてもプログラム中でメモリの解放を行いたいからです) また、添付した絵は、実行した時のタスクマネージャーの様子です。 参考になれば幸いです どうか、みなさんお知恵をお貸ししてください --------------------------------------------------- '実行するときは、フォームとラベルを1つずつ用意して実行してください Public Sub 配列上限取得計算() On Error GoTo ErrEnd Dim i As Long Const kankaku As Long = 100000 Dim ans() As String ReDim ans(1 To kankaku) As String ans(1) = 1 i = 2 UserForm1.Show vbModeless Do If i Mod kankaku = 0 Then DoEvents UserForm1.Label1 = i ReDim Preserve ans(1 To i + kankaku) As String End If '最初にaを1個のみ格納した場合は、2970万個まで配列が作れるが、次にaを64個格納した場合は770万個まで作れた。 'しかし、その直後にまた、aを1個のみ格納した場合で実行してみると、770万個しか作れない 'つまり、Eraseステートメントを使っているにも関わらず、同じ条件のプログラムでも配列の上限が下がってしまう。 'この現象をなんとか回避したい。元の状態にリセットするにはエクセルを起動しなおさないと直らない。 '1回目と3回目に実行するコード、2回目はコメントアウトしてください ans(i) = "a" '2回目に実行したコード、2回目はコメントアウトを解除してください。 ' ans(i) = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" i = i + 1 Loop Erase ans Unload UserForm1 Exit Sub ErrEnd: Erase ans MsgBox "これ以上の配列を設定できません。" & vbCrLf & "上限は" & i & "です。" & vbCrLf & Err.Description Unload UserForm1 End Sub
VB2010でTextboxで辺の長さの数値を入力し、その数値分「＊」を表示して正方形を作るアルゴリズムを考えています。どんな感じかは添付画像を参照していただければと思います。 Dim saizu As Integer Dim i, j As Integer saizu = TextBox1.Text For i = 1 To saizu For j = 1 To saizu Label1.Text = "*" Next Label1.Text = vbLf Next 考え方はこんな感じだと思うのですが、このままだとLabel１の中身が毎回更新されてしまい、結局何も表示されないという結果になることに気づきました。 確かVBにはLabelの手前に何か連結演算子のようなものをつけることで、更新されるのではなく追加していくというふうにできたと思うのです(記憶違いならこの質問自体が意味のないことになってしまうのですが…)。検索エンジンでいろいろと検索しては見たのですが、検索ワードがどれも曖昧な所為か私が必要としている答えにたどり着くことができませんでした。 曖昧な質問で申し訳ないのですが、Labelなどで文字を更新するのではなく結合する連結演算子のようなものを回答していただけたらありがたいです。もし、そんなものはないよ、という場合も教えていただければと思います。よろしくおねがいします。
色々検索しているのですが。 MailはWebのメンバではありませんというメッセージが出ます。どうすれば良いでしょうか。 System.Web.Mail.SmtpMail.Send( _ "system@sample.domain", _ "kodai@sample.domain", _ "プログラムから送信する電子メール", _ "この電子メールはプログラムから送信しています。" & vbCrLf _ & "これは本文の2行目です" & vbCrLf)
WINDOWS XPのACCESS97で稼動しているPGをWINDOWS7のACCESS2003にMDBを変換しました。 変換は成功しましたがある集計表の数字がＸＰのものと違うのです。そのPGを２回、３回と実行すると 毎回、計算結果が違います。変数や配列のクリアの問題かな？と思い処理の頭でクリア処理をしていますが、結果は同じです。ＰＧの概要としては、マスターファイルを指定された情報を持つレコードをクエリーで抽出してそのデータをコードで集計して画面に表示するものです。ちなみに、実行するたびにクエリーの抽出件数は同じです。このデータを集計するのですが、実行するたびに結果が増えたり減ったりします。単に増えていくだけではないのです。　他にも似たような処理のＰＧは何本もありますが、すべて問題なく動いています。何をどこから考えてよいか、途方にくれています。何かアドバイスをお願いします。
ご教示お願いいたします。 あるフォルダ内に60個以上のhtmlファイルがあります。 それを今手作業で、メモ帳で開き 2013/7/26 という日付を、 2013/7/27 にと日付の書き換えを行っています。 さすがに作業が大変になり、しかもこれからこのhtmlファイルが、 どんどん増えていきます。 そこでVBSを使ってフォルダ内にある、 全てのhtmlファイルをメモ帳で開き、 中の文字を置換させる事は可能でしょうか？ もし可能であればお手数ですが、 コードを教えて頂けると非常に助かります。 そうすれば今後は実行ファイル1つの置換文字を編集すれば、 できるので大変手間が省けます。 自身で色々検索してみましたが分かりません。 また社内はフリーソフトのダウンロードも、 セキュリティ上禁止されてるためそれも頼れません。 他のサイトでも現在情報収集はしてますが、 ぜひみなさまのお力を貸して頂きたいです。 長文になりましたが、ぜひよろしくお願いいたします。
ExcelSheet1に表ー１のように氏名の列に記号が入力されています。 B列の指定記号（A,C,F,H）のみSheet2にVBAコードにてコピーしたいのですが。 尚、A列氏名は元々入力されています。 因みに、Sheet2の先頭列がSheet1と同様ですがコピー位置がE1等、任意に設定したいのですが。 どなたか解る方よろしくお願いします。
お世話になります。 VBScriptを扱うのは初心者です。 運用SEをして、複数のシステムをログインし、閲覧できるか手動で監視していますが、以下のネット上のサンプルを参考にスクリプトを作成しましたが、以下の課題が出てきましたので、対応方法を教えて頂けないでしょうか？宜しくお願いします。 ■スクリプト Option explicit 'オブジェクトの作成（IE） Set IEObj = CreateObject("InternetExplorer.Application") Dim MemID,UsrPass,IEObj MemID = "xxxxxx" UsrPass = "xxxxxx" With IEObj .Visible = True 'URL .Navigate "http://xxxxx" While .Busy Or .ReadyState <> 4 Wend .document.all.Item("jossoname").Value = MemID .document.all.Item("jossopasswd").Value = UsrPass .document.forms(0).submit End With Set IEObj = Nothing ■課題 上記、スクリプトは正常に起動し、該当システムを自動的にログインされます。 (1)自動ログインした画面を自動的に閉じたいのですが、どのように定義すればいいのですか？ (2)複数のシステムを上記のように自動ログインしたいのですが、１つのVBSで処理できる定義をおしえてください。(1)も考慮した形でお願いします。 以上、何卒宜しくお願いします。
こんにちは、配列がいくつまで取得できるのか計算するマクロを作っている時に変なことに気が付きました。 エクセルでフォームとラベルを1つ用意し、下記のようなプログラムをモジュールに書きます。 実行すると、10万ずつ数字が増えていき、数字が1000～2000万超えたあたりで、メモリ不足ですという 表示がでます。 ここで、ReDim PreserveのPreserveをとって、ReDimだけにすると、数字の増え方が目に見えて遅くなります。 ReDim Preserveとしたときは9.5秒ぐらいですが ReDim の時は 30秒以上かかっています 3台のマシンでテストしましたが、どれも似たような結果になりました 普通に値を保持するredim Preserveの方が遅いと思うのですがなぜこのような結果になるのでしょうか？ ご教授お願いいたします。 Public Sub 配列上限取得計算() On Error GoTo ErrEnd Dim i As Long Const kankaku As Long = 100000 ReDim ans(1 To kankaku) As String ans(1) = 1 i = 2 UserForm1.Show vbModeless Do If i Mod kankaku = 0 Then DoEvents UserForm1.Label1 = i 'ここのPreserveをなくすと明らかに遅くなる ReDim Preserve ans(1 To i + kankaku) As String End If ans(i) = i i = i + 1 Loop Erase ans Unload UserForm1 Exit Sub ErrEnd: MsgBox "これ以上の配列を設定できません。" & vbCrLf & "上限は" & i & "です。" & vbCrLf & Err.Description Erase ans Unload UserForm1 End Sub
同様の質問が多いと思いますが困っておりますので一読をお願い致します。 VBではないのですが、C言語やCPUについての書籍「はじめて読むC言語―プログラミング環境のスタンダード 蒲地 輝尚 (1991/5)」「はじめて読む8086―16ビット・コンピュータをやさしく語る (アスキーブックス)」はメモリ上でどのように動いているかまで言及されていて、根本についてとてもわかりやすく、勉強になりました。このような方法でVBを解説している書籍はないでしょうか？ 現在は「Visual Basic 中学校」のサイトを利用していて勉強の助けになっていると感じています。ただこのサイトは現在進行形で解説を行っていて完結していないので書籍を探そうと考えています。特に本サイトの「初級講座」の「第２章 基本構文」「第４章 さらなる探求」「第６章 クラス」と「中級講座」の内容を基礎（簡単という意味ではない）から学びたいと思っています。 今のところ目次をみて「VB.NET基礎学習Bible」は良いのではないかと考えています。 このような文章で申し訳ありませんが、どうぞよろしくお願いします。
マクロの記録ぐらいしかわかりません。 表を分析させて、組換えれるようなプログラムがうてるように なりたいです。 まずはなにからやればいいでしょうか。
いつもお世話になります。 ５万行のエクセルデータで、A列に２０種類のデータが重複しています。 このデータを、別シートのA１～A２０に１種類ずつコピーしたいのです。 オートフィルタ→フィルタオプション→重複するレコードは無視するでチャレンジしてみたのですが、５万行だとデータ量の関係で時間がかかりすぎるので、VBAでもっと短時間で出来ないかと思い、投稿させていただきました。 よろしくお願いいたします。
VBAで配列のデータを部分的に削除してその削除した後のデータを前に詰めたいのです 配列のデータ 00１ X 002 Y　←この行を削除した配列にしたい 003 Z 削除後の配列データ 001 X 003 Z こんなイメージなのですが、配列の削除して前につめるという処理はどのように すればいいでしょうか？ １行で実現できるような配列処理用のメソッドがあるのでしょうか？ ２次元配列を行削除して前につめる処理なのですがアドバイス下さい
「薬品入力」のシートに書いてある内容をグループごとに「保管場所VBA」シートに取り出すためにはどうしたら良いのですか。 たとえば、薬品入力のシートに「亜鉛　E　１」　と入力してあったら、 保管場所VBAのところにEと入力すると　亜鉛　E 1　が出るようにしたいです。 以下は、以前に質問して、お答えいただいた内容を参考にしてつくりました。 しかし、「オブジェクトが必要です。」と出てしまいます。 どうしたら良いのでしょうか。 よろしくお願い致します。 Sub 薬品管理() Dim 保管, 薬品名 As Worksheet Dim 場所入力 As String Dim 縦, 行 As Integer Dim 保管最大, 薬品名最大 As Integer Set 保管 = Worksheets("保管場所VBA") Set 薬品名 = Worksheets("薬品名入力") 場所入力 = 窓.Cells(3, 2).Value '保管場所VBAシート　C列の最終行を取得し、最終行が5以上であれば、B6～C列最終行までの値を削除する 保管最大 = 保管.Range("B" & Rows.Count).End(xlUp).Row If 保管最大 > 5 Then 保管.Range("B6:C" & 保管最大).ClearContents '薬品名入力シート　B列の最終行を取得 薬品名最大 = 薬品名.Range("B" & Rows.Count).End(xlUp).Row 縦 = 6 For 行 = 3 To 薬品名最大 If 薬品名.Cells(行, 4).Value = 場所入力 Then '薬品名入力ートのB列～DH列の値を保管場所シートのB～G列に出力する 保管.Cells(縦, 2).Resize(, 3) = 薬品名.Cells(行, 2).Resize(, 3).Value 縦 = 縦 + 1 End If Next 保管.Activate End Sub
対話形式のプログラミングについての質問です。 ４つの質問をして、その結果プリウス、BB、エスティマの３車種どれが最適か提供する対話形式のプログラミングを組みたいのですが、どうしてもうまくいかず、実際にプログラミングを組んでいただきたいです。 質問は年齢、家族構成、給与、住居の種類。 三択の質問を４回答えさせて結果をだしたいです。 条件の結果として、 １８～３０歳まではBB、３１～４５歳まではプリウス、４６歳～６５歳まではエスティマ 家族構成＝３人まではBB、４人ならプリウス、５人から８人まではエスティマ 給与＝年収５００万まではBB、５０１万～１０００万まででプリウス、１００１万～１５００万まではエスティマ 住居＝アパートの場合BB、 マンションの場合はプリウス、１戸建ての場合はエスティマ この条件の中、プログラミングを組みたいと考えております。 ※４つの質問のうち、プリウス２回・エスティマ２回の回答がでた場合、結果としてプリウスとエスティマが最適です というように２種類の提供がされる。 プリウスの該当が最も多ければ結果プリウスというように結果が表示される よろしくお願いいたします。
エクセルVBAの質問です。 一つ一つコードを試しては動きを確認するという作業を始めたばかりの初心者です。 VBAで他のブックからデータを取得するにあたっては、その参照先のブックの行列は絶対いじってはならないものだと理解しています。でも、行列が変わってしまう可能性があるため、参照先のブックの値を、行列ではなく、たとえば「“4月”かつ“売上”の交わるセルから数値を取得せよ」のように、参照先のブック内の文字列を読みにいって、そこから取得するような考え方は成り立つでしょうか。もし成り立つ場合は、どのように組めるものなのか、考え方を教えていただけませんでしょうか。 何卒よろしくおねがいいたします。
ＷＩＮ８　の　ディスクトップアイコンの　プロパティーの記述が　以下の通りですが "C:\Program Files (x86)\MarketSpeed\MLauncher\MLauncher.exe" RSS これを、エクセルから起こしたいのですが、上手くゆきません。 rc = Shell("c:\Program Files (x86)\MarketSpeed\MLauncher\MLauncher.exe", vbMinimizedNoFocus, "RSS") RSS,EXE　が　ホルダーは変わりますが　存在します。これが、引数だと思うのですが エラーが出ます。引数が不一致、もしくは不正なプロパティー　が出ます。 ところが、このＲＳＳコマンドもいい加減というか ダイレクトに叩いて起動かけることも出来る様で、その利用プログラムに不自由は出ないのです じゃあ f = "c:\Program Files (x86)\MarketSpeed\MarketSpeed\RSS.exe" Shell f, vbHide　 でも　同じようなエラーが出ます。 RSSを　引数にする方法が間違っているのかもしれません。 何か　お気づきの点があれば　よろしくどうぞ
VBAで以下の様なマクロを組みたいです。 新規シートを作成する→その作られたシートにボタンを設置→ボタンにコードを組み込む というマクロを組みたいのですが、そういうのは難しいでしょうか・・・ どなたかよろしくお願いします。
お世話になります。 Access2000のVBAで、テーブルの取り込み処理に ついて教えて下さい。 下記のようなソースで、ACCESSのテーブルを取り込み →エクセルに書き出しをしているのですが、 (1)の箇所で取り込み処理の時間が大量にかかっていることが わかりました。 処理速度が速くなるような、別のコーディングがあるのでしたら 教えて頂きたいので宜しくお願いします。 ----------ソース-------------------------- --------(1)--------------- With CurrentDb.QueryDefs(テーブル) .Parameters("[ID]") = "1111" Set rs = .OpenRecordset End With --------(1)--------------- If (Not rs.EOF) Then oApp.Sheets(1).cells(count, i + 1) = rs(i).Name oApp.Sheets(1).cells(count + 1, 1).CopyFromRecordset rs End If rs.Close Set rs = Nothing db.Close -----------------------------------------
初めまして。初めて投稿します。 今までWINXPで動作していたシステム（開発言語：VB6.0　データベース：ACCESS・MDBファイル）を、XPが終了するのでWIN7に載せ替えをしたいのですがエラーが発生してできません。 何かいい対策方法があれば教えてください。 エラー内容：「ファイルｘｘｘｘは既に使用されているため、使用できませんでした」 エラー発生ポイントは、上記ファイルをプログラム内で作成してそのファイルを使用してグリッドを表示使用とした時に発生しているみたいです。 （作成コマンド：Set wkdb = hkws.CreateDatabase(TMP_DIR & "WKDB.MDB", dbLangJapanese)） フォルダはPGMが動作しているパソコン内で、ルートの直下に新規作成しています。 PGM終了させた後にACCESSで該当するファイルを開くと、エラーなく開くことができます。 パソコン環境：WIN7-Pro（SP1）32Bit　VB：6.0
　下記のコードで1つのセル(A1)が変更されたら入力前の元データを別シート(A1)に保存できるようにしたのですが、指定範囲(I10:CW42,2行3列を一升)のセルが変更されたら別シートの指定範囲(I10:CW42)に保存できるようにしたいのですが方法がありましたらお教え下さい。お願いします。 Windows7・SP1 Office2010 Private Sub Worksheet_Change(ByVal Target As Range) If Target.Address <> "$A$1" Then Exit Sub Application.EnableEvents = False Application.Undo Sheets("Sheet2").Range("A1").Value = Range("A1").Value Application.Undo Application.EnableEvents = True End Sub
VBでスマホで使える（検索のみ）データベースを作成する事は可能ですか？
Visual Basicについての質問です。 Visual BasicでボタンA（仮称）を押してファイルのブラウズ画面を表示してファイルを選択します。その次にボタンB（仮称）を押してファイルのブラウズ画面を開き、フォルダを選択します。最後にボタンC（仮称）を押してボタンAを押して選択したファイルをボタンBで選択したフォルダにコピーする。 というようなプログラムを作りたいですがコードがわからないのでどなたか教えていただけませんか？
エクセルVBAで実行時は正確に動かないが、ステップインでは正常に作動するのはなぜですか？ 入力シートに入力された情報を元にデータシートから抽出を行い、新規シートを開き、そこでリストにしたい情報のみを編集（不要なタイトル行などの削除）して、自動で貼り付けと名前の定義を行うマクロを作っています。 ステップイン[F8]や実行[F5]では正常に作動するのですが、実際に使用してみると、抽出データが貼り付けされていない状態(セルは空白)となりますが、名前の定義は抽出データと同じ行まで定義されているので、貼り付けのみ上手くいっていないように思われます。 下記が作成したコードです。情報が足りないようでしたら、申し訳ありません。 お手上げ状態となっていますので、お力添えいただけると幸いです。 Dim syurui as String Dim suuryou as Integer Dim target as Range Private Sub Worksheet_Change(ByVal target As Range) If Intersect(target, Range("D7")) Is Nothing Then Exit Sub Else Call 抜出 End If End Sub Sub 抜出() Worksheets("データ").Activate ’後に出てくる名前初期化でエラーを防ぐため仮定義 ActiveWorkbook.Names.Add Name:="番号", _ RefersTo:=Worksheets("データ").Range("K2") syurui = Worksheets("入力").Range("D9").Value Worksheets("データ").Select Set target = Worksheets("データ").Range("M2") With Worksheets("データ").Range("D1") .AutoFilter field:=4, Criteria1:=syurui .CurrentRegion.SpecialCells(xlVisible).Copy With Worksheets.Add .Paste ’不要な行を削除 .Rows(1).Delete .Range("A:D").Delete .Range("B:F").Delete ’抽出した情報を貼り付け＆新規シート削除 .UsedRange.Copy target Application.DisplayAlerts = False .Delete Application.DisplayAlerts = True End With .AutoFilter End With ’抽出データの最終行を調べる suuryou = Worksheets("データ").Cells(65536, "M").End(xlUp).Row If suuryou = 1 Then Worksheets("入力").Activate Exit Sub Else Range("番号").Name.Delete ActiveWorkbook.Names.Add Name:="番号", _ RefersTo:=Worksheets(”データ").Range("M2:M" & suuryou) End If Worksheets("入力").Activate End Sub
Visual Studio C# 2012でアプリを作成しています。 以下のような処理ができるようにしたいのですが、何か良い方法はありますでしょうか？ --------------------------------------------------------------- numericupdown　にある値を入力 ↓ アプリを終了 ↓ アプリ起動時に、終了する前に入力していた値をデフォルトで表示させる。 --------------------------------------------------------------- まだC#の勉強を始めたばかりの初心者です。 何か良い方法があれば教えて頂ければと思います。 よろしくお願いいたします。
Private Sub コマンド1_Ckick() If リスト = "1"Then DoCmd. TransferSpreadsheet acExport_ , , "クエリ1","MicrosoftExcel(*.xlxs)" ElseIf リスト = "2"Then DoCmd. TransferSpreadsheet acExport_ , , "クエリ2","MicrosoftExcel(*.xlxs)" End If End Sub ------------ リスト（1 Or 2）を選択後、コマンド1をクリックすると、 リストの選択に合わせてクエリをエクセル出力したいです。 行数が１０万行と多い為、 行数制限があるマクロビルダーの「書式を保持してエクスポート」を使わず XLXS形式で出力したいです。 しかし、上のVBAを実行したところ、 「データベースまたはオブジェクトは読み取り専用なので更新できません」 というエラーが出てしまいます。 どこを訂正すればよいのかわからず困っています。 どうかご教授の程、よろしくお願いいたします。
お世話になります。 マクロ側のソルバー機能を利用して係数を推定しようと考えています。 係数の置き場所はワークシートです。計算値、実測値も同様です。 ただし、ワークシートに打ち出す計算値は外部dllで行います。 コードの概要は以下の通りです。 sub cal call 外部dll end sub optsolver For i = 1 To 100 Call cal SolverOk SetCell:="E18", MaxMinVal:=2, ValueOf:="0", ByChange:="D3:D4" SolverSolve UserFinish:=True SolverFinish KeepFinal:=1 Next i end １回目のステップではワークシート上に計算値が得られるのですが、 ２回目以降はセルの値（係数や計算値）が更新されませんし、結果として係数も推定できません。 100回くらい画面がちらついて、終わりの表示もなく終わります。 ここでいう係数と計算値は連動していないとソルバーは使えないと どこかで聞いたことがあるのですが、このためでしょうか。 （連動って、設定の数値を変えれば自動で追随することだろうとおもいます。） 使用環境は winxp pro sp2 excel 2003 です。
ACCESSのVBA初心者です。 基本的な質問で申し訳ないのですが、どうかご教授をお願いします。 まず、まったく同じフィールドを持つテーブル1とテーブル2があります。 抽出したい項目は、テーブル1の中にある[性別]と[登録月]が一致するデータの全てです。 性別と登録月は別のフォームのコンボボックスで選択したもので抽出しようと思っています。 該当するデータが含まれているレコードを全てテーブル2に移したいです。 説明が下手で申し訳ないのですが、どうかご教授をお願い致します。 Dim rs As DAO.Recordset Set db = CurrentDb() Set rs = db.OpenRecordset("テーブル1", dbOpenDynaset) DoCmd.RunSQL "DELETE FROM テーブル2" rs.Filter = " テーブル1.性別　=　テーブル2.性別　&　テーブル1.登録月　=　テーブル2.登録月" テーブル2 = テーブル1.RecordsetClone 最初にdeleteがあるのは、前回の抽出条件を消したいからです。 よろしくお願い致します。
初めまして。 現在、vb.netを使用して開発しているのですが、 DirectCastやCtypeなど、どの場合にどの関数を使うべきかがよくわかりません、 よろしければ、以下の点について、教えていただけませんか？ 教えて欲しいこと ・DirectCastとCtypeの違いについて ・CstrとToStringとconvertの違いについて ・上記の2つについて、どの場合に使い分ければよいかについて 上記のことが纏まっているサイトがあれば、そのサイトも紹介してほしいです。 自分なりに調べた結果 ・継承関係にあるObject型に変換するならDirectCastがよい。 ・継承関係にない型変換の場合は、Ctypeがよい。 ・Cstr、ToString、convertは、nullやNothingをどう扱うかによって使い分ければよい 以上、よろしくお願い致します。
Oracleからデータを取得し、Accessで帳票を作成するプログラムを作成したのですが Oracleのデータベースをもう１つ増やしたところ（バックアップをとりました） AccessのプログラムがOracleに接続できなくなりました。 どんな原因が考えられますか？よろしくお願いします。
お世話になります。 ArrayA(10,10)とArrayB(10,10,5)があります。 ArrayA(10,10)をArrayB(10,10,1)にコピーしたいのですが、 どのようにすればよいでしょうか？ forで回すしか方法はないのでしょうか？ お手数ですが宜しくお願いします。
お世話になります。 Access2000のVBAを使用して エクセルにデータを取り込みたいと 思っています。 現在は、下記の(1)のソースで、エクセルのデータを Access2000に取り込んでいます。 しかしながら、「取り込み開始」の箇所を >あと、アクセスのインサートはＳＱＬ一発のほうが早いと思う。 >http://www.1keydata.com/jp/sql/sql-insert-into.php というアドバイスを頂きました。 しかしながら、私の知識がまったくなく、どのように コーディングしていいのかわからない状態です。 そこで、お手数でもうしわけございませんが、 下記の(1)のソースをSQLで使用した場合のコードを 教えて頂けないでしょうか？ 私が馬鹿のため、ソースコードで頂きたいので、 ソースコードがわからないかたは、回答頂かなくて 結構ですのでよろしくおねがいいたします。 ------------ソース(1)---------------- Set oApp = CreateObject("Excel.Application") oApp.Workbooks.Open FileName:=CurrentProject.Path & "\メイン.xlsm" ---------------取り込み開始------------- rs2.Open "選手", CurrentProject.Connection, adOpenForwardOnly, adLockOptimistic iRow = 2 sheet = "program" rs.Open "選手情報_選手ID", CurrentProject.Connection, adOpenForwardOnly, adLockOptimistic iRow = 2 ' ★ sheet = "program" While (oApp.Sheets(sheet).cells(iRow, 1) <> "") rs.Filter = "日=" & oApp.Sheets(sheet).cells(iRow, 2) rs.Filter = rs.Filter & " and 場=" & oApp.Sheets(sheet).cells(iRow, 1) rs.Filter = rs.Filter & " and 番号=" & oApp.Sheets(sheet).cells(iRow, 3) If (rs.EOF) Then rs.AddNew rs("日") = oApp.Sheets(sheet).cells(iRow, 2) rs("場") = oApp.Sheets(sheet).cells(iRow, 1) rs("番号") = oApp.Sheets(sheet).cells(iRow, 3) End If rs("1番") = oApp.Sheets(sheet).cells(iRow, 5) rs("2番") = oApp.Sheets(sheet).cells(iRow, 5 + 26) rs("3番") = oApp.Sheets(sheet).cells(iRow, 5 + 26 + 26) rs("4番") = oApp.Sheets(sheet).cells(iRow, 5 + 26 + 26 + 26) rs("5番") = oApp.Sheets(sheet).cells(iRow, 5 + 26 + 26 + 26 + 26) rs("6番") = oApp.Sheets(sheet).cells(iRow, 5 + 26 + 26 + 26 + 26 + 26) rs.Update iRow = iRow + 1 Wend rs.Close ---------------取り込み終了------------- ---------------取り込み開始------------- rs.Open "選手情報_選手名", CurrentProject.Connection, adOpenForwardOnly, adLockOptimistic iRow = 2 ' ★ sheet = "program" While (oApp.Sheets(sheet).cells(iRow, 1) <> "") rs.Filter = "日=" & oApp.Sheets(sheet).cells(iRow, 2) rs.Filter = rs.Filter & " and 場=" & oApp.Sheets(sheet).cells(iRow, 1) rs.Filter = rs.Filter & " and 番号=" & oApp.Sheets(sheet).cells(iRow, 3) If (rs.EOF) Then rs.AddNew rs("日") = oApp.Sheets(sheet).cells(iRow, 2) rs("場") = oApp.Sheets(sheet).cells(iRow, 1) rs("番号") = oApp.Sheets(sheet).cells(iRow, 3) End If rs("1番") = oApp.Sheets(sheet).cells(iRow, 1 + 5) rs("2番") = oApp.Sheets(sheet).cells(iRow, 1 + 5 + 26) rs("3番") = oApp.Sheets(sheet).cells(iRow, 1 + 5 + 26 + 26) rs("4番") = oApp.Sheets(sheet).cells(iRow, 1 + 5 + 26 + 26 + 26) rs("5番") = oApp.Sheets(sheet).cells(iRow, 1 + 5 + 26 + 26 + 26 + 26) rs("6番") = oApp.Sheets(sheet).cells(iRow, 1 + 5 + 26 + 26 + 26 + 26 + 26) rs.Update iRow = iRow + 1 Wend rs.Close ---------------取り込み終了-------------
VB6でListを使っています。 最初、Listに複数のデータが入っています。 何かデータを取得したら、、Listの該当するところのデータを変えていきたいのですが、できますか？ Additemで項目の追加はしたことがありますが、変更の仕方が分かりません。 ただし、最初にあるデータはそのままで変わったところだけ変更していきたいです。
お世話になります。 Access2000のVBAでエクセルのマクロとアクセルのマクロを 交互に実行したいと思っております。 (1)エクセルのマクロ1を実行 (2)アクセスのマクロAを実行 (3)エクセルのマクロ2を実行 と交互に実行したいのです。 下記のサイトなどを参考に試みたのですが、 http://www.nurs.or.jp/~ppoy/access/access/acX005 … (1)を実行している途中に (2)が進んでしまいます。 どのようにすれば、(1)が終わってから(2)と、前の処理が 終わってから次の処理に進むことが出来るのでしょうか？ Access2000のVBAから指示をかけたいので、 Access2000のVBAのコードで教えて頂ければと 思います。
お世話になります。 Access2000のVBAでコードを作成したのですが、 処理をもっと早く出来る方法ありましたら教えて頂ければと 思います。 処理している内容としては、 (1)データ元のエクセルファイルを開く (2)エクセルファイルに記載されているセルの内容をAccessに挿入 ※取り込み開始・終了が200回程繰り返す ※While (oApp.Sheets(sheet).cells(iRow, 1) <> "")のループは500回程繰り返す 少しでも処理を速くする方法があれば教えて頂きたいので 宜しくお願い致します。 ------------ソース---------------- Set oApp = CreateObject("Excel.Application") oApp.Workbooks.Open FileName:=CurrentProject.Path & "\メイン.xlsm" ---------------取り込み開始------------- rs2.Open "選手", CurrentProject.Connection, adOpenForwardOnly, adLockOptimistic iRow = 2 sheet = "program" rs.Open "選手情報_選手ID", CurrentProject.Connection, adOpenForwardOnly, adLockOptimistic iRow = 2 ' ★ sheet = "program" While (oApp.Sheets(sheet).cells(iRow, 1) <> "") rs.Filter = "日=" & oApp.Sheets(sheet).cells(iRow, 2) rs.Filter = rs.Filter & " and 場=" & oApp.Sheets(sheet).cells(iRow, 1) rs.Filter = rs.Filter & " and 番号=" & oApp.Sheets(sheet).cells(iRow, 3) If (rs.EOF) Then rs.AddNew rs("日") = oApp.Sheets(sheet).cells(iRow, 2) rs("場") = oApp.Sheets(sheet).cells(iRow, 1) rs("番号") = oApp.Sheets(sheet).cells(iRow, 3) End If rs("1番") = oApp.Sheets(sheet).cells(iRow, 5) rs("2番") = oApp.Sheets(sheet).cells(iRow, 5 + 26) rs("3番") = oApp.Sheets(sheet).cells(iRow, 5 + 26 + 26) rs("4番") = oApp.Sheets(sheet).cells(iRow, 5 + 26 + 26 + 26) rs("5番") = oApp.Sheets(sheet).cells(iRow, 5 + 26 + 26 + 26 + 26) rs("6番") = oApp.Sheets(sheet).cells(iRow, 5 + 26 + 26 + 26 + 26 + 26) rs.Update iRow = iRow + 1 Wend rs.Close ---------------取り込み終了------------- ---------------取り込み開始------------- rs.Open "選手情報_選手名", CurrentProject.Connection, adOpenForwardOnly, adLockOptimistic iRow = 2 ' ★ sheet = "program" While (oApp.Sheets(sheet).cells(iRow, 1) <> "") rs.Filter = "日=" & oApp.Sheets(sheet).cells(iRow, 2) rs.Filter = rs.Filter & " and 場=" & oApp.Sheets(sheet).cells(iRow, 1) rs.Filter = rs.Filter & " and 番号=" & oApp.Sheets(sheet).cells(iRow, 3) If (rs.EOF) Then rs.AddNew rs("日") = oApp.Sheets(sheet).cells(iRow, 2) rs("場") = oApp.Sheets(sheet).cells(iRow, 1) rs("番号") = oApp.Sheets(sheet).cells(iRow, 3) End If rs("1番") = oApp.Sheets(sheet).cells(iRow, 1 + 5) rs("2番") = oApp.Sheets(sheet).cells(iRow, 1 + 5 + 26) rs("3番") = oApp.Sheets(sheet).cells(iRow, 1 + 5 + 26 + 26) rs("4番") = oApp.Sheets(sheet).cells(iRow, 1 + 5 + 26 + 26 + 26) rs("5番") = oApp.Sheets(sheet).cells(iRow, 1 + 5 + 26 + 26 + 26 + 26) rs("6番") = oApp.Sheets(sheet).cells(iRow, 1 + 5 + 26 + 26 + 26 + 26 + 26) rs.Update iRow = iRow + 1 Wend rs.Close ---------------取り込み終了-------------
　特定のセル(A1)の入力操作を取り消しA1の元データを別セル(B1)にコピペした後、再度セル(A1)の値を入力値に戻すにはどうしたら良いでしょうか?お教え下さい。 Windows7・SP1 Office2010 Private Sub Worksheet_Change(ByVal Target As Range) If Target.address <> "$A$1" Then Exit Sub Application.EnableEvents = False Application.Undo Range("A1").Select Selection.Copy Range("B1").Select ActiveSheet.Paste Range("A1").Select Application.CutCopyMode = False Application.EnableEvents = True End Sub
Excelシート１～１０行のうち1.3.7.9行のD列にIF関数により"●"が入力されています。 "●"の1.3.7.9行をVBAコード入力で非表示にならないでしょうか。解る方、宜しくお願いたします。
Cellsのかっこの中はどっちが行と列なんですか？ cells(行,列) ですかそれとも　cells(列,行) ですか？
csvを取り込んで、列の追加と削除をしたいですが、 エラーになってしまい、マクロがうまく動きません。 ■マクロでやりたいこと ・M、O、P列を削除する ・AO、AQ列の間に列を挿入 　列名を「企画ID（廃止）」とする ■エラー内容 実行時エラー　「オーバーフローしました」というエラーがでる 下記がvb構文になります。 どなたかご回答お願いします。 =========================================================================================================================== ' ' CSVファイルの読込を行う ' '=========================================================================================================================== Function ReadCSV(filename As String) As Boolean Dim hanbaiwaku_wb As Workbook Dim hanbaiwaku_ws As Worksheet Dim wbk As Workbook Dim fname As String Dim endrow As Long Dim openflg As Boolean Dim i As Integer '画面の更新などを行なわない様にする SetScreenState (False) '処理中メッセージを表示する UserForm1.Show vbModeless UserForm1.Repaint '選択されたkowaku.csvファイルを開く Set hanbaiwaku_wb = Workbooks.Open(filename, ReadOnly:=True) Set hanbaiwaku_ws = hanbaiwaku_wb.Sheets(1) '最終行を取得する endrow = CLng(hanbaiwaku_ws.Range("A1").End(xlDown).Row) '2行目から最終行までループ(1行目は見出しの為、飛ばす) For i = 2 To endrow hanbaiwaku_ws.Range("A" & i).Value = SubstitutionStatus(kowaku_ws.Range("A" & i).Value) Next '処理中メッセージを削除する Unload UserForm1 'ファイル検索用のファイル名を設定する fname = ThisWorkbook.Path & "\変換済み_" & hanbaiwaku_wb.Name 'ファイルが開かれている場合、上書きが出来ない為、ブックが開かれているか調べる For Each wbk In Workbooks '同一名称のブックがある場合、処理を抜ける If wbk.Name = Dir(fname) Then Exit For End If Next 'ブックが取得されなかった場合 If wbk Is Nothing Then '変換後の内容を別名で保存する hanbaiwaku_wb.SaveAs filename:=fname openflg = True 'ブックの取得が行われていた場合 Else 'ブックの名称とファイル検索用のファイル名を比較し、 '同一であった場合、ファイルが開かれていると判定し、メッセージを表示する。 If wbk.Name = Dir(fname) Then MsgBox (Dir(fname) & "が開かれている為、保存する事が出来ません。ブックを閉じてください。") openflg = False 'ブックの名称が比較用文字列と異なる場合 Else '変換後の内容を別名で保存する hanbaiwaku_wb.SaveAs filename:="変換済み_" & hanbaiwaku_wb.Name openflg = True End If End If 'kowaku.csvを閉じる hanbaiwaku_wb.Close '解放処理 Set hanbaiwaku_wb = Nothing Set hanbaiwaku_ws = Nothing '画面の更新などを行う様にする SetScreenState (True) '処理結果を返す ReadCSV = openflg End Function '=========================================================================================================================== ' ' 不要な列の削除を行う ' 13.15.16列の削除を行う ' '=========================================================================================================================== Function SubstitutionStatus(txt As String) Sub prcDeleteRows() '列を削除します Columns("13:13,15:16").Delete Shift:=xlToLeft '列を追加します Sub 列追加() ' ' 列追加 Macro' Columns("AP:AP").Select Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove Range("AP1").Select ActiveCell.FormulaR1C1 = "企画ID（廃止）" ActiveCell.Characters(1, 2).PhoneticCharacters = "キカク" ActiveCell.Characters(6, 2).PhoneticCharacters = "ハイシ" Range("AP2").Select End Function End If '結果を返す SubstitutionStatus = txt End Sub
vbaで教えて下さい。 ユーザー関数の数値で、from,to,任意の数字の３つのパラメータを与えて、任意の数値が from,to内にあるかどうか判断するユーザー関数というのはどうすればいいでしょう。 宜しく御願い致します。
お世話になります。 VB2010でユーザーコントロールのテキストボックスを作成しました。 昨日としては簡単で (1)フォーカスが当たった場合、テキストボックスの背景色の色を変える。 (2)文字を全選択する。 Protected Overrides Sub OnEnter(ByVal e As System.EventArgs) Me.BackColor = SettingsInfo.FocusColor '(1) Me.SelectAll() '(2) MyBase.OnEnter(e) End Sub 上記のようにコードを書いた場合、(1)は正常に動くのですが (2)で文字が全選択されません。 原因を教えていただければ幸いと存じます、宜しくお願い致します。
現在PowerPointでプレゼンテーションを作っています。 設定するアニメーションの数が多く、同じ図形に同じアニメーション効果を、オプションだけ変えて手作業で設定するのは大変時間がかかります。 そこでVBAを用いて設定したいと考えているのですが、PowerPointのVBAでアニメーション効果を詳細に設定、参照するためにはどのように記述すればよいでしょうか。 ネットで検索をかけたり、ヘルプを参照しましたが、あまり理解できずここで質問させていただきました。 設定したいアニメーション効果は アニメーション効果の 軌跡効果の 直線(下へ) です。 「軌跡の始点、終点」と 「開始,遅延,継続時間」などのオプション(リボンだと「アニメーション」の中の「タイミング」) とを設定したいです。 使用しているPowerPointは2010です。 記述の仕方をご教示お願いします。 また、ネットやヘルプで検索をかけたつもりですが、わかりやすいサイトやヘルプ項目がありましたら教えていただけるとありがたいです。 長文、乱文すみませんでした。
現在、VB6で作られたプログラムを開いて、編集を行おうとしているのですが、 プロジェクトのロード段階でエラーが出ます。 そのエラーの内容ですが、 「行 372: クラス MSComctlLib.StatusBar(コントロール SBMes) はロードされていません。」となっています。 それで、MSComctlがコンポーネントにないからか、と思い、 コンポーネントの一覧で「Microsoft Windows Common Controls 6.0(SP6)」にチェックを入れて、 適用ボタンを押すと、「オブジェクトライブラリは登録されていません」とエラーが表示されます。 なお、それは新規プロジェクトで上コンポーネントを登録しようとしたときも表示されました。 VB6は入れたばかりで、 一度アンインストールしてインストールをしなおしたりとしています。 ですが、そのエラーが出続けて、PGの変更ができません。 どうすればいいかご存知のかた、ご教授お願いいたします。
アクティブセルがどの位置にあってもウインドウの行が変わらず列のみを移動できるでしょうか？ ちなみに下記コードではアクティブセルが行（2～20）にある場合、列と同時に行も上に移動します。 どなたかコードが解る方、宜しくお願いします。 Sub 列移動() Application.Goto reference:=Worksheets("sheet1").Range("E" & ActiveCell.Row), Scroll:=True End Sub
VBAです。 VBAのフォームで添付した絵のようなリストボックスを作りたいと思っています。 イメージとしては、フォルダの中にあるファイルを取得して、それぞれのファイルにどのような 処理をさせるかコンボボックスで決定させるという感じです。 リストボックスにコンボボックスを埋め込むようなことは可能でしょうか？ あるいは、別にそれが可能になるコントロールはありますでしょうか？ 参照設定等を使っても構いません。 よろしくお願いいたします。
よろしくお願いします。 ADに参加していないPCとADサーバが同じネットワーク上に有ります。 このPCからADサーバへファイル共有等で接続は可能な状態です。 VBで作成したアプリをこのPCで起動した際に、ADに登録したユーザー名・パスワードを入力し情報（表示名等）を取得し、認証及び誰が使用したのかログを残したいと思います。 VBで以下のコードを試しました。 Dim path As String　= "LDAP://ADサーバのIPアドレス" Dim root As New DirectoryEntry(path, "ユーザー名", "パスワード") Dim schr As New DirectorySearcher(root) schr.Filter = String.Format("(&(objectClass=user)(name={0}))", "ユーザー名") Dim sr As SearchResult = schr.FindOne() Dim userEntry = sr.GetDirectoryEntry() Dim fullName As String = userEntry.Properties("fullName").Value userEntry.Close() root.Close() や Dim path As String　= "LDAP://ADサーバのIPアドレス" Dim root As New DirectoryEntry(path) root.Username ="ユーザー名" root.Password ="パスワード" Dim schr As New DirectorySearcher(root) schr.Filter = String.Format("(&(objectClass=user)(name={0}))", "ユーザー名") Dim sr As SearchResult = schr.FindOne() Dim userEntry = sr.GetDirectoryEntry() Dim fullName As String = userEntry.Properties("fullName").Value userEntry.Close() root.Close() では、情報を取得できません。 上記以外にもサーバのIPアドレスの後ろに”/DC=ドメイン名,DC=local”等を追加したり、検索して見つけたコードをいろいろ試しましたが失敗の連続です。 どのようにすればADサーバから情報を取得出来るかご存知の方が居られましたら、ご教授をお願いいたします。 お手数をお掛け致しますが、よろしくお願いいたします。
InputBoxのテキストは字が小さいのでフォームにテキストボックスを貼り付けて作ったのですがプログラムがそこで止まりません。 ＩｎｐｕｔＢｏｘは何かを入力しＯＫボタンを押してから次に進みますがこの様にするにはどうしたら良いのでしょうか。
開発、コンパイル環境 ＶB.net 2008 ターゲットＣＰＵ：x86 Framework2.0 OS：Windows7 上記で作成したアプリで、 １、自作フォーム(Form1)をスタートアップオブジェクトに指定 ２、参照設定に他社作成DLL(FormTest1含)を追加 ３、Form1からFormTest1を起動 　　　　ボタンクリックイベント 　　　　Dim frm As New FormTest1 　　　　frm.TopMost = True 　　　　frm.Show() おおむね上記のようなことを行っています。 問題は、自作アプリの起動後１回目の「FormTest1」起動だけ「Form1」の後ろに立ち上がります。 ２回目以降は「Form1」の前面に立ち上がります。←これが希望しているの動作です。 実行PCはWindows7です。 散々調べたのですが解決策が見つかりませんでした。 この問題に解決策はあるのでしょうか? どなたかご存じでしたらご教授願います。
ユーザーフォームを使って検索ツールを作成したい。 たとえば、ワークシート内にこのようなデータがあります。 　A列                B列 1業務分類        問合せ内容 2                単価訂正できない 3                販売契約が登録できない 4                出荷登録でエラー 5財務         仕訳登録でエラー 6                源泉税額はどこに入力するか 7                仮払金を申請するには 8購買         検収でエラー 9                購買依頼が登録できない これを、ユーザーフォームで、 カテゴリ選択・・・コンボボックスで「営業」「財務」「購買」のいずれかを選択する キーワード検索・・・テキストボックスでキーワードを入力する。テキストボックスは2つ用意し、 ラジオボタンでAND条件かOR条件かを選択させる これで、カテゴリ選択で「営業」を選択した場合は、B2:B4の範囲でキーワード検索し、ヒットするセルをアクティブにする。 ヒットするセルが複数ある場合、Enterキーで次にヒットするセルをアクティブにする。 次にヒットするセルがない場合は「検索文字列がありません」などのメッセージを表示する ヒットするセルがひとつも存在しない場合も「検索文字列が存在しません」を表示する 以上のようなツールを作成したいのですが、どのように組んだらよいでしょうか？ ご教示ください。おねがいします。
Dドライブ直下にあるBook1.csvというファイルをエクセルで普通に開きたいのですが。 Open "D:\Book1.csv" For Random As #1 としても何も起こりません。 もう一度実行すると、「ファイルは既に開かれています。」というメッセージが出ます。 おそらくVB上では開かれているのですが。画面上に表示されません。 画面上に表示させるのはどうすればよいのでしょうか？
いつもお世話になっております。 ＶＢＡでまた難問に詰まってしまいました。ご教授お願い致します。 別のフォルダに保存されているマクロを利用して、とあるデータを作成するのですが 途中でデスクトップ上に一回保存をしたCSVファイルを最後に削除する という動きをさせたいです。 下記のマクロだと、マクロとCSVファイルがデスクトップ上にあれば削除出来るのですが マクロは常にとあるフォルダに保管されており、使用する人間はバラバラです。 ※CSVファイルの他に3種類程データを作成するのですが 　マクロを使った人が使っているＰＣのデスクトップ上に保管する事になっております。 　上記の事から、Killステートメントでファイル指定が出来ない状態（不特定のデスクトップ）です。 　 Sub test() Dim myPath As String Dim i As String myPath = ThisWorkbook.Path & "\" i = "テストデータ.csv" If InStr(i, ".csv") = 0 Then i = i & ".csv" If Dir(myPath & i) <> "" Then Kill myPath & i Else End If End Sub 不特定のデスクトップ上にあるcsvファイルを削除する事は可能でしょうか？ 以上、宜しくお願い致します。 環境　WindowsXP　Excel2003
教えてください。 EXCELの2003で通っていた下記構文が2010だとエラーになります。 With Selection.Characters.Font wk_name = .Name wk_size = .Size wk_ul = .Underline wk_color = .ColorIndex End With ２０１０だと書き方が変わるのでしょうか？ よろしくお願いいたします。
VB.NETを使い、文字列を横に流す、いわゆるティッカーのようなものを制作しています。 Labelに文字列を入れ、TimerのTickごと(現状Interval=2)にLabel1.Left -= 2という動作をさせていて、 これを5つ(Label1～Label5)同時に行っているのですが、パソコンのスペックによってか、時々動作が重くなる時があります。 近頃のPCとしては大した処理ではないと思うのですが、どのようなコードを書いたらもっとスムーズに動かせるでしょうか？ よろしくお願いします。
Access　VBAで添付型フィールドからファイル名を取りだしたいのですが、どのようにすればいいでしょうか？ Private Sub Sample() Dim DB As DAO.Database Dim RS As DAO.Recordset Dim SQL As String 　　Set DB = CurrentDb SQL_1 = "SELECT * FROM ボランティア情報 ORDER BY 分野 & 団体名読み;" Set RS = DB.OpenRecordset(SQL_1, dbOpenDynaset) With RS 　　Do While Not .EOF 　　MsgBox (!写真.FileName)　　←ここでエラーが出ます。 .　　　MoveNext 　　Loop End With RS.Close Set RS = Nothing Set MDB = Nothing End Sub
ＥＸＣＥＬ ＶＢＡにて Ｄｉｃｔｉｏｎａｒｙオブジェクトを利用しようと思い ネット検索して調べていると・・・ 1）Dim MyDic As Object Set MyDic=CreateObject("Scripting.Dictionary") 2) Dim MyDic As Scripting.Dictionary Set MyDic = New Scripting.Dictionary 3) Dim MyDic Set MyDic=CreateObject("Scripting.Dictionary") 4) Dim myDic As New Scripting.Dictionary 上記の４パターンが出てきました。 いずれも「連想配列」を使うものなのですが、 オブジェクト型、バリアント型、Ｎｅｗキーワードで宣言・・・ 4つの違いがイマイチ理解できません。 違いを教えてください。
エクセルで図のような図形（涙型）が点Aを基準とした座標データ(１°刻み)であります。 その図形の内側に点Bがあり、点Bを点Eを中心に左右に回転させ 涙型の図形に接触するまで回転した場合の 回転角θとΦを求めたいのですがどのようにしたら良いでしょうか。 点Bを任意の角度回転させた時の座標の求め方は分かるのですが、 図形に接触するまで回転させた時の角度又は座標の求め方がわかりません。
表－１の氏名に応じた各日付に記号が入力されています。 下表の記号に日付ごとの記号合計個数が式によって入力されています。 記号の個数の値セル（E17）をアクティブし選出ボタンをクリックしたらその行記号（B17⇒"B")のみがオートフィルタで表－２のように選出表示したいのですが？ VBAでどなたかお解りになる方よろしくお願いします。
textboxに入力されている <PRE></PRE>タグで囲まれた文字列を抽出したいのですが、 全くの素人なので、いろいろ教えてください。 <html> <body> <PRE> abc abc </PRE> </body> </html>
　ユーザーフォームのリストボックス(RowSource,P6:A26)で選択し14個のテキストボックスで編集しコマンドボタンでSheet(P6:AC26)にコピペしていますが、下記のコードだと無制限に登録されてしまいます。Sheetの範囲内で登録＆編集のコードの書き方がありましたらご教示賜りたく存じます。(番号は自動入力でなくてもいいです。) Windows7・SP1 Office2010 Private Sub CommandButton2_Click() Dim varRag As Variant Dim myArray As Integer Dim i As Long varRag = Array(txtID, txtTextBox2, txtTextBox3, txtTextBox4, txtTextBox5, txtTextBox6, txtTextBox7, txtTextBox8, txtTextBox9, txtTextBox10, txtTextBox11, txtTextBox12, txtTextBox13, txtTextBox14) If TextBox3.Text = "" Then MsgBox "登録すべき内容がありません！", vbExclamation, "確認" Exit Sub End If Application.ScreenUpdating = False Application.Calculation = xlCalculationManual If ListBox1.ListIndex = -1 Then 'リストが選択していなかったら、 Cells(Rows.Count, 16).End(xlUp).Offset(1).Select For myArray = 0 To 9 With Selection txtID = .Row - 5 .Offset(, myArray) = varRag(myArray) End With Next myArray Else i = ListBox1.ListIndex + 6 Range("P" & i).Value = i - 5 Range("Q" & i).Value = TextBox2.Text Range("R" & i).Value = TextBox3.Text Range("S" & i).Value = TextBox4.Text Range("T" & i).Value = TextBox5.Text Range("U" & i).Value = TextBox6.Text Range("V" & i).Value = TextBox7.Text Range("W" & i).Value = TextBox8.Text Range("X" & i).Value = TextBox9.Text Range("Y" & i).Value = TextBox10.Text Range("Z" & i).Value = TextBox11.Text Range("AA" & i).Value = TextBox12.Text Range("AB" & i).Value = TextBox13.Text Range("AC" & i).Value = TextBox14.Text End If 'データをクリア ListBox1.ListIndex = -1 ID.Text = "" TextBox2.Text = "" TextBox3.Text = "" TextBox4.Text = "" TextBox5.Text = "" TextBox6.Text = "" TextBox7.Text = "" TextBox8.Text = "" TextBox9.Text = "" TextBox10.Text = "" TextBox11.Text = "" TextBox12.Text = "" TextBox13.Text = "" TextBox14.Text = "" Application.ScreenUpdating = True Application.Calculation = xlCalculationAutomatic End Sub Private Sub ListBox1_Change() Dim targetRow As Integer With ListBox1 targetRow = .ListIndex ID.Text = .List(targetRow, 0) TextBox2.Text = .List(targetRow, 1) TextBox3.Text = .List(targetRow, 2) TextBox4.Text = .List(targetRow, 3) TextBox5.Text = .List(targetRow, 4) TextBox6.Text = .List(targetRow, 5) TextBox7.Text = .List(targetRow, 6) TextBox8.Text = .List(targetRow, 7) TextBox9.Text = .List(targetRow, 8) TextBox10.Text = .List(targetRow, 9) TextBox11.Text = .List(targetRow, 10) TextBox12.Text = .List(targetRow, 11) TextBox13.Text = .List(targetRow, 12) TextBox14.Text = .List(targetRow, 13) End With End Sub
VB.NETでSetForegroundWindowでウインドウを最前面に出来ないため、AllowSetForegroundWindowを使用するようにしましたが、解決できません。 コードは大体次のようになっています。 Dim hProcess As System.Diagnostics.Process = System.Diagnostics.Process.GetCurrentProcess() AllowSetForegroundWindow(hProcess.Id) Dim hWnd As IntPtr = FindWindow("XXX", "YYYYY") SetForegroundWindow(hWnd) 環境は次のとおりです。 　OS： Windows 7 Pro. 64bit SP1 　VB.NET： 2010 Express 解決方法をご教示頂きたく、よろしくお願いします。
補足情報の追加書き込みがわかりませんので何度もトビを起こしいます。 申し訳ございません。 ↓例で、 G列結合セルを解除して、解除した行にすべてに"●"と入れたいのですがコピーできません。。 ご意見をいただけませんか? ------------ Option Explicit Sub Sample() Dim nRow, i, Addr, tmp Worksheets("Sheet1").Range("D:E,K:K,V:Y,AF:AM").Copy With Worksheets("sheet2") 'Y列も"sheet2"にコピー（G列） .Range("A1").PasteSpecial Paste:=xlPasteValues nRow = .Cells(Rows.Count, 1).End(xlUp).Row 'データのある最終行 For i = 5 To nRow If .Cells(i, 2) = "" Then .Cells(i, 2) = .Cells(i - 1, 2) 'B列 If .Cells(i, 4) = "" Then .Cells(i, 4) = .Cells(i - 1, 4) 'D列 Next i 'Y列（"sheet2"のG列）のデータ分行を追加 For i = nRow To 4 Step -1 'Y列（"sheet2"のG列）にデータがあるか If .Cells(i, 7) <> "" Then tmp = .Cells(i, 7) '-------------ここがうまくいきません。 'G列結合セルを解除して対象行にすべて「OK」と入れる。 If .Cells(i, 7).MergeCells Then Addr = .Cells(i, 7).MergeArea.Address .Cells(i, 7).UnMerge .Range(Addr) = "●" End If '------------ここがうまくいきません。 .Rows(i).Copy .Rows(i).Insert .Cells(i + 1, 3) = "-" .Cells(i + 1, 6) = tmp '.Cells(i, 7) = "●" .Cells(i + 1, 7) = "★" End If Next i 'Y列（"sheet2"のG列）の最後尾列(Q列)への移動 .Columns(7).Cut .Columns(17).Insert End With End Sub
お世話になります。 下記のセル・VBAを入力しています。 私が希望する形は、 「test」に「5」が入って欲しいのですが、 「test」に「g_array(1, 1) 」が入ってしまいます。 ※変数をセルで指定したいのです。 どのようにすれば、testに「5」を入れる事ができるでしょうか？ 何卒宜しくお願い致します。 -----VBA---- Sub sample() Dim g_array(3, 3) As Variant g_array(1, 1) = "5" Dim test As Variant test = Cells(10, 5).Value End Sub ----エクセルのcells(10.5)に入力した値---- g_array(1, 1) --------------------------------
お世話になります。 VBAで下記の「関数A」があります。 親ソースで、下記２パターン記載した時に (1)は、test=1で処理が進む (2)は、test=999で処理が進むようにしたいのですが どのように関数Aを記載したら良いでしょうか？ ※引数を指定しない時は、999の値が自動で入るように したいのです。 (1)call 関数A(1) (2)call 関数A ※何も引数を指定しない ------関数A---- sub 関数A(test as Long) 'testを使って色々 end sub -----------------
お世話になります。 Access2000でUTF8のテキストファイルをSHIFT-JISに変換して読み込みたいのですが、どのようにしたら良いのか分かりません。 VBAでこの処理を行ないたいと思っております。 どなたかご教授いただければ、大変助かります。
お世話になります。 よろしくお願いします。 題名通りです C#でのFocus()と同等のWPFの処理をご教授願えませんでしょうか 現在Focusの代わりにCaptureMouse()を使用してますが 思った通りに動いてくれないので、ご教授お願いいたします。 簡単な仕様ですが WPFユーザーコントロール（ A ）に、WPFユーザーコントロール（ B ）をAddして A にMouseEnterすると、B にフォーカスを当ててBのイベント処理をするようにしております。 宜しくお願い致します。
VS(Visual Basic2012)でアプリケーションの開発をしております。 WindowsフォームアプリケーションにてForm上のPanelにコンテナされている Pictureboxに、Buttonをクリックする度にLineshapeコントロールを動的に配置するようにしています。 そこで、とある動作（他のButtonのクリックとか）で、 そのなかの特定のLineshapeコントロールを削除したいのですが、やり方がわかりません。 Lineshapeコントロールは以下のソースのように配置しています。 配置したコントロール名がわかれば削除できそうなのですが、コントロール名の取得の方法がわかりません。 配置したLineshapeコントロールを削除する方法があれば上記の方法以外でも構いません。 どなたかアドバイスいただけたら幸いです。 以下ソースです。 Dim canvas As New PowerPacks.ShapeContainer Private Sub PictureBox3_Click(sender As Object, e As EventArgs) Handles PictureBox3.Click Dim win As New LINESHAPE ' Set the form as the parent of the ShapeContainer. canvas.Parent = Me.PictureBox6 ' Set the ShapeContainer as the parent of the LineShape. win.Parent = canvas win.BorderWidth = 20 win.BorderColor = Color.LightBlue win_index = win_index + 1 win.SetIndx(win_index) win.SetAng(0) win.Name = "Win" & win_index win.SetX(Panel1.Width / 2) win.SetY(Panel1.Height / 2) win.X1 = win.GetX - 50 * Math.Cos(win.GetAng * Math.PI / 180) win.Y1 = win.GetY + 50 * Math.Sin(win.GetAng * Math.PI / 180) win.X2 = win.GetX + 50 * Math.Cos(win.GetAng * Math.PI / 180) win.Y2 = win.GetY - 50 * Math.Sin(win.GetAng * Math.PI / 180) '動的にイベントを関連付ける AddHandler win.MouseDown, AddressOf win_MouseDown AddHandler win.MouseUp, AddressOf win_MouseUp AddHandler win.MouseMove, AddressOf win_MouseMove End Sub Public Class LINESHAPE Inherits PowerPacks.LineShape Dim idx As String Dim ang As String Dim p_x As String Dim p_y As String Public Sub SetIndx(index As String) idx = index End Sub Public Sub SetAng(angle As String) ang = angle End Sub Public Sub SetX(xx As String) p_x = xx End Sub Public Sub SetY(yy As String) p_y = yy End Sub Public Function GetIndx() Return idx End Function Public Function GetAng() Return ang End Function Public Function GetX() Return p_x End Function Public Function GetY() Return p_y End Function End Class 以上、よろしくお願い致します。
現在VB.NET 2008 EXPとMySQLを用いてシステムを作成しています。 MySQLのテーブルにファイルのパスを保存したのですが、「\」記号が全て消えてしまいます。 例 \\PC\users\public\boo1.xls ---> PCuserspublicbook1.xls 原因を探るために以下の項目を試してみました。 1) AccessからMySQLにパスをInsertする。 --> 問題なく保存出来た。 2)MySQLのGUIツールを使用して、直接パスを入力 --> 　問題なく保存出来た。 上記のことから、VB.netからInsertする場合のみ、「\」記号が消えてしまうことがわかりました。 VB.NETでは「\」記号は扱えないのでしょうか? パスを保存するためにはどのようにすればよいでしょうか?
下記の２種の印刷設定をVBAで切り替えようと思っているのですが、【2】のように改ページする箇所を指定することは出来るのでしょうか？ 【1】 印刷範囲：G2～CZ136 ページ数：１ 原稿サイズ：A3 出力用紙サイズ：A3 原稿の向き：よこ原稿 まとめて1枚：Nアップしない 【2】 印刷範囲：G2～CZ69、G70～CZ136 ページ数：２ 原稿サイズ：A4 出力用紙サイズ：A3 原稿の向き：よこ原稿 まとめて1枚：2アップ 印字方向：順方向
氏名に応じた記号手入力後、記号の個数の値セルをアクティブし選択ボタンをクリックしたらその記号A のみがオートフィルタ選択できるのでしょうか？VBAでどなたかお解りになる方よろしくお願いします。
Excel 2003 のVBAで質問です。 以下のサンプルプログラムですが、最後の MsgBox で 1 になってしまいます。 3 が帰ってくるようにするには、Range でどのように指定すればよいのでしょうか。 宜しくお願いします。 〔Sheetの値〕 ┌─┬─┬─┬─┐ │＊│Ａ│Ｂ│Ｃ│ ├─┼─┼─┼─┤ │１│11│12│13│ ├─┼─┼─┼─┤ │２│21│22│23│ ├─┼─┼─┼─┤ │３│31│32│33│ ├─┼─┼─┼─┤ │４│41│42│43│ ├─┼─┼─┼─┤ │５│51│52│53│ └─┴─┴─┴─┘ 〔サンプルプログラム〕 Dim myArray1, myArray2 As Variant myArray1 = ThisWorkbook.ActiveSheet.Range("A1:C5") myArray2 = ThisWorkbook.ActiveSheet.Range("A1:A5,B1:B5,C1:C5") '指定が間違ってる？ MsgBox UBound(myArray1, 1) '結果 5 MsgBox UBound(myArray1, 2) '結果 3 MsgBox UBound(myArray2, 1) '結果 5 MsgBox UBound(myArray2, 2) '結果 1 → 3になって欲しい
いつもお世話になっています。 初めて、Excelのフォームで入力画面を作りました。 複数の項目があって、それを最後に[登録]ボタンをクリックで 表に入れたいのですが、一度にまとめて実行する方法が分かりません。 アドバイスよろしくお願いいたします。 Private Sub cmd_1() Dim i As String If man.Value = True Then ActiveCell = man.Caption End If If woman.Value = True Then ActiveCell = woman.Caption End If ActiveCell.Offset(0, 1).Select End Sub Private Sub cmd_2() Dim i As String If man.Value = True Then ActiveCell = Yes.Caption End If If woman.Value = True Then ActiveCell = No.Caption End If ActiveCell.Offset(0, 1).Select End Sub Private Sub cmd_downlist() Dim ListNo As Long ListNo = group.ListIndex ActiveCell.Value = group.List(ListNo, i) ActiveCell.Offset(0, 1).Select End Sub Private Sub cmd_comment() ActiveCell = comment.Text ActiveCell.Offset(1, -3).Select End Sub
フォームの中に別のフォームを表示させたいのですが，親フォームの位置を取得する方法はありますか。 そうすれば，子フォーム名.Location = New Point(500, 300) とやれるのですが。
マルチにすると親フォームの背景色が黒くなってしまいます。背景色を変えても反映されません。 どうすれば明るい色にできますか。 代替手段でも結構です。
初心者です。 テキストファイルを以下の条件で検索して、検索がマッチしたらそのファイルのレコード行を各条件によって指定されたファイルに書き込みたいです。 1)５桁目が"D"且つ １０～１１桁目が"A５"の場合、ファイル"TEXT1.txt"に書き込む 2)５桁目が"G"且つ１０～１１桁目が"B６"の場合、ファイル"TEXT2.txt"に書き込む 3）上記に該当しない場合、ファイル"TEXT3.txt"に書き込む どなたかご教示のほど宜しくお願い致します。
お世話になります。 宜しくお願いいたします。 以下のコードでエラーが出ます。 System.Drawing.Point p = this.PointToClient(System.Windows.Forms.Cursor.Position); エラー内容 'クラス名' に 'PointToClient' の定義が含まれておらず、型 'クラス名' の最初の引数を受け付ける拡張メソッドが見つかりませんでした。using ディレクティブまたはアセンブリ参照が不足しています。 使用中のクラスは、たしかに System.Windows.Controls.UserControl を継承しています。 さまざまな方法を試しましたが、全く理解できません。 ・解決方法または、WPFでマウス座標を取得する方法について ご教授お願いいたします。
VB6で音声読み上げをしたいのですが、どうすればよいのでしょうか？ TextToSpeechという機能を使えば良いのはわかりましたが、 具体的にどうすれば良いかが分かりません。
お世話になります。 タイトルそのままですが、 Outlook 2007のＶＢＡにて デスクトップのvbsファイルを実行するやり方を教えていただけませんでしょうか。 あと、途中で１秒止めるというコードももしいただければありがたいです。 昨日一晩考えたのですが、解決せず…
ある行と別の行と同じ内容の文章が入っている場合、それを削除するマクロをくんでいますが、 アプリケーション・オブジェクト定義のエラーとのことで作動してくれません。。。 以下のような記述なのですが、アドバイスをいただけたら幸いです。 よろしくお願いいたします。 Sub 重複削除() Dim dataend Cells(Rows.Count, 5).End(xlUp).Select dataend = ActiveCell.Row For i = 2 To dataend - 1 For k = 1 To dataend - i If Cells(2, i).Value = Cells(2, i + k).Value Then '''''''''''''''''''''ここでひっかかる Rows(i + 1).Select Selection.Delete End If Next Next End Sub
お世話になります。 宜しくお願いします。 WPFでTextBlockの高さを知りたいのですが 想定している値と大きく違っており、対処に困っております。 簡単な仕様ですが、 StackPanel に TextBlock を１つ、要素として追加して TextBlock.Inlines.Add で順に String を追加させております。 TextBlock は Wrap に設定しております。 追加し終わったあとで、TextBlock.RenderSize.Height で取得すると １３．３３３・・・となります。 StackPanel の Height は１５０に設定しており、 TextBlock を目視しても１５０いっぱいに文字の表示があります。 むしろ StackPanel のHeightより大きくなるように設定してますので、 TextBlock の Height は２００はないとおかしいのです。 この TextBlock.RenderSize.Height は、１行分の高さかと思い textBlock.RenderSize.Height * textBlock.Inlines.Count　で一旦やってみましたが Wrap を True に設定してますので、改行があればあるほど 実際の長さとは異なってしまいます。 何か良い方法はないでしょうか 宜しくお願いいたします。
こんにちは、教えてください。インプットボックスに入力した数が行（Column）の番号又は、名前がついている行の数値を指定して（例えば、Columnの名前が　８０，８１など）、その行に入力されているデータなどを次の行にコピーするにはどうすればいいのでしょうか（例えばインプットボックスに入力されている番号が８０なら、８０の行のデータを８１の行にコピーする）？どうしても、次の行にコピーするのがうまくいきません。よろしくお願いします。
C++、VB．net、Java、Delphiなど色々なオブジェクト指向言語がありますが、 以下のようなとき、「子クラスのrunメソッド」を実行したとき、 (1)「親」と表示されてから「子」と表示される。 (2)「子」とだけ表示される。 のそれぞれどちらの仕様なのでしょうか？ 親クラス 　　runメソッド 　　　　コンソールに「親」と表示 子クラス 　　runメソッド 　　　　コンソールに「子」と表示 ※私は、 子クラス側で、わざわざ、super．run　と書かずとも、 勝手に「(1)「親」と表示されてから「子」と表示される。」になる言語が多いと認識していたのですが、 誤った認識でしょうか？ （C++は、明示的に親の同名メソッドをコールしなければ、処理が実行されないと認識していますがC++の仕様は少数派でしょうか？多数派でしょうか？）
お世話になります。 下記の手順で、新規のＥｘｃｅｌにVBAを登録し、 実行したいと思っております。 (1)「元ファイル.xls」から、VBAで新規Excelbookを作成 (2)名前を「テスト.xls」にする (3)「テスト.xls」にVBAコードを登録する (4)(3)で登録したVBAを実行する そこで、(3)のVBAコードを登録する方法がわかりません。 お手数ですがご存じの方教えて頂けないでしょうか？ 何卒宜しくお願い致します。
Visual Basic 2012を使用しています。 下記プログラムを実行するとエラーが表示されてしまいます。 Dim img As New Bitmap(200, 100) Dim g As Graphics = Graphics.FromImage(img) g.FillRectangle(Brushes.Black, g.VisibleClipBounds) g.Dispose() PictureBox1.Image = img img.Save("E:\EPUB_test\test.jpg", System.Drawing.Imaging.ImageFormat.Jpeg) img.Dispose() 表示されるエラーは下記です。 型 'System.ArgumentException' のハンドルされていない例外が System.Drawing.dll で発生しました どこが間違っているのでしょうか？ 正しく動作させるにはどこを修正すべきかをお教え下さい。
Excel2010でセルに関数式を埋め込むマクロを書いています。 そこで、「ByRef引数の型が一致しません」というエラーが出て困っています。 プログラムの中からエラーの出る所だけを取り出してtest1,test2として試したところ、 test1はエラーが出て、test2はプログラムが動いて目的とするセルに関数式が挿入されました。 Sub test1() dim i, myR as integer myR = 30 For i = 7 To 31 Cells(4, i) = "=IF(" & ConvertToLetter(i) & i - 4 & "="""","""",SUM(" & ConvertToLetter(i) & "5:" & ConvertToLetter(i) & myR & ")/(" & myR & "-COUNTIF(" & ConvertToLetter(i) & "5:" & ConvertToLetter(i) & myR & ","""")))" next i End Sub test1でConvertToLetter(i)のiが青色で選択され「ByRef引数の型不一致」エラーとなってしまいます。 そこで、試しに一度変数iの値をkに渡して同じプログラムをtest2として実行してみました。 Sub test2() dim i, k, myR as integer myR = 30 For i = 7 To 31 k=i Cells(4, i) = "=IF(" & ConvertToLetter(k) & i - 4 & "="""","""",SUM(" & ConvertToLetter(k) & "5:" & ConvertToLetter(k) & myR & ")/(" & myR & "-COUNTIF(" & ConvertToLetter(k) & "5:" & ConvertToLetter(k) & myR & ","""")))" next i End Sub このtest2は、きちんと実行され、目的とするG4(～AE4)のセルに =IF(G3="","",SUM(G5:G30)/(30-COUNTIF(G5:G30,""))) という式が挿入されました。 質問1：なぜ、test1がダメで、test2ならうまくいくのかという理由がわかりません。 質問2：うまくいったtest2と同じ式を、もっと長いプログラムの中に入れるとやはり「ByRef引数の型が一致しません」エラーが出てプログラムが止まってしまいます。test2単独のプログラムならうまく動くのに、他のプログラムの一部に埋め込むとエラーが出る理由もわかりません。 VBAプログラムを試行錯誤しながら勉強している初心者です。どなたかご教示お願いします。 ちなみに、ConvertToLetterは、 Function ConvertToLetter(iCol As Integer) As String Dim iAlpha As Integer Dim iRemainder As Integer iAlpha = Int((iCol - 1) / 26) iRemainder = iCol - (iAlpha * 26) If iAlpha > 0 Then ConvertToLetter = Chr(iAlpha + 64) End If If iRemainder > 0 Then ConvertToLetter = ConvertToLetter & Chr(iRemainder + 64) End If End Function という、関数で定義しています。
シートA,B,C,D～とありB以降全てを選択して削除する方法はありますか？ シートの数はマクロの実行の度に変わるので直接B,C,D～と選択することはできません。 どなたかよろしくお願いします。
お世話になります。 ExcelのVBAで作成しております。 下記のhtmlがある状態で(1)を変える場合は、 For Each itm In objIE.document.GetElementsByTagName("input") If itm.ID = "entry_title" Then itm.Value = "A" Exit For End If Next で変更できたのですが、(2)(要素)を変更するには、 どうしたらよいでしょうか？ お手数ですが、よろしくお願いいたします。 <input value="(1)" id="entry_title">(2)</input>
エクセルVBAを友人に頼まれ修正しているのですが、 構造体内検索ができません。 ネットを検索しても解決にはつながらなかったので質問させていただきました。 excelは2010、ＯＳはwindows8です。 よろしくお願いします。
このプログラムは 例えば３ ３ ４とテキストボックスに数字が打ち込まれると ３×３行列が４個分 のテキストボックスがでてきます。 ここに数字を打ち込んでいき、ボタン２を押すと３×３のテキスト トボックスが出てくると同時に足し算した結果が出てくるようにしたいです。 以下のプログラムはできたところまで作成しています。 どこを直せばよいのでしょうか。 Public Class Form1 Private number As Integer Private rows As Integer Private columns As Integer Private Sub Form11_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load For i As Integer = 1 To 3 AddHandler Me.Controls("TextBox" & i).TextChanged, AddressOf TextBox_TextChanged Next End Sub Private Sub TextBox_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) If System.Text.RegularExpressions.Regex.IsMatch(CType(sender, TextBox).Text, "[^0-9]") Then MessageBox.Show("数字で入力してください", Me.Text, MessageBoxButtons.OK, MessageBoxIcon.Error) With CType(sender, TextBox) .Text = .Text.Substring(0, .Text.Length - 1) .SelectionStart = .Text.Length End With End If Dim cnt1 As Integer Dim cnt2 As Integer Dim cnt3 As Integer If Integer.TryParse(TextBox1.Text, cnt1) And Integer.TryParse(TextBox2.Text, cnt2) And Integer.TryParse(TextBox3.Text, cnt3) Then For k = 1 To cnt3 For i = 1 To cnt1 For j = 1 To cnt2 Dim tb As TextBox = New TextBox() tb.Name = "tb" + i.ToString() Me.Controls.Add(tb) tb.Top = (i - 1) * 28 + 55 tb.Left = (j - 1) * 30 + 40 * (cnt2 * (k - 1)) + 10 tb.Width = 25 Next Next Next End If End Sub Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load Me.Bounds = New Rectangle(10, 10, 1350, 800) Me.AutoScroll = True End Sub Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click Dim sum As Double Dim cnt As Integer = 0 For i As Integer = 1 To rows For j As Integer = 1 To columns Dim tb As TextBox = New TextBox() cnt += 1 : If cnt > rows * columns Then cnt = 1 tb.Name = "tb" + cnt.ToString Me.Controls.Add(tb) tb.Top = (i - 1) * 30 + (80 + 40 * rows) tb.Left = (j - 1) * 60 + 10 tb.Width = 40 sum = 0 For k As Integer = 1 To number sum += Double.Parse(CType(Me.Controls("tb" + (cnt + (rows * columns * (k - 1))).ToString()), TextBox).Text) Next tb.Text = sum.ToString() Next Next End Sub Private Sub TextBox1_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox1.TextChanged End Sub Private Sub TextBox2_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox2.TextChanged End Sub Private Sub TextBox3_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox3.TextChanged End Sub End Class
Private number As Integer Private rows As Integer Private columns As Integer Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Dim form2 As New Form() ' Create a button to add to the new form. Dim button1 As New Button() ' Set text for the button. button1.Text = "Scrolled Button" ' Set the size of the button. button1.Size = New Size(1000, 800) ' Set the location of the button to be outside the form's client area. button1.Location = New Point(form2.Size.Width + 200, form2.Size.Height + 200) ' Add the button control to the new form. form2.Controls.Add(button1) ' Set the AutoScroll property to true to provide scrollbars. form2.AutoScroll = True ' Display the new form as a dialog box. form2.ShowDialog() If Not Integer.TryParse(TextBox1.Text, rows) OrElse _ Not Integer.TryParse(TextBox2.Text, columns) OrElse _ Not Integer.TryParse(TextBox3.Text, number) Then MessageBox.Show("数字で入力してください", Me.Text, MessageBoxButtons.OK, MessageBoxIcon.Error) Exit Sub End If Me.Bounds = New Rectangle(10, 10, 1300, 900) Dim cnt As Integer = 0 For k As Integer = 1 To number For i As Integer = 1 To rows For j As Integer = 1 To columns Dim tb As TextBox = New TextBox() cnt += 1 tb.Name = "tb" + cnt.ToString() Me.Controls.Add(tb) tb.Top = (i - 1) * 30 + 80 tb.Left = (j - 1) * 60 + 70 * (columns * (k - 1)) + 10 tb.Width = 50 Next Next Next End Sub スクロール画面を作成し、 そのスクロール画面上にボタンを１つ作り、 テキストボックスが出てくるようにしたいです。 どうすればできるのでしょうか 。 これはわかるところまで作成しています。
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click If Not Integer.TryParse(TextBox1.Text, rows) OrElse _ Not Integer.TryParse(TextBox2.Text, columns) OrElse _ Not Integer.TryParse(TextBox3.Text, number) Then MessageBox.Show("数字で入力してください", Me.Text, MessageBoxButtons.OK, MessageBoxIcon.Error) Exit Sub End If Me.Bounds = New Rectangle(10, 10, 1300, 900) Dim cnt As Integer = 0 For k As Integer = 1 To number For i As Integer = 1 To rows For j As Integer = 1 To columns Dim tb As TextBox = New TextBox() cnt += 1 tb.Name = "tb" + cnt.ToString() Me.Controls.Add(tb) tb.Top = (i - 1) * 20 + 70 tb.Left = (j - 1) * 50 + 60 * (columns * (k - 1)) + 5 tb.Width = 55 Next Next Next End Sub これはボタンを押すと テキストボックスに入力された値分だけテキストボックスが出てくるというものです。 例えば ３ ４ ４とテキストボックスに値が入力された場合 ３行４列が４個分テキストボックスが出てきます。 しかし６ ６ ６と入力した場合画面に入りきらなくなってしまいます。 大きな値を入力しても画面に入れたいです。 これはスクロールなどしてできるようにしたいです。 どのようなソースでできるのでしょうか。
マクロで封筒を自動印刷出来る様にファイルを作りました。 先日、そのマクロで封筒を印刷する前に 別のファイルの物を印刷しようと思い、そのファイルの印刷設定を変えて 印刷をしました。 その後、マクロで作ったファイルで封筒を印刷したところ 印刷設定がおかしくなってしまいました。 とりあえず、設定を直し何度かマクロで印刷を試みましたが いくら直して上書きしても印刷設定が直らず・・・・。 一度、ＰＣを再起動して再び試みると印刷がきちんとされました。 この現象はマクロを使っているからなのでしょうか？？ それともマクロの使い方が悪くて起きる症状なのでしょうか？ 対策方法があれば教えて頂けるとうれしいです。 使っているマクロは次のとおりです。 Sub Futo_Copy() '////////////////////////////// '印刷を行う '////////////////////////////// Dim i As Integer Dim S_1 As String '1行目 Dim S_2 As String '2行目 Dim S_3 As String '3行目 Dim S_4 As String '4行目 Dim S_5 As String '5行目 Dim S_6 As String '6行目 Dim S_7 As String '7行目 Dim S_8 As String '8行目 Dim S_9 As String '9行目 Dim S_10 As String '10行目 Application.ScreenUpdating = False '描画をしない 'sheet_name = ActiveSheet.Name 'アクティブシート名を取得 'シートの中で使用されている最大の列を求める。 'row_count = Worksheets("印刷対象").Cells.Find("*", Range("A1"), , , xlByRows, xlPrevious).Row 'シートの中で使用されている最大の行を求める。 'col_count = Worksheets("印刷対象").Cells.Find("*", Range("A1"), , , xlByColumns, xlPrevious).Column row_count = Worksheets("印刷対象").Range("A65536").End(xlUp).Row For i = 3 To row_count '印刷対象の3行目からループ Worksheets("出力").Select 'データ取得 S_1 = Worksheets("印刷対象").Cells(i, 1) S_2 = Worksheets("印刷対象").Cells(i, 2) S_3 = Worksheets("印刷対象").Cells(i, 3) S_4 = Worksheets("印刷対象").Cells(i, 4) S_5 = Worksheets("印刷対象").Cells(i, 5) S_6 = Worksheets("印刷対象").Cells(i, 6) S_7 = Worksheets("印刷対象").Cells(i, 7) S_8 = Worksheets("印刷対象").Cells(i, 8) S_9 = Worksheets("印刷対象").Cells(i, 9) S_10 = Worksheets("印刷対象").Cells(i, 10) Worksheets("出力").Cells(1, 1) = S_1 Worksheets("出力").Cells(2, 1) = S_2 Worksheets("出力").Cells(3, 1) = S_3 Worksheets("出力").Cells(4, 1) = S_4 'Worksheets("出力").PrintPreview 'プレビュー Worksheets("出力").PrintOut 'プリントアウト Next i 'Worksheets("出力").Cells.Clear 'シートのクリア Application.ScreenUpdating = True '描画開始 Worksheets("印刷対象").Activate End Sub 出来ればこのマクロの形をあまり変えずに 症状が直せるといいのですが・・・。 よろしくお願い致します。
入力フォームの内容をテーブルへ登録するFunctionプロシージャを作成したいのですが上手くいきません。 ご指導いただければと思います。宜しくお願いいたします。 Function WriteMyData() As Boolean DoCmd.Hourglass True On Error GoTo errHandler WriteMyData = False Set MycnnDst = Application.CurrentProject.Connection Set MycnnrstDst = New ADODB.Recordset MycnnrstDst.Open "SELECT 整理番号,発掘者,件名,発生日,曜日,時間," _ & "天候,温度,風,体調," _ & "作業分類,作業詳細," _ & "MAN,MACHINE,MEDIA,MANAGE," _ & "内容,影響,対策,重要度,対策完了,入力日 " _ & "FROM " & MyTableName & " WHERE 整理番号='" & Me.整理番号 & "'", MycnnDst, adOpenKeyset, adLockPessimistic, adCmdText Select Case Me.MyDataMode Case "追加" If MycnnrstDst.EOF Then MystrTableDst = "INSERT INTO " & MyTableName & " " If IsNull(Me.対策完了) Then MystrItemDst = "( 整理番号, 発掘者, 発生日, 件名, 曜日, 時間, " _ & "天候, 温度, 風, " _ & "体調, 作業分類, 作業詳細, " _ & "MAN, MACHINE, MEDIA, MANAGE, " _ & "内容, 影響, 対策, 重要度, 入力日, " ') " MystrItemSrc = "VALUES ('" & Me.整理番号 & "','" & Me.発掘者 & "'," _ & "#" & Me.発生日 & "#,'" & Me.件名 & "','" & Me.曜日 & "','" & Me.時間 & "'," _ & "'" & Me.重要度 & "',#" & Me.入力日 & "#," _ & "'" & "') " Else MystrItemDst = "(整理番号,発掘者,件名,発生日,曜日,時間," _ & "天候,温度,風,体調," _ & "作業分類,作業詳細," _ & "MAN,MACHINE,MEDIA,MANAGE," _ & "内容,影響,対策,重要度,対策完了,入力日,図解ファイル,添付ファイル) " MystrItemSrc = "VALUES ('" & Me.整理番号 & "','" & Me.発掘者 & "'," _ & "#" & Me.発生日 & "#,'" & Me.件名 & "','" & Me.曜日 & "','" & Me.時間 & "'," _ & "'" & Me.内容 & "','" & Me.影響 & "','" & Me.対策 & "'," _ & "'" & Me.重要度 & "',#" & Me.対策完了 & "#," & "#" & Me.入力日 & "#," _ & "'" & "') " End If MystrTableSrc = "" MystrParmSrc = ";" MystrSqlDst = MystrTableDst & MystrItemDst & MystrItemSrc & MystrParmSrc MycnnrstDst.AddNew MycnnDst.Execute MystrSqlDst, , adCmdText Me.MyEdited = "" End If Case "修正" MystrTableDst = "UPDATE " & MyTableName & " " If IsNull(Me.対策完了) Then MystrItemDst = "SET " _ & "整理番号 = '" & Me.整理番号 & "', " _ & "発掘者 = '" & Me.発掘者 & "', 発生日 = #" & Me.発生日 & "#, " _ & "件名 = '" & Me.件名 & "', 曜日 = '" & Me.曜日 & "', " _ & "入力日 = #" & Me.入力日 & "#, " & "' " Else MystrItemDst = "SET " _ & "整理番号 = '" & Me.整理番号 & "', " _ & "発掘者 = '" & Me.発掘者 & "', 発生日 = #" & Me.発生日 & "#, " _ & "件名 = '" & Me.件名 & "', 曜日 = '" & Me.曜日 & "', " _ & "対策完了 = #" & Me.対策完了 & "#, 入力日 = #" & Me.入力日 & "#, " & "' " End If MystrItemSrc = "" MystrTableSrc = "" MystrParmSrc = "WHERE (連番 = " & Me.連番 & ");" MystrSqlDst = MystrTableDst & MystrItemDst & MystrItemSrc & MystrTableSrc & MystrParmSrc MycnnDst.Execute MystrSqlDst End Select Forms!HiyariHattoIchiran2013.Requery WriteMyData = True ExitMe: On Error Resume Next On Error GoTo errHandler DoEvents DoCmd.Hourglass False Exit Function errHandler: MsgBox "WriteMyData Error Number " & Err.Number & " : " & Err.Description WriteMyData = False Resume ExitMe End Function
ComboBoxに「あ、い、う、え、お」という項目があった時、現在「あ」が選択されている場合、 ボタンを押したときに現在選択されているコンボボックスの項目を抜き出したいです。 ListIndexだと「0」という数字は抜き出せますが、「あ」という項目が出ません。
Excel2003のVBAを使用し、10行おきに太い罫線をセルの下側に引きたいのですが、ご存知な方教えて頂けないでしょうか？ 出来る事なら、セルの中に×が入っている行は自動的に省いて(選ばず)10行おきに罫線を引きたいと思っています。 先日、解決した内容の質問ですが、新たに3行目から最終行までとか罫線を引きたい行を指定出来るようにコーディングいただけると大変助かります。
Public Class Form1 Private number As Integer Private rows As Integer Private columns As Integer Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click If Not Integer.TryParse(TextBox1.Text, rows) OrElse _ Not Integer.TryParse(TextBox2.Text, columns) OrElse _ Not Integer.TryParse(TextBox3.Text, number) Then MessageBox.Show("数字で入力してください", Me.Text, MessageBoxButtons.OK, MessageBoxIcon.Error) Exit Sub End If Me.Bounds = New Rectangle(10, 10, 1300, 800) Dim cnt As Integer = 0 For k As Integer = 1 To number For i As Integer = 1 To rows For j As Integer = 1 To columns Dim tb As TextBox = New TextBox() cnt += 1 tb.Name = "tb" + cnt.ToString() Me.Controls.Add(tb) tb.Top = (i - 1) * 30 + 80 tb.Left = (j - 1) * 60 + 70 * (columns * (k - 1)) + 10 tb.Width = 50 Next Next Next End Sub Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click Dim sum As Double Dim cnt As Integer = 0 For i As Integer = 1 To rows For j As Integer = 1 To columns Dim tb As TextBox = New TextBox() cnt += 1 : If cnt > rows * columns Then cnt = 1 tb.Name = "tbA" + cnt.ToString Me.Controls.Add(tb) tb.Top = (i - 1) * 30 + (80 + 40 * rows) tb.Left = (j - 1) * 60 + 10 tb.Width = 40 sum = 0 For k As Integer = 1 To number sum += Double.Parse(CType(Me.Controls("tb" + (cnt + (rows * columns * k-1))).ToString(), TextBox).Text)　　　　エラー Next tb.Text = sum.ToString() Next Next End Sub Private Sub Button3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button3.Click Do Until Me.Controls.Count <= 6 For Each tbD As Object In Me.Controls If CType(tbD, Control).Name Like "tb*" Then Me.Controls. Remove(tbD) Next Loop End Sub End Class エラーと書いている箇所 どう直したらよいのでしょうか。 縮小変換しないで呼び出されるアクセス可能なitemがないためオーバーロードの解決に失敗しました と出ます。 あとwindowsの画面の大きさを入力される値が小さければ少し小さいwindowsになるように変えたいのですがどうしたよいのでしょう。
次のプログラムでButton1を押さないで×を押すと仕事を残して終了した事になり，PCの調子が悪くなります。 なんとか回避できないでしょうか。 Public Class Form1 Private ExitFlag As Boolean = False Private Sub Button2_Click(sender As System.Object, e As System.EventArgs) Handles Button2.Click For I = 1 To 10000 System.Threading.Thread.Sleep(1000) Application.DoEvents() '他のWindows操作を可能にするため If ExitFlag Then Exit For Next ExitFlag = False MsgBox("中止されました") End Sub Private Sub Button1_Click(sender As Object, e As System.EventArgs) Handles Button1.Click ExitFlag = True End Sub End Class
エクセルＶＢＡにて 型が一致しない　エラーのポップが出ます。 プログラムは中断していますが、ＯＫボタンで　プログラムは止まらず、その後の処理を実行します。 コードを表示した状態で　デバッグを行いたいのですが、プログラムが止まらないので、箇所が特定できません。 自作フォーム、モジュール、タイマー、何でもありの状態ですが、そのまま、継続される・・・ってことが 場所の特定できる方法って　考えられるでしょうか　
ＶＢＡ データフォーム　テキストＢＯＸの内容が旨く表示出来なくて困っています。 　お世話になります。 　データフォームを使って、シートの修正マクロを作成してます。 フォームにはコードと選択項目の２つのテキストＢＯＸが有り、該当行の修正をしてＯＫボタンを クリックすると、修正したコードと選択項目はシートに反映されるのですが、以降の行の修正で テキストＢＯＸの表示が1件目のまま変わりません。 　行が変わった時に、該当行の内容（コード、選択項目）を表示させる様にしたいのです。 以下ＶＢＡのコーディングです。宜しくお願いします。 Dim setIn As Range Dim cnt_A As Long Private Sub CommandButton1_Click() '各項目の入力 Set setIn = ActiveCell.Offset(0, 0) Select Case データ入力.Caption Case Is = "コード　入　力" cnt_A = cnt_A + 1 'フォームにコードをセット With setＩn(cnt_A) .Value = Sample_No .Offset(0, 0).Value = Sample_No End With Case Is = "A　入　力" cnt_A = cnt_A + 1 'フォームに項目Aをセット With setＩn(cnt_A) '.Value = Sample_No .Offset(0, 1).Value = Sentaku_Koumoku End With Case Is = "B　入　力" cnt_A = cnt_A + 1 'フォームに選択項目Bをセット With setIn(cnt_A) '.Value = Sample_No .Offset(0, 2).Value = Sentaku_Koumoku End With End Select End Sub
VBAについての質問です。 日付をリストボックスに追加したいのですが、2013年から始まり、2014年、2015年となるごとに自動で追加されていくようにプログラムを組みたいです。 プログラミング初心者なのもので、どのように組めばいいのかがわかりません。 どうかご教授お願い致します。
VB2010で次の様なSleepを使ったプログラムなんですが途中で中断させることはできるでしょうか。 For I=1 to 100 System.Threading.Thread.Sleep(1000) Next
Excel2003のVBAを使用し、10行おきに太い罫線をセルの下側に引きたいのですが、ご存知な方教えて頂けないでしょうか？ 出来る事なら、セルの中に×が入っている行は自動的に省いて(選ばず)10行おきに罫線を引きたいと思っています。
ソフトが起動（Ｌｏａｄ）時に設定ファイル（テキスト）を読み込む様にしたいのですが，環境が変わっても必ず読んでくれる便利な場所はありますか。
エクセル2007を使用してします。以前に、 「ある報告書の全シートを対象として　A1セルにｋさんの名前が入力されたらそのシートのシート見出しが緑になり、A2セルにｍさんの名前が入力されたらそのシートのシート見出しが青になり、なおかつ、ｋさんとｍさん２人の名前が入力されたらそのシート見出しの色が黄色に自動でなるマクロの記述を教えてください」と質問し、 Private Sub Worksheet_Change(ByVal Target As Range) a1 = Range("a1").Value a2 = Range("a2").Value f = 0 If a1 = "k" Then f = f or 1 If a2 = "m" Then f = f or 2 c = Switch(f = 1, 4, f = 2, 5, f = 3, 6, True, xlNone) ActiveSheet.Tab.ColorIndex = c End Sub 上記のように御回答を頂きましたが、今後、入力する名前が変更する事を考えて、A1・A2セル共に、 何か文字が入力されたら（もしくは空白でなければ)と条件を変えたいと思い、色々試してみたのですが、 上手くいきませんでした。 何方か、条件に合うコードの記述を教えてください。宜しくお願いします。
Visual Studio Express 2012 for Windows DesktopでVBを使って帳票のプログラムを作ろうとしています。 サンプルソースがあればご紹介ください。 できれば、外部ツールを使わずに、追加費用が発生しない範疇で制作したいです。
エクセル2007を使用しております。 下図のように、【カテゴリー】A列が「野菜」の場合、【種類】B列で野菜の種類が表示され、プルダウンの中から選択、【カテゴリー】A列が「果物」の場合、【種類】B列で果物の種類が表示され、プルダウンの中から選択… ということをしたいのですが、A列の値によって、B列のプルダウンに表示される内容を変えるには、どういった方法が一番よいか、教えていただけないでしょうか。 INDEX、MACH関数、リストボックスやコンボボックスなどのサイトを見たのですが、上手くできず、勉強不足で申し訳ありませんが、急を要するためお力を貸していただけましたら幸いです。 どうぞよろしくお願いいたします。
Excel 2003にて、データを入力して 特定のセルのみ、入力編集できるようにしたいため、 シート保護をかけており、オートフィルタで絞込みまではできるようになったのですが いくつかの項目で絞込みをすると、その分、順番にすべてを表示をクリックしないと いけないので、手間がかかります。また、シート保護をかけているので、メニューバーの すべてを表示は選択できません。 そこで、オートシェイプで、すべてを表示のボタンをマクロ、で作成しようと試したんですが エラーが出たりで上手くいきません。 上記の状況で、ワンクリックですべてを表示させる 正しい方法、何かいい方法をご存知の方、よろしくお願いします。
Excel VBAを使用してます。 列Dにデータがずらっと入っています。 (1)偶数個目にあるデータをその1個前の列Eに移動する。 (2)空白となったD列は上方向に詰める。 という処理を書きたいのです。 VBA歴が浅いためひらめきません。よろしくお願いします。m(__)m
お世話になります。 Access2000で作成しております。 下記のテーブルでAccess2000のSQLを駆使して、 下記の結果を抽出したいと思っております。 やまだの成績=80の件数のみを抽出することはできたのですが、 80と６０を同時に抽出する方法がわかりません。 お手数ですが教えていただければと思います。 --テーブル--- 名前　　　成績 やまだ　　80 やまだ　　80 たなか　　80 やまだ　　60 やまだ　　80 ---結果※やまだのみ、各点数の件数----- 名前　　 80の件数　60の件数 やまだ 3　 1
ノートパソコン(Windows7 64bit、EXCEL 64bit)を使用して、VBAでツールを作成しています。 フォーム上にListViewを追加したいのですが、コントロールの追加ダイアログにて 「Microsoft ListView Control, version 6.0」がリストがないので追加することができません。 参照設定にも「Microsoft Windows Common Controls 6.0(SP6)」がありませんでした。 これが原因かと考え、System32に「MSCOMCTL.OCX」がなかったので、 ListViewの使える他のパソコン(Windows7 32bit、EXCEL2010 32bit)から 「MSCOMCTL.OCX」を持ってきて入れました。 すると参照設定で「Microsoft Windows Common Controls 6.0(SP6)」を選べるようになったのですが、 未だにコントロールの追加ダイアログ上ではListViewの利用ができない状態でした。 職場のほとんどパソコンではListViewが使用可能なのですが、 ListViewが使用できないパソコンの条件などあるのでしょうか？ ご回答お待ちしておりますのでよろしくお願い致します
現在、VB.NETのプログラムから、 クリスタルレポートを使用して印刷を出しています。 ですが、現在よくわからないエラーに悩まされています。 何枚かを送って印刷するぶんには問題ないのですが、 15枚以上印刷をしようとすると、 PrintToPrint　のところでエラーとなるのですが、 いざエラーメッセージを見ると、「エラーはありません」となっています。 エラーになり止るのに、メッセージでは「エラーはない」という風になっているので、 完全に意味がわかりません。 なお、印刷は15枚以上、別々にプリンタに送っています。 （ループで指定データ数分まわして、その枚数をプリンタに送っています） その印刷するときのデータのせいかな、とも思ったのですが、 複数枚出さず、単体で印刷しようとするときちんと動作します。 それに、エラーが出たときにその部分を飛ばして、 残りの印刷をさせようとするときちんと動作します。 「VB.NET　エラーはありません」　や　「クリスタルレポート　エラーはありません」　で ウェブ検索をしてみたのですが、情報を見つけることができませんでした。 理由をご存知の方、 こうではないかという予想を付けられる方、 ぜひご教授願います。
初心者ながら医療業務用マクロを作っています。 テキストボックス内の文字のうち、最初の改行までを取消線解除する方法を教えてください。 何卒よろしくお願いします。
お世話になります。 下記の形で、xmlファイルを置換変換したいと思っております。 ・xmlファイルの置換 ・正規表現で置換 下記のＵＲＬ等を参考に作成したのですが、変換すると 要素(=全角文字)の箇所が文字化けしてしまいます。 http://grade.upper.jp/wp/pg/257 どのようにすれば、文字化けすることなく、 xmlファイルの中身を正規表現で置換することができるのでしょうか？ お手数ですが宜しくお願い致します。
エクセルの A列に1,1,3,2,4・・・・・というデータがあって、 B列にB,A,C,D,E・・・・・というデータがった場合、 上から順番に1A,1B,2D,3C,4Eという順番に並べ替えしたいです。 エクセル単独でやる場合は、データの並べ替えでA列を第一優先、B列を第二優先で並べ替えをすればよいのですが、 VBAに埋め込んで、ボタンを押せば並べ替えできるようにできますでしょうか？
お世話になります。 ExcelのVBAを使用して、xmlファイルの全要素・全属性を読み込み、 Excelに書き出したいと思っております。 ネットを参考に下記のソースで、全ての要素をエクセルに 書き出すことは、できたのですが、どうしても全属性を読み込むことが できません。 どのようにすればよいか教えて頂けないでしょうか？ お手数ですがよろしくお願い致します。 -----------------ソース---------------- Sub main() Dim myxml As New DOMDocument40 Dim nodelist As IXMLDOMNodeList Dim onenode As IXMLDOMNode Dim i As Integer myxml.Load ("C:\Users\harada\Desktop\problem_info取り込み\problem_info.xml") Set nodelist = myxml.DocumentElement.ChildNodes i = 1 For Each onenode In nodelist Call submain(onenode, i, 1) i = i + 1 Next End Sub Sub submain(tmp As IXMLDOMNode, itmp As Integer, j As Integer) If tmp.HasChildNodes = False Then Exit Sub k = tmp.ChildNodes.Length For m = 0 To k - 1 Cells(itmp, j + m).Value = tmp.ChildNodes(m).Text Next j = j + m Set tmp = tmp.ChildNodes.NextNode Call submain(tmp, itmp, j) End Sub
初心者ながら医療業務用マクロを作っています。 テキストボックス内の１行目のみ取消線を解除する方法を教えてください。 UserForm1.TextBox12.Lines(1).Font.Strikethrough = False これではさすがにエラーが出ました； 何卒よろしくお願いします。
お世話になります。 Access2000のVBAで作成しております。 Ｅｘｃｅｌに記載した情報をAccessのテーブルに 取り込むために下記のソースを作成致しました。 既にテーブルに主キーが重複しないものを取り込むときは 正常に処理が走るのですが、 主キーが重複する場合は、重複する旨メッセージを出して 処理が止まります。 どのようにソースを修正すれば、「主キーが重複する場合、上書き更新」 するように処理が走るのでしょうか？ 以上宜しくお願い致します。 --------------ソース------------------------------ Dim rs As New ADODB.Recordset Dim oApp As Object Dim iRow As Long Set oApp = CreateObject("Excel.Application") oApp.Workbooks.Open Filename:="hogehoge.xls" rs.Open "テーブル", CurrentProject.Connection, adOpenForwardOnly, adLockOptimistic iRow = 2 ' ★ While(　ループ　) 　　rs.AddNew 　　rs("ID") = oApp.Cells(iRow, 1) 　　rs("名前") = oApp.Cells(iRow, 2) 　　rs.Update 　　iRow = iRow + 1 Wend rs.Close oApp.Quit Set oApp = Nothing
お世話になります。 Access2000のVBAで質問させてください。 現在、下記の様な状況です。 ・「テーブルA」がある。 ・「テーブルA」の"番号"が"1"のものだけを抽出する「抽出」クエリを作成 ※クエリのデザインビューで"1"を指定するのでなく、 　　 VBA上で、パラメータとして"1"を指定したい 　　 1ではなく、2に変わる事もあるため、VBAで操作。 ・結果をＥｘｃｅｌに書き出したい そこで、いろいろなサイトを見たのですが、 ・VBAでパラメータを使用したクエリを作成 ・Ｅｘｃｅｌに書き出し の2つの内容が別々に記載されており、 私の力では、別々で作成はできるのですが、 ・VBAでパラメータを使用・設定したクエリをＥｘｃｅｌに書き出し する事はできませんでした。 本当に勝手で申し訳ございませんが、 　・VBAでパラメータを使用・設定したクエリをＥｘｃｅｌに書き出す ソースを頂けないでしょうか？ 「××と○○を組合わせればよい」などの、一部を抽出したコメントは、 不要ですので、本当に申し訳ございませんが、 ソースレベルでご返信頂ければと思います。 ※一部を抽出したコメントは、ネットで見たのですが、結果、 　目的を達成することはできませんでした。 お手数で申し訳ございませんが、なにとぞ宜しくお願い致します。 ※何度ひつこい・勝手ですみませんが、ソースレベルでの 回答のみお願いします。
Visual Basic 2010 Express windows7 Pro テキストボックスに入力された数字をテキストファイルに出力したいのですが、 「4.0」や「04」だと出力されるのですが、「4」だと出力されないのは何故でしょうか？ Shell("cmd /c @echo " & TextBox1.Text & ">> aaa.txt", AppWinStyle.Hide, True)
VBAについてお教えください。テキストファイルを開いて、データ処理を行おうと思っています。 下記のような処理をおこなっています。 On Error GoTo ErrorHandler 'ファイル番号を取得 FNo = FreeFile Do While Not EOF(FNo) ～～処理 ～～処理 Loop 'ファイルを閉じる Close #FNo ErrorHandler: ～～処理 end sub ループが無事に終わって、ファイルを閉じるところまで行くのは良いのですが、Close #FNoの後に処理がErrorHandler:に移ってしまいます。 特に問題が無ければ、ErrorHanderを飛び越えてend subに行くと思っていたのですが、認識が違うのでしょうか？ それとも何らかのエラーが起こっているのでしょうか？
VBではdouble型等の型を持つ関数は宣言できるのでしょうか？ C#だちできると思うのですが・・・。 また、VBでも　Dim hoge as doubleなど、変数ならできると思うのですが・・。 ご存知の方、お願いします。
あるフォルダ（C:\test\）内のフォルダ名が日付形式（YYYYMMDD）のものの中で、 一番新しい日付のフォルダを残し、古い日付のフォルダを削除したいです。 日付が新しいか古いかは、フォルダ名で判断。作成日時で判断するのではない。 C:\test\フォルダには、日付形式（YYYYMMDD）のフォルダとそれ以外の名称のフォルダ、ファイルが含まれます。 例ですが、C:\test\フォルダに以下のフォルダ・ファイルがあるとして、 C:\test\AbcD1\ C:\test\20130601\ C:\test\20130611\ C:\test\Aiueo2\ C:\test\aa2.log C:\test\20130602\ C:\test\20130605\ C:\test\20130614\ C:\test\Zxy2\ C:\test\aaa.txt 削除するのは、 C:\test\20130601\ C:\test\20130611\ C:\test\20130602\ C:\test\20130605\ です。 以下のフォルダについては、フォルダ名が日付形式（YYYYMMDD）ではないので、 削除しません。 C:\test\AbcD1\ C:\test\Aiueo2\ C:\test\Zxy2\ 以下のフォルダについては、フォルダ名の日付が最新のため、 削除しません。 C:\test\20130614\ ファイルについては、削除しません。 C:\test\aa2.log C:\test\aaa.txt フォルダの一覧を取得するvbsは作成できました。 ですのであとは、 １．日付形式のフォルダを取得 ２．最新の日付形式のフォルダ名を取得する ３．最新以外の日付フォルダを削除する 部分ができれば、できそうです。 サンプルソースや参考サイトを教えてください。
すいませんが、ご教示願います。 パソコンExcelのVBAです。 Excelファイルシートの24,000行あるデータを、 任意に選択した範囲（例えば2行目から3,000行目）をcsvデータに出力する VBA構文が知りたいです。 どなたかおわかりになりますでしょうか。
Visual Basic 2010 Express windows7 Pro dmyが何であるかでラジオボタンのチェックを入れたいのですが、 下記の場合はそれぞれの値でチェックが入りません。 dmy = My.Computer.FileSystem.ReadAllText("dmy.txt") Select Case dmy Case "aaa" RadioButton4.Checked = True Case "bbb" RadioButton6.Checked = True Case "ccc" RadioButton7.Checked = True End Select 下記の場合、CheckBox7にチェックが入ると、 RadioButton1はオフになったので、 Trueにするだけで出来ると思ったのですが、変わりませんでした。 If CheckBox7.Checked Then RadioButton1.Checked = False End If
BasicとVisualBasicはどの程度違うのですか？（コードが）
現在VisualBasic2010expressを使っています。 オーディオの録音用プログラムを作りたいと思い とあるホームページからwave入出力用のCOMコンポーネントファイル（.ocx）をダウンロードしました。 E:ドライブの「system32」の中に入れVBから「ツール→アイテムの選択→COMコンポーネント→参照」と操作しsystem３２に入ってる目的のファイルを探したんですがどこにも見当たりません。 VBではなく普通に「sysytem32」を開いた場合は目的のファイルはきちんと存在します。 またVB上でも「system32」上ではなく「system」のフォルダに置いた場合は参照できます。 なぜ「system32」上だと参照できないんでしょうか？ 読み取り専用、隠れファイル等もチェックを外してみたのですが変わりませんでした。 VBでファイル名を示し実行した場合は「そのファイルは存在しません」となります 使用しているOSはWindows8です。8が原因何でしょうか？ 初歩的な質問で申し訳ありません。
お世話になります。 ＥｘｃｅｌファイルのＸとYがあります。 Xから、「複数セルを選択」して、Yに「貼付け」する処理の 一部をマクロ(vba)で作成したいと思っております。 具体的ステップとして (1)手動で、Xの任意の連続したセルを選択してコピー (2)Yに移動して、貼り付けしたいセルを選択 (3)(1)で取得したデータをペースト です。 (3)の箇所を「Xのマクロ」を呼び出して実現したいと 思っているのですが、どのようにマクロ(VBA)を記載したら実現できるでしょうか？ 本当に勝手で申し訳ございませんが、 　・上記を実現するVBAのコード 　・実際に動作確認されたVBAのコード を教えて頂けないでしょうか？ 実は、同じような質問を2回ほどしたのですが、実現できない 回答ばかりでした。 VBAの得意な方、何卒宜しくお願い致します。 ※普通レベルの方は無理と思われますので
お世話になります。 AccessのVBAで質問させてください。 「クエリーA」に設定している「ID1」のパラメータを 「テーブルA」の「IDX」の値を設定したいと思っております。 「ID1」にパラメータ2を設定する方法は分かったのですが、 下記の2つの方法がわかりませんでした。 ・「ID1」のパラメータを「テーブルA」の「IDX」の値を設定する方法 ・「テーブルA」は複数レコードあるので、その数だけfor文的なループで回したい お手数で申し訳ございませんが、 「クエリーA」に設定している「ID1」のパラメータを 「テーブルA」の「IDX」の値を設定する方法VBAコードを 教えて頂ければと思います。 本当に勝手いいますが、コードを記載して頂ければと思います。 宜しくお願い致します。 -----「ID1」にパラメータ2を設定する方法----- Set qdf = dbs.QueryDefs("クエリーＡ") With qdf .Parameters("ID") = 2 Set rst = .OpenRecordset End With
お世話になります。 ＥｘｃｅｌファイルのAとBがあります。 Aから、「複数セルを選択」して、Bに「貼付け」する処理の 一部をマクロ(vba)で作成したいと思っております。 具体的ステップとして (1)手動で、Aの任意の連続したセルを選択してコピー (2)Bに移動して、貼り付けしたいセルを選択 (3)(1)で取得したデータをペースト です。 (3)の箇所を「Aのマクロ」を呼び出して実現したいと 思っているのですが、どのようにマクロ(VBA)を記載したら実現できるでしょうか？ お手数ですが宜しくお願い致します。
Dim ws As Worksheet, i& このような内容の宣言をみたのですが、 i&はどんな意味があるのでしょうか？ ＆はlong型を意味する事までは調べがついたのですが、i&の意味が分かりませんでした。 回答よろしくお願いします。
ACCESSフォーム内のテキストボックスが空欄かどうかで条件分岐させる方法を教えてください。 フォーム内に複数テキストボックスがあります。 テキスト１ テキスト２ テキスト３ このテキストボックスの入力があるかどうかで、 エクスポートするクエリを変更したいです。 それぞれのテキストボックスの入力値は、 対応するクエリの抽出条件になっています。 少なくとも、テキスト１には入力があるという条件で、 ・テキスト２が空白なら、クエリ２を出力する ・テキスト３が空白なら、クエリ３を出力する という処理を行いたいのです。 マクロビルダーで、IFを使った処理は作ることができたのですが、 VBAを使って、同じ処理ができるようにしたいです。 どうかご教授のほど、よろしくお願いします。
A1～D5に自動的に順番にデータを入力したいです。 A1→B1→C1→D1→A2→B2→C2→D2→A3・・・ といった感じです。 If range("A1").Value = "" Then 　range("A1").Value=○ ElseIf range("A1").Value <> "" Then 　range("B2").Value = ○○ ・・・ のようにたくさんIf文を書くしかないのでしょうか。
お世話になります。 ＥｘｃｅｌAとＥｘｃｅｌBがあります。 ＥｘｃｅｌAから、「複数セルを選択」して、Ｅｘｃｅｌbに「貼付け」する処理の 一部をマクロ(vba)で作成したいと思っております。 具体的ステップとして (1)手動で、ＥｘｃｅｌAの任意の連続したセルを選択してコピー (2)ＥｘｃｅｌBに移動して、貼り付けしたいセルを選択 (3)(1)で取得したデータをペースト です。 (3)の箇所を「ＥｘｃｅｌAのマクロ」を呼び出して実現したいと 思っているのですが、どのようにマクロ(VBA)を記載したら実現できるでしょうか？ お手数ですが宜しくお願い致します。
先日、VB6のソースを、アップグレードツールを使用しVB2008(無料版を使用)にコンバートしました。 そしてコンバート後、表示されているエラーとワーニングを全て取り、起動してみたのですが、特に変えた記憶のない設定ファイル読み込みの処理で失敗するようになり、起動しなくなりました。 デバッグ実行にて調べていくとどうやら、「GetPrivateProfileString」に対する引数にて、ファイル名(パス込み)を指定しているのですが、このファイル名の後半部分が一部削除されているようです。 (削除されている文字数は、どうやら、ファイルパスに含まれる全角文字列と同数のようでした。) 何が原因で起こっており、どうすれば直るのでしょうか・・・。 ネット上で調べてみたのですが、原因と直し方がイマイチ解らなくて、こちらで質問させていただきました。 どうか、ご教授いただけないでしょうか。<(_ _*)> (動作環境：Windows7 32bit版 　　　　　　　Visual Studio2008 無料版)
早速ですが セルに　=IF(AK3554>0,"○",IF(AK3554<0,"▽","□")) を　代入してあります。 これを、ＶＢＡの側から　送り込みたいのですが（IF文の答え送り込んだのでは　再計算の時困りますので、式を送り込みたい） で Range("ay" & endgt ) = "=IF(AK" & endgt & ">0," & "○" & ",IF(AK" & endgt & "<0," & "▽" & "," & "□" & "))" これだと　エラーにはならないのですが セルには　 =IF(AK3554>0,○,IF(AK3554<0,▽,□))　　 ””が無くなります（式には　””　が　ないですから、当たり前と言えば・・・）。 ＶＢのＳＱＬ　的には　”　の代わりに　’　シングルで　良いはずなんですが・・・・"'○'"　みたいな感じで。 如何でしょうか？　お知恵拝借
VB.net(2010 Express)でTreeViewコントロールを使用し、子ノードと子ノードの間にドラックアンドドロップする際に線を表示したいのですが、どのようにすれば良いのか分かりません。 単純に子ノードのドラッグアンドドロップはできるのですが、子ノード同士の間に線を表示する方法が分からずにハマっています！！ 添付しました画像の様な線を表示できる方法など分かる方がいましたら、お力をお貸しください。 宜しくお願い致します。
ご回答宜しくお願い致します。 現在、VBでユーザーコントロールのDLLを作成し、 DLLをC#で使用するというプログラムを開発してます。 そこで、以下のような現象が起こり 対応できかねております。 まず、VBで以下のメソッドを書きました。 Public　Sub　showMessage(ByVal bol As Boolean) 　　　　MessageBox.Show(bol) End Sub そして、C#からDLLのコントロール ( Panel1 ) を呼び出し、 private void Panel1_MouseClick(object sender, MouseEventArgs e) { 　　　　Panel1.setSelectedFlg(true); } これでメッセージボックスが表示されると思ったんですが表示されません。 VBのMessageBoxを別の処理に変えても全く動作しません。 メソッドを動作させる方法はございますでしょうか 宜しくお願い致します。
お世話になります。 htmの全ての「タグの名前・内容」を抜き出す方法を知りたいと 思っております。 具体的には、「A列にタグの名前」「B列にタグの内容」を自動入力したいと 思っております。 特定のタグのみを抜き出す方法は、ネットで調べて分かったのですが、全てのタグ を抜き出す方法を教えて頂ければと思います。 宜しくお願いします。
Excel2003です。 現在、A列に1～5の数字がランダムで200行ほど入力されています。 このA列をキーとして A:1　1 A:2　2 A:3　3 A:4　4 A:5　5 A:6　1 ・ ・ ・ のようにソートすることは可能でしょうか？
お世話になります。 ご回答宜しくお願いします。 現在VBでDLLプログラムを開発しております。 以下簡単な仕様です。 DLLで自作のプロパティ（ SelectedFlg ）と、 SelectedFlgが変更された時に発生するイベントを追加しました。 親システムからVBのDLLを呼び出し、親システムがSelectedFlgの値を変更すると DLL内でイベントを感知し、処理をするというような感じです。 例えば、親システムへDLLをパネルとして２つ（ A , B ）貼り付け Aをクリックすると、AのSelectedFlgをTrueに、BのSelectedFlgをFalseにして Trueの方はBackColorを赤、Falseの方はBackColorを白 のような形にしたいと考えてます。 しかし、実行してみると BackColorが反映されるのは、初期値を設定した時の１度のみでした。 その後クリックしても、BackColorが変化することはありません。 どこか間違いや思い違いがあるんでしょうか。 以下コードになります。 　・・・OriginalControlクラス・・・ Public Class OriginalControl 　　Public Event SelectedValueChanged(ByVal sender As Object, ByVal e As EventArgs) 　　Protected Sub OnSelectedValueChanged(ByVal e As EventArgs) 　　　　RaiseEvent SelectedValueChanged(Me, e) 　　End Sub 　　Public Property SelectedFlg() As Boolean 　　　　Get 　　　　　　Return m_SelectedFlg 　　　　End Get 　　　　Set(ByVal value As Boolean) 　　　　　　m_SelectedFlg = value 　　　　　　Me.OnSelectedValueChanged(New EventArgs) 　　　　End Set 　　End Property 　　Private m_SelectedFlg As Boolean End Class ・・・Panel・・・　OriginalControlクラスを継承したControl （ 省略 ） 　　　　Private Sub Panel_SelectedValueChanged(ByVal sender As System.Object, 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　ByVal e As System.EventArgs) 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　Handles MyBase.SelectedValueChanged 　　　　　　If Me.SelectedFlg = True Then 　　　　　　　　setBackColor( Color.Red ) 　　　　　　Else 　　　　　　　　setBackColor( Color.White ) 　　　　　　End If 　　　　End Sub
グラフタイトルを設定していればグラフタイトルを、設定していなければ「タイトル無i」という文字をstrGTITLEに返そうとしています。(この処理はfor i = 1 to ActiveSheet.ChartObjects.countのループ内で行っています。) 当方マクロ初心者でして、色々調べたりし以下のようなマクロを作成してみたのですが、「このオブジェクトにはタイトルがありません」のエラーが返されます。 どのようにすれば改善できるのでしょうか。 どうぞよろしくお願いいたします。 If ActiveChart.ChartTitle Is Nothing Then '←この行でエラーが起きます strGTITLE = "タイトル無" & i Else strGTITLE = ActiveChart.ChartTitle.Text End If
音声認識アプリケーションからvbsを実行できるのですが、ここで一度だけマウスクリックしたい状況が出てきて困っています。 Dim WSHShell As Object Set WSHShell = CreateObject("Wscript.Shell") WSHShell.AppActivate "操作したいアプリケーション名" WSHShell.SendKeys "{TAB}" 'OK WSHShell.SendKeys "{ENTER}" 'OK WSHShell.SendKeys "{CLICK LEFT, 10, 10}" 'NG TABキーやENTERキーは動作するのですが、3番目のマウスクリックがExceptionといわれエラーになってしまいます。Sendkeysでマウスクリックを送信するにはどうしたらよいのでしょうか？ネットで調べたリファレンスだと上記のような書き方で良さそうなのですが・・・ 音声認識アプリケーションはドラゴンスピーチ11Jで、OSはWin 7 ProとWin 8、どちらも64ビットです。
Excel２００３のＶＢＡを使用し、自動でシートごとに連番を入れる方法を教えて下さい。 Ｐ０９１１～ Ｐ０９５０までとか番号が自由に設定出来て、尚且つ、最初の番号に入っているエクセルデータが最後の番号まで同じ内容で導入されているのが望ましいです。 どなたか、ご教示頂けると大変助かります。
WinSCPを使って、SSH接続をし、ファイルをアップロードしたいのですが、 ログイン、およびアップロードができません。 【開発環境】 VB6.0 【コード】 Shell WinscpPath & " " & Servername, vbMaximizedFocus →これだと、WinSCPの起動とサーバーまでの接続しかできていないようです。 ユーザー名、ログインパスワード、コピー元、コピー先を指定する書き方が分かりません。 ■下記のURLのような方法であれば、実行はできました。 http://takuya-1st.hatenablog.jp/entry/20110903/1 … どうぞご教授よろしくお願いします。
複数のURL(webページ)から特定文字が含まれているURLのみを調べる方法について教えてください。 海外サイトの調査候補URLを複数用意し、そのURLのページソースに「news」という特定文字列が含まれているURLを抽出する方法として、エクセルのマクロで以下を試してみました。 ---------- Sub KeyWord_Search() 　Dim objHTTP As Object 　Dim i As Long 　Const strKW As String = "news" 　Set objHTTP = CreateObject("WinHttp.WinHttpRequest.5.1") 　With objHTTP 　　For i = 1 To Range("A1").End(xlDown).Row 　　　.Open "GET", Cells(i, 1).Value, False 　　　.Send 　　　If .Status = 200 Then If InStr(1, .ResponseText, strKW, 1) > 0 Then Cells(i, 2).Value = "＊" 　　Next 　End With 　Set objHTTP = Nothing End Sub ---------- きちんと抽出されるURLもあれば、以下のようなエラーが発生するURLもあります。 ---------- 実行時エラー'-2147023783(80070459)': Unicode 文字のマッピングがターゲットのマルチバイト コード ページにありません。 ---------- 恐らく文字コードの問題だと想像していますが、マクロについて全く知識がないため解決方法がわかりません。なお、上記のマクロはGoogle検索で調べたものをそのままコピー貼り付けしたものです。 また、存在しないURLと「処理がタイムアウト」するURLは処理から除外したいと考えいます。 よろしくお願いします。
Outlook2007 送信前の宛先確認のマクロを設定したいと考えています。 Option Explicit Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean) On Error GoTo Ex ception Dim strCC strCC = vbCrLf Dim objRec As Recipients For Each objRec In Item.Recipients strCC = strCC & objRec.Name & vbCrLf Next Dim strMsg As String strMsg = "件名:" & Item.Subject & vbCrLf & _ _ strCC & vbCrLf & _ _ "上記の宛先に、メールを送信してもよろしいですか?" If MsgBox(strMsg, vbExclamation + vbYesNo + vbDefaultButton2) <> vbYes Then Cancel = True End If On Error GoTo 0 Exit Sub Exception: MsgBox CStr(Err.Number) & ":" & Err.Description, vbOkOnly + vbCritical Cancel = True Exit Sub これだけだと、End subが必要ですというポップアップがあがり、付加すると『型が一致しません』というポップアップがあがってしまいます。 どうすれば良いか教えていただけますか？ あと、宛先をグループ登録してる場合、グループ登録している宛先を氏名で表示する方法はありますでしょうか？？
dir /a-d/s >test.txtで保存したデータから下記の情報だけエクセルに表示するためには どうようなVBを作ればよろしいのでしょうか。 yyyy/mm/dd(A列) hh:mm(B列) ファイルサイズ(C列)　ファイル名(D列) C:\Users\AA\BBB\Local のディレクトリ 2013/04/15 22:08 36 AAAAA.jpg 2013/05/27 23:59 50,849 BBBBB.jpg 2 個のファイル 50,885 バイト C:\Users\AA\BBB\CCCl\DD\EEE\ASD のディレクトリ 2013/04/21 21:46 70,195 123.lst 2013/04/21 21:46 163,659 10.lst 2013/04/21 21:46 123,818 Fnt10.lst 2013/05/27 23:53 3,072 Events 2013/04/21 21:55 75,803 1.bin 5 個のファイル 436,547 バイト
VBScript+WSHを使って、変数に入っているEUC-JP文字列をShift_JIS文字列に変換したいのですが、ウェブで情報を探しても、ファイルを扱う物ばかりです。 Set stream = CreateObject("ADODB.Stream") stream.Charset = "EUC-JP" stream.Open stream.WriteText = eucstring ' この変数にはEUC-JP で文字列が入ってる stream.Position = 0 stream.Charset = "Shift_JIS" WScript.Echo "(" & stream.ReadText & ")" とかやってみましたが、だめです。まさか「いったんファイルに書けば可能だが書かないと不可能」ということもないと思うのですが。。。。。 元のEUC-JP文字列は、xmlHTTPrequestでウェブサイトから得た物なので、その段階でShift_JISに変換する方法があるのならそれでも良いです。 よろしくお願いします。
色々と調べてみたのですが、私の実力では原因も解決策もわからなかったので質問させていただきます。 やりたいこと WindowsNTにて開発していたVB6(SPなし？もしくはSP4くらい。)アプリケーションを、WindowsXPのVB6(SP5)のマシンで開きたい。 現象 WindowsXPで開こうとすると、エラーが表示され、プロジェクトのあるフォルダに以下のログが出力される。 行 195: クラス ○○○○.ExploreBar(コントロール exbWs) はロードされていません。 行 212: クラス ○○○○.FlatButton(コントロール btnClose) はロードされていません。 行 202: プロパティ名 _ExtentX(exbWs) が不正です。 行 203: プロパティ名 _ExtentY(exbWs) が不正です。 行 218: プロパティ名 _ExtentX(btnClose) が不正です。 行 219: プロパティ名 _ExtentY(btnClose) が不正です。 ためしに、Windows2000のVB6(SP5)で開くと、何もエラーが出ることなく、正常に開くことが出来ました。 もう何がなにやら・・・。 調べてみたところ、コントロールの参照が巧くいってないみたいです。 (エラーを出しているfrmファイルを開いて確認しようとすると、エラーになっている箇所がピクチャーボックスになっていた。) そこで、参照設定やコンポーネントの設定を確認してみたのですが、どうもNTとXPでは一致しているみたいです。(同じ場所にチェックが入っている。) もしかして調べる観点からしてズレているのでしょうか。 原因と解決方法をどうか教えていただきたく・・・。 お力添えのほど、よろしくお願いします。<(_ _*)>
　今日は。 　正しい記述を御教授願います。 乏しい知識で御恥ずかしいですが、効率の良いコードをお願いします。 ●環境 　VB6.0 アクセス2000 ●目的 　下記テーブル[Allloto6]はロト６の全組合せで約600万通りあります。 この内、「A」に応じてレコードカウントを取得、変数[WOI(10)]に格納する。 因みに、A=1 は約８５万通り ●不具合 　コードの内「★」の[ FOR I1= 1 TO 10 ]、１０回繰り返すと「応答なし」になります。 [ FOR I1= 1 TO 1 ]のように１回のみなら問題無さそうですが、時間がかかり過ぎます。 ●接続ADO 「Microsoft ActiveX Data Objects 2.x Library」にチェック ●テーブル Allloto6 --------------全て数値 ID A B C D E F 1 1 2 3 4 5 6 2 1 2 3 4 5 7 3 1 2 3 4 5 8 X 38 39 40 41 42 43 -------------------------------- ●コード Public IY1 As String: Public IY2 As String: Public IY0 As String: Public I1 As Integer Public WOI(10) As Double Public DDDD As New ADODB.Connection Public RTR As New ADODB.Recordset Public Sub SY_DT_A() IY0 = "KM6" IY1 = "Allloto6" For I1 = 1 To 10　★ IY2 = "SELECT * FROM " & IY1 & " WHERE A = " & I1 & " ORDER BY ID" DDDD.ConnectionString = "provider=Microsoft.Jet.OLEDB.4.0;DATA SOURCE =E:\U SS VB\IK NY DATA\" & IY0 & ".mdb" DDDD.Open RTR.Open IY2, DDDD, adOpenStatic, adLockOptimistic If RTR.EOF = False Then RTR.MoveLast WOI(I1) = RTR.RecordCount End If RTR.Close: DDDD.Close Next I1 END Sub
エクセルのシート上のフォームで リストのボックスの値を上下キーで値を選択エンターキーで選択した値をシートの指定したセルに入力 フォームを閉じる このようなことをさせたいのですが どのようにすればよいでしょうか よろしくお願いいたします。
はじめまして、プログラミング初心者です。よろしくお願いします。 現在下記のオンラインカジノのアプリケーションソフトの 自動操作が行えるようなソフトの開発を行いたいと思っています。 ・ウィリアムヒルカジノ http://ja.williamhillcasino.com ヨーロピアンルーレット 実現したいのは、 １．ローカルにダウンロードしたカジノソフトでプレイした履歴を自動で取得 ２．自動で取得したプレイ履歴から傾向を解析 ３．解析結果の表示 ４．解析結果の検証用に自動プレイ 現在悩んでいることが ・そもそも、カジノソフトが何の言語？でできているか？ ・自動で履歴を取得することが可能か？（ローカルとカジノ側サーバーの通信履歴の取得？） ・取得・解析・表示・自動プレイを実現する言語は何がよいか？ ・自動プレイは可能か？ と多々あります。 申し訳ありませんが、ぜひ皆さまから御意見いただきたく思い投稿させていただきました。 何とぞよろしくお願いいたします。
これからVisual Studio 2012を導入してVBA（Excel）でやっていたことをVSでやりたいのですが 基本的にVSのVisual Basicの記述方法はVBAと同じなのでしょうか？ 例えばネットのあるサイトをログインして遷移後のhtmlを取得するには、VBAだと以下のように書きます。 Dim objIE As Object Set objIE = CreateObject("InternetExplorer.application") objIE.Visible = True objIE.Navigate "http://xxxxxx/login.aspx" objIE.document.All.txt_userid.Value = xxx 'ユーザー名 objIE.document.All.txt_pass.Value = xxx 'パスワード objIE.document.All.btn_login.Click '送信結果のページ読み込みが終わるまでループ While (objIE.Busy = True Or objIE.ReadyState <> 4) 　DoEvents Wend '表示したページの<BODY>部のHTMLを取得 Dim htmlBody As String htmlBody = objIE.Document.Body.InnerHtml C#で記述しようか、慣れているVBAと似ているVBで書こうか悩んでいます。 どうぞよろしくお願い致します。
A列～BV列までデータがあり、件数は5万件ほどあります。 要所、要所に空白行が入っているのですが、空白行から空白行までを1ブロックとして 計6ブロックできます。 1ブロック、1ブロックは同じ件数になるはずで、 それらを横につなげたいのです。 つなげ方は、上から数えて1番上のブロックはそのまま、2番目のブロックは1番目の横、3番目のブロックは2番目の横、 このような感じでどんどん横につなげて計6づロックあったデータをひとつにしたいのですが、 なにかいい方法ありませんか？ぜひアドバイスお願いします。 言い忘れたのですが、一番上は見出し、そのしたに空白行があります。
Microsoft Excelで作成したデータをJAVAアプリに貼り付ける作業を自動化させたいのですが、どういった手法があるのでしょうか？ JAVAからエクセルを読み込むといった作業は、JAVAアプリをいじれないので出来ません。 私の使ったことのあるものが、ＶＢとＶＢＡのみなので、そのどちらかでできたらいいなと考えています。 些細なことでいいので、心当たりのある方は、教えてください。
下記のコードはC列の日付別、Z列数字の1、をA列のデータ別でBW列カウントするものなのですが、 一つ条件を追加してF列が数字の1～6の場合のA列のデータ別でカウントしたいのです。 F列が数字の1の場合は1のカウントを表示、2の場合は2のカウント表示、それぞれの数字に応じてのカウント回数を出力したいのですが、お詳しい方法を教えてください。よろしくお願いします。 Sub カウント() Dim dic As Object Dim lastRow As Long Dim r As Long Dim key As String Set dic = CreateObject("Scripting.Dictionary") 'Dictionaryオブジェクト lastRow = Range("A" & Rows.Count).End(xlUp).Row 'A列最終行 'データ収集 For r = 2 To lastRow '2行目から最終行まで If (DateValue(Cells(r, "C").Value) >= DateValue("2010/6/01")) And (DateValue(Cells(r, "C").Value) <= DateValue("2010/4/01")) Then key = Range("A" & r).Value & Chr(0) & Range("Z" & r).Value 'キー値はA列注目行の値+Z列注目行の値(間にchr(0)) If Not dic.exists(key) Then 'キー値が無ければ dic.Add key, 1 'キーを追加して、値(個数)を１に Else '既にキー値があれば dic(key) = dic(key) + 1 'そのキーの値(個数)+1 End If End If Next For r = 2 To lastRow '2行目から最終行まで key = Range("A" & r).Value & Chr(0) & "1" '探す値はA列注目行の値+"1"(間にchr(0)) Range("BW" & r).Value = dic(key) 'BW列にその値(個数)を表示 Next End Sub
医療系入院マクロを作っています。下記はUserForm3上のCommandButton2をクリックすると特定の場所にある原本1.xlsmをUserForm3.TextBox13(患者名)にリネームして特定の場所へコピーするマクロです。 Private Sub CommandButton2_Click() Dim cnsSOUR2 As String, cnsORSL As String, cns2FSO2 As String, cns4FSO2 As String cnsORSL = ThisWorkbook.Path & "\..\メンテナンスフォルダ\インストールフォルダ\原本1.xlsm" cnsSOUR2 = ThisWorkbook.Path & "\看護情報フォルダ\" & UserForm3.TextBox13 & ".xlsm" cns2FSO2 = ThisWorkbook.Path & "\..\2Fカーデックス\看護情報フォルダ\" &　UserForm3.TextBox13 & ".xlsm" cns4FSO2 = ThisWorkbook.Path & "\..\4Fカーデックス\看護情報フォルダ\" & UserForm3.TextBox13 & ".xlsm" FileCopy cnsORSL, cnsSOUR2　'　ここでリネーム&移動 End Sub しかし移動先に同名ファイルが存在する場合にエラーが出てしまいます。そこで If Dir(cnsSOUR2) <> "" Then If Dir(cns2FSO2) <> "" Then If Dir(cns4FSO2) <> "" Then などで同名が存在してることが分かった場合、UserForm3.TextBox13(患者名)の語尾に2とつけて、 上記も同名が存在してることが分かった場合、UserForm3.TextBox13(患者名)の語尾に3とつけて… を99まで繰り返したいです。※(転棟の都合により)cnsSOUR2、cns2FSO2、cns4FSO2の複数の場所で同名ファイルチェックが必要になります。 難解のため、断念いたしました。お手数ですが何卒よろしくお願いします。
vb.netでエクセルを操作する プログラムを作ってて、 Dim xlrange As Excel.Range Dim xlcells As Excel.Range xlrange=xlcells(1,1) if xlrange.value<>"*合計*" then xlrange.value="" end if というプログラムを考えたのですが、 うまくいきません。 if文の条件にxlrange.valueは使えるのでしょうか？
以前こちらで教えていただいのですが、 http://oshiete.goo.ne.jp/qa/8086569.html 以下のクエリを実行すると、「Nullの使い方が不正です」とのエラーが出てしまいます。 ------------------------------------ テーブル名「T9」 フィールド：顧客番号（テキスト）/ 売上金額（通貨） / 売上月（テキスト テーブル名「T9A」 フィールド：顧客番号（テキスト）/ 集約先番号（テキスト） ●標準モジュール Public Function Bango(sSrc As String) As String 　　Dim rs As New ADODB.Recordset 　　Dim sR As String 　　sR = sSrc 　　rs.Source = "SELECT * FROM T9A WHERE 顧客番号='" & sSrc & "';" 　　rs.Open , CurrentProject.Connection, adOpenForwardOnly, adLockReadOnly 　　If (Not rs.EOF) Then sR = Bango(rs("集約先番号")) 　　rs.Close 　　Bango = sR End Function ●クエリ SELECT Bango(顧客番号) AS 集約番号, Sum(売上金額) AS 売上金額計, 売上月 FROM T9 GROUP BY Bango(顧客番号), 売上月; ------------------------------------ 当初は、テーブル「T9A」には集約先番号を持つ顧客番号のみにするはずでしたが、 便宜上、集約先番号の有無にかかわらず、すべての顧客番号が入ったテーブルを使います。 そのため、「T9A」の集約先番号にはNullがあり、 Nullに対しては、同行の顧客番号を返すように対応したいです。 If IsNull(集約先番号) Then・・・とやるのかな？と浮かびましたが、うまくいかず、困っております。 何卒ご指南くださいますよう、お願いいたいます。
10年，15年前をピークにVBの本が書店から消えていき，今では全くない本屋もあります。（VBforEXCEL関係はありますけど） 今VB6で作ったソフトをVB2010で作り直している所ですが，中々VB6時代ほど本の種類がありません。 どうしてはやらなくなってきたのでしょうか。 後，2010で作りかけですけど2012をインストールして2012でプログラミングしようとも思うのですが，VB2012も種類がいっぱいあって良く分かりません。 どれをインストールすれば良いですか。
visual studio express 2012 for windows Desktopでpostgres8.3にＩＯするプログラムを作りたいのですが、 そのインターフェイス部分のコードやサンプルを掲載しているＷＥＢサイトを紹介して頂けませんか。 直接回答して頂く事も歓迎します。 追加モジュールをどこかで入手しないといけないとか、事前の必要事項も知りたいです。
ネットワーク上にある共有フォルダーを開く為のマクロをご教授ください。 ファイルまでは開きません。 SHELL関数を用いてチャレンジしたのですが、マイドキュメントを開いてしまいます。 お手数ですが、皆様よろしくお願いいたします。
下記のコードの日付の2011の箇所を2010/6/01～2012/4/01といったように月単位での条件にしたいのですが どこをどうやって変えればいいですか？お詳しい方よろしくお願いします。 Sub カウント2012() Dim dic As Object Dim lastRow As Long Dim r As Long Dim key As String Set dic = CreateObject("Scripting.Dictionary") lastRow = Range("A" & Rows.Count).End(xlUp).Row For r = 2 To lastRow If Year(Cells(r, "C").Value) = 2011 Then key = Range("A" & r).Value & Chr(0) & Range("W" & r).Value If Not dic.exists(key) Then 'キー値が無ければ dic.Add key, 1 'キーを追加して、値(個数)を１に Else '既にキー値があれば dic(key) = dic(key) + 1 'そのキーの値(個数)+1 End If End If '★追加 Next '表示 For r = 2 To lastRow key = Range("A" & r).Value & Chr(0) & "1" '探す値はA列注目行の値+"1"(間にchr(0)) Range("FV" & r).Value = dic(key) Next End Sub
VB.netについての質問です。 フォームにテキストボックスとコンボボックスとボタンが取り付けられている状態で、ボタンを押すとテキストボックスとコンボボックスのデータを、指定したフォルダにテキストファイルで保存させる、というプログラムは可能でしょうか？ 保存形式はテキストファイル以外でも構いません。 よろしくお願いします。
環境はVB2012です。 　　N個の値を持った変数をN個のラベルに表示したいのですが、今のところ Select Case を使用してずらずらと列記しています。とても面倒くさいし可読性も悪いし、ミスもよく起こすので、内容を変更するラベルの指定を変数でできない物かと思いました。 　　以下のコードの場合、child0.Text、child１.Textというように名前+No.という構成になっています。最終的にはchild(i).Textといったように数値変数で直接指定できればと思います。 過去にはコントロール配列などがあるようでしたが、このバージョンでは今ひとつ分かりません。 Dim child_string(N) As String Dim cnt_1 As Integer Dim cnt_2 As Integer Dim fitness(N) As Integer For cnt_1 = 0 To 9 Select Case cnt_1 Case 0 Me.child0.Text = child_string(cnt_1) Me.fitness0.Text = fitness(cnt_1) Case 1 Me.child1.Text = child_string(cnt_1) Me.fitness1.Text = fitness(cnt_1) Case 2 Me.child2.Text = child_string(cnt_1) Me.fitness2.Text = fitness(cnt_1) ’##################################### 　同様の物が100個とか200個とかずらずら並ぶ。 　　　　下ではその数をNとする。 ’##################################### Case N Me.childN.Text = child_string(cnt_1) Me.fitnessN.Text = fitness(cnt_1) End Select Next cnt_1
現在、VB.netを勉強中です。 コンボボックス内に今日から一週間分の日付を表示したいのですが、上手く行きません。 Dim dtToday As DateTime = DateTime.Today ComboBox1.Items.Add(dtToday.ToString()) と書いたところ現在の日付を取得しコンボボックス内に 2013/5/28 00:00　と表示されています。 これを時刻を表示させず（2013/5/28　のみ表示）、For文を用いて一週間分表示させたのですが、どのようにすればよいでしょうか？ 分かる方がいれば、よろしくお願いします。
VBSかVBAでIE操作をする場合、どちらの方が向いてるのでしょうか？ 現在VBAでie操作をしていますが、 この記事 http://oshiete.goo.ne.jp/qa/7903584.html を見ると、VBAからVBSに書き換えたほうがいいのかな？ なんて思ってきました。 IE操作においてVBAより」VBSの方ができることが多いか教えてください。
こんにちは。ADOについてお教えください。 フォームをロード時に接続プロシージャと切断プロシージャを走らせたいと思います。 ConnectDatabaseを呼び出しは成功しますが、CloseDatabase呼び出しには失敗します。 スコープの問題で、rs、cnのオブジェクトが無い為だと思います。 ConnectDatabaseで作成されたcn、rsオブジェクトを別の関数で処理するにはどのようにコードをかけばよろしいでしょうか？宜しくお願い致します。 Private Sub Form_Load() Call ConnectDatabase Call CloseDatabase End Sub Module1 ------------------ sub ConnectDatabase() Dim cn As ADODB.Connection Dim rs As ADODB.Recordset Set cn = New ADODB.Connection Set rs = New ADODB.Recordset 処理～～～～ end sub sub CloseDatabase() rs.Close cn.Close Set rs = Nothing Set cn = Nothing end sub
VBAのマクロについての質問です セルA1：タイトル1 セルA2：タイトル2 セルA3：タイトル3 上記のように各セルに文字を入力しボタンを押下します。 そうすると、事前に用意してある別のExcelファイルを（雛形.xlsとします） タイトル1.xls タイトル2.xls タイトル3.xls のような名前で入力した分だけExcelファイルを複数作成できるようにしたいのですが、 方法がよくわかりません。
エクセル2007を使用してします。 ある報告書の全シートを対象として　A1セルにｋさんの名前が入力されたらそのシートのシート見出しが緑になり、A2セルにｍさんの名前が入力されたらそのシートのシート見出しが青になり、なおかつ、ｋさんとｍさん２人の名前が入力されたらそのシート見出しの色が黄色に自動でなるマクロの記述を教えてください。よろしくお願いします。
私はプログラミングはさわり程度しか知らない初心者なのですが、この度大学の授業で商品の受注システムを作ることになりました。 楽天みたいに顧客が注文を入力するのではなく、電話注文を受けたスタッフが帳票出力に使用するシステムです。 そこで、顧客の電話番号・住所をデータベース化して検索・追加できるようにしたいと思っているのですが、この場合プログラミング言語はVBとVBAどちらの方が適切でしょうか。 ・テキストボックスに電話番号を入力し、2回目以降の注文であれば住所のテキストボックスに以前登録された住所を反映する。 ・初めてならば手動で住所を入力してデータベースに追加 と言った単純なものを考えているのですが・・・。 よろしくお願いします。
お世話になります。 セル書式の折り返し・縮小・結合を使用しないで、 列の幅に収まらない文字列を下の行のセルへ表示させる方法を模索しています。 Application.DisplayAlerts = False Range("A1").Justify で出来るらしいと書物を頼りに実施していますが、下の行のセルへ表示出来ません。 他の方法も含めて、実現方法はあるでしょうか？ よろしくお願いします。
VBAの分岐処理で悩んでおります。 誰かお助けお願いします。 A列に昇順で番号があります。 1 2 4 4 5 6 9 欠番や重複した数値があります。 やりたいことは欠番箇所に行を挿入し、連番にしたいです。 この例で言うと、3行目に1行を挿入し番号を3と入れる、6行目に2行挿入し7,8と連番にする。 連番になった後に、重複した数値に色を付けます。 以下私が作成したコードです。callで呼び出す予定です。 Sub 欠番判定数式() Dim i As Integer For i = 2 To Cells(Rows.Count, 1).End(xlUp).Row Cells(i, 3) = "=if(iserror(if(A" & i & "-A" & i - 1 & ">1,""○"","" "")),"""",if(A" & i & "-A" & i - 1 & ">1,""○"","" ""))" Next End Sub Sub 行挿入() Dim c As Range, Target As Range For Each c In Range("C2:C" & Cells(Rows.Count, 1).End(xlUp).Row) If c = "○" Then If Target Is Nothing Then ''(1) Set Target = c Else Set Target = Union(Target, c) ''(2) End If End If Next c If Not Target Is Nothing Then Target.Select Selection.EntireRow.Insert , copyorigin:=xlFormatFromLeftOrAbove End Sub Sub 空白連番入力() Dim i As Integer For i = 2 To Cells(Rows.Count, 1).End(xlUp).Row If Cells(i, 1) = "" Then Cells(i, 1) = (Cells(i, 1).Offset(1, 0).Value) - 1 End If Next End Sub Sub 番号重複確認() Dim i As Integer For i = 2 To Cells(Rows.Count, 1).End(xlUp).Row If Application.WorksheetFunction.CountIf(Range("$A$2:$A$" & Cells(Rows.Count, 1).End(xlUp).Row), Range("A" & i)) <> 1 Then Cells(i, 1).Interior.ColorIndex = 3 End If Next End Sub このコードを順に全て実行した時、1回目の処理で3行目と5行目に行挿入、そして番号が3と7と入力され連番に色が設定されます。 再度「欠番判定数式」を行い、次は8行目に行挿入し8と連番を入力させ処理を繰り返しさせたいです。 欠番は例として最高2個にしてますが、これから2個以上の可能性もあります。 一度全処理終了後、再度最初の処理（欠番判定数式）に戻り、欠番がある場合は行挿入させという処理を行わせ、欠番がない場合は次の処理に進めるという分岐方法を教えてほしいです。 よろしくお願いいたします
vbsでループさせる http://nagabuchi.jugem.jp/?eid=237 で作ったバッチで常駐ソフト（自分はSkydriveとかのクラウドサービス）の起動を遅らせる事ができるようになり、めでたしめでたしなんですが、 セキュリティソフト（KasperskyInternetSecurity2013）より先に常駐ソフトが立がるのは問題だろうと思い、 上記URLで作成する.vbsを改良しようと思いました。 http://q.hatena.ne.jp/1203153427 を参考に以下に示すような感じに変更してみたものの、CreateObjectの行がうまくいきません。 KasperskyInternetSecurity2013 （実行ファイルはC:\Program Files (x86)\Kaspersky Lab\Kaspersky Internet Security 2013にあるavp.exe） が起動した後にstartup.batを起動するにはどうすればいいでしょうか？ wait9s.batの中身 ping -n 9 127.0.0.1 > nul 問題の.vbsファイル Sub StartAfterKaspersky() Const program_name = "avp.exe" Dim x For x = 1 To 10 If processCheck(program_name) = Ture Then CreateObject("WScript.Shell")ws.run "cmd /c startup.bat",vbhide Else CreateObject("WScript.Shell")ws.run "cmd /c wait9s.bat",vbhide End If Next MsgBox "27秒も待ったのに、Kasperskyが起動しません。強制起動します。" CreateObject("WScript.Shell").Run program_name End Sub '//------------------------------------------------ ' プロセスが動いているかチェックする関数 '//------------------------------------------------ Function processCheck( pName ) '//------------------------------------------------ processCheck = False Dim objPWMI On Error Resume Next Set objPWMI = GetObject("winmgmts:{impersonationLevel=impersonate}!\\localhost\root\cimv2") Err.Clear On Error GoTo 0 If Err.Number <> 0 Then Exit Function '接続できなかったら、終了 Dim colProc Set colProc = objPWMI.ExecQuery("Select * from Win32_Process WHERE Name='" & pName & "'") If colProc.Count > 0 Then processCheck = True End Function
Private Sub TextBox1_TextChanged(sender As System.Object, e As System.EventArgs) Handles TextBox1.TextChangedのイベントプロシージャ内で、何のキーを押して、TextChangedのイベントが起きたか知りたいのですが、どうすればよいでしょうか？実はBackSpaceが押されたのかどうかを知りたいのです。よろしくお願いいたします。
今、VBAを勉強中です！ 例えばA列に1000件のヤフーオークション出品物のURLがあります。 そのURLからソースを読み込み、B列に“現在価格”のみを表示させる場合はどのようにすれば良いでしょうか？ ヤフーオークションのソースを見ると下記のようになっています。 --------------------------------------- <tr> <th>現在の価格<br><img src="http://i.yimg.jp/images/space.gif" width="150" height="1" alt=""></th> <td class="decClnTxt">：</td> <td ><p property="auction:Price">●●●●円</p> --------------------------------------- “●●●●円”の部分を“B列”に表記させれるようにしたいです。 お詳しい方、ご教授頂ければ大変助かります。何卒よろしくお願い致しますm(__)m
エクセル2007を使用しております。 A1のセルに入力できる文字数を10文字に制限し、11文字目はD1のセルに出力 そしてD1のセルも入力文字数を10文字に制限し、D1セルの11文字目以降はH1のセルに出力… というコードを、どなたか教えていただけないでしょうか。 勉強不足で申し訳ありませんが、近しいサイトは見つけたのですが、マッチする内容の検索がしきれず、急を要するためお力を貸していただけましたら幸いです。 どうぞよろしくお願いいたします。
VB2010でプログラム開発を行っています。 VB2010は初心者で、インターネットを使って調べながら構築していますので、ほとんど意味を理解していない状態です。 この度下記の文を書いたのですが、Point1で「Cmd.Dispose() 」を入れないとPoint2で「OleDbException が発生しました　エラーを特定できません」のエラーになってしまいます。 そこで2つの疑問が出てきたので教えていただけないでしょうか。 疑問１： なぜ、Point1でDisposeしないとエラーになってしまうのか。 疑問2： Point1でDisposeすると、内容が破棄されると思っていたのですが、そのまま処理が進むようです。 なぜ、再度「Dim Cmd As New OleDbCommand」の宣言が必要無く、トランザクションも続いているのでしょうか。 また、よりスマートな書き方があればご教授いただけるとありがたいです。 よろしくお願いします。 Module Module1 　　Public Con As New OleDbConnection 　　Public Cmd As New OleDbCommand 　　Public bTrans As OleDb.OleDbTransaction 　　Public sb As New System.Text.StringBuilder() End Module Private Sub Btn_Kanryo_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Btn_Kanryo.Click 　　Dim ExResult AS Integer 　　　　　　　'新規トランザクションの開始。 　　　　　　　bTrans = Con.BeginTransaction 　　　　　　　'コマンドオブジェクトにトランザクション関連付け 　　　　　　　Cmd.Transaction = bTrans 　　　　　　　'DB更新１ 　　　　　　　sb = New System.Text.StringBuilder 　　　　　　　sb.AppendLine("UPDATE A ") 　　　　　　　sb.AppendLine("SET") 　　　　　　　sb.AppendLine(" A_AA = '1'") 　　　　　　　sb.AppendLine(" WHERE") 　　　　　　　sb.AppendLine(" A_BB='123'") 　　　　　　　Cmd.Connection = Con 　　　　　　　Cmd.CommandText = sb.ToString 　　　　　　　ExResult = Cmd.ExecuteNonQuery() 　　　　　　　'ストアドプロシージャ―処理 　　　　　　　Cmd.Connection = Con 　　　　　　　Cmd.CommandType = CommandType.StoredProcedure 　　　　　　　Cmd.CommandText = "AAA.ABC" 　　　　　　　Dim outPara As New OleDbParameter("ERR_FLG", OleDbType.Decimal) 　　　　　　　outPara.Direction = ParameterDirection.Output 　　　　　　　Cmd.Parameters.Add(outPara) 　　　　　　　Cmd.ExecuteNonQuery() Point1⇒　Cmd.Dispose() 　　　　　　　'DB更新２ 　　　　　　　sb = New System.Text.StringBuilder 　　　　　　　sb.AppendLine("DELETE ") 　　　　　　　sb.AppendLine(" B") 　　　　　　　sb.AppendLine(" WHERE ") 　　　　　　　sb.AppendLine(" B_AA='1'") 　　　　　　　Cmd.Connection = Con 　　　　　　　Cmd.CommandText = sb.ToString Point2⇒　ExResult = Cmd.ExecuteNonQuery() 　　　　　　　bTrans.Commit() End Sub
VBAにてHPの情報を「With ActiveSheet.QueryTables.Add」で取り込むツールを作成しました。 これまで問題なく利用していたのですが、新しいHPはリンク先をクリックすると、同じURLなのに、ちがう項目が出現する仕組みのため戸惑ってます。 その部分のソースは以下の通りです。 <li><a href="javascript:void(0);" onClick="pagerForm(80,5,null,null)">&lt;前へ</a></li> 上記の対象のリンク先をクリックすると項番80から5つのデータが出現する動きをします。 VBAにて、対象のjavascriptを起動して、同様のページを生成する方法はありますでしょうか？ よろしくお願いします。 ExcelVBA（Microsoft Visual Basic for Applications7.0)
皆様こんにちわ 　マウスでセル選択した特定行のみ、セル内容を変更したいのです。 　下記コードでは、右クリックを使用した例です。 　これですと、Ｂ３：Ｇ３、Ｂ６：Ｇ６だけではなく、選択している範囲に含まれていたら全て変更されちゃいます。 　Ｂ３：Ｇ３、Ｂ６：Ｇ６のみ変更するには、どの様にすればよいのでしょうか？ また、右クリック以外に良い方法はありますでしょうか？ Private Sub Worksheet_BeforeRightClick(ByVal Animal As Range, Cancel As Boolean) If Intersect(Animal, Range("B3:G3,B6:G6")) Is Nothing Then Exit Sub For Each Animal In Selection If Animal.Value = "にゃん" Then Animal.Value = "わん" Else Animal.Value = "にゃん" End If Next Animal End Sub 稚拙な事ですみませんが、皆様宜しくご教示願います。
ＥｘｃｅｌでのVBAの質問となります。どなたか親切な方プログラムの書き方作り方について優秀な知恵をお貸しくださいよろしくおねがいします。 質問内容は詳細を見てください 画像も備えさせていただきましたが分かりにくいと思うのですが、赤で囲んだエクセルのセル内容をメモ帳で書き込み後改行する(クリップボードを使用)を作成するにあたりマクロを作りたいと思うのですが。どんな感じでVBAプログラムを作成すればいいのか教えてください。できれば詳しい例題(参照)を書いていただけると有難いです。 バッチファイルも作りたいのですがもしバッチファイルでも作成できる場合はバッチファイル用例題とVBA例題の両方をこんな感じって具合にプログラムの組み方を詳しく教えて頂きたいです。 優秀な知恵の持ち主様どうかよろしくお願いします 補足 正確には(1)の画像の前に手順があるのてせすが以下省略してあるため分かりにくかったと思わりるため補足します。 本来はオートフィル機能で検索した結果を(1)画像の赤□内に抽出(書き込み)した後にメモ帳に追加してけるようにマクロをつくるとゆうもののプログラムを作成するつもりだったため。 オートフィル機能で検索した結果を(1)画像の赤□内に抽出(書き込み)のマクロをすでに作成できたけれど次の段階のプログラムが作れなかったためぜひ知識が詳しい方回答よろしくお願いします。 もしできない場合はテキストBOXなどつくろうと思うのですが、作り方がよくわからないため詳しい説明を書いていただけると有難いです。 図書館等を使ったりくぐったりしていますが、独学では分かり兼ねるところがあったため知恵がある方に質問しました。
vb6.0でのGetPrivateProfileStringによるINIファイルの読み込みで返り値がおかしくなります。 [Section1] S00LIST00=アナログ汎用,analogdata.ini S00LIST01=デジタル汎用,digitaldata.ini と２つキーが書いてあるのですが、 GetPrivateProfileStringの戻り値で、 S００LIST00が、 　戻り値：27 　読み込み値：「アナログ汎用,analogdata.ini 」 　※「」の記号は、文字列がどこからどこまでかをわかりやすくするため 　　記載したもので、読み込まれたものではありません。 正しく、期待している値は、 　戻り値：21 　読み込み値：「アナログ汎用,analogdata.ini 」 です。 S００LIST01が、（正しくは、） 　戻り値：28 　読み込み値：「デジタル汎用,digitaldata.ini 」 正しく、期待している値は、 　戻り値：22 　読み込み値：「デジタル汎用,digitaldata.ini」 です。 となります。 .ｉｎｉのあとは、vbNullChar+スペース（読み込みバッファとしてSpace(512)で取得） になっているようです。 上記の違いってなぜなんでしょうか。
VBA初心者です。 色々検索してもどれを使えば良いか分かりません。宜しくお願い致します。 シート１に他シート（約100枚）選択範囲（”A3：D4”，"E3：K12")のデータ（A3：D4には顧客名、E3：K12には契約内容。契約内容は9行ありますが空白もあり、月によって入力されている値が変化します。3行になったり7行になったりと。9行は固定で範囲内で行数が変化します。 シート１に全ての顧客名と契約内容を一覧で表示させる方法を教えて頂きたいです。 どうか宜しくお願い致します。 尚、シート1には他のコードも記入されております。そのコードの下に直接書いても大丈夫なのでしょうか？
昨日ＶＢＡの事で質問し回答を頂いたのですが追加で質問があります。ベストアンサーを選ぶと質問は締め切られる事を知らずにお礼をしたら終わってしまっていました。どなたか宜しくお願い致します。 最初の質問は 表を作りたいのですが、 顧客名のシートを１００枚ほど作り、シート１（シート１は検索シートにしたいので顧客名は無）のA1にクライアント名を入力したら入力した顧客名シートが出てくる様にしたいです。 以上が最初の質問です。 以下の書式がベストアンサーに選らばせて頂いた方の回答です。 これで動くようになったのですが、 追加で シートのC1に顧客のＩＤ数字が7ケタあるのですが、顧客名シート検索かＩＤ検索どちらかで一方入力した場合のコードとかは教えて頂いたコードに足せば可能ですか？ というのが質問です。 宜しくお願い致します。 Private Sub Worksheet_Change(ByVal Target As Range) Dim k As Long, str As String, myFlg As Boolean str = Range("A1") For k = 1 To Worksheets.Count If Worksheets(k).Name = str Then myFlg = True Exit For End If Next k If myFlg = True Then Worksheets(str).Activate Else MsgBox "該当シートなし" End If End Sub
2の　Double型と　３の Single型のように送る側と受け取る側の変数の型が 違ってもよいのでしょうか？プログラムはそのまま実行できたのですが・・・・。 Public Class Form1 Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click Dim koku As Integer Dim san As Integer Dim rika As Integer Dim ave As Double------------------------------------1 koku = Val(TextBox1.Text) san = Val(TextBox2.Text) rika = Val(TextBox3.Text) ave = (koku + san + rika) / 3 Label5.Text = Round(ave)-------------------------------2 End Sub Private Function Round(ByVal sngvalue As Single-----3) As Integer Dim intvalue As Integer intvalue = Int(sngvalue + 0.5) Return intvalue End Function End Class
VBA初心者です。始めてから２，３週間です。 表を作りたいのですが、 顧客名のシートを１００枚ほど作り、シート１（シート１は検索シートにしたいので顧客名は無）のA1にクライアント名を入力したら入力した顧客名シートが出てくる様にしたいです。 参考書、ネット等をみて作成しましたがエラーが出ます。作動するにはどの様にしたら宜しいでしょうか？どうかお助け下さい。宜しくお願い致します。コードは下記です。 Private Sub Worksheet_Change(ByVal Target As Range) Dim i As Integer Dim myWSname As String, myworksheet As Worksheet myWSname = "i" myWSname = Worksheets("sheet2").Range("A1").Value For Each myworksheet In Worksheets If myworksheet.Name = mayWSname Then Worksheets("myWSname").Activate Exit Sub End If Next myworksheet End Sub
私は「緑のパスワードがなくnanacoをお持ちの方」です。 カード記載の番号にはvbaで値を入れることはできるのですが、 nanaco番号に値を入れることとログインボタンを押すことができません。 ********************************************** Sub nanaco() Dim objIE As InternetExplorer Dim myObj As Object Set objIE = CreateObject("InternetExplorer.Application") objIE.Visible = True objIE.navigate "https://www.nanaco-net.jp/pc/emServlet" Do While objIE.Busy = True DoEvents Loop Do While objIE.document.readyState <> "complete" DoEvents Loop objIE.document.all("XCID").Value = "12345" objIE.document.all("SECURITY_CD").Value = "Password" For Each myObj In objIE.document.forms(0).all If TypeName(myObj) = "HTMLInputElement" Then If myObj.alt = "ログイン" Then myObj.Click Exit For End If End If Next Set objIE = Nothing End Sub ********************************************** これだとまずall("XCID").Value でエラーになります。 ソースでは、 <input name="XCID" tabIndex="1" class="txtBoxLogin" accessKey="1" type="text" maxLength="16" value=""/> となっておりますが、同じコードが二つあるからエラーになるのでしょうか？ all("SECURITY_CD").Value は問題なくできます。 ソースにも、SECURITY_CDは一つしかないです。 次にログインボタンも二つあるのですが、 For Each myObj In objIE.document.forms(0).all If TypeName(myObj) = "HTMLInputElement" Then If myObj.alt = "ログイン" Then myObj.Click Exit For End If End If Next このコードを実行すると、多分上の方のログインボタンが押されてるようです。 なので、 Dim 二つ目 As Boolean For Each myObj In objIE.document.forms(0).all If TypeName(myObj) = "HTMLInputElement" Then If myObj.alt = "ログイン" Then If 二つ目 = True Then myObj.Click Exit For End If 二つ目 = True End If End If Next に変更してみたのですが、 どうやら If myObj.alt = "ログイン" Then になるのは、1回しかないようです。 うーん、うまくできません。 ご教授よろしくお願いします。
　VBを記述した親ワークブックから子ワークブックを作成したいのですが、下記コードでは次の障害があるのです。 １．２００３バージョンでは開けない。 ２．２００７バージョンで開こうとすると、メッセージが出る。 　　「～ファイル拡張子が示す形式と異なります。～」 ３．不要なワークシートが残る。 　　“基本設定／新しいブックの作成／ブックのシート数”に依存している。 【シートを１枚だけにし、２００３バージョンで保存したいのです。】 ShName = ThisWorkbook.ActiveSheet.Name Set objWorkBook = Workbooks.Add objWorkBook.ActiveSheet.Name = "○○商事" Call 処理 Set WSH = CreateObject("Wscript.Shell") Path = WSH.SpecialFolders("Desktop") & "\" On Error Resume Next　'上書き保存をキャンセルした時の取り合えずの回避策（宿題(^^;)） ActiveWorkbook.SaveAs Path & "○○系_" & ShName & ".xls" Set WSH = Nothing Set objWorkBook = Nothing 　新しいブックを作成後、シート数を数えて２枚目以降を消すのも出来るかと思いますが、作成時には既に１枚、しかも２００３バージョンで作成する事は可能なのでしょうか？ 　皆様、よろしく御教示下さいませ・・・。
VBAの初心者ですが、データの抽出をしたいと考えています。 フォルダの中に、複数のテキストファイル形式のデータがあり、 その中にあるファイル毎の一部データのみ抽出できないかと考えております。 元データ(1)（テキストファイル形式） 10行目にあるデータ A TOKYO 20行目にあるデータ 100 200 1000 2000 （データの間には、スペースがあります。） 元データ(2)（テキストファイル形式） 10行目にあるデータ B Fukuoka 20行目にあるデータ 300 400 3000 4000 （データの間には、スペースがあります。） 編集後のデータは、それぞれのテキストデータ ・10行目データの2番目の抽出 ・20行目データの2番目の抽出 ・20行目データの4番目の抽出 を抽出できないかと考えています。 編集後データ（エクセルファイル形式に出力）は、下記のような感じできないかと考えてます。 　　　　(A列) (B列) （1行目)TOKYO Fukuoka （2行目)200 400 （3行目)2000 4000 皆さんからのご回答、 よろしくお願いいたします。
　特定のマクロの前後でWorkSheet_Changeを終了し再開させる方法がありましたらお願い致します。 Windows7 SP1 Office2010 Private Sub WorkSheet_Change(ByVal Target As Range) Dim c As Range For Each c In Target Select Case c.address(0, 0) Case "C1" If Intersect(Target, Range("C1")) Is Nothing Then Exit Sub '検査範囲 Application.EnableEvents = False '再帰実行の停止 If Range("C1").Value <> Sheets("祝祭日").Range("A1").Value Then MsgBox ("祝日の設定を反映するため年度を同じにしてください。") End If Application.EnableEvents = True Case Else Select Case c.address(0, 0) Case "G1" If Range("G1") = 4 Then '4月データの表示 Dim ret As Integer ret = MsgBox(Format(ActiveSheet.Range("G5").Value, "ge年mm月") & "の勤務割表の編集＆入力保存データを元に表示します。" & vbCrLf & "よろしいですか?", _ vbOKCancel + vbQuestion, "勤務割表表示切替確認") Select Case ret Case vbOK UserForm8.Show vbModeless UserForm8.Repaint 当月データのクリア メインデータの復元4月 編集データの復元4月 Sheets("メイン・1").Select Unload UserForm8 Sheets("メイン・1").Range("G1").Select ActiveCell.FormulaR1C1 = "4" ※ ここで終了ないし一時停止 図形の貼付け ※ここで再開させたいのですが? Case vbOKCancel Exit Sub End Select ElseIf Range("G1") = 5 Then '5月データの表示 ret = MsgBox(Format(ActiveSheet.Range("G5").Value, "ge年mm月") & "の勤務割表の編集＆入力保存データを元に表示します。" & vbCrLf & "よろしいですか?", _ vbOKCancel + vbQuestion, "勤務割表表示切替確認") Select Case ret Case vbOK UserForm8.Show vbModeless UserForm8.Repaint 当月データのクリア メインデータの復元5月 編集データの復元5月 Sheets("メイン・1").Select Unload UserForm8 図形の貼付け Case vbOKCancel Exit Sub End Select End If End Select End Select Next End Sub
VisualStudio2012でｘ64プラットフォームで作成したユーザーコントロールを、ツールボックスに「アイテムの選択」で追加できませんでした。 AnyCpuまたはx86プラットフォームでビルドした、ライブラリはツールボックスに「アイテムの選択」で追加することができました。 どうしたらｘ64プラットフォームで作成したユーザーコントロールを追加できるようになりますか？ すべてのプログラムをｘ64プラットフォームで開発したいと考えています。どなたかお知恵をお貸しください。
エクセル２００７で、表(1)のようなレコードがあります。 Ｂ列とＣ列の両列をキー列として、両列が次の行と同じ場合、表(2)のように一行にまとめるＶＢＡを、どなたかご教示お願いします。 過去ログ等で重複データの行削除は理解できたのですが、キー列が２列の場合や、表(2)のように右の列にデータをどんどん増やす方法がわかりません。 条件は、レコードは1０００行以上、市idと社idは昇順に並んでいるため重複データは必ず上下に連続している、商品の種類は５０以上あり、どれ位右に列が増えるか不明、などです。 ＶＢＡ初心者です。よろしくお願いします。 表(1)（sheet1） 県名｜市id ｜ 社id｜社名｜商品｜空白｜空白・・ 秋田｜0001｜0001｜Ａ株｜青大｜空白 秋田｜0001｜0001｜Ａ株｜赤小｜空白 東京｜0002｜0003｜Ｂ株｜黒中｜空白 大阪｜0004｜0001｜Ｃ有｜赤中｜空白 大阪｜0004｜0001｜Ｃ有｜白大｜空白 大阪｜0004｜0002｜Ｄ株｜赤大｜空白 大阪｜0004｜0002｜Ｄ株｜黄中｜空白 大阪｜0004｜0002｜Ｄ株｜緑小｜空白 ・ ・ 表(2)（sheet2） 県名｜市id｜ 社id｜社名｜商品｜商品｜商品・・ 秋田｜0001｜0001｜Ａ株｜青大｜赤小｜空白 東京｜0002｜0003｜Ｂ株｜黒中｜空白｜空白 大阪｜0004｜0001｜Ｃ有｜赤中｜白大｜空白 大阪｜0004｜0002｜Ｄ株｜赤大｜黄中｜緑小 ・ ・
エクセルVBAの勉強を始めたばかりのものです。無知を自覚しながら質問させていただきます。 宜しくお願い致します。 下のようにエクセルの表があります。 B列の中から例えば５月１３日が今日だとして本日の日付のものを探し、見つけたらその隣の列の A列の通番を参照しピックアップしたら、別のシートに作ってある番号ばかりのシート表の中のその通番のセルを塗りつぶすという一連の作業のVBAを作りたいのですがどうしたらいいのでしょうか？ 問題の説明不足で意味が通じるかが心配なのですが、本日の日付をB列から見つけてその通番 をピックアップするVBAを教えて頂けたらとおもい、質問しました。 ちなみに日付は5/13の形式で入力しています。 AB 15月13日 2 3 4 55月13日 6 6
excel2007でマクロ作成中の初心者です。 困ってます助けてください。 現在、Sheets("合計表")というシートがアクティブになっています。 そして、 Private Sub CommandButton4_Click() Sheets("単価表").Select End Sub のコードを実行すると、Sheets("単価表")というシートがアクティブになります。 ところが、これに　MsgBoxをつけると -------------------------------------- Private Sub CommandButton4_Click() Sheets("単価表").Select Dim myBtn As Integer Dim myMsg As String, myTitle As String myMsg = "単価表を編集しますか？" myTitle = "単価表の確認" myBtn = MsgBox(myMsg, vbYesNo + vbExclamation, myTitle) If myBtn = vbYes Then ’ 単価表の編集 Sheets("単価表").Select End If End Sub --------------------------------- Sheets("合計表")というシートが表示されたままで、メッセジボタンが表示され、Sheets("単価表")に変更されません。 そして、Ｎｏボタンを押すと、はじめて、Sheets("単価表").が表示されます。 そこで、最初に　Sheets("単価表")が表示されてから、Msgボタンが表示されるように したいのです。どうコードをかえたらいいでしょうか。
支店毎に売上集計を行うVBAを現在作成中です。 sheet3に支店名をリストにしており、ユーザーフォームのテキストボックスとコマンドボックスを配置し、テキストボックスに支店名を入力してコマンドボックスを押す事でsheet1の決まったセルに商品毎の金額の合算が出る様にしたいと考えています。 金額の集計表は別にあり、列の一番目に支店名、2番目に商品名、3番目に取引内容が反映されております。 今回ご相談させて頂きたいのは、ユーザーフォームのコマンドでどの様に入力したら良いかという事です。下記にユーザーフォームで現在までに入力した内容を記載します。 Sub 売上集計() If ActiveSheet.AutoFilterMode Then ActiveSheet.AutoFilterMode = False End If Dim Result As Long For i = 1 To 100 GroupName = Sheets(3).Cells(i, 1).Value Range("A1").AutoFilter field:=1, Criteria1:=Array("" & GroupName & ""), Operator:=xlFilterValues Range("A1").AutoFilter field:=2, Criteria1:=Array("商品名A"), Operator:=xlFilterValues　 　　Range("A1").AutoFilter field:=3, Criteria1:=Array("売上", "返品"), Operator:=xlFilterValues result1 = WorksheetFunction.Subtotal(9, Range("BF:BF")) If ActiveSheet.AutoFilterMode Then ActiveSheet.AutoFilterMode = False End If End Sub 上記希望内容についてユーザーフォームのコマンドに入力すべき内容をご存知の方、何卒ご教示願います。
VBScriptでコードを作成しています。 ある時、日付を自動判定する方法で、JavaScriptのDate.parseが便利だと知りました。 （文章の中に、JanuaryとかFebとかの表現を含んでいますので。。。） VBScriptでコードで、Date.parseの様な判定をするには、どうすれば良いのでしょうか？ お教えください。
以下のようなマクロを作りましたが、帳票を印刷すると１枚印刷されます。 ですが、この帳票がA５サイズの決まりがあり、かつプリンタがA4しか用紙を入れることができないので、 そのため、一度にA5サイズの帳票を２枚合わせた形で印刷をさせたいと考えています。 A４用紙に左側（名簿の１番目）右側（名簿の２番目） 次も、名簿の３番目・４番目と連続印刷をしたいのですが、どのようにすれば良いのでしょうか。 勉強不足で申し訳ございませんが、ご指南くださいますようお願いいたします。 Sub 帳票印刷() Dim LastRow As Long Dim i As Long Dim myNo As Variant With Worksheets("名簿") LastRow = .Cells(Application.Rows.Count, "A").End(xlUp).Row For i = 2 To LastRow myNo = .Range("A" & i).Value With Worksheets("印刷用") .Range("C4").Value = myNo .PrintPreview .PrintOut Copies:=1, Collate:=True 　 End With Next i End With End Sub
初めての質問です。 質問用にプログラムを次の通りに作りました。実行すると　OK　と表示しますが、これを、文章に応じて表示させたいのです。本例の場合は、曇り20度、湿度60%　です。 つまり、正規表現でマッチした文字を変数に代入して、その変数を用いて、msgbox出力したいのですが、どの様にコード（マッチ文字の変数化）を記述すれば良いのでしょうか？ 本例でいえば、曇りを変数xに、20を変数yに、60を変数zに取り込めるようにしたいのです。 質問用なので、プログラムの意味はこだわらないでください。 本番用では、"本日は曇り20度ですが、湿度60%でした。"は、関数の引数で可変の文章です。 質問が下手で済みません。よろしくお願いいたします。 【sample.vbsの内容】 if blnCheck("本日は曇り20度ですが、湿度60%でした。") then msgbox "OK" '曇り20度、湿度60%　と表示させたい else msgbox "NG" end if Function blnCheck(strLen) Dim objRE Set objRE = new RegExp objRE.IgnoreCase = True objRE.pattern = "^本.*(晴)|(曇り)|(雨)\d\d.*湿度\d\d.*" blnCheck = objRE.Test(strLen) Set objRE = Nothing End Function
ある会の抽選を行うとき、A列に応募者数、B列に応募者数に応じてRAND関数を入力し、上位20名を当選としています。応募者数は毎回異なりますので、応募者数に応じて、RAND関数が自動的に入力されるマクロを作りたいのです。マクロに詳しい方のお答えをよろしくお願いします。
よろしくお願いします。 以下のようなデータがある場合、目的の形を作るためのプログラムを教えて下さい。 ■データ 　　　　　　A列　　　　　B列 1行目　　日本　　　　　パン、お菓子、水 2行目　　アメリカ　　　小麦、スイカ、メロン、梨 ■目的の形（別シートに） 　　　　　　A列　　　　　B列 1行目　　日本　　　　　パン 2行目　　日本　　　　　お菓子 3行目　　日本　　　　　水 4行目　　アメリカ　　　小麦 5行目　　アメリカ　　　スイカ　 6行目　　アメリカ　　　メロン 7行目　　アメリカ　　　梨 簡単に書きましたが、B列に入るデータ個数は4個以内とは限りません。 また、本当はB列の区切りが改行だったり、空白だったりするのです・・。 ただし、上記の形がわかれば後は頑張ってみます。 どうぞよろしくお願いします。 　　　　
VBA初心者です．よろしくお願いいたします． 用語の読みを自動で振るシートを作成しているのですが，Do Loop部分が一行ずつの入力となっていて，時間がかかっています． これを配列等の方法を用いて高速化したいと思って，試行錯誤したのですが，うまくいきません． 何卒お教えくださいますようお願いいたします． 用語の読みを生成する手順ですが， １．シート1に用語をペーストする ２．ペーストされた用語をシート２にある用語のDB（用語と読みが入力されています．重複レコードなし）にコピー ３．コピーされたシート２をピボットにして個数が２以上あった場合，その用語と読みを返します． ４．Do Loopで最初にヒットした用語に戻るまでループ となっています． ３までの手順に修正の必要はないのですが，４の手順でかなり時間をロスしております． ここを配列等の方法で一度に書き込むことができればと思っています． Sub test() i = 8 L_Row04 = 180188 Dim S1 As Worksheet '読みを振る用語をペーストするシート Dim S2 As Worksheet '読み用の用語のDB Dim S3 As Worksheet 'ピボット Dim L_Row01 As Long 'S1にペーストされた用語の最下行 Dim L_Row02 As Long 'S1の用語をs2にペーストしたときの最下行 Dim L_Row03 As Long 'ピボットの用語の最下行 Dim Rng01 As Range 'S1にペーストされた用語の範囲 Dim Rng02 As Range 'S2にペーストされた用語の範囲 Dim Rng03 As Range 'ピボットの範囲 Dim Str01 As Variant 'ピボットで2以上あったときの用語 Dim Str02 As Variant 'ピボットで2以上あったときの読み Dim firstcell As Range Dim Foundcell01 As Range Set S1 = Worksheets(1) Set S2 = Worksheets(2) Set S3 = Worksheets(3) S1.Activate L_Row01 = S1.Cells(Rows.Count, 2).End(xlUp).Row L_Row02 = S2.Cells(Rows.Count, 3).End(xlUp).Row Set Rng01 = S1.Range(Cells(i, 2), Cells(L_Row01, 2)) Rng01.Copy Destination:=S2.Cells(L_Row02 + 1, 2 + 1) S3.PivotTables("ピボットテーブル2").RefreshTable S2.Activate L_Row02 = S2.Cells(Rows.Count, 3).End(xlUp).Row Set Rng02 = S2.Range(Cells(L_Row04, 3), Cells(L_Row02, 3)) Rng02.Delete S3.Activate L_Row03 = S3.Cells(Rows.Count, 2).End(xlUp).Row Set Rng03 = S3.Range(Cells(4, 2), Cells(L_Row03, 2)) For Each a In Rng03 If a >= 2 And a.Offset(0, -1).Value <> "(空白)" And a.Offset(1, -1).Value <> "(空白)" Then Str01 = a.Offset(0, -1) Str02 = a.Offset(1, -1) S1.Activate Set Foundcell01 = Rng01.Find(What:=Str01, searchorder:=xlByRows, LookIn:=xlValues, lookat:=xlWhole) Do Selection.Offset(0, 1).Value = Str02 Selection.Offset(0, 2).Value = "●" Loop Until ActiveCell.Address = firstcell.Address End If End If Next End Sub
シート名が、「一覧 (2)」、「一覧 (3)」、・・・・・「一覧 (n)」、と連続する各シートの表データを「一覧」という名前のシートにまとめたいのですが、やり方が分かりません。 For Each を使えば出来るんじゃないかと調べましたが、見付けられませんでした。 シート処理以外は、 　　Dim CoR As Long, PaR As Long, PaR2 As Long CoR = Worksheets(???).Cells(Rows.Count, 1).End(xlUp).Row PaR = Worksheets("一覧").Range(Rows.Count, 1).End(xlUp).Row PaR2 = CoR + PaR + 1 Worksheets(???).Range(Cells(2, 1), Cells(CoR, 12)).Copy Worksheets("一覧").Range(Cells(PaR, 1), Cells(PaR2, 12)).PasteSpecial Paste:=xlPasteValues こんな感じで作っています。 作り方、もしくは参考になるサイトがありましたら、教えていただければありがたいです。 よろしくお願いします。
VBA2010で,B列の値が変わったら、A列の同じ行に前日の日付を入力するには、マクロコードをどのように書けばよいですか？B列データ入力範囲はB3～B65536 尚、B3～B65536にはVLOOKUPで、他のブックから値を参照しています。 最後にA列の同じ日付セルを結合し、I列、P列、W列の同じ行に結合したセルをペーストたいのです。 宜しくお願い致します。
こんばんは。宜しくお願いします。 ◇行いたいこと 複数のフォルダ(例："D:\AB"　"D:\CD"　"D:\EF")に格納されているファイルの中から指定した 日付を含んだファイルをコピーし、あるフォルダに張り付けたい。 (指定する日付を含んだファイルがすべてのフォルダに存在するとは限らない) ◇現時点でのソース ※エラー処理の未実装部分については無視していただいてけっこうです。 Dim fs Dim msg Dim f Const copyFrom = "D:\AB" Const copyTo = "D:\VBS\コピー先\" Do '日付入力のインプットボックスを出力 hizuke = InputBox("日付を入力してください。" & vbCr & vbCr & "例）2000-01-01") 'インプットボックスの入力値が空白である If hizuke = "" Then '日付入力を促すメッセージ出力 MsgBox "日付を入力してください。" Exit Do End If 'インプットボックスの入力値が10文字である If Len(hizuke) = 10 Then 'エラーが発生しても次の処理をすすめる On Error Resume Next '指定した日付の確認ダイアログを表示 msg = MsgBox(hizuke & "でよろしいですか？", vbYesNoCancel) '日付の確認ダイアログでYesを選択 If msg = vbYes Then 'ファイルオブジェクトを作成 Set fs = CreateObject("Scripting.FileSystemObject") 'コピー元フォルダに存在するファイルを読み込む For Each f In fs.GetFolder(copyFrom).Files '指定した日付を含むファイル名を検索 If InStr(f.Name, hizuke) > 0 Then '未実装　ファイルの上書き処理 fs.CopyFile 'コピー元　コピー先 Exit Do '未実装　Else Ifの処理 End If Next '未実装　Else Ifの処理 End If '未実装　Else Ifの処理 End If Loop 以上です。ご教授宜しくお願いします。
CIntと Integer.Parseの違いとはなんでしょうか？？
visual studio2010とaccessのデータ（MDB)を使用してプログラムを作っています。 フォームにdatagridviewを1つ配置し、ボタンを２つ用意します。 datagridviewにはデータをバインドせず、２つあるボタンそれぞれに表示するプログラムの記述をし、ボタンを押下することで表示させるようにしています。 ここからが不明な点なのですが、この２つあるデータを、datagridviewのダブルクリックによって別の登録画面を表示し、データの更新や削除をおこなったり、データの新規登録を行いたいのです。 が、２つあるデータを区別させるプログラムの記述がわかりません。 当方は勉強中の身なので、それが可能なのかすら正直わかりませんが、 可能であればプログラムでデータを識別させるコードを教えていただけないでしょうか。 ネットで調べたのですが似たようなものをまず見つけられず、よくわかりませんでした。 よろしくお願いいたします。
開発機はWindows7ProfessionalでデータベースはOracle11g、ユーザークライアントはWindowsXP Professional SP3でOracleクライアントをインストールしてあります。開発機でビルドしたモジュールをユーザークライアントで動作させると、下図のようにエラーが出力され、動作しません。逆にWindowsXP上でビルドしたモジュールはキチンと動作しますし、そのモジュールはWindows7上でも動作します。毎度WindowsXPを使ってビルドしていられないので、どのようにすればWindows7でビルドしたモジュールをWindowsXP上で動作させることができるでしょうか？ちなみにビルドしたモジュールはＷｉｎｄｏｗｓＸＰの互換設定をしています。よろしくお願いいたします。
Excel2007でマクロ作成中の初心者です。 1)Ａブックに次のマクロを書いてます。 Sub データをクリアする() Dim list, SheetName Const EXCEPT_NAME = "計算　番号　明細" For Each SheetName In ActiveWorkbook.Worksheets If InStr(EXCEPT_NAME, SheetName.name) = 0 Then Sheets(SheetName.name).Activate クリア範囲 End If Next End Sub -------------------------------- Sub クリア範囲() Range("AM13:AQ13").Select Selection.ClearContents End Sub 2)上のマクロは、Ｂブック上で実行します。 Ｂブックのマクロ実行は、最初のボタンクリック１回のみです。 （このＢブックが閉じられ保存されるまで） なぜなら、クリアした部分に、新しいデータを入れるからです。 誤って２回目のボタンクリックでも、マクロ実行しないようにしたいです。 せっかく入力した新しいデータを消去しないためです。 このようなコマンドボタンを作るにはどうしたらよろしいでしょうか？
初めて質問します。 VBA初心者で勉強中なのですが教えてください！ sheet1に下記 顧客番号物件名４月５月６月 03101111神戸1,2001,300 03101112大阪1,3001,400 03101113名古屋1,5001,600 03101114熊本1,6001,700 03101116群馬1,6501,600 sheet2に下記 顧客番号物件名６月 03101111神戸1,600 03101113名古屋1,800 03101114熊本1,900 03101115北海道1,800 03101116群馬1,700 の二つのシートがありsheet2のデータを全コピしてsheet1のデータに上書きで貼り付けたら 又はsheet3に下記完成形 　顧客番号物件名４月５月６月 　03101111神戸1,2001,3001600 　03101112大阪1,3001,400 　03101113名古屋1,5001,6001800 　03101114熊本1,6001,7001900 　03101115北海道 空白　空白　1800 　03101116群馬1,6501,6001700 を作りたいのですが、なにかいい方法はありますでしょうか・・・ 今後も７月８月とデータは増えていきます(空白は空白セルです) ６月データがない所も残しつつ、新規に６月からデータができたとこも追加して 重複してるのはそのまま６月分を追加したい感じです。 わかりにくい説明かもしれませんが、ぜひお願い致します。
ヤフーニュースのURLをlistboxへ入れます。 そしてlistBox 4個の中に入ったURLを全てDBへインサートしたいです。 文字数の関係でコードが全て掲載できなかったのでyahooBoxへ載せました。 大変お手数ですが、以下のURLから見て頂いて何か回答頂けるとうれしいです。 https://box.yahoo.co.jp/guest/viewer?sid=box-l-7 … 宜しくお願い致します。
エクセルで複数のデータ系列を１つのグラフに表示させていますが、たくさんありすぎて見えにくい場合があります。ラジオボタンで、データ系列ごとに表示・非表示を簡単に出来る方法を教えて下さい。 VBはサンプルプログラムを数年前に作ったきり知識は皆無に等しいです。 よろしくお願いいたします。
Ｕｓｅｒが　ＡｄｄＢｕｔｔｏｎをおしたら 今までＵｓｅｒが入力したＴｅｘｔｂｏｘを修正できないようにしたいですが どうしたらいいですか？ Ｕｓｅｒ　Ｉｎｐｕｔ; NameTBox　 AddressTBox CityTBox StateTBox Zip CodeTBox
お世話になります。 「標準書式」の日付データを、「平成25年04月29日」型式に変換して別のセルに保存すると「日付書式」になりました。 この和暦データを手動でコピー＆ペーストしようとすると日付が一度、西暦に変換されるので、使い勝手がよくありません。 VBAでこの「日付書式」の和暦を、「標準書式」に変換するにはどうすればよいでしょうか？ 「標準書式」セルに和暦を入力した時は、書式はそのままなので、同じ様になればとは思っています。
よろしくおねがいします。 あるフォルダ（固定）の中にある、.hogeというファイルのうち、最新のファイルを既定のプログラムで開きたいと考えています。 このフォルダには、.hoge 以外のファイルも混在しています。 既定のプログラムで開くには、 Dim WSH As Object Set WSH = CreateObject("WScript.Shell") WSH.Run """C:\開きたいフォルダ\最新のファイル.hoge""" このように書くことで動作確認できました。 1) フォルダ内で .hoge を列挙して 2) その中で一番更新日時が新しいファイルの名前を取得 この2点ができれば完成なのですが、どうすればよいかわかりません。 具体的な書き方を教えていただけますでしょうか。
お世話になります。 Word97-2003文書を使用しています。 今までExcelVBAを使していて、今日初めてWordVBAを使用しました。 基本的な事ですが、試しに Document_New()　と、Document_Open()　にコードを入れて、 保存して、再立ち上げするとコードが消えています。 操作のどこに問題があるのでしょうか？ よろしくお願いします。
現在、VB2010で、Windowsアプリを作っています。 Form1から、ボタンで画面遷移を行っているのですが、 Form2でデータを作成する前にForm3に移動しないように MessageBoxで画面表示をさせてからMe.Close()を試したのですが、 Form1の方が閉じてしまい、Closeしない場合はForm3が 立ち上がってしまいます。 何とか、Form1はそのままでForm3が立ち上がらないように したいのですが、いい方法はないでしょうか？
VBA初心者です。よろしくお願いします。 Book1のSheet1のA2の値を検索条件とし、Book2のsheet1のA列を検索し、条件に合った行のC列の合計値を取得するとします。出力先はBOOK1のA2と同じ行、C2です。 これだけであれば、sumif関数で処理できるのですが、 Book1のA列の最終行までこの処理を繰り返さなければなりません。 また、毎月、Book1,2ともに最終行が変化します。 上記を簡単に書くと以下になります。 ■Book1のsheet1 　　　A　　　B　　　C 1　 101　 リンゴ　（ここにBook2の合計値を出力したい） 2　 202 　レモン　（ここにBook2の合計値を出力したい） 3　 510 　　柿　 　（ここにBook2の合計値を出力したい） ■Book2のsheet1 　　　A　　　B　　　　C 1　 202　 レモン　　10 2　 202 　レモン　　30 3　 101 　リンゴ　　200 4　 707 　ブドウ　　50 5　 101　 リンゴ　　70 6　 510　 　柿　　　100 上記処理をsumif関数、forを使って作成してますが、どうもうまくいきません。 申し訳ございませんがよろしくお願いします。 環境は、Windows7、Office2010 です。
VB2010のDatasetについてご質問があります。 Datasetにデータベースエクスプローラを使用してデータテーブルを作成し、Fillメソッドを使用してテーブルの参照を行っております。今回、サーバーの入れ替えを行うことになり、データベースの内容は全く変わらないのですが、コンピュータ名とIPアドレスが変更になるということで、今までのDatasetの接続先だけを変更するにはどうしたらいいのだ？で悩んでおります。 さらに、今回みたいなケースは今後もあると思うので、接続先文字列をいつでも変更できるようiniファイル等で外部から変更できるようにしたいと思っております。 ご教授よろしくお願い致します。
次の記述で、コマンドボタン2クリックで、ブックが1つならExcelを、複数なら現在のブックを 閉じる動作をします。 Excelのバージョンが2010なら問題ありませんが、2003や2007だと、複数ブックがある時に 「問題が発生したため・・・Excelを終了します」のメッセージがでます。 Private Sub CommandButton2_Click() If Workbooks.Count > 1 Then ThisWorkbook.Close SaveChanges:=True Else ThisWorkbook.Save Application.Quit End If End Sub これの対処方法を教えてください。
エクセルVBA初心者です。 コードを記述している際に、”迷惑な”コンパイルエラーが出てきます。 例えば dim i i= 記述中に、他をマウスクリックすると、コンパイルエラーになります。 エラーなのは重々理解していますが、実行時にエラーかどうか判定して欲しいです。 オプションで、順次コンパイルOFFなどして試行錯誤しましたが、不可能でした。 仕様なのでしょうか？ エクセル２００７
開いているＥｘｃｅｌＢｏｏｋに変更が加えられていれば、保存してＢｏｏｋを閉じ、変更が加えられえていなければ、保存しないでＢｏｏｋを閉じるようなロジックをＶＢＡで実現したいと考えています。 そこで、Ｂｏｏｋへ変更が加えられているかどうかの判断として使える情報、フラグのようなものがＥｘｃｅｌＢｏｏｋには無いでしょうか。 私のＰＣのＯＳはＸＰ、Ｅｘｃｅｌのバージョンは２０００です。
Excel VBAで以下のようなフレーム構造を持つHTMLページを操作したいと考えています。 （実際はもっと複雑なページですが、簡略化して記載しています） <HTML> <HEAD> <TITLE>ようこそ ○○さん</TITLE> </HEAD> <FRAMESET id=frameset1 border=0 name=TotalFrame frameSpacing=0 rows=48,*,0,0 frameBorder=0> <FRAME name=header src="./Header/Header.aspx" noResize scrolling=no> <FRAMESET id=frameset2 border=0 frameSpacing=0 frameBorder=0 cols=144,*> <FRAMESET id=menuFrame border=0 name=menuFrame frameSpacing=0 rows=22,*,0 frameBorder=0> <FRAME id=option6 name=option6 src=""> <FRAME name=Contents src="./Menu/MenuFrame.aspx" noResize scrolling=no> <FRAME name=sub2 src="" height="0"> </FRAMESET> <FRAMESET border=0 name=mainFrame frameSpacing=0 rows=*,0> <FRAME name=main src="" scrolling=no> <FRAME name=sub src="" height="0"> </FRAMESET> </FRAMESET> <FRAME name=message src="" height="0"> <FRAME name=footer src="" height="0"> </FRAMESET></HTML> このWebページは、メニューフレームに「番号検索」「高度な書誌検索」などの各種メニューボタンがあり、これらメニューボタンをクリックすると、各メニューに対応した検索画面がメインフレームに表示されるというページ構成になっています。 このWebページを開いた時点（デフォルト）では、メインフレームは「高度な書誌検索」画面になっています。 そこで、 (1)メニューフレームの「番号検索」ボタンをクリックしてメインフレームを「番号検索」画面に変更し、続いて、 (2)メインフレームに表示された「番号検索」画面のテキストボックスに値を入力したいと考えています。 (1)メニューフレームの「番号検索」ボタンをクリックし、メインフレームを「番号検索」画面に変更する操作は以下のプロシージャで上手くいきました。 　　 Dim IE As InternetExplorer, htdoc As HTMLDocument, htdoc_frame As HTMLDocument, htdoc_frame_frame As HTMLDocument, anchor As HTMLAnchorElement 　　 Set IE = CreateObject("InternetExplorer.Application") IE.Visible IE.Navigate "http://www.○○○・・・（省略）・・・" Do While IE.Busy Or IE.ReadyState <> 4 DoEvents Loop Set htdoc = IE.Document Set htdoc_frame = htdoc.frames("Contents").Document Set htdoc_frame_frame = htdoc_frame.frames("header").Document For Each anchor In htdoc_frame_frame.getElementsByTagName("DIV") If anchor.ID = "G04" Then 'G04は「番号検索」ボタンに相当するID anchor.Click Exit For End If Next しかし、続く、(2)メインフレームに表示された番号検索画面のテキストボックスに値を入力する操作が、以下のプロシージャでは上手く行きません。 Set htdoc = IE.Document Set htdoc_frame = htdoc.frames("main").Document Set htdoc_frame_frame = htdoc_frame.frames("main").Document Dim txtAreaOutput As HTMLInputElement Set txtAreaOutput = htdoc_frame_frame.getElementsByName("TextBox1")(0) txtAreaOutput.Value = "VBAからの書き込み" 上記プロシージャを実行してもエラーは発生しないのですが、テキストボックスに"VBAからの書き込み"という値が入力されません。 自分でいろいろ調べてみたところ、どうも、(1)の操作で、見た目はメインフレームが「番号照会」画面に変化しているものの、内部的に？はメインフレームが「高度な書誌検索」画面のままであるのが原因のようです。 内部的にも、メインフレームを「高度な書誌検索」画面から「番号検索」画面に変化させるにはどうすれば良いのでしょうか？ 非常に判り難い質問かと思いますが、何か判る方がいらっしゃいましたら、教えて頂けると幸いです。
VBAでファイル名取得のマクロを作成しているのですが buf = Dir(C\aa\aaa\, vbDirectory) buf= Dir(C:\aa, vbDirectory) Do While buf <> "" Do While bufa <> "" msg = msg & bufa & vbCrLf bufa = Dir() Loop msg = msg & buf & vbCrLf buf = Dir() Loop がうまく動作しません。 Dirの()が空白なのと、Do While <>の中身が空白のどちらかが原因だと思うのですが Do Whileの中でさらに Do Whileを動作させるにはどのように書けばいいのでしょうか？
Sub ImportTextFile() Dim DestBook As Workbook, SourceBook As Workbook Dim DestCell As Range Dim RetVal As Boolean Application.ScreenUpdating = False Set DestBook = ActiveWorkbook Set DestCell = ActiveCell RetVal = Application.Dialogs(xlDialogOpen).Show("*.txt") If RetVal = False Then Exit Sub Set SourceBook = ActiveWorkbook Range(Range("A1"), Range("A1").SpecialCells(xlLastCell)).Copy DestBook.Activate DestCell.PasteSpecial Paste:=xlValues SourceBook.Close False End Sub 上記のコードは指定したテキストファイルをシートに出力するものなのですが、 任意で複数のテキストファイルを選んだ時に、同じシートに選んだ複数のテキストファイルを Ａ1セルをはじめとしてをＡ列の最終セルにすべてのファイル順番に張り付けたいのです。 今の状態だとウィザード画面でいちいち設定しないといけないのでテキストをそのままの状態で いいのでウィザード画面を飛ばしてできればなおいいです。 ぜひ、アドバイスお願いします。
業務上、エクセルファイルのデータをCSV変換し、他のソフトへコンバートする 作業を行う事になったのですが、初心者なので全くわからず、 ネットの力に頼ってVBAでCSV変換するコマンドまでは作成できたのですが、 コンバート先のソフトへは、以下(1)、(2)の設定が不足している事がわかりました。 現在利用しているコマンドにその機能を持たせる事は可能でしょうか。 (1)文字コードをUTF-8へ指定 (2)改行コードをLFへ指定 VBAのバージョン：VisualBasic6.5 Sub Test() Dim ws As Worksheet On Error Resume Next For Each ws In ActiveWorkbook.Worksheets ws.SaveAs ThisWorkbook.Path & "\" & ws.Name & ".csv", xlCSV Next ws End Sub 初めての質問なので内容が解りづらいと思いますが申し訳ありません。 ご回答をお待ちしております。
VB6からVB2010への移行を行うにあたり、 VB6→VB2008→VB2010 のコンバートを行いました。 が、以下のソースがコンバートされてコンパイルエラーになってしまいます。 エラー内容： 型 'System.Windows.Forms.Cursor' の値を 'Integer' に変換できません。 ---(1)元のソース------------------ Dim lSv_Mouse As Long 'マウスポインタ状態の保存 lSv_Mouse = Screen.MousePointer （中略） 'マウスポインタ状態の復元 Screen.MousePointer = lSv_Mouse ---------------------------------- ---(2)コンバート後のソース--------- Dim lSv_Mouse As Integer 'マウスポインタ状態の保存 lSv_Mouse = System.Windows.Forms.Cursor.Current （中略） 'マウスポインタ状態の復元 System.Windows.Forms.Cursor.Current = lSv_Mouse ---------------------------------- 何か良い方法は無いでしょうか？
エクセルの "温湿度" と名前をつけたテーブルでフィード名の指定行の値を取得したい フィード名のセル内で[Alt]+[Enter]で改行をした場合のコードの書き方が分かりません 温度 [℃]　　　　のようなフィード名にしたい Dim OndoR As Range '温度 Set OndoR = Range("温湿度[温度 '[℃']]") '温度 ↑ この行でエラーになります フィード名に [Alt]+[Enter]で改行　を使いたいのですが、どの様に記述すればエラーにならないのでしょか？
VB.Net 2010/W.7でシリアル通信のプログラムを作成しました。 デバック状態では正常に動作しました。又、Debugフォルダー内に出来た.exeファイルでも正常に動作しました。 この.exeをVB.Netの外にコピーして実行させようとした所、"アプリケーションのコンポーネントで、ハンドルされていない例外が発生しました。「続行」をクリックすると、アプリケーションはこのエラーを無視し、続行しようとします。「終了」をクリックすると、アプリケーションは直ちに終了します。 ポート'Com1'は存在しません。 とのメッセージが出てしまいました。 RS-232cの部分を外して実行させると正常に動作する様です。 これは無料版を使用している為の制限なのでしょうか、それとも何かをインクルードする必要があるのでしょうか。 同様に System.IO.Directory.CreateDirectory(sCurDir & "Log") でディレクトリーを作成出来ない様です。Debugフォルダーの中ではディレクトリーは作成されて居ました。 手動でディレクトリーを作成すると、その中にファイルは書けるみたいです。 お分かりに成る方が居られましたらお教え下さい。 宜しくお願い致します。
エクセルの "温湿度" と名前をつけたテーブルでフィード名の指定行の値を取得したい Dim HidukeR As Range 　'日付 Dim OndoR As Range '温度 Set HidukeR = Range("温湿度[日付]") '日付 Set OndoR = Range("温湿度[温度 [℃]]") '温度 ↑ この行でエラーになります 原因はフィード名に "[" と　"]"を使っている為だとわかりました フィード名から "[" と　"]"を無くしたらエラーになりません しかし、フィード名に "[" と　"]"　を使いたいのですが、どの様に記述すればエラーにならないのでしょか？
シート名→　コース別VBA　に 表示する窓口を設定しました。 そして、クラス出席番号順　というシート名から そのコース別ＶＢＡに表示するという作業です。 表示するのは、番号・名前・住所などです。 一応、下のように打ってみたのですが、 「オブジェクトは、メソッドまたはプロパティをサポートしていません。」 よろしくお願い致します。 Sub コース別表示() Set 窓 = Worksheets("コース別VBA") 引き取り = 窓.Cells(3, 2) Set クラス = Worksheets("クラス出席番号順") 縦 = 6 For 行 = 3 To 351 If クラス.Cells(行, 9) = 引き取り Then 窓.cell(縦, 2) = クラス.Cells(行, 3) 窓.cell(縦, 3) = クラス.Cells(行, 4) 窓.cell(縦, 4) = クラス.Cells(行, 5) 窓.cell(縦, 5) = クラス.Cells(行, 6) 窓.cell(縦, 6) = クラス.Cells(行, 7) 窓.cell(縦, 7) = クラス.Cells(行, 8) 縦 = 縦 + 1 End If Next End Sub
idと値を持ったリストがあります 例えば 100 りんご 200 みかん 300 バナナ といった具合です。 この時、インデックス0の、item(0) item(1) でコード100 値りんご は取れると思いますが、 インデックスをベースに探すのではなく、 「コード100の値は何か？」や「りんごのコードは何か？」を取得したいです。 今はhashtableなどを、index 0 からindexの最後までをループ処理で検索する処理で実現していますが、最初からそういうメソッドを持ったクラスはないものでしょうか？
Visual Basic関係の開発環境についてよく解っていません。 初心者です。 教えてください。 VB6で開発されたプログラムというところまでは判っているのですが、どの.NETFRAMEWORKのバージョンで開発されたかの確認をしたい場合、どのファイルを開くか、参照をすればいいでしょうか？ ちなみにソリューションファイルがありません。 宜しくお願いします。
ファイル名は取得できているはずなのですが。 エラー７５「パス名が無効です」とエラーになり止まってしまうのですが、 ファイルはできているんです。 何がいけないんでしょうか？ '------------------------------------ Private Sub コマンド35_Click() Set db = CurrentDb Set rs = db.OpenRecordset("Q_03_管理票_YES") Dim var1 As String var1 = rs.[管理番号] Dim var2 As String var2 = rs.[関連作業依頼] Dim NewFolderName1 As String Dim FileName1 As String NewFolderName1 = CurrentProject.Path & "\作業依頼対応\" & var1 & "\" & "回答分" & "\" & var2 FileName1 = Dir$(NewFolderName1, vbDirectory) 'ファイル名を得る '---ファイルを作成 If (FileName1 = "") Then 'ない場合は、作成する。 Dim myFileSystem As New Scripting.FileSystemObject myFileSystem.CreateFolder NewFolderName1 MkDir NewFolderName1 MsgBox "ファイル作成" Else '---ファイルが存在する場合 MsgBox "ファイルはあります" End If End Sub
VB2010（.net framework4.0）で、.net chartコントロールを使用し、グラフをブラウザに表示するプログラムを作成しております。 作成するグラフの中に、積層棒グラフ（積み重ね棒グラフ）があり、その各系列を結ぶ線（接続線や系列線と呼ばれるもの）を描画したいのですが、.net chartコントロールには該当するプロパティが無い様に見受けられます。（Webで色々と探ってみましたが、マッチしたページが見つかりませんでした） 折線グラフを重ねることでそれっぽい形にはなるのですが、綺麗には描画できず、この質問に至っております。 「実はこのプロパティで実現できる」や、「こうやって折れ線で描画したら綺麗にできる」など、お知恵をお貸し頂ければと思います。 よろしくお願いします。
【環境】 　WindowsXP 　Excel2003 こんにちわ。 VBAでFAX自動送信プログラムを作りたいと考えています。 FAXの接続等に関しまして、ほとんど知識がありません。 環境は新たに構築する事になります。 一度に100通ほど送信するので、G4回線を契約して、ISDNで接続する予定です。 VBAからのFAX送信はMicrosoft Fax Service Extended COM Type Libraryを使用する事になると思います。 （他に良い方法があれば教えていただきたいです。） その上で質問なのですが、 Microsoft Fax Service Extended COM Type LibraryはおそらくXPの「FAXコンソール」と同じ仕組みを使うのかと考えています。 XPの「FAXコンソール」はG4回線に対応していないと聞きました。 となりますと、Microsoft Fax Service Extended COM Type Libraryを使用してのFAX送信では、G4回線を使えないということでしょうか？ 送信する数が多いので、G4回線は必須となります。 目的は、「ExcelVBAでG4回線を使用して自動的にFAXを送信する」ということですので、実現さえできれば上記以外の方法でも問題ありません。 なお、ExcelVBAの使用も前提となりますので、他の市販ソフト（まいと～くFAX等）の使用は検討外です。 ご存知の方、よろしくお願いいたします。
Sub test() Dim Rng As Range For Each Rng In Range("I7:I756") If Rng.Interior.ColorIndex = xlNone Then Cells(Rng.Row, 1).Resize(, 6).Interior.ColorIndex = 35 End If Next End Sub 上記のコードだとうまくいきません＞＜ データベースがＡ7：Ｋ756まであり、Ｉ 列の背景が何もない場合のみ その行のＡからＦまでのセルを薄い緑の背景にしたいのです。 例えばＩ10の背景がない場合はＡ10.Ｂ10.Ｃ10.Ｄ10.E10.F10のセルを薄い緑する といった感じにしたいのですがＶＢＡはあまり詳しくないので 詳しい方ぜひアドバイスお願いします。 エクセル2010を使っています。 補足 Ｉ列の背景は条件付き書式で色付けしています。
Borland C-Builder++の内容をVB.net 2010に書き換えて居る者です。 TextBox等の割り込みを一時的に禁止したいのですが、良い方法はありませんでしょうか。 無ければフラグを用いて、フラグが立っている時のみ処理をバイパスさせる事を考えて居ます。 Builder では ComboBox1->OnChange = NULL ; とコーディングする事により、 void __fastcall TForm1::ComboBox1Change(TObject *Sender) { Edit1->Text = ComboBox1->Text; } への割り込みを禁止出来、 ComboBox->OnChange = ComboBox1Change; とコーディングする事により割り込みを再開出来ました。 これを void __fastcall TForm1::ComboBoxChange(TObject *Sender) { 　　　　ComboBox1->OnChange = NULL ; Edit1->Text = ComboBox1->Text; 　　　　ComboBox->OnChange = ComboBox1Change; } とコーディングする事により、2重割り込みを防止していました。 VBでこの様にイベント割り込みを一時的に禁止にする方法はありますでしょうか。 宜しくご回答下さい。
VB初心者で頑張っているのですが なかなかうまく作成できないので、よろしくお願いします。 シート1のB4には もも、りんご、みかん のどれかが入力されます。そしてC5には単価が入力されています。 もしシート1のB4にももが入力されたらももの単価(シート1のC5の値)をシート2のA2へ、 もしシート1のB4にりんごが入力されたらりんごの単価(シート1のC5の値)をシート2のA5へ、 もしシート1のB4にみかんが入力されたらみかんの単価(シート1のC5の値)をシート2のA8へ 値を移動させたいと思っています。 できそうなのですが、どうしてもできません。 どうぞよろしくお願いします。
Builder C++ではかなりのプログラムを作成していますが、拠点でプログラムを変更出来る様にVBでプログラムを作成し直しているVBに関してはほぼ初心者です。 VBでComboBoxを使用して内容を選択させようとして居ます。 プログラムの最初でComboBoxのTextに初期値(前回選択値)を設定して居ます。 ComboBoxで選択された内容はComboBoxの内容が変更された時に次回プログラム実行時の初期表示の為にiniファイルに書き込みをして居ます。 問題はプログラムの最初に初期値を書き込んだ時にもComboBoxの内容が変更される為、内容変更の割り込みが入り、iniファイルの書き込みルーチンが動作してしまう事です。 ComboBoxのTextの書き込の時に割り込みをしなくて、選択をした時のみ割り込みが発生する割り込みがあると良いのですが、調べた範囲では無い様でした。 Builder C++ではMouseUPイベントの割り込みを使って同じ機能を実現させたのですが、VBのMouseUpイベントでは一つ前に選択された内容しか入って来て居ない様です。 MouseUpのイベント割り込み先には以下のコーディングをして居ます。 Private Sub ComboBox1_MouseUp(ByVal sender・・・・・ Label1.Text = ComboBox1->Text End Sub しかし、これだと選択した時は前回選択された内容が表示されてしまいます。 当然 Private Sub ComboBox1_SelectedIndexChanged(ByVal sender ・・・ Label1.Text = ComboBox1->Text End Sub の場合は選択された内容が表示されます。 双方共、実行後のComboBox自体の表示内容は選択されたものになって居ます。 MouseUpのイベントの時にも選択された内容が表示されれば、このイベントでは ComboBox1->Text　初期値を設定した時はイベントが発生しないので都合が良いのですが、一つ前に選択された内容しか表示されません。 MouseUpの時には未だ内部処理が終了していないので新しい内容が表示出来ないのでしょうか。 Builder C++ には　Application->ProcessMessages()と言う、他のタスクを先に実行させる関数がありますが、多分VBにもその様な関数があると思いますので、それを挿入すれば最新の状態を入手できるものでしょうか。 上記目的を達成出来る方法はありますでしょうか。 無ければフラグを使用して、ComboBox1->Text　に初期値を設定した時には割り込み先でiniファイルの書き込みをしない様にプログラムする予定です。 当然、初期値を表示して居るのですから初期値設定時に再度iniファイルに書き込みがあっても問題は無いのですが、実際には動作していけないプログラムを書きますので、初期値書き込み時には割り込みが無い様にしたいのです。 VBでの処理方法がありましたらお教え下さい。宜しくお願い致します。
vb.net2012で、新規にアプリケーションを作成しました。 これのショートカットをデスクトップに置いて、 vb.net2012を立ち上げてなくてもフォームを呼び出せるようにしたいです。 かなり初歩的な事を聞いてると思います。 C:\Users\Documents\Visual Studio 2012\ の中には、 bin My Project obj があります。 ビルドしてデバックはすでに済んでいます。 exeのショートカットキーを作りたいので、exeファイルがどこにあるのか教えてください。 ご教授よろしくお願いします。
C# データベースからの取得 Posｔgre 前回の知恵袋の質問に対して回答が来ましたが、より多くの情報が欲しいため、OKWAVAにも投稿させて頂きました。 以下が前回の質問URLです。 http://detail.chiebukuro.yahoo.co.jp/qa/question … よろしければご回答頂けると嬉しいです。 本題です。 WHERE句を使って、以下のように書き換えてみました。 ----------------------------------- "SELECT * FROM item_data WHERE NO=1" ----------------------------------- そうすると、以下のように出力されるようになりました。 ----------------------------- 列"no"は存在しません Severity: ERROR Code: 42703 場所 Npgsql.NpgsqlState.<ProcessBackendResponses_Ver_3>d__a.MoveNext() 場所 C:\projects\Npgsql2\src\Npgsql\NpgsqlState.cs:行 843 場所 Npgsql.ForwardsOnlyDataReader.GetNextResponseObject() 場所 C:\projects\Npgsql2\src\Npgsql\NpgsqlDataReader.cs:行 1173 場所 Npgsql.ForwardsOnlyDataReader.GetNextRowDescription() 場所 C:\projects\Npgsql2\src\Npgsql\NpgsqlDataReader.cs:行 1191 場所 Npgsql.ForwardsOnlyDataReader.NextResult() 場所 C:\projects\Npgsql2\src\Npgsql\NpgsqlDataReader.cs:行 1377 場所 Npgsql.ForwardsOnlyDataReader..ctor(IEnumerable`1 dataEnumeration, CommandBehavior behavior, NpgsqlCommand command, NotificationThreadBlock threadBlock, Boolean synchOnReadError) 場所 C:\projects\Npgsql2\src\Npgsql\NpgsqlDataReader.cs:行 1040 場所 Npgsql.NpgsqlCommand.GetReader(CommandBehavior cb) 場所 C:\projects\Npgsql2\src\Npgsql\NpgsqlCommand.cs:行 611 場所 Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior cb) 場所 C:\projects\Npgsql2\src\Npgsql\NpgsqlCommand.cs:行 588 場所 Npgsql.NpgsqlCommand.ExecuteReader() 場所 C:\projects\Npgsql2\src\Npgsql\NpgsqlCommand.cs:行 551 場所 posgretest.Form1.button1_Click(Object sender, EventArgs c) 場所 C:\Users\turbo2\Documents\Visual Studio 2010\Projects\posgretest\posgretest\Form1.cs:行 39 ---------------------------- DBにはちゃんとno列はあります。 これはどういうことなのでしょうか？ どうやれば、1行だけのデータを表示することが出来るのでしょうか？ 誰か教えて下さい。 宜しくお願い致します。
エクセルで「入力規則」の「リスト」から、マーク（文字）を選択する表を作りました。 選択した文字により、自動的に文字色を変更させたいのです。 「●」を選択した場合、赤文字色に 「◆」を選択した場合、緑文字色に 「★」を選択した場合、ピンク文字に 「◆★」を選択した場合、◆は緑、★はピンク文字色に マクロを適用するのは、シート全体です。 私はマクロ初心者で試行錯誤を繰り返しましたが、思うようなマクロができませんでした。 お解りになる方、ぜひ教えて下さい。よろしくお願いします。
VBA初心者です。 ある特定のフォルダに入っている複数のファイルから、指定したシート名のシートだけコピーする方法はあるのでしょうか？ ちなみに、フォルダに入っているファイルは全て指定したシートを読み込みたいと思ってます。
VB .Net（2008）のWebRequestでHPのページの値を取得するものを作成しているのですが、Javascriptが表示する部分の値が取得出来ません。 Javascriptが動的に挿入する値を取得する方法はあるでしょうか？ よろしくお願いします。
Excel VBA 列の表示と非表示について いつも参考にさせて頂いています。 現在扱っているデータの列が90以上あり、データとしては便利なのですが時に見辛く感じる事があります。 (1).ユーザーフォームからコマンドボタンで一度全ての列を非表示にする。 (2).(1)を行ってからチェックボックスで表示させたい列を表示させる。 といった行程でＶＢＡを組む事は可能でしょうか？ 列の表示と非表示について自分なりに調べてみたのですが、消したい列をチェックボックスで消す方法は見つけたのですがそれでは90項目の列の中で5項目だけが必要な場合85回チェックを入れなくてはならなくなり、もう少し効率的な方法があればと考えております。 方法について分かる方は、例をご教示いただけますでしょうか？ 宜しくお願いします。
　図形のクリアでG1の入力規則の▼まで一時的に消えてしまいます。コード文でShapesを 用いているのではないかと思いますが、▼で消去を回避する方法が ありましたらお教え願え ますでしょうか？ Windows7・SP1 Office2010 Sub 図形のクリア() Dim myRng As Range Dim sp As Variant Set myRng = Range("I10:CW60") For Each sp In ActiveSheet.Shapes If Not Intersect(Range(sp.TopLeftCell, sp.BottomRightCell), myRng) Is Nothing Then On Error Resume Next sp.Delete End If Next Set myRng = Nothing End Sub
ソフト　excel2003 o列に文字列が入力された表があります。 マクロ実行時下記のようにするには、VBAのコードをどのように記入すればよろしいでしょうか？ 赤枠で囲んだボタンをクリックすると シート１のO列に　中　が入力されている行を切り取りし中シートに貼り付け （下の行は上方向にシフト） ※　シート１の内容は日毎に更新されますので、更新後、赤枠で囲んだボタンをクリックするとその時点で　中　が入力されているものは中シートのリストへ追加されるようにしたいのです。 以前ここで教えていただいたものを参考に作成してみたの（以下に記載）ですがうまくいきません。 お助けいただけないでしょうか。 宜しくお願い致します。 Sub ボタン中シート_Click() 'Sheet2の挿入位置(C列は結合セルではなく、必ず何か入っている事） nMax2 = Sheets("中シート").Cells(Rows.Count, 3).End(xlUp).Row + 1 With Sheets("sheet1") nMax1 = .Cells(Rows.Count, 9).End(xlUp).Row For i = nMax1 To 2 Step -2 If .Cells(o, 15) = "中" Then .Range(.Cells(o, 1), .Cells(o + 1, 10)).Copy Sheets("中シート").Cells(nMax2, 1).Insert Shift:=xlDown .Range(.Cells(o, 1), .Cells(o + 1, 10)).Delete Shift:=xlUp End If Next i End With End Sub
　下記のコードをWorkSheetで2つ反映させるにはどうしたらいいでしょうか？どちらか一つなら反映するのはわかりますが、どう名前を変更すればいいのかお教え願えませんでしょうか？ windows7・SP1 Office2010 Private Sub WorkSheet_Change(ByVal Target As Range) If Intersect(Target, Range("C1")) Is Nothing Then Exit Sub '検査範囲 Application.EnableEvents = False '再帰実行の停止 If Range("C1").Value <> Sheets("祝祭日").Range("A1").Value Then MsgBox ("祝日の設定を反映するため年度を同じにしてください。") End If Application.EnableEvents = True End Sub Private Sub WorkSheet_Change(ByVal Target As Range) Dim MyRow As Long Dim MyCol As Integer MyRow = Target.Row MyCol = Target.Column With Worksheets("メイン・1").Select If MyRow = 1 And MyCol = 7 Then If Target = 4 Then 'または　If Target = 1 Then メインデータの復元 '動かしたいマクロ名 End If End If End With End Sub
ソフト　excel2003 Ｉ列（赤枠部分）に文字列が入力された表があります。 マクロ実行時下記のようにするには、VBAのコードをどのように記入すればよろしいでしょうか？ 『　△　』ボタンをクリックすると シート１の赤枠内のセルに△が入力されている行を切り取りしシート2に貼り付け （下の行は上方向にシフト） 『　×　』ボタンをクリックすると シート１の赤枠内のセルに×が入力されている行を切り取りしシート3に貼り付け （下の行は上方向にシフト） ※　シート１の内容は日毎に更新されますので、更新後、『　△　』ボタンをクリックするとその時点で△が入力されているものはシート２のリストへ追加され、『　×　』ボタンをクリックすると×が入力されているものはシート3のリストへ追加されるようにしたいです。 急ぎの仕事なので、困っています。 宜しくお願い致します。
よくオークションで出ているのですが、 Microsoft Visual Basic 4.0はwindows7でも使えるのですか？ 買って使えなかったら勿体ないので質問しました。
AccessのVBAで作ったアプリがあります。ある時点で仕様を大きく変更する為、ある時点がきたらアプリをダブルクリックしても動かないようにしたいと思っています。 理由として、ユーザーが間違って古いプログラムを動かして仕事をされると、業務に影響がある為、間違わないようにプログラムを動かせたくありません。 VBAでFormロード時に何かすればいいとは思うのですが、何か良いアイディアはございますでしょうか？よろしくお願いします。
現在vb.net (visual studio 2010)でソフト（素人です。）を作成しています。ようやくインストーラまでたどりつきました。そこで質問です。よくベクターなどでソフトをダウンロードしたときに、 「アンインストールは，そのまま削除するのみです．レジストリ等は，一切変更していません．」 という断り書きを見ます。 質問１．vb.netで作成したソフトをインストール（インストーラはsetupプロジェクトで作成）した場合、レジストリは変更されているのでしょうか？ （レジストリを変更するようなプログラムは自分ではしていません。） 質問２．もしレジストリが変更されていないなら、アンインストールはコントロールパネルのプログラムのアンインストールから行わないで、インストールされたファイルを手動で削除してもよろしいのでしょうか？ 御教示いただけると幸いです。
エクセルＶＢＡで、メインで使用してる配列変数（の値）をサブルーチンに渡したいが、どうすればよいでしょうか。（なお、メインプログラムは大きいためこれ以上は書けないのでサブルーチンを使用） よろしくお願いいたします。
現在、VB.net(2003)で エクセルの区切りを使用しようと 思ってるのですが、 「オブジェクト変数または with ブロック変数が設定されていません」 というエラーが出てしまいます。 どなたかエラーの原因が分かる方 いませんか？ プログラムは、 Private xlapp As Excel.Application Private xlBook As Excel.Workbook Private xlSheet As Excel.Worksheet dim array as Array xlsheet.columns("A:A").TextToColumns(Destination:=xlsheet.Range("A1"), DataType:=xlFixedWidth, _FieldInfo:=Array(Array(0, 9), Array(1, 2), Array(10, 9), Array(13, 9), Array(14, 9), _ Array(22, 1), Array(82, 9), Array(96, 1), Array(106, 2), Array(114, 2), Array(126, 1), _ Array(127, 9), Array(132, 9), Array(172, 1), Array(182, 1), Array(192, 1), Array(202, 2), _ Array(211, 1)), TrailingMinusNumbers:=True) です
以下のプログラムで Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _ False, Transpose:=False の部分で「コピー領域と貼り付け領域の形が違うため、情報を貼り付けることができません。」というエラーが出てしまいます。 因みに、コピー元もコピー先も結合セルはありません。 どのように修正すればよいのでしょうか？ -------------------------------------------------------------------------------- Retu = Array(, 2, 17, 10, 9, 6, 7, 8) For N = 1 To 7 'Array関数Indexは０から始まるため、最後は抽出列数より１少ないものになる。 計上Sheet1.Activate 計上Sheet1.Range(Cells(5, Retu(N)), Cells(Sheet1件数MaxRow, Retu(N))).Select Selection.SpecialCells(xlCellTypeVisible).Select Selection.Copy 計上Sheet3.Activate 計上Sheet3.Cells(25, N).Select Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _ False, Transpose:=False
エクセルでA1からA5を選択状態にして、ショートカットキーでA2からA4を線形補間できるアドインはつくれないでしょうか？ A1 1 A2 A3 A4 A5 5
VBAで、オートシェイプのインデックス番号を変数に挿入すると途中で初期化されてしまいました。 VBAのチェックボックスを用いて各チェックボックスごとに、 ある画像の座標からAX,AY+aの位置に幾つかの円を表示し、 チェックを外すと作成した円を削除するプログラムを作っています。 また、最終的にはチェックボックスを複数(10~15)個作ってそれに対応した 円だけを表示するようなプログラムにしたいと考えています。 下のプログラムをデバックすると※2の部分で変数の値が""、 最終的に※3の行で止まってしまいます。 Option Explicit Public i As Long '繰り返し変数定義 Public ix As Integer '繰り返し回数変数定義 Public X As Integer '基準位置情報変数定義(x軸) Public Y As Integer '基準位置情報変数定義(y軸) Public AX As Integer '移動位置情報変数定義(x軸) Public AY As Integer '移動位置情報変数定義(y軸) Private Sub CheckBox1_Click() Static O() As Variant Y = ActiveSheet.Shapes("Picture 1“).Top '図の上端の位置を変数に挿入 X = ActiveSheet.Shapes("Picture 1").Left '図の左端の位置を変数に挿入 i = 0 ix = 3 '繰り返し回数を変数に挿入 ReDim O(ix) AX = X + 500 AY = Y + 280 '--------------------------------------------------- If CheckBox1.Value = True Then 'チェック有 Do Until i = ix ActiveSheet.Shapes.AddShape(msoShapeOval, AX + (i * 24), AY, _ 16, 16).Select O(i) = Selection.Index MsgBox O(i)　※1 i = i + 1 Loop End If MsgBox O(i)　※2 If CheckBox1.Value = False Then 'チェック無 i = 0 Do Until i = ix ActiveSheet.Shapes.Range(O(i)).Delete　※3 i = i + 1 Loop End If End Sub ↑のようなプログラムを組むと、チェック有の If 終了時 ※2のMsgBox O(i)でO(i)が初期化？されて値が表示されなくなってしまっていま す。 IFの処理中(※1)ではO(i)の値が正常に出力されていたので、 IF終了時に値がなくなっていると思うのですが、 どういった現象が起きているのでしょうか？ また、作成した円を上手く削除するにはどうすれば良いでしょうか？ この形にこだわっているわけではないので、もっといい方法があれば ご教授頂けると幸いです。 どうかよろしくお願いします。
VB.NETで2つの配列の一方を文字列の長い順番に並び替えて 他方の配列もその順番に並び替えたいのですが どのようにすればよろしいでしょうか。 例えば、 A(0)="Japan" A(1)="America" A(2)="People's Republic of China" A(3)="Republic of Korea" A(4)="Democratic People's Republic of Korea" B(0)="Tokyo" B(1)="Washington, D.C." B(2)="Beijing" B(3)="Seoul" B(4)="Pyongyang" という2つの配列があって 配列A()を文字列の長い順番に並び替えると A(0)="Democratic People's Republic of Korea" A(1)="People's Republic of China" A(2)="Republic of Korea" A(3)="America" A(4)="Japan" となりますが、この時配列B()も以下のように 配列A()の順番と同じ順番になってほしいのです。 B(0)="Pyongyang" B(1)="Beijing" B(2)="Seoul" B(3)="Washington, D.C." B(4)="Tokyo" なお、配列A()の並べ替えは以下のようにしていますので できましたら、このコードに追記する感じで 教えていただけるとありがたいです。 よろしくお願いします。 ------------------------------------------------------ Module Module1 Sub Main() Dim A(4) As String Dim B(4) As String A(0) = "Democratic People's Republic of Korea" A(1) = "People's Republic of China" A(2) = "Republic of Korea" A(3) = "America" A(4) = "Japan" B(0) = "Pyongyang" B(1) = "Beijing" B(2) = "Seoul" B(3) = "Washington, D.C." B(4) = "Tokyo" Dim comp As New LengthComparer() Array.Sort(A, comp) For Each s As String In A Console.WriteLine(s) Next End Sub Public Class LengthComparer Implements System.Collections.IComparer Implements System.Collections.Generic.IComparer(Of String) Public Function Compare(ByVal x As String, ByVal y As String) As Integer _ Implements System.Collections.Generic.IComparer(Of String).Compare If y Is Nothing AndAlso x Is Nothing Then Return 0 End If If y Is Nothing Then Return -1 End If If x Is Nothing Then Return 1 End If Return y.Length.CompareTo(x.Length) End Function Public Function Compare(ByVal x As Object, ByVal y As Object) As Integer _ Implements System.Collections.IComparer.Compare If y Is Nothing AndAlso x Is Nothing Then Return 0 End If If y Is Nothing Then Return -1 End If If x Is Nothing Then Return 1 End If If Not (TypeOf y Is String) Then Throw New ArgumentException("String型でない", "y") ElseIf Not (TypeOf x Is String) Then Throw New ArgumentException("String型でない", "x") End If Return Me.Compare(DirectCast(y, String), DirectCast(x, String).Length) End Function End Class End Module ------------------------------------------------------
=(SUMIF(F860:I862,"あああ",I860:I862))-(SUMIF(F860:I862,"いいい",I860:I862)) もともと上記の数式を、変数に変えてvbaで挿入する際 "あああ"ともともとダブルコーテーションでかこまれている部分はどのように指定したらいいでしょうか？ & ","あああ",I " & ここでエラーになります。。。。 .Cells(intRow3, intCell3 + 8) ="=(SUMIF(F"&" S860 " & ":I " & S862 & ","あああ",I " & S860 & ":I" & S862 & "))-(" & SUMIF(F " & S860 & " :I " & S862 & ","いいい",I " & S860 & ":I"& S862 & "))"
の質問です。visual studio 2010を使用しています。ソフトを作成しました。フォームの右上ヘルプ→バージョン情報でバージョンを表示したいのです。以下２つ質問があります。 (1)このバージョンは、setupプロジェクトのプロパティのversionを取得した方がよいのでしょうか？それとも、アプリケーションのアセンブリ情報にあるアセンブリバージョンを取得した方がよいのでしょうか？ (2)現在setupプロジェクトのプロパティのversionには、1.0.0を入力してありますが、作成したsetup.exeにマウスカーソルをかざすと、10.0.30319.1と薄く表示されます。この情報はどこから取得しているのでしょうか？（添付画像をご覧ください。） 御教示いただけると幸いです。
EXCELの関数を使ってシフト表を作成したいのですが、下記の条件により関数やマクロを組むことは可能でしょうか？どなたか教えてください。 ・3～4つのグループよりバランスよくシフトを組みたい。 ・1つのグループには4～6人在籍している。 ・午前と午後に各2人を配置。 ・同一グループでの配置はNG。 条件が多くて申し訳ありませんが、シフトを組むのに毎度難儀をしております。 どなたか教えていただけると助かります。
IEをvb.netから操作しています。 webからファイルのダウンロードを自動で行いたいのですが、どのようにすればいいのかわからず悩んでいます。 画像の赤枠で括ってあるボタンの押下を、vb.netからの操作で行いたいのですが、どのようにすれば良いでしょうか。 InternetExplorer.Applicationに何らかのメンバ関数のようなものがあるのか、sendkeysを使うしかないのか、sendkeysを使うなら、具体的にどのキー操作を送れば良いのかなど、お教えいただけないでしょうか。 よろしくお願いします！
VBAを実行すると、 実行エラー424 オブジェクトが必要です。 となってしまいます。 エラーとなっている行は、 .Document.getElementById("q_d").Value = ActiveSheet.Cells(rowno, 1).Value です。 作成したリストは、以下のようになっています。 Sub MAP住所() Dim objIE As Object, rowno As Integer rowno = 1 Set objIE = CreateObject("InternetExplorer.Application") With objIE 'Google Map起動 .Navigate "http://maps.google.co.jp/" .Visible = True Do While (ActiveSheet.Cells(rowno, 1).Value <> "") 'IE待機 Do While .Busy = True DoEvents Loop '住所をテストボックスへ入力 .Document.getElementById("q_d").Value = ActiveSheet.Cells(rowno, 1).Value '送信ボタンクリック .Document.forms(0).submit '次の行 rowno = rowno + 1 Loop End With Set objIE = Nothing End Sub A列にある住所を読み込んで、グーグルマップに表示するスクリプトになります。 どう直して良いのか、皆目わかりません 御指南願います
サブフォルダとファイルを含むフォルダのプロパティを開くと、 内容欄にファイル数(サブフォルダ内のファイルを含む)とフォルダ数が表示されます。 このファイル数をVBAにて取得する方法を教えて下さい。 特定のフォルダを指定し、そのフォルダ内だけのファイル数取得する方法は、 インターネット上に散見されますが、 サブフォルダ内のファイルを含むファイル数を一発で取得する方法が見つかりません。
最近仕事用のパソコンはＦＡＸ付きコピー機で印刷できるようになりました。 そこでエクセルの印刷設定の中でプリンターを（ＦＡＸ）に変更して、ＦＡＸ先電話番号を指定し送信ボタンを押せばプレビューしているシートをＦＡＸで送信してくれるようにもなりました。 そこで、毎回プリンターを変更して、電話番号を指定するのは大変なのでマクロを作ろうと思ったのですがマクロではＦＡＸ送信が記録されませんでした。 なのでＶＢＡで作るしかないと思ったのですがＶＢＡ素人の私には作ることができません。 どなたかご教授をお願いいたします。 ＯＳ：Ｗｉｎ７ オフィス：エクセル２０１０ プリンタ：DocuCentre-IV C4470(FAX) 電話番号：短縮0006 送信するシート：アクティブシート
vb.netからIEを操作している際、metaタグで自動転送されるページについて、自動転送前のページのhtmlを確実に取得する方法はあるでしょうか。 例えば、http://example.com/index.html のheadに <meta http-equiv="refresh" content="0;URL=http://www.yahoo.co.jp"> と書いてあったとして、このhttp://example.com/index.htmlのhtmlを取得できるかということです。 http://example.com/index.htmlにアクセスした途端に転送されてしまうのでhttp://example.com/index.html自身のhtmlソースを取ることができず、困っています。 ご回答よろしくお願いします！
ＶＢＡにて 変数の先頭がＡ～Ｇまでの文字で始まるものはすべてsingle宣言をしたいのですが 昔使っていた記憶があるのですが忘れてしいました 現在も使用可能であれば宣言方法お教えください。 ex dim A1 as single dim B2 as single dim Ga as single これを ○○○　A～G as single のように宣言したい、 環境 offixe 2010 os windows 7
いったん解決したと思ったのですが、何度もテストしている間にグチャグチャになってしまっていたらしく、再起動してからクリーンな状態で検証するとダメでした。 http://oshiete.goo.ne.jp/qa/8026813.html 申し訳ありませんが、再掲いたします。 Excelのアドインファイルを移動する必要が出てきたのでVBAで移動させようとしています。 VBAは、アドインとは別のExcelファイルにコーディングしています。 アドインファイル名は MyAdd.xla とします。 MyAdd.xla を新フォルダに移動させることはできましたが、参照元の変更がうまくできません。 設定するPCの台数が多いので、自動で処理したいのです。 よろしくお願いします。 AddIns("MyAdd").Installed = False AddIns.Add Filename:= "新フォルダパス\MyAdd.xla" AddIns("MyAdd").Installed = True
ExcelでA1セルに新たに値を入力したときC1セルにA1セルの元の値が貼付けられる。 都度、A1セルに値を入力するたびにC1セルの値も変更されるようにしたいのですが どなたかよろしくお願いします。
Excelの日付B1セルに1～3日後の日付を入力したとき表-2のように基準2行目のAを それぞれ1～3日後（3～5行目）にコピーしたいのですが。表-3は例として1月3日を 入力した際、以前の1月1日がずれその差２を基にコピーを２行ずらしでしたらと 思ったのですが、どなたかVBAコードで良い方法が解る方よろしくお願いします。
Excelのアドインファイルを移動する必要が出てきたのでVBAで移動させようとしています。 VBAは、アドインとは別のExcelファイルにコーディングしています。 アドインファイル名は MyAdd.xla とします。 MyAdd.xla を新フォルダに移動させることはできましたが、参照元の変更がうまくできません。 設定するPCの台数が多いので、自動で処理したいのです。 よろしくお願いします。 AddIns("MyAdd").Installed = False AddIns.Add Filename:= "新フォルダパス\MyAdd.xla" AddIns("MyAdd").Installed = True
(1)ある行のセルを変更したら動くマクロがあります。 　Private Sub Worksheet_Change(ByVal Target As Range) (2)ある行のセルに数値を入れるマクロがあります。 　Private Sub CommandButton_Click() (2)のマクロが動くと(1)がその後に発動して上書きをしてしまうようです。 これを発動させないようにスキップするにはどうしたらいいのでしょうか？
Windows7 64bit＋エクセル2010の環境でVBAからメールの送受信をしたく basp21を使おうと思っているのですが、basp21フリー版は32bitにしか対応 していないようです。 上記環境でVBAからメール送受信するにはどうしたらいいでしょうか。 たぶん、CreateObject("Basp21")　さえできれば、どうにかなると思うのですが、 解決策をご存知のかたがいれば、教えてください！
エクセルVBなのですが、フォームをつくってその中にリストボックスを配置しました。 コマンドボタンで呼び出して、シート内にあるリストから項目を抽出し反復を省略したリストを フォーム内のリストボックスに作りたいのですが。 Private Sub CommandButton1_Click() UserForm1.Show (このあとリスト項目のコード) End Sub コマンドボタンをクリックすると、UserForm1が現れますが、リストの中身は空です。一度Unload meでフォームを終わらせて、２回目クリックするとリストの中身が現れます。 一回目のクリックでエラーは出ません。 一回目のクリックでリストを配置したいのですが、何が問題なんでしょうか？ Excel2003 Windows Xp です。 よろしくご教示下さい。
以下の条件を満たすDBを探しているのですが こういうのは無いのでしょうか？ オラクルとかはインストールさせないと駄目なんですよね。 ・メインで動くのはEXCEL（VBA） ・OSはWINDOWS ・複数のユーザーで同じDBを参照・更新する ・配布先でインストール作業が発生しない 　（もしくは、WINDOWS標準で入ってる機能で対応出来るとか？） わかる方いらっしゃいましたら、宜しくお願いします。
ExcelでB列の個数の少ない順に３個選出しA列ののマッチする氏名をD列に入力したいのですがVBAコードが解る方よろしくお願いします。尚、同個数は氏名入力となります。
動作確認マシーンは、Win7です。 次のURLにあるサンプルを使っています。 http://code.msdn.microsoft.com/windowsdesktop/VB … smtpを"smtp.mail.yahoo.co.jp"とし、サンプルの動作テストをしてみたら、 画像添付のエラーが出ました。 この場合、どう直していったら良いでしょうか。 ご教示下さい。 よろしくお願いします。
VB2008 初心者です Pictureboxの使い方について質問です たとえばですが、レースゲーム（F1とか）で上から視点で見るような物を作りたい場合 （コースも車も単純でdraw・・・で簡単に描けるレベル、特に操作するわけで無く、 決まった動きをします） 1.コースも車もPicturebox1（以下pic1)に描いていく 2.コースはpic1に直接描き、車はpic2,3,4・・・と複数使いpic1の上を移動させるのか 3.コースはpic1でその上全体にpic2を被せてpic2に複数の車を書くような方法 4.その他 どの方法が一般的なのでしょうか 一般的な使いかたを教えてください。 宜しく御願いします
VBAを使ってモデムの再起動を自動化に挑戦しているのですが、Javascriptの別窓で苦戦しています (ノ◇≦。) (1)再起動ページにアクセス (2)ログイン画面表示 (3)再起動ボタンクリック (4)再起動していいか？ボックスが表示されOKをクリック←ココでつまずいています！！ (5)再起動される 流れなのですが、(3)の再起動ボタンをクリックすると、javaascriptで別窓が表示され、OKボタンを押さないと 再起動してくれません。 ↓これをクリックすると <input type='submit' name='UPDATE_BUTTON' id='UPDATE_BUTTON' value='再起動' /> ↓こいつが処理されてうまくいかない。 /* イベントの設定 */ function Init_Event() { gId('reboot_main').onsubmit = function(){ var confmsg = '再起動を行います。\nよろしいですか？\n＜ご注意＞通話中に再起動を行うと通話が切断されます。'; if (false == reboot_enable_check()) { return false; } if( true == confirm(confmsg) ){ SubmitGuard(); return true; } return false; } } 別窓をアクティブにしようと下記の処理をおこなったのですが、反応しません。 タイトルもツールからコピーしたので間違っていないのですが・・・・ 分かる方いらっしゃいましたらご教授ください＞＜ AppActivate "Web ページからのメッセージ", False SendKeys "{ENTER}" ■モデム PR-S300NEファームウェアバージョン　17.37
　 Evaluate()関数を使ってテキスト化されたVBAの数式を処理するプログラムをVB.NETで作成しているのですが、Mid()関数やLen()関数では正しく処理結果が得られるのですが、InStr()関数では-2146826259が返されてうまく処理させることができませんがどうしてなのでしょうか。 もし、InStr()関数がEvaluate()関数で使えないのであれば、Evaluate()関数を使ってInStr()関数と同じような処理をさせたいのですが何かよい方法がありましたら教えてください。できましたらワークシート関数ではなくVBA関数でお願いします。 なお、term02の部分は外部のテキストファイルから読み込んでいますので、プログラム作成時には数式の内容は未定です。よろしくお願いします。 Dim term01 As String Dim term02 As String term02 = "Mid(""ABCDE"",1,2)" term01 = xlApp.Evaluate(term02) MsgBox(term01) 'OK! AB term02 = "InStr(1,""ABCDE"",""D"")" term01 = xlApp.Evaluate(term02) MsgBox(term01) 'NG! -2146826259 term02 = "Application.WorksheetFunction.Find(""D"",""ABCDE"")" term01 = xlApp.Evaluate(term02) MsgBox(term01) 'NG! -2146826259 　
visual studio 2010のvbでソフトを作成しています。（プロではありません。趣味です。）setupプロジェクトで作成するsetup.exeの名前を変更するにはどうすればよろしいのでしょうか？たとえば、abc_setup.exeのようにです。ちなみに、setup.msiの名前を変更することはできました。御教示いただけるとありがたいです。
先日、使用していたエクセルを2003から2007に変更した所、 オブジェクトのテキストが読み込めなくなってしまいました。 マクロの記録なども試したのですが、問題が解決せず 困っています。 原因が分かる方が入らしたら、ぜひとも教えてください。 ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ Sub namae() Dim namae1 As String Dim namae2 As String namae1 = Application.Caller namae2 = ActiveSheet.Shapes(namae1).TextFrame.Characters.Text MsgBox namae2 End Sub
いつもお世話になってます。プログラミング初心者の学生です。 Visual Basic 2010 を使って下の画像のような簡単なチャットプラグラムを作ろうと思ってます。 フォームのデザインは出来ましたがコードは何も書けていません。 TCPを使うことは分かりましたが、MSDNを見ても説明が難しくてあまり理解できません。 1.TCPについて簡単に解説していただけませんか？ 2.参考サイトを教えてください 3.もしよければ、サンプルコードを載せてください　（チャット） プログラミング学んでる学生で、わからないことばかりです。 暇なときでもいいので、回答よろしくお願いします！！
下記方法（条件）でリンク（ハイパーリンクとは違う）の再設定を行いたいと思います。 1.開いているファイルが別の開いていないファイルとリンクをしている。 2.リンクしているファイルは別の2つ以上のファイルが存在する。 3.2つ以上のリンクしているファイルを新しい別のファイルとリンクしたい。 4.Aブック（開いているファイル） 5.B～Dブック（リンクしているファイル） 6.1～3ブック（新しくリンクをしたいファイル） 7.Bブック→1ブック Cブック→2ブック Dブック→3ブック といった具合でリンクの再設定をマクロで行いたいのですがどなたか教えてください。
下記のコードは条件を指定してカウントするものなのですがもう一つ条件を増やしたいのです。 下記のコードに加えてD列にある日付を2010/1/1日～2010/12/31までといった感じで指定したいのです。 重要なポイントなんですが指定して算出したものは日付に関係なくすべての データに算出されているような状態にしたいのです。 例えばデータが20000件あるとしてそのうちの半分が2011年分もう半分が2012年分だとして 日付の条件は2012年の10000件だとすると2011年の条件に入ってない方のデータにも2012年で算出したデータが入力される状態です。 わかりにくいですがお詳しい方ぜひ、助けてください。 よろしくお願いします。 Sub sample() Dim dic As Object Dim lastRow As Long Dim r As Long Dim key As String Set dic = CreateObject("Scripting.Dictionary") 'Dictionaryオブジェクト lastRow = Range("A" & Rows.Count).End(xlUp).Row 'A列最終行 'データ収集 For r = 3 To lastRow '3行目から最終行まで key = Range("A" & r).Value & Chr(0) & Range("Z" & r).Value 'キー値はA列注目行の値+Z列注目行の値(間にchr(0)) If Not dic.exists(key) Then 'キー値が無ければ dic.Add key, 1 'キーを追加して、値(個数)を１に Else '既にキー値があれば dic(key) = dic(key) + 1 'そのキーの値(個数)+1 End If Next '表示 For r = 3 To lastRow '3行目から最終行まで key = Range("A" & r).Value & Chr(0) & "1" '探す値はA列注目行の値+"1"(間にchr(0)) Range("BW" & r).Value = dic(key) 'BW列にその値(個数)を表示 Next End Sub
下記コードでは1行づつ挿入により下段（罫線枠）までずれてしまいます。 範囲内（E8:G15）での値のみ1行づつ開け表-2のように罫線をずらさずにするにはどのようにすれば良いでしょうか。 どなたか解る方よろしくお願いします。 Sub Test() Dim i As Long If TypeName(Selection) <> "Range" Then Exit Sub With Selection For i = .Rows.Count To 2 Step -1 Intersect(.Cells(i, 1).EntireRow, .Columns).Insert xlDown Next End With End Su
エクセルのマクロでプリンタ名を取得しています エクセルの32ビット版と64ビット版で共用できるように下記の記述をしたのですが 32ビット版は問題ないのですが、64版ではエラーが発生します エラーの原因がわかれば教えて下さい Option Explicit 'このEnumprintersとMoveMemoryがWin32 API の宣言です。 #If VBA7 And Win64 Then Type PRINTER_INFO_1 flags As LongPtr pPDescription As LongPtr pName As LongPtr pComment As LongPtr #Else Type PRINTER_INFO_1 flags As Long pPDescription As Long pName As Long pComment As Long End Type #End If Private Const PRINTER_ENUM_LOCAL = &H2 #If VBA7 And Win64 Then Private Declare PtrSafe Function Enumprinters Lib "WINSPOOL.DRV" Alias "EnumPrintersA" _ (ByVal flags As LongPtr, ByVal Name As String, ByVal Level As LongPtr, pPrinterEnum As Any, _ ByVal cdBuf As LongPtr, pcbNeeded As LongPtr, pcReturned As LongPtr) As Long Private Declare PtrSafe Sub MoveMemory Lib "KERNEL32" Alias "RtlMoveMemory" _ (Dest As Any, Source As Any, ByVal length&) #Else Private Declare Function Enumprinters Lib "WINSPOOL.DRV" Alias "EnumPrintersA" _ (ByVal flags As Long, ByVal Name As String, ByVal Level As Long, pPrinterEnum As Any, _ ByVal cdBuf As Long, pcbNeeded As Long, pcReturned As Long) As Long Private Declare Sub MoveMemory Lib "KERNEL32" Alias "RtlMoveMemory" _ (Dest As Any, Source As Any, ByVal length&) #End If
始めまして。 今、「Visual Basic」でプログラムを作っています。 『ボタンを押したらボタンに登録したテキスト（文字）を出力するプログラム』 を組みたいのですが、どの関数を使えばいいのかがわかりません。 （ボタンの配置は流石にできました） 使用するべき関数などを教えていただけないでしょうか？ 可能ならば、関数の調べ方なども教えていただけると大変助かります。
Format(Date, "dd")の数値表記と Right("0" & day(Date), 2)の数値表記が 違うものとして認識されるようです。 （例　ピボットテーブルで同じ”11”が2つ存在する） 手動で数値を入れたときや 強制的に月初”01”を入れたいときに Formatで表記したものと同じ状態にしたいです。
フォームの切り替え時に 同じマクロを使いたく（機能は同じなので） MultiPage1が1枚目の時と2枚目の時で 入力するコンボボックスを変えておこうとしたのですが エラーで動かないようです。 If MultiPage1.Value = 0 Then COMBX = "ComboBox1" ElseIf MultiPage1.Value = 1 Then COMBX = "ComboBox7" End If name = "シート名" Set ws = ThisWorkbook.Worksheets(name) i = 2 Do Until ws.Cells(i, 9) = "" COMBX.AddItem ws.Cells(i, 9).Value　**********ここでエラー i = i + 1 Loop
Access 2007　VBAの質問です。 win7 home premium 64bit です 　 CopyFile "D:\1.csv","D:\2.csv"とすると、パスが無効ですとエラーが出ます。 CopyFile "D:\1.csv","D:\sub\2.csv"にすれば、成功します。 Dドライブ直下に作成できないのでしょうか。また、直下に作成するにはどうすればよいのでしょうか。 どなたかご教授お願いします。
Range("A" & X).Value = Year(Date) Range("B" & X).Value = Right("0" & Month(Date), 2) このVBAでは セルの書式指定で文字列にしても 文字列の指定を外すと数値に戻ります。 でも、文字列の設定を外したら 数値に戻らないものもあり ピボットテーブルで集計した時に 同じ「2013」が2種類存在してしまいます。 どうしたらいいですか？
ユーザーフォームのチェックボックスでチェックされたCaption文字をExcelシート範囲(B2:B9)の入力されている文字の最後尾から続けて入力したいのですがどなたかコードが解る方よろしくお願いします。
EXCELのVBAです。 　オートフィルタ(Autofilter)で、何らかの条件で抽出をかけた後の部分で、 特定のセル、例えば、２列目の上から５番目のセル、を選択するには、 どうすれば良いでしょう？ 　言い方を変えれば、可視セルの中だけで、何列目で何行目セルという指定 をするにはどうすれば良いかと。 　RangeとかSelectionで、指定する方法が有るのでしょうか？ よろしくお願いいたします。
Ｅｘｃｅｌ2007でマクロ作成中の初心者です。 最後のシートの列に　　　　　　　Ｃ2　　　　　　　　　　　　Ｄ2　　　　　　　　　　Ｅ2　　　　　　　　　 　　　　　　　　　　　　　　＝'東京太郎'!$AS$2　　＝'横浜太郎'!$AS$2　＝'名古屋太郎'!$AS$2　 　　　　　　　　　　　　　　　　　　　Ｃ3　　　　　　　　　　　　Ｄ3　　　　　　　　　　Ｅ3　　　　　　　　　 　　　　　　　　　　　　　　＝'東京太郎'!$ＡＺ$8　　＝'横浜太郎'!$ＡＺ$8　＝'名古屋太郎'!$ＡＺ$8　 の関数がはいってます。一番左のシート名は東京太郎、次のシートは横浜太郎・・と続きます そしてシートのセル値は　Ｃ列からはじめます。 今、シートが追加されたら、手入力で上の式をひとつひとつ、あたらしい列に書き込んでいます。 本当に面倒です。最初から入れておいて、シート名の文字列がどう変わっても、列にそのシートの セルの値が表示されるようにしたいです。またシートが削除されても、シート順にセル表示したいです。なんだか説明がへたですけど、よろしくお願いします。どうかお助けください。
エクセルｖｂａなのですが Sub test() ' 配列 Dim arr() As Integer= {0, 1, 2, 3, 4, 5} ' 抜き出した要素を格納するための変数 Dim i As Integer ' すべての要素について繰り返す For Each i In arr Console.WriteLine (i) Next End Sub これって何でエラーになるのでしょう？ Dim arr() As Integer= {0, 1, 2, 3, 4, 5} でエラーになりますが、なぜだかわかりません。
　住所録を作成していますが、リストを選択しない場合10のテキストボックスで入力し 登録ボタンで指定範囲(P6:Y26)に入力するようにしていますがどうしても一番最初の行 に登録されてしまいます。リストボックスで行を選択すると登録＆更新は可能ですが。 御指導願えませんでしょうか？(尚、リストボックスにはRowSource(P6:Y26)で表示し ています。) Windows7・SP1 Office2010 Private Sub CommandButton2_Click() Application.ScreenUpdating = False Application.Calculation = xlCalculationManual If fullname.Text = "" Then MsgBox "登録すべき内容がありません！", vbExclamation, "確認" Exit Sub End If Dim 選択行 As Integer Dim i As Integer If ListBox1.ListIndex = -1 Then 'リストが選択していなかったら(最初の行に登録される) i = Range("P65536").End(xlUp).Offset(1).Row Range("P" & i).Value = i - 5 Range("Q" & i).Value = fullname.Text Range("R" & i).Value = employeenumber.Text Range("S" & i).Value = fromaltitle.Text Range("T" & i).Value = company.Text Range("U" & i).Value = birthdate.Text Range("V" & i).Value = postalcode.Text Range("W" & i).Value = address.Text Range("X" & i).Value = tel.Text Range("Y" & i).Value = mobilephonenumber.Text Else i = ListBox1.ListIndex + 6 Range("P" & i).Value = i - 5 Range("Q" & i).Value = fullname.Text Range("R" & i).Value = employeenumber.Text Range("S" & i).Value = fromaltitle.Text Range("T" & i).Value = company.Text Range("U" & i).Value = birthdate.Text Range("V" & i).Value = postalcode.Text Range("W" & i).Value = address.Text Range("X" & i).Value = tel.Text Range("Y" & i).Value = mobilephonenumber.Text End If 'データをクリア With TextBox fullname.Text = "" employeenumber.Text = "" fromaltitle.Text = "" company.Text = "" birthdate.Text = "" postalcode.Text = "" address.Text = "" tel.Text = "" mobilephonenumber.Text = "" End With Application.ScreenUpdating = True Application.Calculation = xlCalculationAutomatic End Sub
住所編集のマクロを組んでいます。ハイフンをいれたいです。 データ住所にはハイフンが入っておらずかわりに半角スペースが入っています。 本来ハイフンがないであろう場所にも半角スペース入っている場合も有り。 データ例※●○◎は文字です。数字は伏せていません。 ●●●市●●区●●● ３丁目 ８ ９ ●●マンション ○○市 ○○○区○○５丁目１５ ２０ ◎◎◎市 ◎◎◎◎ ６丁目 ４５ ◎◎◎◎マンション スペースをハイフンにする置換をマクロで記録しました。 ●●●市●●区●●●-３丁目-８-９-●●マンション ○○市-○○○区○○５丁目１５-２０ ◎◎◎市-◎◎◎◎-６丁目-４５-◎◎◎◎マンション 当然ですが、文字列と文字列の間や 数字と文字列の間にもハイフンが入ってしまいます。 そこで皆様よりお力添えをお願いしたいのですが、 数字と数字の間のみハイフンをいれることは可能でしょうか？ 住所件数は不定期です。 上記例はA列に3行 1行目は項目なので合計で4行あると過程します。 勝手申し上げますが納期が迫っておりお返事急いでおります。 どなたかお力をお貸しください！ よろしくお願いします。
VisualStudio2005でUSB機器と通信するソフトを作製して、インストーラも作製しています。 インストーラで、DLLなども一緒にインストールできたのですが、USBドライバを自動的にインストールさせる方法がわかりません。 現在は、USB機器を繋いでから、デバイスマネージャからドライバを手動でインストールしなければいけません。 市販のソフトでインストール時に同時にドライバもインストールするものもありますが、そういうインストーラの作成はVisualStudioでもできるのでしょうか？ USBドライバはFTDIの物でftd2xx.sys、ftd2xx.infです。 よろしくお願いします。
http://www.ken3.org/cgi-bin/group/vba_outlook.asp を参考に Sub Sample() Dim oApp As Outlook.Application Dim myNameSpace As Outlook.Namespace Dim myFolder As Outlook.Folder 'outlook 起動をCreateObjectで ※これだと複数起動してしまうがご勘弁を Set oApp = CreateObject("Outlook.Application") Set myNameSpace = oApp.GetNamespace("MAPI") '作業フォルダーの指定(.GetDefaultFolder) と 表示(.Display) Set myFolder = myNameSpace.GetDefaultFolder(6) '規定のフォルダー olFolderInbox=6 指定 myFolder.display End Sub でエクセルからアウトルックを起動しているのですが 既に起動していると２個起動してしまいます。 「既に起動しているのなら起動しない」という事はできますか？ 参考URLに 起動をCreateObjectで ※これだと複数起動してしまうがご勘弁を と書いてありますが、ちょっと勘弁できませんでした笑
　図形を二行三列で一枡とし図形を貼り付けていますが、どうしても実行時エラー 「1004」が出て図形のクリアができません。(尚、四角形は枠線上にあります。) 対処法がありましたらお願いします。 Windows7・SP1 Office2010 Sub 図形の貼付け() Dim i As Integer Dim j As Integer For i = 10 To 43 Step 2 For j = 9 To 99 Step 3 Select Case Cells(i, j).Value Case 1: ActiveSheet.Shapes("四角形1").Select Selection.Copy Cells(i + 1, j + 1).Select ActiveSheet.Paste Case 2: ActiveSheet.Shapes("四角形2").Select Selection.Copy Cells(i + 1, j).Select ActiveSheet.Paste Case 4: ActiveSheet.Shapes("四角形3").Select Selection.Copy Cells(i + 1, j + 1).Select ActiveSheet.Paste Case 5: ActiveSheet.Shapes("四角形3").Select Selection.Copy Cells(i + 1, j + 2).Select ActiveSheet.Paste Case 6: ActiveSheet.Shapes("円1").Select Selection.Copy Cells(i, j).Select ActiveSheet.Paste End Select Next Next End Select End　Sub Sub 図形のクリア() Dim myRng As Range Set myRng = Range("I10:CW43") Dim n As Integer, sp As Variant For n = ActiveSheet.Shapes.Count To 1 Step -1 Set sp = ActiveSheet.Shapes(n) If Not Intersect(Range(sp.TopLeftCell, sp.BottomRightCell), myRng) Is Nothing 　(ここで実行時エラー1004になります。) Then sp.Delete End If Next Set myRng = Nothing End Sub
どちらかのA1の値を入力しEnterキーを押したあとに下記の処理を自動実行するには どうしたら良いでしょうか？　お教え願えませんでしょうか。 Windows7・SP1 Office2010 Option Explicit(標準モジュールに書いてあります。) Private Flg As Boolean Sub 処理() If Flg Then Exit Sub Application.OnTime Now + TimeValue("00:00:05"), "処理" If Flg Then Exit Sub If Worksheets("メイン・1").Range("A1") <> Worksheets("祝祭日").Range("A1") Then MsgBox ("祝祭日の日付を反映させるために年度を同じにしてください。") Else: Exit Sub End If(中断モードで実行することはできません。)ここで止まります。 End Sub Sub ストップ() Flg = True End Sub
Excelでタイマーを作ったけど、一時停止できないとやっぱ面白くないと気づき、一時停止機能を付け加えたいが、まだ勉強し始めたばかりなので自分でコードが書けません。 なので、一時停止させるコードがわかる方教えてください。 ＜タイマーのコード＞ Sub タイマー() Dim EndTime Dim PassTime EndTime = Timer + Range("D5").Value * 60 + Range("F5").Value Do PassTime = Timer Range("D5").Value = (EndTime - PassTime) \ 60 '分 Range("F5").Value = (EndTime - PassTime) Mod 60 '秒 DoEvents Loop Until EndTime - PassTime <= 0 Beep MsgBox "時間です" End Sub
VBAでInternet Exploreを操作するときによく出てくるコードで、LocationURL と　URLの違いについて教えてください。 　また、現在開いているページのURLを取得するには、ObjIE.LoactinURLとObjIE.Document.URL のどちらを使うのが正しいのですか？ 　よろしくお願いします。
ｖｂのビルドをしたら ========== ビルド: 0 正常終了、0 失敗、1 更新不要、0 スキップ ========== という結果が返ってきたのですが、 1 更新不要はどういう意味なのでしょうか？ エラーではないのでしょうか？
アウトルックvbaでこれを実行すると Sub test() Dim requestsFolder As MAPIFolder Dim appNameSpace As NameSpace Set appNameSpace = Application.GetNamepace("MAPI") Set requestsFolder = appNameSpace.GetDfaultFolder(olFolderInbox) End Sub 「実行時エラー'438': オブジェクトは、このプロパティまたはメソッドをサポートしていません」 が出るのですが、何がおかしいのでしょうか？まったくわかりません。
私はめんどくさがりやで、VBAを覚えたいのですが 一度使ったコードはメモ帳に書き溜めて、 同じようなコードを作るときにその書き溜めたものを探して、コピペしてアレンジしてしまうのですが この方法じゃいつまでたっても上達しないでしょうか？ 本気で学習しようとするなら、 同じようなコードでもコードを一から書いたほうがいいですか？
エクセルで次の式を作ってみました。表示対象はK15のセルです。 =IF(K14="","",IF(AND(K13="○",K14<=0.00000001),"Ａ", IF(AND(K13="○",K14>=0.00000001,K14<=0.0000099),"Ｂ", IF(AND(K13="△",K14>=0.00000001,K14<=0.0000099),"Ｄ", IF(AND(K13="○",K14>=0.00001,K14<=0.0002),"Ｃ", IF(AND(K13="○",K14>=0.0002,K14<=0.099),"Ｄ", IF(AND(K13="△",K14>=0.0002,K14<=0.077),"Ｄ", IF(K13="×","Ｅ","Ｄ"))))))))　　この数式をVBAで記述したいのですが、どなたか教えてください。 希望１　K13,14の値を変更するたびに反映されるようにしたいと思っております。 希望２　K～Mまでの範囲も指定したいです。 宜しくお願いします。
　G2に=DATE(C1,G1,1)で日付を取得し和暦表示で「H25年03月」とセルの書式設定で しているのですが、これをMsgBoxに同じように表示させたいのですが、お教え願えま せんでしょうか。 Windows7 Office2010 Dim ret As Integer ret = MsgBox(ActiveSheet.Range("G2").Value & "の勤務割表を編集データを元に作成します。よろしいですか?", _ vbOKCancel + vbQuestion, "作成") Select Case ret Case vbOK 処理のコード文 Case vbOKCancel Exit Sub End Select
Windwos7環境ですが、ファイルサーバー上のフォントファイルを端末にコピーしようとすると、 OSがファイルをつかんでいてコピーができません。 XPでは外字クライアントの停止・起動で、しばらくの間、OSがファイルをはなしてくれたよう？ でコピーができたのですが。 ネット上では、enableEUDC関数の設定で、フォントファイルがコピーできると記述があるのですが、 VBスクリプトで、どのように実現すればよいかわかりません。 端末にはエクセルがインストールされているので、ExcelVBA経由でGDI32.DLLを呼び出すのが もっともシンプルかなと思いました。 ほとんどシロウトの私ですが、みなさまのご指導をお願いします。
標準モジュールにFunctionプロシージャーを作ったのですが、 警告1 関数 'プロシージャー名' には値を返さないコード パスがあります。 実行時に結果が使用されると、null 参照の例外が発生する可能性があります。 という警告が出るのですが、 値を返さないコード パスがどのことを指してるのかわかりません。 Function test() test = "aaa" End Function のように値が返るようにしています。 コードが長すぎてここに記載できないのですが、 値が返るようにしているのに、なぜこのエラーが出てしまうのでしょうか？
ｖｂ2010の時は、ソリューションエクスプローラーで参照設定フォルダがあり、 そこを開くと参照設定されている一覧が見れたのですが、 ｖｂ2012では参照設定フォルダが見当たりません。 見れないのでしょうか？
図のようにランダムに数値が並んでいるデータが約600行くらいあります。その各行にA列を除く列で、数値の小さい順に並べるVBAのようなものがあればと思って質問させていただきました。 詳しい方からのアドバイスをいただけますと幸いです。よろしくお願いします。
　二行三列を一枡として月の勤務割表を作成しています。マクロで同じ事を しているのにMacro1の方が実行しません。お教え願えませんでしょうか。 (尚、図形を枠線上にコピペしています。) Sub Macro1()実行しません。 Dim i As Integer Dim j As Integer For i = 10 To 43 Step 2 For j = 10 To 103 Step 3 Select Case Cells(i, j).Value Case 1: ActiveSheet.Shapes("四角形1").Select Selection.Copy Cells(i + 1, j + 1).Select ActiveSheet.Paste End Select Next Next End Sub Sub Macro2()実行します。 ActiveSheet.Shapes.Range(Array("四角形1")).Select Selection.Copy Range("J11:K11").Select ActiveSheet.Paste End Sub
vb.netで System.Diagnostics.Process.Start("CMD.exe") で子マントプロンプトを起動することができるのですが 最初のディレクトリが C:\Users\ユーザー名\Documents\Visual Studio 2012\Projects\フォーム名\フォーム名\bin\Debug> になってしまいます。 そこからcdで指定のディレクトリへ移動するのですが、 vbコードでディレクトリを指定することはできますか？ 例えば、C:\Usersというディレクトリをデフォルトで開きたい場合、 コードで指定する方法があれば教えてください。
画面に線を引くプログラムですが、実行する時により、線が引かれるスピードが違います。 パソコンを起動直後などは、結構早く動くのですが、デバッグ後は遅くなります。再起動後は、デバッグ前のように結構早く動きます。 何か対策はありませんでしょうか
Winsockをサーバとクライアントで動かして送受信についてです。 サーバでSendDataで送信、クライアントでGetDataの所です。 サーバーでSendDataを数回送信するとクライアントのGetDataではある程度まとめて受信します。 (1)サーバ側で送信 　　　Winsock.SendData "aaaaa" 　　　Winsock.SendData "bbbbb" 　　　Winsock.SendData "ccccc" 　　　Winsock.SendData "ddddd" (2)クライアントで受信 　　　Winsock.GetData xyz (1)のように送信した場合、(2)のxyzは 　　　・aaaaabbbbbcc 　　　・cccddddd のように数回に分けて受信されます。 希望としましては、１データ送信に対して１データ受信が望ましいのですが。 実際のデータには全角はある為、このような希望となりました。 もしかして、不可能なのでしょうか。 わかる方、教えて下さい。
任意のフォルダ内におけるフォルダ個数をExcel VBAで計算したいのですが、 （例） C:\フォルダ個数\Aa001 C:\フォルダ個数\Ai002 C:\フォルダ個数\Au003 ・・・・・・ C→「フォルダ個数」フォルダ内に、任意のフォルダ（都度変わる）が複数存在し、 任意のフォルダ内（上記例ではAa001,Ai002,Au003）にあるフォルダ数をExcelに出力したい。 ＜出力結果Excel（例）＞ A列　　　B列 Aa001　　10 Ai002　　　5 Au003　　 2 ※A列に任意のフォルダ名、B列に任意フォルダ名内のフォルダ個数 ※シート名は、「フォルダ数」とした場合 以上お手数おかけいたしますが、ご教授の程よろしくお願いいたします。
現在ＶＢ2010で作成中のアプリと測定器のデーターをシリアル通信で記録採取したと考えています。 測定機からの通信が下記の通りにＰＣに送られてきますが、必要な部分の採取す方法が分かりませんので教えてください。 ハイパーターミナルでの測定器からの文字受信は１2文字送られてきます。 ＶＢで作成中のアプリでは５文字目から９文字目のみをテキストに表示したいと思いますが、分かる方教えてください。現在制作中のソースも一部表示しますので、よろしくお願いします。今年から勉強してる、初心者です。 Delegate Sub AddDataDelegate(ByVal str As String) Private Sub AddData(ByVal str As String) '受信データー表示' If SerialPort1.IsOpen = False Then 'シリアルポートをオープンしていないときは、処理しない Return End If '受信データー読み込み Dim data As String data = SerialPort1.ReadExisting() 　　 上記のソースが受信するようにしていますが、受信データーは１ｓ毎に更新されておりますその都度テキストへ表示するようにしたいと思います。データーが更新されても、数値は残るようにしたいと思います。
こんばんは エクセル2010VBAで、シート見出しが青色で、そのシートのセル（L15、L21、L27・・・L45）と（P15、P21、P27・・・P45）の値を集計用紙にB2とC2の列に貼り付けるにはどうしたらよいのでしょうか？ 色々な名前でシート見出しが作られており、唯一、目的シートが青色で分別されています。 見出し色指定のコードの作り方が、わかりません。 宜しくお願い致します。
表-1に記号入力された氏名と表-2の氏名がマッチしたB列に入力個数番号を記載したいのですがどなたかVBAコードが解る方よろしくお願いします。
マーク(●、▼)の付いた氏名を入力ボタンクリックで下欄のA～CセルにVBAのコードを使って入力したいのですが、また1ヶ所マークを外し再度クリックした場合入力された値が消えるように、どなたかわかる方よろしくお願いします。
Excelのボタンクリックで下記コードにより上表のイニシャルがセル"B11:E13"に入力されるが下表の数字"B15"を消した場合、再度クリックしても入力されたイニシャルが消えないどんなコード入力をすれば良いのかどなたか解る方よろしくお願いします。 Sub 入力() Dim i As Long, j As Long On Error Resume Next For j = 2 To 5 For i = 1 To 3 Cells(i + 10, j) = WorksheetFunction.Index(Range("A1:A9"), WorksheetFunction.Match _ (i, Range(Cells(15, j), Cells(23, j)), False)) Next i Next j End Sub
Excel2010を使っています。「何月何日に誰がどこへ行ったのか」がわかる表を作ろうとしていますが、うまく作れません。 Sheet1に以下のようなデータを作り、 　　　　　 鈴木　山田　田中 4月1日　新宿　新宿　横浜 4月2日　新宿　横浜　横浜 4月3日　新宿　渋谷　新宿 Sheet2のA1に「新宿」と入力したら、Sheet1を参照して、 新宿　　4月1日　4月2日　4月3日 鈴木　　 　1.0　　　　1.0　　　　1.0 山田　　 　1.0 田中　　　　　　　　　　　　　　　1.0 と出力されるようにしたいのです。 http://oshiete.goo.ne.jp/qa/5829569.html?&status … を参考に、 INDIRECT、SMALL、ROW等の関数を使ってやってみましたが、うまくいきません。 できれば、ピボットテーブル、関数を使って作りたいです。 無理ならば、VBAを考えています。 どなたか詳しい方がいれば教えてください。よろしくお願いします。
独学でVB2010Expressを使用しています。 あるCSVからADOを使用してデータを取得し、Accessに転載しているのですが、そのデータで日付と時間のフィールドがあるのですが各々以下のような表示（『2012/04/02』の場合→『20120402』、『12：32：50』の場合→『123250』）なので逆の変換をした上で『2012/04/02 12：32：50』とAccessに格納したいのですが『StringからDoubleに変換できません』的なエラーが出てしまします？（全部String型のつもりなんですが） 色々調べたのですが、うまくいきません。ご教授お願いします。 下記のコードはデータテーブル（DT）に変換前の『日』・『時刻』値をを格納したものを使用しています。 iはFOR　NEXTでループさせています。 OleCmd.Parameters.Add("@DateTime", SqlDbType.Date).Value OleCmd.Parameters("@DateTime").Value = Date.Parse(CInt(DT.Rows(i)("日")).ToString("0000/00/00")) + " " + CInt(DT.Rows(i)("時刻")) \ 10000 + ":" + (CInt(DT.Rows(i)("時刻")) Mod 10000) \ 100.ToString("00") + ":" + (CInt(DT.Rows(i)("時刻")) Mod 10000) Mod 100.ToString("00")
最近プログラミングの学習が行き詰っています。（Visual BasicとExcel VBAをやっています。いずれはC++も勉強するつもりです） 理由は、本のコードを丸写ししてばっかりで、いつになったら本なしでオリジナルのコードが書けるようになるんだと考えるようになったからです。 プログラミングをどういう手順で学習していけばよいですか？今は本を借りて真似をしているだけです。 もう一つ聞きたいのは、1つのプログラミング言語をマスターする上で覚えなくてはならないのはどんなことですか？あと、どのくらいの時間を費やして勉強すればよいですか？（まだ中2です）
VBAの場合、他のアプリケーションを参照する場合は、 参照設定でMicrosoft Excel xxx Object Library にチェックを付ければ良いだけだけど、 vb.netの場合は、 参照設定で、Microsoft Excel xxx ObjectLibrary にチェックを付けた上で、更に Imports Microsoft.Office.Interop の宣言をしないといけないのですか？ （例はエクセルです） Imports Microsoft.Office.Interop をし忘れると、 [型 'Excel.Workbook' が定義されていません。] と言うエラーが発生します。
ＶＢＡのフォーム上のコントロールをクリックして WebBrowserコントロールを起動しているのですが 画像のような画面がたまに表示されます。 **************************************************** このドキュメントには、コンピューターに害を及ぼす可能性のある埋め込みコンテンツが含まれます。 以下のオプションから１つを選択してください。 コンテンツの再生を許可しません（推奨） このコンテンツを認識します。再生を許可します。 **************************************************** 多分、Navigateするタイミングだと思います。 表示する（Navigateする）サイトは教えてgooなどです。 毎回「このコンテンツを認識します。再生を許可します。」 を選択してるのですが、 面倒なので
UserForm.showでフォームがでたときマルチページ１～４のうちページ１を見出しに表示したいのですが どなたか解る方よろしくお願いします。
VBA初心者です。仕事で使いたいのですが、やり方がわからないので教えてください！ A1セル 5650590 A16セル 5150950 15行おきに数字が３０００行まで入っています。A1セルをコピーし、A2～A15に貼付。 A16セルをコピーしてA17～A31に貼付。 ↑この作業を繰り返したいのですが、VBAの書き方がわかりません。 よろしくお願いいたします。
12バイトのHEX文字列(FFFFFFFFFFFFFFFFFFFFFFFF)などを をいったん、10進に変換し、DOUBLE型の変数に設定し、 数値演算を行い 再度HEX文字列（FFFFFFFFFFFFFFFFFFFFFFFF)に変換を行いたいのですが、 変換の方法がわからず困っています。 HEX関数はLONGでしかおこなえないようで・・ すみませんが、ご教授いただけると助かります。 宜しくお願いいたします。
【Sheet1】 発注日 　 品番 　　 ロットNo 　　　　　納品日 　　A　　　　 B　　　　　　C　　　　　　　　　　D 1　3/11　　553　　111-111-1111　　　3/17 2　3/11　　123　　222-222-2222 3　3/11　　223　　333-333-3333 4　3/12　　123　　444-444-4444　　　3/17 5　3/12　　553　　555-555-5555 【Sheet2】 　納品日　　品番 　 ロットNo 　　　A　　　　B　　　　　C 1 　3/17　　553　 111-111-1111 2 　3/17　　123 　444-444-4444 3　 3/17　　223 　666-666-6666 エクセル2010・VBAで、【Sheet2】の品番とロットNoの条件に合う行を【Sheet1】より探し、【Sheet1】D列に納品日を入力し、その行のロットNoを明るい緑で塗りつぶす。 【Sheet2】の条件が【Sheet1】にないなら【Sheet2】の行のロットNoを、赤で塗りつぶす。 【Sheet1】は発注リスト、【Sheet2】は納品リストになります。 納品日は検索した日の日付になります。 Findを使い試行錯誤しましたが、思うように動かず、スキル不足で困っています。どなたか、ご教授願います。宜しくお願い致します。
Windows7　Excel2007でマクロ作成中の初心者です。 やりたいことは、リストボックスからシートを選択し、そのシートを削除する。 削除したら、リストボックスの中の、シート選択状態を解除し、その項目だけを 削除することです。 以下のコードで出来たのですが、これを統合して一個のコードにしたいです。 どうしたらよろしいでしょうか。 Private Sub 顧客削除_Click() Dim i As Integer Dim btn Dim name As String With 顧客リスト For i = 0 To .ListCount - 1 If .Selected(i) Then name = .list(i) '選択されたリストを変数に格納 btn = MsgBox("本当に、 " & name & " さんを削除していいですか？", _ vbYesNo, "削除の確認") If btn = vbYes Then Application.DisplayAlerts = False Worksheets(Mid(.list(.ListIndex - 0), InStr(.list(.ListIndex - 0), " ") + 1)).Delete Application.DisplayAlerts = True リストボックスの項目削除 End If End If Next i Worksheets(1).Activate End With ActiveWorkbook.Save Application.ScreenUpdating = True End Sub ----------------------------- Sub リストボックスの項目削除() Dim i As Integer For i = 顧客リスト.ListCount - 1 To 0 Step -1 If 顧客リスト.Selected(i) Then 顧客リスト.RemoveItem (i) Exit For End If Next i End Sub
data.txtにセルの入力内容を出力したくて下記のようなプログラムを書きました。 ところが　Open StrFN For Output As #IntFlNo　のところで パスが見つかりません というエラーが出てしまいます。原因はわかりますでしょうか。 Sub test() Dim StrFN As String Dim i As Long Dim IntFlNo As Integer StrFN = "c\data.txt" IntFlNo = FreeFile Open StrFN For Output As #IntFlNo For i = 2 To 400000 Write #IntFlNo, Cells(i, 1) & "$" & Cells(i, 2) Next i Close #IntFlNo End Sub
Windows7 Excel2007でマクロ作成中の初心者です。 リストボックスから、シート(顧客名）を選んで削除するマクロです。 削除がうまくいくのですが、「いいえボタン」を押しても シートが削除されてしまいます。どう修正したらよろしいでしょうか。 Private Sub 顧客削除_Click() Dim i As Integer Dim btn Dim name As String With 顧客リスト For i = 0 To .ListCount - 1 If .Selected(i) Then name = .list(i) '選択されたリストを変数に格納 btn = MsgBox("本当に、 " & name & " さんを削除していいですか？", _ vbYesNo, "削除の確認") End If Next i Application.DisplayAlerts = False Worksheets(Mid(.list(.ListIndex - 0), InStr(.list(.ListIndex - 0), " ") + 1)).Delete Application.DisplayAlerts = True '顧客リスト.RemoveItem (顧客リスト.ListIndex) '顧客リスト.ListIndex = -1 リストボックスの項目削除 Worksheets(1).Activate End With If btn = vbYesNo Then Exit Sub End If ActiveWorkbook.Save End Sub ----------------------------------------------- Sub リストボックスの項目削除() Dim i As Integer For i = 顧客リスト.ListCount - 1 To 0 Step -1 If 顧客リスト.Selected(i) Then 顧客リスト.RemoveItem (i) Exit For End If Next i End Sub
ExcelでINDEX関数とMATCH関数で"B11:E13"セルに以下の数式データがあります。 数式は "B11"=IF(ISERROR(INDEX($A$1:$A$9,MATCH(1,B$15:B$23,0))),"",INDEX($A$1:$A$9,MATCH(1,B$15:B$23,0))) "B12"=IF(ISERROR(INDEX($A$1:$A$9,MATCH(2,B$15:B$23,0))),"",INDEX($A$1:$A$9,MATCH(2,B$15:B$23,0))) "B13"=IF(ISERROR(INDEX($A$1:$A$9,MATCH(3,B$15:B$23,0))),"",INDEX($A$1:$A$9,MATCH(3,B$15:B$23,0))) "C11"==IF(ISERROR(INDEX($A$1:$A$9,MATCH(1,C$15:C$23,0))),"",INDEX($A$1:$A$9,MATCH(1,C$15:C$23,0))) "B15～B23"に数値1～3を入力した場合イニシャルA～I が入力される式ですが、列を連続で入力できるような処理をVBAのWorksheetFunctionで行うにはどのようにコードを記述すればよいのでしょうか。 ご回答のほどよろしくお願いします。
学生で、visual basic を勉強しているものです Button1をクリックするとスクリーンショットを１秒ごとに撮り、 "c:\iMonitoring"に保存するというプログラムを書いています （Button2をクリックすると止まる） 写真の名前を撮った時刻にしたいのですがエラーが出てうまくいきません どうしていいか分からばいので教えてください (コードです) ********************************************************************************* Public Class Form1 Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load Timer1.Enabled = False System.IO.Directory.CreateDirectory("C:\iMonitoring") End Sub Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Timer1.Enabled = True End Sub Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click Timer1.Enabled = False End Sub Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick Dim x As String = Now().ToString() Dim a As String = "C:\iMonitoring\" Dim b As String = ".bmp" Dim y As String = (a & x & b) 'Imports System.Drawing 'Imports System.Windows.Forms 'Bitmapの作成 Dim bmp As New Bitmap(Screen.PrimaryScreen.Bounds.Width, _ Screen.PrimaryScreen.Bounds.Height) 'Graphicsの作成 Dim g As Graphics = Graphics.FromImage(bmp) '画面全体をコピーする g.CopyFromScreen(New Point(0, 0), New Point(0, 0), bmp.Size) '解放 g.Dispose() '保存 bmp.Save(y) End Sub End Class
Excelのチェックボタンをクリックしたときにシート１のセル"C4:G50"内に条件付書式により着色（ColorIndex =7）されたセルがあった場合、エラーメッセージ（"　ヶ所　日付が入力されていません"）を表示したいのですが？ 下記のコードでセルに直接着色（"C7"）されたものは添付のようにメッセージが出たのですが条件付書式による着色がカウントしメッセージが出るようにしたいのですが、コード表示が解る方どうかよろしくお願いします。 尚、C列とG列のみ50行まで条件下で着色するよう同じ条件付書式が入っています。 Sub チェック() Dim CheckRange As Range Dim rng As Range Dim cnt As Long Set CheckRange = Range("C4:G50") For Each rng In CheckRange If rng.Interior.ColorIndex = 7 Then cnt = cnt + 1 End If Next If cnt > 0 Then MsgBox cnt & "ヶ所、日付が入力されていません。", vbCritical Exit Sub End If Worksheets("sheet1").Range("D1") = "1" End Sub
vb.netの事でしょうか？ ｖｂ6.0の事でしょうか？ 「vb」と聞いただけで何を想像しますか？
はじめまして。 現在ASP.net　でweb画面を作成していますが、動的に作成したコントロールの削除が不規則な動きをしており困り果ててこちらにきました。よろしくお願いします。 配置してあるテーブルに行だけを動的に追加しており その行には、テキストボックスと削除ボタンが含まれています。 不規則な動きというのは、以下になります。 1行目の削除ボタンを押す→1行目が消える 1行目になった削除ボタンを押す→変化なし 1行目の削除ボタンを押す→末尾の行が消える という状態です。デバッグで確認すると、 Removeで消しているコントロールIDは確かに1行目のものなのに、 画面が開くとそれが残っているという現象です。 そしてなぜ末尾が途中から消されていくのかは分かりません。 もしかして思うのは、毎回Loadで動的に生成しているため、 削除ボタンが押されたときもLoad一度生成したものをイベントハンドラで削除しようとしていておかしくなるのかなという気もしますが、 毎回生成しないとコントロール自体が消えてしまい、Loadでなくイベントハンドラで生成するようにすると、今度は入力値が消えてしまいます。 ソースは以下になります。（一部抜粋） とても困っています。宜しくお願いします。 'テーブルの枠だけデザイナで作成しておく <table id="tblDynamic" runat="server" enableviewstate="false">　 </table> 'ロード Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load 　’配置してあるテーブルに行を動的に追加する 　For rowCnt As Integer = 1 To 10 　　tblFormat.Rows.Add(retCreateRow(rowCnt)) 　Next End Sub ’テーブルの行（コントロールを含む）を作成して返す関数 Function retCreateRow(rowCnt As Integer) As HtmlTableRow 　Dim tr As New HtmlTableRow 　Dim cel1 As New HtmlTableCell 　Dim cel2 As New HtmlTableCell 　Dim txt As New TextBox 　Dim btn As New ImageButton 　txt .ID = "txt " & "_" & rowCnt cel1.Controls.Add(txt) 　tr.Cells.Add(cel1) 　btn.ID = "btn" & "_" & rowCnt 　btn.text="行削除" AddHandler btn.Click, New System.Web.UI.ImageClickEventHandler(AddressOf btnDelete_btnInsert) cel2.Controls.Add(btn) 　tr.Cells.Add(cel2) 　Return tr End Function '行削除イベントハンドラ Private Sub btnDelete(ByVal sender As System.Object, ByVal e As System.EventArgs) Dim ControlIdx = Split(CType(sender, ImageButton).ID, "_")(1) 'この削除ボタンがある行Indexを取得 For HitIdx As Integer = 1 To tblFormat.Rows.Count If Not IsNothing(tblFormat.Rows(HitIdx).FindControl(CType(sender, ImageButton).ID)) Then 'あった！この行を削除する Me.tblFormat.Rows.RemoveAt(HitIdx) Exit For End If Next End Sub
お世話になります。 現在、ExcelからOracleのデータベースを検索して値を選択→シートに張り付けて印刷する、請求書発行のプログラムを作っています。 そこで、実装方法が不明なところがでてきましたので、もしご存知の方は教えてください。 Oracleのデータベースには、Blob型のカラムに請求書発行元会社のロゴデータ（gif形式）が格納されていますが、これをExcelのシートに画像オブジェクトとして貼り付けようとしています。 Oracleのデータベースからの値の取得はできていて、これを画像オブジェクトとしてシートに貼り付ける方法をいろいろ試行錯誤しているのですが、いまだ実現できずにいます。 ※できれば、サンプルのプログラムも記載いただければ幸いです
VBで正規表現 下記のような文字列がTextＢｏｘに入力されています。 <a></a>で囲まれた部分の抽出は出来ましたが、 <td></td>タグで囲まれた’18’も取り出したいのですが正規表現ではどの様に記述すれば宜しいでしょうか？ 関係有りそうなコードはこれです。 Regex("<a href=""(?<url>.*?)"".*?>(?<text>.*?)</a>" ---------------------------------------- <TR bgcolor=#ffffff> <TD> 18 </TD> <TD><a href="main.py?qtype=userpage&teamnum=162&username=KOTOKO"> KOTOKO </a> </TD> <TD><a href="http://fah-web2.stanford.edu/awards/cert.php?u=K … target="_blank"> 11379753 </a> </TD> <TD><a href="http://fah-web2.stanford.edu/awards/cert.php?u=K … target="_blank"> 16190 </a> </TD> </TR> ----------------------------------------
下記のようにTextBox1に入力されているとします。 そこで、'<TD><a href="main.py?qtype=userpage&teamnum=162&username=KOTOKO"> KOTOKO </a> </TD>'と書かれた行から、 <a></a>タグで囲まれた' KOTOKO'という文字を検索して、 '<TD> 18 </TD>'と書かれた文字の18と、 <a></a>タグで囲まれた'11346595'と、 <a></a>タグで囲まれた'16184'を取得してMsgBoxに表示したいのですが、 どうすれば出来ますでしょうか？ (18、11346595、16184という数字は変動します。) いくら検索しても思うようなものが見つかりませんでした。 因みに、大本のhtmlソースはこちらです。 http://fah-web.stanford.edu/cgi-bin/main.py?qtyp … ↓これがTextBox1に入力されている値です。 <TR bgcolor=#ffffff> <TD> 18 </TD> <TD><a href="main.py?qtype=userpage&teamnum=162&username=KOTOKO"> KOTOKO </a> </TD> <TD><a href="http://fah-web2.stanford.edu/awards/cert.php?u=K … target="_blank"> 11346595 </a> </TD> <TD><a href="http://fah-web2.stanford.edu/awards/cert.php?u=K … target="_blank"> 16184 </a> </TD> </TR> <TR bgcolor=#dcdcdc> <TD> 19 </TD> <TD><a href="main.py?qtype=userpage&teamnum=162&username=yukichan"> yukichan </a> </TD> <TD><a href="http://fah-web2.stanford.edu/awards/cert.php?u=y … target="_blank"> 10625127 </a> </TD> <TD><a href="http://fah-web2.stanford.edu/awards/cert.php?u=y … target="_blank"> 4769 </a> </TD> </TR> ↓これがVBのコード Public Class Form1 Dim url As String Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load url = "http://fah-web.stanford.edu/cgi-bin/main.py?qtyp … WebBrowser1.Navigate(url) End Sub Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Form2.Show() Form2.TextBox1.Text = WebBrowser1.Document.Body.OuterHtml Dim r As New System.Text.RegularExpressions.Regex("KOTOKO ", System.Text.RegularExpressions.RegexOptions.IgnoreCase) 'TextBox1.Text内で正規表現と一致する対象を1つ検索 Dim m As System.Text.RegularExpressions.Match = r.Match(Form2.TextBox1.Text) '次のように一致する対象をすべて検索することもできる 'Dim mc As System.Text.RegularExpressions.MatchCollection = _ ' r.Matches(TextBox1.Text) While m.Success '一致した対象が見つかったときキャプチャした部分文字列を表示 MsgBox(m.Value) '次に一致する対象を検索 m = m.NextMatch() End While End Sub End Class
Excelの入力ボタンをクリックしたときにシート１のセル"A1:D50"内にエラーで着色（ColorIndex =7）されたセルがあった場合、次のステップにいけないようにエラーメッセージ（"日付が入力されていません"）を表示したいのですがコード表示が解る方どうかよろしくお願いします。
ｖｂの超初心者なのですが、フォームにコマンドボタンを何度か設置したら Private Sub Button1_Click(sender As System.Object,・・・ というのと Private Sub Button1_Click_1(sender As System.Object,・・・ というのが出来上がっていて、コマンドボタンをクリックすると Private Sub Button1_Click_1 のほうのコードが実行されるのですが、 Private Sub Button1_ClickとPrivate Sub Button1_Click_1 の違いはなんでしょうか？ Private Sub Button1_Clickは、どのコマンドボタンを押せば実行されるのでしょうか？
Ｅｘｃｅｌ2007でマクロ作成の初心者です。 すべてのシートのＲ15セルに、シートの順番どおり 1から連番で番号をつけるマクロを教えていただきました。 Private Sub Workbook_SheetActivate(ByVal Sh As Object) Dim i As Integer For i = 1 To ThisWorkbook.Worksheets.Count Worksheets(i).Range("R15").Value = i Next i End Sub これを以下のように改良したのですが、新しく追加したシートにはなぜか 番号が表示されません。どうしたら、うまく連番が入るようになるでしょうか。 Sub シートに連番() Dim i As Integer For i = 1 To ThisWorkbook.Worksheets.Count Worksheets(i).Range("R15").Value = i Next i End Sub
ActiveReorts6.0Jで帳票を作成するプロジェクトの管理をしています。 頑張ってくれてるPGから悲鳴があがりました。元々A3の帳票を A4に修正したいのですが、コントロールの設定を全部やり直すと とんでもない手間がかかるだけでなく、フォントも手探りで決めないと 綺麗な帳票にならないと言われました。 プロパティの設定で、動的にPageと余白を設定してみたらと実験 したところ、A4でA3の帳票が半分だけでるという悲しい結果でした。 動的に縮小できるのでしょうか？もちろん、できないという回答でも 教えていただければとても助かります。
VB初心者です　VisualStudio2008 VBを使用しております 早速質問なのですが Form1にPictureBox1があり、プロパティDockがFillとします このピクチャーボックスの色を赤にして、左上から中心に向かって線を引きたいのですが Public Class Form1 Private Sub PictureBox1_Paint(ByVal sender As Object, ByVal e As System.Windows.Forms.PaintEventArgs) Handles PictureBox1.Paint Dim p1XC, p1YC As Integer p1XC = PictureBox1.Width / 2 p1YC = PictureBox1.Height / 2 e.Graphics.Clear(Color.Red) e.Graphics.DrawLine(Pens.Black, 0, 0, p1XC, p1YC) End Sub -------------------------------------------------------------------------------- Private Sub PictureBox1_Resize(ByVal sender As Object, ByVal e As System.EventArgs) Handles PictureBox1.Resize Dim p1XC, p1YC As Integer p1XC = PictureBox1.Width / 2 p1YC = PictureBox1.Height / 2 Dim g As Graphics = PictureBox1.CreateGraphics g.Clear(Color.Red) g.DrawLine(Pens.Black, 0, 0, p1XC, p1YC) End Sub End Class ↑は、おかしいですよね？ eに書いてるのかgに書いているのか・・・　そもそも←の考え方がおかしいのか eの扱いがよくわからないです。 ＊同じ色だとわからないですが、色違いにすると大きくした時は増えた部分しか書かれてない ＊ペイントのみにしてしまうとサイズを小さくしたときに中心に線がいかない ＊リサイズのみだと元の部分しか塗られない こういう場合どうするのがいいのしょうか？ 実際はもっと複雑な絵を描きたいので、イベントと描写を分けたいと思っているのですが・・・ どなたかご教示下さい。
excel2007で作成されたVBAが記述されているファイルですが、 excel2010で実行するとフリーズします。 内容的には、ある２つのファイル内容を参照し、比較するというコードなのですが、 F8で一行ずつ実行していくと、workbooks.openメソッドでフリーズしていることがわかりました。 参照ファイルをローカルに置いて実行するとフリーズせずに処理できますが、 参照ファイルがサーバーにある状態では無理です。 これは、サーバーへのアクセス権限の問題なのでしょうか？ でも、excel2007で成功した同じユーザーで実行しても、フリーズとなります。 ネットでいろいろと検索し、openメソッドの前にDoEventsメソッドを記述してみましたがフリーズしました。 どなたか回避策がわかる方、教えてください。お願いします。
お尋ねします。VBAで以下のようなIF文をCASE文に書き換えたいのですが、うまくいきません。 どなたかアドバイスをいただけないでしょうか。 よろしくお願いします。 部分だけ抜き出していますが、文字列が日本語かどうかを判定しています。 CD = Asc(strNm) If CD >= -30561 And CD <= -26510 Then 　　　'漢字(第一水準)" 　　i = i + 1 '文字数記録 ElseIf CD >= -26415 And CD <= -5468 Then 　　'"漢字(第二水準)" 　　i = i + 1 ElseIf CD >= -31936 And CD <= -31850 Then　 '"カタカナ" 　　i = i + 1 ElseIf CD >= -32097 And CD <= -32015 Then 　'"ひらがな" 　　i = i + 1 ElseIf CD >= -1444 And CD <= -949 Then 　　　'"漢字(その他)" 　　i = i + 1 End If
Visual Basic 2010でテキストボックスとコンボボックスを複数設置し コンボボックスの選択の組み合わせによって消すテキストボックスを決めたいと思っています。 初心者で下記のようなコードしか思いつかないのですが、これを簡略化できませんか？ 例) コンボボックス1で一番目の項目を選択して、コンボボックス2で一番目の項目を選択した場合は テキストボックス１のテキストを消す コンボボックス1で一番上の項目を選択して、コンボボックス2で二番目の項目を選択した場合は テキストボックス2のテキストを消す みたいな感じです。 コード If ComboBox1.SelectedIndex = 0 And ComboBox2.SelectedIndex = 1 Then TextBox1.Clear() ElseIf ComboBox1.SelectedIndex = 0 And ComboBox2.SelectedIndex = 2 Then TextBox2.Clear() ElseIf ComboBox1.SelectedIndex = 0 And ComboBox2.SelectedIndex = 3 Then TextBox3.Clear() 　　　　ElseIf ComboBox1.SelectedIndex = 0 And ComboBox2.SelectedIndex = 4 Then TextBox4.Clear() End If わかりづらい文章で申し訳ないですが、わかる方、回答をお願いします。
Excelファイルのマクロで、SheetsクラスのSelectメソッドが失敗しましたのエラーが出ます 以下のマクロですが、最初のSheets(Array(................))._Select でエラーになりますその後は解りませんが．．．。 原因はSelectしているSheetの中に非表示なシートがあるのが原因ですが、 このマクロが入っているExcelファイルは色々な人が使うので人によって非表示にしたい シートがまちまちで、限定は出来ません。ただし、非表示にしたものはそのファイルを 使う人はそのシートはなくても構わないですので、使う人によってマクロを修正すれば 動くのですが、ちょっと面倒なのでこのマクロを修正して対応出来ればと思います。 このケースはsheet4～sheet10までのシートを選択して、選択した全てのシートの特定 部分を消去し、選択していないシートに入って選択を解除し基本となるシートに戻る というマクロです。 マクロの記録で作成して、いらなそうなやつを削除したものです。 ホームページで色々検索しましたが、非表示シートはSelect出来ないと言うことは何となく 解りましたが、マクロの記録で作成した事でも解るように全くの初心者ですので、そこの ところよろしくお願いします。 Sub クリアー() ' ' クリアー Macro ' Sheets(Array("sheet4", "sheet5", "sheet6", "sheet7", "sheet8", "sheet9", "sheet10")). _ Select Sheets("sheet6").Activate Union(Range( _ "F109:BO109,F112:BO112,F115:BO115,F118:BO118,F121:BO121" _ ), Range( _ "FJ225:GS225,FJ228:GS228,FJ231:GS231,FJ234:GS234,FJ237:GS237" _ ), Range( _ "OA535:PD535,OA538:PD538,OA541:PD541,OA544:PD544,OA547:PD547")).Select Selection.ClearContents Sheets("sheet3").Select Sheets("sheet6").Select Range("J1:L1").Select End Sub
VBAでテーブル（フィールド）を作る際にハイパーリンク型を指定することは可能ですか？ Sub test() Dim cat As ADOX.Catalog Dim tbl As ADOX.Table Set cat = New ADOX.Catalog cat.ActiveConnection = CurrentProject.Connection Set tbl = New ADOX.Table tbl.Name = "テーブル" tbl.Columns.Append "URL", adVarWChar cat.Tables.Append tbl Set cat = Nothing End Sub アクセスでこんな感じで作ってるのですが adVarWCharの部分をハイパーリンク型にしたいです。 しかし http://www.accessclub.jp/ado/adox/06.html を見てるとデータ型にハイパーリンク型が見当たらないのですが、不可能という事でしょうか？
Userform Label Backcolorの色イメージが意図したものになりません。 どうすればいいか教えて下さい。 UserForm1.Label1.BackColor = RGB(204, 204, 102) UserForm1.Label2.BackColor = RGB(255, 204, 204) を実行したときのUserForm1のLabel1とLabel2の色イメージが Range("A1").Interior.Color = RGB(204,204, 102) Range("A2").Interior.Color = RGB(255, 204, 204) を実行したときのセルA1,A2の色イメージとが随分乖離しています。
Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles cmd_ボタン.Click System.Diagnostics.Process.Start("notepad.exe") End Sub これでメモ帳を開くことはできたのですが、最大化するにはどうすればいいでしょうか？ System.Diagnostics.Process.Start("notepad.exe")　,vbMaximizedFocus にすると エラーステートメントの終わりを指定してください。 になってしまいます。
vb.netをインストールしたのですが すべてのプログラムに Microsoft Visual Studio 2010 と Microsoft Visual Studio 2010 Express があるのですが、違いはなんでしょう？ 実際プログラムを作成するときは Microsoft Visual Basic 2010 Expressを起動すればいいんですよね？
vb.net（visual studio 2010）です。趣味（もちろん素人です。）でソフトを作ってます。timerに引数を渡すことはできるのでしょうか。integer型の引数を渡したいです。的外れな質問かもしれませんが、実現できたらうれしいです。よろしくお願いします。
vb.netからエクセルファイルを開きたいのですが、 オフィス２０１０をインストールしてから動作しなくなりました。 ------------------------------------------------------------------------ Imports Microsoft.Office.Interop Sub ExcelOpen() Dim ExcApp As Excel.Application Dim book As Excel.Workbook Dim MyPath As String MyPath = "C:\Excel.xlsm" ExcApp = CreateObject("Excel.Application") ExcApp.Visible = True book = ExcApp.Workbooks.Open(MyPath) ExcApp = Nothing End Sub ------------------------------------------------------------------------ これで２００７の時は起動してたのですが、２０１０だとダメです。 Microsoft Excel 14.0 Object Libraryに参照設定しています。 実行すると、 ExcApp.Visible = True の部分で サーバーによって例外が返されました。 (HRESULT からの例外: 0x80010105 (RPC_E_SERVERFAULT)) となります。 どうすればいいでしょうか？ご教授よろしくお願いします。
sheet1の氏名をsheet2の日付、記号（A,B,C）にマッチした位置に入力させたいのですが下記コードで他で試したのですがうまくいきません。どなたかコードが解る方よろしくお願いします。 Sub 入力() Dim i As Long, j As Long, k As Long, L As Long Dim wS1 As Worksheet, wS2 As Worksheet Set wS1 = Worksheets("Sheet1") Set wS2 = Worksheets("Sheet2") i = wS2.Range(wS2.Cells(6, 1), wS2.Cells(8, 1)) j = wS2.Cells(3, Columns.Count).End(xlToLeft).Column Range(wS2.Cells(3, 2), wS2.Cells(i, j)).ClearContents On Error Resume Next For i = 2 To wS1.Cells(Rows.Count, 4).End(xlUp).Row If WorksheetFunction.CountA(wS1.Rows(i)) > 1 Then For j = 2 To wS1.Cells(i, Columns.Count).End(xlToLeft).Column If wS1.Cells(i, j) <> "" Then k = WorksheetFunction.Match(wS1.Cells(i, 4), wS2.Range(wS2.Cells(6, 1), wS2.Cells(8, 1)), False) L = WorksheetFunction.Match(wS1.Cells(5, j), wS2.Rows(3), False) wS2.Cells(k, L) = wS1.Cells(i, j) End If Next j End If Next i End Sub
Form1にドラッグドロップ機能を導入しようと思い AllowDropプロパティをTrueにしてDragDropイベントとDragEnterイベントを記述しました。 実際にデバックしてみるとうまく機能して安心したのですが 後で、bin/debug/AAA.exeを直接クリックしてみるとなぜか機能しません。 MyBase.LoadイベントにMyBase.AllowDrop=Trueと記述してみたいのですがダメでした。 何か設定が間違ってるのでしょうか？ ぜひご回答お願いします。 Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load 　　MyBase.AllowDrop = True End Sub Private Sub drag_drop(ByVal sender As Object, ByVal e As System.Windows.Forms.DragEventArgs) Handles MyBase.DragDrop 　　Dim list As String() = CType(e.Data.GetData(DataFormats.FileDrop, False), String()) 　　For Each a In list 　　　　　MsgBox(a) 　　Next End Sub Private Sub drag_enter(ByVal sender As Object, ByVal e As System.Windows.Forms.DragEventArgs) Handles MyBase.DragEnter 　　e.Effect = DragDropEffects.Copy End Sub
過去問の http://oshiete.goo.ne.jp/qa/7336006.html につきまして、上記の回答をそのままVBAに記述して EXCEL2010において実行してみたのですが 「コンパイルエラー　構文エラー」になってしまい 添付の写真のようにエラーの箇所が示されるものの当方では修正ができません。 当方プログラマーではなくただコピペして実行してみただけです。 ググってもわかるレベルでないことがわかり ここにて質問させていただきたくこととしました。 また、本当のところを申しますと 過去問では出発地の住所が"東京都渋谷区恵比寿～"に固定されておりますが EXCELシート上のA列に出発地、B列に到着地の住所を入力しておくと 両地点の（車での）距離を表示するようにしたいのです。 大変に恐縮ですが、ご教示くださいますようお願い致します。
以下の例のようにシート１とシート２をシート3のように組み合わせることのできるマクロを教えていただけませんか。 <sheet1> AB AC ABC ABD <sheet2> 11 10 110 101 <sheet3> AB 11 AB 10 AC 11 AC 10 ABC 110 ABC 101 ABD 110 ABD 101
VBAにて工程表の自動作成マクロを作成したのですが、社内で他の方にお試しで利用してもらったところ、途中で処理がエラーとなってしまいました。 予想ですが、エクセルのバージョンに問題があるのではないかと思っています。 ・作成時～エクセル2000 ・エラーが発生したバージョン～エクセル2010 他の2000使用者にも実行してもらったところ、問題なく処理が行われました。 社内には2000と2010が混在しているので、どちらでも使用できるようにしたいのですが、解決方法はありますでしょうか？ ちなみに2010で実行したら、カレンダーを作成している最中に「応答なし」が表示され、画面上の処理がフリーズします。 その後に、テキストボックスを指定して、特定のセルに移動させる処理があるのですが、指定したテキストボックスが存在しないというエラーが返ってきて、処理が中断します。（画面のカレンダー作成は正常に終わってました） エラーとなる前にも他のテキストボックスを移動させているのですが、そちらは正常に処理されています。 2010でマクロ実行前に問題となっているテキストボックスを選択して名前を確認しましたが、間違ってはいませんでした。 分かり難い説明で恐縮ですが、何らかの解決方法をご提示していただけると幸いです。
Excel2007 VBAについて質問です。 現在マクロでExcelデータを毎朝8時に保存フォルダに自動保存しているのですが、今回保存フォルダの中に年別フォルダ、月別フォルダを作成しその中に保存していきたいと思っています。 例 2013年フォルダの中に1月～12月のフォルダ 2013年2月25日の保存データは2013年フォルダ内の2月フォルダ内に保存。 ちなみに年度別フォルダは、2030年ぐらい迄作る予定です。 以下現在のマクロです。 Sub 自動保存（） Dim 年 As String Dim 月 As String Dim 日 As String 年 ＝ Year（Now（）） 月 ＝ Month（Now（）） 日 ＝ Day （Now（）） With Workbooks （″サンプル．xlsm″） WorkSheets（″Sheet3″）．Range（″B6：B205″）．Value ＝ Worksheets（″メインモニタ″）．Range（″F13：F212″）．Value End With Worksheets（″Sheet3″）．Select Worksheets（″Sheet3″）．Copy Application．DisplayAlerts ＝ False Const mypath As String ＝ ″C：￥保存データ￥″ With ActiveWorkbook．SaveAs″C：￥保存データ￥″＿＆年＆″年″＆月＆″月″＆日＆″日″＆″．xlsx″．Close End With Application．DisplayAlerts ＝ True Application．Ontime DeteValue（Dete ＋1）＋TimeValue（″8:00:00″），″自動保存″ Worksheets（″メインモニタ″）．Activate End Sub すいませんがご指導願います。
どのようにしていいのか全くわからず困っています。 どうぞよろしくお願いします。 例 りんごR 5000 欠損 1000 みかんG 15000 ももZ 15000 でこぽん G 4000 欠損 2000 というデータがあるとします。 そのデータの中の りんごとでこぽんの欠損のデータを探し りんごR 5000 りんご欠損1000 みかんG 15000 ももZ 15000 でこぽんG 4000 でこぽん欠損2000 と表示させたいと思っています。 よろしくお願いします。
VBSでリンクをクリックしたいのですが、 某所からコピペしたVBSのスクリプトです。 これを実行すると、たしかに YAHOOのオークションに行きます。 ============================== Option Explicit Dim objIE Dim objShell Dim strBody Dim objLINK 'Shell.Application オブジェクトの作成 Set objShell = CreateObject("Shell.Application") 'IE を起動して Yahoo のトップページを開く Set objIE = CreateObject("InternetExplorer.Application") objIE.Visible = True 'IEウィンドウを表示 objIE.Navigate2 "http://www.yahoo.co.jp/" 'Yahoo のページが起動する 'ページの読み込みが終わるまで待機する Do Until objIE.Busy = False '空ループだと無駄にCPUを使うので250ミリ秒のインターバルを置く WScript.sleep(250) Loop ' Yahoo トップページのオークションのリンクをクリックする For Each objLINK In objIE.Document.Links If objLINK.InnerText = "オークション" Then objLINK.Click Exit For End If Next ============================ 質問させていただきたいのは If objLINK.InnerText = "オークション" Then この部分が例えば「オークション」でなくとも「オークショ」のように アンカーテキストリンクの一部が同じだったら、いけるようにしたいのですが、 どうしたらよろしいでしょうか？ 「オークション」 だったら 「オークショ*」 や 「*クション」 とかでもいけるのかなーとおもってたんですが、 全然わからないんです。 どうかよろしくお願い致します。
VB.netにて、 Active directoryの全グループを所得し フォームのプルダウンメニューに 表示させる方法を考えているのですが 方法が分かりません。 どのようにしたら 全グループの情報を取得出来るのでしょうか。
VB2010　フォームアプリでHTMLファイルから 任意のタグで囲まれた部分(例えば<body></body>内)を TEXTBOXに格納したいと思いますが、 いろいろ調べても「これだ」というものが見つかりませんでした。 皆さんの知恵を貸してください。
VBAでセルの値（時間）左辺＝絶対参照 から引き算でセルの値（時間）右辺＝は、セルの位置が下へ１つずつ下がり、 答えのセルも右辺と同じ行の違う列に表示し、右辺の値が最終行になるまで、繰り返すコードの質門。 どなたか、お教えください。お願いします。 Dim T1 As Date Dim T2 As Date Dim T3 As Date T1 = Cells(2, 5) 'E2 左辺の時間 固定（絶対参照？） T2 = Cells(3, 5) 'E3 右辺の時間 E4, E5, E6 と下へ一つずつ移動し途中に - - （ハイフン２つ）とかのセルがありますが、右辺の値がなくなるまで移動させたいです。 T3 = T1 - T2 Cells(3, 7) = T3 'G3 答えを表示するセル。これも、T2（右辺）と同じ行なので、G3,G4,G5と下へ一つずつ値がなくなるまで移動させたいです。 わかんなくて、困ってます。おできになられる方、VBAのサンプルをお教えください。お願い致します。
エクセルオープン時に、「まずマクロを有効にしてください。」というメッセージを表示したいと思います。メッセージをシートに書いておきいて、そのシートを最初に表示する方法があってもマクロ自体を有効にしていなければそのシートが出てきません。何かいい方法はないでしょうか。
こんばんわ！ VB6.0からの移行でVB.net2012に挑戦中なんですが、グローバル変数の宣言の仕方で分からないことがあり質問しに着ました！ 内容 モジュール内で public hoge as string="aaa" と宣言するのと モジュール内で public hoge as string と宣言しておいて フォーム起動時に hoge="aaa" と宣言するのにどのような違いがあるのでしょうか？ hogeの変数を変更したいのですが、上記の方法だと動いて、下記の方法だと動かないのですが・・・ まだ良く分かっていないので、程度の低い質問で申し訳ないのですが、アドバイスのほどよろしくお願いいたします。
VB2005でソフトを作成しています。 最初、日本語で作成したのですが、英語対応することとなりました。 日本語で作っていたので「規定値」の状態で日本語になっています。 ここで、「規定値」の言語は英語にしたいと思いました。 そこで、languageで日本語を選択すると、ja-JPで自動的に日本語になっていました。 次に「規定値」に戻して英語で書き換えていると、ja-JPのほうも英語になってしまいました。 この方法でやると、「規定値」で英語を書いて、ja-JPで日本語を書くという二度手間になってしまいます。 「規定値」で英語にしつつ、日本語を再入力しなくても良い方法はないものでしょうか？
関数を使ってセル内の文字色を操作したいです。 例えば、 D2セルがマイナス数値である場合、A2.B2.C2に 入力されている文字を白に変えたいです。 関数を使って表示する方法を教えていただきたいと思います。 お願いします。
エクセルvbaでie操作をしているのですが、たまにエラーになり、 画像のようなvbのデバッグ画面が出るのですが、なぜでしょうか？ vb.netをインストールしているからですか？ しかも、「デバッグしますか？」ではいを選択してもいつもフリーズして先へ進めません。
画像上部のようにデータがあるときに、各行について 列Aについては、列Bから数値が入力されている列数分コピーを行い、列Bより右側の列に入力されている数値を列Bに移動させたいのです。 （画像左下部を参考にしていただけるといいと思います） ※画像がみづらくて申し訳ありません。 詳しい事は分かりませんが、データの正規化というものでしょうか・・・？ これをVBAを用いて行えたらと思いまして詳しい方からのアドバイスを頂けましたら幸いだと思い書き込みしました。よろしくお願いします。
いつもお世話になります。 フォーム１でテキストに入力した数値（文字ですが）をコマンドボタンを押して、標準モジュールに 受け渡した後、その標準モジュールでフォーム２をShowして表示させたとき、フォーム２のテキストに フォーム１の数値を移す方法はあるでしょうか・・。 ＊テキストだけじゃなく、チェックボタンの可否やラベルのcaptionなどいろいろです。 シートのセルに一度落として、フォーム２のテキストにもってくるのもいいのでしょうけど、それはしたくないです。また、そのもってくる数値が配列でも可能ですか？ プロパティーGet、Letを見たのですが、いまいちわかりやすいのがなくて・・。 あとPublicとかでマクロ動かす時に、マクロ名としてみえたくないです。 以前悩み、解決なされた経験者の方、プロフェッショナルの方のアドバイスいただけますと 幸いです。 フォーム１からフォーム２に直接移すのでもOKです。ただ、フォーム１からもってきたデーターを モジュールでいろいろ加工し、そしてフォームへ返すって言うやり方がいいので、こういう質問にさせていただきました。 宜しくお願い致します。
シート１のマークを入力コマンドボタンでシート２に氏名、日付マッチしたセルに画像のように入力したいのですがコードがお解りになる方どうかよろしくお願いします。
vb初心者です。 よろしくお願いします。 シート名AのセルB3に入った文字と同じシート名を探させたいと思います。 例えば シートAのB3に"万円"と入力された場合、 "万円"シートをアクティブにするという感じです。 よろしくお願いします。
UWSCというマクロで、スタンドあローンのデスクトップにあるエクスプローラーを動かしたいのですが、 IE.Navigate("○○.htm") という命令をすると、ネット上の「http://○○.htm」を読み込みに行ってしまい同じデスクトップにあるhtmlを読んでくれません。 C:からはじまる、デスクトップ上のアドレスでやれば可能なのですが、それではユーザー名などが同じじゃないとつかえず、複数のパソコンで使えるようにしたいです。よろしくおねがいします。
Excelシート１の氏名、日付入力後、コマンドボタン入力をクリックしたらシート２に氏名と日付がマッチしたところにA班は○印をB班は△印マーキングしたいのですがコードがどなたか解る方よろしくお願いします。
Dim ws As Worksheet Dim i As Long For i = 1 To ThisWorkbook.Sheets.Count For Each ws In ThisWorkbook.Sheets If ws.name Like "*T*" Then ws.name = Replace(ws.name, "T", "S") End If Next Next End Sub この処理をするとnameメソッド失敗worksheetオブジェクト 処理できるようにするにはどうすればいいんでしょうか
vb.netです。 モジュールでImports Microsoft.Office.Interopを宣言しています。 ビルドを実行すると --------------------------------------------------------------------------------- 警告1タイプ ライブラリ "VBIDE" のラッパー アセンブリが見つかりません。WindowsApplication1 警告2タイプ ライブラリ "Microsoft.Office.Interop.Access" のラッパー アセンブリが見つかりません。WindowsApplication1 警告3参照コンポーネント 'Microsoft.Office.Interop.Access' が見つかりませんでした。 警告4参照コンポーネント 'VBIDE' が見つかりませんでした。 --------------------------------------------------------------------------------- になってしまいます。 参照設定は画像のようになっています。 アクセスの参照設定をつけなおそうと思い、参照の追加→COMタブ Microsoft Access 12.0 Object Library を選んでOKを押すと、 「Microsoft Access 12.0 Object Libraryへの参照を追加できませんでした。 このタイプライブラリへの参照は既に存在します。 追加する前に参照を削除してください。」 になります。 ここからどうすればいいでしょうか？ VBIDEの方も教えてください。 初心者なのです。ご回答よろしくお願いします。
