マインクラフトの　Ver 1.8.9です。 ワードル生成の時にデフォルトの、「カスタマイズ」とありますが、この設定で、海と草原バイオームだけを生成する方法は何かないのでしょうか。あったら教えてください。なかったら一応そのための配慮をしておきます。どなたでもいいので、よろしくお願いします！。
tableA ID name 1 りんご 2　もも 3　魚 tableB ID snama s_cate　code 1 ジャム　　｛１,2｝ 1111 ２　ちくわ　｛３｝ 1112 というあります。 私は、tableB のcode：1111でセレクトすると s_cate の配列にあるコードが若い１をtableAとジョインして 「ジャム」の値を返してほしいのですが、なかなかうまくいきません。 アドバイスをお願いします。 DBはPostgresです。
Is Modded: Definitely; Client brand changed to 'fml,forge' Type: Client (map_client.txt) Resource Packs: [] Current Language: 日本語 (日本) Profiler Position: N/A (disabled) Vec3 Pool Size: 0 (0 bytes; 0 MB) allocated, 0 (0 bytes; 0 MB) used Anisotropic Filtering: Off (1) OptiFine Version: OptiFine_1.7.10_HD_D1 Render Distance Chunks: 12 Mipmaps: 4 Anisotropic Filtering: 1 Antialiasing: 0 Multitexture: false OpenGlVersion: 4.5.0 NVIDIA 361.43 OpenGlRenderer: GeForce GTX 960/PCIe/SSE2 OpenGlVendor: NVIDIA Corporation CpuCount: 4
terapadの折り返しを設定しました。今まで上手く行っていたのですが、 指定した文字数が反映されません。 オプション→表示→桁　35　OKにしたのですが35文字の約半分の17文字で 折り返されてしまいます。 表示→全角空白　にもチェックが入っています。 指定した文字の半分で改行されているので、 指定した文字できちっと折り返すにはどうしたらいいでしょうか？
現在保育士をしております。 SＥに大変興味をもっております。 未経験26女ではもう足切りでしょうか……大金を稼ごうとは思っておりません。 一人暮らしが出来ればそれで満足です。 今から学びながら働かせて頂くことは甘い考えだとは承知ですが、可能なのでしょうか…… 専門学校に通うと更に実務経験なく歳を重ねて採用から遠のいてしまう気がして不安です……
postgres SQL select文の書き方について 「半角カナ＋英＋数」　以外の文字が含まれているレコードを抽出するにはどのように記述したらいいでしょうか？ 例：ｱｲｳｴｵabc123 　　ｱｲｳｴｵ123 　　ｱｲｳｴｵ@123（※抽出したい） 　　ｱｲｳｴｵab+c123（※抽出したい) 　　アイウエｵabc123（※抽出したい） よろしくお願いいたします。
基本的な質問です。 postgresql9であるレコードをdrop後にバキュームを行ないましたが データファイル({postgres_homedir}/data/base/oid/テーブルNo)でdropしたレコードの文字列が残っています。 ここからも消したいのですがどうしたら消えますか？
postgresqlで、「WARNING　 進行中のトランザクションがありません」のエラーが出てしまいました。 これはそのままの意味だと思うのですが 直す方法がわかりません。 ワーニングなので、、、といいたいところですが、そうもいかず。 apのログで、トランザクション関係の辺りを見ましたところ、 トランザクションを開始し、 TABLEをDROPしようとしましたが、存在しなかった（ようだ）。 （PQexecがエラーでリターン） 存在しないけれど、commit　してトランザクションを終わらせている。 のが原因かなと思いました。 なので、PQexec()がエラーの場合はcommitしなければいいのかと はずしましたが結果は同じでした。 トランザクションが無いのだからrollbackもいらないですよね。 そこで質問ですが drop文、１ステップのSQL実行も明示的にトランザクションの処理をしたほうがいいのでしょうか？ このワーニングは通常のトランザクションの処理の中で、どういう時にでるのでしょうか？ oracleとpostgresqlの明示的・暗黙的な制御に戸惑っています。 （oracleからpostgresqlに移行することになりました） 叱咤でも何でもかまいませんので、アドバイスよろしくお願いいたします。
データベースに関する質問です。 現在、学校でデータベースを使用したシステムを開発しています。 データベースは主にPostgreSQLを使用しています。 データをINSERTする際に大文字小文字を区別せず、 同じ文字列であるかどうかチェックする方法はありますか？ たとえば、「abc123」と「aBc123」を同一とみなし INSERTできないようにしたいです。（主キーのため） システム側ではなく、できればデータベース側で判定を行いたいです。 宜しくお願い致します。
下記の様テーブルよりproduct_idごとに【結果】の様な形として 出力したいと考えております。 【TableA】 order_id｜product_id｜product_name | quantity 001　　product001　　商品名１　　2 002　　product001　　商品名１　　1 002　　product002　　商品名２　　2 003　　product002　　商品名２　　1 003　　product003　　商品名３　　1 【結果】 product_id｜product_name｜quantity｜order_id product001　　商品名１　　　　3　　　　　001, 002 product002　　商品名２　　　　3　　　　　002, 003 product003　　商品名３　　　　1　　　　　003 SELECT product_id, max(product_name), sum(quantity), order_id FROM TableA GROUP BY product_id, order_id としてみたのですが、 product_id｜product_name｜quantity｜order_id product001　　商品名１　　　　3　　　　　001 product001　　商品名１　　　　1　　　　　002 product002　　商品名２　　　　2　　　　　002 product002　　商品名２　　　　1　　　　　003 product003　　商品名３　　　　1　　　　　003 となってしまい、order_idを上記の様にセルにまとめて表示する方法をお教え頂けますと幸いです。 MySQLではGROUP_CONCAT関数を使う事で実現出来たのですが PostgreSQLでの実現方法が分かりかねています。 尚、PostgreSQLのバージョンはPostgreSQL 8.1.23です。 どなたかご教示頂けますと幸いです。
よろしくお願いいたします。 PostgrSQLでPosGIS対応にし、テーブルにGeomカラムを作り、そこにPoint型で地理情報をインサートしました。 次に、特定の範囲に、何件Geomカラムの位置が入っているのかを調べようと思い、次のようなSQLを書きました。 SELECT * FROM hogetable WHERE ST_Within(geom, ST_GeomFromText('POLYGON((10 10, 10 20, 20 20, 20 10))',4326)); これを実行すると、POLYGONのところが、パースエラーになります。どこがおかしかったのでしょうか？ Postgresqlは、あまり触ったことがないので、変なことを書いてしまっていたらごめんなさい。 環境は、CentOS6.3 64bit Postgresql9.3 Postgis2.1です。 よろしくお願いいたします。
くだらない質問で申し訳ありませんが宜しくお願いします。 下記のようなデータを格納するテーブルを構築しています。 ・ユーザーID ・名前 ・カタカナ ・パスワード ・年齢 ・郵便番号 ・住所１ ・住所２ ・住所３ ・電話番号 ・メールアドレス ・備考 ・削除フラグ ・登録者 ・登録日 ・更新者 ・更新日 上記の内容を下記のようなテーブルのフィールドのデータ型を考えました。 ・ユーザーIDのデータ型をVARCHAR(4) ・名前のデータ型をVARCHAR(32) ・カタカナのデータ型をVARCHAR(32) ・パスワードのデータ型をVARCHAR(255) ・年齢のデータ型をINTEGER ・郵便番号のデータ型をVARCHAR(8) ・住所１のデータ型をVARCHAR(255) ・住所２のデータ型をVARCHAR(255) ・住所３のデータ型をVARCHAR(255) ・電話番号のデータ型をVARCHAR(18) ・メールアドレスのデータ型をVARCHAR(255) ・備考のデータ型をTEXT ・削除フラグのデータ型をVARCHAR(1) ・登録者のデータ型をVARCHAR(4) ・登録日のデータ型をTIMESTAMP ・更新者のデータ型をVARCHAR(4) ・更新日のデータ型をTIMESTAMP そうしたら下記のような風にテーブルのフィールドのデータ型にしたら格納する文字列の桁エラーが起こらないからどうといわれました。 ・ユーザーIDのデータ型をVARCHAR(4) ・名前のデータ型をTEXT ・カタカナのデータ型をTEXT ・パスワードのデータ型をTEXT ・年齢のデータ型をTEXT ・郵便番号のデータ型をTEXT ・住所１のデータ型をTEXT ・住所２のデータ型をTEXT ・住所３のデータ型をTEXT ・電話番号のデータ型をTEXT ・メールアドレスのデータ型をTEXT ・備考のデータ型をTEXT ・削除フラグのデータ型をVARCHAR(1) ・登録者のデータ型をVARCHAR(4) ・登録日のデータ型をTIMESTAMP ・更新者のデータ型をVARCHAR(4) ・更新日のデータ型をTIMESTAMP ※現在、使用しているデータベースはPostgreSQLですが、Microsoft　SQL ServerやOracleやMySQL等の他のデータベースでもいいものなのかもご教授いただけると助かります。 私の知識不足でどちらがいいのかがわからず投稿させてもらいました。 申し訳ありませんが皆さんのお知恵をお貸し下さい。 宜しくお願いします。
どうしても分からないので教えてください。 先人の書いたphpの記述を解析しています。 postgreSQLとやり取りしている部分に、次のようなselect文の記述があります。 select lpad(seq_no,shiyo_keta,'0'),seq_min,seq_max from seqno_info where seq_key='YAMATODENPYO'; 実行すると次のようなエラーがでます。 ERROR: 関数lpad(bigint, smallint, unknown)は存在しません 茵 1: select lpad(seq_no,shiyo_keta,'0'),seq_min,seq_max from seqn... （lpadのあたりに印が付いていましたが、ここではずれるので消してあります。） HINT: 指定名称、指定引数型に合う関数がありません。明示的な型キャストが必要かも しれません テーブルの型は次のようになっています。 \d seqno_info Table "public.seqno_info" Column | Type | Modifiers ------------+----------+----------- seq_key | text | not null seq_no | bigint | seq_min | bigint | seq_max | bigint | shiyo_keta | smallint | 以下がそれぞれに入っているデータです。 select seq_no from seqno_info; seq_no -------- 999 (1 row) select shiyo_keta from seqno_info; shiyo_keta ------------ 3 (1 row) 調べても有力な情報が見当たらず困っています。 どなたか、ご教示ください。
以下のようなテーブルがあったとします。 select * from T1; +------------+------+ | date | num | +------------+------+ | 2014-01-01 | 1 | | 2014-01-02 | 2 | | 2014-01-03 | 2 | | 2014-01-05 | 1 | | 2014-01-07 | 1 | +------------+------+ このとき、「各日付を起点として、その日を含む過去3日分の合計num数を出力」させるためにはどのようなSQLを書けばいいのでしょうか。 以下のような結果が返ってくることを期待しています。 | date | sum_num | +------------+------+ | 2014-01-01 | 1 | | 2014-01-02 | 3 | ※ 1+2 | 2014-01-03 | 5 |　　※ 1+2+2 | 2014-01-05 | 3 |　　※ 2+1 | 2014-01-07 | 2 |　　※ 1+1 +------------+------+ PostgreSQL 8系なのですが、環境の問題でwith recursive句を使うことができません。 相関サブクエリをうまく使って取得する方法は無いでしょうか。 よろしくお願いいたします。
教えてください。 現在、ある人の書いたPHPを解析しています。 その中で、postgreSQLを使ってデータをアップデートしている以下の記述があります。 begin;update goods_belong_cat set belong_cat_1='10002', belong_cat_2='10025', belong_cat_3='10086', belong_cat_4='' ,goods_id='1000402' or goods_id='1000393' or goods_id='1000412' or goods_id='1000232' or goods_id='1000241' or goods_id='1000240' or goods_id='1000840' ;commit work; （一行です。） この記述を実行すると、以下のようなエラーが出ます。 BEGIN ERROR: boolean型への入力構文が無効です: "1000402" 茵 1: ..., belong_cat_3='10086', belong_cat_4='' ,goods_id='1000402' ... 　　　　　　　^ ROLLBACK どこに誤りがあるのか分かりません。 どなたかご教示願えませんでしょうか。 Postgreのバージョンは、psql (PostgreSQL) 8.4.13です。 古いバージョンのPostgreでは正常に動いていました。
以下にある二つのテーブル(coursemaster, opencourses)を結合して 月ごとに講義があるかをo,xで一覧にして[期待結果]の様な表を抽出したいです。 coursemaster テーブル course_id | course_name 1 | 経理講義 2 | 財務講義 3 |　 簿記講義 4 | 税理講義 opencoursesテーブル 　　month course_id 200706 | 1　　　 　 200706 | 3 200706 | 4 200707 | 4 200708 | 2 200708　| 4 [期待結果] 　　　　　経理講義　財務講義 　簿記講義 　税理講義 200706　　○　　　　　　×　　　　　○　　　　　　○ 200707　　×　　　　　　×　　　　　×　　　　　　○ 200708　　×　　　　　　○　　　　　×　　　　　　○ 以下の様なSQL文で表を結合してみたのですが 日付の値が重複されてしまい、期待通りの結果になりません。 誰かご教授いただけないでしょうか？ SELECT month AS 開講日 ,CASE WHEN course_name='経理講義' THEN '○' ELSE '×' END AS 経理講義 ,CASE WHEN course_name='財務講義' THEN '○' ELSE '×' END AS 財務講義 ,CASE WHEN course_name='簿記講義' THEN '○' ELSE '×' END AS 簿記講義 ,CASE WHEN course_name='税理講義' THEN '○' ELSE '×' END AS 税理講義 FROM OpenCourses AS OC INNER JOIN CourseMaster AS CM ON OC.course_id = CM.course_id ORDER BY 1 ;
先人の書いたPHPを解析しています。 PostgresSQLとのやり取りをしている記述で、どうしても分からないところがあるので、教えてください。 select count(*) from yamato_order_info yo where yo.maker_system_id in (select mbs.maker_system_id from maker_base_info mbs where mbs.maker_name like '%$_GET[txtSearch]%'); fromでyoとmbsと書かれた部分があります。このデータベースには、そのようなテーブルが無いのですが、これは、Postgresの構文でしょうか？ また、(　の直前のinについてもなんとなくは理解できますが、ネットを調べても出てきません。 古い記述なので、最近のものには対応していないのかもしれません。 どなたかご教示願えませんか。 また、このような場合どのように調べれば良いでしょうか。
すみません、SQLを教えてください。 ID, 名前の2つのフィールドを持つテーブルがあります。 中身は以下のように入っています。 1, AAA 2. AAA 2, BBB 3, CCC 3, AAA 4, DDD 5, EEE, 5, DDD これを、名前のダブリをスキップしながら、 IDの大きな順番に名前を取り出したいのです。 結果は、以下のようになればいいです。 DDD EEE AAA CCC BBB どのようなSQLを組んだら実現できますか？ よろしくお願いいたします。
現在、Access2010+PostgreSQLにて業務システムを構築しております。 Access内では、ODBC接続によるパススルークエリーを用いて、 直接データベース内のレコードの取得を行っています。 質問は、この操作を有線LANで行うと特に待つことも無くレコードの取得が 出来るのですが、無線LAN経由で同操作を行うと、 開くまでに以上に時間がかかり、取得する件数によってはタイムアウトしてしまう事もあります。 （例えば、レコードの取得件数を1件にすれば開きますが、100件にするとタイムアウトします） ただし、無線LAN自体の接続自体は電波強度も良好ですし、 ブラウザでのWebサイト閲覧などは特にストレスなく行う事が可能です。 また、同じデータベースをデータベース管理ツール（PgAdminなど）では 特にタイムアウトなどする事なく、テーブルの中身を閲覧することが可能です。 （レコード件数は数千件です） どうも「Access+PostgreSQL（ODBC接続）」と「無線LAN」を組み合わせた時だけ 接続が遅くなっているような状況です。 レコードの取得と言っても何万件・何十万件のレコードを取得するわけではありませんし データのやり取りと言っても基本はテキストデータのやり取りだと思いますので そこまで回線の太さ速度が関係しないような気もします。 これはAccess・PostgreSQL・ODBCの設定で解消するのか それとも無線LAN自体の問題でしょうか。 分かる方教えてください。
以下のテーブルの様に時系列が抜けているテーブルから直近2年度連続で減少していない年度を 抽出しようとしています。 /* year|sale --------- 1990|50 1992|50 1993|52 1994|55 1997|55 */ /* CREATE TABLE sales2 (year INTEGER NOT NULL , sale INTEGER NOT NULL , PRIMARY KEY (year)); INSERT INTO sales2 VALUES (1990, 50); INSERT INTO sales2 VALUES (1992, 50); INSERT INTO sales2 VALUES (1993, 52); INSERT INTO sales2 VALUES (1994, 55); INSERT INTO sales2 VALUES (1997, 55); */ 以下の記述で直近の年度までなら表示できているとは思うのですが2年連続となると やり方が思いつきません。誰かご教授いただけないでしょうか？ select year,sale from sales2 s1 where sale >=(select sale from sales2 s2 where s2.year = (select max(year) from sales2 s3 where s1.year > s3.year)) order by year ;
PostgresSQLに詳しい方、教えてください。 現在、私はネットショッピングサイトのサーバ管理をしており、データベースにPostgresSQLを使ってます。 サーバのハードが老朽化してきたため、今までの自社サーバーをやめ、レンタルサーバをかりてそこへサイト移転することになりました。 PHPやHTMLといったソース類は、容易に移転できたのですが、データベースの移転がうまく行かず困っております。 どなたかご教示ください。 ■環境(移転元) サーバ：自社サーバ OS：Linux version 2.4.20-16.9 Postgresバージョン：psql (PostgreSQL) 7.3.4 ■環境(移転先) レンタルサーバ会社：さくらインターネット サービス名：さくらのVPS(v3) 1G OS：Linux version 2.6.32-279.1.1.el6.x86_64 Postgresバージョン：psql (PostgreSQL) 8.4.13 ■現象 移転元のサーバにて、pg_dump -i コマンドを実施。 生成されたダンプファイルをFFFTPにて自分のWindows7のマシンに保存。 Windows7上のエディター(DreamWeaver)でファイルを開くと文字化けしています。 エディターのエンコードをシフトJIS→EUCに変更するとデータベースに入力されている文字列をきちんと見ることができます(一部文字化けは残るのですが。)ので、ここまでは成功しているように思っています。 このダンプファイルをFileZillaにて移転先のサーバにアップロード。 psqlコマンドでリストア。 あらかじめ、移転先のPostgresには移転元のデータベース名と同じものを作成し、ユーザー名も同じものを作成してあります。 ところが、いざselectコマンドを使いデータを検索してもあるはずのデータが出てきません。 テーブルはきちんと作成されているようなのですが。 どうしたらデータをきちんと移転できるのでしょうか？ どなたか、ご教示頂けないでしょうか。
添付の表よりSQLのcase文を使用して2年連続でsaleが上がったyearを求めようと しています。 前年より上がった場合は以下のSQLで表示できたのですが 2年連続に上がった年を表示させようとするとうまく表示できません。 誰かご教授いただけないでしょうか？ select year,sale from sales s1 where sale > (select sale from sales s2 where s2.year = s1.year -1) order by year
Windows7でレジストリよりPostgreSQLのインストール先をバッチで取得しようとしたのですが取得できませんでした。 同じ階層で「文字列値」に空白がない「Version」は取得できるのですが 「Base Directory」になると取得できません。 文字列値に空白がある場合「”～”(ダブルコーテーション）」でくくればいいとあったのですが、駄目でした。 どなたかご存知の方教えてください。 @echo off FOR /F "TOKENS=1,2,*" %%A IN ('REG QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\PostgreSQL\Installations\postgresql-9.0" /v "Version"') DO IF "%%A"=="Version" SET GET_Version=%%C FOR /F "TOKENS=1,2,*" %%A IN ('REG QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\PostgreSQL\Installations\postgresql-9.0" /v "Base Directory"') DO IF "%%A"=="Base Directory" SET GET_DIR=%%C echo PostgreSQL Version cho %GET_Version% echo PostgreSQL Directory echo %GET_DIR% pause exit
皆様 いつもお世話になります。 早速ですがご質問させて頂きます。 Postgresqlを使ったシステム開発の勉強するため、最新版をインストールしようと思っています。 (利用しているPCは中古で購入したものなので)あらかじめ入っていたPostgresqlを アンインストールしようと思ったのですが、方法が分からず困っています。 PCにPostgresqlがあらかじめ入っているかどうかは以下のコマンドで確認しました。 #psql --version psql (PostgreSQL) 9.1.9 contains support for command-line editing とりいそぎGoogleで検索してみたところ、 /Library/PostgreSQL/(Postgresqlのバージョン)/uninstall-postgresql.app にてアンインストールできるらしいのですが、/Libraryディレクトリ以下にPostgreSQLディレクトリがありませんでした。 作業が進まずほとほと困っています。 どなたかお詳しい方ご教授のほど何卒宜しくお願い致します！ 環境： MacOSX 10.8.5 Postgresql9.1.9
現在、とあるショッピングサイト（データベースはPostgreSQL、OSはLinux）を運営しておりまして、そのサイトの英語版を別のサーバで作ることになりました。 商品数が膨大にありますため、一つ一つの商品をショッピングサイトの管理画面からコピーペーストし翻訳することは、物理的にできません。 そこで、PostgreSQLのデータベースの中身を自分のPC(Windows7)にいったんコピーし、テキストエディターで開き、翻訳した後、CSVによって英語版サーバへアップロードする方法を思いつきました。 pg_dumpによってデータベースをコピーし、FTPによって自分のPCに持ってくることは、できました。 いざ拡張子に.txtと付けてメモ帳で開いてみたところ、添付画像のような文字化けとなってしまいました。 拡張子をhtmlに変更しブラウザのエンコードで、シフトJIS、EUC、UTF-8といろいろ試しましたが、ダメでした。DreamWeaverのような文字コードの変換ができるエディターで全ての文字コードを試しましたが、やはりできません。 添付画像のような文字化けを日本語に直す方法をご存知の方、いらっしゃいませんでしょうか？
PostgreSqlのテーブルをVBから更新 【テーブル】 tbl1 ( item1 integer not null, -- 数値：ユニークキー , item2 character varying, -- 文字 , item3 timestamp without time zone -- タイムスタンプ , CONSTRAINT tbl1pk PRIMARY KEY (item1) ) 【仕様】 １．テーブル内の特定の１レコードを取得 ２．取得したレコードをVBの画面に表示 ３．入力：VBの画面で　item2　の表示内容を変更 ４．ボタン入力 ４－１．レコードが存在しない場合 　メセージボックスに「誰かが消した」と表示 ４－２．タイムスタンプに変化がある場合 　メセージボックスに「誰かが変更した」と表示 ４－３．タイムスタンプに変化がない場合 　Updateする。 【前提】 普通にアップデートするだけなら、下記でできました。 Private DateTime1 As DateTime ' 画面表示の時に取得したitem3の値が入っているとする 　： 　： Dim NpgsqlConnection1 As NpgsqlConnection = New NpgsqlConnection Dim NpgsqlCommand1 As NpgsqlCommand = New NpgsqlCommand NpgsqlCommand1 = NpgsqlConnection1.CreateCommand NpgsqlCommand1.CommandText = "update tbl1 " _ & "set item2 = '" & Me.TextBox1.Text & "'" _ & ", item3 = current_timestamp " _ & "where item1 =" & キー値 NpgsqlConnection1.ConnectionString = 接続情報 NpgsqlConnection1.Open() NpgsqlCommand1.ExecuteNonQuery() NpgsqlConnection1.Close() 【考察】 変更された場合は、更新対象外にするのは、条件に入れればなんとかなります。 NpgsqlCommand1.CommandText = "update tbl1 " _ & "set item2 = '" & Me.TextBox1.Text & "'" _ & ", item3 = current_timestamp " _ & "where item1 =" & キー値 _ & "and date_trunc('second', item3) =" & "to_timestamp('" & Format(DateTime1, "yyyy-MM-dd HH:mm:ss") & "', 'YYYY-MM-DD HH24:MI:SS')" しかし、これではこのＳＱＬで更新されたのか、他で更新があったためにスキップしたのかが分かりません。 直前のＳＱＬで更新があったかどうか、もしくは何件更新対象になったかを得る事はできませんか？ もしくは、 一旦呼び出してロックし、その間にタイムスタンプを取り出し、 Ｖｂ内に持っていた前回のタイムスタンプと比較し、同じであれば更新する。 同じでなければステータスを返す。 というふうにしたいです。 【質問】 アップデート文で更新対象になった件数を取得する事はできませんか？ もしくは、フェッチの方法を教えて下さい。 上記の仕様のようにタイムスタンプを判断し、そのレコードを掴んだままアップデートしたいなら、フェッチするしかないのかと思っています。 でも、そのやり方が分かりません。 ・コネクト ・カーソル定義 ・カーソルオープン ・ネクストレコード ・レコードを取得し、VB側のタイムスタンプと比較←どうやって？ ・カーソル行に対しアップデート ・レコードの終わり ・０件なら「誰かが消した」と表示 ・カーソルクローズ ・コネクト解除 やりたい事は上記でSqlもVbも分かるのですが、インターフェイス込みでコマンドレベルの方法が分かりません。 フェッチでの方法が分からないので教えて下さい。 フェッチで以外の方法で同等の事が出来るもっと良いやり方があれば教えて下さい。 以上、よろしくお願いします。
リモートホストのpostgresqlにwindows7ホストからつなぐために、windowsホストにphpPgAdminをインストールしようとしています。 windowsホストにはpostgresql, phpなどをインストールしていません。 windows側でサーバーソフトを動かす予定はありません。 多くの解説サイトではpostgresqlサーバーにphpPgAdminを導入するのを前提としているようでよくわからないのですが、この場合、phpPgAdminのみを単独でインストールすればよいでしょうか、あるいは、先立ってphpなどインストールしておく必要があるのでしょうか？ 2013年11月1日
SQLのみで以下の様なことをしたいのですが、やり方が分かりません。 何かしら手法をお知りの方はご教授願いたく存じます。 ▼Postgresバージョン 8.1 ▼テーブル情報 id, numbers 1, '0,20,10,30,50' 2, '10,20,30,50,60' ↓ numbers の値をカンマ（ , ）で分解し、加算したい。 例） 　'0,20,10,30,50'　→　0 + 20 + 10 + 30 + 50 → INTEGERの 110 を取得 ※regexp_split_to_table の関数は、postgresのバージョンが古いために使用できませんでした。 postgresのバージョンを上げる事が出来ないため、8.1でも可能な対応方法を模索しています。
PostgreSQLのApplication Stack Builderを使用しNpgsql.dllをインストールしたところ バージョンが2.0.12になりました。2.0.11をインストールしたいのですが、 バージョン指定でインストールすることはできないのでしょうか？ ご回答のほど、よろしくお願いいたします。 【環境】 Windows7 Professional SP1 VB2010 PostgreSQL9.2.1
PostgreSQLとPHPでサイトを作っています。 下の２つの表がある場合に、「表１」のid名に応じて、 表2のid_noの該当件数を取得したいと思っているのですが、 うまくいかないため質問させいてただきました。 【表1】 idtitle ----------------------- 1ほげ1 2ほげ2 3ほげ3 4ほげ4 【表2】 id_nocoment ----------------------- 1コメント 2コメント 2コメント 2コメント 3コメント 3コメント 3コメント 【ほしい結果】 idtitlecount ----------------------- 1ほげ11 2ほげ23 3ほげ33 4ほげ40 SELECT title,id, (SELECT COUNT(*) FROM comment WHERE id_no ='【ID番号】') FROM informations AS count こちらの様なSQL文で取得出来るのではと考えたのですが、 【ID番号】の部分に、「表１」のidを動的に入れる事が出来ずに困っています。 解法がありましたら教えて下さい。
環境 PostgreSQL 9.2 下記のようなテーブル[TABLE_A]の行（text） を順繰り上から引用してセレクト文の変数として使用するような関数を作成したいです。 やりたいこととしては一つ一つセレクト文を書いて出力を確認するのが無理な量な場合に作業を軽減したいです。 [TABLE_A] hogehoge_a hogehoge_b hogehoge_c ... hogehoge_xx SELECT "hogehoge_a" FROM TABLE_A; ハマってしまいなかなかうまく行きません。お願いします。
PostgreSQLで検索をすると濁点や半濁点もヒットしてしまいます。 「%カルヒ」で、「カルビスープ」も「カルピス」もヒットしてしまいます。 データべースは下記の通り作成しました。 CREATE DATABASE testdb WITH OWNER = postgres ENCODING = 'UTF8' TABLESPACE = pg_default LC_COLLATE = 'Japanese_Japan.932' LC_CTYPE = 'Japanese_Japan.932' PostgreSQLにて検索で濁点や半濁点をヒットさせない方法はありますか？
ｂａtchInsert処理を行うと正常終了しますが、DBには追加されてiいません。 ConnectionMgr.commitConnection(conn);文が終了後実行されています。 ＳＱＬ文 public void batchInsertSgnbtuInfo(ArrayList list, String rysnoo, String pgmId, Connection conn) throws DBException, SQLException { if (list == null || list.size() < 1) { return; } PreparedStatement pstmt = null; int[] rst = null; //sql文 StringBuffer sql = new StringBuffer(); sql.append(" INSERT INTO sgnjsk_inf (" + " kjikminoo, " + " hnkrrkymd, " + " untbng, " + " sgnetyjyn, " + " sgncod ) " + " VALUES (?, to_timestamp(?, 'yyyy/MM/dd hh24:mi:ss'), ?, ?, ?); try { pstmt = conn.prepareStatement(sql.toString()); //SQL文のパーラメタを設置 for (Iterator it = list.iterator(); it.hasNext();) { SgnbtujskinfInfo info = (SgnbtujskinfInfo) it.next(); int i = 1; // VALUES pstmt.setString(i++, info.getKjikminoo()); pstmt.setString(i++, info.getHnkrrkymd()); // ユニット番号 pstmt.setInt(i++, info.getUntbng()); //資源登録順 pstmt.setInt(i++, info.getSgnetyjyn()); pstmt.setString(i++, info.getSgncod()); pstmt.addBatch(); } pstmt.executeBatch(); } finally { if (pstmt != null) { pstmt.close(); } } } よろしくご教授ください。
お世話になります。 以下のSQL文のイメージでselectの結果をさらにselectしたいのですが”subquery has too many columns”というエラーを吐かれます。 Postgreに合った書き方がお分かりでしたら教えてください。 よろしくお願いします。 select * from [DB名] where [パスワード] = 'test' IN ( select * from [DB名] where [ユーザID]='1111' order by [更新日] desc limit 3) [やりたいこと] テストDBからユーザIDが1111の行を更新日をキーに降順で並べ、先頭から3行分を取り出す。 その3行からパスワードが"test"のものをselectしたい。
PostgreSQLを使ったJavaシステムで、検索スピードが最も速い方法を教えていただきたいと思います。 ・検索するテーブル（tblS） 　scode　Varchar　6　主キー 　sname　Varchar　30 　stni　Varchar　2 　skmk　Varchar　2 　stnk　Int4 ・検索する項目 　入力されたnameがテーブルのsnameに存在した場合、他の４項目のデータを読み込む。 　これを連続して5回（nameが５件ある）行う。 現在考えているのが、tblSのデータをArrayListに読込み、ArrayListの検索を行う方法です。 現在、tblSの件数は1500件ですが、日々増加しています。 どうかよろしくご教授ください。
Postgres初心者です。 教えてください。 pg_dumpコマンドでdump拡張しのバックアップファイルを生成し、 tarコマンドで****.tar.gzファイルに圧縮しました。 このtar.gzのファイルを直接リストアするコマンドがあれば 教えていただけないでしょうか？ -bash-3.2$pg_restore -U postgres -d (データベース名） < ****.tar.gz と実行すると、以下のエラーメッセージが表示されます。 →pg_restore: [アーカイバ] 入力ファイルが有効なアーカイブではないようです。 -bash-3.2$gunzip -C ****.tar.gz | pg_restore -d (データベース名） と実行すると、以下のエラーメッセージが表示されます。 →pg_restore: [tarアーカイバ] tarアーカイブ内でファイルtoc.dat用のファイルヘッダがありませんでした よろしくお願い致します。
お世話になります。 phpPgAdminで更新作業をしていまして 一件一項目の更新で update "store_table" set "tenpo_add" = '東京都１－１－１' where "kaiin_no" = '123456'; とした場合はうまく更新でできたのですが、以下のように複数項目の更新が文法エラーになります。 update "store_table" set "tenpo_post1","tenpo_post2","tenpo_add" = '123','4321','東京都１－１－１' where "kaiin_no" = '123456'; このようにした場合、　　","　←この部分が文法上おかしいとのエラーが出ました。 どのように記載すれば良いかご指導いただければ幸いでございます。。
CentOS 6.4をインストールし、標準装備のpostgresql 8.4をインストールしました。 この環境にpgadmin3をインストールしたいのですが、最も簡単な方法を教えて下さい。 ネットで調べると、「ソフトウェアの追加／削除」から「pgadmin3」を検索し、ヒットしたモジュールにチェックを付ければインストールが完了するような事を書いていましたが、「ソフトウェアの追加／削除」で検索してもモジュールはヒットしません。 http://www.linuxmania.jp/postgresql_01.html 例ではCentOS 5でしたので、念のためにCentOS 5で試しましたが、やはり出来ません。 yumでインストールできるような事を書いているのもありましたが、 yum list 上にpgadmin3は見当たりません。 うーん、という感じです。
PostgreSQL（9.1.4）のストリーミング・レプリケーションについて 現在、半年ほどRails+PostgreSQL（9.1.4）で構成されたシステムを運用しております。 DBサーバ（PostgreSQL 9.1.4）を2台使用し、PostgreSQLのストリーミング・レプリケーション機能を用いて、サーバ間でのデータ同期処理を実現させておりました。 しかし、本日より、このストリーミング・レプリケーション機能が正常に動作せず、データの同期処理が行われない状態となってしまいました。 原因の調査方法が、分からず、どのようなログを見て、どのように対処すべきか、ご存知の方がいらっしゃいましたら、教えて頂けないでしょうか？ 何卒よろしくお願い申し上げます。
postgresのデータベースから日本語の入った列の取得が上手くできずに困っています。 どうすればよいのでしょうか。。。 【DB】 postgres:9.1.1 perl: v5.10.1 databaseの文字コード：UTF-8 【クライアント】 postgres:8.4.0 perl：v5.8.8 文字コード：ECU-JP このような環境で、クライアントで 県名テーブルから県名を取得する以下のようなperlを実行した結果、 OUT.csvの県名列が文字化けしてしまったため (1)のように修正したのですがエラーとなってしまいます。 convertの記述の仕方が悪いのでしょうか？ DBD::Pg::st execute failed: ERROR: function convert(character varying, unknown, unknown) does not exist at character 19 (Test.pl) #!/usr/local/bin/perl use DBI; $query = <<EOF; SELECT KEN_ID, KEN_NAME　　←修正前 convert(KEN_NAME,'UTF-8','EUC-JP')←(1) FROM KEN_MASTER EOF $dbi = DBI->connect("dbi:Pg:dbname=datbase;host=DATA_SV","hogeUser","hogePass"); $dsi = $dbi->prepare($query); $dsi->execute(); open(OUT, "> /OUT.csv"); while ($shr = $dsi->fetchrow_arrayref) { print OUT join(",", @$shr), "\n"; } close(OUT); $dsi->finish(); $dbi->disconnect(); exit();
お世話になります。DB初心者です。 現在　、PostgreSQLのphpPgAdminを使っていまして 以下のようなDBがあり kaiin_no　 t_name 　 t_chiket -------+-------+---------- 1001 　　 太郎　 　　 なし 1002 　　 次郎　 　　 なし 1003 　　 三郎　 　　 なし 1004 　　 四朗　 　　 あり 1005 　　 五朗　 　　 あり 以下のようなSQLで目的のデータを表示できるのは解ったのですが SELECT "kaiin_no","t_name","t_chiket" FROM "public"."store_table" WHERE "kaiin_no" IN ('1001','1002','1003'); kaiin_no　'1001','1002','1003'　の t_chiket　を　「なし」　から　「あり」　に変更すする方法をご教授いただけますでしょうか？ お手数をおかけしますがよろしくお願いいたします。
pg_dumpall > [出力ファイル名] で作成したバックアップからテーブル単位でリストアする方法はないのでしょうか? pg_dumpallのマニュアルを読むと、リストアはpsqlで行うことになっていますが、psqlのマニュアルには テーブル単位で取り出すオプションなどはないようです。 また:pg_dumpallで作成したファイルを: pg_restore -l [入力ファイル名] の入力ファイルにすると、"pg_restore: [archiver] input file does not appear to be a valid archive" エラーが発生します。 webでも調べてみたのですが、該当するページが見あたりません。 お手数ですがご教授ください。
PostgreSQLをバージョン8.2から9.2にＵＰし、Ｔｏｍｃａｔをバージョン５から７にＵＰしました。 そのほか、ＯＳはWindows7でローカルシステムを構築中です。 実行すると、HTTPステータス５００javax.naming.NamingException: Could not load resource factory class [Root exception is java.lang.ClassNotFoundException: org.apache.commons.dbcp.BasicDataSourceFactory] とエラーが出ます。 以下の環境設定の間違いと思われますが、どこを直せばよいかわかりません。 よろしくご教授ください。 ＰｏｓｔｇｒｅＳＱＬは、C:\Program Files\postgresql9.2に配置しました。 Ｔｏｍｃａｔは、C:\Tomcat7に配置しました。 システムはC:\Tomcat7\webapps\test1に配置しました。 ＪＤＢＣドライバは、postgresql-9.1-901.jdbc3.jar と　postgresql-9.1-901.jdbc4.jar を C:\Tomcat7\libnにコピー＆ペーストしました。 接続の定義は、C:\Tomcat7\conf\catalina\localhost に　test1.xmlファイルを作りました。 以下がその記述です。 <?xml version='1.0' encoding='utf-8'?> <Context path="/test1" reloadable="true" docBase="C:\Tomcat7\webapps\test1" workDir="C:\Tomcat7\work" > <Resource name="jdbc/RDBMS" auth="container" type="javax.sql.DataSource" debug="1" factory="org.apache.commons.dbcp.BasicDataSourceFactory" driverClassName="org.postgresql.Driver" username="postgres" password="postgres" maxActive="100" maxIdle="30" maxWait="10000" url="jdbc:postgresql://localhost:5432/LocalDB" removeAbandoned="true" removeAbandonedTimeout="300" /> </Context>
いつもお世話になっております。 標題についてご教授下さい。 DBからある項目をupper関数を使って変換しているのですが、 変換されません。 UPPERは文字列などを大文字に変換する認識なのですが、 わかりません。 [table A] key1 Ｔｅｓｔ key2 test SELECT upper(key1), upper(key2) from A 結果 key1 　 key2 Ｔｅｓｔ　 TEST 全角の英字が変換されません。 そもそも全角はtranslateしないとだめでしょうか。 お手数ですが、宜しくお願いします。 　
PostgreSQL 8.4に関する質問です。 サーバ：Linux、PostgreSQL 8.4 クライアント：Windows 7 Windowsマシンから、バッチファイルでサーバ上のPostgresのバックアップを取りたいのですが、 以下のコマンドをバッチファイルに記述して実行すると、 「パスワード:」というプロンプトが出て処理が止まってしまいます。 pg_dump.exe -h [DBサーバのIP] -U [ユーザ名] -F custom -b -v -f "C:\test.backup" "test" パスワードを入れればバックアップはできるのですが、 パスワードの入力まで完全自動化するにはどうすればいいでしょうか。 Linux上のPostgresはSSL接続のみ許可するようになっています。 Windowsのタスクで毎日バックアップする運用を想定しています。
Windowsに、PostgreSQL 旧バージョン等をインストールしたいのですが、 以下のバージョンをインストールする事は可能でしょうか。 PostgreSQL 7.3.6 Apache 2.2.23 PHP 5.2.17 Windows は、できれば7(64bit)、駄目ならXP(32bit)に入れたいです。 Postgresを自分で探してみたのですが、Linuxバージョンしか見つける事ができませんでした。
PostgreSQLバージョン　9 OS：RedHat 現在Oracleからの移行でPostgreSQLにてTEXT取り込み処理を作成しています。 OracleではSQLLoaderを使用して取り込んでいましたが、 PostgreSQLではCOPYコマンドを使用すれば取り込みできるところまで調べました。 しかし、行末に区切文字があるためうまく取り込みできません。 【コマンド】 \copy hoge from 'hoge.txt' delimiters '|'; 【行末に区切文字がある場合NG】 AAA|BBB|CCC| ERROR: extra data after last expected column CONTEXT: COPY hoge, line 1: "AAA|BBB|CCC|" 【行末に区切文字がない場合OK】 AAA|BBB|CCC SQLLoaderでは行末の区切文字があっても取り込めましたが COPYコマンドでは取り込めないようです。 回避策はないのでしょうか？ （取引先からのTEXTなので相談はして見ますがレイアウトの変更は難しいかもしれません。） 回避策がない場合、行末の区切文字を削除する方法はありますでしょうか？ 行末だけの区切文字を削除する方法が分かりません。 （テキストは固定長でないため、桁数を指定した削除ができません） 行末区切文字削除の方法だけでも良いのでお願いします。
pl/pgsqlで再帰呼び出しは可能でしょうか。 PostgreSQLのバージョンは9.2.3です。 作成しているファンクションは正方形の中心座標を求めてInsertするものです。 指定した回数だけ、再帰的に正方形を４分割にどんどん細分化していき、 それぞれの正方形の中心座標をInsertします。 ４分割にした正方形をそれぞれ以下のように番号を振って説明します。 　左上・・・(1) 　右上・・・(2) 　左下・・・(3) 　右下・・・(4) 元の正方形を求めた後、(1)→(2)→(3)→(4)の順に再帰的にファンクションを呼び出します。 パラメータを「３回」以上にした場合は、(1)についてもまた４分割していきます。 ここで、パラメータを「１回」とした場合は、元の正方形の中心座標は当然Insertできます。 パラメータを「２回」とした場合、(1)の正方形の中心座標も求まりますが、 (1)の正方形については再帰の最終処理のため、Insert後にRETURNすることで エラーとなっているのか、１つ目の正方形のレコードも(2)の正方形のレコードも Insertされていません。 さらにはその「RETURN句」が元のファンクションすら「終了」させているようで、 (2)、(3)、(4)の正方形の処理が行われません。 このように再帰呼び出しをしたいと思っても、再帰中の処理を終わらせ、 呼び出し元に戻らせるはずのRETURN句が、一番最初のファンクションの「終了」と 理解されてしまい、pl/pgsqlでは再帰呼び出しは実現できないのでしょうか。 ファンクションのイメージは以下の通りです。 CREATE OR REPLACE FUNCTION Insert_squre( IN kaisuu INT, --再帰的に呼び出す回数 IN count INT, --再帰回数をカウント IN X1 INT, --正方形の左上の頂点のX座標 IN Y1 INT, --正方形の左上の頂点のY座標 IN X2 INT, --正方形の右下の頂点のX座標 IN Y2 INT --正方形の右下の頂点のY座標 ) RETURNS void AS $$ DECLARE /* 変数定義 */ ・・・・・ BEGIN /* 中心座標を求める */ ・・・・・ /* 中心座標をInsert */ ・・・・・ /* kaisuu=countならばRETURN */ ・・・・・ /* (1)の正方形について再帰処理 */ select Insert_squre( IN kaisuu INT, --再帰的に呼び出す回数 IN count+1 INT, --再帰回数をカウント IN X1 INT, --正方形の左上の頂点のX座標 IN Y1 INT, --正方形の左上の頂点のY座標 IN X3 INT, --正方形の右下の頂点のX座標 IN Y3 INT --正方形の右下の頂点のY座標 ); /* (2)の正方形について再帰処理 */ ・・・・・ /* (3)の正方形について再帰処理 */ ・・・・・ /* (4)の正方形について再帰処理 */ ・・・・・ RETURN; END; $$ LANGUAGE PLpgSQL;
ポスグレでイベントトリガを使いinsert時に任意の関数を呼び出し処理を行いたいのですが 最後にinsertされた(正確にはそのイベントが発生したときにinsertされた)レコードの データを関数内で使うやり方がわかりません。 そういった関数みたいのがあるのでしょうか。 ご存知の方、ご教示いただけると助かります。
お世話になります。 PostgreSQL8.4.8のphpPgAdmin3.5.3を使ってデータを削除する際に 先ずデータをSELECT で表示させて確認後、 SQL編集　で　SELECTを　DELETE　に書き換えて実行しましたが以下エラーが出ます ≪一覧確認用≫一覧表示はできました。 SELECT "kaiin_no","tenpo_no","tenpo_name" FROM "public"."store_table" WHERE "kaiin_no" IN ('1234',2222'); ≪削除用≫SELECT 　→　DELETEに変更　→　実行　→　以下エラー DELETE "kaiin_no","tenpo_no","tenpo_name" FROM "public"."store_table" WHERE "kaiin_no" IN ('1234',2222'); ≪エラー内容≫ ERROR: syntax error at or near "," LINE 1: SELECT COUNT(*) AS total FROM (DELETE "kaiin_no","tenpo_no",... ^ 文: SELECT COUNT(*) AS total FROM (DELETE "kaiin_no","tenpo_no","tenpo_name" FROM "public"."store_table" WHERE "kaiin_no" IN ('1234','2222')) AS sub 文法エラーのようなのですが 一覧が出来ているのに　なぜ削除が出来ないのか 初心者で恐縮ですが ご教示頂ければ幸いです。
pl/pgsqlで変数が文字列として扱われてしまうのですがどうすればいいのでしょうか。 具体的には以下のような感じです。 CREATE OR REPLACE FUNCTION test_func() RETURNS VOID AS $$ DECLARE test_val TEXT ; ofs_num INTEGER := 0; lmt_num INTEGER := 0; t_name TEXT := 'schema1.table1'; BEGIN SELECT INTO ret_val * FROM t_name OFFSET ofs_num LIMIT lmt_num; END; $$ LANGUAGE plpgsql; 上記のofs_numやlmt_numは変数として認識してくれるのですが FROMに続く「t_name」が変数ではなくそのままの文字列として認識されてしまいます。 t_nameを変数として認識させる方法はありませんでしょうか。 教えていただけると助かりますm(_)m
以下のテーブルからCSVを出力する際、 ID | 名称　| コード1 | コード2 1　| 　A　　|　 111　　| 　444 2　| 　B　　|　 222　　|　 555 3　| 　C　 |　 333　　|　 666 「ID/名称/コード1コード2」のように取りだす場合のSQL文は SELECT ID, 名称, コード1 || コード1 FROM テーブル名 となると思いますがこれを、「ID/名称コード1/名称コード2」のように同じフィールドを同じ行に2回登場させたい場合はどうすれば宜しいでしょうか。 SELECT ID, 名称 || コード1, 名称 || コード2 FROM テーブル名 とした場合にはエラーになってしまいます。 宜しくお願い致します。
お世話になります。 複数レコードがあるテーブルにて、あるレコードだけカウントアップする為のSQL文はどのように記述すれば良いでしょうか？ 要件： テーブル名'名簿'の No, 名前, 更新者, 備考に 01, 芥川龍之介, ほげ太, NULLを入力し 備考は書き込みさせるためとりあえずNULLを代入しておき 名前と更新者は同じで、Noの部分だけを01～10までカウントアップさせたい 何卒、ご教授のほど、宜しくお願いします。
ポスグレDBで以下のような二つのテーブルがあって レコード数、カラム等の構造も同じだったとして カラム1の値が二つのテーブルで同じであり カラム2～4のうちどれか一つでも違うレコードを抽出するSQLがわかりません。 下記の例で言うと抽出結果がスキーマA.テーブルAの「←」のレコードを抽出したいです。 スキーマA.テーブルA カラム1|カラム2|カラム3|カラム4| --------------------------- A |aaaaaaa|bbbbbb|ccccccc --------------------------- B |aaaaaaa|bbbbbb|ccccccc　　　　　　← --------------------------- C |aaaaaaa|bbbbbb|ccccccc　　　　　　← --------------------------- D |aaaaaaa|bbbbbb|ccccccc　　　　　　← --------------------------- E |aaaaaaa|bbbbbb|ccccccc スキーマB.テーブルB カラム1|カラム2|カラム3|カラム4| --------------------------- A |aaaaaaa|bbbbbb|ccccccc --------------------------- B |1111111|bbbbbb|ccccccc --------------------------- C |aaaaaaa|777777|ccccccc --------------------------- D |2222222|bbbbbb|8888888 --------------------------- E |aaaaaaa|bbbbbb|ccccccc よろしくお願いします。
SQLで2つの表から条件に合ったデータを取り出し、同じ列に表示させたいのですが、 どうやっても外部結合のようにすることしかできませんでした。 取り出したデータを縦に結合?させることはできるのでしょうか? 例) dataは月の上旬中旬下旬でそれぞれabcとします。 入力値はmonthとdayで、これらからuriageを選択します。 dataの取りうる値はa,b,c,ab,bc,abcとします。 　　 table:A 売上表　　　　　　　　　　　　table:B 上旬中旬下旬判断 ---------------------------　　　----------- 　key　|　data　|　month　|　uriage 　　day | data --------------------------- 　　　----------- 　　1　|　　a　　|　　1　　|　　500　　　　　 1　|　　a 　　2　|　 ab 　|　　1　　|　　800　　　　　…　|　　… 　　3　|　 bc 　|　　1　　|　　400　　　　　10　|　　a 　　4　|　　c　　|　　1　　|　　100　　　　　11　|　　b 　　5　|　　abc　|　　1　　|　　900　　　　　…　|　　… 　 …　|　　…　　|　　…　　| …　　　　　31　|　　c --------------------------- 　　　----------- month = 1 , day =5のとき 　table:Bより 　　SELECT data FROM table:B WHERE day = 5 としてdata "a" を得ます。 この"a"と同じdataを持つuriageを表示させたいので 　　SELECT uriage FROM table:A 　　WHERE month = 1 AND data = (SELECT data FROM table:B WHERE day = 5) として 　table:query1 　-------- 　　 uriage 　-------- 　　　500 　-------- を得ました。 ここまでは良いのですが、これに付け加えて、 table:Bから取り出したdata "a"をtable:Aのdataが含むとき(data = a,ab,abcのとき) その全てのuriageを表示させたく、 ワイルドカードを使おうと 　　SELECT uriage FROM table:A 　　WHERE month = 1 AND data = %(SELECT data FROM table:B WHERE day = 5)% 等としてみたのですが、上手くいきませんでした。 そこで、別のクエリーを作って 　　SELECT uriage FROM table:A 　　WHERE month = 1 AND data = 'ab' AND data = 'abc' として 　table:query2 　--------- 　　uriage 　--------- 　　　800 　--------- 　　　900 　---------- を得ました。 そして、最後に、 得られた2つの表をまとめて 　--------- 　　uriage 　--------- 　　　500 　--------- 　　　800 　--------- 　　　900 　--------- としたいのですが、 　　SELECT uriage, uriage FROM query1, query2 とすると 　------------------ 　　uriage　|　uriage 　------------------ 　　　500　 |　　800 　　　500　 |　　900 　------------------ となりますし、UNIONは使い方がよくわからないためシンタックスエラーにしかならず...。 そもそも、縦に結合?はできるのでしょうか??? あれこれ試してみたのですが、詰まってしまったので、 どなたか知恵をお貸しください。
質問させて頂きます。 DB：PostgresSQL 言語：PHP 現在仕事情報の入ったテーブルから、金額の高い順にデータを10件取り出したいと考えています。 金額の入ったカラムが１つであれば、order by句で取り出すのですが、今回、時給[hour]、月給[month]、年収[year]と３つのカラムが存在しています。 ※下記のid4のように2つ以上の金額情報カラムを持っているデータも存在します。 ※データの中にはnullでなく0が入っているデータも存在します。 [id][hour][month][year] 1 ,1000 ,null ,null 2 ,1200 ,0 ,0 3 ,null ,300000 ,null 4 ,1500 ,200000 ,null 5 ,null ,null ,3200000 ... 100,null ,250000 ,null 質問の内容なのですが、下記のルールに従いデータを取得する際、どのような方法を行えば一番効率的でしょうか。 「ルール」 １． 金額比較の際、 月給はそのまま、 年収は12で割った金額、 時給に関しては、時給×８(1日の平均的労働時間)×20(1月の平均的な労働日数)の金額とします。 ２． ２つ以上のカラムに金額を持っていた際は(id4のようなデータ)、金額の大きさに関わらず、年収＞月給＞時給の順で取得する。 id4のデータならば、時給の方が月給より高いですが、月給のデータを使用します。年収があれば年収優先。 id2の場合、0はnullと同じ扱いと考え、時給のデータを使用します。 このルールをふまえたうえでデータを取得する際、SQLで全データを取得して、PHPで高い順を判定するべきか、SQLで取得する時点である程度絞って取得した方が良いのか・・・。 SQLに関しての知識が乏しいため、効率的な方法をご存知の方はアドバイス頂けると大変助かります。 よろしくお願いします。
商品マスタがあり、データは下記の感じで登録されています。 　コード　|　商品名　　|　商品カナ　|　分類コード　・・・ --------------------------------------------------------- 　0001　　|　マウス　　|　マウス　　|　01　　　　　・・・ 　0002　　|　キーボード|　キーボード|　01　　　　　・・・ 　0003　　|　モニター　|　モニター　|　01　　　　　・・・ 　　　　　　　　　・ 　　　　　　　　　・ 　　　　　　　　　・ SQL文で質問があります。 下記のSQLでは取得できるんですが・・・ SELECT * FROM M_SHOHIN WHERE code = ANY('{0001,0002,0003}'); 下記のSQLを実行したらエラーが出力されました。 SELECT * FROM M_SHOHIN WHERE code = ANY( 　SELECT ARRAY_AGG(code) AS code FROM M_SHOHIN WHERE class_code = '01' ); ERROR: operator does not exist: character varying = character varying[] HINT: No operator matches the given name and argument type(s). You might need to add explicit type casts. なので下記のようにCASTをするようにして実行したらエラーは出力されなくなりましたがデータの取得ができませんでした。 SELECT * FROM M_SHOHIN WHERE code = ANY( 　SELECT CAST(ARRAY_AGG(code) AS VARCHAR) AS code 　FROM M_SHOHIN WHERE class_code = '01' ); どのようにすれば取得できますでしょうか。 説明が下手で申し訳ありませんがアドバイスいただけませんでしょうか。 データベースはPostgreSQL 8.4.9です。 宜しくお願いします。
業務システムでPostgreSQL８．３を利用しており日次でバックアップを行っています。しかし、もしシステム稼動中にサーバー障害が発生した場合、データの復旧可否が利用者にとって一番気になるところだと思います。（日次バックアップは実施しているので前日データまでは復旧できると思います。） そこで質問なのですが、最新データまで復旧するとなるとログデータが必要になると思いますが、サーバが何らかの障害でログデータすらサルベージできない状況が起きることを想定して、ログデータも別のサーバに常に退避するように設定することは可能でしょうか？（無知ですみません） 可能な場合、PostgreSQLにおける上記の具体的な実施方法を教えて頂けないでしょうか？（お恥ずかしい限りではありますが、そもそもこの方法が妥当かどうかも判断できていないです） 上記の中で、質問者はデータベースのことを分かっていないと判断されましたら、合わせてアドバイス・一般論なども頂けると幸いです。 何卒、よろしくお願いします。
PostgreSQL初心者です。 AccessからPostgreSQLに移行しようと思い、ODBCで接続しようとしたのですが、エラーが発生して進めません！ そして、いろいろ試してみたのですが、同じエラーが発生してしまいます。 設定、エラー内容は、下記になります。 エラー内容 「ODBC--呼び出しが失敗しました。 Could not connect to the server; Could not resolve hostname.(#101)[Microsoft][ODBC Driver Manager]ドライバのSQLSetConnectAttrは失敗しました。(#0)」 設定 データソース（ODBC）→システムDSN→PostgreSQL Driver Setup Database Server dbserver User Name localhost Description Port 5432 以上、宜しくお願い致します。 OS:WindowsXP Professional Version 2002 Service Pack3 PostgreSQL 9.1 Version 1.14.3 Access XP(2002) になります。
お世話になります。 データが更新された段階で、外部プログラム(xxx.exe)を実行したいと考えております。 おそらく、トリガを利用すれば可能かと思い調査しておりますが、 どのようにして外部プログラムを実行すればよいか分かっておりません。 ご存知の方、ご教示頂けないでしょうか。 よろしくお願いいたします。
こんにちは。 SQLについて質問です。 id　　name　　goal 1　　山田　　東京 2　　木下　　北海道 3　　高橋　　大阪 3　　高橋　　沖縄 こういう状態でデータが入っていたとして、 idが3の高橋はgoalが違う状態で2件データがあります。 これを、 id　　name　　goal 1　　山田　　東京 2　　木下　　北海道 3　　高橋　　大阪、沖縄 こうなるようにしたいのですが、 どうSELECT文を書けばよいでしょうか？ よろしくお願いします。　　
あるサーバーにDBのダンプをインポート仕様としています psql - U postgresで接続できていることは確認してあります psql -h localhost -U postgres -f xxxxxx.dump xxxxxx とうつとIdent authentication failed for user "postgres"とFATALが出て インポートかでません pg_hba# TYPE DATABASE USER CIDR-ADDRESS METHOD # "local" is for Unix domain socket connections only local all all trust # IPv4 local connections: host all all 127.0.0.1/32 ident # IPv6 local connections: host all all ::1/128 ident.confには下記になってます どうしてでしょうか?
PostgreSQLによるデータベースを運用しています。 メンテナンス処理で、Vacuum処理は毎日バックアップ取得時に行っていますが、 ReIndex処理は1週間に1度程度行っています。 ReIndex処理も毎日行ったほうがよいのでしょうか。 よろしくご教授ください。
PostgreSQL のバージョンアップを検討しています。 Version 9.1.4 Version 8.3.19 Version 8.3.1と比べると機能・性能・セキュリティなどが良くなっているのですか？ phpからの操作の仕方や挙動が変わるとかあるのでしょうか。 Version 8.3.19 の方がよいですしょうか。
色々、試しているのですがうまくゆきません。 どうしたらよいでしょうか？ ポストグレのドライバを設定するところがあるのですが、 何を設定していいか分かりません。
基礎的なことで申し訳ございませんが、 お力添えよろしくお願いいたします。 CentOs 5 & PostgreSQL 8.4.9にてDB構築しております。 DB構築から、テーブル作成・項目追加・キー設定まで行いまして、 検索する際に、抽出件数が多く負荷のかかりそうなものに Indexを作成しようと考えております。 ■本題 　１．Indexを作成する対象となる項目の、目安としてどのようなものが考えられるでしょうか。 　　・キー対象の項目になっているもの 　　・検索条件の対象となる項目なども当たるでしょうか 　２．項目をまとめて一つのIndexにするメリット・デメリットはどのようなものでしょうか　 　３．テーブル結合したときのIndexの動作 　　　例) 下記のようなテーブルがあった場合 tablea(データ50000件程度) hoge_id pkey1 hoge_no hoge_nm ... tableb(データ150000件程度) test_id pkey1 hoge_id pkey2 hoge_betu_kb ... 　　　　select t1.hoge_id, t1.hoge_nm, t2.hoge_betu_kb rom tablea as t1 leftjoin tableb as t2 on t1.hoge_id = t2.hoge_id where t1.hoge_id > '100' and t1.hoge_nm like 'あいう%' 　　このような場合のIndex作成は、 A. Create index idx_tablea_hoge_id ON tablea (hoge_id); B. Create index idx_tablea_hoge_id ON tablea (hoge_nm); C. Create index idx_tableb_hoge_id ON tableb (hoge_id); ←tableaで指定しているのでこれは不要？ 　４．A.B.C.のようなIndex作成した際のテーブル定義の書き方 　　テーブル定義書のフォーマットは定められており、お門違いな質問かとは存じてはおりますが、 　　テーブル定義にIndex定義を書く場合に、添付した画像のようなフォーマットの書き方が 　　よく理解できずお気づきの点などございましたら、ご指摘願えたら助かります。 　　（以前は、CSEツールなどで自動出力される定義書のような書き方をしていたもので・・・） 　　　　 　　　例）tablea IDX1 IDX2 IDX3 hoge_id 1 hoge_nm 2 このような書き方になるのかどうか？ 　　　　　IDX2, IDX3の項目とは？どのようなIndex定義をした際に書き込むことになるのかが判らず。。。 　　　　　基礎から勉強しなおすべきとは存じておりますが。。。 現状の期間あまり時間がないことと、 DB構築を一人で行っており、このような内容を相談できるものがおりませんゆえ、 改めて、Index付加することを考えてみると、いまさら聞けないような内容かもしれませんが ちゃんと把握したうえで、テーブル構築したいと思いますので 今までの他の皆様の経験からのノウハウなども踏まえて、 ご教授いただけると大変助かります。
質問させていただきます。 DB:postgresql 言語:PHP タイトルの通りなのですが、 現在下記のような形でSQLを実行しています。 「to_char(created, 'YYYY年MM月') as created_styled,」 しかし、この形では月の部分が01月と0を含んだものになってしまいます。 MySQLであれば、%cを使用すれば0無しの月を生成出来るようなのですが、 postgresqlでも同じような機能は無いのでしょうか？ また、無理にSQL側で処理を行う必要も無いので、データを取り出した後での処理方法でも構いません。 もしこういった場合に一般的な0を消す対処方法があれば教えて頂けると助かります。 よろしくお願い致します。 また、質問に不備などがあればすぐに修正致しますので、その際はご指摘お願いします。
これから、商用のパッケージでシステム開発を行おうと思っています。 そこで、ＤＢの選定をしている最中なのですが、 出来るだけコストをかけないでしたいので、 PostgreSQLで考えています。 （商用アプリでも無料ということだったので） ですが、MySQLやその他の商用ＤＢも含めて、 費用（ライセンス）や速度、メモリ消費などのパフォーマンスで 何のどこが優れているかを教えていただきたいと思います。 （未チューニングの状態で） また、サイトなどのＵＲＬでも構いません。 よろしくお願いします。
4コアのCPUですが、CPUのうち1つだけが使用率100%で、他のCPUを使ってくれず困っています。 対処法が解る方、助言をお願いします。 ＠環境 Linux version 3.2.12-gentoo Intel(R) Core(TM) i5-2400S CPU @ 2.50GHz postgresql-server-9.1.3
2つのテーブル（basecodeとaddcode）からVIEWを作りたいのですが、 そのVIEWについてご教授いただきたく。 ＜TABLE名：basecode＞ ---------------------- no name area code ---------------------- 1 aaaa 2 102 2 bbbb 4 103 3 cccc 4 203 4 gggg 3 303 5 eeee 3 101 6 ffff 5 104 7 hhhh 1 115 ---------------------- ＜TABLE名：addcode＞ ----------------------------------------- base anum bnum cnum dnum dmy no ----------------------------------------- bbbb 1 1 1 1 aaa 2 cccc 12 13 10 2 aaa 3 cccc 12 13 10 0 aaa 3 cccc 12 13 10 5 aaa 3 dddd 12 15 3 1 aaa 3 dddd 12 15 3 3 aaa 3 dddd 12 15 3 4 aaa 3 eeee 10 3 12 1 aaa 5 eeee 10 3 12 2 aaa 5 eeee 10 3 12 3 aaa 5 eeee 10 3 12 4 aaa 5 eeee 13 12 15 3 aaa 5 eeee 13 12 15 0 aaa 5 eeee 13 12 15 1 aaa 5 eeee 13 12 15 2 aaa 5 hhhh 4 3 11 0 aaa 7 hhhh 4 3 11 2 aaa 7 hhhh 4 3 13 2 aaa 7 kkkk 0 0 0 0 aaa 9 ----------------------------------------- VIEWの抽出は以下の通り。 　basecodeのno 　basecodeのname 　basecodeのcode 　addcodeのbase 　addcodeのanum 　addcodeのbnum 　addcodeのcnum 　addcodeのdnum VIEWの作成条件としては以下の通り。 ＜条件＞ TABLE名：basecodeとaddcodeのnoが存在し、かつ、 baseaddのnoが複数あり、baseが同じものは以下で判断 　・anumとbnumとcnumが同一であればその中のdnumが最小であるレコードを抽出 　・anumとbnumとcnumが異なれば別々に抽出 上記より、以下のように抽出したい。 ＜TABLE名：basecodeview＞ ----------------------------------------------- no name code base anum bnum cnum dnum ----------------------------------------------- 2 bbbb 103 bbbb 1 1 1 1 3 cccc 203 cccc 12 13 10 0 3 cccc 203 dddd 12 15 3 1 5 eeee 101 eeee 10 3 12 1 5 eeee 101 eeee 13 12 15 0 7 hhhh 115 hhhh 4 3 11 0 7 hhhh 115 hhhh 4 3 13 2 ----------------------------------------------- よろしくお願いします。
aaa bbb ccc ddd eee ggg hhh ---------------------------------------------- 111 111 111 111 111 111 111 112 112 112 112 112 112 111 112 113 113 113 113 113 111 114 114 114 114 114 114 111 114 114 114 114 114 114 112 114 115 115 114 114 115 111 114 115 115 114 114 115 112 116 116 116 116 116 116 111 116 116 116 116 116 116 112 116 116 116 116 116 117 111 116 116 116 116 116 117 112 118 118 118 118 118 118 118 上記のようなデータより、SQLのSELECTを使用して、以下のように抽出したいです。 抽出条件は以下が全て満たしているものとなります。 ・aaa,ccc,ddd,eee,gggが重複、hhhが小さいもの ・bbbが異なるもの aaa bbb ccc ddd eee ggg hhh ---------------------------------------------- 112 112 112 112 112 112 111 ・・・(1) 112 113 113 113 113 113 111 ・・・(1) 114 114 114 114 114 114 111 ・・・(2) 114 115 114 114 114 115 111 ・・・(2) (1)はaaa,ccc,ddd,eee,gggが重複、bbbが異なるため抽出対象 (2)はaaa,ccc,ddd,eee,gggが重複、bbbが異なるため抽出対象 　また、hhhが小さいもの 以上、よろしくお願いします。
PL/pgSQL を使用し更新処理を行いたいのですが、 パラメータの数が多すぎるのか 以下のエラーでデータベースにファンクションを定義出来ません。 ERROR: functions cannot have more than 100 arguments SQLステート:54023 可変長引数で作成すると、データベースに定義は出来るのですが ファンクション実行時に同様のエラーが発生し更新処理が行えません。 PL/pgSQL の引数を100以上使用出来る様にする設定等、存在するのであれば 教えて頂きたいです。 環境は以下の内容です。 CentOS-6.2-x86_64 Apache/2.2.15 PostgreSQL 9.1.3 PHP Version 5.3.3 (PDOを使用しています)
性別をintegerの1,2に分けるテーブルをマスタデータと呼ぶんですか？メターデータとよぶのですか？ もしくわ、他の呼び方がありますか？
PostgreSQLのDBサーバがハードディスク故障で使えなくなり、新サーバに交換しましたが、幸い古いディスクからファイルシステムのデータをコピーできました。 この場合、どうやって新サーバにDBのリストアできるのでしょうか？ コピーされた古いディスクのファイルはdumpしてない元々のファイル群ですので、ちょっと復元のやり方が分かりません。 新サーバに同じバージョンのPostgreSQLをインストールして、古いファイルを上書きすればいいでしょうか？ ちなみに、旧サーバと新サーバのスペックは一緒です。 分かる方いればぜひ教えてください。
現在、Access2010＋Postgresqlにてシステムを構築しており ADOにてデータベースからレコードの検索・追加・更新を行っております。 今回質問させて頂きましたのはpostgresqlのチューニング方法についてです。 現在、あるテーブルにWANからVPNを経由して接続した状態でSELECTを行うと、 結果が帰ってくるまでにおよそ6分程度かかるテーブルがあります。 （LAN内では4秒程度） 抽出するフィールドを*ではなく、1フィールドに限定しても約4分程度かかります。 そのテーブルには約30000件ほどレコードが格納されており SELECTする際は、bool型のフィールドをWHERE条件に入れています。 例）SELECT * FROM tbl_test WHERE f条件 = TRUE; しかし同じテーブルの別のvarchar型フィールドにLIKE演算子で検索を かけると、すぐ（0.44秒）に結果が帰ってきます。 例）SELECT * FROM tbl_test WHERE 名称 LIKE '%テスト%'; 尚、この場合の結果は20件ほどですので、結果が早いのは当然ですが なぜbool型を条件にした場合に6分もかかってしまうのでしょうか。 システムの都合上、WANからVPNを経由してアクセスする事が必須ですので LAN内の速度が速くてもWANからの速度が遅いのはNGなのです。 一応、Web上で紹介されている一般的なチューニング方法を参考にし postgresql.confの設定値は下記の通りに行いました。 ・shared_buffers → 1024MB ・max_connections → 100 ・effective_cache_size → 512MB ・random_page_count → 2 ・work_mem → 3MB 恐らく根本的にどこかの設定や設計がまずい為、このような結果に なっているのであろうと思うのですが、それを特定するに至りません。 見直すべき点やアドバイスなどがあれば教えて下さい。 ＜サーバースペック＞ OS：WindowsXP Pro SP3 メモリ：3GB CPU：Pen4 2.8GHz Postgresqlバージョン：8.3
SELECT point FROM point_1 where id = 1; SELECT point FROM point_2 where id = 1; 別のテーブルの同じカラムで引き算をしたいです。 どうすればいいのでしょうか？
同じselect文でも 1回目のselect文と2回目のselect文の早さが全然違います。 なぜでしょう？
お世話になります。 Cygwin(ver:1.7.10-1)でPostgreSQL(ver:8.3.13)をインストールしたいのですが、make all時に以下のエラーが発生します。 Cygwinパッケージの不足等があるのでしょうか？何かアドバイスをいただけるとありがたいです。 ====================================================== rm -f thread.c && ln -s ../../../../src/port/thread.c . gcc -O2 -Wall -Wmissing-prototypes -Wpointer-arith -Winline -Wdeclaration-after-statement -Wendif-labels -fno-strict-aliasing -fwrapv -I../include -I../../../../src/interfaces/ecpg/include -I../../../../src/interfaces/libpq -I../../../../src/port -I../../../../src/include -DBUILDING_DLL -c -o thread.o thread.c dlltool --export-all --output-def ecpg.def execute.o typename.o descriptor.o data.o error.o prepare.o memory.o connect.o misc.o path.o pgstrcasecmp.o thread.o dllwrap -Wl,--enable-auto-import -o cygecpg.dll --dllname cygecpg.dll --def ecpg.def execute.o typename.o descriptor.o data.o error.o prepare.o memory.o connect.o misc.o path.o pgstrcasecmp.o thread.o -L../pgtypeslib -L../../../../src/interfaces/libpq -L../../../../src/port -L/usr/local/lib -lpgtypes -lpq -lm execute.o:execute.c:(.text+0x20e1): undefined reference to `_libintl_setlocale' execute.o:execute.c:(.text+0x2107): undefined reference to `_libintl_setlocale' execute.o:execute.c:(.text+0x251b): undefined reference to `_libintl_setlocale' execute.o:execute.c:(.text+0x255b): undefined reference to `_libintl_setlocale' execute.o:execute.c:(.text+0x262f): undefined reference to `_libintl_setlocale' execute.o:execute.c:(.text+0x26fb): more undefined references to `_libintl_setlocale' follow collect2: ld はステータス 1 で終了しました dllwrap: gcc exited with status 1 ../../../../src/Makefile.shlib:314: recipe for target `libecpg.a' failed make[4]: *** [libecpg.a] Error 1 make[4]: ディレクトリ `/home/nabe/postgresql-8.3.13/src/interfaces/ecpg/ecpglib' から出ます Makefile:6: recipe for target `all' failed make[3]: *** [all] Error 2 make[3]: ディレクトリ `/home/nabe/postgresql-8.3.13/src/interfaces/ecpg' から出ます Makefile:20: recipe for target `all' failed make[2]: *** [all] Error 2 make[2]: ディレクトリ `/home/nabe/postgresql-8.3.13/src/interfaces' から出ます Makefile:17: recipe for target `all' failed make[1]: *** [all] Error 2 make[1]: ディレクトリ `/home/nabe/postgresql-8.3.13/src' から出ます GNUmakefile:12: recipe for target `all' failed make: *** [all] Error 2
PostgreSQLでストアドファンクションを作成しました。 ファンクションの内容は下記の通りです。 CREATE FUNCTION getRenban (VARCHAR) RETURNS VARCHAR(7) AS ' DECLARE key ALIAS FOR $1; code VARCHAR(7); code2 VARCHAR(2); code5 VARCHAR(5); renban INTEGER; new_code VARCHAR(7); BEGIN SELECT MAX(code) INTO code FROM M_ITEM WHERE flg = TRIM($1); code2 := TRIM($1); IF code IS NULL THEN renban := 1; ELSE SELECT SUBSTR(code, 2) INTO code5; SELECT TO_NUMBER(code5, ''99999'') INTO renban; renban := renban + 1; END IF; code5 := ''''; SELECT TO_CHAR(renban, ''00000'') INTO code5; SELECT code2 || code5 INTO new_code; RETURN new_code; END; ' language 'plpgsql' ; コンソール上で下記のコマンドを実行したらエラーが出力されました。 SELECT getrenban('01'); 出力されたエラーの内容は下記の通りです。 ERROR: value too long for type character varying(5) CONTEXT: PL/pgSQL function "getrenban" line 19 at SQL statement お恥ずかしいですがいくらコードを見てもどこが原因なのかわかりません。 申し訳ありませんがご教授お願いできませんでしょうか。 昨日から悩んでいます。 どうか助けて下さい、宜しくお願いします。
伝票データを各テーブル(ヘッダと明細)に分けたい格納したいと考えています。 ※ヘッダ情報と明細にヘッダNoというフィールドを作成してこの値で紐付けるようにしています。 そこで皆さんに質問があります。 ヘッダ情報を削除した際に紐づいている明細データも一緒に削除され、明細のみ削除する際はヘッダ情報は削除されずに明細のみが削除されるような仕組みにするにはどうしたらいいでしょうか。 またこういう機能ってういか、仕組みの事を何て言うんでしょうか。 ※確かテーブルを作成する際に何か記述したらできたような記憶がするんですが・・・ 　間違っていたらすみません。 説明が下手ですみませんが理解していただけましたでしょうか。 申し訳ありませんがアドバイス宜しくお願いします。
テーブルを作成する際に下記の項目のフィールドを考えていますがいい英語のフィールド名が浮かびません。 ・作成者 ・作成日 ・更新者 ・更新日 申し訳ありませんがご教授いただけませんでしょうか。 また命名で気をつける事がありましたらアドバイスいただけたら幸いです。 宜しくお願いします。
windows7にインストールされていたpgAdminIII1.8.？(詳細なバージョン不明) をインストールして使用しておりました。 DB本体もインストールの必要が出てきたため、PostgreSQL9.1をインストールしました。 同時にpgAdminIII1.14もインストールされました。 DBのバックアップを使用と、pgAdminIII1.14でＤＢを選択し"ツール"から"バックアップ"を選択し バックアップを試みたのですが、バージョン違いでバックアップできないとのエラーがでました。 エラーの内容からpgAdminIII1.8のバックアップ実行ファイル呼び出しているものと思われたので pgAdminIII1.8、PostgreSQL9.1をコントロールパネルからアンインストールし、 インストールされていたフォルダを削除、 postgresのユーザーアカウントを削除、 postgresのユーザーフォルダを削除 再起動の後、PostgreSQL9.1を再度インストールしました。 pgAdminIII1.14からバックアップを試みようとしたのですが、 "ツール"からバックアップを選べなくなっており（グレーアウト） 右クリックメニューにも"バックアップ"が出てこなくなりました。 アンインストール前に設定していたサーバの設定が残っていたため、 正常にアンインストールされていなかったと推測しております。 困っております。 対処法をご存知の方がいらっしゃいましたら 教えてください。 よろしくお願いいたします。
Windows2008環境で、PostgreSQL8xを開発しています。 日次のバックアップで、DOSバッチからpg_dumpコマンドを実行し、 ダンプを取りたいと思います。 そこでサンプルを作成し、実行したのですが、 途中パスワードを聞かれてしまい、止まってしまいます。 実行は下記のコマンドです。 ＞＞pg_dump -U User01 -Fc testdb > backup.dat パスワードファイル、というファイルに 「ホスト名：ユーザ名：パスワード：DB」User01の エントリを追加したところ、パスワードが聞かれなくなりました。 これはマニュアルどおりだと思います。 ただファイルにユーザ毎にパスワードを書くのもどうもイマイチで 他の方法が無いか調べています。 ・パスワードを聞かれない管理ユーザで実行する ・実はpg_dumpでパスワードを指定するパラメータがある とかあれば良いのですが・・ パスワードファイル以外に、回避方法は ありますでしょうか？。
SQL文で“ある箇所のデータがNULLだったら指定した場所からデータを引用する”ということをしたいのですがどのように記述すれば良いのでしょうか？ 画像にあるようなテーブル構成だと仮定します。 やりたいこととして select A.XA, A.YA, A.ZA + M.M2, B.XB, B.YB B.ZB from A, B, M where A.XA = B.XB and A.YA = B.YB and B.ZB = M.M1 ; というような書き方です。 ちなみにM2のデータ型は「Interval Day？」とかいうような型らしい？です。名前忘れましたが・・・ このイラストから見るとマスターテーブルの“F5”のM2データがNULLです。 NULLデータは日付の加算ができなくなるので・・・対処したいのです。 このSQL文に加える処理として、 「もし、マスターテーブルのF5がNULLの場合のみG6のM2を参照する」 という構文を追加したいのですが・・・ そのような記述はSQL内で可能なのでしょうか？
データベースに 名前|取得時間 AAA|2011-12-11 19:00:33.562266 BBB|2011-12-16 18:53:13.163553 CCC|2011-12-19 14:01:35.91384 ってあった際に、18時から20時の間だけ抽出して 名前|取得時間 AAA|2011-12-11 19:00:33.562266 BBB|2011-12-16 18:53:13.163553 と表示したいです。 時間はnow()でINSERTしています。 宜しくお願いします。
PostgreSQLで、テーブル(2)の情報をキーに(1)を削除したいのですが、エラーが出てしまいます。 どなたか解決策をご存知の方いらっしゃいましたら ご教授宜しくお願い致します。 _構造_____________________ テーブル(1)・・カラムA テーブル(2)・・カラムA、カラムB _SQL文_____________________ DELETE FROM (1) INNER JOIN (2) ON (1).カラムA= (2).カラムA WHERE (2).カラムB=X _エラーメッセージ__________ [Err] ERROR: syntax error at or near "INNER"
postgresqlのupdateについて質問です。 一つのテーブルで二つの列と任意の文字を別の列へ結合するupdate文を作りたいのですが初心者なものでわかりやすくご教授いただけたら幸いです。 UPDATE テーブル名 SET 列3 = '文字' || "列1" || '文字' || "列2" WHERE 列 Is Null; 何卒、よろしくお願い致します。
お願いします。 環境 PostgreSQL 8.1 どなたか、 varcharからnumericへの型の変更 する方法をご存知ないでしょうか
初めて質問させていただきます。 勉強のため、私物のノートパソコンに、PostgresSQL9.0.6 をインストールしようとしています。 ところが、ダウンロード終了後、「実行」を押しても、何も起きません。 http://www.yamada-lab.org/doc/win_vista/postgres … 上記のアドレスのページで、 ・非管理者アカウントの作成 ・そのアカウントで、ローカルセキュリティポリシーを設定 を行わなければならない、というところまでは掴みましたが、 Windows7　でその設定をする方法がわかりません。 OSはWindows7のHomeEditionです。 そもそも、HomeEditionでは、PostgresSQLをインストールすることはできないのでしょうか。
テーブルの移行（Aテーブルのデータをキーを変更してBテーブルにInsertする）を行ったところ、 ERROR: duplicate key violates unique constraint "Bテーブル_unique"とメッセージが出ます。 SQL文はつぎの通りです。 INSERT INTO Bテーブル(契約番号, ユニット番号, 資源番号, 入力日, 数量) SELECT a.契約番号, a.ユニット番号, a.資源番号, a.入力日, a.数量 FROM Aテーブル a ; Bテーブルのキーは、契約番号, ユニット番号, 資源番号, 入力日です。 Aテーブルのキーは、契約番号,入力日,レベル１,レベル２です。 データ件数は約３万件です。 Bテーブルを調査して、重複となるレコードを表示させたいのですが、 SQL文がわかりません。 よろしくご教授ください。
postgresqlのデータをcsvテキストに出力してmysqlに入れたら、booleanデータがmysqlではすべて 0 になりました。 postgresqlのbooleanはt/f表現であり、mysqlでは1/0表現のためと思いますが、うまく処理する方法はないでしょうか？ 2011 Dec. 18.
性能を考えた場合、文字列を格納するカラムはvarcharとtextではやはりvarcharの方が優れているのでしょうか？ 文字列には最大120文字しか入れない想定です。 それともバージョンによっては、特に差異はないとかありますか？
Postgres9のconfigureで--disable-thread-safetyをセットした場合の影響について調べています。 マニュアルには -------------------------------------- クライアントライブラリのスレッドセーフを無効にします。これにより、libpqやECPGプログラム内 の同時実行スレッドは、安全にその固有の接続ハンドルを制御できなくなります。 -------------------------------------- と書かれています。 言葉の意味そのままだと、安全でなくなるように読み取れます。 JavaやPerlで作成したWebアプリからのDB操作を行なっていますが、 プログラム側で意図的にスレッドを作ったりはしていません。 このような環境で、--disable-thread-safetyにするのは何かしらの不都合が発生するのでしょうか？ どういった問題が起こりえるのかを知りたいです。 どなたかご存じの方がいらっしゃいましたらご教授願います。
Solaris10にpostgres9.0.5をインストールしようとしています。 Solarisには現時点での最新パッチが当たっている状態です(詳細はちょっと不明) 以下のオプションでconfigureを行うと、エラーになります。 ./configure --prefix=/usr/local/postgres --without-readline --enable-thread-safety 以下エラー --------------------------------------------------------------- checking thread safety of required library functions... no configure: error: thread test program failed This platform is not thread-safe. Check the file 'config.log' or compile and run src/test/thread/thread_test for the exact reason. Use --disable-thread-safety to disable thread safety. --------------------------------------------------------------- config.logの中のエラーの内容 --------------------------------------------------------------- configure:28765: checking thread safety of required library functions configure:28798: gcc -m64 -o conftest -O2 -Wall -Wmissing-prototypes -Wpointer-arith -Wdeclaration-after-statement -Wend if-labels -fno-strict-aliasing -fwrapv -pthreads -pthreads -D_REENTRANT -D_THREAD_SAFE -D_POSIX_PTHREAD_SEMANTICS -D IN_CONFIGURE conftest.c -lz -lnsl -lsocket -lm -lpthread -lpthread >&5 Undefined first referenced symbol in file sched_yield /var/tmp//ccVp73Io.o collect2: ld returned 1 exit status ld: fatal: symbol referencing errors. No output written to conftest configure:28802: $? = 1 configure: program exited with status 1 --------------------------------------------------------------- thread-safetyを無効にすれば正常にインストールできます。 このエラーを回避するにはどうすればよいでしょうか？ あまり参考にはならない情報かもしれませんが、9.0.4/9.1.1でも同様のエラーが出ます。
前回の質問を間違えて、解決済にしてしまいました。 前回の質問番号はQNo.7135032です。 改めて質問させて頂きます。 下記ファンクションにて実行してみたのですが、うまくいきません。 CREATE OR REPLACE FUNCTION raise_test(in i_data_num numeric, out o_data_num numeric, out o_data_char character varying) RETURNS integer AS 度重なる質問で、誠に申し訳ございませんが、手法をご教授ください。 よろしくお願いいたします。
Aというテーブルのaカラムが更新されれば、Bテーブルの列の中でAテーブルの列id含む列（複数）のbカラムをFalseからTrueに変更されるような、トリガー　と　プロシージャを作りたいのです。 考えていたのは、プロシージャは、 CREATE FUNCTION update_edit_b() RETURNS OPAQUE AS ' BEGIN （複数列指定？） NEW.b := 't'; RETURN NEW; END; ' LANGUAGE 'plpgsql'; プロシージャで、Bテーブルの複数列を指定するにはどうしたら良いでしょうか？ トリガーは CREATE TRIGGER trgger_a AFTER UPDATE OF a ON Table_a FOR EACH STATEMENT EXECUTE PROCEDURE update_edit_b ; こんな感じでしょうか？
お世話になります。 SQLからSQLを呼び出す形で以下のことを行おうとしています。 呼び出し元のSQLにRAISE文を記述し、フィールドの内容を表示させようとしているのですが、 SELECTで実行すると、「PERFROMに変更してください」とのエラーになってしまいます。 そこで、PERFORMに変更し実行しますと、RAISE文の結果が表示されません。 また、PERFORMのままで表示させるには、呼び出し先のSQLにRAISE文を記述すれば 良いようなのですが、呼び出し先のSQLに手を加えたくありません。 （呼び出し先のSQLをテストしているので・・・。） どなたか、うまく表示させる方法をご存知の方がいらっしゃいましたら、是非とも ご教授下さい。 よろしくお願い致します。
初歩的な質問で申し訳ありません。 テーブルＡの中に、キー１が１００から１０９までのキーを持つレコードがあるかないかを調べるＳＱＬ文を教えてください。 テーブルＡ キー１　キー２ 100　　　1 100　　　2 105　　　1 107　　　1 上記の場合結果は 100　　有り 101　　なし 102　　なし 103　　なし 104　　なし 105　　有り 106　　なし 107　　有り 108　　なし 109　　なし と表示したいのです。 よろしくご教授ください。
約2万件のデータ読込み、帳票を作成してダウンロードする処理があるのですが、 最初のリクエストでの処理時間が３３秒もかかります。 しかし、続けて同じ処理をさせていると、3回目には８秒にまで短縮しました。 繰り返しているとDBアクセス処理が早くなるのはどうしてでしょうか？ 使っている言語は　Java DBソフトは　PostgreSQL　です。 よろしくご教授ください。
以下のようなビットフラグのレコードが３レコードあるとして、 table name : bit_flg flg 　| name --------------------------- 0010 | ビットフラグ１ 0100 | ビットフラグ2 1000 | ビットフラグ3 このflgカラム全てのand結果(1110)がほしいのですが、どうすればよいでしょうか。 自分でグルグル回さず"SELECT hoge(flg) FROM bit_flg"のような感じでほしいのです。。 宜しくお願いします。
PostgreSQLが既に起動しているにも関わらず、 操作ミスで『psql.exe』をダブルクリックしてしまい、 コマンドプロンプトが立ち上がりパスワードを求められたので「postgres」を入力しましたら、 コマンドプロンプトが閉じました。 動作確認を行った結果、使用しているアプリケーションの動作は問題なさそうだったのですが、 何か問題とか起こってないでしょうか。 PostgreSQLがまったく初心者の為、大変申し訳ありませんがご回答よろしくお願い致します。
Windows版のPostgreSQLを使用していますが、ブロックサイズをデフォルトの8Kから 変更をおこないたいと考えています。 UNIX版であればconfigureコマンドにて設定を行うようですが、 Windows版はどのように設定すれば良いのでしょうか？ ちなみにバージョンは9.0.5でWindows7の環境です。
first_table f_idf_name 1鈴木 2田中 3佐藤 last_table l_idl_name 1一郎 1二郎 2太郎 3次郎 欲しい結果 idf_namel_name1l_name2 1鈴木一郎二朗 2田中太郎（空白もしくはNULL） 3佐藤次郎（空白もしくはNULL） PHP4.3.2とPostgresql7.4.29の環境です。 first_tableとlast_tableの2つのテーブルがあって、 欲しい結果のような表を作成したいです。 l_name1やl_name2でのキーワード検索も行いたいので、1つのSQL文を発行したいのですが、 どのように書けば良いのでしょうか？ last_tableを自己結合し、first_tableと結合するのが近い気がするのですが。 SELECT * FROM first_table AS f INNER JOIN ( SELECT l1.l_id, l1.l_name AS l_name1, l2.l_name AS l_name2 FROM l_table AS l1, l_table AS l2 WHERE l1.l_name > l2.l_name AND l1.l_id = l2.l_id ) AS l ON f.f_id=l.l_id よろしくお願いします。
テーブルのカラムのデフォルト値に create table test(test integer default 0xffffff); というように１６進数を指定したのですが、 ERROR: syntax error at or near "xffffff" とエラーが発生していまいます。 １６進数を指定するにはどうすれば良いのでしょうか？
テーブル作成時、カラムにUNIQUEをつけると自動でインデックステーブルが作成されますが、このインデックステーブルで、通常のselect検索も早くなるのでしょうか？ 具体的には、ユニークなカラムidを持つテーブルtableA create table tableA( id INTEGER UNIQUE, some_column INTEGER ); を作ったあとで、そのidにあらためて CREATE INDEX id ON tableA (id); と、インデックスを張る必要があるのでしょうか。 よろしくお願いします。
PostgreSQLをインストールしたいのですが、以下のエラーが発生して、インストールが正常に行われていないようです。 ●A non-fatal error occured whilst loading database modules. 　Please check the installation log in [一時フォルダ] ●Problem running post-install step. Installation may not 　complete correctly 　Error reading file [インストールフォルダ]/data/postgresql.conf 1番目の内容からログファイル(bitrock_installer_xxxx.log)を見たのですが文字化け部分があり、具体的な内容がわかりませんでした。 Loading additional SQL modules... Executing cscript //NoLogo "[インストールフォルダ]\installer\server\loadmodules.vbs" "postgres" "****" "[インストールフォルダ]" "[インストールフォルダ]\data" 5432 Script exit code: 2 Script output: Installing the adminpack module in the postgres database... Executing '[一時フォルダ]\rad9D9FD.bat'... psql: 繧オ繝シ繝舌↓謗・邯壹〒縺阪∪縺帙ｓ縺ァ縺励◆: Connection refused (0x0000274D/10061) 繧オ繝シ繝舌・繝帙せ繝・"localhost" (::1) 縺ァ遞シ蜍輔＠縺ヲ縺翫ｊ縲・ 縺セ縺溘√・繝シ繝・5432 縺ァ TCP/IP 謗・邯壹ｒ蜿励￠莉倥￠縺ヲ縺・∪縺吶°? 繧オ繝シ繝舌↓謗・邯壹〒縺阪∪縺帙ｓ縺ァ縺励◆: Connection refused (0x0000274D/10061) 繧オ繝シ繝舌・繝帙せ繝・"localhost" (127.0.0.1) 縺ァ遞シ蜍輔＠縺ヲ縺翫ｊ縲・ 縺セ縺溘√・繝シ繝・5432 縺ァ TCP/IP 謗・邯壹ｒ蜿励￠莉倥￠縺ヲ縺・∪縺吶°? Failed to install the 'adminpack' module in the 'postgres' database loadmodules.vbs ran to completion Script stderr: Program ended with an error exit code Error running cscript //NoLogo "[インストールフォルダ]\9.1\installer\server\loadmodules.vbs" "postgres" "****" "[インストールフォルダ]\9.1" "[インストールフォルダ]\data" 5432 : Program ended with an error exit code 2番目はファイル自体が作られていません。 http://www.yamada-lab.org/doc/win_vista/postgres … を参考にしましたが、結果は同じでした。 原因、解決策が分かれば教えてください。 OS: Windows 7 Ultimate 64bit SP1 PostgreSQLのバージョン: 9.1.1
Webアプリをoracleからpostgresqlに移行しています。 行き詰ってしまったので、どなたかアドバイスをお願いします！ セッション１で 　LOCK TABLE abc IN EXCLUSIVE MODE としている状態で、セッション２で select処理をして内容表示する処理があるのですが posgreでは、トランザクションを終了しないと、セッション２は止まったままになってしまいます。 セッション１のトランザクションを終了すると、セッション２で正常に表示できるのですが。。。 oracleでは、selectがLOCK前の状態で結果を返してくれるので セッション２も正常に表示できています。 いろいろ調べて、selectはＯＫのようなMODEも試したのですが、 解決できませんでした。 該当テーブルはROW単位ではなく、全体でLOCKしないとダメなのです。 ※試した方法は、 psqlで該当テーブルを、IN EXCLUSIVE MODEでLOCKし、Webアプリで select表示する処理を行いました。 よろしくお願いします。
シーケンス型で取得した値を別テーブルで利用する方法を別テーブルの設定したい場合，どうすればいいでしょうか． 例えば，商品情報が入っている商品テーブルのidを価格テーブルに結びつけたい場合 ・トランザクション開始 ・商品テーブルにinsert ・コミット ・トランザクション開始 ・シーケンスより最大値を取得 ・価格テーブルにシーケンスより得られた値を含めてinsert ・コミット このままですと価格テーブルの時に何らかの問題でロールバックした場合，商品テーブルには価格テーブルと関係性がないレコードができてしまいます．
WEB APでデータベースを勉強中のものです． ユーザを管理するID番号をデータベースの連番IDではなく，文字列のIDにしたいのですが，どうすればいいでしょうか．PHP等で作成する方法でもいいです． 文字列IDにすると特定されにくいかなって思っています． 例えば A100001 C100002 です．
postgresの外部結合で質問です。 テーブルを複数外部結合する場合、 A（左）B(右)、 A（左) C（右）と外部結合する場合のSQLはよく載っているのですが A（左)B(右)で外部結合、 そしてさらに B（左）C（右）の外部結合のSQL例がなかなか載っておらず、見つけれません。 どなたか教えてください。
質問させてください。 SQLのJOINで複数の表をまとめる場合、以下のどちらの方法が一般的でしょうか。 A, B, C : 表 X, Y : 条件 表ごとにくぎる (A INNER JOIN B ON X) INNER JOIN C ON Y 条件ごとにくぎる A INNER JOIN B INNER JOIN C ON Y ON X 以上よろしくお願いいたします。
質問させてください PostgreSQLでは集約関数をネストできないのでしょうか。 以下の命令を実行すると「集約関数をネストできない」というエラーになります。 SELECT RCT_NO, MAX(SUM(BUYNUM)) FROM TRN_RECEIPT_DETAILS GROUP BY RCT_NO 実行環境はPostGreSQL 8です。 解決策をご存知でしたらお教えください。
現在mac上にVisualBoxでCentOSをいれており その中にPostgreSQLでDBを作成しました。 phpでpg_conect、何も表示されません。 エラーメッセージもなしです。 phpの保存場所は/var/www/htmlです。 エラーもなしなので場所が悪いのでしょうか？？ 初心者な質問ですいません。
データベースで表示算のような計算は可能ですか？ データベースで在庫数管理を行いたいのですが、集計方法がわかりません。Postgreで、以下のデータベースで計算可能な方法があれば教えてください。 データは日付と入出庫及び3/4時点での在庫数がわかった場合、 下記のテーブルをSQLなどで作成は可能でしょうか？ Excelだと簡単なのですが ------------------ 日付 入出庫 在庫 3/4 0 30 3/5 10 40 3/6 -5 35 3/7 -20 20 ----------------- 素案としては日付、ソート後、１つずつデータを取り出し、集計結果を在庫にUpdateする予定です。 アドバイスお願いします
PostgreSQLに関して質問です。PostrgreSQLを使い始めたのですが、テーブルのデータ定義を確認するコマンドを作成しています。 MｙSQLでは「SHOW COLUMNS FROM DESC テーブル名」で取得出来るんですが、PostrgreSQLにはあるんでしょうか 教えてください
データベースを勉強しているものです． 勉強の題材としてWEBアプリで予約システムみたいなものを作ってみているのですが，正規化したテーブルに対してデータを追加する際にどのようにすればいいのか悩んでいます． 予約tableと予約詳細tableを作り，予約IDで関係付けようと思っているのですが， 予約が入った際に予約tableのデータをinsertしてから予約詳細tableにinsertをすると思われます．このとき，予約詳細tableにデータをinsertする際に予約IDをどのように入れたらいいでしょうか． １．トランザクション開始 ２．予約IDを払い出し（WebAP上の変数で保持する） ３．予約tableに予約IDと登録するデータをinsert ４．予約詳細tableに予約IDと登録するデータをinsert ５．コミット これをやってしまうと予約IDが別のセッションで同じIDになってしまう恐れがあります． どうしたらいいでしょうか． 予約IDテーブルでも作って，払い出した際に，他のセッションに奪われないように作るなどの方法をとればいいのでしょうか．
POSTGRESQLではCREATE PROCEDUREはできないのでしょうか？ プロシージャで以下のコマンドを使用したいのですがFUNCTIONでは代用できませんでした。 どうしたらいいですか。 STRART TRANSACTION COMMIT; ROLLBACK;
質問させてください。 pg_restoreコマンドの-Cオプションって、何に使用するのでしょう？ ヘルプを読む限り、データベースを作成するとあるのですが、特に何か変化があるわけでもなく・・・。 -Cがあってもなくても動作は変わらないように感じています。 素人質問で大変申し訳ありませんが、どなたか回答をお願いしたいです。
質問させてください。 例えば、以下のコマンドを実行してpostgreSQLでリストアをするとします psql -h localhost -U postgres -d testdb この場合、testdbというDBを作成していないと、エラーになります。 DBまで自動的に作成するコマンドはありませんでしょうか。 psql、pg_restoreの両方でお聞きしたいです。
SoundMAXについて 僕のPCはnoteパソコンです。 それでマイク内臓で、ゲームをキャプチャーしたいのですが、 ゲームの音だけでやりたいのですが、そとの声が入ってしまいます。 ですから、実況しか使えません ゲームの音声だけで、captureする方法はありませんか
PostgreSQLでスーパーユーザー(管理者)が他のユーザー(利用者)のパスワードを閲覧する方法WindowsXPのPCにxampp(Apache+MySQL+PHP+Perl)を導入し、PostgreSQLも導入しました。 PostgreSQLに２人のユーザアカウントを作成しました。 postgreでデータベースにログインし、 alter rolg visitor with pssword 'test'; とすればvisiorのパスワードを変更できます。 しかしvisiorの現在のパスワードを閲覧する方法がわかりません。 教えてください
plpgsqlのエスケープ文字について教えてください tblのテーブルのnameフィールドの値をtitleフィールドに更新する関数を作成してます。 cur cursor for SELECT id, name FROM tbl; rec RECO RD; begin open cur; LOOP FETCH cur INTO rec; EXIT WHEM NOT FOUND; w_sql := ''UPDAT tbl SET title = ''; w_sql := w_sql ll '' ''''タイトル: '' ll rec.name ll '' '''' ''; w_sql := w_sql ll '' WHERE id= '' ll rec.id= '' ll rec.id ; EXECUTE w_sql; END LOOP; ・ ・ ・ ・ ・ 上記のようにnameフィールドの値をset句に設定していますが、 nameフィールドには 「90's」 や「men's」 のような値が入ったレコードがあるためエラーとなってしまいます。 name内の「'」をエスケープする為にはどのように書けばよいでしょうか 教えてください
PHPとPostgreSQLでサイト作ってます。HTMLのフォームタグを利用し、ユーザーが選択した画像(ユーザーのPC内のもの)をPostgreSQLで保存するにはどうしたらいいですか 教えてください
CentOS5.5×2 PostgreSQL8.4.4×2 リストア時にinvalid command \Nというエラーが出ます insertコマンドであれば普通に通るのですが、 出力ファイルが10G近くありダンプ+アップロード+リストアで一日半近く掛ってしまいます エディタで内容を確認しようにもファイルが大きすぎるため開けません どのようにすればリストアできますでしょうか
pgPool-IIで2つのデータベースの同期を取る環境を構築しようとしています。 片方のデータベースがダウンした際に、メール等で通知する方法は何かないでしょうか？ 宜しくお願いします。
の中に CREATE TABLE EMP ( name text, salary integer, age integer, cubicle point ); INSERT INTO EMP VALUES ('Sam', 1200, 16, '(1,1)'); INSERT INTO EMP VALUES ('Claire', 5000, 32, '(1,2)'); INSERT INTO EMP VALUES ('Andy', -1000, 2, '(1,3)'); INSERT INTO EMP VALUES ('Bill', 4200, 36, '(2,1)'); INSERT INTO EMP VALUES ('Ginger', 4800, 30, '(2,4)'); -- the argument of a function can also be a tuple. For instance, -- double_salary takes a tuple of the EMP table CREATE FUNCTION double_salary(EMP) RETURNS integer AS 'SELECT $1.salary * 2 AS salary' LANGUAGE SQL; SELECT name, double_salary(EMP) AS dream FROM EMP WHERE EMP.cubicle ~= '(2,1)'::point; というコードが有るのですが 最後のWHERE EMP.cubicle ~= '(2,1)'::pointの ~= はどういうもので どんなときにつかうのでしょうか？ また単なる = ではエラーになるようなのですが=との使い分けはどのようにすれば良いのでしょうか? よろしくお願いします
次のような構造テーブルがあったとします。 create table sample_tbl ( no numeric(7) primary key, val numeric[] not null ) ※val列は 配列型。 テーブルの中身は次のような状態 no　　　　　val -------　---------------- 1　　　　　　{1,2,5} 2　　　　　　{1,3,4,5} 3　　　　　　{2} 4　　　　　　{1,5} 5　　　　　　{1,2,3,4,5} 6　　　　　　{1,5} 最終的に "val列" の中身の数値ごとの件数を知りたいです。 ＜欲しい結果＞ 1 → 5件 2 → 3件 3 → 2件 4 → 2件 5 → 5件 SQLのみを用いたできるだけ単純（一時テーブルなどを使わずに） 且つ高速な方法を探しております。 何か良い方法はありますでしょうか・・？ よろしくお願いいたします。
roleを使わないでuserばかり使っても 動いているようなのですが そもそもroleは何でしょうか？ roleはなんのためにあるのでしょうか？ userとroleの使い分けはどのようにするのでしょうか？ 以上どれでもいいのですが教えてください よろしくお願いします
PostgreSQL 8.4.8 文書にのっているサンプルプログラムの 例 30-1. libpq サンプルプログラム 1 #include <stdio.h> #include <stdlib.h> #include "libpq-fe.h" ・・・・・・・・・・・・・ をコピペしてコンパイルしたところ次のようなエラーがでました # gcc sample.c /tmp/cctZBolQ.o: In function `exit_nicely': sample.c:(.text+0xd): undefined reference to `PQfinish' /tmp/cctZBolQ.o: In function `main': sample.c:(.text+0x4a): undefined reference to `PQconnectdb' sample.c:(.text+0x5a): undefined reference to `PQstatus' sample.c:(.text+0x6a): undefined reference to `PQerrorMessage' sample.c:(.text+0xa5): undefined reference to `PQexec' sample.c:(.text+0xb5): undefined reference to `PQresultStatus' sample.c:(.text+0xc6): undefined reference to `PQerrorMessage' sample.c:(.text+0xed): undefined reference to `PQclear' sample.c:(.text+0x105): undefined reference to `PQclear' sample.c:(.text+0x119): undefined reference to `PQexec' sample.c:(.text+0x129): undefined reference to `PQresultStatus' sample.c:(.text+0x13a): undefined reference to `PQerrorMessage' sample.c:(.text+0x161): undefined reference to `PQclear' sample.c:(.text+0x179): undefined reference to `PQclear' sample.c:(.text+0x18d): undefined reference to `PQexec' sample.c:(.text+0x19d): undefined reference to `PQresultStatus' sample.c:(.text+0x1ae): undefined reference to `PQerrorMessage' sample.c:(.text+0x1d5): undefined reference to `PQclear' sample.c:(.text+0x1ed): undefined reference to `PQnfields' sample.c:(.text+0x20f): undefined reference to `PQfname' sample.c:(.text+0x26b): undefined reference to `PQgetvalue' sample.c:(.text+0x2a8): undefined reference to `PQntuples' sample.c:(.text+0x2ba): undefined reference to `PQclear' sample.c:(.text+0x2ce): undefined reference to `PQexec' sample.c:(.text+0x2de): undefined reference to `PQclear' sample.c:(.text+0x2f2): undefined reference to `PQexec' sample.c:(.text+0x302): undefined reference to `PQclear' sample.c:(.text+0x30e): undefined reference to `PQfinish' collect2: ld はステータス 1 で終了しました # # find /usr/include/ -name libpq*.h /usr/include/pgsql/internal/libpq-int.h /usr/include/pgsql/server/libpq/libpq-be.h /usr/include/pgsql/server/libpq/libpq.h /usr/include/pgsql/server/libpq/libpq-fs.h /usr/include/libpq/libpq-fs.h /usr/include/libpq-events.h /usr/include/libpq-fe.h # gcc -I/usr/include sample.c でもおなじです どうすればコンパイル出きるようになるでしょうか? よろしくお願いします
日頃はデザイン関連の作業担当なのですが、、、、 データの重複チェック方法で　 会員番号と店舗番号を入力するのですが　登録画面には //会員番号重複チェック if(Duplication_Check2("store_table","'".$kaiin_no."'",$tenpo_no)){ $err .= "会員NO「".$kaiin_no."」で店舗NO「".$tenpo_no."」は既に登録されています。<br />"; } としてまして、重複のエラー表示をさせています。 重複チェックの関数定義では //重複チェック2 function Duplication_Check2($kaiin_no,$tenpo_no){ global $db; $sql = "select * from store_table where kaiin_no='".$kaiin_no."' and tenpo_no=".$tenpo_no; $rst = pg_query($db,$sql); if($rst){ if(pg_num_rows($rst) = 0){ return true; }else{ return false; } }else{ return false; } } としたのですが　ここに文法エラーが出ます。 初心者の質問で恐縮なのですがどこをどうすればいいのでしょうか？ ご教授いただければ幸いです。
こんにちは。 現在アンケートサイトを作成しているのですが、チェックボックスを利用した質問の複数選択した回答をデータベースに登録できません。 htmlやphp、PostgreSQLに詳しい方指摘お願いします。 ※sample.html <form method="post" action="sample.php"> <b>7.あなたはどのような資格を持っていますか？</b><br> <input type="checkbox" name="sikaku[]" value="1" checked>ITパスポート <input type="checkbox" name="sikaku[]" value="2">漢字検定3級以上 <input type="checkbox" name="sikaku[]" value="3">英語検定3級以上 <input type="checkbox" name="sikaku[]" value="4">自動車運転免許 <input type="checkbox" name="sikaku[]" value="5">簿記 <input type="checkbox" name="sikaku[]" value="6">宅建 <input type="checkbox" name="sikaku[]" value="7">TOEIC600点以上 <input type="checkbox" name="sikaku[]" value="8">その他<br><br> <input type="submit" name="OK" value="OK"> </form> ※sample.php <?php //htmlから"sikaku"を取得 $sikaku = $_REQUEST["sikaku"]; //dbに接続・dbに書き込みSQL文 $dbconn = pg_connect ("dbname=****** user=********"); $result = pg_query ($dbconn, urldecode("insert into sample03 values('$sikaku');")); //接続を閉じる pg_close($dbconn); ?> ※PostgreSQL(table : sample03) //テーブル作成 ********=> create table sample03( ********(> 資格 int); CREATE TABLE //権限 ********=> grant select on sample03 to ********; GRANT //テーブルの表示 ********=> select * from sample03; 資格 ------ (0 rows)
以下の（２）（３）のaをデフォルトであるシーケンスの値を強制入力しエラーを回避する方法はありますか？ create sequence testseq start 1; create table test(a int not null default nextval('testseq'), b int); --（１）成功 insert into test (b) values(0); --（２）エラー insert into test (a,b) values(null,0); --（３）エラー insert into test values(null,0);
POSTGRESのPSQLで大量レコードをSELECTすると結果の後半が-- More --と なり一部しか表示しかされません。 （１）ENTERを押すと1行すすみますが、画面表示分（２０レコードぐらい）まとめて すすめる方法はありますか （２）MOREを表示せず一気に全行表示する方法はありますか
create table test (a varchar(10), b varchar(10)); insert into test values ('a','a'); insert into test values ('b','b'); insert into test values ('b','c'); insert into test values ('c','d'); select count(*), a, b from test group by a; 上記を実行するとMYSQLでは +----------+------+------+ | count(*) | a | b | +----------+------+------+ | 1 | a | a | | 2 | b | b | | 1 | c | d | +----------+------+------+ という結果になる。 POSTGRESでは以下のエラーになります。 ERROR: column "test.b" must appear in the GROUP BY clause or be used in an aggr egate function select count(*), a, b from test group by a, b;　とすると結果が変わってしまいます。 MYSQLと同じ結果をPOSTGRESで得るいい方法はありますか？
ちょっと躓いてしまったのでアドバイスが頂けたらと思います。 user_accountというテーブルと、logというテーブルがあります。 logというテーブルには各ユーザーの書き込み履歴が残されており、日付がtimestamp形式で格納されています。 ユーザー一覧に最終発言内容をくっ付けて表示したいのですがうまくいきません。 SELECT DISTINCT * FROM user_accounts LEFT JOIN (SELECT * FROM log ORDER BY update_date DESC ) aaa ON user_accounts.pkey = aaa.user_accounts_pkey; などと記述してみましたが、思うような結果になりません。 自分の理想とする結果は以下のような出力結果です。 +----+----+----+--+-----------------+----------------+-----------+ |　pkey|　user|　pass|　　　　　　comment|　update_date| +----+----+----+--+-----------------+----------------+-----------+ |　　1　|　test1|　pass01|test03 written by test1|　40813| |　　2　|　test2|　pass02|testestest　　　　　　　　|　40690| どうか、お知恵を貸してください。
現在アンケートサイトを作成しているのですが、チェックボックス型のアンケートサイトから数値データをデータベースに登録し、そのデータをエクセルにインポートしてグラフを利用してデータの統計・分析を行いたいと思っています。 そこで、ODBCを使ってデータをインポートしようと思っているのですが、データベースが大学のサーバーであるため、どのように設定したらよいのかわかりません。 外部サーバーにあるデータベースにODBCを使用することは可能なんでしょうか？
　フルバキュームは、何度かに分けることが出来るのでしょうか？ 　テスト用にデータベースを作っているのですが、テストのしすぎで重くなってしまいました。 　ググるとフルバキュームをかけると良いとのことで、かけてみたところ、丸１日たっても終りません。 　で、ふと疑問に思ったのですが、 フルバキュームをする→途中で止めた場合、途中で止めるまでの部分は有る程度有効なのでしょうか？ 　windowsのデフラグの場合、途中で止めても途中まではデフラグされているので、再開した場合、最初からやった時より少しは早く出来たと記憶しています。 　バキュームの場合も同じようなイメージなのでしょうか？ 　初歩的な質問で恐縮ですが、お詳しいかた、教えていただけると助かります。
PostgreSQLをエクセルに連携し、データベースのデータをエクセルにインポートして、分析を行いたいと思っているのですが、ODBCを使わずにエクセルと連携でないでしょうか？ なぜならば、現在使用しているデータベースは大学のサーバーにあるので、ODBCをインストールできないからです。 以前、TeraTermからSSHを利用して、データをインポート・エクスポートすることができたのですが、これを利用してエクセルと連携できないでしょうか？
こんばんは、いつもお世話になっています。 現在アンケートサイトを作成しており、phpのページからチェックボックスでチェックしたデータを数値データとしてPostgreSQLに登録しております。 そこで、エクセルを使用して、PosegreSQLに登録された数値データから円グラフや棒グラフを使って、データの分析・統計をとりたいと思っています。 PostgreSQLとExcelを連動させることは可能なのでしょうか？
現在アンケートサイトを作成しているのですが、アンケートのデータを利用して円グラフや棒グラフを使って統計などを調べたいと思っています。 そこで、php作成されたアンケートのページからラジオボタンやチェックボックスでチェックされたデータをデータベース（PostgreSQL)に登録する際、valueの値を文字情報でデータベースに登録するほうが良いのか、数字情報で登録したほうが良いか教えてください。 ※数字 <input type="radio" name="sample" value="1">長野県 <input type="radio" name="sample" value="2">東京都 <input type="radio" name="sample" value="3">神奈川県 ※文字 <input type="radio" name="sample" value="長野県">長野県 <input type="radio" name="sample" value="東京都">東京都 <input type="radio" name="sample" value="神奈川県">神奈川県
PostgreSQL でレプリケーションを構築予定（非同期）ですが、 PostgreSQL 9.0 の組み込みレプリケーションか、pgpool-II のレプリケーションかで迷っています。 それぞれを比較した際の長所と短所は何になるのでしょうか？ また、PostgreSQL 9.0 は安定していてエンタープライズ用途でも問題ないのでしょうか？ 本番サーバ１台、待機サーバ１台の２台体制です。 よろしくお願い致します。
SELECT MAX(CASE WHEN fld IS NULL THEN 0 ELSE fld END) FROM tbl ; tblテーブルのfldの最大値を取得するSQLを作りたいのですが、tblテーブルにレコードが登録されていない時に「０」を出力したいと思っています。 上記のSQLだとレコードが０の場合はfldの値がないため、０を出力してくれません。 どのように修正すればレコード０件のときに「０」を出力してくれるでしょうか。 宜しくお願いします。
ERROR: direct correlated subquery unsupported as initplan 上記エラーはどういう意味ですか？
postgresql 8.3のドキュメントを探していますが、どうしても９のところに行ってしまいます。 ダウンロードできるＵＲＬがあれば教えて下さい。
現在、自宅から大学へ接続し、TeraTermからPostgreSQL8.1.23を利用しています。 なので、自宅のプログラムファイルの中にはpgsqlというファイルがありません。 そこで、作成したテーブルを自宅のPCでエクスポートしたいのですができません。 <インポートを実行した場合> a=>\copy example from import.txt; \. と表示され、なぜか違うテーブルのデータが増える。 <エクスポート> a=>\copy example to export.txt; a=> なにも表示されず、デスクトップに用意したexport.txtには、データが書き込まれません。 この場合、import.txt・export.txtのファイルがデスクトップにあるからいけないのでしょうか？
Red Hat Enterprise Linux 6.0 上で postgresql を使用したいと考えていますが、 「postgresqlの各バージョンにおける対応OSのバージョン」の情報が見当たりません。 NPO法人 日本PostgreSQLユーザ会のサイトも見ましたが、それに関する記載は みつかりませんでした。 Red Hat Enterprise Linux 6.0 上で使用可能な postgresql のバージョンを 知りたいのですが、その情報が記載されているサイト等をご存じでしょうか？
PostgreSQLのanalyzeについてですが。 [TABLE]の統計情報を再取得する為に 　analyze TABLE; と実行した場合。 該当のテーブルへの影響というのは全く無いものなのでしょうか。 （同じタイミングでアクセスしたselectが遅延してしまう等）
表題の件につきまして、質問致します。 現在、AmazonEC2にてウェブアプリケーションの開発をしています。 ウェブサーバーからローカル接続にて、DBサーバーを建てましたがウェブサーバーからの 接続ができません。 postgresql.conf 及びpg_hba.confの設定を行ったのですが・・・・ 他の確認箇所として、Firewallや、AmazonEC2独特の固定IPがローカルIPと兼用されてるようなところでも確認が必要かと思いますが、その確認方法が知識不足の為、ありません。 情報をお持ちでしたら、何卒ご教授の程、宜しくお願い致します。
たとえば以下のようなteamtblテーブルで チームに所属する人物をカンマ区切りでnameに登録してある場合 id | team | name ------------------------------------ 1 | teamA | yamada,kobayasi,hayasi 2 | teamB | kobayasi,takizawa,komori 3 | teamC | takizawa,moriyama 4 | teamD | mori,yamada,kobayasi 「mori」さんが所属するチームのSELECTはどのようにしたらよいでしょうか？ SELECT * FROM teamtbl WHERE name LIKE '%mori%' とした場合、「komori」「moriyama」がいるteamB、CまでSELECTされてしまいます。
下記のURLを参考して設定ファイル(config.inc.php)を下記のように変更してrootやpostgresでログインしましたがログインできませんでした。 http://honana.com/postgresql/admin/phppgadmin.html $conf['extra_login_security'] = true; 　　↓ $conf['extra_login_security'] = false; 他に設定しないといけないのでしょうか。 PHPのバージョンは5.3.6です。 PostgreSQLのバージョンは8.4.7です。 phpPgAdminのバージョンは5.0.2です。 申し訳ありませんがアドバイスいただけませんでしょうか。 宜しくお願いします。
こんにちは。 いつもお世話になっております。 SQLにて、配列のフィールドに指定した値が含まれているものを抽出する方法を質問致します。 SQLのテーブル(テーブル名：data)に配列のフィールド(フィールド名：array[])があるとします。 Array[]フィールドの中に、1, 2, 6のいずれかが含まれている場合表示対象となるSQL文を書くには、どのように書けばよいですか。PostgreでSQL文を書くとします。 実現したい動作は以下の通りです。 array[] の値 {1,3,5} 表示対象になる {3,8,9,10} 　表示対象にならない {2,6} 表示対象になる 以上よろしくお願い致します。 ちなみに、array[]フィールドの中に、2（指定した数値が1つだけ）を探すとき、 select * from data where 2=any (array); とすればいいことは確認できました。
ちょっとタイトルとはズレているかもしれませんが、 Postgresのデータを冗長化する上での質問です。 サーバが2台あり、１台を本番機とし、もう1台を待機用とします。 本番機にarchive_commandで待機用のサーバのディレクトリを設定します。 【質問１】 ログファイルが貯まっていくと思いますが、 こちらはログが16MBになるまで掃き出されないのでしょうか？ その場合、本番機が消滅した場合、１６MB分のログがなくなる可能性があるという事でしょうか？ 【質問２】 前提：本番機のログファイルを自作シェルで待機用のサーバへコピーします。この間隔を1分にします。 上記の場合、最悪1分以内のデータまで冗長化されると思います。 1分以内にログが16MB以上貯まるようなシステムでなければ、archive_commandによる冗長化は 必要ないのではないでしょうか？ 必要性があれば、教えてください。 Postgresのバージョンは8.3.x でお願いいたします。
ＳтＲＵтＳでмｙＳＱＬを使っているのですがоｒａｃｌｅに買収された関係でРoｓｔｇｒｅｓに 移行することになりました。мｙＳＱＬには１つのユーザで接続しＴａｂｌｅのみＯｂｊｅｃｔを 作成。特別なことといえば、日本語を使用することと、Ｔｒａｎｓａｃｔｉｏｎを使っているという ことです。ＤＢのサイズは１０ＭＢ以下です。 一般的にＰｒｏｇｒａｍの修正は不要で簡単に移行できますでしょうか？ 以前Аｃｃｅｓｓからоｒａｃｌｅに移行したときは ・Ｄａｔａ型の互換性が無い ・ＶＢＡでＯｒａｃｌｅのＮｕｌｌとАｃｃｅｓｓのＮｕｌｌの扱いが異なる（Ｐｒｏｇｒａｍの修正が必要） という理由で結構大変でした。
以下のような(1)と(2)のxml型を値を持つレコードがある場合にbの中でcとdが両方1の場合だけ検索（(１)のレコードだけが欲しい）するようにはどのように問い合わせればば良いでしょうか？ (1) <a> 　　　<b><c>1</c><d>1</d></b> 　　</a> (2) <a> 　　　<b><c>1</c><d>0</d></b> 　　　<b><c>0</c><d>1</d></b> 　　</a> 自分で考えた問い合わせだと（１）と(2)の両方のレコードが返ってきてしまいます。 select * from test where 　　'1'=ANY(xpath('/a/b/c/text()',xml)::text[]) 　　AND '1'=ANY(xpath('/a/b/d/text()',xml)::text[])
例えば、名前、出身県、現住所　のような表があります。 出身県と現住所は県名マスターを参照したいのですが、 select (名前、　県名マスター.県名　as 出身県、　県名マスター.県名　as 現住所　from 人名表 p　left join 県名マスター k on p.出身県　=　k.コード) left join 県名マスター on p.現住所　=　k.コード； としたのですが、出身県も現住所も同じになってしまいます。 どのような結合が良いのでしょうか？ 　
質問させてください。 PostgreSQL + pgAdminをインストールしました。 postgresql.confを編集しようとしましたが、「他のプロセスが使用中」というエラーが出て編集できません。 PostgreSQLのサービスは停止させています。 環境はWindows7です。 どなたか対策をご存じないでしょうか。 よろしくお願いします。
postgresql-7.2.3.tar.gzインストール時には、下記内容でデータベースに接続できていました。 <?php $con = pg_connect("dbname='database_6' user='postgres' password='xxx'") if(!$con){ print "DB connection failed!!\n"; }else{ print "DB connection successful!!\n"; } ?> ところが、postgresql-8.0.26.tar.gzをインストールしたら、上記内容でデータベースに接続できなくなり、 Fatal error: Call to undefined function: pg_connect() in /usr/local/apache/htdocs/sql.php on line 2 というエラーメッセージが表示されます。 phpinfo();で確認もしましたが、ない感じです。Additiional Modulesのどこかを見れば、いいのでしょうか？ pgsql.soは/usr/local/lib/php/extentions/pgsql.soにあります。/usr/local/lib/php.iniのextention_dir = ./を以下のように修正し、 extention_dir = /usr/local/lib/php/extentions extention=pgsql.so /usr/local/apache/bin/apachectl restart も実行しています。
postgres9.0.4でEUCでinitした環境があります。 initdb --encoding=EUC_JP そこにUTF8のDBを作成したいのですが、以下のようなエラーがでます。 psql -U postgres postgres=# CREATE DATABASE dbname postgres-# WITH ENCODING='UTF8' postgres-# OWNER=dbowner postgres-# CONNECTION LIMIT=-1; ERROR: encoding UTF8 does not match locale ja_JP.eucJP DETAIL: The chosen LC_CTYPE setting requires encoding EUC_JP. 既に運用が始まっているEUCのDBが稼動している状態です。 EUCで初期化したところに後からUTF8のDBを作成する方法はないのでしょうか？
書籍にLinux（RedHat8.0）、PostgreSQLのユーザ名とデータベース名とを同一にするように記載されていました。このため、"database_6"というもの作成しました。ところが、テーブル作成、テーブル確認には、データベース接続後、所定のコマンドを実行することで問題はありませんでしたが、インポート時には、 ERROR: could not open file "/home/database_6/database_euc_4.csv" for reading: 許可がありませえん とエラーメッセージが表示されます。そこで、アクセス権限を調べると、 -r-xr-xr-x 1 database_6 database_6 113166 6月 5 19:37 database_euc_4.csv これは、Linuxの"database_6"であって、PostgreSQLの"database_6"ではないと考えられます。どのようにすれば、アクセス権限を変更できるでしょうか？ここでは、同一名称にしたことが、仇になっているようです。こうならないようにするために、同一名称にするのかと思っていましたが…。 ちなみに、database_6のOwnerは"postgres"になっています。"postgres"にアクセス権限を与えるのも1つの方法かと思いますが、インポートを実行しようとすると、 -bash: COPY: command not found とエラーメッセージが表示され、パスが通っていないようです。これは、~/.bash_profileが上手く読み込まれていないということでしょうか？
csvデータをインポートするためにデータベース"database_6"を作成し、"create.sql"というファイルをユーザ"database_6"のホームディレクトリ"database_6"に配置した後、"database_6"でログインして、下記コマンドを実行し、テーブル"music"を作成しようとしたところ、 $ psql -e -f create.sql bash: psql: command not found というエラーメッセージが表示されます。なお、PostgreSQLは自動起動設定されています。"database_6"のOwnerは"postgres"で、下記の書籍に記載された方法（別の方法は何も記載されていない）でデータベース"database_6"を作成しました。 $ createdb database_6 で作成しまいた。そこで、同じく下記の書籍に記載された方法（別の方法は何も記載されていない）でユーザ"database_6"を作成しました。 $ createuser -d -A database_6 なお、ユーザ"postgres"を用いた場合には、 FATAL: database "postgres" does not exist というエラーメッセージが表示されます。
どなたか教えてください。 phpPgAdminで特権ユーザ(root)で権限を制限したユーザを作成しました。 以下権限内容です。 （スーパーユーザー権限　：Ｎｏ　 データベースを作成権限：Ｎｏ　 ロールを作成権限：Ｎｏ　 特権を引き継ぎ権限：Ｎｏ) 特権ユーザ(root)がデータベースを作成しテーブルを作成します。 所有者はさきほど作成したユーザを指定しました。 権限を制限したユーザでログインし作成したデータベースに接続。 データベースの項目で特権項目が見えてしまいます。 この特権項目を非表示かクリックすることができないようにするにはどのように すればいいでしょうか？ 環境 CentOS 5.4 postgreSQL 8.1系 php 5.1.6 apache2.2.3 phpPgAdmin 5.0.2 お分かりの方がいらっしゃいましたら、 回答よろしくお願いします。
RedHat8.0であるため、postgresql-7.2.3.tar.gzをインストール（初期化を含む）していましたが、検証をしているうちに、下記コマンドを実行できないこと COPY tablename FROM '/var/test/testdata.csv' WITH CSV; また、encodingにUTF8を指定できことが分かりました。そこで、postgresql-7.2.3.tar.gzをアンインストールし、postgresql-8.0.26.tar.gzをインストール（初期化を含む）しましたが、Encodingを確認したところ、EUC_JPのままになっていました。アンインストールが上手くできなかったためと考えられますが、どのようにすれば、UTF8に変更できるでしょうか？
RedHat8.0にpostgresql-7.2.3.tar.gzをインストールしています。database_6に接続し、 database_6=# COPY tablename FROM '/var/test/testdata.csv' WITH CSV; を実行すると（tablenameとtestdataとは同一名にしてあります）、 ERROR: parser: parse error at or near "csv" と表示されてしまいます。どこが悪いのでしょうか？
$ /usr/local/pgsql/bin/postmaster -D PGDATA を実行すると、 database system is ready と表示されますが、 # rpm -qa|grep postgres を実行すると、何も表示されません。PostgreSQL7.2.3はインストールされているといえるのでしょうか？
PostgreSQL7.2.3インストール後、 $ /usr/local/pgsql/bin/initdb を実行したところ、 You must identify where the data for this database system will reside. Do this with either a -D invocation option or a PGDATA environment variable. と表示されます。これは、.bashrcで追加した下記内容が読み込まれていないからでしょうか？ POSTGRES_HOME=/usr/local/pgsql export PATH="$PATH":/usr/local/pgsql/bin export PGLIB=$POSTGRES_HOME/lib export PGDATA=$POSTGRES_HOME/data export MANPATH="$MANPATH":$POSTGRES_HOME/man 上記オプションはどちらを選べばよいでしょうか？また、PGDATAの場合、"-"なしでそのままPGDATAでしょうか？
RedHat8.0にPostgreSQL7.2.3をインストールしましたが、下記コマンドで初期化できません。 $ initdb -bash: initdb: command not found なお、PostgreSQL7.2.1をインストールしていましたが、その際は初期化できていました。ただし、テキストエディタでpostgresql.conf、pg_hba.confを編集するため、開こうとしましたが、開けませんでした（ファイルが表示されない）。ファイルを検索すると、/usr/local/pgsql/data/にあることになっていましたが…。アクセス権限の問題と考え、postgresでログインしようとしましたが、パスワードの初期設定が分かりませんでした。今回、Windows上で作成したPHPプログラムの動作を検証するため、テスト環境を構築しようとしています。インストールしたApache1.3.27、PHP4.2.2に合わせて、バージョンを更新しました。アンインストールし、インストール前に $ make check で All 79 tests passed. であることも確認しています。
トリガを実行したときに、処理部分のfunctionで更新されたデータの値を取得したいと考えております。 NEW変数を使い、 NEW.[フィールド名]とすれば取得できるのは知っているのですが、 この[フィールド名]にfunction内で取得した項目名を指定するにはどうしたら良いのでしょうか？ 仮に取得したいフィールド名が「sample_id」だった場合、 functionの中でNEW.sample_idとすれば取得できます。 が、今回考えていたのは以下のような処理の場合です。 記述イメージなので間違っているかもしれませんが、、、 begin for rec in SELECT att.attname 　　　　　　　　FROM pg_attribute as att 　　　　　　　　INNER JOIN pg_class as class ON class.oid = att.attrelid 　　　　　　　　WHERE att.attnum > 0 　　　　　　　　AND class.relname='テーブル名' 　　　　　　　　ORDER BY att.attnum 　loop 　insert into 'テーブル名２' values(NEW.rec.attname); loop end end; ループでテーブル内の項目を取得し、取得した項目の値をテーブル名に入れるという処理です。 rec.attnameには「sample_id」と入っていたので、NEW.rec.sample_idとしたのですが、 実行したときにエラーになり、どうしてもinsertできません。 どうにかして、sample_idの値をinsertしたいのですがわかりません。 ご教授お願い致します。
LinuxでC言語にてコンパイルをする際に(makefileを使用)にポスグレのライブラリが見つからないという下記エラーが出力されます。 しかしポスグレのライブラリはmakefileにて指定した箇所(-Lオプションにて/opt/prov/pgsql/libを指定)に存在しています。 makefileに誤りがなく、シンボリックリンクも正確に貼られていると考えると他にどのような原因が考えられるのでしょうか?(環境変数の設定等でしょうか??) エラー ------------- /usr/bin/ld: skipping incompatible /opt/prov/pgsql/lib/libpq.so when searching for -lpq /usr/bin/ld: skipping incompatible /opt/prov/pgsql/lib/libpq.a when searching for -lpq /usr/bin/ld: cannot find -lpq ボスグレのライブラリは存在している ---------- -rw-r--r-- 1 postgres postgres 126994 X月 XX 16:XX /opt/prov/pgsql/lib/libpq.a lrwxrwxrwx 1 postgres postgres 12 X月 XX 16:XX /opt/prov/pgsql/lib/libpq.so -> libpq.so.2.2 lrwxrwxrwx 1 postgres postgres 12 X月 XX 16:XX /opt/prov/pgsql/lib/libpq.so.2 -> libpq.so.2.2 -rwxr-xr-x 1 postgres postgres 90659 X月 XX 16:XX /opt/prov/pgsql/lib/libpq.so.2.2
# rpm -qa | grep postgresql を実行してみると、 postgresql-python-7.2.2-1 postgresql-odbc-7.2.2-1 postgresql-7.2.2-1 postgresql-perl-7.2.2-1 postgresql-server-7.2.2-1 postgresql-devel-7.2.2-1 postgresql-contrib-7.2.2-1 postgresql-libs-7.2.2-1 postgresql-jdbc-7.2.2-1 postgresql-tcl-7.2.2-1 が表示されたため、 # postgres start を実行すると、 "root" execution of the PostgreSQL server is not permitted. The server must be started under an unprivileged user id to prevent more information on how to properly start the server. と表示されます。そこで、本サイトのQ&Aを参考にして、 # /etc/init.d/postgresql start を実行したところ、起動しました。Windows版では、pgAdminIIIのクエリーツールで以下のようにすれば、csvデータ（UTF8）をPostgreSQLの所定のテーブルにインポートできます。 COPY tablename FROM E'C:\\test\\testdata.csv' WITH CSV; Linux版ではどのようにするのでしょうか？
YumでRed Hat 8.0（メモリ256MB、32ビット）にpgdg-redhat-8.0-5.noarch.rpmを下記手順に従ってインストールしようとしましたが、インストールできません。 1.共有メモリの設定確認（shmmaz：33554432、shmall：2097152） 2.Yumリポジトリの設定（http://yum.pgrpms.org/howtoyum.phpに記載された内容と実際の設定ファイルとに相異がありました） 3.installコマンドを指定して実行 3.でcommand not foundと表示されるため、# yum search postgresqlを実行しましたが、command not foundと表示されます。そこで、 # rpm -qa | grep postgresql を実行してみると、 postgresql-python-7.2.2-1 postgresql-odbc-7.2.2-1 postgresql-7.2.2-1 postgresql-perl-7.2.2-1 postgresql-server-7.2.2-1 postgresql-devel-7.2.2-1 postgresql-contrib-7.2.2-1 postgresql-libs-7.2.2-1 postgresql-jdbc-7.2.2-1 postgresql-tcl-7.2.2-1 が表示されます。このため、# yum -y install 'postgresql*'も試してみましたが、command not foundと表示されてしまいます。これは、64ビット版と32ビット版との違いによるものでしょうか？手元にある試料には、ソースコードからのインストール方法も64ビット版のものです。
首記の件可能でしょうか？ 可能であればSQL文等ご教示いただければ幸いです。 下記のようなテーブルを作成したいと考えています。 ＊訪問日だけを配列にしたい。訪問日は入力されどんどん増えていく。訪問日は年月日まで表示したい。 主キー；顧客番号 　　　　　訪問日 [ ] よろしくお願いいたします。
お世話になります。 現在、最新レコードを抽出し外部結合するSQLを考えているのですが、実現できておりません。 実現できるSQLをご存知の方、いらっしゃいましたら情報を頂けますでしょうか。 # 私の使用しているのは、PostgreSQL8.3となります。 実現したい内容は、以下となります。 　１．テーブルＡから「名前」でグループ化して最新の「更新日付」のレコードを抽出。 　２．１の結果とテーブルＢを「名前」で結合。 　３．テーブルＡの「名前」、「点数」、「更新日付」とテーブルＢの「判定」を抽出。 　　　⇒ただしテーブルＡに情報がある場合は、テーブルＢの判定結果を「０」にして出力。 　　　　　テーブルＡ　　　　　　　　　　　　　　　テーブルＢ ----------------------------　　　----------------------- 　名前｜　点数｜　更新日付　　　　　　　名前　｜　判定　 ----------------------------　　　----------------------- ＡＡＡ　　　９８　　　2011/4/1　　　　　　　　ＡＡＡ　　　０　 ＡＡＡ　　　６０　　　2011/4/3　　　　　　　　ＢＢＢ　　　１　 ＢＢＢ　　　７０　　　2011/4/2　　　　　　　　ＣＣＣ　　　１　 ＢＢＢ　　　３５　　　2011/4/4　　　　　　　　ＤＤＤ　　　１　 ＤＤＤ　　　９８　　　2011/4/1　　　　　　　　ＥＥＥ　　　０　 ＥＥＥ　　　４７　　　2011/4/5　　　　　　　　 ＦＦＦ　　　０　 ＧＧＧ　　　８０　　　2011/4/6　　　　　　　　ＧＧＧ　　　１　 　 【出力結果】 --------------------------------------------- 　名前　｜　点数　　｜　更新日付　｜　判定　 --------------------------------------------- ＡＡＡ　　　　６０　　　　　2011/4/3　　　　 　０　 ＢＢＢ　　　　３５　　　　　2011/4/4　　　　　０（１⇒０に変更）　 ＣＣＣ　　　NULL　　　　　NULL　　　　　　　１　 ＤＤＤ　　　　９８　　　　　2011/4/1　　　　　０（１⇒０に変更）　 ＥＥＥ　　　　４７　　　　　2011/4/5　　　　 　０　 ＦＦＦ　　　　NULL　　　　　NULL　　　　　 　０　 ＧＧＧ　　　　８０　　　　　2011/4/6　　　　　０（１⇒０に変更） お手数お掛け致しますが、ご教示のほどよろしくお願い致します。
おはようございます。PostgreSQLを使ったクライアントサーバーシステムの構築について 質問です。 PC（A)にPostgreSQLをサイレントインストールを行って、DBも作成し、正常にDBが起動している 状態とします。 このとき、PC(B)にODBCドライバをインストールし、ODBC接続の設定を自動で作成する部分 を作成しようと考えています。 １台のPCに入れたときにはホスト名をlocalhostとすることで問題はありませんでしたが、 ほかのマシンにインストールしたとき、どのサーバーで（どのIPで？）PosegreSQLが動いているのか クライアント側から取得する方法がありましたら、教えていただきたいと思います。 OSについてはどちらもWindows系OSを考えております。 よろしくお願いします。
また質問させて頂きます。宜しくお願いします。 現在添付画像のテーブルイメージのように情報を取得したいのですが、 方法が思い浮かず投稿させていただいています。 取得したい階層のイメージは、添付画像ツリーイメージのようになる事を求めています。 要望としては、 ・PostgresSQL8.4で動作可能 ・なるべくSQLで解決したい ・SQLのクエリ発行数に関してはなるべく1回が良いですが別に2回以上でも使用可 (ただし、アプリケーション側でループ処理とかは無し。1000回ループとかありえるんで。。。) ・必要ならば一時テーブルの作成もあり お手数ですが、どなたか方法・アドバイス等お教え頂ければ助かります。
環境はPostgreSQL 9.0です。 id(char(1))　　　number(integer) 1　　　　　　　　　　1 2　　　　　　　　　　2 3　　　　　　　　　　3 っていうテーブルがあって、numberにUNIQUE制約が掛かっています。 一回のupdate文でnumを1ずつ増やしたいんですが、更新順序の指定 ってどうやるんですか？ UPDATE table SET number = number+1 だと重複違反になるから、numberが大きい奴から更新したいんですよね。 誰か教えてくれませんか？
毎度お世話になっております。 今回はお客さまがOracleが高価で予算が取れないとの事で、9i+Veritas Cluster Serverで実現していた２台のサーバから共有ディスク上のDBにアクセスする方法を模索しております。 ACT-ACT構成で２台のサーバから共有ディスク上のDB（PostgreSQL）に具体的にアクセスするにはどのようなソフトウェア構成にしたら良いかご教示願います。 よろしくお願いします。
実運用中のテーブルに対し、日次で reindex を実行したところ、時々、デッドロックが発生してしまいます。 どうやら、reindex と update の間でデッドロックが起きているようです。 エラーメッセージを見た感じでは、以下の状態でデッドロックになっているように読めます。 ・update がテーブルのインデックスに対するロックを取得し、テーブルに対する RowExclusiveLock を取得しようとしている ・reindex がテーブルに対するロックを取得し、テーブルのインデックスに対する AccessExclusiveLock を取得しようとしている ※ 参考までに、update は select for update してから update しています。 Postgre のバグではないかと思うのですが、デッドロックを回避する方法はありますでしょうか？ （なるだけ、reindex を実行しているプロセスの方に手を入れることで対応できないかと思っています。例えば、reindexの前に事前にロックを取得する、とか・・・） よろしくお願い致します。
あるtextフィールドに '10010000' のように１と0で構成されたものがあります。 このフィールドにたいして、ソート（order by）を行いたいのですが、 何桁目が1のものを上位に、のようなソートを行いたいと思っています。 任意の桁の値だけ取り出せないかと、 型変換、フォーマットや算術演算を使ってみましたがうまくできませんでした。 たとえば '10010000' から5桁目の値　'1'　のみを取り出す方法です。 ソートで使用するのが目的です。 わかります方いらっしゃいましたら、よろしくお願いいたします。
得意先マスタと製品マスタがあり得意先コードで等価結合した場合 結果Ａのようになると思いますが、結果Ｂのような結果を得たい場合は、 どのようにSQLを書けばいいのでしょうか？ DBはIBM　DB2　V7ですが、postgresql 8.4での書き方も ご存知の方宜しくお願いします。 結果Ａ +----+-------+----+ |列 1　| 列 2 　　| 列 3 | +----+-------+----+ | A社　| A製品1 | A@1 | | A社　| A製品2 | A@2 | | A社　| A製品3 | A@3 | | B社　| B製品1 | B@1 | | B社　| B製品2 | B@2 | | B社　| B製品3 | B@3 | +-----+--------+--+ 結果Ｂ +----+-------+----+ |列 1　| 列 2 　　| 列 3 | +----+-------+----+ | A社　| A製品1 | A@1 | |　　　　| A製品2 | A@2 | |　　　　| A製品3 | A@3 | | B社　| B製品1 | B@1 | |　　　　| B製品2 | B@2 | |　　　　| B製品3 | B@3 | +-----+--------+--+
親,　　親在庫,　　子,　　子在庫,　　員数 ----------------------------------------- 製品A,　1,　　　部品A,　　　2,　　　　1 製品A,　1,　　　部品B,　　　1,　　　　1 部品A,　2,　　　部品a,　　　100,　　　10 部品A,　2,　　　部品b,　　　50,　　　 20 上記のような製品Aの構成部品と在庫を 管理しているテーブルから、各部品の所要量 を計算し、抽出するSQLで悩んでおります。 上記の場合、例えば製品Aを10台製作するための 各部品の所要量として、 親,　　親在庫,　　親所要量, 子,　　子在庫,　　員数,　　子所要量 ------------------------------------------------------------------ 製品A,　1,　　　　　10,　　　　部品A,　　2,　　　　1,　　　　9 製品A,　1,　　　　　10,　　　　部品B,　　1,　　　　1,　　　　9 部品A,　2,　　　　　9,　　　　部品a　　　100　　　　10,　　　70 部品A,　2,　　　　　9,　　　　部品b　　　50　　　　20,　　　140 という結果が抽出できるのが理想です。 子の所要量を計算するために、(親所要量 - 親在庫)を 動的に算出し、それを子の員数と乗算させる。 という処理を繰り返すイメージです。 なお、ここでいう員数とは、「親を1台製作するために必要な数」 という定義です。 相関サブクエリ、自己結合をつかって試しているのですが、 レコード毎に動的に上記の処理をさせることができずに 困っております。 ご教示の程、よろしくお願い致します。
本日から○日以内のレコードをセレクトしたいのですが ○日の部分が可変のためJavaのpreparedstatementを使用します。 例) SELECT timedate FROM testtb WHERE timedate BETWEEN current_timestamp + '-30days' AND current_timestamp; ※timedateはDATE型です のような事をしたいのですが、 「30」の部分を?にすると The column index is out of range: 1, number of columns: 0エラーになります。 intervalの使用も考え色々調べていたのですが、いまいちやり方が分かりません。 何か方法をご存知の方、ご教授お願い致します。
debian（バージョン6.0.0）でpostgresqlを入れたいのですが、 apt-getでインストールすると、バージョンが8.4.xになってました。 希望はpostgresqlのバージョンを8.3.1にしたいのですが、 aptサーバには8.4.x　以降のバージョンしかないみたいで困ってます。 過去のパッケージを拾ってきて　dpkg -i　で一つずつインストールしようと思いましたが、 「○○がインストールされていません」や、「依存関係が、、、」で進まない状態です。 どなたかdebian6.0.0環境で、過去バージョンを入れる方法を教えていただけないでしょうか。
now()の結果を返すだけの以下の２つのPL/pgSQLを試しに作りました。SQL１は正しく結果が返ってきますが、SQL２は結果が何も返ってきません。どなたか説明できる方、いらっしゃいますでしょうか。宜しくお願い致します。 ■SQL１ CREATE OR REPLACE FUNCTION select_now1() RETURNS date AS $$ DECLARE d_currentDATE:= NULL; BEGIN SELECT INTO d_current now(); RETURN d_current; END; $$ LANGUAGE PLpgSQL; ■結果１ select_now1 ------------- 2011-03-19 (1 行) ■SQL２ CREATE OR REPLACE FUNCTION select_now2(OUT d_current date) AS $$ DECLARE d_currentDATE:= NULL; BEGIN SELECT INTO d_current now(); END; $$ LANGUAGE PLpgSQL; ■結果２ select_now2 ------------- (1 行)
DBにはpostgresを使用していて、numeric(8,2)の様に定義した項目から VB.netのプログラムでOleDbDataReaderを使用して値を読み取るのですが .GetValueでは123.45 -> 123 という風に整数部分しか読み取れません。 試しに .GetValue(x).Tostringで出力してみたのですが、やはり小数部分が見あたりません。 直接コマンドで見る限り、テーブルには正しく小数以下も格納されています。 現在は、クエリで 100倍して.GetValueで読み込んだ後に100で割っていますが 直接読み込むメソッドがありましたらご教授願います。
以下のようにバックアップ後、リストアし、ODBCを利用し、ACCESSでレコード追加したところ、再度、リストアしようとするとエラーが出て、復元できません。 (1)バックアップ sudo -u test pg_dump -O testdb > /home/test/test-back-1.dmp (2)リストア sudo -u test dropdb testdb sudo -u test createdb -EEUC_JP testdb sudo -u test psql -e testdb < /home/test/test-back-1.dmp (3)ODBCを利用し、ACCESSの追加クエリでtbl_tensuのレコードを追加 (4)再度、リストア sudo -u test dropdb testdb sudo -u test createdb -EEUC_JP testdb sudo -u test psql -e testdb < /home/test/test-back-1.dmp 以下のようなエラーが、レコード追加したテーブルも何もしていないテーブルにも出てしまい、正しく復元できません。 ALTER TABLE ONLY tbl_tensu ADD CONSTRAINT tbl_tensu_primary_key PRIMARY KEY (hospnum, srycd, yukostymd, yukoedymd); ERROR: multiple primary keys for table "tbl_tensu" are not allowed CREATE INDEX idx_tensu_formalname ON tbl_tensu USING btree (formalname); ERROR: relation "idx_tensu_formalname" already exists CREATE INDEX idx_tensu_kananame ON tbl_tensu USING btree (kananame); ERROR: relation "idx_tensu_kananame" already exists CREATE INDEX idx_tensu_kensagrp ON tbl_tensu USING btree (hospnum, srykbn, knsjisgrpkbn); ERROR: relation "idx_tensu_kensagrp" already exists CREATE INDEX idx_tensu_name ON tbl_tensu USING btree (name); ERROR: relation "idx_tensu_name" already exists 何が原因でどうすれば、復元したときにエラーが出なくなるでしょうか？ どなたか、わかる方ご教示ください。 よろしくお願いします。
Autovacuumを"ON"にして運用していますが、最近アクセスが遅くなっているような気がします。 Vacuumも定期的に実施することが望ましいのでしょうか。 Autovacuumを"ON"であれば、違ったことが原因なのでしょうか。
Postgresql8.1とAccess2003にて販売管理システムを構築しております。 データベースサーバーは会社に設置しており 自宅からPgAdmin1.10にて接続し管理などを行っております。 サーバーにはA、Bと同じ構成をしたデータベースが存在しています。 PgAdminからAのテーブルにSQLを実行したところ タイムアウトなのか無限ループに陥ったのか、エラーでSQLの処理が止まってしまい PgAdmin毎落ちました。 仕方なく、再度PgAdminからAのデータベースに接続しようとすると 「could not receive data from server: Software caused connection abort(0x00002745/10053)」 とエラーが表示され、その後一切の接続できなくなりました。 PgAdminの再インストールや、PC・ネットワーク環境を変えたりしましたが どの方法でもA、Bともに接続不可となってしまいました。 そこでサーバー自体の再起動を行いましたところ アプリケーション（Access）からAのデータベースに接続することができ データの読み書きも問題なく出来ました。 また、PgAdminを使った場合も外部から接続するのではなく 同じローカルネットワーク内から接続すると問題なく A、Bのデータベースに接続でき、テーブルの参照やレコードの編集、 VACUUMやバックアップ(pg_dump)も可能でした。 ここでまず一つ目の質問ですが、 このA、Bのデータベースは、破損している状態でしょうか？ もしくはPostgreSQL毎破損している状態でしょうか？ PgAdminから出力できるレポートで該当テーブル全体の統計情報を見ると タプルの挿入や更新などがすべて「0」で表示されます。 （サイズだけは計算されて、恐らく実データ量だと思われるバイト数が表示されていました） 二つ目の質問ですが、 Aのデータベースの状態が”壊れている状態”だとしたら、すぐにでも バックアップを取り、新しくデータベースを作り直してリストアしたいと考えていますが バックアップ前のデータベースとリストア後のデータベースを比較して、 レコードがすべてリストア出来ているかを確認したいのですが どのような方法で確認できますか？ 例えば全テーブルのレコード数一覧などを出力し比較出来る事が望ましいですが 前述のテーブルの統計情報レポートでは、まともに数字が表示されないので 困っております。 （なお、アーカイブ形式のバックアップだと一部テーブルのレコードが一切復元されない という現象が発生した為、プレーン形式でのバックアップを考えています。 プレーン形式で書き出して中身を見たところ、問題のテーブルのレコードも はき出されておりました。（これも、"破損"と考えた要因の一つです）） 現状、アプリケーションからの利用だけで言えば、特段問題がありませんが やはり気持ちが悪く、出来る限り修復（or再構築）を行いたいと考えています。 詳しい方、アドバイスなどあれば是非教えてください。 宜しくお願いいたします。
Windows Server2008に「postgresql-8.4.4」をインストールしたいと思っています。 一度、エラーなくインストールが完了したのですが、dataフォルダをDドライブに作成するはずが Cドライブに作ってしまった為、アンインストールを行いました。 作成先を直して、再インストールを行ったところ、途中で下記のエラーが表示され、 サービスの起動が出来なくなってしまいました。 A non_fatal error occured whilst loading database modules. Please check the installation log in C:\Users\Administrator\AppData\Local\Temp for details. アンインストール後に行ったこと ・net user /deleteを使用して、postgresユーザーの削除 ・Program Files(86x)のpostgresフォルダの削除 ・C:\ユーザー\Administrator\AppData内のpostgresフォルダの削除 ・dataフォルダの削除 インストールは、管理者として実行でインストールしています。 インストールする為に、まだ何かしないといけないことがあるのでしょうか？ おわかりになる方、アドバイス頂けないでしょうか？ 宜しくお願いします。
Left join　と Right join の両方の機能をもった、一つのＳＱＬ文はどうしたらいいのでしょうか。 つまり、Left join は左側のテーブルを基準とし右にないものでも右の部分はNUllのままで抽出しますが、双方にあるものは統合して出力し、片方に無いものは、ない部分だけNullで、とにかく両方を抽出するというSQL文が書けないかと思案しています。
棚,　部品, 　在庫 ------------------ 1-1　A　　　　300　 1-2　A　　　　200　 1-3　A　　　　100　 1-4　B　　　　100　 1-5　B　　　　50　　 上記のような、部品の保管場所、在庫を管理しているテーブルに対し、 在庫が少ない部品から優先して引当数を自動計算したいのですが、 SQLで実現可能でしょうか。 なお、使用しているDBはpostgres 8.4です。 例として、部品Aの引当総数が550個だとすると、 SQL のSELECT文で、 棚,　部品, 　在庫,　引当数 ----------------------------- 1-1　A　　　　300　　　　　　250 1-2　A　　　　200　　　　　　200 1-3　A　　　　100　　　　　　100 1-4　B　　　　100　　　　　　0 1-5　B　　　　50　　　　　　　0 のような結果が抽出できれば理想的です。 引当条件としては、 (1)在庫が少ないものから、優先的に (2)在庫を超える引当は不可 です。 ご教授の程、よろしくお願い致します。
PostgreSQL内のテーブルをCOPYコマンドを使ってCSVにエクポートしようと思っています。 データのエクスポートは出来るのですが、二重引用符の付加が出来ません。 copy TBL1 to 'd:/TBL1.CSV' with delimiter ',' csv quote '"' 《CSVデータの内容》 001,あいうえお "001","あいうえお" ←　この様に二重引用符を付加したいです。 どうすればいいでしょうか？ ご教授いただきたく思っております。 よろしくお願いします。
PostgreSQL8.2シリーズを利用しています。 事情によりVacuumFullが行えないのですが、ここ最近、レスポンスの低下が顕著になってきました。 そこで現在のDB断片化の状況を知りたいと考えているのですが、何か方法はございますでしょうか？ もしご存知でしたら、ぜひアドバイスを頂ければと思います。
部品, 購入数パターン, 原価 ------------------------- A　　　　100　　　　　　　100 A　　　　200　　　　　　　98 A　　　　300　　　　　　　90 B　　　　100　　　　　　　200 B　　　　200　　　　　　　180 上記の様な部品の購入数パターン毎の原価を管理している テーブルに対し、理想原価を抽出したいのですが、 SQLでどのように実現したらよいか悩んでおります。 使用しているDBはpostgres 8.4です。 具体的な例を挙げますと、 部品Aの購入数が、 (1)100未満の場合、購入数パターン100とみなし原価100円とする (2)200の場合、購入数パターン200とみなし原価98円とする (3)210の場合、購入数パターン300とみなし原価90円とする (4)300超過の場合、購入数パターン300とみなし原価90円とする 以上、ご教授の程よろしくお願い致します。
カテゴリと個別商品の集計SQLについて質問です。 postgresのバージョンは9.0です。 次のテーブルより ------------------------------------------ id　　カテゴリ　　商品名　　　　日付　　　　　　　値 ------------------------------------------ 1　　野菜　　　　ホウレン草　　2010-01-01　　100 2　　野菜　　　　ホウレン草　　2010-01-02　　100 3　　野菜　　　　ホウレン草　　2010-02-02　　100 4　　野菜　　　　キャベツ　　　　2010-01-02　　200 5　　肉　　　　　　牛肉　　　　　　2010-01-01　　500 6　　肉　　　　　　牛肉　　　　　　2010-01-02　　500 -------------------------------------------- 下の結果を得るSQLを考えています。 月毎の値の集計 カテゴリ　　商品名　　　　　1月　　2月　　　　合計　　　カテゴリ合計　　カテゴリ合計と合計との差 ----------------------------------------------------------------------------- 野菜　　　　ホウレン草　　　200　　100　　　　300　　　　500　　　　　　　　200 野菜　　　　キャベツ　　　　 200　　　　0　　　 200　　　　500　　　　　　　　300 肉　　　　　　牛肉　　　　　　1000　　　0　　　　1000　　　1000　　　　　　　　　0 ----------------------------------------------------------------------------- ここでカテゴリの合計とは　上の場合、 ホウレン草(300)＋キャベツ(200)=カテゴリ野菜(500)、です。 クロス集計とサブクエリを使えば出来そうなのですが、カテゴリ合計を出す部分の SQLが思いつきません、よろしくお願い致します。
いつもお世話になっております。 前提として、環境は、VMWareの中に、CentOS5があり、PostgreSQL8.4で、 文字コードはEUC-JPをinitdbしています。 今回、WindowのExcelでCSVを、PostgreSQLのCOPYコマンドでインポートできるかを検証しているのですが、下記のような形で、copyコマンドを実行しますと、 結果、UTF-8ですと、文字化けしていませんが、EUC-JPですと、文字化けしてしまいます。 デフォルトのDBのエンコードのEUC-JPで、SELECTの結果が文字化けしてほしくないのですが、どこか、間違っているところありますでしょうか。 お手数をおかけしますが、なにとぞご教授よろしくお願い申し上げます。 [foo@localhost ~]$ psql test psql (8.4.6) Type "help" for help. test=> \encoding SHIFT-JIS test=> \copy shinamono from /tmp/Book1.csv with csv test=> select * from shinamono; hinmei | nedan ---------------------+------- ・スンゑソス・ス・ス | 100 ・ス・ス・ス・ス・ス・ス | 150 ・ス・ス・ス・ス・ス・ス | 2500 ・ス`・ス・ス・スR・ス・ス・ス[・スg | 100 ・ス・ス・ス・ス・ス・ス,・スネゑソス・スフセ・スb・スg | 5000 ・スワつゑソス・ス・ス ・ス・ス・ス・ス・ス・ス | 10000 ・ス`・ス・ス・スR・ス・ス・ス[・スg | 100 ・ス・ス・ス・ス・ス・ス,・スネゑソス・スフセ・スb・スg | 5000 ・スワつゑソス・ス・ス ・ス・ス・ス・ス・ス・ス | 10000 ・ス`・ス・ス・スR・ス・ス・ス[・スg | 100 ・ス・ス・ス・ス・ス・ス,・スネゑソス・スフセ・スb・スg | 5000 ・スワつゑソス・ス・ス ・ス・ス・ス・ス・ス・ス | 10000 (12 rows) test=> \encoding EUC-JP test=> select * from shinamono; hinmei | nedan ---------------------+------- ・ス゜、・ス・ス・ス | 100 ・ス・ス・ス・ス・ス・ス | 150 ・ス・ス・ス・ス・ス・ス | 2500 ・ス・ス・ス逾ウ・ス・シ・ス・ス | 100 ・ス・ス・ス・ス・ス・ス,・スハ、・ス・スΥ・ス・スa・ス | 5000 ・ズ、ト、・ス・ス・ス ・ス・ス・ス・ス・ス・ス | 10000 ・ス・ス・ス逾ウ・ス・シ・ス・ス | 100 ・ス・ス・ス・ス・ス・ス,・スハ、・ス・スΥ・ス・スa・ス | 5000 ・ズ、ト、・ス・ス・ス ・ス・ス・ス・ス・ス・ス | 10000 ・ス・ス・ス逾ウ・ス・シ・ス・ス | 100 ・ス・ス・ス・ス・ス・ス,・スハ、・ス・スΥ・ス・スa・ス | 5000 ・ズ、ト、・ス・ス・ス ・ス・ス・ス・ス・ス・ス | 10000 (12 rows) test=> \encoding UTF-8 test=> select * from shinamono; hinmei | nedan ---------------------+------- みかん | 100 りんご | 150 メロン | 2500 チョコレート | 100 メロン,なしのセット | 5000 まつたけ すだち | 10000 チョコレート | 100 メロン,なしのセット | 5000 まつたけ すだち | 10000 チョコレート | 100 メロン,なしのセット | 5000 まつたけ すだち | 10000 (12 rows)
以下のOSに PostgreSQL 8.4.5 をインストールしようと考えています。 ----------------------------------------------------------------------------- OS：Red Hat Enterprise Linux ES release 4 (Nahant Update 6) ----------------------------------------------------------------------------- ソースからインストールしようと重い、configureを実行したところ、以下のエラーで 停止してしまいました。 ----------------------------------------------------------------------------- $ ./configure --prefix=/usr/local/pgsql checking build system type... i686-pc-linux-gnu [中略] checking if gcc supports -fwrapv... yes checking whether the C compiler still works... yes checking how to run the C preprocessor... /lib/cpp configure: error: C preprocessor "/lib/cpp" fails sanity check See `config.log' for more details. ----------------------------------------------------------------------------- gccバージョンは以下となります。 ----------------------------------------------------------------------------- gcc バージョン 3.4.6 20060404 (Red Hat 3.4.6-9) ----------------------------------------------------------------------------- いろいろ調べたのですが、原因究明が かなり困難なので、 ソースからのインストールはやめて rpm によるインストールを行なうことを考え始めました。 問題なのは、対象マシンはリモートで操作しており、外部ネットには繋がらない環境に置かれております。 そのため、yum によるインストールができません。 必要なrpmパッケージを対象マシンにアップロードして、rpmコマンドによるインストールを 考えているのですが、どこから必要なファイルをダウンロードすればよいのか わからないので、 どなたかご教示願います。 または、ソースからのインストールのエラー回避の方法を ご存知の方がおられたら、 その方法でもかまいませんので、ご教示願います。
linux　postgresql 8.4 で1行DELETEしたいのですが select * from table_a where a_key = 1400; で1件検索できても delete from table_a where a_key = 1400 returning *; としてもレコードが表示されません。 原因の調べ方を教えてもらえないでしょうか？ よろしくお願いします。
postgresqlバージョン9.0を利用しています。しばらく安定していたのですが、運用から1ヶ月ぐらいしたここ最近、メモリの使用率(バッファ含め)が80%を超えるようになりました。 プロセスを確認すると、autoバキュームが負担になっているようです。 ほぼ autovacuum launcher processというプロセスが物理メモリの80%を占有しています。 このままでは、autovacuumにより逆にパフォーマンスが悪くなりそうです。 そこで、autovacuumが負担にならないようにvacuum_cost_limitの適切な値を設定しようと思索していますが、適切な設定に迷っています。 また　vacuum_cost_limitはコメントアウトのままです。 どなたか適切な設定値の算出や設定や方法をご教授いただけませんでしょうか。 現在の状態はこちらです。 OS：RedhatLinuxEnterprise5.5　64bit メモリ：8GB postgres.confの設定 autovacuum = on autovacuum_naptime = 1min autovacuum_vacuum_threshold = 50 autovacuum_analyze_threshold = 50 autovacuum_vacuum_scale_factor = 0.2 autovacuum_analyze_scale_factor = 0.1 autovacuum_vacuum_cost_delay = 20ms autovacuum_vacuum_cost_limit = -1 #vacuum_cost_limit = 200 # 1-10000 credits どうぞよろしくお願いいたします。
postgresのdump & restoreで全体定義とインデックスを分離したいです。 やりたいことは以下です。 元のデータベースがあります。 ここから、 （１）インデックスを除く全体定義 （２）インデックス を抜き出します。 別の環境に （１）をリストアし、 データをCOPYし、 その後、（２）をリストアします。 全体定義をdumpし、 それをrestoreし、 そこにデータを突っ込むと速度が遅いので、インデックスだけ後で貼りたいのです。 何か良い方法はありませんか？
Postgresのtextsearch_jaを設定しました。 そこでMecabを使用しています。 例として以下のテーブルで create table table1 ( id int, col1 text, col2 text, tsv tsvector ); 更新処理時にtsvカラムに解析データが入るようにトリガを設定しました。 col1に「田中00001」をINSERTします。 解析するtsvカラムには「田中」と「00001」が入ります。 ここで、「0000」と検索しても、レコードを取得できませんでした。 投げたSQLは以下のような感じです。 select * from table1 where tsv @@ to_tsquery('japanese', '0000') select * from table1 where tsv @@ to_tsquery('japanese', '0000') とした場合はレコードを取得することができます。 以下も試しましたがレコードは取得できませんでした。 select * from table1 where tsv @@ plainto_tsquery('japanese', '0000') 「0000」にて検索した場合に、全文検索の機能でレコードを取得する方法はありますでしょうか？ postgres8.4.5 Mecab 0.98
ＰｏｓｔｇｒｅＳＱＬを使ったデータベースシステムがあります。 4年前から稼動しています。 最近ＤＢの更新処理の速度が低下したので原因を調べています。 バキュームを実行後、６３０件のレコードを更新するのに約６０秒かかりました。 全データをバックアップし、データベースを新しく設定してリストアし、 同じ処理を行ったところ、約15秒（４分の１）に短縮されました。 処理速度低下の原因として考えられることはどんなことがあるでしょうか？ また、処理速度の低下を防ぐ方法はどのようにすればいいのでしょうか？ よろしくご教授ください。
postgreSQL8.4.4のmakecheck失敗 皆様 初めて質問いたします。 どうか宜しくお願いします。 要約としてはインストール中の確認作業であるmakecheckが失敗する理由が分かりません。 私の開発環境は以下になります。 ■カーネル：2.6.18 ■ディストリビューション：Debian(etch) ■postgre8.1.8(debian提供のバイナリからインストール) 上記の環境に以下の手順でインストール作業を行いました。 (1)本家からDLしたpostgre8.4.4のtgzデータをユーザー：postgresで解凍 (2)ユーザーpostgresで./configure (3)ユーザーpostgresでコンパイル(make all) (4)ユーザーpostgresで確認(make check) そうすると以下のエラーメッセージが出力されます。 test stats ... FAILED test tablespace ... ok ============== shutting down postmaster ============== server stopped ======================== 1 of 120 tests failed. ======================== The differences that caused some tests to fail can be viewed in the file "/var/home/postgre/postgresql-8.4.4/src/test/regress/regression.diffs". A copy of the test summary that you see above is saved in the file "/var/home/postgre/postgresql-8.4.4/src/test/regress/regression.out". ------------------------------------------------------------- ここではtest stat(統計情報取得)が失敗しているようです。 ログには以下のようにも記載されています。 SELECT wait_for_stats(); WARNING: pgstat wait timeout CONTEXT: SQL statement "SELECT (st.idx_scan >= pr.idx_scan + 1) FROM pg_stat_user_tables AS st, pg_class AS cl, prevstats AS pr WHERE st.relname='tenk2' AND cl.relname='tenk2'" PL/pgSQL function "wait_for_stats" line 9 at SQL statement このようにpg_statがtimeoutしているため、make checkが失敗しているのだと感じました。 そこで、 Q1. タイムアウトする原因と対策方法 上記をご教授していただけないでしょうか？ 宜しくお願いします。
PostgreSQL、レコード内にある結果(カウントの結果)を入れたい こんばんは、お世話になっております。 タイトル通りの質問です。 以下のテーブルがあったとします。 Aテーブル No.|名称|状態 ---+----+---- 1 |a |作業中 2 |b |作業中 3 |c |作業中 4 |d |作業中 5 |e |作業中 1 |a |準備中 このテーブルを以下のように表示したいです。 No.|名称|状態 |準備数 ---+----+-------+------ 1 |a |作業中 |1 2 |b |作業中 |0 3 |c |作業中 |0 4 |d |作業中 |0 5 |e |作業中 |0 『No』と『名称』が同じものをまとめ、 状態が準備中のものをカウントして数としてレコード内に入れたいです。 postgresのバージョンは8.2、 pgAdminのバージョンは1.6.3 です。 何か方法をご存知の方がいらっしゃいましたら回答いただきたく思います。 不足な点があれば指摘してください。補足させていただきます。 以上です、よろしくお願いします
SQL における変数の宣言と代入の仕方 PostgreSQL8.1 を使っております。尻に火がつき始めたので、同じような内容の投稿ですがどうかご容赦下さい。 下記のように記述したのですが、各星座の文字列を重複して記述するのを避けたいので、 変数を宣言するなり何なりして何とかしたいのですが、 "SQL assign" やら "SQL variable" といったキーワードで色々検索しても、どうしても有用な情報に行き当たりませんでした。なにかしらのヒントを頂ければ幸いです。 宜しくお願いいたします。 --- CONSTRAINT myZodiac check ( myZodiac in ('Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo', 'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces') ), CONSTRAINT yrZodiac check (yourZodiac in ('Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo', 'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces', 'Air', 'Water', 'Fire', 'Earth',) ) ---
PostgresSQL8.4でツリー上に取得したい こんにちわ。 PostgresSQLでツリー上にデータを取得したいのですが、思ったように取得できないのでご教授をお願いします画像の「取得したい順番」。 データはid,name,parentとの構造になっています。 データは親子構造になっており、親の下に子が並ぶようにしたいんです。 子は親のidをparentに持っています。 元のデータは画像の「元データ」になっています。 現状再起SQLでデータを取得しid or parentでソートを掛けているのですが、意図した通りに取得できません画像の「取得出来る順番」。 そもそも再起SQLでできるのか、相関サブクエリを使うのか・・・SQLのみでできるのかすら分からなくなってきました・・・。 何か画像の「取得したい順番」通りに取得する方法はないでしょうか。 ヒントだけでもいいので、ご教授をお願いします。
PostgreSQL、外部ファイルからDBへの振り分け反映の方法 早速ですが質問させて頂きます。 『外部ファイル.txt』内容 ------ここから------ A B C D E F G H I 1 2 3 4 5 6 7 8 9 2 3 4 5 6 7 8 9 1 3 4 5 6 7 8 9 1 2 B C D E F G H I A 4 5 6 7 8 9 1 2 3 5 6 7 8 9 1 2 3 4 ------ここまで------ 上記のようなスペース区切りの文字ファイルがあるとして、このファイルのデータを 英字から始まる行はtable1へ、数字から始まる行はtable2へと振り分けたいです。 現在、１つのテーブルに反映させることは以下のコマンドを使用することにより可能なのですが、 ２つのテーブルに振り分ける方法は全く思い浮かびません。 １つのテーブルに反映させる方法 \COPY table1 from 'C:\\～ファイルパス～\\外部ファイル.txt' delimiters ' ' null '' 下記のようなファイル内容でもかまいません。 ------ここから------ A B C D E F G H I -------------------- 1 2 3 4 5 6 7 8 9 2 3 4 5 6 7 8 9 1 3 4 5 6 7 8 9 1 2 -------------------- B C D E F G H I A -------------------- 4 5 6 7 8 9 1 2 3 5 6 7 8 9 1 2 3 4 ------ここまで------ あるいは ------ここから------ A B C D E F G H I -------------------- 1 2 3 4 5 6 7 8 9 2 3 4 5 6 7 8 9 1 3 4 5 6 7 8 9 1 2 ------ここまで------ わかる方がいらっしゃいましたらご回答いただければと思います。 また、出来ないようであれば何か参考になりそうな情報を教えていただければありがたいです。 PostreSQLのバージョンは8.2？です。 不足している情報がありましたら指摘してください。 以上です、お手数かけますがよろしくお願いいたします。
SQL における変数の宣言と代入の仕方 データベース言語でどの様なことが出来るものかと思い、postgreSQL を独りでいじり始めました。入力されたデータのチェックをきちんとしないといけないのだな、と思い、 --- CONSTRAINT rangeMin check (policyMin in (-3,-2,-1,0,1,2,3,4)), CONSTRAINT rangeMax check (policyMax in (-3,-2,-1,0,1,2,3,4)), --- と記述したのですが、「-3 から 4」という部分を重複して記述するのを避けたいので、 変数を宣言するなり何なりして何とかしたいのですが、 "SQL assign" やら "SQL variable" といったキーワードで色々検索しても、どうしても有用な情報に行き当たりませんでした。なにかしらのヒントを頂ければ幸いです。 宜しくお願いいたします。
【PostgreからSQL-ServerのテーブルをSelect】 PostgreからSQL-ServerのDBにあるテーブルをSelectしたいのですが、 ODBCまでは設定したものの、それ以降のやり方がわかりません。 どなたか教えていただけないでしょうか。 【参照元】 ＊Windows 2003 ServerR2(32Bit) ＊SQL-Server 2005 【参照先】 ＊Windows 2003 ServerR2(32bit) ＊PostgreSQL 8.2 参照先と参照元を変更すればSQL-Server上で出来そうなのですが、 今回、Postgre側からSQL-ServerにSelectしなければなりません。 OracleでいうところのDB Linkなのですが、どなたか教えていただけないでしょうか。 URLのご提示でも結構です。 どうぞよろしくお願いいたします。 Postgre　---- Select（後にViewに変更予定） ----→ SQL-Server
ポスグレでの幾何学データ配列の使い方について質問です。 create table test_table1 (id serial, test_lseg lseg[]); insert into test_table1(test_lseg) values (ARRAY[lseg'((0,44),(0,88))',lseg'((1,44),(1,88))',lseg'((2,44),(2,88))',lseg'((3,44),(3,88))',lseg'((4,44),(4,88))',lseg'((5,44),(5,88))'] ); という感じのテーブルを作成し、test_lsegカラムのArray内にある線分に特定の座標が含まれているかを調べるような事をしたいのですが、ARRAY内の要素を検索する際の演算子を指定する方法がよく分かりません。とりあえず以下のようなSQL文では検索できないようです。 SELECT * from test_table1 WHERE test_lseg && ARRAY[lseg'((0,80),(0,80))']; SELECT * from test_table1 WHERE lseg'((0,80),(0,80))' && any (test_lseg); test_lsegカラムのArray内にある線分に特定の座標が含まれているかが分かり、出来ればIndexが張れるようなやり方がありましたらご教授ください。
PostgreSQLのパフォーマンスについて質問です。 INSERTを大量に行う処理の速度が遅いので、高速化をはかるため、INSERTを２０個ずつまとめる修正を行いました。 基本的に速度は速くなったのですが、あるデータだけ逆に遅くなってしまいました。 その遅くなったデータはレコード数が膨大なのですが、まとめてINSERTをおこなうSQLを連続で発行したら、処理速度が遅くなることはあるのでしょうか？ なお、INSERTは下記のように行っています。 INSERT INTO テーブル名 （列名群） VALUES (挿入データ群),(挿入データ群),・・・,(挿入データ群); また、すべてのテーブルにインデックスはついておらず、プライマリキーと外部キーが設定されています。 マシンスペックはCore2 Duo 2.53GHz、メモリ2GB、OSはWindows XPです。 よろしくお願いします。
pgpoolというpostgreSQLのレプリケーションツールについて質問です。 現在 WEB2台 DB2台の サーバー構成でWEBシステムを運用中なのですが、 このDB2台の同期を取る為にpgpool-IIというツールを使っています。 所が、このツールを使用していると 2台目のDBサーバーへのノードが勝手にダウンしてしまいます。 原因と考えられることも検討がつかず、 解決方法もわかりません。 どなたか詳しい方がいらっしゃれば、ご教授いただけないでしょうか？ よろしくお願いいたします。
pgAdmin3でDB作成時のcollationについて。 Linux上で動作するPotGreSQLをwindows7上のpgAdmin3より 操作しています。 DATABASEをクリエートする際、 DBの名前、オーナー、エンコーディング、template、テーブル空間等を 入力しますが、コーレーションと文字型が選べません。リストボックスが 固まったままとなります。値はスペースのままで選べません。 以下の環境で使用しています。 --------- OS :CentOS5.4 PostgreSQL : 8.1.21 Win7pro pgAdmin3: ver1.10.3 --------- 設定漏れではないかと思い調査中です。 原因について、ご存知の方、ご教授いただけませんでしょうか。
postgrsqlを別のディレクトリに初期化したい Cent osのデータベースサーバーの選択としてpostgrsqlをインストールしました。 データは /var/lib/pgsql/data にできました。 /varの空きが少なかったので、/var/lib/pgsql/dataを削除し、 ルートに/pgsqlを作成し、そこに初期化しました。 >initdb -E UTF8 -D /pgsql/data すると、/pgsql/dataに初期データが生成されましたが、 いつの間にか/var/lib/pgsql/dataにも出来ています。 [root@linuxpc ~]# ls -pl /pgsql/data 合計 108 -rw------- 1 postgres postgres 4 9月 8 15:54 PG_VERSION drwx------ 5 postgres postgres 4096 9月 8 15:54 base/ drwx------ 2 postgres postgres 4096 9月 8 15:54 global/ drwx------ 2 postgres postgres 4096 9月 8 15:54 pg_clog/ -rw------- 1 postgres postgres 3396 9月 8 15:54 pg_hba.conf -rw------- 1 postgres postgres 1460 9月 8 15:54 pg_ident.conf ・・・略・・・ -rw------- 1 postgres postgres 13793 9月 8 15:54 postgresql.conf [root@linuxpc ~]# ls -pl /var/lib/pgsql/data 合計 132 -rw------- 1 postgres postgres 4 9月 8 15:55 PG_VERSION drwx------ 5 postgres postgres 4096 9月 8 15:55 base/ drwx------ 2 postgres postgres 4096 9月 8 16:02 global/ drwx------ 2 postgres postgres 4096 9月 8 15:55 pg_clog/ -rw------- 1 postgres postgres 3182 9月 8 15:55 pg_hba.conf -rw------- 1 postgres postgres 1460 9月 8 15:55 pg_ident.conf ・・・略・・・ -rw------- 1 postgres postgres 13793 9月 8 15:55 postgresql.conf -rw------- 1 postgres postgres 57 9月 8 16:02 postmaster.opts -rw------- 1 postgres postgres 45 9月 8 16:02 postmaster.pid どちらが有効なのでしょうか？ /var/lib/pgsql/data側は要らないのですが。
こんばんは。 軽いSQL文がかけずに困っております。 どなたかご教示願います。Postgres8.3になります。 テーブル名　num カラムはuserとidとします。 データは最下部にあるように持ちます。 a～eのユーザのうち、idが2200番台のうち、2201と2202だけをもつユーザを抽出するSQL文を望みます。 a：2200と2203が存在するので偽 b:真 c:2202が無いので偽 d:2203が存在するので偽 e:真 このようなSQLを書きました。 1.numより2201を持つuser 2.numより2202を持つuser 3.numより22～で始まる以外のuser それぞれの等しいuserが真と思ったのですが、本来3.では22～始まるidを持たないuser としなければなりませんでした。 ここで詰まってしまい、タイムアップとなってしまいました。 どのようなSQLが望ましいでしょうか。 よろしくお願いいたします。 select * from num as m, (select x.user from (select user from num where id = 2201 group by user_id) as x, (select user from num where id = 2202 group by user_id) as y, (select user from num where id::text not like '22%' group by user) as z where x.id = y.id and x.id = z.id and y.id = z.id) as n where m.id = n.id; num user,id a,1000 a,1100 a,2000 a,2100 a,2200 a,2201 a,2202 a,2203 a,3000 b,1000 b,2100 b,2201 b,2202 b,3000 b,3100 c,1000 c,2201 c,2203 c,3000 c,3100 c,3200 d,1000 d,2100 d,2201 d,2202 d,2203 d,3000 d,3100 d,3200 e,1000 e,2201 e,2202 e,3000 e,3100 e,3200 e,3300
PostgreSqlのテーブル一覧が欲しい pg_class（のrelkind = 'r'の条件）にテーブルの情報が入っています。 これを自作テーブルとシステムが生成したテーブルに別けたいのですが、どの区分を見ればわかりますか？
エラーが起こっているレコードの特定 pg_dumpでバックアップを取っていたら以下のメッセージが出力されました。 > pg_dump: サーバのエラーメッセージ: ERROR: 符号化方式"UTF8"文字0xe28093<は"SJIS"と同じではありません おそらくユーザがSJISで表現できない文字を入力したのではないかと思います。 それはなんらかの根本的な対処が必要として、とりあえずバックアップができるように、このレコードの該当する文字列をpgadminを使って手動で修正しようと思っています。ですが、そのレコードを特定する方法がわかりません。 このエラーが出た場合、問題があるレコードを特定するにはどうしたらいいでしょうか。
PostgreSQLの読み方、発音 たいへんつまらない質問で恐縮ですが、 PostgreSQLの読み方は、私が聞いた範囲では、 ・「ポストグレス キュー エル」 ・「ポストグレ エス キュー エル」 の両方聞いたことがあります。 実際には、どれが正しいのでしょうか？
PostgreSqlシステムカタログを組み合わせて データベース名 スキーマ名 テーブル名 ----------- -------- -------- dtabase1 public table101 dtabase1 schema1 table111 dtabase1 schema1 table112 dtabase2 public table211 dtabase3 schema1 table311 dtabase3 schema2 table321 というようなデータを取ることは出来ますか？
PostgreSqlのシステムスキーマについて教えてください public・・・共有。 pg_catarog・・・カタログ情報。 information_schema・・・オブジェクトについての情報を持つビューの集合。 あと２つ pg_toast pg_temp_1 については良く分かりません。 マニュアルサイト http://www.postgresql.jp/document/8.1/html/index … は量が多すぎて隅々まで見きれていないかもしれません。 ここに載っているという指摘でも結構です。
postgresのチェックポイントについて postgreSQL(8.4.4)のドキュメントで、 「PostgreSQLでは、メモリ上に変更された行の情報を記憶しないため、同時にロックできる行数の上限はありません。 しかし、行をロックする際に、ディスクに書き込む作業が発生するかもしれません。 例えばSELECT FOR UPDATEは、選択された行をロックしたものと印を付けるために変更を行いますので、ディスクにその結果を書き込むことになります。」 の記述があるのですが、 これは、DMLを発行すると即時にチェックポイントが走り、 I/Oが発生するということなんでしょうか??
PostgreSQL WALファイルの運用について はじめて投稿させていただきます。 PostgresSQLを使用したシステムの構築に初めて携わることになり、 WALの運用についてわからない点があり、質問させていただきます。 WALはpostgresql.conf > checkpoint_timoutパラメータでの指定間隔で 永遠に蓄積されていくのでしょうか。 自動パージ機能などは存在しますでしょうか。 上記機能がない場合、どのような運用が考えられるでしょうか。 お知恵をお借りしたく思います。 サーバディスク領域の圧迫を回避するための運用を模索しておりますが、 解決策が見つかりません。ご教示ください。 パージ用バッチの運用？ WALの他サーバへの書き出し？
postgresのdatabase名と、そのencodingを取得する方法を教えてください。 postgres8.1です。 システムカタログ http://www.postgresql.jp/document/pg811doc/html/ … の pg_databaseの項目として持っているだろうと思い、見てみました。 encodingint4 このデータベースの文字符号化方式 これか？と思いましたが、数値IDのみでした。 この数値から、utf8やsjisといった情報にどうやったら繋がりますか？
■一番最初に値が入っている(Nullでない)カラム名を取得するには？ 会社の上司が、上記の条件をSQL文一つで出来るというのですが、 postgres SQLの書き方が思いつかず、大変困っています。 状況を説明します。 主に以下のようなカラムを持つテーブルがあります。 ID, 年, 月, タイプ, price_1d, price_2d, price_3d, ..., price_31d price_?d には null or 数字が入ります。 上記のような状況で、 price_1d ～　price_31d の順で最初に値が入っているカラム名を取得し、 最初に値があるのは何年何月何日と判定したいというわけです。 おまけに、タイプには 0 or 1 が入り、 その値によっては、price_?dではなく、別カラム price2_?d を見ないといけないという条件付きです。 このような条件をSQL一つで抽出することははたして本当に可能なのでしょうか？ 何かしら解決の糸口となるヒントだけでも構いませんので、 何か情報を頂けると大変ありがたいです。 また、そんなの出来ません、 という情報でもいただけると嬉しいです。 宜しくお願い致します。
PreparedStatementでの複数検索 環境：struts1.3,postgresql8.4,JDK1.6 テキストボックスなどから1つから6つの条件でsqlを検索したいのですが この場合、1つでもnullがある時は検索されません。 Connection con = null; con = ProductDAO.getConnection(); //SQLの実行 String selectStatement = "SELECT * FROM test,test_list WHERE test.id = test_list.id " + "AND prefecture=? " + "AND low_price>=? " + "AND low_age>=? " + "AND sameday_select =? " + "AND terms_select =?" + "AND category=?"; PreparedStatement prepStmt = con.prepareStatement(selectStatement); prepStmt.setString(1, aForm.getPrefecture()); prepStmt.setInt(2, aForm.getLow_price()); prepStmt.setInt(3, aForm.getLow_age()); prepStmt.setString(4, aForm.getSameday_select()); prepStmt.setString(5, aForm.getTerms_select()); prepStmt.setString(6, aForm.getCategory()); ResultSet rs = prepStmt.executeQuery(); (3) SQLの実行結果の処理 while (rs.next()) { 　　処理 } この場合、if文などでaForm.getPrefecture()がnullの場合などで1つ1つ条件を付けないと駄目でしょうか？その場合、if文が膨大な数になってしまうため何か良い方法はありますか。 あるならば、具体的に教えて下さい。
Linuxでpostgresのテーブルの同期をとりたい Linux上で動いている2つのpostgresのテーブルデータの同期をとりたいと考えています。 具体的には、Aサーバーのテーブルが更新されたら、Bサーバーのテーブルも同様の更新したいのです。 Windowsでは使えそうなツールがあったのですが、Linuxに対応していないみたいなので・・・ postgresのバージョンは、8.3.9です。 何か良い方法がありましたら、ご教授願います。
postgresのlinux版でやっている事と同等の事をwindows版でやりたい！ os:windows xp やりたい事は以下です。 圧縮して出力 $ pg_dump dbname | gzip > filename.gz 解凍のみ $ gunzip -c filename.gz 解凍してリストア $ gunzip -c filename.gz | psql dbname gzipがzipやlhaに変わってもOKです。 --format=c オプションで出力したファイルは解凍のみの方法が分かりませんでした。 圧縮ツールはwindowsの標準か追加モジュールが第一希望 第二希望はフリーソフトです。
SQLServer からのデータ移行（varbinary） SQLServer 2000 から PostgreSQL 8.4.3 へデータ移行を考えているのですが、 つまずいて困っています。 ご存知の方がいらっしゃいましたら教えていただけないでしょうか。 あるテーブル上にvarbinary(32)の項目があり、 クエリアナライザで見ると「0x11223344・・・」という値が入っているのですが、 PostgreSQL側ではこの項目のデータ型はどう定義したらよいでしょうか。 character varying(32)としてみましたが、 定義がふさわしくないのか、SQLがまずいのか、思うようにINSERTができませんでした。 たとえば、 insert into ... values(0x1122334455667788990011223344556677889900112233445566778899001122, ...) とすると --- NOTICE: 識別子"x1122334455667788990011223344556677889900112233445566778899001122"を"x11223344556677889900112233445566778899001122334455667788990011"に切り詰めます SQLステート:42601 --- が返りますし insert into ... values(x'1122334455667788990011223344556677889900112233445566778899001122', ...) では --- ERROR: 値は型character varying(32)としては長すぎます SQLステート:22001 --- が返ります。 実際は、.Net C# のプログラムにてDataTableにSQLServerからデータをFillして、それを元にINSERT文を作成しています。 デバッグすると、Byte配列に[0]17,[1]34... という具合に入ってくるので if ((col.DataType == typeof(String)) || (col.DataType == typeof(DateTime)) ||(col.DataType == typeof(Decimal)) ) { valueColumns.AppendFormat("'{0}',", row[col.ColumnName].ToString()); } else if(col.DataType == typeof(Byte[])) { string tmp = ""; for (int i = 0; i < ((Byte[])row[col.ColumnName]).Length; i++) { tmp += (string.Format("{0:X2}", ((Byte[])row[col.ColumnName])[i])); } valueColumns.AppendFormat("x'{0}',", tmp); } else { valueColumns.AppendFormat("{0},", row[col.ColumnName].ToString()); } のようにDataType別に振り分けて、上記else ifが通るようにコーディングしています。 よろしくお願いいたします。
postgreSQL、pg_dumpのオプションについて pg_dumpの--format=formatオプションの解説でオプション c は「形式はデフォルトで圧縮されます。」とあります。 「デフォルトで圧縮される」とはどういう事ですか？ 何形式ですか？
Postgresqlのインストーラーについて こんにちは。初めて質問させていただきます、初心者プログラマです。 現在、仕事上でアプリ開発を行い、postgresqlを使っています。 その完成した、アプリをインストールする場合、postgresqlもインストールしなければなりません。 ですが、ユーザーの方にpostgresqlのインストーラーを使用して、セットアップしていただくには、 少々難易度が高いのではと思っています。 そこで、ユーザーの方には簡単にpostgresqlをインストールしていただける手法を模索しております。 どなたか良い方法がございましたら、ご教授お願い致します。 今検討しているのが、postgresqlソースを修正し、それを元にコンパイルして、setup.exeみたいなものができないかなと思っております・・・。 今のバイナリファイルは拡張子がexeなのでmsiみたいにコマンドラインでオプションが使えれば簡単にできそうなのですが・・・。
テーブルの情報を取得したい PHP5とPostgreSQL8.4.3を使っています。 フォームにテーブル名を入力して送信すると、そのテーブルの情報(カラム名、型名など)が表示され、 そのテーブルに対してレコードの追加や削除を行いたいのですが方法が分かりません。 どなたか分かる方いらっしゃいましたらお願いします。
文字列を time 型に変換するには。 お世話になります。 PostgreSQL 8.2 & PgAdmin 1.6.3（WinServer 2003）を使用しています。 varchar 型のカラムに格納されている時刻を表す文字列（'9:15' など）を time 型に変換してビューを作成する必要があるのですが、できずに困っています。 具体的には... 「table1」というテーブルに「時刻」(varchar 型)という名前のカラムを作成し、「9:15」という文字列を格納しておきます。 これをもとにビュー（view1）を作ろうとしているのですが、select 文のところで 、ERROR: syntax error at or near "時刻" SQLステート:42601 というエラー（構文エラー）が出てしまいます。 　select time 時刻 from table1 　結果：ERROR: syntax error at or near "時刻" SQLステート:42601 ちなみに、時刻を文字列で指定してやると、ちゃんと time 型で結果が返ります。 　select time '9:15' 　結果：09：15：00 抜本的に方法が間違っているとはおもうのですが、いくら調べてもこれを解決できるようなサイトが見当たりませんでした。 文字列を time 型に変換するにはどのようにしたらよいのかご教示いただけないでしょうか。 よろしくお願いします。
Passwordを設定したPostgreSQLのバックアップなどができない。 PostgreSQLのバックアップを行おうとしているのですがバックアップSHELLを実行 するとパスワードを聞いてきます。 pg_dump -Udbuser -s DBANME > /DbBkup/dbbackup.out そこで実行ユーザのHOMEディレクトリに.pgpassを置き localhost:*:DBNAME:dbuser:dbpass と登録し、実行しところ、これでもパスワードを聞いてきます。 最終的にはcronで実行したいのですが、解決方法がわかりません。 お願いいたします。
SQLでPostgreSQLサーバーを切断させたいと考えています。なかなかわかりません。 だれか、教えて頂ければ大変助かります。 宜しくお願い致します。
行数をカウントするSQLにつきまして いつもお世話になっております。 下記の売上テーブルから みかん＝3（行目） というようなデータを抽出するSQLはどのように記述したら良いのでしょうか？ ・・・・売上テーブル・・・ 売上番号　品名　単価 101　　　りんご　100 102　　　りんご　100 103　　　みかん　150 104　　　りんご　100 105　　　みかん　150 106　　　メロン　250 postgre8.3のためrow_numberが使えません
Access2003+PostgreSQLにて販売管理システムを構築しています。 レコードを見る・更新する時はサーバーのレコードを ワークテーブル（ローカルのmdbファイル内のテーブル）にコピーし 値を変更後、ローカルからサーバーにデータを戻す、といった処理をしたいと考えています。 サーバーからレコードをコピーする際は、ODBC接続＆ADOにて サーバーのレコードを一旦レコードセットに格納し 「CurrentProject.Connection.Execute SQL文」で ワークテーブルにINSERTしています。 ここで質問なのが、ワークテーブルからサーバーにレコードを戻す際は ワークテーブル・サーバーへはそれぞれどの方法で接続すればいいでしょうか。 例えばサーバーへODBC＆ADOで接続した場合、ワークテーブルの取扱方法（接続方法）が分かりません。 サーバー：ADO、ワーク：DAO、みたいな事するのでしょうか。 スマートな方法がお分かりの方は教えて下さい。 宜しくお願い申し上げます。
postgresSQLのサーバが起動せず困っています。 OS: windows Vista バージョン：postgres8.4 いつからか、サービス管理からpostgresSQLが起動できなくなりました。 症状としては、サービス開始中のまま、タイムアップしてしまうという具合です。 詳しい原因が知りたくて、エラーログを探したのですがログが見つからず、原因特定ができませんでした。 そのため、再インストールを試みました。 しかし、今度は別の問題が発生し、再インストール中に「A non-fatal error ocuured whilst loading database modules.」というエラーが発生し、上手くいきません。 インストール自体は、下記のサイトを参考にしました。 こちらのサイトだと、上記のエラーもまた、サーバの起動に失敗している可能性があると書いてありました。（※管理者権限での実行はしました。） http://lets.postgresql.jp/documents/tutorial/win … どなたか、原因が分かる方おりましたら、ご回答ください。よろしくお願いします。
（Linux、データベース初心者）スクリプトを実行するとPermission deniedが発生します。 Postgresql psqlに関して よろしくお願いします。 UbuntuサーバにインストールしたPostgresqlに対し、スクリプトを実行してcsvファイルをインポートしようと考えています。 その際にPermission deniedが発生しテーブルにデータが入りません。 以下にスクリプトファイルとエラーメッセージを掲載します。 <test.sh> #!/bin/bash #接続文字列 export PGHOST="ホスト名” export PGPORT="ポート番号" export PGDATABASE="データベース名" export PGUSER="ユーザー名" export PGPASSWORD="パスワード" PSQL='COPY bat_test FROM ' '''/test/test.csv''' ' with DELIMITER ' ''',''' echo "$PSQL" | psql echo "commit" | psql <以上、test.sh> <エラーメッセージ> test.sh：/test/test.csv:Permission denide <以上、エラーメッセージ> インポートしたいファイルの権限等は確認しましたがわかりませんでした。 何が悪いのかご指摘いただければ助かります。 どうか、よろしくお願いします。
こんにちは。 windows7にPostgreSQLをインストールできずに困っています。 ウイルスソフトは入っていません。 ファイヤーウォールも無効にしています。 お手数ですがよろしくお願いします。
PostgreSQL8.3系のAutovacuum不備？ 現在、8.3.3を使用しておりますが、最近応答がかなり重くなりまして 手動にてvaccumを実施し対処しました。 インストール時のデフォルトで運用しているのですが ＜値＞ autovacuum | on autovacuum_analyze_scale_factor | 0.1 autovacuum_analyze_threshold | 50 autovacuum_freeze_max_age | 200000000 autovacuum_max_workers | 3 autovacuum_naptime | 1min autovacuum_vacuum_cost_delay | 20ms autovacuum_vacuum_cost_limit | -1 autovacuum_vacuum_scale_factor | 0.2 autovacuum_vacuum_threshold | 50 かなり動作が重くなっても、自動実行されない模様です（閾値が合わない）。 そもそもチューニングすべき物なのでしょうか？ お詳しい方、ご教授頂けないでしょうか？宜しくお願い致します。
一応確認はしましたが、過去に似たような質問があったらすみませんが どうか教えて下さい。 今までOracleでコーディングしたことはありますが、postgresは初心者です。 文字列を右から切り出す関数はないでしょうか？ 例えば、文字列「TEST」の末尾2文字を取りたいとき OracleのSQLで言えば substr( 'TEST', -2 ) ⇒　'ST' が取れますが postgresではこういう風に使えないようです。 substr 以外の関数や、代わりにこうやる方法があるよと言ったことを教えて下さい。 お願い致します。
Postgresqlでdateとintの加算 テーブル1の訪問日（date）に、テーブル2の訪問周期日数(int)を加算して、次回訪問予定日を表示するにはどうすればいいでしょうか？ テーブル1=主キー：顧客番号（char）,顧客名（text）,顧客訪問日（date） テーブル2=主キー：顧客番号（char）,訪問周期日数(int) 出力　顧客番号,顧客名,次回訪問予定日 備考 ＊訪問日（date）だけ各営業マンが書き込みを行う。その他は原則システムの開発・管理チームが書き込み。 また、このケースのように、ほとんどのユーザが（date）のみ書き込みをする際、排他制御で何か適した例などご教示いただければ大変助かります。 よろしくお願いします。
LinuxでPostgreSQL 8.1.11を運用しています。24時間運用なので、VACUUM FULLはせずに毎日深夜にVACUUM ANALYZEを実行しています。 insert,update,deleteが頻繁に起こるシステムです。 VACUUM FULLを実行した場合、どの程度領域を回収できるのかを見積もろうとしています。 現在のデータサイズとOS上の使用容量の差分がわかれば、VACUUM FULLで回収できる領域が見積もれると考えているのですが、データサイズの確認方法がわかりません。 次のような計算でしかわからないでしょうか？ (1行のサイズ×行数)×全テーブル 上のような計算の場合でも、textのような場合は、サイズが行ごとに異なりそうな気がします。データサイズを確認する方法はありませんでしょうか？
postgresql8.3.9のWindows版を使っています。 psql データベース < bak.sql で1GBくらいあるＳＱＬファイルをリストアしたのですが、 INSERT 0 1が大量に表示されて遅いです。 何も表示させない or 高速版っていうものはあるのでしょうか？
VS2005のC#にてWindowsアプリを作成します。 データベースとして、PostgreSQLを使おうと思っているのですが、 ・VS2005から使用するための設定方法 ・ソースコード上に書く必要のあるコマンド（例：MySQLなら『mysql_real_connect』等） について、詳細に解説しているWebサイトのURLをご存知の方おられましたら、 ご教示お願いできませんでしょうか？ 自分でも探してみたのですが、なかなか見つからず困っております。。 どうかよろしくお願い致します。
PostgreSQLでのTimestamp列と数値列同士の演算での質問です。 Timestamp型のField:Aと、数値型のField:Bを保持するテーブルにて、 AのB分後を求める時刻の演算方法を教えてください。 単純に Select A + B from hoge だと、1日後になり時刻の部分が失われてしまいます。 下記のテーブルに対して発行すると A　　　　　　　　 B --------------------------------------------------- 2010-01-01 09:00:00+09 1 2010-01-01 10:00:00+09 5 ?column? ------------ 2010-01-02 2010-01-06 が返ってきます。 分かる方がいましたら教えてください。 宜しくお願いいたします。
サーバで7.4.8が動いている状態で、8.4.1をインストールしたいと思っています。 ./configure --prefix=/usr/local/postgres-8.4.10/ make make install といった形でインストールを行ないましたが、 --with-pgport=5433 とポートの指定忘れてしまいポートが被ってしまっているようで、うまく動きません。 そこで、「--with-pgport=5433」のオプションを付け足したいのですが、どのように行なえばよいでしょうか？ （DB、TABLEなどは一切作っていません） もし、後で付け足すことができないのであれば、再インストールを行ないたいのですが、 ./configure --prefix=/usr/local/postgres-8.4.10/ --with-pgport=5433 make make install といったように、行なえば上書きインストールしてくれるのでしょうか？ よろしくお願い致します。
いま自宅(linux)でPostgresqlでデータベースを構築し、10万件規模のデータを管理しています。 このデータは日々更新されるのですが、この更新情報を 外部のレンタルサーバ内のPostgresqlに簡単にコピーする方法はないでしょうか？ レンタルサーバ側はport=80/443くらいしか通さないので postgresqlに直接接続することができません。 今現在は、 自宅のpostgresqlからsql形式でdumpファイルを作成し、 その中身から比較的新しいSQLを抜き出し、 　レンタルサーバ側のphppgadminをたちあげ、さきほどSQLをコピー＆ペーストし実行 という面倒なことやってます。 上記を解決する ソフトやツール or レンタルサーバに置くWebアプリサンプル or 参考情報 などあればおねがいします。
初めて投稿させて頂きます。 過去に、PostgreSQL 7.4.6(Linux 2.6.9-5.EL)の環境で、データ監視系のシステムを構築しました。稼働してから数年が経過しています。 このシステムのDBには数十のテーブルがあり、期待通りに動いています。 ただ、一つのテーブルのみ、時間が経過の経過と共にselectが恐ろしく遅くなる現象が発生しています。 そのテーブルのスキーマは以下です。 =# \d node_condition; Table "public.node_condition" Column | Type | Modifiers ------------------+-----------------------------+----------- node_id | integer | checktime | timestamp without time zone | ping | boolean | rtt | real | cpu | real | loadavg | real | mem | real | disk | real | snmp_w | integer | ip_w | integer | serv_w | integer | licence | integer | f_licence | integer | version | text | web_ver | text | sync | boolean | errchecktime | timestamp without time zone | ipwatchtime | timestamp without time zone | servwatchtime | timestamp without time zone | nmsdlasttime | timestamp without time zone | filemakelasttime | timestamp without time zone | 現在入力されているデータ数は51ラインです。 設計上、このテーブルは約1分間に51回updateが行われます。 主に時間系の更新です。 他のテーブルと違うところは、カラム数が少し多い、updateが頻繁に実行される、というくらいです。他のテーブルは多くても12カラムで、子のような現象は出ていません。 SQL(select)は至ってシンプルで、このテーブルしか参照しません。(select node_id,checktime ... from node_condition;) 構築時の応答速度は至って普通だったのですが、昨年の夏に異常に遅くなっていることが判明しました。 その時は、データを退避してからテーブルをDROPしてcreateし直すという荒業で解決したのですが、先日また異常に遅くなっている事に気づきました。 （この時点で原因を潰すべきだったのですが、忙しくて強引にやってしまいました。ちなみに、その時VACUUM,ANALYZEはやったのですが、効果がありませんでした。また、このシステムではVACUUM,ANALYZEが定期的に実行されています。） postgresはupdateのアルゴリズムは、他のRDBMSと違うような事が書いてありましたが、カラム数が多くなると挙動に影響が出るのでしょうか。どなたか詳しい方がいましたら、ご教授頂けると助かります。
RHEL5.2にPosgresql8.3をインストールしたのですが、 psqlでDB接続時に下のメッセージが表示されます。 WARNING: You are connected to a server with major version 8.3, but your psql client is major version 8.1. Some backslash commands, such as \d, might not work properly. version8.1を入れていないのになぜか表示されてしまいます。 動作的には特に問題なさそうなんですが、気になっています。 対応方法などありましたら、教えてほしいのですが、 どうぞよろしくお願いします。
Postgres 8.3.9を使用しています。 現在使用しているテーブルの中に HTMLソースを格納しているカラムがあります。 テーブル名：contents カラム名：text ※データ例：<a href="http://www.google.co.jp">グーグル</a> HTMLソースが格納されたカラムに対して、キーワードでの検索を行いたいと考えています。 当然ながら以下の様に検索をすると、HTMLソース（例：href）をキーワードとしても検索に引っかかってしまいます。 select * from contents where text Like '%【検索キーワード】%'; なんとか、HTMLソースをキーワードとした場合は検索されずに、 HTMLタグに囲まれた部分（※上記データだと'グーグル'）をキーワードとした場合にだけ、 検索されるようにしたいと考えています。 何か良い手法はないでしょうか。 ご教授をお願い致します。
PostgreSQL（8.4.2）のユーザ定義関数（ストアドプロシージャ）を、 ODBC経由でVisualStudio2005から利用したいのですが、 サーバーエクスプローラーからユーザ定義関数を参照することが出来なくて悩んでいます。 ユーザ定義関数はpgAdminIIIで作成しました。 cse（Common SQL Environment）などのフリーのツールからは問題なく参照できます。 VisualStudioにユーザ定義関数として認識させるための何かおまじない的な物が必要なのでしょうか。 それともPostgreSQLとVisualStudioとの相性が悪いのでしょうか。 なおユーザ定義関数以外であるテーブルやビューは、 サーバーエクスプローラーから参照できます。
PostgreSQLの8.1.15を使用しております。 3時間ほどかかるバキューム処理を高速化させたいと考えているのですが、 設定関連でチューニングする事は可能なのでしょうか？ もし可能でしたら、その方法、もしくは関連サイトをご教授頂けませんでしょうか。 よろしくお願いします。 尚、autovacuumは負荷対策として現在停止しており、 日次でanalyzeオプションにてvacuumしております。
すでにあるsqlファイルを使用して、データベースを作成する方法 もらったシステム（html,php,sqlで構成されるシステム）を自分の環境で動かそうとしているのですが、データベースを作成できないため、先に進むことが出来ず困っています。 もらったシステムには、テーブルのsqlファイルや、そのテーブルに入れるデータのsqlファイルがありました。 わかりにくい文章ですいません。 どなたかご存じの方、ご教授お願いいたします。 OS: CentOS5.3 postgresql8.1.18 apache2.2.3 php5.1.6
閲覧有難うございます。 質問内容なのですが、Postgresqlをインストールしたのですがpostgresql.confとpg_hba.confが見つかりません。 OSはCentOS５です。 インストール方法は以下の手順で行いました。 # /usr/sbin/adduser postgres # chown postgres:postgres /usr/local/pgsql # mkdir /usr/local/src/postgres-8.2.6 # chown postgres:postgres /usr/local/src/postgresql-8.3.7 # su - postgres # cd /usr/local/src # tar xfz /usr/local/src/postgres-8.2.6.tar.gz # cd /usr/local/src/postgres-8.2.6 # ./configure # make # make install また、 [root@ ~]# su - postgres -bash: 　LD_LIBRARY_PATH=/usr/local/pgsql/lib: そのようなファイルやディレクトリはありません -bash: 　export: command not found -bash: 　PATH=/usr/local/pgsql/bin:/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin: そのようなファイルやディレクトリはありません -bash: 　export: command not found -bash: 　MANPATH=/usr/local/pgsql/man:: そのようなファイルやディレクトリはありません -bash: 　export: command not found -bash: 　export: command not found -bash: 　PATH=/usr/local/pgsql/bin:/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin: そのようなファイルやディレクトリはありません -bash: 　export: command not found -bash: 　MANPATH=/usr/local/pgsql/man:: そのようなファイルやディレクトリはありません -bash: 　export: command not found [postgres@ ~]$ のようなエラーがはかれるようになりました。 どうか皆様のお力をお貸しください。
Windows版のPostgreSQL 8.3でデータベース名だけを変更する方法が知りたいです。 MySQLや他のデータベースも同じ方法で可能なのでしょうか？
PostgreSQLの削除手順を教えてください。 rpmコマンドで削除してもエラーになります。 ■環境 RedhatLinux 5.4 PostgreSQL8.4 ■実施手順 # rpm -qa |grep post postgresql-libs-8.1.11-1.el5_1.1 # rpm -e postgresql-libs-8.1.11-1.el5_1.1 エラー: 依存性の欠如: libpq.so.4 は (インストール済み)apr-util-1.2.7-7.el5.i386 に必要とされています # rpm -e apr-util-1.2.7-7.el5 postgresql-libs-8.1.11-1.el5_1.1 エラー: 依存性の欠如: libaprutil-1.so.0 は (インストール済み)httpd-2.2.3-22.el5.i386 に必要とされています libaprutil-1.so.0 は (インストール済み)mod_perl-2.0.4-6.el5.i386 に必要とされています libaprutil-1.so.0 は (インストール済み)subversion-1.4.2-4.el5.i386 に必要とされています # rpm -e --force postgresql-libs-8.1.11-1.el5_1.1 rpm: インストール、アップグレード、ソース削除、スペックファイル削除時のみ強制できます。 以上、よろしくお願いいたします。
PosgtreSQL8.3まではmsiが提供されており、Windowsにmsiexecコマンドでサイレントインストールが可能でしたが、8.4からはexe形式の提供でサイレントインストールができません。 8.4以降ではmsiは提供されないのでしょうか？ また8.4でのWindowsへのサイレントインストールの方法をご存じの方がいれば教えて頂ければと思います。
RDB（リレーショナルデータベース）とRDBMS（リレーショナルデータベースマネージメントシステム）の違いは何なのでしょうか？ RDBは単体ではデータを関連付けて保存することしかできなくて、そこから条件に合ったデータを抽出したり検索したりするのがRDBMSという事なのでしょうか？ 今まで同じ意味だと思っていましたが、 （例） （PostgreSQLをインストールするだけで、データを関連付けて保存できて、抽出も検索もできる） この認識は間違っているのでしょうか？ 基本的なことで申し訳ございませんが、よろしくお願いいたします。
LinuxのPostgres7.2からWindowsのPostgres8.3に DB移行を使用としています。DBは移行後もEUC_JPです。 【行った手順】 Linux ・pg_dump -F p DB > test.sql　 FTP ・FTPクライアントソフトで、ファイルをWindowsマシンに転送 Win ・createdb -U postgres -h localhost -E EUC_JP DB ・psql -U postgres -h localhost DB ・windb=# \i C:/test.sql LinuxからDumpし、Winのコマンドプロンプトでtest.sqlを実行すると 下記のエラーが発生します。 invaild byte sequence for eoncoding "EUC_JP":0x8de5" 元のファイルも、移行先のDBもEUC_JPなのに、どうしてこのような エラーが発生するのでしょうか？ どなたかお知恵をお貸し下さい。
現在当方、postgresql-8.2.11にてDBサーバを構築しております。 そろそろ、マシン自体も古くなってきたので載せ替えをしようと 試みているのですが、うまく行きません。。。 新しいマシンにはpostgresql-8.4.0をインストールしました。 旧サーバからpg_dumpallにて全データをダンプして新サーバへ リストアしたのですが、serverlogに下記のログが出てきて、 pgadmin3の様な接続ソフトから接続できません。 WARNING: nonstandard use of \\ in a string literal at character 70 HINT: Use the escape string syntax for backslashes, e.g., E'\\'. ERROR: column c.reltriggers does not exist at character 240 STATEMENT: SELECT c.oid, obj_description(c.oid), c.relhasoids as hasoids, n.nspname AS schemaname, c.relname AS tablename, pg_get_userbyid(c.relowner) AS tableowner, t.spcname AS "tablespace", c.relhasindex AS hasindexes, c.relhasrules AS hasrules, (c.reltriggers > 0) AS hastriggers, c.relacl, c.reltuples, ((select count(*) from pg_inherits where inhparent = c.oid) > 0) as inhtable FROM ((pg_class c LEFT JOIN pg_namespace n ON ((n.oid = c.relnamespace))) LEFT JOIN pg_tablespace t ON ((t.oid = c.reltablespace))) WHERE (c.relkind = 'r'::"char") リストア後は正常にデータベースもできていますし、テーブルの内容も 問題なくリストアされているようでした。 ダンプされたファイルも秀丸にて確認してみましたが問題ないようでした。 どなたか何か情報をお持ちであれば教えてください。 よろしくお願いいたします。
Debian 4.0で、 psql dbでdbたちあげるのはわかるのですが このあとどうすればいいのかわかりません（T_T) select * from とか構文はわかるんですが Debian 4.0のデータベースの操作はどうすればいいんでしょう？ 模範的　典型的コマンドをおしえてください 例えば データベースじゃなくて単なるlinuxだったら ls- l,pwd,uname,lsmodなどなどのコマンドみたいなものです。。。
こんにちは。かなり困っています、よろしくお願いします＞＜ PostgreSQL 7.2.8 を使用しています。 一つのユーザーで、二つのデータベースがあります。 それぞれ同じカラムを持つ同じ名前のテーブルがあります。 中のデータは違います。 db1 - tableT db2 - tableT 条件を付けて、db1のtableTのデータを db2のtableTへコピーするにはどのような方法がありますか？ 例えば select * from db1.tableT tbl1, db2.tableT tbl2 where tbl1.title = tbl2.title; のようにしてとりあえずselectで試してみましたがダメでした。 やはりスキーマとデータベースは違うんですね＞＜ ドットが認識されませんでした。 どなたか解決法をご存知の方、よろしくお願いします。
Loop文で検索条件を変えるSQL(plpgsql)を作成しようとしております。 具体的にはあるテーブルから、 select a,b from sample…(１) でデータを取得して、このa,bを用いて、 select * from sample2 where sarch = a and sarch2 = b…(２) 上記SQLを(１)の件数文LOOPさせる。 わからないことは、 ・(１)で取得した、aとbを（２）にどのように入れていくか。 ・(１)の件数をどのように取得してLOOPさせればよいか 以上2点です。 どなたかご教授いただけたらと思います。 参考URLも是非教えていただけたらと思います。 よろしくお願いいたします。
全角アルファベット（または数字）１文字を含んでいるものを問い合わせるときには、以下のようにLIKE句で指定しますが、 WHERE KOUJI_MEISYO LIKE '%Ａ%' 検索結果には上記の例の場合、全角アルファベット「Ａ」を含んでいるものがヒットしますが、中には全く含まれていないようなものがヒットする場合がありました。今回実際にあったものを載せておきますが、 （指名競争）大分都市計画道路県庁前古国府線道路測量設計業務委託 という文字列です。文字コードの並びで「Ａ」と認識してしまうような症状に陥っているのかなと思いますが、このようなケースに遭われた方はいますか？きちんと検索できるようにするにはどうすればよろしいでしょうか？ アドバイスやヒントを頂ければ幸いです。
PostgreSQL + PHP による Web アプリケーションを開発しています。 ある日付時点での各商品単価が取得できるSQLを考えていますが良い考えが浮かびません。 たとえば、以下のように2009年11月18日時点での価格一覧が取得できないでしょうか？ 牛丼（小）300円 牛丼（並）350円 牛丼（大）470円 サラダＡ　200円 サラダＢ　205円 サラダ盛合せ　498円 テーブル設計に問題があるのかもしれませんが... テーブル設計は以下のとおりです。 ブラウザによっては崩れて読みにくいかもしれません、ご容赦ください。 ■商品マスタ ┏━━━━┳━━━━━━━┳━━━━━━━┓ ┃商品ID　　┃　商品詳細ID　　┃　　　商品名　　　┃ ┃　　　　　 1┃　　　　　　　　 200┃牛丼（小）　　　　┃ ┃　　　　　 1┃　　　　　　　　 300┃牛丼（並）　　　　┃ ┃　　　　　 1┃　　　　　　　　 500┃牛丼（大）　　　　┃ ┃　　　　　 2┃　　　　　　　　　　 1┃サラダＡ　　　┃ ┃　　　　　 2┃　　　　　　　　　　 2┃サラダＢ　　　┃ ┃　　　　　 2┃　　　　　　　　　　 3┃サラダ盛合せ　　┃ ┗━━━━┻━━━━━━━┻━━━━━━━┛ ■商品価格 ┏━━━━┳━━━━━━━┳━━━━━━━━━┳━━━━━━┓ ┃商品ID　　┃　商品詳細ID　　┃　　　単価適用日　　　┃　　　単価　　┃ ┃　　　　　 1┃　　　　　　　　 200┃　　　　　　2009-10-01┃　　　　　　 300┃ ┃　　　　　 1┃　　　　　　　　 200┃　　　　　　2009-11-30┃　　　　　　 280┃ ┃　　　　　 1┃　　　　　　　　 200┃　　　　　　2010-02-05┃　　　　　　 320┃ ┃　　　　　 1┃　　　　　　　　 300┃　　　　　　2009-10-01┃　　　　　　 350┃ ┃　　　　　 1┃　　　　　　　　 300┃　　　　　　2009-11-20┃　　　　　　 370┃ ┃　　　　　 1┃　　　　　　　　 300┃　　　　　　2010-03-01┃　　　　　　 380┃ ┃　　　　　 1┃　　　　　　　　 500┃　　　　　　2009-09-30┃　　　　　　 500┃ ┃　　　　　 1┃　　　　　　　　 500┃　　　　　　2009-10-15┃　　　　　　 470┃ ┃　　　　　 2┃　　　　　　　　　　 1┃　　　　　　2009-10-01┃　　　　　　 180┃ ┃　　　　　 2┃　　　　　　　　　　 1┃　　　　　　2009-10-18┃　　　　　　 200┃ ┃　　　　　 2┃　　　　　　　　　　 2┃　　　　　　2009-09-05┃　　　　　　 210┃ ┃　　　　　 2┃　　　　　　　　　　 2┃　　　　　　2009-09-20┃　　　　　　 205┃ ┃　　　　　 2┃　　　　　　　　　　 2┃　　　　　　2010-02-02┃　　　　　　 170┃ ┃　　　　　 2┃　　　　　　　　　　 3┃　　　　　　2009-09-01┃　　　　　　 480┃ ┃　　　　　 2┃　　　　　　　　　　 3┃　　　　　　2009-09-15┃　　　　　　 500┃ ┃　　　　　 2┃　　　　　　　　　　 3┃　　　　　　2009-11-02┃　　　　　　 498┃ ┃　　　　　 2┃　　　　　　　　　　 3┃　　　　　　2010-01-20┃　　　　　　 470┃ ┗━━━━┻━━━━━━━┻━━━━━━━━━┻━━━━━━┛ 長文すみません、よろしくお願いいたします。
お世話になります。 sysbenchをPostgreSQLで使用したいと思いますが、 コンパイルエラーとなり先に進めません。 Solaris版は以下のサイトがありますが、Linux版のサイトが見つからず、手順がわからず困っています。 http://blogs.sun.com/jkshah/entry/sysbench_with_ … ■質問 Linuxでsysbenchを使用した実績がある方がいれば、上記のSolaris版のサイトのように、コンパイルから実行手順までを教えていただけますでしょうか。 ■環境 RedhatLinux 5.4 PostgreSQL 8.4 Sysbench-0.4.12 よろしくお願いします。
下記のような　nickname　テーブルがあります。 nickname | id | name | | 1 |あいうえお | | 2 |hogehoge | カラム「name」はユニークな値として設定してあります。 そこで、phpPgAdminを使用し下記のようなＳＱＬを発行するとニックネームが重複しているとエラーが発生してしまいます。 INSERT INTO nickname VALUES (3,'(2)'); INSERT INTO nickname VALUES (3,'(8)'); 「(2)」と「(8)」が同じ文字と判断されているようなのですが、なぜなのか教えて欲しいです。 また、これを回避する方法はあるのでしょうか？ 他にも「＠＠＠」と「．ＢＷ」も同じ文字として認識されてしまうようです。 ＳＱＬのバージョンはPostgreSQL 7.4.7を使用しております。 --追記-- 上記で説明している「(2)」と「(8)」ですが、○に囲まれた数字文字です。 なぜか、gooに投稿すると()半角括弧でかこまれた文字になってしまいます・・・
以下のようなDB内に顧客id(ユニーク)とhob1,hob2,hob3のようなカラムがありまして、hob1,hob2,hob3には任意で趣味を表す値が入っております。 【hoge_db】 id | hob1 | hob2 | hob3 1 | 1 | 2 | 3 2 | 2 | 3 | NULL 3 | 3 | NULL | NULL 3 | NULL | NULL | NULL ・・・ 【SELECTしたい値】 趣味1:1名 趣味2:2名 趣味3:3名 この各趣味を表す値に対する顧客数を求めたいのですが、3つのカラム全てに対してCOUNTをする方法が分かりません。。 どうかSQLにお強い方、お力を貸して頂けないでしょうか？
こんにちは。 現在某KD○I系列のレンタルサーバー屋で専用サーバーを借りていますが PostgreSQLのデータINSERTの速度がありえないぐらい遅く サーバー屋にさいさん文句を言っていますが これが仕様ですといってらちがあきません。 どれぐらい遅いか？というと1万行のデータをphpPgAdminからインサートするのに4分近くかかります。 ちなみにうちで適当に作ったVMでの実行だと10秒程度、あまりにらちあかなくて頭着てロリポップで試してみても35秒でした （まぁロリポップはMySQLですが） なおデータが複雑だから、、、というわけではなく以下のようなシンプルな構成にしても同様です。 testid varchar(10) testvalue varchar(10) ネットワークやハードウェアの障害かとも思いましたが phpMyAdminからMySQLに流し込む分には5秒程度で終わりますし 特定のサーバーの問題かと思い ほかのサーバーでも試してもらいましたが結果は同じでした。 かなり文句を言って向こうのサポートと喧嘩状態になりながら 最終的に向こうからの回答は以下の感じで　は？という感じです。 ********************（一部伏字） 検証結果にて判明致しましたが、仮想化環境ではディスク自体が 仮想化されている為か、INSERT の結果にはご指摘いただいたように非常に素早い結果を得ることが出来ました。これは、弊社にて別途ご提供中のVPS の＊＊＊＊＊で要したのは 5 秒前後という結果でございました。 しかしながら、仮想化ではない通常のサーバでは、Disk への書き込み部分が ボトルネックとなるようで、上位プランの筐体を利用しての動作検証でも、 数十秒程度の速度向上が得られた程度にて、著しい成果を得ることは、 出来ませんでした。 大変申し訳ございませんが、Postgre SQL の設定ではなくご提供しております オペレーティングシステムのファイルシステムを含めたデータ処理方法などに起因する動作結果となります為、弊社では本速度を仕様としてご案内させていただきます。 ******************** 1万件で4分が仕様だそうですので 50件インサートするのに約1秒かかり 現在構築中のアンケートシステムでは一人50問程度使うので 10人同時にアクセスしたら最大10秒待たされるわけで とても使い物になりません。 年間100万以上の予算を組んだサーバーでまさかロリポップにも劣る速度になるとはホント驚きです。 ルート権限もなくSSHでログインすることもできないのでログもろくに見られない状態なのですが 上記のような現象に心当たりがあったり解決方法をご存知の方おられませんでしょうか？ 本来であれば別のサーバー屋と契約したいところなのですが　OPENの日時考えると他のサーバー屋で再契約するには社内の稟議の問題もあり難しいです。 なんで客である自分がこんなこと調べないといけないんだーと かなり憤ってますが　そうはいってもサーバー屋が原因であれプロジェクト失敗すれば私の心証も悪くなってしまいますし なんとか避けたいです。 何か心当たりがあれば教えてください。 よろしくお願いします。
C#2005で、DataGridiew上にSELECTのクエリの実行結果を表示させたいのですが一連の記述の仕方がわかりません。 Npgsql2.0.4を使います。 C#2008なら、Linqのサンプルが見つかりましたが2005用のわかりやすいサンプルは見つけられませんでした。 ご存知の方教えてください。
例えば bigCategory,midleCategoryテーブルがあり、（今回はmiddleCategoryがbigCategoryときーでつながっている） create table bigCategory ( num integer not null primary key, name varchar(20) not null, ); insert into bigCategory values(0,'category_1'); insert into bigCategory valuers(1,'category_2'); create table middleCategory ( num integer not null primary key, name varchar(20) not null, bigkey integer not null ); insert into middleCategory values(0,'middle_1',0); insert into middleCategory values(1,'middle_2',1); bigCategoryの変更・削除をするときに、 1)middleCategoryがselectされている →　変更不可 2)middleCategoryがselectされていない →変更・削除可能 3)また、middleCategoryはselectされてなくて、 bigCategoryテーブルの変更行が他からselectされていたら、変更・削除不可 といった状況を実現したいのですが、可能なのでしょうか？ 候補として、おもうはGRANTかな、と思ったりはするのですが。 いろいろ考えはするのですが、解決策が思いつかず質問させてもらいました。 宜しくお願いします。
VC++ 2008からデータベースにアクセスしようとしていますが fe_sendauth : authentication type 5 not supported となってしまいました。 いろいろ探してpg_hba.confファイルの中のクライアント認証 を「md5」->「password」に変更したら 無事クライアント認証を行えるようになれたのですが md5のままで今回は行わなければならなくなってしまいました どなたかmd5のまま認証を行える方法をご存知の方いらっしゃいましたら 教えていただけないでしょうか？
環境：LINUX　Postgres8.4.0 デットロックを回避する為に、自動コミットをやめ、手動コミットに変更したいです。 psqlで\set AUTOCOMMIT offとすると確かに手動コミットになってしまいますが、 毎回設定するのは、手間がかかるのとシステム全体に反映されません。 システム全体を手動コミットに変更するには、どうしたら宜しいのでしょうか？
いつもお世話になっております。 社内にテスト環境を作成しようと、CentOS 5 にpostgres8.4.0をインストールした所、そのサーバ自体からは、dbの作成、tableの作成等sqlの発行は出来るのですが、同じネットワークのwindowsクライアントマシンからpgAdminIIIで接続しようとした所、左下に "データベースに接続...失敗しました"とエラーがでてしまいます。 サーバの設定 "pg_hba.conf"は host all all 192.168.0.0/16 trust を追加（クライアントはこのアドレス内です） "postgresql.conf"は listen_addresses = '*' port = 5432 の行を上記のように変更 CentOSのサーバにはping飛びます。 pgAdminの設定は、 アドレス（サーバIP）、記述（設定名）、ＤＢメンテナンス（DB名）、ユーザー名（postgres)、portはそのまま"5432" で接続しようとしています。 サーバ側のインストール手順は実際に行った手順を書いてましたが、 添付ファイルのような感じです。 どこがいけないか調べるにはどのようにすれば良いでしょうか。 よろしくお願いします。
vb.netにてプログラムを作成して使用しており、DBはpostgresqlをodbc接続にて使用しております。 ある端末で処理が極端に遅く、デバッグにて検証したところ、DB処理で時間がかかっていることがわかりました。 それに伴い同端末で別システムのoracleへのodbc接続も同じ現象となっている状況です。 この端末ではpostgresqlのodbcドライバの入れ替えを行ったことがあり、その頃から遅くなったようです。 また、別の全く同じ環境の端末では特に問題ない処理速度で稼働しております。 odbcドライバの入れ替えは何度か行っておりますが改善されません。 改善方法をご存じの方はおられますでしょうか？
テーブル結合検索、インデックス使えない原因を Aテーブルは200000件のデータがあり、Bテーブルは4000000件のデータがあります。 テーブルA（ヘッダ） A001　　NUMBER(10) NOT NULL, A002　　NUMBER(8) NOT NULL, A003　　CHARACTER(2) NOT NULL, ... PRIMARY KEY(A001) INDEX A1(A002, A003) テーブルB（明細） B001　　NUMBER(10) NOT NULL, B002　　NUMBER(3) NOT NULL, B003　　NUMBER(7) NOT NULL, ... PRIMARY KEY(B001,B002) INDEX A1(B001) SELECT A.A001, B.B003 FROM A, B WHERE A.A001 = B.B001 AND A.A002 >= 20090728 AND A.A002 <= 20090801 AND A.A003 = '01' 実行計画を見ると、Bテーブルのインデックスが使わなかった。 同じＳＱＬで、条件だけ変わると、Bテーブルのインデックスが使った。 SELECT A.A001, B.B003 FROM A, B WHERE A.A001 = B.B001 AND A.A002 >= 20090728 AND A.A002 <= 20090731 AND A.A003 = '01' 原因を知りたいです。 また、他のＨＰからテーブルの結合の説明がありました、 直積結合の回避 * 直積結合は、結合対象の2つのテーブルの全レコードの組み合わせを戻す処理 * SQLが複雑で、結合条件や絞込み条件に漏れがあると直積結合が選択されるかも tableA = 1000 件、 tableB = 2 万件 の直積結合 1,000 * 20,000 = 20,000,000 2000 万件処理されてしまう が、結果が正しいと気付かない事も。 データ量が増加すれば、致命的な性能劣化に 参考ＵＲＬ： http://www.slideshare.net/kwappa/20090107-postgr … 上記のこと教えていただきたいんです、お願いします。
こんにちわ、よろしくお願いします。 OS:WindowsXP PostgreSQL:8.4.0 DBの文字コードはUTF8で構築しています。 【現象】 文字型のカラムに￥を含んだ文字列を挿入しようとすると以下のエラーになります。 WARNING: nonstandard use of escape in a string literal at character 331 SQL実行中に以下のエラーが発生しました。 ERROR: invalid byte sequence for encoding "UTF8": 0x00 エラーとなるのは例えば「C:\temp\hoge.txt」といった文字列です。 ただし、 「C:/temp/hoge.txt」 「C:\\temp\\hoge.txt」 とした場合は正常に挿入が出来ます。 8.1.11で同じプログラムを動かしているときは問題なく動作していました。 PostgreSQLを最新の8.4.0にバージョンアップしたところ上記のエラーが発生するようになりました。 エンコードの問題かと思い Postgresql.confのclient_encodingを色々設定してみましたが、解決しませんでした。 解決法が見当たらず困っています。 よろしくお願い致します。
PostgreSQLで別データベースのテーブルを参照することはできますか？ 仮に以下のデータベースが２つあるとします CREATE DATABASE common_db ... CREATE DATABASE app1_db ... app1_db に接続した状態で common_db のテーブルを参照することはできますか？ 仮にcommon_dbに郵便番号テーブル postcodeがあるとします CREATE TABLE postcode ( postcode text, --郵便番号 pref_name text, -- 県名 　・・・ ) このpostcodeテーブルをapp1_dbに接続した状態で参照するには、どのような参照クエリになりますか？ ご教授の程よろしくお願います。 そもそもできないのでしょうか？
以下のようにデータが格納されている テーブルAがすでにあります。 　id　　in_time　　out_time 　1　　　　　　　　　11:10 　1　　　10:30 　1　　　　　　　　　10:15 　3　　　09:50 　1　　　09:30 　1　　　　　　　　　09:00 　1　　　08:30 　2　　　　　　　　　08:10 　1　　　　　　　　　07:50 　2　　　07:40 　1　　　07:30 ここでin_timeとout_timeの範囲が指定されたとき 範囲内でidごとにin_timeとout_timeがセットにな っているデータのみ抽出したいのです。 例えば in_time:7:00～10:20 out_time:8:00～11:30 と指定されたとき、検索結果を 　id　　in_time　　out_time 　1　　　　　　　　　10:15 　1　　　09:30 　1　　　　　　　　　09:00 　1　　　08:30 　2　　　　　　　　　08:10 　2　　　07:40 と表示したいのです。 プログラムで１レコードずつ処理するしかない と思っているのですが、SQLで上記のような結果 を取得する方法はあるのでしょうか。 環境は、 RHEL 5 postgesql 8.1.9 です。
RHEL4.6にPostgres8.1.11をインストールしています。 データ領域のファイルシステムはext3です。 データ領域の拡張が必要になった場合は、新しくext3の領域を用意しデータ領域を丸ごと移動しなければいけないでしょうか？ 以上、よろしくお願いします。
PostgreSQL8.2とJavaを使ったWebアプリケーションを構築しています。 pgAdminでサーバー状態＞ロック　で参照してみたところ、AccessShareLockというのが大量に発生していました。 マニュアルを参照してみたところ、 >AccessShareLock を除き，トランザクション内で獲得されたすべての ロックモードは，そのトランザクション実行の間維持されます． とあり、つまりAccessShareLockはトランザクションの間でも維持されないということだと思うのですが、どうも解放されてはいないようです。 これは通常の（つまり、更新しない）select文を発行したときに発生するロックだと思うのですが、いろいろ調べても、どうもこのAccessShareLockというのをどのくらい気にしたらいいのかがわかりません。 このロックが残っていると、どのようなときに困るでしょうか。 また、解放するためには通常のselectのあとでもcommit（またはrollback）をする必要があるということになるでしょうか。その際にはcommitとrollback、どちらがいいということはあるでしょうか。 ご存じのかたがいらっしゃいましたらご教示いただければと思います。よろしくお願いいたします。
いつもお世話になっております。 インターネットサーバー上のPHPから postgreSQLのデータベース内の テーブル名とシーケンス名のリストを SELECTを使ったSQL文にて取得したいのです。 テーブルリストは、 select * from pg_tables where not tablename like 'pg%' order by tablename; で取得できましたが、 シーケンス名のやり方がわかりません。 phppgadminでシーケンスの表が表示できるので、 phpでも出来ると思うのですがわかりません。 お知恵をおかしください。 hiroko
PostgreSQLで作ったデータベースを 別のFedoraのPCに入れたいのですが どのファイルを古いPCから新しいPCにコピーしたら いいでしょうか? よろしくお願いします。
失礼します。 実は最近、授業で必要だということでPostgreSQLの8.3.7を インストールしたのですが、1度目は上手く起動したのは いいのですが、2度目から、なぜかパスワードが全く合わず PostgreSQL Database Sever8.3に接続することができなくなりました。 （パスワードは外部に接続しないということなので 忘れないように「password」にするようにとのことだったので パスワードが間違っていることはまずありえません。） どこかのサイトでpg_hbaファイルの最後にあるmd5をtrustに 変えればできるとあり、やってみたのですが、上書き自体不可能 でした。 とりあえず、再インストールしようとして、1度削除し、 インストールしなおそうと思ったら、インストール画面で ユーザー名、パスワードを入れる欄があり、何度やっても、 「パスワード」が間違っています、と表示され、先に進めません。 （何も入力しなくても、passwordと入力しても先に進めません。） 教授やスタッフに聞いてみたのですが、日本語が読めないため 助けられないと結局、放置されています。 ただ、授業でどうしても必要らしくできることならば、 もう1度インストールして使用したいのですが、 何か手があるならば教えて頂きたく、 質問させて頂いたのですが・・・ もし、よろしければ、ご回答お願いします。
いつもお世話になっています。 TO_NUMBER実行時、結果はnumeric型で取得できると思うのですが、 その値をカラムに追加することはできるのでしょうか？ insert into number2 values((select numberStr,TO_NUMBER (numberStr,'000.000') from number),'aaa'); 実行すると、 副問い合わせは1列のみを返さなければなりませんというErrorが生じます。 なのでwhere句を追加しましたが、結果は同じです。 実行したsqlは、 create table number ( count integer not null primary key, numberStr varchar(20) not null ); create table number2 ( no numeric not null primary key, numberS varchar(30) not null); insert into number values(5,'555.55000'); insert into number2 values((select numberStr,TO_NUMBER (numberStr,'000.000') from number where count=5),'aaa'); です。 宜しくお願いします。
PostgreSQLの勉強したのですが、いい参考本かいいサイトを教えてください。 よろしくお願いします。
現在、 PostgreSQL 7.4.7 PHP Ver4.3.6 の環境を使用しており、 【php.ini】（以降設定ファイルと略）の設定は、 default_charset = Shift-Jis ・・・ mbstring.http_input = auto mbstring.http_output = SJIS mbstring.internal_encoding = SJIS mbstring.language = Japanese となっており、この設定で既にいくつかのデータベースが作成されて いるのが現状です。 このデータベース内の一つに日本語以外の中国語（Big5ではなくUnicodeで）を（設定ファイルを変更せずに）登録できるようにしたいと考え、データベース作成時に createdb -E UNICODE chinese-table と指定して作成しました。 次に（外注依頼の）外部プログラムから中国語で登録・修正・削除等を行ったところ、入出力に関しては正常に行われたのですが、 windows の コマンドプロンプトから telnet を使用して データベースを参照したところ、中国語ではなく＄％等を使用した 文字を使用しての表示（文字化け）になってしまいます。 いろいろサイト等で原因を探してみたのですが、encoding が原因 なのではないかというところまではたどり着いたのですが、どういたらいいのかわからない為、どうかご教授の程よろしくお願いいたします。 最後に、返信に少し時間がかかると思うのですが、最後までご指導して いただければと思いますので、よろしくお願いいたします。
いつもお世話になっております。 WinXPPro上で、PostgreSQL8.3を動かしています。 タスクマネージャによるバックアップ処理を行うためにバッチ ファイルを作成しました。 ホスト名やDB名などはバッチコマンド内の変数に記述しているの ですが、ホスト名をIPアドレスではなく、マシン名に変えると、pg_dumpやvacuumdbにおいてパスワードを聞かれるようになりました。 なぜ、マシン名でホスト指定を行うとパスワードを聞かれるので しょうか？逆に言えば、なぜIPアドレスによるホスト指定の場合は、 ユーザー名だけで認証OKとなるのでしょうか？ よろしくお願いします。
postgreSQLで更新後のデータを取得したい。 初めて質問させていただきます。 postgreSQLでupdateした後、更新後のデータをselectで取得したいのですが、 トランザクションが完了するまでにselect文が発行されているみたいで、更新前のデータを取得してしまいます。 それぞれ、違うファイルから投げられているので、同じトランザクションにすることはできません。 何かいい方法があればご教授お願いします。 a.phpで下記のSQLを発行 update test_tbl set test1 = 'aaa' where test2 = 'bbb' a.phpが走っている間に、下記のb.phpが実行される。 select test1 from test_tbl 環境 php5 postgres8.1
ページ名 ｜ ユーザID mypage | 2 other | 2 other | 4 mypage | 2 index | -1 index | -1 mypage | 2 other | 3 other | 2 mypage | 2 index | -1 index | 3 上記のテーブルのように、ページ名とユーザIDが多対多のような関係になっている時に、 各ページにアクセスしてきたユニークユーザ数を取得したいと考えております。 上記の例ですと、求めたい答えは下記となります。 mypage:1　アクセスしたユーザは、2だけなので、ユニーク数は1 index:2　アクセスしたユーザは、-1と3なので、ユニーク数は2 other:3　アクセスしたユーザは、2と3と4なので、ユニーク数は3 group byで分けて集計すれば良いと単純に考えたのですが、 selectの対象は、group by　の対象で無ければならないみたく、 どのように集計すれば良いのか、とても困っております。 大変申し訳ありませんが、ご教授願えませんでしょうか？ 宜しくお願い申し上げます。
OSはWindows Server 2003 for Small Business Serverで、　PosstgreSQL 8.2です。 ブラウザーで動くシステムですが、完成していてずっと動いていたものが、ある日突然起動してパスワードが通るとすぐにエラーメッセージが出て何もできなくなりました。完成してから問題が起きるまで、システムを利用し、データーベース入力をする人はいても、プログラムに手を加えることはありませんでした。なのに、突然エラーが起るようになったらしいのです。 エラーメッセージを下に表示しますが、このようなメッセージの経験のあるかたがいらっしゃったら、どういうことを言っているのか教えていただけませんか？ 壊れてしまったのか、手を加えられた（人為的に）可能性があるのか？ 直せる可能性はあるのか？せめてデーターだけでも救えないのか？ そんなことが少しでもわかることができれば本当に助かります。 エクセルにデーターを取り込もうとしましたが、そもそもODBCに接続ができないようで一たん断念しました。 よろしくお願いします。 エラーメッセージは： Warning: pg_connect() [function.pg-connect]: Unable to connect to PostgreSQL server: could not connect to server: Connection refused (0x0000274D/10061) Is the server running on host "localhost" and accepting TCP/IP connections on port xxxx in 以上です。よろしくお願いします。
シンプルな質問ですが、 データベース一覧を確認する方法を教えてください。 以外にサイトに載っておりません。 宜しくお願いします。
Postgresqlの運用をしています。 定期的にバキュームフルをしようと思うのですが、バキュームフルを実行しているときにDBへの操作(select、insert、update、delete)は可能でしょうか？ リスクを考えて実行しなければいけないようでしたら、参考になるようなサイトを教えていただけないでしょうか。 よろしくお願いします。m(_ _)m
現在C言語でPostgeSQLを扱えるようにしているんですが、上手くできません。 プログラムはこんな感じで作っているんですが、 res=PQexec(con,SQL文１); PQclear(res); res=PQexec(con,SQL文２); PQclear(res); res=PQexec(con,SQL文３); PQclear(res); この時、SQL文１しか実行されません。最初のPQexecをコメントアウト するとSQL文２しか実行されません。 目標としてはSQL文で順番に問い合わせするようにしたいんですが、 何かいい方法があれば教えてください。よろしくお願いします。
はじめまして、ｓｑｌとかｐｈｐを学んでいる大学生です。 ｓｑｌに画像を入れて、表の中に画像を表示させたいのですが、ｓｑｌに画像を入れることはできるのでしょうか？それはどの様なプログラムでできるのでしょうか？ また、それを表示させるには、どのようにすればいいのでしょうか。 質問が多く申し訳ございません。よろしくおねがいします。
タイトルのままなのですが、 csvファイルのデータを既存のデータと比較して重複なしで登録する方法を教えて下さい。 重複というのは、商品IDみたいなものです。
C♯、PostgresSQL 8.3.7環境です。 クライアント側からDBへの接続が出来なくて困っています。 「Npgsql2.0.5-bin-ms.net」をダウンロードし、VisualStudioより Npgsql.dllの参照を追加しました。 DB接続を行うクラスにて、 using System.Data; using Npgsql; を記述、下記のようにコネクションを開いて閉じるだけのコードを 書いてみました。 //接続のテスト NpgsqlConnection conn = new NpgsqlConnection("Server=xxx.xxx.xx.xx;Port=5432;User Id=xxxx;Password=xxxx;Database=xxxx;"); conn.Open(); conn.Close(); しかし、conn.Openの段階で、添付画像のエラーが出ます。 (IOException) サーバ側の設定はノータッチなのですが、担当者はlisten_addresses = '*' は しているとのことでした。 修正、確認すべき箇所をご教授いただけないでしょうか。 宜しくお願いします。
お世話になります。 vb.net+PostgreSQLでプログラムを作成しております。 接続は「Npgsql.dll」を使用してます。 そこで、プログラムよりファンクションをコールし、 引数で渡した値に一致する結果の取得をしたいのですが、 パターン(2)の様に引数の記述を行うと結果の取得ができません。 どなたか引数で指定した値に一致した結果を取得する方法を お教え頂ければと思います。 【パターン(1)】正常に結果の取得ができた CREATE OR REPLACE FUNCTION pr_select_ok() RETURNS SETOF refcursor AS $BODY$declare cur refcursor; 条件 numeric; begin 条件 := 999; open cur for select 列01, 列02, 列03, 列04 from テーブル where 列01 = 条件 ; return next cur; return; end$BODY$ LANGUAGE 'plpgsql' VOLATILE 【パターン(2)】結果の取得ができない CREATE OR REPLACE FUNCTION pr_select_ok(条件 numeric) RETURNS SETOF refcursor AS $BODY$declare cur refcursor; begin open cur for select 列01, 列02, 列03, 列04 from テーブル where 列01 = 条件 ; return next cur; return; end$BODY$ LANGUAGE 'plpgsql' VOLATILE 以上、よろしくお願い致します。
ポートを変更する必要があり、postgresql.confを port=5433 と編集し再起動したのですが、 netstatコマンドで確認したところ、変わらず5432で動いています。 他に何か必要な作業があるのでしょうか？ 環境はCentOS5.2+Postgresql8.3です。
閲覧ありがとうございます． 現在SQLでデータベースの勉強をしているのですが，existsを用いて商演算を行おうとしてわからない箇所が出てきたので，その点に関しての質問をさせて頂きます． 例として，Ａ，Ｂと名付けた２つのテーブルを最初に用意します． [テーブル１（名前：机１）] | 番号 |氏名|年齢|　好物　| --------------------------- | １２ | あ | １ | りんご | | ２３ | い | １ | すいか | | ２３ | い | １ | りんご | | ４５ | え | ３ | すいか | | ４５ | え | ３ | りんご | [テーブル２（名前：机２）] |　好物　| ---------- | りんご | | すいか | この机１を机２で割ることで，この要素を含む氏名を取り出したいと考えて，以下のようなＳＱＬ文を実行しました． select 氏名 from 机１ A where exists( select * from 机２ B where A.好物 = B.好物); [求めている結果表示] | 番号 |氏名| ------------- | ２３ | い | | ４５ | え | [実際に表示された結果] | 番号 |氏名| ------------- | １２ | あ | | ２３ | い | | ２３ | い | | ４５ | え | | ４５ | え | 実行すると (1)氏名が重複で表示されてしまう (2)「りんご」のみ好物の「あ」も表示されてしまう という問題が発生してしまい，色々と調べて考えたものの，結局分からなかったので，今に至ります． 長文・駄文すみませんでした． まだSQLを学び初めて少ししか経っていないので，全く違うことをしていたらすみません．よろしければ，問題解決へのアドバイスをお願いします．
色々試行錯誤していますが、データの出力が正しくできません。 本日、別の質問を記載したのですが、上手く質問がまとまっていなかったために再度投稿したします。 統括会社(テーブルA)ごとにお店の評価を出力したいと思っています。 ただ、上手くできなくて困っています。 ======================== 行いたいこと ======================== テーブルは３つあります。 テーブルAは統括会社のテーブル、Bは店情報、Cはお店の評価結果です。 行いたいのは、統括会社のグループコードごとに、統括会社傘下のお店の評価結果の合計を表示することです。 その際、期間(登録日)を指定して合計値を表示するといったことを行いたいです。 ただ、評価結果の合計を算出する際に、お店(店名コード)ごとに過去の評価結果に”○”がついた項目CDは、重複しない形で計算をしたいです。 例） 項目CD”1-1-1”で店名コード"AAA"の評価結果が"○"が2つ、店名コード"BBB"の評価結果が"○"が零(0)、店名コード"CCC"が"○"4つの場合 評価結果２として算出 ================= テーブル ================= ■テーブルA →統括会社のテーブルです グループコード グループ名 ------------------------------------- AAAA 　　　　　ああああ BBBB 　　　　　いいいい CCCC 　　　　　うううう ■テーブルC →店情報のテーブルです 店名コード グループコード ------------------------------------- ららら AAAA せせせ BBBB ししし CCCC ■テーブルB →店の評価結果をもつテーブルです 項目CD 　評価結果　店名コード 　　登録日 ------------------------------------- 1-1-1　　 ○ 　　　　ららら 　　2000-10-10 1-1-1 　　○ 　　　　ららら 　　2007-12-10 1-1-1 　　× 　　　　せせせ　　 2006-12-16 1-1-1 　　○ 　　　　ししし　　 2009-04-16 1-2-1 　　○ 　　　　ららら　　 2004-10-16 1-2-1 　　○ 　　　　せせせ　　 2007-01-16 1-2-1 　　○ 　　　　ししし　　 2003-12-14 1-2-1 　　〇 　　　　ししし　　 2007-12-15 ============== SQL ============== SQLは以下の通りです。 select テーブルA.グループコード,count(rtable.評価結果)、 from (select 店名コード,項目CD,評価結果,登録日 from テーブルC group by 店名コード,項目CD,評価結果,登録日 order by 店名コード,項目CD,評価結果,登録日) as rtable,テーブルA,テーブルB where テーブルA.グループコード = テーブルB.グループコード and テーブルB.店名コード = rtable.店名コード rtable.評価結果 = '○' and rtable.登録日 between '2000-01-01' and '2009-01-01' and テーブルA.グループコード ='AAAA' =============== 結果 =============== ■理想の結果(店名コードと評価結果が同じ場合は合計しない) グループコード 評価結果(合計) ---------------------------- AAAA 　　　　　　5 ■現在の結果(店名コードと評価結果が同じ場合も合計してしまう) グループ 評価結果（合計） ---------------------------- AAAA 　　　　　　　7 何卒よろしくお願いいたします。
はじめまして、現在Postgres8.3を利用して開発を行っています。 以下のテーブルがあります。 No　　グループ ------------------------------------- 1 　　　AAAA 2 　　　BBBB 3 　　　CCCC ■テーブルB ID　　項目CD　評価結果 グループ 登録日 ------------------------------------- A　　　1-1-1　　　○ AAAA 2000-10-10 A　　　1-1-1　　　○ AAAA 2007-12-10 B　　　1-1-1　　　× AAAA 2006-12-16 C　　　1-1-1　　　○ AAAA 2009-04-16 A　　　1-2-1　　　○ AAAA 2004-10-16 A　　　1-2-1　　　○ AAAA 2007-01-16 B　　　1-2-1　　　○ AAAA 2003-12-14 C　　　1-2-1　　　〇 AAAA 2007-12-15 評価結果は、○と×があり、項目CDごとに集計を行い、項目CDが同じ場合は、○がいつくあっても1とみなして計算するということをおこないたいです。 登録日を指定して、抽出したいのですが、 登録日を 条件に含めると、全部計算されてしまいます。 select count(評価結果) from (select ID,項目CD,評価結果 from テーブルB group by ID,項目CD,評価結果 order by ID,項目CD,評価結果) as rtable where rtable.評価結果 = '○' rtable.登録日 　between '2000-01-01' and '2009-01-01' ■理想の結果 グループ　合計　 -------------- AAAA 　　5 　　 ■現在の結果 グループ　合計　 -------------- AAAA 　　7 　　 どうしても出来なくって、困っています。 よろしくお願いいたします！！
ID　　項目CD　　評価結果 ------------------------- A　　　1-1-1　　　○ A　　　1-1-1　　　○ B　　　1-1-1　　　× C　　　1-1-1　　　○ A　　　1-2-1　　　○ A　　　1-2-1　　　○　 B　　　1-2-1　　　○ C　　　1-2-1　　　〇 上記のテーブルがあります 評価結果は、○と×があり、項目CDごとに集計を行い、項目CDが同じ場合は、○がいつくあっても1とみなして計算するということをおこないたいです 理想SELECT結果 ID　　合計　 -------------- A　　　2　　　(1-1-1で○が2つあるが、1つとして計算) B　　　1　　　 C　　　2　　　　 SELECT ID,SUM(評価結果)　FROM　TABLE GROUP BY ID でIDと合計までは出せました 現在のSELECT結果 ID　　合計　 -------------- A　　　4　　　(すべての○の合計を出力) B　　　1　　　 C　　　2　　 項目CDが同じ場合"○"を1つとして集計するにはどうすればいいのでしょか？
Postgresqlのポイントインタイムリカバリとアーカイブログについての質問です。 バックアップは夜間に 1.バックアップ開始宣言　select pg_start_backup('bkup01'); 2.tarでベースのバックアップ 3.バックアップ終了宣言　select pg_stop_backup(); を実施後、日中障害が発生した場合は、障害前の時点に復旧しようと考えています。 アーカイブログを$PGDATA/data/postgres.conf内で別パーティションに保存するように設定しています。 上記の方法でポイントインタイムリカバリ実装可能でしょうか？ 現在、設定後しばらく動きを見ているのですがアーカイブログが保存されているディレクトリ内のファイルの更新が日に1回程度なので。アーカイブログの書き出しは1日1回程度なのでしょうか？変更可能なのでしたら教えていただけないでしょうか？ 以上、よろしくお願いします。m(_ _)m
かけだしのプログラマーです。 PostgreSQLで全文検索や類義語検索を行います。 現在、Ludiaの使用を検討していますが、Ludiaには類義語検索機能はないと、 サイトに書いてありました。 また、「PostgreSQL、類義語」で検索してみたところ、dict_xsyn（拡張類義語辞書） というものがひっかかりましたが、情報が少なすぎてコレがいまいち何なのか分りません。 類義語検索を行うのに、何か効率の良い方法があるかご存知でしょうか？ もしくは、原始的にselect文にORを組み合わせて発行するしかないのでしょうか？ 御助言よろしくお願いします。 ＜条件＞ 　PostgreSQL 8.3 　類義語検索 　EUC-JP 　全文検索機能，類義語検索機能
一つのテーブルに smallint型のkey1,key2,key3を持つテーブルのデータを これを key1+key2+key3のinteger形式のkeyAとして 他のテーブルに登録したり呼び出したりしたいのですが 可能でしょうか？ 例えば key1=123,key2=45,key3=67　というデータを keyA=1234567 というkeyで管理したいのです。 Cにおける構造体のunionの様な呼び出しがしたいのですが・・・
PostgreSQLのデータベースでテーブルから、 "１件のレコードが見つかった時点で、他のレコードを検索するのをやめる" という事はSQLでできるのでしょうか？ 【テーブル名　Fruit　】 |　id　|　option　|　name　| 　1　　　　2　　　　　りんご 　2　　　　1　　　　　みかん 　3　　　　1　　　　　メロン 　4　　　　1　　　　　バナナ 　5　　　　4　　　　　いちご 上記のようなテーブルから、optionが1のレコードを検索する時、 どのレコードでもいいので、1件見つけた時点で他にも該当のレコードがあるかという検索の処理をしない。 という事はできるのでしょうか？ 出来るのであれば、膨大な数のレコードがある場合、検索の時間が減るのでは無いかと思ったのですが・・・ 現在は下記のSQLのように、OFFSETとLIMITを使用して１件のレコードを取得しています。 SELECT 　　　　　* FROM 　　　　　Fruit WHERE 　　　　　option=1 OFFSET　0 LIMIT　1 このやり方であっているのでしょうか？ または他の仕方があるのでしょうか？ 教えていただきたいです。 宜しくお願いします。
OSはCentOS5.2を使用しております。 データベースクラスタの格納先を変更したく PostgreSQLをrpmでインストールした後に #su postgers $vi ~/.bash_profile でPGDATAを編集後、環境変数へ反映。 $/usr/bin/initdb -D /usr/local/pgsql で初期化処理を実施後 /etc/rc.d/init.d/postgresql start と起動したところ、イニシャル処理も実施され デフォルトの/var/lib/pgsql/dataが作成されて しまいこちらの領域を使用して起動します。 どうすれば、ディレクトリを変更できるのでしょうか。 よろしくお願い致します。
グループテーブル、メンバーテーブル、趣味テーブルの3つのテーブルがあります。 あるメンバーはあるグループに属しており、趣味を1つ持っています。 以下がそのSQLです。 CREATE TABLE groups ( g_id int primary key ); CREATE TABLE members ( m_id int primary key , g_id int , h_id int ); CREATE TABLE hobbies ( h_id int primary key, h_name text ); INSERT INTO groups VALUES ( 1 ); INSERT INTO groups VALUES ( 2 ); INSERT INTO groups VALUES ( 3 ); INSERT INTO members VALUES ( 1, 1, 1); INSERT INTO members VALUES ( 2, 1, 3); INSERT INTO members VALUES ( 3, 1, 4); INSERT INTO members VALUES ( 4, 1, 4); INSERT INTO members VALUES ( 5, 2, 1); INSERT INTO members VALUES ( 6, 2, 2); INSERT INTO members VALUES ( 7, 2, 3); INSERT INTO members VALUES ( 8, 3, 2); INSERT INTO members VALUES ( 9, 3, 3); INSERT INTO members VALUES ( 10, 3, 4); INSERT INTO hobbies VALUES ( 1, 'sports' ); INSERT INTO hobbies VALUES ( 2, 'music' ); INSERT INTO hobbies VALUES ( 3, 'book' ); INSERT INTO hobbies VALUES ( 4, 'drive' ); 指定された趣味を持つメンバーがいるグループを抽出するにはどうすればいいでしょうか？ 例えば、「読書が趣味なメンバーとドライブが趣味なメンバーがいるグループは？」「グループ1とグループ3」のような感じです。 一応自分で考えてみたのが、以下ですが、これだと趣味の指定が増減すると大きくSQLが変わってしまいます。 もっといいやり方はないでしょうか？ 私はPostgreSQL8を使ってますが、汎用的なSQLであれば、そっちの方がいいです。 SELECT distinct m.g_id FROM members m join hobbies h ON m.h_id = h.h_id where h.h_name = 'drive' INTERSECT SELECT distinct m.g_id FROM members m join hobbies h ON m.h_id = h.h_id where h.h_name = 'book';
社員への備品貸し出しの管理システムを構築しているのですが、 誰に何を貸し出しているかを把握するテーブルはどのように作成すればいいでしょうか？ 貸し出しテーブルと備品テーブルみたいなのがあり、 備品テーブルは備品の個数だけレコードがあるわけではなくて、 1種類につき1レコード、どんな備品なのかを管理するだけのテーブルを考えています。 社員が1種類しか備品を借りないのであれば、 貸し出しテーブル : 社員番号, 備品番号 備品テーブル : 備品番号, 詳細 みたいにすればOKだと思いますが、複数借りた場合だと貸し出しテーブルが1レコードでは管理ができなくなります。 貸し出しテーブルには上記以外にもカラムを複数入れるので、 1レコードで社員番号から借りている備品を抽出したいのですが、 上手くやる方法はないでしょうか？ （上記テーブルを変えたり、別のテーブルを作成するのはOKです。） よろしくご教示願います。
明後日までに人にサイトを見せる必要(面接です；)が急遽できてしまったので 急いで「Ribbon Networ」のレンタルサーバを借りました。 ですが…いままでlocalhostでしか接続したことがないので接続方法がわかりません；ｗ； 設定可能なPostgreSQLの ホスト・データベース名・ユーザ名・接続パスワード を教えてもらい直接JDBCで接続しようとすると 「サーバは閉じられています」とのこと レンタルサーバのサイトでは利用について ・PHP や Perl などの Postgres 用ライブラリなどを用いて操作を行ってください。 ・Ribbon Network 内のサーバからのみデータベースサーバへ接続できます と記載されていました。 （ちなみにPHP・Perlとも扱ったことないです） また、レンタルサーバーの利用可能なバージョンが8.3.1なのに対し、私が利用してるのは8.3.7です。 これも関係してるのでしょうか？ 羅列してしまったので質問内容まとめ 1.レンタルサーバーへの一般的な接続方法 2.PHP・Perlを必ず使わないと接続できないか (できればJAVA経由で接続したいです) 3.バージョンは一致しないと無理か かなり曖昧な質問で申し訳ありませんが なかなか自分で調べても答えを導くことができませんでした どうかお力を貸してください＞人＜！
WindowsにPostgreSQL8.3をインストールしたのですが、デフォルトユーザーpostgresのパスワードを変更する方法がわかりません。 SQLで行うのでしょうか？それとも何かツールがあるのでしょうか？
PostgreSQL8.3を使っています。 インストールしているCドライブの空き容量が少ないので、PostgreSQLのディレクトリ全てをDドライブに持っていき、動作させたいのですが可能でしょうか。 データだけでもDドライブにして、通常どおり動作させたいです。 できればわずかな設定変更で済めば嬉しいです。
PostgreSQL8.3系を使っています。 PostgreSQLのserial型を使って、連番を意識せずINSERTして登録しているのですが、直前に登録した連番(serial)が知りたいことがありまして、 簡単に取得する方法がわかりません。 気になる点ですが書きこんだ後、他から書き込みがあった場合の直前は他のデータになると思うので、書き込んだ直後のserialフィールドのmax値はあてにならないと考えますが、詳しい方教えてください。 書きこんだ直後についでに何か取得できる（書きこんだときのserial値がわかる）方法はあるのでしょうか？
いつもお世話になっております。 WEB画面から入力された項目を対象にPostgresに検索しに行っているのですが、シングルクォート(')が入っていた場合、エラーになってしまいました。 JavaからSQLを生成し、Postgresに接続しているのですが、シングルクォートを検索させるにはどうするのが良いでしょうか。 またSQLに記述できない文字は、シングルクォートのほかに何かありますでしょうか。 よろしくお願いします。
タイトルのような現象が起こってしまっているのですが、対処方法はありますでしょうか？ 行数が増えてもcountの速度が落ちないようにしたいのです。 CREATE INDEX などは設定してあります。 ご教示お願いいたします。
val | num ----------- 9984 | 1 1234 | 1 9876 | 1 4567 | 1 9984 | 1 1234 | 1 9984 | 1 以上のようなテーブルで SELECT COUNT(*) FROM table_name WHERE val = 9984 SELECT COUNT(*) FROM table_name WHERE val = 1234 SELECT COUNT(*) FROM table_name WHERE val = 9876 SELECT COUNT(*) FROM table_name WHERE val = 4567 のように４つ実行することなく１度に 9984 => 3 1234 => 2 9876 => 1 4567 => 1 という結果を得たいのですが方法はありますでしょうか？ ご教示お願いいたします。
下記の事を実現するSQL文がどうしても分からず困り果てています。。。。 ご回答の程お願い致します。 テストテーブルにはコード、枝番、年月日の3種類のデータがあります。 テストテーブルはコードと枝番を主キーとします。 1つのコードに対して、重複しない枝番が複数登録可能となっています。 取得するデータはコード、枝番、年月日の3種類のデータを取得し、同じコードの中で年月日が一番若いデータのみ取得したいです。 同じような質問で http://okwave.jp/qa4089797.html と言うURLの回答を参考に SELECT コード , 枝番 , 年月日 FROM テストテーブル where (コード , 年月日) in (SELECT コード , MIN(年月日) FROM テストテーブル GROUP BY コード ); というSQL文を考えたのですが、 コードは同じで枝番は違うが年月日が同じデータがあると 望んでいない結果にならず、困り果てています・・・・ ■テストテーブルのデータ コード │ 枝番 │ 年月日 ----------------------------- 1 │ 1 │ 2009-01-01 1 │ 2 │ 2009-01-03 2 │ 1 │ 2009-02-15 2 │ 2 │ 2009-02-10 2 │ 3 │ 2009-02-20 3 │ 1 │ 2009-03-15 3 │ 2 │ 2009-03-10 3 │ 3 │ 2009-03-05 3 │ 4 │ 2009-03-01 ↓↓↓ ■望んでいる取得結果 コード │ 枝番 │ 年月日 ----------------------------- 1 │ 1 │ 2009-01-01 2 │ 2 │ 2009-02-10 3 │ 4 │ 2009-03-01
WindowsXP x64にPostgreSQL8.3.7を入れる予定ですが、 ODBCも必要になると思いますが、どこからダウンロードすることができますか？ 他のPCに8.2.4が入っていて、データベースに文字コードがユニコードで保存しているのですが、これをSJISにして、最新の8.3.7のPCに入れることは可能でしょうか？ pg_dump？で引数の方法など知りたいです。
PostgreSQL の 7 から8 へマイグレーション作業をしている者です。 int型で not null制約のあるカラム「id」 の値から、''(空)であることを判定する時、 version7 では、 $sql = "select * from tbl_name where id <> ''"; のSQL文で動いていたようですが、 version8 では、 型の扱いが厳しくなった訳か、syntax error となります。 この場合version8 では、 $sql = "select * from tbl_name where id <> 0"; が、 ''(空)であることを判定するSQL文と考えてよいでしょうか？ ご教授よろしくお願いします。
現在 Oracle → PostgreSQL に移行しようと考えています。 Oracleからレコード取得操作を主に KeySQL というソフトを使って いますが、KeySQL は PostgreSQL では動作しないため、 PostgreSQL で使える「KeySQLライク」のものを探しています。 どなたか有用なソフトをご紹介いただけませんか。 ※主にKeySQLを使用している目的は、SQL文法をあまり知らなくても 　レコードの取得などが行えるためですので、それを満たしたツール 　があるといいのですが。
ただいまSQLの勉強をしています。 タイトルどおりなのですが、ASで指定した項目名をGROUP BYやORDER BYで使用する方法はあるのでしょうか？ CASE文を使用したこちらのSQL文↓で、SELECT文、GROUP BY句、ORDER BY句の中に重複する部分が多く出てしまうのでどうにかすっきりさせたいと思い、独自に調べたり色々と試したのですがわからず、質問させていただきました。 お分かりになる方、いらっしゃいましたらご助言どうぞよろしくお願いいたします。 <SQL文> SELECT CASE WHEN trancd % 3 = 1 THEN '購入番号(1,4,7,…)の集計' WHEN trancd % 3 = 2 THEN '購入番号(2,5,8,…)の集計' ELSE '購入番号(3,6,9,…)の集計' END AS グループ名称 , sum(suryo) AS 数量合計 FROM tran GROUP BY CASE WHEN trancd % 3 = 1 THEN '購入番号(1,4,7,…)の集計' WHEN trancd % 3 = 2 THEN '購入番号(2,5,8,…)の集計' ELSE '購入番号(3,6,9,…)の集計' END ORDER BY CASE WHEN trancd % 3 = 1 THEN '購入番号(1,4,7,…)の集計' WHEN trancd % 3 = 2 THEN '購入番号(2,5,8,…)の集計' ELSE '購入番号(3,6,9,…)の集計' END;
ただいま、PostgreSQL、VB6.0を使用して開発中です。 日々レコードが追加される、A_DBにあるAテーブルのデータを バックアップとして、まったく構造の同じ、B_DBにあるBテーブルに差分をINSERTするようにしたいのですが、どのようにコードを記述すればよろしいでしょうか？ イメージ的には下記に近いのですが… http://ziddy.japan.zdnet.com/qa691870.html http://ziddy.japan.zdnet.com/qa1099610.html 初心者なので、不十分なところがあるかも知れませんが、ご回答よろしくお願いします。
こんにちは。 Linux+PostgreSQLでpg_hba.confの設定がよく分からず困っています。 リモートからは使用せず、localhostのみの接続を許可したいのですが、 どのように設定すればいいのでしょうか？ CentOS5+PostgreSQL8.1.9です。
ただいま、postgresを使用して開発中です。 そこで、下記のようなSQL文を書いているのですが、 できれば、多次元配列の「b.code」の記述順で表示したいのですが、 下記のSQL文を実行すると「a.code」の記述順で表示されます。 どのようなSQL文に変更すればよろしいでしょうか？ SQL: select a.name as aname , b.name as bname from atable a, btable b where a.code = any(b.code[1:1]); atable code | neme -------------- 2 | AAA 1 | BBB btable code | name ---------------------- {{1,2},{3,0}} | DDD 『現在の結果』 aname bname --------------- AAA | DDD BBB | DDD 『得たい結果』 aname bname --------------- BBB | DDD AAA | DDD 長くなりましたが、よろしくお願いします。
Ver8.3.3 現行のテーブルの値を、別テーブルへ移行したいのですが、 コーディングのしかたが良く解りません。 ｅｘ） Ａテーブル ＩＤ　 ビット合計１ ビット合計２ Ｂテーブル ＩＤ　 ビット合計データ種別 ビット合計 １レコードの物を、２レコードに変換する具合です。 サンプル等が記載されているサイト等を教えて頂ければ幸いです。 宜しくお願い致します。
こんにちは。 postgresでレコード数を意識した操作では、SELECT句のlimitが 思いつくのですが、DBのテーブルに登録できる最大行数を設定し、 最大行数を超えたらINSERTが強制的にできないようにする方法 に悩んでいますので、教えて下さい。 環境はredhat9+apache2+tomcat+Jsp+Java1.4+postgres7.2で開発・ 保守をしています。 既にWebで公開されており、既に登録された企業の中から好きな企業 に会員として登録し以降その企業のサービスを受けるシステムです。 営業でのプレゼン兼貸出し用（デモ版）としてノートPCに構築する ことになりました。 「デモ版」と言うことで、機能制限をかける方法として、 ・登録できるレコード数を制限する と方針になりました。 他に、Javaソースに制限機能を追加、.httpaccsessによる認証を 検討しましたが、これに決まった次第です。 すみませんが、ご教授の程お願いします。
こんにちは。 PostgreSQLのマニュアルを見ますと。次のような文の組み合わせはデットロックになる可能性があるとされてます。 プロセス１ UPDATE accounts SET balance = balance + 100.00 WHERE acctnum = 22222; UPDATE accounts SET balance = balance - 100.00 WHERE acctnum = 11111; プロセス２ UPDATE accounts SET balance = balance - 100.00 WHERE acctnum = 11111; UPDATE accounts SET balance = balance + 100.00 WHERE acctnum = 22222; #PostgreSQL8.1.5のマニュアルの12.3.3を参照しています。 #http://www.postgresql.jp/document/pg815doc/html/ … こういった場合の回避方法なのですが、 プロセス１ SELECT * FROM accounts WHERE acctnum=11111 AND acctnum = 22222 FOR UPDATE; UPDATE accounts SET balance = balance + 100.00 WHERE acctnum = 22222; UPDATE accounts SET balance = balance - 100.00 WHERE acctnum = 11111; プロセス２ SELECT * FROM accounts WHERE acctnum=22222 AND acctnum = 11111 FOR UPDATE; UPDATE accounts SET balance = balance - 100.00 WHERE acctnum = 11111; UPDATE accounts SET balance = balance + 100.00 WHERE acctnum = 22222; とするのは大丈夫なのでしょうか？ 本来なら、マニュアルにもある通り、UPDATEの順番を揃えるのがいいのでしょうが、実際にはWHEREの部分が変数で変化してしまうため、少々手間なのです。 実際のところ、このような場合、SELECT　～　FOR UPDATEで大丈夫なのでしょうか？それともテーブルレベルロックを用いるべきでしょうか？あるいはソートを用いるなどしてでも順番をそろえるべきなのでしょうか？ 実際の処理はpl/pgsqlの関数の中で、EXECUTE文によって行っています。 なので、なるべく複雑な処理は避けたいところなのです。 できれば情報ソースなども示してご説明いただけるとありがたいです。よろしくお願いいます。
現在、CSVファイルからCOPYコマンドを使用し、 データのINSERTを行いたいと思っております。 で試したところ、 COPY test from '/var/lib/pgsql/csv/insert.csv' USING DELIMITERS ','; とコマンドを入力した結果 ERROR: invalid input syntax for type date: "" CONTEXT: COPY test, line 1, column purchase: "" となってしまいます。 これを回避するためには、どうすればよいでしょう。 postgresqlは初心者なので、申し訳ございませんが 教えてください。よろしくお願いいたします。
現在、PostgreSQLを使用し、簡単なテストを しようと思っております。私は素人です。 ただ、下記の問題にぶち当たってます。 createdb --encoding EUC_JP test で「test」というDBを"EUC_JP"で作成 /var/lib/pgsql/data/postgresql.conf の client_encoding = EUC_JP を変更し、 posgre再起動。 INSERT INTO test VALUES (1,'山田太郎'); というINSERT文を投入したところ、下記エラーが発生。 ERROR: invalid byte sequence for encoding "EUC_JP": 0x8be9 HINT: This error can also happen if the byte sequence does not match the encoding expected by the server, which is controlled by "client_encoding". これってどうなんでしょう。 申し訳ないですが素人の私に教えてください！！ よろしくお願いいたします。
表題の件について質問させてください。 環境は PostgreSQL8.2.1 pgpoolにてDB2台で運用しております。 現在、とあるECサイトの運用などに携わっております。 1日平均が２～３千件の注文があり、注文情報を格納してるテーブルが150万件くらいになっています。 元々の作りが全てその注文テーブルに色々な情報を持たせてしまっており、更新頻度も結構高いです。 その状態で、現在は3時間に1回VACUUM ANALYZEをかけているのですが、その影響かはわからないのですが、セッション数(pg_stat_activityの件数)が正常運用時の3倍程度になる事が、ここ最近頻発しており、サイト全体の処理速度に影響しております。 １．VACUUM ANALYZEは、ロックがかからずにSELECT,UPDATE,INSERTなどが出来ると認識しておりますが、実行中に更新がかかっても問題ないという認識はあっておりますでしょうか？ ロックがかかったまま、セッションに残ってしまっているのは別の原因という事であっていますでしょうか？ ２．VACUUM ANALYZEの頻度として、3時間に1回という頻度は多いのでしょうか？ やはり、pg_stat_activityで監視をしていると、VACUUM ANALYZEの処理に時間がかかって、セッション数が多くなり、処理速度にかなり影響をあたえているのでは無いかと言う気がしてなりません。 以上、２点について、何かご教授頂ければ幸いです。 宜しくお願い致します。
主キーが文字列型のカラムhoge_idがあります。 (hoge_idは英数字8文字とします) hoge_idで、他のテーブルに結合します。 また、Webからアクセスする必要があり、URLのパラメータで、 ?hoge_id=A1B2C3D4 の様に、主キーを渡す必要もあります。 文字列を主キーにする方法に慣れていないせいか、気持ち悪く感じます。 主キーを別途serial型のカラムidを作成し、 hoge_idには、ユニークキーで設定をし、 結合や、URLのパラメータは主キーのidを使う方法はあまり意味がないでしょうか。 アドバイスを頂けませんでしょうか。 よろしくお願い致します。
テーブル名が違うだけで同じテーブル構造のテーブルが複数個あります。 仮にテーブル名を、A、B、C、Dの4個だとします。 テーブル名を格納するテーブルがあるので、そこから取得する方法でも構いません。 それらのテーブルから、フィールド名[名前]のデータを重複なしで取得したいのですが、SQL文が思いつきません。 取得するフィールドは[名前]だけです。 私の使用している環境はPostgreSQL8.1.9です。 SQL文を教えてください。よろしくお願いします。
こんにちは。いつもお世話になります。 PostgreSQLのversion7.2.8で、「not null」制約の追加、削除の方法をおたずねします。よろしくお願いします。 ALTER TABLE テーブル名 ALTER COLUMN カラム名 SET NOT NULL; で試したところ、syntaxエラー(構文エラー)で失敗。 ALTER TABLE テーブル名 ALTER COLUMN カラム名 DROP NOT NULL; で試してみても、同じくsyntaxエラーです。 version7.2.8が原因でしょうか？ また、version7.2.8でも「not null」制約の追加、削除が できる他の方法はありますでしょうか？ テーブルを作り直さずに、 既存のテーブルのカラムへの制約の追加、削除をしようとしています。 よろしくお願いします。
limit 1 を使用して検索を行っているのですが、 70万件程のデータを検索する場合には1秒以内にて返ってくるにも関わらず、 8万件程のデータを検索すると全く返って来なくなります。 ちなみにlimit 1000とすると瞬時に返ってきます。 どなたか、このような事象の要因や対処法などをご存知の方がいらっしゃいましたらご教授願えませんでしょうか。
PostgreSQLとmySQL どちらかのデータベースを選びたいのですが 両方使ったことがあるかた それぞれのメリット、デメリットを 教えてください
現在、postgresql8.2が入っているのですが、 postgresql8.3も共存させることはできるのでしょうか。 今まで、バージョン8.2を利用して作成したプログラムがあるので、8.2も残しておきたいのです。 バージョン8.3にすると、今まで8.2で作成したプログラムのSQL文が日付型等の指定が正しくない(?)為、 エラーになってしまう可能性があり、8.3に移行するわけにもいかず、困っています。 バージョン8.2がインストールされている状態で、バージョン8.3をインストールするだけで、問題ないのでしょうか。 現在、pgAdminnIII上には、「PostgreSQL Database Server 8.2」というサーバーがあるのですが、 インストールすると「PostgreSQL Database Server 8.3」等のように追加され、異なるバージョンが動くのでしょうか。 わかりづらい文章で申し訳ありませんが、よろしくお願い致します。
お世話になります。Sql初心者です。 round関数について質問があります。 double型のデータを少数点第一位までのデータを取得したいと思っています。 select round(double型の数値)ではデータが取得できますが、 double型のデータをselect round(double型の数値,1)という形で とするとエラーになってしまいます。 double型のデータをround関数で小数点指定で取得する場合は、どの様に 記述すればよいのでしょうか？ どなたかご教授願えますでしょうか？ 何卒よろしくお願いいたします。
下記のテーブルがあったとします。 【t_tblテーブル】 ――――――――――――― ｜id1　 ｜id2　｜id3 　｜ ――――――――――――― ｜1 　　｜1　　｜10 　　｜ ｜1 　　｜2　　｜12 　　｜ ｜1 　　｜3　　｜9　　　｜ ｜1 　　｜4　　｜8　　　｜ ｜1 　　｜5　　｜14 　　｜ ｜2 　　｜1　　｜14 　　｜ ｜2 　　｜2　　｜8　　　｜ ｜2 　　｜3　　｜9　　　｜ ｜2 　　｜4　　｜12 　　｜ ｜2 　　｜5　　｜10 　　｜ ｜3 　　｜1　　｜4　　　｜ ｜3 　　｜2　　｜2　　　｜ ｜3 　　｜3　　｜3　　　｜ ｜3 　　｜4　　｜5　　　｜ ｜3 　　｜5　　｜6　　　｜ ｜4 　　｜1　　｜6　　　｜ ｜4 　　｜2　　｜5　　　｜ ｜4 　　｜3　　｜3　　　｜ ｜4 　　｜4　　｜2　　　｜ ｜4 　　｜5　　｜4　　　｜ ――――――――――――― このテーブルの特定のレコードを抽出する為に、 2つパラメータを渡すとします。 1. 12 2. 8 そして下記の条件を満たすレコードのid1を抽出したいと思います。 1. 「id3」 = 「12」　かつ　「id3」 = 「8」　を満たすid1 (※この時点で1と2がヒットします) 2. 条件1を満たした上で、「12」のid2 < 「8」のid2 (※この時点で1のみヒットします) 下記のSQLで条件1を満たせる事は確認しましたが、 条件2を満たす方法が分かりませんでしたので、 アドバイスいただける方がいらっしゃいましたら、 ご教示いただきたいと思います。 select id1 from t_tbl group by id1 Having SUM(CASE WHEN id3=12 Then 1 Else 0 End)>0 And SUM(CASE WHEN id3=8 Then 1 Else 0 End)>0 使用バージョンは7.4.19です。 よろしくお願いします。
id | point ----+------- 1 | 10 2 | 9 3 | 5 .... というテーブルがあるとします. idを指定してpointを得たいのですが、そのidがこのテーブルに存在しない場合は空の結果ではなく0を返したいのです. plpgsqlなどを使いif文で場合分けすればできることはわかっているのですがSQL文だけで（それもできれば１文で）これを実現する方法はあるでしょうか？ よろしくお願い致します。
とあるテーブルのレコード数は、全部で２８レコードあります。 このテーブルにはインデックスを張っておらず、シーケンシャルスキャンでDBよりSELECTしています。 通常にシステムを運用する上では問題ないのですが、負荷試験などで同時接続数を50などにしループでDBにアクセスさせるとき、その他の4000万レコード程度あるテーブルをSELECTしてくるのは0.00xxx秒で行えるのに対し、この28レコードしかないテーブルからSELECTしてくる際は、遅い場合で0.xx秒もかかってしまいます。 この２８レコードしかないテーブルにインデックスを張っても、レコード数が少なすぎてまったく意味がありませんでした。 ちなみにこのレコードへは下記のようなSELECT文を発行しています SELECT xxx,xxx,xxx FROM xxxx where カラム1 = aaaa AND カラム2 IN (bbb,ccc) AND カラム3 = ddd; このレコードのSELECT文を高速化させるには、どのような手段があるでしょうか。 お手数ですがご教示いただけますと幸いでございます。 DBはPostgreSQL、PHPのWebアプリケーションよりDBにアクセスしています。
psqlでDBへログインした履歴はどのログに出力されますでしょうか？ ご存知の方、宜しくお願いします。
POSTGRESにはコマンド履歴を参照する機能などはございますでしょうか？ ご存知の方、アドバイスをお願いします。
開発によるテストで外部からtcp/ip接続を行いたいので、 tcpip_socket = true という項目をpostgresql.confに追加してみましたが、 postgres起動時に以下のようなエラーにり起動できません。 起動時のコマンド： pg_ctl -D /usr/local/pgsql/data start -w -o "-S -i" エラー： FATAL: unrecognized configuration parameter "tcpip_socket" postmaster (PostgreSQL) 8.1.9 何か原因分かりますでしょうか。
例えば、 ［品物管理テーブル］ cd:name 01:スナック菓子 02:ジュース 03:アイス 04:ガム 　・ 99:その他 と ［店舗別売り上げランキング管理テーブル］ shop:no1:no2:no3 Ａ店: 03: 01: 04 Ｂ店: 01: 02: 04 Ｃ店: 02: 01: 03 Ｄ店: 02: 01:null があった場合に Ａ店の売り上げ順に［品物管理テーブル］のcdとnameを取得したい場合は どのようにすればよいのでしょうか？ SELECT cd, name FROM [商品管理テーブル] AS syo LEFT JOIN ［店舗別売り上げランキング管理テーブル］AS ran ON syo.cd=ran.no1 OR syo.cd=ran.no2 OR syo.cd=ran.no3 WHERE ran.shop='Ａ店'; とすると、ランキングを無視して［品物管理テーブル］の順で 01:スナック菓子 03:アイス 04:ガム と返ってきてうまくいきません。
初めてこちらで質問させていただきます。 どうぞよろしくお願いします。 早速ですが、 現在ストアドファンクション（PL/pgSQL）にて以下のような形になっています。 変数d1,d2,d3に値をセットするにあたり テーブルt1を３回スキャンしています。 これを１回のスキャンでセットするような 方法はないのでしょうか？ DECLARE d1 integer; d2 integer; d3 varchar(10); begin select min(c1) into d1 from t1; select min(c2) into d2 from t1; select min(c3) into d3 from t1; 各種処理 return v; end; 気持ち的には以下のようなSQLを書きたいのですが、 syntax error となります。 （NG例） select min(c1) into d1,min(c2) into d2,min(c3) into d3 from t1; 何か良い案がありましたら教えてください。 「それは出来ません」と言う回答でもありがたいです。 ※あきらめがつくので。。 それではよろしくお願いします。
ALTER TABLE users SET (FILLFACTOR=80); 上記のようにＤＢに設定後、テーブル名（users)のFILLFACTORが ８０％になっているか確認する方法がありますか？
テーブル名：　list no | first_name | last_name | comment ----+------------+-----------+--------- 1 | 太郎 | 山田 | ほげ 2 | 次郎 | 田中 | ふが 3 | 花子 | 山田 | ぴよ 4 | 三郎 | 佐藤 | ぴよ 5 | 太郎 | 山田 | ぴよ 6 | 次郎 | 田中 | ふー 7 | 三郎 | 佐藤 | ふー 8 | 花子 | 山田 | ふー 上記の表から同じ”last_name”を持つ人の”first_name”と”last_name”を重複無しで抽出する(下記のような結果)ＳＱＬ文は作成可能でしょうか。 結果 first_name | last_name ------------+----------- 太郎 | 山田 花子 | 山田 宜しくお願いします。
お世話になっております。商用のサーバーを運営しているものです。 最近私が運営しているサーバーでチャットをやることになっているのですが、できればワイセツなどの禁止用語以外は自由にしたいのですが、そうするとSQLインジェクションの心配があります。それで、ユーザーが入力した文字列を扱う部分を PQexecParams を使ってデータベースに入れようと思っているのですが、これだけで問題は解決できますか？　これでも危険な攻撃を受けるケースがあるならばお教えください。
ウェブページが見れなくなっているのですが、 どなたか情報をお持ちではないですか？ たぶん、サーバがダウンしてるのではないかと予想しているのですけど。 2008-12-12 18:00現在
お世話になります 　大規模商談をまとめた営業のリストを作るSQLを書こうとしています。 　 営業部員テーブル　（test.person） id | name ----+------ 1 | 山田 2 | 高橋 3 | 田中 商談テーブル (test.deal) id | person_id | customer | amount ----+-----------+----------+-------- 1 | 1 | XX商事 | 20000 2 | 3 | BB電機 | 10000 3 | 2 | ZZ不動産 | 2000 4 | 1 | RR証券 | 8000 期待している検索結果 name | amount | customer ------+--------+---------- 山田 | 20000 | XX商事 田中 | 10000 | BB電機 高橋 | 2000 | ZZ不動産 下記のようなSQLを書きました。 select distinct name,amount,customer from test.deal,test.person where person.id=deal.person_id order by amount desc 　しかし、nameをdistinctしているにもかかわらず、結果は下記の通り、「山田」が重複しています。 name | amount | customer ------+--------+---------- 山田 | 20000 | XX商事 田中 | 10000 | BB電機 山田 | 8000 | RR証券 高橋 | 2000 | ZZ不動産 いろいろと調べて、group by を使えばいい、というようなやり方を示している例も多かったのですが、それもうまくいきません。（必要であれば載せます） 期待通りの結果を得るにはどのようなSQLを書けばよろしいでしょうか。 よろしくお願いいたします。
下記のSQLでWHEREでnow_tが存在しないとでてSQLを実行できません。 どのようにしたらnow_tをWHEREで判定できるでしょうか。 WHEREが先に実行される為に存在しないというエラーがでるのは わかるんですが、でないようになんとかできないでしょうか？ SELECT CASE WHEN s = 1 THEN 1 ELSE 2 END AS now_t FROM test WHERE now_t = 1
検索しても中々見つからなかったので質問させて頂きます。 dumpではなくselect文で、カラム(列)の 設定したデフォルト値を表示するSQL文 設定したcheck制約を表示するSQL文 を教えて頂きたいです。 よろしくお願いします<(_ _)>
１つtableの中に ・営業所 ・販売車種メーカー ・販売日 といった項目があるとき、 縦に営業所。横に、販売車種メーカー別の合計を出すにはどのようにしたら良いでしょうか？ 　　　　|トヨタ| 日産 | 本田 |マツダ|スバル| Ａ営業所|　 15 |　 5 |　　8 |　　1 |　　3 | Ｂ営業所|　　7 |　 10 |　　7 | 　5 |　　5 | Ｃ営業所|　 20 |　 14 | 11 |　　8 |　　2 |
psql (PostgreSQL) 7.3.4です。 困っています 以下のような【TABLE1】と【TABLE2】を TABLE1のt1tot2にで結合した結果を 【Ａ．結果】のように★▲●の行を１行に表示させて取得したいのですがうまくいきません。 【TABLE1】 ID,ID_SUB, TYPE, VALUE A A1 t1 1　★ A A1 t2 2　★ A A1 t1 1　▲ A A1 t2 3　▲ B B1 t1 1　● B B1 t2 3　● 【TABLE2】 ID, TYPEV1 ,TYPEV2 ,Code A 1 1 AAA1 A 1 2 AAA2　★ A 1 3 AAA3　▲ B 1 3 BBB1　● 　TYPEV1=TABLE1のt1の値 TYPEV2=TABLE1のt2の値 【得たい結果】 ID, ID_SUB, TYPEV1, TYPEV2,Code A A1 1 2 AAA2★ A A1 1 3 AAA2▲ B B1 1 3 BBB1● 下記でTABLE1の２行を１行にまとめることができましたが、 問題のTABLE2との連結方法が分かりません。 select TABLE1.ID , TABLE1.ID_SUB , TABLE1.VALUE as t1 , (SELECT tbl1.VALUE FROM TABLE1 tbl1 where tbl1.TYPE=t2 and (TABLE1.ID , TABLE1.ID_SUB)=(tbl1.ID , tbl1.ID_SUB)) as t2 from TABLE1 where TABLE1.TYPE = t1 【結果】 ID ,ID_SUB , t1　　,t2 A A1 1 2　★ A A1 1 3　▲ B B1 1 3　● 何か良い方法はありますでしょうか？
一度インストールしたPostgreSQLのパスワードを忘れてしまいまして、アンインストールをして再インストールしたところ、下記のようなエラーが出てしまいまして、悩んでいます。 --------------------------- データディレクトリ・エラー --------------------------- 指定されたデータ・ディレクトリーは、存在します。 あなたが同じ主要なバージョン番号をもつ現存するデータベースを持っていれば, データベース・クラスターを初期化する必要がありません。 もし異なる主要なバージョンをもつ現存するデータベースを持っていれば、古いデータベースをバックアップして、新しいものを作り出す必要があります。 ---------------------------- どうしたら指定されたデータ・ディレクトリーを削除することができるでしょうか？ 助けて下さい。
表題の件で質問させて下さい。 以前までは特に問題なく、alter tableなどで列を追加出来ていたのですが、ここ最近、データ量が増えてきたためか、列追加にすごく時間がかかってしまっています。 それが原因なのかはわからないのですが、alter tableで列を追加すると、処理が止まってしまい、プロセスをkillして、とりあえず対処する・・・ と言うような対応が続いています。 調べたところ、alter table はテーブルロックがかかってしまうらしいのですが、これは begin でトランザクションを開始させても特に意味はないのでしょうか？ いろいろと調べてはいるのですが、基本的な事は見つかるのですが、運用する時にどういった注意点があるか等が今いち、調べ切れませんでしたので、どんな運用をしていけばいいのかご教授して頂けると助かります。 宜しくお願いいたします。
環境 CentOS5系 64bit ＤＢバージョン 8.3.3 本番ＤＢサーバからpg_dump -c -D でダンプしたデータを、ローカルテストＤＢサーバ へpsql にてリストアした際、データ不整合が、一部のテーブルに発生しました。 前のデータが一部クリアされずに残っている状況です。 ダンプのデータは、ＤＢの内容と同じなのですが。 因みに、pg_dump パラメータ無しのダンプのリストアでは、発生しません。 何が、原因でしょうか？ もしかしてバグ？ ご教授願えれば幸いです。 宜しくお願い致します。
　ある製品の部品、その部品を構成する部品、そしてその……というデータをDBに格納しています。 　それぞれの部品にはIDがついていて、ツリーで見るとこんなかんじです。 　 100 +120 　+300 　　+250　 　　+290 　これは、100というIDを持った部品にはIDが120の部品があり、120の部品には300という部品があり、、、、ということを表しています。 　これを以下のようなテーブルに持っています。 items id | child_id | ---------- 100 | 120 | 120 | 300 | 300 | 250 | 300 | 290 | 　ここで、ある部品のIDをキーにして、その部品を構成する部品全て（つまり、子部品、孫部品、ひ孫部品……）のIDを検索するようなSQLを書きたいと思っていますが、巧い方法が思い浮かびません。（今は10階層あったら、10回SQLを発行しています） 　これを1回のSQLで、全てを検索することはできないでしょうか。言うまでもありませんが、10回のSQLよりもパフォーマンスは良くないと困りますが。。。 　周りの人はみんなできないんじゃないかと言っていますが、もしできる、という方法をご存じの方はご教示いただければと思います。 　DBはPostgreSQL8.2ですが、MySQL5を使っているアプリでも同様の問題があるので、そちらでも使えればうれしいです。 　よろしくお願いいたします。
勉強しようと思いLINUX(RHEL4.0）にapache2.2.9、postgresql8.3.5、PHP5.2.6を入れました。 データベースを作成しwebブラウザで見ようと思ったら ○ローカルでは見えた ○他のLINUXマシンからは文字化けしたが見えた ○windowsマシンからは空白のみでデータベースの表示が無い windowsマシンからは何か特別な作業が必要なのでしょうか？ 情報が足りないかとは思うのですがお気づきの点がありましたら教えて頂きたく御願い致します。
ご存知の方教えてください。 現在当方、fedora8にてPostgersql8.2.5を運用しております。 ちょっとマシンを変えたいと思いまして、現在のDB情報を すべて載せ替えたいと思っております。 A → B (Aが旧マシン Bが新マシン) 旧マシンでpg_dumpallしたものをBマシンでリストアする事は可能なのでしょうか？ また、pg_dumpallしたデータはどこへ保存されるのでしょうか？？ ご存知の方教えてください。 ではよろしくお願いいたします。
最近、DBを勉強し始めた、初心者です。 現在、pg_dumpコマンドでデータをバックアップして、リストアしようと試みています。DBのデータ容量が小さいうちは、問題なくリストアできるのですが、DBのデータの容量が大きくなってくると、「No buffer space available」とエラー表示されます。 この問題を解決するには、どうしたらいいのでしょうか？ 詳しい方がいましたら、教えて下さい。 よろしくお願いします。
PsqlやMysqlのXMLエクスポート機能について調べているのですが 中々そういった資料はありませんでした。そこで PostgreSQLもしくはMysqlのデータを XML形式でエクスポートする機能はあるんでしょうか？ やはりC言語やツールなどを通して 変換するしかないのでしょうか？ こんな質問で申し訳ありませんが 宜しければ教えて下さい<(_ _)>
課題でDBへアクセスできるjavaプログラムを作成したのですが、提出の際、テストデータをもってくるように言われたのですが・・・テストデータの作り方がわかりません。 どなたか教えていただけないでしょうか？よろしくお願いします。
PostgreSQLのあるテーブルで「開始時刻」と「終了時刻」というフィールドがあり、timestamp with timezone（例：2008-07-31 07:00:00+09）でデータを持っています。 例えば、日付に関係なく13:00から15:00までのデータを抽出したい場合、SQLのWHERE句にはどのように記述すればよろしいのでしょうか？
１つのTABLEに、1日の売上げ高を商品ごとに登録していくDBがあります。 簡単な構造は以下のとおりです。 日付　　　　 　 |A品売上額 　|B品売上額 | 2008/11/01 |500000　　　 |600000　　　| 2008/11/02 |450000　　　 |800000　　　| 2008/11/03 |100000　　　 |700000　　　| ・・・ 2008/11/30 |200000　　　 |500000　　　| 2008/12/01 |300000　　　 |100000　　　| ＜質問＞ それぞれの商品の1ヶ月売上高をSQLで抽出したいと思うのですが、Group byで何を指定したらいけるのかわからず困っています。 SQLで計算せずに抽出だけ行って、CGI側で計算するしかないのでしょうか？ アドバイスお願いいたします。 ＜最初に考えたSQL（Group byがないためエラーになりました）＞ select sum(a),sum(b) from uriage where date between '2008/11/01' AND '2008/11/30';
下記のテーブルがあったとして、 field2にグループAに該当する値と、グループBに該当する値が共に1つずつ入っている field1の値を抽出したいと思いました。 下記の場合ですと、その条件を満たす1, 3, 4, 6を抽出したいと思います。 グループA：1, 2, 3 グループB：101, 102, 103 ――――――――― ｜field1｜field2 ――――――――― ｜1　　　｜1　　 ｜1　　　｜10 ｜1　　　｜101 ｜2　　　｜1　　 ｜2　　　｜15 ｜2　　　｜104 ｜3　　　｜2　　 ｜3　　　｜18 ｜3　　　｜101 ｜4　　　｜2　　 ｜4　　　｜17 ｜4　　　｜103 ｜5　　　｜3　　 ｜5　　　｜15 ｜5　　　｜100 ｜6　　　｜3　　 ｜6　　　｜18 ｜6　　　｜103 ――――――――― 使用バージョンは7.4.19です。 よろしくお願いします。
PostgreSQLの最初に設定したパスワードを忘れてしまったのですが設定したパスワードを調べる方法はないでしょうか？ pgAdminIIIではパスワードを入れるとアクセスできるのですが、コマンドプロントからするとなぜかアクセスできません。。。。 同じようにパスワードがわからなくなった方の質問・回答から以下の処理をしてみたのですが・・・ ＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊ pg_hba.confのエントリを編集し直します。 # TYPE DATABASE USER IP-ADDRESS/CIDR-mask METHOD host all all 127.0.0.1/32 password この、passwordと書いているエントリの部分をtrustへ変更します そしてpostgreSQLを再起動し、postgresユーザーで全部いじれるようになります。 使えるようになったらtrustとした部分をpasswordにもどし、ネットワークへつないでください。 ＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊ 上記の方法でやってみたのですがパスワードをtrustの状態にし、「psql postgres」 とうち、データベースへ接続しようとしたら psql: role "Owner" does not exist とエラーが出てしまうのです。何がいけないのでしょうか・・・ ＤＢへの参考書やネットで調べたりしているのですが、ツールを使わずにＤＢ操作を行おうとしたらコマンドプロンプトからＤＢへ接続し、sql文で操作するものだと思うのですが・・・・間違った解釈なのでしょうか・・・・
コマンドプロントにてＤＢへ接続するために「psql postgre」と入れたのですが Password : となるのですが、どのキーをたたいても入力することができません。エンターキーを押すと psql: FATAL: password authentication failed for user "postgre" と出るか paql: fe_sendauth: no password supplied と出てしまい何もできません。パスワードはコマンドプロントで入力できないのでしょうか？
初心者の私にご教授願います。 phpにて情報を更新する画面を用意しており、そこから修正したのを updateさせているのですが、なぜか 全角を含む文字をupdateとするとエラーになっちゃいます。。 同じvarcharでも数字のみをupdateすれば、エラーはでません。 これは何か指定してあげる必要があるのでしょうか。 また、数字の前ゼロがupdateしたら消えちゃうのも 何か指定する必要があるのでしょうか。 不躾な質問で申し訳ありませんが ご回答お願いします。
お世話になります。 PostgreSqlのインストールについて、嵌っています。 以前、PostgreSqlの8.3をインストールしていて、今回、新たに PostgreSqlの8.3をアンインストールして、同一バージョン(8.3)の インストールをしました。 インストールはうまくいくのですが、インストール時に設定した ユーザー名、とパスワードでPgAdminからデータベースにアクセス するとユーザーIDとパスワードが異なっているといった旨のエラー が出力されてしまいます。 アンインストール時の手順は以下の通りです。 (1)コンパネからプログラムの削除→postgresSql8.3を削除 (2)C:\Program Files\PostgreSQLを削除 (3)DOSからコマンドで、net user postgres /deleteを実行 上記の手順で、アンインストールを行い、postgresqlを再度インストール しているのですが、何度やってもうまくいきません。 以前、インストールした際は、問題なく出来たのですが、何が問題なのでしょうか？ どなたか、お助け願えませんでしょうか？
postgreSQL7.3で以下のようなデータの並び替えを実現したいと思っています。 下記のようなデータを・・・ no | recno | name ----+-------+------ 1 | 1 | a 1 | 1 | b 1 | 2 | c 1 | 4 | a 2 | 3 | a 2 | 3 | c 2 | 3 | b 3 | 5 | b 4 | 6 | a 下記のような並びにSQLで取得することは可能でしょうか。 no | recno | name1 | name2 | name3 ----+-------+------+------+------ 1 | 1 | a | b | 1 | 2 | c | | 1 | 4 | a | | 2 | 3 | a | b | c 3 | 5 | b | | 4 | 6 | a | | noとrecnoのグループごとにnameを横に並べていきたいのですが、 可能なのでしょうか。 できれば、nameは個々のカラムに出力したいのですが、 配列のように1つのカラム内にカンマ区切りでの出力でも構いません。 上記のような表示が可能であれば、SQL文もご教授いただけますと幸いです。 宜しくお願いいたします。
PostgreSQLをベースとしたパッケージを利用しているのですが 容量不足気味で困っております。 OracleDBであればObjectBrowserで表領域情報を確認し、 どのテーブルが領域を圧迫しているかが確認できるのですが Postgreは閲覧できません。 一時的な作業なため、同じような情報が取得できるフリーの ツールなどをご存知でしたら、どなたか教えて頂けないでしょう？ 対象サーバはLINUXのため、私自身、全く操作ができません。 できればWindows上で操作可能なものがあれば教えて下さい。 よろしくお願い致します。
はじめまして、yossy136kgと申します。 下記の件、ご教授をお願いします。 ・TEST1というDBがあったとして、psqlより\dでテーブル一覧を参照すると、「No relations found.」と表示されます。 ・MS AccessからODBC経由でTEST1のDBのリンクテーブルを作成する際、別のDB(TEST2)のテーブルが参照できます。 例）TEST2.HOGE1、TEST2.HOGE2・・・ 【質問】 TEST1のDBからTEST2のDBのテーブルをリンクさせるようなことは可能なのでしょうか？ ちなみにPostgreSQL8.2.3、CentOSです。
以下のような【TABLE1】と【TABLE2】をID_SUBの列で結合した結果を 【Ａ．結果】のように取得したいのですがうまくいきません。 【TABLE1】 ID ID_SUB 1 A1 2 B1 【TABLE2】 ID ID_SUB ID_SUB_CODE 1 A1 AAA1 2 A1 AAA2 3 B1 BBB1 4 B1 BBB2 【Ａ．結果】 ID_SUB ID_SUB_CODE A1 "AAA1,AAA2" B1 "BBB1,BBB2" いろいろ調べたのですが、MySQLにはGROUP_CONCATの 関数を使うと簡単に出来るみたいですが、PostgreSQLには 似たような関数がなく、ARRAYが使えるかな？と思ってためしてみましたが array_to_string(ARRAY(ID_SUB_CODE, ',')) 等のような感じで試した結果、ID_SUB_CODEが 全て連結されるような使い方しか出来ませんでした。 A1 "AAA1,AAA2,BBB1,BBB2" B1 "AAA1,AAA2,BBB1,BBB2" 何か良い方法はありますでしょうか？
PL/pgSQLについて質問させてください。 以下のような2つのテーブルＡとＢがあります。 テーブルＡ： aid | fall0 | fall1 -----+-------+------- 001 | 0 | 0 002 | 0 | 0 テーブルＢ： bid | aid | fall --------+-----+------ 000001 | 001 | 0 000002 | 001 | 0 000003 | 002 | 0 000004 | 002 | 0 テーブルＡとテーブルＢの関係は1:nの関係です。 以下のような2つのことがやりたいです。 テーブルＡのfall0,fall1,テーブルＢのfallはフラグです。 今、テーブルＢのaid=001であるすべての行のfallを0から1に変えたとき、 それに対応するテーブルＡの行のfall1が0から1にかわる。またテーブルＢのaid=001である少なくとも一つの行のfallを0から1に変えたとき、 それに対応するテーブルＡの行のfall0が0から1にかわるようなプログラムを作りたいのですが、なかなかうまくいきません。今aid=001のときをやりましたが、aidは任意のときを想定しています。もし、ご存知の方がいらっしゃいましたら教えていただけないでしょうか？ よろしくお願いいたします。以下は自分が書いたプログラムです。 drop table b; drop table a; create table A ( aid text primary key, fall0 integer, fall1 integer ); create table B ( bid text primary key, aid text not null references A(aid), fall integer ); insert into A values ('001',0,0); insert into A values ('002',0,0); insert into A values ('003',0,0); insert into B values ('000001','001',0); insert into B values ('000002','001',0); insert into B values ('000003','002',0); insert into B values ('000004','002',0); /* 関数の定義 */ create function tri_test() returns trigger as ' begin declare aid_rec if old.fall=0 and new.fall=1 then update a set fall1=1 where a.aid = select b.aid from b where b.fall = 1); end if; return new; end; ' language 'plpgsql'; /* トリガーの定義 */ create trigger tri_b after update or insert on b for each row execute procedure tri_test(); /* B テーブルへのデータ操作 */ update b set fall=1 where aid='001';
Postgresでテーブルが2つある場合、 その2つに登録されているデータを全て取得したいのです。 例えば Ａテーブル　　　　　　　Ｂテーブル Key1　key2　A 　　　　Key1　key2　B －－－－－－－－－－　－－－－－－－－－ ０１　０１　Ａ１　　　　 ０１　０２　Ａ２　　　０１　０２　Ｂ２ ０１　０３　Ａ３　　　０１　０３　Ｂ３ 　　　　　　　　　　　　０１　０４　Ｂ４ とある場合、 1度のSQLで下のような結果を取得できますか？ Key1　key2　A　　　B －－－－－－－－－－－－ ０１　０１　Ａ１　　　NULL ０１　０２　Ａ２　　　Ｂ２ ０１　０３　Ａ３　　　Ｂ３ ０１　０４　NULL　　Ｂ４ お願いいたします。
皆さんに伺いしたいですが。 データをエクセルへ出力した場合に、コラム名も一緒に入れたいですが。 現在が以下のようなコマンドを使っています。 Create temp table csv1 as Select * from henkan4 COPY csv TO 'd:/inetpub/wwwroot/cgcs/forwriting/def.csv' WITH CSV こうなるとデータのみになってしまいまして、エクセルやSPSSでデータを読み込んだ後の処理をしなければならないです。オプションがあるかと調べてみましたが、見つけるのができませんでした。 よろしくお願いします。 ver postgres 8.01 os windows xp
ご指導お願いします。データのやり取りに困っています。単純な作業かもしれないですが、いろいろ本を調べてもこのような内容は出てなくて困っています。 テーブル1に以下のようなデータが入っています。 ID Q1 Q2 Q3 Q4 ------Q16 75 増額 言及なし 言及なし 増額 51 現状維持 言及なし 言及なし 増額 それを以下のように変えてテーブルをつくりたいです。 ID Q1 Q2 Q3 Q4 75 　3 4 4 3 51 2 4 4 2 新しいテーブルに以下のようなテーブルを作成しましてinner joinをしました。しかし、その場合はひとつの項目しかデータの変換ができないです。 koumoku henkan 減額 1 現状維持 2 増額 3 言及なし 4 テーブル1のデータの形式は同じですので、それを全体的に変換する方法はないでしょうか。 postgres ver. 8.0 windows xp professional
PostgreSQL8.3にて、 ｜ID｜担当者｜ 年月 ｜金額｜ ｜ 1｜太　郎｜200807｜ 500｜ ｜ 2｜次　郎｜200807｜1000｜ ｜ 3｜次　郎｜200807｜ 500｜ ｜ 3｜太　郎｜200808｜1000｜ ｜ 4｜次　郎｜200808｜1100｜ ｜ 5｜三　郎｜200808｜ 900｜ ｜ 6｜太　郎｜200809｜1100｜ ｜ 7｜三　郎｜200809｜1200｜ というテーブルから、 ｜ 年月 ｜太郎｜次郎｜三郎｜ ｜200807｜ 500｜1500｜ 0｜ ｜200808｜1000｜1100｜ 900｜ ｜200809｜1100｜ 0｜1200｜ このようにすることは可能なのでしょうか。 どうかよろしくお願いします。
現在、1台のLinuxサーバでPostgreSQL7.xが起動しています。 そこへ、もう一つバージョンの違うPostgreSQL8.3を追加し、同時に2つを起動して使い分けたいと考えていますが、可能でしょうか。 使い分けというのは、同サーバ内に設置しているPerlやPHPのシステムがいくつかあり、例えばAというシステムはpostgreSQL7.xのDBデータ、BというシステムはpostgreSQL8.XのDBデータを利用するようにするということです。 よろしくお願いします。
以下のような2つのテーブルがあるとして、 [表A：学生マスター] 学生ID　氏名 001　　　佐藤 002　　　斉藤 003　　　田中 [表B：試験結果] 学生ID　試験ID　得点 001　　　001　　　80 002　　　001　　　70 003　　　001　　　60 001　　　002　　　75 003　　　002　　　85 002　　　003　　　90 003　　　003　　　85 以下のような集計表を得たいのですが、一発で作成できる（しかも高速な）SQLが思いつきません。 試験結果テーブルに順位が入っていれば簡単なのですが。 どなたかご教示ください。 [集計表] 学生ID　試験1　順位　試験2　順位　試験3　順位　平均得点 001　　　　　80　　　1　　　75　　　2　　　欠席　　　　　 77.5 002　　　　　70　　　2　　　欠席　　　　　 90　　　1　　　80.0 003　　　　　60　　　3　　　85　　　1　　　85　　　2　　　76.7
お世話になります。 PostgreSQLにて、大量データ(40万件ぐらい)のテーブルに、下記処理を行ったところ、処理速度が異様に低下してしまいました。 ・10行くらいのカラムを追加 ・デフォルト値制約を設定 ・追加したカラムにデフォルト値をアップデート 一応、VACUUM ANALYZEは、かけてはいたのですが、処理速度は向上せずに、VACUUM FULLにて対応したところ、速度は元に戻りました。 ですが、カラム追加をする毎にVACUUM FULLをかけるには、ちょっと時間がかかり過ぎで、他に良い方法が無いか悩んでおります。 何か、良い方法はありませんでしょうか？ 宜しくお願い致します。
お世話になります。 現在、JAVAを利用した開発をPostgres8.3で行おうと考えております。 そこで以下の状態で、Postgresを運用可能かどうかで悩んでいます。 保持するデータは以下の規模を想定しています。 ・TBLは5～10(各)。カラム数は1TBLあたり、5～10程度 ・データは月次60000件、年間72万件のデータを数年間保持する必要あり。 仕様としては、毎月、20社、各3000件のデータをPostgresに取り込み。 JAVAの画面から帳票(グラフ等)を各社ごとに出力するといった仕様です。 何ヶ月、何年と運用を重ねていくながで数十万、数百万のデータによって、アプリケーションの処理が極端に重くなったりデータ容量の上限に 達するといったことはあるのでしょうか？ また、もしそうならば、どれくらいのデータ容量ならば、ユーザーに とって利用に絶えられるシステム運用が可能なのでしょうか？ 私自身が、DBに詳しくないため判断しかねています。一応インターネット で調べてPostgresの容量が2GBだということはわかったのですが、基準 がわからず困っています。 どなたかご存知の方がいらっしゃったらお答え願えますか？ よろしくお願いいたします。
先に質問をさせていただき、１度は解決したものの再び行き詰ってしまいました。 UPDATEの際うまくいかず困っています。 お知恵を拝借いただけると助かります。 使用バージョンはPostgresV7.3.4です。 tableA a1|a2|b|c -+--+-+- 1 | 1 | 1| 1 (★) 1 | 1 | 0| 1 1 | 2 | 0| 1 2 | 2 | 1| 0 2 | 1 | 0| 1 3 | 2 | 1| 1 (★) 3 | 2 | 0| 1 3 | 1 | 0| 1 b=1 and c=1 で一致する行を★行とする。 ★行のa1列の値とa2列の値(上記の例だと(a1=1,a2=1)と(a1=3,a2=1)）をもつ行に対して 下記の条件◆でUPDATEを行う。 [条件◆] b=0 and c=1 [UPDATEの内容] 条件◆に一致したc列を3に更新する [理想の結果] tableA a1|a2|b|c -+--+-+- 1 | 1 | 1| 1 1 | 1 | 0| 3 ←更新 1 | 2 | 0| 1 2 | 2 | 1| 0 2 | 1 | 0| 1 ←★にあてはまらないので更新されない 3 | 2 | 1| 1 3 | 2 | 0| 3 ←更新 3 | 1 | 0| 1 ←最下行 ========================================== UPDATE tableA set c = 3 WHERE 条件◆ and a1 in (select a1 from tableA where b=1 and c=1) and a2 in (select a1 from tableA where b=1 and c=1) このようなイメージなのですが、この場合、 最下行のc列も更新してしまいました。 (説明しずらいのですが、) a1とa2の条件は独立させるのでは無く、セットとして考えたいのですが、 方法が分りません。 ご協力お願いします。 ==========================================
ご教授よろしくお願い致します。 現在、table_aにInsertされたカラム（no,name)のデータを同時にtable_bにも反映するSQL文を考えております。 【table_a】 　　　　　　　　　　　　 no　|　name　|　price　　　　　　　　　　　　　　 ============== 　　　　　 　 005 　apple 　　500 　　　　 　　 001 　banana 　250 　　　　　　　 【table_b】 no　|　name　|　color ================= 005 　apple 　　red 001 　banana 　yellow Insertをそれぞれのテーブルで実行すれば、もちろん反映はできるのですが一度のInsert文でできるのならそれにこしたことはありません。 いろいろ調べた結果、下記のサイトでできるようなことが記載してあったため、実行したのですが、『ALL』がシンタックスエラーとなってしまいます。 そのため、postgresのマニュアルを確認してみたところ、Insert文にALL句の指定は特別記載されていなかったため、できないとも思っているのですが… サイト↓ http://www.atmarkit.co.jp/fdb/rensai/sqlclinic12 … サイトを参考にしたSQL文 『INSERT ALL INTO table_a(no,name) VALUES(005,apple) INTO table_b(no,name) VALUES(005,apple); 』 何か良い方法をご存知の方がいましたら、ご教授よろしくお願い致します。同じことをUpadteでもやらなければいけないのですが、それはもう少し自分で考えてみます。 只、できないことが明白な場合は、ご指摘を頂けると有難いです。 環境としましては、 OS 【Windows xp】 DB 【PostgreSQL 8.2】 です。
Debian etch (Linux Debian 2.6.25.1-kuroboxHG) な環境に aptitude install postgresql8 として、 PostgreSQL バージョン 8.1.11 を使っています。 インストールした直後のデフォルトのデータベースクラスタは /var/lib/postgresql/8.1/main でしたが、 # df Filesystem 1K-blocks Used Available Use% Mounted on /dev/hda1 2063504 718136 1240548 37% / tmpfs 63504 0 63504 0% /lib/init/rw tmpfs 63504 0 63504 0% /dev/shm /dev/hda3 116413420 3093484 113319936 3% /mnt のような環境ですので、データベースクラスタを /mnt/share/pgsql に作ろうと思い /usr/lib/postgresql/8.1/bin/initdb -D /mnt/share/pgsql としました。 Success. You can now start the database server using: /usr/lib/postgresql/8.1/bin/postmaster -D /mnt/share/pgsql or /usr/lib/postgresql/8.1/bin/pg_ctl -D /mnt/share/pgsql -l logfile start となったので /usr/lib/postgresql/8.1/bin/pg_ctl -D /mnt/share/pgsql -l logfile start したところ server.crt　がないと怒られたので /var/lib/postgresql/8.1/main に有ったシンボリックリンクを作成　この時に同じフォルダにある二つも作成 root.crt -> /etc/postgresql-common/root.crt server.crt -> /etc/ssl/certs/ssl-cert-snakeoil.pem server.key -> /etc/ssl/private/ssl-cert-snakeoil.key としたのですが 再起動してもPostgreSQLがもとのまま /var/lib/postgresql/8.1/main を使って起動しています。 どこを見直すのかご享受ください。 よろしくお願いします。
PostgreSQLを使用しております。 それぞれ、TABLE1とTABLE1があり、 TABLE1 a-1　　　a-2　　　b-1　　 ￣￣￣￣￣￣￣￣￣￣￣￣￣￣ 　　　１　　　bbb　　　aaa　　　ddd　 　 　　２　　　ggg　　　bbb　　　ccc　　　 　　 　３　　　bbb　　　mmm　　ddd　　 　　　 ４　　　ggg　　　mmm　　ccc　　　 : TABLE2　　 a-1　　　a-2　　　　　　　　c-1　 ￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣ 　　 　１　　　bbb　　　aaa　　　　　　　　eee　　　　 　　　 ２　　　ggg　　　mmm　　　　　　　qqq　　　 : 質問１． TABLE1.a-1=TABLE2.a-1 and TABLE1.a-2=TABLE2.a-2 を条件にして結合 したい場合、どのように結合すればよいのか。 期待結果　a-1　　　a-2　　　b-1　 c-1　 ￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣ 　　　１　　　bbb　　　aaa　　　ddd　 eee 　　　２　　　ggg　　　bbb　　　ccc　　　※ 　　　３　　　bbb　　　mmm　　ddd　　　※ 　　　４　　　ggg　　　aaa　　　ccc　　　qqq ※は空白でもNULLでもよい 質問２． 上記が可能な場合にさらに質問です。 TABLE1およびTABLE2が、SELECT,WHEREによって抽出されたものとした場合、 １つのSQL文で質問１と同様の出力にするにはどのように結合すればよいのか。（はたまた無謀なのか） 知識不足のため悩んでいる状況なので、 どなた様か知識がある方にご教授願いたく思います。
皆様、はじめまして。blackcat37と申します。 これから、PostgreSQLにチャレンジしようと思いインストールを行っています。 インストール・アンインストールを何度かやっているうちに インストールができなくなりました。 インストールファイルのコピーまでは進むのですが、ユーザーアカウントの 設定になると、 ＞内部のアカウント検索に失敗しました。 ＞アカウント名とセキュリティIDの間のマッピングは実行されませんでした。 とエラーメッセージが出て、インストールが失敗してしまいます。 再インストールする際には、 net user postgres /delete でアカウント削除を行い、Documento And Settingにある postgresユーザフォルダも削除しています。 PostgreSQLのインストール先フォルダが無い事も確認しています。 あと何か確認しなければならない事があるのでしょうか？ 環境はWinXP+SP2です。 説明不足の点がありましたら、ご指摘ください。 よろしくお願いいたします。
Ｃプログラムでのデータベース接続が出来ない事で質問です。 現在Ｃ言語で書いたプログラムがありまして、今まではwindows上でCSVファイルから読み込んで、 新しいファイルに書き込むというような内容のプログラム作っていました。 それを今は ＯＳをLINUXのRedhat(teratermからアクセス) 読み込むデータファイルをデータベース(Postgresql) にしてやっています。 何とかＤＢをインストールして、ＤＢにCSVファイルをコピーした物を作る所までは出来ました。 その後ＣプログラムでＤＢを利用する時、色んな設定をしてやらなくてはいけないと思うのですが まずlibpq-fe.hというものをincludeして使うとは分かったのですが、これがまず見つかりません。 質問(1) ＯＳの中のファイルを探す時にコマンドで# find ~ -name libpq-fe.hとやったのですが間違っていますか？ ちなみにあるとしたらどこにそのヘッダーファイルはありますか？ 質問(2) インストールした手順としては日本PostgreSQLユーザ会のサイトからソースをダウンロードしてコンパイル、インストールを行いましたが、調べるとrpmと言うものを使ってインストールした人が同じような内容で質問していて、develを入れないとヘッダーファイルが 入らないという記述がありました。 その事は何か関係がありますか？ 質問(3) libpq-fe.hが必要と書きましたが、他にもlibpq.soやlibpq.hと書いてあったりしてそこの所もよく分かりません。 記述が足りなかったらすいません。 ヒントでも良いので宜しくお願いします。
postgres 7.2.4で質問させてください。 以下のような構成のテーブルの抽出をしようとしています。 テーブル名　：t_name カラム名　　：k1、k2、k3 インデックス：t_name_idx　 テーブルt_nameの全体件数は約70万件で、上記のSQLから期待 される抽出結果件数は約1万5千件です。t_nameにはk3のみを対象としたインデックス、t_name_idxが作成してあります。次のようなSQLを実行した際に、シーケンス検索になり応答までに６秒ほどかかってしまいます。 　select k1,k2 from t_name where k3 in ("100","200"); explain analyzeで実行計画を見ると (cost=26.29..15304.62 rows=523 width=104) Total runtime: 6427.32 msec です。シーケンスをSET enable_seqscan TO off;　で使用しないようにして、強制的にt_name_idxを使うと次のような結果になります。 (cost=0.00..42009.05 rows=523 width=104) Total runtime: 423.81 msec 実際にはindexを使用したほうが10倍以上も速いのに、プランナはシーケンス検索のほうがコストが小さいと判断しています。何故このようになってしまうのでしょうか？VACUUM ANALYZEを行っても結果は変わりませんでした。 私のイメージでは、index検索のほうがコストが小さく計算されて、それを使うべき。というイメージなのですが、考え方自体が間違っているのでしょうか？ 原因を調べ始めて１週間経ち、行き詰っています。 どなたかヒントだけでもいいので教えてください。
PostgreSQLについて質問なのですが、サーバ移転をしておりまして別のサーバにまったく同じ環境でDBを移行しました。 そこで、テーブルには接続できてまして他のテーブルに書き込んであるレコードは参照できるのですが別のテーブルに書き込もうとすると以下のようなメッセージがでてしまいます。 [db_error: message="DB Error: no such table" code=-18 mode=return level=notice prefix="" info="INSERT INTO tenpo (tenpo,towner,tiku,created,updated,disabled,password) VALUES ('1','test','0000000000','test',NULL,'test',NULL,NULL,'0','now()','now()',TRUE,'128573') [nativecode=ERROR: relation "public.tenpo_tenpo_no_seq" does not exist]"] no such tableと表示されていますがテーブルは存在してます。 テーブルに書かれているデフォルトの記載を削除するとメッセがかわります。 [db_error: message="DB Error: null value violates not-null constraint" code=-29 mode=return level=notice prefix="" info="INSERT INTO tenpo (tenpo,towner,tiku,created,updated,disabled,password)VALUES('1','test','0000000000','test',NULL,'test',NULL,NULL,'0','now()','now()',TRUE,'258237')[nativecode=ERROR: null value in column "tenpo_no" violates not-null constraint]"] 書き込みができない理由などのお知恵をお借りできればと思います。 よろしくお願いします。
こんにちは。 PostgreSQL8.1.10を使っています。 複数のテーブルに日付情報が入っています。 この日付のなかで最新のものを検索したいのですが、どうすればよいのでしょうか？ テーブルが１つの場合なら、 select max(date) from table1; でできるのですが。 テーブルは３つ以上（１０くらい）になる予定です。なにはよい方法はないでしょうか。よろしくお願いします。
いつもお世話になっております。 あいまい検索で、英文字の全角・半角も区別しないように結果を出したいんですが、どういった方法でできますでしょうか。 大文字小文字の区別なしの曖昧検索だと、 ILIKEという専用演算子を使えばいいとわかったのですが、 全角と半角の区別がついてしまいます。 英文字の全角でも半角でも検索結果をだしたいです。 どなたかご教授お願いいたします。
([0-9][0-9]|[0-9]) 2桁の数字または1桁の数字を指定するにはsqlではどうかけばよいですか？
普段Oracleを利用しています。 Oracleだとvarchar2のカラムを作成する際に、 バイトか文字(キャラクタ)の指定ができるのですが、 Postgresでは指定できないのでしょうか。 どちらか固定ですか？ 指定できるのでしたら既にあるテーブルのカラムが どちらになっているかわかる方法はないでしょうか。
皆様始めまして～初歩的な質問かもしれないですが postgresSQLのデータをpsqlコマンドでみるときに whereをつかわずに [xxxxxxx@yyyyyy ~]$ psql -q -c 'select * from employ_kanri' xxxxxx postgres 社員名 | 社員番号 | 勤務先 ------------------------+--------------+---------------------------- 田中 | 200700 | 横浜 と結果はでるのに、 whereを使うと [xxxxxxxx@yyyyy ~]$ psql -q -c 'select * from employ_kanri where 勤務先 = '横浜'' xxxxxx postgres ERROR: column "横浜" does not exist になるのはなぜでしょうか？ ちなみにデータベースに入ってwhereコマンドを使うと問題なくできます。。 [xxxxxxx@yyyyyyy ~]$ psql xxxxxx postgres Welcome to psql 7.4.11, the PostgreSQL interactive terminal. Type: \copyright for distribution terms \h for help with SQL commands \? for help on internal slash commands \g or terminate with semicolon to execute query \q to quit xxxxxxx=# select * from employ_kanri where 勤務先 = '横浜'; 社員名 | 社員番号 | 勤務先 ------------------------+--------------+---------------------------- 田中 | 200700 | 横浜 よろしくお願いします
PostgreSQLについて質問です。 タイトルにもありますが、「データベースクラスタ」について、詳しくご説明頂けたらと思います。 ご回答をお願い致します。
特定のフォルダのファイルを検索する検索フォーム(html）を作りたいのですが いろいろと調べてみるとApache+perl+postgreSQLなどあるのですが データベースを使わなくても構築できるのでしょうか？ 実際に作り方を示唆していただけると凄い助かるのですが 例:検索フォームにtestと入力すると、testという名のファイルの位置を返してくれるシステム /aaa/bbb/test
年間データテーブルと年間テーブルから当日だけのViewが ある場合、当日のあるデータの集計等をしたい場合、どちらから検索しても速度は同じなのでしょうか？ Viewから検索した方が早くはならないのでしょうか。 初歩的な質問で申し訳ありませんが回答よろしくお願いします。
全くの初心者で、初めて質問させていただきます。 windowsXPにPostgreSQL(8.3.3)をインストールしようとしています。 「インストールオプション」ダイアログで《国際化言語のサポート》というものが出てきました。 以下の三つから選択するようになっています。 《ローカルなハードディスクドライブにインストールされます》 《全体の機能はローカルなハードディスクドライブにインストールされます》 《全体の機能は選択されません》 これらの意味がよくわかりません。 他のサイトを色々検索してみましたが、設定手順については説明されているのですが、なぜそのオプションを選択するのかまで説明されているものが見つからなかったので、詳しい方、教えてください。
こんにちわ。PostgreSQLのSQL文について質問させてください。 以下のSQL文を実行したとき、 # select c.id from C c left join S s on (s.id=c.id) where c.num = 1 group by c.id having count(s.id) >= 5; id ---- 7 5 (2 rows) というデータが表示されるんですが、このSQL文で抽出したデータの総件数を求めるにはどうしたらいいでしょうか？ 入れ子を使うと、 # select count(*) from (select c.id from C c left join S s on (s.id=c.id) where c.num = 1 group by c.id having count(s.id) >= 5) tmp; というふうに書け、 count ------- 2 (1 row) と表示されるのはわかりますが、入れ子を使わずに上のように表示させるにはどうしたらよいでしょうか？ よろしくお願いいたします。
レコード型の使用方法がわからないので、悪戦苦闘しております。。。 【やりたいこと】 ・あるテーブルのある項目でGROUP BYし、別の項目事に集計した結果を 　カラムとして出力 クロス集計と呼ぶのでしょうか？ 上記の結果表を取得出来るFUNCTIONを作成したいのです。 【サンプルデータ】 CREATE TABLE t1 ( col1 integer ,col2 integer ,val integer ); INSERT INTO t1 VALUES( 1, 1, 1, ); INSERT INTO t1 VALUES( 1, 1, 1, ); INSERT INTO t1 VALUES( 2, 1, 1, ); INSERT INTO t1 VALUES( 2, 1, 1, ); INSERT INTO t1 VALUES( 3, 2, 1, ); INSERT INTO t1 VALUES( 3, 2, 1, ); INSERT INTO t1 VALUES( 4, 2, 1, ); INSERT INTO t1 VALUES( 4, 2, 1, ); ※ここでcol1、col2ともどんなデータが入っているか、わからないとします。 なので、まずcol2をDISTINCTしたものを求めました。 SELECT DISTINCT col2 FROM t1; この結果をカーソルを使ってループし、動的にカラムを作成するＳＱＬを 作りました。 DECLARE cu refcursor; rec record; str text := 'SELECT col1 '; str2 text := ' FROM t1 GROUP BY col1 ORDER BY col1'; BEGIN OPEN cu FOR EXECUTE SELECT DISTINCT col2 FROM t1; LOOP FETCH cu INTO rec; IF NOT FOUND THEN EXIT; END IF; str := str || ', SUM( CASE WHEN col2 = rec.col2 THEN val END ) AS col_name' || rec.col2; END LOOP; CLOSE cu; RAISE INFO 'key = %', str || str2; 　動的に生成されたSQLを実行したい ------------------------------------------------------- ※ちなみに動的に生成されたＳＱＬはこんな感じになります。 SELECT col1 ,SUM( CASE WHEN col2 = 1 THEN val END ) AS col_name1 ,SUM( CASE WHEN col2 = 2 THEN val END ) AS col_name2 FROM t1 GROUP BY col1 ORDER BY col1; ------------------------------------------------------- あとがわかりません。。動的なカラムなので、どうやって取得すれば 良いのでしょうか？ レコード型を使うと上手くいくのでしょうか？ 試しにFUNCTION( func1 )の戻り値をRETURNS SETOF record として 内部で rec1 record; : : 　FOR rec1 IN EXECUTE str || str2 LOOP RETURN NEXT rec1; END LOOP; RETURN; SELECT * FROM func1(); とやってみたら、 ERROR: a column definition list is required for functions returning "record" となります。。。 カラムの定義が必要だと言われているんだと思いますが、カラムは 動的になっているので、どうすれば良いのでしょうか？？
画面で入力した文字列を登録したり、登録した内容の表示処理を作成しています。 画面で'''と入力した場合や、""を入力した場合に、うまく登録、表示できません。 これらを登録可能にするにはどうすればよいでしょうか？ よろしくお願いします。
はじめまして。 ２つ質問があります。 (1) SELECT col1, col2 FROM tblA （データは複数行） の結果表をFUCNTIONとして作成したいのです。 (2) また、そのFUNCTION( func1とします )から得られる結果を利用して 以下のような使い方がしたいのですが、可能でしょうか？ SELECT * FROM tblB b LEFT JOIN ( SELECT * FROM func1() ) a USING( col1 ) (1)で行き詰まっているので(2)を試すことも出来ません。。。 せめて(1)だけでも出来たら助かります。 よろしくお願いします
　tableを作成し、データを挿入したところ、tableは表示できているのにデータは挿入されませんでした。（rows 0） 　１年前は同じデータで(rows 3）と中身も挿入できていただけにいくら調べても解決策が見つかりそうにありません。１週間ほど、悩みましたが行き詰ってしまいました。 　分かりそうな方いましたら、一緒に考えてつけてください。お願いします。
unique | day_start | day_end --------+----------------------------+---------------------------- 1 | 2006-06-02 12:49:07.094831 | 2007-01-17 02:00:58.643778 2 | 2006-06-08 12:49:07.122762 | 2007-01-17 02:00:58.647793 3 | 2006-06-08 12:49:07.137901 | 2007-01-17 02:00:58.65177 4 | 2006-06-04 12:49:07.15393 | 2007-01-17 02:00:58.655763 5 | 2006-06-08 12:49:07.181952 | 2007-01-17 02:00:58.65976 6 | 2006-06-08 12:49:07.181952 | 7 | 2006-06-08 12:49:07.181952 | 2007-01-17 02:00:58.65976 上記のようなデータがあるとします。 day_startとday_endの間の日数の平均が知りたいです。 ただし、uniqueが7のレコードのように、 day_endがNULLのレコードもあり、その場合は、そのレコードの日数はday_startから現在日までとしたいです。 select avg(to_date(day_start,'yyyy/mm/dd') - to_date(day_end,'yyyy/mm/dd')) from a ※day_endがNULLのレコードもあり、その場合は、そのレコードの日数はday_startから現在日までとしたいです。 ↑この部分の条件式の書き方が分りません。 ご教示いただけないでしょうか。
はじめまして。 現在、以下のシステム構成でWEBシステムを作成しています。 ▼システム構成 －－－－－－－－－－－－－－－－－－－－－－ 　CentOS 5.97 　PHP　5.1.6 　POSTGRESQL 8.1.9 　Apache 2.2.3 －－－－－－－－－－－－－－－－－－－－－－ PHPを使用して、画像ファイルをバイナリデータに変換し DBに格納しようとしていますが、うまく動作しません。 ▼ソース －－－－－－－－－－－－－－－－－－－－－－ //画像をバイナリ型に変換します。 $fn = "../../images/uploaded/$image_name"; $cn = @file_get_contents("$fn"); $esc_image = pg_escape_bytea($cn); //DB登録に写真を登録します。 $s=""; $s.="insert into cbphoto("; $s.=" photoid,"; $s.=" photo"; $s.=") values ("; $s.=" $photoid,"; $s.=" '{$esc_image}'"; $s.=")"; $r=pg_exec($db,$s); －－－－－－－－－－－－－－－－－－－－－－ 小さいファイル（20kb以下前後）は問題なく格納できるのですが、 大きいファイルの場合は、格納されません。 ※ただし、上記のphotoidは格納されます。 　また、エラーメッセージも出力されていない様です。 マニュアルを確認するとバイナリ列は1GBまで格納できると 記載されていましたが、ファイルサイズが原因で格納できないのでしょうか？ また、他に原因があるのでしょうか？ （ラージオブジェクトじゃないとダメ等） 以上、お手数ですがよろしくお願いいたします。
現在、ＤＢをバージョンアップすべく検証等をしている最中なのですが。。。 現7.4.7 → 8.3.1へ移行に当たりpg_dumpのリストアにて作業をしているのですが、 pg_dumpパラメータに -c -D を附帯させてダンプした物をリストアするとサーバ用途モデルのマシンは信じられないくらい時間を要します。 附帯無し、所要時間約１分 → 附帯有り 所要時間約１３０分 附帯有りの所要時間は、１０年前のＰＣでさえも６０分で完了するのに その倍以上時間を要しています。 それで、そもそも同じPostgreSQLであるならばバージョンは違えども別のRDBMSではないので パラメータに -d -D は附帯させる必要性は、全く無いのでしょうか？ ご教授願えれば幸いです。宜しくお願い致します。
Ver7.4.19にて動作しているＳＱＬ文(max関数多用)を、最新Ver8.3.1にて実行すると５倍動作が遅いです。 Ver7.4.19(約0.7秒)：Ver8.3.1(約3.5秒)という具合です。 因みに、両ＤＢはチューニングを施している状態の結果です。 8.3系特有の記述の仕方があるのでしょうか？ max関数を多用していないＳＱＬは、明らかにVer8.3.1方が高速で応答しているのですが。。。。。 ご教授宜しくお願い致します。
PostgreSQL8.1.3にて、長いwhere句のあるSELECT文を実行したところ、 「server closed the connection unexpectedly」 のエラーとなってしまいました。 エラーとなったSQL文は317726文字で、 where句のin条件のリスト個数が非常に多くなっています。 試しに、in条件のリスト部分を減らし、 156000文字までSQL文を短く短くしたら、エラーは回避できました。 in条件ではなくor条件に変更すると、エラーとの境目のSQL文長は上記とは異なることから、 SQL文長だけが影響しているとは思えません。 SQL文を改修して、エラーを回避するにしても、ここらへんの限界値がわからないと改修できませんので、 改修の目安（信頼できるSQL文長がどのくらいなのかなど）をご教授お願いします。
素人です。申し訳ありませんが、ご教授お願いします。 pg_dumpコマンドでバックアップを採取する際はpostgresを止める必要があるのでしょうか？
データの文字化けについて質問したいと思います。 ＣＧＩプログラムからデーターベース（PostgreSQL）にアクセスした後に、 保存したデータをTeraTermで確認しようとすると、 保存されたデータは文字化けになっております。 そこで、毎回TeraTermを開く時に、 set client_encoding To \"UTF-8\"; をsetすると、文字は正常に表示されます。 一回だけsetして、ずっと使えるっていう設定はありませんでしょうか。 すごく、困ってます。 ご指導お願いいたします。
Debian GNU/Linux 3.1 で psql 8.1.2 を使用しています。 下記の要領でテーブルを作成し、２つのテーブルでIDが重ならないようにしようと意図しました。 CREATE TABLE t1 ( t1_id int2 UNIQUE NOT NULL, t1_name text NOT NULL ); NOTICE: CREATE TABLE / UNIQUE will create implicit index "t1_t1_id_key" for table "t1" CREATE TABLE CREATE TABLE t2 ( t2_id int2 UNIQUE NOT NULL, t2_name text NOT NULL ); NOTICE: CREATE TABLE / UNIQUE will create implicit index "t2_t2_id_key" for table "t2" CREATE TABLE CREATE FUNCTION unique_t12_id(int2) RETURNS BOOLEAN AS 'SELECT NOT ( EXISTS(SELECT * FROM t1 WHERE t1_id = $1) AND EXISTS(SELECT * FROM t2 WHERE t2_id = $1) );' LANGUAGE SQL; CREATE FUNCTION ALTER TABLE t1 ADD CONSTRAINT con_unique_t12 CHECK (unique_t12_id(t1_id)); ALTER TABLE ALTER TABLE t2 ADD CONSTRAINT con_unique_t12 CHECK (unique_t12_id(t2_id)); ALTER TABLE ところが実際は上手くいきませんでした。 INSERT INTO t1 VALUES(1, 'test1'); INSERT 0 1 INSERT INTO t2 VALUES(2, 'test2'); INSERT 0 1 INSERT INTO t2 VALUES(2, 'test3'); ERROR: duplicate key violates unique constraint "t2_t2_id_key" # ここまでは期待通りの挙動です INSERT INTO t2 VALUES(1, 'test4'); INSERT 0 1 ここで制約が働いて欲しかったのですが、素通りでINSERTされています。 下記のように、操作後の関数の戻り値は「偽」なのでこの操作は制約に引っかかると思うのですが 何故意図したように動かないのでしょうか。 SELECT *,unique_t12_id(t2_id) FROM t2; t2_id | t2_name | unique_t12_id -------+---------+--------------- 2 | test2 | t 1 | test4 | f (2 rows) スペースが詰まって読みづらい箇所もありますが、よろしくお願いします。
AccessからPostgresのデータをいじる時の利点、欠点はなんでしょうか？ ご教授お願い致します。
PostgresへA5SQLとか言うツールを使ってテーブルを２つCreateTableしました。 テストデータも入力しました。 あらためてAccessでPostgresのテーブルをリンクテーブルとして参照しデータを見ることが出来ましたが、Access上でリレーションが未定義でサブフォームを作成することが出来ません。 リレーションを１：多で作成しようと思うのですが、設定フィールドが真っ白でいじれません。 何故でしょうか？ 基本的にCreateTableするときに、なにやらリレーション設定する構文が必要だったのでしょうか？ 今は、CreateTableしか構文は記述されていません。 どなたかご教授ください。 よろしくお願いします。
こんにちは。postgreSQL初心者です。 古いサーバからpostgreSQLのデータを pg_dumpもしくは、pg_dumpallで取り出し、新しいサーバに入れようとしてるのですが、以下のようなエラーが出てデータが入ってくれません。 ERROR: invalid byte sequence for encoding "UTF8": 0x8a HINT: This error can also happen if the byte sequence does not match the encoding expected by the server, which is controlled by "client_encoding". 文字コードの問題だと思うのですが、バージョンの違いや基本的な設定も関係あるのでしょうか？ 環境 旧サーバ：Red hat Linux 9, postgreSQL 8.0 移転先サーバ：Fedora Core 6, postgreSQL 8.1 実行コマンド ダンプ pg_dump -d DB_NAME > FILE_NAME ※ファイルの中身はちゃんと出力されています。 リストア（？というのでしょうか？） 方法1: \i FILE_NAME > DB_NAME 方法2:cat FILE_NAME　 | psql DB_NAME 両方ともエラーがでて、テーブルはできていても一部の中身が入りません。 行き詰まってしまっています。どうか宜しくお願いします。 また、現在設定されている文字コードを調べる方法や、お勧めの参考ホームページがございましたら教えてください。
VISTAにインストールしたいのですが、 ローカルセキュリティポリシーをいじらないといけないみたいなんですが、ローカルセキュリティポリシーというものが私のパソコンにはありません。 このような場合はどうすればよいのでしょうか？
以下のようなデータがある場合の累計表示方法を教えてください。 ■入退会管理テーブル 　　　日付 |入会数|退会数 　　　2008/05/15| 10| 2 　　2008/05/16| 5| 1 　　2008/05/19| 2| 3 　　　: このデータを利用して日付ごとの会員累計を表示したいです。 ■表示したいSelect文　 日付 |入会数|退会数|会員累計 　　　2008/05/15| 10| 2| 8 　　2008/05/16| 5| 1| 12 　　2008/05/19| 2| 3| 11 : 会員累計の計算式は、 （当日の入会数-当日の退会数）＋（日付でソートした場合の1行前の会員累計数） です。 初歩的な質問ですみませんが、頭が困惑してしまってます。 よろしくお願いします。 　　
AccsessなどでDsum関数が用意されてますが、Postgreにはないようですね。 同じ関数を作りたいのですがわかりません。 どなたか教えていただけませんか。
新規テーブル作成時にあるカラムに別のテーブルの集計結果を入れることはできるのでしょうか？ 例えば、商品を定義したテーブルの中に、その商品が合計いくつ売れているかを集計するカラムを設置し、常に発注テーブルからその商品の合計発注数を引っ張って来て格納するイメージです。 テーブル作成時のみ集計するではなく、常に参照し動きがあれば数値が自動で変わるようになる方法を探しています。 いちいちselectで集計しなくても始めからカラムに集計値が入っていれば楽だなぁと思い質問しました。 どなたかわかる方いらっしゃいましたらよろしくお願いします。 商品テーブル CREATE TABLE product ( product_no SERIAL NOT NULL, （商品id） product_name VARCHAR(200) NOT NULL, （商品名） product_price VARCHAR(20) NOT NULL, （料金） product_sum INTEGER, （合計発注数）←ここ PRIMARY KEY(product_no) ); 発注テーブル CREATE TABLE order ( order_no SERIAL NOT NULL, （発注id） product_no INTEGER NOT NULL REFERENCES product(product_no) ON UPDATE CASCADE ON DELETE CASCADE,（商品id） order_num INTEGER NOT NULL,（その商品の発注数） order_date TIMESTAMP,（発注日） PRIMARY KEY(order_no) );
すみません。 order byで並び変えし最大値の項目のみ一意で抽出したいのですが 、 SELECT * from ta order by no,date1,date2; no | date1 | date2 ----+-------+------- 11 | 2008 | 0501 11 | 2008 | 0502 11 | 2008 | 0502 11 | 2008 | 0503 12 | 2008 | 0501 12 | 2008 | 0502 12 | 2008 | 0503 13 | 2008 | 0501 13 | 2008 | 0502 13 | 2008 | 0503 14 | 2008 | 0501 とあった場合、 no,date1,date2のorder by順番で並び変えし 11 | 2008 | 0503 12 | 2008 | 0503 13 | 2008 | 0503 14 | 2008 | 0501 とno項目に対し一つずつだけ出力したい場合どのようにしたらよいのでしょうか？ LIMITとoffsetだと１項目分しか出力されず困っております。 SELECT * from ta where no in (select no from ta group by no limit 1 offset 0) order by no,date1 desc,date2 desc limit 1; 宜しくお願い致します。
PDFファイルのデータベースをPostgreSQLで構築しています。 データベースの項目には「タイトル」「著者名」「注釈」などとともにラージオブジェクトとしてPDFファイルそのものをデータベースに取り込んでいます。PDFファイルのファイルサイズは10KB～20MB程度です。 最近、書店でPostgreSQLの本を見てもラージオブジェクトに関する解説を書いたものがほとんどなく、ひょっとすると将来的にはラージオブジェクトは廃止になるのではと危惧しています。 よく考えてみれば、データベースを初めに構築するときに、PDFファイルをファイルシステムのディレクトリ内に保存して、そのファイル名をデータベースで管理すれば良かったと今頃後悔しているところです。 ラージオブジェクトを使って、バイナリファイル（ここではPDF）を保管するメリットがあるのか？　ラージオブジェクトはPostgreSQLで今後も対応されるのか？　など、ご意見、感想などありましたらご教示ください。 ラージオブジェクトにメリットが無いなら、近い将来、あまりデータベースが巨大にならないうちに、PDFファイルを取り出すスクリプトなど作らなければと考えております。 よろしくお願いいたします。
順位を求めるSELECT文はどう記述すればいいのでしょうか？ ご教授お願いします。
VACUUMにてmax_fsm_pagesが不足している旨のメッセージが出ましたので、 不要領域を無くそうと vacuumdb -f を実施しましたが、 その後も同様のメッセージが表示されます。 max_fsm_pagesが不足している旨のメッセージが出た場合は、 一旦max_fsm_pagesの値を変更してVACUUM FULLを実施しなければ意味がないのでしょうか？ ちなみに、2回目のVACUUM FULL時に表示されたメッセージが以下になります。 ----------------------------------------------------------------- hoge=# VACUUM FULL; NOTICE: number of page slots needed (31360) exceeds max_fsm_pages (20000) HINT: Consider increasing the configuration parameter "max_fsm_pages" to a value over 31360. VACUUM -----------------------------------------------------------------
こんにちは。 現在の環境がOracle8iで、次のシステムがPostgreSQLで構築されることになりました。 今後に向けてPL/SQLを勉強しようと思ったのですが、PostgreSQLにはPL/pgSQLというストアドプロシージャが有ると言うことを知りました。 そこで質問なのですが、PL/SQLとPL/pgSQLは何か大きな違いは有るのでしょうか？ PL/SQLの勉強をすれば、PL/pgSQLも出来るようになるのかを教えていただけますでしょうか。
ALTER TABLE distributors ADD CONSTRAINT dist_id_zipcode_key UNIQUE (dist_id, zipcode); CREATE UNIQUE INDEX dist_id_zipcode_key ON distributors (dist_id, zipcode); この二つには違いがあるのでしょうか。
pl/pgsql にて。 select avg(price) into wk_price from uriage_tbl where ymdtm <= current_timestamp and ymdtm >= current_timestamp + '-4 hour'; と４時間前から直近まで価格の平均を求める構文があったとして、この-4 を、希望する任意の数字で変動したいと思っています。 -4 部分を変数にするには、どのようにすればよいか、お分かりの方がいらっしゃればお教え願います。 日付型の計算だと、上記のようにシングルクオーテーション内に引数を持たせるので、その中で変数を持たせるところでつまづいてます。
全角文字の文字間にある空白を削除したいです。 山　田　太　郎　→　山田太郎 下記のとおり置き換えようとしてもダメでした。 select replace('山　田　太　郎',' ','') from user_master; 左空白削除(ltrim() 関数)、右空白削除(rtrim() 関数)、左右空白削除(trim() 関数)などは、ありますが。。。　文字間の空白削除は、どうすれば良いのですか？
お世話になります。 メインテーブルAと詳細テーブルBがあります。 　テーブルA（ID・名前） 　テーブルB（ID・テーブルAのID・区分・内容） テーブルA:テーブルBは、1:Nの関係です。 またテーブルBがないものもあります。 名前あるいは名前と内容で検索をしたいのですが、 どのようにかけばいいのでしょうか？ テーブルAの形で結果がほしいのですが。 よろしくお願いします。
教えてください。 テーブルにVARCHAR型のデータがあるのですが、 その内容は、数値や文字です。 　2.5 　20 　0未満 などなど。 仮に4以下のデータを抽出する場合、 どのようにかけば「2.5」のデータがHITするのでしょうか？ この場合、「0未満」など文字のあるデータは検索対象から外れてもかまいません。 よろしくお願いします。
こんにちは。 PostgreSQL8.1.10を使っています。 pg_dumpでバックアップしたデータをpg_restoreでリストアするときに、エラーと警告が出てしまいます。 $ pg_dump -F c mydb > db.dump $ dropdb mydb $ pg_restore -C -d postgres db.dump pg_restore: [アーカイバ(db)] TOC処理中にエラーがありました: pg_restore: [アーカイバ(db)] TOCエントリ1514; 0 0 COMMENT SCHEMA public postgresのエラーです pg_restore: [アーカイバ(db)] could not execute query: ERROR: スキーマpublicの所有者でなければなりません Command was: COMMENT ON SCHEMA public IS 'Standard public schema'; pg_restore: WARNING: 権限を取り上げられませんでした pg_restore: WARNING: 権限を取り上げられませんでした pg_restore: WARNING: 権限は付与されませんでした pg_restore: WARNING: 権限は付与されませんでした 警告: リストアにてエラーを無視しました: 1 結果を確認した限りではリストアはされているようなのですが気になります。 このエラーはどういった理由で発生しているのでしょうか。 エラーを出さなくする方法はあるのでしょうか。 無視していいものならそれでも構わないのですが、理由は知っておきたいです。
こんにちは。 PostgreSQL+PerlでCGIを書いています。 テーブルのtimezonetz型の値の最大値を取り出して加工したいのですが、 うまくいかず悩んでおります。 単に最大値を取り出すだけなら、 SELECT max(lastdate) FROM table; でできました。しかし、この値を $sth->execute(); $last=$sth->fetchrow; として取り出しても、文字列となってしまいます。 perl側で加工するのは、フォーマットが環境によって違ったりする心配がありましたので、サーバー側でできないものかと思い、 SELECT EXTRACT(EPOS FROM TIMESTAMPTZ lastdate) FROM table; としてみましたが、 「"max"またはその近辺で構文エラー」とメッセージが出てしまいます。 こういった場合、いったいどのように書けばよいのでしょうか？ PostgreSQLのバージョンの確認方法がわからず、バージョンは不明なのですが、つい先日インストールしてもらったばかりなので、そう古いものではないと思います。 OSはunix(Solaris)です。よろしくお願いします。
こんにちは。 現在、バッチで伝票を登録するプログラムを組んでいます。 実施したい内容は、伝票番号を採番し、伝票テーブルと伝票明細テーブルにデータを書き込むと言う物です。 具体的には、以下のテーブルです。 1.TRN_DENPYO 　DENPYO_NO 　DENPYO_HIDUKE 2.TRN_DENPYO_MEISAI 　DENPYO_NO 　DENPYO_MAISAI_NO 　DENPYO_SYOHINCD ※TRN_DENPYOのDENPYO_NOはserialです。 そこで、TRN_DENPYO にレコードを追加した後、自動的にカウントアップされるTRN_DENPYOのDENPYO_NOを取得するために LASTVAL()を使用したいのですが、うまく行きません。 以下、実際に記述しているSQL文です。 $sql = 'INSERT INTO "TRN_DENPYO"("DENPYO_HIDUKE")VALUES(' . $denpyo_hiduke . ')'; $db->query($sql); $sql = 'SELECT LASTVAL()'; $result =& $db->query($sql); while($row = $result->fetchRow(DB_FETCHMODE_ASSOC)) { $denpyo_no = $row['LASTVAL()']; } echo $denpyo_no; この時点で、$denpyo_no の値が表示されると思っているのですが、表示されません。 どなたか教えて頂けませんでしょうか？ ちなみに環境は、PostgerSQL8.2 php5を使用しています。
こんにちは、SELECT文での絞り込みでうまく行かないので質問させてください。 現在、以下の2つのテーブルがあります。 これらのテーブルからメールアドレスを取得したいと考えています。 1.MST_USER <KEY--> USER_ID MAILADDRESS -------+----------------- 1|hoge1@example.com 2|hoge2@example.com 3|hoge3@example.com 2.MST_USER_SETTING <KEY------------> USER_ID SELECT_ID OPTION_ID -------+---------+--------- 1|BUNRUI |KYOUSHI // 教師 1|GAKUNEN |2 // 2年生 2|BUNRUI |HOGOSYA // 保護者 2|GAKUNEN |2 // 2年生 3|BUNRUI |GAKUSEI // 学生 3|GAKUNEN |2 // 2年生 やりたい事は、 MST_USER_SETTINNGから2年生の教師のUSER_IDを取得して MST_USERのMAILADDRESSを取得したいという事です。 一応、以下のようにやってみたのですが、 SELECT "MST_USER"."MAILADDRESS" FROM "MST_USER" LEFT JOIN "MST_USER_SETTING" ON "MST_USER_SETTING"."USER_ID" = "MST_USER"."USER_ID" WHERE ("MST_USER_SETTING"."SELECT_ID" = "BUNRUI" AND "MST_USER_SETTING"."OPTION_ID" = "KYOUSHI") AND ("MST_USER_SETTING"."SELECT_ID" = "GAKUNEN" AND "MST_USER_SETTING"."OPTION_ID" = "2") ) WHERE句の指定が悪いせいか、正しく取得できませんでした。 以上、よろしくお願い致します。
例えば select * from ((t1 left join t2 on t1.a=t2.a)left join t3 on t1.a=t3.a) where b.t1='y'; という風にカッコがついて記入しにくくなります。 ４つの場合はさらに深刻です。 簡単な記法はないのでしょうか?
テーブルに格納された項目A及びBが共に重複する項目のみ 抽出したいのですがSQL文が上手く書けません。 初歩的なことで大変申し訳ないのですが、有識者様ご教授願います。 以下の例ですとNo1及び2を抽出したいのですが上手く 抽出できません。 　No　 項目A　　項目B -----+--------+------------- 1 A1111 B1111 2 A1111 B1111 3 A1111 B2222 4 A2222 B1111
下記のようなテーブルがあるとします。 それぞれの人の最高得点であるレコードを抽出したいのですが可能でしょうか。 テーブル：result no id point date -------------------- 1 A 60 ... 2 A 70 3 B 50 4 B 90 期待出力 no id point date ------------------- 2 A 70 ... 4 B 90 自分でも色々考えたつもりですが、例えば select max(point) from result group by id; とすると 70,90 という値は抽出されますが、該当レコードの全カラムを出力させたいです。 もし同じidで同じpointのレコードがあった場合は、dateの新しいほうを優先したいです。 id,point,dateがまったく同じレコードは存在しないと仮定します。 この他にもdistinct等も考えましたが、指定したカラムが重複した場合どのレコードが選択されるかは 不定のようですので使えそうにありません。 そもそもSQLだけでこのような出力が可能かどうかもわかりません…。 テーブルの設計が悪いというのもあるのでしょうか。 どなたかご助言くだされば幸いです。
WindowsにPostgresSQLをインストールしているのですが、サービス起動オプションの指定の仕方がわかりません。 -iオプションを付けて起動すれば、TCP/IP接続できるようになると知って、やってみようとしていて、試してみている次第です。 サービス起動のショートカットに、以下のようなショートカットがあるのですが、 C:\WINDOWS\system32\net.exe start pgsql-8.3 これに単純に後ろに-iを付けてみても駄目なようです。 どなたか方法をご教示ください。 環境は以下の通りです。 WindowsXP HomeEdition Version2002 PostgreSQL 8.3
select * from table1 a,table2 b where a.field1=b.field1; とできますが select * from table1 as a left join table2 as b on a.field1=b.field1; とできません。 joinの場合にテーブル名の別名を使う方法を教えてください
テーブルにchar(6)でyymmdd形式の日付を格納する領域を作成しております。この格納された日付から1週間以上過ぎたもののみ抽出したいのですが、sqlの構文を上手く作成できず大変こまっております。 有識者様大変お手数ですがご教授を頂けないでしょうか？
いつも参考にしております。ありがとうございます。 さて、WindowsXPにPostgreSQL8.1をインストールしたのですが、起動させ、パスワードを入力すると画面が消えてしまう現象が起きています。 このため、再度入れなおそうとするのですが、「データベースクラスタの初期化」画面で、「データディレクトリが存在します」といったメッセージ（英語）が現れ、パスワードを設定せずに（クラスタを初期化せずに）次に進むようになってしまいます。（クラスタ初期化せずにインストールを完了させても、上記エラーが再発します） 最初のインストールで、そこのパスワードをタイプミスした可能性もありますので、「データベースクラスタの初期化画面」で再度パスワードを設定したいのですが、どのようにしたらよろしいでしょうか？ ちなみに、再インストール前には、 　PostgreSQLの削除 　ユーザーアカウントPostgreの削除 　Document&settingsの下のPostgresフォルダ削除 を行っています。 基本的な質問で、恐縮ですが、どうぞよろしくお願いいたします。
PostgreSQL8.0.8の環境です。知り合いから頼まれての作業なのですが、２～３日前からPHPコネクションエラーが発生し、SSHからpostgres権限で該当DBにログインしようとしたところ、 psql: FATAL: conversion between LATIN1 and EUC_JP is not supported と表示され、PSQLログインが出来ません。PgAdminやCSEでも同じメッセージです。 １．この状態から何とかログインできる方法はあるのか？ ２．バックアップが無いようなので、このDBからテーブルやフィールド項目をGETする方法はあるのか？最悪、これまでのデータを破棄して、新しくDBを作成し、ガラだけでも作りたい。pg_dump をやろうとしても、同じFATALエラーが出ます。 ３．何が原因でこれが起きたのか？変な文字が入り込んだ？ 経験された方、わかる方がいらっしゃればと思います。
をインストールしようとしたのですが インストールの最後のほうで 「initdbの実行に失敗しました」 というエラーが出ました。 そのときのinitdb.logには このアプリケーションのサイド バイ サイド構成が正しくないため、アプリケーションを開始できませんでした。詳細については、アプリケーションのイベント ログを参照してください。 と書いてありました。 この状況をどのように解決したらいいでしょうか？ PostreSQL3.0ではなくてPostgreSQL8.3.0でしたので再質問しました。
SELECT * FROM テーブルA LEFT OUTER JOIN ( SELECT * FROM テーブルB WHERE テーブルB.列X IS NOT NULL) as テーブルB ON テーブルA.列A = テーブルB.列A SELECT * FROM テーブルA LEFT OUTER JOIN テーブルB ON テーブルA.列A = テーブルB.列A WHERE テーブルB.列X IS NOT NULL 上のSQLも下の同じ事をしてると思うのですが 上では検索結果が10件出た場合 下では0件になってしまいます。 SQL自体シンプルで間違っていないと思うのですがなぜでしょうか？
データベースの構造とインデックス、検索クエリー 全て同じ条件でテストサーバと実際のサーバで 検索を行っているのですが以下のような結果がでます。 なぜ以下の様に10倍まで差が生まれるのかを 教えていただければと思っております。 違う箇所としては、サーバのスペックですが 実際のサーバのCPU：Xeon 3.2GHz メモリ：2GB テストサーバのCPU：Pentium4 3.2GHz　メモリ：2GB となります。 //テストサーバでの結果 Limit (cost=99427.05..99427.25 rows=4 width=112) (actual time=4022.29..4022.31 rows=4 loops=1) -> Unique (cost=99427.05..99438.37 rows=226 width=112) (actual time=4022.29..4022.30 rows=5 loops=1) -> Sort (cost=99427.05..99432.71 rows=2265 width=112) (actual time=4022.29..4022.29 rows=6 loops=1) Sort Key: s.saorderid, s.saserialid, o.odlastupdate -> Merge Join (cost=96997.70..99300.85 rows=2265 width=112) (actual time=3363.93..4022.11 rows=40 loops=1) Merge Cond: ("outer".odid = "inner".saorderid) -> Sort (cost=8054.50..8059.58 rows=2033 width=68) (actual time=13.52..13.55 rows=38 loops=1) Sort Key: o.odid -> Index Scan using order1_odctmid_index on order1 o (cost=0.00..7942.81 rows=2033 width=68) (actual time=13.13..13.47 rows=38 loops=1) Index Cond: (odctmid = 3403::bigint) -> Sort (cost=88943.20..90075.54 rows=452935 width=44) (actual time=3344.05..3688.13 rows=452002 loops=1) Sort Key: s.saorderid -> Seq Scan on sale s (cost=0.00..12792.35 rows=452935 width=44) (actual time=0.02..756.03 rows=452935 loops=1) Total runtime: 4050.02 msec //実際の本番サーバでの結果 Limit (cost=73933.37..73933.39 rows=1 width=128) (actual time=43102.58..43102.59 rows=4 loops=1) -> Unique (cost=73933.37..73933.39 rows=1 width=128) (actual time=43102.58..43102.59 rows=5 loops=1) -> Sort (cost=73933.37..73933.38 rows=5 width=128) (actual time=43102.57..43102.58 rows=6 loops=1) Sort Key: s.saorderid, s.saserialid, o.odlastupdate -> Nested Loop (cost=0.00..73933.32 rows=5 width=128) (actual time=998.20..43102.38 rows=40 loops=1) Join Filter: ("outer".odid = "inner".saorderid) -> Index Scan using order1_odctmid_index on order1 o (cost=0.00..18.12 rows=4 width=68) (actual time=6.01..6.99 rows=38 loops=1) Index Cond: (odctmid = 3403::bigint) -> Seq Scan on sale s (cost=0.00..12797.54 rows=448254 width=60) (actual time=0.01..756.51 rows=455437 loops=38) Total runtime: 43102.69 msec もしクエリー文もあった方がよければ お知らせ下さい。 すみませんが、どなたか教えて頂ければ と思います。よろしくお願い致します。
PgSQLで関数を作成したいのですが、記述方法がわかりません。 結果がbool trueならint 1 結果がbool falseならint 0 を返すようなものを作りたいのですが、どのように記述すれば良いのでしょうか。 CREATE FUNCTION BOOL2INT(boolean) RETURNS integer このあとの記述が複雑でわかりません
powergresで開発していて、困った点が出たので質問致します。 質問内容 　powergresでalter文でカラムの追加・削除等を行うと、 　追加したカラムに紐づくテーブルのデータが消えてしまったりすることはあるのか？ 　（alter文でカラムを削除した時のデータ以外のデータ） です。 なぜこんな質問をしたかというと 現在webツールからリクエストを送るとカラムの追加・削除ができるという 処理を作成しようとしています。 環境は ・Java1.5 ・powergres5.0 ・Apache + tomcat です 個人的な見解では、データ削除・テーブルごと削除の命令を出さない限り データは消えることなんてないと思っているのですが・・・・ 私の能力ではお客さんに論理的に説明したいのですが、 まだ論理的に説明できない状態です。 ・データが消える・消えない。 ・その詳細な理由がほしいです。 大変申し訳ございませんが、よろしくお願い致します。
こんばんわ。 現在、C言語でPostgresSQL8.3を使用しようとしています。 CコンパイラはBorland C++5.5を利用しています。 　※OSはWindowsXP-Pro/SP2です Cソースは、単純にデータベースに接続、SELECT処理、切断を行なう だけのものですが、コンパイル時に以下のリンクエラーが表示されます。 Borland C++ 5.5.1 for Win32 Copyright (c) 1993, 2000 Borland test01.c: Turbo Incremental Link 5.00 Copyright (c) 1997, 2000 Borland Error:外部シンボル'_PQsetdbLogin'が未解決(D:\TEST01.OBJ が参照) Error:外部シンボル'_PQstatus'が未解決(D:\C\TEST01.OBJ が参照) Error:外部シンボル'_PQexec'が未解決(D:\TEST01.OBJ が参照) Error:外部シンボル'_PQresultStatus'が未解決(D:\TEST01.OBJ が参 照) Error:外部シンボル'_PQerrorMessage'が未解決(C:\TEST01.OBJ が参 照) Error:外部シンボル'_PQgetvalue'が未解決(C:\TEST01.OBJ が参照) Error:外部シンボル'_PQclear'が未解決(C:\TEST01.OBJ が参照) PostgresSQLのインストール後に行なった設定としては、 コンパイラ側のbcc32.cfg内に、 -I"PostgresSQLインストールDir\include" -L"PostgresSQLインストールDir\lib" を追加しただけです。 もしこれ以外に必要な設定がありましたらご教示頂けますよう お願い致します。
psqlコマンドでDBへの接続を行っております。 /usr/local/pgsql/bin/psql -U postgres -h xxx.xxx.xxx.xxx testdb 上記コマンドをコマンドラインから実行するとパスワードが聞かれます。 パスワード設定をmd5にしているためですが、 その設定を変更せずコマンドラインでパスワードを渡すなどしてパスワードの入力を促す処理をスルーしたいのですが全然出来ません。 どのなたかご存知の方、いらっしゃいましたらご教示の程お願い致します。
現在php+PostgreSQLでのアプリケーション制作を勉強中です。 で、参考書にあるMysql用に書かれたプログラムを参考に、PostgreSQL用に書き換える、といった勉強方法をとっているのですが、どうしても直せない箇所があるので、どなたお力添えいただけませんでしょうか？ Mysql用サンプル <?php // =========================================== // 設定 // =========================================== // サーバ／データベース／ユーザ／パスワード $sv = "localhost"; $dbname = "xx"; $user = "xxxx"; $pass = "xxxx"; // 表示文字コード define("ENCDISP", "EUC-JP"); // =========================================== // 　パラメータの取得 // =========================================== $act = (isset($_REQUEST["act"])) ? $_REQUEST["act"] : ""; // ================================================= // 　処理開始 // ================================================= ?> <?php conndb(); ?> <html> <head> <meta http-equiv="content-type" content="text/html; charset=EUC-JP"> <title>アンケート</title> </head> <body> <?php // -- ページ内容の表示 switch ($act) { case "a": // 回答一覧表示 gamen_iti(); break; default: // 質問表示 gamen_q(); } ?> </body> </html> <?php closedb(); ?> <?php // ================================================= // -----　アンケート質問画面 // ================================================= function gamen_q() { global $conn; $sql = "SELECT * FROM an ORDER BY id desc"; $res = mysql_query($sql, $conn) or die("データ抽出エラー"); if (mysql_num_rows($res) <= 0) { return; } $row = mysql_fetch_array($res, MYSQL_BOTH); ?> ・・・ 上記の 「if (mysql_num_rows($res) <= 0) { return; } $row = mysql_fetch_array($res, MYSQL_BOTH);」の部分です。 これを単純に↓に変えてみたもののもちろんエラーとなり、 「if (pg_num_rows($res) <= 0) { return; } $row = pgsql_fetch_array($res, PG_BOTH);」 以後、試行錯誤しているのですが、どうにもこうにも打開できません。 どなたか、ぜひとも教えていただければ大変たすかります。 よろしくお願いいたします。 プログラムをスペースの都合上、一部抜粋のような形になっておりますが、もっと続きをみてみないとどうにもならない。。ということであれば、ご一報いただければと存じます。
仮に以下２つのテーブルがあったとします。 (両方とも、JOINなどで結合されたテーブルです) tableA |id|nedan|jitubai| |01|1000|900| |02|1500|1000| |03|2300|2000| tableB |id|nedan|jitubai| |01|1500|1300| |02|1500|1200| |03|2300|2200| この２つをUNIONALLで結合すると以下のようになると思うのですが、 |id|nedan|jitubai| |01|1000|900| |02|1500|1000| |03|2300|2000| |01|1500|1300| |02|1500|1200| |03|2300|2200| これを何とかして、idを軸にnedanカラム、jitubaiカラムの値を足して出したいのです。以下の感じです。 |id|nedan|jitubai| |01|2500|2200| |02|3000|2300| |03|4600|4200| どうすれば良いのでしょうか……。 何か良い知恵をお借りできれば、と思っています。 宜しくお願い致します。
環境はｘｐ、apache2、php5、Postgresql8.2です。 1台のPCをサーバ＆クライアントにしています。 ただ今PHPとPostgresqlの勉強をしています。 いつも質問に答えてくれてありがとうございます。 bool型のデータを yの場合は「○」 nの場合は「×」 で表示するために以下のようにしました。 －－－－－－－－－－－－－－－－－－－－－－－－－－－ $sql_limit2 = "SELECT m_lecturehistory.lecturecode, CASE WHEN m_lecturehistory.syukketu='y' then '○' else '×' end as syu FROM m_lecturehistory;"; $sql_limit = mb_convert_encoding($sql_limit2,"EUC-JP","eucJP-win"); $rs_limit = pg_query($d_base,$sql_limit) or die("quary faild sql_limit"); －－－－－－－－－－－－－－－－－－－－－－－－－－－ ところが「○」「×」が表示されず 「??」になってしまいます。 文字コードは、 ポスグレとソースは「EUC-JP」 表示は「UTF-8」です。 ご教示して頂けたら幸いです。
time ---------------------------- 2006-12-01 00:00:00.323861 2006-12-01 00:00:00.710523 2006-12-01 00:00:00.963864 2006-12-01 00:00:01.45068 2006-12-01 00:00:01.512551 2006-12-01 00:00:02.17493 2006-12-01 00:00:02.731608 2006-12-01 00:00:02.873651 2006-12-01 00:00:03.398863 2006-12-01 00:00:03.438085 2006-12-01 00:00:03.833481 このようなレコードが格納されているテーブルに対して、例えば1秒ごとにレコードを集計してその集計時間と集計数を表示する　といったことをどのようなSELECT文を作れば良いのでしょうか？ SELECT COUNT (time) FROM table1 where ～ と書いて条件文を一秒ごとに設定した文を何度も繰り返し実行してみたのですが、処理を完了するのにかなり長い時間を要したのでこの方法は断念しました。 短時間でこの処理が行えるような文があったら教えてください。 お願いします。
お世話になっております。 Windows版のPostgreSQL8.1を使用しています。 Windowsのバッチファイルで毎週自動実行で pg_dumpによるバックアップを取得しようと思っています。 バックアップは正常に取得できるのですが、 どうしてもログファイルが出力できません。 手動でバッチを動かすと、プロンプトには表示が出ます。 『pg_dump: テーブル×××の内容をダンプしています』 のように。それをどうやったらファイルに残せるかを知りたいです。 実行しているコマンドは、 pg_dump.exe -f "DBバックアップファイル" -i -v -h ホスト名 -p ポート -U "ユーザ名" -F c "DB名">>"ログファイル名" としています。 以上です。宜しくおねがいします。
現在2つのサーバにて全く同じselect文で 速度検証を行っております。 仮にAサーバ（以降A）　Bサーバ（以降B） とします。 Aのスペックは CPU：Intel(R) Xeon(TM) CPU 3.20GHz メモリ：2GB Bのスペックは CPU：Intel(R) Pentium(R) 4 CPU 2.80GHz メモリ：2GB select文は以下の様な形です select * from t1,t2 where t1id=t2id～ 検索データ量 t1,t2共に40万件ほど ちなみにA側においては既に稼動しており 軽めの何らかのアクセスは常にある状態です。 上記の条件の元select文を動かした場合 Aについては5分以上かかる状態 Bについては5秒ほどで検索できます。 ココまで差がでてしまうのは何が原因と 考えられますでしょうか？ 追記 A側で検索を基本(テーブル結合等)を変更せずに 条件だけを変更した場合数秒で出るようになります。 情報として足りない事がありましたら すみませんが、ご指摘願います。 どなたかヒント(気づき)でも構いませんので お教えお願い致します。
PostgreSQL 8.1.4を使用しています。 仕様の変更によりテーブルへフィールドの追加を行なったのですが、このフィールドの位置を変更する事はできるのでしょうか。 DDL文を整えて作った空のテーブルへデータをリストアしようとしましたがうまくできませんでした。 よろしくお願いします。
PostgreSQLで、自動採番(serial)について質問です。MAX_VALUEを超えた場合、MIN_VALUE(1)という記載がありますが、対象テーブル上に１が存在した場合は、どうなってしまうのでしょうか? ２が空いてた場合、２が使用されるのでしょうか？ 4バイト(約２１億なので、あまり問題がないかもしれませんが、）ユーザに、その質問を投げかけられ、困っております。
サーバＡ（OS:Linux Fedora Core 4、データベース:PostgreSQL 8.0 で運用しているシステムがあり、毎日そのデータを下記のdumpコマンドで PostgreSQLの全データをバックアップしています pg_dumpall > postgres.out　 サーバＡを触るのは怖いので、別のマシンＢ(Windows-Xp)に postgresql-8.2.6をインストールしました。 このバージョンは、postgresqlとともに、pgAdmin3というGUIの管理 ツールもついていると聞きここに、サーバＡからバックアップされている postgres.outをrestoreして pgAdmin3でデータベース・テーブル等をみようとしています （postgres.out）を使ってのリストアの仕方は (1)（postgres.out）をpostgresqlの/binディレクトリの中に入れる (2)psqlのメニューから次のコマンドを打つ psql -d manmg -f postgres.out 　 (3)pgAdmin3を立ち上げるとサーバＡのDBは追加されているようなのですが 　テーブルは(0)となって見えません マシンＢの方のPostgreSQLについてはインストールしたままでサーバＡ のpostgresqlの設定等は何もしていません 何か設定する所はあるのでしょうか 上記手順でlinuxから吐出されたバックアップデータをWindowマシンに リストアする方法は間違っていないのでしょうか よろしくお願いします。
下記のようなテーブルがあります。 テーブル名：masta フィールド：hinmei,tani,hiduke,ryou これを 品名　｜　単位　｜1月｜2月｜3月｜ A　　 ｜リットル｜10｜20｜30｜ B　　 ｜グラム　｜12｜13｜14｜ のようにてんかいしたいのです。 現在SQLは SELECT Hinmei ,Tani ,Hiduke ,SUM(ryou) as ryou FROM masuta WHERE hiduke BETWEEN '200801' AND '200812' GROUP BY Hinmei ,Tani ,Hiduke このようにしてますが、横てんかいの方法が分かりません。 どのようなSQLをかけばいいのでしょうか？
下記のようなテーブルがあります． テーブル名：logdata フィールド： １）日付: timestamp with time zone ２）発信元IPアドレス： inet ２）ポート番号: integer 具体例はつぎのようなものです． 2008/01/14 00:00:00, xxx.xxx.xxx.xxx, 445 2008/01/14 00:00:01, xxx.xxx.xxx.xxx, 135 ・ ・ ・ 2008/01/18 23:59:59, xxx.xxx.xxx.xxx, 445 今回，発信元IPアドレスは特に考慮せず， １時間ごとの各ポートへのアクセス数を出力させたいのですが， どのようなSQLを書けばよろしいでしょうか？
複文によるSQLインジェクションを防ぐには、ユーザー入力値から「;(コロン)」を除去すればOKでしょうか？ ご存知の方がいらっしゃいましたら教えてください。 よろしくお願いいたします。
ゼロ割りを回避する一般的な関数、方法があれば教えて頂けないでしょうか？ 値が「0」の場合は除算を行わないで、そのまま「0」を返却するような関数はあるのでしょうか？ インターネットで調べたのですが、見つかりませんでした。 有識者の方、よろしくお願いします。
例えば、「TEST」テーブルに列 A,B,C が存在する場合、 SELECT A,B,C FROM TEST; で、A,B,C を出力できますが、TEST テーブルに存在しない列 D を固定値「あああ」 で出力する事は可能でしょうか？ 可能でしたら、SQLの記述を教えて頂けないでしょうか？ 有識者の方、よろしくお願いします。
皆さん教えてください。 zaiko と testBと言うテーブルに商品IDカラムを入れておき この二つのテーブルを結合して商品データはあるけど 在庫がない物だけを抽出したいのですが、その場合どのような SQLになるでしょうか？？ 商品データも在庫もある場合下記のSQLで商品情報と在庫データが 出てくるのですが、その逆と言うか、商品情報は登録してあるが、 在庫テーブルに登録されていない商品情報を検索したいと思っております。 select zaiko.*,product_data.* from zaiko inner join product_data on zaiko.nyuko_item_code = product.item_code ではどうかよろしくお願いします。
環境はｘｐ、apache2、php5、Postgresql8.2です。 1台のPCをサーバ＆クライアントにしています。 ただ今PHPとPostgresqlの勉強をしています。 いつも質問に答えてくれてありがとうございます。 データベースクラスタが破損したようなので postgresSQLを再インストールしようと思います。 その時、今まで作成したデータベースをバックアップをしたいのですが Windoes版でどのようにしたら 宜しいですか？
http://itpro.nikkeibp.co.jp/members/ITPro/oss/20 … このページにかかれている「Constraint Exclusion」という方式を使用してテーブルのパーティショニングを行ったつもりなのですが、あるデータをSELECT文で検索してみても全てのテーブルに対して検索してしまっているようなのです。 このページに書いてある通りにテーブルを作成したのですが、どこに問題があるのか分かりません・・・。 何か駄目な所があるならば教えてください。お願いします。
皆様、新年明けましておめでとうございます。 早速ですが、date型でのbetweenについて教えてください。 SQL文 SELECT * FROM test WHERE date between date '2007-12-01' and date '2007-12-31' を発行すると、2007-12-31のレコードがあるのに該当しません・・・ 試しにSQL文を SELECT * FROM test WHERE date between date '2007-12-01 00:00:00' and date '2007-12-31 23:59:59' としても2007-12-31のレコードは検索されません・・・ SQL文を SELECT * FROM test WHERE date between date '2007-12-01' and date '2008-01-01' にすると2007-12-31が該当するのですが、 SELECT * FROM test WHERE date between date '2007-12-01' and date '2007-12-31' では2007-12-31のレコードは該当しないものでしょうか？？ select * from test where num between 10 and 100 とした場合では、num が 10 ～ 100 のものが問い合わされますよね？？ date型になるとこうならないのでしょうか？？ よろしくお願いします。
環境はｘｐ、apache2、php5、Postgresql8.2です。 1台のPCをサーバ＆クライアントにしています。 ただ今PHPとPostgresqlの勉強をしています。 いつも質問に答えてくれてありがとうございます。 以下のようなテーブルに insert処理でデータを追加したいと思っています。 －－－－－－－－－－－－－－－－－－－－－－－－－－－ CREATE TABLE m_lecturehistory ( lecturecode text, lecturedate date, ・ ・ ・ －－－－－－－－－－－－－－－－－－－－－－－－－－－ $sql = "insert into m_lecturehistory (lecturecode, lecturedate ) values ('{$line[0]}','2008/1/1');"; このようにしてinsert処理をすれば正常に追加できます。 ただ、以下のようにして 変数からDATE型に追加しようとするとエラーになります。 －－－－－－－－－－－－－－－－－－－－－－－－－－－ $line[1] = "2008/1/1"; $sql = "insert into m_lecturehistory (lecturecode, lecturedate ) values ('{$line[0]}',"{$line[1]}");"; 対処方法をご存じでしたら、 ご教示して頂けたら幸いです。
postgresql 7.4のスーパーユーザで以下のコマンドを実行しましたが ALTER SCHEMA name RENAME TO newname;は実行できますが ALTER SCHEMA name OWNER TO newowner;シンタクスエラーで所有者を変更できません。7.4では変更できないのでしょうか？
PostgreSQL 8.1.3をインストール時に以下のエラーが出ます。 ダイアログ１ ---- タイトル＞内部のエラー メッセージ＞Failed to get system metrics for terminal services: 87 ---- ダイアログ２ ---- タイトル＞致命的なエラー メッセージ＞インストーラは、エラーのために途中で終わりました。 ---- どうすればインストールできるようになりますか？
PostgreSQL初心者です。 現在PostgreSQLを利用してサーバに接続しようと思っているのですが、 一向に接続できません。 利用しているレンタルサーバー会社で 「弊社サーバのPostgreSQLは、UNIXドメインソケット経由での接続のみをサポートしており、TCP/IP経由での接続はサポートしておりません。」 といわれています。 良く分からないなりに推測するに、 UNIXドメインソケット経由での接続のみでTCP/IP経由での接続はサポートしていないということは、 入力したDBサーバの、localhost又は127.0.0.1という文字は使えないということなのだと判断しています。 (このことがTCP/IP経由での接続？？) だとすると、UNIXドメインソケット経由で接続したい場合は どのようにすればいいのでしょうか。 ちなみにレンタルサーバーですので、設定自体を変えることはできません。 このlocalhost又は127.0.0.1という入力方法以外で解決できる入力方法などはあるのでしょうか？ 宜しくお願い致します。
お世話になります。 データベースには、「name1」「name2」と ２つのフィールドに姓名が分かれて入っています。 検索で、「山田太郎」と入力されたとき、 「name1」「name2」を結合した列で抽出したいのですが どのようにSQLを書けばいいのでしょうか？ よろしくお願いします。
以下のようなクエリーを作成して検索を 行っているのですが、どうしても抽出が出来ないくらい 遅くどの部分で遅くしているのかが分からないため、 どなたか教えてもらえないでしょうか？ ※足りない情報があればすみませんが、仰ってください。 なるべくプログラム（PHP等）を使わずクエリのみで 行いたいので、PHP云々の話しは無しでお願い致します。 最初の抽出テーブル(osi)と次の抽出テーブル(osday) をそれぞれ個別で動かすと普通の速度で抽出が旨く行きます が、それらをくっつけた形 select (省略) from osi,osday where osi.id=osday.id; とすると、抽出が行えない又は非常に遅いとなります。 ///////// 実際のクエリー文です ///////// select osday.odid,odctmid,saitemname,startday,endday from ( select odid,saitemname from order1 as o,sale as s where o.odid=s.saorderid and (o.odshipdue >= '2007-12-1 00:00:00' and o.odshipdue <= '2007-12-18 23:59:59') and (o.odcancelflag='0' or o.odcancelflag is null) and o.odclass<'4' and s.saregular='1' and s.saitemcode in (select itcode from item where itcategory='1') and odmakeday is not null ) osi , ( select odid,max(odctmid) as odctmid,to_char(min(o.odshipday), 'YYYY-MM-DD') as startday,to_char(max(o.odshipday), 'YYYY-MM-DD') as endday from order1 as o,sale as s where o.odid=s.saorderid and (o.odshipdue >= '2007-12-1 00:00:00' and o.odshipdue <= '2007-12-18 23:59:59') and (o.odcancelflag='0' or o.odcancelflag is null) and o.odclass<'4' and s.saregular='1' and s.saitemcode in (select itcode from item where itcategory='1') and odmakeday is not null group by o.odid ) osday where osi.odid=osday.odid; ///////////////////////////////////////////
フラグの文字型は文字型、数値型のどちらを使うのが一般的なのでしょうか？その理由も教えていただけるとうれしいです。 [例] フラグ　0：未承認 フラグ　1：承認 未承認のものを選択したいとき SELECT * FROM TABLE_NAME WHERE FLAG = 0 /* 文字型のときはWHERE FLAG = '0' */
PostgreSQLのpg_dumpを用いたバックアップで困っています。 OSはVineLinux 2.2.17-0vl10です。 あるサーバ(PostgreSQL7.0.2)のデータベースtest_db(EUC_JP)に対して、 pg_dump -D -v -i -f test.dump test.db でダンプファイルを作成しました。 COPYでは不確実な場合があるということでINSERT文で出力しました。 (データの日本語の部分が数字に変換されています) それを別のサーバ(PostgreSQL8.2.5)のデータベースtest2_db(EUC_JP)にリストアしました。 psql test2_db < test.dump すると、"(株)"という文字を含む文字列が化けてしまっていました。 同じレコードの他のカラムは大丈夫です。 このような場合の対策がありましたら教えていただきたいと思います。 宜しくお願いします。
環境はｘｐ、apache2、php5、Postgresql8.2です。 1台のPCをサーバ＆クライアントにしています。 ただ今PHPとPostgresqlの勉強をしています。 pgadmin3で、「object」という列を 「term」という列の後に追加したいと思い 以下のSQLを発行しました。 ALTER TABLE "m_lecture" ADD "object" text NOT NULL AFTER "term"; 以下のようなエラーになります。 ERROR: syntax error at or near ""term"" SQLステート:42601 文字:52 ご教示して頂けたら幸いです。
いつもお世話になっております。 現在、2台のPCにpostgreSQL8.2.5をインストールしpgpool-II-2.0.1を入れてレプリケーション機能を試しているのですが，一旦、セカンダリサーバーを止めて、マスタサーバーで処理をし、セカンダリサーバーを起動させてみて、DBを確認しましたら、両サーバーのDBは不一致でした。実際に障害が発生し、データーに不一致が生じた場合、データを一致させるにはどうすればよろしいのでしょうか。 御指導をお願い致します。
こんばんは。 PostgreSQLについて質問させてください。 CSEを使ってSQLの勉強をしていますが、 データベースを作成した際に、 WARNING: nonstandard use of escape in a string literal at character 42 WARNING: LOCATION is not supported anymore という表示がされ、 その後、テーブル作成などをすると エラーになり実行できません。 例えば、 create table テーブル名( id number(8) primary key, name char(10), birth date ) ; を実行した際に、 SQL実行中に以下のエラーが発生しました。 ERROR: syntax error at or near "(" at character 32 というエラーになります。 この原因は、Encodingの問題だと思っていますが、 どのように解決したらいいか教えてください。 また、Encodingの問題ではない場合は その際の対処法を教えてください。 以上、ご回答のほどお願いいたします。
お世話になります。 postgresql ポート変更を5432から5433に変更し,psql -lを実行したら、 Is the server running locally and accepting conection on Unix domain socket "tmp/.s.5432"? というエラーが発生しました。5432に戻すとエラーは消えるのですが、環境上5433で接続したいのですが、どこが悪いのか全く検討がつきません。 ご指導をお願い致します。
pg_catalog.time エラーメッセージの一部に出てきたのですが、わかりません。 よろしくおねがいします。
よろしくおねがいします。 PostgreSQLを使って、データベースを構築しているのですが、文字型のデータ（character varying）を時間型（time）に変更したいのですが、どうすればよいかわかりません。初心者なのでなるべく詳しくどなたか教えてください。
「'」をパターンマッチングしたい場合はどうすればいいのでしょうか？ like '%'%'だとエラーになってしまいます。
環境はｘｐ、apache2、php5、Postgresql8.2です。 1台のPCをサーバ＆クライアントにしています。 ただ今PHPとPostgresqlの勉強をしています。 先日、 サーバに接続できません・・・ http://oshiete1.goo.ne.jp/qa3523104.html というご質問をさせて頂いた者です。 回答者様のお陰で理解を深めることで出来ました。 「postgresql.conf」のIPアドレスを確認したところ #listen_addresses = 'localhost' と、なっていました。 頭に「#」があるということは その行は実行されていないということですよね？ 「#」を省いた方が宜しいのでしょうか？
環境はｘｐ、apache2、php5、Postgresql8.2です。 ただ今PHPとPostgresqlの勉強をしています。 Pgadmin3で postgresサーバに接続しようとすると 次のようエラーが出て 接続することが出来ません。 「サーバに接続できませんでした サーバはホスト"000.0.0.1"で稼働していますか？ また、ポート5432でTCP/IP接続を受け付けていますか？」 そのため、postgresをアンインストールして インストールし直したところ 接続できるようになったのですが 新しいデータベースを作ろうとしたところ また同じエラーが出て接続できなくなってしまいました。 ご教示して頂けたら幸いです。
環境はｘｐ、apache2、php5、Postgresql8.2です。 ただ今PHPとPostgresqlの勉強をしています。 postgresに接続できなくて困っています。 <?php $d_base = pg_connect("user='postgres' password=xxxx dbname='test'"); //データベースに接続 で、エラーになり その内容は、 Warning: pg_connect() [function.pg-connect]: Unable to connect to PostgreSQL server: could not connect to server: Connection refused (0000000000D/00000) Is the server running on host "???" and accepting TCP/IP connections on port 5432? in です。 ご教示して頂けたら幸いです。
PostgreSQLにて AとBというデータベースがあると仮定し、 AにはA1,A2,A3というテーブルがあるとし BにはB1,B2,B3というテーブルがあるとします。 抽出時Bの中のテーブルであれば結合を行い 一度で抽出が色々行え速度向上を行えるのですが、 データベースがBとAと分かれている時、一度Bで検索 をかけそのデータをAに渡し新たに検索というスタイル を使わなければなりません。 そこで、AのA1というテーブルデータをそのままの形で Bのデータベースへ移動する事は出来ないでしょうか？ もちろんPHP等でプログラムを組んで再構築すれば 出来るのはわかりますが、もっとシンプルに出来れば と思い質問させて頂いております。
DBに「2007-01-01　00:00:00」で登録してある日付から 「2007/1/1」という形で出力したいのですが、SQLはどうすれば よろしいですか？ 初歩的な質問ですみません。
　たびたびお世話になります。 　PHPファイルのテキストボックスに入力された文字列でテーブルを検索して結果を取得したいのですが、複数キーワードでのあいまい検索の扱いで困っています。 　例えばtitleというカラムにある「今日はいい天気です」という文を検索したい場合は、PHPからSQL文で「select * from table where title like '%天気%';」とやれば引っかかるのですが、では「今日　天気」でやった場合、また「いい　今日」で検索した場合も引っかかるようにしたいのです。 　PHPで文字列を代入してSQL文を作る形になるとは思うのですが、この場合、SQL文はどのように記述すればいいのでしょうか？
テーブル内に、PHPで整形した「07-11-10 11:35」といった形で日時を挿入してあります。 このテーブルから別のPHPで検索を行う際、PHP側で現在の日時を同じ形で取得して、「PHP側で取得した日時より未来のものだけ抽出する」という処理を行いたいのですが、どうすればいいでしょうか？ 日付だけならlikeで抽出できるのですが、時間まで一緒に厳密に比較する方法が知りたいのです。 ////////////////////////////////////////////////////////// 例：PHP側で今日の日時を取得→　07-11-12 10:35 07-03-02 20:31 08-04-06 03:17 07-06-30 17:52 07-11-12 06:14 07-12-01 09:23 08-01-18 23:09 この中から、取得した日時より未来にあたる 08-04-06 03:17 07-12-01 09:23 08-01-18 23:09 だけを抽出する。
以下のテーブル関連で、以下のロジックで、recipe_id だけの一覧を取得するのは、1本のSQLではどのようにすればよいでしょうか？ ＃あとこのような、クエリーの事をなんと呼べばいいのでしょうか…。 ＃適切質問タイトルが思い浮かばなかったので、提示してもらえるとありがたいです。 recipe recipe_id | name 1 | ズッキーニとオリーブのトマトパスタ 2 | ズッキーニとオリーブのトマトのマリネ 3 | ズッキーニのアリオリ 4 | 野菜のフリッター recipe_ingredients recipe_ingredient_id | recipe_id | master_id 1 | 1 | 1 | ※　ズッキーニとオリーブのトマトパスタ 2 | 1 | 2 | ※　ズッキーニとオリーブのトマトパスタ 3 | 1 | 3 | ※　ズッキーニとオリーブのトマトパスタ 4 | 1 | 4 | ※　ズッキーニとオリーブのトマトパスタ 5 | 2 | 1 | ※　ズッキーニとオリーブのトマトのマリネ 6 | 2 | 2 | ※　ズッキーニとオリーブのトマトのマリネ 7 | 2 | 3 | ※　ズッキーニとオリーブのトマトのマリネ 8 | 3 | 1 | ※　ズッキーニのアリオリ 9 | 3 | 4 | ※　ズッキーニのアリオリ 10 | 4 | 1 | ※　野菜のフリッター ※　はわかりやすくつけただけで、実際のテーブルデータではないです。 vegetables vegetable_id | name 1 | ずっきーに 2 | おりーぶ 3 | とまと 4 | にんにく ロジックはアンド検索で： 検索条件「ズッキーニ、トマト」で検索したら、 　「ズッキーニとオリーブのトマトパスタ」と「ズッキーニとオリーブのトマトのマリネ」 検索条件「にんにく、ズッキーニ」で検索したら、 　「ズッキーニとオリーブのトマトパスタ」と「ズッキーニのアリオリ」 が見つかる。 名前でLike検索はしない。 全く持って想像がつかないので教えてください。 ちょっと考えてみたんですが、↓では、１～４のレシピ全てが見つかってしまうのですよね…。 select recipe_id from recipe inner join recipe_ingredients using ( recipe_id ) inner join vegetables using ( vegetable_id ) where vegetables.name like '%ずっきーに%' or vegetables.name like '%にんにく%' ; もしかして、以下でしょうか？ select recipe_id from recipe inner join recipe_ingredients using ( recipe_id ) inner join vegetables using ( vegetable_id ) where vegetables.name like '%にんにく%' INTERSECT select recipe_id from recipe inner join recipe_ingredients using ( recipe_id ) inner join vegetables using ( vegetable_id ) where vegetables.name like '%ずっきーに%'; なんとなくコストが高そうなので、他に方法はないでしょうか？
現在、testDB1とtestDB2というDBが存在します。 それで、testDB1のtable.idとtestDB2のtable2.idを SELECT文で比較して、同じidの場合はtestDB2のtable2.dataに 1という値を格納したいと思っています。 それで、DBをまたいで更新するときの記述が分からず ネットで検索したのですが、うまくヒットしませんでした。 そもそもDBをまたいで問い合わせや更新等はできないのでしょうか？ できない場合、代替の方法があったら教えて頂けますでしょうか。 よろしくお願い致します。
VBAでPostgreSQLを読む処理を作成しています。 【例】 create table aaaaa ( sisya varchar(002), busyo varchar(002), suuchi decimal, constraint aaaa_key primary key ( sisya, busyo)) というテーブルを作成し craete view vaaaa as select sisya as v_sisya, busyo as v_busyo, sum(suuchi) as v_suuchi from aaaa group by sisya,busyo というビューを作成して参照しています。 ACCESSのODBCで参照すると、正しく数値が入っているのですが、 viewをVBAから参照すると桁が落ちます。 60000が6になるなど。（不定期に。下４桁のゼロが消えているようです。） vbaからでも正しく数値が吐き出されている場合もあります。 どのような原因が考えられるでしょうか？ お教えください。
VB6からWindows版PostgreSQL8.2.4へ書き込みを行っています。 まれにinsertエラーが発生する為、困っています。（２日～７日に１回） エラー時のSQLログがあり、SQL文に間違いが無いことは確認ずみです。 エラー詳細を取っておらず詳細がわかりません。 （実際に現象を発生させようとしましたが、発生しません。） 追加するテーブル自体に主キーは設定していません。 データの書き込みは１５秒に２レコード位なのですが、Update文の直後のinsert文がまれに失敗します。 とりあえず、トランザクション処理で回避していますが、PostgreSQLの設定値などの変更により、回避出来るのでしょうか。 また、この様な事はよくあることなのでしょうか。 説明が分かりづらく申し訳ありませんが、 宜しくお願いします。
PostgreSQL8.24を利用しています。 pgADMINIIIでテーブルを作成しました。 【TABLE_A】と【TABLE_B】があります。 【TABLE_A】の【ID】が【TABLE_B】の【ID2】が外部キーとして設定してあります。 CONSTRAINT TABLE_B_fkey FOREIGN KEY (ID2) REFERENCES TABLE_A (ID) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION 上記のように記述されています。 SQL文のUPDATEを使い、IDが「01」を「05」に更新したいのですが、 以下のように記述するとエラーになります。 どのようなUPDATE文を記述すればよろしいのでしょうか。 UPDATE TABLE_A INNER JOIN TABLE_B on TABLE_A.ID=TABLE_B.ID2 SET TABLE_A.ID = '05',TABLE_B.ID2 = '05' WHERE TABLE_A.ID='01'" よろしくお願いいたします。
テーブルは2つ ・offacc_siwakedata ・off_projectmster とあり、それぞれ下記インデックスを張っております。 create index siwakedata_index ON offacc_siwakedata( siwakedata_date, siwakedata_hdcd, siwakedata_cd, siwakedata_kamokucode, siwakedata_projectcode, siwakedata_exzankada, siwakedata_default, siwakedata_compcd, siwakedata_del ); CREATE INDEX projectmster_index ON off_projectmster( projectmster_cd, projectmster_del, projectmster_compcd ); ２つのテーブルを結合させる下記SQLを発行 explain select offacc_siwakedata.*, off_projectmster.projectmster_name from offacc_siwakedata,off_projectmster where off_projectmster.projectmster_cd=siwakedata_projectcode and off_projectmster.projectmster_del='1' and off_projectmster.projectmster_compcd='200' and siwakedata_compcd='200' and siwakedata_del='1' and siwakedata_default='1' and siwakedata_kamokucode='26300' and siwakedata_exzankada<>0 order by siwakedata_date, siwakedata_hdcd, siwakedata_cd ; explainするとoff_projectmsterのインデックスが有効になっていません。 何ででしょうか？ 教えてください。 宜しくお願いします。 "Nested Loop (cost=0.00..17438.04 rows=1 width=1307)" " Join Filter: ((off_projectmster.projectmster_cd)::text = (offacc_siwakedata.siwakedata_projectcode)::text)" " -> Index Scan using siwakedata_index on offacc_siwakedata (cost=0.00..17436.98 rows=1 width=1244)" " Index Cond: (((siwakedata_kamokucode)::text = '26300'::text) AND ((siwakedata_default)::text = '1'::text) AND ((siwakedata_compcd)::text = '200'::text) AND (siwakedata_del = 1))" " Filter: (siwakedata_exzankada <> 0::numeric)" " -> Seq Scan on off_projectmster (cost=0.00..1.04 rows=1 width=96)" " Filter: ((projectmster_del = 1) AND ((projectmster_compcd)::text = '200'::text))"
Postgresql7.2.4で user:postgresにより CREATE TABLE test (id serial PRIMARY KEY,num INT4) というテーブルを作成し、 GRANT ALL ON test TO PUBLIC と権限を与えました。 そしてPHP4よりuser:nobodyで INSERT INTO test (num) VALUES (1) というクエリを実行しようとすると ERROR: test_id_seq.nextval: you don't have permissions to set sequence wash_h_test_id_seq in test.php とでます。 しかし INSERT INTO test (id,num) VALUES (1,1) とするとちゃんとデータベースに反映されます。 PHPで、このユーザーからserialを使った自動連番で 書き込めるようにするにはどうすればいいのでしょうか。
libpqを使ってC言語でPostgreSQLデータベースにあるデータを取得しています。 プレースフォルダ無しでSelectして表示させることはできますが、プレースフォルダのサンプルがネット上で探せませんでした。 プレースフォルダーをどのように記述したらよいのでしょうか？ 英語ページでも構いませんので、教えてください。
Red Hat Enterpraise Linux 3 PostgreSQL7.3.10(Linux) 現在2つのテーブルＡ，Ｂにてメールアドレスを管理していますが その2つのテーブルの差分を知りたいのですが、 （Ａを基準と考えＢとの差分：つまりＡには存在しないデータ抽出） プログラム（ＰＨＰ等）を使用せずに 差分を取得するには、どの様なクエリー文を組むと出来るのでしょうか？ よろしくお願いします。
はじめまして。 PostgreSQLビギナーです。 インストール時に下記メッセージがでるのですがどう対処すればいいでしょうか。 アカウント名,アカウントドメインはインストール手順書に書いてある とおりなんですがなにか準備がいるのでしょうか。 ご指導ください。 サービス構成入力後。 サービス名：PostgreSQL Database Server 8.1 アカウント名：postgres アカウントドメイン：TIGRLIS パスワード:AAA Your local 'Administrators' group contans 'Interactive Users' This is a common configuration error causes security issus\es for this reason Postage
PostgreSQLのＳＱＬ文法の簡単な説明を書いてある本またはＷＥＢはないでしょうか、ＩＮＳＥＲＴ、ＵＰＤＥＴＥ、ＤＥＬＥＴＥなどをリモートでやる方法が載っているやつなんですが、ちょっと困ってます。
postgresql8.2.4を使っています。 select to_char(10/3, '99D999'); とすると、 3.000となります。 10/3=3.3333....ではないのでしょうか？ 他のSQL(MySQLやSQLServer,Oracle,DB2)もどう記述するか知りたいです。
基本的な質問で申し訳ありません。1台のLinuxサーバ(CentOS)に、MySQLとPostgresの両方をインストールして、同時に起動し、別のデータベースとして使用することはできるのでしょうか？
たとえば データ(1) Ａ：１１時　Ｂ：１３時 データ(2) Ａ：１８時　Ｂ：０時 データ(3) Ａ：２３時　Ｂ：３時 現在時刻が１２時の場合 データ(1)が抽出 現在時刻が１７時なら データ(2)(3)が抽出 現在時刻が０時なら データ(2)(3)が抽出 のように 現在時刻が期間ＡからＢに該当する場合に データがＨＩＴするような ＳＱＬを作りたいのですが うまくいきません where 'now' between A and B; ではうまくいきませんでした 何か良いＳＱＬはありませんか？ ちなみにTIME型データです それ以外のデータ型でもいいです 希望通りの動きをするなら・・・ よろしくお願いします
2つの異なるテーブルを和結合し、重複のない名前だけ出力させるSQLを書きたいのですが どこが間違っているでしょうか？ select distinct name from ( select name from test1 union select name from test2 ) ; test1テーブル name 国語 算数 理科 社会 test1テーブル name 国語 体育 家庭科 社会 結果 name 国語 算数 理科 社会 体育 家庭科
PostgreSQL8.2.24を使っています。 インデックスの削除と、インデック名のつけ方についてお聞きしたいです。 まず、削除ですが、create index tbl_fld_key on tbl (fld); としたものは、drop index tbl_fld_key;で削除できますが、 create tbl ( fld integer, unique key (fld) ); としたものは、drop index tbl_fld_keyで削除できません。 インデックス名は\diコマンドで表示されている tbk_fld_keyです。 メッセージは次のとおりです。 db =# drop index tbl_fld_key; ERROR: cannot drop index tbl_fld_key because constraint tbl_fld_key on table tbl requires it HINT: You may drop constraint tbl_fld_key on table tbl instead. あと、PostgreSQLのインデック名の規則について インデックス名を見ただけで判断できるように作られるようですが PRIMARY KEY　テーブル名_フィールド名_pkey UNIQUE　　　 テーブル名_フィールド名_key 重複可　　　 テーブル名_フィールド名_？？？ <<--- この部分が知りたいです。
データベース自体はPostgreSQLを使っています。そして、アクセス2003を使って、テーブルリンクで閲覧しています。 あるフィールドに検索が早くなるようにキーを設けたいのですが、 重複を許すキーの構文がわかりません。 PRIMARY KEY, UNIQUEの設定はわかるのですが、 どのように記述すればよいのでしょうか？ 以下、アクセスのプロパティです。 インデックス ●いいえ デフォルト、無指定 ●はい（重複あり）[***** ここの部分のSQLが知りたい *****] ALTER TABLE テーブル名 ADD ???????? (フィールド); ●はい（重複なし）UNIQUE もしくは値要求混みのPRIMARY KEY ALTER TABLE テーブル名 ADD UNIQUE (フィールド); ALTER TABLE テーブル名 ADD PRIMARY KEY (フィールド);
お世話になっております。 SQLを勉強しているのですが、 http://winofsql.jp/VA003334/sqlq051013150415.htm の(5)の問題がどうしても分かりません。 データベースは http://r205.jf.land.to/sb/lightbox/php/pgsqladmi … の商品マスタを使います。 副問い合わせの値が複数なので、（自己？）相関サブクエリを使うのかな？ 位の感じでなのですが・・。 分かる方教えていただけると嬉しいです！
すいません。プログラミング初心者です。ＷＩＮＤＯＷＳＸＰにＰＨＰとＡＰＡＣＨＥとＰＯＳＴＧＲＥＳをインストールしました。ＰＨＰのプログラムは、ＩＮＩファイルを反映してうまく動いてくれます。ＰＨＰＩＮＩファイルでは、ＰＯＳＴＧＲＥＳを認識しているようなのですが、ＰＨＰからＰＯＳＴＧＲＥＳに接続する簡単なプログラムを作って接続しようとすると「ＰＯＳＴＧＲＥＳのサーバーが見えない」というメッセージが帰ってきます。ＵＳＥＲは、最高権限のpostgresでアクセスしようとしているのでデーターベースの権限の問題では、ないと思うのですが、なぜＰＨＰからアクセスできないのでしょう？ ＰＯＳＴＧＲＥＳＳ単体では、データベースをつくることができます。
WindowsのPostgreSQL8.2.24を使っています。PL/Perlが使いたいのですが、インストール時に、以下のようになります。 データベース・コマンド・エラー: ERROR; could not load library "C:/Program Files/PostgreSQL/8.2/lib/plperl.dll": The specified module could not be found. Windows版でPL/Perlが使いたいのですが可能でしょうか？
お忙しいところ申し訳ありませんが、ご教示お願い致します。 Aサーバ(xxx.xxx.xxx.xxx)のDB（A_DB)を Bサーバ(yyy.yyy.yyy.yyy)のDB（これをB_DBとしたい）に コピーをしたいと考えております。 AサーバのA_DBの情報（レコードも含む）をBサーバにB_DBとしてコピーしたいですが、よくわかりません。。。 ご存知の方いらっしゃいましたらお手数ですがご教示下さいm(_ _)m
初めまして、nana0224と申します 現在Postgresql8.2で開発中なのですが 複数検索で検索した場合その検索値順で取得したいのですが 可能でしょうか？ order byは昇順か降順しかなく無効にする事は出来ないのでしょうか？ シーケンスを発行しても並び替えをしてからなので意味がありませんでした。 select * from A where id in(7,9,4,6) ↑この(7,9,4,6)の順で取得したいのですが・・ すみませんが皆様良いお知恵をよろしくお願い致します。<m(__)m>
PHPとPostgreSQLでファイルを作成しました。 (2)、(3)の場合だと問題なく動作しますが、 (1)の場合だと動作しません。 「あ」が2バイトなのが原因かとおもうのですが、 よくわかりません。他に原因あるのでしょうか。 ********************************************** 環境　PHP5　Apache2.2　PostgreSQL8.24 ********************************************* <?php // 接続設定（サーバ／データベース／ユーザ／パスワード） $sv = "localhost"; $dbname = "test"; $user = "user"; $pass = "pass"; // 文字コード $enc_disp = "EUC-JP"; $enc_db = "EUC-JP"; // データの文字コードを変換する関数 function cnv_enc($string, $to, $from) { // 文字コードを変換する $det_enc = mb_detect_encoding($string, $from . ", " . $to); if ($det_enc and $det_enc != $to) { return mb_convert_encoding($string, $to, $det_enc); } else { return $string; } } // データベースに接続する $conn = pg_connect("host=$sv dbname=$dbname user=$user password=$pass") or die("接続エラー"); (1)$sql = "select * from test WHERE name LIKE N'あ%'"; (2)$sql = "select * from test WHERE tel LIKE N'090%'"; (3)$sql = "select * from test WHERE no LIKE N'a%'"; ?> ********************************************* nameには、名前の文字列（いとう、さとう）が、 telには、電話番号（090…、03…）が、 noには、アルファベット一文字（a、b）が 入力されています。 *********************************************
４桁と５桁の値が入っているフィールドのテーブルがあります。 やりたいことは、下三桁目に「－」を入れたいです。 例） １２３４５ ５６７８ ↓ １２３－４５ ５６－７８ 以下のようなコードを作成しましたが、 LEFTとRIGHT関数がPostgreSQLでは使用できないようです。 WEBで調べてSUBSTRINGを使うのかなと思ったのですが、 どうすればいいかわかりません。 ******作成したコード*********** (LEFT(id,LENGTH(id)-2) || '-' || RIGHT (RTRIM(id), 2)) どうぞ宜しくお願い致します。
回答がないので正しい答えを教えてください。 よろしくお願いします。 尚、ＳＱＬ文について、わかりやすく記述しているサイトがありましたら教えてください。 次の[出身校別人数表]は、[会員表]から出身校別の人数を多い順に表示したものである。 これを行うＳＱＬ文を教えてください。 [会員表] 会員番号　　　　　　氏名　　　出身校　　　専攻　　 ２００１００１　　経営一郎　　Ｄ大学　　　経済 ２００１００２　　管理二郎　　Ｂ大学　　　経営 ２００１００３　　情報三郎　　Ｂ大学　　　物理 ２００１００４　　組織四郎　　Ｃ大学　　　文学 　　　・　　　　　　・　　　　　・　　　　　・ 　　　・　　　　　　・　　　　　・　　　　　・ 　　　・　　　　　　・　　　　　・　　　　　・ 　　　 [出身校別人数表] 出身校　　　人数 Ｂ大学　　　３１ Ｄ大学　　　２０ Ｃ大学　　　１５ 　・　　　　　・ 　・　　　　　・ 　・　　　　　・
PostgreSQL8.2.4を使用しております。 データベース毎にデータファイルの保存位置を変えたいと考えているのですが、その方法がよく分かりません。 7系での方法は見つけることができましたので、8.2ではうまくいきませんでした。 8.2系での方法をご存知の方がいらっしゃいましたら、ぜひ教えて頂けませんでしょうか？
phpPgAdminをインストールばかりなのですがログイン方法が分かりません。 いろいろ試したんですが「ログインに失敗」が出て入れません。 どうしたらログインできるでしょうか？ バージョンを記しておきます。 Fedora Core 6 kernel-2.6.20-1.2962.fc6 postgres (PostgreSQL) 8.1.9 phpPgAdmin-4.1.3-2.fc6 php-pgsql-5.1.6-3.6.fc6
Table1には毎日の記事に対して賛成(1)、反対(-1)のデータが入っています。 例　2003-1-11 　-1 2003-1-12 　 1 | Table2には世論調査の期間が入っています。例えば、2003-1-11(field1),2003-1-15(field3)。 Table2の期間を参照しながらTable1に入っている賛成・反対のデータを表示させたいですがどのような方法があるのでしょうか。 教えていただければ幸いで～す。
accessのレコードデータをpostgreSQLに移行したいと考えています。 accessのデータをcsvファイルにエクスポートしてからposgresSQLで インポートしようと考えていました。 しかしレコードの中にEnter(改行コード)があるので、csvに変換して しまうとレコードの件数以上に行数ができてしまい、postgresSQLで インポートがうまくできませんでした。 accessのレコードにある改行コードを他の文字に変換するしか posgreSQLに移行する方法はございませんでしょうか？ できれば改行コードもそのまま移行したいと考えておりますが 何か良い方法があればご教授頂ければと思います。 よろしくお願いします。
Windows上でPostgreSQL8.0を使用しています。 DBのバックアップを毎日自動で（タスク登録して）とっています。 具体的にはバッチファイルの中で以下のようなpg_dumpコマンドを実行させています。 「pg_dump -U ユーザー名 -f %DATE:~0,4%%DATE:~5,2%%DATE:~8,2%EXPDAT.db DB名 <dmp.txt」（なお、最後のテキストファイル内にはたぶんパスワードと思われる内容が記載されています。） 通常はAdminIIIを使用してバックアップおよびリストアを行っており、上記のバッチ実行にて作成されたダンプファイルからのリストアを行ったことがありません。（拡張子がBackupでないので、AdminIIIからのリストアはできませんでした） ヘルプや書籍を参考に、psqlからのリストアを試みたのですが、そもそもどのようにコマンドを入力してよいかわかりません。 試した内容は以下の通りです。 １．psql.exeを実行 ２．ホスト名、ユーザー名、パスワード、データベース名をそれぞれ入力 ３．データベース名#>　が表示されるので、「psql -U ユーザー名 -d データベース名　-f　"c:\20070822EXPDAT.db"」と入力し実行すると、psqlという文字列に対してsyntaxエラーとなってしまいました。 そもそも、psql画面でのコマンドの入力方法がよくわかっておりません。書籍などをみるとよく「psql -U xxx -d xxx -f xxx」と書いてありますが、実際に入力するのはどこからでしょう？ 担当者が退社してしまい、手探り状態で運用し始めたところです。 大変初歩的な質問で申し訳ありませんがよろしくお願いいたします。
RedHatのPostgresql7.2.4で稼動しているデータベースhogehogeを windowsの8.2.4で稼動させようとしています。 最初にpgdumpでデータベースhogehogeを取り出し、それをwindowsからFFFTPで取得、 その後pgADMINIIIでリストアしようとしましたが、 データを選択しても実行ボタンがアクティブにならなかったので、 コマンドラインを使って createdb -U postgres --encoding=EUC_JP hogehoge psql -U postgres -e -f c:\files\hogehoge hogehoge としました。 すると psql:c:/files/hogehoge:181: ERROR: invalid byte sequence for encoding "SJIS": 0xf309 HINT: This error can also happen if the byte sequence does not match the encoding expected by the server, which is controlled by "client_encoding". CONTEXT: COPY hogehoge_hage, line 1 というようなエラーがいくつか出てきます。 client_encodingをEUC_JPにしてみましたがやはり同じエラーが 出ました。 元のRedHatでのエンコードはEUC_JPになっています。 どなたか解決法をご存知の方がおられましたらご教授お願いします。
PostgreSqlを利用しております。 テーブルAを作成し、テーブルにはURL、HPの簡単な説明をもっております。 HPデータを5万件程度登録したあたりで、 データベースからデータを取り出し、htmlで表示するまで50～80秒 程度時間がかかってしまいます。 プログラム言語はPerl、DBへのアクセスはPgモジュールを使用して おります。 レンタルサーバであるため、Postgreのバージョン、サーバスペック 等はわかっておりません。 ※他のユーザと共用サーバであることは間違いないのですが。 有識者様にご質問ですが、Postgreは5万件程度の登録で動作 が重くなるのでしょうか？ それとも、サーバの設定の問題でしょうか？
データの変換するコマンドを教えてください A|B ==== 1|A 2|B 3|C 4|A 5|D 6|A 7|D というテーブル内容を以下のように出力したいです。 だれがよいコマンドを教えてくださいませんか。 ABCD 1000 0100 0010 1000 0001 1000 0001
Oracleのrow_numberのような関数はないのでしょうか？ Order By句を指定してSELECTした結果の行番号を求めたいのですが、 なにか良い方法はないのでしょうか。 例えば次の表なテーブルがあった場合、 Code1 Code2 Code3 01　　02　　02 01　　02　　01 01　　01　　02 ORDER BY Code1,Code2,Code3 で行った場合の結果が No Code1 Code2 Code3 1　　01　　01　　02 2　　01　　02　　01 3　　01　　02　　02 Noを求めたいのですが。
￥DF で、ストアードプロシジャーの定義を調べられると思いますが、その定義内容を見るには、どうすればよいのでしょう？ ググッて見ましたが、いまいち見つかりませんでした。 お分かりの方、教えてください。
where文で条件を指定して検索したいのですが、たとえば、idが１、２、３０、４０以外を検索するにはどうしたらよいでしょうか？ 初歩的な質問で申し訳ありません。 回答よろしくお願いします。
初めて投稿します。 PostgreSQLは初心者です。 今、BBSのサンプルを使って製作をしているのですが、 「Fatal error: Call to undefined function: pg_query() in ・・・」と表示されて、BBSが表示されません。 エラーの表示先は、 「$R = pg_query("select title,body from bbs_title where bbs_id='$bbs_id'");が入っています。 PHP4.4.1とPostgreSQL 7.3.4を使用しています。 まったく原因がわからず、困り果てています。申し訳ございませんが、どなたかわかる方、原因を教えていただけないでしょうか？初投稿なので不備な点があればおっしゃってください。よろしくお願いいたします。
Windowsにpostgresqlバージョン8をインストールしました。 基本がわかっていないのですが、まずユーザを作成することを始めるのでしょうか？ ユーザーの作成方法がわかりません。
システム屋やヘビーユーザーに教えていただきたいのですが、 Linux+Apache+PostgreSQL+Perlでシステムを構築する予定です。 Perlは5.8を使うことは決めていますが、 他のバージョンについてどれを使えば今後メンテナンスで楽になるのでしょうか？ ・Linuxのディストリビューション ・Apacheのバージョン ・PostgreSQLのバージョン です。因みに、 DNSサーバー、メールサーバー、WWWサーバー、DBサーバーと分けます。
すいません。当方データベース初心者です。ネット上で検索したら、ＰｏｓｔｇｒｅＳＱＬからＥＸＣＥＬへデータを移すことは簡単にできるようなことが書いてあったのですが、本当に簡単なのでしょうか？
pg_connect を、Linuxへインストールしたいのですが、 どうすればいいのでしょうか？ PostgreSQL とPHPを接続させる為です。 あと、PHPのコンパイル方法もご教示願います。
環境はｘｐ、apache2、php5、Postgresql8.2です。 ただ今PHPとPostgresqlの勉強をしています。 pg_queryで変数の値をINSERT処理を行いたいと 以下のようにしてみましたが うまくいきません。 問題は VALUES('$number','$name')" の部分だと思うのですが 変数はどのように書いたらいいのかが分かりません。 numberはint型 nameはtxst型です ご教示して頂けたら幸いです。 ---------- if($_POST['action'] && $_POST['sign'] == 'kaki') { if($_POST['number'] && $_POST['name']) { pg_query($d_base,"INSERT INTO aas(number,name) VALUES('$number','$name')"); print $_POST['name']; } else { print "書き込めませんでした。"; } }
PostgreSQL6.5.3から8.2.3への移行作業を行っています。 ほぼ全てのデータ移行は完了したのですが画像（ラージオブジェクト）の移行ができず困っています。 6.5.3のpg_dumpではラージオブジェクトのエクスポートはサポートされていないと思うのですが、移行ツールのようなものはないでしょうか。 何か良い手段があればご教授下さい。 また、移行したデータにラージオブジェクトのOIDが保存されており、そちらの値も更新する必要があると考えています。 ちなみに6.5.3のdata/base/db名のディレクトリ内に「xinv***」「xinx***」というファイルがあり、これが実体かな、と勝手に予想しています。このデータを用いてうまく移行できないものか、とも考えています。 どうかよろしくお願いします。
http://okwave.jp/qa2956072.html 上で同じような質問を過去にしましたが、状況がちょっと違うようでしたので再度質問させてください。 列の型をserialで指定しテーブルを作りました。 入力を省略したところPermission Deniedのエラーが出ました。 前回の質問では権限が異なるIDでINSERTしようとしたのでは？と回答をいただきましたが、状況がちょっと違っていたようです。 $sth = $dbh->do("insert into $table (filepath,filename,filesize,confirmdate,upload,filenumber) values ('$list[$count]->[0]','$list[$count]->[1]','$list[$count]->[2]','$today','$today','12')"); と入力すると12という番号でINSERTできます。 $sth = $dbh->do("insert into $table (filepath,filename,filesize,confirmdate,upload) values ('$list[$count]->[0]','$list[$count]->[1]','$list[$count]->[2]','$today','$today')"); しかし上記のように省略するとエラーが出ます。 本にも省略した場合自動的に番号が割り振られるとありますが、具体的にどう省略したらよいのでしょうか？ よろしくお願いします。
現在windows2000ProSP4でPostgreSQL8.0.2を使っています。 日々データベースの更新をしておりますが、更新時間に8時間ほどかかっており何とか高速化（短時間化）出来ないかと思っています。 今はパラレルATAの120GBなので、これをUSB2.0のフラッシュメモリにデータベースを移行すればかなり高速化するのでは？と考えています。 プログラムの見直しも同時に行いますが、平行してドライブの高速化をしたいと思うのですが、肝心のデータベースのドライブの変更方法がわかりません。 現在すでにPerlDBIで稼動させているデータベースなので、そちらの設定にも影響がでるようであればどういう項目の再設定をすれば良いかもあわせて教えていただけると助かります。 よろしくお願いいたします。
PostgreSQLを使用したいのですが、 新しいデータベースをサブホストドメインに対して付与及び、追加する際に、 文字エンコードがデフォルトでは「SQL_ASCII」になっているのを「EUC-JP」に変更したいのですが、どうすればいいのでしょうか？
psqlでDBを作りたいのですが データを入力する際に、invalid byte sequence for encoding "EUC_JP"というエラーが出て日本語の入力ができません。 使用しているOSは Fedora Coreで 文字コードを UTP-8を変換しようとしています よろしくお願いします。
以下のサイトを参考にして、ODBC接続によるExcelへのPostgreSQLデータ取り込みを試みました。 「PostgreSQL ODBCによるアプリケーション接続」 http://allabout.co.jp/internet/database/closeup/ … 「2. ExcelにPostgreSQLのテーブルのデータを取り込む手順」 http://allabout.co.jp/internet/database/closeup/ … ODBCの設定自体はたぶんうまくいったと思うのですが、いざExcelからPostgreSQLを取り込もうとすると、「このデータソースには表示できるテーブルがありません」というメッセージが表示されてしまいます。 接続先のDBには、テーブルは存在しています。 試しに、Accessでも以下のサイトの手順で試して見ましたが、「テーブルのリンク」画面に対象となるテーブルが１件も表示されません。 「3. AccessにPostgreSQLのテーブルのデータを取り込む手順」 http://allabout.co.jp/internet/database/closeup/ … テーブルとのリンクをはるために他にも何か設定は必要でしょうか？ PostgreSQLは8.0.1、Officeは2003を使用しています。 接続は自分のPC内にあるOfficeから同じく自分のPC内にあるPostgreSQLへ接続しに行こうとしています。 よきアドバイスをいただけると助かります。 以上、よろしくお願いいたします。
環境はｘｐ、apache2、php5、Postgresql8.2です。 ただ今PHPとPostgresqlの勉強をしています。 PHP5で作成したプログラムでPostgresqlへアクセスするのですが，全く応答がありません。 ブラウザで表示後、ソースを見ると Parse error: syntax error, unexpected T_VARIABLE in C:\Program Files\Apache Group\Apache2\htdocs\sample\aa.php on line 10 というエラーが表示されます。 aa.phpの10行目は $d_base = pg_connect("user=postgres password=0000 dbname=test"); と、データベースに接続しています。 どこがおかしいのか ご教示して頂けたら幸いです。
はじめまして、こんにちは 早速なのですが、質問です。 タイトルのとおり勤務時間外勤務の回数を集計したいのですが、 どのように比較すればよいのかがわかりません。 勤務終了時間を入力しているフィールドが有るので、 sum(case when 勤務終了時間　> 勤務時間外勤務開始時間 then '1' else '0' end) と言った形で書こうと思っていたのですが、勤務終了時間をtimestampにしている為、 勤務時間外勤務開始時間を'18:00:00'と言った形で書くと型が合わないと言われてしまいます。 (timestampは日付まで入力されているので確かにそうなのですが) 副参照で集計する人のテーブルを作り、その際に勤務終了時間の形式を'HH:MM:SS'という形して それをさらに集計と言った方法しかないのでしょうか？ 非常に助長な感じがしますし、他の方法がありそうなのですが、 どのようにすればいいのかが判りません。 宜しければ教えていただけないでしょうか？
お世話になっております。 postgreSQL初心者です。 エクスポートの方法をご教授頂きたいです。 COPYコマンドでCSVをエクスポートしたいのですが ・カラム順を指定出来ないでしょうか？ ・またデータでタイムスタンプが登録されている場合、タイムスタンプ部分を削除してエクスポートする方法はないでしょうか？ 　例）タイムスタンプ付き　2006-10-12 16:50:01+09 　　　タイムスタンプ削除　2006-10-12 16:50:01 ちなみに ・pg_dump -D でINSERT文を抜き出す際もタイムスタンプを削除出来ませんでしょうか？ postgreSQLバージョン:8.03 簡単なことなのかもしれませんが、どうぞよろしくお願いいたします。
Linux環境にPostgreSqlをインストールしたいのですが以下のエラーがでて困ってます； 手順としては 1, ./configure 2, gmake 3, su 4, gmake install 5, mkdir /usr/local/pgsql/data 6, chown postgres /usr/local/pgsql/data 7, su - postgres 8, /usr/local/pgsql/bin/initdb -D /usr/local/pgsql/data 9, /usr/local/pgsql/bin/postgres -D /usr/local/pgsql/data >logfile 2>&1 & 10, /usr/local/pgsql/bin/createdb test 11, /usr/local/pgsql/bin/psql test まず手順8で以下のエラーが出ます database "postgres" does not exist その後、手順9を実行すると以下のエラーがでます createdb: could not connect to database template1: could not connect to server: そのようなファイルやディレクトリはありません Is the server runnning locally and accepting connections on Unix domain socket "/tmp/.s.PGSQL.5432"? 解決策等ご存知でしたら教えて頂けないでしょうか？ よろしくお願い致します。
一つのSQLで下記の様な検索が出来ないかと考えています、 大分類に分けて大分類の中で売れている商品のTOP10を表示し、 現在表示されている商品を抜いた売れている商品TOP100もに表示できるようとしています、 分類のテーブル・商品がどの分類に当てはまるのか関連づけし注文数も保持しているテーブル・商品の売れ行きを保持しているテーブルがあり 分類テーブルには15個(将来的に増える可能性ある）の分類ワードが入っていて、分類別に売れているTOP10を表示し重複部分もあるので最大150個の商品が表示されるようになっています、 全商品の売れ行きTop「表示されている商品プラス100件」を割り出しその中から表示商品はずしてみようと思いこの様なSQL文と作ったのですが今一うまくいっていないような気がします、 「select 商品名 注文数 from 商品テーブル　 　　where 商品名 not in（ select 商品名 from 分類商品テーブル　where 分類 in ( select 分類 from　分類テーブル ) 　　　order by 注文数 desc limit 10） order by 注文数 desc limit 表示商品数＋100」 どうもうまく表示できていない様な気がしているのですが、 このSQLどうなのでしょうか？ ほかにもっといいSQL文があれば教えてください。 」
PostgreSQLの質問です。 元テーブルを新規テーブルに項目だけコピーしたいのですが、 primary key などの制約も同時にコピーする方法を教えて頂けないでしょうか？ 下記で、空のテーブルをコピーできると思ったのですが、これでは制約はコピーされないようです。 CREATE TABLE tableName_temp AS SELECT * FROM tableName WHERE 1 = 0 また、後付で制約をつけるにも、CREATE TABLE時にしかつけることができないみたいです。 何かよい方法がありましたら、宜しくお願い致します。
ｐｓｑｌ（8.0.1)で日本語が入力できない。 　コメントやデータベースをＣＲＥＡＴＥするとき、日本語を入れたい（たとえば、氏名とか住所等）のですが、まったく日本語が入力できません。psqlで日本語の入力をするにはどうすればよいのでしょうか？ 　なを、pgAdmin　III　ではEXELから日本語を持ってこれます。 「パソコン環境」 OS:Windows　XP　professional　SP2 日本語入力；MS　IM その他；psqlのプロパティでは日本語シフトJISになっています。 「当方の技術レベル」 極最近、PostgrSQLの勉強を始めた、初心者です。 パソコンの操作もあまり得意ではないです。
HTMLのチェックボックスから、データベースにデータ入力する仕組みを検討しております。 HTMLページでチェックされたものは、keywordカラムに入力されるようにしたいと考えております。 1) HTMLページ <? require('../include/init.inc'); $email = $_POST{'email'}; ?> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=EUC-JP" /> <FORM name="myFORM"> <INPUT type="checkbox" name="name[]" onclick="chg()" value="aaa">：aaa <INPUT type="checkbox" name="name[]" onclick="chg()" value="bbb">：bbb <INPUT type="checkbox" name="name[]" onclick="chg()" value="ccc">：ccc <INPUT type="checkbox" name="name[]" onclick="chg()" value="ddd">：ddd <INPUT type="checkbox" name="name[]" onclick="chg()" value="eee">：eee <INPUT type="checkbox" name="name[]" onclick="chg()" value="fff">：fff </body> </FORM> <form action="Test1.php" method="post"> <input type=submit value='選択'> 　→ ここで配列のデータを変数に入れる処置が必要？ 2) Test1.php <? require('../include/init.inc'); $email = $_POST{'email'}; $name = $_POST{'name'}; var_dump($HTTP_POST_VARS); $sql = "BEGIN; update mailing_list_sentaku set keyword = '$name' where mailing_list_name = '$email'; COMMIT;"; pg_query("$sql"); ?> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=EUC-JP" /> </head> <body> ・データベース 　- postgresql 8.1.9 　- PHP 5.2.1 postgres=# \d mailing_list_sentaku 　・mailing_list_name ： character varying(40) 　・keyword ： character varying(200) 現状は、Test1.phpにもデータが渡っておらず、原因がつかめていない状況です。ご協力よろしくお願いいたします。
はじめまして、tanu_2です。 玄箱HGをDebian化し、いろいろと遊んでいます。 PostgreSQLをapt-getでインストールし、Webアプリを動かしていたのですが、昨日より突然、PostgreSQLが動かなくなってしまいました。 原因が分からず、サーバを再起動し、 # /etc/init.d/postgresql start や $ pg_ctl start などを試してみたのですが、動きません。 念のため、初期化（initdb）も試みたのですが、これも失敗してしまいます。 /var/log/postgresql/postgres/logを覗いてみると、 FATAL: could not write lock file "/var/lib/postgres/data/postmaster.pid": No space となっており、上記ディレクトリにpostmaster.pid書き込みできないよ、と言われているっぽかったので、パーミッションを変更したりして みましたが、postgresql startにしろ、pg_ctl startにしろ、それぞれのコマンドで起動すると、強制的にパーミッションが「700」に変更されてしまうようで、結果は同じでした。 どなたか、解決策をご教示願えませんでしょうか？ よろしくお願いします。m(_ _)m
こういうソートがしたい。 ソート前： article_id | disp_no | write_d ------------+---------+--------------------- 1 | 1000 | 2007-06-05 22:33:00 2 | 1001 | 2007-06-06 11:09:00 3 | 2000 | 2007-06-06 11:18:00 4 | 2001 | 2007-06-06 11:18:00 5 | 3000 | 2007-06-06 11:18:00 (5 rows) ソート後： article_id | disp_no | write_d ------------+---------+--------------------- 3 | 2000 | 2007-06-06 11:18:00 4 | 2001 | 2007-06-06 11:18:00 5 | 3000 | 2007-06-06 11:18:00 1 | 1000 | 2007-06-05 22:33:00 2 | 1001 | 2007-06-06 11:09:00 (5 rows) できるのかな？
EVENT --+------------+------------+ id | start_date | end_date --+------------+------------+ 0 | 2007-06-01 | 2007-06-03 | --+------------+------------+ 1 | 2007-06-04 | 2007-04-06 | --+------------+------------+ 2 | 2007-06-02 | 2007-06-05 | ↑こんな感じでイベントを管理するテーブルがあります。 イベントの開催期間の重複を出力するSQL文を書きたいのですが、 何かいい案はありませんでしょうか？？？ 結果的には重複し合っているレコードのidを出力させたいです。 よろしくお願いします。
ＰＯＳＴＧＲＥＳＱＬの初心者です。ウィンドウズでデータベースを作るとき、adminIIIを使うと便利だと聞いたのですが、adminIIIの使い方を書いてある（詳しくなくてもいいです）本を教えていただけないでしょうか？
pl/pgsqlのFunctionで、ファイル操作はできますか？ また、FunctionでException発生時にエラーコードやエラーメッセージは取得できますか？ Windows,PostgreSQL8.2.3です。
以下のようなテーブルがあります。 hiduke | syuusi | tekiyou | kingaku | bikou 2007-5-8 | 収入 | 給料 | 48000 | バイト代 （以下数十件続く） このテーブルから、次のようにして収入と支出の５月分の合計を求めました。 select syuusi,sum(kingaku) from suitoh_table where hiduke like '2007-5-%' group by syuusi; syuusi | sum 収入 | 61000 支出 | 15080 するとこのように表示されるのですが、ここからさらに「収入－支出」と計算するにはどうすればいいのでしょうか？ 最初のselect文の段階で、収入－支出の計算までさせたいのですが・・・。
CentOS5にpostgreSQL8.3をtarからインストールしようとしているのですが、"./configure --enable-multibyte=EUC_JP"とすると "configure: error: readline library not found"となるので、 readlineを # ./configure # make # make install # ldconfig としたのですが、再び同じエラーとなります。 ld.so.confにも"/usr/local/lib"と加えてあらためてldconfigとしてもダメでした… readlineインストール時に "install: you may need to run ldconfig"と出るのでreadlineはちゃんとインストールできていると思っているのですが、無理やり"./configure --enable-multibyte=EUC_JP --without-readline"として通してもやっぱり納得がいきません・・・ いったいまず何を見たらいいのでしょうか？
ほとんどMySQLしか使った事がなく、PostgreSQLのデータタイプに不明なものが多いです。 参考書も持っているのですが、それらの説明がありません。 PostgreSQLのデータタイプについて説明があるサイトなどありませんでしょうか？ 自分で探してもいいサイトが見つかりません・・・。
現在PostgreSQLとPHP5を利用してアプリケーションを開発しております。 PHPにて現在すでに存在するPostgreSQLのテーブルの定義情報を取得するにはどうすればよろしいでしょうか。テーブルの定義情報は下記のようにSQLのCREATE文で取得したいと思っております。 CREATE TABLE favorite ( code serial NOT NULL, reg_date timestamp without time zone NOT NULL DEFAULT now(), update_date timestamp without time zone, title text, url text, u_id character varying(20) NOT NULL, enabled_flag smallint NOT NULL DEFAULT 1, CONSTRAINT web_favorite_pkey PRIMARY KEY (fv_code) ) 何卒よろしくお願いいたします。
「PostgreSQL」と「SQL Server」があり、aspで検索画面を作成しています。 PostgreSQL：Tbl_aaa(顧客No.、顧客名、住所、・・・） SQL Server：Tbl_bbb(顧客No.、契約日、契約金額、・・・） 上記のようなテーブルとフィールドがあるとして、どちらか一方の検索を行う場合は何も問題ありません。 例えば、契約日を検索条件に指定した場合、Tbl_bbbから一致した一覧が抽出されますよね。 抽出された結果を元に、Tbl_aaa.顧客No.=Tbl_bbb.顧客No.で再度抽出し、その結果を画面に表示させる。という事をやりたいのですがどうすればいいのかわかりません。 Tbl_bbbで検索を行い、画面表示の際にDo～Loopなどの中でTbl_aaa.顧客No.=Tbl_bbb.顧客No.となるものを表示させる。という方法を 考えましたが、(件数にもよりますが)結果が表示されるまでかなり時間がかかる為あまりよろしくありません。 そこで、異なるDB間のテーブルをサブクエリなどにする事はできないものかと思い、質問いたしました。 できるのであれば、どうすれば良いのか教えていただけないでしょうか。 できないのであれば、何か良い方法があればご教授下さい。よろしくお願いします。
ASP＋PostgreSQLで検索画面を作成しています。 テーブルに名前、生年月日しかなく年齢をSQLの中で計算しています。 こんな感じです↓ To_Char(age(current_timestamp, To_date(birthday,'YYYYMMDD')),'yy') As genzai_age 「genzai_age」をwhere句で使用したいのですがas句なので利用できません。 「genzai_age」を検索条件にする何か良い方法はないでしょうか？ ご存知の方がいらっしゃいましたら、ご教授願ください。よろしくお願いします。
PostgreSQLで複数の条件での絞り込み検索をしたいのです。 テーブルには 発売日、商品名、入荷日 があります。 例えば 発売日が2007年5月1日から5月5日で、商品名に「○○」もしくは「××」もしくは「△△」が含まれており、入荷日が一番新しいもの という条件で検索したいのです。 発売日だけの絞込みならBetweenですし、商品名だけならor、入荷日の最新だったらmaxを使えば個別には検索できるのですが、これをまとめて一行でやるにはどうしたらよいのかわかりません。 それぞれでandでつなげてみましたが、orの条件がうまく反映されず、一個目の○○だけが検索に引っかかってる状態です。 ××や△△もひっかかるようにするにはどう記述したらよいのでしょうか。
PostgreSQLを使用し、PHPプログラムから・・・ プログラム記述をミスしてしまい。 トランザクションを終了できないままテーブルがロックされてしまいました。 bigin を実行し　lock table しましたが　何と commit 文が注釈に なっており、テーブルがロックされたままの状態になってしまいました。 drop table もできなくなっています。 とにかくこのロック状態を解消したいのですが・・・ よろしくご教授ください。
はじめまして。php5とpostgresを使って、ブラウザで都道府県をセレクトで複数選択（prefecture[]）して、postgresに select city from city_table where p_id='prefecture'; としているのですが、結果を出力できません。 print_rで見たところprefectureに複数選択した都道府県のidが配列として入っていることは確認しております。 where句に配列を入れて検索するにはどうすれば良いのでしょうか？ よろしくお願いいたします。
<%@ page contentType="text/html; charset=Shift_JIS" %> <%@ page import="java.sql.*,javahello.DBConnectionPool" %> <%! DBConnectionPool pool; %> <% Connection con = null; Statement stmt = null; try { // コネクションプールクラスのインスタンスを取得 pool = DBConnectionPool.getInstance(); // データベースへの接続を取得 con = pool.getConnection(); // ステートメントオブジェクトを生成 stmt = con.createStatement(); // 全ての行を検索するSQL文を作成 String sql = "SELECT * FROM SHAINLIST"; ResultSet rs = stmt.executeQuery(sql); // 一覧表示用テーブル String tableL = "<table border=1>"; tableL +="<tr bgcolor=\"000080\"><td> <font color=\"white\">ID</font></td>" + "<"td nowrap><font color =\"white\">名前</font></td>" + "<"td colspan = 2><font color=\"white\"出欠</font></td></tr>"; // 取得結果の処理 while(rs.next()) { int id = rs.getInt("member_id"); String name = rs.getString("name"); int state = rs.getInt("attendance"); String comment = rs.getString("comment"); String cell1; String cell2; switch(state) { case -1://欠席 cell1 = "<font color=\"red\"><b>欠席</b></font>"; cell2 = "<br> + comment +"<br><br>"; break; case 1://出席 cell1 = "<font color=\"blue\"><b>出席</b></font>"; cell2 = "<br>" + comment + "<br><br>"; default://未定 cell1 = "<b>未定</b>"; cell2 = "<form action=\"sub.jsp\">" + "<input type=\"hidden\" name=\"member_id\" value=\"" + id + "\">" + "<input type=\"radio\" value=\"1\" checked name=\"attendance\">出席" + "<input type=\"radio\" value=\"-1\" name=\"attendance\">欠席<br>" + "<input type=\"text\" name=\"comment\" size=36> " + "<input type=\"submit\" value=\"登録\"></form>"; } // テーブル用 tableL += "<tr><td align=\right" bgcolor=\"A0A0A0\"><b>"+id+"</b></td>" + "<td nowrap>" + name + "</td><td>" + cell1 + "</td><td>" + cell2 + "</td></tr>"; } tableL += "</table>"; db.close(); %> <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> <html> <head><title>データベースへのアクセス</title></head> <body> <p>-- データベースへのアクセス --</p> <p> <b>新人歓迎会 出欠状況一覧</b><br> <%= tableHTML %> </p> </body> </html> まちがってるところ がみつからないですが。。みなさん助けてくださいｍｍ よろしくお願いします。
よろしくお願いします PostgreSQL 8.0.8です 現在 code date 1　　　　2007-04-02 12:52:22.239818+09 1　　　　2007-03-02 12:52:50.90313+09 2　　　　2007-04-02 13:08:35.093001+09 2　　　　2007-04-02 13:11:08.532232+09 というデータがあるとし これをcodeでグループ化して、codeが何件あるかを調べたいです ただし、dateが本日から30日以上前の場合は省くという条件をつけたいのですがエラーがでてうまくいきません SELECT code,COUNT(code) AS cnt FROM test GROUP BY code HAVING date(date) >= '30前の日付' どう書いたらうまくいくのでしょうか？ よろしくお願いします。
昨日こちらで自分の間違ったSQL文をご指摘頂き 時間計算の処理は実装する事が出来たのですが その後の計算処理が終わった後、計算結果をDBに格納する処理で 再度躓いてしまったので、再度のご教授お願いします。 $sql = "SELECT SUM(ROUND(労働時間/100, 0)) + ROUND(SUM(MOD(労働時間,100)) / 60, 2) AS total 　　　　FROM 労働時間テーブル WHERE id = 'ログインしている人のID';"; $total_Time = pg_query($con, $sql); $total_Time = pg_fetch_result($total_Time, 0, 'total'); // 確認のため、表示 echo $total_Time; で値はきちんと表示されおります。 しかし、この後UPDATE文で $sql = "UPDATE 労働時間テーブル SET 総労働時間 = '$total_Time' WHERE id = 'ログインしている人のID';"; pg_query($con, $sql); と打ち試しましたが、echoの時に表示された値がDBに格納されません。(>_<) 試しに $sql = "UPDATE 労働時間テーブル SET 総労働時間 = '$total_Time' WHERE id = 'ログインしている人のID';"; の'$total_Time'をSELECT文に変更したりもしましたが、echoの時に 表示されていた値とは違う値がDBに格納されるようになってしまいました。 どのように解決したらよいか、悩んでおります。 そもそもの考え方から間違っているのでしょうか？ ご教授の程、よろしくお願い致します。
現在、Postgresを使って簡単なシステムを作っていますがどうしても わからないので質問させていただきます。 四つのてーぶるがあります。 　(1)名簿 　　　名前　|　部門 　　　aaa　　　1 　　　bbb　　　1 　　　ccc　　　2 　(2)部門表 　　　部門　|　部門名 　　　　1　　　第１営業 　　　　2　　　第２営業 　(3)商品表 　　　商品id　| 商品名 　　　　1　　　　りんご 　　　　2　　　　ババナ 　(4)売上 　　　No | 名前 | 商品id | 日付 　　　1　　aaa　　　1　　　2007/04/07 　　　2　　ccc　　　1　　　2007/04/07 　　　3　　aaa　　　1　　　2007/04/08 このようなとき以下の表を一度に作れますか。 第１営業でりんごを売ったかどうか、売った場合は最新日付を表示 したいのです。 具体的には 　　名前　| 日付 　　aaa　　　2007/04/08 　　bbb のようにです よろしくお願いいたします
phpとpostgressqlで開発をしております。 さて、 date列に条件によって日付を入れたり、入れなかったりします。 日付を入れる場合はＯＫですが、 日付を入れない場合は、nullとすると、下記のエラーが出ます。 Query failed: ERROR: invalid input syntax for type date: "" null以外に''も試しましたが、エラーになります。 何か対処方法を教えてください。 よろしくお願いします。
言葉で表現するよりも、サンプルのSQL文で分析してもらう 方が理解しやすいと思いますので、そのやり方で進めさせて もらいます。 実際にやりたいことは、 select * from example1 where (key1, key2) in (select key1, key2 from example2); の値リスト版になります。 もちろん、上記のselect文での副問合せでは正常に結果は得られます。 実際にやってダメだった例は select * from example1 where (key1, key2) in ((値A-1, 値A-2), (値B-1, 値B-2), (値C-1, 値C-1)); のようなパターンになります。 単にカッコで括ったリストにすればいいというものではないと判断できる のですが、複数列の副問い合わせ文の値リストはどう表現すればよいのでしょうか？ プログラムを作る際、key1とkey2の連結されたものの集合で それを実現する必要があるのですが、困り果てて、以下のように key1とkey2を連結してから問い合わせさせるようにして、その場を しのいでおります。連結されたものを再度key1とkey2に分割して 目的の副問い合わせをさせるのが狙いです。 select * from example1 where (key1 || key2) in (値1, 値2, 値3); これでも十分結果は得られるのですが、key1、key2にせっかくインデックス を作っていても連結しての問い合わせはその効果は得られず、結果を得る までの所要時間が相当かかってしまうのが欠点です。できるだけ高速に 検索できるようにしたいのが今回の狙いなのですが、今回の件の記述方法 についてのアドバイスをお願いします。
LinuxにPostgresqlをインストールしたのですが、クラスパスがなかなか設定できません。 実行時に -classpathで渡してやる方法は成功したのですが、bash_profileで前もって登録しておく方法がうまくいきません。 そこで気になったのですが、ppstgresqlのインストール先は、root権限下では いけないのでしょうか。 参考書やネットを調べていますと、『rootにはインストールするな』というのもあれば、『rootでインストールしろ』などとあり、情報が交錯しています。 どちらにすればよいのか、そして、どのようにbash_profile修正するのかを 教えてください。 よろしくお願いいたします。
かなりざっくりな質問で申し訳ないのですが サーバーパフォーマンスは一般的なものとしてお考えいただき 10テーブル カラム平均数15くらいで 1日に蓄積される不要レコードが約5万くらいの場合 vacuumdb の実行時間はどのくらいなのでしょうか。 数秒、数分、30分以上、1時間以上など ざっくりでいいのでご教授ください。 また、これらの情報に関する有益なサイト等ご存知の方いらっしゃいましたら、よろしくお願いします。
linuxで使うので何をダウンロードしたらいいですか？
PostgreSQL8.2で、 select * from XX order by 項目名で データ検索した結果に、1～nの通番を 振りたいのですが、ポスグレで実現する 方法はあるでしょか。
MovableTypeでブログを作成しようとしています。 レンタルサーバーのデータベースがPostgreSQLなのですが、DBD::Pgのダウンロードの方法だけがどうしてもわかりません。 いろいろ検索してみても、ＤＬページがリンク切れになっていることも多いです・・。 どなたか、ＤＬ方法を教えていただけないでしょうか？ かなり急いでいます。 ウインドウズXP、FFFTPを使ってのアップロードで、サーバーはBROAD SERVERを使用しています。
　お世話になります。 　今まで主キーの発行はシーケンスを使っていましたが、 シーケンスだと飛び番が発生するので、それ以外の方法を探しています。 　データ追加時に(select max(主キー) + 1)で発行した所、複数人数で使用するDBの為 稀にタイミングによっては同じ番号を拾ってきてしまい、「主キーが重複しています」のエラーが出てしまいます。 　 　主キーを安全に発行するのに、みなさん、どのような方法でされているのでしょうか？ 　googleで検索をしてみましたが、意外と見つからないです。 　どなたかご教示いただけると助かります。
CASE WHEN (name1 IS NOT NULL AND name1 !="") THEN name1"; CASE WHEN (name2 IS NOT NULL AND name2 !="") THEN name2"; ELSE 'NO NAME' こういう事をしたいんですが、できますでしょうか？ 同じ意味で違う方法でも良いのですが…。
SQL ServerのLong型は８バイト？のようですが、PostgreSQLに相当の型は存在しているのでしょうか？3年前からPostgreSQL-->MySQLに以降して、PostgreSQLのことはすっかり忘れてしまいました。 MySQLは現在Ver5ですが、８バイトのような型は無いみたいです。WindowsにインストールしやすかったのでMySQLに移ったのですが、８バイトの型が使いたく、しかもWindowsで簡単にインストールできる状況になったのかも知りたいです。
CASE WHEN a.image_name1 IS NOT NULL THEN '".BASE_DIR_NAME."' || a.image_dir1||'s'|| a.image_name1"; この中の||とはどういう意味なのでしょうか？ PHP でいう $a.'bcd'.$d みたいなものなのでしょうか？
Linuxサーバーで、PostgreSQLを使用したいのですが、 新しいデータベースを追加する際に、 文字エンコードがデフォルトでは「SQL_ASCII」になっているのを「EUC-JP」に変更したいのですが、どうすればいいのでしょうか？ ちなみに、Pleskコントロールパネルは使えます。
CASE WHEN c1 IS NOT NULL THEN 'OK' ELSE (CASE WHEN c2 IS NOT NULL THEN 'OK' ELSE 'NO' ) END AS kekka; こういうようなCASEの中にCASEを使う方法はありますでしょうか？
javaで登録処理を行ないますが、以下のようなことは 可能なのでしょうか？ 環境 DB postgress java1.4.2 やりたいこと TBL-A のキーは1から連番の項目Aです。 最大のAを取得し+1した値で登録します。 2人以上が同時に実行した場合二重登録違反が発生する 可能性がありますので二重登録違反が発生すれば再度 最大のAを取得して登録をやり直したい。 この処理がその他のことで長い時間が掛かりますので 排他をかけたくないと思っています。 ご存知であればご教授お願い致します。 （出来るか出来ないかだけでも教えてください）
SQLで商品名と単価が入ってるテーブルで単価が1000円～1200円で商品名が5文字以上のものを取り出したいのですが教えてください
デフォルトのEUCでインストールしていますが、 これをシフトJISで再構築したいと思っています。 configureのオプションで指定して再インストールするのか、 インストール後の設定ファイルを使って再構築するのか、 再構築の際はinitdbを再度する必要があるのか注意点があれば 教えて下さい。 シフトJISでデータベースを管理したいと思っている のですが、アドバイスを頂けると助かります。 お客様の要望でシフトJISで印刷するようなケースがあり、 EUCコードにこだわっているだけでは解決できないので、 困っているところです。よろしくお願いします。 プログラム環境の方ですが、PHPの設定ファイルは調査した ので、大丈夫だと思います。 使っている環境ですが、 RHL9、postgreSQL7.4.2、PHP4.3.8 になります。
PostgreSQL8.1.1（RedHatLinux）にて テーブルのtext列に対してindexを作成しました。 作成した列に対して、LIKE検索を行っております。 しかし、「EXPLAIN」を利用してSQLの実行計画を見たんですが、 「Seq Scan」からしか始まらず、 「Index Scan」という文字が見当たりません。 PostgreSQLにてindexを張った列に対するLIKE検索では、 indexは使用されないのでしょうか？
pgAdmin IIIで新しいテーブルを作りSQL文の勉強をしているのですが、 DELETE文が実行できません。 ○○というテーブルにある×××という項目が1と2という数値の場合その行を削除するという場合、 DELETE ○○　WHERE ××× IN (1,2) で良いのでしょうか？ ○○、×××ともに日本語でテーブルを作っています。 pgAdmin IIIの設定は特にいじっていません。 とりあえずテーブルを作ってSQL文を試したいと思ってやっているので、 DELETE文を実行する権限がないということはあるのでしょうか？
ファイヤーウォールのログをみていたらルータ側のポート５４３２から自分のPCへアクセスが何回かあり、５４３２について調べてみると PostgreSQLで使用するポートのようですが、簡単にいうと PostgreSQLとは何でしょうか？（インターネットで調べてみましたが今ひとつよくわかりません） サーバとか立ち上げていなくて普通にサイトを閲覧するだけでも関係するものなのでしょうか？ 07/02/192.168.0.1192.168.0.2TCP543249159AF
はじめまして。 今回いきなりPostgreSQLからVBにつないで見れるようにいわれたのですが、 PostgreSQLも何か分からなかったため調べてインストールまではしました。 データを３つくらい何でもよいからといわれたのですが、まずPostgreSQLにデータを落とす方法がわかりません。 色々調べたのですが、分からなくて本当に困ってます。 そのあと、VBにつないでSQL発行をするのですが、そのこととかも分かっていない状態です。 ちなみにwindows使用で、PostgreSQL8.2.3使用しています。 宜しくお願いいたします。
仕事で必要になりSQLの勉強をしています。 教本にある簡単なリレーショナルDBをSQLの文章で操作して勉強したいのですが、実行環境がなくて困っています。 大学でポスグレに触れたのでポスグレでやりたいのですが… ポスグレの設定がよくわかりません。 ポスグレでなくても良いのでSQL簡単に試して学習する方法があれば教えていただきたいです。
OS RedHat、postgresql8.1.5でポスグレのログ設定のために、 postgresql.confを編集しました.(/pgsql/data/postgresql.conf) デフォルト状態から log_connections = true log_statement = true log_duration = true log_timestamp = true のみ変更し、ポスグレを起動したところ、起動できなくなってしまいました.上記部分をコメントアウトすると、正常に起動できます. 何が原因で動かなくなってしまったのか分かりません. よろしくお願い致します.
SQL初心者です。 アドバイスよろしくお願いします。 テーブル create table 時間テーブル ( id_cd text, makeday timestamp); 時間テーブルの　makeday　と現在の日付を比較して一週間以内ならば「1」,そうでなければ「0」を返すSQLを書きたいのですがどうすればよいでしょうか・・ 参考になるURLなどなんでもよいのでアドバイスよろしくお願いします。
postgresでvacuumdbを行うと途中でとまってしまいます 何か対応策があればご教授いただけないでしょうか？ 2.6GあるDBをvucuumかけると、途中で止まってしまっているようなのです お返事いただけましたら幸いです
日本PostgreSQLユーザ会で使われているかめ http://www.postgresql.jp/images/topmini.png これのライセンスをご存知の方教えてください。 GPL同様に営利・非営利を問わず許諾なしで使ってもよいのでしょうか？
主キーに自動インクリメント（ nextval ）を使用しているテーブルで、 そこにレコードを登録したときにそのとき使われた主キー を取得する方法はありますでしょうか。 例えば 主キー｜データ １｜ＡＡＡ ２｜ＢＢＢ ３｜ＣＣＣ にＤＤＤと登録したら恐らくは４になるのですが、 主キー｜データ １｜ＡＡＡ ２｜ＢＢＢ ３｜ＣＣＣ ４｜ＤＤＤ ←追加された データを登録したときにその主キーに何が使われたかが知りたいです が知りたいです。 自分で考えてる方法は今の主キーで使ってるシーケンス＋１が割り当てられる（だろう）というやり方なのですが、複数のレコード登録が同時にあった場合に不整合が起きるのでどうしたものかと困ってます。 なにか良い方法をご存知の方いらっしゃいましたらお教えください。
PostgreSQLのテーブルにCSVファイルをインポートしたいのですが、コマンドの記述の仕方を度忘れしてしまいました・・・。 確かdos2unixとnkfを使ったはずなのですが、その記述方法をご教授ください。お願いします。
PostgresSQL8.1、APACHE2.2、PHP5の環境でＷＥＢデーターベースを作っています。データーベースは作成できたのですが、PG_QUERYなどを使って、フィールド名や、実際のデータなどを、元のテーブルのままに罫線付きでブラウザに表示させる方法としては、何か雛形のような書式があるのでしょうか？ 教えていただきたいのは、特にPg_fetch,pg_arrayなどを使う箇所です。
Postgresql8で、createuserコマンドを使用すると、 Shall the new role be a superuser? (y/n) Shall the new role be allowed to create databases? (y/n) Shall the new role be allowed to create more new roles? (y/n) 以前のＯｒａｃｌｅやＰｏｓｔｇｒｅＳＱＬ７以前では、user追加のメッセージが返ってきたと思います。 何故、新しいuserを作ろうとすると、新しロールを作ることになるのですか？
いつもお世話になっています。 PL/pgSQLでストアドファンクションをコーディング中なのですが、 その中でconnectbyを使って階層問い合わせをしようとしています。 すると、コンパイル中にconnectbyを使っている付近でエラーになって しまいます。connectbyもストアドファンクションだと思うのですが、 ファンクション中に別のファンクションを呼び出すことはできないのでしょうか？
データベース、またはPostgresql本体の CLIENT_ENCODING のデフォルトを設定するにはどうしたらよいでしょうか。 ご存知の方いらっしゃいましたら教えてください。 【現状】 Linux機にインストールしたPostgresqlのCLIENT_ENCODINGをSJISにしたいのですが、DBにconnectする毎に SET CLIENT_ENCODING 'SJIS'; することで対処していますが、出来ればソフト側ではなくDB側の設定で対処したいと考えています。 ■ デフォルト設定のWindowsとLinuxの差異 Windows： 　サーバ：euc 　CLIENT_ENCODING：sjis ※ Linux[centos4]： 　サーバ：euc 　CLIENT_ENCODING：euc ※ Windowsと同じ設定になるようにしたいです。 　 またはCREATEDBのオプションとかでそういうのがあると良いのですが。 PostgreSQLのversion：8.1.5
初めまして.よろしくお願いします. JDBCを使いJAVAプログラムからSelect命令が来たらテーブルの 全データをデリートするという動作をPL/pgSQL言語を使ってトリガ関数 として書きたいのですが、上手い書き方が見つかりません. Select命令をトリガとすると CREATE RULE name AS ON select TO tableName DO INSTEAD ～ となってしまい、DO以下にDelete文が書けないのです. JAVAのexecuteQuery関数を用いて連続してSelect文とDelete文を送る と、Select文とDelete文の実行される間にこのテーブルは随時新たなデータ が挿入される可能性があるので、なんとかトリガ関数で書きたいのです. 良い方法があればご教授のほうお願いします.
http://oshiete.nikkeibp.co.jp/kotaeru.php3?q=267 … 会社の組織図を作成したいと考えております。 データベース（PostgreSql）の部門マスタを元に、会社組織図をツリー状に表示したいのです。 データベース構造は '100';'会社';'101';'経営企画';'';'';'';'';'';'' '100';'会社';'102';'事業統括';'';'';'';'';'';'' '100';'会社';'200';'A本部';'';'';'';'';'';'' '100';'会社';'201';'B本部';'301';'事業管理部';'';'';'';'' '100';'会社';'201';'B本部';'302';'企画部';'';'';'';'' '100';'会社';'201';'B本部';'303';'総務部';'401';'人事課';'';'' '100';'会社';'201';'B本部';'303';'総務部';'402';'総務課';'';'' 上記データを下記のイメージにしたいのです。 (見にくいですが・・・) http://www.geocities.jp/cayanon/sample1.bmp 色々と試してみましたが、 適用できるものがなかったので・・・ よろしくお願いします。
PostgreSQLからSQLServerへデータを移行することになったのですが、 どのような方法が効率よいでしょうか？ PostgreSQLへ直接つなぐことができないので、 ダンプをとって、SQLServerにデータを流し込む。 （そもそもこのようなことができるのか・・・？） CSV形式でデータを出力し、SQLServerの方でインポートする など方法がいくつかあると思うのですが。 なにぶんPostgreSQLに詳しくないもので、 教えていただけないでしょうか。
PostgreSQL 7.4.8 php4.4.4 で開発をしています。 あるログデータを集計したいのですが、 日付の処理が上手くいかずに困っています。 DB側には 日付 | ID 2007-01-01 10 2007-01-01 10 2007-01-01 10 2007-01-01 10 2007-01-01 20 2007-01-01 20 2007-01-01 20 2007-01-10 10 2007-01-10 10 2007-01-10 15 というログデータを日付毎にIDをカウントして 一月単位で日付毎の件数を取得しようとしています。 日付をtruncする事で一月分のデータは取得出来るのですが、 IDが一件も無い日付も「0」で表示したいのです。 php側で吸収する手段も有ると思うのですが 保守性を考えるとデータの取得はsqlで何とかしたいのです。 ご教授頂ければ幸いです。 よろしくお願い致します。
今、WindowsXPでPHPとPostgreSQLを連携 させたいのですがなかなか上手く行きません。 どなたか、分かる方がいれば宜しくお願いします。 環境 ＯＳ→Windows　HomeEdition Apache→Apache HTTP Serber2.0.59 PHP→PHP4.4.4 PostgreSQL→PostgreSQL8.1.4 です。 PostgreSQLの中にtest_dbというデータベースをつくり setuzoku.phpから接続できるかどうかのif文を作り確認 していますが、何度やっても接続失敗と出ます。 <?php $con = pg_connect("user='postgres' dbname='test_db' password='grjtf'"); if (! $con) { print "接続失敗"; } else { print "接続成功"; } ?>
postgreSQLやaccessが初心者な私ですが、 既存のデータベース(postgreSQL)をaccess2003でデータベース内を検索させたいと思っています。 accessとposgreSQLを繋げるにはODBCが必要ということでWindowsXP側には入れたのですが、postgreSQL側にODBCが入っていないようでaccess2003と通信することが出来ません。 前からあるデータベースなのでインストールを行った人がpostgreSQLインストール時にODBCをインストールしないようにしたのかもしれません そこで質問なのですが、ODBCが入っていない状態でpostgreSQLにODBCだけを入れることは可能なのでしょうか？できたらその方法や方法が書かれているページを教えて頂けますでしょうか？お願いします。
CREATE INDEX　は使い方によっては早くも遅くもなると書いてあったのですが、一般的にはCREATE INDEXはどういう時に使うのでしょうか？
質問です LINUX,PHP4,MySQL3の環境です。 用意したテーブル 個人情報テーブル →ID →名前 地域情報テーブル →ID →名前 個人+地域情報関連付けテーブル →ID →個人TableID →地域TableID というDBを設計しました 問題は個人情報と地域情報を関連付けるテーブルへとデータを入力するフォームなのですが ブラウザ上で、登録された(別途地域登録フォームなどより)地域を地域情報テーブルより引き出し表示させ その中から選択された地域より今度は個人情報を引き出し表示させ 関連付けされたテーブルへと登録するような流れです この時、フォームのCheckboxで複数の個人情報を選択できる形のフォームを作成しました 選択できるCheckboxはは個人情報テーブルより個人情報をループ処理によって出力しています この時、既に個人+地域情報関連付けテーブルへ登録されている個人情報+地域情報をチェックボックスのループ処理に反映されないようにしたいのですが どのような方法がありますでしょうか？ 色々なSELECT文を試してループ処理をさせていたのですがなかなかうまくいきません。 具体的には、結局全種類もしくは同じ個人情報が複数個ループされたりします・・・ ループ処理はSELECT文から関連付けテーブル>各情報テーブルと3つのテーブルから引用して必要なIDと名前を条件付で選びました 条件はいろいろなものを試したのですがどれもうまくいきません ループ処理でのPHP部分も含めて可能な方法を教えてもらいたいです よろしくおねがいします！
会社からＳＱＬのSELECT文を書けと言われて３日目です。PostgreSQL のシステムでWHERE以下が WHERE 売上年月 = ? AND 得意先コード = ? AND 売上種別 = ?　としました。画面上では売上年月、得意先コード、売上種別で検索できるようになっているのですが、３種類全て入力しないとエラーになります。この内１種類の入力でも検索できるようにしたいのですが、どのように書けばいいでしょうか？ ANDをORに変えたりしたのですが上手くいきません。 全体のSELECT文は external.売上= SELECT　売上番号、売上日、得意先コード、売上区分、金額、入力日 FROM 売上一覧表 WHERE 売上年月 = ? AND 得意先コード = ? AND 売上種別 = ? です。 よろしくお願いします。
テーブルがふたつあります。 片方のテーブルA(hoge1)のnameに、もう片方のB(hoge2)のnameをいれたいのです。 テーブルAとBはidでリレーションを張って、それぞれ対応する列にいれたいと思ってます。 tabale A hoge1 id | name | foo ----+-----+---- 1 | 1111 | xxxx 2 | 2222 | yyy 3 | 3333 | zzzz tabale B hoge2 id | name | bar ----+-----+--- 1 | 1.net | 1 2 | 2.net | 0 3 | 3.net | 1 期待する結果 tabale A hoge1 id | name | foo ----+-----+---- 1 | 1.net | xxxx 2 | 2.net | yyy 3 | 3.net | zzzz Bに変更はなし update hoge1 set name = b.name from hoge2 b , hoge1 a where a.id = b.id ; とやるとname列が全て 1.netになってしまい UPDATE hoge1 SET name = (select b.name from hoge2 b , hoge1 a where b.id = a.id ) ; ERROR: More than one tuple returned by a subselect used as an expression. とするとエラーです。（oracleならうまくいくとnetで調べたのですが。。） どなたかご教授いただけますか。
PHP 4.4.2 + PostgreSQL 7.4.8 です。 今、フィールド「DATE」、データ型「timestamp with time zone」に 　2006-12-14 09:00:28.853324+09 　というデータが入っています。 このデータをウェブ上で ○月○日○時○分 という形式で表示させたいのですが、どのようにすればよいでしょうか？ よろしくお願いします。
現在、PostgreSQLを使用してWebアプリケーションを作成しています。 いくつか、テーブルがある中で、一つのテーブルが使用している容量をしるSQLコマンドってあるのでしょうか。 SQLコマンドでなくてもかまいませんので、使用量が分かる方法を教えて頂けないでしょか。 よろしくお願いします。
スケジュール帳のWebアプリを作成していて PostgreSQLを使用しています。 sc_tblというテーブルのday_timeというカラムに日時 to_doというカラムに予定を入れているのですが 日時2006/12/01 01:00のデータを期間の抽出条件で抽出する時 2006/11/30 20:00～2006/11/30 26:00という条件で抽出できるような SQL文はあるのでしょうか。(1:00を25:00として抽出したい) 下記2つのSQLでは無理でした。 ・その1 select day_time, to_do from sc_tbl where day_time >= cast('2006-11-30 20:00:00' as timestamp) and day_time <= cast('2006-11-30 26:00:00' as timestamp); ・その2 select day_time, to_do from sc_tbl where day_time >= to_date('2006-11-30 20:00:00','YYYY-MM-DD H24:MI:SS') and day_time <= to_date('2006-11-30 26:00:00','YYYY-MM-DD H24:MI:SS');
ある人に、こんなSQLを教えてもらいました。 ----------------------------- select id,tid,NULL as "res_no",account_id,name,date from t_game_bbs as a union select id,tid,res_no,account_id,name,date from t_game_res as b where del_flg != 1'; order by date DESC limit 10; -------------------------------- 不思議に思ったのが、”NULL as "res_no"”のところです。 これについて、ググッて見たのですが、明確な説明が見つかりませんでした。 これって、SQLの隠し機能なのですか？
学校で、DBの勉強をしています。自宅でもDBの勉強が出来る環境を用意したいです。 学校では、サーバーを設けて、サーバーにアクセスしてDBを利用する環境ですが、そうでなく、自分のパソコンにpostgreとCSEとデータを置いて、DBを使う環境で利用したいです。 OSはWINDOWS　XPです。使用するDBMSは、postgreSQLで、CSEを利用し、データとして、 ttp://www.c-r.com/から提供されているのを使います。 ネットのページを参照して、postgreSQLのインストールは出来ました。 次に、CSEの設定を行いたいのですが、サーバー名とデータベースの欄に何を入力すればよいのか わかりません。 サーバー名には、IPアドレスを入力すれば良いのでしょうか？ ただ、ネットには無線LANで接続しており、IPアドレスはDHCP機能でその都度割り振られており、固定のIPアドレスはありません。 検索していて、localhostと入力するとあったので、これも試しましたがエラーが出ます。 　データベース接続時にエラーが発生しました。 　DBエラー詳細： 　fe_sendauth:authentication type 5 not supported データベース名には　 ttp://www.c-r.com/＞データ舘＞データベースソフトの一番上にある「仕事力～」のPostgreSQL のデータを使いたいです。そのためには、ダウンロードしたこのデータのファイル名を入力すれば良いのでしょうか。ただ、ファイル名が日本語です。 こちらもエラーが出ます。 　データベース接続時にエラーが発生しました。 　DBエラー詳細： 　connectDB()--socket() failed:errno=0 　NO error 解決する知識をお持ちの方、どうかご教授ください。宜しくお願いします。
皆さんよろしくお願いします。 現在当方windowsXP & Postgresql8.1にてサーバを構築しております。 サイトが完成したのでそろそろDB全体のバックUPを行いたいのですが、 windowsでpg_dumpallを実行するにはどうすればいいのでしょうか？？ １からわからないので出来るだけ詳しく教えていただけるでしょうか？？ よろしくお願いします。m(__)m 【追伸】 pg_dumpallってテーブル構成やユーザー以外にも格納されている データもバックUPされるのですよね？？
質問お願い致します。 RedHatとPostgreを使用していて 現在8GBデータが入っているDBがあるのですが 『VACUUM FULLをするタイミング(しきい値)を教えてください』 とお客様から質問が来たのですが自分なりに調べてみまして ・データが増えすぎたら ・データの削除や更新が頻繁に行われたら と答えたのですが納得していただけず、 メンテナンスをする為に かなり正確な使用する間隔期間を知りたいらしく、 どういった数値を元にして どれくらいの期間ごとにVACUUM FULLを使用すればいいのか 教えていただけないでしょうか。 何卒よろしくお願い致します。
以下３つのSQLを実行した場合に検算が 合わないのですがどのように解釈して いいのでしょうか。 (1)の件数＋(2)の件数 ＝ (3)の件数になると 考えては駄目ですか？ (1) select count(A.*) from tbl_a A,tbl_b B where A.komoku1 = B.komoku1 and A.komoku2 = B.komoku2 and A.komoku3 = B.komoku3 (2) select count(A.*) from tbl_a A,tbl_b B where A.komoku1 = B.komoku1 and A.komoku2 = B.komoku2 and A.komoku3 <> B.komoku3 (3) select count(A.*) from tbl_a A,tbl_b B where A.komoku1 = B.komoku1 and A.komoku2 = B.komoku2
今、ＳＥＬＥＣＴ文で取得した値をround()を使って四捨五入したいのですが、構文エラーになります。 SELECT ROUND( SELECT 0.2*(SLECT number FROM sample WHERE id =1) ); ROUND()内のSELECT 0.2*(SLECT number FROM sample WHERE id =1) で、値が12,6のように返ってきます。 しかし、round()で四捨五入して１３を取得しようとすると構文エラーになります。 どうしたらいいのでしょうか？ よろしくお願い致します。
以下を実現するＳＱＬ文教えてください。 テーブル名：i_num id | number ^^^^^^^^^^^^ a | 5 b | 4 c | 2 d | 6 e | 9 上記の表で、０に近い値から足し算を行い、全体の５０％を超えたときのnumberを取り出したいです。 c+b+a+d+e / 全体　が５０％を超えた時のnumberは、ここでは、d=6を取り出したいです。 よろしくお願い致します。
PostgreSQLのバックアップについて質問です。 24時間稼動しているPostgreSQLのバックアップを1日1度pg_dumpコマンドでとって、復旧時に使用しておりますが、完全に復元する方法がわかりません。 例えば1日の途中にデータが破損した場合、前日までのデータは pg_dumpで復旧できますが、その後のデータが破損する直前までを WALを使ってどのように復旧させるのでしょうか。 /usr/local/pgsql/data/pg_xlog/の直下に"000000070000006D"という名前のファイルはあるのですが、そのログを使ってRedoするやり方がわかりません。 更にトランザクションログのチェックポイントを1時間に1回と設定したりしてログ日付・時間の名称で保存の後次の日には新しい名称で ログをとりたいのですが、そのようなことはできるのでしょうか。
postgreSQL 8.1.3 を使用しています。 database 内に作成した全テーブルの列数を調査しています。 全テーブルに対して select count(*) を発行する方法でも良いのですが、 テーブル数がいっぱいある際に、とても調査が面倒になってしまいます。 そこで、なんらかのSQLで各テーブルの列数を一気に返す方法はないかと考えていますが、 そんな方法って無いですか？
かなり困っています。REDHAT LINUXでpostgresのテーブルにpsqlからのCOPYコマンドでcsvファイルのデータをインポートしようとしているのですが、文字数オーバーのエラーがでてしまいます。テーブルは２列で１つ目の列はCHAR(10)で２列目はINT4型です。csvファイルの内容はとりあえず１行だけ入れていて「"1234567890","1234"」を入れています。コマンドはpsqlで「COPY テーブル FROM 'ファイルのパス' USING DELIMITER ","」で行いました。エラーはおそらくインポートしたデータがおかしくなって変な桁数になっているのですが、どういうふうにおかしくなっているのかがよくわからないので対策できません。
現在fedoracore5を導入し、postgre8.1の初期設定を行っております。 インターネットの説明にはpostgresql.confに『tcpip_socket = true』の設定を追加すると記載さてれております。 しかし、そのような記載を行わなくても別端末からssh接続で操作することが可能でした。 V8.1からpostgresql.confファイルの編集はしなくてよい事になったのでしょうか？また、fedoracore5の導入時に入っているpostgreSQLのデフォルトバージョンはいくつなのでしょうか？ 今回はFedoraCoreからyum installで導入したのですが、これは最新のモジュールをダウンロードし、インストールしているという認識でよいのでしょうか？ 質問ばかりとなてしまい大変申しわけないですが、どなたかご回答をお願いいたします。
PostgreSQL環境でのSQL文です。 テーブル[A_TABLE]のDate型の項目[mDate]をキーにして、古いものから30件を削除したいのですが、 このようなSQL文は有効でしょうか？ DELETE FROM A_TABLE WHERE RowNum <= 30 ORDER BY mDate 現在手元に試してみる環境が無いため困っています。 よろしくお願いします。
postgresql-8.1.2-1-jaのインストール中で手続き言語の有効化で「データベースの接続に失敗しました。手続き言語ファイルは活動的にされません。」とのメッセージが出て、イントールは完了しましたが、pglqlには接続できません。 ユーザー名のpostgresを削除して、最新のpostgresql-8.1.4-1-jaで再度インストールしましたが、同じ結果です。ウイルスソフトは終了させています。 考えられる原因を教えてください。 環境はwindowsXP SP2 Profetional マカフィインターネットセキュリティです。
初めまして、最近SQLをかじり始めたぺーぺーです。 効率の悪いSELECT文しか書けずに困っています。 下記のテーブルsoftware_tableから、 ・name列「oracle」 ・version値が最大 のレコードに含まれるid(=3)を拾ってきたいのですが、自分の頭では副問い合わせを使う方法か、ソートを使う方法しか思いつきません。 問題は副問い合わせ・ソートを使うと計算コストが大きくなってしまうことで、できることなら副問い合わせ・ソートを使わずに解決したいのですが、何か方法はないものでしょうか？ よろしくお願い致します。 ----------------------------- software_table idnameversion 1oracle1 2oracle2 3oracle3 4postgres1 5postgres2 6postgres3 7postgres4 ----------------------------- ■副問い合わせを使った方法 SELECT id FROM software_table WHERE name = 'oracle' AND version = (SELECT max(version) FROM software_table WHERE name = 'oracle'); ■ソートを使った例 SELECT id FROM software_table WHERE name = 'oracle' ORDER BY version DESC LIMIT 1 OFFSET 0; -----------------------------
PostgreSQLの配列に対して、要素の追加及び削除を行いたいのですが、下記のような動作をさせるには、※1と※2で、どのようなSQLを実行すれば良いでしょうか？ よろしくお願いいたします。 >>> CREATE TABLE test ( id integer, data integer[] ); INSERT INTO test VALUES (1, '{0,1,2,3,4}'); INSERT INTO test VALUES (2, '{5,6,7,8,9}'); SELECT * FROM test; id | data ----+------------- 1 | {0,1,2,3,4} 2 | {5,6,7,8,9} (2 rows) UPDATE test [data配列に10を追加] WHERE id = 1; /* ※1 */ UPDATE test [data配列から6を除去] WHERE id = 2; /* ※2 */ SELECT * FROM test; id | data ----+------------- 1 | {0,1,2,3,4,10} 2 | {5,7,8,9} (2 rows) <<<
CGIとSQLで掲示板を作っているのですが、EUCでデータベースに日本語が入ったのですが表示する際に文字化けしてしまうのですが文字化けしない方法はありますでしょうか？
FedoraCore4にPostgresql7.4.6をソースからコンパイルしてインストールしました。 学習書に、 PHPインストール時に　configureオプション　 --with-config-file-scan-dir-DIR　で指定したディレクトリにpgsql.ini をおく、と書いてあるのですが、私の場合、yumでPHP5.04 をインストールしています。 /usr/local/pgsql/の下に、bin,doc,include,lib,man,shareの各サブディレクトリはあります。 /etc/php.d　ディレクトリはありますが、中は空です。pgsql.ini ファイルを見つけることが出来ません。 １．pgsql.ini　ファイルは何所にあるのでしょうか？ ２．新規に作成する必要があるのでしょうか？ ググリましたが、適当な資料を探し得ませんでした。 pgsql.ini　の編集と置き場について、良い参考資料を教えて頂ければ大変有難いです。
いつもお世話になっております。 下記のアドレスを叩くとPowergresの起動・停止を設定できるWebの画面にジャンプしていたのですが、httpd.confを中心に設定をいじっていたところ、見れなくなってしまいました。（hostsの設定も若干触りました。） 原因として何が考えられますでしょうか？ 具体性を欠く内容で申し訳ありませんが、どうぞ宜しくお願い致します。 下記にＵＲＬとそれに伴うエラーメッセージを付けます。 URL: http://localhost:13000/admin/postgres.html Failed to Connect The connection was refused when attempting to contact localhost:13000. Though the site seems valid, the browser was unable to establish a connection. * Could the site be temporarily unavailable? Try again later. * Are you unable to browse other sites? Check the computer's network connection. * Is your computer or network protected by a firewall or proxy? Incorrect settings can interfere with Web browsing
お世話になっております PostgreSQL8.1を使用しまして あるテーブルにInsertがかかると その内容を判断し別のテーブルに insertをする仕組みが必要になり いろいろ試してみて TriggerとFunctionを使用すれば 実装できるとこまでわかりました。 ただしその別テーブルが別DBに配置されているので そのテーブルに以下のようなInsert文を発行しても エラーになってしまいます。 Insert into SUB_DB.TEST_TBL values('test','date'・・・・); （SUB_DB:ストアドを実行しているのとは別のDB） ストアドから別テーブルを参照更新する手段を ご存知のかたご教授いただけますでしょうか。 よろしくお願いいたします。
COPYコマンドを利用し、CSVファイルデータをテーブルへ登録しようと思うのですが、CSVファイルの１行のデータ数が300あります。300のフィールドを作成せずにフィールドを配列にしたみましたが、うまくいきません。配列では不可能でしょうか。 CSVファイルの１行のデータ数が多い場合は、何かよい方法がありますでしょうか。 CSVファイル No,Data1,Data2,....Data300 テーブル CREATE TABLE Data_log ( No int4, IN_data float8[] ) WITHOUT OIDS; SQL文 COPY Data_log from '" & ファイルパス & "' WITH DELIMITER ',';" 上の様に作成しましたが、SQLがうまくいきません。 どうぞ宜しくお願い致します。
PostgreSQLについての質問です。 1つのデータベース内に作成できるスキーマの最大数をご存じの方いらっしゃいませんか？ バージョンは8.1.4を前提としています。 よろしくお願いいたします。
テーブルが２つありまして、既存テーブルには 担当者コードが入っておらず（フィールドはあります）、その担当者コードフィールドへ既存テーブルの時刻からそれに合った担当者コードを担当者テーブルからを参照し登録する作業を行いたいのですが、１つのSQL文で可能なのでしょうか？ 既存テーブル ID,InDate(時刻),UserCode(担当者コード) 1,2006-09-01 10:20:30,'' 2.2006-09-02 12:10:50,'' 担当者テーブル UserCode,UserName,StartTime,EndTime 111,ABC,2006-09-01 09:00:00,2006-09-01 13:30:00 222,DEF,2006-09-02 09:00:00,2006-09-01 13:30:00 の様なデータが合った場合 既存テーブルのID1のUserCodeへ111 既存テーブルのID2のUserCodeへ222 と入れるようなSQLを作成したいのです。 update 既存テーブル set usercode = (select b.usercode from 既存テーブル as a,担当者テーブル as b where a.InDate > b.starttime and a.InDate < b.endtime); と作成はしてみたものの ERROR: more than one row returned by a subquery used as an expression とエラー表示されます。 複数のレコードがあるからエラー？ってことなのでしょうか。 ver:PostgreSQL 8.1 どのようにすると、可能になるか教えてほしいのですが、どうぞよろしくお願いします。（説明がうまく出来ず申し訳ありません…）
LinuxでPostgreSQLが起動しなくなる、 postmaster.pid　ファイルが作成される原因には、 何がありますか？ いくつもあるのでしょうか？
はじめまして、質問をさせていただきます。 ２週間前からコストダウンのため、Windowsサーバであった 支店ＤＢをLinux+Postgresqlに変更しています。 本社ＤＢ（Windows＋oracle）とほかの支店ＤＢ（Linux+Postgresql） とのデータのやり取りをするのに何か良い方法はありませんか？ 今のところ、ＪＤＢＣを利用する方法を検討しています。 なにぶん初心者なので、ご迷惑をおかけしますがよろしくお願いします。 以上
当方現在windowsXPにてpostgresql8.1.4を動かしております。 そろそろテーブル設計も終わったので全ての状況をバックアップとっておこうかな？と思いまして、psqlにてpg_dumpallを実行したのですが、 pg_dumpall db_test01 > test; ↑と打っても↓ ERROR: syntax error at or near "pg_dumpall"(文字位置: 1) 行 1: pg_dumpall db_test01 > test; が帰ってきて実行する事ができません・・・ 何方かお分かりの方いますでしょうか？？ よろしくお願いします。
PostgreSQL8.1.4を利用しています。 1日約2万件のINSERTを行うデータベース の保守を行う予定です。 PostgreSQLの保守にvacuumは欠かせないというのが 通説だとは思うのですが データベースへの操作はINSERTとSELECTだけなため VACUUMは要らないのでは？と思っています。 (少なくとも頻繁には必要ないのでは？） 但し、新しい子テーブルを毎日追加し、古いものをdropするということはやっています。 ご教授の程よろしくお願いいたします。
perlCGIでperlDBIからPostgreSQLに接続してデータを文字セットをUTF-8に変換して表示するプログラムを作成していますが、この度、新サーバに移設したところ文字変換がうまくいかないようです。 これまでは、文字セット変換は、 $ENV{'PGCLIENTENCODING'} = 'UTF-8'; でうまく作動しておりましたが、新サーバではだめなようです。 そのため $dbh = DBI->connect("DBI:Pg:dbname=$dbname", "$dbusr", "$dbpas") || die &error(not_connect); $sth = $dbh->prepare( "SET client_encoding TO 'UTF-8' ") || die &error(not_prepare); $sth->execute() || die &error(not_execute); $sth->finish || die &error(not_finish); で変換を試してみましたがこれもだめでした。 なにが原因なのか分かりません。 ご回答をよろしくお願いします。 新サーバの環境は、 OS:Debian sarge PostgreSQL7.4.7 DBI 1-46 DBD 1-41 perl 5.8 です。
以下の構成でWebアプリケーションを構築しています。 Webサーバー：WindowsServer2003、IIS6.0 ＤＢサーバー：WindowsServer2003、PostgreSQL8.0 このたび、各サーバーについて二重化を行うことになり、ＤＢサーバーのクラスタリングツールを探しています。PostgreSQL用のツールの場合、Linux対応版はいろいろあるようですが、Windows対応版はあまりないように見受けられます。 Windows対応のツールでよいツールがあれば、アドバイスをお願いいたします。よろしくお願いいたします。
SQLで悩んでいるので質問いたします。 テーブル例 日付　タイプ　個数　 0901　　1　　　　5 0901　　1　　　　3 0901　　2　　　　2 0901　　2　　　　4 0901　　3　　　　1 0901　　3　　　　2 0902　　1　　　　5 0902　　1　　　　3 ： ： とあります。 このデータを日付毎、タイプ毎に個数を取得したいと考えています。 そこで下記のようにSQLを実行 SELECT 日付、sum（個数）asタイプ別個数、タイプ count(*) as タイプ別レコード数 FROM テーブル名 GROUP BY 日付、タイプ ORDER BY 日付、タイプ 取得できるレコードは下記のようになります。 日付　タイプ別個数　タイプ　タイプ別レコード数 0901　　　　　　8　　　　1　　　　　2 0901　　　　　　6　　　　2　　　　　2 0901　　　　　　3　　　　3　　　　　2 ： となります。 ここまでは簡単にいけたのですが、 できればタイプ別の個数を日付で1レコードで取得できないかと悩んでいます。 期待している取得レコードは下記です。 日付　タイプ1個数　タイプ2個数　タイプ3個数　レコード数 0901　　　　　8　　　　　　6　　　　　　3　　　　　　6 0902 ： このようにするためにSELECT部分に副問い合わせをしようとしていますがうまくいきません。 SQLで出来る方法があれば、教えてください。 よろしくお願いします。
サーバを変更することになり、PostgreのＤＢも移行することになりました。 Postgreのバージョンは 現在：7.1.3　新：8.1.4　です。 現在のＤＢのダンプファイルを作成し、 新しいＤＢにリストアしたのですが、 いくつかのテーブルでエラーがでて、 データのコピーができませんでした。 （テーブルは作成できましたが、データなく、空です。） エラーがでたテーブルには、どれも改行のはいったデータがあるので、 これが原因ではないかと思うのですが、 改行の入ったデータは何か問題があるのでしょうか？ また、もし改行が原因であれば 何か解決策はありますでしょうか？ 以上、よろしくお願いいたします。
PostgreSQLの初心者です。よろしくお願いします。 今、日本語ODBCドライバを使ってクライアント側を VB.NETでプログラムを作っています。PostgreSQLは8.1.4です。 レコードの追加をするために、レコードIDのMAX値を 撮るためにプログラム中にSQL sql = "SELECT MAX(user_id) AS MaxID FROM user" を入れて発行したところ、本来ですと「1」が返って こなければいけないのに、 Msgbox(MaxID) を仕込むと「0」が返ってきます。そして、その後に ERROR [HY000] Error while executing the query; ERROR; operator does not exist: # integer というエラーが返ってきます。 先ほどのSQLはリモートで直接PostgreSQLにつなぐと ちゃんと「1」が返ってくるのですが、VB.NET上では うまくいきません。 質問としては２つあります。 １）VB.NET上で実行すると、なぜ「0」が返ってきて しまうのか？ ２）エラーメッセージの意味 の２点です。 よろしくお願いします。
すごい単純な質問をしているのかもしれません。許してください。 例えば、ある学校の生徒の成績が蓄積されているテーブルがあるとします。そこからクラス毎にそれぞれ平均点がベスト３の生徒を抽出したい場合のＳＱＬはどのようになりますでしょうか？ class name average ------+------+------ A 高橋 651 A 鈴木 711 A 古田 645 A 田中 821 A 前田 630 B 永田 840 B 前川 765 B 春川 811 B 上田 699 【結果】 class name average ------+------+------ A 田中 821 A 鈴木 711 A 高橋 651 B 永田 840 B 春川 811 B 前川 765 unionでくっつけるとか試したのですがあまりスマートなSQL文ができません。 申し訳ありませんがお知恵を貸してください。
JDBCについてですが、javaファイルをコマンドプロンプトでコンパイルすると通るのですが、実行しようとすると ERROR:class not found java.lang.ClassNotFoundException: org.postgresql.Driver ERROR:no connection java.sql.SQLException: No suitable driver ERROR:DB Output java.lang.NullPointerException ERROR:DB close error java.lang.NullPointerException とエラーが出てしまいます。過去の質問も見ましたしググってみて同じような質問も見たつもりですが、クラスパスがどうだとかいう話がぜんぜんわかりません。 別のパソコンでやったときは実行できたので、いろいろ自分で調べたところ、ドライバ（？）の問題かなという風に漠然と思っているのですがよくわかりません。 なにか考えられる原因と、その解決法をわかる方いらっしゃいましたら教えてください。お願いします。
ＤＢに例えば、nameフィールドに"SUzuKI"と登録されていたとします。 この場合に、SQLで、"select * from table where name LIKE '%uzuki%';"と検索してもヒットしません。大文字小文字を判別するからです。大文字小文字を判別しない検索方法についてお分かりになる方がいらっしゃいましたら、ご教示をお願いいたします。 よろしくお願いいたします。
selectの結果（文字列）を結合ってできますか。 例えば以下のテーブルがあって、カラムAとBを結合した結果が欲しいのです。Aカラム-Bカラム　という結果が欲しいのです。 （つなぎ文字はわかりやすければなんでも可） なんとかスマートに一つのSQLでできないでしょうか。 A | B | C ---+-----+--- 1 | aaa | testtest 2 | bbb | hogehoge SQL > select .... 期待する答え ans | C ---+-----+--- 1 -aaa | testtest 2-bbb | hogehoge
よろしくおねがいします。 このようなページを見たのですが、 イマイチ理解が出来ませんでした。 http://oshiete1.goo.ne.jp/kotaeru.php3?q=418316 （特に-の演算子が調べられませんでした） 二つのデータ（カラム同士）を入れ替えるのに、 二つとも一旦違う値にして、 元のデータに戻すというやり方で何とか対応しているのですが、もう少し効率の良い書き方、関数等ご存知の方いらっしゃいませんでしょうか？ 参考ページの解説でも違ったやり方でも結構です。 どうかご教授願います。
こんにちは。お世話になっております。 現在、右も左も分からないまま、書籍を参考に、DB（MySQL)を触り始めて2ヶ月足らずの初心者ですが、とあるサイトに、PostgreSQLの設定として以下のようなものが紹介されておりました。 sid、uidなどは分かるのですが、最後のフィールド（rdate）はどのような意味を持つものなのでしょうか？ 初めて見る内容のものなので、DBの違いによるものなのか？などなど、DBの設定の意味が分からず躓いております。 お忙しい中恐縮ですが、ご教授頂ければ幸いです。 CREATE TABLE session ( sid varchar(32) primary key, uid varchar(16) not null, password varchar(16), rawdata varchar(512), rdate timestamp default 'now' );
以前試しにPostgreSQLをインストールしたことがあって、一度削除していました。そして今回新しく構築したく再インストールしたのですが、pgAdminIIIを開くと、以前作成状態とまったく同じになってます。 削除方法に問題があるのでしょうか？以下に作業内容を記述します。 1.プログラムの追加と削除でPostgreSQLを削除 2.管理ツールのユーザーよりPostgreSQL service accountの削除 3.Documents and Settingsにpostgres関連のディレクトリが作成されていたので削除 4.PostgreSQLをインストール 5.以前の状態で復活・・・ ■環境 OS:WindowsXPpro DB:PostgreSQL 8.0.3 / pgAdminIII 1.3.0 インストール方法は以下ページと同じ http://allabout.co.jp/internet/database/closeup/ … 以上よろしくお願いします。
pgAdminIIIを最近使いはじめました。pgAdminIII だとPostgre7.4以上の対応となっていて、check_function_bodiesというPostgreSQL7.3のバージョンにはない関数を読み込むSET　check_function_bodies = 'false' という1行がバックアップ時に自動で生成され、バックアップファイルをリストアできないのです。 PostgreSQL7.3のバージョンに対応しているpgAdminIIIを教えていただけないでしょうか？ もしかしてpgAdminIIでないとだめでしょうか？ PostgreSQLのバージョンアップは事情によりできないです。 現在pgAdminIII1.2.2を使用しています。 よろしくお願いいたします。
まったくの素人なのでお願いします。 EMPLOYEE(ユーザテーブル） NAME ADDRESS AGE GENDER DIVISON 金森 浦安 　　 33 1 1 高橋 さんちゃ 28 1 2 横瀬 巣鴨 　　30 1 3 井上 蓮根 　　28 1 4 内海 葛西 　　　 2 4 上記のようなテーブルがあります。 あいている、ageに年齢を入れたいのですが解りません。ちなみにこれでもだめでした。 UPDATE employee SET age = 37, where name = '内海' どなたか、お教えください。
PostgreSQLのホントの初心者です。 今使っているLinuxサーバ（RedHat9）になぜかたま たまPostgreSQL（7.3.2）が入っていて、使っていた のですが、この際8.1.4に上げようと思いたちました。 これは、バージョンアップというより「入れ直し」と 考え、まず7.3.2を削除しようと考えて、 # rpm -e postgresql と入れてみたのですが、関連付けられているためか 削除できません。 それで、7.3.2にDBを全部削除してしまえばよいと 考え、５つのDB（template0,template1,test,test2, db1）を削除する方法を調べたのですが、「psql」で はDBは消せないようですし、どれかのDBに入って SQLを動かすと、「自分(のDB)」はけセません。 それと、最初からあった、template0,template1も 削除できませんでした。 DBを消すのが目的ではなく、7.3.2を削除したいので すが、どのようにやったらよいか教えて下さい。 よろしくお願いします。
こんにちは pgAdmin３を使用しています。 　条件に一致する行を複数取得して、その行に対してアップデートをかけたいです。アップデートの処理がややこしいので一文で書かず、カーソルを使用して一行づつ処理をしていきたいのですが、下記で　カーソル名.列名で値の取得が出来ないようです。 missing FROM-clause entry in subquery for table "car" BEGIN; 　　DECLARE　car CURSOR　IS　～抽出条件 FETCH ALL IN car; 　　UPDATE　・・・　WHERE clm_name = car.clm_name CLOSE car; END; 　postgresqlが不慣れで、ネットで調べては色々変えてやってみているのですが、ここで詰まってしまいました。 　カーソル内のカラムの取得方法についてご教示下さる方が居れば助かります。
こんばんは。 pgAdminIIIを最近使いはじめました。 テーブルＡを作成し、その後、そのテーブルのバックアップをCOMPRESSで作成しました。 そのバックアップファイルをデータを削除したテーブルＡにリストアしようとしたのですが、 SET check_function_bodies = false というコマンドがエラーだと表示され、うまくリストアできませんでした。 何が間違っているのでしょうか？ ご回答よろしくお願い致します。 ちなみにデータの文字コードはUnicodeでPostgreSQL7.3.9を利用しています。
プロジェクトA　月間勤務状況一覧 氏名　１月　２月　３月　合計 山田　２０　１０　１０　４０ 川村　１０　１０　１０　３０ 大沢　２０　２０　２０　６０ 上記のような一覧をつくりたいのですが、 STAFF表（社員情報）とLABOR表（勤務情報）からSQL一発で 情報を取り出すためのSQL作成に四苦八苦しています。 人別に情報を取り出すには、GROUPを使えばよいというところまではわかるのですが、 月ごとの情報を取得するために副問い合わせを用いる際に、 人別に情報を取得しようとすると 副問い合わせ文内で社員を指定する必要が出てきてしまいます。 すると社員を纏めて表示するためのGROUPを使う意味がそもそもなくなってしまいます。 以上のような点から、SQLを作る事ができないでおります。 どのように記述すれば宜しいでしょうか？アドバイス頂ければ大変助かります。
以下の環境でPerlのデバックを行っているのですが、 Windowsで利用できるpgモジュールはないのでしょうか？ ・Windows XP SP2 ・ActivePerl 5.8.8 ・Apach 1.3.34 ・PostgreSQL 8.1 ソース中にuse Pg;と記載したら以下のエラーが発生し大変困っております。 Windows環境では提供されていないのでしょうか？ 有識者様がいらっしゃったらご教授をお願い致します。 補足ですが、上記環境でDBD::Pgは利用できるようにセットアップしております。 エラー内容： Can't locate Pg.pm in @INC (@INC contains: C:/Perl/lib C:/Perl/site/lib .) at C: \Program Files\Apache Group\Apache\htdocs\proto1\ファイル名.pl line 18. BEGIN failed--compilation aborted at C:\Program Files\Apache Group\Apache\htdocs \proto1\ファイル名.pl line 18.
phpPgAdmin上から、テーブル定義を行っています。 テーブルの中へ、auto_increment型の項目を追加したいと 考えております。 MySQLには、auto_increment型が存在しますが、PostgreSQLの場合 には、同じような型があるのでしょうか？もし、ない場合には、 一般的にどのような対応をしているのでしょうか？（例えば、 Insertする際にＰＧの中でincrementしているのでしょうか？） (1)auto_increment型の追加方法 (2)auto_increment型がない場合の、対処方法 以上の点に関して、お分かりになる方がいらっしゃいましたら、 ご教示をお願いいたします。
PostgreSQL 8.1.3にてポート番号を5440を使用したいと思いますがローカルでは5440が使用できますがサーバのポートが開きません。設定は下記の様にしてます。 起動ユーザの環境変数： PGPORT=5440 起動時のシェル： start) $ECHO_N "Starting PostgreSQL: "$ECHO_C su - $PGUSER -c "$DAEMON -i -p 5440 -D '$PGDATA' &" >>$PGLOG 2>&1 echo "ok" postgresql.conf： port = 5440 ～中略～ # - Connection Settings - #listen_addresses = 'localhost' # what IP address(es) to listen on; listen_addresses = '*' # comma-separated list of addresses; これ以外にサーバ側で5440のポートを空けない設定等ありますか？ 宜しくお願いします。
下記バージョンでSJISでDBを作ることは可能でしょうか？ CREATE DATABASE sjis WITH ENCODING 'SJIS' ってやったらエラーになりました。 PostgreSQL 8.1.4　又は PostgreSQL 8.0.4
postgresql-8.1.4-1-jaを落とし postgresql-8.1-ja.msiを実行したところ、 実行できません、エラー画面等一切出ず対処の方法が 分からないので教えてください。 過去ログ等から下記を確認しました。 ユーザアカウントにpostgres等はありません cygwinは入れていません アンチウイルスソフトにNODは使ってません 過去にpostgresqlをインストールしたことはありません 環境 WinXPSP2 シマンテックアンチウィルス
サーバのマシン交換を行います。 現在のPostgreSQLのデータを新しいマシンに移すにはどうしたらよいでしょうか？ データベースについては、初心者なので困っています。 よろしくお願いします。
ちょっと疑問に思ったので、ご存知の方がいらっしゃればご教授下さい。 以下のようなデータを登録します。 id　　名前 1　　あいう 2　　かきく 3　　さしす 登録後に閲覧すると、上記の並びでちゃんと表示されるのですが、 続いて、id=2の「かきく」を修正・登録してから閲覧すると id　　名前 1　　あいう 3　　さしす 2　　かきく という風に並んで表示されます。PostgreSQLでは何をキーにして並びを 決めているのでしょうか？　また、それは設定を変更することによって 変えることは可能でしょうか？ やりたい事は、修正などをしても一番最初に登録した並びを保持したい のです。 プログラム側でidをキーにしてソートすれば済む話なのですが、PostgreSQL 側でできることは、できるだけPostgreSQL側で処理させた方が良いと思った ので、質問させて頂きました。 どうぞ、よろしくお願い致します。
SQLで操作しているデータベース（テーブル）をエクセル表として出力したい（CSV機能）です。 ネット上のソースをいくつか見てみましたがエラーがなくならないのと、あとそのソース（エクセル表にデータを書き込むJavaクラスファイル）をどのように組み込めばいいか分かりません。 エクセル表としてデータを得るにはどうすればいいか教えていただけますか？（database名はdb1、table名はtable1としています。）
はじめまして。 postgresの「テーブルのレコード件数取得」について教えてください。 何も考えずに select count(*) from tblA; というSQLの記述をしていたのですが、レコード件数が３０万件を超えた あたりから、結果が戻るまでに４～５秒もかかるようになりました。 もっと効率の良い（＝短い時間）検索方法はあるのでしょうか？ ちなみに postgres+C+PC-Soralis の組みあわせです。 マシンはPen4-2Ghz メモリーは512MBです。
質問はここでいいでしょうか？ SQLyogを使って作成したテーブルをlocalhostで表示させようとしています。limit句とorder by句は合わせて用いることが出来ました。今、ここにさらにlike演算子を追加しようとしています。これは可能でしょうか？ また、上記の（order byとlimit処理のみの）デーブルに新たにkeyカラムを加えたところ'(order by) Key ASC LIMIT 0,10'"の所でエラーが出ます。他のカラムではこの書き方で首尾よくいっているため原因が分かりません。 どちらかでもいいので教えて頂けますか＼(*^▽^*)/
Postgres 7.4 LANG=ja_JP.UTF-8 ---------------------- いつもここではお世話になっております。 現在、日本語の並べ替えで困っています。 並べ替えたいのは「個人情報テーブル」の「ふりがな」列です。 ふりがな列には次のデータが入ります。 ・ひらがな（例：あ） ・カタカナ（例：ア） ・小さいひらがな（例：ぁ） ・小さいカタカナ（例：ァ） ・半角カタカナ （゛と゜のつくものも含みます。） かか カカ ヵヵ カカ（半角文字） がが ガガ ガガ（半角文字） ひのこ ぴのこ ピノコ ピノコ（半角文字） と並べたいものが、 select * from 個人情報テーブル order by ふりがな; では、 カカ（半角文字） ガガ（半角文字） ピノコ （半角文字） かか がが ひのこ ぴのこ カカ ガガ ピノコ ヵヵ になってしまいます。Postgresでは、このように並べることは不可能なのでしょうか？ ちなみに、並べ替え結果として、 あ、ぁ、ア、ァ、ア（半角文字） の表示順はどうなっても構いません。 ただ 「あ」で あ ぁ ア ァ ア（半角文字） 「か」で か カ ヵ カ（半角文字） ガ ガ（半角文字） を並べきりたいのです・・・・上の様に 「カカ（半角文字）」のあと 「ピノコ（半角文字）」がでてきて、そのあとに 「かか」がきて・・・またそのあと 「ひのこ」がでて・・・というようにしたくないので・・ 「カカ（半角文字）」 「かか」 「ひのこ」 「ピノコ（半角文字）」 というように、同じ発音のものはどんな文字であろうと（かな・カナ・小さい・半角）続けて表示させたいのです・・・（；；） 説明が下手ですみません。。 どなたか解決策がありましたら、よろしくおねがいいたします。
WindowsXP内のVMWareに仮想マシンRedHat9を構築して便利に使っています。今回この中ににPostgreSQL構築しpostgresql-8.1.3.tar.gzを/usr/local/srcにダウンロード #useradd postgres #mkdir /usr/local/pgsql #mkdir /usr/local/pgsql/data #cd /usr/lcal/src #tar zxfv postgres-8.1.3.tar.gz #chown postgres.postgres /usr/locl/pgsql #chown -R postgres.postgres postgresql.1.3 #su - postgres $cd /usr/local/src/postgresql-8.1.3 $./configure $gmake $gmake install 以上で無事postgreSQLデータベースが完成 引き続きユーザpostgresで $/usr/local/pgsql/bin/initdb -D /usr/local/pogsql/data $/usr/local/pgsql/bin/postmaster -D /usr/local/pgsql/data $/usr/local/pgsql/bin/createdb TestDB $/usr/local/pgsql/bin/psql TestDB で作成したTestDBに接続でき、テーブルも作りました。 ところがRedHat9をいったん再起動するとできている筈のTestDBに接続できなくなります。どこかにどこかに設定ミスがありますか。何かヒントをいただければうれしいです。 $/usr/local/
はじめまして。 どなたかご存知であれば教えてください。 現在私はPostgres7.4.6を使用しています。 テーブルを作成した際にtimestamp型のフィールドを一つ作っておいたのですが、このフィールドサイズを見ると254Byteとなっていました。 調べてみてもtimestamp型は8Byteだと記述されていて、 なぜ254も取られるのかがわかりません。 解るかたいらっしゃいましたらよろしくお願いします。
最近、x64のOSを購入しましたが、アプリがこんなに対応していないの驚きでした。 維持でも使い続けたいので(^^; Windows版、x64上で動作するPostgreSQLのODBCを探しています。ご存知の方教えていただけますか？ x64からノーマルWindowsXPに再インストールされてる方が沢山いらっしゃるようですが、私もその気持ちになりかけています。(--
PostgreSQL7.4.5 + FC4という環境でDBサーバを運用しています。 夜間にデータの切換などを行う際に、drop databaseをしたりするのですが、 その際に ERROR:source database "DB名" is being accessed by other users のエラーが出て処理が中断してしまいます。 これはpostgresプロセスがidle状態で残っている為なんですが、 postgresを再起動する事無く、drop databaseが出来る状態にしたいです。 (ちなみに、この処理を行っているユーザはpostgresユーザではありません) どなたか、良い策があればご教授して頂けますでしょうか。 以上です。宜しくお願い致します。
新規の開発プロジェクトでDB関係の担当になりました。 PostgreSQLを利用しようと思っています。 現在、採用するバージョンについて「PostgreSQL8.1.2」にするか、 最新の「PostgreSQL8.1.3」にするか悩んでいます。 バージョンの違いはセキュリティー面のようですが、 どのような点を考えどちらのバージョンにするのが良いのでしょうか。 アドバイス又は意見お願いします。
バックアップファイルを作るのに、全データではなく、抽出したデータを吐き出したいので、VIEWを作って COPY VIEW名 TO 'ファイル名'; を実行してみたんですが、 「You cannot copy view VIEW名」 といわれて、できませんでした。 スクリプトなどでループさせるしかないんでしょうか？ ご存知の方いらっしゃいましたら、ご教授ください。 よろしくお願いいたします。
度々の質問で少々気恥ずかしいのですが・・・ 先日カラム一覧を取得する方法として、多くのRDBMSではシステムカタログを 参照するのが一般的な方法ということを教えて頂きました。 現在pgAdminIIIを使って、システムカタログの中がどうなっているのか、 色々勉強しているのですが、カラムサイズを取得するにはどこを参照すれば 良いのでしょうか？　たとえばvarchar(40)のカラムがあった場合に「40」 という数値を取得したいのですが・・・ どなたかご存知であれば、ご教授下さい。
これまでMySQLを利用していたのですが、諸事情によりPostgreSQLへ 移行することになりました。そんなにMySQLへ依存した作り方をして いなかったので、簡単に考えていたのですが、ちょっと躓いている ことが出てきたのでご質問させて戴きます。 MySQLでは「show tables;」というコマンドを送ることにより、 データベース内のテーブル一覧を取得することが出来ました。 かなり色々調べ回ったところPostgreSQLでは 「select * from pg_stat_user_tables」 というコマンドが、それに相当することがわかりました。 同じように、MySQLでの「show fields from TABLE_NAME;」という 指定したテーブルのカラム一覧を取得するためのコマンドに相当する ものを探しているのですが見つかりません。 どなたかご存知であれば、ご教授下さい。 以上、宜しくお願い致します。
してＳＱＬ文をＥＵＣでファイルに書いて \i file.sql と実行するとシフトジス以外で書かれているため エラーになります。 ＥＵＣでかかれたＳＱＬファイルを実行できるようにするにはどうしたらいいのでしょうか？
初めまして、データベースを覚えようと、Windows 2000にPostgreSQL8.1を入れて見ました。 まずはテスト用のデータベースを作ろうとユーザー postgres で createdb test;とやると EREOE: syntax error at or near "createdb" at character 1 LINE 1: createdb test; となります。いろいろ試して create database test; で作る事が出来たのですが その test データベースに移動するつもりで psql test; とやると又 ERROR: syntax reeoe at or near "psql" at character 1 LINE 1: psql test; となります。文字コード関係のエラーかな？と、エンコーディングをEUCからutf8に変えて インストールし直して見ましたが同じエラーが出ました。 createdb test;ですんなりtestデータベースを作るためにはどの様にしたらよいのでしょうか？ 分かる方がいましたら、よろしくお願いします。
を使っていますが psqlで入って ディレクトリを変更するのに \cd "/Documents and Settings" としても Invalid argument というエラーメッセージが出ます。 PostgreSQLで間に空白があるディレクトリを指定するにはどうしたらいいのでしょうか？ また今の作業ディレクトリを表示させるにはどうしたらいいのでしょうか？（Linuxのpwd）
FreeBSDに PostgreSQL7.4.6 + Apache + php4.3.10で色々と試していますが データソートのSQLについて悩んでいます 【テーブル(test)】 code name 1001 aaa 1002 bbb 2001 ccc 2002 ddd 3001 eee 4001 fff 【希望】 codeの4桁目基本にグループわけし、 各グループ単位で希望の順番(1,3,4,2)に並べたい グループ内は残り3桁の昇順で並べたい 【希望結果】 1001 aaa 1002 bbb 3001 eee 4001 fff 2001 ccc 2002 ddd
初心者です。　どなたかご教授いただけると助かります。 ＝＝＝＝＝ =table1= usercd point class 1 100 5 2 200 5 1 500 5 3 150 11 =table2= usercd point class 1 150 11 2 700 5 3 200 11 のように、データが２つのテーブルに分かれています。 table1とtable2をUNIONして、usercd ごとの各class の point 合計を表示させたいと思います。 ＝結果（として期待しているもの）＝ usercd class5合計 class11合計 1 600 150 2 900 0 3 0 350 ＝＝＝＝＝＝＝＝＝＝ UNION して　片方（例：class5） の合計を集計することは出来ました。 ＝出来たsql＝ SELECT "usercd",Sum("point") FROM (SELECT * FROM "table1" UNION ALL SELECT * FROM "table2") AS "sumpoint5" WHERE "class" = '5' GROUP BY "usercd"; しかし、それぞれの合計を一度に集計する方法がわかりません。 どうぞよろしくお願いいたします。
しようとして XPにpostgresのユーザ名でアカウントを作成しようとしてみたのですができません。 以前にPostgreSQLをインストールしようとしてできず途中でインストールを中止しことがありその関連のごみが残り XPがpostgresユーザ名を拒否しているのかもしれません。 ただしpostgresユーザ名のアカウントは表示されないので存在していないと思います。 なお、postgres以外のユーザ名ではアカウントはできます。 どうしたらいいのでしょうか？
いつもお世話になっております。 テーブル同士のLIKE検索（前方一致）を行った場合、 INDEXが有効になりません。 LIKE検索文字列を固定にした場合は、INDEXが有効 になります。 テーブル同士のLIKE（前方一致）でINDEXを 有効にする手段をご教授頂けないでしょうか。 以下、実行結果です。 (1)LIKE検索文字列が固定 ---------------------------------------------------------------------------- EXPLAIN SELECT * FROM wk_dss_data WHERE sys_id LIKE 'M004964%'; ---------------------------------------------------------------------------- Index Scan using i_wk_dss_data_02 on wk_dss_data (cost=0.00..5.25 rows=1 width=311) Index Cond: (((sys_id)::text >= 'M004964'::character varying) AND ((sys_id)::text < 'M004965'::character varying)) Filter: ((sys_id)::text ~~ 'M004964%'::text) (2)テーブル同士のLIKE検索 ---------------------------------------------------------------------------- EXPLAIN SELECT wk_dss_data.comp_id, wk_dss_data.user_id FROM wk_dss_data, t_update WHERE wk_dss_data.sys_id LIKE t_update.sys_id||'%'; ---------------------------------------------------------------------------- Nested Loop (cost=157.00..12505636.00 rows=2500000 width=20) Join Filter: (("outer".sys_id)::text ~~ (("inner".sys_id)::text || '%'::text) ) -> Seq Scan on wk_dss_data (cost=0.00..5479.00 rows=100000 width=31) -> Materialize (cost=157.00..207.00 rows=5000 width=11) -> Seq Scan on t_update (cost=0.00..157.00 rows=5000 width=11)
PostgreSQL初心者です。 結合と集計、別々のsqlステートメントだと動くのですが、同一のステートメントに記述するとエラーになります。　どなたか教えていただけると大変助かります。 phpPgAdmin を利用しております。 ＝エラーになったsqlステートメント＝ SELECT "pointm"."usercd", Sum("pointm"."getpoint"), "userm"."nickname" FROM "pointm" INNER JOIN "userm" on "pointm"."usercd" = "userm"."usercd" WHERE "pointm"."class" = '1' GROUP BY "pointm"."usercd"; ＝エラーメッセージ＝ ERROR: Attribute userm.nickname must be GROUPed or used in an aggregate function ＝動いた結合sql＝ SELECT "pointm"."usercd", "userm"."nickname" FROM "pointm" INNER JOIN "userm" on "pointm"."usercd" = "userm"."usercd" WHERE "pointm"."class" = '1'; ＝動いた集計sql＝ SELECT "pointm"."usercd", Sum("pointm"."getpoint") FROM "pointm" WHERE "pointm"."class" = '1' GROUP BY "pointm"."usercd";
Postgresql8.1を使って、 100万件の本の検索するシステムを 作ろうかと考えています。 いままで、100万件をあつかったことがないから、 パフォーマンス、データ量が心配です。 だれかいい事例があったら、教えてください。 ちなみに、サーバは、 CPU:PentiumD　３G HDD：７３GB メモリ：１G です。
windowsXP Apache2.0.54 PHP5.0.4 という環境なんですが、付き合いでPHP5とpostgreSQLを使ったシステムを頼まれました。 相手の環境はwindowsではなくLinuxらしいので、こちらも同じ環境で開発するのが理想だとは思うのですが、windows環境で開発する事も可能なのでしょうか？ PHPからpostgreSQLへの接続をしてIDが返ってくるまでは出来るものの、テーブルへのアクセスが出来ないなどの事例がありまして少し不安に思っています。 突然の質問で恐縮なのですが、この不安を少し取り除くのに協力して頂けないでしょうか？ よろしくお願いいたします。
現在ホームページの作製程度ならDreamweaverで作るくらいならできるのですが　大きくステップアップしたいと思っています。 そこで　PostgreSQL を独学又はスクールに通って学びたいのですが 独学で初歩から学ぶための教科書としてお勧めの書籍を教えていただけないでしょうか？ 加えて、中級レベルではどの書籍が良いでしょうか？ また、近畿圏でスクールに通うとしたらお奨めは御座いますでしょうか？ 一般的に皆さんはどのように習得されているのでしょうか？ 御指導の程、宜しくお願いします。
phpPgAdmin 7.310を使用しています。 データのエクスポートで、 ■データのみ ■フォーマット→CSV ■オプション　→表示 を選択して、「エクスポート」ボタンを押すと 「dateexport.php」をダウンロードしますというアラートが出てしまいます。 昨日までは、ブラウザ上で表示が出来たのですが 何故か実行プログラムの.phpをダウンロードしようとしてしまいます。 PCの昨日と今日の違いは、新しくDreamweaver8をインストールした事です。 これでPCの設定が変わってしまったのでしょうか？ その場合は、どこを変更すれば良いでしょうか？
こんにちは。 Oracle9i＋Apache＋Apache Jservで構築したWebシステムが あるのですが、オープンソースのDBに移行しようと考えております。 候補として、PostgreSQLを考えているのですが、これと組み合わせる Webサーバーでお勧めのものはありますでしょうか？ 知人に相談したら、apacheはもう古いのでtomcatなどにすれば と言われたのですが、まだ調べ切れておらずよくわかっておりません。 また、javaのソースも極力流用したいのですが、Webサーバーは 何を選定すればよいでしょうか？ よろしくお願い致します。
Postgresqlのデータベース、テーブル内のデータは、 ＷＥＢから表示するページがあると、 検索ロボットに引っかかる様ですが、 パスワード認証を通過しないと、表示されないページでは、 検索ロボットには、引っかからないという認識でいいでしょうか？ さらに、Postgresqlにテーブルがあるだけでは 検索ロボットに引っかからないという認識でいいでしょうか？
PostgreSQLで、 update文の条件として、ほかのテーブルを使いたいのですが、 updateのなかで,left joinなど結合文をいれることはできるでしょうか？ よろしくお願いします。
下記のようなテーブルがあったとして、 テーブルAを基準に考えたいのですが、、、、 テーブルAに付加する形でテーブルBのデータのidカウント数が最も少なく、idが同じもの中でdate日が一番新しいデータを表示し、古いものから並べかえかつテーブルCにidがあるものは一番最後にくるという風に並べかえたいのですが、無理でしょうか？ 現在下記のようなSQLを考えていますが、うまくいかないです。。 select * from A left join(select id,case when count(id)=0 then 0 else count(id) end AS cnt FROM B group by id order by date) as b on A.id=b.id left join(select id from C) as c on A.id=c.id order by c.id desc,b.cnt; エラー↓ in the GROUP BY clause or be used in an aggregate function テーブルA id | name | comment| 1 あ　　　おい 2 い　　　えい 3 か　　　テス テーブルB id | event | date | 1 test1 2005/1/4 2 test1 2005/1/4 1 test2 2005/3/4 2 test2 2005/3/4 1 test3 2005/5/4 テーブルC id | 1 理想の結合データ id | name | comment| cnt | date | 3 か　　　テス 0　　　 2 い　　　えい 2　 2005/3/4　 1 あ　　　おい 3 2005/5/4
PostgreSQL　for　Windows という本を読みながらポストグレスをインストールしました。 しかし、psqlでコマンドで操作しようとした際に、日本語入力ができませんでした。 入力切替方法が分かっていないだけかもしれませんが、半角/全角ボタン、カタカナひらながローマ字ボタンでも駄目でした。 インストール時にクラスタの初期化段階でエンコーディングをEUC_JPにしています。 ただ、 http://www.ne.jp/asahi/hishidama/home/tech/postg … のサイトで調べて、「日本語を使いたい場合は、/usr/local/pgsql/binにpg_encodingが出来ていることを確認する。」とありましたが、自分の設定を見ると、 C:\Program Files\PostgreSQL\8.0\binのフォルダにpg-encodeingはありませんでした。 pgsqlの実行ファイルはこのフォルダにあります。 おそらく初歩的な状態なのでしょうが、どなたか助けていただければ幸いです。 よろしくお願いします。
ちょっと疑問に思ったことがあるので質問です。 例えば以下のようなselect文があるとします。 （keyというカラムはint型です） select * from hogehoge where key = 1; これでselectは問題なく出来るのですが、以下のように値を単一引用符で囲っても、やはりselectは可能でした。 select * from hogehoge where key = '1'; カラムの型が文字列であれば単一引用符で囲まなくてはいけないですが、数値は逆に単一引用符で囲ってはいけないとばかり思っていました。 数値を単一引用符で囲むのと囲まないのとでは、何が違うのでしょうか？御存知の方、教えて下さい。
varcharで作成した1月～12月までを1月2月…12月と順番に並べたいのです。 ですが、10月～12月が1月～9月の上で並べ替えられ上手くいきません。どうか、よろしくお願いします。
こんにちは。 はじめてPostgreSQLを勉強しようと思っている者です。 実はだいぶ前に購入した本があり、それについているCD-ROMからダウンロードすればPostgreSQLがダウンロードできるとあったのでやってみました。 ところが、何回やってもインストールできません。 メッセージが出るのですが、「NTFSフォーマットされていません」が出ます。これってドライブをフォーマットする時にNTFSフォーマットにすればいいんでしょうか？ フォーマットするということはデータが全部消えてしまうんですか？ 心配になりDドライブで実験してみました（データは全部Cドライブに非難させました）。一瞬うまくいったかに見えたのですがやはり駄目でした。 NTFSフォーマットのCドライブでなければだめなのでしょうか？ 今はFAT32です。NTFSにしたらデータは全部消えてしまいますか？ OSはWindowsXP HOME EDITIONです。 すみません。まったくわからないので教えていただけないでしょうか？ 購入した本です↓ （技術評論社　「すらすらと手が動くようになる　SQL書き方ドリル」） http://www.gihyo.co.jp/books/syoseki.php/4-7741- …
PostgreSQL７＋ＰＨＰ４で物品交換サイトを構築でして、物品の写真（Gif,JPG５０Ｋバイトまで）を掲載するにあたり、PostgreSQL７のレコードに画像ファイルを格納出来るのでしょうか？出来るのであればその仕方を教えてください。 画像ファイルをＤＢに保存せず、フォルダーに保存するやり方では第三者にそのフォルダーの書き込み権限を与えセキュリティー上よくないと技術本に書いてありましたので。
PostgreSQLを使い、スクリプト言語PHPを使用し商品情報検索サイトを構築しようと考案中のものです。 今テーブル設計の段階で考案中です。 まず各製品ごとに以下3項目のような最終的なページ（HTML）を表示させるようにしたいと思います。 １．製品情報 ２．技術仕様 ３．価格表 その商品のカテゴリのデータとして 以下に分けます。 商品大分類（家電、オーディオ、カメラ） メーカー 値段 ざっとですが、どのようなテーブル構成にすればよろしいでしょうか？ テーブル数の見積もり、インデックスをどのように 張るか、またカラム構成もお願いします。 よろしくお願いいたします。
Windows版のPostgreSQLをインストールして、PerlのDBD::Pgのモジュールも ppmでインストールしました。 接続しようとすると、 ダイアログボックスが表示され、Perl Commandlineがこけたというメッセージが表示されました。 LinuxのPostgreSQL7.2.3では同じPerlスクリプトでもエラーなく動作しましたが、Windows版では7系がないようですね。 WindowsでPerlのDBD::Pgで正しく動作している方はいらっしゃいますか？ ちなみに DBD::ODBC経由だと動作しています。
create tableでテーブルを作成し、 comment on table でテーブルに名前を comment on column でアイテムに名前を つけてみました。 これらの作業の成果物を抽出したいのですが、どうやれば良いのでしょうか？ \d テーブル名で Column、Type、Modifiersは確認できますが、 そうでなくて、別のデータベースにテーブルの枠だけをそのまま移植できるような形式で抽出できないでしょうか？ create table tb1 ( item1 char(1) null ); comment on table is 'テーブル１'; comment on column is 'テーブル１のアイテム１'; みたいな状態で抜く事は可能でしょうか？
サーバーＯＳ：ターボ１０ クライアントＯＳ：winXP ＤＢ：PostgreSQL 7.4.5 エミュレータ：Tera Term Pro version 2.3 この場合、PostgreSQLのエンコードは何がいいですか？ やりかたはどうすれば良いですか？ Tera Termのエンコードは一応SJISにしようかと漠然と思いましたがEUCの方がいいですか？ サーバー自体のエンコードは何か設定必要ですか？ （１）winXPからTera Termでターボ１０に搭載したポスグレのテーブル項目に日本語をインサートし、そのテーブルをＯＤＢＣ経由でwinXPのアクセスでブラウズする。 サーバー操作 create table tbl1 (item1 char(10)); insert into tbl1 values('あいうえお'); ＰＣ操作 アクセスでブラウズ （アクセスの接続は解決済み） （２）winXPのアクセスでＯＤＢＣ経由のポスグレのテーブルを編集した後、Tera Termでターボ１０に搭載したポスグレのテーブル項目に日本語の検索をかける。 ＰＣ操作 アクセスで'かきくけこ'を挿入。 サーバー操作 select * from tbl1 where item1 like'か%';
最近フリーのＤＢをいじって遊んでるのですが、 PostgreSQLを検索してると PostgresSQLでヒットする事もみかけます。 ここのサイトのカテ分けも 「Q&Aコミュニティー > コンピューター [技術者向け] > データベース > PostgreSQL」 この場合、PostgreSQLと書いていますが、 投稿カテゴリーを 大カテ：コンピューター[技術者向け] 中カテ：データベース と選ぶと、 出てくる小カテはPostgresSQL です。 日本PostgreSQLユーザ会 http://www.postgresql.jp/ ではPostgreSQLと表記してるので PostgresSQLではなくPostgreSQLなんだろうなと思いますが、 あまりにもPostgresSQLと書いているのを見かけるので何だろう？と思っています。 そしてPostgreSQL? PostgresSQL? は何と読むのですか？ ポストグレ？ ポストグレス？ ポストグレイス？ ポストグレース？ 正しい表記、正しい呼び名を教えてください。
ＰＣ：winXP Pro サーバー：ターボlinux10 PostgreSQL 7.4.5 パソコンからサーバーに接続する為のＯＤＢＣドライバーを探しています。 お願いします。
PostgreSQLでデータベースのバックアップは pg_dumpで良いのですが、特定テーブルの一部のレコードを抽出したデータをMySQLに移したいのですが、どのようにすれば良いのでしょうか？ Postgresqlは Linuxで7.2.3 MySQLは WindowsXPで 5.0.11 です。
PostgreSQLでconnect情報（サーバにコネクト中のユーザの一覧のようなもの）を取得することは可能でしょうか？ コマンドをご存知の方がいらっしゃいましたら教えてください。 バージョンは7.1.2です。
がありますが MySQLにはそれらに相当する どのような言語が有るのでしょうか?
postgresql7.0に対し、PHP4で 「select * from test offset 0 limit 30」 という風に、30件ずつoffsetを指定して内容をweb表示しています。 この時、limitは30件で固定、offsetはGETで渡して、 「次の30件」というリンクにGETで受けた offset+30 を設定しているのですが、このやり方だとDBの内容が尽きても、「次の30件」リンクができてしまいます。 DBの内容が100件しかないのに、 「select * from test offset 120 limit 30」 などとやってしまうわけです。 できれば「これ以上内容がないときは、『次の30件』にリンクを作らない」ようにしたいです。 こういう場合、DBの件数(100件)を別で持って、それを元にリンクを生成した方がよいのでしょうか？ その場合、毎回表示の度にDBの件数をselectしなければならないような気がするのですが・・・ 何か効率的な方法があれば、教えてください。 よろしくお願いします。
今Postgres でCGIと連携させたのを作っているのですが、 同じデータベースの複数のテーブルから、同じ列を取り出すときはどうしたらいいのでしょうか？ 一つ目のテーブル　　　二つ目のテーブル id|name 　　　　　　　id|name 1 |sakura　　　　　　　1|inu 2 |kosumosu　　　　　2|neko このなかの、nameだけ取り出したいです。 よろしくお願いします。
SQL文で条件付のソートについて教えてください。 テーブルＡ(id, data_a, data_b)があったとき、 data_aとdata_bのうち、値が大きいほうのデータでソートするためのSQL文が知りたいのです。 例えば以下のようなデータが入っていたとき、 id,date_a,date_b 1, 10, 0 2, 20, 40 3, 30, 30 4, 90, 15 以下のような結果になるようにソートしたいのです。 id,date_a,date_b 1, 10, 0 3, 30, 30 2, 20, 40 4, 90, 15 良い方法があれば教えてください。 よろしくお願いします。
Windows版のPostgreSQL8.1をインストールしようとして、次のエラーで困っています。 アカウントエラーです。 無効なユーザー名です。：ログオン失敗:ユーザー名を認識できないか、またはパスワードが間違っています。 一度インストールに失敗して、２回目のインストールでこうなりました。簡単な解決方法はありますか？
このようなデータがあって +--------------------+ |テーブル名 test_tbl | +--------------------+ | reg_date | +--------------------+ | 2005/12/1| +--------------------+ | 2005/12/2| +--------------------+ | 2005/12/2| +--------------------+ | 2005/12/4| +--------------------+ | 2005/12/5| +--------------------+ それを下記のように出力したいです（正しくは月ごと） ┌────┬───┐ │date │count │ ├────┼───┤ │12月1日 │1 │ ├────┼───┤ │12月2日 │2 │ ├────┼───┤ │12月3日 │0 │ ├────┼───┤ │12月4日 │1 │ ├────┼───┤ │12月5日 │1 │ ├────┼───┤ │12月6日 │0 │ └────┴───┘ 1日から31日までどのように表示させたらいいでしょうか？ よろしくお願いします。
下記のような日付処理をするとうまくいきません。 termが2005/12/1の場合、そのtermにプラス３ヶ月した値が今日よりも大きい場合という意味になります。 単体で処理すると、下記のような値になりますが、これですと検索結果が０件になってしまいます。どのように変更したらいいのでしょうか？ (TO_TIMESTAMP(term, 'YYYY-MM-DD') + '3 months')は2006-03-01 00:00:00+09 CURRENT_TIMESTAMPは2005-12-12 4:20:58.593103+09 (TO_TIMESTAMP(term, 'YYYY-MM-DD') + '3 months') >=CURRENT_TIMESTAMP
postgresql7.2を使っています。 レンタルサーバで容量制限（300mb）があるため、自分用のコントロールパネル(PHP)にpostgresqlが今どれくらいのサイズかを表示したいのですが、SQLでサイズを知ることはできるでしょうか？ また、出来ない場合はどのように知ることができるでしょうか？ よろしくお願いします。
外部参照はつけてもつけなくても同じでしょうか? そのメリットは無いのでしょうか? 例えば create table num_tbl { no int4 primary key, str text }; create table cont_tbl { no int4 references num_tbl(no), cont text }; の場合 references num_tbl(no) をつけることによってPHPのコーディングにメリットはあるでしょうか? どちらにしても select num_tbl.str,cont_tbl.cont from num_tbl,cont_tbl where cont_tbl.no=num_tbl.no; のような使い方になり何かメリットがあるようには思えないのですが
postgreSQLの参考書で初心者にも理解しやすい書籍を教えてください。
表内の指定した行に移動する関数と思われるpg_data_seekという関数を使用したいと思っているのですが、 Fatal error: Call to undefined function pg_data_seek() in ～～～ on line 52 となってしまいます。 http://66.102.7.104/search?q=cache:nHqnLP1laDsJ: … には書かれているのでおそらく関数自体は存在しているようです。何か設定など問題なのかなと思っています。 解決策を知っている方教えていただけますでしょうか？
PostgresSQLはマイクロソフトのSQLサーバーのようにGUIで操作することはできますか？
postgresql-7.3.11を以下の手順で作業実施後ですがエラーが帰ってきますので教えて欲しいのですが。 #tar xfz postgresql-7.3.11.tar.gz #./configure --enable-multibyte=EUC_JP --enabl エラーは以下の通りです。 configure: WARNING: *** Without Bison you will not be able to build PostgreSQL from CVS or *** change any of the parser definition files. You can obtain Bison from *** a GNU mirror site. (If you are using the official distribution of *** PostgreSQL then you do not need to worry about this because the Bison *** output is pre-generated.) To use a different yacc program (possible, *** but not recommended), set the environment variable YACC before running configure: error: readline library not found If you have readline already installed, see config.log for details on the failure. It is possible the compiler isn't looking in the proper directory. Use --without-readline to disable readline support. VineLinux3.1です。 宜しくお願いします
csv形式のデータがあります． これをPostgresへ入れたいのですが，どのようにしたらいいのでしょうか？ コマンド等を調べていますがなかなか見つからずに苦労しています． ご存知の方がおられたら教えてください． よろしくお願いします．
例えばヤフーのカテゴリのように トップ > 地域情報 > 日本の地方、都道府県 > 関東 > 千葉県 > ビジネスと経済 > 企業間取引 (BtoB) > と、どの程度まで深くなっていくか見当がつかないディレクトリ構造がありますが、こういうものを管理するときには、単純にカラム数を多めにとってDBを作成すればいいのでしょうか？ もう少しスマートなやり方があったら教えてください。
(samp_tv) c-id | s-di | name1 | name2 ---------------------------- 1 | 100 | A | A 1 | 101 | B | D 1 | 102 | C | F 2 | 103 | D | E 2 | 104 | E | J 2 | 105 | F | K (samp_dic) id | c-num | word -------------------- 1 | 11 | A 1 | 11 | B 1 | 11 | C 2 | 12 | D 2 | 12 | E 2 | 12 | F 3 | 13 | G 行いたい動作は、samp_tv.name1とname2にsamp_dic.wordが存在し、最もwordが存在するs-idとc-numをSELECTで抽出したいです。 SELECT s-id,c-num FROM samp_tv,samp_dic WHERE c-id=s-id AND (name1 LIKE '%'||word||'%' OR name2 LIKE '%'||word||'%'); 上記のSQLでは、nameに存在する全てのs-idとc-numが出てきます。 s-idごとに最も出現数の高いc-numを抽出するにはどうしたらいいのでしょうか？ よろしくお願い致します。
テスト用に簡単なテーブルを作成してみました。 テーブル名：timetest フィールド： test_id : integer NOT NULL test_date : timestamp without time zone テストデータとして 1,2005-11-15 14:01:40.026 2,NULL 3,2005-11-14 11:11:11.001 このときに test_date がNULL以外のものだけを選択したいのですが、 slect * from timetest where test_date != null; では1件も選択されず、 select * from timetest where test_date != ''; では、 ERROR: invalid input syntax for type timestamp: "" というエラーになってしました。 どなたかご教授お願い致します。
初めまして　よろしくお願いします。 質問：サービスの構成はあとから出来ますか？ 　　　その方法は？ ようの所は、インストール時にinidbでコケてしまう為 インストールできないです。 この時点で試したのは 過去ログよりコンパネからpostgresユーザーを作って インストールする。（失敗） 追跡調査してみると コケてる原因は「データベースクラスタの初期化」 ステップ時になると「8.0」ディレクトリのセキュリティ権限で 書込み拒否にチェックがあることを発見 その為ではないかと判断し ・インストールステップのサービス構成でpostgres ユーザーが作成された直後にAdministratorsへ入れて アドミニにしてインストールする。（失敗） ・インストール中にフルコントロールにチェックを入れてみた しかしながら「データベースクラスタの初期化」のステップで 必ず「8.0」ディレクトリ書込み拒否にチェックがある インストールステップのサービス構成で 「サービスのインストール」チェックを外してインストールを 行うと最後まで無事辿りつけますが当然データベースサーバー（サービス） は起動していません。 インストールステップのサービス構成で 「サービスのインストール」チェックを外してインストールを行ない のちにサービスのインストールを行う方法はないでしょうか？ 環境： Windows2000　SP4 postgresql-8.0.4-ja インストールステップでのロケールなどは各種で上記方法を試し済みです。 インストール中はウィルスバスターを含めあらゆるアプリは停止状態にしました。 以上　よろしくお願いします。
レコード数が増えていくうちに、なぜか最近phpPgAdminの動作が劇的に重くなってきました。 以前はスムーズに動作していたのですが、ある日を境に（原因は全くわかりませんが）とても重くなっています。 特にテーブル内容を表示するときにはタイムアウトするほど動作が重いです。（ただ、PostgreSQL自体の動作は遅くなっていないようです） 何か動作を軽くする方法があれば教えてください。 現在レコード数は約4万、ダンプファイルのサイズは4MB程度です。 サーバーはXREAを利用しているのですが、サーバーの仕様は公開されていないため不明です。
WEBサーバー「A」とDBサーバー「B」が存在しています。 この時、「A」から「B」への接続をCGIからpsqlをコールすることで行っています。 認証についてはpgpassを利用しているつもりなのですが、 どうもこれが有効になっていないようで、接続ができません。 どうやったら接続できるようになるでしょうか？？ 　　　　　　　　　　　　　　皆様のお力をお貸し願えれば幸いです。 pgpassはユーザー「X」が所有者となっておりパーミッションは「600」となっています。また「X」の$HOMEに置かれています。 また、同様のテスト環境が存在するのですが、そちらでの接続はうまくいっています。 もしかしてテスト環境でもpgpassが効いてるわけではなく、別の方法で接続が確立されているということもあるでしょうか？ 環境は以下の通りです。 本番サーバー 　Linux [サーバー名] 2.4.20-8smp #1 SMP Thu Mar 13 17:45:54 EST 2003 i686 i686 i386 GNU/Linux 本番DB 　Linux [サーバー名].in.[ドメイン] 2.4.20-8smp #1 SMP Thu Mar 13 17:45:54 EST 2003 i686 i686 i386 GNU/Linux テストサーバー 　Linux [サーバー名] 2.4.20-8smp #1 SMP Thu Mar 13 17:45:54 EST 2003 i686 i686 i386 GNU/Linux テストＤＢ 　Linux [サーバー名] 2.4.20-8smp #1 SMP Thu Mar 13 17:45:54 EST 2003 i686 i686 i386 GNU/Linux 　Perlは　v5.8.0　（perl -v　にて確認） 　PostgreSQLは　7.4.7　（psql --version　にて確認）
すみません。 postgreSQLでint型をorder byする時、 null も混ざっているのですが、 null は下の方の順番（1より下（0以下はないとして））に来るようにするには、 通常どのように書くものでしょうか？？？ もしかしたら簡単な事かもしれなくて、 もうしわけないのですが、どなたかよろしくおねがいします。
前提として下記のようなテーブルがあります。 テーブル名：test フィールド： １）id: varchar, not null ２）name: varchar ３）date: timestamp with time zone, not null このテーブルに下記のようなレコードがあります。 '00001', 'A', '2005-01-01 00:00:00' '00001', 'B', '2005-07-01 00:00:00' '00001', 'C', '2005-11-01 00:00:00' '00002', 'X', '2005-01-20 00:00:00' '00002', 'Y', '2005-07-20 00:00:00' '00002', 'Z', '2005-11-20 00:00:00' ■今やりたいこと このテーブルからidごとにdateフィールド値が最近のレコードを取得したい。 ■やってみたこと 下記SQLを発行しました。 >select id, max(date) from test group by id order by id 結果==> 00001 2005-11-01 00:00:00 00002 2005-11-20 00:00:00 実際はnameフィールドの値も取得したいのですが、group by句を使うとフィールド指定ができませんでした。 ■だめだったSQL select id, name, max(date) from test group by id order by id どのようにSQLを書けばよろしいでしょうか？
Linux版PostgreSQL7.Xからのバックアップファイルを使用し、Windows版PostgreSQL8.04へリストアをしたいと考えております。 具体的にどのようにしたら出来るのでしょうか？ ざっくばらんな質問で申し訳ありません、現在試しているのですが、Window版のpgadminIIIを使用しリストアしようとしても、Linux版のバックアップファイルが認識できないようで、OKボタンが押せない状態です。
Windows2000ServerにPostgreSQLをインストールしようとしております。 インストール方法を調査したところ、 「Windowsへのインストール」といった具合で、 対応しているWindowsのバージョンを調べることができませんでした。 そこで、質問なんですが、 Windows版のPostgreSQL（8.0.4）はWindows2000Serverに対応しているのでしょうか？
はじめまして Fedora Core3 + Postgresqlの環境で開発をしています。 自動的に、バックアップをとる仕組みを作っているのですが バックアップをおこなう、shファイルに psql -f /www/sql/abc.dat abc として、一括でデータベースを復元してます 手動で、shファイルを動かすと、ちゃんと復元されるのですが cronで、このshファイルを時間設定し動かすと psql -f /www/sql/abc.dat abc が、まったく動いてなく、復元できません すみませんが どなたか、教えてください よろしくお願いします。
前者は機能が優れていて、 後者は扱いやすさとスピードが優れているのは分かったのですが、 もう少し詳しい説明をしてもらえませんか？
初めまして。 早急に教えて頂きたいことがございます。 postgresに１日分の検索履歴を保管する 仮想ＤＢ(履歴管理ＤＢ及び履歴累積ＤＢ) みたいなものはございますでしょうか？ また、もしあるならばその仮想ＤＢの容量等 確認するコマンドがありましたら、 教えてください。 よろしくお願いします。
はじめまして。 postgreSQLを手にてインストールした後にバッチファイルによるDBとユーザ作成はoracleと同じように作成すればよいのでしょうか？もし違いがあるようでしたら教えてください。
http://www.komonet.ne.jp/script/db_group.htm http://www.komonet.ne.jp/script.htm こちらのPHPスクリプトを設置したのですが、データベースに書き込みができません。 データベースの名前とユーザー名も正しいのですが、 pgsql/server.logに以下の文章が記録されます。 invalid byte sequence for　encoding "EUC_JP":0x904b どうしたら直るのでしょうか？ phpソースの中にx-sjisという部分があるので、そこをEUC_JPに書き換えたのですが、ページが真っ白になってしまいました。 ただいま勉強中ですので、どなたか教えていただけないでしょうか？ 宜しくお願いします。
REDHAT LINUX９ postgreSQL8.0.4←7.2.3からのアップグレードで、 rootからsu postgresして initdbをしようとしたら。 initdb：　command　not　find となるのですが、これって正常にインストールできていないのでしょうか？ それとも、設定不良でしょうか？ どなたか教えていただけませんでしょうか？ 宜しくお願いします。
selectから、取り出したデータが、次のような場合 ↓ ＡＡＡ ＡＡＡ ＢＢＢ ↑ ＡＡＡは、２個あるので、１個にしたい。 例えばこういう感じ。 ↓ ＡＡＡ ＢＢＢ ↑ どのような関数がありますか？
テーブル「虫」に フィールド「アリ」「ハチ」「チョウ」があります。 それぞれint型です。 ここで1,0,2とデータがある時 「蟻1匹、蝶2匹」というような結果を返したいのですが、「蟻1匹、蜂0匹、蝶2匹」のようにしたくありません。 case where アリ>0 then '蟻'||アリ||'匹' else NULL end を使うところまで思い至ったのですが、そこから先どうすれば良いのか悩んでいます。 何かヒントだけでもいただければ幸いです。 よろしくお願いします。
するのでしょうか？ create table tablex(no serial primary key,time timestamp); insert into tablex(time) values(?); において？の部分に入れる文字列のフォーマットはどうなるのでしょうか？ 例えば 2005年5月5日5時55分55秒 を入れるにはどうしたらいいのでしょうか?
PHP+Postgresqlを使って作りたいと思っているのですが、 http://allabout.co.jp/career/database/closeup/CU … のHPを教えていただいて、インストールしたのですが、できません。 順番にやっていくと、ランダムパスワードが生成されるところで、それをメモっていなかった為、途中でキャンセルしました。（違うHPにランダムパスワードをメモしていないと、次回アクセス出来ないと書かれていたもので・・・） もう一度、最初からやると、 アカウントエラー無効なユーザー名です。ログオン失敗：ユーザー名を認識できないか、またはパスワードが間違っています。 となり、先に進めません。 色々自分なりにしらべ、「postgres」のフォルダが残っているとインストールできないなど書かれてあったので、フォルダは削除したのです。 しかし、同じアカウントエラーのメッセージがでて、先に進めません。 初心者で何もわからないのでアドバイスいただけたら嬉しいです。 宜しくお願い致しますm(__)m
以下の環境で、PostgreSQLを使用しています。 -------------------- Cobalt Raq3 PostgreSQL 6.5.2 -------------------- CSEからPostgreSQLに接続して作業していますが、 PostgreSQL起動後約10分で、接続できなくなってしまいます。 そのときのエラー内容は、 「postmaster が -iオプション付きで起動していますか？」 というものです。 SSH で /etc/rc.d/init.d/postgresql restart と打つと接続できるようになりますが、 約10分たつとまたできなくなります。 このような現象の原因として考えられることは何でしょうか？ ご存知の方いらっしゃいましたら、ヒントをください。 よろしくお願いします。
はじめまして。ご存知の方がいましたら教えてください。postgresにてサーバと通信しない出来ない場合に備えてクライアント側にもDBを持たせる事って出来るのですか？当然、容量等も影響してくるかと思うのですが。　それとプログラミング等でクライアント側に自動でDB設定とかが出来るのでしょうか？数が多いので自動化したいのです。　お手数かけますがよろしくお願いします。
データベースから時間を取得して、分まで取得したいんですが、 to_char( nwtimestamp, 'YYYY.MM.DD hh:mm' ) これだと、月と分がダブってしまうんですが、 どうすればいいでしょうか？
ftp://ftp.jp.postgresql.org/ というサイトに行って、PostgresSQLの最新版を入手しようとしたのですが、うまくいきませんでした。 とりあえず、v8.0.3のファイルをコピーしていろいろ中を見てみたのですが、プログラムを実行させるファイルが見つからないです。 もし、どなたか入手方法がわかれば、教えてください。
PostgreSQL8.0 Windows版を使っています。 自分のPC(WindowsXP SP2)にインストールして、 ODBC経由でAccessで中身を見ているのですが、 LANでつながっている他のマシンからODBC経由で 接続することができません。 接続しようとすると「ODBC接続エラー」とでて 英語で、「サーバーに接続できません」「リモートソケットに接続できません」とでます。 ODBC設定でサーバー名はIPアドレスを直接指定しており、PINGでそのIPが存在する（私のPCであること）ことも確認、PostgreSQLも起動しているのまでは確認しています。 商用版のPowerGresでは、ネットワーク接続認証の設定というのがあったと思うのですが、 PostgreSQL8.0の場合はどのように行えばいいのでしょうか？
PostgresSQLで2日前の日付を取得するにはどうすればいいでしょうか？
PostgreSQLはMySQLに比べて小規模個人向けと聞きました PostgreSQLを使っている人はなぜMySQLを使わないのでしょうか? 使いやすいのですか？ 私はトラぶった末やっと導入できて使えるようになったばかりです
VineLinuxを使っております。 Linux 2.4.19-0vl26 Linux 2.4.22-0vl2.10 PostgreSQL8.0を、RPMもしくは、ソースからインストールしたいのですが、 インストールする手順の書かれているサイトはありますか？
yum update postgresql でバージョンアップしたと単に service postgresql start が［失敗］というメッセージしか出さなくなりました 以前は［ｏｋ］とでていたので失敗しているようです 実際 su postgres をして psql -l としてもサーバにつながらないと言うメッセージが出てきます どうしたら解決できるでしょうか?
がデフォルトでインストールされているようなので postgres をユーザ名としてログインしたいのですが パスワードは何を入れたらいいのでしょうか? そのままリターンしてもだめだし rootのパスワードを入れても受け付けません
を使いたいのですが 自分のFedoraCore3のＰＣにPostgreSQLが入っているかどうかを調べるコマンドを教えてください
OSはFedoraCore3を使用しています。 PHP5で作成したプログラムでPostgresqlへアクセスするのですが，全く応答がありません。 ブラウザで表示後、ソースを見ると <html><body></body></html> としか出ません。 ということはpg_connect("host=****...")がエラーの原因と考えています。 上記のプログラムの上にecho"ああ"と入力すると、ソースには「ああ」と表示があります。 PHPでFTP接続のプログラムを作成して実行するとこれは問題なく動きます。 やはり，Postgresqlの設定がおかしいのでしょうか？それともアクセスの方法が間違っているのでしょうか？ ホント困っています。よろしくお願いします。
windowsXPでcygwinを起動して、 $ ipc-daemon & のあと、 $ postmaster　を打つと、 DEBUG: ・・・ ・ ・ ・ DEBUG: database system is ready まで表示されて、止まってしまいます。 そのあと、何も入力することができません。 何度挑戦しても、同じです。 この状態から抜け出す方法を知っていたら、教えてください。 もしかしたら、強制終了したことが原因かもしれません。 postgresql7.2.2を使っています。 よろしくお願いします。
DBから日付を取得して、そのDBから取得した日付とその当日の日付を比べて１週間以内なら、そのレコードを取得するような感じにしたいんですが、可能でしょうか？
下記のようなテーブル構成で、過去一週間の毎日について、登録した人の数を知りたいです。 ■テーブル名　my_table システムに登録すると,IDが付与され,登録した日付が記録されます。 ---------------------------------------- id(intger) | reg_date(登録した日付,timestamp) ---------------------------------------- 以下のようなSQLを考えたのですが、timestampが「2005-12-01 00:00:00+09」という細かい日付になっているので、これでは「１日」毎の集計にはなりません。 この場合、どう表現すればよいでしょうか？ SELECT sum(reg_date) from my_table where ('now' - reg_date < '7days') GROUP BY reg_date order by reg_date
SQL初心者です。 以下のようなテーブルがある時に、 -------- X Y Z -------- 1 c E 2 a C 3 d B 4 b A 5 e D -------- 「Xが3のレコードの、Zで昇順ソートした時の前後のレコードを取得する」 ということをしたいのですが、見当もつかずに困っています。 どんな些細なことでもよいので、何かご存知の方がいたら、アドバイス願えないでしょうか。 よろしくお願いします、
JavaからJDBC経由でPostgreSQLにSELECT文を発行し、 結果を受けて更に処理をするプログラムを作成しております。 その際、SELECTの結果をResultSet.next()メソッドを使い、 while文で結果の行数分処理をしようとしております。 しかし、複数行SELECT文の結果があるにもかかわらず、 １回のループで終わってしまい、 後は下記のExceptionが発生してしまいます。 Exceptionを読む限りでは、コネクションが閉じられていると分かるのですが、 プログラムでは一番最後のステップでデータベースとの切断をしております。 この様な現象のときは、JDBCが悪いのでしょうか？それともプログラムのつくりが悪いのでしょうか？ 【 以下サンプルソース 】 Connection con = null; Statement st = null; ResultSet rs = null; try{ Class.forName("org.postgresql.Driver"); con = DriverManager.getConnection(jdbc:postgresql://localhost:5432/hoge?user=hoge&password=hoge); st = con.createStatement(); rs = st.executeQuery("select hogehoge from hogerake"); // 必ず複数行戻ります。 while(rs.next()){ // 処理 } con.close(); st.close(); rs.close(); }catch(Exception e){ e.printstackTrace(); } 【 以上サンプルソース 】 【 以下コンソール 】 org.postgresql.util.PSQLException: Connection is closed. Operation is not permitted. at org.postgresql.jdbc1.AbstractJdbc1ResultSet.next(AbstractJdbc1ResultSet.java:134) at jp.co.comsys.felica.ExitManagement.main(ExitManagement.java:10) 【 以上コンソール 】
ＳＱＬについてわからないことがあるので教えてください。 下記のようなtestテーブルがあるとします。 num | id | mail | event | flag | date 1 | 121 | xxxxx@xxx.com | test | 1 | 2005-10-11 2 | 121 | xxxxx@xxx.com | test | 0 | 2005-10-12 3 | 125 | xxxxx@xxx.jp | test | 1 | 2005-10-11 4 | 125 | xxxxx@xxx.jp | test | 0 | 2005-10-11 5 | 128 | xxxxx@xxx.com | test | 1 | 2005-10-13 6 | 128 | xxxxx@xxx.com | test | 0 | 2005-10-12 7 | 121 | xxxxx@xxx.com | test | 1 | 2005-10-11 このテーブルから条件を下記のようなものを検索したいときはどうしたらいいのでしょうか？ ・flag=1　 ・idはかぶることがない　 ・一番新しいdate ・ランダムで２つとりだす。 下記のようにしても、同じＩＤがとりだされてしまいます。 ここで、group by idを入力してもエラーになってしまいます。 numのデータも取得したいので。どうにかいい方法はないでしょうか？ select * from test_tb where event='test' and flag=1 order by RANDOM() desc limit 2;
no | name | id 　というテーブルがあります。 列名 no　プライマリーキーにしています。ところがこのnoはオートナンバーではない為、オートナンバー型に変更 しようと以下のコマンドを発行しましたがエラーが出てしまってうまくいきません。 list=# ALTER TABLE server list-# no SERIAL list-# ; ERROR: syntax error at or near "no" at character 20 LINE 2: no SERIAL ^ もし、お分かりになる方がおりました教えていただけませんか？ また、no name id という3つの列があるとしてid と name の順番を入れ替えたいのですがそんな コマンドってあるのでしょうか? verはpostgreSQL 8.0.1です。 よろしくお願いします。
PostgresSQL7と8の機能はどれくらい違うのでしょうか？ PostgresSQL8を使えるようになるために、 PostgresSQL7の本で勉強をしても大丈夫でしょうか？ あまりに違うというのなら、新しく本を買って勉強しようと 思うのですが。
質問失礼します。 Postgresの文字型の桁数計算方法は ７．２ぐらいから文字数計算に なったかと思うのですが これをバイト計算に設定する方法などは あるのでしょうか？ できる限り調べてみたのですが 見つかりませんでした。 宜しくお願いします。
PostgreSQL8.0をインストールした後、事情によりプログラムの追加と削除からアンインストールしました。 後日、再度インストールしようとするとサービス構成の画面で 「無効なユーザー名です: ログオン失敗: ユーザー名を認識できないか、またはパスワードが間違っています。」 とエラーになります。そこでドメイン名だけ変更すると 「ユーザー 'postgres' は生成できませんでした: ユーザー・アカウントはすでに存在します。!」 とまたまたエラーになります。 アンインストール時にレジストリなどに情報が残ったままになっているのでしょうか？ ご存知の方おられましたらよろしくお願いします。
PostgreSQLで例えば先頭から10行だけ取得したり、 5行目から3行だけ取得したりできますが、 10行目以降のすべてのデータを取得するようなことは 可能でしょうか？
ポストグレスでisnumeric関数のようなものを使いたい アクセスから移植しているのですが。 つまり値が数値かどうかを判断する関数なんですが。 いいのがありませんか？ どうすれば判別できるでしょうか？
from句の中にselect文を入れたい。 つまりテーブル名の変わりにselect文にするということですが。 select * from [select * from tbl2]. as t2 なんて感じでアクセスではできるのですが ポストグレスの場合、やりかたがわかりません。 どうすればよいでしょうか？
300近いテーブルのあるMS　Accessのファイルがあります。これらを一括で、PostgreSQLのデータベースに移行する方法はありませんか？ ODBCなどを経由してエクスポートという方法だと、300もあるとやってられません。 VBAとかでマクロを書けばできるのかな？という気もしますが、あまりVBAなどは使ったことがありません。 理想的には　.mdb　ファイルをなんらかの形で、一気にPostgreSQLに流し込みたいのですが… ご教示おねがいします。
<textarea wrap="hard" name="sentence" rows="3" cols="30"></textarea> このフォームで、入力したデータは、 PostgreSQLのテーブルに保存されるように構成しました。 フィールドは、"text"型です。 いざそれを、phpでHTMLに呼び出すと、改行文字は無視されます。 実際に、データベースを開くと、その値はこのようになっていました。 "ああああ・・あああ・・・・ああ" 改行コードはどうやら、"・"２個を改行１つと扱って保存しているようでした。 phpで、・・を含む値をHTML呼び出す時、 ・・を<BR>として呼び出して、改行してしまう技はないでしょうか？
某レンタルサーバーを借りて データベースを利用しPostgreSQL、PHPで オンラインショップみたいなのを作りたいのですが、 サーバーHP上の会員コントロールパネルからテーブルはつくってもらえたのですが、そこからサポートしてくれないので作業が進みません。。。 普通どうやってレンタルサーバー内のDBにアクセスするのでしょうか？ とっても困ってます。 どなたか宜しくお願いします！！！
現在AIXにpostgreSQL(ver.7.2.1)を導入したいと考えております。 また、perlを使用し、DBI(ver.1.42)、DBD(ver.1.31_7)モジュールを使用します。 すべてのモジュールの導入は済み、検証しようとしていたところ、DBDがうまく動作していないというエラーが表示されておりました。 そこで、DBDのバージョンが違うのではないか？ということで、DBDが正常に動作できるように別バージョンを インストールしています。しかし下記のようなエラーが表示されて先に進めずに困っております。 どなたかわかる方アドバイスをお願い致します。 ◆環境 AIX5.1 postgreSQL 7.2.1 perl 5.6.0 DBI 1.42 DBD1.2 DBD1.2を導入しようとしているのですが、perl Makefile.PL を実行した時点で以下のWarningが表示されます。 ------------------------------------------------------------------------------ Warning: prerequisite Test::Simple failed to load: Can't locate Test/Simple.pm in @INC (@INC contains: t/lib / usr/opt/perl5/lib/5.6.0/aix /usr/opt/perl5/lib/5.6.0 /usr/opt/perl5/lib/site_perl/5.6.0/aix /usr/opt/perl5/lib /site_perl/5.6.0 /usr/opt/perl5/lib/site_perl .) at (eval 4) line 3. Writing Makefile for DBD::Pg ------------------------------------------------- また、次の段階のmakeコマンドを実行すると最後に以下のようなエラーが表示されストップされてしまいます。 -------------------------------------------------- ld: 0711-317 エラー: 未定義のシンボル: .is_utf8_string ld: 0711-345 -bloadmap または -bnoquiet オプションを使用して、詳細な情報を得てください。 make: 1254-004 最後のコマンドからのエラー・コードは 8 です。 -------------------------------------------------
AS2.1上でPostgresを複数ユーザへ利用開放させる様な設計を考えております。 ユーザ１、ユーザ２を作り、それぞれのOwnerでDB（DB1：Ownerユーザ１、DB2：Ownerユーザ２）を作りました。 しかし、他OwnerのDBに接続し、勝手にCreate tableできてしまう事がテストしてわかりました。pg_hba.conf でパスワード認証(md5)等を利用しても、結局、接続ユーザのPwdを再確認するだけで、他OwnerのDBにも接続でき、CreateTableできてしましました（Select等は当然できませんが。。。） 実際にやりたいことは、DBのOwner+Postgresユーザのみ接続可能なDBを作りたいのです。これはPostgresSqlの仕様なのでしょうか？（Oracle等では、インスタンス単位にユーザ接続認証が可能な様ですね）
お世話になります。 id| text --+-------------- 1 |AD(LONG+LONG2+INT) --+-------------- 2 |AD(INT+LONG) --+-------------- 3 |AD(LONG2+INT) --+-------------- : | : というテーブル(sample)がありまして、 textカラムの'LONG'だけをを抽出したいのですが、うまく抽出できません(LONG2なども検索されてしまう)。 SELECT * FROM sample WHERE text LIKE '%LONG%' AND text NOT LIKE '%LONG2%' ではだめなのはわかりましたが、こういう場合、どう検索したらよいのでしょうか？ よろしくお願いいたします。
いつもお世話になっています。 今回質問させて頂きたいことはDBのバックアップについて、です。 現在の私のサーバの構成は WEBサーバ - DBサーバ となっています。 ちなみにDBのソフトはPostgreSQLです これをWEBサーバ　- DBサーバ - DBバックアップサーバ といった構成にしたいのです。 googleで調べましたところ PGCluster PGpool Slony-I といったツールを使用することで実現出来そうなのですが レプリケーション、フェイルオーバといった機能を 使用することを前提にしているようで、端的に言えば、「高機能すぎる」のです。 pgpoolというツールは WEBサーバ - pgpool- DBサーバ（マスタ） 　　　　　　　│ 　　　　　 　DBバックアップサーバ（スレーブ） といった構成にすることで、DBサーバ（マスタ）が落ちても自動的にスレーブに切り替える といったことが実現出来るようです。 しかしこれはDBサーバの構成を切り替えることになるので、相応の能力が必要である、 といった印象を私は受けました。正直言って業務の基幹を担うDBサーバの構成を変える勇気は 私にはありません。 しかし現構成では DBサーバが物理的に壊れてしまった場合等、不安があり過ぎる状態なので DBサーバの構成は極力変更せず、DBバックアップサーバにレプリカを「保管」出来る ようなツールを探しています。 いざという時のための保険ですので、完全なレプリカでなくても良いと思っています。 よろしくご教示のほどお願い致します。
テーブルを作成するとき、各列にデータ型を指定しなければなりませんが、そもそもなんでデータ型という物が存在するのでしょうか？ いっそのことすべてtext型で扱ってしまった方が、いちいち挿入されるデータを予測してデータ型を決定する必要もないと思うのですが… （integerよりsmallintにした方が動作が速くなるとか、そういう理由なんでしょうか？） また、データ型を決定しなければいけない場合、何を基準にデータ型を決定すればいいのでしょうか。 例えば、掲示板などをデータベースで管理する場合は、ハンドルネームがどれくらいまで長い人がいるのかわからないので、結局text型になってしまいそうですが…
■環境 RedhatLinux9.0 postgresql-7.3.2-3(rpm版) pgbenchでベンチマークテストを行いたいのですが rpmの場合はどのようにインストールすればよろしいのでしょうか？ ご教授よろしくお願いいたします
MicrsoftやOracleが行っているような認定試験（表現が間違っていればご指摘ください）がpostgresにもあるそうですが、試験内容やレベル、日時、費用、試験場所、申し込み方法などの詳細が記載されているサイト（または関連書籍）を教えてください。
PHP/PostgreSQLでの掲示板を作成しているのですが、i絵文字がちゃんと入力されず、『？』マークになってしまいます。DBはEUC_JPで,rawurlencode関数で普通の文字はちゃんと入力され表示も出来るのですが.... DBに入れる前に、『？』になっています... よろしくお願いします。
環境：RedHat Linux AS3.0 / PostgresSQL 7.3.6 Publicスキーマにインデックス付きのテーブルを作成し、 複数のスキーマにビューを作成してそのテーブルをそのまま参照したいと思っています。 （スキーマの数が非常に多いので、実体をひとつにし、 　ディスク容量を抑えるのが目的です。） 環境のイメージは以下の通りです。 ◆Publicスキーマにテーブル作成------- create table TEST_TABLE ( id int, data varchar ); ◆test_tableにインデックスを作成------- create unique index TEST_KEY on TEST_TABLE ( id ); ◆test_schemaスキーマを作成------- create schema TEST_SCHEMA; ◆test_schemaスキーマにビューを作成------- create view TEST_SCHEMA.TEST_VIEW as select id, data from TEST_TABLE ; このような環境にて「TEST_VIEW」にSELECTをかけた場合、 「TEST_KEY」は踏襲されるのでしょうか？ ビューに対してインデックスは作成できないようなので、 テーブルに対してはられたインデックスはビューでも生きている のではないかと考えたのですが、 上記認識で合っているかどうか ご存知の方がいらっしゃいましたらご教授頂けると助かります。 宜しくお願い申し上げます。
Win版のPostgreSqlを全自動でインストール（権限名やオプションなどは最初から決まっている）するソフトが作りたいのですが、どんな方法があるでしょうか？ インストーラーを起動した上で自動的に内容を入力するようなソフトでもいいですし、インストーラーを使わずに設定する方法があればそれでもいいのですが…。 よろしくお願いします。
Perl + PostgreSQL でWEBシステムを作成しております。 まず例を記載致します。 テーブル例： [ 顧客情報 ] 名前,携帯電話キャリア区分,情報A,情報B,・・・ 上記のようなテーブルが存在していたとします。 「携帯電話キャリア区分」のカラムには、'1'か'2'か'3'が入力されます。 1はDoCoMo、 2はKDDI、 3はVodafone と云う風に決めておきます。 以下質問 キャリア区分に１～３が存在し、数字がそれぞれのキャリア名と結びついています。この携帯キャリア管理をDB上に被参照テーブルを作成しそこで行うか、この程度の項目数とデータ数であれば、テキストデータとして作成し管理しておくか、どちらで行おうか非常に悩んでおります。 そこで皆さんのご意見を参考とさせて頂きたく投稿させて頂きました。 ちなみに私の考えたそれぞれのメリット・デメリットは以下の通りです。 ■DB上での管理 全データを一元的に管理できる 柔軟性が乏しい（仮に運用途中でテーブル項目が増えたりしたら面倒） ■テキストデータの管理 バックエンドとの通信がない為処理が早い DBとテキストでデータ管理が分かれる 柔軟性が高い（オープンソースなんで・・・） 以上です。 よろしくお願い致します。
ＤＢ初心者です。初歩的な質問で恐縮ですが、 データベースの大きさ（バイト数）を知るにはどうすればよいでしょうか。 いろいろ調べたのですが方法が見つからなくて困っています。 RedHat Linux9, PostgreSQL-7.3.2 を使っています。
Windowsで自作データベースの操作をしていたところフリーズしてしまい強制終了させたのですが，再起動後再びそのデータベースにアクセスしようとすると以下のようなエラーがでてデータベースにアクセスできなくなってしまいました．pdAdmin IIIでサーバーに接続を試みようとすると「サーバーは閉じています」と表示されてしまいます．どなたか解決策をご存知の方はご教授をお願いします． PHP Warning: pg_connect() [<a href='function.pg-connect'>function.pg-connect</a>]: Unable to connect to PostgreSQL server: could not connect to server: Connection　refused　(0x0000274D/10061)Is the server running on host "localhost" and acceptingTCP/IP connections on port 5432? 【環境】 Windows XP PostgreSQL8.0.4
テーブルの中に保存されている用語を検索したいんですが、複数ヒットがある場合、どのようにPHPで記述していいかわかりません。 よろしくお願いします。
Common SQL Environment を使い、ＲｅｄＨａｔ９にインストール時に自動的に入れたＰｏｓｔｇｒｅＳＱＬに接続しようとすると、 connectDB() connect() feild:No error Is the postmaster running (with -i) at '192.168.10.5' and accepting connectons on TCP/IP port'5432'? と、エラーがでて、接続できません。 pg_hba.confには、 host all xxxxx 192.168.10.2 255.255.255.0 trust を追加。 postgresql.conf では、 tcpip_socket = true port = 5432 のコメントを外しています。 他に、何か必要なのでしょうか？ あちこち情報を探しているのですが、なかなか見つからなくて。 よろしくお願いします。
今現在、PHP・PerlなどによるCGIのテスト用のサーバを稼働させています。 そこではMySQLが稼働しているのですが、その同じサーバでPostgreSQLを同時に動かすことは可能でしょうか？ 可能であれば、同じサーバで稼働させてテスト環境を動かしたいと考えています。 アドバイスお願いいたします。
$conn = pg_connect("host=xxxxxx user=postgres port=5432 dbname=xxxx"); $result = pg_Exec ($conn, $SQLSTR) ; HTML上から上記のようにphpの関数　pg_Exec　を使用して、 copy文を実行したいのですが、うまくできません。 phpからcopy文を実行することはできないのでしょうか？ コピー文："\copy tablename with oid to /tmp/output" ちなみに、$SQLSTRにselectやupdateなどのSQL文をいれると うまくいきます。 使用している環境は、OSがlinuxで、APACHE+php3+postgres6.？？ です。
はじめまして。 Perl＋RDBMSを利用してWEBシステムの構築を考えております。 テーブルの組み方についてご意見伺えればと思います。 【質問】 1) 私は作成するテーブルに対して、既に存在している複合の項目で一意性が保たれていたとしても、必ず連番（serial id）の項目を追加しそれを主キーとしております。 このやり方は何か問題ありますでしょうか？ 2) 質問1)に関連しているのですが、以下の例を元に、テーブル構成を2パターン記載致しますので、どちらの構成のほうがベター（或いはスタンダード）かをご助言頂ければと思います。 ＜例＞ --------------------- 親子関係のテーブル Table A └ Table B └ Table C --------------------- ＜考えられる上記例のテーブル構成＞ --------------------- 【P1-人工キーを用いた構成】 Table A:{A_ID} Table B:{B_ID},A_ID Table C:{C_ID},B_ID 【P2-複合キーを用いた構成】 Table A:{A_ID} Table B:{B_ID,A_ID} Table C:{C_ID,B_ID,A_ID} --------------------- 私が用いているのはP1の構成です。P1の構成を用いた場合の認知している問題点は、Table Cから一気にTable Aを参照できないことにあると思っております。 対してP2の場合、P1の問題は解決しますがテーブルのレイヤーが下がれば下がるほど、追加しないとならない項目が増えてしまって、管理の面やデータ量、またPG作成でも面倒が発生してしまうと思っています。 どちらのパターンが正規化などの観点から見ても良いものなのでしょうか？ 長文申し訳ございません。 よろしくお願い致します。
DBに、あるファイルの容量(byte)を入れています。 容量が大きく、KBやMB、GBで表現できる場合はそのようにして表現したいと考えています。 これを、ビューで定義する方法はあるでしょうか？ 現在、以下のようにビューを定義しているのですが、これだとKBまでしか表現できず、MBやGBまでは表現できないので。。。 SELECT id,(size / 1024) || 'KB' FROM table 以上、よろしくお願いいたします。
PostgreSQLでデータベースを構築している初心者です． 現在ブラウザから文字を入力し検索をかけることで， 検索結果を表示するプログラムを作っているのですが， その際に検索できる文字とできない文字があり困惑しています． 例えば，「医学」と入力するとデータベースからデータがブラウザに表示 されるのですが，「秋山浩二」と入力するとデータはあるのに 表示されないという状況に陥っています．他にも検索できる文字 とできない文字があり，なぜこうなってしまうのか分かりません． このようなことは何かの設定ミスにより起こりうることなのでしょうか． 何かお気づきの方がいらっしゃいましたら，ご教授をお願いします． 【環境】 Windows XP PostgreSQL8.0.4
postgresql 7.2.1を利用しています。 下記のようなSQL文でクエリーすると、結果が帰るまでに約40秒ほどかかります。 条件1を外すと1秒です。なにか条件絞り込みを入れ子の構造にして、最後に条件1で絞り込むようにすれば、高速化が図れると思うのですが、どのようにすればいいのでしょうか？ select tbl_1.ptnum, tbl_2.name, tbl_5.seidoname from tbl_1, tbl_2, tbl_3, tbl_4, tbl_5 where tbl_3.ymd>=20000101 and tbl_3.ymd<=20061231 --期間 and tbl_4.endymd>=20050704 --有効期間内 and tbl_2.nusi like '%匿名%' --条件1 and tbl_1.id=tbl_3.id and tbl_1.id=tbl_2.id and tbl_1.id=tbl_4.id and tbl_4.bannum=tbl_5.bannum --結合 order by tbl_1.ptnum なおfrom行でinner joinで結合したら少し早くなりました。
TUrboLinuxWS7に turbopkgを用いてアップデートしたところ postgresqlを起動しようとすると /etc/init.d/postgres startで起動しようとしたところ Checking postgresql installation: An old version of the database format was found. You need to upgrade the data format before using PostgreSQL. See (Your System's documentation directory)/postgresql-7.3/README.rpm-dist for more information. とでて起動できなくなってしまいました。 postgreSQLのバージョンは 7.1.3-8です。
PostgreSQL 8.0.1 PHP 4 Apache 1.3 で環境を構築しています。 PHPで、 $sql=sprintf("insert into records values('20','test2','cal')"); と入力し実行すると、きれいにＤＢに登録できるのですが、 $sql=sprintf("insert into records values('%s','%s','%s')",$no,$name,$address); と入力したら、ＤＢには空白で登録されてしまいます。 何がおかしいのか検討が付かなくて困っております 宜しくお願い致します。
いろいろなページで調べましたが、 下の文法でPHPからpostgresを開こうとするとエラーになります。 文法 $con = pg_connect ("host=localhost port=5432 dbname=dic user=xxx password=xxx"); エラー Fatal error: Call to undefined function pg_connect() in C:\Program Files\Apache Group\Apache2\pic\php2.php on line 9 line 9　はconnectの行と一致しますので、何かこの行に問題があるのだとは思います。 バージョンは、 postgresは、Windows版で8.0　、 PHPは5.04で、Windows版。 正しいコマンドが他にありますでしょうか？ または、他に問題点は考えられないでしょうか？
Fedora Core3をフルインストールしましたが、PostfreSQLは標準で入っているのでしょうか？ Fedora用？のPostgreSQLのダウンロード先自体がわかりませんが、どのような方法がよいのでしょうか？ まだFedoraの特徴がわからず、 試行錯誤しています。 1) yum update PostgreSQLとしても、インストールされていないようです。 2) apt-getの方がよいのでしょうか？ apt-get自体をインストールしないと使えませんが 3)PostgreSQLをダウンロードして、PRMでインストールする。 4)PostgreSQLをダウンロードして、ソースでインストールする。 お奨めはどれでしょうか？
こんにちわ。 ファイルに記述されているSQL文を、Linuxのコマンドラインなどから 実行したいと考えています。 ファイルに insert into DB_NAME(aaa,bbb,ccc) values(111,222,333); insert into DB_NAME(ddd,eee,fff) values(333,777,222); insert into DB_NAME(aaa,ttt,ddd) values(111,000,999); ... などのSQL文が複数行（例えば1000個ほど）記述しているのを用意して なんかしらの方法で一度に実行させたいのです。 mySQLでは、このようなやり方があるのですが postgreではどのようにすればいいのか、わかりません。 どなたかご存知の方、よろしくお願い致します。 OSはLinuxです。
例えば下記のような2つのテーブルがあり、注文票にはメニューのID（外部キー）だけを入れて、料理名や価格は別で持つとします。 ----------------------------------------- ■注文票table ID(int),メニューID(int) ----------------------------------------- ■メニューtable ID(int),料理名(text) ----------------------------------------- ・この2つのテーブルから以下のような出力を得たい時 且つ ・一度のselect文で出力を得る場合、 select文はどのように書けば良いでしょうか？ もちろん「select * from 注文票table」だと「料理名」ではなくて「料理ID」が出てきてしまうのですが。。。 ---------------------------------------- ■テーブルID,料理名 ----------------------------------------
こんにちは。Postgresで接続中ユーザの表示をするには（コマンド）どうすればよいか教えてください。
定義したすべてのデータベース名およびカラムを取得するようなSQLはどのようなものでしょうか？ 環境はWAMP+Postgres8.0です
debianを使っています。 apt-get install postgresql にてインストールをしても、ssl対応にはなっていません。 この対応方法を伝授して頂きますよう宜しくお願い申し上げます。
ＤＢ初心者で、PostgreSQL V.7.3.2 + PHP を使っています。 T_TIME というテーブルに、 日付を格納したTARGET_DATEと、 時刻を　　〃　TARGET_TIMEというフィールドがあります。 このテーブルからタイムスタンプをセレクトしたいと思い、つぎのようなＳＱＬ文を 作成しました。 SELECT TO_TIMESTAMP(TARGET_DATE ||' '|| TARGET_TIME, 'YYYY-MM-DD HH24:MI') AS JIKOKU FROM T_TIME ところが、この結果は書式化された文字列のため時刻の比較を簡単に行うことができません。 なんとか書式化した形でなく、1970年からの秒数でタイムスタンプを取得したいのですが。 どうすれば良いのでしょうか。
実行環境・・・CSE update文を5つ発行したくストアドプロシージャを使おうと思ったのですが上手くいかず 困っています。 create function 関数名 引数なし AS 'update文1,update文2,・・・・,update文5' language ='sql'; と行っているのですが、エラーが出てしまいます。 参考書に載っている引数ありのだと上手くいくのですが・・・ なにかやり方が間違っているのでしょうか？ ご教授お願いいたします。
PostgreSQL－Ver8.0.2のWindows版をWindowsXP上に導入し、pgAdmin　IIIなどを使いなんとか自前のユーザ名、パスワードを設定して、データベースおよびテーブルを作成しました。そしてコマンドプロンプト上では、Linux環境と似たようなコマンドラインからの入出力ができるようです。 ところが、PHPにDBアクセスのルーティンを埋込み実行するとエラーになります。おそらく、PostgreSQLサーバー起動時のパラメータ設定およびパスの通し方に問題があると考えられるのですが、どなたかご存知の方お知恵を貸してくださいませんか？ エラーメッセージは下記の通りです。 Fatal error: Call to undefined function:　pg_connect() in C:\Apache2……
初心者です。宜しく御願いします。 参考書を見ながらＰＨＰとPostgreSQLを使ってデータベースを作成中なのです。 一度保存したcsvファイルを’lo_exort’で再度取出してファイルに格納しようとしてます。 処理自体はできるのですが、できたファイルのアクセス権が６４４になってしまいます。 アクセス権を７７７にするよい方法はないでしょうか。 できればファイル作成の段階で７７７にしたいのですが・・・。 ちなみにwindowsなので'chmod'は使えないそうです。 どなたか宜しく御願いします。
初めまして。 pg_shadowのテーブルを全て削除してしまい、 postgresスーパーユーザーですらDBにアクセス出来なく なってしましました。 こうした場合はもう如何ともし難いのでしょうか… 以上、よろしくお願いします。
Postgres8です。 データベースのエンコーディングは【SQL_ASCII】です。 LIKE検索をした場合のSJISの文字化けに対する対処方法を教えてください あいまい検索をしたいのですが、 文字化け対象文字を含む場合、 どのように記述すればいいのですか？ select * from aaa where name = 'パソ\コン'; 上記のように完全一致で検索をすると抽出できます。 select * from aaa where name like '%パソ%' 上記のよう指定してlike検索をしても抽出できます。 しかし以下の場合どちらでも抽出できません。 select * from aaa where name like '%パソコ%' select * from aaa where name like '%パソ\コ%' よろしくお願い致します。
エラーの詳細は以下のとおりです。 まず、ダウンロード後解凍したpostgresql-8.0-ja.msiを ダブルクリックして、Windows2000serverSP4 に postgreSQL8.02 をインストールしました。 このときユーザpostgreも新規作成しました。 つぎに、ツールpgAdmin3を使用して上記postgreユーザで データベースtemplate1のpublicスキームの中に、 ID(int4), Book(text)の２フィールド、IDフィールドをキーとして、 tblBooksという名称の練習用の簡単なテーブルを作成しました。 さらに、pgAdmin3を使用して、このtblBooksテーブルに適当なレコードも4件追加でき、 pgAdmin3のテーブルビューで追加したこのレコード４件を確認できました。 また、pgAdmin3のクエリツールを用いて、クエリの下記を実行すると 正常に実行してくれます。 select version(); "PostgreSQL 8.0.2 on i686-pc-mingw32, compiled by GCC gcc.exe (GCC) 3.4.2 (mingw-special)" ところが、上で作成したtblBooksテーブルを含めたクエリを実行させると、 何回やっても次のようなエラーとなります。 select * from tblBooks; ERROR: relation "tblbooks" does not exist.------(1) pgAdmin3でなく、ツールpgSQLを使っても同じエラー(1)がでます。 この"relation does not exist"とは一体どんなエラーなんでしょうか？ 環境は, Windows 2000 Server SP4 で、 template1,tblBooksは次のようになっています。 CREATE DATABASE template1 WITH OWNER = postgres ENCODING = 'EUC_JP' TABLESPACE = pg_default; GRANT ALL ON DATABASE template1 TO postgres; CREATE TABLE "tblBooks" ( "ID" int4 NOT NULL, "Book" text, CONSTRAINT "key" PRIMARY KEY ("ID") ) WITHOUT OIDS;
postgreSQL8のwindows版を使っています。 テーブルにレコードを追加するとpostgresが自動で生成するユニークIDがあったかと思います。 insert後に出てくる　insert ○○○○○という数字です。 これは普段selectで表示されませんが、このＩＤを表示させる方法、 ならびにこのＩＤを使ってそのレコードを削除する方法を教えてください。
access2000からPostgresSQLのテーブルリンクで publicスキーマのみだけしかテーブルの一覧が出てきません。 データ移行などに便利なのでaccessを使いたいのですが他のスキーマをリンクさせる方法はないものでしょうか？ 宜しくお願いいたします。
お世話になります。 今、日本語と広東語が混在しているページを作っているのですが、どうしても文字化けが解消しないので相談させてください。 私の浅はかな知識では、複数の文字コードが混在する場合は、UTF-8で構築してやれば混在は可能と認識していたのですが、間違いないでしょうか。 ユーザーがPHP経由でPostgresにデータをPOSTし、その一覧をPHPで表示するだけの流れで、ブラウザで表示するのもページの構築自体もUTF-8で行っています。 PHPからinsert文を実行する際に、mb_convert_encodingを使わないで広東語を入力すると pg_exec(): Query failed: ERROR: Unicode characters greater than or equal to 0x10000 are not supported とエラーが表示されます。 しかし、mb_convert_encodingを通したあとのデータはすでに文字化けしており、結果もそのまま文字化けしてしまいます。 Postgresを使わずに、テキストに書き込みをした際には混在は可能でしたので、Postgresの問題かと思い、質問させて頂きました。 ちなみにデータベースのエンコードはUNICODEにしてあります。 ご指摘、助言等何でも構いませんのでよろしくお願いいたします。
お世話になります。 PHP4.3＋Windows版Postgres8.0で構築中です。 ものすごく一般的なinsert文 $sql="INSERT INTO dic (id,word,mean,hi) VALUES('$id','$word','mean','$hi')"; $result=pg_exec ($dbcon, $sql); とすると、 array value must start with "{" or dimension information と怒られてしまいます。 配列は{で始めよってことなのでしょうか。 配列でのinsert方法ってよくわからないのですが、そういう方法があるのでしょうか。 pgAdminの使い方があまりわからなくて、いいかげんな設定になっているためこんなエラーが出てしまうのかとも思うのですが、どこか確認箇所等ありましたらご指摘いただければと思います。 もう半日潰してしまいました。。。（涙 コマンドラインからも同様のエラーが返ります。 ＃ちなみにMySQLで動いていたものをPostgresに移植中で、プログラムには間違いない・・・と思います。 よろしくお願いいたします。
別人が作成した PostgreSQL＋Redhatlinux＋PHPのシステムがありまして、 作成者はソースコードとＤＢを稼働先に渡してお役ご免となりました。 そんな中、稼働先から 「PostgreSQLのconfig一式を送って欲しい」と要求が入り、 伝言ゲームのように私にまで周り廻ってきました。 取りあえず、pgsqlやconfigで検索を掛けてみましたが、 求められる「config一式」とは何を指すのかすらわかりません。 相手に問い合わせることもできず途方に暮れています。 PostgreSQLの前にunixコマンドすらアンチョコを見ながら。。。。 の状態ですが、「config一式」とは一般に何を指すのか教えて頂けないでしょうか。 config.m4とかは見つけました。 他にも *.h *.c *.dsp とかもありましたが、何を渡してあげれば良いのでしょうか。 よろしくお願いします
フィールドの属性が文字列の場合 like %という形式で ワイルドカードを指定できると思います. 数値データ(integer,bigintなど)のワイルドカードは存在するのでしょうか? Web検索などで調べたのですが,わかりませんでした. お教えください.
下記のようなテーブルから重複なくSELECTしたいと考えています。 temp_table ------------------------ | id | name_1 | name_2 | ------------------------ | 1　| aaaaaa | bbbbbb | | 2　| cccccc | dddddd | | 3　| cccccc | dddddd | | 4　| aaaaaa | bbbbbb | | 5　| cccccc | jjjjjj | ------------------------ SELECT結果が下記の要になるのが理想です。 DISTINCTを利用して SELECT DISTINCT id, name_1 || name_2 AS name FROM temp_tableとしましたがダメでした。 --------------------- | id | name　　　　 | --------------------- | 3　| ccccccdddddd | | 4　| aaaaaabbbbbb | | 5　| ccccccjjjjjj | --------------------- よい方法をご存じの方、宜しくお願いします。
こんにちは。 PostgreSQL 7でシステムを開発中ですが、同一テーブルから「列～の値が■のものを２件、列～の値が▲のものを２件、列～の値が●のものを２件、それ以外のものからランダムに２件を取得」したいのですが、実現できなくて困っています。 select * from table where culumn = 'data1' limit 2 union select * from table where culumn = 'data2' limit 2 というようなことなのですが、これでは「limit 2」でparse errorとなってしまいます。 できれば上記のSQL定義でビューを作りたいところなのですが、いい方法はないでしょうか？ よろしくお願いします。
t_meisaiは以下の定義で調味料の使用履歴を記録しています。 idint4uniqueな値 date timestampyy/mm/dd type int41 or 2 or 3 orderint4純粋な順番 typeには塩、砂糖のように固形のものは1、酢、醤油のように液状のものは2、それ以外は3が入ります。 orderはdate毎に使った順番が記録されていきます。 date || type のgroupごとの一番最初に使ったものだけ抽出したのが下のSQLです。 select date || type as key, min(order) from t_meisai group by key 上記の条件に当てはまるレコードのidを抽出したいのですがどうしたらよいのでしょうか？
C:\Program Files\PostgreSQL\8.0\bin>psql -U postgres test2 -c "SELECT * FROM addrbook; psql: 警告：余分なオプション "-c" は無視されます psql: 警告：余分なオプション "SELECT * FROM addrbook;" は無視されます ホスト名: localhost パスワード: PostgreSQL の会話型ターミナル、psql 8.0.1 for windows へようこそ Type: \copyright とタイプすると、配布条件を表示します。 \h とタイプすると、SQL コマンドのヘルプを表示します。 \? とタイプすると、内部スラッシュコマンドのヘルプを表示します。 \g と打つかセミコロンで閉じると、クエリーを実行します。 \q で終了します。 test2=# \q ============================================== -c以下のコマンドを実行させたいのですが、警告が出てしまいます。 ================================================ C:\Program Files\PostgreSQL\8.0\bin>type test.txt SELECT count(*) from addrbook; INSERT into addrbook values 　　 　　　　　('ttt', '0987', 'test'); C:\Program Files\PostgreSQL\8.0\bin>psql test2 -U postgres -f test.txt psql: 警告：余分なオプション "postgres" は無視されます psql: 警告：余分なオプション "-f" は無視されます psql: 警告：余分なオプション "test.txt" は無視されます ホスト名: localhost パスワード: データベース名: test2 psql: FATAL: password authentication failed for user "-U" <Enter> ================================================ test.txtを実行させたいのですが同様にエラーになってしまいます。 何が間違っているか、どなたか分かるかたがいらっしゃったらご指導お願い出来ませんでしょうか？ 何卒よろしくお願い致します。
Perl+DBI+PostgreSQLでCGIを作っているのですが、Shift-JIS固有の字を扱いたいので、 　SET CLIENT_ENCODING TO 'SJIS'; としたのですが、特定の文字列でSQL文がエラーになります。 例えば「ソ」を 　$str = $dbh->quote( 'ソ' ); とすると、$strは「'ソ\'」になるのですが、これをSQL文中で使用すると、 　DBD::Pg::st execute failed: ERROR: unterminated quoted string at or near "'ソ\' )" at character 124 となってしまいます。 どうやら「2バイト目が5Ch(半角の\)の全角文字」+「\」+「'」と言う組み合わせの時だけエラーになるようです。 ちなみにWindows上のMySQLでは「'ソ\'」で問題ありませんでした。 これはどのように対処すればよろしいのでしょうか？ OSはRed Hat Enterprise Linux ES release 3 (Taroon Update 4) カーネル 2.4.21-4.EL DBはPostgreSQL 7.4.7です。 よろしくお願いします。
ご質問させて頂きます。 ＷＩＮ版（ｘｐ）のｐｏｓｔｇｒｅｓｓｑｌを インストールしました。 スタートメニューからｐｏｓｔｇｒｅｓｓｑｌ－ ｔｅｍｐｌａｔｅ１には接続することが出来ます。 ただ、これですと 「ｔｅｍｐｌａｔｅ１」だけしか接続することが出来ません。 新規にデータベースを作成したいのですが どの様にすれば良いですか？
SELECT文で足し算をした場合、NULL値なら0で、 結果を取得する方法を教えて下さい。 select test1 + test2 from testdb; とした文を以下のようにしてみたのですが、 NULL値が0で表示できませんでした。 select COALESCE(( test1 + test2 ),0) from testdb; このような足し算で、初期値設定していなくて、 ここでのみ、表示させる方法を教えて下さい。
select * from (select distinct on (aaa) * from bbb) as ccc order by ddd テーブルbbbのaaaというフィールドが重複せず、しかも他のフィールドで並び替えをしたかったら、このような書き方以外ありますか？データベースはPostgreSQLです。 この書き方で不都合が出ているというわけではありませんが、どう書けば、パフォーマンス的にも良いSQLになるか、詳しい方がいらっしゃいましたら、お願いします。
以下の項目を抽出するSQL文を色々考えているの ですが、どうしても思い浮かびません。ぜひとも ご教示いただきたく存じます。使用データベースは PostgreSQL7.2です。 テーブル構成は以下のとおりです。 事業コード　部署コード　情報コード 01　　　　　02　　　　　01 01　　　　　02　　　　　02 01　　　　　02　　　　　03 02　　　　　05　　　　　01 02　　　　　05　　　　　02 02　　　　　05　　　　　05 02　　　　　07　　　　　02 02　　　　　07　　　　　03 02　　　　　07　　　　　06 以上のようなテーブルから、「情報コード02と03の 両方をもつ事業コードと部署コードの組み合わせ」を 求めるSQLを記述したいのです。この結果は 事業コード　部署コード 01　　　　　02 02　　　　　07 となります。 以上のような説明でご理解いただけますでしょうか。 足りない情報などがありましたらご指摘ください ませ。 宜しくお願いいたします。
　linuxマシーンでposgresqlサーバを運用しています。 事情により、ＯＳが起動できなくなりました。 　ほかのマシーンでＨＤＤの中のpostgresqlサーバの データ：/var/lib/psql/dataを見えて編集などができ ます。 　データベースのデータを取り出したいですが、アドバ イスをよろしくお願いします。
PostgresSQLのデータベースに、CommonSQLEnvironmentを使って、コンソール画面のテーブル表示画面のセルに直接、値を入力したいのですが、ムリでしょうか、やはり、インサート文を使わないとダメでしょうかね。 ご教授お願いします。
　データベースの中の値を増や構文を書きたいのですが、本で調べた update discussion set dentry=dentry+1::numeric where did = 3 ではうまく動いてくれません。 なぜなのでしょうか。教えてください。
PostgresSQL を使って、出退勤表を作成することになりました。いろいろ方法があるとは思いますが、何分初心者なのでわかりません。どうやって作ればよいのでしょうか? だれかお分かりの方、御指南いただきたいです。
こんにちは。なぜか仕事でPostgresSQLを使うことになったものです。パソコンは全くの初心者ですのでくだらない質問をしてしまうかもしれませんがよろしかったらお教え下さい。 PostgresSQLにcreate language 文を打ち込んでplpgsqlを利用したいのですが、Error function plpgsql() dose not exist と出ます。 ちなみに plpgsql.so は /usr/local/pgsql/lib/plpgsql.so にありますが、これがこのcreate language 文を動かすのに必要なものなのかどうか、他に何別のものが必要なのかよくわかりません。 どなたかお分かりになる方お教えいただけませんか?! よろしくお願い致します!!
始めまして。初心者ですので基本的な質問になるかもしれませんがよろしくお願いします! なぜかPostgreSQLを仕事に使うことになり、四苦八苦しています。 テーブルを作成しているときに、 create table syouhin (shinamono text, nedan int); とするとします。 で、insert でデータを入れていきますが、 例： shinamono | nedan ------------------ みかん ｜100 マンゴー ｜200 例えば、nedan のcast が今、int にしましたが、これをchar やfloatに変えたいときはどうすればよろしいのでしょうか? どなたか御存じの方、お手数ですがお教え下さい!!!
MySQLのように show tables;などデータベースの情報をSQLコマンド等で見れるような仕組みは PostgreSQLにあるのでしょうか？
numeric(4,1)としていた場合、 そこに書き込む際、perlで作成していて、変数が $date=41.4532でそのまま、 update test set date = $dateで、 書込みをすると、勝手にpostgreSQLで41.5となり 四捨五入になるのでしょうか？ $ritu=41.4432だと、41.4で書込みされるのでしょうか？ 教えて下さい。
某書籍「WindowsユーザーのためのPostgre…」の手順の通りに実施してるのですが、 PostgreSQLのインストール・環境変数の設定後、データベースの初期化コマンド(initdb)を実行すると、"command not found"となってしまいます。 /usr/local/pgsql/bin内に、initdbファイル(拡張子なし）は存在しています。initdb.exeは存在してません。 手順等で欠落している（しそうな）こと、対応方法を教えてください。
テーブル T_itemにはitem(TEXT),lot(TEXT),category(int)があり categoryには仕入れ時に可能なロット指定を数値で格納しています。 1は大(ミニマム1000以上のもの) 2は小(ミニマム1000より少ないのもの) 必ずitem, lotをキーにcategoryが1,2,1と2かという結果が欲しいです。 現在は select distinct item || lot as itemlot, category from T_item とすると panasonic-***0001A, 1 panasonic-***0001A, 2 panasonic-***0001B, 1 panasonic-***0001C, 2 panasonic-***0001D, 2 sony-***0001A, 1 sanyo-***0001A, 2 victor-***0001A, 1 victor-***0001A, 2 これを panasonic-***0001A, 3 panasonic-***0001B, 1 panasonic-***0001C, 2 panasonic-***0001D, 2 sony-***0001A, 1 sanyo-***0001A, 2 victor-***0001A, 3 のように結果を返したいです。 select文だけでcategoryが1,2両方持っているものを3として表示することはできますか？ または2回のselect文で1回目は1,2どちらかを持っている ものだけ、2回目は1,2両方持っているものだけという具合に結果を返すことはできるのでしょうか？
何度も質問してすみません。 NULLが格納されているフィールドに 「0」や「1」といった値を入れる為には どういうINSERT INTO文をPHP内で記述すれば宜しいでしょうか？ pg_field_is_nullを使ってみたのですが イマイチ値を変更する事ができません。 また、SQL文で「NOT NULL制約」という言葉があるのを知ったのですが、 ALTER TABLE文でテーブルを作る時に、 各フィールドにはnullではなく、「0」を最初から格納したい場合は どういった記述をすれば宜しいでしょうか？ 宜しくお願い致します。
凄い初歩的な質問だと思いますが、 テーブルから値を出力する時に 「100」などといった数値なら読み込み可能なんですが、 「aaa100」といった文字列の場合ですと、 Warning: pg_query() query failed: ERROR: column "aaa100" does not exist のようなエラーが出てしまいます。 何か特別な出力方法が必要なのでしょうか？
どなたかご存知の方、ご教示下さい！ CSVファイルよりCOPYコマンドでテーブルにレコードをインポートしようとしているのですが、 その際、timestamp型についてNULLだった場合には\Nを記述する様にしました。 ところが下記の様なテーブルの場合に、COPYが上手くいきません。 ＜テーブル TEST＞ AAA varchar(10) BBB timestamp CCC varchar(10) DDD timestamp ＜CSVファイル TEST.csv＞ てすと,\N,てすと,\N ＜実行したコマンド＞ COPY TEST from 'TEST.csv' using delimiters ','; ＜psqlのエラーメッセージ＞ ERROR: copy: line 1, Bad timestamp external representation '\N カラムBBBは問題ないのですが、 カラムDDD(最後尾のカラム)がNULLの場合にエラーになってしまいます。 何か特別な記述が必要なのでしょうか？？？ 情報お持ちの方いらっしゃいましたらどうぞよろしくお願い致します。
PostgreSQLを使って、 ２つのテーブルを作成しています。 A　と　B　とします。 ２つのテーブルはそれぞれ違う条件で、 作成されたものなのですが、項目は同じです。 （違う場合もあるかもしれませんが、今回はこれで） ２つのテーブルで全てが同じレコードがあれば、 削除し、１つのテーブルとして、作成させることは 可能なのでしょうか？ 教えてください。できれば、例をあげて下さると 嬉しいです。 ご伝授お願いします。
質問させてください、 CSV形式の10万行のデータをADO経由でINSERT,UPDATEしています そのときUPDATEもINSERTもされなかったレコードをDELETEしているんですが、 今はINSERT,UPDATE処理が終わったあと、全レコードのrecordsetを1レコードずつ csvファイルの1行と比較しています。 他に良い方法はないでしょうか？ csvファイルには category, item, price postgresのテーブル名はt_zaikoとして id(INT[NOT_NULL, default_nextval, primary_key]), category(SMALL_INT), item(TEXT), price(SMALL_INT) とします。
質問させていただきます。 Apache+PHP+PostgresSQLでサーバーを運用しています。アクセス数が多くなるとApacheが停止してしまいす。そのためボトルネックの調査をしているのですが、Apacheの同時リクエスト数(MaxClients)を150、 PostgreSQLの同時接続数(MAX_CONNECTIONS)を32に設定しています。 ApacheとPostgreSQLの同時接続数はどちらを多くしたほうがよいでしょうか？
RedHat9にPosgreSQL 7.3をインストールしたんですが、DB起動時にエラーが出てます。 DB起動コマンドは、 pg_ctl start -D /usr/local/pgsql/data -l /home/postgres/logfile postmaster successfully started DB停止コマンドは、 pg_ctl stop -D /usr/local/pgsql/data メッセージは、 pg_ctl: cannotfind /usr/local/pgsql/data/postmaster.pid Is postmaster running? postmastar.pidファイルを探しましたが、確かにありません。 そして、logfileは以下です。 LOG: startup process (pid 14202) was terminated by signal 6 LOG: aborting startup due to startup process failure 一度は起動停止確認は出来たのですか、2回目からできなくなってしまい、大変困っています。 ポート番号はデフォルトの5432のままです。 どうしたらいいのかわかりません。 よろしくお願いいたします。
生徒テーブルがありまして、 投稿時間、クラス、出席番号 00664862 22 12 00665654 13 4 00671338 32 18 00672054 33 27 00694502 22 8 となっています。 クラスを優先ソートとして、クラスと出席番号で 00665654 13 4 00694502 22 8 00664862 22 12 00671338 32 18 00672054 33 27 のようにソートするSQL文を教えてください。 今のところOrderByで 00665654 13 4 00664862 22 12 00694502 22 8 00671338 32 18 00672054 33 27 のようなクラスだけのソートしかできていません。
PHPとPostgreSQLで商品検索のWebシステムを構築しております。 ロックについて質問なのですが、管理者が商品情報を修正する場合次の手順となります。 １．商品一覧より修正したいデータ（行）を選択。するとフォームに現状の値が入力されたページに移行。 ２．フォームから修正したい箇所のみ変更し登録実行。 この手順の間、例えばフォーム上でデータを修正している間に、他の管理者がデータを修正した場合や、 データを削除した場合、不整合やエラーが起こると考え「修正目的でデータを取得した場合は、修正が完了する までその行をロックし、参照以外できない。」というような事を考えたのですがPostgreSQLの機能で可能でしょうか？ 「行ロック」が該当するのかと思いインターネットや書籍で調べてみたのですが、トランザクション毎に行なうもののようで長期的なロック目的のものではないと認識しております・・・。 よろしくお願いします。
ALTER TABLEでなくてもいいんですが ALTER TABLE KOJINTABLE DROP COLUMN(T_VAL, MEMO); これができませんでした。 T_VALとMEMOを同時に消す書式はありませんか？
２つのテーブルを結合しある項目の集計を取りたいと思ってるのですが数が０の場合の表示がされません ０を表示させる方法がわかるかたどうぞよろしくお願いします テーブル１ id | cd ---+-------- 1 | 1000 2 | 2000 3 | 3000 4 | 4000 テーブル２ id | cd ---+-------- 1 | 1000 2 | 2000 3 | 2000 4 | 4000 5 | 4000 出したい結果 cd | count -----+-------- 1000 | 1 2000 | 2 3000 | 0　　　←現状では０がでません 4000 | 2 考えたＳＱＬ SELECT t1.cd,CASE THEN count(t2.cd) = NULL THEN 0 ELSE count(*) END FROM t1 LEFT OUNTER JOIN t2 ON t1.cd = t2.cd GROUP BY t1.cd ORDER BY t1.cd よろしくお願いします
DISTINCTとGROUP BYの違いが分かりやすいホームページを教えてください。 ターミナルの結果のサンプルが書かれているホームページが理解しやすいです。
商品を登録するテーブル(商品テーブル)があって 構造が 商品主コード　varchar（5） 商品補助コード　varchar（2） 商品名　varchar（10） です。 商品主コードと商品補助コードを一つにして「商品コード」として使用しています。（ex：12345-00） 検索の際、商品コードをインプットボックスに「12345-00」と入力してその商品名を取得したいのですが、上手くいきません。 どなたかお願いします！ 現在のSQLは Select 商品名 From 商品テーブル Where 商品主コード || '-' || 商品補助コード Like '%入力された商品コード%' です。
PostgreSQLがインストールされているDBサーバにはPHPがインストールされていません。 よって他のWebサーバへphpPgAdminをインストールして、 DBサーバへ接続し、データベースの編集を行おうと考えています。 このようなことはphpPgAdminで可能でしょうか？ ご回答よろしくお願いします。
phpPgAdminをインストールして、 PostgreSQLの管理を使用と考えていますが、 セキュリティに問題はないか？と問われています。 Apacheの設定をすれば問題ないと聞いていますが、 具体的にはどのような記述をすればいいのでしょうか？ どなたか教えてください。 明日中に回答しなくてはいけないのです。 よろしくお願いします。
データベースの移行をする時に、pg_dumpを使って移行を行いました。 吐き出したアーカイブ（プレインテキスト形式）を、新しい環境のデータベースにて、 psql -e -f アーカイブ・ファイル　データベース名 として、再構築しようとしたら、 ERROR: literal carriage return found in data HINT: Use "\r" to represent carriage return. CONTEXT: COPY infotable, line 2: "acesjapan 01.販売業者名　ネット株式会社 " となり、データーの移行が出来ないテーブルが出てきました。 ＤＢには、Ｗｅｂ上よりテキストを改行ＯＫの形で入力させたものを保存していました。 ＤＢ格納前に、Postgre では不都合なコードの入力を許してしまっているのでしょうか？ なお、ｃｓｖ形式に落としてやると、データーの移行が出来ます。 おわかりになる方、是非お教えください。
業務でORACLE9iからPostgreSQL7.3.6への移行作業を命じられています。 恐縮なのですが、私はPostgreSQLについての知識が少なく、 現在あわててドキュメントや書籍を読んで勉強しているヒヨっ子です。。。 早速ご相談なのですが、 ORACLE固有の設定、"システム権限"と"PROFILE"について どうやってPostgreSQLに反映させればよいものか、ハマっております。 PostgreSQLのオブジェクトへの権限設定はGRANT文で付与出来る様ですが、 GRANT文を使用して付与する権限以外に ユーザ毎に設定可能な権限 (何でもいいです) と方法ってあるのでしょうか？？ 調べた限りでは 「GRANT文以外に設定可能なものは無さそう」 と思っているのですが、 捕捉出来ていない情報があるのでは、と心配しています。 また、ORACLEでいうところの"PROFILE"で 「このユーザのパスワード有効日数は○日です～」や 「ログインの再試行回数は○回まで」といった設定を行っているのですが、 PostgreSQLでそれに代わる設定手段はあるのでしょうか。 調べた限りでは「無さそう」と思っているのですが・・・・。 上記について情報や参考になるURL等お持ちの方いらっしゃいましたら お手数ですがご返答よろしくお願い致します。
OSがwindows ですが、 数学学習支援システム(Web System)を作ろうと思っています。そのために postgreSQLをダウンロード インストールしたいのですが、上手くいきません。 どなた様か詳しく手順を教えていただけないでしょうか？
phpPgAdminの呼び方がわかりません。。。 初歩的な質問ですが、どうかよろしくおねがいします。
こんなテーブルがあったとして、 テーブル名：shohin ------------------- type：文字列 create_date：日付 こんなデータになっていたとして type| create_date ----+----------- abc | 2004/02/01 abc | 2004/02/02 abc | 2004/02/03 hhh | 2004/01/30 xxx | 2004/01/12 xxx | 2004/01/13 xxx | 2004/01/14 xxx | 2004/01/15 xyz | 2004/01/01 xyz | 2004/01/05 このようなデータを出力したいのですが… （typeで集計して、create_dateの一番新しい日付でソート） type | count | create_date -----+-------+----------- abc | 3 | 2004/02/04 -----+-------+----------- hhh | 1 | 2004/01/30 -----+-------+----------- xxx | 4 | 2004/01/15 -----+-------+----------- xyz | 2 | 2004/01/05 これを一発で書くSQLって可能でしょうか？ 副問い合わせを使えば出来るような気がするのですが、Group By した結果からさらに最新の日付を取得してソートというのがどうも上手く書けませんでした。 お分りになる方がいらっしゃいましたら、ぜひともご教示願います。
毎度お世話になります。 この度大変困窮しており お力を拝借したい考えです。 現状ODBCで接続している Win上の自作アプリから RedHatLinux9上のpostgreSQL7.1.2のDBで 一部のデータを管理しています。 思うに該当のアプリは 単にSQL文を発行しているだけだと 推測しております。 そこでアプリがDBに どんなSQL文を発行しているか 知りたいと考えております。 何らかの方法で発行されているSQL文を記録するか 垣間見る方法はありませんでしょうか。 もしくはデータが 変更されたり追加されたテーブルを 知る方法でもかまいません。 よろしくお願いいたします。 追記：自作アプリの製作者はもうおらず、 ソースやドキュメントもありません。
PostgreSQLでAccess以上のことができますか DBシステムを作りたいと思っています。 フォームも欲しいです。
お世話になります。 ただいま古くなったサーバを再構築しております。 そこで初めてPostgresSQLを使ってみております。 Win上のVBアプリからODBCで HedHat9＆PostgresSQL-7.1.2のDBに 書き込んだり覗いたりが目標です。 とりあえずDBを作ってデータを戻して ACCESSからODBCでDBを覗いております。 管理者ユーザ「postgres」からなら 問題なく読み書きできます。 DBαとDBβというDBが二つ有あり クライアント側の設定も変えたくないので 既存にあわせてそれぞれ用の一般ユーザ AとBを作りました。 grantコマンドを使えばそれぞれのユーザに対応するDBの 読み書き削除の権限をもらせることが出来るようですが テーブルがものすごい量なので 対応するDBのすべてのテーブルの 権限を与えたいと考えております。 テーブル名をアスタリスクで指定すると 一括ですべての権限を与えられるようですが アスタリスクを受け付けてくれないようです。 他の方法で権限を与えることは出来るでしょうか。 お分かりになられる方がおられましたら ご一報いただけると幸いです。
Webシステムで文字化けが発生し困っています。 ＷＷＷ：IIS＋ASP データベース：postgresql 7.4.3 データベース(別サーバ：Linux)には、utf-8でデータが格納されています。 それを、WWWサーバ(windows2000Server)上のASPから、odbc経由で参照しようとすると、文字化けが発生します。 下記の方法を試しましたが駄目でした。 1)basp21のkconvを利用 2)metaタグに、utf-8と記載。 　(ファイル自体のエンコードもutfにした) 1)2)のやり方が悪いのか？他に問題が有るのか？お分かりになる方、どうぞ、よろしくお願い致します。
こんにちは。 今、test_tableがあり、testフィールドがあります。 testフィールドはbigintです。 今、何を実行したいかというと、 testフィールドに格納されている、 12345 23456 34567 45678 56789 のレコードの一番最後の桁(１の位）を削除して更新したいんです。 1234 2345 3456 4567 5678 update test_table set test = substring(test, 1, length(test) - 1); 上記を実行すると --------------------------------------------------- column "test" is of type bigint but expression is of type text You will need to rewrite or cast the expression --------------------------------------------------- とメッセージがでます。これは恐らく substringが返す型がtextなのにsetしようとしている フィールドがbigintの為、型が違うよって言っているんですよね。 ※本当は扱う値はbigintだけにもっと大きいのですが、 わかりやすいように小さくしてあります。 上記のような動きを実現するにはどのように記述すればよろしいでしょうか？
汎用機の世界ですと、データを昇順に並べる為に、’座布団引き’を行いソート済データの格納位置を物理的に連続させることが可能です。 RDBの世界でもこの様な事が可能なのでしょうか？ オンライン処理で、ソート処理をなくす為に、ソート済データの格納位置を物理的に連続させ、オンラインでは、そのまま取り出したいと考えています。 postgreで、実現できるか、また、その実現方法を御存知の方がいましたら、お教えください。
ＳＱＬでsubstrなどは使えますが、 splitなどは使えるのでしょうか？ 現在 m_784378_0410 m_klds_0411 m_klsdas_0411 m_klsdas_0412 表示したいデータ 0410 0411 0412 というデータを 後ろの日付のみでグループ化したいのですが、 文字のサイズが固定ではないため、一度splitなどで配列に格納したいのですが、やり方がわかりません。 何かよい方法があれば教えてください。
4つのテーブルから、それぞれ違う条件で検索し、該当する項目名NO を探したいのですが、どのようなselect文を書くと効率よく検索できる のでしょうか？また、重複NOは除きたいのです。 良かったら教えて下さい。 例えば、テーブル名：test1,test2,test3,test4とあった場合、 一度に該当するNOを拾い出す方法があれば、教えて下さい。 1.select no from test1 where code = '' and day < 20041118; 2.select no from test2 where day < 20041118; 3.2.select no from test3 where data != '' and day < 20041118; 4.select no from test4 where day > 20041018 and day < 20041118;
もしかしたらすごく簡単なことかもしれませんが、 教えて下さい。 以下のテーブルから、date1もしくはdate2が最新の日付のデータを取得するSQL文の書き方がわかりません。 (以下の例では、bbbが取得したい) name date1 date2 ---- -------- ---------- aaa 20041110 (NULL) ---- -------- ---------- bbb (NULL) 20041111 ---- -------- ---------- ccc 20041109 (NULL) ---- -------- ---------- ddd (NULL) 20041109 ---- -------- ---------- # 図がずれてわかりづらいかと思いますが... date1,date2でそれぞれmaxでname取得後に比較するしかないのでしょうか？ 環境は、Redhat9+Postgresql-7.3です。
早速ですがお願いします。CREATE TABLE をするさいに、'-'や'+'を使いたいのですが syntax error at or near "+" at character 141 というエラーメッセージがでてしまい'-'や'+'を使うことができません。使い方がわかる方教えていただけませんか？ 失敗した例を下に載せておきます。 CREATE TABLE cd-rw (メーカー名 TEXT, 商品名 TEXT, cd-r書込倍速数 TEXT, cd-rw書込倍速数 TEXT); ERROR: syntax error at or near "+" at character 141 こんな感じです。どうかお願いします。
早速ですがお願いします。例えば下のプログラムでのSQL文なのですが、配列str1[0]の中身”みかん”をINSERTしたいのですが、やりかたがわかりません。プログラミングの素人なので簡単な質問で申し訳ないですけど、どなたか教えてくれないでしょうか？ ちなみにこのプログラムでstr1[0]のところを直接みかんと入れたらデータベースに追加することはできました。 import java.sql.*; class jdbc{ public static void main(String args[]){ String[] str1 = new String[1]; str1[0] = "みかん"; try{ Class.forName("org.postgresql.Driver"); String url = "jdbc:postgresql:test"; String user = ""; String password = ""; System.out.println("URL :" + url); System.out.println("USER :" + user); System.out.println("PASSWORD :" + password); Connection conn = DriverManager.getConnection(url, user, password); Statement stmt = conn.createStatement(); int insertCount = stmt.executeUpdate("INSERT INTO shinamono (hinmei,nedan) VALUES ('+str1[0]+', 1500)"); if (insertCount >0){ System.out.println("追加しました"); }else{ System.out.println("追加できませんでした"); } conn.commit(); stmt.close(); conn.close(); }catch(SQLException e){ e.printStackTrace(); }catch(Exception e){ e.printStackTrace(); } } } なおエラーメッセージは次の通りです。 java.sql.SQLException: ERROR: column "みかん" does not exist at org.postgresql.Connection.ExecSQL(Connection.java:533) at org.postgresql.jdbc2.Statement.execute(Statement.java:294) at org.postgresql.jdbc2.Statement.executeUpdate(Statement.java:78) at jdbc.main(jdbc.java:21)
先日pgsqlの稼動しているサーバが起動できなくなり、何とかDBのバックアップを取ろうと色々やってみたのですが、pg_dumpも使えない状態だったので、pgsqlディレクトリをバックアップしました。 環境を再構築した後DBを作成し、baseにできたディレクトリの中にバックアップを取ったファイルを入れてみたのですが上手く動作しません。 何か良い方法はないでしょうか。 環境はredhat9、postgre7.3です。 よろしくお願いします。
明後日納品のWebページを作成中に、 壁にぶちあたってしまいました。 PostgresSQLにて、既にセットされている NOTNULL制約を解除しなければならないのですが、 どうにもPostgresSQLマニュアルを見ても 見つけることが出来ません。 どなたかお教え願えませんでしょうか…。
２つのテーブルがあります。 -------------------------- テーブルA（メイン） 　A_ID 　NAME テーブルB（詳細） 　B_ID 　A_ID 　SEQ -------------------------- テーブルAとテーブルBは「A_ID」で結合可能です。 テーブルBの「SEQ」には「A_ID」ごとのSEQNOが入っています。 ほしいデータは、 テーブルAの「NAME」＝XXXX　で テーブルBの「A_ID」毎の最小SEQデータの「B_ID」と「A_ID」です。 一回のSQLでできるでしょうか？ テーブルBの「A_ID」毎の最小SEQデータの「B_ID」を取得するというところからつまづいています。 どうぞよろしくお願いします。
あるA,B,Cのテーブルがあり、 Aの主キーはシーケンシャル番号が振られています。 この値を参照し、B,Cのテーブルのフィールドに挿入したいのですが、 私のやり方は (1)まずAをInsertする (2)AでInsertしてできたシーケンシャル番号を取得し、 (3)BをInsertする (4)CをInsertする と少しややこしい方法しか思いつきませんでした。 何かよいアイデアがあれば教えていただけたら、ありがたいです。
ＷｅｂアプリのログインＩＤとして、CHAR型7桁で Ａ０００１～Ａ０００１００（５桁～７桁） としているのですが、ユーザＩＤでソートした際に うまく並ばないんです。 ユーザ一覧をソートしようとした際に、 「Ａ０００１」「Ａ０００２」・・・「Ａ０００１０」などと表示したいのに、ユーザＩＤでSELECTしてくると、 「Ａ０００１」「Ａ０００１０」「Ａ０００１１」「Ａ０００１２」「Ａ０００１３」となってしまい困っています。 うまくソートする方法は無いでしょうか？ アドバイスをよろしくお願いいたします。 ※先頭は、アルファベットなので数字としてソートできないですし、ＩＤは、７桁固定で０パディングするというのも出来ないんです。
仕事場のREDHATのOSでPOSTGRESをいれていた サーバマシンが 突然電源を抜いたことによってOSが壊れてしまいました。 とりあえずは、明後日レスキューモードを試して見ますがそれでも駄目な場合は、 POSTGRESのデータを退避させたいのですが そのような事は可能なのでしょうか？ もし出来るのなら具体的な方法を教えてください よろしくお願いいたします。
text型のフィールドに下の文字列を入れようとすると ------ psStr = "D:/usr/toda/work/仕事/コーディング規約/VB/src/Base/ss.ico" objRec.Fields("field1").Value = psStr ---- ?Err.Description 複数ステップの OLE DB の操作でエラーが発生しました。各 OLE DB の状態の値を確認してください。作業は終了しませんでした。 というエラーが発生してしまいます。なぜか分かる方いますか？原因と対処の方法は？ OS：WindowsXP＋VB6です。 ADODBとPostgresODBCドライバでDBにつないでいます。 Common SQL Environmentだと入るのですが。
psqlコマンドのオプション指定で、実行する方法を教えて下さい。 psql > \i /www/test.tbl として、telnetの動作のように 行うpsqlコマンドのオプションがあれば教えて下さい。 例えば、こんな感じでできるものはありますか？ $ psql aaa -i /www/test.tbl 上記では、動きませんでした。 良かったら、教えて下さい。
こんにちは。 前回も同じようなしつもんをしましたがまた問題点がでてきてしまったので質問します。 下記が前回の質問です。困ったことにこの『数』がvarcharなのです。 そうするとa.数とb.数をsumしているところでうまく計算してくれないみたいなのです。（文字列の連結になるようです。） できればここでint型などに一時的に変換して計算させたいのですがいい方法ありませんでしょうか？ アドバイスをお願いします。 PostgresでそのIDを持っている人がどのくらいの数を持っているのかを抽出したいのです。 テーブルは下記です。 ********************************************* ★Aテーブル ID　　名前　　数　　場所　　日付 0001　みかん　１　　冷蔵庫　0901 0001　みかん　４　　倉庫　　0901 0001　みかん　１　　冷蔵庫　0901 0002　いちご　１　　部屋　　0901 0002　いちご　２　　部屋　　0801 0003　きのこ　６　　倉庫　　0901 ★Bテーブル ID　　名前 0001　みかん 0002　いちご 0003　きのこ 0004　あいす ********************************************* となっている場合、下記SQLを実行すると select a.ID ,b.名前 ,sum(a.数 + b.数) as 数 from Aテーブル a,Bテーブル b where a.日付 >= '0901' and a.日付 <= '0901' and a.ID = b.ID group by a.ID ,b.名前 結果が 0001　みかん　２ 0001　みかん　４ 0002　いちご　１ 0002　いちご　２ となり0001は合計6で出て欲しいのに別々に出てしまいます。 理想では 0001　みかん　６ 0002　いちご　３ で出て欲しいです。 これはなぜなのでしょうか？ よろしくお願いします。
SQLで連結演算子（||）を使って、col1とcol2を連結させたいのですが、 どちらかの列の値がNullだと結果がNullでかえってきてしまいます。 Select col1 || '/' || col2 As set_col From table_name; col1には必ず値が入っているのですが、col2には値が入るとは限りません。 表示させる解決策はあるのでしょうか？
既存の postgresql を使ったサーバがあります。 WEBのアプリで使用しています。 自動でcommitされる設定になっているのですが、 私が設定を変更することはできません。 psql で接続することがあるのですが、この時だけ自動commitを無効にするようなことは可能でしょうか？ よろしくお願い致します。
こんにちは。 PostgresのSQLが思うように動いてくれません！！ そのIDを持っている人がどのくらいの数を持っているのかを抽出したいのです。 テーブルは下記です。 ********************************************* ★Aテーブル ID　　名前　　数　　場所　　日付 0001　みかん　１　　冷蔵庫　0901 0001　みかん　４　　倉庫　　0901 0001　みかん　１　　冷蔵庫　0901 0002　いちご　１　　部屋　　0901 0002　いちご　２　　部屋　　0801 0003　きのこ　６　　倉庫　　0901 ★Bテーブル ID　　名前 0001　みかん 0002　いちご 0003　きのこ 0004　あいす ********************************************* となっている場合、下記SQLを実行すると select a.ID ,b.名前 ,sum(a.数) as 数 from Aテーブル a,Bテーブル b where a.日付 >= '0901' and a.日付 <= '0901' and a.ID = b.ID group by a.ID ,b.名前, a.数 結果が 0001　みかん　２ 0001　みかん　４ 0002　いちご　１ 0002　いちご　２ となり0001は合計6で出て欲しいのに別々に出てしまいます。 理想では 0001　みかん　６ 0002　いちご　３ で出て欲しいです。 たとえばこの場合、場所によってなど出てしまうものでしょうか？ これはなぜなのでしょうか？ よろしくお願いします。
連続で投稿まことに申し訳ありません できればこちらの方を優先的にお返事いただけると幸いです。 ストアドファンクションのDECLARE部で カーソル部のLIKEのところの記述がうまく検索されません。 ご教授いただけると幸いです。 *このように記述してみました mycursor CURSOR(key text) FOR SELECT * FROM tabel1 in WHERE id LIKE ''%key%'';
質問させていただきます pg/plsqlのストアドファンクション内で 受け取った引数を sql := select * from hoge; FOR rec IN EXECUTE sql LOOP return rec.col;　　　　　＜＜＜この部分で END LOOP; return; rec.引数名のようにして　引数から取得した 列を指定したいのですが、そのまま入れると そのような列はありませんと言うような返事を 返されてしまいます。 うまくやる方法はないものでしょうか？ よろしくお願いします。
PostgresSQLを勉強中です。 そこで質問ですが、A、Bという各テーブルの値の合計を求めたいのですがいまいちわからないので教えてください。 例 Aテーブル： ID type 値段 date 0001 あ 100 0902 0002 あ 110 0903 0003 え 421 0910 Bテーブル： ID type 値段 　date 0001 お 500 0901 0002 か 210 0801 0004 さ 333 0901 となっているときにA,Bテーブルの合計をtypeは関係なく出したいのです。 たとえばIDが0001であれば100＋500で600というかんじです。 下記のように結合はできましたが値段部分の総合計をどうやってだせばいいのかわかりません。 select date,type,値段 from Aテーブル where ID = '0001' and date >= '0901' UNION select date,type,値段 from Bテーブル where ID = '0001' and date >= '0901' order by date 簡単なのかもしれませんがおしえてください。 よろしくお願いします。
データベースの文字エンコーディングがEUC_JPになっていないので，EUC_JPにしたいのですが，どのファイルのどの部分をどのように変えればいいのかわかりません。 ウインドーズのODBCドライバがEUC_JPに対応しているようなので，そのように変えたいのですが。
PostgreSqlで質問があります。 データベースtestを作成したとします。 このデータベースtestをtest2に名前を変更したいのですが、どのようにすればいいのでしょうか？
PostgreSQLのSQL文で0の割り算だと計算をしないで， 0やNullを返すようなSQL文を作りたいのですが， 分かりますか？ 例えば select field0, ( field1 / field2 ) as result; だと「field2」が0の場合エラーがでてしまいます。 field0は出力したいのでWhere文で Where field2 <> 0 は使えません。 オラクルではdecodeという関数が使えるようですが。
入力したワードを含む商品の列挙をしたいのですけどpsqlで直接たたくとうまく結果がでるのにPerlからDBIを使用した場合は入力ワードによってうまくできたりできなかったりします。どうしたらうまくいくのでしょうか？ DBはEUC-JP PerlからのクエリーもEUCにJcode変換してから行っております。 なおうまく出ないのは漢字ではなく英数字をワードにしたものです。 SELECT * FROM 商品テーブル WHERE 商品名 ilike '%入力ワード%' 商品名が**** A-101ABXの場合 '%A-%'ではうまくいくけど'%A-101BX%'ではうまくいかない。 （****は任意の漢字、英数字） どうぞよろしくお願いします。
Windows版の Microsoft Access 2000で作った*.mdbファイルのデータを、 ほとんど丸ごと、LinuxのPostgreSQL(ver 7.3.4)に 一気に転記したいのです。 いい方法をご存知の方、ご教授願います。
番号|名前|国語|算数 ----+----+----+---- 1 |佐藤|95 |85 2 |高橋|75 |95 3 |今井|68 |99 を 点数|番号|名前 ----+----+---- 68 |3 |今井 75 |2 |高橋 85 |1 |佐藤 95 |1 |佐藤 95 |2 |高橋 99 |3 |今井 と重複させ並べ替えて出力したいのですが・・ 初歩的な質問でごめんなさい。教えてください・・
ORACLEの経験はあるのですが、初めてPOSTGRESQLを使用します。 ORACLEと同様にSQL文で副問い合わせを行いたいのですがどうもうまくいきません。 select winner from (select winner from 　t_play_data); と検索するとエラーになってしまいます。 SELECT ～ from ・・・　の　・・・の部分に(SELECT ～)と 副問い合わせをすることはできますでしょうか。 バージョンは　7.0.2です。 ************************************ ** 普通に検索すると検索できます。 ************************************ tsuka000jp4=> select winner from t_play_data; winner ------------- tsuka000jp palalaika ************************************************ ** 以下は副問い合わせの例ですが、 ** 副問い合わせをすると以下のようなエラーが出 ** てしまいます。 **************************************************tsuka000jp4=> select winner from (select winner from t_play_data); ERROR: parser: parse error at or near "select"
Vine Linux2.6, Tomcat5, Postgresql7.4.3の環境で、 簡単なDBへアクセスのJspを作りましたが、実行したら、次のエラーができましたが、解決方法を 教えてください。 JSP File： <HTML> <HEAD><TITLE>User List</TITLE></HEAD> <BODY> <%@ page import="java.sql.*" %> <TABLE BORDER=1 width="75%"> <TR><TH>UID</TH><TH>Password</TH></TR> <% Connection conn = null; Statement st = null; ResultSet rs = null; try { Class.forName("org.postgresql.Driver").newInstance(); conn = DriverManager.getConnection("jdbc:postgresql://xxx.xxxx.xx.xx:8080/webshop","postgres","xxxx"); st = conn.createStatement(); rs = st.executeQuery("select * from tbllogin"); while(rs.next()) { %> <TR><TD><%= rs.getString("fldlogid") %></TD> <TD><%= rs.getString("fldpwd") %></TD></TR> <% } %> </TABLE> <% } catch (Exception ex) { ex.printStackTrace(); %> </TABLE> Ooops, something bad happened: <% } finally { if (rs != null) rs.close(); if (st != null) st.close(); if (conn != null) conn.close(); } %> </BODY> </HTML> Tomcat5のログcatalina.out： org.postgresql.util.PSQLException: The backend has broken the connection. Possibly the action you have attempted has caused it to close. at org.postgresql.core.PGStream.ReceiveChar(PGStream.java:168) at org.postgresql.jdbc1.AbstractJdbc1Connection.openConnectionV3(AbstractJdbc1Connection.java:291) .....
以下のようなテーブルがあります。 ■ tb_order (注文テーブル) ※pkey は、order_cd order_cd　|　user_cd　|　sale_cd 　100　　　　user1　　　　　A 　200　　　　user2　　　　　A 　300　　　　user3　　　　　B 　400　　　　user3　　　　　A ■ tb_order_goods(注文商品テーブル) ※pkey は、order_goods_id order_goods_id　|　pay_dt　|　order_cd 　　　001　　　　　20040812　　　100 　　　002　　　　　　　　　　　　　　100 　　　003　　　　　20040812　　　100 　　　004　　　　　20040813　　　200 　　　005　　　　　　　　　　　　　　300 　　　006　　　　　　　　　　　　　　400 　　　007　　　　　20040814　　　400 　　　008　　　　　　　　　　　　　　400 #データの状態# (user_cd=user1)の人が、あるセール(sale_cd=A)の日に ３つの商品(order_goods_id=001,002,003)を、注文しました(order_cd=100)。 前払いをした商品には、pay_dtが入ります。 #質問# sale_cd が Aのときに、前払いした人のuser_cdを取得したいのですが、 どのようなSQL文を作れば効率がいいのでしょうか？ select user_cd from tb_order where sale_cd='A' and order_cd in ( select distinct order_cd from tb_order_goods where pay_dt is not null); とやれば、取得できると思いますが、tb_order_goods の全データを見てからの 抽出なので、効率が悪い気がします。 tb_order から、sale_cd='A' のorder_cd を抽出してて、order_cd を限定してから、 tb_order_goodsで、pay_dt is not nullをすれば、より早いと思うのですが・・・。 JOIN等の結合を使えばいいと思うのですが(多分)、 どのような結合がこの場合に適したものになるのか分からないため、 教えていただければと思います。
誕生日を取得するSQLとして以下の文を発行し、 -- 誕生日の並び替え(多い順) select trunc((current_date - to_date(birth,'YYYY/MM/DD'))/365) as age, count(*) as cnt from tb_custom_user where birth is not null group by age order by cnt desc; 次の結果を得ました。 age | cnt -----+----- 25 | 2 26 | 1 28 | 1 (3 rows) cntが最大数のときのageだけを取得したい場合、 上記のSQLをどう変更すればいいのでしょうか？
テキストファイルをpostgresの 'COPY'コマンドにてテーブルへ取り込みを行っています。 文字コードはEUC（CSV）からEUC(POSTGRES)です。 ＣＳＶの中で、半角のカナや記号のようなものが混じっていた場合など、COPYコマンドがエラーをおこします。 そこで実行が止まってしまい、テーブルへは何も入っていない状態になります。 COPYコマンドでエラーの起きた行は読み飛ばして取り込みを続けることは出来ないのでしょうか？
例えば、下記のようなテーブルを作成し、 create table testm ( data1 int8, data2 int8, data3 int8 ); 普通全ての項目に値があれば、1行挿入することができますが、 insert into testm values (1, 2, 3); もし、値がないのに、項目に挿入したい場合は、できるのでしょうか？ insert into testm values (1, , 3); 教えて下さい。それが出来なかった場合の対処方法も教えて下さい。
自分のＰＣ（ＸＰ）からＴｅｌｎｅｔで ＬＩＮＵＸ（Red Hat Linux release 9 (Shrike)）に接続して、 ＰｏｓｔｇｒｅＳＱＬを使いたいと思っています。 http://oshiete1.goo.ne.jp/kotaeru.php3?q=944720 の方で「ＰｏｓｔｇｒｅＳＱＬが接続出来ない」という 質問をさせて頂いた者です。 ＰＡＴＨを通したので以前のようなエラーはなくなりました。 ただ今度は次のようなエラーが出てします。 $ postmaster FATAL: XX000: failed to initialize lc_messages to "" LOCATION: InitializeGUCOptions, guc.c:1866 また、ｉｎｉｔｄｂをすると、 $ initdb initdb: no data directory specified You must identify the directory where the data for this database system will reside. Do this with either the invocation option -D or the environment variable PGDATA. というエラーが出てします。 自分なりに色々とやってみたのですが どうしても分かりません。 ご教授して頂けたら幸いです。
ご質問させて頂きます。 自分のＰＣ（ＸＰ）からＴｅｌｎｅｔで ＬＩＮＵＸ（Red Hat Linux release 9 (Shrike)）に接続して、 ＰｏｓｔｇｒｅＳＱＬを使いたいと思っています。 ＬＩＮＵＸには接続するのですが ＰｏｓｔｇｒｅＳＱＬを使おうとすると コマンドが見つからないというエラーが出てしまいます。 $postmaster -iと入力。 -bash: postmaster: command not found 管理者の方に聞くと、 ＰｏｓｔｇｒｅＳＱＬは入っているそうです。 よろしくお願いします。
OSは、WINDOWS2000 PostgreSQL＋PHP4を使用しています。 レコードの選択条件として、選択レコードの始めの５０件、５１件～１００件のように件数指定で取得することはできるのでしょうか？ 始めの５０件ですと、TOP 50（SQL Serverだったか、ACCESS？）のような感じで取得できるような気がするのですが、５１件～１００件といった指定方法はあるのでしょうか？ ご存知の方がいらっしゃいましたら、ご教授ねがいます。
はじめまして　maruchanといいます。 外部参照のところで詰まっています。 例： テーブルA id primary key name text と言うテーブルがあるとして CREATE TABLE B ( id PRIMARY KEY, z_id integer[] constraint constname references A(id) ); ということを実行したいんですが　エラーが出ます。 ERROR: syntax error at or near "cast" at character 98 なにか気づく点がありましたら　返事ください。 宜しくお願いします。
PostgreSQLでINPUTでデータを送るときなんですが データベースのデータ型はint8と、numericを使用 しているのですが、こういうときは、 <INPUT>タグのtypeは何にすれば良いのでしょうか？ 教えてください。 データ型がtextの時は、 <INPUT type="text" size="10">とすれば、いいのですが、 int8と、numericのときは、どうすればいいのですか？ 教えてください。
データベースが異なるテーブルを連結してSELECTしたいと考えています.(PHPを使用して結果をWEB上に表示したいと考えています.) つまり,2つの異なるデータベースがあり,それぞれのデータベースのテーブルの内容をINNER JOINまたはOUTER JOINで連結したいと考えています. 可能でしょうか? また,MS-Accessのリンク機能と同様な機能をPostgreSQLは持っているのでしょうか? PostgreSQL Ver.7.3.0
はじめまして。 PostgresSQLとPHPを使用してアドレス帳を作成しようとしているのですが、PostgresSQLへデータを入力する際に、すべて数字にした方が良いといわれました。 検索をする際に数字の方が良いからだと、言っておりましたが、漢字ではDB内を検索できないのでしょうか？ 名前で検索をするときは、半角カタカナで検索をするといってましたが、本当に漢字では検索できないのか？が疑問です。 どんな検索エンジンでも漢字等を使って検索をかけていますので、素人の私はわざわざ数字にする必要があるのかと思ってしまいます。 ちなみにソート機能をつけようとも思っています。 その際は半角カタカナのDB登録は必要でしょうか？ どなたか、詳しい方ご教授願えれば幸いです。 よろしくお願いいたします。
こんにちは、honiyonです。 　WindowsXP + Cygwin + PostgreSQL 　という環境で使用しています。 　psqlは 　　http://www.interwiz.koganei.tokyo.jp/software/Po … 　にあるWindows版を使用しています。 　この環境で、ファイルに保存してあるSQLを一括処理した場合に発生するエラーをしる為に、実行結果をファイルに保存したいと思い、 　psql -h localhost [DB名] < sqllist.txt > log.txt 　のように実行してみました。 　確かにログは作成されましたが、正常時のみで肝心のエラーメッセージが省かれて保存されます。 　そこで、 　psql -f sqllist.txt -o log.txt -h localhost [DB名] 　としましたが、変化ありませんでした。 　もしエラーメッセージを保存する方法がありましたら、是非ご教授ください(.. 　宜しくお願いします(..
テキスト型のデータ 2003030100001というような日付を含めたデータの 20030228以前のデータを表示しないようにしたいのですが、 どのようにしたらうまくいくのでしょうか？ 頭を悩ませています。 ご教授お願いいたします。
既存のテーブルのデータを全て削除し、 あらたに新しいデータを挿入しようとしていますが、 シーケンシャル番号を１からふりたいのですが、 SELECT setval('もともとのシーケンス',1); とするとシーケンシャルは２番目から始まってしまいます。 SELECT setval('もともとのシーケンス',0); とするとエラーになってしまいます。 スタート値を１からつけたいのですが、 どのようにしたらよいのでしょうか？？
いつもお世話になっております。 SELECTで同じフィールド名のものを抽出するときはどのようにしたらよいのでしょうか？？ イメージ的には SELECT * FROM テーブル名　WHERE shop="kkk" and shop="lll" and shop="ccc"; という感じです。 よろしくお願いいたします。
「cygwinでPostgreSQLをWindowsで使う本」 を見てインストールは完了しました ipc-daemon & initdb -D /usr/local/pgsql/data を行ったのですが creating template1 database in /usr/local/pgsql/data/base/1... のところでとまってしまい initdb:failed となります どのようにしたらいいでしょうか　また どこかサイトでヘルプがありましたら教えてくださいよろしくお願いします
市町村合併により住所の変更を行おうとしました。例として横浜市が海港市になったとします。で下記の命令を発行しました。 => update tbl_inf set home_adrs = translate (home_adrs,'横浜市','海港市'); 「横浜市」→「海港市」はこれでできました。 しかしついでに「横浜市横田区」→「海港市横田区」となってほしいのが「海港市海田区」になってしまいました。 どうも1文字ずつ検索でかけて1文字ずつ置換しているようです。これを「横浜市」→「海港市」だけ置換できるようには、どのような構文を書いたらいいのでしょうか？
MySQLでは show databases; show tables; show fields from テーブル名; でSQLコマンドとしても実行できますが、PostgreSQLで 同じことのできるSQLコマンドはあるのでしょうか？
postgreSQLに複数行（改行された）文字列を追加するにはそうしたらよいのでしょうか？ PHPでHTMLからデータを受け取り挿入したいのですが 複数行の文字列を入れるとおかしなことに・・・（汗
初めまして、お世話になります。 RDBを初めて扱うことになりまして、 右も左もわからないような状態です。 ＳＱＬ文の長さ制限について調べているのですが なかなかそのような情報にたどりつけません。 ＳＱＬ文の長さ制限について教えて頂ければと 思います。 宜しくお願いいたします。
様々な製品のデータベースを管理しています。 実は、今までデータベースシステムのメンテナンスなどをお願いしていた会社がなくなってしまいました。 担当者の居所もわからない困った状況に直面しています・・・ そんな状況でさっそくメンテナンスの必要性が生じてきました。 postgreSQLを、全てperlにて動かしているようなのですが・・・私はシステムの知識があまりないため、実際にエンジニアの方と話をしないとなりません。 予算的にも厳しいため、ＳＯＨＯなどで行なっている都内のエンジニアを探したいのですが、そういう人を見つけるのにふさわしい方法、サイトなどあったら教えてください。
SELECT文で文字列の中に例えば'g'があればそれを除いて表示するみたいな事ってできるのでしょうか？ LIKEはその文字があればその文字をひっぱってきますよね～？
あるテーブルから違うテーブルにデータを挿入しようとしています。 データ取得はPHPで作成していますが、 DBはPostgresです。 INSERT　INTO　VALUEで値を入れたいのですが、 テーブルの形式が違うため、フィールド数も違います。 VALUE(,,値,,) とするとエラーになってしまいます。 フィールド名で入れるしか方法はないのでしょうか？ 何かよい案がありましたら、ご教授ください。 よろしくお願いいたします。
下記のようなエラー文が表示されます。 NOTICE: CREATE TABLE will create implicit sequence 'テーブル名とフィールド名をくっつけたような名前' fo r SERIAL column 'テーブル名.フィールド名' NOTICE: CREATE TABLE / PRIMARY KEY will create implicit index 'テーブル名_pke y' for table 'テーブル名' このデーターベースには他にもテーブルがありますが、 名前が主キーで名前が同じものがあるからエラーがでると思い、名前を変更して実行しましたが、同じような エラーがでました。 テーブル名とフィールド名をくっつけたような名前はもともとなかったものなのですが、実行後にデータベースに作成されました。 どなたかわかる方がいたら、ご教授お願いいたします。
こんにちは。 DBのテーブル（test_tbl）が IDvarchar updatevarchar となっているときにupdateがたとえば20040501よりもあとのものをJSPで表示させたいとします。その場合、数値型にしないと比較はできないのでしょうか？ varcharどうしで比較する方法があると聞いたのですがどうやるのかわかりません。 （データ) ID　　　update 1 20040410 2 20040612 3 20040520 のときはIDが2と3のみ表示させたいのです。 よろしくお願いします。
JDK + apache + mod_webapp.so + tomcat + PostgreSQLをインストール・設定しました。 JDK　 　　　j2sdk-1_3_1_11-linux-i586 apache 　　　apache1.3.31 mod_webapp.so tomcat 　　　jakarta-tomcat-4.1.30 PostgreSQL 　　　postgresql-7.2.3 (1) http://localhost:8080/index.jsp 【tomcat】のページが出ます。 (2) http://localhost/ 【あなたの予想に反して、このページが見えているでしょうか？】のページが出ます。 (3) http://localhost:8080/examples/jsp/index.html 【JSP　Samples】のページが出ます。 (4　問題点) http://localhost/examples/jsp/index.html 【WebApp: Error 404】のページが出ます。 希望　→　(3)と同じページが出る。 起動は　tomcat　→　apache　の順です。 なぜ【WebApp: Error 404】のページが出るのでしょうか？ 教えて下さい。 お願いします。 (初心者なので出来ればわかりやすくお願いします)
Windows2000PCからDB(PostgreSQL)内のテーブルを表示させる方法について。 (WindowsPCとLinuxPCは別のPC) 二度目の挑戦です。 とりあえず、servletを使用し、DB内で作成したテーブルをLinux側で表示させたいです。 どうも、JDBCがうまくいってない感じです。 CLASSPATH設定は、tomcat4.0以降だと違うのですか？ pg_hba.confの設定はどうするのですか？ RedHatLinux7.3をインストールしました。 その他にインストールする予定なものが、 tomcat Apache mod_jk ? (mod_webapps ?) JDK JDBC ANT です。 上記のバージョンにより、適応しなかったり、不具合が起こるなど、いろいろ問題があるみたいなので、問題なく進められるバージョンを教えて下さい。 (今お使いのバージョンなど) また、インストールする順番など。 出来れば、全体の大まかな流れについても参考にさせてもらいたいです。 まだ勉強不足で、ネットで調べても人によって違うので、間違えっぱなしです。 質問多すぎてすいません。 １つでもいいので教えて下さい。 よろしくお願いします。
私は今までDBはあまり触ったことがなく、 仕組みなどもよくわかっていませんが、 仕事の関係で、タイトルに書いたように、移行する必要性がでてきました。 しかし、他の質問などを見ても、詳しく説明されているところもなく、何を言ってるいるかもわからない状況です。 勉強不足のところもありますが、まわりも忙しいあまり聞くこともままならない状況です。 ご教授いただければありがたいです。 よろしくお願いいたします。
今、野球選手をカタカナでＤＢに登録されています。 選手を検索するため、 ア行、カ行、サ行・・・ と選択して、 たとえばカ行を選択した場合、 登録している選手名の先頭の文字がカ行（カキクケコガギグゲゴ）の選手を取得したいのですが、うまくいきませんどのようにすればいいでしょうか？
会社で今行っている内容です(研修)。 内容： 自分のPC(Windows2000)で、他PC(RedHatLinux7.3)のDB(PostgreSQL7.4.2)内のテーブルを表示させる。 問題点： どこが間違っているのか漠然としているが、 ソースかJDBC設定があやしいと思います。 進め方： (1)Linux・PostgreSQLをインストール・設定 　PostgreSQL内でテーブルを作成・表示済み (2)tomcat4.1.30・Apache1.3.27_4をインストール・設定 　(WindowsのIEでtomcat・Apacheのページが開けるか確認済み) (4)JDBC設定(emacs ~/.bash_profile→CLASSPATH） (3)JDK1.3.1_11・mod_jk(モジュール)をインストール・設定 　sampleソースをLinuxに送り、それをWindows上で表示servletを作成し、＊.javaで保存 (4)FTPでLinux側に送り、コンパイルし＊.class生成 　/usr/local/tomcat/webapps/examples/WEB-INF/classes/ 　に移動 (5)Windows上で表示(予定) 　http://localhost:8080/examples/servlet/ファイル名 エラー内容： (1)Exception in thread "main" ava.lang.NoClassDefFound Error;【class名】 (2)Something unusual has occured to cause the driver to fail.Pleas report this exception:Exception:java.sql.SQLException:FATAL1: No pg_hda.conf entry for host 127.0.0.1,user postgres,database 【database名】 Staek Trace: at　～　が５行 Endof Stack Trace at ～ が４行 Linux・PostgreSQL・Javaすべてまったくの初心者です。 アドバイスよろしくお願いします。
REDHAT7.3でPostgreSQL7.2を使用しております。 定期的にバキューム処理等を行う為に スーパユーザpostgresのクーロンにコマンドを登録しましたが pg_hba.confにてlocal接続はmd5で認証を掛けている為、 実行できませんでした。（パスワードを入れられない） セキュリティー上、認証をtrustにせずmd5のままクーロンから バキュームやアナライズなどの処理を実行したいと考えております。 どの様にしたらクーロンから実行できるようになりますでしょうか？ 宜しくお願い致します。
以前の問題は解決しましたが、別の問題が発生しました。どなたかご教示ください。 環境は以下の通りです。 windowsXP Professional cygipc 2.03-2 cygwin 1.5.9-1 PostgreSql 7.4.1-3 ダンプファイルからリストア（データベースにデータを流し込む）しました。確認のため、SELECT文を発行するとタイトルのエラーが表示されます。\dや\dsコマンドを発行しても、「No relations found.」と表示されてしまいます。 pg_dump DB名 > file.dump でダンプファイルを吐き出すと、0バイトのダンプファイルが作成されるのかと思いきや、元のダンプファイルと同じ大きさのファイルが作成されました。 リストアしたテーブルはどこへいったのでしょうか。 なぜ、No relationやdoes not existなのでしょうか。 ご存知の方がおられましたらご教示ください。 よろしくお願いします。
ディスクがパンクしてしまい、かなりのデータを削除し（index利用のテーブルもあり）、バキュームしましたが、どう考えても削除したデータ容量分増えません（笑）。 計算上はデータだけで2GB程度は増えると思ったのですが。 ほとんど増加分は０。 これってありえない話ですかね？ 結果的にどうしようもなく空きがある別パーティションにデータを移してしまいました。
初めましてお世話になります 目的は接続ユーザが自分の参照できるテーブルのみを select文で抽出することです。 環境はpowergresの試作をつかっているので postges的に7.3.2に近いものになっていると思います。 私が試したのは以下になります。 pg_classに存在するrelaclについてなんですが relaclには構造型で誰がどの権限がついているかが解るので relaclの値を参照して、現ユーザをselect文で取得し その結果がどのテーブルを参照可能かselect文で 調べようとしたのですが、relaclがaclitemという 型でcast等をして文字列にと思いましたが、cast出来ませんでした 故に比較することに失敗しました。 select distinct pg_class.relname as table_name from pg_class where pg_class.relac = session_user でテーブルを取得するようなイメージで考えているのですが・・・ 何か方法をお知りの方がいらっしゃいましたらよろしくお願いします。
こんにちは。マルチポストですが、お許しください。超急ぎです。 Cygwinで動いているpostgresqlで、書籍の指示どうり、「pg_ctl start」とするとエラーになります。以下がCygwinコンソール上のないようです。 Administrator@windows2000 ~ $ pg_ctl start pg_ctl: Another postmaster may be running. Trying to start postmaster anyway. FATAL: File /usr/local/pgsql/data/PG_VERSION is missing. This is not a valid da ta directory. pg_ctl: cannot start postmaster Examine the log output. 誰か分かる人がいたら教えてください。よろしくおねがいします。
CygwinでPostgreSQLを動かしています。 PostgreSQLの標準文字コードをShift_JISにしたいんですが、どうコマンドを打てば良いか分かりません。 本にはEUC-JPを指定する際は $ initdb -D /usr/local/pgsql/data -E EUC_JP と打つと書いてありますが、EUC_JPの部分をShift_JISとするとエラーになります。 Shift_JISに設定するにはどのように打てばよいんでしょうか？
お世話になります。 postgres+php4で現在開発をしています。 テーブル設計を間違っていたようで、年月が6桁の数値（200404 等）で入る項目をtext型で作っています。 この値を、where句の中でintegerとして扱いたいのですが、where句の中でキャストは出来ないものでしょうか？ sqlは初心者でよく分かりません… どなたかアドバイスお願い致します。
同じ構造のテーブルが10個ぐらいあるのですが、 どのテーブルのカラムidに'001'が入っているかを SQLだけで検索することは可能でしょうか？ 以下のようにやってみましたが駄目でした。 select * from log_0* where id='001' オラクルならできるなどでもOKです。 よろしくお願いします。
初めてOKWeb使用させて頂きます。 Linux環境でPostgreSQLを使用していますが、Windows環境からグラフィカルに管理できるツールってないでしょうか 例えば・・・ １）テーブル一覧表示 ２）テーブルの作成や編集、削除 ３）データベースのチューニング できれば日本語版のものがいいですが、無ければ英語版でも教えていただければうれしいです。
お世話になります。 Common SQL EnvironmentとODBCdriverをダウンロードし、postgreSQLに接続しようとした際、"「libpq.dll」ロード時にエラーが発生しました。"と表示され、接続できずにいます。 対策をご存知でしたらご教示お願いします。
テーブルからレコードの列挙は分かりますが、pg_connectで接続したデータベース名に存在するテーブルの列挙は何という関数を使えばよいですか？
データベース初心者です。 XREAサーバでデータベースを利用したサイトを作っているのですが、データベースの本体はFFFTPで見れるのでしょうか？ テーブルを作成しましたが、そのテーブルのファイルらしいものが見つからないのです。 例えば、mydbという名前のテーブルを作成した場合、それをフロッピーに入れて他の人に渡すことなどできるのでしょうか？
XREAでデータベースのテーブルを作成する方法を教えてください。TelnetができないでPHPでpg_connectしましたが、PHPでテーブルの作成はできますか？
環境は Turbolinux8.0 PostgreSQL 7.2.2-3 PostgreSQL ODBC Driver 07.01.0006 日本語版 2001/07/13 版 です。 ODBCデータソースアドミニストレータの設定ですが、ユーザー名とパスワードの関係はどうなっているのでしょうか？ ここでの指示されているものに何を使っていいのかわかりません。ユーザー名がPostgresのDBのオーナー名だとした場合、そのユーザーはWindows側にも登録されていなければならないのでしょうか？ それと、/home/postgres/.bashrc に対して、次のように設定するように書かれている場合が多いのですが、Turbolinux8の場合、/home/postgresが存在しません。この場合、この扱いはどうなるのでしょうか？ /home/postgres/.bashrc PATH="$PATH":/usr/local/pgsql/bin export PGDIR=/usr/local/pgsql export PGLIB=$PGDIR/lib export PGDATA=$PGDIR/data export MANPATH="$MANPATH":$PGDIR/man export LD_LIBRARY_PATH="$LD_LIBRARY_PATH":"$PGLIB" 現状は、PostgresはApache経由でもODBC経由でも動いてはいるのですが、参考書とかWEBとかの内容と違っている感じで、これでいいのか悪いのかそこらあたりがしっくりしません。 よろしくお願いします。
すいませーん！教えてください！ Linux8.0でPostgresSQLを使っています。 サーバ内にあるDBのテーブルを、他のサーバにコピー、もしくは丸ごと転送するやりかったってありますか？ あったら教えてください。 こちら、linuxは初心者。SQLも一般的なコマンドしか知らないので、出来れば詳しい手順とコマンドを教えていただければ助かります。 テーブルをtxtファイルにして…とか聞いたんですが。よくわからないのです。
LinuxでPostgreSQLのデータベースをJDBCでアクセスしたいのですが、以下のソースで次のエラーが発生します。何か必要なファイルでもあるのでしょうか？ java.lang.ClassNotFoundException:org.postgres.Driver また、LinuxのODBCも必要なファイルがあるのでしょうか？ import java.sql.*; class jdbcSample2 { public static void main(String argv[]) { int a; String b; try { //Class.forName ("sun.jdbc.odbc.JdbcOdbcDriver"); //String url = "jdbc:odbc:test"; Class.forName ("org.postgres.Driver"); String url = "jdbc:postgresql://127.0.0.1:5432/test"; String user = ""; String password = ""; Connection con = DriverManager.getConnection(url, user, password); Statement stmt = con.createStatement (); String query = "select * from member;"; ResultSet rs = stmt.executeQuery (query); while(rs.next()){ a = rs.getInt(1); b = rs.getString(2); System.out.println(a + ", " + b); } rs.close(); stmt.close(); con.close(); } catch (SQLException ex) { System.err.println("SQL failed."); ex.printStackTrace (); } catch (Exception ex) { ex.printStackTrace (); } } }
postgreにて今月末を求めたいのですが、 方法が見つかりません。 また SELECT CURRENT_DATE - 18 はokなのに SELECT CURRENT_DATE - DATE_PART ('DAY',CURRENT_DATE) は引き算はだめなのでしょうか？
お世話になります。 表題の通り、posgreSQLをインストール作業中なのですが、 can't open library: /usr/lib/libssl.0.9.7.dylib (No such file or directory, errno = 2) となってしまいました。 確かにその箇所にあるのは「libssl.0.9.dylib」です。 アップデートすれば良いのかな、と思いましたが、いまいちよく分からず。 インストールで参考にしたのは、 http://www.kei3.jp/diary/2003/05/postgresql.html およびその元である、 http://www.entropy.ch/software/macosx/postgresql/ です。 postgresのバージョンは、リンクがあった7.4のパッケージ版。 10.2だと何か違うんでしょうか？？？
RHL9インストール時にPostgreSQLもインストールしました。 この場合、DBファイルはどのフォルダに作成されるのでしょうか？ creatdb したものを find するのですが、見あたりません。 よろしくお願いします。
現在、はじめてpostgreSQL7.2.1(Windows版)を使用しています。 インストールして、psqlにてログイン時にびっくりしたのが、 ユーザー、パスワード共に何でもかんでもログインが出来る事です。 oracleでは確か、初めにsystem（？）でログインして、ユーザーを作成 する事から色々と始めた様な気がします。 そこで質問です。これはwindows版なのでこうなっているのか。それとも linux版でも同様にログインは誰でも可能なのか？ デフォルトで作成されているデータベースについてのみの事なのか？ 何か理由があるのか？ 以上、よろしくお願いします。
urizakaです さて、PostgresSQLのpostgresql.confをカスタマイズ (effective_cache_sizeとsort_mem,shared_buffersをカスタマイズしました)してpostgreSQLを 「/etc/rc.d/init.d/postgresql start」 で再起動したのですが、突然 Starting postgresql service: standard in must be a tty と表示されてPostgreSQLが再起動しなくなってしまいました。「standard in must be a tty」というのが Webminと関係あるという話を小耳に挟んで、Webminから再起動してみたのですが、やはり駄目でした これはいったい、何が原因なのでしょうか・・・ ちなみに環境はRedHatLinux と postgresql-7.2.1です。 宜しくお願いします。
こんにちわ， 今PostgreSQLを勉強しています。 たとえば, SELECT * FROM table where field ~ 'a'; とすると，tableテーブルからfieldに「a」が入っている項目を抜き出す，となります。 これに SELECT * FROM table where field LIKE '*a'; とすると，エラーが出てしまいます。 *（ワイルドカード）の使用はどのようなときに使用するのでしょうか。PostgreではLinuxとは違う使用をすると書いてあったのですが,よくわかりません。 よろしくおねがいします。
宜しくお願い致します。 postgresql7.2 でlinuxアカウントに登録されていない ユーザを作成しました。（createuser hoge） その後 "psql -U hoge DB名" でアクセスすると psql: FATAL 1: user "hoge" does not exist になってしまいます。 linuxアカウントに登録されていないユーザで DBにアクセスする事は可能なのでしょうか？ それとも必ずlinuxアカウントに登録されている ユーザ名で作成する必要があるのでしょうか？ ご教授下さい。m(__)m
PostgreSQLをHTTPでダウンロードしたいのですが、 Postgreサイトからは、FTPでしかＤＬできません。 私のネットワーク環境が、FTP対応しておらずに、 DLに困っております。 どなたか、ＤＬ出来るサイト御存知でしたら、 御教授頂けますようお願い致します。
初めて質問をします。よろしくお願いします。 環境はLinaxです。 テキストファイルにDROP TABLEとCREATE TABLEの命令を書いておき、 それをpsql \i test.txt で読み込み、テーブルを作成したいのですが、 下記のテキストの内容だと、テーブルが存在しない場合、エラーが発生します。 テーブルが存在すれば、DROPしてCREATE、 テーブルが存在しなければ、CREATEのみ という動作をさせたいのですが、どのようにしたら良いでしょうか？ よろしくお願い致します。 テキストファイルtest.txt --------------------- DROP TABLE testID; CREATE TABLE testID ( id TEXT, name TEXT, ); ---------------------
エキスパートから学ぶPostgreSQL活用テクニックの本を見て、RedHatLinux7.2にインストールしたいのですが、ポスグレ7.1.3をRedHatLinux7.2にインストールすることってできますか？本の対応表には7.1までしか載っていません・・・。また、本に書いてあるインストール手順が非常にわかりにくいため、そのへんも教えていただければ光栄です。 宜しくお願いしますσ(^^)
PHPにてデータの入っていないテーブルに対して”pg_result”の処理をすると ”Warning: 0 is not a PostgresSQL result index”という 警告文が出てしまいます。 これを何とか回避したいのです。 また、最悪警告文のみ(Error文ではなく)表示させないようにできればいいのですが方法が分かりません。 お分かりになられる方おりましたら、よろしくご教授ください。 環境： RedhatLinux6.2J apache-1.3.12-0jp1 php-3.0.15_i18n_ja-0vl2 postgresql-7.0.2-2.i386
Postgresのエラー一覧と説明がある 書籍または、サイトをご存知の方が 居ませんでしょうか？ Warning: Unable to connect to PostgresSQL server: FATAL 1: Index pg_trigger_tgrelid_index is not a btree in phpDB.lib on line 50 など、知りたいです よろしくお願いします
