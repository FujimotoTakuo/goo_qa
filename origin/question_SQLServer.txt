Left Joinで左側のテーブルをもとに右側のテーブルを連結したいのですが、右側のテーブルに重複データが存在します。そこで、重複してしいる右側のデータの任意の一つだけを結合したいのですが、どのようにしたらよいでしょうか？ 例えば以下の様な内容です。 テーブルA 商品　数量 ----------------------- 商品１　１０ 商品２　２０ 商品３　３０ テーブルB 商品　　単価　　日付 ----------------------- 商品１　１００　8/10 商品１　１１０　8/11 商品３　２００　8/12 これらのテーブルを結合して以下のようなデータを取得したいのですが、同のようなSQL文を作成したらよいのでしょうか？ 検索結果 商品　数量　単価　日付 ----------------------- 商品１　１０　１００　8/10 商品２　２０　NULL　NULL 商品３　３０　２００　8/12 商品１はテーブルBに重複したデータがありますが、いずれか一つを選択できればOKです。 商品２はテーブルBにデータがありませんので、単価と日付はNULLでOKです。
お世話になります。 Accessでシステムを開発中でテーブルをSQLServer内に移行しました。 以前までDELETE文で同一条件のレコードを一括で削除できていたのですが、SQLServerにテーブルを移行して以来「1行の更新/削除により、1行以上のリンクテーブルに影響がありました。固有インデックスに重複する値が含まれます。」というエラーが出てしまいます。 こちらの解決法をご教示願います。 どなたか詳しい方、お力添えよろしくお願い致します。
お世話になります。 Accessで売上管理システムを作成しテーブルをSQLServerに移行しました。 SQLServerからODBC接続でデータの取り込みを行いリンクテーブルを作成したのですが、 今まで正常に動作していたクエリが開かなくなってしまいました。 原因であるSQLServer内のデータ型は確認しましたが特に一致していないものはないかと思います、、 外部テーブルだとクエリは上手く動作しないなどあるのでしょうか？ 詳しい方お力添えよろしくお願い致します。
教えて下さい。 テーブル名(明細) 書籍コード　　明細金額 1001 　　　　23000 1102 　　　　 9500 1234 　 　　 25000 1115 　 　　　8000 1001 　 　　31000 とあります。 問題として [テーブルにある書籍で20000円を超えた書籍のコードを抜き出し、抜き出した合計を列名totalとともに表示しなさい。] SQLがわかりません。よろしくお願いします。
お世話になります。 最近AccessとVBAの学習を始めた者です。 Accessを用いて簡単な売上管理システムを作成しました。 システムを共有できるようにするためにSQLServerへの接続を試みています。 SQLServer内にAccessと同じデータ型のテーブルは作成済みです。 これにどのような方法でデータの追加などをするか調べても良く分かりません。 VBAでODBC接続を行うためのコードを記述するというところまで分かりました。 コードの例などあればすごく助かります。 私自身理解が不足しているため稚拙な文章ですがご了承ください。 よろしくお願い致します。
オンプレにあるSQL ServerのデータをクラウドのAzure SQL Databaseからリアルタイムに参照したいのですが、リンクサーバーは使えないようです。うまい方法ありませんでしょうか？ 最悪、CSVかなんかでバッチ的に連携するしかないかなと思っていますが・・ よろしくお願いいたします。
SQLをパソコンでやりたいのですがどれダウンロードすればいいですか？
Ａ列で条件を判断し結果をＤ列に記入するにはどうすれば良いのですか。 A列が3000以上の場合Ｄ列にＡ A列が2000から3000の場合Ｄ列にＢ A列が1000から2000の場合Ｄ列にＣ でＡ列が増えていきます。 　　　Ａ列　　　　　　Ｄ列 １　　3500　　　　　　Ａ ２　　2500　　　　　　Ｂ ３　　1000　　　　　　Ｃ ・ ・ ・ 150　3400　　　　　　Ａ よろしくお願いします。
SQL初心者です。 下記のテーブルから結果を表示したいです。 ■数量テーブル 営業所区分 　センター区分　　数量 null 　　　　 91　　　　　　　1 null 　　　　 91　　　　　　　2 null 　　　　 92　　　　　　　3 null 　　　　 92　　　　　　　4 01 　　　　　91　　　　　　　1 01 　　　　　91　　　　　　　2 01 　　　　　92　　　　　　　3 01 　　　　　92　　　　　　　4 ■結果 営業所区分　 数量 01　　　　　　10 91　　　　　　3 92　　　　　　7 SELECT CASE WHEN 営業所区分 IS NULL THEN センタ-区分 ELSE 営業所区分 END, SUM(数量) AS 数量 FROM 数量テーブル GROUP BY 営業所区分 ORDER BY 営業所区分 上記の記述してみましたが取得できませんでした。 よろしくお願いします。
データベースを使用して、SQLのデータを上書きしたいのですが、 『m_control』テーブルの「controlid」にある同名データ（'PRIMARY'）があるため、エラーになります。 どうしたら、データベースを上書きできるのかを、教えてください。
SQL言語を基礎から勉強したいんですけれど、おすすめの勉強の仕方ないですか？
以下の内容の追加質問です。 http://oshiete.goo.ne.jp/qa/9224819.html ご回答いただいた内容でデータの抽出がうまくできましたが、実はもう一つの悩みがあります。 テーブルT1とT2の列は可変です。 ユーザーの操作によって、列の添削ができますので、列を変数にしてさらに前回の回答に列の代わりに変数を使ってデータの抽出ができないでしょうか。 どうぞご教授をお願いします。
SQLのクエリ、又はプロシージャで以下のことを実現したいです。 ●前提 　テーブルT1とテーブルT2に、変更前のレコードと変更後のレコードがあります。 　仮にT1に次の列があります。しかも、列はユーザーによって添削できますので、列は可変。 　BusinessName　Item1　Item2　Item3 　取引先A　　　　　A1　　　A2　　A3 　取引先B　　　　　B1　　　B2　　B3 　 　同じく、仮にT2に次の列があります。しかも、列はユーザーによって添削できますので、列は可変。 　BusinessName　Item1　Item2　Item3 　取引先A　　　　　A1　　　A4　　A3 　取引先B　　　　　B4　　　B2　　B5 ●以下の結果を抽出したいです。 　新しいテーブルT3を作成して結果をT3に格納。 　BusinessName　PreData　AfterData 　取引先A　　　　　A2　　　　A4　　 　取引先B　　　　　B1　　　　B4　　 　取引先B　　　　　B3　　　　B5 プロシージャの初心者なので、どうか助けてください。
いつも大変参考にさせてもらっています。 いま添付画像のようなテーブルを結合し、その中で計算した結果を列追加して表示しています。 単純にこの方法だと端数が切り捨てられてしまうので赤字部分を合算しても 元の金額「121841」と一致しません。 そこで親フラグに「１」がたっているものにおいては端数分を含めた値にしたいと考えているのですが、どのようなクエリにすればよろしいのでしょうか。 （利率78.9%の行は「121841-（1827+23880）」で求めた値としたい） アドバイスのほどよろしくお願いいたします。
教えてください。 Windows Server 2007 SP2 SQL Server 2008 R2 PHP 5.5.10 PHPからSQLServerに接続したいのですが、 設定してもうまく動きません。 UID、PWDは、どこの設定でいれたユーザー名・パスワードですか？ ユーザー名・パスワードに SQLServerのインストール時にいれたSQLServerシステム管理者を 入力すると CSEでODBC接続できました。 このSQLServerシステム管理者の ユーザー名・パスワードで動くはずなんでしょうか？ それとも別の設定が間違っているのでしょうか？ 【 sqlsrv_connect関数の場合】 $serverName = "srv01"; $connectionInfo = array("UID"=>"sa", "PWD"=>"testtest", "Database"=>"testdb"); $conn = sqlsrv_connect($serverName, $connectionInfo); 【PDOの場合】 $serverName = 'srv01'; $database = 'testdb'; $uid = 'sa'; $pwd = 'testtest'; $conn = new PDO( "sqlsrv:server=$serverName;Database=$database", $uid, $pwd); 教えてください。 よろしくお願いします。
少々混乱してるので変なこと書いてるかもしれません SQLServer2008R2　にて 複数のデータ列があるデータベースが存在しています データの重複を除いてその件数を取得したいのですが 重複チェックしたいデータ列が1つだけではないため COUNT（DISTINCT データ列）　は使えません 以下の様なグループ化を行う事でデータそのものは取得できているのですが 求めたいのはデータではなくて対象になるデータ件数となります SELECT 列１、列２、列３ FROM データベース GROUP BY 列１、列２、列３ 上記の結果を　COUNT　関数に渡すような形になると思っています 　　（これがそもそも方向性が違うのかも） 調べてはいるのですがその書き方がわかりません どのようにすればいいのでしょうか
C#のフォームから入力を行ったテーブルがあり、 [TBL1]nVARCHAR(8) 100000 ''　←入力値がない場合入力フォーム上でのベリチェックのため’’を初期値設定 18 101 といったデータが入っていますが、 このデータをＣＳＶで出力し報告するように言われました。 // ※指定　number型　（値がない場合ＮＵＬＬ） // この場合ＣＳＶ出力で「値なし」は　「…,,…」になるようにとのことで ＤＢのビュー定義、埋込関数で変換して対応したいと思いましたが convert(bigint,TBL1)　だと’’の部分が０になってしまいます convert(numeric(8,0),TBL1)ですと型変換時にエラーになってしまいます 上記のTBL1表示が数値型でＮＵＬＬ有の ビュー１[TBL1]（数値型） 100000 NULL 18 101 ビューの埋込SQLだけではむずかしいでしょうか？
以下のSELECT文をひとつにまとめる方法を知りたいです SELECT * FROM city,town WHERE city.id=town.city_id city.id; SELECT * FROM city,town WHERE city.id=?;
データベースのエクスポートですが、 ワードプレスで、データーベースを接頭辞に区切って その一部を使用しています。 wp19_　　というぐあいに。 エクスポートする場合、テーブルごとにやらなければならないのでしょうか？
ＳＱＬサーバのエクセル連携について ＯＤＢＣ経由で　テーブル単位でリンクができることは通常、よくされているかと思います。 あるＴＥＳＴ１テーブルに　１から４０までの番号フィールド付の情報があり ＤＡＴＡ１、ＤＡＴＡ２の付帯情報が存在します。 この場合　エクセルで　左側に　１から２０までの番号フィールドに相当するＤＡＴＡ１、ＤＡＴＡ２の付帯情報を表示 右側に　２１から４０までの番号フィールドに相当するＤＡＴＡ１、ＤＡＴＡ２の付帯情報を表示を 分けて表示できないものでしょうか。 ＳＱＬサーバは無償版　エクセルは２００７で使用 ご教示いただけると助かります。 よろしくお願いいたします。
知識ゼロの初心者です。 勉強がてらSQLServerの構築をしたいと思っていますが、 どうすれば下記の構想が実現するための具体的な手段がわからずにいます。。。 　①動員数100名程度の小規模イベントの参加人数、氏名、性別等を管理したい 　②SQLServerは無償で利用できる「SQL Server 2008 R2 Express Edition」を利用したい 　③自PCではなくクラウド上でサーバをレンタルし、クラウドのサーバ上でDB構築したい 　④DBを構築するクラウドサーバのレンタルなども含めて、全て無償でできる範囲で行いたい ③、④について、 ・DBをインストールするクラウドサーバはどのサイトからレンタルすればいいのか ・そもそも可能なのか をなんにも理解できていない馬鹿にもわかるように教えて頂けたらと思います。 以下余談ですが、 最終的にはWEB上でDB更新用サイトを限定公開したり、 アプリを開発してANDROID端末上でDBを更新したりしたい、 という大それた野望があり、まずはDBの構築から頑張りたいのでよろしくお願いします。
SQLでテーブルの値を更新するのに他のフィールドの値を 条件にするにはどうしたらよいのでしょうか。 具体例を挙げると次のようなマスタとテーブルがあった場合、 テーブルAの「ID2」フィールドに同テーブルのF1とF2をキーに マスタMから検索した「ID1」の値を入れたいですが。 ■マスタM ID1 / F1 / F2 1 / A / 10 2 / A / 20 3 / B / 10 ■テーブルA ID1 / ID2 / F1 / F2 1 / / A / 20 2 / / B / 10 3 / / A / 10 ■試したSQL update A set ID2=(select ID1 from M where M.F1=F1 and M.F2=F2) よろしくお願いします
postgresqlにて 「delete a from aa as a left outer join bb as b on a.id = b.id where b.sd = 2 and a.dd = b.dd and a.fd = 1」 こういったクエリでDB_errorが出ます 「delete a」を「select *」にすると 欲しい結果が出ます usingも試しましたが駄目でした inとサブクエリならいけました join句では無理なのでしょうか？ 調べた限りではいけるはずなのですが…
SQLについて教えてください。 あるテーブルから条件を指定して出したい時に例えば、除外したい場合に、 条件句で 「終了日が今日より前」としたい時は、 どのようなSQL文をたたけば良いのでしょうか。 また、終了日（END_DATE）が無期限の場合はNULLも設定されているため、 「NULLの場合は9999/12/31とする」 といった感じで置換処理した上で除外条件を適用して下さい。と助言して頂いたのですが、どのようなSQL文にすれば良いのかよくわかりません。。。 置換処理して除外条件を適用？こちらはどのようなSQL文で出す事ができますか？教えてください(´・c_・`) SQLは勉強中で初心者なので、誰か詳しい方がおりましたら教えて頂けないでしょうか。宜しくお願い致します。
この問題はどのようにして考えたら良いのでしょうか？ SQL文に関しては無知ですので、わかりやすく解説していただけるとありがたいです... ちなみに解答は④でした。 よろしくお願いいたします。
Windows8.1 を使っています。microsoft認証でログオンしていますが、サーバー接続で「ログインできませんでした。このログインは信頼されていないドメインからのログインなので、Windows 認証では使用できません。」が状態が続いています。コントロールパネルから資格認証しているのですがうまくつながりません。 調べてみると「http://blogs.technet.com/b/jpntsblog/archive/201 …」のサイトがあり、「回避策」の前に 「Active Directory ドメイン環境では、Microsoft アカウントでログオンするように構成できませんので、特に心配する必要はありません。」 とありますが、これは、Active Directory 使用下のサーバーでは接続不可？という意味なのでしょうか？ 他のWindows7やWindows8.1(マイクロソフトアカウントでなくウインドウスアカウントで構成)のパソコンからは問題なく接続できています。 よろしくお願いします。
Accessの更新クエリを使って以下のことをやりたいです。 実現できる方法を教えてください。 ＜クエリでやりたいこと＞ ・ある行の中で、1つでも同じ文字があった場合、判定列にフラグ（1）が立つ。 ・そうでない場合にはブランクのまま。 ・イメージ図を添付致しましたので、あわせてご覧ください。
単純復旧モデルでは、データベースのバックアップを取得するとトランザクションログが切り捨てられるという認識で合っていますでしょうか？ また、ランザクションログが切り捨て方法は下のコマンドで合っていますでしょうか？ 　・dbcc shrinkfile(X,TRUNCATEONLY) or 　・BACKUP DATABASE (DB) TO DISK = 'NUL' トランザクションログの増大で、ディスク圧迫しているので対策を検討しています。
SQL Server 2005 Express Editionを使用しています。 データベースは単純復旧モデルなのですが、トランザクション ログがすぐ満杯になり、9002 エラーが発行され、困っています。データベース、トランザクション ログ共にバックアップは取っていません。自動拡張もしていません。 ネットで調べると、単純復旧モデルは自動的にトランザクション ログを切り捨てるので、ログの肥大化を心配する必要はないと書いてあります。なぜ満杯になるのか不明。 （圧縮される量よりも、ログが貯まる量のほうが多い？） トランザクションログは、ログ領域を5GBにしているのに1時間程度で満杯になり、9002 エラーが発行され困っています。 対策としては、ジョブでDBCC SHRINKFILEを定期的に発行して、トランザクション ログを削除する 案を考えていますが、イレギュラーな気がしています。他にもっといい対策案（簡単、確実）はないでしょうか？
システムの改修で今まで物理消去する挙動をしていた項目を 論理消去として消去フラグを立てて実際のデータは残すという変更を したいです データベースはSQLserverです つまり今までdaleatしていたところをupdateで消去フラグを立てるのだと 思いますが プログラミングを学び始めたばかりで 具体的にどの文をどう変更すればいいのかイメージがわきません 消去フラグを立てるということは データの受け取り側にもそのための処理を加えないといけませんよね？ VS2005でASP.net、C#を使ってWebアプリをSQLと連携させています 現在はTransaction-SQLについて調べながらという感じです 抽象的な質問になってしまっているかと思いますが システム開発関係者の方にご意見伺いたいと思いますので よろしくお願いします。
データベースについて、できるのかどうかも含めて全く見当がつかないので教えてください。Accessみたいにと書きましたが、現在はFileMakerを使っています。AccessやFMの場合、レコードを移動した瞬間にそれまで入力していた内容がUPDATEされると思います。Windows Form に SQLSERVERという環境で、そういうことはできるのでしょうか？
VB2010 expressでデータベースを使ったアプリを作成しようとしています。(作り方が図書に書かれているアプリです) ですが、サンプルデータベースをネットからダウンロードして、サーバエクスプローラーでデータ接続を試みようとした所、次のようなエラーが出ました。 「ユーザーインスタンスのプロセスを起動中のエラーによりsql serverのユーザーインスタンスを生成できませんでした」 エラー内容をネットで調べたところ、 C:\Users\ユーザ名\AppData\Local\Microsoft\Microsoft SQL Server Data\SQLEXPRESS の「SQLEXPRESS」を消して実行すれば解決すると書いてあったのですが、解決できません。 ほかに、接続の追加画面の詳細設定を押して、「User Instance」を「False」にすれば、いいとも 書いてあったりしたのですが、だめでした。VB2010 ExpressとSQL Server2012 Management Studioが入っているからダメなのでしょうか？ 誰かわかる方、ご教授お願いいたします。 【開発環境】 Windows 8.1 Microsoft Visual Basic Express 2010（データベース作成編集はVBでやっている） SQL Server2012 Management Studio（いろいろやっていてインストールした）
SQL文について教えて頂ければとおもいます。 売上テーブルには下記のレコードが入っています。 売上日、商品、数量 4/10　　商品A　　2 4/10　　商品B　　3 4/10　　商品A　　2 4/10　　商品C　　1 4/10　　商品B　　1 4/11　　商品A　　1 4/11　　商品B　　2 4/11　　商品C　　3 4/11　　商品C　　2 4/11　　商品A　　2 4/11　　商品B　　4 商品は3種類しかなく、日付ごとの3種類の売り上げ数量1行に表示する方法を COUNT やGROUP BYを組み合わせていろいろ試行錯誤していますが、 うまくいきません。 イメージは下記になります。 日付　商品A　商品B　商品C 4/10　　4　　　　　4　　　　1 4/11　　3　　　　　6　　　　5 そもそもSQLでは上記のイメージにできないのでしょうか？
はじめまして。 SQLの構文について、アドバイスいただきたく投稿しました。 下記のようなテーブルがあり、 id| month | limit | price --+-------+------------+------ 1 | 1月 | 2015/01/01 | 100 1 | 1月 | 2015/02/01 | 100 1 | 2月 | 2015/03/01 | 200 1 | 2月 | 2015/04/01 | 200 1 | 3月 | 2015/05/01 | 300 1 | 4月 | 2015/06/01 | 300 1 | 5月 | 2015/07/01 | 300 1 | 6月 | 2015/08/01 | 300 このテーブルから、下記のような結果を取得したいです。 id| month | limit | price --+---------+------------+------ 1 | 1月 | 2015/02/01 | 200 1 | 2月 | 2015/04/01 | 400 1 | 3月以降 | 2015/08/01 | 300 条件1.同一id,同一monthでグループ化 条件2.priceは各グループの合計金額 条件3.limitは、各グループで最も新しい日付 条件1について、1月または2月以外の月は、同一月とみなしてグループ化したい、という希望です。 必死で考えましたが、思うような結果が得られず、アドバイスいただけないでしょうか。
数字の場合は、&quot;exit(select 3);&quot;を実行するとerrorlevelに入ってきます。 文字の場合はどのようにしてバッチの環境変数に入れるのでしょうか？
お世話になります。 以下、お伺いさせてください。 OS＝Windows8.1のパソコンに、ACCESS2010をインストールしています。 OS＝Windows2012Serverのサーバーに、SQLServer2014Standardをインストールしています。 SQLServerデータベースには、テーブル「A」と、ビュー（ACCESSで言うクエリ）の「B」があります。 パソコンにACCESS2010のファイルを作り、ODBC接続で、「A」と「B」にリンクを張ります。 この結果、テーブル「A」は正常に参照、編修、デザインビュー参照が出来ます。 ビュー「B」に関しては、実質的にこれがビューではなくテーブルになってしまいます。 ビュー「B」を開きますと、あらかじめ設定されているビューの内容が表示されますが、 ビュー「B」のデザインビューを参照しますと、ビューのそれではなく、 テーブルとしてのそれが表示されてしまいます。 ビューの条件設定内容も表示されません。 ビューのデザインビューの編集（対象テーブルの追加、削除、データ抽出条件の指定、変更等）を、 パソコンから行いたいと思うのですが、これは可能でしょうか。 ACCESS2008以前のADP（AccessDataProject）ではこれが出来るのですが、 ODBCリンクでは、これが出来ない仕様なのでしょうか。 これが出来ない場合、サーバーのデータベースの編集は、サーバーで直接行うか、 ビューではなくテーブルの全行を開いて行うか、専用ソフトを作成して行うか、 等が対処方法としては考えられると思いますが、 可能であればビューで行いたいです。 他に何か方法があれば、ご教示頂きたいと思います。 どうぞよろしくお願い致します。
お世話になります。 MicrosoftAccess2000（9.0.2812）がインストールされている、WindowsXPPro（5.1.2600）SP3を複数台使用し、WindowsServer2012のデータベースサーバー（MicrosoftSQLServer2014Standardインストール）に接続しております。 Access2000のadp（AccessDataProject）を使って、パソコンから、サーバーデータベースの中身を見ています。 あるパソコンではデータベースのビューのデザイン指定、参照、編修を問題なく使用出来ているのですが、ある別のパソコンからは、ビューのデザインの保存が出来ません。「接続されているSQLサーバーはSQLServer2000よりも新しいバージョンです。保存は無効になります。」とメッセージが出ます。 またこの場合、ビューには、all_columns(sys)～xml_schema_wildcards(sys)という、多数のテーブルが出現します。ビューのデザインが保存出来るパソコンでは、これらが出現しません。 以前は、SQLServer2000StandardをインストールしたWindowsServer2003に接続していました。 パソコンは両者とも全く同じOSのバージョン、Accessのバージョン、なのですが、サーバーのデータベースのビューが保存出来るものと出来ないものとが分かれてしまい、その違いが分かりません。 この原因に関しまして、何かお分かりになられる方がいらっしゃいましたら、ぜひご教示くださいませ。 どうぞよろしくお願い致します。
SQL Serverで以下のようなテーブルからデータを取得しようと思っているのですが、うまく取得できません。 テーブル１　NEWS_TABLE 　ニュースID(NEWS_ID)と都道府県ID(PREF_ID)が100件格納されています。 テーブル２　PREF_TABLE 　都道府県ID(PREF_ID)と都道府県名(PREF_NAME)が格納されています。 ニュースの頻発するベスト４の都道府県をリストアップしたいのですが、以下のSQLだと問題なく取得できます。 SELECT TOP 4 COUNT(A.NEWS_ID) AS COUNT , A.PREF_ID ,(SELECT PREF_NAME FROM PREF_TABLE WHERE ID = A.PREF_ID) AS PREF_NAME FROM NEWS_TABLE AS A (NOLOCK) WHERE A.NEWS_ID IN (1,2,3,4,5,6,7,8,9,10.....) GROUP BY A.PREF_ID ORDER BY COUNT DESC ところが、以下だとエラーになってしまいます。 SELECT TOP 4 COUNT(A.NEWS_ID) AS COUNT , A.PREF_ID ,(SELECT PREF_NAME FROM PREF_TABLE WHERE ID = A.PREF_ID) AS PREF_NAME FROM NEWS_TABLE AS A (NOLOCK) LEFT JOIN PREF_TABLE AS B (NOLOCK) ON A.PREF_ID = B.PREF_ID WHERE A.NEWS_ID IN (1,2,3,4,5,6,7,8,9,10.....) GROUP BY A.PREF_ID ORDER BY COUNT DESC メッセージは以下 メッセージ 8120、レベル 16、状態 1、行 5 列 ＊＊＊＊' は選択リスト内では無効です。この列は集計関数または GROUP BY 句に含まれていません。 2つ目の方が一般的のような気がするのですが、なぜエラーになるのか、2つ目の方法で解決策があるのか、教えて頂けないでしょうか？
SQL Server Configuration ManagerからSQL Serverを開始したら、「要求が失敗したか、サービスが適切な時間内に応答しませんでした。詳細については、イベントログまたは他の適切なエラーログを参照してください。」というメッセージが表示されて、開始できません。 コマンドラインからは開始できます。何が原因でしょうか。
締め日が21～翌20日なのですが、ある実績表を月度毎で集計したい場合みなさんならどういうクエリにしますか？ できたらクロス集計で、横軸が○/21～翌/20でならぶようにしたいです。 1～月末なら、月毎に集計させればいいのですが。 よいお知恵をおかしください。 Excelでもいいです。
ローカルに作られたMySQLのデータベースがあります。それは英語辞書をデータベース化したものです。 構造は head,body = 'computer', 'コンピューター' head,body = 'person', '人' ... という、単純なものです。 突然、使えなくなりました。 次の状態です。 mysql> SELECT body FROM dic WHERE head='computer'; ERROR 1194 (HY000): Table 'dic' is marked as crashed and should be repaired そこで、ネット情報を参考にして、 mysql> REPAIR TABLE dic; +--------------+--------+----------+-----------------------------------+ | Table | Op | Msg_type | Msg_text | +--------------+--------+----------+-----------------------------------+ | xxx.dic | repair | error | Table 'xxx.dic' is read only | +--------------+--------+----------+-----------------------------------+ 1 row in set, 1 warning (0.00 sec) としましたが、問題は解決されません。 どうすれば良いのでしょうか。
ユーザ環境の制限により、ミストが多い環境にFANレスPCを設置して、別の場所にNASを設置することになりました。 NASにSQL Server2008R2のインスタンスを作成したいのですが、FANレスPCでインストール時にNASドライブを認識できず困ってます。 NASをネットワークドライブに割り当てても、コンピュータ名「\\NAS\MSSQLSERVER」で指定しても認識できません。 また、いったんSQL Serverをローカルドライブ（C:\）にインストールして、 SQL Server Management StudioでMDFをデダッチして NASドライブ（ネットワークドライブ）にアタッチしようとすると 「特殊なセキュリティ権限・・・」でエラーとなります。 SQL Serverのサービスのログインは 　・Network Service 　・Local System 　・Windowsログインユーザ（Admini権限） で試しましたが症状は変わりませんでした。 NASはバッファロー製の TS-X2.0TL/R5 を使ってます。 なお、USB外付けHDDにはSQL Serverのインスタンスをインストールできることは確認してます。 対策方法の助言いただけると幸いです。
お世話になります。 　当方、SQL server expressを使用しており、以下の２テーブルをフローIDで内部結合しています。 test1　　　　　　　　　test2 順番、フローID　　　通番、フローID、タイトル　更新日時 1　　　　1　　　　　　　1　　　　1　　　　てすと　　　12/1 2　　　　2　 　　　　　 2　　　　1　　　　 テスト２　　12/2 3 　　　 3　　　　　　　3　　　　2　　　　テスト３　　　12/3 　　　　　　　　　 　　　4　　　　3　　　　テスト４　　　12/4 SELECT * FROM test1 INNER JOIN test2 ON (test1.フローID=test2.フローID) 結果 順番　フローID　　　通番　フローID　タイトル　更新日時 1　　　　1　　　　　　　1　　　1　　　てすと　　　12/1 1　　　　1　 　　　　　 2　　　1　　　 テスト２　　12/2 2 　　　 2　　　　　　　3　　　2　　　テスト３　　　12/3 3　　　 3　　　　　　　 4　　　3　　　テスト４　　　12/4 　ここで、順番＝１の行で指定されているフローIDがテーブルtest2に二行存在するため、結合した結果も順番＝１に対して二行になっています。 　これを、test2のフローIDが重複する場合はtest2の更新日時が新しいほうだけを表示するようにしたいと考えています。 　ご教授頂けますと幸いです。 　感覚としては、test2テーブルをgroup by句でまとめたものをテーブルとして定義して、内部結合できればよさそうなのですが、上手い資料が見つかりませんでした。 　クエリでも、ストアドプロシージャとしての実行でも構いません。
今日は。 データベースは(One to many)データベースです。 私書いたコードは myDataContext obj = new myDataContext(); Language Lang = (from p in myDataContext .Language s where p.Id == 2 select p).Single(); if (Lang != null) { Lang .Language = "India"; db.SubmitChanges(); } 困っているから、宜しくお願い致します。
SQL Server 2012 Express LocalDBを常時起動しておくにはどのようにすればよいでしょうか。 タスクマネージャで見ていると、起動してしばらくすると、sqlserver.exeが終了してしまいます。 SQL Server 2012 ExpressであればSQL Server Management Studioで設定できると思いますが、LocalDBではどうすればよいのでしょうか。
AccessアプリでSQL Serverデータベースを更新しています。 データベースをODBCデータソースとして登録して、AccessdeそのODBCデータソースへのリンクテーブルを作っています。 データベースが何回か壊れたのですが、AccessVBAから発行したリンクテーブルへのSQLクエリでデータベースが壊れるようなことはあるんでしょうか？ あるとしたら、そのクエリを発行すると必ず壊れると思うんですが・・・。 同じAccessアプリを使っても、データベースが壊れない環境もありますし・・・。 データベースが壊れた原因がわからなくて困っています。 Windows 7、SQL Server 2008 R2 Express です。
Visual Studio Express 2013 for Webでデータベースアプリを作成しています。 例えば、 Person表 IdS_IdC_IdZ 11212 2222 323NULL 444NULL 54444 6555 7111 8167 9777 10666 1115NULL 12455 13455 14678 のようなデータがあり、横軸S_Id、縦軸C_Idの数、の積み上げ棒グラフ（StackedColumn） （S_Id毎にC_Idの数の内訳を示したグラフ。カウント対象はZがNULLでないものだけ） を作成するには、どのようなSQL SELECT文を書けばよいでしょうか。 目的とする要素数は、 SELECT S_Id, C_Id, COUNT(Z) FROM Person GROUP BY S_Id, C_Id; で出るのですが、 積み上げ棒グラフのためには、 SELECT S_Id, C_Id=1の数(ZがNULLでない), C_Id=2の数(ZがNULLでない), C_Id=3の数(ZがNULLでない), ．．． FROM Person GROUP BY S_Id; のような形にする必要があるようで、うまく書けません。 COUNTで、ZがNULLでなくかつC_Id=1のものをカウントする、というようなことができればよいのですが。
分かりやすくするために、テーブル名などは日本語で書きます。 曲名テーブルのアーティストはアーティストテーブルの番号から参照していて、 さらに、アーティストテーブルのアーティストは名前テーブルの番号から参照しています。 この場合に、曲名テーブルのアーティストを検索(例えば：「大塚愛」と検索)したいのですが、 検索してみても、なかなかピンとくる答えがありませんでした。 JOINで結合いいかと思いますが、テーブルから参照、さらにそのテーブルは、また別のテーブルから参照。 この様な場合はどうクエリーを書いたらいいか全くわかりません。 詳しい方宜しくお願いします。 現在、検証出来る環境がありません。 where 曲名 like '%大塚愛%'" 曲名テーブル +---------------+---------------+---------------+ |................[番号]............|................[曲名]............|.......[アーティスト].....| +---------------+---------------+---------------+ アーティストテーブル +---------------+---------------+ |................[番号]............|.......[アーティスト].....| +---------------+---------------+ 名前テーブル +---------------+---------------+---------------+ |................[番号]............|...............[名前]............|................[読み]............| +---------------+---------------+---------------+
テーブルAへINSERTをした場合のIDENTITY列の値を 同じトランザクション内で テーブルBの別のフィールドへINSERTしたいのですが、 どのようにSQLを書けばよいのか、困っています。 どうか、ご教示お願い致します。 INSERT INTOTABLE_A (NAME_A) VALUES ('あいうえお') ↓ INSERT INTOTABLE_A (A_ID,NAME_B) VALUES (取得したA_ID, 'さしす') INSERT INTOTABLE_A (NAME_A) VALUES ('かきくけこ') ↓ INSERT INTOTABLE_A (A_ID,NAME_B) VALUES (取得したA_ID, 'たちつ') INSERT INTOTABLE_A (NAME_A) VALUES ('さしすせそ') ↓ INSERT INTOTABLE_A (A_ID,NAME_B) VALUES (取得したA_ID, 'なにぬ') TABLE_A ID NAME_A 5　　'あいうえお' 6　　'かきくけこ' 7　　'さしすせそ' TABLE_B ID A_ID NAME_B 1　　5　　'さしす' 2　　6　　'たちつ' 3　　7　　'なにぬ'
データベースの勉強のため、入門書を購入して、はじめたのですが、 最初からいきなりつまづきました（>_<）。 開発環境　windows 8 SQL Server 2012 Express Visual Studio 2010　SP1 です。 これで、データベースファイルを作成して、サーバーエクスプローラーで、”新しいテーブルの追加”を クリックしたところ、 ”このバージョンはサポートされていません。サポータされているサーバーはSQL Server 2008までです。” とのエラーメッセージが出ました。 そこで、質問ですが、この環境で、設定変更で使えないものでしょうか？ それとも、SQL Server 2008にするか、またはVS2012にするしかないのでしょうか？ 詳しい方が、おられれば教えて頂きたいです。よろしくお願いします。
SQL Server 2008での話です。 製品テーブルと、その製品の売れ行きのランキングデータを格納するテーブルがあって、 売れ行きの良いものTOP10だけ取り出したいと思っています。 製品IDがキーになっています。 ランクテーブルから10位以内の製品IDをSELECTし、それをIN句に 入れるということをやっていたのですが、遅かったので、EXISTSに 書き変えました。 更に、INNER JOINにしてしまえば、WHERE句より実行されるので、 より速くなると聞き、試しているところです。 実際、速くはなったのですが、以下パターンだとそれほど差が出ません。 （データの件数のせいだとは思いますが…） どちらがベターなのでしょうか。 Bのほうが先に絞り込みをしてから結合されるから、速い…ような気が しているのですが、動き的には一緒だったりしますかね…。 もしより良い書き方がありましたらご教授ください。 ■Aパターン SELECT * FROM 製品テーブル INNER JOIN ランクテーブル ON 製品テーブル.製品ID = ランクテーブル.製品ID AND ランクテーブル.順位 <= 10 ■Bパターン SELECT * FROM 製品テーブル INNER JOIN ( SELECT ランクテーブル.製品ID FROM ランクテーブル WHERE ランクテーブル.順位 <= 10 ) TMP ON TMP.製品ID = 製品テーブル.製品ID
現在Accessで組まれているデータベースがあるのですが、複数人で入力をする必要が出てきたため、SQL Serverへ移行したいと思っています。 ただ、まだデータベースの内容が完全にFIXしておらず、項目に変更や追加が発生する可能性があります。 そこで、 ●Accessを管理画面として使い、 ●Access上で内容を変更したら、システム全体もその通り変わる ような仕組みを作りたいのですが、可能でしょうか。 （完全にSQL Serverへ移行するのではなく、AccessとSQL Serverを連携させる？） よき方法がありましたら教えて頂けましたら幸いです。 ちなみにコストはあまり大きくはかけられません・・。 どうぞよろしくお願いします。 （※私はシステムはど素人なので、なるべく簡単に教えて頂けたら嬉しいです。なお、説明がおかしなこともあるかと思いますがご容赦ください。）
SQL文で２つのSELCT文の結果を繋げる方法はありますでしょうか。 Left Join でもと思ったのですが、片側にしかないのも、１レコードとして出力したいです。 テーブルの例と出力の理想は以下です。 また、上記の応用でこれを４テーブル(SELECT文)を繋げて、下記例で言うと、日付と商品コードがキーで、どのテーブルに存在しても、結果を１行で返せるでしょうか。 【テーブル１(SELECT文１)】 Ｆ_仕入 伝票日付　商品コード　仕入金額 2014/07/01　101　　　　　10,000 2014/07/02　102　　　　　15,000 2014/07/05 104 20,000 【テーブル2(SELECT文2)】 Ｆ_売上 伝票日付　商品コード　売上金額 2014/07/01　101　　　　　15,000 2014/07/02　102　　　　　25,000 2014/07/03 103 13,000 上記２つのSELECT結果 伝票日付　 商品コード　仕入金額　売上金額 2014/07/01 101 10,000 15,000 2014/07/02 102 15000 25,000 2014/07/03 103 13,000 2014/07/05 104 20,000 よろしくお願いします。
2台のPCでSQL Serverのデータベースを別のコンピュータのSQL Serverで 復元しています。 別のWindows Server上のSQLServer2012から別のWindows Server上の SQLServer2012へバックアップファイル（yyyymmdd.bak）でリストアを しようとしております。 作業内容としては、データベース→DB選択→タスク→復元→データベースとし、 デバイスからバックアップファイルを指定しています。 データベースの復元は問題なく行え、DBへのアクセス、参照なども行えるのですが、 復元時に使用したユーザとは別のユーザのデータベースロールのアクセス権が消え てしまうのです。 SQLServerへの接続はでき、エクスプローラーには、データベースの表示はされる のですが、表示されたDBを選択をするとアクセスエラーとなります。 Windows認証で接続しているユーザです。 ユーザは同じですがドメインが異なる。 何故、消えてしまうのか。 消えないようにするにはどうしたらよいのか。 教えて下さい。 また、このような事象の説明があるサイトなどがありましたら教えて下さい。 つたない文面でわかりづらいとは思いますが、宜しくお願い致します。
お世話になります。 SQL Serever 2008 Standard イントラにてブラウザを介してDBへアクセスしております。 日時を登録するときに、yyyy/mm/dd hh:mm形式で登録させたいのですが、テーブルの該当フィールドのデータ型がdatetimeだと秒まで登録されてしまいます。 上記フォーマットでの登録は無理なのでしょうか。 ※テーブルには文字列として登録するのではなく、ちゃんと日時で登録したいところです。 ご教授の程、宜しくお願い致します。
あるテーブルAがあり、そこにINT型の列bと列cがあるとします。 |b|c| |1|2| |1|3| とデータが格納されているとき、ここから[1,2,3]という風に、重複のない結合結果を出すにはどういったSQLを書けば良いでしょうか。 2列だとDISTINCTも使えず、簡単そうなのに自分ではできませんでした。出力後に結合するのでは色々と不都合なことがあったため、この出力が一発で出せれば便利だと思い質問させていただきました。ご回答よろしくお願いいたします。
お世話になります。 以下の問題に直面し困っております。 よろしくご教授願います。 元々MS SQL Server 2000 にて使用していたテーブル（4千数百万行）を ほぼ同じマシンスペックの筐体にインストールした SQL Server　2008R2 に移行したところ、単純なSELECT文を実行しただけでCPU使用率が100%近くまで上昇してしてしまいます。（2000では20～30%） インデックスが移行されていないのかと思い確認しましたが、全く同じ状態でした。 何かサーバ、OSの設定等で解決できるものでしょうか？
sqlserver2008,2012を使用しています。 あるフィールドの値が、"999-999"の書式になっているかチェックを行いたいのですが、 SQLで簡単にチェックできますか？ 文字列（nvarchar）エリアで、３桁の数値＋'-'＋３桁の数値　以外のデータを抽出したいと思っております。 どなたかご教授お願いします。
SQL Server 2008環境です。 文字列の末尾の空白を一括して削除したくて、以下のようなクエリを書きました。 UPDATE TEST_TABLE SET NAME = REPLACE(RTRIM(REPLACE(StoreBranchName, '　', ' ')), ' ', '　') 全角スペースを一度半角スペースにして、RTRIMをかけた後、最後に 半角スペースを全角に直すというものです。 しかし、これだと、元々半角スペースが入っていた場合、そっちまで全角スペースに なってしまうため悩んでおります。 うまいやり方を教えていただけないでしょうか。 宜しくお願いします。
Sql server 2008 r2 standard editionで、あるストアドプロシージャの実行してから一定時間処理が終わらなかった場合に自動的にそのストアドプロシージャの処理を終了させる方法はありますでしょうか。 もしご存知の方がいらっしゃいましたら教えていただければ幸いです、よろしくお願いいたします。
Visual Studio Express 2013 for Webでデータベースアプリを作成しようとしており、そのメインとなる部分として、データをエクセルのように表形式で扱いたいのですが、なかなかうまくいきません。ネットにサンプルプログラムがありそうなものですが、見つかりません。部分的なサンプルを駆使して、現在LinqDataSourceとGridViewを用いて途中までは作成しています。 欲しい機能としては、 １．データ検証ありで、データの追加、更新 ２．データの削除（確認ポップアップあり） ３．各データでフィルタリング表示（起動時は全データ表示。フィルタリングを外せば全データ表示できる） ４．データ読み込み後、他者が更新した１行（１レコード）を更新しようとしたら、その旨表示して更新しない。 ５．エクセルファイルにエクスポートもできれば嬉しい。 何かよいサンプルプログラムはないでしょうか。
SQLserver 2005 Expressを使用してます。 csvをBULKINSERTでインポートする際にcsvの最終行に終了コードのようなデータが 入っていてインポートに失敗します。 BULKINSERTのWITHオプションのLASTROWの引数に変数を使用して 日々行数の変化するcsvの最終行-1の値をセットしたいのですが構文エラーに なります。どのように記述したらいいのでしょうか？ 試した事は test.csv 1,あ,4200 2,い,5300 ．　←　何かのデータ CREATE PROCEDURE [dbo].[test1] AS bulk insert test_table from 'C:\test.csv' with (firstrow = 1,formatfile = 'C:\Import_Fmt.xml') で実行するとエラー「一括読み込み: データ ファイルで予期しないファイルの終了が検出されました。」になるので、最終行の「．」が原因かと思い。 ALTER PROCEDURE [dbo].[test1] AS bulk insert test_table from 'C:\test.csv' with (firstrow = 1,lastrow = 2,formatfile = 'C:\Import_Fmt.xml') で実行するとエラー無くインポートされました。 実際のcsvは行数10000件はあり日々増減しますので毎回手作業で数えることは難しいです。 そこで一度仮テーブルを作り改行コードまでを一つのカラムにインポートして 行数をカウントし、変数にセットしてLASTROWの引数に渡そうとして ALTER PROCEDURE [dbo].[test1] AS declare @maxseq as int drop table test2 create table test2(F1 varchar(max)) bulk insert test2 from 'C:\test.csv' with (firstrow = 1,formatfile = 'C:\ImportOrg_Fmt2.xml') set @maxseq = (select count([F1]) from test2) --ここにreturn @maxseqを記述して以降を削除して実行し、ストアドを実行したら 　　　　　 --取り込んだcsvの行数が表示されました。 bulk insert test_table from 'C:\data\test.csv' with (firstrow = 1,lastrow = @maxseq -1 ,formatfile = 'C:\ImportOrg_Fmt.xml') と記述して実行すると メッセージ 102、レベル 15、状態 1、プロシージャ test1、行 23 '@maxdeq' 付近に不適切な構文があります。 となりました。 どのように記述したら構文エラーにならずに実行できるかご回答をよろしくお願いします。
SQLServer 2008 です。 以下のツリーデータの場合に A ┬C │├D ┬H ││　├I ││　└J │└E B ┬F ┬I 　│　└L 　└G 次のようなデータを登録しています。 ┌──┬──┬──┐ │OYA │KO　│Data│ ├──┼──┼──┤ │A │C 　│"C" │ ├──┼──┼──┤ │A　 │D 　│"D" │ ├──┼──┼──┤ │A　 │E 　│"E" │ ├──┼──┼──┤ │B　 │F　 │"F" │ ├──┼──┼──┤ │B　 │G 　│"G" │ ├──┼──┼──┤ │D 　│H 　│"H" │ ├──┼──┼──┤ │D 　│I 　│"I" │ ├──┼──┼──┤ │D 　│J 　│"J" │ ├──┼──┼──┤ │F 　│I 　│"I" │ ├──┼──┼──┤ │F 　│L 　│"L" │ └──┴──┴──┘ 引数OYA＝"A"でSQLを実行した場合に 以下のような この引数を含むそれ以下のツリーに関する データを取得する方法を教えてください。 ┌──┬──┬──┐ │OYA │KO　│Data│ ├──┼──┼──┤ │A │C 　│"C" │ ├──┼──┼──┤ │A　 │D 　│"D" │ ├──┼──┼──┤ │A　 │E 　│"E" │ ├──┼──┼──┤ │D 　│H 　│"H" │ ├──┼──┼──┤ │D 　│I 　│"I" │ ├──┼──┼──┤ │D 　│J 　│"J" │ └──┴──┴──┘
MS SQL2005 の”SQL Server Management Studio”を使って下のクエリーを実行します。 例１は実行できますが、例２は実行できません。 なぜでしょうか？ 例１ select * from [test].[dbo].[test_table] 例２ select * from （'[test].[dbo]' + '.[test_table]'）
現在サーババージョンアップに伴うストアドの動作検証を行っています。 内容としては2000で動作していたものを2008R2に移行するだけです。 そこでひとつ問題が発生して作業がとまってしまいましたので、 お力を借りたく、質問させていただきます。 環境としては、クライアントはACCESSプログラム、DBはSQLServerとなっています。 ストアドの実行で下記のように記載していたプログラムが動作しなくなりました。 Set adoCN = New ADODB.Connection adoCN.Open CurrentProject.Connection adoCN.BeginTrans adoCN.Execute "exec dbo.実行ストアド" 'エラー判定 adoCN.CommitTrans 上記エラー判定で「リンク サーバー "(null)" の OLE DB プロバイダー "SQLNCLI10" から、 メッセージ "アクティブなトランザクションがありません。" が返されました。」 となってしまいます。 また、このストアド内では「SET XACT_ABORT ON ～ SET XACT_ABORT OFF」 としてあります。 ちなみに、上記「adoCN.BeginTrans」、「adoCN.CommitTrans」をコメントすると、 正常に動作しました。 「SET XACT_ABORT ON」としているので「adoCN.BeginTrans」はなくてもいいと思うのですが、 明確に『不要である』としている文献等、見つからなかったため、迷っています。 サーバはバージョンアップに伴い、分散トランザクションを使用するようになっていますが、 この変更が影響しているのかどうか、まったく別の原因なのか、わからない状態です。 うまく伝わっているか心配ですが、どうぞ宜しくお願い致します。
質問をお願いします。 現在、複数のネットショップを運営しています。 各ショッピングモールに出品するのが大変なので、自社で商品データベースを作って、それぞれのモール用（楽天、Yahoo、Dena、自社、ヤフオク、ポンパレ）のCSVデータと画像を吐き出すようにしています。 ただ、社員が勉強しながら作ったソフトなのでトラブルが多発し、困っています。 このような素人が作成したソフトのソースをプロに渡し、理想の形に仕上げていただきたいのですが、可能でしょうか？ 価格的にもどのくらいかかるのか心配です。 人の書いたソースは理解するだけでも大変そうです。ちなみに私自身は全く理解できていません。 開発環境は Windows Server 2008 R2 Visual Basic 2010 Express と聞いております。 よろしくお願いします
SharePoint 2010にて、10個のサイトに一度でWordファイル1点を追加したいです。 こちらは可能でしょうか。もし可能でしたら、手順をご教示いただきたく存じます。 なにとぞ、よろしくお願いいたします。
いつも楽しく勉強させていただいております。 環境はSQLServer2012のExpressでOSはWindowsServer2008です。 Test1というデータベースのバックアップを取ってTest2という名前で復元しようとしましたが、なぜか失敗してしまいます。 どなたか原因を教えていただけませんか。 次の手順でバックアップを取り、復元をしています。 ○バックアップのフェーズ 1.データベースのバックアップのダイアログボックスを開く。 2.ソースにTest1、バックアップの種類に完全を指定する。 3.バックアップ先は以下のファイルに 　C:\Program Files\Microsoft SQL Server\MSSQL11.SQLEXPRESS\MSSQL\Backup\Test1.bak 4.OKをクリックし、「データベース'Test1'のバックアップが正常に完了しました」を確認。 ○復元のフェーズ 5.データベースの復元のダイアログボックスを開く。 6.ソースはデバイスにする。 7.ファイル名に上記3.のファイル名を指定 8.転送先データベースはTest2とする。 9.OKをクリック（ここでエラーとなる）。 エラーメッセージは以下の通りです。 ------------------------------------------ データベース'Test2'の復元に失敗しました。（Microsoft.SqlServer.Mangement.RelationalEngineTasks) 追加情報: System.Data.SqlClient.SQLError:ファイル'C:\Program Files\Microsoft SQL Server\MSSQL11.SQLEXPRESS\MSSQL\DATA\Test1.mdf'に上書きできません。 データベースTest1が使用中です。(Microsoft.SqlServer.SmoExtended) ------------------------------------------ メッセージの内容で引っかかるのはTest1.mdfに上書きできませんというところです。 上書きでなくTest2という新規データベースに書き込みたいのですが。 ためしにTest2というデータベースを作成しておいて「既存のデータベースに上書きする」をチェックしてやってみましたが、やはり失敗。 メッセージは上と同じです。 SQLServerを再起動して試してもやはり結果は同じです。 何が悪いのでしょう。
初めまして。 最近、SQLを学び始めました。 会社で掃除当番表を作成することになったのですが、どのようにしたらいいのかがわかりません。 条件としては、 １．人数は全部で３１人。 ２．１度にランダムに５人ずつ当番になる。 ３．１度当番になると、全員の当番が一巡するまで回ってこない。 ４．SQLServer2012を使用し、プログラミング後はAccessのフォームに出力してフォームで確認可能。 ５．ランダムに選ばれた当番表を履歴テーブルに残す。 の５点になります。 本やネットで調べてみたのですがうまくいきません。 ご教授をお願い致します。
＜環境＞ SQLSERVER 2012 入力フォームに、入力した後で、DBに登録した際に、 依頼Noに、既にあるデータのMAX+100の値を登録したいです。 依頼NoにMAX+100の連番をふることは以下の方法でできたのですが、 ＩNSERT INTO テーブル1(依頼No) SELECT MAX(依頼No)+100 AS NEW_ID FROM テーブル1 入力フォームのデータと登録と同時に、依頼Noを振りたいのですができません。 以下のように書いてみましたが、 根本的に間違っていると思うので、いい方法をご教授いただけたらと思います。 ※iraibi は入力フォームで、依頼日を入力した値です。 INSERT INTO テーブル1 (依頼No,依頼日) VALUES ('SELECT MAX(依頼書No)+100 AS NEW_ID FROM テーブル1','" & iraibi & "') 宜しくお願いいたします。
標題の別サーバーのＤＢへテーブルをコピー（更新）したいと考えておりますが、やり方が全く分かりませんのでお教えください。 【更新元】 販売管理サーバー ＯＳ：Ｗｉｎｄｗｏｓ2008Ｒ２ SQL SERVER 2008R2 サーバー名：POS ＤＢ名：POSDATA テーブル名：POS売上伝票 【更新先】 社内開発用サーバー ＯＳ：Ｗｉｎｄｗｏｓ2008Ｒ２ SQL SERVER 2012Express サーバー名：AD ＤＢ名：ＰＯＳ テーブル名：POS売上伝票 ＰＯＳ上のSQL ManagementStudeoから、ＡＤ上のＳＱＬＳＥＲＶＥＲへのアクセスは可能な状態にしております。 ◎実装したい要件 ＰＯＳサーバー上のデータを、毎日定時にＡＤサーバー上のＤＢに追加更新 ※理想としては、バッチ等のスクリプトをタスクに登録し定時に実行 自分なりに調べてみたのですが、データを丸ごとコピーする場合は、"bcp"コマンドを実行すれば可能なようですが、bcpコマンドで、サーバー間のコピーの方法が良くわかりませんでした。 また、出来れば日々更新する為、データが変更されたレコードはUPDATE追加されたデータは、INSERTする事が理想です。 ※夜間のバッチ処理ですので、上記の方法が私の知識的に難しようであれば、テーブルを作り直ししてもよいと考えております。 効率的な方法をご存じの方がいらっしゃいましたらアドバイスをお願いいたします。
Windows server2012へSQL SERVER2008 R2 EXPRESSをインストールすると、「このプログラムには互換性の問題があります」（2008 and 2008）と表示されます。 色々調べて、Windows Server2012へ.NETFramework3.5はインストールしたのですが、まだ同じメッセージでSQL SERVER2008 R2がインストールできません。 対応策をご存じの方は、教えてください お願いします
SQLサーバー2008を使用しています。 SQL文のwhere句で 直前のアイテムの1回以上の繰り返しを意味するメタ文字を教えてください。 Postgresqlであれば、0回以上だと「*」、1回以上だと「+」だと思うのですが、 SQLサーバーだと何にあたるのでしょうか？ ぐぐって検索してみたのですが、見つかりませんでした。 どうかよろしくお願いいたします。
SQL Server関係初心者です。 教えてください。 今までWindowsXPにMICROSOFT SQL SERVER 2000 DESKTOP ENGINEがインストールが インストールできたのですが、Windows7ではインストールできませんでした。 Windows7は対応していないでしょうか？ それに代わる無償のものはありますでしょうか？ Microsoft SQL Server 2005 Express Edition Service Pack 3がその代わりと なりますでしょうか？ XPの時はいつもインストール後に以下のようなコマンドを実行していました。 setup.exe SECURITYMODE=SQL SQPWD=password MSDEとMicrosoft SQL Server 2005 Express Edition Service Pack 3では全く異なるのでしょうか？ よろしくお願い致します。
Windows8.1上でSQL Server 2008 R2は起動しますか？ 弥生販売14　ネットワークを使用するのにSQL Server 2012ではSQL Server 2000形式のバックアップデータがコンバートできなくて困っているのです。 そこで、SQL Server 2008 R2を介してコンバートを考えています。よろしくお願いします。
SQL　Server で　翌月10日を取得する方法を教えてください。 isnull(convert(char(10),dateadd(month,1,(dateadd(day,9,DATE))),111),'') as DATE ↑これだと、DATE(月末)の翌月の９日後で、翌月10日も可能なのですが、 当然ながら、DATEが月末とは限らないので。。。 常に10日を固定で表示するにはどうしたら、よいのでしょうか？ よろしくお願いいたします。
SQLでORDER BYをして、n番目からm番目を取得したい場合、 どのようにしたらいいのでしょうか？ TOP mで取得してnまでをスルーするしかないのでしょうか？
LEFT OUTER JOIN と TOP10との組み合わせ テーブルAと LEFT OUTER JOIN するテーブルBがあり、 単にLEFT OUTER JOINすると、 レコードA01 レコードB01 レコードA01 レコードB02 レコードA01 レコードB03 のようにレコードBに対し、該当する同じレコードAが複数取得されます。 この状態でTOP10をかけると、テーブルAのTOP10が欲しいのに、 テーブルBも混じった数で取得されてしまいます。 （テーブルAは１０レコード取得できない） これをテーブルAのTOP10を取得して、それにJOINするテーブルBの数は問わない方法は可能でしょうか？
こんにちは。 Microsoftが提供しているPower Povitについて質問です。 このツールを利用するにはMicrosoftSQL2008以上とExcel2010以上が必要なのはわかったのですが それ以外に何かライセンスは必要でしょうか。 勤めている会社でBIツールを提供する可能性が出てきており 何をベースとして使用するか選定しています。 少し調べている限りでは非常にこちらの条件とマッチしているのですが ライセンスなどに触れている記事に当たらなかったのでこちらに投稿させて頂きました。 よろしくお願いします！
SQLServer2012のインストールについての質問です。 SSDで起動しているCドライブにインストールし、DATAフォルダを HDDのDドライブにして運用していたところ、わずか3ヶ月でSSDが 壊れました。 原因はLogフォルダへの書き込み件数だと思われます。 日々、数１０万単位のInsert処理が行われていたため、その都度 Logファイルへの書き込みがあったと想定されます。 CドライブにインストールしたとしてLogファイルをDドライブへ 書き出すように設定変更は可能でしょうか？
SQLServer2012で selectで文字列の末尾から（右から）ある文字の位置までを取り出したいのですが どのようなSQLにすればよいのでしょうか。 やりたいことは、 例えば、文字列「abc 123 xyz」があるとします。 末尾から（右から）見て、最初に見つかった半角スペースから後ろ「xyzを取り出し たいです。 RIGHT を使えば取り出すことはできるのですが、取り出したい文字列の長さが同じ でないので使うことができません。 お願いします。
ご質問事項 文字列の真ん中くらいに"会員番号○○○○○○"があるのですが、SQL文でその部分だけ抽出したい場合、どのようにしたらよいでしょうか？ 状況 文字列の最初から"会員番号"の手前までの文字数が、データによって異なっているケースがあるので、substringで開始位置が定めることが出来ない状況です。 何卒よろしくお願いします。
MS SQL server 2005 express edition をWindows７のパソコンにインストールをしたいです。 必要なインストール物、必要な環境条件など分からない素人です。 教えていただけないでしょうか。 以下の２つで宜しいのでしょうか？ Microsoft SQL Server 2005 Express Edition Service Pack 3 Microsoft SQL Server Management Studio Express Service Pack 3 .NETFrameworkのバージョンやWindow7の更新プログラムやサービスパックなどは どのような環境であれば宜しいのでしょうか？ すみません。よろしくお願い致します。
はじめまして Windows Server 2008 SQL SERVER 2008 R2 IIS7.0 Microsoft Visual Web Developer 2010VB の環境で動作させています。 一台のサーバーマシンに、SQL SERVER 2008R2,IIS7.0をインストールした状態なのですが、Webページ上のMicrosoft Visual Web Developer 2010VBのプログラム（新しいwebページのデフォルト）によりログインページにてデーターベースをアクセスすると CREATE DATABASE 権限がデータベース 'master' で拒否されました。 と、メッセージが出ます。 Microsoft Visual Web Developer 2010のデバッグでは実行できるのですが、 OS,データーベースの動作環境の設定がうまくできていないのでしょうか？ 当方サーバーの設定およびデータベースの知識がないため、今回のことに対して掲示する情報がわかっていません。 この情報がほしいなどありましたら教えてください。 また現在の目標はMicrosoft Visual Web Developer 2010のwebページ新規作成にて構築されるデフォルトのwebページを動作させることです。 お願いいたします。
お世話になります。 マイクロソフトのSQL Server2005 Express、SQL Server2008 R2 についての質問です。 職場の私のＰＣ（Windows7 Pro 64bit版）には各種開発ツール、ＤＢがインストールされています。 VS2005をインストールした時にSQL Server2005 Express（？）もインストールされたようです。 社内のＤＢサーバー機のSQL Server2008 R2 に接続するために製品版のSQL Server2008 R2の クライアントツール（Management Studioなど）もインストール済みです。 私のPCにSQL Server2008 R2 Expressをインストールしたいのですがどうすればよいでしょうか？ （可能なのかどうか？　導入手順は？） すでにSQL Server2005 Express や 製品版のSQL Server2008 R2（クライアントツール）が インストール済みですのでそれらとバッティングしないかと気になっています。 やりたい事は、スタンドアロン環境でＤＢを動かしストアドプロシージャのテストなどの実施です。 ※SQL Server2008 R2 の環境からバックアップを取ったDBを復元する必要があるので 　SQL Server2008 R2 Express以降のバージョンが必要です。 ご教授よろしくお願いいたします。
SQL Server 2008R2/2012でのVIEWのアクセス権限の付与について パケージのシステムを構築しており、ユーザにVIEWの読み取り権限だけを公開したいと考えています。 ユーザは、SQL Server Management StudioでそのVIEWに対してSELECTだけできるようにしたいのですが、やってみるとVIEWに対しての権限の他に元となるテーブルのアクセス権限も必要となり、見せたくないテーブルとそのテーブルの列が見えてしまいます。 なんとか、DBへの特定のログインユーザだけVIEWに対して読み取り（SELECT）ができようなユーザが作れないでしょうか？ アドバイスをお願いします。
お世話になっております ・サーバ：Windows2008R2＋SQLServer2012 ・クライアント：Windows7 上記環境にて、クライアントのＳＳＭＳ上で、 あるストアドプロシジャを実行すると丁度２分程かかります。 （これをスピードアップさせるのが目的です） 　exec hoge para1,para2 同じく、SSMSで「新しいクエリ」を作成して、 そのストアドプロシジャの実行部分だけを 貼り付け、パラメタだけを指定して実行すると４秒で終わります。 　declare @para1 smallint 　declare @para2 smallint 　set @para1 = 1 　set @para2 = 2 　（以下ストアド内のＳＱＬを貼り付け） 「SET ARITHABORT ON」を付加しても 全く変化がありませんでした。 なぜこのような事が起こるのか、見当がつかず、困り果てています。 対応方法等ご存じの方がいらっしゃいましたら お知恵を拝借したく、よろしくお願いいたします。
SQLで重複を除去したいのですが、DISTINCTやGROUP BYも検討したのですが、どうしても良い方法が見つからなかったので質問させて頂きます。 テーブルの構成は以下のようになっています。 roomsテーブル id(INTEGER) public(BOOLEAN) updated_at(DATETIME) created_at(DATETIME) messagesテーブル id(INTEGER) sendfrom_list_id(INTEGER) sendto_list_id(INTEGER) room_id(INTEGER)※roomsテーブルへの外部キー body(STRING) updated_at(DATETIME) created_at(DATETIME) 更に条件は以下のようになっています。 ・アウトプットとして得たいのは rooms.updated_at rooms.id rooms.public messages.room_id messages.sendfrom_list_id messages.sendto_list_id messagess.body の7カラム。 ・rooms.publicがTRUEである ・messages.room_id = rooms.idであること ・updated_atでDESCにソート このような条件を満たすSQL文は以下のように書くことができました。 SELECT R.updated_at, R.id, R.public, M.room_id, M.sendfrom_list_id, M.sendto_list_id, M.body FROM messages AS M, rooms AS R WHERE R.public = "t" AND M.room_id = R.id ORDER BY R.updated_at DESC; しかし、ここに更に「rooms.idが重複しないもののみ抽出」という条件を加えたいのですが、どうしてもうまく行きません。 DISTINCTでは複数の中から一部のカラムだけをDISTINCTすることはできないようですし、GROUP BYも考えましたがどうやれば良いかわかりませんでした。 どなたか良い方法を教えて下さい。
文字列変数の連結について質問いたします。 通常以下の場合、結果は望んだとおりになります。 ----------------------------------------------- SET @会社=N'A社' SET @別会社=N'B社' SET @結果=@会社+'、"+@別会社 SELECT @結果 ’A社、B社' ---------------------------------------------- 以下のように記述にして,複数会社名を連結させる目的で FETCHを使用して変数に値を格納しようとしていますが 結果NULLが返されるのはなぜでしょうか。 ---------------------------------------------- DECLARE myCursor CURSOR FOR SELECT 会社名　FROM 会社マスター OPEN myCursor FETCH NEXT FROM myCursor INTO @会社名 WHILE @@FETCH_STATUS=0 BEGIN 　　　　@結果＝@結果＋@会社名 　　　FETCH NEXT FROM myCursor 　　　INTO @会社名 END CLOSE　myCursor DEALLOCATE myCursor SELECT @結果
初めまして。 稼働中のシステム保守において問題が発生しています。 早急に解決したいのでお力をお借りしたいです。 稼働中サーバー（SQL-Server２００８）にてトランザクションログが肥大化しております。この手の問題はネットで検索すると解決方法が出ているので実行してみました。 まずは…ログファイルの圧縮。 ManagementStudioより操作をGUIで行いましたが、処理自体が一瞬で完了してしまいLDFファイルを見ても圧縮前と何も変わっておりません。 続いて…ログファイルのバックアップ バックアップすることでログファイルの切り捨てができるとの事で、同様にManagementStudioよりバックアップを実行してみました。かなり処理に時間が掛かるようでしたが、30分程待ったところ（進捗20％）でエラーが発生し、空き容量が足りないのでバックアップに失敗したようです。 160GB程残っていますが、これでも容量不足とは…。 上記のような事態に陥った場合にどうするのが賢明でしょうか？ ちなみに通常はメンテナンスプランにより、１日１回完全バックアップを取って保存しています。 ログファイル自体はバックアップを取っていませんでした。（必要性が理解できなかったもので…） 稼働中システムに問題が発生した場合は基本的には前日のデータに戻すような対応をする契約ですので、復元時点は厳密にN時間前等を指定する必要性がない為、ログファイル自体はあまり必要ではないという認識で良いのでしょうか？ また今後、定期的にログファイルのバックアップを取るにしても、ログファイルのバックアップ容量が大きい為、Nヶ月分残すような運用をする場合、従来のデータバックアップに加えてログファイルのバックアップが加算され200GB程度のHDDでは追いつかないのですが、ログファイルのバックアップは上書きしていき、データの完全バックアップのみNヶ月分残すというような運用でも問題なく復元できるのでしょうか？ 以上、３点質問してしまいましたが、どなたかご回答していただけると幸いです。 よろしくお願い致します。
sqlserver（2008R2）についてクエリ文が上手く書けません。 お手数をおかけいたしますが、お分かりになる方はご教授いただければと 思います。 まず、元となるテーブルおよび作成したい完成系は添付ファイルをご確認下さい。 personal_id、personal_name、personal_address、personal_tel、personal_date列を 持つテーブル(personal_table)から 「select * into #table01 personal_table」に よって一時テーブル#table01を作成し、personal_name・address・telがnullの場合に、 personal_dateが直前時におけるnull以外の値をセットしたいと思っています。 （ただし、セットするのはpersonal_id毎で、最もpersonal_dateが若い者には 必ずpersonal_name・address・telが入っているものとします）。 なお、以下は私が作成したクエリになります。　項目1つずつっと思い、 とりあえずpersonal_nameをpersona_idおよびpersonal_dateを用いて updateしようと思ったのですが、personal_nameがすべてnullになってしまいました。 --------------------------- select * into #table01 from personal_table update #table01 set personal_name = (select personal_name from #table01 A where #table01.personal_id = A.personal_id AND #table01.personal_date = (select MAX(A.personal_date) from #table01 A where #table01.personal_date > A.personal_date AND #table01.personal_id = A.personal_id)) SELECT * from #table01 --------------------------- 完成系を作成するにあたってどのようなクエリを書けばよろしいのか、 ご教授いただければと思います。
以下の.net関数を使用して、Select文を作成し SqlServerからデータを抽出しています。 http://msdn.microsoft.com/ja-jp/library/zxkb3c3d(v=vs.110).aspx http://msdn.microsoft.com/ja-jp/library/system.d …(v=vs.110).aspx 条件を変え二つのSelect文を作成したところ、 後者だけが極端に遅延しタイムアウトしてしまいます。 (1)Select ID From TestView Where ID = 0　※ID列はint型 (2)Select ID From TestView Where ID = 1　※ID列はint型 Select対象となるデータ数（TestView）はかなりの量がありますが、 ID = 0、ID = 1 によって抽出されるデータ自体はどちらも10件程度です。 なぜID = 0ではすぐに抽出でき、ID = 1では遅延するのか全く原因がわかりません。 私自身も色々と確認をしているのですが、 過去の経験則や、ここを確認すると良いなど 調べるための情報がありましたらご提供頂けませんでしょうか？ 宜しくお願い致します。
SQL Sever 2005 を利用しております。５つのテーブルから値を取得するSQL文を作成したいと考えております。３つまでのテーブルのFULL OUTER JOIN は例がるのですがそれ以上となると調べても判りませんでした。ご教授お願い致します。 TABLE1～TABLE2は同じ構成で発生した５つのテーブルを１つのテーブルに合体して データどれか１つのテーブルで発生すれば表示したい。 出来れば現在作成中のSQL文がFULL OUTER JOINで作成しているのでこれを流用したいので FULL OUTER JOIN の方法で教えて頂ければ幸いです。 以上よろしくお願い致します。 (※IDが主キー) テーブル名：TABLE1 ID-----金額 ----------- 01-----1000 11-----2000 テーブル名：TABLE2 ID-----金額 ----------- 02-----2000 12-----3000 テーブル名：TABLE3 ID-----金額 ----------- 03-----3000 テーブル名：TABLE4 ID-----金額 ----------- 02-----1000 04-----4000 テーブル名：TABLE5 ID-----金額 ----------- 01-----1000 05-----5000 作成したいSQL文の結果 ID-----TABLE1金額---TABLE2金額---TABLE3金額---TABLE4金額---TABLE5金額 01-----------1000----------------------------------------------------1000 02-------------------------2000------------------------1000 03----------------------------------------3000 04-----------------------------------------------------4000 05-------------------------------------------------------------------5000 11-----------2000 12-------------------------3000
macでsqlite3でcsvのインポートができません。 in.txt -------- 1,りんご,赤色 2,みかん,黄色 ターミナル上で sqlite> .separator , sqlite> .import in.txt tbl1 といった具合にやると、改行が認識されないのか、 expected 2 columns of data but found 4 といったエラーがでます。 対処法を教えてください(><)
SQLServer 2005にて文字列型に入っている日付データの変換を行いたいと思っています。 現状yyyy/M/d（2010/1/1）のようになっているのをyyyy/MM/dd(2010/01/01)に変換したい のですが方法が分かりません。 SELECT CONVERT(DATETIME,(CONVERT(VARCHAR(10),テーブルの値)),120) FROM テーブル名 とするとCHAR データ型から DATETIME データ型への変換の結果が日付/時刻の値の範囲外です。 というエラーになっていまいます。どういった方法なら実現できるのでしょうか。 すみませんがご教授ください。 宜しくお願い致します。
SQLServer2008R2を使用しています。 次のようなテーブルAがあります。 ID　Code1　Code2　Code3　Val1　Val2　Val3 -------------------------------------- １　　A1　　　　　　　　　　　　　１ ２　　A1　　　Z1　　　　　　　　 ２　　　１ ３　　B1　　　A1　　　　　　　　 １　　　１ この時、Code1～３にあるA1に該当するVal1～3の合計をそれぞれ取得したいのですが、SQL文の書き方がわかりません。 SELECT Sum(Val1), Sum(val2), Sum(Val3) FROM A WHERE Code1='A1' OR Code2='A1' OR Code3='A1' のようなSELECT文では、B1・Z1の数も合計してしまいます。 B1・Z1の数が含まれないようなSQL文は、どのように記述したらよいでしょうか？ どなたか有識者の方いらっしゃいましたら、宜しくお願い致します！
SQLSERVER2008にてフルテキストインデックス検索であるカラムを検索しています。 例 naiyouというカラムに関してレコードとして、 「始まり 私は人間です。 第二章 私はさるです。 終わり」 という文章が１レコード入っているとします。 この場合、仮にcontains (naiyou,'人間')と検索するともちろんこのレコードがHITします。 今回やりたいのは、 ・naiyou内の第二章以降の文章で「人間」と検索した場合、ノーヒットとなること ・naiyou内の始まり～第二章までの間で「人間」という検索をして、HITすること という、カラム内のある文字間でのCONTAINS　検索というのは可能でしょうか、そしてそのSQLはどのようにかけばいいのでしょうか？というご質問です。 NEARとかでできるのかと思い、いろいろやってみましたがうまくいきませんでした。 なぜこのようにしたいかというと、いま処理している文章の冒頭がすべて同じ文面になっており、文面内の単語で検索されてしまうと全件HITしてしまうからです。 本来なら、その冒頭を除いた文章で単語をHITさせたいため、範囲指定を考えました。 ご教授いただければ幸いです。
SQLでSELECT文を使う場合、大抵 　SELECT ID, user FROM u_table のように、取得する項目を指定すると思います。 これを、 　SELECT ＊ FROM u_table としないのには、トラフィックの問題以外に何か理由があるのでしょうか？
COBOL上（NETExepress5.0）にSQL構文を埋め込んでプログラムを作っています。 DELETE文を発行して、そのDELETE件数を取得して、DISPLAY文に表示したいのですが、 どのようにすればよいでしょうか。 DELETE文（COBOL文中） 例） 　EXEC　SQL　DELETE　FROM　テーブル名 　END-EXEC 先にSELECT　COUNT（*)　FROM　テーブル名 とかしてもかまわないです。 よろしくお願いします。
SQLServser2012で縦持ちになっているデータを横持ちにしたいのですが、どうしたらよいでしょうか？ 〇以下のように現在、テーブル設計されております。 請求TBL --------------------------------------------- 請求ID 請求先名 001 田中 太郎 002 鈴木 一郎 注文TBL ------------------------------------------------ 請求ID 注文ID 発送先 商品ID 個数 001 001 田中 太郎 A 10 001 002 佐藤 次郎 A 5 002 003 鈴木 一郎 B 3 商品TBL ----------------------------- 商品ID 商品名 A みかん B りんご このデータを以下のような結果として得たいのですが、どのようにしたらSQLを作成したらよろしいでしょうか？ 請求ID 請求先 商品内容 ------------------------------------------------- 001 田中 太郎 みかん*10、みかん*5 002 鈴木 一郎 りんご*3 ご教授の程、宜しくお願い致します。
以下のEx1,2のJOIN句の記述方法の違いはクエリのパフォーマンスに影響するのでしょうか？ 2万件程度のデータ量で試してみたのですが明確なパフォーマンスの違いを確認できませんでした。(1秒～2秒) 単純に書き方だけの違いであれば心置きなく自分ではわかりやすいと感じているEx1の記述方法で統一したいので。 よろしくお願いします。 -- /* SQL Server 2008 R2 */ -- /* 受注した全ての商品名を取得するクエリ(例) */ -- /* 登場テーブル・カラム */ -- // M_goods 商品マスタ -- // code 商品コード -- // name 商品名 -- // T_orders 受注テーブル -- // number 受注番号 -- // T_orderdetails 受注明細テーブル -- Ex.1 SELECT M_goods.name FROM T_orders LEFT JOIN T_orderdetails ON T_orders.number = T_orderdetails.number LEFT JOIN M_goods ON T_orderdetails.code = M_goods.code -- Ex.2 SELECT M_goods.name FROM T_orders LEFT JOIN T_orderdetails LEFT JOIN M_goods ON T_orderdetails.code = M_goods.code ON T_orders.number = T_orderdetails.number
SQL Server2008でパフォーマンスの悪いSQLなどを調べようと思い、 以下のような説明を参考にしています。 http://msdn.microsoft.com/ja-jp/magazine/cc13597 … http://msdn.microsoft.com/ja-jp/library/ms189741 … しかし、エラーが出て実行できません。 SQL文から抜粋しますと、以下の様なエラーが発生ます。 　・THEN LEN(CONVERT(nvarchar(max), qt.text)) * 2 　　　→'max' の近くに無効な構文があります。 　・CROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) AS qt 　　　→'APPLY' の近くに無効な構文があります。 　・SELECT qs.execution_count 　　FROM sys.dm_exec_query_stats AS qs 　　　→'sys.dm_exec_query_stats' は無効です。 調べても何が悪いのかわからず困っています。 何がいけないのかご教授いただけませんでしょうか。 よろしくお願い致します。
5年間くらいの期間で、毎年300万件くらいのデータを統合して管理しようとしております。 こういった時どんなソフトを使うのがいいか教えてください。 「Microsoft SQL Server 2008 Developer Edition」というのが出てきて検索してみましたが、アクセスに比べかなり敷居が高いように思いました。 （アクセスでは2Gは軽く超えます）
SQLServerでGROUP　BYを使用してデータをSELECTする場合について質問があります。 GROUP　BYを行う項目に’△△1’と’1△’というデータが入っていた場合、 　　※上記の△は半角スペースです。 ’△△1’と’1△’は同じグループとして、グルーピングされるのでしょうか。 Oracleにデータを移行して、GROUP　BYをかけると上記のケースはデータ件数が異なります。 これはSQLServerの仕様なのでしょうか。（バージョンは2000です。） お手数ですが、ご教示願います。　
標記の件なのですが弊社ではデ－タ－ベ－スにＳＱＬを使用しております。 今は新しい販売管理システム構築に向けて複数のソフト開発会社様と話し をしておりだいたい概算の見積りが出揃いまして、基本的にはACCESS+SQLServer でとなっているのですが１社だけ極端に安い見積りがあるなって思ったら 無料版のexpressになっておりました。 零細企業でサ－バー１台にクライアントＰＣが８台だけの構成なのですが 無料版でも大丈夫な物でしょうか？勿論無料版には容量の制限等あるのは 存じております。また、販売管理システムですので大きなファイルは無いとは 思いますのでそれで無料版を使用しようとされているではないかと思っており ます。 是非、皆様にアドバイスをして頂きたく質問させて頂きました。 宜しくお願い致します。
先日、バックアップが戻せないと質問させていただいたものです。 今回新たにデータベースを作って、試しにバックアップをやってみたのですが、何故か*.bakと*.trnのファイルが出来ません。その代り、拡張子無しのデータベース名ファイルが一つ出来ております。 手順は、オブジェクトエクスプローラーで当該データベースを右クリックして、「タスク」→「バックアップ」を選び、完全バックアップ、デフォルトのBackUpディレクトリの指定を削除して、デバイス→USBメモリのファイル名指定(新規)、有効期限0日、にて行いました。 何かを決定的に理解していないのだと思いますが、分かりません。 なぜ、うまくいかないのか、お教えいただけないでしょうか？ ひょっとして、EXPRESSではダメという事があるのでしょうか？
SQL Server2012 Expressで作成したデータベースをＵＳＢメモリにバックアップしました。 最近、マシントラブルでドライブが死んだので、ＳＱＬ Serverも入れ直し、データベースをリストアしようとしましたが、うまくできません。 具体的には、データベースを右クリックして「タスク」→「復元」→「データベース」として、デバイスを選ぼうとすると、バックアップファイルの拡張子がbakとtrnとなっており、USBメモリに記録されているmdfとｌｄｆではありません。 すべてのファイルを表示させ、それらを選択しても、データベースの復元ダイアログのOKボタンがグレーアウトのままです。 「タスク」→「復元」→「ファイルおよびファイルグループ」なのかな？と思って、やってみてもやはり、拡張子が違います。 同じようにmdfとldfを選択してみると、 「デバイス'データベース名.mdf'のメディアファミリが正しい形式ではありません」 「RESTORE HEADERONLYが異常終了しています。(エラー：3241)」 とのダイアログが出て復元できません。 私はバックアップを失敗したのでしょうか？ 何とか、一部のデータでも復元できないでしょうか？ よろしくお願いいたします。
お世話になります。 これまで、社内ネットワークで SQL Server + Access ADPでプログラムを作成していましたが、データだけをレンタルサーバなどに移行し、インターネット経由でデスクトップのPCとやり取りするにはどうしたらいいのでしょうか。（クライアントは、ASP.NETなどを経由してWEBブラウザを利用するのではなく、直接AccessやVBで通信して利用したいと考えています） サーバの設定や接続文字列の書き方など、必要な情報（必要な資料がのっているサイトなど）をご教示いただければ助かります。 よろしくお願いいたします。
こんにちは。 あるテーブル"T_A"が有り、 そのテーブルにカラム"C1"、"C2"が有ります。 テーブル"T_A"にレコードが以下の用に登録されていると仮定します。 C1|C2 ----- AA|S AA|P BB|R BB|S CC|S ※C2に登録されている値は抽出する優先順位が有り、 R:1 P:2 S:3 Rが一番優先順位が高く、Sが優先順位が最も低いです。 この条件から、C1の値が同じレコードに対して、C2の優先順位が 最も高いレコードを抽出したいです。 欲しい結果↓ C1|C2 ----- AA|P BB|R CC|S
SQL SERVERの BULK INSERTについて。 TESTというテーブルにtest.csvをBULK INSERTによりデータをインポートしようとしているのですが変数を使わずに下記のように書くと正常に動くのですが、 BULK INSERT TEST FROM 'C:\data\test.csv' WITH ( FIELDTERMINATOR = ',', ROWTERMINATOR = '\n' ) 変数を使って下記のようにすると「不適切な構文があります。」とエラーとなってしまいます。 DECLARE @data varchar(100) SET @data = 'C:\data\test.csv' BULK INSERT TEST FROM @data WITH ( FIELDTERMINATOR = ',', ROWTERMINATOR = '\n' ) 解決策を教えてください。
受注T ---------------- 製品CD　　得意先CD　　数量　　単価　　受注日 0001　　2001　　500　　3000　　2013/7/5 0002　　2002　　1000　　NULL　　2013/9/25 0003　　2003　　1800　　NULL　　2013/9/25 単価M ---------------- 製品CD　　得意先CD　　数量FROM　　数量TO　　単価　　適用日 0001　　2001　　0　　99999　　3000　　2013/5/1 0002　　2002　　0　　　　500　　　800　　2013/5/1 0002　　2002　　501　　999999　　500　　2013/5/1 0003　　2003　　0　　　500　　　　2000　　2013/1/1 0003　　2003　　501　　999999　　1800　　　2013/1/1 0003　　2003　　0　　　500　　　　2500　　2013/9/20 というデータがあります。 受注Tの単価部分にデータがあるものとないものがあります。 受注時に単価Mから照合して単価を入れるのですが、受注時にまだ単価Mにない場合はNULLが 入っています。 そこで後日VIEWとして単価照合Vを作りたいです。 単価照合Vを作ったときにも単価MになければNULLのままでOKです。 て単価照合V ---------------- 製品CD　　得意先CD　　数量　　単価　　受注日 0001　　2001　　500　　3000　　2013/9/27 0002　　2002　　1000　　500　　2013/9/25 0003　　2003　　2000　　1800　　2013/9/25 ※2013/9/20に単価更新がありますが条件数量は0-500なので2013/1/1が適用 こんな感じです。 わからないのは受注数量、受注日と単価Mの照合です。 サブクエリを使えばSQLで１行に書けるのでしょうか？ お願いします。
教えてください。 SQL Server2005 Express EditionはWindows7に対応していますでしょうか？ ServicePackは？？以上ということはありますでしょうか？ 対応表等あれば教えていただけますでしょうか？ もし対応していたとしても新しいExpress Editionに変えた方が良いでしょうか？ (現在WindowsXP上で使用しています。) よろしくお願い致します。
Accessで書かれたクエリをSqlサーバーのクエリに変換したいと考えているのですが そのクエリは膨大な行数ある上にIIF関数やSwitch関数がそこら中に含まれており、一つ一つ置換していられません。 もしどなたかIIF関数などのAccessのクエリをSqlサーバーのクエリへ変換してくれるソフトをご存知の方いらっしゃいましたら教えていただければ幸いです。 よろしくお願いいたします。 ◆バージョン SQL Server:SQL Server 2008 R2 ACCESS:ACCESS2000 OS:Windows7
お世話になります。 Where句のCase文でお尋ねしたいことがあります。 ----------------------------------------------------- WHERE (A = @A) AND (B = @B) AND (C = @C) AND CASE WHEN @D = 0 THEN (dbo.TEST.D = dbo.TEST.D) '全データを WHEN @D = 1 THEN (dbo.TEST.D = 1) '値が1のデータを WHEN @D = 2 THEN (dbo.TEST.D = Is Null) 'データがNull のものを END AND (E = @E) AND (F = @F) AND (G = @G) AND (H = @H) AND CASE WHEN @I = 0 THEN (dbo.TEST.I = dbo.TEST.I) WHEN @I = 1 THEN (dbo.TEST.I = 1) WHEN @I = 2 THEN (dbo.TEST.I = Is Null) END AND (J = @J) ........ ........ ----------------------------------------------------- 上記のように CASE 文で　パラメータの値により条件を変えたいのですが、なかなかうまくいきません。こんな記述の仕方ではダメということは薄々わかっているのですが、このようなCASE文をうまく動作させるにはどのように記述すればいいでしょうか？ よろしくお願いいたします。
Windows7 環境で SQL Server 2008 Express を インストールしたのですが、saでログインできませんでした。 インストール時の認証モードには「混合モード」を選択しました。 自分なりに調べた結果、 『windows認証でログイン後、［オブジェクトエクスプローラ］の ［セキュリティ］－［ログイン］より「sa」アカウントを選択して［プロパティ］を開き、 「sa」のログインを「有効にする」』 とあったので試したところ、「エラー：15151」が発生し、変更できませんでした。 関係ないかもしれませんが、 「BUILTIN\Users」に「sysadmin」ロールを付与しようとしても、 「エラー：15247」でできませんでした。 どうすれば『「sa」のログインを「有効にする」』ことができるのでしょうか。 どなたか、ご教示宜しくお願いいたします。
パススルークエリーを使ってAccess 2007 から SQL Server 2008 上のデーターに追加したいのですが、パススルークエリーが読取り専用のため何もできません。パススルークエリーは、Microsoft のサポートにあるとおりに作成しました。SQL欄には Select * from T_Data　とのみ記述しただけですので、このクエリ (Q_Data)　はSQLServer にあるテーブルのすべてを表示しています。 以下のように記述しましたが、何ともなりません。 Private Sub cmd_追加_Click() Dim db As DAO.Database Dim rs As DAO.Recordset Set db = CurrentDb() Set rs = db.OpenRecordset("Q_Data", dbOpenDynaset) rs.AddNew rs!カテゴリー = Me!txt_カテゴリー rs!商品名 = Me!txt_商品名 rs.Update MsgBox ("追加しました") rs.Close: Set rs = Nothing cn.Close: Set cn = Nothing End Sub この場合のQ_Dataには加工ができないのでしょうか？　追加、更新ごとにパススルーを新たに作成する必要があるのでしょうか？　ご指導をお待ちしております。
SQLのSelect文である期間を日別に出力したいのですが、どのようにすればいいのでしょうか テーブルのデータは期間全部が入っているのではなく。 データが存在しない日もあります。 データが存在しない日は日にちをのぞいて空白になるようにしたいです。 例として、 テーブル上のデータ 2013-08-01　　ああああ 2013-08-03　　いいいい 2013-08-06　　うううう 出力したいデータ　期間2013-08-01～2013-08-10 2013-08-01　　ああああ 2013-08-02 2013-08-03　　いいいい 2013-08-04 2013-08-05 2013-08-06　　うううう 2013-08-07 2013-08-08 2013-08-09 2013-08-10 上記のような形で出力したいのですが、 どのようにすればいいのでしょうか http://bitstar.jp/blog/?p=2468 のように別のテーブルを用意する以外のやり方でお願いします。 よろしくお願いいたします。
宜しくお願い致します。 本社（大阪：50名）、拠点（兵庫：30名）、拠点（東京：20名）で ベストエフォート１００ＭのＩＰ－ＶＰＮを使用しております。 受注管理システムはSQL Server2005とVB.NETの構成で SQL Serverは本社（大阪）にあります。 パッケージではなく自社向けに委託開発したものです。 この状態で業務システムを利用するにあたり 各拠点（兵庫、東京）での受注管理システムのレスポンスが本社（大阪）とを比較するとかなり遅いという不具合報告が挙がりました。 処理によって違いはありますが 本社で数秒の処理が拠点では数十秒（倍以上）かかるとのことでした。 （顧客検索や受注登録に本社で処理するより時間がかかる） このため、対策としてネットワークを太く安定するようにしようという案が出ました。 ＶＰＮをベストエフォートではなくギャランティ（本社１００Ｍ、拠点５０Ｍ）に変更する改善案です。 しかしながら打合せが進むにつれ、 ＶＰＮの改善だけでは期待する効果（本社並のレスポンス）は約束できないという話になってきました。 効果は出ると思うがLANで使用するレスポンスは保障できない。 理由としてSQLがWAN越えに対応していないためとＶＰＮの業者さんは言っています。 （SQLは、WAN越えの場合に遅延し易いとのこと。やってみないとわからないとＶＰＮ業者さん） そんな中、現状のシステムのレスポンスを改善するにはＶＰＮの変更と併せて 下記1～4の改善候補が挙がっています。 1.業務システムをターミナルサーバーにより運用する （良いと思いますが費用が高そうです。また現状の業務システムをそのまま使用できるかが気になります。業務システムに手を加えなくても対応可能だとうれしい。効果が確実なら候補として検討したい） 2.Ｗｅｂ系のシステムに業務システムをリプレースする （良いと思いますが、VB.netのシステムをASP.net等で開発し直さないといけなくなる。効果が確実なら候補として検討したい） 3.メタフレーム 1と同じようなシステムでしょうか？ 4.SQL Serverを各拠点に立て、ミラーリングする （マスタや採番は一元化管理が必要です。データの整合性を保つのが困難な印象で、 4より1か2か3の方が良いシステム構成かと思います） 1～3はたくさんのデータにアクセスするよりも、 データを持っているサーバーで処理させて画面を飛ばした方が効果的という考え方かと思います。 大きな企業さんは1～3が多いと思いますが、お付き合いが無くわかりません。 （現状システムを２年前に開発してくれた委託開発先のベンダーさんも相談しましたが、今回のような課題解決の実績は無く、目標とするレスポンスを実現する提案をいただくことは難しいとのこと。 現状システム構築時はWAN越えでの拠点使用もできるようにはしていたがレスポンスまでは深く考えられていなかったようです。ＤＢ一元化の効果はあるので統合前に戻すことは考えていません） 長くなりすみません。 質問ですが、弊社のようなＶＰＮ越しの拠点間の運用で 各拠点のレスポンスを本社と同等に早くしたい場合には どのような課題解決が良いでしょうか？ 弊社にマッチする具体的な改善案とそれにかかるおおまかな費用感、難易度も併せて教えて頂けるとありがたいです。 宜しくお願い致します。
SQL初心者です。 教えてください。 A表とB表があります。 A表の伝票Noの列の値とB表の伝票Noの列の値はイコールです。 判定はB表のある別のカラム(sample)と変数Zに格納されている値がイコールという 条件で合致するA表のデータを抽出したいです。 LEFT JOINもしくはINNER JOINなどを使って書けば良いのでしょうか？ 例えば SELECT * from A表 INNERJOIN B表 on A表.伝票No = B表.伝票No where B表.sample = 変数Z などと書けば良いのでしょうか？
教えてください。 MSSQLサーバーのテーブルで最新でInsertした直後に、そのレコードを削除して、 再度Insertした時のIDENTITY列の値はその前にInsertした時に使用された値が 再度使われるのでしょうか？ それとも、一度使われた値は次回以降使わないのでしょうか？ SQLサーバの管理画面にどちらかを選択できる設定があるのでしょうか？ よろしくお願いします。
win764bitです。 SQLサーバー２００８をインストールしようとすると、 **************************************************** アプリケーションのコンポーネントで、 ハンドルされていない例外が発生しました。 続行をクリックすると、アプリケーションはこのエラーを無視し、 続行しようとします。 終了をクリックすると、アプリケーションは直ちに終了します。 ************** 例外テキスト ************** System.Configuration.ConfigurationErrorsException: userSettings/Microsoft.SqlServer.Configuration.LandingPage.Properties.Settings のための構成セクション ハンドラを作成中にエラーが発生しました。: ファイルまたはアセンブリ 'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'、またはその依存関係の 1 つが読み込めませんでした。指定されたファイルが見つかりません。 (C:\Users\1\AppData\Local\Microsoft_Corporation\LandingPage.exe_StrongName_ryspccglaxmt4nhllj5z3thycltsvyyx\10.0.0.0\user.config line 5) ---> System.IO.FileNotFoundException: ファイルまたはアセンブリ 'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'、またはその依存関係の 1 つが読み込めませんでした。指定されたファイルが見つかりません。 ファイル名 'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' です。 場所 System.Configuration.TypeUtil.GetTypeWithReflectionPermission(IInternalConfigHost host, String typeString, Boolean throwOnError) 場所 System.Configuration.RuntimeConfigurationRecord.RuntimeConfigurationFactory.Init(RuntimeConfigurationRecord configRecord, FactoryRecord factoryRecord) 場所 System.Configuration.RuntimeConfigurationRecord.RuntimeConfigurationFactory.InitWithRestrictedPermissions(RuntimeConfigurationRecord configRecord, FactoryRecord factoryRecord) 場所 System.Configuration.RuntimeConfigurationRecord.CreateSectionFactory(FactoryRecord factoryRecord) 場所 System.Configuration.BaseConfigurationRecord.FindAndEnsureFactoryRecord(String configKey, Boolean& isRootDeclaredHere) 警告: アセンブリ バインドのログ記録がオフにされています。 アセンブリ バインドのエラー ログを有効にするには、レジストリ値 [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) を 1 に設定してください。 注意: アセンブリ バインドのエラー ログに関連するパフォーマンス ペナルティがあります。 この機能をオフにするには、レジストリ値 [HKLM\Software\Microsoft\Fusion!EnableLog] を削除します。 --- 内部例外スタック トレースの終わり --- 場所 System.Configuration.BaseConfigurationRecord.FindAndEnsureFactoryRecord(String configKey, Boolean& isRootDeclaredHere) 場所 System.Configuration.BaseConfigurationRecord.GetSectionRecursive(String configKey, Boolean getLkg, Boolean checkPermission, Boolean getRuntimeObject, Boolean requestIsHere, Object& result, Object& resultRuntimeObject) 場所 System.Configuration.BaseConfigurationRecord.GetSection(String configKey) 場所 System.Configuration.ClientConfigurationSystem.System.Configuration.Internal.IInternalConfigSystem.GetSection(String sectionName) 場所 System.Configuration.ConfigurationManager.GetSection(String sectionName) 場所 System.Configuration.ClientSettingsStore.ReadSettings(String sectionName, Boolean isUserScoped) 場所 System.Configuration.LocalFileSettingsProvider.GetPropertyValues(SettingsContext context, SettingsPropertyCollection properties) 場所 System.Configuration.SettingsBase.GetPropertiesFromProvider(SettingsProvider provider) 場所 System.Configuration.SettingsBase.GetPropertyValueByName(String propertyName) 場所 System.Configuration.SettingsBase.get_Item(String propertyName) 場所 System.Configuration.ApplicationSettingsBase.GetPropertyValue(String propertyName) 場所 System.Configuration.ApplicationSettingsBase.get_Item(String propertyName) 場所 Microsoft.SqlServer.Configuration.LandingPage.LandingPageForm.OnLoad(EventArgs e) 場所 System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible) 場所 System.Windows.Forms.Control.CreateControl() 場所 System.Windows.Forms.Control.WmShowWindow(Message& m) 場所 System.Windows.Forms.Control.WndProc(Message& m) 場所 System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) 場所 System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) **************************************************** と言うエラーが表示されます。 続行してインストールしようとすると、最終的にエラーになり インストールできません。 Microsoft.NET　Frameworkは4と4.5しかインストールされてない状態です。 SQLServer2008SP1-KB968369-IA64-JPN.exe SQLManagementStudio_x64_JPN.exe SQLEXPR_x64_JPN.exe これら全部同じエラーが出ます。
win764bitにMicrosoft SQL Server 2008をインストールしたいです。 現在は SQL Server インストール センター (64 ビット) がインストールされている状態です。 SQL Server インストール センター (64 ビット)をクリックし、 インストール センターを開き、 「SQL Server の新規スタンドアロン インストールまたは既存のインストールへの機能の追加」をクリックしたのですが 「SQL Server 2008インストールメディアの参照」と出て、 ローカルディスク（C）のまま、OKを押すと 無効なインストールフォルダです。 となってしまうのですが、 どのフォルダならインストールできるのでしょうか？ それとも何かＣＤ－Ｒが必要なのでしょうか？
ASP.NETからSQLServerにアクセスしようとすると、ログイン画面が表示されてしまいます。 今まで、問題なく運用出来ていましたが、新たにデータベースにテーブルを追加し、それにアクセスする処理を実行したところ、ログイン画面が表示されてしまいました。実施した手順は、以下の通りです。 ノートPC（開発機）のMicrosoft Visual Web Developer 2005でデータベースのテーブルを新規追加し、プログラムを検証したところ問題なかったので、プログラムを本番機(サーバ）にコピーし検証しようと思い、サーバ側でSQL Server Management Express 2005を用いてテーブルを新規追加して検証したところ、ログイン画面が表示されてしまいました。 実施した手順 １．ASP.NETのプログラム内で、新しいテーブルを参照する処理を追加。 ２．ノートPC（開発機）内のMicrosoft Visual Web Developer 2005でテーブルを新規追加し、プログラムを検証。問題なくアクセスできた。 ３．ノートPC（開発機）から本番機サーバにプログラムをコピー。 ４．本番機サーバのSQL Server Management Express 2005でテーブルを新規追加。 ５．本番機でプログラムを実行したところ、ログイン画面が表示されてしまった。 補足：従来のテーブルはsa認証なので、同様にsa認証でテーブルを追加。 データベース：SQLServer2005 OS：WindowsServer2003 SD SP2 このような場合は、どのように対応したら良いのでしょうか？ ご存知の方いらっしゃいましたら、ご教授願います。 よろしくお願いいたします。
SELECT のWHEREに別のSELECTの結果を当てはめることは可能でしょうか？ ただし、引用テーブルは同じテーブルとします。（DDD） 例 SELECT * FROM DDD WHERE B = (SELECT B FROM DDD WHERE C=1) 再起SQLとはまた違うのでしょうか？
こんにちは。昔、yayoi会計というソフトウェア体験版をインストールしたことがあります。その時に、SQL Server 2008もインストールされました。 Windows XPのサービスを見ると、「SQL Server(YAYOI)」、「SQL Server Agent(YAYOI)」なるものが残っています。現在は弥生会計は削除されていてサービスも停止しています。 不要なので、サービル(ローカル)から削除したいと思っていますが、どのようにすればサービスが削除できるでしょうか？
SQLServer2000 を使用しています。 海外拠点のSQLServer(2000)とインターネットVPN経由でDTSでデータの交換をする ジョブを使っていました。 問題なく動作していましたが、ある日突然、失敗するようになり、 SQLServerのログインすら出来なくなってしまいました。 （PINGは通るし、名前解決も問題ありません。エクスプローラーでアクセス可能です） 不思議なことに私の端末からの接続は問題なく、動作も正常です。 そして、海外拠点のサーバーから本社のサーバーへの接続も正常です。 また、海外拠点の他のサーバーへの接続も正常です。 問題のサーバーのみ、一方通行です。（アクセスされるほうは正常） おかしくなったあと、サーバー名でなくIPアドレスでログインしたら 接続できたのですが、しばらくたつと、IPアドレスのログインすらできなくなり、 いったい何がなんだか訳がわかりません。 エラー内容ですが、EnterpriseManagerからサーバーに接続すると下記のエラーが でます。（その他、ジョブの実行、DTSの実行もすべてこれで失敗します） SQL Server が存在しないか、アクセスが拒否されました。 ConnectionOpen (Connect()).。 海外拠点とのやりとりで夜間バッチでデータ交換ができないと 運用的に厳しくなんとか復旧したいとおもいます。 同じような境遇にあるかたいらっしゃいましたら、 情報をいただけると幸いです。
windows7 64bit sql server 2012 expressをつかっています。 select YEAR("日付") as yere,MONTH("日付") as month,収支名,sum("金額")as kin from 収支 group by YEAR("日付"),MONTH("日付"),収支名 を実行して、 yeremonth　収支名　ｋin 20136支出13011 20136収入33500 20137支出20000 20137収入70000 と、なりましたが、同じ年、月の収支と支出を求める表を得るにはどうしたらよいでしょうか？ yeremonth　差 2013 6 -24089 2013 7 50000 のような感じです。 （もとのテーブルはこれです） id日付収支名項目金額 12013-06-16収入給料15000 22013-06-16支出ガス代555 ．．．．．． 宜しくお願いします。
SQLServer2008R2 Express を使用しております。 添付画像のように、MADBという名前のデータベースにバックアップファイルから復元を試みると、失敗してしまいます。どこに気をつければよいでしょうか。 (1) 「既存のデータベースを上書きする」にチェックは入れてあります。 (2) 復元先のパスは合っています。 (3) SQLServerのバックアップファイルのバージョンは、2008R2より上ではありません。
こんにちは。 Windows2008R2上に「SQL Server2012」を導入しようとしています。 しかしながら来月にはAD環境が出来上がることにより、「SQL Server2012」を導入したサーバも AD環境に加わります。 その場合は、「SQL Server2012」は再導入しないといけないのでしょうか？ 仮に、再導入が必要な場合は再導入しないでもよい方法はないでしょうか？ お教えください。
テーブルのおインデックス項目はSELECTすると検索が早いのですが、 インデックスではない項目をWHEREすると時間がかかります。 そこでテーブルカラム全部をインデックス化することでの メリット、デメリットは何でしょうか？
SQL Server 2005 Express Edition Service Pack 4をWindows8(64bit)が入ったPCにインストールしようとしています。 32bitと64bitの両方がサポートされたSQLEXPR_JPN.EXEをダウンロードし、インストールを実行すると、64bitマシンなのに、なぜかデータベースサービス等全てProgram Files (x86)配下にインストールされます。 以前、同じくWindows8(64bit)が入っている別マシンにSQL Server 2005 Expressをインストールしたことがありますが、その時はProgram Files配下にインストールされ、64bitとして認識されたようです。 ちなみに、SQL Serve 2008、2008 R2、2012等は、きちんと64bitとしてインストールされております。 64bitのみのインストーラーや、64bitとしてインストールというインストールオプションがあれば良いのですが・・・ 同じ64bitのWindows8にインストールしようとしているのに、なぜ、このような違いがあるのかわかりません。 どなたか、正常に64bitとしてインストールできる方法をご存知であれば教えてください。
1台のPCで発生している問題です。SQLServerで、Select命令は即戻ってくるのですが、Insertの処理は遅く、1件に2秒くらいかかっており、理由が分からず困っています。他のPCからは、SelectもInsertも問題ありません。 ＜SQLServer環境＞ ・バージョン：SQLServer2005 Express ・OS：WindowsXP ・ポート番号：1433固定 ＜クライアント環境＞ ・OS：Windows7 　※問題の発生しているPCも、問題の発生しないPCも、共に同じOS・同様のスペックです。 ＜当方でテストした内容＞ ※全テストで、実行前にテーブルはtruncateし、トランザクションは未使用で実行しています。 (1) 1件づつ Insertし、計3000件を登録 　　　→問題発生PCでは、1件に2秒くらいかかる。問題なしPCでは、3秒くらいで全て終了 (2) sqlBulkCopyを利用し、配列変数に格納したデータ計3000件を一括登録 (配列格納後に測定) 　　　→問題発生PCでは、15秒で30件くらい。問題なしPCでは、3秒くらいで全て終了 (3) bcpin で、テキストファイルの計3000件を登録 　　　→問題発生PCでは、30秒くらい経っても開始されず。問題なしPCでは、1秒くらいで全て終了 (4) Select命令発行 　　　→問題発生PC、問題なしPC　共に、1秒くらいで全て終了。 (5) bcpout で、テーブルより計3000件をテキストファイルに落とす 　　　→問題発生PC、問題なしPC　共に、1秒くらいで全て終了。 bcpinについては、ためしに、 -S IPアドレス\Express,1433 と、ポート番号を付けて実行もしてみましたが、結果は同じで、問題発生PCでは、開始に時間がかかり、問題なしPCでは即終了しました。 以上の結果より、問題なく動くクライアントもあるため、Server側の問題ではなく、問題発生クライアントPCの環境に問題があるのではないかと思っていますが、SQLServerの接続、Selectやbcpoutには問題なく、Insertやbcpinといったデータ挿入のみが遅いという点で、何に問題があるのか、さっぱり検討がつきません。 このような場合、どういった点を調査したらよいのでしょうか？
DB初心者です。 ODBCからSQLサーバーへのアクセスを設定したく、奮闘しておりますが うまくいかず困っております。 先方から支給されたのは、 DB名、ID、パスワード、ホスト名、ポート番号、MySQLのバージョン5.0.90で、 その通り設定したつもりが、以下のようなエラーが出てソース作成できません。 --- 接続できませんでした。： SQLState: '01000' SQL Server エラー: 11001 [Microsoft][ODBC SQL Server Driver][TCP/IP Sockets]ConnectionOpen(Connect()). 接続できませんでした。： SQLState: '08001' SQL Server エラー: 6 [Microsoft][ODBC SQL Server Driver][TCP/IPSockets]指定された SQL Server が見つかりません。 --- エラー番号で検索してみても原因がわからず・・・ 詳しい方いらっしゃいましたらお願いいたしますm(__)m
@jouken int @sql varchar(MAX) @select varchar(MAX) @where varchar(MAX) set @select = 'select * from table1' set @where = ' where case when @jouken = 0 then 'field1 = 1' when @jouken = 1 then 'field1 = 1 or field2 = 1' when @jouken = 2 then 'field1 = 1 or field2 = 1 or field3 = 1' end ' set @sql=@select+@where exec(@sql) 上記のような文字列の組み合わせでの作成でやりたいことはできたのですが、 こちらを直接SQLの中でやりたいのです。 以下の文は機能しません。 select * from table1 where case when @jouken = 0 then field1 = 1 when @jouken = 1 then field1 = 1 or field2 = 1 when @jouken = 2 then field1 = 1 or field2 = 1 or field3 = 1 end ご教授の程、よろしくお願い致します
SQLで テーブルAとテーブルBがあり、 AとBの構造はほぼ同じとします。 Selectで引用する際に、 seelct * from (A + B) みたいなAとBをくっつけて、 あるカラムをOrderByしたいと思っております。 いったんTempテーブルなどに落とし込むなども考えましたが、 スマートではなく、時間もかかることなので、 １クエリで取得することは可能でしょうか？
ＳＱＬ Serverを勉強中です。 以下のようなテーブルに、同一の日付に複数の名称・値のセットが存在します。 Date(日付)　 Name（名称） Value(値) 20130101　　　　　 a 　　　　　10 20130101 　　　　　b 　　　　　20 20130101 　　　　　c 　　　　　30 20130202 　　　　　a 　　　　　5 20130202 　　　　　b 　　　　　10 20130202 　　　　　c 　　　　　15 このデータを、ＳＱＬのＳＥＬＥＣＴ文で取得し、以下のような表を作りたいと考えています。 a b c 20130101102030 2013020251015 行が日付、列が名称になっています。 このように取得できるSQL文を教えてください。よろしくお願いします。
Winows 7 Homeで SQL SERVER 2012 EXPRESS EDITIONを使用しています。 フィールド数は60程度のテーブルに 30,000件程度のInsert文を発行したところ、 「このクエリを実行するには、リソース プール 'internal' のシステム メモリが不足しています。」 というメッセージが出力され、処理が完了しませんでした。 どれくらいだったら、いけるか計測したところ、16,000件までは完了するのですが、 以降は同様のメッセージが出力されます。 クエリは下の文のような具合です。 INSERT INTO table1 (aa,bb,cc..) VALUES('あいう','かくく','さしす'); こちらのURLのように http://www.junmt.info/article.php/20100926164914 … INSERT INTO table1 (aa,bb,cc..) VALUES('あいう','かくく','さしす') ; とやってみましたが、ダメでした。 最大90,000件程度あるので、すごく困っています。 おわかりになる方どうか解決法を教えて下さい。
お世話になります。 下記、置換前のSELECT結果を 置換後のようにしたいですが、 方法が考え付きません。 できればSQL(ストアド）のみで実行したいのですが スキル不足です。 お手数ですが、ご教授頂きたく宜しくお願い致します。 条件は、B_NOの”N002"が同一のバッチでハイフン以降が 枝番で、その数は、固定では、なくNです。 "N002"のグループ内に"N"が存在したら"P"に置換したいです。 OS:WIN 2003SERVER DB:SQL SERVER2000 SP4 置換前 REC_NO,B_NO,TYPE R001,N001-1,P R002,N001-2,P R003,N002-1,N R004,N002-2,N R005,N002-3,P R006,N003-1,N R007,N003-2,P R008,N004-1,N R009,N004-1,N 置換後 REC_NO,B_NO,TYPE R001,N001-1,P R002,N001-2,P R003,N002-1,P R004,N002-2,P R005,N002-3,P R006,N003-1,P R007,N003-2,P R008,N004-1,N R009,N004-1,N
お世話になります SQL Serverで、 100万件のレコードを削除したいのですが どのような方法が効率よいでしょうか また、メモリ負荷など、クライアント側から分かるような実行計画とかは ありませんでしょうか？ 1.100万件を1回でdelete 2.100万件を複数回に分けてdelete 3.100万件を1行ずつキー指定でdelete(deleteを100万回実行) 100万件deleteしてる場合も、他処理でレコードが登録、更新される可能性が高いため、 そちらの処理がタイムアウトなどのエラーにならないようにしたいです 詳しい方に聞いたところ、 delete発行する際に、メモリにアクセスしてるので、 3だとそれが単純計算で100万倍になるので、負荷が高いのでは？ という事でした。 ご教授の程、よろしくお願い致します
現在、某共有レンタルサーバーの契約を考えております。 そこのレンタルサーバーではmysqlが１００Mを超える場合は動作が遅くなる可能性があるということをその会社のホームページで見ました。 その会社に電話で問い合わせたところ、１００Mを超えてサーバーに負担がかかり他の利用者の方たちに迷惑がかかるような場合は何らかの制約がされるという旨の説明がありました。 そこで質問なのですが、mysqlの容量が増えると単純にサーバーの負担も増えるようようなものなのでしょうか？　例えば、２００Mのmysqlは１００Mのものに比べて2倍の負担がかかるということがあるのでしょうか？　どうも納得ができなかったため質問させていただきました。 よろしくお願いいたします。
SQL Server(すみませんバージョンが分かりません) をVBから使っています。select やupdateのSQLアクセス を指定時間でタイムアウトさせ、できれば指定回数試行 した上でリターンさせる方法はないでしょうか？ 自前のリトライ機構を実装するのは今さらかなりインパ クト大な状況でして。。 宜しくお願いいたします。
現在下記のSQL文で会社単位で訪問回数と請負費を出していますが。 JOINしているテーブルをUNION（複数テーブルの合計）するにはどうしたらいいですか？ （テーブルは社員単位で作成しています） SELECT TEST11.会社名, SUM(TEST2.訪問回数) AS 訪問回数, SUM(TEST2.訪問回数 * TEST2.単価) AS 請負費 FROM TEST11 RIGHT OUTER JOIN TEST2 ON TEST11.訪問日 = TEST2.訪問日 AND TEST11.区分コード = TEST2.管理番号 GROUP BY TEST11.会社名 ORDER BY TEST11.会社名 結果は下記になってます |会社名|訪問回数|請負費| 分る方ご教授頂けると幸いです
ADO.NETでsdfファイルからmdbファイルへテーブル（TBL1)を移行させたいと思っています。 以下のようなコードでDataSetをコピーできないか試しましたが、移行できません。 sdf、mdbともテーブルのカラムの構造は同一です。 mdbの方にはレコードが空のテーブルが用意してあります。 何が間違っているのでしょうか？お教えいただけると助かります。 SDF Dim con As SqlCeConnection = DBUtility.GetConnection() con.Open() Dim strSQL As String strSQL = "select * from TBL1" Dim adapter As SqlCeDataAdapter = _ New SqlCeDataAdapter(New SqlCeCommand(strSQL, con)) con.Close() Dim ds1 As DataSet = New DataSet() adapter.Fill(ds1, "TBL1") Dim con2 As OleDbConnection = DBUtility.GetOLEConnection() con2.Open() 'MDB Dim strSQL2 As String strSQL2 = "select * from TBL1" Dim adapter2 As OleDbDataAdapter = _ New OleDbDataAdapter(New OleDbCommand(strSQL2, con2)) Dim ds2 As DataSet = New DataSet() ds2 = ds1.Copy Dim cb As OleDbCommandBuilder = New OleDbCommandBuilder(adapter2) adapter2.Update(ds2, "TBL1")
一人でアクセスを使っているのですが SQLサーバーに移行するメリットはありますか？ レコード数は５万件くらいです。
MS SQL Server自体が初心者なので、初歩的な質問だと思いますが、 Enterprise Managerを使って、Aというデータベースの「tbl」というテーブルの内容を、「tbl_new」というテーブルに全てコピーするには、どうすればよいのでしょうか？フィールドの内容は同一です。 ちなみに、両方のテーブルにいくつかデータが存在していて、「tbl」が正しいデータになっています。 同じキーがあれば更新して、キーがなければ追加したいのです。 一度テーブルを消して、コピーするなどの方法が依存関係の都合でできないので、データだけ移したいと思っています。 Enterprise Managerのどの機能を使えばよいのかもわからない状態ですが、よろしくお願いします。
SQLServer2008 R2　をメンテナンスプランでバックアップする方法について、ご教授ください。 やりたいこと １）毎日完全バックアップを取得 ２）バックアップはすべて別ファイルにしたい ３）数日後たったバックアップファイルは削除したい ３）については、メンテナンスのクリーンアップタスクでできそうですが、 ２）がどのように設定するのかがよくわかりません。 データベースのバックアップタスク　により、 　(1)バックアップの種類：完全 　(2)データベース：特定のデータベース（とりたいDBを選択） 　(3)バックアップの有効期限（設定しなくてよい？） 　(4)バックアップ先：ディスク 　(5)すべてのデータベースにバクアップファイルを作成する。 　　　にチェックを入れると、勝手にファイル名が日付で作成されるようです。 上記のまま「OK」をすると、デザイン画面には「既存データに追加」と表示されています。 この設定で、毎日別のファイルができるでしょうか。 有効期限を設定しておいたほうがよいのでしょうか。 いろいろ調べてみたのですが、どうもやりたいこととぴったりマッチするものがなく、こちらに質問させていただきました。 有効期限、追加・上書き　あたりの関係がよくわかっておりません。 やってみればいいのですが、あまり時間がなく「数日」の確認を数パターンとることができないので、よろしくお願いします。
プログラマ２年目なのですが仕様書を解読して SQL文を自分一人で作成する事が中々できません 先輩に作ってもらったりヒントをもらったりする事が 多々あります。そのため、先輩に「なんでわからないの」 とあきれ口調で怒られます。 独学しようと思っても本で得られるのは単純なSQL文です 仕様書の文章を何度も何度も読み返しても答えとなるSQL 文が浮かんできません。 質問 １．仕様書の読解方法 ２．独学方法 ３．参考ホームページ ４．仕様を自分で考えて作る時の対象システム ５．SQLのよくある仕様パターン ６．ユニークなSQL文のサンプル ７．仕様プラスSQL解答例が載っているようなホームページOR参考書 上記一つでもいいのでご回答ください。より多くの皆さまからのご回答 をお待ちしております
Visual Studio2010の勉強をし始めました。データソースの変更についてお教え願います。 データソースの変更に、 ■Microsoft SQL Server ■Microsoft SQL Serverデータベースファイル 二つあります。この二つは何が違うのでしょうか？ 説明も書いてありますが、イマイチわかりません。 ネット検索もしましたが、見つけることができませんでした。 平たく、簡単に言うとどういったことでしょうか？ 宜しくお願い致します。
添付画像のようなデータがあって、赤字のところだけ出力したいと 思っています。 グループIDごとに、一番個数が大きいもの（同じ個数の場合、個別IDが 若いもの）を出したいのです。 （順位はグループごとにふられているので、グループごと同じです） 個数が同じデータがあるもので、単純にMAXのものを…とするのも 難しそうで困っています。 ご教授いただけないでしょうか。
サーバのSqlServerのデータをCSVにエクスポートしたいのですが、うまくいきません。 管理者権限だと動きますが、一般ユーザーでEXEC xp_cmdshell"bcp・・・"だとセキュリティでひっかかり動作しません、セキュリティの設定に関する資料も少なく、どなたかご教授願えませんか。 またほかの方法でもいいんです、クライアントはC#とVBのみです。sqlcmdやbcpなどは一切ありません。ですので、すべてをできればサーバ側で行いたいのです。お願いします。
初歩的な質問ですみません。 教えて頂けますでしょうか。 データベースでビューテーブルというものがありますが、 登録データが実テーブルではなく、ビューテーブルの方で保存（保持）されているということはあるのでしょうか？ テーブルのデータとデータベースの構造調査をしなければならないのですが、 実テーブルのみ調査をすれば良いのでしょうか？ ビューテーブルにもデータがありました。 宜しくお願い致します。
皆様、お知恵を拝借させてください。 現在、SQLServer + VB.netで開発を行っていますが、どうしてもうまくいかないので悩んでいます。 ロジックを組めば解決できるのは、わかっているのですが、SQL文だけで解決したいのです。 よろしくお願いします。 やりたいことは、複数テーブルからの同一IDの抽出です。 IDで単一化 テーブル【現在】を優先して抽出 テーブル【履歴】のみ存在する場合、履歴NOの大きい方を抽出 テーブル【現在】 　ID　名前　趣味 ------------------ 　10　太郎　釣り 　20　次郎　ゴルフ テーブル【履歴】 　ID　名前　趣味　履歴NO ------------------------- 　10　太郎　将棋　01 　10　太郎　囲碁　02 　30　花子　園芸　01 　30　花子　料理　02 求めたい結果は 10　太郎　釣り 20　次郎　ゴルフ 30　花子　料理 です。よろしくお願いします。
レンタルビデオ店や図書館で指定日範囲内の、貸出本数の合計の最大値を取得したいです。 ※○月は○日が貸出ている本数が一番多かった… テーブル上では８桁の日付と貸出本数を持っています。 例えば、下記データがテーブルに登録されている場合に、 where文で'20130101'～'20130131'と期間を指定すると'13'が抽出されます。 １月４日が１３本貸出中で、指定期間内で一番貸出本数が多いからです。 貸出日/返却日/本数 ------------------------------------------ 20130101/20130104/4 20130102/20130105/6 20130104/20130108/3 20130106/20130109/8 20130110/20130114/5 ------------------------------------------ 調べてみたのですが、指定日の最大値取得は見つかりましたが、指定期間での抽出方法がわかりませんでした。 使用環境はSQLServerです。 ご協力、お願致します。
WindowsXP環境でACCESS2003を使用して、ODBCリンクでSQL SERVER2005に接続し、データーを取得後ローカルテーブルにデーターを置く処理を作って運用していたのですが、 Windows7でACCESS2003に移行し、システム内容は変更していないのですが Windows7になってリンクテーブルを開くと「ODBC タイムアウトエラー」が発生します。 WindowsXPのときはタイムアウトが出ずに1分くらいで結果が返ってきます。 多分、SQL SERVER ドライバーの影響と思うのですが分かりません。 どなたか教えてください。 Windows7 SQLSERVER（ODBC）ドライバー バージョン：6.01.7601.17514 windowsXP ドライバー バージョン：200.85.1132.00
はじめまして。 現在、私は仕事で統計を表示するためのレポートを作成中ですが、 データ取得SQLのよいアイデアが浮かびません。 わかる方がいらっしゃいましたら、お知恵を貸してください。 booking_id　　販売支店　　出身国　　　　値段　　　　車種 ---------------------------------------------- 01　　　　　　　東日本　　　ブラジル　　　100,000　　　A 02　　　　　　　東日本　　　ブラジル　　　200,000　　　A 03　　　　　　　東日本　　　ブラジル　　　300,000　　　B 04　　　　　　　東日本　　　ブラジル　　　400,000　　　C 05　　　　　　　東日本　　　日本　　　　　500,000　　　A 06　　　　　　　東日本　　　日本　　　　　600,000　　　B 07　　　　　　　西日本　　　ロシア　　　　700,000　　　B 08　　　　　　　西日本　　　ロシア　　　　800,000　　　B 09　　　　　　　西日本　　　ロシア　　　　900,000　　　B 10　　　　　　　西日本　　　韓国　　　　　100,000　　　A 11　　　　　　　西日本　　　韓国　　　　　200,000　　　B 12　　　　　　　西日本　　　韓国　　　　　300,000　　　C 13　　　　　　　西日本　　　韓国　　　　　400,000　　　C 上記のようなテーブルがある場合、販売支店と出身国でグループ化して、 それぞれの値段の合計値を出します。 その際、車種はもっとも頻出した値を表示したいのですが、 どのようにしたら実現できますでしょうか。 （最頻値が２つ以上の場合は、その中のどれかを表示する。） 期待結果は以下のようになります。 販売支店　　　出身国　　　　値段　　　車種 --------------------------------------- 　　東日本　　　ブラジル　　1000,000　　　A 　　東日本　　　日本　　　　1100,000　　　A 　　西日本　　　ロシア　　　2400,000　　　B 　　西日本　　　韓国　　　　1000,000　　　C SQL Server は、2008R2を使用しております。 以上、よろしくお願いいたします。
iis7でxoopsを再インストールしたいと考えています。 インストール中に【XOOPS2 テーブルがデータベースに既に存在します】と出てきたので下記の方法で 削除しました。 でも、また同じようにデータベースが存在するメッセージが出てきます。 windows server2008 R2はどこからテーブルを削除すればいいでしょうか。 おわかりの方がいらっしゃいましたら宜しくお願いします。 1.IIS マネージャを開き、管理するレベルに移動します。 IIS マネージャを開く方法については、「IIS マネージャーを開く (IIS 7)」を参照してください。 UI の特定の場所への移動については、「IIS マネージャーでのナビゲーション (IIS 7)」を参照してください。 2.[機能ビュー] で、[接続文字列] をダブルクリックします。 3.[接続文字列] ページで、 削除する接続文字列を選択します。 4.[操作] ウィンドウで、[削除] をクリックし、[はい] をクリックします。
countとdistinctを使ったSQL文について VB2005＋SQLSERVER2005で開発を行っています。 distinctとcountを組み合わせて抽出するようなSQL文になるのかなと思うのですが うまくいきません カラム maker:メーカ名が登録されている テーブル　shohin カラムmakerの実際のデータ例 富士通 NEC 東芝 パナソニック NEC NEC パナソニック 抽出した結果の例 富士通　　　　１ NEC　　　　　３ 東芝　　　　　１ パナソニック　２ メーカー名とその件数が出力結果となります 以上ですがわかる方いらっしゃいましたらご回答お願いいたします。
教えてください。SQLSever初心者です。SQLサーバがインストールされているサーバのコンピュータ名を変更します。変更によって何か影響することがありますでしょうか？
こんにちは。 DB未経験で勉強中です！ どなたか教えてください。。 OracleのTO_DATE関数のようなことはSQL Serverでは実現可能でしょうか？ 数値型から日付型への変換です。 たとえば20121109を2012/11/09と変換、 もしくは201211を2012/11に変換するなどです。 是非、ご教授願いします。
現在SQLserver上で、、ＣＳＶを一時テーブルに保管し、ある条件に合致する行のみＴＢＬに追加するというストアドを書いています。そのＴＢＬには「datetime型」の列があります。 この作業で、２点問題が発生しています。 (1)ＣＳＶファイルから一時テーブルにデータを入れようとすると、datetime列がＮＵＬＬの場合、型の不一致でエラーが発生します。 (2)上記において、一時テーブルの型をとりあえずvarcharにしておくと入れれるのですが、ＴＢＬに追加しようとする際、「convert(datetime,変数)」としているのですが、上手くキャストしてくれません。（「文字列から日付への変換に失敗しました」のような文がでます） どのようにすれば、ＮＵＬＬでもdatetimeに入れられるのでしょうか？教えてください。
お世話になっております。 表題のテーマについて、理解いただける方にアドバイスお願いします。 会員を表すMembersというテーブル、 種別を表すTypesというテーブル、 会員と種別を結び付けるMemberTypeBindsというテーブルがあって、会員・種別がn対nで定義されています。 Membersの件数は200件ほど、Typeは20件程度。だいたいMembersは1～5くらいのTypeに紐づいています。 Table Members int ID(主キー, autoIncrement) varchar(20) MemberName Table Types int ID(主キー, autoIncrement) varchar(20) TypeName Table MemberTypeBinds int memberID(外部キー, MembersのID) int typeID(外部キー, TypesのID) これを、LINQで下記のクラスオブジェクトに抽出したいと思っています。 今は全件表示でもいいですが、そのうちページングで表示する必要がでてくると思います。 public class MemberTypes { 　public Member　member{ get; set; } 　public List<Type> types　{ get; set; } } どうやるかがわかりません。LINQはこんな感じだと思うのですが、 public List<MemberTypes> GetMemberTypes(){ 　using (var dc = new DataContext()){ 　　var result = dc.MemTypeBinds 　　　.GroupBy(mt=>mt.Member) 　　　// このあと、どうやったらいいかがわかりません。 　　　// DBから階層化オブジェクトを生成するのは 　　　// けっこう頻出のテーマだと思うので、しっかりマスターしたいです。 　　}).ToList(); 　　return result; 　} } LINQに詳しい方、お助けください。
ＳｑｌＳｅｒｖｅｒにおける、ビューとクエリについて、その違いというか、概念を教えてください。 私は、最初にＡｃｃｅｓｓと「標準ＳＱＬ」という本で、データベースを学びました。 本を読んでＡｃｃｅｓｓに向かったときに、クエリってビューのことなのかな？と思って、ずっとやってきました。 ところが、ＳｑｌＳｅｒｖｅｒには、両方の言葉が出てきます。で、とりあえず、クエリをデザイナで作ってみて、クエリにクエリを内包するようなものを作る段になって、クエリが追加できなことに気づきました。Ａｃｃｅｓｓでクエリのタブがあるところに、ビューというタブがあるので、クエリの代わりに、ビューを作りました。まったく同じ手順で作れましたが、保存するときに、「ＯｒｄｅｒＢｙ句は、ビュー定義のＴＯＰ句によって返される行を決定するためだけに使用されます。したがってクエリ自体でもＯｒｄｅｒＢｙが指定されていないと、ビューでクエリを実行したときに結果が並べ替えられ宇保証はありません。」 などと、表示されます。 ビューでクエリを実行するとは、どういう事なのでしょうか？クエリを実行するのと、ビューを実行(？)するのは、何か違うのでしょうか？
SQLserverにデータを入れる際、現在存在しているテーブルとは型があっていない列があります。 このとき、キャストをしながらインサートを同時に行いたいのですが、どのようなクエリを書けばいいかわかりません。教えてください。
SQL Serverについて学習中です。 認証方法の違いについてご教示ください。 SQL Serverには「Windows認証」と「SQL Server認証」の二つの認証方法があるところまでは理解したのですが、ネット検索や手元の資料をみても具体的なものが見えてきません。 (1)「Windows認証」でSQL Serverに接続するには： クライアントPCのWindowsアカウント名／パスワードが、SQL ServerがインストールされているPCに登録されているWindowsのユーザー名／パスワードと一致している必要がある。（一致していても、SQL Serverの設定で接続を拒否されていると接続できない） (2)「SQL Server認証」でSQL Serverに接続するには： SQL Serverの「ログイン」（←Windowsのアカウントではない）に登録されているユーザー名／パスワードと一致すれば、クライアントPCのWindowsアカウントのユーザー名／パスワードが何であっても、データベースに接続できる。 認証方法の違いについては、上記このような理解でよいのでしょうか？？ しかし実際には「SQL Server認証」を選択すると、SQL Serverのユーザー名／パスワードだけでなく、Windowsアカウント名／パスワードも一致していないと接続できないように思えます。 つまり 「Windows認証」は「Windows認証だけ」で 「SQL Server認証」は「Windows認証 + SQL Server認証」（両方一致しないといけない） なのではないかという気がしています。 VBやVC#等でローカルアプリを作って複数で使用したいのですが、クライアントPCのアカウント名まで管理するのは厄介です。XPパソコンをAdministratorで使用している人がたくさんいて、Windows認証をクリアできないからです。 クライアントPCのアカウント名やパスワードに関係なく、SQL Serverに登録されたユーザー名／パスワードだけで接続するには、どうしたらよいのでしょうか？ よくわかっていないので、よくわからない質問になってしまっていると思いますが、よろしくお願いします。 質問の意味がわからないところは補足しますので、ご指摘ください。
SQL Server 2008R2のテーブル（データベース）をWindows 2000に置いて、WinXPやWin7でアクセスしたいのですができますか？ ご教授願います。
access2007・Microsoft SQL Server 2012です。 アクセスからアップサイズしようとすると、 「アップサイジング ウィザードは Accessプロジェクトの接続先であるMicrosoft SQL Server のバージョンでは使用できません。 最新情報とダウンロードについては、Microsoft office　UpdateのWebサイトを参照してください。」 http://support.microsoft.com/kb/967913/ja を見たのですが、この場合は、SQL Server 2008でした。 当方は2012です。 なんでできないのでしょうか？
初心者です。 SQL SERVER 2012です。 「売上明細」テーブルに、新規行を挿入した時に、「得意先単価マスタ」を更新・または追加したい CREATE TRIGGER [dbo].[INSTEAD_OF_INSERT_ON_T_D売上明細] ON [dbo].[T_D売上明細] INSTEAD OF INSERT <<省略>> /* 得意先別単価マスタの更新 */ IF (@column_new_value$19 <> 0) BEGIN /* 得意先別単価マスタを参照する */ SET @CURSOR_PARAM_CRSTS_CRSTS_得意先コード = @column_new_value$9 SET @CURSOR_PARAM_CRSTS_CRSTS_納品先コード = @column_new_value$10 SET @CURSOR_PARAM_CRSTS_CRSTS_商品コード = @column_new_value$16 DECLARE crsTS CURSOR LOCAL SCROLL_LOCKS FOR SELECT dbo.T_M得意先別単価.作成日付, dbo.T_M得意先別単価.更新日付, dbo.T_M得意先別単価.得意先コード, dbo.T_M得意先別単価.納品先コード, dbo.T_M得意先別単価.商品コード, dbo.T_M得意先別単価.単価区分, dbo.T_M得意先別単価.売上単価1, dbo.T_M得意先別単価.売上単価2, FROM dbo.T_M得意先別単価 WHERE ((dbo.T_M得意先別単価.得意先コード = @CURSOR_PARAM_CRSTS_CRSTS_得意先コード) AND (dbo.T_M得意先別単価.納品先コード = @CURSOR_PARAM_CRSTS_CRSTS_納品先コード) AND (dbo.T_M得意先別単価.商品コード = @CURSOR_PARAM_CRSTS_CRSTS_商品コード)) OPEN crsTS FETCH NEXT FROM crsTS INTO @recTS$作成日付, @recTS$更新日付, @recTS$得意先コード, @recTS$納品先コード, @recTS$商品コード, @recTS$単価区分, @recTS$売上単価1, @recTS$売上単価2 /* 該当が有った場合は更新する */ IF (@@FETCH_STATUS = 0) IF (@column_new_value$19 = 1) UPDATE dbo.T_M得意先別単価 SET dbo.T_M得意先別単価.単価区分 = @column_new_value$19, dbo.T_M得意先別単価.売上単価1 = @column_new_value$22 WHERE CURRENT OF crsTS ELSE IF (@column_new_value$19 = 2) UPDATE dbo.T_M得意先別単価 SET dbo.T_M得意先別単価.単価区分 = @column_new_value$19, dbo.T_M得意先別単価.売上単価2 = @column_new_value$22 WHERE CURRENT OF crsTS ELSE IF (@column_new_value$19 = 1) INSERT INTO dbo.T_M得意先別単価 ( dbo.T_M得意先別単価.得意先コード, dbo.T_M得意先別単価.納品先コード, dbo.T_M得意先別単価.商品コード, dbo.T_M得意先別単価.単価区分, dbo.T_M得意先別単価.売上単価1 ) VALUES ( @column_new_value$9, @column_new_value$10, @column_new_value$16, @column_new_value$19, @column_new_value$22 ); ELSE IF (@column_new_value$19 = 2) INSERT INTO dbo.T_M得意先別単価 ( dbo.T_M得意先別単価.得意先コード, dbo.T_M得意先別単価.納品先コード, dbo.T_M得意先別単価.商品コード, dbo.T_M得意先別単価.単価区分, dbo.T_M得意先別単価.売上単価2 ) VALUES ( @column_new_value$9, @column_new_value$10, @column_new_value$16, @column_new_value$19, @column_new_value$22 ); CLOSE crsTS DEALLOCATE crsTS <<省略>> 上記のように作成してあるのですが、 すでに同一得意先・納品先・商品のマスタが存在する場合は、更新されます。 ですが、存在しない場合、新規に追加したいのですが、そこがうまく動きません。 何が原因でしょうか？
Microsoft SQL Server 2012 をインストールしたいのですが、 既定のインスタンスと名前付きインスタンスのどちらを選べばいいのでしょうか？ ＳＱＬサーバーは初心者です。
Microsoft® SQL Server® 2012 Express をインストールしたいのですが http://www.microsoft.com/ja-jp/download/details. … のどれをインストールすればいいのでしょうか？ 当方ｗｉｎ７、６４bitです。 JPN\x64\SQLEXPR_x64_JPN.exe JPN\x64\SQLEXPRADV_x64_JPN.exe JPN\x64\SQLEXPRWT_x64_JPN.exe のどれかと思うのですがわかりません。 ちなみにプログラムの一覧をみると、 画像のようにSQL Serverの一部？みたいなのが入っています。
VisualStudio2010でwebアプリを作成しています。 クエリビルダでSQL文を作成しSQLサーバにアクセスしています。 このＳＱＬ文でわからない点があります。 列１、列２、列３のフィールドを持つテーブルがあるとします。 ドロップダウンリストで選択した項目により、ある時は列１だけ取得し ある時は列２だけ取得し、ある時は列３だけ取得する様なＳＱＬ文を作りたいのですが、どうすればよいかわかりません、列名を変数にできればよさそうなんですが、そんなことできますか？ ある時は SELECT 列１　FROM table1 ある時は SELECT 列2　FROM table1 ある時は SELECT 列3　FROM table1 としたいので 　　SELECT @列名 FROM table @列名は変数のつもりです。 このようにできればよいと思っていますが・・・ よろしくおねがいします
SSRSを使用しています。 検索SQL-A があるとき。 パラメータによってその結果にDISTINCTを入れたい場合の処置として。 どのようなことを追記すればよろしいでしょうか。 ざっくりとした質問で申し訳ありませんが。 ご教授の程よろしくお願いいたします。
ユーザー側で、Microsoft SQL Server2000を使用しています。 計算結果がおかしいので、仕事場で、SQL2008環境で互換モードでも、以下の現象が出てこまって おります。テストで、確認しました。 23.0 - 22.1 の計算結果を0.9と出したいのですが、 　0.899999999999999 と結果が返ってきます。 どこが間違っているのでしょうか？ SELECT [Field01] AS 'Field01' ,[Field02] AS 'Field02' ,[Field01]-[Field02] AS 'Field01-02' ,(CAST(23 AS FLOAT) - cast(22.1 AS FLOAT) ) AS 'test1' ,(CAST(23 AS REAL ) - cast(22.1 AS REAL ) ) AS 'test2' FROM [dbo].[Table01]
お世話になります。 下記ような３個のテーブルから、下記画面表示内容のようにするには、 どのようなSQLを書けばよろしいでしょうか ご教示願います。 所有者テーブル 所有者ID,所有者名 1,田中 2,鈴木 3,前田 土地テーブル 所有者ID,取得日,面積 1,11/22,100 1,11/24,30 1,11/26,150 2,4/2,45 2,12/4,120 家屋テーブル 所有者ID,取得日,延床面積 1,11/25,30 1,11/30,12 画面表示内容 所有者ID,名前,土地取得日,面積,家屋取得日,延床面積 1,田中,11/26,150,11/30,12 1,田中,11/24,30,11/25,30 1,田中,11/22,100,空白,空白 2,鈴木,12/4,120,空白,空白 2,鈴木,4/2,45,空白,空白 3,前田,空白,空白,空白,空白 よろしくお願いします。
今まで SQL Server2000 を使用していました。 OSはWinXp Proです。 今日アンインストールして、SQLServer2008 Express (SP3)をインストールしたのですが、 起動していないようなのです。 というのも SQLServer2000 の場合、ＯＳ起動すると右下に SQLServer のアイコンが表示されクリックすると起動しているのがわかったのですが、インストールした後、一度もこのアイコンが表示されません。 起動するには何か設定でも必要なのでしょうか？
現在SQLServer2000で運用しているサービスがありますが、 SQLServerでは8000バイト制限があるため、 2005か2008に変更しようと予定しています。 しかし2000→2005や 20005→2008 移行で難航したという意見が結構ききます。 コーディングを結構変更しないといけないのであれば 2000で8000バイトずつに区切ってExecuteしようと思いますが、 どれくらい移行は大変なのでしょうか？
お世話になります。 クエリAとクエリBがあり、ユニオンクエリにて両クエリを結合させたいと思っております。 しかし、クエリBにしかないフィールド（test）がある為、「列数が一致しません」となってしまいます。 このような場合、一般的にはどのようにして対処するのでしょうか。 恐らくクエリAにtestというフィールドを仮想的に？追加するのだと思いますが、やり方がわかりません。 ご教授の程、宜しくお願い致します。
テーブル"t_table"にカラム"col1","col2"が有り、以下の ようにデータが登録されていると仮定して |col1|col2| --------- |aaaa|00gg| |aaaa|00dd| |aaaa|00ff| の場合は行"|aaaa|00ff|"のみ抽出。 |col1|col2| --------- |aaaa|00gg| |aaaa|00dd| の場合は行"|aaaa|00gg|"のみ抽出。 |col1|col2| --------- |aaaa|00dd| の場合は行"|aaaa|00dd|"のみ抽出。 ここで優先順の基準になるのはカラム"col2"に 登録されているデータであり、その優先順は 1.00ff 2.00gg 3.00dd です。 上記のように優先順による抽出はどのようなSQL を組めば実現できるのでしょうか？
使用環境は　DB SQL Server2008 Express 使用ツールは　Microsoft SQL Server Management Studio です SQLserver2000からSQLserver2008DBへ移行しようとしているのですが ストアドプロシージャのところでうまくいきません 具体的には、処理を走らせると下記メッセージが出てきます floatをデータ型numericに変換中に、算術オーバーフローエラーが発生しました プロシージャ"○○"は、許可されていないステータスNULLを返そうとしました。 代わりにステータス0を返します 調べると　 小数点以下があるフィールド同士を掛けて、その結果の小数点以下をROUNDで切り 捨てた値を小数点のないフィールドに追加しようとするとエラーになる　 とありました。 下記　2行あたりが怪しいと思うのですが対処方法がわかりません。 ご教授願えないでしょうか？ SET @GetRand = CAST(RAND()*10 AS numeric(1,0)) … SET @GetRand = CAST(RIGHT(CONVERT(varchar,CAST(RAND()*100 AS numeric(2,0))+100),2) As numeric(2,0)) またストアドプロシージャは、VBのようにデバッグで1行単位で処理を確認してい くことはできないのでしょうか？
こんにちは。 あるテーブル"T_TABLE"に項目がC1（主キー）、C2が有り、データが以下のように登録されていた場合、 |C1|C2| ------| |BB|XX| ------| |AA|XY| ------| |DD|XZ| ------| とあった場合、 カラムC2に"XY"の値を含む行を第一に優先し、同カラムに"XZ"を含む行を第2に優先し、同カラムに"XX"を含む行を第3に優先して抽出するにはどのようにすればよいのでしょうか？ 抽出するイメージは XY XZ XZ の順です。
ずっとOracleを使用してきたのですが、このたびSqlServerの使用を検討することになりました。 Oracleでは、パスワードを知らなければDBの中身を参照することはできないですが、 SqlServerでは、Windows認証、SqlServer認証ともに、サーバー管理者であれば、 DBの管理ができるように思います。 開発時はいいのですが、リリース後は、サーバー管理者（客先のシステム部など）にも DBのデータは見せたくありません。 担当部署と開発担当者のみ参照できるよう設定したいのですが（パスワードを知る人間を限定する）、 SqlServerではそのような設定は可能なのでしょうか？
お詳しい方、どうかたすけてください。 環境はMicrosoftSQLです。 やりたいことは、 あるテーブルからデータを取ってくる際に、最後の購入日を今の日付から1週間さかのぼりしながら、 何週間さかのぼったかを、useridと一緒に結果で返したいのです。 select userid , CASE WHEN MAX(購入日) > getdate()-7 THEN 1 WHEN MAX(購入日) > getdate()-14 THEN 2 as 'week' みたいなことなのですが、 これをWHILEを使って、永遠にさかのぼれるようにしたいのです。 例としては、 DECLARE @ss int; DECLARE @Recency int; set @ss = '7' set @Recency = '0' while (getdate()- @ss > '2012-10-01') begin set @ss = @ss- 7 set @Recency = @Recency + 1 SELECT user_id, case when max(購入日)> getdate()-@ss then @Recency as 'week' end from usrbuyingtable こんなかんじかとおもったのですが、 ぜんぜんうまくいきません・・ 文法チェックをお願いします。
こんばんわ。 SQLServer2008にて1データベース内の全ストアドを対象に、 ストアドプロシージャ記述内で特定の文字列を検索し、置換する方法を考えています。 以下のようなsqlで、ストアド内に文字列があるものを検索することはできたのですが、 ここから先、「★★★」を「○○○」にREPLACEする方法がわかりません。 select routine_name from information_schema.routines where routine_definition LIKE '%★★★%' and routine_type='procedure' 以下のようなsqlで更新しようとしたら、エラーが発生しました。 update information_schema.routines set routine_definition = REPLACE(routine_definition, '★★★', '○○○') where routine_name = 'XXX' (error：システム カタログへのアドホック更新は許可されません。) 不定期にデータベース名を変更することがあり、ストアドの数が多いため、 一括で変換できる方法がないかと探しています。 手作業で変更していく他ないでしょうか。 なにかヒントだけでもご教示いただけると嬉しいです。 よろしくお願いします。
コマンドプロントを使用し、SQLでデータベースを作成しています。 大きなテーブルを複数作り、複数のデータの作成をしています。 １．テーブルの方の定義を行い、キー項目を決める。 ２．データは、一つ一つの項目ごとに、データの型やサイズを決める。 ３．いくつか検索をした際に、ちゃんと結果の違いが確認できるように、100レコード程度のデータを作成する。 の制約で制作しています。 SQLに触って、まだあまり経っていないためどうプログラムを組めばいいのか分かりません。　　　　テーブルの意味などや、キー項目、などの言葉の意味もあまり理解出来てません。 例えば データベース：ONLAINGAME テーブル１：ＭＥＭＢＥＲ テーブル２：WEAPON を制作し、MENBERの中に50件、WEAPONの中に50件データを作ればいいのでしょうか。 データの作り方も少し心配です。 create table MENBERl(age int, name varchar(20) , primary key (aa); 上記の文を打ち、insert into MENBER ( age, name) values(20, 'takasi'); と書けば、制約通りデータが格納できるのでしょうか？ 分かりずらいとは思いますが、詳しいお答えお願いいたします。
SQLServer2000とAccess2000（adpファイル）でシステムを組んでいます。 データベースとの接続は、アプリケーションの「データリンクプロパティ」内で設定してあり、初期立ち上げフォームに次のコードを記述して接続しています。 Option Compare Database Option Explicit Public cn As ADODB.Connection Sub p_接続開始() 　‘データベースとの接続を行うプロシージャ Set cn = Application.CurrentProject.Connection cn.CursorLocation = adUseClient ‘カーソルをユーザークライアントにする End Sub その後、フォームを開いた状態で一定時間経過すると、ＰＣが「システムスタンバイ」状態になり、スタンバイを解除すると次のエラーが出て接続できません。 「[DBNETLIB][ConnectionWrite(send()).]一般的なネットワークエラーです」 しかしいろいろ試した結果、フォームのクリックイベント時に、次のコードを記述したところ、一時的に接続できるようになり、入力フォーム上のデータがSQLServerに保存出来るようになりました。 Set cn = New ADODB.Connection cn.ConnectionString = Application.CurrentProject.Connection cn.Open しかしその後、このフォームを閉じたり、他のフォームに移動したりすると、「[DBNETLIB][ConnectionWrite(send()).]一般的なネットワークエラーです」が出てエラーとなります。 データベースを終了し、再度開き直すと、完全に元通りに復活しますが、上記でフォームを閉じたり、移動したときに、エラーが出ないようにするにはどうしたらいいでしょうか？ Set cn = New ADODB.Connection cn.ConnectionString = Application.CurrentProject.Connection cn.Open この記述は、試行錯誤の末、出来たものであり、これが本当に正しいかどうかわかりません。 どなたかわかる方教えてください。
Microsoft SQL Server Management Studioを使っています。 テーブル追加時にIDENTITYの設定方法は 載っていたのですが、すでにあるカラムに対して はありませんでした。 すでにあるカラムにIDENTITYの設定方法を教えて下さい。
使用環境は　DB　SQL Server2008 Express 使用ツールは　Microsoft SQL Server Management Studio です サーバーは 64bit です インストールファイルは　SQLEXPRWT_x64_JPN.exe　です 現在、同じネットワーク上には　SQLServer 2000のDBを使ったサーバーはあるので すがSQLServer2008は1台だけです 今回　SQL2008のDBを 2000の方にバックアップ用としてコピーしたいと思います ファイルの保存だけであれば可能かと思いますが　万が一の時に 接続先を変更して使えるようにしたいと思います。 認識として、 ・データファイルやログファイルは上位DBから下位DBへアタッチ操作はで きない (上位DBのファイルを下位DBがアタッチ操作できない） ・データベースコピーはできない そこで　データコピー　をしたいと思っています。 下記　HPを参考にフリーソフト(DBCopyTool.exe)を使ってみたのですが http://www.atmarkit.co.jp/fdotnet/dotnettips/859 … サーバーの登録はうまくいくのですが、対象DBの登録について SQLServer2008express や　SQLServer2005express　はうまくいくのですが SQL2000のサーバーでは、下記メッセージが出てきます Fehler:Error getting the database.オブジェクト名'sys.database'は無効です 確認したいのは　上記フリーソフトを使われたことがある方、同じような現象には ならないかどうか 何か設定、確認不足なのでしょうか？ また当初の希望内容を実現するため、他の方法があれば　ご教授願いたいと思いま す。 同HP内の文末に、SQLServer 2000とSQL Server 2008との間でコピーが正しく行え た　とあり決して依存するわけではないのですが、もしやと思い試しているのですがうまくい きません。 仮に　2000のDBを2008にコピーできるとしても、該当DBの選択のところでエラーが 出てしまうのはクリアする必要があると思うのですが… 以上　宜しくお願い致します。
現在SQLServer2005 の WorkGroup を使用しています。 現在のPCでは処理が遅い為、新たにPCを新調し、更にSQLServer2012 Standardも購入する予定です ここで質問なのですが、 SQL2005で作成したテーブルのファイル「○○.mdf」と「○○.ldf」は SQL2012でも読み込むことは出来るのでしょうか？ もっと単純に言うと SQL2005で使ってたHDを抜いてSQL2012をインストールした新PCに繋げて アタッチすればそのままSQL2012で使うことはできるのでしょうか？
Microsoft SQL Server Management Studioを使っています。 下記のクエリを実行するとエラーが出ます。 クエリ alter table Test_table modify name nchar(20) エラー メッセージ 102、レベル 15、状態 1、行 1 'modify' 付近に不適切な構文があります。 今の状況はnchar(10)なのですが、 nchar(20)に変更したいのですが、 どうすればよろしいでしょうか？ 参考にしたURL http://www.syboos.jp/database/doc/alter-table-mo …
使用環境は　DB　SQL Server2008 Express 使用ツールは　Microsoft SQL Server Management Studio です サーバーは 64bit です インストールファイルは　SQLEXPRWT_x64_JPN.exe　です インストール時に　既定のインスタンス名　を選択し Management Studio ツールを使って接続しようとしたのですが サーバー名￥SQLEXPRESS になってしまいます 希望する内容は　サーバー名のみ　で接続したいのです 正確には　最初、名前付きインスタンス名(SQLEXPRESS)を選択して インストールしてしまい　あとでアンインストールし　 既定のインスタンス名で再インストールしているのですが 上記内容になります。 アンインストール後　関係フォルダを削除(一時　別フォルダに保管)しました 具体的には　C:\Program Files\Microsoft SQL Server　のフォルダを 一時別のフォルダにして、再インストールしてみたのですが結果は同じでした。 ちなみに、SQLServer2005Express　では　上記フォルダを削除(移動)することで インスタンス名は付かなくて　サーバー名だけになりました。 何か不要な設定が残っているように思いますが… 確認したいのは　SQL Server2008 Express　では　インスタンス名を無しにするこ とができるのかどうか 再インストール時、削除するフォルダが足りないのかどうか 以上　宜しくお願い致します。
任意の時刻にデータをモニタリングしているシステムがあり、データがMS SQL Serverに保存されています。 int ID int DeviceID 端末番号 int DeviceValue 計測値 smalldatetime DeviceTime 日時 これを、任意の日時範囲を指定し、一日単位で集計された、端末ID、計測値の最大値という形式で取得したく思います。 計測日　端末番号　計測最大値 2012/01/01 10002 34543 2012/01/01 10003 33211 2012/01/02 10002 23450 ... ... DBが得意でないため、困っています。 どなたかお助けいただけないでしょうか？
SQLServer同士のサーバで、別のサーバーの特定のViewを参照する事ができますか？ ＜例＞ Aサーバーで、BサーバーのViewを参照 Select * From [B].[aaa].dbo.v_xxxx 上記のようなことがしたいのです。 データの内容上、他のテーブル・ビューは参照させたくありません。 可能な場合、お手数ですがその方法もご教授頂けるととても助かります。 宜しくお願い致します。
SQL Server Compact 3.5 SP2について教えてください。 現在、SQL Server 2008R2で運用されているWebアプリケーションシステムがあります。 ASP.NETで作られており、データアクセスはLINQ for SQLで動作しています。 今回、ちょっとしたサーバ移転があり、データアクセスの頻度がさほど高くない理由から、SQL Server Compact 3.5での稼働を計画しています。 （Compact 4.0だとLINQが動作しないらしいので） で、開発環境（VS2012）にてSQL CE3.5のファイルを作ろうとしたところ、サーバエクスプローラのプロバイダ選択画面で、CE3.5も4も出てきません。 （通常のSQL Serverや、mdf形式のSQL Serverプロバイダは正しく出てきます） そこで質問なのですが、 ・SQL Server CE3.5はVisual Studio 2012に対応しているのでしょうか？ ・皆さんのVisual Studio 2012では、SQL Server CEをデータプロバイダとして、サーバエクスプローラを動作させることができますか？ よろしくお願いします。
御世話になります。 ＳＱＬＳｅｒｖｅｒ2008　メンテナンスプランについてご教示頂けたらと 存じます。 バックアップ処理などをメンテナンスプランにて設定して 処理を行っています。 毎年、ＤＢが追加になるのでわざわざメンテナンスプラン画面を起動して 追加しなければなりません。 それをコマンドというか、バッチ処理などで追加できないものでしょうか？ 宜しくお願い致します。
お世話になります。 ＳＱＬ Serverのデータ加工についてＳＱＬを教えてください。 元のデータをＳＱＬを使って下記のほしいデータのようにして取得したいのです。 （出身地毎の行で各種目別に集計したい） お願いします。 ＊元のデータ(MotoTable) 出身地,得点,種目,実施年,実施月 東京,80,幅跳び,2012,10 東京,54,反復横跳び,2012,10 長野,66,幅跳び,2012,10 新潟,47,幅跳び,2012,10 新潟,90,幅跳び,2012,10 佐賀,25,幅跳び,2012,10 佐賀,66,反復横跳び,2012,10 東京,100,幅跳び,2012,10 東京,19,反復横跳び,2012,10 愛知,5,懸垂,2012,10 愛知,6,懸垂,2012,10 佐賀,7,懸垂,2012,10 ＊欲しいデータ 出身地,合計点,幅跳び,反復横跳び,懸垂,実施年,実施月 東京,253,180,73,0,2012,10 長野,66,66,0,0,2012,10 新潟,137,137,0,0,2012,10 佐賀,98,25,66,7,2012,10 愛知,11,0,0,11,2012,10
独学で勉強しているのですがさっぱり分かりません...。 C#　visual studio へ　SQL server情報を読み込みたいのですが...Button1を押したら、sql に作成してある(ingredientという) データをrichtextbox へ送りたいです。 今のところ、SQLにcommandを送り、開き、リーダーで呼びました。 SqlConnection sc = new SqlConnection(@"........."); SqlCommand cmd; cmd = new SqlCommand ("Select * from ingredients", sc); sc.Open(); SqlDataReader reader = cmd.ExecuteReader(); その後作っておいたクラスでリストを作りストアしました。ingredientにはidとnameだけです。 List<Ingredient> ingredients = new List<Ingredient>(); while (reader.Read()) { 　string testID = reader["id"].ToString(); string ingName = reader["name"].ToString(); Ingredient oneIng = new Ingredient(Convert.ToInt32(testID), ingName); ingredients.Add(oneIng);｝ 今リストの中に情報が入っているということは分ります。でも、これをrichtextboxにどう整理して入れるのかは分りません。教えて下さい！！！
SQL Server 2008 にて下記条件を満たしたデータの取得を行いたいです。 ・IDごとに、日付がある日以前で最新のものとその次の日付のデータ2件 ・ただし、その2件で価格が変わらなければ価格変動のあった日付のデータまでさかのぼる ・価格が同じデータの場合、古い日付のデータを取得 例： ・条件…日付が20040101以前 ＜検索対象データ＞ ID　 日付　　　 価格 ------------------------ 1　　 20000101　　 100 1 　　20010201　　 100 1 　　20020301　　 200 2 　　20020401　　 300 2 　　20000501　 400 2 　　20010601　　 400 2 　　20030701　　 300 3 　　20000801　　 500 3 　　20010901　 600 3 　　20040901　 600 ＜取得したい結果＞ ID　 日付　　　 価格 ------------------------ 1 　　20020301　　 200 1　　 20000101　　 100 2 　　20020401　　 300 2 　　20000501　 400 3 　　20010901　 600 3 　　20000801　　 500 なるべく少ないSelect文で取得したいと考えております。 よろしくお願いします。
SQL2000サーバーから、SQL2005expressへ SQL Server Management Studio Express を使って移行しています その中で、テーブルレイアウトの初期設定について 日付やPC名は、SQL2000と同じ　getdate()　や　host_name()で 設定できたのですが、サーバー名が　@@servername では 「文字列データまたはバイナリデータが切り捨てられます 　ステートメントは終了されました」 とメッセージが出てきて処理できません。 SQLserver2005expressで、サーバー名の規定値についてアドバイスをお願いします
「INSERT ステートメントは FOREIGN KEY 制約 "○○" と競合しています。競合が発生したのは、データベース "△△"、テーブル "dbo.□□", column '◎◎' です。」 SQLサーバーマネジメントスタジオでインサートのクエリを流したところ、下記のエラーが発生したのですが、解決するにはどういった観点を調査すればよろしいでしょうか？ ご存知の方、お願いします。
データ取得時に列番号を組み込みたい場合 ROW_NUMBER() OVER (ORDER BY ソートキー) で実現できますが、これは実際ソートも行ってくれるのでしょうか？ 例えば １） select dt1,dt2, dt3,ROW_NUMBER() OVER (ORDER BY dt1,dt2,dt3) as dt4 from table_1 2) select dt1,dt2, dt3 from table_1 ORDER BY dt1,dt2,dt3 では同じ順序でデータが取得されるのでしょうか？ 簡単にデータを作ってみたところ、同じようなんですが・・・・
Ｃ＃で作成するとき、string 変数にどんどんと長いクエリを書いてしまいがちです。 こういったクエリ文字をデバッグなどで、カットするととんでもなく長い１行の文字列になってしまいます。 それをSQLServer のクエリとして貼り付けると、１行なので何がなんだかわからない状態になります。 それで適当な部分でエンターキーで改行してようやくどんなクエリかわかる状態で辟易しています。 何か適当なプログラムで適当な部分で改行（折り返す？）して全体がわかるように表示する（またはテキストを変換）ようなものってないでしょうか？
項目名：コード varchar (3) を "ALTER TABLE テーブル名 ALTER COLUMN コード varchar (4);"を実行し 項目名：コード varchar (4)へ変更したいと思っています。 そこで質問なんですが現在コード の内容が"001"のような３桁なのですがそれを"0001"のように4桁に変更したいのです。(頭に"0"を追加する。) (一見づつ読んで更新していく方法はわかりますがもう少しスマートに処理がしたいので) どういったSQL文を発行すれば良いのでしょうか？ よろしくお願いします。
SQL SERVER 2012のダウングレード権に関して教えていただきたく。 6コア1CPUのサーバに対し、SQL SERVER 2012を SQL SERVER 2008 R2にダウングレードして使用する場合、 ライセンス形態はどのようになりますでしょうか？ 6コア分のコアライセンスが必要？ SQL SERVER 2008 R2の1CPUライセンスと同等価格の4コアライセンスが必要？
OS　XP　SP3、ACCESS２００３　DBはSQLserver2005express　です SQL　Server Management Studio Express　を使って 新しいDB、テーブル、項目は作成できました。 また同じツールを使って手入力でデータを追記することもできます 質問はこのテーブルを　ACCESSからODBC接続して 追加クエリーを実行したいのですが リンクしてテーブルを開いた時点で新規レコードが追加できない状態です。 サーバーの更新をしたく、少ないデータであれば手入力でも 大量のデータでは…ACCESSのクエリーを使いたいと思っております。 ODBC接続の設定が読み取り専用になっているのか そうであれば　その設定はどこにあるのか　教えてもらえないでしょうか？ 宜しくお願いいたします
いつも大変お世話になっております。 よく分かっていなくて申し訳ありません。 SELECT … FROM Ａ Right Outer Join Ｂ Ｂ on Ｂ.c =Ａ.d 　というようなSQL文で Ｂ.cはvarcharでＡ.dはintです。 Ｂ.cは大多数の場合は数値なので動くのですが、稀に文字列が入ったときにエラーになってしまいます。 ここでエラーにならずに、そこで呼ぼうとしたものがなければNullになるようなよい方法がありましたら、ご教示いただけますと幸いです。 以下の添付画像のような結果を得られると幸いです。
お世話になります。 SQLサーバ2000から、SQLサーバ2008への移行を行っております。 以下のようなSQL文は2000では許容されていたようで、問題なく（？）稼働していただのですが2008に移行したら軒並みエラーになってしまいました。 エラーで稼働確認が進まないので、修正方法を検討しているのですが、まだSQLサーバが使えない環境で確認ができません。 2000が来てから確認する予定ではありますが、以下の通りで新旧・同様のソート順になると考えて問題ございませんでしょうか。 教えていただけると幸甚です。 【例１】 SELECT DISTINCT ISNULL(T1.C1,""),T1.C2 FROM T1 ORDER BY T1.C1 →ORDER BY 項目を　ISNULL（T1.C1,""）に変更 【例2】 SELECT DISTINCT T1.C1,T1.C2 FROM T1 ORDER BY T1.C1,T1.C3 →ORDER BY 項目から　T1.C3　を削除する 以上です。宜しくお願いいたします。
【データベース：SQLServer2005】 SQLのアドバイスを頂きたいです。 【テーブル】 テーブル名：Table1 フィールド名：種類、キー1、キー2 テーブル名：Table2 フィールド名：種類、キー1、キー2 テーブル名：Table3 フィールド名：種類、キー1、キー2 【データ】 Table1 種類、キー1、キー2 001　　AAA　　BBB 001　　AAA　　CCC 001　　AAA　　DDD Table2 種類、キー1、キー2 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　DDD Table3 種類、キー1、キー2 NULL　 AAA　　BBB NULL　 AAA　　CCC NULL　 AAA　　DDD これをUNIONで取得します。 種類、キー1、キー2 001　　AAA　　BBB 001　　AAA　　CCC 001　　AAA　　DDD 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　DDD NULL　 AAA　　BBB NULL　 AAA　　CCC 実現したいのは、 １）同種類、キー1、キー2のデータで、 種類にNULLが含まれていたら、NULLのデータは取得しない ２）同種類、キー1、キー2のデータで、 種類にNULLしかないデータは、取得する 001　　AAA　　BBB 001　　AAA　　CCC 001　　AAA　　DDD 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　DDD　→いる NULL　 AAA　　BBB　→いらない NULL　 AAA　　CCC　→いらない ↓結果 001　　AAA　　CCC 001　　AAA　　DDD 002　　AAA　　BBB 002　　AAA　　CCC NULL　 AAA　　DDD 上記を実現する為、UNION後のSQLでも構わないので、 一発のSQLで取得する事は可能でしょうか？ 有識者の方にご享受頂ければ幸いです。 どうぞ宜しくお願い申し上げます。
SQLServerでOracleのGREATEST関数のような事がしたいです。 具体的に書きますと、 ID | 列1 | 列2 | 列3 | 列4 | 列5 ------------------------------ 01 | 700 | 200 | 300 | 400 | 100 02 | 100 | 800 | 200 | 300 | 200 03 | 100 | 300 | 900 | 100 | 100 という表があった場合に ID | 最大値 ------------------------------ 01 | 700 02 | 800 03 | 900 といった結果を求めたいです。 CASE等を利用するしか方法はないのでしょうか。
Visual C# 2010 Express（WPFアプリケーション）とSQL Server 2012 Expressでツール（データベースアプリケーション）を作成していますが，いまいち作り方を理解しておらず合っているのかわからないので，教えていただきたいです。 作成しているツールは会社の課内で使用します。 最終的には課内サーバーに保存してあるDBファイルに各社員のパソコンから作成したツール経由でDBへ読み書きします。ツールの開発は私のパソコンで行います。 課内サーバはWindowsServer2010でIPアドレスを仮に\\11.22.33.444とします。 各社員のパソコンはWin7でIPアドレスを仮に\\11.22.33.445とします。 なお本文では下記のように略して記載します。 SQL Server 2012 Express：sqlserver SQL Server Management Studio Express 2012：SSMS Visual C# 2010 Express：VC# ■私が行った作成手順 ※サーバで操作 (1)サーバにsqlserverとSSMSをインストール (2)KANAISQLという名前でインスタンスを作成。Windows認証。 (3)SSMSのセキュリティでログインユーザの中に自分のドメインユーザ名を登録 (4)SSMSで「E:\…DATA」の中に：データベースを作成(BOOKDB.mdf)。テーブル「BOOKInfo」を作成。ついでに1レコード作成。 (5)SSMSでBOOKDB.mdfをデタッチ (6)BOOKDB.mdfを「E:\…booksDB」にコピペ ※開発PCで操作 (7)パソコンにVC#，sqlserver，LocalDB，SSMSをインストール (8)SQLEXPRESSという名前でインスタンスを作成。Windows認証。 (9)VC#でWPFアプリケーションを新規作成 (10)[データ]メニューの[新しいデータ ソースの追加]→[データベース]→[データセット]→[\\11.22.33.444\…booksDB\BOOKDB.mdf]を指定→テスト接続を実行→接続OK →「ローカルにデータをコピーしますか？」といった画面で「OK」をクリック (11)データソースナビゲーションパネルから「BOOKInfo」をDataGridを指定してユーザーフォームにドラッグ＆ドロップしてバインド。 (12)デバッグしてみる→正常にレコードが表示された。 (13)Datasetをデザイナーから編集でInsertクエリを作成 (14)ユーザフォームにボタンを追加してInsertクエリとUpdateクエリを実装 (15)デバッグとリビルドしてexeを実行してみる。→ツール上では正常に表示＋テーブル追加された。 (16)DBファイルを確認してみた。開発PC内のデバッグフォルダリリースフォルダ内にある「BOOKDB.mdf」は更新されていた。 ※サーバで操作 (17)サーバの[E:\…booksDB\BOOKDB.mdf]が更新されているか確認してみた。 →更新されていない。(6)の時から変更なし。 ■わからないこと 1．ツールからサーバのDBへデータの変更を反映させるためにはどうしたらよいのでしょうか。 2．またツール完成後に各社員がこのツールを使用する場合は，全員sqlserverとLocalDBをパソコンにインストールしなければならないものなのでしょうか。 詳しい方ご教授御願いいたします。
ＤＢのテーブル定義書に ＰＫの欄があり 名称　　　　　　PK ＸＸＸＸＸＸＸ P1 ＹＹＹＹＹＹＹ P2 ＺＺＺＺＺＺＺ という感じで書かれている場合、 ＸＸＸＸＸＸＸは複数同じ値で存在可能で、 ＸＸＸＸＸＸＸ　＋　ＹＹＹＹＹＹＹ　のフィールドの値が、両方同じデータは存在しないという意味 であっていますか？ つまり １　１ １　２ １　３ ２　１ ２　２ は存在できるが、 １　１ が更に存在できないということですか？
SQL Server 2008 r2 を利用していますが、 利用期限が180日間のため、そろそろ評価版ライセンスが失効しそうな状態です。 Windows Server 2008のように、 正式ライセンスを購入せず、評価版ライセンスを延長する方法は、ありますでしょうか？
お力をお貸しください。 職場の業務で利用する単純なデータベースを、学習を兼ねて作ってみようと思うのですが、初心者なものでまず実現可能かがわかりません。 環境は ・windowsXP,windows7端末が数台（microsoft SQL server 2008がプリイン済） ・DELLのPower edge T-310がサーバーとして１台（ファイルシステムはNTFS） ・サーバーのフルコントロールは（たぶん）上司に連絡すれば可能。 ・それぞれの端末からサーバーが共有できるが、端末同士で互いに繋がることは出来ない。 ・スタンドアロンでのアプリ作成経験は有り。VBかC#．NETで作成予定。 ・SQLは勉強中…Accessは使えます。 構想では、毎日出し入れするデータをサーバーにおいて、アプリを入れたどの端末からでも修正、更新が可能なようにしたいのです。データは小規模で、同時に何人も使用することはありません。 このような場合、まずはSQLserverをサーバーにインストールするのでしょうか？そもそもNTFSにインストールって…？ それとも端末のSQLserver2008があれば、データ保存先でサーバーを選択して、他のPCから同じデータを操作できるものなのでしょうか？ 書籍も読みましたがこの辺がよくわからず（というか基本的すぎて載ってないんでしょうね）馬鹿に解るよう解説してくださるとありがたいです。
SQL Server2005 で開発しています。 Order by で並び替えてレコードをSelectする際に、 Order by の対象列データが同じ場合は、 どういった順番でレコードが取得できるのでしょうか？ TableA No　| Data1 | Data2 　　1| AAA | 100 　　2| AAA | 200 　　3| AAA | 300 　　4| ABC | 400 　　5| BBB | 500 (Noはクラスタ化PK) 例えば、上のようなテーブルから次のSQLを実行すると 　(1)Select * From TableA ; 　(2)Select * From TableA Order by Data1 Asc; 　(3)Select * From TableA Order by Data1 Asc, No Asc; 　(1)(2)(3)全て、次の順で返ってきました。 　　1| AAA | 100 　　2| AAA | 200 　　3| AAA | 300 　　4| ABC | 400 　　5| BBB | 500 　しかし、(2)のSQLは、データによって 　次の順で返ってくることがありました。 　　3| AAA | 300 　　1| AAA | 100 　　2| AAA | 200 　　4| ABC | 400 　　5| BBB | 500 　 　1～3レコード目までは全てData1がAAAのレコードですが 　特に指定していなくても、No（PK）の順になるのかと思っていました。 　 　なお、レコードができた（Insert順）でもなさそうです。 　この、順番は何で決まっているのでしょうか？ 　
SQL server 2005を使っています。 誤ってDrop table ～～を使って必要なテーブルを削除してしまいました。 まだデータの圧縮とかはしていないのですが、 一旦削除したテーブルを元に戻すことは可能でしょうか？
ACCESSデータベースをSQLサーバーへアップサイジングに挑戦しています。 csvファイルの取り込みについて質問させてください。 Accessでは、 DoCmd.TransferText acImportDelim, "○○インポート定義", "○○データ読込", filepath として、インポートしていました。 アップサイズ後、同じようにインポート定義を設定しようと思ったのですが、 ウイザードで設定できないのです。（ 設定ボタンがグレーアウトしている。） それで、インポート定義なしでやってみたところ、 文字列フィールドで"00001"の表記が、すべて0が消えて"1"になってしまいます。 インポート後のテーブルのデータ型も、nvarcherになっているのですが・・ 正しいデータ型でインポートするにはどうすればよいでしょうか？ よろしくお願いいたします。
業務システムから抜き出したaaaa.mdfとaaaa.ldfファイルがあり、これをSQL Server2008R2 Expressをインストールしたパソコンで開くことをトライしています。 しかし、SQL Server Management Studioを起動してテーブルにアタッチしても、「aaaa.mdfはプライマリーデータベースファイルではありません」のエラーが出てしまいます。 必要なのはaaaa.mdf内のテーブルにアクセスできれば良いだけなのですが、どの様にすれば良いのでしょうか。
SqlServerの「インポートおよびエクスポート」ウィザードで エクセルのデータをインポートする時に起こりました。 nvarchar(8) のフィールドに Double型のデータのインポートはうまくいきました。 nvarchar(8) のフィールドに VarChar型のデータのインポートはうまくいきました。 ですが、VarChar型とDouble型が混在しているとタイトルにあるエラーが起こりました。 エクセルで数値データが入っているとインポートウィザードでは勝手にDoubleにするらしく 回避する方法がわかりません。 どうすればいいでしょうか？
知り合いの事務所に頼まれ、不具合を見ることになりました。 現象としては、 　AccessADPファイルにてSQLServerにアクセスしていたのが、 　6/29（土）朝から、特定のPCのみ急にアクセスできなくなった。 というものです。以下に詳細を記します。 -------　動作PCの詳細 ------------ ・稼働PC5台（内、WinXP SP3（homeとPro混在)が4台、Win7が1台）の共通設定 　 　同じワークグループに設定。それぞれのPCに同じユーザーアカウントとパスワード設定 　IPアドレスはルーターのDHCP機能で自動割り当て 　すべてウィルスバスタービジネスセキュリティーがインストール済み ・SQLServer2005 Express が稼働しているPC 　Win XP SP3 Pro(32bit) 　「簡易ファイルの共有」機能はOFF 　共有ファイルは共有の有効化、アクセス許可、セキュリティー許可をそれぞれ登録 　 SQLServer は　Windows認証方式 　TCP/IPおよび名前付きパイプを使用する構成。 ネットワークアクセス許可 　（TCP/IPは1433固定）SQL Browserも自動起動設定。 WindowsのファイヤーウォールにSQLSrver、TCP1433　UDP1434　例外登録　 　SQLServer ManagementStudio Expressで 　ログインユーザーとデータベースアクセス許可を、ビルトイングループ単位で与えてある Hostsファイルの値は 「127.0.0.1」 ・問題のPC Win7 SP1 Pro(64bit) Office 2010Pro(32bit版をインストール） ワークグループ設定。ホームワークの設定はせず、社内ネットワークプロファイルで構成 　共有の有効化。 Hostsファイルの値が　 　　＃ 127.0.0.1 になっていたので、＃を取り除き上書き保存。 ---------------------　 調べてみたところ、問題のPC以外からは問題なくつながり、読み込み書き込み共にOKでした。 Administoratorでなくても、User権限の人でも問題なくつながります。 しかし、Win７マシンからだけなぜか急につながらなくなったとの事です。　 特定のユーザーではなく、特定のPCだけの現象です。ユーザーを変えてみても、 問題のPCからだけ、なぜかつながりません。 ADPファイルを新規作成し、サーバーに接続する段階ではサーバー名が出るものの、 　「信頼関係が…」うんぬん言われてつながりませんでした。 各PCのファイヤーウォールやWindowsDefenderをOFFにしてもダメでした。 そこで管理ツールのODBCでやってみたところ、次のようなメッセージが出ました。 　（ODBCは32bit版、64bit版共に試しました。） ---------------------------------------------- 接続できませんでした。 ; SQLState: '28000' SQL Server エラー: 18452 [Microsoft][ODBC SQL Server Driver][SQL Server]ユーザー '' は ログインできませんでした。このユーザーは SQL Srver の信頼関係 接続と関連付けられていません。 ----------------------------------------------- 不思議なのは、表示のユーザーのところが ''　になっている事です。 通常ここのところには 'マシン名\ユーザー名'　のような形で表示されると思うのですが…。 また、違うユーザーで同じ事をしてみたところ、今度は、ユーザー名のところに 意味不明な数字の羅列が表示されていました。 　（あとから思えば、SIDを表示してたのかもしれません。） そこで、そもそもファイルの共有事自体は出来るのか、試してみました。 結果、こちらにも問題がありました。 他のPCから問題のPCの共有フォルダへのアクセスはOKなのですが、 問題のPCから他のPCの共有フォルダを開こうとすると、 　「ユーザー名」「パスワード」 を聞いてくるダイアログが表示され、入力しても入れないPCがありました。 因みに、入れないPCの「簡易ファイルの共有」をONにすると問題なく入れますが、 これは単にGuest扱いを受けているだけだと思います。 　　　 以上からの推測ですが、SQLServerの稼働しているPCが問題のPCを正しく評価できない為に、 ユーザーが'(null)'のような形になっているのではないかとおもいました。 それで、ユーザー認証周りを見直し、グル―プだけでなく、ユーザー単位でもアクセス許可を設定 したり、新たにユーザーを作成したりして見たのですが、やはり問題のPCのみつながりません。 ファイルの共有に関しても、新たに共有設定をしてみたのですが、やはり問題のPCのみつながりません。 SQLServerの問題というよりも、PC自体の問題のように見えます。 正直なところ、Windows7はあまり使ったことがない為、行き詰まってしまいました。 素人考えでは、問題のマシン名とユーザー名が正しく正しく伝わっていない事が原因だと思うのです。 そもそも、なぜそのような事態になったのかがわからず、困っています。 「昨日までは問題なく使えていた」との事で、思い当たる節がありません。 担当していた人が退職された為、代わりに見ているのですが、 正直再インストールの方が早いのではとすら思ってしまいます。 ほかに何か見落としているところがないでしょうか。 また、対処法のヒントとなる事がありましたら教えて頂きたいと思います。 よろしくお願いします。
間違えて削除してしまったので再投稿します。 このたび、SQLServer2005SP2でレプリケーションを実装しようと思っています。 構成はこのように考えています。 Server１（プライマリサーバ）：パブリッシャ SQLServer2005 SP2 Server２（セカンダリサーバ）：ディストリビュータ＆サブスクライバ 間違えて削除してしまったので再度投稿します。 SQLServer2005 SP2 Server1とServer２のＤＢ、TABLE構成は同じです。 設定方法についていろいろ調べているのですが、どうもこれでよいかと確信がもてません。 どなたか設定方法をご教授お願い致します。 今回の構成に近い設定方法が載ったページなどがあれば合わせて教えてください。 また、Server1は更新用アプリが使用、Server２は参照用アプリが使用などといったことはできるのでしょうか？
お世話になってます。 あるサーバー（サーバーA）上のSQLServer7.0で作成したバックアップファイルを 復元先のサーバー（サーバーB）に復元したところ、MDFファイルが3GBに対し、 LDFファイルが100GBありました。 LDFファイルのサイズを圧縮しようと、SQLServer7.0のメニューで、 　 　1. フルバックアップ 　2. トランザクションログの切り捨て 　3. 圧縮 　※以下「1.」、「2.」、「3.」を何度か繰り返し。 を行ってみましたが、300MB程度減っただけで、それ以上は小さくなりませんでした。 　SHRINKDATABASE 　や 　TRUNCATE も試してみましたが、サイズ、変わりませんでした。 他に試すことはありますでしょうか？
添付画像のようなテーブルがあります。 製品IDと販売店でユニークです。 製品毎に、最安の価格で売っている店を一覧として 出したいのですが、うまくいかず困っています。 表示としては TEST1　100　A店 TEST2　300　C店 というようにしたいのです。 また、もし最安の店舗が複数あれば、登録日が一番新しい店を 最安店舗としたいです。 製品IDでGroupByをして、価格のminで、製品毎の最安はとれるんですが、 最安の店舗が複数ある場合に困っています。 サブクエリで登録日でソートしてTOP1とかになるのでしょうか。 冗長で重いクエリになってしまい、実用に耐えず、困っています。 うまい取り方があったらご教授いただけないでしょうか。 よろしくお願いします。
SQL Server 2008 R2のINNER JOINについて質問させて下さい。 ------------------------------ SELECT * FROM [Customer] 　　　INNER JOIN Pref 　　　　　　ON Customer.CustomerPref1 = Pref.PrefId 　　　　　　ON Customer.CustomerPref2 = Pref.PrefId 　　　　　　ON Customer.CustomerPref3 = Pref.PrefId WHERE ([CustomerId] = 123) ------------------------------ 3つもONがあって変なSQL文となっております。 (当然SQLエラーとなります。) やりたい事は、 顧客フォーム[Customer]の中に、都道府県をプルダウン選択する項目が3つあります。 3つとも都道府県マスタテーブルをリレーション(FK)しております。 3つの都道府県項目で「都道府県名」をそれぞれSELECTするには、 どうしたらよいでしょうか? ご教授頂けますようお願い申し上げます。 ------------------ ▼DB情報 顧客情報テーブル：Customer 顧客ID：CustomerId 都道府県カラム1：CustomerPref1(1,2,3,～などの値が格納) 都道府県カラム2：CustomerPref2(1,2,3,～などの値が格納) 都道府県カラム3：CustomerPref3(1,2,3,～などの値が格納) 都道府県マスタテーブル：Pref 都道府県ID：PrefId(1, 2, 3,～などの値が格納) 都道府県名：PrefName(1:北海道, 2:青森県, 3:岩手県～などの値が格納)
皆様にはいつもお世話になっており、誠に感謝しております。 一発で結果が分かるSQL文があれば、ご享受願いたいのです。 下記の様なテーブルがあります。 F_No　F_Kaisu　F_Memo 001　　1　　　　メモ 001　　2 001　　2　　　　ああ 001　　4　　　　いい 001　　4　　　　 002　　1　　　　かか 002　　2　　　　きき 002　　3　　　　くく 003　　1　　　　AA 003　　2 003　　2　　　　BB 003　　3　　　　CC F_Memoに値が入っているレコードが対象であり、 F_Kaisuが数字の順番になっていないF_Noを抜き出したいのです。 上記で云えば、 F_Noの001は、 F_No　F_Kaisu　F_Memo 001　　1　　　　メモ 001　　2　　　　ああ 001　　4　　　　いい であり、F_Kaisuが数字の順番にはなっていないので、 001をヒット！ F_Noの002は、 F_No　F_Kaisu　F_Memo 002　　1　　　　かか 002　　2　　　　きき 002　　3　　　　くく であり、F_Kaisuが順番なので、 002はスルー！ F_Noの003は、 F_No　F_Kaisu　F_Memo 003　　1　　　　AA 003　　2　　　　BB 003　　3CC であり、F_Kaisuが順番なので、 003はスルー！ 結果、F_Noの001を取得したいのです。 SQL一発で実行する事は可能でしょうか？ もし可能ならば、SQL文のご享受をどうぞ宜しくお願い申し上げます。
お世話になります。 下記のテーブルから下記の条件で データを出力するSQL文を作成したいのです。 アドバイスお願い致します。 条件１：NAMEはAを抽出 条件２：ICHIはグループ集計 条件３：ITEMはD2とD3を抽出 TESTテーブル NAME ICHI ITEM DATA ----- ---- ---- ---- A A1 D1 1 A A1 D2 2 A A1 D3 3 A A1 D4 4 A A2 D1 10 A A2 D2 20 A A2 D3 30 A A2 D4 40 B A3 D1 100 B A3 D2 200 B A3 D3 300 B A3 D4 400 データ出力結果 NAME ICHI DATA DATA ----- ---- ---- ---- A A1 2 3 A A2 20 30
ID、name、seibetuという列を持つ、membersというテーブルがあり、INSERT文を実行してテーブルに値を入れたいと考えています。 IDがIs IDENTITYの値がTRUEになっている列で、NOT NULLです。 以下のクエリを実行したところ、IDにNULLが入るといったエラーが起きます。 SET IDENTITY_INSERT members ON INSERT INTO members (seibetu, name, ID) VALUES ('男', 'すずき', @@IDENTITY) 何か問題があるのでしょうか？ お分かりの方いらっしゃいましたらよろしくお願いします。
言語：C# DB：SQLServer2008 １．トランザクション開始 ２．テーブルAをUPDATE ３．色々な処理(省略) ４．テーブルＡのUPDATE前の情報を参照 ５．参照したテーブルをもとにテーブルBをUPDATE ６．すべての処理が正常だったら全テーブルコミット、１つでも失敗したら全テーブルロールバック 問題となっているのは ４．テーブルＡのUPDATE前の情報を参照する際に、テーブルAがロックされていて参照出来ないことです。 トランザクション開始時に分離レベルを設定してみましたが同じ結果でした。 ｔran = con.BeginTransaction(分離レベル); お分かりになる方ご教授お願いします。
いつもありがとうございます。 質問させて下さい。 以下のテーブルより、S1が同値で、Codeに1と0が混じっている場合、SQLでS1を取得したいのです。 NoS1Code 13001 23011 33000 43010 53021 63020 73021 83030 93041 103050 113050 （Noはキー） 望む結果 S1 300 301 302 どういうSQLを組めば実現可能なのでしょうか？ 有識者の方、ご享受宜しくお願い申し上げます。 ※VBA等プログラミングが入っても問題ありません
phpでサイト構築を考えておりますが、データベースをmysqlかpostgresか、マイクロソフトのSQLサーバのどちらが早いのか検討しています 一日のデータの件数を5万件入れて、そのデータをselect、insert、updateなどするときに mysqlかpostgresのマイクロソフトのSQLサーバのどちらが早いのか、良くわからなくて、皆様の知恵をお借りしたいです。 シンプルに、データの件数での処理の速さで考えております。 例えば、10万件のデータをinsertする 10万件のデータを、updateする 10万件のデータを、登録する あと、どの程度データを各データベースに入れると重くなってしまうものなのか・・・ 宜しくお願い致します
SQLで調和平均（もどき）を計算したいのですが、下のようなSQL文で計算した結果が正しく出ないのです。 select ID, 3 / ((1 / (A1 + 1) + 1 / (B1 + 1)) + 1 / (C1 + 1)) as HARMEAN from TABLE （各項に１を足しているのは、ゼロ除算を避けるための苦肉の策です） たとえば、A1=20, B1=10, C1=50 の場合、上記の結果が27.14と出ます。 （正しい計算結果は18.97のはずです） ちなみに、上とまったく同じ式をExcelに入れて計算させると、ちゃんと正しい結果が出ます。 何が原因なのでしょうか？
１つのテーブルの１つのレコード内に、以下のような複数のBooleanデータがあって、trueがいくつあるかを数えたいのですが、１つのSQLで記述できるでしょうか？ ID　data1　data2　data3　data4　... 1　　true　　false　　true　　false　...
いつも助けてもらってます。 皆様ありがとうございます。 以下の内容で１つのテーブルを更新するクエリを作りたいのですが、どうしたら良いでしょうか？ 本見て自力で考えれば良いんでしょうが、、、、よろしくお願いします。 １つのテーブル、「A」があるとしまして、その中には会員Noや、SEQ、Point、Point2といった 列があります。 １つの会員Noに、３つの行、SEQ１～３が必ずあります。 更新したい行はSEQ１だけです。 Pointは整数で、Point2は小数点第一位までの表記です。 テーブルＡ 会員Ｎｏ　　SEQ　　　Point 　 Point2 1001　　　　　1　　　　　20 　　 99.0 1001　　　　　2　　　　　30 　　 99.0 1001　　　　　3　　　　　50 　　 15.5 1002　　　　　1　　　　　99 　　 10.2 1002　　　　　2　　　　　99 　　 21.6 1002　　　　　3　　　　　99　 　　 10.0 やりたい事は、 SEQ1の中で、 Pointが99以外でPoint2が99.0なら、Point2へPointの数値を移したい。 Pointが99でPoint2が99.0以外なら、PointへPoint2の四捨五入した数値を移したい。 要するに、SEQ１のPoint,Point2、片方だけ99、という現状がマズイので直したい。 という内容です。 会員Ｎｏ　　SEQ　　　Point 　 Point2 1001　　　　　1　　　　　20 　　 20.0 ←更新 1001　　　　　2　　　　　30 　　 99.0 1001　　　　　3　　　　　50 　　 15.5 1002　　　　　1　　　　　10 　　 10.2　　←更新 1002　　　　　2　　　　　99 　　 21.6 1002　　　　　3　　　　　99　 　　 10.0 上記の様になれば、、と思います。 何卒ご指南くださいませ。
小中学校向けの校務支援システムの開発を手掛けおります。 そこで世代管理する為のデータベース設計について、ご教授ください。 主には、「生徒名簿」を軸として「出席簿」「教科」「成績表」「通信表」「健康カード」などを扱う校務システムです。 その各レコードを、「小中9年間」＋「その後保存期間5年間」のレコードを保持しなくてはなりません。 以下その例となります。 ▼生徒名簿A君 --------------------- 学年　 |レコード数 | 小学1年生| 1レコード | 小学2年生| 2レコード | 小学3年生| 3レコード | 小学4年生| 4レコード | 小学5年生| 5レコード | 小学6年生| 6レコード | 中学1年生| 7レコード | 中学2年生| 8レコード | 中学3年生| 9レコード | 卒業1年目|10レコード| 卒業2年目|11レコード| 卒業3年目|12レコード| 卒業4年目|13レコード| 卒業5年目|14レコード| --------------------- ※上記のようにデータ保存として年毎にレコードが増幅します。 ※このテーブルに紐づく色んな情報も同様にレコードの世代管理が必要となります。 この世代管理をどう設計すべきか悩んでいます。 自分なりに以下のような手法をイメージしております。 （案1）過去レコード(OFFフラグ)、現在のレコード(ONフラグ)のように「フラグ」で識別する。 （案2）「タイムスタンプ」で該当するレコードを識別する。 （案3）過去レコードは「別データベース化」するなど分離をする。 （案4）「SQL Server 2008 R2」でのこういった機能がある？(SQL Serverは初経験でわかっておりません) どういった世代管理手法がありますでしょうか？ 参考とさせて頂きたいです。お願いいたします。 --------------------- ▼開発環境 ・SQL Server 2008 R2 ・NetFlamework4.0 ・Microsoft Visual Studio 2010 ・C# ・InternetExplorerのみに対応のWebアプリ --------------------- 尚、本来は自分や会社として解決すべき問題の質問で大変申し訳ありません。 指の数ほどの人数のインフラ会社で、システム開発の経験が無い会社でして、 転職して1カ月目の私が全て背負っております。 (そこを期待されて雇われたのですが。) 何卒よろしくお願いいたします。
TRY CATCHをネストさせた状態で、 テーブルがドロップされていることを検知するにはどうすればよいでしょうか？ BEGIN TRY 　　★ 　　BEGIN TRY 　　　　▲ 　　END TRY 　　BEGIN CATCH 　　END CATCH CATCH END CATCH としているときに、 ★の位置だとテーブルのドロップはCATCH できるのですが ▲の位置だとテーブルのドロップはCATCH できないようですが、 テーブルがドロップされていることを検知するにはどうすればよいでしょうか？
EXEC sp_MSforeachdb @command1= "use ? DBCC SHOWCONTIG WITH FAST,TABLERESULTS" 上記のsqlが毎月実行されています。 インデックスの断片化を解消するコマンドだと 聞いたことがあるのですが、それぞれの意味が良く分かりません。 何か情報があるかたお願いします。
いつも皆様に助けていただいてます。 過去に色々聞いているものの、なかなか応用が利かず・・・今回もご支援下さい。 ＳＱＬ2008に、１つのＤＢを作っていて、その中にテーブルＡとテーブルＢがあります。 テーブルAには、１つの会員Noにつき3つのSEQ１～３の行があって、それぞれにポイント数が入ってます。 テーブルＡ 会員Ｎｏ　　SEQ　　　Point 1001　　　　　1　　　　　20 1001　　　　　2　　　　　30 1001　　　　　3　　　　　50 1002　　　　　1　　　　　15 1002　　　　　2　　　　　10 1002　　　　　3　　　　　 0　 テーブルBには、１つの会員につき最大10個のSEQが付きますが、今は殆どカラッポです。 テーブルB 会員No　　SEQ　　Rank 1001　　　　1　　　　5 1002　　　　1　　　　5 やりたいことは、テーブルAのSEQ１のポイント数が99以外なら、テーブルBに テーブルAの「会員NO」、SEQ「7」、Rank「1」　の行を挿入したいです。 クエリ実行後のテーブルB 会員No　　SEQ　　Rank 1001　　　　1　　　　5 1001　　　　7　　　　1 1002　　　　1　　　　5 1002　　　　7　　　　1 テーブルAのSEQ１のPointが99以外なら、テーブルBに「会員No」とSEQ「7」　とRank「1」を挿入、という概要です。 クエリで可能でしょうか？ 先ずは自力である程度やってみるのが筋なんでしょうが、時間が無いので聞いてしまいます。 何卒よろしくお願いします。
WHERE句にて「30日前から今日まで」の設定方法 今まで、下記の通り記述していました。 WHERE M_DATE >= '2012-03-21 00:00:00.000' AND M_DATE <= '2012-04-20 23:59:59.000' 日付部分を毎回変更するのが面倒なので、エクセルのTODAY関数のようなものがないかと探したところ、GETDATE関数を見つけ、下記の通り変更してみました。 WHERE M_DATE >= dateadd(d,-30, getdate()) AND M_DATE <= getdate() しかし、時間部分が現在の時間になってしまうのですね。「今日まで」部分は、現在時刻で問題ないのですが、「30日前から」の部分は、0時0分0秒としたいのです。 どうしたらいいでしょうか？ よろしくお願いします。
xp_fileexistsを使わずにファイルの存在チェックはできないでしょうか？
ｎ件のデータを (1)SELECT INSERTで処理するのと、 (2)SELECT文をカーソルループにして１件ずつINSERTするのでは 処理時間は結構違うのでしょうか？ 手元に実行環境がないためご存知の方がいらっしゃったらご教授下さい。 （SQLSERVERかORACLEかなどは問いませんので）
SQLServer2005 Workgroup Editionの設定されたサーバがあるのですが、 CAL数を確認する方法はあるのでしょうか。 また、将来的にCALの追加をする場合に 設定する場所も見当たらないのですが、 ご存知の方はいますでしょうか。 また、SQLServer2008 Workgroup Editionの場合は どうなのかも知りたいです。
弱小企業でAccessを利用していましたが、Accessは限界に近づいてきました。 そこで、SQL Serverを購入したいと思うのですが、ネットで見てもどこで購入すればいいかわかりません。 大きい家電屋も近くにないので、どうやれば購入できるのか知りたいと思います。使いたいのはsql server 2008 R2 standardで3人のユーザーが使う事を想定しています。 VBでアプリをつくり、アプリを3台のPCに入れて、そこからsql serverに接続したいと思っています。 どこで購入できるのか御教えて下さい。よろしくおねがいします。
システムの改修をしています。 新規テーブル、SERVER_CHECK を作成しました。 このテーブルにアクセスすると、下記エラーが発生します。 ===== Microsoft OLE DB Provider for ODBC Drivers エラー '80040e37' [Microsoft][ODBC SQL Server Driver][SQL Server]オブジェクト名 'SERVER_CHECK' が無効です。 ===== 既存のテーブルにはちゃんとアクセスできます。 'SERVER_CHECK' の名前も管理ツールからコピー&ペーストしたので、間違っていません。 SQL Server Management Studio からは結果を出力できます。 プログラムからアクセスするとエラーになります。 ===== Set conServer = ConnectDB() SQL = "SELECT * FROM SERVER_CHECK" 'SQL = "SELECT * FROM PLAN_DB" こちらは正しく出力を得られます。 Set dbServer = conServer.Execute(SQL) ===== どこかの設定が間違っていると思うのですが、見当がつきません。 どなたかご教示よろしくお願いします。
ORACLEでいうCREATE TABLE SPACE のようなものはないでしょうか？ １．CREATE TABLE SPACEを知りたいです ２．CREATE TABLE文で、デタレコードにはどの表領域を使って、インデックスにはどの表領域を使うか？を指定する構文を知りたいです。
「SELECT文の件数」と、 「同じSELECT文を使ったDELETE文の件数」が一致しない現象が起き、困っています。 【SELECT文】※２件返ってきます。 SELECT 　　a.部署コード, 　　a.社員コード FROM 　　社員マスタ a， 　　組織マスタ b WHERE 　　a.部署コード = b.部署コード 【DELETE文】※５０件 DELETEされます。 DELETE TABLE 　　社員マスタ WHERE 　　EXISTS 　　( 　　SELECT 　　　　a.部署コード, 　　　　a.社員コード 　　FROM 　　　　社員マスタ a， 　　　　組織マスタ b 　　WHERE 　　　　a.部署コード = b.部署コード 　　) 環境はSQLSERVER2005です。 件数はSQLSERVER2005のカウントオプションで表示されているものなので間違いないです。 宜しくお願いします。
SQL Server 2008を使用したシステムがあるのですが、複数の端末からアクセスする為、処理が遅くなったりして困っています。 そこで、高速化を図る為、色々と調べていたら、tempdbファイルのサイズを増やす、及びtempdbファイルをCPUのコア数分に増やすと良いというのを見付けました。 が、tempdbの適切なサイズを調べる方法が、いまいちよく分かりません。 どなたか、分かり易く助言して頂けると助かります。 OS：Windows 2008 Server DB：SQL Server 2008 Workgroup 　　　よければ、SQL Server 2008 Expressの場合も 以上、よろしくお願い致します。
ManagementStudioでストアドプロシージャの開発をしています 開発中、デバッグのためにプロシージャをコールすると、ＳＱＬの発行の度に 「何件処理されました。」 「何件処理されました。」 「何件処理されました。」 「何件処理されました。」 「何件処理されました。」 ・・・ と処理件数が表示され、確認の際に邪魔で困っています。 処理件数を非表示にするにはどうすれば良いでしょうか？ また同様に、SELECT文の発行ごとにSELECT結果がグリッドに表示されるのを非表示にできないでしょうか？
【環境】 　OS : Windows Server Standard 2008 SP1 バックアップソフト : Symantec System Recovery 2011 Server Edition　（以下SSR） DBMS : MS SQL Standard Edition 2008 【背景】 SSRを使用してシステム部分（Cドライブ）や、ユーザデータのバックアップ（フォルダ単位）をしようとしています。 その際、静止点をとるために、バックアップ前後にDBMSの停止/開始を入れたいです。 そこで「バックアップ中のコマンドファイルの実行」機能を使おうとしています。 この機能ではSSRのジョブ実行中に以下の3つの段階でコマンドファイルを実行できます。 　１．スナップショット作成前に実行 　２．スナップショット作成後に実行 　３．リカバリポイント作成後に実行 今回は、 １．にDBMSの停止スクリプト、２．にDBMSの開始スクリプトを実行しようとしています。 【質問】 Q1) 上記の【背景】に書いた内容は妥当でしょうか？ Q2) １．のスナップショット作成前にDBMSを停止する際、停止処理が完了したあとにスナップショットを取得するようSSRが内部で制御してくれるのでしょうか？ 停止スクリプト実行と同時にスナップショット取得が開始されるのでは？という疑問を抱いています。 よろしくお願いします。
約５年ほど前に開発されたＤＢを使用したシステムがあるのですが、サーバＰＣが故障し、ＰＣとＤＢを更新しました。それから「タイムアウト」や「デッドロックエラー」が発生するようになりました。 【更新前】 １．サーバ 　・ＯＳ：Windows2000Server 　・DB：MSDE2000 SP3 ２．クライアント 　・ＯＳ：Windows XP SP3（導入当初は、Windows2000） 　・アプリケーション：VC++6.0にて開発 　・７クライアント 　・ODBCにて接続 【更新後】 １．サーバ 　・ＯＳ：Windows Server 2008 　・DB：SQL Server 2008 Express Edition ２．クライアント 　・ＯＳ：Windows XP SP3（導入当初は、Windows2000） 　・アプリケーション：VC++6.0にて開発 　・７クライアント 　・ODBCにて接続 　※クライアント側は何も変わっていません。 発生するエラーは、以下の２つです。 (1)タイムアウトしました。 (2)トランザクション(プロセスID○○)が、ロック 個のリソースで他のプロセスとデッドロックして、このトランザクションの対象となりました。トランザクションを再実行して下さい。 サーバＰＣが故障した際、蓄積されていたデータをかなり削除した為、早くなる事はあっても、遅くなる？とは夢にも思いませんでした。当然、更新後のＰＣも５年前よりかなり早くなっているハズですし．．．。 営業からは、早くなんとかして欲しいと言われますが、未だに解決の糸口が見付かりません。 どなたか助言をお願い致します。
いつもお世話になります。 以下のデータ構造において、以下の条件にあてはまるレコードを 取得するにはどのようなSQLになりますでしょうか。 (1)同一のコード、区分において、有効期間開始日が最新のもの (2)同一のコード、区分、有効期間開始日において、有効期間終了日が最新のもの 【テーブル】 ※主キー：コード、区分、有効期間開始日、有効期間終了日 コード　区分　有効期間開始日　有効期間終了日　名前 10000　A01　19800101　99991231　名称１ 10000　A01　20000101　99991231　名称２ 20000　A01　19800101　19991231　名称３ 30000　C01　19800101　19991231　名称４ 30000　C01　19800101　99991231　名称５ 30000　B01　20000101　99991231　名称６ 40000　D01　19800101　99991231　名称７ 40000　D01　20000101　20201231　名称８ ↓ 【取得結果】 10000　A01　20000101　99991231　名称２ 20000　A01　19800101　19991231　名称３ 30000　C01　19800101　99991231　名称５ 30000　B01　20000101　99991231　名称６ 40000　D01　20000101　20201231　名称８ ようするに、最新データの名前のデータを取得したいのですが、その最新の 定義が上記にあげたものになります。 連続投稿になってしまい申し訳ないのですが、どうしてもスマートな SQLを思いつかず、皆様のお知恵をお借りしたいと思った次第です。 宜しくお願いします。
いつもお世話になります。 以下のデータ構成で、区分に「A01」「D01」のいづれかが含まれているコードは 取得しないようにしたいのですが、これを、SQLのみで実現するためにはどのように すればよいでしょうか。 【テーブル】 コード　区分 10000　　A01 10000　　B01 10000　　C01 20000　　C01 20000　　D01 30000　　B01 30000　　E01 40000　　B01 40000　　E01 40000　　F01 ↓ 【結果】 30000 40000 ※コード10000はA01が含まれており、20000はD01が含まれているため対象外 普通のプログラムならば、全て取得してきて、ループしながら該当する区分の場合は continueするなりしてはじけばい、というように想像できるのですが、SQLのみでやるということで、 ループ処理は行えないためどうしてもスマートな方法が思いつきません。 何かよい方法はないでしょうか。 宜しくお願いします。
Microsoft　SQL Server Management Studio 2008 にて、クエリを作成しています。 下記の入金テーブルがあります。 入金日　 顧客ID　　入金額 2012/2/1　 0010 10000 2012/2/2 0010 10000 2012/2/3　 0010 10000 2012/2/4　 0010 10000 2012/2/5　 0020 10000 2012/2/6　 0020 10000 2012/2/7　 0020 10000 2012/2/8　 0030 10000 2012/2/9　 0030 10000 このテーブルから１か月単位で3回以上の入金をした顧客の 明細（上記3項目）を表示したいのです。 上記の例だと、実現したい結果は下記となります。 入金日　 顧客ID　　入金額 2012/2/1　 0010 10000 2012/2/2 0010 10000 2012/2/3　 0010 10000 2012/2/4　 0010 10000 2012/2/5　 0020 10000 2012/2/6　 0020 10000 2012/2/7　 0020 10000 とりあえず、入金回数別の入金件数だけを出すクエリは成功しました。 SELECT cnt, count(*) from (select 入金テーブル.顧客ID,COUNT(*)cnt FROM 入金テーブル WHERE 入金テーブル.入金日 >= '2012-02-01 00:00:00.000' AND 入金テーブル.入金日 <= '2012-02-29 23:59:59.000' group by 入金テーブル.入金日) aaa group by cnt order by cnt しかし、 1. 明細を出すところ 2. 3回以上の入金という条件指定ができない 上記2点でつまづいています。 どなたかご教示いただけると、大変助かります。 夜も眠れません。。。
複雑な勘定系システムで使用されるSQLServer2008R2のデータベースを構築をすることになりました。現在HDDの選定をしている段階です。DBの必要ディスクサイズが分からず苦戦しております。 勘定系システムが複雑なもので、仕様を把握している人員がおらず、１伝票データを投入した際のデータサイズを測定するのに、関連するテーブルを全て洗い出し、全カラムごとのサイズをもとに計算ということができません。 ある伝票データを登録したさいのデータサイズを測るために、1万件のデータを投入した際のデータサイズを測り、それをもとにざっくりとした必要サイズを計算しようと考えました。 しかし、データ投入後DBのサイズは変更されません。 DBの自動拡張設定はMDFもLDFも１MBごとに自動拡張としています。 試しに２MBのテキストファイルを投入しましたが、それでもDBのサイズは変わりません。 確認の仕方は、ManagementStudioのDBメニューであるレポートからディスク使用量を表示して確認、およびエクスプローラからMDF、LDFファイルのサイズを目視確認です。 サイズが変わらないのは自動拡張の設定に誤りがあるからでしょうか？ お分かりになる方がいらっしゃいましたらご教示いただきたく。
Left　Joinについて select * From shohin left join meisho on sh03 = me02 and me01 = 1 where **** select * From shohin left join meisho on sh03 = me02 where me01 = 1 left joinの中に me01 = 1があるパターンとwhere句に　me01 = 1 があるパターンで検索結果が変わってくる具体的にどう変わるのでしょうか 良く理解ができていないので教えてください
TRANSACT-SQLで下記のような処理を記述したとき、 (1)～(3)で起きたシステムエラーの検知はCATCHで共通的に行えますか？ TRY 　SELECT処理 　↓ 　エラー発生(1) 　↓ 　INSERT処理 　↓ 　エラー発生(2) 　↓ 　UPDATE処理 　↓ 　エラー発生(3) CATCH 　GOTO 異常終了処理 END COMMIT ：異常終了定義 ログ出力（エラーメッセージ） ロールバック ※エラー処理は、テーブルがDROPされていた、ディスクが破損したなどの通常は発生しないエラーが起きた場合を想定しています。 ※エラーメッセージはステートメントが最終の処理の結果を持ってくれていて、その取得方法があると思っています。 もし実現できなかったり、実現出来たとしても問題があるようであればご指摘頂きたく存じます。
一ヶ月分のカレンダーがあり 営業日には１がたっているテーブルがあります 営業日営業日フラグ実営業経過日数 2012/02/0111 2012/02/0212 2012/02/0302 2012/02/0402 2012/02/0513 2012/02/0614 2012/02/0715 2012/02/0805 上記のように実営業経過日数をクエリで抽出したいのですが どのようにサブクエリを作成したらいいのか教えてください
SQLServer2008R2　ExpressのデーターベースへAccess2010を使ってアクセスし、帳票を作成する事になりました。 使用している業務パッケージがSQLServerを使っていて、それで出てこない帳票をAccessかExcelで 作るように言われました。 私は、Access同志のテーブルリンクは使った事があるのですが、SQLServerへのテーブルリンクは始めてです。SQLServerは運用のために本で勉強した程度です。 色々調べてみたのですがよくわからないので、ご存知の方お願いします。 AccessとSQLServerは同じパソコンの中に置く予定です。 業務パッケージで使っているパソコンは1日中入力に使われていて同じパソコンをAccessの開発用に使用することができません。 業務パッケージのデータベースは、オフラインバックアップしているので、Accessでの開発用の 環境に移せそうな気がしますが ODBC経由でSQLServerをテーブルリンクする場合、データソースを作る時に サーバー名とかユーザ名とかを指定するので、Accessを開発環境から運用環境に移行した時の手直しがどの程度必要なのかがよくわかりません。 現在の業務の関係上、サーバー名を同じにした環境を作成することもできません。 業務パッケージを作った所も今はもう無いし、社内に詳しい人はいないので困ってしまいました。 あまり具体的に書けずに申し訳ありませんが、 上記環境で運用環境に移行出来るものか否かと SQLServer　・　Access作成時の注意点・などありましたら教えてください。 よろしくお願いいたします。
SQLServer2005 Workgroup を使っています。 500万行ぐらいあるテーブルがあるのですが update テーブル名 set 列=～～ where ～～～ update テーブル名 set 列=～～ where ～～～ update テーブル名 set 列=～～ where ～～～ update テーブル名 set 列=～～ where ～～～ というプログラムを実行したところ、10時間経っても計算結果が終わらない為、 一旦キャンセルをしました。 ところが「クエリをキャンセルしてます」というメッセージが流れたまま キャンセル後、10時間経過しても終了してくれません。 この状態で新たにクエリを作ってプログラムを実行してもものすごく処理が重いです。 キャンセルによってデータを元に戻そうとしているのかどうか分りませんが 元に戻さなくていいので強制的に終了する方法はないでしょうか？
SQLServer2008を使用して、 UPDATEの更新前と更新後の差分を出そうとしているのですが、 更新前の値が取れません。 更新後の値はOUTPUT句を使用してINSERTED.XXXでとっています。 更新前の値もOUTPUT句を使用してDELETED.XXXでとれるのかと思い試したら INSERTED.XXXと同じ値(更新後の値)が取れてしまいました。 selectをしずに、更新前の値を取得する方法はありますでしょうか？ ご存知の方ご教授お願いいたします。
初歩的な質問で大変恐縮ですが、ご教授願います。 以下の二つのテーブルがある場合、１回のSQLで削除する方法を教えてください。 ＜Aテーブル＞ --------------- ID 削除フラグ A 0 B 1 C 0 D 1 E 0 E 0 E 0 F 1 F 0 F 1 G 1 G 1 G 1 ＜Bテーブル＞ ID ----- A B E F G ＜削除後のAテーブル＞ --------------- ID 削除フラグ A 0 C 0 D 1 E 0 E 0 E 0 F 1 F 0 F 1 ※Aは削除フラグが0のため削除されない。 ※C,DはIDが一致しないため削除されない。 ※E,Fは削除フラグが全て1でないため削除されない。 IDが一致していて、削除フラグが全て「1」である場合、Aテーブルを削除する。 としたいのですが、半日悩んでもうまくいきません。 どうかお願い致します。
sqlserver2005 文字列のカラム（ただし数字のみ）と、画面から文字列としてきた 数字の大小を比較したいと思っています。 たとえば、WHERE ～ 【対象カラム】 > CONVERT(NUMERIC,'1')のように しようと思っていたのですが、この場合、【対象カラム】の中に 空白があるとこけてしまいます。 文字列なので、空がNULLとは限らないため困っています。 そもそもINT型のカラムならば良いのですが、都合により文字列の カラムにするしかなく。 妙案ありましたらアドバイスいただけないでしょうか。
WS 2008 R2 に MSSQL 2008 R2 （x64版） をインストールして運用しています。 開発環境 WIN7 ＰＣ（x86）に MSSQL 2008 R2 Developer （x86版）をインストールしたのですが、 このＰＣから サーバーの MSSQL （x64版） を操作しても問題はないのでしょうか？ 実際に試してみれば良いのでしょうが、もし事前に分かったらと思いまして。 どなたかご教授いただけるとありがたいです。
お世話になります。 以下の環境で開発を行っています。 言語：C#（.NET 2008） DB： SQL Server 2008 C#で作成した画面にて入力された値をパラメータで ストアドプロシージャに渡し、その値がNULLでない場合だけ WHERE句にレコード絞り込み条件を与えるSQL文を 考えているのですが、記述方法がわかりません。 (プロシージャ) --------------------------------------------- DECLARE @param1 = '' 　-- 画面から渡されるパラメータ１ @param2 = ''　　 -- 画面から渡されるパラメータ2 SELECT * FROM TABLE1 A, TABLE2 B 　　 -- (1) IF @param1 IS NOT NULL AND @param2 IS NOT NULL 　　 -- ここから WHERE A.COLUMN1 = @param1 AND A.COLUMN2 = @param2 ELSE IF @param1 IS NOT NULL AND @param2 IS NULL WHERE A.COLUMN1 = @param1 ELSE IF @param1 IS NULL AND @param2 IS NOT NULL WHERE A.COLUMN2 = @param2 　　 　　　　　　　　　 -- ここまで　(2) AND A.COLUMN1 = B.COLUMN1 　　 　　 -- (3) AND A.COLUMN2 = B.COLUMN2 　　　　　-- （4） 　 ------------------------------------------------ 上記の(1)から(4)までをうまく１つにまとめたかたちで記述することができません。 特に上記（2）の効率のよい正しい記述方法がわかりません。 どなたかご教授願えますか？ よろしくお願いいたします。
SQL初心者です。初歩的な質問だと思いますが、ご教授願います。 以下のような２つのテーブルがあります。 【テーブルA】 グループ 社員番号 A 1 A 2 A 3 B 4 B 5 B 6 C 7 C 8 D 9 D 1 【テーブルB】 社員番号 1 9 テーブルBの社員番号と一致する場合、テーブルAをグループ単位で抽出しないようにしたいです。 　・グループAは社員番号1が一致するため抽出しない。 　・グループDは社員番号1と9が一致するため抽出しない。 【取得結果】 グループ 社員番号 B 4 B 5 B 6 C 7 C 8 説明が分かりづらくて申し訳ありませんが、よろしくお願い致します。
OracleでテーブルのNot Null制約や、カラムのバイト数、PKかどうかなどが取れるように、 SQL Server でも取れますでしょうか？ Googleにて「SQLServer、 データディクショナリ」のキーワードで検索をしてみましたが、 出てくるのはOracleばかりでした。 （SQL Serverで使う言葉がデータディクショナリという言葉ではないのかも？） SQL Server での取得方法、もしくはGoogle検索用のワードを知りたいです。
初心者です。 稼働中のデータベースのカラムの順を変えると 問題がありますでしょうか？ どうかよろしくお願いします。
早速ですみません。 マスタを別々に分けた方がいいのか、それとも各マスタを1つにまとめた方がいいのかで悩んでいます。 ■マスタを別々に分けた場合 ・○×マスタ ・○○マスタ ・××マスタ 　　　・ 　　　・ 　　　・ ■各マスタを1つにまとめた場合(※テーブルの項目に種別フィールドで判別するようにする。) ・アイテムマスタ どちらがいいと思いますか？ 個人的な意見でも何でも構いませんので皆さん、アドバイス下さい。 宜しくお願いします。
初歩的な質問だと思われるため、恐縮ですがご教授ください。 以下のような２つのテーブルがあります。 ＜テーブルA＞ 会員NO 生年月日 1 20000101 2 20000102 3 20000103 4 20000104 ＜テーブルB＞ 会員NO 生年月日 1 20000101 2 20000102 2 99999999 3 99999998 3 99999999 この状態で、 「テーブルA」の「会員NO」すべての内、 「テーブルB」の「会員NO」と一致し、かつ「生年月日」が１つも一致しない「会員NO」を拾い出したいと考えています。 ↑のテーブルでは、「会員NO」 3 のみが該当する条件となります。 1 →　会員NOと生年月日が一致する 2 →　テーブルBで会員NOが一致する2件のうち、片方の生年月日が一致する 4 →　会員NOが一致しない どうか、よろしくお願いいたします。
お世話になります。 現在SQLSERVER 2008R2 とvisualbasic2010を使用し、データベースの勉強をしています。 教科書は、visualbasic2005による[実践]データベースプログラミング　谷尻かおり氏著を 使用しています。 テキストボックスに抽出条件を入れると特定のレコードを抽出したいのですが SQL Serverの抽出条件のパラメータについて分からないのでご教示願います。 教科書P47ではSQLServerの場合は「@GoodsID」とする事で、テキストボックスの 値をいれられると私は認識したのですが、うまくレコードを抽出することができません。 アクセスでは LIKE ? & '%' SQLserverでできるかなと思った私の考え LIKE @GoodsID & '%' どうすればレコードが抽出できるでしょうか？ 以上よろしくお願いします。
Windows Server 2003 に SQL Server 2005 Express で使っている環境の バックアップ目的で サーバ機とWindows Server 2008 R2 Standard (64ビット版)を 購入し、SQL Server 2008 Express をインストールしました。 OSとSQL Server 2008 Expressのインストールはここ数日何度もトライしましたが、 解決に至りません。 Windows Server 2003 に SQL Server 2005 Express上のデータベースに 対して、クライアントは、Windows XP + Office Pro 2003でAccess より リンクテーブル→ODBCデータベース→SQL Server で進めていって テーブルが出てきますが、新しく構築したサーバ機でテストすると。 作成したデータベースが表示されません。 全く表示されないのではなく、デフォルトで入っている、master等は表示されます。 2005から2008へデータベースファイルを持ってきたことが原因と思い、 2008側で作りましたが、やはり、それも表示されません。 OSとの相性が問題かと思い、別のWindows 7 へ入れてみましたが、同じ現象です。 SQL Server 2008 Express　接続でネットで検索をかけると、全く繋がらないと いった質問だけで、ポートを空けるとか言った回等で解決に至ったか分からない まま、締め切られています。 自分の場合は、全く症状が違っていて、繋がるのですが、作成したのが見れないんです。 このような症状あると思うんですが、質問自体見つかりません。 Microsoft に問合せしましたが、所詮無償のものですので、テクネットやこちらを 紹介され、そちらで解決して下さいとのことで困っています。
いつもお世話になっています。 下のテーブルデータから下記ＶＩＥＷ結果を表示する場合、 どのようなSQL文で出力が可能になるのでしょうか。 ※GROUP BY利用では集計値でない商品名、得意先名を出力できず困っています。 初心者的な質問で申し訳ありませんが、ご回答よろしくお願いします。 ○環境：Windows Server 2003、 SQLServer 2005 ------------------------------------------- 「売上明細テーブル」 商品CD　商品名　得意先CD　得意先名　価格 1　商品1　1001　得意先1　100 1　商品1　1001　得意先1　100 1　商品1　2002　得意先2　100 2　商品2　2002　得意先2　200 2　商品2　3003　得意先3　200 2　商品2　3003　得意先3　200 ------------------------------------------- 「ＶＩＥＷ結果」※価格は商品CD＋得意先CDキーの合計値です。 商品CD　商品名　得意先CD　得意先名　価格(合計) 1　商品1　1001　得意先1　200 1　商品1　2002　得意先2　100 2　商品2　2002　得意先2　200 2　商品2　3003　得意先3　400
実は、会社でWebSiteと連携したDBを構築できるようなソフトを探してます。 たとえば求人サイトとように、クライアントがアクセスして求人を探し、応募できるとか、自分自身をクライアントが登録してDBになるとか。 ずっとネットを見ていて、 (1) Perl/CGI+namazu (2) Filemaker (3) サイボウズデヂエ (4) ASP+MSDE2000 (5) ASP.NET+MSDE2000 (6) JSP+mySQL/Postgre/Oracle (7) PHP+mySQL/Postgre こんな感じの開発が必要なようですが、出来合いのMSのソフトで可能でしょうか？ 可能でしたら、そのソフトの名前と構成をお教え願えますでしょうか？ 上司から探せといわれましたので、助けてください。。。
access２００７　VBAでSQLのUPDATEの使い方の質問です 下のような顧客テーブルがあり ID　　　担当者　　会社名　　　　　電話番号　　 １　　　　山田　　　XX産業　　　　　１２３４ ２　　　　　　　　　　株式会社XX　　２４４３４３ ３　　　　山本　　　YY会社　　　　　４３２０５４ ４　　　　田中　　　XX商事　　　　　５９６８０ ５　　　　　　　　　　TT工業　　　　　５４９３ ６　　　　佐藤　　　ｊｊ加工　　　　　　５４３５４ ７　　　　　　　　　　XX工務店　　　４３２０２ ８　　　　湯浅　　　Xx工業 担当者列が空白の行を見つけ、上から２行目までの担当者列に中村と入力したいのですが 以下のようにしても上手くいきません。 ("UPDATE 顧客テーブル SET 担当者 = '中村' WHERE 担当者 IN (SELECT TOP 2 担当者 FROM 顧客テーブル)") 上記テーブルですと、ID２、５の担当者名が中村になるようにしたいのです。 どなたかお知恵をお貸しください。
売上伝票と顧客マスター テーブルからのクエリー作成で 以下条件を設定したいのですが・・・ 売上日がDate()で 伝票番号Mod 2 <>0 の条件で 顧客マスターの1フィールド（S、Y、SL、YL、余白で文字無し） の5通りが入力されているフィールドから Like "Y"と Not Like "S"の条件を満たすクエリー作成は？ よろしくお願いします。
現在、会社でSQLServer2008 WorkGroup を購入し WinXPのPCにインストールして利用しています。 最近PCの処理能力に限界を感じ、新たにPCを購入することが決まりました。 現在のPCのSQL2008はアンインストールし 新PCにSQL2008をインストールする予定です。 そこで新PCのOSについて悩んでいます。 Windows7　Proの64bit版のOSを購入しようと予定していますが SQL2008は対応しているのでしょうか？ またSQL2008がwin7にインストール出来たとして クライアントPCがXPの場合、SQL Server Management Studioは win7のサーバーに接続できるのでしょうか？ アマゾンでは http://www.amazon.co.jp/Server-2008-Workgroup-%E … 対応OS: Windows XP Pro(SP2以降)/Server 2003(SP2以降)/Vista/Server 2008以降 とあり、windows7は書いていません。　 ただVistaは載っているのでこの情報が古いのか？どうかが分かりません。 質問は2点です。 ・Win7（PRO　64bit)にSQL2008はインストール可能か？ ・クライアントPC（XP)でMSSMSを起動し、サーバー（win7)のDBへの接続は可能か？ 宜しくお願いします。
SQLサーバ超初心者です。 A支店用のテーブルを作成（dbo.data_A）したのですが B支店（dbo.data_B）、C支店用（dbo.data_C）のテーブルを作成したいです。 Accessなどのように、コピーペーストなどはできないのですよね？ ご教授お願いいたします！
SQLServer Expressを自動インストールするバッチファイルを作成しました。 処理の流れは (1)インストール (2)MDFのアタッチ となっています。 ところが(2)が失敗します。 sqlcmd を使ってアタッチをしているのですが、 「操作可能なプログラムまたはバッチ ファイルとして認識されていません。」 となります。 ところが再度(2)の処理だけを実行すると成功します。 つまりインストールは成功しており、sqlcmdは使えるはずなのです。 処理が連続しているのが問題化と考え、コマンドを別ウインドウを立ち上げたり しましたが無理でした。コマンドでスリープも出来ないようです。 解決法をご教授願います。 環境 WindowsServer2008Standerd SQLserverExpressR2SP1 with Tools
T-SQL　初心者です。 下のようなcolumn（fruits　year）があって、右の年度（2011）を削除して左側の果物の名前だけ表示したいのですがどのようにやったらいいでしょうか。 SUBSTRINGやLEFTを使うと左から始まって何桁目までという指示ができますが、果物の名前のみは桁数が違うので使えません。　よろしくお願いします。 Column: fruits year APPLE 2011 LEMON 2011 STRAWBERRY 2011 ORANGE 2011 結果： APPLE LEMON STRAWBERRY ORANGE
いつもお世話になっております。 一応30分ほど自力で考えましたが、断念しました。 どなたかご教授下さい。 テーブルAの中に、以下の様なデータがあるわけですが、 KAINo SEQ　 0001 　　 1 0001 　　 2 0001 　　 3 0001 　　 5 0002 1 0002 5 １つのKAINoに対して、存在するSEQがバラバラなので、全てのKAINoにSEQ１～７を 作るクエリを流したいのです。 （↑をこんな感じに↓） KAINo SEQ　 0001 1 0001 2 0001 3 0001 4 0001 5 0001 6 0001 7 0002 1 (略)　 0002 7 どの様なクエリになるのでしょうか？ そもそもクエリで可能なのでしょうか？ どうぞ、よろしくお願い申し上げます。
テーブルAには、年月、単価と言うカラムを持っており、 データとしては、下記のように保持しております。 2011/01/01 100 2011/02/01 200 2011/03/01 300 2011/04/01 400 データを取得する際にWHERE句に「2011/02/01」と指定した場合に 「2011/02/01」を当月とし、 「2011/01/01」を前月として取得、 「2011/02/01」の単価と「2011/01/01」の単価を差分として取得したいのですが、 サブクエリだと複数のデータがあるため、エラーで落ちてしまいます。 何か良い取得方法があればご教授頂けないでしょうか。 SELECT 単価 as 当月,　（例：200) 単価 as 前月, (例：100) 単価 as 差分 (例：100) FROM テーブルA WHERE 年月='2011/02/01' 以上、よろしくお願い致します。
いつもお助け頂いております。 簡単な方には簡単な内容なのでしょうが、行き詰まりました。 お助け下さい。 現在、「テーブルA」の中に、「会員NO」という列があります。 現在は、「00001001」といった8桁の数値と、「000000001010」といった12桁の数値 が混在しております。 これを12桁に統一したいのですが、なかなか検索してもHITせず・・・ ほとんどが8桁なので、先頭に「0000」を追加して12桁の分は手作業で修正すればいいか、 と思い社内のSQL2005でテストOKだったクエリが、現地のSQL2008ではエラーに。。 ちなみに下記の内容です。 UPDATE テーブルA SET　会員NO　=　'0000' + 会員NO できれば12桁に統一、というクエリが欲しいのですが・・よろしくお願いします。
自宅でSQLServer2008ExpressEditionをインストールしてDBの勉強をしているのですが 保守や運用について勉強したいと思っているのですが何から勉強していいのかわかりません 現在は １．インストール ２．DB作成、テーブル作成 ３．データ挿入 などをSQL文を使わずにSQL Management Studioの画面から行っています。 これから １．データベースのバックアップ ２．検索速度をあげる作業（すみませんよくわかっていません） ３．ミラーリング？（故障時に切り替えるやつ※よくわかっていませんすみません） 等の保守、運用で必要になる知識を学びたいのですが 保守の日常業務や作業項目がわかっていないため何から勉強していいのか わかりません。 そこで、質問なのですが 保守の日業務や作業項目を教えてください 作業項目というのは例えば １．バックアップ ２．ミラーリング 等のこんな感じです 参考書籍やホームページもあれば追記願います。
データベースはSQLServer2008R2を使って開発を行っています。 トリガを作成する事になったのですが、ストアドは初心者です。 なにかと足りない内容などがあると思いますが、ご了承下さい。 あるリンクテーブル（ODBC経由）でInsertの処理があった場合にSQLServerのテーブルにInsert処理を行いたいと思っています（履歴を作成する為）。 しかしリンクテーブルの定義が分からず、現在調べている最中です。 ちなみにリンクテーブルは下記の内容になります。 select * from openQuery (Host39Kelfjk, 'select * from TblAkDfoe') リンク：「Host39Kelfjk」.「DB1」.「Host39Kelfjk」 リンクサーバ：Host39Kelfjk カタログ：DB1 テーブル名：TblAkDfoe 参考になるような、サイトなどありましたら教えて下さい。 宜しくお願いします。
専門家の方、宜しくお願い致します。 SQLSERVER2008 R8のインストールについて質問させてください。 私は、下記のようなＰＣを保有しています。 (1)ＳＳＤとＨＤＤのどちらにSQLSERVER2008 R8をインストールすべきでしょうか？ WINDOWS７　ＰＲＯ SSD １２０Ｇ ＨＤＤ１ＴＢ (2)SQLSERVER2008 R8をＳＳＤにインストールする場合の手順を教えて頂けませんでしょうか。 通常だと「Ｃ」は、ＨＤＤを指しているイメージなのですが、間違っていますか？ 以上、宜しくお願い致します。
お世話になります。 SQL Serverに関する質問です。 以下の内容を満たすSQLを作成したいのですが、 方法がわからず困っています。 (内容) *************************************************************** ・Ａテーブル、Ｂテーブルには、以下のレコードが格納されています。 [Aテーブル] | key_code | code1 | code2 | code3 | money | person | ← カラム名 ---------------------------------------------- | 001 | 1 | 1 | 1 | 1000 | 10 | ---------------------------------------------- | 001 | 1 | 2 | 1 | 3000 | 10 | ---------------------------------------------- | 001 | 1 | 1 | 1 | 1000 | 10 | ---------------------------------------------- [Bテーブル] | key_code | cd1 | cd2 | cd3 | cd4 | cd5 | ・・・・・ | cd10 | ← カラム名 ------------------------------------------------------------ | 001 | 01 | 02 | 10 | 30 | 51 | ・・・・・ | 90 | ------------------------------------------------------------ | 002 | 01 | 02 | 03 | 10 | 40 | ・・・・・ | 55 | ------------------------------------------------------------ ・Aテーブルの key_code とBテーブルの key_code を関連付けて、 　Ｂテーブルのcd1～cd10に格納されている各コード単位に集計した 　Aテーブルのmoney及びpersonの値を取得したい。 　例えば、 key_code = '000' でAテーブルとＢテーブルを関連付けして、 Ｂテーブルのcd(1～10) = '10' で集計した Aテーブルの money と personの 値を求めたい。 **************************************************************** 初歩的な質問で申し訳ございませんが、 どなたかご教授願えませんでしょうか？ よろしくお願いいたします。
テーブル名を[]でくくらないとエラーになってしまいます sqlserver 2008 express edition を利用しているのですが テーブル名　やカラム名に[]でくくってSQL文を実行しないと エラーが出てしまいます 例えば select * from [table]　　の様にしないといけません これを select * from table で実行できるようにしたいのです どうしたらいいのでしょうか 会社ではsqlserver2005を利用しているので 2008からは[]でくくる必要になったのでしょうか それとも初期設定で何かしないといけないのでしょうか 設定方法を教えて下さい sqlserver management studio2008もインストール済みです
現在「Microsoft SQL server 2008」をグラフィカルに操作するために、SDKを探しているのですがみつかりません。 2005は「SQL Server Management Studio Express」（ダウンロードファイル名はSQLServer2005_SSMSEE_x64.msi）というものを見つけたのですが、残念ながら2008には対応していませんでした。 もしかして2008は有料なのでしょうか？ ご回答いただけると幸いです。
SQLserverについてです。 SQLサーバーは、マイクロソフト社から販売されているデータベースソフトですが、 実際のところORACLEと比べて、処理速度は速いのでしょうか？ 専門家からみるとSQLサーバーは、処理速度の観点だけをみるといかがですか？ データベースソフトを全体的にみると、処理速度についてSQLサーバーだけ記載が少ないので、 極端に処理が遅いソフトなのではないかと考えています。
あるマシン(Windows XP Pro)には SQL Server が入っています。 ただ何年も放置していたマシンなので 2000 なのか　2005　なのかわかりません。 プログラムの追加と削除で調べると添付のように 2000 と 2005 の両方が表示されてしまいます。 （添付画像がプログラムの追加と削除で表示されている内容です） 実際このマシンにインストールされているバージョンはどちらなのでしょうか？ また SQL Server 2000 のバックアップデータはそのまま復元可能なのでしょうか？ VB６ からアクセスするように組まれていますので、そのまま使いたいと思っています。
お世話になります。 以下のテーブルから、次のアウトプットを行うためのSQLをご教授ください。 【インプット】 大連番　小連番　… 000001　000001　… 000001　000002　… 000001　000003　… 000001　000004　… 000002　000001　… 000002 000002　… 000002 000003　… 000003 000001　… 000003 000002　… 【アウトプット】 大連番　小連番　… 000001　000001　… 000001　000002　… 000001　000003　… 000002　000001　… 000002 000002　… 000003 000001　… ※大連番毎に小連番の最大値のデータを除いている。 どうか、お力添えをお願い致します。。。
VBExpress2010をDLしSQLServercompactをいじろうと思ったのですが、接続がそもそも出来ず詰まってしまいました。 適当にフォームを作ってボタンを配置し、 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Dim St As String Dim Cn As New System.Data.SqlClient.SqlConnection Dim SQL As System.Data.SqlClient.SqlCommand Dim ServerName As String = "C:\Program Files\Microsoft SQL Server Compact Edition\v3.5\Samples\Northwind.sdf" 　　　 Dim DatabaseName As String = "Northwind" 'データベース St = "Server=""C:\Program Files\Microsoft SQL Server Compact Edition\v3.5\Samples\Northwind.sdf"";" St &= "integrated security=SSPI;" St &= "initial catalog = Northwind" Cn.ConnectionString = St SQL = Cn.CreateCommand SQL.CommandText = "SELECT FirstName FROM Employees" Cn.Open() MsgBox(SQL.ExecuteScalar) Cn.Close() SQL.Dispose() Cn.Dispose() End Sub としました。結構単純な流れだと思うのですがCn.Open()の部分で「sqlexpressionはハンドルされませんでした」とエラーが出ます。 SQL Network Interfaces, error: 26 だそうです。資格情報の有無もなにもデータベースエクスプローラで内部の閲覧は出来るし、パスワードフリーなのでどのセッションが不可なのか見当がつきません。アドバイスよろしくお願い致します。
sqlserver 2008 express with advanced servicesをインストールしているのですが powershellがインストールされていないためインストールが行えまませ そこで、質問なのですが powershellのバージョンは何をインストールするべきなのでしょうか 自宅でアプリケーションをインストールする場合は大抵最新バージョンを インストールしていますが。 　 環境 SQLServer :sqlserver 2008 express with advanced servicesをインストールしたい OS：windows xp proffesional .net Framework :.net framework3.5 sp1 windows インストーラ　4.5 質問 インストールするべきpowershellのバージョン
会議室予約システムを例とさせていただきます。 開始時刻／終了時刻／予約者 10:00／11:00／鈴木 15:00／17:00／山田 このテーブルに以下のデータを追加する時、【追加データ１】はINSERT可能で、【追加データ２】はINSERT不可能にするチェック方法を考えます。 【追加データ１】14:00／15:00／佐藤 【追加データ２】16:00／18:00／高橋 一般にはプログラム内でSELECTによるチェックを行い判定結果によりINSERTを行うと思いますが、今回は既存プログラムに手を加えることができないとして、以下のどれかのやり方の可能性と方法を教えていただきたいです。 【方法Ａ】check制約のようなDB依存しない方法で、テーブルにあらかじめチェックを加える。 【方法Ｂ】SQLServer特有の方法を使用し、テーブルにあらかじめチェックを加える。 【方法Ｃ】INSERTのSQLにチェック機能を入れる（入力不可時にはエラー等を返す） プログラム言語：java 1.5 以上, iBATIS SQLServer：2008 R2 Express または Standard なるべく【方法Ａ】のようなものがあるといいのですが。。 以上です。よろしくお願いいたします。
SQLServer2008を使用しています。 下記のように一つの売上データが伝票番号をキーとして一つのテーブルに複数レコードに分けて登録されています。 伝票番号　分類　区分　データ 1　　　　　　　1　　　1　　　2500 1　　　　　　　2　　　1　　　　　0 1　　　　　　　3　　　1　　　A123 2　　　　　　　1　　　1　　　9800 2　　　　　　　2　　　2　　　　　0 2　　　　　　　3　　　1　　　　　0 分類が1だと売上金額、2だと区分が1なら現金、2ならカード支払いなどとフィールド内の値によって意味分けされています。 上記例ですと伝票番号1は顧客ID A123の客が現金で2500円、 伝票番号2は顧客ID 0（フリー客）客がカードで9800円支払ったデータということになります。 上記のようなデータ構造で現金の売上のみ、カード売上のみの集計などを行いたいのですが、 同一テーブル内の別レコードの値を条件に検索集計をSQL文だけで行うことは可能でしょうか？ 可能でしたらどのようなSQLを使用すれば良いのか教えていただけると幸いです。 よろしくお願い致します。
先日、オークションでPCを購入しました。 色々なソフトがインストールされていて、 そのなかにSQL server standard等がインストールされていました。 （ネットで調べると３０万円以上するもののようです） ここで質問なのですが、 （1）アカデミックバージョンと通常版を見分ける方法はありますか？ （ソフトがインストールされておりわかりません。買った相手もわからなくなりました。） （2）仮にバージョンアップする場合、いまインストールされているのが アカデミックバージョンでそれを通常バージョンに変更することは可能ですか？ （3）このインストールされているソフトは利用して問題ないでしょうか？ （4）なにか追加的に（定期的に3年に1度等）発生する追加費用はありますか？ 以上、DBやライセンスに詳しい方からの回答をお待ちしています。 お手数をおかけいたしますが、宜しくお願い致します。
知人のプログラマーとの会話の中で「オラクルやSQLサーバなどのデータデース技術は人類が創り出した英知の結晶の１つだ」と言われました。その意味がよくわかりませんので教えていただければ幸いです。その２つはデータベースを管理する機能を持った主要なソフトだというのはわかるのですが、英知の結晶と言うに値する理由をお願いします。
下記のような構成で構築したWebシステムがあります。 OS：Windows Server 2008 Standard 言語：VB.NET DB：SQL server 2008 それを下記の構成の環境へ移植しようと思いました。 OS：Windows Server 2008 Standard 言語：VB.NET DB：SQL server 2008 ExpressEdition 移植したところSQLserverへの接続がうまくいかず、試行錯誤した末にSqlConnectionの接続文字列のsourceの部分をサーバ名のみに変更したところ、接続することが出来るようになりました。 【変更前】 workstation id=xxx;packet size=4096;user id=user;data source="servername\instance";persist security info=True;initial catalog=xxxdb;password=xxxxx 【変更後】 workstation id=xxx;packet size=4096;user id=user;data source="servername";persist security info=True;initial catalog=xxxdb;password=xxxxx 上記のsourceの部分は「サーバ名\インスタンス名」でよいと思うのですが（現に移植元の環境では接続できているので）、ExpressEditionの環境だとインスタンス名まで含めるとなぜか接続できません。 環境によっていちいち接続文字列を変更したくないのですが、ExpressEditionの場合は変更が必要なものなのでしょうか？それとも、何か設定が不足している等の原因でしょうか？ご存知の方がいらっしゃいましたら、ご教授いただけると幸いです。
ユーザが指定したブログエントリに最初に記載されたコメントと、そのコメントに追加されたコメントの一覧を表示するSQLを作成したいです。 ユーザはコンボボックスでエントリ番号一覧から特定のブログエントリを指定します。そのブログエントリに最初に投稿されたコメントが表示されます。 また、そのコメントにレスするコメントがあれば、それらのコメントも表示されます。 関連テーブル ●ブログエントリ エントリ番号（主キー） ●コメント コメント番号（主キー） エントリ番号（外部キー） コメント内容 投稿日（例：2011/10/01） 元コメント番号 ユーザが指定したブログエントリに複数のコメントがあった場合、最初に投稿されたコメントと、そのコメントにレスされたコメント（「元コメント番号」が一致するもの）のみを表示したいです。下記の画像がイメージです。 この場合、どういったSQLを書けばいいでしょうか？ ご教示よろしくお願いいたします。
SQL serverにてデータの管理をしてます。SELECT文について質問なのですが、 例えば、取引先データが入っているテーブルを「A_取引先」とします。 また、ここ何年かの売上データが入っているテーブルを「B_売上」とします。 今回、取引先整理のため売上データ(B_売上)にない取引先を取引先データ(A_取引先)から抽出したいのですが、どのように書けばよいでしょうか not inを使っても「B_売上」にまったくない取引先は抽出されません。 分かりにくい文章かもしれませんが、ご教授の程よろしくお願い致します。
SQLserver2005を使っています。 Management Studioで クエリの結果のコピー時に列のヘッダーを含める場合 クエリ→クエリオプション→結果→グリッドの 「結果のコピーまは保存時に列のヘッダーを含める」 にチェックを入れれば可能ですが これをデフォルトにすることは可能でしょうか？ 新しいクエリを立ち上げる度にこのチェックを入れるのは面倒です。 宜しくお願いします。
NO　科目 ------- 　1 国語 　2 英語 　3 算数 　4 国語 　5 国語 　6 算数 の様なテーブルがあった場合、科目でグループ化した時のグループ数を取得したい。 上の例だと、科目は、「国語、英語、算数」なので 　３ のカウントを返したい この場合の、SQL文が分かりません。 分かる方、よろしくお願いします。
　　SQLServer2005の一般的な容量管理について教えて下さい。 ・テーブルは通常は自動拡張されるものなのでしょうか？ ・テーブル容量の上限値を設定しておいて、たとえばしきい値として80%超えとなったら 　イベントログのほうに警告を出すなど可能でしょうか？
oracleからSQL Serverへ移行することになったのですが、副問い合わせで定義したテーブル同士を外部結合するSQL構文が、うまく実現できず、ご教授して頂きたくよろしくお願いします。 下記、oracle 構文をSQL Server構文へ書き換えたい。 select * from (select cal1,cal2,cal3 from tbl1,tbl2 where cal1 >100) aaa, (select cal1,cal2,cal3 from tbl1,tbl2 where cal1 <=100) bbb, tbl3 where aaa.cal1 = bbb.cal1(+) and aaa.cal2 = bbb.cal2(+) and aaa.cal3 = bbb.cal3(+) and aaa.cal1 = tbl3.cal1 よろしくお願いします。
T-SQLで、集計結果を出力するクエリの書き方について、教えてください。 以下のテーブル1から、年度ごとの国の数、種類の数を表示するクエリは、どのように書けばよいでしょうか？ テーブル１： 年度|国|種類 2000|日本|りんご 2000|米国|りんご 2001|日本|りんご 2001|英国|メロン 200||日本|みかん 2002|米国|かき 2002|中国|みかん 2002|中国|かき 表示したい結果セット： 年度|国数|種類数 2000|2|1 2001|2|2 2002|3|2 WITH句などを使用して、国でグループ化したサブクエリ、種類でグループ化したサブクエリを年度でJOINする方法は思いつくのですが、もう少し簡単に書ける方法があれば、教えてください。 よろしくお願いします。
下記のスペックで処理を行っていますがメモリ不足になり 処理が止まってしまいます。 対応方法を考えましたが・・知識が少ないので以下の程度しか 思いつきません。 １．メモリの増設 ２．SQLServerの設定　AWEを有効にする。（現在は未設定） ご存知の方がいらっしゃればご教示願います。 よろしくお願いいたします。 OS:Windows2008Server SQLServer：SQLServer2008R2 メモリ：２GB
お願いします。 SQLSERVERで、テーブル項目の指定文字列を削除したいのですが その削除したい文字列が複数あります。 例えば、商品マスタ 商品コード　|　商品名 | 0001 | black-001.a 0002 | black/001 a とある時、商品名からピリオド、カンマ、ハイフン、スペース、スラッシュ を一度に削除したいです。 そしてその項目をビューで使用したいです。 Replace関数だと一度に一つしか削除できないようなので何か方法がないかと 思案しております。 ふと、関数を作成してできないのかと考えたのですがどうなのでしょうか？ ※作成した事がないので・・・・ また他によい方法があればご教授お願いいたします。
sql server 2008にて、joinの使い方について教えて下さい。 以下二つのテーブルがあります。 所属テーブル 名前 性別 所属 田中 男 経理部 田中 女 総務部 鈴木 女 経理部 佐藤 男 総務部 住所テーブル 名前 性別 住所 田中 男 杉並区 佐藤 男 中野区 鈴木 女 中央区 この二つのテーブルよりデータを取得し、以下のテーブルを作りたいです。 住所と所属テーブル 名前 性別 住所 所属 田中 男 杉並区 経理部 田中 女 null 総務部 鈴木 女 中央区 経理部 佐藤 男 中野区 総務部 但し、left join を使って、 所属テーブル.名前 = 住所テーブル.名前 and 所属テー ブル.性別 = 住所テーブル.性別 の条件を使用すると、女性の田中さんのデータが抽出されません（住所テーブルに登録されていないため、マッチングできていません）。どうすれば以上のテーブルが作られますか？
CSVをバルクインサートでitemテーブルにBULK INSERTする際に、 下記のようなSQL文を使っているのですが、CSV内のブランク文字は 実行後にNULLになってしまいます。 やりたいことはNULLではなく空白文字（""）にしたいのですが、 下記のSQL文をどのように変えればよいのでしょうか。 または、CSVを変更する方法でもよいです。 BULK INSERT item FROM 'c:\test.txt' WITH ( FIELDTERMINATOR = ',', ROWTERMINATOR = '\n' ); 大変お手数ですが、 わかる方がいらっしゃいましたらよろしくお願いいたします。
peer to peerとclient serverのセットアップにかかる平均的な値段を それぞれお願いします。 peer to peerとclient serverのそれぞれの利点と欠点を教えてください
SQL server 2000で接続セッションのIPアドレスをトリガーでテーブル登録する方法を教えてください。あるテーブルの「更新IPアドレス」という文字列項目に、そのレコードが固定編集された時にクライアント端末のIPアドレスをトリガーで、登録したいのですが、方法を教えてください
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- ストアド内でカラム名一覧を取得、カンマで繋げてひとつの変数にまとめたい。 =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 現在開発でストアドを使用する機会があり、そこで不明点が発生し悩んでおります。 以下、現状と質問です。 ■SQL SERVER 2000 ■テーブル(※)のカラム名一覧を取得し、 　カラム名をカンマで繋げてひとつの変数に格納したいと思っています。 　※先の処理でカラムを取得したいテーブルをSELECTしており、 　対象のテーブル名を変数に代入しています。 　カラム一覧を取得するにあたり、以下のようにカーソルで習得し、 　FETCHでカラム名を変数に格納しようと考えていましたが、 　「'対象テーブル名'」には変数がいれられないので、どうしようかと悩んでいます。 　DECLARE CURS_test CURSOR FOR 　 SELECT name FROM dbo.syscolumns 　 WHERE id IN 　 (SELECT id FROM dbo.sysobjects WHERE name = '対象テーブル名') 　 ORDER BY id, colid; 　「sp_executesql」を使用してselect文を流そうとしたのですが、 　複数ある列名を取得して、上記で記載しましたように 　カラム名をカンマで繋げてひとつの変数に格納する方法がわかりませんでした。 　こういった場合、どのように考えて、どのように書けばよいのでしょうか。 　まだ触り始めたばかりで、わからないことがわかっていない部分もあり、 　質問内容でわかりにくい部分がありましたらご指摘いただければと思います。 　どうぞよろしくお願いいたします。
SQLServerのSQL文です。 dbo_TblAには以下のようなデータが2行入っています。（重複している） SYAINCD XXXXX StartDT 2011/1/1 EndDT 2011/12/31 YuukouDT 2011/1/2 以下のSQL文を発行すると、1行だけの結果を返してくるのですが 理由が分かりません。 まったく見たことのないSQL文の書き方なのでどう解釈してよいか分からず 困っています。 解釈いただけると大変助かります。 SELECT H.DT_Date, H.DT_EndDate FROM dbo_TblA AS H WHERE (((H.SYAINCD)="XXXXX") AND ((H.StartDT)=(SELECT MAX( K.StartDT) FROM dbo_TblA K, dbo_TblA L WHERE K.SYAINCD = H.SYAINCD AND L.SYAINCD = K.SYAINCD AND L.StartDT = K.StartDT AND L.YuukouDT = K.YuukouDT AND L.StartDT <= #2011/04/20#)) AND ((H.YuukouDT)=(SELECT MAX(H_ED.YuukouDT) FROM dbo_TblA H_ED WHERE H.SYAINCD = H_ED.SYAINCD AND H.StartDT = H_ED.StartDT AND H_ED.YuukouDT <= #2011/04/20#)));
sqlserverでデータを削除した件数を知りたいのですが 何か簡単な方法はありませんか sqlserverでデータを削除してvb.net上でその件数を知りたいので
マイクロソフト アクセス '９７をかなり前に作成した分を今回久しぶりに使用しおうと思いましたが、リンクさせているエクセル表がどこに存在しているのか？の確認方法を教えてください
SQL serverの勉強始めたいのですが 1番重要なところを 教えてください
下記Ａテーブルのレコード統合して、統合後のようにしたいと思っています。 似たようなものをネットや本で探し、構文を装飾して色々試してみてますが なかなかうまくいきません。SQLで実行したいのですが、お分かりになる方が いらっしゃいましたら構文を教えていただきたいです。何卒、よろしくお願いいたします。 ◆Ａテーブル：統合前 （実際は"ポータルサイト"レコードは数千件、"かな"フィールドは1～200まである） -------------------------------------------------------------------- ポータルサイト名　　　　　　かな１　　　　　　　　　かな２　　　　　かな３　　　　　かな４ ｇｏｏ　　　　　　　　　　　　　　 ぐー　　　　　　　　　　 ぐう　　　　　　 ごー ＹＡＨＯＯ！　　　　　　　　　 やっふー　　　　　　　やっほー　　　ヤフー　　　　　 Ｇｏｏｇｌｅ　　　　　　　　　　　　グーグル　　　　　　　ぐぐる　　　　　ぐーぐる ＭＳＮ　　　　　　　　　　　　　 えむえすえぬ　　　 ＹＡＨＯＯ！　　　　　　　　　　やっふー　　　　　　　やっほー　　　ヤホウ ｇｏｏ　　　　　　　　　　　　　　 ぐー　　　　　　　　　　 GOOO ◆Ａテーブル：統合後 ※※ポータルサイト名でかなを統合（重複しているかなは削除） -------------------------------------------------------------------- ポータルサイト名　　　　　　かな１　　　　　　　　　かな２　　　　　かな３　　　　　かな４ ｇｏｏ　　　　　　　　　　　　　　 ぐー　　　　　　　　　　 ぐう　　　　　　 ごー　　　　　　GOOO ＹＡＨＯＯ！　　　　　　　　　 やっふー　　　　　　　やっほー　　　ヤフー　　　　　ヤホウ Ｇｏｏｇｌｅ　　　　　　　　　　　　グーグル　　　　　　　ぐぐる　　　　　ぐーぐる ＭＳＮ　　　　　　　　　　　　　 えむえすえぬ　　　 　　　　　　　　　　
プログラム、proseeingでの >=←などの意味を教えてください。 他にも=< ←とかいろいろあったんですけど 覚えてません 参考になるサイトがあったらそちらもお願いします
テーブルがＡ・Ｂの２つあり、どちらも「ＩＤ」と「名前」が入っています。ＩＤをキーとして まずテーブルＡで検索して見つからなかった場合ばテーブルＢから検索するような Ｓｅｌｅｃｔ文は、どのような記述になるのでしょうか？また、ビューとして定義する場合には どのような方法になるのでしょうか？よろしくお願い致します。
パソコンに登録されていない文字を登録したいです。 例） 渡辺→渡邉と入力したいが「邉」がパソコンに登録してない場合。 上記の状態では「渡邉」と入力できないので「邉」を入力できるようにしたいです。 文字コードが無いからだと思うのですが「渡・」と文字化けではないのですが「邉」が「・」で 表示されております。 サーバー：Microsoft SQL Server 2008 クライアント：Windows XP Service Pack 3 サーバー側はOfficeがインストールされてません。。 クライアント側はOffice2003がインストールされております。 上記の環境の場合に、新しい文字の登録方法をご教授願えますでしょうか？
Access2007とSqlServer2008を使用しています。 Accessで作成したテーブルを「データベースツール」-「データの移動」でSqlServerに移行してリンクする際、 (1)SqlServerに新規にデータベースを作成すると、リンクテーブルマネージャから見てもリンク先DBが正しく表示されますが、 (2)その後、その既存DBに同じAccess内の別のテーブルを、「データベースツール」-「データの移動」してリンクしたものは、リンクテーブルマネージャから見てもリンク先DBが　()となっており表示されていません。 ツールとしてSqlServer Management Studioを使っていますが、そこからでも(1)のテーブルは表示されていますが、(2)のテーブルは表示されません。 でもリンクはできているようなのです。 また、SqlServer Management Studioを使って、SqlServer内に新規テーブルを作成し、 それをAccessからリンクしようとしても、テーブルリンク一覧内に表示されない状態です。 （「外部データ」-「ODBCデータベース」…）にて　SqlServerのファイルデータソースを表示しています） (2)のテーブルはSqlServer Management Studioから見ることができないため、更新・削除もできず困っています。 DB、テーブル、リンク方法等、何か問題があるのでしょうか？ よろしくお願いします。
以下のようなテーブルがあり、 区分に2、3、4があれば抽出しないという SQL文を教えていただければと思います。 (SQLSERVER2000を使用しています) 名称 　　　| 区分 テストa |　　1 テストa |　　1　 テストa |　　2 テストb |　　1 テストb |　　1 テストc |　　1 テストc |　　2 テストc |　　3 テストc |　　4 テストc |　　5 テストd |　　1 テストd |　　1 テストd |　　5 テストd |　　5 テストd |　　5 例でいくとテストaは区分が1、1、2で 2がはいっているので抽出しない。 テストbは1、1なので抽出する。 テストcは1、2、3、4、5で2、3、4がはいっている ので抽出しない。 テストdは1、1、5、5、5なので抽出する。 つまり結果としては テストaとテストdが抽出されるということです。 質問もままならないほどSQL初心者のため、 どうかご回答いただきたいと思います。 よろしくお願いします！！
SQL server2008 R2で作成したデータベースをSQL server2005で使用したいと考えてます。事情があり、SQL server2005にはSSISがインストールされておらず、追加する事も出来ません このためデータベースのアタッチか、リストアにより、上位バージョンである SQL server2008 R2で作成されたデータベースを、会バージョンである SQL server2005で使用したいのですが エラーとなってしまいます。 もし何らかの方法でダウングレードできるようであれば 方法を教えてください
＜環境＞sqlserver SQLでパラメータが空白であれば全件取得、パラメータに値が設定されている場合には 条件にHITするデータを抽出したいのですが、一本のクエリで抽出することができるのでしょうか？ 空白時パラメータは以下のとおり入ってきます。 @no＝""…完全一致 @name＝"%%"…部分一致 例） SELECT * FROM テーブル WHERE (NO = @no) and ((@name IS NULL) OR (@name IS NOT NULL) AND (NAME LIKE @name)) NAMEは上記クエリにて取得できています。 NOのところはどのようにすればよいでしょうか？
SQLserver2005環境です。 テーブルA (年月とIDでユニーク) 年月　　　　　　ID　　　体重 --------------------------- 2011年01月　　1　　　50 2011年02月　　1　　　51 2011年02月　　2　　　40 2010年12月　　3　　　59 2011年01月　　3　　　60 2011年02月　　3　　　61 2011年01月　　4　　　70 のようになっていた場合、年月を2011年02月で抽出をかけた際に 今月体重を2011年02月、前月体重を2010年01月とし 年月　　　　　　ID　　今月体重　　前月体重 --------------------------------------------- 2011年02月　　1　　　　51　　　　　　50 2011年02月　　2　　　　40　　　　　　Null 2011年02月　　3　　　　61　　　　　　60 ↑の様な結果を得られるSQLを書きたいのですが、うまく作れず困っています。 ご教授いただけないでしょうか？ よろしくお願いします。
SQLServer2000を使用しています。 復旧モデルをシンプルで運用しているのですが、トランザクションログが 数G程度まで肥大化していまいます。 シンプルにも関わらずトランザクションログがここまで肥大化してしまう 原因がわからず、困っております。 原因や対処法をご教授けないでしょうか。 宜しくお願いします。
いつもご参考にさせて頂いております。 今回VB2005ProfessionalとSQLServer 2005Developer Editionでシステムを開発しようと考えております。PCはWin7Pro64bitです。 VB2005は少し経験があるのですが、SQL Serverを使用するのが初めてです。 以前はSQLServerの代わりにAccessをデータベースとして使用していました。 そこでご質問です。 SQLServerもAccessと同様にOracle10gと接続し、 出来たデータベースをサーバー又は端末にセットし、 数人が使用できるシステムを構築することは可能でしょうか？ 実際プログラムを使用するPCはVista32bit or Win7 32bitです。 ※システムはデータの取込、出力、新規作成、更新、削除等一通りの動作をします。 又、この様な構築に関して詳しく解説している本など参考（勉強）になるものがございましたら、是非教えてください。 SQLServerに関して素人なので、どなたかご教授宜しくお願い致します。
SQL Server（バージョン不明）について、2つのフィールドからデータを検索したいのですが、できません。 1つのフィールドならできるのですが、どのような構文にすればいいのでしょうか？ 自分が実際に、SQL Serverを使う事ができず、現在どのような構文になっているか、バージョンは何か、申し訳ないのですがわかりません。 ご回答の程、どうぞよろしくお願い致します。
テーブル結合に関するSQL文について質問させてもらいます。 DBはSQLServer2005です。 下記のような二つのテーブルがあります。 テーブルA コード A111 A111B A222 A333 テーブルB コード　　　　数量　 A111　　　　　1 A111B　　　　2 A222　　　　　3 A222B　　　　4 上記２つのテーブルから下記の結果を表示させたいのです。 コード　　　　数量　 A111　　　　　1 A111B　　　　2 A222　　　　　7 A333　　　　　0 テーブルBのコードがテーブルAにある場合、そのまま数量を表示。 ない場合、コードの4桁目まででサマリした合計値を表示させたい。 LEFT JOIN等をいろいろためしてみたのですがうまくいきません。 おわかりの方、方教えてください。 　 　
SQLServer2008R2 Expressを始めて使っています。 Microsoft SQL Server Management Studioで接続してビューを作成。 SQLクエリでdatetimeのデータとtime型の引き算をして、時間の計算結果を返してもらおうとしています。 テーブル名 test_table col1 = datetime型 col2 = time型 SELECT (CAST(col1 AS time(7)) - col2) FROM test_table; 正しいか正しくないかはまだちょっとわからないのですが、上のようなSQLを実行したいのです。 しかし、 SELECT CAST('2011-01-01 01:00:00' AS time(7)) AS test; というテストを行う段階で「timeメソッドを呼び出せません」とエラーが返ってきます。 書いてるものが違うのか、何か設定そのものが違うのでしょうか。 以下を参考にしました。 http://msdn.microsoft.com/ja-jp/library/bb677243 … 凄い初歩的な問題の気がするのですが、何処を調べればいいのかだけでも結構ですので、何かアドバイスがいただきたいです。。 よろしくお願いいたします。
以下の2つのテーブルから結果に書かれている内容を取得したいのですが、どのようなSQLを作成すればよいでしょうか？ 料理テーブル 料理名 値段 ラーメン 1000 カレー 700 焼肉定食 800 オプションテーブル 料理名 オプション(00：ご飯、01：味噌汁、02：サラダ) ラーメン 00 ラーメン 01 カレー 00 焼肉定食 00 焼肉定食 01 焼肉定食 02 取得したい結果 ご飯をa、味噌汁をb、サラダをcとして、オプション有の場合は'1'を、なしの場合は'0'をたて、 オプションをabcと3桁で表したいのですが。 料理名 オプション ラーメン 110 カレー 100 焼肉定食 111 説明が下手ですいませんが、よろしくお願いします。
現在a、b、cの店舗でそれぞれAccessをDBとして活用しているのですが、それとは別に 3店舗分のデータを一つにまとめた統合用DBとしてSQL Serverを利用したいと考えています。その際、それぞれ各店舗分のデータをSQL Serverへと追加していきたいのですが、どういった処理が最適で効率が良いのか分からず困っています。 希望する処理的には何らかのexeファイルを作成し、そのexeファイルを叩くとAccessからデータを吸い上げ、SQL Serverへとデータを追加するということを行いたいです。 私が考えられる処理としては以下の２点でした。 １、Accessから吸い上げたデータをストアドを使い、データを追加していく。 ２、Accessから吸い上げたデータをCSVに変換し外部ファイルとし、ローダーを使用して 　　データを追加する。 それぞれの店舗データが３万件程あります。 なるべくDBに負担をかけないで以上の様な事を行いたいです。 DBまわりにお詳しい方、ご教授よろしくお願い致します。
アクセスのファイルが２個あります。 １つはAAA.mdb。もう１つはAAADB.mdbです。 AAAを開くと、AAADBが連動するシステムになっています。 今、両方が入っているServerの状況が悪くなっているので、それらを自分のPCにコピーしました。 Serverを停止し、AAAを開くと、かつてAAADBが存在していたパスに接続できないエラーが発生します。 そこで、実在するAAADBのパスを設定したいと思っていますが、その方法が解りません。 是非ともお教え下さい。 この２個のファイルは、私だけが使用しているので、他人との共用は考える必要ありません。
初めてSQLSERVER2008を使用します。 現行Sqlserver2000を使用していて、接続するのにＯＤＢＣ（V2000.85.1132.00)を使用しています。このＯＤＢＣでＳｑｌｓｅｒｖｅｒ２００８に接続するＯＤＢＣを作成しようとしていますが、sqlserverエラー17（sqlserverが存在しないかアクセスが拒否されました）というエラーが出てしまいます。 また、sqlserver ｎａｔｉｖｅ　client10.0でもsqlserverエラー121で接続出来ません。 サーバー側に何か設定が必要なのでしょうか。 アドバイス何卒宜しくお願い致します。」
下記の様なWHERE句を使っていますが、注釈の部分を生かす 極端に時間がかかるようになってしまいます。 (注釈は他の行でも大丈夫です、2～3行殺せば早くなります) なにか制限でもあるのでしょうか? WHEREu.締日コード=@締日コード ANDu.入庫日付<=@終了日付 ANDu.部門コード=isnull(@部門コード,u.部門コード) ANDu.分類in('輸入','輸出') ANDu.分類=isnull(@分類,u.分類) ANDu.仕訳コード=isnull(@仕訳コード,u.仕訳コード) ANDu.商社=isnull(@商社,u.商社) --下記を復活すると遅くなる(4秒→38秒) --ANDu.保管河岸コード =isnull(@保管河岸コード,u.保管河岸コード) --ANDu.品名コード=isnull(@品名コード,u.品名コード) AND(u.在庫員数<>0 orISNULL(a.当期出庫員数,0) <>0 orISNULL(b.出庫員数,0)<>0 oru.在庫重量<>0 orISNULL(a.当期出庫重量,0) <>0 orISNULL(b.出庫重量,0)<>0)
いつもお世話になっております。テーブル内の2つのカラムから、一意となるようにカラムに値を入れたいのですが、どのようにすれば良いのでしょうか？やりたいことは、以下のようなことです。 どうぞよろしくお願い致します。 現状のテーブル code_up code_low code あ 　　　　　a　　　　　 い　　　　　 b　　　　　　 う 　　　　　 c 　　　　 あ 　　　　 a い 　　　　 c 作りたいテーブル code_up code_low code あ 　　　　　a　　　　　1 い　　　　　 b　　　　　2　　 う 　　　　　 c 　　　　 3 あ 　　　　　 a 　　　　 1 い 　　　 c 　　　　 4
SQL server 2005（OS：Windows7)へ、WindowsXPのマシンからリモート接続しようと思い、 ODBCにて接続の設定を行いたいのですが、接続できない状態です。 Windows7側で、XPの端末のユーザー情報を登録することで接続が出来ると思い、 色々なサイトを見てみたんですが、よく分からず・・・ Windows7側ではどのような設定が必要なのでしょうか？ （アカウントの追加？　それともSQLserverで何か設定が必要？） 教えてください＞＜
以下の様なデータがあります。 　　　　　　氏名　　科目　得点 １行目　　Ａさん 　国語 100 ２行目　　Ｂさん 　国語 90 ３行目　　Ａさん　 英語 80 これを以下の様な表にしようと思い、 氏名　国語　英語 Ａさん 100 80 Ｂさん 90 - 以下のＳＱＬ分を書きましたが、Ａさんの得点が２倍になってしまいます。 SELECT SL.氏名 ,SUM(KT.得点) AS '国語' ,SUM(ET.得点) AS '英語' FROM [test_db].[dbo].[得点データ] SL LEFT OUTER JOIN ( SELECT * FROM [test_db].[dbo].[得点データ] WHERE 科目='国語' ) KT ON ( KT.氏名 = SL.氏名 ) LEFT OUTER JOIN ( SELECT * FROM [test_db].[dbo].[得点データ] WHERE 科目='英語' ) ET ON ( ET.氏名 = SL.氏名 ) GROUP BY SL.氏名 原因として、グループ化が結合の後にしているのだと考えています。 どの様に修正したら、いいでしょうか？
いつもありがとう御座います（ご回答いただいた皆様）。 ちょっと悩んでおりますので何かヒントを頂けたら・・・よろしくお願いします。 テーブルAに「会員No」と「来店ポイント」、という列があったとします。 テーブルBにも「会員No」と「来店ポイント」があったとします。 AB両方の会員Noは＝です。 テーブルAの「来店ポイント」が間違っているので、テーブルBの「来店ポイント」と 差し替えたいのですが、どの様なクエリになるのでしょうか？ 自力で何とかなるかな、、と思い2時間ほど粘りましたが、上手くいかないので・・・ （中堅外食チェーンの板前をしてますが、何故かサーバ管理者までしてます。 若いというだけで・・・そんな環境なので聞ける人も居らず、いつもここが頼りになってます。 すみません） 何卒、よろしくお願いします。
初めてSQL Server 2008 Expressを入れて使用しているのですが、 作成したテーブルに同一データをいれて、 SQL Server Management Studio から上位２００行編集を選択し その入れたデータを削除すると、エラーが発生して削除できません。 エラー内容は、 エラーメッセージ：行の値が更新または削除された為、行が一意になりません。または複数の行が更新されます。 特にプライマリキーの設定やインデックスなどは使用していないのですが、何か設定が必要なのでしょうか。 初歩的な質問で申し訳ありませんが、よろしくお願い致します。
Microsoft SQL Server 2005 Developer Editionを使用しています。 SQL Server Management Studio ＞ オブジェクトエクスプローラ ＞ データベース に使用中のDB一覧が表示されています。 エクスプローラでmdfファイルが保存されているフォルダを確認すると 上記にないデータベース名のmdfファイルがあります。 以前、作成して削除したDBのmdfファイルです。 質問です。 （1）オブジェクトエクスプローラに表示されず、mdfファイルが残っているのはどういう状況でしょうか。 私はいつもSQL Server Management Studioで削除したいDBを選択して、右クリック＞削除でDBを削除していますが、 mdfファイルが残ることもあるのでしょうか。 （2）ファイルサイズが非常に大きいため、上記状態のmdfファイルを削除したいのですが、 エクスプローラ上から削除しても問題ないのでしょうか。 削除前に「このmdfファイルは現在使用されていない」ことを確認したいのですが、 どのような方法があるのでしょうか。 前任者からDB管理を引き継いだのですが、上記状態で困っています。 既に前任者はいないため、聞くことが出来ません。 よろしくお願いします。
SQL Server2008のクエリの書式に関する質問です。 異なるテーブルを結合をする際の列名は、以下のようにピリオドを使って表現します。 ＜テーブル名＞．＜列名＞ これは、皆さん当然のように使われていると思います。 ここから質問ですが・・・。 異なるデータベースのテーブルを結合させる場合は、どうすればよいですか？ ＜データベース名＞．＜テーブル名＞．＜列名＞とするのでしょうか？（やってみたが、うまくいかなかったような気が・・・。） そもそも、異なるデータベース間では、テーブル結合できないのでしょうか？ ご指導よろしくお願いいたします。
社員のシフト管理表を作成しています。 visual web developer2008とSQL Server2005にて社内で利用するWEBアプリを作成しています。 CSVにてエクスポートしたいという要件が出てきており、その抽出条件が私には難しくお知恵をお借りしたいと思い投稿いたしました。 予定テーブル(tbl_yotei)には日付と必要人数と場所が入っており、社員予定テーブル(tbl_shain_yotei)には予定IDと社員名が入っています。 ■予定テーブル(tbl_yotei) yotei_id　　jishi_day　　　ninzu　　　shiten 1　　　　　　2011/7/1　　　2　　　　　支店A 2　　　　　　2011/7/2　　　1　　　　　支店A 3　　　　　　2011/7/3　　　3　　　　　支店A 4　　　　　　2011/7/2　　　1　　　　　支店B 5　　　　　　2011/7/3　　　2　　　　　支店B 6　　　　　　2011/7/4　　　3　　　　　支店A ------ ■社員予定テーブル(tbl_shain_yotei) shain_yotei_id　　　yotei_id　　　shain_nam 1　　　　　　　　　　　1　　　　　　　　田中 2　　　　　　　　　　　1　　　　　　　　山根 3　　　　　　　　　　　2　　　　　　　　杉下 4　　　　　　　　　　　3　　　　　　　　田中 5　　　　　　　　　　　3　　　　　　　　一条 6　　　　　　　　　　　4　　　　　　　　魚島 これを予定テーブルの人数分の行を表示し、その行にアサインされている社員が表示される表を作成したくご質問いたしました。 まだアサインされていない予定については社員はnullで人数分の行を作成したいと思います。 入力時の制限として予定テーブルに入力されている「人数」よりも多い数の社員は割り当てていません。予定テーブルのある行の人数が2なら社員予定テーブルの行数は0～2行までです。 ストアドプロシージャで予定テーブルに入っている人数分の行を出力する事は出来たのですが、そこから社員予定テーブルを参照して下記のような表になるようにする方法がわかりません。 例えば tbl_yoeti.yotei_idが3のレコードは3行表示し、shain_yotei_id.yotei_idが3のレコードは2行あるので2行はshain_namに社員の氏名が入り、1行はshain_namがnullのレコードを表示させたいです。 yotei_id　　jishi_day　　ninzu　　shiten　　shain_yotei_id　　shain_nam 1　　　　　　2011/7/1　　2　　　　支店A　　　　1　　　　　　　　田中 1　　　　　　2011/7/1　　2　　　　支店A　　　　2　　　　　　　　山根 2　　　　　　2011/7/2　　1　　　　支店A　　　　3　　　　　　　　杉下 3　　　　　　2011/7/3　　3　　　　支店A　　　　4　　　　　　　　田中 3　　　　　　2011/7/3　　3　　　　支店A　　　　5　　　　　　　　一条 3　　　　　　2011/7/3　　3　　　　支店A　　　　Null　　　　　　Null 4　　　　　　2011/7/4　　1　　　　支店B　　　　6　　　　　　　　魚島 5　　　　　　2011/7/5　　2　　　　支店B　　　　Null　　　　　　Null 5　　　　　　2011/7/5　　2　　　　支店B　　　　Null　　　　　　Null 6　　　　　　2011/7/6　　3　　　　支店A　　　　Null　　　　　　Null 6　　　　　　2011/7/6　　3　　　　支店A　　　　Null　　　　　　Null 6　　　　　　2011/7/6　　3　　　　支店A　　　　Null　　　　　　Null ---- 出来ているストアドプロシージャ CREATE PROCEDURE dbo.StoredProcedure2 DECLARE @yotei_id int DECLARE @jishiday datetime DECLARE @ninzu int DECLARE @shiten nvarchar(50) DECLARE c_yotei cursor FOR SELECT yotei_id,ninzu,jishiday,shiten FROM tbl_yotei CREATE TABLE #TMP ( yotei_id int,ninzu int, jishiday datetime, shiten nvarchar(50) ) OPEN c_yotei FETCH NEXT FROM c_yotei INTO @yotei_id, @ninzu, @jishiday, @shiten WHILE @@FETCH_STATUS = 0 BEGIN DECLARE @kaisu int SET @kaisu = 1 WHILE @kaisu <= @ninzu BEGIN INSERT INTO #TMP ( yotei_id,ninzu,jishiday,shiten ) VALUES ( @yotei_id,@ninzu,@jishiday,@shiten ) SET @kaisu = @kaisu + 1 END FETCH NEXT FROM c_yotei INTO @yotei_id, @ninzu, @jishiday, @shiten END CLOSE c_yotei DEALLOCATE c_yotei /* ここからどのようにしたらよいでしょうか。。 */ SELECT * FROM #TMP RETURN ---- 上記のストアドからでも全く新しいアイデアでもかまいませんので皆様お知恵をお貸しください。 どうかよろしくお願いいたします。
SQL Serverでの検索について教えてください。 【目的】 ・JAVAで作成した検索画面より、SQLServerのテーブルに対して検索をしたい。 ・フリガナ検索で、以下のルールを設けたい 　(1)カタカナ小文字(『ッ』『ャ』等)とカタカナ大文字(それぞれ、『ツ』『ヤ』)を区別せず、同一視したい 　(2)濁音(『バ』)・破裂音(『パ』)・清音(『ハ』)を区別せず、同一視したい 　(3)半角スペースと全角スペースを無視したい 　(4)アルファベット小文字(『a』等)とアルファベット大文字(『A』)を区別せず、同一視した ≪例≫ 　Aテーブル/フリガナ　：　ケンサク キョウダイ 　検索ワード　 　　・ケンサク キョウダイ（完全一致）　・・・　○ 　　・ケンサク キヨウダイ(上記(1))　・・・　○ 　　・ケンサク キョウタイ(上記(2))　・・・　○ 　　・ケンサクキョウダイ(上記(3))　・・・　○ 　という結果にしたい。 【現時点】 ・照合順序をSQL文でしようしたら、 　(2)は『AI』で対応できました。 　(4)は『CI』で対応できました。 ・(3)はSQL文のWhere句に、半角スペースを無効にする『Replace』と全角スペースを無効にする『Replace』を記述することで対応できました。 ・(1)だけがどうしても対応できません。 →(3)の対応と同様に『Replace』での対応も可能なのですが、9つ程度(『ッ』『ャ』『ュ』『ョ』『ァ』『ィ』『ゥ』『ェ』『ォ』)追加しないといけないので、処理速度の低下が懸念点です。 どなたかいい方法をお持ちの方がいましたら、ご協力お願いいたします。 ■バージョン：10.50.1600.1 以上
Visual Studio C# Windows CE環境でSQLSERVERに接続する方法を教えて頂きたいです。 System.Data.SqlClient.SqlConnection cSqlConnection = new System.Data.SqlClient.SqlConnection("接続文字列"); cSqlConnection.Open(); とすると実行時にエラーになります。
検索したいデータに空白がある時空白のない検索文字列でlike検索して データがヒットするようにしたいです col1 NTTデ　ー　タ NTTデ　－　タ　シ　ス　テ　ム　ズ NTTデ　ー　タ　ク　オ　リ　テ　ィ 日立製作所 IBM このようなカラムのデータが入っているとします ※空白を含むデータや空白を含まないデータがあるとします これを　select * from table1 where col1 like '%NTTデータシス%' とするとNTTデ　ー　タ　シ　ス　テ　ム　ズが検索されるようにしたいと思っています。 replace関数を使って実現しようと思ったのですが SELECT REPLACE(col1,' ','') as col1 From table1 where col1 like '%システムズ%' これだとデータがヒットせず単純に表示するときに空白が削除されるだけです どうすれば空白を含むデータを検索することができるでしょうか できれば全角・半角両方を含む文字のデータでも検索できるようにしたいです SQLServer 2005を利用しています。
いつもお世話になります。 VisualStudio2005とSQLserver2008を利用しています。 現在、クライアント毎に宅配便の利用履歴を表示する機能を作成しています。 メインとなる宅配便マスタに複数のマスタを結合して表示しているのですが、処理が非常に遅くて困っています。 主要な原因は結合の多用だと考えているのですが、どう削減していいものかわかりません。 以下は実際のSQL文です。かなり長いので結合部分だけ抜き出しています。 Dim strSelect As String = "" strSelect &= " select CM.クライアント名 as クライアント," strSelect &= " CO13.汎用名称 as ターミナル," strSelect &= " CO2.汎用名称 as 内容," strSelect &= " CO6.汎用名称 as 便種," strSelect &= " CO7.汎用名称 as 運送業者," strSelect &= " AM1.エリア as 仕入エリア," strSelect &= " AM2.エリア as 請求エリア," For i As Integer = 1 To 8 strSelect &= " CO89_" & i & ".汎用名称 as サイズ" & i & ", " strSelect &= " CAST(FLOOR(TTm" & i & ".単価) as int) as 仕入単価" & i & ", " strSelect &= " CAST(FLOOR(TT" & i & ".単価) as int) as 請求単価" & i & ", " strSelect &= " TM.個数" & i & ", " strSelect &= " CAST(FLOOR(TTm" & i & ".単価 * TM.個数" & i & ") as int) as 仕入金額" & i & ", " strSelect &= " CAST(FLOOR(TT" & i & ".単価 * TM.個数" & i & ") as int) as 請求金額" & i & ", " Next strSelect &= " SM.社員名 as 担当" strSelect &= " from 宅配便マスタ as TM " strSelect &= " inner join (select * from クライアントマスタ union select * from 関連会社マスタ) as CM on TM.ClientNO = CM.ClientNO " strSelect &= " left outer join (select * from コードマスタ where 識別コード=00002) as CO2 on TM.内容NO = CO2.汎用コード" strSelect &= " left outer join (select * from コードマスタ where 識別コード=00006) as CO6 on TM.便種 = CO6.汎用コード" strSelect &= " left outer join (select * from コードマスタ where 識別コード=00007) as CO7 on TM.運送業者 = CO7.汎用コード" strSelect &= " left outer join (select * from コードマスタ where 識別コード=00013) as CO13 on TM.ターミナル = CO13.汎用コード" For i As Integer = 1 To 8 strSelect &= " left outer join (select * from コードマスタ where 識別コード=00008 or 識別コード=00009)" strSelect &= " as CO89_" & i & " on TM.サイズ" & i & " = CO89_" & i & ".汎用コード" Next For i As Integer = 1 To 8 strSelect &= " left outer join (select * from 宅配便タリフ where ClientNO = '" & FlexI & "') as TTm" & i & "" strSelect &= " on TM.仕入エリア = TTm" & i & ".エリア and TM.便種 = TTm" & i & ".便種 " strSelect &= " and TM.運送業者 = TTm" & i & ".運送業者 and TM.サイズ" & i & " = TTm" & i & ".サイズ" strSelect &= " and TM.出荷日 >= TTm" & i & ".適用開始 and TM.出荷日 <= TTm" & i & ".適用終了" Next For i As Integer = 1 To 8 strSelect &= " left outer join 宅配便タリフ as TT" & i & " on TM.ClientNO = TT" & i & ".ClientNO and TM.請求エリア = TT" & i & ".エリア" strSelect &= " and TM.便種 = TT" & i & ".便種 and TM.運送業者 = TT" & i & ".運送業者 and TM.サイズ" & i & " = TT" & i & ".サイズ" strSelect &= " and TM.出荷日 >= TT" & i & ".適用開始 and TM.出荷日 <= TT" & i & ".適用終了" Next strSelect &= " left outer join エリアマスタ as AM1 on TM.仕入エリア = AM1.コード" strSelect &= " left outer join エリアマスタ as AM2 on TM.請求エリア = AM2.コード" strSelect &= " inner join 社員マスタ as SM on TM.社員ID = SM.社員ID" strSelect &= " left outer join 都道府県マスタ as TDM on TM.都道府県 = TDM.コード " strSelect &= " where " & strWhere strSelect &= " order by TM.ClientNO, TM.出荷NO, TM.出荷日" Return strSelect 明らかに無駄と思える箇所としては、佐川急便が一つの伝票で８種類までの重量区分を一度に処理できる形態を取っているため、 サイズ1~8、仕入単価1~8、請求単価1~8を求めるために同じマスタを８つずつ結合する羽目に陥っているところが挙げられますが……。 よい方法がありましたら、是非お知恵を拝借したいと思います。 お手数をおかけしますが、よろしくお願いします。
SQLServer2008＋vb.netでアプリケーションを作成しています。 このアプリケーションは定期的に何度も実行しますが、 タスクマネージャで確認すると SQLServer2008の使用メモリがどんどん増大しているように見えます。 http://blog.livedoor.jp/akf0/archives/51220274.h … などを見て、データバッファキュシュかなと思いましたが、 作ったアプリケーションの処理件数などは、特に毎回増大しているわけでは ないので、どんどん増えていくのはおかしいなと思いました。 なにか原因の可能性があれば、教えて頂きたくお願いいたします。
SiS65１の更新方法を教えてください。
SQL Server Mangement Studioを使って開発をしているのですが データの新規登録や編集をinsert文やupdate文を使わずに GUIでデータを入力して追加登録や編集を行う方法はないでしょうか insert文やupdate文をいちいち作ってデータを挿入していたのでは 時間がかかります。 SQL Server Mangement Studioの機能でそういった事をする方法を 具体的に教えてください。 仕様しているソフトは下記になります sql Server management studio 9.0.0 SQL server 2005
＜環境＞SQLSERVER 一時ワークテーブルのフィールドに指定した番号以降の連番を更新したいのですが、 クエリーで更新する方法はありますか？ 例） ＜更新前のテーブル＞ コード　名前　　連番　 001 　AAA 　null 002 　BBB 　null 003 　CCC 　null ＜更新後のテーブル＞ 15以降の連番を更新する コード　名前　　連番　 001 　AAA　　　15 002 　BBB　　　16 003 　CCC　　　17
SQLのORDER BYについてご教授いただけますでしょうか。 例えば、１０件のデータのうち、５件を指定のORDERBYで抽出し、 残り５件をORDERBYで抽出するということは可能でしょうか。 ID名前 システムフラグ 1 AAA 1 2 BBB 1 3 CCC 1 4 DDD 1 5 EEE 1 6 FFF 2 7 GGG 2 8 HHH 1 9 III 1 10 JJJ 1 上記のようなデータがあった場合、 以下のように抽出されるようにしたいと思っています。 ID名前 システムフラグ 1 AAA 1 2 BBB 1 3 CCC 1 6 FFF 2 7 GGG 2 4 DDD 1 5 EEE 1 8 HHH 1 9 III 1 10 JJJ 1 システムフラグが2が入っているものは、 ５件からの4,5件目に表示されるようにして、 それ以降はIDの昇順で表示されるようにしたいと思っております。 ５件というのは、決め打ち５件ではなく、条件によっては変わるのですが、 ５件が７件となった場合は、6,7件目がシステムフラグ2のものがくるようにしたいです。 指定した件数から下２つ目がシステムフラグのものが取得したいということです。 わかりにくいと思いますが、どのようなSQLを書けば抽出できるか ご教授いただけますでしょうか。 どうぞ宜しくお願い致します。
VB2010とSQL Server2008 R2　でWindowsアプリを作っている新米です。 下のような表（DataDridView）で表示したいと考えています。（本当は月曜から金曜までの ５日間ですが、便宜上４日間で表現しました。） 品名ID　月曜　入荷　出荷　火曜　入荷　出荷　水曜　入荷　出荷　木曜　入荷　出荷 aaaaaa　6/12　2000　1500　6/13　1000　1000　6/14　1300　2000　6/15　3300　2000 bbbbbb　6/12　1000　2500　6/13　3000　4500　6/14　4200　3000　6/15　2000　1000 cccccc　6/12　1000　1500　6/13　1000　3400　6/14　1700　2600　6/15　3500　1000 dddddd　6/12　1500　1800　6/13　2200　1000　6/14　3300　1000　6/15　4100　2200 　・ 　・ テーブル(table_meisai)はこのように構成されています。 meisai_id hinmei_id date in_suryo out_suryo したがって SELECT hinmei_id,date,in_suryo,out_suryo FROM table_meisai WHERE date BETWEEN 6/12 AND 6/16 とすると、当然のことながら aaaaaa　6/12　2000　1500 aaaaaa　6/13　1000　1000 aaaaaa　6/14　1300　2000 aaaaaa　6/15　3300　2000 aaaaaa　6/16　3200　3500 bbbbbb　6/12　1000　2500 bbbbbb　6/13　3000　4500 　・ 　・ と出てきてしまうわけです。 で、これを上記のような「hinmei_id」単位で１行にした「表」にしたいと考えているのですが、 そのSQLがわからないという状況です。 SQLの組立て方法を教えて下さい。 よろしくお願いします。
VB2010　と　SQL Server 2008R2でWindowsアプリを作成しています。 以下に様なDataGridViewを作成したいと考えています。 品名ID　月曜　入荷　出荷　火曜　入荷　出荷　水曜　入荷　出荷　木曜　入荷　出荷　金曜　入荷　出荷 aaaaaa　6/12　2000　1500　6/13　1000　1000　6/14　1300　2000　6/15　3300　2000　6/16　3200　3500 bbbbbb　6/12　1000　2500　6/13　3000　4500　6/14　4200　3000　6/15　2000　1000　6/16　2000　2700 cccccc　6/12　1000　1500　6/13　1000　3400　6/14　1700　2600　6/15　3500　1000　6/16　2500　2200 dddddd　6/12　1500　1800　6/13　2200　1000　6/14　3300　1000　6/15　4100　2200　6/16　1000　1500 　・ 　・ テーブルはこのように構成されています。 【table_meisai】 meisai_id hinmei_id date in_suryo out_suryo ですので、一遍にこのDataGridViewに表現するのは無理な感じです。 それで以下のように考えました。 １）「hinmei_id = aaaa」と「date between 6/12 and 6/16」を条件とした検索を行う。 ２）１）の検索結果をテンポラリーテーブルに書き込む。 ３）１）の検索を「hinmei_id = bbbbb」に変えて行う。 ４）３）の結果をテンポラリーテーブルに書き込む。 ５）３）と４）をすべての hinmei_id に対して行う。 ６）作成されたテンポラリーテーブルに対して検索し、結果をDataGridViewに表示する。 というやり方でできるのではないかと考えています。 ですが、実際にSQLをどのように組み立てたらもいのかさっぱりわかりません。 ご指導下さい。 また、もしかしたら、上記の１）～６）のアプローチ自体が間違っているのかもしれません。 他の方法があったら教えて下さい。 よろしくお願い致します。
【理想】 既にSQLServerExpress2005以降（以下SQL)が入っているPCに対して、 SQLの管理者権限がないユーザーがインストーラーを実行した際、 ・このユーザーは管理権限がないこと ・管理権限があるユーザーは○○というユーザーなので、○○というユーザーで ログインし直してからインストールして欲しい というメッセージを出したい 【現状】 SQLをデータベースとして開発したソフトウェアがあり、 インストーラーを実行すると、SQLと開発したソフトウェアが自動インストールされるようになっています。（既にSQLがインストールされている場合はSQLはインストールしない） インストーラーは、Inno Setupを利用しています。 ここで問題になっているのが、 既にSQLがインストールされているPCにインストールしてもらった際に、 SQLの管理者ではないユーザーでインストールしようとするとエラーになることです。 ユーザーに上記を伝えて、権限のあるユーザーでやり直してもらって（もしくは一旦SQLをアンインストールして）、再度上記インストーラーを実行してもらう必要があるのですが、権限のあるユーザーが誰か答えられるユーザーがほどんどいません。 今は、インストーラーを実行した際、既にインストールされていれば、 仮のデータベースを作るテストをしてみて、出来ればOK、出来なければ、「インストール出来ないから管理権限のあるユーザーでログインしてほしい」のようなメッセージを出してセットアップを中止するようにしています。 インストーラーを実行した際、管理権限のあるユーザーが誰なのかが分かる方法はないでしょうか。色々試してみたのですが、「管理者権限がない」という応答しか返って来ません。 同様の悩み（対応）は他のソフトでも同様だと思いますが、 どのように解決しているのかを教えて頂ければ助かります。 分かる方ご教授お願い致します。
お世話になります。 SQL Server 2005のプロシージャにて テーブルの削除→CSVファイルの取り込み→CSVファイルの削除を行いたいと思っております。 ALTER PROCEDURE [dbo].[テーブル削除＋インポート＋ファイル削除] AS begin DELETE FROM dbo.テーブル BULK INSERT テーブル FROM 'テキストファイル' WITH (DATAFILETYPE='char', FIELDTERMINATOR=',',ROWTERMINATOR='\n') end ここで、テーブル削除とCSVファイルのインポートはできたのですが、ファイルの削除が未だにできません。 このあとテキストファイルをこのプロシージャ内で削除するにはどうすればよいでしょうか。
SQL SERVER 2005を利用し、ストアドプロシージャを作成しております。 あるストアドでwk_hizukeというテーブル(下記の構成)から、tokuisakicode tokuisakicode int, denpyouhizuke smalldatetime を変数@tokucdへ送り、別のストアドを呼び出し@hizuke1を戻り値として メインのストアドへ戻し、@hizuke1を上記テーブルのdenpyouhizukeへ格 納したいというのが行ないたいことです。 wk_hizukeというテーブルには複数のレコードが入っており、そのレコード を一件ずつ読みながら、上記の処理を行ないたいと考えております。 select tokuisakicode set @tokucd = tokuisakicode exec sp_hizukesanshutu @tokucd , @hizuke1output , from wk_hizuke このような構文を記述してみたのですが、エラーとなってしまいました。 根本的に考え違いをしているのかと思い、いろいろ調べてみたのです が、妥当と思われる構文を見出すことができずにおる次第です。 アドバイスいただければ幸いです。宜しくお願い致します。
Sql Serverを構築し、それに接続するODBCを登録しようとするとエラーになってしまいました。 Manegement Studioで接続できるのは確認済みです。 （環境） OS：Windows Server 2003 DB：Sql Server Express 2010 ODBC： 　システムDSN 　サーバー：(local) 　Windows認証 （エラーメッセージ） 接続できませんでした。: SQLState: '01000' SQL Server エラー: 14 [Microsoft][ODBC SQL Server Driver][Shared Memory]ConnectionOpen (Invalid Instance()), 接続できませんでした。: SQLState: '08001' SQL Server エラー: 14 [Microsoft][ODBC SQL Server Driver][Shared Memory]接続が正しくありません。 色々調べてODBCの設定を下記のように変更したところつながりました。 (1)サーバー：localhost (2)クライアントの設定-"ポートを動的に決定する"のチェックをオフ。ポート番号：1433 (2)が無くても設定はできるのですが、無いと最後の接続テストでエラーになってしまいました。 「(local) ＝ localhost」だとずっと思っていたのですが、挙動が異なるので「(local)」はちょっと違う意味合いがあるのでしょうか？
これまでは、Access2007のテーブル(accdb)を共有PCに置いて、 クライアント側のAccess(accdb)で帳票を印刷していました。 保守の方法は、変更のあったオブジェクト(クエリ、レポート等)を 差し替え(削除→インポート)していました。 しかし、クライアントの数が増えてきたため、SQLserverの導入と Accessa(ccdb)のADP化を検討しています。 実際に使っていないのでわからないことばかりなので、質問させて頂きます。 Q1.SQLserverはサーバーでなくても共有ＰＣでも問題はないでしょうか？ Q2.保守の方法としては、サーバー側のクエリとクライアント側のレポート等を 　差し替えるようなこれまでの方法でいいのでしょうか？ 他に方法があれば教えてください。 Q3.現在の100個以上のクエリのうち半数以上は構成を変えるつもりですが、この場合 ウィザードでクエリをストアドプロシージャへ移行してから編集した方がよいか、 １つ１つデザインしなおした方がよいでしょうか？ Q4.SQLserverの導入についての支援サイトなどあれば教えてください。 他にも聞きたい事がありますが、とりあえず回答いただきたいと思います。 よろしくお願いします。
こんにちは、 （SQL server2005環境） ストアドのwhere文なのですが、 codeの条件でtypeが77,88,99のいずれかを検索させたい場合 下記の文になると思いますが、もう少し簡略することは出来ますでしょうか？ WHERE TABLE2.[Code] LIKE COALESCE(@Code, TABLE2.[Code], '') and TABLE2.[TYPE] = '77' or TABLE2.[Code] LIKE COALESCE(@Code, TABLE2.[Code], '') and TABLE2.[TYPE] = '88' or TABLE2.[Code] LIKE COALESCE(@Code, TABLE2.[Code], '') and TABLE2.[TYPE] = '99'
データベースを勉強中の者です。ロックの種類についてどなたかご教示いただけますでしょうか。 ロックの種類は、次の三種類ですよね。 ・共有ロック ・排他ロック ・更新ロック 共有ロックの意味は理解できていると思うのですが、更新ロックがよくわかりません。 更新ロックにすると次のように動作するそうですね。 １．更新を前提にして共有ロックをかける。 ２．更新する前に排他ロックに切り替わる。 排他ロックも更新時に使うロックですが、排他ロックと更新ロックの違いというか、使い分けがよくわかりません。 データを更新するためには排他ロックをかけないといけないのはわかりますが、その前に共有ロックをかける意味は？ http://f29.aaa.livedoor.jp/~snaka/PukiWiki/PukiW … 上のサイトを読んで「デッドロックを回避するため」といったんは理解したのですが、上司は「更新ロックとデッドロックは関係ない」と言います。 私の解釈が間違っているのでしょうか。それとも上司？
ＤＢはSQLSERVER2005です。 メールアドレスの入力チェックをしたいと思っています。 みなさんはどのようなチェックを行うのでしょうか？ 私は、フィールドに@マークが何個あるか確認しようと考えています。 これを確認できる関数はあるのでしょうか？ ご教授お願いします。
現在、SQLServer2000を使って社内システムを構築しています。 サーバーのハード保守切れに伴い、 SQLServer2008へ移行しようとしています。 現在の環境は、 OS　Windows2000Server DB　SQLSERVER2000 アプリ　Windows2000Server 　　　　　VB　6.0で作成 　　　　　（Ctrix社のMetaFrame） となっています。 DBの部分のみ、変更しようとしています。 ハード　64bit　Windows2008Server ソフト　　64bit　SQLServer2008R2 移行に関して、 (1)2000で使っていたDBファイルをアタッチ、デタッチで丸ごと移行できるのか？ (2)アプリの接続部分に変更しなくてはならないのか？ 　（アプリのコンピュータ名は、同じにします。） 詳しい方、ご教授願います。
SQL Server 2008 R2　Visual Studio 2008 テーブルの設計で悩んでいます。 テーブルAのようなデータがあり、実際には、場所のNo.の数は500点くらいあります。 このデータをSQL to LINQでデータの追加、参照をしたいと思っています。 テーブルA,B、どちらの形式で設計する方がよいのでしょうか。 テーブルAの場合は、見た目がそのままで分かりやすいのですが、データ追加時（INSERT）に多数のデータを 追加する方法が分かりません。 テーブルBの場合は、テーブルAの形式で取得する場合、どうすればよいのか分かりません。 ここから先に進めず困っております。よろしくお願いします。 テーブルA 日付No.1No.2No.3No.4No.5 2011/1/1068374138 2011/1/236036946 2011/1/32289631477 2011/1/4758554641 2011/1/5639212690 2011/1/66123774293 2011/1/75452364441 2011/1/87298306648 2011/1/9203891559 テーブルB 日付場所線量 2011/1/1No.10 2011/1/1No.268 2011/1/1No.337 2011/1/1No.441 2011/1/1No.538 2011/1/2No.13 2011/1/2No.260 2011/1/2No.33 2011/1/2No.469 2011/1/2No.546
正規化されてない下記のようなテーブルがあります。 テープル１（主キー：得意先、商品コード） 得意先　　　商品コード Ａ　　　　　　1 Ａ　　　　　　2 B　　　　　　5 B　　　　　　6 B　　　　　　7 C　　　　　　1 C　　　　　　2 これを以下のようにテーブル２つに分けたいです。 テーブル２（主キー：得意先） 得意先　パターン A　　　　　x B　　　　　y C　　　　　x テーブル３（主キー：パターン、商品コード） パターン　商品コード x　　　　　　1 x　　　　　　2 y　　　　　　5 y　　　　　　6 y　　　　　　7 このとき、テーブル1のデーターをもとに テーブル２やテーブル３のレコードを生成したいのですが、 テーブル３を抽出するSQL文がどうしても思いつきません。 （やりたいのは、あらかじめ登録したパターンを得意先ごとに選択するという形にしたいです。） 簡単にできるような気もするのですが．．． パターンについては、ランダムな文字列で構わないです。 SQL文等アドバイスの程、よろしくお願い致します。
C#＋SqlServerでC/Sアプリを作りました。 しかし、現在下記の問題があります。 ご存知の方いらっしゃいましたら、教えてください。 クライアント側はデータをサーバー側に送信します。 サーバー側はデータを受信しながらSqlServerに保存します。 軽量のデータでやるなら、問題は出ません。 しかし、8GBのデータでやると、その途中、いつも下記のエラーが出ます。 Class:11 Index #0 Message: タイムアウトに達しました。操作が完了する前にタイムアウト期間が過ぎたか、またはサーバーが応答していません。 LineNumber: 0 Source: .Net SqlClient Data Provider Procedure: System.Data.SqlClient.SqlException: タイムアウトに達しました。操作が完了する前にタイムアウト期間が過ぎたか、またはサーバーが応答していません。 場所 System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) 場所 System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj) 場所 System.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error) 場所 System.Data.SqlClient.TdsParserStateObject.ReadSni(DbAsyncResult asyncResult, TdsParserStateObject stateObj) 場所 System.Data.SqlClient.TdsParserStateObject.ReadNetworkPacket() 場所 System.Data.SqlClient.TdsParserStateObject.ReadBuffer() 場所 System.Data.SqlClient.TdsParserStateObject.ReadByte() 場所 System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) 場所 System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) 場所 System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async) 場所 System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result) 場所 System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe) 場所 System.Data.SqlClient.SqlCommand.ExecuteNonQuery() 場所 System.Data.Linq.SqlClient.SqlProvider.Execute(Expression query, QueryInfo queryInfo, IObjectReaderFactory factory, Object[] parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries, Object lastResult) 場所 System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(Expression query, QueryInfo[] queryInfos, IObjectReaderFactory factory, Object[] userArguments, ICompiledSubQuery[] subQueries) 場所 System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute(Expression query) 場所 System.Data.Linq.ChangeDirector.StandardChangeDirector.DynamicInsert(TrackedObject item) 場所 System.Data.Linq.ChangeDirector.StandardChangeDirector.Insert(TrackedObject item) 場所 System.Data.Linq.ChangeProcessor.SubmitChanges(ConflictMode failureMode) 場所 System.Data.Linq.DataContext.SubmitChanges(ConflictMode failureMode) 場所 System.Data.Linq.DataContext.SubmitChanges() その他： 　SqlServer2008 R2 　C# .Net3.5 WindowsServer2008 R2
ＡTBLからＢTBLへのINSERT時発番を行いたい ＜環境＞ SQLSERVER 2008 ＜ＡTBL＞ CDvarchar(3)KEY NOintKEY NAMEvarchar(10) ＜ＢTBL＞ CDvarchar(3)KEY NOintKEY NAMEvarchar(10) ＜ＢTBLのデータ＞ CD　　 NO　　NAME 0011太郎 0013次郎 0015三郎 ＢTBLをＡTBLへINSERTしたいのですが、この時、NOを１から再付番したいのです。 INSERTクエリで一発で更新できますでしょうか？ ご教授お願いします。
SQL server 2008 R2 と VB2010 で開発を行っています。 いま、月別の合計金額を計算するSQLがわからなくて困っています。 【売上明細テーブル】 ・明細ID ・年月日 ・得意先ID ・売上金額 出力したい内容は以下のような月別売上合計の推移です。 具体的にはこんな感じです。 得意先ID　３月売上　４月売上　５月売上 --------------------------------------- 0001　　　　　1,111　　　2,222　　　3,333 0002　　　　　2,222　　　3,333　　　4,444 0003　　　　　5,555　　　　　0　　　　6,666 得意先の中には売上の無い月もあります（0003の４月）が、 この場合も一覧に出したいと考えています。 １つのロウの中に異なる条件の値がある場合のSQLの組み立てがわかりません。 どうぞ宜しくお願いします。
MSのライセンスに関してお教え下さい。 階層化されたWebシステムで、DBはAPからのみリクエストを受ける場合、SQLServerのCALの考え方をお教え下さい。 (実利用者分必要orAPのデバイス数分必要)
いつもご回答ありがとう御座います。 UPDATE文だと思うのですが、以下の内容でデータを更新する場合はどうしたら良いでしょうか？ご指南よろしくお願いします。 今回SQL２０００の中に、AとBの２つのデータベースがあり、ＡとＢ両方に顧客マスタというテーブルがあります。　 Ａには顧客番号１、顧客番号２、顧客番号３、と３つの列があります。 Ｂには顧客番号という列しかありません。 （ＡとＢ両方に共通する識別番号があります。（登録Ｎｏ的な）　） データ的には、Ｂには「ＡＡＡ１２３ＤＤ」といった顧客番号があります。 Ａは空です。 このＢの顧客番号「ＡＡＡ１２３ＤＤ」を、 Ａの顧客番号１に「ＡＡＡ」、顧客番号２に「１２３」、顧客番号３に「ＤＤ」、といった形で振り分けてコピーしたいです。 桁数は決まっているので、顧客番号１は左から何桁、といった指定は出来ます。 聞ける人が居ないので、何卒・・・・宜しくお願いいたします。 　　
SQL Server 2000にOracle 11g R2のインスタンスをリンクサーバーとして追加したいです 以下の通りSQL Server 2000にOracle 11g R2のインスタンスをリンクサーバーとして追加することは 可能でしょうか。 ＜サーバー１＞ OS：Windows Server 2003 Standard Edition DBMS：SQL Server 2000 設定内容： （１）Oracle 11g R2のクライアントをインストール （２）サーバー２のインスタンスへのリンクサーバーを設定し、テーブルを参照（更新はしない） ＜サーバー２＞ OS：Windows Server 2008 R2 Standard Edition DBMS：Oracle 11g R2 設定内容：あるインスタンスにサーバー１が参照するためのテーブルを準備 また、さらに別のクライアントPCからMS Access 2010でサーバー１のリンクサーバーに対して パススルークエリを発行したりAccessにリンクテーブルを作成することは可能でしょうか。 SQL Server向けのSQL文が使えますでしょうか。
T-SQLで、テーブルを参照せず、１から30までの雨に連続する値のをもつ30行を取得するには、どのようなクエリになりますでしょうか？ やりたいことは、今日から過去30日間の集計データを表にするということで、そのために、今日から過去30日の日付の行をもつ日付列を用意して、Left Joinしようとしています。 よろしくお願いします。
GWで暇なので　WebからSQL　Server2008　Expressをダウンロードしてインストールして試している所です。 インストールは無事終了して、SQL　Sever　Managementを使って 新しいデータベースやテーブルも作成できました。 元々あったAccessのテーブルをインポートもできました。 しかし、エクセルのVBAで　Recodsetを試みようとしているところですが Sub ボタン1_Click() Set cnnSql = New ADODB.Connection With cnnSql .Provider = "SQLOLEDB" .Properties("Data Source").Value = "PC\SQLEXPRESS" 'サーバー名 .Properties("User ID").Value = "sa" 'ユーザー名 .Properties("Password").Value = "" 'パスワード '.Properties("Initial Catalog").Value = "master" 'サーバー上のデータベース名 .Open End With cnnSql.Close Set cnnSql = Nothing End Sub という簡単なコードで ユーザー　"sa"にログインできませんでした のメッセージで　先に進めません。 SQL　Server management のログイン　sa　のプロパティをみると SQLServer認証　ですが　１５ケタのパスワードが　●●・・・●と出ています。 ●をすべて削除してOKでいても次に開くと元の通りなのですが これが原因かどうかわかりませんが VBA　Recodesetを使って　SQLServerのテーブルに接続して操作したいのです。 どこの設定を見ればよいのかご存知の方、教えてください。 PCは　Windows7　Office2010です。
基本情報技術者試験の問題にＳＱＬの問題があります。 しかし、SQLのプログラムを行ったことがなく、問題がなかなか解けません。 そこで、実際にSQLを操作してみたいのですが、 どのようにすれば利用可能なのでしょうか？ 教えていただけないでしょうか？よろしくおねがいします。
容量不足なため 途中でエラーになり 再度インストールしようとしてもインストールセンターすら立ち上がりなくなりました osはサーバー2003 sp2です どなたかお知恵をお貸しください
SQL-Server2010を使用しています。 レコードを追加する際にキー項目が存在する場合は追加しないようなSQL文を作成しました。 追加するテーブルにレコードが１件以上あれば思ったとおりの処理となりますが、 １件も存在しない場合は追加できません。 下記がそのSQL文です。 原因と対策方法を教えて頂けませんでしょうか？ INSERT INTO foo(商品コード, 商品名) SELECT DISTINCT 'ABC123' , 'りんご' FROM foo WHERE NOT EXISTS( SELECT * FROM foo WHERE 商品コード = 'ABC123' ) 以上です。 宜しくお願い致します。
この春プログラミング業界に就職しました新入社員です。 皆様のお知恵を拝借したく、質問させていただきました。 先日、以下のような処理を任されました。 ・顧客ID,注文NO,商品NO,処理日時からなる注文テーブルに、 ・同一商品の送付対象となる顧客のIDリスト（csvファイル）を元に、 ・新しい注文を追加する 注文テーブルの主キーは顧客IDと注文IDを連結したものであり、 顧客001が過去に３回注文しているとすると、 今回追加すべきレコードは001,4,商品NO,処理日時となります。 急ぎの仕事でしたので格好良さは度外視し、 注文テーブルの注文NOの最大値を求め、 select文で顧客のIDリストと注文テーブルを連結して注文NOを1から最大値まで順に指定して表示し、 顧客IDごとに今回入力すべき注文NOを把握して、 IDリストのcsvファイルをエクセルで編集して顧客ID,注文NO,商品NOからなる テーブルを作って注文テーブルに流し込み、 注文テーブルの処理日時がNULLになっているレコードを指定してgetdate()で現在時刻を放り込みました。 今回は幸いにして注文NOの最大値が3と小さく、 対象の顧客も1000人ほどと少なかったためにごり押しできましたが、 今後も同じような処理をする必要があるときに同じ手が通じるかどうか、 というかミスが怖くて二度と使いたくありません。 もっとスマートな方法があるのではないかと調べてはみたのですが、 顧客IDごとに注文IDの最大値+1を求めてinsertする辺りの処理が探し当てられず、 ここで質問させていただいた次第です。 よい方法をご存知の方がおられましたら、ご教授いただけましたら幸いです。
ＳＱＬＳｅｒｖｅｒにおいてプロファイラを実行するとリアルタイムでトレースが出力されます。 しかし、Ｗｉｎｄｏｗｓをログオフすると停止されてしまいます。 ログオフしてもトレースをファイルに出力し続ける方法を教えていただけないでしょうか？
レプリケーションを行いたいのですが、 パブリケーションを設定し、「スナップショットエージェントの状況を表示」を選択すると、 「次のユーザーおして実行　xxxx\xxxxx　クライアントは要求された特権を保有していません。ステップは失敗しました」 と表示されます。 Windows認証ですと失敗し、SQLでの認証に設定すると成功します。 xxxx\xxxxx　はadministratorの権限を持っています。 Windows認証で行いたいのですが、どこに問題があるのでしょうか？ 一度、OSを再インストールし、データベースはバックアップからの復元しています。 環境：WinServer2008、SQLServer2005 すみませんが、よろしくお願いいたします。
SQL Server 2008 Standard Edition使用です。 Windows2003 Serverのアップデート後、再起動を行ってから、SQLエージェントが 開始できなくなっています。 AdministratorでSQL Management Studioにログインして、SQL Server Agentを右クリックしても 「開始」「停止」「再起動」の文字がアクティブにならず、選択できません。 よろしくお願いいたします。
サーバー（ＸＰ　ＳＰ３／ＩＩＳ５．１／ＳＱＬ　ＳＥＶＲＥＲ２００６Ｒ２）へクライアントから ＤＢ（ＳＱＬ　ＳＥＲＶＥＲ）へデータを登録しようとしたところ 「基礎になる接続が閉じられました。受信時に予期しないエラーが発生しました。」 と出てしまいます。 何が原因で発生するのですか ＳＱＬ　ＳＥＲＶＥＲの設定？ ＩＩＳの設定？ ＸＰの設定？ よろしくお願いします。
SQL Server2008を使用しているのですが、どうのようにデータを取得すれば良いか わからず困っております。 例えば、 名前は違うが全く同じテーブルが２つあるとします。 テーブルAには6レコード、テーブルBには3レコードのデータが存在するとします。 この時、単純に6レコード＋3レコードの 9レコード分をひとつのテーブルとしてデータを 取得するにはどのようなSQL文を書けばよいでしょうか？ SELECT * FROM テーブルA, テーブルBでは18レコードもデータを取得してしまい、且つ フィールド数も増加してしまいます。 宜しくお願いいたします。
OSがWindows Vista SP2 のＰＣに弥生販売11をインストールしようとしましたが、その中の SQL Server 2008 R2 がインストール出来ずに途中でエラーがでます。 解決方法をご存じありませんか？
現在、下記構成にて社内Webを運用しております。 Windows Server2003 IIS6.0 SQLServer2000 ※1台のサーバーでIISとSQLが動いてます。 IISの規定のサイトのプロパティ⇒ディレクトリセキュリティ⇒ 認証方法は『匿名アクセスを有効にする』にチェックが入っており ユーザー名はIUSR_xxxで、統合Windows認証となっております。 また、SQLServer(Windows認証)のユーザーにIUSR_xxxとDomain Users が登録されており、それぞれのテーブルには両ユーザーにSELECTから DELETEまでの権限が付いてます。 現状、Web上からDBを操作(ある情報の検索や抽出)は可能で問題 ありませんが、今の設定だとドメインユーザーがODBC接続にて テーブルに直接アクセス出来てしまいます。 かといって、SQLServerに登録されているDomain Usersを削除 してしまうと、Webアクセスの際、エラーになってしまいます。 Webにはドメインユーザー全員がアクセス可能であり、かつ、 ODBC接続は特定のユーザーのみにしたいのですが、うまくいきません。 どのような設定を施せば可能になるのでしょうか？ 勉強不足なものですから、情報的に足りないものがあるかと思いますが 宜しくお願い致します。
（別のCategoryに載せてしまいましたがみつかりませんので、正しいCategoryで再掲載しています。） T-SQL： Order By の使い方について　(初心者です） 下のような順番で結果を求めています。 Item NO　QTY P001 　　　10 P002 　 　　 8 P003 　　　20 N001 　　　13 N002 　　　50 Q001 　　　5 Q002 　　　33 Q003 　 　　6 Table内のItemNOはA001から alphabetと3桁番号の順番でY005まであるものとして、上記のP,N,QのItemNoのものだけをこの順番で求めたいのです。 もちろん、WHERE-clauseにはこの8件のItemNOの指定はしてあります。 Order by　left(ItemNO, 1) DESC　(またはASCE）, substring(ItemNo, 2,4) ASC これでは、P,N,Qの順番にはなりません。 最初にP Number、次にN　Number、最後にQ Numberを出すにはどうしたらいいのでしょうか。 Order Byの次に8個のItemNOを上記の順番に書いて指定することはできるのでしょうか。 Order Byには "Case When" が使えるとあるinternetで見たのですが、もし使えるとしたらこの順番をだすのに使えるのでしょうか。 ご指導お願いいたします。
初心者ですが、よろしくお願いします。 Access 同様のクエリ操作が出来るのでしょうか？ 例)グループ化、抽出設定、関数の使用、更新・テーブルクエリ 等
いつもこちらで大変お世話になってます。 SQL2005です。　現在、「商品マスタ」というテーブルに、「単価」という列があり、ここには商品の単価が入っているのですが、「1663.2」　という様に小数点が入っているデータがあります。 これを切り捨てて「1663」という整数にしたいのですが、どの様なクエリ文になるのでしょうか？ 先ほど、こちらでご指南頂き、データを1.05倍する、という更新は無事上手くいったのですが、小数点が出てしまいました。 どなたかご教授くださいませ。よろしくお願いします。
どなたか教えて下さい。 SQL2005ですが、「商品マスタ」というテーブルに、「単価」という列があるのですが、この「単価」の数値を1.05倍したいです。　300⇒315のように。 どのようなクエリになるのでしょうか？ 検索掛けたのですが、同様の質問が見付かりませんでした。よろしくお願いします。
こんにちは、 元テーブル⇒取引先テーブル⇒取引先名称テーブル構成から最終的に 結果SQLのように取引先名称１、取引先名称２を 出力したいと思っているのですが、二つを一緒に抽出させることが なかなか出来ません。 多分、複数のSELECT文をどうにかしないといけないのかとは 思うのですが、情報ありましたらお願い致します。 元テーブル ID l 売先コード l 需要家コード 1 l A l B 2 l C l B 3 l A l C 取引先テーブル ID l 売先、需要家コード l 取引先名刺ID 1 l A l A1 2 l B l B1 取引先名称テーブル ID l 取引先名刺ID l 取引先名称 1 l A1 l 売り先名称 2 l B1 l 需要家名称 結果SQL 売先コード l 需要家コード l 取引先名称１ l 取引先名称２ A l B l 売り先名称 l 需要家名称 C l B l (空白) l 需要家名称 A l C l 売り先名称 l (空白)
お世話になってます。 sqlについて質問です。 ddlを発行するとトランザクションは暗黙的にコミットされると思いますが、 select into #temptable ・・・ のように、select into 句で一時テーブルを作成した場合、トランザクションはどうなるのでしょうか？ また、以下のように一時テーブルと普通のテーブルで挙動は変わりますか？ begin transaction select into #temptable from A　←　ここでコミットされてしまう？　…(1) select into temptable from A　←　ここでコミットされてしまう？　…(2) rollback transaction 以上、よろしくお願いいたします。
asp記載は ｓｔｒSql = "Select * From dbo.テスト（テスト） Where 日付='20110324'" objSr.Open str.Sql,objCon.3 ※上記構文前にConnecting.StringやOPENは定義済みです。また、objSrはレコードセットで定義済みです。 質問内容は、このまま実装すると SQLServerエラー（80040ｅ14） '（'付近に不適切な構文があります。 と表示されます。 自分が調べたところ、テーブル名が「dbo.テスト（テスト）」で一部全角カッコがあるるので、 エラーになったのだと思われます。 ちなみに全角カッコではないテーブル名の参照は可能でした。 全角カッコを認識させるにはどうしたらよいでしょうか？ [dbo.テスト（テスト）]は試しましたが（[　]で囲む） オブジェクト名dbo.テスト（テスト）が無効ですと表示され、エラーとなりました。 ご教授をお願いいたします。
SQL Server 2008上に作成している大量のテーブル名を変更したいのですがSQL Server Management Studioで1個ずつ変更するには結構大変です。 具体的に良い方法はないでしょうか。SQL Serverについては初心者です。 よろしくご教示願います。
データセンターにてIIS7+SQLServer2008にて会員制サイトを構築しています。 管理者側の機能を開発するのに、ASP.NETでのWEBベースかWinフォームか悩んでいます。 Winフォームの方が得意なので、開発時間の短縮には繋がりますが 直接Winフォームからデータセンター内のSQLサーバーにアクセス出来るようにするのは安全性に欠けるのでしょうか。 この点がわからず、開発に踏み切れずにいます。 どなたかご存知でしょうか。 ご教授よろしくお願いいたします。
SQLサーバの勉強を始めたばかりの者です。 Accessのテーブルを、SQLサーバに移行したいと考えています。 Acessのサイズアップして SQLサーバにデータを移行することはなんとかできた様子なんですが 今度はそのSQLサーバのデータをAccessにリンクする方法がわかりません。 ネットで検索したのですが Accessのバージョンが違っていたりしてどうもわかりません。 わかりやすく手順など掲載されているサイトがあったら 教えてください！ Access：2007 SQL Server：2008 を使用しています。
Access 2003 VBA で、ADOを使用してSQL Server 2008 R2 Express のテーブルを参照しています。 Seekメソッドを使いたいのですが、Indexプロパティーを設定すると、 「現在のプロバイダーは Index 機能に必要なインターフェイスをサポートしてません。」 のエラーが発生してしまいます。 SQL Server は初心者です。よろしくお願いいたします。 -以下ソースプログラムです- Dim con As New ADODB.Connection Dim rst As New ADODB.Recordset con.Open "Provider=SQLOLEDB;SERVER=xxxxx;DATABASE=xxxxxx;UID=sa;PWD=xxxxxx;" 'SQL-Serverへ接続 rst.Open "testdata", con, adOpenKeyset, adLockOptimistic, adCmdTableDirect Debug.Print rst.Supports(adSeek), rst.Supports(adIndex) ’----結果、　false false rst.Index = "index1" ' ---- 「現在のプロバイダーは Index 機能に必要なインターフェイスをサポートしてません。」のメッセージ rst.Seek 0, adSeekAfter
SQLServer2000 logデータを書き込む領域がなくなりましたというエラーメッセージが出ましたので、 logファイルを削除するためにデータベースをデタッチしました。 このときに何かのメッセージが出ましたが、強引にデタッチをしました。 logファイルを削除し、データベースをデタッチしようとしたところ、 「ログファイルとして指定したファイル名が間違っています。新しいログファイルが作成されます。続行しますか？」というメッセージが出ました。 「はい」を選択すると 「エラー 1813 新しいデータベース’データベース名’を開けませんでした。CREATE DATABASEは中断されます。デバイスアクティブ化エラー物理ファイル名’C:\Program Files\Microsoft SQL Server|MSSQL\Data\データベース名_log_LDFは正しくありません。’」 というメッセージが出て、アタッチに失敗してしまいます。 データベースを復元しましたが、logファイルが無いためか、一ヶ月以上前の時点までしか復元できません。 ldfファイルはありません。（ゴミ箱の中にも） mdfファイルは残っていますので何とかなると期待しています。 大変困っています。 どなたか解決方法をご存知でしょうか。 ご教授よろしくお願いいたします
SQL Serverのトリガの中で、DMLの種類（INSERT/UPDATE/DELETE）を取る方法ってありますか？ こんにちは。アべです。 下記のようなトリガを作成して、操作（INSERT/UPDATE/DELETE）の履歴を 残したいのですが、トリガを３本に分けるのもあれなので、 操作の種類（INSERT/UPDATE/DELETE）を履歴用のテーブルに入れたいのですが、 書き方がわかりません。 取得方法のやり方を教えてもらえないでしょか？ CREATE TRIGGER [mst].[TriggerUserActionHistory] ON [mst].[User] AFTER INSERT, UPDATE, DELETE NOT FOR REPLICATION AS BEGIN SET NOCOUNT ON; --ACTION TYPE未設定 ↓今はINSERT固定しかできない。 insert into [history].[User] select 'INSERT',getdate(),* from inserted; END GO
初歩的な質問ですが、よろしくお願い致します。 あるテーブルで、更新フラグが0のものを検索して ループで処理を行うプログラムを作りました。 その際、更新フラグは1でUPDATEをします。 データは日々増えていきます。 また、既存のデータも変更があった場合には、 （別プログラムから）更新フラグが0戻されます。 このままだと検索スピードがだんだん遅くなると思われますが、 検索スピードが遅くならないような方法を教えて下さい。 よろしくお願い致します。
教えてください。 (1) SQLSever2008内にあるデータベース1のテーブルAのデータを削除 (2) 同じインスタンス内にあるデータベース2のテーブルAのデータを、DB1のテーブルAにコピー (3) (2)の処理が失敗したらロールバック 上記のことを、バッチプログラムで行いたいと思っております。 単にコマンドプロンプトで入力するというのであれば(1)も(2)もできるのですが、 バッチプログラムで行うとなると、どうやっていいのか見当もつきません。 さらに(3)は、(2)でSQLを実行した戻り値も見なければならないと思います。 データベース1のテーブルAとデータベース2のテーブルAはまったく同じ構成です。 自分なりに色々調べてはいるのですがどうしてもわかりません。 もしどなたかご存知の方がいらっしゃったらぜひ教えてください。 どうぞよろしくお願いいたします。
AccessからSQL Server 2008 Expressへの移行を考えているの者です。 現在、Accessにいろいろな文字データ以外にExcelデータをリンクさせて使用しております。 （データ型はOLEオブジェクトのリンクを使っています） SQLServerでもAsseccのように他のアプリケーションやファイルをリンクさせることはできるのでしょうか？ 可能であれば、どの様にすればよいのでしょうか？ よろしくお願いします。
ＰＣにSQL Server 2008 R2が インストールできなくて困っています。 ＰＣＡ会計Ｘの体験版をインストールする前に SQL Server 2008 R2のインストールが 始まり、途中でエラーになり インストールできません。 ＭＳＸＭＬ６がないことを確認したり NET Framework 3.5 SP1 、 Windows インストーラー 4.5、 Windows PowerShell 1.0はインストールしました。 ＯＳはWindows　ＸＰと７です。 Ｖｉｓｔａは普通にインストールできました。 よろしくお願いします。
Oracle暦8年です。 しかし未だかつてSQL Serverを使ったことがないのです。 開発で必要なスキル／知識の差分を知りたいです。 DML、DDLなどSQL的な差は気にする必要はないという認識ですが、 ・DBA関係（Oracleでいうデータディクショナリのようなものからの情報取得） ・バックアップの方法、リストアの方法、 などで困ると思っています。 １●開発で必要なスキル／知識の差分 ２●何か良いサイトや、良い学習方法 を教えて頂けませんでしょうか？
SQL SERVER2005(9.00.3042.00)を使用していますが、 Excel VBAからのINSERT文やUPDATE文をたまに実行してくれないときがあります。 毎回だったらExcel VBA側のバグだと思うのですが、 たまにしか発生しないのでSQL SERVER側の不具合ではないかと疑っています。 SQL SERVER2005の不具合情報、パッチ情報が掲載されているサイト等がありましたら教えてください。 同様の経験がある方がいらっしゃいましたら情報を下さい。 よろしくお願いします。
お世話になります。以下のようにデータ検索するテクニックをご教授ください。 (1) 商品マスタ(商品コード、商品名)の状態 A,ラーメン B,カツ丼 C,カレー (2) 消費テーブル(氏名、商品コード)の状態 田中,A 田中,B 田中,C 林,B これらのデータを元に以下のようにデータを取得。 A.氏名を「田中」で条件指定 → 田中,ラーメン,カツ丼,カレー B.氏名を「林」で条件指定 → 林,カツ丼 ポイントは (1)消費テーブルには、氏名ごとに複数レコード存在するが、それらを１レコードにまとめる (2)条件に応じて、列数を動的に変える 表現が稚拙で恐縮ですが、よろしくお願いします。
SQLサーバー2005＋マネジメントスタジオでビューを作っています。 以下のデータが存在するときに●のついたデータだけを抽出したいです。 明細IDはユニークとし、明細IDの中で一番日付が新しいものだけを取得したいです。 T-SQLでどのように書けばよいか教えてください。 ＜データ＞ 明細ID 日付 111 2010/10/01 111 2010/11/01 111 2010/12/01 ● 222 2010/11/01 ● 333 2010/09/01 333 2010/10/01 ● 444 2010/10/01 444 2010/11/01 444 2010/12/01 ● 555 2010/09/01 ● ＜出力＞ 明細ID 日付 111 2010/12/01 ● 222 2010/11/01 ● 333 2010/10/01 ● 444 2010/12/01 ● 555 2010/09/01 ●
データ出力プログラム(CSV)において、データ増加のため処理時間が長くなり、パフォーマンス改善を図らなければなりません。 そこで質問です。 以下の条件でパフォーマンス改善を図れる方法は御座いますでしょうか。 条件1：プログラムの変更は不可　（select分の改修などは不可ということです） 条件2：サーバスペックの見直しは不可 条件3：キー項目の見直しは不可 以前にオラクルでアナライズにより飛躍的に処理速度が向上した経験があります。 何かのコマンド、またはパラメータの値変更にて処理速度向上が図れる 手段をお教えください。 （SQLではアナライズは自動との認識は御座います。また、SQLServerのパラメータの類は 初期値のままです）
SQL2008 EXPRESSで作成したバックアップをSQL2008 R2 EXPRESSにデータベースの復元で問題なかったのですが、SQL2008 R2で修正があったので修正したあと、2008Ｒ２でバックアップを取ってSQL2008に復元しようとしたらエラーになります。 データベースはバージョン10.50.1600を実行中のサーバーにバックアップされました。このバージョン（バージョン10.00.1600を実行）とは互換性がありません。 と言うメッセージが出ます。 両方をSQL2008R2にすれば問題ないのでしょうが、ＳＱＬ　2008Ｒ２のバックアップをSQL2008に復元する方法をご存知の方は教えてください。 宜しくお願い致します。
Windows7端末に、SQL Server 2005 Expressのインストールを行いました。 システム構成チェックにおいては、全て成功となっておりますが、セットアップの進行状況において、以下のメッセージが表示され、インストールができません。 SQL セットアップ サポート ファイル　　　　　セットアップが完了しました SQL Nativve Client　　　　　　　　　　　　　　　セットアップに失敗しました SQL VSS Writer　　　　　　　　　　　　　　　　　セットアップに失敗しました SQL Server データベース サービス　　　　　セットアップに失敗しました なお、同じ”SQLEXPR_JPN.EXE”を使用して、ＸP端末、Ｖista端末にもインストールを行っておりますが、どちらもインストールは成功しており、目的どおり使用できています。 ※SQLEXPR_JPN.EXEのファイルバージョンは、「9.0.4035.0」でございます。 Windows7端末に、SQL Server 2005 Expressをインストール経験のある方、是非ともご教授ください。
SQLServer２００５ExpressEditionとVB.NETで、ひとつのDBに対して、コネクションを２つ持つことは可能ですか？または、問題などおこりませんか？ 以下のような感じでやってみたところ、両方ともに接続はできましたが、何か問題をはらんでいないかお気づきの方いらっしゃいましたらご教示いただけると助かります。 ' 接続文字列を生成する Dim stConnectionString As String = "接続情報" ' SqlConnection の新しいインスタンスを生成する (接続文字列を指定) Dim cSqlConnection As New System.Data.SqlClient.SqlConnection(stConnectionString) 　　Dim cSqlConnection1 As New System.Data.SqlClient.SqlConnection(stConnectionString) ' データベース接続を開く cSqlConnection.Open() cSqlConnection1.Open() ' 実処理 　　・ 　　・ 　　・ ' データベース接続を閉じる cSqlConnection.Close() cSqlConnection.Dispose() cSqlConnection1.Close() cSqlConnection1.Dispose()
以下のSQLが作りたいのですが 作れなくて困っています。 有識者の方、お助けください。 環境：SqlServer2008 ★詳細説明 テーブルA、B、Cがあるとします。 A-B １対１ B-C は１対N A,B,Cは全て検索・表示対象になります。 A-Bに対する検索表示は問題ないのですが Cの発送区分(1:未発送 2：発送済み)を検索条件と するSQL作成に悩んでおります。 ★テーブル・構成データ A 年度 顧客CD 顧客名称 2010 1000 A社 2010 1001 B社 2010 1002 C社 2010 1003 D社 B 年度 顧客CD サービス開始日 2010 1000 　2011/04/1 2010 1001 　2011/04/2 2010 1002 　2011/04/3 2010 1003 　2011/04/4 C 年度 顧客CD 部署 発送区分 発送日 2010 1000 A 1 2010 1001 A 1 2010 1001 B 2 2010/10/11 2010 1001 C 2 2010/10/12 2010 1003 D 1 2010 1003 D 2 2010/10/20 ★実現したいSQL 1.発送区分に検索条件を設定しない場合 　　年度 顧客CD 発送区分 発送日 　　2010 1000 1 　　2010 1001 2 2010/10/12 　　2010 1002 1 　　2010 1003 2　　　　2010/10/20 2.発送区分を未発送 　　年度 顧客CD 発送区分 発送日 　　2010 1000 1 　　2010 1002 1 3.発送区分を発送済み 　　年度 顧客CD 発送区分 発送日 　　2010 1001 2 2010/10/12 　　2010 1003 2 2010/10/20 1～3を1回のSQLで実行したいのですが 実現できておりません。 よろしくお願いします。
SQL Server 2008 Management Studio についての質問です。 オブジェクトエクスプローラに各データベースのテーブル名一覧が出せますが、 現在テーブル数が非常に多く、目当てのテーブルを探すのに苦労しています。 テーブル名でフィルタリングする方法は無いでしょうか。 オブジェクトエクスプローラに「フィルタ」のアイコンがあるので、 これがそうではないかと思っているのですが、 　名前　　次の内容を含む　　[テーブル名を入力] 　(スキーマ以下　空欄) という設定でOKを押しても、以下のエラーが出て抽出できません。 　この要求のデータを取得できませんでした。（Microsoft.SqlServer.Management.Sdk.Sfc） 　追加情報： 　　　不明なプロパティ　名前　（Microsoft.SqlServer.Management.Sdk.Sfc） エラーメッセージを見ると　名前　というプロパティ指定がダメみたいですが、 このプロパティは固定になっていて変更できません。 （名前、スキーマ、所有者、作成日付　の４つがあります） 何が問題になっているのでしょうか。 そもそもこの「フィルタ」が目当ての機能なのでしょうか。 よろしくお願い致します。
　皆様、お世話になります。 　 　私の会社で、Windows server2008サーバをワークグループで使用しています。 　 　そのサーバーに"SQLserver2008"をインストールして、使用していました。 既存のドメインサーバーが老朽化してきたので、上記のWindows server2008サーバに 　 　移行する事を目的に、Windows server2008サーバにドメインコントローラを 　 　インストールしたところ、(ドメインは一つ、ドメインコントローラは二つの状態になりま 　す)　"SQLserver2008"のサービスが立ち上がらくなってしまいました。 　 　"SQLserver2008構成マネージャ"等で、ドメインのadministratorに変更を 　 　行っても立ち上がらず、途方に暮れています。 　知識不足で大変申し訳ありませんが、なにかアドバイスを頂けたら、助かります。 　よろしくお願いいたします。
SQL Server 2005のT-SQLで、SELECTの結果を カンマ区切りのCSVに出力できますか？ SELECTの結果は１行の場合のあれば、２行以上になることもあります。 やり方、ヒント、参考サイト等を教えて下さい。
みなさんこんにちは。 SQLServer2008R2を稼動しているシステムがあるのですが、ディスクの詳細な使用率について1日に1回、ファイルに出力していきたいと考えています。 具体的には、当該データベースにおける以下の6項目の値が必要です。 ・総使用領域 ・データファイルの使用領域 　└インデックス 　└未割り当て 　└データ 　└未使用 要するに、毎月1回、その月の使用増の状況を記録、把握していきたいという意図です。 当該システムの運用を引き継いだばかりで、SQLServerについてど素人なため、見当違いな質問でしたらご指摘頂ければ幸いです。 宜しくお願い致します。
SQL Server2000からSQL Server2008へ 移行したいです。 Accessからリンクテーブルをして使用しています。 移行後、Accessのプログラムを実行しようとすると、 エラーが発生します。ODBC接続を使用しています。 リンクテーブルマネージャで再リンクしてみたのですが、 うまくいきませんでした。 何かうまくいくためのヒント等わかるかたいらっしゃいますでしょうか？
バッチ処理で、bcpを使ってSQLの実行を行っています。この実行結果(データ抽出)をエクセルに保存させることは出来ませんでしょうか。 ネットでエクセルに保存させる方法がないかいろいろ探してみましたが、探し方が悪いのか方法を探し出すことが出来ませんでした。 最終的には、毎日エクセルファイルにデータを吐き出すことが出来るようにしたいです。
いつもお世話になります。 OS：Windows XP SQL Server2005 ExpressEditionです。 テーブル名：testTable 列 ：(1)number(intで主キーで自動採番）(2)name（nvarchar(50)) ストアドプロシージャを以下のSQL文で作成しました。 insert into testTable (name) values(''); update testTable set name = ltrim(str(SCOPE_IDENTITY())) + '_table' where ｎumber=SCOPE_IDENTITY(); （説明） インサート文；（セミコロンを打っています） アップデート文；（セミコロンを打っています） なぜこんなことをするかと言いますと、 自動採番で取得した番号を列：nameの内容の一部にしたいためです。 つまり、列：numberが１２で採番されたとすると列：nameは 12_table　と したいためです。 ltrimをかけていますのは、str(SCOPE_IDENTITY())の結果、数値の左 に空白が入ってしまうためです。（intのバイト数ほどでしょうか） 想定どおりの値がnameに入っております。 しかしこれは邪道ではないかと危惧しております。 よろしくご教授をお願いいたします。
先日よりデッドロックが発生するようになり、確認の為にトレースログを 抽出するように設定かけたのですが、UPDATE文とSELECT文がぶつかり デッドロックが発生している事がわかりました。 しかし、UPDATE文にはトランザクションをかけていますが SELECT文には特にロックかけていない為、どうして起こっているのか わかっていません。 SELECT文を読んでいる時にUPDATE文によって レコードに変更があった為、デッドロックが発生したのでしょうか? SELECT文にはUNLOCKをつけた方がいいのでしょうか？ プログラムはDELPHI DBはSQLSERVER2000になります。 お忙しい所申し訳ありません。 宜しくお願い致します。
以前同内容で質問させていただきましたが、 再度依頼させていただきたく投稿しました。 下記図を参照願います。 1件の依頼No.にぶらさがる配送先が3か所あります。 この中で一番新しい（＝若い）日付の 配送日&到着日をとりたいです。 配送日と到着日はワンセットと考えて、 新しい日付の配送日がとれたら、自動的に隣の到着日もとれるイメージです。 （例でいけば上から2つ目の配送日:20110106 到着日:20110107） どういう風にSQL文を書いたらいいかわかりません。 どなたか教えて頂けませんか？ ＜テーブルA＞ 依頼No.　 ＜テーブルB＞ 依頼No.　 枝番 配送日 到着日 依頼No.　　枝番　 　　 配送日　 到着日 1111 　　　 1 　　　　 20110107 　 20110108 1111 　　　 2 　　　　 20110106 　 20110107 1111 　　　 3 　　　　 20110108 　 20110109
下記図を参照願います。 1件の依頼No.にぶらさがる配送先が3か所あります。 この中で一番新しい（＝若い）日付の 配送日&到着日をとりたいです。 配送日と到着日はワンセットと考えて、 新しい日付の配送日がとれたら、自動的に隣の到着日もとれるイメージです。 （例でいけば上から2つ目の配送日:20110106 到着日:20110107） どういう風にSQL文を書いたらいいかわかりません。 どなたか教えて頂けませんか？ 依頼No.　　枝番　 　　 配送日　 到着日 1111 　　　 1 　　　　 20110107 　 20110108 1111 　　　 2 　　　　 20110106 　 20110107 1111 　　　 3 　　　　 20110108 　 20110109
SQL勉強中です。下記の様なデータを書き換えたいのですが、どの様なSQL文になるのでしょうか？ ご教授下さいませ。 １つのテーブルに「会員NO」と「会員種別」という列がありまして、 会員氏名　　　会員No　　　会員種別　・・・ --------------------------------- 田中一郎 1-0001 0001　　　　・・・ 鈴木二郎 2-0003 0001　　　　・・・ 会員Noの左端の数値が１なら会員種別を0001、２なら0002といった 形に振り分けたいのですが、どの様なSQL文になるのでしょうか？ 自力ではなんとも上手くいきませんでした。 どうか、お助け下さいませ。
こんにちは。Access 2003を使用しています。Accessのテーブルには１０万件程度のデータがはいっています。 Excelを開き、１行目から順に読み取って、テーブルにインサート・アップデートをしていきます。 例えば、Excel A列にIDがあったとします。AccessのテーブルにそのIDがなければ、インサート、あればアップデートという仕組みにしています。 データ件数が増えてきて、今は１０万件に対し、８万件がアップデートの対象です。処理が終わるのに物凄く時間がかかります。 何かよいアイディアはないでしょうか？例えば、こういった技術を使えばいいとか、こっちの技術を勉強して乗り換えたほうがいいよとかです。よろしくお願いします。
商品テーブル 　商品コード 　商品名 棚卸履歴テーブル 　商品コード 　棚卸日 棚卸履歴テーブルより当年データのみを抽出したテーブルと商品テーブルとを突き合わせを行う。 　(1)棚卸テーブルよりいつ実施しても当年の４月１日以降を抽出する記述方法がわかりません。 　(2)多段クエリの記述方法がわかりません。 上記テーブルを例をもとに記述方法を教えて頂けないでしょうか？ 宜しくお願いします。
SQLについて質問があります。 あるテーブルの項目が、倉庫名、商品名、在庫数量とあった場合、 違う倉庫にある同一商品が数件あったとします。 例えば、 　Ａ倉庫　商品●●　１０個 　Ｂ倉庫　商品●●　２０個 　Ｃ倉庫　商品●●　５個 　Ａ倉庫　商品××　３個 　Ｂ倉庫　商品××　１５個 　Ｃ倉庫　商品××　０個 上記のような場合、●●商品についてはどれも在庫が１個以上 あるので通常に３件取得したいのですが、××商品はC倉庫が在庫０個です。 上記の様に０個の件数が１件でもあったら、その商品については 取得しない様なSQL式を１発で組むことは可能でしょうか？ （上記の例の場合、●●商品３件のみ取得したい） 何故、SQL初心者で初歩的な質問で申し訳ありませんが よろしくお願い致します。
sql2008製品版と無償版との違いについて教えてほしいのですが、これまはずっと仕事でsql2008EXPRESS(無償版)で販売管理などのシステムを作成しています。 新しい仕事のユーザーが店舗数10店舗で今ままでの無償版でやったところより店舗数が多く、データ容量やスピードの問題で製品版を考えています。そのあたりで製品版・無償版どちらがお勧めかを教えてください。 現在、無償版で稼動中のユーザーは５店舗でマシンは2008server R2 メモリー2G １年間のデータで mdfは350MBです。まだ1年間の稼動ですが帳票を見たりするのが遅いとは言われていません。 新しいユーザーもマシンは同等で、10店舗なので1年間のmdfは約700MBになります。 最低５年は同じmdfで管理します。ちなみにプログラムはAccess2003でSQLのデータを見ています。 新しいユーザーでデータ容量・スピードの観点から製品版・無償版どちらが良いか、またなぜ、それが良いかの理由などを教えてください。 宜しくお願いします。
主題の件について教えて下さい。 現在Excel2003のVBAを使用して、SQLServerにODBC接続し、 DBのテーブルデータを取得し、Excelに表示出来ないかを考えているの ですが、VBAの知識がほとんど皆無なので一向に進みません。 何か参考になるページなどありましたら教えてください。 理想はExcelのボタン一つでデータが取得出来れば良いのですが・・・。 よろしくお願いいたします。
sqlservar2005です sysobjectsと sys.objectsって 何が違うんでしょうか？
近々顧客管理ソフトの導入を予定しています。 このソフトはSQLサーバー2000を使用して動くそうなのですが、インストールするマシンには「SMILE BS 会計」という大塚商会の会計ソフトが既にインストールされており、このソフトはSQLサーバー2008を使用しています。 OSがXPのPCに、この二つのソフトを共存させる事は可能でしょうか？ 一応、web上の情報では可能らしいのですが...（2005と2008ですが） http://msdn.microsoft.com/ja-jp/library/ms143719(SQL.90).aspx
ドットネットで作成されたアプリケーションを SQLサーバーを用いてクラサバ形式で業務を行います。 本番実施前に、ノートPCにSQLサーバー2005エクスプレスを入れて テスト環境として1台のみで使用していた際は問題ありませんでした。 本番では、WIN2008サーバーにSQLサーバー2008を入れて使用したのですが、 サーバーに対して、クライアント1台しか接続していない状態でも処理負荷が高く、 動作が非常に遅くなり、ノートPCよりレスポンスが3倍ほどかかるようになりました。 データ件数は同じ状態です。（15万件ほど） 一部のやや複雑な条件抽出処理では、本番サーバー環境側は処理が停止してしまいます。 （ノートPCではやや時間がかかるもののきちんと結果が戻ってきますが、 　本番側は数時間待っても結果が戻らず停止と同じ状態です） 本番サーバーの状況として、メモリ、ネットワークは殆ど使用しておらず、 CPUのみ25%を占有し続けている状態で、処理負荷がかかっているようです。 当然ながらノートPCのCPUよるは遥かに高性能です。 本番環境のSQLサーバ2008で初期データを作成する際、 2005エクスプレスで作成した初期データ（MDFファイル）を 2008側でアタッチしただけです。 テスト環境のノートPCの方が性能が良く、 高額な本番環境のサーバーが使いものにならない状態です。 直すべき点等があればご教授お願いします。
初めて質問させて頂きます。 現在テーブルの中に「時間の長さ」を管理している項目があります。 具体的には ・１時間30分ですと「130」 ・10時間15分ですと「1015」 のように管理してあります。 この項目を10進数で表現し、更に時間を単位として算出したい状態です。 例 1時間30分ですと「130」なので「1.5(h)」として算出したいのです。 このように変換できるファンクションを作成しようとしているのですが、なかなかうまくいきません。 今試している方法としては "時間"と"分"に分けて考えて、"分"は60で除算しようとしています。 それを足しこむ事で、上の例ですと「1 + 0.5 = 0.5」と算出しているのですが "分"がうまく割り切れない場合の端数処理や例外の場合を考えると どのようにファンクションを作ればよいか分からなくなってきました。 どなたか良い例を教えて頂けませんでしょうか。 よろしくおねがいします。
分かる方いましたら宜しくお願い致します。 SQLサーバー2000を使用しているのですが、デッドロックが 発生する場合がございます。 使い方としては インサートするプログラムA SELECTをするプログラムB SELECTをするプログラムC の３本にてテストを行っております。 デッドロックを起こすプログラムは SELECTをかけているB、Cになります。 Aに関してはトランザクションをかけている為、 インサート中はB,Cを起動させてもSELECTを待機しているように見えます。 SELECT中はNOLOCKを指定してません。 （余計な情報を出さない為） 発生する時が稀で、タイミングによるものかの検討も ついておりません・・・ SELECT文同士でもデッドロックは発生するものですか？？ 対処法など分かる方もいらしたら宜しくお願い致します。 乱雑な文章ではありますが、宜しくお願い致します。
初めて質問させて頂きます。 VB内でSQL文を作成し、それをSqlServerに送り実行させているのですが、 VB内でSQL文を作成する時に、Whereの条件を入れたり入れなかったりします。 その時、都度、WhereをつけるのかAndをつけるのか判断してプログラムを書くのが億劫なので Dim SqlString as string SqlString = "SELECT * FROM テーブルA WHERE 0 = 0" IF txtA.text <> "" then SqlString = SqlString & " AND 項目A = " & txtA.text END IF IF txtB.text <> "" then SqlString = SqlString & " AND 項目B = " & txtB.text END IF こういうズボラをしてるのですが、これってSqlの実行スピードに影響したりしますか？ 思うようにインデックス使ってくれなかったりしますか？ ご存知の方がご教授下さい。 よろしくお願いします。
SQLServer2005のバックアップ・リストアコマンドについて教えてください。 自動でSQLServer2005のバックアップ取得・復元を行うバッチを作成することになりました。 バッチの知識はそこそこあるのですが、 SQLServerは触ったことが無いのでどんなコマンドがあるか全然知りません。 ヘルプを見てもうまく見つかりませんでした・・・。 GUIではいつも、 ■バックアップ ・対象DBを右クリック － 「タスク」 － 「バックアップ」を選択 ・バックアップ先を指定 それ以外はデフォルトのまま ■復元 ・対象DBを右クリック － 「タスク」 － 「復元」 － 「データベース」 ・復元用ソースに「デバイスから」を指定 ・「ファイル」でバックアップしたファイルを指定 ・「復元するバックアップセットの選択」にて「完全～」にチェック ・オプションタブにて、「既存のデータベースを上書きする」にチェック ・それ以外はデフォルトのまま といった操作で実行しています。 これと同じことをコマンドで実現したいのです。 どんなコマンドがあるのか？ オプションにどんな指定をしてやればいいのか？ 例を交えて詳しく教えていただけないでしょうか？ 知識をお持ちの方、どうかアドバイスお願いします。
お世話になっております。 サーバーをいじること自体がはじめてで迷走しています； どうかご助言お願いします ＞＜ SQL Serverにおいて ユーザ「9999」がいるとします。 またDB「AA」「BB」「CC」「DD」があり、各DBに「9999」はログインできるようになっています。 各DB内にはそれぞれ複数のテーブルが存在します。 そして各テーブルでは「9999」に 「SELECT、INSERT、UPDATE、DELETE」の権限を与えてあります　　←今ココです そこで質問なのですが、 (1)ユーザ「9999」に与えてあるSELECT等の権限を確認するSQL文は存在しますでしょうか。 　　→「9999」がどのDBのどのテーブルにどの権限を持っているのか、など。 (2)もしくはDBごとに、どのユーザがどのテーブルに対してどの権限を持っているかを 　 確認するSQL文はありますでしょうか。 　　→テーブルごとでも結構です。 「権限を確認するSQLはあるよ」と 先輩に言われ、必死に探しておりますがOracleのものしか見つかりません。。。 とりあえず「9999」がそのテーブルに対して権限を持っているということを 証明したいのです。 　※テーブルのプロパティで権限付与を行ったため、 　　 同じ方法で確認するのは意味がないと言われてしまいました どうかよろしくおねがいします。
初心者です。 MSSQL2005でCドライブに導入されている状態をDドライブに変更したいのです。 現状Cドライブは割り当てが少ない為、今後のデータはすべてDドライブに変更したいです。 今までのデータはCドライブに残っても構わないので、データ部のドライブ変更か 移行方法とその際に考えられるリスクを教えてください。
既にSQLServer2000がインストールされているPCに、 SQLServer2008をインストールし、共存させることは可能でしょうか？ どうしてもSQLServer2000の環境は残したいので。 OSはWindowsXPです。 よろしくお願いします。
VB2010 とSQL Server2008 R2 で開発をしています。 担当者テーブル（table_tanto）と売上明細テーブル（table_uriage_meisai）があります。 各テーブルのカラムは以下です。 table_tanto ・tanto_id ・tanto_name table_uriage_meisai ・meisai_id ・tanto_id ・kingaku ・date ある期間の担当者別の売上実績を一覧で出力したいと考えています。 「table_uriage_meisai」の「date」で範囲指定したいと思います。 結果はこんな形を望んでいます。 担当者ID　担当者名　売上合計 0001　　　○○○　　　****** 0002　　　□□□　　　 　　0 0003　　　△△△　　　****** 0004　　　●●●　　　****** ２点質問があります。 売上の無かった担当者も含めてすべての担当者の一覧を出したいと考えています。 そのSQｌがわからないのと、売上がなかった担当者はその列がNullになってしまうと思うんですが、後の計算で困ります。 Nullのときゼロを返すようにするにはどうしたらよいでしょうか。 以上２点について教えて下さい。 よろしくお願いします。
sqlserver2008で、以下のようなテーブルから、全体のレコード件数を取得したいと思います。 但し条件として、 ・b列とc列が重複しているものは、d列の最新の日付のものを残す。 ・b列が同じものはそのままカウント ・c列が同じものはそのままカウント a列|b列 |c列 |d列 ---------------------------- 1|host1 |100 |2010/10/01 2|host2 |101 |2010/10/01 3|host3 |102 |2010/08/01 4|host3 |102 |2010/10/01 5|host4 |104 |2010/10/01 6|host5 |104 |2010/10/01 7|host5 |105 |2010/09/01 8|host6 |106 |2010/08/01 9|host6 |106 |2010/10/01 10|host7 |107 |2010/10/01 上記の条件実行し、以下のような結果(件数)を求めたい場合どのようなSQLになりますでしょうか。 a列|b列 |c列 |d列 結果(8件) ---------------------------- 1|host1 |100 |2010/10/01 ○ 2|host2 |101 |2010/10/01 ○ 3|host3 |102 |2010/08/01 4|host3 |102 |2010/10/01 ○ 5|host4 |104 |2010/10/01 ○ 6|host5 |104 |2010/10/01 ○ 7|host5 |105 |2010/09/01 ○ 8|host6 |106 |2010/08/01 9|host6 |106 |2010/10/01 ○ 10|host7 |107 |2010/10/01 ○ select文の中にselect文を使ったりするのでしょうか。 内部結合などイマイチ理解できていないためよろしくお願いします。
オラクル初心者です。ご教授ください。 Windows2003でoracle9iを使用しています。 oracleのアーカイブログ（アーカイブREDOログ？？）でディスク領域が圧迫されている ため、アーカイブログを移動したいのですが、どうすれば いいでしょうか？ 普通にＯSでアーカイブログを選択し右クリックしながら ドラッグして移動で大丈夫なのでしょうか？ お分かりの方がいらっしゃいましたら教えてください。 以上、よろしくお願いいたします。
SQL server 2005・メンテナンスプランに関する質問です。 SQL server 2005において、メンテナンスプランで毎日データベースの圧縮と バックアップ、不要データの削除を行っています。 不要データ削除により、バックアップファイルは日に日に小さくなって おり、 メンテナンスプラン開始日より約7ＧＢ小さくなっているのですが、 肝心の データベース本体（mdfファイル）は全く小さくなっていません。 データベースを右クリックし、タスク－圧縮を選ぶと、使用可能な空き領域が 7GBと表示されるので、不要データの削除により空き領域は増えているもの の、メンテナンスプランの圧縮時にその空き領域の解放が行われていない ようです。 そこで、質問ですが、メンテナンスプランの圧縮タスクで空き領域を解放する には下記の設定以外に何か特別な設定が必要なのでしょうか？ 圧縮後に残す空き領域は10％、解放された領域はオペレーティングシステム に返すよう設定しています。 ※SQLのログで気になるのは、圧縮のメンテナンスプランは毎日実行され、 正常に実行されましたと記述されているのですが、実行時間が数十秒しか かかっていないのです。 20GBのデータベースの圧縮で数十秒しかかかっていないというのは実際には 正常に実行されていないのでしょうか？ よろしくお願いします。
DBサーバを再起動したらSQLServerのサービスは自動で起動？ どなたか御教授ください。 WindowsServer2003　に　SQLServer2008をインストールしています。 サーバを再起動すると、SQLServerに対して何もせずにクライアントからDBへ接続できるのですが、 これが仕様なのでしょうか？ サービスなど手動で起動する必要がないのでしょうか？
スペース区切りによるAND検索をSQL文だけで実現したい いわゆるWeb検索等で利用するスペース区切りでのAND検索を SQL Serverでも実現可能かどうかを調べています。 結合に使用するため、プログラムからSQLを組み立てる事が出来ません。 なお、検索したい対象は一時テーブル内の小数データなので、パフォーマンスは特に問題は有りません。 ただし、一時テーブルなのでCONTAINS等を使用する事が出来ません。 せめて一時テーブルに対するフルテキスト検索が出来れば問題ないのですが、、、 以上、よろしくお願いします。
ハングル文字が入らない。 DBを「SQLServer2005」を使って、 ハングル文字を使うシステムを開発しております。 ハングル文字を格納するフィールド（カラム）の型を nvercharで設定しました。 Accessのリンクで直接貼り付けた場合はハングル文字が格納されますが、 insertやupdateでは??が格納されてしまいます。 どうすれば、SQL文でハングル文字が格納できますでしょうか？ 韓国版のSQLServerでないと駄目なのでしょうか？ どなたか教えて下さい。 よろしくお願い致します。
SQLserver2005 テーブル一覧の取得 知っている方には、基礎すぎて申し訳ないのですが、 添付画像のテーブルを選択して、SQLペインを表示させて そこに、 　EXEC sp_tables と記述して、テーブル一覧を取得しようとして「！」マークを 押して、sp_tablesを実行させようとした所、下記のようなエラーメッセージが 出てしまいます。 EXEC SQL コンストラクトまたはステートメントはサポートされていません。 書き方が悪いのか、ストアドプロシージャの実行場所が悪いのかよく分かりませんが うまく行きません。 sp_tablesを使用して、テーブル一覧を取得する方法をどなたか教えて下さい。 よろしくお願いします。
SQLServer2000のバックアップファイルをmsdeにインポート方法 お世話になります。ご存知の方がいましたら以下について教えてください。 【目的】 客先から取得したSQLServer2000のバックアップファイルを、自社の環境にimportしたい。 【問題】 自社マシンのOSは、XPとWindows Server 2008しかなく、SQLServer2000をインストールできません。 仕方なく、現在はXPにMSDNをインストールしました。 このMSDNに客先取得バックアップファイルをimportするにはどうすればよいでしょうか。 【備考】 できれば、コマンドラインよりもフリーのGUIツールを紹介いただきたいのですが。 なければコマンドラインの方法でも構いませんので、何卒よろしくお願い致します。
オンラインゲームやその他のアプリをインストールしようとするとエラーが発生してインストールできません、　「create　Errorcod」とでてきます、なにに問題があるのでしょうか？
SQL Server 2008 を使用しています。bcpコマンドでクエリー結果をエクスポートする際に、1行目に列名を含めるにはどうしたらよいでしょうか？ >bcp "select * from [db1].[dbo].[table1]" queryout output.txt -c -t"," -r"\n" -T などとしてクエリー結果をテキスト出力する際、上記のコマンドを実行すると1行目からいきなり条件に一致したデータで始まってしまうのですが、1行目に列名を含めるにはどうしたらよいでしょうか？
　テーブルＡ(主キー有り)とテーブルＢ（主キー有り）をLEFT OUTER JOINで外部結合したテーブルが 読み取り専用になっていて、データの更新ができないのですが、更新出来る方法が解らずに、困っていま す。この結合したテーブルのデータを更新できるようにするにはどのようにすればよいのでしょうか、お助け 願います。 SQL SERVER 2008 EXEPRESS EDITION をインストールしたＰＣからSQL 2000 serverのデータベースに アクセスしています。
エクセルのオプションで、Enterキーを押した後にセルを移動するで、方向を右にしてるのですが、例えば、この状態で、氏名をマクロを使用して入力した後に、エクセルのオプション設定と同様に右にカーソルを移動したい場合はどうしたら良いでしょうか？ どうしても下になります。素人なので質問自体、上手く伝わらないかも知れませんが、よろしくお願いします。
SQL2005での操作についてご相談です。 初心者に毛が生えたか生えないか程度の知識しかないので、質問に矛盾がありましたらご容赦ください。 ２つのデータベース、AとBがありまして、AとBは同じテーブルが作られています。（BはAをバックアップしたものです） 何かの操作で、Aのデータの一部（会員番号の様な物）が消えてしまったので、BのデータからAへ上書きしたいのですが、そのやり方がわかりません。AのデータはBの時点から更新されてきているので、完全にBに置き換えることが出来ません。 　もし　Aの氏名＝Bの氏名　なら　Aの会員番号　に　Bの会員番号　を上書きする、というイメージなのですが・・・　 ちがうデータベース間でもこの様なことは可能でしょうか？よろしくお願いいたします。
テーブル設計で、項目名の付け方について迷っています。 いつもお世話になっております。 仕事で初めてテーブル設計を任されました。 今はマスタの設計をしています。 そこで、一つ質問があります。 得意先マスタと会員マスタがあって、両方のテーブルに 住所、電話番号があるのですが、この場合は普通、 S_TOKUI_ADDとS_KAIIN_ADD C_TOKUI_TELとC_KAIIN_TEL といった具合に、名前を変えるのが一般的でしょうか。 それとも、テーブルが違うんだから気にせずに S_ADDRESS、C_TELと同じ名前を付けるのが一般的でしょうか。 よろしくお願い致します。
SQL構文について質問いたします。 以下のように2つのテーブルがあるとします。 table1 コード｜地域｜商品 １０１｜千葉｜みかん １０２｜山梨｜もも １０３｜静岡｜お茶 table2 運搬者｜伝票　｜地域｜商品 田中　｜　　　｜静岡｜お茶 斉藤　｜　　　｜千葉｜みかん table1とtable2を比較し、「地域」と「商品」のカラムの値が両方とも一致した場合に、table1の「コード」の値が、table2の「伝票」カラムに転記されるSQL文を作成したいと思っています。 出力結果は以下のとおりになります。 table2 運搬者｜伝票　｜地域｜商品 田中　｜１０３｜静岡｜お茶 斉藤　｜１０１｜千葉｜みかん このような処理を一括で行う方法というのはあるのでしょうか？ もしご存知の方がいらっしゃいまいたら、アドバイスいただけると助かります。 何卒よろしくお願いいたします。
10件位の複数のレコードを抽出するインプットボックスを作る方法を 教えて頂けないでしょうか。 ＭＳAccessではクエリデザインのある列に[]OR[]OR[]OR・・・・10ヶ設定し、抽出したいレコードNOを インプットボックスに入力するとその入力した10件分のレコードの抽出が一度にできますが SQL SERVER 2000 のデータベースのデザイン等で設定することができるのでしょうか
データベースに接続できません java初心者です eclipseで開発を行っているのですが、どうもエラーがでてきて接続できません よろしくおねがいします エラー内容 Exception in thread "main" java.lang.NoClassDefFoundError: DataBase Caused by: java.lang.ClassNotFoundException: DataBase at java.net.URLClassLoader$1.run(URLClassLoader.java:200) at java.security.AccessController.doPrivileged(Native Method) at java.net.URLClassLoader.findClass(URLClassLoader.java:188) at java.lang.ClassLoader.loadClass(ClassLoader.java:315) at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:330) at java.lang.ClassLoader.loadClass(ClassLoader.java:250) at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:398)
データベースのログインユーザー名とパスワードが分からない状態でSQLインジェクション攻撃は可能でしょうか サーバーの構成は以下の通りです ウィンドウズ２００８サーバーR2のIIS7.0＋SQLサーバ2008EXPRESS 以前win2000サーバーでウェブサイトを運営中コンテンツをごっそり抜かれてしまったことがあるので, 攻撃者はソース上からテーブル構造の知っていると考えられます。 現在テーブルに対してinsert処理もしくはUPDATE処理しているファイルは中国方面あるいはアジア圏のIPアドレスからは アクセスできないようにしており、４０３エラーが出るように設定していますので、ファイルに対してポストできないように なっているはずです。 この状態でテーブルへのスクリプトの書き込みは可能なのでしょうか 現在この状態でもスクリプトが書き込まれてしまいます。 仕方ないので、データベースのすべてのログインユーザーに対して書き込み・上書き権限を除外しました。 こうしたところ書き込みはなくなりました こうしてしまうと、商品情報などを登録するたびに、ユーザーに対して書き込み・上書き権限を与える必要があり、非常に生産性が悪い状態になってしまっています。
外部から取り込んだテーブルに主キーを設定するには sql server 2000 のデータベースにsqlserver 2008　express editionをインストールしたPCで別のデータベースのテーブルをインポートウィザードにて取り込み、そのテーブルに主キーを設定しようと、新しいログイン名で-ログイン-セキュリティ-ユーザー-プロパティの画面でセキュリティ保護可能なリソースを選択し、オブジェクトの列の権限にて更新、選択、等許可に設定しても、テーブルの変更が（主キーの設定）ができません。 この変更は、もともと無理なことなのでしょうか。そうだとしたら他にテーブルの列設定を変更する方法はないのでしょうか どうかご教授お願いします。宜しくお願いします。 PC　os XP pro (sql server 2008 express edition) サーバー　WINDOWS 2000 server SQL server 2000
ＰＬ／ＳＱＬの質問 お世話になっております。 下記の様なテーブル「試験項目マスタ」と「クラスマスタ」が二つ有り、 オラクルのＰＬ／ＳＱＬ（ストアドプロシージャ）で、 「試験項目マスタ」の登録ＩＤと「クラスマスタ」の登録ＩＤが同じ場合、 ２Ａ列以降に丸印を付けていきたいのですが（説明が難しく、省略してい ますが、つまり下記の「結果」様にしたいのです。）、 どの様な記述をすれば良いのか分からず困っています。 どなたかご親切な方、ご教授頂きたく宜しくお願い致します。 　　　　　　記 「試験項目マスタ」 登録ID大項目中項目小項目 2A　 2B　 2C　 2D　 2E　 2F　　2G　　2H　　2I　　2J　2L 0001学科試験　国語　　　古文 0002学科試験　数学I 0003学科試験　数学 0004学科試験　化学 0005学科試験　世界史 0006学科試験　日本史 0007学科試験　英語　　　英会話 0008学科試験　体育　　　サッカー 0009学科試験　音楽　　　合唱 0010学科試験　技術 「クラスマスタ」 登録IDクラス 00012A 00012C 00012D 00012F 00012H 00012J 00022B 00022E 00022G 00022I 00022L 　・　　　・ 　・　　　・ 　・　　　・ 　↓ 結果 登録ID　　大項目　中項目　小項目　2A　　2B　　2C　　2D　　2E　　2F　　2G　　2H　　2I　　2J 0001　　学科試験　国語　　　古文　　○　　　　　 ○　　　○　　　　　　○　　　　　　○　　　　　○ 0002　　学科試験　数学I　　　　　　　　　　　　○　　　　　　　　　○　　 　　　　○　　　　　　○ 0003　　学科試験　数学 ・　　　　・　　　 ・ ・　　　　・　　　 ・ ・　　　　・　　　 ・ ・　　　　・　　　 ・
連番のMin, Maxを取得したい 下記のデータが格納されたテーブルで、 部署コードのまとまりごとに、連番のMin, Maxを取得したいと 考えています。 SQLで、期待する結果を取得したいのですが、 なかなかよい案がなく、困っております。 何かよいアイデアがあれば、ご教授頂きたいと思い、質問致しました。 対象DBは、 SQLServer2008 Standard Editionです。 検索するテーブル RENBAN　　　　　　BUSYO_CD ---------------------------------------- 1　　　　　　　　　　AAA 2　　　　　　　　　　AAA 3　　　　　　　　　　AAA 4　　　　　　　　　　AAA 11　　　　　　　　　 BBB 12　　　　　　　　　 BBB 13　　　　　　　　　 BBB 21　　　　　　　　　 AAA 22　　　　　　　　　 AAA 23　　　　　　　　　 AAA 24　　　　　　　　　 AAA ---------------------------------------- 期待する結果 BUSYO_CD　　　RENBAN_MIN　　　RENBAN_MAX -------------------------------------------------------------- AAA　　　　　　　1　　　　　　　　　4 BBB　　　　　　　11　　　　　　　　 13 AAA　　　　　　　21　　　　　　　　 24 -------------------------------------------------------------- ※データは、あらかじめ連番(昇順)でソートされています ※連番は、部署コードが同じ間は、続き番号となっていますが、 　部署コードが変わると、続き番号にならない可能性があります。 ※同じ部署コードのまとまりが、複数回出てくることがあります。 　（上記例でいえば、連番１～４のAAAと、21～24のAAAは同じ部署コードです） よろしくお願い致します。
SQL Server 2005 EXPRESS Developer Editionの機能について 現在、開発用パソコンと本番サーバー用パソコン間で、データのインポート・エクスポートの為だけにDeveloper Edition を使っています。 Developer Editionは開発・テスト用途と言う事ですが、本番環境との違いとは何ですか？ 本番環境で使うと、どういった制限が有るのですか？ ご存知の方、よろしくお願いします。
Windows XP Pro のPCにて現在　access2000 + VB6.0 にてスタンドアローンにてシステムを運用中です　このシステムをクライアントPC2台にて運用したいのですが・・　排他の問題等でSQL-SERVER を入れたほうがいいのかどうか検討しております　DBを導入する場合やはりSQL SERVER でしょうか？またWIN-XP なのですがSQL-SERVER は導入可能なのでしょうか？　知恵を貸して下さい　ACCESS2000 では無理なんでしょうか？DBロックでPGがエラー起こします
ＳＱＬ初心者です。 ３項目が一致した重複データを省きたい。 テーブルＡには　誕生年　名前　年齢　が　入っていて 誕生年、名前、年齢が同じレコードははぶきたいのですが、 どのように書いたらいいでしょうか。 Windos XP 言語：vbs DB Micosoft Sql server 2008
SQLserver2000 standard edition (32bit) をWoW64エミュレータを使用して動作させるためWindows Server 2008（64bit）のプリインストール版サーバーにインストールしようとしていますが、添付のようなメッセージが出力され拒否されます。 可能という記事をみ WoW64エミュレータは既にインストールされていることを確認しました。 インターネットでも調査しましたが、WindowｓServer 2008（64bit）のプラットホームで動作可能 の記事を見て挑戦しているのですが、なかなかうまくいきません。 SQLserver2000のインストール方法をご教示ください。
bcpによる、テーブル→CSVファイル出力について SQL Server(2003)のクエリアナライザからテーブル->ファイル出力を試みたのですが、うまくいきません。 サーバからの実行ではなく、クライアントのEnterpriseManagerのクエリ実行です。 このエラーは、サーバ接続自体がうまくいってないということでしょうか？ exec master.dbo.xp_cmdshell 'bcp xxxxx.dbo.コピー元テーブル名 out C:\AAA.csv -c -S サーバ名 -U 接続ID名 -P 接続パスワード' 実行結果 SQL Status=S1000 ,NativeError=0 Error=[Microsoft][ODBC SQL Server Driver]一括コピーホストのデータファイルが開けません。 csv->テーブルについては、BULK INSERTで問題無く取り込めているので、単純に逆を行いたいだけです。 bcp使わない方法があれば、それでもいいのですが。。。。。
SQLの書き方 SQL初心者なのですが、わからないことがあるので教えてください。 表Employees (EmployeeID,EmployeeName) 表Salary (PayDate,Amount,EmployeeID) という2つの表があるときに、次の問題があります。 問題：表Employeesから各EmployeeIDについて、SalaryのAmountの最高が300,000以上のデータを取り出し、EmployeeID,EmployeeName,Amountの最高額を表示しなさい。 答えが SELECT EmployeeID ,EmployeeName ,( SELECT MAX(Amount) FROM Salary WHERE EmployeeID=Employees.EmployeeID /*GROUP BY EmployeeID*/ ) FROM Employees WHERE EmployeeID IN ( SELECT EmployeeID FROM Salary GROUP BY EmployeeID HAVING MAX(Amount)>=300,000 ) ; となるのですが、/*と*/の間の文がいらないのはなぜですか？選択リストの中の副問い合わせで、MAX(Amount)というのがあるのでグループ化しなければならないと思うのですが、よくわかりません。
SQLサーバーのジョブでのexeファイル実行について教えてください。 FTP転送を行うバッチ(拡張子bat)を作成しexeファイルに変換してから SQLサーバーのジョブから実行しようと思っています。 batファイルからexeファイルへの変換は WindowsのIExpressとBat_To_Exe_Converterというツールを使用しました。 SQLサーバーにジョブを作成してバッチを実行させようとしたんですが batファイルのままであれば実行できるのに、exeファイルで実行させようとすると ジョブが実行中のままになり止まってしまします。 exeファイルは直接実行させると想定の処理が実行させるので 壊れていることは無いと思います。 原因の検討がつかず困っています。 些細なことでもいいので何か教えて頂ければと思います。 宜しくお願いします。 尚、exeに変換するのはバッチファイルの中身を見せないようにする為です。
アクセスについて質問です。緊急です。 発注のシステムに、私が触ったせいで不具合がおきてしまいました。まず、しくみは、ヘッダー入力フォームでオーダーナンバーと仕入先を記入します。そしてそのあと詳細を書きこむフォーにうつり、商品番号などの詳細を入力するようになっています。 このとき、以前は、詳細を書きこむフォームの端にオーダーナンバーの欄があり、ここには、さきほどヘッダーで入力したオーダーナンバーが自動で入っていました。 そのため、その詳細フォームのテーブルには、オーダーナンバーも詳細も、すべて一緒のデータとして入っていたのです。しかし、私がその（テキストボックスだったか、何ボックスかわかりませんが）オーダーナンバーの入ったボックスを消してしまい、それ以降、詳細フォームを入力しても、詳細がテーブルに入るのみで、オーダーナンバーとは連結しなくなってしまったのです（テーブルにオーダーナンバーが入っていない） この、元のように、詳細フォームの画面に詳細テーブルのオーダーナンバーにつながるボックスを置き、（ここまではできます）　そこに、オーダーナンバーが自動で入力されるようにする（これができない）にはどうしたらよいのでしょうか？ どなたか、本当にお願いいたします。
『SQL』の勉強の仕方。 SQLの勉強方法として、何かオススメはありますか？ あれば教えてください。
Windows Server 2008 EXPRESSのテーブル別のユーザー権限設定方法を教えてください Windows Server 2008の初心者です。 Windows Server 2008 EXPRESS上でテーブル別、ユーザ別に SELECTやINSERT、UPDATEの権限設定はできるのでしょうか 設定方法が分からなくて困っています。
accessからsqlserverへの移行について！ accessからsqlserverへの移行することにしました。 問題が起きないよう先日質問させて頂いた内容でもう少し詳しく教えてください。 以下が前回の内容です。編集をしています。 accessの処理はそのままでDBをsqlserverからODBCでリンクしようと思います。 現在の運用環境はサーバは使用せずファイル共有で4台のPCで運用しています。OSはWinXPです。 現在のマシンは４台とも３年前に購入したPentiumの2.40GHzメモリは2GBです。 今回も専用サーバは使用せず現在のPCにSQLServer2005無料を使用と思っています。 データ件数は約3万件で必要な項目にはインデックスを付けてリレーションも張っています。 計算項目が多く定義と参照項目含め約300項目となり、クエリーをNo.1とNo.2の2個のに分けています。 クエリーはデータやマスタとリンクしています、No.2はNo.1の式の値を使用し計算しています。 計算式は複雑なものや計算結果⇒計算結果⇒・・・・となっています。 入力画面はレスポンスが遅く、単票印刷で約30件の処理に5～10分位かかるものがあります。 印刷はワークテーブルに必要項目を出力する等をやって見ましたが改善しませんでした。抽出に時間がかかっています。 DBをsqlserverに移行することで処理速度の改善はどの程度見込めるのでしょうか。 計算項目数が多いのであまり見込めないのではと思っています。 頂いた回答です。 ＞それら複数のテーブルをサーバーに置いてリンクテーブルにし、従来通りのクエリーをそのまま使った場合は、確実に遅くなります。 ？これはsqlserverのデータをリンクしクエリーはそのままにしたら遅くなるのでしょうか。 　対象方法はsqlserverにクエリーをVIEWで定義すればいいでしょうか。対処方法を教えてください。 ＞高速化にはそれなりのテクニックが必要です。 ？参考になるサイトがあれば教えてください。 ＞やはり抽出に時間がかかりあまり改善しませんとのことですので、計算式なしで［select * from ...等］にしてみて流してみてください。 ？早くなった場合必要な値はどの様にして取得しているのでしょうか。 ＞やはり、エンジンを置くPCの性能がカギで、これが遅いのでは期待はできないとしたものです。聞けば同じマシンで代替するとのことなので、あまり期待しない方がよい と思います。 ？サーバを設置しサーバOSにするとにより処理速度はかなり速くなるのでしょうか。 　専用サーバも高価なものは買えないので現在のPCと同等程度の性能となります。 よろしくお願いします。
SQLServerのテーブルはdbOpenTableで取得できない？ いつもお世話になっております。 VB6.0、Access2003で開発されたシステムのデータベースを SQLServer(2008Express)に置き換えています。 接続方法は、現行通りのDAOを使用したいと考えております。 レコードセットをオープンするときに、 Set RS = DB.OpenRecordset("テーブル名", dbOpenTable) としたら、「引数が無効です」というエラーが発生しました。 dbOpenTableの所をdbOpenDynasetに変更したらエラーは発生しなくなりました。 SQLServerへの接続の場合、dbOpenTableは使用できないのでしょうか？ dbOpenTableが使用できないとなると、IndexやSeekも使用できないということでしょうか？ 以上です。よろしくお願い致します。
accessからsqlserverへの移行について！ 現在accessでシステム運用しています。 処理に時間がかかるのでDBのみsqlserverへの移行を検討しています。 時間がかかる原因は計算項目が多く計算の為に必要な定義項目と参照項目で計算項目を含めると約300項目となります。 この為、クエリーをNo.1とNo.2の2個のクエリーに分けて対処しています。 クエリーNo.2はNo.1の式の値を使用し更に式で計算しています。 クエリーで定義している計算式も条件が複雑なものもありさらに計算結果⇒計算結果⇒・・・・となっています。 この様な内容なので入力画面はレスポンスが遅く印刷は5～10分位かかるものがあります。 とりあえず印刷処理を早くしたいと思い一旦ワークテーブルに必要項目を出力する等をやって見ましたがやはり抽出に時間がかかりあまり改善しません。 データ件数は約3万件なのでデータ件数は問題ないと思っています。 accessの処理はそのままでDBをsqlserverからODBCでリンクしようと思います。 DBをsqlserverに移行することで処理速度の改善はどの程度見込めるのでしょうか。 計算項目数が多いのであまり見込めないのではと思っています。 accessからsqlserverへの移行された方でどの位改善されたのか教えて下さい。 現在の運用環境はサーバは使用せずファイル共有で4台のPCで運用しています。OSはWinXPです。 今回も専用サーバは使用せず現在のWinXPのPCにSQLServer2005無料を使用しようと思っています。 又、accessの処理で他に早くする方法がありましたら教えて下さい。 よろしくお願いします。
BCPコマンドのリダイレクト値が空になる 現在、VB.NET2005で開発を行っております。 バッチファイルにて、SQLServerExpressからCSVを作成しているのですが、 リダイレクトの出力結果をログファイルに出力する際 結果が空になる場合があるのです。 SQLExpressを止める等、強制的にエラーを起こしてみたりしたのですが その場合は接続エラーがでますし、正常の場合は「コピーを開始中です...以下略」 と何かしらのメッセージが出力されます。 ログが空になるというのはどういう場合が考えられるのでしょうか。 お分かりの方がおられましたらお力をお貸しください。 お願いします。 バッチの中身は ****************************** BCP "SELECT * FROM TABLE" queryout D:\AAA.csv -c -t , -r \n -S localhost\SQLEXPRESS -U XXX -P XXX > D:\AAA.log ****************************** こんな感じです。
SQLserver 2005 の評価版を利用したいのですが・・・ 自己学習用に2005の評価版を利用としたところ、すでに提供がおわっていました。 2008でもよいのですが、2008からは64bitのみ対応の様子です。 64bitマシンを購入する以外に手軽にスグに実行出来る良案は何かありますか？ ###### 以下の方法があればよいのですが・・・ ●2005　エンタープライズ　の製品版を格安で入手 ●2008を32bitOS上にインストールして使う方法 ●提供終了2005評価版を入手する方法 等
SQL Server 2005 Expressのインストール時のMSXML構成不能によるインストール失敗について。 この質問は色々なところで出ていると思うのですが、以前はMicrosoft自身が提供していた、Windows Installer Cleanup ユーティリティで解決可能だったのですが、現在このツールは提供されていません。 （同じKB番号でOfficeに関してのアンインストールツールの提供となっています） どなたか、他の方法でSQL Server 2005 ExpressインストールにMSXML6の構成ができないためインストール出来ない事象について、解決なされた方はおられませんでしょうか？
SQLで違うテーブルの集計結果を比較することは可能でしょうか？ 例えばAテーブルがこんな感じです A1＿ A2＿ A3＿＿＿ A4 ＿＿＿＿A5 XX＿ YY ＿5 ＿＿2010/8/13 ＿10：00：59 Bテーブルはこんな感じです。 B1＿ B2＿ B3＿＿＿ B4 ＿＿＿＿B5 XX＿ YY＿ 米 ＿＿2008/5/20＿ 00：00：00 XX＿ YY＿ 味噌 ＿2009/8/22＿ 01：02：33 XX＿ YY＿ 卵＿＿ 2007/8/21＿ 23：35：55 XX＿ YY＿ 醤油 ＿2010/7/16＿ 15：30：35 XX＿ YY＿ 胡麻＿ 2010/8/13＿ 02：02：02 です。 見つけたい条件はBテーブルに指定した日付が含まれてる（例えば今日8/13だとか）レコードがあればそのXXとYYが何件あるかカウントをしてその値がAテーブルのA3の値と同一か調べたいのですがこういうことは出来ますでしょうか？ SQL Server2005です
開発環境 Win 7 Apache 2.2 PHP 5.5 MySQL 5.1 MySQLをインストール後環境設定ができません。 Server instance configure wizardを使用して何度か試みましたが MySQl自体が応答無しとでてしまいます。 一応インスタンス自体はインストールされてるみたいなので、MySQLのサービスを 開始しようとするとエラー1067のエラーがでます。 恐らく、環境設定が最後まで出来ていないのが原因だと考えられます。 どうすれば、この現状を打破できますでしょうか。 以上、よろしくお願いします。
transact-sqlからoracle DBを参照したい。 sql-server 2005 window server 2003 R2での環境です。transact-sqlを使用して、他のマシン上にあるoracle データベース上のテーブルのデータを取得し、そのデータを自身のマシン上のsql serverのテーブルに格納したいのですが、そのようなことはできますでしょうか。 もし、できるとすれば、どのような方法（手順）になるのでしょうか。
SQLのデータベースに韓国語を登録すると文字化けしてしまいます 韓国語登録でも文字が化けないようにするにはどうしたらいいでしょうか？ SQLのバージョンは２００５です よろしく御願いします
他のＤＢのテーブルと内部結合が可能でしょうか sql sever 2005 を使用します。このたび、データベースＡのテーブルａを定期的に検索するsqlを作成することになりました。このsql文は、ストアードプロシージャとして登録予定です。 その際、テーブルｂを内部結合で参照します。例として、テーブルａは社員番号があり、テーブルｂは社員番号、社員名があります。（テーブルｂは社員マスター） テーブルａを参照し、その社員名を内部結合（INNER JOIN）で取り出します。 ここで、テーブルａ，ｂが共に、同じデータベース内にある場合は、問題ないのですが、 テーブルｂは、別のマシンのsql sever 上にあります。（したがって、データベース名も異なります） このような状態で、内部結合による参照は可能でしょうか？ また、内部結合ができないまでも、ストアードプロシージャで、データベースＡのテーブルａを参照しながら、別のマシンのデータベースＢのテーブルｂを参照することは、原理的に可能でしょうか。 なお、データベースは共にsql server 2005を使用します。
論理名と物理名の違いについて SQLServer2005を使ってDBの設計をしている者です。 SQLServerではカラム物理名を論理名と同じように 日本語の名称で作成できるようなのですが 論理名と物理名を両方とも日本語でこのまま設計して大丈夫でしょうか。 物理名を英語表記にしておかないと パフォーマンスが低下するなどの弊害があるのでしょうか？
SQL SEREVER で選択した固定値との結合について質問です。 日付と紐付けたデータを1ヶ月分出力するSQLを作成しています。 紐付け対象となるデータに、1ヶ月毎日のデータが存在するわけではありません。 そこで、固定値として2010年7月であれば、 2010-07-01～2010-07-31 までの日付を全て固定値として取得 （対象データは行で取得したいのでUnionで繋いでいく）して、 その日付と紐づく対象データを外部結合しようと考えました。 SqlServerの場合、固定値のみを取得した場合 ダミーテーブルを使用するということができないようなので、 取得した固定値との紐付け時に下記???のところの指定がわかりません。 Select '2010-07-01' 日付 Left Join 結合対象テーブル On 結合対象テーブル.日付 = ???.日付 他のやり方で実現可能なのかもしれませんが、調べてもわかりませんでした お解りになる方いらっしゃいましたら、教えていただければと思います。
Xampp上で、sql server 2005を動かすには？ 開発環境で、ひとつのＰＣ上でサーバー側「sql server 2005」と、クライアント側のアプリを構築しなければなりません。 この場合、Xamppを使って「sql server 2005」を構築すればいいと思いますが、何せこの辺の知識を持ち合わせておりません。 動作環境は、Windows XP(SP3)です。 参考になりそうなＷｅｂサイトなどを、教えていただけませんか。 以上、よろしくお願いします。
T-SQLで10万件程度のInsert処理を記述したい。 カーソルを利用したループ処理の中で、 Insert失敗時（エラー時）のみ、そのデータだけスキップし、 次のデータ登録処理に進みたい場合、 どのように記述すればよいのでしょうか。
WHERE条件の最終桁のスペースについて質問です。 あるテーブルのカラム(colA)に"1234"というデータがあるときに、 (1)SELECT .... WHERE colA='1234' (2)SELECT .... WHERE colA='1234 '　　(1234の後に半角スペース) (3)SELECT .... WHERE colA='1234　' (1234の後に全角スペース) (4)SELECT .... WHERE colA='12345' を、実行すると、(1)だけＯＫで、他はＮＧとなると思い込んでいましたが、 実際は、(2)と(3)も同じように検索されてしまいます。 WHERE条件の最終桁のスペースは無視される？ こういうものなのでしょうか？ オンラインヘルプ等からは、それらしい情報が見つけられなかったのですが、もしこの辺の情報がわかるサイト等ご存知でしたら教えてください。 ちなみに、 SQL-SERVER2005(照合順序:Japanese_CI_AS) colAは、varchar(20) です。 p.s. 基本中の基本かもしれませんが、いままでずっと勘違いしていたので、過去の納品してきたお客様の件数を考えて恐ろしくなっています。(T.T)
大規模なデータウェアハウスを構築・運用するための主要テクノロジー http://www.computerworld.jp/eye/t/sql/server2008 … パーティション テーブルとパーティション インデックスに対するクエリ処理の機能強化 http://msdn.microsoft.com/ja-jp/library/ms345599 … パーティションの切り替えを使用した効率的なデータの転送 http://msdn.microsoft.com/ja-jp/library/ms191160 … パーティション テーブルとパーティション インデックスの変更 http://msdn.microsoft.com/ja-jp/library/ms175864 … パーティション・テーブルにおけるパフォーマンスの考察 http://blogs.msdn.com/b/sqljapan/archive/2007/06 …
別のテーブルの値を抽出条件としたい。 環境は SQL Server2005、Access2003（Accesプロジェクト adb）です。 テーブル「社員台帳」で、年度ごとに社員の情報を管理しています。 イメージはこんな感じです。 　　　　年度　　社員　　　基本給 　　　　2009 aaa \1,000 2009 bbb \1,050 　　　　 ・ 2010 aaa \1,020 2010 bbb \1,080 これとは別に年度を管理するテーブル「年度辞書」があります。 これは、1レコード(件）のみデータがあり、毎年書き換えています。 イメージは・・・ 　　　　　 　　　　　年度　　開始日　　 終了日 　　　　　2009 2009/04/01 2010/03/31 2010年度では上記データを変更します。 そこでお聞きしたいのは、テーブル「社員台帳」からデータを抽出する処理を作りたいのですが、 Accessでは クエリの抽出条件(年度）に、　Dlookup("年度","年度辞書"）　としていました。 これと同じことがしたいのですが、その方法がわかりません。 どうすればよろしいでしょうか？ よろしくお願いします。
SQL文で質問 いつもお世話になっております。 ＳＱＬ文について質問です。 仮にですが、商品マスタというテーブルと、対応テーブルという二つのテーブルがあります。 対応テーブルには、商品コードが親コード、子コードといった形で構成されています。 対応テーブルのいくつかの親のコードを条件に、親コードと子コードを検索して、それぞれの商品名を検索したいと思っています。 現在、ＳＱＬ文で、親コードに対応した商品名だけを取得しているのですが、子コードに対応する商品名も検索したいと思っています。 現在のＳＱＬ分としては、 SELECT 対応テーブル．親コード、商品マスタ．商品名、対応テーブル．子コード FROM 対応テーブル,商品マスタ WHERE 対応テーブル.親コード = 商品マスタ．商品コード AND 対応テーブル．親コード = 1000,1002,1004 このＳＱＬ文で検索した子コードで、商品マスタの商品名を検索したいのですが、どのようなＳＱＬを書いたらよいのでしょうか。 ご教授願います。
エクセルでのデータベース作成ってどうですか？ 仮に飲食店の顧客データをデータベースを作って管理するとします。 その際ふつうは ＳＱＬサーバなどで管理しますよね？（一般的にどうしているのかよく知りませんが・・・） ＳＱＬなどの代わりにエクセルでデータベースを作ることに関して メリット、デメリットを教えてください。。 また、飲食店の顧客データベースを作成する際 一般的にどのように行っているのか、もしわかるようでしたら 合わせて教えてください！！
SQL Server 2005 EXPRESSでログが出力されない。 テスト用として動かしているSQL Server 2005 Developer EDITIONのManagement Studioを起動させてログフォルダをクリックするとログデータは表示される。 しかし、別のパソコンで本番用に稼動させているEXPRESS EDITIONのManagement Studioからオブジェクトエクスプローラ - 管理 - SQL Serverログ - 現在をクリックするとログデータが表示されません（ログファイルの表示画面が開かない）。 ここには現在 ,アーカイブ#1～#6の計７つのフォルダは有りますが、どれをクリックしてもログが表示されません。 EXPRESS EDITIONではログを出力する為の設定とかが必要ですか？ 本当にログが出力されていないのか、それともログ画面表示の部分がまずいのか、ご教授お願いします。
AccessのクエリをSQL Server2005で書き直したい。 誕生日の翌日を雇用契約の開始日（契約開始日）とするAccessのクエリがあります。 契約開始日: DateSerial(Year(Now()),Mid([生年月日],6,2),Right([生年月日],2)+1) （AccessのSQL文は：SELECT 給与台帳.生年月日, DateSerial(Year(Now()),Mid([生年月日],6,2),Right([生年月日],2)+1) AS 契約開始日 FROM 給与台帳;） これを SQL Server2005 に書き直したいのですが、その方法がわかりません。 どう書き直せばよろしいですか？ よろしくお願いします。
ビュー定義をプログラムで動的に扱う方法 SQLServer2008+VB6(ExcelVBA)構成のシステムで、日付フィールドを含むテーブルのビューを作成しておき、ＶＢプログラムからＳＱＬ文でビューを呼び出す時、日付範囲を指定して絞り込まれた結果をビューで返したいのですが、ストアドを使わずにビューだけで実現することはできないでしょうか？
”パラメータ値を TextBox から String に変換できませんでした” のエラーメッセージ2日間調べても分かりません。何卒ご教示ください。 １・状況：VB画面のTextBoxの値をSQLのString型フィールドにパラメータ変数をSETしUPDATE 　　するのですが、上記メッセージが出力されます。 ●SQL文 　　UPDATE A22_kensyu SET 　　　　　cyumon_kin = @cyumon_kin, 途中略 nyukin_yotei_ymd = @nyukin_yotei_ymd,　-----(1) nyukin_kanryo_ymd = @nyukin_kanryo_ymd,-----(2) torihiki_cd = @torihiki_cd, torikeshi_kbn = @torikeshi_kbn 　　WHERE mitumorino = @mitumorino AND mitumori_eda = @mitumori_eda AND bunkatuno = @bunkatuno 　●パラメータセット Dim paraNyukinYoteiYmd As IDbDataParameter = command.CreateParameter() paraNyukinYoteiYmd.ParameterName = "nyukin_yotei_ymd" paraNyukinYoteiYmd.DbType = DbType.String If TxtNyukinYoteiYmd.Text = "" Then paraNyukinYoteiYmd.Value = DBNull.Value Else paraNyukinYoteiYmd.Value = TxtNyukinYoteiYmd End If command.Parameters.Add(CType(paraNyukinYoteiYmd, TeLib.CmnDataParameter).GetParameter()) 　　●VB６からVB2008を始めたばかりでまた、SQLのパラメータ変数を使用するのも初めてです。 　　●もともと動いていたプログラムを改造が必要になり(1)、(2)を付加しました 2.環境 OS：WindowsXp 言語：VB2008 DB：SQLserver2000
SQLServer2000でデータ数が10万くらいあるテーブルから、 OrderByやTopなどのSQL文を使用すると、 SELECTに数秒かかってしまいます。 該当のカラムを主キーにはできないですが、 インデックス化？みたいなことをして、 SELECTを短時間化できないでしょうか？
データベースシステムについて (1)データベース管理システムの役割 a データベースのデータの定義や検索・更新を行う。 b データベースのデータを分析して、たとえば顧客のニーズなどを探る。 c データベースのデータを不正なアクセスから守る。 d データベースのデータの重複や誤りなどをチェックする。 答え C ? (2)データベースシステムを導入することによって期待できる効果 a データの様々な分析手法を中に組み込むことができる。 b データの精度が向上する。 c データ項目が変更されても、プログラムの修正が最小にできる。 d データの転送が高速化できる。 答え C ? なんか、どれも正解のように思えるんですが 答えってCであってますか？ どなたか、詳しく解説できる方がいらっしゃいましたら、よろしくお願いいたします！
SQLServer2000で.NETからクエリを実行していますが、 実行したクエリ文と実行時間のログを取得したいのですが、 どのように取得したらいいのでしょうか？ EnterpriseManagerなどで簡単に取得できたらいいのですが。
SQLServerにおける、排他制御に関して質問です。 環境： 　ＳＱＬサーバ 　・Windows 2003 Server SP2 　・SQL Server 2005 Standard Edition SP3 　ＳＱＬクライアント 　・WindowsXP SP3 　・.NET Framework 3.5 SP1 VB.NET アプリ 　DBアクセサ 　・ADO.NETを利用 ---------------------------------------------------------------------- １．DBとのコネクションを確立 　　　　　　　・ 　　　　　　　・ 　　　　　　　・ ２．データベーストランザクションを開始（レベルはSerializable） ３．テーブルＡに対してINSERTを実行 　　（テーブルＡの主キーはオートインクリメント設定されている。） ４．３の結果、追加された主キーを取得するため、MAX()関数にて主キーの最大値（つまり、３で追加した行のはず）を取得 ５．テーブルＡを外部参照しているテーブルに対して、４で取得したテーブルＡのキーを利用して、行を追加・更新などを行う。 ６．コミットを行う。 　　（コネクションは、アプリケーションが終了するまで保持する・・・） ---------------------------------------------------------------------- この処理フローで実行していたシステムですが、 二つのクライアント（Ｘ，Ｙ）から、同時に２からの処理が行われた際に排他されず、 Ｘが、Ｙが作成したレコードの主キー値を元に、５の更新を行ってしまいました。 ログを見ると、 ２→成功 ３→成功（別のレコードが作成された） ４→ＸがＭＡＸ関数にて、Ｙが作成したレコードの主キーを取得 　　※処理そのものは成功しているが、論理的におかしい となっています。 論理的には、トランザクションをかけているので、３からの処理が同時に行われるはずはなく、 ４で取得される番号も、それぞれが作成した行の主キー番号になるはずなのですが・・・。 論理的に見落としている点や、環境的な要因などで、考えられる原因はありますでしょうか・・・？
ストアドから特定のキーワードを含むストアドを探したい 沢山のストアドの中から「union」を使っているストアドをだけを 検索する方法はありますか? (名称ではなく、ストアドの中身(コード)を検索したい)
SQLの質問です。 SQL Server 2008 R2 を使っている初心者です。 下の２つのテーブルがあります。 １）売上情報　table_uriage ・uriage_id ・user_id ・uriage_date ・uriage_kingaku ２）入金情報　table_nyukin ・nyukin_id ・user_id ・nyukin_date ・nyukin_kingaku この2つのテーブルに対して、同じ期間を指定して、集計表（ユーザー毎の合計）を 作りたいと思っています。別々の表にするには何の問題もないのですが、 問題は２つのSQLの結果を１つの表にしたいのですが、SQLをどのように組んだらいいか わかりません。 具体的な表としては、 user_id uriage_total nyukin_total ======================================== 001 11111 22222 002 33333 44444 003 55555 66666 みたいな感じになればいいのです。 どなたか教えて下さい。 よろしくお願いいたします。
学校でSQLについて学んでいます。とあるデータベースに関する問題なのですが 2 データベース又はデーターウェアハウスに蓄えられているデータを 分析する手法としてどのようなものがありますか？ 知っているものを一つあげ、実例を挙げて説明してください 蓄えられているデータを分析する手法というのが、皆目検討がつきません・・・>_< 普通にコンピュータを使う、ということじゃないですよね？ 済みませんが、何方か宜しくお願い致します
SQL文に関するとある問題について (3) 次の出庫記録の表に対して、以下のSQL文を実行したときに得られる値が 最も大きな数が得られるものは何ですか？ 該当する記号を書いてください。 --------------------------------------------------------------- 商品番号 数量 日付 PRT145420090610 DP255220090610 DP266320090611 PRT255220090611 a SELECT MAX(数量) FROM 出庫記録 b SELECT AVG(数量) FROM 出庫記録 WHERE 日付='20090610' c SELECT COUNT(*) FROM 出庫記録 d SELECT SUM(数量) FROM 出庫記録 WHERE 日付='20090611' ------------------------------------------------------------ この場合、それぞれの選択肢が出す数字は a=1 b=3 c=4 d=5 なので、正解はdでいいんでしょうか？ aのMAXって、最大なのはPRT145の数量4ですが、a=に4をいれるべきか、それともMAXなのはPRT145一つだけなので1にすべきか、まずそこで躓きました。 bのAVGは4+2=6なので、それの半分の3かな？ cはそのまんま4にして dはSUMなんで、3+2=5．にしちゃいましたが、間違ってるでしょうか？ 　 宜しくお願い致します。
SQL文について <と>の意味 とある問題で。 問(1) 次のSQL文によって、以下の学生名簿の表から抽出されるものはなんですか。 該当する記号を書いてください。 -------------------------------------------------------------------- SELECT 氏名 FROM 学生名簿 WHERE 学科='産業経営' AND 年齢>20 氏名 学科 年齢 上田 泰 経済 22 太田 裕子 公共金融経済 18 鍵谷 俊文 産業経営 19 佐藤 由理子 産業経営 21 山本 貞真 経済 20 a 上田 泰 b 鍵谷 俊文,佐藤 由理子 c 佐藤 由理子 d 上田 泰 e 上田 泰,佐藤 由理子 ---------------------------------------------------------------------- (2)： (1)の問題の学生名簿の表から、 下のSQL文を実行したときに得られる表を書いて下さい。 SELECT 氏名,学科 FROM 学生名簿 WHERE 年齢<20 ---------------------------------------------------------------------- それぞれに 1)年齢>20 2)年齢<20 と書いてありますが 1)の場合は、20歳以上という意味なのか、それとも「20歳」は含まず「21歳から」。 2)の場合は、20歳以下という意味なのか、それとも「20歳」は含まず「19歳から」。なのかが分かりません。 この場合だと(1)の答えはc 佐藤 由理子で合っているのでしょうか？ それと(2)の答えは 太田 裕子 公共金融経済 18 鍵谷 俊文 産業経営 19 山本 貞真 経済 20 と書き表せばいいのでしょうか？ 宜しくお願い致します。
業務工程に入力業務があり、 入力ミスをなくすため入力後、内容を印刷し、 目視検査を実施しています。 が、入力ミス率が高いため、 ２次入力（２度打ち）工程を設けようと検討しております。 SQLで２度打ち機能を作成することはできるのでしょうか。 できるのであれば、具体的にどうすればよろしいでしょうか。 全くの初心者ですが宜しくお願いいたします。
SQLServerのselect文でデータ数１万くらいのDBから top n と order by つきで取得したときに、 １０秒以上かかってしまいます。 top n　だけや order byだけであれば、そんなにかかりませんが、 同時に扱う場合、なぜこんなに時間がかかってしまうのでしょうか？
SQLを学ぶのに最適な本を教えてください 初心者です。 大学で3年前に、簡単に習った事がありますが 記憶から抜け落ちています。 業務でSQLが使えると自分の課でできる範囲が 増えるのでしっかりと学びたいと考えています。 ・初心者の入門的な内容でおすすめの本 ・業務で辞書的な形で調べるのに重宝する本 ・玄人の方にもおすすめの本 この３つの切り口でお勧めの本がありましたら ぜひ教えてください。 宜しくお願いします。
お世話になります。 VB6.0、SQLServer2005WorkGroupEditionでアプリケーションを作成しております。 アプリケーションでログを出力しているのですが、ログ上で以下のエラーメッセージが出力されます。 ”DB OPENエラーこのログインで要求されたデータベース "****" を開けません。ログインに失敗しました。” この現象が起きる場合と、起きない場合が発生しており、原因が掴めずにいます。 SQLServerのログを調査しましたが、 06/11/2010 03:02:17,ログオン,不明,Login failed for user 'sa'. [クライアント: 192.168.2.10] 06/11/2010 03:02:17,ログオン,不明,エラー: 18456、重大度: 14、状態: 16。 のメッセージが出力されておりますが、原因がつかめない状態です。 何か調査の方法はございますでしょうか。 お手数ですが、ご教授いただきたく宜しくお願い申し上げます。
SQLで日付を条件に削除したい update の列にdatetime　型で更新日が入っています。 2010年の６月以降を削除したいのですが どうにもうまくいきません。（一応以下のようなことをやってみたりしました） どのように書いたらいいでしょうか？？ DELETE FROM SYS WHERE update >#2010/06#
SQLで特定の文字を含むものを削除 パソコン初心者です。 SQLでデータベースからたとえば（’）シングルコートを 含むもののみ削除することはできますか？
データベース内の値をweb内でテキスト表示させるには？？ データベース内の値をweb内でテキスト表示させるには？？ 現在、フォーム認証（ID入力後、表示ボタンをクリック）の後に入力したIDとデータベースを連携させデータベース内の該当する値をlabelに表示させようとしています。 開発環境は ・言語：C# ・VisualStudio2008Pro ・SQLSever2005EXPRESS ソースは以下のようになっています。 <%@ Page ContentType="text/html" Language="C#" %> <%@ Import Namespace="System.Data" %> <%@ Import Namespace="System.Data.SqlClient" %> <script runat="Server"> void objBtn_Click(Object sender, EventArgs e) { // 入力されたユーザーIDでtestテーブル内のレコードを検索 SqlConnection objDb=new SqlConnection("Data Source=(local);User ID=xxx;Password=xxx;Persist Security Info=True;Initial Catalog=master"); SqlCommand objCom = new SqlCommand("SELECT 所持数 FROM test WHERE 本人ID=@本人ID", objDb); objCom.Parameters.Add("@本人ID", txtUsr.Text); objDb.Open(); SqlDataReader objDr=objCom.ExecuteReader(); if(objDr.Read()){ // 検索の結果、該当するレコードが存在した場合、認証は成功 FormsAuthentication.RedirectFromLoginPage(txtUsr.Text,false); 　　　※このあとを色々と試したのですが駄目でしたorz objLbl.Text=objCom; }else{ objLbl.Text="正しいユーザーIDを入力してください"; } objDb.Close(); } </script> <html> <head> <title>所持数表示</title> </head> <body> <form id="Form1" runat="Server"> <center> <h1>所持数表示</h1> <hr /> <b>ユーザーID：</b> <asp:TextBox id="txtUsr" runat="Server" Columns="12" /><br /> <br /> <asp:Button id="objBtn" runat="Server" Text="表示" OnClick="objBtn_Click" /><br /> <asp:Label id="objLbl" runat="Server" ForeColor="Red" /> </center> </form> </body> </html> if文の後にテキスト表示の記述をしなければならないと思うのですが方法がわかりません。 フォーム認証後に該当の値を表示させる方法がわかれば一番いいのですが、単にデータベースの中の値をテキスト表示する方法だけでも大変助かります！！ 初心者で手詰まりの状態でものすごく困っていますorz わかる方がいらっしゃったら教えて下さい!よろしくお願いしますm(_ _)m
SQL Server を使っています。SQLの質問です。 得意先テーブルと商品テーブルと売上明細テーブルがあります。 一つの商品に関して得意先ごとに最新の売上明細データの一覧を作成したいと考えて います。 ■売上明細データ 明細ID　（meisai_id） 得意先ID　(tokuisaki_id） 商品ID　　(syohin_id） 売上金額（uriage_kingaku） 売上日　（uriage_date） ■売上明細データ(table_uri_maisai) meisai_id　tokuisaki_id　syohin_id　uriage_kingaku　uriage_date ================================================================= 　　1　　　　　aaa　　　　　001　　　　　100　　　　　2010/01/01 　　2　　　　　aaa　　　　　002　　　　　200　　　　　2010/01/01 　　3　　　　　bbb　　　　　001　　　　　105　　　　　2010/01/02 　　4　　　　　bbb　　　　　002　　　　　205　　　　　2010/01/02 　　5　　　　　ccc　　　　　001　　　　　110　　　　　2010/01/03 　　6　　　　　ccc　　　　　002　　　　　210　　　　　2010/01/03 　　7　　　　　aaa　　　　　001　　　　　100　　　　　2010/01/04 　　8　　　　　aaa　　　　　002　　　　　200　　　　　2010/01/04 　　9　　　　　bbb　　　　　001　　　　　105　　　　　2010/01/05 　　10　　　　　bbb　　　　　002　　　　　205　　　　　2010/01/05 　　11　　　　　ccc　　　　　001　　　　　110　　　　　2010/01/06 　　12　　　　　ccc　　　　　002　　　　　210　　　　　2010/01/06 上のような明細があり、「syohin_id」が「001」のデータに関して、 得意先ごとの最新のデータだけを抽出したいと考えています。 この場合ですと、以下の３件のデータが抽出できればよいわけです。 　　7　　　　　aaa　　　　　001　　　　　100　　　　　2010/01/04 　　9　　　　　bbb　　　　　001　　　　　105　　　　　2010/01/05 　　11　　　　　ccc　　　　　001　　　　　110　　　　　2010/01/06 tokuisaki_id と syohin_id の２つを特定して１件のデータを抽出するには 以下のSQLで実現できましたが、syohin_id だけを指定して複数のデータを 出すことがどうしてもできません。 SELECT * FROM table_uri_meisai WHERE uriage_date = (select max(uriage_date) FROM table_uri_meisai WHERE tokuisaki_id = 1 AND syohin_id = 1) AND tokuisaki_id = 1 AND syohin_id = 1 どなたかご指導ください。 よろしくお願いします。
カーソルを使って、最終行レコードの判断はどうすればよいのでしょうか。 処理はオーソドックスなスタイルでコーディングしているとします。 「ループ処理内で、FETCH NEXTした際に、最終行か判断したい」という質問です。 EOFで最終行だと判断するのは一般的ですが、ループ内で通常行と最終行の切り分けをしたいのです。特に何かの制約や事情があるわけではありませんので、実現できればそれでOKです。 要するに、最終行レコードが、通常行レコードの処理とかぶらなければ、用件は満たせるのですが、あまり懲りたくもないのもあって、ちょっと実装イメージが思い浮かばず、困ってます。 ご回答お願いします。
SQL Server2005のクエリで「今週のデータ」を抽出したいのですがうまく出来ません。 between datename (weekday, getdate()) on datename(weekday, getdate() +6 ) 「今週の」という条件は、本日の日付から週始めの月曜日を算出して、その値にプラス6をした日曜日までのデータを取得、という感じで行いたいのですが、 肝心の月曜日の求め方が分かりません。 参考書やネットを調べても分からなかったため、この場をお借りして質問させていただきました。 何卒ご教授お願いいたします。
Sqlserver2005でテーブルを作成してい分からなかったので質問します。 [テーブルＡ] 　{フィールド１}主キー 　　(データ1000) 　　(データ1001) 　　(データ1002) これを親とするテーブルＢを作成して [テーブルＢ] 　{フィールド1}主キー{フィールド2}主キー 　(データ1000）　　　(データ1001） 　(データ1001）　　　(データ1002） 　(データ1002）　　　(データ1003） [テーブルB]の｛フィールド１と２｝を[テーブルA]の {フィールド１}にリーレーションを張って [テーブルＡ]の{フィールド１}のデータが消した時に[テーブルＢ]の｛フィールド１，２｝ のデータ、どちらかに該当するデータがあった場合に行ごと削除したいので ｛フィールド１，２｝のリレーションシップの設定の「DeleteRule」を2つとも「重ねて表示」としたいのですが 「パスが循環するか、複数のパスに連鎖する可能性があります。ON DELETE NO ACTION、ON UPDATE NO ACTION、を指定するか、他の FOREIGN KEY 制約を変更してください。 制約を作成できませんでした。以前のエラーを調べてください。」 と表示されて出来ませんこの場合フィールド１，２どちらか1つのフィールドしか DeleteRule「重ねて表示」に設定できないのでしょうか？ こういう風に分岐する道筋を明記するテーブルを作りたいのですが １━┳２ 　　 ┗３　　 自分の作ったテーブルの構造が良くないかもしれないので上に書いてあるような テーブルでは駄目だという方もどういったテーブル構造が良いのか教えて欲しいです
ご教授お願い致します。 MicrosoftSQL2008で テーブルに在庫データと受払データの２種類があります。 在庫データは受払データを１行にまとめた情報で 年月で管理しています。 また、受払データはその詳細で年月日で管理しています。 質問は、この二つのテーブルをビューで１つに結合したいのですが 結合に在庫データの年月と受払データの年月日だと特定の日付のみしか 結合されません。 よって、方法を教えて頂ければ幸いです。 尚、例を下に記述します。 ■在庫データ 年月　　　　品番　入庫数　出庫数 2010/06/01　A 　　3 　　　1 2010/07/01 A 0 1 ■受払データ 伝票No.　日付　 品番　入出庫区分　数量 1 2010/06/02 A 入庫　　　　1 2 2010/06/03 A 入庫　　　　2 3 2010/06/04 A 出庫　　　　1 4 2010/07/02 A 出庫　　　　1　　 　結合は在庫データの2010/06/01だと受払データの 　伝票No.が１から3まで 　2010/07/01だと伝票No.4です。
こんにちは。 最近、社内システムの運用を担当することとなりました。 サーバに保存しているでデータのバックアップについて1点お聞きしたいことがあります。 社内で勘定奉行IVを利用しています。 サーバ内に保存されているデータのバックアップをしたいのですが 「ほかの人またはプログラムによって使用されています」と表示されてしまい、コピーすることが出来ません。 サービスを停止すればコピーできるかと思ったのですが肝心のサービス名が不明でした。。。 下記に構成を記載しておきますのでご存知の方がいらっしゃいましたらご教授ください。 【構成】 WindowsServer2003 MicrosoftSQL　2003 勘定奉行LANPAKC（勘定奉行IV） 保存したいフォルダ：D:\OBCWIN\OBCZLMS5\DATA ファイルの拡張子：*.ldf、*.mdf バックアップを取る目的 batファイルを作成してタスクスケジューラでサーバ内のデータを自動保存したいです。 バックアップ奉行は購入していません。 ※低予算で実施したいので。。。 【補足】 個人的にはファイルを使用しているSQLサービスを停止後、コピーすればバックアップ可能だと 思ったのですがどのサービスを停止すればよいのか不明でした。。。 尚、SQLのサービスは下記のものがあります。 ※念のため、停止してコピーしましたが変化なしでした SQL Server(OBCINSTANCE2) SQL Server Browser SQL Server FullText Search(OBCINSTANCE2) SQL Server Integration Services 以上、よろしくお願いいたします。
環境：SQL-Server2005 アプリケーション：Access2003 接続：DAO3.6 AccessよりSQL-Serverのテーブル、ローカルテーブルへ接続した場合、ODBC接続が 接続不可となる場合があります。 エラーとなりますが、エラー状態のまま処理を再開出来たりする場合がありあます。 常時発生する事象ではありませんが、発生率は低いですが、何か考えられる原因がございますでしょうか。
SQL SERVER 2005 にて全テーブルの文字列を置換する方法を探しています。 ものすごく基礎的なことでしたら申し訳ございません。 SQL SERVER 2005で作成したDBがあるのですが、この中の全てのテーブル内を検索し、 「ＡＡＡ」という文字列を「ＢＢＢ」に置換したいと考えています。 上記は例えですが、とにかく全てのテーブル内の全ての文字列を検索し、置換できる方法は無いでしょうか。 どうかご教示のほど、よろしくお願いいたします。
.sdfファイル自体の作成方法 SQLSERVER2008 にて、Compact Edition用の.sdfファイル自体の作成をしたいのですが、.sdfファイルへのデータの書き込みはどのようにしたらいいのでしょうか？10台分(10種類）のSDFファイルを夜間にサーバで作って、日中それを配布するみたいなことをしたいと思ってます。
SQL Server 2000 を使用しています。 土日を除いた日数を取得したいと思っていますがわからなくて困っています。 ご助言ください。 あるテーブル（T_Test）に日付列が2つあります。 code｜dateA　　 ｜dateB ──┼─────┼────── 1　 ｜2010-05-10｜2010-05-14 2　 ｜2010-05-14｜2010-05-17 3　 ｜2010-05-10｜2010-05-28 ここから code｜dateA　　 ｜dateB　　 ｜日数 ──┼─────┼─────┼── 1　 ｜2010-05-10｜2010-05-14｜4 2　 ｜2010-05-14｜2010-05-17｜1 3　 ｜2010-05-10｜2010-05-28｜10 というように土日を除いた datediff のような値を取得したいのです。 datediff で日数を取得でき、datepart で曜日を取得することができるようには なったのですが、土日を除いた日数を取得（もしくは期間内の土日の日数でも可）を 取得する方法がわかりません。 どうぞ宜しくお願いいたします。
SQL Server2008 テーブルの権限について質問です。 現在SQL Server 2000 から2008へ移行を検討しています。事前にExpressEdithionをインストールしていろいろ確認していますが、判らない点がありますのでお教え下さい。 問題はユーザー別にテーブルの権限を変えたいのですが、2008のManagementStdioを見てもそのように設定する手段が見つかりません。 user1は、全てのテーブルのread/writeが可能。 user2は、1部のテーブルはread/writeのみ可能、1部はreadのみ、他のテーブルはread/writeとも不可。 user3は、1部のテーブルのreadのみ可能、他のテーブルはread/writeとも不可。 このように設定をManagementStdioで行う方法はないのでしょうか？ 以上、よろしくお願いします。
SQL server 2008 management studio でテーブル内を1000件以上表示させ、編集したい。 いつもお世話になっております。 今回、DBにSQL server 2008を使用しており、 DBの中身を、management studioで確認しておりました。 テーブル内のデータが1000件以上になり、 1000件以上のデータを表示したくても、 できません・・・。 management studioでは1000件以上のデータ表示はできないのでしょうか？ management studioでの1000件以上の表示方法、 もしくは、それ以外の初心者でも使えるツールで、 1000件以上のデータの表示と編集・削除ができる方法を、 教えていただけましたら幸いです。 すみませんが、よろしくお願いいたします。
VBとsql serverを使ってデータベースを操作したいと思って、 sql server management studioをインストールしたんですが、 Accessと違って何が何やら分からず、テーブルの作成すらできません。 最初に登録済みサーバを見ると、 自分のコンピュータ名\sqlexpless という名前のサーバらしきものがあり、 こんなサーバ作った覚えないぞ、デフォルトで作られるのかな？ と思って右クリックから削除したんですが、 そのあと「オブジェクトエクスプローラを接続」を選択すると、さっきの名前のサーバが入力されてて、 接続を押したらなぜか復活していました。 意味が分からなかったので削除は諦め、新しくサーバを作ろうと「新規サーバの登録」から、適当に名前をつけてテストボタンを押したんですが、画像のようなエラーが出てきました。 見ても解決できなかったので諦めて、最初もともとあったサーバを使って新しくデータベースを作成しようとすると今度は、 CREATE DATABASE 権限が拒否された とのエラーが発生します。もう何もできなくなってしまいました。 お時間がよろしければ、インストールした直後からオリジナルのサーバとデータベースを作成して、テーブルの作成あたりまでを解説していただけないでしょうか。
SQL Server Management studioで 新しくデータベース(MyDatabase)、テーブル(NameTable)を作成してみたんですが、 Visual Web developer 2010 Express のデータベースエクスプローラから MyDatabase.mdfを開こうとしても「このファイルは使用されています。…」 というような文言が出てきて、呼び出せません。 Vista,SQL Server 2008,Visual Web developer 2010 Expressの環境です。 どなたか教えて下さい。
バッチでのSQL実行結果の分岐処理について。 お世話になっております。 バッチからsqlを実行してその結果によってそれ以降のバッチ全体の処理を停止させる方法を考えています。 手がかりがつかめずまったく先に進めないためアドバイスをいただけますでしょうか。 バッチの内容(start_del.bat) -------------------------------------------------------- osql -i.\del.sql -o c:\wk\log.txt -S gold -E osql -i.\create.sql -o c:\wk\log.txt -S gold -E ------------------------------------------------------------ SQLの内容(del.sql) ------------------------------------------------------------ BEGIN TRANSACTION; DELETE FROM LDDB.dbo.test WHERE b='0'; IF @@ERROR = 0 <--エラー判定にこのコマンドを使おうと考えました BEGIN *********************** END ELSE BEGIN ********************** END COMMIT TRANSACTION; ------------------------------------------------------------ 処理の概要： 1.バッチで最初にdel.sqlを実行します。 2.del.sqlの実行が失敗すれば、2つ目のバッチであるcreate.sqlは実行ささずに、バッチを終了させます。 *ポイントはdel.sqlの結果というのは、バッチからdel.sqlを実行できたかではなく、del.sqlの実行結果を判断するという点です。 教えていただきたいこと ・del.sqlの実行後、制御がバッチに戻ったときに、結果を確認してバッチを継続させるか終了させるかを判断させる方法はどのような仕組みを作ればいいのでしょうか。 Windows2003サーバーで、SQLServerは2005です。 初心者のためよく分かっていないことが多すぎで申し訳ありませんが、アドバイスをいただけますでしょうか。 よろしくお願いいたします。
SQLserver2005より、SQLにて各データベースのプロパティにあるサイズと使用可能領域の値を取得したいのですが、そのようなSQLはありますでしょうか。
ログファイルの圧縮がされずに容量が日々増加してしまっています。 SQLServer2008のジョブで定期的に以下の３ステップを行っています。 SHRINKFILEで毎回、圧縮できないでいます。 何が原因でしょうか。どのように解決したら良いかわからず投稿させていただきました。 【ステップ１ コマンド】 BACKUP DATABASE [TEST_DB] TO DISK = N'F:\TEST_DBバックアップ\TEST_DBバックアップ.bak' WITH FORMAT, NAME = N'TEST_DB-完全 データベース バックアップ', SKIP, NOREWIND, NOUNLOAD, STATS = 10 【ステップ１ ログ】 BACKUP DATABASE により 22350897 ページが 1706.690 秒間で正常に処理されました 【ステップ２　コマンド】 BACKUP LOG TEST_DB TO DISK = N'F:\TEST_DBバックアップ\TEST_DB_LOGバックアップ.bak' 【ステップ２　ログ】 　BACKUP LOG により 473562 ページが 55.721 秒間で正常に処理されました 【ステップ３　コマンド】 　DBCC SHRINKFILE(TEST_DB_Log,1024) 【ステップ３　ログ】 圧縮できません。ファイルの末尾にある論理ログ ファイルが使用中です。 稿させていただきました。
SQL serverの１つのデータベース内にある全てのテーブルを一気にcsv化したいと思っています。 が、テーブルを1個ずつcsv化する方法しか見つからず、困っています。 テーブルの数が100ほどあるので、できれば一気に行いたいのです。 ※見つけた方法 （１）SQL Server Enterprise Maganerで、データベースを右クリック→「すべてのタスク」の「エクスポート」→変換対象にFlat Fileを選ぶ これだとテーブル1個ずつしか変換できません。 （２）bcpコマンドを使う こちらもテーブル名を指定していますので、やはりテーブル1個ずつしか変換できません。 何かいい方法はないでしょうか。 あるいは、上記の方法を少し変えることで一気に変換できるのでしょうか。
SQLServer 2008のインスタンス間DBコピーの方法を探しています。 インスタンス１とインスタンス２に同じテーブル構造（名称も同じ）のDBを用意しています。 インスタンス１のDB（以下、DB1）をインスタンス２のDB（以下、DB2）に コピーする方法を模索しています。 SQLServerのバージョンは2008で、Standardです。 できればDB1を止めることなく、DB2にコピーできるよう考えています。 ご存じの情報がありましたら、教えていただければと思います。 よろしくお願いします。
ＳＱＬで以下のような構文でコンパイルエラーがでます。 QSQL = QSQL & ",TMTNM,TO_CHAR(TMSPC,'000') AS TMSPC,HMHNM" ＴＭＳＰＣというフィールドを数値から文字へ変えたいのですが、 ＴＯ＿ＣＨＡＲの引数が正しくないとでます。 どこが間違っているか教えていただけますでしょうか？ ＴＯ＿ＣＨＡＲ（ＴＭＳＰＣ、’０００’）にしても、 ＡＳ　ＴＭＳＰＣをつけなくてもダメでした。
MSDE2000のパフォーマンス低下 MSDE2000を使ったシステムがあるのですが、２，３ヶ月すると、目に見えてパフォーマンスが低下してしまいます。サービスを再起動すると、元のパーフォーマンスに戻るのですが、何か対処はあるのでしょうか？それとも、MSDE2000が開発用という事で、再起動するしかないのでしょうか？ 環境 ・２４時間連続稼動 ・４クライアントから読み書きしています。 ・OSは、MSDE2000がインストールされているPCも含め、５台ともWindows2000Server ・ソフトウェアの開発言語は、Visual C++6.0 こうしたら、という対処がありましたら、助言をお願いします。 以上、よろしくお願いします。
多くの選択項目を処理(SELECT)するストアド とあるデータ検索において、選択項目が10項目以上あり各項目の値をパラメータとして受取り、 該当データを返すストアドを検討しています。 項目が省略された場合は　Null値がパラメータとして入ってきて、その項目は条件から除外します。 （全ての項目が省略されたら、全てのレコードが返される）下記の様な方法を考えています・・・ ----------------------------------------------------------------- if @para1 is null 　if @para2 is null 　　if @para3 is null 　　　select * from TBL 　　else 　　　select * from TBL where koumoku3 = @para3 　else 　　if @para3 is null 　　　select * from TBL where koumoku2 = @para2 　　else 　　　select * from TBL where koumoku2 = @para2 and koumoku3 = @para3 else 　if @para2 is null 　　if @para3 is null 　　　select * from TBL where koumoku1 = @para1 　　else 　　　select * from TBL where koumoku1 = @para1 and koumoku3 = @para3 　else 　　if @para3 is null 　　　select * from TBL where koumoku1 = @para1 and koumoku2 = @para2 　　else 　　　select * from TBL where koumoku1 = @para1 and koumoku2 = @para2 and koumoku3 = @para3 ------------------------------------------------------ 三つでも面倒なのに10項目以上では考えられません。 こんな時どのように作り込めばいいのでしょうか 動的ストアドにして where文自体を編集した物を渡す事も考えましたが、 エクセル出力時のパラメーター長の制限(?)で断念しました。 省略されなかった項目だけでデータを選択したいような事は多々あると思うのですが、 そんな時のオーソドックスは方法はどんな方法なんでしょうか? よろしくお願いします。
システムデータベースについての質問です。 msdbデータベースの「ms」というのは何の略でしょうか？ 他のシステムデータベースについては、何となくわかるのですが。 わかる方、よろしくお願いします。
SQLで二つのデータベースをUNIONでつないだあとに異なる入力形式のフィールドでソートをかけたいのですが。 AのデータベースではNOが文字列で"001","002","003"...で、 Bの方ではNOが文字列で" 01"," 02"," 03"...と左１ケタ目がブランクとなっています。 これを"001"," 01","002"," 02"...というふうに下2けたのみでソートをかけたいのですが、 普通にORDER BYするとBを読んだあとにAがきてしまいます。 SUBSTRINGはUNIONでは使えなかったのですが、何かよい方法教えていただけませんでしょうか？
階層データのあるテーブルで親から最下層の子までのパスを列挙するクエリ すでに存在するシステムより親子関係のデータが自動的に作成されるのですが、 それをSQLクエリで並び替えることに苦労しています。 やりたいこと： 最上位の親から最下層の子までのパスを列挙するクエリを作成したい。 テーブル構造： 直属の親と子を１レコードで保存しています。 (ID=０は最上位の為、１が最上位の親) TableName：Department ID　ParentID　ChildID　Order　ChildName --　--------　-------　-----　--------- 0　　　　0　　　　1　　　1　　　xx 1　　　　0　　　　2　　　1　　　aa 2　　　　1　　　　3　　　1　　　bb 3　　　　1　　　　4　　　2　　　cc 4　　　　2　　　　5　　　1　　　dd 5　　　　2　　　　6　　　2　　　ee 6　　　　3　　　　7　　　1　　　ff 7　　　　3　　　　8　　　2　　　gg 8　　　　6　　　　9　　　1　　　hh 9　　　　6　　　　10　　　2　　　ii 10　　　　8　　　　11　　　1　　　jj クエリで以下のように表示したい。 Level1　Level2　Level3　Level4　Level5　NodeName ------　------　------　------　------　-------- 　　1　　　　　　　　　　　　　　　　　　　xx 　　1　　　　3　　　　　　　　　　　　　　bb 　　1　　　　4　　　　　　　　　　　　　　cc 　　1　　　　3　　　　7　　　　　　　　　　ff 　　1　　　　3　　　　8　　　　　　　　　　gg 　　1　　　　3　　　　11　　　　　　　　　jj 　　2　　　　　　　　　　　　　　　　　　aa 　　2　　　　5　　　　　　　　　　　　　　dd 　　2　　　　6　　　　　　　　　　　　　　ee 　　2　　　　6　　　　9　　　　　　　　　　hh 　　2　　　　6　　　　10　　　　　　　　　ii 私が試したSQLクエリは以下となります。 select lev3.Level1,lev3.Level2,Level3,Level4,Node5.ChildID as Level5,ChildName from Department as Node5 Right Join(select lev2.Level1,lev2.Level2,lev2.Level3,Node4.ChildID as Level4,ChildName from Department as Node4 Right Join(select level.Level1, level.Level2,Node3.ChildID as Level3,ChildName from Department as Node3 Right Join(select Node1.ChildID as Level1,Node2.ChildID as Level2,ChildName from Department as Node2 Right Join(select ChildID,NodeName.ChildName from Department as Node0 inner Join tbDepartment as NodeName on Node0.ChildID=NodeName.ID Right Join(select ChildID as N0 from Department where ParentID=0) as Node00 on Node00.N0=Node0.ParentID) as Node1 on Node1.ChildID=Node2.ParentID) as level on level.N2=Node3.ParentID) as lev2 on lev2.N3=Node4.ParentID) as lev3 on lev3.N4=Node5.ParentID これだと、パスの列挙はできるのですが、名前が最上位の親だけしかわからず、 あたまが混乱しています。 有効な列挙方法を教えてください。 よろしくお願いします。
SQLServer2000からSQLServer2005へのデータ移行方法 Microsoft SQL Server ManagementStadio Expressで SQLServer2000のバックアップファイルから、 ローカルの開発環境(SQL Server2005 Express)でデータベースを復元しようと試みましたところ、 復元が正常に出来ませんでした。 復元はエラーが発生せず完了しデータベースは作成されているのですが、 データベースを右クリックで削除やプロパティを見ることもできず、 どのようなテーブルが存在するのか中身の参照も追加も何もできない状態です。 http://qanda.rakuten.ne.jp/qa4183273.html 上記URLなどでSQL Server2000のバックアップから2005で復元しているような発言がされているので 可能だと思うのですが、何か特別な処理が必要なのでしょうか？ ご存じのかた、教えていただけますようお願いいたします。
1テーブル＆複数レコードの更新に対して1度のupdate文での処理方法 Delphi2010+SQL SERVER 2005で開発しています。 update文で、 現在下のようにwhileで複数レコードに対して、 1回、1回、sqlを発行して、更新しています。 これを、一度のSQLの発行で処理できないものでしょうか？ 更新テーブルは1つで、更新する項目も同じです。 更新するデータと、where句の条件が異なります。 もし可能なようでしたら、どうかご教授お願いします。 update table set A=1,B=2 where id=1 update table set A=2,B=3 where id=5 update table set A=9,B=99 where id=7 update table set A=5,B=10 where id=15 update table set A=1,B=10 where id=75
弥生09でSQL Server2005 を使用しています 最近SQLを今まで使っていたPC(Windows Vista)から別のPC(Windows XP)に移動させたのですが、毎朝弥生を起動させようとするとSQLが停止状態になっています これまでのPCではこのようなことがなかったのですが、何か考えられる原因はありますか？ 移動させたPCが今までのPCと違う点といえば、常時(基本的に24h)電源をつけっぱなしにしている点です。 耐久性の面からいってもそれでいいのか不安なのですが、PCの持ち主の 意向と、私がそこまでPCに詳しくないので、説得できる材料がありません 検証に必要な材料が足りなければ御提示お願いします
初めまして。 Windows環境にて、IIS、ASP、MSSQLにてシステム構築をしていますが、たまにIISエラーにて [Microsoft][ODBC SQL Server Driver][TCP/IP Sockets]一般的なネットワーク エラーです。 と出てきます。 毎回決まった処理でエラーとなる訳ではなく、不定期に発生している状態です。 もし問題解決の糸口を頂けたら幸いです。
あるテーブルに対して、任意の日付を指定して、その日付より以前の 最新日付のデータのみを取得したいと考えているのですが、 可能でしょうか？ どなたかご存知の方、ご教授願います。 （例）テーブル 登録日付　　　Data1　　Data2 2008/12/01 ねこ　　哺乳類　　 2008/12/03　　たぬき　哺乳類 2008/12/05　　きつね　哺乳類 2008/12/05　　くじら　哺乳類 2008/12/09　　たこ　　軟体動物 2008/12/10　　いか　　軟体動物 2008/12/10　　まぐろ　魚類 2008/12/12　　いぬ　　哺乳類 というテーブルにおいて日付を2008/12/08と指定した場合 それ以前の最新日付のデータとして 2008/12/05　きつね　哺乳類 2008/12/05　くじら　哺乳類 が取得できるようにしたいと思っています。 どなたか、ご教示お願いいたします。
Windows7でSQLServer2005 Windows7でSQLServer2005 Standerdはインストール及び正常動作しますか？ また、その記事が載っているサイトはありますか？ よろしくお願い致します。
windows7 にSQL SerVer 2008 Express インストールしようとしています。 ３種類のダウンロードボタンがあるのですが、どれを選択してよいがわかりません。 違いを教えていただけないでしょうか？ (1)　SQLEXPR_x64_JPN.exe (2)　SQLEXPR_x86_JPN.exe (3)　SQLEXPR32_x86_JPN.exe
SELCTを使って違うテーブルのデータを２度使って表示させたいのですが どのようにしたらいいのか教えてください。 ---------------------- ■テーブルの構成 ・FoodList NO(主キー) Food ・MyList NO(主キー) fist second ---------------------- ■テーブルの内容 ・FoodList NOFood 1りんご 2みかん 3ぶどう ・MyList NOfistsecond 123 212 321 ---------------------- これで 1みかんぶどう 2りんごみかん 3みかんりんご というように表示させたいのですが どのようにしたらいいのでしょうか？ --------------------------------------------------------- SELECTMyLike.NO AS Expr1,FoodList.food,MyLike.Second FROMFoodList INNER JOIN MyLike ON FoodList.NO = MyLike.first --------------------------------------------------------- とすると 1みかん3 2りんご2 3みかん1 となってしまいますし --------------------------------------------------------- SELECTMyLike.NO AS Expr1,FoodList.food,MyLike.Second FROMFoodList INNER JOIN MyLike ON FoodList.NO = MyLike.first AND FoodList.NO=MyLike.Second --------------------------------------------------------- とすると表示されないですし どのようにしたら実現できるでしょうか？ 教えてください。よろしくお願いします。
visual web developer で貸し出し表を作成しています。 sqlサーバーの予定テーブルに下記のようなデータが入っています。 ID　　貸し出し日　　返却予定日　　貸し出した物 1　　　2010/03/31　　2010/04/03　　本 2　　　2010/04/02　　2010/04/02　　DVD 3　　　2010/04/02　　2010/04/03　　CD 上記のデータで4月に貸し出しを行っている毎日の状況を抽出するにはどのようなsql文を書けばよろしいでしょうか。 下記のような結果を期待しています。 日付　　　　　　ID　　　　貸出日　　　返却予定日　　　貸し出した物 2010/04/01　　1　　　　2010/03/31　2010/04/03　　　本 2010/04/02　　1　　　　2010/03/31　2010/04/03　　　本 2010/04/02　　2　　　　2010/04/02　2010/04/02　　　DVD 2010/04/03　　1　　　　2010/03/31　2010/04/03　　　本 2010/04/03　　3　　　　2010/04/02　2010/04/03　　　CD 2010/04/04 2010/04/05 2010/04/06 2010/04/07 ..... 2010/04/30 予定テーブルに対して「貸出日が2010/04/30以下」 or 「返却予定日が2010/04/01以上」のwhere条件で 4月の予定を抽出する事は出来ますが、複数貸し出しがある日を複数行で返し、無い日についてもNULLを返すやり方が思いつきません。 どのようなsql文を書けばよろしいでしょうか。 宜しくお願いいたします。
Microsoft SQL Server Express Edition をインストールしようと思うのですが 「Microsoft SQL Server Express」で ググルと2005が最初に出てきて詳しいホームページが1番目に出てきて 2008が次に表示され見てみるといきなりダウンロードページで 2005のようなその製品に対する詳しい情報が見当たりません。 これは今のところマイクロソフトが2005を推奨していて 2008はまだまだといったところなのでしょうか？ 無難に2005をインストールしたほうがいいですか？ それとも2008でも別に問題ないでしょうか？
テーブル内のカラム情報を取得するにはどのようなSQLを作ればよいのでしょうか？ 欲しい情報は「カラム名・主キーかどうか・データ型・桁数・NULLを許容かどうか」の５つとなります。 SQL Server は2005と2008を使用していて、どちらでも扱えるSQLがあると助かります。 どうぞ宜しくお願いいたします。
DBへのOPENについて 無限ループの処理の中でDBへ取得、更新をします。 無限ループの中で毎回Openするのはいけてないと思うので、例外などに入ったときのみCloseしてあとはOpenのままでいたいと思っています。 つまりCloseされていたらOpenするという処理をしたいのですがどうやったらいいのでしょうか。 ↓無限ループしている箇所からの呼び出し Public Sub AA () Dim cn As System.Data.SqlClient.SqlConnection Dim ServerName As String = "AA" Dim DBName As String = "BB" try cn = New System.Data.SqlClient.SqlConnection If cn.State = Data.ConnectionState.Closed Then cn.ConnectionString = "Data Source = " & ServerName & _ ";Initial Catalog = " & DBName & _ ";Integrated Security = SSPI" cn.Open() End if Catch ex As Exception cn.close() End try End Sub こんな感じかなと思いましたが、これだと毎回Newしているのでなにかおかしい気がしてしまいます。 環境 SQL Server2008 ADO.net VB.net
現在あるDBの全テーブルのCreate文を取得したいのですが・・ 以前は、SQLSERVER2000のEnterPrizeManagerでコンソールルートから すべてのタスク、SQLスクリプト作成で選択したテーブルすべての スクリプト文をいっぺんに作成出来ていたのですが、 SQLSERVER2008に環境が変わったので、同じことを使用としても Management Studioでテーブルを選び、テーブルをスクリプト化 でやっても一つのテーブルしかスクリプト文が出来ません。 SQLSERVER2008では、同じように全テーブルのスクリプト文を一度に 作成する方法はないのでしょうか？ 教えてください。
SQLの更新方法について 環境 OS:windows XP home sql server express2008 Microsoft SQL Server Management Studio10.0.1600.22 現象 MS ACCESSからODBCを通してsql server express2008の中に作ったテーブル”TB01”にアクセスしていました。 あるときSQL Server Management StudioでTB01を削除しました。 ところがACCESSからODBCを通して接続すると削除したはずのテーブル”TB01”が見えていて リンクを張るとデータも出てきます、 ためしに新しくデータベースを作ってテーブルを作成してもODBCからは昔のままのテーブルしかありません。 SQL SERVERを再起動しても変わりません、どのようにすればＳＱＬの内容を更新できるのでしょうか？ どなたかお知恵を拝借願います。
FileStreamデータ型はEXE形式のファイルを格納することも可能でしょうか？ また、ファイルをテーブルに格納したあとに、実ファイルをHDDから削除しても問題ないですか？ よろしくお願いいたします。
SQLサーバで社内のWEBシステムの構築を考えています。 現在考えている構成は A拠点　WEB＋SQL B拠点　なし C拠点　なし です。 もしもの為を考えて、DBをクラスタリングして、WEBをもう１台 B拠点に設置しようと考えているのです、 ＝＝＝＝ A拠点　WEB＋SQL（B拠点とクラスタリング） B拠点　WEB+SQL（A拠点とクラスタリング） C拠点　なし ＝＝＝＝ こんな方法って実現可能なんでしょうか。 そもそもクラスタリングの使い方としてこれは正しいのでしょうか。 SQLで実現可能なのであれば、どこかで実績がかいてあるWEBサイトが あればおしえてもらえませんか。
お世話になります。 現在MSDEをデータベースとして使用していますが、サーバー機のリプレースにより、SQL SERVER 2008 EXPRESSを使用しないといけなくなりました。データの移行はできますでしょうか？また方法はどのような方法になるのでしょうか？ご教授よろしくお願いいたします。
C# VisualStaudio2008とSQLServer2005です。 質問なのですが、SQLServer2005に定義したストアドプロシージャーtestStoredに引数0001を渡すにはどうすればいいのでしょうか？ DBOpenはすでにできるようになっています。 VisualStaudio2008からSQLServer2005のtestStoredの呼び出し方法が全くわかりません。 お手数ではございますが、詳しい方アドバイスをお願いできないでしょうか？ できればサンプルソースを知りたいです。
二つのテーブルをjoinして比較したいときに 比較対象の項目がA,Bとあったとします。AはキーですがBはキーではありません。 このとき、ON句でTABLE1.A=TABLE2.A and TABLE1.B=TABLE2.B とかくのと ON句でTABLE1.A=TABLE2.A WHERE TABLE1.B=TABLE2.B と書くのとで結果に違いはあるのでしょうか？ 違いが見つけられずに困っています。 違っていない場合、どちらが一般的でしょうか？ どうぞよろしくお願い致します。
SQLServer2008Exを使用してます。 MSSMSでクエリ（SELECT文）を実行するとタイムアウトになってしまします。 データの量はそれなりにあるのですが、実行タイムアウトは０（ゼロ）無限の待ち時間に設定してあるのに何故なんでしょうか？
DTSにて、テーブルDROP後、CREATEし、同レアイウトのテーブルからデータコピー(BULK INSERT）をしています。 テーブルCREATEしたのでsysdependsの従属関係はリセットされてしまいますが、復帰させる手段はありますか。
SQLServer2008Exを使用してます。 テーブルを作成した後キーを設定しようとしたら 「変更の保存が許可されてません」とメッセージが出ました。 どうすれば変更の保存ができるのでしょうか？
インデックスが無効になっている 皆さん、こんにちわ 今回質問する内容なのですが、SQLServer2005での出来事です。 ある企業のバックアップ処理を毎日行う際、インデックスの再構築を行っているのですが、 ３３個あるインデックスの内、１つが無効になっていました。 それまで毎日１分かかる処理が、いきなり１０分かかるようになってしまいました。 とりあえずインデックスの再編成→再構築を行って事なきを得ましたが・・・ 何が原因なのでしょうか？ データ件数は800万件あります。
ソートについて、どの様なSQLを発行すれば良いのでしょうか。 初めての質問になります。 下記ソートしたいのですが、どの様なSQLを発行すれば良いのでしょうか。 またそのそもこの様な事は可能でしょうか。 ・SQLserver2005 商品DB -------------------------------- 単価｜在庫｜フラグ -------------------------------- 100｜1｜0 300｜3｜1 500｜5｜0 -------------------------------- フラグが立つレコードのみ2倍の在庫として扱い、 ソートしたいと思っています。 -------------------------------- 100｜1｜0 500｜5｜0 300｜3｜1 # フラグにより在庫を6換算してソート スミマセン。 どなたかご教授ください。
処理が終わったり終わらなかったり。 SQLServerの統計情報や実行計画に関してその挙動の 理解に苦しんでいます。 もし解決のヒントがいただけたらと思い、質問しました。 よろしくお願いします。 使用しているOSはWindows2008Server x64です。 DBはSQLServer2008 EEを用いています。 サーバー機はXeon 2.93MHz QuadCore×2です。 メモリは32GBで、うち20GBをSQLServerに使用させています。 javaのアプリケーション内でJDBCでDBアクセスしています。 処理は (1)3000万件程度のデータをメモリ上へ (2)計算処理してファイルへ (3)ファイルをDBへBulkInsert というもので、Javaのほうで8並列処理を行わせています。 この処理がどういうわけか(1)のところで動いたりとまったりします。 （止まっているというよりは、極端に遅くなっているというのが 正確かもしれません。） 経験則としては ・大量データを流す前に少量データで疎通を取った場合にとまる。 ・大量データ→大量データではとまらない。 ・止まったあと、一度スレッドをとめて統計情報を更新後、再度処理を流すと止まらない というようなものがあります。 利用状況モニタを見ると、 I/O Completion　というものが非常に長い時間処理しており、 なぜ状況によってこの処理時間が延びるのかがわかりません。 また、統計情報を更新したといっても、実行計画が殆ど変わらない場合もあります。 ただ、実行計画が殆ど変わらない（xmlにしてDIFFを取ると1行しか変わらない。）場合も、 再実行すると正常時間で処理が終了します。 何かお気づきの点がありましたら、是非ご教授ください。
状態によって、取得したいデータをかえたい場合のSQLについて 初心者で困っています。 以下は、状態が１，２，３の場合はデータを取得し、４の場合はデータを取得しないSQLです。 SELECT 　みかん．連番 　みかん．入荷日 FROM 　みかん 　INNER JOIN 状態 　　ON みかん．状態 = 状態．連番 WHERE 　みかん．状態 IN (1,2,3) みかんT 連番　　　入荷日　　　　状態 １　　　2010/02/01　　１ ２　　　2010/02/03　　３ ３　　　2010/02/08　　４ ４　　　2010/02/09　　１ ５　　　2010/02/13　　２ ６　　　2010/02/18　　３ 状態T 状態連番　　項目 　１　　　　良好 　２　　　　まぁまぁ 　３　　　　不良 　４　　　　破棄 これからが質問なのですが、 みかんTの連番３の状態が4の場合、状態3のデータ（みかんTでいう連番２，６）は取得したくありません。 そうするには、どう書き換えたらうまく動作するでしょうか・・・ 宜しくお願いいたします。。
SQL Server2000を使用し、 あるトランザクションで排他ロック(XLOCK)をかけたレコードが 他のトランザクションから共有ロックを使用し参照できてしまう状態は存在するのでしょうか？ 排他ロックをかけたレコードが 他のトランザクションから参照できてしまい困っています。 現在、下記の環境で開発を行っております。 ・サーバ側 Windows Server2003 SQL Server2000(sp4) ・クライアント側 Windows Xp(sp3) jdk6.0 jdbc 3.0 Type4 以下が具体的な状況となります。 前提として、 ・二つのトランザクション(以下Ａ、Ｂと表記します)が存在する。 ・ＡとＢは別のユーザでコネクションを張っている。 ・autoCommitはfalseに設定している。 ・テーブルにプライマリキーやインデックスは張っていない。 ・レコードは10件。 ・分離レベルはREAD COMMITED (1)Ａから、「SELECT * FROM TEST_TABLE WITH(XLOCK) 」を発行 (2)Ｂから、「SELECT * FROM TEST_TABLE」を発行 このような状況で、(1)、(2)の順で処理を行った場合に 私の認識では、(2)の検索時にタイムアウト等が発生するという認識です。 しかし、(2)のSQLは正常に終了し、(1)と同じデータが取得されてしまいます。 ◆その他、確認したこと ・(1)の処理直後に処理を停止し、Enterprise Managerでロックが取得されているか確認したところ、トランザクションＡがすべてのレコードを排他ロック(X)していた。 ・(2)の処理直後にロックの状態を確認しても、やはりトランザクションＡが、排他ロック(X)していた。 ・CSEを使いODBC経由で同様の操作を行った場合も同じ動作がおこる。 ・(1)WITH(XLOCK, TABLOCK)とすると(2)でデータが取得できなくなる。 ・(2)のSQLを「SELECT * FROM TEST_TABLE WHERE COLUMN01 > 0」のように指定するとタイムアウトする(期待通りの動き) ・(2)のSQLを「SELECT COLUMN01 FROM TEST_TABLE WHERE COLUMN01 > 0」のように指定すると、今度は、なぜか取得出来てしまう。 ・(1)と(2)の間にトランザクションＡでUPDATEなどを行うと(COMMITはしない)(2)のSQLのWHERE句や取得するカラムに関係なく、(2)のSQLはタイムアウトする(当り前か。。。) いろいろ書きましたが、排他ロックされたレコードに 共有ロックはかけれないという認識なのですが、 そうではないのでしょうか？ また、そうではない場合どういった場合に、 共有ロックが可能となるのでしょうか？ SQL Serverの排他制御に詳しい方や 同じような現象に陥った方がいましたら、ご教授お願いします。
ID列を含む「テーブルA」の内容をコピー＆コピーの一部項目を編集して、ID列はリセットして振り直しを行った後、「テーブルA」にINSERTするといった事をしたいのです。編集する項目、IDの項目はKEYになっている。 SQLリファレンスで調べてみましたが、SET IDENTITY_INSERT XXXX ON、DBCC CHECKIDENTなどの使い方がいまいち良くわからないのです。 １．「テーブルA」のIDENTITYをはずした形で、コピー先のテーブル「テーブルB」をCREATE。（レイアウトは全く同じ。） ２．「テーブルA」を全て、「テーブルB」（編集用）へINSERT。 ３．「テーブルB」の一部項目を編集、「テーブルA」のID列に相当する項目を'1'から配番する。 ４．編集後の「テーブルB」を全て、ID列を含む「テーブルA」にINSERT。 上記３、４項の方法が良くわかりません。 データテーブルは、「年度」・「履歴番号」(ID）・「その他項目多数」を持ち、編集方法は、「年度」を新年度に置換し、「履歴番号」を'1'から振り直したものを、「テーブルA」にINSERTしたいのです。 「履歴番号」(ID）の振り直しの条件はありません。レコードTOPから'1'から順に再配番されればいい。 やりたい事は単純なのですが。。。。初心者ですみません。 助言いただければと思い質問しました。
VistaのHomePremiumが２台あります。仮にＡとＢとします。ＡにSQLSERVER2005をインストールしました。Ｂマシンからアクセスはできるのでしょうか？できるとしたら設定を教えてください。 ちなみにＡ・ＢともＩＰアドレス192.168.100.ＸＸ 　　　　　　　　　サブネット　255.255.255.0 上にあります。
こんにちは SQLサーバー2000のシステムテーブルについて質問があります。 現在、DB内の各テーブルがどのファイルグループに属し、 どの物理ファイルがどのファイルグループにリンクしているか、を調べています。 これらの情報を、システムテーブル(sysfilesなど)から一括で取得したいと思っていますが、どなたか取得方法をご存知の方がいれば教えて頂けませんでしょうか？？ ちなみに、ひとつのファイルグループに対し、複数の物理ファイルが存在し、どの物理ファイルが現在有効として使用されているのか判断できかねています。 以上宜しくお願いします。
お世話になります。 現在リモートのSQLServerにVB.NETのアプリからADO.NETで接続しようとしていますが、Windows認証の接続ができなく困っております。 sqlcmdコマンド使いSQLServer認証で確認すると以下の方法であっさりできました。 sqlcmd -S DBのホスト名 -U ユーザID -P パスワード -d DB名 しかし、Windows認証は「sqlcmd -S Bのホスト名 -E」を実行するとGuestユーザではログインできるのですが、他ユーザではログインできません。シクライアントPCとDBサーバ間の信頼関係ができていないのが原因のように思われますが、クライアント及びDBサーバのWindowsのログインユーザ名/パスワードは同じ、ワークグループも同じです。 また、SQLServerのManagement Studioを用いてユーザは作成してあります。 エラーは以下となります。 ----------------------------------------------------------- サーバーへの接続を確立しているときにエラーが発生しました。SQL Server 2005 に接続しているときときにこのエラーが発生した場合は、SQL Server の既定の設定がリモート接続を許可しないようになっていることがエラーの原因である可能性があります。 (provider: 名前付きパイプ プロバイダ, error: 40 - SQL Server への接続を開けませんでした) ----------------------------------------------------------- お手数お掛けしますが、宜しくお願いします。
こんにちは。宜しくお願いします。 かなり古いシステムでVB6で開発されているものがあるのですが、昨日、データーベース（SQLServer2005）のとあるテーブルの列のサイズをVarchar(1000)からVarchar(2000)へ変更しました。 すると、いままで問題なく稼動していたシステムにエラーが発生しまして、デバッグしてみると、SELECT文で取得した変更箇所の列の値が、NULLで戻ってきました。 NULL値の対策として、IsNull関数を使用して、NULL値の場合には、別の文字列に変換するようにしてあるのですが、IsNull関数ではNull=Falseを返します。 いろいろネットで文献を探しまして、Where句に指定している列名をSELECT句に含まないといけないという記述を発見しましたが、実行しても結果は変わりませんでした。 なにかSQLServer側で意識しなくてはいけない事があるのでしょうか。 当方、DBにはあまり詳しくないので、原因に心当たりのある方はご教授頂ければ幸いです。
テーブルなどにつき、「テーブルをスクリプト化」→「Drop to およびCreate to」でスクリプトの採取するときのことです。 使っているデータベース名が「MADB」だった場合、 --------------- USE [MADB] GO --------------- というふうに、データベース名の指定がスクリプトの中に入ってしまいます。 違うDBで使うこともあるので不要なのですが、この指定の文を入れないようにする設定はどのようにしたらよろしいでしょうか。 （MSDNなども見たのですが、該当する記述を発見できませんでした。
趣味でサーバー構築を楽しんでいます phpからqueryでデータを渡そうとしたところ詰まってしまい、どうにも分からないので質問します //MSSQLQuery// DECLARE @acct varchar(32); SET @acct = 'testname'; INSERT INTO test.dbo.tblInfoA (Number,ID,) SELECT Number,@acct FROM test.dbo.tblinfoB WHERE userId = @acct このクエリをphpフォームからDBに送りたく下記をphpに記述しました */php mssql_query("INSERT INTO test.dbo.tblInfoA (Number,ID) VALUES ('SELECT Number FROM test.dbo.tblinfoB WHERE userId = $login','$login');") エラーメッセージ message: Conversion failed when converting the varchar value 'SELECT Number FROM test.dbo.tblinfoB WHERE userId = name' to data type int. (severity 16) お分かりの方いましたらご返答よろしくお願いします。
SQL Server 2008 へリモート接続できません。環境は下記の通りです。 SQL Server 2008 Work Group Visual Studio 2008 Developer Windows-7 コンピューター名 Y-05 フルコンピューター名 Y-05 ワークグループ　　　 Y-PLAN ユーザーアカウント　 東京 太郎 サーバーは、リモート接続可にチェックしてあります。また、ファイヤウオールの例外として TCP/IP ポート1433の設定はしてあります。また、Windows認証とSQL 認証の設定もしてあります。 Windows認証のためのログインIDをSQL Server Management Studioのセキュリティから設定しようとすると、下記の表示がでて設定できません。 Transact – SQLステートメントまたはバッチの実行中に例外が発生しました。 東京 太郎　は有効なWindows NT名ではありません。完全な名前 <domein\username> を指定してください。 Microsoft SQL Server エラー 15407 ログインIDを Y-05\東京 太郎　としても結果は同じです。ご指導のほどよろしくお願いします。
グローバル ┌┴─────┐ │ＷＥＢサーバ│ └┬─────┘ ローカル ┌┴────┐ │ＤＢサーバ│ └─────┘ 両方　windows 2003 server 添付の画像の通りDBサーバのCPU波形が急に変りました。 1日のPVが155万から130万に激減りしました。 DBサーバのCPU波形がどうも臭うのですが　原因がわかりません。 プロセスタブにてCPUを使っているのはsqlservr.exeでCPU使用率が100と0を行き来しています。 0％の時にプロセス自体は落ちていませんでした。 このような波形になる考えられる原因はなんでしょうか。 過去事例などないでしょうか。 宜しくお願い致します。
質問があります。 Access2003とSQLserver2005の排他制御についてです。 複数のＰＣから共有してアクセスし、レコード単位に排他制御したいといった場合、 排他制御に適しているのはどちらでしょうか？ 「Accessではこういう問題があり適さない」などあったら教えてください。 よろしくお願いします。
今月からMS系環境の職場に配属になり、RDBMSもSQL-Serverになります。 まだ新人でSQLのこともわかっていないので一から勉強しようと思いますが、 お勧めの書籍とかありましたら是非教えて頂けたらと思います。 SQL-Serverに拘らず、SQL全般の入門書はコレだ！！というものがありましたら 教えてください。 私が今のところいいかな～と思っているのは 「現場で使えるSQL」です。
現在件名の環境に複数の端末から、Officeアプリケーションで接続しています。 そこでSQL Server Management Studio Expressの利用状況モニタを利用して、接続しているプロセスを確認したのですが、 Officeアプリケーションで接続しているプロセスのホスト名が全て同じ（Officeアプリケーションを開発したホスト名）になっています。 接続しているホスト名を正しく表示したいのですが、何が原因でこのようなことになっているのでしょうか？ ご存知の方がいらっしゃいましたら、ご教授ください。
こんにちは。 現在VisualStudio 2008 ProでC#を用いてWebアプリケーションを作成しようとしています。 いつもは、SQL　Serverのデータを扱うのにADO.NETを使用してアプリケーションを作成しています。 Webアプリケーションのデータベース用のPCとしてWindows2003とSQL Server2005 Standardが搭載されているPCにAccess2003で作られているmdbがリンクサーバー設定されているものを用意しております。 このmdbは別のシステムで使用されており、常に更新されています。 今のところ、SQL　Serverのタスクを用いて定期的(10分おきとか）にこのリンクサーバー上のmdbの情報を読み取り、SQL　Server上に作ったテーブルを更新しているのですが、これだと情報を取りにいった時にタスクの更新が行われるまで、古い情報を取得することになります。 リアルタイムで取得することを考えた場合、 C#で作成したアプリケーションでこのSQL　Serverにアクセスした時に直接リンクサーバーに対してSQL文を実行するという方法を考えているのですが、いろいろ検索しましたが探すことが出来ませんでした。 この様な方法がありましたら教えていただけないでしょうか？
こういうビューを抽出するSQLを書きたいのですが、わからず困っています。 TableA (主キー:ID) 　ID│CodeA ──┼───── 0001│123 0002│234 　：│： TableB (主キー:ID) 　ID│CodeA │CodeB │Name ──┼───┼───┼─── 　 1│123 　│A1　　│XXX 　 2│123 　│B1　　│YYY 　 3│123 　│C1　　│ZZZ 欲しい抽出結果 (CodeBとNameは1行に最大5回まで存在しうる) 　ID│CodeA │CodeB1│Name1 │CodeB2│Name2 │CodeB3│Name3 ──┼───┼───┼───┼───┼───┼───┼─── 0001│123 　│A1　　│XXX　 │B1　　│YYY　 │C1　　│ZZZ こういうのってSELECT文だけで記述できるのでしょうか？ どのように記述すれば良いでしょうか？
初歩的質問ですが仕事でsqlを使うことになり勉強しています。sqlを勉強するためのソフト、sqlを記述するためのソフトを教えてください。 よろしくお願いします。
ACCESSのADPからストアドを実行するためにに、各ストアドの 「publicデータベースロール」でストアドの実行権限を「許可」にすればいいのかと思いますが、 一つずつ作業するのは面倒なので、実行権限を一括して付与する方法は ありませんでしょうか?
お世話になっております。現在、VisualC++（6.0）とSQLServer2005（9.0.1399）を利用して24時間365日常駐するバッチアプリケーションを開発したのですが、極稀に（年に2,3回程）更新処理と登録処理が正常に行かずデータが抜け落ちることがあります。 バッチアプリケーションは機械から送られてくるログファイルを取り込みデータベースに登録・更新を行うプログラムとなっております。 このような現象を防ぐ方法は無いでしょうか？ ※ちなみにプログラムではきちんとコミットしているようでした。
nacosと申します。 現在ASP.net（MVC)にてサイトを構築しているのですが、 データベースとのやりとりの所で良く分からなくなってしまったので質問させて頂きました。 ◆構成 サーバー：Windows Server 2008（IIS 7.0） DB：SQL Server 2008 開発環境：Visual Studio 2008 ◆分からないこと。 開発中のローカル環境でのDBとの接続方法と、 Webサーバー上でのDBとの接続方法は皆さんどのように行っているのでしょうか？ 私は、ローカル環境・WebサーバーともにDBへの接続方法をWindows認証にすれば、 ローカルで作成したサイトをWebサーバーにアップロードすれば接続出来るものだと思っていたのですが、 実際にはそのままアップロードしただけではWebサーバー上でDBに接続されない様でした。 この様な場合、どのようにすれば接続出来る様になるのでしょうか？ また、上記の様な場合で一般的な方法などありましたら教えて頂けないでしょうか。 宜しくお願い致します。
以下のような3階層のデータについて、以下の結果を得たいと思っています。再帰クエリを使用することになるかと思うのですが、どのようにクエリを作成すればよいでしょうか。アドバイスをお願いいたします。 ＜データ＞ 氏名　　　上司の氏名　　　階層　　　 田中　　　Null　　　　　　　　1　　 山田　　　田中　　　　　　　2 佐藤　　　山田　　　　　　　3 高田　　　山田　　　　　　　3 ＜結果＞ 氏名　　　部下の氏名　　　 田中　　　山田 田中　　　佐藤 田中　　　高田 山田　　　佐藤 山田　　　高田 佐藤　　　Null 高田　　　Null ※　部下の氏名は直下の部下だけでなく、直下の部下の、その下まで結果として返したい。
テストで作成したユーザーを削除したいのですが、データベースユーザーの プロパティの画面で「このユーザーが所有するスキーマ」が選択されている 状態(□に緑の■が入っている)だと削除できません。 試している最中に□にチェックを入れて[OK]をクリックした記憶があります。 他のユーザーの同じ項目の□にチェックを入れて[OK]を押せば消せる (他のユーザーへ移る)事は判ったのですが、今度はそのユーザーから 消すことができません。 他のデータベースを確認すると「このユーザーが所有するスキーマ」が 選択されているユーザーはありません。 質問1 他のユーザーに移して、このまま放かっておいていいのでしょうか? 質問2 「このユーザーが所有するスキーマ」はどんな意味でどんな使い方なのでしょうか? よろしくお願いします。
データベースのクエリについて教えてください。 電話番号カラムと携帯電話番号カラムが定義してあります。 どちらかのカラムにはデータが入っていて、その片方のカラムは空となっている場合、 電話番号か携帯電話番号の、どちらか空ではないデータのみを取り出したいのですが、 どのようなクエリにしたらよいでしょうか？ よろしくお願いします。
SQLServerのレプリケーションについて お世話になります。 環境が無く検証できない為、実績ベースで教えて下さい。 SQLServerで以下のレプリケーションは可能でしょうか？ パターン1 SQL2000→SQL2008 パターン2 SQL2000→SQL2000→SQL2000→SQL2000 上記を実現するに当たり懸念点などもあれば 教えて頂ければと思います。 よろしくお願いします。
SQL Server 2005 Developer Editionを使っています。 データのインポートに関して、ご教授をお願い致します。 ■質問 インポート(データベースを右クリックし、【タスク】より 【データのインポート】を選択している)機能について、 エラーを発生させずに、インポートをすることができるのか。 ■状況 エクセルにデータをエクスポートしたものを、インポートしようと したときに、エラーが発生します。そのテーブルデータは、 SQLでインサートすることはできるものの、インポート機能を使って インサートをすることができません。 ■知りたいこと ・インポートができない理由について。 　⇒インポートができる方法について。 ・インポート機能は、エラーがよく発生するものなのか。 以上、ご教授をお願い致します。
アクセスの操作で迷っています。かなり初心者ですがどうぞよろしくお願いいたします。 アクセスのテーブルで、商品の情報が入ったものがあります。 品番、商品名、価格、というような単純な情報です。 この、価格の部分を更新したいのですが、どういう風にしたらよいのでしょうか。 ちなみに、更新された価格のリストはエクセルで持っております。 インポートしてアクセスにも入っています。 その価格リストに入っているとおりの価格にテーブルの価格も更新し、 さらに、価格リストにないものに関してはそのまま、もともとテーブルに入力されている価格を保持したいのです。 文章のみでわかりにくいかと思いますがよろしくお願いいたします。 たとえば、エクセルのvlookなどを使ってできたりするのでしょうか。 アクセスにかなり不慣れなので（とくに式などはわかりません）簡単にできる方法を知りたいのですが、 どなたかどうぞよろしくお願い申し上げます。
MSDE2000にて自動で圧縮されるという噂を聞いたのですが、 圧縮が行われるタイミングはなにか法則があるのでしょうか？ 終了時に自動実行するなどのオプションも指定可能でしょうか？
SQL Server2008のsqlcmdコマンドでデータベースに接続しようとするのですが、localhostアカウント以外接続ができません。 理由を教えてください。 【成功】 sqlcmd -S localhost -d tempdb -E -i create.sql 【失敗】 sqlcmd -S 1.1.1.1 -d tempdb -E -i create.sql 【エラー内容】 エラー: Microsoft SQL Server Native Client 10.0: 通信リンクが失敗しました。。 Sqlcmd: エラー: Microsoft SQL Server Native Client 10.0: SQL Server への接続の確立中に、ネットワーク関連のエラーまたはインスタンス固有のエラーが発生しました。サーバーが見つからないか、アクセスできません。インスタンス名が正しいことと、SQL Server がリモート接続を許可するように構成されていることを確認してください。詳細については、SQL Server オンライン ブックを参照してください。。
以下のデータで、dataで始まり、かつ数値部分を100～300の範囲で抽出したいと考えています。 テーブル名はtable1、フィールド名はretuです。 -retu- data023 unknowndata data105 data203 data827 SELECT retu FROM table1 WHERE retu LIKE 'data%' AND CAST(RIGHT(retu,3) AS Int) BETWEEN 100 AND 300 上記のSQLを作ってみたのですが、これだとunknowndataに対してCASTが行われてしまうらしく、CASTが失敗してデータを取り出すことができませんでした。 正しくデータを取り出すためには、どのように記述すれば良いでしょうか？
いつもお世話になっています。 下記のようにAテーブルBテーブルを元に Cテーブルのようにデータを出力したいのですが、 SQL文がうかびません。 どなたか教えてください！！ ●Aテーブル(取込データ） 　名前　　｜　コード1（主コード） ------------------------- 　小林　　｜　100　 　小林　　｜　102　　 　田中　　｜　110　 　町田　　｜　130 　木村　　｜　160 　木村　　｜　160 　木村　　｜　180 ●Bテーブル（取込データ） コード1 ｜　コード2 --------------------------- 　100　　　｜　A 　110　　　｜　C　 　130　　　｜　D 　160　　　｜　E ●Cテーブル（出力データ/ABテーブル合体させたもの） ★　※※※を表示させたい！ 　↓ここまでは表示はできている↓ 　名前　　｜　コード1　　｜　コード2 -------------------------------------------- 　小林　　｜　100　　　　｜　A 　小林　　｜　102　　　　｜　※※※ 　田中　　｜　110　　　　｜　C　 　町田　　｜　130　　　　｜　D 　木村　　｜　160　　　　｜　E 　木村　　｜　160　　　　｜　E 　木村　　｜　180　　　　｜　※※※ 　↓表示したい内容。不明な点。↓ 　名前　　｜　コード1　　｜　コード2 -------------------------------------------- 　小林　　｜　100　　　　｜　A 　小林　　｜　102　　　　｜　A 　田中　　｜　110　　　　｜　C　 　町田　　｜　130　　　　｜　D 　木村　　｜　160　　　　｜　E 　木村　　｜　160　　　　｜　E 　木村　　｜　180　　　　｜　E 以上　よろしく御願いします！！
OSの日付を変更せずにGETDATE()の結果を変更する方法はありますか？たとえばOSは2009年10月10日なのにGETDATE()で帰ってくる値は2008年10月10日みたいにする方法です。サイクルテストを行う際に特定のデータベースだけ日付を戻したいのです。OSの日付を変えるとウイルスセキュリティなどに影響が出てしまうので・・・
SQL Server 2005 express edition　で既定のインスタンス「SQLEXPRESS」で運用しています。 運用途中で、「TEST1」等にインスタンス名を変更することは可能なのでしょうか？ 目的としては、異なる拠点にあるスタンドアロン（SQLServerで構築しているサーバー）のバックアップを片方の拠点でバックアップを復元させたいのです。 ＜拠点(1)＞ SQL Server 2005 express edition（インスタンス名：SQLEXPRESS） で運用し、バックアップ時にインスタンス名を変更（インスタンス名：TEST1）して、バックアップファイルを作成 ＜拠点(2)＞ SQL Server 2005 express edition（インスタンス名：TEST1） に拠点(1)で作成したバックアップを復元する ※　拠点(2)では、TEST1～TEST10　のように各拠点のインスタンスを 　　作成しておいて、それぞれのバックアップを復元できるようにした　　いのです。 ご教示の程、お願い致します。
SQLServer2005、 Management Studioを使用して、 バックアップを取ろうとしたのですが、 誤って、タスク→復元→データベースを選択してしまい そこで、キャンセルをクリックしようと思ったのですが、 手が滑り、OKをクリックしてしまいました。 で、3日位まえの状態にもどってしまいました・・・ この、復元操作をキャンセルすることは可能でしょうか？ もし、可能であれば、操作方法を教えて頂けませんでしょうか。
以下の３つのテーブルから、下記のような結果を得たいです。 table1:PK=id id(int), count(int) ------------------- 1, 11 2, 12 3, 13 5, 15 table2:PK=id ------------------- id(int), count(int) 1, 21 2, 22 4, 24 tableID:PK=id id(int) ------------------- 1 2 3 4 5 6 得たい結果 tableIDのすべてのIDに対して、 table2に見つかればtable2のID、 table2に見つからずtable1に見つかればtable1のID、 両方になければnull id, count ---------- 1, 21 2, 22 3, 13 4, 24 5, 15 6, null よろしくお願いいたします。
いつもお世話になっております。 SQLを学んで３ヶ月の初心者です。 下記の内容でご理解いただけ、分かる方がいましたら教えていただけないでしょうか。 一応、自分なりに以下作成したのですが、結果が反映されなく困っています。 よろしくお願い致します。 ※質問内容※ ・条件に従い、Aテーブルから必要な項目を抜き出し、Bワークテーブルを作成する。 ・＠・・・頭で宣言しています。 delete from Bワークテーブル insert into Bワークテーブル ( ID, CD, 伝票番号, 部門CD, 引当日, ユーザID, ) select Aテーブル 　Cテーブル.ID, 　Aテーブル.CD, 　Aテーブル.伝票番号, 　Aテーブル.部門CD, 　Aテーブル.引当日, 　Aテーブル.ユーザID, from Aテーブル INNER JOIN Cテーブル ON Cテーブル.ID = @ID where Aテーブル.CD = @CD and ((Aテーブル.伝票番号 >= @伝票番号FROM) OR (@伝票番番号FROM IS NULL)) and ((Aテーブル.伝票番号 <= @伝票番号TO) OR (@伝票番号TO IS NULL)) 以上。
すいません、まだはじめたばかりで全然良くわからないのですが、 維持管理でこのＳＱＬ文で処理速度の遅さにひっかかっています。 自分で作ったものではないのでいまいちよくわかってないのですが、 エージェントのジョブで１日３回行っている処理、同じ件数（インデックスがまったく一緒）になるよう、INSERTをかける処理なのですが、 INSERT INTO TABLE_A SELECT AAA, BBB, CCC, 0, 0 FROM TABLE_B WHERE A + B + C NOT IN (SELECT A + B + C FROM TABLE_A) というようなTRANSACT SQLになっています。 TABLE_AにないものをTABLE_Bから持ってくるということだと思います。 件数は約１３万件、なぜか１時間かかるようで、他の処理のレスポンスに影響が出てきています。 根本的にこういうやり方はまずいのでしょうか？処理を遅くする要因があるのでしょうか？ もしあるようなら改善策を教えていただけると助かります。 環境はSQL SERVER 2005です。 どちらもＡ，Ｂ，Ｃにインデックスがあります ちょっと事情があって、大きくやり方を変えられないので、エージェントのジョブ内でもっと早くできる方法が知りたいです。 なにとぞ、よろしくお願いいたします。
OS：2008WinSV 機種：PRIMERGY RX300S5 DBMS：SQL Server 2008 Enterprise Edition DBスペースの容量やメモリ量を見積る際、 例えばSymfowareなどのDB製品では、明確な見積り式というのが 存在していると思うのですが、 SQL Serverではそういった見積り式ってありますでしょうか？ 調べたかぎりでは見つけられませんでした。 分かる方いらっしゃいましたら教えていただきたいです。 以上よろしくお願いいたします。
初心者の質問で申し訳ありません SQL Server2008でトランザクションリプリケーション設定をしている場合、リストアするときに必ずリプリケーションの再作成が必要なのでしょうか？
初心者です。 ＳＱＬを「発行」とか「実行」とか言うのをよく目にしますが これは同じ意味なのでしょうか？
お世話になります。どなたかご教示いただければ助かります。 現在SQL SERVER 2005 EXPRESS EDITIONで運用しているデータベースのバックアップを定期的に取りたいと思っております。 クライアントはAccess2000のADPを利用しております。VBAのコードから、ADODB.Commandオブジェクトを利用してBACKUP DATABASE のコマンドで問題なく、バックアップファイルは作成できるのですがRESTORE DATABASEを使用すると、どのパソコンからもアクセスしていないのに「データベースは使用中なので、排他アクセスを獲得できません」とメッセージが出てしまいます。どうすれば回避して復元できるでしょうか。 お忙しいところ申し訳ありませんが、ご教示いただければ助かります。
お世話になります。どなたかご教示いただければ助かります。 現在SQL SERVER 2005 EXPRESS EDITIONで運用しているデータベースのバックアップを定期的に取りたいと思っております。 安価で利用できるバックアップソフトを教えていただければ大変助かります。
お世話になります。 SQLserver2005でユーザー定義関数に初めてトライしているのですが デバッグツールがなく、うまく動かない理由がわからず困っております。 ある文字列に対して、指定したバイト数までの文字を返すような関数を作りたいです。VBAでいうLEFT関数のバイト数指定版というのでしょうか。（すでにそんな関数があったりして。。） 以下のように作ってみたのですが、無限ループのようで、いつまでたってもデータが返ってきません。。どなたか教えていただけませんでしょうか？ set ANSI_NULLS ON set QUOTED_IDENTIFIER ON go CREATE FUNCTION [dbo].[LeftByte] (@value nvarchar,@maxbyte bigint) RETURNS nvarchar(max) AS BEGIN declare @Countvalue as bigint declare @byte as bigint declare @result as nvarchar select @byte = 0 select @Countvalue = 0 select @result = '' while @byte < @maxbyte begin select @Countvalue = (@Countvalue + 1) select @result = (left(@value,@Countvalue)) select @byte = (datalength(@result)) if @byte >= @maxbyte break else continue end RETURN @result END 宜しくお願い致します。
WindowsServer2003でコンピュータ名の変更を行った際、IIS経由でSQL Serverへ接続できなくなってしまいました。 SQL Serverの起動、ネットワーク越しでSQLServerManagementStudioからの接続、VisualStudioの開発サーバ越しの接続は問題なく行えています。 対策として以下の方法を試してみましたがうまくいきませんでした。修正方法をご存知の方がいらっしゃいましたらご教授をお願いいたします。 ■行った対策 １．SQL Serverへのsp_dropserver、sp_addserverによる新しいコンピュータ名の反映（もともとSQL Server起動時のエラーなどは出ていない） ２．コンピュータ名を元に戻す ■環境 ・WindowsServer2003　Enterprise Edition SP2 ・SQL Server 2005　Standard　Edition ・IIS6.0 ・ASP.NET2.0 補足： バックアップができておらずサーバ構成・IIS構成の復元は行えない状態となってしまっていますので、原因を取り除く形で修復しなければならない状況です。
SQLServer2000 あるテーブルのデータを追加、更新、削除できないようにするにはどのようにしたらいいでしょうか。 どなたかご存知の方、お教え下さい
よろしくお願いいたします。 VB2008Express＋SQLServer2008Expressを勉強しております。 Date型にNULLをセットする方法についてお聞きします。 定義ではDate型で「NULLを許容」にしております。 http://oshiete1.goo.ne.jp/qa1047427.html?ans_cou … この質問を参考に、 INSERT INTO tbl_Main(dteDate) VALUES (DBNull.Value) このようにしてみましたが、 「不適切な構文があります」というエラーが起きます。 空文字「"''"」にすると「1900/01/01」がセットされてしまったり、 「vbTab」に変えてみたりとやってみましたが、うまく行きません。 お時間がありましたら、アドバイスよろしくお願いいたします。
いつもお世話になります。 ずばり、SQL2008での年度の取得方法を教えてください！ 例えば、2008年3月～2009年2月　・・・　2008年度 が取得したいのです。 よろしくお願いします。
WITH句で複数テーブルを定義する方法を知りたいです。 どこかのサイトで、複数テーブルを定義するには、以下のような 方法にて実現できる旨の記事を目にしました。（withでの宣言テーブル間を「,」で区切る）ですが、「'.' 付近に不適切な構文があります。 」のようにエラーがメッセージ欄に表示されます。 ------------------------------------------------------------ WITH a (code, cnt) as ( select code, count(*) from abc where a is null group by documentcode), b (ttr.documentcode, cnt) as ( select ttr.documentcode, count(*) from abc tr inner join def ttr with(nolock) on tr.seqno = ttr.seqno where SendTime is null group by documentcode ) select * from a cross join b; ------------------------------------------------------------ ご存知の方でコメント頂ける方、お手数お掛けしますが、 宜しければ教えて下さい。
SQL Server 2005 Express で、別のデータベースへのテーブルの移行するにあたり、 INSERT INTO データベースB.dbo.テーブルX SELECT * FROM データベースA.dbo.テーブルX とすればよいというご回答をいただいています。 で、 IDENTITYを設定しているテーブルがあるとちょっと工夫が必要です。 とのコメントをもいただきましたが、 この「工夫」が分かりません。 どんな方法なのでしょうか？ IDENTITYをはずす方法や、リレーションシップをはずす方法などが思い浮かぶのですが、テーブル構造が複雑で、わけがわからなくなります。 元のIDの値は維持しなくてもよいので、何かよい方法はありますでしょうか？ よろしくお願いします。
SQLSERVER2008で別のデータベース１からbcpコマンドでバックアップしたdatファイルがあります。それを別のサーバーのデータベース２に インポートしたいのですが、データベース２もSQLSERVER2008です。 （データベース２にはインポートするテーブルは作成済です。） bcpコマンドでインポートしようとすると、サーバーが見つからないかインスタンスエラーになってしまいできません。 そこでツールでインポートしようとしたのですが、 データソースをテキストでdatファイルのあるパスを指定して やったのですがこれも入りません。 どうすればインポートできますでしょうか？ データベース２の方はwindows認証です。コマンドでcdで datファイル(table1.dat)がある階層まで下げてからこう入力しました。複写元　table1.dat→複写先　DB TESTのtable1へ bcp TEST.dbo.table1 in table1.dat -T -C -t bcp,ツールどっちでもいいのでインポートの方法を教えてください。
サーバー初心者です。 データに空白（""）を入れたら下記のエラーメッセージが出てしまいました。どのように対処したらよいのでしょうか？ エラー文 [Microsoft][SQL Server Native Client 10.0][SQL Server]着信の表形式のデータ ストリーム (TDS) リモート プロシージャ コール (RPC) プロトコル ストリームが不適切です。パラメータ3 (""): データ型 0xE7 に、無効なデータ長またはメタデータ長が指定されています。(#8016) 環境 OS:VISTA HOME Premium サーバー:SQL Server 2008 EXPRESS 列のプロパティ データ型:nvarchar NULLを許容：はい 長さ：300　（50などにしても同じのがでます。） ＊使用状況 ACCESS から　SQL SERVER にリンクして　データを挿入したらエラーが出ます。 よろしくお願いします。
関係データベースを用い、学生の所属するサークル管理を行うことになった そこで、以下のような項目を選択した。以下の関係をリレーショナルモデルのスキーマで表現しなさい ただし、スキーマの項目は、学生、所属、サークルとする。主キーには下線がついている。 [クラブ]（学生ID(下線),学生名、入学年度、サークルID(下線）,サークル名） 以上の問題なのですが答えがいまいちわかりません。 自分でやってみた所 ・学生 学生ID（主キー)、学生名、入学年度 ・所属 学生ID(主キー)、サークル（ID)、学生名、サークル ・サークル サークルID(主キー)、サークル名 こんな感じになったのですがどうでしょうか？ わかる方おねがいします。
SQLを使うことが初めての、本当にど素人です。 質問の仕方自体おかしいかもしれませんが、どなたか下記条件でデータ抽出するSQLの書き方を教えて下さい。 【抽出条件】 １つの商品購入テーブルから、5月と6月に購入してて、7月と8月に購入していない、東京都と神奈川県在住の方の顧客IDと購入商品すべてを抽出できないでしょうか？ カラムは、顧客ID、購入月、顧客都道府県、商品コードとそれぞれ分かれています。 この内容で、ご回答いただけますでしょうか？ 何卒よろしくお願いします。
SQL Server のデータをCSVファイルにして保存したいのですが、簡単に出来る方法はないでしょうか？ よろしくお願いします。
TableAとTableBがあります。構造は同じです。 中身は下記のようだとします。 TableA　　　　　　TableB ID　VALUE　　　　　ID　VALUE １　A　　　　　　　３　C ２　B　　　　　　　４　D ３　C　　　　　　　 差分結合結果を下記のようにとりたいのです。 １　A ２　B ４　D 良い方法をご存じでしたら、ご教授よろしくお願い致します。
お世話になります。 以下のSQL文を実行したところ、更新されなくて困っております。 UPDATE RCV SET STATUS = '0' WHERE REC = convert(datetime,'2009/11/17 22:54:51') UPDATE RCV SET STATUS = '0' WHERE REC = '2009/11/17 22:54:51' 日付をコメントにすると、問題なく更新されます。 すいませんが、ご教授いただきたく宜しくお願い致します。
SQL Server 2005 Developer Editionを使っています。 インポートについて、皆様の知識のご教授をお願いします。 (1)、(2)と二つありますが、どちらか一方の回答でも 構いませんので、よろしくお願いします。 (1)Excelインポートによる取込について まず、Excelにテーブルデータをエクスポートしました。 データには、改行されているものレコードもあります。 そのExcelファイルをエクスポートしたテーブルに インポートしようとすると、エラーが発生します。 また、改行されているデータのレコードだけを 手動でコピー＆ペーストしても、貼り付けることが できない状態です。さらに、Excel上のデータを直接コピーし、 該当のレコードの箇所に張り付けても、1行目だけしか 貼付けができない状態です。 (2)テーブル間の改行を含むデータ移行について AとBという、テーブル名だけが異なり、列名やデータ型が 同じテーブルだとします。 ここで、BからAテーブルへデータ移行させる際に、 改行されているデータについても、正常に移行できるように するには、どういう手順を踏めばいいか教えて頂きたく思います。 Bテーブルの列を全てコピーし、Aテーブルに貼り付けても、 うまく貼り付けることができませんでした。 改行されているデータは、どうやったら、テーブルに インポートできるのかを教えて頂けないでしょうか。
あるパッケージを買い、ファイルをFTPを使ってサーバーへアップし、管理画面へいきたいのですが、下記エラーが出ます。 SQLDatabase() : DB CONNECT ERROR. -> sqlite_open(estate) 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　↑ 　　　　　　　　　　　　　　　　　　　　DBネームが反映されます。（eatate) パッケージの中のsqlConf.phpのファイルをテキストで開き、 記述内容を入力するよう説明書には書いており、 そこにDBネーム、DBのID、DBのパスワードを入力するようありますが そこが間違っているのでしょうか？ コンピューターのことは素人なので このようなことが難しいのかどうかも分かりません。 どうか教えて頂ければ幸いです。
varchar(2)のフィールドがあります。 値は必ず二文字入力されています。 値が数値の時は数値以外かを判断できますか? (用途) コンボボックスのソースに下記の様に指定したいのです。 select * from T_品種 where 品種コード 「が数字だったら」 よろしくお願いします。
SQL Server2008でDBを管理しているのですが、 エンドユーザーに与える権限に付いて教えて下さい。 ACCESS ADPから接続してデータの登録、更新、削除を行ないます。 現在、ログインでsysadminをチェックしないと上記の作業が出来ません。 データベースユーザー全てのロールをチェックしてもログインで sysadminがチェックしてないと動作しません。 エンドユーザーのログインではsysadminをチェックしない方がいいと 考えるのですが、その場合各データベースのセキュリティはどのように 設定したらいいのでしょうか?
SQLServerは始めてです。 SQLServer2008 Management Studio Expressを自分のPCにインストールしました。やりたいことは、自分のPCでサーバー、データベースを作ってVB6でデータを取得したりするアプリを入れて動かせる環境に したいのですが。（他のPCにサーバーを設定せず）インストールした後、どうやってサーバー登録するのか本を見てもよく分かりません。複雑なSQLを作成しなくてもSQLServerでは簡単にできるような事を本に書いてあるみたいですが。 SQLServer Management Studio を起動するとサーバーへの接続画面が 表示されます。でもまだサーバーの登録がされていないので、エラーになってしまいます。左側のオブジェクトエクスプローラは空っぽです。この後何をすればいいのか分かりません。 それとも何か足りないのでしょうか？サーバーの登録、データベースの作成方法を教えてください。そしてサーバーへの接続画面で入力して エラーなくサーバーに接続し、データベースに接続できるように教えてください。
お世話になっております。 この度、社内サーバ撤去に伴い現在使用しているSQLサーバーよりデーター抜き出し担当となりました。もっぱら、使う側だったので何をどの様にすればいいのか困っている超ド初心者です。件名についてご質問いたします。 以下の作業に入る前に、当カテゴリーの過去質問を参考にし進めています。 http://oshiete1.goo.ne.jp/qa4614355.html 現在サーバ上にてSQL2000を稼動させています。DBファイルであるhoge.mdf とhoge.ldfに関してはSQLサーバ停止後コピーまで完了しました。 クライアント（自端末）機に『SQL Server 2008 Express with Tools』を導入し接続及び該当DBへのアタッチ、テーブルフォルダー内も確認しました。 テーブルフォルダー内には、約２０個程のテーブルが存在しています。 上記URLでは、復元出来たデータベースを右クリックし『タスク→エクスポート』でデータエクスポートウィザードよりフラットファイルで吐き出せばいいとの手順でした。ウィザードでは、テーブルを指定する項目が出てきますが。実際の所２０個のテーブルに対して同操作を繰り返し手動で項目整理を行う事になるのでしょか。または、ウィザードの『転送するデータを指定するためのクエリを記述する〔Ｗ〕』を使用するのでしょうか。 クエリー記述の場合の相当する項目を現在把握していませんので全項目抽出を行い。Excel取り込み後削除できるとありがたいのですが。 最終形として、Excelに取り込んで管理していきたいと考えています。 当方の勝手な都合ですが、当サーバ撤去が目前に迫っています。 よろしくご助言の程お願いいたします。
ACCESS 2003 の VBA で下記の命令を実行してエクセルファイルをエクスポートします。 (環境はSQLserver2008、XP+ACCESS2003+EXCEL2003) DoCmd.OutputTo acOutputStoredProcedure, "テーブル名", acFormatXLS, "C:\ACCESS\テーブル名.xls" (1) 日付型(datetime)のフィールドの表示が「20-Dec-09」となってしまいます。 最初から「2009/11/20」と云う型でエクスポートできないのでしょうか？ (2) エクスポートされたファイルを開いて保存するときに 「Excel 5.0/95 ブックです。最新の Excel のファイル形式に更新しますか?」 と表示されます。 (VISTA+Access2003+Excel2007は表示されません) 最初から2003のファイル形式でエクスポートする方法はありませんか?
データ値：1234 INSERT時に上記データ値をTIME(0)のカラムにセットする場合、 どのようなsql文にすればよいのでしょうか？ 望む結果：12:34:00 どなたか御教示宜しくお願いします。
SELECT ○○○ as 連番,コード,名称 From テーブル where 条件 ↓ 1 a001 トヨタ 2 b005 ニッサン 3 b018 ホンダ 　　　: ってな感じしたいのです。 ○○○の所にはまる「関数の様な物」はありませんか? 単純に有ってもよさそうなのですが見つけられません。 よろしくお願いします。
会計ソフトを起動するとSQLサーバーが見つかりません。とメッセージが出るのでSQLマネージャーを見ると停止になっていましたので開始/再開を押したのですが、エラー5（アクセスを拒否されました。）と出ます。開始する方法はあるのでしょうか。
現在会社でSQLServer2005 (Workgroup 5クライアント)を使用しているのですがもう一台サーバーが必要になりました。 そこでSQLServer2008(Workgroup 5クライアント)を購入しようと思うのですがこの2つのソフトに互換性はありますでしょうか？ (1)サーバー(SQL2005)→クライアント(SQL2008) (2)サーバー(SQL2008)→クライアント(SQL2005) この2つのパターンが接続可能かどうか教えてください よろしくお願いします。
WindowsServer2008SP1(64bit版)で開発しています。 クライアントからサーバーのASPを動かして、そのASPの中でexeを動かしているのですが、その際に「指定したコネクションは存在しません」というメッセージと共にエラーになってしまいます。 サーバーから直接VBSで動かしたときには、上手くいくのですが、ASPからだと上手くいかないという現象です。 SQLServerへの接続にはODBCを使っており、システムDNSにも作成してあるのですが、ほかに何か設定が必要なのでしょうか？
私は今不動産会社のweb制作担当で働いています。 web制作といっても、元々私はデザイナーなので ホームページを作ることしかできず、 物件検索などphpやsqlが必要なページは ほかの会社のSEさんが作ったものを使っています。 今回、物件検索の形を変えることになり、 ほかの会社のSEさんに相談したところ、 ヒントはくれるのですが、すべて任せて直していただくと お金が発生するので、私の力で修正したいと思い。。。 修正内容は今一緒になってるデータを id10、id20、id30、id40、id50でわけたいのですが。 SEさん曰く↓この文のWHERE recommend = '1' のあとに andでidをひっつけるだけといわれたのですが いろいろ試すんですが、うまくいきません。 $e['sql'] = "SELECT SQL_CALC_FOUND_ROWS a.id, a.kind, a.name, " . "a.address, a.price, a.area, a.room, a.ldk, a.parking " . "FROM hc_article AS a WHERE recommend = '1' " . "ORDER BY price ASC LIMIT {$e['limit']} OFFSET {$e['offset']};"; 単純にWHERE recommend = '1' and 'id10'のように していけばいいのでしょうか？？？ すみません。無知なもので、 うまく説明ができているかどうか・・・
SQL Serverの保守計画について質問です。 真夜中に保守計画を動かしているシステムがあるのですが、 以下のようなエラーが発生しました。 クエリ "DBCC CHECKDB WITH NO_INFOMSGS" の実行が次のエラーで失敗しました: "オブジェクト ID 321578567、インデックス ID 0、パーティション ID 72057597094199296、 アロケーション ユニット ID 72057597100556288 (型 In-row data) のページ (1:734549) の PFS 空き領域情報が不適切です。予想値 0_PCT_FULL、実際の値 95_PCT_FULL。 CHECKDB により、テーブル 'D出庫予定データ' (オブジェクト ID 321578567) に 0 個のアロケーション エラーと 1 個の一貫性エラーが見つかりました。 CHECKDB により、データベース 'AAAdb' に 0 個のアロケーション エラーと 1 個の一貫性エラーが見つかりました。 repair_allow_data_loss は DBCC CHECKDB (AAAdb) で見つかったエラーの最小修復レベルです。"。 考えられるエラーの理由: クエリに問題がある、"ResultSet" プロパティが正しく設定されていない、 パラメータが正しく設定されていない、または接続が正しく確立されていない。 整合性チェックでエラーが出ているのは分かるのですが、 具体的な解決策がよく分かりません。 何かアドバイスがいただければ、嬉しいです。
MSDE2000をインストールしたDB用サーバ（Windows2003Server）があり、それにDBを参照したり更新したりするソフトウェアが動作している端末が４台ぶらさがったシステムがあるのですが、時々、ソフトウェアの動作がかなり遅くなるという症状が発生します。 サービスの再起動で復旧するのですが、これは何が原因だと考えたらよいのでしょう？ ・全て２４時間連続稼動 ・サービスの再起動時、端末上のソフトウェアはそのまま動作中 ・DBのMDFファイルのサイズは、約1.4GB ・症状が発生する間隔は、約２，３ヶ月 少ない情報で申し訳ありませんが、どなたか助言をお願いします。
SSIS と他のETL ツールの検討中ですので、SSISのETL の機能について詳しい方がいれば、SSIS のETL の機能を教えていただけませんか？
Sqlserver2005でスクリプトを実行しているのですが、 Select * From ( Select文A ) TBL ( データ6万件 ) TBL2 Where TBL.Key *= TBL2.Key を実行したとき、 Select文A … (1) 1000件数で実行したときと (2) 1005件数で実行したときと では20秒(1)が遅いのです。 (2)は1秒もかかりません。件数結果が少ないにも関わらず 時間が遅いことはあるのでしょうか？？ どちらも遅いということだとわかるんですが… 実行プランをみたのですが、なにがよいのか判断できませんでした。 しかし、早く返ってくる方はハッシュ結合でした… Where句で日付の範囲を変えるだけでハッシュ結合になる場合とならない場合があるのも疑問でした… ご存知の方ご教授お願いいたします。
SQL Server2005　Expressを使っているのですが。 下記のような3列の項目からなるテーブルがあり、ABCはそれぞれ数字として。 No1,No2,No3 A, B, A, F, B, C, B, F, B, , C, E, F 数字をユニークし、結果を A,B,C,E,F としたいのですが。 列(No1)だけでのユニークでよいなら Select Distinct(No1) ・・・・・　と書けばよいのでしょうが。 現在は、各列でユニークし、配列にいれて重複は削除するやり方をしているのですが。 この例では3列ですが実際は5列以上あります。 SQLでスマートなやり方はないでしょうか？
varchar(8)の項目に1を加えると・・・ 「09110013」+1=「9110014 」となってしまいます。 結果が「09110014」と頭に「0」が付いたままにする方法はありませんか?
次のような操作がしたいのですが・・・ Test1 t1 t2 1 A 2 B 3 C --ココ Test2 tt1 tt2 tt3 1 1 AA 1 2 BB 2 1 CC 4 1 DD --ココ 結果 ココの部分を削除したい。 Test1とTest2を関係付けられなかった部分(Test.t1=Test2.tt1のinnerjoinの逆)を削除したいのです。 アドバイスあれば、宜しくお願いします。
いつもお世話になっています。 本日の午前中までに作成しないとならないのですが、下記の動作がわかりません。 お分かりになる方がいましたらどうか教えていただけないでしょうか! 環境：SQL2000 　　　windowsXP 【条件】 ・Aテーブルの番号列は全て”0”とする ・Aテーブルの１つの郵便番号が複数の住所をもつ→”0”のまま ・Aテーブルの１つの住所が複数の郵便番号をもつ→番号列を”１”とする。 ●Aテーブル ID 　｜　名前　｜　郵便番号　　｜　住所　　　｜　番号 ----------------------------------------------------------------------------- 01　｜　小林　 ｜　101-1000　｜　東京都　　｜　　0 02　｜　鈴木　 ｜　102-1000　｜　東京都　　｜　　0 03　｜　鈴木　 ｜　103-1000　｜　茨城県　　｜　　0 04　｜　町田　 ｜　105-1000　｜　神奈川県　｜　　0 05　｜　木村　 ｜　105-1000　｜　群馬県　　｜　　0 ↓出したい結果↓ ID 　｜　名前　｜　郵便番号　　｜　住所　　　｜　番号 ----------------------------------------------------------------------------- 01　｜　小林　 ｜　101-1000　｜　東京都　　｜　　1 02　｜　鈴木　 ｜　102-1000　｜　東京都　　｜　　1 03　｜　鈴木　 ｜　103-1000　｜　茨城県　　｜　　0 04　｜　町田　 ｜　105-1000　｜　神奈川県　｜　　0 05　｜　木村　 ｜　105-1000　｜　群馬県　　｜　　0 以上になります。どうぞよろしくお願いします！
ORACLEにて、テーブルのカラムに対してのコメントを 以下の構文で設定しています。 COMMENT ON COLUMN hoge.sNendo IS '年度'; (hogeテーブルのsNendoカラムのコメントとして「年度」を指定) これと同様のことを実現するには、 SQLServer ではどのように記述すれば良いでしょうか。 宜しくお願いします。
SQL文の作成方法が分からず困っています。 以下の実現はどのように行えばよろしいでしょうか？ --------------------- テーブルA:（項目）キー番号、項目No テーブルB:（項目）キー番号、項目No1、項目No1名称、 項目No2、項目No2名称、項目No3、項目No3名称 --------------------- とします。 ここで、テーブルA、Bでキー番号が一致し、 テーブルAの項目Noで、テーブルBの項目No1～3のどれかと 一致した場合、項目名称をテーブルBより取ってきたいです。 出力する時、項目No、項目名称は1個のみ出力したいです。 項目No1～3にない場合も名称空白でそのまま出力します。 （データ例) テーブルＡ： 100,1 100,4 110,5 テーブルＢ： 100,1,項目名1,2,項目名2,3,項目名3 110,3,項目名3,4,項目名4,5,項目名5 結果： 100,1,項目名1 100,4,(空白) 110,5,項目名5
社内向けシステムDBの更新作業を行っています。 システム上ではテーブルレコードがコンボボックスの形で 格納順に表示されてしまいます。 ただこの表示順がカテゴリー順になっていないのでとても選択しにくいです。 そこでレコードをカテゴリー順に並びかえテーブルを更新したい（SELECTで並び替えた状態で更新したい）のですがどうやればよろしいでしょうか？
OS:WindowsXP SQLServer2000 ＜質問＞ SQL文が浮かばなくて困っています。 どなかたお力を貸していただけないでしょうか。 以下、やりたいことです。 【条件】 １　AテーブルとBテーブルで郵便番号が一致しているものを抽出 ２　AテーブルとBテーブルに「番号」列を追加し、初期値を「０」とする ３　１の抽出後、同じ郵便番号がBテーブルに複数あった場合、 　　２で追加した「番号」列を０→”抽出した行分の数字”にする。 一応、【条件】１の箇所（下記）は浮かんだのですが、 ２と３が分かりません。 select　Aテーブル.*,Bテーブル.*　from　Aテーブル,Bテーブル left outer join　Aテーブル　on　Aテーブル.郵便番号 = Bテーブル.郵便番号 WHERE ？？？ ●Aテーブル ID 　｜　名前　｜　郵便番号　　｜　番号 ----------------------------------------------------------------- 01　｜　 小林　｜　101-1000　｜　0 02　｜　 鈴木　｜　102-1000　｜　0 03　｜　田中　 ｜　103-1000　｜　0 04　｜　町田　 ｜　104-1000　｜　0 05　｜　木村　 ｜　105-1000　｜　0 06　｜　中田　 ｜　106-1000　｜　0 ●Bテーブル ID　｜　分類　　｜　郵便番号　　　｜　番号 --------------------------------------------------------------------- 01　｜　AAA　　｜ 　101-5555　 ｜　0 03　｜　CCC　　｜　103-1000　 ｜　0 04　｜　DDD　　｜　104-1000　　｜　0 05　｜　EEE　　｜　105-1000　　 ｜　 0 06　｜　FFF　　｜ 　105-1000　　 ｜　0 07　｜　GGG　　｜　106-1000　　｜　0 08 　｜　HHH　　｜ 106-1000　　 ｜　0 09　｜　KKK　　｜ 106-1000　　 ｜　0 ↓出したい結果↓ ID 　｜　名前　｜　郵便番号　　　｜　分類　 ｜　番号 ------------------------------------------------------------------------------- 03　｜　田中　｜　103-1000　　｜　CCC 　 ｜　 0 04　｜　町田　｜　104-1000　　｜　DDD 　｜　 0 05　｜　木村　｜　105-1000　　｜　EEE　 ｜　 2 05　｜　木村　｜　105-1000　　｜　FFF　 ｜　 2 06　｜　中田　｜　106-1000　　｜　GGG　 ｜　 3 06　｜　中田　｜　106-1000　　｜　HHH　 ｜　 3 06　｜　中田　｜　106-1000　　｜　KKK　 ｜　 3 以上になります。 どうぞよろしくお願い致します。
SQLServer 2000 から SQLServer 2008 への移行する際に、デタッチ／アタッチまたはバックアップ／復元の移行方式を検討するにあたり、30GBのデータベースを移行するために生じるオフラインタイムを事前検証で計測するため30GBダミーデータベースを作りたいのですがT-SQLやその他での方法を教えてください。
SQL Server 2005(Enterprise Edition)をインストールする際に、 システム構成チェック時に、 "パフォーマンスモニタカウンタの要件"が満たないため、 インストールをすることができません。 この要件を満たすために、下記のサイトを参考にして 調整をしています。 ○SQL Server 2005 でセットアップ用にカウンタ レジストリ キーを増分させる方法 http://msdn.microsoft.com/ja-jp/library/ms143215 … ここで、わからない点があり、 [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Perflib] "Last Counter"=dword:00002618 (9752) "LastHelp"=dword:00002618 (9753) Last Counterは、"Perflib\009"の "Counter" キーの最大値と一致している必要があります。 とありますが、Counterを選択したときに、値のデータのどことLast Counterが一致しているのか がわからない状態です。同様に、Last Helpについても同様です。 お手数ですが、ご教授の程お願いいたします。
初めまして社内の登録データの抽出について困っております、ご助言をお願いいたします 環境：MSSQLServer2000 商品のマスターテーブルがありそこに登録されたカテゴリ別の最新型番を抽出する方法です 例） Table1 code | cate | updtime item1 | pc | 2009/10/13 item2 | pc | 2009/10/13 item3 | pc | 2009/10/15 itema | soft | 2009/10/10 itemb | soft | 2009/10/10 itemc | soft | 2009/10/10 itemA | supply | 2009/10/14 itemB | supply | 2009/10/15 itemC | supply | 2009/10/15 上記のようなデータの入った商品マスターテーブルから 下記のように各カテゴリで最も新しい登録商品をそれぞれ1件ずつ抽出したいのです item3 | pc | 2009/10/15 itemc | soft | 2009/10/10 itemC | supply | 2009/10/15 updtimeで[order by]をかけてみると新しい物順に抽出できますが、カテゴリがばらばらになってしまいます。 何か良い方法がありませんでしょうか。 よろしくお願いいたします。
データベースの文字コードとアプリケーションの文字コードが異なる場合、書き込み(INSERT)や取り出し(SELECT)はどのような扱いになるのでしょうか？ イメージ的にはデータベースがUTF-8の設定の場合に、アプリケーションがSJISを指定し読み取ったデータをINSERTする場合や、SELECTで取り出す場合に何が問題になるのかを知りたいです。 質問の意図はアプリケーションやデータベースを国際化を意識して作成したく、アプリケーションはVB.NETで、CSVのファイルをsjisを指定して読み込み、それを書き込む際にそのままInsertやSelectを指定して問題ないのか、そもそもCSVファイルにはUTF-8で書き込み、読み込みもUTF-8ですべきなのでしょうか？ ちなみにUTF-8がAsciiが1バイト、日本語が3バイトで扱われ、SJISの場合は、Asciiが1バイト、日本語が2バイトで扱われることは理解しています。
次のような操作がしたいのですが、 TestOya t1 t2 1 A 2 B TestKo1 k11 k12 k13 1 1 AA 1 2 BB 2 1 CC TestKo2 k21 k22 k23 1 3 AAA 1 4 BBB 1 5 CCC 2 2 DDD 取得したい結果 t1 t2 betumei1 betumei2 betumei3 1 A 1 1 AA 1 A 1 2 BB 1 A 1 3 AAA 1 A 1 4 BBB 1 A 1 5 CCC 2 B 2 1 CC 2 B 2 2 DDD betumei1には、k11またはk21 betumei2には、k12またはk22 betumei3には、k13またはk23 となるような結合がしたいのです。 アドバイスあれば宜しくお願いします。
VistaにSQLサーバー2005をインストールするにはどのようなステップを踏めばよろしいのでしょうか？ WinXPとはインストールするバージョンも異なるのでしょか？ SQLサーバー2005には付属するソフトもあるのでどれをインストールすればよいのかも教えてください。 色々なサイトを見てきましたが、よく理解ができてません。 素人ですみませんが教えてください。
SELECT文で区分ごとに番号、番号名を表示させたいのですが。 T_テーブルに区分が1から5まであるのですが、select文一発で表示したいです。 番号は1～5,番号2は5～6まで表示したいのです。 区分は２の情報を取得する 1テーブルの情報を番号ごとに分けて表示したいです （例） 番号　番号名　　　　　番号1 番号名2 1 iti 　　　　　 5 go 2 ni 　　　　　6 roku 3 san 　　　　　7 nana 4 yon 　　　　　8 hati T_テーブル情報　下記 区分varchar(2) 番号varchar(6) 番号名varchar(16) SELECT T_テーブル.区分, T_テーブル.番号, T_テーブル.番号名, T_テーブル_1.番号, T_テーブル_1.番号名 FROM T_テーブル AS T_M_名称_1 INNER JOIN T_テーブル ON T_テーブル_1.区分 = T_テーブル.区分WHERE T_テーブル.区分 = '2'
こんにちは。 SSISパッケージについて質問させていただけないでしょうか？ 現在SQL Server2005　Standard Editionを使用しています。 SQL Server Management Studioを使用しているクライアント側のPC、 DBサーバーとしているサーバー側PCどちらにも2005 Standardを入れています。 　Accessのmdbのテーブルをインポートしようとしており、インポートのみなら成功するのですが、SSISパッケージの保存を選択し、サーバー側のDBを指定したところ、「インターフェイスがサポートされていません」、SQL　Serverに保存できませんでした”と表示されます。 SSISパッケージの保存を行うには事前に保存するサーバー側に何か設定を行っておく必要があるのでしょうか？
SQLで累計を求めたいのですが、うまく作成できません。 T_テーブルの出荷数で指定した日付の月はじめから指定した日付まで対応したいのですが、うまく作成できません。 こんな感じ 日付>= 2009/01/01 and 日付 <=2009/01/30 ちなみに累計でLEFT JOINって使えますか？ 使えればそちらもお願いします。 下記は自分が参考にしたページです。 http://oraclesqlpuzzle.hp.infoseek.co.jp/10-7.html
次のような操作がしたいのですが・・・ Test1 t1 t2 1 A 2 B Test2 tt1 tt2 tt3 1 1 AA 1 2 BB 2 1 CC 結果 Test1とTest2を関係付けて(Test.t1=Test2.tt1のinnerjoin) Test2.tt3が少なくともAAである場合に Test1.t2をDにしたいのです。 アドバイスあれば、宜しくお願いします。
今はこのようなＳＱＬ文を書きたいですが・・ table1 user_id | time 1 | 122120 2 | 100530 table2 user_id | name 1 　| 佐藤 2　　 　| 田中 ＳＱＬ文　　　　　　 結果はこう user_id|name| time 001 |佐藤|　122120 002 |田中|　100530 に出力したいけど、初心者なので、方法が良くわかりません。 ご教授ください。
SQL Server 2005 Express Editionを使用しています。 物理的に１つのディスクで、ＣドライブとＤドライブがあり、 mdfもldfもＤドライブに配置していました。 完全復旧モデルで、毎日データベースを夜間バックアップし、 ログファイルは、その後Truncate_onlyして切捨てを行っていました。 上記状況でシステム稼動中にWindowsがフリーズ、 電源を強制的に落としたところ、セーフモードでも 起動できなくなった為、再インストールしました。 こういう状況ですので、残っている物は、 　・前日のフルバックアップ 　・稼働中だったmdfとldf のみという状況です。 できる限りデータを復旧しようとした場合、 フルバックアップからリストアし、その後、 残っていたldfからロールフォワードという虫のよいことは できるのでしょうか？ 良い方法があれば教えてください。
現在vb.net 2008 と SQL Server 2005を使ってアプリケーションを作成しています。 vbの方のソリューションエクスプローラーでデータベースを作成し、現在まで稼働させてきましたが、テーブル名の変更などができないなど不便な点が気になり、そろそろSQL Serverで管理したいと考えています。 そこでいろいろ試行錯誤してやってみたのですが、SQL Server側でアタッチしようとすると、ファイル(xxxxx.mdf)のパーミッションの関係で「アクセスが拒否されました」と出てしまいます。 そこでファイルのパーミッションをSQL Serverでもアクセスできるように変更したところ、その状態でアタッチもテーブル名の変更もできるのですが、今度はSQL Server側にパーミッションが変更されるようで、vbからアクセスできないようになってしまいました。 両者からアクセスできるようにするのはどうすればいいのでしょうか。 セキュリティの面もしっかりした状態で実現させたいと思っています。 現在の環境は以下の通りです。 SQL Server Express 2005 Visual Basic 2008 Professional (SQL Server 2005 Developmentも使えます） Windows Vista Ultimate (64bit) SQL Serverはwindows認証で使っていますが、不都合があればSQL Server認証に変更も可能です。
SQL Server 2008 Express with XXXXXXXX をインストールしようとすると、エラー "属性が一致していませんというメッセージでインストールできません。どうしたらいいのでしょうか?
環境：SQL Server 2005 バッチからSQL Server のメンテナンスプランを 実行して、DBのバックアップを指定のフォルダに格納するという 処理(プラン名：BackUpMaintenancePlan)なのですが、 「dtexec /Ser サーバー名 /U ユーザー名 /P パスワード /SQ "\Maintenance Plans\BackUpMaintenancePlan"」 と記載したバッチ処理をたたくと... ----------------------------------------------------------- 開始: 12:57:55 DTExec: パッケージの実行から返されました DTSER_SUCCESS (0)。 開始: 12:57:55 完了: 12:58:05 経過時間: 10.516 秒 ----------------------------------------------------------- コマンドプロンプトにこのように表示されますが バックアップファイルが生成されません。 SQL Serverのメンテナンスプランを直接実行すると正常に バックアップファイルは格納されているので バッチ処理の書き方に問題がありそうな気がします。 どなたかお分かりになる方がいらっしゃいましたら アドバイス等宜しくお願い致します。
1分ごとの時間がセットされている列があります。 ある時間から5分ごとの時間を全て取得したいと思います。 取得したいデータは1日の00:00から月末の23:55までです。 難しいのは、5分ごとのデータがない場合があり 無かった場合は1つ前のデータ(1分前でもなんでもいいから直近で1コ前) を取得するということです。 select DATEADD(n, 5, '2009/06/01 00:00:00') で5分後は分かるのですが1こしか取れないので どうしたらいいか困っています。
SQLServer2005で、 マージレプリケーションのテストを行っています。 サーバーが2台あります。 Serv1・・・パブリッシャ Serv2・・・サブスクライバ とします。(どちらも2005です) 困っていることは、 サブスクリプションの上で右クリックし、 「同期状態の表示」を開くと、 「サーバー'Serv2\インスタンス'はサブスクライバではありません。」 とのメッセージが表示されており、 「開始」ボタンを押しても、Serv1側で変更したデータは反映されず、 ログを見ると「Serv2\インスタンス　に接続できませんでした。」と残っています。 これを解消したいのですが、 どこから説明してよいのかわからないので、 最後に、設定手順を書いておきます。 -----設定手順----- SQLServer Management Studioを使って、 Serv1のローカルパブリケーションから、新規パブリケーションの作成ウィザードを実行し、パブリケーションを作成。 ここまでは、問題なく進みました。 次に、先ほど作成したパブリケーションの上で右クリックし、 サブスクリプションの新規作成ウィザードを開始しました。 サブスクライバの選択画面まで進み、 「SQLServer サブスクライバの追加」ボタンで、 [Serv2\インスタンス名]を追加しようとしましたが、認識できなかったので、 [IP\インスタンス名]と指定したら、 「レプリケーションでは、IPではなく実際のサーバー名を指定してください。」のようなメッセージがでたので、いったん中断しました。 hostsファイルに[Serv2]を追加してから、再度ウィザードを実行したら、 サブスクライバの画面から次に進めました。 マージエージェントセキュリティで 1つ目の選択肢で「SQLServerエージェント サービスのアカウントで実行する」 を選択し、 サブスクライバの接続では、 「次のSQLServerのログインを使用する」を選択し、ログインとパスワードを入力しました。 あとは、規定値で、完了しました。 このあと、2アクション(Serv2\インスタンスのサブスクリプションを作成しています、同期エージェントを開始しています)とも成功で終わります。
色々試したのですが、再現したりしなかったりで？？？状態です。 下記の状態は確認できたので質問したいと思います。 勤怠コードのクロス集計の為の実験をしています。 エクセル出力する形で実行しています。 必ず三つ目のｅｘｅｃ命令を通っています。・・・経路をテーブルに出力して確認済み 結果はT_日報の件数が出力されています。・・・これはOK しかし列名が「xx」になってしまいます。・・・NG(「A0」にしたい) フィールドに値が入っていません・・・NG --------------------------------------------------- BEGIN if 'B0'='B1' 　　begin 　　exec sp_executesql N'SELECT 勤怠コード AS xx FROM T_勤怠' 　　end if 'B0'='A0' 　　begin 　　exec sp_executesql N'SELECT 勤怠コード AS B0 FROM T_勤怠' 　　end else 　　begin 　　exec sp_executesql N'SELECT 勤怠コード AS A0 FROM T_日報' 　　end END ------------------------------------------------------ よろしくお願いします。
SQL Server 2008 です。 在庫管理DBを作ろうとしています。 複数のクライアントから一つのレコードに更新が発生した場合を考えています。 複数のクライアントから同一のストアド(在庫引落)を読んだ場合 呼ばれたストアドは同時に複数走るのでしょうか、一つずつ走るのでしょうか? こんな時(在庫引落)はストアドにパラメータを渡すよりも、一時テーブルに 書き込んで、トリガーで更新(引落)ってな事をした方がいいのでしょうか? その場合トリガーも同時に走るのでしょうか?一つづつでしょうか? 複数のクライアントから更新がかかり、直接レコードを更新出来ないような 場合はSQLではどう処理するのがメジャーなんでしょうか? オフコンでは仮想記憶って云うのがあって、そこに書き込むとバックグランドで ウェイティングしていたプログラムが一件ずつ読み込んで更新する仕組みでした。 更新が終わると、また読込みでウェイティングする仕組みです。 複数の端末から一つの仮想記憶に書きこみ、読込みはシーケンシャルで一件ずつですので、 在庫がマイナスになることは合っても、整合性が取れなくなることはありませんでした。 こんな仕組みでSQLに移行したいと考えています。
１店舗１テーブルのデータベースにしております。 全店の在庫を検索した時に、まとめてSELECTすると重いため、 TOP100などで、1～100,100～200などと分けたいです。 単テーブルでの分け方は何とか分かっていますが、 複数のテーブルをUNIONで結合した場合の分け方が分りません。 ■ 現状：全店の在庫を各店のテーブルより、取得しています。 SELECT dbo.A店TB.ID, dbo.A店TB.BRAND, dbo.A店TB.CODE, dbo.A店TB.STOCK, dbo.A店TB.STORE FROM dbo.A店TB" + " where dbo.A店TB.CODE like '%" + txbCode.Text + "%' AND" + " dbo.A店TB.BRAND like '%" + txbBrand.Text + "%' AND" + " dbo.A店TB.STOCK > 0" + " UNION " + "SELECT dbo.B店TB.ID, dbo.B店TB.BRAND, dbo.B店TB.CODE, dbo.B店TB.STOCK, dbo.B店TB.STORE FROM dbo.B店TB" + " where dbo.B店TB.CODE like '%" + txbCode.Text + "%' AND" + " dbo.B店TB.BRAND like '%" + txbBrand.Text + "%' AND" + " dbo.B店TB.STOCK > 0" + " UNION " + "SELECT dbo.C店TB.ID, dbo.C店TB.BRAND, dbo.C店TB.CODE, dbo.C店TB.STOCK, dbo.C店TB.STORE FROM dbo.C店TB" + " where dbo.C店TB.CODE like '%" + txbCode.Text + "%' AND" + " dbo.C店TB.BRAND like '%" + txbBrand.Text + "%' AND" + " dbo.C店TB.STOCK > 0" ■ 問題：１店舗、1万レコード(件)のデータがあり、実際には10店舗ほどからデータを取ってくるため、読み込みに時間がかかってしまいます。 ■ やりたいこと：最初の100件だけをSQLのSELECTで取得するクエリを書きたいです。別のプログラムで以下のように書きましたが、 これを上記のUNIONを使ったクエリでもやりたいと考えています。具体的なコードが思いつきません。お願いします。 SELECT TOP 100 BlogTB.TITLE,BlogTB.TEXT " + "FROM BlogTB WHERE ID NOT IN(SELECT TOP 200 ID FROM BlogTB ORDER BY ID DESC) ORDER BY ID DESC"
2008です。 有給休暇の使用日(複数)を文字列として、一つのフィールドに入れる 仕組みを作ろうとしています。 (4/1、6/20、6/21 8/30・・・・・てな感じです) 動的SQLでパラメータに値を代入する方法によって結果が変わってしまいます。 現象1 パラメータに代入(Set)するときに「'A0'」をセットすると正常に動きますが、 「(Select Max(コード) From テーブル Where コード='A0')」にすると パラメータの入力を求められます。 しかし後者をIf文の中で代入するとパラメータの入力は求められません(下記) if Select Max(コード) From テーブル Where コード='A0' = 'V0' 　　set @para = 'V0' else 　　begin 　　set @para = (Select Max(コード) From テーブル Where コード='A0') 　　end **********@paraを使う動的SQL*********** 現象2 上記のIf文でパラメータを代入後、動的SQLの直前に@paraの値を確認の為 テーブルに書き込む(Insert)と動的SQLの結果が無くなってしまいます。 動的SQLの後にも書込を入れてみましたが、同じ値が書き込まれています。 当然、直前の書込を無くせば正常に表示されます。 何とか動作するのですが納得できず、将来に禍根を残しそうな現象であり どうするべき(スルーするべき)か悶々としています。
WIN2000サーバにASPとSQLServerにてWEBシステムを構築しています。 ODBCにて接続を行っているのですが、度々下記のようなエラーが発生してしまいます。 [Microsoft][ODBC SQL Server Driver][TCP/IP Sockets]一般的なネットワーク エラーです。ネットワークのマニュアルを調べてください エラーは毎回出るというわけではなく、不定期に発生している状態です。MDACを最新版にしたり、ODBC設定を見直したりしたのですが、一向に改善しません。 もしなにか対策をご存知の方がいらっしゃいましたらご教授ねがいます。
現在、SQLServer2000を使用しているのですが、実行に時間の掛かるクエリを投げた際は、ログを残したいと考えています。 MySQLでのスロークエリと同様似、指定した時間以上掛かった場合ログを残すようなことをSQLServerで出来るのでしょうか。 もしご存知の方がいらっしゃいましたらお知恵を拝借したいです・・・。
＜環境＞サーバA= SQL-Server2000 サーバB= SQL-Server2005 ＜質問＞ ＡのＤＴＳを使ってインポートジョブを作成し、パッケージ 保存をしようとしたところ、誤って保存先をBにしてしまいました。 削除しようとＢのSSISを見てみましたが、パッケージはありません。 再度Ａで同じ作業を行うと、同名のパッケージが存在しますと 出るので、Ｂのどこかにあるはずです。 誤保存なので最終的には削除したいのですが、 どうすれば保存したパッケージが見れますか？
こんにちは、いつも参考にさせて頂いております。 SQL Server2008でDBを管理しているのですが、 あるインスタンスへSQL server認証ができません。 sysadmin権限をつけたら認証されたのですが、できるだけ権限は最小にとどめたいです。 そこで質問です。 SQL server認証に必要な最小のサーバー ロールとデータベースのロールは何でしょうか？ アドバイスやヒントなど、何かお気づきでしたら教えてください。 どうか、宜しくお願いいたします。 [現在の設定] サーバー ロール：public ユーザーマッピング： 何も設定していません。 設定しようとDBにチェックすると、ユーザーにログインユーザーと同じ名が入り、 既に存在しています、と怒られてしまいます。 ユーザー名に違う名前（例えばdbo）を設定しても同様に怒られました。 なので、ここの設定は何もしないのが正しいのかな？と思っていますが、 根拠はありません・・ [環境] SQL Server2008 Windows Server2008
下記のストアドについて教えて下さい。 --------------------------------------------------- ALTER PROCEDURE [dbo].[SP_test1] @日付_sp datetime AS BEGIN /*命令1*/ exec ('select * from T_日報 where 日付=''' + @日付_sp + '''') /*命令2*/ exec sp_executesql N'select * from T_日報 WHERE 日付=@sqls',N'@sqls datetime',@sqls=@日付; /*(命令1か2のどちらかはコメントにして実行)*/ END ----------------------------------------------- 1. 命令1と2の違い(意味や効率など)を教えて下さい。 2. 現在ACCESSのVBAからストアドを呼ぶとどちらも正常に結果を返しますが、 　　このストアドをフォームのレコードソースにして起動時に表示させようとすると、 　　命令2は正常に動作しますが、命令1はパラメータの入力画面が出てしまいます。 　　入力画面に値を入れれば結果は正常に帰ってきます。 　　パラメータ名はフォーム上のコントロール名と同一でありストアドの変更だけで 　　VBA側はなにも変更していない状態でそんな現象が起きています、そんな仕様なんでしょうか?
こんにちわ。 SQL Server Management Studioでユニーク制約を追加する方法を教えてください。 制約の追加で以下と入力しているのですが、”確認中にエラーが発生しました”になります。 UNIQUE(列名) よろしくお願いします。
以下のようなテーブルAがあったとして、 項目Cを抽出する際、キー項目Bが「2」の場合、nullですが、 これを「b」と表示するようにしたいです。 [テーブルA] キー項目B 項目C ------------ 1　　a 2　　null 3　　c 4　　d ---------------------------------------------- 項目Cのデータ型が数値の場合は、 SELECT CASE WHEN B IS NULL THEN 0 ELSE B END AS B FROM テーブルA で対応できるようですが、 文字列の場合は、同じような方法があるのでしょうか？ 何かご存じの方、お願い致します。
はじめまして、初投稿です。 初歩的な質問となるかもしれませんが、お答えください。 SQL Server Reporting Service 2008を使用しております。 表の中で率を計算し、出力する際に、 0で除算しましたとエラーが出てしまいます。 以下、設定内容です。 ■解決目標■ プレースホルダにて、率を出力したい(クエリ内では行わない) ■プレースホルダ　プロパティ■ =IIF(sum(Fields!案件数.Value)=0,0,sum(Fields!受注件数.Value)/sum(Fields!案件数.Value)) ■クエリ■ select isnull(SUM(orders),0) as '受注件数', isnull(SUM(loss),0) as '失注件数', isnull(SUM(orders),0)+isnull(SUM(loss),0) as '案件数' from ～ ■エラー文■ 警告1[rsRuntimeErrorInExpression] textrun '受注率.Paragraphs[0].TextRuns[0]' の Value 式にエラーが含まれています。0 で除算しようとしました。 できましたら、早急なご回答をお願いいたします。
Vista UltimateにSQL Server 2008のフリー版をインストールしてみましたが、他のパソコンからですと、サーバが認識されずアクセスでません。インストールしたパソコン自身では、データベースの参照とアクセスができました。ネットワークの設定やServerの設定で自分で分かる限りいろいろ変えてみましたが無理でした。 windowファイアーウォールやウィルス対策ソフトのファイアーウォールなども解除済みです。ネットワークの設定はWorkGroupで行っているのですが、どのような設定をネットワークやSQL Server 2008の設定を行ったらよいのか、どなたかご教授いただければ大変助かります。 お忙しいところ申し訳ありませんが、どうぞよろしくお願いいたします。 補足情報ですが他のパソコンにインストールしたSQL Server2005は、このパソコンからアクセスできました
WindowsServer2003で運用していたSQLServer2000を違うパソコンに移行したのですが、 外部接続（同ネットワークからの接続）ができなくなってしまいました。 外部接続を行うには SQLServer2000を設定するのでしょうか？ それともWindowsServer2003の設定なのでしょうか？ 特に特別な設定はしておりません。
コマンドの実行端末にDBがある場合は成功するのですが、 サーバーが別の端末の場合ファイルが見つからないようです。 データファイルの書き方を変える必要があるのでしょうか？ SQLServerは2008です。 SQLCMD -S"SRV\XXXXXX" -U"user" -P"pass" -d"DB1" -Q"INSERT INTO [テーブル名] SELECT CONVERT(datetime,年月),データ1,データ2,データ3,データ4 FROM OPENROWSET(BULK 'D:\test\bcptest\test.csv', FORMATFILE='D:\test\bcptest\test.fmt',FIRSTROW = 2) x"
SQLServer2005を使用しています。 テーブルのデータをCSVファイルでエクスポートしたいのですが ネットで調べてもどうもうまくいかないので質問させてください。 サーバー名：PCSQL、ユーザ名：User、パスワード：PASS として以下のようなプログラムを実行したのですが、 -------------------------- EXEC master..xp_cmdshell 'bcp "select * from データベース名.dbo.テーブルA" queryout c:\log.csv -c -t"," -r"\n" -SPCSQL -UUser -PPASS' -------------------------- 以下のような結果が出てくるだけでCSVファイルが作成されません。 使用法: bcp {dbtable | query} {in | out | queryout | format} datafile [-m 最大エラー数] [-f フォーマット ファイル] [-e エラー ファイル] [-F 先頭行] [-L 最終行] [-b バッチ サイズ] [-n ネイティブ型] [-c 文字型] [-w UNICODE 文字型] [-N text 以外のネイティブ型を保持] [-V ファイル フォーマットのバージョン] [-q 引用符で囲まれた識別子] [-C コード ページ指定子] [-t フィールド ターミネータ] [-r 行ターミネータ] [-i 入力ファイル] [-o 出力ファイル] [-a パケット サイズ] [-S サーバー名] [-U ユーザー名] [-P パスワード] [-T 信頼関係接続] [-v バージョン] [-R 地域別設定有効] [-k NULL 値を保持] [-E ID 値を保持] [-h "読み込みヒント"] [-x XML フォーマット ファイルを生成] NULL そもそもSQLにはWindows認証でログインしているので ユーザーIDとかいらないのでしょうか？(ユーザーID,PASSを抜いても同じ結果となってしまいますが・） SQL初心者で申し訳ないのですがご教授宜しくお願いします。
　SQL Server 2005を主に使っております。 　プログラムが発行するSQLを確認するためにプロファイラを 利用してトレースをとる作業を行ったりしますが、開始するまでの 設定画面の操作が面倒です。 　ある程度デフォルト設定のままでもトレースを開始できますが、 ClientProcessIDでフィルタしたりすることが多いので、スクリプト等で 書くことができるとうれしいです。 　またトレースの出力先がデータベースのテーブルであることが 多いのでそのあたりも指定したいと考えています。 　このようなことは可能でしょうか？
大量データをSQL2005に投入した際、PK違反がありました。 どのカラムでその状態になっているかを調べる事は可能でしょうか？ 主キー設定をしないで投入したら問題なくできました。 お手数ですが、教えてもらえればと思います。
WinXP、MS SQL 2005 Standard で、データベースをRestoreしようとしたら、次のようなエラーが出ました。 （サーバー名はxxxx、復元先のDB名はzzzz-zzzzとしています。） 対応方法、ご存知の方いらっしゃいましたら、ご教授願います。 TITLE: Microsoft SQL Server Management Studio ------------------------------ 復元 failed for Server 'xxxx'. (Microsoft.SqlServer.Smo) For help, click: http://go.microsoft.com/fwlink?ProdName=Microsof …復元+Server&LinkId=20476 ------------------------------ ADDITIONAL INFORMATION: System.Data.SqlClient.SqlError: The backup set holds a backup of a database other than the existing 'zzzz-zzzz' database. (Microsoft.SqlServer.Smo) For help, click: http://go.microsoft.com/fwlink?ProdName=Microsof …
お世話になります。 SQL Sever 2005にて、メンテナンスプランの作成ができないのですが そもそも、SQL Server Management Studio Expressの オブジェクトエクスプローラに「管理」→「メンテナンス　プラン」 のフォルダが表示されているのですが、右クリックすると 「最新の状態に更新」しか表示されません。 ログインは、sysadmin権限のユーザーで入っています。 そのため、メンテナンスプランが作成できません。 (1)表示されない原因は何が関係あるでしょうか。 (2)上記方法以外で、メンテナンスプランを作成する手立ては 　ありますでしょうか。 よろしくお願いいたします。
[親テーブル] (カラム)A* [子テーブル] (カラム)a* A(fk) [孫テーブル] (カラム)aaa* ymd 決済額 a(fk) [join] 親.A = 子.A 子.a = 孫.a 親・子は1対n 子・孫も1対n 1対n対n(?)という関係のテーブルを作成しました。 SQL文で会社に紐づく店を表示させ、且つ、孫も表示させて 下記のように表示させる事は可能でしょうか。 親 　　子 　孫　　　 A　　　a　　aaa　　ymd　　決済額 →(カラム) 1　　　1　　1 3月　　2,000　 →(値) 1　　　1　　2 4月　　1,000 1　　　1　　3 5月　　1,500 1 　2　　1 4月　　1,500 2 　1 　1 3月　　2,000 3 　1 　1 3月　　1,000 3 　2 　1 4月　　3,000
DBのテーブルの列数は258です。 インサートするデータファイルの列数は65です。 データファイルは","で区切られたファイルです。 SQL Serverは２００５です。 コマンドを下記のように書きました。 SQLCMD -S"\SQLEXPRESS" -U"user" -P"pass" -d"計測" -Q"INSERT INTO [計測データ] SELECT 4,CONVERT(datetime,年月),データ1,データ2,データ3,データ4,データ5,・・・データ256 FROM OPENROWSET(BULK 'D:\200906.csv', FORMATFILE='D:\test.fmt',FIRSTROW = 2) x" フォーマットファイルは、 8.0 68 1SQLCHAR01""0 Firsrt_QUOTE "" 2SQLCHAR020"\","1年月 "" 3SQLCHAR010","2データ1 "" 4SQLCHAR010","3データ2 "" 5SQLCHAR010","4データ3 "" ・・・ 66SQLCHAR010"\r\n"65データ64 "" しかしエラーになってしまいます。 そもそも列数が違うと無理なのでしょうか。
MSDEを使用しています。 ジョブで、DTSを定期的に実行しています。 このジョブを、EXEC sp_job_start @job_name ='JOBNAME' で実行させたいのですが下記方法が分からなくて大変困っています。 (1)JOBが起動中だったら実行したくない (2)JOBの実行終了を待って、他のJOBを起動したい コマンドは、Access(adp)を使用して実行したいです。 ヒント等いただけるととても助かります。
sqlserver と vb.net（+バッチファイル） にてコーディングしています。 vbからバッチファイルを呼び出し、その中でDBのデタッチを行っているのですが、 「データベース '（DB名）' は現在使用中なので、デタッチできません。」 とのメッセージが出て、デタッチできません。 デタッチは、vbプログラムの中で SqlConnection を close・dispose した直後に行っています。 原因追究をしたいのですが、どのプログラムがどのDBを使用しているか 、という情報を取得することはできるでしょうか。 ご回答よろしくお願いします。
SELECT文の作成で行き詰ってしまって困っています。 タイトルのニュアンスが適当じゃないのですが、 MasterUserとTableParentの2つのテーブルがあり MasterUser |user_no|use_name| | 0 |山田太郎| | 1 |山田次朗| TableParent |rec_no|father|son| | 0 | 0 | 1 | TableParent.rec_no:ユニークな数字 TableParent.father:=MasterUser.user_no TableParent.son :=MasterUser.user_no という条件で |rec_no| father | son | | 0 |山田太郎|山田次朗| のような結果を1回で取得するSELECT文は作成可能でしょうか？ 自分でやってみた感じ出来ない感じがしました。 正規化を学び始めたばかりなので、テーブルの作成から違う可能性も ありそうなんですが、何か参考になりそうなサイトがあったら 教えて頂けると嬉しいです。 よろしくおねがいします
Visual Studio 2008 にて、ASP.NET開発を行いたいと考えています 利用するデータベースは、SQL Server2000(Windows 2003 Server)になる予定です。 SQL Server2000は古いＤＢということで、VS2008と組み合わせたとき、どんな問題があるのか気になっています。 ・最新版のSQL Serverの便利な機能が使えない ・もうすぐ延長サポートが終了する という以外に、どんな不都合が考えられるでしょうか？ 以上、どうぞよろしくお願い致します。
たとえば、 SELECT 果物名 FROM 果物種類 WHERE 色 = '赤' OR 値段 < 100 というようなSQL文を書いたとして、 「ORDER BY」　として　”値段 < 100”を先に、 ”色 = '赤' ”を後に　というような指定はできますか？
SQLServer2005のデータベースファイルを複数で管理しているのですが その複数のファイルがそれぞれ別のファイルグループに割り当てられていて一つに出来ないで困っております。 ファイルグループがバラバラのデータベースファイルを一つにまとめることは可能でしょうか。
SQLserver2008 へ ACCESS2003のADPからWindows認証で接続すると 「ログインできません、このログインは信頼されていないドメインからの ログインなので、Windows認証では使用できません。」と云うエラーがでます。 50台ほどあるクライアントの内一台だけで発生しています。 (ちなみにその一台だけMacで起動時にWindowsを選択して起動しています)
既に再起動しているにも関わらず、「コンピュータの再起動」のところで失敗してしまいます。 原因が分かる方いましたらアドバイスください。
SQL Server2005 Express Edition を使っています。 異なるDB間（同じコンピュータ内）で、テーブルをコピーしたいの ですが・・・ コピー元DB名：DB_A コピー元テーブル名：dbo.顧客 コピー先DB名：DB_B テーブルのコピーは　select * into　・・・ from　・・・　を使えばできそうですが、別DBの場合の方法がわかりません。 お教えいただければ幸いです。 よろしくお願いいたします。
Access の MDB 形式のデータファイルを SQL Server の MDF 形式のデータファイルに変換すべく、Management studioをインストールしました。 しかし、タスクから選べるはずの「データのインポート」がありません。 もしインストールする必要のあるServicePack等があれば教えてください。
SQL Server初心者です。 下記のことが可能かどうか教えてください。 現在、社内ASP Webシステムが10個くらいあります。 バックエンドデータベースとしてAccessを使用していますが、ファイルサイズが数十メガになってしまったものもあり、これらをすべてSQL Serverに移行しようと考えています。 Accessでは、複数のデータベースで共有したいテーブルがある場合、リンクテーブルとして共有できるため、これらのWebシステムでも社員情報テーブルをすべてリンクテーブルで共有しておりました。 SQL Serverに移行した場合、Accessのようにテーブルを共有することはできるのでしょうか？ ご教授のほどよろしくお願いします。 バージョン： SQL Server 2000
０３－１１１１－１１１１　パン ０３－１１１１－１１１１　ライス ０３－１１１２－１１１１　パン このようなデータがあった場合、重複のある０３－１１１１－１１１１に関するデータは無視して ０３－１１１２－１１１１のパンだけをもってきたいのですが、 どのようにすればよいのでしょうか？ DISTINCTだと、片方は持ってきてしまうので、それではなく、 ０３－１１１１－１１１１をすべて無視したいのです。 よろしくお願いします。
データ型の違う日付フィールドを比較した場合同じ日付でもマッチングしないのでしょうか? SQL 2008 　　smalldatetime → 1990/1/1 起点 　　datetime → 1753/1/1 起点 　　date → 1/1/1起点 ACCESS 2003 　　date → 100/1/1 起点 それぞれ日付を整数に変換して保持していると考えています。 ACCESSのdate型の項目に日付を代入してSQLを検索すると同じ日付なのに 　　SQLのフィールドの型がdatetime型だとマッチするのですが、 　　date型だとマッチしないんです、どうしてでしょうか?
どうしても自分で解決できなかったので、教えてください。 ２つのテーブル（AとB）から結果（☆）を取り出したいです。 テーブルレイアウトと値は下記の通りです。 テーブルA（A_NO　DAT_NOが主キー） A_NO　DAT_NO　B_NO　C_NO　D_NO 0001 1 100 1000 Null 0001 2 Null Null A001 0001 3 200 2000 Null 0001 4 200 2000 A002 0001 5 300 3000 A003 テーブルB（B_NO　C_NOが主キー） B_NO　C_NO　D_NO LEN DIV 100 1000 A001 10 01 100 1000 A002 10 01 100 1000 A003 Null Null 100 1000 Null Null Null 200 2000 A002 Null Null 200 2000 Null Null Null 300 1000 A001 30 03 300 3000 Null Null Null 下記のような結果が欲しいです。 結果（☆） A_NO　DAT_NO　B_NO　C_NO　D_NO LEN DIV 0001 1 100 1000 Null 10 01 0001 2 Null Null A001 Null Null 0001 3 200 2000 Null Null Null 0001 4 200 2000 A002 Null Null 0001 5 300 3000 A003 30 03 元々はテーブルAとテーブルBを、テーブルAのB_NOとC_NOとテーブルBのB_NOとC_NOを条件に結合（LEFTJOIN）していました。 しかしテーブルAのB_NOとC_NOがNULLの場合でも、データ抽出する為に上記の方法では駄目でした。 どのようにすれば思い通りの結果を取得できますか？ とても困っていますので、よろしくお願いいたします。
お世話になっております。SQLSERVER初心者です。 NULLを含む列COL1を検索条件に入れる場合、 パフォーマンスの観点から WHERE COL1 IS NULL とするのではなく WHERE ISNULL(COL1,'') = '' とするよう有識者から言われました。 そこで質問なのですが、 (1)IS NULL は基本的に上記のように変換したほうが早くなるのですか？ (2)COL1にもしインデックスが設定されていたとしても、上記の場合だとどちらも効かないですよね？ 詳しい方おしえてください。 よろしくおねがいします。
はじめまして。 皆さんにお知恵をお借りしたいことがありましたので投稿させていただきました。 まず、環境はWindowsVistaSP2（32bit版）で、使用しているDBはSQLServer2005です。今回の質問の内容は、このSQLServer2005がサービスの自動起動になっているにもかかわらず起動もせず、さらに手動でサービスの起動を試みても途中で失敗してしまい、私では手がおえない状態になってしまっています。 コマンドプロンプトでC:\Program Files\Microsoft SQL Server\MSSQL.2\MSSQL\Binn内の「sqlservr.exe」を実行しても沢山のエラーを吐くだけで、やはり起動はできません。SQLServerのプロパティの「次のアカウントでログイン」の項目は、「ビルトインアカウント」で「ネットワーク サービス」を指定しています。 実際に「sqlservr.exe」コマンドを打った場合のエラー内容は下記の通りです。何か複合的にエラーが起きているようには感じるのですが、実際どこをどう設定しなおせばいいのかわかりません。 なお、SQLEXPRESSはWindows起動と同時に自動的に開始します。 2009-08-06 13:07:47.50 Server Error: 17058, Severity: 16, State: 1. 2009-08-06 13:07:47.50 Server initerrlog: Could not open error log file 'C: \Program Files\Microsoft SQL Server\MSSQL.2\MSSQL\LOG\ERRORLOG'. Operating syste m error = 5(アクセスが拒否されました。). 2009-08-06 13:07:47.80 Server Error: 17058, Severity: 16, State: 1. 2009-08-06 13:07:47.80 Server initerrlog: Could not open error log file 'C: \Program Files\Microsoft SQL Server\MSSQL.2\MSSQL\LOG\ERRORLOG'. Operating syste m error = 5(アクセスが拒否されました。). 2009-08-06 13:07:48.10 Server Error: 17058, Severity: 16, State: 1. 2009-08-06 13:07:48.10 Server initerrlog: Could not open error log file 'C: \Program Files\Microsoft SQL Server\MSSQL.2\MSSQL\LOG\ERRORLOG'. Operating syste m error = 5(アクセスが拒否されました。). 2009-08-06 13:07:48.40 Server Error: 17058, Severity: 16, State: 1. 2009-08-06 13:07:48.40 Server initerrlog: Could not open error log file 'C: \Program Files\Microsoft SQL Server\MSSQL.2\MSSQL\LOG\ERRORLOG'. Operating syste m error = 5(アクセスが拒否されました。). 以上です。文字数制限に引っかかってしまったため、これ以降のエラー内容は書けませんでしたが、大体同じようなエラーが連なっています。長くなってしまいましたが、実際のエラー内容を確実にお伝えするために書かせていただきました。よろしくお願いいたします。
いつもお世話になっております。 今度、サーバの移動がありネットワーク回りも 一新することになりました。 現在サーバのネットワーク環境は、WORKGROUPですが 今度、ドメイン環境に参加する予定になっております。 そこで、質問は３点です。 ・ドメインに参加することによるSQLServerへの 　影響があるかどうか？ ・もし、影響があった場合はどのように対応したらよいか？ ・その他気をつける事柄があるか。 環境は以下の通り。 OS：2003Server SP1 SQL:SQLServer2005 お忙しいとは存じますが よろしくご教示願います。
データベースの勉強をしようと思い立ち、日経ソフトウェアの本を購入。 付属DVD-ROMをセットして、「さぁ、SQL Server入れるぞぉ！」　とはりきったのはいいのですが、インストールでつまづきました。　 SQL Serverを扱った経験のあるかたや、データベースに詳しい方、そのほか「こういうことじゃないか？」と何か頭に浮かんだ方、どうかご教示ください。 ちなみにOSはXP Home Editionです。 つまづいたのは『サービスアカウントの設定』なのです。 （『SQL Serverインストールセンター』の画面） 『インストール』の項目から『SQL Serverの新規スタンドアロンインストール...』をクリック 　　　↓ （『SQL Server 2008セットアップ』の画面） 『無償エディションの指定』から『Express with Advanced Services』を選択。 　　　↓ 　　（中略） 『機能の選択』ではすべての機能を選択してつぎへ。 　　　↓ 　　（中略） 『サーバーの構成』でサービスアカウントの設定をきかれる。 ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ ここがよくわからないのです。　このアカウントって何なんでしょう？　Windowsでアクセスしてるアカウントですか？　 それと、アカウントと同時にパスワードもきかれるのですが、このパスワードって、何なんでしょう？　このときに、サービスアカウント設定時に決めるものですか？　 ここに何をどう入力したらいいのかサッパリわからず、煮詰まっています。　ちなみにアカウントは「User」、パスワードは・・・（もし前に自分が何か設定をしていたとしたらコレだろう）というものをいくつか試してみたのですが、はじかれました。 その際に出たエラーメッセージは・・・アメリカで購入したPCを使っているので英語です。　2つ出てきます。 (1)　要するに「このアカウント＆パスワードは無効です。正しいのを入力してね。」ってことでしょうか・・・？ "The specified credentials for the SQL Server service are not valid. To continue, provide a valid account and password for the SQL Server service."　 (2)　『Reporting Services service』ってのが何かよくわからないのですが・・・骨子は(1)と同じことでしょう。 "The credentials you provided for the Reporting Services service are invalid. To continue, provide a valid account and password for the Reporting Services service." ここから先に進めないでいます。　検索をかけてみてもお目当ての情報は見つからず。　本にもアカウント設定のことは３、4行でサラッとしか書いてない。　正直もうどうしたらいいかわかりません。 本格的なデータベースを作るわけではありません、本に書いてあるSQLコマンドを打ち込むための練習台がほしいだけです。　なのであまり高等でなくてOK、入門書のサンプルコードが動くものをサッサとインストールしてとりあえず遊んでみたいのです。　まさかこんなところでドン詰まるとは・・・。　解決法をご存知のかたはぜひ回答お願いします！
SQL serverで改行コードを登録したいんですけれども登録されません。 どうしたらいいでしょうか？教えて下さいお願いします。
一般的なC言語のソケット通信関数のみを使用して、SQL Serverに接続する方法を探しています。 今回使用するハードウェアは、Windows PCではなく、Ethernetの付いた小型の組み込み用CPUボード(CPUはARM7)なので、ODBCなど立派なデータベースサポート環境など全くありません。 この為、C言語を使ってソケット通信にて自力でSQLサーバーに接続しなければなりません。 しかし、私はC言語でのソケット通信プログラム作成能力はあっても、SQLサーバとのやり取りにつきましては、何一つ分からない状態です。 ネットでいろいろと検索しましても、1433ポートを使用するなど極めて断片的な情報は得られた物の、具体的に何をするのかが分かりませんでした。 そこで、Socket通信関数群だけを使用してSQLサーバーにアクセスする方法についてご存じの事がございましたら、是非ともご教示頂けませんでしょうか。 情報が書かれているWEBページとか、あるいは書物とか、あるいは具体的なソースコードなどなど．．． 何でも構いませんので、宜しくお願い致します。 ※具体的にどの様なSQL Serverを使用するのかは、現在客先にて調整中でまだ分かりません。　 各種SQLサーバーに共通的な方法が存在するのでしょうか？　それとも、SQLサーバーによって全て方法が異なるのでしょうか？
SQLサーバーのオブジェクトエクスプローラの「切断」とデタッチは違うのですか？ 切断をすれば全てのデータベースがデタッチされるわけではないのでしょうか？
public static DataSet GetCustomers() { string sql = @"SELECT * FROM M_CHARGE"; SqlConnection conn = new　SqlConnection(DBConfiguration.DbConnectionString); SqlDataAdapter da = new SqlDataAdapter(sql, DBConfiguration.DbConnectionString); da.SelectCommand = new SqlCommand(sql, conn); DataSet ds = new DataSet(); ds.Tables.Add("M_CHARGE"); da.Fill(ds, "M_CHARGE"); return ds; } da.Fill(ds, "M_CHARGE");の部分でインスタンスエラーになります。どうしてでしょうか？ 誰か教えて下さいお願いします(TдT)
接続のタイムアウトとトランザクションタイムアウト以外に タイムアウトってありますか？ 教えてください。 よろしくお願い致します。
こんにちは。 SQL文について質問させていただきます。 SQL Serverで、2テーブルの、2つのフィールドを結合して、結果を出力したいと考えています。 以下条件の場合、どのように命令を記述すればよいのでしょうか？ 宜しくお願いします。 テーブル名：SOFT キー：SOFTID、VER 役目：ソフトウェアのマスタです。 テーブル構成：以下 SOFTID　VER　SOFTNAME A　　　　　10　　ASOFT A　　　　　9　　 ASOFT B　　　　　3　　 BSOFT C　　　　　5　　 CSOFT C　　　　　4　　 CSOFT テーブル名：PC キー：PCID、SOFTID、VER 役目：PCにインストールしたソフト情報です。 テーブル構成：以下 PCID　SOFTID　VER 1　　　　A　　　10　 1　　　　B　　　3 2　　　　C　　　5 2　　　　C　　　4 3　　　　B　　　3 結果 結合キー：SFOTID、VER 役目：PCテーブルを元にし、インストールしたソフトのバージョン、名前を表示します。 PCID　SOFTID　VER　SOFTNAME 1　　　　A　　　10　　ASOFT 1　　　　B　　　3　　 BSOFT 2　　　　C　　　5　　 CSOFT 2　　　　C　　　4　　 CSOFT 3　　　　B　　　3　　 BSOFT
SQLServer2008 ですが、日付のフィールドにこれまで使っていたDatetime型をDate型にしてみました。 連結Formでの画面表示が「2009/07/27」→「2009-07-27」に変わりました。 テーブルの表示時も同様に「-」になりました。 　　Dim wk_date date 　　if SQL_date = wk_date then 　　・・・ 上記のAccessVABのIF文で・・・ 実際には同じ日付なのにマッチしなくなってしまいました。 Format関数で「yyyy-mm-dd」へ変換すればマッチします。 上記のwk_dateをSQLのフィールドに代入し書き込むとエラーにならず 「yyyy-mm-dd」の形へ変換されています。 質問 (1) 「-」でなく今まで通りの「/」にする事は出来ないでしょうか? (2) 比較時は変換するしかないのでしょうか? 　　(代入時は自動的に変換できているのに比較時も自動でやってくれても良さそうなんですが・・・)
sql server 2008 enterprise evaluationをVirtualPC(2008Server)にインストールしました。 特に問題もなくインストールが完了したのですが sqlcmdで-E -Sで接続しようとするとエラーをはきます。 ただ、sqlcmdのみだとログインは可能でした。 ・-E -S sqlcmd -E -S localhost\MSSQLSERVER ⇒HResult 0x57、レベル 16、状態 1 SQL Server ネットワーク インターフェイス: 接続文字列が有効ではありません [87]. Sqlcmd: エラー: Microsoft SQL Server Native Client 10.0: SQL Server への接続の確 立中に、ネットワーク関連のエラーまたはインスタンス固有のエラーが発生しました。サ ーバーが見つからないか、アクセスできません。インスタンス名が正しいことと、SQL Se rver がリモート接続を許可するように構成されていることを確認してください。詳細に ついては、SQL Server オンライン ブックを参照してください。。 Sqlcmd: エラー: Microsoft SQL Server Native Client 10.0: ログイン タイムアウトが 時間切れになりました。 ・インスタンス名変えて sqlcmd -E -S localhost\MSAS10.MSSQLSERVER ⇒HResult 0xFFFFFFFF、レベル 16、状態 1 SQL Server ネットワーク インターフェイス: 指定された Server/Instance の位置を特 定しているときにエラーが発生しました [xFFFFFFFF]. Sqlcmd: エラー: Microsoft SQL Server Native Client 10.0: SQL Server への接続の確 立中に、ネットワーク関連のエラーまたはインスタンス固有のエラーが発生しました。サ ーバーが見つからないか、アクセスできません。インスタンス名が正しいことと、SQL Se rver がリモート接続を許可するように構成されていることを確認してください。詳細に ついては、SQL Server オンライン ブックを参照してください。。 Sqlcmd: エラー: Microsoft SQL Server Native Client 10.0: ログイン タイムアウトが 時間切れになりました。 ・sqlcmd 1> SQL Broserのサービスは自動にしており、 IPアドレスの、「有効」「アクティブ」も全て「はい」にしております。 ただ、SQLBrowserのインスタンスIDが「MSAS10.MSSQLSERVER」と なっていましたので上のように指定してもだめでした。 インストール時のIDは「MSSQLSERVER」でした。 sqlcmdのみでログインすればそれまでなのですが、 どうしても-E -Sでログインする必要があるのです。 どなたか解決方法をお分かりの方がいらっしゃいましたら ご教授お願いします。
SQLServerの開発支援ツールでお勧めのものがありましたらおしえてください 私が調べたところではCSE（Common SQL Environment）とか SI Object Browser for SQLServerとかが検索に引っ掛かりました。 現在は無料の開発支援ソフトを探しています。
スタート→全てのプログラム→Microsoft SQL Server 2005→ の次にあった「SQL Server Management Studio Express」が消えました。 多分、間違って削除してしまったと思います。 どうすれば復活することができますか？ スタートアップのMicrosoft SQL Server 2005の中には「構成ツール」しかありません。 「プログラムと機能」を見る限り、アンインストールをしてはいないので どっかにあると思います。 どうすれば元通りにすることができるのでしょうか？ よろしくお願いします。
Ｂ－ＰＣからＡ－ＰＣのＳＱＬサーバーに接続すること「リモート接続」と言いますか？
SQLの本には画面の様にホスト名をＩＰアドレスにしても接続できると書いてあったので試してみたのですが、いざやってみると下記のエラーがでます。 ************************************************* SQL Server への接続を確立しているときにネットワーク関連またはインスタンス固有のエラーが発生しました。サーバーが見つからないかアクセスできません。インスタンス名が正しいこと、および SQL Server がリモート接続を許可するように構成されていることを確認してください。 (provider: 名前付きパイプ プロバイダ, error: 40 - SQL Server への接続を開けませんでした) (Microsoft SQL Server, Error: 5) ************************************************* IPアドレスはプライベートIPアドレスで、固定にしています。 やはりIPアドレスでの接続は、無理なのでしょうか？ ご教授よろしくお願い致します。
こんばんわ。 プログラマー２年目のものです。 近頃、仕事をする中で自分のスキルの不十分さをひしひしと感じております。 学生時代は文系でしたので、このような勉強を始めて実質１年です。 ＳＱＬの知識は本当に基本中の基本がわかっているという程度です。 本日本屋でパラパラと本を見てきて 「独習SQL 第2版 黒石 博明 長谷川 裕行 」 を購入したのですが、ちょっと物足りない感じがあります。 今、仕事でチューニングに関する勉強をしているのですが、 全くついていけず、独自に勉強しようと思った次第です。 ○ＳＱＬの基本事項はわかっているが、実践面では経験がほとんどないため、実践的な勉強ができる ○長く複雑なＳＱＬ文にも対応できるようになりたい ○チューニングに関する勉強がしたい（全く知識がないため基礎から勉強したい） こんな私に当てはまる本がありましたら教えていただきたいです。 わかりづらくてすみません。 以上、お願いいたします。
お世話になります。 WEBの登録フォームより日々の更新情報を登録し、更新情報を表示するということをやっております。 データベースの【日付型】のデータで 例）2009/07/12　とあるのですが、 7月の情報や12日の情報を取り出したいのですが可能でしょうか？ ご教授下さい。 一覧や並べ替えなどはできるのですが、、、 SQL文は以下のように書いております。 strSQL = "select * From テーブル名 Where 項目=" & ID & " ORDER BY IN_DATA DESC"
いまさらですが、SQL2000で環境を構築しようとしています。 MSDEを使おうとしていたのですが、MSDEだとEnterPriseManagerが付いてこないですよね・・・？ コマンドラインではなく、EnterPriseManagerで管理したいのですが、 やはりMSDEでEnterPriseManagerは無理なのでしょうか？
ＤＢの復元をしようとしているのですが、 復元中のメッセージ表示後、インジケータが全く動かなくて、 1時間たったところでキャンセルしました。 その間、タスクマネージャーを見てみましたが、 ＣＰＵは１％、メモリも３００ＭＢ程で、 何もしていないで止まっている感じです。 なぜそうなってしまうのでしょうか？ 回答宜しくお願いします。
[main]![No]と言う風に「！」を使ったSQL文を実行すると 「'!' 付近に不適切な構文があります。」 のメッセージが表示されます。 アクセスでは問題なく行くのですが。 SQLサーバー　→　[main.No] アクセス→　[main]![No]、or　[main.No] という決まりがあるのですか？
どうでもいいことですが SQLの拡張子のmdfの意味が知りたいのですが ｍ→マイクロソフト d→データベース ｆ→？ Ｆの部分が思いつきません。 何だと思いますか？
Pc-1のローカルのSQLサーバーに置いてあるデータベースに Pc-2から接続することは可能ですか？（この2台はLANで接続されています） もし可能な場合、Pc-2にもSQLサーバーをインストールしなくてはダメですか？ よろしくお願いします。
ＳＱＬＳｅｒｖｅｒ２００５の最大列数を調べていたのですが、 ・幅の狭いテーブルごとの列数：１０２４ ・幅の広いテーブルごとの列数：３００００ と、２つの記述がありました。「幅の広い／狭い」と非常に曖昧な表現に思えてわかり難いのですが、どういう違いがあるのでしょうか？
SQL Server 2008メンテナンスプランについての質問です。 現在SQL Server 2008 Workgroup Editionを使用しています。 メンテナンスプランでデータベースの整合性確認、インデックスの再構成、バックアップ等を行い完了したら戻り値を取得して 別の処理を行いたいのですが作成したメンテナンスプランをバッチ等で実行することは出来ないでしょうか SP1を適用してメンテナンスプラン自体は使用できるようにはなりました。
sqlビギナーです。 TABLE1には列Ａ,Bがあり下記のようなレコードが入っています。 TABLE1 ---------------------- A | B ---------------------- MTB-L1-1 | 10 MTB-L1-2 | 15 MTB-L1a-1 | 20 MTB-L2-1 | 30 HENSU='MTB-L'の情報があり このHENSUを使って、MTB-L1-1,MTB-L1-2 のみ注出したいのですが どのようなSQLにすればいいでしょうか。 "SELECT * FROM TABLE1 WHERE (((Left(A,6))='" & HENSU & "')); だとL1aも選んでしまいます。 環境 Windows XP MS Sql Server 開発 VB6
現在MSDEをデータベースにAccess2000(ADP)にて開発をしています。 開発環境では接続できますが、クライアント環境にファイルを持って行ったら接続テストが通りませんでした。 混合認証モードにし、接続設定にSQLServer認証のID,PASSを保存 サーバー側のユーザー(Admin)グループに対象ユーザーを追加しました。 ただ、他の端末（本プログラム開発にかかわっていない開発端末）では接続できました。 何を確認したら宜しいでしょうか。 何かアドバイスいただけたら嬉しいです！
こんばんは。 いつもお世話になっております。 SQLServer2000を使用しています。 DTSのエクスポートウィザードを使用し、1インスタンス内で とあるDBから別のDBへオブジェクトをコピーします。 移行元をEXPDB 移行先をIMPDB とします。 ご相談としては移行設計（書面的なもの）についてです。 実際は、DTSが内部でEXPDBからオブジェクトをエクスポートし、 IMPDBへのインポートまで一括実行をすると思います。 この場合、移行作業項目表にエクスポートに1時間、インポートに1時間と記入を分けることは 意味があるでしょうか？。 実は今回、移行作業項目表には、分けて記入してしました。 ところがお客さんに「実施した内容と違う」と指摘を受けています。 DTSは内部でインポートまで実行するため、 トータルで2時間を要する意味です、と後で補足したのですが 手順どおりやっていない、違うことをやっていると言われています。 つまり「エクスポートウィザード」を使用したので、お客さんとしては 別途「インポートウィザード」で別途作業があると思ったらしいのです。 「DTSの実行」という項目で、「2時間」と書くべきであったかも しれません。 またDTSについてお客さんへの説明が不足していたかもしれません。 やはり私に瑕疵があったのでしょうか？。 ご意見を頂けると助かります。
SQL Serverのバックアップを取る為 DBをオフラインにしたのですが いくつかのDBが [DB名](復旧中)　となったまま状態が元に戻りません。 この状態を強制的に解除する方法はありますでしょうか？ 教えて下さい。
すいません。初心者のSQL構文の質問です。 データベースはSQLServer2005です。 ID | 履歴 | 有効日付 100 | 1 | 2009/5/15 100 | 2 | 2009/7/15 100 | 3 | NULL(最新データ) 200 | 1 | NULL(最新データ) のようなテーブルがあります。 データ履歴を作成するたびに有効日付には指定した日付が入ります。 作成した最新のデータには有効日付にはNULLが入るようになってます。 有効日付はdate型です。 このテーブルでのSELECTで 例えば、 2009/6/15と入力された時（条件）には 結果： 2 |2009/7/15 2009/7/15と入力された時（条件）には 結果： 2 |2009/7/15 2009/7/16と入力された時（条件）には 結果： 3 |NULL(最新データ) という結果を取得したいのです。 どなたか詳しい方のご教授をよろしくお願い致します。
sqlserverで、何らかのファイルへデータベースのエクスポートを行い、 ２つのPC間（ネットワークはつながっていない）で、データベースの移行を頻繁に（１日１回程度）したいと思っています。 （開発環境を持ち歩く意図です。） 環境は下記の通りです。 SQL Server 2005 Express Edition SQL Server Management Studio Express Edition DTSWizard.exeでエクスポートできるのは知っているのですが、 「ファイル」へのエクスポートは貧弱らしく、困っています。 mdbファイルへのエクスポートはできるのですが、 いざやってみると、VIEWをエクスポートするとテーブルとしてエクスポートされてしまい、 インポート時にはVIEWとしては再現してくれません。 ということで、質問は下記の通りです。 SQL Server 2005 Express Edition で、 ・USBメモリ等で持ち運び可能な形（ファイル）にエクスポート ・VIEWも、VIEWとして再現される という条件を満たしたエクスポートの方法はあるでしょうか。 以上です。 ご回答よろしくお願い致します。
Select @@spid as セッションID このSQL文で出来ることを教えてください。 他のサイトで @@SPID この変数（サーバー プロセス ID）は、Pervasive PSQL 接続のシステム スレッドの ID を示す整数値を返します。 例は、402 などの整数の ID と書いてありました。 また、セッションIDについてもいまいちわからず調べたのですがjavaのセッションにつて とかが、いっぱい出てきました。セッションとセッションIDは、別物なのでしょうか？ セッションIDとは、SQL文を実行した時の番号みたいなものでしょうか？ よろしくお願いします。
質問です! 困っているので早めの回答を望みます! <困っていること> 　SQLServer2005のシステムテーブル名「dba.sysprocesses」に データがInsertされた事をトリガとして起動し、Insertされた データを別テーブル(1テーブルで新規作成するテーブル) に反映したい。 システムテーブル内へのInsertをトリガとした処理は 可能なのでしょうか。 また、デメリット面などございましたら合わせて教えてください。　
宜しくお願い致します。 ＳＱＬ　ＳＥＲＶＥＲにウイルスセキュリティＺＥＲＯ搭載のクライアントから接続する方法・設定がわかりません。 ＳＱＬ　ＳＥＲＶＥＲにクライアントから接続するために色々設定を試していたのですが、結局ウイルスセキュリティのファイアウォールをキャンセルした状態でしかアクセスする事ができませんでした。 そこでウイルスセキュリティの設定を色々変更して接続を試みたのですが分からない状態です。 ウイルスセキュリティの場合、ＩＩＳなどのＷＥＢサーバーを搭載したＰＣには使用することができないようなのですが、クライアントの場合は関係がないかと思っております。 どなたかクライアントの場合の設定方法をご存知の方がおられましたら教えていただけたらと思います。 宜しくお願い致します。
SQLServer2005で、次のような品物の単価の履歴を表すテーブルを作りました。「,」は列の区切りです。 ID,Sort,Name,Price,Effective,Time 1,1,りんご,100,True,2009/4/1 2,3,なし,120,True,2009/4/1 3,2,ぶどう,150,True,2009/4/1 4,4,ばなな,80,True,2009/4/1 5,1,りんご,110,True,2009/4/20 6,3,なし,100,True,2009/4/20 7,3,なし,90,True,2009/4/25 8,4,ばなな,False,2009/4/25 このテーブルから、Effectiveが、Trueで、最新の単価をSort順に抽出するSQL文が判りません。 SELECT　*　FORM　テーブル名　WHERE　(Effective=1) ORDER BY Sort に、何を加えれば実現可能でしょうか？ どなたか？詳しい方がいらっしゃいましたら、教えてください。 SQL文の初心者なので、簡単なことなんでしょうが、よろしくお願いいたします。入門書を読めば読むほど、こんがらかって、困っております。なお、Sortの部分は、正規表現的に問題があるので、見直そうと考えています。
syscolumns から 各フィールドごとのデータ型を取得して「数字」項目か「文字」項目か判断させたいのです。 要は Where句で使うパラメータにフィールドが「文字」項目であれば自動的に「'」を付与するようにしたいのです。 下記のSelect文でscaleがNULLにも関わらずタイプに「文字」と入りません、どうしてでしょうか ---------------------------------------------------------------- selectsc.name as フィールド名,sc.scale,case sc.scale when null then '文字' else '数字' end as タイプ fromマスター管理_DB.dbo.sysobjects as so join マスター管理_DB.dbo.syscolumns as sc on so.id=sc.id join マスター管理_DB.dbo.systypes as st on sc.xtype=st.xtype whereso.type='V' and left(so.name,2)='K_' and LEFT(st.name,3)<>'sys' ---------------------------------------------------------------- (フィールド名)　　(scale)　　(タイプ) 勘定科目コード　　　0　　　　　数字 勘定科目名　　　　NULL　　　数字(←「文字」になってほしい) 貸借　　　　　　　　　NULL　　　数字(←「文字」になってほしい) 計科目名　　　　　　NULL　　　数字(←「文字」になってほしい) ---------------------------------------------------------------- また、日付(日時)を判断できる項目はないでしょうか? よろしくお願いします。
みなさま初めまして。 SSISの変数利用について教えて頂きたく、何卒宜しく願いいたします。 現在、SSISの変数に入った値をSQL実行タスクで実行（正確には、変数の値を含むレコードを削除）したく、他スレッドを参考にし、下記設定を行おうとしたのですが、エラーが出力され登録が出来ません。。 SQL実行タスク ->左メニューより、「式」を選択 ->Expressionsにて、SqlStatementSourceを選択 ->下記式を記述 ----------------------------- DELETE FROM [tblTesttable] WHERE TIMEID = @[User::valtime] ----------------------------- 行いたいことは、テーブル（tblTesttable）から、項目TIMEIDの値がユーザ変数（valtime）と同じレコードを削除するという内容です。 上記式を記述し、「式の評価」を行うと、下記エラーが出力されてしまいます。。。 ------------------------------------------------------ 式"DELETE FROM [tblTesttable] WHERE TIMEID = @[User::valtime]"を解析できませんでした。この式には無効なトークン、不完全なトークン、または無効な要素が含まれている可能性があります。また適切な形式でないか、かっこなどの必要な要素の一部が不足している可能性があります。 ------------------------------------------------------- SSISについて初心者であり、ネットや本でいろいろ探しているのですがなかなかうまくいかず。。。 大変お手数ですが、どなたか教えて頂けますと大変に助かります。 どうか宜しくお願い致します。
innerjoinとleftjoinとrightjoinについてお聞きします。 この３つの検索方法の違いがよく理解できません。 どなたか宜しくお願いします。 また、どのような時にどの検索方法が適しているか、 具体例などを添えていただければ分り易いかと思います。 宜しくお願いします。
SQL Server 2005 EXPRESS を使用しています。 トランザクションのテーブルにマスタを結合して表示するビューを作成しました。 実際に利用する時はトランザクションテーブルの主キーを検索に多用すると予想されるので、該当のフィールドにインデックスを設定したいのですが… Management Studio　でインデックスを設定しようとするとエラーになります。 エラーメッセージは インデックス '' の作成に失敗しました。 (Microsoft.SqlServer.Express.Smo) ------------------------------ ADDITIONAL INFORMATION: Transact-SQL ステートメントまたはバッチの実行中に例外が発生しました。 (Microsoft.SqlServer.Express.ConnectionInfo) ------------------------------ ビュー 'View' に インデックス を作成できません。ビューにはスキーマがバインドされていません。 (Microsoft SQL Server, Error: 1939) となっています。まさにメッセージのとおりだとは思うのですが 「ビューにスキーマをバインドする」方法がわかりません。 どなたかご教授いただければ助かります。 よろしくお願いいたします。
ACCESSからODBC経由でＳＱＬサーバのテーブルの1行を削除しようとすると「同じデータを別な人が使っていてプロセスが停止しました」というメッセージがでてＳＱＬサーバのデータが削除できません。ただ全てのテーブルでできないわけではありません。なおＦＯＲＭから削除はうまくいきます。 どうもデータが多いテーブルで発生するようです。原因解るかた教えてください。なお、このテーブルは1人でしかアクセスしていません。
お世話になります。 今回仕事でSQLを使うことになりそうで、その担当になるのが確実となりそうです。 そこで質問ですが、 社内にPCが3台あります。 3台すべてからSQLにアクセスするにはそれぞれのPCにSQLをインストールすればいいのでしょうか？ 将来的にはファイルサーバー的なPCを購入してSQLをインストールして 他のPCからアクセスしたいと考えています。 現状では私のPCにSQL2005をテスト的にインストールしており操作方法などを勉強している最中です。 何かご指摘などあれば教えてください。
下記のようなテーブルがあった場合に、 ID1｜ID2｜価格 ----------------------- 1 ｜ 1 ｜ 100 1 ｜ 2 ｜ 200 1 ｜ 3 ｜ 150 2 ｜ 1 ｜ 1000 2 ｜ 2 ｜ 500 3 ｜ 1 ｜ 50 3 ｜ 2 ｜ 100 下記のようなレコードを返してくるSQLを教えて下さい。 ID1 ｜ ID2 ｜ 価格 ----------------------- 1 ｜ 3 ｜ 150 2 ｜ 2 ｜ 500 3 ｜ 2 ｜ 100 要するに、ID1毎に、ID2が最大のレコードを取得し、価格列の数値を使いたいのです。 基本的なSQLは理解しているつもりなのですが・・・。 ご回答よろしくお願いします。
すいません質問させてください。 ２つのデータベースがあります。 データベース名が -------------- SC CM -------------- の２つです。 そこに複数のテーブルがあります。 そこで質問なのですが、SCのデータベースのテーブル名AAAとCMのデータベースのテーブル名がBBBの 中から列名の店コードが違う物だけ抽出したいです。 ------------------------------- データーベースSC テーブルAAA 店コード、店名、店地域 123,あ,東京 231,い,大阪 312,う,京都 111,え,福岡 ------------------------------ ------------------------------- データーベースCM テーブルBBB 店コード、店地域 123,東京 111,福岡 ------------------------------ 上の様な造りになっています。 抽出結果 ----------------------------- 店コード、店名、店地域 231,い,大阪 312,う,京都 ---------------------------- 私なりの考えなのですが SELECT * FROM AAA,BBB where AAA.店コード <> BBB.店コード このSQL文を改変して出来ると思われますか？ SCのデータベースからCMのデータベースを比べることは、出来ますか？ よろしくお願いします。
テーブル内の未使用領域を解放する事が出来ずに困っています。 SQL Server 2000で運用中のデータベースで200MB程度を想定していた テーブルが、600MB程度になっていました。おかしいなと思い、 インデックスの再構築でもすれば何か状況が変わるかなと以下の 手順を行いました。 該当のテーブルをDBCC DBREINDEXした後、sp_spaceusedで確認 　data と index_size のサイズは約半分に減少 　しかしその分 unused が増加 この後データベースを圧縮すれば、unusedの部分が解放されるかと 思いやってみたのですが 　unused の領域はそのままで解放されず 　data と index_size のサイズが約倍に増加(ほぼ元に戻っている) という状況になってしまいました。 お聞きしたい事は以下の２点です。 １. データベースを圧縮すると、テーブル内のデータ量が増加したように見えるのですが、これは何が起きているのでしょうか？ ２. テーブル内の未使用領域を解放する方法は無いでしょうか？ よろしくお願いいたします。
パラメータ付きストアドから、そのパラメータを展開したSELECT文のストアドを作成する事は可能でしょうか? アクセスのデータシートビューを表示するにはパラメータがあっても指定出来ないようなんです。 「DoCmd.OpenStoredProcedure」でパラメータ付きのストアドを実行すると、 パラメータ用のインプットボックスが表示されその都度入力しなくてはなりません。 そこで、アクセスから@フィールド名 と @テーブル名 をパラメータとしてストアドを実行し、 ストアドで「SELECT @フィールド名 from @テーブル名」パラメータを展開したSELECT文にして、 別の名前を付けたパラメータ無しのストアドとして登録し、そのストアドを アクセスの「DoCmd.OpenStoredProcedure」で実行すれば、目的のデータシートビューを表示出来ると考えました。 ストアドからストアドを作成できるのでしょうか、可能であれば方法を教えて下さい。
環境 SERVER (Dell T-300) SQL-Server 2008 Workgroup Edition Windows認証 Workgroup による共有接続 ファイルサーバーとしては正常に接続できていますが、SQL-Serverのファイルに接続できません。SQL-ServerのデーターフォルダーはドライブDにあり、Administrator はフルコントールの設定です。 データーベース全体のセキュリティーのログインには SERVER\Administratorと表示されています。 個別データーベースのセキュリティーは： ユーザー dbo guest INFORMATION_SCHEMA sys 上記 dbo のプロパティーは ユーザー名　　dbo ログイン名　　SERVER\Administrator 規定のスキーマ　dbo 所有されているスキーマ　なし ロールメンバー　db_owner にチェック済 上記の設定でAccess 2007からmdb、adpともアクセスを拒否されます。どこをどのように設定すればよいのでしょうか、ご指導のほど宜しくお願い致します。
こんにちは、いつも参考にさせていただいております。 通常1レコードのバイト数の上限は8060ですが、 それがSQLServer2008あたりから緩和されたと聞きました。 そこでマイクロソフトのTechNetを見ましたがよくわかりませんでした。 ２つわからない点がありますのでご教授どうかお願いいたします。 ◆疑問点(1)◆ ↓で8060バイト上限が緩和できそうだと思った中での疑問です。 マイクロソフトのTechNet 「8 KB を超える場合の行オーバーフロー データ」 http://msdn.microsoft.com/ja-jp/library/ms186981 … 「これら（varchar 型、nvarchar 型、varbinary 型、sql_variant 型、またはCLR ユーザー定義型）の列の長さは、単独の場合は引き続き 8,000 バイトに制限されますが、組み合わせた場合は 8,060 バイトの制限を超えることができます。」 わからないのは、上記文章中にある「組み合わせた場合」というポイントです。 ○varchar 型とnvarchar 型、varbinary 型とsql_variant 型というように違う種類を組み合わせなければ8060バイト制限が越えられないのでしょうか？ ◆疑問点(2)◆ 「8 KB を超える場合の行オーバーフロー データ」ページ内でntext型などについての注意書きがありました（下記）。 それについての疑問です。 「この制限は、varchar(max) 型、nvarchar(max) 型、varbinary(max) 型、ntext 型、text 型、image 型、または xml 型の列には適用されません。」 ○ntext型とvarchar 型等との組み合わせの場合、8060バイト制限は関係ないのでしょうか？ 　（というよりntext型などは8060バイトレコード上限が関係ない？） 「text 型データと image 型データの使用」 http://msdn.microsoft.com/ja-jp/library/ms189574 … どうかご教授・ヒントなどいただけないでしょうか。 よろしくお願いいたします。 補足など必要でしたらコメントください。
SQLSERVER2005を使用しています。 テーブルAとテーブルBが存在し、テーブルAの中でテーブルBを「含まない」データを抜き出すことはできますでしょうか 具体的には ・テーブルA 名前　　番号　　個数 ああ　　1　　　　10 ああ　　2　　　　20 いい　　3　　　　10 いい　　4　　　　20 うう　　5　　　　10 うう　　6　　　　20 ええ　　7　　　　10 おお　　8　　　　20 ・テーブルB 名前　　番号 ああ　　1 いい　　3 うう　　5　　 うう　　6 おお　　8 とあった場合、「テーブルAの中でテーブルBの名前と番号が一致するものを含まないデータ」の抽出結果 名前　　番号　　個数 ああ　　2　　　　20 いい　　4　　　　20 ええ　　7　　　　10 この結果を出すプログラムを教えていただけないでしょうか。 宜しくお願いします。
先日質問した「選択したフィールドだけのCSVを出力」を作り込もうとしています。 テーブル名とフィールド名を管理するテーブルを作りました。 自動的に管理テーブルのメンテナンスをしたいと考えました。 その管理テーブルとSELECT文(sysobjects.name,syscolumns.nameを取り出す) の間で同期を取る為に、ストアドを作ろうとしているのですが解りません。 要は、管理テーブルに有ってSELECT文に無いものを管理テーブルから削除。 (フィールドが消されたか名前が変えられた時) 管理テーブルに無くてSELECT文に有るものを管理テーブルに追加。 (フィールドが追加されたか名前が変えられた時) この二点が出来れば同期が取れると考えていますが、サブクエリーにな ると 思うのですがうまく作れません、ご教授をお願いします。
SQL Server Management Studio Expressをインストールしたいのですが、 何故かツールバーの「ファイル」「編集」「表示」「ツール」などは日本語表示なのですが、 オブジェクトエクスプローラー内や、右クリックした時の表示が英語になってしまいます。 最近ＰＣが変わって、インストールを行ったら英語表示になったのですが、 以前のＰＣでは日本語表示でした。 他のＰＣでもテストしたのですが、それもの日本語で表示されます。 どなたか解決策をご教授ください。
すいませんこの間、 ２つのテーブルから条件に一致しない行のみ抜き出す 方法について質問した者です。 今回は、3つのテーブルから条件に一致しない行のみ抜き出しCSV か他のテーブルに抜き出す処理を作ろうと思っています。 そこで質問なのですが、以下の２つのテーブルから 条件に一致しないコードのみ抜き出すSQL文などありますか？ ----------------------------------------- マスターテーブル コード、ネーム１、ネーム２、店コード、店地域 １、あ、い、６、東京 ２、う、え、８、北海道 ３、お、か、４、京都 ４、き、く、２、奈良 店コードテーブル 店コード、店区分 １、スーパー ２、コンビニ ３、デパート ４、ホームセンター 地域テーブル 地域コード、店地域 １、東京 ２、京都 ------------------------------------------ 条件は、マスターテーブルの店コードが店コードテーブルに存在 しないANDマスターテーブルの店地域が地域テーブルに存在 しないデータのみ抽出です。 抽出結果は、以下の様にしたいです。 １、あ、い、６、東京 ２、う、え、８、北海道 ４、き、く、２、奈良 わかりずらい質問ですがよろしくお願いします。
ご教授お願いします。 靴マスタ（スニーカーA、スニーカーB、サンダルA・・・） 色マスタ（赤、青、黄色、黒・・・） 素材マスタ（皮、ビニール、木・・・） 上記３マスタがあるとします。 靴受注システムにおいて、靴マスタを選んだ際に、 組み合わせとして可能な「色（色マスタより）」、「素材（素材マスタより）」だけを選択させたいという仕様があります。 それらの組み合わせを制御するために、 下記画面の様な「組み合わせマスタ保守」を用意しようと思います。 靴：スニーカーA ---------------------- 「選択可能色」　　「選択可能素材」 　　　黒　　　　　　　　皮 　　　赤　　　　　　　　 上記により靴受注画面においては 「スニーカーA」を選んだ時点で、色は(黒or赤）、素材は(皮） という選択しか出来なくなります。 ※色と素材の組み合わせは制御しません。 上の内容において「組み合わせマスタ」のテーブルレイアウトは どのように設計すべきでしょうか？ 考えているのは色も素材もある程度種類に上限があるので、 下記の様に列側に持たせようと思っているのですが・・・ 靴　　　　 ｜区分（色 or 素材）｜種類1｜種類2｜～｜種類99｜ スニーカーA｜色　　　　　　　　｜黒　 |赤　 | スニーカーA｜素材　　　　　　　｜皮　 | ・ ・ ・ スニーカーB｜色　　　　　　　　｜黒　 |赤　 |黄　 | スニーカーB｜素材　　　　　　　｜皮　 |ビニル|合皮　| このように色・素材を列側に持たせる方針がどうなんだろう・・・という思いがあるのですがいかがでしょうか？ 同様な仕様の場合に、皆さんはどのように設計されますでしょうか？ お知恵を拝借できればと思います。
はじめまして。 SQL文の"記述"という面については問題ないのですが、 パフォーマンスやメンテナンス性等を考慮した際に、 "基本"的な記述作法を纏めているサイトはありますでしょうか？ （または書籍）書き方というよりは考え方の様なものなのですが・・・。 たとえば「外部結合は３つくらいまで」とか「いくつも結合するならランダムリードで」とか、そもそも例としてもあまり思いつかないのですが。 SQLとしては成り立っているため、モノとしての動作は（スタート時においては）問題無いのですが、レコードが蓄積された後の動作遅延や、後々のメンテナンスで現在苦労しておりましたので、何か参考に なる情報がございましたらぜひ教えていただければと思います。
ACCESS2003とSQLserver2008を使っています。 エンドユーザが画面でフィールド名を選択して、必要なフィールドだけ のCSV(エクセル)を出力したいのですが、そんなツールはないでしょうか? 作り込むとしたら、ストアドでSELECT文のフィールド名やテーブル名に 変数を使うことは可能でしょうか? (試したらフィールド名自体が件数分表示されました、テーブルは エラーになりました) また、どこかにサンプルなどはないでしょうか?
SQLServer2005 を使用し、ストアドプロシージャを作成しています。 select ～ into ～ で一時テーブルを作成、データ挿入するのですが、 この命令で作成された一時テーブルにプライマリキーを作成したいと 考えております。 目的は、挿入される件数が多くなりそうなので、 検索を速くする為です。 プライマリキーを作成するのは、 ALTER TABLE ～ CONSTRAINT PK_xxx PRIMARY KEY CLUSTERED ( ～ ) で作成できる事は、理解しております。 これらの処理をストアドプロシージャで行いたいのですが、 注意点としては、当ストアドプロシージャが 並行して実行される事を考慮しておかなくてはなりません。 以下のようなサンプルを作成し、テストしてみたのですが、 セション１でストアドプロシージャ実行後、 セション２でストアドプロシージャを実行してみたのですが、 以下のエラーメッセージが表示されてしまいます。 ここで質問ですが、 制約名をどのようにすれば実現できるのでしょうか。 たとえば、制約名を省略すれば、システム内で一意な名称を 命名してくれるような書き方はないのでしょうか。 ご存じの方、ご回答宜しくお願いします。 -- サンプルストアドプロシージャ create procedure proc_test as select getdate() AS sysdate into #worktable alter table #worktable with nocheck add constraint pk_xxx primary key clustered ([sysdate]) waitfor time '23:59' -- テストの為待機 -- セション１ストアドプロシージャ実行 exec proc_test -- セション２ストアドプロシージャ実行 exec proc_test -- セション２の実行結果 (1 行処理されました) メッセージ 2714、レベル 16、状態 4、プロシージャ proc_test、行 6 データベースに 'pk_xxx' という名前のオブジェクトが既に存在します。 メッセージ 1750、レベル 16、状態 0、プロシージャ proc_test、行 6 制約を作成できませんでした。以前のエラーを調べてください。
bcpコマンドでインサートをしたいと考えています。 テーブルの形式は 1 datetime 日時 2 filed_1 varchar(10) 3 filed_2 varchar(10) 4 filed_3 varchar(10) です。 フォーマットファイルに 8.0 4 1SQLDATETIME08","1日時"" 2SQLCHAR03","2filed_1"" 3SQLCHAR03","3filed_2"" 4SQLCHAR03"\r\n"4filed_3"" 書きました。 データは、 2009/04/01 0:00:00,11.0,11.0,11.0 2009/04/01 0:01:00,11.0,11.0,11.0 です。 SQLServerは2005のExpressです。 実行すると コピーを開始中です... SQLState = 37000, NativeError = 7339 Error = [Microsoft][ODBC SQL Server Driver][SQL Server]リンク サーバー '(null)' の OLE DB プロバイダ 'STREAM' から、列 '[!BulkInsert].日時' に無効なデータが返さ れました。 BCP コピー in が失敗しました が返されます。 成功させるにはどこを直せばよいでしょうか。 よろしくお願いします。
別サーバからデータベースサーバにアクセスさせるIPアドレスを限定したいのですが、 SQLServerでそのような設定箇所ってあるのでしょうか？ ファイアーウォールでIPとポートを指定して、例外を所除する方法しか思いつきません。 対象サーバは、SQLServer2005WorkgroupEditionだったと思います。 宜しくお願いいたします。
SQLサーバ2005にストアド・プロシジャーとトリガ・プロシジャを作成したのですが、これの名前の一覧表をExcelに取り込みたいと思っています。簡単にできる方法はないでしょうか。
ASP.NET、SQLServerを使用してWebサイトを作っています。 本番データベースの接続文字列に変更したら、以下のエラーになりました。 何のことやら分からないのですが、どなたか教えて下さい。 エラー： 初期化文字列の形式が使用に適合しません。index 0 で始まっています。
Microsoft Visual Studio 2005のサーバーエクスプローラでテーブルデータの表示での画面では ツールバー、クエリデザイナのクエリの種類の変更が有効でUPDATEやINSERTに変更できるのに SQL Server Management Studioでオブジェクトエクスプローラからテーブルを選択し開いた画面では ツールバー、クエリデザイナのクエリの種類の変更が有効にはならない 画面的には全く同じと思えるのですがなにか設定があるのでしょうか
1分に1回レコードが出力されたログファイルがあります。 これはCSV形式のファイルです。ファイルは15ファイルあります。 各ファイルの列数は違っていて60～260まであります。 必要なデータが記録されている列もファイルによって違いますが 各ファイルともいらない列が半分くらいありデータは無いか"-"になっています。 データは大体整数4桁小数2桁の数値です。 毎月一回集計しないといけないので各ファイルに対応したテーブルを作り データを読み込みたいと思います。 過去分を持つとレコード数が増えるので毎回読み込みからにしたいと思います。 データをテーブルに取り込むやり方を考えています。 VBでシステムを作っているのでファイルを1行ずつ読み 必要なデータをインサートするのがいいのか SQLServerの機能を使って全部読み込むのがいいのか 何を調べて判断すればいいのかアドバイスをお願いします。 VBは2008でSQLServerも2008でやろうかと考えています。
お世話になります。 SQLServer2005 を使用しているシステムの CREATE PROCEDURE 文の中に下記のような宣言がありました。 DECLARE @A NVARCHAR(max) = N'@P1 NVARCHAR(8), @P2 NVARCHAR(8)'; これは、いったい何をしてるのかわからないのですが、 変数宣言？なんだと思うんですが、＝の右側に二つ（Ｐ１、Ｐ２）と あるのでよくわかりません。どなたか教えてください。
皆様、お世話になります。 まず、初めに環境を晒します。 ・OS WindowsServer2003 SP1 ・DB SQLServer2005 SP1 SSISを使用しフラットファイルをDBに収めるという処理を行っております。 そのSSISの中で緩やかなディメンションを使用し追加更新を行っておりますがエラーが発生します。（検証エラー） 以下が、検証エラー内容です。 [挿入先 [1840]] エラー : OLE DB エラーが発生しました。エラー コード: 0x80040E37。 OLE DB レコードを使用できます。ソース: "Microsoft SQL Native Client" Hresult: 0x80040E37 説明: "分散トランザクションが完了しました。このセッションを新規トランザクションまたは NULL トランザクションのいずれかに参加させます。"。 マイコン-管理にて分散トランザクションの設定は行っております。 といってもサービス起動の確認をしただけですが・・・ 以上の処理をSQLServer2005　"SP2"で動かしたところ正常に動作します。 SP1で使えないということはバグと認識したいのですが確かなソースが ありません。SP1でもSSISを実装できるってことはバグとも考えにくいし混乱している状態です。 この情報に関する事を知っている方、是非よろしくお願い致します。
いつもお世話になっております。 SQLserver2000のDTSを利用して、ファイルの内容をDBに取り込んでいます。 このパッケージでは、2つのファイルを取り込む処理を行っているのですが、 1つ目のデータソースのファイルが0件の場合、 「データファイルマッピング作成時のエラー： 　ファイルを格納しているボリュームが外部的に変更された為、 　開かれているファイルが無効になりました。」 というエラーとなり、そこでパッケージが終了します。 できれば、1つ目のファイルが0件なら、次のファイル取り込みに進みたいのですが、 実現する方法はありますでしょうか？ よろしくお願いいたします。
SQLServer2005のSSISを使用しようとしています。 簡単な操作・処理であれば、フィーリングで大体はできるのですが、 細かい設定（パラメータ等）になるとさっぱり分かりません。 SSISに詳しい方は、何を参考にしているのでしょうか。 何か参考になる書籍等ありましたらご教授いただければ幸いです。 よろしくお願い致します。
(1) Viewで並び替えを設定してもAccessで開くとその並び替えが無視されID順になってしまいます。 (2) これまで、Access2007でクエリーに設定していた関数 (Pmt)はどこにどのように設定すればよいのでしょうか？ よろしくお願いします。
２つのテーブルから条件に一致しない行のみ抜き出しCSV か他のテーブルに抜き出す処理を作ろうと思っています。 そこで質問なのですが、以下の２つのテーブルから 条件に一致しないコードのみ抜き出すSQL文などありますか？ ----------------------------------------- マスターテーブル コード、ネーム１、ネーム２、店コード １、あ、い、６ ２、う、え、８ ３、お、か、４ ４、き、く、２ 店コードテーブル 店コード、店区分 １、スーパー ２、コンビニ ３、デパート ４、ホームセンター ------------------------------------------ 条件は、マスターテーブルの店コードが店コードテーブルに存在 しないデータのみ抽出です。 抽出結果は、以下の様にしたいです。 １、あ、い、６ ２、う、え、８ このような考え大丈夫でしょうか？ SELECT * FROM マスターテーブル AS M INNER JOIN 店コードテーブル AS S ON M.店コード = S.店コード わかりずらい質問ですがよろしくお願いします。
いろいろ試行錯誤したのですが、ご質問させて頂きたいと思います。 以下のようなテーブルがあったとします。トランザクション形式です。 すべてのデータは数値型です。 ID seq time A 1 10 A 2 5 B 1 25 B 2 30 C 3 20 C 3 10 C 3 20 以下のようにしたいと思います。 同一ＩＤの中で一つ前の行のTimeをみて差分を出したいと思います。 以下のテーブルをみますと、IDがAのSEQ2番のtimeは5、 IDがAのSEQ1番のtimeは10です。なので5から10を引くと-5となります。 それをtime_diffにいれたいと思います。 ID seq time　time_diff A 1 10 null A 2 5 -5 B 1 25 null B 2 30 5 C 3 20 null C 3 10 -10 C 3 20 -10 OracleではLAG関数があり、一つ前の行を参照することができ、今までそうしてましたが、SQL2005には同じような関数を探してもありませんでした。 仕方ないのでテーブルを別名保存し、timeフィールドをtime_lagと変更、そのテーブルに１行空行を追加し、オリジナルと結合させて time同士を引き算してました。 しかし、この場合、あまりに負荷がかかり、ディスク領域も取ることから何か別の方法があればどうかご教示ください。
ＳＱＬサーバーには test１とtest２の二つのデータベースがあります。 アクセス2003のテーブルをＳＱＬサーバーへエクスポートする時 test１に送ったりtest２に送ったりしたいのですが データベースを選択する画面が出てきません。 いちいちＯＤＢＣデータソースアドミニストレータを呼び出しで 構成→規定のデータベースを以下のものに変更する をしないとだめですか？ アクセスでエクスポート時に設定できる方法があれば教えてください。 よろしくお願いします。
cn.Open "Provider=SQLOLEDB;Data Source=NASTUN-PC\SQLEXPRESS; " & _ "Initial Catalog=" & サーバー名 & ";" & _ "Integrated Security=SSPI" cn.Execute "UPDATE Tbl SET チェック = 0" エクセルからＳＱＬサーバーへ更新クエリを実行しています。 今までこのコードで問題なく作業できていたのですが 昨日から エラーNo:-2147217871 「時間切れになりました。」 というエラーになります。 cn.CommandTimeout = 120 と長くしても同じです。 何もいじってないのにできなくなるなんてあるのでしょうか？ ＳＱＬサーバーにはテーブルのみおいています。 よろしくお願いします。
拡張子のsdfはどういうファイルのことですか？ 教えてください。 よろしくお願いします。
大至急！！mdfファイルの中身を見る方法を教えてください。すごくすごく困ってます。サーバーが故障して立ち上がりません。サーバーのHDDの中身は他のPCで確認したのですが、肝心の見たいファイルが開けず。。。どうしても今すぐ内容を確認したいのですが、何か手段はないでしょうか？助けてください。よろしくお願いします。
今日は、私はUNIX上で、データベースを使ってweb掲示板を作っています。 データが登録されている表から条件に合うような行を削除したいんですが、できなくて困っています。 データベースを使った削除するプログラムの例などがありましたら教えてください？よろしくお願いします。
お世話になります。 更新のSQL文を考えているのですが、なかなかうまく動きません。 どなたか教えていただけないでしょうか？ やりたいことは、"KSK011"と"KSJ01"で"HINB"という項目で マッチングしていたら、KSJ01の"ZAIK"をKSK011の"ZZAI" にセットしたいと考えています。 UPDATE KSK011 SET KSK011.ZZAI = KSJ01.ZAIK WHERE KSK011.HINB IN (SELECT KSK011.HINB FROM(KSK011) INNER JOIN KSJ01 ON KSK011. HINB = KSJ01.HINB) 動作させると、FROMのカッコが不適切とエラーがでます。カッコを取ると”マルチパート識別子 ??KSJ01.ZAIK?? をバインドできませんでした。”となります。どこがまずいのでしょうか？
http://www.microsoft.com/japan/sqlserver/2005/so … のサンプルデータ（upsizingpart5.exe ）をダウンロードして 試してみたいのですが この画面でどのボタンを押しても解凍することができません。 どうすればいいでしょうか？ ちなみにアクセスもＳＱＬサーバーもインストール済みです。 よろしくお願いします。
同じ列が存在する２つのテーブルがあります。 その２つのテーブルの同じ列同士を突き合わせ、 同じ条件の値を表示したいのですが、 SQL文で可能なのでしょうか？ 例： 条件としてテーブル１、テーブル２の列Aが3以下の数字すべて テーブル１ 列A ― 1 1 2 3 4 5 テーブル２ 列A ― 1 2 2 3 3 3 3 4 4 5 ほしい結果 A｜A ―― 1｜1 1｜ 2｜2 　｜2 3｜3 　｜3 　｜3 　｜3 不躾な質問で恐縮ですが、 アドバイスお願いいたします。
お金を余りかけずにSQL Serverを立てたいのですが、 何のソフトを買えば、実現できるのでしょうか？ 処理するレコードは最初約1000万レコードで 1日約、10万レコードづつ増えます。 現在の環境は ハード 　Q6600 CPU : 1CPU 4コア MEM : 4GB HDD : 400GB ソフト OS : WindowsXP x64 ちなみにVisualStudio2005Proを持っていますが、これについているSQL Serverは使えるのでしょうか？
アクセスのデーターをSQLサーバーへ移行する計画があり、準備のため SQL Developer バージョンで独習中です。SQLサーバーにコピーしたテーブルにアクセスからログインするとテーブルは見られるのですが、データーの変更については「このレコードセットは更新できません」と表示されます。権限の問題ではないかと思われます。 環境と現状の設定： XP Professional SQL Server 2008 Developer Visual Studio 2008　 サーバー名： SVR-1 セキュリティー ログイン名：　SVR-1\taro サーバーロールのメンバーシップ：sysadmin データーベース名： project ユーザー名： dbo ログイン名： SVR-1\taro 既定のスキーマ： dbo 所有されているスキーマ：なし データーベースのロールメンバーシップ： db_owner 不思議なことに、Visual Studio 2008を使って試作したデーターベースはアクセスから書き換えができます。セキュリティーの設定も何ら変わりがないのですが。 データーベース （project）のユーザー名（dbo）の「所有しているスキーマ」にあるdata_reader, data_writer欄にチェックをいれても結果は同じです。 どこをどのように設定すれば良いのか、ご教示戴きますようお願い致します。
SQL Server 2005 Standard, Windows XP(SP3)を使用しています。 あるツールから生成されるCSVファイルのデータベースへのインポートしたいと考えています。 しかし、CSVファイル以下のようなフォーマットになっています。 (・・・番号）は無視してください date,2009/05/27 （・・・１） name,test　（・・・２） 時刻,A,B,C,D,E,F　（・・・３） 11:13:05,1,2,3,4,5,6　　　（・・・４） 11:13:06,7,8,9,10,11,12　 （・・・５） （以下４，５のようなデータが続く…） となっています。 1は日付情報、２は特に意味無し、３はカラムの情報としたい物 4（以降）はデータとなっています。 データベースへは　"|"　をカラムの区切りとすると 時刻 |A|B|C|D |E |F | 2009/05/27 11:13:05|1|2|3|4 |5 |6 | 2009/05/27 11:13:06|7|8|9|10|11|12| (・・・以降データが続く) 上記のように（３）をカラム情報にして、不必要な情報を省いた状態でデータを取り込みたいと考えております。 同じく上記の最初のフィールドのように、元データのdate情報を時刻情報と合わせてdatetime型として一つので取り込みたいと考えています。 この為には、文字列の操作が必要となってくると思いますが、SQL Server上ではこのような事はできるのでしょうか？
http://oshiete1.goo.ne.jp/qa4981676.htmlに関連していますが 会社のＰＣですが 大事なファイルやデータはすべて共有フォルダに入れています。 （上司命令） 以前まではアクセスのテーブルのみを共有フォルダにいれ、 フォームをローカルＰＣにいれ作業していましたが このたびＳＱＬサーバーに移行しました。 （データ量が膨大になっていくため） 今回は一人で使用する予定なのですが そのときは共有フォルダに何をいれればいいでしょうか？ 前回質問時には 「SQL Server Management Studio Expres」のフォルダを 共有フォルダに移行しても意味がないとのご指摘をうけましたが http://oshiete1.goo.ne.jp/qa4890492.htmlより 「C:\Program Files\Microsoft SQL Server\MSSQL.x」 のフォルダを共有フォルダにいれればいいのでしょうか？ もしかしたらまだＳＱＬサーバーに対して誤解してるかもしれないですが アドバイスよろしくお願いします。
SQLServer2005Expressを使用して暗号化したデータベースのデータを他のＰＣへ移行しようとしております。 いろんなサイトを参考に下記の手順にてデータを移行しようとしております。 (1)データのバックアップ (2)Backup Certificate aaaaa to file = 'c:\aaa.cer' with private key (file = 'c:\xxx.pvk'',encryption by password = 'xxxxx') (3)新ＰＣへマスターキーの作成 (4)Create Certificate aaaaa From file = 'c:\aaa.cer' with private key (file='c:\xxx.pvk',decryption by password= 'xxxxx') (5)データのリストア リストア後、既存のプログラムを実行したところ、下記のコマンドを実行した場合に“この操作を実行するには、マスターキーをデータベースに作成するか、またはセッション内のマスターキーを開いてください” とメッセージが出力されます。 "OPEN SYMMETRIC KEY aaaaaaaa DECRYPTION BY　CERTIFICATE xxxxxxxxxxx" どこがいけないのでしょうか？ 非常に困っています。 よろしくお願いいたします。
違いは何ですか？ ＳＱＬと聞くと SQL Server が浮かびます。 教えて下さい。。
いつもお世話になっております。 ローカルにサーバを構築したいのですが・・・ DB初心者で分りません・・・ 大変申し訳ないですが教えて頂けないでしょうか？ （初めからあるsqlexpressを使わないでサーバ構築をしたいです。） よろしくお願いします。
お世話になっております。 ＳＱＬ＊ＰＬＵＳの表示の方法で分からないことがあるので 投稿させていただきます。 参考書の「パッケージの再コンパイル」というのをもとに SELECT object_name ,object_type,status FROM user_objects WHERE object_name IN ('TEST_PACK','CALL_TEST_PACK'); というステートメントを入力したのですが OBJECT_NAME ----------------------------------------------------------- OBJECT_TYPE STATUS ------------------ ------- CALL_TEST_PACK PROCEDURE VALID TEST_PACK PACKAGE VALID TEST_PACK PACKAGE BODY VALID と返ってきました。 できれば見やすくしたいので OBJECT_NAME　　 　　　OBJECT_TYPE　　　 STATUS　　　　 ------------　　　　　------------------　　 ------- CALL_TEST_PACK　　　　PROCEDURE 　　VALID TEST_PACK　　　 　　　　PACKAGE 　　VALID TEST_PACK 　　　　　　　PACKAGE BODY 　　VALID としたいのですが、上記のコードに何か付け足すだけで 可能でしょうか？ それとも、最初から設定する必要があるのでしょうか？ よろしくお願いします。
Accessのデータベースファイル.mdbを無料で作るにはどうすればいいですか？
SQLサーバーに保存してある「クエリ1.sql」をアクセスで開くにはどうすればいいでしょう？ アクセスで「リンクテーブル」→「ODBC接続」 でテーブルのリンクはできているのですが クエリをリンクするにはどうすればいいでしょうか？ 宜しくお願い致します。
【環境】 OS：Windows2003Server Standard SP2 DB：SQLserver2000 8.0 ASPと連動したWEBシステムを構築していますが、保守計画のトランザクションバックアップで取ったTRNファイルが肥大化してしまいます。 よって トランザクションログバックアップジョブに時間が多大に掛かってしまい、その間トランザクション使用領域の切り捨てがされないので、領域が圧迫されてしまいます。 ※自動拡張は5%で設定してますが、自動拡張タイムアウトが頻発します トランザクションバックアップジョブは2分に1回ほどの割合で実行しています。毎時起きるわけではないのですが、1日に数回そのような現象が発生してしまい、その間トランザクションバックアップジョブは稼動し続け、かつ自動拡張タイムアウトでシステム負荷が異常に高くなります。 大変困っております。。 なにか対策がある方は是非教えていただきたいと思います。 また、同様の事例がある方がいらっしゃいましたら教えてください。 些細な情報、対策でも良いのでどうぞ宜しくお願い致します。
ASP.NetでWebサイトの開発をしています。 ディベロッパーのデバッグモードでは問題なく、SQL Serverへの書込みができるのですが、ISSの仮想ディレクトリを介してWebサイトを開くと、読込みはできますが、書込みができません。（以下のエラー） どこにどんな設定をすればよいのでしょうか？ どなたか教えて下さい。 ちなみに、エクスプローラから該当xxx.MDFのプロパティを開いても、 「概要」「全般」ダブしかありません。 ****エラー内容******************************************** xxx.MDF" を更新できませんでした。データベースが読み取り専用です。 ***********************************************************
SQL Server 2005について質問です。 現在、SQLServer2005に関するパラメータ設計書のとおりに パラメータ値が設定されていることを確認するための手順書を作成していますが、 以下の項目についてどのように確認したらよいかわからず困っています。 ・データベースの所有者名 ・日付の相関関係の最適化有効 ・データファイルの初期サイズ[MB] ・自動圧縮設定 ・自動終了設定 ・統計の自動更新設定 ・統計の自動作成設定 ・統計の非同期的自動更新設定 ・復旧に関するページ確認設定 他の項目についてはTechNet等で該当の情報を得ることができました。 なお、SQL Server Management Studioはインストールしていない環境です。 どうぞよろしくおねがいします。
新しいクエリを挿入して クエリを保存したときは データベースの ・テーブル ・ビュー ・シノニム ・プログラミング ・セキュリティ のどこに保存されるのでしょうか？ SQL Server Management Studio ExpressのProjectsに「.sql」で保存されるようですが データベースから開くことはできないのでしょうか？
現在SQL Server2005を使用しております。 別のサーバー内でAccessのテーブルデータが定期的に更新されており、 このデータを利用したシステムをSQL Server上で作ろうと考えています。 手動でSQL ServerにAccessのテーブルデータをインポートするやり方は分かりましたが、（データ更新の為に）定期的にインポートする方法がわかりません。 どのように実現すればよいか、サンプルや参考になるHPがありましたら 是非教えていただけないでしょうか？
今春から、SQLを勉強し始めました。 今、groupというTABLEを作ろうとしているのですが、groupの近くにsyntax errorが出てしまって困っています。 自分で考えてみたのですが、わからないので、もしおかしな点がわかるようでしたら教えてください。 CREATE TABLE group ( id int, name char(20), member_num int, contract int, PRIMARY KEY (id) );
はじめまして。 現在、画面上で検索条件を選択し、検索ボタンを押すと結果を返すアプリケーションを作成しておりますが、 画面上の検索の条件に「空白」を加えると、検索前に空白で表示されていた件数に比べて少ない結果になる、という現象が起こっています。 原因は、テーブルＡとテーブルＢを外部結合させてデータを取得して表示していますが、 検索前はＢにレコードを持たないデータも表示しており、対象項目に検索条件「空白」を設定すると、テーブルＢにレコードを持ち、 かつ該当項目が空白(null)であるデータのみ検索して、テーブルＢにレコードがないデータは検索されないため、検索前より件数が少なく表示されるためだと判明しました。 画面上空白が選択されたら、テーブルＡの該当項目は空白、テーブルＢにはデータを持たないレコードも表示したいのですが、 どのようにすればよいかご教示いただければ有難いです。 （検索条件は複数あり、空白を指定できる項目も複数あるという前提です。） 以上、よろしくお願い致します。
SELECT TOP (100) PERCENT ACODE * 10 + CCODE AS Aコード, ACODE * 1000 + CCODE * 100 + GCODE AS Bコード, CASE WHEN [GCODE] = 0 THEN [CHIBAN] ELSE [GCODE] END AS 番地, MIN(DISTINCT X) AS X, MIN(DISTINCT Y) AS Y FROM dbo.Tbl GROUP BY ACODE * 10 + CCODE, ACODE * 1000 + CCODE * 100 + GCODE, CASE WHEN [GCODE] = 0 THEN [CHIBAN] ELSE [GCODE] END ORDER BY 字丁目コード, 号特定コード, 番地 上記のクエリを実行すると「データ型 nvarchar を float に変換中にエラーが発生しました。」というメッセージが表示されてしまいます。 おそらく[CHIBAN]フィールドはnvarchar型のためエラーが発生していると思うのですが、 なぜ強制的にfloat型にしようとするのかわかりません。 どのように回避すればよいでしょうか。ご教示のほどお願い致します。
DBのアクセス数ですが、限界値を設定するようなところはありますか？ また、動作に影響がでるのはどのくらいのアクセス数から考慮すればよいのでしょうか？
今現在アクセスのデータをSQLサーバーに移行して 「アクセス+SQLサーバー」にしようと思っていると知り合い話したら 「VB+SQLサーバーのほうが最強！」と言われました。 （理由までは聞く時間がなかったです） 何がどう最強だかわかりませんが、 「アクセス+SQLサーバー」より 「VB+SQLサーバー」のほうがいいのでしょうか？ （ＶＢはアクセスよりも高機能？） メリット・デメリットを教えてください。 よろしくお願いします。
宜しくお願いします。 前回、SQLのインストールがわからず質問した者です。 インストールが完了し次のステップに入りました。 仕様環境：WinXP/Pro SP3　OSは32bit版 CPU： AMD Athlon64 processor　2.00GHz　1.43GB RAM CPUは32bit・64bitともに対応 ローカルディスクは残り122G有り access2002　SQLサーバ2008 まず、accessをSQLサーバ－2008に移行しようと思い、 いろいろ調べた結果、accessにアップサイジングウィザードというものがあり、 そこから移行できるようなので、試しましたがエラーが発生しました。 以下がその内容です。 ”アップサイジングウィザードはマイクロソフトSQLサーバー（バージョン6.50SP5以上）で使用できます。 SQLサーバーデータソースにログインしてください）” SQLサーバーにログインすることだな、と思い、いろいろ項目をさがしたところ、 「SQLサーバーマネージメントスタジオ」というツールがあったので、そこでログインをしました。 （この辺はわけもわからずやりました） しかしその後、状況変わらず、アップサイジングはできませんでした。 そして次に試みたのは「SQLサーバーにデータのインポート及び、エクスポート（32bit）」という 項目があったのでそこから入りました。 データソースはaccessを選択し、ファイル名は該当するaccessのファイル名（仮に作成書として） ユーザー名とパスワードは特に設定せず進みました。 そして次の変換先が問題です。 間違えだ思いますがわからなかったので、ここでも変換先をaccessに選択し、 ファイル名も同じく該当するaccessファイルユーザー名とパスワードは設定せず、先に進みました。 次にテーブルのコピーまたはクエリの指定という項目になりましたので、 1つ以上のテーブルまたはビューからデータをコピーするを選択し、次へ進み、 どれを変換するか実行したところ、実行の準備までは成功しましたが、 実際のコピーはエラーが出て停止しできませんでした。 またその変換されるファイルもテーブル全部とクエリの一部でした。 レポートにつながっている普通の選択クエリも変換の際に名前が出てきませんでした。 マクロやフォームは出てきませんでした。 そもそも変換先が間違っていると思うので、（同じところから同じところ） 仕方ありませんが変換先がたくさん項目があってをどこに指定していいかわかりません。 ちなみに何をしたいかというと、 ・デーベース容量のアップ ・複数人で使っても「排他的に～」と出ず、スムーズな運用 ・処理速度アップ（これは元ファイルが１Mぐらいなので今のところ不便は感じないのですが） もしよければご指導・アドバイス等お願いします。 ちなみに一台のPCですべてやってます。 あと参考書も買わないといけなさそうです。 （何度も聞いてると気がひけますね）
宜しくお願いします、サーバーはまったくの初心者です。 仕様環境：WinXP/Pro SP3 CPU： AMD Athlon64 processor　2.00GHz　1.43GB RAM ローカルディスクは残り128G有り SQLサーバーをお試しで運用してみようと思い、 SQL Server 2008 Enterprise 開発者用トライアル版 (180 日間限定)をダウンロードしました。 （「X64実行可能ファイル」という項目がありそこからダウンロードしました） ダウンロードはでき、わかり易くデスクトップ上に展開したのですが、 その後、「setup」というアイコンをクリックすると、 「現在のOSのアーキテクチャはX86です。このメディアは、このシステムで実行するように サポートされていません。」 というエラーが出て先に進めません。 一応、インストールの方法に「コマンドプロンプトからのインストール方法」と いうものもあったので、インストールパラメータというコードをコピペしてエンターを押すと、 「システム　コンポーネントをインストールしたり構成するにはコントロールパネルを使って下さい。」 というエラーが出てきます。 意味もやり方がわかりません。（コンパネの中で何か操作するってことらしいですが・・） まず、ダウンロードする前に前書きを読んだのですが、以下の文があります。 ”X86、X64、または IA64 用の個別の自己解凍形式実行可能ファイル (EXE) を ダウンロードすることもできます。 これらの実行可能ファイルでは、64 ビット バージョンの Windows 上への X86 インストールはサポートされていません。 64 ビット バージョンの Windows 上に X86 をインストールするには、 DVD イメージを使用してください (IA64 はサポートされていません)。 ” そして上部にDVDイメージというリンク先があり、そこに入ると DVDイメージをダウンロードできそうな画面が出てきます。 これはもしかして、DVDに落としてからセットアップしないといけないということなのでしょうか？ ちなみにDVDはROMのみなので、書き込みはできません。 最終的にはaccessをインターフェースにして、SQLサーバーで運用できるまで やってみようと思っています。 まずはインストールで躓いています。 何かご指示をお願いします。
こんにちは。アべです。 データの処理でリレーショナルデータベースを使用しようとしております。 そこで、台帳(例えば顧客台帳)をマスタ登録して使用するのですが、 下記のことがクエリでは出来ずに困っています。 やり方のヒントでもよろしいので教えていただけないでしょうか？ ・過去に戻って、トランザクション処理を再実行する際に過去の その時点の台帳情報を引っ張りたい。 （テーブルに時間指定でクエリを投げる方法がわからない。） ・その台帳の情報を確認したい。 （単純に台帳の過去を知りたい。 トリガで更新処理のログを残す手間なやり方しか思い浮かばない。） 本をみてもリレーショナルデータベースに時間軸の概念がないような 気がしております。 （一応調べて見て、スナップショットデータベースがあり、これだと ある特定の時点しか取れず、しかも事前に用意しておかなければならず、 いまいち今回のパターンだと使えないと考えています。） 環境 SQL Server 2008 Service Pack 1 宜しくお願い致します。
こんにちは。アべです。 SQL Server 2000の物理ファイルデータ破損からの復旧について アドバイスを頂きたいと思い、登校させて頂きました。 経緯 データベースサーバがOS毎、緊急停止し、故障しました。 DBサーバのファイルを他のサーバに接続して復旧をかけると 下記のようなエラーになり困っております。 現在は、バックアップもない状態であり、どうしても mdfファイルとldfファイルから復旧をかけたいと考えております。 何か他にやったほうがいい復旧手順や オプションはルのでしょうか？ 何かアドバスがあればご教授をお願い致します。 壊れたところ以外のデータでも復旧できると助かります。 存在するファイルは、mdfファイルとldfファイルのみで、 バックアップありません。 すみませんが、宜しくお願い致します。 ↓やって見たこと アタッチを2000、2005(SP3)、2008(SP1)で実施してみましたが、失敗しました。 EXEC sp_attach_db @dbname = N'HOGE', @filename1 = N'F:\SQLData\HOGE\HOGEBACKData.mdf', @filename2 = N'F:\SQLData\HOGE\HOGEBACK_log.LDF' メッセージ 824、レベル 24、状態 6、行 1 SQL Server で、一貫性に基づいた論理 I/O エラーが検出されました: 正しくないページ (必要な署名: 0xaaaaaaaa、実際の署名: 0x3ee6da2a)。このエラーは、ファイル 'F:\SQLData\HOGE\HOGEBACK_log.LDF' のオフセット 0000000000000000 にあるデータベース ID が 0 のページ (0:0) の 読み取り 中に発生しました。SQL Server エラー ログまたはシステム イベント ログ内の別のメッセージで詳細情報が報告されることもあります。このエラー状態は深刻で、データベースの整合性を損なう可能性があるので、すぐに解決する必要があります。完全なデータベース一貫性確認 (DBCC CHECKDB) を実行してください。このエラーには多くの要因があります。詳細については、SQL Server Books Online を参照してください。 ↓ログをリビルドで復旧もやってみましたが、これも駄目でした。 CREATE DATABASE HOGE ON PRIMARY (FILENAME = 'F:\SQLData\HOGE\HOGEBACKData.mdf') FOR ATTACH_REBUILD_LOG ファイル アクティブ化エラー。物理ファイル名 "D:\DATA\SQLDATA\HOGEBACK_log.LDF" が正しくない可能性があります。 データベースが明確にシャットダウンされなかったので、ログを再構築できません。 メッセージ 1813、レベル 16、状態 2、行 1 新しいデータベース 'HOGE' を開けませんでした。CREATE DATABASE は中止されます。 以上
先日、SQL Server 2005/2008 Developer Edition(64bit)がインストールされてあるマシンが支給されました。 2005は構成ツールのみ表示されているので、どうやらインストールに失敗しているような感じです。 また、2008は昨日までは正常に使えていたのですが、今日出社してみると2005、2008共にサービスが停止になっており、開始することができません。 インストールした担当者が出張で連絡が取れず、その間にもし解決策があればと思いいろいろ調べてみましたが、サービスが開始されない以上DBにアクセスできず、構成の変更も反映されなくてお手上げです。 どなたか解決策のあるかた、どうか助けてください。 よろしくお願いいたします。
SqlServer2008を使用しております。 .netのプログラムが実行中とします。 この.netプログラムが発行しているSQL文を見る 機能はないでしょうか？ ご教授よろしくお願いいたします。
教えてください。 ストアドでfloor(数量（reat) ×　単価(money))=金額という計算をさせています。 そこで、200(コ)×9.4(円)=1879円と出るのです。floorで切り捨てても、1880円のはずです。flootなしでやっても、1879,9998と出ます。 何度入力しなおしても同じです。 Floatだと、1880となります。 他の計算はちゃんとできているようです（ざっと見た限りで100％確かめた訳ではありません） 理由がわからないのですが、教えてください。
access　SQLサーバとの接続によって何が得られるか？ 宜しくお願いします。 お恥ずかしいながらSQLサーバーがまったくもってわかりません。 会社でマイクロソフトのaccessを使うのですが、いろいろaccessを勉強していて 思ったのですが、より容量を増やすことができないか等を考えていたら、 SQLサーバーにあたりました。 （会社は小規模でノートPCを含めPC15台程度です。） マイクロソフトのホームページやSQLサーバーのことが書いてあるホームページを見ると 「データーベース専用のサーバーで、運用・管理に最適です」 ぐらいのことはわかりますが、あとは意味がわからないのです。 実際何ができるのでしょうか？ 例えば、前述のようにaccessの容量は2Gですが、SQLサーバーに接続することによって クライアント側はaccessの画面でいつも通り操作して、裏にはSQLサーバーに接続してあるので、 2G以上のデータを保存できるとかでしょうか。 ただのネットワークを介したデータ保存のドライブならLAN用のHDDもあります。 （しかもこちらの方が安い） その違いがわかりません。 サーバーという分野に初めて踏み込んだのでどうか易しく教えてください。 宜しくお願いします。
タスクマネージャーの「サービス」タブに ＳＱＬBrowserの状態が実行中となっています。 SQL Server 2005は立ち上げていません。 なぜ実行中になっているのでしょうか？ （vistaです） よろしくお願いします。
新しくユーザーアカウントを作成したのですが、作成したのはいいものの、メールアドレスの、新規登録や、ダウンロードしたものも、また、ダウンロードしなければならないのが、とても、困難なので前のユーザーアカウントのデータを新しいユーザーアカウントに、引き継ぐ方法を、教えてください！よろしくおねがいします！！！
たとえばTESTという列（フィールド？）の中に以下のようなデータがあった場合、 AAAAA AABBB CCCAA ABCAA BCAAA AACAA CCACC ABCAA この中から、'AA'があって'B'が入っていないデータを取り出すには どうすればよいか教えてください。 AAが入ったデータを取りだす WHERE　TEST LIKE '%AA%'までしか思いつきません・・・ わかりにくかったら補足しますので、よろしくお願いします。
すみません、どなたか教えて下さい。 列のサイズをchar(128)⇒char(300)に変更したいのですが、 システム稼働中に変更処理を行っても、DBへのデータ登録等は問題ないでしょうか？ また、サイズ変更処理は正常に終わりますでしょうか？ ご存知の方がいらっしゃいましたら、よろしくお願いします。
SQLSERVER2005の分析サーバーのSSASにリモートから匿名認証でアクセスする方法がわかりません。 どのように設定し、どのようにアクセスするのでしょうか？ 最終的には、エクセル2007データマイニングアドインから匿名認証などwindows認証以外の方法でアクセスする必要があり、困っています。 SQLSERVER2005 WindowsServer2003
SQLのupdate文で質問です。 こんな感じに更新したいんですが、 行番号が1のときの数値を行番号2も同じにしたいんですが、ちなみちに品番ごとです。 データはW_iテーブルのデータをそのまま更新したいんですが、どのようにしたろうまく出来ますか。 update W_i set 値 = 数値 from W_i where 行番号 = '1' こうすると行番号1しか変わらない （初期）　　　　　　　 品番 数値 行番号 ------------------ CZ 5 1 CZ 8 2 DF 6 1 DF 3 2 ↓ (更新後） 品番 数値 行番号 ----------------- CZ 5 1 CZ 5 2 DF 6 1 DF 6 2
VBAで、ADOを使ってSQLServerに接続しています。 データベースからSQL文でデータを取得してセルに表示させています。 そこで、今はwhere 月 = '4月' …等としているのですが 4月の部分をA1等にして、セルから取得して可変できるようにしたいのです どういうSQL文を書けば実現できるでしょうか？
1026:存在しないか、または完全に指定されていない一意テーブルです。 間違いなく存在しているので、「完全に指定されていない」のだと思います。 何が考えられるのでしょうか？ ACCESSのVBAでSQLに対して更新(追加)をかけると上記のエラーがでます。 FORMのLOAD時のイベントで下記の命令が実行されます。 DoCmd.GoToRecord , , acNewRec Me!支払番号 = wk_端末番号　　　　　　　'キーの設定 DoCmd.RunCommand acCmdSaveRecord　　　　←の命令でエラーになります。 似たシステムをコピーして名称などを変えながら作成しているのですが・・・ 元のシステムは正常に動いています。 DB側で何か指定する必要があるのでしょうか? DB側はSQLServer2008を使っています。
SQL_Server2000 ←→ SQL_Server6.5間で、レプリケーションを張りたいのですが、何か良い手はないでしょうか？ 今更、SQL_Server6.5かよ！っと思いでしょうが・・・ そこを何とか・・・ どんな方法・手段を使っても良いです。 また、中途半端な回答でも良いです。（ヒントになればOKかと・・・） みなみな様、救いの手をお願いします。
ＳＱＬサーバーへ移行したデータの容量を知りたいのですがどうやって確認できますか？ C:\Users\Documents\SQL Server Management Studio Express\Settings の中に入っている CurrentSettings-2009-02-04.vssettings がデータの容量でしょうか？
SQLserver2005のデータベースミラーリングについて教えてください。 現在Windows2003R2(32bit)+SQLserver2005(32bit)でDBを構築しています。 可用性向上のためにデータベースミラーリングを構成しようと考えています。 そのため新規にサーバーをWindows2008(64bit)＋SQLserver2005SP2(64bit)で計画しています。 （メインのSQLserverはSP2にします） このとき、SQLserverは32bitと64bitの間でミラーリングは構成できるのでしょうか。 MSDNに下記記載が有りますが、これは上記の構成が可能ということでしょうか。 http://msdn.microsoft.com/ja-jp/library/ms366349(SQL.90).aspx 「SQL Server のディスク上ストレージ形式は、64 ビット環境でも 32 ビット環境でも同じです。このため、データベース ミラーリング セッションでは、32 ビット環境で実行されているサーバー インスタンスと 64 ビット環境で実行されているサーバー インスタンスを組み合わせることができます」 よろしくお願いします。
SQLSERVER2005でwindows2003serverで運用しています。 マネージメントスタジオの復元機能で行いました。 どこに間違いがあるのでしょうか？ RESTORE DATABASE [test] FROM DISK = N'C:\～.bak' WITH FILE = 1, NOUNLOAD, STATS = 10 GO メッセージ 5133、レベル 16、状態 1、行 1 オペレーティング システム エラー 87(パラメータが間違っています。) により、ファイル "E:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\～.mdf" のディレクトリ参照に失敗しました。 メッセージ 3156、レベル 16、状態 3、行 1 ファイル '～' を 'E:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\～.mdf' に復元できません。WITH MOVE を使用して、そのファイルにとって有効な場所を特定してください。 メッセージ 5133、レベル 16、状態 1、行 1 オペレーティング システム エラー 87(パラメータが間違っています。) により、ファイル "E:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\～.ldf" のディレクトリ参照に失敗しました。 メッセージ 3156、レベル 16、状態 3、行 1 ファイル '～_log' を 'E:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\～_log.ldf' に復元できません。WITH MOVE を使用して、そのファイルにとって有効な場所を特定してください。 メッセージ 3119、レベル 16、状態 1、行 1 RESTORE ステートメントのプランを作成中に問題が検出されました。詳細については、以前のメッセージを参照してください。 メッセージ 3013、レベル 16、状態 1、行 1 RESTORE DATABASE が異常終了しています。
Access VBAを利用しています。フォームにテキストボックスを置いてユーザーに日付を入力してもらおうとしています。Accessのテーブル、Table1のDateフィールドには日付が入っています。2009/10/01みたいに８桁で入っています。 やりたいことは、フォームのテキストボックスに日付を2009/10みたいに入力してもらいます。実行ボタンを押すと、そうすると2009/10/1から2009/10/31までの１０月の値のみをselect文でひっぱってきたいと思っています。ここで指定の日付のみをひっぱってくるselect文が思いつきません。2009/10/1のみの値を引っ張ってくるselect文はわかるのですが、１０月の間、１１月の間など月指定の場合、どうやって引っ張ってくるのかご教授お願いいたします。
http://www.microsoft.com/japan/solutions/lob/suf … より 「SQL Server なら、1 つのファイルあたり、Access のデータ容量制限の約 5 億倍（1,048,516 TB）までのデータを扱うことが可能です。」 と書いてあるのですが パソコンのスペックのメモリが512MBなのですがそれでも可能なのでしょうか？ いまいち仕組みがわかりません。
Windows XP SP3 のパソコンに Visual Studio 2005 Professional Editionをインストールしました。 そのときVisual StudioについてきたSQL Server Developer Editionも同時に インストールしました。 こないだMicrosoftUpdateを行ったのですが、 Microsoft SQL Server 2005 Express Edition Service Pack 3(KB955706) のアップデートでエラー(エラー番号2BC9)になりアップデートに失敗します。 ネットで調べ Microsoft SQL Server 2005 Service Pack 3 (Express EditionではないSP3)をインストールするとよいと 書いてあったので実行したところ、インストールは完了したのですが、 そのあとまたMicrosoftUpdateを実行すると、更新プログラムにはいまだ Microsoft SQL Server 2005 Express Edition Service Pack 3(KB955706) が表示され、実行するとエラーになります。 いまは、↓の２つの疑問があります。 １．Developer EditionでもSP3はExpress Editionのバージョンをインストールするのか？ （SP3をインストールするにはどのバージョンをインストールすればよい？） ２．SQL Server 2005 Developer Editionでのバージョン確認方法 どちらかでもよいのでわかるかたおしえてください
データベースの接続先をPostgreSQLからSQLServerへの変更作業をしています。 PostgreSQL 8.1.9 --> SQLServer2005 ひとつ、変な現象が起きています。 移植前と移植後のDBで実行したSQLの検索結果が違いました。 SELECT a.ro_no, b.data_name FROM table_1 a, table_2 b, table_3 c WHERE b.data_name <> '' AND a.code_no = b.code AND a.user_id = c.user_id ORDER BY a.ro_no, b.data_name; ORDER句を細かく指定していないので、データ並びが違うのはしょうがないと思うのですが、件数が違うのはどういうことでしょうか？ データに規則性が無いので、どこがおかしいのか？という見当もつかない状態です。 データベースにデータを移植する際の注意点、上記の現象等の回避策等がありましたら教えてください。 宜しくお願いいたします。
エクセル2007データマイニングアドインからSQLServerに接続するひつようがあるのですが、winndows認証のポートが開けられないということなので他の方法で入る必要があります。 ほかに方法があるのでしょうか？
SQLServer2008 ですが SSMS でバックアップファイルの削除をしたいのですが タスクの編集画面に[OK]が薄く表示され、変更することができません。 「新しいメンテナンスプラン」で作成しようとしても同様です。 ※画面を添付しました。 ウィザードからは作成出来ますが、拡張子をbakとtrn二つ指定したいので、ウィザードでbakを指定して 変更からtrnを追加しようとするのですが、同様に[OK]が薄くなってしまいます。 さらに追加したタスクは「接続マネージャが指定されていません。」となってしまいます。 何か設定がおかしいのか、変更や追加は出来ない仕様なのでしょうか?
初めまして。こんにちは。 アクセスのファイル（mdb）が重いので どうすればいいのか他サイトでご相談したこところ、 「ＳＱＬサーバーに移行するのがいい」とのご回答をいただきました。 ただ、 ＳＱＬサーバーというもののメリットやイメージがいまひとつわかりません。 テーブルデータ以外はそのままMDBファイルに入れて、 テーブルのみを別ファイルに移行するリンクテーブル（be.mdb）と同じようなものなのでしょうか？ よろしくお願いします。
SQL-Serverに作成したテーブルのCreate文を ツールや既存昨日で作成する方法がありましたら教えてください。 よろしくお願い致します。
Excelで作成したテーブル定義書から、自動的にDBのテーブルを 作成したいのです。 何かよいフリーウェア、または参考情報があれば教えてください。 よろしくお願いします。
最近ＳＱＬサーバー言うものを知りました。 現在アクセスで管理しているものをＳＱＬサーバーに移行したく、 Microsoft SQL Server 2005の無料版をインストールしたのですが 全く使い方がわかりません。 なのでＳＱＬサーバーの知識について習得するためにサンプルで練習したいのですが そういったものをダウンロードできますか？ （アクセスのサンプルならいくつかダウンロードしてＶＢＡコードを見たり、練習したことはあります。） よろしくお願いします。
SQLServer2005でテキストファイルをテーブルに取り込もうとしているのですが、フラットファイルの列の定義（型など）がうまく出来ず、インポートできません。フラットファイルとテーブルの定義があっていないため、「型があっていない」「切り詰められる」等のエラーがたくさん出ます。 以下のような手順で作業しています。 ・適当なテーブル、Table1を作成。 ・Table1はCol001（int)、Col002(numeric(18,0))、Col003(tinyint)がある（複雑な列定義は一切無し） ・Table1にテストデータを2、3件作成する。 ・Table1の内容をTEXTファイルとしてエクスポートする。 ・Table1の内容をクリアする。 ・TEXTファイルをTable1にインポートする。 ↑ このインポートの際、データソースはフラットファイルソースを選択しています。カンマ区切りのフラットファイルです。テーブルの列数とも合っています。フラットファイルを指定した際、画面下に「この接続マネージャには列が定義されていません。」という警告メッセージが表示されます。いろいろ調べましたが、どうしてよいのかわかりません。 お分かりの方いらっしゃいましたら御教示下さい。 尚、情報が足りない場合御指摘頂ければ補足をします。 宜しく御願い致します。
有効期限を設定して日数が経過してもバックアップファイルは自動では消えないのでしょうか？ 不要なバックアップを自動的に削除する為には、毎回ファイルを作成するのではなく、 一つのファイルに追加していくと、ファイル内から期限切れのバックアップが消えていくのでしょうか？ 試せばいいのでしょうが、期間を一日にしても結果が判るのが月曜日になってしまい、 週末を悶々としてすごさないといけないので質問しました、よろしくお願いします。
・環境 WindowsXP Pro SQL Server2005 はじめまして。 Transact-SQLのBULK INSERTで、エラー(ファイルが存在しない等)が発生した場合に、専用の処理を行いたいと思っています。 ※BULK INSERTでエラーが発生したら、リターンコード100を返す等の処理を行いたいと思ってます 私の方で試したのは、BULK INSERTをBEGIN TRYでネストしエラーキャッチを行おうと思いましたがキャッチできず困っております。 以下、質問させてください。 　・BULK INSERTのエラーはエラーキャッチできないのか？できる場合その方法は？ 　・エラーキャッチできない場合、他の方法でBULK INSERTエラー時の処理を行う方法はあるのか？ お手数ですが、よろしくお願いします。
お世話になっております。Sql初心者でUpdate文の書き方で困っております。ご教授の程宜しくお願い致します。 下記のような２つのテーブルがあります。 関係はTotalが合計を表すテーブルでDetailが明細を表すテーブルです。OTとNoの組み合わせで一意となります。TotalテーブルのTotalAmountはDetailテーブルのAmountの合計です。 行いたいUpdateは『TotalAmountとTotalの合計が合わないもののみTotalAmountをOTとNoで紐ずくDetailテーブルのAmountの合計で更新する』です。 ■テーブル名：Total ------------------------------------------------------- 列名) OT No TotalAmount ------------------------------------------------------- 20 100000 0 20 100001 0 20 100002 10 ■テーブル名：Detail ------------------------------------------------------- 列名) OT No Amount ------------------------------------------------------- 20 100000 10 20 100000 10 20 100001 20 20 100001 30 20 100002 5 20 100002 5 ■作成したSql update Total set TotalAmount = (select Sum(Amount) from Detail Inner Join Total on Detail.OT = Total.OT and Detail.No = Total.No group by Total.TotalAmount,Total.OT,Detail.OT,Total.No,Detail.No having Total.TotalAmount <> sum(Detail.Amount) ) where OT = (select OT from Detail) and No = (select No from Detail) and TotalAmount <> (select sum(Amount) from Detail) いろいろ試行錯誤しながら作成しましたが『サブクエリは複数の値を返しました　～　』というエラーが出てしまいます。 つっこみどころ満載だと思いますがご教授の程宜しくお願い致します。
SQLServer2005を使っています。 あるテーブルにデータが並んでいるのですが これらのデータのパーセンタイル値を入れることは可能でしょうか。 ↓のようにデータを入れたいです。 Data　パーセンタイル値 10　　　0.166666667 20　　　0.333333333 30　　　0.5 40　　　0.666666667 50　　　0.833333333 60　　　1 宜しくお願いします。
データベースに、例えば辞書に載っている単語が1000万件分入っているデータベースがあるとします。 このデータをあいうえお順に昇順にソートした上で、500万番目から30個のデータ(つまり、5,000,000番目～5,000,029番目)までのデータを取り出したいです。 このようなケースで検索がもっとも高速になるSQL文の書き方はどのような描き方になるのでしょうか？ SELECT keyword FROM table ORDER BY keyword OFFSET 5000000 LIMIT 30 と書いたのですが、すごく遅いです。OFFSETが0であればとても速いです。
SqlServerで大量データ(一万件とか)のインサートを行うには どんな方法がありますか？ エクセルにエクスポートした後コピー（ドラッグ）して件数を増やし インポートしようとしましたが、 エクスポートした件数分しかインサートされませんでした。 みなさん、どんな方法を使ってますか？ 教えてください！ よろしくお願いいたします。
SQL Server 2008 Standard を導入しました。 バックアップでイマイチ疑問が解消できないので教えて下さい。 また、こんなふうにするべきだと言う方法があれば教えて下さい。 （そんなに大きなＤＢは扱いません） バックアップの方法を下記のようにするつもりです。 完全 ・・・ 毎月一日 差分 ・・・ 毎週月曜日 トランザクション ・・・ 毎日 ＜１＞ 有効期限を「0日」にしてあるのですが、これでは永久にバックアップが膨らみ続けるのでしょうか? 要は、完全バックアップが正常に終わったら、それまでのバックアップは不要ですよね? 不要なバックアップをバックアップセットから消すことはできないのでしょうか? 同様に差分バックアップが正常に終わったら、トランザクションバックアップも消したいです。 ＜２＞ トランザクションログは前回バックアップした時点以降のログが残っていると考えています。 前日にトランザクションバックアップ（Ａ）をして、当日に差分バックアップ（Ｂ）をし、 その後当日のトランザクションバックアップ（Ｃ）をした後、障害が発生したとすると、 先ず完全と差分Ｂで復元しＣと最新のログで復旧させると思うのですが、 ＢとＣは一部被っている時間が有るはずなんですが、この辺は大丈夫なんでしょうか？ （時間的にＡとＢの間で追加したデターはＢにもＣにも載っているはず）
DELETE FROM テーブル1;DELETE FROM テーブル2; といった方法でなく DELETE FROM テーブル1 AND DELETE FROM テーブル2; といった風に、二つの文を一つの文で実行する方法は ありますか？ 分かる方がいましたら。よろしくお願いします。
Access2000 + SQL SERVER2005 でシステムを開発したいと思っております。以前はAccess2000 + MSDEでシステムを開発していたのですが、そのときには、SQL DMOを利用して新規データベースの作成と接続を行っていました。SQL SERVER2005 からはSMOを利用すれば良いようなのですが、モジュールの参照設定でどのファイルを参照したらいいのか分かりません。Programfiles\90\SDK\assemblies\の中のdllを直接参照しようとしてもエラーが発生してしまいました。どのようにしたらいいのかご教示いただければ大変助かります。どうぞよろしくお願いいたします。
教えていただきたいのですが、先日１００均でパソコン用CD-RWを買ってきました.早速USBからデ-タを書き込もうとしましたが、できませんでした。そのCD-RWにはデ-タの記録には対応のライタ-が必要ですと書いてあるのですが、それがないとできないということでしょうか。 ライタ-とは何のことでしょうか
　はじめまして。 　携帯で検索・閲覧出来るデータベースを構築したいと思うのですが、 何を用意して、どのようにすれば良いのかわかりません。 イメージとしては、自社の沢山の商品の中から「ジャンル」や「価格帯」で検索したり、フリーワードで検索すると、詳細商品ページへのリンクを一覧表示してくれる感じです。 詳細商品ページでは簡単な口コミ掲示板を設置したいのですが、これはCGIになるのでしょうか？欲を言えば各お客様に評価点を入力して頂き、平均点を出し見せていきたいのですが、このような機能も作れるものなのでしょうか？ 実現方法やツールなどを教えて頂けると嬉しいです。 　データベースやCGIなど超初心者で、質問内容も分かりやすく書けず、申し訳ありません。何から勉強して手をつければ良いかも分からない状況で大変困っており、皆様のお知恵を拝借できればと思います。 よろしくお願いいたします。
SQLServer2005を使用しています。 これまで、各フィールドの照合順序を指定しないで＜データベースの規定値＞でのデータベースを利用してきました。 これからは照合順序を指定してデータベースを利用することになったのですが、元々作成してあったテーブルと、照合順序を指定するようになってから追加したテーブルをJOINで結合して取得しようとしたところ、「照合順序の競合を解決ができません」という旨のエラーが出ました。 照合順序を統一すれば問題が無くなる？と考えています。 新しく指定しようとしている照合順序はJapanese_90_BIN2で、規定値で使用していた照合順序はJapanese_BINのようです。 簡単に統一できる方法はあるのでしょうか？
開発環境はvb6, SQLサーバ2000です。 下記のようなテーブルから実行結果に記入してある結果を得れるようなユーザ定義関数をおしえていただきたいです。 分類マスタ(KEY=分類CD) -------------------------------------------- 分類CD　 |分類名　 -------------------------------------------- 1　　　　|魚類　　　| -------------------------------------------- 2　　　　|野菜　　　| -------------------------------------------- 3　　　　|牛肉　　　| -------------------------------------------- 4　　　　|豚肉　　　| -------------------------------------------- 親テーブル(KEY=会員CD) -------------------------------------------- 会員CD　 |会員名　|出身地　| -------------------------------------------- 1　　　　|田中　　|大阪　　| -------------------------------------------- 2　　　　|佐藤　　|東京　　| -------------------------------------------- 3　　　　|中井　　|鹿児島　| -------------------------------------------- 子テーブル(KEY=会員CD, 枝番) -------------------------------------------- 会員CD　 |枝番　 |分類CD　 |処理日 -------------------------------------------- 1　　　　|1　　　|1　　　　|1/1 -------------------------------------------- 1　　　　|2　　　|2　　　　|1/2 -------------------------------------------- 1　　　　|3　　　|2　　　　|1/3 -------------------------------------------- 1　　　　|4　　　|4　　　　|1/4 -------------------------------------------- 1　　　　|5　　　|2　　　　|1/5 -------------------------------------------- 1　　　　|6　　　|3　　　　|1/6 -------------------------------------------- 1　　　　|7　　　|4　　　　|1/7 -------------------------------------------- 2　　　　|1　　　|1　　　　|1/1 -------------------------------------------- 2　　　　|2　　　|2　　　　|1/2 -------------------------------------------- 2　　　　|3　　　|1　　　　|1/3 -------------------------------------------- 2　　　　|4　　　|1　　　　|1/4 -------------------------------------------- 2　　　　|5　　　|4　　　　|1/5 -------------------------------------------- 2　　　　|6　　　|1　　　　|1/6 -------------------------------------------- 2　　　　|7　　　|4　　　　|1/7 -------------------------------------------- 3　　　　|1　　　|3　　　　|1/1 -------------------------------------------- 3　　　　|2　　　|3　　　　|1/2 -------------------------------------------- 3　　　　|3　　　|3　　　　|1/3 -------------------------------------------- 3　　　　|4　　　|4　　　　|1/4 -------------------------------------------- 3　　　　|5　　　|4　　　　|1/5 -------------------------------------------- 3　　　　|6　　　|4　　　　|1/6 -------------------------------------------- 3　　　　|7　　　|2　　　　|1/7 -------------------------------------------- これら三つのテーブルを連結し、尚且つユーザ定義関数を使用し、下記のような結果を得たいです。 -------------------------------------------------- 会員CD　|会員名　|魚類　|野菜　|牛肉　|豚肉　| -------------------------------------------------- 1　　　 |田中　　|1　　 |3　　 |1　　 |2　　 | -------------------------------------------------- 2　　　 |佐藤　　|4　　 |1　　 |0　　 |2　　 | -------------------------------------------------- 3　　　 |中井　　|0　　 |1　　 |3　　 |3　　 | -------------------------------------------------- 要は、親テーブルの会員をベースに、子テーブルに登録されている情報を分類CD単位で集計し、横に展開し、１レコードで保持したいと思っています。 わかりにくい文とは思いますが、どうか教えていただけますようよろしくお願い致します。
ストアドの中でSELECT文を発行してその出力結果を元に次のSQL文を作成したいと思っています。そこでSQL文の出力結果をACCESSから呼んだ時の様にRECORD　SETの処理の様な記述をしたいと思っています。そこでストアドの中で『SELECT [項目]　from XXXX』の [項目]を参照するにはどの様な記述をすればいいのでしょうか。宜しくお願い致します。
[OSのVER]:Windows Server 2003 SP2 (x64) [SQLServerのVER]:2005 Standard Edition SP3 お世話になります。トーシロです。 以下の現象で解決方法がわからず悩んでいます。 解決方法がございましたご教授頂けますでしょうか。 よろしくお願い致します。 状況： ・インスタンスAとインスタンスBがあります。 ・インスタンスAにリンクサーバーとしてインスタンスBを登録してあります。 ・インスタンスA.テーブルaにJDBC経由でデータをインサートします。 ・インスタンスA.テーブルaインサートトリガーXにて、 インスタンスB.テーブルbにデータをインサートします。 ・トリガーXはT-SQLで記述しています。 ・トリガーX内にBEGIN TRANSACTION、COMMIT TRANSACTIONを記述しています。 （記述しないとBEGINとCOMMITの対応数が違うという内容のエラーとなりました。） ・JDBC経由でのデータのインサートは一連のトランザクション内となります。 JDBC実装内容： 1.setAutoCommit(false) ↓ 2.executeUpdate()で複数回のインサート ↓ 3.commit() ↓ 4.例外発生時はrollback() ・ユーザはインスタンスA、インスタンスB共に「sa」を使用しています。 ・MSDTCは「開始」となっています。 上記状況で以下の操作をします。 1件目をインスタンスA.テーブルaにインサート→正常終了するデータをトリガーXにてインスタンスB.テーブルbにインサートします。 2件目をインスタンスA.テーブルaにインサート→制約違反が起きるデータをトリガーXにてインスタンスB.テーブルbにインサートします。 この際にエラーが発生しますが、インスタンスB.テーブルbの1件目のデータがロールバックされず、コミットされてしまいます。 インスタンスB.テーブルbの1件目のデータがコミットされないようにするには、どのような実装が必要になるのでしょうか。 （同一インスタンス内のテーブルではロールバックされます。） 以下実行時エラーです。 2パターンがランダムに出力されました。 パターン1： Error Code：1206 SQL State：S000118 com.microsoft.sqlserver.jdbc.SQLServerException: Microsoft 分散トランザクション コーディネータ (MS DTC) により、この分散トランザクションがキャンセルされました。 at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(Unknown Source) at com.microsoft.sqlserver.jdbc.IOBuffer.processPackets(Unknown Source) at com.microsoft.sqlserver.jdbc.SQLServerStatement.sendExecute(Unknown Source) at com.microsoft.sqlserver.jdbc.SQLServerStatement.doExecuteUpdate(Unknown Source) at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.executeUpdate(Unknown Source) at TestInsert.write(TestInsert.java:86) at TestInsert.main(TestInsert.java:43) パターン2： Error Code：3971 SQL State：S0001 com.microsoft.sqlserver.jdbc.SQLServerException: サーバーはトランザクションを再開できませんでした。説明: 3400000002。 at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(Unknown Source) at com.microsoft.sqlserver.jdbc.IOBuffer.processPackets(Unknown Source) at com.microsoft.sqlserver.jdbc.SQLServerConnection.connectionCommand(Unknown Source) at com.microsoft.sqlserver.jdbc.SQLServerConnection.sendRollback(Unknown Source) at com.microsoft.sqlserver.jdbc.SQLServerConnection.rollback(Unknown Source) at TestInsert.write(TestInsert.java:96) at TestInsert.main(TestInsert.java:43) 以上、よろしくお願い致します。
SQL Server2000です。 DB構築を行うにあたり、インストールで実行するクエリファイルから、 別のクエリファイル（実際にテーブル、ストアドを構築する内容を記述）を実行できる方法がわからず悩んでいます。 a.sql・・・b.sqlやc.sqlを統括するクエリファイル b.sql、c.sql・・・テーブル構成、ストアドを構築するクエリファイル SQL クエリアナライザからa.sqlのクエリファイルを開いて、 クエリ実行するイメージでいます。 a.sqlからb.sqlを呼び出すには、どのような記述をすればよろしいのでしょうか？ よろしくお願いします。
SQLSERVERでFOREIGN KEY 情報し、Aというテーブルがどのテーブルを参照しているのかをSQLで取得したいのですがどうすればよいのでしょうか？
お世話になります。 [SQL Server 2005]から[Oracle 10g]に対し、リンクサーバーを設定いたしました。 このリンクサーバー越しにテーブルを参照した所、参照できるテーブルとできないテーブルが、 起こってしまいました。 参照不可なテーブルを参照しようとしますと、 「メッセージ 7442、 レベル 16、状態 1、行 1 リンク サーバー "hoge" の OLE DB プロバイダ "MSDAORA" から返されたテーブル ""AAA"."BBB"" のインデックス定義が無効です。」 が、出てしまいます。 尚、このテーブルには主キーが設定されておりません。ユニークキーのみ設定されております。 [Oracle 10g]側のテーブル定義を変更することができませんので、何とか[SQL Server 2005]側での 対応方法をご存知の方は、ご教授頂けませんでしょうか。 ※主キーの張られておりますテーブルに対しては問題なく参照が行えます。 ご回答に際しまして補足が必要でしたら、お申し付け下さい。 よろしくお願いいたします。
SQLserver2005を使っています。 下記のようなテーブルがあります。 ID　処理番号　　日付　　　Data AA　　1　　　　2008/1/1　　10 AA　　1　　　　2008/1/2　　11 AA　　1　　　　2008/1/3　　12 AA　　2　　　　2008/1/4　　13 AB　　3　　　　2008/1/5　　14 AB　　3　　　　2008/1/6　　15 AB　　4　　　　2008/1/7　　16 この時に「IDと処理番号が一致した場合、日付の一番古い行を抜き出す」 という条件でデータの抽出をすることは可能でしょうか 結果は下記のようになります。 ID　処理番号　　日付　　　Data AA　　1　　　　2008/1/1　　10 AA　　2　　　　2008/1/4　　13 AB　　3　　　　2008/1/5　　14 AB　　4　　　　2008/1/7　　16 下のような命令文を作ったのですが、 「Data列」が抜き出せません。 select ID,処理番号,min(日付) from テーブルA Group by ID,処理番号 一度上の命令文でテーブルを作って元のテーブルとマッチングさせるしかないのでしょうか？出来れば一発で抜き出したいです。 ご教授宜しくお願いします。
調べてもなかなかわからないので質問します。 VS2008上でC#のプログラムを作っています。 データベースをdatasetし、そのレコードを加工して、変更されたデータベースを別のファイルとして保存するというのをボタン1クリックでしたいと思っています。 マウスを使ってデータベースを作ったりするのはわかるのですが、変更されたデータベースをプログラムで別ファイルに保存する方法などがよくわかりません。 まとめますと、 1．1レコードごとに判定でデータを加工する方法（手順） 2．変更されたデータベースを別ファイルで保存する方法 を教えていただきたく思います。 ヒントなり参考サイトなりを教えていただけるだけでも助かります。お願いします。
DTSのエクスポート／インポート機能を使って静的なデータベースを 作成しようと考えてます。 ただ読み込み元のDBには、共有ロックなどの影響は、与えたくなく DTSを用いた場合の読み込み元のDBに対する影響について教えて頂けるとありがたいです。 よろしくお願いいたします。
宜しくお願い致します。 セッション変数に格納されている配列をSQLデータソースのパラメータとして利用するにはどのようにしたらいいのでしょうか？？ 普通でしたら sqldatasource1.selectparameters("**").defaultvalue = session("**") といった感じで条件としてのパラメータを適用できるかと思いますが、 複数となるとどのようにしたらいいのかが分からないので、質問させていただきました。 また、“session”（配列） に関しても複数ある場合ですと記述方法がいろいろ変わってくると思いますので、何かいいアドバイス等ございましたら、教えていただけたらと思います。 どうぞ宜しくお願い致します。
平成20年 春期 基本情報技術者 午前 問58 の問題の解説をお願い致したく思っております。 どうしても、なぜ『エ』が不正解なのか、分かりません。 宜しくお願い致します。 ---------- 問58　“社員”表から，職務がプログラマである社員が５人未満の部署の部署コードを探すSQL文として，適切なものはどれか。ここで，“社員”表は次の構造であり，各列にはナル値は含まれないものとする。 社員（社員番号，社員名，部署コード，職務） ア SELECT DISTINCT 部署コード FROM 社員 S1 　　WHERE 5 > (SELECT COUNT(S2.社員番号) FROM 社員 S2 　　　　　　　　WHERE S1.部署コード = S2.部署コード 　　　　　　　　AND S2.職務 = 'プログラマ') イ SELECT DISTINCT 部署コード FROM 社員 S1 　　WHERE 5 < (SELECT COUNT(S2.社員番号) FROM 社員 S2 　　　　　　　　WHERE S1.部署コード = S2.部署コード 　　　　　　　　AND S2.職務 <> 'プログラマ') ウ SELECT DISTINCT 部署コード FROM 社員 S1 　　WHERE EXISTS (SELECT * FROM 社員 S2 　　　　　　　　WHERE S1.部署コード = S2.部署コード 　　　　　　　　AND S2.職務 = 'プログラマ') 　　GROUP BY S1.部署コード HAVING COUNT(*) < 5 エ SELECT DISTINCT 部署コード FROM 社員 S1 　　WHERE S1.部署コード IN (SELECT S2.部署コード FROM 社員 S2 　　　　　　　　WHERE S1.部署コード = S2.部署コード 　　　　　　　　AND S2.職務 = 'プログラマ' 　　　　　　　　GROUP BY S2.部署コード HAVING COUNT(*) < 5)
素人なのでうまく説明できないかもしれませんが、どうぞ宜しくお願い致します。 ASP.NETのCheckboxlistコントロールで取得した値をSQLデータソースコントロールに渡すにはどのようにしたらいいでしょうか？？ 複数のチェックボックスリストを配置し、それぞれのチェックボックスリストで選択されているものに該当するもの、チェックしている条件全てを満たすものをデータベースから取得し、GridViewで表示したいのですが、どのようにコードの部分を書いたらいいのか見当がつきませんでしたので、詳しい方に教えていただけたらと思っておりました。 特に分からないのが、一つのチェックボックスリスト内で1つしか選択できないのであれば、その値をセッション変数に入れてデータソースコントロールに渡すことができるのですが、複数個を指定することができる状態だと複数のセッション変数に入れる事になり、その際にデータソースコントロールにデータを渡すとなるとどのようにしたらいいのかが分かりません。 と言っても現状で思いつく方法がこれ位で、詳しい方からすればもっと良い方法があるかもしれませんので、上記の事柄を行う良い方法があったら是非御教授いただけたらと思っております。 宜しくお願い致します。
SQLserver2005の Management Studioで データベースコピーウィザードを使用して別サーバに データベースをコピーしたいのですが、最後の 「エージェントジョブの実行」でエラーがでてうまく できません。 「デタッチ後にアタッチする方法を使用する」で実行し ログを確認すると、 「転送元のサーバーでのファイル共有」で指定した フォルダの.mdfへのアクセスが拒否されました。 となっています。 フォルダの共有でEveryoneにフルコントロール許可は してあるのですが、よく分かりません。 当方SQL文の知識はありません。 解決方法の心当たりがある方は教えてください。
LAN上にSQLServerがあるのですが、 リモート（XP）からSQLServer Enterprise managerを使用してLAN上のDBにアクセスすることは可能でしょうか？ つまりXP上にSQLServer Enterprise managerのようなソフトでDBを監視したいのですが。
http://msdn.microsoft.com/ja-jp/library/ms181765 … …などを見ますと、どうもできそうに無いと思いますが、質問させて頂きます。 例えば、 SELECT * FROM (CASE WHEN @FLG=0 THEN t当月集計 ELSE t累積集計 END) AS t請求残 …のように、FROMの中でCASEが使えると便利なときがあります。 エラーが出ますが、このような書き方はできないのでしょうか。
データベースのバックアップをとって、それを使って復元しました。 「復元は正常に完了しました。」と表示されました。 そして、データベースを見ると データベース名（復元しています）と表示され内容を見ることができません。 sqlserver2005 データは1GBぐらいです。 1時間くらい待っても（復元しています）がとれません。 時間がかかるものなのか、エラーなのかどちらでしょうか？
番号1ごと金額の合計をグループ化して更新をしたいのですが、 select文で表示することは出来るのですが、追加ができません。 （where 区分が0の区分と1の区分を求める） 「数値項目」に更新するためにはどうすればいいのか ---------------------------------------------- ちなみに累計も求めたいのですがどうしたらよろしいですか？ 求めたい累計は 番号1ごとに(区分0 - 区分1)の結果の累計 累計も同様に番号1ごとにグループ化 これを実行するとサブクエリがと出る update W_i set 数値 = ( select 番号1,sum(金額) from T_i where 区分 = '0' group by 番号1
お世話になります。 下記の記述がエラーになってしまいます。 「ＮＹ」の辺りがおかしいのですが、どう記述したら良いのか ご教示頂きたく宜しくお願い致します。 　　　　　　　　記 mySQL = "INSERT INTO ZAIKO(ID, HINBAN, HINMEI, QTY, DATE) " & _ 　　　　"VALUES ('"NY" &"'" & objForm.GetField("品番") & "'" & _ 　　,' & objForm.GetField("品番") & "'" & _ 　　, & CLng(objForm.GetField("数量")) & _ 　　,' & Date & " " & Time & "')"
はじめまして。 初心者でまだよく理解できていないのですが、 よろしくお願いします。 教えていただきたいことは テーブル　受講履歴 出席番号　氏名　教科1　教科2　教科3　　 ――――――――――――――――――― 　1001　　　　山田　　　　2　　　　3　　　　5 　1002　　　　武田　　　　4　　　　2　　　 　1003　　　　斎藤　　　　5　　　　1　　　　 　1004　　　　山本　　　　5　　　　3　　　　2 　1005　　　　鈴木　　　　3　　　　1　　　　 テーブル　教科 教科ID　教科名 ――――――― 　　1　　　国語 　　2　　　数学 　　3　　　理科 　　4　　　社会 　　5　　　音楽 といったテーブルがあったときに、出席番号を指定すると 氏名、教科1、教科2、教科3を取得するSQLを教えて頂きたいです。 たとえば出席番号1002にした場合、 　氏名　教科1　教科2　教科3 ―――――――――――――― 　武田　　社会　 数学 といった感じです。 よろしくお願いします。
はじめまして。 SQL Server（Analysis Service）初心者ですが、よろしくお願いします。 現在、Analysis Service（SQL Serverのデータを使用）に接続し、データを表示するアプリケーションがあります。 今回、DBにログインするユーザーによって、表示データの制御が出来ないか考えています。 例えば、Analysis Service（キューブ）に都道府県毎のデータが登録されていた場合、東京のユーザーは東京のデータのみ。大阪のユーザーは大阪のデータのみ。 と言った感じで、SQLのWhere句の条件を各ユーザー毎に設定できれば と考えています。 ご存知の方、または答えらしき内容が出ているサイトを 知っている方がいましたら、教えていただけないでしょうか。 よろしくお願い致します。
はじめまして。SQLSERVERへのODBC接続がうまくいきません。 初心者ですがよろしくお願いします。 自宅に2台のPCがあり、LAN接続できるようになっています。 (2台ともWindowsXP HomeEdition SP3です) 1台のPCにSQL SERVER2005をインストールしてリモート接続等の環境設定を行いました。 そのサーバーに別のPCからSQL Server Management Studio Expressを利用して接続できることを確認しました。 (テーブルも作成してみました) また、別のPCからEXCELのVBAでADODBを利用して、そのテーブルのデータを取得できることも確認しました。 しかしながら、ODBCのデータソース作成がうまくいきません。 ●ドライバ 　SQL Server バージョン：2000.85.1132.00 ●エラー内容 　[ODBC SQL Server Driver][TCP/IP Sockets]指定されたSQL Server 　が見つかりません。 　※最初はアクセスが拒否されましたみたいなエラーが出ていた 　　ような気もするのですが・・・ ドライバにSQL Native Client Version09.00.2047を使ってみても、「サーバー接続の確立時にエラーが発生しました」となってしまい接続できませんでした。 ODBCを利用する場合には、何か特別な設定等が必要なのでしょうか？ よろしくご教授お願いします。
下記のようなテーブルがあります。 ID　　aaa　　bbb 10　　A01 11 12　　　　　　B01 13　　A02 14　　A03　　B02 ・IDは，主キー（レコードの登録時に，IDENTITYで自動的に取得） ・aaa，bbbは，任意のタイミングで入力や編集があるが，ユニーク性を保ちたい ・aaa，bbbの入力に関しては，下記のようなテーブルを作って自動採番にしたい Category　　Last_No 　　A　　　　　03 　　B　　　　　02 (1)データベース側にて，aaa，bbbにユニークインデックスを設定すると， Null値に関しても重複違反になってしまったのですが， これは，そういうものなのでしょうか？ (2)ユニークインデックスが設定できない場合に， Null値以外の値が，ユニークである事を保つためには， どうすれば良いのでしょうか？ 自動採番だけでなく，編集も有り得るため，悩んでいます。 （編集は，A01-1のように，枝番を付ける場合が多いです） 以上，どなたかご教示願います。
お世話になります。 下記環境におきまして、SQL ServerよりOracleへリンクサーバーを作成しようとしたところ、 「リンクサーバー"XXX"のOLE DB プロバイダ"MSDAORA"のデータソースオブジェクトを初期化できません。 リンクサーバー"XXX"のOLE DB プロバイダ"MSDAORA"から、メッセージ"Oracle"クライアントと ネットワークコンポーネントが見つかりません。これらのコンポーネントはOracle Corporationから提供され、 Oracle Version 7.3.3(またはそれ以降)のクライアント ソフトウェアの一部としてインストールされます。 プロバイダは、これらのコンポーネントがインストールされるまで機能しません。"が返されました。 (Microsoft SQL Server,エラー:7303)」 となり、作成に失敗してしまいます。 SQL Serverには10gのOracleクライアントをインストールしてあるのですが、原因がわかりません。 どなたか、同じ原因を経験され、解決された方はいらっしゃいますか。 もし、お分かりでしたら、ご教授頂きたいのですが。 よろしくお願いいたします。 尚、SQL Serverは運用の関係上、Oracleクライアントインストール後、再起動は行っておりません。 環境 OS：Windows2003 DB：SQL Server 2005 Oracle：10g
以下の条件を取得したいのですがどのようなSQLを組めばいいか悩んでます。 テーブルA(列はC1,C2,C3,C4 PKはC1,C2です。） ■テーブルAのデータ C1　　C2　　　C3　　　C4 1 　　1 　　50 　　備考1です。 1 　　2 　　75 　　備考2です。 2 　　1 　　25 　　備考3です。 3 　　1 　　75 　　備考4です。 3 　　2 　　90 　　備考5です。 3 　　3 　　50 　　備考6です。 ■取得したい結果 C1　　C2　　　C3　　　C4 1 　　2 　　75 　　備考2です。 2 　　1 　　25 　　備考3です。 3 　　2 　　90 　　備考5です。 ■取得したい条件 C1でグルーピングしたなかでC3の値が一番大きな行を取得する。 現在は以下のようなSQLを書いています。 SELCT T1.* FROM テーブルA T1, (SELECT C1,MAX(C3) AS C3MAX FROM テーブルA　GROUP BY C1) T2 WHERE T1.C1 = T2.C1 AND T1.C3 = T2.C3MAX もう少し簡単なSQLで出来そうですが、うまく思いつきません。 宜しくお願いします。
会社で使っているＰＣでACCESSをインストールして欲しいと言われ、インストールしました。しかし、おそらくサーバとのデータのやりとりをするのが目的なのか、ファイルを開くとODBC接続ができませんといった内容のエラーが出てうまくいきません。小さな会社でパソコンに詳しい人・解決法を知っている人がいません。 私もパソコンは使える程度で、詳しいことはわかりません。また、システム関係を委託している協力会社の担当者が病気がちとの事で連絡もとれない状況で、どうすればいいか困っています。 なにとぞ、お知恵をお貸しいただきたいです 　OS：WINDOWS XP サーバ：３台が稼働中(おそらくＳＱＬサーバ） 　ACCESSのバージョン：2000
システム構成チェック ハードウェアの最小要件（警告） 現在のシステムはこのＳＱＬ　SEVERリリースの推奨されるハードウェア要件をみたしていません。 上記のメッセージがでてしまいます。 全く素人なのでどうしたらいいのか、とても困っています。 どなたか教えて下さい。
エクセルｖｂａのＡＤＯを使って、 SQL Serverの「test」という名のデータベースの「Table_1」に 新規レコードを追加する事はできますか？ エクセルからアクセスには Sub test() Dim データベース名 As String Dim cn As ADODB.Connection Dim rs As ADODB.Recordset Set cn = New ADODB.Connection Set rs = New ADODB.Recordset cn.Open "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & データベース名 rs.Open "Ｔテーブル１", cn, adOpenKeyset, adLockOptimistic rs.AddNew rs.Fields("フィールド１") = データ rs.Update rs.Close cn.Close Set rs = Nothing Set cn = Nothing End Sub で移行しています。 これをエクセルからSQL Serverへ移行させるにはどうすればいいのでしょうか？ よろしくお願いします。
お世話になります。 いい知恵や参考文献などありましたら、ご教授下さい。 開発環境の作り方はどうしたらいいでしょうか？ サーバーはＳＱＬＳｅｒｖｅｒ２００５です。 サーバーの用途は基幹系ではなく情報系として使用しており、実績がたくさん入っています。 そして本番環境から開発環境を簡単に作成したいと考えています。 方法として考えられるのはデータベースのコピー（バックアップファイルからの戻し）ですが、 これでは本番環境と同じ容量の開発環境が必要になってしまいます。 開発環境は本番環境よりも容量が小さく、本番環境にはすぐには使わない古い実績も入っているため、 それらは開発環境には必要ありません。 理想としては、データベースのコピーをする際に、オプション機能として、 ●特定のテーブルの件数を指定する。 ●WHETE文（年月が2008/4以降）の条件式を加える。 ができればいいのですが・・・。 何かいい方法はありませんでしょうか？ 時間はかけたくないので、３０分ほどの準備作業で終わらせたいです。 尚、以下は考えておりません。 ●ソースからテーブルやストアドなどを順に作成して、データを移す。 ●本番環境のデータを開発環境に合わせて絞ってもつ。 ●開発環境を本番環境と同じものにする。 何年もＤＢを触っていながら素人同然の質問ですが、よろしくお願いします。
T1(項目a&b) T2(項目c&d) というテーブルが存在しており、下記のような形でデータが存在しています。 T1 a | b ========== 1 | jj 2 | kk 3 | ll T2 c | d ========= 1 | a1 2 | a2 3 | a3 T1(a)とT2(c)で結合させて、b を d の値で書き換える場合は、どのように記述したら良いのかご教示下さい。 update T1 set b = 'ok' where a in ( select c from T2 where d = 'a2') というように、固定で項目を書き換える所までは出来たのですが、後一歩が上手くいきません。
こんにちは、DTS初心者です。 ストアドプロシージャーよりパラメータを渡して DTSを起動しておりますが、 DTSでCSVファイルを出力するさいに、 その指定したパラメータのパスで出力したいのですがうまくいきません。 現状は、 Text File(Destinetion)のプロパティの ファイル名を 「@パラメータ名」としてます。 パラメータ名はグローバル変数として定義してます。 動的にファイル名を変えたいのですが 方法をご存知でしたら教えてください。
vistaを使用しているのですが SQL Server　2000、2005、2008の３つをインストールすることは可能でしょうか？ 1つしか無理でしょうか？ ３つヴァージョンを使い慣れたいために3種類入れたいのですができますでしょうか？ よろしくお願い致します。
お世話になります。 SQLServer2008のエディションのアップグレードにつきましてご存知でしたら教えてください。 例えばWorkgroupからEnterpriseへエディションのアップグレードを行いたい場合、インストール媒体をいれると「SQL Server インストール センター」が表示され「エディションのアップグレード」を実行するだけで、Workgroupで使用していたDB情報はEnterpriseへ移行され、Enterpriseの機能(ミラーやssis等)は全て使用できるのでしょうか？ それともエディション変更後、再度Enterpriseの媒体から必要な機能を追加していかなければならないのでしょうか？ MSサイトにはエディションのアップグレード方法しか記述されていなく詳細がわかりませんでした。 (まだ媒体もなく試せませんでした) また注意事項等ございましたらあわせてご教授ください。 よろしくお願いいたします。
SQL Server 2005のバックアップをARCserveとそのSQL Agentを 利用して取得しようと考えています。 システムが壊れてしまったときのことを考えて OS、SQL、AECserveを入れなおしてAECserveで取得した バックアップを戻せばSQLが元通りに使えるようにしたいと 考えています。その場合利用しているDB領域のほかに バックアップを取得しておく必要のある領域はあるのでしょうか。 ご存知の方、または答えらしき内容が出ているサイトを 知っている方がいましたら、教えてください。
SQLServerのフロントエンドとしてACCESSを使用しDBを参照しています。 SQLServerには、5つのテーブルを用意しています。 1つのテーブルは変更も追加も出来るのですが他のテーブルが参照のみとなってしまって困っています。 何が問題なのか、ご存知の方教えて頂けますでしょうか。 環境 SQLServer2005Express Access2002 よろしくお願いします。
SQL　Serverについては全くの初心者のため、とても初歩的な質問で恐縮ですが、ご教示頂きたくお願い致します。 Win2003Server上で、某アプリケーションによりクライアントＰＣの操作ログ等をSQLデータベースとして記録されていきます。 毎日データは増え続けるわけですが、SQLのデータベースって、一体どれぐらいの容量まで、問題なく試用できるものなのでしょうか？ アプリケーションがデータベースを作っていますので、インデックス等はきっちり作成されているものと仮定して頂いて結構です。 一般的には、データベースの容量には特に限界なしとネット上の情報でありますが、（MSの制限では、TBレベルではあるようですが） よろしくお願い致します。
下記テーブルで登録NOの若い順に項目の種類分値をとりだしたいのですが どのようにＳＱＬを書けばいいでしょうか。 テーブル 項目................|登録NO ---------------------------------------------------------------- オルタネータ................|TOUROKU00110 オルタネータ................|TOUROKU00111 オルタネータ................|TOUROKU00112 オルタネータ................|TOUROKU00113 ミッション.......................|TOUROKU00100 ミッション.......................|TOUROKU00101 イグニッションコイル|TOUROKU00099 イグニッションコイル|TOUROKU00098 抽出結果 イグニッションコイル|TOUROKU00098 ミッション.......................|TOUROKU00100 オルタネータ................|TOUROKU00110 環境 OS:Windows XP DB Microsoft Sqlserver
access[2002-2003] sqlserver[2005] 私、勤めている会社で販売を担当している者でございます。業務を行う上で顧客管理の為に、accessを利用したデータベースを以前より利用しております。ですが、どうしても追加したいデーブルがありまして、新しいテーブルをSQLサーバーの方に登録するところまではできたのですが、それをaccess側でリンクテーブルとして登録の仕方が分からずにおります。前任者退職の為、周りには知識のある人がおらず、いろんな本や、インターネットで検索などして調べて自力でなんとか新しいリンクテーブルを登録しようとしてみたのですが、結局初心者の私にはどのように登録すればよいのか全くわからず登録できずにおります。お手数ではございますが、どなたかaccess側にSQLサーバーに登録しているテーブルをリンクテーブルとして登録する方法をご教授頂けませんでしょうか。何卒宜しくお願い致します。
開発環境　 Xp Home Edtion Microsoft Visual C++ 2008 Express Edition Microsoft SQL Server 2005 int i=0; String^ str1; sSqlConnection^ sqlConn = gcnew SqlConnection("Data Source=.\\SQLEXPRESS;AttachDbFilename=C:\\SOUTUKEN\\test.mdf;Integrated Security=True;User Instance=True");qlConn->Open(); str1= "SELECT NoID FROM Table1 WHERE hentou IS NULL OR nyuryoku IS NULL"; sqlCommand^ sqlCmd=gcnew SqlCommand(str1,sqlConn); SqlDataReader^ exeReader=sqlCmd->ExecuteReader(); while(exeReader->Read()){ gyou[i]=exeReader[""]->ToString(); i++; } sqlConn->Close(); SELECT文でhentou,nyuryokuのどちらか一方でもNULLならばそのNoIDを取り出すということをしたいのですが、 "sqlCommandが定義されていない識別子です。"というエラーが出てきます。 SQL文が間違っていると思うのですがどのようにしたら良いのでしょうか何卒よろしくお願いします。
お世話になっております。 早速ですが、質問させていただきます。 ASP＋SQLServer2000で社内システムの作成などを行っております。 ASP上から社員がデータを打ち込んでいるシステムがあるのですが、同時にSELECT、UPDATE、INSERT、DELETEを一つのテーブルで行っております。 その際、SELECTとUPDATE、INSERT、DELETEの処理がかぶると画面が固まったように処理が長くなります。 自分でわかる限りの原因としては検索レコードは10万件くらいからやっているのですが、SELECTで検索中にINSER、UPDATE、DELETE処理がくるとウエイト状態になり、異常に時間がかかってしまい、タイムアウトしてしまっています。 INSERTやUPDATEが処理かぶっても特に処理はとまらないのですが、先にSELECT処理していてINSERTやUPDATE処理がくるとまったく動かなくなってしまうのです。 こちらの原因とか少しでもわかる方いらっしゃれば、お知恵をお貸しください。
アクセス2003のデータが日に日に多くなっていくため Microsoft SQL Server 2005へ移行したいのですがどうすればいいのでしょうか？ とりあえず「SQL Server Management Studio Express」をインストールしました。 そしてこれを起動すると画像のようなダイアログが出てくるのですが サーバー名には何と入れればいいのでしょうか？ それすらわからない初心者なのですが参考になるＵＲＬがあれば教えてください。 よろしくお願いします。
ACCESS2007をフロントにしてＤＢをSQL-Server2005Expressにして開発を 行おうとしています。 できる限りネットワークの負荷を減らそうと、ADO接続／ADOレコードセットと フォーム連結で開発したいのですが、ネットで検索するとADO接続を各画面で 行わなければならないような記述しか見あたりません。 　・検索キーワード：ADO 接続 共有 できれば、ADO接続はプログラム起動時１回で、ＤＢデータを表示する 画面等を開く場合は、起動時に取得した接続を使い回したいのですが、 当該方法が記載されたいるようなＵＲＬ等をご教示願えないでしょうか？ 　・他mdbのテーブルをリンクテーブルとして使用したいため、 　　AccessProject（.adp）の使用は断念しました。 上記よろしくお願いします。
WinServer2008にインストールされたSQLServer2008にクライアントから、sqlcmdコマンドでログインするとリモート接続が許可されてないのかログインできません。 別のWin2000ServerのSQL2005にはログインできます。 SQL2005には、セキュリティ構成というツールで、リモート接続を許可することができます。 SQL2008には、これに該当するツールが見当たりません。 ManagementStudioでSQL2008に接続して、データベースのプロパティの 「接続」を見ると、リモート接続を有効にするチェックは入ってますが、これは、SQL2005にもあり、sqlcmdで接続しようとすることと 関係ないように思いました。 sqlcmdでクライアントからSQL2008に接続するために、リモート接続するには、どうしたらよいのでしょうか？ win2008サーバー上で、sqlcmdコマンドを使えば接続できます。
開発環境はSQLサーバー2000、vb6です。 [MST_table_A] (都道府県マスター) _______________________ 都道府県CD　| 都道府県名 ----------------------- 　　　　　1 | 大阪 ----------------------- 　　　　　2 | 名古屋 ----------------------- 　　　　　3 | 北海道 ----------------------- [TRN_table_B] (名物テーブル) _________________________________ 都道府県CD | 名物CD | 名物名 --------------------------------- 　　　　1　|　　　1 | たこ焼き --------------------------------- 　　　　1　|　　　2 | お好み焼き --------------------------------- 　　　　1　|　　　3 | 豚まん --------------------------------- 　　　　2　|　　　1 | ういろう --------------------------------- 　　　　2　|　　　2 | きしめん --------------------------------- 　　　　3　|　　　1 | ホタテ --------------------------------- 　　　　3　|　　　2 | カニ --------------------------------- 　　　　3　|　　　3 | じゃがいも --------------------------------- 質問なのですが、例えば上記のような親子関係のテーブル [MST_table_A] (都道府県マスター) [TRN_table_B] (名物テーブル)より、下記の様なマスター１レコードに対し、 子供の情報を１フィールド(Tab区切り)で取得する為には どのようなユーザー関数を作成し、どのように実行すれば実現することができるのでしょうか？ [処理結果] __________________________________________________________________ 都道府県CD |　都道府県名 | ★名物名全データ★ ------------------------------------------------------------------ 　　　　1　|　　　　大阪 | たこ焼き vbTab お好み焼き vbTab 豚まん ------------------------------------------------------------------ 　　　　1　|　　　名古屋 | ういろう vbTab きしめん ------------------------------------------------------------------ 　　　　1　|　　　北海道 | ホタテ vbTab カニ vbTab じゃがいも ------------------------------------------------------------------
ストプロ内でxp_cmdshellを使用し、vbsファイルを実行したいのですが実行できません。 vbsファイルはxp_cmdShellでキックされたらSQLサーバのデータをＳＥＬＥＣＴし、テキストファイルにSELECTで取得した行数だけ行を追加するという内容です。 vbsファイルはコマンドプロンプトから実行すると動くので正しいと思います。 ストプロにはvbsファイル実行の前後にtableのupdate作業があり、 その２つは行われます。しかし、書き出されるはずのデータがテキストファイルに書き出されません。 vbsファイルは実行されていないようですがエラーは出ず正常終了となり、 xp_cmdshell実行後の戻り値は０で成功となっています。 xp_cmdshellオプションは有効になっており、は混合モードでSysAdminの権限を持つユーザーで処理をしています。 また、ストプロではなく、SQLServerManagementStudioから下記のようにvbsファイル実行しようとした場合、エラーなく正常終了するのですがテキストファイルにデータは追加されていません。 　EXEC @result = xp_cmdshell 'Cscript c:\AddRow.vbs' しかし、EXEC xp_cmdshell 'dir *.exe'は実行できます。 vbsファイルをxp_cmdshell で実行するときは何か特殊な記述が必要なのでしょうか。何がいけないのかわからず困っております。お気づきのことがありましたらご指摘いただけますようお願い致します。 以下にストプロの中身をを記述します。 BEGIN 　　SET NOCOUNT ON; -- テーブルのアップデート処理 　　UPDATE table1 SET Status = 1 　　WHERE Status = 0 --ファイル書き出しvbsの実行 　　DECLARE @result int 　　SET @result = 1 　　EXEC @result = xp_cmdshell 'Cscript c:\AddRow.vbs' --ここは下記のようにCscriptを抜いても試しましたがだめでした。 --EXEC @result = exec master..xp_cmdshell 'c:\AddRow.vbs' 　　IF (@result = 0) 　　BEGIN --xp_cmdshellの実行が成功したときのみこの処理に入る予定。 --実際は実行されていないようだが@result が0なのでこの処理を行っている。 　　　　UPDATE table1 SET Status = 2 　　　　WHERE Status = 1 　　END END
SQL SERVER 2005　EXPRESS　EDITION　でSQLサーバエージェントが見つかりません。これはMSによって削除されたのでしょうか。
Windows Server 2008 Standard 32bit Edition に SQL Server 2008 Standardをインストールしています。 しかし、"セットアップを実行するには、4.5以上のWindowsインストーラが必要です。"というメッセージが出てきました。 それで、Windows Installer 4.5 Redistributable をインストールしようとしていますが、 ダウンロードするファイルがいくつもあり、どれが正しいのか解りません。 Windows Server 2003に対するファイルはあるのですが、2008に対するファイルがありません。 どのファイルをダウンロードしてインストールしたら良いのでしょうか？ 宜しくお願いします。 OS: Windows Server 2008 Standard 32bit Edition CPU: Intel Core 2 Duo E7300 @2.66GHz Memory:4.00GB HD空き領域： C 160GB です。
WEBアプリとSQLServerでSELECTをするときに不正をされないように SELECT * FROM DB WHERE DB.A = 検索文字 を SELECT * FROM DB WHERE DB.A= @A のようにして、@Aを後で指定しますが、 SELECT * FROM DB WHERE LIKE '%検索文字' のようにLIKE検索の場合うまくいきません。 どのように記述したらいいのでしょうか？ SELECT * FROM DB WHERE DB.A LIKE @A --> 駄目 SELECT * FROM DB WHERE DB.A LIKE '%@A' --> 駄目
ＳＱＬの各システムのログが４００ＧＢに成っているものもあり、空き容量もなく正常に稼働しない状況です。回答の中に同質問による回答があったのですが、そのコマンドをどこから実行して良いのかも分からない初心者です。稼働出来ない状態で困っております。宜しくご指導の程、お願い申し上げます。
select * from [テーブル名]　で問い合わせをしたいんですが、 select * from [スキーマ名].[テーブル名]　でなければエラーになってしまいます。 （「オブジェクト名 'テーブル名' は無効です。」といった、テーブルが無い旨のエラーが出ます。） 所有者(スキーマ名?)をdboに変更してするとテーブル名だけで参照できます。 例えば、テーブルの所有者を'test_user'に変更した場合、 test_userでログインしているにもかかわらず（クエリアナライザ）、修飾が無いと参照できません。 'test_user'はsystem administratorsロールに入れてあります。 SQLServerをインストールし直して DBを一から構築してもそうなります。 何か施さないといけないことがあるのでしょうか。 思い当たることがございましたら、ご教示頂ければと思います。 環境は SQL Server 2000 です。
SQLServer2005 Express Editionをインストールしました。 色々いじっていたら、起動・接続後の画面が使いづらいものになってしまいました。 接続後は添付の図のような画面で作業を開始したいのですが、どのようにすれば起動後の画面となってくれるのかわかりません。 添付の画面にならない場合、せめてインストール直後の画面に戻したいいです。 非常にレベルの低い質問で申し訳ありませんが、どなたかわかる方、ご教授ください。 よろしくお願いします。
お世話になります。 SQLについて知恵をかしてください。 以前に質問させて頂き、解決したのですが新たな問題がでましたので 質問させていただきます。 テストテーブル ID　質問番号　回答 ------------------------------ 1　　　1　　　回答例1 1　　　2　　　回答例2 1　　　3　　　回答例3 1　　　3　　　回答例4 1　　　3　　　回答例5 「質問番号1に回答例1が入力され、かつ質問番号2に回答例2が入力されているIDをテストテーブルから取得したい」 ということで以下のSQLを作成しました。 SELECT ID FROM TEST_TABLE WHERE (質問番号=1 AND 回答='回答例1') OR (質問番号=2 AND 回答='回答例2') GROUP BY ID HAVING COUNT(*)=2 これで解決したのですが、「回答」が範囲指定されることがあり そうすると上記の件数が「2」ではなくなり取得できなくりました。 一意ではなくなった為、件数がおかしくなっております。 回答3　>=　1　and　回答3　<=　10　のように指定されます。 このような場合、1件しか取得しない方法はございますでしょうか。 重々難しいことは承知ですが、and以下で行いたいのです。 申し訳ございませんが知恵をかしてください。
初めまして！ SSISの変数利用について　教えて頂きたいので　よろしくお願いいたします。 SSISの変数に入った値をSQL実行タスクの　SQLStatementで利用することは できませんでしょうか？ 具体的に何をやりたいかと言いますと データを取り込む為に一時テーブルを使います。 SQL実行タスクで一時テーブルを作成して、 データを取り込み、処理後に一時テーブルを削除します。 素人考えで、もしほぼ同時にパッケージが実行された場合に 一時テーブルの名前がカブっていると不具合の元にならないかと思いました。 そこで、変数の値でテーブル名を動的につけられればと思ったのですが、 変数に入れた値を、 色々調べてみたのですが　SQL実行タスクエディタのSQLStatementでどう呼び出せばよいのか分かりません。 例えば、以下のような文で##test_table　の部分を変数で指定することはできないのでしょうか？ CREATE TABLE ##test_table( [CD] VARCHAR(10), [NAME] VARCHAR(20) ) GO お手数ですが、ぜひ教えてください。 SSISを始めたばかりで　考え方自体がおかしいのかも知れません・・・。 その場合は本当に申し訳ありません どうぞよろしくお願いいたします！
SQL Server2005を使用しています。 SQL Sever エージェントのジョブ機能を使い、1日1回、データベースのバックアップ、1時間に1回、ログのバックアップを行うよう設定しています。 データベースのバックアップがスケジュールで指定した時刻に行われません。 ログのバックアップは1時間に1回、実行されています。 スケジュールで指定した時刻にバックアップが実行されるようにする設定方法を教えてください。 以上、よろしくお願いします。
VB→ストアド→Accessでデータ表示 Accessのレポートで質問です テーブルはリンク ------------------------------------------------------ Accessのレポートには単価と数量という項目があります それをグループ化します グループ化で得意先という項目の合計をもとめます 単価：テキスト型 数量：テキスト型 区分番号：数値 区分番号が１のとき単価を－(マイナス)で表示する 得意先合計と総合計の計算のときマイナスも含まれて計算されるので エラーになる 抽出条件が一致しませんと出る エラーが出ずに計算するにはどうしたらいいですか またグループかで計算するときにマイナスの項目ははずして合計を出したい これってVBA使わないと出来ないんですか？ 使うならどうしたら出来ますか？ [レポートフッター] ------------------------------------------- [ページフッター] ------------------------------------------- [得意先番号ヘッダー] ------------------------------------------- [詳細] 単価　数量　　区分番号 ------------------------------------------- [得意先番号フッター] ------------------------------------------- 得意先合計 (=sum(単価 * 数量)) [ページフッター] ------------------------------------------ [レポートフッター] 総合計 (=sum(単価 * 数量)) -------------------------------------------
お世話になっております。 ＳＱＬの日付（例：2009/01/22　10：00）にint型を足したいのですがちなみに秒として足したいです。 2009/01/22　10：00に60足したら2009/01/22　10：01みたいにしたいのですが… 何か方法はありますか？ まだまだ知識が浅く自分ではどうにも思い浮かびません… ご教授願います。
レコードの更新時にトリガで処理履歴を履歴テーブルにとりたいのですが、 元のレコードに処理端末「Environ("COMPUTERNAME")」で取得している)と言う 項目があるので、登録時と訂正時は inserted を使うので処理履歴に どのPCで処理したか記録が残るのですが、削除時は deleted を使うと 削除されたデータの記録になるので、削除の前に処理したPCになってしまいます。 実際に削除したPC名にしたいので・・・ 現在は削除時のトリガを無効にして、元のレコードを削除するストアドに 処理端末を渡してそのストアドで履歴に追加しているのですが、 トリガ(もしくはSQL側)で呼び出したPC名は把握できないものでしょうか?
毎度お世話になっております。 SQLSERVER2000にて、.BAKファイルをレストアしようとしたところ、 空き容量不足のメッセージがでました。 SQLSERVERをインストールしているPCの空き容量は約4GB、 メッセージは約10GBは必要と言っております。 PCの中をほぼ全てNASに移動すればなんとか10GBは確保できそうなのですが、 その前に何か方法があればと思い質問させていただきました。 よろしくお願いします。
お世話になっております。 よろしくお願い致します。 表：TABLE SN CD NO DATE --------------------- 101 A1 1 2007/12/2 101 A2 2 2007/12/4 201 A1 1 2007/12/7 201 A2 2 2007/12/9 201 A2 3 2007/12/10 301 A1 2 2007/12/3 301 A2 3 2007/12/8 このようなテーブルがあったとして、 SNごとに、CDが'A2'のNOを取得したいです。 このとき、A2が複数行あるときはDATEの新しいほうのNOを 取得したいと思います。 SN CD NO DATE --------------------- 101 A2 2 2007/12/4 201 A2 3 2007/12/10 301 A2 3 2007/12/8 取得したい表はこのような感じです。 なのですが、どうもうまくいきません。 SELECT MAX(DATE) FROM TABLE WHERE CD='A2' GROUP BY SN これを使っていろいろやってみたのですが できませんでした。 SQLをどのように書けばいいのでしょうか？ どうかよろしくお願いします。 SQL Server2005です。
MS Access 2003 のVBA からSQL Server 2005 の利用状況を参照できるのでしょうか? 知りたい情報は↓です。 DB、テーブル、レコードへの接続台数(もしくは接続の有無) 上記に接続しているユーザー名とかコンピュータ名、ホスト名など特定できる情報 <やりたい事> 更新テーブル(ワークテーブル)にデータを移してメンテナンスし、処理が完了したらストアドで 元のテーブルにデータを戻すのですが、その間元のテーブルのレコードにロックをかけたい。 (現在はワークテーブルに対して主キーでDcountで確認している) 誰かが特定のテーブルを使っている時は、締切処理が出来ないようにしたい。 誰かがADPを起動している時はバックアップ処理を出来ないようにしたい。
SQL Server 2005 Express Edition で、 半角カナ文字列の中の濁点、半濁点を 除去する方法はあるでしょうか。 SET @after = REPLACE(@before, '濁点', '') ※実際は「濁点」ではなく半角の濁点を記述しています。 このようなやりかたでは除去できませんでした。
WindowsServer2008(x64)の上にSQLServer2008を新規Installしようとしています. ".NET Framework"のInstallは正常に終了した.その後しSQLServer2008の"サーバの構成"の所で,"SQL Serverエージェントサービス"と"SQL Serverサービス"と"Analysis Servicesサービス"に"続行するには、SQL Serverエージェントに有効なアカウントおよびパスワードを指定してください"とエラーになり,その先に進めません. アカウントは,３つのサービスとも同じ"SQL2008\sqlsrv"と入れ,パスワードには,WindowsServer2008のAdministratorログイン時のパスワードを設定し,[次へ]をクリックした.各サービスに設定したアカウントとパスワードがダメらしいが,どうしてなのか解りません.アカウントは何でも良いと思いますが,パスワードが不正なのだと思うのですが…何が問題なのでしょうか？ お解りの方はお教え下さい.宜しくお願いいたします.
以前投稿したのですが、抽出するテーブルに問題があり、 再度投稿させて頂きます。 SQLを使うのが初心者なので勉強をしながら作業を行なっています。そのため説明不足などありましたらご指摘願います。 [環境] 　データベース：SQLServer2005 質問内容は、 会員マスタテーブル 会員CD,会員住所,SHIMEI,KOSHINDAY 0001,東京,太郎,20090101 0001,千葉,太郎,20090102 0002,東京,次郎,20090101 0002,大阪,次郎,20090109 0003,大阪,三郎,20090109 0003,奈良,三郎,20090110 0004,大阪,四郎,20090109 代理人テーブル 会員CD,代理人CD,業務CD,KOSHINDAY 0001,0002,15,20090101 0001,0003,15,20090102 0002,0001,01,20090201 0002,0004,10,20090202 0003,0001,10,20090201 0003,0004,15,20090202 上記のようなテーブルがあります。 抽出結果ですが、 会員CD,会員住所,SHIMEI,KOSHINDAY,代理人CD,代理人住所,代理人名... 0001,千葉,太郎,20090102,0003,奈良,三郎,20090110 0002,大阪,次郎,20090109 0003,奈良,三郎,20090110,0004,大阪,四郎,20090109 会員マスタテーブルにて、各会員のKOSHINDAYが最大のデータを抽出します。 会員マスタテーブルの会員CDを元に、代理人テーブルを検索し各々KOSHINDAYが最大の代理人CDを求め、その時に業務CD＝１５のものだけを選び、 選び出された代理人CDで、会員マスタテーブルを検索し、 代理人の住所・氏名を抽出します。 上記内容なのですが、一回のSQL文で抽出が可能でしょうか？ 仮想的にアクセスで検証したのですが、 作成出来ませんでした、すいませんが宜しくお願いします。
SQLServerを別PCにて稼動させて、クライアントPCよりVBAにて接続を試みているのですが、「SQLServerが存在しないか、アクセスが拒否されました。」と出て、接続が出来ません。 何が問題なのか分からず、困っています。 どなたかご教授頂けないでしょうか。 （ローカルで接続する分には、接続が出来る事を確認しています。） また、環境は以下のような形です。 ServerPC名：AAA SQLバージョン：SQLServer2005Express ServerOS：Win2003Server ログイン用アドレス：TAROU クライアントのVBAは以下のような記載をしています。 ------- Dim strSQL As String Dim rsTmp As ADODB.Recordset Dim DB As String DB = "Provider=MSDASQL;Driver={SQL Server};" & "Server=AAA\SQLEXPRESS;" & "Database=TEST;" & "" Set rsTmp = New ADODB.Recordset strSQL = "SELECT * From TEST_TABLE" rsDeli.Open strSQL, DB, adOpenStatic, adLockOptimistic -----------------
社内SEですが自社開発は全くの初心者です。 環境　 Windows2000 Visual Studio 2005（Professional) Microsoft Office Access 2003 C# 上記の環境でWindowsアプリケーション（自社製品管理ソフト）を開発をしようとしています。 しかしサーバーをどうして良いのかがわかりません。 これはサーバーを用意したりしないといけないのでしょうか？ もし以上の環境でできないのでればこれ以上の初期投資はできませんのでACCESSにてクライアントPCにデータベースファイルを置いて、そのデータベースを利用するアプリケーションを作ろうと思います。 データベースファイルはファイルサーバーにアップする予定です。 プログラミングのコード作成でSQL Serverは使ったことがありますが、既存のものを利用したことがあるのみです。 サーバーだけじゃなくSQL Serverデータテーブルは何で作るべきでしょうか？ 予算がないなかSEの皆様、何か妙案をいただけないのでしょうか？
SQL Server 2005 EXPRESSがインストールされていたのをアンインストールしてSQLEXPR_ADV_JPN.EXEを使用して、再度インストールしようしましたが、インストール完了の少し前の画面「セットアップの進行状況」で「選択されたコンポーネントを構成しています」でMSXML6が「セットアップに失敗しました」となりインストールに失敗しました。インストール時のログを見ますと、以下のように書かれています。製品: MSXML 6 Service Pack 2 (KB954459) -- 構成に失敗しました。MSI (s) MainEngineThread is returning 1603インストールできるご助言を、藁をもつかみたい心境でお待ちしています。
MSDEが突然開始できなくなりました。 エラーログは19015,17055,17052が出ています。 対処方をご存知ありませんか？
とんでもないようなことを聞くようで申し訳ありませんが、現在あるプログラムでＳＱＬを使用しています。 サーバにデータがあり、それをクライアントＰＣから読み込むというものです。 質問は、ソフトに付属していたＳＱＬＳＥＲＶＥＲと皆さんがここで言っているＳＱＬＳＥＲＶＥＲとは、無償版と製品版のような違いがあるのでしょうか？ もうひとつの質問は、サーバにあるデータをバックアップしたいのですが、データをコピーできません。コピーしても、ＳＱＬＳＥＲＶＥＲを構築しないと使用できないような気がしますがいかがでしょうか？上手にバックアップできるソフトを探しています。 よろしくお願いします。
SQL文についてです。 表Aで列1と列2が'◎'のものについて、列3,列4,列5をそれぞれ'○','△','×'に更新したい場合は下記でOKだと思います。 UPDATE 表A SET 列3 = '○', 列4 = '△', 列5 = '×' WHERE 列1 = '◎' AND 列2 = '◎' 列1と列2をキーとして表Aと結合できる表Bが存在するとします。 条件に表Bの列6が'□'だった場合を追加したい時、どのような方法で行えば良いのでしょうか？ 内部結合やWHERE EXISTSなどをいろいろ調べたのですが、SQL文に慣れていないためかうまくいきません。 初歩的な質問で申し訳ありませんが過去質問で参考になるものがなかったのでお願いします。
各主要データの更新記録を別のテーブルに記録するようにしたいのですが、 元のテーブルに処理内容(登録、訂正、削除)と日時を追加するだけなので、 元のテーブルの構造がコピーできれば簡単に作れると思い、色々ためした のですが出来ません(方法が判りません)、方法を教えて下さい。 同一DB内、同一スキーマ内、別DB間でコピーが出来ればと考えています。 宜しくお願いします。
複数のDB(請求書発行_DB、経費管理_DB、仕入管理_DB、顧客管理_DB、銀行_DB、支店_db・・・)で共用するテーブルを別のDB(マスター管理_DB)に集めました。 内容はT_部門、T_勘定科目、T_補助科目、T_取引先・・・等です。 リレーションシップを設定しようとしたのですが、リレーションシップは同じDB内でしか設定が出来ないのでしょうか? また、複数のDBで共用する場合は各DBに必要なテーブルを用意し同期を取った方がいいのでしょうか? 共用するマスターを一元管理するのが目的です。 (当初は最初に作ったDBのテーブルを他のDBからも参照する方法でシステムを作ってきたのですが、数が増えて来るとどのマスターのメンテナンスがどのシステム(DB)でやっているのか分からなくなって来たので、一元管理をしようと集約したら、リレーションシップが張れなくなってしまいました。)
以下のようなデータ型の掛け算を行った場合の 有効桁数について教えてください。 decimal(38,4) ×　decimal(26,25) 私が確認したところ、 decimal(38,6)になっているようです。 なぜこのような結果になるのか分かりません。 どなたか教えていただけないでしょうか？
SQL 2000 Server のEnterprise Managerにある一覧のエクスポートボタンが、SQL 2005 ServerのManagement Studioにありません、何か良い手はあるのでしょうか。 やりたいことはテーブル、ストアドプロシージャ、ビューの一覧をエクスポートしたいです。
お世話になっております。 掲題の通りなのですが、システムテーブルを見渡しても 見つかりませんでした。 SQL文で取得したいのですが、ご存知の方、お教え下さい。 宜しくお願い致します。
PostgreSQLの場合テーブルhogeの構造を表示するのに下記のように実行しますがSQL Serverでも同じ様なことはできないでしょうか？ （コマンド実行） => \d hoge （実行結果） Table "public.hoge" Column | Type | Modifiers --------+---------+----------- class | integer | not null id | integer | not null name | text | Indexes: "hoge_pkey" PRIMARY KEY, btree ("class", id) ※表示された結果をコピペしてドキュメント等の作成に使いたいです。 宜しくお願い致します。
データベースの勉強をしようと思っていますが、SQLサーバかOracleどっちを勉強しようか迷ってます。就職の機会が欲しいので、多くの職がある方を勉強しようと思っています。 SQLサーバかOracleかどちらの方が多く使われているのでしょうか？
お世話になります。 Mysqlを勉強しています。where節の条件の一部であるワイルドカードパターンマッチ（LIKE）について質問させていただきたいと思います。 以下に添付させていただいた画像をご覧ください。 テーブルに４人に名前があります。select分を使って、この中から最下行の吉田さんの名前を選出しようとしています。しかし、何度やっても結果はうまくいきません。 考えられる要因を教えていただけないでしょうか。宜しくお願い致します。
データを取得したいです SQLで2004/10/01と2004/10/11が入力されてないときに 選択したデータが取れるようにしたいんですがどうしたらいいですか。 丁度WHERE分のところですが SQL Server Management Studio Express使用 select '1' as 端末番号, 受注残.*, 取引先.取引先略名, 担当者.担当者番号, 担当者.担当者名, 区分明細.区分明細名, 区分明細1.区分明細名, 区分明細2.区分明細名, 取引先1.取引先略名 as 取引先略名1, 受注残.品目分類, 名称.名称名, '2', '3' from 受注残 LEFT JOIN 取引先 on 受注残.得意先番号 = 取引先.取引先番号 LEFT JOIN 担当者 on 受注残.売上担当者 = 担当者.担当者番号 LEFT JOIN 区分明細 On ( 受注残 .受注伝票区分 = 区分明細.区分明細番号) LEFT JOIN 区分明細 as 区分明細1 On (受注残.仮単価区分 = 区分明細1.区分明細番号) LEFT JOIN 区分明細 as 区分明細2 On (受注残.完納区分 = 区分明細2.区分明細番号) LEFT JOIN 取引先 as 取引先1 on (受注残.得意先番号 = 取引先.取引先番号 ) left join 名称 on 受注残.品目分類 = 名称.名称番号 where ('00001' = '99999' OR ('00001' <> '99999' AND 受注残.工場番号 = '00001')) AND 受注残.受注日 >= '2004/10/01' AND 受注残.受注日 <= '2004/10/11' AND 受注残.受注日 between '2004/10/01' and '2004/10/11' AND (区分明細.区分番号 = '01' Or 区分明細.区分番号 Is Null) AND (区分明細1.区分番号 = '40' Or 区分明細1.区分番号 Is Null) AND (区分明細2.区分番号 = '10' Or 区分明細.区分番号 Is Null) AND 取引先1.取引先番号 = '00001' AND 受注残.得意先番号 = '143500-03' and 名称.区分番号 like '%65%' and 名称.名称番号 like '%'+'0010'+'%' order by 受注残.工場番号, 受注残.受注日, 受注残.品目番号
VB6から『画像ファイル(.bmpと.jpg)』、『テキストファイル(.txt)』を SQLServerデータベースに保存するといったものを作成しようとしています。 フィールドのデータ型は、画像をimage型、テキストをvarbinary型に設定したいと考えておりまして、画像の方は、Byte型に代入後、LoadFromFileメソッドやWriteTextメソッドで保存や取込が出来たのですが、テキストの方が、同じようにByte型に代入までは出来たものの、その先どのようにして保存(取込)をして良いか分かりません。（エラーになってしまいます。） テキストの方もデータ型をimage型にするしか方法はないのでしょうか？ 何か良い方法があれば教えていただけませんでしょうか？ 宜しくお願いします。
当方VB.NETでWindowsMobile5.0の開発をしております。 SQL Server Conpact Editionを使用して開発進めておりましたが、 ユーザーの関係でモバイル端末交換したところＤＢでアクセスできなくなりました。 下記エラーなんですがモバイル側のアプリフォルダにはsqlceme30.dllは存在しておりその他必要なＳＱＬのdllはそろってます。 参照設定の追加を完了してますが何度やっても下記エラーです。 'System.MissingMethodException' の初回例外が System.Data.SqlServerCe.dll で発生しました。 'System.MissingMethodException' のハンドルされていない例外が System.Data.SqlServerCe.dll で発生しました。 追加情報: PInvoke DLL 'sqlceme30.dll' が見つかりませんでした。 プログラム '[d9b52e2a] ichirou_VB.exe: マネージ' はコード 0 (0x0) で終了しました。 一度VS2005から再インストールしたんですが駄目です・・・ 二日悩んでます。助けて下さい。
SQLSeverを使い，SQL文を作成しているのですが， 下記のA列の重複行を取り除くかつ，B列の「5よりも4」，「4よりも1」，「1よりも2」，「2よりも3」(3>2>1>4>5)の行を抽出したいと考えています．下記の表1を抽出した場合，表2が出るようにしたいです． 表1 A　B 1 1 1 3 1　3 1 5 2 1 2 2 2 5 表2 A　B 1 3 2 2 もしB列が，5>4>3>2>1の順番ならMAXを使って取り出すことはできたのですが，3>2>1>4>5の場合だと，どんなSQL文にすればよいのでしょうか？ よろしくお願いします．
はじめて投稿させていただきます。 SQL SERVER2005のJOINの仕方で困っています。 どなたか、アドバイスをお願いできないでしょうか。 テーブルA CD NAME KBN 1 山田太郎 1 2 山田花子 1 3 山田次郎 2 4 山田五郎 1 テーブルB CD NENGETU DAY1 DAY2 DAY3 ～ DAY31 1 200811 ◎ ◎ 　 1 200812 ◎ 3 200810 3 200811 ◎ 4 200811 ◎ 欲しい結果の条件と結果は テーブルAは、KBN = 1 のみ テーブルBは、NENGETU = 200811 但し、テーブルBには、テーブルAに存在しないCDもあります。 CD NAME KBN DAY1 DAY2 DAY3 ～ DAY31 1 山田太郎 1 ◎ ◎ 　 2 山田花子 1 4 山田五郎 1　　◎ 以上の結果を取得したいSQLを書きたいのですが、 Select CD,NAME,KBN,DAY1,DAY2,DAY3～,DAY31 From テーブルA LEFT OUTER JOIN テーブルB On テーブルA.CD = (Select テーブルB.CD From テーブルB Where テーブルB.NENGETU = 200811) Where テーブルA.KBN = '1' Order By テーブルA.CD とかでやると、CDの1が複数出たりして おかしい結果になってしまいます。 どなたか、アドバイスをお願いできないでしょうか。
こんにちは、vbsでADODBを使ってDBの更新をしたいのですが データ型 ntext の値を更新できずに困ってます。 t_meisaiテーブルのm_syohinの値をbbからaaに変更 update t_meisai set m_syohin = 'aa' where m_syohin = 'bb' というSQL文を実行すると [Microsoft][ODBC SQL Server Driver][SQL Server]データ型 ntext と varchar は equal to 演算子では互換性がありません。 80040E14　というエラーが出て更新できません。 ntextを使わなければいいのでしょうが 仕様の変更は許してもらえませんでした。 どうか、よろしくお願いします。
DTSのデータ変換サービスにてSQLクエリを発行してデータを出力しようとしています。 下記の得意先別請求ファイルからある年の1月から12月の請求額を 横1列に1月から12月まで時系列に出力させたいのですが、うまくいかず 困っています。 初心者的な質問で申し訳ありませんが、どなたかご教授お願いいたします。 [得意先別請求ファイル] ID seikyutuki,kingaku 001,　200712,　5000 001,　200801,　10000 001,　200802,　15000 001,　200803,　2000 ・ ・ 001,　200812, 3000 002,　200712, 300 002,　200801, 4000 002,　200802, 3000 ・ 上記のファイルから下記のような出力結果を得たいのです ID 200801 200802 200803 ・・・200812 -------------------------------------------- 001 5000 10000 15000　・・・2000 002 4000　　3000 4000 ・・・12000 003 自分がいま書いているのは下のような文ですが、これだと 階段状に出力されてしまいます。 select ID, case when seikyutuki='200801' then kingaku end "200801" case when seikyutuki='200802' then kingaku end "200802" 　　・ 　　・ case when seikyutki='200812' then kingaku end "200812" where seikyutuki<=200801 and seikyutuki<=200812 group by ID ID 200801 200802 200803 ・・・200812 -------------------------------------------- 001 5000 001 ........... 10000 001 ..........................15000 以上です。よろしくお願いします。
自分のPCにインストールされているSQLServerのエディションを確認する方法を教えてください。 開発用クライアントと本番サーバーがあり、本番サーバに接続して開発しています。 「SQLServer management studio　を立ち上げて、ＤＢに接続し、サーバーのプロパティ画面で確認する」という方法を教えてもらったのですが、どうも、それは接続している本番サーバーにインストールされているSQLServerのエディションのようです。そうではなく、サーバーに接続している開発用クライアントにインストールされているSQLServerのエディションを確認する方法を教えてください。 よろしくお願いします。
EXCELのデータをSQLサーバにインポートさせているのですが、 インポートの重複有無を判断するために３つのキーを 使用しています。 現状の方法としては、 　Dim　rsRecord As ADODB.Recordset 　Set rsRecord = New ADODB.Recordset 　rsRecord.Open XXXX 'レコードを開く 　rsRecord.Filter = "(A='あ') And (B='い') And (C='う')" のような形でrsRecordが1以上かどうかで重複を確認しています。 （Filterのキーとなる”あ、い、う”はEXCELから取得するデータです。） 上記で重複はチェックが出来るのですが、DBの都合上、1レコード辺り 16回繰り返す必要がある為、1レコードの処理に2秒程度かかっています。 EXCELのデータ数が多いため、1回のインポート処理に30分以上掛かってしまっており、困っています。 重複チェックを高速にする良い方法はないでしょうか。 データベース初心者のため、色々方法を探した結果、上のような 処理以外見当たらず困っています。よろしくお願いします。
別の部署から評価部隊が足りないらしく、年明けくらいから手伝いに行くのですが、SQLを使って評価をするらしいのですが、私自身SQLの知識は皆無でして、ちょっと調べてSELECT文の使い方をある程度調べて、SAD初級の試験くらいならば9割くらいは解けるようになったのですが、勿論これだけでは足りないと思うので、入門編だとか基礎知識の辺りで何か参考になるサイトありましたら教えてください。
SQL2005を利用しておりますが、データベースメールでのテスト送信は 問題なく送ることができますが、ジョブ完了時のメールが送られません。 ジョブの履歴表示を確認いたしますと、注意: メールを使用して '【設定したオペレータ】' に通知できませんでした。 と履歴が確認できます。オペレータにはアドレスも設定され、通知部分では ジョブ成功時に送信、エージェントのプロパティでは警告システムの部分で メールセッションにチェックを入れて、メールシステムはデータベースメール、設定されたプロファイルを設定しておりますが、どうもうまく いきません。もしこのメッセージが表示された際にどこがいけないもの かご教示いただければと思います。もしご存知の方がいらっしゃいましたらよろしくお願いいたします。
下記テーブルがあります 抽出したいのは 第一条件ランクの高い人 第一条件が同じ場合,第二条件評価3の良い人 第二条同じ場合,第三条件評価5の良い人 この場合Ｄさんが一番なので 抽出結果は D | A | 10 | 4 | 6 | 3 | 5| となるようなSQLを組みたいのですが ごく簡単なSQLしか理解しておらずご教授お願いします。 TABLE1 名前|ランク|評価1|評価2|評価3|評価4|評価5| A | A | 10 | 5 | 6 | 3 | 4| B | B | 5 | 2 | 4 | 3 | 4| C | C | 10 | 5 | 4 | 3 | 4| D | A | 10 | 4 | 6 | 3 | 5| E | D | 3 | 1 | 4 | 3 | 4| F | D | 2 | 1 | 4 | 3 | 4| Windows XP Microsoft SQL server 2003
お世話になります。 ユーザー定義関数の引数に Boolean型を指定する方法はありませんでしょうか？ 例） SELECT UserFunction( A > B ) A > B を受ける引数の型が判らずに困っています。 御存知の方がいらっしゃれば教えてください。 よろしくお願いします。
オラクルもしくはSQLサーバーにて ファイルとか画像もデータベースで管理したいのですが オラクルやSQLさーばーはファイルとかDBは 管理できるのでしょうか？ 管理できる場合 ファイルをDBに保存するのでしょうか？ もしくは ファイルへのリンク　アドレスを 管理するのでしょうか？ 詳しい方教えてください
SQL Server 2005 でストアドプロシージャ（以降SPと省略） を作成しています。 複数の SP から、構造が同じローカル一時テーブル （テーブル名が # から始まるテーブル） を使用したい為、 CREATE するだけのローカル一時テーブル作成SP、 DROP するだけのローカル一時テーブル削除SPを、 それぞれ作成しました。 次に、ローカル一時テーブルを使用したい SP 内で、 ローカル一時テーブル作成SP を EXECUTE 後、 ローカル一時テーブルに対し、INSERT をしたところで 以下のようなエラーとなります。 ※INSERT の変わりに、SELECT にしてみても同様でした。 メッセージ 208、レベル 16、状態 0、プロシージャ TEST_SP、行 155 オブジェクト名 '#LocalWorkTable' が無効です。 ※TEST_SP とは、ローカル一時テーブルを使用したい SP の名前 　#LocalWorkTable とは、ローカル一時テーブルの名前 グローバル一時テーブル （テーブル名が ## から始まるテーブル） に変更すると、正常に動作しましたが、 セッションをまたがって使用させたくないのです。 あと、 ローカル一時テーブル作成SPを使用せずに、 ローカル一時テーブルを使用したい SP 内で、直接 CREATE すれば 正常に動作しましたが、 上記にも書いたように、複数の SP で構造が同じローカル一時テーブル を使用したいので、できれば、別 SP にしたいと考えております。 ストアドをまたがって、ローカル一時テーブルを使用する事は できないのでしょうか？
VBAでユーザー定義関数を記述しようと思って勉強中です。 以前、アドバイスして頂きすばらしい関数式で合計8フィールドに入力後、 同一クエリ上で再度結合して1つのフィールドにまとめることが出来ました。 そして最後にもう1つクエリでファイルを作成しCSVファイル出力です。 目的は、文字列とtag(htmlタグ)と組合わせて1つのHTMLテキストにしようとして下ります。 そこでまた問題が発生いたしました。 1つのフィールドが1024文字のため分割して結合しておりましたが、クエリとクエリとクエリの3段階のため 「クエリが複雑すぎます」　というエラーが出ててしまいました。 VBAのユーザー定義関数に変換しなければならないのですが、かなり複雑になってきました。一体どのような記述になるのでしょうか。 大変お手数をお掛けいたしますが、よろしければアドバイスお願いいたします。 最終目的　block1 + block2 + block3 + block4 + block5 + block6+ block7+ block8を連結して html文を作成するためVBAでユーザー関数定義で保存したいのです。 クエリ関数整理後の今回の連結 フィールド名 block3 & block4 & block5 &　以後省略 IIF(TRIM("" & [A] & [B] & [C])="","",[T_shop]![tg6])& MID(IIF(TRIM("" & [A] & [B] & [C])="","<BR><BR>","")& IIF(TRIM("" & [A])="","","<BR><BR>" & [A])& IIF(TRIM("" & [B])="","","<BR><BR>" & [B])& IIF(TRIM("" & [C])="","","<BR><BR>" & [C])& IIF(TRIM("" & [A] & [B] & [C])="","","</FONT>"),9) & IIF(TRIM("" & [D] & [E] & [F])="","",[T_shop]![tg7])& MID(IIF(TRIM("" & [D] & [E] & [F])="","<BR><BR>","")& IIF(TRIM("" & [D])="","","<BR><BR>" & [D])& IIF(TRIM("" & [E])="","","<BR><BR>" & [E])& IIF(TRIM("" & [F])="","","<BR><BR>" & [F])& IIF(TRIM("" & [D] & [E] & [F])="","","</FONT>"),9) & IIF(TRIM("" & [G] & [H] & [I])="","",[T_shop]![tg8])& MID(IIF(TRIM("" & [G] & [H] & [I])="","<BR><BR>","")& IIF(TRIM("" & [G])="","","<BR><BR>" & [G])& IIF(TRIM("" & [H])="","","<BR><BR>" & [H])& IIF(TRIM("" & [I])="","","<BR><BR>" & [I])& IIF(TRIM("" & [G] & [H] & [I])="","","</FONT>"),9)
* 困っています まだ大分初心者のひよこですが、 SQLServer2005をSQLCMDを使って操作しようと思っているのですが、 SQLServer2005をインストールしてコマンドプロンプトから操作しようとしても、 「'sqlcmd' は、内部コマンドまたは外部コマンド、 操作可能なプログラムまたはバッチ ファイルとして認識されていません。」 と出てしまいます。 PATH設定とか必要なのでしょうか？ もしくは足りないソフトとかありますでしょうか？ こんな質問で申し訳ありませんが、 宜しければ教えて下さい<(_ _;)> OS: Vista SQL SERVER 2005 Express Edition (SQLEXPR_JPN.EXE)
プログラムと機能からアンインストールしようとすると 'C:\...\Tools\Uninst.isu' を見つけることができません。 アンイストールは続行されません。 とでます この場合はどうすれば良いでしょう Microsoft SQL Server 2000 評価版 SQL2000-KB815495-8.00.0818-ENU.exe 若干カテゴリー違いでしたらスミマセン
Access-SQL2000で作成したアプリケーションのデータベースをSQL2005にする場合、SQL2000の記述のままでは動かないコマンド、命令などがあれば教えてください。
いつもお世話になっております。 さて、今回はSQL Server Analysis ServicesでSQL Server 2005でのお話です。 今、SQL Server 2005 ビギナーズガイド(翔泳社)を勉強しておりますが、うまく動作しないところがありアドバイスを求めております。 26章において初めから順々にやっていたのですが、p.560での３番、開始ボタンを押すと、接続の確立が出来ない旨のエラーメッセージがでます。 環境としては、SQL Server2005がWindows Server 2003上で動いており、VisualStudio2005で操作しているのはVistaです。 VistaにはSQL Server Management Studioをインストールしてあり、それで接続できているのでリモート接続ができないという理由ではないのかなと判断しており、行き詰ってしまいました。 これじゃないか、という感じでよいですので、思い当たる点がございましたら教えていただければと思っています。 よろしくお願いいたします。
開発環境　 XP Home Edtion Microsoft Visual C++ 2008 Express Edition Microsoft SQL Server 2005 Express Edition Visual C++で入力フォームから数字の入力文字列でのInsert文を実行してそのまま反映させることはできたの ですが、日本語やアルファベットが入らないのですがどうしたらよいでしょうか？ PSTR strText; String^ data; char *ree; ree=(char*)strText; String^ data; data=gcnew String(ree); SqlConnection^ sqlConn = gcnew SqlConnection("Data Source=.\\SQLEXPRESS;AttachDbFilename=C:\\SOUTUKEN\\test.mdf;Integrated Security=True;User Instance=True"); sqlConn->Open(); str= "INSERT INTO table1 (test) VALUES("+data+")"; SqlCommand^ sqlCmd = gcnew SqlCommand(str,sqlConn); SqlDataReader^ exeReader = sqlCmd->ExecuteReader(); sqlConn->Close(); 何卒よろしくおねがいします。
Management Studio から Windows認証でログイン名を作成(登録)し初めたのですが、 ドメインのグループでは登録出来ないのでしょうか? 一通りは探してみたのですが、無いのかなとは思うのですが、もし登録できれば 後々の異動時等のメンテも楽かなと思い、ひょっとしてと思って質問しました。 宜しくお願いします。
初心者です。 同じPCにSQLSERVER EXPRESS 2005を入れており、VISUAL STUDIOで使用しております。 そこでSQL作成ツールのCSEからSQLSERVERを使用するために、ODBC接続を作成してSQLSERVERで作成したデータベースに接続したいのですが、ODBC接続がうまく作成できません。 行っている設定方法は、 ユーザDSNでサーバ(local)を選択。 WINDOWS NT認証を使用を選択。 しかし、規定のデータベースの選択で、 master等は出て来て接続できるのですが、接続したい自分で作成したデータベース名が表示されません。 ほかに何らかの設定が必要なのでしょうか？ よろしくお願いします。
同一スキーマ上の別のＤＢのテーブルを使ってビューを作成したり ストアドを作成したりする事は可能でしょうか？ また、アクセスから接続しているＤＢ以外のＤＢのテーブルに フォームやＶＢＡからアクセスする事は可能でしょうか？ （要は、アクセスのＭＤＢのリンクテーブルの接続先が複数ある様な イメージです） やりたい事はアクセスの請求書発行システムのＦＯＲＭから 取引先管理システムの取引先テーブルを参照したり、ＳＱＬの 請求書発行ＤＢのビューやストアドで取引先管理ＤＢのテーブルを 参照しいたいのです。
お世話になります。 レプリケーションしているテーブルに対して、列(フィールド)の追加や フィールドタイプを変更しようとすると、レプリケーション絡みのエラー が発生します。 テーブル 'xxxテーブル' - テーブルを修正できません。 ODBC エラー : [Microsoft][ODBC SQL Server Driver][SQL Server]レプリケー ションで使用されているので、テーブル 'dbo.xxxテーブル' を 削除 できません。 その都度、当該テーブルを使用しているパブリケーションをいったん削除し、 列の追加やフィールドタイプの変更後、再度パブリケーションを作成して いる次第です。 パブリケーションを削除せず列を追加したり、フィールドタイプを変更する方法 はございますでしょうか。ご教授願います。
SQLServer2005インストール前に【IIS】と【ASP.NET】をインストール していませんでした。 SQLServer2005をアンインストールすることなく、 これらをインストールすることは可能でしょうか？ 可能であればその方法をご教示ください。 よろしくお願いいたします。 詳細環境 OS:Windows 2003 Server R2 SQL：SQLServer2005 standerd Edition
AccessのVBA関連ですが、とある書籍に下記のような記述がありました、 真偽の程はいかがでしょうか? (書籍のレベルはSQLの入門レベルです、MDB→ADPで効率アップする手順書の様な本です) 表題「SQL Server noパフォーマンスを引き出せない関数」 内容「定義域集計関数(DAv、DCount、DFirst、DLast、DMax、DMin、Dsum、DLookupなど)を使用すると、 対象とするテーブルの全レコードをクライアントに持ってきてから計算や検索を行ないます。 そのため、基となるテーブルのデータ量が多い場合は、ネットワーク上のトラフィックが増えて、 結果が表示されるまでのパフォーマーンスが悪くなります。 この場合も、SQL Serverに計算をさせるようにするか、値を取得してからコントロールに 代入するようにします。」・・・(原文のまま) 要は「レスポンスの向上を図るには定義域関数をストアド等に置き換える必要がある」と 解釈したのですが、実際はどうなんでしょうか?
下記関数をクエリで作ったのですが、余分なタグが削除されないので追加でReplaceを追加しようとすると文字制限が1024文字を超えてしまいます。簡略化することが出来ますか。SQL・VBAどちらを勉強すれば良いのかが判りません。どうすればよろしいのでしょうか??? 概略　テーブル入力データを連結してhtmlテキストを作成したい・入力済みデータと未入力セルが混在している場合は、空白を削除して連結したい A　文字列(テーブル入力データ)　[C_html_text]![4_1] B　文字列(テーブル入力データ)　[C_html_text]![4_2] C　文字列(テーブル入力データ)　[C_html_text]![4_3] D 文字列("<FONT COLOR=""#00FF66"" SIZE=""5"">") [tg6] E 文字列(<BR><BR>)　[br2] F 文字列(</FONT>)　[fo1] 1.A( ) + B( ) + C( )　= ""　 2.A(○) + B(○) + C(○)　= <FONT COLOR="#00FF66" SIZE="5"> A + <BR><BR> + B + <BR><BR> + C + </FONT> 3.A(○) + B(○) + C( )　= <FONT COLOR="#00FF66" SIZE="5"> A + <BR><BR> + B </FONT> 4.A(○) + B( ) + C(○)　= <FONT COLOR="#00FF66" SIZE="5"> A + <BR><BR> + C </FONT> 5.A( ) + B(○) + C(○)　= <FONT COLOR="#00FF66" SIZE="5"> B + <BR><BR> + C + </FONT> 6.A(○) + B( ) + C( )　= <FONT COLOR="#00FF66" SIZE="5"> A </FONT> 7.A( ) + B(○) + C( )　= <FONT COLOR="#00FF66" SIZE="5"> B </FONT> 8.A( ) + B( ) + C(○)　= <FONT COLOR="#00FF66" SIZE="5"> C </FONT> 現状　空白が混じるとタグが削除されません。 フィールド名 block4 block4: Trim(IIf(IsNull([A]),[T_shop]![tg6] & [B] & "<BR><BR>" & [C] & "</FONT><BR><BR>",IIf(IsNull([B]),[T_shop]![tg6] & [A] & "<BR><BR>" & [C] & "</FONT><BR><BR>",IIf(IsNull([C]),[T_shop]![tg6] & [A] & "<BR><BR>" & [B] & "</FONT><BR><BR>",Replace(Replace(Replace([T_shop]![tg6] & [A] & "<BR><BR>" & [B] & "<BR><BR>" & [C] & "</FONT><BR><BR>","<BR><BR><BR><BR>","<BR><BR>"),"<BR><BR></FONT><BR><BR>","</FONT><BR><BR>"),"<FONT COLOR=""#00FF66"" SIZE=""5""><BR><BR>","<FONT COLOR=""#00FF66"" SIZE=""5"">")))))
エクセル2007のからSQLserverへデータマイニングアドインを使用してのリモート接続試みています。 クライアント ・vista ・エクセル2007（データマイニングアドイン） ・SQLserver2005standardedition（sp2インストール）(テストのため入れました) サバー ・windows2003server ・SQLserver2005standardedition（sp2をインストール） という構成です。 サーバー名は　サーバー名＋MSSQLSERVER　windows認証 として接続すると ・browserが開始されていることを確認してください ・接続が拒否されましたというエラーが出ます。 MSのサイトなどでかかれている ・browserの開始、自動起動 ・リモート接続の許可 ・tcp、名前付きパイプの使用 ・ファイアーウォールの無効化 などは設定しました。 どこに問題があるんでしょうか。
SQL Server Database Primary Data File (.mdf) とはなんなのでしょうか？
過去ログにも何度か登場していますが、私の問題の最後の解決まで至らな いので、質問させていただきます。よろしくお願いします。 標題のとおり、デスクトップPCで、SQLServer Compact Edition 3.1(SSCE) を使い、VB2005でアプリを開発しようとしています。SSCE for desktopを インストールするには、BOLによれば、インストーラ SQLServerEv31-JA.msiを使う、とあります。しかしネット上をいろいろ探 したのですが（もちろんMSのダウンロードサイトも）見つかりません。 どなたか所在をご存知の方がおられましたら。教えていただきたいのです。 よろしくお願いします。
SQLServer2005をDBとして使用しています コールドスタンバイを構築しようと考えていますが 今動いているSQLServerライセンスだけで構築できますでしょうか？ コールドスタンバイ機にインストールしても 切り替えるわけで同時使用でないからライセンスは必要ない みたいな事を聞いたことがあります MSの公式HPを見ましたがいまいちわかりません。。。
SQLserver2005とwinndowsserver2003でサーバーを構成し、１つのクライアント側からoffice2007のデータマイニングアドインでサーバー側のsqlserverに接続するということをやりたいと思っています。 この場合のライセンスは、sqlserverのcalを1個クライアント用に購入するだけで大丈夫でしょうか？ また、設定方法で詳しいページなどありました教えていただけるとありがたいです。
Windows CE エミュレーターを使用して開発を行っているのですがどうしても解決できない問題ができてしまい、ここ３日ほど先に進めない状態が続いています・・・ [環境] OS :Windows XP VS :Visual Studio 2005 言語:Visual Basic DB :Sql Server Compact デバイス:Winndows mobile 5.0 Pocket PC Emulator [質問] (1)DBコネクションの設定で 「SqlCeConnection.ConnectionString ="Data Source=Program File\ファイル名\DBファイル名.sdf:」という存在しないパス設定すると接続できるのですがなぜなのでしょうか。 　「SqlCeConnection.ConnectionString ="Data Source=DBファイルがあるパス;"」と完全パスを設定すると「パスが無効です」というエラーになってしまいます。 (2)プログラムを実行し、実行画面からDBに対してSelect、Updateを行い正常に処理されるのですが元となるDBに対してUpdate処理が反映されていない状態なのですがなぜなのでしょうか。 ・補足 　Update処理にはSqlCeCommand.ExecuteNonQuery　メソッドを使用しています。 　Update処理実行→コミット→データセットへDBからデータを読み込むとUpdate処理後のデータがセットされていますが、元DBへはUpdate処理が反映されていません。 [備考] 　・DB出力ディレクトリプロパティは「コピーしない」を設定してあります。 　・デバッグ環境をRereaceにして試してもダメでした。
お世話になります。 ASPの画面からSqlServerにADO経由で接続しているのですが、 時々、Openでエラーとなってしまいます。 　oRS.Open "TBL_NAME", 接続情報, 3, 3 　　→　この命令でエラーとなってしまいます。 　エラー内容は 　「Microsoft OLE Provider for ODBC Drivers (0x80040E14) 　　[Microsoft][ODBC SQL Server Driver][SQL Server]'TBL_NAME' は テーブル オブジェクトなので、 　　要求 プロシージャ 'TBL_NAME' は失敗しました。」 　と表示されます。 開発環境は以下 　OS：Windows2000 　データベース：SQLServer2000 となっております。 何方か、ご存じの方がいらっしゃいましたら、お教え願います。 宜しくお願い致します。
AccessのADPからSQLへアクセスしているのですが ↓のテーブル値関数(Q_仕訳明細)をレコードソースに指定してある フォームがあるのですが、コントロールの内容を変更してレコードを 移動させると、テーブルに変更した内容が反映されます。 そう言う物であれば、ビューよりも利用価値があると思うのですが、 私が変な設定をしているのでしょうか? ALTER FUNCTION [dbo].[Q_仕訳明細] () RETURNS TABLE AS RETURN SELECTTOP 100 PERCENT 請求番号, 行番, 部門コード,勘定科目コード, 補助科目コード, 摘要, 金額, 税区分 FROMT_仕訳明細 ORDER BY請求番号, 行番
sqlserver2005standardでwindowsXPproにインストールしました インストール後にsaを SQLマネージメントスタジオで対象サーバの[セキュリティ][ログイン]と展開して右ペインの[sa]をダブルクリックして状態のログイン を有効にしてからパスワードをいれてokすると ユーザー'sa'の作成に失敗しました transactSQLステートメントまたはバッチの実行中に例外が発生しました。 特殊なプリンシパル'sa'は使用できません。 とエラーがでます 前に他の方の質問の解答で 直接コンソールより c:\>sqlcmd-e-s\SQLEXPRESS 1>ALTER LOGIN SA ENABLE と、ありましたがよくわかりません できればSQLマネージメントスタジオの方で 作成できればとおもうのですが よろしくご教授おねがいします
お世話になります。 SQLについて知恵をかしてください。 テストテーブル ID　質問番号　回答 ------------------------------ 1　　　1　　　回答例1 1　　　2　　　回答例2 1　　　3　　　回答例3 2　　　1　　　AAAAAAA 2　　　2　　　てすとてすと 2　　　3　　　回答例3 3　　　1　　　回答例1 3　　　2　　　てすとてすと 3　　　3　　　回答例3 検索画面で画面に質問と回答欄(上記例だと3つ)があり、 「質問番号1に回答例1が入力され、かつ質問番号3に回答例3が入力されているIDをテストテーブルから取得したい」 と思っておりますが、SQLの作成がうまくいきません。 上記例だと、IDが１と３のデータを取得したい ※やりたいことのSQLです SELECT ID FROM TEST_TABLE WHERE (NUMBER = '1' ANSWER = '回答例1') AND (NUMBER = '3' ANSWER = '回答例3') よろしくおねがいいたします。
MS SQL Server2005 Enterprise Editionを使用しているのですが、突如接続エラーが出てしまうようになりました。 メッセージは、"Cannot connect to XXX(サーバー名）"で、メッセージの最後には、(Microsoft SQL Server, Error:2)と出ています。 管理者権限で行っていますし、そもそも今までと設定などを全く変えていないので、原因がよくわかりません。 ちなみにOSはWindows XP SP2です。 教えていただけると助かります。
フォームのレコードソースにパラメータ付きのストアドを指定した場合は、 データを追加する場合にはVBAで下記の命令では追加できないのでしょうか? 状況は「acNewRec」は正常に動作しているようです、「acCmdSaveRecord」で 「データの競合」のメッセージが表示されすすまないので、 終了させようとすると、「プロシージャまたは関数'○○○'には パラメータ'○○'が必要ですが、指定されませんでした。」となります. DoCmd.GoToRecord , , acNewRec データの入力処理 DoCmd.RunCommand acCmdSaveRecord 駄目な場合やはり追加用のストアドを作成するのでしょうか?
お尋ねします。 SQLサーバー２００５にＤＢ１というデータベースにdbo_ＴＢ１というテーブルがあります。そのテーブルの特定の列の値を更新したいので、ＡＣ.mdbというアクセスのファイルにテーブルのリンクをし、更新したいファイルを用意して、アクセスのクエリでデータを更新しようとしましたところ、更新ができませんでした。 　dbo_ＴＢ１を更新可能にするためには、どのようにして権限を与えればいいでしょうか。 　ＳＱＬサーバー２００５の知識を習得しようと学習を始めたばかりで、よく理解できていません。よろしくお願いします。
AccessのADPでSQLサーバーへ接続しようとしています。 ルータ越えのクライアントから接続しようとすると 「サーバー上にデータベースが見つかりません。 データベース名が正しい事を確認してください。」 とエラーメッセージが表示されてしまいます。 adpではサーバーへアクセスする時に表示され、adeではアクセスを開く時に表示されます。 ルータを越えない環境ではエラーになりません。 認証はWindows認証で、ユーザーIDも登録しました。 原因や他に確認することなどアドバイスをお願いします。
いつも勉強させて頂いております。どうぞよろしくお願いします。 以下の環境で開発を行っています。 SQLServer2005 ASP.NET C# .NETのソースで 1つのクラスに2つのクエリ(2つともSELECT←複数テーブルを結合している)を呼び出す処理を書いています。(トランザクション処理は付けていません)2クエリとも検索対象テーブルは60万件程度のデータを保持しています。検索条件によって処理速度は違うのですが、1ユーザが最も遅い検索条件で検索をしてもタイムアウトにはなりません。しかし、2ユーザが同じタイミングで検索(どのような条件でも)処理を行うと、タイムアウトを起こしてしまいます。まれにデッドロックも起こります。 SQLServerではSelectのたびにlockがかかるのでSQL文中に「WITH(NOLOCK)」を記述するように書かれているサイトを見つけたのですが、他ユーザからの更新もあり得るテーブルなので、他の方法を探しております。 トランザクション分離レベルは規定値です。 是非、どなたかご教授ください。よろしくお願いします。
環境 WinXpProSP3 SQLserver2005EE SQLServer上にあるテーブルの「列数」を求めるSQL文はどう書けばよいのでしょうか？ あちこち検索してみましたが、わかりませんでした。 よろしくお願いします。
SQL Server 2000のTransact-SQLで、ストアードプロシージャ あるいは関数内でのみ有効なモジュール（OracleのPL/SQL で言うところのサブプログラム）は作れますか？ もし可能なら、その方法をご教授下さい。 よろしくお願いします。
初めての質問です。 開発環境は Microsoft Visual C++ 2008 Express Edition OS XP SP2 Microsoft SQL Server 2005 です。 VC++でSQL Serverに接続しようと思っているのですが 初心者ゆえ、殆ど(専門家から見れば、ほぼ全く)分かりません。 Microsoft Visual C++ 2008 Express Editionのため MFCは使用できず、ODBCも同等の理由ゆえ使えないみたいです。 そこでOLE-DBにてSQL Serverへの接続を試みようと思いました。 しかしgoogleにて検索をかけてみるも、よく分からず これといった情報や手がかりが掴めませんでした。 (一応、プロバイダーや、コンシューマテンプレートなどと いった単語は文字通りの意味で目にしました) SQL Serverへ接続するには、どうすればいいでしょうか？ 何か必要な知識や、キーワード、を教えて頂ければ幸いです。
SQLServerでシステムを運用しているのですが突如DBエラーが起こり止ってしまいます ログを見るとエラー：823　重大度：24　状態：6～～のログがありました 調べてみますと http://support.microsoft.com/kb/934713/ja http://technet.microsoft.com/ja-jp/library/aa258 …(SQL.80).aspx このようなページがありました 読んでみますとハードエラーな可能性が高い気がしているのですが、 文章の中にDBCC CHECKDBを実行やサービスパックの更新等もあり、原因を絞り込めずにいます。 皆様のご意見を伺えたらと思っております。 どうぞよろしくお願い致します
はじめまして。 「*=」をJoin句に直したいのですが、同様の結果がえられません(T.T) SQL初心者です、どうぞよろしくお願いいたします。 この式をJOIN句に直したいです。 FROM A_TBL, B_TBL as B_TBL01, B_TBL as B_TBL02, C_TBL, D_TBL WHERE A_TBL.No = B_TBL01.No AND A_TBL.No = B_TBL02.No AND A_TBL.No = C_TBL.No AND A_TBL.No *= D_TBL.No AND C_TBL.ID *= D_TBL.ID AND ↓こうしたのですが、正しい結果がえられません。 FROM (D_TBL RIGHT OUTER JOIN C_TBL ON C_TBL.ID = D_TBL.ID) RIGHT OUTER JOIN A_TBL INNER JOIN B_TBL AS B_TBL01 ON A_TBL.No = B_TBL01.No1.No INNER JOIN B_TBL AS B_TBL02 ON A_TBL.No = B_TBL02.No2.No ON A_TBL.No = D_TBL.No AND A_TBL.No = C_TBL.No どうぞ、ご教授お願いいたします。
先ほどまで出来ていたSQL-serverなんですが、 新しくやろうとしたら SQL実行中に以下のエラーが発生しました。 エラーコード：0 [Microsoft][ODBC SQL Server Driver]通信リンクが失敗しました。 SQLステータス：08S01 というメッセージがでました。 コマンドプロンプトで入力したものだとおもったのですが・・・ 解りません。 大雑把かもしれませんがよろしくお願いします
SQL SERVER 2005 Aのテーブルから A1というビューを作成しました。 そのビューの内容というのは AのテーブルのTOP4を 列に変換したいというものです。 例） Aテーブル (列名 AA AB AC) AA1 AB1 AC1 AA2 AB2 AC2 AA3 AB3 AC3 AAビュー AA_1 AB_1 AC_1 AA_2 AB_2 AC_2 AA_3 AB_3 AC_3 AA1 AB1 AC1 AA2 AB2 AC2 AA3 AB3 AC3 となるような、ビューのSQLがあれば、教えて頂きたく思います。 よろしくお願いします。
データ蓄積にSQLデータベースを使用しています。 現在はデモ版で支障はないのですが、 履歴の場合、 テーブルの列が登録毎に増えてしまうので、 その制約が気になります。 どなたか、ご存知の方がいるならば教えてください。
「マスタ」というのは何のことでしょうか？ 調べてみても、台帳のようなものとしかわかりません。
当方のスキルはACCESSからＳＱＬに移行しようと学習中のレベルです。 Management Studioのソリューションエクスプローラについて教えて下さい。 新しく作ったクエリーを保存するようなときに使うんだと思いますが、 いまいち用途と使い方が解りません。 私の環境はサーバーはサーバールームにあり、クライアントから SQL Server Management Studioを起動して開発しています。 開発するクライアントも二拠点あります。 現状、保存先がクライアントのローカルホルダーになっています、 これをサーバーの共有ホルダーにしてもいいのでしょうか？ データベースごとに保存先を別にして作るものなのでしょうか？ ここで保存したクエリーをテーブル値関数などにすることは できるのでしょうか？
「SQL Server Management Studio」でコードを入力していると すぐに日本語入力がオフになってしまいます。 そんな仕様なんでしょうか？ 又、そのために項目名をアルファベットにしているのでしょうか？ 他の事情もあるのでしょうか？ 命令（予約語）との区別も視覚的に一目瞭然なので日本語にしたいのですが、 いちいちＩＭＥを切り替えるのが面倒なので、他に事情がなければ Ｅｄｉｔｏｒ等を使ってコピペすることも検討しようと思っています。
SQL Serverを使えば共有されていない2台のパソコンからでもIDとPWがわかれば テーブルをSQL Serverにアップしてaccessで操作できると言う認識であってますか？ accessの本体の部分（フォームなど）をこの2台のパソコンに入れておけば 同じデータ（テーブル）を扱えるのでしょうか？ ご回答よろしくお願いします。
フロントエンドをAccessのADPにて作成しようとしています。 少しスッキリしないので確認をさせて下さい。 AccessのVBAやフォームのソースに書くSELECTですが SELECTであれば全てサーバー側で絞り込んで結果だけが帰って来るのか from句で指定したテーブル全件が送られて来てクライアント側で 絞り込みされるのかどちらでしょうか? 回線スピードが遅いのでネットワークに流れるデータ量を抑えたいと 考えています。 私の頭の中では・・・ FROM [テーブル名] の場合はクライアント側 FROM dbo.[テーブル名] の場合はサバー側 要はAccessの「テーブル」と「クエリ」に表示されているオブジェクトを 指定するとクライアント側（全件→クライアントで絞り込み＝データ量多）、 「dbo.」を付けるとサーバー側（絞り込み後のデータ→クライアント＝データ量少） と考えています。
SQL Server 2005 Express Edition をダウンロードしたのですが スタート→すべてのプログラム→Microsoft SQL Server 2005→ 構成ツール ・SQL Server エラーと使用状況レポート ・SQL Server セキュリティ構成 ・SQL Server 構成マネージャ の３つしかなくて本体がないんですがこれはうまくインストールされなかったのでしょうか？ もう一度インストールしなおすしかないのでしょうか？ またプログラムの追加と削除には ・Microsoft SQL Server 2005 ・Microsoft SQL Server Native Client ・Microsoft SQL Server VSS Writer ・Microsoft SQL Server セットアップサポートファイル（英語） があります。 アドバイスをお願い致します。
SQLServer2005で２つの異なるデータベース（ADB、BDB）が存在します。 ADBでBDBにあるテーブルを取得して検索をかけたいのですが、どのようにすれば実現できるのでしょうか。 BDBのVIEWを作成するイメージなんですが、リンクテーブルを設定するとかが必要になるのですか。 もしそうだとしたら、どうリンクテーブルを設定するのか教えてください。
ビューにて下記のように設定し「SQLの実行」は指定通りソート されましたが、「ビューを開く」では、ソートされずテーブルの 並びのままでした。 SELECT TOP (100) PERCENT 端末コード, 端末番号 FROM dbo.T_端末 ORDER BY 端末コード そこで、下記のように設定を変更したところ「ビューを開く」でも ソートされるようになりました。 SELECT TOP (1000) 端末コード, 端末番号 FROM dbo.T_端末 ORDER BY 端末コード TOP (件数) に全データ数以上を指定すれば機能するのは解りますが 「ビュー」とはそんな使い方なのでしょうか?
現在ACCESSの勉強をしています。 SQLサーバーと言う存在を知って使ってみたいのですが 自分なりに調べても無料なのか有料なのかわかりません。 そもそもACCESSのように何かソフトを購入するのでしょうか？ MySQL？やらSQLサーバーと混じって、マイクロソフトのHPを見てもどうすれば良いのかよくわかりません。 どなたか回答をいただけないでしょうか？
はじめまして、宜しくお願いします。 SQL Server2005で新規にログインを作成しようと思います。 １．Microsoft SQL Server Management Studio Expressを起動 ２．「セキュリティ」の「ログイン」を右クリックで「新しいログイン」をクリックし、ログイン新規作成画面を起動 ３．任意のログイン名をいれ、SQL Server認証を選択し、パスワードを設定、既存のデータベースを選択。 ４．この状態でOKをクリックすると以下のメッセージが出てエラーとなってしまう。 =================================== ログイン 'xxxx' の作成に失敗しました。 Transact-SQL ステートメントまたはバッチの実行中に例外が発生しました。 (Microsoft.SqlServer.Express.ConnectionInfo) このバージョンの Microsoft Windows では、MUST_CHANGE オプションはサポートされません。 (.Net SqlClient Data Provider) =================================== 何か原因に心当たりのある方がいらっしゃいましたらお願い致します。
SQL SERVER エージェントのジョブにおいて、 各ジョブごとに実行権限を制御できないのでしょうか？ 要するに、とあるAジョブを管理するaさんに bさんが管理するBジョブを実行できないようにする （見えなければなお良い）ができないのでしょうか？ 初歩的な質問ですが、宜しくお願いします。
はじめまして。 datetime型のインポートについて質問ですが、 datetime型にNULLをインポートしようとすると、 "キャストした文字コードが正しくありません。"。 のエラーが出力されてしまいます。 また、datetime型に何も入力していないデータをテキストへエクスポートし、そのテキストを再度インポートしても同様のエラーが出力されます。 何か解決方法がございましたらご教授願います。
■環境 WinodowsXP SP3 VisualBasic2005ExpressEdition SQLServer2005Express SQLServerManagementStudioExpress ------------------------------------------- 上記環境でVB（データベースエクスプローラー/データ接続）より ローカルのデータベースファイル(.mdf)にWindows認証で接続を試みた際、 下記エラーが発生します。 // サーバーへの接続を確立しているときにエラーが発生しました。SQL Server 2005 に接続しているときときにこのエラーが発生した場合は、SQL Server の既定の設定がリモート接続を許可しないようになっていることがエラーの原因である可能性があります。 (provider: 名前付きパイプ プロバイダ, error: 40 - SQL Server への接続を開けませんでした) // ネット上に解決策と思われる記事を多数見つけ、 ・「共有メメモリ」「TCP/IP」「名前付きパイプ」の有効化 ・TCPポート1433の開放 ・UDPポート1434の開放 ・SQL Server Browserの開始 ・FireWall（Windows/ZoneAlarm)の停止 ・SQLサーバーの同時接続数の確認（0でした。） ・再起動... などなど、ローカルでは必要のない作業まで行いましたが、接続できませんでした。 途中、「ExpressEditionでは接続できないかも」のようなサイトも見つけましたが、確証を得ていません。 尚、別環境（Vista/VS2008/SQLServer2005Express)ではすんなりと通ったので、さらに何が原因か分かりません。 もし、他にお心当たりがある方がいらっしゃったら、ご教授いただけないでしょうか。 当方、言語/SQLなど勉強を始めたばかりで言葉足らずかもしれませんが、どうぞよろしくお願い致します。
質問させて頂きます。 Visual Web　Developer2008　Expressと SQLServer2005　Expressを使用しています。 Visual Web　Developer2008　Expressで データベースのデータ接続を行い、Microsoft SQL Server（sqlclient）で接続を追加します。 その際、テスト接続はエラーもなく接続OKとなるのですが、 OKボタンを押すと次のようなエラーがでます。 <エラー> データ接続を追加できません。 ファイルまたはアセンブリ　Microsoft SqlServer Managment Sdk Sfc Version=10.0.0.0 Culture=neutral PublickkeyToken=89845dcd8080cc91, またはその依存関係の1つが読み込めませんでした。 指定されたファイルがみつかりません。 解決の方法をご教授お願いします。 よろしくお願いします。
はじめまして。 SqlServerのテーブル作成をしていますが、 主キーとインデックスの違いがよく分かりません。 いつも主キーの設定は行っていますが、インデックスの設定も必要なのでしょうか。（パフォーマンスの向上の為？） 基本的な事ですみませんが ご教授お願いします。
毎度お世話になっております。 ACCESS2003、SQLSERVER2000を使用しています。 以下のテーブルがあります。 テーブル1 フィールド1　　　フィールド2 　　A　　　　　　　　10 　　A　　　　　　　　20 　　A　　　　　　　　-10 　　B　　　　　　　　　1 　　B　　　　　　　　　2 　　B　　　　　　　　　3 フィールド1をグループ化し、 フィールド2に0より小さい数がある場合はNG、 ない場合はOKと表示したいのです。 希望する結果 フィールド1　　　フィールド2 　　A　　　　　　　　　NG 　　B　　　　　　　　　OK 私が考えた方法は、 1.クエリ1（フィールド2が0以下のフィールド1を抽出する）を作成 2.テーブル1とクエリ1をLEFT JOINし、IS NULL ならOK、そうでないならNGを表示 としました。希望した結果は得られましたが、 もっとスマートな方法（一つのクエリでできるような方法）、 または別解をご教授ください。 よろしくお願いします。
SQL Server 2008 Express のマネジメントスタジオで簡単なデータベースとテーブルを作りました。それをVisual Basic 2008 Express で使うためにデータベースエクスプローラで表示させたいのですが表示されません。 なので接続の追加で直接mdfファイルを開こうとしてみると、 「オペレーティングシステムエラー32: プロセスはファイルにアクセスできません。別のプロセスが使用中です。アタッチできませんでした。同じ名前のデータベースが既に存在するか、指定されたファイルを開けないか、UNC 共有に配置されています。」 と表示されます。 初心者なので分かりやすく教えて欲しいです。 よろしくお願いしますｍ（＿＿ｍ）
以下のようなデータ件数のテーブルが、別々のＤＢにあります。 SELECT COUNT(*) FROM AA.TBL01 ------ TBL01 ------ 10 SELECT COUNT(*) FROM BB.TBL02 ------ TBL02 ------ 5 それぞれのテーブルのカウント結果を、１行で取得する ことは可能でしょうか？ ＜取得したい結果＞ ---------------- TBL01 TBL02 ---------------- 10 5 よろしくお願いします。 （SQL Server2005 Standard）
いつもお世話になっております 古い環境なので大変恐縮ですが、行き詰ってしまったので、 ご教示いただきたいと思います。 環境：WinXP sp2 SQLServer8.0 VB6.0 sp4 VBでCSVのデータ1行について、ストアドプロシージャにて3つのテーブルに格納しようとしています。 トランザクションの管理はVB側で行っています。 1行ごとにCommitを行えば、全行格納されるのですが、 2行以上ごとにCommitを行うと、最初の1行のみが格納されないという現象がおきています。 6800行存在する同じCSVファイルについて、1行ごとにCommitを行った場合は、6800件登録されるのに 処理の最後でCommitをきった場合、6799行しか登録されません。 1行ごとにCommitをきった場合に6800行登録されるので、キー重複は考えられません。 いろいろ試してみたことを下記に書きます 結果はこのような感じです。 CASE1・・・全件登録できます CASE2・・・２件目で重複エラーが発生します CASE3・・・全件 - 1件が登録できます CASE4・・・全件登録できます CASE5・・・全件登録できます CASE2, CASE3 で全件登録できない理由をご教示いただきたく思います。 よろしくお願いいたします。 CASE1（VBでINSERT文を記述） 　localConnection.beginTrans localConnection.execute "DELETE FROM TABLE_A" localConnection.execute "DELETE FROM TABLE_B" localConnection.execute "DELETE FROM TABLE_C" FOR i = 1 to 6800 localConnection.execute "INSERT INTO TABLE_A (COL_A1, COL_A2) VALUES ('" & VAL_A1(i) & "','" & VAL_A2(i) & "')" localConnection.execute "INSERT INTO TABLE_B (COL_B1, COL_B2) VALUES ('" & VAL_A1(i) & "','" & VAL_B2(i) & "')" localConnection.execute "INSERT INTO TABLE_C (COL_C1, COL_C2) VALUES ('" & VAL_A1(i) & "','" & VAL_C2(i) & "')" NEXT 　localConnection.commitTrans CASE2(ストアドプロシージャ) localConnection.beginTrans localConnection.execute "DELETE FROM TABLE_A" localConnection.execute "DELETE FROM TABLE_B" localConnection.execute "DELETE FROM TABLE_C" ' -- ストアドプロシージャのパラメータ作成 FOR i = 1 to 6800 localConnection.execute NEXT 　localConnection.commitTrans CASE3(ストアドプロシージャ) localConnection.beginTrans localConnection.execute "DELETE FROM TABLE_A" localConnection.execute "DELETE FROM TABLE_B" localConnection.execute "DELETE FROM TABLE_C" 　localConnection.commitTrans ' -- ストアドプロシージャのパラメータ作成 localConnection.beginTrans FOR i = 1 to 6800 localConnection.execute NEXT 　localConnection.commitTrans CASE4(ストアドプロシージャ) localConnection.beginTrans localConnection.execute "DELETE FROM TABLE_A" localConnection.execute "DELETE FROM TABLE_B" localConnection.execute "DELETE FROM TABLE_C" 　localConnection.commitTrans ' -- ストアドプロシージャのパラメータ作成 localConnection.beginTrans FOR i = 1 to 6800 localConnection.execute 　 localConnection.commitTrans 　 localConnection.beginTrans NEXT 　localConnection.commitTrans CASE5(ストアドプロシージャ) localConnection.beginTrans localConnection.execute "DELETE FROM TABLE_A" localConnection.execute "DELETE FROM TABLE_B" localConnection.execute "DELETE FROM TABLE_C" 　localConnection.commitTrans ' -- ストアドプロシージャのパラメータ作成 localConnection.beginTrans FOR i = 1 to 6800 localConnection.execute if i = 1 then 　 localConnection.commitTrans 　 localConnection.beginTrans end if NEXT 　localConnection.commitTrans
SQLServer2005ExpressをOS:XPにインストール インストール条件は揃っているものとします。 やりたい事は、SQLServer2005Expressのインストールと データベースの設定です（テーブル、フィールド、初期データ） これを出来るだけ簡単な操作で済ませたいと思います。 １．SQLServer2005Expressのインストールは、コマンドラインから 実行可能な事が分かり、テストし、上手くいきました。 バッチファイルを準備し、ダブルクリックでインストール完了 ２．データベース設定 テーブル、フィールド設定、　データ作成を簡単にやる方法を 探しています。 SQL Server Management Studio Expressのインストール後、 MDFファイルのアタッチでは、操作が煩雑すぎます。 出来れば、Severインストール時と同じように、1ファイルのダブルクリックで 完了させたいのですが、方法はあるでしょうか？
　 ●サーバー機 DB:SQLServer2005 OS:WindowsServer2003 ●クライアント機 OS:WindowsXP SP3 住所テーブル(ADDRESS)の項目のひとつである電話番号(TELNO)を 特定の記号で３つの別項目として取得したいのですが クライアント機の SQL Server Management Studio にてクエリを実行すると 「SUBSTRING 関数に渡した長さのパラメータが無効です。」 以上のようなエラーが発生します。 電話番号の項目は文字型の項目で、実際のデータとしては 例：(01)2345-6789 (0123)45-6789 (01234)5-6789 こんな感じで市外局番の前後に必ず"(" ")"が付いており"-"も必ず付いた状態です。 ただし、市外局番、ハイフンの前後の番号の桁数に決まりはありません。 ※市外局番５桁、ハイフン前４桁、ハイフン後４桁という最大桁数の制限はあり。 【実行したクエリ】 Select SUBSTRING(TELNO, CHARINDEX('(',TELNO)+1, CHARINDEX(')',TELNO)-CHARINDEX('(',TELNO)-1) AS TELNO1 , SUBSTRING(TELNO, CHARINDEX(')',TELNO)+1, CHARINDEX('-',TELNO)-CHARINDEX(')',TELNO)-1) AS TELNO2 , SUBSTRING(TELNO, CHARINDEX('-',TELNO)+1, 5) AS TELNO3 From ADDRESS エラーメッセージの通り、SUBSTRING関数のパラメータの内容が長すぎるのが原因のようですが いろいろ調べてみたのですが別の書き方が見つけられず困っている状態です。 何かいい方法はないものでしょうか？（別の関数を使用する等々） ※ストアドプロシージャで処理するのではなく１本のクエリで結果が得られるのが望ましいです。 よろしくお願いいたします。
Microsoft&reg; SQL Server&reg; 2008 Express with Tools をダウンロードしてインストールしようとしたのですが、 インストールの途中経過でチェックするときにファイアウォール がじゃましてるかなにかの警告がでて、説明欄のＵＲＬのページを 見たらリモートアクセスの為にポートを空けなくちゃいけないと いう風なことが書いてあって、良く意味が分からなかったし 自分はスタンドアロンで使おうと思っているので無視して進みました。 するとインストールの最後のあたりで接続できないかなにかのエラー が出て、インストール失敗という風になってしまいます。 そのまま終了してマネジメントスタジオを起動してもやはり接続 できませんでした。ポートを空けてみてもだめでした。 原因が分かる方、初心者なのでできれば分かりやすく教えてください。 よろしくお願いします。
お世話になります。 ExcelデータをADO経由でSQLServerに取込み、その後データの精査を行うプログラムを作成しております。 Excelデータは全てvarchar(255)で構成されたテーブルに投入され、精査が行われます。 ここでつまずいてしまっておりますのは、 ”項目2が小数部8桁以内であること”という条件がありまして、どの様にクエリを 起こせば良いか見当が付かないでおります。 処理はプロシージャ内で行っておりまして、以下の様な作りになっております。 select 項目1, case 項目1の判定結果 end as 結果1, 項目2, case 項目2の判定結果 end as 結果2 into #TableA from TableA (項目1,項目2ともvarchar(255)です) 項目2の小数部が８桁以上はNGとする時の判定方法をご教授いただけますでしょうか。 小数部について OK '.0'～'.99999999' NG '.000000001'～'.000000001.....' 不明な点がございましたら補足させて頂きますので、よろしくお願いいたします。
WinXP、VS2005(VB)においてデバイスアプリケーションを作成しています。そこで、サーバー側のSQLServer2005Expressに接続したいのですがうまくいきません。ちなみに実行は、PocketPC2003のエミュレーターを使用しています。[SqlClient]を使用してConnectionStringに、 "Data Source=PC名\sqlexpress;Initial Catalog=DB名;Persist Security Info=True;User ID=sa;Password=パスワード;Connection Timeout=10" を入れてOpenしようとしているのですができません。ポイントは(1)そもそも[SqlClient]を使用してSQLサーバーにアクセスできるか？(2)エミュレータに設定が必要（IEでHPの観覧が出来るのは確認できた）(3)接続文字列が不備？（ただし通常のWindowsアプリでは動作確認できている） いろいろと要因はあるかと思いますが、まず何か思い当たるところがありましたらご教授ください。(SQLサーバーはF/Wは無効にしていますし外部からの接続は確認できています）
SQL Server 2005 Workgroup Edition で、データベースメールのプロファイルを削除しようとすると、エラーになってしまいます。 レポートは下記です。 ・------------------------------------------------------------・ - プロファイル 'プロファイル名' を削除します (エラー) メッセージ プロファイル 'DBmail' を削除できません。 ------------------------------ ADDITIONAL INFORMATION: MailProfile 'DBmail' の削除に失敗しました。 (Microsoft.SqlServer.Smo) ヘルプを表示するには http://go.microsoft.com/fwlink?ProdName=Microsof …削除+MailProfile&LinkId=20476 をクリック ------------------------------ Transact-SQL ステートメントまたはバッチの実行中に例外が発生しました。 (Microsoft.SqlServer.ConnectionInfo) ------------------------------ @force_delete はプロシージャ sysmail_delete_profile_sp のパラメータではありません。 (Microsoft SQL Server、エラー: 8145) ヘルプを表示するには http://go.microsoft.com/fwlink?ProdName=Microsof … をクリック ・------------------------------------------------------------・ エラー番号から検索しても解決方法がわかりませんでした。 どなたかご教授お願いいたします。
データの呼び出し方についてご教授お願いします。 言語：Microsoft Visual Studio 2008 データベース：SQL Server 2005 非接続型のデータアクセスです。 varchar型のフィールドにデータを格納しているのですが、ダラダラとこのように入っています。 ↓ ああああああああああ。いいいいいいいいいいい。うううううううううううう。 これをフォーム上のテキストボックス（Multiline=true）に下記のように表示したいのですがどのようにすればよいのでしょうか？ ああああああああああ。 いいいいいいいいいいい。 うううううううううううう。 できれば、改行したデータをそのままフィールドに持てればいいのですが、そのようなことができるのでしょうか？
教えてください SELECT stayday,roomtype ,sum(roomnum)　AS　sumroom from details WHERE stayday >= '20080921' and stayday <= '20080927' GROUP BY stayday,roomtype ; 結果 +----------+----------+---------+ | stayday | roomtype | sumroom | +----------+----------+---------+ | 20080921 | SD | 22 | | 20080921 | SS | 22 | | 20080922 | SD | 15 | | 20080922 | SS | 15 | | 20080922 | TS | 15 | | 20080923 | SD | 15 | | 20080923 | SS | 15 | | 20080923 | TS | 15 | +----------+----------+---------+ ここからSD、SSのsumroomの最大値をとってこれるようなSQLは作れますか？ +----------+----------+---------+ | stayday | roomtype | sumroom | +----------+----------+---------+ | 20080921 | SD | 22 | | 20080921 | SS | 22 | --------------------------------- 最終的に↑のようにしたいのです。 しかしわたしには一番上のSQLをつくるので限界です 誰か助けてください。 どうか教えてください
SQLServer2005を使っての暗号化について教えて下さい。 次のコードを実行し、暗号かされたレコードを複数行登録します。 (データベースを直接覗いてみるとうまく暗号化されて登録はされております) OPEN SYMMETRIC KEY DES_KEY DECRYPTION BY PASSWORD = 'KeyPass'; INSERT INTO ANGOU_TEST ( NAME_SEI, NAME_MEI ) VALUES ( EncryptByKey(Key_GUID('DES_KEY'), '1'), EncryptByKey(Key_GUID('DES_KEY'), '1') ) その後SELECT文で複合をして表示すると、NULLとして表示される行がまれにあるのです。 (うまく行かない行とうまく行く行がまばらに出来てしまうのです...) OPEN SYMMETRIC KEY DES_KEY DECRYPTION BY PASSWORD = 'KeyPass'; SELECT CAST(DecryptByKey(NAME_SEI) AS VARCHAR(64)) AS NAME_SEI, CAST(DecryptByKey(NAME_MEI) AS VARCHAR(64)) AS NAME_MEI FROM ANGOU_TEST ちなみに、鍵は次のような方法で作りました。 CREATE MASTER KEY ENCRYPTION BY PASSWORD = 'KeyPass' CREATE SYMMETRIC KEY DES_KEY WITH ALGORITHM = DES ENCRYPTION BY PASSWORD = 'KeyPass' なぜこのような現象が起きてしまうのかご教授お願いします。
過去ログを探っていろいろ試したのですが、うまくいかないので 教えてください。 TABLE1 に存在しない TABLE2 のデータをDELETEしたいのですが TABLE2 の対象年月（item2の内容）が、指定年月以上の条件で DELETEしたいのです。 ●指定月＝2008/02 の場合 ＜TABLE1＞ key1　key1　key1　item1　　item2 a　　　a　　　a　　　あ　　　2007/12 b　　　b　　　b　　　い　　　2007/12 c　　　c　　　c　　　う　　　2007/12 ＜TABLE2＞ key1　key1　key1　item1　　item2 a　　　a　　　a　　　あ　　　2007/12 b　　　b　　　b　　　い　　　2007/12 c　　　c　　　c　　　う　　　2007/12 d　　　d　　　d　　　え　　　2008/01 （削除しない） e　　　e　　　e　　　お　　　2008/03 （削除対象） ＜DELETE結果 TABLE2＞ key1　key1　key1　item1　　item2 a　　　a　　　a　　　あ　　　2007/12 b　　　b　　　b　　　い　　　2007/12 c　　　c　　　c　　　う　　　2007/12 d　　　d　　　d　　　え　　　2008/01 よろしくお願いします。 （環境：SQL Server2005 Standard）
こんにちは。 こんにちは。 標記の件で質問です。 sql serverに接続しようとすると「サーバーへの接続　サーバーへの接続を確立しようとしているときにエラーが発生しました。…リモート接続を許可しないようになっていることが、エラーの原因の可能性である」 の警告が出て、接続できません。 すみませんが、お分かりの方返信お待ちしております。
SQLserver2000の販売管理システム上で、ほぼ毎日在庫集計処理を行っています。以前に比べて集計処理が遅くなったので、プロファイラでトレースして、ボトルネックとなるSELECT文を突き止めたところまでは良かったのですが、そのDBのフルバックアップを取り、同じ環境を構築したサーバーにDBを移し、処理を実行したところ、ボトルネックとなる事象が再現されませんでした。２台のサーバーの差異を比較して、色々試みたのですが、現行システムの集計処理が改善できません。何か方法があればぜひ教えて下さい。 【現行システムで試した事】ログファイルの切捨て、DBの圧縮、インデックスの最適化、HDDのデフラグ 【プロファイラの値】CPU:現-148250、新-11484 Reads:現-62578066、新-46549 Writes:現-14、新-0 Duration:現-1492046、新-13280
SQLSERVER2000の運用を始めたのですが、お聞きしたいことが ありご質問しました。 環境 SQLSERVER2000 Standard Edition 既存のテーブルの項目を、wordなどでスキーマ表を作成したいのですが、自動で表を作成するなどの機能はないのでしょうか。 （作業ではEnterprise Managerなどを使用しています。） アドバイスを頂ければと思いますのでよろしくお願い致します。
クライアントPCのデータソースの新規作成で、SQLSERVER 2008（評価版）への接続がエラーになってしまいます。 ＜環境＞ サーバー 　OS：Windows Server 2008 Standard 　SQLSERVER:SQL Server Enterprise Evaluation Edition (64-bit) 　（評価版） クライアント 　OS：Windows XP Professional SP3 ＜データソースの新規作成＞ １．ODBC データソース アドミニストレータで、ファイルDSNを選択し、追加ボタンを押下。 ２．データソースの新規作成で、SQL Serverを選択し次へ。 ３．データソース名を入力し、次へ。 ４．完了ボタンを押下。 ５．接続するサーバーでSqlServer2008のを選択する。 ６．ユーザーが入力するSQL Server用のログインIDとパスワードを使う　を選択し、ログインID：sa　パスワードを入力し次へ。 ６．で、次へを押下すると以下のようなメッセージが表示されます。 ---------------以下、エラーダイアログのメッセージ----------- 接続できませんでした。 SQLState:'01000' SQL Server エラー:5 [Microsoft][ODBC SQL Server Driver][IDBNETLIB]ConnectionOpen(Connect()) 接続できませんでした。 SQLState:'08001' SQL Server エラー:17 [Microsoft][ODBC SQL Server Driver][IDBNETLIB]SQL Server が存在しないか、アクセスが拒否されました。 ---------------------------------------------------------------- その他、検証した内容として １．SQLSERVERのサーバー認証は、混合モードに設定してあり、データソース作成時に、ログインIDでも試みましたが結果は同様でした。 ２．同様の方法で、同クライアントから、Windows Server 2000 + SQLServer 2000 での接続は、問題無く出来ています。 ３．サーバー上でのデータソースの作成で、同サーバーへの接続も試みてみましたが、同様の方法で、問題無く出来ました。 クライアントのＭＤＡＣのバージョン等が関係しているのでしょうか？ どなたか、ご存知の方がいらっしゃいましたら、ご教授の程、よろしくお願い致します。
インデックスを再構築するジョブを作成し毎日実行しています。 ちょうどその時間にSELECTが実行されて タイムアウトしてしまいました。 再構築中は結果が返ってこないのでしょうか？
SQL Server 2005を使っていますが、SJIS形式で格納された、Oracleの データを、SQL ServerのUNICODEで構成されたテーブルに、ロードする 必要があります。 Oracleでは、異なる文字コードの場合、SQL Netが自動的に、文字 コードを判断して、自動変換してくれますが、SQL Serverでは、 どのようになりますか？SQL Native Client等が、自動変換してくれる のでしょうか？ お手数ですが、どなたかお教え下さい。
Windows server 2003 + SQL server 2000の環境にあるDBがあります。 同じネットワーク上のWindows XP Pro + Access2000のPCからそのサーバのDBへデータをINSERTするのにはパススルークエリを使えという話になりました。 そのサーバへODBC接続の設定はできています。 パススルークエリの情報が乏しく、どのようにしたらよいのかちょっとわかりません。 どなたかご教授よろしくお願いいたします。
SQLServerのDBデータ（ldf,mdf）のディレクトリを移動したいのですが、 可能でしょうか？ 不可能であれば、移行する方法はあるのでしょうか？ 新規作成してコピーなど。
お世話になります。 CREATE TABLE [AAAA] ( [ID] [decimal](5,0) IDENTITY (1,1) NOT NULL, 以下項目が続きます CONSTRAINT [PK_AAAA] PRIMARY KEY CLUSTED ( [ID] ) ON [PRIMARY] ) ON [PRIMARY] で作成されたテーブルがあります。 insertの度、[ID]は1ずつインクリメントされ、 又deleteされます度、当該[ID]番号は削除されて行く事と思います。 この削除されました[ID]の所にデータをinsertすることは可能でしょうか。 初歩的な質問で大変申し訳ございませんが、ご教授頂けますよう よろしくお願いいたします。
Access2003とSQL Server2005Expressです。 初歩的な質問で恐縮です。 以下のストアドプロシージャのデータ取得先を、テーブルではなく 別のストアドプロシージャにしたいのですが、 その方法がわかりません。 CREATE PROCEDURE テスト AS SELECT コード, 社名, 住所, 電話 FROM 名簿 　　　　↑ 　　　　これをテーブルではなく、別のストアドプロシージャを 　　　　指定したのですが・・・。 　　　　ここをストアドプロシージャ名にするとエラーになります。 　　　　どうすればよろしいでしょうか？
Windows Server 2003 SP2、SQL Server 2000 SP3の中のデータテーブルをaccess2000のmdbにリンクしたいのですが、ODBC経由で新規接続の設定を進めていくとリンクテーブル選択の時にテーブルが何も表示されません。 ご存知の方、解決方法や他に調べるところ、ヒントなどご教授いただけると大変ありがたいです。 よろしくお願いいたします。
Windows2003R2SP1 の AcitveDirectory環境 に SQLServer2005 で私以外の人間が構築したＤＢシステムが有ります。 ＤＢ構成も判らない状態でServerPC本体のマシーン変更に伴いＤＢの移行を行いたいのですがWindows系の知識はあってもSQLServerの知識がなく困っております。 ＤＢ（SQLServer）のマシーン移行おける手順及び参考資料・Web等有りましたらお教え願いませんでしょうか？よろしくお願い致します。
VB2008でプログラムをしています。 データベースのSQL文でエラーが解決できません。　どなたか教えてください。 －内容ー データベースにテーブルを追加したいのですが、フィールド名に半角（No)を使うとエラーになります。 全角(Ｎｏ)に変えるだけでエラーはなくなりますがその理由がわかりません。 <エラー> Com = New OleDb.OleDbCommand("CREATE TABLE 物件(No INTEGER), cn) Com.ExcuteNonQuery() <正常> 　　 Com = New OleDb.OleDbCommand("CREATE TABLE 物件(Ｎｏ INTEGER), cn) Com.ExcuteNonQuery()
早速ご教示ください。 例えば、テーブルA,テーブルB,テーブルC・・・・テーブルZまでテーブルがあるデータベース(TEST_db)があるとします。 【流れ】 (1)TEST_dbの完全データベースバックアップをとります。 (2)テーブルC～テーブルFをDELETE FROM文で削除します。 (3)上記(1)でとったバックアップファイルから(2)で削除したテーブルC～F　を復元できますでしょうか？ 　できるのであれば、その方法を、できないのであればなにか提案を宜　しくお願い致します。
index　|　id　 |　param ------------------- 001　　|　1　　|　犬 001　　|　2　　|　猫 002　　|　1　　|　猿 003　　|　1　　|　雉 003　　|　2　　|　馬 というようなテーブルがあり、これをSQLで取得した時に、 index　|　param(id=1) |　param(id=2) ---------------------------------- 001　　|　犬　　　　　|　　猫 002　　|　猿　　　　 　| 003　　|　雉　　　　　|　　馬 といった結果で取得することは可能でしょうか？ ・結果では必ずindexは重複させない。 ・idは必ず1か2、もしくはid=2がない。 joinやunionなど試してみましたが、書き方が悪いのか求める結果が得られませんでした。 ご教授いただければと思います。
色々な質問を見たのですが　環境などの違いもあり解決できず 困っています。 環境は１台のＰＣ（W2000）にIIS＋ＳＱＬサーバー２００５デベロッパーエディションとか言うテスト用のバージョンをインストールしています。 また　ＳＱＬサーバーはWindows認証を使っています。 SQLサーバーにマネジメントエキスプレスで接続して システムデータベースにPLEMIAというデータベース名を作り テーブルのシステムテーブルにpure_kihonというテーブルを作っています。 ASPにて試験的につないでみようと思い Dim objCon Set objCon = Server.CreateObject("ADODB.Connection") objCon.ConnectionString = "Provider=SQLOLEDB;" & _ "Data Source=(local);" & _ "Initial Catalog=PLEMIA;" & _ "Integrated Security=SSPI;" objCon.Open strSQL = "SELECT * FROM [pure_kihon]" objRS.Open strSQL, objCon, 3 こうした場合　 objCon.Open のところで引っかかり Microsoft OLE DB Provider for SQL Server (0x80004005) [DBNETLIB][ConnectionOpen (Connect()).]SQL Server が存在しないか、アクセスが拒否されました。 と出てしまいます。 SQLサーバー自体は稼働しているようなんですが 何がいけないのか　よく分かりません。 どなたか解決策などご教授頂けると幸いです。 よろしくお願いします。
表A　　　　　　　　　　　表B 商品ID　数量　価格　　　　商品ID　商品名　 ------　----　----　　　　------　------ 0001　　　10　1000　　　　0001　　万年筆 0002　　　50　200　　　　 0002　　ボールペン 0003　　　25　600　　　　 0003　　シャーペン 0004　　 150　2000　　　　0004　　文房具セット 0005　　　20　420　　　　 0005　　ノート SELECT 数量,価格,商品名,商品ID FROM 表A,表B WHERE 表A.商品ID = 表B.商品ID とやると恐らくこんなような表ができると思います。 商品ID　数量　価格　商品名　 ------　----　----　------ 0001　　10　　 1000　万年筆 0002　　50　　　200　ボールペン 0003　　25　　　600　シャーペン 0004　　150　　2000　文房具セット 0005　　20　　　420　ノート ここで、表の行数を6で割ったときの余りの数を表に追加して全体の行数を6の倍数にしたいと思っています。 (ID 0006として空行を追加) しかし、この表の行数を取得するためにCOUNT関数を使うと思うのですが、使い方が分かりません。 COUNT関数を使うにはGROUP BY句とHAVING句を扱うらしいのですがSELECT句にある列名全部をGROUP BY句に入れないといけないらしく思ったとおりのことが出来ません。 上記のSQLとCOUNT関数を１つのSQLで表の作成と行の行数を得たいと思っています。（ここでは、5行なので5という値を取得したい。） また、最後にどうやって空行を追加すれば良いかも分かりません。 具体的なSQLのソースなど、どなたか分かりましたら、教えてください。
データベースの接続方法について勉強しています。 ADOやDAO,ADODB,OLDDBやODBC等調べていて混乱しています。 上記について分かり易い書籍をご存知でしたら教えていただけませんでしょうか。 現在使用している環境は ・SQLserver2005 ・VB 2008 です。
VB2005 Express Editionを使用しています。レコードの追加を以下のように行っておりますが、追加されません。プログラミングの世界に入ったばかりでどこが違うのか全く分かりません。ご教授ください。また、参考になるサイトがあれば教えてください。 Dim Cn As New SqlConnection Cn.ConnectionString = "Data Source=.\SQLEXPRESS;AttachDbFilename" & "=|DataDirectory|\Database1.mdf;Integrated Security=True;" & "User Instance=True" Dim cmd As New SqlCommand cmd.Connection = Cn cmd.CommandText = "INSERT INTO USER_ID (ユーザー名, パスワード) VALUES ('AAA', 'XXX')" Cn.Open() cmd.ExecuteNonQuery() Cn.Close()
宜しくお願いします。 最近、SQL Server2005の勉強を始めました。 参考書を見ながら自分のPCでデータベースを作ってみました。 これを、他の事務所にあるPCでも編集（テーブルや列を追加）したいのですが、やり方がわかりません。 他の事務所にあるPCにもSQLServer2005がインストールされており、開発環境は自分のPCと同じです。コンピュータ名やサーバー名は違いますが…。 Accessの時は、mdbファイルを持ち歩けば事務所のPCでも簡単に編集ができましたが、SQLServerでも同じような事は可能でしょうか？ とりあえず自分で調べて 「C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\Data」 の中にある、拡張子が「mdf」、「ldf」のファイルをUSBメモリにコピーしたのですが、 事務所にあるほうのPCからどのように開くかよくわかりません。 考え方が間違っているのでしょうか？ とても初歩的な質問で申し訳ございませんが方法や参考サイトなどご存知でしたら教えてください。
SQLサーバからテーブルの項目名、属性（型）を取得するには、どのように クエリを組めば良いのでしょうか？
SQLについての質問です。 Join句を使ってテーブルを結合しています。 Aテーブル（社員データ）に存在する勤務区分フィールドの値に対応して、 Bテーブル（勤務データ）から勤務区分（一意）に対応したデータを持って来るSQLを作成したところ、 Bテーブルに存在しない勤務区分を持つAテーブルのデータは結果に出ませんでした。 このように、結合したBテーブルに対応するデータが無い場合でも、Aテーブルに存在するデータを全て出したい場合、 何か方法はあるのでしょうか？ 現在は一度Aテーブルから全てのデータをセレクトした後に、１件１件ループしてBテーブルからセレクトする方法をしていますがもっと簡潔にできるなら簡潔にしたいと思っています。 どなたかお答え頂けると幸いです。よろしくお願いします。
http://oshiete1.goo.ne.jp/qa4165327.html 先日上記の質問をさせていただいたのですが、 検索条件が２セットになり、またまた困っている状況です。 前回通り、検索条件間、グループ間での逆転等はＯＫです。 度々申し訳ないですが、どなた様か知識がある方にご教授願いたく思います。 宜しくお願い致します。
SQL server 2005についての質問です。 ISNULL関数を使うと、Nullをゼロとして取り出せることがわかりました。 しかし、空文字をゼロとして取り出すことはできないようでした。 Nullと空文字が入り混じったカラムを対象に、Nullだけでなく空文字もゼロとして取り出す関数などはあるでしょうか？ 以上、どうぞよろしくお願い致します。
お世話になります。 テーブルにレコードをインサートをすると、内部でRowIDが振られると思いますが、 この値を確認する方法は御座いますでしょうか。 ご教授頂けますよう、よろしくお願いいたします。
初歩的な質問ですいません。 (1)データベース容量とは、イメージ的にはHDD容量と同じと考えていいのでしょうか (2)SQL severを構築した場合、既存でローカルにあるHDD容量とは別に、データ保存容量が増加すると言うことでしょうか？ （例）既存HDD：100GにSQL severデータ容量4Gをインストールした場合、総データ容量が104GBになる 上記イメージであってますでしょうか？ (3)データベース容量がいっぱいになった場合、データベース保存情報をローカルのHDDに保存し、データベースから削除することはできるのでしょうか。 (4)SQL sever価格にあるOpen BusinessとSelectAの違いについて教えていただけませんでしょうか
ACCESSのようなODBCでデータベースに接続し、検索・追加・更新・削除ができるようなフリーウェアで良いものがあれば教えてください。
お世話になります。 早速ですが、Topを使って上位3番までの値を抽出し、 その値を1レコードに出力させたいのですが、SQL文のみでの出力方法が思い浮かびません。 どなたか、知恵をお貸しください。 【通常の出力】 中国 39 米国 22 英国 12 【やりたい出力】 中国39 米国22 英国12
OS Windows Server2003 バックアップを取るため SQL Serverサービスをタスクで自動で開始と停止をやりたいんですが、 バッチを組み実行したところ、開始は問題ないのですが 停止するときにバッチがそのまま止まってしまいます。 ログを調べたところ次の文面が表示されていました。 ※「次のサービスは MSSQLSERVER サービスに依存しています。 MSSQLSERVER サービスを停止すると、これらのサービスも停止されます。 　　　SQLSERVERAGENT この操作を続行しますか? (Y/N) [N]: 」 コマンドプロンプトで「ｙ」を実行すると停止します。 このようにバッチを組んでいます。 開始バッチ set log=c:\log\SQL-service-start.log net start mssqlserver >> %log% net start SQLServerAgent >> %log% 停止バッチ set log=c:\log\SQL-service-stop.log net stop mssqlserver >> %log% 申し訳ございませんが、ご教授の方お願いします。
初歩的な質問で恐縮です。 SQL Server2005 Express を使っています。 テーブルやストアドプロシージャの項目名の先頭に算用数字は使え ないのでしょうか・・・？ たとえば、「4月期売上」のようにするとエラーになります。 （漢数字「四月売上」にするとＯＫです） よろしくお願いします。
現在、Windows XP Pro、SQL Server2005 Developer Editionで開発を行っています。 行いたいことは、DMLトリガによって入力画面のあるプログラム(例えばメモ帳など)を実行したいと思っているのですが、下記のサイトで調べた結果、xp_cmdshellではできそうもありません。 そこで、どうにかして入力画面のあるプログラムを実行したいと思っているのですが、なかなか見つからず困っています。 (セキュリティに関しては、無問題とします。) SQL Server 2005でこのようなプログラムを作成できますか？ また、どのようにすれば良いでしょうか？ 具体的なソース、参考サイト等ありましたら、教えてください。 よろしくお願いします。 参考サイト：http://support.microsoft.com/kb/323411/ja
今回、訳あってSQL2000Severを導入する事になり勉強中です。 今までAccessでDB更新/追加/削除は経験あり、ＨＰを見ても移行は簡単なイメージがありましたが、更新クエリーだけイメージがあいません。 TBL A /TBL B の２つのTBLがあり、TBL Aの項目をTBL　Bで更新しようとする場合,Accessならクエリーで2つのTBLを追加してTBL AをTBL Bの項目で更新できたのですが、DTSデザイナで更新を選択するとTBL Aしか追加できません。 又、クエリアナライザを使ってもJOINの後の構文エラーから先に進めない状態です。 初歩的質問で申訳ありませんが、助言できる方がいらっしゃいましたら助けて下さい。 サンプルSQL UPDATE [TBL A] AS A INNER JOIN [TBL B] AS B ON A.KOUMOKU = B.KOUMOKU SET [A].[TANKA] = [B].[TANKA]; キーワード 'AS' 付近に正しくない構文があります。
初心者です。よろしくお願いします。失敗してしまい非常に困ってます。 SQL SERVER 2005です。 SQL SERVER認証でローカルサーバーに接続しています。 そのローカルサーバーにAという名前のデータベースがあったのですが 間違えて名前をBに変えてしまいました。 そしたらSQL SERVERに接続出来なくなりました。 Aという名前で接続してたときと同じログイン名とパスワードを使用したら localhostに接続出来ません。 ユーダーの既定のデータベースを開けません。 ログインに失敗しました。 ユーザー"(ユーザー名です)"　はログイン出来ませんでした。 microsoft SQL server　エラー4064 というエラーが出ました。 どうにかして元のAというデータベース名に戻したいです。 http://support.microsoft.com/kb/307864/ja　を参考にコマンドプロンプトで下記の作業を行いました。 　 SQL Server ログインで SQL Server 認証を使用してインスタンスに接続している場合は、コマンド プロンプトで次の行を入力し、Enter キーを押します。 sqlcmd -S InstanceName -d master -U SQLLogin -P Password 注 : InstanceName には、接続先の SQL Server 2005 インスタンスの名前が入ります。SQLLogin には、既定のデータベースが削除されている SQL Server ログイン名が入ります。Password には、SQL Server ログインのパスワードが入ります。 3. sqlcmd プロンプトで次の行を入力し、Enter キーを押します。 ALTER LOGIN SQLLogin WITH DEFAULT_DATABASE = AvailDBName 注 : AvailDBName には、SQL Server ログインでアクセスできる、そのインスタンス内の既存のデータベースの名前が入ります。 4. sqlcmd プロンプトで GO と入力し、Enter キーを押します。 これを実行してもBというデータベースに接続(？)は出来ましたが 名前をもとに戻すことが出来ません。 いくら調べても分からないので(調べ方が悪いのかも知れませんが・・) どなたか教えていただけないでしょうか。よろしくお願いします。
どうして、sqlserverには、空文字が存在するのでしょうか？ oracleには、空文字は存在せず、すべてnull値として扱ってくれて非常に、わかりやすいです。 他にも、マイクロソフトの製品（Access,やvbの変数)は、空文字を扱っていますが、空文字を扱うとは、何かメリットあるのでしょうか？ わたしは、プログラマーですが、うっとうしくてほかなりません。
sqlcmdから指定の時間に、sqlを実行したいのですが、方法がわかりません。 プロンプトを立ち上げて、 sqlcmd !!sqlcmd -E -d db -i c:\a.sql -o c:\1.txt の実行で、読み込んだsqlが1.txtに出力される事までは、確認できています。 申しわけありませんが、ご存知の方ご教示宜しくお願い致します。
以下のようなコマンドをバッチファイル（.bat）に記載し、実行しています。（ローカルのsqlserverにwindows認証で入れる事は確認済みです。） !!sqlcmd -E -d database -i c:\sql\a.sql ですが、バッチを実行してもsqlcmdが動作せず、 「'!!sqlcmd'は、内部コマンドまたは外部コマンド、操作可能なプログラムまたはバッチファイルとして認識されていません。」 というエラーが発生します。 バッチファイルから、sqlcmdの実行方法をご存知の方、申し訳ありませんがご教示お願いします。
お世話になります。 会社でSQLServerを使っており、その中から必要なデータのみエクセルで取り出そうと考えていますがどうもうまくいきません。 日付（datetime型）を含むデータの中から今日の分のデータだけピボットテーブルでエクセルに取り出す場合、MSクエリを使って抽出するときの方法を教えてください。（getdate（）を使ってみましたが”getdateは組み込み関数名として認識されません”とエラーが出ます。 よろしくお願いします。
お世話になります。 初歩的な質問かもしれませんが、よろしくお願いします。 SQL Server 2000 を使用しています。 比較的大きいサイズのデータベース「A」があります。 Dataフォルダ内のサイズは次の通りです。 ・A.mdf 50MB ・A_1.mdf 4.4GB ・A_log.ldf 1.2GB この「A」を別の用途で使用したいため、全てのテーブルのデータを削除しましたが、Dataフォルダ内のサイズがほとんど変わりません。 プロパティのデータベースの圧縮で見ると、空き容量が９８％と表示されているので、無駄な領域が多いのは分かるのですが、実際に圧縮をかけても小さくなりませんでした。 方法が悪いのかもしれませんので、データベースを圧縮する手順を教えて頂ければ幸いです。 よろしくお願いします。
こんにちは。 SQL Serverから外部プログラムを呼び出すストアドプロシージャを作りたいと思っていますがなかなか上手くいきません。 データベースの内容が変わったときに(INSERT,DELETE等で)特定の外部プログラムを実行するストアドプロシージャを作りたいと思っています。 （SQL Serverに関してまったくの素人なので言葉に誤りがあるかもしれません） 外部プログラムを呼び出す機能として、拡張ストアドプロシージャでxp_cmdshellというものがあるらしいのですが、sysadminユーザしか使うことが出来ず、セキュリティ上にも問題があるとのことなので、xp_cmdshellを使わずに外部プログラムを呼び出す方法を探しています。 具体的な方法、ソース等ありましたら、教えてもらえないでしょうか？ また、そんなこと出来ないと言ったことでも教えてもらえると助かります。 現在の環境 Windows XP Professional SQL Server 2005 Developer Edition 宜しくお願いいたします。
データベースの選定についてアドバイスお願いします。 現在は各個人用のPC数台と共用PC1台をLANで結んでいます。 共用PCにはアクセスで作成したシステムが入っており、このシステムを利用する者が必要なときに共用PCを使って作業しています。 アクセスの運用はデータ保存テーブル用MDBファイルとアプリケーション用MDBファイルを接続して利用しているという状況です。 最近になって各個人のPCからデータベースを利用する方が便利だろうということでシステムの改良を考えています。 共用PCをデータベースサーバーとして運用することで問題を解決できると思うのですが、具体的にどのような方法が最適なのかアドバイスをお願いしたいのです。 1)各個人用PCにアプリケーションMDBファイルを配布して、サーバーにはデータ保存テーブルMDBを置く。 2)SQLサーバーを導入する。 1)の方法が一番お手軽だと思っていますが、MDBは同時に複数が使用することができないということなので問題が生じる可能性があります。 しかし、そういうケースはそれほど多くないと思われますので実際の運用面では大きな問題は発生しないかもしないだろうと考えています。 ただ、あくまでもアクセスファイルは共有することを念頭に置いていないらしいので不安もあります。 2)の方法はSQLサーバー導入のハードルが高いですが、時間的余裕は多少ありますので余っているPCでテストしながらチャレンジする価値はあると考えています。 この場合、どのSQLサーバーを選定するかが問題となります。 データ件数がMDBの限界を超える心配は当面ありません。 現在のところ、一日に共有PCを使ってアクセスを利用する頻度は多くても10回までです。 SQLは無償で利用できるものを考えています。具体的にはMySQLかマイクロソフトのSQL Server Expressです。 アクセスは一般的な作業ならこなせますが、SQLサーバーは全く初心者です。もちろん勉強する意志はあります。 この状況を踏まえた上でデータベースを選定するなら、どの選択がよいでしょうか？ ・導入の容易さ ・システムの安定性 の面からのご意見をお聞かせ下さい。 具体的な移行方法については自分で調べるつもりです。 宜しくお願いします。
SQL SerVer 2005　+　Access(adp)　にてDBを作成しています。 あるレポートのサブレポートに一時テーブルの値を使用したいのですが、 表示されません。 作成したSQLは下記で、EXECでは表示されます。 Access側のクエリを開こうとすると、 「ストアドプロシージャは実行されましたが、レコードは返されませんでした」 という結果が返ってきます。 SQL側の一時テーブルをAccessのレポートのソースにするにはどうしたらいいのでしょうか？ 教えてください。 注：ダイレクトにサブレポートを作成すると、メインレポートとリンクしません。 　　新規にテーブルを作成したものは、メインレポートとサブレポートがリンクします。 　　しかしあるレポートのためだけに、二重にテーブルを作成したくありません。 　　一時テーブルで済ませられるのなら、そうしたいと思います。 　　よろしくお願いします。 ---------------------------------------------- --伝票分の業者請求書　レポートに表示する ---------------------------------------------- ALTER procedure [dbo].[S_業者請求伝票分R] @myid int as begin ---一時テーブルの作成 　　　create table #業者請求 　　　　　(kr発注物件ID int, kr発注ID int, kr業者請求日 datetime, kr業者請求額 money, kr最終支払 smallint, 　　　　　kr請求メモ nvarchar(7),kr会社名 nvarchar(30),kr特記 nvarchar(20),kr受注登録ID int) ---一時テーブルに値を代入 　　　insert into #業者請求(kr発注物件ID, kr発注ID, kr業者請求日, kr業者請求額, kr最終支払, 　　　　　　kr請求メモ,kr会社名,kr特記,kr受注登録ID) 　　　SELECThh.発注物件ID, ga.発注ID, ga.業者請求日, ga.業者請求額, ga.最終支払, 　　　　　　ga.請求メモ,zz.会社名,hh.特記,hh.受注登録ID 　　　FROM dbo.T_業者請求 AS ga left outer JOIN 　　　　　　　dbo.T_発注 AS hh ON ga.発注ID = hh.発注ID INNER JOIN 　　　　　　　 dbo.T_住所 AS zz ON hh.会社ID = zz.会社ID 　　　wherehh.受注登録ID=@myid end begin 　　　　select*from#業者請求 end
データベースなどにあるIDENTITY列とは何でしょうか？AutoNumber型と理解しているですが、間違ってないでしょうか？
質問すべき場所が適合していなければ申し訳ありません。 データベースの勉強を最近始めたのですが、以下のような問いがあり、それに対してどのような回答をすればいいのかわかりません。 是非教えていただきたく思います。 また、データベースの勉強を一から始めるにあたってどのように勉強していくのがいいのか教えていただけたら幸いです ―　問　― バスケットボールのリーグ戦における1シーズンのデータを取るために、次の関係スキーマXとYに基づく2つの関係表を持つ関係データベースを考える。 ・選手の所属チーム情報　X　（氏名、所属チーム） ・試合における得点情報　Y　（氏名、所属チーム、相手チーム、得点時間） ただし、関係データベースは次の条件を満たす。 ・同じ対戦相手とは一度だけ試合をする。 ・データベース中の選手とチームは名前により一意に識別される。 ・試合の得点は得点した選手の所属チームに対し、すべて2ポイント与えられ、3ポイントやフリースロー等による1ポイントの得点はないものとする。 ・選手はシーズン中に移籍により、複数のチームに所属することがある。 ・得点開始時間は試合開始から経過時間を分単位で記録し、同じ対戦カードで同一の時間帯には複数の得点者はいないこととする。 ・どのチームにも複数の選手が所属している。 このようにデータが与えられている場合に以下の情報を求める方針を関係代数を用いて式として表せ。 また、関係代数の利用可能な演算は集合演算（和、差、積、商）、選択、直積、射影がある。 １）複数のチームに所属した選手 ２）Aというチームから得点を取られたことのないチーム ３）少なくとも一試合で１５分以降に得点したチーム ４）所属したことのある全ての選手がシーズンを通して得点を取ったことのないチーム
SQL ServerにODBC接続するために、DSN登録しようとしているのですが、 うまくいきません。 ドライバはSQL Serverを選択し、 サーバ名「PC16\SQLEXPRESS」 「SQLServer用のログインIDとパスワードを使う」 でログインID,Passを入力した際、 「sa」だと次へ進めるのですが、他のユーザだと 「ユーザー'XXXX'はログインできませんでした」 というメッセージが出てしまいます。 DB側では、TCP/IPを有効にしてあり、FireWallの例外にも追加してあります。 解決方法ご存知の方、よろしくお願いします。
いつもお世話になります。 SQLServerで自動採番される仕組みで何かいい方法がないかどうか悩んでいます。 主キーとなる項目に自動採番された値を、アプリケーションでセットした上で、DBに追加する仕組みを考えています。 OracleではSequenceのnextvalなどを使用すれば、番号を自動採番したものを取得することが可能ですが、 SQLServerでこのような仕組みを実現するために何か良い方法はありませんでしょうか？ （追加先のDBはSQLServerではなく、自動採番等の機能も無いため、追加する前にアプリケーションでセットする必要がある。） 今までOracleしか使用したことが無く、SQLServerは初めてなので、ご教授頂きたく投稿しました。 よろしくお願いします。 SQLServerは2005を使用しています。
お世話になります。 SQLServer7.0をつかっております。 プログラムやハード環境は何にも変わらないのですが、急にロックが頻発するようになりました。 複数ユーザーが同時に使用しているので、ロックがかかるのは普通の事なんですが、SQL　EnterPrise Manager で確認すると、ブロッキングがなく、お互いがお互いをブロックしているという形になっており、手動で強制終了するしかない状況です。 お互いがの場合はデッドロックになり、自動で強制終了されると思うのですが、それも起こりません。 何故、デッドロックにならないのか分からず悩んでおります。 何かの設定なのでしょうか？サーバーの再起動をしてみた方が良いでしょうか？アドバイスお願いします。
いつも勉強させて頂いています。SQL文について困っています。 -環境- .NET FreamWork2.0 VB　SQLSERVEREXPRESS -SQL- インサート時にオートナンバーを取得してデータを追加しているのですが、追加後にオートナンバーの値を戻す（取得する）ことは可能でしょうか？SQL文は下記です。 INSERT INTO マスタテーブル VALUES((SELECT MAX(オートナンバー) + 1 FROM マスタテーブル), 商品名・・・・ 上記で登録されたオートナンバーを別テーブルに格納したい為です、リアルタイムで処理しますので、発行したオートナンバーが即時に必要です。 テーブル更新時に　 Dim Ret_Table As DataTable = AS_Cmd.ExecuteScalar() とするとテーブル内容がNothingになります。 他の方法も御座いましたら教えて頂けると幸いです。宜しくお願い致します。
タイトル通りです。うまく動作しなくて困っています。 使用可否を明確に知りたいのでよろしくお願い致します。
はじめまして。 SQL server 2005 と VB2005 を使用してテーブルの更新を 　連続で実行すると、なぜか、250件更新するごとに 　次の9レコード分更新クエリのレスポンスの時間が異常に長い 　のです。その後、また、250件更新の更新クエリは早く 　処理をされるのですが、更に次の9レコード分更新クエリの 　レスポンス時間が異常に長いのです。以後250件レコードの更新 　ごとに9レーコド分更新のレスオンスの時間が異常に長く繰り返 　されます。たぶんエラーが発生していると思われますが、 　どうして250件レーコドに9件のレコードの更新クエリがエラー 　でるのかわかりません。仕方ないので、エラーの出たレコード 　を事前に削除して再度実行しても、やはり、250レコード 　ごとに9件のレコードがエラーが出てレスポンスに時間が掛かります。 　なにか、SQL Serverに設定するのがあるのか、または 　SQL文に間違いがあるのか、教えて下さい。 　接続方法はOLEDBで接続しています。OLEDBの接続では 　ダメなのでしょうか？。 　下にソースを記載します。 dim 肝炎B as long dim cq as string dim Db As new System.Data.OleDb.OleDbConnection Dim CDBkanjya As System.Data.OleDb.OleDbDataReader Dim CDBkanjyaC As new System.Data.OleDb.OleDbCommand Dim CDBkanjyaCw As new System.Data.OleDb.OleDbCommand cq = " SELECT 患者ID , 患者名 " & _ " FROM kanjya " & _ " ORDER BY 患者ID " & _ " " Db.ConnectionString = "Provider=SQLOLEDB;Data Source=kokoro00;User ID=sa;Password=kokorocenter;Initial Catalog=kokoro" Db.Open() CDBkanjyaC.Connection = Db CDBkanjyaCw.Connection = Db CDBkanjyaC.CommandText = cq CDBkanjya = CDBkanjyaC.ExecuteReader Do While CDBkanjya.Read ..... ..... ..... ..... ..... cq = " UPDATE kanjya " cq += " SET 肝炎B = " & 肝炎B.ToString cq += " WHERE 患者ID = " & CDBkanjya.Item("患者ID").ToString & " " CDBkanjyaCw.CommandText = cq CDBkanjyaCw.ExecuteNonQuery() Loop CDBkanjya.Close() CDBkanjyaC.Dispose() CDBkanjyaCw.Dispose() Db.Close() 　　尚、SQL Server でうまくいかないので、データベースをアクセスのMDB 　　ファイルに変換して、接続方法を Db.ConnectionString = "Provider=Microsoft.jet.OLEDB.4.0;Data Source=c:\sbj\kokoro\bin\kokoro.mdb" の JETエンジンでOLEDB接続して、その他は全く同じソースで実行した 　　場合は、なんら問題なく、全件更新出来ます。
毎度お世話になっております。 SQLSERVER2000とACCESS2003を使用しています。 画面から抽出条件を入力し、画面表示ボタンを押すと 抽出条件をWHERE句にしたパススルークエリが実行され、 在庫、入庫予定、入庫実績、出荷実績を計算、 画面表示するプログラムを作りたいと考えています。 パススルークエリはSELECT文ですが、 サブクエリが多くあり、 FROM句にはたくさんのテーブルが入ります。 また、他端末で実績入力中でも 入力中の実績は反映されなくてもよいので、 実行、画面表示したいのです。 他の質問を検索して、 http://oshiete1.goo.ne.jp/qa3392465.html SELECT文でもロックが発生することを知りました。 しかし、どのように対処するかは理解できませんでした。 ロックをおこすことなく他端末での実績入力も問題なく行われ、 画面表示もできるようにするにはどうすればよいのでしょうか よろしくお願いします。
はじめまして、今度の会社でSQLサーバを使用するのですが、今までSQLサーバは使用したことがありません。 何かよい勉強方法、書籍などはありませんでしょうか。 持っている環境と言えばMacのBootCampでインストールしてある、Windows VISTAしかありません。 お願いします、教えてください。
今、MCP（70-431）を受ける為、色々シミュレーション対策を 受験記等を見て、実際動かしながら情報を元に自分なりに やっているのですが、以下の３点の作成方法が分からなくて 対策ができなくて困っております。 ・スキーマの所有者の変更または、スキーマの移動 ・ビューにINSERTできないエラーの状況からの対処方法 (INSETED OFを使うと思いますが．．） ・ユーザ定義データ型列の削除(ユーザ定義型の削除) SQL Server 2005をやっております。 受験した経験がある方がいましたら情報を下さい お願いします。
MSSQLとMySQLのSQL文の違いについて 恐れ入ります。 最近仕事にて、MSSQLを使用することを前提に開発したWebアプリをMySQLでも使用できるようにすることになりました。 接続関連の処理は置き換えが完了したところなのですが、MSSQLとMySQLで実行できるSQL文が違う点で問題が発生しています。 検索してみてもSQL文の比較一覧などは見当たらないようです。 ご存知の範囲で教えていただけないでしょうか。 また、そういった比較一覧の資料、サイト、書籍等ありましたら教えていただけないでしょうか。 現在把握しているものは以下の通りです。 [MSSQ]L [MySQL] TOP句 LIMIT句 GETDATE() CURDATE() まだこの程度しか把握できておりません。 どうぞよろしくお願いいたします。
SQL Server エージェント上で右クリック⇒開始を 押下したところ、 「サーバXXXXXXでサービス SQLSERVERAGENT を開始できません」 追加情報 ⇒ アクセスが拒否されました(ObjectExplorer) と表示され、サービスが開始できませんでした。。 エージェント自体は、以下のコマンドで有効にしております。 exec sp_configure 'Agent XPs', '1'; --エージェントの設定を有効にする reconfigure -- 設定をインストール どなたか、ご回答頂けないでしょうか？ なにとぞ、よろしくお願い申し上げます。
環境は、 OS:win XP Webサーバ：tomcat5.5 統合開発環境：eclipse3.2 DB：SQL server 2005 です。 SQLserverのJDBCドライバ(sqljdbc.jsp)を、%CATALINA_HOME%common/libに配置し、DB接続用のサーブレットを作成、デバッグを行いましたが、 com.microsoft.sqlserver.jdbc.SQLServerException: TDS ログイン前応答が不完全です。対象サーバーは SQL Server 2000 以降である必要があります。 とのエラーが表示され接続できませんでした。 またデバッグを行ったところ、 Class.forName(driver); までは通りますが、次の行の con = DriverManager.getConnection(url,user,passwd); でエラーになるようです。次のステップは、データベース切断の public synchronized void close() throws Exception { 行に飛んでしまいます。 どなたかお気づきの方がおられればご回答願います。 ソースは以下の通りです。 //////////////////////////////////////////// package report.pack; import java.sql.*; public class DatabaseAccess { private String driver; private String url; private String user; private String passwd; private Connection con; private Statement stmt; private ResultSet rs; /** * コンストラクタ */ public DatabaseAccess() { driver = "com.microsoft.sqlserver.jdbc.SQLServerDriver"; url = "jdbc:sqlserver://localhost:8080;databaseName=testdb;"; user = ""; passwd = ""; } /** * データベースに接続 */ public synchronized void open() throws Exception { // ドライバクラスをロード Class.forName(driver); // データベースへ接続 con = DriverManager.getConnection(url,user,passwd); // ステートメントオブジェクトを生成 stmt = con.createStatement(); } /** * データベースから切断 */ public synchronized void close() throws Exception { if (stmt!=null) { stmt.close(); } if (con!=null) { con.close(); } } /** * クエリーを実行(検索) */ public ResultSet executeQuery(String sql) throws Exception { return stmt.executeQuery(sql); } /** * クエリーを実行(新規、更新、削除) */ public int executeUpdate(String sql) throws Exception { return stmt.executeUpdate(sql); } } //////////////////////////////////////
一つのテーブル(TABLE_A)に次のフィールドがあります。 SEQ_RID, TARGET_REGION, YEAR, SELL_PRICE 1 , 1 , 1997, 1100 2 , 1 , 1997, 1700 3 , 1 , 1997, 1300 4 , 2 , 1997, 1400 5 , 2 , 1997, 1500 6 , 2 , 1998, 1700 7 , 2 , 1998, 1800 8 , 2 , 1998, 1200 .... 各TRAGET_REGION別の最新年(YEAR)の最大売上(SELL_PRICE)を 求めたいと思います。 MAX関数を二つ使うのはだめみたいです。 宜しくお願いします。
今までVB5 OS:windowNT4.0 DB:SQLServer6.5 上で稼働していたシステムをサーバ入替があり OS:Windows2003 Server R2 DB:SQLServer2005 Standard Edition に入れ替えたところ データを読み込んで更新するような処理を１時間ぐらい実行していると Microsoft OLE DB Provider for ODBC Drivers でエラーが発生しました。 [Microsoft][ODBC SQL Server Driver][Named Pipes]ConnectionRead (WrapperRead()). というエラーが発生します。 この現象を回避するにはどうしたらよろしいでしょうか？
SQLServer 2005 を使用しています。 （SQL初心者です） 例えば　このような列があった場合 日付,00-00,00-01,00-02,00-03,01-01,01-02,01-03 ・ ・ 頭の2文字が「00」となるデータだけ抜き出す場合、 select 日付,[00-00],[00-01],[00-02] from テーブルA と書いているのですが、 一つ一つ列名を書くのではなく、「頭2文字が'00'」の列全てを抜き出す と言った命令文は書けないでしょうか？ 宜しくお願いします。
使用言語はjavaで処理しており、 SQL Server2005にて下記のようなテーブル(T_Kekka)があります。 　　　ID　　　a-1　　　a-2　　　b-1　　　b-2　　　c-1　　　c-2　　　 ￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣ 　　　１　　　bbb　　　aaa　　　ddd　　　　ccc　　　eee　　　fff　　　 　　　２　　　ggg　　　bbb　　　ccc　　　　 hhh　　　iii　　　　jjj　　　 　　　３　　　bbb　　　mmm　　　ddd　　　ccc　　　fff　　　　eee　　　 　　　４　　　bbb　　　aaa　　　ccc　　　　ddd　　　qqq　　　rrr　　　 　　　５　　　zzz　　　sss　　　ttt　　　　　ccc　　　vvv　　　xxx　　　 　　　６　　　zzz　　　aaa　　　ttt　　　　　ccc　　　vvv　　　fff　　　 　　　７　　　zzz　　　zzz　　　zzz　　　　　zzz　　　zzz　　　　zzz　　　 　　　８　　　qqq　　　rrr　　　ccc　　　　　ddd　　　fff　　　　eee　　　 検索する値は下記の通りです。 検索値 ｜a-1｜a-2｜b-1｜b-2｜c-1｜c-2｜ ￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣ ｜aaa｜bbb｜ccc｜ddd｜eee｜fff｜ 期待値としては、aはaのグループで検索、bはbのグループで検索、cはcのグループで検索をし、 一致個数の多い順に出力したいと考えております。（理想は下記のような感じです。） また、グループ内であれば逆転していてもＯＫです。 （例えばＩＤ：１のaグループのような感じです。） *1　一致数が同じ場合はcグループの数が多いデータが最優先となり、その他はＩＤ順になります。 期待値 　　　ID　　　a-1　　　a-2　　　b-1　　　b-2　　　c-1　　　c-2　　　一致数 ￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣￣ 　　　１　　　bbb　　　aaa　　　ddd　　　ccc　　　eee　　　fff　　　　　6 　　　３　　　bbb　　　mmm　　　ddd　　 ccc　　　fff　　　 eee　　　　5 　　　８　　　qqq　　　rrr　　　 ccc　　　ddd　　　fff　　　　eee　　　　4・・・*1 　　　４　　　bbb　　　aaa　　　ccc　　　ddd　　　qqq　　　rrr　　　　 4 　　　６　　　zzz　　　aaa　　　ttt　　　 ccc　　　vvv　　　 fff　　　　　3 　　　２　　　ggg　　　bbb　　　ccc　　　hhh　　　iii　　　　 jjj　　　　　 2 　　　５　　　zzz　　　sss　　　ttt　　　 ccc　　　vvv　　　 xxx　　　　　1 　　　７　　　zzz　　　zzz　　　zzz　　　 zzz　　　zzz　　　 zzz　　　　　0 知識不足のため私には複雑すぎて悩んでいる状況なので、 どなた様か知識がある方にご教授願いたく思います。 また、まだテスト段階なので現状のようなテーブル構造にしてしまいましたが、 他のテーブル構造の方がデータが抽出しやすかったり、レスポンスがいい場合がありましたら、 ご教授いただけると助かります。 説明が分かりづらく表が見づらくて申し訳ございませんが、 宜しくお願い致します。
SQL Server2005でトランザクションログの使用率が一定値を超えた場合に、 Windowsのアプリケーションログにログを出力することは出来ますか？ 「警告」機能を使って出来そうな感じがしていますが、 通知方法にアプリケーションログへの出力が見あたりませんでした。 ※メール通知はメール環境構築が難しい環境ですので、避けたいと思っています。
ASP.netにストアドプロシージャが登録できません。 SQLServer2000にストアドプロシージャを作成しASP.netにsqlcommandを作成。 sqlcommandのプロパティのcommandtypeをStoredProcedureとし、 commandtextにストアドプロシージャ名を入力すると このコマンドの新しいパラメータコレクションを作成しますか？と出てきて 「はい」とするとサーバー名選択画面となり、サーバー名を正しく入力し ログインID、パスワードも正しく入力、オプションも正しく入力したが OK押下後にプロパティの値が無効ですとなってしまい詳細を見ると ストアドプロシージャ＊＊＊がデータベースに見つかりませんでしたと なってしまいます。 既存のストアドプロシージャはリンク出来るのですが、新規のものが このようになります。原因・解決方法を教えて頂きたく宜しくお願いします。
SQL Server Enterprise Manager でテーブルの行を追加したのですがが、 リンクさせているAccessのテーブルに反映されません。 会社のDBで、テーブルをSQL Serverで作成し、 Accessへリンクさせています。 通常の入力業務はAccessで行っています。 このDBを作成した前任者が退職してしまい、 DBを管理できる人がいない状況です。 ネットで調べたところ、SQL Serverで、 「パブリケーションの新規作成」を行うか、 「DTSインポート/エクスポート」を行う必要がありそうなのですが、 これらの違いもわからず、 またAccesDBへの影響がわからず、うかつに試せない状況です。 SQL　Server、Access共に全く明るくないため、 つたない文章で申し訳ありませんが、 どなたか、テーブルの追加を反映させる方法を 教えて頂けませんでしょうか。
あるSrored Procedure実行時、文字列をfloat型やmoney型などへ変換するとき失敗します。 エラーメッセージはつぎのとおりです。 [Microsoft][ODBC SQL Server Driver][SQL Server]CHAR 値を MONEY に変換できません。CHAR 値に正しくない構文があります。 変換している値を確認すると、'0'や'500.00'といった問題ない値です。 変換をする直前で変換値を'0'にUPDATEしてもエラーになります。 クエリアナライザで実行するとエラーになりません。 ODBCやADOにて違う端末から実行するとエラーになります。SQLサーバー上でADOやODBC接続してもエラーになりません。 もう一台ある同じバージョンのSQLサーバーでも同様のエラーが出ます。 もはやお手上げです。SQL Serverのbugと判断して問題ないでしょうか？ バージョンは以下です Microsoft SQL Server 2000 - 8.00.2039 (Intel X86) May 3 2005 23:18:38 Copyright (c) 1988-2003 Microsoft Corporation Standard Edition on Windows NT 5.2 (Build 3790: Service Pack 1)
前回質問させていただきましたが、私の力不足により解決にいたりませんでしたのでもう一度質問させていただきます。 今現在accessでデータベースを構築しています。ウインドウズXPのPCを6台でローカルネットワーク経由で一つのaccessファイルを見に行っています。 データ量が多くなり、レスポンスが悪くなったことと、クライアントとして使用するにはaccessは向かないと知り、SQLサーバーを使用しaccessのデータテーブルをリンクさせフロントエンドとして構築しようと考えています。 ウインドウズXPにSQL express editionをインストールし、テーブルリンクまではできました。ファイヤーウォールの例外とTCP/IPのみを使用するという設定も調べてやりました。 SQLをインストールしたPCではaccessからリンクテーブルへ繋げれますが、他のマシンからリンクテーブルに繋げられません。拒否されましたとエラーが出ます。 nativeclientもインストールし、リモート接続も許可しているのですが、いまいち原因がわかりません。 データソース（ODBC）のシステムDSNに追加をするように聞いたのですが、それをしようにもやはり拒否されます。 もっと根本的な原因があるのでしょうか？ これも試したいと思っていますが、Configration Managerがないのでためせない状態です。 http://nas-tech.nasbi.co.jp/blog/2006/10/sql_ser … 宜しくお願いいたします。
SqlServer2000でクライアントはクエリアナライザを使っています。 例えばAccessのVBAでは adoRS!備考 = adoRS!備考.value & "追加する文字列" とすれば備考フィールドの最後に文字列を追加できますが、 これをsqlで行う場合にはどうればいいですか？ update tblアンケート set 備考 = 備考 & '追加する文字列' としても「データ型の演算子が無効です。データ型演算子は boolean AND、データ型は varchar です。」エラーになってしまいます。 エラーの意味もわからず検索もしたのですが解決できませんでした。 宜しくお願い致します。
はじめまして。思いっきりSQLSERVERは初心者なんですが宜しくお願いします。 現在SQLSERVER2005です。 ややこしくなるので要点だけ以下まとめています。 変数を利用してレコードを抽出する時なんですが… ALTER PROCEDURE Test @Rank INT BEGIN DECLARE @SELECT AS VARCHAR(100) DECLARE @WHERE AS VARCHAR(100) DECLARE @SQL AS VARCHAR(200) SET @SELECT = 'SELECT * FROM tblA ' SET @WHERE = 'WHERE Rank > ' + @Rank SET @SQL = @SELECT + @WHERE EXEC(@SQL) END 実行すると varchar の値 'WHERE Rank > 'をデータ型 int に変換できませんでした。 となります。 Rank部分が数値なんですが、どのように取扱いすべきなんでしょうか。
構成上の理由からドメインに参加できないサーバにSQLServer2005をインストールすることになりました。 この場合、サービスアカウントに「ドメインユーザ」は使えないので「ビルトインサービスアカウント」の 「ローカルシステム」を使おうと思うのですが、これを選択した場合はローカルユーザににSQLServer用の アカウントが追加され、そのユーザにてSQLServerの接続を行うということなのでしょうか？ また、その場合、そのユーザにはローカルのどのような権限を与えるのが一般的なのでしょうか？ 色々調べてみたのですが、いまいち理解できなく困っています。 ご存知の方がいらっしゃいましたら、教えてください。
現在ASP.NET2.0とSQLserver2005にてWEBページを作成・勉強しております。 そこで、ASP.NETのテキスト通りに作成したところ、App_Dataという フォルダに*.mdfと*.ldfというデータベースデータが作成されました。 このデータを深夜3時に自動でバックアップしたいのですが どのようにしたらよろしいでしょうか？ また、自動ではなく、手動でコピー＆ペーストしようとしても「他の人、 またはプログラムによって使用されています」とでてコピーできません。 ということはデータベースをいったん停止（デタッチ？）してから、 コピー＆ペーストして、コピーが終わったらデータベース再開する必要がある気がします。 どのように実装するのが良いのでしょうか。宜しくお願いいたします。
質問させていただきます。 SQLサーバーに既存のaccessテーブルをリンクし、accessをフロントエンドとして構築しようとしています。 リンクはできたのですが、テーブルローカルというテーブルが現れます。これは削除してもいいのでしょうか？これがあると容量が減らないので困っています。なにか使用することがあるのでしょうか？ 宜しくお願いいたします。
日々更新されるSQL2000(サーバー2000）上のテーブルA、テーブルB、テーブルCをSQL2005(サーバー2005）上で参照するために、レプリケーションの機能を使って、SQL2000をパブリッシュとしてSQL2005上をサブスクライバとしてプルサブスクリプション（スケジュール実行）でSQL2005上にテーブルA、テーブルB、テーブルCを生成させたいと考えております。 SQL2000側でパブリッシュの設定、2005側からプルサブスクリプションの設定ともに問題無く設定できたのですが、いざ実施すると 下記のエラーが出て実行できませんでした。 お聞きしたい点としてはそもそも上記の方法でのSQL2000から2005へ テーブルコピーが可能なのか？ 無理な場合は、他にどの様な方法でスケジュールで任意のテーブルを 2000から2005へコピーするあるか教えていただけますでしょうか？ ------------ ユーザー 'HOGEDOMAIN\サーバー2000$' はログインできませんでした。 (ソース: MSSQLServer, エラー番号: 18456) ヘルプの表示: http://help/18456
A1=0,　A2=0,　A3=0,　 A4=0 B1=0,　B2=0,　B3=125, B4=0 C1=77, C2=0, C3=457, C4=0 D1=0, D2=5, D3=0, D4=0 E1=2, E2=0, E3=0, E4=0 SQLの条件文で４番目が0であって１～３番目までは0以外だったらTrueとなる処理はどうしたらいいいでしょうか？ いろいろ考えたのですがわかりません。
Visual Basic 2005でデータベースを作りたいと願う初心者です。 図面の保管先を検索するために 保管先、客先、図面番号、装置名称テーブルを作成して、客先、図面番号、装置名称コンボボックスで選択したデータで、「検索」ボタンを押すと保管先が表示させたいのですが・・・ 本を読んでも参考になるものはありません。 コンボボックスのデータで絞り込みを行いたいと思っております。 ACCESS2000では完成しております。 よろしくお願いします。
お世話になります。 [日付],[クラス],[掃除箇所]というレイアウトのテーブルがあると致します。 どの[クラス]がどの[掃除箇所]をいつからいつまで担当したかを把握するSQLを起こしていますが、 上手くできません。 上手くできない理由に、[クラス]が受持つ同じ[掃除箇所]が定期的に回ってくる為、 select [クラス], [掃除箇所], min([日付]) as 開始, max([日付]) as 開始 from [掃除当番] group by [クラス], [掃除箇所] の場合、[掃除箇所]の初回と最近の日付しか取れません。 例 20080101～20080131,Aクラス,教室 20080201～20080229,Aクラス,廊下 20080301～20080331,Aクラス,教室 で担当していた場合、「Aクラス,教室」の開始日は"20080101"で終了日は"20080331"となってしまいます。 これを例にあります通り、期間毎に抽出するSQLをご教授いただきたいのですが。 説明が足りません場合、ご連絡頂けたらと思います。 よろしくお願いいたします。 環境：SQL Server2000，Excel VBA
いつも勉強させて頂いています。 SQLの副問合わせでわからないところが出て来ましたので、教えて頂けると助かります。 ＜環境＞ VB 2008 SQLSERVER 2005 ＜内容＞ 金額の集計をしたいのですが。 テーブルA　品番（主キー）　品名　予測金額 テーブルB　品番（キー）　　品名　確定金額 テーブルAの品番に対してテーブルBのレコードが１対多の関係です。 ＜結果＞ 品名に「あ」を含むもの、　テーブルAのCOUNT、　テーブルBのCOUNT、 予測金額合計、　確定金額合計 上記結果で出力したいのですが、困っています。 宜しくお願い致します。　　　　 　　　　
お世話になります。 初歩的な質問で恐縮ですがご教示いただければ幸いです。 T-SQLでグローバル一時テーブルの名前を毎回変更できるストアドを作り、Access2003アプリから実行させる予定です。 ストアドに、CREATE TABLE [dbo].[@tablename]のように書き、 ストアド実行時に@tablenameの値を　##ABC　のように入力したのですが、テーブルはtempdbではなく、しかもテーブル名は@tablenameでテーブルが作成されてしまいます。 CREATE TABLE [dbo].@tablename　のように[]をとると ストアド自体を作成できずエラーになってしまいます。 宜しくお願いします。 create PROCEDURE [dbo].[ストアドプロシージャー名] (@tablename nvarchar(255)) AS BEGIN fromSET NOCOUNT ON; CREATE TABLE [dbo].[@tablename] ＜以下省略＞
いつもお世話になっています。 SQL-Server 2005にて、あるSQL文を実行した際に、「どのテーブルに対してどのようなアクセスがあったのか」を調べる方法はありますでしょうか？ いくつかのSQL文を実行した際の影響範囲を調べるために必要としています。 以上、ご協力宜しくお願い致します。
Windows Server 2003、SQL Server 2000の環境でデータベースの定期的なバックアップを考えています。 バックアップ先はテープドライブとディスクは選択できるようなんですが、ネットワーク上の他の共有フォルダにバックアップを取ることは可能でしょうか？ やり方が見つかりませんでしたので質問させていただきます。 よろしくお願いします。
VBAで開発しています。 Where句で、日付/時刻型のA_dateに対して WHERE A_date > 2008/05/01 といったような条件を付けたいのですが、 どうしてもうまくいきません。 WHERE A_date > Format(2008/05/01, "YYYY/MM/DD") のようにフォーマットしてみてもだめでした。 WHERE A_date > date() のような記述はちゃんと通るんですが、固有の日付とのSQLがうまくいきません。 日付/時刻型の条件付けは何か特別な記述が必要なのでしょうか？ どなたかご回答よろしくお願い致します。
・WindowsXP Pro SP3 ・VB2008 ・SQLServer2000 SP4 上記環境にて開発を行っております。 質問は、データベース内のマスタを、非接続型のグリッド上に読込、 内容を編集後、更新を行う処理を作成しています。 グリッド上に読み込んだ際(Select文)、テーブルをロックし、 他のユーザが変更出来ないようにしたいのですが、方法が分かりま せん。 教えて頂けないでしょうか？
私は、データベースなどの知識は全くありません。 下記のエラーの原因は、WEBサイト側にあるのでしょうか？ それとも閲覧に使用するパソコン・ブラウザに原因があるのでしょうか？ IEやSleipnirだとこのエラーが表示されますが、Apple Safariだとエラーは起きませんでした。 Microsoft OLE DB Provider for SQL Server エラー '80040e57' STRING または BINARY データは切り詰められました。 E:\WEB\MODULE\FRAME\../../common/lib/parts/database.asp, 行 105
質問させていただきます。 ACCESSのテーブルをSQLに移行させようと思っています。 serverPCもクライアントPCもWindowsXPです。 無事インストールができたのですが、アクセスをアップサイジングウィザードでテーブルをサーバーにリンクさせようと起動しても、最後に拒否されましたとなってしまいます。 ファイヤーウォールの開放もTCPの設定もしました。原因は何がありますでしょうか？
こんにちは SQL Server 2005 Express Editionについて質問なのですが 無償版との事ですが SQL Server 2005 Enterprise Edition と比べるとどんな制限があるのでしょうか？ ご存知の方、ご回答いただけましたら、幸いです。
連番の歯抜け値を取得するSQLを作りたいと思っています。 例えば、カラムAに、1,2,3,5,6,7,9,10（4と8が抜けている） と数値の入っているテーブルAがあるとします。 これに対して、 SELECT MIN(カラムA + 1) FROM テーブルA WHERE (カラムA + 1) NOT IN (SELECT カラムA FROM テーブルA) とSQLを投げた場合、4が取得できます。 これにbetween句を付与したいのですが、そうすると境界値が なぜか取れなくて困ってます。 具体的には、 SELECT MIN(カラムA + 1) FROM テーブルA WHERE (カラムA + 1) NOT IN (SELECT カラムA FROM テーブルA) AND BETWEEN 8 AND 10 とした場合、NULLが返ってきてしまいます。 普通、BETWEENは境界値も対象になるはずですが、何故このような 結果になってしまうのでしょうか？ 修正点をご教授いただけないでしょうか？ 宜しくお願いします。
以下定義のレコードを基準日毎に処理をして行きます。 処理の途中で変更フラグに"9"が出現した時、項目1が同一である 基準日～銘柄コード項目に付いて、直前レコードの値を取得したいのですが。 以下の場合ですと、アスタリスクの項目1の値を持つ最新のレコードは アットマークのレコードになります。 従いまして"080613|1|001|CD0002"を取り出したいのですが。 ちなみに基準日～銘柄コードはキー項目の為、一意になっています。 いろいろ試しましたが、上手く取り出せません。 ご教授下さいます様、よろしくお願いいたします。 環境：SQL Server2005 基準日|変更フラグ|連番|銘柄コード|項目1 080612|1|001|CD0002|01010101 @ 080613|1|001|CD0002|01010101 080614|1|001|CD0001|11001100 080614|1|002|CD0002|11111111 080615|1|001|CD0001|10101010 * 080615|9|002|CD0002|01010101 080615|1|003|CD0002|01010100
お世話になります。 ACCESS2003のクエリからSQL2005のストアドへ移行作業をしております。 アクセスで同じクエリ内で作成した項目のエイリアスを、別の列を作成する要素として利用できたのですが、ストアドではできないのでしょうか？ 記述の方法が違うのか、全くできないのか、他に何かよい方法があればご教示ください。 例>　MyCOLaをMyCOLbで利用したいのです。 INSERT INTO TABLE1(COLa,COLb) select 'convert(money,650) as MyCOLa,convert(money,[MyCOLa]*1.05) as MyCOLb
質問させていただきます。 今現在accessでデータベースを構築し、２０万から３０万件のデータを６名程度で入力しています。当たり前ですがレスポンスは落ちています。 ファイルが破壊してしまうのと、入力した後オペレータが検索して使用するので、レスポンスが遅いと業務に支障が出てしまいます。 accessは複数での使用に適していないことや、データ量のこともあり他のデータベースに移ろうと考えています。 SQLのexpressや、PHP+MYSQLなどを考えているのですが、私のスキル的にできるかぎり簡単にできる方法を探しています。 accessの危険をとりあえず回避したのち、きちんとしたデータベースの勉強をして強化できればと思っています。 MSDEを使用し、データテーブルのみをサーバーに移し、accessをフロントエンドで使用する方法を聞いたのですが、この方法だとクエリをクライアント側で実行するのでレスポンス的にはあまり変わらないような気がします。 何かいい方法があればご教授お願いいたします。
SQL Server 2000でのbulk insert とはどういうものなのでしょうか？ csvなどをテーブルに一括で更新できてしまうものでイメージはよいのでしょうか？csvにヘッダーがある場合除くなどもできたりするのでしょうか？ できれば、具体的なコマンドの書き方もご教示ください。 よろしくお願いします。
SqlServer2005でレプリケーションで困ってしまいました・・ データベースで ALTER DATABASE サーバ名 SET READ_COMMITTED_SNAPSHOT ON を実行しようとすると、エラーメッセージで、 「レプリケーション中は出来ません」の様なメッセージが 出てしまい上手くいきません。 どなたか、止める方法をご存知なら教えて頂けませんでしょうか？ すいません。よろしくお願いします。
以下のデータ、条件でクエリを発行しました。 ■環境 SQLServer2005(データベースはSQLServer2000) ■テーブルA 社員番号　社員名　商品　金額 ---------------------------- 00001 社員A 商品A 100 00002 社員B 商品A 100 00002 社員B 商品B 100 00003 社員C 商品B 100 ■クエリ SELECT COUNT(*) FROM テーブルA WHERE 社員番号 = (1) GROUP BY 社員番号 ここで質問です。 (1)に'0002'と入れたときは「2」と返ってきますが、 (1)に'0004'と入れた場合、結果何も返ってこない(ゼロすら返ってこない)のですが これは仕様なのでしょうか？バグなのでしょうか？ そもそもGROUP BYが必要ないということは承知しております。 どなたかお分かりになる方、いらっしゃいますでしょうか。 よろしくお願い致します。
今まで使用していたAccessのデータをWindowsServer2003とSQLServer2000のサーバマシンにデータ（テーブル）のインポートをすることができました。 同じネットワーク上のWindowsXPProのPCからAccess2000で作ったMDBでこのサーバマシンのテーブルにリンクしODBC接続で接続して書き込み、削除などもできています。 ここまではいいのですが、4人程度が同時に接続して運用する場合、何かサーバ側の設定しておくべき点があったら教えていただけるとありがたいです。 現状SQLサーバで特別な設定をしているわけではないのでただ動いているだけです。 （セキュリティーやバックアップなど何もわかりません。） 以上、よろしくお願いします。
SQL初心者の質問です。下記のように違うdateを持つ同じgrade_idがいくつか存在するテーブルから、最新のdateのgrade_idを選択してその列の他の情報(point)も持って来たい場合、どんなSQL文が最適でしょうか？Disthinctを使ってもうまくできずに困っています…よろしくお願い致します。 id ・ date ・ grade_id ・ point 1 ・ 2008/05/01 ・ 1 ・ 6 2 ・ 2008/10/01 ・ 1 ・ 1 3 ・ 2000/08/08 ・ 2 ・ 2 4 ・2008/05/01 ・ 2 ・ 8
SQL初心者の質問です。下記のように違うdateを持つ同じgrade_idがいくつか存在するテーブルから、最新のdateのgrade_idを選択してその列の他の情報(point)も持って来たい場合、どんなSQL文が最適でしょうか？Disthinctを使ってもうまくできずに困っています…よろしくお願い致します。 id date grade_id point 1 2008/05/01 1 6 2 2008/10/01 1 1 3 2000/08/08 2 2 4 2008/05/01 2 8
「SQL Server 2005 Express」を使用しています。 次のようなスキーマをサーバーに登録して CREATE XML SCHEMA COLLECTION dbo.schema_test AS N'<?xml version="1.0" encoding="UTF-16"?> <xsd:schema targetNamespace="http://schemas.microsoft.com/sqlserver/2004/07/a … xmlns:xsd="http://www.w3.org/2001/XMLSchema" > <xsd:element name="root"> 　<xsd:complexType mixed="true"> 　　<xsd:choice> 　　　<xsd:element name="A" type="xsd:string" /> 　　　<xsd:element name="B" type="xsd:string" /> 　　　<xsd:element name="C" type="xsd:string" /> 　　</xsd:choice> 　</xsd:complexType> </xsd:element> </xsd:schema>' ; つぎのようなクエリを試したのですが、 「メッセージ 6913、レベル 16、状態 1、行 5 XML 検証: 要素 'root' の宣言が見つかりませんでした。場所: /*:root[1]」 というエラーメッセージが表示されてしまいます。 DECLARE @xml xml (dbo.schema_text) SET @xml = '<root> <A>AAA</A> <B>BBB</B> <C>ooo</C> </root> ' どなたか分かる方がいらっしゃいましたら、 アドバイスをお願いいたします。
DT-PC(WindowsXP-sp2)にVisual C# 2005 Standard EditionとSQLServer2005 とSQLServer Management Studio Expressをインストールして,C#のプログラムでデバッグを実行して、SQLServerに接続しようとしたら「規定の設定がリモート接続を許可しないようになっていることがエラーの原因である可能性があります。」と通知ポップアップウィンドウに表示されるので、http://www.microsoft.com/japan/sql/ssj/tips/01.m …を参考にして、 「ローカル接続およびリモート接続」と「TCP/IPのみを使用する」を選択し、 一度、サービスを停止した後、「開始」ボタンを押下して、Windowsファイアウォールを無効にして、下記の様にIPアドレスを直接してし、 private void button2_Click(object sender, EventArgs e) { System.Data.SqlClient.SqlConnection cn = new System.Data.SqlClient.SqlConnection(); //接続文字列を作成する cn.ConnectionString = "Data Source=192.168.30.80:139" + ";Integrated Security=True;database=Database1"; try { cn.Open(); MessageBox.Show("接続に成功しました。", "通知"); cn.Close(); } catch (Exception ex) { MessageBox.Show(ex.Message, "通知"); } } 接続文字列を色々と書き換えてやってみましたが、どうしても先のリモート接続を許可しない・・・が表示され、SQLServer2500に接続できません。 DOSコマンドでnetstat -anを実行すると Microsoft Windows XP [Version 5.1.2600] (C) Copyright 1985-2001 Microsoft Corp. C:\Documents and Settings\yamada>netstat -an Active Connections Proto Local Address Foreign Address State TCP 0.0.0.0:135 0.0.0.0:0 LISTENING TCP 0.0.0.0:445 0.0.0.0:0 LISTENING TCP 0.0.0.0:1059 0.0.0.0:0 LISTENING TCP 0.0.0.0:3389 0.0.0.0:0 LISTENING TCP 127.0.0.1:1028 0.0.0.0:0 LISTENING TCP 192.168.30.80:139 0.0.0.0:0 LISTENING UDP 0.0.0.0:445 *:* UDP 0.0.0.0:500 *:* UDP 0.0.0.0:1035 *:* UDP 0.0.0.0:1434 *:* UDP 0.0.0.0:4500 *:* UDP 127.0.0.1:123 *:* UDP 127.0.0.1:1900 *:* UDP 192.168.30.80:123 *:* UDP 192.168.30.80:137 *:* UDP 192.168.30.80:138 *:* UDP 192.168.30.80:1900 *:* C:\Documents and Settings\yamada> のように表示されます。 先のソースは、株式会社 秀和システムの「Visuai C# 2005 逆引き大全 500 の極意」のP301のリスト２を書き換えたものです。 Cドライブのフォルダ「C#2005」に置いたACCESSへの接続は成功しますが、 ( C:\C#2005\SampleDB.mdb) Cドライブ直下に置いたSQLSqerverデータベース C:\Database1.mdf への接続は失敗してしまいます。 Windowsファイアウォールは無効に設定せず、「例外」を設定する必要があるのでしょうか。　また、現在、使用している某社のウィルスセキュリティソフトも無効に設定しなければならないのでしょうか。また、管理者権限でないと接続できないのでしょうか。 以上
ＳＱＬＳｅｒｖｅｒの１８０日体験版をＶＩＳTAに インストールすると 下記のＩＩＳのエラーが出ます、警告なので無視カナー と考えてますが、対処する方法はあるのでしょうか？ ちなみに、そのＶＩＳＴＡのマシンにはＩＩＳは インストールされていて、ブラウザアクセスで ちゃんとページは表示されます。 ・・・・インストール時のエラー・・・・・ - IIS 機能要件 (警告) メッセージ IIS 機能要件 Microsoft インターネット インフォメーション サービス (IIS) がインストールされていないか、または無効になっています。IIS は SQL Server の一部の機能で必要です。IIS がインストールされていない場合、SQL Server の一部の機能をインストールできません。SQL Server のすべての機能をインストールするには、コントロール パネルの [プログラムの追加と削除] から IIS をインストールして、SQL Server セットアップを再実行してください。IIS に依存する機能の一覧については、Books Online の「SQL Server のエディションによってサポートされる機能 (Features Supported by Editions of SQL Server)」を参照してください。
これからSQL Server 2005（Workgroup Edition）を使ったシステムを 作る予定なのですが、Visual Studio 2005(Professional Edition)を使って 開発を行うつもりです。 しかし、SQL Server 2005（Workgroup Edition）のライセンスは持っていないため Visual Studio 2005(Professional Edition)に付属するSQL Server 2005（Developer Edition）を利用して開発を行うことは可能でしょうか？ 回答宜しくお願いいたします。
現在のシステム(SQLServer2000)でexeからRestoreDatabaseを行っているのですが、同じくexeでBackupDatabaseを行って作成したバックアップファイルをSQLserver2005で復旧すると(RestoreDatabaseおよびSQL Server Management Studio Expressを使用した手動復元)両方ともエラーが出てしまい復旧できません。 原因としては2000と2005のLDFファイルおよびMDFファイルの場所が違うせいかと思われ、手動で復元する際に詳細設定でLDFファイルおよびMDFファイルの場所を指定し直してやれば問題なく復旧ができるのですが、システムを使用する人がパソコンに詳しい人でないため、SSMSEなどを使った手動操作を案内することが不可能と思われるため、batもしくはexeを配布して対応ができればというところです。 RestoreDatabaseなどを行う際に、対象とするMDFファイルおよびLDFファイルを指定することは可能でしょうか？
SQL ServerでのDB構築について質問させてください。 自分のPCのローカルにSQL ServerのDBを構築したいのですが あれこれと試行錯誤してもうまくいかないので方法を教えていただけませんか。 ちなみに 　・SQL Server 2005 　・Microsoft SQL Server Management Studio はインストールされています。 よろしくお願いいたします。
はじめまして。midwagonです。 SQLがわからないので教えてください。 A表：id,name B表：id,hiduke これを結合してA表にあるものをすべて表示したいのですが B表のhiduke="20080531"　と 日付の制限をかけると何もかえってきません。 どうすればいいのか教えてください。 select A.id,A,name from A left outer join B on A.id=B.id where B.hiduke="20080531";
お世話になっております。 皆様の知恵をお貸しください。 SQLクエリアナライザとPHPで作成 [Aside] No 1 1 3 2 1 [Bside] No BName 1 test1 2 test2 3 test3 4 test4 AsideのNoとBsideのNoが同じもので、 AsideはBsideのものが何回使われたかの記録です。 Bsideのデータ+何回使われたかの合計を出したいのです。 No BName Count 1 test1 3 2 test2 1 3 test3 1 4 test4 0 こういう表示をしたいのですが、 今書いているSQLがこういう風↓です SELECT B.No ,B.BName ,COUNT(*) AS Count FROM Aside AS A left JOIN Bside AS B ON A.No = B.No WHERE A.No = B.No GROUP BY B.No ,B.BName これだと No BName Count 1 test1 3 2 test2 1 3 test3 1 使われている1・2・3だけ出て、4は出ません。 一つのSQLで、使われていない4も一緒に出す書き方を教えてください。
ログイン名とDBを所有しているユーザー名が同じなのですが、 ログイン名とユーザー名が競合することってあるでしょうか？ 競合している気がするので ユーザーの所有しているデータベースを別のユーザーに所有 させる方法を教えてください。
また質問させていただきます。 今ACCESS+SQLserverで構築をしようとしています。 ACCESSのテーブルデータだけをサーバーに持っていき、リンクして使用しようと考えております。 まずはお試し版のmanagement studioを使用し、WindowsのPCにインストールしました。そしてテーブルをリンクするところまではできたのですが、インストールしたPCではACCESSから入力ができたのですが、ローカルから繋いでいるクライアントのPCでは接続ができないのです。 権限の中にインストールしたPCの名前しかなく、クライアントのPC名がないことが原因かと思ったのですが、どうでしょうか？ ローカルのPCを権限に入れれば接続ができるなら、その方法もご教授いただければと思います。 情報が不足していましたら補足いたします。 宜しくお願い致します。
教えてください。 Aはトランザクションテーブルです。 A 列１列２ 11 2NULL 32 Bは種別テーブルです。 B 列１列２列３ aaa1あああ１ aaa2あああ２ aaa3あああ３ select A.列１ B.列３ from INNER JOIN B ON ( (A.列２ = B.列２ or A.列２ is null) and B.列１ = 'aaa') 上記のSQLを実行すると、 A.列１が2のような、列２がNULLだと、 1あああ１ 2あああ１ 2あああ２ 2あああ３ 3あああ２ となってしまいます。 望む形としては、 1あああ１ 2null 3あああ２ としたいのですが。。。 何が悪いか、教えていただけませんでしょうか。 お願いします。
すみません。 初歩的な事かも知れませんが教えて下さい。 アプリケーションにて、ＳＱＬ文が色々実行されています。 ＳＱＬＳｅｒｖｅｒからどのようなＳＱＬが実行されたかを 見る為にはどのようにすればよろしいのでしょうか？ よろしくお願いします。
データーベースに関して、知識があまりないもので、的外れなことや 情報不足があったらすみません。 SQLServer2005で同一のUPDATE文を2人で実行しようとしたところ、変換デッドロックが発生してしまいました。 該当するSQL文は １ SELECT ～ FROM xxxx FOR UPDATE OF ～ ２ UPDATE xxxx　 という２つのSQL文です。このSQLはアプリケーションが自動で発行生成しているSQLなので自分では変更は出来ないです。 エラーを確認するため、Profilerで確認したところ、以下のようになっていました。 <inputbuf> FETCH API_CURSOR000000000000FA5C </inputbuf> </process> </process-list> <resource-list> <ridlock fileid="1" pageid="435113" dbid="11" objectname="xxx.dbo.xxxx(テーブル名)" id="lock4eccf240" mode="U" associatedObjectId="54650898874368"> <owner-list> <owner id="processb491f8" mode="S"/> <owner id="processdf4898" mode="U"/> <owner id="processdf4898" mode="U"/> </owner-list> <waiter-list> <waiter id="processdf4898" mode="X" requestType="convert"/> <waiter id="processb491f8" mode="U" requestType="wait"/> </waiter-list> </ridlock> </resource-list> </deadlock> </deadlock-list> 共有ロック → 更新ロック → 排他ロックという順番でロックをかけようとしたところ、更新ロックから排他ロックに変換しようとしたところで エラーになっているみたいです。 これらを解消するのに何か良い方法はありますでしょうか？
AccessからPostgreSQLへデータを移行できるのでしょうか？ よろしくお願いします。
使用しているのはSQL Server2000で、 以下のような各PCにインストールされているソフトウェア一覧の テーブルから コンピュータ名 | ソフトウェア名 ---------------------------------- コンピュータ1 | ソフト1 コンピュータ1 | ソフト2 コンピュータ1 | ソフト3 コンピュータ2 | ソフト2 コンピュータ2 | ソフト4 　　・　　　　　・ 　　・　　　　　・ 以下ののようなどのPCにある特定のソフトウェアがインストールされているかを 確認するための表を作成したいのですが、 なにかよい方法はないでしょうか？ できればSQLで作成したいとは思っています。 ご教授よろしくお願いいたします。 コンピュータ名 | ソフト1 | ソフト2 | ソフト4 ---------------------------------------------- コンピュータ1　| 　1　|　1　　| コンピュータ2　|　　　 |　1　　|　　1 　　・　　　　　・　　　・　　　・ 　　・　　　　　・　　　・　　　・
22歳男性ダッチャ。 SQL serverをダウンロードして勉強しようと考えています。 しかし、どれをダウンロードしたらいいのかわからず悩んでいます。 初心者が勉強するにはどのSQL serverがよいのでしょうか？
質問させていただきます。 今現在、４０万程度のデータをACCESS上で動かしています。 mdeファイルを作成し、各クライアント７台程度に配布し、テーブルをリンクして使用しています。 データ量、クライアント量が拡大するにつれ、当たり前ですがレスポンスが遅くなってきています。また、はじめからクライアントに配布する方法はACCESSには向かないとも聞きました。 そこで無料のMSDEを知りました。 今現在のデータ量ではどのデータベースがいいでしょうか。 SQLserverやらMSDEやらいろいろとありますが、なにしろ独学ですので、一番現実味があるもので、実用が可能なものを選び構築したいと考えております。 ACCESSの基本的な構築程度は独学でやりました。 今の段階でデータベースでやることといえば、 まず紙媒体の電話番号を入力し、その中の重複を省きます。「重複なし」のテーブルに電話番号をひたすら打ちます。 重複のなくなった紙媒体のデータを各クライアントmax７台程度（増える可能性あり）でデータを入力をします。 そのデータを住所順で並び替え、使用しないデータを手動で削除。 もう１つ同じ構造のACCESSファイルにコピーし、次はそこでレポート印刷をします。そのファイルはそのまま電話オペレーターが検索でデータを引き出し電話での顧客対応に使用しています。 ACCESSでは限界と言われています。レスポンスも落ちてきています。 何かどんなことでも構いませんので、アイデアがあればご教授お願いいたします。 つたない文章で申し訳ありません、不足分は指摘いただければ追記いたします。
SQLサーバのデータベースミラーリング自動フェイルオーバ機能は、物理的に別のサーバにミラーしていき、プリンシパルに障害が発生した時、ミラーのフェイルオーバは、IPアドレスも引き継ぐのでしょうか。 この機能の切替事項がよくわかりません。ご存知の方教えて頂けませんか。
SQLSERVERを使い始めた初心者で、調べてはいるのですが うまくいかないので質問させて頂きます。 SQLSERVER2000で既存のテーブルについて、 SQLのCREATE TABLE文をtextで出力したいのですが、 EnterPrise Managerを使用してどのように出力するれば よいかわかりません。 アドバイス頂けますと助かります。 よろしくお願いします。
サブクエリーで複数キーを指定したいです。例えば以下のようなSQLですが、 SQL> > select * from テーブルA > where (key1,key2) in (select key1,key2 from テーブルB) このSQLはオラクルでは実行できますが、SQLSERVERでは文法エラーになってしまいます。SQL SERVER ではサブクエリーで複数キーを指定するのは不可能なのでしょうか？
SQLServerのDBをDAOを使って更新しようとしていますが、方法がわからず困っています。 ------------------- private Cn as DAO.Database private function fnc1() as integer Dim ws As DAO.Workspace Dim rcdst1 As DAO.Recordset dim strCnct As String dim strSQL As String strCnct = "ODBC;Driver={SQL Server};SERVER=" & g_strSVName & ";DATABASE=" & g_strDBName & ";UID=" & strpUserID & ";PWD=" & strpPassword & ";" 'ＤＢ接続 Set Cn = ws.OpenDatabase("", False, False, strCnct) strSQL = "SELECT * FROM Table1" Set rcdst1 = Cn.OpenRecordset(strSQL, dbOpenDynaset, dbDenyWrite, dbOptimistic) ------------------------------------- このOpenRecordsetで ODBC--すべてのレコードをロックできません。(3254) のエラーが出ます。 また、OpenRecordsetを Set rcdst1 = Cn.OpenRecordset(strSQL, dbOpenDynaset) とすると rcdst1.Edit で データベースまたはオブジェクトは読み取り専用なので、更新できません。 のエラーが出ます。 どうしたらいいでしょうか。
ご存知の方、いらしたら教えていただければと思います。 現在は、S/C型の利用においてDBにAccess2000を使っていますが、様々なところで述べられている危険性に配慮して、SQLserverへの移行をしようとしています。 ちなみにSへはテーブルを配置し、CではExcelからADO/Jet OLE DBを経由して接続しています。 ユーザーにはフロントであるExcelを配布して利用しています。 さて本件ですが、SQLServerに移行しようと考えて、サーバにはExpress editionと接続コンポーネントを、クライアントには接続コンポーネントをインストールしたのですが、勝手が違うのでよくわからないです。 いろいろ試した挙句、ODBCからNative Clientとして接続すると可能であるところまでもってきましたが、もう一歩先に進めないで困っています。 つまり、目指すところは、ADO/OLE DB for SQL server　を経由した接続です・・・ODBC経由だと、全てのクライアントに接続コンポーネントをインストールして回らなくてはならないので、大変です。 なにか考え方に誤りがあるのでしょうか、あるいはどこか注意すべきところがあるのでしょうか？よろしくお願いします。 ---以下、操作例--- メモ帳の拡張子をudlに変更してデータリンクファイルを作成。 これを開き、プロバイダータブにおいて　MS OLE DB Provider for ODBC Driver を選択し、接続タブではサーバー名などを入力して接続テストすると可能である。 他方、プロバイダーにMS OLE DB Provider for SQL server　を選択すると接続タブ完結できず、つまり接続できない。
SQLSERVER　言語 VB　VS2008 いつも勉強させていただいています。 SQL文で　「0 除算エラーが発生しました。」　が出て、困っています。 アドバイスお願いいたします。 SQL文 COUNT(CASE WHEN CONVERT(CHAR(10), 納期, 111) = GETDATE() _ AND 入荷数 = 0 THEN 0 ELSE NULL END) _ / _ COUNT(CASE WHEN CONVERT(char(10), 納期, 111) = GETDATE() _ THEN 0 ELSE NULL END) * 100 AS '遅延率(%)' ・・・GROUP化 わかりずらいのですが、期間内の入荷数／全体数で割っています。 COUNTでも駄目でした。 個々のデータは取得できます。下記 COUNT(CASE WHEN CONVERT(CHAR(10), 納期, 111) = GETDATE() _ AND 入荷数 = 0 THEN 0 ELSE NULL END) AS 未入荷計 何か良い方法が御座いましたらご指導くださいませ。 よろしくお願いします。
トランザクションの考え方を教えて下さい。 「データの参照や追加・更新・削除といった処理に矛盾がないことを保証する」という記述を見たのですが、下記の場合も良いのでしょうか。 トランザクションの開始 SELECT　* FROM　Aテーブル WHERE 項目A = '1' －－処理－－ UPDATE Aテーブル SET 項目B = '2' WHERE 項目A = '1' トランザクションの終了 開始から終了までの間に他のPCによって SELECT対象のデータが増える可能性があります。 この場合UPDATEするときはやはりSELECTの結果でLOOPするべきなのでしょうか。 上記のようにするとSELECT件数とUPDATE件数は異なってしまうのでしょうか。 環境はVB2005+SQL Server です。
お世話になります。 Microsoft SQL server で、日付の期間内のデータを取得するにはどのような形にすれば良いのでしょうか？ たとえば SELECT a FROM data WHERE ... and ... よろしくお願いいたします。
今回、今まで使っていたPCから別のPCに移し替えているのですが、 旧PCにあったASPNETアカウントが新PCには存在しません。なので SQLサーバのインストール時にけられている状態です。 旧PCはもともと.net framework 1が入っていて今は2にバージョン アップしています。 新PCは最初から2で今も2です。 ASPNETが作成されているPCとそうでないPCの違いは何でしょうか? また、解決はどうすればよいでしょうか? 次のページ当たりに手動で作成するような方法が書いているのですが よくわかりませんでした。 http://www.microsoft.com/japan/msdn/security/gui … http://www.microsoft.com/japan/msdn/enterprise/p …
こんにちは。 SQL SERVER 2005 ExpressとIIS5.0とASP.NET2.0+C#で使っています。 一台のサーバーマシンに、SQL SERVER 2005 ExpressとIIS5.0をインストールした状態なのですが、Webページ上のC#のプログラムよりデータベースを作成しようとすると、 CREATE DATABASE 権限がデータベース 'master' で拒否されました。 と、メッセージが出ます。 要するに権限がないというのはわかるのですが、このようにWebからログインしてきたユーザーに権限を付加することはできるのでしょうか？ あるいは、接続文字列かなんかで権限のあるユーザーでログインする、といったことが可能なものでしょうか？ 現在は以下のようにして接続、作成を行おうとしています。 SqlConnection conn = new SqlConnection(); conn.ConnectionString = "Server=.\\SQLEXPRESS;Integrated security=SSPI"; String strDatabase = "CREATE DATABASE newdatabase"; SqlCommand cmdDatabase = new SqlCommand(strDatabase, conn); conn.Open(); cmdDatabase.ExecuteNonQuery(); conn.Close(); エラーの内容から、SQL SERVERそのものへのアクセスは成功しているように思えます。 よろしくお願いします。
現在、SQLを勉強する為にデータベース管理ソフトを探しており、その条件は、無料である事とCSEというソフトが使用できるという事です。 お教え願います。 余談ですが、 私が探した結果では、 SQL Server 2005 Express Edition　が一番いいと思って導入しようとしましたが、CSEを使用しての接続を行う所で止まってしまいました。
MySQL Sever5.0の質問です。ファイルの一括インポートを行いたいのですがどうすればいいのでしょうか？ フォルダ内にある1001,dat～9997.datの株価データをMySQL Sever5.0に入れたいです。宜しくお願い致します。
お世話になります。 SQL2005を使ってます。 今、SSISで作ったプログラムがあります。 このSSISを実行する方法がわからずに困っています。 SSISについて基礎から画面つきで記したようなわかりやすいページはありませんでしょうか（できればMSDN以外）？ 希望としてはリモートPCのフォームアプリ（C#）より実行できればと思ってます。 よろしくお願いします。
お世話になっております。 SQLServer2005(Express)で項目の幾つかを暗合化して保存しています。 この暗合化項目をキーに検索することはできるのでしょうか？ 色々と探したのですが見つかりませんでした。 参考になるサイトなどありましたら、そこのURLを教えていただければと 思います。 よろしくお願いいたします。 ※尚、同様の質問を他サイトでしていますが、そこは締めてありますのでご了承ください。
お世話になります。 SQLServer2005expressをインストールしていると以下のようなメッセージが出て 「SQLServerセットアップで予期しないエラーが発生しました。-中略-詳細はLogのSummary.txtを確認してください。」 でSummary.txtは ----ここから Microsoft SQL Server 2005 9.00.3042.00 ============================== OS Version : Microsoft Windows XP Home Edition Service Pack 2 (Build 2600) Time : Sun Apr 20 17:36:02 2008 ----ここまで となっております。 なぜインストールができないのかお分かりなる方いらっしゃいますでしょうか。また同じような経験をしたかたはいらっしゃいますか。 ご教授いただけますでしょうか。 ちなみにVB2008express、.netframework2.0はインストールされております。
SQLSERVER初心者でSQLをどうすればよいか 悩んでいます。アドバイスを頂ければと思います。 環境SQLSERVER2005 EXPRESS EDITION 下記のようなレコードでIDに対してどこかの １項目にだけ文字列がはいっている形となっております。 (他の項目はNULLとなります。) これをIDでグループ化して1レコードにしたいのですが、 どのようなSQLで可能かアドバイス頂ければと思います。 ID 　　COL1 　　COL2 　　COL3　　 1 　　ABC 　　　<NULL> 　　<NULL> 1 　　<NULL> 　　DEF 　　　<NULL> 1 　　<NULL> 　<NULL> 　　GHI 上記を下記のようにしたいのですが、 ID 　　COL1 　　COL2 　　COL3 1 　　ABC 　　　DEF 　　　　GHI 以上アドバイスを頂けますと大変助かります。 よろしくお願いします。
SqlServer2005環境です。 SqlServerManagementStudioExpressを用いて、ストアドプロシージャを 作っています。 ある程度できたので、動かしたいのですが、SqlServerManagementStudioExpressでは ステップ実行ができず、デバッグに困っています。 有料のツールなどは用意できないので、無料で使えるデバッグツールが ありましたら、教えていただけないでしょうか？ ステップ実行が出来ないのは不便で…。 コード的にデバッグする方法がありましたら、併せて教えて いただけるとありがたいです。 宜しくお願いします。
SQL Server2005環境です。 ストアドプロシージャを作成しています。 テーブルAを読み込んで、その値を元に、テーブルBに値を INSERTしていくという処理をしたいと考えています。 1.テーブルA.区分1<>0の時、テーブルB.区分は1 2.テーブルA.区分2<>0の時、テーブルB.区分は2 3.テーブルA.区分1<>0 かつ テーブルA.区分2<>0であれば、 　テーブルB.区分が1のレコードと、2のレコード、2つ作る 以上のような処理をしたいと考えています。 ストアドはまったく初心者なのですが、分岐については、 DECLARE TEST CURSOR FOR SELECT 区分1, 区分2 FROM テーブルA OPEN TEST FETCH NEXT FROM TEST INTO @KBN1, @KBN2 --条件分岐 IF KBN1<>0 BEGIN @INKBN=1 END IF KBN2<>0 @INKBN=2 END WHILE @@FETCH_STATUS = 0 BEGIN INSERT INTO テーブルB(区分) VALUES(@INKBN) こんな感じになるのか？と思っているのですが、これではケース3の、 区分1、2ともに0ではない場合の処理ができません。 このような場合、どのように記述すれば目的の処理を達成できるのか 教えていただけないでしょうか？ よろしくお願いします。
２台のサーバーでそれぞれSQL Server2000 とSQL Server2005を動かしています。 ２台のサーバーの中の別のＤＢの中にあるテーブルを結合したいのですが、可能なのでしょうか？ ちなみに [データベース名１]のサーバーに接続した状態で SELECT a.*,b.* FROM [データベース名１].[dbo].[テーブル名１] AS a INNER JOIN [ServerIPアドレス].[データベース名２].[dbo].[テーブル名２] AS b ON a.ID=b.ID とやると 「sys.serversにサーバー 'ServerIPアドレス' が見つかりませんでした。 正しいサーバー名を指定したかどうかを確認してください。 必要であればストアド　プロシージャ sp_addlinkedserver　を実行し、 サーバーを　sys.servers に追加してください。」 というエラーになってします。 宜しくお願いします。
　現在SQL Server2005を利用しており、vb2005を利用してdb.mdfを利用したスタンドアロンシステムの製作に成功しました。そこで、別途のプログラムからも同一のmdfファイルを利用しようとしているのですが、スタンドアロンシステムで利用している状態の時ログオンできないという状況に見舞われています。SQL ServerManagement studioでもアタッチしているのですが、開くことができなくなってしまいます。テーブル内容確認用に作成したACCESSのODBC接続でも試してみたのですが、スタンドアロンシステムを開いていると開くことができません。同一のMDFファイルは同時に開くことはできないものなのでしょうか？同時に複数のプログラムから開くにはどのような方法をとっていいものなのでしょうか？よろしくお願いしします。
いつもお世話になっております。現在visual basicとSQLserver2005Expressを利用してスタンドアロンで利用するシステムを開発したのですが、そのデータベース情報を社内の公開したいと考え、ASPを利用したWeb照会システムを作成しました。しかし、スタンドアロンシステムのを起動しているとASPの照会システムが動作せず、ASPの照会システムを動かすとスタンドアロンシステムが動作しません。エラー内容は [System.Data.SqlClient.SqlException: ユーザーの既定データベースを開けません。 ログインに失敗しました。] とでます。 おそらそれぞれのシステムでSQLserverに登録されている別々のユーザを利用しているためであると思うのですが、SQLServer2005には複数ユーザーが同時にログインはできないのでしょうか？なんとかこのシステムを動作させる方法はないでしょうか？
覚え始めで、どうにも上手くいかず困っております。 テーブル「個人ファイル」「個人ファイル２」 それぞれに「個人NO」の項目があります 「個人ファイル１」に存在し「個人ファイル２」に 存在しない「個人NO」の一覧を取得するには どうしたらよいのでしょうか？ SQLSERVER　でEXCEPTが使えなくて・・ どなたかお願いです。教えてください。
現在、下記のデータがあります。 A B C 1 2008/10/01 2008/10/31 質問ですが、カラムBの2008/10/01から、カラムCの2008/10/31まで同データAを集計する、SQLでの記述方法はありますでしょうか？ 出力は、31となります。　 ASP側からの集計は、解決できるのですが、 SQLからの集計はどのようにするのか疑問に思いましたので質問させていただきました。
いつもお世話になっております。 現在、VB2005でSQLのプログラムを書いているのですが。 下記のInsert分に関してなのですが・・・ sCom = New SqlClient.SqlCommand(_ & "insert into janDB"(区分,コマンド種別,No) " _ & "values('A01','send',100)", scn) としたらうまくいくのですが、 valuesの実データを変数にしたいのですが, そういった処理はできないでしょうか？ 何分初心者の上、試行錯誤しているのですがうまくいきません。 アドバイス等を頂けたら幸いです。 SQL Server 2005 Express Edition Visual Studio 2005 Standard Edition Windows XP Pro SP2
お伺いします。 SELECT a , WHEN ISNUMERIC(b) = 1 THEN b ELSE 0 END AS b into #hoge from table と言うSQL文があります。 型としましては、 aはdecimal(16.4)、bはnvarchar(256)とします。 bに'999999999'が入っている（9桁）場合は、 正常に値がワークテーブル#hogeに書き込まれますが、 bに'9999999999'が入っている（10桁）場合には、 「nvarchar の値 '9999999999' の変換が int 型の列でオーバーフローしました。整数値の最大値を超えました。」 と怒られてしまいます。 これは何故でしょうか? ちなみに、文字列'9999999999'をbとして直接渡してやっても正常にワークテーブルhogeに書き込まれ、終了します。 数字の場合のみ10桁以上でも書込みを行いたいのですが、出来ずに困っています。 アドバイスありましたら宜しくお願い致します。
はじめまして。 サーバー初心者です。 会社で物品の手配を任されたのですが、Microsoftのライセンス関係が全くわからず、またシステム管理者がいないので当サイトを利用させていただいた次第です。 まず会社がしたいことですが、サーバーにSQLServerをインストールし、クライアントＰＣ等のオフィスのAccessからSQLのデータベースを利用したいのです。OSはWindows2003Serverを考えています。 ライセンスですが、Windows2003Serverがプリインストールされた機器に、CALというのがついています。またSQLにもCALがついています。 このCALとはGoogleで調べましたら、クライアントがアクセスするための権利とのことでした。 そこで質問 １．CALはOSにもSQLにも付けなければいけないものなのでしょうか？ ２．付けなければいけない場合、CALを購入しOS上で設定しないといけないのでしょうか？ ３．現在Windows2000でODBCというものを使ってSQLへアクセスしているようで、CALを買っていないと聞きました。Windows2003serverでSQLを使用する場合、ODBCを使用することは可能でしょうか？また、その際OSやSQLのCALは必要でしょうか？ 説明不足の部分がありましたらお申し付けください。 宜しくお願い申し上げます。
お世話になっております。 現在データベースの中に下記のようなデータが存在するとします。 A B C D 1 2 3 4 （Aのカラムに1） （Bのカラムに2） と言う具合にデータが入っています。 そこで質問なのですが、クライアントの自由にABCDのカラム内のデータをソートさせるにはどのようにしたらよいでしょうか？ 現在は、データベースのテーブルを下記のようにする対処方法しか思いつかないのですが、できれば上記テーブル構成のままソートさせたいのですが何か良い方法は御座いませんでしょうか？ 例）　 クライアントがA D B C の順にソートしたい場合 テーブル名:TB1 A 　1 　順位1 B 　2 　順位3 C 　3 　順位4 D 　4 　順位2 select * FROM TB1 A ORDER BY 順位 ASC 出力： 1 4 2 3
お世話になります。 ＳＱＬＳＥＲＶＥＲにてレコード、テーブル のＬＯＣＫ、ＵＮＬＯＣＫはどのように記述 するのでしょうか？ ＳＱＬハンドブックやネットで探しても なかなか見つかりません。 どのようになっているのか 教えていただけると助かります。 よろしくお願い致します。
先の質問でSQL Server を使おうと決心し Microsoft SQL Server 2005 Express with Advanced Services を win2000にインストールしました 色々なページを見ながら　正常にインストールできたようなのですが 試しに何かデータベースを作ってみようと思ったのですが アクセスで言うテーブルデザインを作っていくのはどこでどうやるのか 分からず、色々調べたら SQL Server Enterprise Manager と言う物が必要のようで インストールされた中を探しても見あたりません・・・。 これはどこで入手するのでしょうか？ インストールの手順でも間違ってしまったでしょうか？ もしくはｓｐ１にバージョンアップするべきなのか・・ 色々検索してみたけれど　新規テーブル（データベース）の作成は どうやってやるのかよく分かりません 上記ソフトもそうなんですが わかりやすく解説したページなどあるようでしたら教えてください。 よろしくお願いします。
質問場所がここで良いか少し不安ですが 主にＷｅｂで公開するデータベースのシステムを作ろうとしています 自分のスキルの範囲でやろうとしていますが少し分からないことがあるので　教えてください まず　自分のできること（やっていること）は ・Windows系サーバー（ＩＩＳ）を使ってＶＢスクリプト（ＡＳＰ）で ローカルにあるＭＤＢファイルにアクセスし商品を紹介する動的ページの作成 です。 今後複数ユーザーでデータベースを使うことになるので　システムを変えていく必要がでてきて ＭＤＢはダメだという事になり色々調べた結果、今後のことも考えＷｅｂサーバーとは別に データーベースサーバーを作ってやると言う結論になりました 分からないこと（あやふやな理解になっていること） １.データベースサーバーとは何か？ 　これは　OSは別として、SQL Server、オラクル、MYSQLといった 　RDBMSをインストールしただけのデータベース置き場専用という感じのＰＣを指すと言うことで良いでしょうか？ 　例えば　Win2000のIISでwebサーバーを作りその中のASPページから 　別ＰＣにあるデータベースにアクセスする構成がデータベースサーバーを別に設けると言うことで正しいのかどうかと言うことなのです。 ２.データベースは何がよいか？（SQL Serverでよいか？） 　本来であれば、webで商品在庫を公開することがメインで更新頻度が少ないデータベース 　（３００人ぐらいで共有し１万～３万レコードです）です、なおかつ複雑なＳＱＬは発行しません。 　ほぼASPからの接続で抽出（ID=**　という単純な抽出条件）しか使わない、あとは並び替え位なので 　ＭＹＳＱＬが向いているようでしたが、私はLinux系は全く分かりません。 　なので　メンテナンスの面や勉強する時間の節約からすれば 　Windowsで動くSQL Serverが良いと思うのですが（MYSQLもWindowsで 　動くけど得意とする高速性はLinux系でないと発揮しないみたいなのでやめようと思っています） 　上記のような条件と使い方の場合、そんなに処理時間やマシンの負荷に両者間では大差があるのでしょうか？ 　ＭＤＢの時でもあまり不具合を感じなかったので、それよりは格段にSQL Serverは早いし負荷が少ないと聞いていますので 　大丈夫かなと思っています。 ３．SQL ServerをインストールするＰＣは何が最適か？ 　先も述べたようにデータベース専用として使う予定ですが 　Win2000でよいのでしょうか？（XPより2000の方が安定がよいと思うので）　それともWin2003Serverに 　インストールできるならその方がよいでしょうか？ 　とにかく安定度が一番なのですが、そもそもWin2003Serverに 　インストールできるのでしょうか？（もうすぐ2008？がでるからそれにしようかとも検討中です） ４.最終的に自分の思っていることと実体の構成（理解）は理解は以下のような感じで正しいのでしょうか？ 　 　複数でデータベースを共有するため、ＭＤＢでなくネットワークに強い （共有データベースで壊れにくい？壊れない？）データベースに変えるため、windowsで動くSQL Serverを使う 　そのSQL ServerはwebサーバーがあるＰＣとは別のＰＣにインストールして使う 　（データベースサーバーを別に用意する）ことでwebサーバーの負荷も減らし、データベースも快適に動くようにする 最終的にはWin2003Server×２台で１方はwebサーバー１方はSQL Server をインストールして使うことで上記を実現させる 5.SQL ServerのデータベースはＭＤＢのような最適化というような作業が必要なのでしょうか？ 　そもそも　似ているようで違う　ＭＤＢとSQL Serverでその特徴がきちんと理解できていないので 　愚問なのかもしれませんが　気になるので教えてください 6.オラクルと違いSQL Serverはレコードの更新や追加の時 　その行（レコード）だけロックすると言うことができない？ 　ようなので、Ａさんが自分の商品を更新中にＢさんも更新する 　と言うようなことが起こった場合（ＭＤＢはこれになると壊れると書いているので　ＭＤＢをやめました） 　Ａさんの更新が終わるまでＢさんは更新できない（更新終了まで待つ）と言うことになるのでしょうか？ 　また、このとき商品一覧を要求された場合、更新中の情報はどの様になるのでしょうか？（更新終了まで見れない？） なんか　分かりにくい質問になってしまいましたが、お金をかけて 買ったはいいが、理解不足でやりたいことができなかったと言うことは 避けたいので　ご教授下さい。　よろしくお願いします。
SQLserver2000で複数のテーブルを定期的にAccessへバックアップしたいのですが、以下の問題が発生致しました。 DTSのウィザードを利用して、パッケージを作成し、スケジューリングまでは行えました。 定期的なスケジュールでAccessにエクスポートする際、 １回目は、正常にエクスポートできますが、 ２回目以降は、「既にテーブルが存在します」のようなメッセージが出て、エクスポートできません。 Accessに上書きエクスポートはできないのうでしょうか。 もしくは、上記のような場合、どのようなクエリを発行すればよいでしょうか。 どなたかご教示お願い致します。
質問させていただきます。 下記のようなデータがあります。 表.TEST コード1　 　0001 　0002 　0003 　0004 表.TEST2 コード1　　　コード２　階数　・・・・ 　0001　　　　401　　　　4　　　 　0002　　　　501　　　　5 　0002 401 4 　0003　　　　301　　　　3 0003　　　　101　　　　1 　 以上のテーブルを内部結合して以下のようなデータを抽出します。 コード1　　　コード２　階数　・・・・ 　0001　　　　401　　　　4　　　 　0002　　　　501　　　　5 　0003　　　　301　　　　3 0001　　　　101　　　　1 ←この部分を削除したい。 以上わかる方いたら教えてください・
NULLの行を最下位にする場合は、下記のようなコードで解決できました。 select * from table order by case when TEST is null then 0 else 1 end Asc 例）　 NULL | 1 3 | 2 1 |→　 3 2 |NULL これを、時間（HH:MM)をソートする時に、順番が思うように行きません。 3:20 | 1:10 1:10　　　|→　 9:10 9:10 | NULL NULL | 3:20 上記のような順にソートされてしまいます。　 1:10 3:20 9:10 NULL の順にするには、何かよい方法はありませんでしょうか？よろしくお願い致します。
sqlcmdの-qでクエリを実行できると思います。 sql全般になるかもしれませんが、 さらにオプションで実行結果にタイマってつけられないんですか？？
参考書やサイトなどでチューニングの仕方は載っているのですが、 実際設定してみて、簡単に検証みたいなのをしてみたいのです。 いい方法ってありませんか？？ 特にmax server memory??っていうのを知りたくて、 デフォルトでは最大値になっていると思います。 それを変更して、どう変わったのかっていう実感がわかないので 質問します。 お願いします。
SQLで新たにウインドウを開いて追加するときに、 ラジオやチェックボタンなどを選択したときに 5件あれば＋1されてidが6だけ表示するSQLを書きたいんですが どうしたらよろしいですか
SYBASEからSQLサーバにデータを転送したいのですが、 リンクサーバーが設定できません。 環境は　WindowsXP　SQLServer2000　です。 Microsoft OLEDB Provider for ODBC を利用すれば できるような解説も見つけたんですが、上記ドライバーがインストールされません。 Microsoft OLEDB Provider for ODBC をダウンロードできないか探したのですが見つかりませんでした。 かわりに、MDACドライバをインストールしてみようともしましたが、 こんどは「このバージョンのWindousと互換性がない」エラーが出ました。 何を調べて、どうすればいいのかもわからなくて困っています。 どなたかご存知であれば、教えて下さい！！！ よろしくお願いします。
SQLServerについては知識がないので、基本的な質問かもしれませんがお願いします。 現在、社内のシステムはAccess2003で通しています。 中小企業なのでクライアント数も15（全クライアントにAccessをインストール済み）ほどで、データ量は全部のmdbファイルで2GB程度です。 ただAccessではスタンドアロンになりがちで、複数のクライアントからの同時アクセスによるデータ更新ができにくい状況です。これについては、本来はやりたくないのですがmdbファイルを複数に分散したりして逃げています。（できれば1つのmdbファイルが理想です） また、mdbファイルの大きさやクライアントのPCスペックにもよると思いますが、Accessでの操作性がよくない（重い）です。 このような状況から考えて、自社のWindowsServer2003にSQLServer2005を導入の予定でいます。 そこで一番聞きたい質問なのですが、 「Accessで構築したmdbファイルを、SQLServerにデータを移すのみで問題はないのでしょうか」 どこへ移すのかとか、それができたとして、クライアントは今後どこから自社のシステムへアクセスしたらよいのかはまだ知識がないためまったくわかりません。。 ただ、SQLServerについての基本的なことはおさえておくつもりです。 なお、SQLServer2005を導入するのならば、無償版（Express）があるそうなのでそれで様子を見て、いろいろ不足するようでしたら上位版を考えています。
SQL Server2008は近日発売といろいろなサイトに書かれていますが、だいたい何月くらいという事は書かれていません。だいたいで結構ですので何月くらいに発売されるかお教えください。
SQL Serverについては無知識なもので、以下の質問内容で場違いでないか心配です。 私の社内ネットワークの構成は以下のとおりです。 Server2003で構築しており、ドメイン下に15のクライアントがあります。 SQL ServerはSever2003にインストールでOKだと思うのですが、クライアントにはAccess？のインストールが必須ということでしょうか。 既にAccessをすべてのクライアントにインストールされている場合、SQL Server 2005のラインアップではどれを購入するのがよいのでしょうか。 基本的な質問かもしれませんが、よろしくお願いします。
MS SQL Server 2005のStandard Editionを使いたいのですが、 無償でダウンロードできることってやはり無理ですか？？
ASC,DESCというのは、英語では何の略なのでしょうか。 該当しそうな単語を少し調べてみたのですが分かりませんでした。お教えください。
６００MBほどのバックアップファイルをリストアしようとしたところ１８GBものHDD容量が無いとリストアできないというメッセージが表示されました。普段からShrinkメニューにて不要なデータは削除しているためDB自体は小さいのですが、リストアするときだけ莫大な容量を求められます。どうにかならないでしょうか MicrosoftSQLServer2000 Windows2003 Server
google 等で、必要な情報が見つからなかったため、ここで質問してみます。 既出だったら申し訳ないのですが、下記の T-SQL スクリプトを作成しようとしています。 どうにも取っ掛かりが無いので、下記の簡易なスクリプトの例があったらご教授ください。 なお、自動化が目的なので、Transaction-SQL となっています。 DTSパッケージ等でできるのはわかっています。 DTSパッケージでの操作を、トレース等でトレースログをとろうにも、 別インスタンス指定の部分のみがログに残らないので、途方にくれています。 やりたいこと(Transaction-SQL) (1) 同じサーバー上で稼動している別インスタンス(例えば [DB01])から、インポートする。 (2) テーブル名、テーブル定義は同じ(当然キーなどの優先順位なども同じ) (3) インポート指定時にクエリ等で、データを指定する。 (このクエリについては作成できています。つまり同じインスタンス内では動作可能となっている)
UPDATE文で効率のよい方法を模索しています。皆様方のお知恵をお貸しいただければと思い投稿してみました。 以下のようなテーブルが存在していると仮定します。 TB_1 id|custom|tanto1|tanto2|syohin|date 1 |1 | 10| 10| 999|2007/01/01 2 |1 | 10| 10| 999|2007/02/01 3 |1 | 20| 20| 999|2007/03/01 4 |1 | 20| 20| 999|2007/04/01 5 |1 | 10| 10| 777|2007/04/01 ※idはプライマリキーです。 ※date以外はすべて数値となっております。 custom,syohinが同じものでtanto1に複数の値が存在する場合、一番古いdate（もし同dateが存在するならidの小さい方）のtanto1をtanto2に書き換えたい。 ※上記の例ではid 3と4をid 1のtanto1をtanto2へ更新します。 ↓ 更新結果 id|custom|tanto1|tanto2|syohin|date 1 |1 | 10| 10| 999|2007/01/01 2 |1 | 10| 10| 999|2007/02/01 3 |1 | 20| 10| 999|2007/03/01 4 |1 | 20| 10| 999|2007/04/01 5 |1 | 10| 10| 777|2007/05/01 UPDATEでEXISTS句を使ったり、サブクエリで試してみましたが思った結果が得られなかったので、 とりあえずストアドプロシージャでカーソルを使って更新する処理をしたのですが、（処理をここで説明するのは省略させていただきます） UPDATE文を駆使して、できないものでしょうか。 SQL2000およびSQL2005のどちらでも動作することが条件となります。 誠に恐れ入りますがご教授願います。
OutLookのアドレス帳の情報をSQLの顧客情報の中に一度にいれたい。のでお教え願います。
DB：SQLServer2000 こんにちは お世話になっております。 トランザクションのテーブルA から ワークのテーブルBへInsert Into Select を使用してデータを格納しているのですが、その際に重複が発生してしまいます。 テーブルA 主キーあり テーブルB 主キーなし Delete B Insert into B select 項目1,項目2,・・・ from A With(Nolock) where 日付項目 = 20080101 テーブルAの主キー項目は全てテーブルBへInsertしており、Insert完了後のテーブルBの中身を見ると、まれに全く同じデータが2件出来ていることがあります。 このInsert into selectが実行されている間に、テーブルAに対して登録更新が行われることもあります。 色々と試してはいるのですが、原因が特定できずに困っております。 もし何かお気づきになられる方がいらっしゃいましたら、ご教示下さい。 よろしくお願い致します。
非常に初歩的な事で恐縮ですが、 以下のデータを抽出するsql文の書き方を模索しています。 環境：SQLSERVER2005 | 列１| 列２ | +---+---+ | 1 | A | | 1 | B | | 1 | C | | 1 | D | | 2 | F | | 2 | G | | 2 | H | | 3 | X | | 3 | Y | | 3 | Z | 上記のテーブルがあるとします。 列１でグループした値で、1レコード目の列２を抽出したいのです。 出力結果としては、 列１列２ +--+--+ 1,A 2,F C,X としたいのです。 列１でGROUPしてしまうと列２の内容を集約しないといけないので困っています。 ご教授いたけないでしょうか？
AとBテーブルをJOINして抽出する場合 Aテーブル A1 Bテーブル B1 B2 B1 B3 でJOINすると、 A1 B1 B2 A1 B1 B3 が抽出されます。 ここで、 A1 B1 B2 B3 A1 B1 B2 B3 という風にJOIN先のデータを 両方の行にSelectさせることは可能でしょうか？ というのも、 B2かつB3が含まれるAテーブルを抽出したいので。 よろしくお願いします。
SQLServer:2005 OS:XP こんにちは。お世話になっています。 SQLServerでビューを作成し、テーブル「a」の構成データにプラスして、前月の１日を入力させようとしています。 ビューの列に↓を入力すると CAST(YEAR(DATEADD(m, - 1, GETDATE())) AS varchar) + CAST(MONTH(DATEADD(m, - 1, GETDATE())) AS varchar) + CAST('1' AS varchar) 「200811」と出力されるのですが、このデータを日付型にするにはどのような関数を追加したらいいのでしょうか？ アドバイスをお願いいたします。
お世話になっております。 Aテーブル NO　名前 データ1 データ2 1　　aaa　　10 100 2　　aaa 20 120 3 　 ccc 30 130 4 ddd 40 140 上記のテーブルがあった際に、同一の名前の場合は最大値のデータを取ることをしたい場合はどのようにしたらよろしいでしょうか？ 下記の通りの出力結果が希望です。 NO 名前　　データ1 データ2 2 aaa 20 120 3 ccc 30 130 4 ddd 40 140 Distinct ではなく、GROUP　BY で解決したいと思います。またGROUP　BY以外にも方法が御座いましたら宜しくお願い致します。
SQLServerのライセンスについて質問させていただきます。 SQLServer 2005を使った既存のクライアントサーバシステムがあります。このSQLServerはEnterpriseEditionのCALをPC台数分用意し運用しております。そこで今回、そのシステムの機能拡張として、新たにWebによる検索システムを構築することになりました。 このときWebサーバはファイアウオールの外側に（当然ですが）、SQLServerはファイアウオールの内側に配置しようと思っているのですが、SQLServerのライセンスはEnterpriseEditionのCALを追加するだけでよいのでしょうか？それとも新たにプロセッサライセンスが必要になるのでしょうか？ ご存じの方がいらっしゃいましたら、ご教授の程お願い致します。
sqlserverについて、アプリを実行すると「40001(1205)」というエラーが発生します。デッドロックが発生しているようです。原因が分かりません。どのような場合に発生するのでしょうか。？
テーブル1のデータを計算してテーブル2を作成したいと考えております。 計算については"数値"を更新日付の一つ前の値と引き算してその結果をテーブル2に挿入したいと思ってます。 テーブル1 ID　数値　更新日付 001　23　2008/02/23 2:00:00 001　34　2008/02/23 3:00:00 001　50　2008/02/23 4:00:00 001　23　2008/02/23 5:00:00 002　25　2008/02/23 3:00:00 002　50　2008/02/23 4:00:00 002　70　2008/02/23 5:00:00 002　50　2008/02/23 6:00:00 結果 テーブル2 ID　数値　更新日付 001　11　 2008/02/23 3:00:00 001　16　 2008/02/23 4:00:00 001　-27　2008/02/23 5:00:00 002　25　 2008/02/23 4:00:00 002　20　 2008/02/23 5:00:00 002　-20　2008/02/23 6:00:00 一応考えたのですが SELECT * FROM テーブル1 AS a, テーブル1 AS b WHERE (((a.ID)=[b].[ID]) AND ((b.更新日付)=(select min(更新日付) from テーブル1 as b where a.更新日付 < b.更新日付))) ORDER BY a.ID, a.更新日付)； として、aとbの数値を引き算しようと考えていますが、可能なのでしょうか？ ぜんぜん別の方法でもいいので教えていただけないでしょうか？ 以上　よろしくお願いいたします。
いつもお世話になっております、ありがとうございます。 SQL文を文字型変数に格納し、EXECUTEで発行する方法のことを何とか、といったと思うのですが、ド忘れしてしまいました。 あいまいな記憶では「外部○○」とか、そんな感じだったと思うのですが・・・ よろしくお願いいたします。
プログラム超初心者です。 開発環境；ASP.NET（visual studio2005） サーバ：SQLSERVER2005 sqldatasourceにupdate文を入れてマスタの更新処理を作っております。 対象のテキストボックスの値を空白にしたままupdate処理を走らせると、なぜか空白値がnull値となってDBに保存されてしまいます。 update処理をする際に空白値をnull値に変換しない方法ってありますか？ ご教授お願いします。
以下のような売上テーブルがあった場合に、 ◎売上累計金額を会社毎、売上日順に取得する SQLをお教えください。 Oracleでいうところの以下のような分析関数はありますでしょうか？ sum(売上金額) over(partition by 会社名 order by 売上日) 例：売上テーブル 会社名　 売上日　　 売上金額　◎売上累計金額（会社別） (1)AAA　 2005/12/01 1000　 1000 (2)AAA　 2005/12/02 200 　 1200 (3)AAA　 2005/12/04 300 　　 1500 (4)AAA　 2005/12/10 500 　　 2000 (5)BBB　 2005/12/05 300 　　 300 (6)BBB　 2005/12/09 200 　　 500 (7)BBB　 2005/12/20 100 　　 600 (8)CCC　 2005/12/05　 500　 500 (9)CCC　 2005/12/08　1000　 1500
テーブル名を一覧表示したいのですが、 SQL Server 2005 での方法ご存知でしょうか？ http://msdn2.microsoft.com/ja-jp/library/ms18982 … T-SQL の一覧を見てみましたが解らず．．．
sqliteの構造体 sqlite3_stmt の宣言は見つかるのですが 構造体の内容の定義してあるものが見つかりません。 sqlite3.c を探したのですが見つかりませんでした。 お分かりの方、よろしくお願いします。
初心者です。ＳＱＬ文で困っています。 どなたかご教授頂けたらと思います。 環境は、SQL SERVER 2000です。 特定のカラムが最大値のレコードのみ取得したいです。 たとえば、以下のようなデータがあるとします。 コード、履歴番号で主キーとします。 コード|履歴番号 |金額 0001 |1 |12000 0001 |2 |12001 0001 |3 |12002 0002 |1 |12000 0002 |2 |12001 0002 |3 |12002 0003 |1 |12000 0003 |2 |12001 この場合に、コード毎に履歴番号が最大のレコードのみを取得したいです。 理想の結果は以下になります。 コード|履歴番号 |金額 0001 |3 |12002 0002 |3 |12002 0003 |2 |12001 以上です。よろしくお願いいたします。
すみません。若干記入ミスだったので再投稿します。 こちらにご解答お願いします。 TABLE_a ・Ta_id ・key_table ・key_field ・key_no TABLE_b ・Tb_id ・Tb_name TABLE_c ・Tc_id ・Tc_name と３つのテーブルがあり、 key_tableに「TABLE_b」、key_fieldに「Tb_id」が入ってて、 TABLE_aとTABLE_bを select の left join して抽出したい場合、 どういうSQL文になるのでしょうか。 select * from TABLE_a left join case key_table when 'TABLE_b' then 'TABLE_b' when 'TABLE_c' then 'TABLE_c' end on 'TABLE_a.key_field'.key_no = case key_table when 'TABLE_b' then ''TABLE_a.key_table'.Tb_id' when 'TABLE_c' then ''TABLE_a.key_table'.Tc_id' end ; とやってみたのですが、うまくできませんでした。 ご教示お願いします。
Accessのアップサイジングウィザードを使用し、SQLServerへ テーブルとデータを移行しようと考えています。 Access2000、SQL Server 2005 Express Editionを使用して います。 アップサイジングウィザードで「既存のデータベースを使用する」 を選択すると移行できるのですが、「新しいデータベースを作成 する」を選択すると、移行できません。レポートに「Table was skipped or export failed」と表示されます。 （ログインユーザはcreate table権限があります。） アップサイジングウィザードの手順書には、、「新しいデータベース を作成する」を選択すると書いてあるので、うまくいかない理由を 知りたいと思います。 宜しくお願い致します。
For hcnt = 1 To 18 w1_kin = 0 cmd.CommandText = "SELECT sum(sisitu_db) FROM syosai " _ & "WHERE hno_db = hcnt " w1_kin = cmd.ExecuteScalar() + w1_kin 省略 NEXT テーブルの列hno_dbにあるコード１から１８毎の金額合計を求める のですが、上記の式（コード1の場合）では「hcntは列名の無効」となります。 hno_db = 1 では正しく実行されます。 宜しくお願いします。
hotfix以外作ったことないので、質問です。 ローカル環境にSQL Server2000をインストールしました。 今一番やりたいことは、SQL Server2000のサービスの開始と停止を 自動やるバッチファイルを作りたいです。 オススメのURLなどありましたら教えてください。
SQLserverのストアドで SET @aaaa = NULL って記述は有効なのでしょうか？
初心者です。Indexについての質問です。 1.Where 注文No=nnn と 2.Where 注文No=nnn and 明細No=mmm といった問い合わせを行うため、二つのIndexを作成しました。 index-A：注文No index-B：注文No,明細No 「1.Where 注文No=nnn」の問い合わせは、 index-A、index-Bのどちらでもパフォーマンスは同じでしょうか？ であれば、index-Aを消したいので・・・ よろしくご教授くださいませ。
初心者ですみませんが何か教えてください。 作ってもらったホームページですが、Yahooなどで検索するときに 検索窓にURL(http://www.ドメイン名）を入力しても出てきません。 何か原因はありますか？（アドレスバーに入力すれば表示されます。）
タイトルの件。調査したのですが、変数を配列でとる方法(宣言の仕方や使用方法)が見つけられませんでした。 ご存知の方、ご教示いただけませんでしょうか? できれば使用方法が書かれた本やサイトをご紹介いただけると助かります。 それともSQLServer2005のストアドプロシージャでは変数を配列で使用することはできないのでしょうか? (そんなことはないと思うのですが、探しても出てこないのが不思議です。私の検索方法が悪いからだと思いますが) 以上です。よろしくお願いします。
レンタルサーバーの管理会社の対応が悪く、移設したいと考えています。別の会社に０から制作してもらえば実現可能なのは分かりますが、それでは費用が2倍かかってしまいます。コストをなるべくかけずにサーバー（コンテンツ）を移設するにはどのように進めていけばよろしいのでしょうか？
SQL Server初心者です。 SQL Serverで2バイト文字をASCIIコードの値で返したいのですが、関数ASCII()を使用すると、1バイト目のASCIIコードの値しか返してくれません。 2バイト目の文字も返す方法をご教授ください。 言葉足らずでわかりにくいかと思いますが、よろしくお願い致します。
下記のようなデータがあった場合、それぞれの区分毎に年月が最新のデータと２番目に最新のデータを取得したいです。 ＜検索対象データ＞ 区分　年月　　　金額 ----------------------------- A　　 200411　　700 A 　　200412　　600 A 　　200503　　560 B 　　200311　　600 B 　　200508　 1000 B 　　200504　　560 C 　　200508　　400 C 　　200301　 1100 ＜取得したいデータ＞ (1)区分ことに年月が最新のデータ 区分　年月　　　金額 ----------------------------- A 　　200503　　560 B 　　200508　 1000 C 　　200508　　400 (2)区分ことに年月が２番目に最新のデータ 区分　年月　　　金額 ----------------------------- A 　　200412　　600 B 　　200504　 560 C 　　200301　 1100 (1)に関してはこちらに回答があります。 http://oshiete1.goo.ne.jp/kotaeru.php3?q=1439772 (2)のデータを取得する方法を教えていただきたい。 (1)と(2)の混在でもかまいません。 よろしくお願いします。
今、 　　cd C:\test\test 　　rename C:\test\test\test.txt C:\test\test\test3.txt と書かれた、「C:\test\test\test.bat」を作成しました。 これをジョブに登録して実行させたいと考えています。 ジョブのステータスのコマンド入力欄に 　　C:\test\test\test.bat と入力しましたが、実行してもエラーになってしまいます。 　　ステップ 1、ジョブ 0x4E063F33EB0DC344B0FF72A50A0CDF86 のプロセスは作成されませんでした (理由: 指定されたパスが見つかりません。). ステップは失敗しました。 どうしたらうまくいくでしょうか？ ジョブステップの詳細で、出力ファイルのフォルダ選択にCが出てこないことが関係あるのでしょうか？
初心者です。 SQL SERVER 2005で データベースで使用されている外部キーの一覧を取得したいのですが、 SELECT * FROM sys.objects WHERE type = 'F' や SELECT * FROM sys.foreign_keys では、実際にどのテーブル・どの項目が使用されているのかが取得できません。 どのようなSQL文を書いたらいいでしょうか？ よろしくお願いします！
VB2005、SQLSever2005ともに初心者です。みなさんの知恵をお借りしたく質問いたします。以下の状況で困っています。 １．VB2005からSQLSever2005へ接続する為にはコードをどのように記述すればよろしいでしょうか。 ２．「AAA」というテーブルに「BBB」というテーブルから「AAA」の「A_No」という項目に「BBB」の「B_No」という項目の値をセットするにはどのような記述が必要でしょうか。 よろしくお願いいたします。
何度もお世話になっております。 SQLServer2000にて、現状で300近くあるテーブルデータにText型であるフィールドが複数存在ます。 今回行ないたいことは、これらテーブルのVIEWを作成 → 各テーブル内で"Text型"に定義されているフィールドを"VarChar(max)型"に変更してVIEWを作成したいのです。 この作業をあまり労力をかけずにできれば一括で処理できる方法等ありませんでしょうか？どうかよろしくお願いします。
はずかしながら、SQLサーバーは使ったことすらありません。 会話にすらならないのではないかと心配しておりますが、お許しください。 この度、業務上お客様のなかで稼動しているSQLサーバーに対して、私のＰＣから自動的にテキストデータをＵＰ？しなければならなくなりました。リアルタイムにテキストを送る事を考えていますが、 そのファイル形式とは？ 転送する方法？（FTPとか・・・）をご伝授願えませんか？ さらに、このSQLサーバーは、私が送ったデータを元に、ある判定をし、別のＰＣにテキストデータを投げたいと考えています。 このファイル形式とは、一般的に何を使われるものなのですか？ その転送する方法とは？？
今使っているデータベースのファイルサイズが2GBに なってしまったので、 一度まっさらなデータベースを用意しようと思い、 trancute tableで全てのテーブルの内容を消して、 データベースのバックアップをしました。 バックアップのファイルサイズは４０MBぐらいになっているんですが、 復元するとファイル領域に元の２GBのサイズが確保されてしまいます。 どうすれば、ファイルサイズが小さくなるのでしょうか? よろしくお願いいたします。
SQLServe2000にて、bcpコマンドでテーブルのエクスポート(csv形式)を行いたいと考えています。しかし出力元テーブルの一部フィールドで改行が入ったデータがあり、出力時に行の体裁が崩れてしまいます。bcpコマンドにて出力時に上記の問題を回避する方法を探しています。（やりたいことはSQLServe上から定期的にＣＳＶデータを出力するのが目的です。）どうかよろしくおねがいします。
お世話になります。 クラサバを構築しているのですが、クライアントよりデータをサーバに登録する際、VB6 SP4のアプリでバッチ処理を行っております。１電文目（サーバのストアドプロシジャを起動）のみ、サーバ（Sql Server 2005）に更新できません。2電文目からあとは、正しく更新されています。 以前は、クライアント側のプログラムは同じだった状態で、サーバのデータベースは、SqlServer 7.0で運用しておりました。その際は、全く問題なく更新できておりました。 また、SQLSERVER2005でサーバ側のプロファイラを使用すると、1電文目も正しく残っています。 このような現象・対処方法等ご存知の方はいらっしゃいませんでしょうか。 よろしくお願いします。
WindowsXPでSQLサーバ2000を運用できるかな？ できる場合、CALは必要なのかな？
はじめまして、よろしくお願いします。 Access のデータベースに保存してある文字が ASP.NET で Grid.Viewで表示させたときに改行されずに続けて表示されてしまうのですが,どのようにすれば改行されるでしょうか？ Accessの時 abcd efg ASP.NETの時 abcdefg
はじめまして、よろしくお願いします。 VisualBasic 2005 と Access と ASP.NET を使います。 まず、VisualBasic 2005 で、TextBox と Button を使い、TextBox に「あいうえお」と入力し、次に Enter で改行して「かきくけこ」と入力し Button をクリックしたら、Access のデータベースに追加させます。 最後に ASP.NET Web サイトで Access のデータサーバに追加した文字を表示させたいのですが、初めに VB2005 の Textbox で入力した文字が、 あいうえおかきくけこ と改行がされていない状態で表示されてしまうのですが、 あいうえお かきくけこ このように表示するために何かいい方法はないでしょうか？
【環境】 OS:Windows Server 2003 DB:SQL Server 2005 言語:VB .NET 2005 現在、Windows2000Server + SQLServer2000 + VB6の環境を 上記の環境に移行しております。 ADO Connectionの再利用で 「手動または分散トランザクションモードのため、新規接続を作成できません」 というエラーが発生します。 いろいろと検索してみたのですが、解決せず、お力をお貸しいただきたいと思って投稿させていただきます。 現在のコードは、 -------------------------------------------- Public adoCn As ADODB.Connection Public adoRs As ADODB.Recordset Public Sub pfAutoClosed() 　If fGet印刷ジャーナルファイルRecordset() = True Then 　　　'********************* 　　　'トランザクションの開始 　　　'********************* 　　　adoCn.BeginTrans() 　　　'印刷ジャーナルファイルのロック 　　　sMySQL = "SELECT * FROM 印刷ジャーナルファイル WITH (TABLOCKX)" 　　　adoCn.Execute(sMySQL, , ADODB.CommandTypeEnum.adCmdText) 　　　'職員表マスタのロック 　　　sMySQL = "SELECT * FROM 職員表マスタ WITH (TABLOCKX)" 　　　adoCn.Execute(sMySQL, , ADODB.CommandTypeEnum.adCmdText)　<---- ここでエラー発生 　　　adoRs.MoveFirst() 　　　Do Until adoRs.EOF 　　　　　iKubun = nz(adoRs.Fields("区分").Value) 　　　　　'***************** 　　　　　'１．職員表マスタの作成 　　　　　'***************** 　　　　　'SQLステートメントを作成 　　　　　sMySQL = "INSERT INTO 職員表マスタ （～以下省略）" 　　　　　adoCn.Execute(sMySQL, , ADODB.CommandTypeEnum.adCmdText) 　　　　　'************************** 　　　　　'２．更新区分に更新フラグを設定 　　　　　'************************** 　　　　　sMySQL = "UPDATE 印刷ジャーナルファイル " & "SET 更新区分 = 1 （～以下省略）" 　　　　　adoCn.Execute(sMySQL, , ADODB.CommandTypeEnum.adCmdText) 　　　　　adoRs.MoveNext() 　　　Loop 　　　adoCn.CommitTrans() 'トランザクション処理のコミット 　　　adoRs.Close() 　　　adoRs = Nothing 　endif End Sub '***************************************** '印刷ジャーナルファイルのレコードセットを取得 '***************************************** Private Function fGet印刷ジャーナルファイルRecordset() As Boolean 　　adoRs = New ADODB.Recordset 　　With adoRs 　　　　.let_Source("SELECT * FROM 印刷ジャーナルファイル " & "WHERE 発行区分 = 1 AND 更新区分 = 0") 　　　　.let_ActiveConnection(adoCn) 　　　　.CursorType = ADODB.CursorTypeEnum.adOpenKeyset 　　　　.LockType = ADODB.LockTypeEnum.adLockPessimistic 　　　　.Open() 　　End With 　　If adoRs.EOF Then 　　　　fGet印刷ジャーナルファイルRecordset = False 　　Else 　　　　fGet印刷ジャーナルファイルRecordset = True 　　End If End Function -------------------------------------------- となっています。 pfAutoClosed関数内で、同じadoCnを使用しての２度目のSELECT文が実行できません。 ADO Connectionの再利用ができないということで、「Close」をしてくださいという記述を参考にもしたのですが、解決しておりません。 トランザクション開始位置も変更してみたのですが、だめでした。 VB->VB.NETへのアップグレードウィザードを使用したのですが、移行以前のVB6のバージョンではエラーなく動作します。 間違っている点をご指南いただければと思います。 よろしくお願いいたします。
お世話になっております。 SQL Server2005のバックアップ・リストアに関する質問です。 環境はサーバ１台とクライアントが３台のＣ／Ｓ構成です。 クライアントのうち１台は、サーバが故障した場合に備えて、毎日、サーバと同じ状態にしています。 そのため、現在、以下の手順で、データベースのリストア作業を毎日行っています。 (1)サーバから完全バックアップ (2)バックアップファイルをクライアントへコピー (3)クライアントにリストア (4)サーバからバックアップファイルを削除 しかし、データベースのサイズも大きくなり、(1)～(3)の作業に、かなりの時間を要するようになりました。 そこで、スピードアップを図るため、 ・差分バックアップ ・トランザクションログバックアップ いずれかを使用したいと考えています。 試しに、以下の手順でバックアップ→リストアを行うと、エラーが発生します。 【エラーが発生する手順】 (1)週末、サーバから完全バックアップ (2)バックアップファイルをクライアントへコピー (3)クライアントに復元 (4)サーバから完全バックアップファイルを削除 (5)週始め～差分バックアップ (6)バックアップファイルをクライアントへコピー (7)クライアントに復元 →「ロールフォーワードできる状態のファイルがないので、 　ログまたは差分バックアップは復元できません。」のエラー発生 バックアップファイルは、サーバにもクライアントにも残さず削除することが要求されているため、必ず(4)の完全バックアップファイルを削除しています。 一度、完全バックアップをリストアしているので、差分バックアップファイルが存在すれば、それをリストアできるように思っていました。 完全バックアップファイルが存在しなければ、差分バックアップをリストアすることはできないのでしょうか？ ヘルプを読んでみると、何となく、完全バックアップ＋差分バックアップがセットで存在しなければリストアできないように認識しましたが、この認識は正しいでしょうか？ もし、完全バックアップファイルを削除すると、差分バックアップをリストアできないのであれば、バックアップファイルを残すことなく、差分のみをリストアする上手い方法がないでしょうか？ 何かご存知の方がいらっしゃいましたら、ご教示よろしくお願いいたします。
SQLServer2005でストアドプロシージャを作成しました。 VisualStudioを使用すればデバッグ(一行ずつ実行して、変数の中身や動作を確認)できるということですが、設定がうまくできません。 ストアドプロシージャ作成は初めてで、周りにも経験者がいないため解決策がわからない状態です。 ご存知の方、気がついたことがある方は、ぜひご教示ください。 ■■ マシン環境 ■■ OS:Windows2003Server DB:SQLServer2005 ■■ 試した方法 ■■ １．DBサーバマシンのVisualStdio2005を使用 上記マシンに、SQLServer2005をインストールしたとき、　　VisualStudio2005が自動的にインストールされたので これを使用することを考えました。 VisualStudio2005の「サーバーエクスプローラー」に、 今回作成したストアドプロシージャを表示するところまではできたのですが、 デバッグ実行できません。 メニューから「ストアドプロシージャのステップイン」を選択してデバッグウインドウを表示するらしいのですが メニューには、以下のものしか表示されません。 　新しいプロシージャの追加 ／ 開く ／ 実行 ためしに実行すると、ストアドプロシージャは動作します (テーブルへのデータINSERTをストアドでコーディングしており、実行後に指定値が入っていたため) しかし、デバッグポイントを設定できず、ステップ実行もできません。 ２．別マシンのVisualStdio2003を使用 私の開発マシンにはVisual Studio 2003が入っているため、 DBサーバマシンとリモートで接続して、上記と同様の設定を行いました (このVisual Studio2003はC#開発用にインストールしたものです)。 こちらは、メニューに「ストアドプロシージャのステップイン」が出ました。しかし……。 メニューから「ストアドプロシージャのステップイン」を選択してデバッグウインドウが表示されたときに、以下のメッセージボックスが出ます。 「SQL Server データベースが正しくセットアップされていないか、またはユーザーに master.sp_sdidebug を実行する権限がないため、ストアド プロシージャをデバッグできません。」 デバッグウインドウ上でデバッグポイントは設定できますが、 ストアドプロシージャを実行してもデバッグポイントでとまらず ステップ実行もできません。 (同様にINSERTしたテーブル値から、ストアド自体は動作していると判断) なお、１．２．共にSA認証でSQLServer2005にログオンしています。 SQLServer のデバッグできるのは、sysadminサーバロールを持つユーザだけらしいですが、 SA認証で使用しているユーザには「sysadmin」のサーバロールは設定しています。 ■■ 質問 ■■ 1) QLServer2005インストールで自動的にインストールされるVisualStudioでは、 ストアドプロシージャのデバッグはできないのでしょうか？ それとも、SQLServer2005インストール時に、開発環境等の追加設定や、 別途VisualStudio2005をインストールする必要があるのでしょうか？ それとも、別にSQLServer management Studioや構成ツール等で設定が必要なのでしょうか？ または、メニューに「ストアドプロシージャのステップイン」を出す設定(方法)をご存知の方、ご教示をお願いします。 2) 「SQL Server データベースが正しくセットアップされていないか、またはユーザーに master.sp_sdidebug を実行する権限がないため、ストアド プロシージャをデバッグできません。」 このメッセージはどうすれば回避できるのでしょうか？ SQL Server データベースが正しくセットアップされていないということですが、 これまで特に支障がないため問題はないと思っているのですが……。 検索で以下のサイトを見つけましたが、SQLServer2000のため参考になるかは疑問です。 　　http://support.microsoft.com/kb/839280/ja 　　http://support.microsoft.com/kb/886680/ja 以下のサイトは、どうすれば原因回避できるのかわかりませんでした(勉強不足を感じております) 　　http://msdn2.microsoft.com/ja-jp/library/ms16401 … master.sp_sdidebug を実行する権限の設定方法をご存知の方、ご教示いただけませんでしょうか? 3) Visual Studio以外で、SQLServer2005のストアドプロシージャをデバッグする方法がありましたらご教示ください。 変数の途中の値を一時テーブルにINSERTして確認するくらいしか方法はありませんでしょうか? 申し訳ございませんが、もしご存知の方、ご教示いただけませんでしょうか？ なお、設定やマシン環境で記述不足等ありましたら、ご指摘いただければと思います。 以上です。よろしくお願いします
はじめまして。 SQL Serber　初心者で、他に聞ける人がいないため質問させていただきます。 環境：SQL Server2000 あるDBのテーブルからINSERT文にて取得したデータをテーブルに保存したいと思い、新規にテーブルを作成したところ、10000行しかデータが入りません。 （実際に取得したデータは、87000行くらいあるのですが、そのうち、10000行しか入らなかったです） 原因がわからず、困っています。 よろしくお願いいたします。
SQLServer2005のストアドプロシジャーにて、 クエリの結果をファイルに出力したいのですが、 どのようにすればよろしいでしょうか？ xp_cmdshellでSQLCMDを呼び出す以外に方法はありますか？
よろしくお願いします。 この本に記載されているサンプル、どこかに置いてありませんでしょうか？
VPNでの拠点間接続で実行速度の違いで悩んでいます。 本店にSQL SERVERのパソコンを置いてB営業所からVPNで 接続しています。 B営業所から本店のデータベースに接続すると １つのメニューボタンを押すと１５秒くらいかかるのですが 1台だけ、３秒程度で済む、パソコンがあります。 何の違いでこうなるのか、いろいろ調べましたが原因が つかめません。 本店のデータベースのパソコンは XP Pro, MSDE2000-SP4です。アプリケーションはAccess projectで作成。 B営業所のパソコンはXP HEやXP ProでOffice XP Access で接続。 接続の早いパソコンはMSDE2000 SP4,Office2003,VB6が入っているので 遅いパソコンにそれらをインストールしてみたのですが同じでした。 これらの内容で何かご存知の方がおられたらご教授お願いします。 不足する情報がありましたらご指摘ください。
サーバ監視を行うアプリケーションのデータベースとしてSQL Serverの利用を考えています。 この監視アプリケーションは複数のサーバ(Windows)に対して、ping/パフォーマンスデータ/イベントログなどを元に、死活や性能監視を行います。 マイクロソフトのホームページに「システム管理製品(Microsoft System Center等)のデータベースとして利用する場合」は管理する端末の数分のCALが必要との記載があります。 http://www.microsoft.com/japan/sql/howtobuy/lice … 死活や性能監視を行うサーバ監視アプリケーションの場合は、前述の「システム管理製品」とは違うとは思いますが、この場合、対象の端末分のCALは不要なのでしょうか。それとも必要になるのでしょうか。 よろしくお願いします。
SQLServer2000でちょっと困った現象が発生しています。 あるテーブル(仮にTableAという名前とします)を、次の2つの方法で行数をカウントしたのですが、出力される行数が異なっているのです。 方法1： SQLServer EnterpriseManagerで、該当のテーブル(TableA)のアイコンをダブルクリック。 すると「テーブルのプロパティ」というダイアログが出る。 そのダイアログに表示されている行数 (行数　　135114) ← となっています 方法2： SQLクエリアナライザで、下記のSQL文を打ち込む 　Select * From TableA クエリ結果の左に行数が振られるのですが、その末尾の数(行数と一致するはずです) (末尾の行数は 135597 となっています。) この二つの数値が異なるのはなぜでしょうか？ 結果は同じになるはずと思われるのですが、何かのバグでしょうか？ ご存知の方、同じようなご経験がある方、教えていただけますでしょうか。 よろしくお願いします。
業務アプリケーションで使用しているSQLServer2000StandardEditionがあるのですが、これにVB2005から別アプリを作成し、データの抽出を行おうとしています。 DB元々の設定で、ユーザーIDがあり、パスワードが設定されていない状態なのですが接続は可能なのでしょうか？ 因みにsqlcmdでの接続を下記の4パターンのコマンドで行ってみましたが、いづれも拒否されました。 >sqlcmd -E -S サーバー名 -d DB名 >sqlcmd -U ユーザーID -P "" -S サーバー名 -d DB名 >sqlcmd -U ユーザーID -P -S サーバー名 -d DB名 >sqlcmd -U ユーザーID -S サーバー名 -d DB名 -P >sqlcmd -U ユーザーID -S サーバー名 -d DB名 -P ""
毎度お世話になります。以下の件で解かる方いらっしゃいましたら教えてください。 現在、以下のようなテーブルがあるとします。 ID | DATA1 | DATA2 | DATA3 1 | 100 | 200 | 300 2 | 250 | 350 | 100 3 | 400 | 100 | 200 これより、行毎にDATA1からDATA3までの範囲内での最大値を取得したいのですが、それは可能でしょうか？ 以下のような感じで取得したいのです。 ID | 最大値 1 | 300 2 | 350 3 | 400 列の最大値ならMAXを使えばいいのでしょうが、同行内最大値となるとどのように書けば良いか検討が付きません。 スマートな方法があれば、ご教示お願いします。 環境は SQL Server 2005です。宜しくお願いします。
本についていた サンプルを動かそうとしてSQL server 2005 expressをインストールしたのですがサンプルデータベースに登録する際にDBエラーになって、うまくSQLServer 2005 Expressに接続できません。 エラーの内容は System.Data.SqlClient.SqlException:サーバーへの接続を確立しているときにエラーが発生しました。SQL Server 2005 に接続しているときときにこのエラーが発生した場合は、SQL Serverの既定の設定がリモート接続を許可しないようになっていることがエラーの原因である可能性があります。 (provider: 名前付きパイプ プロバイダ, error: 40 - SQL Server への接続を開けませんでした) 場所 System.Data.SqlClient.SqlInternalConnection.OnError(SqlExceptionexception, Boolean breakConnection) 場所System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj) 場所 System.Data.SqlClient.TdsParser.Connect(Boolean& useFailoverPartner, Boolean& failoverDemandDone, String host, String failoverPartner, String protocol, SqlInternalConnectionTds connHandler, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, SqlConnection owningObject, Boolean aliasLookup) 場所 System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance) 場所 System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity > identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject, Boolean redirectedUserInstance) 場所 System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection) 場所 System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnection owningConnection, DbConnectionPool pool, DbConnectionOptions options) 場所 System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject) 場所 System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject) 場所 System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject) 場所 System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection) 場所 System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) 場所 System.Data.SqlClient.SqlConnection.Open() 場所 Seasar.Framework.Util.DataSourceUtil.GetConnection(IDataSource dataSource) ・ ・ ・ となり、データベースの登録に失敗しましたとなります。 初歩的なことでもうしわけないのですが、よろしくお願いします。
SQLServer2005を使用しています。 テーブル単位でエクスポート、インポートする方法は 可能でしょうか？ 可能でしたら教えていただきたいです。 宜しくお願いいたします。
SQLServer2005初心者ですが、おわかりになる方いらっしゃいましたら、教えてください。お願いします。 やりたいことは(下記は間違いのSELECT文ですが) SELECT Nomber , SUM(ISNULL(CASE WHEN KenYY + KenMM = '200711' THEN Siyoryo ELSE 0 END, 0)) AS '2007年11月' , SUM(ISNULL(CASE WHEN KenYY + KenMM = '200712' THEN Siyoryo ELSE 0 END, 0)) AS '2007年12月' ,　 MAX(ISNULL(CASE WHEN RecNO = MIN(RecNO) THEN Sedai ELSE '' END, ''))Sedai_MIN ,　 MAX(ISNULL(CASE WHEN RecNO = MAX(RecNO) THEN Sedai ELSE '' END, ''))Sedai_MAX FROM TABLE GROUP BY Nomber で、SELECTの最後のSedai_MIN,Sedai_MAXで集計関数を２回使っているので、エラーがでるのは分かるのですが、始めのMAXを消すとGROUPBY句にSedaiとRecNOが含まれていないというエラーがでて、GROUPBYに追加すると、同じNomberが複数でてしまうのです。 同じNomberは1つしか出ないようにする場合、上記のSELECT文をどのように変更すればよろしいのでしょうか？ 回答よろしくお願いいたします。
調べたり聞いたりしたのですが なかなか解らなかったので、質問させてください。 ＡテーブルとＢテーブルとがあり、Ａテーブルのみにしか 存在しないデータを一発で取得することはできるのでしょうか？ Ａテーブルのデータ数（１００件） Ｂテーブルのデータ数（８０件） Ａのキー項目とＢのキー項目とは同一です。 処理をしたい事はＡとＢとでＡにしか存在しないデータを ループせずに一回のＳＱＬで行えたらと思っています。
こんばんは。 お世話になります。 SQL Server初心者です。 現在、CSVファイルに出力された他のデータベース（Paradox）のデータをSQL Server2005に移行するためのツールを作成しています。 Paradoxでは、以下のように、(1)と(2)のレコードが存在した場合、重複エラーとならなかったのですが、SQL Serverでは、当然ながら、重複エラーとなってしまいます。 　(1)aaaaa, 1, あいうえお 　(2)AAAAA, 1, かきくけこ 　※aaaaaとAAAAAが主キーの場合 CSVファイルのレコードは、多いもので700万件も含まれ、これを１行読み込み、既存データか否かをチェックし、既存の場合はINSERTしないという処理を700万回繰り返すと、相当な時間がかかり、性能向上を求められています。 そのため、BULK INSERTを使用する方向で検討してみました。 しかし、CSVファイルに主キー重複したレコードが存在すると、エラーが返されますが、BULK INSERTでは、どのレコードでエラーになったかまでは取得することができません。 ずいぶん、調べてみたのですが、無理のようでした。 BULK INSERTでエラーとなる箇所を特定する方法は本当にないでしょうか？ もし、無理ならば、何か他にエラー箇所を特定して速くINSERTするコマンド、方法はないでしょうか？ お知恵をお借りしたく、よろしくお願いいたします。
SQLServerのデータペースの内容をASPから更新するプログラムを作成していますが、UPDATEできずに困っています。 エラーの内容は、 Microsoft OLE DB Provider for ODBC Drivers (0x80004005) [Microsoft][ODBC Driver Manager] データ ソース名および指定された既定のドライバが見つかりません。 となります。 元々はAccess2000のデータベースで、その時は正常に動作していたのですがデータベースをSQLServerに変更したらUPDATEできなくなってしまいました。 SELECTによるデータの呼び出しは可能なので、システムDSNの設定は間違っていないと思うのですが．．． 接続は、 Set OBJ=Server.CreateObject("ADODB.Connection") OBJ.Open sql , "DSN=SQLDB" としていますが、OBJ.OPEN の行でエラー発生します。 【環境】 windows2000server + IIS SQLServer2000 アクセスとは接続方法が違うのでしょうか。 確認すべきポイントなどありましたらご教授ください。 よろしくお願いします。
ＳＱＬについて、質問があります。 （質問） 以下のようなＤＢがあります。 【１のＤＢ】 ID 品目 金額　　　　日付 -------------------------------------------- 1　　　ミカン　　　1000　　　　2007/11/1 1　　　オレンジ　　2000　　　　2007/11/1 1　　　レモン　　　 100　　　　2007/11/1 2　　　ぶどう　　　1500　　　　2007/11/1 【２のＤＢ】 区分　　品目 金額　　　　日付 ------------------------------------------- a 　　　ミカン　　　1000　　　　2007/11/1 a 　　　オレンジ　　 500　　　　2007/11/1 a 　　　レモン　 　　300　　　　2007/11/1 a 　　　ぶどう　　　1500　　　　2007/11/1 b 　　　ミカン　　　 100　　　　2007/11/1 b 　　　オレンジ　　 200　　　　2007/11/1 b 　　　レモン　 　　500　　　　2007/11/1 b 　　　ぶどう　　　2500　　　　2007/11/1 条件。 １のＤＢの品目＝２のＤＢの品目 やりたい事。 （１）２のＤＢの金額（区分=a）×１のＤＢの金額÷２のＤＢの金額（区分=b） （２）１のＤＢのＩＤで、（１）で得た計算結果を集約 上記ＤＢで具体的に言うと、 １のＤＢのＩＤ＝１（ミカン、オレンジ、レモン）のそれぞれの計算結果を計算 （ミカン） 1000×1000÷100＝10000 （オレンジ） 500×2000÷200＝5000 （レモン） 300×100÷500＝30 計算結果を集計（ミカン＋オレンジ＋レモン） 10000＋5000＋30＝15030 上記の作業をできれば、1回のＳＱＬでやりたいと思うのですが、可能でしょうか？ １回のＳＱＬでは不可能な場合、（１）番だけでもやりたいのですが・・・。 ＳＱＬのコーディングがよくわかりません。 ご教授をお願いします。
複数行のデータを一つの文字列にまとめる方法を教えてください。 ※環境SQLServer2005 例： ID DATA AA XXX BB YYY AA ZZZ 次のようなテーブルがあるとき、IDがAAであるものを一つの文字列　"XXXZZZ"　にまとめたデータにSQLで加工したいです。
お世話になっております。 Windows2003Server SQLServer2000(SP4) を使用しています。 新しく作成したテーブルに、どのようなインデックスを設定したら良いか悩んでいます。 新規作成のテーブル：tableA カラム　　　　　主キー　型　規定値　説明 --------------------------------- ユニークNo　　　P　　　INT　　　　　ユニークなコード 大分類コード　　P　　　INT　　　　　大分類マスタとリンクする 中分類コード　　P　　　INT　　　　　中分類マスタとりんくする 代表フラグ　　　　　　　INT　　0　　 0と1があり、1の方が優勢 やりたいこと： tableAからユニークNoが重複しないようにしてデータを取得する。 このとき、ユニークNoが重複している場合は、代表フラグ=1のデータを取得する。 ただし、代表フラグ=1のデータが複数存在する場合は、大分類コード、中分類コードの最若番のデータを取得する。 また、代表フラグ=1が0件で、代表フラグ=0が複数ある場合は、その中から、大分類コード、中分類コードの最若番のデータを取得する。 これを実現するために作成した取得用ストアド： SELECT 　　x.ユニークNo, 　　x.大分類コード, 　　中分類コード, 　　x.代表フラグ FROM 　　(SELECT 　　　　ユニークNo, 　　　　MAX(代表フラグ) AS 代表フラグ 　　FROM　[tableA] 　　GROUP BY　ユニークNo) AS z, 　　(SELECT 　　　　ユニークNo, 　　　　代表フラグ, 　　　　MIN(大分類コード) AS 大分類コード 　　FROM[tableA] 　　GROUP BYユニークNo,代表フラグ) AS x, 　　(SELECT 　　　　ユニークNo, 　　　　代表フラグ, 　　　　大分類コード, 　　　　MIN(中分類コード) AS 中分類コード 　　FROM　[tableA] 　　GROUP BY　ユニークNo, 代表フラグ,大分類コード) AS y WHERE 　　x.ユニークNo = y.ユニークNo AND 　　x.大分類コード = y.大分類コード AND 　　x.代表フラグ = z.代表フラグ AND 　　y.代表フラグ = z.代表フラグ AND 　　x.ユニークNo = z.ユニークNo アドバイス、宜しくお願いします。
SQL Server2005 を使用しています。 テーブルのインポート・エクスポートに関して質問があります。 今まで、Oracleを主に使用していて、「EXP」「IMP」コマンドを使用して DMPファイルを介して別PCのデータベース間でテーブルのやり取りをしていました。（DB上のテーブルすべてや特定のテーブルのみなど） 同様のことをSQL Serverで実現したく下記を試したのですが上手くいきません。 １．Management Studio で「タスク」→「データのインポート(エクスポート)」 　　フラットファイル、Excel、MDBファイルなど試したのですが、 　　これらの中間ファイルを介した際にデータ型が変わってしまい 　　元の型のまま戻せない。 　　Oracleの「DMP」ファイルのようなものには落とせないのでしょうか？ ２．「bcp」コマンド 　　これに関しては、複雑でよくわかりませんでした。 　　もし、このコマンドで実現可能であれば、やり方を教えて下さると 　　助かります。 以上、ながなが書きましたが宜しくお願い致します。
次の様な動的SQLを作成し、テーブルのコピーを作成しようとしていますが「メッセージ 214、レベル 16、状態 2、プロシージャ sp_executesql、行 1　プロシージャにはデータ型 'ntext/nchar/nvarchar' のパラメータ '@statement' が必要です。」というエラーが出て実行できません。 構文などは間違っていないと思うのですが、よろしくご教授下さい。 ■プログラム DECLARE @SQLString VARCHAR(500) DECLARE @ParmDefinition VARCHAR(500) DECLARE @spRet int set @SQLString= N'SELECT * INTO @tableto FROM @tablefrom' set @ParmDefinition= N'@tableto VARCHAR(100),@tableto VARCHAR(100)' EXECUTE @spret=sp_executesql @SQLString,@ParmDefinition,@tableto='コピー元のテーブル名',@tableto='コピー先のテーブル名'
タイトルの通り、現在実行中のストアドが何なのか知りたいです。 稼動しているのSQLServerでは、複数のストアドを実行しています。 その中で現在、どのストアドが実行されているのか確認したいのですが、 確認方法がわかりません。たぶん、、プロファイラ？？を使いそうな・・・ぐらいだけ、予想していますが、よくわかってないです。 SQLServerのプロファイラの知識レベルですが、私、一度も使ったことがなく、知識に乏しい状態です。 そのためご存知の方、ご教示頂けると嬉しいです。
４つのテーブルのいずれかをアクセスしますが、 select文はひとつでwhereでテーブルを指定したいので、 　例：select * from ビュー where table_no=1 とかで、table_noの値でアクセスするビューは 作れますか？ ※この例の場合、select * from table1が実行したい。 ４つのテーブルは全て同じ構造で、 データが違うのみです。
本社からVPN経由で事業所のSQLServer（EnterPrizeEdision） にODBC接続でリンクテーブルを使用したMs_Accessを稼働させ ておりますが、DELLパソコンから接続すると何をやっても接続 エラーとなってしまいます。別のDELLパソコン何台かで試して みましたが、同じ結果でした。 また、接続可能なパソコンはDELL以外でIBM、NEC、富士通は問 題なく接続できます。 DELLパソコンならではの何かが邪魔をしているのでしょうか。 それとも相性なのでしょうか？ いろいろ調べましたが原因が全く分からない状況で困り果てて ます。どなたかご教授いただけると大変うれしいです。 よろしくお願いいたします。
お世話になります。困り果てた挙句ご教授頂きたく投稿いたしました。 下記３つのテーブルより、EmpIDで検索をかけると、結果のようになる様にしたいのです。（下記はwhereで EmpID = @EmpIDが1の場合） 使っているのはSQLServer2005になります。 また、抽出範囲は、Periodが検索日当日（GetDate()）より過去１年というものになります。 A table EmpID　　　Period　　　休暇理由　　　取得時間 1　　　　　　１月　　　　　　'有休'　　　　　　　8 1　　　　　　１月　　　　　　'病欠'　　　　　　　4 2　　　　　　１月　　　　　　'有休'　　　　　　　6 1　　　　　　２月　　　　　　'有休'　　　　　　　8 2　　　　　　３月　　　　　　'病欠'　　　　　　　5 1　　　　　　４月　　　　　　'病欠'　　　　　　　7 B table (有休取得) EmpID　　　　Period　　　　取得時間 1　　　　　　　１月　　　　　　　8 2　　　　　　　１月　　　　　　　6 1　　　　　　　２月　　　　　　　8 C table (病欠取得) EmpID 　　 Period 　　 取得時間 1　　　　　　１月　　　　　　　4 2　　　　　　３月　　　　　　　5 1　　　　　　４月　　　　　　　7 結果 EmpID 　　 Period 　　 取得時間(有休) 　　 取得時間(病欠) 1　　　　　　１月　　　　　　　　8　　　　　　　　　　　4 1　　　　　　２月　　　　　　　　8　　　　　　　　　　NULL　　　　　　　←NULLは0と表示 1　　　　　　３月　　　　　　　　NULL　　　　　　　　NULL 　　　　　←共にNULLの場合、0もしくは表示させない 1　　　　　　４月　　　　　　　　NULL　　　　　　　　7　　 coalesceやらfull outer joinやらを使っても思うようになりません。 使い方が良くないのかもしれませんが。 どなたかご教授の程、よろしくお願いいたしますm()m
SQLServerでForeignキーの内容を確認したいのですが、 テーブル定義を表示する命令文を教えて下さい！
以下のネットワーク環境で、既に接続ができていたにも関わらず、 パソコンを新しく入れ替えたら（osはいずれもxpです）SQLサーバ ーに接続できなくなりました。 【ネットワーク環境】 　本社のPCにSQLSERVER(無償版）をインストールし事業所のサーバ 　にインストールしてあるSQLSERVER（EnterprizeEdition）のデー 　タベースに接続可能（接続はVPN経由です） 　　↓ 　本社のPCを入れ替えし、同じくSQLSERVER(無償版）をインストー 　ルしたのですが、何をしても接続できません。 　PCが変わっただけなのに何が原因かさっぱりわかりません。 　自分なりにいろいろ調べましたが、ファイアウオールなどが原因 　となることはあるのでしょうか。 　どなたかご教授いただけると大変助かりますのでよろしくお願い 　いたします。
SQLServer2005を使っています。 フルバックアップをとったファイルから、 一つのテーブルだけを復元させたいです。 このようなことは可能でしょうか？ 可能でしたら、方法を教えていただけないでしょうか？ よろしくお願いいたします。
いつも勉強させていただいています。 ストアドプロシージャの勉強をし始めて間もない素人ですがよろしくお願いします。 SQL-server2005でテーブルをCSVファイルに、ストアドプロシージャを使ってそのままエクスポートする、と言うことをやっています。 以下作成したストアドプロシージャです。 ******************************************* CREATE PROCEDURE [ストプロ名] AS DECLARE @command VARCHAR(200) BEGIN SET @command = ' bcp [データベース名].[スキーマ].[テーブル] out C:\XXXX\aaa.txt -PXXXXXX -UXXXXXX -SXXXXXX' EXECUTE master.dbo.xp_cmdshell @command END **************************************** 解析ボタン、実行ボタンをクリックしてもエラーは出ません。 「ストアドプロシージャの実行」を選択して実行させても、 アラーは表示されず、ファイルも作成されません。 xp_cmdshell が有効になるように設定もしました。 残念ながら検討すらつかない状態です。ぜひご教授お願いします。
分数がInt型のデータの場合 ExcelのTime()関数を使ったときの結果と同じにする 方法を教えてください。 =Time(0,AccessTime,0) 1->0:01:00 5->0:05:00 30->0:30:00 60->1:00:00 70->1:10:00 100->1:40:00
SQL文の組み立て方がさっぱりわからないので質問です。 ある商品テーブルの閲覧履歴テーブルから、レコメンドエンジンを 作りたいと思っています。 （amazonなどである「この商品を見た人はこんな商品も見ています」ってヤツです） 以下AテーブルからBのビューを導きたいのですが どのようなSQL文を書けばいいのでしょうか？ ■Aテーブル ┌────┬────────┐ │商品番号│見た人　　　　　│ ├────┼────────┤ │1　　　 │A　　　　　　　 │ ├────┼────────┤ │1　　　 │B　　　　　　　 │ ├────┼────────┤ │2　　　 │A　　　　　　　 │ ├────┼────────┤ │2　　　 │B　　　　　　　 │ ├────┼────────┤ │4　　　 │C　　　　　　　 │ ├────┼────────┤ │5　　　 │D　　　　　　　 │ ├────┼────────┤ │9　　　 │B　　　　　　　 │ ├────┼────────┤ │10　　　│B　　　　　　　 │ ├────┼────────┤ │11　　　│D　　　　　　　 │ ├────┼────────┤ │11　　　│B　　　　　　　 │ ├────┼────────┤ │12　　　│A　　　　　　　 │ ├────┼────────┤ │12　　　│B　　　　　　　 │ ├────┼────────┤ │12　　　│C　　　　　　　 │ └────┴────────┘ ■Bビュー ┌────┬────────┐ │商品番号│他に見た商品番号│ ├────┼────────┤ │1　　　 │2　　　　　　　 │ ├────┼────────┤ │1　　　 │12　　　　　　　│ ├────┼────────┤ │2　　　 │1　　　　　　　 │ ├────┼────────┤ │2　　　 │12　　　　　　　│ ├────┼────────┤ │11　　　│5　　　　　　　 │ ├────┼────────┤ │11　　　│1　　　　　　　 │ ├────┼────────┤ │11　　　│2　　　　　　　 │ ├────┼────────┤ │11　　　│10　　　　　　　│ ├────┼────────┤ │11　　　│12　　　　　　　│ ├────┼────────┤ │12　　　│1　　　　　　　 │ ├────┼────────┤ │12　　　│2　　　　　　　 │ ├────┼────────┤ │12　　　│4　　　　　　　 │ ├────┼────────┤ │12　　　│9　　　　　　　 │ ├────┼────────┤ │12　　　│10　　　　　　　│ ├────┼────────┤ │12　　　│11　　　　　　　│ └────┴────────┘ 考え方だけでも構いませんのでご教示いただければ幸いです。
皆様はじめまして。SQL勉強中のものです。 本日はどうしても解決できないことがありますので質問させていただきます。 テーブルAにCONDITIONという列があり、そこには１～５の値が入ります。 このCONDITION列に１～５それぞれ何件あるかを取得したいと考えております。単純にcount関数にて１～５のレコード数を取得するならば以下のSQLで取得可能と思います。 SELECT COUNT(CONDITION) FROM A WHERE CONDITION = '1' 以上をWHERE条件を変えて５回繰り返し。 これだと５回SQLを発行することになります。 これを一回のSQLにて取得できないかと悩んでおります。 皆様、どうかよろしくお願い致します。
5000万件のデータを格納しているテーブルのある項目に対して全件updateを実行しようと思っているのですが、処理時間の増大やシステムメモリ不足等が懸念されます。尚、更新処理には関数を使用します。大変恐縮ですが、何か効率良く処理するための方法をご教示頂きたく存じます。例えば、数万件単位でcommitする方法等。。
SQL Server初心者です。 CSVファイルのデータをテーブルにロードするにあたり、以下のような事をするにはどんな方法があるのでしょうか？ 　ケース１：CSVファイルのデータでテーブルを上書き 　ケース２：主キーが一致するレコードがテーブル内に存在する 　　　　　　データはUPDATE,なければINSERT ケース１，２それぞれDB2でいうところのImportコマンドを使用した時のREPLACEモード及びINSERT_UPDATEモードのイメージです。 DB2のように簡単にはいかないものでしょうか。 よろしくお願いします。
SQL SERVER2005を使用しています。 テーブルAがあり、Aが持つフィールド「suuchi」には数値が入っているとします。 suuchiフィールドの値を計算して、その結果が0以上なら計算結果を。負の数なら0を出力するSQL文を書きたいのです。 CASE WHEN を使用して以下のSQLを書きました。 SELECT CASE WHEN ( suuchi*2 + 1 ) < 0 THEN 0 END FROM テーブルA; しかし、結果は計算結果が負の数の場合は「0」になりますが、0以上の場合が表示されませんでした。 理由は、CASE WHEN でELSEを省略した場合、結果がNULLになるためと思われます。 以下のSQLでは期待とおりの結果が得られます。 SELECT CASE WHEN ( suuchi*2 + 1 ) < 0 THEN 0 ELSE ( suuchi*2 + 1 ) END FROM テーブル; しかし、同じ計算式を２回書くのは今一正しくないように思えます。 CASE WHEN で計算結果を判断した場合、ELSEでは計算済みの結果を取ることはできないのでしょうか？ 上は例として書いたので簡単な計算式ですが、実際私が業務で使用している計算式はかなり長いため できれば式を２回書くことを避けたいのです(SQL文が長くなるため)。 計算結果に一時的に別名をつけようとして、以下のようなSQL文を書いたのですが「AS 付近にエラーがあります」といわれます。 SELECT CASE WHEN ( suuchi*2 + 1 ) AS TMPFIELD < 0 THEN 0 ELSE TMPFIELD END FROM テーブル; 質問は２点です。 1) 計算式の結果をCASE WHEN で判断した場合、ELSEの時は計算結果を取得したい場合は、再度同じ計算式を書く必要がありますか？ 2) 上の答えが「必要ない」場合、上記条件を満たすSQLの書き方をご教示いただけませんでしょうか？ なお、質問文の文章、SQLServerの環境の記述不足、SQL文等で意味不明な箇所がありましたらご指摘ください。 以上です。よろしくお願いします。
こんにちは。 さっそく質問です。 MS SQL Server(2000)ですが、postgresql のフルバキュームのような機能はあるのでしょうか? あるのか、ないのか。。 あるのであれば、どのような操作すればいいでしょうか。 愚問でしたらすいません。 参考URLのみでも結構ですので、ご存知の方、教えてください。
すいません、どなたか教えて頂けませんか？OBCの勘定奉行21（Ver1.01)をVistaにインストールしたいのですが、その前にMSSQLServerというのをインストールしなければなりません（勘定奉行のCDに同包されている。）が、バージョンが古い（ver7.00.623)ためか、Vistaにインストールすると、MSSQLServerは「インストール完了しました」と表示されるのですが、いざ、勘定奉行をインストールすると、「MSSQLServerがインストールされていません」と表示されて、勘定奉行はインストールできません。なんとか、勘定奉行をインストールする方法はありませんか？それとも、どちらかの問題でインストール出来ないのではなく、勘定奉行もMSSQLServerも古いので、インストール出来ないのでしょうか？なにせ、会計ソフトが古いもので、とっくにサポート期間は過ぎているので、OBCのサポートは受けられない状態です。どなたか、宜しくお願いします。
SQLを書けなく困っています。お願いします。 「社員住所2007年」と「社員住所2006年」まったく同じ項目のテーブルがあるとします。社員数は多少増減します。 二つのテーブルを比較し、2007年の変わったレコードの変わった項目だけを取り出したいんです。 お願いいたします。
Visual Studio 2005 (VB) から、 SQL Server 2005 Compact Edition に対し、 テーブルの存在チェックを行いたいのですが、 SQL文の書き方がわかりません。 Compact Edition 以外のSQL Server でしたら、 以下のような SQL でチェックできる事は知っております。 IF object_id('Northwind..Orders', 'U') IS NOT NULL PRINT N'存在します' ELSE PRINT N'存在しません' 例外にて判断する方法は、最後の手段と考えております。 ご存じの方、どうぞ宜しくお願いします。
商品表と注文表から、注文のある商品名を知るためのＳＱＬ文で、適切なものはどれか。 商品表（商品番号，商品名，単価） 注文表（注文番号，商品番号，注文数） 答えはこれ↓なんですが、なぜなのか分かりません。 ＳＥＬＥＣＴ　商品番号，商品名　ＦＲＯＭ　商品表 　　　　　　　ＷＨＥＲＥ　ＥＸＩＳＴＳ　（ＳＥＬＥＣＴ　＊　ＦＲＯＭ　注文表　ＷＨＥＲＥ　商品番号　＝　商品表．商品番号）
次のＳＱＬ文のうちで、適切なものはどれか。 学生表（学生番号，学生氏名，所属学科，取得単位数） 答えはこれ↓なんですが、なぜなのかがわかりません。 ＳＥＬＥＣＴ　所属学科，ＭＡＸ（取得単位数）　　ＦＲＯＭ　学生表 　　　　　　　ＧＲＯＵＰ　ＢＹ　所属学科
My-SQLでは以下のSQLにより test01というDBからtest02というDBへ データをinsertすることができると思います。 また「insert」ではなく「replace」にすることで 同一キーの場合エラーにならず置き換えで データを登録してくれます。 ======================================= insert into [test01].dbo.test_table select * from [test02].dbo.test_table ======================================= そこで上記の「replace」を同じように SQLServerでできないか知っている方が おられたら是非ご教授いただきたく。 よろしくお願いいたします。
【質問内容】 自分で途中までやったんですが、（２）の第２正規形からわからなくなったので、どなたかデータベースに詳しい人のアドバイスをいただけたらなと思います。あと、間違いがあればご指摘願います。 【問題内容】 (1) 職種歴表（非正規形）をバッカス表記法で記述。 (2) (1)についてデータ正規化を第３正規形まで行い、その過程をバッカス表記法で記述。 (4) 正規化後の各表について、基本キー（連結キーの場合,その表　　 　 記)、外部キーを示す。 (5) このデータベースのデータ定義をSQL － DDL で記述。 【職種歴表】 従業員番号　従業員名　入社年月日　部門コード　部門名　　　職種コード　　　職種名　　　　　経験年数 S880123　　鈴木太郎　04/01/88　　　A01　　　 開発1課　　　　P01　　　　初級プログラマ　　　　2 　　　　　　　　　　　　　　　　　　　　　　　　P02　　　　　　　　　　　　　　　　　　　中級プログラマ　　　　3 　　　　　　　　　　　　　　　　　　　　　　　　S01　　　　　　　　　　　　　　　　　　　初級SE　　　　　　　　　1 T910354　　佐藤花子　04/01/91　　　B01　　　電算１課　　　　O01　　　　　初級オペレータ　　　2 　　　　　　　　　　　　　　　　　　　　　　　　P01　　　　　　　　　　　　　　　　　　　　初級プログラマ　　　　1 S860555　　高橋一雄　04/01/86　　　A02　　　開発2課　　　　　S01　　　　　初級SE　　　　　　　 3 　　　　　　　　　　　　　　　　　　　　　　　　S02　　　　　　　　　　　　　　　　　　　　中級SE　　　　　　　　5 (2) 職種歴表　＝　従業員番号　＋　従業員名　＋　入社年月日　＋　部門コード　＋　部門名　＋ 　 ｛職種コード　＋　職種名　＋　経験年数｝ (3) 【第１正規形】 職種歴表A　＝　従業員番号　＋　従業員名　＋　入社年月日　＋　部門コード　＋　部門名 職種歴表B　＝　従業員番号　＋　職種コード　＋　職種名　＋経験年数 【第２正規形】 職種歴表A　＝　従業員番号　＋　従業員名　＋　入社年月日　＋　部門コード　＋　部門名 職種歴表B　＝　従業員番号　＋　職種コード　＋　職種名　＋経験年数 職種歴表B2 ＝　職種コード　＋　職種名
会計ソフト「勘定奉行」を使っていたのですが、急に起動しなくなりました。エラーメッセージに「ＳＱＬサーバーが見当たりません」と出ていたので、調べたところ、ＳＱＬサーバーが停止してました。「開始/再開」をしても、すぐに停止してしまいます。 何が原因なのでしょうか…？ お願いします。教えてください。 「勘定奉行」が使えず、困ってます。。
あるテーブルに、あるカラム(列)が存在するかどうかを調べる方法はあるのでしょうか？ ・あるテーブル(TABLE_A)に、あるカラム(COLUMN_A)が存在しない場合はALTER TABLE ～ ADD でカラム(COLUMN_A)を追加する ・COLUMN_Aがある場合は何もしない というSQL文を作成したいのですが… 宜しくお願いします。
SQLserverで下記のようにテーブルがある場合、 TABLE_Bの単価をTABLE_Aの単価にセットしたい場合、 どのようにUPDATE文を記述すればよいでしょうか？ TABLE_A 商品　色　単価　数量　備考　　 TABLE_B 商品　色　単価 条件:商品と色が一致するもの TABLE_Bには重複データは無いものとする。 クエリーアナライザーで下記のように記述すると エラー「列名が無効です」となりました。 UPDATE TABLE_A SET TABLE_A.単価 = (select TABLE_B.単価 from TABLE_B where TABLE_A.商品 = TABLE_B.商品 and TABLE_A.色 = TABLE_B.色) どのような記述をすれば良いのでしょうか？
SQLサーバのバックアップを取りたいのですが、 データベースの保存はうまくいくのですが、 SQLサーバ[セキュリティフォルダ]下の[ログインフォルダ]の ユーザ情報は保存出来ないのでしょうか？ また、SQLサーバ自体のバックアップは取れるのでしょうか？ どなたかご教授いただけますか？
SQLServer2005で以下のテーブルがあります。 [Day] [Time] 　　1　　1:30 　　1　　2:00 　　2　　4:45 　　3　　2:30 　　3　　1:45 Dayフィールド、Timeフィールドは共にvarchar2です。 (Timeには"1:30"の文字列が入っています) このテーブルを読み込むとき、各日ごとの合計を計算して出力するSQL文がわかりません。 ■■ 出力イメージ ■■ Day Time 　　1　3:30 　　2　4:45 　　3　4:15 DateAdd関数やMAX関数等を使って考えましたが実現できませんでした。 こういう処理をSQL文でおこなうことは可能でしょうか？ もし実現可能な場合、方法やだいたいのやり方でも結構ですのでご教示いただけませんでしょうか？ TimeフィールドがDatetime型から可能でしょうか？ それとも、プロシージャや読み込んでから別途計算しなおさないと無理でしょうか？ よろしくお願いします。
マージレプリケーションまたは、サブスクリプションで変更可能なトランザクションレプリケーションを設定しようとしています。 SQL Server認証で行いたいと考えています。 マージパブリケーションを設定したあと、サブスクリプションを作成しようとしたところで、以下のようなエラーが発生します。 -------------------------------- ジョブは失敗しました。 所有者 AAA (ジョブ BBBB) にはサーバーへのアクセス権がありません. -------------------------------- （このAAAという所有者はWindowsのユーザーです） 思い当たるのが、サブスクリプションの設定をする時の「マージ　エージェントセキュリティ」の「サブスクライバに接続」の箇所は、「プロセスのアカウントを借用する」しか選べません。「SQL Serverログインを使用する」を選びたいのですが・・・。 全てのやりとりをSQL Server認証で行うには、どこを設定したらよいでしょうか？？widnows認証でしかレプリケーションの設定を行えないのでしょうか？？ パブリケーションは、SQL SERVER 2005 Developer サブスクリプションは、SQL SERVER 2005 EXPRESS です。
はじめまして 今、アパレルのショップの商品管理にエクセルをつかっているのですが sqlで管理しようかと考えています、 そこでmysqlをインストールしようといろいろ検索していると、 postgresqlというのを見つけました、mysqlとどう違うのでしょうか？オラクルとはまた別のものですか？ また、商品管理にsqlは向いていないでしょうか？ ほかに、使ったほうがいいものがあれば教えていただけないでしょうか？
以下の様なデータある場合 【Aテーブル】 ------------- NO,ITEM, KOSU ------------- 1 ,001 , 1 2 ,002 , 3 3 ,003 , 1 【Bテーブル】 ------------------- NO,NENDO,CODE,BIKO ------------------- 1,2006 , 1 , 1111 1,2007 , 0 , 1111 1,2007 , 2 , 1111 2,2007 , 0 , 2222 3,2007 , 0 , 3333 3,2007 , 1 , 3333 ------------------------------ NO,NENDO,CODE,BIKO,ITEM,KOSU ------------------------------ 1,2007 , 0 , 1111,001 , 1 2,2007 , 0 , 2222,002 , 3 3,2007 , 0 , 3333,003 , 1 と出力。(キーはNo） NO毎のかつ年度の降順、コードの昇順で最新の１件を 取得するにはどのようなSQLを作成したらよいのでしょうか？
Windows2003Server上でSQL Server2000を使用しています。 既存のDBと全く同じ構造で同じインスタンス上に別名のDBを 新規作成したいのですが、SQL Server Enterprise Managerを 用いてこのような事は可能でしょうか？ もし、SQL Server Enterprise Managerで困難なようであれば、 どのような方法で行えますでしょうか？ ご教授お願い致します。 m(__)m
DBをバックアップする際にトランザクションログを削除したいのですが、「データベースの保守計画」では、そのような設定はありません。そこで、「データベースの保守計画」後にトランザクションログを削除するSQLを流そうと考えているのですが、どのようなSQLかが分かりません。当サイトの過去ログを確認したところ BACKUP LOG [データベース名] WITH NO_LOG で削除可能とのことですが、全くトランザクションログは削除されません。削除方法を知っている方がおりましたら、教えてください。
ASP.NETでSqlServer2005(ExpressEdtion)のデータを更新・取得したいのですが、なんかうまくいきません。 以下のようなエラーメッセージが表示されます。 『サーバーへの接続を確立しているときにエラーが発生しました。SQL Server 2005 に接続しているときときにこのエラーが発生した場合は、SQL Server の既定の設定がリモート接続を許可しないようになっていることがエラーの原因である可能性があります。 (provider: SQL ネットワーク インターフェイス, error: 26 - 指定されたサーバーまたはインスタンスの位置を特定しているときにエラーが発生しました)』 SqlConnectionクラスのコンストラクタに渡している接続文字列の設定は Data Source =localhost Initial Catalog=Test Intergrated Security=True という感じです。 エラーメッセージにあるとおり、SqlServerのほうの設定がおかしいのかなと思って『Sql Serverセキュリティー構成』とかってのでリモート接続可能にしてもやっぱり同様の結果になります。 というか、Accessのデータには接続できるのですが、SqlServerだとダメです。 ためしにVisualStudioのサーバーエクスプローラーから、【新しい接続】でウィザード起動してSql Serverのデータへ接続しようとすると、やっぱり上のエラーメッセージがでちゃいます。コードから接続できないだけなら私が変なコード書いているのか？と思うんですが、ウィザード使っても同様なのって、Sql Serverの設定に問題があるってことですよね？もう全然分かりません。助けてください。
フォームのTextBox、DateTimePicker、MaskedTextBoxに入力したデータを 登録ボタンをクリックして、SQLのデータSet（Table)に書き込んでいくたためのコードを知りたいのですがどなたかご教示ください。 開発環境は、Visual Studio2005　Standerd Editionで言語はC#です。 宜しくお願いいたします。
SQL初心者です。初歩的かもしれませんが 教えていただけると助かります。 社員情報を管理するマスタテーブル『MST』（PKはSHAIN_ID）、 社員のシステムログイン履歴をログとして残すテーブル『LOG』 （PKはSEQのみ、SHAIN_IDとLOGIN_DATEを持つ） があります。 社員ごとに最新のログイン日付を表示するとき、 以下のようなSQLを書いたところ「パフォーマンス上あまりよくないSQL」 と言われてしまったのですが、どのように改善すればよいでしょうか？ ------------------------------------------ SELECT　MST.SHAIN_ID, 　　　　MST.SHAIN_NAME, 　　　　LOG.LOGINTIME FROM 　MST, 　　　(SELECT LOGINUSERID, 　　　　　　　MAX(LOGINDATE) LOGINDATE 　　　　FROM　LOG 　　　　GROUP BY SHIAN_ID 　　　) LOG WHERE MST.SHAIN_ID = LOG.SHAIN_ID ORDER BY 　　　MST.SHAIN_ID ------------------------------------------
はじめまして。初めて投稿します。 かなり困っているので、誰か助けてください。 内容はVB.Net2003を使用して、SQLServer2005に接続するときに 「SSPI コンテキストを生成できません」のエラーが発生してしまいます。 SQLServer2005をインストールしているのがサーバーではなく クライアント(プログラムを実行している端末)なので、 それが原因だと思うのですが、どうしてもその環境でしなくてはいけないので 何かご存知の方がおられるのなら、ご教示お願いします。 ソースは以下のとおりです。 ↓ Dim Scn As SqlClient.SqlConnection = New SqlClient.SqlConnection '接続文字列セット Scn.ConnectionString = _ "Server=""(local)"";Integrated Security=SSPI;database=" & データベース名 'dbオープン Scn.Open() ←このタイミングでエラーが発生
SQL Server超初心者です。（Oracleについては約１年ちょっとの経験はあります）どうぞよろしくお願いします。 今回SQL Server2005 を使って簡単なシステムを構築する事になりました。 SQL　Serverが扱う文字コートについて教えてください。 Oracleを使っていた時の経験としてDB内部のキャラクターセットと クライアントで使う文字セット（NLS_LANG）を意識しておかないと、いろんな「文字化け」問題に遭遇した時に対応できませんでした。 きっとSQL Serverにおいても同じような事ではないかと思いここに質問させていただきます。 以下２点についてどなたかコメント願います。 １．（Oracleでいうキャラクターセット）はどこで定義するのでしょうか？ ２．OracleでいうNLS_LANGに相当するものはあるのでしょうか？ 　（ひょっとしたらマイクロソフト製品なのでサーバもクライアントもCP932固定なのでしょうか？） 根本的にはシステム構築する上で『極力文字化けに遭遇したくない』思い出このような質問をさせていただきました。 『文字化け』について注意点などありましたら合わせてコメントいただければ助かります。 以上よろしくお願いします。
SQL Server2005で DBアクセスをするツールがあり、不定期なタイミングで Insertや、Update、Deleteが発生します。 このツールを動作中に別ツールでBACKUP DATABASEで DB内の全データのバックアップを行いたいのですが、 Insert(Commit)などのタイミングと重なった場合 どうなるのでしょうか? 一番気がかりなのはバックアップしたデータに不整合が 発生しないかという点です。
ＷＥＢサーバにクライアントマシンから１Ｋ以上の長文ＳＱＬを送信し、ＷＥＢサーバからデータベースサーバにアクセスしてＳＱＬを実行しデータを取得したいと思います。 ＷＥＢサーバが１Ｋを超える長文ＳＱＬを受信することができません。 何が悪いのかわかりません。 ＷＥＢサーバがＳＱＬ文を受け、そこからＤＢサーバにアクセスする構造は変えたくありません。何かよい方法があれば教えてください。 お願い致します。
Access超初心者です。 クエリで悩んでいるので、お教えください。 テーブル１に CODE(商品ID)_NAME(名前)_SUU(数量)_DAY(日付)の４項目があり、 クエリを使って、最も大きいSUUを抽出したい （かつ最も大きいSUUのデータが重複している場合、その中で最も古い日付のデータのみを抽出したい）のですが・・・ たとえば、 テーブル内容： CODE(商品ID)_NAME(名前)_SUU(数量)_DAY(日付) A_あめ_600_0517 A_あめ_900_0518 A_あめ_400_0618 B_ガム_120_0217 B_ガム_060_0319 B_ガム_180_0718 B_ガム_180_0518 抽出結果： A_あめ_900_0518 B_ガム_180_0518 ということです。 デザインビューを使うとして、どのような方法がありますでしょうか？ どうかご教授お願いします！
こんにちわ。 SQLServer2005を使ったデータベースサーバを構築しようとしているのですが、データベースの領域をサイジングする際にXML型のカラム定義がどれくらい必要なのかわからなくて困っています。（データベース設計書が書けなくて困ってしまいました） MSDN等では最大2GBまで確保可能とは定義されていますが、これだとnvarcharと同じ感じで定義することになると思うのですが（そうだとすると、１レコード64KB超えは確実なので、大量のレコード確保は難しく感じます）。 普通にnvarcharと同じ要領でXMLインスタンスの実バイト数を定義してしまえばよいのか、それともint型のように特定のバイト数が定まっているのか、それともXML型でのデータベース定義はまったく別のアプローチをする必要があるのかみなさまのお知恵をお借りしたいと思います。 よろしくお願いします。
アクセスで仕入れの入力をしています 商品テーブルに単価を入力していて 商品の入力には困らないのですが 支払とか値引等その時々に数値が 変わるものはどうしたらよいでしょうか
SQL Server 2005にて、レプリケーションの設定を行っています。 そこで、マッピング？で、列名を変更しつつ、複製を行いたいのです。データは、そのまま複製し、列名の一部を変更したいのですが、可能でしょうか？？MSDNを見ても、見つけられませんでした。 列名は、キーになっているものも、なっていないものもあります。 何かご存知の方、よろしくお願いいたします。
助けてください。 大変あせっています。！ 今、開発真っ只中です。 パーティションで構成された[AAA]というテーブルが あります。 そこには200701～200710間での日付パーティションとなっています。 毎月指定日に各パーティションのデータを削除していくのですが その際、ファイルグループ・セカンダリファイルが存在するか 確認し、1ヶ月の間に2回削除させないような仕組みを 考えています。 そこで、sp_helpfileとsp_helpfilegroupを使用して ファイルグループとセカンダリファイルが存在しているか どうかの判断を組み込んでいます。 が、この2つのSPは存在するときは情報を返してくれるのですが 存在しないときにはエラーとなってしまいます。 そうするとLogとして残っていしまうためNGとなってしまいました。 どなたか、こんな場合に使用するSPもしくは仕組みをご存知でしたら 馬鹿な私に教えてください。 ----- プログラミング EXECUTE @ret1 = sp_helpfilegroup FG_200701 EXECUTE @ret1 = sp_helpfile FILE_200701 ↑ 上記プログラムを実行すると存在している場合はメッセージに ファイル情報が表示されます。 存在しない場合はファイルグループに含まれないというエラー メッセージが出てきてします。 ------ 環境 OS:Windows2003 EE DB:SQLServer2005 EE HD:300GB 以上です。なにとぞよろしくお願いします。
SQLServer2005を使用していく予定です。 ほぼ初心者に近いです。 普通に作業するための基本的なことが知りたいです。 どこか良いHPなど合わせて教えてもらえると助かります。 宜しくお願いします。 【知りたいこと】 ・少量のテストデータをExcelから簡単にINSERTする方法(一般的にみんながやっている方法) ・大量のテストデータを簡単にINSERTする方法 ・データを手で修正する方法→クエリアナライザで操作するのが一般的？ ・一般的にデータ参照はクエリアナライザを使用しますか？他に良いツールはありますか？ など
いつもお世話になっております。 SQL Server 2005 Expressを使用しておりまして、C#で作成されているアプリケーションからシャットダウンしております。 またそのアプリケーションには、 『ExitWindowsEx(ExitWindowExFlags.EWX_REBOOT | ExitWindowExFlags.EWX_FORCE, 0);』 とありまして、 強制的にシャットダウンしてします。 そこで、大変お手数ですが、『強制的にSQLServerをシャットダウンした場合』どのようなプロセスで終了しているのか ご教示いただけないでしょうか。 参考になるURLでも大変助かります。よろしくお願いいたします。
SQLServer2005のストアドプロシージャで、引数に８桁日付（YYYYMMDD）を受け取り、その１ヶ月前の日付を求めたいのですが、 どのようにすればいいですか？ (1)DateAdd関数を使用するために、８桁日付を日付形式に変換する。CONVERT関数使用？ (2)(1)で求めた日付形式データでDateAddする。 といった流れだとは思うのですが、実際コードではどう書くのかわかりません。 よろしくお願いします。
SQLServer2005サービス→SQLServer2005(SQLEXPRESS)の状態を開始したいのですが・・・「要求が失敗したか、サービスが適切な時間内に応答しませんでした。詳細については、イベントログまたは他の適切なエラーログを参照してください。」と出るのですが、どうしたら開始に出来るのか分かりましたら、お教えいただきたいのですが、宜しくお願いいたします。
２つのテーブルからデータを取得したいです。 結合し、データの取得を試みてますが、キーに対して空白の行が取得できません。どうしたらよいでしょうか？助けてください。 Aテーブル　　　Bテーブル 1 100 A 　　　 　 1 みかん 2 150 B 　　　　　 2 りんご 4 200 D 　　　　　 3 すいか 5 300 E 　　　 　 4 なし 6 500 F 　　　 　 6 高級なし 上記のようなテーブルをくっつける時の話で求める値は以下なんですが… Cテーブル 1　 100 　A 　みかん 2 　150 　B 　りんご 3 　　　　　 すいか 4　 200 　D 　なし 5 　300　 E 6　 500 　F　 高級なし どちらかがデータなしでもキー（例の場合は1とかの数字です）があるもの は表示したいです。 どなたかわかるかた教えてください。お願いします。 ちなみに使用しているのはoracleです。
SQLで、 　desc table1 と入力するとテーブルの項目名、NOT NULLの有無、型を表示させることができますが、 同じような表示形式で主キーかどうかを確認することはできますか？ ご存知の人がいましたら教えてください。
お世話になっております。 現在、SQLServer2000(SP4)を使用しています。 次の結果を求めるSQL文を作りたいのですが、中々上手く行きません。 良い方法を教えて下さい。 あるテーブル（tableA）にレコードが以下のようにあるとします。 【基本コード】【大分類】【中分類】 　　　1　　　　　　1　　　　3 　　　1　　　　　　1　　　　4 　　　1　　　　　　2　　　　1 　　　2　　　　　　1　　　　99 　　　2　　　　　　18　　　 1 　　　3　　　　　　3　　　　2 やりたい事は、【基本コード】毎に、【大分類】【中分類】の最小値を取得したいので、下記の結果を得たいのですが、 期待する結果↓ 【基本コード】【大分類】【中分類】 　　　1　　　　　　1　　　　3 　　　2　　　　　　1　　　　99 　　　3　　　　　　3　　　　2 現在考えているSQL文では、下記のようになってしまいます。 実際の結果↓ 【基本コード】【大分類】【中分類】 　　　1　　　　　1　　　　　3 　　　2　　　　　1　　　　　3 　　　3　　　　　3　　　　　3 現在考えているSQL文↓ SELECT 　基本コード, 　MIN(大分類) AS 大分類, 　(SELECT MIN(中分類) FROM tableA WHERE 大分類 = (SELECT MIN(大分類) FROM tableA) GROUP BY 大分類) AS 中分類 FROM tableA GROUP BY 基本コード 中分類を求める場合の、大分類の指定の仕方が悪いのはわかるのですが、どう直したら良いのか分からず困っています。 宜しくお願いします。
お知恵をお持ちの方、本当に助けてください。 実は今仕事で「SQLServer2005 EnterpriseEdition」を 使用しています。 その中で、 「ALTER DATABASE dbname ADD FILEGROUP FG_DATE01」 というようなトランザクションがあります。この「FG_DATE01」を つきが変わるごとに「FG_DATE02」のようにどんどん追加していく 用にSPを作成したいのですが問題が発生してしまいました。 「ALTER DATABASE dbname ADD FILEGROUP @sFG_NAME」 のように変数を設定すると・・・ 「メッセージ 102、レベル 15、状態 1、行 2 '@sFG_NAME' 付近に不適切な構文があります。」 とエラー文が吐き出されてしまいます。 もしかして、トランザクションALTERには変数の 設定ができないのでしょうか？ そこがネックで大変困っています。 どなたか、お知恵をお貸しください。 実行環境 OS：WindowsXP DB：SQLServer2005 EnterpriseEdition CPU:Pen4 2.4GHz Mem：1GB HDD:120GB 以上です。本当に宜しくお願いします。
インストールを何回も試みてはいるもののうまくいきません。 "setup has detected a problem with Microsoft .Net farmework installation & cannot proceed. Microsoft .Net farmework 2.0 is either not installed on the system or is corrupt." というメッセージが出て先に進めません。 以前に、いくつかv.1.0.3705, v.1.1.4322などのインストールをしていたのをすっかり忘れていて、インストールしてしまいました。 関連のフォルダーも消してみたのですがだめです。 皆さまのアドバイスをお願いします。
SQLServer2005メンテナンスプランについての質問です。 メンテナンスプラン・ウィザードでメンテナンスプランを作成し、 「データベースの圧縮」と「履歴のクリーンアップ」の間に 「T-SQLステートメントの実行タスク」をツールボックスより マニュアル追加しステートメントに 　USE ["Db名"] 　GO 　DBCC SHRINKFILE(N'"Db名"_log' , 0, TRUNCATEONLY) を記述し上記前後タスクと接続(完了)しました。 　1「データベースの整合性」 　2「データベースのバックアップ(完全)」 　3「データベースのバックアップ(トランザクションログ)」 　4「データベースの圧縮」 　5「T-SQLステートメントの実行タスク」※トランザクションログの圧縮、マニュアル追加 　6「履歴のクリンーアップ」 　7「メンテナンスクリーンアップタスク」※マニュアル追加 メンテナンスプランの実行履歴を確認すると5と7の履歴が存在しません。 また、Windowsの「コンピュータの管理」より 　「システムツール」→「イベントビューア」→「アプリケーション」 でログを確認すると5以降は実行された結果が残っていません。 実際には、トランザクションログ・ファイルは「バックアアップ」されて「圧縮」が されているようです。 なぜログが残らないのでしょうか？ まだ、設定が足らないのでしょうか？ 宜しくご教授願います。 以上
ＳＱＬについての質問です。 同じテーブル内の各ＣＤ、ＤＡＴＥごとの １番目レコードの抽出方法がわかりません。 （ＣＤ、ＤＡＴＥでソート） テーブル名：TMP ＣＤ ＤＡＴＥ ＫＩＮ 1　2007/09/01 5555 1 2007/09/01 2000 1 2007/09/01 3000 2　2007/09/05 2222 2 2007/09/05 3333 3 2007/09/10 9999 抽出結果（ＣＤ、ＤＡＴＥでソート） 1　2007/09/01 5555 2　2007/09/05 2222 3 2007/09/10 9999 どのようにすると抽出できるのでしょうか？ よろしくお願いいたします。
Select文の結果から、 どこかにNULLを含む場合には除外したいのですが、 表示項目が多い為、「WHERE A IS NOT NULL」 というようにWHERE文を羅列すると、 項目の文だけ記述しなければならず、 結果表示に時間がかかってしまいます。 どなたか効率良くNULLを含む場合は除外する方法を ご存知の方は、ご教授宜しくお願い致します。
Visual Studio 2005 の Windowsアプリケーションプロジェクトにて SQL Server 2005 Compact Edition のデータベースにアクセスする方法 を調査しておりますが、実現できるかも含めてわかっておりません。 デバイスアプリケーションプロジェクトの場合は、 参照の追加でSystem.Data.SqlServerCeを追加すれば アクセスできる事はわかっております。 やりたいこと 1.WindowsXP上で***.SDFファイルを新規作成 2.作成した***.SDFに新規テーブルを作成 3.CSVファイルのデータを***.SDFへ登録 参考になるサイト・ヘルプ等ご存じの方がいらっしゃいましたら、 教えて頂けないでしょうか？宜しくお願いします。
shop1テーブルに存在して、shop2テーブルに存在しないレコードを抽出させたいのですが、 どのようにSQLを書けば良いのでしょうか？ よく知らないのですが、SQLでは結合？というジャンルの手法ですか？ shop1テーブル nama num みかん 10 りんご 20 なし 30 いちご 50 shop2テーブル name num みかん 55 りんご 44 なし 33
SQLServer2005で、ユーザーのデータベースロールメンバシップ（db_datareader、db_datawriter等のexec sp_helploginsで取得できる情報）をカタログビューを読むことで取得可能でしょうか。 （ユーザー一覧はsysusersを読み取っています）
SQLServer2005で、レプリケーションの設定を行いました。順調に動いております。今回、さらにVisual Studio(VB.NET)のプログラムにて、レプリケーションを動かしたく、いろいろ調べているところです。 マイクロソフトのサポートを見たところ、RMOなるものを使用すればよいとのこと。サンプルプログラムもあったので、みていましたが、C#のものしかありませんでした。VB.NETにて、レプリケーションを作成された方いらっしゃいますか？？参考になるサイト、プログラムなど教えていただけないでしょうか？？
SQLServer２００５（standard Edition)についてですが、 現在、DBサーバー、NASサーバー、ストレージの３台構成になっています。 DBサーバーにSQLServerをインストールしてあるのですが、 ここから、NASサーバーに接続されている ストレージに対して、テーブル作成をする際に、DBファイルの保存を行いたいのです （ネットワークドライブへの保存） OSはWindoｗｓ　Server 2003 です。 テーブルを作成する際に、 パスの指定を \\NASサーバー名\DATA などのようにしているのですが、 エラーが出てしまいます。 （ネットワークパスはデータベースファイルでサポートされません等） どなたかご教授願います。
ご覧頂いた方、ありがとうございます。 表記の件で、困っております。 OS:Windows 2003 Server(32bit) SP2適応 DB:MS SQL Server 2005 Enterprise Edition 180日間 限定評価版(32bit) OSインストール→SP2適応後、 MS SQL Serverをインストールしましたが、 「SQL Server Management Studio」がインストールできません。 何度かSetup.exeを実行しているのですが、 一向にインストールされる気配がありません。 自分なりにいろいろと調べましたが、 次期DBが評価されている昨今、 このVerの情報がほとんど見つけられません。 (VisualStudio2005Express(VS)をインストール後に、 本DBをインストールすると同じような現象が発生するらしいですが、 VSはインストールしておりません。) 以上お忙しい所、申し訳ございませんが、 対処法をご存知の方、是非ご教授下さい。お願い致します。 追伸： インストール時にマシン構成をチェックする箇所があると思いますが、 若干スペックが足りなく、警告がでます。(メモリ) 因果関係は不明ですが、追記します。
SQLServer2000であるテーブルを作成し、BegTimという日付項目を作ったのですが、 この項目の時間部分のみを指定して取得することは出来るのでしょうか？ 例 Code BegTim 0001 2007/09/09 10:00 0002 2007/09/10 10:45 0003 2007/09/10 11:00 テーブル内が↑の状態で11時のみを指定するとコード0001,0002のレコードのみ取得する条件の書き方を知りたいですが、調べ方が悪いのか分かりませんでした。 分かる方ご回答お願い致します。
SQL Serverそのものに関する質問ではありません。ご容赦ください。 SQL Server 2005 Compact Edition [ENU]は、[Windows デスクトップ サーチ]とともにインストールされるもののようですが、[Windows デスクトップ サーチ]が不要の場合、[Windows デスクトップ サーチ]とともにアンインストールしても構わないのでしょうか？。 ご存知でしたら教えてください。
2つのテーブルを結合（INNER　JOIN）して、ある列の最大値を取得する方法を教えてください。 例えば、 出荷ファイルと出荷明細ファイルの2テーブルで、出荷日の列をキーとして結合します。 この2テーブルで出荷番号という列の最大値を取得したいのです。 具体例では、 出荷日が2テーブルとも8/6があるとして、 出荷ファイル.出荷番号　の最大値が”5”で、 出荷明細ファイル.出荷番号の最大値が”6”の場合、 結果として、”6”を取得できれば良いのです。 よろしくお願いします。
タイトルの通り、execの結果をoutputパラメータに持たせたいのですが、 どうすればご存知の方、ご教授お願いします。以下のように、count(*)の結果を持たせたいです。以下にサンプルコードを記載しました。 ---ストアドabc--- ( @aWork int output, @bWork int output, @cWork int output, @IDs varchar ) declare @Sql1 varchar(500) declare @Sql2 varchar(500) declare @Sql3 varchar(500) declare @IDs varchar(500) set = '1,2,3' set @Sql1 = 'select count(*) from a where id = ' + IDs -- @aWork = exec(@Sql1)としたい exec(@Sql1) set @Sql2 = 'select count(*) from b where id = ' + IDs -- @bWork = exec(@Sql2)としたい exec(@Sql2) set @Sql3 = 'select count(*) from c where id = ' + IDs -- @cWork = exec(@Sql3)としたい exec(@Sql3)
あるテーブル（ここではTESTというテーブルとします）の重複レコードを削除したいので、以下のようなストアド・プロシージャを作成しました。 SELET DISTINCT * INTO TEST2 FROM TEST DELETE FROM TEST SELECT * INTO TEST FROM TEST2 DROP TABLE TEST2 開発終了後、システムの都合上、テーブルの追加はできないことが発覚し、TESTテーブル上で重複レコードを削除しなくてはならなくなりました。 カーソル等を利用すれば重複削除できると思いますが、ほかにシンプルな方法で重複レコードを削除する方法はありませんか？
SQL Server2000を使用しているのですが、バッチでデータベース保守計画を作成することは可能でしょうか？ ちなみに対象DB、スケジュール等の設定も行う想定です。 ご存知の方がいましたら、ご教授下さい。よろしくお願いします。
office access2007のSQLで検索プログラムを作っています． あるフォームのテキストボックスから日付を引いてきて， 別のテーブル内の備考欄からその日付が含まれるデータを 抽出したいと思っています． ((マスタ.BIKOU)like'*2006/03/15*')) のように特定の日付を入れるとうまく抽出するのですが， ((マスタ.BIKOU)like'*Forms!確認日!確認日*')) とすると，該当のものが無いように処理されます． ワイルドカードの中に別のテーブルやフォームのテキストなどを 引いてくることはできないのでしょうか． ご存知の方，ご教授下さい． よろしくお願いいたします． 説明不足でしたら，連絡ください．
inの中の値を変数に持たせ、実行したいのですが方法がわかりません。 以下に、問題となっているsqlを記載しました。 aテーブルのIDはsmallint型で、varchar型等への型変更不可とします。 cast(ID as varchar(100)) in (@ID)　等も試してみたのですが、 '1,2,3'をin内の１データとみなしてしまっているようで、正しい結果を 返してくれませんでした。 declare @ID varchar(100) set @ID = '1,2,3' SELECT * FROM a WHEREID in (@ID)
今データベースについて調べているのですが、ご助力をお願いします。 DBMSの中でも比較的有名な MySQL,PostgreSQL,Microsoft Access,Microsft SQL Server,Oracle の５つについて特徴や長所、短所を調べているのですが、いまひとつバージョンによっての特徴とかばかりが引っかかります。 ちょっと多くて申し訳ないのですが、どれかひとつでもかまいませんので教えていただけないでしょうか？ 簡単な説明で結構です。 よろしくお願いします。
【表Ａ】 列1　| 列2　 ----------- 山田 | A 山田 | A 田中 | A 田中 | B 田中 | C 木村 | A 木村 | A 木村 | B 上記で列1・列2をグループ化した件数を求めたいのですが、Oracleだと 　　SELECT COUNT(*) FROM (SELECT 列1,列2 FROM 表Ａ GROUP BY 列1,列2) というSQL文で結果「6」が出力されますが、SQLServerではエラーとなってしまいます。 SQLServerで実現したい場合はどのように記述すればよろしいでしょうか？
あるPCに入っているデータベースを、LANで繋がっている他のPCのSQLserverに一括コピーしたいのですが、そんな事できるのでしょうか？ちなみに環境は SQLServer2000(２台とも) WindowXPPro です。 よろしくお願い致します。
SQL Server2005 から SQL Server7.0 SP4 へレプリケーションを設定したいと思うのですが、上手くできません。 パブリケーション：SQL Server 2005 ディストリビューション：SQL Server 2005 サブスクリプション：SQL Server 7.0 SP4 自動起動 文献を調べると、ストアドを実行すれば設定できるようですが、 どのストアドを実行すればよいのかわかりません。 ご存知の方、そのストアドと引数をお教えください。 またアドバイス等ございましたらお教えいただきたくお願い致します。
Microsoft SQL Server Developer Edition 2005 について教えて頂きたいのですが、このエディションは機能的にエンタープライズエディションと同等と記述があるのですが、制約はどのような事になるのでしょうか？開発目的に使用する事が前提、とはありますが具体的な「これは出来ない」といった事を知りたいと思っています。よろしくお願いします。
OS:Vista SQL Version:Express SP2 AccessからのCreateTable、Manegement Studio Expressからの手動でのテーブルの新規作成がともにできません。 Manegement Studio Expressの起動時に管理者として実行すると作成が可能ですが、アプリケーションとしてユーザーに配布するため、ユーザーにその作業をお願いするのも難しい状態です。 まだサービスパックのあたっていないバージョンのときにもこの現象が出ましたが、どこかのサイトで（肝心のこのサイトを忘れてしまいました）SP2で解消という記載があったのでその認識でいたのですが、まだ解消されていないのでしょうか？
はじめて質問に投稿します。 SQLとAccessを使って、社内用のHPを作っています。 その中で、社内行事への参加・不参加のアンケート提出ページを作成しています。 提出は何度でも可能にするのですが、一度提出した人が複数回提出すると、最新の提出内容のみ表示させ、過去の提出内容はデータは残したまま非表示にするようにしたいのですが、どのようにSQL文を書いてよいのか分かりません。 提出内容は、「T_teishutu」というテーブルに格納するようにしています。このテーブルには、shainCD、oubotime、shukketu、delという項目があります。 主キーはshainCDにしています。 既に提出済みの社員から、また提出があった場合は、前回提出されたデータの項目「del」に、「del=-1」にすると、非表示になるようにしたいのですが・・・。 超初心者のため、質問の意味が分からなかったりするかもしれませんが、どうか皆さんの力を貸してください。よろしくお願いいたします。
MSDEをインストール後にパラメータを変更する方法を教えてください。 変更したいのは、disablenetworkprotocolというパラメータです。 よろしくお願いします。
SQLServer2005のオブジェクト・エクスプローラ上で、スクリプトを得たいストアドの上で右クリック→「名前を付けてストアドプロシージャをスクリプト化」を選択すると、さらにCreate,Alter,Dropなどに分かれて選択するようになってしまい、最初にDrop してからCreateするような、便利な1本のスクリプトが生成できません。 どこか別に、設定しておくべき箇所があるのでしょうか。あるいは別に、他の良い方法があるのでしょうか。
SQL2000サーバーの各テーブルの容量（～メガバイト等）を確認する方法は、タスクパッドから確認する以外にありますか？出来れば一度にすべてのテーブル容量を、一覧で取得出来るコマンドなどがあれば良いのですが・・・。
Access（SQL Serverのテーブルをリンクテーブルとして使用） でレコードを新規追加した直後に勝手に別のレコードに移動する現象が起きます。 親フォームに入力した後、サブフォームに入力しようとした際などにも勝手に移動してしまうので、まともに入力ができません。 ・追加自体は正常にされている。 ・フォームのレコードソース的にありえないレコードに移動することもある。（レコードソースが「SELECT * FROM Test WHERE Col1=1」なのに、勝手に移動して「Col1=1」以外のレコードが表示されたりする。 ・SQL Server のマージレプリケーションをやめるとこの現象は起きない。 ・SQL Server で新しいスナップショットを使って再同期させると必ずこの現象が発生するが、数日後には起きなくなる（全く起きなくなるかは不明。起きる確立はかなり減る）。 ・特定のPCだけで起こるわけではない。 ※マージレプリケーションの対象は、すべてのテーブルとビュー（インデックス付ビューも含む）です。 何かいい解決案はないでしょうか？ お願いいたします。 ▼サーバー OS：Windows Server 2003 R2 SP2 Enterprise DB：SQL Server 2005 Standard SP2 ▼クライアント Access 2003
SQLで、下記selectを行いたいです。 テーブルA テーブルB テーブルC これら三つのテーブルには、同一のコードが振られています。 この三つのテーブルのひとつにでも、抜けているコードを抜き出したいです。 （テーブルAのコード=テーブルBのコード=テーブルCのコードになっていないコード） 例） テーブルAに入ってるコード（1.3.5） テーブルBに入っているコード（1.4.5） テーブルCに入っているコード（1.5.6） このとき、三つのテーブルにきちんと入っているコードは、1と5だけなので、それ以外のコードを抜き出す→3.4.6 これをSQLで行う場合、簡単なSQL文はありますでしょうか？ 今、考えているのは、各テーブルすべてをinner joinしたviewを作成し（これにより三つとも入ってるコードの一覧ができる）、 そのviewと、テーブルA、テーブルB、テーブルCそれぞれをひとつづつleft joinして、不一致データを取り出す方法です。 でも、そうすると、viewを作成しなくてはいけず、また、SQLをテーブルの数分（今回は3回）投げなくてはいけなくて。。 もっと、単純にかけないものでしょうか？ ご存知の方、教えてください。
いつもお世話になっております。 SQL文のワイルドカードについての質問なのですが、 SELECT 項目１ FROM 表 WHERE 項目１ LIKE '%' というSQLがあったとして、私は項目１のレコードがすべて返されるのかと思いました。 しかしこれだと項目１フィールドにNULLが入っている（何もデータが入っていない）場合、それは除かれてしまうようです。 NULLのレコードも含めてクエリを返してくれるような条件はあるのでしょうか？
SQLServer2005のRESTOREについて質問させていただきます。 サーバー「A」にて取得したバックアップをサーバー「B」にリストアしたいのですが、リストアが完了すると該当「データベース」→セキュリティ→ユーザーにサーバー「A」で使用していたユーザーが登録されており、「セキュリティ」→「ログイン」に削除したいユーザーを追加することは可能なのですが権限等を与えることができません。 削除を実行すると「データベースプリンシパルは、データベースのスキーマを所有しているので、削除できません。」とエラーが発生し削除できません。 こちらとしてはサーバー「B」でもリストア時に作成されるユーザーにて接続可能にしたいのですがどのように対応すればよろしいでしょうか？ よろしくお願いいたします。
別カテゴリーでも質問しています。 VPNにしたらODBCがSqlServerを認識しません 皆さんよろしくお願いします。 現在、３施設を無線LANで１つのネットワークでオンラインを運用しています。 今度、施設を移動することとなり無線LANでは接続できなくなりました。 今回、VPN（フレッツグループ）で３施設をルータ（YAMAHA RT58i）で接続のテストしています。 ルーターの仕様で施設毎のネットワークとなり１つのネットワークが３つのネットワークになりました。 テストで各施設から別の施設のパソコンやサーバへPINGは飛び相手の共有ファイルもお互いに見れます。 しかし、サーバー以外の施設のパソコンでODBCがSqlServerを認識しなくなりました。 調べてみるとODBCの設定で接続するサーバーが出ません。 サーバー名を直接入力してもダメです。 クライアントの設定でTCP/IPでポートを1433に設定してもダメです。 そこで、ルーターのフィルター（ポート）を全て空けてやってみましたがダメでした。 これは、１つのネットワークが３つのネットワークとなりネットワーク越しのSqlServerの接続による問題の発生と思っています。 何度もNTTやYAMAHAのサポートに連絡してもどのようにしたらいいのか判らないとのことでした。 ODBCがSqlServerを認識するのにパソコンやサーバーにどのような設定が必要なのか教えてください。 よろしくお願いします 現在の構成：無線LANでの１つのネットワーク 施設１_サーバー：WinServer2003 SQLServer2000 パソコン：WinXP Pro 無線LANアクセスポイント１ IP：１０．１．１．１～５０ 施設２_無線LANアクセスポイント２ パソコン：WinXP Pro 無線LANアクセスポイント３ IP：１０．１．１．５１～９９ 施設２_無線LANアクセスポイント４ パソコン：WinXP Pro IP：１０．１．１．１００～１５０ 今回の構成：VPN（フレッツグループ ベーシック）での３つのネットワーク 施設１_サーバー：WinServer2003 SQLServer2000 パソコン：WinXP Pro VPNルータ１：YAMAHA RT58i（RT57iの後継機で機能は同じ） IP：１０．１．１．１～ 施設２_パソコン：WinXP Pro VPNルータ２：YAMAHA RT58i IP：１０．１．２．１～ 施設２_パソコン：WinXP Pro VPNルータ３：YAMAHA RT58i IP：１０．１．３．１～
現在、拠点には個々にACCESSを使用したデータベースで管理をし、 拠点は本社とリアルでは繋がっていない状態ですが、 近々VPN環境を整備する予定です。 業務管理システムを構築するにあたり、少々疑問が発生しましたので、 お分かりになる方に、是非ご教授願えればと思っております。 VPN環境は通常のLAN環境と同じような考え方でいいという事ですが、 実際には拠点から本社へのアクセスとなるわけで、タイムラグは発生しないのでしょうか？ データ検索や在庫データ更新等、タイムラグがあまりに発生するようであれば、 拠点ごとにACCESSのデータベースを置き、日次のデータをプールして、 1日1度の更新処理等をする、といった開発をした方がいいのか迷っています。 実際にVPN環境での経験が無いので、このあたり是非お分かりになる方のお話をお聞かせ下さい。
Access2003+SQLServer2005を使っています。 Accessのクエリでは勤続年数（2007年3月20日現在の勤続年数）を求めるのに以下を使っていました。 勤続年数: DateDiff("m",[入社年月日],#2007/03/20#)\12 & "年" & DateDiff("m",[入社年月日],#2007/03/20#) Mod 12 & "ヶ月" これを、ストアドプロシージャで行うにはどのように記述すればよいでしょうか？ よろしくお願いします。
SQL初心者です。な～んだこんな事くらいと言わず教えてください。 テーブルに A B C ------------ 5 a b 7 c d 4 a d 5 f b ------------ というデータがあります。 これを Bの列については、aとa以外 Cの列については、bとb以外 というようにグルーピングして、合計値を出したいと思っています。 結果として a b 5 a b以外 4 a以外 b 5 a以外 b以外 7 という形の出力イメージです。 調べてみてcase when文を使えばいいなんてことをなんとなく理解しているのですが、group byと組み合わせてどのようにSQL文を書けばいいかわかりません。 SQL Serverを使っています。ご存知の方、ご教授ください。
SQLサーバー２００５でdtexecコマンドを使って DTSパッケージを実行する方法について質問です。 SQLサーバー2000から移行したDTSパッケージを、 dtexec /DTS 「パッケージ名」 /SERVER 「サーバー名」　とコマンドラインから実行しましたが パスが無効です、というエラーになってしまいます。 SSISへ格納したパッケージを実行するには、引数/DTSの部分を どのように指定すればよいのでしょうか。
Visual Studio 2005 がインストールされていると、ExpressEdition入りませんか？ やりたいことは、Visual Studio 2005環境から、別マシンのSQL Server へ接続したいのですが、その別マシンにもVisual Studio 2005 がインストールされており、付属のSQL Server がインストールされています。 この状態で、セキュリティの設定を変更したのですが、SQL SERVER としてネットワーク越しに認識されませんでした。 Express Edition をインストールしたのですが、やはりネットワーク越しに認識されませんでした。 何がいけないのでしょう？
現在、SQL Server 6.5でデータベース管理、 VB6.0でシステム開発をしております。 SQL Serverを2005にした場合、 SQL文等の違い、注意すべき点はありますか？ 以前6.5を使用していて現在2005での管理をしておられる方、 その他お詳しい方、是非ご教授下さい。
現在WinXP上のVB6.0で開発した業務管理システムより、 WinNT上のSQLServer6.5で管理しているデータへアクセス、 命令によりデータ集計等を実行しています。 WindowsServer2003にSQLServer2005をのせての、 サーバー新設を検討中なのですが、 SQLServer2005のエディションの選択に迷っております。 下記の環境で最適なエディション、クライアント数を是非ご助言下さい！ ------------------------------------------------------------- （本社） サーバー：　Windows Server 2003(25CL)　+　Windows SQL Server 2005 PC：　WinXP　約10台　※業務管理システムをVB6.0にて開発 業務内容：　統括管理を行っており、売上データ集計や顧客データ管理 ------------------------------------------------------------- （支局） 全6拠点　 PC：　WinXP　各拠点1～2台（全拠点合計7台） 業務内容：　商品売上、顧客データ検索・回覧 ------------------------------------------------------------- ※本社と支局はインターネットVPNにてネットワーク構築も同時に考えております。
ＳＱＬ初心者です。 ちょっとＳＱＬの作り方で詰まったしまったので、アドバイスいただければと考えています。 月　　　名前　　　金額 2　　　Ａさん　　 15000 12　 Ｂさん 20000 1　　　 Ａさん 80000 2　　　 Ｅさん 14000 ・ 　・　　　　・ ・　　　 ・　　　　・ のようなテーブルから、月ごとに、誰がいくら使ったかを表示するクエリを作りたいのです。 各フィールドに月、各レコードに人を配置したいと思っています。 一応考えたＳＱＬが↓ SELECT DSUM([月],"テーブル名",月 = 1) AS 1月, DSUM([月],"テーブル名",月 = ) AS 2月,　・・・ AS 12月 FROM テーブル名 GROUP BY 名前 なのですが、かなり的外れかもしれません・・。 二つ（月と名前）の要素でグループ化するってのが難しいです。 アドバイスいただければと思います。
ＳＱＬの構文についての質問です。 あるテーブルからデータを取得する場合、 「SELECT 項目名１,項目名２・・ FROM テーブル名 WHERE 条件」 というＳＱＬ文となりますが、 項目名１,項目名２の部分を列番号を指定することによって 値を取得することは可能でしょうか？
SQL serverの勉強をしたいと思ってます。 無料のSQL serverではmsde2000とSQL Server 2005 Express Editionがあるようですが、どちらを入れたほうがいいのかわかりません。 勉強用にはどちらがお勧めでしょうか？ また、この２つに大きな違いなどがあれば教えていただきたいです。 よろしくお願いします。
SQLServer2005のストアドプロシージャでXMLファイルを読込む方法を教えてください。
２つのテーブルをリレーションシップ設定することによって、レコードの更新は出来るのですがレコードの追加が出来ません。ＯＤＢＣ経由でＡＣＣＥＳＳ２０００へ２つのテーブルをアタッチして操作しています。 レコードの追加は出来ないのでしょうか？よろしくお願いします。 サーバ：W2000SEREVER_SP4 SQL Server 2005 Enterprise Edition クライアント：W2000PRO_SP4 ACCESS2000_SP3
nvarchar型で文字列幅を(255)と指定したテーブルに、指定幅を越えた文字列にてクエリを送った場合に、エラーがはきだされると思ったのですが、 なぜか吐き出されません。 超過していた文字列が黙って切り捨てられた文字列で、insertが完了します。 エラーをだしたいのですが、そもそもエラーをなくすような設定があるのでしょうか？
SQL SERVER には、接続数=0で無制限接続ができるのですが、 購入しているライセンス(CAL)とはリンクしていないのですか。 CALとは契約上のもので、 実際DBで接続数に制限がかかるというものではないのでしょうか。
お世話になります。 環境は以下の通りです。 os：XP Professional sp2 sqlserver：2005 Developer Edition 突然ですが、ストアドで印刷は実現できるのでしょうか？ ストアドからバッチを起動して印刷するのではなく、 ストアド内部で、プリンタを指定し、直接印刷する。 というような方法がありましたら教えてください。 そんなものないよという場合も教えて頂ければ幸いです。 よろしくお願いします。
いつもお世話になっております。 ＳＱＬ初心者なのですが、分からず詰まっているところがあります。 たとえ話になってしまいますが・・ [月]フィールドに数値が入っていて（1～１２）それを表示するときに１月、２月というように"月"を後ろにつけたいのですが、その方法が分かりません。 アクセスの方が馴染みがあるのでクエリでやってみたところ SELECT [月] & "月" FROM AS 式1 月表; という風に出てきました。 かといって、 Dim SQL As String SQL = "SELECT [月] & "月" FROM AS 式1 月表" とはできませんし、 SQL = "SELECT [月] & "月" & " FROM AS 式1 月表" としても、オープンできません。 文全体が文字列の中に入っているので、その中でさらに任意の文字を足す（"月")というのが分かりません。 詳しい方ご教授いただけるとうれしいです。
テーブルA 年齢,人数 20,15 21,11 22,26 .... 30,5 31,88 ... 60,5 上記テーブルAからのSQLで下記のデータが欲しいと思っております。 【欲しい結果】 年齢範囲,人数 20～24,50 25～29,33 30～34,199 ... ただし、 select '20～24'as 年齢範囲,count(*)as 人数 from テーブルA where 条件1 union select '25～29'as 年齢範囲,count(*)as 人数 from テーブルA where 条件2 union select '30～34'as 年齢範囲,count(*)as 人数 from テーブルA where 条件3 ... というSQLは使いたくないです。(テーブルAの記述が長めなので、同じものを複数記述したくないのです) また結果が 項目名：20～24,25～29,30～34,... レコード：50,33,199,... というのも遠慮したいです。 CASE文やsum、groupを使えば、できそうな気がするのですが、、、 ご教授お願い致します。
色々と検索したのですが、検索の仕方が下手なのか、 知りたい情報が得られませんでしたので質問させて頂きます。 SQLServer2005 CompactEditionのインストールされたPDAより、 SQLServer2005 ExpressEditionのインストールされたＰＣに接続し、 データを取得するのはライセンス違反となるのでしょうか？ PDAはネットワークに非接続でも使用したい為、 CompactEditionへExpressEditionより取得したデータを 保存したいと考えています。 SQLServer EverywhereEditionでは、SQLServer製品ファミリの 他Editionにアクセスするには、 クライアントアクセスのライセンスが別途必要との 情報を見つけたのですが、CmpactEditionも同様でしょうか？ よろしくお願いします。
AファイルとBファイルを電話番号で関連づけして関連づけされたＢファイルのレコードを削除したいのですがACCESSのクエリ削除ではどうすればよいのでしょうか。AとＢは1対１の関係です。 宜しくおねがいします。
Win2003Server SQLServer2005 マージレプリケーションで構成されたあるテーブルに 一括でデータを挿入しようとしてエラーが発生しています。 テーブルの１つの列がIDENTITYが設定されており、 この範囲を超えたからという理由らしいのですが・・・ この範囲以上の行を一括挿入するにはどのように 設定を変更すれば良いでしょうか？ ※sp_changemargearticleで変更するのかな？とは思ったのですが、 　パラメータに何を指定して良いかが分からず ※必要な情報があれば、補足等に随時書込みさせていただきます。
よろしくお願いします。 SQLServer2005についての質問です。 (OS：Windows Server 2003 SP1) サーバが２台あり、どちらにもSQL Server 2005 がインストールされ ています。一方のサーバ(サーバA)に存在するテーブルを他方の サーバ(サーバB)からTSQLで参照するにはどのようにすれば良い でしょうか？ 各サーバで必要な設定と、実行するTSQLのイメージを教えてください。 基本的なことかもしれませんが、調べてもさっぱり判らず困っています。 (sqlcmdを使うようだというところはなんとなく判りました) どうぞよろしくお願い致します。
現在PDA（スマートフォン）によるアプリケーション開発に携わっています。PDAを用いて不特定多数に対し街頭調査をし、膨大ととなった情報をうまくまとめられたらと思い、Visual Studio 2005でソフトウェアを構築しています。しかし、プログラミングは初心者なので進行は遅いです。データを格納するデータベースとしてSQL Server 2005 Compact Editionの存在を知り、今はその勉強中です。しかし、なかなか良い参考書が見つかりません。MSDNのホームページを探していますが、うまく見つけられませんでした。 SQL Server 2005 Compact Editionを利用したPDAのプログラミングについて何か知っている方がいらっしゃいましたら、教えていただけると幸いです。
初心者のため、初歩的な質問か判りませんが宜しくお願いします。 datetime型のフィールドに下記のようにまちまちの年月日、時間のデーターが入っているのですが、年月日は無視して、時間だけでソートを したいのです。 例えば下記のようなデータがあるとして 1998/3/21 15:12 2007/5/5 12:00 1980/1/1 8:00 これを普通に並べ替える(order by フィールド名 asc)と下記のようになるのですが 1980/1/1 8:00 1998/3/21 15:12 2007/5/5 12:00 これを年代は関係なく時間だけで、下記のように並べ替えたいのです 。 1980/1/1 8:00 2007/5/5 12:00 1998/3/21 15:12 どうすれば良いのか、教えて頂けないでしょうか？
現在、SQLServer7(WinNT)とSQLServer2000(Win2003Sv)の二台の サーバを管理しています。 このSv7側の特定の表領域を定期的にSv2k側にコピーしたいと 考えていますが、スケジュールタスクへの登録で躓いています。 DTSパッケージの作成自体はうまくいき、EnterpriseManagerから、 手動で実行する分にはきちんと動作するのですが、これを スケジュールタスクとして実行させることができていません。 エラー内容は、 「エラー文字列 : [SQL-DMO]'(Sv7Name).(対象表領域名).LOG' での CreateFile エラーです。 アクセスが拒否されました。」 となっています。 エラー内容からすると、実行アカウントの権限によるものと 思われるのですが、この場合、どのアカウントの設定を直せば 動作するでしょうか。 なお、NTサーバは、シングルサーバとして構築しており、 ドメインには参加していない状態となっています。 よろしくお願いします。
副問合せをいれたINSERT文で、問合せ結果が無い場合 環境はSQL Server2005です。 テーブルA,テーブルBが存在し、テーブルAにレコード追加する際に一部をテーブルBから抽出して、 INSERTしようとしています。 [SQL文] 　INSERT INTO テーブルA(フィールド1, フィールド2, フィールド3,フィールド4・・・) 　　SELECT 'AAA', 'BBB' ,B.フィールド3, B.フィールド4 ・・・ 　　FROM テーブルB B WHERE ～ この場合、テーブルBにWHEREで指定した条件のレコードが存在しない場合はINSERTされなくなってしまいます。 存在しない場合は、該当のフィールドにはNULLをいれたいのですが、テーブルBからの結果が存在しない場合でも テーブルAにINSERTする方法はありますか？
下記のように項目がある場合、 where句の条件で年月の比較をどうすれば良いかわかりません。 年月日１(CHAR) 例:20070731 年月日２(SMALLDATETIME) where SUBSTRING(年月日１,1,4) = YEAR(年月日２) and SUBSTRING(年月日１,5,2) = MONTH(年月日２) と記述するとSUBSTRINGで取り出したデータは文字列、YEARで取り出したデータは数値、型が違うので比較してもダメでしょうか？ 初歩的な質問で申し訳ありませんが どうすれば良いか教えてください。
誤って物理的にLDF削除してしまった場合に、残っているMDFでなんとか再アタッチしてLDF作成したいのですが。 通常は、LDFが認識せず、アタッチ不可。 LDFファイルとMDFファイルの関連付けは、どのDBで管理されていますか？masterの中と思いますが。。。 この関連付けさえ、修正すればなんとか復旧可能になるものでしょうか？
現在使用している環境で、 SQLサーバー２０００上に、ログイン名が設定されていないデータベースユーザーが存在します。 ログインIDを設定せずに、データベースユーザーを作成する事が出来るのでしょうか？ 方法を検索しているのですが、私の力では見つける事が出来ません。 どなたかご助力頂ければと思い投稿させて頂きました。 使用環境は、下記のようになります。 ・　Windows２０００サーバー ・　SQL２０００サーバー　エンタープライズ版 以上、よろしくお願い致します。
静的SQL、動的SQLの違いって？ よくわからないので教えてください
SQL server 2000を使用しています。クエリアナライザから、あるユーザ定義関数を使用すると、処理時間が不必要にかかってしまっているので、なんとか処理速度を向上させたいのですが、解決方法が見出せません。ユーザ定義関数のロジックは最適なもので間違いは無い事を大前提として、処理速度を向上させたい場合の調査方法、および解決方法等をご教示頂ければ幸いです。どんな些細な事でも結構ですので、ご回答お願い致します。
日付の列に以下のようなデータがあり =============== 日付 char[14] =============== 20070722120000 20070722120010 20070722120020 20070722120030 20070722120040 20070722120050 　　　　・　　　 　　　　・　　　 20070722124350 20070722124420 20070722124430 20070722124440 20070722124450 20070722124510 このレコードを =============== 日付 char[14] =============== 20070722120000 20070722124420 20070722124510 分単位毎で秒の１番小さいレコードを取得したいと思っていますが、 どのようなSQLを作成したらよいのかわかりません。 初歩的なことかもしれませんが、よろしくお願いします。
ストアドの更新履歴情報を簡単に見る方法ご存知の方、教えて下さい。 SQLServer2005を使っています。(Editionは不明 > 何処から確認するかわからなかったため。express editionではないです。)
よろしくお願いします。 SQLServer2005についての質問です。 サーバＡ（ＤＢサーバ）、サーバＢ（ＤＢサーバ）が存在しています。 サーバＡとサーバＢのテーブルレイアウトを効率よく正確に 比較する方法を教えてください。 （差分を把握したい） どうぞよろしくお願い致します。
SQL-Serverについての質問です。 SQL-Server2005を利用しているのですが、 ストアドプロシージャから、そのサーバのSQL Server Agentサービスの稼動状況をチェックする方法はありますでしょうか？ sp_start_job等のアクションを伴うシステムストアドプロシージャを実行すれば、 Agentが起動していないというエラーは発生するのですが、 単純にAgentの稼動状態をチェックだけする方法がわかりません。 些細なことでも構いませんので、ヒントやきっかけとなる事がありましたら、ぜひご教示下さい。宜しくお願いいたします。
MSDEとSQLServerでReadOnlyのユーザを作成する方法を 教えてください。
SQL Server2000で下記のようなSQL文を書きたいと思っています。 テーブルAとテーブルAに無関係な２個のフィールドを 持つテーブルBがあり、テーブルAのデータをテーブルBにコピー したいと考えています。その際にテーブルBの2個のフィールドに対して 決められた値を挿入したいのですがどのように記述すればよいのか わかりません。 お分かりの方お教えいただけませんでしょうか よろしくお願いいたします。 下記の記述をしています。 INSERT INTO テーブルB ( A, B, C, D ) SELECT テーブルA.A, テーブルA.A, XXX1, XXX2 FROM reserveSETdateTRN; Cに東京 Dに品川 を入れたいと思っています
ディスク消費の策としてLDFログ圧縮・削除があると思いますが、最適化と何が違うのでしょうか？ ヘルプを読んでも、どうも良く判りません。（初心者なもんで。） 他の方法や、具体的な手順についても教えてください。
サーバ起動（SQLサーバサービス起動）後に、メモリ消費を監視していましたが、起動後にアプリケーション等の起動無しでも、メモリ消費が少しずつ進みますが、サーバ設定の影響でしょうか。0.3G程度は平気で消費されてしまうようです。（sqlsvrでの消費）
SQL2000を使用しています。(Transact-SQL？) 項目1・項目2・項目3には、それぞれ6桁固定の数字が入っているとします。 この3項目から重複無しの件数をカウントしたいのですが （Group byをして更に全体の件数を取得したい） select count(distinct 項目1+項目2+項目3) from テーブル名 という書き方でも問題ないでしょうか？ 他にもっとスマートな方法があれば教えて頂けませんか？
DELETEにてWHERE句の条件で数百万件のレコードを削除したいのですが、効率的な方法を教えてください。SQL初心者です。 LOGの肥大化や削除に非常に時間がかかるのを心配してます。
SQL Server2005のストアドプロシージャからsp_send_dbmailを使ってメール送信を行っているのですが、受信したメールの件名、本文が文字化して困っています。 多分、メールの文字コードがUNICODE（UTF-8）である為に文字化けがおきていると思います。 メール送信に必要なテーブルの属性をUnicode データ型のnchar、nvarchar、nvarchar(max) に変更し、ストアドプロシージャで文字列の操作の際にNのプリフィックスを付けてみましたがダメでした。 ベッキーやOutlook Expressなどでは自動的に文字コードが変換されるので、文字化が起こらないのですが、今回のシステムではノーツ又はサイボウズを使用することになっており、こちらでは文字化けおこしてしまいます。 環境ですが以下のとおりです。 ・SQL Server2005 ・データベースの照合順序はJapanese_CI_ASです。 ・WindowsXP どなたか文字化けをなくす方法をご存知の方、ご教授お願いします。 よろしくお願いします。
SSMSE（SQLServerManagementStudioExpress）を使用してクエリを作成し、問題なく結果が出ました。そのデータをエクセルなどで出力する方法はあるのでしょうか。現在はコピペでやっています。宜しくお願いいたします。
SQLのSELECTで困っています。 プロシージャに引数を渡してSELECTしようと考えています。 複数の日付(datetime)型の引数をand条件で結びたいです。 検索したくない場合はnullを渡す。 例） select A,B,C from XXX where A = '1' and (B = 引数 or 引数 is null) and (C = 引数 or 引数 is null) and (D = 引数 or 引数 is null) ===== B,C,D はdatetimeです。 この形ですと、B,C,D全ての引数に日付が入っていれば取得できる のですが一箇所でも引数に何もセットしないと値０件で帰ってきて しまいます。 せっかく（is　null）を使用しているのに意味がありません。 良いお知恵は無いでしょうか。 よろしくお願いします。
SQL文で成績と性別での人数分布を求めるクロス集計関数が出来ず困ってます。 サンプルとしては 学年　性別 評価(ABC) １年　男　　A １年　女　　A １年　男　　A １年　男　　B ２年　男　　B ２年　女　　C 欲しい出力としては各サンプル毎の人数です。 １年 男-A評価,男B評価,男C評価,女A評価,女B評価,女C評価 ２年 男-A評価,男B評価,男C評価,女A評価,女B評価,女C評価 ３年 男-A評価,男B評価,男C評価,女A評価,女B評価,女C評価 ・ ・ ・ という具合です。 以前は SELECT COUNT(*) AS 分布人数, 性別, 成績 FROM 成績 GROUP BY 年齢, 性別, 学年 HAVING 学年 = @がくねん ORDER BY 年齢,成績 というSQL文で１学年毎に抽出していました。 クロス集計で１つのSQL文で出力したいのですがいかがでしょうか？
長年マイクロソフトのAccessを使っていました。 最近マイクロソフトのSQL Server 2005を使うようになりましたが Accessにあった、重複キーの設定がわかりません。 どう設定すればできるのか教えて頂けませんでしょうか？ またはSQL Server 2005の方に重複キーといったものはないでしょうか？ よろしくお願い致します。
Windows2003+SQL-Server2005でシステムを構築しておりますが、トランザクションログの肥大化に悩んでおります。 ファイルサイズが80Gb（空き容量88%）のDataBseを完全Backupすると300Gbを超えるサイズとなってしまいます。 トランザクションファイルのサイズが300Gbを超えておりますので、これが原因だと考えておりますが、定期的にトランザクションのBackupを実施しても全く(トランザクションFの）空き容量が減りません。 復旧モードを単純に変更してみたのですが、状況は変わらずトランザクションファイルがじりじり肥大化しています。 他のDBとのレプリケーションを実施しており、パブリッシャ側でDBの再構築を実施すると一気にトランザクションのサイズが増加するので、レプリケーションの設定を見直しておりますが、問題点を発見する事ができない状態です。 レプリケーションを含めDB動作には全く問題がないのですが、このままの状態では遠からずDisk容量不足が発生してしまいます。 何かお心当たりがございましたら是非ご教授頂きたく、よろしくお願い致します。
システム開発を行なうために、Visual Studio 2005 Professional Editionを購入したのですが、その中に「SQL Server 2005 Developer Edition」というものが入っていました。 調べてみると、SQL Server 2005 Enterpise Editionと同等の機能をもっているらしいのですが、何故そんないいものが付いているのだろうと不思議に思っています ただ調べてみると、「開発者がテスト用に…」という記述があったので本番運用には使えないのでしょうか？ Developer Editionが何のためにあるのか教えていただけないでしょうか？
Windows2003Server SP1(32bit)に SQLServer 2005 Standard Edtionをインストールした後 SQLServer2005 SP1をインストールすると、 SQLServer Integration Servicesのアップグレード時に SP1が異常終了してしまいます。 原因が分からずに困っています。 順番は、SQLServer2005 Standard Edtionをインストールして、マシン再起動。 その後、MicroSoftのHPからD/Lした SQLServer2005SP1-KB913090-x86-JPN.exe　を実行しています。 ２回やって２回共に　SQLServer Integration Servicesのアップグレード時に 「HotFixエラー」とウインドウが出ます(アプリケーション異常終了時のもので「エラーの情報を送信する／しない」のボタンが出ます) その後もSP1は動き続けます。他のサービスは正常にアップグレードされます。 SQLServer2005 Standard EdtionをSP1にアップグレードされた方で 同一の現象になった方、おられましたら対応方法等ご教示いただけませんでしょうか？ また異常終了にならなかった方、そのSP1はどのようにして手に入れたもの(WindowsUpdateで当てた)でしょうか？ どうぞよろしくお願いいたします。
初めて、技術を勉強しますが 有名なサイトが教えてくれませんか よろしくお願いします
SQLServer2005(Express)をCドライブにインストールしたのですが、 容量が少ない為に別ドライブにデータベースファイルを 作成しようとするのですが、以下のようなメッセージが 表示され作成できません。 ※インストールディレクトリ配下のDataフォルダなら成功する。 恐らく権限の問題だと考えていますが、解決方法が 見つからない状態です。どなたかご存知の方がいらっしゃいましたら 教えて頂けないでしょうか。 エラーメッセージ： データベース'ddd'の作成に失敗しました ファイル"E:\SQLServer\data\ddd.mdf"は圧縮されていますが、 読み取り専用のデータベースまたはファイルグループでない 場所にあります。ファイルの圧縮を解除して下さい。 CREATE DATABASEが失敗しました。一覧されたファイル名の 一部を作成できませんでした。 関連するエラーを確認して下さい。(Microsoft SQL Server, Error: 5118)
PHP＋SQLサーバ2003でWEB作成をしています。 PHPでPOSTされた年月日をSQLサーバのカラム(smalldate型)に格納したいのですが、入力された通りにはDBに日付が格納されないのです。 例）2007/10/10 →　(DB)1905/06/14 ソースはこんな感じです。 //年、月、日と入力された値を"年/月/日"　の形にする $day = implode("/",array($_POST["year"],$_POST["month"],$_POST["day"])); //入力された日付をDBに格納する。 $sql = "insert into table_name(date) values($day)"; 根本的に何かが間違っていると思われるのですが、よくわかりません。 どなたかアドバイスお願いします。
GROUP BY句の使用方法について質問させて下さい。 ■使用するテーブル 　ＩＤ　　　日付 ---------------------- 　AAA　　　2007-04-01 　AAA　　　2007-04-01 　AAA　　　2007-04-02 　AAA　　　2007-04-03 　BBB　　　2007-04-01 　BBB　　　2007-04-03 　CCC　　　2007-04-02 　CCC　　　2007-04-02 　CCC　　　2007-04-02 ■抽出したいこと 　ＩＤ毎のカウントを取りたいのですが、その際に同じ日付は１回のカウントとして抽出したいのです。 　即ち、下記の結果を得るのが目的ですが、どのようなクエリとすればいいでしょうか？ 　ＩＤ　　cnout(*) ---------------------- 　AAA　　　3 　BBB　　　2 　CCC　　　1 初歩的な質問なのですが、宜しくお願い致します。 （※環境はSQL-Server2000です）
皆様のお知恵を拝借できればと思い、書き込みさせて頂きます。 現在、ＤＢマシン移行に伴い、バックアップファイル(20070625.bak)を新しいＤＢマシンに復元しようとしております。作業内容としては全てのタスク→データベースの復元とし、デバイスからバックアップファイルを指定しております。その結果エラーとなりエラーログを見ると下記メッセージが挙がっておりました。 BackupDiskFile::OpenMedia: バックアップ デバイス 'D:\sqlserver\MASTER.bak' を open にできませんでした。オペレーティング システム エラー = 5(アクセスが拒否されました。)。 この現象は何が原因なのでしょうか？ つたない文面でわかりづらいとは思いますが、宜しくお願い致します。
INT型の日付(20070621)をWHEREでその月の1日から末日までを指定したいのですが、どのようなSQLを書けばよいのでしょうか？ちなみに下記に私が書いたものを記載しますが、もっと効率のよい方法はないのでしょうか？ 1日を指定 day > { fn CONCAT({ fn CONCAT(LEFT(LEFT({ fn CURDATE()}, 7), 4), RIGHT(LEFT({ fn CURDATE() }, 7), 2)) }, '01') }) 末日の指定 day < { fn CONCAT({ fn CONCAT(RIGHT(LEFT(DATEADD(d,-1,{ fn CONCAT({ fn CONCAT(RIGHT(LEFT(DATEADD(m, 1, { fn CURDATE() }), 10), 4), LEFT(LEFT(DATEADD(m, 1, { fn CURDATE() }), 10), 2)) }, '01') }), 10), 4), LEFT(LEFT(DATEADD(d, - 1,{ fn CONCAT({ fn CONCAT(RIGHT(LEFT(DATEADD(m, 1, { fn CURDATE() }), 10),4), LEFT(LEFT(DATEADD(m, 1, { fn CURDATE() }), 10), 2)) }, '01') }), 10), 2)) }, RIGHT(LEFT(LEFT(DATEADD(d, - 1, { fn CONCAT({ fn CONCAT(RIGHT(LEFT(DATEADD(m, 1, { fn CURDATE() }), 10),4), LEFT(LEFT(DATEADD(m, 1, { fn CURDATE() }), 10), 2)) }, '01') }), 10), 5),
1-a,1-b,2-a,2-b,3-a,3-b,4-a,4-b,5-a,5-bというカラムがあるとき。 以下の条件を満たす行を抽出するのに、 検索速度の早いSQLの書き方はありますか？ （条件）N-aに値有りのとき、N-bは値有り 　ただし、1-aから5-a全て値なしのときは対象外 ※こんな書き方は思いつくのですが、遅そうで・・・ ( (1-a is not null AND 1-b is not null) or (2-a is not null AND 2-b is not null) or (3-a is not null AND 3-b is not null) or (4-a is not null AND 4-b is not null) or (5-a is not null AND 5-b is not null) ) and not(1-a is null AND 2-a is null AND 3-a is null AND 4-a is null AND 5-a is null)
二つのテーブルをマージした後に、時間毎の平均値を取得したいのですが SQLServerではどのように書けばよろしいでしょうか？ oracleだと↓こんな感じ select ti , avg(va) from ( select date as ti, value as va from test_table union all select date as ti, value as va from test1_table ) group by ti マージしたいテーブルを取得するSQL文をいじらずに実行できる方法を探しています。 以上、宜しくお願いします。
現在オービックの奉行シリーズのためSQLサーバがインストールされて います。 今回同じオービックのオービック７を導入予定です こちらはオラクル７で動くそうです これを同じサーバにインストールしたいのですが オービックの担当者は同一サーバにインストールできないって 言ってきます。理由はDBが違うからといってきます 新規にサーバを購入する予算はありません 別にオービック７をSQLサーバで動作させていって言っているのではあ りません 同居は無理なのでしょうか
SQLserver2000で、テーブルの列で定義したデータ型の変更方法を教えて下さい。 よろしくお願いします。
業務用アプリケーションをACCESSで運用していますが、 近々クライアント数が増えるのでACCESS＋MSDEでバージョンアップを試みているところです。 が、初心者なのでうまく出来ずエラーになり、どうして良いのか色々な書籍を見ているのですが、よくわかりません。 どなたか教えてください、よろしくお願いします。 開発環境 Win XP Home Edition SP2 Access 2002 MSDE2000A 旧業務用アプリケーション .mdbはテーブルとフォーム・レポート等は別々にして稼動時に.iniファイルでリンク 新業務用アプリケーション 1.旧業務用アプリケーション同様、.adpは分けました。 2.テーブルは新規に作成 3.フォーム・モジュールは旧よりインポート 　（テーブルリンク方法は旧と同じ）
accessユーザーです accessで以下のようにするとsqlserverのテーブルにupdateできるのですが DoCmd.RunSQL "DROP PROCEDURE [SP_旅行貯金へ給与追加]", -1 DoCmd.RunSQL "CREATE PROCEDURE [SP_旅行貯金へ給与追加] AS UPDATE dbo.共栄会旅行貯金 SET [" & 月日FLD & "] = '" & 月日指定 & "', [" & 控除額FILD & "] = 給与.旅行 FROM dbo.給与 INNER JOIN dbo.共栄会旅行貯金 ON dbo.給与.SNAM = dbo.共栄会旅行貯金.SNAM", -1 DoCmd.OpenStoredProcedure "SP_旅行貯金へ給与追加", acViewPreview, acEdit -------------------------------------------------------------- sqlserverで以下のようにパラメーター変数作成して実行しますとupdateできません フィールド名を@Mfld 変数および@KOUfld変数 にしているのですが無理があるのでしょうか CREATE PROCEDURE [dbo].[SP_旅行貯金へ給与追加] (@Mfld nvarchar(255), @Msitei nvarchar(255),@KOUfld nvarchar(255)) AS BEGIN UPDATE dbo.共栄会旅行貯金 SET @Mfld = @Msitei, @KOUfld = 給与.旅行 FROM dbo.給与 INNER JOIN dbo.共栄会旅行貯金 ON dbo.給与.SNAM = dbo.共栄会旅行貯金.SNAM END
データベースと連携したショッピングカートのウェブアプリを開発しようと思います。 自分は、今までウェブアプリを開発したことはなく、Access（VBA）とSQLServerによるデータベースシステムの開発経験しかありません。 VBの開発経験があるという事で、ASP.NETをVB.NETでプログラミングを考えましたが、VBとVB.NETは言語体系が異なるのと、またVB.NETが将来的に普及せず人気がなくなるか不安です・・・。 一番不安なのが、せっかく勉強して覚えた言語が、不安定だったり、あまり役に立たなかったり将来的に人気がなくなってしまう事です。 聞くところによると、JAVAとORACLEの組み合わせが定番というか需要が多いと聞きますがPHPもいいかなと思います。 以下の条件に当てはまるものでオススメの【開発言語】と【データベース】を教えてください。 ★OSはWINDOWS SERVERのみ。 ★開発言語は、とにかく将来的に人気がある言語がいいです。ただし、C言語は難しそうなので避けます。 ★データベースはSQL SERVERを使用。ただし、オラクルの方が将来性があってパフォーマンスもずっと良くて今後も人気があるということであればオラクルを選択します。 ★WEB SERVERはIISのみ。アパッチにGUIがあってマニュアル本も充実してて扱いが難しくないならアパッチを選択します。 また、VB2005というのは.NETの表示がありませんが、言語体系的にVB.NETの後継ではなくVB6の後継と考えていいのでしょうか？ よろしくお願いします。
こんにちは、よろしくお願いします。 VB2005+AccessでWindowsアプリをはじめて作りました。 このアプリはデータベースがAccessなのでスタンドアロン形式 として開発しました。（初めてのプログラミングです。） 次に、２～５台くらいまでのパソコンで使えるようなアプリを 開発したいと思っているのですが、 データベースに何を使ったら良いのかわかりません。 パソコンに、Microsoft SQL Server 2005がプログラムメニューに あるのですが、これが利用できるのでしょうか？ 利用できるのなら使いたいのですが、 色々と調べていたら、SQLServerの価格表があり、高いものは 300万とか書いてあり、びっくりしました。 上記を使うと開発者やユーザーに何か料金が必要なのでしょうか？ ExpressEditionは無料、とありましたが制約が多くて 使にくかったらどうしようかと思い、不安です。 Oracleも無料とありましたが、Windowsアプリに利用するにあたって 何も問題はないのでしょうか？ 経験者の方、おすすめデータベースのアドバイスがありましたらお願い致します。 参考サイトや書籍などの情報がありましたらあわせてお願い致します。
SQL ServerのテーブルデータをSELECTしてダブルコーテ区切りのCSVに出力したいと考えております。 ・batファイルからの起動を希望。 ・出力CSVファイル名はbatファイルより引数で指定したい。 ・出力後、DELETEも行いたい。 OracleだとSQL*Plus環境で下記のようにテキストレベルで簡単にできます。 SQL Serverでも同様のことができないでしょうか？ 要は下記をSQL Server版でやりたいということです。 参考:Oracleだと・・・ 同一dirに、abc.batとabc.sqlを用意しabc.batを実行すると20070601.csvが生成される。 1.abc.bat rem ----abc.bat-ここから---- sqlplus usr/pwd@host @abc.sql 20070601.csv rem ----abc.bat-ここまで---- 2.abc.sql ----ファイル名＝abc.sql-ここから--- set echo off set heading off SET VERIFY OFF set FEEDBACK OFF set TRIMSPOOL on set termout off set pagesize 0 set linesize 32767 spool &1 select '"'|| カラム1 ||'",'|| '"'|| カラム2 ||'",'|| '"'|| カラム3 ||'"' from テーブル1; spool off delete from テーブル1; exit ----ファイル名＝abc.sql-ここまで--- 20070601.csv結果 -ファイル名＝20070601.csv-ここから--- "20060726","scott","356160" "20060727","tiger","463391" "20060728","manager","1930" -ファイル名＝20070601.csv-ここまで--- DBサーバ環境 OS:Win2003SvrR2 SQL Serverバージョン:わかりません。(2003にのってるので最近のだと思われます) Oracle経験者でSQLServer初心者です。マニュアルもなく、Web検索しても「SQL」「Server」ってなかなかうまくひっかからない！！ ので質問あげさせていただきます。
皆様 御忙しいところすみません。 とても困っているので、ご存知でしたら教えてください。 SQLサーバーのジョブからVisualBasicスクリプトで作成したファイルを叩きたいのですが、 このようなことは出来ないのでしょうか？ ジョブのコマンド内に C:\～～～.vbs という風に書いてみたのですが、どうやらだめみたいなので。。。 ※～～～.vbsはファイル名です。 初心者丸出しの質問ですが、 よろしくお願いいたします。 以上です。
SqlServer2005で、操作ミスからビューをドロップしてしまいました。 バックアップはありません。 元に戻せますでしょうか？ よろしくお願いします。
2つのテーブル（A、B)を結合してデータを取得したいのですが、 TableBのキーの2文字目を無視して検索したいのです。 例） テーブルA テーブルB キー 値 キー 値 1001 1 1101 1 1002 2 1012 2 1003 3 1003 3 1004 4 1104 4 1202 5 1303 6 結果 キー　 A.値　　 B.値 1001 1 1 1002 2 5 1003 3 3 1003 3 6 1004 4 4 以下のSQL文を作ってみたのですが、 時間が非常にかかってしまうので よい方法を知りたく思っています。 SELECT A.キー, A.値, B.値 FROM テーブルA INNER JOIN テーブルB ON A.キー = LEFT(B.キー,1) + SUBSTRING(A.キー, 1, 1) + RIGHT(B.キー, LEN(B.キー) - 2) よろしくお願いします。
以下のプロシージャを exec 01,abc と実行します。 するとDBには、 column pc　＞＞　'01 ' column Filename ＞＞　'abc ' のように文字の後ろに空白文字列が複数入ってしまいます。 ですが、空白は取り除いた形でセットしたいです。 どのようにすれば、トリミングされた形でセットできるでしょうか？ 現状、わからないため、空白をを空文字にリプレイスして 対処しています。 ALTER PROCEDURE [dbo].[AddRecord]( @PC varchar(50), @Filename varchar(50) ) AS set @pc = Replace(@pc,' ',''); set @BaseFilename = Replace(@BaseFilename,' ',''); INSERT INTO tbl_1( PC , Filename ) VALUES ( @PC , @Filename)
SQL分でわからないことがあるので質問させてください。 Aというテーブルに、 番号と処理通番(ユニーク)の2つカラムがあります。 Aテーブルから重複した番号とその処理通番を 上から4件まで取得したいのですが、 ----------------------------- SELECT A.番号,A.処理通番 FROM A INNER JOIN (SELECT 番号 FROM A GROUP BY 番号 HAVING COUNT(*) > 1) AS B ON (A.番号 = B.番号) ORDER BY A.番号,A.処理通番 ----------------------------- のSQLでは重複した番号のデータを 全て取得してしまいます。 番号別に4件まで取得したいのですが、 どのようなSQLを書けば取得できますか？ よろしくお願いします。
データベースの３層構造の意味が良く分かりません・・・ 概念スキーマ・外部スキーマ・内部スキーマのそれぞれの 意味を分かりやすく教えてくださいませんでしょうか？ 宜しくお願い致します。 ちなみに、検索エンジンで自分なりに調べましたが、良く分からなかったので、質問させて頂きました。
MS SQL Server2003のsmalldatetime型のカラムへnull値を代入しようとすると、必ず、1999/01/01　の値が入っています。 明示的にnullを与えても同じ結果になります。 どうしたらnull値を代入できるのでしょうか。 もちろん、カラムはnull値を許す設定になっています。
初めましてm(__)m SQLを最近始めたばかりの為、次のような場合の抽出条件がわかりません。 どなたかご存知の方がいましたら、回答をよろしくお願いいたします。 次のようなDBがあったとします。 項目1　　項目2　　項目3 001　　　aaa　　　003 002　　　bbb　　　005 003　　　ccc　　　004 004　　　ddd　　　005 このDBに対し、検索条件を項目1=004とした場合に、次のように抽出したいのですが、どうすればよろしいですか？ 001　　　aaa　　　003 003　　　ccc　　　004 004　　　ddd　　　005 ※項目1の値が項目3と一致したらそのデータも抽出し、更にそのデータの項目1の値が項目3と一致したらそのデータも抽出するみたいにしたいと考えているのですが可能でしょうか？ 以上です。 分かる人がいましたら、よろしくお願いします。
SQL Server 2005 Expressを使って、テーブル(tbl出席簿）に格納され たデータのうち、今日よりも１ヶ月前のデータを表示するSQL文を教え てください。 因みにAccessでは SELECT tbl出席簿.名前,tbl出席簿.日付,Format([日付],"yyyy/mm/dd") AS １ヶ月前 FROM tbl出席簿 WHERE (((Format([日付],"yyyy/mm/dd"))=Format(DateAdd("m"-1,Date()),"yyyy/mm/dd"))); でOKなんですが、SQL Server 2005 Expressを使った方法がわかりませ ん。 どうか、御教示下さる様宜しくお願いいたします。
SQL SERVER2000とACCESS2000でデータベースシステムを運用しています。 アクセス上のあるコンボボックスのプロパティに 値集合ソースとして SELECT USR_BCD, CTM_CD, NAME_E FROM VT_CUSTOMER のようなＳＱＬ文を書いて使っています。 ところがこのようにコンボボックスを利用すると コンボボックスには10000件しか格納されません。 実際のデータは20000件以上あります。 どのようにすればこの上限値を突破できるのでしょうか？ お知恵を拝借させてください。 宜しくお願いいたします。
WindowsVistaのコマンドプロンプトからSQLEXPRESSをインストールしようと考えてるのですが、認証モードダイアログでのパスワードエディットボックスに 指定したパスワードが初期値としてセットされません。 どのようにしたら初期値としてセットされるのでしょうか？ N:\SQLEXPRESS\setup.exe INSTANCENAME=INSTANCE01 ADDLOCAL=SQL_Engine SECURITYMODE=SQL SAPWD=SAPWD001 で、行っています。 同様の内容で.iniファイルでの実行も行いましたがSAPWDのみ反映されませんでした。 ご存知の方がおられましたらご教授お願いします。
バッチファイルにて、 MSDEを停止 ↓ mdbとlogファイルをコピー ↓ MSDEを開始 という作業を行いたいのですが、 コマンドラインからMSDEを停止したり、開始したり 出来るコマンドご存知の方居ませんか？ 宜しくお願いします。
VisualStudio.Net 2005 SQL Server 2005 を使って、PDAにデータベースを閉じ込める方法を教えてください！！ PDAにデータベースを直接設置する方法です！！
伝票情報と明細情報をもつそれぞれのテーブルがあり両者は伝票No.で リンクされておりレコードは１：ｎの関係にあるとします。 任意の顧客で指定日付範囲の結合レコードを商品単位でグロス集計を して商品別の数量を求めたいのですが適当なSQL文が判らず困ってお ります。 下記は抽出のみのサンプルですがこれを上記のような結果に導くには どのようにすればよいかアドバイス願います。 select H.URH_DENNO, H.URH_KEJ_YMD, H.URH_TKI_CD, H.URH_TKI_MEI, H.URH_U_KINGAK, D.URD_DENNO, D.URD_GYO, D.URD_HIN_CD, D.URD_HIN_MEI, D.URD_BARA_SU, D.URD_UT_TANKA, D.URD_UT_KINGAK from HDT_URIHD H, HDT_URIDT D WHERE H.URH_TKI_CD = 9999 AND H.URH_DENNO = D.URD_DENNO AND H.URH_KEJ_YMD >= 20050601 AND H.URH_KEJ_YMD <= 20050630 ORDER BY H.URH_DENNO, D.URD_GYO
SQL Server 2005 EXPRESSを使って、 nvarchar型で作成されたyyyy/mm/ddの日付と datetime型で作成されたyyyy/mm/ddの日付を比較し WHERE '2007/05/04' > gettime()のようなSELECT文の WHERE句を使って該当レコードを表示することが可能であれば 教えてください。 以上、宜しくお願いします。
バッチファイルでTRUNCATE TABLEするにはどうしたら良いのでしょうか？ バッチファイルからSQL文を発行するやり方がわかりません。
同じテーブルの中にあるフィールドのデータをハイフンで結合して、 別のフィールドに登録したく思っています。 下記SQLを流すとエラーになります。 update TABLE1 T1 set T1.FIELD1 = T1.FIELD2 & '-' & T1.FIELD3 データベースはDB2です。 このようなやり方では出来ないのでしょうか？ ご教授賜りたく。
accessユーザーです sqlserverに組み替えているなかでaccessでは今までグループ集計をクエリーで作成していました select first(フィールド1) as AA,last(フィールド2) as BB　 from　FFテーブル　group by フィールド3 ところがsqlserverにはfirstとlastがありません?? どのようにすればよいのかご教授おねがいします firstとlastはない場合、ほかの方法で結果がでればどの方法でもかまいません。 よろしくおねがいします
富士通製サーバPrimergyTX200 S3に装着できるDATドライブが USBしか選択できなくなっていたため、USBを装着したのですが SQLServer2005のバックアップデバイスにテープドライブとして 認識してくれません。 これは何故なのでしょうか。 どなたか原因をご存知でしたら教えてください。困ってます。 よろしくお願いします。
DBサーバ 　Windows NT4.0 Server 　MS SQLServer7.0 上記DBサーバのレスポンスが悪く困っています。 長年使用していますのでサーバの買い換えなど有効な対応方法はあるかと思いますが、まずは現在の機器での改善を試みたいと思っています。 メモリの増設は検討中であり、実施する予定です。これでどの程度改善が期待できるのか・・・。 これらのハード的な解決以外に、SQLServerの設定などでレスポンスを改善する方法はありませんでしょうか。 SQLServerの使用できるメモリ量を増やす（？）とか、処理の優先度を上げるとか、など。 有効な対処方法をご存知の方、教えていただけませんでしょうか。 よろしくお願いいたします。
ID　名前　日付　点数　合否 ---------------------------------------------------------- 1　太郎　4/1　80 合格 2 太郎 4/2 90 合格 3 太郎 4/3 100 合格 4 花子 4/5 20 不合格 5 太郎 4/5 30 不合格 6 花子 4/6 100 不合格 7 太郎 4/7 40 不合格 8 花子 4/7 100 合格 上のようなテーブルから、太郎と花子が最初に合格するまでの 実施回数を取得するようなSELECT文は可能でしょうか？ 結果として望むのは以下になります。 ID 名前 合格までの実施回数 --------------------------------------------------------------- 1 太郎 1 2 花子 3 どなたかご教授願います。
初心者です。 現在、サーバのHW移行に伴う、DBの移行を行っております。 そこで、MSSQLの『バックアップ』、『復元』機能により移行を行おうと考えております。 しかし、毎日取得しているDBのバックアップを別サーバで復元したところ、以下メッセージが出力されうまくいきません。 自分なりに調べてみたのですが、情報がなかったため質問させていただきます。 よろしくお願い致します。 ■エラーメッセージ Microsoft SQL-DMO(ODBC SQLState:42000) 復元しようとしているデータベースはUnicodeロケ－ルID(33280)または比較スタイル(0)でバックアップされました。このサーバで現在実行されているロケ－ルID(1041)または比較スタイル(196609)とは異なります。バックアップまたは復元操作が異常終了しました。 ■環境（移行元、移行先） Windows2000Server SQLServer7.0 ■やりたいこと サーバ移行に伴う、DB移行 ■質問 (1)復元が失敗した原因 (2)別の移行方法（よい方法があれば）
初心者の質問で申し訳ありません。 トランザクションで複数のテーブルを更新する時、テーブルロックはかかっているのでしょうか。 具体的に言うと、 BEGIN TRAN a 　INSERT INTO A VALUES('data1') 　INSERT INTO B VALUES('data1','data2') 　INSERT INTO C VALUES('data1','data2','data3') COMMIT TRAN a とするとき、テーブルA,B,Cはあらかじめロックしておく必要があるのでしょうか。 アドバイスお願いいたします。
ASP.NETとSQL Server2005 Express Editionでアプリケーションを作成している 初心者です。よろしくお願いします。 コンピュータの構成は以下のとおりです。 サーバ(コンピュータ名:Server) Windows2000 Server IIS, .NET Framework2.0, SQL Server2005インストール クライアント(コンピュータ名:Cliant1) WindowsXP Professional Visual Web Developerインストール また双方にSQL Server Management Studio Expressを入れてます。 クライアントのパソコンでWEBアプリを作ってサーバにコピーといった 使い方をしています。 クライアントのパソコンでManagement Studio Expressを起動し、サーバの SQL Serverに接続するとき、サーバ名から参照を選び、ネットワークサーバには SERVERが現れるのですが、接続しようとすると以下のエラーが発生します。 TITLE: サーバーへの接続 ------------------------------ SERVER に接続できません。 ------------------------------ ADDITIONAL INFORMATION: サーバーへの接続を確立しているときにエラーが発生しました。 SQL Server 2005 に接続しているときときにこのエラーが発生した場合は、 SQL Server の既定の設定がリモート接続を許可しないようになっていることが エラーの原因である可能性があります。 (provider: TCP プロバイダ, error: 0 - 対象のコンピュータによって 拒否されたため、接続できませんでした。) (Microsoft SQL Server, Error: 10061) For help, click: http://go.microsoft.com/fwlink?ProdName=Microsof … Server&EvtSrc=MSSQLServer&EvtID=10061&LinkId=20476 Windows認証、SQL Server認証どちらでもエラーになります。サーバの方では リモートアクセスをTCPのみ、TCPとパイプ等いろいろ試してみましたが、 お手上げです。 他に設定する必要があるのでしょうか。よろしくお願いします。
SELECT文で、文字データを数値に変更したいのですが CONVERTを利用すると思うのですが、よく分かりません。 ご存知の方　教えて下さい。 例 左側の0をなくしたいので、数値に変更したい 0009090　→　9090 0000099　→　99
システムdateを取得して、現在が４月だとすると 4月だけをselectするようなSQL文を作りたいのですが getdateを利用すると思うのですがよくわかりません。 Ａテーブル hiduke1 1 2007/04/01 2 2007/04/02 3 2007/04/03 4 2007/05/03 5 2007/06/03 ４月の場合は、このような結果にしたいのです。 hiduke1 1 2007/04/01 2 2007/04/02 3 2007/04/03
お世話になります。 マスタのcodeという項目と同じ名前で使用されているテーブルを 検索するにはどのようにしたらいいでしょうか？ よろしくお願いします。
SQLServer2005からSQLServer7.0へ接続した際どのような障害(問題) が起こるのかをインターネットで調べているのですが、 これといった情報がなく、困っています。 少しでもお分かりの方がいらっしゃいましたら、 情報を提供してください。よろしくお願いします。
作業中にブレーカーが落ちてしまい再起動したところ、 起動時に次のようなエラーが出るようになってしました。 --------------------------------------------------------- SQL Server could not find the specified named instance (VAIO_VEDB) -please specify the name of an existing instance on the invocation of sqlserevr.exe. If you believe that your installation is corrupt or has been tampered with,uninstall then re-turn setup to correct this problem --------------------------------------------------------- <約> SQL Serverは指定された命名されたインスタンスを見つけることができ ませんでした。(VAIO_VEDB)-sqlserevr.exeの実施で既存のインスタンスの名前を指定してください。 あなたが、あなたのインストールを不正であるか、またはいじってある と信じているなら、当時のリターンセットアップをアンインストールして、この問題を修正してください。 このようなエラーが2度出た後は普通に作業できるのですが、若干以前より動作が重くなりました。 ちなみに使用しているPCはVAIOの昨年モデルのデスクトップ型、でOSはXPになります。 非常にこまっています。どなたかこのエラーに対する対処方法を教えていただけないでしょうか？お願いいたします。
SQLServer初心者です。 使用DBはSQLServer2005です。 SQLServerではInsert文でサブクエリは使用できませんか？ 例） INSERT INTO TmpA (a,b) VALUES ( 1,(SELECT TmpB.b FROM TmpB)) を実行しましたところ、 『メッセージ 1046、レベル 15、状態 1、行 12 このコンテキストではサブクエリは許可されません。スカラ式だけが許可されます。』 とのエラーが発生しました。 何らかの工夫で実装できる方法がありましたら、 教えて下さいませんか？
OS:Windows Server 2003、DB:SQL Server 2005 Developer Edition を使用しています。 データファイル:test.mdf、ログファイル:test_log.ldfでtestデータベースを構成後、SQL Serverサービスを停止し、test.mdfファイルの名前を変更、test.mdfが壊れたものと仮定します。 その後、SQL Serverサービスを起動すると、testデータベース上にmdfファイルが見つからないエラーが発生します。 この状態でトランザクションログを救出するため、SQL Server Management Studioでトランザクションログバックアップを実行させます。 しかし、この際、右クリックのメニューからバックアップを選択することができず、トランザクションログバックアップができません。 この状態でトランザクションログバックアップを行うにはどのようにすればよいのでしょうか。 どなたかご存知の方がいらっしゃれば教えてください。
SQL-SERVER 2005 Standerd-Edition と Visual Studio 2005 を使用して、VC# で CLR によるストアドプロシージャを作成しています。 apache の accesslog を正規表現で整形し、必要な項目を抽出してからtable へ INSERT しようとしています。 http://www.atmarkit.co.jp/fdb/rensai/sqls05try05 … http://www.atmarkit.co.jp/fdotnet/vs2005db/vs200 … http://www.codeguru.pl/forum-posts-6460-4.aspx このあたりの記事を参考に、どうにかできるようにはなりました。しかし、accesslog が膨大なサイズのため、１行ずつ SQL 文を発行して INSERT していると、10時間前後かかってしまっています。（1,500万record 程度になっています） 何行かずつでも、『まとめて』 INSERT する方法はないものでしょうか。 ※正規表現で整形したものを tab区切りで text 出力し（これは１０数分で終わります）、それをウィザードを使用して import すると小一時間で済んだりします。 現状、accesslog の import だけなので、それでもよいのですが、今後は既存の table に対して正規表現を用いて何らかの集計を行っていく予定でいます。数千万 record の table を扱っていくことを考えると不安です。＾＾； そもそも CLR を「正規表現が使いたい」というだけの理由で導入していること自体、少々お恥ずかしい心持なのですが、もしヒントになるような情報をお持ちの方がいらっしゃれば、ご教授願えませんでしょうか。
お世話になります。以前はアクセスでデータベース接続していたのですが、件数の増加により、試験的にSQL Server 2005 Express　に移行しました。マイクロソフトのサイトを参考にして、アクセスからアップサイジングして、無事に接続することが出来ました。ひとつ不明な点があるので教えてください。Webアプリケーションで、データベースに書き込みをしたり削除をしたりするので、mdbファイルの時は、置いてあるフォルダは匿名アクセス（IUSR_コンピュータ名）で認証し、フルコントロールOKに設定していました。（社内イントラネットのみで運用）SQL Server 2005 の場合は統Windows認証で接続しています。IISを経由してインターネットユーザーがパスワードなしでデータベースにアクセスできるようにするにはどのように設定したらよいのでしょうか？
初めて投稿します。お世話になります。 Windows Server 2003 R2 Standard Edition Service Pack 1 を使用しています。 SQLServer2005をインストールする前にテープデバイスのドライバを入れるのを忘れてしまい、 テープデバイスがManegement Studioのバックアップデバイスに認識されません。 ストアドプロシージャ「sp_addumpdevice」でテープデバイスとして登録した後、バックアップを実行しようとすると、 「メディアファミリが正しい形式ではありません。SQL Serverはこのメディアファミリを処理できません」 というメッセージが表示されます。 SQL Server 2005を再インストールすればいいかもしれないのですが、設定の都合上再インストールはせずにテープデバイスを認識させたいのです。 どうかご教示のほどよろしくお願いします。
FROM句に続く、[スキーマ名].[テーブル名]を動的にすることは可能でしょうか。何か手法がありますでしょうか。 よろしくお願いします。
こんにちは。 現在、SQLServerのテーブルをServletにて更新しているのですがSQLが実行されても更新されていません。 何かSQLSeverで設定がいるのでしょうか？ SQLは("UPDATE T_Strfer SET フラグ ='1' WHERE id="+Str);となります。SQLは確実に実行されています。 尚、SQLServerでフラグはテキスト型のフィールドサイズ１となっています。 ご教授宜しくお願い致します。
タイトルの通り、複数テーブルのUPDATEを行いたいと思っています。 私なりには、以下のようなコードでテーブルを作成しようとしましたが、作成できませんでした。 エラー内容としては、 update table_1, table_2 SET のtable_1, が間違ってます的なエラーでした。 update table_1, table_2 SET table_1.updatetime=getdate(), WHERE table_1.SeqNo = table_2.SeqNo AND table_1.SeqNo = @SeqNo 以上、緊急の内容であったため、十分調べていない点があるかもしれませんが、何卒、ご存知の方ご教授お願い致します。
どうしてもIF文がうまくいきません IF文の中にIFを入れ子していますそのIFが複数の条件があります 今までACCESSではELSEIFで条件をいくらでも指定できたのですがSQLの場合はエラーになってしまいます ご教授おねがいします ------------------------------ set ANSI_NULLS ON set QUOTED_IDENTIFIER ON go ALTER FUNCTION [dbo].[scfc_part端数処理] ( @PTHASU nvarchar(10), @haken nvarchar(10) ) RETURNS real AS BEGIN DECLARE @PARTT real DECLARE @PARTT_H real if (not(@PTHASU is null)) if @haken='派遣' or @haken='臨時' if substring(@PTHASU,4,2)>= 50 SET @PARTT = convert(int,LEFT(@PTHASU,2)+1)*60 --ここをいれるとエラー IF substring(@PTHASU,4,2)< 50 and substring(@PTHASU,4,2)>= 20 --ここをいれるとエラー SET @PARTT = convert(int,LEFT(@PTHASU,2)*60 +30 --ここをいれるとエラー if substring(@PTHASU,4,2)< 20 --ここをいれるとエラー SET @PARTT = convert(int,LEFT(@PTHASU,2)*60 ELSE SET @PARTT = convert(real,LEFT(@PTHASU,2))*60 + convert(real,substring(@PTHASU,4,2))*1 ELSE SET @PARTT= 0 SET @PARTT_H = convert(real,(floor(@PARTT/60*10000)/10000)) RETURN @PARTT_H END
サーバーＡにてバックアップしたものをサーバーＢへとリストアしようとしています。 （Ａがメインで、毎日Ｂを同じ状態に保っていたい） DBのサイズがかなり大きくなってしまっている為、週一で完全＆通常は差分のみと考えています。 完全についてはREPLACEオプションにてリストアできるのですが、差分がリストアできなくて困っております。 リストアする方法でなくても、ＡとＢを同じ状態に保つ方法があれば教えてください。 OS:WIN2003Server DB:SQLServer2005
SQL server2000での四捨五入を教えてください。 百の位を見て、四捨五入し、千円単位で丸めたいです。 <例> 12,499 ⇒　12 11,800 ⇒　12 12,500 ⇒　13 よろしくお願いします。
accessで関数を使用していました sqlserverでのスカラ値関数を設定しましたが戻り値を確認したいのですがprintを記述すると関数の中では使用できませんとエラーになってしまいます?戻り値を確認する方法はないでしょうか じつは下記ストアドから関数を呼び出して結果をテーブルにインサートすると小数点以下のデータが消えています?そこで戻り値が正しいか確認したいのです。accessの場合には少数以下正常に出ます なにかprgの記述がまちがっているのでしょうかご指導おねがいします ----INSERT INTO ストアド----Sum(dbo.scfc_残業時間([残業H])) AS 残業Z----GROUP BY ****---- ------スカラ値関数---dbo.scfc_残業時間---------------------------- set ANSI_NULLS ON set QUOTED_IDENTIFIER ON go ALTER FUNCTION [dbo].[scfc_残業時間] ( @ZAN nvarchar(5)) RETURNS real AS BEGIN DECLARE @ZANGYOU int DECLARE @ZANGYOU_H real if (not(@ZAN is null)) if len(@ZAN)= 4 SET @ZANGYOU = convert(int,LEFT(@ZAN,1))*60 + convert(int,substring(@ZAN,3,2))*1 ELSE SET @ZANGYOU = convert(int,LEFT(@ZAN,2))*60 + convert(int,substring(@ZAN,4,2))*1 ELSE SET @ZANGYOU= 0 IF @ZANGYOU > 0 SET @ZANGYOU_H = floor(@ZANGYOU/60*10000)/10000 RETURN @ZANGYOU_H END
データの入っているテーブルの項目長を短くするために、 一度新規のテーブルにコピーをしたのですが、その後どうやれば項目長を変更したテーブルにデータを写せるのかがわかりません。 直接データを打ち込むしかないのでしょうか？
alter table テーブル名 modify を使うと、修正する列を空にする必要があるというエラーが出てきてしまいます。 空にしないで、項目長を短くする方法はないでしょうか？
ID名前日付点数合格日 ------------------------------------------------------------------- 1太郎2007/4/180合格 2太郎2007/4/290合格 3太郎2007/4/3100合格 4花子2007/4/520不合格 5太郎2007/4/530不合格 6花子2007/4/6100合格 7太郎2007/4/740不合格 8花子2007/4/7100合格 上のようなテーブルから、太郎と花子が最初に合格した日の情報を 取得するようなSELECT文は可能でしょうか？ 結果として望むのは以下になります。 ID名前日付点数合格日 --------------------------------------------------------------------- 1太郎2007/4/180合格 6花子2007/4/6100合格 どなたかご教授願います。
.NetFrameWork1.1インストール済みでWebアプリケーション(vb.net2003)が稼動中のWindows2003Serverがあります。 このServerに.NetFrameWork2.0が必要なWindowsアプリケーション(vb.net2005)のプログラムをインストールしたいのですが・・・・。 (1)既に動いているWebアプリケーションに影響はないでしょうか？ (2).NetFrameWork2.0をインストールするとServerの再起動が必要になるでしょうか？ よろしくお願いいたします。
例） SELECT A.aaa , B.eee , C.fff FROM ○○○ A LEFT JOIN ▲▲▲ B ON B.aaa = A.aaa LEFT JOIN □□□ C ON C.aaa = (CASE WHEN C.bbb =0 THEN A.aaa ELSE A.ccc) WHERE A.eee > 0 の様なＳＱＬ文を発行して、 クエリアナライザの実行プランを確認すると、 □□□ にソートが掛かり、 非常にレスポンスの悪いＳＱＬになります。 ソートが原因か分かりませんが、 良い解決策はないでしょうか？
お世話になります。 過去の質問の中で、文法が分からないものがあったので、教えてください。 [QNo.1118130] 全テーブルのデータの行数 という質問の中のNo.1の方の回答で次のようなSQL文がありました。 -------------------------------------------------------------------------------------- DECLARE @name nvarchar(30) DECLARE @sql nvarchar(200) DECLARE TCUR CURSOR FOR SELECT name FROM sysobjects WHERE type = 'U' OPEN TCUR FETCH NEXT FROM TCUR INTO @name -----・・・（１） WHILE (@@fetch_status <> -1) BEGIN SET @sql = 'SELECT count(*),''' + @name + ''' AS TNAME FROM '+ @name -----・・・（２） EXEC(@sql) FETCH NEXT FROM TCUR INTO @name -----・・・（３） END CLOSE TCUR DEALLOCATE TCUR -------------------------------------------------------------------------------------- （１）の部分について 　"INTO @name"の部分で、@name には何を入れているのでしょうか？ （２）の部分について 　最初の 'SELECT count(*),'の部分は分かるのですが、これ以降で"'(シングルクォーテーション)"が沢山あって、何を囲っているのか分かりませんでした。 　（"'"が多用されていて分かりませんでした） （３）の部分について 　（１）と全く同じ文ですが、（１）と（３）でやっていることは違うのでしょうか。 すみませんが、アドバイスお願いします。
AccessからSQL Server2005へ作り変えています。 質問させていただきます。 テーブル名「伝票」の中身 　　　製品　　在庫数　　注文数　　 　　　　A　　　　12　　　　　10　　　　 　　　　B　　　　11　　　　　13　　　　 　　　　C　　　　16　　　　　11　　　　 このテーブルから在庫数と注文数を比較して、 注文数が在庫数以内の場合は・・・OK 注文数が在庫数以上の場合は・・・NG イメージとしては以下のようにななります。 　　　製品　　在庫数　　注文数　　判定 　　　　A　　　　12　　　　　10　　　　OK 　　　　B　　　　11　　　　　13　　　　NG 　　　　C　　　　16　　　　　11　　　　OK これをAccessのクエリで表現する場合は、判定にVBAを使っています。 （テーブルに判定という項目はありません） SQL Server2005ではスカラ値関数を作って、それをストアドプロシージャで 呼び出せば可能ですよね・・・？ そこで以下の悪戦苦闘しながら以下のスカラ値関数を作りました。 　　　ALTER FUNCTION dbo.HANTEI (@ZAIKO int, @TYUMON int, @HANTEI nvarchar(2)) RETURNS nvarchar(2) AS BEGIN IF @ZAIKO >= @TYUMON SET @HANTEI = 'OK' ELSE SET @HANTEI = 'NG' RETURN @HANTEI END これをストアドプロシージャで実行すると、パラメータで指定したHANTEI がテーブルにないので エラーになります。テーブルに判定に相当する項目を用意すると正しく結果が出ます。 テーブルに判定項目を用意せずに正しい結果を出したいのですがどうすればよいですか？ よろしくお願いします。
パッケージのセキュリティソフトを使用しており、ログがSQL ServerのDBに入るようになっています。 セキュリティソフトからログを参照するときはログの日時が実際の正しい時間になっていますが、データベースのテーブルを直接参照すると実際の時間とは９時間ずれた時間で登録されているようです。 SQLでデータベースから直接データを取り出すことをしたいのですが、このときにこの９時間のズレを直す方法がないでしょうか？ 条件で今月分のログをSQLで取り出そうとしても９時間のズレがあるため本来の１ヵ月分とはずれた形で抽出されてしまいます。 よろしくお願いします。
SQLServer2000を使って開発をしております。 他のデータベースに比べるとSQLServer2000は情報量が少ない気がするのですが、そんなことはないでしょうか？ 皆さんのお勧めの書籍やWebサイトがありましたら教えていただきたいです。
SQLServer2005 でSELECTを実行した結果（クエリ結果）をファイルに出力したところ、同じデータベース項目をSQLServer2000 でSELECTした結果の２倍程度の大きさになる。 ファイルダンプを採取して中身をみたところ、UNICODEでファイル出力されており、すべての半角文字が２バイト表記されていたため、SQLServer2000（こちらは半角文字は１バイト）のほぼ２倍の大きさになっている事が分かりました。 SQLServer2005 でSELECTを実行した結果（クエリ結果）を半角文字は１バイトで出力する良い方法をご存じの方、ご教示いただけないでしょうか？
sqlserver2005の初心者です いままでaccessで標準モジュールにユーザー関数を作成していました Function 年齢(SEI) As Integer Dim SEIDATE, HONSEI, UNSEI, HONY, HONM, UPD Dim MH, DH As Integer MH = 0: DH = 0 SEIDATE = DateValue(SEI) If Not IsDate(SEI) Then Exit Function UPD = DateSerial(Year(Date), Month(Date), Day(Date) + 1) If Val(Mid(SEIDATE, 6, 2)) > Val(Mid(Date, 6, 2)) Or (Val(Mid(SEIDATE, 6, 2)) = Val(Mid(Date, 6, 2)) And Val(Right(SEIDATE, 2)) > Val(Right(Date, 2))) _ Or Right(Date, 5) = "12/31" Then MH = 1 HONY = DateValue(DateSerial(Year(SEIDATE) + MH, Month(Date), Day(UPD))) UNENREI = DateDiff("YYYY", HONY, UPD) 年齢 = UNENREI '-------------SYAIN990112年齢勤続クエリー用------------------ If Val(Right(SEIDATE, 2)) > Val(Right(Date, 2)) Then DH = 1 HONM = DateValue(DateSerial(Year(Date) - MH, Month(SEIDATE) + DH, Day(UPD))) UGETUREI = DateDiff("M", HONM, UPD) HONSEI = DateValue(DateSerial(Year(Date), Month(Date) - DH, Day(SEIDATE))) UHIREI = DateDiff("D", HONSEI, UPD) End Function 宣言がない変数はpublic変数を設定しています ここに例 s33/10/05の生年月日を飛ばして戻り値をえています sqlserverで作成する場合テーブル関数なのかスカラ関数なのかわかりません、 余計な部分ははぶいていただいて簡単でけっこうですのでsqlserverでの記述をおしえていただけないでしょうか
SQLでこんなことは可能でしょうか。 列 ＩＤとＴＥＸＴ　をもつテーブルＡ と、 列 ＩＤをもつテーブルＢがあります。 テーブルＡに、テーブルＢのＩＤ分のデータを挿入したいです。 TEXTはテーブルＡのＩＤ=1のＴＥＸＴデータを全ての列に挿入します。 このような場合のＳＱＬ文を調べてるのですが、 なかなかわからなくて困っています。 insert into select b.id,a.text from tableA as a, tableB as b でもうまくいきませんでした。 何かいい方法はないでしょうか？ 回答お待ちしております。
ＳＱＬServerにてselect文のあいまい検索についての質問です。 char型項目を以下のようにあいまい検索したいのですが、どのように条件を書けばいいのでしょうか？ 　Ａ項目 　----- (1)　21234 (2)　256 (3)　27890 (4) 2 (5)　2378 とデータがあるとします。 結果、(1)と(3)のみ対象としたいのです。 先頭1桁が'2'のものを対象にしたいのですが、 LIKE '2____'とすると、全てselectされてしまいます。 他に方法ありますか？
SQL文の書き方を教えて下さい。 以下の２つのクエリー（1のクエリー＆２のクエリー）を１つのクエリーで1度に抽出をかけたいのですがSQL文の書き方がわかりません。 データの発生条件としては TableBのField1は必ずTableAのField1に存在するという条件です。 TableAのField1が「AAA」から「EEE」まである場合は、TableBのField1も必ず「AAA」から「EEE」の範囲内で発生します。 よろしくお願い致します。 1のクエリー ---------------------------------------------------------------- TableA Field1 ---------------------------------------------------------------- AAA AAA AAA BBB BBB CCC DDD DDD EEE EEE EEE ---------------------------------------------------------------- Field1をサマライズしてカウントと名称を取得するクエリー Select Count(TableA.Field1) as RecCount, TableA.Field1 From TableA 結果 RecCount　　Field1 3　　　　　　AAA 2　　　　　　BBB 1　　　　　　CCC 2　　　　　　DDD 3　　　　　　EEE ---------------------------------------------------------------- 2のクエリー ---------------------------------------------------------------- TableB Field1 ---------------------------------------------------------------- BBB CCC CCC EEE ---------------------------------------------------------------- Field1をサマライズしてカウントと名称を取得するクエリー Select Count(TableB.Field1) as RecCount, TableB.Field1 From TableB 結果 RecCount　　Field1 1　　　　　　BBB 2　　　　　　CCC 1　　　　　　EEE ---------------------------------------------------------------- 希望する結果 TableAのRecCount　TableBのRecCount　TableAのField1 3　　　　　　　　　 　　　　　　　　　AAA 2　　　　　　　　　1　　　　　　　　　BBB 1　　　　　　　　　2　　　　　　　　　CCC 2　　　　　　　　　 　　　　　　　　　DDD 3　　　　　　　　　1　　　　　　　　　EEE
VistaBusinessEditionに、少し古いですが、MSSQL2000をインストールしたいのです。ところが、インストールは途中で終わって居ます。しかし、スターチメニューからはEnterPriseManagerは起動し、サービスも動いている状況です。 ところが、ローカルのデータベースに接続できないようなのです。 まだ、Vistaの経験が浅いのですが、特別な設定が必要でしょうか？
下記のコードにてエクセルでデータベースに接続しようとするのですが、どうしてもうまくいきません。開きたいデータベースは”sekisan.mdf”という名前です。現在はローカルPCにて接続したいとかんがえております。 何かおかしな点があったらご教授願います。それから、逆にエクセルデータをSQLSERVERの既存のデータに書き出すことって可能でしょうか？ cn.ConnectionString = "Provider=SQLOLEDB;Data Source=(local);" & _ "Initial Catalog=sekisan;Integrated Security=SSPI;"
下記の記事を参考にVS2005を用いてSQLデータベースを作成しようとしたのですが、図２のMyDB.mdf作成の時に ユーザー'******'はログインできませんでした と出て作成できなくて困っています。 どなたか解る方居ましたらお願いします。 参考情報 ・サービスでSQL Server(SQLEXPRESS)が起動していることを確認済み ・OSはVista HomePremiumを使用 ・別PCのVistaBusinessでは作成できました ・SQLEXPRESS SP2は当ててあります
SQLServer2005でSELECTした結果（クエリ結果）をファイル出力した場合、UNICODEで出力されてしまいます。 S-JISで出力する方法をご存じの方、ご教示いただけないでしょうか？
以前にも同じような質問をしましたが、少し異なります。 ＳＱＬＳｅｒｖｅｒでＳＥＬＥＣＴ文を発行した場合です。 列名をいくつか指定し、そのうちの1つの列名の桁数をあわせたいのですが良い方法はないですか？ select　A,B,C　from　xxtbl　 例えばc列が符号付数字項目（decimal）だったとします。 出力を8桁にしたい。 値が”-12”の場合に" -12”としたいのです。 mataha, " 12-"でもいいのですが。
お世話になります。 ＳＱＬ文についてちょっと助けてください。 テーブルＡ Ａキー（主） テーブルＢ Ｂキー（主） Ａキー テーブルＢからＢキーを取り出すとき、ＡキーでテーブルＡを見に行って存在しない場合のＢキーだけを取り出したいのです。 一度のＳＱＬ発行で可能でしょうか。
ＳＱＬＳｅｒｖｅｒでＳＥＬＥＣＴ文を発行した場合です。 列名をいくつか指定し、そのうちの1つの列名の桁数をあわせたいのですが良い方法はないですか？ select　A,B,C　from　xxtbl　 例えばc列が8桁charだったとします。 値が”0”の場合に”00000000”としたいのです。 format指定みたいのはないですか？
accessのフォーム上において、サブクエリを元データとして使用し 顧客別に受注合計、入金合計を出させ、売掛金残高を表示させました。次に受注ID毎の売掛金残高を、顧客別に集計させて売掛金残高合計を出したいのです。 元データはどこから引っ張ってくればよいのでしょうか？ ちなみに受注合計の計算式には売上数量毎に割引率が異なります。 ご教示のほどよろしくお願い申し上げます。
Windows2003SvとSQLServer2000で開発をしています。 SQLサーバー認証にしたいのですが、Windows認証しか有効にならない為、アクセス出来ず困っています。 Windows2003Svにアカウントの無いユーザーの場合は 「SQLサーバーが存在しないか、アクセスが拒否された」とのメッセージが出てアクセス出来ません。 SQLサーバーの状態はEnterpriseManagerよりWindows混合モードにしています。 同一PCでアカウントを切り替えて実験してもそうなるので、 外部環境ではなく、認証の設定が不足しているのではないかと思います。 どのあたりを確認すべきでしょうか？
数量の更新をする場合で、現在登録されている数量からある値で数量を減らす場合、下記ＳＱＬを発行しています。 UPDATE A_TBL SET 数量 = 数量 - 10 上記SQL結果にて数量が０未満(マイナス)になる場合は０で更新したいのですがどのようなUPDATE文にすればよろしいのでしょうか。 先に数量の判定をすればできると思うのですができればUPDATE文でやりたいと思っています。 どなたかご教授のほどお願い致します。
SQL Server2005を使用しているのですが、データのインポート時に下記のエラーメッセージが出て失敗します。 警告 0x802092a7: データ フロー タスク: 長さ 50 のデータ フロー列 "列 XXX" から、長さ 48 のデータベース列 "ABCDEF" にデータを挿入することにより、切り捨てが行われる可能性があります。 (SQL Server インポートおよびエクスポート ウィザード) このエラーの回避方法をご存知の方がいらっしゃいましたら教えてください。よろしくお願いします。
基本的な問題かもしれませんが、SQLのJOINの使い方が判らないので教えて下さい。 SQLで　A表とB表とC表をINNER JOINした表に対して、 D表をOUTER JOINした結果に対して、E表をINNER JOINしたいのですが、 SQL文で書くことは可能でしょうか？ SELECT ((((cols FROM A INNER JOIN B ON --) INNER JOIN C ON --) OUTER JOIN D ON --) INNER JOIN E ON --) と単純に書くとネスト数のオーバーなのかエラーが出ます。 後ろの部分だとサブクエリーに対してJOINすればよいかもしれませんが、主ファイルに当る部分の場合はサブクエリーに切り出す方法が判りません。 よろしくお願いします。
accessユーザーです sqlserver2005にアップサイジングしたあと修正をしていますが accessの場合クエリおよびsqlのprgで作成したテーブルの連結リレーショナルで更新ができていたのですが sqlserverの場合はテーブルの連結した状態では更新できないのでしょうか ご教授おねがいします
WindowsXP(SP2) SQLServer2000(SP4) VisualBasic6.0(SP6) の環境で開発しています。 数千件の画像のファイル名称（パスを含む）をテーブルに登録する操作を行うアプリがあります。この処理を実行中に、下記のエラーが発生します。 "[DBNETLIB]{ConnectionOpen(Connect()).]SQL Serverが存在しないか、アクセスが拒否されました" 1レコード目の操作から発生するのならまだしも、1000件くらいINSERT処理が進んでから発生するので、原因が分かりません。 また、エラーが発生するのは固定の環境だけで、同じアプリ、同じDB、同じ画像ファイルを使っても、別の環境では発生しません。 こんな場合、どの辺を確認したら良いかご教授下さい。 宜しくお願いします。
SQLServer2000で項目値"123"のＡ項目をSELECTした結果をファイル出力した場合（SELECT A from テストテーブル） 処理結果ファイルを１６進で表示すると ""31 32 33"" ですが SQLServer2005で同様に結果をファイル出力した場合、"31 00 32 00 33"のように１バイトごとにnull(""00""）が挿入されてしまいます。 この事象を回避する方法をご存じの方ご教示いただけないでしょうか？
SQL Server2000を使用しています Enterprise Managerでストアドの中身を画面やSQLスクリプト生成で見ていますが一つずつ見なければならないので不便です DB内に登録されたストアドを一括してtxtデータに落とし込む方法はないでしょうか？ Enterprise Managerの機能でなくてもACCESSやEXCELで実現できればそれでいいです
基本情報試験の勉強でSQLが出てくるので、実際にパソコンで操作して勉強したいのですが、それに必要なソフトはどんなものがあるのでしょうか？お勧めのソフトを教えてください。
Access2003、windows-xpをつかっています。 下記のクエリがあります。 PARTS_NO _____ REV_NO _____TREATMENT_CLS _____TREATMENT_CD AB9043 _____ 6 _____ 1 _____ TE011 AB9043 _____ 7 _____ 1 _____ TE009 このクエリの「REV_NO」のＭＡＸの数値があるデータだけを抽出したいのですが、どうしたらよいでしょう？ 「集計」をつかうと、他がグループ化されてしまったりでうまくいきません・・・。 私は、SQL構文がよくわからないのですが、念の為に、SQL構文を載せておきます。 SELECT DISTINCT SPDS_PARTS_ATTR_TREATMENT.PARTS_NO, SPDS_PARTS_ATTR_TREATMENT.REV_NO, SPDS_PARTS_ATTR_TREATMENT.TREATMENT_CLS, SPDS_PARTS_ATTR_TREATMENT.TREATMENT_CD FROM SPDS_PARTS_ATTR_TREATMENT WHERE (((SPDS_PARTS_ATTR_TREATMENT.PARTS_NO)="AB9043") AND (Not (SPDS_PARTS_ATTR_TREATMENT.TREATMENT_CD)="TN000")); おわかりになる方がいらっしゃいましたら、お願いいたします!!
Windows2003 Server評価版 SQL Server　評価版　を使用して、SQLServer2000をインストールしています。 WEBよりダウンロードしたファイルを使用しています。 インストールマニュアルを見ていると、 1.SQL ServerのCDをセットする 2.SQL Server 2000コンポ―ネントをクリックする 3.データベースサーバーのインストールをクリックする 　と書いてあるのですが、WEBよりダウンロードしましたのでＣＤがありません。 どのようにデータベースサーバーをインストールすればよいのでしょうか？ 初歩的な質問ですみません。 どうぞよろしくお願いいたします。
Select文にて計算式をして、その計算された数字の前にエンマークをつけるにはどうしたらよいでしょうか？ 例 SELECT 商品.商品名, 商品.単価, 売上.数量, 数量*単価 AS 金額 金額 ￥*****
初めて質問させていただきます。カテゴリがあっているのかわかりません。 今現在入荷の部署に配属しており、入荷したものを莫大な量のプリントアウトした入荷予定リストの中から、目で見て消しこみをしています。 ただその場合どうしても漏れが出てしまいます。 今現在考えているのは、入荷の予定のリスト（エクセル）と、入荷した伝表を入力するシート（エクセル）をアクセスにリンクさせ、リストを参照し、入荷済みのものだけを抽出、また、入荷数が予定と違い入荷した場合不足しているものだけを抽出するクエリは作成できました。 ただ、ここから私の知識では足りないので手を貸していただきたいです。 その先、抽出したクエリから、もともとの入荷予定リストのテーブルのフィールドに、「済」や「○枚不足」などの値を連携させることは可能なのでしょうか？ アクセスのヘルプで、自分が調べた範囲では、SQLとゆうものを使えば可能なようなのですが、初心者なのでどのようにやればよいのかが理解できませんでした。 宜しくお願い致します。
SQLCMD コマンドの書き方で、処理を一時中断（待機）するコマンドはあるのでしょうか？ Dosコマンドだとsleepとかがあるのかと思うのですが。 当方、システム開発の初心者です。 ご教授いただけたら嬉しいです。 よろしくお願いします。
startTime（列名） 2007-03-01 17:30:20.140(データ) 2007-03-01 17:30:20.130(データ) 2007-03-01 17:30:20.110(データ) 上記の内容に対してselect文を実行して .140 .130 .110を無視した結果を表示するSQL文を教えて下さい。 年月日時秒は「2007-03-01 17:30:20」を指定。 宜しくお願いします。 実行結果例 2007-03-01 17:30:20 2007-03-01 17:30:20 2007-03-01 17:30:20
SQL初心者です。 現在、SQL_SERVER2005 EXPRESS EDITIONを使用しております。 データベースのバックアップと復元機能がありますが、復元する先の データベースが壊れてしまったり、消してしまった状態で行う方法は ありますか？
以下のようなテーブルが存在します。 Ａ　　　Ｂ　　　Ｃ １　　　１　　　３ １　　　２　　　４ ２　　　３　　　３ ２　　　２　　　３ ・・・・ 求めたい事は、 ・Ｃの総合計 ・Ａ列におけるＣの合計 ・Ａ＆Ｂ列におけるＣの合計 です。３回ＳＱＬをまわせばいい事かもしれませんが、行数がすさまじく多いので１回もしくは２回のＳＱＬで上記の結果が得られればいいなと思っています。 何かいい案がありましたらご教授いただきたくよろしくお願いします。
SQL Server 2005 Standard Edition を使っています。 インデックスが断片化しているので、再構築を実行するのですが、実行直後に断片化率を見ても、0％にならない場合があります。これは何故なのでしょうか。サーバのメモリは1GBですが、メモリが少なすぎるのでしょうか。
SQLServerでINSERT文を書くとき、NULLを意図的に登録したいのですがどのようにすればよいのでしょうか？ ''にするとブランクとして登録されてしまいます。
今ある、Accessの照会システムがあります。 テーブルはサーバ(Win2003Server)にmdbファイルを置いてます。 照会画面、レポート等のプログラムは各クライアントにそれぞれmdbを置き、サーバにあるmdbファイルをリンクテーブルで参照しています。 今後照会だけでなく入力エントリプログラムを追加していくのですが そのエントリは９台同時に入力することが考えられます。 今のmdbで９台同時複数エントリはAccessのmdbでは当然無理なので 今あるインターフェースをAccessで DBをSQL server 2005 Express Editionで考えています。 容量はMAX４ＧＢと聞いているのですがデータの規模は4ＧＢで問題ありません。 SQL server 2005 Express Editionでクライアント９台同時接続できるのでしょうか？ 費用をかけれないので無償のSQL server 2005 Express Editionで考えています。 可能かどうか知りたいのです。９台の同時接続で運用にも耐えれるのかも疑問です。Express Editionでは無理があるのかも知りたいのです。 無理であれば今ある資産を利用して費用をかけないで済む方法があれば助かります。 どうぞよろしくお願いします。
本番環境にて、SQL SERVER ENTERPRISE MANAGERを使用していたところ、フリーズしてしまい「応答なし」となってしまいました。どうしたらいいのでしょうか？？？
お世話になります。 SQL Server 2005 Expressを使用しています。 ローカルにあるdbをbcpを使って、エクスポートしていますが、 エラーが表示されて、エクスポートできません。 どなたかお分かりになる方はいらっしゃらないでしょうか？ よろしくお願いいたします。 試したことは、下記のエラーがあるように、 スタートから、[SQL Server 2005]→[構成ツール]→[SQL Server 構成マネージャ]を起動し、 その中で、SQL Server 2005 ネットワーク構成から、SQLEXPRESSのプロトコルを参照し、名前つきパイプとTCP/IPを"有効"に変更し、 サービスを再起動 →かわりなし [bcpの実行命令]コマンドプロンプトから実行 bcp db1.dbo.test out D:\work\test.txt -T [エラー] SQLState = 08001, NativeError = 2 Error = [Microsoft][SQL Native Client]名前付きパイプのプロバイダ：SQL Serverへの接続を開けませんでした[2]. SQLState = HYT00, NativeError = 0 Error = [Microsoft][SQL Native Client]ログイン　タイムアウトが時間切れになりました SQLState = 08001, NativeError = 2 Error = [Microsoft][SQL Native Client]サーバーへの接続確立時にエラーが発生しました。接続先がSQL Server 2005である場合は、規定の設定ではSQL Serverがリモート接続を許可していないことが原因である可能性があります。
お世話になります。明日から仕事で使うのですが、下記の構文が よく理解できません。宜しくお願い致します。 SQL Severは経験ありません。 経験はInfomixSql,Access,MySql程度です。 (1)行副問い合わせ（副問い合わせの結果が１行ｎ列で返ってくる） SELECT * FROM t1 WHERE (c4, c2) = (SELECT MAX(c1), 'a' FROM t2); このwhere節の結合条件はどのような感じになるのでしょうか？ (2)表副問い合わせ（副問い合わせの結果がｍ行ｎ列（表）で返ってくる） SELECT * FROM t1 WHERE c4 IN ( SELECT c1 FROM t2 WHERE c4 >= 10 ) ORDER BY c1; 、 SELECT x1.c1, x2.y4 FROM t1 x1, ( SELECT c3, SUM(c4) AS y4 FROM t2 GROUP BY c3) AS x2 WHERE x1.c3 = x2.y4 ORDER BY c1; (1)に同じです。 参考になりそうなサイトでも結構ですので 宜しくお願い致します。
SQLサーバで、あるテーブルのレコードを、何らかのプロセス（端末）が削除しているのですが、そのプロセス（端末）がわかりません。そのテーブルに、どこからアクセスが来ているのか？わかる手だてはあるでしょうか？ よろしくお願いします。
例えばselect文でレコードを取得する際に 関数などを利用しA列の下4桁を*表示に置き換えることは可能でしょうか？ フレームワークの都合上select文でレコードを取得してから プログラムで下4桁を*表示に変換する、といったことができません。 よろしくお願いします。
MSDE1.0をスタンドアロン端末で使用しておりますが、アプリ(VB6で作成）を起動した状態で、LANケーブルを挿し直すと、ネットワークエラーが発生してしまい、異常終了します。 どなたか、解決方法を教えていただけませんでしょうか。 なお、当方の環境は、 OS:WindowsXP SP2 プログラミングツール：VB6.0 データベース：MSDE1.0 SP4（SP2でも同様でした。） データベースの接続方法は、ADOを使用しています。 以上、よろしくお願いします。
質問があります。 既に作成されてあるテーブルの CREATE文を見ることってできますか？ 方法をご存知でしたら教えていただけないでしょうか？
WinXPpro SP2 で SQL Server 2005 試用版をテストしてきました。 このたび新規にハードを購入 2003 Server 上でSQL Serverを正規に立ち上げました。 このセットアップ作業中にテストしていたSQLの試用版の期限が切れて、アクセスできなくなってしまいました。この間手を入れてきたテーブルを正規の新サーバに移したいと思っています。 期限切れの試用版サーバからテーブルを抽出する方法を教えていただけませんか？
いつも初歩的な質問ばかりで済みません。 VB.NET2003＋Access2000で開発していたアプリをSQL SERVER 2005　に移そうと作業しています。 まずMSDE2000Aをインストールし、同じマシンにあるMDBからコンバートしたMDFファイルにはアクセス 出来ました。 SQL server 2005 Express に変更しましたが、これもうまく接続・更新が出来ていました。 そして今度は別のマシンにWindows SERVER 2003 R2評価版をインストール、次いで SQL SERVER 2005 Express をインストールしてそのサーバーへデータベースファイルをデタッチして移しました。 クライアントからマイネットワークをたどっていくと共通ディレクトリはちゃんと見え、 MDF以外のファイル（XLSやMDB等）はちゃんと読み書きが出来ます。 ただ肝心のMDFファイルにアクセス出来ません。 接続しにいくと「サーバーが見つからない」とか「接続が拒否されました」等々無情なメッセージばかり返ってきます。 どこをチェックしたらいいのか、ご教示に従って補足していきますのでどうぞよろしくお願いいたします。
教えてください！ ExcelVBAの[intNo]と[strNamse]を ADOでSQLServerにレコード追加するにはどうしたらいいのですか？ [ExcelVBA] Dim intNo as Integer = Range("A2")の値 Dim strName as String = Range("B2")の値 [SQLServer] Data Source= NetworkPC1 Initial Catalog= DataBase1 ID=aa Password=123456 テーブル= Syain 列1= No 列2= Name
MSDEを使用しており 誤ってadpファイルの中のテーブルを削除してしまいました。 元に戻すことは無理ですか？ （；＿；）
インデックスについて教えてください。 データベースの項目にFirstNameとLastNameがあり、 AND検索のためにFirstNameとLastNameに複合インデックスを 設定しました。 でもFirstNameとLastNameのそれぞれ単独でも検索を するような場合、FirstNameとLastNameの複合インデックスに 併せて、それぞれ単独のインデックスを作成する必要が あるものでしょうか？ よろしくお願いいたします。
クエリアナライザ、sqlcmdなどでselectを実行した場合、処理結果レコードの最終行の後に(x 行処理されました)が必ず表示されてしまうのですが、表示させない方法をご存じの方、ご教示いただけないでしょうか。 select結果をテキストファイル出力したものをそのままプログラムで使用したいのですが、最終レコードの後に(x 行処理されました)の行など数行が余分にあるため、毎回テキストファイルを開いて手作業で消さなくてはならず、困っております。
タイトルの通り、SQLServer2000 UDPポート1434を有効にしたいのですが 方法がわかりません。 ご存知の方、ご教授宜しくお願い致します。
初めて投稿いたします。 失礼等ございましたら、お伝え下さい。 過去の質問も検索したのですが、それらしいものが見つけられませんでしたので、新たに質問させていただこうと思いました。 もし、過去に同様の内容がございましたら、教えていただければ幸いです。 さて、質問内容ですが、 当方SQLについて少しかじった事がある程度の初心者です。 先日、上司にEXCELで「注文書の台帳から条件を指定し抽出できるツール」 の作成を頼まれました。 台帳はSQL-Serverで、 ツールはExcelのVBAで作成しています。 そこで質問なのですが、 台帳には注文Noと注文No枝番というフィールドがあります。 注文書は新規で注文書に起票した際に振られる番号で、 注文書が変更される度に、枝番が1、2・・・と１つづつシーケンスで 増えていきます。 現在、単純に条件を入力して、台帳の全項目の情報を出力するところまでは作成できたのですが、注文書Noが同一で枝番が複数ある場合、最も枝番が大きいレコードを抽出するというSQL文を記述したいのですが、 どのような命令文を使えばいいのか分かりません。 例） No　注文書No　注文書No枝番　契約者名　　　住所 １　１００１　１　　　　　　○○商社　　　東京都・・・ ２　１００２　１　　　　　　○○会社　　　千葉県・・・ ３　１００２　２　　　　　　○○会社　　　千葉県・・・ ４　１００３　１　　　　　　株式会社○○ この場合、No１、３、４の全項目を抽出したいのです。 方法は複数あるのかとは思いますが、いくつか教えていただければ幸いです。 よろしくお願い致します。
aspで作成したWEBアプリから、他マシンのSQLServerへ接続を行なっています。あるSQLServerへは接続できるのですが、異なるマシンのSQLServerへは接続できない等、現状、マシン毎のSQLServer接続可否が異なっています。 接続できない場合、下記エラーを表示します。 Server 2005 に接続しているときときにこのエラーが発生した場合は、SQL Server の既定の設定がリモート接続を許可しないようになっていることがエラーの原因である可能性があります。 (provider: 名前付きパイプ プロバイダ, error: 40 - SQL Server への接続を開けませんでした) このエラー内容を元に、WEB上で検索を行い、 http://www.microsoft.com/japan/sql/ssj/tips/01.m … 、また、プログラム側の接続部分を DataSource=データソース　→　DataSource= tcp: データソース 等、試してみましたが、問題は解決しませんでした。 解決方法をご存知の方、ご教授宜しくお願い致します。 また、こうしたらどうなの？っていうようなご意見も お待ちしています。 ・・・そういえば、udlファイルによる対象データベース接続へのは 成功しています。
シーケンスまたはオートインクリメントをMSDE2000の環境で行いたいと考えています. 確かそういったものはMSDE2000には実装がなかったような気がします. 擬似的にそのような動作をさせる良い方法は無いものでしょうか.
Windows2000ServerとSQLServer2000を使用しています。 端末の台数は２０台未満と少ないのですが、今までは、データベースアクセス時に SQLServer認証で使用していました。 クライアントPC起動時に、今まではパスワードも無しだったのですが、 セキュリティ面を考えて、Windowsのパスワードをユーザーにつけることにしました。 ところが、パスワードをつけると、サーバーのデータ―ベースを開こうとすると 「接続出来ませんでした。 SQLState:'28000' SQL Server エラー：18452 〔Microsoft〕〔ODBC SQL Server〕〔SQL Server〕ユーザー'(null)'のログインに失敗しました。 理由：SQL　Serverの信頼関係接続に関連付けられていません。」 となって、データ―ベースにアクセス出来なくなってしまいます。 名前付きパイプの信頼関係接続も有効になっているし、マルチプロトコルも無効になっています。 どうしたらデータ―ベース接続時にエラーが出ないように出来るでしょうか？
現在稼動中のNEC製クラスタプロ LE Ver7.0にSQLServer2000 SP3aが方系にのみ適用済みの状態であることが判明し、もう方系にもインストールする必要が発生しております。 この際にインストールを行うための手順について、注意点などがありますでしょうか。 環境 OS:WindowsServer 2003 SP1 DB:SQLServer2000（方系のみSP3a） システムDBは両方が個別に保持して、ユーザDBのみ共有している状態です。 小生知識が不足しているために、ご指導いただくための情報が不足しているとは思いますが、ご指導の程よろしくお願い致します。
Visual Web Developer 2005 Expressを使用しています。 NO（自動採番）と商品というテーブルがあり、入力フォームでテキストボックス1に「飴」と入力し、テキストボックス2に「5」と打って保存すると下記のような結果になるようなSQL文はありますか？それともフォーム側で何か処理が必要でしょうか？ 複数インサートで調べましたがINSERT INTO SELECTはデータ元が別テーブルなので使用できそうにありませんでした。。 No|商品　　 ――――　 01|飴 02|飴　 03|飴 04|飴 05|飴 うまく説明できているかわかりません。すみません。
VS2003とSQL Server Management Studio Expressを使用して VB.NETでデータベースを利用したプログラムを学んでいます。 その中でdetasetというものを習ったのですが 取得したdatasetが破棄されるタイミングがわかりません。 プログラム内で破棄するようなコードを書いていない場合 datasetはどのようなタイミングで破棄されるのでしょうか？ 過去の質問を検索しましたが発見することができませんでした。 もし、過去に同じような質問がありましたらそちらのURLを教えて頂ければ幸いです。 あまり理解できていないため、おかしな表現などあるかと思いますが 回答をお願いします。
お世話になります。 SQLについて教えてください AテーブルとBテーブルからCテーブルを作成したいのですが、 KEYをキーにAテーブルのIDが1で、YYMMが一番新しい項目（最大の項目）を 取得し、Cテーブル作成したいのですが、どのようにするのでしょうか？ Aテーブル　　　　Bテーブル　　　Cテーブル KEY ID yymm　　　KEY 　　　　KEY　YYMM AAA 0 200612　　AAA　 　　　AAA　200611 AAA 1 200611 　BBB 　　　　BBB　200611 AAA 1 200609 BBB 0 200611 CCC 1 200611
SQlServer 2000 のＳＱＬでのDatetimeの変換方法 datatime型データの年月部分（YYYYMM) だけデータをつくりたいのですが、方法を教えてください。
SQLServer2000 SQL文について Where句内で、このような演算指定はできますか？ できない場合このようなSQLを実行したい場合 他にどのような方法が考えられますでしょうか？ select a.id from a,b where a.yymm = b.yymm-1
MySQLは良く使っていますが、たとえばテーブルの型情報などは、SHOW [FULL] COLUMNS FROM tbl_name テーブル名で得ることができますが、SQLServerでは、どのようにするのでしょうか？ また、MySQLからSQLServer移行者にとって、注意すべき点などご存知の方教えて下さい。また、SQLServerのお勧め書籍も知りたいです。
tsql初心者です。 ふと疑問なのですが、例えば・・・ test t列 １ ２ ３ ※一列のみとする。 というテーブルがありまして この列の最小値を探したいとする。 select min(tr11) from TR1 group by tr11 を実行すると同じ結果となってしまう。。 少ない場合はともかく 最小値を探すためにはどのようにするのでしょうか？ 低レベルな質問ではありますが、宜しく御願いします。
Visual Web Developer 2005 Express始めたばかりの初心者です。 簡単な受注管理のDBを作成しているのですが、営業日の数え方について教えてください。 test01テーブルに受注日という項目があり、経過日数という項目で受注日と今日の日付の差を出しています。 SELECT (int,GETDATE()-jutyubi) AS Expr1,jutyubi FROM test01 受注日から今日までの差を表示するのではなく、受注日から今日までの営業日を求めたいのですがどのようにすればよいでしょうか。 営業日は土日の除いて考え、国民の休日が設定できればよりいいです。 エクセルのNETWORKDAYS関数のようなイメージをしています。よろしくお願いいたします。
SQLSERVER7.0のクエリアナライザで抽出結果をファイルへ保存する際、ダイアログボックスでファイルフォーマットの指定が出来ましたが、SQLSERVER2005のManagementStudioのダイアログボックスには指定がなく、ANSI形式（カンマ区切り）で抽出結果をCSVファイルに保存したい場合はどのようにしたらよいでしょうか？どなたかご教授よろしくお願いいたします。
SQLServer2005でfloat型の項目に-3.34 を手入力（クエリアナライザでinsert文で入力した時も同様）して、コマンドプロンプトから以下のselect文を実行した所、-3.3399999999999999 で表示されました。 sqlcmd -U ユーザ名 -P パスワード -d データベース名 1> select * from テーブル名 クエリアナライザで同様に　select * from テーブル名 した場合は、-3.34　のまま正しく表示されます。 -12.34、-22.34などの数値ではこの事象は発生せず、何か条件があるようです。お分かりになる方がいらっしゃいましたら、ご教示いただけないでしょうか？
例えば　テーブルＡとテーブルＢがあり 両方に顧客ＩＤ、店舗ＩＤがあります。 もしテーブルＡ、Ｂのレコードで 顧客ＩＤ、店舗ＩＤが同じなら テーブルＡのみレコード削除したいです。 このような場合のＳＱＬ文を教えてください。 よろしくお願いします。
すいませんが問題が微妙にずれたので立て直しさせていただきます。 SQLServer2000のユーティリティである「sqlmaint.exe」って ネットワーク越しに実行することってできないんでしょうか？ 共有設定等は済んでいるのですが、どうしても実行できません。 客先へのリリース前のテストでは問題なく実行できていたはず なのですが。。。 どなたかご教授よろしくお願いいたします。
毎度お世話になっております。今回もよろしくお願いいたします。 環境：WindowsServer2003、SQLServer2000 インデックス再構築を行うバッチファイルを作成しているのですが、 エラーコード、エラーメッセージの出力方法がよくわかりません。 以下のような書き方をしてみたのですが返り値は-1073741515と なっており、ユーティリティのエラーなのかコマンドプロンプトの エラーなのかわかりません。 "\\jdn-svr\Binn\sqlmaint" -S JDN-SVR -U acdb -P acdb -D Support -RebldIdx 100 @echo ERRORLEVEL(ＤＢ最適化処理開始[%DBNAME%])=%ERRORLEVEL% 目的としてはユーティリティのエラー原因が調査可能なログにすることです。 どなたかご教授よろしくお願いいたします。
ジョブでバッチ処理を作成していますが、テーブルからある数式を文字列として取得し、文字列内にある変数を実際の値と置き換え、それを数式として処理する必要があります。 T-SQLにはその機能がないため、vbsのEVAL関数を使って処理しようと考えています。 テーブルから取得した数式を直接SQL文に記述し、「数式 AS フィールド名」として取得しようとも考えましたが、数式に^(べき乗)が存在し、数式をT-SQLに変換することが複雑になってしまうため、あきらめました。 SQLServerのジョブ(もしくはストアドプロシージャ内)からパラメータを与えてVBSを実行させ、VBSより結果を返してもらうコーディング(設定)はどうすればできるのでしょうか？
お世話になります。 SQL SERVER 2000 で質問させてください。 クエリ（SELECT文）の結果をCSV形式のファイルに落としたいのですが、バッチファイル（osqlでクエリ実行）からクエリを実行して、指定したディレクトリにCSVファイルを作成する方法を教えてください。 よろしくお願いします。
お世話になります。 ただ今、VB.NETでODBCデータソースを追加するPGを作成しています。 ネットワークライブラリを「名前付きパイプ」とした場合、Administrators権限やPowerUsers権限のユーザーで実行すると問題なくODBC登録できるのですが、UsersやGuestsではTCP/IPのデフォルト値でODBC登録されてしまいました。 そこで「ODBC データソース アドミニストレータ」にてDSNの「クライアントの設定」を変更しようとすると以下のメッセージが表示されます。 「この操作を実行するために必要なアクセス許可がログイン アカウントにありません。使用中のWindowsレジストリに必要なアクセス許可を取得する…」 単純にWindowsレジストリに対するアクセス権限が無いとのことなのですが、アクセス権を得るためには何の権限を実行ユーザーが持っている必要があるのでしょうか？？ ご教授お願い致します。
Ｔ－ＳＱＬである値を計算し、その結果を返したいのですが、数式に小数点のあるべき乗があり、どうすれば取得できるのか悩んでいます。 VBで記述するところの x^6 は x*x*x*x*x*x で記述することはわかるのですが、x^2.2となるとどうやっていいのか見当がつきません。 ご教示いただければ幸いです。
数値型データを文字型データに変換する場合、元データが負の値であれば、文字列の先頭に"-"が入りますが、負の値でない（０を含む）場合に文字列の先頭に"+"をセットする方法がございましたら、ご教示いただきたくお願いいたします。 （変換前） 123.45 -12.34 0.0 （変換後に期待する形式） +123.45 -12.34 +0.0
Microsoft SQL2000を使用しているのですが あるテーブル(table_A)のカラム(column_A)を削除したいので 以下のようなクエリ及び、GUIでの削除を実行しました。 ----------------実行クエリ----------------------- ALTER TABLE dbo.table_A DROP COLUMN column_A GO ------------------------------------------------- ところがどちらの削除を方法を実行しても以下のようなエラーメッセージが返されます。 -----------------エラーメッセージ---------------- テーブル 'table_A' - テーブルを修正できません。 ODBC エラー : [Microsoft][ODBC SQL Server Driver][SQL Server] 行 2: 'column_A' の近くに無効な構文があります。 ------------------------------------------------- カラム名の変更などはできるのですが どうしても削除だけ出来ません。 なお、このカラムは主キーとしての設定や 他のテーブルへの外部キーとしての設定を行っていません。 型は[varchar] (20) COLLATE Japanese_BIN NULLです。 どなたか対処方法をご存知の方がおられましたら ご回答よろしくお願いします。 それでは失礼します
データベースのデータを企業間で転送する際 現在、相手先に送信するテキストデータにフィールド名がなく 分かりづらい為、フィールド名を追加するように情報システムに依頼したら、通常、相手先にデータを転送する場合、フィールド名を挿入するのは常識はずれと一蹴りされてしまいましたが、それは本当なのでしょうか？データの内容は、支払明細書で経理担当の方がデータを開いた際に、分かり易いようにフィールド名を追加たいと思います。
　データの管理をWin XP Proのパソコンで行おうと思っています。 　そこで、SQL Server Standard Edition はサーバー管理する際に必要なソフトであると聞きました。 　また、SQL Server Personal Edition はスタンドアロンで使用するとき用のソフトであると聞きました。 　では、SQL Server Workgroup Edition はどのようなときに使用出来るソフトになるのでしょうか。 　また、基本的にどのソフトも機能は同じでしょうか。 　分かる方、教えてください。お願いします。
はじめまして。 SQL　SERVER初心者の為、ご指導の程お願いいたします。 UPDATE文で発生するデッドロックについて教えてください。 現在、ストアドプロシージャ内で、 以下のUPDATE文を使用しています。 UPDATEテーブルＡ SET 更新済フラグ='1' WHEREロック時間 =パラメータ．ロック時間 ANDロックユーザー=パラメータ．ロックユーザー AND ＩＤ= パラメータ．ＩＤ ※Where句に使用する、ロック時間・ロックユーザー・ＩＤは、 　キー項目では無く、インデックスも使用しておりません。 　ただし、対象データを一意に識別できる項目ではあります。 　 このストアドを含む処理を、ほぼ同時実行すると このUPDATE文で「LOCK　TIMEOUT」が発生し、 デッドロックとなってしまいます。 UPDATEの対象となるデータ件数は、ともに５００～６００件です また、対策としましてロックのヒント文を下記のように設定し、 WHERE句に設定している、ロック時間・ロックユーザー・ＩＤに 対して、インデックスを作成してみましたが、 同様に、デッドロックが発生してしまいます。 UPDATEテーブルＡ （with　rowlock） SET 更新済フラグ='1' WHEREロック時間 =パラメータ．ロック時間 ANDロックユーザー=パラメータ．ロックユーザー AND ＩＤ= パラメータ．ＩＤ SQL　Serverに詳しい方、お力になっていただければ、光栄です。 よろしくお願いいたします。
お世話になります。 客先より、SQL Server2000のEnterprise ManagerでCASEを含むSQLを実行したら 「case SQL構成はサポートされていません」とエラーが出たと連絡が入りました。 自分のマシンに入っている同ツールで実行すると、エラーは出ません。 客先と自分のマシンのSQL Server2000の違いは、バージョンなのですが、 古いバージョンだとcase文がサポートされていないということはあるのでしょうか？ 自分のマシンは最新バージョンが入っています。 SQL文の内容的に、case文が必要なので、代替案も思いつかず、困っています。 よろしくお願いいたします。
例えば ============================= 1,"東京都品川区","千葉" 2,"東京都杉並区","埼玉" 3,"東京都大田区","神奈川" ============================= というようなマスターがあり、住所を基に検索をかける ことは可能ですか。 住所が"東京都大田区ＸＸＸ１－２－３"であった時は ３番目の"神奈川"の値が欲しいのですが。
すみません、いつもお世話になっております。 以下のようなＤＢの内容の場合、契約日が現在の年月から1年以内のみ抽出して 面積を合計する　というSELECT文を書きたいのですがよく分かりません。 宜しくお願いします。 ※現在は2006年01月ですので条件は契約日が2005/01/01～現在日付となります。 ＤＢ名 物件情報 物件番号　　　契約日　　　 面積 1 　　　 2006/01/12 　　 24.35 2 　　　 2005/10/01 　　 30.01 3 　　　 2004/12/10 　　 18.22 4 　　　 2005/08/20 　　 24.00 5 　　　 2005/04/07 　　 38.75
いつも御世話になっております。kage55です。 ご存知の方いらっしゃいましたらご教授ください。 あるサーバのEnterpriseManagerを立ち上げようとするとエラー画面が表示され、立ち上がらないという現象が起きています。 WindowsOS：Windows2000Server SP4 SQLServer:7.0 エラー画面詳細：Runtime Error! Program:C:\WINNT\system32\mmc.exe R6025 - pure virtual function call (※尚、メッセージには「OK」しか返すことが出来ません) 検索し調べたところ、マイクロソフトに本現象についての対応がありました。(下記URL参照ください) ↓ http://support.microsoft.com/kb/297064/ja ですが、アイコンのないスナップインが存在しなかったため、本現象解消にはいたりませんでした。 そこで上記URLの手順にあるようにエラーメッセージを無視し、[コンソール]⇒[スナップインの追加と削除] ⇒[追加]ボタンからMicrosoft SQL Enterprise Managerをダブルクリックすると以下のメッセージが表示されました。 ********************************************** スナップインを初期化できませんでした。 名前： Microsoft SQL Enterprise Manager CLSID: {00100100-1816-11D0-8EF5-00AA0062C58F} ********************************************** このため、追加することが出来ませんでした。 system32上にあるmmc.exeを入れ替えたりいろいろ検証してみましたが未だ解決には至っておりません。 どなたかご存知の方ご教授ください。 不明点・ご質問等ございましたら何なりとお申し付けください。 よろしく御願いいたします。
現在SQLServerを使用した、Webアプリケーションの製作を行なっています。 そのデータベース内で、親子関係があるテーブルを使用しており、親テーブルの主キーIDを、子テーブルの外部キーに設定しています。 親テーブルの主キーIDはidentityを使用して連番にしています。 親子関係があるテーブルは、親が登録されると、すぐに子のテーブルにもデータを追加するという形で、親テーブルが追加された直後に親テーブルの主キーIDをMAX関数を使用して取得し、子テーブルに登録しております。 このやり方ですと、通常は問題は無いのですが、同時に連続してアクセスがある時に、親テーブルの主キーIDを取得する際に、ずれが生じたりして正確な親子関係にならない場合があります。 この手法は一般的な手法ではないのでしょうか？また、何かいい対処法はございませんでしょうか？ お力をお貸しください。よろしくお願いします。
MSDE2000 Release Aをインストールして SQL Server Management Studio Expressを使い 最近SQLを学んでいるのですが CREATE VIEWを使うとエラーメッセージとして 'CREATE VIEW' は、クエリ バッチの最初のステートメントでなければなりません。 というような表示がされてビューを作成できません。 この場合どのようにすればこのエラーがなくなり、ビューを作成できるのでしょうか？ どなたか教えてください。よろしくお願いします。
SQLServerについて質問させていただきます。 ・トランザクションを開始せずにINSERT文を発行した場合 ・トランザクションを開始してINSERT文を発行した場合 上記の2ケースでは、まったく同じINSERT文でも 開始して発行したほうが 処理が速いという状況になっています。 (Management Stadioで発行) SQL Server Profiler にて確認して、処理時間、CPUの使用時間ともに明らかな差があります。 トランザクションを開始してる状況の方がINSERT文は速い、というのはなにか設定で変えられるのでしょうか？それとも仕組みとして当然そういったものなのでしょうか？(コミットするまでは物理的に書き込まないから、などの理由で) 判断が付かず、非常に困っています。そういう仕組みであるというならば、そういう想定でプログラムを修正するのですが、根拠がわからず、修正に入ってよいかどうか困っています。 本当に困っておりますので、どんな手がかりでもよいのでお教えいただけたらと思います。宜しく御願いいたします。
Oracleの数値→文字型変換では 　SELECT TO_CHAR(売上金,'FMS0000000D00') FROM XXX_TABLE のように文字型に変換する時に先頭に符号(+または-）をつけ、指定 した位置に小数点（ピリオド）をつけ、桁数に満たない部分（左側） には「0」をセットする事が可能です。 上記例で「売上金」の属性がNUMBER(9,2)、値が 123.4だとした場合 処理結果として文字列"+0000123.40"が得られます。 これと同じ変換を「SQLServer2000」で行う事になってしまいました。 SELECT STR(売上金,11,2)などとしてみましたが、 　"　　　　　+123.40" のように左側が半角スペースになり「0」を 　　セットする事ができません。 　SELECT CONVERT(CHAR(11),売上金,n）でも同様のようです。 SQLServer2000 どのようにすればできるか（あるいは不可能であるか） ご存じの方がお見えでしたら、ご教示いただけないでしょうか？
Oracleの数値→文字型変換で 　SELECT TO_CHAR(売上金,'FMS0000000D00') FROM XXX_TABLE のように文字型に変換する時に先頭に符号(+または-）をつけ、指定 した位置に小数点（ピリオド）をつけ、桁数に満たない部分（左側） には「0」をセットする事がどうしても必要になってしまいました。 　上記例で「売上金」の属性がNUMBER(9,2)、値が 123.4だとした場合 　処理結果として期待する文字列は、+0000123.40 です。 これと同じ変換を「SQL Server2000」で実行したいと思い、 SELECT STR(売上金,11,2)などとしてみましたが、 　"　　　　　+123.40" のように左側が半角スペースになり「0」を 　　セットする事ができません。 　SELECT CONVERT(CHAR(11),売上金,n）でも同様のようです。 SQLServer2000 どのようにすればできるか（あるいは不可能であるか） ご存じの方がお見えでしたら、ご教示いただけないでしょうか？
こんにちは。 Access2000で作成したadpにてDB（SQLServer2005）に接続したところ、 Access上で認識しているストアドプロシージャの名前の最後に「;1」という文字がついてしまいアプリケーションエラーになってしまいました。 ルーターを越えた異なるサブネット環境から接続サーバーをIPアドレスで指定した場合には発生しませんで、 SQLServerと同一サブネット内で発生しております。（この場合、接続サーバーをIPアドレスで指定するとエラーになりました。） ファイアーウォール等の制限はありません。また、名前が変更されてしまう同一サブネットの環境ですと違うユーザー（SYS等）のストアドも表示されております。 まったく原因が判らないのですが、改善策、お気づきの点等ありましたらご教授お願いいたします。
SQL Serverで日本語の文字列を格納する型について質問させてください。 日本語文字列の格納にはnvarcharとntext型がありますが、全部 ntext型にしてもよいものでしょうか？ 全部ntext型にした場合、何か都合の悪いことがあるのでしょうか？
基本的にデフォルトの状態でインストールしたSQL SERVER 2005があるのですが、ログインしようとしましたが方法がわかりません。 SQL SERVER 2000では、Enterprise ManagerというツールでWindwos認証やSQL Server認証でログインできるツールがあったのですが、2005では スタートメニューから探しても見当たりませんでした。 osql -U -Pでも試したのですが、SAというアカウントでパスワードはデフォルトで何が入っていたのでしょうか？ SQL SERVERを体系的に学びたいのですが、何か良書はありますか？
Oracleの ・SELECT TableName FROM user_tables 　(↑作成ＤＢ名取得) ・SELECT TableName FROM All_tables 　(↑全てのＤＢ名取得) と同じ意味の処理を SQL Serverで実行したいのですが どのようにすればできるのでしょうか？
まだまだ初心者ですがよろしくお願いします。 以下の条件でＤＢからデータを抽出したい場合のＳＱＬを 教えていただきたいです。 ・テーブルＡがありカラムがＡ、Ｂとある。 ・Ａは重複できないようになっているがＢは重複可。 ・Ｂが重複しているレコードのＡの値が欲しい。 環境はSQLServer2000＋VB6.0です 情報が足りないかも知れませんがよろしくお願いいたします。
こんにちは、SQL初心者です。 値を判定して、trueなら「*」をfalseなら表示なしとするのですが、 判定項目がかなりありまあす。 case文だとtrue、falseで二通り書かないといけないと思うのですが、簡単な方法はありますか？ if文みたいにelseを使えればいいのですが。
SQL Serverの初心者です。 テーブルやView、ストアドを見たり変更したりする場合に、SQL Serverとクエリアナライザを使いますが、 この２つのソフトの違いは何なのでしょうか？ 片方だけでというわけにはいかないのでしょうか？ テーブルの値変更やストアドを作るのは、どちらでもできますが、 SQL Serverでストアドを単体実行はできませんよね。 この辺りの微妙な違いが何なのか・・・
SQL Server 2005で、調和平均を使うクエリを作りたいのです。 ExcelならばHERMEAN関数を使えば一発で出ますが、ＳＱＬにはないですよね？ CREATE FUNCTIONを使うか、クエリだけでいけるのかよくわかりません。 自分でクエリを書いてみたのですが、なにぶん初心者で、データがゼロの場合にエラーになったりしてうまくいきません。 どうすれば一番簡単に作れるでしょうか。
はじめまして。 プログラム初心者なのですが、 クライアントからサーバーへアクセスする データベースプログラムを作る事となりました。 サーバー側には Windows 2000　と SERVERとSQL SERVER 7.0 を、 クライアント側にはWindows XP Pro と　SQL SERVER　2005　と プログラミングにはVisual Studio 2005 (VB.NET)をインストールしています。 サーバーエクスプローラーからサーバー側データベースへの 接続設定を試したところ、 以下のようなエラーメッセージが発生しました。 『Microsoft Visual Studio 　このバージョンのサーバーはサポートされていません。 　Microsoft SQL Server 2000かそれ以降が必要です。』 MicrosoftのHPやヘルプを参照したのですが、 はっきりとした原因がわかりませんでした。 そもそも互換性が無いのでしょうか？ 説明不足の面もあるとおもいますが、 以前このようなメッセージが表示された方や解決された方、 教えていただけますでしょうか？ よろしくお願い致します。
SQLServer2005ExpressEdition（無償版）でのAccessからのアップサイジングは可能かどうかご存知のかたいらっしゃいますか？ アップサイジングの方法は 各ファイルをアップサイジングウィザードに従って、進めていけばいいのですよね？？
現在、内部ネットワークにあるAccessアプリケーション上から、外部ネットワークSQL Server へのリンクテーブルを作成しております。 本AccessアプリケーションをどのPCや、環境にコピーしても外部ネットワークのSQLServerにアクセスできるように、リンクテーブルを設定したいと考えております。 SQL Server のプロパティは、混合モードにしています。 ODBCも、以下のようなdsnファイルを作成し、リンクしようとしているのですが、「ユーザー'(null)'のログインに失敗しました。理由：SQL Server の信頼関係接続に関連付けられていません」とエラーがでて、必ずパスワードが聞かれてしまいます。 [ODBC] DRIVER=SQL Server UID=sa PWD=XXXXXX Network=DBMSSOCN DATABASE=test_dns WSID=PCName APP=Microsoft Office 2003 SERVER=XXX.XXX.XXX.XXX Description=Test パスワードを回避する設定方法はありますでしょうか？
次のような操作がしたいのですが、 Test1 t1 1 2 Test2 tt1 tt2 tt3 1　　1　　aa 1　　2　　bb -ココ 2　　1　　cc 2　　2　　dd 2　　3　　ee -ココ 結果 Test1とTest2を関連付けて t1 tt1 tt2 tt3 1　1　2 aa 1　2　3 ee Test2.tt2をマックス関数での参照です。 一応次のような操作をしてみました。 select T1, X.tt1, X.tt2, X.tt3 from Test1 inner join (select tt1, max(tt2) as tt2, tt3 from Test2 group by tt1, tt3) as X on (t1 = X.tt1) group by句にtt1とtt3を付けいるせいか、 すべて(Test1とTest2)が表示されます。 groupBY句の制約のせいですが・・・ 何かアドバイス等がありましたら、宜しく御願いします。
次のような操作をしたいのですが、 Table1 CD 1 2 3 Table2 ID TT 1 1 1 2--ココ 2 1 2 2--ココ 結果 Table1とTable2を関連づけて CD ID TT 1 1 2 2 2 2 Table2のTTをMAX関数を使っての参照です。 ちなみに次のようなSQL文ではエラーとなりました。 select T1.CD , T2.ID , MAX(T2.TT) from Table1 T1 INNER JOIN Table2 T2 ON(T1.CD = T2.ID) GROUP BY T2.ID アドバイス等がありましたら、宜しくお願いします。
クリックありがとうございます。 先日、先行でチケットをとるページでチケットの予約をしました。 そのときはまったく問題がなくページにアクセスできたのですが 2日ほどまえから Microsoft OLE DB Provider for ODBC Drivers エラー '80040e07' [Microsoft][ODBC SQL Server Driver][SQL Server]構文エラー。varchar 値 '*****' から int データ型に変換できませんでした。 /*****/****/****/**/logon_p.asp, 行 22 というエラー文がでてアクセスできなくなりました。 チケットのあたりはずれも同じページでの確認なので困っています。 どうすればいいでしょうか？
MSSQL（SQLServer2000）にて、NOT NULLの列制約をはずすにはどうしたらよいのでしょうか。 ALTER TABLE <テーブル名> ALTER COLUMN <列名> DROP NOT NULL をやってみたのですが、構文エラーになってしまいます。 よろしくお願いします。
既出であれば、申し訳ありません。 調べ方が分からないので、質問いたします。 会社で2台のログサーバを抱えており、それぞれに SQLServerが入っています。 双方にログを貯めるDBがあるのですが、これら DBにある表を結合したいと考えています。 このようなことができるのでしょうか？ 仮にできるとしたら、こういう結合をなんと呼ぶの でしょうか？ 教えてください。
こんにちは。 Enterprise Managerにてインポート（エクスポート）を行う場合、テーブル定義とデータはインポートされるのですがPrimaryKeyやIndexはインポートされません。 同時にインポートすることは可能でしょうか？ また、Viewやストアドはインポートでいますでしょうか？ よろしくお願いいたします。
ACCESSからSQLSERVERに変更する時 どのような時に変更すべきですか？ 現在 サーバーをWindowsNT4.0Server データベースは、複数のMDB（ACCESS）を使用し 累積データ件数は、１０万件で 日次更新、月次更新など 更新時間を短縮したいと思っています。 そのためサーバーをWindowsNT4.0Serverから Windows2003サーバーに仮に移行したら 日次処理が１０時間から１時間に短縮しました。 （データベースは、ACCESSのままです） サーバーだけ変更したほうがよいか？ それともデータベースも変更したほうがよいですか？ 教えてください。 よろしくお願いします。
kage55です。皆様には大変御世話になっております。 現行SQLServer2000を使用しております。 (一部SQLServer2005を使用しています。) 業務としてはデータベースの管理をしております。 ☆例といたしまして ○2000A ○2000B という二つのサーバがあります。 2000Aサーバの老朽化のため、2000Bに移行する計画があります。 そのため、2000Aにあるデータベースすべてを2000Bに移すことになりますが その作業が正味3時間半程を見込んでおります。 ですが、現状よりさらに時間短縮が必要ではないかと求められてしまいました。 時間短縮の手立てをいろいろ検討中ではありますが、手詰まりとなっています。 現在計画しています作業内容及び各作業の時間見積もりとしては以下となっております。 (1)2000A全データベースのバックアップ(見込み時間：約一時間半) (※リストアの時間も含まれています) ↓ (2)2000Aにある全データベースを2000Bに移行。及び2000Aにアクセス出来なくさせるため、2000Aを止める。 (見込み時間：約一時間半) ↓ (3)2000Bに移行できたことを確認し、事後動作確認作業を実施。(見込み時間：約三十分) 2000Aにある全データベースのファイルサイズの合計は約40GBです。 何か他に時間短縮のための良い方法ご存知の方は ぜひご教授いただければと思います。 ご不明点ございましたら、質問いただければと思います。 何卒、よろしく御願いいたします。
現在ブックストアの在庫数を変更するトリガーを作ってるのですが、ひとつの商品を買ったのにすべての商品の在庫数が減ったりしたりなど不具合が多くてお手上げです。 CREATE TRIGGER tg_add_BooksOrderDetail ON BooksOrderDetail FOR INSERT AS DECLARE @BooksID int,@OrderAmount int,@Stock int SELECT @BooksID = bod.BooksID, @OrderAmount = bod.OrderAmount, @Stock = b.Stock - @OrderAmount FROM BooksOrderDetail as bod,Books as b WHERE b.BooksID = @BooksID UPDATE Books SET Stock = @Stock return
AccessアプリよりSQL Server 2000にアクセスし、データを参照してます。 その時にSELECT(SQL文)でDBを参照しているのですが、その実行したSQL文を何かのログからなど確認することは可能でしょうか？ ログでなくても、コンソールなどとにかく確認できればよいのですが。。
現在Access2003とSQLServer2005ExpressEditonで勉強中の者です。 ストアドプロシージャを動的に作成したいと思い 以下のページを参考に、NorthwindCS.adpはダウンロードせず 自前で簡単に環境を作ってストアドプロシージャをつくりテストに成功しました。 http://support.microsoft.com/kb/286828/ja そこで「もし検索対象のテーブルに摘要欄があり、"未"を含む検索をしたい場合はどうすればよいか」と思い、摘要フィールド(Varchar)を作成してストアドプロシージャに変数@TEKIYO(Varchar)を作り、以下の行を足しました。 ---------------------------------------------------------------- --摘要の検索条件がNULLかどうかを確認します。 --ここに値が含まれている場合WHERE句を作成します。 IF @TEKIYO IS NOT NULL BEGIN IF @SQLSTRING IS NOT NULL BEGIN SELECT @SQLSTRING = @SQLSTRING + ' AND TEKIYO LIKE ''%''' + @TEKIYO + '%''' END ELSE BEGIN SELECT @SQLSTRING = 'WHERE TEKIYO LIKE ''%''' + @TEKIYO + '%''' END END ---------------------------------------------------------------- adpの検索フォーム摘要欄に「未」と入力し実行ボタンを押すと「実行時エラー102　'未'付近に不適切な構文があります」と出てしまいました。 シングルクォーテーションの打ち方が間違っているのだろうと色々調べたり、打ち方を変えてみたりしたのですが、解決できず悩んでおります。 正解はどうなのでしょうか？教えてください。 なにとぞよろしくお願いいたします。
うまく説明できないのですが、下記のようなテーブルがあります。 テーブル名：A 項目： A1 A2 A3 A4 AテーブルのA1項目に「5」がセットされているデータについて、 A2に123、A3に321をセットしたいのです。 うまくいかない例ですが、下記のようなイメージです。 UPDATE A set A2=123,A3=321 FROM (SELECT * FROM A WHERE A1 = '5') ちなみに下の書き方はダメです。 「SELECT * FROM A WHERE A1 = 5」の部分は、必ず使用し、変更不可です。 × UPDATE A set A2=123,A3=321 WHERE A1 IN(SELECT A1 FROM A WHERE A1 = 5) 変な質問ですいませんが、何か方法があるのでしょうか。 よろしくお願いします。
初めて投稿いたします。 皆様よろしく御願いいたします。 現在SQLServer2000を使用しております。 (若干ですがSQLServer2005も使用しております。) あるDBの全テーブルのサイズを表示させたいのですが その方法が分からず困っております。 コマンドではテーブルのサイズを表示できるようなものは見る限りありませんでした。 EnterpriseManagerも見てみましたが、サイズが表示されている箇所は見当たりませんでした。 なにぶんSQLServerを触って日が浅いので、初歩的な質問であるかとはおもいますが何かご存知の方は教えてください。 よろしく御願いいたします。
ASPからDTSをキックするにはどうしたらいいのかを調べています。環境は2003サーバになります。 また、ストアドプロシージャから、VBスクリプトから、batファイルから、DTSをキックする方法も知りたいと思っています。ぜひ、アドバイスを頂けませんでしょうか？
いつもお世話になっております。 SQL Server2000で複数のテーブルを一括でエクスポート、インポートする方法ご存知ありませんか？ 困っています。よろしくお願いします。
質問させていただきます。 SQL Server 2003で、以下のようなエラーが出ました。 --------------- 2006/xx/xx xx:xx:xx - MSSQLSERVER (17052) - "エラー : 9002、レベル : 17、状態 : 6 データベース 'tempdb' のログ ファイルはいっぱいです。ログ領域を解放するには、データベースのトランザクション ログをバックアップしてください。" 一応、”DBCC SHRINKDATABASE(tempdb)”にて、圧縮を行ったのですが、これだけでOKなのでしょうか？ バックアップについて設定しようとしたら、 -------------- MSSQLSERVER (17055) - "18204 : BackupDiskFile::OpenMedia: バックアップ デバイス 'E:\backup\tempdb.bak' を open にできませんでした。オペレーティング システム エラー = 2(指定されたファイルが見つかりません。)。" -------------------- と、叱られてしまいました。 バックアップファイルとは、あらかじめ空ファイルなどを作っておくのでしょうか？ 以下のHPを読んでみても、よくわからないので、質問させていただきました。 特集： バックアップとリカバリの克服 ​http://www.sqlpassj.org/tokushu/backup/default.a …​ よろしくお願いします。ｍ（＿。＿）ｍ
SQLは基本的なselect, insert, update, deleteは知っていますが、中級以上のことができるように身につけたいのですが、どこから手をつけてよいかわかりません。試しながらSQLが学べる問題集や学習方法など知りたいです。 HAVING句や副問い合わせなど、実践でどういう場合に使うのか想像できない（そのそも理解する力が乏しいのか・・・）ので困っています。
いつもお世話様です。 同じ項目を持っている２つのテーブルがあります。 --2000年テーブル-- 商品名金額 えんぴつ100 消しゴム200 赤えんぴつ150 --2001年テーブル-- えんぴつ100 消しゴム200 ボールペン200 赤えんぴつ150 この２つのテーブルの合計金額（1100）をSQL文一回で求めたいのですが、 どのようにしたら良いでしょう。 ユニオンで結合までは、できるのですが、SUMの方法がわかりません。 それとも、全然違う方法があるのでしょうか。 よろしくお願いします。
ビューを作成しましたが、項目の一つにデータ同士の割算が入った「項目Ａ」があります。 項目Ａにおいて、項目Ｃによっては、「0で除算しました」とのエラーが出てしまうのですが、エラーの場合は項目Ａの値を強制的に「0」にする等の設定は、ビューで行えるのでしょうか？ ------------------------------------ エイリアス　　列の値 項目Ａ　　　　項目Ｂ/項目Ｃ
一番端的な例として、 １．テーブルをエクセル形式でエクスポート ２．必要なカラムを修正 ３．修正を元のテーブルに反映 ということをしたいときに３の方法を検討しています。 #ちなみにこの例であるならば、元のテーブルの全レコードを削除して再インポートが一番早いのですが、実際にはこのように単純ではなく、反映したいデータは元のレコードの一部しかない。しかもどのレコードかは（データ数が多すぎるなどの理由で）わからない、とします。 身近に聞いたところでは、ループしてデータをEXCELから抜き出してUPDATE文を実行するプログラムを組む、という回答を得たのですが、そういった処理を簡単に実行するようなツールがSQL Server側に用意されていないか、と期待してます。 データ変換サービス（DTS）などでできないかな、と試みたのですが、うまくいっていない状態です。 良い手法をご存知の方、もしくは該当しそうな処理方法を解説しているサイトをご存知の方、ご教示願います。ちなみにSQL Serverはあまり詳しくありません・・・。
SQL Server 2005のbcpでファイル出力させたいと思っています。 すでにファイルがあるとき、データは上書きされるのでしょうか？それとも追加されるのでしょうか？
SQLについて、全くの初心者です。 とんちんかんな質問をしているかもしれませんが… SQL Server Enterpriseで、クエリアナライザを使用し、データをアップロードしたいのですが、誰にでも解るサイトや本を教えてください。 基本が全くわかりません。 どうぞよろしくお願いいたします。
SQLServer2005を使用しています。 今、ユーザー定義関数を作成していて、クエリアナライザにて動作を検証しています。 ユーザー定義関数内で、sp_executesqlを実行しようとすると、 「サーバー : メッセージ 557、レベル 16、状態 2、プロシージャ F_GET_DAY、行 26　関数内から実行できるのは関数と拡張ストアド プロシージャだけです。」 というエラーが出ます。 sp_executesqlは、マスターデータベースの拡張プロシージャに位置づけられているので、実行可能だと思ったのですが・・・。 同じく、マスターデータベースの拡張プロシージャにである「sp_oacreate」の実行を試してみると、関数内で実行できました。 sp_executesqlは、関数内では実行できないのでしょうか。
お世話になります。WorkGroup構成のWindows2003ServerにSQLServerExpressをインストールしました(混合認証モード)。その後ネットワークの構成でTCP/IPを有効化し、新しいDatabaseを作成。ユーザーも作成しました。 サーバ名：ABC /インスタンス名:DB01 WindowsXP SP2のクライアントからODBCデータソースを作成しようとするのですが「接続出来ませんでした：Serverが存在しないか、アクセスが拒否されました」というエラーがでて作成出来ません。 サーバー名の欄には、ABC　DB01両方確かめました（なぜか一覧表示には出てこない） これだけでは分からないと思います。どこから調べていけばいいのでしょうか？
SQLServerでselect文を発行して、その結果をテキストファイルまたはSDFなどに出力したいのですが、どういった手段がありますか？ ちなみにWindowsのバッチファイルで動作させたいのですが。 osql　-i　input.sql　-0　outut.txt　なんかでいきますか？ 　input.sql　はselect文を記載 限りなく素人です。
アドバイスをお願い致します。 売上、在庫管理、棚卸、受注発注システム・・・ ・現在15店舗、1店舗1,2人の為運用はPHSモバイルの予定。1店舗１台で15台 ・営業所こちらは各営業が外回り後、営業所に戻り、作業します。ブロードバンド環境15台 案１　全店舗をＶＰＮ接続。VB.2005+SQLによるデータベース。 案２　VB.2005+SQL　WEBデータベース まずは、営業所に導入後、店舗導入を検討しておりますが、どちらが良いか、 悩んでいます。他の案もどしどし募集中です。何卒よろしくお願い致します。 WEBかVPNか・・・VPNの場合はNetscreenを検討しています。
現在VB.net2005とSQLServer2005にてプログラムを組んでいます。 以下のように、サブクエリにて抽出されたStockテーブルと Tagテーブルを結合するSQL文を組みました。 *行頭は列番号です。 01-　SELECT * FROM 02-　( 03-　　SELECT A1.*, A3.* FROM 04-　　　( 05-　　　　SELECT A2.* FROM stock AS A2 06-　　　　WHERE A2.StockDay < #日付#　 '【SQLserverで流す時は "CONVERT(DATETIME, '日付')"】 07-　　　　AND A2.ShopCode = '店番号' 08-　　　) AS A1 09-　　LEFT JOIN tag AS A3 10-　　ON A1.StockNo = A3.StockNo 11-　) AS S1 これだとACCESS2000のクエリ上では正しく実行できます。 しかし、.net2005のサーバエクスプローラ上で上記SQL文を流しても、 「列 'StockNo' が 'S1' に複数回指定されました。」 とエラーが出てしまい実行することができません。 行03を "SELECT A1.* FROM" にするとSQLServer2005でも動きますが、 tagテーブルのフィールドが結果に含まれません。 tagテーブルのフィールドも結果に含みたいです。 どなたか原因や回避方法をご存知の方いらっしゃいましたら、 お手数ですが是非ともご教示頂きたいです。 よろしくお願い致します。
実行したい内容は、『同一ナンバー内で1番IDが低いコードNOが2のタイトルを出す』といった内容になります。 以下のように書いて実行したところ、『EXISTSを使わないサブクエリでは、サブクエリの選択リストには、式を1つだけしか使えません。と表示されました。』自身のSQL文に問題があるかもしれませんが、現状は下記のSQL文となっています。 "SELECT id, code, num, title FROM contents WHERE code=2 AND id IN (SELECT MIN(id), num FROM contents GROUP BY num)" 副問合せで、同一ナンバーで1番IDが低いIDを取得し、取得したIDをもとに タイトルを出そうとしました。 どなたか御指導御願い願えませんでしょうか。 宜しく御願いいたします。
以下のようなシステム構成の場合、 Windows2003・SQL Server 2000 の クライアントアクセスライセンス ( CAL ) 数は、 いくつ必要とするのでしょうか？ Microsoftのサイト・他のサイト等を閲覧していますが、 よくわかりません。詳しい方、宜しくお願いします。 〔システム構成〕 1.Webサーバ(Windows2003)が１台(CPU１個) 2.DBサーバ(SQL Server 2000)が１台(CPU１個) 3.Webサーバ上には、ASP.NETで作成したWEBシステムが稼動 4.DBサーバには、ASP.NETで作成したアプリからのみ接続 5.Webサーバはインターネット公開（イントラネットではない） 6.ASP.NETで作成したシステムは、ログイン画面があり、 　IDとパスワードによる認証後に利用可能 〔疑問〕 [Windows 2003] ・以下のページに、CALを必要としない条件がありますが、 　上記システム構成では、該当しないのでしょうか？ (システムでIDとパスワードによる認証を実施している為) http://www.microsoft.com/japan/customer/infokb/S … [SQL Server] ・以下のページに「プロセッサライセンスの特徴」として、 　"Web ページのシステムに最適" と記載されていますが、 　WEBシステムの場合、プロセッサライセンス以外認められていないのでしょうか？ http://www.microsoft.com/japan/sql/prodinfo/prev … ・サーバライセンスが可能な場合、SQL Serverに接続するのは、 　WEBサーバからのみです。 　上記システム構成では、WEBサーバがクライアントとしてみなされ、 　必要なCAL数は１つという考えは誤りでしょうか？ 　実際にWebシステムを利用する人数分必要なのでしょうか？ 　(IDとパスワードを付与した人数分)
SQL Server 2005 Expressで Create table Test( date_test datetime ); に追記する場合cdateを使いたいのですが Insert文で 「insert into test(date_test) values(CDate('1999/09/14 23:23:00'))」 とすると 「'CDate' は 組み込み関数名 として認識されません。」っと出てしまいます 他の関数名に変わっているのでしょうか？？
当方SQLServer2005初心者ですが、おわかりになる方いらっしゃいましたら、ご教示下さい。 SQLServerにODBC接続し、参照、更新を行なうアプリケーションを使用しているのですが、更新を行おうとすると下記エラーが出てしまいます。 *＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊ 実行時エラー4002：37000 【Microsoft ODBC SQL Server Driver】 SYSSERVERSにサーバーXP_001が見つかりませんでした。 Sp_Add LINKED SERVERを実行してサーバーをSYSSERVERSに追加して下さい *＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊ 構成としては、サーバー（Windows 2003 Server）にSQLServer2005がインストールされており、当該アプリケーションはWindowsXPのクライアント端末にインストールされています。 ODBCドライバは sqlsrv32.dll（2000.85.1117.00） SQLNCLI.dll（2005.90.2047.00） をそれぞれ試しました（表示されるエラーはドライバ名以外同一でした）。 付帯情報として、アプリケーションのインストールされている端末にSQLServer2005をインストールし、同一端末内で接続する場合には更新も問題なくできます。 原因および対処についてご教示下さい。 宜しくお願い致します。
SQL Serverの保守計画でトランザクションログのバックアップをしていて、4週間経過後に削除するように設定しているのですが、削除されずに残ってしまい、サーバーの要領がフルになってしまいました。 別の同スペックのSQL Serverでは同様の設定で削除できているので原因がつかめずに困ってしまいました。 何かしら設定のミスがあるかもしれないのですが、その確認方法や原因の事例などがあったらご教授願います！
MSDEをインストールしました C:\SQL2KSP4\MSDE>setup SAPWD="a" INSTANCENAME="a" DISABLENETWORKPROTOCOLS=0 SECURITYMODE=SQL ADOから接続で Provider=SQLOLEDB.1;Persist Security Info=False;User ID=sa;Initial Catalog=a;Data Source=192.168.0.10 としますが接続できず Data Source=マシン名\インスタンス名 とすれば接続できました Data Source=IPアドレス で接続できる方法無いでしょうか？ MSDEのインストール方法が間違っているのでしょうか？
SQL Server 2005 を使ってます。 学校の課題で Stored Procedures の頭に 番号を使わなければいけないのですが、 create procedure 1234-selectData as select * from Account とするとエラーが出るので create procedure selectData as select * from Account としてから名前変更してます。 すると今度は exec 1234-selectData でエラーが出るのですが、なにか対処法ありますでしょうか？
　給与奉行２１verIIIをインストールしています。調べたところ給与奉行では古いバージョンのMSDE7.0をインストールしているみたいです。 　ここに別のソフトをインストールしようとした所、インスタンスが無いとインストールできないとのことでした。 　そこでインスタンスを登録する方法を知りたいのですが、自分で調べてもさっぱり分かりませんでした。よろしかったら、どなたか教えて頂けないでしょうか？
すみません。 ＢＯから取得したデータをSQL Server にエクスポートして その中の日付の項目のデータがたとえば、 "2006/10/06 00:04:30"みたいにセットされていて そのデータをAccsessＶＢＡで自分のローカルのＤＢにＩＮＳＥＲＴしようとするとエラーになります。 SQL Server に　"20061001"のような値が入ってるレコードはINSERTできるのですが・・・。 "2006/10/06 00:04:30"のようなデータはINSERTするとき何か編集をしないといけないのでしょうか？ よろしくお願い致します。
SQL-SERVER2000のBCPユーティリティについて教えて下さい。 テキストファイル（変換元）→SQL-SERVER（変換先）にコピーする場合 予め、SQL-SERVER（変換先）側にコピーしたいテーブルが用意されている 必要がありますか？それとも、テーブルが存在しない場合は、自動的に作ってくれるのですか?
テーブル：test_tableにカラム：current_dateが存在するとします。 ここで、以下のようにSELECT文を発行します。(isqlでクエリーを発行します。) > SELECT CURRENT_DATE FROM test_table すると、以下のようにエラーが返ってきます。 > キーワード 'current_date' 付近に正しくない構文があります。 おそらくCURRENT_DATEはシステム予約語のため、このようにエラーになるのだと思いますが、そのようなケースではどのようにSQLをコーディングすればエラーにならずに結果を取得できるのでしょうか？
SQLServerでストアドプロシージャーを作成し、これをWindowsのバッチジョブで実行させたいのですが、どのようにバッチジョブを作成すればいいのでしょうか？ ストアドは単純にdbのdeleteを定義したものです。 バッチにはSQLServerのログインも必要だと思われるので、その辺から教えてください。
こんにちは。 SQLServer初心者です。 Access VBAで　SQLServerから抽出したデータをＤＢにINSERT しようとしてるのですが、抽出した項目にＮＵＬＬデータがあるので エラーになってしまいます。 どのように回避すればよろしいでしょうか？ ISNULL関数を使えば回避できるのでしょうか？ たとえば以下のようなＩＮＳＥＲＴ分を実行したいのですが、 顧客名_漢字のフィールドにはＮＵＬＬ文字が入ってる場合があるとします。 よろしくお願い致します。 strSQL2 = "" strSQL2 = strSQL2 & " INSERT INTO NORSE_TMP_DATA ( " strSQL2 = strSQL2 & " ポート名" strSQL2 = strSQL2 & ", 顧客名_漢字" strSQL2 = strSQL2 & ", 顧客名_カナ" strSQL2 = strSQL2 & ", 契約状態" strSQL2 = strSQL2 & ", 契約番号" strSQL2 = strSQL2 & ", 契約枝番号" strSQL2 = strSQL2 & ", 顧客番号" strSQL2 = strSQL2 & " VALUES (" strSQL2 = strSQL2 & " '" & rs.Fields("ポート名").Value & "'" strSQL2 = strSQL2 & ", '" & rs.Fields("顧客名_漢字").Value & "'" strSQL2 = strSQL2 & ",'" & rs.Fields("顧客名_カナ").Value & "'" strSQL2 = strSQL2 & ",'" & rs.Fields("契約状態").Value & "'" strSQL2 = strSQL2 & "," & rs.Fields("契約番号").Value strSQL2 = strSQL2 & "," & rs.Fields("契約枝番号").Value strSQL2 = strSQL2 & "," & rs.Fields("顧客番号").Value strSQL2 = strSQL2 & " )"
いつもお世話になっております。 現在、WindowsXP(SP2)、SQLServer2000(SP4)で開発をしています。 コマンドプロンプトで下記のコマンドを実行すると、テーブルのエクスポートが正常に行われます。 bcp [データベース名].[dbo].[テーブル名] out c:\test.txt /c /t , /r \n /P (パスワード) このコマンドをバッチファイルに書いて、バッチファイルを実行する事でテーブルのエクスポート処理を行いたいのですが、書き方がわかりません。 御存知の方がいましたら、ヒントや参考にするHP等でも構いませんので、教えてください。 宜しくお願いします。
初心者です。文面に失礼な点がございましたらお許しください。 VBAも初心者なのですが、VBAでODBCに接続してデータを参照してきたいのですが、ネットで検索しても今一理解できません。超初心者向けに手取足取り教えていただけないでしょうか。日々の業務で必要です。申し訳ありませんが、どなたかご指導いただけないでしょうか。
http://oshiete1.goo.ne.jp/kotaeru.php3?q=1211685 にも同じような質問があったのですが、同様の処理でうまくupdateされません。分かる方がいらっしゃいましたら教えてください。 今、テーブルが2つ（table1、table2）があり、それぞれ2つのカラム（column1、column2）を持っています。ここで、それぞれのカラム２が等しく、カラム1が指定した値のレコードのみ値をupdateしたいです。 update table1 set column1 = 'AAA' from table1,table2 where table1.column2 = table2.column2 and table1.column1 = 'BBB' and table2.column1 = 'CCC' としたところ、「from table1,table2 where 」の辺りに間違いがあると表示されます。 上の例とどう違うのか分かりません。 よろしくお願いします。m(__)m
通常、データベースのトランザクションとファイル操作を一括りにしてロールバック等はできませんが、これを可能にする方法はありますでしょうか？ ご存知の方がいらっしゃいましたら教えていただけるとありがたいです。 よろしくお願いいたします。
先日購入したケータイF902iの着メロに、miniSDに取り込んだ音楽を設定したいのですが、取扱説明書に載っていません。どのようにしたらいいのでしょうか？どなたか教えていただけませんでしょうか？
SELECT TABLE.field AS @変数名 FROM・・・ とするとエラーになります。 列名に変数を使うことはできないのでしょうか？
よろしくお願いします。 sqlserver2000をつかってます。 ストアドプロシージャの一覧をプログラム（VB・アクセス、エクセルVBA） で参照したいと思います。 イメージとしては、「information_schema.columns」のストアド版があればよいと思ったのですが、見つけられませんでした。 良い方法をご存知の方お知らせ願います。
Excelの「外部データの取り込み」により、SQLサーバー内のデータベースよりデータを取得しようとしています。 新しいデータソースの登録のステップで、データソースの種類「Microsoft SQL Server」を選択して、次のポップアップウィンドウでサーバー名と認証IDを入力。そうすると接続可能なDBが「使用するデータが含まれているデータベースを選択」のテキストの下のドロップダウンリスト中に現れるのですが、サーバー側で(local)の中に登録されているDBしか現れず、ユーザ側で定義されたインスタンス(と呼んでいいんでしたっけ？)の中のDBのテーブルを読みに行くことができません。 どのようにすれば、ユーザ側で定義されたインスタンスの中のDBのテーブルを読みに行くことができるようになるのか、ご教示いただけると有り難く思います。宜しくお願い致します。
お世話になります。 Access2000＋VB.NETからMSDE2000RelAに移行勉強中です。 SQL Web Data Administratorを使用してテーブルを作成して 入力ツールやその他の画面を.NETで作成しました。 今度サーバーにそのデータを移そうと思ってテーブルのパスを 探したんですがよくわかりません。 そういえば作成するときにもどこに作成するのかというドライブ 名もディレクトリも指定しなかった（聞かれなかった）ように 思います。 拡張子は.dboなのでそれをキーに検索しても引っかかりません。 このデータベースファイルを探してコピーしたいのですが、そも そもデフォルトではどこに作成されるのかご教示いただけませんか? よろしくお願いいたします。
SQLで空白を検索するのは is nullだと思うのですが、 スペースを検索する方法ってありますか？ 二つのパターンを区別して検索をかけたいのですが。
お世話になります。 SQLSever2005を使用しています。 Count(*)で月毎のデータ件数を集計し、またその結果を出力するSQLを考えております。 SELECT 　(SELECT Count(*) FROM TBL_TEST T1 WHERE T1.T_DATE>='2005/01/01' AND T1.T_DATE=<'2005/01/31') AS CNT_1, 　(SELECT Count(*) FROM TBL_TEST T2 WHERE T2.T_DATE>='2005/02/01' AND T2.T_DATE=<'2005/02/31') AS CNT_2, 　 (SELECT Count(*) FROM TBL_TEST T3 WHERE T3.T_DATE>='2005/03/01' AND T3.T_DATE=<'2005/03/31') AS CNT_3, 　 (CNT_1+CNT_2+CNT_3) AS TOTAL_CNT ・・・・・・・・・・・・　(★) 　FROM TBL_TEST T 　WHERE ・・・・・・・・・ 結果(★)のところで『CNT_1は無効です』というエラーになってしまいます。 ちなみにAccessではエラーにならずに結果を出力していました。 上記のSQL文はどのように修正すればよろしいでしょうか？
SQLserver2000でのテーブル定義について質問です。 あるテーブルの中で、最長4000文字を格納するデータ項目があります。 現在、データ型はtextにしているのですが、一般論として、これはcharにした方が良いのでしょうか？ また、SQLserverのデータ格納単位(1ページ)が8KBという点は、textかcharのどちらが望ましいかに影響するのでしょうか？
SQL2005を構築したのですが、 既存（SQL2000）のEnterprise Managerで、 SQL2005への接続・管理は可能でしょうか？ 実際やってみて無理そうだったのですが・・・。 また逆(Management Studio上でSQL2000の管理）は可能でしょうか？ ご存知の方がいらっしゃいましたら、ご教示下さい。
WinServer2003 のタスクスケジュールを使用して毎日曜日にDB(SQLServer2005)の最適化とHDDのデフラグを行うように設定しています。 タスクのログから起動した形跡はあるのですが最適化が実施されません。 Windowsにログインしている状態でbatを実行すると処理されます。 通常はログオフ状態になっており、このタスクもログオフの状態で起動(0:00起動)するように設定してあります。 また、DBの最適化なのですが、設計段階の見積容量と実際のデータ容量が大きく異なり、DBの初期サイズが実サイズを超過しています。 DB元となるデータは、20種類程のCSVファイルからINPORTするため、全部を合計しても800MB程度しかありません。 DBの初期サイズ (DATA:10G LOG:5G) を変更したいのですがどうすればよろしいでしょうか？ 以下のbatからDBの最適化を行っていますが、次のメッセージが表示され最適化されません。(HDDの空き容量は15GBあります) ※DB停止中はDBの最適化はできませんでした。 以上、なぜ実施されないのか分かりませんのでお教え願います。 <DB最適化結果> DBCC SHRINKDATABASE:データベースID 7 のファイルID 1 がスキップされました。ファイルに再利用する空き容量が不足しています。 ログファイル2 (PSSDB_Log)を圧縮できません。すべての論理ログファイルが使用中です。 ＜タスク設定＞ 毎週日曜日：0:00 実行ファイル：hdddef.bat ＜hdddef.batの内容＞ cls rem == DB 最適化 == osql -E -i d:\comp.sql rem == DB 停止 == net stop mssqlserver /Y rem == C HDD 最適化 == defrag -f c: rem == D HDD 最適化 == defrag -f d: rem == DB 起動 == net start mssqlserver /Y exit ＜comp.sqlの内容：pssdbはDB名です＞ use pssdb dbcc shrinkdatabase("pssdb",1) go
トランザクションファイルは、*.ldfというファイルだと思うのですが、 クエリアナライザで、BACKUP LOG データベース名 WITH TRUNCATE_ONLY と実行しても、*.ldfのサイズが減らないのです。。 ldfファイルが一つで6ギガにもなっており大変困っています。 削除方法または減らす方法を教えてください！
SQLServer + PHPという環境で開発しています。 過去にMySQLで開発した際には，mysql_insert_idという 関数を使用してIDを取得できました。 ところがSQLServer用にはこの関数がないので困っています。 とりあえず私は，トランザクションでテーブルをロックし， 書き込まれないことを保証した上で，IDの最大値(このIDは オートインクリメントしています)を取得する， という方法を考えています。 果たしてこの方法が定跡かどうかも分からないので，アドバイスをお願いします。
テーブルにAlter文でカラム追加などを行った場合、トリガーは実行されるのでしょうか？ 追加するカラムにデフォルト値があるかなどの条件でも違うものなのでしょうか？ どなたか教えてください。お願いいたします。 また、Alterでトリガーを無効にしたい場合はトリガーをドロップする方法が無難なのでしょうか？
ただ今、sqlserverの勉強中です。 本やサイトなどを見ているのですが データの扱い方については書かれているのですが どのようにデータを入力して、 どのように出力するのかが分かりません。 ＡＣＣＥＳＳのフォームやレポートで 作成するのでしょうか？ また、このような事が書かれている 本やサイトなどありましたら ご教示して頂けたら幸いです。
社内で、既に退社した方が作成したDBで在庫管理をしています。 VBAの記述でよくわからない箇所があるので教えていただきたいのです。 フォームに部品情報を入力し、「コピー」というボタンをクリックすると、「部品番号」のみ空白になり、それ以外の項目は新しいレコードにコピーされるようになっています。 この部分のVBAは Private Sub Copy_Click DoCmd.DoMenuItem acFormBar, acRecordsMenu, acSaveRecord, , acMenuVer70 DoCmd.OpenQuery "qCopy" Me![PartsCode] = Null となっていて、２行目、３行目は理解できたのですが、１行目が何を行っているのか不明です。 初歩的な質問で申し訳ありませんが、よろしくご教授ください。
大変、初心者的な質問で申し訳ありません。 下記のようなテーブルがあるとします。 --- 列1列2 aいも bさくらんぼ aバナナ cりんご aいも --- 列1・列2でグループ化して、列1におけるの"グループの個数"を出したいと思っています。 つまり、結果としては、 a2 b1 c1 という結果を望んでいます。 おそらくSQLを使われている方は非常に簡単だと思いますが、ご存知の方ご教授お願いします。
結果テーブルに　グループ名、地方、人数、成績の4フィールドがあり、成績フィールド降順で並んでいます。（昇順に変更しておくことも可能です） 上記で、グループ名を指定して、成績トップの（地方、人数、成績）を抜き出すSQL文を教えて下さい。（同点がある場合は、結果テーブルで先にあるほう一つのみ取得する） 例、グループ名が、A又は、Bのうち、成績トップのレコードの3フィールド（地方、人数、成績）を取得。但しトップが複数ある場合は、結果テーブルで上位にあるほう一つのみ取得する グループ名指定の繰り返しが多いため（VBAで繰り返しグループ指定）、速度ができるだけ早いSQL文をお願い致します。 よろしくお願いします。
SQL Server 2005 のデータベースエンジンチューニングアドバイザを起動し、インスタンスに接続ようとすると、実行時エラーが出ます。 http://support.microsoft.com/?kbid=913395 に出ている現象です。 ただ回避策を実行しようとしたんですが、指定されたレジストリ サブキーの場所に移動しても、「Explorer.exe」のプロセスエントリが見つかりません。 どなたか、解決方法をご存じの方いませんでしょうか。
ＡＣＣＥＳＳはマスターしているんですが 今度 sqlserverを習得したいと思っています。 そういう人向けの 教材やサイトを知りませんか？
SQLServer 2005 Express Editionのインストールドライブの変更することはできるのでしょうか。 インストールするPCのCドライブの空き容量が少ないため、別のドライブにインストールしたいと考えております。 よろしくお願いいたします。
SQLServer2005が2台のサーバPCでそれぞれ稼動しています。 サーバAのあるテーブルが更新されると，サーバBのテーブルにも更新を行いたいのですがどのように設定すればいいのか分かりません。 トリガを使用すれば良いと思うのですが2つのサーバ間でトリガを使用するためにはどのような設定及びスクリプトが必要なのでしょうか？ よろしくお願いします。
超のつく初心者です。 SQL Server 2005をデータベースとして、ソフトを作ろうかと思っています。 ２点質問です。 １．SQL Server 初挑戦なので考え方が間違っていたら ご指摘ください。 フォームに入力→SQL Server に保存。 SQL Server →データをフォームに呼び出して編集→SQL Server に保存。 保存ファイルの代わりのような役割になるのでしょうか？ ２．SQL Server 2005をデータベースとして作ったアプリケーションは、 ユーザーのパソコンがWindowsシリーズでしたら問題なく動作するのでしょうか？開発用ソフトはVisual Basic2005です。 作ったはいいがユーザーのパソコンが最新でないとだめ、というのでは元も子もないなぁと思ったので聞いてみました。 以上２点よろしくお願いします。
お世話になっております。 現在、SQLServer2005、VB6.0（SP5）を使って開発をしています。 最終的には、レプリケーションの設定/解除を行うツールを作りたいのですが、まずSQLの機能を使って、ツール作成よりも簡単にレプリの設定/解除が出来るのではないかと調査中です。 msdnのヘルプに、次の様な記述がありました。 「レプリケーション スクリプトは、以下のような方法で作成できます。 　・レプリケーション ウィザードのスクリプト生成機能を使用する。」 (http://msdn2.microsoft.com/ja-jp/library/ms14730 …) しかし、この機能を使って作成したスクリプトを使っているのですが、データの同期が行えていません。 ログ リーダー エージェントを見ると、 「1 個のトランザクションが 1 個のコマンドと共に配信されました。」 と表示されているのですが、実際にデータを確認すると、同期が取れていません。 サブスクリプションの状態をチェックすると、 「ディストリビュータからサブスクライバまでの履歴」 で、「パブリケーション○○の初期スナップショットはまだ使用できません。」 と言うエラーが表示されていました。 レプリケーションモニタをチェックしたところ、スナップショットエージェントが開始されていませんでした。 そこで、スナップショットエージェントを開始したら、データの同期が行えるようになったのですが、 「レプリケーション ウィザードのスクリプト生成機能」を使用して作成したスクリプトなのに、完全なレプリケーションの設定が出来ないのは、どうしてなのでしょうか？ 何か御存知の方がいらっしゃいましたら、教えてください。 よろしくお願いします。
該当する商品の合計数を所得したいのですが検出方法が分かりませんので教えて下さい。 商品マスタ（A）と売上げデータ（B）に下記のデータがあります。ＡとＢの関係は、１：ｎになります。 Ｂの商品とＡの商品が一致した場合にＡの商品が売れたと判断します。 最終的にＡの一致した商品数を取得したいのですが、Ｂの検出数が反映されてしまい正常に一致した件数を取得できません。いろいろ試みましたけどダメでした。どなたか、ご享受下さい。 ---------------- 商品マスタ（Ａ） ---------------- AA BB CC DD EE FF ---------------- 売上げデータ（Ｂ） ---------------- AA 06/9/10 BB 06/9/10 BB 06/9/11 DD 06/9/12 AA 06/9/14 BB 06/9/14 AA 06/9/15 AA 06/9/16 BB 06/9/17 BB 06/9/17 BB 06/9/18 ---------------- 結果 ---------------- 3 ※--- 補　足 --- Ｂを商品毎にグループ化してカウントすると、 AA = 4件 BB = 6件 CC = 0件 DD = 1件 EE = 0件 FF = 0件 になります。売上げ件数が、0件以上の商品は、AA、BB、DDの３商品になります。この３の値を取得したい訳です。
WindowsXPProServicePack2にSQLServer2005Expressをインストールしました。 これを他のＰＣから接続できるように、試行錯誤しているのですが、うまくいきません。別のＰＣのSQL Server Management Studio Expressから接続しようとすると下記のエラーが表示されます。 ------------------------ サーバーへの接続を確立しているときにエラーが発生しました。SQL Server 2005 に接続しているときときにこのエラーが発生した場合は、SQL Server の既定の設定がリモート接続を許可しないようになっていることがエラーの原因である可能性があります。 (provider: 名前付きパイプ プロバイダ, error: 40 - SQL Server への接続を開けませんでした) (Microsoft SQL Server, Error: 1265) ------------------------ セキュリティ設定にて、リモート接続に設定するなど、 http://www.microsoft.com/japan/sql/ssj/tips/01.m … に書かれていることは実行しました。 また、Windowsファイアウォールの設定は無効にしています。 他に何を試せばよいでしょうか？？
お世話になっております。 データベースはSQLServer2005、クライアントの開発ツールは.NET2003で開発を行おうとしておりますが、この組合せで何か不都合は有りますでしょうか？ どなたか、ご存知でしたらお教え下さい。 宜しくお願い致します。
サーバ移転を行うのですが、 データベースデータをメディアに保存して、移転先のサーバに持っていってアタッチ。。。 これをやると果てしなく時間がかかってしまいます。（データベースが数百個ある為） バージョンは、SQL-Server2000です。 データベース移行を円滑にやる為に、データベースの同期ができれば簡単になるのですが、できるのでしょうか？ できるならやり方を教えてください～
table1には社員NO,評価ポイントの列があり過去３年分のデータが入っています。社員NOが1000以下で 評価ポイントが最高のポイントとその社員NO、 評価ポイントがＮ番目に大きいポイントとその社員NO、を一度に求めるSLQは可能でしょうか。 table1 社員NO 評価 100 1 200 2 300 5 400 8 500 3 900 4 1000 6 1100 7 1200 5 100 2 200 3 300 5 400 6 500 7 900 5 1000 3 1100 2 1200 1 結果 最高 社員NO 400 評価 8 2番目 社員NO 500 評価 7 環境windows 2000 sql server
SELECT HINMOKU_NAME FROM HINMOKU WHERE HINMOKU_CODE IN (SELECT HINMOKU_CODE FROM URIAGE WHERE URIAGE_DATE = '2004-11-10'); 上記をSQL文をEXISTS述語を使って書き換えると エラーが出てしまい、うまく書き換えがすることが できません。下記にエラーがでるSQL文を記載いたします。 SELECT HINMOKU_NAME FROM HINMOKU WHERE EXISTS (SELECT HINMOKU_CODE FROM URIAGE WHERE URIAGE_DATE ='2004-11-10' WHERE HINMOKU.HINMOKU_CODE=URIAGE.HINMOKU_CODE); 上記SQL文についてどこに問題があるのか、ご教授お願い致します。
以下、どうか教えてください SQLserver2000＋ASPでWEBアプリを作っています。 2006/9/1/1, 2006/9/2/1, 2006/9/3/1, 2006/9/4/1, 2006/9/5/1 ↑こんな感じのデータを配列のまま、ストアドに渡して、 テーブルを更新することは出来るのでしょうか？ よろしくお願いします
アダルトサイトを見てたらアダルト画像が画面に出てきて、消してもすぐに出てきます。 どうすれば出てこない様にできますか?
お世話になります、ビット型について質問させて下さい。 Ver7からVer8もしくは9にバージョンアップをしているのですが、ビット型の値に対して-1の値で検索した時の結果がVer7では1と同等で返ってきます。 前任者がなぜか-1でスクリプトを組んでいたのですが、Ver7では-1=1だったのでしょうか？ 当たり前かと思うのですが、Ver8,9では-1=1にはなりません。 よろしくお願いいたします。
お世話になります。 access＋vb.NETで開発しておりましたが、ＶＰＮ構築の関係でＭＳＤＥに移行することになりました。 これまでにテスト運用したmdbファイルのデータをＭＳＤＥに移行すべく、アップサイジングを行おうとしていたとき、「オーバーフロー」というメッセージが出て前へ進めません。 この「オーバーフロー」とは何がどうなったと言うことでしょうか? 全く対処方法がわからず苦慮しています。 説明不足でわかりにくい点は補足させていただきますので、どうかよろしくご教示ください。
初歩的なことかもしれませんが、下記質問について教えてください。 現在SQL Server2000の環境でDBを使用しております。 現在使用しているDBの既存テーブルに簡単なバッチファイルを使ってカラムを追加後（ALTER TABLE）、その追加したカラムにデフォルト値やそのテーブルにレコードを追加しようとしています（個々までバッチ処理: 今回試したのは、クエリアナライザにて試験的に行っています）。 ただ、カラムの追加までは可能ですが、デフォルト値やレコードの追加を行うと「追加したカラムが無効です」というエラーが表示されます。 恐れいりますが解決策があれば、教えてください。
さっき投稿したつもりだったのですが、投稿できていなかったみたいなので、もう一度投稿します。 SQLServerManagementStudioExpressで、同じフォルダにある複数のＳＱＬファイルを一度に実行したいのですが、どうすればいいでしょうか？ ひとつのＳＱＬ文にまとめるという手もあるのですが、別ファイルに分かれている状態が好ましいで・・・ 分かる方がいたら教えていただきませんか？
OS:Windows2000 SQLServerOS:WindowsNTServer4.0 SQLServer6.5 初めてこちらを利用致します。 よろしくお願い致します。 Access（2000）で作られたデータベースに下記エラーが発生し、まったくつながらなくなっていました。 （エラー内容） 接続できませんでした SQL State：’01000’ SQL Server エラー ： 10060 [Microsoft][ODBC SQL Server Drivers][TCP/IP Sockets]一般ConnectionOpen(connect()) 接続できませんでした SQL State：’08001’ SQL Server エラー ： 11 [Microsoft][ODBCSQL Server Drivers][TCP/IP Sockets]一般的なネットワークエラーです。 ネットワークのマニュアルを調べてください。 現在SQLServerは2台あるのですが、全てつなぐことができません。 インターネットには接続できています。 ポートも調べましたが、問題はありませんでした。 解決方法があれば、ご教授願います。 よろしくお願い致します。
AccessとSQL Server（MSDE2000）で業務システムを作っています。 データを入力するフォーム（入力票）上でLotNoを入力すると該当する単価をビュー原料マスタから取得するようにしています。 LotNo（フォームのテキストボックス）の更新処理後のイベントに・・・ Me![単価] = Dlookup("単価","原料マスタ","LotNo = " & [Forms]![入力票]) としています。MSDE2000の場合は正しい値が取得できますが、SQL Server2005の場合は以下のエラーが出ます。 実行時エラー245 　nvarcharの値 '.' をデータ型intに変換できませんでした。 ビュー「原料マスタ」の基になるテーブルの各項目は、 LotNo：nvarchar(13桁） 単価:float です。 どのようにするればよいでしょうか？ 型を変換するような処理が必要なのでしょうか？ 以上、よろしくお願いします。
MSDE2000同時接続数について質問させていただきます。 社内システムをAccess2002 + MSDE2000 で運用しています。現状は4台なのですが、5台くらい増やす予定があります。 しかしMSDEは同時接続数が5と聞きました。10台では無理があるのでしょうか？ また、SQL Server2005の評価版を用意し使ってみましたが、Accessからストアドプロシージャの修正、追加(新規）ができません。修正しようとすると、・・・ ”このバージョンのMicrosoft Office Accessでは Microsoft SQL Serverで接続された Accessプロジェクトのデザイン変更をサポートされていません・・・” との警告が出て修正できません。 製品版でも同じなのでしょうか？ ちなみに Officeアップデートは行いました。
SQLで情報を抽出しようとしています。 情報はFAX受信枚数です。 select distinct count(*)from <datebase A> where <page_no>='6' and to_char(receive_date,'yyyy/mm/dd') between 'YYYY/MM/DD' and 'YYYY/MM/DD'; 上記の構文だと、PAGE 6/6のついでに PAGE6/8なども一緒くたに情報を引っ張ってくると思われます。 今回知りたい情報はPAGE 6/6の受信枚数のみ なのですが、どうすれば条件に当てはまる式になるでしょうか。 なお、情報項目には、6/6を示す情報はありません。
JAVA(Eclipse使用)でSQLServer、JDBCで接続しています。 今まで動いていたのですが、DBサーバーを自分の端末に変更するとつながらなくなりました。 エラーも「[Microsoft][SQLServer 2000 Driver for JDBC]????????????????????」 とでていてよくわかりません。 接続文字列が悪いかと思ったのですが、IDやパスワードは、今までと同じなので異なるのはサーバー名くらいです。 （ポート番号も変わらない） コンピュータ名やIPでもどちらで試してもエラーとなります。 端末名を元に変えるとつながるのですが・・・ 何かドライバとかなにか、別の設定とか必要なのでしょうか？ （ちなみにポート番号ってネットワークユーティリティのTCP/IPのプロパティで確認であってますよね？）
こんにちわ。 Oracleではあるカラムをプライマリキーとして設定すると， 自動的にそのカラムにインデックスが付与されたと思います。 ところで， SQLServerではあるカラムをプライマリキーとして設定すると， 自動的にそのカラムにインデックスが付与されるのでしょうか？ あるいはプライマリキーとインデックスを個別に設定しなければ ならないのでしょうか？ 教えてください。よろしくお願いします。
SQL文について教えてください。 oracle,mysqlでは、下記の条件分 where (fieldA,fieldB) in (select fieldA,fieldB from TABLE_NAME) と言った条件を記載可能なのですが、SQLServer ではエラーになってしまいます。 違った構文があるのでしょうか？よろしくお願いします。 具体的にやっているSQLは update TABLE_NAME set FIELD_NAME='1' where (FIELDA,FIELDB) in (select FIELDA,FIELDB from TABLE_NAME2 where FIELDC='1')
perlを使ってMicrosoft SQL　serverのデータを加工できるのでしょうか？
教えてください。カラムの桁数を考える上で、例えば、桁数を1000とる必要がある場合、1024としておいた方が良いと聞きました。16進数？で割り切れる値にした方が設計として最適云々とのことです。それは本当にそうなのでしょうか。識者の方ご教授お願い致します。
Microsoft SQL Server Management Studio Express を使ってSQLを学んでいる入門者です。使用方法でわからない事があるので教えてください。 以下はすべてMicrosoft SQL Server Management Studio Express上での作業です。 (1)'TEST'の名前で新しいデータベースを作成 (2)作成されたデータベース'TEST'のアイコンを右リック→タスク→バックアップで、データベースをバックアップ ここまでの操作で"C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\Backup"フォルダには'TEST.bak'でバックアップファイルが作成されました。 次に (3)作成されたデータベース'TEST'のアイコンを右リック→削除→「バックアップを削除し、データベースの履歴情報を復元する」にチェックが入っているので、そのまま実行。 質問ですが、以上の操作を行えばデータベース本体の他に(2)で作成されたバックアップファイル'TEST.bak'も削除されると思ったのですが、そのまま削除されずに残ってしまいます。 (3)の「バックアップを削除し、データベースの履歴情報を復元する」のオプションはどういう意味なのでしょうか。ヘルプを参照しましたが、やはりバックアップファイルは削除されるのではないかと思うのですが・・
２つのテーブルがあります。 A:生徒のデータ B:先生のデータ AにはBのデータと紐付けしています。AとBそれぞれにユニークなキーが自動採番で振られます。 行いたい事は新しい生徒のデータが加わった際に、先生のデータが無ければ先生のデータも加え、生徒のデータも加えるということを行いたいと思います。 そこで、AとBを組み合わせたビューを作り、そのビューにINSERTをするとエラーが発生します。 そこで、考えた方法は 1. BのデータをSELECTで先生のデータを探す。（あればキーを取得後、3へ) 2. 無ければデータ追加し、自動採番で振られるキーを再度SELECTで取得。 3. 2で得られたキーを使って生徒のデータと共にAにINSERT文を行う。 です。なんとかできますが、すっきりしません。もっと効率的でスマートな方法がないのでしょうか？ ご教授お願いします。
データベースに列A、Bがあり、その中は A b 1 1 1 2 1 3 1 4 2 2 2 3 2 5 を入力されていて、以下のようにAのグループの中の値で最小値を取得したいのです。 A B 1 1 2 2 MIN関数を使用すると、テーブル全ての最小値を取得してしまうので、上手くいきません。何かいい方法があるでしょうか？
こんにちわ。 いまSQLServer2005でストアドを作成しています。 あるテーブルをSELECTして，あるカラムと件数の両方を出力パラメータに取得したいのですが， 件数は取得できるのですが，カラムが取得できません。 ちなみに下記のようなコードになります。 create procedure funLoginCheck (@UserID char(5), @PassWord varchar(10), @RowCount int output, @DeptID char(2) output) as select * from MST_Employee where EmployeeID = @UserID And PassWord = @PassWord; set @deptid = deptid」 deptidを出力パラメータに渡す方法がわかりません。 初歩的なことかもしれませんが， 教えてください。よろしくお願いします。
基本的なことですみません。 環境はSQLServerのクエリアナライザを使用してます。 内容は題名のとおりです。 例えば table1 fID　　ｆName　　fItemCD 1　　　山田　　　01 2　　　木村　　　03 3　　　田中　　　04 4　　　佐藤　　　02 5　　　高橋　　　03 6　　　川島　　　03 7　　　山下　　　06 のようなものがあって、以下のSQL文を処理すると select fItemCD, count(*) as Rslt from table1 where fItemCD in ('04','05','06') group by fItemCD 結果 fItemCD　Rslt 04　　　　1 06　　　　1 が返ってきます これを fItemCD　Rslt 04　　　　1 05　　　　0 06　　　　1 と結果0件のものも表示したいのですが、いい方法ありますか？ よろしくお願い致します。
SQLServer初心者です。 INSERTにて、値に外字の文字化け？を、 (例えば『・_』みたいな。） セットするとINSERTエラーになります。 解決策はありますでしょうか？ ちなみに、VB6.0でプログラミングしております。
はじめまして。SQL Server2005初心者の5年目SEです。 今年からSQL Server2005を使用し始めたのですが、 どうしてもアンインストールできずに困っています。 というのも、 先日評価版から製品版へアップグレードするため 既存のファイルを削除せずに そのままインストールをしていたのですが、 途中で「アップグレードがロックされました」 というメッセージが表示され、 先に進めなかったため既存のファイル削除しようと考えました。 しかし コントロールパネルのプログラムの追加と削除からSQL Serverと 名のつくものは全て削除したのにも関わらず ProgramFilesにSQLServerというフォルダが残ってしまいまい、 結局同様のメッセージが表示され再インストールができませんでした。 もちろんIISはインストールしてあります。 サービスを停止したり色々試したのですが ここ数日考えても解決できませんでした。 どなたかおわかりになる方がいらっしゃいましたら ご教授下さい。 よろしくお願いいたします。
ストアドプロシージャで現在日付を取得するには GETDATE() を使いますが、年、月、日をそれぞれ取得したいのですがその方法（関数？）がわかりません。 また、取得した年、月、日は項目（Smallint）に書き込みます。 以上、よろしくお願いします。
いまどき、SQLServer7.0でAP開発している者です。 AP内で一時テーブル（#テーブル名、##テーブル名）を使おうと思っていますが、気になることがあります。 一時テーブルは、セッションが切れた時点で、自動的に、SQLServer側が作成した一時テーブルをDROPしてくれるとMSDN等に書かれてあります。 しかし、なんらかの障害がDBサーバとクライアント間で発生して、DROPされずに残ってしまうことはありますでしょうか？明示的にDROP文を発行した方が安全なのでしょうか。
SQLで明示的にbegin trans - commit transを設定していない場合、テーブルに対して複数のレコードをupdateしようとして一部のレコードのみでエラーが発生するとロールバックの処理はどこまでしてくれるのでしょうか？ 設定によっても違ってくるのでしょうか？
SQLServer2000を単体で使用しております。 Windows認証にしてあるのですが、SQLServer認証に変更しようと思い、EnterpriseManagerで コンソールルート→MicrosoftSQLServers→SQLServerグループ→(local)(WindowsNT)を右クリックし、SQLServer登録プロパティの編集を選択。 SQLServer認証を使用を選択して、ログインにsa、パスワードはブランクのままＯＫボタンを押すと、「ユーザーsaはログインできませんでした。」と表示されます。 Windows認証からSQLServer認証への変更はできないのでしょうか？ご存知の方がいらっしゃいましたらご教授願います。よろしくお願いします。
WindowsXPにてMicrosoft SQL Server 2005 Express Edition（SP1）をインストールし、コンソールより osql　-E を実行すると、以下のようなエラーが返ってきました。 ------ここから------- C:\Documents and Settings\yano>osql -E [SQL Native Client]VIA プロバイダ : 指定されたモジュールが見つかりません。 [SQL Native Client]ログイン タイムアウトが時間切れになりました [SQL Native Client]サーバーへの接続確立時にエラーが発生しました。接続先が SQL Server 2005 である場合は、既定の設定ではSQL Server がリモート接続を許可していないことが原因である可能性があります。 -------ここまで-------- SQL Server Configuration Managerで見ると、サーバのネットワーク構成もクライアントの構成も全て（共有メモリ、TCP/IP、名前つきパイプ、VIA）有効になっていました。 また、Microsoft SQL Server Management Studio　ExpressからはWindows認証で接続し、データベースにアクセスできます。 どなたか、このエラーの意味や解決方法がわかりませんでしょうか？
データデータベース(DataDB) memberNo|memberName|data1|data2 タイトルデータベース（TitleDB) Title1|Title2 という二つのデータベースがあったとして これをセレクト文で表にする時に、 data1とdata2のタイトルはTitleDBの1,2の内容をタイトルにしたいと思っています。 そこで以下のように記述してみましたが、エラーがでてしまいます。 『select memberNo as '会員番号',memberName as '会員名',data1 as TitleDB.Title1 ,data2 as TitleDB.Title2 from dataDB,TitleDB』 どのように実現すればよいのでしょうか？ ※『select memberNo as '会員番号',memberName as '会員名',data1 as 'データ１' ,data2 as 'データ2' from dataDB,TitleDB』 の場合エラーはでません。
いつもお世話になります。 クライアント：Excel2000（マクロ） サーバ　　　：SQLServer2000 Dim strCon As String Dim oWK As Object Dim oDB As Object Dim strQ As String Dim rRec As RecordSet strCon = "ODBC;DRIVER=SQL Server;SERVER=hoge;UID=hoge;PWD=hoge;DATABASE=hoge" Set oWK = DBEngine.CreateWorkspace("hogewk", "hoge", "hoge", dbUseODBC) Set oDB = oWK.OpenConnection("", dbDriverNoPrompt, False, strCon) strQ = "select * from [tbl_hoge]" Set rRec = db.OpenRecordset(strQ, _ dbOpenDynamic, _ dbExecDirect, _ dbOptimisicValue) Do Until rRec.EOF = True If (条件) then oWK.Begintran 処理 oWK.Commit End If rRec.MoveNext Loop 上記のプロシージャをExcelからSQLServerに対し実行しましたが、rRec.MoveNextが エラーとなってしまいました。 oWK.Commitを実行後、問題が発生いたしました。 おそらく、oWK.CommitによりｒRecレコードセットが開放されてしまったと思います。 これは仕方が無いのでしょうか。回避方法（プロシージャレベル）は御座いますでしょうか。 情報に不足がある場合、ご連絡いただけましたら補足させていただきます。 どうか宜しくお願いいたします。
SQL初心者なのでお教えください。 テーブルAに部課名,社員NO,入室時刻,退室時刻のデータがあり部課名単位でセレクトした結果を 社員NO単位で処理したいのですが、一般的にはどのような手順(SQL)でするのでしょうか。 テーブルA |部課名|社員NO| 　　 入室時刻 | 　退室時刻 | |A |11111 |2006/01/01 8:10:00| 2006/01/01 9:10:00| |A |11114 |2006/01/01 8:15:00| 2006/01/01 9:15:00| |A |11112 |2006/01/01 8:30:00| 2006/01/01 9:30:00| |A |11112 |2006/01/01 8:50:00| 2006/01/01 9:50:00| |A |11111 |2006/01/01 10:10:00| 2006/01/01 12:10:00| |A |11113 |2006/01/01 6:10:00| 2006/01/01 7:10:00| |A |11111 |2006/01/01 13:10:00| 2006/01/01 14:10:00| 社員NO 11111さんのみの結果を作りたい(特定期間に何回入室したか等） 使用OS Windows 2000,VisualBasic 2005
こんにちわ。 いまSQLServer2005Expressをダウンロードして， vb.net2005expressからアクセスしようとしています。 そこでsqlserver2005でテーブルを作成しようと思うのですが， sqlserverのプログラムを起動してもテーブルを作成する箇所 が見当たりません。 どうすればテーブルを作成できるでしょうか？ 教えてください。お願いします。
あるデータベースの解析を行っています。 あるマスターテーブルと そのマスターテーブル更新ヒストリーテーブル の2種類があります。 マスターテーブルが更新される度に自動的にヒストリーテーブルに同じ内容が追加されています。 ヒストリーテーブルは更新ログのような目的で使われているようです。 Webアプリのプログラムから操作せず、SQLServer上で自動的に行われているようなのですが、どこで設定されているかわかりません。 よろしくお願い致します。
Win2000Server＋SQLServer2000を利用しています。 昨日まで正常に稼動していたのですが、今日アクセスできないので、SQLServerの状態を見ると停止していました。 SQLServerを開始しようとすると 「ログオンに失敗したため、サービスを開始できませんでした」 「エラー1069 （ログオンに失敗したため、サービスを開始できませんでした）が、MSSQLServerサービスでこのサービス操作を実行中に発生しました」 のようなエラーが出ます。 管理ツールのサービスからSQLSERVERAGENTを選び、アカウントを変更して試しましたが、同じエラーが出ます。何が原因なのでしょうか？
OS：WindowsServer２００３に SQL Serverをインストールしたいと思っております。 評価版をダウンロードできるサイトを教えていただけますか？ よろしくお願いいたします。
学校でＳＱＬを使って、データベースを作るという期末課題がでました。 当方バイクの知識が少々あるため、バイクとバイク販売店というデータベースを作ってみることにしました。 バイクのデータ100個分とお店のデータは10個ほどなのですが、課題の条件の中にＶＩＥＷを作成すること、とあるのですが、ＶＩＥＷとは何者なのでしょうか？ 授業のページを見ても、難しい事しか載っていなくて困っています。 またテーブルの入力と、データの入力はなんとか覚えたのですが、ＶＩＥＷの作り方は全く意味がわかりません。なので・・・ ＶＩＥＷの意味と役割を教えてください。 初心者なので出来るだけわかりやすく教えていただけたら幸いです。 またＶＩＥＷの作成方法(create viewだとかなんとか・・・)を教えてください。 ちなみにテーブルデータとかはこんな感じに作っております。なのでこんな感じでVIEWの作成方法をご教授いただけたらありがたい次第です。 create table bike( 　　maker text, name text, size int, nennshiki date, kaizou text, shaken text, nedann float, shop text ) よろしくお願いいたします。
確かSQLServer2000で（2005からだったかな？） EnterPriseMangerでデータベースのテーブルを 開いた時にシステムテーブルを表示させない 設定ができたはずなのですが、どこでできるのか 忘れてしまいました。 どなたか教えてください。
いつもお世話になります。 以下のような感じで変数をテーブル名として参照したいのですが、できますでしょうか。 --ここから create proc proc_test @tbl_name varchar(30) as select count(*) from [dbo].[@tbl_name] --ここまで ver：SQL Server2000 宜しくお願いいたします。
sql server 2000 です よろしくお願いします 複数パターンの集計結果をまとめて表示したいのですが SQLが分かりません 下記TBLは1週間の小遣いを格納するTBLです KEYは「name」と「youbi」 ------------ tbl:小遣い帳 name,youbi,kingaku aaa,月,100 aaa,火,100 aaa,水,100 aaa,木,200 aaa,金,200 aaa,土,300 aaa,日,300 bbb,月,100 bbb,火,100 bbb,水,100 bbb,木,100 bbb,金,100 bbb,土,100 bbb,日,200 　　・ 　　・ 　　・ 　　・ 　　・ -------- 上記TBL「小遣い帳」より 各人の使用した金額を集計して表示しますが、 集計は １．月曜日と火曜日 ２．水曜日と木曜日と金曜日 ３．土曜日と日曜日 の３パターンです 期待するselectの結果は name,月～火,水～金,土～日 aaa,200,500,600 bbb,200,300,300 　　・ 　　・ 　　・ 　　・ 　　・ どうすれば、上記の結果が得られるでしょうか？ よろしくお願いします
はじめまして。 Excelファイルで作成したテーブルのファイルを、 MSSQLに読み込ませてテーブルを作成することが可能と聞いたことがあるのですが、 インターネットで検索をかけても、そのような情報を見つけられません。 お手数ですが、おわかりの方がいらっしゃいましたら、 教えていただけませんでしょうか？ こちらの環境は、 ・Microsoft WindowsServer2003 StandardEdition ・Microsoft SQLServer2000 SP4 ・Microsoft Excel2003 です。 よろしくお願いいたします。
SQLサーバにあるDBから他のサーバにあるDBに対してアクセスを行い 、DB同士のデータの同期を取りたいのですが、どのようにすればDB同士で同期を取ることができますでしょうか? よろしくお願いします。
SQLServer7のデータベースを、別のサーバ機のSQLServer2000に移行したいと考えています。 データベースそのものはEnterpriseManagerのデータベースのバックアップ・復元にて移行できたのですが、移行先のサーバでODBCを設定すると、ログインID・パスワードで接続ができませんでした。 (「ユーザーの既定のデータベースを開けません」) masterとmsdbをバックアップ・復元しようとしましたが、バージョンが異なるというエラーで先に進めません。 新サーバ上にODBCで接続するために何をすればいいのか教えてもらえませんでしょうか。
SQLはMySQLしか知りません。PostgreSQLもありますが使った事がありません。後、有料のものでOracleなどもあります。マイクロソフトからもSQL server2005とか出ていますね。実際どれが一番使いやすいのでしょう。個人規模で使いますので、おのずと、前者２つになってくると思うのですが。ただ、サーバーをWindows small server 2003で作りますので、どれが使い勝手がいいのかなと思うのですが。一応入出力はJavaかなと思ったのですが、Tomcatとかを使わないといけないのと、そうするとWebサーバーとの兼ね合いでIISとの連携がわからないし、PHPで作ろうかと考えています。Javaの方がセキュリティー面でも良いのでしょうけれど、自分の技量と、それほど大したデータではないので（個人情報等ではないので）PHPで作ろうと思うのですがいかがなものでしょう？ どのDBがよいのでしょうか？
以下のようなテーブルからc列とd列のデータが重複しているレコードを取得したいために、以下のSQLを試してみました。 a列|b列|c列|d列 ---|---|---|--- 01 |01 |01 |01 02 |01 |01 |01 03 |02 |01 |03 04 |02 |02 |03 05 |01 |01 |02 06 |02 |02 |03 select * from テスト where c in (select c from テスト group by c,d having count(*)>1) and d in (select d from テスト group by c,d having count(*)>1) そうしたところ、以下の結果になってしまいました。 想定では、○のレコードだけ抽出できると思ったのです。 ×のレコードを抽出したくないのですが、SQLのどこが 間違っているのでしょうか？ a列|b列|c列|d列 ---|---|---|--- 01 |01 |01 |01　○ 02 |01 |01 |01　○ 03 |02 |01 |03　× 04 |02 |02 |03　○ 06 |02 |02 |03　○ （使用DB）SQLServer2000
クエリアナライザで実行すると３０秒くらいかかるようなSQLがあるのですが、修正の余地について教えてください。 抽出元となるテーブルのレコード数が多くても、クエリの書き方やインデックスの張り方で速くなるのは知っていますが、限界はないのでしょうか？ 単純に抽出元となるテーブルのレコード数が多いことが原因なのか、クエリやインデックスが原因なのかを判断する方法を教えてください。
SQLについて質問です。 現在vbからmdbファイルにある日付間のデータを取得するようなsqlをなげているのですがうまくいかないのでお知恵をお貸しください、、、 sql文は ("select * from ABC where date between ""'" & hiniti & "'"" and ""'" & hiniti2 & "'"" ;") hinitiには日付（2006/4/5）hiniti2には（2006/7/4）のように日付が入ったとするとデータは2006/4/5以降から2006/7/4までしか取得してこないのです。 BETWEEN 演算子は境界値も含むらしいので2006/4/5のデータが取れない理由がわかりません。 日付が文字列というのが問題あるのでしょうか？
SQL Server＋Accessで使用しています。 ユーザから入力したはずのデータが検索時にヒットしないという質問があり、SQL Serverのデータベースの中を確認するとデータは存在していました。 確認のためにビューを利用して検索したのですが、データが存在するのにヒットしません。仕方ないのでワイルドカードを使用して検索するとヒットします（下例参照）。 キーとなるデータ：ABCDEFGH 検索キー：ABCDEFGH ワイルドカード使用：LIKE 'ABCDEFG%' 検索時のキーとなるデータは8桁なのでワイルドカードを使用して1桁～8桁まで試しましたがヒットします。が、普通に検索するとヒットしません。 キーとなるデータ形式がおかしいのかと手入力してみましたが、結果は同じでした。ヒットしない原因は何なのでしょうか？
SELECT TableA.ＩＤ,SUM(TableA.量),TableB.金額 FROM TableA,TableB WHERE TableA.ＩＤ = TableB.ＩＤ GROUP BY TableA.ＩＤ,TableA.量,TableB.金額 こんな感じのSQLなんですが TableAをメインテーブルとして ↓のような結果を得るように作り変えれないか考えています ■TableBとの結合レコードあり（金額登録あり） 1,50,1500 ■TableBとの結合レコードあり（金額登録なし） 1,50,(NULLかスペース) 考えているんですが思いつかないのでヒントいただけたらと思います。宜しくお願いします。
SQLServer2005でWindows認証の設定をSQLServer認証に 変更したいと考えています。 その際に、必要な設定手順を教えてください。 知識が乏しいので、詳しく教えて頂けると助かります。
すでに稼動していたPCが不調となり、新しくPCを設置したのですが、ドメインに参加しているクライアントからEnterpriseManegerでサーバーのPCを新規登録しようとすると、[DBNETLIB][ConnectionRead (recv()).]一般的なネットワーク エラーです。ネットワークのマニュアルを調べてください。とでて登録ができません。SQLSeverの再インストールも行いましたが状況が改善しませんでした。 何度か試すと接続はたまにできるのですが、その場合もテーブルを開こうとすると上記エラーが出てしまいます。 レプリカができればいいので、ためしにサーバーで作業してみたのですが、サーバーだと該当クライアントのPCが新規登録の候補にすら表示されていません。ほかにクライアントが二台ありますが、レプリケーションモニターを見る限り問題はなさそうです 自分なりに調べては見たのですが対策がわからず、客先でのことでかれこれ５日ほど費やしているため、次回の作業で解決したいのです。 参考になるものでもいいので、お分かりになる方がいらっしゃいましたらご教授ください
下のように、あるテーブルをSELECTしたときに、 [NO]を定義して、[NO]にカウントをセットする。 ただし、カーソルは使用しない方法を 知っている方いますか？ ＜テーブル項目＞ 本部、部、課 ＜SELECT実行後＞ NO　本部　　部　　　　課 ------------------------- 1 東京　　総務　　　総務 2　 東京　　人事　　　採用 3　 東京　　営業　　　営業１ 4 　東京　　営業　　　営業２
サーバ：SQL Server2000、ファイヤウォールは無効設定済み クライアントがXP Proで、管理ツールにあるデータソース(ODBC)で、SQL Serverドライバで接続確認をしていました。 クライアントの設定欄で、ネットワークライブラリをTCP/IPにすると、 SQLState:'08001'SQL Serverエラー:17 「ODBC SQL Server Driver」「TCP/IP Sockets」SQL Serverが存在しないか、アクセスが拒否されました。 とエラーが出ます。 "TCP/IP"だと接続エラーになるのですが、ネットワークライブラリを"名前付きパイプ"で設定すると、正常に接続していると出ます。 どこの設定いけないのかさっぱりわからず、解決する手段がわかりません。 助けて下さい。　宜しくお願いします。
はじめまして。 データベース等、専門知識が全くないのですが、アクセスで作成された顧客管理データを修正しないといけない事になりました。 店舗でのお客様の情報管理に使うのですが、その中の項目（たとえば住所、携帯アドレスなど）をいくつか追加しないといけません。 デザインビューのページを開いてぱっと見だけは追加できたのですが、いざ使おうと思ったら「このコントロールは“住所”フィールドに連結しているため編集できません」というエラーが出ます。 どうしたら使えるようになるのでしょうか？ 方法、またはそれがのっているURLでもいいのでご存知の方教えて下さい。よろしくお願いします。
ロックがかかったテーブルに対して、 SELECT文を発行する際、ロックが解除されるまで 待ち続けるヒント句のようなものは SQL SERVERに存在するのでしょうか？ （Oracleの「SELECT～FOR UPDATE文」に相当するものは 　存在しないのでしょうか？） 使用しているDBはSQL SERVER 2000　です。
SQL Server Enterprise Managerで、 データベースのデタッチを行いました。 すると、そのデータベースが消えました。 ファイルとしてコピーされるようですが、どこかに残っているのかがわかりません！ よって、アタッチもできません。 どこにファイルはあるのでしょうか？？ 困っています。 よろしくお願いします。
VBでUPDATE文を書いて実行したのですが うまく更新されません。 なぜなのでしょうか?教えてください。 SQL = " UPDATE t_tanaorosi SET " sSQL = sSQL & " 実在庫数=実在庫数-(実在庫数-棚卸数)" sSQL = "WHERE" sSQL = sSQL & " 実在庫数=" & pvBase.CvtSQL(TDBGrid.Columns("実在庫数").Value) 商品名を入力すると自動的に実在庫数が入力されるようになっています。 棚卸数を入力して登録して 同じ商品名を入力すると前回入力した棚卸数の数だけ減って自動に入力されるようにしたいのです。 よろしくお願いします。
VB6からMSDEにデータベースを作ったり、 ユーザを追加したり、バックアップしたり、 復元したりするプログラムを作ろうと思っています。 SQL-DMOというのを使えば出来るらしいのですが、 なかなか詳しく書いてあるサイトが見つかりません。 今一番困っているのは、masterの復元なのですが、 何を参考にしたらいいのでしょうか？ どうぞ、よろしくお願いしますm(_ _)m
SQL Server2000で、 テーブル生成スクリプトの実行方法を教えてください。 Enterprise ManagerからＧＵＩで実行できますか？ ジョブステップで実行しようとしたら、SQL文が長すぎて収まりませんでした。 よろしくお願いします。
皆さん初めまして。 SQL Serverのことで少々困ったことが起きてまして、DB素人の私では良く分からずこちらに投稿させて頂きます。 現在、あるアプリケーションにて１分間に１回データを取得しSQL Serverにデータを渡して溜め込んでいくというシステムを動かしています。 毎分のデータはインターネットVPN経由で４ヶ所からデータを取得し、SQL Serverに渡して書き込むといった動きです。受け取るデータと言うのは、 int,int,datetime,datetime,int,numeric×150個 という様な構造をしています。このようなデータセットが４セットあり、これを毎分DBに書き込んでいます。当初は１セットのみだったのですが、途中で３セット増えて４セットになったのです。 困ったことと言うのは、４セットに増えて数週間してからSQL Serverと同居している他のアプリケーション（データを取得するアプリ）に影響が出始め、１分毎にデータを書き込む際、サーバの負荷が６０％を超過し始めるようになったのです。タスクマネージャで確認したところ、負荷の原因はSQLサーバでした。 サーバスペックは以下の通り ・CPU：Pen4 3GHz ・Mem：2GB ・HDD：SCSI U320 32GB×3（RAID5） ・N/W：10/100/1000BASE-T×2 知りたいことと言うのは、SQLサーバの負荷が何が原因で発生していて、何とか下げることが出来ないかという相談です。 DBは私の専門外なので質問の仕方がまずい部分もあるかもしれません。足りない部分があれば、公開できる範囲で対応いたします。 皆様よろしくお知恵をお貸しください。
お世話になります。 ただいまSQL Server 2000を使用し、アプリケーションを動作しようとしたのですが、 環境：Windows Server 2000 SQL Server 2000 クライアント： Windows XP ×2 ２台ともにEnterprise Managerをいれ、SQL にアクセスしようとしたのですが、一台だけアクセスが出来ません。２台ともにファイアウォールは切ってあります。 どうすればいいのか困ってしまって・・・宜しくお願いします。
SQLServer2005が発売されていますが、 VB6+SQLServer2000で十分という中小企業も多いと思います。SQLServer2000はいつまで販売・サポートされるのでしょうか。もし発表されていないのなら、過去SQLServer7.0→2000の時どうだったかなど、経験談を教えて下ると助かります。 よろしくお願いします。
うまく説明できないのですが、 テーブル１　　　テーブル２ No|名前　　　 ID|午前担当|午後担当 ――――　　―――――――――― 01|Aさん　　　01|　　　　　1|　　　　　2 02|Bさん　　　02|　　　　　3|　　　　　4 03|Cさん　　　03|　　　　　5|　　　　　1 04|Dさん　　　04|　　　　　2|　　　　　3 05|Eさん　　　05|　　　　　4|　　　　　5 上の２つのテーブルを結合させて、 結合後テーブル No|午前担当|午後担当 ―――――――――― 01|　　Ａさん|　　Ｂさん 02|　　Ｃさん|　　Ｄさん 03|　　Ｅさん|　　Ａさん 04|　　Ｂさん|　　Ｃさん 05|　　Ｄさん|　　Ｅさん 上のように表示させたいのですが、 どのように結合したらよいのでしょうか？ どうぞ、ご教授よろしくお願いしますm(_ _)m
SQL Server2000のデータ処理をCOBOL言語で開発できますか？ 社内システムの開発コスト低減のためシルバー人材を使い安くあげたいと考えています。田舎のシルバー市場ではOPEN系言語を使える人が十分にはみつかりません、それでCOBOLを使って開発できないかと考えました。 すべての業務をCOBOLで開発するのではなくデータを抽出し加工してテキストデータをつくる部分をCOBOLで行えないかと考えています。 (欲を言えばレコードの追加や更新もできればこしたことはないのですが) システムの寿命は約１０年と見積もっています
参考HPを見たのですが、どうもイマイチよくわからず、ここで質問しました。 ストアドプロシージャ、ジョブなど聴きなれない言葉がありまして、困っています。 どうぞ、ご教授よろしくお願いします。 参考HP http://www.horikawa.ne.jp/msde/support/msde2000- …
SQLServerで、ユーザが定期的に行うタスクなどで、DBロックが起こることはあるのでしょうか。 統計情報更新やテーブル再編成等、ロックが起こりそうなのですが、 その辺りのところは、知識が未熟なためわかりません。 どなたか知っている方がいれば、ご教授頂けますでしょうか。 可能であれば、出来うる限りロックが発生するだろう状況を洗い出したいと思っています。 宜しくお願い致します。
勉強不足で申し訳ありませんが タイトルどおりなんですがWindowsXPにSQLServer2000(StandardEdition)をインストール使用としたところクライアントのみインストールできるみたいなんですけどサーバーにもインストールしたいのですが無理でしょうか？DeveloperEditionならインストールできるのでしょうか？
インストール後、起動しょうとすると次のような エラー表示(ダイアログ)が表示されます。 「サーバに接続できません」 この現象について、解決方法をご存知の方、 おられましたら、どうかご教授下さい。。 何か糸口になりそうなことだけでも 結構ですので、どうかよろしくお願いしたします。。
ALTER TABLEをするSQLを作りたいのですが 走らせる環境にはすでに作ったSQLが走っているかどうかが わかりません。 その場合にif existsで列名が テーブルに入っているか確認したいのですが object_id(N'[所有者][テーブル名]') だとテーブル名は判別できるのですが object_id(N'[所有者][テーブル名][列名]') のように列名を判別する方法はありませんでしょうか？ （このやり方ではダメでした） 宜しくお願いいたします。
SQL Server2000 EnterpriseEditionで、 ネットワークドライブ接続したＮＡＳ（Ｇドライブに割当済）に、既存ＤＢをデタッチし、 ＤＢをＮＡＳにコピーしてアタッチする時、 Ｇドライブ（ネットワークドライブ）が表示されません。 何かいい方法、ツールはありませんか。
タイトルのそのままなのですが、 SQLサーバにて作ったバックアップファイル(.BAK)を、 別のPCにインストールしてある、MSDEにリストアしたいのです。 (ユーザやパスワードの設定は同じです。) 実際にやってみたところ、リストアまではいけるのですが、 復元した後、ユーザでログインできないのです。 「ユーザーの既定データベースを開けません。ログインに失敗しました。」 というメッセージが出て、ログインできないんです。 ユーザーの権限などがうまく復元できてないのかなぁと思うのですが、 どうしたらいいのか、困っています。 どうぞ、ご教授よろしくお願いしますm(_ _)m
SQLのCOUNTでよくCOUNT(*)というのを見かけるのですが、 COUNT(ID)などとした場合と比べて、理論上どちらが早い のでしょうか？
売上のテーブルがありまして、 数量の合計と金額の合計を出していたのですが、 数量の合計が０の場合は表示させないことになり、 下記のようにしてみたのですが、エラーになってしまいます。 かといって、Sum(売上マスタ.数量) <> 0 でもダメでしたし、どうしていいのか困っています。 どうぞ、ご教授よろしくお願いしますm(_ _)m SELECT Sum(売上マスタ.数量) AS 数量の合計, 売上マスタ.単価*数量の合計 AS 売上金額 FROM 売上マスタ Where 売上マスタ.数量 <> 0;
タイトルどおりですが、MSDEで既存のテーブルの テーブル名を変更したいのですが、どのようにしたら よいでしょうか
サーバＡとクライアントＢがあります。同じセグメント。 １０ＭＢで接続されています。 この状態であれば、速度低下は感じられないのですが、 サーバＡとクライアントＢを離れた場所に設置し、間を１Ｍb/sで接続した場合、システムの動作がとても遅くなってしまいます。調べるとODBC経由で処理しているところが遅くなっているようです。 例えサーバＡとクライアントＢを光で接続しても 速度に改善が見られないようなので ＯＤＢＣ経由の接続に限界でもあるのでしょうか。 うまく伝えることができないのですが、 どなたか何か分かりませんでしょうか。
テーブルtableである列aのデータが1,2,3,4,5,6,7,8,9と 入っていたとします。 このテーブルを1,2,5,3,4,6,7,8,9という順番で SELECTしたい場合はどのようにすればよろしいでしょうか？ select a from table where a IN (1,2) union select a from table where a = 5 union select a from table where a NOT IN (1,2,5) としてみたのですが1,2,3,4,5,6,7,8,9と表示されてしまいます。 宜しくお願いいたします。
データベースのトランザクションログとバックアップを取得するプログラムを作成したのですが、 アプリケーションログに以下のエラーイベントが発生します。 イベントID：17055　 18278 : データベース ログが切り捨てられました : データベース : ＊＊＊＊ このエラーのログが出力されないようにする 方法をお分かりになればご教示戴きたく 宜しくお願いします。 -------------- SQLserver2000 VB6 winXP --------------
　急な復旧作業で困っております。ご回答頂ける方 是非ともよろしくお願い致します。 　Windows2000サーバ上で動作しているMSSQL7.0の 環境においてクエリアナライザを使用して下記のコードを 実行しました。 ------------------------------------------ exec sp_attach_db 'new_dts0002', 'D:\dts0002.mdf', 'D:\dts0002.ldf' ------------------------------------------ 　いくつかのファイルは成功したのですが、 一部のファイルで下記のメッセージが出てきます。 ------------------------------------------ サーバー : メッセージ 9003、レベル 20、状態 4、行 1 データベース 'new_dts0002' のログ スキャンに渡された LSN (1458:16:1) は不正です。 接続が解除されました ------------------------------------------ 　このメッセージの意味等調べてはいるのですが 今ひとつ分からない状況です。原因や対策など ご存知の方、どうかご助力頂きたく存じ上げます。
SQLServer2005の環境にて、 日付型の項目(YYYY/MM/DD HH:MM:SS)から日付のみを抽出したい場合、 現在SUBSTRING(CONVERT(VARCHAR,AA),1,10) と変換を行っているのですが、結果が「MM DD YYYY」となってしまいます。 「YYYY/MM/DD」の形式で取得するにはどのようなＳＱＬ文にすればよろしいのでしょうか。
「ID」フィールドにIDENTITYを設定し、1つずつインクリメントして レコードにIDを割り振っていますが、INSERT時に何らかのエラーで 失敗するとその際のIDが欠番となって抜けてしまいます。 これを防ぐ方法、または修正する（欠番になったIDを詰める）には どうしたらよいでしょうか？
つい先日、ここで「T-SQLのカーソルにパラメータは使えますか？」という質問をして、使えることがわかって解決したんですけど、 実際にプロシージャで使ってみると、カーソルから結果が返りません。 以下のように書いています。 CREATE PROCEDURE hoge(@param1 int) AS DECLARE C1 CURSOR FOR SELECT CODE_1 FROM TableA WHERE COLUMN_1 = '0' AND COLUMN_2 = @param1 BEGIN .... END @param1をローカル変数に代入し、そのローカル変数をカーソルに書いても同じです。 また、カーソル定義の「@param1」をプロシージャ実行時の引数に渡していた数値に書き換えると結果は返ります。 T-SQLは初めてなもので原因が全く分かりません。 何が間違っているのでしょうか？
SQL Server2005でストアドプロシージャを作ろうと思うのですが、カーソルにパラメータを実装できないそうで困っています。 やりたいことは、 「ワークテーブルからSELECTして、別のテーブルにINSERT or UPDATEする」 です。 ワークテーブルからSELECTするところをカーソルにするのですが、SELECT条件は可変なので、その部分をパラメータでカーソルに渡したいのです。 Oracleならできたんですが・・・。 どうすれば実現できますか？
いつもおせわになってます よろしくご指導お願いします PC名を変更した場合　SQLにおいて 事後処理として　どこまで必要でしょうか？ 旧PC名の登録削除 新PC名で登録し ジョブのPC名が旧PC名になっていたので ｍｓｄｂのsysjobテーブルの　originating_server 名を手動で変更はできました データベースのmasterのsysserverテーブルのsrvname、datasoouce、srvnetnameに旧PC名が残っているのを 手動で変更できませんでした・・ この部分の変更の仕方を教えてください また、他にも設定しなおさないといけない部分はあるのでしょうか？ 以上　お願い致します
独学でSQLを勉強したいのですが、SQLをパソコン1台で使用する方法を教えて下さい。 よろしくお願いします。
OSQLを起動するために、 コマンドプロンプトで、 C:\>osql -U sa -P パスワード と入力しましたが、 [ODBC Driver Manager]データ　ソース名および指定された既定のドライバが見つかりません。 というエラーメッセージが出てOSQLを起動することができません。 どのようにすれば起動できるのでしょうか？教えて下さい。よろしくお願いします。
お世話になります。 MSDE1.0（Ver7）をMSDE2000（Ver8）SP4にアップグレードしたいのですが、インストーラーのタスクバーが戻ってしまいアップグレードが失敗しています。 実行コマンドは下記MSのURLより setup UPGRADE=1 SECURITYMODE=SQL UPGRADEUSER=AnAdminLogin UPGRADEPWD=AdminPassword DISABLENETWORKPROTOCOLS=1 /L*v C:\MSDELog.log で行っております。 ご指摘等ありましたらご教授ください。 参考URL http://download.microsoft.com/download/7/c/2/7c2 …
MSDEにて、ユーザーを作成する際に、 既定のデータベースに、作成したデータベースを登録したのですが、 作成したユーザーでログインしようとすると、 「ユーザー既定のデータベースを開けません。ログインに失敗しました。」 となってしまいます。 どうしたらログインできるようになるのでしょうか？ どうぞ、ご教授よろしくお願いしますm(_ _)m
MSDE2000SP4で設定されているDBを、まるごとMSSQLサーバー2000に移動したいのですが、どのようにしたらできますか？ また、MSDEのDBをosqlコマンドでバックアップして、そのバックアップデータをSQLサーバーにインポートする事は可能でしょうか？ ご助言お願致します。
サブクエリをネストさせたくない（FROM句に書きたくない）ので、Oracleで使っていたWITH キーワードを使いたいのですが、SQL Server2005では使えますか？
SQLserver2000のＤＴＳ実行結果を、VB6.0で作成したアプリで 「sp_help_job」を使用して取得し、画面表示しています。 ＤＴＳのデータ変換タスクで、ｃｓｖデータをテーブルに ロードしているのですが、ｃｓｖデータがゼロ件だと ＤＴＳが異常終了となってしまいます。 業務の都合上、あるタイミングではｃｓｖデータが ゼロ件になることがあり、この場合は正常終了としたいのですが、 例えば最後のタスクまで到達した場合は、 途中のタスクに異常があってもＤＴＳの処理結果を 正常終了とするようなことは出来ないでしょうか？
コマンドプロンプトで下記のようにたたくとエラーがでて接続できず困っています。 Windows認証でさえ接続できないようです。 サービスマネージャがインストールされており、OSQLコマンドも認識しているので、MSDEはちゃんとインストールされていると思います。 C:\>osql -E [Shared Memory]SQL Server が存在しないか、アクセスが拒否されました。 [Shared Memory]ConnectionOpen (Connect()). MSDEに接続する何かよい方法はございませんでしょうか。 ご助言をお願致します。
お世話になります。 JDBC接続としても質問させていただいたのですが、 java.sql.SQLException: [Microsoft][SQLServer 2000 Driver for JDBC]ソケットの確立時にエラーが発生しました。 の回避法がありましたらご教授ください。 環境は OS：Win2K Pro JDK:1.3.1_18 MSDE:8.00.760 よろしくお願いいたします。
SQLServer6.5を使用しておりますが、環境設定の「tempdb in ram」の設定値を上げたら、起動しなくなってしまいました。 いろいろ調べ、「-f」パラメータでサービスを起動し、「sp_configure」で設定しなおすことが分かりましたが 起動後、エンタープライズマネージャで環境設定など行おうとすると「最大数’5’に既に達しています。」と最大接続数のエラーが出てしまい、「sp_configure」も実行できない状態です。 どなたか原因、対処分かる方、教えて頂けると助かります。 環境は Win2000SV SQLServer6.5 です。 以上、 宜しくお願い致します。
掲題の通りですが、SQLserver2005をクラスタ環境にインストール手順を知りたいのですが、Webに手順が上がっている箇所はありませんでしょうか？
Access2003プロジェクト SQLサーバ2000 Windows2003という環境です。 昨日まで普通に動いていたのですが本日の未明より急にレコードの追加を行うとタイムアウトエラーになってしまうのです。 原因も対処方法も解らずどうしたものか、どなたか対処方法をご存知の方がいらっしゃれば教えていただけないでしょうか。 不足の情報があれば聞いてください。
SQLServerで、小数部の丸め処理で困っています。 切り捨て → round(150.7, 0, 1) 四捨五入 → round(150.7) というところまではなんとかわかったのですが、切り上げ処理がうまくいきません。 ceiling(150.7)やfloor(150.7)などいろいろ試してみたのですが、どうしてもうまくいきません(T-T) どなたかわかる方がいらっしゃいましたらアドバイスお願いします。
次のサイトのどのSAMPLEデータベースをダウンロード していいかわかりません。 http://www.microsoft.com/downloads/details.aspx? … 自分のパソコンがx86、x64、IA64 のどれに合うのか わかりません。 xpのproをしようしています。
お世話になります。 MSDE2000にJDBCにて接続したいのですが、SQLExceptionが発生して接続できません。 JDBCドライバーはMSよりDLして、CLASSPATHに追加しております。 環境は OS：Win2K Pro JAVA:jdk1.3.1_18 です。 JAVAのソースは下記のとおりです。 import java.sql.*; import java.io.*; import java.util.*; public class SQLServerJDBCTest { public static void main(String[] args) { // ログインに必要な情報 String user = "sa"; //ユーザ名 String pass = "password"; //パスワード try { // ドライバクラスをロード Class.forName("com.microsoft.jdbc.sqlserver.SQLServerDriver"); // データベースへ接続 Connection con = DriverManager.getConnection ("jdbc:microsoft:sqlserver://127.0.0.1:1433",user,pass ); // ステートメントオブジェクトを生成 Statement stmt = con.createStatement(); // クエリーを実行して結果セットを取得 String sql = "SELECT GETDATE()"; ResultSet rs = stmt.executeQuery(sql); // 表示 while (rs.next()) { System.out.println(rs.getString(1)); } // データベースから切断 stmt.close(); con.close(); } catch (Exception e) { e.printStackTrace(); } } } おかしな点や追加設定等ありましたらご指摘ください。 （投稿文字制限でExceptionの内容が載せられませんでした。） また、MSDEのバージョン７に接続する場合、同じJDBCドライバーで、同じ設定でいいのでしょうか？ よろしくお願いいたします。
MSDEでは テーブル内容が見れませんが 何かツール（ソフトウェア）を入れることにより見れる ようにならないでしょうか？ 知ってられる方がおられましたら教えていただきたです。 よろしくお願いします。
No.1000123の質問に類似しておりますが、ストアドで求めるのではなく、VB6SP4でCREATE VIEWを実行し、クロス集計のViewをデータベースに作成したいのです。 シリアルNo,商品No,発送日 A001,A,2004/09/10 A002,A,2004/09/14 A003,A,2004/09/14 B001,B,2004/09/10 B002,B,2004/09/14 C001,C,2004/09/18 を 商品No,2004/09/10,2004/09/14,2004/09/18 A,1,2,0 B,1,0,1 C,0,0,1 という形に出力したいときは、具体的にどういう手順でＳＱＬを作成して実行すればよろしいでしょうか。 （日付部分が動的に増えたり減ったりします） よろしくお願いします。
普段はAccessMDBの開発が多いのですが、ADPでのプログラミングに挑戦しています。 TSQLの理解が浅く、ストアドの作成のコツがつかめません。ご教授頂けませんか？ やりたいことは、 ユーザーテーブルにある月間の集計を集計用テーブルへ書き出したいのです。 条件としては、集計テーブルに該当月のデータがない場合は追加、ある場合は更新としたいのです。 Accessからは、コマンドボタンからユーザーIDと該当年、月をパラメータとして渡すことを考えています。
Accessについて質問です。 フィールド数が250程のテーブルのフィールドサイズを変更すると 保存の際に定義されているフィールドが多すぎますとエラーになります。 なぜフィールドサイズを変更しただけなのにフィールドが増えたことになるのですか？（このエラーは最適化をするとでなくなります。） また、フィールドサイズを変更して保存するだけでAccessのファイルサイズが大きくなるのはなぜですか？
データベースとしてMSDEを利用するC/Sアプリケーションを作ろうとしています。 １．アプリケーションをインストールするクライアント端末には、データベースクライアントソフト（※）は必要ですか？ ※Oracle Clientのようなもの。 ２．クライアントソフトをインストールしないで、アプリケーションを使用できる方法はありますか？ ある場合、どのような設定が必要で、それは自動化できますか？ [１がYesの場合] ３．そのソフトはどうすれば入手できますか？ ４．アプリケーション導入時に、そのソフトのインストールまで面倒を見る必要がありますか？ それとも、そのソフトのインストールを前提条件にできますか？ ５．アプリケーションのインストーラで、クライアントソフトのインストールまで実行することは可能でしょうか？
お世話になります。 SQLServer(MSDE)を使用してAccessからの移行をおこなっているのですが、Accessで使用していたワークテーブルの代わりに、自分の接続情報を保持したテーブルを作成し、SELECTする際の条件にしたいと考えています。 その時に、接続情報（IDや番号）等を使用したいのですが、OracleでいうV$SESSIONになる情報を取得するにはどのようにすればよろしいでしょうか？ ご回答よろしくお願いします。
[MSSQL_Ver:SQLServer7.0] [OS:Windows 2000 Server] データベースのバックアップファイルを使用し、 別のサーバーにデータベースを作成したいのですが、 どなたかよい方法を教えて頂けないでしょうか？ やりたいことは、本番環境のデータベースを、 テスト環境に作成したいだけなのですが。。。 よろしくお願い致します。
SQLServer2000で関数などを使用して 指定した年月に実際に存在する日付の一覧を返す クエリなどが作成できないものかと考えています。 例：200604の場合01～30という値を返す 何かよい方法がありましたらよろしくお願いします。
こんにちは。 昨日、会社のWEBサーバの設定を変えました。 いままでは全員が一つのID＆PWでそのサーバにアクセスしていたのですが、セキュリティーを考え、一人につき１ID&PWを与えて、それぞれがアクセスできるフォルダを制限しました。 そこまではよかったのですが、そのあとあるクライアントパソコンで ショップの売り上げ情報などをネットからダウンロードしようとしたところ、 接続できませんでした。　　SQL　state:"28000" SQL serverエラー:18456 [microsoft][ODBC SQL server driver][SQL server] ユーザーはログインできませんでした。 というエラーメッセージがでてしまいます。 エラーの意味もよくわからず、どうにもできません。 パソコン初心者なので、質問自体にも至らない点があるかもしれませんが、よろしくお願いいたします
VBとSQLSerever2003を接続してプログラムしています。 ネットで検索しつつ以下のコードで接続できました。 Set SQL_DB = SQL_WSpace.OpenDatabase("", False, False, "ODBC;Driver={SQL Server};" "SERVER=" & (DATABASE_SERVER) & ";" "DATABASE=" & (DATABASE_NAME) & ";" "UID=" & (DB_ID) & ";" "PWD=" & (DB_PASS) & ";" SELECT文は問題ないのですが、DELETE文とUPDATE文だと、「指定されたテーブルから削除できませんでした」、「更新可能なクエリであることが必要です」とでます。アドバイスをお願いします。
Access2003 Accessプロジェクトのストアドプロシージャでテーブルを更新する処理を作りたいのですが・・・。 内容は、テーブルAにある項目「更新区分」を "0" から "1" に更新します。ただし更新する条件として、テーブルBに登録されている、全てのロットNoと、テーブルAのロットNoが一致するものだけです。 WHERE条件に・・・ 　WHERE テーブルA.LotNo = テーブルB.LotNo とすると、「ADOエラー：列のプレフィックステーブルBは、テーブル名と一致しないか、クエリ内の別名と一致しません」となります。 初歩的な質問ではずかしいですが、よろしくお願いします。
長年のoracle派なのですが、最近、業務でSQLSerever2003を扱うようになった初心者です。 OracleでいうSpl*plusみたいなものってSQLSerever2003にはありますか？「クエリアナライザ」でいいんでしょうか？「クエリアナライザ」だとトランザクションがないように見えるのですが、ROLLBACK、COMMITできるような方法も教えてください。よろしくお願いします。
自分のパソコンがWinXP(Professional)でSQL-Server2000がインストールされています。このときクエリアナライザーのサーバー名で「localhost」って指定は出来ないのでしょうか？OSがWindows2000のときは「localhost」の指定で接続が可能なんですが…
１つのデータベースサーバー(OS:Windows2000)に、 SQLServer2000とOracle9iをインストールしようと思っているのですが、 可能でしょうか？ また、可能な場合に、注意する点などがありましたら教えて下さい。 よろしくお願い致します。
自部署にあるＮＴサーバーにアクセスしようとすると、ユーザー名と パスワードを問うダイアログが出ます。 また、他部署にあるサーバーにアクセスする時も同様です。 （ここまでは当然のことです） ところが、この他部署のサーバーにＳＱＬサーバーがインストール されていて、エクセルのＶＢＡマクロ（RS.Open SQL～　こんなコード） でアクセスするとパスワードを問われることなくアクセス出来てしまいます。 どうしてＶＢＡマクロでアクセスすると、パスを問われるダイアログが 出ないのですか？ ＳＱＬサーバーの仕様でしょうか？
SQL Server にあるテーブルとテキストファイル間のインポート時のトラブルです。どなたかご教示お願いします。 1.テーブルQA にデータが入っています Answerフィールドはvarchar(500) 2.1のデータをテキストファイル(タブ区切り) にエクスポートする＞QA.txt 3. QA.txt から SQL のテーブルにデータをインポートすると エラーとなる 原因：Answer フィールドに改行などのコードが含まれていて テキストファイルに落としたときに これらのコードにより改行されたりして フィールドの形態が壊れているから （QA.txtエクセルで開いて確認） SQL上で テーブル内のデータからこれらのコードを削除する作業を行った上でテキストファイルにエクスポートすればよいかと思いますが その削除するコードはどのように指定すればよいでしょうか。 改行が含まれているようだったので下記を実行しましたが それでも不要コードがまだ残っています。 update QA set AnswerName = replace(answerName,' ', '') where AnswerName like '% %' よろしくお願いいたします。
SQLServer2000上でテーブルを作成して、csvファイルをbcpコマンドを使用してインポートしようとしているのですがうまく実行出来ません。 エラーは 「'-'(ハイフン)の近くに無効な構文があります」 と表示されます。 おそらくデータベース名に-(ハイフン)が入っているため なにか工夫が必要だと思うのですがそれが分かりません。 ちなみに、 データベース名 : aaa-01 テーブル名 : bbb_table CSVファイル : c:\ccc.csv ユーザ : sa パスワード : dddd とすると、 「bcp aaa-01..bbb_table in c:\ccc.csv -E -c -t, -U sa -P dddd」 という感じです。 どこかまずいところがあるのでしょうか？ どうかご教授お願いします。
お世話になります。 既にデータが入力されているテーブルで、identity列のシードとインクリメントをコマンドから変更する事は可能でしょうか？ 可能であれば、どのようなSQL文を実行すればよいのでしょうか？(ALTER TABLE？) ご存じの方がいらっしゃいましたら、 教えて頂けませんでしょうか？ よろしくお願いします。
MS SQL Server2005 Wrokgroup Edition（5CAL）を使っています。ライセンスを追加購入（5CAL分）したのですが、SQL Server　に対して設定する必要があるのでしょうか？あるとすればその方法もお教えください。 Windows Server2003 の場合は、管理ツールの中に「ライセンス」がありますが、SQL Serverの場合はどうなのでしょうか？ 以上、よろしくお願いします。
ASP.NET・SQLServer2000でWebアプリケーションの開発中です。 とある業務で、データの取得および表示方法がどうにもわからずつまづいています。 助言をいただきたく、投稿させていただきました。 画面で年と月を指定し、ボタンを押したタイミングで テーブルAより伝票の一覧を取得して表示する画面です。 伝票番号の仕組みは、自動採番で最初は0001＋付加番号000が発生。 その後は0001＋001～付加番号が増えていく仕組みです。 付加番号が000のレコードと付加番号001以降のレコードは親と子の関係にあります。 例）画面で2006年3月を指定した場合 テーブルAには以下のデータが入っていると仮定。 伝票番号　数量　年月日 0001000　5.0　2006/02/15 0001001　2.0　2006/03/02 0001002　1.0　2006/03/10 その場合、一覧画面には以下のように表示したいのです。 （親レコードを上段、子レコードを下段に表示。 　親レコードか子レコードが画面で指定した年月日に該当する 　場合は一覧に表示させたい） ------------------------- 伝票番号　数量　年月日 ------------------------- 0001000　5.0　2006/02/15 0001001　2.0　2006/03/02 ------------------------- 0001000　3.0　2006/02/15 0001002　1.0　2006/03/10 ------------------------- 0001000　2.0　2006/02/15 ------------------------- どう取得すればよいのかわからず、また、周りに聞ける人もいない 状態です。 SQLのみで取得できるのか、ストアドプロシージャを使わないとできないのかも見当がつきません。 こういったデータを取得したい場合、どうすればよいのか助言をください。 お願いしますm(__)m
SQL Server(2000)はAccessのようなリレーショナルデータベース型でC/S対応のようなものだとお聞きしますが、複数行が書かれているデータを検索できるようなテキストデータベースのようなものは作成はできますでしょうか？ ご存知の方よろしくお願いします。
明細Ａテーブルがあるとします。 [列] 伝票番号(SlipNo) 行番号(ListNo) 商品区分(Kubun) [キー] 伝票番号(SlipNo) 行番号(ListNo) 商品区分(kubun)には 1:商品 2:値引 3:値増 があり、同一伝票内（伝票番号が同じ）に商品区分＝商品(1)の商品がない伝票のみを取得したい場合のＳＱＬがどうもうまく作成できません。 どのようにしたらいいでしょうか？ ex.) SlipNo ListNo Class 1 1 1 1 2 1 1 3 2 2 1 2 2 2 3 3 1 2 4 1 1 4 2 3 [結果] SlipNo ListNo Class 2 1 2 2 2 3 3 1 2 ※伝票1,4は同一伝票内に商品区分=1を含むので抽出対象外 よろしくお願いします。
ACCESSパススルークエリでSQLサーバーのテーブルからデータをインポートする場合において ACCESSのテーブルにあるデータを抽出条件としたいのですがSQL文の記述方法がわからなくて困っております。 根本的な考え方が間違っている可能性が高いのですがどのように記述したらよいか教えていただけますでしょうか。 よろしくお願いいたします。 ・SQLサーバーのテーブル名（S_USR） 　　USRID　 MAIL 　　10001　　10001@test.com 　　10002　　10002@test.com 　　10003　　10003@test.com ・ACCESSのテーブル名（T_USR） 　　USRID 　　10001 　　10003 ・パススルークエリ名(Q_USR)←ACCESS上 ・欲しい結果（T_RESULT）←ACCESS上のテーブル 　　USRID　 MAIL 　　10001　　10001@test.com 　　10003　　10003@test.com 自分で考えたVBAです。 Private Sub Command1_Click() Dim db As DAO.Database Dim rs As DAO.Recordset Dim qDef As QueryDef Dim tDef As TableDef Dim SQLD As String Dim SQLA As String Set db = CurrentDb 'ACCESSテーブル内のデータを消す SQLD = "DELETE * FROM T_RESULT" DoCmd.RunSQL SQLD 'クエリの更新 db.QueryDefs.Delete "Q_USR" Set qDef = db.CreateQueryDef("Q_USR") 'ODBC接続実施 qDef.Connect = "ODBC;" 'フォームから取得したパラメーターを使ったクエリの設定 qDef.SQL = "select USRID, MAIL from S_USR where ID.USRID=S_USR" qDef.ReturnsRecords = True Set rs = qDef.OpenRecordset(dbOpenSnapshot,dsbSQLPassThrough,dbReadOnly) '追加クエリ SQLA = "INSERT INTO T_RESULT (USRID, MAIL) FROM Q_USR (USRID, MAIL) DoCmd.RunSQL SQLA rs.Close db.Close MsgBox "終了" Exit Sub End Sub
SQLServer2000にて「Enterprise Edition」と「Standard Edition」の違いは何でしょうか。 また、VBで作成したシステムを導入する際にはサーバにどちらをインストールすればよろしいのでしょうか。 VBのシステムをインストールするのは30台前後、実際に使用する時は同時に３台程度しか使用しません。 どなたかご教授のほどよろしくお願い致します。
すいませんが教えてください。 AccessVBAのクエリを動かすと、 「警告 : NULL 値は集計またはその他の SET 演算で削除されました。」 というエラーメッセージが出てきて処理が止まってしまいます。 環境はSQL ServerとWINDOWS XPです。 よろしくお願いします。
HAVING句でのBETWEEN演算子の使い方について教えていただけますでしょうか。 MS SQL SERVER のフロントエンドとしてMS ACCESS でパススルークエリを作成中です。 以下のようなテーブルがSQL SERVERにあります。 ID　　　　TIME AAA 　　2005/06/01 00:00:10 BBB 　　2006/02/01 00:00:10 CCC 　　2006/03/01 00:00:10 AAA 　　2006/02/01 00:00:10 BBB 　　2006/02/02 00:00:10 CCC 　　2006/03/02 00:00:10 MS ACCESS パススルークエリで以下のようなSQL文を作成しました。 SQL文 SELECT ID, TIME FROM JOB WHERE TIME between '2006/01/01 00:00:00' and '2006/02/15 23:59:59' 結果 ID　　　　TIME BBB 　　2006/02/01 00:00:10 AAA 　　2006/02/01 00:00:10 BBB 　　2006/02/02 00:00:10 抽出条件は　TIME between '2006/01/01 00:00:00' and '2006/01/31 23:59:59' のままとし、IDをグルーピングしたいと思い以下のように書き換えましたが正しい記述では無いようでエラーとなってしまいます。 SELECT ID, TIME FROM JOB GROUP BY CODE HAVING TIME between '2006/01/01 00:00:00' and '2006/01/31 23:59:59' ORDER BY ID 欲しい結果 ID AAA BBB 正しい記述を教えていただけますでしょうか。 よろしくお願いいたします。
コンピュータ名を変更してしまったばっかりにMSDEが使えなくなりました。 MSDEの名前解決する方法をお願いします。
アクセスログ保存でSQLサーバを使おうとと思っているのですが、件数が多くDBかテキスト保存か迷っております。 状況 ・毎月10種類くらいログ取得対象が存在する。 ・1つの画像には、大体34万/月のアクセスがある。 ・画像は毎月変わる。 これのログを取得したいのですが、 １つのテーブルで管理しようとすると、月に34万x10=340万レコード増えていく事になります。 また画像ごとにテーブルを作成するとテーブルがどんどん増えていってしまいます。 こういった場合はDBを使うのは適切なのでしょうか？ テキストログなどで、1つの画像ごとにログを追加していった方がよいでしょうか？ ・1つのテーブルで情報を管理 ・1つの画像ごとにテーブルを作成して管理 ・1つのファイルごとに管理 のどれがよいと思われますでしょうか？ これほど大きいレコード数を扱った事がないのですが、どなたかアドバイスいただけたらと思っております。 よろしくお願いいたします。
MSDE2000のadministratorでインストール後に一般ユーザで使うことができません。エラー5（アクセスが拒否されました）。MSSQLServerサービスでこのサービス操作を実行中に発生しました。 これはadministratorで起動したときは出ないのですが、他の一般ユーザだと出てしまいます。何かアドヴァイスをお願いいたします。
SQLserver EnterpriseManagerを使っているのですが、同じデータベース内でテーブルの複製（中のデータも含む）を作りたいのですがどのようにすればよろしいのでしょうか。よろしくお願いします。
VB.NETでWebページを作っているのですが、 名前を入れるテキストボックスにどうやって制御したらいいか考えています。 「'」や、「,」とかや「\」など、皆様はどのような、文字を制御しているでしょうか？ 名前をいれるテキストボックスは、SQL-Serverデータベースに登録するようになっています。 (1)制御する文字 (2)制御方法 を教えてくださいー
トランザクションとマージの違いが 知りたいです。 今、AとBの２台同じ機器構成のサーバが あってSQLServer2000 SP3a が入っていて、 AとBは同じDB状態でスタート。 Aだけが日中DBが変更され、 夜間にAの差分DBをBに適用する必要があります。 単純に考えてトランザクションパブリケーション というものを使えばよいのかなと 考えていたのですが、リアルに更新する必要は ないため、マージ？なんとかでも よいというような記述をみかけました。 初心者なものでうまく伝えれませんが、 この場合、トランザクションとマージは どちらが適しているのでしょうか。
UPDATEについて SELECT * FROM A_table A JOIN B_table B ON (A.code = B.code) 上のように２つのテーブルをJOINして、 AのフィールドB.dateフィールドに A.dateフィールドを代入したいのですが、 どのようなUPDATE文を書けばよろしいでしょうか？
お世話になります。 漢字文字が設定されているフィールドをＳＱＬ文にて昇順に並び替えて表示しようとしております。 昇順で並び替えを行った場合、「佐藤」より「大井」が後に表示されてしまうのですが、「大」→「佐」順に並び替えることは出来ないのでしょうか？ 何方かご存知でしたらお教え下さい。 宜しくお願い致します。
基本的な質問で恐縮ですが、SQL Serverとは何ですか？どんな時に使用するのでしょうか？ ACCESSのクエリでSQLビューで構文を記述した事はあるのですが、これとはまた違うことなのでしょうか？ お門違いな質問でもうしわけありませんが、ご回答の程、よろしくお願い致します。
SQL Server 2005 Express Edition は無料なのでしょうか？ SQL Server 2005 Developer Edition 6800円なのでしょうか？ 販売はしているのでしょうか？ どこで買えるのでしょうか 上記２つの製品の機能・値段について 詳しく教えて頂けないでしょうか？
以下のようなストアドでac_valueのcase文3の時は'ZZZ'のところに ac_testの値を入れたいのですが、どうすればよろしいでしょうか？ SQLServer2000です。 よろしくお願い致します。 CREATE PROCEDURE usp_testA AS BEGIN SELECT A.filed1, A.filed2, (CASE A.filed3 WHEN 1 THEN 'SSS' ELSE 'TTT' END )ac_test, B.filed1, (CASE B.filed5 WHEN 1 THEN 'WWW' WHEN 2 THEN 'XXX' WHEN 3 THEN 'ZZZ' )ac_value FROM Ytable A Wtable B WHERE ・・・・・・ END GO
以下のようなDBがありまして、以下のように抽出結果をだしたいのですが、どうやればいいでしょうか？ 2月分のデータを表示 ■DB Date,ItemID ■抽出結果 2月1日|ItemID1の数|ItemID2の数|ItemID3の数 2月2日|ItemID1の数|ItemID2の数|ItemID3の数 2月3日|ItemID1の数|ItemID2の数|ItemID3の数 2月4日|ItemID1の数|ItemID2の数|ItemID3の数 (省略) ※ItemID*の数は該当日の合計です いろいろ調べているのですがわかりません。 どなたか教えてー（＞＜）
はじめまして、どなたか教えてください。たとえば Xというテーブルがあって。AとB２つのフィールドがあります A列 B列 鈴木 100 鈴木 125 鈴木 156 佐藤 354 佐藤 552 佐藤 132 田中 151 田中 99 田中 845 というテーブルから a列の中のものはdistinct 的な取り出し方をしつつ B列で最も大きな数字のa行を取り出したいのです 取り出したい結果 A列 B列 鈴木 156 佐藤 552 田中 845 とするにはどうすればよいのかさっぱりわかりません どなたか教えてくださいませ
お世話になっております。 SQL Server2000で任意のテーブルのインデックスを調べたいのですが、 どうやったら良いのでしょうか？ EXEC sp_indexes を実行すると、 サーバー '○○' は DATA ACCESS 用に設定されていません。 というエラーになります。
初心者過ぎてすみません。SQL Server ってどんなソフトですか？
現在SQLServer2000を使用しています。 存在しているテーブルから主キーを取得したいのですが うまく行きません。 sysobjects,syscolumnsシステムテーブル辺りから 取得できそうでできないのでイライラしています。 どなたかご教授お願いいたします。
お世話になっております。 T-SQLで、以降のコマンドを実行したくない(強制終了したい)場合は、どのように書けばよいのでしょうか？ 例えば、[SQL文1]でエラーが発生した場合、[SQL文2]を実行したくない状況です。<A>の箇所はどうすればよいでしょうか？ [SQL文1] GO IF @@ERROR<>0 <A> [SQL文2] GO よろしくお願い致します。
いつもお世話になっております。 早速ですが、 環境 クライアント： 　XP Pro sp2　 　　　SQL2000 サーバ： 　2000Server 　　　SQL2000 上記状態でサーバのSQLにアクセスを行ってもアクセスできません。SP1の状態ではアクセスできたのですが… 勉強不足で申訳ありません。よろしくお願い致します。 ※追記(1)ログイン直後はアクセスできます。しばらく放置しておくとアクセスできなくなります。 ※追記(2)XPのファイアーウォールはとめてあります。
SQLについて質問です。 VBからMDBにSQLでデータの参照をしたいのですが ("select * from abc where No = " & No & " ;") テーブル内の数ある項目の中で一つだけまたは複数除いて参照する場合のSQL文を教えてください。 項目が60個ほどありますので一つ一つ指定していくとすごく長いSQLになってしまいそうですのでお知恵をお貸しください＞＜
お世話になります。 初歩的な質問で申し訳ありません。 T-SQLで、変数 @Str に値を代入する場合、 DECLARE @Str VARCHAR(100) SET @Str = 'TEST' -- (1) SELECT @Str 'TEST' -- (2) (1)と(2)の二通り書けるみたいですが、 どのように違うのでしょうか？ よろしくお願いします。
SQLServerがインストールされているサーバー機があります。 このサーバーのHDにデフラグ（最適化）をかけたいのですが，ＤＢを実行したままで大丈夫でしょうか？ ＤＢを停止してから行うべきですしょうか？ よろしくお願いします。
お世話になります。 WinXP-Pro（SP2）マシンがあります。 MSDE2000relA（SP2対応）をインストールしました。既定のインスタンスのみでの利用です。 これにSP4（SQL2000.MSDE-KB884525-SP4-x86-JPN.EXE ）をインストールしたいと思います。ところが、「指定のインスタンス名は無効です」とエラー表示され、インストールできません。 インスタンス名はMSSQL、MSSQLSERVER、Microsoft SQL Server Desktop Engine、など等あちこち調べて拾ってきたものを設定して試してみたのですが、通りません（新たなインスタンスが作成されてしまいます） 正しいセットアップの方法（インスタンス名の指定方法）をご存知の方、いらっしゃいましたら是非教えて下さい。宜しくお願い致します。 或いは、そもそも既定のインスタンスのみでの使用、というのはイレギュラーなんでしょうか？
H/Wは異なりますが、OSはWindowsNT4とSQLServer6.5というサーバーが２台あります。 その一方から他方へ、定期タスクでデータベース/オブジェクトの転送を試みているのですが接続エラー（エラーメッセージ：転送元のサーバーに接続できません。）が発生します。しかし、定期タスクではなく手動で転送すると正常に転送完了します。 原因はネットワークにあるのかSQLサーバーにあるのかの判断もできない状態です なお、転送の目的はバックアップです。バックアップには他の手段を勧められる方もいらっしゃると思いますが、今回の問題に対する解決策をご教授願います。 宜しくお願いします。
教えてくれませんか？ 説明のあるＨＰでも結構です 余り詳しくないのですが、 接続しなければならなくなってしまいました なお環境は、イントラネットで、ＳＱＬサーバーのインストールされたＰＣは、別にあります どうかよろしくお願いします
ADODB.Connectionを使ってデータベースにアクセスするWebコンテンツをVB.NETで開発しているのですが、 下記ソースの(1)の場所で、「System.NullReferenceException:オブジェクト参照がオブジェクト インスタンスに設定されていません」 といったエラーがでしまいます。 このソースは動作実績があり、開発環境では動作します。 これをサーバにアップし動かすとエラーがでてしまいます。 ■PageLord関数 　～略～ DB.Provider = "SQLOLEDB.1" DB.Open("Data Source=" & CON_DOMAIN & "; Initial Catalog=CON_DBNAME; UID=" & CON_ID & "; PWD=" & CON_PSWD) SQL = "select * from dbMst" RS = DB.Execute(SQL, , 1) If Not RS.BOF And Not RS.EOF Then strDBName = RS.Fields("dbNm").Value '(1) End If RS.Close() DB.Close() ※自分で調べてみたところ マイクロソフトサポートオンラインに 「 Visual C++ .NET で ADO.NET コマンドを実行したときに出力パラメータが返されない」 http://support.microsoft.com/default.aspx?scid=k … このような記述があったのですが、関係しているのか？ 関係している場合どうやって修正したらいいかわかりません。誰かお助けを(；；)ノ
Windows 2000 SQLplus 35万件～40万件のデータに行番号をつけて抽出したいんですが、現在は抽出時にROWNUM関数を使用しています。 それを、150,000件抽出されたら、150,001件目からは1からカウントする関数があれば使用したいと思います。 どなたかご存知の方がいらっしゃれば、アドバイスお願いします。
VBのアプリケーションで、SQLServerのWindows認証を使って開発を行いました。 データの更新が行われるので、ユーザには更新権限を設定しています。 データセキュリティのために、データの更新はアプリケーションからしかできないようにして、ODBC接続などではできないようにしたいと思っています。 SQLServer認証にしてしまえば、そのログインID、パスワードを教えなければいいのですが、Windows認証にした場合は、どのような設定をすれば実現できますか？ よろしくお願いいたします。
WindowsServer2003のインストールされている２台 があって、どちらもSQLServer2000が入っています。 同じデータベース名で１つだけＤＢがあります。 サーバＡのデータをある特定時間（例えば夜間）に サーバＢにコピーして更新（コミット）させる ことは可能でしょうか？ 可能の場合どのようにしたらできますでしょうか。 実現に際し、条件などあればそれも併せて教えて 下さいませんでしょうか・・・。 できればＡのＤＢの内容全てではなく、 例えば同じ状態のＤＢが２つあって、Ａだけ １日動作させて、夜間にＢにデータを送る時には 差分だけを更新させたいです。 どなたか助けて下さい。 SQLserverのみの機能でできますでしょうか。。
検索のWEBサイトを作成しています。 ユーザの入力値を分解し、ストアドプロシージャに渡してDB検索をしたいのですが、パラメータ数を動的にするには、どうしたらいいのでしょうか。 どなたかアドバイスください。
ID、Name、Date、Pointのカラムがあり、レコードは３００程度です。 データベースに登録されているデータで、Dateの最終日から２日間の データを一回のクエリ発行で取り出すようなクエリを作りたいのですが どのようになりますでしょうか？ それともMAX(Date)で最終日を取り出して、それからBETWEENなどを つかって取得という２段階にクエリ実行するしかないでしょうか？
いつもお世話になっております。 SQLSereverにおいて SELECT時の件数制限を行う事は可能でしょうか？ MySQLのLIMIT句と同様の動きになることが理想です。 例） SELECT * FROM TABLE LIMIT 5 ,10; 5レコード目から10レコード分のデータを取得する。 以上、よろしくお願い致します。
お世話になります。 SQLServer2000、クエリアナライザで質問があります。 ファイルに書かれた一連のSQLの実行したいとき、 ORACLEでは、SQL*PLUSから ファイル名の前に@をつけて実行できました。 また、SQLスクリプトの中で、別のSQLスクリプトを呼び出す場合は、@@を付ければできました。 このような事を、クエリアナライザから行いたい場合、どのようにすれば可能でしょうか？ よろしくお願いします。
MSAccess2000または2003からSQLServer2000のテーブルをODBC経由でリンクテーブルとし、直接開いてデータを更新しようとしたら「オプション機能は実装されていません」とのODBCエラーが出ます。 バージョンは以下の通りです。 SQLServer2000(SP3a) MSAccess2000(SP2) MSAccess2003(SP2) ODBC SQLServerドライバ(2000.85.1117.00) テーブルによってエラーが出るときと出ないときがあるのですが、特別違いは見当たりません。 解決策を教えてください。よろしくお願いします。
SQL Server Management Studio Expressを日本語に対応させることは出来ないでしょうか。 よろしくお願いいたします。
お世話になります。 現在、SQLServer2000を使っています。 SQLServer2005へアップグレードを検討していますが インストールすると、自動的にアップグレードしてくれるのでしょうか。 よろしくお願いいたします。
a　　　b　　　c　　　d ------------------------ A　　　2　　　be　　　3 A　　　9　　　re　　　44 A　　　1　　　qa　　　43 B　　　5　　　yt　　　11 C　　　2　　　uu　　　39 C　　　7　　　oi　　　55 このようなテーブルでaが同じだったらbの値が一番大きなものだけを 取得したいのですが、どのようにすればよろしいでしょうか？ select a, b, c, d from X . . .
SQL Server＋SQL クエリアナライザ上で実行するSQLのスクリプトを書いていて、DATEADD 関数の書き方で困りました。 現在の日時から１ヶ月後を表示するには、 (1)　　select DATEADD(Month, 1, GetDate()) でできますが、このときの日付要素の引数 Month には省略形が使えることになっています。 (2)　　select DATEADD(mm, 1, GetDate()) (3)　　select DATEADD(m, 1, GetDate()) で、このときに、ASPの癖で、ダブルクォートで囲って (4)　　select DATEADD("m", 1, GetDate()) とやってしまったんんですが。 上記(4)の記述方法でも、開発環境では文法エラーにもならず、実行結果も期待した値が表示されました。 ところがそれを運用環境のSQL クエリアナライザで文法チェックしたら、 「パラメータ１はdateaddでは指定できません」 というメッセージがでてしまいました。 (1)の記述方法に変えたら、運用環境でも問題なく実行するようになったのですが、まったく納得いきません。 例えば実行させるクエリアナライザのバージョンによって、日付要素の引数の書き方が違うというような事があるのでしょうか？ MSのサイトで検索しても見つからなかったのですが、捜しかたが悪いでしょうか。 同じようなことを他でもやってる可能性もあり、原因を特定させないととても怖いです。 開発環境は 　　SQL Server Standard Edition 7.00.1063 　　SQLクエリアナライザ Version SQL 8.00.760 　　OSは…確認しそびれました。 運用環境は 　すぐには判らないのですが、SQL Server7.0ではあるでしょう。
AccessのMDBをADPへ作り変えています。 MDBの更新クエリーの場合、「レコードの更新」欄に更新したい値を記述します。たとえば、ユーザー定義関数を使っている場合は、ユーザー関数名([○○○]) ・・・。 これと同じことを、ADPのストアドプロシージャで行う場合はどのようにすればよいのでしょうか？ スツアドプロシージャは「デザイナを使用してストアドプロシージャを作成する」を使って作成しています。ここで、「新しい値」欄に ユーザー関数名（○○○） と記述すると、 ”ADOエラー："ユーザー関数名"は関数名として認識されません” となります。 初めてADPを使用するのでよくわかりません。 以上、よろしくお願いします。
システム初心者です。 今、SQLServerについて色々調べているのですが、 ・SQLServerの種類(今の最新は2005でしょうか?) ・ライセンス形態(サーバ別、クライアント数、同時アクセス数) ・価格 等がまとめられているサイトはありますでしょうか？ 何よりもライセンス形態が複雑で良く解りません。 どなたかご教授下さいｍ（＿＿；）ｍ
ASPを使ってSQLServerからのデータ取得ができません。 クライアントのPCから、Webサーバ経由でDBサーバへアクセスすると、 『[Microsoft][ODBC SQL Server Driver]分散トランザクション エラー』 というエラーメッセージが表示されます。 WebサーバとDBサーバが同一ＰＣ上にある場合は、問題なく実行できます。 また、同じテーブルを使って、簡単なサンプルコードを実行した場合では、WebサーバとDBサーバが別々のPC上にあっても問題なく動きます。 原因はIIS、もしくはSQLServerの設定にあるのか、それともASPファイルのソース自体にあるのか、わかりません。 どなたかご存知の方、よろしくお願いします。 DBとの接続はADO接続で、環境は、 Webサーバ/WindowsXP Pro、IIS 5.0 DBサーバ/WindowsXP Pro、SQLServer2000 を使っています。
DBはMSDE。　肝心のフィールドはTimeでDateTime型で、以下のようなデータがあります。 Time 5：00：00PM 5：30：00AM . . これをストアドで返します。普通に　SELECT Time ... 以下略。　クライアント側、sqlCommand -> パラメタ　の設定　-> sqlDataAdapter -> DataSetにエントリを返し　-> DataGrid1.DataSource = DataSet.Tables(0) これで、実行すると、返ってくる値は　すべて 30/12/1899 となります。時間の部分は何も出ません。これはDB側に、日にちを入れてないので出てくるデフォルト値と思われます。 次に、前の　SELECT文に　CAST（sql＿variant、Time)　を加えると、30/12/1899 5:00:00PM と出ますが、sql＿variant型なので、SABSTRINGで切れません、上のCAST文にさらにCONVERT（Varchar(30),,)をかぶせると、30/12/1899 に戻ってしまいます。 今まで試した方法は、 CONVERT（Varchar(30),Time,108) CONVERT（Varchar(30),Time,8) CONVERT（char(30),Time,108) CONVERT（Varchar(30),Time) EXTRACT　(Time.....) 等などあらゆる方法（データ型のバリエーションを含む）を試みましたが、返されのは30/12/1899ばかりです。 DateTimeはDB側で比較のクエリに使用するのでをVCharに変えることはできません、Timeのデータにダミーの日にちを付け加えたくもありません。 なんとか時間だけを取る方法をご教授ください。お願いします。
現在WindowsServer2003(IIS)+SQLServer2005の構成でWebシステムを構築しようと考えております。 Webにアクセスする端末(ユーザー)は30程度です。 実際にSQLServerにアクセスするユーザーはIISのユーザーのみとなりますが、端末数分のクライアントライセンスまたはプロセッサライセンスが必要になるのでしょうか？ よろしくお願いします。
sql server2000 Datetime型のフィールドを更新したのですが、うまくいきません。 2005年1月14日をいれるにはどうすればよろしいでしょうか？ Update r_event Set ew_date = 2005-01-14
No.1895341 で質問した者ですが、あるデータをWebで表示させているのですが、うまくいきません。 <PRE>タグで解決したつもりでしたが、右端で自動折り返しされないことに気づきました。。。 SQLServerのテーブルに格納してあるデータをWebで表示するときに 文章になっているようなデータの場合、 皆さんはどういう手法で改行を処理されているのでしょうか？
SQLServerカテゴリかXMLかHTMLかどこに質問したものかと迷いましたが、ここに投稿させていただきます。 SQLServerのFAQテーブルがあり、そのデータを Webで見れるようにしているのですが、 改行のあるデータをWebで表示するときに、 そのままだと、改行されません（当然ですが）。 ちなみに、ストアドでXMLデータを返してXslスタイルシートでHTMLのテーブル内に各FAQデータを入れて表示しています。 改行を'<br />'に置換してみましたが、当然文字として表示されます。。。 文字内にHTMLタグがあればHTMLタグと解釈して表示するようなHTMLタグは無いんでしょうね。。。 SELECT FaqID, Title, replace([Question]),char(10),'<br />') AS Que, replace([Answer]),char(10),'<br />') AS Ans FROM FAQ WHERE FaqID = @nID FOR XML AUTO,ELEMENTS XSL側で、置換した文字列（今は'<br />'）を探して文字列を分割し、 あいだに<br />タグを入れることは出来ますので、最悪そうしますが、 1ページに沢山のFAQを表示するので、 1件づつその処理を行うのは重くなりそうで、気がすすみません。 私がWeb関連は不慣れだからてこずっているだけで、 慣れた方でしたら「普通こうする」とかがあるのではないかと思い投稿しました。 よろしくお願いします。
SQLserver2000(10クライアント)の見積をとって購入を考えているのですがどこの会社で販売を行っているのか分かりません。 数社の見積を頂いてから購入したいと思っています。
SQLについて質問です。 上司からデータベースとのデータのやり取りで誰かが操作中は他から参照・変更できないようにパススルークエリを使えといわれました。 パススルークエリとはどのようにして使用するのでしょうか？ この場合トランザクションを使用するのが適切ではないんですか？
SQLserverのサービスをリブートしたときに 下記のようなエラーが出ました。 HPとか調べていますが、 今回の現象と 同様の現象の情報が記載されていません。 下記エラーについてご存知の方 なにか教えていただけないでしょうか？ ポート1433をSQLserver以外の何かが 使用する可能性ってありますか？ エラー 「SuperSocket 情報 :TCP ポート 1433 でバインドに失敗しました。」 DBサーバ OS：WINDOW2000serverSP4 DB：SQLserver2000SP4 DBサーバ：SQLサーバサービスは 下記のコマンドで行っています。 NET STOP "SQLSERVERAGENT" NET STOP "MSSQLSERVER" NET START "MSSQLSERVER" NET START "SQLSERVERAGENT" ちなみに2年近く稼動しているシステムですが、 初めて出たエラーです。 エラーが出た時と 出てなかった時の DBサーバはほぼ変わっていないと思います。 今まで同様の環境で出てたかったエラーが 急にでました・・・。 SQLサーバ再起動後、 他のPCからPINGは通りますが、 他のPCEnterpriseManagerからDBを参照する ことができません・・・。 接続エラーになります。 (もちろんDBサーバ上ではDBは見れます) ちょっとしたことでも良いので、 アドバイスよろしくおねがいします。
列のDEFAULT設定を削除するコマンドを 教えてください。 ヘルプには、 DEFAULT設定を変更するにはまず削除 とあるのですが削除方法が載っていません。 MSDE2000を使用しています。
初心者です。 クラアント　ｗ２ｋ　＆　ａｃｃｅｓｓ２００２ サーバ　ｗ２ｋｓｅｒｖｅｒ　＆　ＭＳＤＥ２０００Ａ 一般認証でもＳＡでも接続可 一応クライアントとサーバー間では、つながって、 簡単なデータ交換もできました。 でも２台目のクライアントとサーバーがつながらないのです。もちろん、直接サーバのファイルをみることはできるので、ＭＳＤＥの方の原因だと思うのですが。・・・ １台目と２台目の違いといえば、ＭＳＤＥとその他の管理用のアプリをインストールしたぐらいです。 でも、マイクロソフトのＨＰには、クライアント側にはＭＳＤＥのインストールはいらないように書いてあるようですが、何か他にインストールする必要があるのででしょうか？よろしくお願いします
お世話になっております。 このたびSQL Serverを使用しまして、顧客管理ソフトを作成しようと思います。 SQLへはインターネットを通じてサーバへアクセスし、事務所の担当者などとの関連付けなどもしようと考えております。 当初VBで作成していたのですが、送受信データ量が多くなりすぎて処理開始から処理終了まで時間がかかりすぎました。送受信データ量を少なくするように改良などを加えましたが、まだ遅く感じます。 そこで皆様は顧客ソフトなどを作る際にどの言語を使用し、どのようなことをして通信を早くされているか。また、心がけている点などありましたらご教授いただけないでしょうか？ よろしくお願いします。
こんにちは。 どなたか可否や方法についてご存知であれば教えて下さい。 SQL2005で作成したMDFファイルにAccess2002からプロジェクト接続（adpファイル）しようとしているのですが、タイムアウトになってしまって接続できません。MSDE2000Aで作成したファイルには接続できたのですが。。。 サーバー名（localhost）、ユーザー名（sa）、パスワード、ＤＢ名については確認済です。 よろしくお願いします。
いつもお世話になっております SQLServer2000を使用しております。 あるテーブルに a,b,c,dという4つの項目が存在している状態で aの前にzというフィールドを追加したいと考えております。 Enterprise Managerを使えば簡単に行うことが出来ますが、 これをクエリアナライザで行いたい場合に どのようにSQL文を記述すればよいのか、見つけることが出来ませんでした。 このようなことは可能なのでしょうか。 ご存知の方がいらっしゃいましたら、ご教示のほど、何卒よろしくお願いいたします。
SQLServer2000のサーバー本体がインストールされているPCとSQLServer2000のクライアントのみがインストールされているPCがありまして、２つは同じネットワークに存在しています。 クライアントPCからサーバーPCのデーターベースにアクセスしたいのですが、接続がうまくできません。 SQLServer2000のサーバー本体のインストールはドメインユーザーアカウントでおこないました（ドメイン：TOSHIBA インスタンス名：SQL2000）。 クライアントPCのサービスマネジャーを起動してサーバー「TOSHIBA\SQL2000」サービス「SQL Server」として開始しても「アクセスが拒否されました」となってしまいます。 方法で誤っていること、足りない設定があるのでしょうか？ 教えてください。
先頭一文字だけ残して後は同じ文字でUPDATEしたい カラムがあります。 初心者で申し訳ありませんが教えていただきたいと思います。
いつもお世話になっております。 ADO.NETの話なのですが、トランザクションを開始したコネクションオブジェクトで DataAdapterを使ったSELECTと、ExecuteNonQueryを使ったUPDATEを交互に繰り返し 行うことはできるでしょうか？ 現状できていないので可能なのであれば共通関数の見直しが必要かと思っています。 いまはSELECTとUPDATEを別のコネクションで行っているのですが、UPDATE後に 同じテーブルの該当レコードをSELECTにいくため、デッドロックが発生しています。
こんにちは 初めて質問させていただきます。 SQL Server2000の環境で Enterprise Managerからあるテーブルに対して更新処理を行うと 『ファイアホースモードの間はトランザクションを開始できません』というエラーが出てしまい、更新処理を行うことができません。 上記エラーは トランザクションが既にかかってる状態で、さらにトランザクションを開始しようとしていた場合等で生じるエラーでありますが、 再起動⇒Enterprise Manager⇒テーブル更新⇒エラー となり非常に困っております。 また、エラーとなるテーブルに対し、クエリ アナライザからUPDATE文を実行すると登録することができます。 上記内容で心当たりのあるかたご教授のほどよろしくお願い致します。
http://www.microsoft.com/japan/sql/downloads/tri … こちらのページからダウンロードできる？？ はずですが、登録してログインしても反応がありません。どなたか情報をお持ちでしょうか？
MSDE ReleaseA と WindowsXP,Access2000を使用しています。 Windows認証にした場合、MSDE側にEnterpriseManagerでセキュリティ-ログインでguestを作成すると別のパソコンから接続できます。Access2000でメニューのファイル-接続すると自動的にguestで接続しているようです。guestではなくパソコン名等で別のパソコンから接続するにはどうすればいいのでしょうか。 初心者です。よろしくお願いします。
はじめて教えてgooを利用させていただきます。 質問ですが、たとえば、 SELECT 項目1, 項目2, 項目3 FROM テーブルA WHERE 項目1 = 1 ORDER BY 項目2 の結果セットの内、上から30件目～60件目だけ欲しいのですが、 どう記述すればいいのか悩んでいます。 いい方法があれば教えてください。
2000から2005へテーブルデータの中身をコピーしたいのですが、方法を教えてください！。 データのインポートによりテーブルはコピーできました。
SQLServerであるテーブルを行ロックしています。 (select * from テーブルＡ with (UPDLOCK) where KEYCD = 1) 行ロック実行時に、他のマシンが既にロックしていた場合、それをエラーとして返す方法はありますでしょうか？ (Oracleでいう"nowait"のようなもの) 最近SQLServerをやりはじめたばかりの超初心者です。 よろしくお願いします(T_T)
SQLServer初心者の管理者です。 エンタープライズマネージャーからテーブルデザインの書き出しってできますか？できればテキストファイルかエクセル形式で書き出したいのですが。。。 よろしくお願い致します。
ＶＢ2005とSQLServer2005のどちらも製品版をインストールしました。 VB2005よりサーバエクスプローラから接続の追加により自分で作成したテーブルに接続を試みたところ、 以下のようなエラーが発生し接続できません。 （エラー内容）サーバーへの接続を確立しているときにエラーが発生しました。SQL Server2005に接続しているときにこのエラーが発生した場合は、SQL Serverの既定の設定がリモート接続を許可しないようになっていることがエラーの原因である可能性があります。（provider:共有メモリ　プロバイダ,error:40-SQL Serverへの接続を開けませんでした) なにかSQLServer側の設定を変更しないと接続できないのでしょうか？ どなたかアドバイスお願いします<(_ _)>
現在仕事でデータ移行プログラムを作成しています。 内容的にはCSVファイルからデータを読み出し、多少のチェック後、 DBのテーブルに登録するといったものです。 今回何を質問しているかというと CSVを一行ごとに読み込んでチェック、テーブルへ登録していたのですが、 チェック項目には全体のデータを参照しないと確認できない項目が 追加されました。 この項目をチェックするために一時的にCSVから読んだデータを登録しておける テーブルを作ったりしたいのですが、それができるかと もしできるのであればその方法も教えていただきたいです。 環境は 言語：VB6.0 DB:SQLSerever2000 です。 ほぼ未経験で開発の現場に入ってしまったため困っています。 もしお分かりの方いらっしゃいましたらお力貸していただけないでしょうか。 よろしくお願いします。
ORACLEで簡単にできたのがSQLServerで上手くできなくて困っています。 下のようなSQLです。SQLServerでUPDATE時に別名を付けようとすると エラーになってしまいます。良いSQLをご教授頂ければ、と思います。 update emp e set sal= 　(select max(ee.sal) from emp ee where e.deptno=ee.deptno)
以下のようなSQL文で CREATE TABLE Test Mykey Varchar(50) この Mykey の既定値を（仮に）"abcd" などと指定するにはどのように記述したらよいのでしょうか
SQLServerの再起動をスケジューリングしたいです。 この程度ならググってすぐ分かるだろうと思ったのですが、見つかりませんでした（探し方がアカンなぁ）。 すみません、宜しくお願いします。
VB.NETとSQLServer2000でWebアプリをつくろうと思っています。 VB.NETとSQLServer2000の接続がよくわからないので教えてください。 ある書籍でVB.NETとSQLServer2000の接続文字列は下記のとおりだと書いてありました。 '接続文字列を作成して接続を開始する sqlCn.ConnectionString = "data source=Server;" "initial catalog=DB201;" "user id=db201;" "password=db201;" "persist security info=True;" sqlCn.Open() ここでの「data source」「initial catalog」「user id」「password」などの情報をインストール済みのSQLServerで調べたいのですが、どのようにするのでしょうか？ 「data source」がもしサーバー名であれは、サービスマネジャーで実行されているサーバー名でよいのでしょうか？ どうか教えてください。
会社でsqlserver2000を使用したASPの開発を行っているのですが、 開発する上でなにか便利なツールはないでしょうか？フリーでもシェアソフトでもけっこうです。 皆さんが使用しているものでお勧めがあればご紹介頂けないでしょうか？ よろしくお願いいたします。
クエリアナライザを使用し、以下のような複数のステートメントを実行するクエリを流します。 「BEGIN TRANSACTION TRAN_X INSERT文1; INSERT文2; UPDATE文3; …」 最終的に成功したら commit、途中でエラーが出たらrollbackしたいと考えています。 @@ERRORでなくJAVAでいう「try～catch」またはVBでいう「ON ERROR」構文のようなものはないのでしょうか？ どなたかご教授お願いします。
tora0125と申します。よろしくお願い致します。 データベース：SQLServer2000とSQLServer2005CTP 開発：VisualStadio.NET2003 言語：C# データベースDB_AとDB_Bというものがあり、随時アクセスするデータベースを変更したいと思っております。 cn.ConnectionString = "Data Source=LOCAL" + "; User Id=TEST" + "; Password=TEST" + "; initial catalog=DB_A" + "; persist security info=True;"; 上記のようにコネクションの設定を行っております。主となるデータベースはDB_Aです。 その後、必要となったときにDB_Bにコネクションを変更する方法をどなたかご教授下さい。 拙い文章でわかりずらい箇所があると思いますが、どうぞよろしくお願い致します。 カテゴリー違いでしたら申し訳ございません。
OracleのLAST_DAY関数にあたるものは、SQLServer（T-SQL）には用意されていないのでしょうか？ やりたいことは、select文で拾ってきた日付をもとにその月末日を表示させたいのですが。。。
以前、IBMのオフコンでシステム開発を行っていた時期があります。 転職して今はネットワークエンジニアとしての仕事に就いておりますが、必要に迫られて、社内の部門システムの開発を始めようと考えております。 そこで、社内の販売管理の SQL Server のテーブル名、カラム名を確認してみると全て日本語で定義されております。 確固たる根拠はないのですが、どうしても違和感を覚えてしまいます。 今回の開発目的は、部門内のこまごました業務のシステム化で、顧客管理、グループ間の作業依頼や履歴管理等で、Visual Studio .NET 2003 + SQL Server 2000 を使って私一人で開発を行う予定です。 Windows フォーム、Web フォーム(ASP.NET)も利用予定です。 さて、前置きが長くなってしまいましたが、以前は、外資系の会社にいて日本語利用不可のシステム（データベース）でしたので、何も考える必要がなかったのですが、今回の開発を始めるに当たって SQL Server のテーブル名、カラム名の定義を日本語を行った場合の利点、欠点、考慮点等があれば教えて頂きたくて質問しました。 販売されている業務アプリやグループウェアの SQL Server のテーブルやカラム定義を見ても日本語は今まで見かけたことがないのですが、プロの開発者としてのご意見が伺えれば幸いです。
Microsoft SQL Enterprise Manager Microsoft Corporation バージョン: 8.0 id name ----------- 1 あり（A） 2　　あり（B) 3　　なし このテーブルを なし あり（A) あり（B) となるようにしたいです。 任意の並べ替えはできるのでしょうか？ 色々調べてはみましたが、解決できません。 例 select name from * order by switch ([name] = "なし",1, [name] = "あり（A)",2, [name] = "あり（B)",3,） のように組んでいますが、＝　が構文エラーになってしまします。 よろしくお願いします。
Microsoft SQL Enterprise Manager Microsoft Corporation バージョン: 8.0 id name ----------- 1 あり（A） 2　　あり（B) 3　　なし このテーブルを なし あり（A) あり（B) となるようにしたいです。 任意の並べ替えはできるのでしょうか？ 色々調べてはみましたが、解決できません。 例 select name from * order by switch ([name] = "なし",1, [name] = "あり（A)",2, [name] = "あり（B)",3,） のように組んでいますが、＝　が構文エラーになってしまします。 よろしくお願いします。
SQLについて質問です。 例えば、テーブルの中に(田中　鈴木　池田　大木)という項目がスペースで区切られてあったとします。 これを個々に取り出したいのですがどのようなSQL文でできますでしょうか？
現在SQLServer7.0を使用しており、困っていることがあります。 SQLServer Enterprise Manager→ツール→データベースのバックアップのところの「内容」にでてこないバックアップが毎日上書きで動いています。 この内容を変えたいのですが、どこを見ればいいのでしょうか？ やりたいことは毎日「データベース全体」のバックアップをFドライブ(外付HDD)に新たなファイルとして保存していきたいのです。 試しに上記のデータベースのバックアップのところで新しいバックアップスケジュールを作り、そこで「メディアに追加」を選んでみましたが、どんどん上書きされてしまいます。 当たり前ですが、この場合が最初に書いたものと合わせ2本のバックアップが動きます。 どうかお分かりの方、教えてください。 もし、足りない情報がありましたらすぐ書きますので 教えてください。
現在、売上の明細を明細IDごとにグループ化し合計値を表示させるプログラムを開発中です。 以下のような要件を満たすSQL文を教えてください。 【もともとの売上の明細のテーブル】 明細ID | NAME | KINGAKU 001　　|商品A | 1000 001 |商品B | 500 001 |商品C | 300 002 |商品A | 1000 002 |商品D | 1500 【グループ化後のテーブル】 明細ID | NAME | KINGAKU 001 |商品A | 1800 002 |商品D | 2500 ・明細IDごとに金額を合計する。 ・NAMEの列については、その明細IDの中で最大の金額の商品名を入れる。 ※現在、明細IDごとに金額を合計するのはできているのですが、 　もう１つの要件をどのようにすれば達成できるのか分からない 　状況です。要件を満たすことのできるSQL文をぜひ教えてください。 よろしくお願いいたします。
ストアド内でsmalldatetime型の項目にGetDate()関数を使用してInsertしよとしているのですが、 なぜか「STRING または BINARY データは切り詰められました。」というエラーになってしまいます。 ストアドを使用しないで直接Insert文を流すと正常に登録できます。 ちなみにInsert文はごく単純で INSERT INTO テーブル名(項目名1(varchar),項目名2(varchar),項目名3(smalldatetime)) VALUES(@変数1,@変数2,GetDate()) という感じです。 どなたか分かる方いましたら助言お願いします。
いつもお世話になってます。 つい先日も助けていただいたのですが、また困ったことになってしまいました。 何回も聞くのもどうかと思い、４日程悩みましたがお手上げになってしまいました。 [DATE1][DATE2][DATE3]にそれぞれ日付が入っています。 [DATE1]に日付が入っていたら'りんご'、[DATE2]に日付が入っていたら'みかん'、[DATE3]に日付が入っていたら'かき'と、１つの項目に（新しい項目？）集約して表示させたいです。 実際のデータ ------------------------ ID、DATE1、DATE2、DATE3 ------------------------ 1、2005/10/11、空、空 2、空、空、2005/10/15 3、空、2005/10/12、2005/11/1 4、空、2005/10/20、空 ------------------------ 出したいデータ ----------------- ID、新規項目 ----------------- 1、りんご 2、かき 3、みかん・かき　← 4、みかん ----------------- ID3のように集約させるのが難しくてできません。 下記のようなSQLを以前教えていただいたので、やってみましたが、[DATE2][DATE3]のようにだぶっている場合は対応できません。 select ID,case when DATE1 <> '' then 'りんご' when DATE2 <> '' then 'みかん' when DATE3 <> '' then 'かき' end as 新規項目 from　TABLE1 こういう場合、どういうSQLを書けば良いでしょうか？ よろしくお願いします。
SQLServer2000上で指定した文字で文字列をsplitような関数があれば教えて頂けますか？ 例えば"12345.6789"という文字列を"."(ピリオド)を指定して、"12345"と"6789"という2つの文字列を取得したいと思っています。 Transact-SQLの関数リファレンスを見てみたのですが、適当なものが見つかりませんでした。 自作するしかないのでしょうか・・
VB6及びSQLServer2000で開発を行っているのですが １つのテーブルに対して一度に複数の行ロックを 行う事が出来ずに困っています。 通常と違う方法が必要なのか、何か注意点があるのでしょうか? よろしくお願いします
[CHIKU]に地区データ。[DATE1][DATE2][DATE3]にそれぞれ日付が入っています。[CHIKU]とこの３項目のデータを元にグループ化して集計を出したいのです。 [DATE1]に日付が入っているレコードをカウントしてそれを、”雑誌”という見出しをつけて表示。[DATE2]はネット、[DATE3]はメールと見出しを付けます。 もとのデータ ---------------------------- CHIKU、DATE1、DATE2、DATE3 ---------------------------- 大阪、2005/09/10、空、空 東京、2005/09/12、空、空 名古屋、空、2005/10/01、空 東京、空、2005/10/10、空 大阪、2005/11/05、空、空 ---------------------------- 出したい集計表 ------------------------- 地区、BAITAI、出席者数 ------------------------- 大阪、雑誌、2 東京、雑誌、1 東京、ネット、1 名古屋、ネット、1 -------------------------
次期開発でSQLServerを使用する開発があるのですが、Versionを2000で行くか2005で行くか迷っております。 機能的にはやはり2005に触手が出てしまうのですが、初物ということもありなかなか踏み切れません。 まずは情報収集と思い、パフォーマンスの面から検討しようと思うのですがなかなかその手の情報すら得られません。どなたかサイト（英語も可です）など情報お持ちでしたら教えてください。
たびたびお世話になります。 仮に以下のようなテーブルを考えるとします。 ○テーブルA (伝票) 伝票番号 (PK) 顧客コード ○テーブルB (伝票明細) 伝票番号 (PK) 伝票明細 (PK) 注文コード 大盛り区分 レストランなどでお客さんが注文した注文伝票を 想像していただければ良いかと思います。 一つの伝票番号に対して、複数の伝票明細があると。 DB上は上記のように格納するとします。 ここでテーブル結合を使って、各伝票の1行目の明細を表示しながら SQL1発で抜いてきたいと思います。どういうSQLを考えたら良いでしょうか？ テーブルBの表示項目が１つだけなら、 SELECT A.伝票番号, A.顧客コード, (SELECT TOP 1 注文コード FROM テーブルB B WHERE A.伝票番号 = B.伝票番号) FROM テーブルA A で良いのですが、複数項目となるとどうやったら良いのか判りません。
初めまして。　全くSQLを知らない者です。 社内で移動があり、何故か私がSEになってしまいました。　会社ではOracleとSQLのスキルが必要になり、これから勉強しなければなりません。 会社では全くトレーニングをしてくれないので自分で勉強するしかなく、初心者から学ぼうと思っています。 そもそもSQLが何なのか、簡単にしか理解できていません。　しかも、調べてみたらものすごい種類のSQLがありますが、一体何があって何を勉強すれば良いのかも分りません。　会社からは、「SQL書き方ドリル」という本を渡されただけで全く意味が分りません。 どなたか教えて下さい。 宜しくお願い致します。
WindowsXPSP2のPCを２台。１台にMSDE2000をインストールしています。 ハブにPC２台を直接つないぎ、MSDE2000をインストールしていないPCから ODBCでMSDE2000にアクセスしたところ殆ど問題はありません。 この２台をDSL回線にてつないだところ、 MSDE2000へアクセスする処理が極端に遅くなりました。 パケットを見たところ、ＴＣＰで、MSDE2000にアクセスしたPCが、 ms-sql-sからのＡＣＫ待ちがタイムアウトになり リトライを繰り返しているようです。 この問題を解決する手法をご存知でしたら、お教えください。
トランザクションファイルが２０Gに肥大化して、サーバのディスク容量を圧迫しています。 適正なログ容量で管理したいのですが方法がいまいちわかりません。ログ切捨てとか、ログ領域をデフォルテの自動拡張から容量指定にしたいと思っています。ＤＢのメンテンスに関するサイトがあったら教えてください。
SQLServerでのストアドについてはこちらでうかがってもよろしいのでしょうか？ ストアド内にてwhileでのループ文作成についてなんですが、 以下のようなストアドでSELECT内でA.NO1....とあるとおもうのですが、 これを@numRankの数だけ、A.NO（フィールド）を増やしたいのですが、 ここからどのようにつくればよろしいのでしょうか？ CREATE PROCEDURE usp_Enquete @ask_idvarchar(10) AS DECLARE @strvarchar(1000) DECLARE @numRankint DECLARE @Counterint BEGIN SELECT @numRank = count(*) FROM B_Answer WHERE ask_id = @ask_id END SET NOCOUNT ON SET @Counter = 1 WHILE @Counter <= @numRank BEGIN SET @str = ' SELECT count(ansList.NO1) AS NumAns, A.NO1, A.NO2, A.NO3 FROM ・ ・ ・
いつもお世話になっております。 インデックスを貼るときに主キーのようにまとめて 設定することができますよね。 CREATE INDEX Idx原価 ON T原価 (商品名,発注番号); 上記のようにまとめて設定するのと CREATE INDEX Idx原価_商品名 ON T原価 (商品名); CREATE INDEX Idx原価_発注番号 ON T原価 (発注番号); このように２つに分けて貼るのでは意味は違ってくるのでしょうか？ 商品名と発注番号の検索が別々に行われる場合は 分けて作成したら良いのでしょうか？
上位n行目は下記のようにして取得できますよね。 SELECT TOP n 項目A FROM テーブルA 2行目だけを取得する、あるいは 10行目から20行目だけを取得することはできますか？
セッション１・・・・・・・・・・・セッション８ １（情報）（）（）（）（）（）NULL　NULL ２NULL NULL NULL NULL NULL（情報）NULL NULL ３NULL NULL NULL NULL NULL（情報）NULL NULL ４（情報）（）（）（）（）（）NULL　NULL ・ ・ ・ ・ の情報を 1.4.7.10・・・行目を3n-2 2.5.8.11・・・行目を3n-1 3.6.9.12・・・行目を3n として、 3n-2行目のセッション７・８のNULLに 3n-1行目のセッション５と 3n行目のセッション５にある情報を置き換えたいのですが どういう命令を出せばいいのかわかりません どなたかご教授ください
SQLは初心者で現在勉強をしています。 (SQLServer2000を使用) select文の結果から新しいテーブル作成したいのですが、下記SQLで上手くいきません。 どなたかアドバイス宜しくお願いします。 create table 新テーブル as select OrderID, Prd.ProductID, ProductName, Prd.UnitPrice from "Order Details" Ord inner join Products Prd on Ord.ProductID = Prd.ProductID （エラー内容） キーワード 'as' 付近に正しくない構文があります。 SQLserverでは 『create table 新テーブル as』の構文は使用できないのでしょうか？
既存のデータファイル（mdbファイル:ACCESS97)からMDBのテーブルをSQLServer取り込みテーブルを追加したいと考えています。 ACCESSのアップサイジングウィザードを使用することを考えましたが、おそらくインストールされていないためかと思いますが使用できませんでした。 この場合、使ったことがないのでよくわからないのですがbcpコマンドラインを使うのでしょうか、ほかに方法はありますでしょうか。ご教示ください、よろしくお願いします。（SQLServer6.5、実行環境のACCESSは2002です）
いつもお世話になっております。 テーブルを作成したときに主キーのインデックスは改めて 貼る必要があるのでしょうか？　それとも自動的に インデックスを貼ってくれます？
説明が下手でごめんなさい。初心者なので用語もちゃんと使えてませんが、アドバイスおねがいします。 住所録を作っていて、ＩＤ・ＮＡＭＥ・ＡＤＤＲＥＳＳの３つのフィールドがあります。 今はＮＡＭＥのデータを一覧で出せるだけなのですが、 ＮＡＭＥの全データをを１個ずつ押せるように（ハイパーリンクのように？）して、そのＮＡＭＥデータに対応したＡＤＤＲＥＳＳのデータを見られるようにしたいのですが、何かいい方法はありませんか？ ＯＳはＷｉｎｄｏｗｓＸＰ ＤＢはＡＣＣＳＥＳＳ２０００で、 ＡＳＰを使っています。
SQLServer７＆Win2kですが、Transact-SQLで テキストファイルの読み書き＆操作(フォルダ移動、削除) はどのようにすればいいでしょうか？ 何通りか種類がありましたら、色々教えていただければ 幸いです。 とりあえずキーワードだけでも教えていただければ、 適当に調べてみます。
はじめまして。初心者ではございますがよろしくお願いします。 SQLServerを導入し、テーブル等をコンソールから作ることはできました。 そこで、ネットワーク上でつながる別の端末からSQLServerを見ようとおもい、まずはODBCの接続設定を行おうとしたのですが、「接続できませんでした」「SQLServerが存在しないか、アクセスが拒否されました」と出てきました。 サーバのIPでPINGを確認したところ問題はなかったようなのですが、別の端末から接続する場合、SQLServer等に何か特別な設定がいるのでしょうか。また、解決策等教えてください よろしくお願いします。 （ちなみに、サーバーはWin2000のSQLServer6.5でそこへ接続したい端末はWinXPです）
お世話になります。 現在VB.NETよりOLEDBを使用してSQLServerに レコード登録（バッチ処理）を行っているのですが 約2万3千件のレコードを登録（1レコード1コミット） するのに6時間くらいかかってしまいます。 （1レコード500BYT） 1時間で1万件の登録は行えるのですが、だんだん 1レコードあたりの登録時間が長くなっていきます。 DB登録の前に存在チェックを行っていますが、検索条件は KEY項目指定です。 SQLサーバーの設定はデフォルトのままで、 FREE BUFFERやメモリ等に問題はみられませんでした。 他に考えられる原因をご存知の方がいらっしゃれば ご教授願います。 宜しくお願いします
SQLサーバに日付と料金の入ったテーブルがあります。 例えば、下のようなデータがあるとします。 日付　　　　　　　　　　　　料金 2005/11/08 11:15:00　　5000円 2005/11/09 12:00:00　　6000円 2005/11/15 15:15:00　　4000円 2005/11/16 09:00:00　　7000円 このテーブルから火曜日のデータだけを抽出したい場合、 どのようなSQL文を書けばよいのでしょうか？ どうぞ、よろしくお願いしますm(_ _)m
いつもお世話になっております。 SQLで GROUP BY を使うときに SELECT部分で指定した 列名を指定したいことがよくあると思います。 列名を指定する方法はないのでしょうか？ 例) SELECT 項目A, CASE WHEN 項目B = 1 THEN '○' WHEN 項目B IN (2,3) THEN '×' END AS 丸バツ, SUM(数量) FROM TABLE GROUP BY 項目A, 丸バツ こんな風にGROUP BYで指定したいのですが・・・。
はじめまして。 初心者なので、よろしくお願いします。 アクセスのVBAでエクセルのデータをSQLServer（MSDE）に インポートしたいのですが、どのような方法が考えられるでしょうか？ BCPも勉強しましたが、エクセルのシートでできるか理解できなかったです。 よろしくお願いします。
SQL Server Enterprise Manager で接続完了後、"データベース"のフォルダを展開するのに、90秒ほどもかかってしまうSQL Serverがあるのですが、考えられる原因はありますでしょうか？ ・複数のクライアントで同じ問題が発生しています。 ・サーバー上のEnterprise Managerで同じことを行うと、10秒足らずで展開されます。 ・問題が起こらないSQL Serverもあります。 ・問題の起こっているSQL Serverとの間のその他通信は正常です。 なんとも不思議です・・。
「API関数をコールする」と「API関数を呼び出す」とは違いがありますか？二つの使う方法がどうですか。ご回答をお願い致します。
Acessで運用していたデータベースをMSDEで再構築を考えていまして、 ファイルの管理について教えてください。 Accessでは日々追加されていくデータを月毎にファイルを作成していました。 (3000件程度になります) このファイルごとにバックアップを行っていましたが、MSDEでは細かくファイルを わけずに保存するものなのでしょうか？ また、蓄積していったデータは、バックアップを取って削除していくのでしょうか？ よろしくお願いします。
このストアドを実行すると以下のようなエラーになります。 どこがいけないのでしょうか？ サーバー : メッセージ 156、レベル 15、状態 1、プロシージャ usp_BZipInsertTable、行 4 キーワード 'BEGIN' 付近に正しくない構文があります。 if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[usp_BZipInsertTable]') and OBJECTPROPERTY(id, N'IsProcedure') = 1) DROP PROCEDURE usp_BZipInsertTable GO CREATE PROCEDURE usp_BZipInsertTable BEGIN BEGIN TRANSACTION INSERT INTO B_Zip SELECT * FROM work_B_Zip W WHERE NOT EXISTS( SELECT * FROM B_Zip WHERE B_Zip.PublicCode = W.PublicCode AND B_Zip.ZipOld = W.ZipOld AND B_Zip.ZipNew = W.ZipNew AND B_Zip.PrefKana = W.PrefKana AND B_Zip.CityKana = W.CityKana AND B_Zip.TownKana = W.TownKana AND B_Zip.PrefName = W.PrefName AND B_Zip.CityName = W.CityName AND B_Zip.TownName = W.TownName ) END COMMIT TRANSACTION GO
ログファイルをサイズ上限を無制限にしておくと、どんどんサイズが大きくなってしまいますよね。かといってサイズの上限を決めておくと、そこに達したらそれ以上データを作成できなくなってしまいます。 ある程度のサイズになったら、または週に一度くらいで自動的にトランザクションログを切り捨てたいんですが、どのような方法がありますでしょうか？ 既にかなりのサイズになっており、困ってます。 本にはログのバックアップを取ると良いとあったのですが、バックアップを取るということは領域の解放、ログファイルサイズの縮小にはならないんじゃないかと思い、有識者のみなさまに質問させていただくことにしました。みなさまおすすめの管理方法を教えてください。 P.S. やはり、物理的にファイルを削除するのは難がありますでしょうか？
Aというテーブルの情報をカーソルにて取得し、 同じくAというテーブルに項目を変えてInsertするという プロシージャを作成しています。 しかし、フェッチしたあとその処理から出ません。 (ちなみにフェッチ後のBEGIN～END内のInsert文を違うテーブルにして実行してみると処理から抜けました） 下記が該当プロシージャです。 CREATE PROCEDURE 販売プロシージャ　AS BEGIN --変数宣言 DECLARE @販売NOINT DECLARE @顧客NOINT DECLARE @明細NVARCHAR(25) DECLARE @受注日SMALLDATETIME DECLARE @金額INT DECLARE @ステータスBIT DECLARE @有効フラグBIT --カーソル宣言 DECLARE 販売カーソル CURSOR FOR SELECT 販売NO, 顧客NO, 明細, 受注日, 金額, ステータス, 有効フラグ FROM販売 WHEREYEAR(受注日) = YEAR(GETDATE()) AND MONTH(受注日) < MONTH(GETDATE()) --初期化処理 SET NOCOUNT OFF --カーソルOPEN OPEN 販売カーソル FETCH NEXT FROM 販売カーソル INTO @販売NO, @顧客NO, @明細, @受注日, @金額, @ステータス, @有効フラグ WHILE @@FETCH_STATUS = 0 BEGIN INSERT INTO 販売 ( 販売NO, 顧客NO, 明細, 受注日, 金額, ステータス, 有効フラグ, 登録日, 更新日, )VALUES( @販売NO, @顧客NO, @明細, @受注日, @金額, @ステータス, @有効フラグ, GETDATE(), GETDATE(), ) FETCH NEXT FROM 販売カーソル INTO @販売NO, @顧客NO, @明細, @受注日, @金額, @ステータス, @有効フラグ END CLOSE 販売カーソル DEALLOCATE 販売カーソル END 同じテーブルを使用する場合は、このような記述ではできないのでしょうか？
２つのテーブルを比較して、片方のテーブルにしかない データを検索したいのですが、どのようなＳＱＬ文に なるのか　教えて下さい。 下記の例だと、ＡテーブルとＢテーブルの両方にあるデータ以外のデータを検索したいので、下記の結果になります。よろしくお願いします 期待される結果 003　さああ 004　いいい 005　ううう 例 Ａテーブル 001　あいう 002　えおお　 003　さああ 004　いいい 005　ううう Ｂテーブル 001　あいう 002　えおお　
ＳＱＬＳｅｒｖｅｒ２０００の発売からＳＰ１、ＳＰ２、・・・・、ＳＰ４までのリリースの変遷を調べています。リリースの年月レベルで構わないのですが、教えていただけないでしょうか 調べた限りでは以下の通り、発売日がわからない、、、 発売 ＳＰ１　　２００１．７ Ｓｐ２　　２００１．１２ ＳＰ３　　２００３．１ ＳＰ３ａ　２００３．８ ＳＰ４　　２００５．５
クエリアナライザで複数のSQLを順番に書いて、データ移行スクリプト を作成しています。はじめは BEGIN TRAN ではじめるとして、 最終的に成功したら commit、途中null制約などでエラーが出たら rollbackしたいと考えています。 そういった簡単な制御構造を実現するにはどうしたら良いのでしょうか？
始めて投稿するので内容について良くわからないかも しれませんが、 自分ではどうしてもわからない為、 教えて下さい。 ソフトはMicrosoftSQLServerの6.0を使って作業して います。 私が四苦八苦している問題は、以下になります。 ”条件Aに当てはまる最大の変更月とその月数を加算 する” 条件A：Aテーブル住所＝Bテーブルの住所、 　　　 Aテーブル証明番号＝Bテーブルの証明番号 Aテーブル　　　　　　　　　　　　　 証明番号｜住所｜変更月　　｜月数 --------------------------------- 6201　　｜東京｜2005-10-24｜10　　　　　　　　 --------------------------------- 9000　　｜東京｜2007-12-15｜2 --------------------------------- 8900　　｜千葉｜2006-01-14｜5 Bテーブル 証明番号｜住所｜ ---------------- 5862　　｜埼玉｜ ---------------- 6201　　｜東京｜ ---------------- 9000　　｜東京｜ 結果は、2番目のデータを抽出及び計算をし、 ”2008-02-15”と出したいと思っています。 SELECT DATEADD (MONTH,A.月数,MAX(A.変更月)) FROMA,B WHERE A.住所 　　= B.住所 AND A.証明番号 = B.証明番号 上記のように記述したのですが、うまく起動してくれ ません。。。っと言うか、 最大の変更月を抽出して いないようです。 申し訳ありませんが、宜しくお願い致します。
文字列’％’を検索したいのですが、 どのようにＳＱＬ文を記述すれば よいのでしょうか？ 教えてください。
クエリアナライザで同じSQLを2度実行すると2度目は キャッシュされた内容が表示されるようで素早く 出てきますが、開発時はキャッシュが無いほうが 実際の集計時間がわかって良いです。 キャッシュを無効にする方法はありますか？
下記のようなテーブルがあったとして、日にちごとの金額合計を取得したいのですが、どうすればよいのかわかりません。初歩的なことかもしれませんか、よろしくお願いします。 単純に、日付でGROUP BYしてもうまくいかないようで^^;; ----------------------- 日付　　　　　　│金額 ----------------------- 2005-10-18 20:54│100 2005-10-18 21:30│200 2005-10-18 24:13│150 2005-10-19 10:00│100 2005-10-19 12:00│500 2005-10-19 20:00│200 結果は、 2005-10-18 450 2005-10-19 800 と取得したいです。
例えば Aテーブル NO　名前 1　aaa 3　bbb 4 ddd 6 eee というデータの入ったテーブルからデータを取得する際に 1　aaa 2　0 3　bbb 4　ddd 5　0 6　eee という風に間が抜けたデータ(この場合2と5)をフェイクとして行に追加した状態で取得するSQL文は存在しますでしょうか？
今までhostでcobolでの開発と、vbaくらいしか使用したことがないのですが、 このたび、SQL Server を使用したシステムの一部分の開発を任されることになりました。 それにあたり、開発工数を出す為の見積り調査期間として今週中という期限を切られてるのですが、開発ツールを何にすればよいのかもわからないような状態です。 作成しなければならないプログラムの内容は、以下の３本です。 1.ｃｓｖ形式のインターフェイスを参照し、条件に該当すれば、該当者にメールを自動送信する 2.ｄ/ｂにアップロードするデータを、訂正入力する 3.ｄ/ｂを１時間おきに参照し、データが更新されていれば決められたメッセージを更新者にメール送信する こういう内容の場合、開発ツールのお薦めなどはありますか？ 漠然と、javaを使うの？などと思ってるのですが・・・。
Aテーブルに同じフィールドを持ったcsvをd, e, f, g と４つのフィールドを比べて １つでも違っていたら、insertするというSQLをつくりたいのですが、 これは、ストアドになるのでしょうか？ データはだいたい5万件くらいあります。 サーバーはSQLServerになります。 宜しくお願い致します。
実行環境はNT4.0、DAOは3.5(3.51ではない) VB5でSQLサーバーに接続したいのですが、 できるのでしょうか？ できればODBC経由でなく直に繋ぎたいのですが、むりならODBC経由でもいいです。 サンプルコードをお願いいたします。 １）DB接続、２）SQL文発行＆レコードセット取得 位まであればありがたいです。 上記が無理の場合RDOでの使用方法があれば お願いいたします。
いつもお世話になっております。 テーブルの作成時に主キーのようにUNIQUEになるように 列を設定したいと思います。ただし値が設定された場合に のみUNIQUEとしたいのです。つまりNULLかUNIQUE。 そういうのは可能でしょうか？ プログラム側で重複しないようにチェックする しかないですか？
お世話になります。下記のような結果を求めるSQL文についてどなたかご教示をお願いします。 以下の２つのテーブル(SMPL_TBL1,SMPL_TBL2)があったとします。 (SMPL_TBL1) ID | NAME | BUSHO ---+--------+--------- 01 | YAMADA | A_GRP 02 | SUZUKI | A_GRP 03 | OKADA | B_GRP 04 | TAKAGI | C_GRP (SMPL_TBL2) ID | POINT | ---+-------+- 01 | 1 | 01 | 2 | 01 | 3 | 02 | 1 | 02 | 2 | 03 | 1 | 04 | 1 | 04 | 2 | 04 | 3 | 04 | 4 | 04 | 5 | 上記テーブルから以下のような結果を得たい場合、 どのようなSQL文を投げればいいでしょうか？ （求める結果） ・各人ごとのPOINTのMAX値と各人のデータを抽出（POINTは1～999までの整数です） ID | NAME | POINT| BUSHO ---+--------+------+-------- 01 | YAMADA | 3 | A_GRP 02 | SUZUKI | 2 | A_GRP 03 | OKADA | 1 | B_GRP 04 | TAKAGI | 5 | C_GRP よろしくお願いいたします。
http://www.wings.msn.to/contents/env/asp_net/msd … このページをみながらやってます。 ４．データベースを展開するというところで、 > osql -S(local) -Usa -Psa -Q"RESTORE DATABASE sample FROM DISK='D:\sample.bak' WITH REPLACE" をプロンプトで打つと出来るらしいのですが、 >ユーザー'sa'のログオンに失敗しました。理由：SQL Server　の信頼関係接>続に関連付けられていません。 とでます。 よろしくお願いします。
SQLサーバーはいくらぐらいするものなんでしょうか？
MSDEをインストールして、サービスを開始しようとすると、 「ログオンに失敗したため、サービスを開始できませんでした」 と表示されて、開始できません。 どうしたら、開始できるんでしょうか？ よろしくお願いします。
SQL serverを使用しています。 ORACLEのDECODEに相当する関数を使用したいのですが、 わからなくて困っています。 具体的には、 特定の行に対して「全角スペース」もしくは「半角スペース」があったときに、nullに置換したい。 （なるべくシンプルな方法で！！） 教えてください。
現在稼動しているDBのテスト用にＤＢをコピーしたらできたDBは読み取り専用となってしまい編集ができません。もう一度作りなおしたいのですが、削除しても大丈夫なのでしょうか。 私が行った操作内容は・・・ 1)新規に空DB(testDB)を作成しました 2)そのtestDBへ稼動中のDB全体を復元しました 　データベースの復元 - デバイスから(既存のDB上に強制復元にチェック)して実行しました その結果、testDBは（読み取り専用）と表示されtestDBのプロパティを見ると「状態」が”スタンバイ”となっていました。 このtestDBを削除することによって稼動中のDBに影響があるものなのでしょうか。 どなたか情報をお持ちの方ご教授いただけますようお願いいたします。
Enterprise Managerの「データベース保守計画」で トランザクションログのバックアップを取ろうと 考えているのですが、保守計画でトランザクションログをバックアップした場合、 現在使用していないトランザクションログは自動で消えてくれるのでしょうか。 すべてのタスク→データベースのバックアップから トランザクションログを手動でバックアップする際は、 「アクティブでないエントリをトランザクションログから削除」という チェックボックスがあるので、チェックしておけば 削除しているようなのですが。 いまいち、サイズを確認しても消えているのかどうか はっきりわかりません。 ご存知の方、教えていただけると助かります。 よろしくお願いします。
カテ違いならすみません。 ＳＱＬに関しての基礎知識を勉強したいんですが、 なにから勉強していったらいいか教えてください。 ちなみにＳＱＬという言葉を最近しったというレベルです。 よろしくお願いします。
SQLDMOオブジェクトを用いて、テーブルの列挙、列の列挙までは行なえるようですが、列の「説明」の項目の取得は行なえないのでしょうか？ SQLDMOでなくても、何か取得出来る方法があればご教授お願いします。 --サンプル Public Function Main() Dim objServer As SQLDMO.SQLServer Dim objDatabase As SQLDMO.Database Dim objTables As SQLDMO.Tables Dim curTable As SQLDMO.Table Dim curCOl As SQLDMO.Column Const DB_NAME As String = "local" Const DB_USER As String = "sa" Const DB_PASSWD As String = "password" Const DB_USE As String = "hoge" ' オブジェクト作成 Set objServer = CreateObject("SQLDMO.SQLServer") ' 接続 Call objServer.Connect(DB_NAME, DB_USER, DB_PASSWD) 'DB選択 Set objDatabase = objServer.Databases(DB_USE) 'テーブル一覧 Set objTables = objDatabase.Tables ' テーブルの列挙 For Each curTable In objTables If curTable.SystemObject Then Debug.Print curTable.Name & " [system]" Else Debug.Print curTable.Name '列名の列挙 For Each curCOl In curTable.Columns Debug.Print curCOl.Name '*!ここで列の説明は取得出来ないのでしょうか？？？ Next End If Next ' 切断 Call objServer.Disconnect End Function
SELECT ユーザー名 FROM (SELECT ユーザー名 職員マスタ UNION SELECT ユーザー名 入社記録) という形で一意のユーザー名を取得しようとしています。 UNIONだけの文ならちゃんと取れるのですが、サブクエリにしてFROM句に書くとエラーになります。 SQLServerではFROM句にサブクエリは使えないのでしょうか。
SQL Serverにて、一度に複数のデータベースのバックアップをとる方法を探しています。 単独のデータベースのバックアップを、Enterprise Managerから手動で設定することは出来、それをスケジュールに組む事が出来ます。 しかし、データベースが複数ある場合などには、ひとつひとつ設定する事になり、手間がかかります。 以上、一度に複数のデータベースのバックアップをとる方法（ツールを使用しない方法で）を知っている方がいらしたら、教えていただけませんか？ よろしくお願いします。 尚、使用しているSQL Serverは、2000 Standard Edition(英語版)です。
SQL Serverのデータベースなのですが、 日付順に変えたいのです SDate（日付）というタブとSTime（時間）というタブがあるので、古い順にしたいのですがどうすればよいでしょうか？ SDateには"20051001"みたいな感じで、STimeには、"1715"みたいな感じで入っています。 できれば、実行したら日付順になるのではなく、 Select文などでいつ呼び出しても日付順に出力されるようにしたいのです。 もし、無理だったら、日付順に変更する方法を教えてくださいー
SQLServer2000、VB6.0sp6を使用してアプリケーションを作成しました。 SQLの設定として、割り当て済み領域の設定は自動拡、容量無制限にしています。 アプリケーションから大量のデータを1度に登録、更新を行っているとエラー(ABEND)が発生し、 「開かれているカーソルが存在しないか閉じられています」というメッセージが表示されました。 今まで何度も行ってきた処理なので、プログラムエラーではないと判断し、他の原因を考えてみたところ、割り当て済み領域の拡張が終わる前にデータの登録や更新が行われたのでエラーが発生したのでは？と思い、割り当て済み領域を手動で拡張してからエラー発生前の状態にデータを戻し、再度実行したところ正常に処理されました。 原因、解決方法はこれでよかったのでしょうか？ 割り当て済み領域は圧縮するか、定期的に増やしていくしかないのでしょうか？ データを減らすことによって割り当てた領域内で運用というのは無理なのでしょうか？ どなたかご存知の方がいらっしゃいましたらよろしくお願いします。
お世話になっております。 もしOracleやSQL Serverに関してご存知の方が いらっしゃいましたらご教授ください。 今、業務で 「Oracleに載せるシステムをSQL Serverで載せられないか？」 という話が出ており私が調査を行う事になりました。 しかし私のSQL Server経験が浅い為困っている点があります。 (以下の質問は当然ですがシステムで動く・動かない の話はヌキにしてのSQLレベルでの話です) ・Oracle特有のSQL構文をSQL Serverに見合った構文に 直すことによって(DATE→datetime/NUMBER→int等)一般的な SELECT文、INSERT、UPDATE、DELETE文はそのまま使う事が可能か？ ・上の件に関する経験をお持ちの方・知識のある方にお聞きしますが 何かこの件に関する注意点などありますでしょうか？ の2点になります。 どうかご存知の方がいらっしゃいましたらお願い致します。
いつもお世話になっております。 下記のように2つのテーブルがあるとして、 在庫TBL ----------- 在庫コード 在庫名称 発注明細TBL ----------- 明細コード 在庫コード 在庫名称2 個数 在庫名称2に在庫TBLの在庫名称をUPDATEしたいのです。もちろん在庫TBLの在庫コード＝明細TBLの在庫コードです。 UPDATE　発注明細TBL SET　明細.在庫名称2　=　在庫.在庫名称 WHERE　明細.在庫コード　=　在庫.在庫コード とやってもエラーになってしまいます。
複数のテーブルを外部結合してSUMをとってきたいとき、SQLServerではどのような結合にすればよいのでしょう。 一対一の関係なら「LEFT JOIN」を使って「FROM テーブルＡ LEFT JOIN テーブルＢ ON テーブルＡ.フィールド = テーブルＢ.フィールド」ができますが、一対複数の関係で書き方がよくわからず、かなり困っています。 例） ユーザーマスター ・ユーザーID ・ユーザー氏名 ○月売上テーブル←○には1～12が入る ・ユーザーID ・売上金額 欲しいデータは ・ユーザーID ・ユーザー氏名 ・SUM(1月売上テーブル.売上金額) 1月 ・SUM(2月売上テーブル.売上金額) 2月 ・SUM(3月売上テーブル.売上金額) 3月 以降、12月まで続く ORACLEだと↓のやり方で、 ・ユーザーマスターはすべて ・各月の売上テーブルはユーザーID毎に集計(外部結合) を出力してくれるのですが…。 SELECT u.ユーザーID,u.ユーザー氏名, SUM(m1.売上金額),SUM(m2.売上金額),SUM(m3.売上金額),,, FROM ユーザーマスター u, 1月売上テーブル m1, 2月売上テーブル m2, 3月売上テーブル m3,,, WHERE u.ユーザーID=m1.ユーザーID(+) AND u.ユーザーID=m2.ユーザーID(+) AND u.ユーザーID=m3.ユーザーID(+),,, GROUP BY u.ユーザーID,u.ユーザー氏名 ORDER BY u.ユーザーID,u.ユーザー氏名
SQLServer2000をインストールしている Windows2000Serverのタスクマネージャーの プロセスを見ると sqlservr.exeというイメージが２つあります。 これはSQLServerの２重起動等の異常な状態で しょうか？ 手元にないサーバなのですが、VisualBasic6.0を 使用してSQLServer2000にデータを書き込みアプリ があります。 このVB6のアプリで、『エラーを特定できません』 とのエラーが発生する。との相談を受け、画面の ハードコピー等を送ってもらったのですが、その中の タスクマネージャのプロセスのハードコピーで sqlservr.exeが２つ起動しているのが確認 できました。 上記エラーメッセージを調べてみると、スタックの破壊 等が考えられるとあったのですが、この２重起動でも 同様の現象が考えられるでしょうか？それ以前に今の この２重起動が発生すること事体異常でしょうか？ 手元に環境がないので確認ができずに困っております。 ご存知の方、ご教授ください。
初歩的なことで悩んでおり、２点程質問があります。 (1)DBの復元時に「タイムアウトに達しました。操作が完了する前にタイムアウト期間が過ぎたか、またはサーバーが応答していません。」というエラーが発生する時があります。これが発生するのは復元するDBのサイズが大きいときであり、タイムアウト値を長くすることで解決は出来たのですが、これ以外での解決策は無いのでしょうか？（復元するDBのサイズは運用形態により変わる為、固定値にするのは危険？） （2）(1)のエラーが発生した後、再度DBの復元を行おうとすると(厳密にはDBのオープン時)、「Database 'DB名' cannot be opened. It is in the middle of a restore.」というエラーが発生します（Enterprise　Managerでは：「読込んでいます」と表記）。このエラーの修復方法が分からず悩んでいます。出来れば(1)のエラーが発生したときに（2）の状態にならないのが理想です。 以下に復元時の主な流れを明記します。 1.DBオープン(server=(local);uid=sa;pwd='パスワード';database='DB名';Connect Timeout= 500) 2.シングルユーザ設定(ALTER DATABASE 'DB名' SET SINGLE_USER WITH ROLLBACK IMMEDIATE) 3.DBの復元(RESTORE DATABASE 'DB名'" FROM DISK = 'バックアップDB'　WITH RECOVERY) 4.マルチユーザ設定 長々と申し訳ありませんが宜しくお願い致します。
お世話になります。 SQL Server 6.5の環境で、誤って「repl_publisher」というユーザーを削除してしまいました。 再作成したのですが、データベース動作上、不具合がおきてしまうのでしょうか。 また、この「repl_publisher」とは、どのようなことをしているユーザーなのでしょうか。 知識不足で大変申し訳ありませんが、 どなたかご回答お願い致します。
いつも拝見させて頂いております。 今回はSQLServerのBULK INSERTについて質問させていただきます。 現在、UNIXから出力されたデータファイルをWindows2000Serverにて ストアドからBULK INSERTを使用して取り込もうとしています。 ですが、うまく取り込めず困っています。 現在は『BULK INSERT TBL名 FROM 'サーバ内のファイル'』として クエリアナライザからも実行しているのですが、最後のカラムで 桁あふれとなりエラーが発生してしまいます。 行終端文字が認識できず、全てのデータが１行とみなされているようです。 しばらく、調べているのですが調べれば調べるほど正常に取り込めなければ おかしいと思ってしまっています。 以下が現在の状況です。 １．BULK INSERTの行終端文字のデフォルトは\n(LF)であり、 　　取り込もうとしているデータファイルの行終端文字も\n(LF)である。 この状況であれば取り込めるかカラムのデータ型不一致等のエラーまで進むと思っているのですが、そこまで進みません。どなたかこのような状況を経験したら方が いらっしゃいましたらご教授いただきたく存じます。 宜しくお願い致します。
現在、SQLServer勉強中のものです。たびたびの質問ですいません。 sp_columnsというシステムストアドプロシージャで列情報が取得できますが、@table_nameでテーブルを、@table_ownerで所有者を指定できますよね。 さらに@table_qualifierでデータベース名を指定できると思っていたのですが、これは無理なのでしょうか。 ヘルプには「SQLServerでは、この列はデータベース名をあらわします」とあるのですが、現在、接続データベース以外のデータベースに格納されているテーブルの列情報を参照しようとすると「オブジェクト修飾子の一部になるデータベース名には、現在のデータベースを指定してください。」と表示されてしまいます。 例：TestDB1に接続してTestDB2内のテーブル指定 use TestDB1 sp_columns @table_name=TestDB2Tbl, @table_qualifier=TestDB2
接続先データベース内にあるストアドプロシージャの存在をチェックするのにsysobjectsが使えますが、他のデータベースのストアドプロシージャが存在するかをチェックする方法はないでしょうか？
varcharでサイズを8000にしたフィールドに1000文字（例えば’aaa・・・「a」を1000文字・・・’）INSERTした後にそのフィールドをSELECTすると256文字しか入っていません。どうしてなんでしょうか？ SELECT、INSERTなどのSQLの実行は”クエリ アナライザ”や”SQL Server Enterprise Manager”で試しました。 SQLServer初心者です。何卒宜しくお願い致します。
以下のようなテーブルがある場合に、SELECT文で商品Aと商品Bを両方購入している得意先のレコードを抽出することは可能でしょうか？得意先や商品は以下に限らず複数登録されています。 いい方法がありましたら教えてください。よろしくお願いします。 URIAGE_TBL 得意先　　商品　数量 --------------------- 会社１　　　A　　　1　　　<- 抽出 会社１　　　B　　　2　　　<- 抽出 会社１　　　C　　　1　　　<- 抽出 会社２　　　D　　　1 会社３　　　A　　　2　　　<- 抽出 会社３　　　B　　　1　　　<- 抽出 会社４　　　A　　　2 会社４　　　C　　　2
SQLServerを個人的に買おうかと考えています。 個人的に膨大な量の「モノ」を管理するために考えてます。 MSAccessでは収まりませんし、同時アクセスも予定あります。 MSDEだとユーティリティが無いので不便です。 勉強がてらSQLServerを使って管理したいのです。 そこで、 SQLServer2000 StandardEditionを買おうと思ってるのですが、 都心大手量販店などにはパッケージが売ってませんでした。 あれはどこに売ってるのでしょうか？ ライセンスのこともMSのサイトで確認し、 5CALでの購入予定です。 どのように購入すればよろしいのでしょうか？ パッケージでは販売されていないのですか？ ・・・でも箱とかは見たことあるしなぁ・・・。 たぶん簡単なことなんでしょうけど、 どうしてもわかりません。どなたさまか教えてください。 よろしくお願いします。
企業でシステム管理をしています。 現在勤怠管理システムで以下のようなテキストファイルをサーバに出力しています。このファイルと従業員ごとの時給テーブルを作成して人件費を出力するシステムを開発会社に作ってもらおうと思っています。 テキストファイル 社員番号,日付,業務開始,業務終了 1000234,20050901,1000,1830 1000444,20050901,1100,1930 2212334,20050901,1000,1900 1023455,20050901,1200,2030 時給テーブル 社員番号,時給 1000234,1000 1000444,900 2212334,900 1023455,1050 しかし開発会社は、出力されるテキストファイルからは時間を算出できないとの返答でした。 なぜなのでしょうか。テキストファイルの開始時間と終了時間を取り込めば労働時間は算出できると思うのですが、無理なのでしょうか。 よろしくお願いします。
データテーブルと商品マスターをリンクしてコードを入力したら商品名が表示されるようにしているのですが、次のレコードに移動すれば表示します。 これを次のフィールドに移動したら表示するようになりますか 品番　　品名　単価 100　　AAAA　２０００ 　　　～～～　～～～　の部分を参照したい。
こんにちは。 あるクライアントから大量データでテーブル参照/更新をかける処理を実行し、高負荷がかかると、他のクライアントからはテーブルへアクセスが全く出来ない状態になってしまいます。 （その処理が終了すれば、アクセスできるようになります） このような状態を回避し、大量データ処理中であっても他のクライアントからのアクセスが可能となるような解決方法はあるのでしょうか？（もちろんパフォーマンスは落ちるとは思いますが） 素人質問で申し訳ありませんが、解決法をご存知の方がいらっしゃいましたらご回答をお願い致します。
二つのテーブルをunionで繋いで、IDの昇順に並べ替えたいのですが、それぞれID列の型が違うので（文字列と整数）整数のID列は文字列にコンバートしました。 select id from hoge union select convert(char(8),id) from hogehoge order by id ところがこれだと、もともと整数だった方のIDは、 1 10 100 2 20 200 と並んでしまいますよね。 1 2 3 ・ ・ ・ a001 a002 a003 ↑こういう結果になるようにするにはどうしたら良いでしょうか？
テーブルＡに以下のような項目があります。 [MAIL_ID][SEND_DATE][USER_ID] テーブルＢに以下のような項目があります。 [USER_ID][SEI][MEI] やりたい事は、 ・テーブルＡとＢを[USER_ID]をキーにして結合させたい。 ・テーブルＡの[MAIL_ID]ごとにグループ化して１行にまとめたい。 ・テーブルＢの[SEI]と[MEI]をつなげて１つの項目として表示させたい。 これを実現させるには、どういうSQLを書けば良いでしょうか？ 私が試したのは、以下のSQL文です。 SELECT　A.MAIL_ID, MIN(A.SEND_DATE) AS SEND_DATE,MIN( A.USER_ID) AS USER_ID,MIN(B.SEI) + MIN(B.MEI) AS ATESAKI FROM　TABLEA A INNER JOIN TABLEB B ON A.USER_ID = B.USER_ID WHERE　A.SEND_ID = '900001' GROUP BY　A.MAIL_ID でも、これだと同じMAIL_IDが複数存在すると[SEI][MEI]が別人のものがくっついてしまいます。当然ですが。 グループ化する前に[SEI][MEI]を連結させる処理が必要なのだろうと思うのですが、それをどうすれば良いのかが分かりません...。 どうかよろしくお願いします。m(_ _)m
テーブルＡに以下のような項目があります。 [ID][SEI][MEI] やりたい事は、 ・[ID]ごとにグループ化して１行にまとめたい。 ・[SEI]と[MEI]をつなげて１つの項目として表示させたい。 これを実現させるには、どういうSQLを書けば良いでしょうか？ 私が試したのは、以下のSQL文です。 SELECT ID,MIN(SEI) + MIN(MEI) AS NAME FROM TABLEA GROUP BY ID でも、これだと同じIDが複数存在すると[SEI][MEI]が別人のものがくっついてしまいます。当然ですが。 グループ化する前に[SEI][MEI]を連結させる処理が必要なのだろうと思うのですが、それをどうすれば良いのかが分かりません...。 どうかよろしくお願いします。m(_ _)m
SQLServer2000の評価版は再インストール可能でしょうか？ 現在テスト環境としてSQLServer2000の評価版(試用期間120日)を使っております。 ですが、テストが120日で終わらないため、あと３０日程度使用したいと思っています。データのバックアップを取って、SQLServer2000の評価版を一度アンインストールして、再度インストールしたら、また120日使えるってことはできないですか？
こんにちわ。以下のようなテーブルから条件に見合う合計を出したいと思いSQLを書いてみたのですが、 思った結果になりません。 テーブルA ID1　得意先Cd　営業所Cd　日付 1　　001　　　　001　　2005/09/01 2　　001　　　　002　　2005/09/01 3　　001　　　　001　　2005/09/03 テーブルB ID2　ID1　部署　数量　金額 1　　1　　01　　1　　1000 2　　1　　01　　1　　1000 3　　1　　02　　1　　1000 4　　2　　01　　1　　1000 5　　2　　01　　1　　1000 6　　3　　01　　1　　1000 7　　3　　01　　1　　1000 8　　3　　02　　1　　1000 ［抽出結果］ 得意先Cd　営業所Cd　日付　　部署　数量(Sum)　金額(Sum) 001　　　　001　　2005/09/01　01　　　2　　　2000 001　　　　001　　2005/09/01　02　　　1　　　1000 001　　　　001　　2005/09/03　01　　　2　　　2000 001　　　　001　　2005/09/03　02　　　1　　　1000 001　　　　002　　2005/09/01　01　　　2　　　2000 ［SQL］ select 得意先Cd，営業所Cd，日付，部署，SUM(数量) As '数量計'，SUM(金額) As '金額計' from テーブルA AA Inner join テーブルB BB ON (AA.ID1 = BB.ID1) group by 得意先Cd，営業所Cd，日付，部署，数量，金額 order by 得意先Cd，営業所Cd，日付，部署 このSQLを実行すると、日付、部署共に同じ場合でも数量・金額が合計値となりません。 得意先Cd　営業所Cd　日付　　部署　数量　金額 001　　　　001　　2005/09/01　01　1　　1000 001　　　　001　　2005/09/01　01　1　　1000 どのように変更を加えれば、上記の「抽出結果」にできるのでしょうか？ よろしくお願いいたします。
の表を表示する命令を教えてください
いつもお世話になっております。 ＳｑｌＳｅｒｖｅｒのＤＴＳ内にＶＢＳｃｒｉｐｔにてコーディングをおこなっております。 そのＶＢＳｃｒｉｐｔには、別マシンにあるＭＤＢを参照し処理を行うようなっているのですが、パッケージの実行にて起動を行うと処理が動くのですがＳｑｌＳｅｒｖｅｒエージェントのジョブとして登録して実行しようとするとエラーとなってしまいます。 ＯＳはＷｉｎｄｏｗｓ２００３ ＳｑｌＳｅｒｖｅｒは２０００となっております。 何方かご存知でしたらお教え願います。 宜しくお願い致します。
XXXX.sqlファイルに20万件ほどのクエリが書かれています。 メモリの消費を防ぐために、1行ごとでGOを行い処理をさせています。 SQL ServerのEnterprize ManagerでXXXX.sqlファイル を実行すると（1行処理しました）という表示がされます。 そしてエラーが起きると、エラーが起きた旨と、その行が 表示されるのですが、1行ごと実行させているので、エラーが起きた行を うまく特定できません。 上記のような場合で、エラーが起きた際に、エラーが起きた 該当クエリを知りたいのですが、 何か方法はありますでしょうか。
テスト環境から本番環境のサーバーに、複数のデータベースを移行しようと思っています。データベースやテーブルやストアドプロシージャは必要ですが、データは必要ありません（あってもいいですが、データ量が多いので時間がかかりそうです）。 本番環境にデータベースだけ作成し、テスト環境のデータファイルと入れ替えるという手も考えたのですが、双方の環境でデータベースのファイルの位置が違うので、この手は使えませんよね。。。 そうなると他の方法としては手動で一つ一つデータベース・テーブル・ストアドプロシージャのスクリプト（スクリプト作成で作ったもの）を流すしかありませんか？
IDENTITY項目のあるテーブルのデータを削除した際、 次回別データinsert時に、今まで使用していた IDENTITY値を再び挿入することはできないでしょうか？ Books Onlineを見るとID値のギャップ値を取得して SET IDENTITY_INSERT テーブル名 ON にして 手動でinsertすればいい、とありますが insertするだけで勝手に空いてる番号から採番してくれる方法は無いでしょうか？ どなたかご存知の方いましたらよろしくご教授願います。 無理なことでしたら無理とお教えください。
Windows　Server　2003上で、SQL　Server　2000を 使用しています。下記のようなSQLを作成したいのですが、知識不足のためご助力願いたいのですが。 テーブル名　test フィールド　seihin (1項目のみ) seihinの構成 　先頭４バイト　製品コード　 　後半４バイト　連番（００００～９９９９） やりたいこと　seihinの重複するレコードを含む 製品コードに対しそのコード別の件数の算出 例　xxxx0002,xxxx0011,yyyy1111が複数件あるとき、 seihinコードがxxxxであるもの全体の件数及び yyyyであるもの全体の件数 なお、下記のSQLにて重複レコードの抽出とカウントはできていますが、それ以降がわかりません。 select seihin,count(seihin) as scount from test group by seihin having (count(seihin)>1) 以上よろしくお願いいたします。
Microsoft SQL Server 2000を使用しています。 わけあってHDDのフォーマット及びOS(Windows 2000 Server)の再セットアップを行うことになり、この上にあるデータベースのバックアップをとりたいと思っています。 研修用のテスト機なので、SQL Serverを停止することは全く問題ありません。OSを再インストールし、SQL Server 2000 を再インストールした後に同じ状況を復元できないかと考えています。 良い方法をご存知の方、ご教授いただけないでしょうか。
今、テーブル全てをUPDATEしたいのですが、 どのようにしたらいいのでしょうか？ samp1_table n -------- 12 9 23 56 1 を昇順や降順に並べ替えを行い、UPDATEしたいです。 よろしくお願い致します。
採番テーブルを作成しています。 テーブルが空の場合に、初期値に1を設定したいので、 以下の構文を作りましたが、どちらも値が入っていれば番号+１を返してくれますが、テーブルを空にした場合は引っかかりません。 ・SELECT ISNULL( 最新番号+1, 1 ) FROM 採番テーブル ・SELECT CASE WHEN 最新番号 = '' THEN 1 ELSE 最新番号+1 END FROM 採番テーブル テーブルが空のときは１を入れるのを一文でやるのは無理でしょうか？
[社員マスタ]及び[個人マスタ]共に[社員ID][個人]が主キーです。 その二つのテーブルをJOINし 1つ目のSELECT文は[社員マスタ]の[社員ID]が1の物を 2つ目のSELECT文は[社員マスタ]及び[個人マスタ]の[社員ID]が1の物を 取得するSQLです、このSQLが返す答えは一緒なのは当然ですが 実行プランのコストまで同じなのは何故でしょうか？ 2つ目のWHEREは2つのテーブルから条件をみてるので その分遅くなると思うのですが、詳細がわからない状態です。 何かアドバイス等あれば些細な事でも情報くださいませ。 SELECT * FROM 社員マスタ INNER JOIN 個人マスタ ON 社員マスタ.社員ID = 個人マスタ.社員ID AND 社員マスタ.個人ID = 個人マスタ.個人ID WHERE 社員マスタ.社員ID = 1 SELECT * FROM 社員マスタ INNER JOIN 個人マスタ ON 社員マスタ.社員ID = 個人マスタ.社員ID AND 社員マスタ.個人ID = 個人マスタ.個人ID WHERE 社員マスタ.社員ID = 1 AND 個人マスタ.社員ID = 1
SQLServer初心者です。 OracleではDate型をChar型にして抜き出したい場合、 関数ToCharを使っていますが、SQLServerにはこの関数がないようですが、どの関数がこれにあたるのでしょうか？ また、やりたいことはGetDateにより取得したシステム日付を、Char型の'yyyy/mm/dd'として出力したいのですがどのように記述したらよいのでしょうか。
データベースの問題なのですが、私が考えても分かりませんでした。 誰かご教授お願いします。。。 ある表が与えられていて、その表のある列の列値毎にグループ化し そのグループ毎に別列値の平均値と合計値を表示するSQL文の 例を示せ。使用する表の例も添えること。 という問題が解けません。お願いします。
お世話になります。 データロガー付属の帳票作成ソフトのDBからデータを取得するために使ってみようと、Microsoft SQL Server 2000 Desktop Engine (MSDE 2000) Release A をダウンロードしてみました。 セットアップを開始すると、 「指定されたインスタンス名が無効です。」のエラーが発生してしまいます。 原因と回避する方法を教えてください。 OSはWin2000です。 よろしくお願いします。
ACCESS2000とSQLserver2000を使用しています。 基本的な事かもしれませんが教えてください。 パススルークエリでSQLserverにODBCで接続時に、下記のような事をしたいのですが、フォームのテキストボックス内の内容([Forms]![フォーム1]![テキスト0])をSQL文に代入する方法を教えてください。 ACCESSだけのSQLでは下記の方法でやっていたのですが・・・。 UPDATE テーブル1 SET テーブル1.B = [Forms]![フォーム1]![テキスト0] WHERE (((テーブル1.A)=1)); よろしくおねがします。
エクセルファイルに書いた抵抗のデータ(抵抗値、消費電力など)をVBを使って読み込み、それを使ってどの組み合わせがいいのかなどを検証するプログラムを作りたいのですが、エクセルファイルからのデータの読み込み方がよく分かりません。どなたか、サンプルプログラムを提供していただけないでしょうか？
SQLServer2000を使用しております。 別環境のデータベースのバックアップファイルを当該環境へ復元させたいと考えているのですが、 バックアップデータファイルを指定して復元を行ったところ、以下のダイアログが表示され、復元に失敗します。 "物理ファイルを拡張しようとした時に MODIFY FILEでオペレーティングエラー112(ディスクに十分な空き容量がありません。)が"発生しました RESTORE DATABASEが以上終了しました" 別環境のデータファイルは230M、トランザクションログファイルは11Gでした。 復元先のドライブの空き容量は17Gです。 十分に空き容量があると思われるのですが、なぜ上記のようなダイアログが出るのでしょうか。また、データファイルのみの復元ということは不可能なのでしょうか。 ※　トランザクションログファイルが肥大化している件につきましては、 　　ログの切捨て、ファイルの最大サイズの指定、及び復旧モデルも"シンプル"と修正する様対応する予定です。 上記の件につきまして、原因、または対応方法がお分かりになる方がいらっしゃいましたら、 ご教示のほど、何卒よろしくお願いいたします。
以下のようなSELECT文を実行して SELECT 船名 FROM 船マスタ 以下のような結果が返ってくるDBがあります。 船名はNVARCHAR型です。 船名 ------------- A800BCC A800BCD 800BDC ・ ・ この表示結果をアルファベット部分だけ(ABCC、ABCD、BDCみたいな) にしたいのですが、そのような関数も用意されて無い様で 考え方すら浮かんできません。 格納されているデータからアルファベット部分または数字部分だけを 抜き出して表示する事は可能でしょうか？ よろしくお願いします。
SQL Server(MSDE)で例えば既定のインスタンスに 2つのDBを作るとして、それぞれをアプリAが使う DB1とアプリ2が使うDB2とします。 DB1の方はWindows統合認証でデーターを書き込んで DB2の方はSQL Server認証でデーターを書き込む場合 認証方式の違いでお互いのDB上のデーターが破損したり 整合性が取れなくなるということはあるのでしょうか？ あるいは認証方式は統一した方が良いのでしょうか？ ものすごく初歩的なことかもしれませんが、どなたか ご助言頂ければ嬉しいです。
HTMLとJavaScriptを始めたばかりです。 簡単に言うと、ブラウザに表やボタンを作って、ボタン押下をトリガーとして、簡単なinsert文を発行して、アクセスで作ったデータベースにアクセスして、返ってくる値をその表に挿入したいです。 まず、できるでしょうか？ データベースを作るのはいいとして、そこにどうやってアクセスして値を取り出すのか分かりません。 簡単なサンプルなどありましたら、教えてください。お願いします。
OS:WindowsXP SQLServerOS:WindowsNTServer4.0 SQLServer6.5 お世話になります。 今まで自PCからODBC接続でSQLServerのデータを見ていたのですが、 ある日気付いたら下記エラーが発生し、まったくつながらなく なっていました。 （エラー内容） 接続できませんでした SQL State：’08001’ SQL Server エラー ： 11 [Microsoft][ODBCSQL Server Drivers][DBMSSOCN]一般ネットワークエラーです。 ネットワークのマニュアルを調べてください。 接続できませんでした SQL State：’0１000’ SQL Server エラー ： 10061 ConnectionOpen(connect()) 現在SQLServerは3台あるのですが、全てつなぐことができません。 他PCからはつながるので、自PCに問題があると思われるのですが、 原因がわかりません。 何かヒントでもいいので、どなたかご教授願います。 よろしくお願いします。
もともとテーブルにデータをダミーで入力して、そのデータを削除し<NULL>に変更したいのですが・・・ 確か、Ctrl＋Enterで<NULL>を設定できたと思うのですが、うまくいきません・・・ <NULL>に変更したいのは、レコードの一箇所のみです。 初歩的な質問ですが、よろしくお願いします。
テーブルAの社員数の値をテーブルBの対応したIDの社員数の値で更新したいのですが、どのようなSQL文を書けばいいのでしょうか？ テーブルA ID 会社名 資本金 社員数 1 ○×株式会社 1000万　70 2 △△株式会社 1億2000万 320 3 □□□株式会社 3000万　170 4　○○△商事　1500万　34 テーブルB ID 社員数 2 337 3 175 例としてあげたので少ないレコード数ですが、実際はテーブルAのレコード数は数万件とあり、それに対するテーブルBのレコード数も数千件とあります。
はじめまして。 アプリ画面にユーザーアカウントの権限のロールを表示する際、『役割』としたら、意味が判りづらいとユーザーから批難ゴーゴー。 結局『ユーザーアカウント』に変え、今度は権限ではなく、テーブルに属する項目(コラム）自体がロールであるというのを表示せねばならず、何という呼び方をすれば良いのか判らず困っています。 カタカナで『ロール』としたら殴られそうな感じですし．．． この場合のロールの同義語って何なんでしょう？ 皆さんのご意見を是非お聞かせ下さい。 どうぞよろしくお願いします（ｍ_ _ｍ）。
SQLのクエリアナライザでTransact-SQLでコーディングをしているのですが、ソースをいじっていないのに、さっきまで動いてたものが「列名○○が無効です」と出るんです。１度閉じてまた開きなおすと普通に動いたり・・・。これって何が原因なんでしょうか？お分かりになる方いますか？　またクエリアナライザ以外でこれは開発に使えるよっていうツールあったりします？？よろしくです♪
SQL SERVER 2000で、データベース（master,model,msdbに限る）のバックアップを行い、作成されたバックアップファイルを別のサーバへ復元すると、’このバックアップを作成したサーバーのバージョンとこのサーバーのバージョンが異なります’のエラーとなる。互いのSQL SERVER 2000のバージョンは同じである。他にバージョンがあるのでしょうか。因みに、エクスポート、インポートでは問題なく実行できます。何かお分かりでしたら、ご教授お願いします。
以下、ご回答、よろしくお願いします。 ストプロで、カーソルに格納したレコードを、１変数にセットしたく思います。 （この変数を本文にして、メールをはき出します。） AccessVBAでは -------------------------- Do Until rs.EOF 　　strBody = strBody & rs!受注コード & ":" & rs!明細コード & vbCrLf 　　rs.MoveNext Loop -------------------------- とするところを、sqlのストプロで -------------------------- WHILE @@FETCH_STATUS = 0 BEGIN 　select @strBody = (@受注コード + @明細コード)　+ char(13) + char(10) 　FETCH NEXT FROM cur_cust 　INTO@受注コード, @明細コード end -------------------------- 等としても、１レコード分のデータしか渡りません。（あたり前ですね。） 現在に手詰まりの状態です。 ご教授、よろしくお願いします。
SQL ServerでデータをCSV形式にエクスポート したいのですが、SQLクエリにて実行させるには どのようなクエリを発行すればできますでしょうか。 よろしくお願いいたします。
今PCにSQLServer2000のSP4が入っているのですが SP3にダウングレードすることって可能でしょうか？ 他の製品をインストールしたいのですがその時SP3でないと いけないのでダウングレードする必要が出てきているのです
既存のテーブルにinsertもしくはupdateする際に、 正しい列名を指定しているにもかかわらず、 タイトルどおりのメッセージが出てしまいます。 なにが影響してるんだか・・。 特にkey項目でもなく、普通のカラムなんですが・・。 考えられるものとしてなにかありますか？ ソースを何度も見直したのですが、わからず・・。 TransactSQLなので、莫大なソースのため、張ることも できず・・。どなたかご教授願います。
初めて投稿させて頂きますので、不手際があるかもしれませんがどうぞ宜しくお願いします。 さて、WindowsNT(sp6)＋SQLServer6.5のデータベースを同じ環境（WinNT+SQLserver）の別マシンへ移行したいのですが、どのような手段があるでしょうか？ 少し調べた範囲では、エンタープライズマネージャーを使用して移行する方法がありました。もっと簡単な方法はないかと探しております。 ちなみにデータ移行の理由は、サーバーの性能アップです。宜しくお願いします。
１コのマスタテーブルがあるとします。そのマスタのいくつかのカラムのデータを変更し、２つのテーブルに分けてはくという事をやりたいのです。今自分が考えてるのは、変更の必要なカラムと必要ないカラムに分けて、２つのテンポラリーテーブルにはいて、カラムを変更した後、変更済みと変更の必要のないカラムをもったテンポラリテーブルとを結合して、それを２つに分けてはこうと思っているのですが・・・。ほかになにかいい考えがありますか？ご教授願います。
SQLServer2000を使用してVarchar型の項目に半角スペース１文字のデータを検索した場合、 条件文AAA=''でもAAA=' 'でも抽出されてしまいます。 AAA=''の場合は抽出しないようなSQLServerの設定があるのでしょうか。 何方かご教授お願い致します。
社内LANのSQLServer2000において、有効な通信プロトコルはTCP/IPのみで 認証はSQLServer認証という環境で、クライアントからの接続をIPアドレスによって 制限したいのですが、良い方法を教えてください。都合上、ルータの設置や Windows認証は行わないことになっています。よろしくお願いします。
インデックスの有無は検索速度に大きな影響を与えると思いますが、どのような項目にインデックスを定義すると、効果が高いですか？ また、同一テーブルに複数のインデックスが定義されていた場合に、使用するインデックスがどのようにして選択されるのでしょうか？ 簡単な説明でけっこうですのでお願いします。
SQLServer2000にてストアドプロシージャをデバッグする方法は存在しますでしょうか？ またどのような手法を取ればよろしいのでしょうか。
テーブル（buf1) g_num ------ 11 テーブル（sample1） 　text |code ------------------------------------------------- (1)ＮＢＡバスケットは今シーズン熱い戦いが繰り広げられるだろう | 11 (2)戦争は映画の中でけの戦いにしてほしい | 11 (3)名探偵と言えば、ホームズ？今はコナンになるのか？ | 12 テーブル（c_text) g_code | num | word ---------------------- 11 | 1100 |ＮＢＡ 11 | 1100 |バスケ 11 | 1100 |ＭＪ 11 | 1100 |ダンク 11 | 1101 |映画 11 | 1101 |監督 11 | 1102 |戦争 11 | 1102 |戦い 12 | 1200 |データベース １．テーブル（sample1）のcodeがテーブル（buf1）のg_numと等しいレコード。 　　ここでは、(1)と(2)のレコードが対象となる。 ２．codeとテーブル（c_text)のg_codeが等しいwordを用いて、 　　textを文字検索を行う（LIKEを用いて部分一致検索）を行う。 text LIKE '%'|| word ||'%' ３．textにwordが存在するnumの出現回数を数えて、最も出現回数の 　　高いnumをテーブル(sample1)の各レコードのnum値とする。 レコード(1)の場合、num(1100)が２回(ＮＢＡとバスケ）出現しており、 num(1102)が１回（戦い）が出現しているがnum=1100の方が出現回数が高いため レコード(1)のnumは1100とする。 最終的欲しいのは、 text |code|num ------------------------------------------------- ＮＢＡバスケットは今シーズン熱い戦いが繰り広げられるだろう | 11 |1100 戦争は映画の中でけの戦いにしてほしい| 11 |1102 です。 説明がわかりにくくて申し訳ございません。 なるべく一時テーブルなど作成せずに ＳＱＬ一文で処理がしたいです。 どうぞよろしくお願い致します。
今最大値を抽出するSQL文を考えているのですがうまくいきません。 例えば、Sampleテーブル count | num ------------- 1 | 11 3 | 12 2 | 13 9 | 14 6 | 15 のテーブルでcountが一番大きいnumを取り出したいのですが、どのようにしたらいいのでしょうか？ この場合、countが一番多い９の num=14を取り出します。 よろしくお願い致します。
AAAサーバAAデータベースAテーブル BBBサーバBBデータベースBテーブル があったとしまして、BテーブルはAテーブルのコピーでデータベースの型はまったく同じです。 Aテーブル、Bテーブル別々に更新をかけてしまった為 Bテーブルのある列（Eメール入力欄）をAテーブルの同じ場所に上書きコピーしたいのです。 つまり、AテーブルのEメール列だけをBのデータで上書きしたい。 この場合のオペレーションはどのようになるのでしょうか？ おしえてください＞＜
ODBCを設定しなければいけないのですが初めてなのでわかりません。 どのように行えばいいのか教えていただけないでしょうか？ よろしくお願いします。
日数の平均を取得したいのですが、小数点の値が戻ってきません。どうしてでしょうか？ select avg(datediff(y,A_date,B_date)) from TABLE ●欲しいデータ 1.5 = 3(日間) ÷ 2(レコード) ●データ内容 SQL> select A_date,B_date from TABLE; A_date,B_date ---------- 2005/07/01 2005/07/02 2005/07/01 2005/07/03
SQLServer7.0のSP4をあてたところ、サービスが 動かなくなってしまいました。 エラーログは下記の内容です。 "サーバー コマンド (プロセス ID #9) が原因でクエリの内部並列実行がデッドロックしました。クエリ ヒント オプション (maxdop 1) を使用して、クエリ内部並列実行を指定しないでクエリを再実行してください。" このエラーを回避する方法をご存知ではないでしょうか？ SPをアンインストールすることはできないでしょうか？ また、調べていたところOPTION句？を使用してMAXDOPを 1に設定するという方法がありました。 この方法をSQL文ではなく、ツール？から設定する方法をご存知でしたら教えてください。 知識がないためうまく説明できずすみません。 非常に困っております。 どなたかご存知の方おみえになりましたら教えてください。
BULK INSERTを使ってテーブルにデータを入れようとしているのですが、ファイルデータしか取り込めないのでしょうか？ プログラム(C++)で生成したテーブルデータをオンメモリで引き渡してBULK INSERTとか出来ないでしょうか？
面積のAreaという数値の項目があり、SELECT時に"999m2"と単位付きで表示させたく 　SELECT Area + "m2" FROM MyTable というクエリで出来るのですが、Areaの値ががNullや0の時は"m2"を付加させないようにするには、SQLクエリで出来ますでしょうか。
大変こまっていますー 状態を説明します Aサーバ（ローカル） Bサーバ（ネットワーク：IP指定） 両方にTable025というデータベースがあり、エクスポートでテーブル事コピーした為 中身は同じ。 その中のABCMｓｔというデータベースがあります。 Aサーバ、Bサーバ別々にABCMstにデータを追加しました。 ■やりたいこと AサーバのTable025のABCMstのABCNumが00001のものを BサーバのTable025のABCMstに追加コピーしたい ※BサーバにはABCNumが00002のものしかありません。 ■実施 (1)AサーバのTable025の上で右クリック→データのエクスポートを選択 (2)データソース元をAサーバにする（元からデータが入ってるためなにもせずに次へ） (3)変換先の選択で サーバー：BサーバのIPアドレス SQL認証にし、IDとパスワードをいれる。 データベースのコンボボックスで「abc025」を選択 次へ (4)テーブルのコピーまたはクエリの指定で「変換するデータの指定にクエリを使用」を選択 (5)SQLステートメントの入力でクエリビルダを選択 (6)列の選択で「ABCMｓｔ」をダブルクリック　次へ (7)並べ替えの指定　「＞＞」マークをクリックして次へ (8)クエリ条件の指定 条件に一致するのみチェックをいれる。 列：[ABCMst].[ABCNum] 演算子：= 値は、[・・・]ボタンをクリックし00001を選択する 次へ (9)SQLステートメントの入力にコマンドが入っていることを確認し、次へ (10)変換元テーブルとビューの選択は何もせずに次へ (11)すぐに実行チェックが入っていることを確認し次へ (12)完了ボタンを押下しデータコピーが始まる。 (13)データを見てみるが、00001のデータが追加されていない・・ やり方が間違っているのでしょうか？ 長々と書いてしまいましたがよろしくおねがいします。
SQL Server 2000 を使用しています。 Aテーブルが空の状態でのAテーブルの使用しているバイト数 及び、レコードを1件追加した際のバイト数は どの用に出してやればいいのでしょうか？ Decimal型でn桁ならnバイト Nvarchar型でn桁ならnバイト という感じでAテーブルで使用してる 各列のバイト数を足してやれば空の状態のバイト数は出るのでしょうか？ 検索してみてもこの辺りの事がうまく調べられなかったので どなたかアドバイスお願いいたします。
はじめまして、今回はじめて、Access2003とSQLServer2000で開発することになりました。 現在、データベースの排他制御について調査しております。 排他の種類と方法について、わかりやすく解説しているホームページ、書籍がありましたら教えてもらえませんか？ また、Access2003とSQLServer2000で開発時の注意点なども解説しているページがありましたら、お願いします。 漠然として申し分けませんが、情報ありましたら、よろしくお願いいたします。
update AbcMst set AbcMst.memberNo = Abc2.memberNo, AbcMst.Tel = Abc2.Tel from AbcMst inner join (select * from AbcMst where BBBNum ='00001')as Abc2 on right(AbcMst.memberNo,5)=right(Abc2.memberNo,5) where AbcMst.BBBNum='00555' という文があるのですが、意味がよくわかりません。 わかりやすく教えてください。 また、わかりやすいHPなどありましたら教えてくださいー
いつもお世話になっております。 VB.netでwindowsアプリケーションの作成しているところです。 SQLサーバーのテーブルを参照していますが、テーブルの結合は同じデータベース内にないと結合できないのでしょうか？ 'SQL接続処理 Dim strConn As String = "Password='';User ID=sa;Initial Catalog=test;Data Source=server1" と、testというデータベースがありその中に幾つかテーブルがあります。 このtestデータベースにないテーブルが必要になり、aaaデータベース内の テーブルを結合しようとしたのですが、出来ません。 Catalog=test,aaaとやってみたり、SELECT * FROM tbl1,aaa.tbl2などとしてみましたが、遠いようです。 SQLのクエリを使って、テーブルの追加をすると同じデータベース内のテーブルしか出てこないので、出来ないのかなと思っていますがどうでしょうか？ わかる方がいましたら教えてください。
ＡＣＣＥＳＳのＡＤＰでのフォームコントロール参照式はForms![フォーム名]![コントロール名]でフォームのデータコントロールのSQL文の抽出条件に設定したのですがエラーがでます。教えてください。
SQL文の抽出条件にフォームのオプション値をいれているのですがエラーがでます「VarChar型をINT型に変換できません」　　なぜでしょう。 = CONVERT (int, 'Forms ! MainCommunication_F ! Frm_1')でグリッドに設定しています。
お世話になります。 Microsoft SQLServer 7.0での質問です。 decimal(10)属性で定義されている項目をselectし、結果の表示形式を'00000'にしたい のですがうまくいきません。 Oracleからの移行のため苦戦しています。 質問１ そもそもそのような関数は用意されているのでしょうか？（実現は可能でしょうか？） 質問２ 可能な場合、解決方法をご教授ください。 SQLServerに携わるのが今回初めてなため、調査方法に限界があり、最後の 砦として質問させていただきました。 宜しくお願いいたします。
MSDE (MS SQL Server 2000 Desktop Engine Release A)で、 "Northwind"データベースを使うことはできるのでしょうか？ どうやって入手すればいいのでしょうか？ MicrosoftのHPから、 SQLServerのマニュアルの最後の方に"Northwind"について記載が あるようなことが書いてあり、 「Microsoft SQL Server Books Online」をダウンロードしたの ですが．．． 環境はWindows2000Prof.でMSDEとしてはスタンドアロン状態で Windows認証で使用。
お世話になります。 DateTime型のデータを 「YYYY/MM/DD HH:Mi」の形式で取得したいです。 また、「2005/07/01」の日付型データを上のように、 日時の形式で表示（2005/07/01　00:00）で 取得することはできるでしょうか？ CONVERT関数だと思うのですが、 時分の取得方法がよくわかりません。 お知恵をお貸しください。
現在、SQLServer2000を使用していますが、 多数のロックが発生しているようで、パフォーマンスが出ません。 そこで、ロックが発生してしまっているSQL文を抽出したいと考えています。 必要な情報としては、以下になります。 ・ロックの種類 ・原因のSQL文 ・ロックしている時間 なにか良いツールや方法がありましたら、教えてください。 よろしくお願いします。
VB.NETを使ってプログラミングをしてるんですが。 無償でデータベースサーバを使えるということでMSDE2000AというのをインストールしてMSSQLServerを使ってます。 他のパソコンにデータベースをコピーしたいんですけどどうすればいいですか？
今まで バック：SQL Server フロント：ACCESS2000 でシステム構築を経験してきました。 今までUPDATE文や、INSERT文はACCESS側でクエリを 作り、ODBC経由で実行してきましたが、 上司より、 「SQL-Server上でデータ更新をしてほしい」 といわれました。 この場合、SQL-ServerのどこにUPDATE文を書けば 良いのでしょうか？ ACCESSのクエリのデザインビューみたいなので 作成できるのでしょうか？ 教えてください。
現在、実行するとあるレコードセット（１行１列のみ）を返すストアドプロシージャProc_Aがありますが、このプロシージャを実行して得られる結果を、 別のプロシージャProc_Bで、以下のような形で使用したいと考えています。 ただし、Case文内部でのストアドの実行や、変数へのストアドの実行結果の代入を試しましたが、どちらもうまくいっていません。 なにか、よい解決策があれば、教えていただければ、と思います。 パターンA)　Case内部で直接実行 select case Table_A.param_1 when 0 then Exec Proc_A '***','**' else '' end パターンB）いったんパラメータとして取得 declare @values as char(10) execute sp_executesql N'@values = Proc_A ''***'',''**''', N'@values char(10) OUTPUT', @values OUTPUT
質問：以下の処理が大量のトランザクション（アプリケーション（クライアント）とサーバー間で発生している。その原因を教えて下さい。 現象： アプリケーションは Access 2003のVBAで記述し、クライアント側で使用。 サーバーはSQL Server ver 8を使用。 フォームに対してAテーブルとBテーブルを用いたクエリーを使用している。 　このフォームの一つのフィールドに対して値を代入する処理があるが、なぜかサーバーにアクセスし、しかも大量のデータのやり取りが確認されている。 問題の処理だが、 Myfrm!field1 = Const_num field1：フォーム上のフィールド Const_num: Globalに宣言された固定値 実施したこと： 回線使用率を確認して回線の帯域をほとんど使用していることを確認。 ODBCトレースを取得してみてみたり、等々していましたが、見方がよくわからないのもあり、原因が解明できていません。 マニアックな環境（状況）ですが、宜しくお願いします。
下のようなテーブルがあります。 名前|国語|算数|理科|社会 ------------------------ 太郎| 85 | 75 | 65 | 95 花子| 62 | 72 | 82 | 92 ここから、 太郎| 95 | 85 | 75 | 65 花子| 92 | 82 | 72 | 62 というように、列データをソートして取り出したいのですが、１つのクエリで可能でしょうか？
いま、まったく同じ型のTABLE1,TABLE2の2つのテーブルがあり、 TABLE1にInsertやUpdateがかかると、自動的にTABLE2の方にも 同じようなInsertやUpdateが走る仕組みを作りたいと考えています。 TABLE1にトリガーを設定すれば可能ということは判ったのですが、 どのようにトリガーを記述すればわからず、困っています。 特に、「AS」以降の記述方法が判りません。 TABLE1にかかったクエリを同じようにTABLE2にもかかるように するにはどのように記述すればいいのでしょうか。
はじめまして、データベースについては全くの素人です。SQL SERVER 2000とMSDEを同一ハードディスク上で使用することは可能でしょうか？また、条件付で使用可能な場合、確認する項目をご教示願います。 SQL SERVER 2000はある会計ソフトに同封されていた制限使用ライセンスです。MSDEは会計ソフトとは別に生産管理ソフト用に使用します。不足情報がある場合はご指摘下さい。 宜しくお願致します。
１テーブル（V_TEST）より日付（CTR_M）を抽出条件（単年月、複数年月）で、 金額（COSTM_GR）をそれぞれ合算した結果を表示したい 以下のSELECT文に合算処理を入れて完成するのですが、わかりません。 具体的な方法をご教授ください。 ※１回のSELECT文でデータを取得したい （以下にSQL文、テーブル内容、処理結果を明記します） 使用ソフト：SQL Server2000 ・SQL文 SELECT SECTN_C, TK = CASE WHEN CTR_M = '2005/06/01' THEN COSTM_GR ELSE 0 END, COSTM_GR AS TR FROM V_TEST WHERE CTR_M = '2005/06/01' OR CTR_M = '2005/04/01' ・V_TEST テーブル CTR_M SECTN_C COSTM_GR 2005/03/011 10000 2005/04/011 1 2005/04/011 2 2005/04/011 3 2005/04/011 4 2005/04/011 105 2005/04/011 12345678901 2005/06/012 100000 2005/06/011 1005 ・処理結果 SECTN_C TK TR 1 01 1 02 1 03 1 04 1 0105 1 012345678901 2 100000100000 1 10051005
はじめまして、こんにちは。困っているので教えてください。現在エクセルの表にさまざまなＩＤがあります。 それらを順番に抽出してきて、データベース内にあるＩＤと一致したらそのＩＤを一つの横の列に移して、１とかかれているセルを０にしたいのですが、そのようなことは可能なのでしょうか？もしエクセルのままで行うのが難しいのなら別のテーブルを作成しても大丈夫です。とても困っています、よろしくお願いします。
題記の通り、SqlServer2000のストアド内にてクライアント(呼出側)のコンピュータ名、ログイン名を取得することは可能なのでしょうか？発行アプリはVb.Net2003です。 どなたかご教授お願い致します。
お世話になります。 テーブルからテーブルへのデータコピーをしたいのです。 たとえば、 ワークテーブルから売上テーブルへ データをコピーするとします。 売上テーブルには、主キーとなる「売上NO」（10桁）という項目があります。 ワークテーブルには売上NOはないので、データ移行時に売上NOを作成してやらないといけません。 一文だけで片付けようとすればどう書けば良いのでしょう？というか一文では無理なのでしょうか？ insert into 売上テーブル (売上ＮＯ,販売単価......) select (select right('0000000000' + (convert(nvarchar,max(売上ＮＯ) + 1)),10) from 売上テーブル) ,販売単価..... from ワークテーブル とやってみましたが、ダメでした。一括でデータ追加に行くので主キー重複エラーとなりました。 どなたかご教授ください。お願いします。
こんな簡単な質問って思われるかもしれませんが どうしてもうまくいかなかったので教えてください。 SQLserver(2000)でテーブルの値をランダムに取得したいのですが、どのようにやったらいいのか教えてください。 文章だけだとわかりにくいと思いますので、図にしてみます。 TableA 通常　　　　1回目　　　2回目 columnAAA　columnAAA　columnAAA ---------　---------　--------- 111111111　333333333　222222222 222222222　555555555　111111111 333333333→111111111→555555555 444444444　444444444　333333333 555555555　222222222　444444444 こんなイメージなんですけどよろしくお願いいたします。
Windows2000ServerにMSDEをインストールしたのですが、 クライアントからODBCで接続しようとすると失敗します。 サーバ上からは、正常に接続できます。 そこでですが、MSDEってローカルのみしか接続できないのでしょうか？
かなり初心者な質問なのですが自宅の環境でデスクトップＰＣにSQLServerがインストールしてあって 無線ＬＡＮでつながっているノートパソコンでサーバーの中を覗けるようにしたいのですが、 このまま無線ＬＡＮで接続できるようになるのでしょうか？ ＬＡＮケーブルで直接つながないと無理なのでしょうか？ また、ＳＱＬＳｅｒｖｅｒをノートパソコンにもインストールしないと駄目なのでしょうか？ よろしくお願いします。
質問します。 VB.NETとSQLServer2000を使用して受発注処理を作成したいのですが、排他制御について今悩んでいます。 レコードロックの動作についてなのですが、Ａさんが「A01」のデータをレコードロックでデータを画面に表示している場合に、Ｂさんも(別PCにて)同様にレコードロックで「A01」のデータを表示することは可能なのでしょうか？(取得できるのか) 何方かご教授お願い致します。
以前似たような質問をしたのですが、解決していないまま 締め切ってしまったので再度質問です。 EnterpriseEditionではバックアップデバイス可能な 媒体は、ローカルディスクやＭＯやネットワークドライブ と公式ページに書いてありました。 （EnterpriseEditionを持っていないので本当かどうか知りませんが・・・） StandardEdtionでネットワークドライブにバックアップを取る方法をどなたか知っている方いらっしゃいますでしょうか？そもそも可能なのでしょうか？（汗） エンタープライズマネージャーであるＤＢを バックアップしようとする際に、 バックアップ先の選択を選んで表示される ドライブはSQLServerがインストールされているＰＣ のローカルドライブしか表示されないはずです。 （ＭＯやテープは表示されなくてもＯＫ） そこにネットワーク接続しているドライブを 表示はできないでしょうか？ということを聞きたいです。 そこには出ないけど、isqlコマンドを使うと 『ネットワーク』ドライブにバックアップを 取れるよ、という方法でも構いません。 とにかく『ネットワーク』接続したほかのＰＣ のドライブにバックアップできるのかどうか （ツールを使わずにSQLServerの機能だけで） 教えてください。 長い間困ってます。
Accessのフィールドの型の中にオートナンバー型という、自動で連番になる型があります。 SQL Serverにはそういった型がないため、自分でナンバーを付与していくスクリプトを組まなくてはいけないと思います。 一番簡単な方法は、連番になっているフィールドを降順で並び替え、一番最初のレコードに１を足してあげれば連番になるのですが、Webで注文を受けるようなシステムの場合、タイミングによっては同じ番号を割り当てられてしまう可能性があります。 同じ番号がわりあてられずに連番で番号を付与していくには、どういうやり方があるのでしょうか？
教えて下さい！ SQLサーバ2005はいくらくらいで販売されているのでしょうか？ また、販売されているお店のURLも教えて下さい！ よろしくお願いします。
Sqlserver6.5を使用していますが Oracleでいうところの「Sql loader」のようなツールは 用意されているのでしょうか？ とりあえずAccessを使用してODBC経由でSqlserverにアタッチし 元データ（CSV）を流し込んでいますが、データ量が多くなると一度に処理出来ない場合があるので もっと簡便な方法を、と思い今回質問させていただきました。 よろしくお願いします。
ＳＱＬサーバＡからあるテーブルの前日分のデータだけをスケジュールでＳＱＬサーバＢにエクスポートしたいのですが、 日付を指定ではなくて、常に前日分のみを吐き出す方法はあるのでしょうか。 サーバはＡ，Ｂ共にＳＱＬ2000を使用しています。
現在、OS:Win2000Server、DB:SQLServerVer8で稼動しているシステムからデータをLinuxのサーバにコピーしようと考えているのですがどういった方法があるのでしょうか？ ネットで検索するとODBC接続と言う方法があるようですが、これは日本語に対しても実績があるのでしょうか？ Linixサーバ上のDBはMySQLかPostgreSQLを考えています。 どちらが良いと言うお勧めがあれば併せて教えて頂ければありがたいです。 複数の質問申し訳ないのですが、どれか１件でも良いので情報があれば教えて下さい。お願いします。
タイトルの通り、双方の違いはなんなのでしょうか？ 教えて下さい。
ＳＱＬ文で困っています。 ご教授下さい。 下記のようなデータがあった場合、それぞれの区分毎に 年月が最大(最新)のデータを取得したいです。 (実際には1レコードにその他項目があり、それらも取得します。) ＜検索対象データ＞ 区分　年月　　　金額 ----------------------------- A 　　200412　　600 A 　　200503　　560 B 　　200311　　600 B 　　200508　 1000 B 　　200504　　560 C 　　200508　　400 C 　　200301　 1100 ＜取得したいデータ＞ 区分　年月　　　金額 ----------------------------- A 　　200503　　560 B 　　200508　 1000 C 　　200508　　400 よろしくお願いします。
初めて投稿させて頂きます。 Ｃ＃練習中のpotanです。よろしくお願いします。 今、VS.NETでWebアプリケーションをつくっています。 DataGridコントロール内のテンプレート列につくったドロップダウンリストに、DB（SQLサーバー）にあるテーブルのデータを表示させたいのですが、何日悩んでもうまくいきません。。 誰かご指導をお願いします。 追記：DBのデータではなく、プログラム自身にかいたItemを表示させることはできました。
現在システムの刷新をすすめていて、既存システムで持っているバイナリファイル(word,excel,pdfなど)の移行について検討しています。 テーブルのバイナリ型の列に格納しておくのと、普通にサーバのディレクトリ内にファイルで保存しておくのとはメリット、デメリットなどを考えるとどちらがメリットが多いでしょうか？ また一般的なのはどちらでしょうか？ また、テーブルに格納する場合は良いツールがあれば利用したいと思っています。なければ自力でつくる予定ですが、良いツールがありましたらご紹介ください。 よろしくお願いいたします。
SQL Server2000を使用しています。 検索結果をウィザードを使わずにファイルに書き出すにはどうしたらよいでしょうか。 My SQLだと select * from table1 into outfile 'file1.txt' のようになると思いますがSQL Serverだとどうなるでしょうか。 持っている本によるとウィザードを使用する となっていて コマンドの記載がありません。 よろしくお願いします。
はじめましてkou2000と申します。SQLServer2000でストアドプロシージャを作成していますがうまくいきません。 下記のようなことが実際にできるかご教授ください。 CREATE PROCEDURE TEST_PROCEDURE @SYUBETU nvarchar AS SELECT AAAAAAA INTO ##TMP FROM TEST WHERE BBBB IN (@SYUBETU) GO 上記のようなストアドプロシージャを作成しプログラムから実行する際に @SYUBETU = "'1','2','3','4','5'" のような可変の文字列を設定しストアドプロシージャを実行できますでしょうか？ よろしくお願いします。
Oracle で日付の差を求める関数に「months_between」 というものがあり、日付A(yyyy-mm-dd)と 日付B(yyyy-mm-dd)の差(A<B の場合)を算出する時は、 select months_between(B ,A) from dual; で算出できます。 しかも、日付差が何ヶ月で返ってきて、月の端数は 小数点以下として返ります。 これを、SQL Server で実現しようとした場合、 どのようにすればよいでしょうか？ SQL Server には「datediff」という関数があり、 時間単位を'm'に設定すれば日付差が月で返って きますが、小数点以下が確か切り捨てられたように 記憶しています。 何とかして、小数点以下も算出できる方法を ご存知の方がいらっしゃいましたら、 お教えください。 宜しくお願い致します。 以上
OS:Windows 2000 Server SP3 DB:SQL Server2000 OSを再起動したときにイベントログへ以下のエラーが記録されます。 MSの技術情報を検索しても該当の情報が見つかりませんでした。 ソース：SQLSERVERAGENT エラーID:322 エラーメッセージ：The dayta portion of 19002 from MSSQLSERVER is invalid 何か知っている方がいらっしゃいましたらご回答の方、お願い致します。
お世話になっております。 表題の件につきまして、ご教授下さい。 ＳＱＬサーバのデータを、エクセルに出力するにはどのようにしたらよいかわからずに困っております。 アクセスのデータをエクセルに抽出する時に使用している、ＭＳクエリ及びＯＤＢＣの設定をちゃんとおこなえば、抽出する事はできると思うのですが、設定が 誤っている為、”ＯＤＢＣ－対象のデータへの接続が 失敗しました”と表示されなんの進展もない状況が続いております。 ちなみに環境としては、以下のような状態です。 (1)ＳＱＬサーバは、通常使用しておりますＰＣとは 別のネットワークに存在しております。 お忙しいところ申訳ありませんが、宜しくお願い致します。
SQLserver2000について御質問します。 既にSQLserver2000をインストールしてあるPCのコンピュータ名を変更すると、SQLserverが起動しなくなります。 まず再起動した地点で画面上に 「Your SQL Server installation is either corrupt or has been tampered with(unknown package id).Please rerun Setup.」 と表示されます。再セットアップしても状況は改善されません。 幸いXPでしたのでシステム復元をしたら基に戻りましたが、このままではコンピュータ名を変更できません。解決方法をご存知でしたら御教授御願いします。
こんにちはSHIRAOといいます。 MSDEで2つのユーザ(例えばAとB)を作成しました。 USE Aにログインした状態でユーザBのテーブルの内容を参照したいのですが、エラーになってしまいます。 例： USE A go SELECT * FROM B.CLR01 go エラー： オブジェクト名'B.CLR01'は無効です。 ORACLEやACCESSではテーブルの前にユーザ名を書けばよかったと思うのですがMSDEではなにか違うのでしょうか？
サーバＡからバックアップしたＤＢをコンピュータＢに復元したいのですが、Ａで割り当てていたデータ領域が ５Ｇぐらいのため、Ｂに復元しようとすると、領域不足で復元が行えません。 バックアップデータは５０ＭＢぐらいです。 Ａのデータ領域ではなく、Ｂに設定している領域内に復元するためにはどうすればよいでしょうか？
MS SQL Server2000を使用して、インターネット上で検索し、 その検索された言葉にあわせてデータを表示させる仕組みを 実現させたいのですが、どうすればいいですか？？ つまり、よくある検索サイトみたいな仕組みです！！ ＣＧＩでできると本には書いてあるのですが、曖昧すぎて具体的に 何をすればいいのか分からないので　どの言語で　どういう風にプログラミングするのか、また　良い参考書または参考サイトがあれば教えてください！！
はじめまして OS：2003Server、DB：SQL Server2000 WEBサーバ、DBサーバは別サーバです。 CSVを出力するASPを実行させているのですが、出力件数が多い時に下記エラーとなります。 （数十件の場合は、問題ありません。） 【エラー内容】 　Microsoft OLE DB Provider for SQL Server エラー '80004005' 　[DBNETLIB][ConnectionOpen (Connect()).]SQL Server が存在しないか、アクセスが拒否されました。 　/daityo/CsvOut.asp,行168 エラー箇所としては、SQLを実行しDBにアクセスする命令時に発生します。（実行毎に、エラーとなる行が変わります。） どこかで、タイムアウトしているのかと思い、'MetaBase.xml’の下記部分の値を変更しましたが、改善されませんでした。 AspMaxRequestEntityAllowed="102400000" 現在、手詰まり状態です。 皆様のお力をお貸しいただけないでしょうか？ 宜しくお願いいたします。
Windows2000,VB6,SP5で開発しています。 質問させていただきます。 例えば、下記のようなデータがあったとします。 名前　　　出勤日　　労働時間 Aさん　　11月29日　　8時間 Bさん　　11月29日　　7時間 Cさん　　11月30日　　9時間 Dさん　　11月28日　　6時間 Eさん　　11月27日　　3時間 これをSQL文で、出勤日を11月29日で抽出して、 名前　　　労働時間 Aさん　　　8時間 Bさん　　　7時間 Cさん　　　0時間 Dさん　　　0時間 Eさん　　　0時間 という感じで抽出するにはどうしたらいいのでしょうか？ ご存知の方いらっしゃいましたら、ご教授お願いしますm(_ _)m
SQL Server7.0を使用しております。 Enterprise Managerが以下のメッセージが表示され起動できなくなってしまいました。 ------------------------------------- Microsoft Management Console ------------------------------------- MMCはファイル C:\MSSQL\BINN\SQL Server Enterprise Manager.MSCを開くことができません。 ファイルが存在しないか、MMCコンソールでないか、または後のバージョンのMMCで作成された可能性があります。また、ファイルへのアクセス権が不足している場合もあります。 ------------------------------------- 昨日まで起動できていたのですが、設定等を変更している内に表示がおかしくなり、再起動すると本現象となってしまいました。 他のPCのEnterprise Managerから該当PCのDBは参照できます。 SQLサーバーの再インストールをしてみてもだめでした。 原因・対策があれば教えて下さい。 OS:WindowsXP Pro.
教えて下さい。 現在、Windows Server 2003にMicrosoft SQL Server 2000が動いています。 そのサーバーのドメイン構成（Active Directory）を変更したいと思います。 その際に注意する点をお教えいただければと思います。 <サーバー設定> 現在：server.aaa.co.jp(Win2003 DC） 変更後：server.bbb.local(Windows 2003 DC) また、変更については、一旦DCを降格し、別のドメインに参加するようにします。 恐れ入りますが、よろしくお願いいたします。
ケースA：[SELECT文]-[DB2].[ビュー]-[DB1].[テーブル] ケースB：[SELECT文]-[DB2].[テーブル] [テーブル]はどちらも同じ内容です。 ケースAは[DB1]にある[テーブル]を[DB2]の[ビュー]を通して見てます。 ケースBは[DB2]に[DB1]の[テーブル]と同じ物をコピーしています。 同じSELECT結果を表示するSQLで ケースAとケースBでパフォーマンス的に差が出るのでしょうか？ 私が思うのはケースAの場合別DBにあるテーブルをビューを使って 見てる事によって、DBやテーブルへのアクセス権限等の 確認処理でパフォーマンスが低下すると思うのですが 推定実行プランやプロファイラで見てもよく分かりませんでした。 些細な事でも構いませんので、教えてくださいませ。
大量（数十万件）の顧客マスタを作ろうとしています。 カナ氏名、漢字氏名が個人情報を含まない（歴史上の人物とか）で構成されたデータベース（できればＣＳＶ形式がうれしい）がどこかにないか探しています。 コツコツデータベースを作っていくのが大変なので；； 世の中のどこかにはそういうのがありそうな気がするので 質問です。どなたか知りませんでしょうか？
カレンダーというか、ある一定の範囲内で毎日の日付が得られるような、以下のようなデータを作成したいのですが、できればファンクションやストアドみたいなもので作成できないでしょうか？ 範囲開始日：2005-05-10 範囲終了日：2005-12-31 2005-05-10 2005-05-11 2005-05-12 . . . 2005-12-30 2005-12-31 よろしくお願いいたします。
こんにちは。 テーブルAに以下のようなデータがあるとします。 ID |名称 |項目 -------------- 01 |ああ | 02 |いい | 03 |うう |01,02 04 |ええ |01 SELECT文で取得したいのは、フィールド「項目」の値を、他のレコードの名称で置き換えた列です。 つまり、 ID |名称 |項目 |項目名称 ------------------ 01 |ああ | | 02 |いい | | 03 |うう |01,02 |ああ,いい 03 |ええ |01 |ああ という結果が欲しいということです。 「項目」の値はカンマで区切られています。 これを一つのSQLで取得したいと思っています（テーブルの結合、サブクエリーはOK）が、方法がわかりません。 どなたかどうぞご教授ください。 よろしくお願い致します。
はじめまして 現在スタンドアロンのノートPCにSQL Serverと OracleをインストールしたところSQL Serverに アクセスができず(クリエアナライザ使用) 以下の メッセージが表示されました。 ----------------------------------------------- サーバーに接続できません127.0.0.1 サーバーメッセージ17、レベル16、状態1 [Microsoft][ODBC SQL Server Driver] [TCP/IP Sockets]SQL Serverが存在しないか、 アクセスが拒否されました。 ----------------------------------------------- ※ Windows XP SP2 SQL Server 2000 Developer Edition Oracle 9i DataBase(9.0) 調べてみたところ以下のようなページを見つけ書いて ある内容も試してみましたが症状は変わりませんでした。 http://support.microsoft.com/default.aspx?scid=k … Oracleをインストールする前は問題なく使えていたので OracleとSQL Serverがどこかのポート番号が衝突して いるのでは？と思っているのですが、それ以上の解決方法が探せない状況です。初歩的な質問かもしれませんが、皆様のお力をお借りしたいと思います。 宜しくお願いします。
[SQL Server2000 スタンダードエディション]を持っておりますが、ネットワーク接続している他の端末にエンタープライズマネージャーのみインストールしたいのですが、可能でしょうか？可能であれば、インストール手順を教えて下さい。
asp.net から sqlserver のストアドプロシージャを実行させる勉強をしています。 作成されているはずのストアドプロシージャを実行できずに困っています。 webformにテキストボックス、ボタン、データグリッドを貼り付け、ストアドプロシージャを作成し下記のプログラムを実行させるのですが上手くいきません。 （テキストボックスに任意で入力された数値のデータをボタンを押すと表示するものです） ＜エラー内容＞→ ストアド プロシージャ 'proc1' が見つかりませんでした Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Dim cn As New SqlConnection Dim cmd As New SqlCommand cn.ConnectionString = "接続文字列" cmd.Connection = cn cmd.CommandText = "proc1" cmd.CommandType =　System.Data.CommandType.StoredProcedure Dim p1 As SqlParameter = cmd.Parameters.Add("@param1", System.Data.SqlDbType.Int) p1.Value = TextBox1.Text cn.Open() Dim dr As SqlDataReader = cmd.ExecuteReader DataGrid2.DataSource = dr DataGrid2.DataBind() dr.Close() cn.Close() end sub ストアドproc1(場所：Northwind)の内容↓ CREATE procedure proc1 @param1 int as select * from products where categoryID=@param1 どなたか原因のわかる方がいれば、宜しくお願いします。
キーが重複したレコードがバックアップファイル内にあっても、それを無視して重複していないレコードだけをリストアする方法は無いでしょうか? 現在、osqlコマンドを用いてテーブルの既存データに追加する形でリストアするプログラムを作っているのですが、重複したレコードがあると処理が中断してしまうため、残った重複のないレコードを追加できずに困っています。 サーバはSQL Server 2000 使用言語はVB.NET になります。 ご教授宜しくお願い致します。
OS：Win2K IIS 5.0 SQL Server 8 はじめまして。 現在、ASPにて社内のWebを作成しております。 イントラネットの為、Googleなどの "サイト内検索"は使えません。 イントラネットのHPにサイト内検索を実装するには どうすれば可能でしょうか？
SQLserver2000にオラクルのSQL*LODERのような 機能は存在しないでしょうか？ もし、存在するならば方法を教えて頂けると非常に 助かります。 宜しくお願い致します。
例えば SELECT 受注表.受注番号,商品表.商品名 FROM 受注表,商品表 USING(商品コード) WHERE 商品表.単価 >= 500; において USING(商品コード) がある場合とない場合でどう違うのでしょうか？
DB設計の場で、「ランダムリード」という言葉を 耳にするのですが、どの様な意味でしょうか？ またランダムリードの反対語は何になりますか？ それぞれの長・短所も教えてもらえればと思います。
SQL Server とOracleをこれから勉強したいと思っているのですが、この２つはひとつのOSで共存することはできるのでしょうか？ また、この２つの違いはどのへんなのでしょうか？ 勉強する上で簡単な方はSQL Serverなのでしょうか？ ちなみにosはXPPROです。 よろしくお願いします。
SQLを練習するために参考書を買おうとしています 地元の書店には関連の本の扱いが無いため、 ネットで買うつもりですが、中身が見れなくて躊躇しています。 SQLを独学で学ぶのに、オススメの参考書を教えて頂けませんでしょうか。 当方のレベルは以下の通りです。 ◆MSDE Queryにて学習中 (以前ACCESS＝North　Windも使用) ◆レベル的には基本的な動作（where,group by～など）は考えられる（独習暦１ヶ月程度） サブクエリまでなら扱える ◆直接的にSQLを考える力を　身に付けたい Web matrixにも興味がありますので、 その関連でのオススメの本もございましたらアドバイスをお願い致します。 また、余談となりますが貧乏学生なので検討の為のだいたいのお値段も教えて頂けると非常に助かります。 いろいろと厚かましくて申し訳ございません。 どうぞよろしくお願いします！！
ADP + MSDE2000 環境にて、あるテーブルに下記のトリガを設定しました。 CREATE TRIGGER トリガ名 ON テーブル1 FOR DELETE 　AS 　BEGIN 　　DECLARE @変数 varchar(32) 　　SELECT @変数 = 列1 FROM deleted 　　DELETE FROM テーブル2 　　WHERE テーブル2.列1 = @変数 　END 意図するところは、別のテーブル (テーブル2) からの同一キー (列1) を持つレコードの連動削除です。 このトリガを仕込んだテーブルに対してADPのGUI (テーブルのデータシートビュー) より手動にて直接 レコード削除を試みると、 「キー列の情報が足りないか、正しくありません。更新の影響を受ける行が多すぎます。」 のエラーが発生します。 (データシートビューを一度閉じた後、再度開くと、意図したレコードは消えています) GUIを使用せず、DELETE文で削除した場合、このエラーは出ず、動作結果も意図通りなのですが、前述の エラーは無視してよいものでしょうか？ トリガの記述で問題点、改善すべき箇所があれば、ご指摘頂けると幸いです。 尚、このテーブルには、この他に3つのトリガが記述されています。 (できれば1本にまとめたいのですが、力量不足 + 時間不足です) 字数制限の関係で、書けませんが、他のトリガとの兼ね合いで問題が生ずることはあり得るのでしょうか？ コメントをお待ちしております。
現在、エクセルからSQL Server Express 2005 に データー登録を行おうと考え、SQL Server Express 2005 をインストールしました。 インストールは無事完了してExpress Managerで接続しようと試みましたが、タイムアウトとなってしまいます。 　Server Interface 　認証方法の選択 　User name 　Password の内容が間違っているのか、それ以外の 問題があるのか分からず困っています。 ODBC接続の設定を行おうとしても同様の 現象となります。 初歩的な質問で申し訳ありませんが、 回答宜しくお願いいたします。
[環境] Windows XP HOME SP2 MSDE 2000 SP3 Office XP Pro SP3 無関係なアプリケーションソフト多数 上記の環境で、実行中のSQL Server名が列挙できません。 サービスマネージャ、SQL Serverサービスの動作はどちらも問題ありませんが、ODBC、またはADP (Access Data Project) からSQL Serverへの接続を試みると、接続ウィザードの画面上で、接続先サーバが列挙されず、接続ができない状況です。 ADP環境では、下記のエラーとなります。 「データサーバの列挙中にエラーが発生しました。列挙子のレポート'エラーを特定できません'」 OSQLからの接続は、-U、-P のみの指定なら問題なく接続できますが、-S指定では、localhost、NetBIOS名のどちらでも接続できず、拒否されます。 この障害の原因、解決方法をご存知の方、アドバイスを頂けると幸いです。 HDフォーマット → クリーンインストールを行えば、解決する可能性があると思いますが、PCを家族と共用しているため、現実的には無理な選択肢です。 ※ Office XP Pro SP3はプリインストールではありません。Word XP、Excel XPのみプリインストールされている環境に単体パッケージのXP Proを後から追加インストールしました。(原因と関係あるか不明ですが・・・?)
SQLServer2000で、DTSパッケージを使ってテキストファイルをインポートしているのですが、インポート先テーブルに主キーを設定していないためか、インポートするたびにレコードの順番が変わってしまいます。 例） テキストファイル fld1｜fld2｜fld3 1111｜AAAA｜aaaa 2222｜BBBB｜bbbb 3333｜CCCC｜cccc SQLServerのテーブル fld1｜fld2｜fld3 2222｜BBBB｜bbbb 3333｜CCCC｜cccc 1111｜AAAA｜aaaa のようになってしまいます。 これをテキストファイル通りのレコード順でインポートするにはどうすればいいのでしょうか？ ちなみに実際のファイルにはソートをかけられるフィールドはありません。 よろしくお願いします。
現在ACCESS2000で使用しているモジュールを、SQLServer上で動かすことになり、その移植作業で難航しております。皆さんのお知恵をお借りしたく思います。 具体的には重複レコードのあるテーブルから重複を省いたテーブルを作るという処理で、FIRST関数がSQLServerで使えなくて困っています。以下はACCESSでのSQL文です。 INSERT INTO tbl2(fld1,fld2,fld3) SELECT (tbl1.fld1), First(tbl1.fld2) AS fld2の先頭, Count(tbl1.fld3) AS カウント FROM tbl1 GROUP BY tbl1.fld1; よろしくお願いします。
作業環境を作ろうとして ＭＳＤＥをインストールし、サービス開始の作業を行ったのですが、エクセルのマクロを実行しようとすると、以下のエラーがでるのです コンパイルエラー： プロジェクトまたはライブラリが見つかりません。 必要なファイル等はあるのですが何故なのでしょうか？ 設定に不備があるのでしょうか、それとも環境等に不備があるのでしょうか？ 他に質問の解決に必要な項目等があれば教えてください。 私にとっては新しい分野の事なので、素人同然ですので、まったく的外れなのかもしれませんが、よろしくお願いします。
image型のInsertをどう記述すればいいのか分からず行き詰っています。 初歩的な質問で申し訳無いのですが、 image型をInsertするにはどう記述したらいいのかご教授頂けないでしょうか? 使用しているのはSQL Serverです。 宜しくお願いいたします。
あるサイトで・・・ ”多くのRound関数は、偶数丸めを採用しており、 丸め単位のまんなかで、どっちつかずの場合は、偶数側を採用する。” ということが書いてあるのを読みました。 しかし、SQL Server2000のクエリで select round(1.25,1) と実行すると 1.2ではなく1.3 が返ってくるので、四捨五入されている気がします。 厳密な四捨五入と異なる値が返ってくるパターンはどういう式でしょうか？ それとも、SQL Server2000のRound関数は厳密な四捨五入なのでしょうか？ ご存知の方がいたら教えてください。 よろしくお願いします。
データベースソフトMSDEを使用して、業務アプリを作成使用としています。 いままで、スタンドアロンのシステムでは使用したことがあるのですが、データベースサーバ＋クライアントのような使い方ができるのかよくわかりません。 Microsoftのサイトで調べてみたところ、「同時接続ユーザーは５人以下と想定されています」と書いてあるのですが、これは、５クライアントまで接続してよいと解釈してよいのでしょうか？
customerID,userID,CategoryID 0　　　　　24　　　01 0　　　　　24　　　04 0　　　　　24　　　07 0　　　　　25　　　01 0　　　　　25　　　02 1　　　　　1　　　01 1　　　　　1　　　04 1　　　　　24　　　01 上記のような構成のテーブルがありcustomerIDとuserIDを合わせて個人が特定出来るようになっています CategoryIDのユーザー１人あたり平均チェック数を出したい場合どのようなクエリで問い合わせればよいでしょうか？
いつも参考にさせて頂いています。 下記のような、テーブル、tabAとtabBを UNIONした結果にcol1の昇順でIDカラムをを追加して 表示するにはどのようなSQL文を書けばよろしいでしょうか？ ご存知の方、宜しくお願い致します。 【tabA】 col1 col2 --------- 100 AAA 110 BBB 120 CCC 【tabB】 col1 col2 --------- 200 XXX 210 YYY 220 ZZZ 【結果】 ID col1 col2 ------------ 1 100 AAA 2 110 BBB 3 120 CCC 4 200 XXX 5 210 YYY 6 220 ZZZ
テーブル名:料金表 ID　　項目CD　　金額 ------------------------- 1　　　101　　　1000 1　　　102　　　2000　 1　　　103　　　 100 2　　　101　　　1000 2　　　102　　　2000 2　　　103　　　　50 3　　　101　　　1000 3　　　102　　　2000 上記のテーブルがあります IDと、金額の合計と、項目CDが103のものだけ金額をだしたいのです 理想SELECT結果 ID　　合計　　項目CD：103 ------------------------- 1　　　3100　　　100 2　　　3050　　　 50 3　　　3000　　　　0（もしくはnull）　 select ID,sum(金額) as 合計 from 料金表 where ID in(1,2,3) group by ID,金額 でIDと合計までは出せました 特定の項目の値を取り出すのはどうしたらいいでしょうか？
初めまして。SQL初心者です。 あるシステムにおいて、SQLサーバが無応答？になり、システムがダウンしてしまい、困っています。 Windows2000Server、SQL Server2000、VB6を用いてDBに定期的にRead＆Write、及び各種のデータ表示を行っています。 ADOを使用して、接続や各コマンドを実行しているのですが、ごくたまに以下のエラーが出てしまいます。 Code:-2147217871,Description:時間切れになりました。Source:Microsoft OLE DB Provider for SQL Server,SQL State:HYT00,NativeError:0 過去ログや他サイトを調べた結果、コネクションのCommandTimeoutの秒数を延長させる、とあったので60秒に変更しました。 が、不定期（大体1週間～10日前後で夜中や朝方などにもあり）にこのエラーが出てしまい、約1時間～1時間半もダウンしています（この間のエラーをOn Errorではじいてログファイルに保存しています）。 毎分必ず実行しているストアド（20装置分のデータをUPDATEするので1分に20回実行する）があるのですが、必ずと言っていいほどこのストアド実行中に落ちています。 このストアドに5～6個のパラメータを渡し、複数のテーブルに対してUPDATE処理を行っています。 正常に動作している時は、数日間全く問題無いので、ストアドやVBのコードに間違いは無いと思います。 そこで、SQL Serverの設定等を見直したところ、1つ気になったところが。データベースファイル \Microsoft SQL Server\MSSQL\Data\aaa.MDF のサイズが14Gになっていました・・・。 このファイルにアクセスする時にSQL Serverで高負荷になってしまい、無応答のような状態になってしまうのでは？と思っていますがどうでしょう？ 不定期に発生し、かつ再現性が無く、原因が掴めずに本当に困っています。 先輩方、何でも良いのでアドバイスをお願い致します。
セットマスタ 親商品コード１,子商品コード１,子商品コード２,子商品３…子商品１０ があるとします。 【マスタ情報】 ・親商品コードは、nullでない ・子商品コードは、1番目はnullでは無いが2番目以降の有無は親商品による また、価格マスタが存在して、 キーは、商品コードで価格を持っています。 【マスタ情報】 ・商品コードは、nullでない ・商品コードで、一意に決まる 上記の状況で、親商品コード価格 と 子商品コード価格の合計 をチェックしたいのですが、うまい方法がわかりません。 現状では、 ＶＢでレコードセットで各商品コード毎に価格マスタを当てに 行き、親 ⇔ 子の合計をチェックする方法しか思いつきません。 どなたか、うまいＳＱＬがあれば よろしくお願いします。
stored procedureに可変長引数(配列)等を渡す方法またはその代替案を教えていただけないでしょうか？ マニュアルを見る限りではないようです。 text型(varcharはmaxを超えてしまう)にカンマ区切りで値を結合してprocedureのほうで分割するような処理をしないとだめなのでしょうか？
MSDE(Access2000)を使用しております。 そのPCにSQLServer2000を入れたいのですが。 MSDEとSQLServer2000の両方使用できますか？ 回答、よろしくお願い致します。
全く基本的なことで恐縮ですが、 以下の４つの違いを教えてください。 SQL Server Oracle PostgresSQL MySQL よろしくお願いします。
質問です。 テーブルＡとＢに下記データが存在した場合、ＡにいてＢにいなかったデータは「０」ＡにいてＢにもいた場合のデータはその件数を抽出するSELECT文を教えて下さい。 テーブルＡ　　　テーブルＢ A1　　　　　　　A1 A2　　　　　　　A1 A3　　　　　　　A1 A4　　　　　　　A3 A5　　　　　　　A4 ---------- 結果 ---------- A1　3 A2　0 A3　1 A4　1 A5　0
お世話になります。 current_timestampを使って現在日付を取得しています。しかし、ここに時間も入ってしまいます。 時間を00:00:00にしたいのですが、どのように行ったらいいでしょうか。 よろしくお願いします。
SQLServer2000でのSQL文の質問です。 SQLにてカンマ区切り編集をして取得する構文を教えてください。
お世話になります。 SQL Server2000のストアドプロシージャでエラー処理を 行いたいと考えています。 理想としてはJavaのTry～catch構文のようなもの、 もしくはVBのエラーgoto文の様なものがあれば いいなと思っています。 最終的には何かしらのエラーがあった場合、OSの イベントログに、アラームを出したいと思っております。 このようなことが具体的に可能なのか、お教え下さい。 よろしくお願いします。
SQLServer2000で困っています。 定期的にデータを消す必要のあるテーブルが複数あり、 データを消すストアドプロシージャを作成しました。 しかし、これだけでは不十分で、データを消す前に データをCSV形式などで保存しておきたいと考えて います。 。。。といったことは可能なのでしょうか。 また、別の方法の方がよいといった意見もお願い します。 ツール類がインストールされていないPCなので、 Accessなどは使えません。 よろしくお願いします。
Select文で２つのフィールドを加算した結果を取得したいと思います。しかし２つのフィールドのうち１つがNullの値だと残りのフィールドに値が入っていても空白(NULL?)で返ります。 [例]********************************************** フィールドA：Null フィールドB：300 SELECT フィールドA+フィールドB FROM テーブルA ＜Selectされた結果＞ 空白(何も表示されない。Null?) [例]********************************************** どのようにすれば、Nullでない値だけ取得できるでしょうか。
先日VBで接続していると質問をした者です。 http://oshiete1.goo.ne.jp/kotaeru.php3?q=1261810 前回の質問から大分しらべまして、どうやら自分の開発しているパソコンのみ接続ができないみたいです。 開発するために自分のパソコンにSQL Server入れたりMSDEを入れたり・・・もちろんアンインストールをしたのですが、そのあたりが原因かと思います。 サービスの停止などいろいろと試したのですが、現状変わらず・・・ 何か手立てはありませんか？ よろしくお願いします。
動的に数式を計算する方法を探しています。 SQLServerのエンジンを使うのが簡単そうです。 ADO.NETでSELCECT文を投げることにより、数式を計算することは可能です。 SELECT 1+2 質問は、変数を含んだ数式をSELECT文で計算することは出来るでしょうか？ int a = 1;//変数 int b = 2;//変数 string shiki = "a + b"; //変数を含んだ数式 で3を求めたいです。 Windows2000Server MSDE2000A VS.NET2003(Webアプリ/C#)
お世話になります。 テーブル名：info フィールド名:no，date，name フィールドのデータタイプ：int型，char型，char型 のデータベースがあります。dateにはyyyy/mm/ddの形でデータが入っているのですが、 そのdateから、例えば2004/01/01～2005/01/01までに該当するデータを検索して、抽出したいのですが、方法がわかりません。 SELECT REPLACE(date, '/', '') FROM info で、“/”がないデータを取り出すことはできるのですが、その後どうしたら良いかがわかりません。 どなたかいい方法教えていただけないでしょうか？
いつもお世話になっております。 現在新入社員研修のＳＱＬ講習で使用する教材となるような本を探しています。いい本がありましたらお教え願います。
ACCESS 2.0の業務用アプリケーションが稼動している時にACCESS 2.0のデーターベースウィンドウズでopenした削除クエリー等でテーブル等を操作することはACCESS 2.0のアプリケーション（及びデーターベース、テーブル等）を破壊する事があるのですか？サーバーにテーブル、クライアント３台にアプリケーションのシステム環境です。宜しくお願いします。
アクセス2.0のOSはXPでは不可能ですか？Ｗ９８では巧く稼動したことを確認しました。WINDOWS XPではだめですか？どうしてですか？お教え下さい。
超初心者ですが教えてください。会社のSQLサーバーの接続が２台中の1台のPCだけよく切断されます。（エラー０になります） 再接続しようとしてもエラーになって接続できません。SQLサーバーを再インストールしてもだめです。 いつもPCを再起動して接続しています。 なにか原因があるのでしょうか？？？
初心者ですが宜しくお願いします。今Access2000で作ったデータベースを社内4人程で共有しようと思いました。そこで色々調べてMSDEがいいとネットで調べましたがいまいち良く分かりませんでした。今Win2000ProをしようしていますがServer系のOSは必要とするのでしょうか？後Access2000からMSDEをインストールしましたが設定方法はSQLServerの本を読めばできるのでしょうか？的外れな事ばかりかもしれませんが宜しくお願いします。今の所本を読んでもネットで調べて見てもチンプンカンプン状態です。
VBからACCESSでリンクをはって使うと　"ODBC呼び出しが失敗しました　ODBC SQL SERVER DRIVER時間きれになりました" とエラーが出るのですが何か設定上問題が有るのでしょうか 同じテーブルを続けてSELECT(別のSELECT文を)するとですようです
ACCESSのリンクテーブルのような機能は、SQL Server 2000にあるのでしょうか？ SQL Serverに作成したデータベースAとBがあり、AにあるテーブルをBから参照更新したりすることはできるのでしょうか？ 具体的にはどのようなものになるのでしょうか？ 初歩的な質問で申し訳ありませんが、何卒、よろしくお願いします。
教えて下さい。 検索文のWHERE句を設定、 (1)INDEX付きの項目を１つだけ指定する。 ＜例＞WHERE 項目a = 'a' --対象件数少 (2)INDEX付きの項目を複数個指定する。 ＜例＞WHERE 項目a = 'a' --対象件数少 AND 項目A = 'A' --対象件数多 どちらが検索速度は速いのですか？ ご解答よろしくお願いいたします。
「データソース(ODBC)」を設定することで、WANの向こう側のDBにアクセスできるような環境を構築したいと思っています。 サーバーとクライアントには、どのような設定が必要ですか？ [環境] サーバー： WindowsServer2003, SQLServer2000, DNS クライアント： Windows2000 以上、宜しくお願い致します。
商品　　　　　価格 -------------------- 白米　　　　　15000 玄米　　　　　14000 なす　　　　　 5000 きゅうり　　　 3000 上記のようなテーブルから、 価格が10000までの商品点数、また10000～20000の 商品点数を一回のSQL文で取得できるようなクエリー を作りたいのですが、アドバイス頂けましたら幸いですm(__)m
どのようにレプリケーションを組むべきなのか、非常に困っています。 どなたか、アドバイス下さい。 ＜環境＞ OS：Win2000 DB: SQL2000 ＜行いたいこと＞ AとBというDBに、同じ構造を持つテーブルがあります。 これらのテーブルには、それぞれ異なるデータが入っています。 新たに、MergedDBというDBを作成し、ここにAとBのデータを集約したい。 ただし、MergedDBに集約されたデータは、AとBに配布しない。 よろしくお願いいたします。
VisualBasicでSQL Server2000へ接続しているのですが、ローカル接続でサーバに接続した場合は問題なく接続できます。外部から（ネットワークを介して）接続した際にAdministrator権限のコンピュータだと接続可能なのですが、それ以外のコンピュータでの接続ができません。SQL Server内でのデータベースのユーザで追加するだけでは無理なのでしょうか？
SQLのCASE文での質問なのですが、 テーブルの項目「区分」に1,2,3,4,5とデータが入っていた場合で 1の場合はA 2の場合はB 1かつ2でない場合はC と返す場合はどのように記述すればよろしいのでしょうか？ 環境はSQL Server2000です。
皆様、始めまして。 現在、SQLServer（MSDE）でデータベースを構築中であるのですが、データベースのサイズ見積りの方法がわからず困っています。 BooksOnlineを見るとテーブルのサイズ見積りについては、詳しい計算式が乗っているのですが、システムで使う領域、インデックスについては記述が見つからず、困っております。 つきましては、データベースのサイズ見積りの方法についてご存知の方いらっしゃいましたらご教示願えませんでしょうか？ もちろんWEB上の情報、書籍等の情報でも構いません。 どうぞよろしくお願いします。
SQL Serverの復元機能で、バックアップしたデータをテープから直接SQL Serverへ復元することは可能でしょうか？（SQL Serverから直接Backup Execで吸い上げたバックアップファイルを読み込めるかどうか？）
MSAccessみたいにSQLをビジュアルで構築したり 構築したSQLからビジュアルな表示にしてくれる ツールをご存知の方教えてください。
下記のパターンの際に、transaction logファイルに書き込まれるのか否かを教えて下さい。 A:チェックポイントをまたがったトランザクションで完了後にシステム障害が発生した場合。 =>私の認識では、ロールフォワードによって、データベースとtransaction logファイルにデータが書き込まれる。と考えているのですが、正しいでしょうか？ B:チェックポイントを一度も通らずに、トランザクションが完了。完了後にシステム障害が発生。 =>Aと同じですか？ C:トランザクション実行中にシステム障害が発生した場合。 =>ロールバックされて、transaction logファイルにのみ書き込まれて、データベースには書き込まれない。というのは正しいでしょうか？ よろしくお願いします^^
MSDEインストール後、ACCESSファイルをアップサイジングして”商品(NEW)データ”という名のMSDEデータベースを作成しました。その後データベースを削除したくなったので、コマンドプロンプトから> osql -S(local) -Usa -Psa -Q"DROP DATABASE 商品(NEW)データ"と入力しましたが、「'NEW' の近くに無効な構文があります」とのメッセージが出て削除することができませんでした。データベース名にカッコ（）があると削除できないのでしょうか？くだらない質問ですいませんが教えてください。
Windows2000SP4、IISの環境です。 １．SQLServer2000の認証：Windows認証を使用 ２．ODBC接続時、 １）接続するサーバ名：Local ２）SQL ServerがログインIDの権限の確認を行う方法は 　　　：ネットワークへのログインIDでWindows　NTの認証メカニズムを使う ３．ASPファイルで以下のように記述しています。 Set Conn = Server.CreateObject(\"ADODB.Connection\") Conn.Open \"DSN=*****ODBCで登録した名前\" ４．エラーメッセージ： Microsoft OLE DB Provider for ODBC Drivers (0x80040E4D) [Microsoft][ODBC SQL Server Driver][SQL Server]ユーザー \'＊＊＊＊＊（私のサーバ名）\' はログインできませんでした。 index.asp, line 22 ５．その他 SQLクエリアナライザでは何も問題なく接続できます。 以上、説明が不十分かもしれません。 なぜログインできないか、ご存知の方教えてください。よろしくお願いします。
表題のとおりなのですが、勉強のために同一マシンにSQLサーバーとORACLEをインストールしたいのですが 同一マシンに異なるDBをいれても問題ないのでしょうか？ OSはWindows2000Pro　SP４ 同時にインストールしようとしているDBが SQLServer2000　DeveloperEdition と Oracle９i です よろしくお願いします
MSDE2000をインストールして開始すると、タスクトレイにアイコンが出てきていたのですが、消してしまい再び開始しても出てこなくなりました。特に影響はないのですが、タスクトレイに常駐させるにはどのようにしたらいいのでしょう？よろしくおねがいします。
VB6のプログラムから、ストアドを実行すると エラー 3704（オブジェクトが閉じている間は操作が許可されない）が発生します。 ストアドの内容は次のとおりです １．あるテーブルの中から条件に一致するレコードを取得し、一時テーブルに格納する ２．一時テーブルを先頭から１行ずつ読み、各レコードの値を使用して別のテーブルへ更新 上記内容を、一時テーブルではなくカーソルを使用するとうまくいきます。 同じような経験をされた方、対処法などご存知でしたら教えてください。
テーブルのアップデートに３時間もかかってしまい困っています。 チューニングにより速度改善できそうであれば、 教えていただけませんでしょうか？ UPDATE TABLE_A SET TABLE_A.MATI_CD = TABLE_B.MATI_CD, TABLE_A.UPD_DT = GETDATE(), TABLE_A.UPD_MOD = 'バッチXX' FROM TABLE_A INNER JOIN TABLE_B ON TABLE_A.KEN_CD = TABLE_B.KEN_CD AND TABLE_A.MATI_NM = TABLE_B.MATI_NM AND TABLE_B.NENDO = '2004' WHERE ( TABLE_A.MATI_CD IS NULL AND TABLE_A.MATI_NM <> '' OR TABLE_A.MATI_CD = '' AND TABLE_A.MATI_NM <> '' ) AND TABLE_A.CRE_DT >= '2004/04/01' TABLE_A KEN_CD ・・・ (key)県コード KEN_NM ・・・ 県名称 UKE_NO ・・・ (key)受付番号 EDA_NO ・・・ (key)受付番号枝番 MATI_CD・・・ 町コード MATI_NM・・・ 町名称 CRE_DT ・・・ データ新規作成日 CRE_MOD・・・ データ新規作成モジュール名 UPD_DT ・・・ データ更新日 UPD_MOD・・・ データ更新モジュール名 TABLE_B NENDO ・・・ (key)登録年度 MATI_CD・・・ (key)町コード MATI_NM・・・ 町名称 KEN_CD ・・・ 県コード CRE_DT ・・・ データ新規作成日 CRE_MOD・・・ データ新規作成モジュール名 UPD_DT ・・・ データ更新日 UPD_MOD・・・ データ更新モジュール名 TABLE_Aは受付記録を残すテーブルで、 現在およそ３００万件入っています。 TABLE_Bは町コードのマスタテーブルで、 14000件入っています。 目的としては TABLE_Aの町コードがNULLで町名称が登録されている場合、 TABLE_Bのマスタから町コードを登録してやろうという修正バッチです。 これがTABLE_Bが大量データのためかわかりませんが、 ３時間もかかってしまうんです。。。 何か良い手段はありませんでしょうか？ ご助言お願いいたします。
SQL Serverのスクリプト生成で作成した複数のSQLスクリプトファイル(.sql)を ACCESSからSQL Serverに接続して実行したいのですが どのようにすれば出来るでしょうか？ バッチを使えば出来そうですが、今回はACCESSのみで実現できればと思っています。 ※ACCESS2003とSQL Server2000を使用しています。 よろしくお願いします。
ACCSESSのアップサイジングウイザードで作ったSQLデータベースの削除方法を教えてください。お願いします。
こんにちは。 -- IDENTITYを解除 SET IDENTITY_INSERT TBLA ON --BCPコマンドを文字列として生成する set @cmdstr = '' set @cmdstr = 'bcp TBLA in c:\TBLA.csv -c -t , -r \n -U xx -P xx' --生成したコマンド文字列を実行するxp_cmdshellを動的SQLで実行する execute master.dbo.xp_cmdshell @cmdstr -- IDENTITYを再設定 SET IDENTITY_INSERT TBLA OFF ってな感じでやってみたのですが、 実行後TBLAの中を見てみると、IDENTITY列の値は テキストデータの中の値ではなく、 テーブルがIDENTITYを勝手に割り振っちゃいます。 どなたか、このようなことやった方いらっしゃいませんか？
sqlserver2000に対してクライアントツール用に開発したAccess2000のadpファイルからデータの更新を行うと、以下のようなエラーが発生するのですが、どのような場合以下のエラーが発生するのかご意見を頂きたいと思います。 "トランザクション(プロセスID89)が、lockリソースでほかのプロセスとデッドロックしました。トランザクションがデッドロックの対象として選択されています。トランザクションを再実行してください。"
下記のテーブルで、 　 日付　　　　　　　ナンバー　　　サブナンバー　 a　2005/01/01　　　　1　　　　　　　 1　 b　2005/01/01　　　　1　　　　　　　 2 c　2005/01/01　　　　2 　　　　 　1 d　2005/01/01　　　　3　　　　　　　 1 e　2005/01/01　　　　1　　　　　　　 1 f　2005/01/02　　　　1　　　　　　　 2 日付とナンバーをグループ化して、 その中でサブナンバーが一番大きいデータを取りたい。 上記の例だと、b,c,d,fが抽出される予定・・。 何かいい方法ないでしょうか。 ちなみに、カラムを指定して抽出するのではなく、 select * で引き抜きたいのですが・・。 初心者で申し訳ありません・・。
DBに負荷をかけている処理、端末をつきとめようと思いログの解析をしているのですが、管理→SQL Serverログでは十分な情報がのっていません。どなたかもっと詳細なログを参照する方法をご存知でしょうか？よろしくお願いします。
はじめまして。お世話になります。 ＡとＢの２つのネットワークを持つクラスタ環境の サーバに対して、SQLServerを導入しました。 導入の際のウィザードにて、接続先のネットワークを聞かれたのでＡのネットワークを指定して導入しました。 導入後、当然ながら、Ａのネットワーク環境の端末からはSQLServerの接続(Enterprise Manager client 等で）は可能です。 そこで、現状に対して、ＢのネットワークからもSQLServerに接続を行いたく思っていますが、根本的に可能なのでしょうか？ 可能であれば、設定方法を教えて頂きたく思います。
SQLserver2000を触る事になり思った通りにならず困っております。 テーブルに主キーを設定せずデータ型を「int」でフィールドに重複する数値を入れてしまいました。 後から重複入力のミスに気づき重複したレコードを 「テーブルを開く」-「全行を返す」から１レコードを 削除しようとしたのですが、 「キー列の情報が足りないか、正しくありません。更新の影響を受ける行が多すぎます。」と表示され削除できません。 このテーブルは、多くのビューで使用してすでに動いている再作成することは難しいです。 このレコードを削除する良い方法はあるのでしょうか。 ご存知の先生方ご指導よろしくお願いいたします。
基本的なことなのですが、データベースの初期サイズはだいたいどのくらい確保すればいいものなのでしょうか。 フィールドごとにデータ型のバイト数×レコード数で計算していけばいいのでしょうが、例えば導入後月1000レコードずつ増えていくと想定される場合、どのくらいのレコード数を目処にすればいいのでしょうか。 その際、トランザクションログのサイズはどのくらいとればいいのでしょうか。 あまりサイズが小さすぎると自動拡張を有効にしていた場合、それにより負荷がかかってしまうと聞いたのですが・・。
